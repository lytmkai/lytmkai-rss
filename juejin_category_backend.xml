<?xml version="1.0" encoding="UTF-8"?><rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>掘金 后端</title><link>https://juejin.cn/backend</link><atom:link href="http://10.0.0.5:1200/juejin/category/backend" rel="self" type="application/rss+xml"></atom:link><description>掘金 后端 - Powered by RSSHub</description><generator>RSSHub</generator><webMaster>contact@rsshub.app (RSSHub)</webMaster><language>en</language><lastBuildDate>Wed, 14 Jan 2026 05:14:24 GMT</lastBuildDate><ttl>5</ttl><item><title>Java注解校验实战</title><description>&lt;h2 data-id=&quot;heading-0&quot;&gt;一、注解校验概述&lt;/h2&gt;
&lt;h3 data-id=&quot;heading-1&quot;&gt;1.1 为什么需要注解校验？&lt;/h3&gt;
&lt;p&gt;在实际开发中，我们经常需要对输入数据进行校验：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// 传统方式：代码冗长、难以维护&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;createUser&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(String username, String email, Integer age)&lt;/span&gt; {
    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (username == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt; || username.length() &amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; || username.length() &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt;) {
        &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;IllegalArgumentException&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;用户名长度必须在3-20之间&quot;&lt;/span&gt;);
    }
    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (email == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt; || !email.matches(&lt;span class=&quot;hljs-string&quot;&gt;&quot;^[A-Za-z0-9+_.-]+@(.+)$&quot;&lt;/span&gt;)) {
        &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;IllegalArgumentException&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;邮箱格式不正确&quot;&lt;/span&gt;);
    }
    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (age == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt; || age &amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;18&lt;/span&gt; || age &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;120&lt;/span&gt;) {
        &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;IllegalArgumentException&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;年龄必须在18-120之间&quot;&lt;/span&gt;);
    }
    &lt;span class=&quot;hljs-comment&quot;&gt;//...&lt;/span&gt;
}

&lt;span class=&quot;hljs-comment&quot;&gt;// ✅ 注解校验：简洁、声明式、可复用&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;createUser&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-meta&quot;&gt;@Valid&lt;/span&gt; UserDTO userDTO)&lt;/span&gt; {
    &lt;span class=&quot;hljs-comment&quot;&gt;//...&lt;/span&gt;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;注解校验的优势&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;✅ &lt;strong&gt;声明式&lt;/strong&gt;：通过注解声明校验规则，代码更简洁&lt;/li&gt;
&lt;li&gt;✅ &lt;strong&gt;可复用&lt;/strong&gt;：校验逻辑可以复用，避免重复代码&lt;/li&gt;
&lt;li&gt;✅ &lt;strong&gt;易维护&lt;/strong&gt;：校验规则集中管理，易于维护&lt;/li&gt;
&lt;li&gt;✅ &lt;strong&gt;标准化&lt;/strong&gt;：遵循JSR-303/JSR-380标准&lt;/li&gt;
&lt;li&gt;✅ &lt;strong&gt;国际化&lt;/strong&gt;：支持国际化错误消息&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 data-id=&quot;heading-2&quot;&gt;1.2 常用校验注解&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4d75942f76fe463ca72881781d563aac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;amp;x-expires=1768972030&amp;amp;x-signature=Lr04MVUvNK4vknuXUusWIknEC7Q%3D&quot; alt=&quot;&quot; loading=&quot;lazy&quot; referrerpolicy=&quot;no-referrer&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Jakarta Bean Validation提供的注解&lt;/strong&gt;：&lt;/p&gt;











































































&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;注解&lt;/th&gt;&lt;th&gt;说明&lt;/th&gt;&lt;th&gt;示例&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;@NotNull&lt;/code&gt;&lt;/td&gt;&lt;td&gt;值不能为null&lt;/td&gt;&lt;td&gt;&lt;code&gt;@NotNull String name&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;@NotEmpty&lt;/code&gt;&lt;/td&gt;&lt;td&gt;集合、字符串、数组不能为空&lt;/td&gt;&lt;td&gt;&lt;code&gt;@NotEmpty List&amp;lt;String&amp;gt; items&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;@NotBlank&lt;/code&gt;&lt;/td&gt;&lt;td&gt;字符串不能为空白（去除首尾空格后长度&amp;gt;0）&lt;/td&gt;&lt;td&gt;&lt;code&gt;@NotBlank String content&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;@Size(min, max)&lt;/code&gt;&lt;/td&gt;&lt;td&gt;大小必须在指定范围内&lt;/td&gt;&lt;td&gt;&lt;code&gt;@Size(min=3, max=20) String name&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;@Min(value)&lt;/code&gt;&lt;/td&gt;&lt;td&gt;数值必须大于等于指定值&lt;/td&gt;&lt;td&gt;&lt;code&gt;@Min(18) Integer age&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;@Max(value)&lt;/code&gt;&lt;/td&gt;&lt;td&gt;数值必须小于等于指定值&lt;/td&gt;&lt;td&gt;&lt;code&gt;@Max(120) Integer age&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;@Email&lt;/code&gt;&lt;/td&gt;&lt;td&gt;必须是有效的邮箱格式&lt;/td&gt;&lt;td&gt;&lt;code&gt;@Email String email&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;@Pattern(regexp)&lt;/code&gt;&lt;/td&gt;&lt;td&gt;必须匹配指定的正则表达式&lt;/td&gt;&lt;td&gt;&lt;code&gt;@Pattern(regexp=&quot;^1[3-9]\\d{9}$&quot;) String phone&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;@Past&lt;/code&gt;&lt;/td&gt;&lt;td&gt;日期必须是过去的时间&lt;/td&gt;&lt;td&gt;&lt;code&gt;@Past Date birthDate&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;@Future&lt;/code&gt;&lt;/td&gt;&lt;td&gt;日期必须是未来的时间&lt;/td&gt;&lt;td&gt;&lt;code&gt;@Future Date appointmentDate&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;@AssertTrue&lt;/code&gt;&lt;/td&gt;&lt;td&gt;布尔值必须是true&lt;/td&gt;&lt;td&gt;&lt;code&gt;@AssertTrue Boolean agreed&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;@Negative&lt;/code&gt;&lt;/td&gt;&lt;td&gt;数值必须是负数&lt;/td&gt;&lt;td&gt;&lt;code&gt;@Negative Integer balance&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;@Positive&lt;/code&gt;&lt;/td&gt;&lt;td&gt;数值必须是正数&lt;/td&gt;&lt;td&gt;&lt;code&gt;@Positive Integer amount&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;
&lt;hr&gt;
&lt;h2 data-id=&quot;heading-3&quot;&gt;二、@Valid vs @Validated&lt;/h2&gt;
&lt;h3 data-id=&quot;heading-4&quot;&gt;2.1 核心区别&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14bdc2a2e8ae445db42f96080bb1d312~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;amp;x-expires=1768972030&amp;amp;x-signature=Ezh8V%2FE8oes3yV0mO5w5sgJNbEI%3D&quot; alt=&quot;&quot; loading=&quot;lazy&quot; referrerpolicy=&quot;no-referrer&quot;&gt;&lt;/p&gt;
&lt;p&gt;这两个注解虽然功能相似，但有关键区别：&lt;/p&gt;








































&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;特性&lt;/th&gt;&lt;th&gt;@Valid&lt;/th&gt;&lt;th&gt;@Validated&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;来源&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;Jakarta Bean Validation (JSR-380)&lt;/td&gt;&lt;td&gt;Spring Framework&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;位置&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;方法、字段、构造器参数&lt;/td&gt;&lt;td&gt;方法、类型、参数&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;嵌套校验&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;✅ 支持&lt;/td&gt;&lt;td&gt;✅ 支持&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;分组校验&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;❌ 不支持&lt;/td&gt;&lt;td&gt;✅ 支持&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;校验组序列&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;❌ 不支持&lt;/td&gt;&lt;td&gt;✅ 支持&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Spring集成&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;需要配置&lt;/td&gt;&lt;td&gt;原生支持&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;
&lt;h3 data-id=&quot;heading-5&quot;&gt;2.2 @Valid的使用&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;基本用法&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Data&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;UserDTO&lt;/span&gt; {
    &lt;span class=&quot;hljs-meta&quot;&gt;@NotNull(message = &quot;用户ID不能为空&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Long id;

    &lt;span class=&quot;hljs-meta&quot;&gt;@NotBlank(message = &quot;用户名不能为空&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-meta&quot;&gt;@Size(min = 3, max = 20, message = &quot;用户名长度必须在3-20之间&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String username;

    &lt;span class=&quot;hljs-meta&quot;&gt;@Email(message = &quot;邮箱格式不正确&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-meta&quot;&gt;@NotBlank(message = &quot;邮箱不能为空&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String email;

    &lt;span class=&quot;hljs-meta&quot;&gt;@Min(value = 18, message = &quot;年龄必须大于等于18岁&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-meta&quot;&gt;@Max(value = 120, message = &quot;年龄必须小于等于120岁&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Integer age;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;在Controller中使用&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@RestController&lt;/span&gt;
&lt;span class=&quot;hljs-meta&quot;&gt;@RequestMapping(&quot;/api/users&quot;)&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;UserController&lt;/span&gt; {

    &lt;span class=&quot;hljs-comment&quot;&gt;// 使用@Valid触发校验&lt;/span&gt;
    &lt;span class=&quot;hljs-meta&quot;&gt;@PostMapping&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; ResponseEntity&amp;lt;String&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;createUser&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-meta&quot;&gt;@Valid&lt;/span&gt; &lt;span class=&quot;hljs-meta&quot;&gt;@RequestBody&lt;/span&gt; UserDTO userDTO)&lt;/span&gt; {
        &lt;span class=&quot;hljs-comment&quot;&gt;// 如果校验失败，会自动抛出MethodArgumentNotValidException&lt;/span&gt;
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; ResponseEntity.ok(&lt;span class=&quot;hljs-string&quot;&gt;&quot;用户创建成功&quot;&lt;/span&gt;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;嵌套校验&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Data&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;OrderDTO&lt;/span&gt; {
    &lt;span class=&quot;hljs-meta&quot;&gt;@NotNull(message = &quot;订单ID不能为空&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Long orderId;

    &lt;span class=&quot;hljs-meta&quot;&gt;@Valid&lt;/span&gt;  &lt;span class=&quot;hljs-comment&quot;&gt;// 关键：必须使用@Valid才能触发嵌套对象的校验&lt;/span&gt;
    &lt;span class=&quot;hljs-meta&quot;&gt;@NotNull(message = &quot;用户信息不能为空&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; UserDTO user;

    &lt;span class=&quot;hljs-meta&quot;&gt;@Valid&lt;/span&gt;
    &lt;span class=&quot;hljs-meta&quot;&gt;@NotEmpty(message = &quot;订单项不能为空&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; List&amp;lt;OrderItemDTO&amp;gt; items;
}

&lt;span class=&quot;hljs-meta&quot;&gt;@Data&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;OrderItemDTO&lt;/span&gt; {
    &lt;span class=&quot;hljs-meta&quot;&gt;@NotNull(message = &quot;商品ID不能为空&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Long productId;

    &lt;span class=&quot;hljs-meta&quot;&gt;@Min(value = 1, message = &quot;数量必须大于0&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Integer quantity;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-6&quot;&gt;2.3 @Validated的使用&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;基本用法&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Service&lt;/span&gt;
&lt;span class=&quot;hljs-meta&quot;&gt;@Validated&lt;/span&gt;  &lt;span class=&quot;hljs-comment&quot;&gt;// 类级别添加@Validated，启用方法参数校验&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;UserService&lt;/span&gt; {

    &lt;span class=&quot;hljs-comment&quot;&gt;// 简单参数校验&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;updateUser&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(
            &lt;span class=&quot;hljs-meta&quot;&gt;@NotNull(message = &quot;用户ID不能为空&quot;)&lt;/span&gt; Long id,
            &lt;span class=&quot;hljs-meta&quot;&gt;@NotBlank(message = &quot;用户名不能为空&quot;)&lt;/span&gt; String username)&lt;/span&gt; {
        &lt;span class=&quot;hljs-comment&quot;&gt;// 业务逻辑...&lt;/span&gt;
    }

    &lt;span class=&quot;hljs-comment&quot;&gt;// 对象校验&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;createUser&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-meta&quot;&gt;@Valid&lt;/span&gt; UserDTO userDTO)&lt;/span&gt; {
        &lt;span class=&quot;hljs-comment&quot;&gt;// 业务逻辑...&lt;/span&gt;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;分组校验&lt;/strong&gt;（@Validated独有）：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;CreateGroup&lt;/span&gt; {}
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;UpdateGroup&lt;/span&gt; {}

&lt;span class=&quot;hljs-meta&quot;&gt;@Data&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;UserDTO&lt;/span&gt; {
    &lt;span class=&quot;hljs-meta&quot;&gt;@Null(groups = CreateGroup.class, message = &quot;创建时ID必须为空&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-meta&quot;&gt;@NotNull(groups = UpdateGroup.class, message = &quot;更新时ID不能为空&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Long id;

    &lt;span class=&quot;hljs-meta&quot;&gt;@NotBlank(groups = {CreateGroup.class, UpdateGroup.class})&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String username;
}

&lt;span class=&quot;hljs-meta&quot;&gt;@RestController&lt;/span&gt;
&lt;span class=&quot;hljs-meta&quot;&gt;@RequestMapping(&quot;/api/users&quot;)&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;UserController&lt;/span&gt; {

    &lt;span class=&quot;hljs-meta&quot;&gt;@PostMapping&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; ResponseEntity&amp;lt;String&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(
            &lt;span class=&quot;hljs-meta&quot;&gt;@Validated(CreateGroup.class)&lt;/span&gt; &lt;span class=&quot;hljs-meta&quot;&gt;@RequestBody&lt;/span&gt; UserDTO userDTO)&lt;/span&gt; {
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; ResponseEntity.ok(&lt;span class=&quot;hljs-string&quot;&gt;&quot;创建成功&quot;&lt;/span&gt;);
    }

    &lt;span class=&quot;hljs-meta&quot;&gt;@PutMapping&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; ResponseEntity&amp;lt;String&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(
            &lt;span class=&quot;hljs-meta&quot;&gt;@Validated(UpdateGroup.class)&lt;/span&gt; &lt;span class=&quot;hljs-meta&quot;&gt;@RequestBody&lt;/span&gt; UserDTO userDTO)&lt;/span&gt; {
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; ResponseEntity.ok(&lt;span class=&quot;hljs-string&quot;&gt;&quot;更新成功&quot;&lt;/span&gt;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-7&quot;&gt;2.4 选择建议&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7bc644bb552440bf90eee2200d5f33ac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;amp;x-expires=1768972030&amp;amp;x-signature=YtVeSX8VJ9zR6C9zR0%2F%2FJBvN60I%3D&quot; alt=&quot;&quot; loading=&quot;lazy&quot; referrerpolicy=&quot;no-referrer&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;选择决策树&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-less&quot; lang=&quot;less&quot;&gt;是否需要分组校验？
├─ 是 → 使用 &lt;span class=&quot;hljs-variable&quot;&gt;@Validated&lt;/span&gt;
└─ 否 → 是否在Controller中？
    ├─ 是 → 两者都可以，推荐 &lt;span class=&quot;hljs-variable&quot;&gt;@Valid&lt;/span&gt;
    └─ 否 → 使用 &lt;span class=&quot;hljs-variable&quot;&gt;@Validated&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;最佳实践&lt;/strong&gt;：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Controller层&lt;/strong&gt;：使用 &lt;code&gt;@Valid&lt;/code&gt;（简洁、够用）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Service层&lt;/strong&gt;：使用 &lt;code&gt;@Validated&lt;/code&gt;（支持方法参数校验）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;需要分组&lt;/strong&gt;：必须使用 &lt;code&gt;@Validated&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;嵌套对象&lt;/strong&gt;：在嵌套对象字段上添加 &lt;code&gt;@Valid&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h2 data-id=&quot;heading-8&quot;&gt;三、校验组（Validation Groups）&lt;/h2&gt;
&lt;h3 data-id=&quot;heading-9&quot;&gt;3.1 为什么需要校验组？&lt;/h3&gt;
&lt;p&gt;不同场景下，同一对象的校验规则可能不同：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// 场景1：新增用户&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// - id为空（由数据库生成）&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// - username必填&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// - password必填&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;// 场景2：更新用户&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// - id必填（根据id更新）&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// - username可选&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// - password可选（不修改则不传）&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-10&quot;&gt;3.2 定义校验组&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/988f1add0aa542e9bf4de37a1ddfb86c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;amp;x-expires=1768972030&amp;amp;x-signature=lPsWPUcWL%2B5hU%2BRIJ1tsz830aw4%3D&quot; alt=&quot;&quot; loading=&quot;lazy&quot; referrerpolicy=&quot;no-referrer&quot;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;/**
 * 校验组定义
 */&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ValidationGroups&lt;/span&gt; {
    &lt;span class=&quot;hljs-comment&quot;&gt;// 新增操作&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Create&lt;/span&gt; {}

    &lt;span class=&quot;hljs-comment&quot;&gt;// 更新操作&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Update&lt;/span&gt; {}

    &lt;span class=&quot;hljs-comment&quot;&gt;// 删除操作&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Delete&lt;/span&gt; {}

    &lt;span class=&quot;hljs-comment&quot;&gt;// 默认组（不指定group时使用）&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Default&lt;/span&gt; {}
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-11&quot;&gt;3.3 在实体类中使用分组&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Data&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;UserDTO&lt;/span&gt; {

    &lt;span class=&quot;hljs-comment&quot;&gt;// 创建时ID必须为空，更新时ID不能为空&lt;/span&gt;
    &lt;span class=&quot;hljs-meta&quot;&gt;@Null(groups = ValidationGroups.Create.class,
          message = &quot;创建用户时ID必须为空&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-meta&quot;&gt;@NotNull(groups = {ValidationGroups.Update.class,
                       ValidationGroups.Delete.class},
              message = &quot;更新/删除用户时ID不能为空&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Long id;

    &lt;span class=&quot;hljs-meta&quot;&gt;@NotBlank(groups = {ValidationGroups.Create.class,
                        ValidationGroups.Update.class},
               message = &quot;用户名不能为空&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-meta&quot;&gt;@Size(min = 3, max = 20,
          groups = {ValidationGroups.Create.class,
                    ValidationGroups.Update.class},
          message = &quot;用户名长度必须在3-20之间&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String username;

    &lt;span class=&quot;hljs-meta&quot;&gt;@Email(groups = ValidationGroups.Create.class,
           message = &quot;邮箱格式不正确&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-meta&quot;&gt;@NotBlank(groups = ValidationGroups.Create.class,
              message = &quot;邮箱不能为空&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String email;

    &lt;span class=&quot;hljs-comment&quot;&gt;// 创建时密码必填，更新时可选&lt;/span&gt;
    &lt;span class=&quot;hljs-meta&quot;&gt;@NotBlank(groups = ValidationGroups.Create.class,
              message = &quot;密码不能为空&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-meta&quot;&gt;@Size(min = 6, max = 20,
          groups = ValidationGroups.Create.class,
          message = &quot;密码长度必须在6-20之间&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String password;

    &lt;span class=&quot;hljs-meta&quot;&gt;@NotNull(groups = ValidationGroups.Create.class,
             message = &quot;年龄不能为空&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-meta&quot;&gt;@Min(value = 18, groups = ValidationGroups.Create.class,
         message = &quot;年龄必须大于等于18岁&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Integer age;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-12&quot;&gt;3.4 使用校验组&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@RestController&lt;/span&gt;
&lt;span class=&quot;hljs-meta&quot;&gt;@RequestMapping(&quot;/api/users&quot;)&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;UserController&lt;/span&gt; {

    &lt;span class=&quot;hljs-meta&quot;&gt;@PostMapping&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; ResponseEntity&amp;lt;?&amp;gt; create(
            &lt;span class=&quot;hljs-meta&quot;&gt;@Validated(ValidationGroups.Create.class)&lt;/span&gt;
            &lt;span class=&quot;hljs-meta&quot;&gt;@RequestBody&lt;/span&gt; UserDTO userDTO) {
        &lt;span class=&quot;hljs-comment&quot;&gt;// 只校验Create组中定义的规则&lt;/span&gt;
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; ResponseEntity.ok(&lt;span class=&quot;hljs-string&quot;&gt;&quot;创建成功&quot;&lt;/span&gt;);
    }

    &lt;span class=&quot;hljs-meta&quot;&gt;@PutMapping(&quot;/{id}&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; ResponseEntity&amp;lt;?&amp;gt; update(
            &lt;span class=&quot;hljs-meta&quot;&gt;@PathVariable&lt;/span&gt; Long id,
            &lt;span class=&quot;hljs-meta&quot;&gt;@Validated(ValidationGroups.Update.class)&lt;/span&gt;
            &lt;span class=&quot;hljs-meta&quot;&gt;@RequestBody&lt;/span&gt; UserDTO userDTO) {
        &lt;span class=&quot;hljs-comment&quot;&gt;// 只校验Update组中定义的规则&lt;/span&gt;
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; ResponseEntity.ok(&lt;span class=&quot;hljs-string&quot;&gt;&quot;更新成功&quot;&lt;/span&gt;);
    }

    &lt;span class=&quot;hljs-meta&quot;&gt;@DeleteMapping(&quot;/{id}&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; ResponseEntity&amp;lt;?&amp;gt; delete(
            &lt;span class=&quot;hljs-meta&quot;&gt;@PathVariable&lt;/span&gt; Long id,
            &lt;span class=&quot;hljs-meta&quot;&gt;@Validated(ValidationGroups.Delete.class)&lt;/span&gt;
            &lt;span class=&quot;hljs-meta&quot;&gt;@RequestBody&lt;/span&gt; UserDTO userDTO) {
        &lt;span class=&quot;hljs-comment&quot;&gt;// 只校验Delete组中定义的规则&lt;/span&gt;
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; ResponseEntity.ok(&lt;span class=&quot;hljs-string&quot;&gt;&quot;删除成功&quot;&lt;/span&gt;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-13&quot;&gt;3.5 组序列（Group Sequence）&lt;/h3&gt;
&lt;p&gt;控制校验组的执行顺序，默认按照定义的顺序依次校验：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@GroupSequence({CreateGroup.class, UpdateGroup.class, Default.class})&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;OrderedGroup&lt;/span&gt; {
}

&lt;span class=&quot;hljs-meta&quot;&gt;@RestController&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;UserController&lt;/span&gt; {
    &lt;span class=&quot;hljs-meta&quot;&gt;@PostMapping&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; ResponseEntity&amp;lt;?&amp;gt; create(
            &lt;span class=&quot;hljs-meta&quot;&gt;@Validated(OrderedGroup.class)&lt;/span&gt;
            &lt;span class=&quot;hljs-meta&quot;&gt;@RequestBody&lt;/span&gt; UserDTO userDTO) {
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; ResponseEntity.ok(&lt;span class=&quot;hljs-string&quot;&gt;&quot;创建成功&quot;&lt;/span&gt;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;注意&lt;/strong&gt;：一旦某个组校验失败，后续组不会再执行。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 data-id=&quot;heading-14&quot;&gt;四、自定义校验注解&lt;/h2&gt;
&lt;h3 data-id=&quot;heading-15&quot;&gt;4.1 自定义注解的应用场景&lt;/h3&gt;
&lt;p&gt;当内置注解无法满足需求时，可以创建自定义校验注解：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;手机号校验&lt;/strong&gt;：&lt;code&gt;@PhoneNumber&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;身份证号校验&lt;/strong&gt;：&lt;code&gt;@IdCard&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;枚举值校验&lt;/strong&gt;：&lt;code&gt;@EnumValue&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;字段互斥&lt;/strong&gt;：&lt;code&gt;@FieldMatch&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;密码强度&lt;/strong&gt;：&lt;code&gt;@StrongPassword&lt;/code&gt;
&lt;img src=&quot;https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40dbc0b98824465892fe717247363428~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;amp;x-expires=1768972030&amp;amp;x-signature=KIiUfm%2B15Kz1E62e9vbPJSa5toY%3D&quot; alt=&quot;&quot; loading=&quot;lazy&quot; referrerpolicy=&quot;no-referrer&quot;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 data-id=&quot;heading-16&quot;&gt;4.2 实现手机号校验注解&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;第一步：定义注解&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Target({ElementType.FIELD, ElementType.PARAMETER})&lt;/span&gt;
&lt;span class=&quot;hljs-meta&quot;&gt;@Retention(RetentionPolicy.RUNTIME)&lt;/span&gt;
&lt;span class=&quot;hljs-meta&quot;&gt;@Constraint(validatedBy = PhoneNumberValidator.class)&lt;/span&gt;
&lt;span class=&quot;hljs-meta&quot;&gt;@Documented&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-meta&quot;&gt;@interface&lt;/span&gt; PhoneNumber {

    &lt;span class=&quot;hljs-comment&quot;&gt;// 必须的三个属性&lt;/span&gt;
    String &lt;span class=&quot;hljs-title function_&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;手机号格式不正确&quot;&lt;/span&gt;;

    Class&amp;lt;?&amp;gt;[] groups() &lt;span class=&quot;hljs-keyword&quot;&gt;default&lt;/span&gt; {};

    Class&amp;lt;? &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Payload&lt;/span&gt;&amp;gt;[] payload() &lt;span class=&quot;hljs-keyword&quot;&gt;default&lt;/span&gt; {};

    &lt;span class=&quot;hljs-comment&quot;&gt;// 自定义属性：是否支持国际化号码&lt;/span&gt;
    &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;international&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;

    &lt;span class=&quot;hljs-comment&quot;&gt;// 自定义属性：支持的国家代码&lt;/span&gt;
    String[] countryCodes() &lt;span class=&quot;hljs-keyword&quot;&gt;default&lt;/span&gt; {&lt;span class=&quot;hljs-string&quot;&gt;&quot;+86&quot;&lt;/span&gt;};
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;第二步：实现校验器&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;PhoneNumberValidator&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ConstraintValidator&lt;/span&gt;&amp;lt;PhoneNumber, String&amp;gt; {

    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; international;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String[] countryCodes;

    &lt;span class=&quot;hljs-comment&quot;&gt;// 中国大陆手机号正则&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;CHINA_PHONE_PATTERN&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;
        &lt;span class=&quot;hljs-string&quot;&gt;&quot;^1[3-9]\\d{9}$&quot;&lt;/span&gt;;

    &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;initialize&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(PhoneNumber constraintAnnotation)&lt;/span&gt; {
        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;.international = constraintAnnotation.international();
        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;.countryCodes = constraintAnnotation.countryCodes();
    }

    &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;isValid&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(String value,
                          ConstraintValidatorContext context)&lt;/span&gt; {
        &lt;span class=&quot;hljs-comment&quot;&gt;// null值由@NotNull处理&lt;/span&gt;
        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (value == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;
        }

        &lt;span class=&quot;hljs-comment&quot;&gt;// 国际号码校验&lt;/span&gt;
        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (international) {
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; validateInternational(value);
        }

        &lt;span class=&quot;hljs-comment&quot;&gt;// 中国手机号校验&lt;/span&gt;
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; value.matches(CHINA_PHONE_PATTERN);
    }

    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;validateInternational&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(String phone)&lt;/span&gt; {
        &lt;span class=&quot;hljs-comment&quot;&gt;// 简单的国际号码校验逻辑&lt;/span&gt;
        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (String code : countryCodes) {
            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (phone.startsWith(code)) {
                &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;number&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; phone.substring(code.length());
                &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; number.matches(&lt;span class=&quot;hljs-string&quot;&gt;&quot;^\\d{6,15}$&quot;&lt;/span&gt;);
            }
        }
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;第三步：使用注解&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Data&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;UserDTO&lt;/span&gt; {
    &lt;span class=&quot;hljs-meta&quot;&gt;@PhoneNumber(message = &quot;手机号格式不正确&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String mobile;

    &lt;span class=&quot;hljs-meta&quot;&gt;@PhoneNumber(international = true,
                countryCodes = {&quot;+86&quot;, &quot;+1&quot;, &quot;+44&quot;},
                message = &quot;国际手机号格式不正确&quot;)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String internationalPhone;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-17&quot;&gt;4.3 实现密码强度校验&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;注解定义&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Target({ElementType.FIELD, ElementType.PARAMETER})&lt;/span&gt;
&lt;span class=&quot;hljs-meta&quot;&gt;@Retention(RetentionPolicy.RUNTIME)&lt;/span&gt;
&lt;span class=&quot;hljs-meta&quot;&gt;@Constraint(validatedBy = StrongPasswordValidator.class)&lt;/span&gt;
&lt;span class=&quot;hljs-meta&quot;&gt;@Documented&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-meta&quot;&gt;@interface&lt;/span&gt; StrongPassword {

    String &lt;span class=&quot;hljs-title function_&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;密码强度不足&quot;&lt;/span&gt;;

    Class&amp;lt;?&amp;gt;[] groups() &lt;span class=&quot;hljs-keyword&quot;&gt;default&lt;/span&gt; {};

    Class&amp;lt;? &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Payload&lt;/span&gt;&amp;gt;[] payload() &lt;span class=&quot;hljs-keyword&quot;&gt;default&lt;/span&gt; {};

    &lt;span class=&quot;hljs-comment&quot;&gt;// 最小长度&lt;/span&gt;
    &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;minLength&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;;

    &lt;span class=&quot;hljs-comment&quot;&gt;// 是否需要大写字母&lt;/span&gt;
    &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;requireUppercase&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;

    &lt;span class=&quot;hljs-comment&quot;&gt;// 是否需要小写字母&lt;/span&gt;
    &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;requireLowercase&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;

    &lt;span class=&quot;hljs-comment&quot;&gt;// 是否需要数字&lt;/span&gt;
    &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;requireDigit&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;

    &lt;span class=&quot;hljs-comment&quot;&gt;// 是否需要特殊字符&lt;/span&gt;
    &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;requireSpecialChar&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;校验器实现&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;StrongPasswordValidator&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ConstraintValidator&lt;/span&gt;&amp;lt;StrongPassword, String&amp;gt; {

    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; minLength;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; requireUppercase;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; requireLowercase;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; requireDigit;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; requireSpecialChar;

    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Pattern&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;UPPERCASE_PATTERN&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;
        Pattern.compile(&lt;span class=&quot;hljs-string&quot;&gt;&quot;[A-Z]&quot;&lt;/span&gt;);
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Pattern&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;LOWERCASE_PATTERN&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;
        Pattern.compile(&lt;span class=&quot;hljs-string&quot;&gt;&quot;[a-z]&quot;&lt;/span&gt;);
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Pattern&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;DIGIT_PATTERN&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;
        Pattern.compile(&lt;span class=&quot;hljs-string&quot;&gt;&quot;\\d&quot;&lt;/span&gt;);
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Pattern&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;SPECIAL_CHAR_PATTERN&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt;
        Pattern.compile(&lt;span class=&quot;hljs-string&quot;&gt;&quot;[!@#$%^&amp;amp;*()_+\\-=\\[\\]{};&#39;:\&quot;\\\\|,.&amp;lt;&amp;gt;\\/?]&quot;&lt;/span&gt;);

    &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;initialize&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(StrongPassword constraintAnnotation)&lt;/span&gt; {
        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;.minLength = constraintAnnotation.minLength();
        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;.requireUppercase = constraintAnnotation.requireUppercase();
        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;.requireLowercase = constraintAnnotation.requireLowercase();
        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;.requireDigit = constraintAnnotation.requireDigit();
        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;.requireSpecialChar = constraintAnnotation.requireSpecialChar();
    }

    &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;isValid&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(String password,
                          ConstraintValidatorContext context)&lt;/span&gt; {
        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (password == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;
        }

        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (password.length() &amp;lt; minLength) {
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;
        }

        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (requireUppercase &amp;amp;&amp;amp; !UPPERCASE_PATTERN.matcher(password).find()) {
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;
        }

        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (requireLowercase &amp;amp;&amp;amp; !LOWERCASE_PATTERN.matcher(password).find()) {
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;
        }

        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (requireDigit &amp;amp;&amp;amp; !DIGIT_PATTERN.matcher(password).find()) {
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;
        }

        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (requireSpecialChar &amp;amp;&amp;amp; !SPECIAL_CHAR_PATTERN.matcher(password).find()) {
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;
        }

        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-18&quot;&gt;4.4 跨字段校验&lt;/h3&gt;
&lt;p&gt;实现&quot;密码&quot;和&quot;确认密码&quot;必须一致的校验：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注解定义&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Target({ElementType.TYPE})&lt;/span&gt;
&lt;span class=&quot;hljs-meta&quot;&gt;@Retention(RetentionPolicy.RUNTIME)&lt;/span&gt;
&lt;span class=&quot;hljs-meta&quot;&gt;@Constraint(validatedBy = FieldMatchValidator.class)&lt;/span&gt;
&lt;span class=&quot;hljs-meta&quot;&gt;@Documented&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-meta&quot;&gt;@interface&lt;/span&gt; FieldMatch {

    String &lt;span class=&quot;hljs-title function_&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;字段值不匹配&quot;&lt;/span&gt;;

    Class&amp;lt;?&amp;gt;[] groups() &lt;span class=&quot;hljs-keyword&quot;&gt;default&lt;/span&gt; {};

    Class&amp;lt;? &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Payload&lt;/span&gt;&amp;gt;[] payload() &lt;span class=&quot;hljs-keyword&quot;&gt;default&lt;/span&gt; {};

    &lt;span class=&quot;hljs-comment&quot;&gt;// 第一个字段名&lt;/span&gt;
    String &lt;span class=&quot;hljs-title function_&quot;&gt;first&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;;

    &lt;span class=&quot;hljs-comment&quot;&gt;// 第二个字段名&lt;/span&gt;
    String &lt;span class=&quot;hljs-title function_&quot;&gt;second&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;校验器实现&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;FieldMatchValidator&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ConstraintValidator&lt;/span&gt;&amp;lt;FieldMatch, Object&amp;gt; {

    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String firstFieldName;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String secondFieldName;

    &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;initialize&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(FieldMatch constraintAnnotation)&lt;/span&gt; {
        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;.firstFieldName = constraintAnnotation.first();
        &lt;span class=&quot;hljs-built_in&quot;&gt;this&lt;/span&gt;.secondFieldName = constraintAnnotation.second();
    }

    &lt;span class=&quot;hljs-meta&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;isValid&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Object value,
                          ConstraintValidatorContext context)&lt;/span&gt; {
        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (value == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;
        }

        &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {
            &lt;span class=&quot;hljs-type&quot;&gt;Field&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;firstField&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; value.getClass().getDeclaredField(firstFieldName);
            firstField.setAccessible(&lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;);
            &lt;span class=&quot;hljs-type&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;firstValue&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; firstField.get(value);

            &lt;span class=&quot;hljs-type&quot;&gt;Field&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;secondField&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; value.getClass().getDeclaredField(secondFieldName);
            secondField.setAccessible(&lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;);
            &lt;span class=&quot;hljs-type&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;secondValue&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; secondField.get(value);

            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; Objects.equals(firstValue, secondValue);
        } &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;使用示例&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Data&lt;/span&gt;
&lt;span class=&quot;hljs-meta&quot;&gt;@FieldMatch(first = &quot;password&quot;, second = &quot;confirmPassword&quot;,
            message = &quot;两次输入的密码不一致&quot;)&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;RegisterRequest&lt;/span&gt; {
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String username;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String password;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String confirmPassword;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;h2 data-id=&quot;heading-19&quot;&gt;五、生产环境实战&lt;/h2&gt;
&lt;h3 data-id=&quot;heading-20&quot;&gt;5.1 统一异常处理&lt;/h3&gt;
&lt;p&gt;在生产环境中，需要统一处理校验异常：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/efe07446f944468d9855d0cd8fcaef87~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;amp;x-expires=1768972030&amp;amp;x-signature=OBcyPGTdfVZ9uRxWapk6Akd36CY%3D&quot; alt=&quot;&quot; loading=&quot;lazy&quot; referrerpolicy=&quot;no-referrer&quot;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@RestControllerAdvice&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;GlobalExceptionHandler&lt;/span&gt; {

    &lt;span class=&quot;hljs-comment&quot;&gt;/**
     * 处理 &lt;span class=&quot;hljs-doctag&quot;&gt;@Valid&lt;/span&gt; 触发的校验异常
     */&lt;/span&gt;
    &lt;span class=&quot;hljs-meta&quot;&gt;@ExceptionHandler(MethodArgumentNotValidException.class)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; ResponseEntity&amp;lt;ErrorResponse&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;handleValidationException&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(
            MethodArgumentNotValidException ex)&lt;/span&gt; {

        List&amp;lt;String&amp;gt; errors = ex.getBindingResult()
            .getFieldErrors()
            .stream()
            .map(error -&amp;gt; error.getField() + &lt;span class=&quot;hljs-string&quot;&gt;&quot;: &quot;&lt;/span&gt; + error.getDefaultMessage())
            .collect(Collectors.toList());

        &lt;span class=&quot;hljs-type&quot;&gt;ErrorResponse&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;response&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; ErrorResponse.builder()
            .code(&lt;span class=&quot;hljs-number&quot;&gt;400&lt;/span&gt;)
            .message(&lt;span class=&quot;hljs-string&quot;&gt;&quot;参数校验失败&quot;&lt;/span&gt;)
            .errors(errors)
            .timestamp(LocalDateTime.now())
            .build();

        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; ResponseEntity.badRequest().body(response);
    }

    &lt;span class=&quot;hljs-comment&quot;&gt;/**
     * 处理 &lt;span class=&quot;hljs-doctag&quot;&gt;@Validated&lt;/span&gt; 触发的校验异常
     */&lt;/span&gt;
    &lt;span class=&quot;hljs-meta&quot;&gt;@ExceptionHandler(ConstraintViolationException.class)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; ResponseEntity&amp;lt;ErrorResponse&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;handleConstraintViolation&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(
            ConstraintViolationException ex)&lt;/span&gt; {

        List&amp;lt;String&amp;gt; errors = ex.getConstraintViolations()
            .stream()
            .map(violation -&amp;gt; violation.getPropertyPath() + &lt;span class=&quot;hljs-string&quot;&gt;&quot;: &quot;&lt;/span&gt; + violation.getMessage())
            .collect(Collectors.toList());

        &lt;span class=&quot;hljs-type&quot;&gt;ErrorResponse&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;response&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; ErrorResponse.builder()
            .code(&lt;span class=&quot;hljs-number&quot;&gt;400&lt;/span&gt;)
            .message(&lt;span class=&quot;hljs-string&quot;&gt;&quot;参数校验失败&quot;&lt;/span&gt;)
            .errors(errors)
            .timestamp(LocalDateTime.now())
            .build();

        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; ResponseEntity.badRequest().body(response);
    }

    &lt;span class=&quot;hljs-comment&quot;&gt;/**
     * 处理请求参数绑定异常
     */&lt;/span&gt;
    &lt;span class=&quot;hljs-meta&quot;&gt;@ExceptionHandler(BindException.class)&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; ResponseEntity&amp;lt;ErrorResponse&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;handleBindException&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(BindException ex)&lt;/span&gt; {
        List&amp;lt;String&amp;gt; errors = ex.getBindingResult()
            .getFieldErrors()
            .stream()
            .map(error -&amp;gt; error.getField() + &lt;span class=&quot;hljs-string&quot;&gt;&quot;: &quot;&lt;/span&gt; + error.getDefaultMessage())
            .collect(Collectors.toList());

        &lt;span class=&quot;hljs-type&quot;&gt;ErrorResponse&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;response&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; ErrorResponse.builder()
            .code(&lt;span class=&quot;hljs-number&quot;&gt;400&lt;/span&gt;)
            .message(&lt;span class=&quot;hljs-string&quot;&gt;&quot;参数绑定失败&quot;&lt;/span&gt;)
            .errors(errors)
            .timestamp(LocalDateTime.now())
            .build();

        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; ResponseEntity.badRequest().body(response);
    }
}

&lt;span class=&quot;hljs-meta&quot;&gt;@Data&lt;/span&gt;
&lt;span class=&quot;hljs-meta&quot;&gt;@Builder&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ErrorResponse&lt;/span&gt; {
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Integer code;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String message;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; List&amp;lt;String&amp;gt; errors;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; LocalDateTime timestamp;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-21&quot;&gt;5.2 快速失败机制&lt;/h3&gt;
&lt;p&gt;默认情况下，Bean Validation会校验所有约束并返回所有错误。如果需要在第一个错误时就停止：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Configuration&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ValidationConfig&lt;/span&gt; {

    &lt;span class=&quot;hljs-meta&quot;&gt;@Bean&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; Validator &lt;span class=&quot;hljs-title function_&quot;&gt;validator&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {
        &lt;span class=&quot;hljs-type&quot;&gt;ValidatorFactory&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;factory&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; Validation.byDefaultProvider()
            .configure()
            .failFast(&lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;)  &lt;span class=&quot;hljs-comment&quot;&gt;// 启用快速失败&lt;/span&gt;
            .buildValidatorFactory();
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; factory.getValidator();
    }

    &lt;span class=&quot;hljs-meta&quot;&gt;@Bean&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; MethodValidationPostProcessor &lt;span class=&quot;hljs-title function_&quot;&gt;methodValidationPostProcessor&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {
        &lt;span class=&quot;hljs-type&quot;&gt;MethodValidationPostProcessor&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;processor&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;MethodValidationPostProcessor&lt;/span&gt;();
        processor.setValidator(validator());
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; processor;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-22&quot;&gt;5.4 手动触发校验&lt;/h3&gt;
&lt;p&gt;在Service层手动触发校验：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@Service&lt;/span&gt;
&lt;span class=&quot;hljs-meta&quot;&gt;@RequiredArgsConstructor&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;UserService&lt;/span&gt; {

    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;final&lt;/span&gt; Validator validator;

    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;createUser&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(UserDTO userDTO)&lt;/span&gt; {
        &lt;span class=&quot;hljs-comment&quot;&gt;// 手动校验&lt;/span&gt;
        Set&amp;lt;ConstraintViolation&amp;lt;UserDTO&amp;gt;&amp;gt; violations =
            validator.validate(userDTO, Default.class);

        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!violations.isEmpty()) {
            &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ConstraintViolationException&lt;/span&gt;(violations);
        }

        &lt;span class=&quot;hljs-comment&quot;&gt;// 业务逻辑...&lt;/span&gt;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;h2 data-id=&quot;heading-23&quot;&gt;六、最佳实践&lt;/h2&gt;
&lt;h3 data-id=&quot;heading-24&quot;&gt;6.1 设计原则&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;单一职责&lt;/strong&gt;：每个注解只负责一个校验规则&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;组合使用&lt;/strong&gt;：多个简单注解组合成复杂规则&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;错误消息清晰&lt;/strong&gt;：提供具体、可操作的错误提示&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;分组管理&lt;/strong&gt;：使用校验组区分不同场景&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;自定义注解&lt;/strong&gt;：复杂业务逻辑创建自定义注解&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 data-id=&quot;heading-25&quot;&gt;6.2 性能优化&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;避免过度校验&lt;/strong&gt;：只校验必要的数据&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;校验顺序&lt;/strong&gt;：将简单的校验放在前面&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;缓存Validator&lt;/strong&gt;：Validator实例可以复用&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;异步校验&lt;/strong&gt;：对于复杂校验，考虑异步处理&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 data-id=&quot;heading-26&quot;&gt;七、总结&lt;/h2&gt;
&lt;p&gt;本文系统地介绍了Java注解校验的核心概念和实践：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;@Valid vs @Validated&lt;/strong&gt;：理解两者的区别和适用场景&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;校验组&lt;/strong&gt;：使用分组管理不同场景的校验规则&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;自定义注解&lt;/strong&gt;：创建符合业务需求的校验注解&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;生产实践&lt;/strong&gt;：异常处理、国际化、性能优化&lt;/li&gt;
&lt;/ol&gt;</description><link>https://juejin.cn/post/7594843125320712218</link><guid isPermaLink="false">https://juejin.cn/post/7594843125320712218</guid><pubDate>Wed, 14 Jan 2026 05:06:26 GMT</pubDate><author>雨中飘荡的记忆</author><category>后端</category><category>Java</category></item><item><title>Spring Boot多数据源配置实战指南：从选型到落地优化</title><description>Spring Boot多数据源配置实战指南：从选型到落地优化 在后端开发中，随着业务复杂度提升，单一数据源往往无法满足需求——比如电商系统需要区分订单库与用户库、数据归档场景需要同时操作业务库与历史库</description><link>https://juejin.cn/post/7594854295746707492</link><guid isPermaLink="false">https://juejin.cn/post/7594854295746707492</guid><pubDate>Wed, 14 Jan 2026 03:51:14 GMT</pubDate><author>回家路上绕了弯</author><category>后端</category><category>分布式</category></item><item><title>ebpf检测Linux系统要来了</title><description>哈喽，我是子牙老师，深耕计算机底层，手写过操作系统、Linux 内核等核心技术。此前推出《手写生产级 eBPF 内存监测工具》，结合学员需求，决定将工具升级为通用 Linux 系统检测工具！</description><link>https://juejin.cn/post/7594859060857225226</link><guid isPermaLink="false">https://juejin.cn/post/7594859060857225226</guid><pubDate>Wed, 14 Jan 2026 03:46:00 GMT</pubDate><author>硬核子牙</author><category>后端</category><category>Linux</category></item><item><title>Node.js 编程实战：博客系统 —— 数据库设计</title><description>&lt;blockquote&gt;
&lt;p&gt;在构建 Node.js 博客系统时，数据库设计是整个项目的核心环节。一个合理的数据库设计不仅可以保证数据存储的完整性和一致性，还能为后续功能扩展和性能优化奠定基础。本文将围绕博客系统的数据库建模、关系设计、索引优化和扩展性考虑，帮助你建立一个可维护的数据库结构。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h2 data-id=&quot;heading-0&quot;&gt;一、数据库设计的重要性&lt;/h2&gt;
&lt;p&gt;数据库设计是博客系统的根基。它决定了：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;• 数据存储结构是否合理&lt;/li&gt;
&lt;li&gt;• 功能扩展是否顺畅&lt;/li&gt;
&lt;li&gt;• 查询性能是否高效&lt;/li&gt;
&lt;li&gt;• 数据一致性是否有保障&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;如果在项目初期忽略数据库设计，后续改表和扩展功能会带来大量重复工作。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 data-id=&quot;heading-1&quot;&gt;二、博客系统核心数据模型&lt;/h2&gt;
&lt;p&gt;根据需求分析，博客系统主要包含以下核心模块：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;ol&gt;
&lt;li&gt;用户（Users）&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;文章（Articles）&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;分类（Categories）&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;标签（Tags）&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;评论（Comments）&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;日志/操作记录（可选）&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;接下来我们逐一分析设计思路。&lt;/p&gt;
&lt;hr&gt;
&lt;h3 data-id=&quot;heading-2&quot;&gt;1. 用户表（Users）&lt;/h3&gt;
&lt;p&gt;用户表保存所有注册用户和管理员的信息。&lt;/p&gt;
&lt;p&gt;常见字段设计：&lt;/p&gt;













































&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;字段名&lt;/th&gt;&lt;th&gt;类型&lt;/th&gt;&lt;th&gt;描述&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;id&lt;/td&gt;&lt;td&gt;BIGINT / UUID&lt;/td&gt;&lt;td&gt;主键，自增或全局唯一&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;username&lt;/td&gt;&lt;td&gt;VARCHAR(50)&lt;/td&gt;&lt;td&gt;用户名，唯一&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;password&lt;/td&gt;&lt;td&gt;VARCHAR(255)&lt;/td&gt;&lt;td&gt;加密后的密码&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;email&lt;/td&gt;&lt;td&gt;VARCHAR(100)&lt;/td&gt;&lt;td&gt;邮箱，可用于登录或找回密码&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;role&lt;/td&gt;&lt;td&gt;ENUM&lt;/td&gt;&lt;td&gt;用户角色（user/admin）&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;created_at&lt;/td&gt;&lt;td&gt;DATETIME&lt;/td&gt;&lt;td&gt;创建时间&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;updated_at&lt;/td&gt;&lt;td&gt;DATETIME&lt;/td&gt;&lt;td&gt;更新时间&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;安全提示：密码必须加密存储，推荐使用 bcrypt 或 Argon2。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 data-id=&quot;heading-3&quot;&gt;2. 文章表（Articles）&lt;/h3&gt;
&lt;p&gt;文章表是博客的核心数据表，需要考虑内容、状态和统计字段。&lt;/p&gt;
&lt;p&gt;常见字段设计：&lt;/p&gt;























































&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;字段名&lt;/th&gt;&lt;th&gt;类型&lt;/th&gt;&lt;th&gt;描述&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;id&lt;/td&gt;&lt;td&gt;BIGINT&lt;/td&gt;&lt;td&gt;主键，自增&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;title&lt;/td&gt;&lt;td&gt;VARCHAR(255)&lt;/td&gt;&lt;td&gt;文章标题&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;content&lt;/td&gt;&lt;td&gt;TEXT&lt;/td&gt;&lt;td&gt;文章内容&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;author_id&lt;/td&gt;&lt;td&gt;BIGINT&lt;/td&gt;&lt;td&gt;外键，关联 Users 表&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;category_id&lt;/td&gt;&lt;td&gt;BIGINT&lt;/td&gt;&lt;td&gt;外键，关联 Categories 表&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;status&lt;/td&gt;&lt;td&gt;ENUM&lt;/td&gt;&lt;td&gt;发布状态（draft/published）&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;views&lt;/td&gt;&lt;td&gt;INT&lt;/td&gt;&lt;td&gt;浏览量&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;created_at&lt;/td&gt;&lt;td&gt;DATETIME&lt;/td&gt;&lt;td&gt;创建时间&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;updated_at&lt;/td&gt;&lt;td&gt;DATETIME&lt;/td&gt;&lt;td&gt;更新时间&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;
&lt;p&gt;文章表与用户表是一对多关系，一个用户可以发布多篇文章。&lt;/p&gt;
&lt;hr&gt;
&lt;h3 data-id=&quot;heading-4&quot;&gt;3. 分类表（Categories）&lt;/h3&gt;
&lt;p&gt;分类表用于组织文章，便于用户筛选。&lt;/p&gt;
&lt;p&gt;字段设计：&lt;/p&gt;






























&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;字段名&lt;/th&gt;&lt;th&gt;类型&lt;/th&gt;&lt;th&gt;描述&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;id&lt;/td&gt;&lt;td&gt;BIGINT&lt;/td&gt;&lt;td&gt;主键，自增&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;name&lt;/td&gt;&lt;td&gt;VARCHAR(50)&lt;/td&gt;&lt;td&gt;分类名称&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;created_at&lt;/td&gt;&lt;td&gt;DATETIME&lt;/td&gt;&lt;td&gt;创建时间&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;updated_at&lt;/td&gt;&lt;td&gt;DATETIME&lt;/td&gt;&lt;td&gt;更新时间&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;
&lt;p&gt;文章表的&amp;nbsp;&lt;code&gt;category_id&lt;/code&gt;&amp;nbsp;与分类表建立外键关联。&lt;/p&gt;
&lt;hr&gt;
&lt;h3 data-id=&quot;heading-5&quot;&gt;4. 标签表（Tags）与文章标签关系表（ArticleTags）&lt;/h3&gt;
&lt;p&gt;标签是多对多关系，每篇文章可以有多个标签，每个标签也可以关联多篇文章。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;• 标签表（Tags）&lt;/li&gt;
&lt;/ul&gt;

























&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;字段名&lt;/th&gt;&lt;th&gt;类型&lt;/th&gt;&lt;th&gt;描述&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;id&lt;/td&gt;&lt;td&gt;BIGINT&lt;/td&gt;&lt;td&gt;主键，自增&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;name&lt;/td&gt;&lt;td&gt;VARCHAR(50)&lt;/td&gt;&lt;td&gt;标签名称&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;created_at&lt;/td&gt;&lt;td&gt;DATETIME&lt;/td&gt;&lt;td&gt;创建时间&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;• 文章标签关系表（ArticleTags）&lt;/li&gt;
&lt;/ul&gt;




















&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;字段名&lt;/th&gt;&lt;th&gt;类型&lt;/th&gt;&lt;th&gt;描述&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;article_id&lt;/td&gt;&lt;td&gt;BIGINT&lt;/td&gt;&lt;td&gt;外键，关联 Articles&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;tag_id&lt;/td&gt;&lt;td&gt;BIGINT&lt;/td&gt;&lt;td&gt;外键，关联 Tags&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;
&lt;p&gt;这种设计便于高效查询文章的标签或标签下的文章列表。&lt;/p&gt;
&lt;hr&gt;
&lt;h3 data-id=&quot;heading-6&quot;&gt;5. 评论表（Comments）&lt;/h3&gt;
&lt;p&gt;评论表用于记录用户评论及互动信息。&lt;/p&gt;
&lt;p&gt;字段设计：&lt;/p&gt;


















































&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;字段名&lt;/th&gt;&lt;th&gt;类型&lt;/th&gt;&lt;th&gt;描述&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;id&lt;/td&gt;&lt;td&gt;BIGINT&lt;/td&gt;&lt;td&gt;主键，自增&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;article_id&lt;/td&gt;&lt;td&gt;BIGINT&lt;/td&gt;&lt;td&gt;外键，关联文章&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;user_id&lt;/td&gt;&lt;td&gt;BIGINT&lt;/td&gt;&lt;td&gt;外键，关联用户&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;parent_id&lt;/td&gt;&lt;td&gt;BIGINT&lt;/td&gt;&lt;td&gt;父评论ID（支持回复）&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;content&lt;/td&gt;&lt;td&gt;TEXT&lt;/td&gt;&lt;td&gt;评论内容&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;status&lt;/td&gt;&lt;td&gt;ENUM&lt;/td&gt;&lt;td&gt;评论状态（pending/approved/rejected）&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;created_at&lt;/td&gt;&lt;td&gt;DATETIME&lt;/td&gt;&lt;td&gt;创建时间&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;updated_at&lt;/td&gt;&lt;td&gt;DATETIME&lt;/td&gt;&lt;td&gt;更新时间&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;
&lt;p&gt;通过&amp;nbsp;&lt;code&gt;parent_id&lt;/code&gt;&amp;nbsp;支持评论的多级回复。&lt;/p&gt;
&lt;hr&gt;
&lt;h3 data-id=&quot;heading-7&quot;&gt;6. 日志表（可选）&lt;/h3&gt;
&lt;p&gt;日志表用于记录用户操作和系统事件，便于调试和审计。&lt;/p&gt;








































&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;字段名&lt;/th&gt;&lt;th&gt;类型&lt;/th&gt;&lt;th&gt;描述&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;id&lt;/td&gt;&lt;td&gt;BIGINT&lt;/td&gt;&lt;td&gt;主键，自增&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;user_id&lt;/td&gt;&lt;td&gt;BIGINT&lt;/td&gt;&lt;td&gt;操作者ID&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;action&lt;/td&gt;&lt;td&gt;VARCHAR(255)&lt;/td&gt;&lt;td&gt;操作类型&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;target_type&lt;/td&gt;&lt;td&gt;VARCHAR(50)&lt;/td&gt;&lt;td&gt;操作对象类型&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;target_id&lt;/td&gt;&lt;td&gt;BIGINT&lt;/td&gt;&lt;td&gt;操作对象ID&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;created_at&lt;/td&gt;&lt;td&gt;DATETIME&lt;/td&gt;&lt;td&gt;操作时间&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;
&lt;p&gt;日志表可根据业务需要灵活设计。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 data-id=&quot;heading-8&quot;&gt;三、数据库索引优化&lt;/h2&gt;
&lt;p&gt;为了提升查询性能，可以添加常用字段索引：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;• 文章表：&lt;code&gt;author_id&lt;/code&gt;、&lt;code&gt;category_id&lt;/code&gt;、&lt;code&gt;status&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;• 评论表：&lt;code&gt;article_id&lt;/code&gt;、&lt;code&gt;parent_id&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;• 用户表：&lt;code&gt;username&lt;/code&gt;、&lt;code&gt;email&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;索引可以加速查询，但过多索引会影响写入性能，需要平衡。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 data-id=&quot;heading-9&quot;&gt;四、关系模型总结&lt;/h2&gt;
&lt;p&gt;博客系统中主要关系：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;• 用户与文章：一对多&lt;/li&gt;
&lt;li&gt;• 用户与评论：一对多&lt;/li&gt;
&lt;li&gt;• 文章与分类：多对一&lt;/li&gt;
&lt;li&gt;• 文章与标签：多对多&lt;/li&gt;
&lt;li&gt;• 文章与评论：一对多&lt;/li&gt;
&lt;li&gt;• 评论与评论：一对多（支持多级回复）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;通过 ER 图可以直观理解整个数据模型。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 data-id=&quot;heading-10&quot;&gt;五、数据库扩展性考虑&lt;/h2&gt;
&lt;p&gt;未来博客系统可能会增加功能，例如：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;• 点赞 / 收藏功能&lt;/li&gt;
&lt;li&gt;• 文章访问统计&lt;/li&gt;
&lt;li&gt;• 多媒体资源管理&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;设计时应考虑：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;• 可扩展字段（JSON 类型或单独表）&lt;/li&gt;
&lt;li&gt;• 统一时间戳字段&lt;/li&gt;
&lt;li&gt;• 模块化表结构&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 data-id=&quot;heading-11&quot;&gt;六、总结&lt;/h2&gt;
&lt;p&gt;数据库设计是博客系统开发的基础。通过明确各模块的数据结构、关系和索引策略，可以保证系统既满足功能需求，又具备良好的性能和可维护性。&lt;/p&gt;
&lt;p&gt;在《Node.js 编程实战》中，数据库设计完成后，就可以进入&amp;nbsp;&lt;strong&gt;后端接口实现和业务逻辑开发阶段&lt;/strong&gt;，让系统真正可以运行。&lt;/p&gt;</description><link>https://juejin.cn/post/7594822511436333082</link><guid isPermaLink="false">https://juejin.cn/post/7594822511436333082</guid><pubDate>Wed, 14 Jan 2026 03:26:48 GMT</pubDate><author>程序员爱钓鱼</author><category>后端</category><category>前端</category><category>Node.js</category></item><item><title>Nginx分布式框架</title><description>Nginx 是一个高性能的HTTP和反向代理web服务器。 提供的服务： 动静分离（web 服务） 负载均衡 （反向代理） web 缓存 内存少，并发能力强。</description><link>https://juejin.cn/post/7594874733382336563</link><guid isPermaLink="false">https://juejin.cn/post/7594874733382336563</guid><pubDate>Wed, 14 Jan 2026 03:18:18 GMT</pubDate><author>优秀的颜</author><category>后端</category></item><item><title>Java Stream：Collectors.collectingAndThen() 用法详解</title><description>&lt;h2 data-id=&quot;heading-0&quot;&gt;一、基本概念&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Collectors.collectingAndThen()&lt;/code&gt; 是一个收集器适配器，允许在收集完成后对结果进行转换。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// 方法签名&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &amp;lt;T, A, R, RR&amp;gt; Collector&amp;lt;T, A, RR&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;collectingAndThen&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(
    Collector&amp;lt;T, A, R&amp;gt; downstream,  // 下游收集器
    Function&amp;lt;R, RR&amp;gt; finisher        // 最终转换函数
)&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;// 参数说明： &lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// T: 输入元素类型 (不变) &lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// A: 中间容器类型 (不变) &lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// R: 下游收集器的结果类型 &lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// RR: 最终结果类型（finisher转换后）&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;其中这里面涉及到的范型参数可以参考下面的解析：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Collector&lt;/span&gt;&amp;lt;T, A, R&amp;gt; {
    &lt;span class=&quot;hljs-comment&quot;&gt;// T: 流元素的类型（输入）&lt;/span&gt;
    &lt;span class=&quot;hljs-comment&quot;&gt;// A: 累加器的中间类型（容器）&lt;/span&gt;
    &lt;span class=&quot;hljs-comment&quot;&gt;// R: 最终结果的类型（输出）&lt;/span&gt;
    
    Supplier&amp;lt;A&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;supplier&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;;        &lt;span class=&quot;hljs-comment&quot;&gt;// 创建容器A&lt;/span&gt;
    BiConsumer&amp;lt;A, T&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;accumulator&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;; &lt;span class=&quot;hljs-comment&quot;&gt;// 将T累加到A&lt;/span&gt;
    BinaryOperator&amp;lt;A&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;combiner&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;;   &lt;span class=&quot;hljs-comment&quot;&gt;// 合并两个A（并行流）&lt;/span&gt;
    Function&amp;lt;A, R&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;finisher&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;;     &lt;span class=&quot;hljs-comment&quot;&gt;// 将A转换为R&lt;/span&gt;
    Set&amp;lt;Characteristics&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;characteristics&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;示例分析：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;List&amp;lt;String&amp;gt; list = Arrays.asList(&lt;span class=&quot;hljs-string&quot;&gt;&quot;a&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;b&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;c&quot;&lt;/span&gt;);

List&amp;lt;String&amp;gt; result = list.stream()
    .collect(Collectors.collectingAndThen(
        Collectors.toList(),        &lt;span class=&quot;hljs-comment&quot;&gt;// Collector&amp;lt;String, List&amp;lt;String&amp;gt;, List&amp;lt;String&amp;gt;&amp;gt;&lt;/span&gt;
        Collections::unmodifiableList &lt;span class=&quot;hljs-comment&quot;&gt;// Function&amp;lt;List&amp;lt;String&amp;gt;, List&amp;lt;String&amp;gt;&amp;gt;&lt;/span&gt;
    ));
    
&lt;span class=&quot;hljs-comment&quot;&gt;// 类型推导：&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// Collector&amp;lt;T=String, A=List&amp;lt;String&amp;gt;, R=List&amp;lt;String&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// Function&amp;lt;R=List&amp;lt;String&amp;gt;, RR=List&amp;lt;String&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// 最终 Collector&amp;lt;T=String, A=List&amp;lt;String&amp;gt;, RR=List&amp;lt;String&amp;gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 data-id=&quot;heading-1&quot;&gt;二、基本用法&lt;/h2&gt;
&lt;h3 data-id=&quot;heading-2&quot;&gt;示例1：收集为不可变集合&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;List&amp;lt;String&amp;gt; list = Arrays.asList(&lt;span class=&quot;hljs-string&quot;&gt;&quot;a&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;b&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;c&quot;&lt;/span&gt;);

&lt;span class=&quot;hljs-comment&quot;&gt;// 转换为不可修改的List&lt;/span&gt;
List&amp;lt;String&amp;gt; unmodifiableList = list.stream()
    .collect(Collectors.collectingAndThen(
        Collectors.toList(),       &lt;span class=&quot;hljs-comment&quot;&gt;// 先收集为List&lt;/span&gt;
        Collections::unmodifiableList  &lt;span class=&quot;hljs-comment&quot;&gt;// 再转换为不可修改&lt;/span&gt;
    ));

&lt;span class=&quot;hljs-comment&quot;&gt;// 尝试修改会抛出异常&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// unmodifiableList.add(&quot;d&quot;); // UnsupportedOperationException&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-3&quot;&gt;示例2：获取集合大小&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;List&amp;lt;String&amp;gt; list = Arrays.asList(&lt;span class=&quot;hljs-string&quot;&gt;&quot;a&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;b&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;c&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;d&quot;&lt;/span&gt;);

&lt;span class=&quot;hljs-comment&quot;&gt;// 直接计算集合大小&lt;/span&gt;
&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; list.stream()
    .collect(Collectors.collectingAndThen(
        Collectors.toList(),  &lt;span class=&quot;hljs-comment&quot;&gt;// 收集为List&lt;/span&gt;
        List::size            &lt;span class=&quot;hljs-comment&quot;&gt;// 转换为大小&lt;/span&gt;
    ));

System.out.println(size); &lt;span class=&quot;hljs-comment&quot;&gt;// 输出: 4&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-4&quot;&gt;示例3：分组后执行操作&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;List&amp;lt;Person&amp;gt; people = Arrays.asList(
    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Person&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Alice&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;New York&quot;&lt;/span&gt;),
    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Person&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Bob&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;New York&quot;&lt;/span&gt;),
    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Person&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Charlie&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;London&quot;&lt;/span&gt;)
);

&lt;span class=&quot;hljs-comment&quot;&gt;// 按城市分组，并获取每个组的数量&lt;/span&gt;
Map&amp;lt;String, Integer&amp;gt; cityCount = people.stream()
    .collect(Collectors.collectingAndThen(
        Collectors.groupingBy(Person::getCity),
        map -&amp;gt; {
            &lt;span class=&quot;hljs-comment&quot;&gt;// 对分组结果进行处理&lt;/span&gt;
            Map&amp;lt;String, Integer&amp;gt; result = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HashMap&lt;/span&gt;&amp;lt;&amp;gt;();
            map.forEach((city, list) -&amp;gt; result.put(city, list.size()));
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result;
        }
    ));
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-5&quot;&gt;示例4：获取最大值或最小值&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;List&amp;lt;Integer&amp;gt; numbers = Arrays.asList(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;);

&lt;span class=&quot;hljs-comment&quot;&gt;// 获取最大值，如果没有则返回默认值&lt;/span&gt;
&lt;span class=&quot;hljs-type&quot;&gt;Integer&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;max&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; numbers.stream()
    .collect(Collectors.collectingAndThen(
        Collectors.maxBy(Integer::compareTo),
        opt -&amp;gt; opt.orElse(-&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)  &lt;span class=&quot;hljs-comment&quot;&gt;// 处理Optional&lt;/span&gt;
    ));

System.out.println(max); &lt;span class=&quot;hljs-comment&quot;&gt;// 输出: 5&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-6&quot;&gt;示例5：连接字符串并添加前缀后缀&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;List&amp;lt;String&amp;gt; words = Arrays.asList(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Hello&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;World&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;Java&quot;&lt;/span&gt;);

&lt;span class=&quot;hljs-comment&quot;&gt;// 用逗号连接，并添加方括号&lt;/span&gt;
&lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; words.stream()
    .collect(Collectors.collectingAndThen(
        Collectors.joining(&lt;span class=&quot;hljs-string&quot;&gt;&quot;, &quot;&lt;/span&gt;),  &lt;span class=&quot;hljs-comment&quot;&gt;// 先连接&lt;/span&gt;
        s -&amp;gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;[&quot;&lt;/span&gt; + s + &lt;span class=&quot;hljs-string&quot;&gt;&quot;]&quot;&lt;/span&gt;         &lt;span class=&quot;hljs-comment&quot;&gt;// 再加括号&lt;/span&gt;
    ));

System.out.println(result); &lt;span class=&quot;hljs-comment&quot;&gt;// 输出: [Hello, World, Java]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-7&quot;&gt;示例6：收集为Set并排序&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;List&amp;lt;Integer&amp;gt; numbers = Arrays.asList(&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;);

&lt;span class=&quot;hljs-comment&quot;&gt;// 去重后排序&lt;/span&gt;
List&amp;lt;Integer&amp;gt; sortedUnique = numbers.stream()
    .collect(Collectors.collectingAndThen(
        Collectors.toCollection(TreeSet::&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt;),  &lt;span class=&quot;hljs-comment&quot;&gt;// 自动去重和排序&lt;/span&gt;
        ArrayList::&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt;  &lt;span class=&quot;hljs-comment&quot;&gt;// 转换为List&lt;/span&gt;
    ));

System.out.println(sortedUnique); &lt;span class=&quot;hljs-comment&quot;&gt;// 输出: [1, 2, 3, 5]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-8&quot;&gt;示例7：多重转换&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;List&amp;lt;Employee&amp;gt; employees = Arrays.asList(
    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Employee&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Alice&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5000&lt;/span&gt;),
    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Employee&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Bob&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;6000&lt;/span&gt;),
    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Employee&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Charlie&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5000&lt;/span&gt;)
);

&lt;span class=&quot;hljs-comment&quot;&gt;// 按薪资分组 -&amp;gt; 获取名字列表 -&amp;gt; 排序&lt;/span&gt;
Map&amp;lt;Integer, List&amp;lt;String&amp;gt;&amp;gt; salaryToNames = employees.stream()
    .collect(Collectors.collectingAndThen(
        Collectors.groupingBy(
            Employee::getSalary,
            Collectors.mapping(Employee::getName, Collectors.toList())
        ),
        map -&amp;gt; {
            &lt;span class=&quot;hljs-comment&quot;&gt;// 对每个分组的名字列表排序&lt;/span&gt;
            map.replaceAll((k, v) -&amp;gt; {
                Collections.sort(v);
                &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; v;
            });
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; map;
        }
    ));
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-9&quot;&gt;示例8：数据库查询结果处理&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// 查询用户列表，按部门分组，统计每个部门的平均工资&lt;/span&gt;
List&amp;lt;User&amp;gt; users = userRepository.findAll();

Map&amp;lt;String, Double&amp;gt; deptAvgSalary = users.stream()
    .collect(Collectors.collectingAndThen(
        Collectors.groupingBy(
            User::getDepartment,
            Collectors.averagingDouble(User::getSalary)
        ),
        map -&amp;gt; {
            &lt;span class=&quot;hljs-comment&quot;&gt;// 保留两位小数&lt;/span&gt;
            Map&amp;lt;String, Double&amp;gt; result = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;LinkedHashMap&lt;/span&gt;&amp;lt;&amp;gt;();
            map.forEach((dept, avg) -&amp;gt; 
                result.put(dept, Math.round(avg * &lt;span class=&quot;hljs-number&quot;&gt;100.0&lt;/span&gt;) / &lt;span class=&quot;hljs-number&quot;&gt;100.0&lt;/span&gt;));
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result;
        }
    ));
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-10&quot;&gt;示例9：订单统计&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;List&amp;lt;Order&amp;gt; orders = orderService.getRecentOrders();

&lt;span class=&quot;hljs-comment&quot;&gt;// 统计每个用户的订单总金额，按金额降序排序&lt;/span&gt;
List&amp;lt;UserTotal&amp;gt; userTotals = orders.stream()
    .collect(Collectors.collectingAndThen(
        Collectors.groupingBy(
            Order::getUserId,
            Collectors.summingDouble(Order::getAmount)
        ),
        map -&amp;gt; map.entrySet().stream()
            .map(e -&amp;gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;UserTotal&lt;/span&gt;(e.getKey(), e.getValue()))
            .sorted(Comparator.comparing(UserTotal::getTotal).reversed())
            .collect(Collectors.toList())
    ));
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 data-id=&quot;heading-11&quot;&gt;三、使用建议&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;&quot;用 collectingAndThen 只做一件事，复杂的就分步，简单的直接做，保持代码干净。&quot;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;三个核心原则：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;只做简单转换&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;一次只做一件事&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;数据量大才考虑使用&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 data-id=&quot;heading-12&quot;&gt;1.  简单原则&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;能用简单方式就不用复杂收集器&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// ❌ 过度使用&lt;/span&gt;
List&amp;lt;String&amp;gt; result = list.stream()
    .collect(collectingAndThen(
        toList(),
        Collections::unmodifiableList
    ));

&lt;span class=&quot;hljs-comment&quot;&gt;// ✅ 简单方式（Java 10+）&lt;/span&gt;
List&amp;lt;String&amp;gt; result = List.copyOf(list);
&lt;span class=&quot;hljs-comment&quot;&gt;// 或&lt;/span&gt;
List&amp;lt;String&amp;gt; result = Collections.unmodifiableList(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ArrayList&lt;/span&gt;&amp;lt;&amp;gt;(list));
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-13&quot;&gt;2. 保持函数纯净&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;不要在转换函数中有副作用&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// ❌ 有副作用&lt;/span&gt;
Map&amp;lt;String, List&amp;lt;Person&amp;gt;&amp;gt; result = persons.stream()
    .collect(collectingAndThen(
        groupingBy(Person::getCity),
        map -&amp;gt; {
            map.forEach((k, v) -&amp;gt; System.out.println(k)); &lt;span class=&quot;hljs-comment&quot;&gt;// 副作用&lt;/span&gt;
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; map;
        }
    ));

&lt;span class=&quot;hljs-comment&quot;&gt;// ✅ 纯函数&lt;/span&gt;
Map&amp;lt;String, List&amp;lt;Person&amp;gt;&amp;gt; result = persons.stream()
    .collect(groupingBy(Person::getCity));
&lt;span class=&quot;hljs-comment&quot;&gt;// 副作用放到后面&lt;/span&gt;
result.forEach((k, v) -&amp;gt; System.out.println(k));
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-14&quot;&gt;3. 性能意识&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;小数据不要用，大数据才考虑&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;List&amp;lt;String&amp;gt; smallList = Arrays.asList(&lt;span class=&quot;hljs-string&quot;&gt;&quot;a&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;b&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;c&quot;&lt;/span&gt;); &lt;span class=&quot;hljs-comment&quot;&gt;// 只有3个元素&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;// ❌ 没必要用 collectingAndThen&lt;/span&gt;
List&amp;lt;String&amp;gt; result1 = smallList.stream()
    .collect(collectingAndThen(toList(), Collections::unmodifiableList));

&lt;span class=&quot;hljs-comment&quot;&gt;// ✅ 直接创建不可变集合&lt;/span&gt;
List&amp;lt;String&amp;gt; result2 = List.copyOf(smallList); &lt;span class=&quot;hljs-comment&quot;&gt;// Java 10+&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// 或&lt;/span&gt;
List&amp;lt;String&amp;gt; result3 = Collections.unmodifiableList(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ArrayList&lt;/span&gt;&amp;lt;&amp;gt;(smallList));

&lt;span class=&quot;hljs-comment&quot;&gt;// ✅ 大数据集用 collectingAndThen&lt;/span&gt;
List&amp;lt;String&amp;gt; largeList = getLargeList(); &lt;span class=&quot;hljs-comment&quot;&gt;// 假设有上万条&lt;/span&gt;
List&amp;lt;String&amp;gt; result = largeList.stream()
    .collect(collectingAndThen(toList(), Collections::unmodifiableList));
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-15&quot;&gt;4. 常用场景才用&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;不要为了用而用&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// ✅ 真正有用的场景：&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;// 1. 收集后立即转换&lt;/span&gt;
List&amp;lt;String&amp;gt; result = list.stream()
    .collect(collectingAndThen(
        toList(),
        Collections::unmodifiableList  &lt;span class=&quot;hljs-comment&quot;&gt;// 立即转为不可变&lt;/span&gt;
    ));

&lt;span class=&quot;hljs-comment&quot;&gt;// 2. 处理 Optional 结果&lt;/span&gt;
&lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;max&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; list.stream()
    .collect(collectingAndThen(
        maxBy(String::compareTo),
        opt -&amp;gt; opt.orElse(&lt;span class=&quot;hljs-string&quot;&gt;&quot;default&quot;&lt;/span&gt;)  &lt;span class=&quot;hljs-comment&quot;&gt;// 解包Optional&lt;/span&gt;
    ));

&lt;span class=&quot;hljs-comment&quot;&gt;// 3. 连接字符串后包装&lt;/span&gt;
&lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;joined&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; list.stream()
    .collect(collectingAndThen(
        joining(&lt;span class=&quot;hljs-string&quot;&gt;&quot;, &quot;&lt;/span&gt;),
        s -&amp;gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;[&quot;&lt;/span&gt; + s + &lt;span class=&quot;hljs-string&quot;&gt;&quot;]&quot;&lt;/span&gt;  &lt;span class=&quot;hljs-comment&quot;&gt;// 添加括号&lt;/span&gt;
    ));

&lt;span class=&quot;hljs-comment&quot;&gt;// ❌ 没必要用的场景：&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// - 只是简单的收集&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// - 后续还有更多处理步骤&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// - 转换逻辑很复杂&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-16&quot;&gt;5. 复杂逻辑就分步&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;不要都塞进 collectingAndThen&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// ❌ 过于复杂&lt;/span&gt;
List&amp;lt;String&amp;gt; result = list.stream()
    .collect(collectingAndThen(
        toList(),
        list -&amp;gt; {
            &lt;span class=&quot;hljs-comment&quot;&gt;// 一大堆复杂逻辑&lt;/span&gt;
            list.sort(Comparator.reverseOrder());
            list.replaceAll(String::toUpperCase);
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; Collections.unmodifiableList(list);
        }
    ));

&lt;span class=&quot;hljs-comment&quot;&gt;// ✅ 分步处理更清晰&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// 步骤1：收集和排序&lt;/span&gt;
List&amp;lt;String&amp;gt; temp = list.stream()
    .sorted(Comparator.reverseOrder())
    .collect(toList());

&lt;span class=&quot;hljs-comment&quot;&gt;// 步骤2：转换&lt;/span&gt;
temp.replaceAll(String::toUpperCase);

&lt;span class=&quot;hljs-comment&quot;&gt;// 步骤3：转为不可变&lt;/span&gt;
List&amp;lt;String&amp;gt; result = Collections.unmodifiableList(temp);
&lt;/code&gt;&lt;/pre&gt;</description><link>https://juejin.cn/post/7594859060856979466</link><guid isPermaLink="false">https://juejin.cn/post/7594859060856979466</guid><pubDate>Wed, 14 Jan 2026 03:16:52 GMT</pubDate><author>白衣鸽子</author><category>后端</category></item><item><title>Maven详细配置（完整笔记）</title><description>&lt;h3 data-id=&quot;heading-0&quot;&gt;Maven&lt;/h3&gt;
&lt;p&gt;本质：项目管理工具。可以做到整体编译、测试，快速打包部署。&lt;/p&gt;
&lt;p&gt;作用：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;项目构建，提供标准的构建方式&lt;/li&gt;
&lt;li&gt;依赖管理，避免版本冲突&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;生命周期：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-ini&quot; lang=&quot;ini&quot;&gt;mvn clean   &lt;span class=&quot;hljs-comment&quot;&gt;# 清理编译项目&lt;/span&gt;
mvn compile &lt;span class=&quot;hljs-comment&quot;&gt;# 编译项目&lt;/span&gt;
mvn test    &lt;span class=&quot;hljs-comment&quot;&gt;# 测试项目&lt;/span&gt;
mvn package &lt;span class=&quot;hljs-comment&quot;&gt;# 项目打包&lt;/span&gt;
mvn install &lt;span class=&quot;hljs-comment&quot;&gt;# 安装到仓库中，会把当前包存放到本地Maven仓库中&lt;/span&gt;
mvn clean package &lt;span class=&quot;hljs-attr&quot;&gt;-Dmaven.test.skip&lt;/span&gt;=&lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;# 跳过测试打包&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;maven地址：&lt;a href=&quot;https://link.juejin.cn/?target=https%3A%2F%2Fmaven.apache.org%2F&quot; target=&quot;_blank&quot; title=&quot;https://maven.apache.org/&quot; ref=&quot;nofollow noopener noreferrer&quot;&gt;maven.apache.org/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;下载地址：&lt;a href=&quot;https://link.juejin.cn/?target=https%3A%2F%2Fmaven.apache.org%2Fdownload.cgi&quot; target=&quot;_blank&quot; title=&quot;https://maven.apache.org/download.cgi&quot; ref=&quot;nofollow noopener noreferrer&quot;&gt;maven.apache.org/download.cg…&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;仓库地址：&lt;a href=&quot;https://link.juejin.cn/?target=https%3A%2F%2Fmvnrepository.com%2F&quot; target=&quot;_blank&quot; title=&quot;https://mvnrepository.com/&quot; ref=&quot;nofollow noopener noreferrer&quot;&gt;mvnrepository.com/&lt;/a&gt;&lt;/p&gt;
&lt;h4 data-id=&quot;heading-1&quot;&gt;创建maven工程&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;1. 配置环境变量&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;配置MAVEN_HOME&lt;/p&gt;
&lt;p&gt;变量名 - MAVEN_HOME&lt;/p&gt;
&lt;p&gt;变量值 - maven的安装目录&lt;/p&gt;
&lt;p&gt;（一般xxx_home指的是bin目录上一级，PATH指的是bin目录）&lt;/p&gt;
&lt;p&gt;配置PATH&lt;/p&gt;
&lt;p&gt;添加%MAVEN_HOME%\bin&lt;/p&gt;
&lt;p&gt;配置完，进行验证，打开命令行窗口执行&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs&quot;&gt;mvn -v
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;2. 修改配置文件&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;maven下载完，配置文件settings.xml&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-XML&quot; lang=&quot;XML&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;settings&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;xmlns&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://maven.apache.org/SETTINGS/1.0.0&quot;&lt;/span&gt;
          &lt;span class=&quot;hljs-attr&quot;&gt;xmlns:xsi&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;/span&gt;
          &lt;span class=&quot;hljs-attr&quot;&gt;xsi:schemaLocation&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- localRepository
   | The path to the local repository maven will use to store artifacts.
   | Default: ${user.home}/.m2/repository  localRepository 指定包下载的位置
  --&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 本地仓库位置 --&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;localRepository&lt;/span&gt;&amp;gt;&lt;/span&gt;D:\java\m2&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;localRepository&lt;/span&gt;&amp;gt;&lt;/span&gt;
  ...
  &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 远程仓库位置 --&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;mirror&lt;/span&gt;&amp;gt;&lt;/span&gt;  
      &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;alimaven&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;  
      &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;mirrorOf&lt;/span&gt;&amp;gt;&lt;/span&gt;central&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;mirrorOf&lt;/span&gt;&amp;gt;&lt;/span&gt;  
      &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;name&lt;/span&gt;&amp;gt;&lt;/span&gt;aliyun maven&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;name&lt;/span&gt;&amp;gt;&lt;/span&gt;  
      &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;url&lt;/span&gt;&amp;gt;&lt;/span&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;url&lt;/span&gt;&amp;gt;&lt;/span&gt;  
   &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;mirror&lt;/span&gt;&amp;gt;&lt;/span&gt;
   ...
   &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 配置基础的JDK版本 --&amp;gt;&lt;/span&gt;    
   &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;profile&lt;/span&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;jdk-1.8&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 激活的方式 --&amp;gt;&lt;/span&gt;    
      &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;activation&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 默认激活 --&amp;gt;&lt;/span&gt;    
      &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;activeByDefault&lt;/span&gt;&amp;gt;&lt;/span&gt;true&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;activeByDefault&lt;/span&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;jdk&lt;/span&gt;&amp;gt;&lt;/span&gt;1.8&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;jdk&lt;/span&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;activation&lt;/span&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;properties&lt;/span&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;maven.compiler.source&lt;/span&gt;&amp;gt;&lt;/span&gt;1.8&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;maven.compiler.source&lt;/span&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;maven.compiler.target&lt;/span&gt;&amp;gt;&lt;/span&gt;1.8&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;maven.compiler.target&lt;/span&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;maven.compiler.compilerVersion&lt;/span&gt;&amp;gt;&lt;/span&gt;1.8&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;maven.compiler.compilerVersion&lt;/span&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;properties&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;profile&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;3. 创建项目&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;可以使用idea开发工具构建，创建maven工程/web工程&lt;/p&gt;
&lt;img src=&quot;https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67ce436138af4342bb080b055d377959~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LyY56eA55qE6aKc:q75.awebp?rk3s=f64ab15b&amp;amp;x-expires=1768965222&amp;amp;x-signature=BqS7M4Tm5pXVE3xNmvOoSUJdJrU%3D&quot; alt=&quot;image-20220606214712423&quot; loading=&quot;lazy&quot; referrerpolicy=&quot;no-referrer&quot;&gt;
&lt;p&gt;创建完，需要配置坐标pom.xml文件&lt;/p&gt;
&lt;h4 data-id=&quot;heading-2&quot;&gt;核心概念&lt;/h4&gt;
&lt;p&gt;解读pop.xml&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-xml&quot; lang=&quot;xml&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- groupId 公司或组织id   --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;com.alibaba.abc&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- artifactId 项目名   --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;abc&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- version 版本号 例子：SNAPSHOT 快照版本 RELEASE 正式版本   --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.1.0&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 打包方式：war（生产web工厂）/jar （Java工厂）/pom （该工程
是用来管理其他工程） --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;packaging&lt;/span&gt;&amp;gt;&lt;/span&gt;jar&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;packaging&lt;/span&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- Maven自定义属性  --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;properties&lt;/span&gt;&amp;gt;&lt;/span&gt;
    # 构建源码中读取源码的字符集
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;project.build.sourceEncoding&lt;/span&gt;&amp;gt;&lt;/span&gt;UTF-8&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;project.build.sourceEncoding&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;project.reporting.outputEncoding&lt;/span&gt;&amp;gt;&lt;/span&gt;UTF-8&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;project.reporting.outputEncoding&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;maven.compiler.source&lt;/span&gt;&amp;gt;&lt;/span&gt;8&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;maven.compiler.source&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;maven.compiler.target&lt;/span&gt;&amp;gt;&lt;/span&gt;8&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;maven.compiler.target&lt;/span&gt;&amp;gt;&lt;/span&gt;
    # project.build.sourceEncoding：当前项目编译成字节码文件的编码格式。一般是UTF-8，可根据需求更改。
    # maven.compiler.source：当前环境所使用的JDK。
    # maven.compiler.target：运行时使用JDK。

&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;properties&lt;/span&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 配置依赖的具体信息  --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-starter-test&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 依赖范围
              compile：主程序 有效 、测试程序 有效、参与打包
              test：主程序 无效 、测试程序 有效、不参与打包
              provided：主程序 有效 、测试程序 有效、不参与打包
              （比如：servlet-api.jar的包，远程服务tomcat默认是有这些包，本地打包就不再需要，避免冲突）
            --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;compile&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;test&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;provided&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 一般只有&amp;lt;type&amp;gt;pom&amp;lt;/type&amp;gt; 才有这个，
这个只是1个子工程只有1个父工程，如果想引用其他父工程的包，可以使用import导入
 --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;import&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 除去一些包，解决包冲突 --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;exclusions&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;exclusion&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-starter-logging&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;exclusion&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;exclusions&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 对构建过程进行自己的定制 --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 打包后的名字 xxx.jar --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;finalName&lt;/span&gt;&amp;gt;&lt;/span&gt;打包后的名字&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;finalName&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 构建过程所用到的插件 --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 一般逆向工程，的依赖插件 --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-maven-plugin&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 如父工程引用过，子工程不需要制定版本号 --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.1.0&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 一般逆向工程，所需要的依赖包 --&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-xxx&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.1.0&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- configuration 配置该插件 --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;excludes&lt;/span&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 打包的时候，减少一些包，（配置处理器）生产环境没必要打包  （去掉自定义配置） --&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;exclude&lt;/span&gt;&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-configuration-processor&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;exclude&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;excludes&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 制定JDK版本，也可以在maven的settings.xml配置 --&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;source&lt;/span&gt;&amp;gt;&lt;/span&gt;1.8&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;source&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;target&lt;/span&gt;&amp;gt;&lt;/span&gt;1.8&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;target&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;encoding&lt;/span&gt;&amp;gt;&lt;/span&gt;UTF-8&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;encoding&lt;/span&gt;&amp;gt;&lt;/span&gt;
             &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;plugins&lt;/span&gt;&amp;gt;&lt;/span&gt;
    
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;resources&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 打包过程中，哪些不要 --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;resource&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 表示当前目录开启的资源 --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;directory&lt;/span&gt;&amp;gt;&lt;/span&gt;src/main/resources&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;directory&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 资源过滤器打开 --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;filtering&lt;/span&gt;&amp;gt;&lt;/span&gt;true&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;filtering&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 全部的以properties为后缀的文件，进行过滤 --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;includes&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;include&lt;/span&gt;&amp;gt;&lt;/span&gt;*.properties&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;include&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;includes&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 除掉zdy.properties文件，都进行过滤 --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;excludes&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;exclude&lt;/span&gt;&amp;gt;&lt;/span&gt;zdy.properties&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;exclude&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;excludes&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;resource&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;resources&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-3&quot;&gt;基本操作&lt;/h4&gt;
&lt;p&gt;maven手动配置jar包到本地仓库&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-xml&quot; lang=&quot;xml&quot;&gt;mvn install:install-file -Dfile=&quot;本地的jar包文件 例 /root/xxx.jar&quot; -DgroupId=&quot;一般是groupId的名字 例 com.alibaba.abc&quot; -DartifactId=&quot;名字 例 abc&quot; -Dversion=1.1.0 -Dpackaging=jar
# 对应
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;com.alibaba.abc&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;abc&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.1.0&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;    
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-4&quot;&gt;坐标&amp;amp;pom.xml&lt;/h4&gt;
&lt;p&gt;常用pom文件&lt;/p&gt;
&lt;p&gt;父容器配置：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-xml&quot; lang=&quot;xml&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;&amp;lt;?xml version=&lt;span class=&quot;hljs-string&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;hljs-string&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;project&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;xmlns&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://maven.apache.org/POM/4.0.0&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;xmlns:xsi&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;/span&gt;
         &lt;span class=&quot;hljs-attr&quot;&gt;xsi:schemaLocation&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;modelVersion&lt;/span&gt;&amp;gt;&lt;/span&gt;4.0.0&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;modelVersion&lt;/span&gt;&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;cn.yan&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;mjob&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;0.0.1-SNAPSHOT&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;
    
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;name&lt;/span&gt;&amp;gt;&lt;/span&gt;mjob&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;name&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;description&lt;/span&gt;&amp;gt;&lt;/span&gt;聚合服务&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;description&lt;/span&gt;&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 打包类型：war/jar/pom（代表当前项目是父工程，做聚合管理）  --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;packaging&lt;/span&gt;&amp;gt;&lt;/span&gt;pom&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;packaging&lt;/span&gt;&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!--版本号管理 --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;properties&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;alibaba.version&lt;/span&gt;&amp;gt;&lt;/span&gt;2.2.6.RELEASE&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;alibaba.version&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;properties&lt;/span&gt;&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 引入子模块 --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;modules&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;module&lt;/span&gt;&amp;gt;&lt;/span&gt;yan-commo&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;module&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;module&lt;/span&gt;&amp;gt;&lt;/span&gt;yan-coupon&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;module&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;modules&lt;/span&gt;&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 依赖管理 这样子包继承父类，按需下载包，不需要不进行下载，减少包的体积--&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependencyManagement&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;com.alibaba.cloud&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-cloud-alibaba-dependencies&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;${alibaba.version}&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependencyManagement&lt;/span&gt;&amp;gt;&lt;/span&gt;
    
    》
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;project&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;子模块配置：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-xml&quot; lang=&quot;xml&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;&amp;lt;?xml version=&lt;span class=&quot;hljs-string&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;hljs-string&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;project&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;xmlns&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://maven.apache.org/POM/4.0.0&quot;&lt;/span&gt;
         &lt;span class=&quot;hljs-attr&quot;&gt;xmlns:xsi&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;/span&gt;
         &lt;span class=&quot;hljs-attr&quot;&gt;xsi:schemaLocation&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;modelVersion&lt;/span&gt;&amp;gt;&lt;/span&gt;4.0.0&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;modelVersion&lt;/span&gt;&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 通过父工程坐标找到父工程项目  --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;parent&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;mjob&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;cn.yan&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;0.0.1-SNAPSHOT&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;parent&lt;/span&gt;&amp;gt;&lt;/span&gt;
    
    &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 如果groupId、version与父工程一样，可以省略 --&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;cn.yan&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;0.0.1-SNAPSHOT&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;
    
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;yan-commo&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;name&lt;/span&gt;&amp;gt;&lt;/span&gt;yan-commo&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;name&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;description&lt;/span&gt;&amp;gt;&lt;/span&gt;公共组件 - 每个微服务公共依赖&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;description&lt;/span&gt;&amp;gt;&lt;/span&gt;
    
    &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 打包类型：war/jar/pom（代表当前项目是父工程，做聚合管理）  --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;packaging&lt;/span&gt;&amp;gt;&lt;/span&gt;jar&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;packaging&lt;/span&gt;&amp;gt;&lt;/span&gt;
    
    &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 依赖包 --&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 父工程已有该包，子工程可省略version属性 --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;com.yan.bpm&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;bpm-common&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.0-SNAPSHOT&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 依赖范围
              compile：主程序 有效 、测试程序 有效、参与打包
              test：主程序 无效 、测试程序 有效、不参与打包
              provided：主程序 有效 、测试程序 有效、不参与打包
              （比如：servlet-api.jar的包，远程服务tomcat默认是有这些包，本地打包就不再需要，避免冲突）
            --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;compile&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;test&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;provided&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-starter-web&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 除去一些包 --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;exclusions&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;exclusion&lt;/span&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-starter-logging&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;exclusion&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;exclusions&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;
        
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 打包后的名字 xxx.jar --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;finalName&lt;/span&gt;&amp;gt;&lt;/span&gt;打包后的名字&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;finalName&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;build&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;project&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-5&quot;&gt;导入module&lt;/h4&gt;
&lt;p&gt;当我们导入进来的项目，idea开发工具没有识别Maven项目，一些代码提示没有，解决:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-arduino&quot; lang=&quot;arduino&quot;&gt;步骤&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;：快捷键 Ctrl + Alt + Shift + S  打开&lt;span class=&quot;hljs-keyword&quot;&gt;module&lt;/span&gt;模块
步骤&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;：点击 + 按钮，找到&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;module&lt;/span&gt;，进行重新导入
步骤&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;：点击apply，进行重新导入
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-6&quot;&gt;打包部署&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;web项目&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;项目打包命令&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-xml&quot; lang=&quot;xml&quot;&gt;mvn clean package -Dmaven.test.skip=true # 跳过测试打包
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;上传包到服务器&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;在tomcat服务下启动程序&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-xml&quot; lang=&quot;xml&quot;&gt;/xx/tomcat/bin/startup.sh
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;然后可以访问地址，进行测试&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;jar项目&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;项目打包命令&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;上传包到服务器&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;在某个文件下运行jar&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-xml&quot; lang=&quot;xml&quot;&gt;nohup java -jar xxx.jar &amp;gt; xx.log 2&amp;gt;&amp;amp;1 &amp;amp;
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;然后可以访问地址，进行测试&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 data-id=&quot;heading-7&quot;&gt;一些包文件&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-xml&quot; lang=&quot;xml&quot;&gt;# 当我们想用@Table(name=&quot;表名称&quot;)
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;javax.persistence&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;javax.persistence-api&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;2.2&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;
# 热部署
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-devtools&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;3.1.3&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;runtime&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;optional&lt;/span&gt;&amp;gt;&lt;/span&gt;true&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;optional&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-8&quot;&gt;解决包冲突&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;IDEA中的Maven helper插件&lt;/p&gt;
&lt;p&gt;安装完插件，在pom.xml文件中，找到Dependency Analyzer，找到Conflicts，这里显示包冲突；&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Maven 的enforcer插件&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-xml&quot; lang=&quot;xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.apache.maven.plugins&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;maven-enforcer-plugin&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.4.1&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;executions&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;execution&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;enforce-dependencies&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;phase&lt;/span&gt;&amp;gt;&lt;/span&gt;validate&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;phase&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;goals&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;goal&lt;/span&gt;&amp;gt;&lt;/span&gt;display-info&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;goal&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;goal&lt;/span&gt;&amp;gt;&lt;/span&gt;enforce&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;goal&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;goals&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;execution&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;executions&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.codehaus.mojo&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;extra-enforcer-rules&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.0-beta-4&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependencies&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;rules&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;banDuplicateClasses&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;findAllDuplicates&lt;/span&gt;&amp;gt;&lt;/span&gt;true&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;findAllDuplicates&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;banDuplicateClasses&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;rules&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;plugin&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;配置完，需要执行，然后可以看到包冲突&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-shell&quot; lang=&quot;shell&quot;&gt;mvn clean package enforcer:enforce
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 data-id=&quot;heading-9&quot;&gt;搭建私服仓库&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;下载 nexus&lt;/p&gt;
&lt;p&gt;下载地址：&lt;a href=&quot;https://link.juejin.cn/?target=https%3A%2F%2Fhelp.sonatype.com%2Frepomanager3%2Fproduct-information%2Fdownload&quot; target=&quot;_blank&quot; title=&quot;https://help.sonatype.com/repomanager3/product-information/download&quot; ref=&quot;nofollow noopener noreferrer&quot;&gt;help.sonatype.com/repomanager…&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;配置环境变量&lt;/p&gt;
&lt;p&gt;NEXUS_HOME配置：指向安装目录的地址&lt;/p&gt;
&lt;img src=&quot;https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/58decb1d47e643aa96106c250628c669~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LyY56eA55qE6aKc:q75.awebp?rk3s=f64ab15b&amp;amp;x-expires=1768965222&amp;amp;x-signature=cOMNQYsOEyFkhTxmY%2BugC3ZLOOw%3D&quot; alt=&quot;image-20220626161206114&quot; loading=&quot;lazy&quot; referrerpolicy=&quot;no-referrer&quot;&gt;
&lt;p&gt;然后在Path环境变量下，添加&lt;code&gt;%NEXUS_HOME%\bin&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;常用命令&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-xml&quot; lang=&quot;xml&quot;&gt;# 默认端口 8081
# 在 D:\xxx\nexus-3.20.1-01\etc 目录下 nexus-default.properties文件
# 修改配置文件 - application-port=8081 更改默认端口

# cmd 命令下进行启动
（前台运行）启动命令：nexus /run
（后台运行）安装：nexus.exe /install
  卸载：nexus.exe /uninstall
  启动：nexus.exe /start
  停止：nexus.exe /stop
  查看：nexus.exe /status

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;启动成功，访问页面：&lt;a href=&quot;https://link.juejin.cn/?target=http%3A%2F%2Flocalhost%3A8081%25EF%25BC%258C%25E5%2587%25BA%25E7%258E%25B0%25E9%25A1%25B5%25E9%259D%25A2%25E4%25BB%25A3%25E8%25A1%25A8%25E5%25AE%2589%25E8%25A3%2585%25E6%2588%2590%25E5%258A%259F&quot; target=&quot;_blank&quot; title=&quot;http://localhost:8081%EF%BC%8C%E5%87%BA%E7%8E%B0%E9%A1%B5%E9%9D%A2%E4%BB%A3%E8%A1%A8%E5%AE%89%E8%A3%85%E6%88%90%E5%8A%9F&quot; ref=&quot;nofollow noopener noreferrer&quot;&gt;http://localhost:8081，出现页面代表安装成功&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;配置登录密码&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-xml&quot; lang=&quot;xml&quot;&gt;在D:\xxx\sonatype-work\nexus3目录下，存放第一次的默认密码
记住密码，如果修改密码后，该文件会被删除
然后，我们在登陆页面，输入用户名（admin）和密码，登录成功会引导创建新的密码
然后，Configure Anonymous Access 下选择Enable anonymous access （允许匿名下载包）
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&quot;https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a87cc2b9a6234f3dab480bdb38ba8ae0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LyY56eA55qE6aKc:q75.awebp?rk3s=f64ab15b&amp;amp;x-expires=1768965222&amp;amp;x-signature=DuHxenclirIROHYW8JUgPORJYGk%3D&quot; alt=&quot;image-20220626164755807&quot; loading=&quot;lazy&quot; referrerpolicy=&quot;no-referrer&quot;&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;配置管理&lt;/p&gt;
&lt;p&gt;小齿轮图标：进行配置，允许匿名授权，如果不允许，需要创建对应的用户账户，分配权限管理。 &lt;img src=&quot;https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/05e81f7426df468198d251fc04b994ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LyY56eA55qE6aKc:q75.awebp?rk3s=f64ab15b&amp;amp;x-expires=1768965222&amp;amp;x-signature=JZAYiSlPZGXJ4RadYdWkPVDbBl4%3D&quot; alt=&quot;image-20220626173850818&quot; loading=&quot;lazy&quot; referrerpolicy=&quot;no-referrer&quot;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;nexus与阿里云仓库地址进行配置&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-xml&quot; lang=&quot;xml&quot;&gt;# 我们搭建架构：本地仓库 - 远程私服仓库 - 阿里云远程仓库 - 国外远程仓库
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&quot;https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca8a11b5028948b38fbe755473823237~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LyY56eA55qE6aKc:q75.awebp?rk3s=f64ab15b&amp;amp;x-expires=1768965222&amp;amp;x-signature=UTznLPLn91YGUy0FIpxieNshXsc%3D&quot; alt=&quot;image-20220626174709460&quot; loading=&quot;lazy&quot; referrerpolicy=&quot;no-referrer&quot;&gt;
&lt;p&gt;Create repository : 进行创建自定义的仓库地址&lt;/p&gt;
&lt;p&gt;其中：&lt;/p&gt;
&lt;p&gt;maven-central：中央仓库地址&lt;/p&gt;
&lt;p&gt;maven-public：做聚合的&lt;/p&gt;
&lt;p&gt;maven-releases：是释放版本&lt;/p&gt;
&lt;p&gt;maven-snapshots：是开发版本&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-xml&quot; lang=&quot;xml&quot;&gt;区别：
如果version是SNAPSHOT，执行maven的deploy，会打包进入到maven-snapshots下
如果version是RELEASES，执行maven的deploy，会打包进入到maven-releases下
&lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 依赖坐标 --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;cn.yan&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;mjob&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.0-SNAPSHOT&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;1.0-RELEASES&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;
maven-public：
是做聚合的，http://localhost:8081/repository/maven-public，访问这个，就代表会访问maven-central、maven-releases、maven-snapshots地址，不需要再切换其他的地址。
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;图2. 进行配置地址：&lt;/p&gt;
&lt;p&gt;默认地址: &lt;a href=&quot;https://link.juejin.cn/?target=https%3A%2F%2Frepo1.maven.org%2Fmaven2&quot; target=&quot;_blank&quot; title=&quot;https://repo1.maven.org/maven2&quot; ref=&quot;nofollow noopener noreferrer&quot;&gt;repo1.maven.org/maven2&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;更改地址: &lt;a href=&quot;https://link.juejin.cn/?target=http%3A%2F%2Fmaven.aliyun.com%2Fnexus%2Fcontent%2Fgroups%2Fpublic%2F&quot; target=&quot;_blank&quot; title=&quot;http://maven.aliyun.com/nexus/content/groups/public/&quot; ref=&quot;nofollow noopener noreferrer&quot;&gt;maven.aliyun.com/nexus/conte…&lt;/a&gt;&lt;/p&gt;
&lt;img src=&quot;https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02bfe07a7043405798e1a32324072fb2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LyY56eA55qE6aKc:q75.awebp?rk3s=f64ab15b&amp;amp;x-expires=1768965222&amp;amp;x-signature=qZ7l1Y67rulqBUJ6B%2Feoh9pfGew%3D&quot; alt=&quot;image-20220626175251475&quot; loading=&quot;lazy&quot; referrerpolicy=&quot;no-referrer&quot;&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;本地配置maven&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-xml&quot; lang=&quot;xml&quot;&gt;# 本地的maven的配置xml ，该位置需要配置maven-public，可以在该页面直接点击maven-public的copy得到url
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;mirror&lt;/span&gt;&amp;gt;&lt;/span&gt;  
     &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;nexus&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;  
     &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;mirrorOf&lt;/span&gt;&amp;gt;&lt;/span&gt;*&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;mirrorOf&lt;/span&gt;&amp;gt;&lt;/span&gt;  
     &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;url&lt;/span&gt;&amp;gt;&lt;/span&gt;http://localhost:8081/repository/maven-public/&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;url&lt;/span&gt;&amp;gt;&lt;/span&gt;  
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;mirror&lt;/span&gt;&amp;gt;&lt;/span&gt;

# 插件仓库配置，修改pom.xml
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;profile&lt;/span&gt;&amp;gt;&lt;/span&gt;  
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;pluginRepositories&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 插件仓库，maven的运行依赖插件，也需要从私服下载插件 --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;pluginRepository&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 唯一id --&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;nexus&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;           
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;url&lt;/span&gt;&amp;gt;&lt;/span&gt;http://localhost:8081/repository/maven-public/&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;url&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;releases&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;enabled&lt;/span&gt;&amp;gt;&lt;/span&gt;true&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;enabled&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;releases&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;snapshots&lt;/span&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;enabled&lt;/span&gt;&amp;gt;&lt;/span&gt;true&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;enabled&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;snapshots&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;pluginRepository&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;pluginRepositories&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;profile&lt;/span&gt;&amp;gt;&lt;/span&gt;  
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;下载&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-xml&quot; lang=&quot;xml&quot;&gt;# 前提条件 nexus 目录需要有4G以上内存
# 然后 我们本地引入包
 &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;redis.clients&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;jedis&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;4.2.3&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;
# 然后在私有仓库上进行查看，所下载的包
&lt;/code&gt;&lt;/pre&gt;
&lt;img src=&quot;https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/887ae53ca4c240dd924e65139a246b9b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LyY56eA55qE6aKc:q75.awebp?rk3s=f64ab15b&amp;amp;x-expires=1768965222&amp;amp;x-signature=D%2B0JcHyKQ%2FXBuPd6eDpRvwzH0qA%3D&quot; alt=&quot;image-20220626195134988&quot; loading=&quot;lazy&quot; referrerpolicy=&quot;no-referrer&quot;&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;上传&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-xml&quot; lang=&quot;xml&quot;&gt;# 本地的maven的配置xml ，如果不是匿名访问，也需要配置这个
&lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 上传私服 --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;servers&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;server&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;nexus&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt; # 与本地私服的名字保持一致
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;privateKey&lt;/span&gt;&amp;gt;&lt;/span&gt;admin&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;privateKey&lt;/span&gt;&amp;gt;&lt;/span&gt; # 用户名
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;passphrase&lt;/span&gt;&amp;gt;&lt;/span&gt;密码&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;passphrase&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;server&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;servers&lt;/span&gt;&amp;gt;&lt;/span&gt;

# 传仓库地址，上传2个仓库地址，Releases、Snapshots 修改pom.xml
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;distributionManagement&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;repository&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;nexus&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;name&lt;/span&gt;&amp;gt;&lt;/span&gt;Releases&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;name&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;url&lt;/span&gt;&amp;gt;&lt;/span&gt;http://localhost:8081/repository/maven-releases/&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;url&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;repository&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;snapshotRepository&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;nexus&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;id&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;name&lt;/span&gt;&amp;gt;&lt;/span&gt;Snapshots&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;name&lt;/span&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;url&lt;/span&gt;&amp;gt;&lt;/span&gt;http://localhost:8081/repository/maven-snapshots/&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;url&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;snapshotRepository&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;distributionManagement&lt;/span&gt;&amp;gt;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 data-id=&quot;heading-10&quot;&gt;配置即可下载又可以上传&lt;/h2&gt;
   
    
           nexus
        nexus
           http://localhost:8081/repository/maven-snapshots/
        
               true
           
           
               true
           
       
   
&lt;pre&gt;&lt;code class=&quot;hljs language-go&quot; lang=&quot;go&quot;&gt;
然后执行deploy，进行打包，上传。

&lt;span class=&quot;hljs-string&quot;&gt;``&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;`shell
命令是：mvn deploy
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
   &lt;img src=&quot;https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c93bfae928a84fccaea6a7d16a6d6154~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LyY56eA55qE6aKc:q75.awebp?rk3s=f64ab15b&amp;amp;x-expires=1768965222&amp;amp;x-signature=9X8YQXgqmudxI%2FnTqKOB3JGV358%3D&quot; alt=&quot;image-20220626223309991&quot; loading=&quot;lazy&quot; referrerpolicy=&quot;no-referrer&quot;&gt;
&lt;p&gt;在私有仓库中可以查看到，自己上传的包，自己定义的版本号。&lt;/p&gt;
   &lt;img src=&quot;https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0811b6c0f0c4478baf83418664ea4990~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LyY56eA55qE6aKc:q75.awebp?rk3s=f64ab15b&amp;amp;x-expires=1768965222&amp;amp;x-signature=j8uhxnCPh2PXRzv9GdbX%2BIj9U3o%3D&quot; alt=&quot;image-20220626223653405&quot; loading=&quot;lazy&quot; referrerpolicy=&quot;no-referrer&quot;&gt;
&lt;p&gt;如果在Linux上安装：&lt;/p&gt;
&lt;p&gt;下载xxx.tar.gz安装包，上传到服务器中，进行解压&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-shell&quot; lang=&quot;shell&quot;&gt;tar -zxvf xxx.tar.gz
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;解压完成，进行改目录，到/bin目录下&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-shell&quot; lang=&quot;shell&quot;&gt;cd /xx/xxx/bin
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;进行启动，在bin目录下执行，需要关闭防火墙&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-shell&quot; lang=&quot;shell&quot;&gt;&lt;span class=&quot;hljs-meta prompt_&quot;&gt;# &lt;/span&gt;&lt;span class=&quot;bash&quot;&gt;启动&lt;/span&gt;
./nexus start
&lt;span class=&quot;hljs-meta prompt_&quot;&gt;
# &lt;/span&gt;&lt;span class=&quot;bash&quot;&gt;查看状态&lt;/span&gt;
./nexus status
&lt;span class=&quot;hljs-meta prompt_&quot;&gt;
# &lt;/span&gt;&lt;span class=&quot;bash&quot;&gt;查看启动端口号，进行页面访问,查看地址，进行访问登录，默认是8081端口&lt;/span&gt;
netstat -anp | grep java
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;进行页面访问，得到登录密码&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-shell&quot; lang=&quot;shell&quot;&gt;cd /opt/sonatype-work/nexus3/
&lt;span class=&quot;hljs-meta prompt_&quot;&gt;# &lt;/span&gt;&lt;span class=&quot;bash&quot;&gt;查看初始密码&lt;/span&gt;
cat admin.password
&lt;span class=&quot;hljs-meta prompt_&quot;&gt;# &lt;/span&gt;&lt;span class=&quot;bash&quot;&gt;得到密码，之后进行页面修改密码&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;</description><link>https://juejin.cn/post/7594831933515857966</link><guid isPermaLink="false">https://juejin.cn/post/7594831933515857966</guid><pubDate>Wed, 14 Jan 2026 03:13:42 GMT</pubDate><author>优秀的颜</author><category>后端</category></item><item><title>Ubuntu 24.04 PostgreSQL + PostGIS 完整安装与配置指南</title><description>&lt;h2 data-id=&quot;heading-0&quot;&gt;Ubuntu 24.04 PostgreSQL + PostGIS 完整安装与配置指南&lt;/h2&gt;
&lt;p&gt;PostGIS 是 PostgreSQL 的空间数据库扩展，为地理空间数据提供了强大的存储、查询和分析功能。本教程将详细介绍在 Ubuntu 24.04 上集成 PostGIS 的完整流程。&lt;/p&gt;
&lt;h3 data-id=&quot;heading-1&quot;&gt;1. 系统环境准备&lt;/h3&gt;
&lt;h4 data-id=&quot;heading-2&quot;&gt;1.1 更新系统包&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 更新软件包列表&lt;/span&gt;
sudo apt update

&lt;span class=&quot;hljs-comment&quot;&gt;# 升级现有软件包&lt;/span&gt;
sudo apt upgrade -y

&lt;span class=&quot;hljs-comment&quot;&gt;# 清理不需要的包&lt;/span&gt;
sudo apt autoremove -y
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-3&quot;&gt;1.2 安装必要的依赖&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 安装编译工具和依赖&lt;/span&gt;
sudo apt install -y \
    build-essential \
    wget \
    curl \
    git \
    software-properties-common \
    lsb-release \
    ca-certificates \
    gnupg
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-4&quot;&gt;2. 安装 PostgreSQL&lt;/h3&gt;
&lt;h4 data-id=&quot;heading-5&quot;&gt;2.1 添加 PostgreSQL 官方仓库&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 创建仓库配置文件&lt;/span&gt;
sudo sh -c &lt;span class=&quot;hljs-string&quot;&gt;&#39;echo &quot;deb https://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main&quot; &amp;gt; /etc/apt/sources.list.d/pgdg.list&#39;&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;# 导入 GPG 密钥&lt;/span&gt;
wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -

&lt;span class=&quot;hljs-comment&quot;&gt;# 更新包列表&lt;/span&gt;
sudo apt update
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-6&quot;&gt;2.2 安装 PostgreSQL 16（最新稳定版）&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 安装 PostgreSQL 16 及其常用扩展&lt;/span&gt;
sudo apt install -y \
    postgresql-16 \
    postgresql-client-16 \
    postgresql-contrib-16 \
    postgresql-server-dev-16
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-7&quot;&gt;2.3 验证安装&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 检查 PostgreSQL 服务状态&lt;/span&gt;
sudo systemctl status postgresql

&lt;span class=&quot;hljs-comment&quot;&gt;# 查看 PostgreSQL 版本&lt;/span&gt;
sudo -u postgres psql -c &lt;span class=&quot;hljs-string&quot;&gt;&quot;SELECT version();&quot;&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;# 设置开机自启&lt;/span&gt;
sudo systemctl &lt;span class=&quot;hljs-built_in&quot;&gt;enable&lt;/span&gt; postgresql
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-8&quot;&gt;3. 安装 PostGIS&lt;/h3&gt;
&lt;h4 data-id=&quot;heading-9&quot;&gt;3.1 安装 PostGIS 扩展&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 安装 PostGIS 及其依赖&lt;/span&gt;
sudo apt install -y \
    postgis \
    postgresql-16-postgis-3 \
    postgresql-16-postgis-3-scripts \
    postgresql-16-postgis-3-dbgsym

&lt;span class=&quot;hljs-comment&quot;&gt;# 安装 PostGIS 工具和额外扩展&lt;/span&gt;
sudo apt install -y \
    postgis-gui \
    postgis-doc \
    gdal-bin \
    proj-bin \
    libgeos-dev \
    libproj-dev
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-10&quot;&gt;3.2 验证 PostGIS 安装&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 检查 PostGIS 相关包是否安装成功&lt;/span&gt;
dpkg -l | grep postgis

&lt;span class=&quot;hljs-comment&quot;&gt;# 查看 GDAL 版本（PostGIS 依赖）&lt;/span&gt;
gdalinfo --version

&lt;span class=&quot;hljs-comment&quot;&gt;# 查看 GEOS 版本&lt;/span&gt;
geos-config --version
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-11&quot;&gt;4. 创建空间数据库&lt;/h3&gt;
&lt;h4 data-id=&quot;heading-12&quot;&gt;4.1 切换到 postgres 用户&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;sudo -i -u postgres
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-13&quot;&gt;4.2 创建专用空间数据库&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 创建新的数据库&lt;/span&gt;
createdb gis_database

&lt;span class=&quot;hljs-comment&quot;&gt;# 进入 PostgreSQL 控制台&lt;/span&gt;
psql -d gis_database
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-14&quot;&gt;4.3 启用 PostGIS 扩展&lt;/h4&gt;
&lt;p&gt;在 psql 命令行中执行：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-sql&quot; lang=&quot;sql&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;-- 启用 PostGIS 核心扩展&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;CREATE&lt;/span&gt; EXTENSION postgis;

&lt;span class=&quot;hljs-comment&quot;&gt;-- 启用 PostGIS 拓扑扩展（用于拓扑关系）&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;CREATE&lt;/span&gt; EXTENSION postgis_topology;

&lt;span class=&quot;hljs-comment&quot;&gt;-- 启用 PostGIS 栅格扩展（处理栅格数据）&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;CREATE&lt;/span&gt; EXTENSION postgis_raster;

&lt;span class=&quot;hljs-comment&quot;&gt;-- 启用 PostGIS SFCGAL 扩展（3D 和高级几何操作）&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;CREATE&lt;/span&gt; EXTENSION postgis_sfcgal;

&lt;span class=&quot;hljs-comment&quot;&gt;-- 启用地址标准化扩展&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;CREATE&lt;/span&gt; EXTENSION address_standardizer;
&lt;span class=&quot;hljs-keyword&quot;&gt;CREATE&lt;/span&gt; EXTENSION address_standardizer_data_us;

&lt;span class=&quot;hljs-comment&quot;&gt;-- 启用三维扩展&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;CREATE&lt;/span&gt; EXTENSION postgis_rtpostgis;

&lt;span class=&quot;hljs-comment&quot;&gt;-- 查看已启用的扩展&lt;/span&gt;
\dx
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-15&quot;&gt;4.4 验证 PostGIS 安装成功&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-sql&quot; lang=&quot;sql&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;-- 检查 PostGIS 版本&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; PostGIS_Version();
&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; PostGIS_Full_Version();

&lt;span class=&quot;hljs-comment&quot;&gt;-- 测试空间函数&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; ST_Point(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;);
&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; ST_Area(ST_GeomFromText(&lt;span class=&quot;hljs-string&quot;&gt;&#39;POLYGON((0 0, 1 0, 1 1, 0 1, 0 0))&#39;&lt;/span&gt;));

&lt;span class=&quot;hljs-comment&quot;&gt;-- 查看空间参考系统&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; srid, auth_name, auth_srid, srtext &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; spatial_ref_sys LIMIT &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-16&quot;&gt;5. 配置远程访问&lt;/h3&gt;
&lt;h4 data-id=&quot;heading-17&quot;&gt;5.1 退出 psql 并返回普通用户&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-sql&quot; lang=&quot;sql&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;-- 退出 psql&lt;/span&gt;
\q

&lt;span class=&quot;hljs-comment&quot;&gt;-- 退出 postgres 用户&lt;/span&gt;
exit
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-18&quot;&gt;5.2 配置 PostgreSQL 允许远程连接&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 编辑 PostgreSQL 配置文件&lt;/span&gt;
sudo nano /etc/postgresql/16/main/postgresql.conf
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;修改以下配置：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-ini&quot; lang=&quot;ini&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 监听所有网络接口&lt;/span&gt;
&lt;span class=&quot;hljs-attr&quot;&gt;listen_addresses&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&#39;*&#39;&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;# 设置端口（默认 5432）&lt;/span&gt;
&lt;span class=&quot;hljs-attr&quot;&gt;port&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;5432&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;# 增加连接数限制&lt;/span&gt;
&lt;span class=&quot;hljs-attr&quot;&gt;max_connections&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;100&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;# 共享缓冲区大小（根据内存调整）&lt;/span&gt;
&lt;span class=&quot;hljs-attr&quot;&gt;shared_buffers&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;256&lt;/span&gt;MB

&lt;span class=&quot;hljs-comment&quot;&gt;# 工作内存&lt;/span&gt;
&lt;span class=&quot;hljs-attr&quot;&gt;work_mem&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;16&lt;/span&gt;MB

&lt;span class=&quot;hljs-comment&quot;&gt;# 维护工作内存&lt;/span&gt;
&lt;span class=&quot;hljs-attr&quot;&gt;maintenance_work_mem&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;64&lt;/span&gt;MB
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-19&quot;&gt;5.3 配置客户端认证&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;sudo nano /etc/postgresql/16/main/pg_hba.conf
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;在文件末尾添加：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-ini&quot; lang=&quot;ini&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 允许所有 IP 通过密码访问（开发环境）&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;# 生产环境建议限制特定 IP 或网段&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;# IPv4 本地连接&lt;/span&gt;
host    all             all             127.0.0.1/32            scram-sha-256

&lt;span class=&quot;hljs-comment&quot;&gt;# IPv4 远程连接&lt;/span&gt;
host    all             all             0.0.0.0/0               scram-sha-256

&lt;span class=&quot;hljs-comment&quot;&gt;# IPv6 本地连接&lt;/span&gt;
host    all             all             ::1/128                 scram-sha-256

&lt;span class=&quot;hljs-comment&quot;&gt;# IPv6 远程连接&lt;/span&gt;
host    all             all             ::/0                    scram-sha-256
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-20&quot;&gt;5.4 设置 PostgreSQL 密码&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 切换到 postgres 用户&lt;/span&gt;
sudo -u postgres psql

&lt;span class=&quot;hljs-comment&quot;&gt;# 在 psql 中修改密码&lt;/span&gt;
ALTER USER postgres WITH PASSWORD &lt;span class=&quot;hljs-string&quot;&gt;&#39;YourStrongPassword123!&#39;&lt;/span&gt;;

&lt;span class=&quot;hljs-comment&quot;&gt;# 创建专用 GIS 用户&lt;/span&gt;
CREATE USER gis_admin WITH PASSWORD &lt;span class=&quot;hljs-string&quot;&gt;&#39;GisAdminPass456!&#39;&lt;/span&gt;;
ALTER USER gis_admin WITH SUPERUSER;

&lt;span class=&quot;hljs-comment&quot;&gt;# 授予数据库权限&lt;/span&gt;
GRANT ALL PRIVILEGES ON DATABASE gis_database TO gis_admin;

&lt;span class=&quot;hljs-comment&quot;&gt;# 退出&lt;/span&gt;
\q
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-21&quot;&gt;5.5 重启 PostgreSQL 服务&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;sudo systemctl restart postgresql

&lt;span class=&quot;hljs-comment&quot;&gt;# 检查服务状态&lt;/span&gt;
sudo systemctl status postgresql
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-22&quot;&gt;6. 防火墙配置&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 如果使用 UFW 防火墙&lt;/span&gt;
sudo ufw allow 5432/tcp
sudo ufw reload

&lt;span class=&quot;hljs-comment&quot;&gt;# 查看防火墙状态&lt;/span&gt;
sudo ufw status

&lt;span class=&quot;hljs-comment&quot;&gt;# 如果使用 iptables&lt;/span&gt;
sudo iptables -A INPUT -p tcp --dport 5432 -j ACCEPT
sudo iptables-save &amp;gt; /etc/iptables/rules.v4
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-23&quot;&gt;7. 安装 QGIS 桌面客户端（可选）&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 添加 QGIS 官方仓库&lt;/span&gt;
sudo add-apt-repository ppa:ubuntugis/ubuntugis-unstable

&lt;span class=&quot;hljs-comment&quot;&gt;# 更新包列表&lt;/span&gt;
sudo apt update

&lt;span class=&quot;hljs-comment&quot;&gt;# 安装 QGIS&lt;/span&gt;
sudo apt install -y qgis qgis-plugin-grass

&lt;span class=&quot;hljs-comment&quot;&gt;# 安装 QGIS 服务器&lt;/span&gt;
sudo apt install -y qgis-server
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-24&quot;&gt;8. 测试空间数据库功能&lt;/h3&gt;
&lt;h4 data-id=&quot;heading-25&quot;&gt;8.1 创建测试数据表&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 使用新用户连接数据库&lt;/span&gt;
psql -h localhost -U gis_admin -d gis_database
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;执行以下 SQL：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-sql&quot; lang=&quot;sql&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;-- 创建包含空间字段的表&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;TABLE&lt;/span&gt; buildings (
    id SERIAL &lt;span class=&quot;hljs-keyword&quot;&gt;PRIMARY&lt;/span&gt; KEY,
    name &lt;span class=&quot;hljs-type&quot;&gt;VARCHAR&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;100&lt;/span&gt;),
    geometry GEOMETRY(Polygon, &lt;span class=&quot;hljs-number&quot;&gt;4326&lt;/span&gt;),
    height &lt;span class=&quot;hljs-type&quot;&gt;FLOAT&lt;/span&gt;,
    created_at &lt;span class=&quot;hljs-type&quot;&gt;TIMESTAMP&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;CURRENT_TIMESTAMP&lt;/span&gt;
);

&lt;span class=&quot;hljs-comment&quot;&gt;-- 创建点数据表&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;TABLE&lt;/span&gt; points_of_interest (
    id SERIAL &lt;span class=&quot;hljs-keyword&quot;&gt;PRIMARY&lt;/span&gt; KEY,
    poi_name &lt;span class=&quot;hljs-type&quot;&gt;VARCHAR&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;100&lt;/span&gt;),
    description TEXT,
    location GEOMETRY(Point, &lt;span class=&quot;hljs-number&quot;&gt;4326&lt;/span&gt;),
    category &lt;span class=&quot;hljs-type&quot;&gt;VARCHAR&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;50&lt;/span&gt;)
);

&lt;span class=&quot;hljs-comment&quot;&gt;-- 创建空间索引&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;CREATE&lt;/span&gt; INDEX idx_buildings_geometry &lt;span class=&quot;hljs-keyword&quot;&gt;ON&lt;/span&gt; buildings &lt;span class=&quot;hljs-keyword&quot;&gt;USING&lt;/span&gt; GIST (geometry);
&lt;span class=&quot;hljs-keyword&quot;&gt;CREATE&lt;/span&gt; INDEX idx_poi_location &lt;span class=&quot;hljs-keyword&quot;&gt;ON&lt;/span&gt; points_of_interest &lt;span class=&quot;hljs-keyword&quot;&gt;USING&lt;/span&gt; GIST (location);

&lt;span class=&quot;hljs-comment&quot;&gt;-- 插入测试数据&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;INTO&lt;/span&gt; buildings (name, geometry, height) &lt;span class=&quot;hljs-keyword&quot;&gt;VALUES&lt;/span&gt;
(&lt;span class=&quot;hljs-string&quot;&gt;&#39;Main Building&#39;&lt;/span&gt;, 
 ST_GeomFromText(&lt;span class=&quot;hljs-string&quot;&gt;&#39;POLYGON((0 0, 10 0, 10 10, 0 10, 0 0))&#39;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4326&lt;/span&gt;), 
 &lt;span class=&quot;hljs-number&quot;&gt;25.5&lt;/span&gt;);

&lt;span class=&quot;hljs-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;INTO&lt;/span&gt; points_of_interest (poi_name, description, location, category) &lt;span class=&quot;hljs-keyword&quot;&gt;VALUES&lt;/span&gt;
(&lt;span class=&quot;hljs-string&quot;&gt;&#39;Central Park&#39;&lt;/span&gt;, 
 &lt;span class=&quot;hljs-string&quot;&gt;&#39;Main city park with playground&#39;&lt;/span&gt;,
 ST_SetSRID(ST_MakePoint(&lt;span class=&quot;hljs-number&quot;&gt;-74.0060&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;40.7128&lt;/span&gt;), &lt;span class=&quot;hljs-number&quot;&gt;4326&lt;/span&gt;),
 &lt;span class=&quot;hljs-string&quot;&gt;&#39;Park&#39;&lt;/span&gt;);

&lt;span class=&quot;hljs-comment&quot;&gt;-- 空间查询示例&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;-- 1. 计算面积&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; name, ST_Area(geometry) &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; area &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; buildings;

&lt;span class=&quot;hljs-comment&quot;&gt;-- 2. 计算距离&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; poi_name, 
       ST_Distance(
           location, 
           ST_SetSRID(ST_MakePoint(&lt;span class=&quot;hljs-number&quot;&gt;-74.0059&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;40.7129&lt;/span&gt;), &lt;span class=&quot;hljs-number&quot;&gt;4326&lt;/span&gt;)
       ) &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; distance_meters 
&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; points_of_interest;

&lt;span class=&quot;hljs-comment&quot;&gt;-- 3. 缓冲区查询&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; points_of_interest 
&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; ST_DWithin(
    location, 
    ST_SetSRID(ST_MakePoint(&lt;span class=&quot;hljs-number&quot;&gt;-74.0060&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;40.7128&lt;/span&gt;), &lt;span class=&quot;hljs-number&quot;&gt;4326&lt;/span&gt;), 
    &lt;span class=&quot;hljs-number&quot;&gt;0.01&lt;/span&gt;  &lt;span class=&quot;hljs-comment&quot;&gt;-- 约 1.1km&lt;/span&gt;
);

&lt;span class=&quot;hljs-comment&quot;&gt;-- 查看所有空间表&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; f_table_name, f_geometry_column, srid, type 
&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; geometry_columns;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-26&quot;&gt;9. 常用维护命令&lt;/h3&gt;
&lt;h4 data-id=&quot;heading-27&quot;&gt;9.1 数据库管理&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 备份数据库（包含 PostGIS 数据）&lt;/span&gt;
sudo -u postgres pg_dump -Fc -Z 9 gis_database &amp;gt; gis_backup.dump

&lt;span class=&quot;hljs-comment&quot;&gt;# 恢复数据库&lt;/span&gt;
sudo -u postgres pg_restore -d gis_database gis_backup.dump

&lt;span class=&quot;hljs-comment&quot;&gt;# 查看数据库大小&lt;/span&gt;
sudo -u postgres psql -c &lt;span class=&quot;hljs-string&quot;&gt;&quot;\l+ gis_database&quot;&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;# 清理数据库&lt;/span&gt;
sudo -u postgres vacuumdb --analyze --all
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-28&quot;&gt;9.2 空间数据处理工具&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 使用 shp2pgsql 导入 Shapefile&lt;/span&gt;
shp2pgsql -s 4326 -I path/to/shapefile.shp table_name | psql -d gis_database

&lt;span class=&quot;hljs-comment&quot;&gt;# 使用 ogr2ogr 导入多种格式&lt;/span&gt;
ogr2ogr -f &lt;span class=&quot;hljs-string&quot;&gt;&quot;PostgreSQL&quot;&lt;/span&gt; PG:&lt;span class=&quot;hljs-string&quot;&gt;&quot;dbname=gis_database host=localhost user=gis_admin&quot;&lt;/span&gt; input.geojson

&lt;span class=&quot;hljs-comment&quot;&gt;# 使用 pgsql2shp 导出 Shapefile&lt;/span&gt;
pgsql2shp -f output.shp -h localhost -u gis_admin gis_database &lt;span class=&quot;hljs-string&quot;&gt;&quot;SELECT * FROM buildings&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-29&quot;&gt;10. 性能优化配置&lt;/h3&gt;
&lt;h4 data-id=&quot;heading-30&quot;&gt;10.1 PostgreSQL 优化&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;sudo nano /etc/postgresql/16/main/postgresql.conf
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;添加或修改以下配置：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-ini&quot; lang=&quot;ini&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# PostGIS 特定优化&lt;/span&gt;
&lt;span class=&quot;hljs-attr&quot;&gt;shared_preload_libraries&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&#39;postgis-3&#39;&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;# 增加工作内存用于复杂空间查询&lt;/span&gt;
&lt;span class=&quot;hljs-attr&quot;&gt;work_mem&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;32&lt;/span&gt;MB

&lt;span class=&quot;hljs-comment&quot;&gt;# 增加维护内存&lt;/span&gt;
&lt;span class=&quot;hljs-attr&quot;&gt;maintenance_work_mem&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;128&lt;/span&gt;MB

&lt;span class=&quot;hljs-comment&quot;&gt;# 设置 checkpoint 间隔&lt;/span&gt;
&lt;span class=&quot;hljs-attr&quot;&gt;checkpoint_completion_target&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;0.9&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;# 启用并行查询&lt;/span&gt;
&lt;span class=&quot;hljs-attr&quot;&gt;max_parallel_workers_per_gather&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;
&lt;span class=&quot;hljs-attr&quot;&gt;max_parallel_workers&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;# 统计信息收集&lt;/span&gt;
&lt;span class=&quot;hljs-attr&quot;&gt;track_counts&lt;/span&gt; = &lt;span class=&quot;hljs-literal&quot;&gt;on&lt;/span&gt;
&lt;span class=&quot;hljs-attr&quot;&gt;track_activities&lt;/span&gt; = &lt;span class=&quot;hljs-literal&quot;&gt;on&lt;/span&gt;
&lt;span class=&quot;hljs-attr&quot;&gt;track_io_timing&lt;/span&gt; = &lt;span class=&quot;hljs-literal&quot;&gt;on&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-31&quot;&gt;10.2 重启服务应用配置&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;sudo systemctl restart postgresql
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-32&quot;&gt;11. 监控和调试&lt;/h3&gt;
&lt;h4 data-id=&quot;heading-33&quot;&gt;11.1 监控工具安装&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 安装监控扩展&lt;/span&gt;
sudo -u postgres psql -d gis_database -c &lt;span class=&quot;hljs-string&quot;&gt;&quot;CREATE EXTENSION pg_stat_statements;&quot;&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;# 安装 PostGIS 调试工具&lt;/span&gt;
sudo apt install -y postgis-utils
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-34&quot;&gt;11.2 常用监控查询&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-sql&quot; lang=&quot;sql&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;-- 查看空间表大小&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; 
    table_name,
    pg_size_pretty(pg_total_relation_size(table_name)) &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; total_size,
    pg_size_pretty(pg_relation_size(table_name)) &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; table_size,
    pg_size_pretty(pg_total_relation_size(table_name) &lt;span class=&quot;hljs-operator&quot;&gt;-&lt;/span&gt; pg_relation_size(table_name)) &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; index_size
&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; information_schema.tables 
&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; table_schema &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&#39;public&#39;&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; pg_total_relation_size(table_name) &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;;

&lt;span class=&quot;hljs-comment&quot;&gt;-- 查看最慢的查询&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; query, calls, total_time, mean_time
&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; pg_stat_statements
&lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; mean_time &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;
LIMIT &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;;

&lt;span class=&quot;hljs-comment&quot;&gt;-- 查看空间索引使用情况&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; 
    tablename,
    indexname,
    idx_scan &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; index_scans
&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; pg_indexes
&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; schemaname &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&#39;public&#39;&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;BY&lt;/span&gt; idx_scan &lt;span class=&quot;hljs-keyword&quot;&gt;DESC&lt;/span&gt;;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-35&quot;&gt;12. 常见问题解决&lt;/h3&gt;
&lt;h4 data-id=&quot;heading-36&quot;&gt;12.1 PostGIS 扩展启用失败&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 重新安装 PostGIS 扩展&lt;/span&gt;
sudo apt install --reinstall postgresql-16-postgis-3

&lt;span class=&quot;hljs-comment&quot;&gt;# 在数据库中重新创建扩展&lt;/span&gt;
sudo -u postgres psql -d gis_database -c &lt;span class=&quot;hljs-string&quot;&gt;&quot;DROP EXTENSION IF EXISTS postgis CASCADE;&quot;&lt;/span&gt;
sudo -u postgres psql -d gis_database -c &lt;span class=&quot;hljs-string&quot;&gt;&quot;CREATE EXTENSION postgis;&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-37&quot;&gt;12.2 空间参考系统问题&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-sql&quot; lang=&quot;sql&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;-- 查看可用的空间参考系统&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;SELECT&lt;/span&gt; srid, auth_name, srtext 
&lt;span class=&quot;hljs-keyword&quot;&gt;FROM&lt;/span&gt; spatial_ref_sys 
&lt;span class=&quot;hljs-keyword&quot;&gt;WHERE&lt;/span&gt; auth_name &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&#39;EPSG&#39;&lt;/span&gt; 
&lt;span class=&quot;hljs-keyword&quot;&gt;AND&lt;/span&gt; srid &lt;span class=&quot;hljs-keyword&quot;&gt;IN&lt;/span&gt; (&lt;span class=&quot;hljs-number&quot;&gt;4326&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3857&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;26910&lt;/span&gt;);

&lt;span class=&quot;hljs-comment&quot;&gt;-- 添加自定义空间参考系统（如果需要）&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;INTO&lt;/span&gt; spatial_ref_sys (srid, auth_name, auth_srid, srtext, proj4text)
&lt;span class=&quot;hljs-keyword&quot;&gt;VALUES&lt;/span&gt; (&lt;span class=&quot;hljs-number&quot;&gt;999999&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&#39;LOCAL&#39;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;999999&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&#39;CUSTOM CRS&#39;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&#39;+proj=longlat +datum=WGS84 +no_defs&#39;&lt;/span&gt;);
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-38&quot;&gt;12.3 连接问题&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 检查 PostgreSQL 日志&lt;/span&gt;
sudo &lt;span class=&quot;hljs-built_in&quot;&gt;tail&lt;/span&gt; -f /var/log/postgresql/postgresql-16-main.log

&lt;span class=&quot;hljs-comment&quot;&gt;# 测试本地连接&lt;/span&gt;
psql -h localhost -U gis_admin -d gis_database

&lt;span class=&quot;hljs-comment&quot;&gt;# 测试远程连接（从另一台机器）&lt;/span&gt;
psql -h &amp;lt;服务器IP&amp;gt; -p 5432 -U gis_admin -d gis_database
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-39&quot;&gt;13. 生产环境建议&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;安全加固&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;使用 SSL/TLS 加密连接&lt;/li&gt;
&lt;li&gt;配置更严格的 pg_hba.conf 规则&lt;/li&gt;
&lt;li&gt;定期更新密码&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;备份策略&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# 创建每日备份脚本&lt;/span&gt;
sudo nano /usr/local/bin/backup_gis.sh
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-bash&quot; lang=&quot;bash&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;#!/bin/bash&lt;/span&gt;
BACKUP_DIR=&lt;span class=&quot;hljs-string&quot;&gt;&quot;/var/backups/postgresql&quot;&lt;/span&gt;
DATE=$(&lt;span class=&quot;hljs-built_in&quot;&gt;date&lt;/span&gt; +%Y%m%d_%H%M%S)
sudo -u postgres pg_dump -Fc gis_database &amp;gt; &lt;span class=&quot;hljs-variable&quot;&gt;$BACKUP_DIR&lt;/span&gt;/gis_backup_&lt;span class=&quot;hljs-variable&quot;&gt;$DATE&lt;/span&gt;.dump
find &lt;span class=&quot;hljs-variable&quot;&gt;$BACKUP_DIR&lt;/span&gt; -name &lt;span class=&quot;hljs-string&quot;&gt;&quot;*.dump&quot;&lt;/span&gt; -mtime +7 -delete
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;监控告警&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;设置磁盘空间监控&lt;/li&gt;
&lt;li&gt;监控数据库连接数&lt;/li&gt;
&lt;li&gt;定期检查慢查询日志&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;</description><link>https://juejin.cn/post/7594765626457030706</link><guid isPermaLink="false">https://juejin.cn/post/7594765626457030706</guid><pubDate>Wed, 14 Jan 2026 03:09:03 GMT</pubDate><author>勿忘初心720</author><category>后端</category></item><item><title>深入理解 LLVM：从编译器原理到 JIT 实战</title><description>&lt;blockquote&gt;
&lt;p&gt;本文从编译器基础概念开始，逐步深入到 LLVM 的实现细节和实际应用，帮助开发者全面理解 LLVM 的工作原理和使用方法。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h2 data-id=&quot;heading-0&quot;&gt;目录&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://juejin.cn/post/7594722586731642886#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%E7%BC%96%E8%AF%91%E5%99%A8%E5%9F%BA%E7%A1%80&quot; title=&quot;#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%E7%BC%96%E8%AF%91%E5%99%A8%E5%9F%BA%E7%A1%80&quot;&gt;第一部分：编译器基础&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://juejin.cn/post/7594722586731642886#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86llvm-%E7%AE%80%E4%BB%8B&quot; title=&quot;#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86llvm-%E7%AE%80%E4%BB%8B&quot;&gt;第二部分：LLVM 简介&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://juejin.cn/post/7594722586731642886#%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86llvm-%E7%9A%84%E4%BD%BF%E7%94%A8&quot; title=&quot;#%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86llvm-%E7%9A%84%E4%BD%BF%E7%94%A8&quot;&gt;第三部分：LLVM 的使用&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://juejin.cn/post/7594722586731642886#%E7%AC%AC%E5%9B%9B%E9%83%A8%E5%88%86jeandle-%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90&quot; title=&quot;#%E7%AC%AC%E5%9B%9B%E9%83%A8%E5%88%86jeandle-%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90&quot;&gt;第四部分：Jeandle 案例分析&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://juejin.cn/post/7594722586731642886#%E7%AC%AC%E4%BA%94%E9%83%A8%E5%88%86%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3&quot; title=&quot;#%E7%AC%AC%E4%BA%94%E9%83%A8%E5%88%86%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3&quot;&gt;第五部分：深入理解&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h2 data-id=&quot;heading-1&quot;&gt;第一部分：编译器基础&lt;/h2&gt;
&lt;h3 data-id=&quot;heading-2&quot;&gt;编译器是什么？&lt;/h3&gt;
&lt;p&gt;编译器本质上是一个&lt;strong&gt;翻译官&lt;/strong&gt;，它的工作是将人类能理解的高级语言代码翻译成计算机能执行的机器码。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-mermaid&quot; lang=&quot;mermaid&quot;&gt;graph LR
    A[源代码&amp;lt;br/&amp;gt;高级语言] --&amp;gt; B[编译器]
    B --&amp;gt; C[机器码&amp;lt;br/&amp;gt;01010101]
    
    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#fce4ec
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;类比理解&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;源代码 = 中文文章&lt;/li&gt;
&lt;li&gt;编译器 = 翻译官&lt;/li&gt;
&lt;li&gt;机器码 = 英文文章（计算机能理解）&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 data-id=&quot;heading-3&quot;&gt;编译器的三个步骤&lt;/h3&gt;
&lt;p&gt;编译器的工作可以分为三个核心步骤：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-mermaid&quot; lang=&quot;mermaid&quot;&gt;graph LR
    A[源代码] --&amp;gt; B[词法分析&amp;lt;br/&amp;gt;Lexer]
    B --&amp;gt; C[Token流]
    C --&amp;gt; D[语法分析&amp;lt;br/&amp;gt;Parser]
    D --&amp;gt; E[AST]
    E --&amp;gt; F[代码生成&amp;lt;br/&amp;gt;CodeGen]
    F --&amp;gt; G[目标代码]
    
    style B fill:#e8f5e9
    style D fill:#e8f5e9
    style F fill:#e8f5e9
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-4&quot;&gt;步骤1：词法分析（Lexer）- &quot;拆词&quot;&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;作用&lt;/strong&gt;：把源代码拆成一个个有意义的&quot;单词&quot;（Token）&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;例子&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// 源代码&lt;/span&gt;
&lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;let x = 5 + 3&quot;&lt;/span&gt;;

&lt;span class=&quot;hljs-comment&quot;&gt;// 词法分析后&lt;/span&gt;
List&amp;lt;Token&amp;gt; tokens = Arrays.asList(
    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Token&lt;/span&gt;(TokenType.LET, &lt;span class=&quot;hljs-string&quot;&gt;&quot;let&quot;&lt;/span&gt;),
    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Token&lt;/span&gt;(TokenType.IDENTIFIER, &lt;span class=&quot;hljs-string&quot;&gt;&quot;x&quot;&lt;/span&gt;),
    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Token&lt;/span&gt;(TokenType.ASSIGN, &lt;span class=&quot;hljs-string&quot;&gt;&quot;=&quot;&lt;/span&gt;),
    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Token&lt;/span&gt;(TokenType.NUMBER, &lt;span class=&quot;hljs-string&quot;&gt;&quot;5&quot;&lt;/span&gt;),
    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Token&lt;/span&gt;(TokenType.PLUS, &lt;span class=&quot;hljs-string&quot;&gt;&quot;+&quot;&lt;/span&gt;),
    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Token&lt;/span&gt;(TokenType.NUMBER, &lt;span class=&quot;hljs-string&quot;&gt;&quot;3&quot;&lt;/span&gt;)
);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;实际代码&lt;/strong&gt;（Java 实现）：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Lexer&lt;/span&gt; {
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String source;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; List&amp;lt;Token&amp;gt; tokens = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ArrayList&lt;/span&gt;&amp;lt;&amp;gt;();
    
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; List&amp;lt;Token&amp;gt; &lt;span class=&quot;hljs-title function_&quot;&gt;tokenize&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {
        &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (pos &amp;lt; source.length()) {
            &lt;span class=&quot;hljs-type&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;ch&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; source.charAt(pos);
            
            &lt;span class=&quot;hljs-comment&quot;&gt;// 跳过空白字符&lt;/span&gt;
            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (Character.isWhitespace(ch)) {
                pos++;
                &lt;span class=&quot;hljs-keyword&quot;&gt;continue&lt;/span&gt;;
            }
            
            &lt;span class=&quot;hljs-comment&quot;&gt;// 数字&lt;/span&gt;
            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (Character.isDigit(ch)) {
                &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; readNumber();
                tokens.add(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Token&lt;/span&gt;(TokenType.NUMBER, value));
                &lt;span class=&quot;hljs-keyword&quot;&gt;continue&lt;/span&gt;;
            }
            
            &lt;span class=&quot;hljs-comment&quot;&gt;// 标识符或关键字&lt;/span&gt;
            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (Character.isLetter(ch) || ch == &lt;span class=&quot;hljs-string&quot;&gt;&#39;_&#39;&lt;/span&gt;) {
                &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; readIdentifier();
                &lt;span class=&quot;hljs-type&quot;&gt;TokenType&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; keywordMap.getOrDefault(value, TokenType.IDENTIFIER);
                tokens.add(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Token&lt;/span&gt;(type, value));
                &lt;span class=&quot;hljs-keyword&quot;&gt;continue&lt;/span&gt;;
            }
            
            &lt;span class=&quot;hljs-comment&quot;&gt;// 运算符和分隔符&lt;/span&gt;
            &lt;span class=&quot;hljs-keyword&quot;&gt;switch&lt;/span&gt; (ch) {
                &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&#39;+&#39;&lt;/span&gt;:
                    tokens.add(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Token&lt;/span&gt;(TokenType.PLUS));
                    &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;
                &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&#39;-&#39;&lt;/span&gt;:
                    tokens.add(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Token&lt;/span&gt;(TokenType.MINUS));
                    &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;
                &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&#39;=&#39;&lt;/span&gt;:
                    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (peekChar() == &lt;span class=&quot;hljs-string&quot;&gt;&#39;=&#39;&lt;/span&gt;) {
                        pos++;
                        tokens.add(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Token&lt;/span&gt;(TokenType.EQ));
                    } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {
                        tokens.add(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Token&lt;/span&gt;(TokenType.ASSIGN));
                    }
                    &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;
                &lt;span class=&quot;hljs-comment&quot;&gt;// ... 其他运算符&lt;/span&gt;
            }
            
            pos++;
        }
        
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; tokens;
    }
    
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String &lt;span class=&quot;hljs-title function_&quot;&gt;readNumber&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {
        &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;start&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; pos;
        &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (pos &amp;lt; source.length() &amp;amp;&amp;amp; Character.isDigit(source.charAt(pos))) {
            pos++;
        }
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; source.substring(start, pos);
    }
    
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; String &lt;span class=&quot;hljs-title function_&quot;&gt;readIdentifier&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {
        &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;start&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; pos;
        &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (pos &amp;lt; source.length() &amp;amp;&amp;amp; 
               (Character.isLetterOrDigit(source.charAt(pos)) || 
                source.charAt(pos) == &lt;span class=&quot;hljs-string&quot;&gt;&#39;_&#39;&lt;/span&gt;)) {
            pos++;
        }
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; source.substring(start, pos);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;类比&lt;/strong&gt;：就像把句子&quot;我喜欢苹果&quot;拆成 [&quot;我&quot;, &quot;喜欢&quot;, &quot;苹果&quot;]&lt;/p&gt;
&lt;h4 data-id=&quot;heading-5&quot;&gt;步骤2：语法分析（Parser）- &quot;理解结构&quot;&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;作用&lt;/strong&gt;：把 Token 流转换成抽象语法树（AST），理解代码的结构和含义&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;例子&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// Token 流&lt;/span&gt;
List&amp;lt;Token&amp;gt; tokens = Arrays.asList(
    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Token&lt;/span&gt;(TokenType.LET),
    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Token&lt;/span&gt;(TokenType.IDENTIFIER, &lt;span class=&quot;hljs-string&quot;&gt;&quot;x&quot;&lt;/span&gt;),
    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Token&lt;/span&gt;(TokenType.ASSIGN),
    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Token&lt;/span&gt;(TokenType.NUMBER, &lt;span class=&quot;hljs-string&quot;&gt;&quot;5&quot;&lt;/span&gt;),
    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Token&lt;/span&gt;(TokenType.PLUS),
    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Token&lt;/span&gt;(TokenType.NUMBER, &lt;span class=&quot;hljs-string&quot;&gt;&quot;3&quot;&lt;/span&gt;)
);

&lt;span class=&quot;hljs-comment&quot;&gt;// 语法分析后生成 AST&lt;/span&gt;
&lt;span class=&quot;hljs-type&quot;&gt;ASTNode&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;ast&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;AssignmentNode&lt;/span&gt;(
    &lt;span class=&quot;hljs-string&quot;&gt;&quot;x&quot;&lt;/span&gt;,
    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;BinaryOpNode&lt;/span&gt;(
        &lt;span class=&quot;hljs-string&quot;&gt;&quot;+&quot;&lt;/span&gt;,
        &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;NumberNode&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;),
        &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;NumberNode&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;)
    )
);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;AST 的树状结构&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-markdown&quot; lang=&quot;markdown&quot;&gt;&lt;span class=&quot;hljs-code&quot;&gt;      =
     / \
    x   +
       / \
      5   3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;实际代码&lt;/strong&gt;（Java 实现）：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Parser&lt;/span&gt; {
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; List&amp;lt;Token&amp;gt; tokens;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;current&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;
    
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; ASTNode &lt;span class=&quot;hljs-title function_&quot;&gt;parseExpression&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {
        &lt;span class=&quot;hljs-type&quot;&gt;ASTNode&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; parseTerm();
        
        &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (current &amp;lt; tokens.size() &amp;amp;&amp;amp; 
               (currentToken().getType() == TokenType.PLUS || 
                currentToken().getType() == TokenType.MINUS)) {
            &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;op&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; currentToken().getType().getValue();
            advance();
            &lt;span class=&quot;hljs-type&quot;&gt;ASTNode&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; parseTerm();
            left = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;BinaryOpNode&lt;/span&gt;(op, left, right);
        }
        
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; left;
    }
    
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; ASTNode &lt;span class=&quot;hljs-title function_&quot;&gt;parseAssignment&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {
        expect(TokenType.LET);
        &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; expect(TokenType.IDENTIFIER).getValue();
        expect(TokenType.ASSIGN);
        &lt;span class=&quot;hljs-type&quot;&gt;ASTNode&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; parseExpression();
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;AssignmentNode&lt;/span&gt;(name, value);
    }
    
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; ASTNode &lt;span class=&quot;hljs-title function_&quot;&gt;parseTerm&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {
        &lt;span class=&quot;hljs-type&quot;&gt;ASTNode&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; parseFactor();
        
        &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (current &amp;lt; tokens.size() &amp;amp;&amp;amp; 
               (currentToken().getType() == TokenType.MUL || 
                currentToken().getType() == TokenType.DIV)) {
            &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;op&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; currentToken().getType().getValue();
            advance();
            &lt;span class=&quot;hljs-type&quot;&gt;ASTNode&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; parseFactor();
            left = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;BinaryOpNode&lt;/span&gt;(op, left, right);
        }
        
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; left;
    }
    
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; ASTNode &lt;span class=&quot;hljs-title function_&quot;&gt;parseFactor&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {
        &lt;span class=&quot;hljs-type&quot;&gt;Token&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;token&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; currentToken();
        
        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (token.getType() == TokenType.NUMBER) {
            advance();
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;NumberNode&lt;/span&gt;(Integer.parseInt(token.getValue()));
        } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (token.getType() == TokenType.IDENTIFIER) {
            advance();
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;IdentifierNode&lt;/span&gt;(token.getValue());
        } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (token.getType() == TokenType.LPAREN) {
            advance();
            &lt;span class=&quot;hljs-type&quot;&gt;ASTNode&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;expr&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; parseExpression();
            expect(TokenType.RPAREN);
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; expr;
        }
        
        &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;SyntaxError&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Unexpected token: &quot;&lt;/span&gt; + token);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;类比&lt;/strong&gt;：理解&quot;我喜欢苹果&quot;中，&quot;我&quot;是主语，&quot;喜欢&quot;是动词，&quot;苹果&quot;是宾语&lt;/p&gt;
&lt;h4 data-id=&quot;heading-6&quot;&gt;步骤3：代码生成（CodeGen）- &quot;翻译&quot;&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;作用&lt;/strong&gt;：把 AST 转换成目标代码（在我们的例子中是 LLVM IR）&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;例子&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// AST&lt;/span&gt;
&lt;span class=&quot;hljs-type&quot;&gt;ASTNode&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;ast&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;AssignmentNode&lt;/span&gt;(
    &lt;span class=&quot;hljs-string&quot;&gt;&quot;x&quot;&lt;/span&gt;, 
    &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;BinaryOpNode&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;+&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;NumberNode&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;), &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;NumberNode&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;))
);

&lt;span class=&quot;hljs-comment&quot;&gt;// 代码生成后&lt;/span&gt;
&lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;llvmIR&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&quot;
  %x = alloca i32          ; 为变量 x 分配内存
  %1 = add i32 5, 3        ; 计算 5 + 3，结果存在 %1
  store i32 %1, i32* %x    ; 把结果存到 x 里
&quot;&quot;&quot;&lt;/span&gt;;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;实际代码&lt;/strong&gt;（Java 实现）：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;CodeGenerator&lt;/span&gt; {
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; LLVMModuleRef &lt;span class=&quot;hljs-keyword&quot;&gt;module&lt;/span&gt;;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; LLVMBuilderRef builder;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Map&amp;lt;String, LLVMValueRef&amp;gt; symbols = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HashMap&lt;/span&gt;&amp;lt;&amp;gt;();
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; LLVMTypeRef int32Type;
    
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;CodeGenerator&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; {
        &lt;span class=&quot;hljs-keyword&quot;&gt;module&lt;/span&gt; = LLVM.ModuleCreateWithName(&lt;span class=&quot;hljs-string&quot;&gt;&quot;calc_module&quot;&lt;/span&gt;);
        int32Type = LLVM.Int32Type();
    }
    
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; LLVMValueRef &lt;span class=&quot;hljs-title function_&quot;&gt;generateAssignment&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(AssignmentNode node)&lt;/span&gt; {
        &lt;span class=&quot;hljs-comment&quot;&gt;// 生成表达式的值&lt;/span&gt;
        &lt;span class=&quot;hljs-type&quot;&gt;LLVMValueRef&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; generateExpression(node.getValue());
        
        &lt;span class=&quot;hljs-comment&quot;&gt;// 分配内存（如果变量不存在）&lt;/span&gt;
        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!symbols.containsKey(node.getName())) {
            &lt;span class=&quot;hljs-type&quot;&gt;LLVMValueRef&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;alloca&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; LLVM.BuildAlloca(
                builder, int32Type, node.getName());
            symbols.put(node.getName(), alloca);
        }
        
        &lt;span class=&quot;hljs-comment&quot;&gt;// 存储值&lt;/span&gt;
        LLVM.BuildStore(builder, value, symbols.get(node.getName()));
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; value;
    }
    
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; LLVMValueRef &lt;span class=&quot;hljs-title function_&quot;&gt;generateExpression&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(ASTNode node)&lt;/span&gt; {
        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (node &lt;span class=&quot;hljs-keyword&quot;&gt;instanceof&lt;/span&gt; BinaryOpNode) {
            &lt;span class=&quot;hljs-type&quot;&gt;BinaryOpNode&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;binOp&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (BinaryOpNode) node;
            &lt;span class=&quot;hljs-type&quot;&gt;LLVMValueRef&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;left&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; generateExpression(binOp.getLeft());
            &lt;span class=&quot;hljs-type&quot;&gt;LLVMValueRef&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;right&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; generateExpression(binOp.getRight());
            
            &lt;span class=&quot;hljs-keyword&quot;&gt;switch&lt;/span&gt; (binOp.getOp()) {
                &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;+&quot;&lt;/span&gt;:
                    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; LLVM.BuildAdd(builder, left, right, &lt;span class=&quot;hljs-string&quot;&gt;&quot;add&quot;&lt;/span&gt;);
                &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;-&quot;&lt;/span&gt;:
                    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; LLVM.BuildSub(builder, left, right, &lt;span class=&quot;hljs-string&quot;&gt;&quot;sub&quot;&lt;/span&gt;);
                &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;*&quot;&lt;/span&gt;:
                    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; LLVM.BuildMul(builder, left, right, &lt;span class=&quot;hljs-string&quot;&gt;&quot;mul&quot;&lt;/span&gt;);
                &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;/&quot;&lt;/span&gt;:
                    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; LLVM.BuildSDiv(builder, left, right, &lt;span class=&quot;hljs-string&quot;&gt;&quot;div&quot;&lt;/span&gt;);
                &lt;span class=&quot;hljs-keyword&quot;&gt;default&lt;/span&gt;:
                    &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;IllegalArgumentException&lt;/span&gt;(
                        &lt;span class=&quot;hljs-string&quot;&gt;&quot;Unknown operator: &quot;&lt;/span&gt; + binOp.getOp());
            }
        } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (node &lt;span class=&quot;hljs-keyword&quot;&gt;instanceof&lt;/span&gt; NumberNode) {
            &lt;span class=&quot;hljs-type&quot;&gt;NumberNode&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;num&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (NumberNode) node;
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; LLVM.ConstInt(int32Type, num.getValue(), &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;);
        } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (node &lt;span class=&quot;hljs-keyword&quot;&gt;instanceof&lt;/span&gt; IdentifierNode) {
            &lt;span class=&quot;hljs-type&quot;&gt;IdentifierNode&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;ident&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (IdentifierNode) node;
            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!symbols.containsKey(ident.getName())) {
                &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;RuntimeException&lt;/span&gt;(
                    &lt;span class=&quot;hljs-string&quot;&gt;&quot;Variable not found: &quot;&lt;/span&gt; + ident.getName());
            }
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; LLVM.BuildLoad(builder, 
                symbols.get(ident.getName()), ident.getName());
        }
        
        &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;IllegalArgumentException&lt;/span&gt;(
            &lt;span class=&quot;hljs-string&quot;&gt;&quot;Unknown AST node type: &quot;&lt;/span&gt; + node.getClass());
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;类比&lt;/strong&gt;：把中文翻译成英文&lt;/p&gt;
&lt;h3 data-id=&quot;heading-7&quot;&gt;完整流程示例&lt;/h3&gt;
&lt;p&gt;让我们用一个完整的例子来看整个编译过程：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;源代码&lt;/strong&gt;（&lt;code&gt;examples/add.calc&lt;/code&gt;）：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-calc&quot; lang=&quot;calc&quot;&gt;func add(a, b) {
    return a + b
}

let result = add(5, 3)
print(result)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;第1步：词法分析&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-scss&quot; lang=&quot;scss&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(FUNC, &#39;func&#39;)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(IDENTIFIER, &#39;add&#39;)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(LPAREN)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(IDENTIFIER, &#39;a&#39;)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(COMMA)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(IDENTIFIER, &#39;b&#39;)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(RPAREN)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(LBRACE)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(RETURN, &#39;return&#39;)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(IDENTIFIER, &#39;a&#39;)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(PLUS)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(IDENTIFIER, &#39;b&#39;)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(RBRACE)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(LET, &#39;let&#39;)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(IDENTIFIER, &#39;result&#39;)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(ASSIGN)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(IDENTIFIER, &#39;add&#39;)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(LPAREN)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(NUMBER, &#39;&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;&#39;)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(COMMA)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(NUMBER, &#39;&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;&#39;)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(RPAREN)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(PRINT, &#39;print&#39;)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(LPAREN)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(IDENTIFIER, &#39;result&#39;)
&lt;span class=&quot;hljs-built_in&quot;&gt;Token&lt;/span&gt;(RPAREN)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;第2步：语法分析（AST）&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-less&quot; lang=&quot;less&quot;&gt;&lt;span class=&quot;hljs-selector-tag&quot;&gt;FunctionDef&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;add&quot;&lt;/span&gt;, [&lt;span class=&quot;hljs-string&quot;&gt;&quot;a&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;b&quot;&lt;/span&gt;], [
    &lt;span class=&quot;hljs-built_in&quot;&gt;Return&lt;/span&gt;(&lt;span class=&quot;hljs-built_in&quot;&gt;BinaryOp&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;+&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-built_in&quot;&gt;Identifier&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;a&quot;&lt;/span&gt;), &lt;span class=&quot;hljs-built_in&quot;&gt;Identifier&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;b&quot;&lt;/span&gt;)))
])

&lt;span class=&quot;hljs-selector-tag&quot;&gt;Assignment&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;result&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-built_in&quot;&gt;FunctionCall&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;add&quot;&lt;/span&gt;, [&lt;span class=&quot;hljs-built_in&quot;&gt;Number&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;), &lt;span class=&quot;hljs-built_in&quot;&gt;Number&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;)]))

&lt;span class=&quot;hljs-selector-tag&quot;&gt;FunctionCall&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;print&quot;&lt;/span&gt;, [&lt;span class=&quot;hljs-built_in&quot;&gt;Identifier&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;result&quot;&lt;/span&gt;)])
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;第3步：代码生成（LLVM IR）&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-llvm&quot; lang=&quot;llvm&quot;&gt;; ModuleID = &quot;calc_module&quot;
target triple = &quot;unknown-unknown-unknown&quot;

declare void @&quot;print&quot;(i32 %&quot;.1&quot;)

define i32 @&quot;main&quot;()
{
entry:
  %&quot;.2&quot; = call i32 @&quot;add&quot;(i32 5, i32 3)
  %&quot;result&quot; = alloca i32
  store i32 %&quot;.2&quot;, i32* %&quot;result&quot;
  %&quot;result.1&quot; = load i32, i32* %&quot;result&quot;
  call void @&quot;print&quot;(i32 %&quot;result.1&quot;)
  ret i32 0
}

define i32 @&quot;add&quot;(i32 %&quot;a&quot;, i32 %&quot;b&quot;)
{
entry:
  %&quot;a.1&quot; = alloca i32
  store i32 %&quot;a&quot;, i32* %&quot;a.1&quot;
  %&quot;b.1&quot; = alloca i32
  store i32 %&quot;b&quot;, i32* %&quot;b.1&quot;
  %&quot;a.2&quot; = load i32, i32* %&quot;a.1&quot;
  %&quot;b.2&quot; = load i32, i32* %&quot;b.1&quot;
  %&quot;add&quot; = add i32 %&quot;a.2&quot;, %&quot;b.2&quot;
  ret i32 %&quot;add&quot;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;h2 data-id=&quot;heading-8&quot;&gt;第二部分：LLVM 简介&lt;/h2&gt;
&lt;h3 data-id=&quot;heading-9&quot;&gt;什么是 LLVM？&lt;/h3&gt;
&lt;p&gt;LLVM（Low Level Virtual Machine）是一个&lt;strong&gt;编译器基础设施&lt;/strong&gt;，提供了一套模块化的编译器工具链。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;重要澄清&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;LLVM 不是一个虚拟机（尽管名字里有 VM）&lt;/li&gt;
&lt;li&gt;LLVM 是一个编译器框架和工具集&lt;/li&gt;
&lt;li&gt;LLVM 的核心是 LLVM IR（中间表示）&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 data-id=&quot;heading-10&quot;&gt;为什么选择 LLVM？&lt;/h3&gt;
&lt;h4 data-id=&quot;heading-11&quot;&gt;传统方式 vs LLVM 方式&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;传统方式（复杂）&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs&quot;&gt;你的语言 → 直接生成机器码
需要了解：x86、ARM、MIPS 等各种 CPU 架构
需要写：每个平台一套代码生成器（至少 6 套！）
开发时间：3-5 年
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;使用 LLVM（简单）&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs&quot;&gt;你的语言 → LLVM IR → LLVM自动生成机器码
你只需要：生成 LLVM IR（1 套代码）
LLVM 帮你：优化、跨平台、各种架构（自动支持所有平台）
开发时间：1-2 年
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-12&quot;&gt;实际例子：Swift 为什么用 LLVM？&lt;/h4&gt;
&lt;p&gt;Swift 需要支持：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;iPhone/iPad（ARM 架构）&lt;/li&gt;
&lt;li&gt;Mac（x86 和 ARM）&lt;/li&gt;
&lt;li&gt;Linux 服务器（x86）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;如果不用 LLVM&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;需要写 3 套代码生成器&lt;/li&gt;
&lt;li&gt;需要写 3 套优化器&lt;/li&gt;
&lt;li&gt;至少需要 3-5 年开发时间&lt;/li&gt;
&lt;li&gt;维护成本巨大&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;使用 LLVM&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;只需要生成 LLVM IR（1 套代码）&lt;/li&gt;
&lt;li&gt;LLVM 自动支持所有平台&lt;/li&gt;
&lt;li&gt;LLVM 自动优化代码&lt;/li&gt;
&lt;li&gt;1-2 年完成开发&lt;/li&gt;
&lt;li&gt;维护成本低&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 data-id=&quot;heading-13&quot;&gt;LLVM 的核心优势&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;一次编写，到处运行&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;生成 LLVM IR 后，自动支持所有平台&lt;/li&gt;
&lt;li&gt;Windows、Linux、Mac、iOS、Android 都能用&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;强大的优化能力&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;死代码消除&lt;/li&gt;
&lt;li&gt;循环优化&lt;/li&gt;
&lt;li&gt;内联函数&lt;/li&gt;
&lt;li&gt;常量折叠&lt;/li&gt;
&lt;li&gt;几十种优化算法&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;成熟的工具链&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;编译器（clang）&lt;/li&gt;
&lt;li&gt;调试器（lldb）&lt;/li&gt;
&lt;li&gt;性能分析工具&lt;/li&gt;
&lt;li&gt;代码格式化工具&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 data-id=&quot;heading-14&quot;&gt;LLVM IR 是什么？&lt;/h3&gt;
&lt;p&gt;LLVM IR（Intermediate Representation）是 LLVM 的中间代码格式，它是：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;人类能看懂&lt;/strong&gt;（不像机器码 01010101）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;比高级语言低级&lt;/strong&gt;（不像 Python 那么简单）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;比机器码高级&lt;/strong&gt;（不像汇编那么复杂）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;格式统一&lt;/strong&gt;（所有语言都能生成这种格式）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;类比&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-ini&quot; lang=&quot;ini&quot;&gt;高级语言（Python/Java） = 中文
         ↓
   LLVM &lt;span class=&quot;hljs-attr&quot;&gt;IR&lt;/span&gt; = 世界语（中间语言）
         ↓
   机器码 = 各种外语（英文、日文...）
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-15&quot;&gt;LLVM IR 基础语法&lt;/h3&gt;
&lt;h4 data-id=&quot;heading-16&quot;&gt;基本类型&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-llvm&quot; lang=&quot;llvm&quot;&gt;i32      ; 32位整数
i64      ; 64位整数
i32*     ; 指向 i32 的指针
void     ; 无类型
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-17&quot;&gt;基本操作&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-llvm&quot; lang=&quot;llvm&quot;&gt;; 分配内存
%x = alloca i32

; 存储值
store i32 5, i32* %x

; 加载值
%val = load i32, i32* %x

; 算术运算
%sum = add i32 %a, %b
%diff = sub i32 %a, %b
%prod = mul i32 %a, %b
%quot = sdiv i32 %a, %b

; 函数调用
call void @print(i32 %x)

; 返回
ret i32 0
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-18&quot;&gt;函数定义&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-llvm&quot; lang=&quot;llvm&quot;&gt;define i32 @add(i32 %a, i32 %b) {
entry:
  %1 = add i32 %a, %b
  ret i32 %1
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;关键点&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;%&lt;/code&gt; 开头的变量是局部变量（如 &lt;code&gt;%1&lt;/code&gt;, &lt;code&gt;%a&lt;/code&gt;）&lt;/li&gt;
&lt;li&gt;&lt;code&gt;@&lt;/code&gt; 开头的变量是全局变量或函数（如 &lt;code&gt;@add&lt;/code&gt;, &lt;code&gt;@print&lt;/code&gt;）&lt;/li&gt;
&lt;li&gt;&lt;code&gt;entry:&lt;/code&gt; 是基本块的标签&lt;/li&gt;
&lt;li&gt;每个函数至少有一个基本块&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 data-id=&quot;heading-19&quot;&gt;第三部分：LLVM 的使用&lt;/h2&gt;
&lt;h3 data-id=&quot;heading-20&quot;&gt;如何调用 LLVM API？&lt;/h3&gt;
&lt;p&gt;LLVM 提供了多种语言的绑定，最常见的是 C/C++ API，其他语言通过包装库调用。本文以 &lt;strong&gt;Java&lt;/strong&gt; 为例展示如何使用 LLVM API。&lt;/p&gt;
&lt;h4 data-id=&quot;heading-21&quot;&gt;Java 使用 LLVM&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.llvm.*;

&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;LLVMExample&lt;/span&gt; {
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(String[] args)&lt;/span&gt; {
        &lt;span class=&quot;hljs-comment&quot;&gt;// 创建 LLVM 模块&lt;/span&gt;
        &lt;span class=&quot;hljs-type&quot;&gt;LLVMModuleRef&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; LLVM.ModuleCreateWithName(&lt;span class=&quot;hljs-string&quot;&gt;&quot;calc_module&quot;&lt;/span&gt;);
        
        &lt;span class=&quot;hljs-comment&quot;&gt;// 创建类型&lt;/span&gt;
        &lt;span class=&quot;hljs-type&quot;&gt;LLVMTypeRef&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;int32Type&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; LLVM.Int32Type();
        &lt;span class=&quot;hljs-type&quot;&gt;LLVMTypeRef&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;voidType&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; LLVM.VoidType();
        
        &lt;span class=&quot;hljs-comment&quot;&gt;// 创建函数类型&lt;/span&gt;
        LLVMTypeRef[] paramTypes = {int32Type, int32Type};
        &lt;span class=&quot;hljs-type&quot;&gt;LLVMTypeRef&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;funcType&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; LLVM.FunctionType(int32Type, paramTypes, &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;);
        
        &lt;span class=&quot;hljs-comment&quot;&gt;// 创建函数&lt;/span&gt;
        &lt;span class=&quot;hljs-type&quot;&gt;LLVMValueRef&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; LLVM.AddFunction(&lt;span class=&quot;hljs-keyword&quot;&gt;module&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;add&quot;&lt;/span&gt;, funcType);
        
        &lt;span class=&quot;hljs-comment&quot;&gt;// 创建基本块&lt;/span&gt;
        &lt;span class=&quot;hljs-type&quot;&gt;LLVMBasicBlockRef&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;entryBlock&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; LLVM.AppendBasicBlock(func, &lt;span class=&quot;hljs-string&quot;&gt;&quot;entry&quot;&lt;/span&gt;);
        &lt;span class=&quot;hljs-type&quot;&gt;LLVMBuilderRef&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;builder&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; LLVM.CreateBuilder();
        LLVM.PositionBuilderAtEnd(builder, entryBlock);
        
        &lt;span class=&quot;hljs-comment&quot;&gt;// 生成代码&lt;/span&gt;
        &lt;span class=&quot;hljs-type&quot;&gt;LLVMValueRef&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;paramA&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; LLVM.GetParam(func, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;);
        &lt;span class=&quot;hljs-type&quot;&gt;LLVMValueRef&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;paramB&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; LLVM.GetParam(func, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);
        &lt;span class=&quot;hljs-type&quot;&gt;LLVMValueRef&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; LLVM.BuildAdd(builder, paramA, paramB, &lt;span class=&quot;hljs-string&quot;&gt;&quot;sum&quot;&lt;/span&gt;);
        LLVM.BuildRet(builder, result);
        
        &lt;span class=&quot;hljs-comment&quot;&gt;// 输出 LLVM IR&lt;/span&gt;
        &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;ir&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; LLVM.PrintModuleToString(&lt;span class=&quot;hljs-keyword&quot;&gt;module&lt;/span&gt;);
        System.out.println(ir);
        
        &lt;span class=&quot;hljs-comment&quot;&gt;// 清理资源&lt;/span&gt;
        LLVM.DisposeBuilder(builder);
        LLVM.DisposeModule(&lt;span class=&quot;hljs-keyword&quot;&gt;module&lt;/span&gt;);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;关键&lt;/strong&gt;：Java 使用 LLVM 就是调用 LLVM 的库（lib）包里面的 API 函数，通过 JNI 或 Java 绑定库来调用底层的 C/C++ API。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;其他语言&lt;/strong&gt;：Python 可以使用 &lt;code&gt;llvmlite&lt;/code&gt;，Rust 可以使用 &lt;code&gt;llvm-sys&lt;/code&gt;，但原理相同，都是调用 LLVM 的库 API。&lt;/p&gt;
&lt;h3 data-id=&quot;heading-22&quot;&gt;ModuleCreateWithName 的作用&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;重要理解&lt;/strong&gt;：&lt;code&gt;ModuleCreateWithName(&quot;test&quot;)&lt;/code&gt; 中的 &lt;code&gt;&quot;test&quot;&lt;/code&gt; 只是一个&lt;strong&gt;模块名称/标识符&lt;/strong&gt;，不是源代码！&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// 创建空模块（只是起个名字）&lt;/span&gt;
&lt;span class=&quot;hljs-type&quot;&gt;LLVMModuleRef&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; LLVM.ModuleCreateWithName(&lt;span class=&quot;hljs-string&quot;&gt;&quot;test&quot;&lt;/span&gt;);
&lt;span class=&quot;hljs-comment&quot;&gt;// 此时模块是空的，只有名字&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;// 实际的代码是通过后续 API 调用添加的&lt;/span&gt;
&lt;span class=&quot;hljs-type&quot;&gt;LLVMValueRef&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; LLVM.AddFunction(&lt;span class=&quot;hljs-keyword&quot;&gt;module&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;add&quot;&lt;/span&gt;, funcType);  &lt;span class=&quot;hljs-comment&quot;&gt;// ← 添加函数&lt;/span&gt;
LLVM.BuildAdd(builder, ...);  &lt;span class=&quot;hljs-comment&quot;&gt;// ← 添加实际的代码逻辑&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;类比&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ModuleCreateWithName&lt;/code&gt; = 创建空文件夹（起名字）&lt;/li&gt;
&lt;li&gt;&lt;code&gt;AddFunction&lt;/code&gt;、&lt;code&gt;BuildAdd&lt;/code&gt; 等 = 添加实际的文件（代码）&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 data-id=&quot;heading-23&quot;&gt;LLVM IR 到机器码的流程&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;重要澄清&lt;/strong&gt;：调用 LLVM API 后，生成的是 &lt;strong&gt;LLVM IR&lt;/strong&gt;，还不是机器码！&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-mermaid&quot; lang=&quot;mermaid&quot;&gt;graph TD
    A[调用 LLVM API] --&amp;gt; B[生成 LLVM IR&amp;lt;br/&amp;gt;中间代码]
    B --&amp;gt; C{编译器类型}
    
    C --&amp;gt;|静态编译器&amp;lt;br/&amp;gt;Swift/Rust| D[LLVM 优化器]
    C --&amp;gt;|JIT 编译器&amp;lt;br/&amp;gt;Jeandle| E[LLVM 优化器]
    
    D --&amp;gt; F[LLVM 代码生成器]
    E --&amp;gt; F
    
    F --&amp;gt; G[生成机器码&amp;lt;br/&amp;gt;二进制代码]
    
    G --&amp;gt; H{输出方式}
    H --&amp;gt;|静态编译器| I[保存到文件&amp;lt;br/&amp;gt;.exe/.o]
    H --&amp;gt;|JIT 编译器| J[放入 Code Cache&amp;lt;br/&amp;gt;代码缓存]
    
    J --&amp;gt; K[运行时直接执行&amp;lt;br/&amp;gt;从 cache 取]
    I --&amp;gt; L[可执行文件&amp;lt;br/&amp;gt;直接运行]
    
    style B fill:#e8f5e9
    style G fill:#fce4ec
    style K fill:#c8e6c9
    style L fill:#c8e6c9
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-24&quot;&gt;完整流程（JIT 编译器）&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// 1. 调用 LLVM API 生成 IR&lt;/span&gt;
&lt;span class=&quot;hljs-type&quot;&gt;LLVMModuleRef&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; LLVM.ModuleCreateWithName(&lt;span class=&quot;hljs-string&quot;&gt;&quot;java_method&quot;&lt;/span&gt;);
&lt;span class=&quot;hljs-comment&quot;&gt;// ... 生成 LLVM IR（还不是机器码！）&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;// 2. 优化 IR&lt;/span&gt;
&lt;span class=&quot;hljs-type&quot;&gt;LLVMPassManagerRef&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;pm&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; LLVM.CreatePassManager();
LLVM.RunPassManager(pm, &lt;span class=&quot;hljs-keyword&quot;&gt;module&lt;/span&gt;);

&lt;span class=&quot;hljs-comment&quot;&gt;// 3. 编译成机器码&lt;/span&gt;
&lt;span class=&quot;hljs-type&quot;&gt;byte&lt;/span&gt;[] machineCode = LLVM.CompileToMachineCode(&lt;span class=&quot;hljs-keyword&quot;&gt;module&lt;/span&gt;);
&lt;span class=&quot;hljs-comment&quot;&gt;// 现在是机器码了！&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;// 4. 放在 Code Cache&lt;/span&gt;
&lt;span class=&quot;hljs-type&quot;&gt;CodeCache&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;cache&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; getCodeCache();
cache.put(methodName, machineCode);

&lt;span class=&quot;hljs-comment&quot;&gt;// 5. 以后直接执行&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// 当 Java 方法被调用时，从 cache 中取出机器码直接执行&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;关键点&lt;/strong&gt;：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;调用 API 后生成的是 &lt;strong&gt;LLVM IR&lt;/strong&gt;（不是机器码）&lt;/li&gt;
&lt;li&gt;LLVM IR 需要编译成机器码&lt;/li&gt;
&lt;li&gt;机器码放在 code cache（JIT 编译器）&lt;/li&gt;
&lt;li&gt;从 cache 中直接执行（快）&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 data-id=&quot;heading-25&quot;&gt;Code Cache 的作用&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Code Cache&lt;/strong&gt; 是 JIT 编译器中的代码缓存，用于存储编译好的机器码。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;为什么需要 Code Cache？&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;JIT 编译器在运行时编译（慢）&lt;/li&gt;
&lt;li&gt;编译好的机器码放在 cache 中&lt;/li&gt;
&lt;li&gt;下次直接执行，不用再编译（快）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;类比&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;第一次：翻译文章（编译），放在书架（cache）&lt;/li&gt;
&lt;li&gt;第二次：直接从书架取（从 cache 执行），不用再翻译&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;静态编译器 vs JIT 编译器&lt;/strong&gt;：&lt;/p&gt;






























&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;特性&lt;/th&gt;&lt;th&gt;静态编译器&lt;/th&gt;&lt;th&gt;JIT 编译器&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;编译时机&lt;/td&gt;&lt;td&gt;提前编译&lt;/td&gt;&lt;td&gt;运行时编译&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;输出&lt;/td&gt;&lt;td&gt;可执行文件&lt;/td&gt;&lt;td&gt;Code Cache&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Code Cache&lt;/td&gt;&lt;td&gt;不需要&lt;/td&gt;&lt;td&gt;需要&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;例子&lt;/td&gt;&lt;td&gt;Swift、Rust&lt;/td&gt;&lt;td&gt;Jeandle、HotSpot&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;
&lt;hr&gt;
&lt;h2 data-id=&quot;heading-26&quot;&gt;第四部分：Jeandle 案例分析&lt;/h2&gt;
&lt;h3 data-id=&quot;heading-27&quot;&gt;Jeandle 是什么？&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Jeandle&lt;/strong&gt;（筋斗云）是蚂蚁集团开源的基于 LLVM 的 JVM JIT 编译器，它将 LLVM 的强大优化能力引入到 Java 虚拟机中。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;重要澄清&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;HotSpot JVM&lt;/strong&gt; 有自己的 JIT 编译器（C1、C2），&lt;strong&gt;不是&lt;/strong&gt;基于 LLVM&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Jeandle&lt;/strong&gt; 是新的尝试，用 LLVM 来做 JIT 编译器&lt;/li&gt;
&lt;li&gt;这样就能享受 LLVM 的强大优化能力&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 data-id=&quot;heading-28&quot;&gt;为什么重要？&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Java 是世界上使用最多的语言之一&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;很多大公司都在用 Java&lt;/li&gt;
&lt;li&gt;如果能提升 Java 的性能，影响巨大&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;LLVM 是业界最强的编译器工具&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Swift、Rust 等新语言都用它&lt;/li&gt;
&lt;li&gt;它的优化能力是顶级的&lt;/li&gt;
&lt;li&gt;但之前没有用在 JVM 上&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Jeandle 把两者结合&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;让 Java 也能享受 LLVM 的优势&lt;/li&gt;
&lt;li&gt;就像给 Java 装上了&quot;筋斗云&quot;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 data-id=&quot;heading-29&quot;&gt;Jeandle 的技术流程&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/241dca1e2bb2418e9f6d0e79373390cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p2o5p2o5p2o5aSn5L6g:q75.awebp?rk3s=f64ab15b&amp;amp;x-expires=1768963545&amp;amp;x-signature=%2BAudqM4%2F%2FdnA5S8meeOSwOF%2F13g%3D&quot; alt=&quot;image.png&quot; loading=&quot;lazy&quot; referrerpolicy=&quot;no-referrer&quot;&gt;&lt;/p&gt;
&lt;h4 data-id=&quot;heading-30&quot;&gt;详细步骤&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;步骤1：读取 Java 字节码&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// Jeandle 读取 Java 字节码&lt;/span&gt;
&lt;span class=&quot;hljs-type&quot;&gt;byte&lt;/span&gt;[] bytecode = readClassFile(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyClass.class&quot;&lt;/span&gt;);

&lt;span class=&quot;hljs-comment&quot;&gt;// class 文件内容（字节码）：&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// - 方法名、参数类型&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// - 字节码指令（iload, iadd, ireturn 等）&lt;/span&gt;
&lt;span class=&quot;hljs-comment&quot;&gt;// - 常量池&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;步骤2：转换成 LLVM IR&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// Jeandle 的核心工作：将字节码转换成 LLVM IR&lt;/span&gt;
&lt;span class=&quot;hljs-type&quot;&gt;LLVMModuleRef&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; LLVM.ModuleCreateWithName(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyClass.add&quot;&lt;/span&gt;);

&lt;span class=&quot;hljs-comment&quot;&gt;// 读取字节码指令并转换&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (bytecode instruction : bytecode) {
    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (instruction == ILOAD) {  &lt;span class=&quot;hljs-comment&quot;&gt;// 加载整数&lt;/span&gt;
        &lt;span class=&quot;hljs-comment&quot;&gt;// 转换成 LLVM IR：%1 = load i32, i32* %local_var&lt;/span&gt;
        LLVM.BuildLoad(builder, ...);
    }
    &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (instruction == IADD) {  &lt;span class=&quot;hljs-comment&quot;&gt;// 整数相加&lt;/span&gt;
        &lt;span class=&quot;hljs-comment&quot;&gt;// 转换成 LLVM IR：%2 = add i32 %1, %3&lt;/span&gt;
        LLVM.BuildAdd(builder, ...);
    }
    &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (instruction == IRETURN) {  &lt;span class=&quot;hljs-comment&quot;&gt;// 返回&lt;/span&gt;
        &lt;span class=&quot;hljs-comment&quot;&gt;// 转换成 LLVM IR：ret i32 %2&lt;/span&gt;
        LLVM.BuildRet(builder, ...);
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;步骤3：LLVM 编译成机器码&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// LLVM 将 IR 编译成机器码&lt;/span&gt;
&lt;span class=&quot;hljs-type&quot;&gt;byte&lt;/span&gt;[] machineCode = LLVM.CompileToMachineCode(&lt;span class=&quot;hljs-keyword&quot;&gt;module&lt;/span&gt;);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;步骤4：放在 Code Cache&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// 放在 code cache 中&lt;/span&gt;
codeCache.put(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyClass.add&quot;&lt;/span&gt;, machineCode);

&lt;span class=&quot;hljs-comment&quot;&gt;// 以后直接执行&lt;/span&gt;
executeFromCache(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyClass.add&quot;&lt;/span&gt;);
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-31&quot;&gt;技术挑战&lt;/h3&gt;
&lt;p&gt;Jeandle 需要解决的技术难题：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;垃圾回收（GC）支持&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Java 有自动内存管理&lt;/li&gt;
&lt;li&gt;需要让 LLVM 理解 Java 的 GC 机制&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Java 的动态特性&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;比如 &lt;code&gt;synchronized&lt;/code&gt;（同步锁）&lt;/li&gt;
&lt;li&gt;需要定制 LLVM 来支持这些特性&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Java 专用优化&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;针对 Java 语言特点的优化算法&lt;/li&gt;
&lt;li&gt;比如锁优化、逃逸分析等&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 data-id=&quot;heading-32&quot;&gt;与 HotSpot JVM 的对比&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-mermaid&quot; lang=&quot;mermaid&quot;&gt;graph TD
    A[Java 字节码&amp;lt;br/&amp;gt;.class 文件] --&amp;gt; B{选择 JIT 编译器}
    
    B --&amp;gt;|传统方式| C[HotSpot C1/C2 编译器]
    B --&amp;gt;|新方式| D[Jeandle + LLVM]
    
    C --&amp;gt; E[直接生成机器码&amp;lt;br/&amp;gt;自己写优化算法]
    D --&amp;gt; F[转换成 LLVM IR]
    
    F --&amp;gt; G[LLVM 优化器&amp;lt;br/&amp;gt;强大的优化能力]
    G --&amp;gt; H[LLVM 代码生成器&amp;lt;br/&amp;gt;生成机器码]
    
    E --&amp;gt; I[机器码]
    H --&amp;gt; I
    
    I --&amp;gt; J[放入 Code Cache]
    J --&amp;gt; K[执行]
    
    style C fill:#ffebee
    style D fill:#e8f5e9
    style G fill:#fff9c4
    style I fill:#fce4ec
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;对比总结&lt;/strong&gt;：&lt;/p&gt;






























&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;特性&lt;/th&gt;&lt;th&gt;HotSpot C1/C2&lt;/th&gt;&lt;th&gt;Jeandle + LLVM&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;优化能力&lt;/td&gt;&lt;td&gt;有限（自己实现）&lt;/td&gt;&lt;td&gt;强大（LLVM 优化）&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;开发成本&lt;/td&gt;&lt;td&gt;高（需要自己写）&lt;/td&gt;&lt;td&gt;低（复用 LLVM）&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;平台支持&lt;/td&gt;&lt;td&gt;需要自己支持&lt;/td&gt;&lt;td&gt;LLVM 自动支持&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;维护成本&lt;/td&gt;&lt;td&gt;高&lt;/td&gt;&lt;td&gt;低&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;
&lt;hr&gt;
&lt;h2 data-id=&quot;heading-33&quot;&gt;第五部分：深入理解&lt;/h2&gt;
&lt;h3 data-id=&quot;heading-34&quot;&gt;不能直接&quot;增加&quot;：为什么需要转换？&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;常见误解&lt;/strong&gt;：可以直接把 class 文件内容&quot;增加&quot;到 LLVM IR 中。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;实际情况&lt;/strong&gt;：不能直接&quot;增加&quot;，必须&lt;strong&gt;转换&lt;/strong&gt;！&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;原因&lt;/strong&gt;：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;格式不同&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Java 字节码是 JVM 的格式（iload, iadd 等）&lt;/li&gt;
&lt;li&gt;LLVM IR 是 LLVM 的格式（load, add 等）&lt;/li&gt;
&lt;li&gt;格式完全不同，必须转换&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;LLVM 不会自动理解&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;LLVM 不会自动理解 Java 语法或字节码&lt;/li&gt;
&lt;li&gt;LLVM 只能理解 LLVM IR 格式&lt;/li&gt;
&lt;li&gt;需要编译器前端来做转换&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;正确流程&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-arduino&quot; lang=&quot;arduino&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; 文件（Java 字节码）
  ↓
Jeandle 转换器（读取字节码）
  ↓
转换成 LLVM IR（格式转换）
  ↓
添加到 LLVM 模块中
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;错误流程&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-arduino&quot; lang=&quot;arduino&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; 文件内容
  ↓
直接放到 LLVM 模块中  ❌
  ↓
LLVM：我看不懂这是什么！
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-35&quot;&gt;字节码到 LLVM IR 的转换&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;指令映射关系&lt;/strong&gt;：&lt;/p&gt;



































&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Java 字节码&lt;/th&gt;&lt;th&gt;LLVM IR&lt;/th&gt;&lt;th&gt;说明&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;iload_1&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;code&gt;%1 = load i32, i32* %local_var&lt;/code&gt;&lt;/td&gt;&lt;td&gt;加载局部变量&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;iadd&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;code&gt;%2 = add i32 %1, %3&lt;/code&gt;&lt;/td&gt;&lt;td&gt;整数相加&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;ireturn&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;code&gt;ret i32 %2&lt;/code&gt;&lt;/td&gt;&lt;td&gt;返回整数&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;invokevirtual&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;code&gt;call i32 @method(...)&lt;/code&gt;&lt;/td&gt;&lt;td&gt;调用方法&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;getfield&lt;/code&gt;&lt;/td&gt;&lt;td&gt;&lt;code&gt;%obj = load %Class, %Class* %ptr&lt;/code&gt;&lt;br&gt;&lt;code&gt;%field = getelementptr ...&lt;/code&gt;&lt;/td&gt;&lt;td&gt;访问字段&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;实际转换示例&lt;/strong&gt;：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Java 字节码&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-arduino&quot; lang=&quot;arduino&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; a, &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; b)&lt;/span&gt; &lt;/span&gt;{
    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; a + b;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;字节码指令&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-arduino&quot; lang=&quot;arduino&quot;&gt;iload_1    &lt;span class=&quot;hljs-comment&quot;&gt;// 加载参数 a&lt;/span&gt;
iload_2    &lt;span class=&quot;hljs-comment&quot;&gt;// 加载参数 b&lt;/span&gt;
iadd       &lt;span class=&quot;hljs-comment&quot;&gt;// 相加&lt;/span&gt;
ireturn    &lt;span class=&quot;hljs-comment&quot;&gt;// 返回&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;转换后的 LLVM IR&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-llvm&quot; lang=&quot;llvm&quot;&gt;define i32 @add(i32 %a, i32 %b) {
entry:
  %1 = add i32 %a, %b
  ret i32 %1
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-36&quot;&gt;LLVM 优化器&lt;/h3&gt;
&lt;p&gt;LLVM 优化器包含几十种优化算法：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;常见优化&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;死代码消除&lt;/strong&gt;：删除永远不会执行的代码&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;循环优化&lt;/strong&gt;：优化循环结构，减少循环开销&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;内联函数&lt;/strong&gt;：将小函数直接展开到调用处&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;常量折叠&lt;/strong&gt;：在编译时计算常量表达式&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;公共子表达式消除&lt;/strong&gt;：避免重复计算相同的表达式&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;优化流程&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-mermaid&quot; lang=&quot;mermaid&quot;&gt;graph LR
    A[LLVM IR] --&amp;gt; B[优化 Pass 1]
    B --&amp;gt; C[优化 Pass 2]
    C --&amp;gt; D[优化 Pass 3]
    D --&amp;gt; E[...]
    E --&amp;gt; F[优化后的 IR]
    
    style A fill:#e8f5e9
    style F fill:#c8e6c9
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;使用示例&lt;/strong&gt;：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-java&quot; lang=&quot;java&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// 创建优化器&lt;/span&gt;
&lt;span class=&quot;hljs-type&quot;&gt;LLVMPassManagerRef&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;pm&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; LLVM.CreatePassManager();

&lt;span class=&quot;hljs-comment&quot;&gt;// 添加优化 Pass&lt;/span&gt;
LLVM.AddInstructionCombiningPass(pm);  &lt;span class=&quot;hljs-comment&quot;&gt;// 指令合并&lt;/span&gt;
LLVM.AddReassociatePass(pm);           &lt;span class=&quot;hljs-comment&quot;&gt;// 重新关联&lt;/span&gt;
LLVM.AddGVNPass(pm);                   &lt;span class=&quot;hljs-comment&quot;&gt;// 全局值编号&lt;/span&gt;
LLVM.AddCFGSimplificationPass(pm);      &lt;span class=&quot;hljs-comment&quot;&gt;// CFG 简化&lt;/span&gt;

&lt;span class=&quot;hljs-comment&quot;&gt;// 运行优化&lt;/span&gt;
LLVM.RunPassManager(pm, &lt;span class=&quot;hljs-keyword&quot;&gt;module&lt;/span&gt;);
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-37&quot;&gt;实际应用场景&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;使用 LLVM 的著名系统&lt;/strong&gt;：&lt;/p&gt;








































&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;系统/语言&lt;/th&gt;&lt;th&gt;为什么选择 LLVM&lt;/th&gt;&lt;th&gt;实际好处&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Swift&lt;/strong&gt; (Apple)&lt;/td&gt;&lt;td&gt;需要支持 iOS、macOS、Linux&lt;/td&gt;&lt;td&gt;一次编写，到处运行&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Rust&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;需要高性能和跨平台&lt;/td&gt;&lt;td&gt;LLVM 的优化能力很强&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Julia&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;科学计算需要高性能&lt;/td&gt;&lt;td&gt;LLVM 的数学优化很厉害&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Clang&lt;/strong&gt; (C/C++)&lt;/td&gt;&lt;td&gt;替代 GCC，更好的错误信息&lt;/td&gt;&lt;td&gt;LLVM 的模块化设计&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Kotlin Native&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;需要编译成原生代码&lt;/td&gt;&lt;td&gt;不需要 JVM，直接运行&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Jeandle&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;将 LLVM 优势引入 Java&lt;/td&gt;&lt;td&gt;强大的优化能力&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;
&lt;h2 data-id=&quot;heading-38&quot;&gt;参考资料&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://link.juejin.cn/?target=https%3A%2F%2Fllvm.org%2Fdocs%2F&quot; target=&quot;_blank&quot; title=&quot;https://llvm.org/docs/&quot; ref=&quot;nofollow noopener noreferrer&quot;&gt;LLVM 官方文档&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://link.juejin.cn/?target=https%3A%2F%2Fllvm.org%2Fdocs%2Ftutorial%2F&quot; target=&quot;_blank&quot; title=&quot;https://llvm.org/docs/tutorial/&quot; ref=&quot;nofollow noopener noreferrer&quot;&gt;LLVM Tutorial&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fjeandle%2Fjeandle&quot; target=&quot;_blank&quot; title=&quot;https://github.com/jeandle/jeandle&quot; ref=&quot;nofollow noopener noreferrer&quot;&gt;Jeandle 项目&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://link.juejin.cn/?target=.%2F&quot; target=&quot;_blank&quot; title=&quot;./&quot; ref=&quot;nofollow noopener noreferrer&quot;&gt;项目代码示例&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;记住&lt;/strong&gt;：编译器就是翻译官，LLVM 是专业的翻译工具！🚀&lt;/p&gt;</description><link>https://juejin.cn/post/7594722586731642886</link><guid isPermaLink="false">https://juejin.cn/post/7594722586731642886</guid><pubDate>Wed, 14 Jan 2026 02:45:45 GMT</pubDate><author>杨杨杨大侠</author><category>后端</category><category>Java</category><category>JVM</category><category>编译器</category></item><item><title>10分钟搞定！SpringBoot集成腾讯云短信全攻略，从配置到发送一气呵成</title><description>&lt;p&gt;大家好，我是小悟。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;在Spring Boot项目中集成腾讯云短信服务，主要通过官方SDK调用API实现，具有稳定性高、接入便捷的特点。下面是详细介绍如何实现。&lt;/p&gt;
&lt;h3 data-id=&quot;heading-0&quot;&gt;腾讯云短信核心概念&lt;/h3&gt;
&lt;p&gt;在开始前，需要了解几个核心概念：&lt;/p&gt;






























&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th align=&quot;left&quot;&gt;概念&lt;/th&gt;&lt;th align=&quot;left&quot;&gt;说明&lt;/th&gt;&lt;th align=&quot;left&quot;&gt;备注&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td align=&quot;left&quot;&gt;&lt;strong&gt;短信签名&lt;/strong&gt;&lt;/td&gt;&lt;td align=&quot;left&quot;&gt;附加在短信内容前的标识，用于标识发送方身份，如公司或产品名称。&lt;/td&gt;&lt;td align=&quot;left&quot;&gt;发送国内短信&lt;strong&gt;必须&lt;/strong&gt;使用已审核通过的签名。&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td align=&quot;left&quot;&gt;&lt;strong&gt;短信模板&lt;/strong&gt;&lt;/td&gt;&lt;td align=&quot;left&quot;&gt;预设的短信内容，包含可变参数的占位符（如&lt;code&gt;{1}&lt;/code&gt;）。&lt;/td&gt;&lt;td align=&quot;left&quot;&gt;模板需审核。发送时将占位符替换为具体值。&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td align=&quot;left&quot;&gt;&lt;strong&gt;SDKAppID &amp;amp; AppKey&lt;/strong&gt;&lt;/td&gt;&lt;td align=&quot;left&quot;&gt;代表短信应用的唯一凭证，用于鉴权。&lt;/td&gt;&lt;td align=&quot;left&quot;&gt;在&lt;strong&gt;短信控制台&lt;/strong&gt; &amp;gt; &lt;strong&gt;应用管理&lt;/strong&gt;中查看。&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td align=&quot;left&quot;&gt;&lt;strong&gt;SecretId &amp;amp; SecretKey&lt;/strong&gt;&lt;/td&gt;&lt;td align=&quot;left&quot;&gt;腾讯云API访问密钥，代表你的云账户权限，部分SDK或API方式会用到。&lt;/td&gt;&lt;td align=&quot;left&quot;&gt;在&lt;strong&gt;访问管理&lt;/strong&gt;[CAM]控制台创建和管理。&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;
&lt;h3 data-id=&quot;heading-1&quot;&gt;实施前准备&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;开通服务与创建应用&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;在腾讯云短信控制台开通服务。&lt;/li&gt;
&lt;li&gt;在“应用管理”中创建一个应用，获得 &lt;strong&gt;SDKAppID&lt;/strong&gt;，并生成对应的 &lt;strong&gt;AppKey&lt;/strong&gt;（如果使用旧版SDK）。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;创建签名与模板&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;在控制台根据用途（自用/他用）和类型（APP、网站等）申请短信签名。&lt;/li&gt;
&lt;li&gt;根据短信类型（验证码、通知、营销）创建正文模板，使用&lt;code&gt;{数字}&lt;/code&gt;格式定义变量，例如：&lt;code&gt;您的验证码是{1}，有效期{2}分钟。&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;等待审核通过&lt;/strong&gt;后，记录签名内容和模板ID。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 data-id=&quot;heading-2&quot;&gt;Spring Boot集成步骤&lt;/h3&gt;
&lt;h4 data-id=&quot;heading-3&quot;&gt;1. 引入官方SDK依赖&lt;/h4&gt;
&lt;p&gt;腾讯云为Java提供了&lt;code&gt;tencentcloud-sdk-java&lt;/code&gt;。在&lt;code&gt;pom.xml&lt;/code&gt;中添加依赖（请检查Maven仓库使用最新版本）：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-xml&quot; lang=&quot;xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;com.tencentcloudapi&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;tencentcloud-sdk-java&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;3.1.XXX&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- 请替换为最新版本 --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;compile&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;scope&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;该SDK封装了所有短信API，推荐使用。&lt;/p&gt;
&lt;h4 data-id=&quot;heading-4&quot;&gt;2. 配置安全凭证&lt;/h4&gt;
&lt;p&gt;将凭证配置在&lt;code&gt;application.yml&lt;/code&gt;中，&lt;strong&gt;切勿提交至代码仓库&lt;/strong&gt;。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-yaml&quot; lang=&quot;yaml&quot;&gt;&lt;span class=&quot;hljs-attr&quot;&gt;tencent:&lt;/span&gt;
  &lt;span class=&quot;hljs-attr&quot;&gt;sms:&lt;/span&gt;
    &lt;span class=&quot;hljs-attr&quot;&gt;secret-id:&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;your-secret-id&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;# 替换为你的SecretId&lt;/span&gt;
    &lt;span class=&quot;hljs-attr&quot;&gt;secret-key:&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;your-secret-key&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;# 替换为你的SecretKey&lt;/span&gt;
    &lt;span class=&quot;hljs-attr&quot;&gt;sdk-app-id:&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1400000000&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;# 替换为你的SDKAppID&lt;/span&gt;
    &lt;span class=&quot;hljs-attr&quot;&gt;sign-name:&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;你的签名内容&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;# 替换为审核通过的签名内容&lt;/span&gt;
    &lt;span class=&quot;hljs-attr&quot;&gt;template-id:&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1234567&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;# 替换为你常用的默认模板ID&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;在配置类中读取这些值：&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-typescript&quot; lang=&quot;typescript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; lombok.&lt;span class=&quot;hljs-property&quot;&gt;Data&lt;/span&gt;;
&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.&lt;span class=&quot;hljs-property&quot;&gt;springframework&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;boot&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;context&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;properties&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;ConfigurationProperties&lt;/span&gt;;
&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.&lt;span class=&quot;hljs-property&quot;&gt;springframework&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;context&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;annotation&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Configuration&lt;/span&gt;;

&lt;span class=&quot;hljs-meta&quot;&gt;@Configuration&lt;/span&gt;
&lt;span class=&quot;hljs-meta&quot;&gt;@ConfigurationProperties&lt;/span&gt;(prefix = &lt;span class=&quot;hljs-string&quot;&gt;&quot;tencent.sms&quot;&lt;/span&gt;)
&lt;span class=&quot;hljs-meta&quot;&gt;@Data&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;TencentSmsProperties&lt;/span&gt; {
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; secretId;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; secretKey;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; sdkAppId;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; signName;
    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; templateId;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 data-id=&quot;heading-5&quot;&gt;3. 创建短信发送服务&lt;/h4&gt;
&lt;p&gt;创建一个服务类来封装发送逻辑。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-typescript&quot; lang=&quot;typescript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.&lt;span class=&quot;hljs-property&quot;&gt;tencentcloudapi&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;common&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Credential&lt;/span&gt;;
&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.&lt;span class=&quot;hljs-property&quot;&gt;tencentcloudapi&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;common&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;exception&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;TencentCloudSDKException&lt;/span&gt;;
&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.&lt;span class=&quot;hljs-property&quot;&gt;tencentcloudapi&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;common&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;profile&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;ClientProfile&lt;/span&gt;;
&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.&lt;span class=&quot;hljs-property&quot;&gt;tencentcloudapi&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;common&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;profile&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;HttpProfile&lt;/span&gt;;
&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.&lt;span class=&quot;hljs-property&quot;&gt;tencentcloudapi&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;sms&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;v20210111&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;SmsClient&lt;/span&gt;;
&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; com.&lt;span class=&quot;hljs-property&quot;&gt;tencentcloudapi&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;sms&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;v20210111&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;models&lt;/span&gt;.*;
&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; lombok.&lt;span class=&quot;hljs-property&quot;&gt;RequiredArgsConstructor&lt;/span&gt;;
&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; lombok.&lt;span class=&quot;hljs-property&quot;&gt;extern&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;slf4j&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Slf4j&lt;/span&gt;;
&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.&lt;span class=&quot;hljs-property&quot;&gt;springframework&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;stereotype&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Service&lt;/span&gt;;

&lt;span class=&quot;hljs-meta&quot;&gt;@Service&lt;/span&gt;
&lt;span class=&quot;hljs-meta&quot;&gt;@Slf4j&lt;/span&gt;
&lt;span class=&quot;hljs-meta&quot;&gt;@RequiredArgsConstructor&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;TencentSmsService&lt;/span&gt; {

    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; final &lt;span class=&quot;hljs-title class_&quot;&gt;TencentSmsProperties&lt;/span&gt; smsProperties;

    &lt;span class=&quot;hljs-comment&quot;&gt;/**
     * 发送短信验证码
     *
     * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; phoneNumber 目标手机号（带区号，如&quot;+8613712345678&quot;）
     * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; templateId  模板ID（可选，不填则使用配置的默认模板ID）
     * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; templateParams 模板参数列表，按顺序替换模板中的变量{citation:6}
     * &lt;span class=&quot;hljs-doctag&quot;&gt;@return&lt;/span&gt; 发送是否成功
     */&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sendSms&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;String&lt;/span&gt; phoneNumber, &lt;span class=&quot;hljs-built_in&quot;&gt;String&lt;/span&gt; templateId, &lt;span class=&quot;hljs-built_in&quot;&gt;String&lt;/span&gt;[] templateParams&lt;/span&gt;) {
        &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {
            &lt;span class=&quot;hljs-comment&quot;&gt;// 1. 实例化认证对象，传入SecretId和SecretKey[citation:10]&lt;/span&gt;
            &lt;span class=&quot;hljs-title class_&quot;&gt;Credential&lt;/span&gt; cred = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Credential&lt;/span&gt;(smsProperties.&lt;span class=&quot;hljs-title function_&quot;&gt;getSecretId&lt;/span&gt;(), smsProperties.&lt;span class=&quot;hljs-title function_&quot;&gt;getSecretKey&lt;/span&gt;());

            &lt;span class=&quot;hljs-comment&quot;&gt;// 2. 配置HTTP和客户端Profile&lt;/span&gt;
            &lt;span class=&quot;hljs-title class_&quot;&gt;HttpProfile&lt;/span&gt; httpProfile = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;HttpProfile&lt;/span&gt;();
            httpProfile.&lt;span class=&quot;hljs-title function_&quot;&gt;setEndpoint&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;sms.tencentcloudapi.com&quot;&lt;/span&gt;); &lt;span class=&quot;hljs-comment&quot;&gt;// 短信API端点&lt;/span&gt;
            &lt;span class=&quot;hljs-title class_&quot;&gt;ClientProfile&lt;/span&gt; clientProfile = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ClientProfile&lt;/span&gt;();
            clientProfile.&lt;span class=&quot;hljs-title function_&quot;&gt;setHttpProfile&lt;/span&gt;(httpProfile);

            &lt;span class=&quot;hljs-comment&quot;&gt;// 3. 实例化SmsClient&lt;/span&gt;
            &lt;span class=&quot;hljs-title class_&quot;&gt;SmsClient&lt;/span&gt; client = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;SmsClient&lt;/span&gt;(cred, &lt;span class=&quot;hljs-string&quot;&gt;&quot;ap-guangzhou&quot;&lt;/span&gt;, clientProfile); &lt;span class=&quot;hljs-comment&quot;&gt;// 地域根据控制台指引选择&lt;/span&gt;

            &lt;span class=&quot;hljs-comment&quot;&gt;// 4. 构造请求对象并填充参数&lt;/span&gt;
            &lt;span class=&quot;hljs-title class_&quot;&gt;SendSmsRequest&lt;/span&gt; req = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;SendSmsRequest&lt;/span&gt;();
            req.&lt;span class=&quot;hljs-title function_&quot;&gt;setSmsSdkAppId&lt;/span&gt;(smsProperties.&lt;span class=&quot;hljs-title function_&quot;&gt;getSdkAppId&lt;/span&gt;()); &lt;span class=&quot;hljs-comment&quot;&gt;// 设置应用ID[citation:2]&lt;/span&gt;
            req.&lt;span class=&quot;hljs-title function_&quot;&gt;setSignName&lt;/span&gt;(smsProperties.&lt;span class=&quot;hljs-title function_&quot;&gt;getSignName&lt;/span&gt;()); &lt;span class=&quot;hljs-comment&quot;&gt;// 设置签名[citation:2]&lt;/span&gt;
            req.&lt;span class=&quot;hljs-title function_&quot;&gt;setTemplateId&lt;/span&gt;(templateId != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt; ? templateId : smsProperties.&lt;span class=&quot;hljs-title function_&quot;&gt;getTemplateId&lt;/span&gt;()); &lt;span class=&quot;hljs-comment&quot;&gt;// 设置模板ID&lt;/span&gt;
            req.&lt;span class=&quot;hljs-title function_&quot;&gt;setPhoneNumberSet&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;[]{phoneNumber}); &lt;span class=&quot;hljs-comment&quot;&gt;// 设置手机号，支持批量&lt;/span&gt;
            req.&lt;span class=&quot;hljs-title function_&quot;&gt;setTemplateParamSet&lt;/span&gt;(templateParams); &lt;span class=&quot;hljs-comment&quot;&gt;// 设置模板参数&lt;/span&gt;

            &lt;span class=&quot;hljs-comment&quot;&gt;// 5. 发起请求并处理响应&lt;/span&gt;
            &lt;span class=&quot;hljs-title class_&quot;&gt;SendSmsResponse&lt;/span&gt; resp = client.&lt;span class=&quot;hljs-title class_&quot;&gt;SendSms&lt;/span&gt;(req);
            &lt;span class=&quot;hljs-title class_&quot;&gt;SendStatus&lt;/span&gt; status = resp.&lt;span class=&quot;hljs-title function_&quot;&gt;getSendStatusSet&lt;/span&gt;()[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]; &lt;span class=&quot;hljs-comment&quot;&gt;// 取第一个号码的发送状态&lt;/span&gt;
            log.&lt;span class=&quot;hljs-title function_&quot;&gt;info&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;短信发送请求ID：{}，状态：{}，状态码：{}&quot;&lt;/span&gt;, resp.&lt;span class=&quot;hljs-title function_&quot;&gt;getRequestId&lt;/span&gt;(), status.&lt;span class=&quot;hljs-title function_&quot;&gt;getMessage&lt;/span&gt;(), status.&lt;span class=&quot;hljs-title function_&quot;&gt;getCode&lt;/span&gt;());

            &lt;span class=&quot;hljs-comment&quot;&gt;// 6. 判断发送结果（通常以&quot;Ok&quot;表示成功，请根据实际响应判断）&lt;/span&gt;
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Ok&quot;&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;equalsIgnoreCase&lt;/span&gt;(status.&lt;span class=&quot;hljs-title function_&quot;&gt;getCode&lt;/span&gt;());

        } &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (&lt;span class=&quot;hljs-title class_&quot;&gt;TencentCloudSDKException&lt;/span&gt; e) {
            log.&lt;span class=&quot;hljs-title function_&quot;&gt;error&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;腾讯云短信SDK调用失败，错误信息：{}&quot;&lt;/span&gt;, e.&lt;span class=&quot;hljs-title function_&quot;&gt;toString&lt;/span&gt;(), e);
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;
        }
    }

    &lt;span class=&quot;hljs-comment&quot;&gt;/**
     * 简化方法：发送固定模板的短信（如验证码）
     *
     * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; phoneNumber 目标手机号
     * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; code        验证码
     * &lt;span class=&quot;hljs-doctag&quot;&gt;@return&lt;/span&gt; 发送是否成功
     */&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sendVerificationCode&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;String&lt;/span&gt; phoneNumber, &lt;span class=&quot;hljs-built_in&quot;&gt;String&lt;/span&gt; code&lt;/span&gt;) {
        &lt;span class=&quot;hljs-comment&quot;&gt;// 假设你的验证码模板内容为：您的验证码是{1}，有效期{2}分钟。&lt;/span&gt;
        &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;[] templateParams = {code, &lt;span class=&quot;hljs-string&quot;&gt;&quot;5&quot;&lt;/span&gt;}; &lt;span class=&quot;hljs-comment&quot;&gt;// 验证码和有效期&lt;/span&gt;
        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sendSms&lt;/span&gt;(phoneNumber, &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;, templateParams); &lt;span class=&quot;hljs-comment&quot;&gt;// 使用配置中的默认模板ID&lt;/span&gt;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;核心说明&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;凭证安全&lt;/strong&gt;：&lt;code&gt;SecretId&lt;/code&gt;和&lt;code&gt;SecretKey&lt;/code&gt;代表账户所有权，务必保密。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;地域选择&lt;/strong&gt;：实例化&lt;code&gt;SmsClient&lt;/code&gt;时的地域参数（如&lt;code&gt;ap-guangzhou&lt;/code&gt;）需与短信控制台应用所在地域一致。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;错误处理&lt;/strong&gt;：生产环境需更完善的错误处理（如重试、熔断）和状态监控。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 data-id=&quot;heading-6&quot;&gt;4. 创建控制器提供API接口&lt;/h4&gt;
&lt;p&gt;创建一个简单的REST API接口，供前端或其他服务调用。&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;hljs language-typescript&quot; lang=&quot;typescript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; lombok.&lt;span class=&quot;hljs-property&quot;&gt;RequiredArgsConstructor&lt;/span&gt;;
&lt;span class=&quot;hljs-keyword&quot;&gt;import&lt;/span&gt; org.&lt;span class=&quot;hljs-property&quot;&gt;springframework&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;web&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;bind&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;annotation&lt;/span&gt;.*;

&lt;span class=&quot;hljs-meta&quot;&gt;@RestController&lt;/span&gt;
&lt;span class=&quot;hljs-meta&quot;&gt;@RequestMapping&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;/api/sms&quot;&lt;/span&gt;)
&lt;span class=&quot;hljs-meta&quot;&gt;@RequiredArgsConstructor&lt;/span&gt;
&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;SmsController&lt;/span&gt; {

    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; final &lt;span class=&quot;hljs-title class_&quot;&gt;TencentSmsService&lt;/span&gt; smsService;

    &lt;span class=&quot;hljs-meta&quot;&gt;@PostMapping&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;/send-code&quot;&lt;/span&gt;)
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ApiResponse&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;sendVerificationCode&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@RequestParam&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;String&lt;/span&gt; phoneNumber&lt;/span&gt;) {
        &lt;span class=&quot;hljs-comment&quot;&gt;// 1. 生成随机验证码（示例）&lt;/span&gt;
        &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; code = &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;valueOf&lt;/span&gt;((int)((&lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;random&lt;/span&gt;() * &lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt; + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) * &lt;span class=&quot;hljs-number&quot;&gt;100000&lt;/span&gt;));

        &lt;span class=&quot;hljs-comment&quot;&gt;// 2. 发送短信&lt;/span&gt;
        &lt;span class=&quot;hljs-built_in&quot;&gt;boolean&lt;/span&gt; isSuccess = smsService.&lt;span class=&quot;hljs-title function_&quot;&gt;sendVerificationCode&lt;/span&gt;(phoneNumber, code);

        &lt;span class=&quot;hljs-comment&quot;&gt;// 3. 此处应将验证码与手机号关联存储到Redis或Session，并设置过期时间，用于后续校验[citation:6]&lt;/span&gt;
        &lt;span class=&quot;hljs-comment&quot;&gt;// redisTemplate.opsForValue().set(&quot;SMS_CODE:&quot; + phoneNumber, code, 5, TimeUnit.MINUTES);&lt;/span&gt;

        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (isSuccess) {
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ApiResponse&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;success&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;短信发送成功&quot;&lt;/span&gt;);
        } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ApiResponse&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;fail&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;短信发送失败，请稍后重试&quot;&lt;/span&gt;);
        }
    }

    &lt;span class=&quot;hljs-comment&quot;&gt;// 简单的响应封装类&lt;/span&gt;
    &lt;span class=&quot;hljs-meta&quot;&gt;@Data&lt;/span&gt;
    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ApiResponse&lt;/span&gt; {
        &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;boolean&lt;/span&gt; success;
        &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt; message;
        &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Object&lt;/span&gt; data;

        &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ApiResponse&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;success&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;String&lt;/span&gt; message&lt;/span&gt;) {
            &lt;span class=&quot;hljs-title class_&quot;&gt;ApiResponse&lt;/span&gt; response = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ApiResponse&lt;/span&gt;();
            response.&lt;span class=&quot;hljs-title function_&quot;&gt;setSuccess&lt;/span&gt;(&lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;);
            response.&lt;span class=&quot;hljs-title function_&quot;&gt;setMessage&lt;/span&gt;(message);
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; response;
        }

        &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ApiResponse&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;fail&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;String&lt;/span&gt; message&lt;/span&gt;) {
            &lt;span class=&quot;hljs-title class_&quot;&gt;ApiResponse&lt;/span&gt; response = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;ApiResponse&lt;/span&gt;();
            response.&lt;span class=&quot;hljs-title function_&quot;&gt;setSuccess&lt;/span&gt;(&lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;);
            response.&lt;span class=&quot;hljs-title function_&quot;&gt;setMessage&lt;/span&gt;(message);
            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; response;
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 data-id=&quot;heading-7&quot;&gt;核心流程与最佳实践&lt;/h3&gt;
&lt;p&gt;将上面的步骤整合后，完整的短信发送流程如下：&lt;/p&gt;
&lt;p&gt;为了确保服务安全和稳定，请遵循以下实践：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;频率限制&lt;/strong&gt;：在控制台或代码中，对同一手机号设置发送频率和数量限制（如30秒1条、1天10条），防止短信轰炸。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;安全存储&lt;/strong&gt;：使用Redis等缓存验证码，并设置合理的过期时间（如5分钟），切勿返回给前端。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;监控与告警&lt;/strong&gt;：关注发送成功率，配置云监控告警，对于发送失败或频率异常及时处理。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;事务与幂等&lt;/strong&gt;：关键业务（如支付）的短信发送，应考虑与业务逻辑的事务一致性，并对发送请求做幂等处理。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 data-id=&quot;heading-8&quot;&gt;总结&lt;/h3&gt;
&lt;p&gt;在Spring Boot中集成腾讯云短信服务，核心是&lt;strong&gt;安全配置、服务封装和流程管控&lt;/strong&gt;。&lt;/p&gt;

























&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th align=&quot;left&quot;&gt;环节&lt;/th&gt;&lt;th align=&quot;left&quot;&gt;关键点&lt;/th&gt;&lt;th align=&quot;left&quot;&gt;常见问题&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td align=&quot;left&quot;&gt;&lt;strong&gt;前期准备&lt;/strong&gt;&lt;/td&gt;&lt;td align=&quot;left&quot;&gt;企业认证、签名/模板审核、获取凭证&lt;/td&gt;&lt;td align=&quot;left&quot;&gt;个人用户无法使用营销短信；模板变量格式错误。&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td align=&quot;left&quot;&gt;&lt;strong&gt;开发集成&lt;/strong&gt;&lt;/td&gt;&lt;td align=&quot;left&quot;&gt;使用官方Java SDK、&lt;strong&gt;保护SecretKey&lt;/strong&gt;、合理封装服务类。&lt;/td&gt;&lt;td align=&quot;left&quot;&gt;地域配置错误；SDK版本过旧。&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td align=&quot;left&quot;&gt;&lt;strong&gt;生产保障&lt;/strong&gt;&lt;/td&gt;&lt;td align=&quot;left&quot;&gt;&lt;strong&gt;设置发送频率限制&lt;/strong&gt;、验证码安全存储与校验、监控告警。&lt;/td&gt;&lt;td align=&quot;left&quot;&gt;短信被刷；验证码被爆破；服务不可用无感知。&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/407921335cbd4e8dbc92e599709c45da~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf56m656CB5a2X:q75.awebp?rk3s=f64ab15b&amp;amp;x-expires=1768961371&amp;amp;x-signature=YgwaB4lBGUKONo0m3g09kB7jYGg%3D&quot; alt=&quot;10分钟搞定！SpringBoot集成腾讯云短信全攻略，从配置到发送一气呵成.png&quot; loading=&quot;lazy&quot; referrerpolicy=&quot;no-referrer&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;谢谢你看我的文章，既然看到这里了，如果觉得不错，随手点个赞、转发、在看三连吧，感谢感谢。那我们，下次再见。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;您的一键三连，是我更新的最大动力，谢谢&lt;/p&gt;
&lt;p&gt;山水有相逢，来日皆可期，谢谢阅读，我们再会&lt;/p&gt;
&lt;p&gt;我手中的金箍棒，上能通天，下能探海&lt;/p&gt;</description><link>https://juejin.cn/post/7594739292200665123</link><guid isPermaLink="false">https://juejin.cn/post/7594739292200665123</guid><pubDate>Wed, 14 Jan 2026 02:09:31 GMT</pubDate><author>悟空码字</author><category>后端</category><category>Java</category><category>Spring Boot</category></item><item><title>SpringCloud分布式追踪深度实战：Sleuth+Zipkin从入门到生产部署全攻略</title><description>分布式链路追踪 - 微服务里的&quot;侦探&quot;，请求去哪儿了一清二楚🔍 一、先白话白话为啥需要链路追踪 零基础全栈开发Java微服务版本实战-后端-前端-运维-实战企业级三个实战项目 资源获取：关注公</description><link>https://juejin.cn/post/7594742976711884834</link><guid isPermaLink="false">https://juejin.cn/post/7594742976711884834</guid><pubDate>Wed, 14 Jan 2026 02:06:05 GMT</pubDate><author>小坏说Java</author><category>后端</category><category>Spring Cloud</category><category>分布式</category></item><item><title>工作中最常用的5种本地缓存</title><description>前言 今天和大家聊聊一个几乎所有Java开发者都会用到，但很多人对其理解不够深入的技术——本地缓存。 有些小伙伴在工作中可能遇到过这样的场景：系统性能测试时，发现某个接口响应时间越来越长，一查发现是数</description><link>https://juejin.cn/post/7594728203257364514</link><guid isPermaLink="false">https://juejin.cn/post/7594728203257364514</guid><pubDate>Wed, 14 Jan 2026 01:58:04 GMT</pubDate><author>苏三说技术</author><category>后端</category></item><item><title>“磁盘爆满告警”——Linux 服务器空间排查与优化实战</title><description>来自运维的告警 近日运维同事找到我说你看看这台 113 的机器是不是你这边业务的，存储使用超出 80% 了，我心里一沉这确实是我的业务！根分区使用率超过 90% 就是高危状态，再涨一点</description><link>https://juejin.cn/post/7594735599313993778</link><guid isPermaLink="false">https://juejin.cn/post/7594735599313993778</guid><pubDate>Wed, 14 Jan 2026 01:53:26 GMT</pubDate><author>帅气的你</author><category>后端</category><category>Linux</category><category>程序员</category></item><item><title>工作中七天免登录如何实现</title><description>作为一名Java后端高级开发，我敢说“七天免登录”是业务系统里最常见的需求之一——用户登录一次后，一周内再次访问系统无需重复输入账号密码，直接就能进入主页。这个需求看似简单，但实现不好很容易踩坑：要么</description><link>https://juejin.cn/post/7594728203257167906</link><guid isPermaLink="false">https://juejin.cn/post/7594728203257167906</guid><pubDate>Wed, 14 Jan 2026 01:30:47 GMT</pubDate><author>天天摸鱼的java工程师</author><category>后端</category><category>Java</category></item><item><title>大数据量查询处理方案</title><description>在实际开发中，经常遇到需要查询大量数据的场景，如：订单历史数据导出，报表统计查询等，此文章记录如何优化该场景</description><link>https://juejin.cn/post/7594734666009100297</link><guid isPermaLink="false">https://juejin.cn/post/7594734666009100297</guid><pubDate>Wed, 14 Jan 2026 01:01:27 GMT</pubDate><author>码头整点薯条</author><category>后端</category><category>Java</category></item><item><title>C 语言实战：水果总价计算程序（结构体应用 + 细节优化）</title><description>C 语言实战：水果总价计算程序（结构体应用 + 细节优化） 这是一个典型的 C 语言结构体入门应用案例，通过定义结构体存储水果单价，接收用户输入的购买斤数，最终计算并输出总价。</description><link>https://juejin.cn/post/7594759496367964170</link><guid isPermaLink="false">https://juejin.cn/post/7594759496367964170</guid><pubDate>Wed, 14 Jan 2026 00:58:15 GMT</pubDate><author>小杨同学49</author><category>后端</category><category>算法</category><category>程序员</category></item><item><title>【RuoYi-SpringBoot3-Pro】：多租户功能上手指南</title><description>RuoYi-SpringBoot3-Pro 直接集成了 MyBatis-Plus 的多租户插件，不用再关注租户 ID，框架层自动注入过滤条件。配合&amp;nbsp;使用 Dify + AI 快速生成多数据库建表语句</description><link>https://juejin.cn/post/7594759496367865866</link><guid isPermaLink="false">https://juejin.cn/post/7594759496367865866</guid><pubDate>Wed, 14 Jan 2026 00:40:02 GMT</pubDate><author>undsky</author><category>后端</category><category>MyBatis</category><category>Spring Boot</category></item><item><title>松耦合的设计模式-观察者</title><description>观察者模式是一种对象行为型模式，定义对象间一对多的依赖关系，当一个对象（被观察者/主题）的状态发生改变时，所有依赖它的对象（观察者）都会收到通知并自动更新。 代码实现 比如说在订单业务中，当我们实现订</description><link>https://juejin.cn/post/7594523145212166198</link><guid isPermaLink="false">https://juejin.cn/post/7594523145212166198</guid><pubDate>Wed, 14 Jan 2026 00:19:39 GMT</pubDate><author>明天有专业课</author><category>后端</category></item><item><title>JINA AI 与 Elasticsearch 的集成</title><description>Jina AI现在是 Elastic 的一部分，将其高性能多语言和多模态搜索 AI 带入 Elasticsearch 强大的数据存储、检索和索引能力。Jina AI 模型可以通过公共 API 与 El</description><link>https://juejin.cn/post/7594627998852448262</link><guid isPermaLink="false">https://juejin.cn/post/7594627998852448262</guid><pubDate>Tue, 13 Jan 2026 23:26:40 GMT</pubDate><author>Elasticsearch</author><category>后端</category><category>Elasticsearch</category></item><item><title>《自动化埋点：利用 AOP 统一记录接口入参、出参及执行耗时》</title><description>前言 在定位线上问题时，最常用的操作就是查看接口的“入参是什么”以及“返回了什么”。如果手动在每个 Controller 方法中去打印日志，不仅代码臃肿，且难以维护。 通过 Spring AOP（面向</description><link>https://juejin.cn/post/7594682922684006409</link><guid isPermaLink="false">https://juejin.cn/post/7594682922684006409</guid><pubDate>Tue, 13 Jan 2026 16:09:34 GMT</pubDate><author>用户94835701651</author><category>后端</category></item></channel></rss>