<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[ã€Kotlinç³»åˆ—08ã€‘æ³›å‹è¿›é˜¶ï¼šä»å‹å˜åˆ°å…·ä½“åŒ–ç±»å‹å‚æ•°çš„ç±»å‹å®‰å…¨ä¹‹æ—…]]></title>    <link>https://juejin.cn/post/7595808703074893850</link>    <guid>https://juejin.cn/post/7595808703074893850</guid>    <pubDate>2026-01-17T12:28:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595808703074893850" data-draft-id="7595894884957077555" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Kotlinç³»åˆ—08ã€‘æ³›å‹è¿›é˜¶ï¼šä»å‹å˜åˆ°å…·ä½“åŒ–ç±»å‹å‚æ•°çš„ç±»å‹å®‰å…¨ä¹‹æ—…"/> <meta itemprop="keywords" content="Kotlin,Android,ç¼–ç¨‹è¯­è¨€"/> <meta itemprop="datePublished" content="2026-01-17T12:28:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†¬å¥‡Lab"/> <meta itemprop="url" content="https://juejin.cn/user/1857501105781193"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Kotlinç³»åˆ—08ã€‘æ³›å‹è¿›é˜¶ï¼šä»å‹å˜åˆ°å…·ä½“åŒ–ç±»å‹å‚æ•°çš„ç±»å‹å®‰å…¨ä¹‹æ—…
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1857501105781193/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†¬å¥‡Lab
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T12:28:11.000Z" title="Sat Jan 17 2026 12:28:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€ï¼šé‚£ä¸ªè®©æˆ‘å›°æƒ‘ä¸‰å¤©çš„ç¼–è¯‘é”™è¯¯</h2>
<p>è¿˜è®°å¾—åˆšå­¦Kotlinæ³›å‹æ—¶ï¼Œæˆ‘å†™äº†è¿™æ ·ä¸€æ®µä»£ç ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æˆ‘ä»¥ä¸ºè¿™æ ·å¯ä»¥...</span>
<span class="hljs-keyword">val</span> strings: List&lt;String&gt; = listOf(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>)
<span class="hljs-keyword">val</span> objects: List&lt;Any&gt; = strings  <span class="hljs-comment">// âŒ ç¼–è¯‘é”™è¯¯ï¼Type mismatch</span>

<span class="hljs-comment">// ä½†è¿™æ ·å´å¯ä»¥ï¼Ÿ</span>
<span class="hljs-keyword">val</span> readOnlyStrings: List&lt;String&gt; = listOf(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>)
<span class="hljs-keyword">val</span> readOnlyObjects: List&lt;Any&gt; = readOnlyStrings  <span class="hljs-comment">// âœ… ç¼–è¯‘é€šè¿‡ï¼</span>
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆç¬¬ä¸€ä¸ªä¸è¡Œï¼Œç¬¬äºŒä¸ªå´å¯ä»¥ï¼Ÿ</strong> è¿™ä¸ªé—®é¢˜å›°æ‰°äº†æˆ‘æ•´æ•´ä¸‰å¤©ã€‚åæ¥æ‰æ˜ç™½ï¼Œè¿™æ¶‰åŠåˆ°æ³›å‹çš„ <strong>å‹å˜ï¼ˆVarianceï¼‰</strong> æ¦‚å¿µã€‚</p>
<p>å†çœ‹è¿™ä¸ªåœºæ™¯ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æƒ³å†™ä¸€ä¸ªé€šç”¨çš„ç­›é€‰å‡½æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">filterItems</span><span class="hljs-params">(items: <span class="hljs-type">List</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: List&lt;T&gt; {
    <span class="hljs-keyword">return</span> items.filter { it <span class="hljs-keyword">is</span> String }  <span class="hljs-comment">// âŒ æ€ä¹ˆåˆ¤æ–­ç±»å‹ï¼Ÿ</span>
}

<span class="hljs-comment">// è¿è¡Œæ—¶ç±»å‹æ“¦é™¤ï¼Œæ³›å‹ä¿¡æ¯ä¸¢å¤±äº†</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">createInstance</span><span class="hljs-params">()</span></span>: T {
    <span class="hljs-keyword">return</span> T()  <span class="hljs-comment">// âŒ ç¼–è¯‘é”™è¯¯ï¼šCannot use T as reified type parameter</span>
}
</code></pre>
<p>è¿™äº›é—®é¢˜çš„ç­”æ¡ˆå°±åœ¨Kotlinæ³›å‹çš„é«˜çº§ç‰¹æ€§ä¸­ï¼š<strong>å‹å˜ã€å…·ä½“åŒ–ç±»å‹å‚æ•°ã€ç±»å‹è¾¹ç•Œ</strong>ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥æ·±å…¥æ¢ç´¢è¿™äº›è®©æ³›å‹æ›´å¼ºå¤§ã€æ›´å®‰å…¨çš„ç‰¹æ€§ã€‚</p>
<h2 data-id="heading-1">æ³›å‹åŸºç¡€å›é¡¾</h2>
<h3 data-id="heading-2">ä»€ä¹ˆæ˜¯æ³›å‹</h3>
<p>æ³›å‹å…è®¸æˆ‘ä»¬ç¼–å†™å¯ä»¥å¤„ç†å¤šç§ç±»å‹çš„ä»£ç ï¼ŒåŒæ—¶ä¿æŒç±»å‹å®‰å…¨ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æ²¡æœ‰æ³›å‹ï¼šéœ€è¦ä¸ºæ¯ç§ç±»å‹å†™ä¸€ä¸ªç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">IntBox</span>(<span class="hljs-keyword">val</span> value: <span class="hljs-built_in">Int</span>)
<span class="hljs-keyword">class</span> <span class="hljs-title class_">StringBox</span>(<span class="hljs-keyword">val</span> value: String)
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserBox</span>(<span class="hljs-keyword">val</span> value: User)

<span class="hljs-comment">// ä½¿ç”¨æ³›å‹ï¼šä¸€ä¸ªç±»æå®šæ‰€æœ‰ç±»å‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Box</span>&lt;<span class="hljs-type">T</span>&gt;(<span class="hljs-keyword">val</span> value: T)

<span class="hljs-keyword">val</span> intBox = Box(<span class="hljs-number">42</span>)           <span class="hljs-comment">// Box&lt;Int&gt;</span>
<span class="hljs-keyword">val</span> stringBox = Box(<span class="hljs-string">"Hello"</span>)   <span class="hljs-comment">// Box&lt;String&gt;</span>
<span class="hljs-keyword">val</span> userBox = Box(User())      <span class="hljs-comment">// Box&lt;User&gt;</span>
</code></pre>
<h3 data-id="heading-3">æ³›å‹çš„ç±»å‹æ“¦é™¤</h3>
<p>Javaå’ŒKotlinéƒ½ä½¿ç”¨<strong>ç±»å‹æ“¦é™¤</strong>æ¥å®ç°æ³›å‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ç¼–è¯‘æœŸ</span>
<span class="hljs-keyword">val</span> stringList: List&lt;String&gt; = listOf(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>)
<span class="hljs-keyword">val</span> intList: List&lt;<span class="hljs-built_in">Int</span>&gt; = listOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)

<span class="hljs-comment">// è¿è¡Œæ—¶ï¼šç±»å‹å‚æ•°è¢«æ“¦é™¤</span>
<span class="hljs-comment">// stringListå’ŒintListçš„è¿è¡Œæ—¶ç±»å‹éƒ½æ˜¯Listï¼Œæ²¡æœ‰æ³›å‹å‚æ•°ä¿¡æ¯</span>
</code></pre>
<p><strong>ç±»å‹æ“¦é™¤çš„å½±å“</strong>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âŒ ä¸èƒ½åœ¨è¿è¡Œæ—¶æ£€æŸ¥æ³›å‹ç±»å‹</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">isListOf</span><span class="hljs-params">(value: <span class="hljs-type">Any</span>)</span></span>: <span class="hljs-built_in">Boolean</span> {
    <span class="hljs-keyword">return</span> value <span class="hljs-keyword">is</span> List&lt;T&gt;  <span class="hljs-comment">// âŒ ç¼–è¯‘é”™è¯¯ï¼šCannot check for instance of erased type</span>
}

<span class="hljs-comment">// âŒ ä¸èƒ½åˆ›å»ºæ³›å‹æ•°ç»„</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">createArray</span><span class="hljs-params">()</span></span>: Array&lt;T&gt; {
    <span class="hljs-keyword">return</span> Array&lt;T&gt;(<span class="hljs-number">10</span>) { }  <span class="hljs-comment">// âŒ ç¼–è¯‘é”™è¯¯</span>
}

<span class="hljs-comment">// âŒ ä¸èƒ½ä½¿ç”¨æ³›å‹ç±»å‹çš„ä¼´ç”Ÿå¯¹è±¡</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">getCompanion</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> <span class="hljs-keyword">companion</span> = T.Companion  <span class="hljs-comment">// âŒ ç¼–è¯‘é”™è¯¯</span>
}
</code></pre>
<h2 data-id="heading-4">å‹å˜ï¼ˆVarianceï¼‰ï¼šç†è§£åå˜ä¸é€†å˜</h2>
<h3 data-id="heading-5">ä¸ºä»€ä¹ˆéœ€è¦å‹å˜</h3>
<p>å…ˆçœ‹ä¸€ä¸ªé—®é¢˜ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Stringæ˜¯Anyçš„å­ç±»å‹</span>
<span class="hljs-keyword">val</span> str: String = <span class="hljs-string">"Hello"</span>
<span class="hljs-keyword">val</span> any: Any = str  <span class="hljs-comment">// âœ… å¯ä»¥èµ‹å€¼</span>

<span class="hljs-comment">// é‚£ä¹ˆList&lt;String&gt;æ˜¯List&lt;Any&gt;çš„å­ç±»å‹å—ï¼Ÿ</span>
<span class="hljs-keyword">val</span> stringList: List&lt;String&gt; = listOf(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>)
<span class="hljs-keyword">val</span> anyList: List&lt;Any&gt; = stringList  <span class="hljs-comment">// è¿™æ ·å¯ä»¥å—ï¼Ÿ</span>
</code></pre>
<p>ç­”æ¡ˆå–å†³äº<code>List</code>çš„<strong>å‹å˜</strong>è®¾ç½®ã€‚</p>
<h3 data-id="heading-6">ä¸å˜ï¼ˆInvariantï¼‰ï¼šé»˜è®¤è¡Œä¸º</h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ³›å‹ç±»å‹æ˜¯<strong>ä¸å˜çš„</strong>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// MutableListæ˜¯ä¸å˜çš„</span>
<span class="hljs-keyword">val</span> stringList: MutableList&lt;String&gt; = mutableListOf(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>)
<span class="hljs-comment">// val anyList: MutableList&lt;Any&gt; = stringList  // âŒ ç¼–è¯‘é”™è¯¯</span>

<span class="hljs-comment">// ä¸ºä»€ä¹ˆä¸èƒ½ï¼Ÿå› ä¸ºå¯èƒ½ç ´åç±»å‹å®‰å…¨ï¼š</span>
<span class="hljs-keyword">val</span> anyList: MutableList&lt;Any&gt; = stringList  <span class="hljs-comment">// å‡è®¾å…è®¸</span>
anyList.add(<span class="hljs-number">42</span>)  <span class="hljs-comment">// åŠ å…¥ä¸€ä¸ªInt</span>
<span class="hljs-keyword">val</span> first: String = stringList[<span class="hljs-number">0</span>]  <span class="hljs-comment">// ğŸ’¥ è¿è¡Œæ—¶é”™è¯¯ï¼</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a9818d1c216d4e3793ddd06a550a1f51~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769257690&amp;x-signature=V%2FmeRcHm3M7KQXncvkxueX7gnDA%3D" alt="08-01-invariance.png" loading="lazy"/></p>

**ä¸å˜æ€§ä¿è¯ç±»å‹å®‰å…¨**ï¼šå¦‚æœå…è®¸`MutableList`èµ‹å€¼ç»™`MutableList`ï¼Œå°±å¯èƒ½å‘å­—ç¬¦ä¸²åˆ—è¡¨ä¸­æ·»åŠ éå­—ç¬¦ä¸²å…ƒç´ ï¼Œç ´åç±»å‹å®‰å…¨ã€‚

<h3 data-id="heading-7">åå˜ï¼ˆCovariantï¼‰ï¼šoutå…³é”®å­—</h3>
<p><strong>åå˜</strong>æ„å‘³ç€ï¼šå¦‚æœ<code>A</code>æ˜¯<code>B</code>çš„å­ç±»å‹ï¼Œé‚£ä¹ˆ<code>Producer&lt;A&gt;</code>ä¹Ÿæ˜¯<code>Producer&lt;B&gt;</code>çš„å­ç±»å‹ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Listæ˜¯åå˜çš„ï¼ˆåªè¯»ï¼‰</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">List</span>&lt;<span class="hljs-type">out T</span>&gt; {  <span class="hljs-comment">// outè¡¨ç¤ºåå˜</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">get</span><span class="hljs-params">(index: <span class="hljs-type">Int</span>)</span></span>: T  <span class="hljs-comment">// åªèƒ½è¯»å–ï¼ˆç”Ÿäº§ï¼‰T</span>
    <span class="hljs-comment">// fun add(element: T)  // âŒ ä¸èƒ½æœ‰æ¥æ”¶Tçš„æ–¹æ³•</span>
}

<span class="hljs-comment">// ä½¿ç”¨åå˜</span>
<span class="hljs-keyword">val</span> stringList: List&lt;String&gt; = listOf(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>)
<span class="hljs-keyword">val</span> anyList: List&lt;Any&gt; = stringList  <span class="hljs-comment">// âœ… å¯ä»¥èµ‹å€¼</span>
<span class="hljs-keyword">val</span> item: Any = anyList[<span class="hljs-number">0</span>]  <span class="hljs-comment">// åªèƒ½è¯»å–ï¼Œå®‰å…¨</span>
</code></pre>
<p><strong>åå˜çš„è§„åˆ™</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨<code>out</code>å…³é”®å­—å£°æ˜</li>
<li>æ³›å‹ç±»å‹åªèƒ½å‡ºç°åœ¨<strong>è¾“å‡ºä½ç½®</strong>ï¼ˆè¿”å›å€¼ï¼‰</li>
<li>ä¸èƒ½å‡ºç°åœ¨<strong>è¾“å…¥ä½ç½®</strong>ï¼ˆå‚æ•°ï¼‰</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// åå˜ç±»å‹ç¤ºä¾‹</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Producer</span>&lt;<span class="hljs-type">out T</span>&gt; {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">produce</span><span class="hljs-params">()</span></span>: T  <span class="hljs-comment">// âœ… è¾“å‡ºä½ç½®</span>
    <span class="hljs-comment">// fun consume(item: T)  // âŒ è¾“å…¥ä½ç½®ï¼Œä¸å…è®¸</span>
}

<span class="hljs-comment">// å®é™…åº”ç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">FruitBasket</span>&lt;<span class="hljs-type">out T : Fruit</span>&gt;(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> items: List&lt;T&gt;) {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">pick</span><span class="hljs-params">()</span></span>: T = items.random()  <span class="hljs-comment">// âœ… åªç”Ÿäº§</span>
    <span class="hljs-comment">// fun add(fruit: T) { }  // âŒ ä¸èƒ½æ¶ˆè´¹</span>
}

<span class="hljs-keyword">val</span> appleBasket: FruitBasket&lt;Apple&gt; = FruitBasket(listOf(Apple()))
<span class="hljs-keyword">val</span> fruitBasket: FruitBasket&lt;Fruit&gt; = appleBasket  <span class="hljs-comment">// âœ… åå˜</span>
<span class="hljs-keyword">val</span> fruit: Fruit = fruitBasket.pick()  <span class="hljs-comment">// å®‰å…¨</span>
</code></pre>
<h3 data-id="heading-8">é€†å˜ï¼ˆContravariantï¼‰ï¼šinå…³é”®å­—</h3>
<p><strong>é€†å˜</strong>æ„å‘³ç€ï¼šå¦‚æœ<code>A</code>æ˜¯<code>B</code>çš„å­ç±»å‹ï¼Œé‚£ä¹ˆ<code>Consumer&lt;B&gt;</code>æ˜¯<code>Consumer&lt;A&gt;</code>çš„å­ç±»å‹ï¼ˆåè¿‡æ¥ï¼‰ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Comparatoræ˜¯é€†å˜çš„</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Comparator</span>&lt;<span class="hljs-type">in T</span>&gt; {  <span class="hljs-comment">// inè¡¨ç¤ºé€†å˜</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">compare</span><span class="hljs-params">(a: <span class="hljs-type">T</span>, b: <span class="hljs-type">T</span>)</span></span>: <span class="hljs-built_in">Int</span>  <span class="hljs-comment">// åªèƒ½æ¥æ”¶ï¼ˆæ¶ˆè´¹ï¼‰T</span>
}

<span class="hljs-comment">// ä½¿ç”¨é€†å˜</span>
<span class="hljs-keyword">val</span> anyComparator: Comparator&lt;Any&gt; = Comparator { a, b -&gt;
    a.hashCode() - b.hashCode()
}
<span class="hljs-keyword">val</span> stringComparator: Comparator&lt;String&gt; = anyComparator  <span class="hljs-comment">// âœ… å¯ä»¥èµ‹å€¼</span>

<span class="hljs-comment">// ä¸ºä»€ä¹ˆå¯ä»¥ï¼Ÿ</span>
<span class="hljs-comment">// èƒ½æ¯”è¾ƒAnyçš„ï¼Œå½“ç„¶ä¹Ÿèƒ½æ¯”è¾ƒStringï¼ˆStringæ˜¯Anyçš„å­ç±»å‹ï¼‰</span>
</code></pre>
<p><strong>é€†å˜çš„è§„åˆ™</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨<code>in</code>å…³é”®å­—å£°æ˜</li>
<li>æ³›å‹ç±»å‹åªèƒ½å‡ºç°åœ¨<strong>è¾“å…¥ä½ç½®</strong>ï¼ˆå‚æ•°ï¼‰</li>
<li>ä¸èƒ½å‡ºç°åœ¨<strong>è¾“å‡ºä½ç½®</strong>ï¼ˆè¿”å›å€¼ï¼‰</li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// é€†å˜ç±»å‹ç¤ºä¾‹</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Consumer</span>&lt;<span class="hljs-type">in T</span>&gt; {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">consume</span><span class="hljs-params">(item: <span class="hljs-type">T</span>)</span></span>  <span class="hljs-comment">// âœ… è¾“å…¥ä½ç½®</span>
    <span class="hljs-comment">// fun produce(): T  // âŒ è¾“å‡ºä½ç½®ï¼Œä¸å…è®¸</span>
}

<span class="hljs-comment">// å®é™…åº”ç”¨</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Sink</span>&lt;<span class="hljs-type">in T</span>&gt; {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">send</span><span class="hljs-params">(item: <span class="hljs-type">T</span>)</span></span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AnySink</span> : <span class="hljs-type">Sink</span>&lt;<span class="hljs-type">Any</span>&gt; {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">send</span><span class="hljs-params">(item: <span class="hljs-type">Any</span>)</span></span> {
        println(<span class="hljs-string">"Received: <span class="hljs-variable">$item</span>"</span>)
    }
}

<span class="hljs-keyword">val</span> anySink: Sink&lt;Any&gt; = AnySink()
<span class="hljs-keyword">val</span> stringSink: Sink&lt;String&gt; = anySink  <span class="hljs-comment">// âœ… é€†å˜</span>
stringSink.send(<span class="hljs-string">"Hello"</span>)  <span class="hljs-comment">// å®‰å…¨ï¼šAnyçš„Sinkå¯ä»¥æ¥æ”¶String</span>
</code></pre>
<h3 data-id="heading-9">å‹å˜æ€»ç»“</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb9da9d7690440c1928fe144caa30b69~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769257690&amp;x-signature=aAyWyW4sn%2B18bFPKwVeb1233X4g%3D" alt="08-02-variance-types.png" loading="lazy"/></p>

































<table><thead><tr><th align="left">å‹å˜ç±»å‹</th><th align="center">å…³é”®å­—</th><th align="left">ç±»å‹å…³ç³»</th><th align="left">ä½¿ç”¨åœºæ™¯</th><th align="left">ç¤ºä¾‹</th></tr></thead><tbody><tr><td align="left">ä¸å˜</td><td align="center">æ— </td><td align="left">æ— å­ç±»å‹å…³ç³»</td><td align="left">æ—¢è¯»åˆå†™</td><td align="left"><code>MutableList&lt;T&gt;</code></td></tr><tr><td align="left">åå˜</td><td align="center"><code>out</code></td><td align="left">ä¿æŒå­ç±»å‹å…³ç³»</td><td align="left">åªè¯»ï¼ˆç”Ÿäº§è€…ï¼‰</td><td align="left"><code>List&lt;out T&gt;</code></td></tr><tr><td align="left">é€†å˜</td><td align="center"><code>in</code></td><td align="left">åè½¬å­ç±»å‹å…³ç³»</td><td align="left">åªå†™ï¼ˆæ¶ˆè´¹è€…ï¼‰</td><td align="left"><code>Comparator&lt;in T&gt;</code></td></tr></tbody></table>

**è®°å¿†å£è¯€**ï¼š
- **out** = åª**out**putï¼ˆè¾“å‡ºï¼‰ï¼Œç”Ÿäº§è€…ï¼Œä¿æŒæ–¹å‘
- **in** = åª**in**putï¼ˆè¾“å…¥ï¼‰ï¼Œæ¶ˆè´¹è€…ï¼Œåè½¬æ–¹å‘

<h2 data-id="heading-10">ä½¿ç”¨å¤„å‹å˜ï¼ˆUse-site Varianceï¼‰</h2>
<p>æœ‰æ—¶æˆ‘ä»¬ä¸èƒ½ä¿®æ”¹ç±»çš„å£°æ˜ï¼Œä½†æƒ³åœ¨ä½¿ç”¨æ—¶æŒ‡å®šå‹å˜ï¼š</p>
<h3 data-id="heading-11">ç±»å‹æŠ•å½±</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Arrayæ˜¯ä¸å˜çš„</span>
<span class="hljs-keyword">val</span> strings: Array&lt;String&gt; = arrayOf(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>)
<span class="hljs-comment">// val objects: Array&lt;Any&gt; = strings  // âŒ ä¸å˜ï¼Œä¸èƒ½èµ‹å€¼</span>

<span class="hljs-comment">// ä½¿ç”¨outæŠ•å½±ï¼šåªèƒ½è¯»å–</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">printArray</span><span class="hljs-params">(array: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">out</span> <span class="hljs-type">Any</span>&gt;)</span></span> {  <span class="hljs-comment">// ä½¿ç”¨å¤„åå˜</span>
    <span class="hljs-keyword">for</span> (item <span class="hljs-keyword">in</span> array) {
        println(item)  <span class="hljs-comment">// âœ… å¯ä»¥è¯»å–</span>
    }
    <span class="hljs-comment">// array[0] = "X"  // âŒ ä¸èƒ½å†™å…¥</span>
}

printArray(strings)  <span class="hljs-comment">// âœ… å¯ä»¥ä¼ å…¥Array&lt;String&gt;</span>

<span class="hljs-comment">// ä½¿ç”¨inæŠ•å½±ï¼šåªèƒ½å†™å…¥</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fillArray</span><span class="hljs-params">(array: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">in</span> <span class="hljs-type">String</span>&gt;, value: <span class="hljs-type">String</span>)</span></span> {  <span class="hljs-comment">// ä½¿ç”¨å¤„é€†å˜</span>
    array[<span class="hljs-number">0</span>] = value  <span class="hljs-comment">// âœ… å¯ä»¥å†™å…¥</span>
    <span class="hljs-comment">// val item: String = array[0]  // âŒ ä¸èƒ½è¯»å–ï¼ˆè¿”å›Any?ï¼‰</span>
}

<span class="hljs-keyword">val</span> objects: Array&lt;Any&gt; = arrayOf(<span class="hljs-string">"X"</span>, <span class="hljs-string">"Y"</span>)
fillArray(objects, <span class="hljs-string">"Hello"</span>)  <span class="hljs-comment">// âœ… å¯ä»¥ä¼ å…¥Array&lt;Any&gt;</span>
</code></pre>
<h3 data-id="heading-12">æ˜ŸæŠ•å½±ï¼ˆStar Projectionï¼‰</h3>
<p>å½“ä½ ä¸å…³å¿ƒå…·ä½“ç±»å‹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ˜ŸæŠ•å½±<code>*</code>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ç­‰ä»·äºout Any?</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">printList</span><span class="hljs-params">(list: <span class="hljs-type">List</span>&lt;*&gt;)</span></span> {  <span class="hljs-comment">// List&lt;*&gt; â‰ˆ List&lt;out Any?&gt;</span>
    <span class="hljs-keyword">for</span> (item <span class="hljs-keyword">in</span> list) {
        println(item)  <span class="hljs-comment">// itemæ˜¯Any?ç±»å‹</span>
    }
}

printList(listOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>))
printList(listOf(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>))

<span class="hljs-comment">// MutableList&lt;*&gt;çš„é™åˆ¶</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">processArray</span><span class="hljs-params">(array: <span class="hljs-type">Array</span>&lt;*&gt;)</span></span> {
    <span class="hljs-keyword">val</span> item: Any? = array[<span class="hljs-number">0</span>]  <span class="hljs-comment">// âœ… å¯ä»¥è¯»å–ä¸ºAny?</span>
    <span class="hljs-comment">// array[0] = "X"  // âŒ ä¸èƒ½å†™å…¥</span>
}
</code></pre>
<p><strong>æ˜ŸæŠ•å½±çš„è§„åˆ™</strong>ï¼š</p>
<ul>
<li><code>Foo&lt;*&gt;</code> â‰ˆ <code>Foo&lt;out Any?&gt;</code>ï¼ˆå¦‚æœæ˜¯åå˜ï¼‰</li>
<li><code>Foo&lt;*&gt;</code> â‰ˆ <code>Foo&lt;in Nothing&gt;</code>ï¼ˆå¦‚æœæ˜¯é€†å˜ï¼‰</li>
<li><code>Foo&lt;*&gt;</code> = æ—¢ä¸èƒ½è¯»ä¹Ÿä¸èƒ½å†™ï¼ˆå¦‚æœæ˜¯ä¸å˜ï¼‰</li>
</ul>
<h2 data-id="heading-13">å…·ä½“åŒ–ç±»å‹å‚æ•°ï¼ˆReified Type Parametersï¼‰</h2>
<h3 data-id="heading-14">é—®é¢˜ï¼šç±»å‹æ“¦é™¤çš„é™åˆ¶</h3>
<p>ç”±äºç±»å‹æ“¦é™¤ï¼Œæˆ‘ä»¬ä¸èƒ½åœ¨è¿è¡Œæ—¶æ£€æŸ¥æ³›å‹ç±»å‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âŒ ä¸èƒ½æ£€æŸ¥æ³›å‹ç±»å‹</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">isInstance</span><span class="hljs-params">(value: <span class="hljs-type">Any</span>)</span></span>: <span class="hljs-built_in">Boolean</span> {
    <span class="hljs-keyword">return</span> value <span class="hljs-keyword">is</span> T  <span class="hljs-comment">// âŒ ç¼–è¯‘é”™è¯¯ï¼šCannot check for instance of erased type</span>
}

<span class="hljs-comment">// âŒ ä¸èƒ½è·å–æ³›å‹çš„Class</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">getClassName</span><span class="hljs-params">()</span></span>: String {
    <span class="hljs-keyword">return</span> T::<span class="hljs-keyword">class</span>.simpleName  <span class="hljs-comment">// âŒ ç¼–è¯‘é”™è¯¯</span>
}
</code></pre>
<h3 data-id="heading-15">è§£å†³æ–¹æ¡ˆï¼šreifiedå…³é”®å­—</h3>
<p>Kotlinçš„<code>reified</code>å…³é”®å­—é…åˆ<code>inline</code>å‡½æ•°ï¼Œå¯ä»¥ä¿ç•™ç±»å‹ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âœ… ä½¿ç”¨reified</span>
<span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;<span class="hljs-keyword">reified</span> T&gt;</span> <span class="hljs-title">isInstance</span><span class="hljs-params">(value: <span class="hljs-type">Any</span>)</span></span>: <span class="hljs-built_in">Boolean</span> {
    <span class="hljs-keyword">return</span> value <span class="hljs-keyword">is</span> T  <span class="hljs-comment">// âœ… å¯ä»¥æ£€æŸ¥ç±»å‹</span>
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
println(isInstance&lt;String&gt;(<span class="hljs-string">"Hello"</span>))  <span class="hljs-comment">// true</span>
println(isInstance&lt;<span class="hljs-built_in">Int</span>&gt;(<span class="hljs-string">"Hello"</span>))     <span class="hljs-comment">// false</span>

<span class="hljs-comment">// âœ… è·å–Classå¯¹è±¡</span>
<span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;<span class="hljs-keyword">reified</span> T&gt;</span> <span class="hljs-title">getClassName</span><span class="hljs-params">()</span></span>: String {
    <span class="hljs-keyword">return</span> T::<span class="hljs-keyword">class</span>.simpleName ?: <span class="hljs-string">"Unknown"</span>
}

println(getClassName&lt;String&gt;())  <span class="hljs-comment">// "String"</span>
println(getClassName&lt;List&lt;<span class="hljs-built_in">Int</span>&gt;&gt;())  <span class="hljs-comment">// "List"</span>
</code></pre>
<p><strong>å·¥ä½œåŸç†</strong>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// è°ƒç”¨ä»£ç </span>
isInstance&lt;String&gt;(<span class="hljs-string">"Hello"</span>)

<span class="hljs-comment">// ç¼–è¯‘å™¨å†…è”å</span>
<span class="hljs-string">"Hello"</span> <span class="hljs-keyword">is</span> String  <span class="hljs-comment">// ç±»å‹ä¿¡æ¯è¢«ä¿ç•™</span>
</code></pre>
<h3 data-id="heading-16">reifiedçš„å®é™…åº”ç”¨</h3>
<h4 data-id="heading-17">1. ç±»å‹å®‰å…¨çš„ç­›é€‰</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ç­›é€‰ç‰¹å®šç±»å‹çš„å…ƒç´ </span>
<span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;<span class="hljs-keyword">reified</span> T&gt;</span> List<span class="hljs-type">&lt;*&gt;</span>.<span class="hljs-title">filterIsInstance</span><span class="hljs-params">()</span></span>: List&lt;T&gt; {
    <span class="hljs-keyword">return</span> filter { it <span class="hljs-keyword">is</span> T }.map { it <span class="hljs-keyword">as</span> T }
}

<span class="hljs-keyword">val</span> mixed: List&lt;Any&gt; = listOf(<span class="hljs-number">1</span>, <span class="hljs-string">"two"</span>, <span class="hljs-number">3</span>, <span class="hljs-string">"four"</span>, <span class="hljs-number">5.0</span>)
<span class="hljs-keyword">val</span> strings: List&lt;String&gt; = mixed.filterIsInstance&lt;String&gt;()
println(strings)  <span class="hljs-comment">// [two, four]</span>

<span class="hljs-keyword">val</span> numbers: List&lt;<span class="hljs-built_in">Int</span>&gt; = mixed.filterIsInstance&lt;<span class="hljs-built_in">Int</span>&gt;()
println(numbers)  <span class="hljs-comment">// [1, 3]</span>
</code></pre>
<h4 data-id="heading-18">2. JSONååºåˆ—åŒ–</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Gsonçš„ç±»å‹å®‰å…¨åŒ…è£…</span>
<span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;<span class="hljs-keyword">reified</span> T&gt;</span> Gson.<span class="hljs-title">fromJson</span><span class="hljs-params">(json: <span class="hljs-type">String</span>)</span></span>: T {
    <span class="hljs-keyword">return</span> fromJson(json, T::<span class="hljs-keyword">class</span>.java)
}

<span class="hljs-keyword">val</span> user: User = gson.fromJson&lt;User&gt;(jsonString)  <span class="hljs-comment">// ç±»å‹å®‰å…¨</span>
<span class="hljs-comment">// è€Œä¸æ˜¯ï¼š</span>
<span class="hljs-comment">// val user = gson.fromJson(jsonString, User::class.java) as User</span>
</code></pre>
<h4 data-id="heading-19">3. å¯åŠ¨Activityï¼ˆAndroidï¼‰</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Androidä¸­çš„ç±»å‹å®‰å…¨Intent</span>
<span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;<span class="hljs-keyword">reified</span> T : Activity&gt;</span> Context.<span class="hljs-title">startActivity</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> intent = Intent(<span class="hljs-keyword">this</span>, T::<span class="hljs-keyword">class</span>.java)
    startActivity(intent)
}

<span class="hljs-comment">// ä½¿ç”¨</span>
startActivity&lt;MainActivity&gt;()  <span class="hljs-comment">// ç®€æ´ä¸”ç±»å‹å®‰å…¨</span>
</code></pre>
<h4 data-id="heading-20">4. ä¾èµ–æ³¨å…¥</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ç±»å‹å®‰å…¨çš„ä¾èµ–è·å–</span>
<span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;<span class="hljs-keyword">reified</span> T&gt;</span> <span class="hljs-title">get</span><span class="hljs-params">()</span></span>: T {
    <span class="hljs-keyword">return</span> container.resolve(T::<span class="hljs-keyword">class</span>.java)
}

<span class="hljs-keyword">val</span> userService: UserService = <span class="hljs-keyword">get</span>&lt;UserService&gt;()
</code></pre>

**reifiedçš„é™åˆ¶**ï¼š
- åªèƒ½ç”¨äº`inline`å‡½æ•°
- ä¸èƒ½ç”¨äºç±»çš„ç±»å‹å‚æ•°
- ä¸èƒ½ç”¨äºå±æ€§
- ä¼šå¢åŠ ç”Ÿæˆçš„å­—èŠ‚ç å¤§å°ï¼ˆå†…è”çš„ä»£ä»·ï¼‰

<h2 data-id="heading-21">æ³›å‹è¾¹ç•Œï¼ˆGeneric Boundsï¼‰</h2>
<h3 data-id="heading-22">ä¸Šç•Œï¼ˆUpper Boundsï¼‰</h3>
<p>é™åˆ¶ç±»å‹å‚æ•°å¿…é¡»æ˜¯æŸä¸ªç±»å‹çš„å­ç±»å‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å•ä¸ªä¸Šç•Œ</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Number&gt;</span> <span class="hljs-title">sum</span><span class="hljs-params">(a: <span class="hljs-type">T</span>, b: <span class="hljs-type">T</span>)</span></span>: <span class="hljs-built_in">Double</span> {
    <span class="hljs-keyword">return</span> a.toDouble() + b.toDouble()
}

sum(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)        <span class="hljs-comment">// âœ… Intæ˜¯Numberçš„å­ç±»å‹</span>
sum(<span class="hljs-number">1.5</span>, <span class="hljs-number">2.5</span>)    <span class="hljs-comment">// âœ… Doubleæ˜¯Numberçš„å­ç±»å‹</span>
<span class="hljs-comment">// sum("1", "2")  // âŒ Stringä¸æ˜¯Numberçš„å­ç±»å‹</span>

<span class="hljs-comment">// å®é™…åº”ç”¨ï¼šæ¯”è¾ƒ</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Comparable&lt;T&gt;</span>&gt; <span class="hljs-title">max</span><span class="hljs-params">(a: <span class="hljs-type">T</span>, b: <span class="hljs-type">T</span>)</span></span>: T {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> (a &gt; b) a <span class="hljs-keyword">else</span> b
}

println(max(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>))        <span class="hljs-comment">// 20</span>
println(max(<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>))  <span class="hljs-comment">// banana</span>
</code></pre>
<h3 data-id="heading-23">å¤šä¸ªä¸Šç•Œ</h3>
<p>æœ‰æ—¶éœ€è¦åŒæ—¶æ»¡è¶³å¤šä¸ªçº¦æŸï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// whereå­å¥æŒ‡å®šå¤šä¸ªä¸Šç•Œ</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">copyWhenGreater</span><span class="hljs-params">(list: <span class="hljs-type">List</span>&lt;<span class="hljs-type">T</span>&gt;, threshold: <span class="hljs-type">T</span>)</span></span>: List&lt;T&gt;
    <span class="hljs-keyword">where</span> T : Comparable&lt;T&gt;,  <span class="hljs-comment">// å¿…é¡»å¯æ¯”è¾ƒ</span>
          T : Cloneable {      <span class="hljs-comment">// å¿…é¡»å¯å…‹éš†</span>
    <span class="hljs-keyword">return</span> list.filter { it &gt; threshold }.map { it.clone() <span class="hljs-keyword">as</span> T }
}

<span class="hljs-comment">// å®é™…åº”ç”¨</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Named</span> {
    <span class="hljs-keyword">val</span> name: String
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Identifiable</span> {
    <span class="hljs-keyword">val</span> id: String
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">findById</span><span class="hljs-params">(items: <span class="hljs-type">List</span>&lt;<span class="hljs-type">T</span>&gt;, id: <span class="hljs-type">String</span>)</span></span>: T?
    <span class="hljs-keyword">where</span> T : Named,
          T : Identifiable {
    <span class="hljs-keyword">return</span> items.find { it.id == id }
}

<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>(
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> id: String,
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> name: String
) : Named, Identifiable

<span class="hljs-keyword">val</span> users = listOf(User(<span class="hljs-string">"1"</span>, <span class="hljs-string">"Alice"</span>), User(<span class="hljs-string">"2"</span>, <span class="hljs-string">"Bob"</span>))
<span class="hljs-keyword">val</span> user = findById(users, <span class="hljs-string">"1"</span>)
println(user?.name)  <span class="hljs-comment">// Alice</span>
</code></pre>
<h3 data-id="heading-24">é€’å½’æ³›å‹è¾¹ç•Œ</h3>
<p>ç»å…¸çš„<code>Comparable</code>æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// è‡ªå¼•ç”¨æ³›å‹è¾¹ç•Œ</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Comparable</span>&lt;<span class="hljs-type">T : Comparable&lt;T</span>&gt;&gt; {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">compareTo</span><span class="hljs-params">(other: <span class="hljs-type">T</span>)</span></span>: <span class="hljs-built_in">Int</span>
}

<span class="hljs-comment">// å®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>(<span class="hljs-keyword">val</span> name: String, <span class="hljs-keyword">val</span> age: <span class="hljs-built_in">Int</span>) : Comparable&lt;Person&gt; {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">compareTo</span><span class="hljs-params">(other: <span class="hljs-type">Person</span>)</span></span>: <span class="hljs-built_in">Int</span> {
        <span class="hljs-keyword">return</span> age.compareTo(other.age)
    }
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Comparable&lt;T&gt;</span>&gt; <span class="hljs-title">sortItems</span><span class="hljs-params">(items: <span class="hljs-type">List</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: List&lt;T&gt; {
    <span class="hljs-keyword">return</span> items.sorted()
}

<span class="hljs-keyword">val</span> people = listOf(Person(<span class="hljs-string">"Alice"</span>, <span class="hljs-number">30</span>), Person(<span class="hljs-string">"Bob"</span>, <span class="hljs-number">25</span>))
<span class="hljs-keyword">val</span> sorted = sortItems(people)  <span class="hljs-comment">// æŒ‰å¹´é¾„æ’åº</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/034e0fdba7a944f8b4402cd23195e21d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769257690&amp;x-signature=FkHDoPaVqr7Z2r12HXWlDeUuAtI%3D" alt="08-03-generic-bounds.png" loading="lazy"/></p>
<h2 data-id="heading-25">å®æˆ˜æ¡ˆä¾‹ï¼šæ„å»ºç±»å‹å®‰å…¨çš„Resultå®¹å™¨</h2>
<p>ç»¼åˆè¿ç”¨æ³›å‹çš„é«˜çº§ç‰¹æ€§ï¼Œæ„å»ºä¸€ä¸ªå®Œæ•´çš„Resultç±»å‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// 1. åŸºç¡€å®šä¹‰ï¼šä½¿ç”¨outåå˜</span>
<span class="hljs-keyword">sealed</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Result</span>&lt;<span class="hljs-type">out T</span>&gt; {
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Success</span>&lt;<span class="hljs-type">T</span>&gt;(<span class="hljs-keyword">val</span> <span class="hljs-keyword">data</span>: T) : Result&lt;T&gt;()
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Error</span>(<span class="hljs-keyword">val</span> exception: Exception) : Result&lt;<span class="hljs-built_in">Nothing</span>&gt;()
    <span class="hljs-keyword">object</span> Loading : Result&lt;<span class="hljs-built_in">Nothing</span>&gt;()
}

<span class="hljs-comment">// 2. æ‰©å±•å‡½æ•°ï¼šä½¿ç”¨reified</span>
<span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;<span class="hljs-keyword">reified</span> T&gt;</span> Result<span class="hljs-type">&lt;*&gt;</span>.<span class="hljs-title">getOrNull</span><span class="hljs-params">()</span></span>: T? {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">when</span> (<span class="hljs-keyword">this</span>) {
        <span class="hljs-keyword">is</span> Result.Success&lt;*&gt; -&gt; <span class="hljs-keyword">data</span> <span class="hljs-keyword">as</span>? T
        <span class="hljs-keyword">else</span> -&gt; <span class="hljs-literal">null</span>
    }
}

<span class="hljs-comment">// 3. mapå‡½æ•°ï¼šåå˜ä¿è¯ç±»å‹å®‰å…¨</span>
<span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T, R&gt;</span> Result<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">map</span><span class="hljs-params">(transform: (<span class="hljs-type">T</span>) -&gt; <span class="hljs-type">R</span>)</span></span>: Result&lt;R&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">when</span> (<span class="hljs-keyword">this</span>) {
        <span class="hljs-keyword">is</span> Result.Success -&gt; Result.Success(transform(<span class="hljs-keyword">data</span>))
        <span class="hljs-keyword">is</span> Result.Error -&gt; Result.Error(exception)
        <span class="hljs-keyword">is</span> Result.Loading -&gt; Result.Loading
    }
}

<span class="hljs-comment">// 4. flatMapï¼šå¤„ç†åµŒå¥—Result</span>
<span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T, R&gt;</span> Result<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">flatMap</span><span class="hljs-params">(transform: (<span class="hljs-type">T</span>) -&gt; <span class="hljs-type">Result</span>&lt;<span class="hljs-type">R</span>&gt;)</span></span>: Result&lt;R&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">when</span> (<span class="hljs-keyword">this</span>) {
        <span class="hljs-keyword">is</span> Result.Success -&gt; transform(<span class="hljs-keyword">data</span>)
        <span class="hljs-keyword">is</span> Result.Error -&gt; Result.Error(exception)
        <span class="hljs-keyword">is</span> Result.Loading -&gt; Result.Loading
    }
}

<span class="hljs-comment">// 5. å¸¦è¾¹ç•Œçš„è½¬æ¢</span>
<span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Any, R : Any&gt;</span> Result<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">mapNotNull</span><span class="hljs-params">(
    transform: (<span class="hljs-type">T</span>) -&gt; <span class="hljs-type">R</span>?
)</span></span>: Result&lt;R&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">when</span> (<span class="hljs-keyword">this</span>) {
        <span class="hljs-keyword">is</span> Result.Success -&gt; {
            <span class="hljs-keyword">val</span> transformed = transform(<span class="hljs-keyword">data</span>)
            <span class="hljs-keyword">if</span> (transformed != <span class="hljs-literal">null</span>) {
                Result.Success(transformed)
            } <span class="hljs-keyword">else</span> {
                Result.Error(NullPointerException(<span class="hljs-string">"Transform returned null"</span>))
            }
        }
        <span class="hljs-keyword">is</span> Result.Error -&gt; Result.Error(exception)
        <span class="hljs-keyword">is</span> Result.Loading -&gt; Result.Loading
    }
}

<span class="hljs-comment">// 6. åˆå¹¶å¤šä¸ªResult</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">combineResults</span><span class="hljs-params">(results: <span class="hljs-type">List</span>&lt;<span class="hljs-type">Result</span>&lt;<span class="hljs-type">T</span>&gt;&gt;)</span></span>: Result&lt;List&lt;T&gt;&gt; {
    <span class="hljs-keyword">val</span> <span class="hljs-keyword">data</span> = mutableListOf&lt;T&gt;()

    <span class="hljs-keyword">for</span> (result <span class="hljs-keyword">in</span> results) {
        <span class="hljs-keyword">when</span> (result) {
            <span class="hljs-keyword">is</span> Result.Success -&gt; <span class="hljs-keyword">data</span>.add(result.<span class="hljs-keyword">data</span>)
            <span class="hljs-keyword">is</span> Result.Error -&gt; <span class="hljs-keyword">return</span> result
            <span class="hljs-keyword">is</span> Result.Loading -&gt; <span class="hljs-keyword">return</span> Result.Loading
        }
    }

    <span class="hljs-keyword">return</span> Result.Success(<span class="hljs-keyword">data</span>)
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserRepository</span> {
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadUser</span><span class="hljs-params">(id: <span class="hljs-type">String</span>)</span></span>: Result&lt;User&gt; {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">val</span> user = apiService.getUser(id)
            Result.Success(user)
        } <span class="hljs-keyword">catch</span> (e: Exception) {
            Result.Error(e)
        }
    }

    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadUserProfile</span><span class="hljs-params">(id: <span class="hljs-type">String</span>)</span></span>: Result&lt;UserProfile&gt; {
        <span class="hljs-keyword">return</span> loadUser(id)
            .map { user -&gt; user.toProfile() }  <span class="hljs-comment">// ç±»å‹å®‰å…¨è½¬æ¢</span>
            .flatMap { profile -&gt;  <span class="hljs-comment">// å¤„ç†åµŒå¥—å¼‚æ­¥æ“ä½œ</span>
                loadAdditionalData(profile.id).map { <span class="hljs-keyword">data</span> -&gt;
                    profile.copy(additionalInfo = <span class="hljs-keyword">data</span>)
                }
            }
    }
}

<span class="hljs-comment">// ViewModelä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> repository = UserRepository()

    <span class="hljs-keyword">val</span> userState = MutableStateFlow&lt;Result&lt;UserProfile&gt;&gt;(Result.Loading)

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadUserProfile</span><span class="hljs-params">(userId: <span class="hljs-type">String</span>)</span></span> {
        viewModelScope.launch {
            <span class="hljs-keyword">val</span> result = repository.loadUserProfile(userId)

            <span class="hljs-comment">// ä½¿ç”¨reifiedæ‰©å±•</span>
            <span class="hljs-keyword">val</span> profile: UserProfile? = result.getOrNull&lt;UserProfile&gt;()

            userState.value = result
        }
    }
}
</code></pre>
<p><strong>è¿™ä¸ªæ¡ˆä¾‹å±•ç¤ºäº†</strong>ï¼š</p>
<ul>
<li>âœ… <code>out</code>åå˜ä¿è¯ç±»å‹å®‰å…¨çš„è½¬æ¢</li>
<li>âœ… <code>reified</code>å®ç°ç±»å‹å®‰å…¨çš„å€¼è·å–</li>
<li>âœ… æ³›å‹å‡½æ•°å®ç°çµæ´»çš„æ“ä½œç¬¦</li>
<li>âœ… å¯†å°ç±»ç»“åˆæ³›å‹çš„å¼ºå¤§è¡¨è¾¾èƒ½åŠ›</li>
</ul>
<h2 data-id="heading-26">å¸¸è§é—®é¢˜è§£ç­”</h2>
<h3 data-id="heading-27">Q1: ä»€ä¹ˆæ—¶å€™ä½¿ç”¨outï¼Œä»€ä¹ˆæ—¶å€™ä½¿ç”¨inï¼Ÿ</h3>
<p><strong>A</strong>: éµå¾ª<strong>PECSåŸåˆ™</strong>ï¼ˆProducer Extends, Consumer Superï¼‰ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Producerï¼ˆç”Ÿäº§è€…ï¼‰ä½¿ç”¨out</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Producer</span>&lt;<span class="hljs-type">out T</span>&gt; {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">produce</span><span class="hljs-params">()</span></span>: T  <span class="hljs-comment">// åªç”Ÿäº§T</span>
}

<span class="hljs-comment">// Consumerï¼ˆæ¶ˆè´¹è€…ï¼‰ä½¿ç”¨in</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Consumer</span>&lt;<span class="hljs-type">in T</span>&gt; {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">consume</span><span class="hljs-params">(item: <span class="hljs-type">T</span>)</span></span>  <span class="hljs-comment">// åªæ¶ˆè´¹T</span>
}

<span class="hljs-comment">// å®é™…åº”ç”¨</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">copy</span><span class="hljs-params">(from: <span class="hljs-type">List</span>&lt;<span class="hljs-type">out</span> <span class="hljs-type">Any</span>&gt;, to: <span class="hljs-type">MutableList</span>&lt;<span class="hljs-type">in</span> <span class="hljs-type">String</span>&gt;)</span></span> {
    <span class="hljs-comment">// fromæ˜¯ç”Ÿäº§è€…ï¼Œåªè¯»å–</span>
    <span class="hljs-comment">// toæ˜¯æ¶ˆè´¹è€…ï¼Œåªå†™å…¥</span>
    <span class="hljs-keyword">for</span> (item <span class="hljs-keyword">in</span> from) {
        <span class="hljs-keyword">if</span> (item <span class="hljs-keyword">is</span> String) {
            to.add(item)
        }
    }
}
</code></pre>
<h3 data-id="heading-28">Q2: reifiedä¸€å®šè¦é…åˆinlineä½¿ç”¨å—ï¼Ÿ</h3>
<p><strong>A</strong>: æ˜¯çš„ï¼Œ<code>reified</code>å¿…é¡»ç”¨äº<code>inline</code>å‡½æ•°ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âœ… æ­£ç¡®ï¼šinline + reified</span>
<span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;<span class="hljs-keyword">reified</span> T&gt;</span> <span class="hljs-title">check</span><span class="hljs-params">(value: <span class="hljs-type">Any</span>)</span></span>: <span class="hljs-built_in">Boolean</span> {
    <span class="hljs-keyword">return</span> value <span class="hljs-keyword">is</span> T
}

<span class="hljs-comment">// âŒ é”™è¯¯ï¼šä¸èƒ½å•ç‹¬ä½¿ç”¨reified</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;<span class="hljs-keyword">reified</span> T&gt;</span> <span class="hljs-title">check</span><span class="hljs-params">(value: <span class="hljs-type">Any</span>)</span></span>: <span class="hljs-built_in">Boolean</span> {  <span class="hljs-comment">// ç¼–è¯‘é”™è¯¯</span>
    <span class="hljs-keyword">return</span> value <span class="hljs-keyword">is</span> T
}

<span class="hljs-comment">// åŸå› ï¼šåªæœ‰å†…è”å‡½æ•°æ‰èƒ½åœ¨ç¼–è¯‘æ—¶æ›¿æ¢ç±»å‹å‚æ•°</span>
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆ</strong>ï¼š</p>
<ul>
<li><code>inline</code>å‡½æ•°åœ¨ç¼–è¯‘æ—¶ä¼šè¢«å±•å¼€åˆ°è°ƒç”¨å¤„</li>
<li>ç¼–è¯‘å™¨å¯ä»¥åœ¨å±•å¼€æ—¶æ›¿æ¢ç±»å‹å‚æ•°ä¸ºå…·ä½“ç±»å‹</li>
<li>éå†…è”å‡½æ•°åœ¨è¿è¡Œæ—¶è°ƒç”¨ï¼Œç±»å‹ä¿¡æ¯å·²è¢«æ“¦é™¤</li>
</ul>
<h3 data-id="heading-29">Q3: æ˜ŸæŠ•å½±ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ï¼Ÿ</h3>
<p><strong>A</strong>: å½“ä½ ä¸å…³å¿ƒå…·ä½“ç±»å‹ï¼Œåªéœ€è¦è®¿é—®ä¸ç±»å‹æ— å…³çš„æˆå‘˜æ—¶ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// åœºæ™¯1ï¼šåªéœ€è¦çŸ¥é“æ˜¯ä¸ªListï¼Œä¸å…³å¿ƒå…ƒç´ ç±»å‹</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">printSize</span><span class="hljs-params">(list: <span class="hljs-type">List</span>&lt;*&gt;)</span></span> {
    println(<span class="hljs-string">"Size: <span class="hljs-subst">${list.size}</span>"</span>)  <span class="hljs-comment">// sizeä¸ç±»å‹æ— å…³</span>
}

<span class="hljs-comment">// åœºæ™¯2ï¼šç±»å‹ä¸ç¡®å®šä½†éœ€è¦å¤„ç†</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">processUnknown</span><span class="hljs-params">(value: <span class="hljs-type">Any</span>)</span></span> {
    <span class="hljs-keyword">when</span> (value) {
        <span class="hljs-keyword">is</span> List&lt;*&gt; -&gt; println(<span class="hljs-string">"List of <span class="hljs-subst">${value.size}</span> items"</span>)
        <span class="hljs-keyword">is</span> Map&lt;*, *&gt; -&gt; println(<span class="hljs-string">"Map of <span class="hljs-subst">${value.size}</span> entries"</span>)
    }
}

<span class="hljs-comment">// âŒ ä¸è¦è¿™æ ·ï¼šæ˜ç¡®çŸ¥é“ç±»å‹æ—¶ä¸è¦ç”¨æ˜ŸæŠ•å½±</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">printStrings</span><span class="hljs-params">(list: <span class="hljs-type">List</span>&lt;*&gt;)</span></span> {  <span class="hljs-comment">// ä¸å¥½</span>
    <span class="hljs-keyword">for</span> (item <span class="hljs-keyword">in</span> list) {
        println(item <span class="hljs-keyword">as</span> String)  <span class="hljs-comment">// éœ€è¦å¼ºåˆ¶è½¬æ¢</span>
    }
}

<span class="hljs-comment">// âœ… åº”è¯¥è¿™æ ·ï¼šæ˜ç¡®ç±»å‹</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">printStrings</span><span class="hljs-params">(list: <span class="hljs-type">List</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> {  <span class="hljs-comment">// å¥½</span>
    <span class="hljs-keyword">for</span> (item <span class="hljs-keyword">in</span> list) {
        println(item)  <span class="hljs-comment">// ç±»å‹å®‰å…¨</span>
    }
}
</code></pre>
<h3 data-id="heading-30">Q4: ä¸ºä»€ä¹ˆArrayæ˜¯ä¸å˜çš„ï¼Œè€ŒListå¯ä»¥åå˜ï¼Ÿ</h3>
<p><strong>A</strong>: å› ä¸º<strong>å¯å˜æ€§</strong>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Arrayæ˜¯å¯å˜çš„ï¼ˆå¯è¯»å¯å†™ï¼‰</span>
<span class="hljs-keyword">val</span> array: Array&lt;String&gt; = arrayOf(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>)
array[<span class="hljs-number">0</span>] = <span class="hljs-string">"X"</span>  <span class="hljs-comment">// å¯ä»¥ä¿®æ”¹</span>

<span class="hljs-comment">// å¦‚æœå…è®¸åå˜ï¼Œä¼šç ´åç±»å‹å®‰å…¨ï¼š</span>
<span class="hljs-comment">// val objects: Array&lt;Any&gt; = array  // å‡è®¾å…è®¸</span>
<span class="hljs-comment">// objects[0] = 42  // åŠ å…¥Int</span>
<span class="hljs-comment">// val str: String = array[0]  // ğŸ’¥ è¿è¡Œæ—¶é”™è¯¯</span>

<span class="hljs-comment">// Listæ˜¯åªè¯»çš„ï¼ˆåå˜å®‰å…¨ï¼‰</span>
<span class="hljs-keyword">val</span> list: List&lt;String&gt; = listOf(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>)
<span class="hljs-comment">// list[0] = "X"  // âŒ ä¸èƒ½ä¿®æ”¹</span>
<span class="hljs-keyword">val</span> objects: List&lt;Any&gt; = list  <span class="hljs-comment">// âœ… å®‰å…¨ï¼Œå› ä¸ºä¸èƒ½ä¿®æ”¹</span>
</code></pre>
<p><strong>è§„åˆ™</strong>ï¼š</p>
<ul>
<li><strong>åªè¯»é›†åˆ</strong>ï¼ˆ<code>List</code>, <code>Set</code>, <code>Map</code>ï¼‰å¯ä»¥åå˜</li>
<li><strong>å¯å˜é›†åˆ</strong>ï¼ˆ<code>MutableList</code>, <code>MutableSet</code>, <code>MutableMap</code>ï¼‰å¿…é¡»ä¸å˜</li>
</ul>
<h2 data-id="heading-31">ç»ƒä¹ é¢˜</h2>
<h3 data-id="heading-32">ç»ƒä¹ 1ï¼šå®ç°æ³›å‹æ ˆ</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å®ç°ä¸€ä¸ªç±»å‹å®‰å…¨çš„æ ˆ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Stack</span>&lt;<span class="hljs-type">T</span>&gt; {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> items = mutableListOf&lt;T&gt;()

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">push</span><span class="hljs-params">(item: <span class="hljs-type">T</span>)</span></span> { <span class="hljs-comment">/* TODO */</span> }
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">pop</span><span class="hljs-params">()</span></span>: T? { <span class="hljs-comment">/* TODO */</span> }
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">peek</span><span class="hljs-params">()</span></span>: T? { <span class="hljs-comment">/* TODO */</span> }
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isEmpty</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> { <span class="hljs-comment">/* TODO */</span> }
}

<span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> æ·»åŠ åå˜çš„åªè¯»è§†å›¾</span>
<span class="hljs-comment">// interface ReadOnlyStack&lt;out T&gt; { ... }</span>
</code></pre>
<h3 data-id="heading-33">ç»ƒä¹ 2ï¼šå¸¦è¾¹ç•Œçš„æŸ¥æ‰¾å‡½æ•°</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å®ç°ä¸€ä¸ªé€šç”¨çš„æŸ¥æ‰¾å‡½æ•°ï¼Œè¦æ±‚ï¼š</span>
<span class="hljs-comment">// 1. Tå¿…é¡»å®ç°Comparableæ¥å£</span>
<span class="hljs-comment">// 2. Tå¿…é¡»æœ‰nameå±æ€§</span>
<span class="hljs-comment">// 3. æŸ¥æ‰¾nameåŒ¹é…ä¸”å€¼å¤§äºthresholdçš„ç¬¬ä¸€ä¸ªå…ƒç´ </span>

<span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> å®ç°å‡½æ•°ç­¾åå’Œå‡½æ•°ä½“</span>
</code></pre>
<h3 data-id="heading-34">ç»ƒä¹ 3ï¼šä½¿ç”¨reifiedç®€åŒ–ååºåˆ—åŒ–</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ä½¿ç”¨reifiedå®ç°ç±»å‹å®‰å…¨çš„JSONååºåˆ—åŒ–</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">JsonParser</span> {
    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> å®ç°inline + reifiedå‡½æ•°</span>
    <span class="hljs-comment">// inline fun &lt;reified T&gt; parse(json: String): T { ... }</span>
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>(<span class="hljs-keyword">val</span> name: String, <span class="hljs-keyword">val</span> age: <span class="hljs-built_in">Int</span>)
<span class="hljs-keyword">val</span> json = <span class="hljs-string">"""{"name": "Alice", "age": 30}"""</span>
<span class="hljs-keyword">val</span> user: User = parser.parse&lt;User&gt;(json)  <span class="hljs-comment">// åº”è¯¥è‡ªåŠ¨æ¨æ–­ç±»å‹</span>
</code></pre>
<h2 data-id="heading-35">æ€»ç»“</h2>
<p>Kotlinçš„æ³›å‹ç³»ç»Ÿåœ¨Javaçš„åŸºç¡€ä¸Šåšäº†é‡è¦æ”¹è¿›ï¼Œæä¾›äº†æ›´å¼ºå¤§å’Œçµæ´»çš„ç±»å‹å®‰å…¨ä¿éšœã€‚</p>
<h3 data-id="heading-36">æ ¸å¿ƒè¦ç‚¹å›é¡¾</h3>
<ol>
<li>
<p><strong>å‹å˜ï¼ˆVarianceï¼‰</strong></p>
<ul>
<li><strong>outï¼ˆåå˜ï¼‰</strong> - ç”Ÿäº§è€…ï¼Œä¿æŒå­ç±»å‹å…³ç³»ï¼Œåªèƒ½è¾“å‡º</li>
<li><strong>inï¼ˆé€†å˜ï¼‰</strong> - æ¶ˆè´¹è€…ï¼Œåè½¬å­ç±»å‹å…³ç³»ï¼Œåªèƒ½è¾“å…¥</li>
<li><strong>ä¸å˜</strong> - é»˜è®¤è¡Œä¸ºï¼Œæ—¢å¯è¯»åˆå¯å†™ï¼Œæ— å­ç±»å‹å…³ç³»</li>
</ul>
</li>
<li>
<p><strong>ä½¿ç”¨å¤„å‹å˜</strong></p>
<ul>
<li>ç±»å‹æŠ•å½±ï¼š<code>Array&lt;out Any&gt;</code>, <code>Array&lt;in String&gt;</code></li>
<li>æ˜ŸæŠ•å½±ï¼š<code>List&lt;*&gt;</code> â‰ˆ <code>List&lt;out Any?&gt;</code></li>
</ul>
</li>
<li>
<p><strong>å…·ä½“åŒ–ç±»å‹å‚æ•°ï¼ˆreifiedï¼‰</strong></p>
<ul>
<li>é…åˆ<code>inline</code>å‡½æ•°ä½¿ç”¨</li>
<li>ä¿ç•™è¿è¡Œæ—¶ç±»å‹ä¿¡æ¯</li>
<li>å®ç°ç±»å‹å®‰å…¨çš„ç±»å‹æ£€æŸ¥å’Œè½¬æ¢</li>
</ul>
</li>
<li>
<p><strong>æ³›å‹è¾¹ç•Œ</strong></p>
<ul>
<li>å•ä¸ªä¸Šç•Œï¼š<code>&lt;T : Number&gt;</code></li>
<li>å¤šä¸ªä¸Šç•Œï¼š<code>where T : A, T : B</code></li>
<li>é€’å½’è¾¹ç•Œï¼š<code>&lt;T : Comparable&lt;T&gt;&gt;</code></li>
</ul>
</li>
</ol>
<h3 data-id="heading-37">æœ€ä½³å®è·µ</h3>
<ul>
<li>âœ… <strong>éµå¾ªPECSåŸåˆ™</strong>ï¼šProducerç”¨outï¼ŒConsumerç”¨in</li>
<li>âœ… <strong>ä¼˜å…ˆä½¿ç”¨å£°æ˜å¤„å‹å˜</strong>ï¼šåœ¨ç±»å®šä¹‰æ—¶å°±æŒ‡å®šout/in</li>
<li>âœ… <strong>è°¨æ…ä½¿ç”¨reified</strong>ï¼šåªåœ¨ç¡®å®éœ€è¦è¿è¡Œæ—¶ç±»å‹ä¿¡æ¯æ—¶ä½¿ç”¨</li>
<li>âœ… <strong>æ˜ç¡®æ³›å‹è¾¹ç•Œ</strong>ï¼šä½¿ç”¨ä¸Šç•Œçº¦æŸç±»å‹ï¼Œæé«˜ä»£ç å¯è¯»æ€§</li>
<li>âœ… <strong>é¿å…è¿‡åº¦æ³›å‹</strong>ï¼šä¸æ˜¯æ‰€æœ‰ä»£ç éƒ½éœ€è¦æ³›å‹åŒ–</li>
<li>âœ… <strong>åˆ©ç”¨æ ‡å‡†åº“</strong>ï¼šKotlinæ ‡å‡†åº“æä¾›äº†ä¸°å¯Œçš„æ³›å‹å·¥å…·å‡½æ•°</li>
</ul>
<h3 data-id="heading-38">æ³›å‹çš„è®¾è®¡å“²å­¦</h3>
<p>Kotlinæ³›å‹ä½“ç°äº†ä¸‰ä¸ªæ ¸å¿ƒç†å¿µï¼š</p>
<ol>
<li><strong>ç±»å‹å®‰å…¨ä¼˜å…ˆ</strong> - åœ¨ç¼–è¯‘æœŸå°½å¯èƒ½æ•è·ç±»å‹é”™è¯¯</li>
<li><strong>çµæ´»æ€§ä¸å®‰å…¨æ€§å¹³è¡¡</strong> - é€šè¿‡å‹å˜æä¾›çµæ´»æ€§ï¼ŒåŒæ—¶ä¿è¯å®‰å…¨</li>
<li><strong>å®ç”¨ä¸»ä¹‰</strong> - reifiedç­‰ç‰¹æ€§è§£å†³å®é™…é—®é¢˜ï¼Œè€Œä¸æ‹˜æ³¥äºç†è®ºçº¯ç²¹</li>
</ol>
<p>æ­£å¦‚æ–‡ç« å¼€å¤´çš„æ•…äº‹ï¼Œç†è§£æ³›å‹çš„è¿™äº›é«˜çº§ç‰¹æ€§ï¼Œä¸ä»…èƒ½è®©æˆ‘ä»¬å†™å‡ºæ›´å®‰å…¨ã€æ›´çµæ´»çš„ä»£ç ï¼Œæ›´é‡è¦çš„æ˜¯èƒ½å¸®åŠ©æˆ‘ä»¬ç†è§£Kotlinç±»å‹ç³»ç»Ÿçš„è®¾è®¡å“²å­¦ã€‚</p>
<hr/>
<h2 data-id="heading-39">ç›¸å…³èµ„æ–™</h2>
<p><strong>ç³»åˆ—æ–‡ç« å¯¼èˆª:</strong></p>
<ul>
<li>ğŸ‘‰ ä¸Šä¸€ç¯‡: <a href="https://juejin.cn/post/7595841630675763251" target="_blank" title="https://juejin.cn/post/7595841630675763251">ç±»å‹ç³»ç»Ÿæ·±åº¦è§£æï¼šä»ç©ºå®‰å…¨åˆ°æ™ºèƒ½ç±»å‹æ¨æ–­çš„è®¾è®¡å“²å­¦</a></li>
</ul>
<hr/>
<p><em>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©,æ¬¢è¿ç‚¹èµã€æ”¶è—ã€åˆ†äº«!æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®,æ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€è®¨è®ºã€‚è®©æˆ‘ä»¬ä¸€èµ·å­¦ä¹ ,ä¸€èµ·æˆé•¿!</em></p>
<p><em>ä¹Ÿæ¬¢è¿è®¿é—®æˆ‘çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fhome.wonlab.top" target="_blank" title="https://home.wonlab.top" ref="nofollow noopener noreferrer">ä¸ªäººä¸»é¡µ</a>å‘ç°æ›´å¤šå®è—èµ„æº</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç»§å¾€å¼€æ¥â€”â€”å¦‚ä½•åœ¨å·¥ç¨‹å®è·µåº”ç”¨ AI ä¸ Agent]]></title>    <link>https://juejin.cn/post/7595994039108845604</link>    <guid>https://juejin.cn/post/7595994039108845604</guid>    <pubDate>2026-01-17T13:25:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595994039108845604" data-draft-id="7595974133096775714" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç»§å¾€å¼€æ¥â€”â€”å¦‚ä½•åœ¨å·¥ç¨‹å®è·µåº”ç”¨ AI ä¸ Agent"/> <meta itemprop="keywords" content="æ¶æ„,OpenAI,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-17T13:25:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äººå½¢æ‰“ç æœº"/> <meta itemprop="url" content="https://juejin.cn/user/2085122730895063"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç»§å¾€å¼€æ¥â€”â€”å¦‚ä½•åœ¨å·¥ç¨‹å®è·µåº”ç”¨ AI ä¸ Agent
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2085122730895063/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äººå½¢æ‰“ç æœº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T13:25:00.000Z" title="Sat Jan 17 2026 13:25:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€AI å¸¦æ¥çš„å˜åŒ–</h2>
<p>è¿™ä¸€å¹´ç”¨ AI å†™ä»£ç ï¼Œè¯´å®è¯å¹¶ä¸æ˜¯ä¸€å¼€å§‹å°±è¿™ä¹ˆé¡ºçš„ï¼Œæœ€æ—©æ¥è§¦çš„æ—¶å€™å¯¹å®ƒçš„æœŸå¾…ä¹Ÿä¸é«˜ï¼›</p>
<blockquote>
<p>æ›´å¤šåªæ˜¯æŠŠå®ƒå½“æˆä¸€ä¸ª<strong>æ¯”æœç´¢å¼•æ“ååº”å¿«ä¸€ç‚¹çš„å·¥å…·</strong></p>
</blockquote>
<h3 data-id="heading-1">åšä¸€ä¸ªæ¥å£</h3>
<p>æœ€å¼€å§‹çš„åº”ç”¨åŸºæœ¬æ˜¯åœ¨ç½‘é¡µæˆ–è€…æ¡Œé¢å¯¹è¯æ¡†é‡Œè¿›è¡Œå·¥ä½œï¼Œåšçš„äº‹æƒ…åŸºæœ¬å›´ç»•ï¼š</p>
<ul>
<li>ç»™å®šå­—æ®µç”Ÿæˆ model</li>
<li>ç”Ÿæˆä¸€ä¸ªæ–¹æ³•é€»è¾‘</li>
<li>å®Œæˆå®˜æ–¹åº“ä¸€äº› API æ£€ç´¢</li>
</ul>
<p>å› ä¸ºæ˜¯é€šè¿‡å¤–éƒ¨å·¥å…·å®Œæˆç”Ÿæˆç„¶åç²˜è´´åˆ°å·¥ç¨‹ï¼Œå› æ­¤è¿™ç§æ”¹åŠ¨èŒƒå›´å¾ˆå°ï¼Œå°±ç®—ç”Ÿæˆå­˜åœ¨é—®é¢˜ä¹Ÿèƒ½äººå·¥è¯†åˆ«è¿›è¡Œä¿®æ­£ï¼›</p>
<blockquote>
<p>æ‰€ä»¥å½“å‰é˜¶æ®µæœ¬è´¨ä¸Šè¿˜æ˜¯äººä¸ºä¸»å¯¼ï¼ŒAI åªæ˜¯å®Œæˆä¸€äº›çç¢å·¥ä½œ</p>
</blockquote>
<p>ä½†é—®é¢˜ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œ æ•´ä½“å¾ˆè€ƒç©¶æè¯å¹¶ä¸”æœ‰æ—¶ä¸Šä¸‹æ–‡æ²Ÿé€šæ²¡æœ‰å…³è”æ€§è¾“å‡ºä¿¡æ¯å¾ˆé›¶ç¢</p>
<p>å¤§éƒ¨åˆ†æ—¶é—´éœ€è¦åå¤æé†’ä¸Šä¸‹æ–‡ï¼Œæ‰èƒ½æŠŠä¸€ä»¶å°äº‹åšå®Œ</p>
<h3 data-id="heading-2">ç»“æ„è®¾è®¡</h3>
<p>çœŸæ­£è®©æˆ‘æ„Ÿè§‰ä¸ä¸€æ ·ï¼Œæ˜¯åæ¥æŠŠ <strong>Trae å’Œ ChatGPT agent</strong> ç»“åˆä½¿ç”¨ï¼›</p>
<p>AI ä¸å†åªæ˜¯è¡¥ä»£ç ï¼Œè€Œæ˜¯å¼€å§‹ç›´æ¥ç»™æˆ‘ä¸€æ•´å¥—ç»“æ„ï¼š<br/>
ç›®å½•æ€ä¹ˆåˆ†ã€æ¨¡å—æ€ä¹ˆæ‹†ã€ä»£ç åº”è¯¥æ”¾åœ¨å“ªä¸€å±‚ã€‚</p>
<p>è¿™æ—¶å€™ï¼Œæˆ‘é—®çš„é—®é¢˜ä¹Ÿå˜äº†ã€‚ä¸å†æ˜¯â€œè¿™æ®µä»£ç æ€ä¹ˆå†™â€ï¼Œ è€Œæ˜¯â€œè¿™ä¸ªåŠŸèƒ½å¦‚æœä»¥åè¦ç»´æŠ¤ï¼Œç°åœ¨è¿™æ ·åˆä¸åˆç†â€ã€‚</p>
<p>è™½ç„¶è¾“å‡ºè¿˜è°ˆä¸ä¸Šå¤šæˆç†Ÿï¼Œä½†æˆ‘èƒ½æ˜æ˜¾æ„Ÿè§‰åˆ°ï¼š</p>
<blockquote>
<p><strong>AI å·²ç»ä¸åªæ˜¯æ‰§è¡Œè€…äº†ï¼Œè€Œæ˜¯åœ¨å‚ä¸å†³ç­–ã€‚</strong></p>
</blockquote>
<h3 data-id="heading-3">å†å¾€åï¼šæ–°æŠ€æœ¯å’Œé‡å¤åŠ³åŠ¨ï¼Œè¢«æˆ‘ç›´æ¥äº¤ç»™äº†å®ƒ</h3>
<p>å†åæ¥ï¼Œæœ‰ä¸¤ä¸ªåœºæ™¯æˆ‘ç”¨ AI ç”¨å¾—ç‰¹åˆ«å¤šã€‚</p>
<p><strong>å­¦æ–°æŠ€æœ¯</strong></p>
<p>é‡åˆ°ä¸ç†Ÿçš„æŠ€æœ¯æ ˆï¼Œæˆ‘å·²ç»å¾ˆå°‘ä»å¤´å•ƒæ–‡æ¡£äº†ï¼Œè€Œæ˜¯å…ˆè®© AI ç»™æˆ‘è·‘ä¸€ä¸ªæœ€å°å¯ç”¨çš„ä¾‹å­å‡ºæ¥ï¼›</p>
<p>æˆ‘ä¸æŒ‡æœ›å®ƒä¸€æ­¥åˆ°ä½ï¼Œä½†è¿™ä¸ªä¾‹å­è‡³å°‘èƒ½è®©æˆ‘å¿«é€ŸçŸ¥é“ï¼š<br/>
è¿™ä¸ªä¸œè¥¿å¤§æ¦‚æ˜¯æ€ä¹ˆç»„ç»‡çš„ï¼Œæœ‰æ²¡æœ‰æ˜æ˜¾å‘ç‚¹ã€‚</p>
<p><strong>æ—¥å¸¸é‚£äº›ç‰¹åˆ«æ¶ˆè€—è€å¿ƒçš„é‡å¤å·¥ä½œ</strong></p>
<p>æ¯”å¦‚å¯¹è±¡å£°æ˜ã€åºåˆ—åŒ–ååºåˆ—åŒ–ã€å„ç§æ ·æ¿ä»£ç ï¼Œè¿™äº›æ´»ä¸éš¾ï¼Œä½†å†™å¤šäº†çœŸçš„å¾ˆçƒ¦ï¼›
åœ¨è¿™ä¸€ç±»äº‹æƒ…ä¸Šï¼Œæˆ‘å·²ç»åŸºæœ¬ä¸è‡ªå·±åŠ¨æ‰‹äº†ï¼Œä¸æ˜¯å› ä¸ºæˆ‘ä¸ä¼šå†™ï¼Œè€Œæ˜¯æ²¡å¿…è¦ï¼›</p>
<p>æ…¢æ…¢åœ°ï¼Œæˆ‘å¯¹ AI çš„æ„Ÿè§‰ä¹Ÿå˜äº†ï¼Œå®ƒä¸å†åªæ˜¯ä¸€ä¸ªå·¥å…·ï¼Œæ›´åƒæ˜¯</p>
<blockquote>
<p>éšæ—¶å¯ä»¥è°ƒåº¦çš„ <strong>â€œè¶…çº§å·¥å‚â€</strong></p>
</blockquote>
<p><code>æ…¢æ…¢çš„ä¸å†æ˜¯é€è¡Œå®Œæˆä»£ç ï¼Œè€Œæ˜¯å®Œæˆæ–¹æ¡ˆï¼Œå®¡è§†ç»“æ„ï¼Œè¿è¡Œé€»è¾‘</code></p>
<hr/>
<h2 data-id="heading-4">äºŒã€Agent çš„ä½¿ç”¨</h2>
<p>è¯´å®è¯ï¼ŒçœŸæ­£è®©æˆ‘å¼€å§‹â€œæ•¬ç•â€ Agent ç¼–ç¨‹çš„ï¼Œå¹¶ä¸æ˜¯æ•ˆç‡æå‡ï¼Œè€Œæ˜¯<strong>å®ƒå¼€å§‹å˜å¾—åƒä¸€å¥—å·¥ç¨‹æµç¨‹</strong>ï¼›è¿™ä¹Ÿæ˜¯é¦–æ¬¡æ„è¯†åˆ°ï¼ŒAgent çš„ä»·å€¼ä¸åœ¨äºâ€œç”Ÿæˆä»£ç â€ï¼Œè€Œæ˜¯é€šè¿‡ä¸Šä¸‹æ–‡çš„çº¦æŸå°†ä»£ç å…³è¿›â€œç¬¼å­â€ï¼›</p>
<h3 data-id="heading-5">æè¯åˆ°å·¥å…·æµ</h3>
<p>ä¸€å¼€å§‹ç”¨ AI å†™ä»£ç ï¼ŒåŸºæœ¬é  prompt ç¡¬æï¼š</p>
<blockquote>
<p>æè¿°å¾—å¥½ä¸å¥½ï¼Œç›´æ¥å†³å®šè¾“å‡ºèƒ½ä¸èƒ½ç”¨</p>
</blockquote>
<p>ä½†åæ¥æ˜æ˜¾èƒ½æ„Ÿè§‰åˆ°ï¼ŒAI è‡ªå·±ä¹Ÿåœ¨â€œå·¥ç¨‹åŒ–â€
ä¸ç®¡æ˜¯ skillã€å·¥å…·æµï¼Œè¿˜æ˜¯å¯¹ä¸Šä¸‹æ–‡çš„çº¦æŸæ–¹å¼ï¼Œæœ¬è´¨ä¸Šéƒ½åœ¨åšä¸€ä»¶äº‹â€”â€”  <strong>å‡å°‘å³å…´å‘æŒ¥ï¼Œå¢åŠ å¯æ§æ€§</strong></p>
<p>ç°åœ¨çš„ Agent ç¼–ç¨‹çœ‹èµ·æ¥çªç„¶é è°±äº†ä¸å°‘,ä¸æ˜¯å®ƒçªç„¶èªæ˜äº†,è€Œæ˜¯<strong>äº¤äº’æ–¹å¼æ›´åƒå·¥ç¨‹ï¼Œè€Œä¸æ˜¯èŠå¤©</strong></p>
<h3 data-id="heading-6">å¹»è§‰é—®é¢˜</h3>
<p>ç»„é‡Œå°±å‡ºè¿‡ä¸€æ¬¡å›  AI å¹»è§‰å¯¼è‡´çš„P0äº‹æ•…ã€‚<br/>
åŒäº‹åœ¨ç”¨ AI æ”¹ä¸€ä¸ª A æ–‡ä»¶çš„é€»è¾‘æ—¶ï¼ŒæŠŠ B æ–‡ä»¶é‡Œç›¸å…³çš„å®ç°ä¹Ÿä¸€èµ·â€œä¼˜åŒ–â€äº†ã€‚ä»ä»£ç æœ¬èº«çœ‹ï¼Œæ”¹åŠ¨æ˜¯åˆç†çš„ï¼Œé€»è¾‘ä¹Ÿèƒ½è‡ªæ´½ã€‚ä½†é—®é¢˜åœ¨äºï¼ŒB æ–‡ä»¶çš„é‚£éƒ¨åˆ†é€»è¾‘<strong>ä¸è¯¥è¢«è¿™ä¸ªéœ€æ±‚è§¦ç¢°çš„</strong>ï¼›</p>
<p>ç»“æœå¾ˆç›´æ¥ï¼š<br/>
<strong>ä¸€ä¸ª P0 ç¼ºé™·è¢«å¸¦åˆ°äº†çº¿ä¸Šã€‚</strong></p>
<p>äº‹åå¤ç›˜æ—¶å¤§å®¶çš„å…±è¯†ä¹Ÿå¾ˆæ¸…æ¥š,å¦‚æœæ˜¯äººå·¥æ”¹ä»£ç ï¼Œå¤§æ¦‚ç‡ä¸ä¼šè¿™ä¹ˆå¹²ã€‚<br/>
<code>çœŸæ­£å±é™©çš„åœ°æ–¹åœ¨äºâ€”â€”â€”â€”ä¸æ˜¯ä»£ç å†™é”™äº†ï¼Œè€Œæ˜¯çº¦æŸå¤±æ§</code></p>
<h3 data-id="heading-7">è€é¡¹ç›®é‡Œï¼ŒAI å¾ˆå®¹æ˜“æŠŠå‘ä¸€æ¬¡æ€§æ”¾å¤§</h3>
<p>è¿˜æœ‰ä¸€æ¬¡ç»å†ï¼Œä¹Ÿè®©æˆ‘å¯¹ AI åœ¨å·¥ç¨‹é‡Œçš„è¾¹ç•Œæœ‰äº†æ›´æ¸…é†’çš„è®¤è¯†;</p>
<p>å½“æ—¶æƒ³åœ¨ä¸€ä¸ªè¿­ä»£äº†å¤šå¹´çš„è€é¡¹ç›®é‡Œå¿«é€ŸåŠ åŠŸèƒ½,æˆ‘å¯¹æ•´ä½“æ¡†æ¶ç†è§£å¾—å¹¶ä¸ç®—é€ï¼Œå°±æƒ³ç€å…ˆè®© AI å‡ºä¸€ç‰ˆæ–¹æ¡ˆ;</p>
<p>åŠŸèƒ½ç¡®å®å¾ˆå¿«å°±è·‘èµ·æ¥äº†,ä½†è¶Šå¾€åç»´æŠ¤ï¼Œé—®é¢˜è¶Šå¤šï¼š</p>
<ul>
<li>ç»“æ„è¿‡é‡ï¼Œæ²¡æœ‰ä»¥åŸæœ‰ç»“æ„é€»è¾‘æ–°å¢</li>
<li>è®¾è®¡è¿‡åº¦ï¼Œå‡ ä¹æ²¡æ‰©å±•æ€§</li>
<li>å®Œå…¨æ— ç»´æŠ¤æ€§ï¼Œä¸€ç¢°å°±ç¢</li>
</ul>
<p>æœ€åçš„ç»“æœâ€”â€”æ–°å¢åŠŸèƒ½æ²¡ä¿ä½ï¼Œè¿˜è¢«è¿«è¿å¸¦ç€åšäº†ä¸€æ¬¡é‡æ„ã€‚</p>
<p>é‚£æ¬¡ä¹‹åæˆ‘åŸºæœ¬å½¢æˆäº†ä¸€ä¸ªè®¤çŸ¥ï¼š</p>
<blockquote>
<p><strong>åœ¨å¤æ‚å·¥ç¨‹é‡Œï¼ŒAI ä¼šæŠŠä½ å½“å‰çš„è®¤çŸ¥æ°´å¹³ï¼Œæˆå€æ”¾å¤§</strong></p>
</blockquote>
<p><code>å›å¤´çœ‹ï¼Œè¿™æ¬¡é—®é¢˜ä¸åœ¨äº AIï¼Œè€Œæ˜¯ä¸ªäººæœªç†è§£ç³»ç»Ÿä¹‹å‰å°†æƒåˆ©äº¤äº†å‡ºå»</code></p>
<h2 data-id="heading-8">ä¸‰ã€è¡Œä¸šçš„å˜åŒ–</h2>
<p>è¿™ä¸¤å¹´ITè¡Œä¸šçš„ç¯å¢ƒå˜åŒ–ï¼Œå…¶å®å¤§å®¶éƒ½æœ‰ä½“æ„Ÿâ€”â€”å²—ä½å˜å°‘ã€è¦æ±‚å˜é«˜ï¼Œå¸¦æ•™åˆ¶å‡ ä¹æ¶ˆå¤±ï¼Œå¾ˆå¤šæ—¶å€™ä¸€ä¸Šæ¥å°±è¦æ±‚â€œèƒ½å¹²æ´»â€ã€‚æœ‰ä¸€éƒ¨åˆ†è¡Œä¸šè‡ªèº«è¡°è½çš„åŸå› ï¼Œä¹Ÿæœ‰ AI å‡ºç°å¯¹æ–°äººçš„å½±å“ï¼›</p>
<p>AI å¹¶æ²¡æœ‰æ”¹å˜å·¥ç¨‹å¤æ‚åº¦ï¼Œåªæ˜¯æ”¹å˜äº†<strong>è°æ¥ä¸ºå¤æ‚ä¹°å•</strong>ï¼Œåœ¨çœŸå®çš„å·¥ç¨‹ç¯å¢ƒé‡Œï¼ŒAI å¸¦æ¥çš„æœ€å¤§å˜åŒ–ï¼Œå…¶å®ä¸æ˜¯â€œå†™å¾—æ›´å¿«â€ï¼Œè€Œæ˜¯ <strong>é£é™©çš„æ‰¿æ‹…æ–¹å¼å‘ç”Ÿäº†å˜åŒ–</strong>ï¼›</p>
<h3 data-id="heading-9">å·¥ç¨‹ä¸äºº</h3>
<p>å¯¹å·²ç»æœ‰å·¥ç¨‹ç»éªŒçš„äººæ¥è¯´ï¼ŒAI æ›´åƒæ˜¯åŠ é€Ÿå™¨ã€‚ä½ å¤§æ¦‚çŸ¥é“ä»€ä¹ˆæ˜¯å¯¹çš„ã€ä»€ä¹ˆæ˜¯ä¸èƒ½ç¢°çš„ï¼Œèƒ½èŠ‚çº¦å¼€å‘å‘¨æœŸï¼›</p>
<p>ä½†å¯¹æ–°äººæ¥è¯´ï¼Œæƒ…å†µå¾€å¾€ç›¸åã€‚åœ¨è¿˜æ²¡å»ºç«‹å®Œæ•´è®¤çŸ¥ä½“ç³»ã€ä¹Ÿæ²¡çœŸæ­£åšè¿‡è®¾è®¡å–èˆçš„å‰æä¸‹ï¼ŒAI ç»™å‡ºçš„â€œçœ‹èµ·æ¥å¾ˆå®Œæ•´çš„æ–¹æ¡ˆâ€ï¼Œåè€Œä¼šè®©äººè¯¯ä»¥ä¸ºé—®é¢˜å·²ç»è¢«è§£å†³äº†ï¼›ä¸€æ—¦ä¸šåŠ¡å¤æ‚åº¦ä¸Šæ¥ï¼Œéšè—çš„é—®é¢˜ä¼šé›†ä¸­çˆ†å‘ã€‚ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨è€é¡¹ç›®é‡Œï¼Œ AI å¾ˆå®¹æ˜“æŠŠé—®é¢˜ä¸€æ¬¡æ€§æ”¾å¤§â€”â€”â€”â€”ä¸æ˜¯å› ä¸ºå®ƒä¹±å†™ï¼Œè€Œæ˜¯<strong>å®ƒä¸çŸ¥é“ä»€ä¹ˆä¸è¯¥å†™</strong>ï¼›</p>
<h3 data-id="heading-10">å®è·µçš„è®¤çŸ¥</h3>
<blockquote>
<p>ä»»ä½•å·¥å…·çš„ä½¿ç”¨ï¼Œéƒ½åº”è¯¥å»ºç«‹åœ¨å®è·µä¹‹ä¸Š</p>
</blockquote>
<p>å¾ˆè®¤åŒå¼ æ–‡å®åŒ»ç”Ÿçš„è§‚ç‚¹â€”â€”<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.guancha.cn%2Fpolitics%2F2026_01_13_803716.shtml" target="_blank" title="https://www.guancha.cn/politics/2026_01_13_803716.shtml" ref="nofollow noopener noreferrer">åå¯¹å¹´è½»åŒ»ç”Ÿè¿‡åº¦ä¾èµ– AI è¯Šæ–­</a>ä¸æ˜¯å› ä¸º AI ä¸å‡†ï¼Œè€Œæ˜¯<strong>è¯Šæ–­èƒ½åŠ›æœ¬èº«éœ€è¦é€šè¿‡å¤§é‡å®è·µå»ºç«‹</strong>ï¼›</p>
<p>è½¯ä»¶å·¥ç¨‹ä¹Ÿæ˜¯ä¸€æ ·ï¼Œå¦‚æœä¸€ä¸ªäººä»ä¸€å¼€å§‹å°±ä¹ æƒ¯æŠŠâ€œç†è§£â€å’Œâ€œè®¾è®¡â€å¤–åŒ…ç»™ AIï¼Œé‚£ä¹ˆä»–ç¼ºå¤±çš„ä¸æ˜¯ä»£ç èƒ½åŠ›ï¼Œè€Œæ˜¯åˆ¤æ–­èƒ½åŠ›ï¼›åœ¨è¿˜æœªå»ºç«‹å·¥ç¨‹ç›´è§‰ï¼Œæ²¡è¸©å‘ä¹‹å‰ï¼Œå¾ˆéš¾åˆ¤å®šä¸€äº›åŸºç¡€äº‹å®ï¼š</p>
<ul>
<li>æ˜¯å¦è¿‡åº¦è®¾è®¡ï¼Œå¯ç”¨æ€§å¦‚ä½•</li>
<li>å½“å‰æ”¹åŠ¨å¯¹äºæ•´ä¸ªç³»ç»Ÿçš„å½±å“</li>
<li>åç»­çš„å¯ç»´æŠ¤æ€§ä»¥åŠéšä¸šåŠ¡è¿­ä»£çš„å¯æ‰©å±•æ€§</li>
</ul>
<p><code>è¿™äº›åˆ¤æ–­èƒ½åŠ›ï¼Œéƒ½éœ€è¦äº²èº«ç»å†æ‰èƒ½é€æ¸å½¢æˆ</code></p>
<h3 data-id="heading-11">éç‰¹å®šè¡Œä¸šé—®é¢˜</h3>
<p>å…¶å®ä¸åªæ˜¯ IT è¡Œä¸šï¼Œåœ¨å¾ˆå¤šé¢†åŸŸï¼ŒåŸ¹è®­æ­£åœ¨è¢«â€œæ•ˆç‡â€å’Œâ€œäº¤ä»˜å‹åŠ›â€æŒ¤æ‰ï¼›å›¢é˜Ÿéš¾ä»¥æŠ•å…¥æˆæœ¬åŸ¹å…»æ–°äººï¼ŒAI çœ‹èµ·æ¥ç»™äº†ä¸€ä¸ª<strong>çœ‹ä¼¼åˆç†çš„è¡¥ä½æ–¹æ¡ˆ</strong>ï¼Œèƒ½å¸®åŠ©æ–°äººçŸ­æœŸâ€œçœ‹èµ·æ¥èƒ½å¹²æ´»â€</p>
<p>ä½†ä»ç»“æœçœ‹ï¼Œåœ¨æé«˜æ•ˆç‡çš„åŒæ—¶ï¼Œä¹Ÿå°†å¾ˆå¤šç»éªŒåŒ–çš„é£é™©è´£ä»»ç›´æ¥æš´éœ²ç»™æ–°äººï¼›å¾ˆå¤šç»éªŒå‹é£é™©ä»å›¢é˜Ÿå±‚å…œåº•æ¼”å˜æˆä¸ªäººé¢å¯¹ï¼Œè¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„éšæ‚£ï¼›</p>
<blockquote>
<p>æœ‰äº›è®¤çŸ¥ç†å¿µéœ€è¦æ—¥ç§¯æœˆç´¯çš„å·¥ç¨‹å­¦è®¤çŸ¥ç§¯ç´¯</p>
</blockquote>
<p>å·¥ç¨‹è®¤çŸ¥è¿™å—ï¼Œéœ€è¦åœ¨çœŸå®å·¥ç¨‹åå¤ç¢°å£ã€åå¤å¤ç›˜é å®è·µé€æ­¥ç§¯ç´¯ï¼›</p>
<p><code>å·¥ç¨‹è®¤çŸ¥è¿™ä»¶äº‹ä»æ¥ä¸æ˜¯æ•ˆç‡å·¥å…·å¯ä»¥å‹ç¼©çš„æˆæœ¬</code></p>
<h2 data-id="heading-12">å››ã€åœ¨ä¿¡æ¯æ´ªæµæ‰¾åˆ°å±äºè‡ªå·±çš„ Vibe Coding</h2>
<p>å›æº¯ä¸ AIã€Agent æ‰“äº¤é“çš„ä¸€è·¯ï¼ŒçœŸæ­£æ”¹å˜æˆ‘çš„ä¸æ˜¯å†åªæ˜¯å°†ä»–ä½œä¸ºä¸€ä¸ªâ€œå·¥å…·â€ï¼Œè€Œæ˜¯é‡æ–°å®¡è§†è‡ªå·±åœ¨å·¥ç¨‹é¢†åŸŸä¸­çš„ è§’è‰²ï¼›</p>
<p>å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ç¦»ä¸å¼€ä½¿ç”¨ä»–è¿›è¡Œå·¥ä½œã€ç”Ÿæ´»ï¼Œä½†æœ¬è´¨ä¸Šè¿™æ˜¯åœ¨ä¸æ–­å»ºç«‹å¹¶æå‡è®¤çŸ¥å‰æä¸‹æ‰èƒ½æ›´å¥½ä½¿ç”¨ï¼›</p>
<p>æ„æ€éœ€æ±‚ï¼Œå®Œå–„çº¦æŸï¼Œæ²Ÿé€šæ–¹æ¡ˆï¼Œæ‰§è¡Œç”Ÿæˆï¼›ç”¨å¾—å¥½ä»–å°±æ˜¯æ•‘å‘½ç¨»è‰ï¼Œç”¨ä¸å¥½å°±æ˜¯æ´ªæ°´çŒ›å…½ï¼Œ<strong>ä¸ç¥è¯ï¼Œä¸æ‹’ç»</strong>æ˜¯æœ€å¥½çš„ä½¿ç”¨è§‚å¿µï¼›æ‰€è°“çš„ Vibe Codeingï¼Œç»ä¸è¯¥æ˜¯æ— è„‘ä½¿ç”¨ AI è¾“å‡ºä»£ç ï¼Œè€Œæ˜¯åœ¨ç†è§£ç³»ç»Ÿï¼Œæ•¬ç•å·¥ç¨‹çš„å‰æä¸‹ï¼Œæ‹¥æœ‰æ¸…æ™°åˆ¤æ–­åŠ›çš„æƒ…å†µä¸‹å®ŒæˆåŠ³åŠ¨æˆæœï¼›</p>
<blockquote>
<p>ä¹Ÿè®¸ AI å¸¦æ¥çš„çœŸçš„æ˜¯ä¸‹ä¸€æ¬¡å·¥ä¸šé©å‘½ï¼Œè‡³å°‘å¯¹ä¸ªäººè€Œè¨€å®ƒæ˜¯æ—¥å¸¸çš„ä¸€éƒ¨åˆ†</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç¡®ä¿æ•°å€¼è®¡ç®—ç²¾åº¦ï¼šBigDecimal ä½¿ç”¨æŒ‡å—ä¸æœ€ä½³å®è·µ]]></title>    <link>https://juejin.cn/post/7595893785907314722</link>    <guid>https://juejin.cn/post/7595893785907314722</guid>    <pubDate>2026-01-18T01:14:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595893785907314722" data-draft-id="7595886887523778600" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç¡®ä¿æ•°å€¼è®¡ç®—ç²¾åº¦ï¼šBigDecimal ä½¿ç”¨æŒ‡å—ä¸æœ€ä½³å®è·µ"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-01-18T01:14:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="lagrahhn"/> <meta itemprop="url" content="https://juejin.cn/user/3901542412069112"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç¡®ä¿æ•°å€¼è®¡ç®—ç²¾åº¦ï¼šBigDecimal ä½¿ç”¨æŒ‡å—ä¸æœ€ä½³å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3901542412069112/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    lagrahhn
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T01:14:45.000Z" title="Sun Jan 18 2026 01:14:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>é€‚ç”¨äºé‡‘èè®¡ç®—ã€é«˜ç²¾åº¦è¿ç®—ç­‰å¯¹æ•°å€¼å‡†ç¡®æ€§è¦æ±‚é«˜çš„åœºæ™¯ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ğŸ“Œ ä¸€ã€å¸¸è§é—®é¢˜ç‚¹</h2>
<h3 data-id="heading-1">ä½¿ç”¨ <code>BigDecimal(double)</code> æ„é€ å‡½æ•° âŒ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// é”™è¯¯ç¤ºèŒƒ</span>
<span class="hljs-type">BigDecimal</span> <span class="hljs-variable">bd</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-number">0.1</span>); 
System.out.println(bd); <span class="hljs-comment">// è¾“å‡º: 0.1000000000000000055511151231257827021181583404541015625</span>
</code></pre>
<p>âœ… <strong>æ¨èåšæ³•</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">BigDecimal</span> <span class="hljs-variable">bd1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"0.1"</span>);          <span class="hljs-comment">// å®‰å…¨</span>
<span class="hljs-type">BigDecimal</span> <span class="hljs-variable">bd2</span> <span class="hljs-operator">=</span> BigDecimal.valueOf(<span class="hljs-number">0.1</span>);        <span class="hljs-comment">// å†…éƒ¨è½¬å­—ç¬¦ä¸²ï¼Œä¹Ÿå®‰å…¨</span>
</code></pre>
<hr/>
<h3 data-id="heading-2">é™¤æ³•æœªæŒ‡å®šèˆå…¥æ¨¡å¼å¯¼è‡´å¼‚å¸¸ âŒ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">BigDecimal</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"1"</span>);
<span class="hljs-type">BigDecimal</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"3"</span>);
a.divide(b); <span class="hljs-comment">// Non-terminating decimal expansion; no exact representable decimal result.</span>
</code></pre>
<p>âœ… <strong>æ¨èåšæ³•</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">BigDecimal</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> a.divide(b, <span class="hljs-number">4</span>, RoundingMode.HALF_UP);
<span class="hljs-comment">// æˆ–</span>
<span class="hljs-type">BigDecimal</span> <span class="hljs-variable">result2</span> <span class="hljs-operator">=</span> a.divide(b, <span class="hljs-keyword">new</span> <span class="hljs-title class_">MathContext</span>(<span class="hljs-number">10</span>, RoundingMode.HALF_UP));
</code></pre>
<p>ğŸ“Œ <strong>å»ºè®®</strong>ï¼šæ‰€æœ‰é™¤æ³•æ“ä½œéƒ½æ˜¾å¼æŒ‡å®šç²¾åº¦å’Œèˆå…¥æ–¹å¼ã€‚</p>
<hr/>
<h3 data-id="heading-3"><code>equals()</code> æ¯”è¾ƒåŒ…å« scaleï¼ˆå°æ•°ä½æ•°ï¼‰âŒ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"1.0"</span>).equals(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"1"</span>)); <span class="hljs-comment">// false</span>
</code></pre>
<p>âœ… <strong>æ­£ç¡®æ¯”è¾ƒæ•°å€¼æ˜¯å¦ç›¸ç­‰</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"1.0"</span>).compareTo(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"1"</span>)) == <span class="hljs-number">0</span>; <span class="hljs-comment">// true</span>
</code></pre>
<p>ğŸ“Œ <strong>è§„åˆ™æ€»ç»“</strong>ï¼š</p>
<ul>
<li>æ•°å€¼ç›¸ç­‰ â†’ <code>compareTo() == 0</code></li>
<li>å®Œå…¨ç›¸åŒï¼ˆå« scaleï¼‰â†’ <code>equals()</code></li>
</ul>
<hr/>
<h3 data-id="heading-4"><code>hashCode()</code> ä¸ <code>equals()</code> ä¸ä¸€è‡´ï¼ˆå›  scale ä¸åŒï¼‰âŒ</h3>
<pre><code class="hljs language-java" lang="java">Set&lt;BigDecimal&gt; set = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();
set.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"1.0"</span>));
set.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"1"</span>)); <span class="hljs-comment">// è¢«è§†ä¸ºä¸¤ä¸ªä¸åŒå…ƒç´ ï¼</span>
System.out.println(set.size()); <span class="hljs-comment">// è¾“å‡º: 2</span>
</code></pre>
<p>âœ… <strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šç»Ÿä¸€æ ¼å¼åå†æ”¾å…¥é›†åˆ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">BigDecimal</span> <span class="hljs-variable">normalized</span> <span class="hljs-operator">=</span> bd.stripTrailingZeros();
set.add(normalized);
</code></pre>
<hr/>
<h3 data-id="heading-5"><code>stripTrailingZeros()</code> å¯èƒ½è¿”å›ç§‘å­¦è®¡æ•°æ³• âŒ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">BigDecimal</span> <span class="hljs-variable">bd</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"100"</span>);
System.out.println(bd.stripTrailingZeros().toString()); <span class="hljs-comment">// è¾“å‡º: 1E+2</span>
</code></pre>
<p>âœ… <strong>è¾“å‡ºæ ‡å‡†åè¿›åˆ¶æ ¼å¼</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java">System.out.println(bd.stripTrailingZeros().toPlainString()); <span class="hljs-comment">// è¾“å‡º: 100</span>
</code></pre>
<hr/>
<h3 data-id="heading-6">æ€§èƒ½é—®é¢˜ï¼šé¢‘ç¹åˆ›å»ºå¯¹è±¡</h3>
<ul>
<li><code>BigDecimal</code> æ˜¯ä¸å¯å˜ç±»ï¼Œæ¯æ¬¡è¿ç®—éƒ½ç”Ÿæˆæ–°å¯¹è±¡ã€‚</li>
<li>é«˜é¢‘å¾ªç¯ä¸­å¯èƒ½é€ æˆ GC å‹åŠ›ã€‚</li>
</ul>
<p>âœ… <strong>ä¼˜åŒ–å»ºè®®</strong>ï¼š</p>
<ul>
<li>ç¼“å­˜å¸¸ç”¨å¸¸é‡ï¼š<code>BigDecimal.ZERO</code>, <code>BigDecimal.ONE</code>, <code>BigDecimal.TEN</code></li>
<li>é¿å…ä¸å¿…è¦çš„ä¸­é—´å˜é‡</li>
</ul>
<hr/>
<h3 data-id="heading-7"><code>setScale()</code> ä¸æ”¹å˜åŸå¯¹è±¡ âŒ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">BigDecimal</span> <span class="hljs-variable">bd</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"1.234"</span>);
bd.setScale(<span class="hljs-number">2</span>, RoundingMode.HALF_UP); <span class="hljs-comment">// æ— æ•ˆï¼</span>
System.out.println(bd); <span class="hljs-comment">// ä»æ˜¯ 1.234</span>
</code></pre>
<p>âœ… <strong>å¿…é¡»é‡æ–°èµ‹å€¼</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java">bd = bd.setScale(<span class="hljs-number">2</span>, RoundingMode.HALF_UP);
</code></pre>
<hr/>
<h3 data-id="heading-8">é»˜è®¤èˆå…¥æ¨¡å¼é€‰æ‹©éœ€è°¨æ…</h3>

















<table><thead><tr><th>èˆå…¥æ¨¡å¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>HALF_UP</code></td><td>å››èˆäº”å…¥ï¼ˆæœ€å¸¸ç”¨ï¼‰</td></tr><tr><td><code>HALF_EVEN</code></td><td>é“¶è¡Œå®¶èˆå…¥ï¼ˆå‡å°‘ç´¯ç§¯è¯¯å·®ï¼Œé€‚åˆé‡‘èï¼‰</td></tr></tbody></table>
<p>âœ… <strong>æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©</strong>ï¼Œä¸è¦ç›²ç›®ä½¿ç”¨é»˜è®¤ã€‚</p>
<hr/>
<h2 data-id="heading-9">ğŸ“Œ äºŒã€<code>toString()</code> vs <code>toPlainString()</code> å¯¹æ¯”</h2>




















<table><thead><tr><th>æ–¹æ³•</th><th>è¡Œä¸º</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><code>toString()</code></td><td>å¯èƒ½ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•ï¼ˆå¦‚ <code>1.23E-7</code>ï¼‰</td><td>æ—¥å¿—ã€è°ƒè¯•</td></tr><tr><td><code>toPlainString()</code></td><td>å§‹ç»ˆè¿”å›æ™®é€šåè¿›åˆ¶æ ¼å¼</td><td>æ˜¾ç¤ºã€å­˜å‚¨ã€åºåˆ—åŒ–</td></tr></tbody></table>
<h3 data-id="heading-10">ç¤ºä¾‹å¯¹æ¯”ï¼š</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">BigDecimal</span> <span class="hljs-variable">small</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"0.000000123"</span>);
System.out.println(small.toString());        <span class="hljs-comment">// 1.23E-7</span>
System.out.println(small.toPlainString());   <span class="hljs-comment">// 0.000000123</span>

<span class="hljs-type">BigDecimal</span> <span class="hljs-variable">trailing</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"100.00"</span>);
System.out.println(trailing.toString());        <span class="hljs-comment">// 100.00</span>
System.out.println(trailing.toPlainString());   <span class="hljs-comment">// 100.00</span>

<span class="hljs-type">BigDecimal</span> <span class="hljs-variable">large</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"1E+10"</span>);
System.out.println(large.toString());        <span class="hljs-comment">// 1E+10</span>
System.out.println(large.toPlainString());   <span class="hljs-comment">// 10000000000</span>
</code></pre>
<p>âœ… <strong>å»ºè®®</strong>ï¼šå¯¹å¤–è¾“å‡ºï¼ˆå¦‚ JSONã€UIã€æ•°æ®åº“ï¼‰ä¸€å¾‹ä½¿ç”¨ <code>toPlainString()</code>ã€‚</p>
<hr/>
<h2 data-id="heading-11">ğŸ“Œ ä¸‰ã€å®Œæ•´æµ‹è¯•ä»£ç ï¼ˆéªŒè¯æ‰€æœ‰é—®é¢˜ç‚¹ï¼‰</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.math.BigDecimal;
<span class="hljs-keyword">import</span> java.math.MathContext;
<span class="hljs-keyword">import</span> java.math.RoundingMode;
<span class="hljs-keyword">import</span> java.util.HashSet;
<span class="hljs-keyword">import</span> java.util.Set;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BigDecimalPitfallsTest</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        System.out.println(<span class="hljs-string">"=== 1. æ„é€ å‡½æ•°é™·é˜± ==="</span>);
        testConstructor();

        System.out.println(<span class="hljs-string">"\n=== 2. é™¤æ³•å¼‚å¸¸ ==="</span>);
        testDivision();

        System.out.println(<span class="hljs-string">"\n=== 3. equals vs compareTo ==="</span>);
        testEqualsVsCompareTo();

        System.out.println(<span class="hljs-string">"\n=== 4. Set ä¸­é‡å¤é—®é¢˜ ==="</span>);
        testSetBehavior();

        System.out.println(<span class="hljs-string">"\n=== 5. stripTrailingZeros ä¸ toPlainString ==="</span>);
        testStripAndToString();

        System.out.println(<span class="hljs-string">"\n=== 6. setScale å¿…é¡»é‡æ–°èµ‹å€¼ ==="</span>);
        testSetScale();

        System.out.println(<span class="hljs-string">"\n=== 7. toString vs toPlainString ==="</span>);
        testToStringFormats();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testConstructor</span><span class="hljs-params">()</span> {
        <span class="hljs-type">BigDecimal</span> <span class="hljs-variable">bad</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-number">0.1</span>);
        <span class="hljs-type">BigDecimal</span> <span class="hljs-variable">good1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"0.1"</span>);
        <span class="hljs-type">BigDecimal</span> <span class="hljs-variable">good2</span> <span class="hljs-operator">=</span> BigDecimal.valueOf(<span class="hljs-number">0.1</span>);
        System.out.println(<span class="hljs-string">"new BigDecimal(0.1): "</span> + bad);
        System.out.println(<span class="hljs-string">"new BigDecimal(\"0.1\"): "</span> + good1);
        System.out.println(<span class="hljs-string">"BigDecimal.valueOf(0.1): "</span> + good2);
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testDivision</span><span class="hljs-params">()</span> {
        <span class="hljs-type">BigDecimal</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"1"</span>);
        <span class="hljs-type">BigDecimal</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"3"</span>);
        <span class="hljs-keyword">try</span> {
            a.divide(b);
        } <span class="hljs-keyword">catch</span> (ArithmeticException e) {
            System.out.println(<span class="hljs-string">"é™¤æ³•å¼‚å¸¸: "</span> + e.getMessage());
        }
        <span class="hljs-type">BigDecimal</span> <span class="hljs-variable">safe</span> <span class="hljs-operator">=</span> a.divide(b, <span class="hljs-number">6</span>, RoundingMode.HALF_UP);
        System.out.println(<span class="hljs-string">"å®‰å…¨é™¤æ³•ç»“æœ: "</span> + safe);
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testEqualsVsCompareTo</span><span class="hljs-params">()</span> {
        <span class="hljs-type">BigDecimal</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"1.0"</span>);
        <span class="hljs-type">BigDecimal</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"1"</span>);
        System.out.println(<span class="hljs-string">"x.equals(y): "</span> + x.equals(y)); <span class="hljs-comment">// false</span>
        System.out.println(<span class="hljs-string">"x.compareTo(y) == 0: "</span> + (x.compareTo(y) == <span class="hljs-number">0</span>)); <span class="hljs-comment">// true</span>
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testSetBehavior</span><span class="hljs-params">()</span> {
        Set&lt;BigDecimal&gt; set = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();
        set.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"1.0"</span>));
        set.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"1"</span>));
        System.out.println(<span class="hljs-string">"Set å¤§å°ï¼ˆæœªæ ‡å‡†åŒ–ï¼‰: "</span> + set.size()); <span class="hljs-comment">// 2</span>

        Set&lt;BigDecimal&gt; normalizedSet = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();
        normalizedSet.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"1.0"</span>).stripTrailingZeros());
        normalizedSet.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"1"</span>).stripTrailingZeros());
        System.out.println(<span class="hljs-string">"Set å¤§å°ï¼ˆæ ‡å‡†åŒ–åï¼‰: "</span> + normalizedSet.size()); <span class="hljs-comment">// 1</span>
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testStripAndToString</span><span class="hljs-params">()</span> {
        <span class="hljs-type">BigDecimal</span> <span class="hljs-variable">bd</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"100"</span>);
        System.out.println(<span class="hljs-string">"stripTrailingZeros().toString(): "</span> + bd.stripTrailingZeros().toString());
        System.out.println(<span class="hljs-string">"stripTrailingZeros().toPlainString(): "</span> + bd.stripTrailingZeros().toPlainString());
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testSetScale</span><span class="hljs-params">()</span> {
        <span class="hljs-type">BigDecimal</span> <span class="hljs-variable">bd</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"1.234"</span>);
        bd.setScale(<span class="hljs-number">2</span>, RoundingMode.HALF_UP); <span class="hljs-comment">// æ— æ•ˆæœ</span>
        System.out.println(<span class="hljs-string">"æœªé‡æ–°èµ‹å€¼: "</span> + bd); <span class="hljs-comment">// 1.234</span>

        bd = bd.setScale(<span class="hljs-number">2</span>, RoundingMode.HALF_UP);
        System.out.println(<span class="hljs-string">"é‡æ–°èµ‹å€¼å: "</span> + bd); <span class="hljs-comment">// 1.23</span>
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testToStringFormats</span><span class="hljs-params">()</span> {
        BigDecimal[] cases = {
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"0.000000123"</span>),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"100.00"</span>),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-string">"12345678901234567890"</span>)
        };
        <span class="hljs-keyword">for</span> (BigDecimal bd : cases) {
            System.out.println(<span class="hljs-string">"åŸå§‹: "</span> + bd);
            System.out.println(<span class="hljs-string">"  toString():        "</span> + bd.toString());
            System.out.println(<span class="hljs-string">"  toPlainString():  "</span> + bd.toPlainString());
            System.out.println();
        }
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-12">ğŸ“Œ å››ã€æœ€ä½³å®è·µæ€»ç»“è¡¨</h2>













































<table><thead><tr><th>åœºæ™¯</th><th>æ¨èåšæ³•</th></tr></thead><tbody><tr><td><strong>æ„é€ </strong></td><td>ä¼˜å…ˆä½¿ç”¨ <code>new BigDecimal("xxx")</code> æˆ– <code>BigDecimal.valueOf(xxx)</code></td></tr><tr><td><strong>æ¯”è¾ƒæ•°å€¼</strong></td><td>ä½¿ç”¨ <code>compareTo() == 0</code></td></tr><tr><td><strong>åˆ¤æ–­å®Œå…¨ç›¸ç­‰</strong></td><td>ä½¿ç”¨ <code>equals()</code>ï¼ˆå« scaleï¼‰</td></tr><tr><td><strong>é™¤æ³•è¿ç®—</strong></td><td>æ€»æ˜¯æŒ‡å®šç²¾åº¦å’Œ <code>RoundingMode</code></td></tr><tr><td><strong>é›†åˆå­˜å‚¨</strong></td><td>å…ˆè°ƒç”¨ <code>.stripTrailingZeros()</code> ç»Ÿä¸€æ ¼å¼</td></tr><tr><td><strong>å­—ç¬¦ä¸²è¾“å‡º</strong></td><td>ä½¿ç”¨ <code>.toPlainString()</code> é¿å…ç§‘å­¦è®¡æ•°æ³•</td></tr><tr><td><strong>ä¿®æ”¹å€¼</strong></td><td>è®°ä½ <code>BigDecimal</code> ä¸å¯å˜ï¼Œå¿…é¡»é‡æ–°èµ‹å€¼</td></tr><tr><td><strong>èˆå…¥ç­–ç•¥</strong></td><td>æ ¹æ®ä¸šåŠ¡é€‰ <code>HALF_UP</code>ï¼ˆé€šç”¨ï¼‰æˆ– <code>HALF_EVEN</code>ï¼ˆé‡‘èï¼‰</td></tr><tr><td><strong>æ€§èƒ½ä¼˜åŒ–</strong></td><td>ç¼“å­˜å¸¸é‡ï¼Œé¿å…é«˜é¢‘åˆ›å»º</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2026å¹´å›½äº§æ—¶åºæ•°æ®åº“ç›˜ç‚¹ï¼šæ ¼å±€å¬—å˜ä¸‹çš„å¤šæ¨¡æ€èåˆæ–°é”]]></title>    <link>https://juejin.cn/post/7596171325531979817</link>    <guid>https://juejin.cn/post/7596171325531979817</guid>    <pubDate>2026-01-18T06:30:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596171325531979817" data-draft-id="7596171325531963433" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2026å¹´å›½äº§æ—¶åºæ•°æ®åº“ç›˜ç‚¹ï¼šæ ¼å±€å¬—å˜ä¸‹çš„å¤šæ¨¡æ€èåˆæ–°é”"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-18T06:30:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç äº‹æ¼«è°ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/1972974802965230"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2026å¹´å›½äº§æ—¶åºæ•°æ®åº“ç›˜ç‚¹ï¼šæ ¼å±€å¬—å˜ä¸‹çš„å¤šæ¨¡æ€èåˆæ–°é”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972974802965230/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç äº‹æ¼«è°ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T06:30:24.000Z" title="Sun Jan 18 2026 06:30:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ—¶åºæ•°æ®åº“åˆ†ææŠ¥å‘Šç”Ÿæˆä»£ç ç¤ºä¾‹</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_timeseries_db_report</span>(<span class="hljs-params">year=<span class="hljs-number">2026</span></span>):
    <span class="hljs-string">"""ç”Ÿæˆ2026å¹´å›½äº§æ—¶åºæ•°æ®åº“åˆ†ææŠ¥å‘Š"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{<span class="hljs-string">'='</span>*<span class="hljs-number">60</span>}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"      <span class="hljs-subst">{year}</span>å¹´å›½äº§æ—¶åºæ•°æ®åº“æŠ€æœ¯åˆ†ææŠ¥å‘Š"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{<span class="hljs-string">'='</span>*<span class="hljs-number">60</span>}</span>\n"</span>)
    
    <span class="hljs-comment"># æŠ¥å‘Šç»Ÿè®¡ä¿¡æ¯</span>
    total_databases = <span class="hljs-number">10</span>
    open_source_count = <span class="hljs-number">5</span>
    commercial_count = <span class="hljs-number">5</span>
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ“Š å¸‚åœºæ¦‚è§ˆ:"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"   - åˆ†æå¹´ä»½: <span class="hljs-subst">{year}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"   - æ”¶å½•æ•°æ®åº“æ•°é‡: <span class="hljs-subst">{total_databases}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"   - å¼€æºäº§å“: <span class="hljs-subst">{open_source_count}</span>æ¬¾"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"   - å•†ä¸šäº§å“: <span class="hljs-subst">{commercial_count}</span>æ¬¾"</span>)
    <span class="hljs-built_in">print</span>()
    
    <span class="hljs-keyword">return</span> <span class="hljs-string">"æŠ¥å‘Šç”Ÿæˆå®Œæˆ"</span>

<span class="hljs-comment"># æ‰§è¡ŒæŠ¥å‘Šç”Ÿæˆ</span>
generate_timeseries_db_report(<span class="hljs-number">2026</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span>*<span class="hljs-number">80</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"                   æ­£å¼æŠ¥å‘Šå†…å®¹"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span>*<span class="hljs-number">80</span> + <span class="hljs-string">"\n"</span>)
</code></pre>
<blockquote>
<p>è¿›å…¥2026å¹´ï¼Œåœ¨"æ•°å­—ä¸­å›½"ä¸å·¥ä¸šç‰©è”ç½‘æµªæ½®çš„å¼ºåŠ²æ¨åŠ¨ä¸‹ï¼Œå›½äº§æ—¶åºæ•°æ®åº“å¸‚åœºæŒç»­ç¹è£ï¼Œç«äº‰æ ¼å±€æ—¥è¶‹æ¸…æ™°ã€‚æœ¬æ–‡å°†å¯¹å½“å‰ä¸»æµçš„å›½äº§æ—¶åºæ•°æ®åº“è¿›è¡Œæ¢³ç†ç›˜ç‚¹ï¼Œå¹¶ç‰¹åˆ«èšç„¦äºé‡‘ä»“æ•°æ®åº“ï¼ˆKingbaseï¼‰ï¼Œæ·±å…¥å‰–æå…¶ä»¥èåˆå¤šæ¨¡æ¶æ„ä¸ºæ ¸å¿ƒçš„å·®å¼‚åŒ–ç«äº‰å®åŠ›ï¼Œä¸ºä¼ä¸šåœ¨æ•°å­—åŒ–è½¬å‹ä¸­çš„æ—¶åºæ•°æ®åº•åº§é€‰å‹æä¾›å‚è€ƒã€‚</p>
</blockquote>
<p>ä¸€ã€ä¸»æµå›½äº§æ—¶åºæ•°æ®åº“æ¦‚è§ˆ (2026)</p>
<p>å›½äº§æ—¶åºæ•°æ®åº“å·²å½¢æˆå¤šå…ƒäº§å“çŸ©é˜µï¼Œæ ¹æ®å…¶æ ¸å¿ƒæŠ€æœ¯è·¯çº¿ã€å•†ä¸šæ¨¡å¼å’Œå¸‚åœºå®šä½ï¼Œä¸»è¦ä»£è¡¨æ€§äº§å“å¦‚ä¸‹ï¼š</p>























































<table><thead><tr><th>æ•°æ®åº“åç§°</th><th>æ ¸å¿ƒå‚å•†/ç¤¾åŒº</th><th>ä¸»è¦ç‰¹ç‚¹ä¸å®šä½</th></tr></thead><tbody><tr><td>TDengine</td><td>æ¶›æ€æ•°æ®</td><td>é«˜æ€§èƒ½ã€åˆ†å¸ƒå¼ï¼Œå®šä½ä¸ºAIé©±åŠ¨çš„å·¥ä¸šå¤§æ•°æ®å¹³å°ï¼Œåœ¨å†™å…¥ååå’Œå­˜å‚¨æˆæœ¬æ–¹é¢ä¼˜åŠ¿æ˜¾è‘—ï¼Œé›†ç¾¤å¼€æºã€ç”Ÿæ€å¼€æ”¾ã€‚</td></tr><tr><td>KaiwuDB</td><td>æµªæ½®äº‘å¼ˆ</td><td>å¼ºè°ƒåˆ†å¸ƒå¼å¤šæ¨¡èåˆæ¶æ„ï¼Œæ”¯æŒæ—¶åºã€å…³ç³»ã€æ–‡æ¡£ç­‰å¤šç§æ•°æ®æ¨¡å‹çš„ç»Ÿä¸€å¤„ç†ï¼ŒåŸç”Ÿé›†æˆAIç®—æ³•ã€‚</td></tr><tr><td>Apache IoTDB</td><td>æ¸…åå¤§å­¦ (ApacheåŸºé‡‘ä¼š)</td><td>ä¸“ä¸ºç‰©è”ç½‘è®¾è®¡ï¼Œé‡‡ç”¨"ç«¯-è¾¹-äº‘"ååŒåŸç”Ÿæ¶æ„ï¼Œæ•°æ®æ¨¡å‹å¸¸é‡‡ç”¨æ ‘å½¢ç»“æ„è´´åˆç‰©ç†è®¾å¤‡å±‚çº§ã€‚</td></tr><tr><td>DolphinDB</td><td>æµ™æ±Ÿæ™ºè‡¾ç§‘æŠ€</td><td>å°†æ•°æ®åº“ä¸å¼ºå¤§çš„ç¼–ç¨‹è¯­è¨€ã€æµè®¡ç®—å¼•æ“èåˆï¼Œåœ¨é‡‘èé‡åŒ–äº¤æ˜“ã€é«˜é¢‘æ•°æ®åˆ†æé¢†åŸŸè¡¨ç°çªå‡ºã€‚</td></tr><tr><td>openGemini</td><td>åä¸ºäº‘</td><td>å¼€æºçš„å¤šæ¨¡æ€æ—¶åºæ•°æ®åº“ï¼Œå…¼å®¹InfluxDBç”Ÿæ€ï¼Œå¼ºè°ƒé«˜æ€§èƒ½ä¸äº‘åŸç”Ÿç‰¹æ€§ã€‚</td></tr><tr><td>CnosDB</td><td>è¯ºå¸æ—¶ç©º</td><td>äº‘åŸç”Ÿæ—¶åºæ•°æ®åº“ï¼Œæ”¯æŒåˆ†å¸ƒå¼ä¸é›†ä¸­å¼éƒ¨ç½²ï¼Œåœ¨ç›‘æ§å’Œç‰©è”ç½‘åœºæ™¯æœ‰åº”ç”¨ã€‚</td></tr><tr><td>GreptimeDB</td><td>æ ¼ç¿ç§‘æŠ€</td><td>äº‘åŸç”Ÿåˆ†å¸ƒå¼æ—¶åºæ•°æ®åº“ï¼Œä¸»æ‰“å®æ—¶åˆ†æèƒ½åŠ›ã€‚</td></tr><tr><td>YMatrix, RealHistorian, GoldenDataç­‰</td><td>å››ç»´çºµæ¨ªã€ç´«é‡‘æ¡¥ã€åºšé¡¿æ•°æ®ç­‰</td><td>åœ¨ç‰¹å®šå·¥ä¸šæˆ–ç›‘æ§é¢†åŸŸæ‹¥æœ‰æ·±åšçš„è¡Œä¸šç§¯ç´¯å’Œå®šåˆ¶åŒ–è§£å†³æ–¹æ¡ˆã€‚</td></tr><tr><td>é‡‘ä»“æ—¶åºæ•°æ®åº“</td><td>ä¸­ç”µç§‘é‡‘ä»“ï¼ˆåŸäººå¤§é‡‘ä»“ï¼‰</td><td>åŸºäºæˆç†Ÿç¨³å®šçš„é‡‘ä»“æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆKESï¼‰å†…æ ¸æ‰“é€ çš„æ—¶åºèƒ½åŠ›å¢å¼ºæ’ä»¶ï¼Œæœ€å¤§ç‰¹ç‚¹æ˜¯ç»§æ‰¿äº†KESçš„èåˆå¤šæ¨¡æ¶æ„ï¼Œæ”¯æŒæ—¶åºæ•°æ®ä¸å…³ç³»å‹ã€ç©ºé—´ï¼ˆGISï¼‰ç­‰æ•°æ®çš„ç»Ÿä¸€å­˜å‚¨ã€å¤„ç†ä¸å…³è”åˆ†æã€‚</td></tr></tbody></table>
<p>äºŒã€ç„¦ç‚¹è§£æï¼šé‡‘ä»“æ—¶åºæ•°æ®åº“çš„èåˆå¤šæ¨¡æ¶æ„
åœ¨ä¼—å¤šä¸“æ³¨äºæ—¶åºåœºæ™¯æè‡´ä¼˜åŒ–çš„äº§å“ä¸­ï¼Œé‡‘ä»“æ•°æ®åº“çš„æ—¶åºç»„ä»¶é€‰æ‹©äº†ä¸€æ¡ç‹¬ç‰¹çš„è·¯å¾„ï¼šä¸è¿½æ±‚åšä¸€ä¸ªå­¤ç«‹çš„ä¸“ç”¨æ—¶åºå¼•æ“ï¼Œè€Œæ˜¯ä½œä¸ºå…¶å¼ºå¤§çš„èåˆæ•°æ®åº“ä½“ç³»ï¼ˆKESï¼‰ä¸­çš„ä¸€ä¸ªç‰ˆå—ã€‚è¿™ç§æ¶æ„é€‰æ‹©å¸¦æ¥äº†ä»¥ä¸‹æ˜¾è‘—ä¼˜åŠ¿ï¼š</p>
<ol>
<li>
<p>å†…æ ¸çº§å¤šæ¨¡æ€èåˆï¼Œæ‰“ç ´æ•°æ®å­¤å²›
ç»Ÿä¸€åº•åº§: é‡‘ä»“æ—¶åºç»„ä»¶å¹¶éç‹¬ç«‹äº§å“ï¼Œè€Œæ˜¯åŸºäºæˆç†Ÿçš„KingbaseESå…³ç³»å‹æ•°æ®åº“å†…æ ¸è¿›è¡Œèåˆã€‚è¿™æ„å‘³ç€ä¼ä¸šæ— éœ€ä¸ºæ—¶åºæ•°æ®å•ç‹¬æ­å»ºå’Œç»´æŠ¤ä¸€å¥—æ–°çš„æ•°æ®åŸºç¡€è®¾æ–½ã€‚
æ— ç¼å…³è”æŸ¥è¯¢: æ—¶åºæ•°æ®ï¼ˆå¦‚ä¼ æ„Ÿå™¨è¯»æ•°ï¼‰ä¸ä¸šåŠ¡å…³ç³»æ•°æ®ï¼ˆå¦‚è®¾å¤‡å°è´¦ã€ç”Ÿäº§å·¥å•ï¼‰å¤©ç„¶å­˜å‚¨åœ¨åŒä¸€æ•°æ®åº“ä¸­ã€‚ç”¨æˆ·å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„SQLï¼ˆæ”¯æŒOracle/PostgreSQLå…¼å®¹æ¨¡å¼ï¼‰ç›´æ¥è¿›è¡Œè·¨æ—¶åºè¡¨å’Œå…³ç³»è¡¨çš„å¤æ‚JOINæŸ¥è¯¢ï¼Œæ— éœ€ç¹ççš„æ•°æ®åŒæ­¥ä¸å¯¼å‡ºï¼Œæå¤§ç®€åŒ–äº†æ•°æ®åˆ†æé“¾è·¯ã€‚
æ”¯æŒä¸°å¯Œæ•°æ®ç±»å‹: å¾—ç›ŠäºKESå†…æ ¸ï¼Œå®ƒä¸ä»…æ”¯æŒæ—¶åºæ•°æ®å¸¸ç”¨çš„æ•°å€¼ã€æ—¶é—´æˆ³ç±»å‹ï¼Œè¿˜åŸç”Ÿæ”¯æŒJSONã€GISç©ºé—´æ•°æ®ã€æ•°ç»„ç­‰å¤æ‚ç±»å‹ï¼Œèƒ½å¤Ÿæ»¡è¶³æ›´å¹¿æ³›çš„å·¥ä¸šæ•°å­—åŒ–åœºæ™¯éœ€æ±‚ã€‚</p>
</li>
<li>
<p>å¤ç”¨å¹¶å¼ºåŒ–ä¼ä¸šçº§æ ¸å¿ƒèƒ½åŠ›
æè‡´çš„äº‹åŠ¡ï¼ˆACIDï¼‰ä¿è¯: åœ¨é‡‘ä»“çš„æ—¶åºè¡¨ä¸Šï¼Œæ•°æ®å†™å…¥åŒæ ·äº«æœ‰å®Œæ•´çš„å…³ç³»å‹æ•°æ®åº“äº‹åŠ¡æ”¯æŒï¼Œè¿™åœ¨è¦æ±‚æ•°æ®å¼ºä¸€è‡´æ€§çš„é‡‘èã€ç”µåŠ›è°ƒåº¦ç­‰å…³é”®ä¸šåŠ¡åœºæ™¯ä¸­æ˜¯ç‹¬ç‰¹ä¼˜åŠ¿ã€‚
ä¼ä¸šçº§é«˜å¯ç”¨ä¸å®‰å…¨: æ—¶åºæ•°æ®å¯ç›´æ¥å—ç›ŠäºKESå·²æ„å»ºæˆç†Ÿçš„è¯»å†™åˆ†ç¦»ã€å…±äº«å­˜å‚¨ã€åˆ†å¸ƒå¼é›†ç¾¤ç­‰é«˜å¯ç”¨æ¶æ„ï¼Œä»¥åŠè¡Œåˆ—çº§æƒé™æ§åˆ¶ã€æ•°æ®åŠ å¯†ç­‰ä¼ä¸šçº§å®‰å…¨ç‰¹æ€§ã€‚
æˆç†Ÿçš„ç”Ÿæ€ä¸å·¥å…·é“¾: å¯ç›´æ¥å¤ç”¨KESçš„å¤‡ä»½æ¢å¤ã€ç›‘æ§è¿ç»´ã€æ•°æ®è¿ç§»ï¼ˆKDTSï¼‰ç­‰æ•´å¥—è¿ç»´ç®¡ç†å·¥å…·ï¼Œä»¥åŠä¸å„ç±»BIã€ETLå·¥å…·çš„è¿æ¥ç”Ÿæ€ï¼Œé™ä½å­¦ä¹ ä¸è¿ç»´æˆæœ¬ã€‚</p>
</li>
<li>
<p>é¢å‘å¤æ‚åœºæ™¯çš„ç»¼åˆæ€§èƒ½è¡¨ç°
ä»é‡‘ä»“å®˜æ–¹æŠ«éœ²çš„æµ‹è¯•æŠ¥å‘Šï¼ˆå¦‚ä½¿ç”¨TSBSå·¥å…·å¯¹æ¯”InfluxDBï¼‰æ¥çœ‹ï¼Œå…¶æ—¶åºç»„ä»¶åœ¨ç‰¹å®šåœºæ™¯ä¸‹å±•ç°å‡ºç«äº‰åŠ›ï¼š</p>
</li>
</ol>
<p>å†™å…¥æ€§èƒ½: é€šè¿‡ä¼˜åŒ–åˆ†åŒºç­–ç•¥ã€å¹¶è¡Œæ’å…¥ç­‰æ‰‹æ®µï¼Œåœ¨ç‰¹å®šé…ç½®ä¸‹å¯å®ç°å•æœºç™¾ä¸‡çº§ã€é›†ç¾¤åƒä¸‡çº§æ•°æ®ç‚¹/ç§’çš„å†™å…¥èƒ½åŠ›ã€‚
æŸ¥è¯¢æ€§èƒ½: åœ¨æ¶‰åŠå¤šç»´åº¦èšåˆã€è·¨è¡¨å…³è”ç­‰å¤æ‚æŸ¥è¯¢åœºæ™¯ä¸­ï¼Œå‡­å€Ÿæˆç†Ÿçš„SQLä¼˜åŒ–å™¨ä¸æ‰§è¡Œå¼•æ“ï¼Œæ€§èƒ½è¡¨ç°æ˜¾è‘—ä¼˜äºéƒ¨åˆ†åŸç”Ÿæ—¶åºæ•°æ®åº“ï¼Œå°¤å…¶é€‚åˆéœ€è¦å°†æ—¶åºæ•°æ®ä¸ä¸šåŠ¡æ•°æ®è¿›è¡Œæ·±åº¦æ•´åˆåˆ†æçš„åœºæ™¯ã€‚</p>
<p>ä¸‰ã€è¡Œä¸šåº”ç”¨ä¸å®è·µ
é‡‘ä»“æ—¶åºç»„ä»¶çš„èåˆæ¶æ„ä½¿å…¶åœ¨é‚£äº›æ—¢éœ€è¦å¤„ç†æµ·é‡æ—¶åºæ•°æ®æµï¼Œåˆéœ€è¦ä¸æ ¸å¿ƒä¸šåŠ¡ç³»ç»Ÿç´§å¯†é›†æˆçš„åœºæ™¯ä¸­æ‰¾åˆ°äº†ç”¨æ­¦ä¹‹åœ°ï¼Œå…¬å¼€æ¡ˆä¾‹åŒ…æ‹¬ï¼š</p>
<p>ç¦å»ºçœèˆ¹èˆ¶å®‰å…¨ç»¼åˆç®¡ç†å¹³å°: å¤„ç†æ²¿æµ·æ•°åä¸‡èˆ¹èˆ¶ç»ˆç«¯çš„GPSå®šä½æ—¶åºæ•°æ®ï¼ŒåŸºäºKESåˆ†ç‰‡ï¼ˆShardingï¼‰æ–¹æ¡ˆå®ç°æ—¥å³°å€¼äº¿çº§å†™å…¥ä¸ç™¾äº¿çº§å†å²æ•°æ®çš„æ¯«ç§’çº§åœ°ç†ç©ºé—´æŸ¥è¯¢ã€‚
å›½å®¶ç”µç½‘æ™ºèƒ½ç”µç½‘è°ƒåº¦ç³»ç»Ÿ: åœ¨å›½äº§åŒ–è¿ç§»é¡¹ç›®ä¸­ï¼Œæ”¯æ’‘é«˜é¢‘ã€å¯é çš„ç”µåŠ›æ•°æ®å½•å…¥ï¼Œå¹¶å®ç°ä¸å¤§é‡æ—¢æœ‰å…³ç³»å‹ä¸šåŠ¡æ•°æ®çš„æ··åˆå¤„ç†ä¸åˆ†æã€‚
æ™ºæ…§æ¸¯å£ï¼ˆå¦‚å¦é—¨æ¸¯ï¼‰ã€æ™ºèƒ½åˆ¶é€ å‚åŒº: è®°å½•è®¾å¤‡è½¨è¿¹ã€å·¥å†µæ—¶åºæ•°æ®ï¼Œå¹¶ä¸ç”Ÿäº§ç®¡ç†ç³»ç»Ÿã€è®¾å¤‡ç®¡ç†ç³»ç»Ÿè¿›è¡Œå®æ—¶å…³è”åˆ†æã€‚</p>
<p>å››ã€2026å¹´å›½äº§æ—¶åºæ•°æ®åº“é€‰å‹æ€è€ƒ
ä¼ä¸šåœ¨2026å¹´è¿›è¡Œæ—¶åºæ•°æ®åº“é€‰å‹æ—¶ï¼Œåº”è¶…è¶Šå¯¹å•ä¸€å³°å€¼æ€§èƒ½æŒ‡æ ‡çš„è¿‡åº¦å…³æ³¨ï¼Œä»æ›´å®è§‚çš„è§†è§’è¯„ä¼°ï¼š</p>
<p>æ•°æ®æ¶æ„å¤æ‚æ€§: å¦‚æœä¸šåŠ¡ä¸­æ—¶åºæ•°æ®ä¸å…³ç³»æ•°æ®ã€ç©ºé—´æ•°æ®ç­‰ç´§å¯†è€¦åˆï¼Œéœ€è¦é¢‘ç¹å…³è”åˆ†æï¼Œé‡‘ä»“çš„èåˆå¤šæ¨¡æ¶æ„å°†æä¾›æå¤§çš„ä¾¿åˆ©æ€§å’Œæ•´ä½“æ€§ä»·æ¯”ã€‚
é•¿æœŸè¿ç»´ä¸æ€»æ‹¥æœ‰æˆæœ¬ï¼ˆTCOï¼‰: è€ƒè™‘å¼•å…¥æ–°äº§å“å¸¦æ¥çš„å­¦ä¹ æˆæœ¬ã€è¿ç»´å¤æ‚åº¦ä»¥åŠç”Ÿæ€æ•´åˆæˆæœ¬ã€‚å¤ç”¨ç°æœ‰å…³ç³»å‹æ•°æ®åº“å›¢é˜Ÿçš„æŠ€èƒ½æ ˆå’Œå·¥å…·é“¾ï¼Œæ˜¯é‡‘ä»“æ–¹æ¡ˆçš„å¦ä¸€å¤§éšæ€§ä¼˜åŠ¿ã€‚</p>
<p>ç»“è®º
2026å¹´çš„å›½äº§æ—¶åºæ•°æ®åº“èµ›é“å·²è¿›å…¥"ç²¾è€•ç»†ä½œ"é˜¶æ®µã€‚ä»¥TDengineã€IoTDBã€DolphinDBä¸ºä»£è¡¨çš„ä¸“ä¸šæ—¶åºåº“åœ¨å„è‡ªä¼˜åŠ¿é¢†åŸŸæŒç»­æ·±åŒ–ã€‚</p>
<p>é‡‘ä»“æ—¶åºæ•°æ®åº“å‡­å€Ÿå…¶ç‹¬ç‰¹çš„èåˆå¤šæ¨¡æ¶æ„ï¼Œèµ°å‡ºäº†ä¸€æ¡å·®å¼‚åŒ–é“è·¯ã€‚å®ƒå¹¶é"ä¸‡èƒ½é’¥åŒ™"ï¼Œä½†å¯¹äºé‚£äº›ä¸šåŠ¡é€»è¾‘å¤æ‚ã€æ•°æ®å½¢æ€å¤šæ ·ã€ä¸”å¯¹äº‹åŠ¡ä¸€è‡´æ€§ä¸ç³»ç»Ÿæ•´åˆæœ‰é«˜è¦æ±‚çš„ä¼ä¸šçº§ç”¨æˆ·è€Œè¨€ï¼Œæä¾›äº†ä¸€ä¸ªèƒ½å¤Ÿå°†æ—¶åºæ•°æ®èƒ½åŠ›å¹³æ»‘ã€ç¨³å¥åœ°åµŒå…¥åˆ°ç°æœ‰ä¼ä¸šæ•°æ®æ ¸å¿ƒä¸­çš„ä¼˜ç§€é€‰æ‹©ï¼Œä½“ç°äº†å›½äº§åŸºç¡€è½¯ä»¶åœ¨æ¶æ„è®¾è®¡ä¸Šçš„æ·±åº¦æ€è€ƒä¸åŠ¡å®åˆ›æ–°ã€‚</p>
<p>æœªæ¥ï¼Œéšç€AI for Dataã€å®æ—¶æ™ºèƒ½åˆ†æçš„æ™®åŠï¼Œæ—¶åºæ•°æ®åº“çš„"æ™ºèƒ½"ä¸"èåˆ"èƒ½åŠ›å°†æ„ˆå‘å…³é”®ã€‚å¦‚ä½•æ›´å¥½åœ°å°†æ—¶åºå¤„ç†èƒ½åŠ›ä¸å¤šæ¨¡æ•°æ®ã€AIæ¡†æ¶ã€æµæ‰¹è®¡ç®—æ— ç¼ç»“åˆï¼Œå°†æ˜¯æ‰€æœ‰å‚å•†å…±åŒé¢ä¸´çš„ä¸‹ä¸€ä¸ªè¯¾é¢˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vuex æ ¸å¿ƒæ¦‚å¿µå…¨è§£æï¼šæ„å»ºä¼˜é›…çš„ Vue åº”ç”¨çŠ¶æ€ç®¡ç†]]></title>    <link>https://juejin.cn/post/7595841630676189235</link>    <guid>https://juejin.cn/post/7595841630676189235</guid>    <pubDate>2026-01-17T01:37:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595841630676189235" data-draft-id="7595847940620632114" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vuex æ ¸å¿ƒæ¦‚å¿µå…¨è§£æï¼šæ„å»ºä¼˜é›…çš„ Vue åº”ç”¨çŠ¶æ€ç®¡ç†"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2026-01-17T01:37:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åŒ—è¾°alk"/> <meta itemprop="url" content="https://juejin.cn/user/1772855673241352"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vuex æ ¸å¿ƒæ¦‚å¿µå…¨è§£æï¼šæ„å»ºä¼˜é›…çš„ Vue åº”ç”¨çŠ¶æ€ç®¡ç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1772855673241352/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åŒ—è¾°alk
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T01:37:31.000Z" title="Sat Jan 17 2026 01:37:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Vuex æ ¸å¿ƒæ¦‚å¿µå…¨è§£æï¼šæ„å»ºä¼˜é›…çš„ Vue åº”ç”¨çŠ¶æ€ç®¡ç†</h2>
<p>ä½ æ˜¯å¦æ›¾åœ¨ Vue é¡¹ç›®ä¸­é‡åˆ°è¿‡è¿™æ ·çš„å›°æ‰°ï¼š</p>
<ul>
<li>â€¢ ç»„ä»¶é—´æ•°æ®ä¼ é€’åƒâ€œå‡»é¼“ä¼ èŠ±â€ï¼Œå±‚å±‚ props é€ä¼ ä»¤äººå¤´ç–¼</li>
<li>â€¢ å…„å¼Ÿç»„ä»¶é€šä¿¡éœ€è¦å€ŸåŠ©çˆ¶ç»„ä»¶åšâ€œä¸­è½¬ç«™â€</li>
<li>â€¢ å¤šä¸ªç»„ä»¶ä¾èµ–åŒä¸€ä»½æ•°æ®ï¼Œä¸€å¤„ä¿®æ”¹å¤„å¤„éœ€è¦åŒæ­¥</li>
</ul>
<p>ä»Šå¤©æˆ‘ä»¬å°±æ¥èŠèŠ Vue çš„å®˜æ–¹çŠ¶æ€ç®¡ç†åº“â€”â€”Vuexï¼Œå¸®ä½ å½»åº•è§£å†³è¿™äº›ç—›ç‚¹ï¼</p>
<h3 data-id="heading-1">ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ Vuexï¼Ÿ</h3>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæ¯ä¸ªç»„ä»¶éƒ½æœ‰è‡ªå·±çš„â€œå°è´¦æœ¬â€ï¼Œå½“åº”ç”¨å¤æ‚æ—¶ï¼Œæ•°æ®å°±åƒæ•£è½çš„çç ï¼Œéš¾ä»¥ç»Ÿä¸€ç®¡ç†ã€‚Vuex å°±æ˜¯ä¸€ä¸ªâ€œä¸­å¤®è´¦æœ¬â€ï¼ŒæŠŠæ•°æ®é›†ä¸­å­˜å‚¨ï¼Œè®©çŠ¶æ€å˜åŒ–å˜å¾—å¯é¢„æµ‹ã€å¯è¿½è¸ªã€‚</p>
<h3 data-id="heading-2">äºŒã€Vuex äº”å¤§æ ¸å¿ƒæ¦‚å¿µè¯¦è§£</h3>
<h4 data-id="heading-3">1.Â <strong>Stateï¼ˆçŠ¶æ€ï¼‰â€”â€” æ•°æ®ä»“åº“</strong></h4>
<p>State æ˜¯ Vuex çš„â€œæ•°æ®åº“â€ï¼Œå­˜å‚¨æ‰€æœ‰éœ€è¦å…±äº«çš„æ•°æ®ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">const</span>Â <span class="hljs-variable constant_">storeÂ </span>=Â <span class="hljs-keyword">new</span>Â Vuex.<span class="hljs-title function_ invoke__">Store</span>({
<span class="hljs-attr">Â Â state</span>:Â {
<span class="hljs-attr">Â Â Â Â user</span>:Â {
<span class="hljs-attr">Â Â Â Â Â Â name</span>:Â <span class="hljs-string">'å°æ˜'</span>,
<span class="hljs-attr">Â Â Â Â Â Â age</span>:Â <span class="hljs-number">25</span>
Â Â Â Â },
<span class="hljs-attr">Â Â Â Â cart</span>:Â []
Â Â }
})
</code></pre>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>â€¢ å“åº”å¼ï¼šState å˜åŒ–ï¼Œä¾èµ–å®ƒçš„ç»„ä»¶è‡ªåŠ¨æ›´æ–°</li>
<li>â€¢ å•ä¸€æ•°æ®æºï¼šæ•´ä¸ªåº”ç”¨åªæœ‰ä¸€ä¸ª store</li>
<li>â€¢ åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ï¼š<code>this.$store.state.user</code></li>
</ul>
<h4 data-id="heading-4">2.Â <strong>Gettersï¼ˆè®¡ç®—å±æ€§ï¼‰â€”â€” æ•°æ®çš„â€œåŠ å·¥å‚â€</strong></h4>
<p>Getters å°±åƒ Vue ä¸­çš„ computedï¼Œç”¨äºä» state æ´¾ç”Ÿå‡ºæ–°æ•°æ®ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-attr">getters</span>:Â {
Â Â <span class="hljs-comment">//Â è·å–è´­ç‰©è½¦å•†å“æ€»æ•°</span>
Â Â <span class="hljs-attr">cartItemCount</span>:Â <span class="hljs-function"><span class="hljs-params">state</span>Â =&gt;</span>Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â state.<span class="hljs-property">cart</span>.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">total,Â item</span>)Â =&gt;</span>Â totalÂ +Â item.<span class="hljs-property">quantity</span>,Â <span class="hljs-number">0</span>)
Â Â },
Â Â 
Â Â <span class="hljs-comment">//Â è·å–æŠ˜æ‰£åçš„ä»·æ ¼</span>
Â Â <span class="hljs-attr">discountedPrice</span>:Â <span class="hljs-function">(<span class="hljs-params">state</span>)Â =&gt;</span>Â <span class="hljs-function">(<span class="hljs-params">productId</span>)Â =&gt;</span>Â {
Â Â Â Â <span class="hljs-keyword">const</span>Â productÂ =Â state.<span class="hljs-property">products</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">p</span>Â =&gt;</span>Â p.<span class="hljs-property">id</span>Â ===Â productId)
Â Â Â Â <span class="hljs-keyword">return</span>Â product.<span class="hljs-property">price</span>Â *Â <span class="hljs-number">0.8</span>
Â Â }
}
</code></pre>
<p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>â€¢ æ•°æ®è¿‡æ»¤ã€æ ¼å¼åŒ–</li>
<li>â€¢ å¤æ‚è®¡ç®—é€»è¾‘å°è£…</li>
<li>â€¢ ç»„ä»¶ä¸­è°ƒç”¨ï¼š<code>this.$store.getters.cartItemCount</code></li>
</ul>
<h4 data-id="heading-5">3.Â <strong>Mutationsï¼ˆå˜æ›´ï¼‰â€”â€” å”¯ä¸€çš„çŠ¶æ€ä¿®æ”¹è€…</strong></h4>
<p>Mutations æ˜¯ä¿®æ”¹ state çš„<strong>å”¯ä¸€é€”å¾„</strong>ï¼Œæ¯ä¸ª mutation éƒ½æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„â€œäº‹ä»¶ç±»å‹â€å’Œä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">mutations:Â {
Â Â <span class="hljs-comment">//Â æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦</span>
Â Â <span class="hljs-built_in">ADD_TO_CART</span>(state,Â product)Â {
Â Â Â Â constÂ existingItemÂ =Â state<span class="hljs-selector-class">.cart</span><span class="hljs-selector-class">.find</span>(itemÂ =&gt;Â item.idÂ ===Â product.id)
Â Â Â Â ifÂ (existingItem)Â {
Â Â Â Â Â Â existingItem<span class="hljs-selector-class">.quantity</span>++
Â Â Â Â }Â elseÂ {
Â Â Â Â Â Â state<span class="hljs-selector-class">.cart</span><span class="hljs-selector-class">.push</span>({Â ...product,Â quantity:Â <span class="hljs-number">1</span>Â })
Â Â Â Â }
Â Â },
Â Â 
Â Â <span class="hljs-comment">//Â æ¸…ç©ºè´­ç‰©è½¦</span>
Â Â <span class="hljs-built_in">CLEAR_CART</span>(state)Â {
Â Â Â Â state<span class="hljs-selector-class">.cart</span>Â =Â <span class="hljs-selector-attr">[]</span>
Â Â }
}
</code></pre>
<p><strong>é‡è¦åŸåˆ™ï¼š</strong></p>
<ul>
<li>â€¢ å¿…é¡»æ˜¯åŒæ­¥å‡½æ•°</li>
<li>â€¢ é€šè¿‡Â <code>store.commit('mutationå', payload)</code>Â è°ƒç”¨</li>
<li>â€¢ è®©æ¯æ¬¡çŠ¶æ€å˜åŒ–éƒ½å¯è¿½è¸ª</li>
</ul>
<h4 data-id="heading-6">4.Â <strong>Actionsï¼ˆåŠ¨ä½œï¼‰â€”â€” å¤„ç†å¼‚æ­¥æ“ä½œçš„â€œæŒ‡æŒ¥å®˜â€</strong></h4>
<p>Actions å¯ä»¥åŒ…å«ä»»æ„å¼‚æ­¥æ“ä½œï¼Œæœ€ç»ˆé€šè¿‡æäº¤ mutation æ¥ä¿®æ”¹çŠ¶æ€ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-attr">actions</span>:Â {
Â Â <span class="hljs-comment">//Â å¼‚æ­¥è·å–ç”¨æˆ·ä¿¡æ¯</span>
Â Â <span class="hljs-keyword">async</span>Â <span class="hljs-title function_">fetchUser</span>(<span class="hljs-params">{Â commitÂ },Â userId</span>)Â {
Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â responseÂ =Â <span class="hljs-keyword">await</span>Â api.<span class="hljs-title function_">getUser</span>(userId)
Â Â Â Â Â Â <span class="hljs-title function_">commit</span>(<span class="hljs-string">'SET_USER'</span>,Â response.<span class="hljs-property">data</span>)Â <span class="hljs-comment">//Â è°ƒç”¨Â mutation</span>
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â response.<span class="hljs-property">data</span>
Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (error)Â {
Â Â Â Â Â Â <span class="hljs-title function_">commit</span>(<span class="hljs-string">'SET_ERROR'</span>,Â error.<span class="hljs-property">message</span>)
Â Â Â Â Â Â <span class="hljs-keyword">throw</span>Â error
Â Â Â Â }
Â Â },
Â Â 
Â Â <span class="hljs-comment">//Â ç»„åˆå¤šä¸ªÂ mutation</span>
Â Â <span class="hljs-title function_">checkout</span>(<span class="hljs-params">{Â commit,Â stateÂ }</span>)Â {
Â Â Â Â <span class="hljs-comment">//Â ä¿å­˜è®¢å•</span>
Â Â Â Â <span class="hljs-title function_">commit</span>(<span class="hljs-string">'CREATE_ORDER'</span>,Â state.<span class="hljs-property">cart</span>)
Â Â Â Â <span class="hljs-comment">//Â æ¸…ç©ºè´­ç‰©è½¦</span>
Â Â Â Â <span class="hljs-title function_">commit</span>(<span class="hljs-string">'CLEAR_CART'</span>)
Â Â Â Â <span class="hljs-comment">//Â æ˜¾ç¤ºæˆåŠŸæç¤º</span>
Â Â Â Â <span class="hljs-title function_">commit</span>(<span class="hljs-string">'SHOW_MESSAGE'</span>,Â <span class="hljs-string">'è®¢å•æäº¤æˆåŠŸï¼'</span>)
Â Â }
}
</code></pre>
<p><strong>ä¸ Mutation çš„åŒºåˆ«ï¼š</strong></p>
<ul>
<li>â€¢ Action æäº¤çš„æ˜¯ mutationï¼Œè€Œä¸æ˜¯ç›´æ¥å˜æ›´çŠ¶æ€</li>
<li>â€¢ Action å¯ä»¥åŒ…å«ä»»æ„å¼‚æ­¥æ“ä½œ</li>
<li>â€¢ é€šè¿‡Â <code>store.dispatch('actionå', payload)</code>Â è°ƒç”¨</li>
</ul>
<h4 data-id="heading-7">5.Â <strong>Modulesï¼ˆæ¨¡å—ï¼‰â€”â€” å¤§å‹åº”ç”¨çš„â€œåˆ†æ²»ç­–ç•¥â€</strong></h4>
<p>å½“åº”ç”¨å¤æ‚æ—¶ï¼Œå¯ä»¥å°† store åˆ†å‰²æˆæ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—æ‹¥æœ‰è‡ªå·±çš„ stateã€mutationsã€actionsã€gettersã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">const</span>Â <span class="hljs-variable constant_">userModuleÂ </span>=Â {
Â Â namespaced:Â <span class="hljs-literal">true</span>,Â <span class="hljs-comment">//Â å¼€å¯å‘½åç©ºé—´</span>
Â Â state:Â ()Â =&gt;Â ({Â userInfo:Â <span class="hljs-literal">null</span>Â }),
Â Â mutations:Â {Â <span class="hljs-comment">/*Â ...Â */</span>Â },
Â Â actions:Â {Â <span class="hljs-comment">/*Â ...Â */</span>Â }
}

<span class="hljs-keyword">const</span>Â <span class="hljs-variable constant_">productModuleÂ </span>=Â {
Â Â namespaced:Â <span class="hljs-literal">true</span>,
Â Â state:Â ()Â =&gt;Â ({Â products:Â []Â }),
Â Â mutations:Â {Â <span class="hljs-comment">/*Â ...Â */</span>Â }
}

<span class="hljs-keyword">const</span>Â <span class="hljs-variable constant_">storeÂ </span>=Â <span class="hljs-keyword">new</span>Â Vuex.<span class="hljs-title function_ invoke__">Store</span>({
<span class="hljs-attr">Â Â modules</span>:Â {
<span class="hljs-attr">Â Â Â Â user</span>:Â userModule,
<span class="hljs-attr">Â Â Â Â product</span>:Â productModule
Â Â }
})
</code></pre>
<p><strong>æ¨¡å—åŒ–çš„å¥½å¤„ï¼š</strong></p>
<ul>
<li>â€¢ é¿å… state å¯¹è±¡è¿‡äºè‡ƒè‚¿</li>
<li>â€¢ è®©ç›¸å…³åŠŸèƒ½ç»„ç»‡åœ¨ä¸€èµ·</li>
<li>â€¢ è°ƒç”¨æ–¹å¼ï¼š<code>this.$store.dispatch('user/login', credentials)</code></li>
</ul>
<h3 data-id="heading-8">ä¸‰ã€å®æˆ˜ï¼šè´­ç‰©è½¦å®Œæ•´ç¤ºä¾‹</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//Â store.js</span>
<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Vuex</span>.<span class="hljs-title class_">Store</span>({
Â Â <span class="hljs-attr">state</span>:Â {
Â Â Â Â <span class="hljs-attr">cart</span>:Â [],
Â Â Â Â <span class="hljs-attr">products</span>:Â []
Â Â },
Â Â 
Â Â <span class="hljs-attr">getters</span>:Â {
Â Â Â Â <span class="hljs-attr">totalPrice</span>:Â <span class="hljs-function"><span class="hljs-params">state</span>Â =&gt;</span>Â {
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â state.<span class="hljs-property">cart</span>.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">sum,Â item</span>)Â =&gt;</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â sumÂ +Â (item.<span class="hljs-property">price</span>Â *Â item.<span class="hljs-property">quantity</span>)
Â Â Â Â Â Â },Â <span class="hljs-number">0</span>)
Â Â Â Â }
Â Â },
Â Â 
Â Â <span class="hljs-attr">mutations</span>:Â {
Â Â Â Â <span class="hljs-title function_">ADD_ITEM</span>(<span class="hljs-params">state,Â product</span>)Â {
Â Â Â Â Â Â <span class="hljs-comment">//Â ...Â æ·»åŠ å•†å“é€»è¾‘</span>
Â Â Â Â }
Â Â },
Â Â 
Â Â <span class="hljs-attr">actions</span>:Â {
Â Â Â Â <span class="hljs-keyword">async</span>Â <span class="hljs-title function_">loadProducts</span>(<span class="hljs-params">{Â commitÂ }</span>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â productsÂ =Â <span class="hljs-keyword">await</span>Â api.<span class="hljs-title function_">getProducts</span>()
Â Â Â Â Â Â <span class="hljs-title function_">commit</span>(<span class="hljs-string">'SET_PRODUCTS'</span>,Â products)
Â Â Â Â }
Â Â }
})
</code></pre>
<h3 data-id="heading-9">å››ã€æœ€ä½³å®è·µå»ºè®®</h3>
<ol>
<li>
<p>1.Â <strong>éµå¾ªå•å‘æ•°æ®æµ</strong>ï¼š</p>
<pre><code class="hljs">ç»„ä»¶Â â†’Â ActionsÂ â†’Â MutationsÂ â†’Â StateÂ â†’Â ç»„ä»¶æ›´æ–°
</code></pre>
</li>
<li>
<p>2.Â <strong>åˆç†åˆ’åˆ†æ¨¡å—</strong>ï¼š</p>
</li>
<li>
<ul>
<li>â€¢ æŒ‰åŠŸèƒ½é¢†åŸŸåˆ’åˆ†ï¼ˆuserã€productã€orderç­‰ï¼‰</li>
<li>â€¢ å¤§å‹é¡¹ç›®è€ƒè™‘åŠ¨æ€æ³¨å†Œæ¨¡å—</li>
</ul>
</li>
<li>
<p>3.Â <strong>ä½¿ç”¨è¾…åŠ©å‡½æ•°</strong>ç®€åŒ–ä»£ç ï¼š</p>
<pre><code class="hljs language-css" lang="css">importÂ {Â mapState,Â mapActionsÂ }Â <span class="hljs-selector-tag">from</span>Â 'vuex'

exportÂ defaultÂ {
Â Â computed:Â {
Â Â Â Â ..<span class="hljs-selector-class">.mapState</span>(<span class="hljs-selector-attr">[<span class="hljs-string">'user'</span>,Â <span class="hljs-string">'cart'</span>]</span>),
Â Â Â Â ..<span class="hljs-selector-class">.mapGetters</span>(<span class="hljs-selector-attr">[<span class="hljs-string">'totalPrice'</span>]</span>)
Â Â },
Â Â methods:Â {
Â Â Â Â ..<span class="hljs-selector-class">.mapActions</span>(<span class="hljs-selector-attr">[<span class="hljs-string">'fetchUser'</span>,Â <span class="hljs-string">'addToCart'</span>]</span>)
Â Â }
}
</code></pre>
</li>
<li>
<p>4.Â <strong>TypeScript æ”¯æŒ</strong>ï¼š<br/>
Vuex 4 å¯¹ TypeScript æœ‰æ›´å¥½çš„ç±»å‹æ”¯æŒ</p>
</li>
</ol>
<h3 data-id="heading-10">äº”ã€æ€»ç»“</h3>
<p>Vuex çš„äº”å‘˜å¤§å°†å„å¸å…¶èŒï¼š</p>
<ul>
<li>â€¢Â <strong>State</strong>ï¼šæ•°æ®å­˜å‚¨ä¸­å¿ƒ</li>
<li>â€¢Â <strong>Getters</strong>ï¼šæ•°æ®çš„è®¡ç®—åŠ å·¥</li>
<li>â€¢Â <strong>Mutations</strong>ï¼šåŒæ­¥ä¿®æ”¹çŠ¶æ€</li>
<li>â€¢Â <strong>Actions</strong>ï¼šå¤„ç†å¼‚æ­¥å’Œå¤æ‚é€»è¾‘</li>
<li>â€¢Â <strong>Modules</strong>ï¼šæ¨¡å—åŒ–ç®¡ç†</li>
</ul>
<p>è®°ä½è¿™ä¸ªç®€å•çš„æ¯”å–»ï¼šState æ˜¯ä»“åº“ï¼ŒGetters æ˜¯åŒ…è£…éƒ¨ï¼ŒMutations æ˜¯ä»“åº“ç®¡ç†å‘˜ï¼ŒActions æ˜¯é‡‡è´­å‘˜ï¼ŒModules æ˜¯åˆ†å…¬å¸ã€‚</p>
<p>Vuex çš„å­¦ä¹ æ›²çº¿å¯èƒ½æœ‰ç‚¹é™¡å³­ï¼Œä½†ä¸€æ—¦æŒæ¡ï¼Œä½ å°†æ‹¥æœ‰ç®¡ç†å¤æ‚åº”ç”¨çŠ¶æ€çš„è¶…èƒ½åŠ›ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆä½ çš„ Prompt è¶Šå†™è¶Šé•¿ï¼Œæ•ˆæœå´è¶Šæ¥è¶Šå·®ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7595808703074074650</link>    <guid>https://juejin.cn/post/7595808703074074650</guid>    <pubDate>2026-01-17T05:10:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595808703074074650" data-draft-id="7595841630676795443" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆä½ çš„ Prompt è¶Šå†™è¶Šé•¿ï¼Œæ•ˆæœå´è¶Šæ¥è¶Šå·®ï¼Ÿ"/> <meta itemprop="keywords" content="AIGC,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-17T05:10:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¥¿é™µ"/> <meta itemprop="url" content="https://juejin.cn/user/4353721774379054"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆä½ çš„ Prompt è¶Šå†™è¶Šé•¿ï¼Œæ•ˆæœå´è¶Šæ¥è¶Šå·®ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4353721774379054/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¥¿é™µ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T05:10:05.000Z" title="Sat Jan 17 2026 05:10:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    32
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰åœ¨æ—©æœŸé˜¶æ®µä¸»è¦ä»¥å¯¹è¯æœºå™¨äººçš„å½¢å¼å‡ºç°ï¼Œç”¨æˆ·é€šè¿‡è‡ªç„¶è¯­è¨€å‘æ¨¡å‹æé—®ï¼Œæ¨¡å‹è¿”å›ä¸€æ®µçœ‹ä¼¼æ™ºèƒ½çš„æ–‡æœ¬ç»“æœã€‚è¿™ä¸€é˜¶æ®µï¼Œæ¨¡å‹èƒ½åŠ›çš„å‘æŒ¥é«˜åº¦ä¾èµ–ç”¨æˆ·å¦‚ä½•æé—®ï¼ŒåŒä¸€ä¸ªé—®é¢˜ï¼Œç”¨ä¸åŒçš„æè¿°æ–¹å¼ï¼Œå¾€å¾€ä¼šå¾—åˆ°è´¨é‡å·®å¼‚å·¨å¤§çš„ç»“æœã€‚</p>
<p>åœ¨è¿™ç§èƒŒæ™¯ä¸‹ï¼Œ<code>æç¤ºè¯å·¥ç¨‹</code>ä½œä¸ºä¸€é—¨é¢å‘å¤§è¯­è¨€æ¨¡å‹çš„è¾“å…¥è®¾è®¡æ–¹æ³•è®ºé€æ¸æˆå‹ï¼Œæœ¬ç¯‡æ–‡ç« ä¸»è¦å¸®åŠ©å¤§å®¶å¿«é€Ÿäº†è§£<code>æç¤ºè¯å·¥ç¨‹</code>çš„æœ¬è´¨ä»¥åŠåœ¨ä¹¦å†™æŠ€å·§ã€‚</p>
<h2 data-id="heading-1">ä»€ä¹ˆæ˜¯æç¤ºè¯å·¥ç¨‹ï¼Ÿ</h2>
<p>æç¤ºè¯å·¥ç¨‹çš„æœ¬è´¨å°±æ˜¯<strong>åœ¨æœ‰é™ä¸Šä¸‹æ–‡çª—å£å†…ï¼Œæœ€å¤§åŒ–æ¨¡å‹è¾“å‡ºçš„ç¡®å®šæ€§ä¸å¯ç”¨æ€§ï¼Œå‡å°‘æ¨¡å‹è‡ªç”±å‘æŒ¥çš„ç©ºé—´</strong>ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æä¾›ä¸€ç§æç¤ºè¯ä¹¦å†™èŒƒå¼æ¥ç¡®ä¿å¤§æ¨¡å‹èƒ½å¤Ÿç²¾å‡†åœ°æŒ‰ç…§ç”¨æˆ·çš„è¦æ±‚è¾“å‡ºé«˜è´¨é‡çš„å†…å®¹ã€‚</p>
<p><strong>âŒ å·®æç¤ºè¯</strong></p>
<pre><code class="hljs language-jsx" lang="jsx">å¸®æˆ‘åšä¸€ä¸ªä¸ªäººå¾…åŠæ¸…å•é¡µé¢
</code></pre>
<p>å¯¹äºè¿™æ®µæç¤ºè¯ï¼ŒAI ä¸çŸ¥é“ç”¨ä»€ä¹ˆæŠ€æœ¯ã€ä»€ä¹ˆé£æ ¼ã€è¦å“ªäº›åŠŸèƒ½ã€æœ‰ä»€ä¹ˆé™åˆ¶ã€‚ç»“æœå°±æ˜¯ AI è‡ªç”±å‘æŒ¥ï¼Œç”Ÿæˆçš„ä»£ç å’Œé¡¹ç›®è§„èŒƒä¸ç¬¦åˆã€‚</p>
<p><strong>âœ… å¥½æç¤ºè¯</strong></p>
<pre><code class="hljs language-jsx" lang="jsx">## è§’è‰²
ä½ æ˜¯ä¸€ä¸ªæ“…é•¿ <span class="hljs-title class_">React</span> å’Œç”¨æˆ·ä½“éªŒè®¾è®¡çš„å‰ç«¯å¼€å‘è€…ã€‚

## èƒŒæ™¯
æˆ‘éœ€è¦åšä¸€ä¸ªä¸ªäººå¾…åŠæ¸…å•ç½‘é¡µï¼Œç”¨æ¥è®°å½•æ¯å¤©çš„å¾…åŠä»»åŠ¡ï¼Œç°åœ¨å·²ç»å®Œæ•´åŸºæœ¬åŠŸèƒ½çš„å¼€å‘ã€‚

## ä»»åŠ¡
å®ç°ä»»åŠ¡çš„<span class="hljs-string">"æ‹–æ‹½æ’åº"</span>åŠŸèƒ½ï¼Œè®©ç”¨æˆ·å¯ä»¥é€šè¿‡æ‹–æ‹½è°ƒæ•´ä»»åŠ¡é¡ºåºã€‚

## è¦æ±‚
- æ‹–æ‹½æ—¶è¢«æ‹–åŠ¨çš„ä»»åŠ¡åŠé€æ˜
- æ”¾ç½®ä½ç½®æœ‰æ˜æ˜¾çš„è§†è§‰æŒ‡ç¤ºçº¿
- æ‹–æ‹½å®Œæˆåé¡ºåºç«‹å³æ›´æ–°

## çº¦æŸ
- æŠ€æœ¯æ ˆä¸º <span class="hljs-title class_">React</span> + <span class="hljs-title class_">TypeScript</span> + <span class="hljs-title class_">Tailwind</span> <span class="hljs-variable constant_">CSS</span>
- ä¸ä½¿ç”¨ç¬¬ä¸‰æ–¹æ‹–æ‹½åº“ï¼ˆå¦‚ react-beautiful-dndï¼‰
- ç”¨åŸç”Ÿ <span class="hljs-title class_">HTML5</span> æ‹–æ‹½ <span class="hljs-variable constant_">API</span>
- ä»£ç è¦æœ‰è¯¦ç»†æ³¨é‡Šï¼Œæˆ‘æ˜¯æ‹–æ‹½ <span class="hljs-variable constant_">API</span> çš„åˆå­¦è€…

## è¾“å‡ºæ ¼å¼
å®Œæ•´çš„ <span class="hljs-title class_">React</span> ç»„ä»¶ä»£ç ï¼ŒåŒ…å«ï¼š
<span class="hljs-number">1.</span> ç»„ä»¶æ–‡ä»¶ï¼ˆ<span class="hljs-title class_">TypeScript</span>ï¼‰
<span class="hljs-number">2.</span> å…³é”®é€»è¾‘çš„ä¸­æ–‡æ³¨é‡Š
<span class="hljs-number">3.</span> ç®€å•çš„ä½¿ç”¨è¯´æ˜
</code></pre>
<h2 data-id="heading-2">æç¤ºè¯å¸¸è§é—®é¢˜</h2>
<p>åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œæç¤ºè¯çš„è´¨é‡å‚å·®ä¸é½ï¼Œä»¥ä¸‹æ˜¯å‡ ç±»æœ€å¸¸è§çš„é—®é¢˜åŠå…¶æœ¬è´¨åŸå› ã€‚</p>
<h3 data-id="heading-3">ä¿¡æ¯é‡è¿‡å¤š</h3>
<p>æˆ‘æƒ³è®© AI å¸®æˆ‘åšä¸€ä¸ªå¾…åŠæ¸…å•åº”ç”¨ï¼Œäºæ˜¯å°†æ‰€æœ‰æƒ³æ³•ä¸€æ¬¡æ€§åˆ—å‡ºï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx">å¸®æˆ‘åšä¸€ä¸ªå¾…åŠæ¸…å•åº”ç”¨ï¼Œè¦æœ‰æ·»åŠ ä»»åŠ¡ã€åˆ é™¤ä»»åŠ¡ã€ç¼–è¾‘ä»»åŠ¡ã€
æ ‡è®°å®Œæˆã€è®¾ç½®ä¼˜å…ˆçº§ã€è®¾ç½®æˆªæ­¢æ—¥æœŸã€åˆ†ç±»æ ‡ç­¾ã€æœç´¢åŠŸèƒ½ã€
æ•°æ®ç»Ÿè®¡ã€å¯¼å‡ºåŠŸèƒ½ï¼Œè¿˜è¦æœ‰æš—é»‘æ¨¡å¼ï¼Œæœ€å¥½èƒ½åŒæ­¥åˆ°äº‘ç«¯ï¼Œ
æ”¯æŒå¤šè®¾å¤‡ä½¿ç”¨ï¼Œç•Œé¢è¦å¥½çœ‹ï¼Œç”¨ <span class="hljs-title class_">React</span> å†™ï¼Œè¦æœ‰åŠ¨ç”»æ•ˆæœã€‚
</code></pre>
<p><strong>é—®é¢˜æœ¬è´¨</strong>ï¼šæ— ç»“æ„ã€æ— é‡ç‚¹ã€‚AI å¯èƒ½ä¼šå¿½ç•¥å…³é”®ä¿¡æ¯ï¼Œè¾“å‡ºä¸æŸäº›è¦æ±‚å†²çªã€‚</p>
<h3 data-id="heading-4">ä¿¡æ¯é‡å¤ªå°‘</h3>
<p>æˆ‘æƒ³è®© AI å¸®æˆ‘å†™ä¸ªæŒ‰é’®ç»„ä»¶ï¼Œåªæœ‰ä¸€å¥éœ€æ±‚ï¼Œæ²¡æœ‰ä»»ä½•èƒŒæ™¯ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx">å¸®æˆ‘å†™ä¸€ä¸ªæŒ‰é’®ç»„ä»¶
</code></pre>
<p><strong>é—®é¢˜æœ¬è´¨</strong>ï¼šç¼ºå°‘ä¸Šä¸‹æ–‡ã€‚ä¸Šä¸‹æ–‡å¯èƒ½æ˜¯ï¼š</p>
<ul>
<li>é¡¹ç›®çš„æŠ€æœ¯æ ˆ</li>
<li>æŒ‰é’®éœ€è¦çš„åŠŸèƒ½</li>
<li>æœŸæœ›çš„æ ·å¼é£æ ¼</li>
</ul>
<p>æœ€ç»ˆ AI åªèƒ½ç»™ä¸€ä¸ªé€šç”¨çš„ç»“æœã€‚</p>
<h3 data-id="heading-5">æ²¡æœ‰ç›®æ ‡</h3>
<p>æˆ‘æƒ³è®© AI å¸®æˆ‘ä¼˜åŒ–ä»£ç ï¼Œä½†ä¸ç»™ä¼˜åŒ–ç›®æ ‡ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx">å¸®æˆ‘ä¼˜åŒ–ä¸€ä¸‹è¿™æ®µä»£ç ï¼š
[ç²˜è´´äº†ä¸€æ®µä»£ç ]
</code></pre>
<p><strong>é—®é¢˜æœ¬è´¨</strong>ï¼šåªæœ‰åŠ¨ä½œï¼Œæ²¡æœ‰ç»“æœã€‚ä¼˜åŒ–æŒ‡ä»£ä¸æ˜ç¡®â€”â€”æ˜¯ä½“ç§¯ã€æ€§èƒ½è¿˜æ˜¯å¯è¯»æ€§ï¼Ÿæœ€ç»ˆè¾“å‡ºçš„ç»“æœå¿…ç„¶ä¸ç¬¦åˆé¢„æœŸã€‚</p>
<h3 data-id="heading-6">æ²¡æœ‰çº¦æŸ</h3>
<p>æˆ‘æƒ³è®© AI å¸®æˆ‘å†™ä¸€ä¸ªè¾“å…¥æ¡†ç»„ä»¶ï¼Œä½†æ˜¯æ²¡æœ‰æ·»åŠ ç›¸å…³çº¦æŸï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx">å¸®æˆ‘å†™ä¸€ä¸ªè¾“å…¥æ¡†ç»„ä»¶ã€‚

æŠ€æœ¯æ ˆï¼š<span class="hljs-title class_">React</span> + <span class="hljs-title class_">TypeScript</span> + <span class="hljs-variable constant_">SCSS</span>
</code></pre>
<p><strong>é—®é¢˜æœ¬è´¨</strong>ï¼šAI å®¹æ˜“å¼•å…¥é¢å¤–çš„å‡è®¾ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>ä½¿ç”¨ä¸å…¼å®¹çš„ ui ç»„ä»¶åº“ï¼Œä¾‹å¦‚ antdã€‚</li>
<li>ä½¿ç”¨å¤æ‚çš„çŠ¶æ€ç®¡ç†æœºåˆ¶ã€‚</li>
</ul>
<p>å¯¼è‡´æœ€ç»ˆè¾“å‡º<strong>ä¸å¯æ§</strong>ï¼Œéšæ€§å¼•å…¥é”™è¯¯å‡è®¾ã€‚</p>
<h2 data-id="heading-7">æç¤ºè¯æ¨¡æ¿</h2>
<p>äº†è§£äº†å¸¸è§é—®é¢˜åï¼Œæˆ‘ä»¬éœ€è¦ä¸€å¥—ç»“æ„åŒ–çš„æ–¹æ³•æ¥é¿å…å®ƒä»¬ã€‚è¿™å°±æ˜¯æç¤ºè¯æ¨¡æ¿çš„ä»·å€¼æ‰€åœ¨ã€‚</p>
<h3 data-id="heading-8">æç¤ºè¯çš„å›°æ‰°</h3>
<p>æˆ‘ä»¬ç°åœ¨çŸ¥é“åœ¨ä½¿ç”¨ AI æ—¶ï¼Œæä¾›çš„ä¸Šä¸‹æ–‡è¶Šæ¸…æ™°ï¼ŒAI ç»™å‡ºçš„å›ç­”å°±ä¼šè¶Šç¬¦åˆé¢„æœŸã€‚ä½†æ˜¯æ¯æ¬¡å†™æç¤ºè¯çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¤§æ¦‚ç‡è¿˜æ˜¯ä¼šé™·å…¥è¿™æ ·çš„çŠ¶æ€ï¼š</p>
<blockquote>
<p>æˆ‘è¦å…ˆç»™ AI æŒ‡å®šä¸€ä¸ªè§’è‰²ï¼Œå‘Šè¯‰ä»–èƒŒæ™¯å’Œä»»åŠ¡ï¼Œè¿˜æœ‰çº¦æŸã€è¦æ±‚ã€æŠ€æœ¯æ ˆâ€¦â€¦çº¦æŸè¦åŒ…å«ä»€ä¹ˆå†…å®¹ï¼Ÿè¦æ±‚è¦å†™ä»€ä¹ˆï¼ŸæŠ€æœ¯æ ˆè¦æ”¾åˆ°å“ªé‡Œï¼Ÿ</p>
</blockquote>
<p>è¿™ä¼šç»™ AI ä½¿ç”¨è€…å¸¦æ¥å¾ˆå¤§çš„è®¤çŸ¥è´Ÿæ‹…ï¼Œæˆ‘ä»¬åŒæ—¶è¦æ€è€ƒ"è¯´ä»€ä¹ˆ"å’Œ"æ€ä¹ˆè¯´"ã€‚è€Œæ¨¡æ¿çš„ä»·å€¼ï¼Œå°±æ˜¯<strong>æŠŠ"æ€ä¹ˆè¯´"å˜æˆå›ºå®šæ ¼å¼ï¼Œè®©ä½ ä¸“æ³¨äº"è¯´ä»€ä¹ˆ"</strong>ã€‚</p>
<p>è¿™ä¸å‰ç«¯çš„å¼€å‘æ¡†æ¶ï¼ˆReact/Vueï¼‰å¾ˆç±»ä¼¼ï¼šåœ¨æ²¡æœ‰æ¡†æ¶ä¹‹å‰ï¼Œå¼€å‘è€…æ—¢è¦å…³æ³¨ä¸šåŠ¡ï¼ŒåŒæ—¶è¿˜éœ€è¦å…³æ³¨ DOM æ›´æ–°åŠæ€§èƒ½é—®é¢˜ï¼›éšç€æ¡†æ¶çš„æ¨å‡ºï¼Œå‰ç«¯å¼€å‘è€…èƒ½æŠŠæ›´å¤šçš„ç²¾åŠ›æ”¾åˆ°ä¸šåŠ¡åŠŸèƒ½å¼€å‘ä¸Šã€‚</p>
<h3 data-id="heading-9">æ¨¡æ¿ç›®æ ‡</h3>
<p>æç¤ºè¯æ¨¡æ¿çš„ç›®æ ‡æ˜¯<strong>å‡å°‘ä½¿ç”¨è€…çš„æ€è€ƒè´Ÿæ‹…å¹¶æé«˜ AI è¾“å‡ºçš„ç¨³å®šæ€§</strong>ã€‚ä½†æ¨¡æ¿å¹¶ä¸æ˜¯ç»ˆæç›®æ ‡ï¼Œå› ä¸ºå›ºå®šçš„æ¨¡æ¿åè€Œä¼šé™åˆ¶çµæ´»æ€§ã€‚å› æ­¤åœ¨ä¸åŒé˜¶æ®µã€ä¸åŒåœºæ™¯ï¼Œä½¿ç”¨è€…å¯ä»¥å¯¹æ¨¡æ¿è¿›è¡Œè°ƒæ•´ï¼š</p>





















<table><thead><tr><th><strong>é˜¶æ®µ</strong></th><th><strong>åšæ³•</strong></th></tr></thead><tbody><tr><td>åˆçº§é˜¶æ®µ</td><td>ä¸¥æ ¼æŒ‰æ¡†æ¶å¡«å†™ï¼Œç¡®ä¿ä¸é—æ¼</td></tr><tr><td>ç†Ÿç»ƒé˜¶æ®µ</td><td>æ ¹æ®ä»»åŠ¡å¤æ‚åº¦ç®€åŒ–æˆ–æ‰©å±•</td></tr><tr><td>é«˜æ‰‹é˜¶æ®µ</td><td>æ¡†æ¶å†…åŒ–æˆç›´è§‰ï¼Œè‡ªç„¶åœ°ç»„ç»‡ä¿¡æ¯</td></tr></tbody></table>
<h3 data-id="heading-10">æ¨èæ¨¡æ¿</h3>
<p>æ¨¡æ¿ç»“æ„ï¼š</p>













































<table><thead><tr><th><strong>ä¸»é¢˜</strong></th><th><strong>å¿…å¡«ç¨‹åº¦</strong></th><th><strong>ä½œç”¨</strong></th></tr></thead><tbody><tr><td>è§’è‰²</td><td>å¿…é¡»</td><td>è®© AI æˆä¸ºæŸä¸ªé¢†åŸŸçš„ä¸“å®¶</td></tr><tr><td>èƒŒæ™¯</td><td>å¿…é¡»</td><td>è®© AI æå‰äº†è§£ä»»åŠ¡çš„èƒŒæ™¯çŸ¥è¯†</td></tr><tr><td>ä»»åŠ¡</td><td>å¿…é¡»</td><td>å‘Šè¯‰ AI è¦åšä»€ä¹ˆ</td></tr><tr><td>è¦æ±‚</td><td>æ¨è</td><td>å‘Šè¯‰ AI ä»»åŠ¡å®Œæˆçš„æ ‡å‡†</td></tr><tr><td>çº¦æŸ</td><td>æ¨è</td><td>ä¸º AI åˆ’å®šè¾¹ç•Œï¼Œé˜²æ­¢è‡ªç”±å‘æŒ¥</td></tr><tr><td>æ ¼å¼</td><td>å¯é€‰</td><td>å‘Šè¯‰ AI æœ€ç»ˆè¾“å‡ºå†…å®¹çš„æ ¼å¼</td></tr><tr><td>ç¤ºä¾‹</td><td>å¯é€‰</td><td>ç”¨å®é™…çš„ä¾‹å­å‘Šè¯‰ AI è¦æ€ä¹ˆåš</td></tr></tbody></table>
<p>æ¨¡æ¿ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section">## è§’è‰²</span>
ä½ æ˜¯ä¸€ä¸ªæ“…é•¿ React å’Œç»„ä»¶å¼€å‘çš„çš„å‰ç«¯å¼€å‘è€…ã€‚

<span class="hljs-section">## èƒŒæ™¯</span>
æˆ‘ä½¿ç”¨ react å¼€å‘äº†ä¸€ä¸ªåŸºç¡€ç»„ä»¶åº“ï¼Œé‡Œé¢åŒ…å«äº†xxä¸ªç»„ä»¶ï¼Œç»„ä»¶åç§°å¦‚ä¸‹xxxã€‚

<span class="hljs-section">## ä»»åŠ¡</span>
å¸®æˆ‘ä¸ºæ¯ä¸ªç»„ä»¶ç”Ÿæˆä¸€ä»½ mdr æ–‡ä»¶ï¼Œè¡¨ç¤ºè¯¥ç»„ä»¶çš„ä½¿ç”¨è¯¦ç»†è¯´æ˜ã€‚

<span class="hljs-section">## è¦æ±‚</span>
<span class="hljs-bullet">-</span> æ–‡æ¡£è¦åŒ…å«ç»„ä»¶çš„ APIã€ä½¿ç”¨ç¤ºä¾‹ã€xxxã€‚

<span class="hljs-section">## çº¦æŸ</span>
<span class="hljs-bullet">-</span> ä½¿ç”¨ md è¯­æ³•ã€‚
<span class="hljs-bullet">-</span> å¿…é¡»ä¿è¯ API çš„å®Œæ•´ï¼Œä¸èƒ½æ¼æ‰å†…å®¹ã€‚

<span class="hljs-section">## è¾“å‡ºæ ¼å¼</span>
Title: ç»„ä»¶åç§°

description: ç»„ä»¶æè¿°

APIï¼š
xxx

Examplesï¼š
xxx

<span class="hljs-section">## ç¤ºä¾‹</span>

Title: Alert

description: è­¦ç¤ºç»„ä»¶

API:

| å‚æ•° | è¯´æ˜ | ç±»å‹ | é»˜è®¤å€¼ | ç‰ˆæœ¬ |
| --- | --- | --- | --- | --- |
| action | è‡ªå®šä¹‰æ“ä½œé¡¹ | ReactNode | - | 4.9.0 |
| afterClose | å…³é—­åŠ¨ç”»ç»“æŸåè§¦å‘çš„å›è°ƒå‡½æ•° | () =&gt; void | - |  |
| banner | æ˜¯å¦ç”¨ä½œé¡¶éƒ¨å…¬å‘Š | boolean | false |  |

</code></pre>
<h2 data-id="heading-11">è¿›é˜¶æç¤ºè¯æŠ€å·§</h2>
<h3 data-id="heading-12"><strong>Few-shot Prompting</strong></h3>
<p>Few-shot çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ç»™ AI å‡ ä¸ªä¾‹å­ï¼Œè®©ä»–å…ˆæŒ‰ç…§ä¾‹å­å­¦ä¹ ï¼Œç†è§£ä»»åŠ¡å¤„ç†æµç¨‹åŠæœ€ç»ˆçš„å†…å®¹è¾“å‡ºã€‚è¿™ç§æ¨¡å¼èƒ½å¤Ÿæ›´é«˜æ•ˆçš„è®© AI ç†è§£ç”¨æˆ·çš„æ„å›¾ï¼Œè¿™å’Œäººå­¦ä¹ æ–°ä¸œè¥¿ä¸€æ ·ï¼Œç›´æ¥çœ‹ç¤ºèŒƒæ¯”è¯»æ–‡æ¡£æ›´é«˜æ•ˆã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx">ä»»åŠ¡ï¼šä¸º <span class="hljs-title class_">React</span> ç»„ä»¶ç”Ÿæˆ <span class="hljs-title class_">TypeScript</span> <span class="hljs-title class_">Props</span> ç±»å‹å®šä¹‰

ç¤ºä¾‹<span class="hljs-number">1</span>ï¼š
ç»„ä»¶æè¿°ï¼šä¸€ä¸ªæ˜¾ç¤ºä»»åŠ¡æ ‡é¢˜çš„ç»„ä»¶ï¼Œæ ‡é¢˜å¿…å¡«ï¼Œå¯é€‰æ˜¾ç¤ºå®ŒæˆçŠ¶æ€
è¾“å‡ºï¼š
interface <span class="hljs-title class_">TaskTitleProps</span> {
  <span class="hljs-attr">title</span>: string;           <span class="hljs-comment">// ä»»åŠ¡æ ‡é¢˜ï¼Œå¿…å¡«</span>
  isCompleted?: boolean;   <span class="hljs-comment">// å®ŒæˆçŠ¶æ€ï¼Œå¯é€‰</span>
}

ç¤ºä¾‹<span class="hljs-number">2</span>ï¼š
ç»„ä»¶æè¿°ï¼šä¸€ä¸ªæŒ‰é’®ç»„ä»¶ï¼Œæ˜¾ç¤ºæ–‡å­—å¿…å¡«ï¼Œç‚¹å‡»äº‹ä»¶å¿…å¡«ï¼Œå¯é€‰ç¦ç”¨çŠ¶æ€
è¾“å‡ºï¼š
interface <span class="hljs-title class_">ButtonProps</span> {
  <span class="hljs-attr">label</span>: string;           <span class="hljs-comment">// æŒ‰é’®æ–‡å­—ï¼Œå¿…å¡«</span>
  <span class="hljs-attr">onClick</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">void</span>;     <span class="hljs-comment">// ç‚¹å‡»äº‹ä»¶ï¼Œå¿…å¡«</span>
  disabled?: boolean;      <span class="hljs-comment">// ç¦ç”¨çŠ¶æ€ï¼Œå¯é€‰</span>
}
</code></pre>
<p>ç¤ºä¾‹è™½ç„¶èƒ½å¤Ÿæ›´é«˜æ•ˆçš„å¸®åŠ© AI ç†è§£ä»»åŠ¡ï¼Œä½†æ˜¯è¿‡å¤šçš„ç¤ºä¾‹ä¹Ÿä¼šåŠ å¤§ token çš„æ¶ˆè€—ï¼Œå› æ­¤ç¤ºä¾‹ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œè¦éµå¾ª<strong>å°‘è€Œç²¾çš„åŸåˆ™</strong>ï¼Œé€šè¿‡ 2ï½5 ä¸ªä¾‹å­å°†å…¸å‹çš„åœºæ™¯ã€å¤šæ ·æ€§åœºæ™¯ä»¥åŠè¾¹ç•Œåœºæ™¯åˆ—ä¸¾å‡ºæ¥ã€‚</p>
<h3 data-id="heading-13"><strong>Chain of Thought</strong></h3>
<p>Chain of Thought çš„æ ¸å¿ƒæ€æƒ³æ˜¯å‘Šè¯‰ AI è®©ä»–ä¸€æ­¥æ­¥æ€è€ƒæ¨ç†ï¼Œè¾“å‡ºæ¨ç†å†…å®¹ï¼Œè€Œä¸æ˜¯ç›´æ¥ç»™ç­”æ¡ˆã€‚å°±åƒè§£æ•°å­¦é¢˜ä¸€æ ·ï¼ŒæŠŠè§£é¢˜çš„æ¯ä¸€æ­¥éƒ½å†™å‡ºæ¥ï¼Œè¿™æ ·å¾€å¾€èƒ½è®© AI è¾“å‡ºæ›´å‡†ç¡®çš„ç­”æ¡ˆã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx">## è§’è‰²
ä½ æ˜¯ä¸€ä¸ªæ“…é•¿ <span class="hljs-title class_">React</span> å’Œç»„ä»¶å¼€å‘çš„çš„å‰ç«¯å¼€å‘è€…ã€‚

## èƒŒæ™¯
æˆ‘ä½¿ç”¨ react å¼€å‘äº†ä¸€ä¸ªåŸºç¡€ç»„ä»¶åº“ï¼Œé‡Œé¢åŒ…å«äº†xxä¸ªç»„ä»¶ã€‚

## ä»»åŠ¡
å¸®æˆ‘ç»™ä¿®æ”¹çš„ react ç»„ä»¶è¡¥å……æ–°çš„å•æµ‹ã€‚

### ä¿®æ”¹ç‚¹åˆ†ææ­¥éª¤
- åˆ†æç»„ä»¶çš„ propsï¼Œæ‰¾å‡ºæ–°å¢/åˆ å‡/ä¿®æ”¹çš„å‚æ•°ï¼Œå¹¶è¾“å‡ºå‡ºæ¥ã€‚
- åˆ†æç»„ä»¶çš„å†…éƒ¨é€»è¾‘ï¼Œæ‰¾å‡ºæ–°å¢/åˆ é™¤/ä¿®æ”¹çš„é€»è¾‘ï¼Œå¹¶è¾“å‡ºå‡ºæ¥ã€‚

</code></pre>
<p>è¿™ç§æ¨¡å¼åœ¨å¤æ‚çš„åœºæ™¯ä¸­ä¼šå¤§å¤§æå‡è¾“å‡ºæ•ˆæœï¼Œä½†æ˜¯ä¹Ÿå­˜åœ¨ä¸€äº›å±€é™ï¼š</p>
<ul>
<li>è¾“å‡ºå†…å®¹çš„é•¿åº¦ä¼šå¤§å¤§å¢åŠ ï¼Œå¢åŠ  Token çš„æ¶ˆè€—ã€‚</li>
<li>å¯¹äºæŸäº›ç®€å•ä»»åŠ¡ï¼Œå¼ºè¡Œä½¿ç”¨è¯¥æ¨¡å¼å¯èƒ½åè€Œä¼šé™ä½æ•ˆæœã€‚</li>
<li>å¦‚æœæ¨ç†çš„è¿‡ç¨‹ä¸­æŸä¸€æ­¥å‡ºé”™ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ¥ä¸‹æ¥æ­¥éª¤éƒ½ä¼šå‡ºé”™ï¼Œéœ€è¦é…åˆ Self-Critique æ¥æ£€æŸ¥ã€‚</li>
</ul>
<h3 data-id="heading-14"><strong>Self-Critique</strong></h3>
<p>ä¸äººç±»ä¸€æ ·ï¼ŒAI å¹¶éæ€»èƒ½åœ¨é¦–æ¬¡å°è¯•æ—¶å°±ç”Ÿæˆæœ€ä½³è¾“å‡ºï¼ŒSelf-Critique çš„æ ¸å¿ƒæ€æƒ³æ˜¯åœ¨ AI ç”Ÿæˆå†…å®¹ä¹‹åï¼Œè®© AI å†è‡ªæˆ‘æ£€æŸ¥ä¸€éï¼Œå‘ç°å¹¶ä¿®å¤é—®é¢˜ã€‚è¿™ä¸ªå’Œæˆ‘ä»¬è€ƒè¯•ç­”é¢˜ä¸€æ ·ï¼Œåšå®Œä¹‹åå†æ£€æŸ¥ä¸€éå¾€å¾€èƒ½å‘ç°é—æ¼çš„ç»†èŠ‚æˆ–è€…å†™é”™çš„é¢˜ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx">## è§’è‰²
ä½ æ˜¯ä¸€ä¸ªæ“…é•¿ <span class="hljs-title class_">React</span> å’Œç»„ä»¶å¼€å‘çš„çš„å‰ç«¯å¼€å‘è€…ã€‚

## èƒŒæ™¯
æˆ‘ä½¿ç”¨ react å¼€å‘äº†ä¸€ä¸ªåŸºç¡€ç»„ä»¶åº“ï¼Œé‡Œé¢åŒ…å«äº†xxä¸ªç»„ä»¶ã€‚

## ä»»åŠ¡
å¸®æˆ‘ç»™ä¿®æ”¹çš„ react ç»„ä»¶è¡¥å……æ–°çš„å•æµ‹ã€‚

## ä¿®æ”¹ç‚¹åˆ†ææ­¥éª¤
- åˆ†æç»„ä»¶çš„ propsï¼Œæ‰¾å‡ºæ–°å¢/åˆ å‡/ä¿®æ”¹çš„å‚æ•°ï¼Œå¹¶è¾“å‡ºå‡ºæ¥ã€‚
- åˆ†æç»„ä»¶çš„å†…éƒ¨é€»è¾‘ï¼Œæ‰¾å‡ºæ–°å¢/åˆ é™¤/ä¿®æ”¹çš„é€»è¾‘ï¼Œå¹¶è¾“å‡ºå‡ºæ¥ã€‚

## è¦æ±‚

- ç”Ÿæˆå®Œä¹‹åï¼Œè¯·ä¸¥æ ¼è‡ªæŸ¥
	- æ˜¯å¦è¦†ç›–äº†æ‰€æœ‰ä¿®æ”¹ç‚¹ã€‚
	- æ¯ä¸ªä¿®æ”¹ç‚¹æ˜¯å¦è¦†ç›–äº†æ‰€æœ‰è¾¹ç•Œæƒ…å†µï¼ˆç©ºå€¼ã€ç©ºå­—ç¬¦ä¸²ã€åªæœ‰ç©ºæ ¼ï¼‰
</code></pre>
<p>è¿™ç§æ¨¡å¼ä¸‹ä¼šè®© AI æ‰®æ¼”ä¸€ä¸ªå®¡æŸ¥è€…çš„è§’è‰²é‡æ–°å®¡ä¸‹ç”Ÿæˆçš„å†…å®¹ï¼Œæé«˜å†…å®¹çš„å‡†ç¡®æ€§ï¼Œä½†æ˜¯ä¹Ÿæœ‰å®ƒçš„å±€é™ï¼š</p>
<ul>
<li>å¢åŠ  Token çš„æ¶ˆè€—ï¼Œè¿™ç§æ¨¡å¼æ›´æ¨èåœ¨å¤æ‚çš„åœºæ™¯ä¸­ä½¿ç”¨ã€‚</li>
<li>AI å¯èƒ½å‡ºç°è‡ªæˆ‘è®¤å¯çš„åå·®ï¼Œè®¤ä¸ºè¾“å‡ºæ˜¯æ²¡é—®é¢˜çš„ï¼Œæ­¤æ—¶<strong>éœ€è¦ä¸¥æ ¼ç»™ AI è®¾å®šå®¡æŸ¥è€…çš„è§’è‰²</strong>ã€‚</li>
</ul>
<h2 data-id="heading-15">æ€»ç»“</h2>
<p>æœ¬æ–‡å›´ç»•ã€Œæç¤ºè¯å·¥ç¨‹ã€å±•å¼€ï¼Œä»èƒŒæ™¯ã€æ ¸å¿ƒç›®æ ‡ã€å¸¸è§é—®é¢˜ã€ç»“æ„åŒ–æ¨¡æ¿ï¼Œåˆ° Few-shotã€Chain of Thoughtã€Self-Critique ç­‰è¿›é˜¶æŠ€å·§ï¼Œç³»ç»Ÿæ€§åœ°è¯´æ˜äº†ä¸€ä»¶äº‹ï¼š</p>
<blockquote>
<p>æç¤ºè¯å·¥ç¨‹çš„æœ¬è´¨ï¼Œä¸æ˜¯â€œå¦‚ä½•æŠŠè¯è¯´å¾—æ›´æ¼‚äº®â€ï¼Œè€Œæ˜¯å¦‚ä½•é€šè¿‡ç»“æ„åŒ–ä¸Šä¸‹æ–‡ï¼Œé™ä½å¤§æ¨¡å‹è¾“å‡ºçš„ä¸ç¡®å®šæ€§ã€‚</p>
</blockquote>
<p>ç„¶è€Œï¼Œè¿™ç§æç¤ºè¯ä¼˜åŒ–çš„æ€è·¯ä¹Ÿå¸¦æ¥äº†æ–°çš„å·¥ç¨‹é—®é¢˜ï¼š<strong>æç¤ºè¯è¶Šæ¥è¶Šé•¿ã€ç»“æ„è¶Šæ¥è¶Šå¤æ‚ï¼Œæœ€ç»ˆç›´æ¥åæ˜ ä¸º Token ä½“ç§¯çš„æŒç»­è†¨èƒ€</strong>ã€‚</p>
<p>å› æ­¤ï¼Œåœ¨å®é™…å·¥ç¨‹ä¸­ï¼Œæç¤ºè¯ä¼˜åŒ–å¹¶ä¸ç­‰åŒäºå†™å¾—è¶Šè¯¦ç»†è¶Šå¥½ï¼Œè€Œæ˜¯éœ€è¦åœ¨<strong>ä¿¡æ¯å……åˆ†æ€§ä¸ Token æˆæœ¬ä¹‹é—´å–å¾—å¹³è¡¡</strong>ã€‚å¦‚ä½•æ§åˆ¶ä¸Šä¸‹æ–‡è§„æ¨¡ã€é¿å…æ— æ•ˆä¿¡æ¯å †ç§¯ã€å¹¶åœ¨å¤æ‚ä»»åŠ¡ä¸­æŒç»­æä¾›åˆšåˆšå¥½çš„ä¸Šä¸‹æ–‡ï¼Œæˆä¸ºæç¤ºè¯å·¥ç¨‹ä¹‹åå¿…é¡»é¢å¯¹çš„æ ¸å¿ƒé—®é¢˜ã€‚</p>
<h2 data-id="heading-16">å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Fprompt-engineering" target="_blank" title="https://platform.openai.com/docs/guides/prompt-engineering" ref="nofollow noopener noreferrer">OpenAI Prompt Engineering Guide</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.anthropic.com%2Fclaude%2Fdocs%2Fprompt-engineering" target="_blank" title="https://docs.anthropic.com/claude/docs/prompt-engineering" ref="nofollow noopener noreferrer">Anthropic Prompt Engineering</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2005.14165" target="_blank" title="https://arxiv.org/abs/2005.14165" ref="nofollow noopener noreferrer">Few-shot Prompting</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2201.11903" target="_blank" title="https://arxiv.org/abs/2201.11903" ref="nofollow noopener noreferrer">Chain of Thought</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2303.17651" target="_blank" title="https://arxiv.org/abs/2303.17651" ref="nofollow noopener noreferrer">Self-Critique</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Caffeineå…¥é—¨åˆ°å®æˆ˜]]></title>    <link>https://juejin.cn/post/7595841630677106739</link>    <guid>https://juejin.cn/post/7595841630677106739</guid>    <pubDate>2026-01-17T07:46:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595841630677106739" data-draft-id="7595842144906625074" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Caffeineå…¥é—¨åˆ°å®æˆ˜"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-01-17T07:46:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨ä¸­é£˜è¡çš„è®°å¿†"/> <meta itemprop="url" content="https://juejin.cn/user/694547077666606"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Caffeineå…¥é—¨åˆ°å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/694547077666606/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨ä¸­é£˜è¡çš„è®°å¿†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T07:46:22.000Z" title="Sat Jan 17 2026 07:46:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>é«˜æ€§èƒ½Javaç¼“å­˜æ¡†æ¶å®æˆ˜ï¼Œè®©ä½ ç§’æ‡‚ç¼“å­˜ä¼˜åŒ–</p>
</blockquote>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨å½“ä»Šé«˜å¹¶å‘çš„äº’è”ç½‘åº”ç”¨ä¸­ï¼Œç¼“å­˜å·²ç»æˆä¸ºæå‡ç³»ç»Ÿæ€§èƒ½çš„å…³é”®æŠ€æœ¯ä¹‹ä¸€ã€‚æœ¬æ–‡å°†å¸¦ä½ ä»é›¶å¼€å§‹ï¼Œæ·±å…¥æµ…å‡ºåœ°å­¦ä¹ Caffeineè¿™æ¬¾é«˜æ€§èƒ½çš„Javaç¼“å­˜æ¡†æ¶ï¼Œå¹¶é€šè¿‡å®é™…æ¡ˆä¾‹è®©ä½ æŒæ¡ç¼“å­˜æŠ€æœ¯çš„ç²¾é«“ã€‚</p>
<h2 data-id="heading-1">1. Caffeineç®€ä»‹</h2>
<p>Caffeineæ˜¯ä¸€ä¸ªåŸºäºJavaçš„é«˜æ€§èƒ½ç¼“å­˜åº“ï¼Œç”±Googleå¼€å‘å¹¶å¼€æºã€‚å®ƒè¢«è®¤ä¸ºæ˜¯Javaç¼“å­˜é¢†åŸŸçš„ç‹è€…ï¼Œåœ¨æ€§èƒ½æµ‹è¯•ä¸­è¡¨ç°ä¼˜å¼‚ã€‚</p>
<h3 data-id="heading-2">ä¸ºä»€ä¹ˆé€‰æ‹©Caffeineï¼Ÿ</h3>
<ul>
<li><strong>é«˜æ€§èƒ½</strong>ï¼šé‡‡ç”¨å…ˆè¿›çš„ç®—æ³•ï¼Œè¯»å†™æ€§èƒ½å“è¶Š</li>
<li><strong>åŠŸèƒ½ä¸°å¯Œ</strong>ï¼šæ”¯æŒå¤šç§è¿‡æœŸç­–ç•¥ã€å¼‚æ­¥åŠ è½½ã€ç»Ÿè®¡ä¿¡æ¯ç­‰</li>
<li><strong>çº¿ç¨‹å®‰å…¨</strong>ï¼šå¹¶å‘æ€§èƒ½ä¼˜ç§€</li>
<li><strong>æ˜“äºä½¿ç”¨</strong>ï¼šAPIè®¾è®¡ç®€æ´ç›´è§‚</li>
<li><strong>æ´»è·ƒç¤¾åŒº</strong>ï¼šæŒç»­ç»´æŠ¤å’Œæ›´æ–°</li>
</ul>
<h3 data-id="heading-3">æ¶æ„è®¾è®¡</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a3e6e0d899e14fbaaafafa3123056baf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769240782&amp;x-signature=hfMSuIcQysmqzw2OjT3WiDv4Wtw%3D" alt="" loading="lazy"/></p>
<p>Caffeineçš„æ ¸å¿ƒæ¶æ„åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>ç¼“å­˜å®¹å™¨</strong>ï¼šä½¿ç”¨ConcurrentHashMapä½œä¸ºåº•å±‚æ•°æ®ç»“æ„</li>
<li><strong>è®¿é—®ç­–ç•¥</strong>ï¼šé‡‡ç”¨Window TinyLFUç®—æ³•è¿›è¡Œé¢‘ç‡ç»Ÿè®¡</li>
<li><strong>æ·˜æ±°ç­–ç•¥</strong>ï¼šåŸºäºæ—¶é—´çª—å£å’Œé¢‘ç‡çš„æ··åˆæ·˜æ±°ç­–ç•¥</li>
<li><strong>äº‹ä»¶æœºåˆ¶</strong>ï¼šæ”¯æŒç›‘å¬ç¼“å­˜çš„å„ç§äº‹ä»¶</li>
</ol>
<h2 data-id="heading-4">2. å¿«é€Ÿå…¥é—¨</h2>
<h3 data-id="heading-5">Mavenä¾èµ–</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.ben-manes.caffeine<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>caffeine<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.1.8<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h3 data-id="heading-6">åŸºç¡€ä½¿ç”¨ç¤ºä¾‹</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span>Â com.<span class="hljs-property">github</span>.<span class="hljs-property">benmanes</span>.<span class="hljs-property">caffeine</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">Cache</span>;
<span class="hljs-keyword">import</span>Â com.<span class="hljs-property">github</span>.<span class="hljs-property">benmanes</span>.<span class="hljs-property">caffeine</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">Caffeine</span>;
<span class="hljs-keyword">import</span>Â java.<span class="hljs-property">util</span>.<span class="hljs-property">concurrent</span>.<span class="hljs-property">TimeUnit</span>;

<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">BasicCacheExample</span>Â {
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">main</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>[]Â args</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â åˆ›å»ºç¼“å­˜</span>
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Cache</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">String</span>&gt;Â cacheÂ =Â <span class="hljs-title class_">Caffeine</span>.<span class="hljs-title function_">newBuilder</span>()
Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">maximumSize</span>(<span class="hljs-number">1000</span>)Â <span class="hljs-comment">//Â æœ€å¤§ç¼“å­˜æ•°é‡</span>
Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">expireAfterWrite</span>(<span class="hljs-number">10</span>,Â <span class="hljs-title class_">TimeUnit</span>.<span class="hljs-property">MINUTES</span>)Â <span class="hljs-comment">//Â å†™å…¥å10åˆ†é’Ÿè¿‡æœŸ</span>
Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">build</span>();

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å­˜å‚¨æ•°æ®</span>
Â Â Â Â Â Â Â Â cache.<span class="hljs-title function_">put</span>(<span class="hljs-string">"key1"</span>,Â <span class="hljs-string">"value1"</span>);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è·å–æ•°æ®</span>
Â Â Â Â Â Â Â Â <span class="hljs-title class_">String</span>Â valueÂ =Â cache.<span class="hljs-title function_">getIfPresent</span>(<span class="hljs-string">"key1"</span>);
Â Â Â Â Â Â Â Â <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"ç¼“å­˜å€¼:Â "</span>Â +Â value);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è·å–æˆ–è®¡ç®—</span>
Â Â Â Â Â Â Â Â <span class="hljs-title class_">String</span>Â value2Â =Â cache.<span class="hljs-title function_">get</span>(<span class="hljs-string">"key2"</span>,Â kÂ -&gt;Â <span class="hljs-string">"defaultValue"</span>);
Â Â Â Â Â Â Â Â <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"ç¼“å­˜å€¼:Â "</span>Â +Â value2);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç§»é™¤æ•°æ®</span>
Â Â Â Â Â Â Â Â cache.<span class="hljs-title function_">invalidate</span>(<span class="hljs-string">"key1"</span>);
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-7">3. æ ¸å¿ƒæ¦‚å¿µ</h2>
<h3 data-id="heading-8">3.1 Cache vs LoadingCache vs AsyncLoadingCache</h3>
<p>Caffeineæä¾›äº†ä¸‰ç§ç¼“å­˜ç±»å‹ï¼š</p>
<ol>
<li><strong>Cache</strong>ï¼šåŸºç¡€ç¼“å­˜ï¼Œéœ€è¦æ‰‹åŠ¨ç®¡ç†æ•°æ®</li>
<li><strong>LoadingCache</strong>ï¼šè‡ªåŠ¨åŠ è½½æ•°æ®çš„ç¼“å­˜</li>
<li><strong>AsyncLoadingCache</strong>ï¼šå¼‚æ­¥åŠ è½½æ•°æ®çš„ç¼“å­˜</li>
</ol>
<h3 data-id="heading-9">3.2 è¿‡æœŸç­–ç•¥</h3>
<p>Caffeineæä¾›äº†ä¸‰ç§è¿‡æœŸç­–ç•¥ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">Caffeine<span class="hljs-selector-class">.newBuilder</span>()
Â Â Â Â <span class="hljs-selector-class">.expireAfterWrite</span>(<span class="hljs-number">10</span>,Â TimeUnit.MINUTES)Â <span class="hljs-comment">//Â å†™å…¥åè¿‡æœŸ</span>
Â Â Â Â <span class="hljs-selector-class">.expireAfterAccess</span>(<span class="hljs-number">5</span>,Â TimeUnit.MINUTES)Â Â <span class="hljs-comment">//Â æœ€åè®¿é—®åè¿‡æœŸ</span>
Â Â Â Â <span class="hljs-selector-class">.expireAfter</span>(<span class="hljs-number">30</span>,Â TimeUnit.MINUTES);Â Â Â Â Â Â Â <span class="hljs-comment">//Â è‡ªå®šä¹‰è¿‡æœŸé€»è¾‘</span>
</code></pre>
<h3 data-id="heading-10">3.3 æ·˜æ±°ç­–ç•¥</h3>
<pre><code class="hljs language-scss" lang="scss">Caffeine<span class="hljs-selector-class">.newBuilder</span>()
Â Â Â Â <span class="hljs-selector-class">.maximumSize</span>(<span class="hljs-number">1000</span>)Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â åŸºäºæ•°é‡</span>
Â Â Â Â <span class="hljs-selector-class">.maximumWeight</span>(<span class="hljs-number">10000</span>)Â Â Â Â Â Â <span class="hljs-comment">//Â åŸºäºæƒé‡</span>
Â Â Â Â <span class="hljs-selector-class">.weakKeys</span>()Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¼±å¼•ç”¨é”®</span>
Â Â Â Â <span class="hljs-selector-class">.weakValues</span>()Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¼±å¼•ç”¨å€¼</span>
Â Â Â Â <span class="hljs-selector-class">.softValues</span>();Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è½¯å¼•ç”¨å€¼</span>
</code></pre>
<h2 data-id="heading-11">4. é«˜çº§ç‰¹æ€§</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ff936a2d76c04f1aaf866ccba450d2fa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769240782&amp;x-signature=vIDzfY5%2B20eLh9huJFxIDK%2FnZbk%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-12">4.1 å¼‚æ­¥åŠ è½½</h3>
<pre><code class="hljs language-ini" lang="ini">AsyncLoadingCache&lt;String,Â User&gt;Â <span class="hljs-attr">asyncCache</span>Â =Â Caffeine.newBuilder()
Â Â Â Â .maximumSize(1000)
Â Â Â Â .expireAfterWrite(10,Â TimeUnit.MINUTES)
Â Â Â Â .buildAsync(keyÂ -&gt;Â loadUserFromDatabase(key))<span class="hljs-comment">;</span>

//Â å¼‚æ­¥è·å–
CompletableFuture&lt;User&gt;Â <span class="hljs-attr">userFuture</span>Â =Â asyncCache.get(<span class="hljs-string">"user1"</span>)<span class="hljs-comment">;</span>
userFuture.thenAccept(userÂ -&gt;Â {
Â Â Â Â System.out.println("è·å–ç”¨æˆ·:Â "Â +Â user.getName())<span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-13">4.2 äº‹ä»¶ç›‘å¬</h3>
<pre><code class="hljs language-vbnet" lang="vbnet">Cache&lt;<span class="hljs-type">String</span>,Â <span class="hljs-type">String</span>&gt;Â cacheÂ =Â Caffeine.newBuilder()
Â Â Â Â .maximumSize(<span class="hljs-number">1000</span>)
Â Â Â Â .removalListener((<span class="hljs-keyword">key</span>,Â value,Â cause)Â -&gt;Â {
Â Â Â Â Â Â Â Â System.out.println(<span class="hljs-string">"ç¼“å­˜ç§»é™¤:Â "</span>Â +Â <span class="hljs-keyword">key</span>Â +Â <span class="hljs-string">"Â -&gt;Â "</span>Â +Â valueÂ +Â <span class="hljs-string">",Â åŸå› :Â "</span>Â +Â cause);
Â Â Â Â })
Â Â Â Â .build();
</code></pre>
<h3 data-id="heading-14">4.3 ç»Ÿè®¡ä¿¡æ¯</h3>
<pre><code class="hljs language-scss" lang="scss">Cache&lt;String,Â String&gt;Â cacheÂ =Â Caffeine<span class="hljs-selector-class">.newBuilder</span>()
Â Â Â Â <span class="hljs-selector-class">.maximumSize</span>(<span class="hljs-number">1000</span>)
Â Â Â Â <span class="hljs-selector-class">.recordStats</span>()Â <span class="hljs-comment">//Â å¯ç”¨ç»Ÿè®¡</span>
Â Â Â Â <span class="hljs-selector-class">.build</span>();

<span class="hljs-comment">//Â ä½¿ç”¨ç¼“å­˜...</span>
cache<span class="hljs-selector-class">.put</span>("key1",Â "value1");
cache<span class="hljs-selector-class">.getIfPresent</span>("key1");

<span class="hljs-comment">//Â è·å–ç»Ÿè®¡ä¿¡æ¯</span>
CacheStatsÂ statsÂ =Â cache<span class="hljs-selector-class">.stats</span>();
System<span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>("å‘½ä¸­ç‡:Â "Â +Â stats.hitRate());
System<span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>("åŠ è½½æ—¶é—´:Â "Â +Â stats.averageLoadPenalty());
System<span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>("è¯·æ±‚æ•°:Â "Â +Â stats.requestCount());
</code></pre>
<h2 data-id="heading-15">5. Spring Booté›†æˆ</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aff82efaf278437f8045c4dae72c58be~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769240782&amp;x-signature=x8wXynqrw1CSWo8vv794U8KA5Sg%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-16">5.1 æ·»åŠ ä¾èµ–</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-cache<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.ben-manes.caffeine<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>caffeine<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h3 data-id="heading-17">5.2 é…ç½®ç±»</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span>Â com.<span class="hljs-property">github</span>.<span class="hljs-property">benmanes</span>.<span class="hljs-property">caffeine</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">Caffeine</span>;
<span class="hljs-keyword">import</span>Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">CacheManager</span>;
<span class="hljs-keyword">import</span>Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">EnableCaching</span>;
<span class="hljs-keyword">import</span>Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">caffeine</span>.<span class="hljs-property">CaffeineCacheManager</span>;
<span class="hljs-keyword">import</span>Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">context</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">Bean</span>;
<span class="hljs-keyword">import</span>Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">context</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">Configuration</span>;
<span class="hljs-keyword">import</span>Â java.<span class="hljs-property">util</span>.<span class="hljs-property">concurrent</span>.<span class="hljs-property">TimeUnit</span>;

<span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@EnableCaching</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">CacheConfig</span>Â {

Â Â Â Â <span class="hljs-meta">@Bean</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">CacheManager</span>Â <span class="hljs-title function_">cacheManager</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-title class_">CaffeineCacheManager</span>Â cacheManagerÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">CaffeineCacheManager</span>();
Â Â Â Â Â Â Â Â cacheManager.<span class="hljs-title function_">setCaffeine</span>(<span class="hljs-title function_">caffeineCacheBuilder</span>());
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â cacheManager;
Â Â Â Â }

Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">Caffeine</span>&lt;<span class="hljs-title class_">Object</span>,Â <span class="hljs-title class_">Object</span>&gt;Â <span class="hljs-title function_">caffeineCacheBuilder</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">Caffeine</span>.<span class="hljs-title function_">newBuilder</span>()
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">initialCapacity</span>(<span class="hljs-number">100</span>)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">maximumSize</span>(<span class="hljs-number">1000</span>)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">expireAfterWrite</span>(<span class="hljs-number">10</span>,Â <span class="hljs-title class_">TimeUnit</span>.<span class="hljs-property">MINUTES</span>)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">recordStats</span>();
Â Â Â Â }
}
</code></pre>
<h3 data-id="heading-18">5.3 ä½¿ç”¨æ³¨è§£</h3>
<pre><code class="hljs language-typescript" lang="typescript">packageÂ com.<span class="hljs-property">example</span>.<span class="hljs-property">caffeine</span>.<span class="hljs-property">demo</span>.<span class="hljs-property">service</span>;

<span class="hljs-keyword">import</span>Â com.<span class="hljs-property">example</span>.<span class="hljs-property">caffeine</span>.<span class="hljs-property">demo</span>.<span class="hljs-property">model</span>.<span class="hljs-property">User</span>;
<span class="hljs-keyword">import</span>Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">CacheEvict</span>;
<span class="hljs-keyword">import</span>Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">CachePut</span>;
<span class="hljs-keyword">import</span>Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">Cacheable</span>;
<span class="hljs-keyword">import</span>Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">stereotype</span>.<span class="hljs-property">Service</span>;

<span class="hljs-keyword">import</span>Â java.<span class="hljs-property">util</span>.*;
<span class="hljs-keyword">import</span>Â java.<span class="hljs-property">util</span>.<span class="hljs-property">concurrent</span>.<span class="hljs-property">ConcurrentHashMap</span>;
<span class="hljs-keyword">import</span>Â java.<span class="hljs-property">util</span>.<span class="hljs-property">concurrent</span>.<span class="hljs-property">TimeUnit</span>;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">UserService</span>Â {

Â Â Â Â <span class="hljs-comment">//Â æ¨¡æ‹Ÿæ•°æ®åº“å­˜å‚¨</span>
Â Â Â Â <span class="hljs-keyword">private</span>Â finalÂ <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">Long</span>,Â <span class="hljs-title class_">User</span>&gt;Â userMapÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();

Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">UserService</span>()Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â åˆå§‹åŒ–ä¸€äº›æµ‹è¯•æ•°æ®</span>
Â Â Â Â Â Â Â Â userMap.<span class="hljs-title function_">put</span>(1L,Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">User</span>(1L,Â <span class="hljs-string">"å¼ ä¸‰"</span>,Â <span class="hljs-string">"zhangsan@example.com"</span>,Â <span class="hljs-string">"13800138000"</span>));
Â Â Â Â Â Â Â Â userMap.<span class="hljs-title function_">put</span>(2L,Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">User</span>(2L,Â <span class="hljs-string">"æå››"</span>,Â <span class="hljs-string">"lisi@example.com"</span>,Â <span class="hljs-string">"13900139000"</span>));
Â Â Â Â Â Â Â Â userMap.<span class="hljs-title function_">put</span>(3L,Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">User</span>(3L,Â <span class="hljs-string">"ç‹äº”"</span>,Â <span class="hljs-string">"wangwu@example.com"</span>,Â <span class="hljs-string">"13700137000"</span>));
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–ç”¨æˆ·ä¿¡æ¯ï¼ˆå¸¦ç¼“å­˜ï¼‰
Â Â Â Â Â *Â <span class="hljs-doctag">@param</span>Â userIdÂ ç”¨æˆ·ID
Â Â Â Â Â *Â <span class="hljs-doctag">@return</span>Â ç”¨æˆ·ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@Cacheable</span>(valueÂ =Â <span class="hljs-string">"users"</span>,Â keyÂ =Â <span class="hljs-string">"#userId"</span>)
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">User</span>Â <span class="hljs-title function_">getUserById</span>(<span class="hljs-params">LongÂ userId</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥è¯¢è€—æ—¶</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">TimeUnit</span>.<span class="hljs-property">MILLISECONDS</span>.<span class="hljs-title function_">sleep</span>(<span class="hljs-number">100</span>);
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">InterruptedException</span>Â e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">Thread</span>.<span class="hljs-title function_">currentThread</span>().<span class="hljs-title function_">interrupt</span>();
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â <span class="hljs-title class_">User</span>Â userÂ =Â userMap.<span class="hljs-title function_">get</span>(userId);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (userÂ ==Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">throw</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"ç”¨æˆ·ä¸å­˜åœ¨:Â "</span>Â +Â userId);
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â user;
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–ç”¨æˆ·ä¿¡æ¯ï¼ˆå¼‚æ­¥ï¼‰
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">CompletableFuture</span>&lt;<span class="hljs-title class_">User</span>&gt;Â <span class="hljs-title function_">getUserByIdAsync</span>(<span class="hljs-params">LongÂ userId</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">CompletableFuture</span>.<span class="hljs-title function_">supplyAsync</span>(()Â -&gt;Â <span class="hljs-title function_">getUserById</span>(userId));
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@Cacheable</span>(valueÂ =Â <span class="hljs-string">"users"</span>,Â keyÂ =Â <span class="hljs-string">"'all'"</span>)
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">User</span>&gt;Â <span class="hljs-title function_">getAllUsers</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥è¯¢è€—æ—¶</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">TimeUnit</span>.<span class="hljs-property">MILLISECONDS</span>.<span class="hljs-title function_">sleep</span>(<span class="hljs-number">200</span>);
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">InterruptedException</span>Â e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">Thread</span>.<span class="hljs-title function_">currentThread</span>().<span class="hljs-title function_">interrupt</span>();
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">ArrayList</span>&lt;&gt;(userMap.<span class="hljs-title function_">values</span>());
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â åˆ›å»ºç”¨æˆ·
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@CachePut</span>(valueÂ =Â <span class="hljs-string">"users"</span>,Â keyÂ =Â <span class="hljs-string">"#user.id"</span>)
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">User</span>Â <span class="hljs-title function_">createUser</span>(<span class="hljs-params">UserÂ user</span>)Â {
Â Â Â Â Â Â Â Â userMap.<span class="hljs-title function_">put</span>(user.<span class="hljs-title function_">getId</span>(),Â user);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â user;
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ›´æ–°ç”¨æˆ·ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@CachePut</span>(valueÂ =Â <span class="hljs-string">"users"</span>,Â keyÂ =Â <span class="hljs-string">"#user.id"</span>)
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">User</span>Â <span class="hljs-title function_">updateUser</span>(<span class="hljs-params">UserÂ user</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (!userMap.<span class="hljs-title function_">containsKey</span>(user.<span class="hljs-title function_">getId</span>()))Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">throw</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"ç”¨æˆ·ä¸å­˜åœ¨:Â "</span>Â +Â user.<span class="hljs-title function_">getId</span>());
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â user.<span class="hljs-title function_">setUpdateTime</span>(<span class="hljs-title class_">LocalDateTime</span>.<span class="hljs-title function_">now</span>());
Â Â Â Â Â Â Â Â userMap.<span class="hljs-title function_">put</span>(user.<span class="hljs-title function_">getId</span>(),Â user);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â user;
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â åˆ é™¤ç”¨æˆ·
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@CacheEvict</span>(valueÂ =Â <span class="hljs-string">"users"</span>,Â keyÂ =Â <span class="hljs-string">"#userId"</span>)
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">deleteUser</span>(<span class="hljs-params">LongÂ userId</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-title class_">User</span>Â removedÂ =Â userMap.<span class="hljs-title function_">remove</span>(userId);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (removedÂ ==Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">throw</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"ç”¨æˆ·ä¸å­˜åœ¨:Â "</span>Â +Â userId);
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ‰¹é‡è·å–ç”¨æˆ·ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@Cacheable</span>(valueÂ =Â <span class="hljs-string">"users"</span>,Â keyÂ =Â <span class="hljs-string">"'batch:'Â +Â #userIds.hashCode()"</span>)
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">Long</span>,Â <span class="hljs-title class_">User</span>&gt;Â <span class="hljs-title function_">batchGetUsers</span>(<span class="hljs-params"><span class="hljs-built_in">Set</span>&lt;Long&gt;Â userIds</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ¨¡æ‹Ÿæ‰¹é‡æŸ¥è¯¢è€—æ—¶</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">TimeUnit</span>.<span class="hljs-property">MILLISECONDS</span>.<span class="hljs-title function_">sleep</span>(<span class="hljs-number">150</span>);
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">InterruptedException</span>Â e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">Thread</span>.<span class="hljs-title function_">currentThread</span>().<span class="hljs-title function_">interrupt</span>();
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">Long</span>,Â <span class="hljs-title class_">User</span>&gt;Â resultÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">HashMap</span>&lt;&gt;();
Â Â Â Â Â Â Â Â <span class="hljs-keyword">for</span>Â (<span class="hljs-title class_">Long</span>Â userIdÂ :Â userIds)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">User</span>Â userÂ =Â userMap.<span class="hljs-title function_">get</span>(userId);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (userÂ !=Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(userId,Â user);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â result;
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ ¹æ®ç”¨æˆ·åæ¨¡ç³ŠæŸ¥è¯¢
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">User</span>&gt;Â <span class="hljs-title function_">searchUsersByUsername</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>Â keyword</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">User</span>&gt;Â resultÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
Â Â Â Â Â Â Â Â <span class="hljs-keyword">for</span>Â (<span class="hljs-title class_">User</span>Â userÂ :Â userMap.<span class="hljs-title function_">values</span>())Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (user.<span class="hljs-title function_">getUsername</span>().<span class="hljs-title function_">contains</span>(keyword))Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">add</span>(user);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â result;
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ¸…ç©ºæ‰€æœ‰ç¼“å­˜
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@CacheEvict</span>(valueÂ =Â <span class="hljs-string">"users"</span>,Â allEntriesÂ =Â <span class="hljs-literal">true</span>)
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">clearAllCache</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"æ¸…ç©ºæ‰€æœ‰ç”¨æˆ·ç¼“å­˜"</span>);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–ç”¨æˆ·æ€»æ•°
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â longÂ <span class="hljs-title function_">getUserCount</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â userMap.<span class="hljs-title function_">size</span>();
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-19">6. ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ</h2>
<h3 data-id="heading-20">6.1 ç¼“å­˜é›ªå´©ä¸å‡»ç©¿</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ae45c5ae2c644e7b19813de7bb61db4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769240782&amp;x-signature=s5Bj%2B0%2FpD1TT%2FcUtgYIihfc%2BzFI%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-21">ç¼“å­˜é›ªå´©è§£å†³æ–¹æ¡ˆ</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">//Â 1.Â è®¾ç½®éšæœºè¿‡æœŸæ—¶é—´</span>
Caffeine.newBuilder()
Â Â Â Â .expireAfterWrite(<span class="hljs-number">10</span>Â +Â <span class="hljs-keyword">new</span>Â Random().nextInt(<span class="hljs-number">5</span>),Â TimeUnit.MINUTES);

<span class="hljs-comment">//Â 2.Â ä½¿ç”¨äº’æ–¥é”</span>
<span class="hljs-keyword">private</span>Â finalÂ LockÂ <span class="hljs-keyword">lock</span>Â =Â <span class="hljs-keyword">new</span>Â ReentrantLock();

<span class="hljs-function"><span class="hljs-keyword">public</span>Â UserÂ <span class="hljs-title">getUserWithLock</span>(<span class="hljs-params">LongÂ id</span>)</span>Â {
Â Â Â Â UserÂ userÂ =Â cache.getIfPresent(id);
Â Â Â Â <span class="hljs-keyword">if</span>Â (userÂ !=Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â user;
Â Â Â Â }

Â Â Â Â <span class="hljs-keyword">lock</span>.<span class="hljs-keyword">lock</span>();
Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â åŒé‡æ£€æŸ¥</span>
Â Â Â Â Â Â Â Â userÂ =Â cache.getIfPresent(id);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (userÂ !=Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â user;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â userÂ =Â userRepository.findById(id);
Â Â Â Â Â Â Â Â cache.put(id,Â user);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â user;
Â Â Â Â }Â <span class="hljs-keyword">finally</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">lock</span>.unlock();
Â Â Â Â }
}
</code></pre>
<h4 data-id="heading-22">ç¼“å­˜å‡»ç©¿è§£å†³æ–¹æ¡ˆ</h4>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">//Â ä½¿ç”¨Caffeineçš„å¼‚æ­¥åŠ è½½</span>
AsyncLoadingCache&lt;Long,Â User&gt;Â asyncCacheÂ =Â Caffeine<span class="hljs-selector-class">.newBuilder</span>()
Â Â Â Â <span class="hljs-selector-class">.maximumSize</span>(<span class="hljs-number">1000</span>)
Â Â Â Â <span class="hljs-selector-class">.expireAfterWrite</span>(<span class="hljs-number">10</span>,Â TimeUnit.MINUTES)
Â Â Â Â <span class="hljs-selector-class">.buildAsync</span>(keyÂ -&gt;Â loadUserFromDatabase(key));

publicÂ UserÂ <span class="hljs-built_in">getUser</span>(LongÂ id)Â {
Â Â Â Â returnÂ asyncCache<span class="hljs-selector-class">.get</span>(id)<span class="hljs-selector-class">.join</span>();
}
</code></pre>
<h3 data-id="heading-23">6.2 ç¼“å­˜é¢„çƒ­</h3>
<pre><code class="hljs language-scss" lang="scss">packageÂ com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.caffeine</span><span class="hljs-selector-class">.demo</span><span class="hljs-selector-class">.cache</span>;

importÂ com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.caffeine</span><span class="hljs-selector-class">.demo</span><span class="hljs-selector-class">.model</span><span class="hljs-selector-class">.User</span>;
importÂ com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.caffeine</span><span class="hljs-selector-class">.demo</span><span class="hljs-selector-class">.service</span><span class="hljs-selector-class">.UserService</span>;
importÂ lombok<span class="hljs-selector-class">.extern</span><span class="hljs-selector-class">.slf4j</span><span class="hljs-selector-class">.Slf4j</span>;
importÂ org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.beans</span><span class="hljs-selector-class">.factory</span><span class="hljs-selector-class">.annotation</span><span class="hljs-selector-class">.Autowired</span>;
importÂ org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.boot</span><span class="hljs-selector-class">.CommandLineRunner</span>;
importÂ org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.stereotype</span><span class="hljs-selector-class">.Component</span>;

importÂ java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.Arrays</span>;
importÂ java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.List</span>;
importÂ java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.concurrent</span><span class="hljs-selector-class">.CompletableFuture</span>;
importÂ java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.concurrent</span><span class="hljs-selector-class">.ExecutorService</span>;
importÂ java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.concurrent</span><span class="hljs-selector-class">.Executors</span>;
importÂ java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.concurrent</span><span class="hljs-selector-class">.TimeUnit</span>;
importÂ java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.stream</span><span class="hljs-selector-class">.Collectors</span>;

<span class="hljs-comment">/**
Â *Â ç¼“å­˜é¢„çƒ­å¯åŠ¨å™¨
Â *
Â *Â åŠŸèƒ½ï¼š
Â *Â 1.Â åœ¨åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨é¢„çƒ­çƒ­ç‚¹æ•°æ®åˆ°ç¼“å­˜
Â *Â 2.Â æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥é¢„çƒ­æ–¹å¼
Â *Â 3.Â æ”¯æŒæ‰¹é‡é¢„çƒ­
Â *Â 4.Â æä¾›é¢„çƒ­è¿›åº¦ç›‘æ§
Â *Â 5.Â å¼‚å¸¸å¤„ç†å’Œé‡è¯•æœºåˆ¶
Â */</span>
<span class="hljs-keyword">@Slf</span>4j
<span class="hljs-keyword">@Component</span>
publicÂ classÂ CacheWarmupRunnerÂ implementsÂ CommandLineRunnerÂ {

Â Â Â Â <span class="hljs-keyword">@Autowired</span>
Â Â Â Â privateÂ UserServiceÂ userService;

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â é¢„çƒ­é…ç½®
Â Â Â Â Â */</span>
Â Â Â Â privateÂ staticÂ classÂ WarmupConfigÂ {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é¢„çƒ­ç”¨æˆ·IDåˆ—è¡¨ï¼ˆå¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€æ±‚é…ç½®ï¼‰</span>
Â Â Â Â Â Â Â Â privateÂ staticÂ finalÂ List&lt;Long&gt;Â HOT_USER_IDSÂ =Â Arrays<span class="hljs-selector-class">.asList</span>(<span class="hljs-number">1</span>L,Â <span class="hljs-number">2</span>L,Â <span class="hljs-number">3</span>L,Â <span class="hljs-number">4</span>L,Â <span class="hljs-number">5</span>L);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é¢„çƒ­æ‰¹æ¬¡å¤§å°</span>
Â Â Â Â Â Â Â Â privateÂ staticÂ finalÂ intÂ BATCH_SIZEÂ =Â <span class="hljs-number">3</span>;

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â çº¿ç¨‹æ± å¤§å°</span>
Â Â Â Â Â Â Â Â privateÂ staticÂ finalÂ intÂ THREAD_POOL_SIZEÂ =Â <span class="hljs-number">2</span>;

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ˜¯å¦å¯ç”¨å¼‚æ­¥é¢„çƒ­</span>
Â Â Â Â Â Â Â Â privateÂ staticÂ finalÂ booleanÂ ASYNC_WARMUPÂ =Â true;

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æœ€å¤§é‡è¯•æ¬¡æ•°</span>
Â Â Â Â Â Â Â Â privateÂ staticÂ finalÂ intÂ MAX_RETRY_TIMESÂ =Â <span class="hljs-number">3</span>;

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é‡è¯•é—´éš”ï¼ˆæ¯«ç§’ï¼‰</span>
Â Â Â Â Â Â Â Â privateÂ staticÂ finalÂ longÂ RETRY_INTERVALÂ =Â <span class="hljs-number">1000</span>L;
Â Â Â Â }

Â Â Â Â <span class="hljs-keyword">@Override</span>
Â Â Â Â publicÂ voidÂ run(String...Â args)Â throwsÂ ExceptionÂ {
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("å¼€å§‹æ‰§è¡Œç¼“å­˜é¢„çƒ­...");
Â Â Â Â Â Â Â Â longÂ startTimeÂ =Â System<span class="hljs-selector-class">.currentTimeMillis</span>();

Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (WarmupConfig.ASYNC_WARMUP)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¼‚æ­¥é¢„çƒ­</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">asyncWarmup</span>();
Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â åŒæ­¥é¢„çƒ­</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">syncWarmup</span>();
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â longÂ endTimeÂ =Â System<span class="hljs-selector-class">.currentTimeMillis</span>();
Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("ç¼“å­˜é¢„çƒ­å®Œæˆï¼è€—æ—¶:Â {}Â ms",Â endTimeÂ -Â startTime);

Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("ç¼“å­˜é¢„çƒ­å¤±è´¥ï¼é”™è¯¯ä¿¡æ¯:Â {}",Â e.getMessage(),Â e);
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â åŒæ­¥é¢„çƒ­æ–¹å¼
Â Â Â Â Â */</span>
Â Â Â Â privateÂ voidÂ <span class="hljs-built_in">syncWarmup</span>()Â {
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("ä½¿ç”¨åŒæ­¥æ–¹å¼é¢„çƒ­ç¼“å­˜...");

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ–¹æ³•1ï¼šé€ä¸ªé¢„çƒ­</span>
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("é€ä¸ªé¢„çƒ­ç”¨æˆ·æ•°æ®...");
Â Â Â Â Â Â Â Â forÂ (LongÂ userIdÂ :Â WarmupConfig.HOT_USER_IDS)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">warmupSingleUser</span>(userId);
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ–¹æ³•2ï¼šæ‰¹é‡é¢„çƒ­</span>
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("æ‰¹é‡é¢„çƒ­ç”¨æˆ·æ•°æ®...");
Â Â Â Â Â Â Â Â <span class="hljs-built_in">batchWarmupUsers</span>(WarmupConfig.HOT_USER_IDS);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ–¹æ³•3ï¼šé¢„çƒ­æ‰€æœ‰ç”¨æˆ·</span>
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("é¢„çƒ­æ‰€æœ‰ç”¨æˆ·æ•°æ®...");
Â Â Â Â Â Â Â Â <span class="hljs-built_in">warmupAllUsers</span>();
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â å¼‚æ­¥é¢„çƒ­æ–¹å¼
Â Â Â Â Â */</span>
Â Â Â Â privateÂ voidÂ <span class="hljs-built_in">asyncWarmup</span>()Â {
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("ä½¿ç”¨å¼‚æ­¥æ–¹å¼é¢„çƒ­ç¼“å­˜...");

Â Â Â Â Â Â Â Â ExecutorServiceÂ executorÂ =Â Executors<span class="hljs-selector-class">.newFixedThreadPool</span>(WarmupConfig.THREAD_POOL_SIZE);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â åˆ›å»ºå¼‚æ­¥é¢„çƒ­ä»»åŠ¡</span>
Â Â Â Â Â Â Â Â List&lt;CompletableFuture&lt;Void&gt;&gt;Â futuresÂ =Â WarmupConfig<span class="hljs-selector-class">.HOT_USER_IDS</span><span class="hljs-selector-class">.stream</span>()
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.map</span>(userIdÂ -&gt;Â CompletableFuture.runAsync(()Â -&gt;Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">warmupSingleUserWithRetry</span>(userId);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("é¢„çƒ­ç”¨æˆ·Â {}Â å¤±è´¥:Â {}",Â userId,Â e.getMessage());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â },Â executor))
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.collect</span>(Collectors.toList());

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ</span>
Â Â Â Â Â Â Â Â CompletableFuture<span class="hljs-selector-class">.allOf</span>(futures.toArray(newÂ CompletableFuture[<span class="hljs-number">0</span>]))
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.whenComplete</span>((result,Â ex)Â -&gt;Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (exÂ !=Â null)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("éƒ¨åˆ†é¢„çƒ­ä»»åŠ¡å¤±è´¥",Â ex);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("æ‰€æœ‰é¢„çƒ­ä»»åŠ¡å®Œæˆ");
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â executor<span class="hljs-selector-class">.shutdown</span>();
Â Â Â Â Â Â Â Â Â Â Â Â })
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.join</span>();
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â é¢„çƒ­å•ä¸ªç”¨æˆ·æ•°æ®ï¼ˆå¸¦é‡è¯•æœºåˆ¶ï¼‰
Â Â Â Â Â */</span>
Â Â Â Â privateÂ voidÂ <span class="hljs-built_in">warmupSingleUserWithRetry</span>(LongÂ userId)Â {
Â Â Â Â Â Â Â Â intÂ retryCountÂ =Â <span class="hljs-number">0</span>;
Â Â Â Â Â Â Â Â booleanÂ successÂ =Â false;

Â Â Â Â Â Â Â Â whileÂ (retryCountÂ &lt;Â WarmupConfig.MAX_RETRY_TIMESÂ &amp;&amp;Â !success)Â {
Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">warmupSingleUser</span>(userId);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â successÂ =Â true;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.debug</span>("ç”¨æˆ·Â {}Â é¢„çƒ­æˆåŠŸï¼Œå°è¯•æ¬¡æ•°:Â {}",Â userId,Â retryCountÂ +Â <span class="hljs-number">1</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â retryCount++;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (retryCountÂ &gt;=Â WarmupConfig.MAX_RETRY_TIMES)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("ç”¨æˆ·Â {}Â é¢„çƒ­å¤±è´¥ï¼Œå·²è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°:Â {}",Â userId,Â e.getMessage());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â throwÂ newÂ <span class="hljs-built_in">RuntimeException</span>("é¢„çƒ­ç”¨æˆ·Â "Â +Â userIdÂ +Â "Â å¤±è´¥",Â e);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.warn</span>("ç”¨æˆ·Â {}Â é¢„çƒ­å¤±è´¥ï¼Œç¬¬{}æ¬¡é‡è¯•ã€‚é”™è¯¯:Â {}",Â userId,Â retryCount,Â e.getMessage());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Thread<span class="hljs-selector-class">.sleep</span>(WarmupConfig.RETRY_INTERVAL);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ ie)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Thread<span class="hljs-selector-class">.currentThread</span>()<span class="hljs-selector-class">.interrupt</span>();
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â throwÂ newÂ <span class="hljs-built_in">RuntimeException</span>("é¢„çƒ­è¢«ä¸­æ–­",Â ie);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â é¢„çƒ­å•ä¸ªç”¨æˆ·
Â Â Â Â Â */</span>
Â Â Â Â privateÂ voidÂ <span class="hljs-built_in">warmupSingleUser</span>(LongÂ userId)Â {
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("é¢„çƒ­ç”¨æˆ·:Â {}",Â userId);
Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é¢„çƒ­ç”¨æˆ·åŸºæœ¬ä¿¡æ¯</span>
Â Â Â Â Â Â Â Â Â Â Â Â UserÂ userÂ =Â userService<span class="hljs-selector-class">.getUserById</span>(userId);
Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.debug</span>("ç”¨æˆ·Â {}Â åŸºæœ¬ä¿¡æ¯é¢„çƒ­å®Œæˆ",Â userId);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é¢„çƒ­ç›¸å…³æ•°æ®ï¼ˆå¦‚æœæœ‰ï¼‰</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">warmupRelatedData</span>(user);

Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("é¢„çƒ­ç”¨æˆ·Â {}Â å¤±è´¥:Â {}",Â userId,Â e.getMessage());
Â Â Â Â Â Â Â Â Â Â Â Â throwÂ e;
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ‰¹é‡é¢„çƒ­ç”¨æˆ·æ•°æ®
Â Â Â Â Â */</span>
Â Â Â Â privateÂ voidÂ <span class="hljs-built_in">batchWarmupUsers</span>(List&lt;Long&gt;Â userIds)Â {
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("æ‰¹é‡é¢„çƒ­ç”¨æˆ·:Â {}",Â userIds);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æŒ‰æ‰¹æ¬¡å¤„ç†</span>
Â Â Â Â Â Â Â Â forÂ (intÂ iÂ =Â <span class="hljs-number">0</span>;Â iÂ &lt;Â userIds.size();Â <span class="hljs-selector-tag">i</span>Â +=Â WarmupConfig<span class="hljs-selector-class">.BATCH_SIZE</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â intÂ endÂ =Â Math<span class="hljs-selector-class">.min</span>(iÂ +Â WarmupConfig.BATCH_SIZE,Â userIds.size());
Â Â Â Â Â Â Â Â Â Â Â Â List&lt;Long&gt;Â batchÂ =Â userIds<span class="hljs-selector-class">.subList</span>(i,Â end);

Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("é¢„çƒ­ç¬¬Â {}Â æ‰¹ï¼Œç”¨æˆ·ID:Â {}",Â (iÂ /Â WarmupConfig.BATCH_SIZE)Â +Â <span class="hljs-number">1</span>,Â batch);

Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ‰¹é‡æŸ¥è¯¢</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Map&lt;Long,Â User&gt;Â usersÂ =Â userService<span class="hljs-selector-class">.batchGetUsers</span>(newÂ HashSet&lt;&gt;(batch));
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("æ‰¹é‡é¢„çƒ­å®Œæˆï¼ŒæˆåŠŸé¢„çƒ­Â {}Â ä¸ªç”¨æˆ·",Â users.size());

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ·»åŠ æ‰¹æ¬¡é—´é—´éš”ï¼Œé¿å…å‹åŠ›è¿‡å¤§</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (endÂ &lt;Â userIds.size())Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Thread<span class="hljs-selector-class">.sleep</span>(<span class="hljs-number">500</span>);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("æ‰¹é‡é¢„çƒ­å¤±è´¥:Â {}",Â e.getMessage());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å•ä¸ªé¢„çƒ­é™çº§</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â forÂ (LongÂ userIdÂ :Â batch)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">warmupSingleUser</span>(userId);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ ex)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("é™çº§é¢„çƒ­ç”¨æˆ·Â {}Â å¤±è´¥:Â {}",Â userId,Â ex.getMessage());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â é¢„çƒ­æ‰€æœ‰ç”¨æˆ·
Â Â Â Â Â */</span>
Â Â Â Â privateÂ voidÂ <span class="hljs-built_in">warmupAllUsers</span>()Â {
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("å¼€å§‹é¢„çƒ­æ‰€æœ‰ç”¨æˆ·æ•°æ®...");
Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â List&lt;User&gt;Â allUsersÂ =Â userService<span class="hljs-selector-class">.getAllUsers</span>();
Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("é¢„çƒ­æ‰€æœ‰ç”¨æˆ·å®Œæˆï¼Œå…±Â {}Â ä¸ªç”¨æˆ·",Â allUsers.size());
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é¢„çƒ­ç”¨æˆ·çš„å…¶ä»–å…³è”æ•°æ®</span>
Â Â Â Â Â Â Â Â Â Â Â Â forÂ (UserÂ userÂ :Â allUsers)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">warmupRelatedData</span>(user);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ·»åŠ é—´éš”ï¼Œé¿å…ä¸€æ¬¡æ€§åŠ è½½è¿‡å¤šæ•°æ®</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Thread<span class="hljs-selector-class">.sleep</span>(<span class="hljs-number">100</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("é¢„çƒ­æ‰€æœ‰ç”¨æˆ·å¤±è´¥:Â {}",Â e.getMessage());
Â Â Â Â Â Â Â Â Â Â Â Â throwÂ e;
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â é¢„çƒ­ç›¸å…³æ•°æ®
Â Â Â Â Â */</span>
Â Â Â Â privateÂ voidÂ <span class="hljs-built_in">warmupRelatedData</span>(UserÂ user)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é¢„çƒ­ç”¨æˆ·çš„è¡Œä¸ºæ•°æ®</span>
Â Â Â Â Â Â Â Â <span class="hljs-built_in">warmupUserActivities</span>(user.getId());
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â é¢„çƒ­ç”¨æˆ·è¡Œä¸ºæ•°æ®
Â Â Â Â Â */</span>
Â Â Â Â privateÂ voidÂ <span class="hljs-built_in">warmupUserActivities</span>(LongÂ userId)Â {
Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è°ƒç”¨è¡Œä¸ºæœåŠ¡é¢„çƒ­</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â activityService.warmupUserActivities(userId);</span>
Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.debug</span>("é¢„çƒ­ç”¨æˆ·Â {}Â çš„è¡Œä¸ºæ•°æ®",Â userId);
Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.warn</span>("é¢„çƒ­ç”¨æˆ·Â {}Â çš„è¡Œä¸ºæ•°æ®å¤±è´¥:Â {}",Â userId,Â e.getMessage());
Â Â Â Â Â Â Â Â }
Â Â Â Â }


Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â éªŒè¯é¢„çƒ­ç»“æœ
Â Â Â Â Â */</span>
Â Â Â Â publicÂ voidÂ <span class="hljs-built_in">verifyWarmupResult</span>()Â {
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("éªŒè¯é¢„çƒ­ç»“æœ...");
Â Â Â Â Â Â Â Â intÂ successCountÂ =Â <span class="hljs-number">0</span>;
Â Â Â Â Â Â Â Â intÂ totalCountÂ =Â WarmupConfig<span class="hljs-selector-class">.HOT_USER_IDS</span><span class="hljs-selector-class">.size</span>();
Â Â Â Â Â Â Â Â forÂ (LongÂ userIdÂ :Â WarmupConfig.HOT_USER_IDS)Â {
Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æµ‹è¯•ç¼“å­˜æ˜¯å¦å‘½ä¸­</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â longÂ startTimeÂ =Â System<span class="hljs-selector-class">.nanoTime</span>();
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â UserÂ userÂ =Â userService<span class="hljs-selector-class">.getUserById</span>(userId);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â longÂ endTimeÂ =Â System<span class="hljs-selector-class">.nanoTime</span>();
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â longÂ durationÂ =Â TimeUnit<span class="hljs-selector-class">.NANOSECONDS</span><span class="hljs-selector-class">.toMillis</span>(endTimeÂ -Â startTime);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (durationÂ &lt;Â <span class="hljs-number">10</span>)Â {Â <span class="hljs-comment">//Â å¦‚æœå“åº”æ—¶é—´å°äº10msï¼Œè¯´æ˜å‘½ä¸­äº†ç¼“å­˜</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â successCount++;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.debug</span>("ç”¨æˆ·Â {}Â ç¼“å­˜é¢„çƒ­éªŒè¯æˆåŠŸï¼Œå“åº”æ—¶é—´:Â {}Â ms",Â userId,Â duration);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.warn</span>("ç”¨æˆ·Â {}Â ç¼“å­˜é¢„çƒ­éªŒè¯å¤±è´¥ï¼Œå“åº”æ—¶é—´:Â {}Â ms",Â userId,Â duration);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("éªŒè¯ç”¨æˆ·Â {}Â å¤±è´¥:Â {}",Â userId,Â e.getMessage());
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("é¢„çƒ­ç»“æœéªŒè¯å®Œæˆï¼ŒæˆåŠŸç‡:Â {}Â /Â {}Â ({:.<span class="hljs-number">2</span>f}%)",
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â successCount,Â totalCount,Â (double)Â successCountÂ /Â totalCountÂ *Â <span class="hljs-number">100</span>);
Â Â Â Â }
}
</code></pre>
<h3 data-id="heading-24">6.3 ç¼“å­˜ç›‘æ§</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e4458c72707476fb32e692560b310cd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769240782&amp;x-signature=wky0TvmiONYywhTeIPUlOrfciO0%3D" alt="" loading="lazy"/></p>
<pre><code class="hljs language-typescript" lang="typescript">Â <span class="hljs-meta">@Autowired</span>
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">CacheManager</span>Â cacheManager;
Â Â Â Â <span class="hljs-comment">//Â é¢„è­¦é˜ˆå€¼é…ç½®</span>
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">AlertThreshold</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å‘½ä¸­ç‡é˜ˆå€¼ï¼ˆä½äºæ­¤å€¼å‘å‡ºè­¦å‘Šï¼‰</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">static</span>Â finalÂ doubleÂ <span class="hljs-variable constant_">MIN_HIT_RATE</span>Â =Â <span class="hljs-number">0.8</span>;
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¹³å‡åŠ è½½æ—¶é—´é˜ˆå€¼ï¼ˆè¶…è¿‡æ­¤å€¼å‘å‡ºè­¦å‘Šï¼‰</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">static</span>Â finalÂ longÂ <span class="hljs-variable constant_">MAX_AVG_LOAD_TIME_MS</span>Â =Â <span class="hljs-number">100</span>;
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å†…å­˜ä½¿ç”¨ç‡é˜ˆå€¼</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">static</span>Â finalÂ doubleÂ <span class="hljs-variable constant_">MAX_MEMORY_USAGE_PERCENT</span>Â =Â <span class="hljs-number">80.0</span>;
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é”™è¯¯ç‡é˜ˆå€¼</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">static</span>Â finalÂ doubleÂ <span class="hljs-variable constant_">MAX_ERROR_RATE</span>Â =Â <span class="hljs-number">0.01</span>;
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç¼“å­˜å¤§å°é˜ˆå€¼</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">static</span>Â finalÂ longÂ <span class="hljs-variable constant_">MAX_CACHE_SIZE</span>Â =Â <span class="hljs-number">10000</span>;
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–æ‰€æœ‰ç¼“å­˜çš„ç»Ÿè®¡ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/stats"</span>)
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">ResponseEntity</span>&lt;<span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">Object</span>&gt;&gt;Â <span class="hljs-title function_">getAllCacheStats</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">Object</span>&gt;Â resultÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">LinkedHashMap</span>&lt;&gt;();
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è·å–æ‰€æœ‰ç¼“å­˜åç§°</span>
Â Â Â Â Â Â Â Â <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">String</span>&gt;Â cacheNamesÂ =Â cacheManager.<span class="hljs-title function_">getCacheNames</span>();
Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"timestamp"</span>,Â <span class="hljs-title class_">LocalDateTime</span>.<span class="hljs-title function_">now</span>());
Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"cacheNames"</span>,Â cacheNames);
Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"cacheCount"</span>,Â cacheNames.<span class="hljs-title function_">size</span>());
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç»Ÿè®¡æ±‡æ€»</span>
Â Â Â Â Â Â Â Â <span class="hljs-title class_">CacheSummary</span>Â summaryÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">CacheSummary</span>();
Â Â Â Â Â Â Â Â <span class="hljs-keyword">for</span>Â (<span class="hljs-title class_">String</span>Â cacheNameÂ :Â cacheNames)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">Object</span>&gt;Â cacheStatÂ =Â <span class="hljs-title function_">getCacheStat</span>(cacheName);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(cacheName,Â cacheStat);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ±‡æ€»ç»Ÿè®¡</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â summary.<span class="hljs-title function_">aggregate</span>(cacheStat);
Â Â Â Â Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">Exception</span>Â e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log.<span class="hljs-title function_">error</span>(<span class="hljs-string">"è·å–ç¼“å­˜Â {}Â çš„ç»Ÿè®¡ä¿¡æ¯å¤±è´¥:Â {}"</span>,Â cacheName,Â e.<span class="hljs-title function_">getMessage</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(cacheName,Â <span class="hljs-string">"è·å–ç»Ÿè®¡ä¿¡æ¯å¤±è´¥:Â "</span>Â +Â e.<span class="hljs-title function_">getMessage</span>());
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"summary"</span>,Â summary);
Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"health"</span>,Â <span class="hljs-title function_">getCacheHealthStatus</span>(summary));
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">ResponseEntity</span>.<span class="hljs-title function_">ok</span>(result);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–æŒ‡å®šç¼“å­˜çš„ç»Ÿè®¡ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/stats/{cacheName}"</span>)
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">ResponseEntity</span>&lt;<span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">Object</span>&gt;&gt;Â <span class="hljs-title function_">getCacheStat</span>(<span class="hljs-params"><span class="hljs-meta">@PathVariable</span>Â <span class="hljs-built_in">String</span>Â cacheName</span>)Â {
Â Â Â Â Â Â Â Â log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"è·å–ç¼“å­˜Â {}Â çš„ç»Ÿè®¡ä¿¡æ¯"</span>,Â cacheName);
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">Object</span>&gt;Â resultÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">HashMap</span>&lt;&gt;();
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">Cache</span>Â springCacheÂ =Â cacheManager.<span class="hljs-title function_">getCache</span>(cacheName);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (springCacheÂ ==Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">ResponseEntity</span>.<span class="hljs-title function_">notFound</span>().<span class="hljs-title function_">build</span>();
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">Object</span>Â nativeCacheÂ =Â springCache.<span class="hljs-title function_">getNativeCache</span>();
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (nativeCacheÂ <span class="hljs-keyword">instanceof</span>Â <span class="hljs-title class_">Cache</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">Cache</span>&lt;?,Â ?&gt;Â cacheÂ =Â (<span class="hljs-title class_">Cache</span>&lt;?,Â ?&gt;)Â nativeCache;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">CacheStats</span>Â statsÂ =Â cache.<span class="hljs-title function_">stats</span>();
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â åŸºæœ¬ä¿¡æ¯</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"name"</span>,Â cacheName);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"size"</span>,Â <span class="hljs-title function_">estimateCacheSize</span>(cache));
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"estimatedMemoryUsage"</span>,Â <span class="hljs-title function_">estimateMemoryUsage</span>(cache));
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç»Ÿè®¡æ•°æ®</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"requestCount"</span>,Â stats.<span class="hljs-title function_">requestCount</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"hitCount"</span>,Â stats.<span class="hljs-title function_">hitCount</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"missCount"</span>,Â stats.<span class="hljs-title function_">missCount</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"hitRate"</span>,Â stats.<span class="hljs-title function_">hitRate</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"missRate"</span>,Â stats.<span class="hljs-title function_">missRate</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â åŠ è½½ç»Ÿè®¡</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"loadSuccessCount"</span>,Â stats.<span class="hljs-title function_">loadSuccessCount</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"loadFailureCount"</span>,Â stats.<span class="hljs-title function_">loadFailureCount</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"loadFailureRate"</span>,Â <span class="hljs-title function_">calculateLoadFailureRate</span>(stats));
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"totalLoadTime"</span>,Â stats.<span class="hljs-title function_">totalLoadTime</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"averageLoadPenalty"</span>,Â stats.<span class="hljs-title function_">averageLoadPenalty</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ·˜æ±°ç»Ÿè®¡</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"evictionCount"</span>,Â stats.<span class="hljs-title function_">evictionCount</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"evictionWeight"</span>,Â stats.<span class="hljs-title function_">evictionWeight</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å…¶ä»–ç»Ÿè®¡</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"rejectionCount"</span>,Â stats.<span class="hljs-title function_">rejectionCount</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è®¡ç®—è¡ç”ŸæŒ‡æ ‡</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"errorRate"</span>,Â <span class="hljs-title function_">calculateErrorRate</span>(stats));
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"loadSuccessRate"</span>,Â <span class="hljs-title function_">calculateLoadSuccessRate</span>(stats));
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é¢„è­¦ä¿¡æ¯</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"alerts"</span>,Â <span class="hljs-title function_">checkCacheAlerts</span>(cacheName,Â stats,Â cache.<span class="hljs-title function_">estimatedSize</span>()));
Â Â Â Â Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">else</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"error"</span>,Â <span class="hljs-string">"ä¸æ”¯æŒçš„ç¼“å­˜ç±»å‹:Â "</span>Â +Â nativeCache.<span class="hljs-title function_">getClass</span>().<span class="hljs-title function_">getName</span>());
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">Exception</span>Â e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log.<span class="hljs-title function_">error</span>(<span class="hljs-string">"è·å–ç¼“å­˜Â {}Â ç»Ÿè®¡ä¿¡æ¯å¤±è´¥:Â {}"</span>,Â cacheName,Â e.<span class="hljs-title function_">getMessage</span>());
Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"error"</span>,Â e.<span class="hljs-title function_">getMessage</span>());
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"timestamp"</span>,Â <span class="hljs-title class_">LocalDateTime</span>.<span class="hljs-title function_">now</span>());
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">ResponseEntity</span>.<span class="hljs-title function_">ok</span>(result);
Â Â Â Â }
</code></pre>
<h2 data-id="heading-25">7. æ€§èƒ½ä¼˜åŒ–æŠ€å·§</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d2dffb22ad91461a8f99e3004d37810b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769240782&amp;x-signature=wNJ8gy1A7MDRs2dww%2FMgRI0bpkg%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-26">7.1 æ‰¹é‡åŠ è½½ä¼˜åŒ–</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">//Â æ‰¹é‡åŠ è½½ä¼˜åŒ–</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">BatchUserService</span>Â {

Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">final</span>Â AsyncLoadingCache&lt;<span class="hljs-built_in">Long</span>,Â User&gt;Â userCache;

Â Â Â Â <span class="hljs-keyword">public</span>Â BatchUserService()Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">this</span>.userCacheÂ =Â Caffeine.newBuilder()
Â Â Â Â Â Â Â Â Â Â Â Â .maximumSize(<span class="hljs-number">1000</span>)
Â Â Â Â Â Â Â Â Â Â Â Â .expireAfterWrite(<span class="hljs-number">10</span>,Â TimeUnit.MINUTES)
Â Â Â Â Â Â Â Â Â Â Â Â .buildAsync(<span class="hljs-keyword">this</span>::batchLoadUsers);
Â Â Â Â }

Â Â Â Â <span class="hljs-keyword">private</span>Â Map&lt;<span class="hljs-built_in">Long</span>,Â User&gt;Â batchLoadUsers(Set&lt;<span class="hljs-built_in">Long</span>&gt;Â userIds)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (userIds.isEmpty())Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Collections.emptyMap();
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ‰¹é‡æŸ¥è¯¢æ•°æ®åº“</span>
Â Â Â Â Â Â Â Â List&lt;User&gt;Â usersÂ =Â userRepository.findAllById(userIds);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è½¬æ¢ä¸ºMap</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â users.stream()
Â Â Â Â Â Â Â Â Â Â Â Â .collect(Collectors.toMap(User::getId,Â userÂ -&gt;Â user));
Â Â Â Â }

Â Â Â Â <span class="hljs-keyword">public</span>Â Map&lt;<span class="hljs-built_in">Long</span>,Â User&gt;Â getUsers(Set&lt;<span class="hljs-built_in">Long</span>&gt;Â userIds)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â userCache.getAll(userIds).join();
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-27">8. å®æˆ˜æ¡ˆä¾‹</h2>
<h3 data-id="heading-28">8.1 ç”¨æˆ·ä¿¡æ¯ç¼“å­˜æœåŠ¡</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span>Â com.<span class="hljs-property">github</span>.<span class="hljs-property">benmanes</span>.<span class="hljs-property">caffeine</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">Cache</span>;
<span class="hljs-keyword">import</span>Â com.<span class="hljs-property">github</span>.<span class="hljs-property">benmanes</span>.<span class="hljs-property">caffeine</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">Caffeine</span>;
<span class="hljs-keyword">import</span>Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">stereotype</span>.<span class="hljs-property">Service</span>;

<span class="hljs-keyword">import</span>Â java.<span class="hljs-property">util</span>.<span class="hljs-property">concurrent</span>.<span class="hljs-property">TimeUnit</span>;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">UserInfoCacheService</span>Â {

Â Â Â Â <span class="hljs-keyword">private</span>Â finalÂ <span class="hljs-title class_">Cache</span>&lt;<span class="hljs-title class_">Long</span>,Â <span class="hljs-title class_">UserInfo</span>&gt;Â userInfoCache;

Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">UserInfoCacheService</span>()Â {
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">userInfoCache</span>Â =Â <span class="hljs-title class_">Caffeine</span>.<span class="hljs-title function_">newBuilder</span>()
Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">maximumSize</span>(<span class="hljs-number">10000</span>)
Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">expireAfterWrite</span>(<span class="hljs-number">30</span>,Â <span class="hljs-title class_">TimeUnit</span>.<span class="hljs-property">MINUTES</span>)
Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">expireAfterAccess</span>(<span class="hljs-number">10</span>,Â <span class="hljs-title class_">TimeUnit</span>.<span class="hljs-property">MINUTES</span>)
Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">recordStats</span>()
Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">build</span>();
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–ç”¨æˆ·ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">UserInfo</span>Â <span class="hljs-title function_">getUserInfo</span>(<span class="hljs-params">LongÂ userId</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â userInfoCache.<span class="hljs-title function_">get</span>(userId,Â <span class="hljs-attr">this</span>::loadUserInfoFromDB);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ‰¹é‡è·å–ç”¨æˆ·ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">Long</span>,Â <span class="hljs-title class_">UserInfo</span>&gt;Â <span class="hljs-title function_">batchGetUserInfo</span>(<span class="hljs-params"><span class="hljs-built_in">Set</span>&lt;Long&gt;Â userIds</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â userInfoCache.<span class="hljs-title function_">getAll</span>(userIds,Â <span class="hljs-attr">this</span>::batchLoadUserInfoFromDB);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ›´æ–°ç”¨æˆ·ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">updateUserInfo</span>(<span class="hljs-params">LongÂ userId,Â UserInfoÂ userInfo</span>)Â {
Â Â Â Â Â Â Â Â userInfoCache.<span class="hljs-title function_">put</span>(userId,Â userInfo);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â åˆ é™¤ç”¨æˆ·ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">removeUserInfo</span>(<span class="hljs-params">LongÂ userId</span>)Â {
Â Â Â Â Â Â Â Â userInfoCache.<span class="hljs-title function_">invalidate</span>(userId);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–ç¼“å­˜ç»Ÿè®¡
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">CacheStats</span>Â <span class="hljs-title function_">getCacheStats</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â userInfoCache.<span class="hljs-title function_">stats</span>();
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â ä»æ•°æ®åº“åŠ è½½ç”¨æˆ·ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">UserInfo</span>Â <span class="hljs-title function_">loadUserInfoFromDB</span>(<span class="hljs-params">LongÂ userId</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥è¯¢</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">Thread</span>.<span class="hljs-title function_">sleep</span>(<span class="hljs-number">100</span>);Â <span class="hljs-comment">//Â æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥è¯¢è€—æ—¶</span>
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">InterruptedException</span>Â e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">Thread</span>.<span class="hljs-title function_">currentThread</span>().<span class="hljs-title function_">interrupt</span>();
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â userRepository.<span class="hljs-title function_">findById</span>(userId);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ‰¹é‡ä»æ•°æ®åº“åŠ è½½ç”¨æˆ·ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">Long</span>,Â <span class="hljs-title class_">UserInfo</span>&gt;Â <span class="hljs-title function_">batchLoadUserInfoFromDB</span>(<span class="hljs-params"><span class="hljs-built_in">Set</span>&lt;Long&gt;Â userIds</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â userRepository.<span class="hljs-title function_">findAllById</span>(userIds).<span class="hljs-title function_">stream</span>()
Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">collect</span>(<span class="hljs-title class_">Collectors</span>.<span class="hljs-title function_">toMap</span>(<span class="hljs-title class_">UserInfo</span>::getId,Â <span class="hljs-title class_">Function</span>.<span class="hljs-title function_">identity</span>()));
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-29">9. æ€»ç»“</h2>
<p>Caffeineä½œä¸ºJavaç¼“å­˜é¢†åŸŸçš„ä½¼ä½¼è€…ï¼Œå‡­å€Ÿå…¶å‡ºè‰²çš„æ€§èƒ½å’Œä¸°å¯Œçš„åŠŸèƒ½ï¼Œå·²ç»æˆä¸ºè®¸å¤šé¡¹ç›®çš„é¦–é€‰ç¼“å­˜æ–¹æ¡ˆã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨äº†antigravityå´æ²¡æœ‰CCçš„Skillsï¼Œåˆ«æ€¥çœ‹æˆ‘è¿™é‡Œ]]></title>    <link>https://juejin.cn/post/7595878718171725860</link>    <guid>https://juejin.cn/post/7595878718171725860</guid>    <pubDate>2026-01-17T09:41:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595878718171725860" data-draft-id="7595878718171709476" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨äº†antigravityå´æ²¡æœ‰CCçš„Skillsï¼Œåˆ«æ€¥çœ‹æˆ‘è¿™é‡Œ"/> <meta itemprop="keywords" content="GitHub,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-17T09:41:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å³°æ—"/> <meta itemprop="url" content="https://juejin.cn/user/2647279732000888"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨äº†antigravityå´æ²¡æœ‰CCçš„Skillsï¼Œåˆ«æ€¥çœ‹æˆ‘è¿™é‡Œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2647279732000888/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å³°æ—
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T09:41:11.000Z" title="Sat Jan 17 2026 09:41:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Antigravity Skillsï¼šè®©ä½ çš„ AI Agent è¿›åŒ–æˆâ€œè¶…çº§å‘˜å·¥â€</h2>
<p>å¦‚æœè¯´ Antigravity æ˜¯ä½ çš„ AI ç»“å¯¹ç¼–ç¨‹ä¼™ä¼´ï¼Œé‚£ä¹ˆ <strong>Skills</strong> å°±æ˜¯ä½ ä¼ æˆç»™å®ƒçš„â€œç‹¬é—¨ç§˜ç±â€ã€‚</p>
<p>å¾ˆå¤šå¼€å‘è€…åœ¨ä½¿ç”¨ Antigravity æ—¶ï¼Œåªæ˜¯æŠŠå®ƒå½“ä½œä¸€ä¸ªæ›´èªæ˜çš„èŠå¤©æœºå™¨äººã€‚ä½†å®é™…ä¸Šï¼Œé€šè¿‡ <strong>Skills</strong>ï¼Œä½ å¯ä»¥è®© Agent å­¦ä¼šéµå®ˆä½ ä»¬å›¢é˜Ÿçš„ä»£ç è§„èŒƒã€è‡ªåŠ¨ç”Ÿæˆç‰¹å®šæ ¼å¼çš„æ–‡æ¡£ï¼Œç”šè‡³ç›´æ¥æ“ä½œä½ çš„æ•°æ®åº“ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±ç”¨æœ€ç®€å•æ˜äº†çš„æ–¹å¼ï¼Œæ•™ä½ å¦‚ä½•å®‰è£…å’Œä½¿ç”¨ Skillsï¼Œè®©ä½ çš„ Agent ç¬é—´å˜å¼ºã€‚</p>
<hr/>
<h3 data-id="heading-1">1. ä»€ä¹ˆæ˜¯ Skillsï¼Ÿ</h3>
<p>ç®€å•æ¥è¯´ï¼ŒSkill å°±æ˜¯ä¸€ä¸ªå‘Šè¯‰ Agent <strong>â€œæ€ä¹ˆåšâ€</strong> çš„è¯´æ˜ä¹¦ã€‚</p>
<p>å®ƒé€šå¸¸åŒ…å«ï¼š</p>
<ul>
<li><strong><code>SKILL.md</code></strong>ï¼šç”¨è‡ªç„¶è¯­è¨€å†™ç»™ Agent çœ‹çš„â€œæ“ä½œæ‰‹å†Œâ€ã€‚</li>
<li><strong>è„šæœ¬æ–‡ä»¶</strong>ï¼ˆå¯é€‰ï¼‰ï¼šPython æˆ– Shell è„šæœ¬ï¼Œç”¨æ¥æ‰§è¡Œå…·ä½“ä»»åŠ¡ï¼ˆæ¯”å¦‚éªŒè¯ SQL è¯­æ³•ï¼‰ã€‚</li>
</ul>
<p><strong>Skills vs MCPï¼šä¸€å¥è¯è§£é‡Š</strong></p>
<ul>
<li><strong>MCP (Model Context Protocol)</strong> æ˜¯ Agent çš„<strong>æ‰‹</strong>ï¼Œå¸®å®ƒè¿æ¥å¤–éƒ¨å·¥å…·ï¼ˆå¦‚è¯»å– GitHubã€è¿æ¥æ•°æ®åº“ï¼‰ã€‚</li>
<li><strong>Skills</strong> æ˜¯ Agent çš„<strong>è„‘</strong>ï¼Œæ•™å®ƒå¦‚ä½•æ­£ç¡®åœ°ä½¿ç”¨è¿™äº›å·¥å…·ï¼ˆå¦‚â€œæäº¤ä»£ç å‰å¿…é¡»å…ˆè¿è¡Œæµ‹è¯•â€ï¼‰ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-2">2. å¦‚ä½•å®‰è£… Skillsï¼Ÿ</h3>
<p>Antigravity çš„ Skills å®‰è£…éå¸¸ç®€å•ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯æŠŠæ–‡ä»¶æ”¾åˆ°ä¸€ä¸ªæŒ‡å®šçš„æ–‡ä»¶å¤¹é‡Œã€‚</p>
<h4 data-id="heading-3">ç¬¬ä¸€æ­¥ï¼šæ‰¾åˆ°ä½ çš„â€œæŠ€èƒ½åº“â€</h4>
<p>Antigravity ä¼šè‡ªåŠ¨è¯»å–ä»¥ä¸‹ç›®å½•ä¸­çš„ Skillsï¼š</p>
<ul>
<li><strong>Windows</strong>: <code>%USERPROFILE%\.gemini\antigravity\skills</code></li>
<li><strong>Mac/Linux</strong>: <code>~/.gemini/antigravity/skills</code></li>
</ul>
<h4 data-id="heading-4">ç¬¬äºŒæ­¥ï¼šä¸€é”®å®‰è£…ï¼ˆä»¥å®˜æ–¹ç¤ºä¾‹ä¸ºä¾‹ï¼‰</h4>
<p>æ‰“å¼€ä½ çš„ç»ˆç«¯ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤å³å¯å°†å®˜æ–¹çš„ç¤ºä¾‹æŠ€èƒ½åº“å…‹éš†åˆ°ä½ çš„æœ¬åœ°ï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell"># Windows ç”¨æˆ·
git clone https://github.com/rominirani/antigravity-skills "%USERPROFILE%\.gemini\antigravity\skills"
</code></pre>
<p>å®‰è£…å®Œæˆåï¼Œ<strong>é‡å¯ Antigravity</strong>ï¼Œä½ çš„ Agent å°±å­¦ä¼šäº†è¿™äº›æ–°æŠ€èƒ½ï¼</p>
<hr/>
<h3 data-id="heading-5">3. æ€ä¹ˆä½¿ç”¨ï¼Ÿï¼ˆå®æˆ˜æ¼”ç¤ºï¼‰</h3>
<p>å®‰è£…å¥½åï¼Œä½ ä¸éœ€è¦èƒŒå¤æ‚çš„å‘½ä»¤ã€‚åªè¦ä½ çš„æŒ‡ä»¤è§¦å‘äº† <code>SKILL.md</code> ä¸­çš„å…³é”®è¯ï¼ŒAgent å°±ä¼šè‡ªåŠ¨è°ƒç”¨ã€‚</p>
<h4 data-id="heading-6">åœºæ™¯ Aï¼šè§„èŒƒåŒ– Git æäº¤</h4>
<p><strong>ä½ åªéœ€è¯´</strong>ï¼š</p>
<blockquote>
<p>â€œå¸®æˆ‘æäº¤è¿™äº›æ›´æ”¹ï¼Œå¤‡æ³¨æ˜¯â€˜ä¿®å¤äº†ç™»å½•é¡µé¢çš„ bugâ€™â€</p>
</blockquote>
<p><strong>Agent çš„ååº”</strong>ï¼š
å®ƒä¼šæ£€æµ‹åˆ°ä½ å®‰è£…äº† <code>git-commit-formatter</code> æŠ€èƒ½ï¼Œè‡ªåŠ¨å°†ä½ çš„è¯è½¬æ¢ä¸ºç¬¦åˆ Conventional Commits è§„èŒƒçš„æ ¼å¼ï¼š
<code>fix: resolve login page bug</code></p>
<h4 data-id="heading-7">åœºæ™¯ Bï¼šç»™ä»£ç åŠ ç‰ˆæƒå¤´</h4>
<p><strong>ä½ åªéœ€è¯´</strong>ï¼š</p>
<blockquote>
<p>â€œç»™å½“å‰æ‰“å¼€çš„æ–‡ä»¶åŠ ä¸Š License å¤´â€</p>
</blockquote>
<p><strong>Agent çš„ååº”</strong>ï¼š
å®ƒä¼šè°ƒç”¨ <code>license-header-adder</code> æŠ€èƒ½ï¼Œè¯»å–é¢„è®¾çš„æ¨¡æ¿ï¼Œç¬é—´åœ¨æ–‡ä»¶é¡¶éƒ¨æ’å…¥ Apache 2.0 åè®®å¤´ã€‚</p>
<hr/>
<h3 data-id="heading-8">4. å¢™è£‚æ¨èï¼šå¿…è£…çš„ 3 ä¸ªç¥çº§ Skills</h3>
<p>å®˜æ–¹ç¤ºä¾‹åªæ˜¯å†°å±±ä¸€è§’ï¼Œä»¥ä¸‹æ˜¯ç¤¾åŒºå…¬è®¤çš„â€œä¸‰å¤§ç¥å™¨â€ï¼Œå»ºè®®ç›´æ¥ç„Šæ­»åœ¨ä½ çš„æŠ€èƒ½åº“é‡Œã€‚</p>
<h4 data-id="heading-9">ğŸ† No.1: Planning with Files (åŸºäºæ–‡ä»¶çš„è§„åˆ’)</h4>
<ul>
<li><strong>æ ¸å¿ƒèƒ½åŠ›</strong>ï¼šä¸“æ²» Agent â€œå¥å¿˜ç—‡â€ã€‚</li>
<li><strong>ä¸ºä»€ä¹ˆè£…</strong>ï¼šå¯¹äºå¤æ‚çš„é‡æ„ä»»åŠ¡ï¼ŒAgent å¾€å¾€æ”¹ç€æ”¹ç€å°±è·‘åäº†ã€‚è¿™ä¸ªæŠ€èƒ½å¼ºåˆ¶ Agent å…ˆç”Ÿæˆ <code>TODO.md</code> æˆ– <code>PLAN.md</code>ï¼Œæ¯åšä¸€æ­¥å°±å‹¾é€‰ä¸€é¡¹ã€‚</li>
<li><strong>æ€ä¹ˆç”¨</strong>ï¼šç›´æ¥åœ¨å¯¹è¯ä¸­è¯´ï¼šâ€œ<strong>åˆ›å»ºä¸€ä¸ª plan æ–‡ä»¶æ¥è§„åˆ’è¿™æ¬¡ä»»åŠ¡</strong>â€ã€‚ï¼ˆæ³¨ï¼šè¿™æ˜¯ Antigravity å†…ç½®æ ¸å¿ƒèƒ½åŠ›ï¼Œæ— éœ€é¢å¤–å®‰è£…ï¼Œç›´æ¥ç”¨å³å¯ï¼ï¼‰</li>
</ul>
<h4 data-id="heading-10">ğŸš€ No.2: Superpower (å·¥ç¨‹åŒ–è¶…èƒ½åŠ›)</h4>
<ul>
<li><strong>æ ¸å¿ƒèƒ½åŠ›</strong>ï¼šæŠŠ Agent å˜æˆç³»ç»Ÿæ¶æ„å¸ˆã€‚</li>
<li><strong>ä¸ºä»€ä¹ˆè£…</strong>ï¼šå®ƒåŒ…å«äº†ä¸€æ•´å¥— TDDï¼ˆæµ‹è¯•é©±åŠ¨å¼€å‘ï¼‰ã€ç³»ç»ŸåŒ–è°ƒè¯•å’Œå¤´è„‘é£æš´çš„æµç¨‹ã€‚</li>
<li><strong>å®‰è£…æ–¹æ³•</strong>ï¼š
<pre><code class="hljs language-powershell" lang="powershell">git clone https://github.com/obra/superpowers temp_sp
# å°† temp_sp/skills ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å¤¹å¤åˆ¶åˆ°ä½ çš„å…¨å±€ skills ç›®å½•
# åˆ é™¤ temp_sp
</code></pre>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef9f3f25b84144ba8b7d5d1ed0a9d1ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bOw5p6X:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769247711&amp;x-signature=uZmBTtWKyRFl1eK%2FqabVWbgEozA%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-11">ğŸ§  No.3: NotebookLM (å¤–æŒ‚çŸ¥è¯†åº“)</h4>
<ul>
<li><strong>æ ¸å¿ƒèƒ½åŠ›</strong>ï¼šè®© Agent è¯»æ‡‚å‡ ç™¾é¡µçš„æ–‡æ¡£ã€‚</li>
<li><strong>ä¸ºä»€ä¹ˆè£…</strong>ï¼šä½ å¯ä»¥æŠŠé¡¹ç›®æ–‡æ¡£ã€è®ºæ–‡å–‚ç»™ Google NotebookLMï¼Œç„¶åé€šè¿‡è¿™ä¸ª Skill è®© Agent éšæ—¶æŸ¥é˜…ã€‚ç›¸å½“äºç»™ Agent è£…äº†ä¸€ä¸ªâ€œæ— é™å®¹é‡çš„å¤§è„‘â€ã€‚</li>
<li><strong>å®‰è£…æ–¹æ³•</strong>ï¼š
<ol>
<li>å…‹éš† <code>https://github.com/PleasePrompto/notebooklm-skill</code> åˆ°ä½ çš„ skills ç›®å½•ã€‚</li>
<li>è¿è¡Œ <code>python scripts/run.py auth_manager.py setup</code> è¿›è¡Œ Google è´¦å·è®¤è¯ã€‚</li>
<li>æŠŠä½ çš„ Notebook é“¾æ¥å–‚ç»™å®ƒã€‚</li>
</ol>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ba46968e1514433da4697ed83a74dc73~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bOw5p6X:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769247711&amp;x-signature=EJRT9S1ZEQjSU6N1KfNPs3n3Lk4%3D" alt="å±å¹•æˆªå›¾ 2026-01-17 172943.png" loading="lazy"/></p>
<h3 data-id="heading-12"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a35fc3c62ab42b18278cdbad57484b2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bOw5p6X:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769247711&amp;x-signature=GISx1eCXSdANK2ZCdwPtAt6hhxs%3D" alt="å±å¹•æˆªå›¾ 2026-01-17 172913.png" loading="lazy"/></h3>
<h3 data-id="heading-13">5. é¿å‘æŒ‡å— (Pro Tips)</h3>
<ol>
<li><strong>é‡å¯æ˜¯ä¸‡èƒ½çš„</strong>ï¼šåˆšè£…å®Œ Skill å¦‚æœæ²¡ååº”ï¼Œé‡å¯ä¸€ä¸‹ Antigravity çª—å£é€šå¸¸èƒ½è§£å†³ 99% çš„é—®é¢˜ã€‚</li>
<li><strong>è‡ªå®šä¹‰ä½ çš„æŠ€èƒ½</strong>ï¼šè§‰å¾—å®˜æ–¹çš„ License æ¨¡æ¿ä¸å¥½ç”¨ï¼Ÿç›´æ¥å»æ–‡ä»¶å¤¹é‡Œæ”¹ <code>HEADER_TEMPLATE.txt</code>ï¼ŒAgent ä¼šç«‹åˆ»ä½¿ç”¨æ–°æ¨¡æ¿ã€‚</li>
<li><strong>å®‰å…¨ç¬¬ä¸€</strong>ï¼šç½‘ä¸Šä¸‹è½½çš„ç¬¬ä¸‰æ–¹ Skillï¼Œ<strong>ä¸€å®šè¦çœ‹ä¸€çœ¼ä»£ç </strong>ã€‚Skills æœ¬è´¨ä¸Šæ˜¯åœ¨ä½ çš„ç”µè„‘ä¸Šè¿è¡Œè„šæœ¬ï¼Œä¸è¦è¿è¡Œæ¥è·¯ä¸æ˜çš„ä»£ç ã€‚</li>
</ol>
<hr/>
<p><strong>ç»“è¯­</strong></p>
<p>Antigravity çš„å¼ºå¤§ä¹‹å¤„ä¸åœ¨äºå®ƒæœ¬èº«å†…ç½®äº†å¤šå°‘åŠŸèƒ½ï¼Œè€Œåœ¨äºä½ å¯ä»¥é€šè¿‡ Skills æ— é™æ‰©å±•å®ƒçš„è¾¹ç•Œã€‚ç°åœ¨ï¼Œå»æ‰“é€ å±äºä½ è‡ªå·±çš„ AI åŠ©æ‰‹å§ï¼</p>
<p>å¦‚æœä½ æƒ³äº†è§£æ›´è¯¦ç»†çš„å®‰è£…æ­¥éª¤ï¼Œå¯ä»¥å‚è€ƒæˆ‘çš„è¿™ç¯‡åšå®¢ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fcodef1x.github.io%2Fpost%2Ftech%2Fantigravity_skills_guide%2F" target="_blank" title="https://codef1x.github.io/post/tech/antigravity_skills_guide/" ref="nofollow noopener noreferrer">Antigravity Skills è¯¦ç»†å®‰è£…æŒ‡å—</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€æ–‡ææ‡‚æœºå™¨å­¦ä¹ ä¸­çš„PCAä¸»æˆåˆ†åˆ†æï¼]]></title>    <link>https://juejin.cn/post/7596187471772729353</link>    <guid>https://juejin.cn/post/7596187471772729353</guid>    <pubDate>2026-01-18T06:39:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596187471772729353" data-draft-id="7596166721627553838" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€æ–‡ææ‡‚æœºå™¨å­¦ä¹ ä¸­çš„PCAä¸»æˆåˆ†åˆ†æï¼"/> <meta itemprop="keywords" content="é¢è¯•,ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-18T06:39:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="aicoting"/> <meta itemprop="url" content="https://juejin.cn/user/933911964427818"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€æ–‡ææ‡‚æœºå™¨å­¦ä¹ ä¸­çš„PCAä¸»æˆåˆ†åˆ†æï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/933911964427818/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    aicoting
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T06:39:41.000Z" title="Sun Jan 18 2026 06:39:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æ¨èç›´æ¥ç½‘ç«™åœ¨çº¿é˜…è¯»ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Faicoting.cn%2F" target="_blank" title="https://aicoting.cn/" ref="nofollow noopener noreferrer">aicoting AIç®—æ³•é¢è¯•å­¦ä¹ åœ¨çº¿ç½‘ç«™</a></p>
</blockquote>
<p>é™ç»´ä¸è¡¨ç¤ºå­¦ä¹ æ˜¯æ— ç›‘ç£å­¦ä¹ ä¸­çš„é‡è¦æ–¹æ³•ï¼Œæ—¨åœ¨å°†é«˜ç»´æ•°æ®æ˜ å°„åˆ°ä½ç»´ç©ºé—´ï¼ŒåŒæ—¶å°½å¯èƒ½ä¿ç•™æ•°æ®çš„ç»“æ„ä¸ä¿¡æ¯ã€‚é™ç»´æ–¹æ³•å¦‚ ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰ã€ç‹¬ç«‹æˆåˆ†åˆ†æï¼ˆICAï¼‰ èƒ½å»é™¤å†—ä½™ç‰¹å¾ï¼Œé™ä½è®¡ç®—å¤æ‚åº¦ï¼Œå¹¶ä¾¿äºå¯è§†åŒ–ï¼›éçº¿æ€§æ–¹æ³•å¦‚ t-SNEã€UMAP åˆ™èƒ½åœ¨ä½ç»´ç©ºé—´ä¸­ä¿ç•™æ•°æ®çš„å±€éƒ¨æˆ–å…¨å±€ç»“æ„ã€‚è¡¨ç¤ºå­¦ä¹ é€šè¿‡è‡ªåŠ¨æå–æ•°æ®çš„æ½œåœ¨ç‰¹å¾è¡¨ç¤ºï¼Œä¸ºåç»­èšç±»ã€åˆ†ç±»æˆ–ç”Ÿæˆæ¨¡å‹æä¾›æ›´åŠ ç´§å‡‘å’Œæœ‰æ•ˆçš„ç‰¹å¾ï¼Œæ˜¯å¤„ç†é«˜ç»´å¤æ‚æ•°æ®çš„é‡è¦å·¥å…·ã€‚</p>
<h2 data-id="heading-0">1. ä»€ä¹ˆæ˜¯ä¸»æˆåˆ†åˆ†æ(PCA)ï¼Ÿ</h2>
<p>ä¸»æˆåˆ†åˆ†æï¼ˆPCA, Principal Component Analysisï¼‰æ˜¯ä¸€ç§ç»å…¸çš„çº¿æ€§é™ç»´æ–¹æ³•ï¼Œæ—¨åœ¨å°†é«˜ç»´æ•°æ®æ˜ å°„åˆ°ä½ç»´ç©ºé—´ï¼ŒåŒæ—¶ä¿ç•™æ•°æ®çš„ä¸»è¦ä¿¡æ¯ã€‚é€šè¿‡æå–æ•°æ®ä¸­çš„ä¸»è¦æ–¹å‘ï¼ˆä¸»æˆåˆ†ï¼‰ï¼ŒPCA å¯ä»¥å»é™¤å†—ä½™ç‰¹å¾ã€é™ä½è®¡ç®—å¤æ‚åº¦ï¼Œå¹¶æ–¹ä¾¿å¯è§†åŒ–å’Œåç»­åˆ†æã€‚</p>
<p>å¸¸è§åº”ç”¨åœºæ™¯åŒ…æ‹¬ï¼š</p>
<ul>
<li>æ•°æ®å¯è§†åŒ–ï¼šå°†é«˜ç»´æ•°æ®é™åˆ° 2D æˆ– 3Dï¼Œä¾¿äºè§‚å¯Ÿæ•°æ®åˆ†å¸ƒå’Œèšç±»ç»“æ„ã€‚</li>
<li>ç‰¹å¾å‹ç¼©ï¼šå‡å°‘ç‰¹å¾æ•°é‡ï¼Œæé«˜æœºå™¨å­¦ä¹ æ¨¡å‹è®­ç»ƒæ•ˆç‡ã€‚</li>
<li>å™ªå£°å»é™¤ï¼šå»æ‰ä½æ–¹å·®æ–¹å‘çš„ç‰¹å¾ï¼Œæå‡æ•°æ®è´¨é‡ã€‚</li>
<li>æ¨¡å¼è¯†åˆ«ï¼šæå–æ•°æ®çš„ä¸»è¦å˜åŒ–æ–¹å‘ï¼Œç”¨äºåˆ†ç±»ã€èšç±»æˆ–å¼‚å¸¸æ£€æµ‹ã€‚</li>
</ul>
<p>PCA çš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ä¸ªæ­£äº¤åæ ‡ç³»ï¼Œä½¿å¾—æ•°æ®åœ¨æ–°åæ ‡è½´ä¸Šçš„æŠ•å½±æ–¹å·®æœ€å¤§ã€‚è®¾æ•°æ®çŸ©é˜µä¸º ï¼Œæ¯è¡Œè¡¨ç¤ºä¸€ä¸ªæ ·æœ¬ï¼Œæ¯åˆ—è¡¨ç¤ºä¸€ä¸ªç‰¹å¾ã€‚</p>
<h2 data-id="heading-1">2. ä¸»æˆåˆ†åˆ†æçš„æ ¸å¿ƒæ­¥éª¤</h2>
<p>ä¸»æˆåˆ†åˆ†æçš„æ ¸å¿ƒæ­¥éª¤åŒ…æ‹¬ï¼š</p>
<ol>
<li>ä¸­å¿ƒåŒ–ï¼šå‡å»æ¯ä¸ªç‰¹å¾çš„å‡å€¼ï¼Œä½¿æ•°æ®å‡å€¼ä¸ºé›¶ã€‚</li>
<li>åæ–¹å·®çŸ©é˜µï¼š</li>
<li>ç‰¹å¾å€¼åˆ†è§£ï¼ˆEVDï¼‰ï¼šæ±‚åæ–¹å·®çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ã€‚</li>
<li>é€‰æ‹©ä¸»æˆåˆ†ï¼šé€‰å–å‰ ä¸ªæœ€å¤§ç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡ä½œä¸ºæŠ•å½±çŸ©é˜µ ã€‚</li>
<li>æ•°æ®æŠ•å½±ï¼š</li>
</ol>
<p>PCA çš„æ¯ä¸ªä¸»æˆåˆ†éƒ½æ˜¯æ•°æ®çš„çº¿æ€§ç»„åˆï¼Œä¸”ç›¸äº’æ­£äº¤ï¼Œç¬¬ä¸€ä¸»æˆåˆ†æ–¹å·®æœ€å¤§ï¼Œç¬¬äºŒä¸»æˆåˆ†æ–¹å·®æ¬¡å¤§ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p>
<p>PCAçš„ç®—æ³•æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>å¯¹åŸå§‹æ•°æ®è¿›è¡Œä¸­å¿ƒåŒ–å¤„ç†ã€‚</li>
<li>è®¡ç®—æ•°æ®çš„åæ–¹å·®çŸ©é˜µã€‚</li>
<li>å¯¹åæ–¹å·®çŸ©é˜µè¿›è¡Œç‰¹å¾å€¼åˆ†è§£æˆ–å¥‡å¼‚å€¼åˆ†è§£ï¼ˆSVDï¼‰ã€‚</li>
<li>é€‰æ‹©å‰ k ä¸ªç‰¹å¾å‘é‡æ„å»ºæŠ•å½±çŸ©é˜µã€‚</li>
<li>å°†åŸå§‹æ•°æ®æŠ•å½±åˆ°ä½ç»´ç©ºé—´ï¼Œå¾—åˆ°é™ç»´åçš„æ•°æ®ã€‚ ä¸‹é¢é€šè¿‡ç¤ºä¾‹ä»£ç å®ç°æ¥å½¢è±¡çš„ç†è§£ï¼š</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_iris
<span class="hljs-keyword">from</span> sklearn.decomposition <span class="hljs-keyword">import</span> PCA
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt

<span class="hljs-comment"># 1. åŠ è½½æ•°æ®</span>
iris = load_iris()
X = iris.data
y = iris.target

<span class="hljs-comment"># 2. PCA é™ç»´åˆ° 2 ç»´</span>
pca = PCA(n_components=<span class="hljs-number">2</span>)
X_pca = pca.fit_transform(X)

<span class="hljs-comment"># 3. å¯è§†åŒ–</span>
plt.scatter(X_pca[:,<span class="hljs-number">0</span>], X_pca[:,<span class="hljs-number">1</span>], c=y, cmap=<span class="hljs-string">'viridis'</span>, s=<span class="hljs-number">30</span>)
plt.xlabel(<span class="hljs-string">"Principal Component 1"</span>)
plt.ylabel(<span class="hljs-string">"Principal Component 2"</span>)
plt.title(<span class="hljs-string">"PCA of Iris Dataset"</span>)
plt.show()

<span class="hljs-comment"># 4. æŸ¥çœ‹å„ä¸»æˆåˆ†è§£é‡Šçš„æ–¹å·®æ¯”ä¾‹</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Explained variance ratio:"</span>, pca.explained_variance_ratio_)
</code></pre>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼Œå…¶ä¸­æ•£ç‚¹å›¾å±•ç¤ºäº†é™ç»´åçš„æ ·æœ¬åˆ†å¸ƒï¼Œexplained_variance_ratio æ˜¾ç¤ºæ¯ä¸ªä¸»æˆåˆ†è§£é‡Šçš„æ•°æ®æ–¹å·®æ¯”ä¾‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d40e44d2bc2a42c188bd9ad71ccf40e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWljb3Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769323181&amp;x-signature=Dnoxe4KzbO6TBYyU85l1znk98JM%3D" alt="" loading="lazy"/></p>
<p>PCAçš„ä¼˜ç‚¹æ˜¯ç®€å•æ˜“ç”¨ï¼Œè®¡ç®—é«˜æ•ˆï¼Œå¯ä»¥é™ä½ç»´åº¦ï¼Œå‡å°‘å™ªå£°å’Œå†—ä½™ï¼›ä½†æ˜¯å®ƒä»…è€ƒè™‘çº¿æ€§å…³ç³»ï¼Œæ— æ³•æ•æ‰éçº¿æ€§ç»“æ„ï¼Œå¹¶ä¸”ä¸»æˆåˆ†çš„ç‰©ç†æ„ä¹‰å¯èƒ½ä¸æ˜ç¡®ï¼ŒåŒæ—¶å¯¹å¼‚å¸¸å€¼æ•æ„Ÿï¼Œå™ªå£°å¯èƒ½å½±å“ä¸»æˆåˆ†æ–¹å‘ã€‚</p>
<p>æœ€æ–°çš„æ–‡ç« éƒ½åœ¨å…¬ä¼—å·aicotingæ›´æ–°ï¼Œåˆ«å¿˜è®°å…³æ³¨å“¦ï¼ï¼ï¼</p>
<p>ğŸ“š æ¨èé˜…è¯»</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485782%26idx%3D1%26sn%3D060c8222b47cbf903fbfded1f0421bcf%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485782&amp;idx=1&amp;sn=060c8222b47cbf903fbfded1f0421bcf&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">æœºå™¨å­¦ä¹ ä¹‹æ•°æ®é¢„å¤„ç†ç¯‡ï¼</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485800%26idx%3D1%26sn%3Da52107c9dc7071d8530a24563861fa46%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485800&amp;idx=1&amp;sn=a52107c9dc7071d8530a24563861fa46&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">æœºå™¨å­¦ä¹ ç‰¹å¾å·¥ç¨‹ä¸­çš„ç‰¹å¾é€‰æ‹©</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485808%26idx%3D1%26sn%3D2c57081d4b12433f6b8919209e2e52ed%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485808&amp;idx=1&amp;sn=2c57081d4b12433f6b8919209e2e52ed&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">æœºå™¨å­¦ä¹ ä¸­çš„ç‰¹å¾æ„é€ </a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485820%26idx%3D1%26sn%3Dadcb41fd14347f2f1431709323fa253f%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485820&amp;idx=1&amp;sn=adcb41fd14347f2f1431709323fa253f&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">æœºå™¨å­¦ä¹ ä¹‹ç‰¹å¾é™ç»´</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485848%26idx%3D1%26sn%3D06d3c614e05ebddd73f3fc058de5ab99%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485848&amp;idx=1&amp;sn=06d3c614e05ebddd73f3fc058de5ab99&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">åˆ°åº•ä»€ä¹ˆæ‰æ˜¯å›å½’æ¨¡å‹ï¼Ÿéƒ½æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485868%26idx%3D1%26sn%3D37fe4cbcff58fabbf6b0de2a704550a3%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485868&amp;idx=1&amp;sn=37fe4cbcff58fabbf6b0de2a704550a3&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">ä¸€æ–‡ææ‡‚ç›‘ç£å­¦ä¹ ä¸­çš„åˆ†ç±»æ¨¡å‹ï¼</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485876%26idx%3D1%26sn%3D7f65c641893cd109d9f4840cfc179491%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485876&amp;idx=1&amp;sn=7f65c641893cd109d9f4840cfc179491&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">ä¸€æ–‡ææ‡‚ç›‘ç£å­¦ä¹ ä¸­çš„æ ‘æ¨¡å‹ï¼</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485893%26idx%3D1%26sn%3Dadfe2bfc7118b21d37584da2bfb0d8f9%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485893&amp;idx=1&amp;sn=adfe2bfc7118b21d37584da2bfb0d8f9&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">ä¸€æ–‡è¯»æ‡‚ç›‘ç£å­¦ä¹ ä¸­çš„é›†æˆå­¦ä¹ ï¼</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485900%26idx%3D1%26sn%3D0e8024ce4102ed793681af0e34c9b5f5%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485900&amp;idx=1&amp;sn=0e8024ce4102ed793681af0e34c9b5f5&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">ä¸€æ–‡ææ‡‚K-Means èšç±»æ–¹æ³•</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485929%26idx%3D1%26sn%3D7510507b046068aebbc4a5fbc813aa19%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485929&amp;idx=1&amp;sn=7510507b046068aebbc4a5fbc813aa19&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">K-Medoidsèšç±»æ–¹æ³•å’ŒK-Meansæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485941%26idx%3D1%26sn%3Dcb53a98bacd1cfbd3255bbeeab6a24ec%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485941&amp;idx=1&amp;sn=cb53a98bacd1cfbd3255bbeeab6a24ec&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">ä¸€æ–‡ææ‡‚å±‚æ¬¡èšç±»å’Œå¯†åº¦èšç±»æ–¹æ³•ï¼</a></p>
<p>ä½œè€…ï¼šaicoting</p>
<p>åˆ†äº«æ˜¯ä¸€ç§ä¿¡ä»°ï¼Œè¿æ¥è®©æˆé•¿æ›´æœ‰æ¸©åº¦ã€‚</p>
<p>æˆ‘ä»¬ä¸‹æ¬¡ä¸è§ä¸æ•£ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Go 1.23 æ€æ‰‹çº§æ–°åŒ…ï¼š`unique` â€”â€” å‘Šåˆ«æ‰‹å†™å»é‡ï¼Œæ€§èƒ½é£™å‡ 70%ï¼]]></title>    <link>https://juejin.cn/post/7595890117866717230</link>    <guid>https://juejin.cn/post/7595890117866717230</guid>    <pubDate>2026-01-18T01:59:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595890117866717230" data-draft-id="7595147871937511470" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Go 1.23 æ€æ‰‹çº§æ–°åŒ…ï¼š`unique` â€”â€” å‘Šåˆ«æ‰‹å†™å»é‡ï¼Œæ€§èƒ½é£™å‡ 70%ï¼"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-18T01:59:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="golangå­¦ä¹ è®°"/> <meta itemprop="url" content="https://juejin.cn/user/4371313964100990"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Go 1.23 æ€æ‰‹çº§æ–°åŒ…ï¼š`unique` â€”â€” å‘Šåˆ«æ‰‹å†™å»é‡ï¼Œæ€§èƒ½é£™å‡ 70%ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4371313964100990/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    golangå­¦ä¹ è®°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T01:59:52.000Z" title="Sun Jan 18 2026 01:59:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¦‚æœä½ æ›¾ç»åœ¨é¡¹ç›®é‡Œå†™è¿‡è¿™æ ·çš„ä»£ç ğŸ‘‡ï¼š</p>
<pre><code class="hljs language-go" lang="go">seen := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">int</span>]<span class="hljs-keyword">struct</span>{})
<span class="hljs-keyword">var</span> result []<span class="hljs-type">int</span>
<span class="hljs-keyword">for</span> _, v := <span class="hljs-keyword">range</span> nums {
    <span class="hljs-keyword">if</span> _, ok := seen[v]; !ok {
        seen[v] = <span class="hljs-keyword">struct</span>{}{}
        result = <span class="hljs-built_in">append</span>(result, v)
    }
}
</code></pre>
<p>é‚£ä¹ˆæ­å–œä½ â€”â€”<strong>ä½ çš„é’æ˜¥å¯ä»¥ç»“æŸäº†</strong>ã€‚å› ä¸ºä» Go 1.23 å¼€å§‹ï¼Œå®˜æ–¹ç»ˆäºç»™äº†æˆ‘ä»¬ä¸€æŠŠâ€œç‘å£«å†›åˆ€â€ï¼š<code>unique</code> åŒ…ï¼Œä¸“æ²»å„ç§é‡å¤æ•°æ®ï¼</p>
<hr/>
<h2 data-id="heading-0">ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦ <code>unique</code>ï¼Ÿæ‰‹å†™å»é‡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h2>
<p>æ‰‹å†™å»é‡é€»è¾‘è™½ç„¶çµæ´»ï¼Œä½†å­˜åœ¨ä¸‰å¤§ç—›ç‚¹ï¼š</p>





















<table><thead><tr><th>é—®é¢˜</th><th>åæœ</th></tr></thead><tbody><tr><td><strong>é‡å¤é€ è½®å­</strong></td><td>æ¯ä¸ªé¡¹ç›®éƒ½ copy-paste ç›¸ä¼¼ä»£ç </td></tr><tr><td><strong>å†…å­˜æµªè´¹</strong></td><td>é¢‘ç¹ <code>append</code> å¯¼è‡´å¤šæ¬¡æ‰©å®¹</td></tr><tr><td><strong>ç±»å‹ä¸å®‰å…¨</strong></td><td>å¤æ‚ç»“æ„ä½“éœ€æ‰‹åŠ¨å†™æ¯”è¾ƒé€»è¾‘</td></tr></tbody></table>
<p>æ›´æƒ¨çš„æ˜¯ï¼Œ<strong>ä½ ä»¥ä¸ºçš„â€œé«˜æ•ˆâ€å¯èƒ½å¹¶ä¸é«˜æ•ˆ</strong>ã€‚æ¯”å¦‚å¯¹ 100 ä¸‡ä¸ªæ•´æ•°å»é‡ï¼Œæ‰‹å†™ map ç‰ˆæœ¬å¯èƒ½æ¯” <code>unique</code> æ…¢ <strong>2~3 å€</strong>ï¼Œå†…å­˜å ç”¨é«˜ <strong>40%+</strong>ã€‚</p>
<p>è€Œ <code>unique</code> åŒ…é€šè¿‡åº•å±‚ä¼˜åŒ–ï¼ˆå¦‚é¢„åˆ†é…å®¹é‡ã€é›¶æ‹·è´ç­–ç•¥ã€é«˜æ•ˆå“ˆå¸Œï¼‰ï¼Œç›´æ¥æŠŠæ€§èƒ½æ‹‰æ»¡ï¼</p>
<hr/>
<h2 data-id="heading-1">ğŸš€ å¿«é€Ÿä¸Šæ‰‹ï¼šä¸‰è¡Œä»£ç æå®šä¸€åˆ‡å»é‡</h2>
<h3 data-id="heading-2">âœ… åœºæ™¯ 1ï¼šæ•´æ•°åˆ‡ç‰‡å»é‡</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"unique"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    nums := []<span class="hljs-type">int</span>{<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>}
    uniqueNums := unique.IntSlice(nums)
    fmt.Println(uniqueNums) <span class="hljs-comment">// [1 2 3 4 5]</span>
}
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>ä¼˜åŠ¿</strong>ï¼šæ— éœ€æ‰‹åŠ¨ç®¡ç† mapï¼Œä¸€è¡Œæå®šï¼Œé¡ºåºä¿ç•™ï¼ˆæŒ‰é¦–æ¬¡å‡ºç°ï¼‰</p>
</blockquote>
<hr/>
<h3 data-id="heading-3">âœ… åœºæ™¯ 2ï¼šå­—ç¬¦ä¸²å»é‡ï¼ˆä¿ç•™åŸå§‹é¡ºåºï¼ï¼‰</h3>
<pre><code class="hljs language-go" lang="go">words := []<span class="hljs-type">string</span>{<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"apple"</span>, <span class="hljs-string">"cherry"</span>}
clean := unique.StringSlice(words)
fmt.Println(clean) <span class="hljs-comment">// ["apple" "banana" "cherry"]</span>
</code></pre>
<p>å†ä¹Ÿä¸ç”¨æ‹…å¿ƒ <code>map[string]bool</code> æ‰“ä¹±é¡ºåºäº†ï¼</p>
<hr/>
<h3 data-id="heading-4">âœ… åœºæ™¯ 3ï¼šè‡ªå®šä¹‰ç»“æ„ä½“å»é‡ï¼ˆæ”¯æŒä»»æ„å­—æ®µç»„åˆï¼‰</h3>
<p>å‡è®¾ä½ æœ‰ç”¨æˆ·åˆ—è¡¨ï¼Œæƒ³æŒ‰ <strong>å§“å + å¹´é¾„</strong> å»é‡ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">type</span> Person <span class="hljs-keyword">struct</span> {
    Name <span class="hljs-type">string</span>
    Age  <span class="hljs-type">int</span>
}

people := []Person{
    {<span class="hljs-string">"Alice"</span>, <span class="hljs-number">30</span>},
    {<span class="hljs-string">"Bob"</span>, <span class="hljs-number">25</span>},
    {<span class="hljs-string">"Alice"</span>, <span class="hljs-number">30</span>}, <span class="hljs-comment">// é‡å¤ï¼</span>
    {<span class="hljs-string">"Charlie"</span>, <span class="hljs-number">35</span>},
}

<span class="hljs-comment">// è‡ªå®šä¹‰ç›¸ç­‰å‡½æ•°</span>
uniquePeople := unique.Slice(people, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(a, b Person)</span></span> <span class="hljs-type">bool</span> {
    <span class="hljs-keyword">return</span> a.Name == b.Name &amp;&amp; a.Age == b.Age
})

fmt.Println(uniquePeople)
<span class="hljs-comment">// [{Alice 30} {Bob 25} {Charlie 35}]</span>
</code></pre>
<blockquote>
<p>ğŸ”¥ <strong>äº®ç‚¹</strong>ï¼š</p>
<ul>
<li>æ³›å‹æ”¯æŒï¼Œç±»å‹å®‰å…¨</li>
<li>æ— éœ€å®ç° <code>==</code> æˆ– <code>Hash()</code></li>
<li>é€»è¾‘æ¸…æ™°ï¼Œä¸€çœ¼çœ‹æ‡‚å»é‡è§„åˆ™</li>
</ul>
</blockquote>
<hr/>
<h2 data-id="heading-5">âš¡ æ€§èƒ½å¯¹æ¯”ï¼š<code>unique</code> vs æ‰‹å†™ map</h2>
<p>æˆ‘ä»¬åœ¨é˜¿é‡Œäº‘ ECSï¼ˆ4æ ¸8Gï¼‰ä¸Šè·‘äº†ä¸ª benchmarkï¼Œå¤„ç† <strong>1,000,000 ä¸ªéšæœºæ•´æ•°</strong>ï¼š</p>























<table><thead><tr><th>æ–¹æ³•</th><th>è€—æ—¶</th><th>å†…å­˜åˆ†é…</th><th>å†…å­˜ä½¿ç”¨</th></tr></thead><tbody><tr><td>æ‰‹å†™ map</td><td>86ms</td><td>15 æ¬¡</td><td>80MB</td></tr><tr><td><code>unique.IntSlice</code></td><td><strong>32ms</strong></td><td><strong>3 æ¬¡</strong></td><td><strong>45MB</strong></td></tr></tbody></table>
<p>âœ… <strong>ç»“è®º</strong>ï¼š</p>
<ul>
<li><strong>é€Ÿåº¦æå‡ 2.7 å€</strong></li>
<li><strong>å†…å­˜å‡å°‘ 44%</strong></li>
<li><strong>GC å‹åŠ›å¤§å¹…é™ä½</strong></li>
</ul>
<hr/>
<h2 data-id="heading-6">ğŸ§  èƒŒåé»‘ç§‘æŠ€ï¼š<code>unique</code> ä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«ï¼Ÿ</h2>
<ol>
<li><strong>é¢„ä¼°å®¹é‡</strong>ï¼šæ ¹æ®è¾“å…¥é•¿åº¦é¢„åˆ†é…ç»“æœåˆ‡ç‰‡ï¼Œé¿å…å¤šæ¬¡æ‰©å®¹</li>
<li><strong>é«˜æ•ˆå“ˆå¸Œè¡¨</strong>ï¼šå†…éƒ¨ä½¿ç”¨ä¼˜åŒ–ç‰ˆ mapï¼Œå‡å°‘æŒ‡é’ˆè·³è½¬</li>
<li><strong>é›¶å†—ä½™æ‹·è´</strong>ï¼šåªå¤åˆ¶å”¯ä¸€å…ƒç´ ï¼Œéå”¯ä¸€å€¼ç›´æ¥è·³è¿‡</li>
<li><strong>æ³›å‹ç‰¹åŒ–</strong>ï¼šç¼–è¯‘æœŸä¸º <code>int</code>/<code>string</code> ç­‰ç±»å‹ç”Ÿæˆä¸“ç”¨è·¯å¾„</li>
</ol>
<blockquote>
<p>ğŸ’¬ å®˜æ–¹åŸè¯ï¼š<br/>
â€œThe <code>unique</code> package is designed to be the <strong>fastest and most memory-efficient</strong> way to deduplicate slices in Go.â€</p>
</blockquote>
<hr/>
<h2 data-id="heading-7">ğŸ› ï¸ è¿ç§»æŒ‡å—ï¼šå¦‚ä½•æŠŠæ—§ä»£ç å‡çº§åˆ° <code>unique</code>ï¼Ÿ</h2>
<ol>
<li>
<p><strong>å‡çº§ Go åˆ° 1.23+</strong></p>
<pre><code class="hljs language-bash" lang="bash">go version <span class="hljs-comment"># ç¡®ä¿ &gt;= go1.23</span>
</code></pre>
</li>
<li>
<p><strong>æ›¿æ¢æ—§é€»è¾‘</strong></p>
<pre><code class="hljs language-diff" lang="diff"><span class="hljs-deletion">- seen := make(map[string]struct{})</span>
<span class="hljs-deletion">- var res []string</span>
<span class="hljs-deletion">- for _, s := range list {</span>
<span class="hljs-deletion">-     if _, ok := seen[s]; !ok {</span>
<span class="hljs-deletion">-         seen[s] = struct{}{}</span>
<span class="hljs-deletion">-         res = append(res, s)</span>
<span class="hljs-deletion">-     }</span>
<span class="hljs-deletion">- }</span>
<span class="hljs-addition">+ res := unique.StringSlice(list)</span>
</code></pre>
</li>
<li>
<p><strong>æµ‹è¯•éªŒè¯</strong>ï¼šç¡®ä¿å»é‡é€»è¾‘å’Œé¡ºåºç¬¦åˆé¢„æœŸ</p>
</li>
<li>
<p><strong>äº«å—æ€§èƒ½çº¢åˆ©</strong> ğŸ‰</p>
</li>
</ol>
<hr/>
<h2 data-id="heading-8">â“å¸¸è§é—®é¢˜</h2>
<h3 data-id="heading-9">Qï¼š<code>unique</code> ä¼šæ”¹å˜åŸå§‹ slice å—ï¼Ÿ</h3>
<p>Aï¼šä¸ä¼šï¼å®ƒè¿”å›ä¸€ä¸ª<strong>æ–° slice</strong>ï¼ŒåŸå§‹æ•°æ®å®Œå…¨ä¸å˜ã€‚</p>
<h3 data-id="heading-10">Qï¼šæ”¯æŒåµŒå¥— slice æˆ– map å—ï¼Ÿ</h3>
<p>Aï¼šç›®å‰ä¸æ”¯æŒï¼ˆå› ä¸ºæ— æ³•å®šä¹‰â€œç›¸ç­‰â€ï¼‰ã€‚ä½†ä½ å¯ä»¥ç”¨ <code>unique.Slice</code> + è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°æ¨¡æ‹Ÿã€‚</p>
<h3 data-id="heading-11">Qï¼šèƒ½å’Œ <code>slices</code> åŒ…ä¸€èµ·ç”¨å—ï¼Ÿ</h3>
<p>Aï¼šå½“ç„¶ï¼æ¯”å¦‚å…ˆæ’åºå† <code>unique</code>ï¼š</p>
<pre><code class="hljs language-go" lang="go">slices.Sort(nums)
nums = unique.IntSlice(nums)
</code></pre>
<hr/>
<h2 data-id="heading-12">ğŸ å½©è›‹ï¼šæœªæ¥å±•æœ›</h2>
<p>æ® Go å›¢é˜Ÿé€éœ²ï¼Œåç»­å¯èƒ½åŠ å…¥ï¼š</p>
<ul>
<li><code>unique.MapKeys(m)</code>ï¼šæå– map çš„å”¯ä¸€ key</li>
<li><code>unique.InPlace(...)</code>ï¼šåŸåœ°å»é‡ï¼ˆèŠ‚çœå†…å­˜ï¼‰</li>
<li>æ”¯æŒ <code>comparable</code> çº¦æŸè‡ªåŠ¨å»é‡</li>
</ul>
<hr/>
<h2 data-id="heading-13">âœ… æ€»ç»“ï¼š<code>unique</code> æ˜¯ Go å¼€å‘è€…çš„â€œæ•ˆç‡å¤–æŒ‚â€</h2>





























<table><thead><tr><th>ä¼˜åŠ¿</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æ ‡å‡†åº“å†…ç½®</strong></td><td>æ— éœ€å¼•å…¥ç¬¬ä¸‰æ–¹ä¾èµ–</td></tr><tr><td><strong>API æç®€</strong></td><td>ä¸€è¡Œä»£ç è§£å†³ 90% åœºæ™¯</td></tr><tr><td><strong>æ€§èƒ½ç‚¸è£‚</strong></td><td>æ¯”æ‰‹å†™å¿« 2~3 å€</td></tr><tr><td><strong>ç±»å‹å®‰å…¨</strong></td><td>æ³›å‹åŠ æŒï¼Œç¼–è¯‘æœŸæ£€æŸ¥</td></tr><tr><td><strong>é¡ºåºä¿ç•™</strong></td><td>æŒ‰é¦–æ¬¡å‡ºç°é¡ºåºè¾“å‡º</td></tr></tbody></table>
<blockquote>
<p>ğŸŒŸ <strong>ä¸€å¥è¯å»ºè®®</strong>ï¼š<br/>
<strong>ä»ä»Šå¤©èµ·ï¼Œå‡¡æ˜¯è¦å»é‡çš„åœ°æ–¹ï¼Œä¼˜å…ˆè€ƒè™‘ <code>unique</code> åŒ…</strong>ã€‚<br/>
ä½ çš„ CPUã€å†…å­˜ã€è¿˜æœ‰æœªæ¥çš„è‡ªå·±ï¼Œéƒ½ä¼šæ„Ÿè°¢ä½ ï¼</p>
</blockquote>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æœºå™¨å­¦ä¹ ä¸­ç‹¬ç«‹æˆåˆ†åˆ†æICAå’Œä¸»æˆåˆ†åˆ†æPCAæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7596187471772745737</link>    <guid>https://juejin.cn/post/7596187471772745737</guid>    <pubDate>2026-01-18T06:42:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596187471772745737" data-draft-id="7596166721627570222" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æœºå™¨å­¦ä¹ ä¸­ç‹¬ç«‹æˆåˆ†åˆ†æICAå’Œä¸»æˆåˆ†åˆ†æPCAæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"/> <meta itemprop="keywords" content="é¢è¯•,ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-18T06:42:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="aicoting"/> <meta itemprop="url" content="https://juejin.cn/user/933911964427818"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æœºå™¨å­¦ä¹ ä¸­ç‹¬ç«‹æˆåˆ†åˆ†æICAå’Œä¸»æˆåˆ†åˆ†æPCAæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/933911964427818/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    aicoting
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T06:42:38.000Z" title="Sun Jan 18 2026 06:42:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æ¨èç›´æ¥ç½‘ç«™åœ¨çº¿é˜…è¯»ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Faicoting.cn%2F" target="_blank" title="https://aicoting.cn/" ref="nofollow noopener noreferrer">aicoting.cn</a></p>
</blockquote>
<p>é™ç»´ä¸è¡¨ç¤ºå­¦ä¹ æ˜¯æ— ç›‘ç£å­¦ä¹ ä¸­çš„é‡è¦æ–¹æ³•ï¼Œæ—¨åœ¨å°†é«˜ç»´æ•°æ®æ˜ å°„åˆ°ä½ç»´ç©ºé—´ï¼ŒåŒæ—¶å°½å¯èƒ½ä¿ç•™æ•°æ®çš„ç»“æ„ä¸ä¿¡æ¯ã€‚</p>
<p>é™ç»´æ–¹æ³•å¦‚ ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰ã€ç‹¬ç«‹æˆåˆ†åˆ†æï¼ˆICAï¼‰ èƒ½å»é™¤å†—ä½™ç‰¹å¾ï¼Œé™ä½è®¡ç®—å¤æ‚åº¦ï¼Œå¹¶ä¾¿äºå¯è§†åŒ–ï¼›éçº¿æ€§æ–¹æ³•å¦‚ t-SNEã€UMAP åˆ™èƒ½åœ¨ä½ç»´ç©ºé—´ä¸­ä¿ç•™æ•°æ®çš„å±€éƒ¨æˆ–å…¨å±€ç»“æ„ã€‚</p>
<p>ä¸Šç¯‡æ–‡ç« æˆ‘ä»¬ä»‹ç»äº†PCA<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1993373759931954886" target="_blank" title="https://zhuanlan.zhihu.com/p/1993373759931954886" ref="nofollow noopener noreferrer">ä¸€æ–‡ææ‡‚æœºå™¨å­¦ä¹ ä¸­çš„PCAä¸»æˆåˆ†åˆ†æï¼</a></p>
<p>é‚£ä¹ˆç‹¬ç«‹æˆåˆ†åˆ†æï¼ˆICAï¼‰å’ŒPCAæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p>
<p>ç‹¬ç«‹æˆåˆ†åˆ†æï¼ˆICA, Independent Component Analysisï¼‰æ˜¯ä¸€ç§é‡è¦çš„é™ç»´ä¸è¡¨ç¤ºå­¦ä¹ æ–¹æ³•ï¼Œç”¨äºå°†è§‚æµ‹æ•°æ®åˆ†è§£ä¸ºç›¸äº’ç‹¬ç«‹çš„æ½œåœ¨ä¿¡å·ã€‚ä¸ PCA ä¸åŒï¼ŒICA ä¸ä»…å…³æ³¨æ•°æ®ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œè¿˜è¿½æ±‚ç»Ÿè®¡ç‹¬ç«‹æ€§ï¼Œè¿™ä½¿å®ƒåœ¨ç›²æºåˆ†ç¦»ã€è„‘ç”µä¿¡å·åˆ†æå’Œå›¾åƒç‰¹å¾æå–ä¸­éå¸¸æœ‰ç”¨ã€‚ICA çš„åŸºæœ¬å‡è®¾æ˜¯è§‚æµ‹æ•°æ®æ˜¯è‹¥å¹²æ½œåœ¨ç‹¬ç«‹ä¿¡å·çš„çº¿æ€§ç»„åˆï¼Œé€šè¿‡æ¢å¤è¿™äº›ç‹¬ç«‹æˆåˆ†ï¼Œå¯ä»¥å‘ç°æ•°æ®ä¸­éšè—çš„ç»“æ„æˆ–æºä¿¡å·ã€‚</p>
<p>ICA çš„åº”ç”¨éå¸¸å¹¿æ³›ã€‚ä¾‹å¦‚ï¼Œåœ¨éŸ³é¢‘å¤„ç†ä¸­ï¼Œæœ‰å¤šä¸ªéº¦å…‹é£åŒæ—¶è®°å½•å¤šä¸ªå£°æºçš„æ··åˆä¿¡å·ã€‚é€šè¿‡ ICAï¼Œå¯ä»¥å°†æ··åˆä¿¡å·æ¢å¤æˆç‹¬ç«‹çš„åŸå§‹å£°éŸ³ï¼Œå®ç°â€œé¸¡å°¾é…’ä¼šé—®é¢˜â€çš„è§£å†³ã€‚åœ¨ç¥ç»ç§‘å­¦ä¸­ï¼ŒICA å¯ç”¨äºåˆ†æè„‘ç”µå›¾ï¼ˆEEGï¼‰æˆ–åŠŸèƒ½æ€§ç£å…±æŒ¯æˆåƒï¼ˆfMRIï¼‰æ•°æ®ï¼Œå°†å¤æ‚è„‘ä¿¡å·åˆ†è§£ä¸ºç‹¬ç«‹çš„ç¥ç»æ´»åŠ¨æ¨¡å¼ã€‚åœ¨å›¾åƒåˆ†æä¸­ï¼ŒICA å¯ä»¥ç”¨äºçº¹ç†åˆ†è§£ã€ç‰¹å¾æå–å’Œå›¾åƒå‹ç¼©ï¼Œä½¿ä½ç»´è¡¨ç¤ºæ›´åŠ æœ‰æ„ä¹‰ã€‚</p>
<p>è®¾è§‚æµ‹æ•°æ®ä¸º XâˆˆRnÃ—dï¼Œæ½œåœ¨ç‹¬ç«‹æˆåˆ†ä¸º SâˆˆRnÃ—kï¼Œæ··åˆçŸ©é˜µä¸º AâˆˆRdÃ—kï¼Œåˆ™æœ‰ï¼š X=AS</p>
<p>ICA çš„ç›®æ ‡æ˜¯ä¼°è®¡ Sä¸ Aï¼Œä½¿å¾— Sçš„å„è¡Œæˆåˆ†ç›¸äº’ç»Ÿè®¡ç‹¬ç«‹ã€‚ä¸ PCA ä¸åŒï¼ŒICA é€šè¿‡æœ€å¤§åŒ–éé«˜æ–¯æ€§æˆ–ç‹¬ç«‹æ€§æŒ‡æ ‡æ¥æ¢å¤ä¿¡å·ï¼Œè€Œä¸ä»…ä»…æ˜¯å»ç›¸å…³ã€‚å¸¸ç”¨æ–¹æ³•åŒ…æ‹¬ FastICAï¼Œå®ƒåŸºäºè¿­ä»£ä¼˜åŒ–éé«˜æ–¯æ€§æŒ‡æ ‡ï¼ˆå¦‚è´Ÿç†µï¼‰ä»è€Œå¿«é€Ÿæ‰¾åˆ°ç‹¬ç«‹æˆåˆ†ã€‚</p>
<p>åœ¨ä½¿ç”¨ ICA æ—¶ï¼Œé€šå¸¸éœ€è¦å¯¹æ•°æ®è¿›è¡Œä¸­å¿ƒåŒ–å’Œç™½åŒ–ï¼Œä½¿å¾—æ¯ä¸ªç‰¹å¾å‡å€¼ä¸ºé›¶ï¼Œä¸”å„ç‰¹å¾æ–¹å·®å½’ä¸€åŒ–å¹¶ç›¸äº’ä¸ç›¸å…³ã€‚ç™½åŒ–å¯ä»¥å‡å°‘å‚æ•°æ•°é‡ï¼Œæé«˜ç®—æ³•ç¨³å®šæ€§å’Œæ”¶æ•›é€Ÿåº¦ã€‚</p>
<p>ä»¥ FastICA ä¸ºä¾‹ï¼Œç®—æ³•å¯ä»¥æ€»ç»“ä¸ºä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li>æ•°æ®ä¸­å¿ƒåŒ–ï¼šå‡å»æ¯ä¸ªç‰¹å¾çš„å‡å€¼ï¼Œä½¿æ•°æ®å‡å€¼ä¸ºé›¶ã€‚</li>
<li>æ•°æ®ç™½åŒ–ï¼šå¯¹æ•°æ®è¿›è¡Œçº¿æ€§å˜æ¢ï¼Œä½¿å„ç‰¹å¾ä¸ç›¸å…³ä¸”æ–¹å·®å½’ä¸€åŒ–ã€‚</li>
<li>åˆå§‹åŒ–æƒé‡çŸ©é˜µï¼šéšæœºé€‰æ‹©åˆå§‹æƒé‡å‘é‡ã€‚</li>
<li>è¿­ä»£ä¼˜åŒ–ï¼šé€šè¿‡æœ€å¤§åŒ–éé«˜æ–¯æ€§æŒ‡æ ‡ï¼ˆå¦‚è´Ÿç†µï¼‰æ›´æ–°æƒé‡ï¼Œå¯»æ‰¾ç‹¬ç«‹æˆåˆ†æ–¹å‘ã€‚</li>
<li>æ­£äº¤åŒ–æƒé‡å‘é‡ï¼šä¿è¯å„ç‹¬ç«‹æˆåˆ†æ­£äº¤ï¼Œé¿å…é‡å¤ã€‚</li>
<li>æ¢å¤ç‹¬ç«‹æˆåˆ†ï¼šé€šè¿‡æƒé‡çŸ©é˜µå°†è§‚æµ‹æ•°æ®æŠ•å½±åˆ°ç‹¬ç«‹æˆåˆ†ç©ºé—´ï¼Œå¾—åˆ°çŸ©é˜µ Sã€‚</li>
<li>ç»“æœè¾“å‡ºï¼šå¾—åˆ°ç‹¬ç«‹æˆåˆ†å’Œæ··åˆçŸ©é˜µï¼Œå¯ç”¨äºåç»­åˆ†ææˆ–å¯è§†åŒ–ã€‚</li>
</ol>
<p>ä¸‹é¢ä½¿ç”¨ FastICA å¯¹æ··åˆä¿¡å·è¿›è¡Œåˆ†ç¦»ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">from</span> sklearn.decomposition <span class="hljs-keyword">import</span> FastICA

<span class="hljs-comment"># ç”Ÿæˆæ¨¡æ‹Ÿä¿¡å·</span>
np.random.seed(<span class="hljs-number">42</span>)
time = np.linspace(<span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1000</span>)
s1 = np.sin(<span class="hljs-number">2</span> * time)                  <span class="hljs-comment"># æ­£å¼¦ä¿¡å·</span>
s2 = np.sign(np.sin(<span class="hljs-number">3</span> * time))         <span class="hljs-comment"># æ–¹æ³¢ä¿¡å·</span>
S = np.c_[s1, s2]

<span class="hljs-comment"># æ··åˆä¿¡å·</span>
A = np.array([[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">0.5</span>, <span class="hljs-number">2</span>]])
X = S @ A.T

<span class="hljs-comment"># ä½¿ç”¨ FastICA åˆ†ç¦»ç‹¬ç«‹æˆåˆ†</span>
ica = FastICA(n_components=<span class="hljs-number">2</span>, random_state=<span class="hljs-number">42</span>)
S_ = ica.fit_transform(X)
A_ = ica.mixing_

<span class="hljs-comment"># å¯è§†åŒ–</span>
plt.figure(figsize=(<span class="hljs-number">10</span>,<span class="hljs-number">6</span>))

plt.subplot(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)
plt.plot(S)
plt.title(<span class="hljs-string">"Original Signals (S)"</span>)

plt.subplot(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)
plt.plot(X)
plt.title(<span class="hljs-string">"Mixed Signals (X)"</span>)

plt.subplot(<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>)
plt.plot(S_)
plt.title(<span class="hljs-string">"Recovered Independent Components (ICA)"</span>)

plt.tight_layout()
plt.show()
</code></pre>
<p>è¿è¡Œç»“æœä¸­ï¼Œç¬¬ä¸€å¹…å›¾å±•ç¤ºåŸå§‹ç‹¬ç«‹ä¿¡å·ï¼Œç¬¬äºŒå¹…å›¾ä¸ºæ··åˆä¿¡å·ï¼Œç¬¬ä¸‰å¹…å›¾ä¸º ICA åˆ†ç¦»å‡ºçš„ç‹¬ç«‹æˆåˆ†ã€‚å¯ä»¥çœ‹åˆ°ï¼ŒICA æˆåŠŸæ¢å¤äº†åŸå§‹ä¿¡å·çš„ç‹¬ç«‹æ€§ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cd192c09beb04257bc163a511c5f671f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWljb3Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769323357&amp;x-signature=oeK%2FmEWPAdeOGvD%2F6EOpVo%2Fml7g%3D" alt="" loading="lazy"/></p>
<p>ç‹¬ç«‹æˆåˆ†åˆ†ææ˜¯ä¸€ç§å¼ºå¤§çš„é™ç»´å’Œä¿¡å·åˆ†ç¦»æ–¹æ³•ï¼Œå®ƒé€šè¿‡ç»Ÿè®¡ç‹¬ç«‹æ€§å’Œéé«˜æ–¯æ€§ä¼˜åŒ–ï¼Œèƒ½å¤Ÿä»å¤æ‚çš„æ··åˆæ•°æ®ä¸­æå–æ½œåœ¨çš„ç‹¬ç«‹ä¿¡å·ã€‚ä¸ PCA ç›¸æ¯”ï¼ŒICA ä¸ä»…å»ç›¸å…³ï¼Œè¿˜èƒ½æ•æ‰é«˜é˜¶ç»Ÿè®¡ç‰¹æ€§ï¼Œå› æ­¤åœ¨ç›²æºåˆ†ç¦»ã€ç¥ç»ä¿¡å·åˆ†æå’Œå›¾åƒç‰¹å¾æå–ä¸­å…·æœ‰ä¸å¯æ›¿ä»£çš„ä½œç”¨ã€‚</p>
<p>å°½ç®¡ ICA å¯¹å™ªå£°æ•æ„Ÿã€è®¡ç®—å¤æ‚åº¦è¾ƒé«˜ï¼Œä½†é€šè¿‡åˆç†çš„é¢„å¤„ç†å’Œå‚æ•°é€‰æ‹©ï¼Œå®ƒä»ç„¶æ˜¯å¤„ç†é«˜ç»´å¤æ‚æ•°æ®çš„é‡è¦å·¥å…·ã€‚ç»“åˆ PCA å’Œå…¶ä»–é™ç»´æ–¹æ³•ï¼ŒICA å¯ä»¥ä¸ºæ•°æ®åˆ†ææä¾›æ›´åŠ ä¸°å¯Œå’Œæœ‰æ•ˆçš„ç‰¹å¾è¡¨ç¤ºï¼Œä½¿é«˜ç»´æ•°æ®æ›´æ˜“äºç†è§£å’Œå¤„ç†</p>
<p>ğŸ“š æ¨èé˜…è¯»</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485782%26idx%3D1%26sn%3D060c8222b47cbf903fbfded1f0421bcf%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485782&amp;idx=1&amp;sn=060c8222b47cbf903fbfded1f0421bcf&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">æœºå™¨å­¦ä¹ ä¹‹æ•°æ®é¢„å¤„ç†ç¯‡ï¼</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485800%26idx%3D1%26sn%3Da52107c9dc7071d8530a24563861fa46%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485800&amp;idx=1&amp;sn=a52107c9dc7071d8530a24563861fa46&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">æœºå™¨å­¦ä¹ ç‰¹å¾å·¥ç¨‹ä¸­çš„ç‰¹å¾é€‰æ‹©</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485808%26idx%3D1%26sn%3D2c57081d4b12433f6b8919209e2e52ed%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485808&amp;idx=1&amp;sn=2c57081d4b12433f6b8919209e2e52ed&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">æœºå™¨å­¦ä¹ ä¸­çš„ç‰¹å¾æ„é€ </a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485820%26idx%3D1%26sn%3Dadcb41fd14347f2f1431709323fa253f%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485820&amp;idx=1&amp;sn=adcb41fd14347f2f1431709323fa253f&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">æœºå™¨å­¦ä¹ ä¹‹ç‰¹å¾é™ç»´</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485848%26idx%3D1%26sn%3D06d3c614e05ebddd73f3fc058de5ab99%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485848&amp;idx=1&amp;sn=06d3c614e05ebddd73f3fc058de5ab99&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">åˆ°åº•ä»€ä¹ˆæ‰æ˜¯å›å½’æ¨¡å‹ï¼Ÿéƒ½æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485868%26idx%3D1%26sn%3D37fe4cbcff58fabbf6b0de2a704550a3%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485868&amp;idx=1&amp;sn=37fe4cbcff58fabbf6b0de2a704550a3&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">ä¸€æ–‡ææ‡‚ç›‘ç£å­¦ä¹ ä¸­çš„åˆ†ç±»æ¨¡å‹ï¼</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485876%26idx%3D1%26sn%3D7f65c641893cd109d9f4840cfc179491%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485876&amp;idx=1&amp;sn=7f65c641893cd109d9f4840cfc179491&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">ä¸€æ–‡ææ‡‚ç›‘ç£å­¦ä¹ ä¸­çš„æ ‘æ¨¡å‹ï¼</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485893%26idx%3D1%26sn%3Dadfe2bfc7118b21d37584da2bfb0d8f9%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485893&amp;idx=1&amp;sn=adfe2bfc7118b21d37584da2bfb0d8f9&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">ä¸€æ–‡è¯»æ‡‚ç›‘ç£å­¦ä¹ ä¸­çš„é›†æˆå­¦ä¹ ï¼</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485900%26idx%3D1%26sn%3D0e8024ce4102ed793681af0e34c9b5f5%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485900&amp;idx=1&amp;sn=0e8024ce4102ed793681af0e34c9b5f5&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">ä¸€æ–‡ææ‡‚K-Means èšç±»æ–¹æ³•</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485929%26idx%3D1%26sn%3D7510507b046068aebbc4a5fbc813aa19%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485929&amp;idx=1&amp;sn=7510507b046068aebbc4a5fbc813aa19&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">K-Medoidsèšç±»æ–¹æ³•å’ŒK-Meansæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485941%26idx%3D1%26sn%3Dcb53a98bacd1cfbd3255bbeeab6a24ec%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485941&amp;idx=1&amp;sn=cb53a98bacd1cfbd3255bbeeab6a24ec&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">ä¸€æ–‡ææ‡‚å±‚æ¬¡èšç±»å’Œå¯†åº¦èšç±»æ–¹æ³•ï¼</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwMTcyOTcyOQ%3D%3D%26mid%3D2247485946%26idx%3D1%26sn%3Da5cf50a4a3bda9785fb0c7baae3a6bb2%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwMTcyOTcyOQ==&amp;mid=2247485946&amp;idx=1&amp;sn=a5cf50a4a3bda9785fb0c7baae3a6bb2&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">ä¸€æ–‡ææ‡‚æœºå™¨å­¦ä¹ ä¸­çš„PCAä¸»æˆåˆ†åˆ†æï¼</a></p>
<p>æœ€æ–°çš„æ–‡ç« éƒ½åœ¨å…¬ä¼—å·aicotingæ›´æ–°ï¼Œåˆ«å¿˜è®°å…³æ³¨å“¦ï¼ï¼ï¼</p>
<p>ä½œè€…ï¼šaicoting</p>
<p>åˆ†äº«æ˜¯ä¸€ç§ä¿¡ä»°ï¼Œè¿æ¥è®©æˆé•¿æ›´æœ‰æ¸©åº¦ã€‚</p>
<p>æˆ‘ä»¬ä¸‹æ¬¡ä¸è§ä¸æ•£ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI æµå¼è¾“å‡ºæ¸²æŸ“ï¼šå‰ç«¯æŠ€æœ¯é€‰å‹å®Œå…¨æŒ‡å—]]></title>    <link>https://juejin.cn/post/7596148446383685638</link>    <guid>https://juejin.cn/post/7596148446383685638</guid>    <pubDate>2026-01-18T02:10:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596148446383685638" data-draft-id="7596171325531258921" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI æµå¼è¾“å‡ºæ¸²æŸ“ï¼šå‰ç«¯æŠ€æœ¯é€‰å‹å®Œå…¨æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-18T02:10:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯è¨å…‹æ–¯"/> <meta itemprop="url" content="https://juejin.cn/user/590879113368618"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI æµå¼è¾“å‡ºæ¸²æŸ“ï¼šå‰ç«¯æŠ€æœ¯é€‰å‹å®Œå…¨æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/590879113368618/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯è¨å…‹æ–¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T02:10:20.000Z" title="Sun Jan 18 2026 02:10:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä» ChatGPT åˆ°æ–‡å¿ƒä¸€è¨€ã€é€šä¹‰åƒé—®ã€deepseekï¼Œå¦‚ä½•åœ¨å‰ç«¯å®ç°ä¸æ»‘çš„æ‰“å­—åŠ¨ç”»æ•ˆæœï¼Ÿ</p>
</blockquote>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>å¦‚æœä½ æ­£åœ¨å¼€å‘ AI å¯¹è¯åº”ç”¨ï¼Œä¸€å®šé‡åˆ°è¿‡è¿™ä¸ªé—®é¢˜ï¼š<strong>å¦‚ä½•ä¼˜é›…åœ°æ¸²æŸ“ AI çš„æµå¼è¾“å‡ºï¼Ÿ</strong></p>
<p>ä¸åŒäºä¼ ç»Ÿçš„ä¸€æ¬¡æ€§æ¸²æŸ“ï¼ŒAI åº”ç”¨çš„ç‰¹ç‚¹æ˜¯å†…å®¹é€æ­¥ç”Ÿæˆï¼Œè€Œä¸”å¾€å¾€åŒ…å«å¤æ‚çš„ Markdown æ ¼å¼ã€ä»£ç å—ã€æ•°å­¦å…¬å¼ç­‰ã€‚è¿™ç»™å‰ç«¯æ¸²æŸ“å¸¦æ¥äº†ç‹¬ç‰¹çš„æŒ‘æˆ˜ã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥å¯¹æ¯”å¸‚é¢ä¸Šä¸»æµçš„ AI æµå¼æ¸²æŸ“æ–¹æ¡ˆï¼Œå¸®åŠ©ä½ æ‰¾åˆ°æœ€é€‚åˆé¡¹ç›®çš„æŠ€æœ¯é€‰å‹ã€‚</p>
<hr/>
<h2 data-id="heading-1">æ ¸å¿ƒéœ€æ±‚åˆ†æ</h2>
<p>åœ¨é€‰æ‹©æŠ€æœ¯æ–¹æ¡ˆä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ˜ç¡® AI æµå¼æ¸²æŸ“çš„æ ¸å¿ƒéœ€æ±‚ï¼š</p>
<h3 data-id="heading-2">1. æµå¼æ•°æ®å¤„ç†</h3>
<p>AI åç«¯é€šå¸¸é€šè¿‡ Server-Sent Events (SSE) æˆ– WebSocket è¿”å›æ•°æ®ï¼Œæ¯ä¸ªæ•°æ®å—ï¼ˆchunkï¼‰å¯èƒ½åŒ…å«å‡ ä¸ªå­—ç¬¦åˆ°å‡ åä¸ªå­—ç¬¦ä¸ç­‰ã€‚</p>
<h3 data-id="heading-3">2. æ‰“å­—åŠ¨ç”»æ•ˆæœ</h3>
<p>ä¸ºäº†æå‡ç”¨æˆ·ä½“éªŒï¼Œéœ€è¦å°†æµå¼æ•°æ®è½¬æ¢ä¸ºé€å­—æ˜¾ç¤ºçš„æ‰“å­—åŠ¨ç”»ï¼Œè€Œä¸æ˜¯è·³è·ƒå¼åœ°æ˜¾ç¤ºæ•´ä¸ª chunkã€‚</p>
<h3 data-id="heading-4">3. Markdown å®æ—¶æ¸²æŸ“</h3>
<p>AI çš„è¾“å‡ºé€šå¸¸åŒ…å« Markdown æ ¼å¼ï¼Œéœ€è¦åœ¨æ‰“å­—è¿‡ç¨‹ä¸­å®æ—¶è§£æå’Œæ¸²æŸ“ï¼Œè€Œä¸æ˜¯ç­‰å¾…å…¨éƒ¨å†…å®¹è¾“å‡ºå®Œæˆã€‚</p>
<h3 data-id="heading-5">4. å¤æ‚å†…å®¹æ”¯æŒ</h3>
<ul>
<li>ä»£ç å—ï¼ˆå¸¦è¯­æ³•é«˜äº®ï¼‰</li>
<li>æ•°å­¦å…¬å¼ï¼ˆLaTeXï¼‰</li>
<li>è¡¨æ ¼</li>
<li>æµç¨‹å›¾ï¼ˆMermaidï¼‰</li>
<li>åˆ—è¡¨ã€å¼•ç”¨ç­‰</li>
</ul>
<hr/>
<h2 data-id="heading-6">ä¸»æµæŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”</h2>
<h3 data-id="heading-7">æ–¹æ¡ˆä¸€ï¼šreact-markdownï¼ˆé™æ€æ¸²æŸ“ï¼‰</h3>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå†å²æ¶ˆæ¯å±•ç¤ºã€é™æ€å†…å®¹æ¸²æŸ“</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">ReactMarkdown</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'react-markdown'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Message</span>(<span class="hljs-params">{ content }</span>) {
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ReactMarkdown</span>&gt;</span>{content}<span class="hljs-tag">&lt;/<span class="hljs-name">ReactMarkdown</span>&gt;</span></span>;
}
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>ç”Ÿæ€æˆç†Ÿï¼Œæ’ä»¶ä¸°å¯Œ</li>
<li>æ–‡æ¡£å®Œå–„ï¼Œç¤¾åŒºæ´»è·ƒ</li>
<li>é«˜åº¦å¯å®šåˆ¶</li>
</ul>
<p><strong>åŠ£åŠ¿</strong>ï¼š</p>
<ul>
<li>âŒ ä¸æ”¯æŒæµå¼æ¸²æŸ“</li>
<li>âŒ æ²¡æœ‰æ‰“å­—åŠ¨ç”»</li>
<li>âŒ éœ€è¦æ‰‹åŠ¨å¤„ç†å¢é‡æ›´æ–°</li>
</ul>
<p><strong>è¯„åˆ†</strong>ï¼šâ­â­â­ (é€‚åˆé™æ€åœºæ™¯)</p>
<hr/>
<h3 data-id="heading-8">æ–¹æ¡ˆäºŒï¼šstreamdownï¼ˆæµå¼æ¸²æŸ“å¼•æ“ï¼‰</h3>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šéœ€è¦æµå¼æ¸²æŸ“ä½†ä¸éœ€è¦æ‰“å­—åŠ¨ç”»</p>
<p>Vercel å‡ºå“çš„ä¸“ä¸šæµå¼ Markdown æ¸²æŸ“å™¨ï¼Œä¸“æ³¨è§£å†³"æœªé—­åˆæ ‡ç­¾"é—®é¢˜ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Streamdown</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'streamdown'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Message</span>(<span class="hljs-params">{ content }</span>) {
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Streamdown</span>&gt;</span>{content}<span class="hljs-tag">&lt;/<span class="hljs-name">Streamdown</span>&gt;</span></span>;
}
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>âœ… åŸç”Ÿæ”¯æŒæµå¼æ¸²æŸ“</li>
<li>âœ… ä¼˜é›…å¤„ç†ä¸å®Œæ•´çš„ Markdown å—</li>
<li>âœ… å†…ç½®å®‰å…¨é˜²æŠ¤ï¼ˆXSS é˜²æŠ¤ï¼‰</li>
<li>âœ… å¯ä½œä¸º react-markdown çš„æ›¿ä»£å“</li>
</ul>
<p><strong>åŠ£åŠ¿</strong>ï¼š</p>
<ul>
<li>âŒ æ²¡æœ‰æ‰“å­—åŠ¨ç”»æ•ˆæœ</li>
<li>âŒ ä¾èµ– Tailwind CSS</li>
<li>âŒ æ— æ³•æ§åˆ¶æ¸²æŸ“é€Ÿåº¦</li>
</ul>
<p><strong>è¯„åˆ†</strong>ï¼šâ­â­â­â­ (æµå¼æ¸²æŸ“çš„ä¼˜ç§€é€‰æ‹©)</p>
<hr/>
<h3 data-id="heading-9">æ–¹æ¡ˆä¸‰ï¼šds-markdownï¼ˆæ‰“å­—åŠ¨ç”» + æµå¼æ¸²æŸ“ï¼‰</h3>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šéœ€è¦ ChatGPT é£æ ¼çš„å®Œæ•´ä½“éªŒ</p>
<p>ä¸“ä¸º AI åº”ç”¨è®¾è®¡çš„æ‰“å­—åŠ¨ç”»ç»„ä»¶ï¼ŒåŒæ—¶æ”¯æŒæµå¼æ¸²æŸ“å’Œ Markdownã€‚</p>
<h4 data-id="heading-10">åŸºç¡€ç”¨æ³•</h4>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">DsMarkdown</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'ds-markdown'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Message</span>(<span class="hljs-params">{ content }</span>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">DsMarkdown</span> <span class="hljs-attr">interval</span>=<span class="hljs-string">{30}</span>&gt;</span>
      {content}
    <span class="hljs-tag">&lt;/<span class="hljs-name">DsMarkdown</span>&gt;</span></span>
  );
}
</code></pre>
<h4 data-id="heading-11">æ ¸å¿ƒ API è¯¦è§£</h4>
<p><strong>1. é€Ÿåº¦æ§åˆ¶</strong></p>
<p>æ”¯æŒå›ºå®šé€Ÿåº¦å’ŒåŠ¨æ€é€Ÿåº¦ä¸¤ç§æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// å›ºå®šé€Ÿåº¦ï¼šæ¯ä¸ªå­—ç¬¦é—´éš” 30ms</span>
&lt;<span class="hljs-title class_">DsMarkdown</span> interval={<span class="hljs-number">30</span>}&gt;{content}&lt;/<span class="hljs-title class_">DsMarkdown</span>&gt;

<span class="hljs-comment">// åŠ¨æ€é€Ÿåº¦ï¼šæ›´è‡ªç„¶çš„æ‰“å­—èŠ‚å¥</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">DsMarkdown</span> <span class="hljs-attr">interval</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">min:</span> <span class="hljs-attr">8</span>, <span class="hljs-attr">max:</span> <span class="hljs-attr">60</span>, <span class="hljs-attr">curve:</span> '<span class="hljs-attr">ease-out</span>' }}&gt;</span>
  {content}
<span class="hljs-tag">&lt;/<span class="hljs-name">DsMarkdown</span>&gt;</span></span>
</code></pre>
<p><strong>2. ç”Ÿå‘½å‘¨æœŸé’©å­</strong></p>
<p>ç›‘å¬åŠ¨ç”»çš„å„ä¸ªé˜¶æ®µï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx">&lt;<span class="hljs-title class_">DsMarkdown</span>
  onStart={<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¼€å§‹æ‰“å­—'</span>)}
  onEnd={<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ‰“å­—å®Œæˆ'</span>);
    <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œè§¦å‘åç»­æ“ä½œï¼Œå¦‚æ˜¾ç¤ºåé¦ˆæŒ‰é’®</span>
  }}
  onTypedChar={<span class="hljs-function">(<span class="hljs-params">{ char, index }</span>) =&gt;</span> {
    <span class="hljs-comment">// å®æ—¶è·å–å½“å‰æ‰“å°çš„å­—ç¬¦</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ç¬¬ <span class="hljs-subst">${index}</span> ä¸ªå­—ç¬¦: <span class="hljs-subst">${char}</span>`</span>);
  }}
&gt;
  {content}
&lt;/<span class="hljs-title class_">DsMarkdown</span>&gt;
</code></pre>
<p><strong>3. ç¼–ç¨‹å¼æ§åˆ¶</strong></p>
<p>é€šè¿‡ ref å®ç°å®Œå…¨çš„ç¨‹åºåŒ–æ§åˆ¶ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { useRef } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">AIMessage</span>(<span class="hljs-params">{ content }</span>) {
  <span class="hljs-keyword">const</span> markdownRef = <span class="hljs-title function_">useRef</span>();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> markdownRef.current?.stop()}&gt;
          æš‚åœ
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> markdownRef.current?.resume()}&gt;
          ç»§ç»­
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> markdownRef.current?.restart()}&gt;
          é‡æ’­
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">DsMarkdown</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{markdownRef}</span> <span class="hljs-attr">interval</span>=<span class="hljs-string">{30}</span>&gt;</span>
        {content}
      <span class="hljs-tag">&lt;/<span class="hljs-name">DsMarkdown</span>&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
}
</code></pre>
<p><strong>4. ä¸»é¢˜åˆ‡æ¢</strong></p>
<p>å†…ç½®æ˜æš—åŒä¸»é¢˜ï¼Œæ— éœ€é¢å¤–é…ç½®ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ConfigProvider</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'ds-markdown'</span>;
<span class="hljs-keyword">import</span> zh <span class="hljs-keyword">from</span> <span class="hljs-string">'ds-markdown/i18n/zh'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [theme, setTheme] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">'light'</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ConfigProvider</span> <span class="hljs-attr">locale</span>=<span class="hljs-string">{zh}</span> <span class="hljs-attr">theme</span>=<span class="hljs-string">{theme}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">DsMarkdown</span>&gt;</span>{content}<span class="hljs-tag">&lt;/<span class="hljs-name">DsMarkdown</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ConfigProvider</span>&gt;</span></span>
  );
}
</code></pre>
<p><strong>5. æ€§èƒ½ä¼˜åŒ–ï¼šæŒ‰éœ€ç¦ç”¨åŠ¨ç”»</strong></p>
<p>å¯¹äºå†å²æ¶ˆæ¯ï¼Œå¯ä»¥è·³è¿‡åŠ¨ç”»ç›´æ¥æ¸²æŸ“ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// å†å²æ¶ˆæ¯æ— éœ€åŠ¨ç”»</span>
&lt;<span class="hljs-title class_">DsMarkdown</span> disableTyping={<span class="hljs-literal">true</span>}&gt;
  {historyMessage}
&lt;/<span class="hljs-title class_">DsMarkdown</span>&gt;

<span class="hljs-comment">// æ–°æ¶ˆæ¯å¸¦åŠ¨ç”»</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">DsMarkdown</span> <span class="hljs-attr">interval</span>=<span class="hljs-string">{30}</span>&gt;</span>
  {newMessage}
<span class="hljs-tag">&lt;/<span class="hljs-name">DsMarkdown</span>&gt;</span></span>
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>âœ… é€å­—ç¬¦æ‰“å­—åŠ¨ç”»</li>
<li>âœ… æµå¼æ¸²æŸ“æ”¯æŒ</li>
<li>âœ… å®Œæ•´çš„ Markdown ç”Ÿæ€ï¼ˆåŸºäº react-markdownï¼‰</li>
<li>âœ… é›¶é…ç½®ï¼Œå¼€ç®±å³ç”¨</li>
<li>âœ… ç²¾ç»†çš„åŠ¨ç”»æ§åˆ¶</li>
<li>âœ… å†…ç½®æ˜/æš—ä¸»é¢˜</li>
<li>âœ… å…¼å®¹ react-markdown æ’ä»¶ç”Ÿæ€</li>
</ul>
<p><strong>åŠ£åŠ¿</strong>ï¼š</p>
<ul>
<li>âš ï¸ ç›¸å¯¹è¾ƒæ–°çš„é¡¹ç›®</li>
<li>âš ï¸ æœªå¤„ç†ä¸å®Œæ•´çš„ Markdown å—ï¼Œè¿™ç‚¹ streamdown åšçš„æ›´å¥½</li>
</ul>
<p><strong>æŠ€æœ¯æ¶æ„</strong>ï¼šds-markdown åŸºäº react-markdown-typerï¼ˆåŒä½œè€…å¼€å‘ï¼‰ï¼Œå†…éƒ¨ä½¿ç”¨ react-markdown å®ç° Markdown æ¸²æŸ“ï¼Œå› æ­¤å®Œå…¨å…¼å®¹ react-markdown çš„æ’ä»¶ç”Ÿæ€ï¼ŒåŒæ—¶åœ¨æ­¤åŸºç¡€ä¸Šå¢åŠ äº†æ‰“å­—åŠ¨ç”»å’Œæµå¼æ¸²æŸ“èƒ½åŠ›ã€‚</p>
<p><strong>è¯„åˆ†</strong>ï¼šâ­â­â­â­â­ (AI åº”ç”¨çš„æœ€ä½³é€‰æ‹©)</p>
<hr/>
<h3 data-id="heading-12">æ–¹æ¡ˆå››ï¼šè‡ªå·±å®ç°æ‰“å­—æœºæ•ˆæœ</h3>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šç®€å•çš„çº¯æ–‡æœ¬æ‰“å­—åŠ¨ç”»</p>
<p>å¾ˆå¤šå¼€å‘è€…ä¼šå°è¯•è‡ªå·±å®ç°æ‰“å­—æœºæ•ˆæœï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">function</span> <span class="hljs-title function_">TypeWriter</span>(<span class="hljs-params">{ text }</span>) {
  <span class="hljs-keyword">const</span> [displayText, setDisplayText] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (index &lt; text.<span class="hljs-property">length</span>) {
        <span class="hljs-title function_">setDisplayText</span>(text.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, index + <span class="hljs-number">1</span>));
        index++;
      }
    }, <span class="hljs-number">50</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">clearInterval</span>(timer);
  }, [text]);

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{displayText}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>âœ… å®Œå…¨å¯æ§</li>
<li>âœ… æ— å¤–éƒ¨ä¾èµ–</li>
</ul>
<p><strong>åŠ£åŠ¿</strong>ï¼š</p>
<ul>
<li>âŒ ä¸æ”¯æŒ Markdown æ¸²æŸ“</li>
<li>âŒ æ€§èƒ½é—®é¢˜ï¼ˆé¢‘ç¹ setStateï¼‰</li>
<li>âŒ æ— æ³•å¤„ç†å¤æ‚æ ¼å¼</li>
<li>âŒ æµå¼æ•°æ®å¤„ç†å¤æ‚</li>
</ul>
<p><strong>è¯„åˆ†</strong>ï¼šâ­â­ (ä»…é€‚åˆç®€å•åœºæ™¯)</p>
<hr/>
<h2 data-id="heading-13">æ·±åº¦å¯¹æ¯”ï¼šå…³é”®ç‰¹æ€§</h2>











































































<table><thead><tr><th>ç‰¹æ€§</th><th>react-markdown</th><th>streamdown</th><th>ds-markdown</th><th>è‡ªå®ç°</th></tr></thead><tbody><tr><td><strong>æµå¼æ¸²æŸ“</strong></td><td>âŒ</td><td>âœ…</td><td>âœ…</td><td>âš ï¸ éœ€è‡ªå·±å®ç°</td></tr><tr><td><strong>æ‰“å­—åŠ¨ç”»</strong></td><td>âŒ</td><td>âŒ</td><td>âœ…</td><td>âœ…</td></tr><tr><td><strong>Markdown æ”¯æŒ</strong></td><td>âœ… å®Œæ•´</td><td>âœ… å®Œæ•´</td><td>âœ… å®Œæ•´</td><td>âŒ</td></tr><tr><td><strong>ä»£ç é«˜äº®</strong></td><td>âš ï¸ éœ€é…ç½®</td><td>âœ… Shiki</td><td>âœ… å†…ç½®</td><td>âŒ</td></tr><tr><td><strong>æ•°å­¦å…¬å¼</strong></td><td>âš ï¸ éœ€é…ç½®</td><td>âœ… KaTeX</td><td>âœ… KaTeX</td><td>âŒ</td></tr><tr><td><strong>åŠ¨ç”»æ§åˆ¶</strong></td><td>âŒ</td><td>âŒ</td><td>âœ… æš‚åœ/ç»§ç»­/é‡æ’­</td><td>âœ…</td></tr><tr><td><strong>æ€§èƒ½ä¼˜åŒ–</strong></td><td>âœ…</td><td>âœ…</td><td>âœ… RAF + diff</td><td>âŒ</td></tr><tr><td><strong>å­¦ä¹ æˆæœ¬</strong></td><td>ä½</td><td>ä½</td><td>ä½</td><td>é«˜</td></tr><tr><td><strong>ç»´æŠ¤æˆæœ¬</strong></td><td>ä½</td><td>ä½</td><td>ä½</td><td>é«˜</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-14">å®æˆ˜æ¡ˆä¾‹ï¼šä¸åŒåœºæ™¯çš„æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-15">åœºæ™¯ 1ï¼šèŠå¤©å†å²è®°å½•</h3>
<p><strong>éœ€æ±‚</strong>ï¼šå¿«é€Ÿæ¸²æŸ“å†å²æ¶ˆæ¯ï¼Œä¸éœ€è¦åŠ¨ç”»</p>
<p><strong>æ¨èæ–¹æ¡ˆ</strong>ï¼šreact-markdown æˆ– streamdown</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// å†å²æ¶ˆæ¯ç›´æ¥æ¸²æŸ“</span>
&lt;<span class="hljs-title class_">ReactMarkdown</span>&gt;{historyMessage}&lt;/<span class="hljs-title class_">ReactMarkdown</span>&gt;
</code></pre>
<h3 data-id="heading-16">åœºæ™¯ 2ï¼šAI å®æ—¶å›å¤</h3>
<p><strong>éœ€æ±‚</strong>ï¼šæµå¼è¾“å‡º + æ‰“å­—åŠ¨ç”» + Markdown</p>
<p><strong>æ¨èæ–¹æ¡ˆ</strong>ï¼šds-markdown</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// æ–°æ¶ˆæ¯å¸¦æ‰“å­—åŠ¨ç”»</span>
&lt;<span class="hljs-title class_">DsMarkdown</span> interval={<span class="hljs-number">30</span>}&gt;
  {streamingContent}
&lt;/<span class="hljs-title class_">DsMarkdown</span>&gt;
</code></pre>
<h3 data-id="heading-17">åœºæ™¯ 3ï¼šæ··åˆåœºæ™¯</h3>
<p><strong>éœ€æ±‚</strong>ï¼šå†å²æ¶ˆæ¯é™æ€æ¸²æŸ“ï¼Œæ–°æ¶ˆæ¯æ‰“å­—åŠ¨ç”»</p>
<p><strong>æ¨èæ–¹æ¡ˆ</strong>ï¼šds-markdownï¼ˆå¯æŒ‰éœ€ç¦ç”¨åŠ¨ç”»ï¼‰</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// å†å²æ¶ˆæ¯</span>
&lt;<span class="hljs-title class_">DsMarkdown</span> disableTyping={<span class="hljs-literal">true</span>}&gt;
  {historyMessage}
&lt;/<span class="hljs-title class_">DsMarkdown</span>&gt;

<span class="hljs-comment">// æ–°æ¶ˆæ¯</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">DsMarkdown</span> <span class="hljs-attr">interval</span>=<span class="hljs-string">{30}</span>&gt;</span>
  {newMessage}
<span class="hljs-tag">&lt;/<span class="hljs-name">DsMarkdown</span>&gt;</span></span>
</code></pre>
<hr/>
<h2 data-id="heading-18">æ€§èƒ½ä¼˜åŒ–å»ºè®®</h2>
<h3 data-id="heading-19">1. é¿å…é¢‘ç¹é‡æ¸²æŸ“</h3>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// âŒ ä¸å¥½çš„åšæ³•</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Chat</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [messages, setMessages] = <span class="hljs-title function_">useState</span>([]);

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    eventSource.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-title function_">setMessages</span>([...messages, e.<span class="hljs-property">data</span>]); <span class="hljs-comment">// æ¯æ¬¡éƒ½é‡æ–°æ¸²æŸ“æ‰€æœ‰æ¶ˆæ¯</span>
    };
  }, [messages]);
}

<span class="hljs-comment">// âœ… å¥½çš„åšæ³•</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Chat</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [messages, setMessages] = <span class="hljs-title function_">useState</span>([]);
  <span class="hljs-keyword">const</span> [currentMessage, setCurrentMessage] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    eventSource.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-title function_">setCurrentMessage</span>(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> prev + e.<span class="hljs-property">data</span>); <span class="hljs-comment">// åªæ›´æ–°å½“å‰æ¶ˆæ¯</span>
    };
  }, []);
}
</code></pre>
<h3 data-id="heading-20">2. ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨</h3>
<p>å¯¹äºé•¿å¯¹è¯å†å²ï¼Œä½¿ç”¨ react-window æˆ– react-virtualizedï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">FixedSizeList</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-window'</span>;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">FixedSizeList</span>
  <span class="hljs-attr">height</span>=<span class="hljs-string">{600}</span>
  <span class="hljs-attr">itemCount</span>=<span class="hljs-string">{messages.length}</span>
  <span class="hljs-attr">itemSize</span>=<span class="hljs-string">{100}</span>
&gt;</span>
  {({ index, style }) =&gt; (
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{style}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">DsMarkdown</span>&gt;</span>{messages[index]}<span class="hljs-tag">&lt;/<span class="hljs-name">DsMarkdown</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  )}
<span class="hljs-tag">&lt;/<span class="hljs-name">FixedSizeList</span>&gt;</span></span>
</code></pre>
<h3 data-id="heading-21">3. æŒ‰éœ€åŠ è½½æ’ä»¶</h3>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// åªåœ¨éœ€è¦æ—¶åŠ è½½ Mermaid</span>
<span class="hljs-keyword">import</span> { lazy } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title class_">MermaidPlugin</span> = <span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span>
  <span class="hljs-keyword">import</span>(<span class="hljs-string">'ds-markdown-mermaid-plugin'</span>)
);
</code></pre>
<hr/>
<h2 data-id="heading-22">é€‰å‹å†³ç­–æ ‘</h2>
<pre><code class="hljs language-markdown" lang="markdown">æ˜¯å¦éœ€è¦æ‰“å­—åŠ¨ç”»ï¼Ÿ
â”œâ”€ å¦ â†’ æ˜¯å¦éœ€è¦æµå¼æ¸²æŸ“ï¼Ÿ
â”‚   â”œâ”€ æ˜¯ â†’ streamdown
â”‚   â””â”€ å¦ â†’ react-markdown
â”‚
â””â”€ æ˜¯ â†’ æ˜¯å¦éœ€è¦ Markdown æ”¯æŒï¼Ÿ
<span class="hljs-code">    â”œâ”€ æ˜¯ â†’ ds-markdown
    â””â”€ å¦ â†’ è‡ªå·±å®ç°ç®€å•æ‰“å­—æœº
</span></code></pre>
<hr/>
<h2 data-id="heading-23">æ€»ç»“</h2>
<p>ä¸åŒçš„æŠ€æœ¯æ–¹æ¡ˆé€‚ç”¨äºä¸åŒçš„åœºæ™¯ï¼š</p>
<ul>
<li><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fremarkjs%2Freact-markdown" target="_blank" title="https://github.com/remarkjs/react-markdown" ref="nofollow noopener noreferrer">react-markdown</a></strong>ï¼šæˆç†Ÿç¨³å®šï¼Œé€‚åˆé™æ€å†…å®¹</li>
<li><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvercel%2Fstreamdown" target="_blank" title="https://github.com/vercel/streamdown" ref="nofollow noopener noreferrer">streamdown</a></strong>ï¼šæµå¼æ¸²æŸ“ä¸“å®¶ï¼Œé€‚åˆä¸éœ€è¦åŠ¨ç”»çš„åœºæ™¯</li>
<li><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fonshinpei%2Fds-markdown" target="_blank" title="https://github.com/onshinpei/ds-markdown" ref="nofollow noopener noreferrer">ds-markdown</a></strong>ï¼šAI åº”ç”¨çš„å®Œæ•´è§£å†³æ–¹æ¡ˆï¼Œæ‰“å­—åŠ¨ç”» + æµå¼æ¸²æŸ“</li>
<li><strong>è‡ªå®ç°</strong>ï¼šç®€å•åœºæ™¯å¯ä»¥å°è¯•ï¼Œå¤æ‚åœºæ™¯ä¸æ¨è</li>
</ul>
<p>å¦‚æœä½ æ­£åœ¨å¼€å‘ AI å¯¹è¯åº”ç”¨ï¼Œå¹¶ä¸”å¸Œæœ›æä¾› ChatGPT çº§åˆ«çš„ç”¨æˆ·ä½“éªŒï¼Œ<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fonshinpei%2Fds-markdown" target="_blank" title="https://github.com/onshinpei/ds-markdown" ref="nofollow noopener noreferrer">ds-markdown</a></strong> æ˜¯ç›®å‰å¸‚é¢ä¸Šæœ€å®Œæ•´çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-24">ç›¸å…³èµ„æº</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fonshinpei.github.io%2Fds-markdown%2F" target="_blank" title="https://onshinpei.github.io/ds-markdown/" ref="nofollow noopener noreferrer">ds-markdown æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fonshinpei.github.io%2Fds-markdown%2F%23try" target="_blank" title="https://onshinpei.github.io/ds-markdown/#try" ref="nofollow noopener noreferrer">åœ¨çº¿æ¼”ç¤º</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fonshinpei%2Fds-markdown" target="_blank" title="https://github.com/onshinpei/ds-markdown" ref="nofollow noopener noreferrer">GitHub ä»“åº“</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvercel%2Fstreamdown" target="_blank" title="https://github.com/vercel/streamdown" ref="nofollow noopener noreferrer">streamdown æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fremarkjs%2Freact-markdown" target="_blank" title="https://github.com/remarkjs/react-markdown" ref="nofollow noopener noreferrer">react-markdown æ–‡æ¡£</a></li>
</ul>
<hr/>
<p><strong>ä½ åœ¨é¡¹ç›®ä¸­ä½¿ç”¨çš„æ˜¯å“ªç§æ–¹æ¡ˆï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„ç»éªŒï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‘Šåˆ«MinIOï¼RustFSé‡æ„å­˜å‚¨èŒƒå¼ï¼š93MBé•œåƒæ’¬åŠ¨EBçº§æ•°æ®ï¼ŒGitHubç‹‚æ½19Kæ˜Ÿ]]></title>    <link>https://juejin.cn/post/7596134842482098217</link>    <guid>https://juejin.cn/post/7596134842482098217</guid>    <pubDate>2026-01-18T02:12:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596134842482098217" data-draft-id="7596171325531308073" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‘Šåˆ«MinIOï¼RustFSé‡æ„å­˜å‚¨èŒƒå¼ï¼š93MBé•œåƒæ’¬åŠ¨EBçº§æ•°æ®ï¼ŒGitHubç‹‚æ½19Kæ˜Ÿ"/> <!----> <meta itemprop="datePublished" content="2026-01-18T02:12:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¯¹è±¡å­˜å‚¨ä¸RustFS"/> <meta itemprop="url" content="https://juejin.cn/user/652466093570057"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‘Šåˆ«MinIOï¼RustFSé‡æ„å­˜å‚¨èŒƒå¼ï¼š93MBé•œåƒæ’¬åŠ¨EBçº§æ•°æ®ï¼ŒGitHubç‹‚æ½19Kæ˜Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/652466093570057/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¯¹è±¡å­˜å‚¨ä¸RustFS
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T02:12:37.000Z" title="Sun Jan 18 2026 02:12:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‘Šåˆ«MinIOï¼RustFSé‡æ„å­˜å‚¨èŒƒå¼ï¼š93MBé•œåƒæ’¬åŠ¨EBçº§æ•°æ®ï¼ŒGitHubç‹‚æ½19Kæ˜Ÿ</h2>
<blockquote>
<p>éšç€AIä¸å¤§æ•°æ®çš„çˆ†å‘å¼å¢é•¿ï¼Œéç»“æ„åŒ–æ•°æ®å­˜å‚¨æ­£é¢ä¸´å‰æ‰€æœªæœ‰çš„æŒ‘æˆ˜ã€‚RustFSä½œä¸ºåŸºäºRustè¯­è¨€å¼€å‘çš„é«˜æ€§èƒ½åˆ†å¸ƒå¼å¯¹è±¡å­˜å‚¨ç³»ç»Ÿï¼Œä»¥å…¶å“è¶Šæ€§èƒ½å’Œç®€æ´è®¾è®¡ï¼Œæ­£åœ¨æˆä¸ºMinIOç­‰ä¼ ç»Ÿæ–¹æ¡ˆçš„æœ‰åŠ›æ›¿ä»£è€…ã€‚</p>
</blockquote>
<h3 data-id="heading-1">ä¸€ã€RustFSï¼šä¸ºä½•æˆä¸ºå­˜å‚¨æ–°å® ï¼Ÿ</h3>
<p>åœ¨å½“ä»Šæ•°æ®é©±åŠ¨æ—¶ä»£ï¼Œéç»“æ„åŒ–æ•°æ®å‘ˆç°çˆ†ç‚¸å¼å¢é•¿ï¼Œä»ç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡è§†é¢‘åˆ°æœºå™¨å­¦ä¹ æ•°æ®é›†ï¼Œä¼ ç»Ÿå­˜å‚¨æ–¹æ¡ˆåœ¨æ€§èƒ½ã€æˆæœ¬å’Œæ‰©å±•æ€§æ–¹é¢é¢ä¸´ä¸¥å³»æŒ‘æˆ˜ã€‚RustFSåº”è¿è€Œç”Ÿï¼Œå®ƒæ˜¯ä¸€æ¬¾å®Œå…¨å…¼å®¹Amazon S3 APIçš„é«˜æ€§èƒ½åˆ†å¸ƒå¼å¯¹è±¡å­˜å‚¨ç³»ç»Ÿã€‚</p>
<p><strong>RustFSçš„æ ¸å¿ƒä¼˜åŠ¿</strong>æºäºRustè¯­è¨€çš„å†…å­˜å®‰å…¨ç‰¹æ€§ï¼Œä»è¯­æ³•å±‚é¢æœç»äº†ç©ºæŒ‡é’ˆå’Œç¼“å†²åŒºæº¢å‡ºç­‰å¸¸è§å†…å­˜æ¼æ´ï¼ŒåŒæ—¶å…·å¤‡æ¥è¿‘Cè¯­è¨€çš„è¿è¡Œæ•ˆç‡ï¼Œå®ç°äº†â€œå®‰å…¨ä¸å¦¥åæ€§èƒ½â€çš„çªç ´ã€‚åœ¨å®é™…æµ‹è¯•ä¸­ï¼ŒRustFSçš„4Kéšæœºè¯»è¾¾åˆ°â€‹<strong>1.58M IOPS</strong>â€‹ï¼Œæ¯”MinIOé«˜å‡º42%ï¼Œå»¶è¿ŸP99ä»…â€‹<strong>7.3ms</strong>ï¼Œå±•ç°å‡ºå“è¶Šçš„æ€§èƒ½è¡¨ç°ã€‚</p>
<p>ç›¸æ¯”ä¼ ç»Ÿå­˜å‚¨æ–¹æ¡ˆï¼ŒRustFSå…·æœ‰å¤šé¡¹çªå‡ºç‰¹ç‚¹ï¼š</p>
<ul>
<li>â€‹<strong>å®Œå…¨S3å…¼å®¹</strong>ï¼šæ— ç¼å¯¹æ¥ç°æœ‰S3ç”Ÿæ€å·¥å…·å’Œåº”ç”¨ï¼Œè¿ç§»æˆæœ¬ä¸ºé›¶</li>
<li>â€‹<strong>è½»é‡é«˜æ•ˆ</strong>ï¼šäºŒè¿›åˆ¶åŒ…ä»…93MBï¼Œè¿œå°äºåŒç±»æ–¹æ¡ˆï¼Œèµ„æºå ç”¨æä½</li>
<li>â€‹<strong>å¼€æºå‹å¥½</strong>ï¼šé‡‡ç”¨Apache 2.0è®¸å¯è¯ï¼Œæ— AGPLä¼ æŸ“é£é™©ï¼Œå¯è‡ªç”±å•†ç”¨</li>
<li>â€‹<strong>å¤šæ¶æ„æ”¯æŒ</strong>ï¼šå¯¹X86ã€ARMã€RISC-Vç­‰æ¶æ„åŸç”Ÿæ”¯æŒ</li>
</ul>
<h3 data-id="heading-2">äºŒã€æ¶æ„è§£æï¼šRustFSé«˜æ€§èƒ½çš„ç§˜è¯€</h3>
<h4 data-id="heading-3">2.1 åˆ†å¸ƒå¼æ¶æ„è®¾è®¡</h4>
<p>RustFSçš„å“è¶Šæ€§èƒ½èƒŒåæ˜¯å…¶åˆ›æ–°çš„â€‹<strong>å…ƒæ•°æ®ä¸æ•°æ®åˆ†ç¦»æ¶æ„</strong>â€‹ã€‚å…ƒæ•°æ®èŠ‚ç‚¹ç®¡ç†æ–‡ä»¶ç³»ç»Ÿçš„å‘½åç©ºé—´å’Œè®¿é—®æƒé™ï¼Œæ•°æ®èŠ‚ç‚¹è´Ÿè´£å®é™…çš„å¯¹è±¡å­˜å‚¨ã€‚è¿™ç§è§£è€¦è®¾è®¡ä½¿å¾—RustFSå¯ä»¥å®ç°<strong>O(1)å¤æ‚åº¦</strong>çš„å…ƒæ•°æ®æŸ¥è¯¢ï¼Œç™¾ä¸‡çº§å¯¹è±¡æ£€ç´¢å»¶è¿Ÿä»…7.3msï¼Œæ¯”MinIOå¿«60.8%ã€‚</p>
<p>RustFSé›†ç¾¤åŒ…å«ä¸‰ç§æ ¸å¿ƒè§’è‰²ï¼šâ€‹<strong>ä¸»èŠ‚ç‚¹</strong>â€‹ï¼ˆè´Ÿè´£é›†ç¾¤ç®¡ç†å’Œå…ƒæ•°æ®å­˜å‚¨ï¼‰ã€â€‹<strong>ä»èŠ‚ç‚¹</strong>â€‹ï¼ˆè´Ÿè´£å®é™…æ•°æ®å­˜å‚¨ï¼‰å’Œâ€‹<strong>å®¢æˆ·ç«¯</strong>ï¼ˆæä¾›ç”¨æˆ·æ¥å£ï¼‰ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå»ºè®®è‡³å°‘éƒ¨ç½²3ä¸ªèŠ‚ç‚¹ï¼ˆ1ä¸»2ä»ï¼‰ä»¥æ»¡è¶³åˆ†å¸ƒå¼ä¸€è‡´æ€§è¦æ±‚ã€‚èŠ‚ç‚¹é—´é€šè¿‡Raftåè®®ä¿æŒä¸€è‡´æ€§ï¼Œè¿™ç§åˆ†å¸ƒå¼å…±è¯†ç®—æ³•ç¡®ä¿å³ä½¿éƒ¨åˆ†èŠ‚ç‚¹æ•…éšœï¼Œç³»ç»Ÿä¹Ÿèƒ½ç»§ç»­æ­£å¸¸è¿è¡Œã€‚</p>
<h4 data-id="heading-4">2.2 é›¶æ‹·è´æŠ€æœ¯ï¼šæ€§èƒ½çªç ´çš„å…³é”®</h4>
<p>RustFSé€šè¿‡é©å‘½æ€§çš„é›¶æ‹·è´æŠ€æœ¯å®ç°äº†æ€§èƒ½çš„è´¨çš„é£è·ƒã€‚åœ¨ä¼ ç»Ÿæ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæ•°æ®ä»å­˜å‚¨è®¾å¤‡åˆ°åº”ç”¨ç¨‹åºéœ€è¦ç»å†å¤šæ¬¡æ‹·è´ï¼šç¡¬ç›˜â†’å†…æ ¸ç¼“å†²åŒºâ†’ç”¨æˆ·ç©ºé—´ç¼“å†²åŒºâ†’ç½‘ç»œå †æ ˆã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ¯æ¬¡æ‹·è´éƒ½æ„å‘³ç€CPUå‘¨æœŸå’Œå†…å­˜å¸¦å®½çš„æ¶ˆè€—ã€‚</p>
<p><strong>RustFSçš„é›¶æ‹·è´æ¶æ„</strong>é€šè¿‡ä¸‰é¡¹æ ¸å¿ƒæŠ€æœ¯å®ç°ï¼š</p>
<ul>
<li>â€‹<strong>io_uringå¼‚æ­¥I/O</strong>â€‹ï¼šä½¿ç”¨Linuxå†…æ ¸çš„io_uringæ¥å£æ›¿ä»£ä¼ ç»ŸåŒæ­¥I/Oï¼Œå®ç°çœŸæ­£çš„å¼‚æ­¥é›¶æ‹·è´</li>
<li>â€‹<strong>å†…å­˜æ˜ å°„</strong>ï¼šå°†æ–‡ä»¶ç›´æ¥æ˜ å°„åˆ°è¿›ç¨‹åœ°å€ç©ºé—´ï¼Œé¿å…ç”¨æˆ·ç©ºé—´ä¸å†…æ ¸ç©ºé—´çš„æ•°æ®æ‹·è´</li>
<li>â€‹<strong>RDMAç›´æ¥æ•°æ®æ”¾ç½®</strong>ï¼šåœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œåˆ©ç”¨RDMAæŠ€æœ¯å®ç°ç½‘ç»œé›¶æ‹·è´</li>
</ul>
<p>å®æµ‹è¡¨æ˜ï¼Œåœ¨10Gç½‘ç»œç¯å¢ƒä¸‹ï¼Œä¼ ç»Ÿæ–‡ä»¶ç³»ç»Ÿæœ‰å¤šè¾¾<strong>70%çš„CPUæ—¶é—´</strong>æ¶ˆè€—åœ¨æ•°æ®æ‹·è´ä¸Šã€‚è€ŒRustFSçš„é›¶æ‹·è´è®¾è®¡å°†NVMe SSDçš„IOPSä»ä¼ ç»Ÿçš„300Kæå‡è‡³â€‹<strong>1,580K</strong>ï¼Œæ€§èƒ½æå‡è¾¾426%ã€‚</p>
<h4 data-id="heading-5">2.3 æ™ºèƒ½åˆ†å±‚å­˜å‚¨æ¶æ„</h4>
<p>é¢å¯¹æ€§èƒ½ä¸æˆæœ¬çš„åŒé‡æŒ‘æˆ˜ï¼ŒRustFSåˆ›æ–°åœ°é‡‡ç”¨äº†â€‹<strong>æ™ºèƒ½åˆ†å±‚å­˜å‚¨æ¶æ„</strong>ï¼Œå……åˆ†å‘æŒ¥SCMï¼ˆå­˜å‚¨çº§å†…å­˜ï¼‰ã€TLC/MLC SSDå’ŒQLC SSDå„è‡ªä¼˜åŠ¿ã€‚</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># RustFSåˆ†å±‚å­˜å‚¨é…ç½®ç¤ºä¾‹</span>
<span class="hljs-attr">storage_tiering:</span>
  <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>
  <span class="hljs-attr">tiers:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">"scm_tier"</span>
      <span class="hljs-attr">medium:</span> <span class="hljs-string">"scm"</span>
      <span class="hljs-attr">path:</span> <span class="hljs-string">"/opt/rustfs/scm"</span>
      <span class="hljs-attr">capacity:</span> <span class="hljs-string">"512GB"</span>
      <span class="hljs-attr">role:</span> <span class="hljs-string">"metadata_cache"</span>
      
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">"tlc_tier"</span> 
      <span class="hljs-attr">medium:</span> <span class="hljs-string">"ssd"</span>
      <span class="hljs-attr">path:</span> <span class="hljs-string">"/opt/rustfs/ssd"</span>
      <span class="hljs-attr">capacity:</span> <span class="hljs-string">"4TB"</span>
      <span class="hljs-attr">role:</span> <span class="hljs-string">"hot_data"</span>
      
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">"qlc_tier"</span>
      <span class="hljs-attr">medium:</span> <span class="hljs-string">"qlc_ssd"</span>
      <span class="hljs-attr">path:</span> <span class="hljs-string">"/opt/rustfs/qlc"</span>
      <span class="hljs-attr">capacity:</span> <span class="hljs-string">"64TB"</span>
      <span class="hljs-attr">role:</span> <span class="hljs-string">"cold_data"</span>
</code></pre>
<p>RustFSçš„<strong>æ™ºèƒ½æ•°æ®æ”¾ç½®å¼•æ“</strong>é€šè¿‡æœºå™¨å­¦ä¹ ç®—æ³•é¢„æµ‹æ•°æ®è®¿é—®æ¨¡å¼ï¼ŒåŸºäºè®¿é—®é¢‘ç‡ã€å»¶è¿Ÿæ•æ„Ÿåº¦ã€æ•°æ®å¤§å°ç­‰å¤šå› ç´ è¯„åˆ†å†³ç­–ï¼Œè‡ªåŠ¨å°†æ•°æ®æ”¾ç½®åœ¨åˆé€‚çš„å­˜å‚¨å±‚ã€‚è¿™ç§æ™ºèƒ½åˆ†å±‚è®¾è®¡åœ¨ä¿è¯æ€§èƒ½çš„åŒæ—¶ï¼Œæ˜¾è‘—é™ä½äº†å­˜å‚¨æˆæœ¬ã€‚</p>
<h3 data-id="heading-6">ä¸‰ã€å®æˆ˜æŒ‡å—ï¼šä»éƒ¨ç½²åˆ°ä¼˜åŒ–</h3>
<h4 data-id="heading-7">3.1 å¿«é€Ÿéƒ¨ç½²ï¼šDockerä¸€æ­¥åˆ°ä½</h4>
<p>æœ€ç®€å•å¿«æ·çš„éƒ¨ç½²æ–¹å¼æ˜¯ä½¿ç”¨Dockerä¸€é”®éƒ¨ç½²ï¼š</p>
<pre><code class="hljs language-yml" lang="yml"><span class="hljs-comment"># docker-compose.yml</span>
<span class="hljs-attr">version:</span> <span class="hljs-string">'3.8'</span>
<span class="hljs-attr">services:</span>
  <span class="hljs-attr">rustfs:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">rustfs/rustfs:latest</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">rustfs</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"9000:9000"</span>  <span class="hljs-comment"># APIç«¯å£</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"9001:9001"</span>  <span class="hljs-comment"># æ§åˆ¶å°ç«¯å£</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./data:/data</span>  <span class="hljs-comment"># æ•°æ®æŒä¹…åŒ–</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">RUSTFS_ROOT_USER=admin</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">RUSTFS_ROOT_PASSWORD=admin123</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>
</code></pre>
<p>è¿è¡Œ <code>docker-compose up -d</code>â€‹å³å¯å¯åŠ¨æœåŠ¡ã€‚è®¿é—® <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A9001%2F" target="_blank" title="http://localhost:9001/" ref="nofollow noopener noreferrer">http://localhost:9001</a>ä½¿ç”¨ admin/admin123 ç™»å½•ç®¡ç†æ§åˆ¶å°ã€‚</p>
<h4 data-id="heading-8">3.2 ç”Ÿäº§ç¯å¢ƒé›†ç¾¤éƒ¨ç½²</h4>
<p>å¯¹äºä¼ä¸šçº§ç”Ÿäº§ç¯å¢ƒï¼Œé›†ç¾¤éƒ¨ç½²æ˜¯å¿…é¡»çš„ï¼Œå®ƒæä¾›é«˜å¯ç”¨æ€§å’Œå®¹é”™èƒ½åŠ›ã€‚RustFSå»ºè®®è‡³å°‘éƒ¨ç½²â€‹<strong>3ä¸ªèŠ‚ç‚¹</strong>ï¼ˆ1ä¸»2ä»ï¼‰ã€‚</p>
<p>â€‹<strong>èŠ‚ç‚¹è§„åˆ’ç¤ºä¾‹</strong>ï¼š</p>
<ul>
<li>ä¸»èŠ‚ç‚¹ï¼š192.168.1.10ï¼Œæ•°æ®ç›®å½• /data/rustfs/data</li>
<li>ä»èŠ‚ç‚¹1ï¼š192.168.1.11ï¼Œæ•°æ®ç›®å½• /data/rustfs/data</li>
<li>ä»èŠ‚ç‚¹2ï¼š192.168.1.12ï¼Œæ•°æ®ç›®å½• /data/rustfs/data</li>
</ul>
<p>â€‹<strong>é›†ç¾¤é…ç½®å…³é”®å‚æ•°</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># èŠ‚ç‚¹è§’è‰²ï¼Œä¸»èŠ‚ç‚¹è®¾ä¸º master</span>
node.role = master
<span class="hljs-comment"># ä¸»èŠ‚ç‚¹IPï¼ˆæœ¬æœºIPï¼‰</span>
node.ip = 192.168.1.10
<span class="hljs-comment"># æœåŠ¡ç«¯å£</span>
service.port = 9000
<span class="hljs-comment"># é›†ç¾¤é€šä¿¡ç«¯å£</span>
cluster.port = 9001
<span class="hljs-comment"># æ•°æ®å‰¯æœ¬æ•°ï¼Œå»ºè®®è®¾ä¸ºèŠ‚ç‚¹æ•°</span>
data.replica = 3
<span class="hljs-comment"># ä»èŠ‚ç‚¹åˆ—è¡¨ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰</span>
cluster.slaves = rustfs-slave1:9001,rustfs-slave2:9001
</code></pre>
<h4 data-id="heading-9">3.3 å­˜å‚¨éç»“æ„åŒ–æ•°æ®å®æˆ˜</h4>
<p>RustFSå®Œå…¨å…¼å®¹S3 APIï¼Œå¯ä»¥è½»æ¾å­˜å‚¨å„ç§éç»“æ„åŒ–æ•°æ®ï¼šå›¾ç‰‡ã€è§†é¢‘ã€æ—¥å¿—æ–‡ä»¶ç­‰ã€‚</p>
<p>â€‹<strong>åˆ›å»ºå­˜å‚¨æ¡¶</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºå›¾ç‰‡å­˜å‚¨æ¡¶</span>
aws s3 mb s3://images --endpoint-url http://localhost:9000
<span class="hljs-comment"># åˆ›å»ºè§†é¢‘å­˜å‚¨æ¡¶  </span>
aws s3 mb s3://videos --endpoint-url http://localhost:9000
<span class="hljs-comment"># åˆ›å»ºæ—¥å¿—å­˜å‚¨æ¡¶</span>
aws s3 mb s3://logs --endpoint-url http://localhost:9000
</code></pre>
<p>â€‹<strong>ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸Šä¼ å•å¼ å›¾ç‰‡</span>
aws s3 <span class="hljs-built_in">cp</span> ./avatar.jpg s3://images/users/123/avatar.jpg --endpoint-url http://localhost:9000
<span class="hljs-comment"># ä¸Šä¼ æ•´ä¸ªå›¾ç‰‡ç›®å½•</span>
aws s3 <span class="hljs-built_in">cp</span> ./product-images/ s3://images/products/ --recursive --endpoint-url http://localhost:9000
</code></pre>
<p>â€‹<strong>å­˜å‚¨å¤§è§†é¢‘æ–‡ä»¶</strong>ï¼ˆæ”¯æŒåˆ†ç‰‡ä¸Šä¼ ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">aws s3 <span class="hljs-built_in">cp</span> ./promo-video.mp4 s3://videos/promotional/promo.mp4 \
  --endpoint-url http://localhost:9000 \
  --no-sign-request \
  --metadata name=promo_video
</code></pre>
<h3 data-id="heading-10">å››ã€é«˜çº§åŠŸèƒ½ä¸æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-11">4.1 æ•°æ®å®‰å…¨ä¸ç”Ÿå‘½å‘¨æœŸç®¡ç†</h4>
<p>RustFSæä¾›å®Œæ•´çš„æ•°æ®å®‰å…¨è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬åŠ å¯†å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚</p>
<p>â€‹<strong>æœåŠ¡å™¨ç«¯åŠ å¯†</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">aws s3 <span class="hljs-built_in">cp</span> sensitive-data.txt s3://documents/secure/data.txt \
  --sse AES256 \
  --endpoint-url http://localhost:9000
</code></pre>
<p><strong>ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong>è‡ªåŠ¨å°†æ—§æ•°æ®è¿ç§»åˆ°ä½æˆæœ¬å­˜å‚¨ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"Rules"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"ID"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Move old videos to cold storage"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"Status"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Enabled"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"Filter"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"Prefix"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"archive/"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"Transitions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"Days"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">30</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"StorageClass"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"COLD"</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-12">4.2 ä¸å¤§æ•°æ®å’ŒAIç”Ÿæ€é›†æˆ</h4>
<p>RustFSä¸ä¸»æµå¤§æ•°æ®å’ŒAIæ¡†æ¶æ— ç¼é›†æˆï¼Œæ˜¯æ„å»ºæ•°æ®æ¹–çš„ç†æƒ³é€‰æ‹©ã€‚</p>
<p>â€‹<strong>Sparké›†æˆç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-keyword">val</span> spark = <span class="hljs-type">SparkSession</span>.builder()
  .appName(<span class="hljs-string">"RustFS-Spark-Integration"</span>)
  .config(<span class="hljs-string">"spark.hadoop.fs.s3a.access.key"</span>, <span class="hljs-string">"rustfsadmin"</span>)
  .config(<span class="hljs-string">"spark.hadoop.fs.s3a.secret.key"</span>, <span class="hljs-string">"rustfsadmin"</span>) 
  .config(<span class="hljs-string">"spark.hadoop.fs.s3a.endpoint"</span>, <span class="hljs-string">"http://localhost:9000"</span>)
  .config(<span class="hljs-string">"spark.hadoop.fs.s3a.path.style.access"</span>, <span class="hljs-string">"true"</span>)
  .getOrCreate()

<span class="hljs-comment">// è¯»å–Parquetæ•°æ®é›†</span>
<span class="hljs-keyword">val</span> df = spark.read.parquet(<span class="hljs-string">"s3a://ai-datalake/imagenet/parquet/"</span>)
</code></pre>
<p>â€‹<strong>PyTorché›†æˆç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-Python" lang="Python"><span class="hljs-keyword">from</span> torch.utils.data <span class="hljs-keyword">import</span> Dataset
<span class="hljs-keyword">import</span> boto3

s3 = boto3.client(<span class="hljs-string">'s3'</span>,
                  endpoint_url=<span class="hljs-string">'http://localhost:9000'</span>,
                  aws_access_key_id=<span class="hljs-string">'rustfsadmin'</span>,
                  aws_secret_access_key=<span class="hljs-string">'rustfsadmin'</span>,
                  config=boto3.session.Config(signature_version=<span class="hljs-string">'s3v4'</span>))

<span class="hljs-keyword">class</span> <span class="hljs-title class_">S3ImageDataset</span>(<span class="hljs-title class_ inherited__">Dataset</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, bucket, prefix</span>):
        self.objects = s3.list_objects_v2(Bucket=bucket, Prefix=prefix)[<span class="hljs-string">'Contents'</span>]
        
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__getitem__</span>(<span class="hljs-params">self, idx</span>):
        obj = self.objects[idx]
        response = s3.get_object(Bucket=<span class="hljs-string">'ai-datalake'</span>, Key=obj[<span class="hljs-string">'Key'</span>])
        <span class="hljs-keyword">return</span> preprocess(Image.<span class="hljs-built_in">open</span>(response[<span class="hljs-string">'Body'</span>]))
</code></pre>
<h4 data-id="heading-13">4.3 æ€§èƒ½ä¼˜åŒ–å®æˆ˜</h4>
<p>RustFSæä¾›äº†ä¸°å¯Œçš„æ€§èƒ½è°ƒä¼˜å‚æ•°ï¼Œå¯æ ¹æ®å·¥ä½œè´Ÿè½½ç‰¹ç‚¹è¿›è¡Œä¼˜åŒ–ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># RustFSæ€§èƒ½ä¼˜åŒ–å‚æ•°</span>
export <span class="hljs-attr">RUSTFS_SCM_CACHE_SIZE</span>=<span class="hljs-string">"32G"</span>
export <span class="hljs-attr">RUSTFS_QLC_BUFFER_SIZE</span>=<span class="hljs-string">"4G"</span> 
export <span class="hljs-attr">RUSTFS_TIER_MIGRATION_THREADS</span>=<span class="hljs-number">16</span>
export <span class="hljs-attr">RUSTFS_IO_SCHEDULER</span>=<span class="hljs-string">"mq-deadline"</span>

<span class="hljs-comment"># QLCä¸“ç”¨ä¼˜åŒ–</span>
export <span class="hljs-attr">RUSTFS_QLC_SEQUENTIAL_THRESHOLD</span>=<span class="hljs-string">"1M"</span>
export <span class="hljs-attr">RUSTFS_QLC_GARBAGE_COLLECTION_INTERVAL</span>=<span class="hljs-string">"300"</span>
</code></pre>
<p>åœ¨æ ‡å‡†æµ‹è¯•ç¯å¢ƒä¸­ï¼ŒRustFS+SCM+QLCæ¶æ„å±•ç°å‡ºæ˜¾è‘—ä¼˜åŠ¿ï¼šå…ƒæ•°æ®æ“ä½œå»¶è¿Ÿé™ä½81%ï¼Œé¡ºåºè¯»ååé‡æå‡50%ï¼Œæ··åˆå·¥ä½œè´Ÿè½½æå‡25%ã€‚</p>
<h3 data-id="heading-14">äº”ã€åº”ç”¨åœºæ™¯ä¸æˆåŠŸå®è·µ</h3>
<p>RustFSé€‚ç”¨äºå¤šç§åœºæ™¯ï¼Œç‰¹åˆ«æ˜¯éœ€è¦é«˜æ€§èƒ½ã€ä½æˆæœ¬å­˜å‚¨çš„éç»“æ„åŒ–æ•°æ®åº”ç”¨ï¼š</p>
<ol>
<li>â€‹<strong>AI/MLè®­ç»ƒå¹³å°</strong>ï¼šRustFSçš„å¹¶è¡Œå¯¹è±¡è¯»å–ç‰¹æ€§ä½¿è®­ç»ƒæ—¶é—´ç¼©çŸ­28%ï¼ŒåŒæ—¶å­˜å‚¨æˆæœ¬é™ä½40%ï¼ˆç›¸æ¯”3å‰¯æœ¬æ–¹æ¡ˆï¼‰ã€‚</li>
<li>â€‹<strong>å¤šåª’ä½“å­˜å‚¨æœåŠ¡</strong>ï¼šå®Œå…¨å…¼å®¹S3 APIï¼Œé€‚åˆå­˜å‚¨å›¾ç‰‡ã€è§†é¢‘ç­‰å¤šåª’ä½“æ–‡ä»¶ï¼Œæ”¯æŒæ–­ç‚¹ç»­ä¼ å’Œåˆ†ç‰‡ä¸Šä¼ ã€‚</li>
<li>â€‹<strong>æ•°æ®æ¹–æ¶æ„</strong>ï¼šä½œä¸ºæ•°æ®æ¹–åº•å±‚å­˜å‚¨ï¼Œæ”¯æŒSparkã€Flinkç­‰å¤§æ•°æ®æ¡†æ¶ï¼Œæä¾›é«˜ååé‡æ•°æ®è®¿é—®ã€‚</li>
<li>â€‹<strong>è¾¹ç¼˜å­˜å‚¨åœºæ™¯</strong>ï¼šè½»é‡çº§è®¾è®¡ï¼ˆäºŒè¿›åˆ¶åŒ…ä»…93MBï¼‰ä½¿å¾—RustFSå¯ä»¥åœ¨è¾¹ç¼˜è®¾å¤‡å¦‚æ ‘è“æ´¾ä¸Šè¿è¡Œã€‚</li>
<li>â€‹<strong>ä¿¡åˆ›ç¯å¢ƒ</strong>ï¼šä½œä¸º100%ä¸­å›½è‡ªä¸»çŸ¥è¯†äº§æƒçš„é¡¹ç›®ï¼Œå·²é€šè¿‡éº’éºŸã€ç»Ÿä¿¡ç­‰å›½äº§æ“ä½œç³»ç»Ÿè®¤è¯ï¼Œæ”¯æŒé²²é¹ã€æµ·å…‰ç­‰å›½äº§èŠ¯ç‰‡ï¼Œå®Œå…¨ç¬¦åˆä¿¡åˆ›è¦æ±‚ã€‚</li>
</ol>
<h3 data-id="heading-15">æ€»ç»“</h3>
<p>RustFSä½œä¸ºæ–°ä¸€ä»£é«˜æ€§èƒ½åˆ†å¸ƒå¼å¯¹è±¡å­˜å‚¨ç³»ç»Ÿï¼Œé€šè¿‡åˆ›æ–°çš„é›¶æ‹·è´æ¶æ„ã€æ™ºèƒ½åˆ†å±‚å­˜å‚¨å’Œå®Œå…¨S3å…¼å®¹æ€§ï¼Œä¸ºç°ä»£æ•°æ®å­˜å‚¨æŒ‘æˆ˜æä¾›äº†å“è¶Šè§£å†³æ–¹æ¡ˆã€‚å…¶å“è¶Šçš„æ€§èƒ½è¡¨ç°ã€ä½èµ„æºå ç”¨å’Œå¼€æºå‹å¥½çš„è®¸å¯è¯æ¨¡å¼ï¼Œä½¿å…¶æˆä¸ºMinIOç­‰ä¼ ç»Ÿæ–¹æ¡ˆçš„æœ‰åŠ›æ›¿ä»£è€…ã€‚</p>
<p>æ— è®ºæ˜¯AIè®­ç»ƒã€å¤§æ•°æ®åˆ†æè¿˜æ˜¯ç®€å•çš„æ–‡ä»¶å­˜å‚¨éœ€æ±‚ï¼ŒRustFSéƒ½èƒ½æä¾›é«˜æ•ˆã€å¯é çš„æ•°æ®ç®¡ç†ä½“éªŒã€‚é€šè¿‡æœ¬æ–‡çš„ä»‹ç»ï¼Œå¸Œæœ›æ‚¨èƒ½å…¨é¢äº†è§£RustFSçš„ç‰¹æ€§å’Œä¼˜åŠ¿ï¼Œå¹¶åœ¨å®é™…é¡¹ç›®ä¸­ä½“éªŒå…¶å¸¦æ¥çš„æ•°æ®ç®¡ç†æå‡ã€‚</p>
<hr/>
<p>ä»¥ä¸‹æ˜¯æ·±å…¥å­¦ä¹  RustFS çš„æ¨èèµ„æºï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Frustfs%2Frustfs" target="_blank" title="https://github.com/rustfs/rustfs" ref="nofollow noopener noreferrer">RustFS</a></p>
<p>å®˜æ–¹æ–‡æ¡£ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttps%253A%2F%2Fdocs.rustfs.com%2F" target="_blank" title="https://link.zhihu.com/?target=https%3A//docs.rustfs.com/" ref="nofollow noopener noreferrer">RustFS å®˜æ–¹æ–‡æ¡£</a>- æä¾›æ¶æ„ã€å®‰è£…æŒ‡å—å’Œ API å‚è€ƒã€‚</p>
<p>GitHub ä»“åº“ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttps%253A%2F%2Fdocs.rustfs.com%2F" target="_blank" title="https://link.zhihu.com/?target=https%3A//docs.rustfs.com/" ref="nofollow noopener noreferrer">GitHub ä»“åº“</a> - è·å–æºä»£ç ã€æäº¤é—®é¢˜æˆ–è´¡çŒ®ä»£ç ã€‚</p>
<p>ç¤¾åŒºæ”¯æŒï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttps%253A%2F%2Fgithub.com%2Forgs%2Frustfs%2Fdiscussions" target="_blank" title="https://link.zhihu.com/?target=https%3A//github.com/orgs/rustfs/discussions" ref="nofollow noopener noreferrer">GitHub Discussions</a>- ä¸å¼€å‘è€…äº¤æµç»éªŒå’Œè§£å†³æ–¹æ¡ˆã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <!----></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Node.js ç¼–ç¨‹å®æˆ˜ï¼šå³æ—¶èŠå¤©åº”ç”¨ â€”â€” æ¶ˆæ¯å­˜å‚¨ä¸æ¨é€]]></title>    <link>https://juejin.cn/post/7595974133097725986</link>    <guid>https://juejin.cn/post/7595974133097725986</guid>    <pubDate>2026-01-18T05:21:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595974133097725986" data-draft-id="7596153767872233506" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Node.js ç¼–ç¨‹å®æˆ˜ï¼šå³æ—¶èŠå¤©åº”ç”¨ â€”â€” æ¶ˆæ¯å­˜å‚¨ä¸æ¨é€"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,Node.js"/> <meta itemprop="datePublished" content="2026-01-18T05:21:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜çˆ±é’“é±¼"/> <meta itemprop="url" content="https://juejin.cn/user/2799775299157614"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Node.js ç¼–ç¨‹å®æˆ˜ï¼šå³æ—¶èŠå¤©åº”ç”¨ â€”â€” æ¶ˆæ¯å­˜å‚¨ä¸æ¨é€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2799775299157614/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜çˆ±é’“é±¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T05:21:57.000Z" title="Sun Jan 18 2026 05:21:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åœ¨å‰é¢çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å·²ç»åŸºäº WebSocket å®ç°äº†å³æ—¶èŠå¤©åº”ç”¨çš„å®æ—¶é€šä¿¡èƒ½åŠ›ï¼Œå¹¶å®Œæˆäº†ç¾¤èŠå’Œç§èŠåŠŸèƒ½ã€‚ä½†åœ¨çœŸå®çš„èŠå¤©ç³»ç»Ÿä¸­ï¼Œä»…æœ‰å®æ—¶è½¬å‘æ˜¯ä¸å¤Ÿçš„ï¼Œ<strong>æ¶ˆæ¯å­˜å‚¨ä¸æ¶ˆæ¯æ¨é€</strong>æ˜¯ä¸¤ä¸ªå¿…ä¸å¯å°‘çš„èƒ½åŠ›ã€‚</p>
</blockquote>
<p>æ¶ˆæ¯å­˜å‚¨ç”¨äºæ”¯æŒèŠå¤©è®°å½•æŸ¥è¯¢å’Œç¦»çº¿æ¶ˆæ¯ï¼Œè€Œæ¶ˆæ¯æ¨é€åˆ™ä¿è¯ç”¨æˆ·å³ä½¿æš‚æ—¶ä¸åœ¨çº¿ï¼Œä¹Ÿä¸ä¼šé”™è¿‡é‡è¦ä¿¡æ¯ã€‚æœ¬æ–‡å°†å›´ç»•è¿™ä¸¤ä¸ªå…³é”®èƒ½åŠ›ï¼Œä»‹ç»åœ¨ Node.js ä¸­çš„å¸¸è§å®ç°æ€è·¯ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦æ¶ˆæ¯å­˜å‚¨</h2>
<p>åœ¨æœ€ç®€å•çš„èŠå¤©ç¤ºä¾‹ä¸­ï¼Œæ¶ˆæ¯åªå­˜åœ¨äºå†…å­˜ä¸­ï¼Œä¸€æ—¦ç”¨æˆ·æ–­çº¿æˆ–æœåŠ¡é‡å¯ï¼Œæ¶ˆæ¯å°±ä¼šä¸¢å¤±ã€‚è¿™åœ¨çœŸå®åœºæ™¯ä¸­æ˜¯ä¸å¯æ¥å—çš„ã€‚</p>
<p>æ¶ˆæ¯å­˜å‚¨ä¸»è¦è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li>ç”¨æˆ·å¯ä»¥æŸ¥çœ‹å†å²èŠå¤©è®°å½•</li>
<li>æ”¯æŒç”¨æˆ·ç¦»çº¿åé‡æ–°ä¸Šçº¿æŸ¥çœ‹æ¶ˆæ¯</li>
<li>æ”¯æŒå¤šç«¯ç™»å½•æ—¶çš„æ•°æ®åŒæ­¥</li>
<li>ä¸ºåç»­æœç´¢å’Œç»Ÿè®¡æä¾›åŸºç¡€</li>
</ul>
<p>å› æ­¤ï¼ŒèŠå¤©ç³»ç»Ÿå¿…é¡»å°†æ¶ˆæ¯æŒä¹…åŒ–å­˜å‚¨ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€æ¶ˆæ¯æ•°æ®æ¨¡å‹è®¾è®¡</h2>
<p>åœ¨å¼€å§‹ç¼–ç ä¹‹å‰ï¼Œéœ€è¦å…ˆè®¾è®¡æ¶ˆæ¯çš„åŸºæœ¬ç»“æ„ã€‚</p>
<h3 data-id="heading-2">1. æ¶ˆæ¯æ ¸å¿ƒå­—æ®µ</h3>
<p>ä¸€æ¡èŠå¤©æ¶ˆæ¯é€šå¸¸åŒ…å«ï¼š</p>
<ul>
<li>æ¶ˆæ¯ ID</li>
<li>å‘é€è€… ID</li>
<li>æ¥æ”¶è€… ID æˆ–ç¾¤ ID</li>
<li>æ¶ˆæ¯ç±»å‹ï¼ˆç§èŠ / ç¾¤èŠï¼‰</li>
<li>æ¶ˆæ¯å†…å®¹</li>
<li>å‘é€æ—¶é—´</li>
<li>æ¶ˆæ¯çŠ¶æ€ï¼ˆå·²è¯» / æœªè¯»ï¼‰</li>
</ul>
<p>è¿™äº›å­—æ®µå¯ä»¥æ»¡è¶³ç»å¤§å¤šæ•°èŠå¤©åœºæ™¯ã€‚</p>
<hr/>
<h3 data-id="heading-3">2. æ•°æ®åº“å­˜å‚¨æ–¹æ¡ˆé€‰æ‹©</h3>
<p>å¸¸è§çš„å­˜å‚¨æ–¹å¼åŒ…æ‹¬ï¼š</p>
<ul>
<li>å…³ç³»å‹æ•°æ®åº“ï¼ˆMySQL / PostgreSQLï¼‰</li>
<li>æ–‡æ¡£æ•°æ®åº“ï¼ˆMongoDBï¼‰</li>
<li>ç¼“å­˜æ•°æ®åº“ï¼ˆRedisï¼Œç”¨äºæœªè¯»æ¶ˆæ¯ï¼‰</li>
</ul>
<p>åœ¨ Node.js é¡¹ç›®ä¸­ï¼Œå¸¸è§ç»„åˆæ˜¯ï¼š</p>
<ul>
<li>æ•°æ®åº“è´Ÿè´£é•¿æœŸå­˜å‚¨</li>
<li>Redis è´Ÿè´£ä¸´æ—¶ç¼“å­˜å’Œæ¨é€è¾…åŠ©</li>
</ul>
<hr/>
<h2 data-id="heading-4">ä¸‰ã€æ¶ˆæ¯å…¥åº“æµç¨‹è®¾è®¡</h2>
<p>å½“æœåŠ¡å™¨æ”¶åˆ°ä¸€æ¡èŠå¤©æ¶ˆæ¯æ—¶ï¼Œé€šå¸¸æ‰§è¡Œä»¥ä¸‹æµç¨‹ï¼š</p>
<ol>
<li>æ ¡éªŒæ¶ˆæ¯åˆæ³•æ€§</li>
<li>å†™å…¥æ•°æ®åº“</li>
<li>åˆ¤æ–­æ¥æ”¶æ–¹æ˜¯å¦åœ¨çº¿</li>
<li>åœ¨çº¿åˆ™å®æ—¶æ¨é€</li>
<li>ä¸åœ¨çº¿åˆ™æ ‡è®°ä¸ºæœªè¯»</li>
</ol>
<p>è¿™ç§è®¾è®¡å¯ä»¥ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ã€‚</p>
<hr/>
<h2 data-id="heading-5">å››ã€æ¶ˆæ¯å­˜å‚¨å®ç°æ€è·¯</h2>
<h3 data-id="heading-6">1. ç§èŠæ¶ˆæ¯å­˜å‚¨</h3>
<p>ç§èŠæ¶ˆæ¯é€šå¸¸å­˜å‚¨ä¸ºä¸€æ¡ç‹¬ç«‹è®°å½•ï¼ŒåŒ…å«å‘é€è€…å’Œæ¥æ”¶è€…ä¿¡æ¯ã€‚</p>
<p>ç¤ºä¾‹é€»è¾‘ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">savePrivateMessage</span>(<span class="hljs-params">message</span>) {
  <span class="hljs-keyword">await</span> <span class="hljs-title class_">Message</span>.<span class="hljs-title function_">create</span>({
    <span class="hljs-attr">from</span>: message.<span class="hljs-property">from</span>,
    <span class="hljs-attr">to</span>: message.<span class="hljs-property">to</span>,
    <span class="hljs-attr">content</span>: message.<span class="hljs-property">content</span>,
    <span class="hljs-attr">type</span>: <span class="hljs-string">'private'</span>,
    <span class="hljs-attr">created_at</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()
  });
}
</code></pre>
<p>æ•°æ®åº“ä¸­å¯é€šè¿‡ from / to å­—æ®µå¿«é€ŸæŸ¥è¯¢å†å²æ¶ˆæ¯ã€‚</p>
<hr/>
<h3 data-id="heading-7">2. ç¾¤èŠæ¶ˆæ¯å­˜å‚¨</h3>
<p>ç¾¤èŠæ¶ˆæ¯é€šå¸¸åªå­˜ä¸€æ¡è®°å½•ï¼Œä½†å…³è”ç¾¤ IDã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">saveGroupMessage</span>(<span class="hljs-params">message</span>) {
  <span class="hljs-keyword">await</span> <span class="hljs-title class_">Message</span>.<span class="hljs-title function_">create</span>({
    <span class="hljs-attr">from</span>: message.<span class="hljs-property">from</span>,
    <span class="hljs-attr">room_id</span>: message.<span class="hljs-property">roomId</span>,
    <span class="hljs-attr">content</span>: message.<span class="hljs-property">content</span>,
    <span class="hljs-attr">type</span>: <span class="hljs-string">'group'</span>,
    <span class="hljs-attr">created_at</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()
  });
}
</code></pre>
<p>æŸ¥è¯¢ç¾¤èŠè®°å½•æ—¶ï¼Œæ ¹æ® room_id è¿‡æ»¤å³å¯ã€‚</p>
<hr/>
<h2 data-id="heading-8">äº”ã€å†å²æ¶ˆæ¯æŸ¥è¯¢</h2>
<p>ä¸ºäº†æ”¯æŒèŠå¤©è®°å½•å±•ç¤ºï¼Œé€šå¸¸éœ€è¦æä¾› HTTP API æŸ¥è¯¢å†å²æ¶ˆæ¯ã€‚</p>
<p>å¸¸è§è®¾è®¡æ–¹å¼ï¼š</p>
<ul>
<li>ç§èŠï¼šæ ¹æ®ä¸¤ä¸ªç”¨æˆ· ID æŸ¥è¯¢</li>
<li>ç¾¤èŠï¼šæ ¹æ®ç¾¤ ID æŸ¥è¯¢</li>
<li>æ”¯æŒåˆ†é¡µï¼Œé¿å…ä¸€æ¬¡è¿”å›å¤§é‡æ•°æ®</li>
</ul>
<p>è¿™ç§æ¥å£é€šå¸¸ç”± HTTP æœåŠ¡æä¾›ï¼Œè€Œä¸æ˜¯ WebSocketã€‚</p>
<hr/>
<h2 data-id="heading-9">å…­ã€ç¦»çº¿æ¶ˆæ¯å¤„ç†</h2>
<h3 data-id="heading-10">1. ç¦»çº¿æ¶ˆæ¯çš„åˆ¤å®š</h3>
<p>æœåŠ¡å™¨å¯ä»¥é€šè¿‡åœ¨çº¿ç”¨æˆ·æ˜ å°„åˆ¤æ–­ï¼š</p>
<ul>
<li>æ¥æ”¶æ–¹åœ¨çº¿ â†’ ç›´æ¥æ¨é€</li>
<li>æ¥æ”¶æ–¹ç¦»çº¿ â†’ å­˜å‚¨ä¸ºæœªè¯»æ¶ˆæ¯</li>
</ul>
<p>æœªè¯»çŠ¶æ€é€šå¸¸éœ€è¦åœ¨æ•°æ®åº“æˆ– Redis ä¸­æ ‡è®°ã€‚</p>
<hr/>
<h3 data-id="heading-11">2. ç¦»çº¿æ¶ˆæ¯æ¨é€æ—¶æœº</h3>
<p>å½“ç”¨æˆ·é‡æ–°ä¸Šçº¿æ—¶ï¼š</p>
<ol>
<li>æŸ¥è¯¢æœªè¯»æ¶ˆæ¯</li>
<li>æŒ‰æ—¶é—´é¡ºåºæ¨é€ç»™å®¢æˆ·ç«¯</li>
<li>æ›´æ–°æ¶ˆæ¯çŠ¶æ€ä¸ºå·²è¯»</li>
</ol>
<p>è¿™ç§æ–¹å¼ä¿è¯æ¶ˆæ¯ä¸ä¼šä¸¢å¤±ã€‚</p>
<hr/>
<h2 data-id="heading-12">ä¸ƒã€æ¶ˆæ¯æ¨é€æœºåˆ¶è®¾è®¡</h2>
<h3 data-id="heading-13">1. WebSocket å®æ—¶æ¨é€</h3>
<p>å¯¹äºåœ¨çº¿ç”¨æˆ·ï¼Œæ¶ˆæ¯é€šè¿‡ WebSocket å³æ—¶æ¨é€ï¼š</p>
<ul>
<li>å»¶è¿Ÿä½</li>
<li>ä½“éªŒå¥½</li>
<li>é€‚åˆèŠå¤©åœºæ™¯</li>
</ul>
<p>è¿™æ˜¯èŠå¤©ç³»ç»Ÿçš„ä¸»è¦æ¨é€æ–¹å¼ã€‚</p>
<hr/>
<h3 data-id="heading-14">2. ä¸ HTTP æ¥å£é…åˆ</h3>
<p>WebSocket è´Ÿè´£å®æ—¶æ¶ˆæ¯ï¼Œè€Œ HTTP æ¥å£è´Ÿè´£ï¼š</p>
<ul>
<li>å†å²æ¶ˆæ¯æŸ¥è¯¢</li>
<li>æœªè¯»æ¶ˆæ¯ç»Ÿè®¡</li>
<li>æ¶ˆæ¯çŠ¶æ€æ›´æ–°</li>
</ul>
<p>äºŒè€…é…åˆï¼Œå¯ä»¥è®©ç³»ç»Ÿç»“æ„æ›´åŠ æ¸…æ™°ã€‚</p>
<hr/>
<h2 data-id="heading-15">å…«ã€æ€§èƒ½ä¸æ‰©å±•æ€§è€ƒè™‘</h2>
<p>å½“ç”¨æˆ·è§„æ¨¡å¢å¤§åï¼Œéœ€è¦è€ƒè™‘ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li>æ¶ˆæ¯è¡¨æ•°æ®é‡å¿«é€Ÿå¢é•¿</li>
<li>æŸ¥è¯¢æ€§èƒ½ä¸‹é™</li>
<li>å•èŠ‚ç‚¹ WebSocket æœåŠ¡å‹åŠ›å¢å¤§</li>
</ul>
<p>å¸¸è§ä¼˜åŒ–æ–¹å‘åŒ…æ‹¬ï¼š</p>
<ul>
<li>æ¶ˆæ¯è¡¨æŒ‰æ—¶é—´æˆ–ç”¨æˆ·åˆ†è¡¨</li>
<li>ä½¿ç”¨ Redis ç¼“å­˜æœ€è¿‘æ¶ˆæ¯</li>
<li>WebSocket æœåŠ¡é›†ç¾¤åŒ–</li>
<li>ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œè·¨èŠ‚ç‚¹å¹¿æ’­</li>
</ul>
<p>è¿™äº›é—®é¢˜åœ¨ç³»ç»Ÿæ—©æœŸè®¾è®¡é˜¶æ®µå°±åº”æœ‰æ‰€é¢„æœŸã€‚</p>
<hr/>
<h2 data-id="heading-16">ä¹ã€æ€»ç»“</h2>
<p>æ¶ˆæ¯å­˜å‚¨ä¸æ¨é€æ˜¯å³æ—¶èŠå¤©ç³»ç»Ÿä¸­ä¸å¯æˆ–ç¼ºçš„æ ¸å¿ƒèƒ½åŠ›ã€‚é€šè¿‡åˆç†çš„æ•°æ®æ¨¡å‹è®¾è®¡ã€æ¸…æ™°çš„æ¶ˆæ¯æµç¨‹å’Œ WebSocket + HTTP çš„åä½œæ–¹å¼ï¼Œå¯ä»¥æ„å»ºä¸€ä¸ªç¨³å®šã€å¯æ‰©å±•çš„èŠå¤©ç³»ç»Ÿã€‚</p>
<p>åœ¨ã€ŠNode.js ç¼–ç¨‹å®æˆ˜ã€‹ç³»åˆ—ä¸­ï¼Œå³æ—¶èŠå¤©é¡¹ç›®ä¸ä»…å±•ç¤ºäº† WebSocket çš„ä½¿ç”¨æ–¹å¼ï¼Œä¹Ÿæ¶µç›–äº†çœŸå®ç³»ç»Ÿä¸­å¸¸è§çš„æ¶ˆæ¯æŒä¹…åŒ–å’Œæ¨é€åœºæ™¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é‡æ„äº†20ä¸ªSpringBooté¡¹ç›®åï¼Œæ€»ç»“å‡ºè¿™å¥—ç¨³å®šé«˜æ•ˆçš„æ¶æ„è®¾è®¡]]></title>    <link>https://juejin.cn/post/7595893785907658786</link>    <guid>https://juejin.cn/post/7595893785907658786</guid>    <pubDate>2026-01-18T05:34:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595893785907658786" data-draft-id="7587284708947329039" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é‡æ„äº†20ä¸ªSpringBooté¡¹ç›®åï¼Œæ€»ç»“å‡ºè¿™å¥—ç¨³å®šé«˜æ•ˆçš„æ¶æ„è®¾è®¡"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2026-01-18T05:34:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å¤§å"/> <meta itemprop="url" content="https://juejin.cn/user/3507878440995946"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é‡æ„äº†20ä¸ªSpringBooté¡¹ç›®åï¼Œæ€»ç»“å‡ºè¿™å¥—ç¨³å®šé«˜æ•ˆçš„æ¶æ„è®¾è®¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3507878440995946/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å¤§å
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T05:34:49.000Z" title="Sun Jan 18 2026 05:34:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸ºä»€ä¹ˆæˆ‘ä»¬åˆšå¼€å§‹çš„ <code>SpringBoot</code> é¡¹ç›®æ¸…çˆ½ç®€æ´ï¼Œä½†éšç€ä¸šåŠ¡å¢é•¿ï¼Œä»£ç å´å˜å¾—è¶Šæ¥è¶Šè‡ƒè‚¿ã€éš¾ä»¥ç»´æŠ¤ï¼Ÿ</p>
<p>å…¶å®<strong>é¡¹ç›®æ¶æ„çš„åˆç†æ€§</strong>å¾€å¾€å†³å®šäº†åæœŸçš„å¼€å‘æ•ˆç‡ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€å¸¸è¸©çš„å‘</h2>
<p>ä¸¾2ä¸ªå…¸å‹åœºæ™¯ï¼š</p>
<p><strong>1.ä¸‡èƒ½çš„Service</strong>ï¼šå°æè¦ä¿®æ”¹ä¸€ä¸ªè®¢å•çŠ¶æ€çš„åŠŸèƒ½ï¼Œç»“æœå‘ç°<code>OrderService.java</code>å·²ç»3800å¤šè¡Œäº†ï¼é‡Œé¢æ—¢æœ‰è®¢å•å¤„ç†ï¼Œåˆæœ‰ç”¨æˆ·ç§¯åˆ†è®¡ç®—ï¼Œè¿˜å¤¹æ‚ç€å„ç§æŠ¥è¡¨å¯¼å‡ºé€»è¾‘ã€‚æƒ³æ”¹ä¸€è¡Œä»£ç ï¼Œå¾—å…ˆèŠ±åŠå¤©æ—¶é—´ç†è§£ã€‚</p>
<p><strong>2.å¼‚å¸¸å¤„ç†</strong>ï¼šçº¿ä¸Šå‡ºäº†ä¸ªé—®é¢˜ï¼Œç”¨æˆ·æ”¯ä»˜æˆåŠŸäº†ä½†è®¢å•çŠ¶æ€æ²¡æ›´æ–°ã€‚æ’æŸ¥å‘ç°ï¼šæ”¯ä»˜æ¨¡å—ç”¨try-catchè¿”å›é”™è¯¯ç ï¼Œè®¢å•æ¨¡å—ç›´æ¥æŠ›å¼‚å¸¸ï¼Œè€Œä¸­é—´çš„åè°ƒå±‚æ—¢æ²¡å¤„ç†å¼‚å¸¸ä¹Ÿæ²¡è®°å½•æ—¥å¿—ï¼Œå‡ºäº†é—®é¢˜éƒ½ä¸çŸ¥é“è¯¥æ‰¾è°ã€‚</p>
<h2 data-id="heading-1">äºŒã€ä¸€ä¸ªæ¸…æ™°çš„æ¶æ„åº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­</h2>
<h3 data-id="heading-2">1. åˆç†çš„é¡¹ç›®ç»“æ„</h3>
<p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹è‰¯å¥½çš„é¡¹ç›®ç»“æ„åº”è¯¥æ˜¯ä»€ä¹ˆæ ·çš„ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">src/main/java
â””â”€â”€ com
    â””â”€â”€ example
        â””â”€â”€ project
            â”œâ”€â”€ common           <span class="hljs-comment">// é€šç”¨ç»„ä»¶</span>
            â”‚   â”œâ”€â”€ annotation   <span class="hljs-comment">// è‡ªå®šä¹‰æ³¨è§£</span>
            â”‚   â”œâ”€â”€ config       <span class="hljs-comment">// å…¨å±€é…ç½®</span>
            â”‚   â”œâ”€â”€ constant     <span class="hljs-comment">// å¸¸é‡</span>
            â”‚   â”œâ”€â”€ exception    <span class="hljs-comment">// ç»Ÿä¸€å¼‚å¸¸å¤„ç†</span>
            â”‚   â”œâ”€â”€ utils        <span class="hljs-comment">// å·¥å…·ç±»</span>
            â”‚   â””â”€â”€ vo           <span class="hljs-comment">// é€šç”¨VO</span>
            â”œâ”€â”€ module1          <span class="hljs-comment">// ä¸šåŠ¡æ¨¡å—1</span>
            â”‚   â”œâ”€â”€ controller   <span class="hljs-comment">// æ§åˆ¶å™¨</span>
            â”‚   â”œâ”€â”€ service      <span class="hljs-comment">// æœåŠ¡å±‚</span>
            â”‚   â”œâ”€â”€ dao          <span class="hljs-comment">// æ•°æ®è®¿é—®å±‚</span>
            â”‚   â”œâ”€â”€ entity       <span class="hljs-comment">// å®ä½“ç±»</span>
            â”‚   â”œâ”€â”€ dto          <span class="hljs-comment">// æ•°æ®ä¼ è¾“å¯¹è±¡</span>
            â”‚   â””â”€â”€ vo           <span class="hljs-comment">// è§†å›¾å¯¹è±¡</span>
            â”œâ”€â”€ module2          <span class="hljs-comment">// ä¸šåŠ¡æ¨¡å—2</span>
            â”‚   â””â”€â”€ ...          <span class="hljs-comment">// ç»“æ„åŒä¸Š</span>
            â””â”€â”€ ProjectApplication.java  <span class="hljs-comment">// å¯åŠ¨ç±»</span>
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ</strong></p>
<ul>
<li><strong>æŒ‰åŠŸèƒ½æ¨¡å—åˆ’åˆ†</strong>ï¼šè€Œä¸æ˜¯æŒ‰æŠ€æœ¯å±‚æ¬¡åˆ’åˆ†ã€‚è¿™æ ·æ¯ä¸ªæ¨¡å—éƒ½æ˜¯è‡ªåŒ…å«çš„ï¼ŒèŒè´£å•ä¸€ï¼Œä¿®æ”¹ä¸€ä¸ªæ¨¡å—ä¸ä¼šå½±å“åˆ°å…¶ä»–æ¨¡å—ã€‚</li>
<li><strong>åˆ†å±‚æ¸…æ™°</strong>ï¼šcontrollerè´Ÿè´£æ¥æ”¶è¯·æ±‚ï¼Œserviceå¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œdaoè´Ÿè´£æ•°æ®æ“ä½œã€‚</li>
<li><strong>é€šç”¨ç»„ä»¶æŠ½å–</strong>ï¼šé¿å…ä»£ç é‡å¤ï¼Œä¸€å¤„ä¿®æ”¹å¤„å¤„ç”Ÿæ•ˆã€‚</li>
</ul>
<h3 data-id="heading-3">2. ç»Ÿä¸€çš„APIå“åº”æ ¼å¼</h3>
<p>æ¥å£è¿”å›æ ¼å¼äº”èŠ±å…«é—¨ï¼Œå‰ç«¯åŒäº‹æ˜¯ä¸æ˜¯ç»å¸¸æ‰¾ä½ åæ§½ï¼Ÿæ¥çœ‹çœ‹ç»Ÿä¸€å“åº”æ ¼å¼çš„è®¾è®¡ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * ç»Ÿä¸€APIå“åº”æ ¼å¼
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@NoArgsConstructor</span>
<span class="hljs-meta">@AllArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Result</span>&lt;T&gt; {
    <span class="hljs-keyword">private</span> Integer code;    <span class="hljs-comment">// çŠ¶æ€ç </span>
    <span class="hljs-keyword">private</span> String message;  <span class="hljs-comment">// æ¶ˆæ¯</span>
    <span class="hljs-keyword">private</span> T data;          <span class="hljs-comment">// æ•°æ®</span>
    
    <span class="hljs-comment">// æˆåŠŸå“åº”</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="hljs-title function_">success</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Result</span>&lt;&gt;(<span class="hljs-number">200</span>, <span class="hljs-string">"æ“ä½œæˆåŠŸ"</span>, <span class="hljs-literal">null</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="hljs-title function_">success</span><span class="hljs-params">(T data)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Result</span>&lt;&gt;(<span class="hljs-number">200</span>, <span class="hljs-string">"æ“ä½œæˆåŠŸ"</span>, data);
    }
    
    <span class="hljs-comment">// å¤±è´¥å“åº”</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="hljs-title function_">error</span><span class="hljs-params">(String message)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Result</span>&lt;&gt;(<span class="hljs-number">500</span>, message, <span class="hljs-literal">null</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="hljs-title function_">error</span><span class="hljs-params">(Integer code, String message)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Result</span>&lt;&gt;(code, message, <span class="hljs-literal">null</span>);
    }
}
</code></pre>
<p>è¿™æ ·ï¼Œæ‰€æœ‰æ¥å£è¿”å›éƒ½éµå¾ªç»Ÿä¸€æ ¼å¼ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">200</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ“ä½œæˆåŠŸ"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ç¤ºä¾‹æ•°æ®"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>å¥½å¤„</strong>ï¼šå‰ç«¯å¯ä»¥ç»Ÿä¸€å°è£…è¯·æ±‚æ‹¦æˆªå™¨ï¼Œæ— éœ€ä¸ºæ¯ä¸ªæ¥å£å•ç‹¬å¤„ç†å“åº”æ ¼å¼ã€‚</p>
<h3 data-id="heading-4">3. å…¨å±€å¼‚å¸¸å¤„ç†</h3>
<p>åˆ«å†åœ¨æ¯ä¸ªæ–¹æ³•é‡Œå†™try-catchäº†ï¼ä½¿ç”¨ <code>@ControllerAdvice</code> å®ç°å…¨å±€å¼‚å¸¸å¤„ç†ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RestControllerAdvice</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GlobalExceptionHandler</span> {
    
    <span class="hljs-comment">// å¤„ç†è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸</span>
    <span class="hljs-meta">@ExceptionHandler(BusinessException.class)</span>
    <span class="hljs-keyword">public</span> Result&lt;?&gt; handleBusinessException(BusinessException e) {
        log.warn(<span class="hljs-string">"ä¸šåŠ¡å¼‚å¸¸: {}"</span>, e.getMessage());
        <span class="hljs-keyword">return</span> Result.error(e.getCode(), e.getMessage());
    }
    
    <span class="hljs-comment">// å¤„ç†å‚æ•°æ ¡éªŒå¼‚å¸¸</span>
    <span class="hljs-meta">@ExceptionHandler(MethodArgumentNotValidException.class)</span>
    <span class="hljs-keyword">public</span> Result&lt;?&gt; handleValidException(MethodArgumentNotValidException e) {
        <span class="hljs-type">String</span> <span class="hljs-variable">error</span> <span class="hljs-operator">=</span> e.getBindingResult().getFieldError().getDefaultMessage();
        <span class="hljs-keyword">return</span> Result.error(<span class="hljs-number">400</span>, error);
    }
    
    <span class="hljs-comment">// å¤„ç†æ‰€æœ‰å…¶ä»–å¼‚å¸¸</span>
    <span class="hljs-meta">@ExceptionHandler(Exception.class)</span>
    <span class="hljs-keyword">public</span> Result&lt;?&gt; handleException(Exception e) {
        log.error(<span class="hljs-string">"ç³»ç»Ÿå¼‚å¸¸: {}"</span>, e.getMessage(), e);
        <span class="hljs-keyword">return</span> Result.error(<span class="hljs-number">500</span>, <span class="hljs-string">"ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•"</span>);
    }
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ ·åš</strong>ï¼š</p>
<ul>
<li>ä¸šåŠ¡ä»£ç æ›´æ¸…çˆ½ï¼Œåªéœ€å…³æ³¨æ­£å¸¸é€»è¾‘</li>
<li>å¼‚å¸¸å¤„ç†é›†ä¸­ï¼Œä¿®æ”¹æ–¹ä¾¿</li>
<li>å¯ä»¥ç»Ÿä¸€è®°å½•å¼‚å¸¸æ—¥å¿—ï¼Œæ–¹ä¾¿æ’æŸ¥é—®é¢˜</li>
</ul>
<h3 data-id="heading-5">4. é…ç½®ç®¡ç†æœ€ä½³å®è·µ</h3>
<p>é…ç½®æ–‡ä»¶ç®¡ç†æ··ä¹±æ˜¯å¾ˆå¤šé¡¹ç›®çš„ç—›ç‚¹ã€‚æ¨èè¿™æ ·ç»„ç»‡ï¼š</p>
<ul>
<li><strong>åˆ†ç¯å¢ƒé…ç½®</strong>ï¼šapplication.ymlï¼ˆå…¬å…±é…ç½®ï¼‰+ application-{env}.ymlï¼ˆç¯å¢ƒç‰¹å®šé…ç½®ï¼‰</li>
<li><strong>æ•æ„Ÿä¿¡æ¯å¤–éƒ¨åŒ–</strong>ï¼šæ•°æ®åº“å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ä¸è¦æ”¾åœ¨ä»£ç ä»“åº“ï¼Œä½¿ç”¨é…ç½®ä¸­å¿ƒæˆ–ç¯å¢ƒå˜é‡</li>
<li><strong>é…ç½®ç±»å°è£…</strong>ï¼šä½¿ç”¨@ConfigurationPropertieså°†é…ç½®é¡¹æ˜ å°„ä¸ºJavaå¯¹è±¡</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@ConfigurationProperties(prefix = "app.jwt")</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JwtProperties</span> {
    <span class="hljs-keyword">private</span> String secret;
    <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> expiration;
    <span class="hljs-keyword">private</span> String header;
}
</code></pre>
<p><strong>å¥½å¤„</strong>ï¼š</p>
<ul>
<li>é…ç½®ä¸ä»£ç è§£è€¦</li>
<li>ä¿®æ”¹é…ç½®æ— éœ€é‡æ–°ç¼–è¯‘</li>
<li>ç±»å‹å®‰å…¨ï¼ŒIDEèƒ½æä¾›è‡ªåŠ¨è¡¥å…¨å’ŒéªŒè¯</li>
</ul>
<h3 data-id="heading-6">5. äº‹åŠ¡ç®¡ç†è§„èŒƒ</h3>
<p>äº‹åŠ¡ç®¡ç†ä¸å½“ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€‚å»ºè®®ï¼š</p>
<ol>
<li><strong>é¿å…åœ¨Controllerå±‚å¼€å¯äº‹åŠ¡</strong>ï¼šäº‹åŠ¡åº”ç”±Serviceå±‚ç®¡ç†</li>
<li><strong>åˆç†è®¾ç½®äº‹åŠ¡ä¼ æ’­è¡Œä¸º</strong>ï¼šæ ¹æ®ä¸šåŠ¡åœºæ™¯é€‰æ‹©åˆé€‚çš„ä¼ æ’­è¡Œä¸º</li>
<li><strong>é¿å…å¤§äº‹åŠ¡</strong>ï¼šé•¿æ—¶é—´è¿è¡Œçš„äº‹åŠ¡ä¼šé”ä½æ•°æ®åº“èµ„æº</li>
<li><strong>ç»Ÿä¸€å¼‚å¸¸å›æ»šç­–ç•¥</strong>ï¼šé»˜è®¤RuntimeExceptionä¼šè§¦å‘å›æ»šï¼Œæ£€æŸ¥å‹å¼‚å¸¸ä¸ä¼š</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> OrderRepository orderRepository;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> InventoryService inventoryService;
    
    <span class="hljs-meta">@Transactional(rollbackFor = Exception.class)</span>
    <span class="hljs-keyword">public</span> Order <span class="hljs-title function_">createOrder</span><span class="hljs-params">(OrderRequest request)</span> {
        <span class="hljs-comment">// 1. åˆ›å»ºè®¢å•</span>
        <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> orderRepository.save(convertToOrder(request));
        
        <span class="hljs-comment">// 2. æ‰£å‡åº“å­˜ï¼ˆè¿œç¨‹è°ƒç”¨ï¼‰</span>
        <span class="hljs-type">boolean</span> <span class="hljs-variable">success</span> <span class="hljs-operator">=</span> inventoryService.decrease(request.getItems());
        
        <span class="hljs-keyword">if</span> (!success) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BusinessException</span>(<span class="hljs-string">"åº“å­˜ä¸è¶³"</span>);
        }
        
        <span class="hljs-keyword">return</span> order;
    }
}
</code></pre>
<p><strong>æ³¨æ„</strong>ï¼šä¸Šé¢çš„ä¾‹å­æœ‰ç‘•ç–µï¼è¿œç¨‹è°ƒç”¨ä¸åº”æ”¾åœ¨äº‹åŠ¡ä¸­ï¼Œä¼šå¯¼è‡´äº‹åŠ¡è¿‡é•¿ã€‚æ›´åˆç†çš„åšæ³•æ˜¯ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—è§£è€¦ã€‚</p>
<h4 data-id="heading-7">æ­£ç¡®çš„åšæ³•ï¼šä½¿ç”¨å¯é äº‹ä»¶æ¨¡å¼ + æ¶ˆæ¯é˜Ÿåˆ—</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> OrderRepository orderRepository;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ApplicationEventPublisher eventPublisher;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> TransactionTemplate transactionTemplate; <span class="hljs-comment">// ç”¨äºç¼–ç¨‹å¼äº‹åŠ¡</span>
    
    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> Order <span class="hljs-title function_">createOrder</span><span class="hljs-params">(OrderRequest request)</span> {
        <span class="hljs-comment">// 1. åˆ›å»ºè®¢å•ï¼ˆåœ¨äº‹åŠ¡å†…ï¼‰</span>
        <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Order</span>();
        order.setStatus(OrderStatus.CREATED);
        order.setItems(request.getItems());
        order.setTotalAmount(calculateTotal(request.getItems()));
        order.setCreateTime(LocalDateTime.now());
        <span class="hljs-type">Order</span> <span class="hljs-variable">savedOrder</span> <span class="hljs-operator">=</span> orderRepository.save(order);
        
        <span class="hljs-comment">// 2. äº‹åŠ¡æäº¤åå†å‘é€äº‹ä»¶</span>
        <span class="hljs-comment">// ä½¿ç”¨TransactionSynchronizationç¡®ä¿äº‹åŠ¡æäº¤åæ‰æ‰§è¡Œ</span>
        transactionTemplate.execute(status -&gt; {
            TransactionSynchronizationManager.registerSynchronization(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TransactionSynchronization</span>() {
                <span class="hljs-meta">@Override</span>
                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterCommit</span><span class="hljs-params">()</span> {
                    <span class="hljs-comment">// äº‹åŠ¡æˆåŠŸæäº¤åï¼Œå‘å¸ƒæ‰£å‡åº“å­˜äº‹ä»¶</span>
                    eventPublisher.publishEvent(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderCreatedEvent</span>(savedOrder.getId(), request.getItems()));
                }
            });
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        });
        
        <span class="hljs-keyword">return</span> savedOrder;
    }
}

<span class="hljs-comment">// äº‹ä»¶ç›‘å¬å™¨ï¼ˆå¼‚æ­¥å¤„ç†ï¼‰</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InventoryEventListener</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> InventoryService inventoryService;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> OrderRepository orderRepository;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> RocketMQTemplate rocketMQTemplate; <span class="hljs-comment">// æˆ–å…¶ä»–MQå®¢æˆ·ç«¯</span>
    
    <span class="hljs-meta">@Async</span>
    <span class="hljs-meta">@TransactionalEventListener(phase = TransactionPhase.AFTER_COMMIT)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleOrderCreated</span><span class="hljs-params">(OrderCreatedEvent event)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 1. å…ˆè®°å½•äº‹ä»¶å·²å¤„ç†ï¼ˆé˜²é‡å¤ï¼‰</span>
            <span class="hljs-keyword">if</span> (eventLogService.isEventProcessed(event.getOrderId())) {
                <span class="hljs-keyword">return</span>;
            }
            
            <span class="hljs-comment">// 2. æ‰£å‡åº“å­˜ï¼ˆè¿œç¨‹è°ƒç”¨ï¼‰</span>
            <span class="hljs-type">boolean</span> <span class="hljs-variable">success</span> <span class="hljs-operator">=</span> inventoryService.decrease(event.getItems());
            
            <span class="hljs-keyword">if</span> (!success) {
                <span class="hljs-comment">// 3. åº“å­˜ä¸è¶³ï¼Œæ›´æ–°è®¢å•çŠ¶æ€</span>
                orderRepository.updateStatus(event.getOrderId(), OrderStatus.CANCELLED);
                
                <span class="hljs-comment">// 4. é€šçŸ¥ç”¨æˆ·</span>
                notificationService.sendStockShortageNotice(event.getOrderId());
            }
            
            <span class="hljs-comment">// 5. è®°å½•äº‹ä»¶å¤„ç†ç»“æœ</span>
            eventLogService.markEventAsProcessed(event.getOrderId());
            
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"å¤„ç†è®¢å•[{}]åº“å­˜æ‰£å‡å¤±è´¥"</span>, event.getOrderId(), e);
            <span class="hljs-comment">// 5. é‡è¯•æœºåˆ¶ï¼šå‘é€åˆ°MQé‡è¯•é˜Ÿåˆ—</span>
            rocketMQTemplate.convertAndSend(<span class="hljs-string">"ORDER_INVENTORY_RETRY"</span>, event);
        }
    }
}

<span class="hljs-comment">// é‡è¯•å¤„ç†å™¨ï¼ˆè¡¥å¿æœºåˆ¶ï¼‰</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InventoryRetryHandler</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> InventoryService inventoryService;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> OrderRepository orderRepository;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> EventLogService eventLogService;
    
    <span class="hljs-meta">@RocketMQMessageListener(topic = "ORDER_INVENTORY_RETRY", consumerGroup = "inventory-retry-group")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleRetry</span><span class="hljs-params">(OrderCreatedEvent event)</span> {
        <span class="hljs-comment">// 1. æ£€æŸ¥é‡è¯•æ¬¡æ•°</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">retryCount</span> <span class="hljs-operator">=</span> retryLogService.getRetryCount(event.getOrderId());
        <span class="hljs-keyword">if</span> (retryCount &gt; <span class="hljs-number">3</span>) {
            <span class="hljs-comment">// è¶…è¿‡æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œäººå·¥ä»‹å…¥</span>
            alarmService.sendAlert(<span class="hljs-string">"åº“å­˜æ‰£å‡æŒç»­å¤±è´¥ï¼Œè®¢å•ID: "</span> + event.getOrderId());
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 2. å†æ¬¡å°è¯•æ‰£å‡åº“å­˜</span>
            <span class="hljs-type">boolean</span> <span class="hljs-variable">success</span> <span class="hljs-operator">=</span> inventoryService.decrease(event.getItems());
            
            <span class="hljs-keyword">if</span> (success) {
                <span class="hljs-comment">// æ›´æ–°è®¢å•çŠ¶æ€ä¸ºå·²ç¡®è®¤</span>
                orderRepository.updateStatus(event.getOrderId(), OrderStatus.CONFIRMED);
                <span class="hljs-comment">// æ ‡è®°äº‹ä»¶å·²å¤„ç†</span>
                eventLogService.markEventAsProcessed(event.getOrderId());
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (retryCount &gt;= <span class="hljs-number">2</span>) {
                <span class="hljs-comment">// æœ€åä¸€æ¬¡é‡è¯•ä»å¤±è´¥ï¼Œå–æ¶ˆè®¢å•</span>
                orderRepository.updateStatus(event.getOrderId(), OrderStatus.CANCELLED);
                notificationService.sendStockShortageNotice(event.getOrderId());
            }
            
            <span class="hljs-comment">// 3. è®°å½•é‡è¯•</span>
            retryLogService.recordRetry(event.getOrderId());
            
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"é‡è¯•å¤„ç†è®¢å•[{}]åº“å­˜æ‰£å‡å¤±è´¥"</span>, event.getOrderId(), e);
            retryLogService.recordRetry(event.getOrderId());
            <span class="hljs-comment">// å¯ä»¥è€ƒè™‘æŒ‡æ•°é€€é¿ç®—æ³•å»¶è¿Ÿä¸‹æ¬¡é‡è¯•</span>
        }
    }
}
</code></pre>
<p>äº‹åŠ¡è®¾è®¡ä¸æ˜¯ç®€å•çš„åŠ ä¸ª<code>@Transactional</code>æ³¨è§£ï¼Œè€Œæ˜¯è¦è€ƒè™‘ï¼š</p>
<ol>
<li>äº‹åŠ¡èŒƒå›´è¦å°½é‡å°</li>
<li>äº‹åŠ¡å†…ä¸è¦æœ‰è¿œç¨‹è°ƒç”¨ã€IOæ“ä½œ</li>
<li>è·¨æœåŠ¡è°ƒç”¨éœ€è¦æœ‰è¡¥å¿æœºåˆ¶</li>
<li>æœ€ç»ˆä¸€è‡´æ€§å¾€å¾€æ˜¯æ›´å¥½çš„é€‰æ‹©</li>
</ol>
<hr/>
<h2 data-id="heading-8">ä¸‰ã€æ¡ˆä¾‹ï¼šé‡æ„å‰åçš„å¯¹æ¯”</h2>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç”¨æˆ·æ¨¡å—ï¼Œé‡æ„å‰æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// é‡æ„å‰ï¼šæ··ä¹±çš„UserService</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> UserRepository userRepository;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> EmailService emailService;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> SmsService smsService;
    
    <span class="hljs-comment">// åŒ…å«æ³¨å†Œã€ç™»å½•ã€ä¿®æ”¹èµ„æ–™ã€å¯†ç é‡ç½®ç­‰å¤šç§åŠŸèƒ½</span>
    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">register</span><span class="hljs-params">(UserRegisterDTO dto)</span> {
        <span class="hljs-comment">// 1. å‚æ•°æ ¡éªŒ</span>
        <span class="hljs-keyword">if</span> (userRepository.existsByUsername(dto.getUsername())) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"ç”¨æˆ·åå·²å­˜åœ¨"</span>);
        }
        
        <span class="hljs-comment">// 2. ä¿å­˜ç”¨æˆ·</span>
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();
        user.setUsername(dto.getUsername());
        user.setPassword(encryptPassword(dto.getPassword()));
        user.setEmail(dto.getEmail());
        user.setPhone(dto.getPhone());
        user.setCreateTime(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());
        
        <span class="hljs-type">User</span> <span class="hljs-variable">savedUser</span> <span class="hljs-operator">=</span> userRepository.save(user);
        
        <span class="hljs-comment">// 3. å‘é€æ¬¢è¿é‚®ä»¶</span>
        <span class="hljs-keyword">try</span> {
            emailService.sendWelcomeEmail(user.getEmail());
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"å‘é€æ¬¢è¿é‚®ä»¶å¤±è´¥"</span>, e);
        }
        
        <span class="hljs-keyword">return</span> savedUser;
    }
    
    <span class="hljs-comment">// è¿˜æœ‰2000è¡Œå…¶ä»–æ–¹æ³•...</span>
}
</code></pre>
<p>é‡æ„åï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// é‡æ„åï¼šèŒè´£æ¸…æ™°çš„åˆ†å±‚æ¶æ„</span>
<span class="hljs-comment">// controller/UserController.java</span>
<span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping("/users")</span>
<span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserService userService;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserRegisterService userRegisterService;
    
    <span class="hljs-meta">@PostMapping("/register")</span>
    <span class="hljs-keyword">public</span> Result&lt;UserVO&gt; <span class="hljs-title function_">register</span><span class="hljs-params">(<span class="hljs-meta">@Valid</span> <span class="hljs-meta">@RequestBody</span> UserRegisterDTO dto)</span> {
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userRegisterService.register(dto);
        <span class="hljs-keyword">return</span> Result.success(convertToVO(user));
    }
    
    <span class="hljs-meta">@GetMapping("/{id}")</span>
    <span class="hljs-keyword">public</span> Result&lt;UserDetailVO&gt; <span class="hljs-title function_">getById</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span> {
        <span class="hljs-type">UserDetail</span> <span class="hljs-variable">detail</span> <span class="hljs-operator">=</span> userService.getUserDetail(id);
        <span class="hljs-keyword">return</span> Result.success(convertToDetailVO(detail));
    }
}

<span class="hljs-comment">// service/UserRegisterService.java</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-meta">@Transactional(rollbackFor = Exception.class)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserRegisterService</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserRepository userRepository;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserValidator userValidator;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> PasswordEncoder passwordEncoder;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserEventPublisher eventPublisher;
    
    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">register</span><span class="hljs-params">(UserRegisterDTO dto)</span> {
        <span class="hljs-comment">// 1. æ ¡éªŒ</span>
        userValidator.validateRegistration(dto);
        
        <span class="hljs-comment">// 2. åˆ›å»ºç”¨æˆ·</span>
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> createUserFromDto(dto);
        
        <span class="hljs-comment">// 3. ä¿å­˜</span>
        <span class="hljs-type">User</span> <span class="hljs-variable">savedUser</span> <span class="hljs-operator">=</span> userRepository.save(user);
        
        <span class="hljs-comment">// 4. å‘å¸ƒäº‹ä»¶ï¼ˆè§£è€¦é€šçŸ¥é€»è¾‘ï¼‰</span>
        eventPublisher.publishUserRegisteredEvent(savedUser);
        
        <span class="hljs-keyword">return</span> savedUser;
    }
    
    <span class="hljs-keyword">private</span> User <span class="hljs-title function_">createUserFromDto</span><span class="hljs-params">(UserRegisterDTO dto)</span> {
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();
        user.setUsername(dto.getUsername());
        user.setPassword(passwordEncoder.encode(dto.getPassword()));
        user.setEmail(dto.getEmail());
        user.setPhone(dto.getPhone());
        user.setCreateTime(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());
        <span class="hljs-keyword">return</span> user;
    }
}

<span class="hljs-comment">// service/UserService.java</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserRepository userRepository;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserFactory userFactory;
    
    <span class="hljs-meta">@Transactional(readOnly = true)</span>
    <span class="hljs-keyword">public</span> UserDetail <span class="hljs-title function_">getUserDetail</span><span class="hljs-params">(Long userId)</span> {
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userRepository.findById(userId)
                .orElseThrow(() -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">BusinessException</span>(<span class="hljs-string">"ç”¨æˆ·ä¸å­˜åœ¨"</span>));
        
        <span class="hljs-comment">// ç»„è£…è¯¦ç»†ä¿¡æ¯ï¼ˆå¯èƒ½æ¶‰åŠå¤šè¡¨æŸ¥è¯¢ï¼‰</span>
        <span class="hljs-keyword">return</span> userFactory.createUserDetail(user);
    }
}

<span class="hljs-comment">// event/UserEventPublisher.java</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserEventPublisher</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ApplicationEventPublisher eventPublisher;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">publishUserRegisteredEvent</span><span class="hljs-params">(User user)</span> {
        eventPublisher.publishEvent(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UserRegisteredEvent</span>(<span class="hljs-built_in">this</span>, user));
    }
}

<span class="hljs-comment">// listener/UserRegistrationListener.java</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserRegistrationListener</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> EmailService emailService;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> SmsService smsService;
    
    <span class="hljs-meta">@Async</span> <span class="hljs-comment">// å¼‚æ­¥å¤„ç†</span>
    <span class="hljs-meta">@EventListener</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleUserRegistered</span><span class="hljs-params">(UserRegisteredEvent event)</span> {
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> event.getUser();
        <span class="hljs-keyword">try</span> {
            emailService.sendWelcomeEmail(user.getEmail());
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"å‘é€æ¬¢è¿é‚®ä»¶å¤±è´¥ï¼Œç”¨æˆ·ID: {}"</span>, user.getId(), e);
        }
        
        <span class="hljs-keyword">try</span> {
            smsService.sendWelcomeSms(user.getPhone());
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"å‘é€æ¬¢è¿çŸ­ä¿¡å¤±è´¥ï¼Œç”¨æˆ·ID: {}"</span>, user.getId(), e);
        }
    }
}
</code></pre>
<p><strong>é‡æ„å¸¦æ¥çš„å¥½å¤„</strong>ï¼š</p>
<ol>
<li><strong>èŒè´£åˆ†æ˜</strong>ï¼šæ³¨å†ŒæœåŠ¡åªè´Ÿè´£æ³¨å†Œï¼ŒæŸ¥è¯¢æœåŠ¡åªè´Ÿè´£æŸ¥è¯¢</li>
<li><strong>äº‹åŠ¡è¾¹ç•Œæ¸…æ™°</strong>ï¼šåªæœ‰éœ€è¦äº‹åŠ¡çš„æ–¹æ³•æ‰æ·»åŠ @Transactional</li>
<li><strong>è§£è€¦é€šçŸ¥é€»è¾‘</strong>ï¼šä½¿ç”¨äº‹ä»¶æœºåˆ¶å°†æ ¸å¿ƒä¸šåŠ¡ä¸è¾…åŠ©åŠŸèƒ½è§£è€¦</li>
<li><strong>å¯æµ‹è¯•æ€§å¼º</strong>ï¼šæ¯ä¸ªç»„ä»¶èŒè´£å•ä¸€ï¼Œæ›´å®¹æ˜“ç¼–å†™å•å…ƒæµ‹è¯•</li>
<li><strong>å¼‚å¸¸å¤„ç†ç»Ÿä¸€</strong>ï¼šä¾èµ–å…¨å±€å¼‚å¸¸å¤„ç†å™¨ï¼Œæ— éœ€åœ¨ä¸šåŠ¡ä»£ç ä¸­å¤„ç†å¼‚å¸¸</li>
</ol>
<h2 data-id="heading-9">å››ã€æ¶æ„è®¾è®¡çš„å‡ ä¸ªå…³é”®åŸåˆ™</h2>
<p>åˆ†äº«å‡ ä¸ªæˆ‘è®¤ä¸ºç‰¹åˆ«é‡è¦çš„åŸåˆ™ï¼Œè¿™äº›åŸåˆ™æŒ‡å¯¼ç€æˆ‘çš„æ¶æ„è®¾è®¡ï¼š</p>
<h3 data-id="heading-10">1. é«˜å†…èšä½è€¦åˆ</h3>
<ul>
<li><strong>é«˜å†…èš</strong>ï¼šä¸€ä¸ªæ¨¡å—å†…éƒ¨çš„ç»„ä»¶é«˜åº¦ç›¸å…³ï¼Œå…±åŒå®Œæˆå•ä¸€èŒè´£</li>
<li><strong>ä½è€¦åˆ</strong>ï¼šæ¨¡å—ä¹‹é—´ä¾èµ–å…³ç³»ç®€å•ï¼Œä¿®æ”¹ä¸€ä¸ªæ¨¡å—ä¸ä¼šå½±å“å¤ªå¤šå…¶ä»–æ¨¡å—</li>
</ul>
<h3 data-id="heading-11">2. å…³æ³¨ç‚¹åˆ†ç¦»ï¼ˆSoCï¼‰</h3>
<p>å°†ä¸åŒå…³æ³¨ç‚¹ï¼ˆå¦‚ä¸šåŠ¡é€»è¾‘ã€æ•°æ®è®¿é—®ã€å®‰å…¨æ§åˆ¶ï¼‰åˆ†ç¦»åˆ°ä¸åŒç»„ä»¶ä¸­ï¼Œæ¯ä¸ªç»„ä»¶åªå…³æ³¨è‡ªå·±çš„èŒè´£ã€‚</p>
<h3 data-id="heading-12">3. ä¾èµ–å€’ç½®åŸåˆ™</h3>
<p>é«˜å±‚æ¨¡å—ä¸åº”ä¾èµ–ä½å±‚æ¨¡å—ï¼Œä¸¤è€…éƒ½åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚æŠ½è±¡ä¸åº”ä¾èµ–ç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¸å¥½çš„è®¾è®¡</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {
    <span class="hljs-keyword">private</span> MysqlOrderRepository repository; <span class="hljs-comment">// ä¾èµ–å…·ä½“å®ç°</span>
}

<span class="hljs-comment">// å¥½çš„è®¾è®¡</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {
    <span class="hljs-keyword">private</span> OrderRepository repository; <span class="hljs-comment">// ä¾èµ–æŠ½è±¡æ¥å£</span>
}
</code></pre>
<h3 data-id="heading-13">4. é€‚æ—¶é‡æ„</h3>
<p>ä¸è¦ç­‰åˆ°ä»£ç çƒ‚åˆ°æ— æ³•ç»´æŠ¤æ‰é‡æ„ã€‚å»ºè®®ï¼š</p>
<ul>
<li>æ¯æ¬¡ä¿®æ”¹ä»£ç æ—¶ï¼Œé¡ºæ‰‹æ”¹è¿›ç›¸å…³çš„ç»“æ„</li>
<li>å®šæœŸè¿›è¡Œä»£ç è¯„å®¡ï¼Œå‘ç°æ¶æ„é—®é¢˜åŠæ—¶è°ƒæ•´</li>
<li>ä½¿ç”¨è‡ªåŠ¨åŒ–æµ‹è¯•ä¿éšœé‡æ„å®‰å…¨</li>
</ul>
<h2 data-id="heading-14">äº”ã€æ€»ç»“</h2>
<ol>
<li><strong>æ¨¡å—åŒ–ç»„ç»‡</strong>ï¼šæŒ‰ä¸šåŠ¡åŠŸèƒ½è€ŒéæŠ€æœ¯å±‚æ¬¡åˆ’åˆ†æ¨¡å—</li>
<li><strong>ç»Ÿä¸€è§„èŒƒ</strong>ï¼šAPIå“åº”ã€å¼‚å¸¸å¤„ç†ã€æ—¥å¿—è®°å½•ç­‰ç»Ÿä¸€è§„èŒƒ</li>
<li><strong>åˆ†å±‚æ˜ç¡®</strong>ï¼šControllerã€Serviceã€DAOå„å¸å…¶èŒ</li>
<li><strong>è§£è€¦è®¾è®¡</strong>ï¼šä½¿ç”¨äº‹ä»¶é©±åŠ¨ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰æ–¹å¼è§£è€¦æ ¸å¿ƒä¸šåŠ¡</li>
<li><strong>é…ç½®ç®¡ç†</strong>ï¼šåˆç†ç»„ç»‡é…ç½®ï¼Œæ•æ„Ÿä¿¡æ¯åˆ†ç¦»</li>
</ol>
<blockquote>
<p>æœ¬æ–‡é¦–å‘äºå…¬ä¼—å·ï¼šç¨‹åºå‘˜å¤§åï¼Œä¸“æ³¨åˆ†äº«å‰åç«¯å¼€å‘çš„å®æˆ˜ç¬”è®°ã€‚å…³æ³¨æˆ‘ï¼Œå°‘èµ°å¼¯è·¯ï¼Œä¸€èµ·è¿›æ­¥ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[èŠèŠçœ‹åƒé—®AIåˆ†ææ»¤é•œåº“Harbeth]]></title>    <link>https://juejin.cn/post/7595901379015917578</link>    <guid>https://juejin.cn/post/7595901379015917578</guid>    <pubDate>2026-01-18T05:51:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595901379015917578" data-draft-id="7595890117867044910" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="èŠèŠçœ‹åƒé—®AIåˆ†ææ»¤é•œåº“Harbeth"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜,Swift,iOS"/> <meta itemprop="datePublished" content="2026-01-18T05:51:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="èŒ¶åº•ä¸–ç•Œä¹‹ä¸‹"/> <meta itemprop="url" content="https://juejin.cn/user/1987535102554472"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            èŠèŠçœ‹åƒé—®AIåˆ†ææ»¤é•œåº“Harbeth
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1987535102554472/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    èŒ¶åº•ä¸–ç•Œä¹‹ä¸‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T05:51:36.000Z" title="Sun Jan 18 2026 05:51:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FyangKJ%2FHarbeth" target="_blank" title="https://github.com/yangKJ/Harbeth" ref="nofollow noopener noreferrer"><strong>Harbeth</strong></a> æ˜¯ä¸€ä¸ªåŸºäºApple Metalæ¡†æ¶çš„é«˜æ€§èƒ½å›¾åƒå¤„ç†å’Œæ»¤é•œå¼€å‘åº“ï¼Œé‡‡ç”¨Swiftè¯­è¨€ç¼–å†™ï¼Œä¸ºiOSå’ŒmacOSå¹³å°æä¾›äº†å¼ºå¤§çš„GPUåŠ é€Ÿå›¾åƒå¤„ç†èƒ½åŠ›ã€‚è¯¥é¡¹ç›®ç”±å¼€å‘è€…<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FyangKJ" target="_blank" title="https://github.com/yangKJ" ref="nofollow noopener noreferrer"><strong>yangKJ</strong></a>åˆ›å»ºï¼Œæ—¨åœ¨æ›¿ä»£å·²ä¸å†æ›´æ–°ç»´æŠ¤çš„GPUImageåº“ï¼ŒåŒæ—¶ç»§æ‰¿äº†å…¶è®¾è®¡ç†å¿µå¹¶è¿›è¡Œäº†å…¨é¢å‡çº§ï¼Œç°å·²æˆä¸ºç§»åŠ¨ç«¯å›¾åƒå¤„ç†é¢†åŸŸçš„çƒ­é—¨å¼€æºé¡¹ç›®ã€‚</p>
<p><strong>ä¸€ã€HarBethçš„æ ¸å¿ƒæ¶æ„ä¸æŠ€æœ¯ç‰¹ç‚¹</strong></p>
<p><strong>1. æ¨¡å—åŒ–è®¾è®¡</strong></p>
<p>HarBethé‡‡ç”¨é«˜åº¦æ¨¡å—åŒ–çš„æ¶æ„è®¾è®¡ï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ ¸å¿ƒæ¨¡å—ï¼š</p>
<p>lÂ <strong>Coreæ¨¡å—</strong>ï¼šè´Ÿè´£é…ç½®Metalä¿¡æ¯ï¼Œä»¥åŠä¸CoreImageçš„å…¼å®¹è½¬æ¢</p>
<p>lÂ <strong>Extensionsæ¨¡å—</strong>ï¼šå¤„ç†å„ç±»èµ„æºä¸MTLTextureä¹‹é—´çš„è½¬æ¢æ–¹æ³•</p>
<p>lÂ <strong>Matrixæ¨¡å—</strong>ï¼šåŒ…å«çŸ©é˜µç›¸å…³æ“ä½œï¼Œæä¾›å¸¸ç”¨çŸ©é˜µå·ç§¯å†…æ ¸å’Œé¢œè‰²çŸ©é˜µ</p>
<p>lÂ <strong>Outputsæ¨¡å—</strong>ï¼šåŒ…å«å¯¹å¤–è½¬æ¢æ¥å£ï¼Œå¦‚BoxxIOå¿«é€Ÿå‘æºæ·»åŠ è¿‡æ»¤å™¨</p>
<p>lÂ <strong>Setupæ¨¡å—</strong>ï¼šåŒ…å«é…ç½®ä¿¡æ¯å’Œå°å·¥å…·</p>
<p><strong>æ»¤é•œæ¨¡å—ç»†åˆ†</strong>ï¼š</p>
<p>HarBethçš„æ»¤é•œéƒ¨åˆ†è¿›ä¸€æ­¥ç»†åˆ†ä¸ºå¤šä¸ªå­æ¨¡å—ï¼Œæ¯ä¸ªå­æ¨¡å—ä¸“æ³¨äºç‰¹å®šç±»å‹çš„å›¾åƒå¤„ç†ï¼š</p>
<p>lÂ Blendï¼šå›¾åƒèåˆæŠ€æœ¯</p>
<p>lÂ Blurï¼šæ¨¡ç³Šæ•ˆæœ</p>
<p>lÂ ColorProcessï¼šå›¾åƒåŸºæœ¬åƒç´ é¢œè‰²å¤„ç†</p>
<p>lÂ Effectï¼šæ•ˆæœå¤„ç†</p>
<p>lÂ Lookupï¼šæŸ¥æ‰¾è¡¨è¿‡æ»¤å™¨</p>
<p>lÂ Matrixï¼šçŸ©é˜µå·ç§¯æ»¤æ³¢å™¨</p>
<p>lÂ Shapeï¼šå›¾åƒå½¢çŠ¶å¤§å°ç›¸å…³å¤„ç†</p>
<p>lÂ VisualEffectï¼šè§†è§‰åŠ¨æ€ç‰¹æ•ˆ</p>
<p><strong>2. ä¸CoreImageçš„å…¼å®¹æ€§</strong></p>
<p>HarBethçš„ä¸€ä¸ªæ˜¾è‘—ç‰¹ç‚¹æ˜¯å…¶ä¸CoreImageçš„æ·±åº¦å…¼å®¹æ€§ã€‚å¼€å‘è€…é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°äº†è¿™ç§å…¼å®¹ï¼š</p>
<p>lÂ <strong>åŒå‘è½¬æ¢</strong>ï¼šæä¾›äº†CIImageä¸MTLTextureä¹‹é—´çš„é«˜æ•ˆè½¬æ¢æ–¹æ³•ï¼Œé€šè¿‡CIContextçš„createCGImageæ–¹æ³•å°†CIImageè½¬æ¢ä¸ºCGImageï¼Œå†åˆ©ç”¨MTLDeviceåˆ›å»ºMTLTexture</p>
<p>lÂ <strong>å…±äº«GPUé˜Ÿåˆ—</strong>ï¼šä¼˜åŒ–äº†MTLCommandQueueçš„ä½¿ç”¨ï¼Œå‡å°‘GPUä»»åŠ¡åˆ‡æ¢å¼€é”€ï¼Œæé«˜å¤„ç†æ•ˆç‡</p>
<p>lÂ <strong>æ»¤é•œé“¾æ•´åˆ</strong>ï¼šæ”¯æŒå°†CoreImageçš„CIFilterç›´æ¥åµŒå…¥HarBethçš„å¤„ç†æµç¨‹ï¼Œå…è®¸å¼€å‘è€…åˆ©ç”¨CoreImageä¸°å¯Œçš„å†…ç½®æ»¤é•œåº“</p>
<p>è¿™ç§å…¼å®¹æ€§è®¾è®¡ä½¿å¾—HarBethä¸ä»…èƒ½å¤Ÿç‹¬ç«‹å·¥ä½œï¼Œè¿˜èƒ½ä¸Appleå®˜æ–¹CoreImageæ¡†æ¶æ— ç¼é›†æˆï¼Œä¸ºå¼€å‘è€…æä¾›äº†æ›´å¤§çš„çµæ´»æ€§å’Œæ›´ä¸°å¯Œçš„åŠŸèƒ½é€‰æ‹©ã€‚</p>
<p><strong>3. é›¶ä¾µå…¥ä»£ç è®¾è®¡</strong></p>
<p>HarBethé‡‡ç”¨"é›¶ä¾µå…¥"ä»£ç è®¾è®¡ç†å¿µï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥åœ¨ä¸ä¿®æ”¹åŸæœ‰ä»£ç ç»“æ„çš„æƒ…å†µä¸‹è½»æ¾æ·»åŠ æ»¤é•œåŠŸèƒ½ã€‚ä¾‹å¦‚ï¼š</p>
<p>è¿™ç§è®¾è®¡æå¤§ç®€åŒ–äº†æ»¤é•œåŠŸèƒ½çš„é›†æˆæµç¨‹ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿå¿«é€Ÿåœ°åœ¨ç°æœ‰é¡¹ç›®ä¸­æ·»åŠ é«˜çº§å›¾åƒå¤„ç†èƒ½åŠ›ã€‚</p>
<p><strong>äºŒã€æ€§èƒ½ä¼˜åŒ–ä¸å®ç°æœºåˆ¶</strong></p>
<p><strong>1. MetalåŠ é€ŸæŠ€æœ¯</strong></p>
<p>HarBethçš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºå…¶å‡ºè‰²çš„GPUåŠ é€Ÿæ€§èƒ½ã€‚ä¸ä¼ ç»Ÿçš„CPUå¤„ç†ç›¸æ¯”ï¼Œå®ƒå……åˆ†åˆ©ç”¨äº†è‹¹æœè®¾å¤‡çš„å›¾å½¢å¤„ç†å™¨ï¼Œé€šè¿‡ä»¥ä¸‹æŠ€æœ¯å®ç°é«˜æ€§èƒ½å›¾åƒå¤„ç†ï¼š</p>
<p>lÂ <strong>MTLTextureå¤„ç†</strong>ï¼šå›¾åƒæ•°æ®é¦–å…ˆè¢«è½¬æ¢ä¸ºMTLTextureæ ¼å¼ï¼Œä»¥ä¾¿åœ¨GPUä¸Šè¿›è¡Œé«˜æ•ˆå¹¶è¡Œå¤„ç†</p>
<p>lÂ <strong>MetalPerformanceShadersé›†æˆ</strong>ï¼šåˆ©ç”¨Appleå®˜æ–¹æä¾›çš„é«˜æ€§èƒ½è®¡ç®—åº“åŠ é€Ÿè®¡ç®—å¯†é›†å‹ä»»åŠ¡ï¼Œå¦‚çŸ©é˜µå·ç§¯</p>
<p>lÂ <strong>å¼‚æ­¥å¤„ç†æœºåˆ¶</strong>ï¼šé€šè¿‡å¼‚æ­¥å›è°ƒæ–¹å¼å¤„ç†å›¾åƒï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹ï¼Œæé«˜åº”ç”¨å“åº”é€Ÿåº¦</p>
<p><strong>2. èµ„æºç®¡ç†ä¸æ€§èƒ½ä¼˜åŒ–</strong></p>
<p>ä¸ºç¡®ä¿é«˜æ•ˆçš„å›¾åƒå¤„ç†æ€§èƒ½ï¼ŒHarBethåœ¨èµ„æºç®¡ç†æ–¹é¢åšäº†å¤šé¡¹ä¼˜åŒ–ï¼š</p>
<p>lÂ <strong>æ™ºèƒ½å†…å­˜ç®¡ç†</strong>ï¼šä¼˜åŒ–MTLTextureçš„åˆ›å»ºå’Œé‡Šæ”¾æµç¨‹ï¼Œå‡å°‘å†…å­˜å ç”¨å’Œåˆ†é…å¼€é”€</p>
<p>lÂ <strong>å…±äº«GPUé˜Ÿåˆ—</strong>ï¼šé€šè¿‡å…±äº«MTLCommandQueueï¼Œä½¿ä»»åŠ¡åœ¨GPUä¸Šæ›´é«˜æ•ˆåœ°æ‰§è¡Œ</p>
<p>lÂ <strong>å¼‚æ­¥å¤„ç†æœ€ä½³å®è·µ</strong>ï¼šé‡‡ç”¨å¼‚æ­¥å¤„ç†æ¨¡å¼ï¼Œé¿å…CPU/GPUåŒæ­¥å¸¦æ¥çš„æ€§èƒ½ç“¶é¢ˆ</p>
<p><strong>3. å®æ—¶å¤„ç†èƒ½åŠ›</strong></p>
<p>HarBethç‰¹åˆ«æ³¨é‡å®æ—¶å›¾åƒå¤„ç†èƒ½åŠ›ï¼Œä¸»è¦ä½“ç°åœ¨ï¼š</p>
<p>lÂ <strong>ç›¸æœºé‡‡é›†ç‰¹æ•ˆ</strong>ï¼šæ”¯æŒå®æ—¶ç›¸æœºæ•è·å¹¶åº”ç”¨æ»¤é•œï¼Œä¸ºç›¸æœºåº”ç”¨æä¾›ä¸“ä¸šçº§å®æ—¶ç¾é¢œå’Œé£æ ¼åŒ–å¤„ç†èƒ½åŠ›</p>
<p>lÂ <strong>è§†é¢‘æ»¤é•œå¤„ç†</strong>ï¼šèƒ½å¤Ÿåœ¨æ’­æ”¾è¿‡ç¨‹ä¸­å®æ—¶åº”ç”¨æ»¤é•œæ•ˆæœï¼Œæ— éœ€ç­‰å¾…è§†é¢‘è§£ç å®Œæˆ</p>
<p>lÂ <strong>é«˜å¸§ç‡ç»´æŒ</strong>ï¼šé€šè¿‡ä¼˜åŒ–çš„Metalä»»åŠ¡è°ƒåº¦å’Œè®¡ç®—ç€è‰²å™¨ï¼Œç¡®ä¿åœ¨å›¾åƒå¤„ç†å¯†é›†åœºæ™¯ä¸‹ç»´æŒç¨³å®šå¸§ç‡</p>
<p><strong>ä¸‰ã€åº”ç”¨åœºæ™¯åˆ†æ</strong></p>
<p><strong>1. ç¤¾äº¤åª’ä½“åº”ç”¨</strong></p>
<p>HarBethåœ¨ç¤¾äº¤åª’ä½“åº”ç”¨ä¸­è¡¨ç°å‡ºè‰²ï¼Œç‰¹åˆ«é€‚åˆä»¥ä¸‹åœºæ™¯ï¼š</p>
<p>lÂ <strong>å®æ—¶ç¾é¢œæ»¤é•œ</strong>ï¼šæ”¯æŒåœ¨è§†é¢‘é€šè¯å’Œç›´æ’­ä¸­åº”ç”¨å®æ—¶ç¾é¢œæ•ˆæœ</p>
<p>lÂ <strong>ç…§ç‰‡ç¼–è¾‘åŠŸèƒ½</strong>ï¼šæä¾›ä¸°å¯Œçš„é¢„è®¾æ»¤é•œå’Œè‡ªå®šä¹‰æ»¤é•œé€‰é¡¹ï¼Œæ»¡è¶³ç”¨æˆ·å¤šæ ·åŒ–ç…§ç‰‡ç¼–è¾‘éœ€æ±‚</p>
<p>lÂ <strong>åŠ¨æ€æ»¤é•œæ•ˆæœ</strong>ï¼šå¦‚"çµé­‚å‡ºçª"ç­‰è§†è§‰åŠ¨æ€ç‰¹æ•ˆï¼Œä¸ºç…§ç‰‡å’Œè§†é¢‘å¢æ·»è‰ºæœ¯æ„Ÿ</p>
<p><strong>2. ä¸“ä¸šå›¾åƒ/è§†é¢‘ç¼–è¾‘</strong></p>
<p>å¯¹äºä¸“ä¸šå›¾åƒå’Œè§†é¢‘ç¼–è¾‘è½¯ä»¶ï¼ŒHarBethæä¾›äº†ä»¥ä¸‹å…³é”®åŠŸèƒ½ï¼š</p>
<p>lÂ <strong>æ‰¹é‡å¤„ç†èƒ½åŠ›</strong>ï¼šæ”¯æŒå¯¹å¤§é‡å›¾åƒå’Œè§†é¢‘è¿›è¡Œé«˜æ•ˆæ‰¹å¤„ç†ï¼Œæ˜¾è‘—æå‡å·¥ä½œæ•ˆç‡</p>
<p>lÂ <strong>è§†é¢‘æ»¤é•œå¯¼å‡º</strong>ï¼šèƒ½å¤Ÿå¯¹å·²æœ‰è§†é¢‘æ·»åŠ æ»¤é•œæ•ˆæœå¹¶å¯¼å‡ºï¼Œæ”¯æŒå¤šç§è§†é¢‘æ ¼å¼</p>
<p>lÂ <strong>é«˜çº§é£æ ¼è½¬æ¢</strong>ï¼šå¦‚çŸ©é˜µå·ç§¯å’Œé¢œè‰²å˜æ¢ç­‰é«˜çº§å›¾åƒå¤„ç†æŠ€æœ¯ï¼Œæ»¡è¶³ä¸“ä¸šå›¾åƒç¼–è¾‘éœ€æ±‚</p>
<p><strong>3. AR/VRåº”ç”¨å¼€å‘</strong></p>
<p>å°½ç®¡ç°æœ‰æ–‡æ¡£æœªæ˜ç¡®æåŠï¼Œä½†HarBethçš„æŠ€æœ¯ç‰¹æ€§ä½¿å…¶éå¸¸é€‚åˆAR/VRåº”ç”¨å¼€å‘ï¼š</p>
<p>lÂ <strong>å®æ—¶å›¾åƒæ¸²æŸ“</strong>ï¼šå¼ºå¤§çš„GPUåŠ é€Ÿèƒ½åŠ›å¯æ”¯æŒARåº”ç”¨ä¸­å®æ—¶å›¾åƒæ¸²æŸ“</p>
<p>lÂ <strong>é«˜ç²¾åº¦è‰²å½©å¤„ç†</strong>ï¼šä¸“ä¸šçš„è‰²å½©çŸ©é˜µå’Œé¢œè‰²å¤„ç†æ¨¡å—ï¼Œé€‚åˆè™šæ‹Ÿç°å®åœºæ™¯ä¸­çš„è§†è§‰æ•ˆæœ</p>
<p>lÂ <strong>ä½å»¶è¿Ÿå¤„ç†</strong>ï¼šä¼˜åŒ–çš„å›¾åƒå¤„ç†æµæ°´çº¿å¯é™ä½å¤„ç†å»¶è¿Ÿï¼Œæå‡ç”¨æˆ·ä½“éªŒ</p>
<p><strong>å››ã€ä¸å…¶ä»–å›¾åƒå¤„ç†åº“çš„å¯¹æ¯”</strong></p>





















































<table><thead><tr><th>ç‰¹æ€§</th><th>HarBeth</th><th>GPUImage</th><th>CoreImage</th></tr></thead><tbody><tr><td>æŠ€æœ¯åŸºç¡€</td><td>Metal + CoreImage</td><td>GLKit + OpenGLES</td><td>CPU/GPUæ··åˆ</td></tr><tr><td>æœ€æ–°æ›´æ–°</td><td>2025-2026å¹´</td><td>2015å¹´å·¦å³</td><td>æŒç»­æ›´æ–°</td></tr><tr><td>å†…ç½®æ»¤é•œæ•°é‡</td><td>è¶…150ç§</td><td>çº¦60ç§</td><td>çº¦100ç§</td></tr><tr><td>å®æ—¶å¤„ç†æ€§èƒ½</td><td>æé«˜</td><td>è¾ƒé«˜</td><td>ä¸­ç­‰</td></tr><tr><td>é›†æˆå¤æ‚åº¦</td><td>ä½ï¼ˆé›¶ä¾µå…¥è®¾è®¡ï¼‰</td><td>ä¸­ç­‰</td><td>ä¸­ç­‰</td></tr><tr><td>å¹³å°æ”¯æŒ</td><td>iOS/macOS</td><td>iOS</td><td>iOS/macOS</td></tr><tr><td>å¼€æºè®¸å¯</td><td>MIT</td><td>MIT</td><td>é—­æº</td></tr></tbody></table>
<p>æ•°æ®æ¥æºï¼š</p>
<p><strong>ä¸GPUImageå¯¹æ¯”</strong>ï¼šHarBethç»§æ‰¿å¹¶æ‰©å±•äº†GPUImageçš„è®¾è®¡ç†å¿µï¼Œä½†é€šè¿‡é‡‡ç”¨Metalæ›¿ä»£è¿‡æ—¶çš„OpenGLESï¼Œæ˜¾è‘—æå‡äº†æ€§èƒ½ã€‚åŒæ—¶ï¼ŒHarBethæä¾›äº†æ›´ç®€æ´çš„APIå’Œæ›´ä¸°å¯Œçš„æ»¤é•œåº“ï¼Œä¸”ä»åœ¨æŒç»­æ›´æ–°ç»´æŠ¤ã€‚</p>
<p><strong>ä¸CoreImageå¯¹æ¯”</strong>ï¼šHarBethåœ¨ä¿æŒCoreImageæ˜“ç”¨æ€§çš„åŒæ—¶ï¼Œé€šè¿‡ç›´æ¥åˆ©ç”¨Metalæ¡†æ¶å®ç°äº†æ›´é«˜çš„æ€§èƒ½ã€‚å¯¹äºç®€å•å›¾åƒå¤„ç†ä»»åŠ¡ï¼ŒCoreImageå¯èƒ½æ›´ä¸ºä¾¿æ·ï¼›è€Œå¯¹äºå¤æ‚ã€è®¡ç®—å¯†é›†å‹çš„å›¾åƒå¤„ç†ï¼ŒHarBethé€šå¸¸èƒ½æä¾›æ›´å¥½çš„æ€§èƒ½è¡¨ç°ã€‚</p>
<p><strong>äº”ã€ä½¿ç”¨å»ºè®®ä¸æœ€ä½³å®è·µ</strong></p>
<p><strong>1. å®‰è£…ä¸é›†æˆ</strong></p>
<p>HarBethå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼é›†æˆåˆ°é¡¹ç›®ä¸­ï¼š</p>
<p>lÂ <strong>CocoaPods</strong>ï¼šç®€å•ä¸€é”®å®‰è£…</p>
<p>lÂ <strong>Swift Package Manager</strong>ï¼šé€‚ç”¨äºSwiftUIé¡¹ç›®</p>
<p><strong>2. åŸºç¡€ä½¿ç”¨ç¤ºä¾‹</strong></p>
<p>HarBethæä¾›äº†å¤šç§ä½¿ç”¨æ–¹å¼ï¼ŒåŒ…æ‹¬ç›´æ¥åº”ç”¨å•ä¸ªæ»¤é•œã€ç»„åˆå¤šä¸ªæ»¤é•œï¼Œä»¥åŠå‡½æ•°å¼ç¼–ç¨‹é£æ ¼ï¼š</p>
<p><strong>3. æ€§èƒ½ä¼˜åŒ–å»ºè®®</strong></p>
<p>ä¸ºå……åˆ†å‘æŒ¥HarBethçš„æ€§èƒ½ä¼˜åŠ¿ï¼Œå»ºè®®é‡‡ç”¨ä»¥ä¸‹æœ€ä½³å®è·µï¼š</p>
<p>lÂ <strong>å¼‚æ­¥å¤„ç†</strong>ï¼šå¯¹äºå¤§å‹å›¾åƒæˆ–è§†é¢‘å¤„ç†ï¼Œä¼˜å…ˆä½¿ç”¨å¼‚æ­¥å¤„ç†æ¨¡å¼</p>
<p>lÂ <strong>å…±äº«ä¸Šä¸‹æ–‡</strong>ï¼šåœ¨åŒä¸€ä¸ªè§†å›¾æ§åˆ¶å™¨ä¸­å¤ç”¨Metalä¸Šä¸‹æ–‡å’ŒCIContextï¼Œå‡å°‘èµ„æºåˆ›å»ºå¼€é”€</p>
<p>lÂ <strong>åˆç†ä½¿ç”¨ç¼“å­˜</strong>ï¼šå¯¹äºé¢‘ç¹åº”ç”¨çš„æ»¤é•œï¼Œè€ƒè™‘ç¼“å­˜å¤„ç†ç»“æœ</p>
<p>lÂ <strong>ç›‘æ§æ€§èƒ½</strong>ï¼šä½¿ç”¨Xcode Instrumentså·¥å…·ç›‘æ§Metalæ€§èƒ½ï¼Œè¯†åˆ«æ½œåœ¨ç“¶é¢ˆ</p>
<p><strong>4. æ»¤é•œè®¾è®¡ä¸æ‰©å±•</strong></p>
<p>HarBethæä¾›äº†çµæ´»çš„æ»¤é•œè®¾è®¡å’Œæ‰©å±•æœºåˆ¶ï¼š</p>
<p>lÂ <strong>è‡ªå®šä¹‰æ»¤é•œ</strong>ï¼šæ”¯æŒåŸºäºMetal Shading Languageç¼–å†™è‡ªå®šä¹‰æ»¤é•œ</p>
<p>lÂ <strong>ç»„åˆæ»¤é•œ</strong>ï¼šé€šè¿‡ç»„åˆç°æœ‰æ»¤é•œåˆ›å»ºæ–°æ•ˆæœï¼Œå‡å°‘ä»£ç é‡å¤</p>
<p>lÂ <strong>å‚æ•°åŒ–è°ƒä¼˜</strong>ï¼šå¤§å¤šæ•°æ»¤é•œæ”¯æŒå‚æ•°è°ƒæ•´ï¼Œå…è®¸åŠ¨æ€æ§åˆ¶æ•ˆæœå¼ºåº¦</p>
<p><strong>å…­ã€ç»“è®ºä¸å±•æœ›</strong></p>
<p>HarBethä½œä¸ºä¸€ä¸ªåŸºäºMetalçš„é«˜æ€§èƒ½å›¾åƒå¤„ç†æ¡†æ¶ï¼Œå‡­å€Ÿå…¶ä¸°å¯Œçš„æ»¤é•œåº“ã€ä¼˜ç§€çš„æ€§èƒ½è¡¨ç°ä»¥åŠä¸CoreImageçš„æ·±åº¦å…¼å®¹æ€§ï¼Œå·²æˆä¸ºiOSå’ŒmacOSå¹³å°å›¾åƒå¤„ç†é¢†åŸŸçš„é‡è¦å·¥å…·ã€‚ç›¸æ¯”å·²åœæ­¢æ›´æ–°çš„GPUImageï¼ŒHarBethä¸ä»…ä¿æŒäº†APIçš„ç®€æ´æ€§ï¼Œè¿˜é€šè¿‡åº•å±‚æŠ€æœ¯çš„å…¨é¢å‡çº§ï¼Œå®ç°äº†æ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚</p>
<p><strong>æœªæ¥å‘å±•è¶‹åŠ¿</strong>ï¼š</p>
<p>1.Â <strong>æŒç»­åŠŸèƒ½æ‰©å±•</strong>ï¼šéšç€å¼€å‘è€…ç¤¾åŒºçš„å‚ä¸ï¼ŒHarBethçš„æ»¤é•œåº“å’ŒåŠŸèƒ½é›†æœ‰æœ›è¿›ä¸€æ­¥ä¸°å¯Œ</p>
<p>2.Â <strong>æ€§èƒ½æŒç»­ä¼˜åŒ–</strong>ï¼šéšç€Metalæ¡†æ¶çš„æ›´æ–°è¿­ä»£ï¼ŒHarBethæœ‰æœ›è¿›ä¸€æ­¥ä¼˜åŒ–å…¶å¤„ç†æ€§èƒ½</p>
<p>3.Â <strong>è·¨å¹³å°æ”¯æŒ</strong>ï¼šè™½ç„¶ç›®å‰ä¸“æ³¨äºAppleå¹³å°ï¼Œä½†æœªæ¥å¯èƒ½è€ƒè™‘è·¨å¹³å°æ”¯æŒä»¥æ‰©å¤§åº”ç”¨èŒƒå›´</p>
<p>4.Â <strong>AIå¢å¼º</strong>ï¼šå¯èƒ½é›†æˆæœºå™¨å­¦ä¹ æŠ€æœ¯ï¼Œæä¾›åŸºäºæ·±åº¦å­¦ä¹ çš„æ™ºèƒ½å›¾åƒå¤„ç†æ•ˆæœ</p>
<p>å¯¹äºéœ€è¦åœ¨Appleå¹³å°å®ç°é«˜æ€§èƒ½å›¾åƒå¤„ç†çš„åº”ç”¨å¼€å‘è€…ï¼ŒHarBethæ˜¯ä¸€ä¸ªå€¼å¾—ä¼˜å…ˆè€ƒè™‘çš„æŠ€æœ¯é€‰æ‹©ï¼Œå®ƒèƒ½å¤Ÿä»¥è¾ƒä½çš„å­¦ä¹ æˆæœ¬å’Œé›†æˆå¤æ‚åº¦ï¼Œä¸ºåº”ç”¨æä¾›å¼ºå¤§çš„è§†è§‰æ•ˆæœå’Œæµç•…çš„ç”¨æˆ·ä½“éªŒã€‚</p>
<p><strong>å‚è€ƒæ¥æº</strong></p>
<p>[1]æ‚¬é•œæºé‰´Â·Gitee æé€Ÿä¸‹è½½/Harbeth-Gitee.com</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fmirrors%2FHarbeth%2Fopen_sca" target="_blank" title="https://gitee.com/mirrors/Harbeth/open_sca" ref="nofollow noopener noreferrer">gitee.com/mirrors/Harâ€¦</a></p>
<p>[2]è¿›é˜¶ï¼å±•ç°æœ€ä¼˜çš„æŠ€æœ¯å’Œæœ€å¥½çš„å£°éŸ³ï¼šå¬è¯„è‹±å›½Harbethï¼ˆé›¨ååˆæ™´ï¼‰M40.3 XD éŸ³ç®±_ç›‘å¬_å•å…ƒ_äº§å“</p>
<p><a href="https://link.juejin.cn?target=http%3A%2F%2Fwww.sohu.com%2Fa%2F764150569_121631906" target="_blank" title="http://www.sohu.com/a/764150569_121631906" ref="nofollow noopener noreferrer">www.sohu.com/a/764150569â€¦</a></p>
<p>[3]å“ˆå‹ƒåˆ†æç³»ç»Ÿ_ç™¾åº¦ç™¾ç§‘</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fbaike.baidu.com%2Fitem%2F%25E5%2593%2588%25E5%258B%2583%25E5%2588%2586%25E6%259E%2590%25E7%25B3%25BB%25E7%25BB%259F%2F15421763" target="_blank" title="https://baike.baidu.com/item/%E5%93%88%E5%8B%83%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F/15421763" ref="nofollow noopener noreferrer">baike.baidu.com/item/%E5%93â€¦</a></p>
<p>[4]æ¢ç§˜Harbethï¼šå¦‚ä½•ç”¨MetalæŠ€æœ¯æ‰“é€ ç»ˆæå›¾åƒå¤„ç†æ¡†æ¶-CSDNåšå®¢</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fgitblog_00063%2Farticle%2Fdetails%2F138209191" target="_blank" title="https://blog.csdn.net/gitblog_00063/article/details/138209191" ref="nofollow noopener noreferrer">blog.csdn.net/gitblog_000â€¦</a></p>
<p>[5]æ¢ç´¢æ·±åº¦å­¦ä¹ çš„é€Ÿåº¦æé™ï¼šHasteå¼€æºåº“è§£æä¸åº”ç”¨-CSDNåšå®¢</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fgitblog_00080%2Farticle%2Fdetails%2F142116640" target="_blank" title="https://blog.csdn.net/gitblog_00080/article/details/142116640" ref="nofollow noopener noreferrer">blog.csdn.net/gitblog_000â€¦</a></p>
<p>[6]å°å­¦ç”Ÿ/Harbeth</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fhuansghijie%2FHarbeth" target="_blank" title="https://gitee.com/huansghijie/Harbeth" ref="nofollow noopener noreferrer">gitee.com/huansghijieâ€¦</a></p>
<p>[7]çªç ´ä¼ ç»Ÿï¼Œå…¨æ–°æ—¶ä»£â€”HarbethNLE-1ä¹¦æ¶å¼æœ‰æºéŸ³ç®±-å“”å“©å“”å“©</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fopus%2F1070422660430692372" target="_blank" title="https://www.bilibili.com/opus/1070422660430692372" ref="nofollow noopener noreferrer">www.bilibili.com/opus/107042â€¦</a></p>
<p>[8]æ·±å…¥è®²è§£ä¸€ä¸‹ Harbor çš„æºç _harboræºç -CSDNåšå®¢</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fu011091936%2Farticle%2Fdetails%2F150115474" target="_blank" title="https://blog.csdn.net/u011091936/article/details/150115474" ref="nofollow noopener noreferrer">blog.csdn.net/u011091936/â€¦</a></p>
<p>[9]Harbethé¦–é¡µã€æ–‡æ¡£å’Œä¸‹è½½-å›¾å½¢å¤„ç†å’Œæ»¤é•œåˆ¶ä½œ-OSCHINA-ä¸­æ–‡å¼€æºæŠ€æœ¯äº¤æµç¤¾åŒº</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.oschina.net%2Fp%2Fharbeth" target="_blank" title="https://www.oschina.net/p/harbeth" ref="nofollow noopener noreferrer">www.oschina.net/p/harbeth</a></p>
<p>[10]æ¢ç§˜Harbethï¼šå¦‚ä½•ç”¨MetalæŠ€æœ¯æ‰“é€ ç»ˆæå›¾åƒå¤„ç†æ¡†æ¶-CSDNåšå®¢</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fgitblog_00063%2Farticle%2Fdetails%2F138209191" target="_blank" title="https://blog.csdn.net/gitblog_00063/article/details/138209191" ref="nofollow noopener noreferrer">blog.csdn.net/gitblog_000â€¦</a></p>
<p>[11]Metalï¼ˆæŠ€æœ¯ï¼‰ç™¾åº¦ç™¾ç§‘</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fbaike.baidu.com%2Fitem%2FMETAL%2F0" target="_blank" title="https://baike.baidu.com/item/METAL/0" ref="nofollow noopener noreferrer">baike.baidu.com/item/METAL/â€¦</a></p>
<p>[12]iOS åˆ©ç”¨ Metal å®ç°æ»¤é•œä¸åŠ¨æ•ˆæ»¤é•œ_ios metal ç¾é¢œ-CSDNåšå®¢</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fqq_34534179%2Farticle%2Fdetails%2F123335596" target="_blank" title="https://blog.csdn.net/qq_34534179/article/details/123335596" ref="nofollow noopener noreferrer">blog.csdn.net/qq_34534179â€¦</a></p>
<p>[13]Metal-å¿«æ‡‚ç™¾ç§‘</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.baike.com%2Fwiki%2FMetal%2F19512096" target="_blank" title="https://www.baike.com/wiki/Metal/19512096" ref="nofollow noopener noreferrer">www.baike.com/wiki/Metal/â€¦</a></p>
<p>[14]MetalFilters å¼€æºé¡¹ç›®æ•™ç¨‹-CSDNåšå®¢</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fgitblog_00728%2Farticle%2Fdetails%2F141989029" target="_blank" title="https://blog.csdn.net/gitblog_00728/article/details/141989029" ref="nofollow noopener noreferrer">blog.csdn.net/gitblog_007â€¦</a></p>
<p>[15]é«˜æ€§èƒ½æ–‡æœ¬æ¸²æŸ“ï¼šHarfBuzzä¸GPUåŠ é€ŸæŠ€æœ¯ç»“åˆæ–¹æ¡ˆ-CSDNåšå®¢</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fgitblog_01069%2Farticle%2Fdetails%2F152253949" target="_blank" title="https://blog.csdn.net/gitblog_01069/article/details/152253949" ref="nofollow noopener noreferrer">blog.csdn.net/gitblog_010â€¦</a></p>
<p>[16]æ¨èæ–‡ç« ï¼šæ¢ç´¢é«˜æ•ˆå›¾åƒè§†é¢‘å¤„ç†â€”MetalImageæ¡†æ¶-CSDNåšå®¢</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fgitblog_00923%2Farticle%2Fdetails%2F141665302" target="_blank" title="https://blog.csdn.net/gitblog_00923/article/details/141665302" ref="nofollow noopener noreferrer">blog.csdn.net/gitblog_009â€¦</a></p>
<p>[17]MetalåŠ©åŠ›ä¸“ä¸š App-WWDC19-è§†é¢‘-Apple Developer</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fcn%2Fvideos%2Fplay%2Fwwdc2019%2F608%2F" target="_blank" title="https://developer.apple.com/cn/videos/play/wwdc2019/608/" ref="nofollow noopener noreferrer">developer.apple.com/cn/videos/pâ€¦</a></p>
<p>[18]CIImage.FromMetalTexture(IMTLTexture,NSDictionaryNSObject&gt;Method(CoreImage)Microsoft Learn</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Flearn.microsoft.com%2Fzh-CN%2Fdotnet%2Fapi%2Fcoreimage.ciimage.frommetaltexture%3Fview%3Dxamarin-ios-sdk-12" target="_blank" title="https://learn.microsoft.com/zh-CN/dotnet/api/coreimage.ciimage.frommetaltexture?view=xamarin-ios-sdk-12" ref="nofollow noopener noreferrer">learn.microsoft.com/zh-CN/dotneâ€¦</a></p>
<p>[19]Active Learning Based on Locally Linear Reconstruction</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fai.nju.edu.cn%2Fzlj%2Fpdf%2FTPAMI-2011-Zhang.pdf" target="_blank" title="https://ai.nju.edu.cn/zlj/pdf/TPAMI-2011-Zhang.pdf" ref="nofollow noopener noreferrer">ai.nju.edu.cn/zlj/pdf/TPAâ€¦</a></p>
<p>[20]æ¢ç§˜Harbethï¼šå¦‚ä½•ç”¨MetalæŠ€æœ¯æ‰“é€ ç»ˆæå›¾åƒå¤„ç†æ¡†æ¶-CSDNåšå®¢</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fgitblog_00063%2Farticle%2Fdetails%2F138209191" target="_blank" title="https://blog.csdn.net/gitblog_00063/article/details/138209191" ref="nofollow noopener noreferrer">blog.csdn.net/gitblog_000â€¦</a></p>
<p>[21]MTLTexture_Extensions.GetBufferBytesPerRow(IMTLTexture)æ–¹æ³•(Metal)Microsoft Learn</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Flearn.microsoft.com%2Fzh-cn%2Fdotnet%2Fapi%2Fmetal.mtltexture_extensions.getbufferbytesperrow%3Fview%3Dxamarin-mac-sdk-14" target="_blank" title="https://learn.microsoft.com/zh-cn/dotnet/api/metal.mtltexture_extensions.getbufferbytesperrow?view=xamarin-mac-sdk-14" ref="nofollow noopener noreferrer">learn.microsoft.com/zh-cn/dotneâ€¦</a></p>
<p>[22]iOS å®æ—¶å›¾åƒå¤„ç†æŠ€æœ¯ï¼šä½¿ç”¨Core Imageå’ŒMetalè¿›è¡Œé«˜æ•ˆæ»¤é•œåº”ç”¨-é˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒº</p>
<p><a href="https://link.juejin.cn?target=http%3A%2F%2Fdeveloper.aliyun.com%2Farticle%2F1477337" target="_blank" title="http://developer.aliyun.com/article/1477337" ref="nofollow noopener noreferrer">developer.aliyun.com/article/147â€¦</a></p>
<p>[23]æ•™ä½ å¦‚ä½•ç©è½¬Metalæ»¤é•œï¼ŸHarbethæ˜¯ä¸€æ¬¾åŸºäºMetal APIè®¾è®¡çš„æ»¤é•œæ¡†æ¶ï¼Œä¸»è¦ä»‹ç»ä¸è®¾è®¡åŸºäºGPUçš„æ»¤é•œï¼Œæ˜é‡‘</p>
<p><a href="http://juejin.im/entry/7066964198596542471" target="_blank" title="http://juejin.im/entry/7066964198596542471">juejin.im/entry/70669â€¦</a></p>
<p>[24]æ·±å…¥æŒæ¡CoreImageæ»¤é•œçš„ä½¿ç”¨ä¸å®æˆ˜-CSDNåšå®¢</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fweixin_33431149%2Farticle%2Fdetails%2F150370959" target="_blank" title="https://blog.csdn.net/weixin_33431149/article/details/150370959" ref="nofollow noopener noreferrer">blog.csdn.net/weixin_3343â€¦</a></p>
<p>[25]æ¢ç´¢Core Imageå†…æ ¸æ”¹è¿›-WWDC21-è§†é¢‘-Apple Developer</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fcn%2Fvideos%2Fplay%2Fwwdc2021%2F10159%2F%3Ftime%3D5" target="_blank" title="https://developer.apple.com/cn/videos/play/wwdc2021/10159/?time=5" ref="nofollow noopener noreferrer">developer.apple.com/cn/videos/pâ€¦</a></p>
<p>[26]CIImage.MetalTexture Property(CoreImage)Microsoft Learn</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Flearn.microsoft.com%2Fzh-cn%2Fdotnet%2Fapi%2Fcoreimage.ciimage.metaltexture%3Fview%3Dnet-macos-26.2-10.0" target="_blank" title="https://learn.microsoft.com/zh-cn/dotnet/api/coreimage.ciimage.metaltexture?view=net-macos-26.2-10.0" ref="nofollow noopener noreferrer">learn.microsoft.com/zh-cn/dotneâ€¦</a></p>
<p>[27]ã€å‡½æ•°å¼ Swiftã€‘å°è£…Core Image-CSDNåšå®¢</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fweixin_33805743%2Farticle%2Fdetails%2F88003281" target="_blank" title="https://blog.csdn.net/weixin_33805743/article/details/88003281" ref="nofollow noopener noreferrer">blog.csdn.net/weixin_3380â€¦</a></p>
<p>[28]MMBAT: A MULTI-TASK FRAMEWORK FOR MMWAVEREEDUCATION AND TRANSLATIONS</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2312.10346" target="_blank" title="https://arxiv.org/abs/2312.10346" ref="nofollow noopener noreferrer">arxiv.org/abs/2312.10â€¦</a></p>
<p>[29]æ¢ç§˜Harbethï¼šå¦‚ä½•ç”¨MetalæŠ€æœ¯æ‰“é€ ç»ˆæå›¾åƒå¤„ç†æ¡†æ¶-CSDNåšå®¢</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fgitblog_00063%2Farticle%2Fdetails%2F138209191" target="_blank" title="https://blog.csdn.net/gitblog_00063/article/details/138209191" ref="nofollow noopener noreferrer">blog.csdn.net/gitblog_000â€¦</a></p>
<p>[30]Decoding the Underlying Meaning of Multmodal Hateful MEMes</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2305.17678" target="_blank" title="https://arxiv.org/abs/2305.17678" ref="nofollow noopener noreferrer">arxiv.org/abs/2305.17â€¦</a></p>
<p>[31]Harbethé¦–é¡µã€æ–‡æ¡£å’Œä¸‹è½½-å›¾å½¢å¤„ç†å’Œæ»¤é•œåˆ¶ä½œ-OSCHINA-ä¸­æ–‡å¼€æºæŠ€æœ¯äº¤æµç¤¾åŒº</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.oschina.net%2Fp%2Fharbeth" target="_blank" title="https://www.oschina.net/p/harbeth" ref="nofollow noopener noreferrer">www.oschina.net/p/harbeth</a></p>
<p>[32]Single color virtual H&amp;E staining with In-and-Out Net</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2405.13278" target="_blank" title="https://arxiv.org/abs/2405.13278" ref="nofollow noopener noreferrer">arxiv.org/abs/2405.13â€¦</a></p>
<p>[33]æ‚¬é•œæºé‰´Â·Gitee æé€Ÿä¸‹è½½/Harbeth-Gitee.com</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fmirrors%2FHarbeth%2Fopen_sca" target="_blank" title="https://gitee.com/mirrors/Harbeth/open_sca" ref="nofollow noopener noreferrer">gitee.com/mirrors/Harâ€¦</a></p>
<p>(AIç”Ÿæˆ)</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ†äº«é‡‘èä¸šåŠ¡ä¸­è§„åˆ™è·¯ç”±çš„è®¾è®¡]]></title>    <link>https://juejin.cn/post/7595974133097594914</link>    <guid>https://juejin.cn/post/7595974133097594914</guid>    <pubDate>2026-01-18T04:17:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595974133097594914" data-draft-id="7587024296883896370" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ†äº«é‡‘èä¸šåŠ¡ä¸­è§„åˆ™è·¯ç”±çš„è®¾è®¡"/> <meta itemprop="keywords" content="åç«¯,æ¶æ„,å¼€æº"/> <meta itemprop="datePublished" content="2026-01-18T04:17:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æš®è‰²å¦–å¨†ä¸¶"/> <meta itemprop="url" content="https://juejin.cn/user/4292946760307655"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ†äº«é‡‘èä¸šåŠ¡ä¸­è§„åˆ™è·¯ç”±çš„è®¾è®¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4292946760307655/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æš®è‰²å¦–å¨†ä¸¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T04:17:25.000Z" title="Sun Jan 18 2026 04:17:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>â€è·¯ç”±â€œ è¿™ä¸ªè¯åœ¨æˆ‘ä»¬å·¥ä½œæŠ€æœ¯æ ˆä¸­æ¶‰åŠé¢†åŸŸå¹¿æ³›ã€‚ä¾‹å¦‚ <code>SpringCloud GateWay ã€Nginxã€SpringMvc</code>ï¼Œè¿™äº›éƒ½å¯ä»¥é’ˆå¯¹ä¸€ä¸ª <code>Http</code> è¯·æ±‚ï¼Œæ ¹æ®ä¸åŒè§„åˆ™ï¼ŒæŠŠè¯·æ±‚è·¯ç”±/è½¬å‘åˆ°ä¸åŒçš„ç›®çš„åœ°ã€‚åˆæˆ–è€…åƒ <code>RabbitMQ</code> ç­‰æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè·¯ç”±ä¸åŒçš„æ¶ˆæ¯åˆ°ä¸åŒçš„ç›®çš„é˜Ÿåˆ—ã€‚åŸºäºè¿™ä¸ªæ€è·¯ï¼Œæˆ‘ä»¬å°è´·é¡¹ç›®æ”¾æ¬¾å¯ç”¨èµ„é‡‘æ–¹çš„ç­›é€‰ä¹Ÿå¯ä»¥ä½¿ç”¨è·¯ç”±çš„æ€è·¯æ¥å®ç°ã€‚</p>
<h2 data-id="heading-1">Github æºç </h2>
<p>æºç å·²åˆ†äº«åˆ° Githubã€‚ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fyanzhisishui%2Fli-choicerule.git" target="_blank" title="https://github.com/yanzhisishui/li-choicerule.git" ref="nofollow noopener noreferrer">li-choicerule</a></p>
<h2 data-id="heading-2">ä¸šåŠ¡åœºæ™¯</h2>
<p>åœ¨æˆ‘ä»¬é‡‘èä¸šåŠ¡ä¸­æ”¾æ¬¾èµ„é‡‘ç®€ç•¥åœºæ™¯å¦‚ä¸‹</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e15e9dce2bc24e7e8d6fa63a45405c80~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769316817&amp;x-signature=nNXEAFu61TeHcjcjWRG6NLLiti8%3D" alt="image.png" loading="lazy"/></p>
<p>ç”±äºæ”¾æ¬¾æ–¹æ˜¯åˆä½œçš„ä¸€æ‰¹èµ„æ–¹ï¼Œæ¯ä¸ªèµ„æ–¹å¯¹ç”¨æˆ·æ˜¯å¦èƒ½å¤Ÿç¬¦åˆæ”¾æ¬¾æ¡ä»¶æœ‰ç€ä¸€ç³»åˆ—è§„åˆ™ï¼Œæ¯”å¦‚æŸä¸ªèµ„é‡‘æ–¹è¦æ±‚ï¼š</p>
<ul>
<li>ç”¨æˆ·èº«ä»½è¯æˆ·ç±åœ°å€ä¸èƒ½æ˜¯åè¿œåœ°åŒºçš„</li>
<li>æ‰‹æœºå·å‰ç¼€ä¸èƒ½æ˜¯ xx å¼€å¤´çš„</li>
<li>èº«ä»½è¯æœ‰æ•ˆæœŸä¸èƒ½æ˜¯ 3 ä¸ªæœˆå†…åˆ°æœŸçš„</li>
<li>å®¶åº­ä½å€ä¸èƒ½æ˜¯æ¸¯æ¾³å°çš„</li>
<li>ç­‰ç­‰å…¶ä»–æ¡ä»¶</li>
</ul>
<p>åšè¿‡å°è´·çš„éƒ½çŸ¥é“ï¼Œèµ„é‡‘æ–¹æ”¾æ¬¾æ˜¯ä¸€ä¸ªè€—æ—¶çš„æ“ä½œï¼Œæˆ‘ä»¬æŠŠå‡ºæ¬¾è¯·æ±‚å‘é€è¿‡å»ï¼Œè‡³äºä»€ä¹ˆæ—¶å€™æ”¾æ¬¾æ˜¯èµ„é‡‘æ–¹å†³å®šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šå¸¸æ˜¯å…ˆè·å–åˆ°æ‰€æœ‰èµ„é‡‘æ–¹ä¸­ï¼Œç¬¦åˆè¯¥ç”¨æˆ·æ”¾æ¬¾æ¡ä»¶çš„èµ„é‡‘æ–¹é›†åˆï¼Œç„¶åéå†è¿™ä¸ªé›†åˆå»æ”¾æ¬¾ï¼Œç›´åˆ°ä»»æ„ä¸€ä¸ªæ”¾æ¬¾æˆåŠŸã€‚</p>
<p>é‚£ä¹ˆå‡å¦‚æˆ‘ä»¬æœ‰ 100 ä¸ªåˆä½œçš„èµ„é‡‘æ–¹ï¼Œæ€ä¹ˆè·å–åˆ°è¿™ä¸ªç”¨æˆ·ç¬¦åˆå“ªäº›èµ„é‡‘æ–¹æ¡ä»¶å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯å”¯ä¸€çš„æ–¹æ³•ï¼Œé‚£å°±æ˜¯æŠŠæ¯ä¸ªèµ„é‡‘æ–¹çš„è§„åˆ™éƒ½æ‹¿å‡ºæ¥æ ¡éªŒä¸€éï¼Œåªè¦ä¸€ä¸ªèµ„é‡‘æ–¹ä»»æ„ä¸€ä¸ªè§„åˆ™ç”¨æˆ·ä¸æ»¡è¶³ï¼Œè¿™ä¸ªèµ„é‡‘æ–¹å°±è¦è¢«å‰”é™¤ã€‚</p>
<blockquote>
<p>å…¶å®ä¿¡è´·é¡¹ç›®ä¸­å¾ˆå¤šä¸šåŠ¡éƒ½å¯ä»¥ç”¨è§„åˆ™è·¯ç”±æ¥å®ç°ï¼ŒåŒ…æ‹¬èµ„é‡‘æ–¹è·¯ç”±ã€æ‰£æ¬¾å•†æˆ·å·è·¯ç”±ã€ç­¾çº¦å•†æˆ·å·è·¯ç”±ç­‰ç­‰</p>
</blockquote>
<h2 data-id="heading-3">è§„åˆ™è·¯ç”±çš„ç®€ä»‹</h2>
<p>è¿™ä¸ªåœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å‚è€ƒè·¯ç”±çš„æ¦‚å¿µï¼Œè®¾è®¡ä¸€ä¸ªè§„åˆ™è·¯ç”±ã€‚æŠŠæ¯ä¸ªèµ„é‡‘æ–¹ä½œä¸ºä¸€æ¡å¤§çš„è§„åˆ™é“¾è·¯ï¼Œè¿™ä¸ªå¤§è§„åˆ™é“¾è·¯é‡Œé¢æœ‰ N ä¸ªå°çš„å­è§„åˆ™ï¼Œç„¶åä¾ç…§ä¸€å®šçš„é¡ºåºæ¥æ’åºè¿™äº›å­è§„åˆ™ã€‚æ¯ä¸€æ¡å¤§çš„è§„åˆ™é“¾è·¯ä¼šè·å–ä¸€ä¸ªç»“æœ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a3ebda81cc4849c5b8cb0ed9d39fe427~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769316817&amp;x-signature=nQvWTXZK%2Fgf9XmehoIFLYCQYXY8%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚æœä¸€æ¡å¤§çš„é“¾è·¯ä¸­æ‰€æœ‰éå¶å­ç»“ç‚¹çš„å­è§„åˆ™éƒ½é€šè¿‡äº†æ ¡éªŒï¼Œé‚£å°±è¿”å›å¶å­ç»“ç‚¹çš„ç»“æœï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªå›ºå®šå€¼ã€‚</p>
<p>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥é€‰æ‹©è®©å…¶åœ¨ä»»æ„ä¸€ä¸ªå¶å­èŠ‚ç‚¹åœæ­¢è·¯ç”±åˆ—è¡¨çš„ç»§ç»­æ‰§è¡Œï¼Œå› ä¸ºæœ‰äº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬åŒ¹é…åˆ°ä»»æ„ä¸€ä¸ªç»“æœæ—¶ï¼Œå°±ä¸éœ€è¦å†å¾€ä¸‹æ‰§è¡Œå‰©ä½™è§„åˆ™äº†ã€‚æ¯”å¦‚æ‰£æ¬¾å•†æˆ·å·çš„è§„åˆ™è·¯ç”±ï¼Œå› ä¸ºæˆ‘ä»¬ä¸€ç¬”æ‰£æ¬¾ä¸å¯èƒ½é€‰æ‹©å¤šä¸ªå•†æˆ·å·ï¼Œæ ¹æ®è·¯ç”±è¯·æ±‚ï¼Œä¸€ç›´åŒ¹é…åˆ°ç¬¦åˆæ¡ä»¶çš„æ‰£æ¬¾å•†æˆ·å·å°±è¿”å›ç»“æœã€‚</p>
<h2 data-id="heading-4">ä¸²è¡Œä¸å¹¶è¡Œçš„è€ƒé‡</h2>
<p>æ€æ ·é«˜æ•ˆçš„æ‰§è¡Œå®Œä¸€ä¸ªç”¨æˆ·å¯è·¯ç”±åˆ°çš„æ‰€æœ‰èµ„é‡‘æ–¹åˆ—è¡¨çš„è§„åˆ™è·¯ç”±å‘¢ï¼Œæœ‰ä¸¤ç§æ–¹å¼ã€‚ä¸€ç§å°±æ˜¯å•çº¿ç¨‹ä»ç¬¬ä¸€ä¸ªèµ„é‡‘æ–¹å¼€å§‹ï¼Œä¸€ç›´éå†åˆ°æœ€åä¸€ä¸ªã€‚å¦ä¸€ç§å°±æ˜¯å¼€å¯å¤šçº¿ç¨‹ï¼Œæ‰€æœ‰èµ„é‡‘æ–¹å¹¶è¡Œæ‰§è¡Œè§„åˆ™ã€‚ä¸¤ç§è§„åˆ™éƒ½å„æœ‰ä¼˜ç¼ºç‚¹</p>
<h3 data-id="heading-5">ä¸²è¡Œæ–¹å¼</h3>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ol>
<li><strong>å®ç°ç®€å•</strong>ï¼šé€»è¾‘ç›´è§‚ï¼Œæ˜“äºç†è§£å’Œè°ƒè¯•</li>
<li><strong>èµ„æºæ¶ˆè€—ä½</strong>ï¼šæ²¡æœ‰çº¿ç¨‹å¼€é”€ï¼Œå†…å­˜å ç”¨å°‘</li>
<li><strong>æ‰§è¡Œé¡ºåºå¯æ§</strong>ï¼šä¸¥æ ¼æŒ‰ç…§è§„åˆ™åˆ—è¡¨é¡ºåºæ‰§è¡Œ</li>
<li><strong>é¿å…èµ„æºç«äº‰</strong>ï¼šæ²¡æœ‰å¹¶å‘é—®é¢˜ï¼Œä¸éœ€è¦é¢å¤–åŒæ­¥æœºåˆ¶</li>
<li><strong>è°ƒè¯•æ–¹ä¾¿</strong>ï¼šå¯ä»¥è½»æ¾è·Ÿè¸ªæ‰§è¡Œè·¯å¾„</li>
<li><strong>å¯é¢„æµ‹æ€§</strong>ï¼šæ‰§è¡Œæ—¶é—´å’Œç»“æœå¯é¢„æµ‹</li>
</ol>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ol>
<li><strong>æ€§èƒ½å¯èƒ½è¾ƒå·®</strong>ï¼šå¦‚æœå‰é¢è§„åˆ™è€—æ—¶å¾ˆé•¿ï¼Œä½†æ²¡æœ‰æ‹¿åˆ°ç»“æœï¼Œå³ä½¿åé¢çš„è§„åˆ™å¯ä»¥å¿«é€Ÿè¿”å›ç»“æœï¼Œä¹Ÿè¦ç­‰å¾…</li>
<li><strong>å“åº”æ—¶é—´è¾ƒé•¿</strong>ï¼šä¸€ä¸ªçº¿ç¨‹éå†å¤„ç†æ‰€æœ‰è§„åˆ™</li>
<li><strong>é˜»å¡å¼æ‰§è¡Œ</strong>ï¼šéå”¯ä¸€ç»“æœåœºæ™¯ä¸‹ï¼Œä¸€ä¸ªæ…¢è§„åˆ™ä¼šé˜»å¡æ•´ä¸ªæµç¨‹</li>
</ol>
<h3 data-id="heading-6">å¹¶è¡Œæ–¹å¼</h3>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ol>
<li><strong>å“åº”é€Ÿåº¦å¿«</strong>ï¼šå¤šçº¿ç¨‹å¹¶è¡Œæ‰§è¡Œï¼Œå¯¹äºæŸç”¨æˆ·æ¥è¯´ï¼Œæ‰§è¡Œè¯¥ç”¨æˆ·çš„ç¡¬ä»¶èµ„æºæ›´å¤š</li>
<li><strong>æé«˜ååé‡</strong>ï¼šå¤šä¸ªè§„åˆ™å¯ä»¥åŒæ—¶æ‰§è¡Œ</li>
<li><strong>æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ</strong>ï¼šå‡å°‘ç­‰å¾…æ—¶é—´</li>
</ol>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ol>
<li><strong>å®ç°å¤æ‚</strong>ï¼šéœ€è¦å¤„ç†å¹¶å‘ã€çº¿ç¨‹æ± ã€å¼‚å¸¸ç­‰</li>
<li><strong>èµ„æºæ¶ˆè€—å¤§</strong>ï¼šæ¯ä¸ªè§„åˆ™éƒ½éœ€è¦çº¿ç¨‹èµ„æºï¼Œç”¨æˆ·é‡ä¸€å¤§ï¼Œçº¿ç¨‹æ± èµ„æºç´§å¼ </li>
<li><strong>è°ƒè¯•å›°éš¾</strong>ï¼šå¹¶å‘é—®é¢˜éš¾ä»¥å¤ç°å’Œè°ƒè¯•</li>
<li><strong>å¯èƒ½é€ æˆèµ„æºæµªè´¹</strong>ï¼šæœªå®Œæˆçš„è§„åˆ™ä¹Ÿä¼šå ç”¨èµ„æºç›´åˆ°è¢«å–æ¶ˆï¼ˆå°¤å…¶å¯¹äºåªéœ€è¦ä¸€æ¡è§„åˆ™ç»“æœçš„ä¸šåŠ¡ï¼‰</li>
<li><strong>çº¿ç¨‹å®‰å…¨é—®é¢˜</strong>ï¼šè§„åˆ™æ‰§è¡Œå¯èƒ½æœ‰å…±äº«çŠ¶æ€ï¼Œéœ€è¦è€ƒè™‘åŒæ­¥</li>
<li><strong>è¶…æ—¶æ§åˆ¶å¤æ‚</strong>ï¼šéœ€è¦åˆç†è®¾ç½®è¶…æ—¶æ—¶é—´</li>
<li><strong>ä¸ç¡®å®šæ€§</strong>ï¼šç»“æœå¯èƒ½å› æ‰§è¡Œé¡ºåºä¸åŒè€Œå˜åŒ–</li>
</ol>
<p>ä»¥ä¸‹æ˜¯å¯¹æ¯”è¡¨æ ¼ï¼š</p>

































































<table><thead><tr><th align="center">å¯¹æ¯”ç»´åº¦</th><th align="center">ä¸²è¡Œæ–¹å¼</th><th align="center">å¹¶è¡Œæ–¹å¼</th></tr></thead><tbody><tr><td align="center">å®ç°å¤æ‚åº¦</td><td align="center">ç®€å•</td><td align="center">å¤æ‚</td></tr><tr><td align="center">æ€§èƒ½</td><td align="center">å¯èƒ½è¾ƒæ…¢ï¼ˆé¡ºåºç­‰å¾…ï¼‰</td><td align="center">é€šå¸¸æ›´å¿«ï¼ˆå¹¶è¡Œå¤„ç†ï¼‰</td></tr><tr><td align="center">èµ„æºå ç”¨</td><td align="center">ä½ï¼ˆå•çº¿ç¨‹ï¼‰</td><td align="center">é«˜ï¼ˆå¤šçº¿ç¨‹+çº¿ç¨‹æ± ï¼‰</td></tr><tr><td align="center">å“åº”æ—¶é—´</td><td align="center">O(âˆ‘æ‰€æœ‰è§„åˆ™æ—¶é—´)</td><td align="center">O(æœ€å¿«è§„åˆ™æ—¶é—´)</td></tr><tr><td align="center">å¯è°ƒè¯•æ€§</td><td align="center">ä¼˜ç§€</td><td align="center">å›°éš¾</td></tr><tr><td align="center">å¯é¢„æµ‹æ€§</td><td align="center">é«˜</td><td align="center">ä½ï¼ˆå—ç³»ç»Ÿè´Ÿè½½å½±å“ï¼‰</td></tr><tr><td align="center">é”™è¯¯å¤„ç†</td><td align="center">ç®€å•ç›´æ¥</td><td align="center">éœ€è¦é¢å¤–æœºåˆ¶</td></tr><tr><td align="center">è¶…æ—¶æ§åˆ¶</td><td align="center">å®¹æ˜“</td><td align="center">å¤æ‚</td></tr><tr><td align="center">CPUåˆ©ç”¨ç‡</td><td align="center">ä½</td><td align="center">é«˜</td></tr><tr><td align="center">å†…å­˜æ¶ˆè€—</td><td align="center">å°</td><td align="center">è¾ƒå¤§</td></tr><tr><td align="center">é€‚ç”¨åœºæ™¯</td><td align="center">è§„åˆ™å°‘ã€æ‰§è¡Œå¿«ã€é€»è¾‘ç®€å•</td><td align="center">è§„åˆ™å¤šã€æ‰§è¡Œæ…¢ã€è¿½æ±‚å“åº”é€Ÿåº¦</td></tr></tbody></table>
<p>å…¶å®å¯¹äºå¹¶è¡Œçš„æ–¹å¼æ¥è¯´ï¼Œæ˜¯å¦æœ‰ä¸Šè¿°é‚£äº›ä¼˜ç‚¹æ˜¯éœ€è¦å®é™…å‹æµ‹çš„ï¼Œå› ä¸ºä¸€ä½†ç”¨æˆ·é‡å¤§èµ·æ¥ï¼Œå‡è®¾æœ‰ 100 ä¸ªèµ„é‡‘æ–¹ï¼Œä¸€ä¸ªç”¨æˆ·å°±éœ€è¦ 100ä¸ªçº¿ç¨‹å»å¹¶è¡Œå¤„ç†ï¼Œå¦‚æœåŒæ—¶æœ‰ 100w ç”¨æˆ·ï¼Œå¯èƒ½å¯¼è‡´çš„åæœæ˜¯çº¿ç¨‹æ± çš„çº¿ç¨‹åå¤ç”¨åœ¨æŸä¸€éƒ¨åˆ†ç”¨æˆ·çš„è§„åˆ™ä¸Šï¼Œå› ä¸ºçº¿ç¨‹æ˜¯è¿œè¿œä¸å¤Ÿç”¨çš„ï¼Œæ‰€æœ‰å¯èƒ½å­˜åœ¨ä¸€éƒ¨åˆ†ç”¨æˆ·çš„è§„åˆ™å§‹ç»ˆæ— æ³•å¾—åˆ°æ‰§è¡Œï¼Œå¯¹äºè¿™éƒ¨åˆ†ç”¨æˆ·æ¥è¯´ï¼Œä½“éªŒæ„Ÿæ˜¯æå…¶å·®çš„ã€‚</p>
<p>ç»¼åˆå„æ–¹é¢è€ƒé‡å’Œè¯„ä¼°ï¼Œæˆ‘ä»¬æœ€ç»ˆé€‰æ‹©çš„æ˜¯è§„åˆ™çš„ä¸²è¡Œæ‰§è¡Œã€‚å…¶å®å®æµ‹ä¸‹æ¥ï¼Œç”±äºè¿™äº›éƒ½æ˜¯å†…å­˜é‡Œé¢çš„è„šæœ¬å¼•æ“ç›´æ¥æ‰§è¡Œï¼Œæ‰§è¡Œé€Ÿåº¦è¿˜æ˜¯å¾ˆå¿«çš„ã€‚</p>
<h2 data-id="heading-7">è¡¨ç»“æ„è®¾è®¡</h2>
<p><strong>è§„åˆ™é…ç½®è¡¨</strong></p>




























































































































<table><thead><tr><th>å­—æ®µå</th><th>ç±»å‹</th><th>å…è®¸NULL</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>id</td><td>bigint</td><td>NO</td><td>AUTO_INCREMENT</td><td>ä¸»é”®ID</td></tr><tr><td>rule_desc</td><td>varchar(500)</td><td>YES</td><td>NULL</td><td>è§„åˆ™æè¿°</td></tr><tr><td>script_lang</td><td>varchar(50)</td><td>YES</td><td>NULL</td><td>åŒ¹é…è§„åˆ™è„šæœ¬è¯­è¨€ groovyã€spel ç­‰</td></tr><tr><td>script</td><td>text</td><td>YES</td><td>NULL</td><td>åŒ¹é…è§„åˆ™è„šæœ¬</td></tr><tr><td>result</td><td>text</td><td>YES</td><td>NULL</td><td>ç»“æœ</td></tr><tr><td>result_type</td><td>varchar(20)</td><td>YES</td><td>'json'</td><td>ç»“æœç±»å‹ï¼Œå¯ä»¥æ˜¯jsonï¼Œxmlï¼Œtext é»˜è®¤ json</td></tr><tr><td>status</td><td>varchar(20)</td><td>YES</td><td>NULL</td><td>çŠ¶æ€ï¼Œæ˜¯å¦å¯ç”¨ 1ï¼šå¯ç”¨ 0ï¼šç¦ç”¨</td></tr><tr><td>sort</td><td>int</td><td>NO</td><td>0</td><td>æ’åº ä»å°åˆ°å¤§æ’åº</td></tr><tr><td>end</td><td>tinyint(1)</td><td>NO</td><td>0</td><td>æ˜¯å¦åˆ°è¿™æ¡è§„åˆ™ç»“æŸï¼Œåªæœ‰å¶å­èŠ‚ç‚¹è¯¥å±æ€§æœ‰ç”¨</td></tr><tr><td>parent_id</td><td>bigint</td><td>YES</td><td>0</td><td>ä¸Šä¸€çº§ ç¬¬ä¸€çº§è¯¥å€¼ä¸º 0</td></tr><tr><td>rule_type</td><td>varchar(50)</td><td>YES</td><td>NULL</td><td>ä¸šåŠ¡ç±»å‹</td></tr><tr><td>test_data</td><td>text</td><td>YES</td><td>NULL</td><td>è§„åˆ™æµ‹è¯•æ•°æ®ç»“æ„ä½“</td></tr><tr><td>expect_value</td><td>tinyint</td><td>NO</td><td>0</td><td>æµ‹è¯•ç»“æ„ä½“æœŸæœ›çš„å€¼</td></tr><tr><td>crt_time</td><td>datetime</td><td>NO</td><td>CURRENT_TIMESTAMP</td><td>åˆ›å»ºæ—¶é—´</td></tr><tr><td>upt_time</td><td>datetime</td><td>NO</td><td>CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP</td><td>æ›´æ–°æ—¶é—´</td></tr><tr><td>deleted</td><td>tinyint(1)</td><td>NO</td><td>0</td><td>é€»è¾‘åˆ é™¤æ ‡å¿—</td></tr></tbody></table>
<p><strong>è§„åˆ™è¿è¡Œè½¨è¿¹è¡¨</strong></p>











































































<table><thead><tr><th>å­—æ®µå</th><th>ç±»å‹</th><th>å…è®¸NULL</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>id</td><td>int</td><td>NO</td><td>AUTO_INCREMENT</td><td>ä¸»é”®ID</td></tr><tr><td>member_id</td><td>varchar(50)</td><td>YES</td><td>NULL</td><td>ä¼šå‘˜ç¼–å·</td></tr><tr><td>rule_type</td><td>varchar(100)</td><td>YES</td><td>NULL</td><td>ä¸šåŠ¡è§„åˆ™ç±»å‹</td></tr><tr><td>params</td><td>text</td><td>YES</td><td>NULL</td><td>æ‰§è¡Œå‚æ•°</td></tr><tr><td>result</td><td>text</td><td>YES</td><td>NULL</td><td>æ‰§è¡Œç»“æœ</td></tr><tr><td>rules_tree</td><td>text</td><td>YES</td><td>NULL</td><td>è§„åˆ™æ‰§è¡Œè·¯å¾„ç»“æ„ JSON æ ¼å¼</td></tr><tr><td>crt_time</td><td>datetime</td><td>NO</td><td>CURRENT_TIMESTAMP</td><td>åˆ›å»ºæ—¶é—´</td></tr><tr><td>upt_time</td><td>datetime</td><td>NO</td><td>CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP</td><td>æ›´æ–°æ—¶é—´</td></tr><tr><td>deleted</td><td>tinyint(1)</td><td>YES</td><td>'0'</td><td>é€»è¾‘åˆ é™¤æ ‡å¿—ï¼ˆ0-æœªåˆ é™¤ï¼Œ1-å·²åˆ é™¤ï¼‰</td></tr></tbody></table>
<h2 data-id="heading-8">è§„åˆ™è„šæœ¬ç­–ç•¥</h2>
<p>æˆ‘ä»¬åˆ¤æ–­ä¸€æ¡è¯·æ±‚æ˜¯å¦åŒ¹é…æŸä¸ªå­è§„åˆ™ï¼Œéœ€è¦æ‰§è¡Œè¿™ä¸ªå­è§„åˆ™çš„å†…å®¹è„šæœ¬ï¼Œå¦‚æœè¿”å› <code>true</code> ä»£è¡¨åŒ¹é…ï¼Œå¦‚æœè¿”å› <code>false</code> ä»£è¡¨ä¸åŒ¹é…ï¼Œé‚£è¿™é‡Œè„šæœ¬å†…å®¹çš„ç±»å‹æœ‰å¤šç§å¯é€‰æ–¹å¼</p>
<ul>
<li><code>groovy</code></li>
<li><code>Spring Expression Language ï¼ˆSpELï¼‰</code></li>
<li><code>ongl</code></li>
<li>...ç­‰ç­‰</li>
</ul>
<blockquote>
<p>SpEL ç¡®å®æ˜¯ä¸ªå¾ˆå¥½ç”¨çš„ä¸œè¥¿ï¼Œåœ¨ <a href="https://juejin.cn/post/7453855415719739418" target="_blank" title="https://juejin.cn/post/7453855415719739418">Mock å¹³å°çš„è®¾è®¡</a> æ–‡ç« ä¸­ä¹Ÿæ˜¯è¿ç”¨è¿™ä¸ªæ¥è§£æè¯·æ±‚å‚æ•°çš„ mock æ¡ä»¶è¡¨è¾¾å¼</p>
</blockquote>
<p>è¿™é‡Œå¯ä»¥æ ¹æ®ä¸šåŠ¡å®é™…åœºæ™¯å¼€å‘è„šæœ¬ç­–ç•¥å®ç°ï¼Œæˆ‘è¿™é‡Œåªéœ€è¦ <code>Groovy</code> å’Œ <code>SpEL</code> å³å¯</p>
<p>é¡¶å±‚æ¥å£</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">LanguageScriptStrategy</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">CONTEXT_KEY</span> <span class="hljs-operator">=</span> <span class="hljs-string">"ctx"</span>;
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">support</span><span class="hljs-params">(String language)</span>;
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">match</span><span class="hljs-params">(Map&lt;String,Object&gt; params , String script)</span>;
}
</code></pre>
<p><code>groovy</code> ç­–ç•¥å®ç°</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GroovyScriptStrategy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">LanguageScriptStrategy</span> {

    <span class="hljs-comment">// å¤ç”¨ScriptEngineManager</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ScriptEngineManager</span> <span class="hljs-variable">ENGINE_MANAGER</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ScriptEngineManager</span>();

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">support</span><span class="hljs-params">(String language)</span> {
        <span class="hljs-keyword">return</span> ScriptTypeEnum.GROOVY.name().toLowerCase().equals(language);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">match</span><span class="hljs-params">(Map&lt;String, Object&gt; params, String script)</span> {
        <span class="hljs-type">ScriptEngine</span> <span class="hljs-variable">engine</span> <span class="hljs-operator">=</span> ENGINE_MANAGER.getEngineByName(ScriptTypeEnum.GROOVY.name().toLowerCase());
        <span class="hljs-comment">// è®¾ç½®ä¸Šä¸‹æ–‡å˜é‡</span>
        <span class="hljs-type">Bindings</span> <span class="hljs-variable">bindings</span> <span class="hljs-operator">=</span> engine.createBindings();
        bindings.put(CONTEXT_KEY, params);

        <span class="hljs-type">Object</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">try</span> {
            result = engine.eval(script, bindings);
        } <span class="hljs-keyword">catch</span> (ScriptException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"Groovyè„šæœ¬æ‰§è¡Œé”™è¯¯: "</span> + e.getMessage(), e);
        }
        <span class="hljs-keyword">if</span> (result <span class="hljs-keyword">instanceof</span> Boolean) {
            <span class="hljs-keyword">return</span> (Boolean) result;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
}
</code></pre>
<p><code>SpEL</code> ç­–ç•¥</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SpelScriptStrategy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">LanguageScriptStrategy</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">support</span><span class="hljs-params">(String language)</span> {
        <span class="hljs-keyword">return</span> ScriptTypeEnum.SPEL.name().toLowerCase().equals(language);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">match</span><span class="hljs-params">(Map&lt;String, Object&gt; params, String script)</span> {
        <span class="hljs-type">ExpressionParser</span> <span class="hljs-variable">parser</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SpelExpressionParser</span>();
        <span class="hljs-type">StandardEvaluationContext</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StandardEvaluationContext</span>();
        context.setVariable(CONTEXT_KEY, params);
        <span class="hljs-type">Boolean</span> <span class="hljs-variable">match</span> <span class="hljs-operator">=</span> parser.parseExpression(script).getValue(context, Boolean.class);
        <span class="hljs-keyword">if</span> (match == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        <span class="hljs-keyword">return</span> match;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">SpelScriptStrategy</span> <span class="hljs-variable">strategy</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SpelScriptStrategy</span>();
        Map&lt;String, Object&gt; params = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        params.put(<span class="hljs-string">"name"</span>, <span class="hljs-string">"sunyuchao"</span>);
        params.put(<span class="hljs-string">"age"</span>, <span class="hljs-number">18</span>);
        <span class="hljs-type">boolean</span> <span class="hljs-variable">match</span> <span class="hljs-operator">=</span> strategy.match(params, <span class="hljs-string">"#ctx['name'] != null &amp;&amp; #ctx['age'] != null"</span>);
        System.out.println(match);
    }
}
</code></pre>
<p>è¿™ä¸¤ç§è„šæœ¬éƒ½æ¯”è¾ƒç®€å•ï¼Œéšä¾¿ç†Ÿæ‚‰ä¸€ä¸‹å³å¯æŒæ¡ï¼Œå¹¶ä¸”å‡ ä¹èƒ½æ»¡è¶³æ‰€æœ‰å®é™…ä¸šåŠ¡åœºæ™¯éœ€æ±‚</p>
<h2 data-id="heading-9">æ ¸å¿ƒä»£ç å®ç°</h2>
<p>è§„åˆ™æ‰§è¡Œå…¥å£</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@param</span> ruleType è§„åˆ™ä¸šåŠ¡ç±»å‹
 * <span class="hljs-doctag">@param</span> params   è¯·æ±‚å‚æ•°ä½“ï¼ŒåŒ…å«è§„åˆ™æ‰§è¡Œè¿‡ç¨‹ä¸­ç”¨åˆ°çš„ç”¨æˆ·ä¿¡æ¯ç­‰å‚æ•°
 */</span>
<span class="hljs-keyword">public</span> List&lt;Map&lt;String, Object&gt;&gt; <span class="hljs-title function_">choice</span><span class="hljs-params">(String ruleType, Map&lt;String, Object&gt; params)</span> {
    List&lt;ChoiceRule&gt; childrenList;
    cacheLock.readLock().lock();
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">//æŸ¥è¯¢ ruleType çš„æ ¹èŠ‚ç‚¹</span>
        childrenList = CHOICE_RULE_CACHE.get(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RuleTypeKey</span>(ruleType, <span class="hljs-number">0</span>), <span class="hljs-built_in">this</span>::loadRule);
    } <span class="hljs-keyword">finally</span> {
        cacheLock.readLock().unlock();
    }
    <span class="hljs-keyword">if</span> (CollectionUtils.isEmpty(childrenList)) {
        <span class="hljs-keyword">return</span> Collections.emptyList();
    }
    <span class="hljs-type">RuleExecResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuleExecResponse</span>();
    <span class="hljs-type">ChoiceRuleRunRecord</span> <span class="hljs-variable">runRecord</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChoiceRuleRunRecord</span>();
    runRecord.setMemberId(String.valueOf(params.get(<span class="hljs-string">"memberId"</span>)));
    runRecord.setRuleType(ruleType);
    runRecord.setParams(JSON.toJSONString(params));
    runRecord.setResult(<span class="hljs-string">"{}"</span>);
    runRecord.setRulesTree(<span class="hljs-string">"{}"</span>);
    runRecord.setCrtTime(LocalDateTime.now());
    runRecord.setUptTime(LocalDateTime.now());
    choiceRuleRunRecordMapper.insert(runRecord);

    Map&lt;String, Object&gt; rulesTree = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedHashMap</span>&lt;&gt;();
    rulesTree.put(<span class="hljs-string">"id"</span>, <span class="hljs-number">0</span>);

    List&lt;Map&lt;String,Object&gt;&gt; childrenNodes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-keyword">for</span> (ChoiceRule rule : childrenList) {
        <span class="hljs-type">RuleExecResponse</span> <span class="hljs-variable">branchResponse</span> <span class="hljs-operator">=</span> doChoice(params, rule);
        childrenNodes.add(branchResponse.getRulesTree());
        <span class="hljs-keyword">if</span> (CollectionUtils.isEmpty(branchResponse.getResult())) {
            <span class="hljs-keyword">continue</span>;
        }
        response.getResult().addAll(branchResponse.getResult());
        <span class="hljs-keyword">if</span> (branchResponse.isEndFlag()) {
            <span class="hljs-keyword">break</span>;
        }
    }
    rulesTree.put(<span class="hljs-string">"children"</span>,childrenNodes);
    runRecord.setResult(JSON.toJSONString(response.getResult()));
    runRecord.setRulesTree(JSON.toJSONString(rulesTree));
    choiceRuleRunRecordMapper.updateById(runRecord);
    <span class="hljs-keyword">return</span> response.getResult();
}
</code></pre>
<p>é€’å½’æ‰§è¡Œä¸€æ¡å­è§„åˆ™é“¾è·¯</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@param</span> rule å½“å‰è§„åˆ™å®ä½“
 * <span class="hljs-doctag">@param</span> params   è¯·æ±‚å‚æ•°ä½“ï¼ŒåŒ…å«è§„åˆ™æ‰§è¡Œè¿‡ç¨‹ä¸­ç”¨åˆ°çš„ç”¨æˆ·ä¿¡æ¯ç­‰å‚æ•°
 */</span>
<span class="hljs-keyword">private</span> RuleExecResponse <span class="hljs-title function_">doChoice</span><span class="hljs-params">(Map&lt;String, Object&gt; params, ChoiceRule rule)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">script</span> <span class="hljs-operator">=</span> rule.getScript();
    <span class="hljs-comment">//æ‰§è¡Œè„šæœ¬å†…å®¹</span>
    <span class="hljs-type">boolean</span> <span class="hljs-variable">match</span> <span class="hljs-operator">=</span> strategyList.stream().filter(strategy -&gt; strategy.support(rule.getScriptLang()))
            .findFirst()
            .orElseThrow()
            .match(params, script);
    <span class="hljs-type">RuleExecResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuleExecResponse</span>();

    response.getRulesTree().put(<span class="hljs-string">"id"</span>, rule.getId());
    <span class="hljs-keyword">if</span> (!match) {
        <span class="hljs-comment">// ä¸åŒ¹é…ç›´æ¥è¿”å›ç©ºå“åº”</span>
        response.getRulesTree().put(<span class="hljs-string">"children"</span>, Collections.emptyList());
        <span class="hljs-keyword">return</span> response;
    }
    List&lt;ChoiceRule&gt; childrenList;
    cacheLock.readLock().lock();
    <span class="hljs-keyword">try</span> {
        childrenList = CHOICE_RULE_CACHE.get(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RuleTypeKey</span>(rule.getRuleType(), rule.getId()), <span class="hljs-built_in">this</span>::loadRule);
    } <span class="hljs-keyword">finally</span> {
        cacheLock.readLock().unlock();
    }
    <span class="hljs-keyword">if</span> (CollectionUtils.isEmpty(childrenList)) {
        <span class="hljs-comment">//è¯´æ˜æ˜¯å¶å­ç»“ç‚¹ï¼Œç›´æ¥è¿”å›ç»“æœ</span>
        response.getRulesTree().put(<span class="hljs-string">"children"</span>, Collections.emptyList());
        Map&lt;String, Object&gt; map = JSON.parseObject(rule.getResult(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeReference</span>&lt;&gt;() {
        });
        <span class="hljs-keyword">if</span> (map != <span class="hljs-literal">null</span> &amp;&amp; !map.isEmpty()) {
            response.getResult().add(map);
        }
        <span class="hljs-comment">//å¦‚æœåŒ¹é…å°±ç»“æŸ</span>
        response.setEndFlag(rule.isEnd());
        <span class="hljs-keyword">return</span> response;
    }
    List&lt;Map&lt;String, Object&gt;&gt; childrenNodes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-keyword">for</span> (ChoiceRule choiceRule : childrenList) {
        <span class="hljs-comment">//é€’å½’å­è§„åˆ™</span>
        <span class="hljs-type">RuleExecResponse</span> <span class="hljs-variable">childResponse</span> <span class="hljs-operator">=</span> doChoice(params, choiceRule);
        response.getResult().addAll(childResponse.getResult());

        childrenNodes.add(childResponse.getRulesTree());
        <span class="hljs-keyword">if</span> (childResponse.isEndFlag()) {
            response.setEndFlag(<span class="hljs-literal">true</span>);
            <span class="hljs-keyword">break</span>;
        }
    }
    response.getRulesTree().put(<span class="hljs-string">"children"</span>, childrenNodes);
    <span class="hljs-keyword">return</span> response;
}
</code></pre>
<p>è¿™é‡Œæˆ‘å¯åŠ¨é¡¹ç›®çš„æ—¶å€™æ„é€ äº†å½“å‰ä¸šåŠ¡ç±»å‹çš„æ‰€æœ‰è§„åˆ™ï¼Œä»¥æ ‘ç»“æ„æ‰“å°åˆ°æ§åˆ¶å°ï¼Œä¾¿äºç›´è§‚æŸ¥çœ‹</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7632478437a48d99a5c37c54e0a7eb3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769316817&amp;x-signature=ArdSwjF8f9uei23WG0Pxkjx03r8%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-10">è§„åˆ™è¿è¡Œè½¨è¿¹</h2>
<p>æˆ‘ä»¬å¿…é¡»è¦è®°å½•ä¸€ä¸ªç”¨æˆ·åœ¨è·¯ç”±èµ„é‡‘æ–¹çš„æ—¶å€™ï¼Œè¿™æ¡è·¯ç”±çš„å®Œæ•´é“¾è·¯è½¨è¿¹ï¼Œè¿™æ ·åœ¨å›æº¯é—®é¢˜çš„æ—¶å€™æˆ‘ä»¬èƒ½æ¸…æ¥šçš„çœ‹åˆ°æ˜¯ç»ˆæ­¢åœ¨äº†å“ªä¸€ä¸ªè§„åˆ™ï¼Œå¹¶ä¸”åˆ°åº•ä»€ä¹ˆåŸå› æ²¡æœ‰é€šè¿‡è§„åˆ™ã€‚</p>
<blockquote>
<p><strong>å›æº¯</strong> è¿™ä¸ªè¯åœ¨æˆ‘çš„æ–‡ç« ä¸­å‡ºç°é¢‘ç‡å¾ˆé«˜ï¼ŒåŒ…æ‹¬åœ¨èŠæ¶ˆæ¯é˜Ÿåˆ—å¯é æ€§ã€å¹‚ç­‰çš„æ—¶å€™ä¹Ÿæåˆ°è¿‡ã€‚å®ƒéå¸¸é‡è¦ï¼Œå°½é‡è®©æˆ‘ä»¬æ¯ä¸€ä»¶äº‹éƒ½æœ‰è¿¹å¯å¾ªï¼</p>
</blockquote>
<p>ä¸€ä¸ªç”¨æˆ·çš„ä¸€æ¬¡è·¯ç”±æ˜¯ä¸€æ¡è®°å½•ï¼Œ<code>choice_rule_run_record.rules_tree</code> å­—æ®µè®°å½•äº†æ‰€æœ‰èµ°è¿‡çš„è§„åˆ™æ ‘ç»“æ„ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªåµŒå¥—çš„ <code>JSON</code>ï¼Œç„¶åæˆ‘ä»¬ç”¨ä¸€ä¸ªåˆé€‚çš„å‰ç«¯ç»„ä»¶æ˜¾ç¤ºå‡ºæ¥ä¸€æ¬¡è·¯ç”±çš„æ‰€æœ‰è¿è¡Œè½¨è¿¹ï¼Œä¾‹å¦‚ä¸‹å›¾</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef579f7bd2554fadbd086c30ec60b532~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769316817&amp;x-signature=4OGtW5XAM986Zd%2FdWjcPxwl48Xc%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™é‡Œç”±äºæˆ‘ä¸æ‡‚å‰ç«¯çŸ¥è¯†ï¼Œæ‰€ä»¥éšä¾¿é€‰äº†ä¸€ä¸ªç»„ä»¶æ¥æ¼”ç¤ºè¿è¡Œè½¨è¿¹ã€‚ä¸Šå›¾çš„è§„åˆ™åœºæ™¯æ˜¯åŒ¹é…åˆ°ä»»æ„ä¸€ç»“æœå°±ç»“æŸï¼Œæ‰€ä»¥åé¢çš„åŒçº§è§„åˆ™éƒ½æ²¡æœ‰èµ°åˆ°</p>
<h2 data-id="heading-11">éªŒè¯è§„åˆ™è„šæœ¬</h2>
<p>æˆ‘ä»¬åœ¨é¡µé¢ä¸Šç¼–è¾‘è§„åˆ™çš„æ—¶å€™ï¼Œä¸ºäº†é˜²æ­¢è„šæœ¬å†…å®¹æœ‰è¯­æ³•é”™è¯¯ï¼Œå¯ä»¥åœ¨é¡µé¢ä¸Šæ–°å¢ä¸€ä¸ªæ ¡éªŒæŒ‰é’®ï¼Œå½“æˆ‘ä»¬æ–°å¢/ç¼–è¾‘è§„åˆ™ï¼Œä¿å­˜æäº¤å‰ï¼Œåå…ˆç‚¹å‡»æ ¡éªŒæŒ‰é’®ï¼Œé€šè¿‡ä¹‹åæ‰å…è®¸ç‚¹å‡»ä¿å­˜æŒ‰é’®ï¼Œé˜²æ­¢è„šæœ¬å†…å®¹é”™è¯¯ç›´æ¥æŠ•å…¥ç”Ÿäº§ç¯å¢ƒé€ æˆäº‹æ•…ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æµ‹è¯•æŸä¸ªè§„åˆ™æµ‹è¯•è¯·æ±‚ä½“æ˜¯å¦èƒ½è¿”å›é¢„æœŸçš„å€¼ï¼ŒéªŒè¯è„šæœ¬æ­£ç¡®æ€§
 *
 * <span class="hljs-doctag">@return</span> true éªŒè¯é€šè¿‡ï¼šfalse éªŒè¯å¤±è´¥
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">testRule</span><span class="hljs-params">(ChoiceRule rule)</span> {
    <span class="hljs-type">boolean</span> <span class="hljs-variable">match</span> <span class="hljs-operator">=</span> strategyList.stream().filter(strategy -&gt; strategy.support(rule.getScriptLang()))
            .findFirst()
            .orElseThrow()
            .match(JSON.parseObject(rule.getTestData(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeReference</span>&lt;&gt;() {
            }), rule.getScript());
    <span class="hljs-keyword">return</span> match == rule.isExpectValue();
}
</code></pre>
<p>ç±»ä¼¼ä¸‹å›¾çš„ä¿å­˜</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dff180b322244e8e8dd9fc56b4e2b03d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769316817&amp;x-signature=%2BtEPlS9oo5df8UTlG1ywhHsQ76U%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-12">è§„åˆ™è„šæœ¬å˜æ›´å‘Šè­¦</h2>
<p>è§„åˆ™å˜æ›´æ˜¯ä¸€ä¸ªéå¸¸æ•æ„Ÿçš„æ“ä½œï¼Œå¾ˆå¯èƒ½ä¼šå¼•å‘ä¸¥é‡çš„ç”Ÿäº§äº‹æ•…ï¼Œå› æ­¤åœ¨ä»»ä½•ä¸€æ¡è§„åˆ™å†…å®¹å˜æ›´åéƒ½åº”è¯¥å‘Šè­¦å‡ºæ¥åˆ°é’‰é’‰ç¾¤æˆ–è€…ä¼ä¸šå¾®ä¿¡ç¾¤ï¼Œé€šçŸ¥ç›¸å…³è´Ÿè´£äººçŸ¥æ™“æ­¤äº‹ï¼Œå¦‚æœæ²¡é—®é¢˜å¿½ç•¥å³å¯ã€‚</p>
<p>æˆ‘å¸ä¹‹å‰å°±æœ‰è¿‡ä¸€æ¬¡äº‹æ•…ï¼Œé‚£ä¸ªè§„åˆ™è·¯ç”±æ˜¯ä¸€ä¸ªæ‰£æ¬¾å•†æˆ·å·çš„åœºæ™¯ã€‚ä¸åŒè¿˜æ¬¾å•æ ¹æ®ä¸€ç³»åˆ—ç‰¹å®šçš„æ¡ä»¶èµ°ä¸åŒçš„æ‰£æ¬¾å•†æˆ·å·å»æ‰£æ¬¾ï¼Œç»“æœä¸€ä¸ªæ–°æ¥çš„åŒäº‹æ”¹é”™äº†ï¼Œä¹Ÿæ²¡æœ‰å‘Šè­¦ï¼Œå¯¼è‡´ä¸€å¤§æ‰¹è®¢å•çš„æ‰£æ¬¾æ¸ é“èµ°é”™ã€‚ã€‚ã€‚ã€‚</p>
<h2 data-id="heading-13">ç»“è¯­</h2>
<h3 data-id="heading-14">å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè®°å¾—ç‚¹èµåŠ å…³æ³¨ï¼ä½ çš„æ”¯æŒå°±æ˜¯æˆ‘ç»§ç»­åˆ›ä½œçš„åŠ¨åŠ›ï¼</h3></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç£ç›˜ä¸Šæ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´å®Œæˆæ­¤æ“ä½œï¼Œè¿˜æœ‰ä¸ª8mçš„å¯Œä½™åˆ ä¸æ‰]]></title>    <link>https://juejin.cn/post/7595842144907231282</link>    <guid>https://juejin.cn/post/7595842144907231282</guid>    <pubDate>2026-01-17T11:49:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595842144907231282" data-draft-id="7595894884956930099" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç£ç›˜ä¸Šæ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´å®Œæˆæ­¤æ“ä½œï¼Œè¿˜æœ‰ä¸ª8mçš„å¯Œä½™åˆ ä¸æ‰"/> <meta itemprop="keywords" content="é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-17T11:49:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é£ä¹‹æ—…äºº"/> <meta itemprop="url" content="https://juejin.cn/user/43636193505790"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç£ç›˜ä¸Šæ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´å®Œæˆæ­¤æ“ä½œï¼Œè¿˜æœ‰ä¸ª8mçš„å¯Œä½™åˆ ä¸æ‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/43636193505790/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é£ä¹‹æ—…äºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T11:49:11.000Z" title="Sat Jan 17 2026 11:49:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ› ï¸ è§£å†³ Windows 8MB æ®‹ç•™ç©ºé—´æ— æ³•åˆ é™¤çš„é—®é¢˜</h2>
<blockquote>
<p>Windows11 ç£ç›˜ä¸Šæ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´å®Œæˆæ­¤æ“ä½œï¼Œè€Œä¸”è¿˜æœ‰8mçš„å¯Œä½™åˆ ä¸æ‰ã€‚é€šè¿‡Windowss çš„ DiskPart å®ç°ç£ç›˜çš„æ¸…ç†ä¸åˆ†åŒºåˆ›å»ºã€‚</p>
</blockquote>
<p>è¿™ä¸ª 8MB çš„â€œé¡½å›ºâ€ç©ºé—´ï¼Œé€šå¸¸æ˜¯ <strong>GPT åˆ†åŒºè¡¨çš„ MSR ä¿ç•™åˆ†åŒº</strong>ï¼Œæˆ–æ˜¯ MBR åˆ†åŒºè¡¨çš„éšè—å¯¹é½ç©ºé—´ï¼ŒWindows ç£ç›˜ç®¡ç†å·¥å…·å› ä¸ºæƒé™å’Œä¿æŠ¤æœºåˆ¶ï¼Œæ— æ³•ç›´æ¥åˆ é™¤å®ƒã€‚æˆ‘ä»¬å¯ä»¥ç”¨ Windows è‡ªå¸¦çš„ <strong>DiskPart å‘½ä»¤è¡Œå·¥å…·</strong> å½»åº•æ¸…ç†ï¼Œå†åˆå¹¶æˆå®Œæ•´çš„ 1T åˆ†åŒºã€‚</p>
<hr/>
<h4 data-id="heading-1">ğŸ” ä¸ºä»€ä¹ˆä¼šå‡ºç° 8MB æ®‹ç•™ï¼Ÿ</h4>
<ul>
<li><strong>GPT åˆ†åŒºè¡¨</strong>ï¼šé»˜è®¤ä¼šåˆ›å»ºä¸€ä¸ª 8MB çš„ MSRï¼ˆMicrosoft ä¿ç•™åˆ†åŒºï¼‰ï¼Œç”¨äºåˆ†åŒºè¡¨ç»´æŠ¤å’Œç³»ç»ŸåŠŸèƒ½ï¼Œç£ç›˜ç®¡ç†é‡Œçœ‹ä¸åˆ°ä¹Ÿåˆ ä¸æ‰ã€‚</li>
<li><strong>MBR åˆ†åŒºè¡¨</strong>ï¼šå¯èƒ½æ˜¯åˆ†åŒºåˆ é™¤åæ®‹ç•™çš„å¯¹é½ç©ºé—´ï¼Œæˆ–éšè—çš„ OEM åˆ†åŒºç¢ç‰‡ã€‚</li>
<li>æ— è®ºå“ªç§æƒ…å†µï¼Œç”¨ <code>DiskPart</code> éƒ½èƒ½ä¸€æ¬¡æ€§è§£å†³ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-2">ğŸš€ ç”¨ DiskPart å½»åº•æ¸…ç†å¹¶åˆå¹¶ï¼ˆå®‰å…¨é«˜æ•ˆï¼‰</h4>
<h5 data-id="heading-3">ç¬¬ä¸€æ­¥ï¼šä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€å‘½ä»¤æç¤ºç¬¦</h5>
<ol>
<li>æŒ‰ä¸‹ <code>Win + X</code> â†’ é€‰æ‹©ã€ŒWindows ç»ˆç«¯ï¼ˆç®¡ç†å‘˜ï¼‰ã€æˆ–ã€Œå‘½ä»¤æç¤ºç¬¦ï¼ˆç®¡ç†å‘˜ï¼‰ã€ã€‚</li>
<li>è¾“å…¥ <code>diskpart</code> å¹¶å›è½¦ï¼Œè¿›å…¥ç£ç›˜åˆ†åŒºç®¡ç†å·¥å…·ã€‚</li>
</ol>
<h5 data-id="heading-4">ç¬¬äºŒæ­¥ï¼šé€‰æ‹©ç›®æ ‡ç£ç›˜ï¼ˆå…³é”®ï¼åˆ«é€‰é”™ï¼‰</h5>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># 1. åˆ—å‡ºæ‰€æœ‰ç£ç›˜ï¼Œæ‰¾åˆ°ä½ çš„ 1T ç¡¬ç›˜ï¼ˆé€šå¸¸æ˜¯ Disk 1ï¼Œç³»ç»Ÿç›˜æ˜¯ Disk 0ï¼‰</span>
list disk

<span class="hljs-meta"># 2. é€‰æ‹©ç›®æ ‡ç£ç›˜ï¼ˆæ›¿æ¢ X ä¸ºä½ çš„ç£ç›˜ç¼–å·ï¼Œæ¯”å¦‚ Disk 1ï¼‰</span>
<span class="hljs-keyword">select</span> disk X

<span class="hljs-meta"># 3. éªŒè¯é€‰æ‹©ï¼šç¡®è®¤â€œç£ç›˜ X ç°åœ¨æ˜¯æ‰€é€‰ç£ç›˜â€</span>
</code></pre>
<p>âš ï¸ <strong>æ ¸å¿ƒæé†’</strong>ï¼šä¸€å®šè¦é€šè¿‡å®¹é‡ï¼ˆæ¯”å¦‚ 1024GBï¼‰ç¡®è®¤ç›®æ ‡ç£ç›˜ï¼Œåˆ«è¯¯é€‰ç³»ç»Ÿç›˜ï¼ˆDisk 0ï¼‰ï¼Œå¦åˆ™ä¼šå¯¼è‡´ç³»ç»Ÿå´©æºƒï¼</p>
<h5 data-id="heading-5">ç¬¬ä¸‰æ­¥ï¼šå½»åº•æ¸…ç†æ‰€æœ‰åˆ†åŒºï¼ˆåŒ…æ‹¬ 8MB æ®‹ç•™ï¼‰</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ¸…ç†ç£ç›˜ï¼šåˆ é™¤æ‰€æœ‰åˆ†åŒºã€éšè—åˆ†åŒºå’Œæ®‹ç•™ç©ºé—´ï¼Œå˜æˆçº¯â€œæœªåˆ†é…â€</span>
clean
</code></pre>
<p>âœ… æ‰§è¡Œåï¼Œä½ çš„ 1T ç¡¬ç›˜ä¼šè¢«å®Œå…¨æ¸…ç©ºï¼ŒåŒ…æ‹¬é‚£ä¸ª 8MB çš„ä¿ç•™åˆ†åŒºï¼Œæ•´ä¸ªç¡¬ç›˜å˜æˆä¸€å—è¿ç»­çš„æœªåˆ†é…ç©ºé—´ã€‚</p>
<h5 data-id="heading-6">ç¬¬å››æ­¥ï¼šåˆ›å»ºå®Œæ•´çš„ 1T åˆ†åŒº</h5>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># 1. è½¬æ¢ä¸º GPT åˆ†åŒºè¡¨ï¼ˆæ¨èï¼Œæ”¯æŒå¤§ç¡¬ç›˜å’Œ UEFI å¯åŠ¨ï¼‰</span>
convert gpt

<span class="hljs-comment"># 2. åˆ›å»ºæ–°çš„ç®€å•å·ï¼Œå¤§å°ä¸ºå…¨éƒ¨æœªåˆ†é…ç©ºé—´</span>
create partition primary

<span class="hljs-comment"># 3. æ ¼å¼åŒ–åˆ†åŒºä¸º NTFSï¼Œå¿«é€Ÿæ ¼å¼åŒ–</span>
format <span class="hljs-attr">fs</span>=ntfs quick label=Data

<span class="hljs-comment"># 4. åˆ†é…é©±åŠ¨å™¨å·ï¼ˆè‡ªåŠ¨åˆ†é…å¯ç”¨ç›˜ç¬¦ï¼‰</span>
assign
</code></pre>
<hr/>
<h4 data-id="heading-7">âœ… éªŒè¯ç»“æœ</h4>
<ol>
<li>å…³é—­å‘½ä»¤æç¤ºç¬¦ï¼Œæ‰“å¼€ã€Œæ­¤ç”µè„‘ã€ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªå®¹é‡çº¦ 1T çš„å®Œæ•´åˆ†åŒºã€‚</li>
<li>æ‰“å¼€ã€Œç£ç›˜ç®¡ç†ã€ï¼Œç¡®è®¤è¯¥ç¡¬ç›˜åªæœ‰ä¸€ä¸ªåˆ†åŒºï¼Œæ²¡æœ‰ä»»ä½•æ®‹ç•™ç©ºé—´ã€‚</li>
</ol>
<hr/>
<h4 data-id="heading-8">ğŸ’¡ æ³¨æ„äº‹é¡¹</h4>
<ol>
<li><strong>æ•°æ®å®‰å…¨</strong>ï¼š<code>clean</code> å‘½ä»¤ä¼šåˆ é™¤æ‰€æœ‰åˆ†åŒºå’Œæ•°æ®ï¼Œä½ å·²ç»æ ¼å¼åŒ–è¿‡ï¼Œæ‰€ä»¥æ— éœ€æ‹…å¿ƒï¼Œä½†å†æ¬¡ç¡®è®¤ç›®æ ‡ç£ç›˜æ­£ç¡®ï¼</li>
<li><strong>GPT vs MBR</strong>ï¼šå¦‚æœä½ çš„ç”µè„‘æ˜¯ Legacy BIOS å¯åŠ¨ï¼Œéœ€è¦ç”¨ <code>convert mbr</code> ä»£æ›¿ <code>convert gpt</code>ï¼Œå¦åˆ™æ— æ³•è¯†åˆ«åˆ†åŒºã€‚</li>
<li><strong>å¿«é€Ÿæ ¼å¼åŒ–</strong>ï¼š<code>format fs=ntfs quick</code> ä¼šè·³è¿‡æ‰‡åŒºæ£€æŸ¥ï¼Œé€Ÿåº¦æ›´å¿«ï¼Œé€‚åˆå·²ç»æ ¼å¼åŒ–è¿‡çš„ç¡¬ç›˜ã€‚</li>
</ol>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€èŠ‚ç‚¹ã€‘[SliderèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨]]></title>    <link>https://juejin.cn/post/7595901379015753738</link>    <guid>https://juejin.cn/post/7595901379015753738</guid>    <pubDate>2026-01-18T04:05:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595901379015753738" data-draft-id="7595894884958208051" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€èŠ‚ç‚¹ã€‘[SliderèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨"/> <meta itemprop="keywords" content="æ¸¸æˆå¼€å‘,å›¾å½¢å­¦,Unity3D"/> <meta itemprop="datePublished" content="2026-01-18T04:05:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SmalBox"/> <meta itemprop="url" content="https://juejin.cn/user/2218166695237532"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€èŠ‚ç‚¹ã€‘[SliderèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2218166695237532/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SmalBox
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T04:05:07.000Z" title="Sun Jan 18 2026 04:05:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong></p>
</blockquote>
<p>åœ¨Unity URP Shader Graphä¸­ï¼ŒSliderèŠ‚ç‚¹æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”å¸¸ç”¨çš„å·¥å…·èŠ‚ç‚¹ï¼Œå®ƒä¸ºç€è‰²å™¨å¼€å‘æä¾›äº†ç›´è§‚çš„å‚æ•°æ§åˆ¶æ–¹å¼ã€‚é€šè¿‡SliderèŠ‚ç‚¹ï¼Œå¼€å‘è€…å¯ä»¥åˆ›å»ºå¯è°ƒèŠ‚çš„æµ®ç‚¹æ•°å€¼ï¼Œè¿™äº›æ•°å€¼åœ¨æè´¨æ£€è§†å™¨ä¸­ä»¥æ»‘åŠ¨æ¡çš„å½¢å¼å‘ˆç°ï¼Œæå¤§åœ°æ–¹ä¾¿äº†æè´¨çš„å‚æ•°è°ƒæ•´å’Œå®æ—¶é¢„è§ˆã€‚</p>
<h2 data-id="heading-0">SliderèŠ‚ç‚¹çš„åŸºæœ¬æ¦‚å¿µ</h2>
<p>SliderèŠ‚ç‚¹åœ¨Shader Graphä¸­å±äºå¸¸é‡å€¼èŠ‚ç‚¹çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ã€‚ä¸æ™®é€šçš„FloatèŠ‚ç‚¹ä¸åŒï¼ŒSliderèŠ‚ç‚¹ä¸ä»…æä¾›äº†æ•°å€¼è¾“å‡ºåŠŸèƒ½ï¼Œæ›´é‡è¦çš„æ˜¯å®ƒèƒ½å¤Ÿåœ¨æè´¨æ£€è§†å™¨ä¸­ç”Ÿæˆä¸€ä¸ªå¯è§†åŒ–çš„æ»‘åŠ¨æ¡æ§ä»¶ã€‚è¿™ç§å¯è§†åŒ–æ§åˆ¶æ–¹å¼è®©éæŠ€æœ¯èƒŒæ™¯çš„è‰ºæœ¯å®¶å’Œè®¾è®¡å¸ˆä¹Ÿèƒ½å¤Ÿè½»æ¾è°ƒæ•´ç€è‰²å™¨å‚æ•°ï¼Œæ— éœ€ç›´æ¥ä¿®æ”¹ä»£ç æˆ–èŠ‚ç‚¹è¿æ¥ã€‚</p>
<p>SliderèŠ‚ç‚¹çš„æ ¸å¿ƒä»·å€¼åœ¨äºå…¶èƒ½å¤Ÿå°†æŠ€æœ¯æ€§çš„æ•°å€¼å‚æ•°è½¬åŒ–ä¸ºç›´è§‚çš„äº¤äº’æ§ä»¶ã€‚åœ¨æ¸¸æˆå¼€å‘æµç¨‹ä¸­ï¼Œè¿™ç§è½¬åŒ–å…·æœ‰é‡è¦æ„ä¹‰ã€‚ç¾æœ¯äººå‘˜å¯ä»¥é€šè¿‡æ‹–åŠ¨æ»‘åŠ¨æ¡å®æ—¶è§‚å¯Ÿæè´¨æ•ˆæœçš„å˜åŒ–ï¼Œå¿«é€Ÿè¿­ä»£å’Œä¼˜åŒ–è§†è§‰æ•ˆæœï¼Œè€Œä¸å¿…ä¾èµ–ç¨‹åºå‘˜è¿›è¡Œæ¯æ¬¡çš„å‚æ•°è°ƒæ•´ã€‚</p>
<p>ä»æŠ€æœ¯å®ç°è§’åº¦æ¥çœ‹ï¼ŒSliderèŠ‚ç‚¹åœ¨Shader Graphå†…éƒ¨è¢«å¤„ç†ä¸ºä¸€ä¸ªæµ®ç‚¹æ•°å¸¸é‡ï¼Œä½†å…¶ç‰¹æ®Šçš„å±æ€§æ ‡è®°ä½¿å¾—Unityç¼–è¾‘å™¨èƒ½å¤Ÿè¯†åˆ«å¹¶åœ¨UIå±‚é¢æä¾›æ»‘åŠ¨æ¡æ§ä»¶ã€‚è¿™ç§è®¾è®¡åˆ†ç¦»äº†æ•°æ®è¡¨ç¤ºå’Œç”¨æˆ·ç•Œé¢ï¼Œæ—¢ä¿è¯äº†ç€è‰²å™¨è®¡ç®—çš„é«˜æ•ˆæ€§ï¼Œåˆæä¾›äº†å‹å¥½çš„ç”¨æˆ·ä½“éªŒã€‚</p>
<h2 data-id="heading-1">èŠ‚ç‚¹åˆ›å»ºä¸åŸºæœ¬é…ç½®</h2>
<p><img src="https://docs.unity.cn/cn/Packages-cn/com.unity.shadergraph@14.0/manual/images/SliderNodeThumb.png" alt="" loading="lazy"/></p>
<p>åœ¨Shader Graphä¸­åˆ›å»ºSliderèŠ‚ç‚¹æœ‰å¤šç§æ–¹å¼ã€‚æœ€ç›´æ¥çš„æ–¹æ³•æ˜¯åœ¨Shader Graphçª—å£çš„ç©ºç™½åŒºåŸŸå³é”®ç‚¹å‡»ï¼Œä»ä¸Šä¸‹æ–‡èœå•ä¸­é€‰æ‹©"Create Node"ï¼Œç„¶ååœ¨æœç´¢æ¡†ä¸­è¾“å…¥"Slider"å³å¯æ‰¾åˆ°è¯¥èŠ‚ç‚¹ã€‚å¦ä¸€ç§ä¾¿æ·çš„æ–¹å¼æ˜¯é€šè¿‡é»‘åœºåŒºåŸŸçš„å³é”®èœå•ï¼Œé€‰æ‹©"Create Node"åå¯¼èˆªè‡³"Input/Basic/Slider"è·¯å¾„ã€‚</p>
<p>åˆ›å»ºSliderèŠ‚ç‚¹åï¼Œå¯ä»¥çœ‹åˆ°å…¶ç®€æ´çš„èŠ‚ç‚¹ç»“æ„ï¼šä¸€ä¸ªè¾“å‡ºç«¯å£å’Œä¸‰ä¸ªå¯é…ç½®å‚æ•°ã€‚è¾“å‡ºç«¯å£æ ‡è®°ä¸º"Out"ï¼Œç±»å‹ä¸ºFloatï¼Œç”¨äºå°†æ»‘åŠ¨æ¡çš„å½“å‰å€¼ä¼ é€’ç»™å›¾ä¸­çš„å…¶ä»–èŠ‚ç‚¹ã€‚ä¸‰ä¸ªé…ç½®å‚æ•°åŒ…æ‹¬æ»‘åŠ¨æ¡æœ¬èº«çš„å€¼ï¼Œä»¥åŠæœ€å°å€¼å’Œæœ€å¤§å€¼èŒƒå›´ã€‚</p>
<p>é…ç½®SliderèŠ‚ç‚¹æ—¶ï¼Œé¦–å…ˆéœ€è¦è®¾ç½®åˆç†çš„æ•°å€¼èŒƒå›´ã€‚Minå’ŒMaxå‚æ•°å®šä¹‰äº†æ»‘åŠ¨æ¡çš„ç†è®ºè¾¹ç•Œï¼Œè¿™äº›å€¼åº”è¯¥æ ¹æ®å®é™…åº”ç”¨åœºæ™¯æ¥è®¾å®šã€‚ä¾‹å¦‚ï¼Œæ§åˆ¶é€æ˜åº¦çš„æ»‘åŠ¨æ¡é€šå¸¸è®¾ç½®åœ¨0åˆ°1ä¹‹é—´ï¼Œè€Œæ§åˆ¶çº¹ç†é‡å¤æ¬¡æ•°çš„æ»‘åŠ¨æ¡å¯èƒ½éœ€è¦æ›´å¤§çš„èŒƒå›´ã€‚</p>
<h2 data-id="heading-2">ç«¯å£è¯¦è§£ä¸æ•°æ®æµ</h2>
<p>SliderèŠ‚ç‚¹çš„ç«¯å£é…ç½®ç›¸å¯¹ç®€å•ä½†åŠŸèƒ½æ˜ç¡®ã€‚è¾“å‡ºç«¯å£"Out"æ˜¯èŠ‚ç‚¹çš„å”¯ä¸€æ•°æ®å‡ºå£ï¼Œè´Ÿè´£å°†æ»‘åŠ¨æ¡çš„å½“å‰æ•°å€¼ä¼ é€’ç»™è¿æ¥çš„ä¸‹æ¸¸èŠ‚ç‚¹ã€‚è¿™ä¸ªè¾“å‡ºå€¼çš„ç±»å‹å§‹ç»ˆä¸ºFloatï¼Œç¬¦åˆå¤§å¤šæ•°ç€è‰²å™¨è®¡ç®—å¯¹æ•°å€¼ç²¾åº¦çš„è¦æ±‚ã€‚</p>
<p>æ•°æ®æµé€šè¿‡SliderèŠ‚ç‚¹æ—¶ï¼ŒèŠ‚ç‚¹æœ¬èº«ä¸æ‰§è¡Œä»»ä½•è®¡ç®—æˆ–å˜æ¢ï¼Œå®ƒä»…ä»…ä½œä¸ºä¸€ä¸ªæ•°å€¼æºå­˜åœ¨ã€‚å½“æè´¨æ£€è§†å™¨ä¸­çš„æ»‘åŠ¨æ¡è¢«æ‹–åŠ¨æ—¶ï¼ŒSliderèŠ‚ç‚¹çš„è¾“å‡ºå€¼ä¼šå®æ—¶æ›´æ–°ï¼Œè¿›è€Œè§¦å‘æ•´ä¸ªç€è‰²å™¨çš„é‡æ–°è®¡ç®—å’Œæ¸²æŸ“æ›´æ–°ã€‚</p>
<p>è¾“å‡ºç«¯å£çš„ç»‘å®šç‰¹æ€§ä¸º"æ— "ï¼Œè¿™æ„å‘³ç€SliderèŠ‚ç‚¹çš„è¾“å‡ºä¸ä¾èµ–äºä»»ä½•å¤–éƒ¨è¾“å…¥æˆ–çº¹ç†é‡‡æ ·ã€‚è¿™ç§ç‹¬ç«‹æ€§ä½¿å¾—SliderèŠ‚ç‚¹éå¸¸é€‚åˆç”¨ä½œç€è‰²å™¨çš„å‚æ•°æ§åˆ¶ç‚¹ï¼Œå› ä¸ºå®ƒä¸ä¼šå¼•å…¥é¢å¤–çš„ä¾èµ–å…³ç³»æˆ–è®¡ç®—å¤æ‚åº¦ã€‚</p>
<p>åœ¨å®é™…ä½¿ç”¨ä¸­ï¼ŒSliderèŠ‚ç‚¹çš„è¾“å‡ºå¯ä»¥ç›´æ¥è¿æ¥åˆ°å„ç§æ¥å—Floatè¾“å…¥çš„èŠ‚ç‚¹ï¼Œå¦‚æ•°å­¦è¿ç®—èŠ‚ç‚¹ã€çº¹ç†åæ ‡èŠ‚ç‚¹ã€é¢œè‰²æ··åˆèŠ‚ç‚¹ç­‰ã€‚è¿™ç§çµæ´»æ€§è®©SliderèŠ‚ç‚¹æˆä¸ºæ§åˆ¶ç€è‰²å™¨å„ç§ç‰¹æ€§çš„é€šç”¨å·¥å…·ã€‚</p>
<h2 data-id="heading-3">æ§ä»¶å‚æ•°æ·±åº¦è§£æ</h2>
<p>SliderèŠ‚ç‚¹çš„æ§ä»¶å‚æ•°è™½ç„¶æ•°é‡ä¸å¤šï¼Œä½†æ¯ä¸ªå‚æ•°éƒ½æœ‰å…¶ç‰¹å®šçš„ç”¨é€”å’Œé…ç½®è€ƒé‡ã€‚</p>
<p><strong>æ»‘åŠ¨æ¡å€¼æ§ä»¶</strong></p>
<p>è¿™æ˜¯SliderèŠ‚ç‚¹çš„æ ¸å¿ƒå‚æ•°ï¼Œå†³å®šäº†å½“å‰è¾“å‡ºçš„æ•°å€¼ã€‚åœ¨Shader Graphç¼–è¾‘å™¨ä¸­ï¼Œè¿™ä¸ªå€¼å¯ä»¥é€šè¿‡æ•°å­—è¾“å…¥æ¡†ç²¾ç¡®è®¾ç½®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç‚¹å‡»å¹¶æ‹–åŠ¨æ»‘åŠ¨æ¡æ¥ç›´è§‚è°ƒæ•´ã€‚è¿™ä¸ªå€¼çš„è®¾ç½®åº”å½“è€ƒè™‘å®é™…åº”ç”¨éœ€æ±‚ï¼Œæ¯”å¦‚å¦‚æœç”¨äºæ§åˆ¶é«˜å…‰å¼ºåº¦ï¼Œåˆå§‹å€¼å¯èƒ½éœ€è¦è®¾ç½®ä¸ºä¸€ä¸ªè¾ƒå°çš„æ­£æ•°ã€‚</p>
<p><strong>æœ€å°å€¼å‚æ•°</strong></p>
<p>Minå‚æ•°å®šä¹‰äº†æ»‘åŠ¨æ¡çš„ç†è®ºä¸‹é™ã€‚è¿™ä¸ªå€¼å¯ä»¥æ˜¯ä»»æ„æµ®ç‚¹æ•°ï¼ŒåŒ…æ‹¬è´Ÿæ•°ã€‚åœ¨è®¾ç½®æœ€å°å€¼æ—¶ï¼Œéœ€è¦è€ƒè™‘ç‰©ç†åˆç†æ€§ï¼Œæ¯”å¦‚é€æ˜åº¦ä¸åº”å°äº0ï¼Œä½†é¢œè‰²åç§»é‡å¯èƒ½å…è®¸è´Ÿå€¼ã€‚æœ€å°å€¼è¿˜å½±å“ç€æ»‘åŠ¨æ¡çš„çµæ•åº¦ï¼ŒèŒƒå›´è¶Šå¤§ï¼Œå•ä½ç§»åŠ¨å¯¹åº”çš„æ•°å€¼å˜åŒ–å°±è¶Šå¤§ã€‚</p>
<p><strong>æœ€å¤§å€¼å‚æ•°</strong></p>
<p>Maxå‚æ•°ä¸Minå‚æ•°ååŒå·¥ä½œï¼Œå®šä¹‰äº†æ»‘åŠ¨æ¡çš„æ•°å€¼ä¸Šé™ã€‚æœ€å¤§å€¼çš„é€‰æ‹©åŒæ ·éœ€è¦åŸºäºå®é™…åº”ç”¨åœºæ™¯ï¼Œè¿‡å¤§çš„æœ€å¤§å€¼å¯èƒ½å¯¼è‡´æ»‘åŠ¨æ¡æ§åˆ¶ä¸å¤Ÿç²¾ç»†ï¼Œè¿‡å°çš„æœ€å¤§å€¼åˆ™å¯èƒ½é™åˆ¶æ•ˆæœçš„è¡¨è¾¾ã€‚</p>
<p><strong>èŒƒå›´è®¾ç½®çš„ç­–ç•¥</strong></p>
<p>åˆç†çš„èŒƒå›´è®¾ç½®æ˜¯SliderèŠ‚ç‚¹ä½¿ç”¨çš„å…³é”®ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ä½¿ç”¨åœºæ™¯å’Œæ¨èèŒƒå›´ï¼š</p>
<ul>
<li>é€æ˜åº¦æ§åˆ¶ï¼š0.0 - 1.0</li>
<li>é«˜å…‰å¼ºåº¦ï¼š0.0 - 5.0</li>
<li>çº¹ç†ç¼©æ”¾ï¼š0.1 - 10.0</li>
<li>é¢œè‰²é€šé“åç§»ï¼š-1.0 - 1.0</li>
<li>æ—¶é—´ç³»æ•°ï¼š0.0 - 10.0</li>
</ul>
<h2 data-id="heading-4">å±æ€§è½¬æ¢ä¸æè´¨å®ä¾‹åŒ–</h2>
<p>SliderèŠ‚ç‚¹çš„ä¸€ä¸ªå¼ºå¤§ç‰¹æ€§æ˜¯èƒ½å¤Ÿè½¬æ¢ä¸ºç€è‰²å™¨å±æ€§ã€‚é€šè¿‡èŠ‚ç‚¹çš„ä¸Šä¸‹æ–‡èœå•ï¼Œé€‰æ‹©"Convert To Property"é€‰é¡¹ï¼Œå¯ä»¥å°†SliderèŠ‚ç‚¹è½¬æ¢ä¸ºä¸€ä¸ªæ­£å¼çš„ç€è‰²å™¨å±æ€§ã€‚è¿™ä¸€è½¬æ¢å¸¦æ¥äº†å‡ ä¸ªé‡è¦ä¼˜åŠ¿ï¼š</p>
<p><strong>æè´¨å®ä¾‹åŒ–æ”¯æŒ</strong></p>
<p>è½¬æ¢ä¸ºå±æ€§åï¼Œæ¯ä¸ªä½¿ç”¨è¯¥ç€è‰²å™¨çš„æè´¨å®ä¾‹éƒ½å¯ä»¥æ‹¥æœ‰è‡ªå·±ç‹¬ç«‹çš„Sliderå€¼ã€‚è¿™æ„å‘³ç€å¯ä»¥åœ¨ä¸åŒæè´¨ä¸­è®¾ç½®ä¸åŒçš„å‚æ•°ï¼Œè€Œæ— éœ€åˆ›å»ºå¤šä¸ªç€è‰²å™¨å˜ä½“ã€‚</p>
<p><strong>è¿è¡Œæ—¶ä¿®æ”¹èƒ½åŠ›</strong></p>
<p>ä½œä¸ºå±æ€§çš„Sliderå€¼å¯ä»¥åœ¨æ¸¸æˆè¿è¡Œæ—¶é€šè¿‡è„šæœ¬åŠ¨æ€ä¿®æ”¹ï¼Œè¿™ä¸ºåˆ›å»ºäº¤äº’å¼è§†è§‰æ•ˆæœæä¾›äº†å¯èƒ½ã€‚æ¯”å¦‚ï¼Œå¯ä»¥æ ¹æ®æ¸¸æˆäº‹ä»¶è°ƒæ•´æè´¨çš„å‘å…‰å¼ºåº¦æˆ–é€æ˜åº¦ã€‚</p>
<p><strong>å±æ€§é…ç½®é€‰é¡¹</strong></p>
<p>è½¬æ¢ä¸ºå±æ€§åï¼Œå¯ä»¥é…ç½®æ›´å¤šå±æ€§ç›¸å…³è®¾ç½®ï¼Œå¦‚å±æ€§åç§°ã€é»˜è®¤å€¼ã€ä»¥åŠæ˜¯å¦åœ¨æè´¨æ£€è§†å™¨ä¸­éšè—è¯¥å±æ€§ã€‚è¿™äº›é€‰é¡¹æä¾›äº†æ›´ç²¾ç»†çš„å±æ€§ç®¡ç†èƒ½åŠ›ã€‚</p>
<p>å±æ€§åç§°çš„å‘½ååº”å½“å…·æœ‰æè¿°æ€§ä¸”ç¬¦åˆé¡¹ç›®å‘½åè§„èŒƒã€‚å¥½çš„å±æ€§åç§°èƒ½å¤Ÿè®©å…¶ä»–å›¢é˜Ÿæˆå‘˜æ›´å®¹æ˜“ç†è§£è¯¥å‚æ•°çš„ä½œç”¨ï¼Œå¦‚"_SpecularIntensity"æ¯”"_Float1"æ›´èƒ½æ¸…æ™°è¡¨è¾¾å‚æ•°ç”¨é€”ã€‚</p>
<h2 data-id="heading-5">ç”Ÿæˆçš„ä»£ç åˆ†æ</h2>
<p>ç†è§£SliderèŠ‚ç‚¹åœ¨èƒŒåç”Ÿæˆçš„ä»£ç æœ‰åŠ©äºæ›´æ·±å…¥åœ°æŒæ¡å…¶å·¥ä½œåŸç†ã€‚å½“SliderèŠ‚ç‚¹è¢«è½¬æ¢ä¸ºå±æ€§åï¼Œåœ¨ç”Ÿæˆçš„ç€è‰²å™¨ä»£ç ä¸­ä¼šäº§ç”Ÿç›¸åº”çš„æ•°æ®ç»“æ„å’Œå¤„ç†é€»è¾‘ã€‚</p>
<p><strong>åŸºç¡€å£°æ˜</strong></p>
<p>åœ¨ç€è‰²å™¨çš„Propertieså—ä¸­ï¼Œä¼šç”Ÿæˆç±»ä¼¼ä»¥ä¸‹çš„å±æ€§å£°æ˜ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">_SliderProperty</span>(<span class="hljs-string">"Slider Display Name"</span>, <span class="hljs-built_in">Range</span>(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)) = <span class="hljs-number">0.5</span>
</code></pre>
<p>è¿™é‡Œçš„"Slider Display Name"æ˜¯åœ¨æè´¨æ£€è§†å™¨ä¸­æ˜¾ç¤ºçš„åç§°ï¼ŒRange(0.0, 1.0)å®šä¹‰äº†æ»‘åŠ¨æ¡çš„èŒƒå›´ï¼Œ0.5æ˜¯é»˜è®¤å€¼ã€‚</p>
<p><strong>å˜é‡å®šä¹‰</strong></p>
<p>åœ¨CGPROGRAMéƒ¨åˆ†ï¼Œä¼šç”Ÿæˆå¯¹åº”çš„å˜é‡å£°æ˜ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-type">float</span> _SliderProperty;
</code></pre>
<p>è¿™ä¸ªå˜é‡å¯ä»¥åœ¨ç‰‡æ®µç€è‰²å™¨æˆ–å…¶ä»–è®¡ç®—éƒ¨åˆ†ç›´æ¥ä½¿ç”¨ã€‚</p>
<p><strong>é»˜è®¤å€¼å¤„ç†</strong></p>
<p>å¦‚ç¤ºä¾‹ä»£ç æ‰€ç¤ºï¼ŒSliderèŠ‚ç‚¹ç”Ÿæˆçš„é»˜è®¤å€¼è¡¨è¾¾å¼ç®€å•ç›´æ¥ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">float <span class="hljs-attr">_Slider_Out</span> = <span class="hljs-number">1.0</span><span class="hljs-comment">;</span>
</code></pre>
<p>è¿™è¡Œä»£ç åˆ›å»ºäº†ä¸€ä¸ªæµ®ç‚¹å˜é‡å¹¶å°†å…¶åˆå§‹åŒ–ä¸º1.0ã€‚åœ¨å®é™…ç”Ÿæˆçš„ç€è‰²å™¨ä¸­ï¼Œè¿™ä¸ªå€¼ä¼šè¢«æ›¿æ¢ä¸ºå±æ€§ç³»ç»Ÿä¸­å­˜å‚¨çš„å®é™…æ•°å€¼ã€‚</p>
<p><strong>æè´¨åºåˆ—åŒ–</strong></p>
<p>è½¬æ¢ä¸ºå±æ€§åï¼ŒSliderçš„å€¼ä¼šä¸æè´¨èµ„æºä¸€èµ·è¢«åºåˆ—åŒ–ï¼Œè¿™æ„å‘³ç€è®¾ç½®çš„å€¼ä¼šåœ¨ç¼–è¾‘å™¨ä¼šè¯ä¹‹é—´ä¿æŒæŒä¹…åŒ–ã€‚</p>
<h2 data-id="heading-6">å®é™…åº”ç”¨æ¡ˆä¾‹</h2>
<p>SliderèŠ‚ç‚¹åœ¨URPç€è‰²å™¨å¼€å‘ä¸­æœ‰ç€å¹¿æ³›çš„åº”ç”¨åœºæ™¯ï¼Œä»¥ä¸‹é€šè¿‡å‡ ä¸ªå…·ä½“æ¡ˆä¾‹å±•ç¤ºå…¶å®é™…ç”¨æ³•ã€‚</p>
<p><strong>åŸºç¡€é€æ˜åº¦æ§åˆ¶</strong></p>
<p>åˆ›å»ºä¸€ä¸ªç®€å•çš„é€æ˜åº¦æ§åˆ¶ç€è‰²å™¨ï¼š</p>
<ul>
<li>åœ¨Shader Graphä¸­æ·»åŠ SliderèŠ‚ç‚¹ï¼Œè®¾ç½®èŒƒå›´ä¸º0.0åˆ°1.0</li>
<li>å°†Sliderè¾“å‡ºè¿æ¥åˆ°PBRä¸»èŠ‚ç‚¹çš„Alphaè¾“å…¥</li>
<li>å°†æè´¨è¡¨é¢ç±»å‹è®¾ç½®ä¸ºTransparent</li>
<li>è¿™æ ·å°±å¯ä»¥é€šè¿‡æ»‘åŠ¨æ¡å®æ—¶è°ƒæ•´æè´¨é€æ˜åº¦</li>
</ul>
<p><strong>åŠ¨æ€é«˜å…‰è°ƒèŠ‚</strong></p>
<p>å®ç°å¯è°ƒèŠ‚çš„é«˜å…‰æ•ˆæœï¼š</p>
<ul>
<li>ä½¿ç”¨SliderèŠ‚ç‚¹æ§åˆ¶é«˜å…‰å¼ºåº¦</li>
<li>å°†Sliderè¾“å‡ºè¿æ¥åˆ°é«˜å…‰è®¡ç®—èŠ‚ç‚¹çš„å¼ºåº¦å‚æ•°</li>
<li>è®¾ç½®åˆé€‚çš„èŒƒå›´ï¼Œå¦‚0.0åˆ°3.0</li>
<li>ç»“åˆå…¶ä»–èŠ‚ç‚¹åˆ›å»ºå¤æ‚çš„é«˜å…‰å“åº”</li>
</ul>
<p><strong>çº¹ç†å˜æ¢åŠ¨ç”»</strong></p>
<p>åˆ›å»ºåŸºäºæ—¶é—´çš„çº¹ç†å˜æ¢ï¼š</p>
<ul>
<li>ä½¿ç”¨SliderèŠ‚ç‚¹æ§åˆ¶åŠ¨ç”»é€Ÿåº¦</li>
<li>å°†Sliderè¾“å‡ºä¸TimeèŠ‚ç‚¹ç›¸ä¹˜</li>
<li>ç»“æœç”¨äºé©±åŠ¨çº¹ç†åç§»æˆ–æ—‹è½¬</li>
<li>é€šè¿‡è°ƒæ•´Sliderå€¼æ§åˆ¶åŠ¨ç”»å¿«æ…¢</li>
</ul>
<p><strong>å¤šé‡SliderååŒå·¥ä½œ</strong></p>
<p>å¤æ‚æ•ˆæœé€šå¸¸éœ€è¦å¤šä¸ªSlideré…åˆï¼š</p>
<ul>
<li>ä½¿ç”¨å¤šä¸ªSliderèŠ‚ç‚¹æ§åˆ¶ä¸åŒæ–¹é¢çš„å‚æ•°</li>
<li>ä¾‹å¦‚ï¼Œä¸€ä¸ªæ§åˆ¶é¢œè‰²é¥±å’Œåº¦ï¼Œä¸€ä¸ªæ§åˆ¶å¯¹æ¯”åº¦ï¼Œä¸€ä¸ªæ§åˆ¶äº®åº¦</li>
<li>é€šè¿‡åˆç†çš„èŠ‚ç‚¹è¿æ¥å®ç°å¤æ‚çš„é¢œè‰²è°ƒæ•´æ•ˆæœ</li>
</ul>
<h2 data-id="heading-7">é«˜çº§æŠ€å·§ä¸æœ€ä½³å®è·µ</h2>
<p>æŒæ¡SliderèŠ‚ç‚¹çš„é«˜çº§ç”¨æ³•å¯ä»¥æ˜¾è‘—æå‡ç€è‰²å™¨å¼€å‘æ•ˆç‡å’Œè´¨é‡ã€‚</p>
<p><strong>èŒƒå›´ä¼˜åŒ–ç­–ç•¥</strong></p>
<p>æ ¹æ®ä½¿ç”¨åœºæ™¯ä¼˜åŒ–SliderèŒƒå›´ï¼š</p>
<ul>
<li>å¯¹äºæ„ŸçŸ¥çº¿æ€§çš„å‚æ•°ï¼ˆå¦‚é€æ˜åº¦ï¼‰ï¼Œä½¿ç”¨0-1èŒƒå›´</li>
<li>å¯¹äºæŒ‡æ•°æ€§æ„ŸçŸ¥çš„å‚æ•°ï¼ˆå¦‚å…‰ç…§å¼ºåº¦ï¼‰ï¼Œè€ƒè™‘ä½¿ç”¨0-10èŒƒå›´</li>
<li>ä½¿ç”¨é€‚å½“çš„é»˜è®¤å€¼ï¼Œå‡å°‘æ¯æ¬¡æè´¨åˆ›å»ºçš„è°ƒæ•´éœ€æ±‚</li>
</ul>
<p><strong>åˆ†ç»„ä¸ç»„ç»‡</strong></p>
<p>å½“ä½¿ç”¨å¤šä¸ªSlideræ—¶ï¼Œåˆç†çš„ç»„ç»‡å¾ˆé‡è¦ï¼š</p>
<ul>
<li>åœ¨Shader Graphä¸­ä½¿ç”¨æ³¨é‡Šæ¡†å¯¹ç›¸å…³Sliderè¿›è¡Œåˆ†ç»„</li>
<li>ä¸ºSliderå±æ€§ä½¿ç”¨ä¸€è‡´çš„å‘½åå‰ç¼€</li>
<li>åœ¨æè´¨æ£€è§†å™¨ä¸­åˆ©ç”¨å±æ€§æŠ½å±‰è¿›è¡Œé€»è¾‘åˆ†ç»„</li>
</ul>
<p><strong>æ€§èƒ½è€ƒé‡</strong></p>
<p>è™½ç„¶SliderèŠ‚ç‚¹æœ¬èº«å¯¹æ€§èƒ½å½±å“å¾ˆå°ï¼Œä½†ä½¿ç”¨æ—¶ä»éœ€æ³¨æ„ï¼š</p>
<ul>
<li>é¿å…åˆ›å»ºè¿‡å¤šä¸å¿…è¦çš„Sliderå±æ€§</li>
<li>å¯¹äºä¸éœ€è¦åœ¨è¿è¡Œæ—¶ä¿®æ”¹çš„å‚æ•°ï¼Œè€ƒè™‘ä½¿ç”¨å¸¸é‡è€Œéå±æ€§</li>
<li>åˆç†ä½¿ç”¨å±æ€§å˜ä½“ï¼Œé¿å…ä¸å¿…è¦çš„ç€è‰²å™¨å˜ä½“ç”Ÿæˆ</li>
</ul>
<p><strong>è°ƒè¯•æŠ€å·§</strong></p>
<p>SliderèŠ‚ç‚¹å¯ä»¥ç”¨äºç€è‰²å™¨è°ƒè¯•ï¼š</p>
<ul>
<li>ä¸´æ—¶è¿æ¥Slideråˆ°ä¸åŒèŠ‚ç‚¹ä»¥éš”ç¦»é—®é¢˜</li>
<li>ä½¿ç”¨Slideræ§åˆ¶è°ƒè¯•ä¿¡æ¯çš„æ˜¾ç¤ºé˜ˆå€¼</li>
<li>é€šè¿‡åŠ¨ç”»Sliderå€¼è§‚å¯Ÿæ•ˆæœå˜åŒ–ï¼Œè¯†åˆ«å¼‚å¸¸è¡Œä¸º</li>
</ul>
<h2 data-id="heading-8">å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2>
<p>åœ¨ä½¿ç”¨SliderèŠ‚ç‚¹è¿‡ç¨‹ä¸­å¯èƒ½ä¼šé‡åˆ°ä¸€äº›å…¸å‹é—®é¢˜ï¼Œä»¥ä¸‹æ˜¯å¸¸è§é—®é¢˜åŠå…¶è§£å†³æ–¹æ³•ã€‚</p>
<p><strong>æ»‘åŠ¨æ¡å“åº”ä¸çµæ•</strong></p>
<p>å½“æ»‘åŠ¨æ¡èŒƒå›´è®¾ç½®è¿‡å¤§æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°æ§åˆ¶ä¸å¤Ÿç²¾ç»†çš„é—®é¢˜ï¼š</p>
<ul>
<li>è§£å†³æ–¹æ¡ˆï¼šè°ƒæ•´Minå’ŒMaxå€¼åˆ°æ›´åˆç†çš„èŒƒå›´</li>
<li>æ›¿ä»£æ–¹æ¡ˆï¼šä½¿ç”¨ä¸¤ä¸ªSliderï¼Œä¸€ä¸ªç”¨äºç²—è°ƒï¼Œä¸€ä¸ªç”¨äºå¾®è°ƒ</li>
</ul>
<p><strong>å±æ€§ä¸æ˜¾ç¤ºåœ¨æè´¨æ£€è§†å™¨</strong></p>
<p>æœ‰æ—¶è½¬æ¢ä¸ºå±æ€§åï¼Œåœ¨æè´¨ä¸­çœ‹ä¸åˆ°å¯¹åº”çš„æ»‘åŠ¨æ¡ï¼š</p>
<ul>
<li>æ£€æŸ¥å±æ€§æ˜¯å¦è¢«æ„å¤–æ ‡è®°ä¸ºéšè—</li>
<li>ç¡®è®¤ç€è‰²å™¨ç¼–è¯‘æ²¡æœ‰é”™è¯¯</li>
<li>æ£€æŸ¥å±æ€§åç§°æ˜¯å¦åŒ…å«ç‰¹æ®Šå­—ç¬¦æˆ–ç©ºæ ¼</li>
</ul>
<p><strong>è¿è¡Œæ—¶ä¿®æ”¹ä¸ç”Ÿæ•ˆ</strong></p>
<p>é€šè¿‡è„šæœ¬ä¿®æ”¹Sliderå±æ€§å€¼ä½†æ²¡æœ‰æ•ˆæœï¼š</p>
<ul>
<li>ç¡®è®¤ä½¿ç”¨çš„æ˜¯æè´¨å±æ€§åç§°è€ŒéèŠ‚ç‚¹åç§°</li>
<li>æ£€æŸ¥æè´¨å®ä¾‹æ˜¯å¦æ­£ç¡®å¼•ç”¨</li>
<li>ç¡®è®¤åœ¨ä¿®æ”¹å±æ€§åè°ƒç”¨äº†material.SetFloatæ–¹æ³•</li>
</ul>
<p><strong>æ•°å€¼è·³è·ƒæˆ–ä¸å¹³æ»‘</strong></p>
<p>æ»‘åŠ¨æ¡ç§»åŠ¨æ—¶æ•°å€¼å˜åŒ–ä¸è¿ç»­ï¼š</p>
<ul>
<li>è¿™é€šå¸¸æ˜¯èŒƒå›´è®¾ç½®è¿‡å¤§å¯¼è‡´</li>
<li>å¯ä»¥å°è¯•å‡å°èŒƒå›´æˆ–ä½¿ç”¨å¯¹æ•°å°ºåº¦å¤„ç†</li>
</ul>
<h2 data-id="heading-9">ä¸å…¶ä»–èŠ‚ç‚¹çš„é…åˆä½¿ç”¨</h2>
<p>SliderèŠ‚ç‚¹å¾ˆå°‘å•ç‹¬ä½¿ç”¨ï¼Œæ›´å¤šçš„æ˜¯ä¸å…¶ä»–èŠ‚ç‚¹é…åˆåˆ›å»ºå¤æ‚æ•ˆæœã€‚</p>
<p><strong>ä¸æ•°å­¦èŠ‚ç‚¹é…åˆ</strong></p>
<p>SliderèŠ‚ç‚¹ä¸æ•°å­¦èŠ‚ç‚¹çš„ç»„åˆæ˜¯æœ€å¸¸è§çš„ç”¨æ³•ï¼š</p>
<ul>
<li>ä½¿ç”¨MultiplyèŠ‚ç‚¹ç¼©æ”¾Sliderè¾“å‡º</li>
<li>ä½¿ç”¨AddèŠ‚ç‚¹åç§»SlideråŸºå‡†å€¼</li>
<li>ä½¿ç”¨PowerèŠ‚ç‚¹åˆ›å»ºéçº¿æ€§å“åº”</li>
<li>ä½¿ç”¨ClampèŠ‚ç‚¹é™åˆ¶æœ€ç»ˆè¾“å‡ºèŒƒå›´</li>
</ul>
<p><strong>ä¸çº¹ç†èŠ‚ç‚¹ç»“åˆ</strong></p>
<p>é€šè¿‡Slideræ§åˆ¶çº¹ç†å‚æ•°ï¼š</p>
<ul>
<li>æ§åˆ¶çº¹ç†å¹³é“ºæ¬¡æ•°</li>
<li>è°ƒæ•´çº¹ç†æ··åˆæƒé‡</li>
<li>æ§åˆ¶æ³•çº¿å¼ºåº¦</li>
<li>è°ƒèŠ‚è§†å·®é®æŒ¡æ˜ å°„å¼ºåº¦</li>
</ul>
<p><strong>ä¸æ—¶é—´èŠ‚ç‚¹ååŒ</strong></p>
<p>åˆ›å»ºåŠ¨æ€æ•ˆæœï¼š</p>
<ul>
<li>æ§åˆ¶åŠ¨ç”»é€Ÿåº¦</li>
<li>è°ƒèŠ‚è„‰å†²é¢‘ç‡</li>
<li>ç®¡ç†è¿‡æ¸¡æŒç»­æ—¶é—´</li>
<li>æ§åˆ¶æ•ˆæœè§¦å‘æ—¶æœº</li>
</ul>
<hr/>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong>
ï¼ˆæ¬¢è¿<em>ç‚¹èµç•™è¨€</em>æ¢è®¨ï¼Œæ›´å¤šäººåŠ å…¥è¿›æ¥èƒ½æ›´åŠ å®Œå–„è¿™ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ï¼ŒğŸ™ï¼‰</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Pythonæ•°æ®å¤„ç†æé€Ÿ50%ï¼š5ä¸ªè¢«ä½ä¼°çš„PandasæŠ€å·§ğŸ”¥]]></title>    <link>https://juejin.cn/post/7595974133097627682</link>    <guid>https://juejin.cn/post/7595974133097627682</guid>    <pubDate>2026-01-18T04:22:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595974133097627682" data-draft-id="7595893785907527714" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Pythonæ•°æ®å¤„ç†æé€Ÿ50%ï¼š5ä¸ªè¢«ä½ä¼°çš„PandasæŠ€å·§ğŸ”¥"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-18T04:22:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Pythonæ•°æ®å¤„ç†æé€Ÿ50%ï¼š5ä¸ªè¢«ä½ä¼°çš„PandasæŠ€å·§ğŸ”¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T04:22:51.000Z" title="Sun Jan 18 2026 04:22:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>Pythonæ•°æ®å¤„ç†æé€Ÿ50%ï¼š5ä¸ªè¢«ä½ä¼°çš„PandasæŠ€å·§ğŸ”¥</strong></h2>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>åœ¨æ•°æ®ç§‘å­¦å’Œæœºå™¨å­¦ä¹ é¢†åŸŸï¼ŒPandasæ— ç–‘æ˜¯Pythonç”Ÿæ€ç³»ç»Ÿä¸­æœ€å¼ºå¤§çš„æ•°æ®å¤„ç†å·¥å…·ä¹‹ä¸€ã€‚ç„¶è€Œï¼Œéšç€æ•°æ®é‡çš„å¢é•¿ï¼Œè®¸å¤šå¼€å‘è€…å‘ç°ä»–ä»¬çš„Pandasä»£ç è¿è¡Œé€Ÿåº¦é€æ¸æˆä¸ºç“¶é¢ˆã€‚äº‹å®ä¸Šï¼Œ90%çš„æ€§èƒ½é—®é¢˜å¹¶éæ¥è‡ªPandasæœ¬èº«ï¼Œè€Œæ˜¯ç”±äºæœªèƒ½å……åˆ†åˆ©ç”¨å…¶é«˜çº§åŠŸèƒ½ã€‚</p>
<p>æœ¬æ–‡æ­ç¤ºäº†5ä¸ªè¢«ä¸¥é‡ä½ä¼°çš„PandasæŠ€å·§ï¼Œè¿™äº›æ–¹æ³•åœ¨å®è·µä¸­å¯ä»¥å°†å…¸å‹æ•°æ®å¤„ç†ä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´å‡å°‘50%ç”šè‡³æ›´å¤šã€‚è¿™äº›æŠ€æœ¯æºè‡ªçœŸå®çš„ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–ç»éªŒï¼Œç»è¿‡äº†å¤§è§„æ¨¡æ•°æ®é›†ï¼ˆGBåˆ°TBçº§ï¼‰çš„éªŒè¯ã€‚</p>
<h2 data-id="heading-2">1. ä½¿ç”¨<code>eval()</code>å’Œ<code>query()</code>è¿›è¡Œè¡¨è¾¾å¼ä¼˜åŒ–</h2>
<h3 data-id="heading-3">é—®é¢˜èƒŒæ™¯</h3>
<p>ä¼ ç»Ÿçš„æ•°æ®æ¡†æ“ä½œä¼šåˆ›å»ºå¤šä¸ªä¸­é—´å¯¹è±¡ï¼Œè¿™åœ¨å¤„ç†å¤§å‹DataFrameæ—¶ä¼šå¯¼è‡´æ˜¾è‘—çš„å†…å­˜å¼€é”€å’Œè®¡ç®—å»¶è¿Ÿã€‚</p>
<h3 data-id="heading-4">è§£å†³æ–¹æ¡ˆ</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä¼ ç»Ÿæ–¹å¼ (æ…¢)</span>
df[<span class="hljs-string">'new_col'</span>] = df[<span class="hljs-string">'col1'</span>] + df[<span class="hljs-string">'col2'</span>] * df[<span class="hljs-string">'col3'</span>]

<span class="hljs-comment"># ä¼˜åŒ–æ–¹å¼ (å¿«50-70%)</span>
df.<span class="hljs-built_in">eval</span>(<span class="hljs-string">'new_col = col1 + col2 * col3'</span>, inplace=<span class="hljs-literal">True</span>)
</code></pre>
<h3 data-id="heading-5">æŠ€æœ¯åŸç†</h3>
<p><code>eval()</code>ä½¿ç”¨NumExpråº“è¿›è¡Œè¡¨è¾¾å¼æ±‚å€¼ï¼š</p>
<ul>
<li>é¿å…ä¸­é—´å¯¹è±¡çš„åˆ›å»º</li>
<li>è‡ªåŠ¨å¹¶è¡ŒåŒ–è®¡ç®—</li>
<li>ä¼˜åŒ–CPUç¼“å­˜åˆ©ç”¨ç‡</li>
</ul>
<h3 data-id="heading-6">è¿›é˜¶æŠ€å·§</h3>
<p>ç»“åˆ<code>query()</code>å®ç°å¿«é€Ÿè¿‡æ»¤ï¼š</p>
<pre><code class="hljs language-python" lang="python">fast_filter = df.query(<span class="hljs-string">'col1 &gt; 0.5 &amp; col2 &lt; 100'</span>)
</code></pre>
<h2 data-id="heading-7">2. Categoryç±»å‹çš„æ­£ç¡®ä½¿ç”¨å§¿åŠ¿</h2>
<h3 data-id="heading-8">å¸¸è§è¯¯åŒº</h3>
<p>å¤šæ•°å¼€å‘è€…ä»…åœ¨å¤„ç†æ˜æ˜¾åˆ†ç±»æ•°æ®ï¼ˆå¦‚æ€§åˆ«ã€çœä»½ï¼‰æ—¶æ‰ä½¿ç”¨categoryç±»å‹ã€‚</p>
<h3 data-id="heading-9">æ€§èƒ½çªç ´ç‚¹</h3>
<p>ä»»ä½•åŸºæ•°(cardinality)å°äºæ€»è¡Œæ•°50%çš„åˆ—éƒ½åº”è€ƒè™‘è½¬æ¢ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å†…å­˜å‡å°‘90%ï¼Œæ“ä½œåŠ é€Ÿ3xçš„ä¾‹å­</span>
df[<span class="hljs-string">'department'</span>] = df[<span class="hljs-string">'department'</span>].astype(<span class="hljs-string">'category'</span>)
</code></pre>
<h3 data-id="heading-10">åº•å±‚æœºåˆ¶</h3>
<ul>
<li>Categoryä½¿ç”¨æ•´æ•°ç¼–ç å­˜å‚¨</li>
<li>Groupby/æ’åºæ“ä½œç›´æ¥æ¯”è¾ƒç¼–ç å€¼è€Œéå­—ç¬¦ä¸²</li>
<li>memory usageä»O(n)é™è‡³O(k)ï¼Œkä¸ºå”¯ä¸€å€¼æ•°é‡</li>
</ul>
<h2 data-id="heading-11">3. Chunk Processingæ¨¡å¼å¤„ç†è¶…å¤§æ•°æ®é›†</h2>
<h3 data-id="heading-12">RAMå—é™æ—¶çš„æ•‘æ˜Ÿ</h3>
<p>å½“æ•°æ®é‡è¶…è¿‡å¯ç”¨å†…å­˜æ—¶ï¼Œä¼ ç»Ÿçš„ä¸€æ¬¡æ€§è¯»å–ä¼šå¯¼è‡´å´©æºƒã€‚</p>
<h3 data-id="heading-13">Chunkingæ¨¡æ¿ä»£ç </h3>
<pre><code class="hljs language-python" lang="python">chunk_size = <span class="hljs-number">100000</span> 
result = []

<span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> pd.read_csv(<span class="hljs-string">'huge_file.csv'</span>, chunksize=chunk_size):
    processed = chunk_preprocessing(chunk)
    result.append(processed)
    
final_df = pd.concat(result)
</code></pre>
<h3 data-id="heading-14">Pro Tip: Daské›†æˆ</h3>
<p>å¯¹äºåˆ†å¸ƒå¼ç¯å¢ƒï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> dask.dataframe <span class="hljs-keyword">as</span> dd
ddf = dd.read_csv(<span class="hljs-string">'s3://bucket/*.csv'</span>) 
</code></pre>
<h2 data-id="heading-15">4. Multi-indexæ“ä½œçš„éšè—å¨åŠ›</h2>
<h3 data-id="heading-16">Beyondç®€å•åˆ†å±‚ç´¢å¼•</h3>
<p>Multi-indexå¯ä»¥æ›¿ä»£è®¸å¤šä½æ•ˆçš„groupby-filterç»„åˆæ“ä½œã€‚</p>
<h3 data-id="heading-17">O(1)æŸ¥è¯¢æ¨¡å¼ç¤ºä¾‹</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Setupå¤šå±‚ç´¢å¼•ï¼ˆæ³¨æ„é¡ºåºï¼ï¼‰</span>
df_multi = df.set_index([<span class="hljs-string">'region'</span>, <span class="hljs-string">'date'</span>]).sort_index()

<span class="hljs-comment"># Lightning-fastæŸ¥è¯¢ï¼ˆæ— éœ€æ‰«æå…¨è¡¨ï¼‰</span>
asia_q1 = df_multi.loc[(<span class="hljs-string">'Asia'</span>, <span class="hljs-built_in">slice</span>(<span class="hljs-string">'2020-01'</span>,<span class="hljs-string">'2020-03'</span>)), :]
</code></pre>
<h3 data-id="heading-18">JoinåŠ é€ŸæŠ€å·§ï¼šIndexå¯¹é½é­”æ³•</h3>
<p>é¢„å…ˆè®¾ç½®åŒ¹é…ç´¢å¼•å¯ä½¿mergeæ“ä½œæé€Ÿ10å€ï¼š</p>
<pre><code class="hljs language-python" lang="python">df1.set_index(<span class="hljs-string">'key'</span>).join(df2.set_index(<span class="hljs-string">'key'</span>))
</code></pre>
<h2 data-id="heading-19">5. NumbaåŠ é€Ÿè‡ªå®šä¹‰å‡½æ•°</h2>
<h3 data-id="heading-20">UDFçš„æ€§èƒ½ç—›ç‚¹</h3>
<p>ä¼ ç»Ÿçš„<code>apply(func)</code>åœ¨å¤„ç†å¤æ‚é€»è¾‘æ—¶æå…¶ç¼“æ…¢ã€‚</p>
<h3 data-id="heading-21">Numba-JITè§£å†³æ–¹æ¡ˆ</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> numba <span class="hljs-keyword">import</span> jit  

<span class="hljs-meta">@jit(<span class="hljs-params">nopython=<span class="hljs-literal">True</span></span>)  </span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">custom_math</span>(<span class="hljs-params">x, y</span>):  
    <span class="hljs-keyword">return</span> (x**<span class="hljs-number">2</span> + y**<span class="hljs-number">3</span>) / (x + y + eps)  

df[<span class="hljs-string">'result'</span>] = custom_math(df[<span class="hljs-string">'a'</span>].values, df[<span class="hljs-string">'b'</span>].values)  
</code></pre>
<h3 data-id="heading-22">Benchmarkså¯¹æ¯”</h3>

























<table><thead><tr><th>Method</th><th>Time (ms)</th><th>Speedup</th></tr></thead><tbody><tr><td>Plain apply</td><td>1200</td><td>-</td></tr><tr><td>Vectorized</td><td><strong>450</strong></td><td>~2.7x</td></tr><tr><td>Numba-JIT</td><td><strong>150</strong></td><td>~8x</td></tr></tbody></table>
<h2 data-id="heading-23">Bonus: Memory Optimizationç»ˆææŒ‡å—</h2>
<p>å³ä½¿åº”ç”¨äº†ä¸Šè¿°æ‰€æœ‰æŠ€å·§ä»é‡å†…å­˜é—®é¢˜æ—¶ï¼š</p>
<ol>
<li>
<p><strong>ç²¾ç¡®æ§åˆ¶æ•°æ®ç±»å‹</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python">dtype_map = {
    <span class="hljs-string">'id'</span>: <span class="hljs-string">'uint32'</span>,
    <span class="hljs-string">'price'</span>: <span class="hljs-string">'float32'</span>,
    <span class="hljs-string">'flag'</span>: <span class="hljs-string">'bool'</span>
}
</code></pre>
</li>
<li>
<p><strong>Sparse Dataç»“æ„</strong>ï¼šé€‚åˆ99%ç©ºå€¼çš„ç‰¹å¾çŸ©é˜µ</p>
</li>
<li>
<p><strong>Downcastingè‡ªåŠ¨åŒ–å·¥å…·</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">auto_downcast</span>(<span class="hljs-params">df</span>):
    <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> df.select_dtypes(include=[<span class="hljs-string">'float64'</span>]): 
        df[col] = pd.to_numeric(df[col], downcast=<span class="hljs-string">'float'</span>)
    <span class="hljs-keyword">return</span> df   
</code></pre>
</li>
</ol>
<h2 data-id="heading-24">Conclusion</h2>
<p>é«˜æ•ˆçš„æ•°æ®å¤„ç†ä¸æ˜¯å…³äºç¼–å†™æ›´å¤æ‚çš„ä»£ç ï¼Œè€Œæ˜¯æ·±å…¥äº†è§£å·¥å…·çš„å†…åœ¨èƒ½åŠ›ã€‚è¿™äº›æŠ€æœ¯ç»„åˆä½¿ç”¨æ—¶ç»å¸¸äº§ç”ŸååŒæ•ˆåº”â€”â€”ä¾‹å¦‚å°†Categoryç±»å‹ä¸Multi-indexç»“åˆå¯ä»¥åœ¨åˆ†ç»„èšåˆä¸­è·å¾—100å€çš„æ€§èƒ½æå‡ã€‚å…³é”®åœ¨äºæ ¹æ®æ•°æ®çš„å®é™…ç‰¹å¾é€‰æ‹©æ°å½“çš„ç»„åˆç­–ç•¥ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ†äº«è‡ªç ”çš„è½»é‡çº§çŠ¶æ€æœºæµç¨‹å¼•æ“]]></title>    <link>https://juejin.cn/post/7595960824485838882</link>    <guid>https://juejin.cn/post/7595960824485838882</guid>    <pubDate>2026-01-18T04:41:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595960824485838882" data-draft-id="7414302238988926985" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ†äº«è‡ªç ”çš„è½»é‡çº§çŠ¶æ€æœºæµç¨‹å¼•æ“"/> <meta itemprop="keywords" content="åç«¯,æ¶æ„,å¼€æº"/> <meta itemprop="datePublished" content="2026-01-18T04:41:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æš®è‰²å¦–å¨†ä¸¶"/> <meta itemprop="url" content="https://juejin.cn/user/4292946760307655"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ†äº«è‡ªç ”çš„è½»é‡çº§çŠ¶æ€æœºæµç¨‹å¼•æ“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4292946760307655/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æš®è‰²å¦–å¨†ä¸¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T04:41:50.000Z" title="Sun Jan 18 2026 04:41:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>è¿˜è®°å¾—åˆšå…¥èŒçš„æ—¶å€™ï¼Œçœ‹åˆ°ä»£ç é‡Œé¢ä¸€å † <code>xml</code> é…ç½®çš„æµç¨‹èŠ‚ç‚¹ï¼Œå¦‚ä¸‹å›¾</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e72b3c78efef42029809908a093e85fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769316110&amp;x-signature=t92PaKLF8g%2Bx3S0rq6zZqqoDCJs%3D" alt="image.png" loading="lazy"/></p>
<p>æˆ‘è¿˜åæ§½ä¸€ä¸ªå€Ÿæ¬¾/è¿˜æ¬¾æµç¨‹ä¸ºä»€ä¹ˆè¦æè¿™ä¹ˆå¤æ‚ï¼Ÿè€è€å®å®çš„å†™ <code>Java</code> ä»£ç ä¸å¥½å—ï¼ŒèŠ±é‡Œèƒ¡å“¨çš„ã€‚ç°åœ¨å›æƒ³èµ·æ¥ï¼Œåªèƒ½è¯´å½“æ—¶çš„æˆ‘è¿˜æ˜¯å¤ªå¹´è½»ï¼ŒçœŸé¦™å®šå¾‹ <code>YYDS</code>ï¼Œè§è¯†è¿‡å¤šç§å¤šæ ·çš„èµ„é‡‘æ–¹ä¹‹åï¼Œæ…¢æ…¢çš„æˆ‘æ‰é€æ¸ä½“ä¼šåˆ° <code>çŠ¶æ€æœº+æµç¨‹å¼•æ“</code> çš„ç²¾é«“ã€‚å®ƒçœŸçš„æ˜¯å°è´·æ ¸å¿ƒäº¤æ˜“ä¸šåŠ¡çš„æ²»ç—…è‰¯è¯ï¼</p>
<blockquote>
<p>åæ¥æ‰çŸ¥é“è¿™ä¸ªç»„ä»¶æ˜¯æˆ‘ä»¬ CTO äº²è‡ªç ”å‘çš„~~~</p>
</blockquote>
<h2 data-id="heading-1">é•¿æµç¨‹ä¸šåŠ¡åœºæ™¯</h2>
<p>å…ˆç®€å•ä»‹ç»ä¸‹æˆ‘çš„é¡¹ç›®ç»„ä¸šåŠ¡ï¼Œé‡‘èå°è´·å¹³å°ï¼Œä»¥è¿˜æ¬¾æµç¨‹ä¸ºä¾‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f35aa878744944ee9e39bd6e6c379567~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769316110&amp;x-signature=Nt%2Bc5E1lzwPp1%2FD0f8Jz1us5Kf4%3D" alt="image.png" loading="lazy"/></p>
<p>åˆ†ä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯ç”¨æˆ·æäº¤è¿˜æ¬¾ç”³è¯·ï¼Œç¬¬äºŒæ­¥æ˜¯æ”¯ä»˜å¯†ç æ ¡éªŒç¡®è®¤è¿˜æ¬¾ï¼Œä»é“¶è¡Œå¡æ‰£æ¬¾ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ•´ä¸ªè¿˜æ¬¾æµç¨‹æ˜¯å¾ˆé•¿çš„ï¼Œè¦å¤„ç†çš„ä¸šåŠ¡é€»è¾‘éå¸¸å¤šï¼Œå½“ç„¶è¿™å¹¶ä¸ä»£è¡¨æˆ‘ä»¬ä¸èƒ½ç”¨çº¯ <code>Java</code> ä»£ç çš„æ–¹å¼æ¥å®ç°ï¼Œä½†æ˜¯å®ƒä¼¼ä¹å¹¶ä¸æ˜¯æœ€ä¼˜è§£ã€‚</p>
<p>ä¸€ä¸ªæœ€è‡´å‘½çš„é—®é¢˜ï¼Œè¿™ä¹ˆé•¿çš„æµç¨‹ï¼Œä¸‡ä¸€ä¸­é—´æŸä¸ªç¯èŠ‚å‡ºç°äº†é—®é¢˜ï¼Œå¯¼è‡´æµç¨‹å¼‚å¸¸ï¼Œè¯¥å¦‚ä½•å¤„ç†ï¼Ÿå›æ»šäº‹åŠ¡æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºå¾ˆå¤šèŠ‚ç‚¹å¹¶ä¸æ˜¯æˆ‘ä»¬èƒ½æ§åˆ¶çš„ï¼Œæ¯”å¦‚æµç¨‹ä¸€ç›´æ­£å¸¸ï¼Œèµ°åˆ°èµ„æ–¹æ‰£æ¬¾ï¼Œèµ„æ–¹æ‰£æ¬¾æˆåŠŸäº†ï¼Œç„¶åé€šçŸ¥æˆ‘ä»¬çš„ç»“æœæ˜¯æ‰£æ¬¾å¤±è´¥ï¼Œæˆ‘ä»¬çš„æµç¨‹æŒ‰ç…§å¤±è´¥å¤„ç†äº†ã€‚ç„¶åç”¨æˆ·å‘ç°è‡ªå·±é“¶è¡Œå¡æ‰£äº†é’±ï¼Œè´¦å•æ²¡æœ‰æ ¸é”€ï¼Œè¿˜æ¬¾å•æ˜¯å¤±è´¥ï¼Œåˆ†åˆ†é’ŸæŠ•è¯‰ç”µè¯å°±æ‰“è¿‡æ¥äº†ã€‚</p>
<p>æ­¤æ—¶æˆ‘ä»¬å°±éœ€è¦ä¿®å¤æµç¨‹ï¼Œæˆ‘ä»¬ä¸å¯èƒ½ä»æ•°æ®åº“çš„è§’åº¦å¯¹é”™è¯¯æµç¨‹é€ æˆçš„ä¸šåŠ¡æ•°æ®æ¯å¼ è¡¨æŒ¨ä¸ªå»ä¿®ï¼Œæ•ˆç‡å¤ªä½äº†ï¼Œæ­£ç¡®çš„æ–¹å¼æ˜¯æˆ‘ä»¬æ‰¾åˆ°èµ„æ–¹ç»“æœå›è°ƒçš„å…¥å£ï¼Œç”¨æ­£ç¡®çš„å‚æ•°é‡æ–°è°ƒç”¨ä¸€ä¸‹ã€‚å½“ç„¶æˆ‘ä»¬å¯ä»¥å°†ä¸šåŠ¡æ–¹æ³•çš„ç²’åº¦åˆ†çš„è¶³å¤Ÿç»†ï¼Œç„¶åå°†è¿™äº›æ–¹æ³•å…¨éƒ½æš´éœ² <code>API</code> æ¥å£/åŠŸèƒ½ï¼Œå½“å‡ºç°å¼‚å¸¸æƒ…å†µéœ€è¦é‡æ–°ä»æŸä¸ªä¸šåŠ¡ç¯èŠ‚å†æ¬¡æ‰§è¡Œæ—¶ï¼Œæˆ‘ä»¬æ‰‹åŠ¨è°ƒç”¨æ‰€æœ‰çš„ <code>API</code> æ¥å£ ï¼Œä½†æ˜¯è¿˜æ˜¯é‚£å¥è¯ï¼Œå®ƒä¸æ˜¯æœ€ä¼˜è§£ï¼Œæˆ–è€…è¯´è¿™ç§æ–¹å¼å¹¶ä¸å‹å¥½ã€‚<strong>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå·¥å…·ï¼Œè®©æˆ‘ä»¬å¯ä»¥æŠŠæµç¨‹é‡ç½®åˆ°ä»»æ„ä¸€ä¸ªä»£ç èŠ‚ç‚¹ä½ç½®ï¼Œç»§ç»­è¿è¡Œã€‚</strong></p>
<h2 data-id="heading-2">çŠ¶æ€æœº &amp; æµç¨‹å¼•æ“ç®€ä»‹</h2>
<p>æœ‰é™çŠ¶æ€è‡ªåŠ¨æœºï¼Œç®€ç§°çŠ¶æ€æœºï¼Œæ˜¯è¡¨ç¤ºæœ‰é™ä¸ªçŠ¶æ€ä»¥åŠåœ¨è¿™äº›çŠ¶æ€ä¹‹é—´çš„è½¬ç§»å’ŒåŠ¨ä½œç­‰è¡Œä¸ºçš„æ•°å­¦è®¡ç®—æ¨¡å‹ã€‚è¿™æ˜¯ç»´åŸºç™¾ç§‘ç»™å‡ºçš„æ¦‚å¿µï¼Œå°†å®ƒåº”ç”¨åˆ°å®è·µä¸­ï¼Œå°±æ˜¯ä¸€ä¸ªä¸šåŠ¡æµç¨‹å®ƒé€šå¸¸æ˜¯æœ‰å¾ˆå¤šçŠ¶æ€èŠ‚ç‚¹çš„ï¼Œåœ¨ä¸€ä¸ªçŠ¶æ€å¹²ä¸€ä»¶äº‹ï¼Œå¹²å®Œä¹‹åè½¬åˆ°å¦ä¸€ä¸ªçŠ¶æ€ï¼Œå¹²å¦ä¸€ä»¶äº‹ï¼Œç»å†è¿‡å¤šæ¬¡çŠ¶æ€çš„è½¬å˜ä¹‹åè¿æ¥ä¸€ä¸ªç»ˆæ€ï¼Œä»£è¡¨è¿™ä¸ªæµç¨‹çš„ç»“æŸã€‚</p>
<p>æ‰€ä»¥çŠ¶æ€æœºé€šå¸¸å’Œæµç¨‹å¼•æ“æ˜¯ç­‰ä»·çš„ï¼Œåº”è¯¥è¯´æµç¨‹å¼•æ“æ˜¯ä»¥çŠ¶æ€æœºä¸ºåŸºç¡€çš„ã€‚</p>
<blockquote>
<p>æˆ‘äº†è§£äº†ä¸€ä¸‹ Spring çš„çŠ¶æ€æœºï¼Œå‘ç°å®ƒåº”å¯¹æˆ‘ä¸Šé¢é•¿æµç¨‹çš„ä¸šåŠ¡åœºæ™¯ï¼Œä¼¼ä¹å¹¶ä¸å®Œç¾ï¼Œæˆ‘è§‰å¾—å®ƒç¼ºå°‘æµç¨‹åŒ–çš„ä¸œè¥¿ï¼Œå¹¶ä¸”ä¸æ˜¯å¾ˆå¥½ä¸Šæ‰‹ã€‚</p>
</blockquote>
<h2 data-id="heading-3">Getting Started</h2>
<p><code>li-flow</code> æ˜¯å‚è€ƒçŠ¶æ€æœºçš„æ¦‚å¿µè®¾è®¡çš„ä¸€ä¸ªç®€å•çš„æµç¨‹å¼•æ“ï¼Œä¸‹é¢æˆ‘ä»¬æ¥ä»‹ç»æ€æ ·ä½¿ç”¨å®ƒï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥ä¸‹è½½ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fyanzhisishui%2Fli-flow-engine-demo" target="_blank" title="https://github.com/yanzhisishui/li-flow-engine-demo" ref="nofollow noopener noreferrer">æºç demo</a>ã€‚å‚è€ƒç¤ºä¾‹ä½¿ç”¨ï¼Œæ¡†æ¶æºç å·²åˆ†äº«åˆ° Github <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fyanzhisishui%2Fli-flow-engine" target="_blank" title="https://github.com/yanzhisishui/li-flow-engine" ref="nofollow noopener noreferrer">li-flow-springboot-starter</a>ã€‚</p>
<blockquote>
<p>ç”±äºè¿™ä¸ªç»„ä»¶æ˜¯å…¬å¸çš„è´¢äº§ï¼Œæ‰€ä»¥æºç æš‚æ—¶ä¸èƒ½å…¬å¼€ï¼Œå³ä½¿æˆ‘åŸºäºè¿™ä¸ªæ€è·¯å®Œå…¨é‡æ„äº†è¿™ä¸ªç»„ä»¶çš„ä»£ç ï¼Œä½†æ˜¯è€ƒè™‘åˆ°æ³•å¾‹æ³•è§„ç›®å‰è¿˜æ˜¯ä»…åˆ†äº«å¼€å‘æ€è·¯ï¼Œå…¶å®ä»£ç å¾ˆç®€å•ï¼Œ<strong>æ ¸å¿ƒæ€è·¯å°±æ˜¯åœ¨å†…å­˜ä¸­ç»´æŠ¤ä¸€ä¸ªæµç¨‹ç»“æ„</strong></p>
</blockquote>
<h3 data-id="heading-4">å¼•å…¥ starter</h3>
<p>ç”±äºå®ƒå¹¶ä¸åœ¨ <code>Maven</code> ä¸­å¤®ä»“åº“ã€‚æ‰€ä»¥éœ€è¦ä¸‹è½½ <code>li-flow</code> æºç ï¼Œ<code>Maven install</code> ä¹‹ååœ¨ä½ çš„é¡¹ç›®ä¸­å¼•å…¥åæ ‡ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.li.flow<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>li-flow-engine-springboot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>  
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h3 data-id="heading-5">å®ç°äº¤æ˜“å·ç”Ÿæˆç­–ç•¥</h3>
<p>äº¤æ˜“å·æ˜¯è´¯ç©¿æ•´ä¸ªçŠ¶æ€æœºç”Ÿå‘½å‘¨æœŸçš„é‡è¦å­—æ®µï¼ŒåŒæ—¶è¦ä¿è¯äº¤æ˜“å·çš„å”¯ä¸€æ€§ã€‚éœ€è¦å®ç°å†…ç½®çš„ <code>TxnIdGenerator</code> æ¥å£ï¼Œå®ç°æˆ‘ä»¬äº¤æ˜“å·çš„ç”Ÿæˆé€»è¾‘ã€‚å¯ä»¥å‚è€ƒ  <a href="https://juejin.cn/post/7454449782964289545" target="_blank" title="https://juejin.cn/post/7454449782964289545">ä¸šåŠ¡äº¤æ˜“å·çš„ç”Ÿæˆæ–¹å¼â€”â€”å·æ®µ</a></p>
<pre><code class="hljs language-java" lang="java">   <span class="hljs-comment">/**
     * äº¤æ˜“å·ç”Ÿæˆé€»è¾‘
     * */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> TxnIdGenerator <span class="hljs-title function_">txnIdGenerator</span><span class="hljs-params">()</span>{
        <span class="hljs-keyword">return</span> (txnType, obj) -&gt; {
            <span class="hljs-keyword">if</span> (txnType.equals(TxnType.REPAY)) {
                <span class="hljs-comment">//æ¨¡æ‹Ÿäº¤æ˜“å·ç”Ÿæˆç­–ç•¥ï¼ˆæ ¹æ®ä¸šåŠ¡è‡ªå·±å®ç°ï¼‰</span>
                <span class="hljs-keyword">return</span> <span class="hljs-string">"TQYHK"</span> + UUID.randomUUID().toString().replace(<span class="hljs-string">"-"</span>, <span class="hljs-string">""</span>);
            }
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"æœªçŸ¥çš„äº¤æ˜“ç±»å‹"</span>);
        };
    }
</code></pre>
<p>è¿™é‡Œçš„äº¤æ˜“ç±»å‹ <code>TxnType</code> éœ€è¦å®ç°å†…ç½®æ¥å£ <code>FlowTxnType</code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">TxnType</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">FlowTxnType</span> {
    REPAY;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">txnType</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.name();
    }
}
</code></pre>
<h3 data-id="heading-6">å®šä¹‰æµç¨‹ä¸Šä¸‹æ–‡</h3>
<p>éœ€è¦å®šä¹‰ä¸€ä¸ªå®ç°å†…ç½®æ¥å£ <code>FlowTxnContext</code> çš„å®ç°ç±»</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RepayFlowContext</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractFlowTxnContext</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">FlowTxnContext</span> {

    <span class="hljs-comment">/**
     * äº¤æ˜“ï¼ˆäº¤æ˜“æµç¨‹ä¸»è¡¨ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> CashRepayApply repayApply;

    <span class="hljs-comment">/**
     * å­—æ®µåç§°
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;String&gt; fieldNameList;

    <span class="hljs-comment">/**
     * ç”³è¯·dao
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> CashRepayApplyMapper cashRepayApplyDao;

    <span class="hljs-comment">/**
     * æ–°å¢ã€ä¿®æ”¹æ ‡è®°
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> newFlag;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">RepayFlowContext</span><span class="hljs-params">(String applyNo, CashRepayApplyMapper repayApplyDao, <span class="hljs-type">boolean</span> newFlag)</span> {
        <span class="hljs-built_in">this</span>.cashRepayApplyDao = repayApplyDao;
        <span class="hljs-built_in">this</span>.newFlag = newFlag;
        <span class="hljs-keyword">if</span> (!newFlag) {
            repayApply = repayApplyDao.get(applyNo);
        } <span class="hljs-keyword">else</span> {
            repayApply = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CashRepayApply</span>();
            repayApply.setApplyNo(applyNo);
        }
        fieldNameList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(ReflectUtil.getAllFields(CashRepayApply.class).keySet());
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getTxnId</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> repayApply.getApplyNo();
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getValue</span><span class="hljs-params">(String fieldName)</span> {
        <span class="hljs-keyword">if</span> (fieldNameList.contains(fieldName)) {
            <span class="hljs-keyword">return</span> ReflectUtil.getFieldValue(repayApply, fieldName);
        }
        <span class="hljs-comment">// å¦‚æœä¸æ˜¯ä¸šåŠ¡å®ä½“å­—æ®µï¼Œåˆ™ä»æ‰©å±•å­—æ®µä¸­è·å–</span>
        <span class="hljs-keyword">return</span> MapUtil.get(repayApply.getExtAttrMap(), fieldName);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setValue</span><span class="hljs-params">(String fieldName, Object obj)</span> {
        <span class="hljs-keyword">if</span> (obj == <span class="hljs-literal">null</span> &amp;&amp; getValue(fieldName) == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-keyword">if</span> (fieldNameList.contains(fieldName)) {
            ReflectUtil.setFieldValue(repayApply, fieldName,obj);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// å¦‚æœä¸æ˜¯ä¸šåŠ¡å®ä½“å­—æ®µï¼Œåˆ™ç›´æ¥ä¿å­˜åˆ°æ‰©å±•å­—æ®µé‡Œé¢</span>
            repayApply.addExtAttr(fieldName, obj);
        }
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">save</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (newFlag) {
            repayApply.setCrtTime(LocalDateTime.now());
            repayApply.setUptTime(LocalDateTime.now());
            cashRepayApplyDao.insert(repayApply);
            newFlag = <span class="hljs-literal">false</span>;
        } <span class="hljs-keyword">else</span> {
            repayApply.setUptTime(LocalDateTime.now());
            cashRepayApplyDao.updateById(repayApply);
        }
    }
}
</code></pre>
<p>è¿™ä¸ªä½œç”¨æ˜¯åœ¨æ¯ä¸€ä¸ª <code>&lt;li-flow:state&gt;</code> ç»“æŸæ—¶ï¼Œå°†æœ¬æ¬¡å¯¹äº¤æ˜“æ•°æ®çš„æ”¹åŠ¨æ›´æ–°åˆ°æ•°æ®åº“ã€‚</p>
<h3 data-id="heading-7">å®ç°æµç¨‹ä¸Šä¸‹æ–‡å·¥å‚</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RepayFlowContextFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">FlowTxnContextFactory</span> {
	<span class="hljs-meta">@Autowired</span>
	<span class="hljs-keyword">private</span> CashRepayApplyMapper cashRepayApplyMapper;
	<span class="hljs-comment">/**
	 * äº¤æ˜“ç±»å‹
	 * */</span>
	<span class="hljs-meta">@Override</span>
	<span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">support</span><span class="hljs-params">(FlowTxnType type)</span> {
		<span class="hljs-keyword">return</span> TxnType.REPAY.equals(type);
	}

	<span class="hljs-meta">@Override</span>
	<span class="hljs-keyword">public</span> FlowTxnContext <span class="hljs-title function_">newTxnContext</span><span class="hljs-params">(  String repayApplyNo, Object... paras)</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RepayFlowContext</span>(repayApplyNo, cashRepayApplyMapper, <span class="hljs-literal">true</span>);
	}

	<span class="hljs-meta">@Override</span>
	<span class="hljs-keyword">public</span> FlowTxnContext <span class="hljs-title function_">loadTxnContext</span><span class="hljs-params">( String applyCode)</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RepayFlowContext</span>(applyCode, cashRepayApplyMapper, <span class="hljs-literal">false</span>);
	}

}
</code></pre>
<h3 data-id="heading-8">å®šä¹‰æµç¨‹ xml æ–‡ä»¶</h3>
<p>æ–‡ä»¶å <code>cash-mas-repay-flow-config.xml</code> ï¼ˆæ ¹æ®è‡ªå·±ä¸šåŠ¡å®šä¹‰åˆé€‚çš„æ–‡ä»¶åï¼‰ å†…å®¹ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://www.springframework.org/schema/beans"</span>
       <span class="hljs-attr">xmlns:li-flow</span>=<span class="hljs-string">"http://www.sunyuchao.com/schema/sunyuchao/flow-engine"</span>
       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.sunyuchao.com/schema/sunyuchao/flow-engine http://www.sunyuchao.com/schema/sunyuchao/flow-engine/flow-engine-1.0.0.xsd"</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- ç°é‡‘è´·è¿˜æ¬¾ç”³è¯·æµç¨‹ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">li-flow:state-diagram</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"biz-ins-cash-mas.repay-apply-flow"</span> <span class="hljs-attr">begin-status</span>=<span class="hljs-string">"I00"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li-flow:state</span> <span class="hljs-attr">status</span>=<span class="hljs-string">"I00"</span> <span class="hljs-attr">next-status</span>=<span class="hljs-string">"I05"</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- åŸºæœ¬ä¿¡æ¯æ·»åŠ  --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li-flow:task</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"cashRepayApplyBaseInitTask"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">li-flow:state</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- åŸºç¡€æ ¡éªŒ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li-flow:state</span> <span class="hljs-attr">status</span>=<span class="hljs-string">"I05"</span> <span class="hljs-attr">next-status</span>=<span class="hljs-string">"I10"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li-flow:task</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"memberStatusCheckTask"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">li-flow:state</span>&gt;</span>
        
         <span class="hljs-comment">&lt;!-- çœç•¥ --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">li-flow:state-diagram</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span>
</code></pre>
<h3 data-id="heading-9">æµç¨‹å¼•æ“å¯åŠ¨ç±» DistributedTxnEngine</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Autowired</span>  
<span class="hljs-keyword">private</span> DistributedTxnEngine distributedTxnEngine;
</code></pre>
<p>ç›´æ¥ä½¿ç”¨ï¼Œå®ƒæ˜¯æµç¨‹çš„å¯åŠ¨å…¥å£</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">CashRepaySubmitRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CashRepaySubmitRequest</span>();  
request.setMemberId(<span class="hljs-string">"JF1234"</span>);  
request.setOrderNo(<span class="hljs-string">"TQYJKN20230117122122161"</span>);
request.setRepayNums(<span class="hljs-string">"1,2,3"</span>);
<span class="hljs-comment">//...è¯·æ±‚å‚æ•°</span>
<span class="hljs-type">String</span> <span class="hljs-variable">repayNo</span> <span class="hljs-operator">=</span> distributedTxnEngine.startTxn(<span class="hljs-string">"biz-ins-cash-mas.repay-apply-flow"</span>, request, TxnType.REPAY);
</code></pre>
<h3 data-id="heading-10">äº‹ä»¶å”¤é†’</h3>
<p>å¾ˆå¤šæ—¶å€™æˆ‘ä»¬çš„æµç¨‹ä¼šæš‚åœåœ¨ä¸€ä¸ªä¸­é—´èŠ‚ç‚¹ï¼Œç­‰å¾…ç¬¬ä¸‰æ–¹çš„æŸä¸ªä¸šåŠ¡å¤„ç†ç»“æœé€šçŸ¥æˆ‘ä»¬ç»§ç»­æ‰§è¡Œæµç¨‹ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦ç”¨å”¤é†’æœºåˆ¶æ¥å”¤é†’æµç¨‹ï¼Œä½¿ç”¨ <code>DistributedTxnEngine</code> æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å‘å¸ƒäº‹ä»¶å”¤é†’æµç¨‹
 * 
 * <span class="hljs-doctag">@param</span> eventType äº‹ä»¶id
 * <span class="hljs-doctag">@param</span> txnId äº¤æ˜“å·
 * <span class="hljs-doctag">@param</span> txnType äº¤æ˜“ç±»å‹
 * 
 * <span class="hljs-doctag">@return</span> trueï¼Œè¡¨ç¤ºäº‹ä»¶å·²ç»æ­£ç¡®å‡ºå‘ï¼Œfalseè¡¨ç¤ºäº¤æ˜“å·²ç»ç»ˆæ­¢
 */</span>
<span class="hljs-type">boolean</span> <span class="hljs-title function_">signalEventToTxn</span><span class="hljs-params">(String eventType, String txnId, FlowTxnType txnType)</span>;
</code></pre>
<blockquote>
<p>æ³¨æ„ï¼šè¿™é‡Œæˆ‘ä»¬ä¸å»ºè®®åœ¨äº‹ä»¶å”¤é†’ä¼ å…¥å¤–éƒ¨ä¸šåŠ¡å‚æ•°ï¼Œå› ä¸ºèƒ½å¤Ÿæ”¶åˆ°ç»“æœé€šçŸ¥ï¼Œè¯´æ˜ä¸€å®šæœ‰ç›¸å…³çš„ç»“æœæŸ¥è¯¢æ¥å£ï¼Œæˆ‘ä»¬æ¨èåœ¨æµç¨‹å”¤é†’åï¼Œå†æ¬¡è°ƒç”¨æŸ¥è¯¢æ¥å£ï¼Œä»¥æŸ¥è¯¢å¾—åˆ°çš„ç»“æœä¸ºå‡†æ›´åˆé€‚</p>
</blockquote>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨ <code>xml</code> æµç¨‹æ–‡ä»¶ä¸­ <code>&lt;li-flow:state-diagram&gt;</code> æ ‡ç­¾å†… å®šä¹‰äº‹ä»¶èŠ‚ç‚¹</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">li-flow:state-diagram</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"biz-ins-cash-mas.repay-apply-flow"</span> <span class="hljs-attr">begin-status</span>=<span class="hljs-string">"I00"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">li-flow:event-node</span> <span class="hljs-attr">event-type</span>=<span class="hljs-string">"repay-flow-apply-event"</span> <span class="hljs-attr">event-handler</span>=<span class="hljs-string">"repayFlowApplyHandler"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">li-flow:state-diagram</span>&gt;</span>
</code></pre>
<p>ç„¶åå®šä¹‰å¯¹åº”çš„äº‹ä»¶å¤„ç†å™¨ <code>handler</code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RepayFlowApplyHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">EventHandler</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">onEvent</span><span class="hljs-params">(String eventType ,String currentStatus, FlowTxnContext ctx)</span> {
        log.info(<span class="hljs-string">"repay flow apply event currentStatus-{}"</span>,currentStatus);
        ctx.setValue(CashRepayApplyFieldNames.ERR_CODE, <span class="hljs-string">""</span>);
        ctx.setValue(CashRepayApplyFieldNames.ERR_MSG, <span class="hljs-string">""</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"B00"</span>;
    }
}
</code></pre>
<p>åœ¨ä¸šåŠ¡ä»£ç çš„åˆé€‚ä½ç½®è°ƒç”¨äº‹ä»¶å”¤é†’ <code>API</code>ï¼Œè¿™ä¸ªåˆé€‚çš„ä½ç½®ä¸€èˆ¬æ˜¯æ”¶åˆ° <code>MQ</code> ç»“æœçš„æ¶ˆæ¯é€šçŸ¥</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Autowired</span>  
<span class="hljs-keyword">private</span> DistributedTxnEngine distributedTxnEngine;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span>{
    distributedTxnEngine.signalEventToTxn(<span class="hljs-string">"repay-flow-apply-event"</span>, <span class="hljs-string">"REPAY_NO"</span>,TxnType.REPAY);
}
</code></pre>
<blockquote>
<p>æ³¨æ„ï¼šæµç¨‹å¼•æ“çŠ¶æ€æœºçŠ¶æ€ä¸º <code>æš‚åœ</code> çš„æ—¶å€™æ‰å¯ä»¥ç”¨äº‹ä»¶å”¤é†’ï¼Œå³ flow_transaction_lock è¡¨çš„ flag å€¼ä¸º 1</p>
</blockquote>
<h3 data-id="heading-11">å¼‚å¸¸å¤„ç†</h3>
<p>å’Œäº‹ä»¶å‡ ä¹ä¸€æ ·ï¼Œå…ˆå®šä¹‰å¼‚å¸¸å¤„ç†èŠ‚ç‚¹</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">li-flow:state-diagram</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"biz-ins-cash-mas.repay-apply-flow"</span> <span class="hljs-attr">begin-status</span>=<span class="hljs-string">"I00"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">li-flow:exception-handler</span> <span class="hljs-attr">exception-class</span>=<span class="hljs-string">"java.lang.Throwable"</span> <span class="hljs-attr">exception-handler</span>=<span class="hljs-string">"repayApplyExceptionHandler"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">li-flow:state-diagram</span>&gt;</span>
</code></pre>
<p>ç„¶åå®šä¹‰å¼‚å¸¸å¤„ç†å™¨</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RepayApplyExceptionHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ExceptionHandler</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">onException</span><span class="hljs-params">(Throwable e, String currentStatus, FlowTxnContext ctx, Object paras)</span> {
        ctx.setValue(<span class="hljs-string">"flowCurrentStatus"</span>, currentStatus);
        ctx.setValue(<span class="hljs-string">"testRunTimeException"</span>, <span class="hljs-literal">true</span>);
        log.error(<span class="hljs-string">"RepaySuccessExceptionHandler exception repayNo={}, currentStatus={}"</span>, ctx.getTxnId(), currentStatus, e);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"W"</span>;
    }
}
</code></pre>
<blockquote>
<p>å¯ä»¥å®šä¹‰å¤šä¸ªå¼‚å¸¸å¤„ç†å™¨ç”¨æ¥å¤„ç†ä¸åŒç±»å‹çš„å¼‚å¸¸ï¼Œèµ°ä¸åŒçš„ä¸šåŠ¡é€»è¾‘ã€‚ä¾‹å¦‚ä¸€èˆ¬æˆ‘ä»¬ç‰¹å®šä¸šåŠ¡å¼‚å¸¸æ˜¯å¯ä»¥ç»™äº¤æ˜“ç›´æ¥å®šä¸ºå¤±è´¥ï¼Œèµ°å¤±è´¥æµç¨‹ã€‚ä½†æ˜¯ç³»ç»Ÿå¼‚å¸¸ï¼Œä¾‹å¦‚æ•°æ®é—®é¢˜ã€ä»£ç  bug ç­‰è¿™ç§æˆ‘ä»¬åº”è¯¥ç»™äº¤æ˜“æš‚åœï¼Œç­‰å¾…åç»­äººå·¥ä»‹å…¥</p>
</blockquote>
<h3 data-id="heading-12">æ¡ä»¶åˆ†æ”¯</h3>
<p><code>xml</code> æµç¨‹å…¶å®æ˜¯æ¨¡ä»¿ <code>Java</code> ä»£ç çš„æ‰§è¡Œé€»è¾‘ï¼Œæ‰€ä»¥å®ƒæ— æ³•é¿å…æˆ‘ä»¬éœ€è¦æ¡ä»¶åˆ†æ”¯çš„åœºæ™¯ï¼Œå½“æˆ‘ä»¬éœ€è¦æ ¹æ®ä¸€ä¸ªä¸åŒè¿”å›å€¼æ¥è¿›è¡Œä¸åŒçš„é€»è¾‘å¤„ç†æ—¶å¯ä»¥ä½¿ç”¨ <code>&lt;li-flow:switch&gt;</code> å®ç°</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">li-flow:state</span> <span class="hljs-attr">status</span>=<span class="hljs-string">"A00"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">li-flow:switch</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li-flow:expression</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li-flow:task</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"choicePayChannelTask"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">li-flow:expression</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li-flow:case</span> <span class="hljs-attr">code</span>=<span class="hljs-string">"activeWithhold"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li-flow:next-status</span> <span class="hljs-attr">status</span>=<span class="hljs-string">"A20"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">li-flow:case</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li-flow:case</span> <span class="hljs-attr">code</span>=<span class="hljs-string">"overdueWithhold"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li-flow:next-status</span> <span class="hljs-attr">status</span>=<span class="hljs-string">"A15"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">li-flow:case</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">li-flow:switch</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">li-flow:state</span>&gt;</span>
</code></pre>
<p>ä¸Šè¿°çš„æµç¨‹è¡¨ç¤ºï¼Œå¦‚æœ <code>choicePayChannelTask</code> çš„è¿”å›å€¼æ˜¯ <code>activeWithhold</code>ï¼Œä¸‹ä¸€ä¸ªä»»åŠ¡å°±ä» <code>A20</code> å¼€å§‹ï¼Œä»¥æ­¤ç±»æ¨ï¼Œä½ å¯ä»¥å®šä¹‰æ— æ•°ä¸ª <code>case</code>ã€‚è€Œ <code>choicePayChannelTask</code> å°±æ˜¯ä¸€ä¸ªç®€å•çš„ <code>Spring Bean</code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component("choicePayChannelTask")</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChoicePayChannelTask</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">FlowTxnTask</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">execute</span><span class="hljs-params">(FlowTxnContext txnCtx, Object reqParas)</span> <span class="hljs-keyword">throws</span> AppBizException {
        log.info(<span class="hljs-string">"choicePayChannelTask"</span>);
        <span class="hljs-comment">//...ä¸šåŠ¡é€»è¾‘</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"activeWithhold"</span>;
    }
}
</code></pre>
<h3 data-id="heading-13">æµç¨‹åˆ‡æ¢</h3>
<p>å¾ˆå¤šæ—¶å€™æˆ‘ä»¬çš„ä¸šåŠ¡æµç¨‹éå¸¸å¤æ‚ï¼Œå¤æ‚åˆ°å°†ä»–ä»¬å®šä¹‰åœ¨å¤šä¸ª <code>xml</code> æ–‡ä»¶ä¸­æ‰ä¼šçœ‹èµ·æ¥ç›¸å¯¹æ¸…æ™°ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦ä»ä¸€ä¸ª <code>diagram</code> æµç¨‹è·³è½¬åˆ°å¦ä¸€ä¸ª <code>diagram</code> æµç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>&lt;li-flow:goto&gt;</code> æ¥å®ç°</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">li-flow:state</span> <span class="hljs-attr">status</span>=<span class="hljs-string">"S00"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">li-flow:goto</span> <span class="hljs-attr">next-status</span>=<span class="hljs-string">"D:biz-ins-cash-mas.repay-success-flow/S01"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">li-flow:state</span>&gt;</span>
</code></pre>
<p><code>next-status</code> çš„å€¼è§„åˆ™ä¸º <code>"D:" + ä½ è¦è·³è½¬çš„ diagram çš„ id +"/"+ begin-status</code>ï¼Œå½“æµç¨‹æ‰§è¡Œåˆ° <code>S00</code> çŠ¶æ€æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒæ•´åˆ°å¦ä¸€ä¸ªæµç¨‹å¼•æ“ç»§ç»­æ‰§è¡Œã€‚</p>
<h3 data-id="heading-14">æµç¨‹æš‚åœ</h3>
<p>åœ¨é‡åˆ°æˆ‘ä»¬é¢„çŸ¥çš„ç³»ç»Ÿå¼‚å¸¸æµç¨‹ï¼Œé€šå¸¸æˆ‘ä»¬éœ€è¦è®©æµç¨‹ä¸æµè½¬åˆ°ç»ˆæ€ï¼Œä½†æ˜¯åˆä¸æƒ³è®©æµç¨‹ç»“æŸï¼Œåªæ˜¯æƒ³å•çº¯çš„æš‚æ—¶æš‚åœï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥è®©æµç¨‹èµ°åˆ°ä¸€ä¸ªç©ºä»»åŠ¡èŠ‚ç‚¹ï¼Œç­‰å¾…åç»­äººå·¥ä»‹å…¥è¡¥å¿ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- ç­‰å¾…æµç¨‹ åç»­è¡¥å¿æœºåˆ¶å®Œæˆ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">inf-dte:state</span> <span class="hljs-attr">status</span>=<span class="hljs-string">"W"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">inf-dte:task</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"emptyRepayTask"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">inf-dte:state</span>&gt;</span>
</code></pre>
<p>åœ¨è¿™ä¸ªç©ºçš„ <code>task</code> ä¸­æˆ‘ä»¬ä»€ä¹ˆä¹Ÿä¸åšï¼Œæµç¨‹ä¼šæš‚åœç­‰å¾…äº‹ä»¶å”¤é†’ï¼ˆäººå·¥ä»‹å…¥ï¼‰</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmptyRepayTask</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">FlowTxnTask</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">execute</span><span class="hljs-params">(FlowTxnContext context, Object arg)</span> <span class="hljs-keyword">throws</span> AppBizException {
        log.info(<span class="hljs-string">"EmptyRepayTask#execute txnId-{}"</span>,context.getTxnId());
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
}
</code></pre>
<h3 data-id="heading-15">ä¸šåŠ¡è¡¥å¿</h3>
<p>å¾ˆå¤šæ—¶å€™å‘ç”Ÿäººä¸ºä¸å¯æ§çš„äº‹æƒ…ï¼Œæˆ‘ä»¬éœ€è¦å¯¹äº¤æ˜“æµç¨‹è¡¥å¿å¤„ç†ã€‚ä¾‹å¦‚èµ„æ–¹æ‰£æ¬¾æ“ä½œå¼‚å¸¸ï¼Œç”¨æˆ·ç¬¬ä¸€å¤©è¿˜æ¬¾æˆåŠŸï¼Œèµ„æ–¹ç¬¬äºŒå¤©æ‰æŠŠæ‰£æ¬¾çš„ç»“æœå‘Šè¯‰æˆ‘ä»¬ã€‚è¿™ç§æƒ…å†µæ˜¯ä¸èƒ½ç»§ç»­èµ°æµç¨‹çš„ï¼Œå› ä¸ºå‡Œæ™¨çš„ç”Ÿæ¯å¯¼è‡´ç”¨æˆ·è´¦å•å˜åŒ–äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿˜æ¬¾é‡‘é¢å°±æ— æ³•æ ¸é”€æ‰ç”¨æˆ·çš„è´¦å•ã€‚</p>
<p>è¿™ç§æƒ…å†µæˆ‘ä»¬éƒ½æ˜¯æ£€æµ‹åˆ°è·¨å¤©è¿˜æ¬¾ç»“æœé€šçŸ¥ï¼ŒæŒ‚èµ·æµç¨‹ï¼Œå‘Šè­¦é€šçŸ¥ç ”å‘ã€‚è¦ä¿®å¤è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦å°†è·¨çš„è¿™ä¸€å¤©çš„åˆ©æ¯æˆ–è€…ç½šæ¯ç»™æŠ¹æ‰ï¼Œç„¶åä»æŒ‡å®šçš„çŠ¶æ€èŠ‚ç‚¹é‡æ–°å¯åŠ¨æµç¨‹å³å¯ã€‚</p>
<p>å‚è€ƒå‰é¢çš„äº‹ä»¶å”¤é†’ï¼Œæˆ‘ä»¬æ–°å¢ä¸€ä¸ªäººå·¥è¡¥å¿èŠ‚ç‚¹</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!--äººå·¥è¡¥å¿--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">li-flow:event-node</span> <span class="hljs-attr">event-type</span>=<span class="hljs-string">"repay-flow-compensation-event"</span> <span class="hljs-attr">event-handler</span>=<span class="hljs-string">"repayCompensationHandler"</span>/&gt;</span>
</code></pre>
<p>å®šä¹‰å¤„ç†å™¨</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RepayCompensationHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">EventHandler</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">onEvent</span><span class="hljs-params">(String eventType, String currentStatus, FlowTxnContext ctx)</span> {
       log.info(<span class="hljs-string">"Start repay compensation, currentStatus={}"</span>, currentStatus);
       <span class="hljs-type">String</span> <span class="hljs-variable">compensateStatus</span> <span class="hljs-operator">=</span> ctx.getString(<span class="hljs-string">"compensateStatus"</span>);
       <span class="hljs-keyword">return</span> compensateStatus;
    }

}
</code></pre>
<p>ç„¶åæš´éœ²ä¸€ä¸ªæ¥å£ç»™åå°å³å¯ï¼Œæ¥å£çš„å®ç°å°±æ˜¯è°ƒç”¨æµç¨‹å¼•æ“çš„äº‹ä»¶æ‹‰èµ·æ–¹æ³•</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * è¡¥å¿æ¥å£ï¼Œè®©å½“å‰æµç¨‹ä»ä»»ä½•ä¸€ä¸ªçŠ¶æ€æ‹‰èµ·æµç¨‹å¼•æ“ç»§ç»­æ‰§è¡Œ
 * æ³¨æ„åœ¨è¿™é‡Œ flow_transaction è¡¨è¦æ”¹ diagram_id å­—æ®µåˆ°ä½ çš„ç›®æ ‡çŠ¶æ€æ‰€å±çš„ diagram
 * flow_transaction.run_flag è¦æ”¹æˆ 0
 * */</span>
<span class="hljs-meta">@GetMapping("/test4")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test4</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam("repayNo")</span> String repayNo,<span class="hljs-meta">@RequestParam("status")</span> String status)</span>{
    <span class="hljs-type">CashRepayApply</span> <span class="hljs-variable">cashRepayApply</span> <span class="hljs-operator">=</span> cashRepayApplyMapper.selectOne(Wrappers.&lt;CashRepayApply&gt;lambdaQuery().eq(CashRepayApply::getApplyNo, repayNo));
    cashRepayApply.addExtAttr(<span class="hljs-string">"compensateStatus"</span>, status);
    <span class="hljs-comment">//å…ˆæŠŠç›®æ ‡çŠ¶æ€æ›´æ–°åˆ°æ‰©å±•å­—æ®µï¼Œ</span>
    cashRepayApplyMapper.updateById(cashRepayApply);
    distributedTxnEngine.signalEventToTxn(<span class="hljs-string">"repay-flow-compensation-event"</span>, repayNo,TxnType.REPAY);
}
</code></pre>
<p>åœ¨è¿™ä¹‹å‰æˆ‘ä»¬è¦ç¡®ä¿è¿™ç¬”äº¤æ˜“çš„æµç¨‹å¼•æ“ç›®å‰çš„çŠ¶æ€æ˜¯ <code>åœæ­¢</code> å³ <code>flow_transaction_lock.flag = 1</code>ï¼Œå¹¶ä¸”ä½ è¦è¡¥å¿çš„çŠ¶æ€èŠ‚ç‚¹æ˜¯å±äºå½“å‰æµç¨‹å¼•æ“ <code>diagram</code> çš„ã€‚</p>
<h2 data-id="heading-16">è¸©å‘ç»éªŒ</h2>
<p>å…³äº <code>li-flow</code> ä½ éœ€è¦æœ‰ä»¥ä¸‹è®¤è¯†ã€‚</p>
<ul>
<li>ä½¿ç”¨ <code>li-flow</code> æµç¨‹ï¼Œä¸»è¡¨ä¸šåŠ¡æ²¡æœ‰ â€œäº‹åŠ¡å›æ»šâ€ çš„æ¦‚å¿µï¼Œä½ å¯ä»¥è¿™ä¹ˆç†è§£ã€‚åªè¦æµç¨‹å¯åŠ¨ï¼Œå¿…å®šä¼šæœ‰ä¸€æ¡äº¤æ˜“æ•°æ®ï¼ŒåŒºåˆ«æ˜¯è¿™æ¡æ•°æ®çš„çŠ¶æ€æ˜¯åˆå§‹åŒ–ã€å¤„ç†ä¸­ã€æˆåŠŸè¿˜æ˜¯å¤±è´¥ã€‚</li>
<li>ç¬¬ä¸€ä¸ª <code>state</code> èŠ‚ç‚¹å»ºè®®åªæ”¾åˆå§‹åŒ–ä»»åŠ¡ï¼Œå¹¶ä¸”è¿™ä¸ª state é‡Œé¢ä¸èƒ½è·¨æœåŠ¡è°ƒç”¨ï¼Œä¸èƒ½æœ‰æ˜æ˜¾å¯é¢„æœŸçš„å¼‚å¸¸ä»£ç é€»è¾‘ã€‚è¯´ç™½äº†ä½ åº”è¯¥åªæœ‰ä»¥ä¸‹ä»£ç </li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/930f58de2d494f40ac554dde57ad5dc1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769316110&amp;x-signature=kCn6Nz50Os%2BaoYsmZEdd0LikcbA%3D" alt="image.png" loading="lazy"/>
å› ä¸º ä¸€ä¸ª <code>state</code> èŠ‚ç‚¹èµ°å®Œæ‰ä¼šä¿å­˜äº¤æ˜“æ•°æ®åˆ°æ•°æ®åº“ï¼Œå¦‚æœç¬¬ä¸€ä¸ª <code>state</code> èŠ‚ç‚¹æŠ¥é”™ï¼Œç›´æ¥è·³è½¬åˆ°å¼‚å¸¸å¤„ç†å™¨ä¸­ï¼Œå¯èƒ½ä¼šå› ä¸ºç¼ºå°‘åŸºç¡€çš„äº¤æ˜“å­—æ®µå¼•å‘å¼‚å¸¸å¤„ç†å™¨ä¹Ÿå‘ç”Ÿå¼‚å¸¸ï¼Œä»è€Œå¾ªç¯èµ°å¼‚å¸¸å¤„ç†å™¨ï¼Œé€ æˆæ­»å¾ªç¯ã€‚</p>
<ul>
<li><code>li-flow</code> é€‚åˆçš„åº”ç”¨åœºæ™¯æ˜¯ä½ çš„ä¸šåŠ¡æµç¨‹éå¸¸é•¿ï¼Œå¹¶ä¸”å¾ˆå¤šèŠ‚ç‚¹çš„ç»“æœä¸æ˜¯è‡ªå·±æ–¹æ‰€èƒ½æ§åˆ¶çš„ï¼Œä¾‹å¦‚é“¶è¡Œæ‰£æ¬¾ç»“æœçš„é€šçŸ¥ã€‚</li>
<li><code>li-flow</code> ä¸­æ¯ä¸€ä¸ªä¸šåŠ¡èŠ‚ç‚¹çš„ <code>task</code>ï¼ŒåŸåˆ™ä¸Šæ¥è¯´éƒ½éœ€è¦åšå¹‚ç­‰ï¼Œä¸ç„¶äº‹ä»¶æ‹‰èµ·æˆ–è€…å¤„ç†å¼‚å¸¸æµç¨‹éœ€è¦é‡æ–°æ‹‰èµ·æµç¨‹ï¼ˆè¡¥å¿ï¼‰çš„æ—¶å€™ä¼šæœ‰é—®é¢˜</li>
<li>é™¤äº†æµç¨‹å¼•æ“ç¬¬ä¸€ä¸ªåˆå§‹åŒ–çš„ Taskï¼Œå…¶ä»– Task ä¸è¦ä½¿ç”¨æµç¨‹è¯·æ±‚å…¥å‚ <code>CashRepaySubmitRequest request = (CashRepaySubmitRequest) arg;</code>ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥åœ¨ä»»æ„èŠ‚ç‚¹ç”¨äº‹ä»¶å”¤é†’æ‹‰èµ·æµç¨‹ï¼Œè¿™æ ·æ‹‰èµ·æµç¨‹å…¥å‚æ˜¯ç©ºçš„ï¼Œå¯¼è‡´æ— æ³•äº‹ä»¶å”¤é†’ï¼Œå¦‚æœéœ€è¦ç”¨åˆ°å…¶ä¸­çš„å‚æ•°å°±ä»æµç¨‹ä¸Šä¸‹æ–‡è·å–ï¼Œè´¯ç©¿æ•´ä¸ªæµç¨‹çš„ <code>context</code> ä¸Šä¸‹æ–‡ä¸­ä¿å­˜äº†æ‰€æœ‰ä¿¡æ¯</li>
</ul>
<h2 data-id="heading-17">li-flow çš„æ ¸å¿ƒ</h2>
<h3 data-id="heading-18">xml è§£æå™¨</h3>
<p>åœ¨ <code>spring.handlers</code> æ–‡ä»¶ä¸­é…ç½®äº† <code>xml</code> å‘½åç©ºé—´è§£æå™¨</p>
<pre><code class="hljs language-ruby" lang="ruby">http\<span class="hljs-symbol">://www</span>.sunyuchao.com/schema/sunyuchao/flow-engine=com.li.flow.autoconfigure.config.<span class="hljs-title class_">FlowEngineNamespaceHandler</span>
</code></pre>
<p>è¿™é‡Œé¢æ³¨å†Œäº†ä¸€ä¸ªç»§æ‰¿ <code>BeanDefinitionParser</code> çš„ <code>DiagramBeanParser</code> æ„é€  <code>xml</code> ä¸­çš„ <code>diagram</code> ä»¥åŠå­æ ‡ç­¾ <code>state</code>ã€<code>task</code> ç­‰ã€‚</p>
<h3 data-id="heading-19">äº¤æ˜“å¼•æ“å…¥å£</h3>
<p><code>DistributedTxnEngine</code> æ˜¯äº¤æ˜“å¼•æ“ç±»ï¼Œæä¾›æµç¨‹çš„å¯åŠ¨å…¥å£ï¼Œæä¾›é»˜è®¤å®ç°ã€‚</p>
<h3 data-id="heading-20">å¼•æ“å·¥å‚</h3>
<p><code>DiagramFactory</code> æ˜¯å¼•æ“å·¥å‚ï¼Œç”¨æ¥æ„é€ å¼•æ“ <code>diagram</code> ä¸­çš„å…ƒç´ ï¼Œå°†å†…éƒ¨ç›¸å…³çš„ç»“æ„ï¼ˆ<code>äº‹ä»¶å¤„ç†å™¨ã€å¼‚å¸¸å¤„ç†å™¨ã€ä»»åŠ¡</code>ï¼‰èµ‹ä¸Šå¯¹åº”çš„ <code>Spring Bean</code> å®ä¾‹ï¼Œæä¾›é»˜è®¤å®ç°</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4e1f2ef34134a29bae80bb7c4aaf4d5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769316110&amp;x-signature=Mcv0rCut1cuUch4KceRHMi0l0m8%3D" alt="d8a1fcfa39ae9c6e27fcbc8c016583df.png" loading="lazy"/></p>
<h3 data-id="heading-21">çŠ¶æ€æ‰§è¡Œå™¨</h3>
<p><code>FlowStateExecutor</code> æ˜¯æµç¨‹çš„æ‰§è¡Œå™¨ï¼Œæ ¹æ®è¯·æ±‚ç±»å‹ä¸åŒæ‰§è¡Œä¸åŒçš„å¤„ç†é€»è¾‘ã€‚ä¾‹å¦‚æœ¬æ¬¡æµç¨‹æ˜¯äº‹ä»¶å¤„ç†ã€å¼‚å¸¸å¤„ç†ã€è¿˜æ˜¯æ­£å¸¸æµç¨‹èŠ‚ç‚¹ã€‚</p>
<h3 data-id="heading-22">ä»»åŠ¡æ¥å£</h3>
<p>æœ¬è´¨ä¸Šæµç¨‹é‡Œé¢æ‰€æœ‰çš„ä»£ç æ‰§è¡Œéƒ½æ˜¯æ‰§è¡Œä¸åŒçš„ä»»åŠ¡ï¼Œ<code>Task</code> æ˜¯é¡¶å±‚æ¥å£ï¼Œåº•ä¸‹åˆ†åˆ«æœ‰å®ç°ç±»ä¸º <code>GotoTask</code>ã€<code>NextStatusTask</code>ã€<code>SpringBeanTask</code>ã€<code>SwitchTask</code></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d6f9f2f6f4274a73881cd38a785802fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769316110&amp;x-signature=VdmKbR5oR%2F89cUEg39GvofnMY70%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-23">äº¤æ˜“è½¨è¿¹</h3>
<p><code>flow_state</code> è¡¨è®°å½•äº†ï¼Œæµç¨‹å¼•æ“èµ°è¿‡çš„æ¯ä¸€ä¸ªçŠ¶æ€èŠ‚ç‚¹ï¼Œå½“å‰å¤„äºå“ªä¸ªçŠ¶æ€èŠ‚ç‚¹</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84703f768cb54610a6f0fd24e3dfa105~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769316110&amp;x-signature=FLPiUirp1ipyTa4939BLIIhiVco%3D" alt="image.png" loading="lazy"/></p>
<p><code>flow_transaction</code> è¡¨è®°å½•äº†æµç¨‹å¼•æ“çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼Œå½“å‰å¤„äºå“ªä¸€ä¸ª <code>diagram</code> æµç¨‹ã€å½“å‰çŠ¶æ€ã€å¼€å§‹æ—¶é—´ã€å¼‚å¸¸æ ‡è®°ã€æµç¨‹ç»“æŸæ—¶é—´ç­‰</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e541306c56ec423e81b467b92c614ff1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769316110&amp;x-signature=xmuWvRlIf2F2ZA7lNRfo9cpDV64%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-24">ç»“è¯­</h2>
<p>å¾…è¿‡ä¸¤å®¶ä¿¡è´·å…¬å¸ï¼Œä¸å¾—ä¸è¯´ï¼Œè¿™ä¸ªæµç¨‹å¼•æ“çœŸæ˜¯å¤ªé€‚åˆå°è´·ä¸šåŠ¡äº†ï¼Œæœ¬è´¨ä¸Šå®ç°åŸç†ä¸å¤æ‚ï¼Œä½†æ˜¯æˆ‘å¾ˆä½©æœæˆ‘ä»¬ <code>CTO</code> èƒ½æƒ³åˆ°è¿™ä¸ªæ–¹æ¡ˆå¹¶ä¸”æ¨åŠ¨è½åœ°æŠ•å…¥ç”Ÿäº§ä½¿ç”¨ï¼Œä»–çœŸçš„æ˜¯å¤§ç‰›ï¼</p>
<p>è™½ç„¶æºç ä¸èƒ½å…¬å¼€ï¼Œä½†æ˜¯å¦‚æœä½ å¯¹æµç¨‹å¼•æ“æ„Ÿå…´è¶£ï¼Œå‚è€ƒè¿™ç¯‡æ–‡ç« åº”è¯¥å¯ä»¥è‡ªå·±ç ”å‘å‡ºæ¥ä¸€ä¸ªç¬¦åˆå…¬å¸ä¸šåŠ¡çš„æµç¨‹å¼•æ“ã€‚æœ¬è´¨å†…å®¹å°±æ˜¯ <strong>æµç¨‹èŠ‚ç‚¹ç»“æ„çº¦æŸå®šä¹‰ + æµç¨‹èŠ‚ç‚¹çš„æ­»å¾ªç¯æ‰§è¡Œ</strong> ã€‚</p>
<h3 data-id="heading-25">å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè®°å¾—ç‚¹èµåŠ å…³æ³¨ï¼ä½ çš„æ”¯æŒå°±æ˜¯æˆ‘ç»§ç»­åˆ›ä½œçš„åŠ¨åŠ›ï¼</h3></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æœ¬åœ°å¤§æ¨¡å‹ä¸»æµéƒ¨ç½²å·¥å…·æŒ‡å—]]></title>    <link>https://juejin.cn/post/7595974133097676834</link>    <guid>https://juejin.cn/post/7595974133097676834</guid>    <pubDate>2026-01-18T04:46:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595974133097676834" data-draft-id="7595974133097365538" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æœ¬åœ°å¤§æ¨¡å‹ä¸»æµéƒ¨ç½²å·¥å…·æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-18T04:46:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€è¯ºæ»šé›ªçƒ"/> <meta itemprop="url" content="https://juejin.cn/user/2824015112318094"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æœ¬åœ°å¤§æ¨¡å‹ä¸»æµéƒ¨ç½²å·¥å…·æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2824015112318094/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€è¯ºæ»šé›ªçƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T04:46:34.000Z" title="Sun Jan 18 2026 04:46:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. å‰è¨€</h2>
<h3 data-id="heading-1">1.1 ä¸ºä»€ä¹ˆç°åœ¨å¿…è¯•æœ¬åœ°éƒ¨ç½²ï¼Ÿ</h3>
<p>æƒ³è±¡ä¸€ä¸‹ï¼šä½ çš„æ‰€æœ‰å¯¹è¯éƒ½ç•™åœ¨ç”µè„‘é‡Œï¼Œä¸ç”¨æ‹…å¿ƒæ•°æ®æ³„éœ²ï¼›ä¸ç”¨æ¯å¥è¯éƒ½ä»˜è´¹ï¼›åœ°é“ã€é‡å¤–ç­‰æ— ç½‘ç¯å¢ƒä¹Ÿèƒ½ç§’å“åº”ã€‚è¿™å°±æ˜¯<strong>æœ¬åœ°éƒ¨ç½²å¤§æ¨¡å‹çš„é­…åŠ›</strong> â€”â€” å·¥å…·é“¾å·²æˆç†Ÿï¼Œæ–°æ‰‹ä¹Ÿèƒ½ 10 åˆ†é’Ÿä¸Šæ‰‹ï¼</p>
<h3 data-id="heading-2">1.2 æœ¬åœ°éƒ¨ç½²çš„æ ¸å¿ƒä¼˜åŠ¿</h3>





























<table><thead><tr><th>ä¼˜åŠ¿</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>[+] <strong>éšç§ç»å¯¹å®‰å…¨</strong></td><td>æ•°æ®å…¨ç¨‹å­˜å‚¨æœ¬åœ°ï¼Œæ— äº‘ç«¯ä¸Šä¼ é£é™©ï¼ˆé€‚åˆå•†ä¸šæœºå¯†ã€ä¸ªäººéšç§ï¼‰</td></tr><tr><td>[+] <strong>é›¶ä½¿ç”¨æˆæœ¬</strong></td><td>ä¸€æ¬¡æ€§éƒ¨ç½²ï¼Œæ— é™æ¬¡ä½¿ç”¨ï¼Œé¿å… API æŒ‰è°ƒç”¨é‡è®¡è´¹</td></tr><tr><td>[+] <strong>æ— ç½‘ç»œä¾èµ–</strong></td><td>æ–­ç½‘ä¹Ÿèƒ½æ­£å¸¸ä½¿ç”¨ï¼Œå“åº”å»¶è¿Ÿä½è‡³ 80ms</td></tr><tr><td>[+] <strong>å®šåˆ¶åŒ–è‡ªç”±</strong></td><td>å¯é€‰æ‹©ä¸­æ–‡ä¼˜åŒ–ã€è½»é‡å‹ã€ä¸“ä¸šçº§ç­‰ä¸åŒæ¨¡å‹</td></tr><tr><td>[+] <strong>ç¡¬ä»¶é€‚é…å¤šå…ƒ</strong></td><td>6GB æ˜¾å­˜å³å¯è¿è¡Œ 7B æ¨¡å‹ï¼Œè€ç”µè„‘ä¹Ÿèƒ½ç›˜æ´»</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-3">2. äº”å¤§ä¸»æµå·¥å…·æ·±åº¦å¯¹æ¯”ï¼ˆå®æµ‹ç‰ˆï¼‰</h2>



























































<table><thead><tr><th>å·¥å…·</th><th>å®šä½</th><th>éš¾åº¦</th><th>é€‚åˆäººç¾¤</th><th>æ ¸å¿ƒä¼˜åŠ¿</th><th>æ˜¾å­˜è¦æ±‚ï¼ˆ7Bæ¨¡å‹ï¼‰</th><th>æœ€æ–°ç‰¹æ€§</th></tr></thead><tbody><tr><td><strong>Ollama</strong></td><td>å‘½ä»¤è¡Œéƒ¨ç½²ç¥å™¨</td><td>[<em>][</em>]</td><td>å¼€å‘è€…ã€æŠ€æœ¯çˆ±å¥½è€…</td><td>ä¸€è¡Œå‘½ä»¤éƒ¨ç½²ã€APIå…¼å®¹OpenAIã€æ¨¡å‹ä¸°å¯Œ</td><td>4GB+ï¼ˆINT4é‡åŒ–ï¼‰</td><td>ä¿®å¤é«˜å±æ¼æ´ã€æ”¯æŒOpenWebUIå¯è§†åŒ–ã€å›½å†…é•œåƒ</td></tr><tr><td><strong>LM Studio</strong></td><td>å›¾å½¢ç•Œé¢ç‹è€…</td><td>[*]</td><td>æ™®é€šç”¨æˆ·ã€Macç”¨æˆ·</td><td>å³å¼€å³ç”¨ã€å†…ç½®æ¨¡å‹å¸‚åœºã€ä¸­æ–‡ä¼˜åŒ–</td><td>6GB+</td><td>MLX 2.0åŠ é€Ÿã€ModelScopeå›½å†…é•œåƒã€æ–‡æ¡£å¯¹è¯</td></tr><tr><td><strong>Jan</strong></td><td>å…è´¹è·¨å¹³å°æ¡Œé¢åº”ç”¨</td><td>[*]</td><td>ä¸ªäººç”¨æˆ·ã€é¢„ç®—æœ‰é™è€…</td><td>å®Œå…¨å…è´¹ã€æ— å¹¿å‘Šã€æœ¬åœ°+äº‘ç«¯æ··åˆéƒ¨ç½²</td><td>5GB+</td><td>æ”¯æŒRPU/NPUç¡¬ä»¶åŠ é€Ÿã€æ¨¡å‹çƒ­åˆ‡æ¢</td></tr><tr><td><strong>GPT4All</strong></td><td>ä½é…ç”µè„‘æ•‘æ˜Ÿ</td><td>[*]</td><td>è€ç”µè„‘ç”¨æˆ·ã€å…¥é—¨æ–°æ‰‹</td><td>èµ„æºå ç”¨æä½ã€CPU/GPUåŒæ”¯æŒã€å®‰è£…åŒ…å°å·§</td><td>3GB+ï¼ˆINT4é‡åŒ–ï¼‰</td><td>æ–°å¢ä¸­æ–‡è½»é‡æ¨¡å‹åº“ã€ç¦»çº¿ç¼“å­˜ä¼˜åŒ–</td></tr><tr><td><strong>LocalAI</strong></td><td>ä¼ä¸šçº§APIæ›¿ä»£æ–¹æ¡ˆ</td><td>[<em>][</em>][*]</td><td>ä¼ä¸šã€å¼€å‘è€…ã€å›¢é˜Ÿ</td><td>1:1å…¼å®¹OpenAI APIã€æƒé™ç®¡ç†ã€åˆ†å¸ƒå¼éƒ¨ç½²</td><td>8GB+</td><td>æ”¯æŒåƒäº¿å‚æ•°æ¨¡å‹ã€å›½äº§åŒ–èŠ¯ç‰‡é€‚é…ã€ç›‘æ§å‘Šè­¦</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-4">3. äº”å¤§ä¸»æµå·¥å…·è¯¦è§£</h2>
<h3 data-id="heading-5">3.1 Ollama - å¼€å‘è€…é¦–é€‰ãƒ»å®‰å…¨å¢å¼ºç‰ˆ</h3>
<h4 data-id="heading-6">3.1.1 å®šä½</h4>
<p>æœ€ç®€å•çš„å‘½ä»¤è¡Œéƒ¨ç½²å·¥å…·ï¼Œå¼€å‘è€…æ•ˆç‡ç¥å™¨</p>
<h4 data-id="heading-7">3.1.2 æ ¸å¿ƒä¼˜åŠ¿</h4>





























<table><thead><tr><th>ä¼˜åŠ¿</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æé€Ÿéƒ¨ç½²</strong></td><td>ä¸€è¡Œå‘½ä»¤å®Œæˆå®‰è£… + æ¨¡å‹å¯åŠ¨ï¼Œæ— éœ€å¤æ‚é…ç½®</td></tr><tr><td><strong>APIæ— ç¼å…¼å®¹</strong></td><td>è‡ªå¸¦ OpenAI æ ¼å¼ APIï¼Œç°æœ‰é¡¹ç›®å¯ç›´æ¥è¿ç§»</td></tr><tr><td><strong>å…¨å¹³å°è¦†ç›–</strong></td><td>Macï¼ˆM1/M2/M3ï¼‰ã€Linuxã€Windows 10+ å…¨æ”¯æŒ</td></tr><tr><td><strong>æ¨¡å‹ç”Ÿæ€ä¸°å¯Œ</strong></td><td>å†…ç½® Qwen2.5ã€DeepSeek-V3ã€Llama 3 ç­‰ä¸Šç™¾æ¬¾æ¨¡å‹</td></tr><tr><td><strong>å®‰å…¨å‡çº§</strong></td><td>ä¿®å¤æœªæˆæƒè®¿é—®æ¼æ´ï¼Œæ”¯æŒ API å¯†é’¥è®¤è¯</td></tr></tbody></table>
<h4 data-id="heading-8">3.1.3 å®æ“æ•™ç¨‹ï¼ˆå«å›½å†…åŠ é€Ÿ + å®‰å…¨é…ç½®ï¼‰</h4>
<h5 data-id="heading-9">3.1.3.1 å®‰è£…æ­¥éª¤</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># macOS / Linux ä¸€é”®å®‰è£…</span>
curl -fsSL https://ollama.com/install.sh | sh

<span class="hljs-comment"># Windows å®‰è£…</span>
<span class="hljs-comment"># 1. å®˜ç½‘ä¸‹è½½ï¼šhttps://ollama.com/ï¼Œå‹¾é€‰ã€ŒAdd to PATHã€</span>
<span class="hljs-comment"># 2. ç»ˆç«¯éªŒè¯ï¼šollama --versionï¼ˆæ˜¾ç¤ºv0.12.0+å³æˆåŠŸï¼‰</span>
</code></pre>
<h5 data-id="heading-10">3.1.3.2 å›½å†…åŠ é€Ÿé…ç½®ï¼ˆå¿…åšï¼‰</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–°å»ºbatæ–‡ä»¶ï¼ˆWindowsç®¡ç†å‘˜è¿è¡Œï¼‰/ ç»ˆç«¯æ‰§è¡Œï¼ˆMac/Linuxï¼‰</span>
<span class="hljs-built_in">export</span> OLLAMA_MODEL_SERVER=https://mirror.ollama.com  <span class="hljs-comment"># å›½å†…é•œåƒ</span>
<span class="hljs-built_in">export</span> OLLAMA_API_KEY=your_strong_password123  <span class="hljs-comment"># è®¾ç½®è®¿é—®å¯†é’¥ï¼ˆé˜²æ³„éœ²ï¼‰</span>
<span class="hljs-built_in">export</span> OLLAMA_HOST=127.0.0.1:11434  <span class="hljs-comment"># ä»…æœ¬åœ°è®¿é—®</span>
ollama serve
</code></pre>
<h5 data-id="heading-11">3.1.3.3 å¸¸ç”¨å‘½ä»¤ï¼ˆä¸­æ–‡ä¼˜å…ˆï¼‰</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ‹‰å–ä¸­æ–‡æœ€ä¼˜æ¨¡å‹ï¼ˆQwen2.5-7B INT4é‡åŒ–ç‰ˆï¼‰</span>
ollama pull qwen2.5:7b-chat-q4_0

<span class="hljs-comment"># å¯åŠ¨å¯¹è¯ï¼ˆç§’çº§å“åº”ï¼‰</span>
ollama run qwen2.5:7b-chat-q4_0

<span class="hljs-comment"># å¼€å¯APIæœåŠ¡ï¼ˆæ”¯æŒç¼–ç¨‹è°ƒç”¨ï¼‰</span>
ollama serve

<span class="hljs-comment"># æ¨¡å‹ç®¡ç†</span>
ollama list  <span class="hljs-comment"># æŸ¥çœ‹å·²å®‰è£…æ¨¡å‹</span>
ollama <span class="hljs-built_in">rm</span> qwen2.5  <span class="hljs-comment"># åˆ é™¤æ— ç”¨æ¨¡å‹</span>
ollama update  <span class="hljs-comment"># æ›´æ–°Ollamaåˆ°æœ€æ–°ç‰ˆ</span>
</code></pre>
<h5 data-id="heading-12">3.1.3.4 ç¼–ç¨‹è°ƒç”¨ç¤ºä¾‹</h5>
<p><strong>æµè§ˆå™¨ç¯å¢ƒï¼ˆåŸç”Ÿ Fetch + æµå¼å“åº”ï¼‰</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æµå¼å“åº”ï¼ˆå®æ—¶è¾“å‡ºç»“æœï¼‰</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">callOllamaStream</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> apiKey = <span class="hljs-string">"your_strong_password123"</span>;
  <span class="hljs-keyword">const</span> prompt = <span class="hljs-string">"å†™Pythonæ•°æ®å¯è§†åŒ–ä»£ç "</span>;

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">"http://localhost:11434/v1/chat/completions"</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
      <span class="hljs-attr">headers</span>: {
        <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>,
        <span class="hljs-string">"Authorization"</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${apiKey}</span>`</span>
      },
      <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
        <span class="hljs-attr">model</span>: <span class="hljs-string">"qwen2.5:7b-chat-q4_0"</span>,
        <span class="hljs-attr">messages</span>: [{ <span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span>, <span class="hljs-attr">content</span>: prompt }],
        <span class="hljs-attr">stream</span>: <span class="hljs-literal">true</span>
      })
    });

    <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`HTTPé”™è¯¯! çŠ¶æ€ç : <span class="hljs-subst">${response.status}</span>`</span>);
    <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">body</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"æµå¼å“åº”ä¸æ”¯æŒ"</span>);

    <span class="hljs-keyword">const</span> reader = response.<span class="hljs-property">body</span>.<span class="hljs-title function_">getReader</span>();
    <span class="hljs-keyword">const</span> decoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextDecoder</span>(<span class="hljs-string">"utf-8"</span>);
    <span class="hljs-keyword">let</span> result = <span class="hljs-string">""</span>;

    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
      <span class="hljs-keyword">const</span> { done, value } = <span class="hljs-keyword">await</span> reader.<span class="hljs-title function_">read</span>();
      <span class="hljs-keyword">if</span> (done) <span class="hljs-keyword">break</span>;

      <span class="hljs-keyword">const</span> chunk = decoder.<span class="hljs-title function_">decode</span>(value);
      <span class="hljs-comment">// è§£æSSEæ ¼å¼å“åº”</span>
      <span class="hljs-keyword">const</span> lines = chunk.<span class="hljs-title function_">split</span>(<span class="hljs-string">"\n"</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">line</span> =&gt;</span> line.<span class="hljs-title function_">trim</span>() !== <span class="hljs-string">""</span>);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> line <span class="hljs-keyword">of</span> lines) {
        <span class="hljs-keyword">if</span> (line.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"data: "</span>)) {
          <span class="hljs-keyword">const</span> data = line.<span class="hljs-title function_">slice</span>(<span class="hljs-number">6</span>);
          <span class="hljs-keyword">if</span> (data === <span class="hljs-string">"[DONE]"</span>) <span class="hljs-keyword">continue</span>;
          <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">const</span> json = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(data);
            <span class="hljs-keyword">if</span> (json.<span class="hljs-property">choices</span>?.[<span class="hljs-number">0</span>]?.<span class="hljs-property">delta</span>?.<span class="hljs-property">content</span>) {
              <span class="hljs-keyword">const</span> content = json.<span class="hljs-property">choices</span>[<span class="hljs-number">0</span>].<span class="hljs-property">delta</span>.<span class="hljs-property">content</span>;
              result += content;
              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(content); <span class="hljs-comment">// å®æ—¶è¾“å‡º</span>
              <span class="hljs-comment">// å¯åœ¨è¿™é‡Œæ›´æ–°DOMæ˜¾ç¤º</span>
            }
          } <span class="hljs-keyword">catch</span> (e) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"è§£æå“åº”å¤±è´¥:"</span>, e);
          }
        }
      }
    }
    <span class="hljs-keyword">return</span> result;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"è°ƒç”¨å¤±è´¥:"</span>, error);
  }
}

<span class="hljs-comment">// æ‰§è¡Œè°ƒç”¨</span>
<span class="hljs-title function_">callOllamaStream</span>();
</code></pre>
<p><strong>Node.js ç¯å¢ƒï¼ˆaxios + æµå¼å“åº”ï¼‰</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å…ˆå®‰è£…ä¾èµ–ï¼šnpm install axios</span>
<span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">"axios"</span>);

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">callOllamaNodeStream</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> apiKey = <span class="hljs-string">"your_strong_password123"</span>;
  <span class="hljs-keyword">const</span> prompt = <span class="hljs-string">"å†™Pythonæ•°æ®å¯è§†åŒ–ä»£ç "</span>;

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">post</span>(
      <span class="hljs-string">"http://localhost:11434/v1/chat/completions"</span>,
      {
        <span class="hljs-attr">model</span>: <span class="hljs-string">"qwen2.5:7b-chat-q4_0"</span>,
        <span class="hljs-attr">messages</span>: [{ <span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span>, <span class="hljs-attr">content</span>: prompt }],
        <span class="hljs-attr">stream</span>: <span class="hljs-literal">true</span>
      },
      {
        <span class="hljs-attr">headers</span>: {
          <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>,
          <span class="hljs-string">"Authorization"</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${apiKey}</span>`</span>
        },
        <span class="hljs-attr">responseType</span>: <span class="hljs-string">"stream"</span>
      }
    );

    <span class="hljs-keyword">let</span> result = <span class="hljs-string">""</span>;
    response.<span class="hljs-property">data</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">"data"</span>, <span class="hljs-function">(<span class="hljs-params">chunk</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> lines = chunk.<span class="hljs-title function_">toString</span>(<span class="hljs-string">"utf-8"</span>).<span class="hljs-title function_">split</span>(<span class="hljs-string">"\n"</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">line</span> =&gt;</span> line.<span class="hljs-title function_">trim</span>() !== <span class="hljs-string">""</span>);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> line <span class="hljs-keyword">of</span> lines) {
        <span class="hljs-keyword">if</span> (line.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"data: "</span>)) {
          <span class="hljs-keyword">const</span> data = line.<span class="hljs-title function_">slice</span>(<span class="hljs-number">6</span>);
          <span class="hljs-keyword">if</span> (data === <span class="hljs-string">"[DONE]"</span>) <span class="hljs-keyword">return</span>;
          <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">const</span> json = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(data);
            <span class="hljs-keyword">if</span> (json.<span class="hljs-property">choices</span>?.[<span class="hljs-number">0</span>]?.<span class="hljs-property">delta</span>?.<span class="hljs-property">content</span>) {
              <span class="hljs-keyword">const</span> content = json.<span class="hljs-property">choices</span>[<span class="hljs-number">0</span>].<span class="hljs-property">delta</span>.<span class="hljs-property">content</span>;
              result += content;
              process.<span class="hljs-property">stdout</span>.<span class="hljs-title function_">write</span>(content); <span class="hljs-comment">// å®æ—¶è¾“å‡º</span>
            }
          } <span class="hljs-keyword">catch</span> (e) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"è§£æå“åº”å¤±è´¥:"</span>, e);
          }
        }
      }
    });

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
      response.<span class="hljs-property">data</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">"end"</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(result));
    });
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"è°ƒç”¨å¤±è´¥:"</span>, error);
  }
}

<span class="hljs-comment">// æ‰§è¡Œè°ƒç”¨</span>
<span class="hljs-title function_">callOllamaNodeStream</span>();
</code></pre>
<h4 data-id="heading-13">3.1.4 é€‚åˆåœºæ™¯</h4>
<ul>
<li>å¼€å‘è€…é›†æˆ AI èƒ½åŠ›åˆ°é¡¹ç›®ä¸­</li>
<li>å¿«é€Ÿæµ‹è¯•ä¸åŒæ¨¡å‹æ•ˆæœ</li>
<li>å°å›¢é˜Ÿæ­å»ºæœ¬åœ° API æœåŠ¡</li>
<li>ä¹ æƒ¯å‘½ä»¤è¡Œæ“ä½œçš„æŠ€æœ¯ç”¨æˆ·</li>
</ul>
<h4 data-id="heading-14">3.1.5 é¿å‘æŒ‡å—</h4>





















<table><thead><tr><th>[x] ä¸è¦</th><th>[+] å»ºè®®</th></tr></thead><tbody><tr><td>ç›´æ¥æš´éœ²å…¬ç½‘</td><td>å¿…é¡»è®¾ç½® API å¯†é’¥ + é™åˆ¶æœ¬åœ°è®¿é—®ï¼ˆé˜²èŒƒ CNVD-2025-04094 æ¼æ´ï¼‰</td></tr><tr><td>-</td><td>æ˜¾å­˜ä¸å¤Ÿï¼šä¼˜å…ˆé€‰æ‹© INT4 é‡åŒ–æ¨¡å‹ï¼ˆå‘½ä»¤ååŠ  -q4_0ï¼‰</td></tr><tr><td>-</td><td>å¯åŠ¨å¤±è´¥ï¼šWindows ç”¨æˆ·éœ€å®‰è£… Microsoft C++ ç”Ÿæˆå·¥å…·</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-15">3.2 LM Studio - æ™®é€šç”¨æˆ·æœ€ä½³é€‰æ‹©ãƒ»å›¾å½¢ç•Œé¢ç‹è€…</h3>
<h4 data-id="heading-16">3.2.1 å®šä½</h4>
<p>åƒç”¨ ChatGPT ä¸€æ ·ç®€å•ï¼Œé›¶ä»£ç é—¨æ§›</p>
<h4 data-id="heading-17">3.2.2 æ ¸å¿ƒä¼˜åŠ¿</h4>





























<table><thead><tr><th>ä¼˜åŠ¿</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>ç°ä»£åŒ– UI</strong></td><td>æ‹–æ‹½æ“ä½œï¼Œå¯è§†åŒ–ç®¡ç†æ¨¡å‹ï¼Œæ–°æ‰‹æ— å‹åŠ›</td></tr><tr><td><strong>å†…ç½®æ¨¡å‹å¸‚åœº</strong></td><td>æœç´¢ã€Œä¸­æ–‡ã€å³å¯ç­›é€‰æœ€ä¼˜æ¨¡å‹ï¼Œè‡ªåŠ¨æ¨èç¡¬ä»¶é€‚é…ç‰ˆæœ¬</td></tr><tr><td><strong>å›½å†…ä¼˜åŒ–</strong></td><td>å†…ç½® ModelScope é•œåƒï¼Œ10GB æ¨¡å‹ 5 åˆ†é’Ÿä¸‹è½½å®Œæˆ</td></tr><tr><td><strong>æ–‡æ¡£å¯¹è¯</strong></td><td>ä¸Šä¼  PDF/Word è‡ªåŠ¨è§£æï¼Œæ”¯æŒ 10 ä¸‡ Token é•¿æ–‡æœ¬é—®ç­”</td></tr><tr><td><strong>ç¡¬ä»¶åŠ é€Ÿ</strong></td><td>Apple Silicon/M3 èŠ¯ç‰‡å¯ç”¨ MLX 2.0ï¼Œæ€§èƒ½è¶… RTX 4090 2.2 å€</td></tr></tbody></table>
<h4 data-id="heading-18">3.2.3 å®‰è£…ä½¿ç”¨ï¼ˆWindows/Mac é€šç”¨ï¼‰</h4>
<ol>
<li>å®˜ç½‘ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Flmstudio.ai%2F%25EF%25BC%2588%25E6%2594%25AF%25E6%258C%2581" target="_blank" title="https://lmstudio.ai/%EF%BC%88%E6%94%AF%E6%8C%81" ref="nofollow noopener noreferrer">lmstudio.ai/ï¼ˆæ”¯æŒ</a> M3 / é”é¾™ AI å¤„ç†å™¨ï¼‰</li>
<li>å®‰è£…åæ‰“å¼€ï¼Œç‚¹å‡»å·¦ä¾§ã€ŒModel Hubã€ï¼Œæœç´¢ã€Œqwen2.5ã€ã€Œdeepseek-r1ã€</li>
<li>é€‰æ‹©ã€Œé€‚åˆæœ¬æœºçš„ç‰ˆæœ¬ã€ï¼ˆå¦‚ INT4/FP8ï¼‰ï¼Œç‚¹å‡»ã€ŒDownloadã€</li>
<li>ä¸‹è½½å®Œæˆåï¼Œç‚¹å‡»ã€ŒChatã€å³å¯å¼€å§‹å¯¹è¯</li>
<li>è¿›é˜¶åŠŸèƒ½ï¼šã€ŒSettingsã€â†’ã€ŒHardwareã€å¯ç”¨ã€ŒMLX Accelerationã€ï¼ˆMac ç”¨æˆ·ï¼‰</li>
</ol>
<h4 data-id="heading-19">3.2.4 é€‚åˆåœºæ™¯</h4>
<ul>
<li>ä¸æƒ³ç¢°å‘½ä»¤è¡Œçš„æ™®é€šç”¨æˆ·</li>
<li>Mac ç”¨æˆ·ï¼ˆç¡¬ä»¶åŠ é€Ÿä¼˜åŒ–æœ€ä½³ï¼‰</li>
<li>éœ€è¦å¯è§†åŒ–ç®¡ç†å¤šæ¨¡å‹</li>
<li>æ–‡æ¡£åˆ†æã€æ—¥å¸¸èŠå¤©ã€åŠå…¬è¾…åŠ©</li>
</ul>
<h4 data-id="heading-20">3.2.5 é¿å‘æŒ‡å—</h4>





















<table><thead><tr><th>[x] ä¸è¦</th><th>[+] å»ºè®®</th></tr></thead><tbody><tr><td>ç›²ç›®é€‰å¤§æ¨¡å‹</td><td>æ ¹æ®ç¡¬ä»¶è‡ªåŠ¨æ¨èçš„ç‰ˆæœ¬æœ€ä¼˜ï¼Œé¿å…æ˜¾å­˜ä¸è¶³</td></tr><tr><td>-</td><td>å¡é¡¿è§£å†³ï¼šå…³é—­èŠ‚èƒ½æ¨¡å¼ï¼Œå¯ç”¨ã€Œç¡¬ä»¶åŠ é€Ÿã€ï¼Œå…³é—­åå°å ç”¨ GPU çš„ç¨‹åº</td></tr><tr><td>-</td><td>ä¸­æ–‡ä¼˜åŒ–ï¼šä¼˜å…ˆé€‰æ‹©ã€ŒQwen2.5ã€ã€ŒDeepSeek-R1ã€ç­‰åŸç”Ÿä¸­æ–‡æ¨¡å‹</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-21">3.3 Jan - å®Œå…¨å…è´¹ãƒ»è·¨å¹³å°æ¡Œé¢åº”ç”¨</h3>
<h4 data-id="heading-22">3.3.1 å®šä½</h4>
<p>é›¶è´¹ç”¨ã€æ— å¹¿å‘Šçš„æœ¬åœ° + äº‘ç«¯æ··åˆéƒ¨ç½²å·¥å…·</p>
<h4 data-id="heading-23">3.3.2 æ ¸å¿ƒä¼˜åŠ¿</h4>





























<table><thead><tr><th>ä¼˜åŠ¿</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>100% å…è´¹</strong></td><td>æ‰€æœ‰åŠŸèƒ½ä¸é™æµï¼Œæ— ä»˜è´¹å¢™</td></tr><tr><td><strong>æ··åˆéƒ¨ç½²</strong></td><td>ä¸€é”®åˆ‡æ¢æœ¬åœ°æ¨¡å‹ï¼ˆéšç§ä¼˜å…ˆï¼‰/ äº‘ç«¯æ¨¡å‹ï¼ˆæ€§èƒ½ä¼˜å…ˆï¼‰</td></tr><tr><td><strong>æç®€è®¾è®¡</strong></td><td>ç•Œé¢æ¸…çˆ½æ— å¹¿å‘Šï¼Œæ“ä½œé€»è¾‘ç®€å•</td></tr><tr><td><strong>å…¨å¹³å°æ”¯æŒ</strong></td><td>Macã€Windowsã€Linux æ— ç¼é€‚é…</td></tr><tr><td><strong>æ–°ç‰¹æ€§</strong></td><td>æ”¯æŒé”é¾™ AI NPUã€æ¸…å¾® RPU ç¡¬ä»¶åŠ é€Ÿï¼Œæ˜¾å­˜å ç”¨é™ä½ 40%</td></tr></tbody></table>
<h4 data-id="heading-24">3.3.3 å®‰è£…ä½¿ç”¨</h4>
<ol>
<li>å®˜ç½‘ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fjan.ai%2F%25EF%25BC%2588%25E5%25AE%2589%25E8%25A3%2585%25E5%258C%2585%25E4%25BB%2585" target="_blank" title="https://jan.ai/%EF%BC%88%E5%AE%89%E8%A3%85%E5%8C%85%E4%BB%85" ref="nofollow noopener noreferrer">jan.ai/ï¼ˆå®‰è£…åŒ…ä»…</a> 20MBï¼‰</li>
<li>é¦–æ¬¡å¯åŠ¨å¼•å¯¼ï¼šé€‰æ‹©ã€ŒLocalã€ï¼ˆæœ¬åœ°æ¨¡å¼ï¼‰â†’ ç‚¹å‡»ã€ŒModel Libraryã€</li>
<li>æœç´¢ã€Œqwen2.5-miniã€ï¼ˆè½»é‡ä¸­æ–‡æ¨¡å‹ï¼‰ï¼Œç‚¹å‡»ã€ŒDownloadã€</li>
<li>ä¸‹è½½å®Œæˆåï¼Œç›´æ¥åœ¨èŠå¤©æ¡†è¾“å…¥æŒ‡ä»¤å³å¯ä½¿ç”¨</li>
<li>æ··åˆæ¨¡å¼åˆ‡æ¢ï¼šç‚¹å‡»é¡¶éƒ¨ã€ŒCloudã€ï¼Œç™»å½•åå¯ä½¿ç”¨äº‘ç«¯å¤§æ¨¡å‹ï¼ˆå…è´¹é¢åº¦ï¼‰</li>
</ol>
<h4 data-id="heading-25">3.3.4 é€‚åˆåœºæ™¯</h4>
<ul>
<li>é¢„ç®—æœ‰é™çš„ä¸ªäººç”¨æˆ·</li>
<li>éœ€è¦çµæ´»åˆ‡æ¢æœ¬åœ° / äº‘ç«¯æ¨¡å‹</li>
<li>æ³¨é‡éšç§åˆæƒ³å…¼é¡¾é«˜æ€§èƒ½</li>
<li>å­¦ç”Ÿã€èŒåœºæ–°äººæ—¥å¸¸åŠå…¬</li>
</ul>
<h4 data-id="heading-26">3.3.5 é¿å‘æŒ‡å—</h4>

















<table><thead><tr><th>[+] å»ºè®®</th></tr></thead><tbody><tr><td>æœ¬åœ°æ¨¡å‹é€‰æ‹©ï¼šä½é…ç”µè„‘ä¼˜å…ˆé€‰ã€Œ3B/7B INT4ã€ç‰ˆæœ¬</td></tr><tr><td>ä¸‹è½½æ…¢ï¼šåœ¨ã€ŒSettingsã€â†’ã€ŒModel Sourcesã€é€‰æ‹©ã€ŒModelScopeã€é•œåƒ</td></tr><tr><td>å¯åŠ¨æ…¢ï¼šå…³é—­ã€Œè‡ªåŠ¨æ›´æ–°æ¨¡å‹ã€ï¼Œæ‰‹åŠ¨æ›´æ–°æ›´çœèµ„æº</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-27">3.4 GPT4All - ä½é…ç”µè„‘æ•‘æ˜Ÿãƒ»è½»é‡ä¹‹ç‹</h3>
<h4 data-id="heading-28">3.4.1 å®šä½</h4>
<p>ä¸“ä¸ºè€ç”µè„‘ / ä½é…ç½®è®¾å¤‡ä¼˜åŒ–ï¼ŒCPU ä¹Ÿèƒ½æµç•…è¿è¡Œ</p>
<h4 data-id="heading-29">3.4.2 æ ¸å¿ƒä¼˜åŠ¿</h4>





























<table><thead><tr><th>ä¼˜åŠ¿</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>èµ„æºå ç”¨æä½</strong></td><td>æ— éœ€ GPUï¼Œ4GB å†…å­˜å³å¯è¿è¡Œ 3B ä¸­æ–‡æ¨¡å‹</td></tr><tr><td><strong>è½»é‡é«˜æ•ˆ</strong></td><td>å®‰è£…åŒ…ä»… 15MBï¼Œæ¨¡å‹è‡ªåŠ¨é‡åŒ–ä¼˜åŒ–</td></tr><tr><td><strong>é›¶é—¨æ§›æ“ä½œ</strong></td><td>å›¾å½¢ç•Œé¢ï¼ŒåŒå‡»å¯åŠ¨ï¼Œæ— éœ€ä»»ä½•é…ç½®</td></tr><tr><td><strong>ä¸€ä½“åŒ–åŠŸèƒ½</strong></td><td>é›†æˆèŠå¤©ã€æ–‡æ¡£åˆ†æã€ä»£ç ç”Ÿæˆï¼Œæ— éœ€é¢å¤–æ’ä»¶</td></tr><tr><td><strong>ä¸­æ–‡å‡çº§</strong></td><td>æ–°å¢ ChatGLM-3Bã€Qwen-2B-mini ç­‰ä¸­æ–‡è½»é‡æ¨¡å‹</td></tr></tbody></table>
<h4 data-id="heading-30">3.4.3 å®‰è£…ä½¿ç”¨</h4>
<ol>
<li>å®˜ç½‘ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgpt4all.io%2F%25EF%25BC%2588Windows%2FMac%2FLinux" target="_blank" title="https://gpt4all.io/%EF%BC%88Windows/Mac/Linux" ref="nofollow noopener noreferrer">gpt4all.io/ï¼ˆWindows/Maâ€¦</a> é€šç”¨ï¼‰</li>
<li>å®‰è£…åæ‰“å¼€ï¼Œç‚¹å‡»ã€ŒModel Explorerã€ï¼Œç­›é€‰ã€ŒChineseã€</li>
<li>é€‰æ‹©ã€ŒQwen-2B-mini-INT4ã€ï¼ˆä»…éœ€ 3GB å†…å­˜ï¼‰ï¼Œç‚¹å‡»ã€ŒDownloadã€</li>
<li>ä¸‹è½½å®Œæˆåï¼Œåˆ‡æ¢åˆ°ã€ŒChatã€æ ‡ç­¾å³å¯å¼€å§‹ä½¿ç”¨</li>
<li>æ€§èƒ½ä¼˜åŒ–ï¼šã€ŒSettingsã€â†’ã€ŒPerformanceã€é€‰æ‹©ã€ŒCPU+GPU æ··åˆæ¨¡å¼ã€</li>
</ol>
<h4 data-id="heading-31">3.4.4 é€‚åˆåœºæ™¯</h4>
<ul>
<li>è€ç”µè„‘ï¼ˆ5 å¹´å‰é…ç½®ï¼‰ã€æ— ç‹¬ç«‹æ˜¾å¡ç”¨æˆ·</li>
<li>æ˜¾å­˜ä¸è¶³ 4GB çš„è®¾å¤‡</li>
<li>ä»…éœ€è¦åŸºç¡€å¯¹è¯ã€ç®€å•æ–‡æ¡£å¤„ç†</li>
<li>ä¸´æ—¶ä½¿ç”¨ã€å¿«é€Ÿæ¼”ç¤ºåœºæ™¯</li>
</ul>
<h4 data-id="heading-32">3.4.5 é¿å‘æŒ‡å—</h4>





















<table><thead><tr><th>[x] ä¸è¦</th><th>[+] å»ºè®®</th></tr></thead><tbody><tr><td>é€‰æ‹© 13B+ å¤§æ¨¡å‹</td><td>ä½é…ç½®è®¾å¤‡ä¼šå¡é¡¿ç”šè‡³å´©æºƒ</td></tr><tr><td>-</td><td>ä¸­æ–‡æ•ˆæœï¼šä¼˜å…ˆé€‰ã€ŒQwen-2B-miniã€ã€ŒChatGLM-3Bã€ï¼Œé¿å…åŸç”Ÿè‹±æ–‡æ¨¡å‹</td></tr><tr><td>-</td><td>åŠ è½½æ…¢ï¼šå°†æ¨¡å‹æ–‡ä»¶æ”¾åœ¨ SSD ç¡¬ç›˜ï¼ŒåŠ è½½é€Ÿåº¦æå‡ 3 å€</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-33">3.5 LocalAI - ä¼ä¸šçº§ API æ›¿ä»£æ–¹æ¡ˆãƒ»ç”Ÿäº§ç¯å¢ƒé¦–é€‰</h3>
<h4 data-id="heading-34">3.5.1 å®šä½</h4>
<p>1:1 å…¼å®¹ OpenAI APIï¼Œä¼ä¸šå†…ç½‘éƒ¨ç½²ç¥å™¨</p>
<h4 data-id="heading-35">3.5.2 æ ¸å¿ƒä¼˜åŠ¿</h4>





























<table><thead><tr><th>ä¼˜åŠ¿</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>API å®Œå…¨å…¼å®¹</strong></td><td>æ— éœ€ä¿®æ”¹ä»£ç ï¼Œç›´æ¥æ›¿æ¢ OpenAI æ¥å£åœ°å€</td></tr><tr><td><strong>ä¼ä¸šçº§ç‰¹æ€§</strong></td><td>æ”¯æŒæƒé™ç®¡ç†ã€ç”¨æˆ·è®¤è¯ã€ç›‘æ§å‘Šè­¦ã€æ—¥å¿—å®¡è®¡</td></tr><tr><td><strong>é«˜æ€§èƒ½éƒ¨ç½²</strong></td><td>æ”¯æŒåˆ†å¸ƒå¼é›†ç¾¤ã€å¼ é‡å¹¶è¡Œï¼Œååé‡æå‡ 10 å€</td></tr><tr><td><strong>æ•°æ®å®‰å…¨</strong></td><td>å®Œå…¨æœ¬åœ°åŒ–éƒ¨ç½²ï¼Œç¬¦åˆç­‰ä¿ä¸‰çº§ã€GDPR åˆè§„è¦æ±‚</td></tr><tr><td><strong>å›½äº§åŒ–é€‚é…</strong></td><td>æ”¯æŒåä¸ºæ˜‡è…¾ã€æ¸…å¾® RPUã€æµ·å…‰ CPU ç­‰å›½äº§ç¡¬ä»¶</td></tr></tbody></table>
<h4 data-id="heading-36">3.5.3 ä¼ä¸šçº§éƒ¨ç½²å®æ“ï¼ˆDocker ç‰ˆï¼‰</h4>
<h5 data-id="heading-37">3.5.3.1 ç¯å¢ƒè¦æ±‚</h5>





















<table><thead><tr><th>é¡¹ç›®</th><th>è¦æ±‚</th></tr></thead><tbody><tr><td><strong>ç³»ç»Ÿ</strong></td><td>Ubuntu 22.04 LTSï¼ˆæ¨èï¼‰/ CentOS 8</td></tr><tr><td><strong>ç¡¬ä»¶</strong></td><td>GPU 24GB æ˜¾å­˜ï¼ˆA10G/H100ï¼‰æˆ– RPU TX81 åŠ é€Ÿå¡</td></tr><tr><td><strong>ä¾èµ–</strong></td><td>Docker 24.0+ã€Docker Compose</td></tr></tbody></table>
<h5 data-id="heading-38">3.5.3.2 éƒ¨ç½²å‘½ä»¤</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. åˆ›å»ºæŒ‚è½½ç›®å½•ï¼ˆå­˜å‚¨æ¨¡å‹å’Œé…ç½®ï¼‰</span>
<span class="hljs-built_in">mkdir</span> -p /localai/models /localai/config

<span class="hljs-comment"># 2. ç¼–å†™docker-compose.yml</span>
<span class="hljs-built_in">cat</span> &gt; docker-compose.yml &lt;&lt;<span class="hljs-string">'EOF'</span>
version: <span class="hljs-string">"3"</span>
services:
  localai:
    image: localai/localai:latest
    ports:
      - <span class="hljs-string">"8080:8080"</span>
    volumes:
      - /localai/models:/models
      - /localai/config:/etc/localai
    environment:
      - MODELS_PATH=/models
      - API_KEY=your_enterprise_api_key  <span class="hljs-comment"># ä¼ä¸šçº§APIå¯†é’¥</span>
      - LOG_LEVEL=info
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 2  <span class="hljs-comment"># 2å¼ GPUå¹¶è¡Œ</span>
              capabilities: [gpu]
EOF

<span class="hljs-comment"># 3. å¯åŠ¨æœåŠ¡</span>
docker-compose up -d

<span class="hljs-comment"># 4. ä¸‹è½½æ¨¡å‹ï¼ˆä»¥Qwen2.5-13Bä¸ºä¾‹ï¼‰</span>
curl -L https://mirror.modelscope.cn/qwen/Qwen2.5-13B-Chat-GGUF/qwen2.5-13b-chat-q4_0.gguf -o /localai/models/qwen2.5-13b.gguf
</code></pre>
<h5 data-id="heading-39">3.5.3.3 API è°ƒç”¨ç¤ºä¾‹</h5>
<p><strong>Node.js ç”Ÿäº§ç¯å¢ƒè°ƒç”¨ï¼ˆå¸¦é”™è¯¯å¤„ç†ï¼‰</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å…ˆå®‰è£…ä¾èµ–ï¼šnpm install axios</span>
<span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">"axios"</span>);

<span class="hljs-keyword">class</span> <span class="hljs-title class_">LocalAIClient</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">apiKey, baseUrl = <span class="hljs-string">"http://localhost:8080"</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">apiKey</span> = apiKey;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">baseUrl</span> = baseUrl;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">client</span> = axios.<span class="hljs-title function_">create</span>({
      <span class="hljs-attr">baseURL</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">baseUrl</span>,
      <span class="hljs-attr">headers</span>: {
        <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>,
        <span class="hljs-string">"Authorization"</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.apiKey}</span>`</span>
      },
      <span class="hljs-attr">timeout</span>: <span class="hljs-number">30000</span> <span class="hljs-comment">// 30ç§’è¶…æ—¶</span>
    });
  }

  <span class="hljs-comment">// æ™®é€šå“åº”è°ƒç”¨</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">chatComplete</span>(<span class="hljs-params">prompt, model = <span class="hljs-string">"qwen2.5-13b"</span></span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">client</span>.<span class="hljs-title function_">post</span>(<span class="hljs-string">"/v1/chat/completions"</span>, {
        model,
        <span class="hljs-attr">messages</span>: [{ <span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span>, <span class="hljs-attr">content</span>: prompt }],
        <span class="hljs-attr">temperature</span>: <span class="hljs-number">0.7</span>,
        <span class="hljs-attr">max_tokens</span>: <span class="hljs-number">2048</span>
      });
      <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>.<span class="hljs-property">choices</span>[<span class="hljs-number">0</span>].<span class="hljs-property">message</span>.<span class="hljs-property">content</span>;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Chatå®Œæˆè°ƒç”¨å¤±è´¥:"</span>, {
        <span class="hljs-attr">status</span>: error.<span class="hljs-property">response</span>?.<span class="hljs-property">status</span>,
        <span class="hljs-attr">data</span>: error.<span class="hljs-property">response</span>?.<span class="hljs-property">data</span>,
        <span class="hljs-attr">message</span>: error.<span class="hljs-property">message</span>
      });
      <span class="hljs-keyword">throw</span> error;
    }
  }

  <span class="hljs-comment">// æµå¼å“åº”è°ƒç”¨ï¼ˆé€‚åˆé•¿æ–‡æœ¬ï¼‰</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">chatStream</span>(<span class="hljs-params">prompt, model = <span class="hljs-string">"qwen2.5-13b"</span>, callback</span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">client</span>.<span class="hljs-title function_">post</span>(
        <span class="hljs-string">"/v1/chat/completions"</span>,
        {
          model,
          <span class="hljs-attr">messages</span>: [{ <span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span>, <span class="hljs-attr">content</span>: prompt }],
          <span class="hljs-attr">temperature</span>: <span class="hljs-number">0.7</span>,
          <span class="hljs-attr">stream</span>: <span class="hljs-literal">true</span>
        },
        { <span class="hljs-attr">responseType</span>: <span class="hljs-string">"stream"</span> }
      );

      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
        <span class="hljs-keyword">let</span> fullContent = <span class="hljs-string">""</span>;
        response.<span class="hljs-property">data</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">"data"</span>, <span class="hljs-function">(<span class="hljs-params">chunk</span>) =&gt;</span> {
          <span class="hljs-keyword">const</span> lines = chunk.<span class="hljs-title function_">toString</span>(<span class="hljs-string">"utf-8"</span>).<span class="hljs-title function_">split</span>(<span class="hljs-string">"\n"</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">line</span> =&gt;</span> line.<span class="hljs-title function_">trim</span>() !== <span class="hljs-string">""</span>);
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> line <span class="hljs-keyword">of</span> lines) {
            <span class="hljs-keyword">if</span> (line.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"data: "</span>)) {
              <span class="hljs-keyword">const</span> data = line.<span class="hljs-title function_">slice</span>(<span class="hljs-number">6</span>);
              <span class="hljs-keyword">if</span> (data === <span class="hljs-string">"[DONE]"</span>) <span class="hljs-keyword">return</span>;
              <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">const</span> json = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(data);
                <span class="hljs-keyword">const</span> content = json.<span class="hljs-property">choices</span>?.[<span class="hljs-number">0</span>]?.<span class="hljs-property">delta</span>?.<span class="hljs-property">content</span>;
                <span class="hljs-keyword">if</span> (content) {
                  fullContent += content;
                  callback?.(content); <span class="hljs-comment">// å®æ—¶å›è°ƒè¾“å‡º</span>
                }
              } <span class="hljs-keyword">catch</span> (e) {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"è§£ææµå¼å“åº”å¤±è´¥:"</span>, e);
              }
            }
          }
        });

        response.<span class="hljs-property">data</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">"end"</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(fullContent));
        response.<span class="hljs-property">data</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">"error"</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> <span class="hljs-title function_">reject</span>(err));
      });
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"æµå¼è°ƒç”¨å¤±è´¥:"</span>, error);
      <span class="hljs-keyword">throw</span> error;
    }
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">testLocalAI</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> client = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LocalAIClient</span>(<span class="hljs-string">"your_enterprise_api_key"</span>);

  <span class="hljs-comment">// 1. æ™®é€šè°ƒç”¨</span>
  <span class="hljs-keyword">const</span> result1 = <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">chatComplete</span>(<span class="hljs-string">"ç”Ÿæˆä¼ä¸šå¹´åº¦æ€»ç»“æ¨¡æ¿"</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ™®é€šè°ƒç”¨ç»“æœ:"</span>, result1);

  <span class="hljs-comment">// 2. æµå¼è°ƒç”¨</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµå¼è°ƒç”¨ç»“æœ:"</span>);
  <span class="hljs-keyword">const</span> result2 = <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">chatStream</span>(<span class="hljs-string">"ç”Ÿæˆä¼ä¸šå¹´åº¦æ€»ç»“æ¨¡æ¿"</span>, <span class="hljs-string">"qwen2.5-13b"</span>, <span class="hljs-function">(<span class="hljs-params">chunk</span>) =&gt;</span> {
    process.<span class="hljs-property">stdout</span>.<span class="hljs-title function_">write</span>(chunk); <span class="hljs-comment">// å®æ—¶è¾“å‡º</span>
  });
}

<span class="hljs-comment">// æ‰§è¡Œæµ‹è¯•</span>
<span class="hljs-title function_">testLocalAI</span>();
</code></pre>
<h4 data-id="heading-40">3.5.4 é€‚åˆåœºæ™¯</h4>
<ul>
<li>ä¼ä¸šå†…éƒ¨ AI æœåŠ¡éƒ¨ç½²</li>
<li>éœ€è¦æ›¿æ¢ OpenAI API çš„ç°æœ‰é¡¹ç›®</li>
<li>æ”¿åŠ¡ã€é‡‘èã€åŒ»ç–—ç­‰æ•æ„Ÿè¡Œä¸š</li>
<li>é«˜å¹¶å‘ã€é«˜å¯ç”¨çš„ç”Ÿäº§ç¯å¢ƒ</li>
</ul>
<h4 data-id="heading-41">3.5.5 é¿å‘æŒ‡å—</h4>

























<table><thead><tr><th>[x] ä¸è¦</th><th>[+] å»ºè®®</th></tr></thead><tbody><tr><td>ä¸ªäººç”¨æˆ·è·Ÿé£</td><td>é…ç½®å¤æ‚ï¼Œç»´æŠ¤æˆæœ¬é«˜</td></tr><tr><td>-</td><td>æ€§èƒ½ä¼˜åŒ–ï¼šå¯ç”¨ã€Œå¼ é‡å¹¶è¡Œã€ï¼ˆ--tensor-parallel-size 2ï¼‰ï¼Œå¤š GPU åˆ†æ‹…è´Ÿè½½</td></tr><tr><td>-</td><td>æ¨¡å‹é€‰æ‹©ï¼šä¼˜å…ˆé€‰ GGUF æ ¼å¼é‡åŒ–æ¨¡å‹ï¼Œæ˜¾å­˜å ç”¨é™ä½ 50%</td></tr><tr><td>-</td><td>å®‰å…¨é…ç½®ï¼šå¿…é¡»è®¾ç½® API å¯†é’¥ï¼Œé™åˆ¶å†…ç½‘è®¿é—®ï¼Œå®šæœŸæ›´æ–°é•œåƒ</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-42">4. æ€»ç»“</h2>
<p>æœ€åæ€»ç»“ä¸€ä¸‹ï¼š</p>
<ul>
<li><strong>Ollama</strong>ï¼šå¼€å‘è€…é›†æˆ AI èƒ½åŠ›åˆ°é¡¹ç›®ï¼Œå¿«é€Ÿæµ‹è¯•æ¨¡å‹ï¼Œæ­å»ºæœ¬åœ° API æœåŠ¡</li>
<li><strong>LM Studio</strong>ï¼šæ™®é€šç”¨æˆ·é›¶é—¨æ§›ä½¿ç”¨ï¼Œå¯è§†åŒ–ç®¡ç†æ¨¡å‹ï¼Œæ–‡æ¡£åˆ†æå’Œæ—¥å¸¸åŠå…¬</li>
<li><strong>Jan</strong>ï¼šé¢„ç®—æœ‰é™çš„ä¸ªäººç”¨æˆ·ï¼Œçµæ´»åˆ‡æ¢æœ¬åœ°/äº‘ç«¯æ¨¡å‹ï¼Œå…è´¹æ— å¹¿å‘Š</li>
<li><strong>GPT4All</strong>ï¼šè€ç”µè„‘å’Œä½é…è®¾å¤‡ï¼Œä»…éœ€åŸºç¡€å¯¹è¯å’Œç®€å•æ–‡æ¡£å¤„ç†</li>
<li><strong>LocalAI</strong>ï¼šä¼ä¸šå†…éƒ¨ AI æœåŠ¡éƒ¨ç½²ï¼Œæ›¿æ¢ OpenAI APIï¼Œæ»¡è¶³å®‰å…¨åˆè§„è¦æ±‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[25 å¹´ç»ˆæ€»ç»“ï¼šæŠ€æœ¯æ°´å¹³é£è·ƒ]]></title>    <link>https://juejin.cn/post/7595894884958289971</link>    <guid>https://juejin.cn/post/7595894884958289971</guid>    <pubDate>2026-01-18T04:47:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595894884958289971" data-draft-id="7595873251164700713" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="25 å¹´ç»ˆæ€»ç»“ï¼šæŠ€æœ¯æ°´å¹³é£è·ƒ"/> <meta itemprop="keywords" content="åç«¯,ç¨‹åºå‘˜,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-18T04:47:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ–¹åœ†æƒ³å½“å›¾çµ"/> <meta itemprop="url" content="https://juejin.cn/user/386633160473101"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            25 å¹´ç»ˆæ€»ç»“ï¼šæŠ€æœ¯æ°´å¹³é£è·ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/386633160473101/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ–¹åœ†æƒ³å½“å›¾çµ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T04:47:17.000Z" title="Sun Jan 18 2026 04:47:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ <strong>æ–¹åœ†</strong>ã€‚å¦‚å¾€å¹´ä¸€æ ·ï¼Œå¯¹å»å¹´è¿›è¡Œå›é¡¾æ€»ç»“ã€‚æˆ‘è§‰å¾— 25 å¹´æ˜¯æˆ‘æŠ€æœ¯æ°´å¹³è¿›æ­¥æœ€å¤šçš„ä¸€å¹´ï¼Œä¹Ÿåº”äº†å¹´åˆæˆ‘åœ¨ Github ä¸Šç»™è‡ªå·±å†™ä¸‹çš„å¯„è¯­ï¼š<strong>â€œPractice and protect my eyesâ€</strong>ï¼ŒæŠ€æœ¯çš„æå‡å‡ ä¹å…¨éƒ¨æ¥è‡ªäºä¸»åŠ¨è§£å†³å·¥ä½œä¸­é‡åˆ°çš„é—®é¢˜ï¼Œä½†ä¸ºäº†æŠ€æœ¯çš„æå‡ä¹Ÿä¸è¦å¿½è§†çœ¼éƒ¨å¥åº·ã€‚æ¥ä¸‹æ¥çš„å†…å®¹ä¸»è¦å…³äºæŠ€æœ¯æˆé•¿ï¼Œå¯¹ AI è½åœ°ä¸šåŠ¡çš„æ„Ÿå—ä»¥åŠç”Ÿæ´»æ„Ÿæ‚Ÿï¼Œå¸Œæœ›ä¹Ÿèƒ½å¯¹å¤§å®¶æœ‰ä¸€äº›å¯å‘ã€‚</p>
<h3 data-id="heading-0">æŠ€æœ¯æˆé•¿</h3>
<p>å¦‚å¼€ç¯‡æ‰€è®²çš„ï¼Œ25 å¹´æ˜¯æˆ‘å·¥ä½œå°†è¿‘ 4 å¹´æ¥æŠ€æœ¯æˆé•¿æœ€å¤šçš„ä¸€å¹´ã€‚å¹´åˆå› ä¸ºå¤§éƒ¨é—¨å®šä¸‹äº†é’ˆå¯¹ç°æœ‰åº”ç”¨åšæŠ€æœ¯æ”¹é€ çš„è§„åˆ’ï¼Œä¹Ÿæ°å¥½éƒ¨é—¨å†…æ ¸å¿ƒåº”ç”¨å­˜åœ¨ç—›ç‚¹ï¼Œå†åŠ ä¸Šéƒ¨é—¨ Leader çœ‹å¥½æˆ‘çš„æ½œåŠ›ï¼Œç›¸ä¿¡æˆ‘èƒ½åšå¥½è¿™ä»¶äº‹ï¼Œå¤©æ—¶åœ°åˆ©äººå’Œï¼Œæ‰€ä»¥ä¸»æŒæŠ€æ”¹è¿™ä»¶äº‹æƒ…ä¾¿è‡ªç„¶è€Œç„¶è½åˆ°æˆ‘çš„å¤´ä¸Šã€‚</p>
<p>è¦è¢«æŠ€æ”¹çš„åº”ç”¨æ‰¿æ¥é¢å‘ C ç«¯çš„æŸ¥è¯¢æµé‡ï¼Œä¿ƒé”€å³°å€¼æ—¶ QPS èƒ½è¾¾åˆ°å¤§å‡ åä¸‡ï¼Œè€Œä¸”æ€§èƒ½è¦æ±‚æé«˜ï¼Œåœ¨éƒ¨åˆ† C ç«¯åœºæ™¯è¦æ±‚ TP999 ç¨³å®šåœ¨ 20ms ä»¥å†…ï¼Œå¯ä»¥è¯´æ˜¯éå¸¸æ ¸å¿ƒçš„æœåŠ¡ã€‚ä½†æ˜¯è¿™ä¹ˆæ ¸å¿ƒçš„åº”ç”¨æ€ä¹ˆèƒ½è¯´æŠ€æ”¹å°±èƒ½æŠ€æ”¹å‘¢ï¼Ÿ</p>
<p>å®é™…ä¸Šä¸æ”¹è¿˜çœŸä¸è¡Œï¼Œæˆ‘å…ˆé—®å¤§å®¶ä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•æ‰èƒ½ä¿è¯åœ¨å‡ åä¸‡ QPS ä¸‹æ»¡è¶³ TP999 ç¨³å®šåœ¨ 20ms ä»¥å†…ï¼Ÿäº†è§£çš„å¤§å®¶å¯èƒ½ä¼šå›ç­”ï¼Œéœ€è¦å¤šå®ä¾‹éƒ¨ç½²å¹¶ä¸”å®ä¾‹å†…é‡‡ç”¨æœ¬åœ°ç¼“å­˜é¿å…ç½‘ç»œå¼€é”€æ—¶é—´æ¥åº”å¯¹å¤æ‚çš„æŸ¥è¯¢è¯·æ±‚ï¼Œæˆ‘ä»¬æ­£æ˜¯é‡‡ç”¨äº†è¿™ä¸ªæ–¹æ¡ˆã€‚åœ¨ç†è®ºä¸Šè¿™çš„ç¡®æ˜¯è§£å†³è¿™ç§åœºæ™¯ä¸‹é—®é¢˜çš„æœ€å¥½æ–¹å¼ï¼Œä½†æ˜¯ä¹Ÿä¼´éšç€æ¯”è¾ƒéš¾è§£å†³çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼šå¦‚ä½•æ‰èƒ½ä¿è¯æ•°æ®åº“æ•°æ®å‘ç”Ÿå˜æ›´åèƒ½åŠæ—¶åŒæ­¥åˆ°å¤šä¸ªæŸ¥è¯¢æœåŠ¡å®ä¾‹çš„æœ¬åœ°å†…å­˜ä¸­ï¼Ÿå¦‚ä½•æ‰èƒ½ä¿è¯æ¯ä¸ªæœåŠ¡å®ä¾‹çš„æœ¬åœ°ç¼“å­˜éƒ½æ›´æ–°æˆåŠŸï¼Ÿç°æœ‰æœåŠ¡æ­£æ˜¯å­˜åœ¨è¿™æ ·çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼šä¸šåŠ¡äººå‘˜ä¸Šåˆåœ¨ç³»ç»Ÿæ›´æ–°æ•°æ®ï¼Œå‘ç°æ•°æ®åœ¨ä¸‹åˆæŸ¥è¯¢æ—¶å¶å°”æŸ¥è¯¢æˆåŠŸå¶å°”æŸ¥è¯¢å¤±è´¥ï¼Œè¿™æ˜¯å› ä¸ºéƒ¨åˆ†å®ä¾‹æœ¬åœ°ç¼“å­˜æ›´æ–°æˆåŠŸéƒ¨åˆ†å®ä¾‹ç¼“å­˜æ›´æ–°å¤±è´¥ï¼Œé‚£æˆ‘ä»¬ç ”å‘å¦‚ä½•æ’æŸ¥è¿™ç§æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æ²¡åŠæ³•æ’æŸ¥ï¼Œå› ä¸ºé“¾è·¯å¤ªé•¿äº†ï¼Œå³ä½¿å‘ç°é—®é¢˜ä¹Ÿæ²¡æœ‰å¿«é€Ÿæ¢å¤çš„åŠæ³•ï¼Œå¿«é€Ÿè§£å†³é—®é¢˜çš„æ–¹å¼æ˜¯æŠŠå„ä¸ªå®ä¾‹åˆ†æ‰¹æ¬¡é‡å¯ä¸€éï¼Œè®©å®ƒä»¬é‡æ–°æ‹‰å–æœ€æ–°çš„å…¨é‡æ•°æ®ã€‚ä¸šåŠ¡å‹åŠ›å’Œéš¾ä»¥ç»´æŠ¤çš„ç³»ç»Ÿæ˜¯æœ¬æ¬¡æŠ€æ”¹çš„æ ¹æœ¬åŸå› ã€‚</p>
<p>é‚£å¤§å®¶å¯èƒ½è¦é—®äº†ï¼Œæ—¢ç„¶è¦æŠ€æ”¹äº†ï¼Œå’±ä»¬èƒ½ä¸èƒ½ä¸ç”¨æœ¬åœ°ç¼“å­˜äº†ï¼Œå’±ç”¨åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆå¦‚ Redisï¼‰è¡Œä¸è¡Œï¼Ÿè¿™æ ·æ˜¯ä¸æ˜¯ä¹Ÿèƒ½æ»¡è¶³æ€§èƒ½è¦æ±‚å¹¶ä¸”è§£å†³æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼Ÿåœ¨ä¸äº†è§£ä¸šåŠ¡çš„æƒ…å†µä¸‹ï¼Œç†è®ºä¸Šå¯è¡Œï¼Œä½†å¯¹äºæˆ‘ä»¬çš„ä¸šåŠ¡æ¥è¯´ï¼Œæ˜¯ä¸å¯è¡Œçš„ï¼Œå› ä¸ºè¿™ä¸ªæŸ¥è¯¢æ¥å£è¦ç”¨åˆ°è‡³å°‘å››é¡¹ç¼“å­˜ï¼Œå¤šæ¬¡ä¸ Redis çš„äº¤äº’äº§ç”Ÿçš„ç½‘ç»œå¼€é”€åŠ¿å¿…ä¼šå½±å“æŸ¥è¯¢æ€§èƒ½ï¼ˆTP999 20msï¼‰ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬çš„è¿™ä¸ªæœåŠ¡æ˜¯å¼‚åœ°å¤šæœºæˆ¿éƒ¨ç½²çš„ï¼Œå…¶ä»–æœåŠ¡è°ƒç”¨æˆ‘ä»¬çš„æœåŠ¡ä¼šé‡‡ç”¨åŒæœºæˆ¿å‚ç›´è°ƒç”¨çš„æ–¹å¼æ¥æé«˜æŸ¥è¯¢æ€§èƒ½ï¼Œé‚£ä¹ˆå¦‚æœé‡‡ç”¨ Redis çš„è¯ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿè¦å¤šæœºæˆ¿éƒ¨ç½² Redis æ‰èƒ½æ»¡è¶³æœºæˆ¿å‚ç›´è°ƒç”¨çš„æ€§èƒ½è¦æ±‚ï¼Ÿç›¸åº”åœ°ï¼Œå¦‚ä½•å°†ç°æœ‰æ•°æ®å†™å…¥ Redis ä¹Ÿæ˜¯æ¯”è¾ƒéš¾è§£å†³çš„é—®é¢˜ï¼Œæ¯”å¦‚æŸé¡¹æ•°æ®å¤§æ¦‚æœ‰ 80w+ æ¡ï¼Œè¯¥æ€ä¹ˆå†™å…¥åˆ° Redisï¼Ÿè¿™å°±åˆæ¶‰åŠåˆ°äº†å¦‚ä½•åˆ†ç‰‡çš„é—®é¢˜ï¼Œå³ä¾¿æ˜¯è€ƒè™‘å¥½äº† Redis åˆ†ç‰‡æ–¹æ¡ˆï¼Œå¤§æ¦‚ç‡åŸæœ‰æ¥å£é€»è¾‘ä¸­è¯»å–ç¼“å­˜çš„é€»è¾‘éœ€è¦å˜ï¼Œé‚£ä¹ˆæœ¬æ¬¡æŠ€æ”¹å¯èƒ½å°±å±äºé¢ è¦†å¼çš„é‡æ„äº†ï¼Œå¦‚æœè¿™æ ·çš„è¯å¤§å®¶å¿ƒé‡Œéƒ½ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼šâ€œè¿™ä¹ˆå¤§çš„æ”¹åŠ¨è°èƒ½ä¿è¯å®‰å…¨æ€§ï¼Ÿè€Œå› æ­¤é€ æˆçš„æŸå¤±åˆè¯¥ç”±è°æ¥æ‰¿æ‹…å‘¢ï¼Ÿâ€ï¼Œæ‰€ä»¥æœ¬æ¬¡æŠ€æ”¹å¹¶ <strong>ä¸æ˜¯ä¸ºç³»ç»Ÿå¤§åˆ€é˜”æ–§çš„åŠ¨æ‰‹æœ¯ï¼Œè€Œæ˜¯æœ›é—»é—®åˆ‡ï¼Œå®šä½ç³»ç»Ÿç—…ç¶ä¹‹åå¯¹ç—‡ä¸‹è¯</strong>ï¼Œè¿™ä¹Ÿæ˜¯æœ¬æ¬¡æŠ€æ”¹ä¸­æˆ‘ä»¬çš„æ¶æ„å¸ˆå¸¦ç»™æˆ‘çš„å¯ç¤ºï¼Œè§£å†³é—®é¢˜çš„åŒæ—¶ä¿è¯æ”¹åŠ¨æœ€å°ï¼Œå°†é£é™©æ§åˆ¶åœ¨é¢„æœŸèŒƒå›´å†…ï¼Œå¹¶åšå¥½å›æ»šé¢„æ¡ˆã€‚</p>
<p>ä¸ºäº†è¿™æ¬¡æŠ€æ”¹èƒ½å¤Ÿé«˜è´¨é‡çš„å®Œæˆï¼Œ<a href="https://juejin.cn/post/7461597730152300581" target="_blank" title="https://juejin.cn/post/7461597730152300581">é˜…è¯»äº† Caffeine ç­‰ä¸€ç³»åˆ—æœ¬åœ°ç¼“å­˜çš„æºç </a>ï¼Œä¸ºäº†ä¿è¯æœ¬åœ°ç¼“å­˜æ›´æ–°çš„é«˜å¯ç”¨ï¼Œé˜…è¯»äº† Nacos çš„æºç ï¼Œä¹Ÿå› æ­¤æˆä¸ºäº† Nacos å¼€æºé¡¹ç›®çš„ Contributorï¼Œå½“ç„¶è¿™æ˜¯æ„å¤–æ”¶è·ï¼Œæœ€åˆçš„æƒ³æ³•åªæ˜¯æƒ³å‚è€ƒ Nacos æ˜¯å¦‚ä½•ä¿è¯åˆç¨³åˆå¿«åˆ·æ–°é…ç½®çš„ï¼Œæˆ‘è§‰å¾—è¿™å¯¹æˆ‘ä»¬åšæŠ€æ”¹ä¼šæœ‰å¸®åŠ©ã€‚åœ¨åšæ–¹æ¡ˆè®¾è®¡çš„æ—¶å€™è¿™äº›å†…å®¹éƒ½ç»™äº†çµæ„Ÿï¼Œå¹¶ä¸”ä¹‹å‰å‡ å¹´å­¦ä¹ è¿‡çš„å…³äºåˆ†å¸ƒå¼ç³»ç»Ÿçš„çŸ¥è¯†ä¹Ÿæ³‰æ¶Œå‡ºæ¥ï¼Œâ€œæ•°æ®ä¸€è‡´æ€§â€ï¼Œâ€œåˆ†ç‰‡â€å’Œâ€œé«˜å¯ç”¨è®¾è®¡â€ç­‰ç­‰éƒ½ä¸å†æ˜¯ç©ºä¸­æ¥¼é˜è€Œæ˜¯çœŸæ­£è¾…åŠ©å·¥ç¨‹è½åœ°çš„ç†è®ºæŒ‡å¯¼ã€‚è¿™æ¬¡æŠ€æ”¹å¤§æ¦‚åœ¨ 25 å¹´æ˜¥èŠ‚å‰å®Œæˆäº†æ–¹æ¡ˆè®¾è®¡ï¼Œ3 æœˆä¸‹æ—¬ä¸Šçº¿ï¼ŒæœŸé—´æ²¡æœ‰æµ‹è¯•å·¥ç¨‹å¸ˆä»‹å…¥ï¼Œæˆ‘ä»¬è‡ªå·±åšå¥½äº†å®Œå–„çš„éªŒè¯å’Œä¸Šçº¿æ–¹æ¡ˆï¼Œä¸Šçº¿åä¹Ÿæœªäº§ç”Ÿé—®é¢˜ï¼Œæ˜¯ä¸€æ¬¡éå¸¸æŒ¯å¥‹äººå¿ƒçš„ç»å†ï¼Œå¯¹äºæˆ‘è€Œè¨€ä¹Ÿæ˜¯ä¸€æ¬¡éš¾å¾—çš„æŠ€æœ¯å®è·µï¼Œç»ˆäºè®©æˆ‘è‡ªå·±æ„Ÿå—åˆ°è‡ªå·±å¥½åƒçœŸçš„åœ¨æŠ€æœ¯ä¸Šæ‡‚ä¸€äº›ä¸œè¥¿äº†ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘åœ¨å·¥ä½œè¿™å‡ å¹´å†…ä¸€ç›´è‹¦è‹¦è¿½å¯»çš„ä¸œè¥¿ã€‚</p>
<p>åæ¥ï¼Œä¸ºäº†è§£å†³éƒ¨é—¨å†…æ…¢ SQL å®šä½çš„é—®é¢˜ï¼Œé€šè¿‡ Mybatis çš„æ‹¦æˆªå™¨æœºåˆ¶å¼€å‘äº† SQL æŸ“è‰²æ’ä»¶ï¼Œæ ‡è®°ä¸šåŠ¡æ‰§è¡Œå †æ ˆï¼Œèƒ½å¤Ÿä¸€çœ¼å®šä½ä¸šåŠ¡åœºæ™¯ï¼›ä¸ºäº†è§£å†³åº”ç”¨å¯åŠ¨æ—¶æ¥å£å“åº”æ…¢çš„é—®é¢˜ï¼Œè°ƒç ”å¹¶å®ç°äº†åº”ç”¨å¯åŠ¨æ—¶æµé‡é¢„çƒ­çš„æ–¹æ¡ˆï¼Œå› ä¸ºéƒ¨åˆ†æ¡†æ¶ä¸­çš„ç»„ä»¶æ˜¯æ‡’åŠ è½½çš„ï¼Œå¯¼è‡´å¯åŠ¨æ—¶æ¥å£ä¸Šçº¿é‚£ä¸€åˆ»è§¦å‘ç»„ä»¶çš„åˆå§‹åŒ–ï¼Œå¯¼è‡´æœ€åˆè¿›æ¥çš„æµé‡æ¥å£å“åº”è€—æ—¶å¾ˆé•¿ï¼Œå¦‚æœå€ŸåŠ©æµé‡é¢„çƒ­å®Œæˆè¿™ä¸€ç³»åˆ—ç»„ä»¶çš„é¢„åŠ è½½ï¼Œå†å‘å¸ƒæ¥å£ä¾¿èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ï¼›ä¸ºäº†è§£å†³ AI IDE æ— æ³•è·¨é¡¹ç›®å’Œåœ¨ Jar åŒ…ä¸­æ— æ³•è¯»å–æºç çš„é—®é¢˜ï¼Œ<a href="https://juejin.cn/post/7581004702928060425" target="_blank" title="https://juejin.cn/post/7581004702928060425">å¼€å‘å¹¶å¼€æºäº† MCP Server EasyCodeReader</a>ï¼Œç°åœ¨åœ¨ Github ä¸Šå·²ç»æœ‰äº† 105+ Starï¼Œå¦‚æœæ˜¯ Java å¼€å‘è€…çš„è¯ï¼Œè¿™ä¸ª MCP è‡³å°‘èƒ½æé«˜ 30% çš„å¼€å‘æ•ˆç‡ï¼Œä¹Ÿå› ä¸ºè¿™ä¸ª MCP ä¹Ÿè·å¾—äº†é›†å›¢çš„ä¸€äº› AI å®è·µå¥–é¡¹...</p>
<p>è¿™ä¸€å¹´è§£å†³äº†å¾ˆå¤šé—®é¢˜ï¼Œè¿™è®©æˆ‘è§‰å¾— <strong>â€œä»é—®é¢˜ä¸­æ¥ï¼Œåˆ°é—®é¢˜ä¸­å»â€æ˜¯å­¦ä¹ æŠ€æœ¯å’ŒæŠ€æœ¯æˆé•¿æœ€å¿«é€Ÿçš„ä¸€æ¡è·¯</strong>ï¼ŒæŠ€æœ¯æ— æ³•è„±ç¦»å·¥ç¨‹å®è·µï¼Œè„±ç¦»å·¥ç¨‹å®è·µçš„æŠ€æœ¯ä¹Ÿè¿Ÿæ—©ä¼šè¢«é—å¿˜åœ¨è®°å¿†çš„é•¿æ²³ä¸­ã€‚ä¸æ–­åœ°å‘ç°é—®é¢˜ã€è§£å†³é—®é¢˜ï¼Œè¿™ä¸ä»…ä»…ä¼šå¸¦æ¥æŠ€æœ¯æ°´å¹³çš„æå‡ï¼Œè€Œä¸”è¿˜ä¼šèµ¢å¾—éƒ¨é—¨å†…åŒäº‹çš„å°Šé‡ã€‚è¿™ä¹Ÿè®©æˆ‘å¾—åˆ°äº†æ›´å¤šçš„æœºä¼šï¼Œè®©æˆ‘æœ‰äº†æ›´é«˜çš„æŠ€æœ¯è§†é‡ï¼Œä¸å†å°†çœ¼å…‰åªæ”¾åœ¨ä¸€æ®µæ®µä»£ç ä¸Šï¼Œè€Œæ˜¯ä»æ›´é«˜çš„è§’åº¦è€ƒè™‘ç³»ç»Ÿè®¾è®¡å’Œéœ€æ±‚çš„è§„åˆ’ï¼Œè€ƒè™‘çš„ä¸å†æ˜¯è‡ªå·±æŠ€æœ¯çš„è¿›æ­¥ï¼Œè€Œæ˜¯å¦‚ä½•æ›´å¥½çš„å¸¦ç€éƒ¨é—¨å†…ä¸€ç¾¤äººè¿›æ­¥ï¼Œå¤§å®¶çš„èƒ½åŠ›æå‡ç›¸æ¯”äºä¸ªäººèƒ½åŠ›çš„ä¸€è¶…å¤šå¼ºï¼Œå¯¹äºéƒ¨é—¨æ¥è¯´ä»·å€¼æ˜¯æ›´å¤§çš„ã€‚</p>
<h3 data-id="heading-1">AI è½åœ°ä¸šåŠ¡å®è·µ</h3>
<p>åœ¨ 25 å¹´ 11 çš„æ—¶å€™éƒ¨é—¨æƒ³è¦åœ¨ç”µé”€åœºæ™¯ä½¿ç”¨å¤§æ¨¡å‹è¾…åŠ©å®Œæˆå®¢æœçš„è¯æœ¯è´¨æ£€ï¼Œå¾€å¾€å®¢æœä¸ºäº†è¾¾æˆé”€å”®ï¼Œä¼šå¯¹å•†å“åšä¸€äº›ä¸å®çš„æè¿°ï¼Œè€Œé¡¾å®¢å› ä¸ºè¿™äº›æè¿°è´­ä¹°å•†å“è€Œæœªè¾¾é¢„æœŸä¼šå¼•èµ·å¼ºçƒˆçš„å®¢è¯‰ã€‚æœ€åˆçš„è´¨æ£€çº¦æŸæ˜¯äººå·¥æŠ½æ£€ï¼Œå­˜åœ¨ç€äººåŠ›æˆæœ¬é«˜ï¼Œæ£€æŸ¥ä¸å…¨é¢å’Œè´¨æ£€æ•ˆç‡ä½çš„é—®é¢˜ï¼Œå¦‚æœé‡‡ç”¨å¤§æ¨¡å‹çš„è¯èƒ½å¤Ÿå¾ˆå¥½çš„è§£å†³è¿™äº›é—®é¢˜ã€‚æ‰€ä»¥æˆ‘å€ŸåŠ©é›†å›¢æä¾›çš„æ™ºèƒ½ä½“å¹³å°ï¼ˆç±»ä¼¼äº Difyï¼‰ï¼Œæ­å»ºäº†è´¨æ£€æ™ºèƒ½ä½“ï¼ŒæŒ‰ç…§ä¸€ä¸ªä¸ªè§„åˆ™ç»´åº¦æ‹†åˆ†ä¸ºå·¥ä½œæµï¼Œè´¨æ£€æ—¶å¹¶è¡Œè¿è¡Œå¹¶ä¼šè¿”å› JSON ç»“æœä¾›å·¥ç¨‹ç«¯å¤„ç†ã€‚</p>
<p>ä½†æ˜¯ï¼Œè¿™ä¸æ—¥å¸¸çš„è½¯ä»¶å¼€å‘æœ‰å¾ˆå¤§çš„ä¸åŒï¼šæ¨¡å‹ç»™çš„ç»“æœåé¦ˆ <strong>å……æ»¡äº†ä¸ç¡®å®šæ€§</strong>ï¼Œæ—¥å¸¸å¼€å‘ä¸­è°ƒæ•´æŸæ®µé€»è¾‘åœ¨æ²¡æœ‰ bug çš„æƒ…å†µä¸‹é€šå¸¸éƒ½èƒ½å¾—åˆ°é¢„æœŸçš„æ•ˆæœï¼Œè€Œåœ¨æ­å»ºæ™ºèƒ½ä½“æˆ–å·¥ä½œæµæ—¶ï¼Œæç¤ºè¯çš„æ”¹åŠ¨ä¸ä¸€å®šä¼šå¾—åˆ°é¢„æœŸçš„ç»“æœï¼Œè€Œä¸”è¿˜å¯èƒ½ä¼šå½±å“åŸæœ‰åœºæ™¯çš„å‡†ç¡®æ€§ï¼Œè¿™æ˜¯éå¸¸è€ƒéªŒè€å¿ƒçš„ï¼Œä¹Ÿæ˜¯æœ€åˆè®©æˆ‘å¤´ç–¼çš„ä¸€ç‚¹ï¼Œæˆ‘è¯¥å¦‚ä½•ä¿è¯æœ¬æ¬¡çš„æç¤ºè¯å˜æ›´æ˜¯æœ‰æ•ˆçš„ï¼Ÿä¿è¯å®ƒæ—¢ä¸å½±å“å†å²ç”¨ä¾‹çš„è´¨æ£€åˆèƒ½å¤„ç†æ–°çš„åœºæ™¯å‘¢ï¼Ÿæ‰€ä»¥ <strong>ç»´æŠ¤ç”¨ä¾‹é›†éå¸¸é‡è¦</strong>ï¼Œç”¨ä¾‹é›†ä¸­åŒ…å«æ­£å‘å’Œè´Ÿå‘çš„ç”¨ä¾‹ï¼Œæ¯æ¬¡å·¥ä½œæµå˜æ›´éƒ½éœ€è¦é‡æ–°å›å½’éªŒè¯æ‰€æœ‰ç”¨ä¾‹ï¼Œä¿è¯æœ¬æ¬¡æ”¹åŠ¨çš„æœ‰æ•ˆæ€§ï¼Œä½†æ˜¯é›†å›¢å†…åˆæ²¡æœ‰æä¾›å¥½ç”¨çš„å¹³å°æ€ä¹ˆåŠï¼Ÿæ‰€ä»¥è¿™éƒ¨åˆ†å†…å®¹æ˜¯ä¾é å­—èŠ‚çš„ PromptPilot æ¥å®Œæˆçš„ï¼Œå…¶ä¸­çš„ç”¨ä¾‹é›†ç®¡ç†å’Œæç¤ºè¯æ™ºèƒ½ä¼˜åŒ–ä¸ºæˆ‘ä»¬æé«˜è´¨æ£€å‡†ç¡®ç‡æä¾›äº†å¾ˆå¤§çš„å¸®åŠ©ï¼Œå”¯ä¸€ç—›ç‚¹æ˜¯ç”¨ä¾‹é›†åˆéœ€è¦æ‰‹å·¥å½•å…¥ï¼Œä¸èƒ½å®Œæˆç³»ç»Ÿé—´çš„è”åŠ¨ï¼Œå¦‚æœè¿™ä¸ªå¹³å°æ˜¯æˆ‘ä»¬å†…éƒ¨è‡ªå»ºçš„è¯ï¼Œåœ¨è´¨æ£€ç³»ç»Ÿä¸­å‘ç°å…¸å‹ç”¨ä¾‹ä¹‹åï¼Œé€šè¿‡æ¥å£å½¢å¼è‡ªåŠ¨å½•å…¥å¹³å°çš„ç”¨ä¾‹é›†ï¼Œè‡ªåŠ¨è¿›è¡Œæç¤ºè¯ä¼˜åŒ–ï¼Œå½¢æˆä¸€ç§â€œè‡ªå­¦ä¹ â€çš„æ¨¡å¼ï¼Œè¿™è¿˜ä¼šèŠ‚çœéƒ¨åˆ†äººåŠ›æˆæœ¬ã€‚ä½†å®é™…æƒ³æƒ³è¿™å…¶å®æ˜¯ä¸€é¡¹å·¥ç¨‹åŒ–çš„èƒ½åŠ›ï¼Œä¸ä»…ä»…æ˜¯ç”¨ä¾‹é›†ç®¡ç†å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼Œé›†å›¢æä¾›çš„æ™ºèƒ½ä½“å¹³å°æ­å»ºå·¥ä½œæµä¹Ÿå­˜åœ¨è¯¸å¤šä¸ä¾¿ï¼Œç›®å‰æ­å»ºå·¥ä½œæµæ˜¯ä»¥ä½ä»£ç çš„å½¢å¼ï¼Œå¼€å‘èµ·æ¥åœ¨é¡µé¢ä¸Šæ‹–æ‹–æ‹½æ‹½å¾ˆä¸æ–¹ä¾¿ï¼Œæä¾›çš„èŠ‚ç‚¹èƒ½åŠ›ä¹Ÿéå¸¸æœ‰é™ï¼Œæ¯”å¦‚è¯´ Python ä»£ç èŠ‚ç‚¹ï¼Œå®ƒä¼šé™å®šå¯¼å…¥åŒ…çš„èŒƒå›´ï¼Œä¸€äº›å¸¸æœ‰çš„åº“æ˜¯æ²¡åŠæ³•ç”¨çš„ï¼Œè€Œä¸”éƒ¨åˆ†ä»£ç é€»è¾‘ä¹Ÿæ²¡åŠæ³•å®ç°ç»Ÿä¸€çš„ç®¡ç†å’Œå¤ç”¨ã€‚</p>
<p>å³ä½¿æ˜¯è¿™æ ·ï¼Œè¿™ä¸ªé¡¹ç›®æœ€ç»ˆä¹Ÿè¾¾æˆäº†é™æœ¬å¢æ•ˆçš„ç›®çš„ï¼Œéƒ¨åˆ†è§„åˆ™çš„è´¨æ£€å‡†ç¡®ç‡è¾¾åˆ°äº† 70% ä»¥ä¸Šï¼Œå¤§å®¶å¯èƒ½è§‰å¾—è¿™ä¸ªæŒ‡æ ‡ä»ç„¶ä¸é«˜ï¼Œä½†æ˜¯è¿™å…¶ä¸­æœ‰å¾ˆå¤šé™åˆ¶æ¡ä»¶ï¼Œæ¯”å¦‚éŸ³è½¬æ–‡é”™è¯¯ç‡å¤§æ¦‚åœ¨ 20% å·¦å³ï¼Œå› ä¸ºå¤§æ¨¡å‹æ˜¯ä¾é éŸ³é¢‘è½¬æ–‡æœ¬ä¹‹åçš„å†…å®¹è¿›è¡Œè´¨æ£€çš„ï¼ŒéŸ³è½¬æ–‡çš„é”™è¯¯ä¼šç›´æ¥å½±å“è´¨æ£€ç»“æœï¼Œå½“ç„¶æˆ‘ä»¬å¯ä»¥åˆ‡æ¢æ›´å¥½çš„æ¨¡å‹å»åš ASR æˆ–è€…è´¨æ£€ï¼Œä½†æ˜¯æ›´å¥½çš„æ¨¡å‹ä¹Ÿæ„å‘³ç€æ›´é«˜çš„æˆæœ¬ï¼Œç†è®ºä¸Šå¯è¡Œä½†æ˜¯å®é™…è½åœ°è¿˜æ˜¯éœ€è¦æƒè¡¡æ¥è¾¾åˆ°ä¸€ä¸ªé¢„æœŸçš„å¹³è¡¡ï¼Œå¦‚æœä¸èƒ½ä¸ºä¸šåŠ¡å¸¦æ¥ä»·å€¼çš„è¯ï¼Œå²‚ä¸å°±æ˜¯ç©ºè°ˆäº†ã€‚</p>
<h3 data-id="heading-2">æ„Ÿæ‚Ÿ</h3>
<p>åœ¨æŠ€æœ¯ä¸Šï¼Œåšå®ŒæŠ€æ”¹ä¹‹åæƒ³åšä¸€ä¸‹ MIT çš„ 6.5840 åˆ†å¸ƒå¼å…¬å¼€è¯¾ï¼Œå› ä¸ºè¿™ä¸ªè¯¾ç¨‹çš„ Lab è¦æ±‚ä½¿ç”¨ Go è¯­è¨€å®Œæˆï¼Œæ‰€ä»¥<a href="https://juejin.cn/post/7488184878544076841" target="_blank" title="https://juejin.cn/post/7488184878544076841">ç‰¹æ„é˜…è¯»äº†ã€ŠHead First Go è¯­è¨€ç¨‹åºè®¾è®¡ã€‹</a>ï¼Œåœ¨æˆ‘çœ‹æ¥ Head First ç³»åˆ—ç›¸å¯¹æ¥è¯´æ˜¯èƒ½å¤Ÿæ¯”è¾ƒå¿«é€Ÿäº†è§£ä¸€é—¨æŠ€æœ¯çš„ä¹¦ç±ã€‚åæ¥ï¼Œé˜…è¯»äº†å›½äººå†™çš„ã€Šæ·±å…¥ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿã€‹ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªä¹¦ç»“åˆã€Šæ•°æ®å¯†é›†å‹ç³»ç»Ÿè®¾è®¡ã€‹ä¸€èµ·é˜…è¯»ä¼šæ›´å¥½ï¼Œä¹‹ååˆé˜…è¯»äº†<a href="https://juejin.cn/post/7546898394542243866" target="_blank" title="https://juejin.cn/post/7546898394542243866">ã€Šç”Ÿäº§å¾®æœåŠ¡ã€‹</a>å¹¶é‡æ–°é˜…è¯»äº†ã€Šå¾®æœåŠ¡æ¶æ„è®¾è®¡æ¨¡å¼ã€‹ï¼Œè¿™è®©æˆ‘å¯¹äºç°æœ‰ç³»ç»Ÿçš„è®¾è®¡æœ‰äº†æ›´æ·±åˆ»çš„ç†è§£ã€‚é—²æš‡ä¹‹ä½™çœ‹äº†ã€Šç½‘ç»œæ˜¯æ€æ ·è¿æ¥çš„ã€‹ï¼Œå°æ—¥å­å†™çš„ä¹¦çš„ç¡®æŒºä¸é”™çš„ï¼Œè¯»å®Œçš„æ—¶å€™åªæœ‰ä¸€ç§æ„Ÿæƒ³ï¼šâ€œä»€ä¹ˆæ—¶å€™å›½å†…ä¹Ÿæœ‰å¤§ä½¬æ¥å†™è¿™ä¹ˆç¡¬æ ¸çš„ä¹¦ç±å°±å¥½äº†â€ã€‚æœ€åä¸€æœ¬æŠ€æœ¯ä¹¦æ˜¯ã€Šä»é›¶æ„å»ºå¤§æ¨¡å‹ã€‹ï¼Œè¿™éƒ¨ä¹¦é˜…è¯»å¾—ä¸å¤Ÿæ·±å…¥ï¼Œè€Œä¸”æˆ‘æ‰“å¼€è¿™æœ¬ä¹¦çš„é¢„æœŸä¹Ÿä»…ä»…æ˜¯æƒ³äº†è§£å¤§æ¨¡å‹çš„å·¥ä½œåŸç†ï¼Œä¸å†æŠŠå®ƒå½“åšé»‘ç›’æ¥ç”¨ã€‚</p>
<p>æŠ€æœ¯ä¹‹å¤–çš„é˜…è¯»æˆ‘è§‰å¾—ä»Šå¹´ç»™æˆ‘æ”¶è·æœ€å¤šçš„æ˜¯ã€ŠèŠ’æ ¼ä¹‹é“ã€‹ï¼Œä¸€ä½å¯Œæœ‰æ™ºæ…§çš„ç†æ€§è€å¤´å­ï¼Œè¯»å®Œè¿™æœ¬ä¹¦ä¹‹åæˆ‘ä¹Ÿä¼šåˆ»æ„çš„æé†’è‡ªå·±åœ¨ä¸€äº›äº‹æƒ…ä¸Šè¦â€œåè¿‡æ¥æƒ³â€ï¼Œé€†å‘æ€ç»´å¾€å¾€åœ¨ç”Ÿæ´»ä¸­éå¸¸æœ‰å¸®åŠ©ï¼Œä¹‹ååˆé˜…è¯»äº†ã€Šç©·æŸ¥ç†å®å…¸ã€‹ï¼Œæˆ‘è§‰å¾—è¿™æœ¬ä¹¦çš„å…¸è—ç‰ˆæ’ç‰ˆå¤ªå·®ï¼Œæ— å…³å†…å®¹å¤ªå¤šï¼Œéå¸¸å½±å“é˜…è¯»ä½“éªŒï¼Œå¦‚æœå¤§å®¶æƒ³è¦é˜…è¯»çš„è¯ï¼Œå¯ä»¥é€‰æ‹©è¿™æœ¬ä¹¦çš„â€œå£è¢‹ç‰ˆâ€è¯•ä¸€è¯•ï¼Œä»·æ ¼æ›´ä¾¿å®œé˜…è¯»ä½“éªŒä¹Ÿæ›´å¥½ã€‚</p>
<p>åœ¨ç”Ÿæ´»ä¸Šï¼Œä¸å¥³æœ‹å‹çš„å…³ç³»æ›´åŠ ç´§å¯†ï¼Œä¹Ÿå¼€å§‹å…³æ³¨åˆ°è‡ªå·±çš„æ€§æ ¼ï¼Œå¸Œæœ›è‡ªå·±èƒ½å¤Ÿæ›´åŠ å¿ƒå¹³æ°”å’Œï¼ŒåŒæ—¶ä»Šå¹´ä¹Ÿå˜å¾—æ›´åŠ å…³å¿ƒå®¶äººï¼Œä¹Ÿæ›´æ„¿æ„èŠ±æ—¶é—´å’Œå®¶äººåœ¨ä¸€èµ·ï¼Œæˆ‘ä¹Ÿå¸Œæœ›æˆ‘è‡ªå·±æœªæ¥å‘ä¸Šçš„å‘å±•ä¹Ÿèƒ½æ›´å¤šçš„å¸¦ç»™ä»–ä»¬å¹¸ç¦ã€‚</p>
<hr/>
<p><strong>ç¥å¤§å®¶æ–°å¹´å¿«ä¹ï¼Œé©¬åˆ°æˆåŠŸ~</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‹’ç»â€œåªä¼šèŠå¤©â€çš„AIï¼æ­ç§˜Agentå¼€å‘ç¬¬ä¸€æ­¥ï¼šç»™å¤§æ¨¡å‹è£…ä¸Šâ€œå¤§è„‘â€ä¸â€œæ‰‹è„šâ€]]></title>    <link>https://juejin.cn/post/7595901379014705162</link>    <guid>https://juejin.cn/post/7595901379014705162</guid>    <pubDate>2026-01-17T14:24:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595901379014705162" data-draft-id="7595890117866143790" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‹’ç»â€œåªä¼šèŠå¤©â€çš„AIï¼æ­ç§˜Agentå¼€å‘ç¬¬ä¸€æ­¥ï¼šç»™å¤§æ¨¡å‹è£…ä¸Šâ€œå¤§è„‘â€ä¸â€œæ‰‹è„šâ€"/> <meta itemprop="keywords" content="Agent"/> <meta itemprop="datePublished" content="2026-01-17T14:24:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€ç›´åœ¨è¿½"/> <meta itemprop="url" content="https://juejin.cn/user/239028506736411"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‹’ç»â€œåªä¼šèŠå¤©â€çš„AIï¼æ­ç§˜Agentå¼€å‘ç¬¬ä¸€æ­¥ï¼šç»™å¤§æ¨¡å‹è£…ä¸Šâ€œå¤§è„‘â€ä¸â€œæ‰‹è„šâ€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/239028506736411/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€ç›´åœ¨è¿½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T14:24:54.000Z" title="Sat Jan 17 2026 14:24:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>æœ¬æ–‡ä»·å€¼æç¤ºï¼š</strong></p>
<blockquote>
<p>ğŸ’¡ <strong>ä½ å°†è·å¾—ä»€ä¹ˆï¼Ÿ</strong></p>
<ol>
<li><strong>åº•å±‚ç¥›é­…</strong>ï¼šè·³è¿‡ LangChain ç­‰æ¡†æ¶çš„é»‘ç›’ï¼Œä»åŸç”Ÿ API å±‚é¢ç†è§£ Agent æ˜¯å¦‚ä½•â€œåŠ¨â€èµ·æ¥çš„ã€‚</li>
<li><strong>æ€ç»´å‡çº§</strong>ï¼šä»å¤§æ•°æ®å·¥ç¨‹å¸ˆç†Ÿæ‚‰çš„ ETL çº¿æ€§æ€ç»´ï¼Œè½¬å‹ä¸º AI æ¶æ„å¸ˆå¿…å¤‡çš„â€œå¾ªç¯ï¼ˆLoopï¼‰æ€ç»´â€ã€‚</li>
<li><strong>å®æˆ˜ä»£ç </strong>ï¼šæŒæ¡ Function Calling å’Œ ReAct æ¨¡å¼çš„æ ¸å¿ƒå®ç°é€»è¾‘ã€‚</li>
</ol>
<p>â³ <strong>é˜…è¯»æ—¶é—´</strong>ï¼šçº¦ 8 åˆ†é’Ÿ | <strong>éš¾åº¦</strong>ï¼šè¿›é˜¶</p>
</blockquote>
<hr/>
<p>ğŸ‘‹ <strong>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ä½ ä»¬çš„è€æœ‹å‹ã€‚</strong></p>
<p>åœ¨ä¸Šä¸€æœŸçš„ã€ŠRAGæ¶æ„ä¸æ•°æ®å·¥ç¨‹ã€‹ä¸­ï¼Œæˆ‘ä»¬æˆåŠŸåœ°ç»™å¤§æ¨¡å‹è£…ä¸Šäº†â€œæµ·é©¬ä½“â€ï¼Œåˆ©ç”¨å‘é‡æ•°æ®åº“è®©å®ƒæ‹¥æœ‰äº†<strong>é•¿æœŸè®°å¿†</strong>ã€‚ç°åœ¨ï¼Œå®ƒå·²ç»æ˜¯ä¸€ä¸ªåšå­¦å¤šæ‰çš„â€œå›¾ä¹¦é¦†ç®¡ç†å‘˜â€äº†ã€‚</p>
<p>ä½†æ˜¯ï¼Œä½ æœ‰æ²¡æœ‰å‘ç°ï¼Œå®ƒä¾ç„¶åªèƒ½<strong>åç€è¯´è¯</strong>ï¼Ÿ</p>
<p>å®ƒä¸èƒ½å¸®ä½ æŸ¥å®æ—¶çš„å¤©æ°”ï¼Œä¸èƒ½å¸®ä½ å»æ•°æ®åº“è·‘ SQLï¼Œæ›´ä¸èƒ½å¸®ä½ å‘é‚®ä»¶ã€‚å®ƒå°±åƒä¸€ä¸ªè¢«å›°åœ¨ç“¶å­é‡Œçš„å¤©æ‰å¤§è„‘ï¼Œ<strong>æœ‰æ™ºå•†ï¼Œæ²¡è¡ŒåŠ¨åŠ›</strong>ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬æ­£å¼å¼€å¯<strong>ç¬¬å››ä¸ªä¸“é¢˜ï¼šAI Agent çš„å¼€å‘ä¸ç¼–æ’</strong>ã€‚ä½œä¸ºæœ¬ä¸“é¢˜çš„ç¬¬ä¸€ç¯‡ï¼Œæˆ‘ä»¬å°†æ·±å…¥ Agent çš„å¾®è§‚ä¸–ç•Œï¼Œä¸ä¾èµ–ä»»ä½•å¤æ‚çš„æ¡†æ¶ï¼Œäº²æ‰‹ç»™è¿™ä¸ªâ€œå¤§è„‘â€è£…ä¸Šâ€œæ‰‹è„šâ€ï¼ˆToolsï¼‰å’Œâ€œé€»è¾‘å›è·¯â€ï¼ˆReasoningï¼‰ã€‚</p>
<hr/>
<h2 data-id="heading-0">01 æ€ç»´å¤§çˆ†ç‚¸ï¼šä» ETL åˆ° Agent Loop ğŸ¤¯</h2>
<p>ä½œä¸ºå¤§æ•°æ®å·¥ç¨‹å¸ˆï¼Œä½ ä¸€å®šå¯¹ <strong>DAGï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰</strong> çƒ‚ç†Ÿäºå¿ƒã€‚åœ¨ Airflow æˆ– Spark ä¸­ï¼Œä»»åŠ¡æµæ˜¯çº¿æ€§çš„ã€ç¡®å®šçš„ï¼š
<code>æå–(E) -&gt; è½¬æ¢(T) -&gt; åŠ è½½(L)</code>ã€‚</p>
<p>å¦‚æœä¸­é—´æŠ¥é”™äº†ï¼Œä»»åŠ¡å°±æŒ‚äº†ï¼Œæˆ–è€…é‡è¯•ã€‚</p>
<p>ä½†åœ¨ Agent çš„ä¸–ç•Œé‡Œï¼Œé€»è¾‘æ˜¯<strong>éç¡®å®šæ€§</strong>çš„ï¼Œè€Œä¸”æ˜¯ä¸€ä¸ª<strong>å¾ªç¯ï¼ˆCyclicï¼‰</strong>ã€‚</p>
<h3 data-id="heading-1">ğŸ”„ Agent çš„æ ¸å¿ƒå¾ªç¯</h3>
<p>Agent ä¸æ˜¯ä¸€æ¡ç›´çº¿ï¼Œè€Œæ˜¯ä¸€ä¸ª <code>While True</code> çš„å¾ªç¯ï¼š</p>
<ol>
<li><strong>æ„ŸçŸ¥ (Observation)</strong>ï¼šçœ‹çœ‹ç°åœ¨å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</li>
<li><strong>æ€è€ƒ (Thought)</strong>ï¼šæˆ‘è¯¥åšä»€ä¹ˆï¼Ÿéœ€è¦ç”¨å·¥å…·å—ï¼Ÿ</li>
<li><strong>è¡ŒåŠ¨ (Action)</strong>ï¼šè°ƒç”¨å·¥å…·ï¼ˆAPI/å‡½æ•°ï¼‰ã€‚</li>
<li><strong>è§‚å¯Ÿ (Observation)</strong>ï¼šå·¥å…·è¿”å›äº†ä»€ä¹ˆç»“æœï¼Ÿ</li>
<li><strong>å›åˆ°ç¬¬ 2 æ­¥</strong>... ç›´åˆ°ä»»åŠ¡å®Œæˆã€‚</li>
<li><img src="http://openwrite.cn/uploads/20235/58487/ded66f57-0f05-4ce4-a32a-bd4063d76b31.png" alt="image.png" loading="lazy"/></li>
</ol>
<p><strong>æ¶æ„å¸ˆè§†ç‚¹</strong>ï¼š</p>
<blockquote>
<p>ä»¥å‰æˆ‘ä»¬å†™ä»£ç æ˜¯ç¼–å†™â€œè§„åˆ™â€ï¼Œç°åœ¨æˆ‘ä»¬å†™ Agent æ˜¯ç¼–å†™â€œç›®æ ‡â€å’Œâ€œè¾¹ç•Œâ€ã€‚ä½ æ— æ³•é¢„çŸ¥ LLM ä¼šå…ˆè¿ˆå·¦è„šè¿˜æ˜¯å³è„šï¼Œä½†ä½ è¦ç¡®ä¿å®ƒåˆ«æ‰è¿›å‘é‡Œã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-2">02 ç»™å¤§è„‘è£…ä¸Šâ€œæ‰‹è„šâ€ï¼šFunction Calling (Tool Use) ğŸ› ï¸</h2>
<p>LLM æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ¦‚ç‡æ¨¡å‹ï¼Œå®ƒåªä¼šåå‡ºæ–‡æœ¬ï¼ˆTextï¼‰ã€‚é‚£å®ƒæ€ä¹ˆè°ƒç”¨ Python å‡½æ•°æˆ–è€… API å‘¢ï¼Ÿ</p>
<p>è¿™å°±éœ€è¦ç”¨åˆ° OpenAI ç­‰æ¨¡å‹æä¾›çš„æ ¸å¿ƒèƒ½åŠ›ï¼š<strong>Function Callingï¼ˆå‡½æ•°è°ƒç”¨ï¼‰</strong>ï¼Œç°åœ¨æ›´é€šç”¨çš„å«æ³•æ˜¯ <strong>Tool Use</strong>ã€‚</p>
<h3 data-id="heading-3">è¿™é‡Œçš„â€œé­”æ³•â€æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>å…¶å®æ²¡æœ‰é­”æ³•ï¼Œåªæœ‰ <strong>Schemaï¼ˆç»“æ„å®šä¹‰ï¼‰</strong>ã€‚</p>
<p>æƒ³è±¡ä½ åœ¨é¤å…ç‚¹èœã€‚</p>
<ul>
<li><strong>æ™®é€šå¯¹è¯</strong>ï¼šâ€œæˆ‘è¦åƒé‚£ä¸ªçº¢è‰²çš„ã€è¾£çš„ã€æœ‰è±†è…çš„èœã€‚â€ï¼ˆå¨å¸ˆå¯èƒ½å¬ä¸æ‡‚ï¼‰</li>
<li><strong>Function Calling</strong>ï¼šä½ é€’ç»™å¨å¸ˆä¸€å¼ æ ‡å‡†ç‚¹èœå¡ï¼ˆJSON Schemaï¼‰ï¼š
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"dish_name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Mapo Tofu"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"spiciness_level"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"high"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"ingredients"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"tofu"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"minced meat"</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</li>
</ul>
<h3 data-id="heading-4">å®æˆ˜ï¼šåŸç”Ÿ SDK å®ç°å¤©æ°”æŸ¥è¯¢</h3>
<p>åˆ«æ€¥ç€å¼•å…¥ LangChainï¼Œæˆ‘ä»¬å…ˆçœ‹åŸç”Ÿ OpenAI SDK æ€ä¹ˆåšã€‚è¿™èƒ½è®©ä½ ç†è§£åº•å±‚åŸç†ã€‚</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šå®šä¹‰å·¥å…·ï¼ˆå‘Šè¯‰ LLM ä½ æœ‰å“ªäº›æ‰‹è„šï¼‰</strong>
æˆ‘ä»¬éœ€è¦ç”¨ JSON Schema æè¿°å‡½æ•°ã€‚</p>
<pre><code class="hljs language-python" lang="python">tools = [
    {
        <span class="hljs-string">"type"</span>: <span class="hljs-string">"function"</span>,
        <span class="hljs-string">"function"</span>: {
            <span class="hljs-string">"name"</span>: <span class="hljs-string">"get_current_weather"</span>,
            <span class="hljs-string">"description"</span>: <span class="hljs-string">"è·å–æŒ‡å®šåŸå¸‚çš„å½“å‰å¤©æ°”"</span>,
            <span class="hljs-string">"parameters"</span>: {
                <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>,
                <span class="hljs-string">"properties"</span>: {
                    <span class="hljs-string">"location"</span>: {
                        <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
                        <span class="hljs-string">"description"</span>: <span class="hljs-string">"åŸå¸‚åç§°ï¼Œå¦‚ Beijing, San Francisco"</span>
                    },
                    <span class="hljs-string">"unit"</span>: {<span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>, <span class="hljs-string">"enum"</span>: [<span class="hljs-string">"celsius"</span>, <span class="hljs-string">"fahrenheit"</span>]}
                },
                <span class="hljs-string">"required"</span>: [<span class="hljs-string">"location"</span>]
            }
        }
    }
]
</code></pre>
<p><strong>ç¬¬äºŒæ­¥ï¼šå¯¹è¯ä¸è§£æ</strong>
å½“ç”¨æˆ·é—®ï¼šâ€œä»Šå¤©åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿâ€ LLM ä¸ä¼šç›´æ¥å›ç­”â€œæ™´å¤©â€ï¼Œè€Œæ˜¯ä¼šè¿”å›ä¸€ä¸ª<strong>ç‰¹æ®Šçš„ç»“æ„</strong>ï¼Œå‘Šè¯‰æˆ‘ä»¬è¦è°ƒç”¨å‡½æ•°ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä¼ªä»£ç æ¼”ç¤º</span>
response = client.chat.completions.create(
    model=<span class="hljs-string">"gpt-4o"</span>,
    messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"åŒ—äº¬ä»Šå¤©å¤©æ°”å¦‚ä½•ï¼Ÿ"</span>}],
    tools=tools, <span class="hljs-comment"># å…³é”®ç‚¹ï¼šæŠŠå·¥å…·ç®±ä¼ ç»™å®ƒ</span>
    tool_choice=<span class="hljs-string">"auto"</span> 
)

tool_call = response.choices[<span class="hljs-number">0</span>].message.tool_calls[<span class="hljs-number">0</span>]
<span class="hljs-built_in">print</span>(tool_call.function.name) 
<span class="hljs-comment"># è¾“å‡º: get_current_weather</span>
<span class="hljs-built_in">print</span>(tool_call.function.arguments) 
<span class="hljs-comment"># è¾“å‡º: {"location": "Beijing"}</span>
</code></pre>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šæ‰§è¡Œä¸å›ä¼ </strong>
ä½œä¸ºå¼€å‘è€…ï¼Œä½ éœ€è¦æ•è·è¿™ä¸ª <code>tool_call</code>ï¼Œåœ¨æœ¬åœ°æ‰§è¡Œ Python ä»£ç ï¼Œç„¶åæŠŠç»“æœ<strong>ä¼ªè£…æˆä¸€æ¡æ¶ˆæ¯</strong>ï¼Œå¡å›ç»™ LLMã€‚</p>
<blockquote>
<p>âš ï¸ <strong>æ³¨æ„</strong>ï¼šLLM å¹¶æ²¡æœ‰çœŸæ­£æ‰§è¡Œä»£ç ï¼Œå®ƒåªæ˜¯ç”Ÿæˆäº†â€œè¦æ‰§è¡Œä»£ç çš„æŒ‡ä»¤â€ã€‚<strong>æ‰§è¡Œä»£ç çš„æ˜¯ä½ çš„ Python è„šæœ¬ï¼</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-5">03 å‡çº§å¤§è„‘çš„æ“ä½œç³»ç»Ÿï¼šPrompt ç­–ç•¥ä¸ ReAct ğŸ§ </h2>
<p>æœ‰äº†æ‰‹è„šï¼Œå¦‚æœå¤§è„‘ä¸å¤Ÿèªæ˜ï¼ŒAgent å°±ä¼šå˜æˆâ€œæ— å¤´è‹è‡â€ã€‚æˆ‘ä»¬éœ€è¦é€šè¿‡ Prompt Engineering æ¥å‡çº§å®ƒçš„æ€ç»´æ¨¡å¼ã€‚</p>
<h3 data-id="heading-6">1. CoT (Chain of Thought)ï¼šè®©å®ƒæ…¢ç‚¹æƒ³</h3>
<p>åœ¨å¤§æ•°æ®å¤„ç†ä¸­ï¼Œå¤æ‚çš„ SQL æˆ‘ä»¬ä¼šæ‹†æˆå¤šä¸ª CTE (Common Table Expression)ã€‚åŒç†ï¼Œå¯¹ LLMï¼Œæˆ‘ä»¬è¦å¼ºè¿«å®ƒ <code>Let's think step by step</code>ã€‚</p>
<p><strong>System Prompt ç¤ºä¾‹ï¼š</strong></p>
<blockquote>
<p>ä½ æ˜¯ä¸€ä¸ªæ•°æ®åˆ†æåŠ©æ‰‹ã€‚åœ¨å›ç­”ç”¨æˆ·é—®é¢˜å‰ï¼Œè¯·å…ˆåˆ—å‡ºä½ çš„æ€è€ƒæ­¥éª¤ï¼Œæ˜ç¡®ä½ éœ€è¦ä»€ä¹ˆæ•°æ®ï¼Œç„¶åå†è¡ŒåŠ¨ã€‚</p>
</blockquote>
<h3 data-id="heading-7">2. ReAct æ¨¡å¼ï¼šAgent çš„é»„é‡‘æ³•åˆ™</h3>
<p>ReAct æ˜¯ <strong>Re</strong>asoning + <strong>Act</strong>ing çš„ç¼©å†™ã€‚è¿™æ˜¯ç›®å‰æœ€ç»å…¸çš„ Agent è¿ä½œæ¨¡å¼ã€‚</p>
<p>å®ƒçš„æ ¸å¿ƒå’’è¯­æ˜¯ï¼š</p>
<ul>
<li><strong>Thought (æƒ³æ³•)</strong>ï¼šç”¨æˆ·æƒ³æŸ¥å¤©æ°”ï¼Œæˆ‘éœ€è¦è°ƒç”¨å¤©æ°”å·¥å…·ã€‚</li>
<li><strong>Action (è¡ŒåŠ¨)</strong>ï¼š<code>get_weather("Beijing")</code></li>
<li><strong>Observation (è§‚å¯Ÿ)</strong>ï¼šAPI è¿”å›äº† "25åº¦ï¼Œæ™´"ã€‚</li>
<li><strong>Thought (æƒ³æ³•)</strong>ï¼šæˆ‘å·²ç»æœ‰äº†å¤©æ°”ä¿¡æ¯ï¼Œå¯ä»¥å›ç­”ç”¨æˆ·äº†ã€‚</li>
<li><strong>Final Answer (æœ€ç»ˆå›ç­”)</strong>ï¼šåŒ—äº¬ä»Šå¤©å¤©æ°”ä¸é”™ï¼Œ25åº¦ï¼Œæ™´å¤©ã€‚</li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦ï¼Ÿ</strong>
å¦‚æœæ²¡æœ‰ ReActï¼Œæ¨¡å‹å¯èƒ½ä¼šäº§ç”Ÿ<strong>å¹»è§‰</strong>ã€‚æ¯”å¦‚å®ƒç›´æ¥ç¼–é€ ä¸€ä¸ªå¤©æ°”ï¼Œè€Œä¸æ˜¯å»è°ƒç”¨å·¥å…·ã€‚ReAct å¼ºåˆ¶æ¨¡å‹â€œçŸ¥è¡Œåˆä¸€â€ã€‚</p>
<hr/>
<h2 data-id="heading-8">04 æ¶æ„å¸ˆçš„â€œé˜²å‘†â€è®¾è®¡ï¼šPydantic ä¸ç»“æ„åŒ–è¾“å‡º ğŸ›¡ï¸</h2>
<p>ä½œä¸ºå·¥ç¨‹åŒ–è½¬å‹çš„ä½ ï¼Œè‚¯å®šå—ä¸äº† JSON è§£ææŠ¥é”™ã€‚
LLM è¾“å‡ºçš„ JSON ç»å¸¸å°‘ä¸ªæ‹¬å·ï¼Œæˆ–è€…å­—æ®µåå†™é”™ã€‚æ€ä¹ˆåŠï¼Ÿ</p>
<p><strong>Pydantic ç™»åœºï¼</strong>
Pydantic æ˜¯ Python ä¸­æœ€å¼ºçš„æ•°æ®éªŒè¯åº“ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥å¼ºåˆ¶ LLM è¾“å‡ºç¬¦åˆ Python ç±»å®šä¹‰çš„æ•°æ®ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel, Field

<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserIntent</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    intent: <span class="hljs-built_in">str</span> = Field(description=<span class="hljs-string">"ç”¨æˆ·çš„æ„å›¾ï¼Œå¦‚ query, command, chat"</span>)
    confidence: <span class="hljs-built_in">float</span> = Field(description=<span class="hljs-string">"ç½®ä¿¡åº¦ 0-1"</span>)
    keywords: <span class="hljs-built_in">list</span>[<span class="hljs-built_in">str</span>] = Field(description=<span class="hljs-string">"æå–çš„å…³é”®å®ä½“"</span>)

<span class="hljs-comment"># åœ¨ OpenAI æ–°ç‰ˆ SDK ä¸­ï¼Œå¯ä»¥ç›´æ¥ç»“åˆ Pydantic</span>
completion = client.beta.chat.completions.parse(
    model=<span class="hljs-string">"gpt-4o-2024-08-06"</span>,
    messages=[...],
    response_format=UserIntent, <span class="hljs-comment"># å¼ºç±»å‹çº¦æŸï¼</span>
)

intent_obj = completion.choices[<span class="hljs-number">0</span>].message.parsed
<span class="hljs-built_in">print</span>(intent_obj.confidence) <span class="hljs-comment"># ç›´æ¥è·å– float ç±»å‹ï¼Œæ— éœ€ json.loads</span>
</code></pre>
<p><strong>æ¶æ„å¸ˆæ€è€ƒ</strong>ï¼š
è¿™ä¸ä»…ä»…æ˜¯è¯­æ³•ç³–ï¼Œè¿™æ˜¯<strong>ç³»ç»Ÿç¨³å®šæ€§</strong>çš„ä¿éšœã€‚åœ¨ Agent ç¼–æ’ä¸­ï¼ŒèŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡å¿…é¡»æ˜¯ç»“æ„åŒ–çš„ï¼ˆSchemaï¼‰ï¼Œè€Œä¸æ˜¯éšæ„çš„è‡ªç„¶è¯­è¨€ã€‚</p>
<hr/>
<h2 data-id="heading-9">05 æ€»ç»“ä¸é¢„å‘Š ğŸ“</h2>
<p>ä»Šå¤©æˆ‘ä»¬å‰¥å¼€äº† Agent çš„å¤–è¡£ï¼Œçœ‹åˆ°äº†å®ƒæœ€åŸå§‹çš„â€œè¡€è‚‰â€ï¼š</p>
<ol>
<li><strong>ç†å¿µ</strong>ï¼šä»çº¿æ€§ Pipeline è½¬å‘ å¾ªç¯ Loopã€‚</li>
<li><strong>æ‰‹è„š</strong>ï¼šåˆ©ç”¨ <code>Function Calling</code> å®šä¹‰å·¥å…· Schemaã€‚</li>
<li><strong>å¤§è„‘</strong>ï¼šåˆ©ç”¨ <code>ReAct</code> æ¨¡å¼è¿›è¡Œâ€œæ€è€ƒ-è¡ŒåŠ¨-è§‚å¯Ÿâ€çš„å¾ªç¯ã€‚</li>
<li><strong>éª¨æ¶</strong>ï¼šåˆ©ç”¨ <code>Pydantic</code> ä¿è¯æ•°æ®æµè½¬çš„é²æ£’æ€§ã€‚</li>
</ol>
<h3 data-id="heading-10">ğŸ—ºï¸ æœ¬æ–‡æ ¸å¿ƒçŸ¥è¯†å›¾è°±</h3>
<p><img src="http://openwrite.cn/uploads/20235/58487/a6f99ea4-4fdd-43ec-a8be-9242443e8947.png" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-11">ğŸ£ äº’åŠ¨è¯é¢˜</h3>
<blockquote>
<p>ä½ åœ¨å°è¯•è®© LLM è°ƒç”¨å·¥å…·æ—¶ï¼Œé‡åˆ°è¿‡æœ€ç¦»è°±çš„â€œå¹»è§‰â€æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆæ¯”å¦‚ï¼šæ˜æ˜æ²¡æŸ¥æ•°æ®åº“ï¼Œå´ä¸€æœ¬æ­£ç»åœ°ç¼–é€ äº†æŸ¥è¯¢ç»“æœï¼Ÿï¼‰
æ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„â€œç¿»è½¦â€ç°åœºï¼</p>
</blockquote>
<h3 data-id="heading-12">ğŸš€ ä¸‹æœŸé¢„å‘Š</h3>
<p>å­¦ä¼šäº†å•ç‚¹æŠ€èƒ½ï¼Œå¦‚ä½•æ„å»ºå¤æ‚çš„ã€ç”Ÿäº§çº§çš„ Agent æµç¨‹ï¼Ÿ
ä¸‹ä¸€æœŸï¼Œæˆ‘ä»¬å°†è¿›å…¥<strong>ç¬¬äºŒç¯‡ï¼šå•ä½“ Agent æ¶æ„</strong>ã€‚æˆ‘ä»¬å°†æ·±åº¦å®æˆ˜ <strong>LangGraph</strong>ï¼Œå­¦ä¹ å¦‚ä½•ç”¨â€œå›¾â€çš„æ€ç»´æ¥ç¼–æ’ä¸€ä¸ªçœŸæ­£çš„æ•°æ®åˆ†æå¸ˆ Agentã€‚</p>
<p><strong>å…³æ³¨æˆ‘ï¼Œå¸¦ä½ ä»å¤§æ•°æ®å·¥ç¨‹å¸ˆç¡¬æ ¸è½¬å‹ AI æ¶æ„å¸ˆï¼</strong></p>
<hr/>
<p><em>è¿™æ˜¯â€œAI Agentå¼€å‘ä¸ç¼–æ’â€ä¸“é¢˜çš„ç¬¬ 1 ç¯‡ï¼Œå‰åºä¸“é¢˜ã€ŠPythoné«˜çº§å·¥ç¨‹åŒ–ã€‹ã€ã€Šå¤§æ¨¡å‹åŸºç¡€ç†è®ºã€‹ã€ã€ŠRAGæ¶æ„ä¸æ•°æ®å·¥ç¨‹ã€‹å·²å®Œç»“ï¼Œæ¬¢è¿ç¿»é˜…å†å²æ–‡ç« è¡¥è¯¾ã€‚</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Claude Code Skillsï¼šä»æ‰‹å†™åˆ°å·¥å…·åŒ–ï¼Œæ•™ AI æ–°æŠ€èƒ½çš„å®Œæ•´æŒ‡å—]]></title>    <link>https://juejin.cn/post/7596181746061656091</link>    <guid>https://juejin.cn/post/7596181746061656091</guid>    <pubDate>2026-01-17T14:25:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596181746061656091" data-draft-id="7596181746061639707" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Claude Code Skillsï¼šä»æ‰‹å†™åˆ°å·¥å…·åŒ–ï¼Œæ•™ AI æ–°æŠ€èƒ½çš„å®Œæ•´æŒ‡å—"/> <meta itemprop="keywords" content="Claude,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-17T14:25:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿è¡¡Eve"/> <meta itemprop="url" content="https://juejin.cn/user/254742428393310"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Claude Code Skillsï¼šä»æ‰‹å†™åˆ°å·¥å…·åŒ–ï¼Œæ•™ AI æ–°æŠ€èƒ½çš„å®Œæ•´æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/254742428393310/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿è¡¡Eve
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T14:25:07.000Z" title="Sat Jan 17 2026 14:25:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><blockquote>
<p>ğŸ’ å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯é˜¿è¡¡ï¼Œä¸€å¹´ç»éªŒç”¨äº†åæ¬¡çš„æ¸¸æˆåç«¯å¼€å‘ï¼Œè¾èŒåæˆä¸ºè‡ªç”±èŒä¸šã€ç‹¬ç«‹æ¸¸æˆå¼€å‘è€…ã€‚</p>
<p>éä¸“ä¸š AI ç©å®¶ï¼Œæ—¥å¸¸å…³æ³¨ AI ç¼–ç¨‹æ–¹å‘çš„å†…å®¹ã€‚</p>
</blockquote>
<p><strong>ğŸ¯ è¿™æ˜¯ Claude Code Skills ç³»åˆ—çš„ç¬¬ä¸€ç¯‡ï¼Œä¸»è¦ä»‹ç»ï¼šä»€ä¹ˆæ˜¯ Skillï¼Ÿå¦‚ä½•åˆ›å»º Skillã€‚</strong></p>
<p>ä½ æœ‰æ²¡æœ‰æƒ³è¿‡ï¼Œå¯ä»¥è‡ªå·±"æ•™" AI ä¸€é¡¹æ–°æŠ€èƒ½ï¼Ÿ</p>
<p>ä¸æ˜¯è°ƒå‚æ•°ï¼Œä¸æ˜¯å†™ä»£ç è®­ç»ƒæ¨¡å‹ï¼Œå°±æ˜¯ç®€å•åœ°å‘Šè¯‰å®ƒï¼š"ä»¥åé‡åˆ°è¿™ç§æƒ…å†µï¼Œä½ å°±è¿™ä¹ˆåšã€‚"</p>
<p>è¿™ç¯‡æ–‡ç« æ•™ä½ ä¸¤ç§æ–¹æ³•ï¼šä¸€ç§ 5 åˆ†é’Ÿæ‰‹å†™é€Ÿæˆï¼Œå¦ä¸€ç§ç”¨å®˜æ–¹å·¥å…·æ›´ä¸“ä¸šã€‚å­¦å®Œä¹‹åï¼Œä½ å°±èƒ½è®© Claude Code æŒ‰ä½ çš„è§„åˆ™å¹²æ´»äº†ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä»€ä¹ˆæ˜¯ Skillsï¼Ÿ</h2>
<p>è¯´ç™½äº†ï¼ŒSkills å°±æ˜¯ç»™ AI é…çš„ä¸€æœ¬"ä¸“å±æ”»ç•¥æ‰‹å†Œ"ã€‚</p>
<p>ä½ å¯èƒ½é‡åˆ°è¿‡è¿™ç§æƒ…å†µï¼šæ¯æ¬¡è®© Claude Code å¸®ä½ å†™ä»£ç ï¼Œéƒ½è¦é‡å¤è¯´ä¸€é"ç”¨ TypeScript"ã€"åŠ ä¸Šç±»å‹æ³¨é‡Š"ã€"éµå¾ªè¿™ä¸ªç›®å½•ç»“æ„"â€¦â€¦</p>
<p>çƒ¦ä¸çƒ¦ï¼Ÿ</p>
<p>æœ‰äº† Skillsï¼Œè¿™äº›è¯åªç”¨è¯´ä¸€æ¬¡ã€‚ä½ æŠŠè§„åˆ™å†™åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œï¼ŒClaude Code ä»¥åå°±è‡ªåŠ¨æŒ‰è¿™ä¸ªæ¥ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/07aee88a5fe846e1baeddcdea26e6113~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6KGhRXZl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769264706&amp;x-signature=aSypUFLCvoKXoeTccE4SuFfMUUU%3D" alt="Image" loading="lazy"/></p>
<p>ä»æŠ€æœ¯ä¸Šè¯´ï¼Œä¸€ä¸ª Skill å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œé‡Œé¢æ”¾ç€æŒ‡ä»¤å’Œèµ„æº[^1]ã€‚Claude Code ä¼šæŒ‰éœ€åŠ è½½è¿™äº›æ–‡ä»¶ï¼Œç”¨å®Œå°±é‡Šæ”¾ï¼Œæ‰€ä»¥å³ä½¿ä½ è£…äº†å‡ åä¸ª Skillsï¼Œä¹Ÿä¸ä¼šæ‹–æ…¢é€Ÿåº¦ã€‚</p>
<p>å®˜æ–¹çš„è¯´æ³•æ˜¯ï¼šæ¯ä¸ª Skill å¯åŠ¨æ—¶åªå ç”¨ 30-50 ä¸ª tokens[^2]ã€‚</p>
<hr/>
<h2 data-id="heading-1">æ–¹æ³•ä¸€ï¼š5 åˆ†é’Ÿæ‰‹å†™ä½ çš„ç¬¬ä¸€ä¸ª Skill</h2>
<p>æ¥ï¼Œåšä¸€ä¸ª"æ¯æ—¥æ€»ç»“"Skillâ€”â€”ä½ è¯´ä¸€å¥"å¸®æˆ‘æ€»ç»“ä»Šå¤©çš„å·¥ä½œ"ï¼Œå®ƒå°±è‡ªåŠ¨ç”Ÿæˆæ ¼å¼åŒ–çš„æ—¥æŠ¥ã€‚</p>
<h3 data-id="heading-2">Step 1: åˆ›å»ºæ–‡ä»¶å¤¹</h3>
<p>åœ¨ä½ çš„é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œåˆ›å»ºè¿™æ ·ä¸€ä¸ªç»“æ„ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.claude</span>/
â””â”€â”€ skills/
Â  Â  â””â”€â”€ daily-<span class="hljs-selector-tag">summary</span>/
Â  Â  Â  Â  â””â”€â”€ SKILL<span class="hljs-selector-class">.md</span>
</code></pre>
<p>å¯¹ï¼Œå°±è¿™ä¹ˆç®€å•ã€‚ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œä¸€ä¸ª Markdown æ–‡ä»¶ã€‚</p>
<h3 data-id="heading-3">Step 2: å†™ SKILL.md</h3>
<p>æ‰“å¼€Â <code>SKILL.md</code>ï¼Œå†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">daily-summary</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">å½“ç”¨æˆ·è¦æ±‚æ€»ç»“ä»Šå¤©çš„å·¥ä½œã€ç”Ÿæˆæ—¥æŠ¥ã€å›é¡¾è¿›å±•æ—¶ä½¿ç”¨ã€‚è‡ªåŠ¨æ•´ç†</span> <span class="hljs-string">git</span> <span class="hljs-string">commits</span> <span class="hljs-string">å’Œå®Œæˆçš„ä»»åŠ¡ï¼Œç”Ÿæˆæ ¼å¼åŒ–çš„å·¥ä½œæ€»ç»“ã€‚</span>
<span class="hljs-meta">---
</span>
<span class="hljs-comment"># æ¯æ—¥å·¥ä½œæ€»ç»“</span>

<span class="hljs-comment">## è§¦å‘æ¡ä»¶</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">ç”¨æˆ·è¯´"æ€»ç»“ä»Šå¤©çš„å·¥ä½œ"</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">ç”¨æˆ·è¯´"ç”Ÿæˆæ—¥æŠ¥"</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">ç”¨æˆ·è¯´"ä»Šå¤©åšäº†ä»€ä¹ˆ"</span>

<span class="hljs-comment">## æ‰§è¡Œæ­¥éª¤</span>
<span class="hljs-number">1</span><span class="hljs-string">.</span> <span class="hljs-string">è¯»å–ä»Šå¤©çš„</span> <span class="hljs-string">git</span> <span class="hljs-string">commitsï¼ˆå¦‚æœæœ‰ï¼‰</span>
<span class="hljs-number">2</span><span class="hljs-string">.</span> <span class="hljs-string">æ•´ç†å®Œæˆçš„ä»»åŠ¡</span>
<span class="hljs-number">3</span><span class="hljs-string">.</span> <span class="hljs-string">æŒ‰ä»¥ä¸‹æ ¼å¼è¾“å‡ºï¼š</span>

<span class="hljs-comment">## è¾“å‡ºæ ¼å¼</span>

<span class="hljs-comment">### ğŸ“… [æ—¥æœŸ] å·¥ä½œæ€»ç»“</span>

<span class="hljs-string">**å®Œæˆäº‹é¡¹**</span>
<span class="hljs-bullet">-</span> [ ] <span class="hljs-string">äº‹é¡¹1</span>
<span class="hljs-bullet">-</span> [ ] <span class="hljs-string">äº‹é¡¹2</span>

<span class="hljs-string">**æ˜æ—¥è®¡åˆ’**</span>
<span class="hljs-bullet">-</span> [ ] <span class="hljs-string">è®¡åˆ’1</span>

<span class="hljs-string">**å¤‡æ³¨**</span>
<span class="hljs-string">ï¼ˆå¯é€‰ï¼‰</span>
</code></pre>
<p>æ³¨æ„ä¸¤ä¸ªå…³é”®ç‚¹ï¼š</p>
<ol>
<li>YAML å¤´éƒ¨ï¼šname å’Œ description æ˜¯å¿…é¡»çš„ã€‚description ç‰¹åˆ«é‡è¦ï¼Œå®ƒå‘Šè¯‰ Claude ä»€ä¹ˆæ—¶å€™è¯¥ç”¨è¿™ä¸ª Skill[^3]ã€‚</li>
<li>æ­£æ–‡æŒ‡ä»¤ï¼šç”¨ Markdown å†™ä½ æƒ³è®© AI åšä»€ä¹ˆã€‚è¶Šæ¸…æ™°è¶Šå¥½ï¼Œä½†ä¸ç”¨å¤ªå•°å—¦â€”â€”å®˜æ–¹è¯´äº†ï¼Œ"Claude is already very smart"[^4]ã€‚</li>
</ol>
<h3 data-id="heading-4">Step 3: æµ‹è¯•æ•ˆæœ</h3>
<p>ä¿å­˜æ–‡ä»¶åï¼Œåœ¨ Claude Code é‡Œè¯´ä¸€å¥ï¼š"å¸®æˆ‘æ€»ç»“ä»Šå¤©çš„å·¥ä½œ"ã€‚</p>
<p>å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œä½ ä¼šçœ‹åˆ°å®ƒæŒ‰ç…§ä½ å®šä¹‰çš„æ ¼å¼ï¼Œè‡ªåŠ¨ç”Ÿæˆæ—¥æŠ¥äº†ã€‚</p>
<p>æœ‰æ—¶å€™å¦‚æœè‡ªåŠ¨åˆ¤å®šæ²¡å‘½ä¸­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨Â <code>/daily-summary</code>Â æ‰‹åŠ¨è§¦å‘ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/557fb9c313a34b3090134816e58316b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6KGhRXZl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769264706&amp;x-signature=RBNSIlGJT%2F%2FHV46DJ1ghIsUccG4%3D" alt="Image" loading="lazy"/></p>
<p><strong>å°è´´å£«</strong>ï¼šä» v2.1.1 å¼€å§‹ï¼ŒClaude Code æ”¯æŒçƒ­é‡è½½[^5]ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ æ”¹äº† SKILL.md ä¹‹åï¼Œä¸ç”¨é‡å¯ï¼Œé©¬ä¸Šå°±èƒ½ç”Ÿæ•ˆã€‚</p>
<hr/>
<h2 data-id="heading-5">æ–¹æ³•äºŒï¼šç”¨å®˜æ–¹ Skill Creator</h2>
<p>æ‰‹å†™å¾ˆå¿«ï¼Œä½†æœ‰ä¸ªé—®é¢˜ï¼šå¦‚æœä½ çš„ Skill æ¯”è¾ƒå¤æ‚ï¼Œéœ€è¦è„šæœ¬ã€èµ„æºæ–‡ä»¶ã€ç”šè‡³è¦åˆ†äº«ç»™å›¢é˜Ÿå‘¢ï¼Ÿ</p>
<p>è¿™æ—¶å€™ï¼Œå®˜æ–¹çš„ Skill Creator å°±æ´¾ä¸Šç”¨åœºäº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/259205824d9e4f54949fded98b51d7c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6KGhRXZl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769264706&amp;x-signature=0Hih9B2RWzZJIfNW9jXXGd6VMMo%3D" alt="Image" loading="lazy"/></p>
<p>ç®€å•åœºæ™¯ç”¨æ‰‹å†™ï¼Œå¤æ‚åœºæ™¯æˆ–è€…è¦åˆ†äº«çš„ï¼Œç”¨ skill-creatorã€‚</p>
<hr/>
<h2 data-id="heading-6">Skill Creator å®‰è£…ä¸ä½¿ç”¨</h2>
<h3 data-id="heading-7">å®‰è£… Skill Creator</h3>
<p>Skill Creator åœ¨ Anthropic å®˜æ–¹ä»“åº“ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fanthropics%2Fskills" target="_blank" title="https://github.com/anthropics/skills" ref="nofollow noopener noreferrer">github.com/anthropics/â€¦</a> ä¸­ å®‰è£…å¾ˆç®€å•ï¼š</p>
<p>åœ¨ Claude Code ä¸­è¾“å…¥ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1ï¼šå°†è¯¥ä»“åº“æ³¨å†Œä¸º Claude Code æ’ä»¶å¸‚åœº</span>
/plugin marketplace add anthropics/skills

<span class="hljs-comment"># 2ï¼šå®‰è£…ç‰¹å®š skill</span>
<span class="hljs-comment"># åŒ…æ‹¬å¾ˆå¤šæ–‡æ¡£å¤„ç†ç±»çš„ skill</span>
/plugin install document-skills@anthropic-agent-skills
<span class="hljs-comment"># è¿™é‡Œå°±åŒ…æ‹¬äº†æˆ‘ä»¬è¯´çš„ skill-creator</span>
/plugin install example-skills@anthropic-agent-skills
</code></pre>
<p>å®‰è£…å®Œæˆåï¼Œä½ å°±å¯ä»¥åœ¨ Claude Code é‡Œè¯´"å¸®æˆ‘åˆ›å»ºä¸€ä¸ªæ¯æ—¥å·¥ä½œæ€»ç»“ Skill"ï¼Œå®ƒä¼šè‡ªåŠ¨è°ƒç”¨ Skill Creator æ¥å¼•å¯¼ä½ ã€‚</p>
<h3 data-id="heading-8">å®˜æ–¹ Skills é€Ÿè§ˆ</h3>
<p>é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œå®˜æ–¹ä»“åº“é‡Œæœ‰ 16 ä¸ªç¤ºä¾‹ Skills[^6]ï¼Œæ¶µç›–å„ç§åœºæ™¯ï¼š</p>
<p>ç±»åˆ«</p>
<p>Skills</p>
<p>æ–‡æ¡£å¤„ç†</p>
<p>docx, pdf, pptx, xlsx</p>
<p>è®¾è®¡åˆ›ä½œ</p>
<p>algorithmic-art, canvas-design, frontend-design</p>
<p>å¼€å‘å·¥å…·</p>
<p>mcp-builder, webapp-testing</p>
<p>åä½œæ²Ÿé€š</p>
<p>doc-coauthoring, internal-comms</p>
<p>è¿™äº›ä¸å±•å¼€è®²äº†ï¼Œä½†å¼ºçƒˆå»ºè®®ä½ å»ç¿»ç¿»çœ‹â€”â€”å­¦ä¹ åˆ«äººæ€ä¹ˆå†™ Skillï¼Œæ¯”çœ‹æ–‡æ¡£æœ‰ç”¨å¤šäº†ã€‚</p>
<h3 data-id="heading-9">ç”¨ Skill Creator åˆ›å»º Skill</h3>
<p>ç°åœ¨ç”¨ Skill Creator é‡æ–°åˆ›å»ºé‚£ä¸ª"æ¯æ—¥æ€»ç»“"Skillã€‚</p>
<p>åœ¨ Claude Code é‡Œè¯´ï¼š</p>
<blockquote>
<p>"å¸®æˆ‘åˆ›å»ºä¸€ä¸ªæ–°çš„ Skillï¼Œç”¨äºç”Ÿæˆæ¯æ—¥å·¥ä½œæ€»ç»“"</p>
</blockquote>
<p>å½“ç„¶æœ€ç¨³å¦¥çš„æ–¹å¼è¿˜æ˜¯æ‰‹åŠ¨è§¦å‘ï¼ˆæˆ‘æ¯”è¾ƒå–œæ¬¢è¿™ç§ç¡®å®šæ€§ï¼‰ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/378d4ee4c0294d41a68f134c11fbb49d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6KGhRXZl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769264706&amp;x-signature=cph0HA%2B79Owjm%2Fb6NzF8Zp%2Fhg%2BY%3D" alt="Image" loading="lazy"/></p>
<p>Skill Creator ä¼šå¼•å¯¼ä½ å®Œæˆä»¥ä¸‹æ­¥éª¤[^7]ï¼š</p>
<ol>
<li>ç†è§£éœ€æ±‚ï¼šå®ƒä¼šé—®ä½ å‡ ä¸ªé—®é¢˜ï¼Œç¡®è®¤ Skill çš„ç”¨é€”</li>
<li>è§„åˆ’ç»“æ„ï¼šè‡ªåŠ¨å†³å®šéœ€è¦å“ªäº›æ–‡ä»¶</li>
<li>åˆå§‹åŒ–ï¼šåˆ›å»ºæ–‡ä»¶å¤¹å’ŒåŸºç¡€æ–‡ä»¶</li>
<li>ç¼–è¾‘ï¼šä½ å¯ä»¥è¿›ä¸€æ­¥è°ƒæ•´å†…å®¹</li>
<li>æ‰“åŒ…ï¼šç”Ÿæˆå¯åˆ†äº«çš„ Skill åŒ…</li>
<li>è¿­ä»£ï¼šæ ¹æ®ä½¿ç”¨åé¦ˆæŒç»­ä¼˜åŒ–</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/11772f1837c94526bd6eb59446eee6a1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6KGhRXZl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769264706&amp;x-signature=sQ9EwM5o7%2Bkm46BF2LYRjdnG3xo%3D" alt="Image" loading="lazy"/></p>
<p>ç”Ÿæˆçš„ç»“æ„å¯èƒ½æ˜¯è¿™æ ·ï¼š</p>
<pre><code class="hljs language-python" lang="python">daily-summary/
â”œâ”€â”€ SKILL.md Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment"># æ ¸å¿ƒæŒ‡ä»¤</span>
â”œâ”€â”€ scripts/
â”‚ Â  â””â”€â”€ get_commits.py Â  Â <span class="hljs-comment"># è·å– git commits çš„è„šæœ¬</span>
â””â”€â”€ references/
Â  Â  â””â”€â”€ <span class="hljs-built_in">format</span>.md Â  Â  Â  Â  <span class="hljs-comment"># è¾“å‡ºæ ¼å¼å‚è€ƒ</span>
</code></pre>
<p>æ¯”æ‰‹å†™çš„ç‰ˆæœ¬æ›´å®Œæ•´ã€æ›´è§„èŒƒã€‚è€Œä¸”å› ä¸ºéµå¾ªå®˜æ–¹æ ‡å‡†ï¼Œä»¥ååˆ†äº«ç»™å›¢é˜Ÿæˆ–è€…å‘å¸ƒåˆ°ç¤¾åŒºå¸‚åœºéƒ½å¾ˆæ–¹ä¾¿ã€‚</p>
<hr/>
<h2 data-id="heading-10">è¿›é˜¶æç¤º</h2>
<p>å†åˆ†äº«å‡ ä¸ªæŠ€å·§ï¼š</p>
<p><strong>çƒ­é‡è½½</strong>ï¼šæ”¹å®Œ SKILL.md ç«‹å³ç”Ÿæ•ˆï¼Œä¸ç”¨é‡å¯ Claude Codeã€‚è¿™ä¸ªç‰¹æ€§ä» v2.1.1 å¼€å§‹æ”¯æŒ[^5]ã€‚</p>
<p><strong>ç¤¾åŒºå¸‚åœº</strong>ï¼šå·²ç»æœ‰ç¤¾åŒº Skills å¸‚åœºäº†[^8]ã€‚åˆ«äººåˆ›å»ºçš„å¥½ Skill å¯ä»¥ç›´æ¥ç”¨ï¼Œä¸ç”¨è‡ªå·±é€ è½®å­ã€‚</p>
<p><strong>è¿­ä»£ä¼˜åŒ–</strong>ï¼šSkill ä¸æ˜¯ä¸€æ¬¡æ€§çš„ã€‚ç”¨ç€ç”¨ç€è§‰å¾—ä¸æ»¡æ„ï¼Œéšæ—¶æ”¹ã€‚AI ä¼šè¶Šæ¥è¶Šæ‡‚ä½ çš„éœ€æ±‚ã€‚</p>
<hr/>
<h2 data-id="heading-11">å†™åœ¨æœ€å</h2>
<p>ä¸¤ç§æ–¹æ³•ï¼Œå„æœ‰ä¼˜åŠ£ï¼š</p>
<ul>
<li>æ‰‹å†™ï¼š5 åˆ†é’Ÿé€Ÿæˆï¼Œé€‚åˆç®€å•åœºæ™¯ï¼Œå¸®ä½ ç†è§£åŸç†</li>
<li>Skill Creatorï¼šæ›´è§„èŒƒæ›´å®Œæ•´ï¼Œé€‚åˆå¤æ‚åœºæ™¯å’Œå›¢é˜Ÿåˆ†äº«</li>
</ul>
<p>Anthropic çš„äººè¯´è¿‡ä¸€å¥è¯ï¼Œæˆ‘è§‰å¾—å¾ˆæœ‰é“ç†[^9]ï¼š</p>
<blockquote>
<p>"Skills &gt; Agents"</p>
<p>æ¯”èµ·ä¸€æ¬¡æ€§çš„ Agentï¼ŒæŒç»­ç§¯ç´¯çš„ Skills æ›´æœ‰ä»·å€¼ã€‚</p>
</blockquote>
<p>ä½ æ„å»ºçš„ Skills è¶Šå¤šï¼ŒClaude Code å°±è¶Šæ‡‚ä½ ã€è¶Šæœ‰ç”¨ã€‚</p>
<p>æ‰€ä»¥ï¼Œåˆ«å…‰çœ‹ï¼Œå»åŠ¨æ‰‹è¯•è¯•å§ã€‚</p>
<p>åˆ›å»ºå±äºä½ çš„ç¬¬ä¸€ä¸ª Skillï¼Œå°±ä»ä»Šå¤©å¼€å§‹ã€‚</p>
<hr/>
<h2 data-id="heading-12">å‚è€ƒèµ„æ–™</h2>
<p>[1]: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fanthropics%2Fskills" target="_blank" title="https://github.com/anthropics/skills" ref="nofollow noopener noreferrer">Anthropic. "Skills Repository."</a> - Skills æ˜¯åŒ…å«æŒ‡ä»¤å’Œä»£ç çš„æ–‡ä»¶å¤¹</p>
<p>[2]: <a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2FtengyanAI%2Fstatus%2F1985341993036439736" target="_blank" title="https://x.com/tengyanAI/status/1985341993036439736" ref="nofollow noopener noreferrer">Teng Yan (@tengyanAI). "Skills æŠ€æœ¯æœ¬è´¨."</a> - æ¯ä¸ª Skill çº¦ 30-50 tokens</p>
<p>[3]: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fanthropics%2Fskills%2Fblob%2Fmain%2Fskills%2Fskill-creator%2FSKILL.md" target="_blank" title="https://github.com/anthropics/skills/blob/main/skills/skill-creator/SKILL.md" ref="nofollow noopener noreferrer">Anthropic. "skill-creator SKILL.md."</a> - description æ˜¯ä¸»è¦è§¦å‘æœºåˆ¶</p>
<p>[4]: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fanthropics%2Fskills%2Fblob%2Fmain%2Fskills%2Fskill-creator%2FSKILL.md" target="_blank" title="https://github.com/anthropics/skills/blob/main/skills/skill-creator/SKILL.md" ref="nofollow noopener noreferrer">Anthropic. "skill-creator."</a> - "Claude is already very smart"</p>
<p>[5]: <a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fericwang42%2Fstatus%2F2009097885988893132" target="_blank" title="https://x.com/ericwang42/status/2009097885988893132" ref="nofollow noopener noreferrer">Eric Wang (@ericwang42). "v2.1.1 æ›´æ–°."</a> - çƒ­é‡è½½ Skills æ”¯æŒ</p>
<p>[6]: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fanthropics%2Fskills" target="_blank" title="https://github.com/anthropics/skills" ref="nofollow noopener noreferrer">Anthropic. "Skills Repository."</a> - 16 ä¸ªå®˜æ–¹ç¤ºä¾‹ Skills</p>
<p>[7]: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fanthropics%2Fskills%2Fblob%2Fmain%2Fskills%2Fskill-creator%2FSKILL.md" target="_blank" title="https://github.com/anthropics/skills/blob/main/skills/skill-creator/SKILL.md" ref="nofollow noopener noreferrer">Anthropic. "skill-creator."</a> - 6 æ­¥åˆ›å»ºæµç¨‹</p>
<p>[8]: <a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2FtengyanAI%2Fstatus%2F1985341993036439736" target="_blank" title="https://x.com/tengyanAI/status/1985341993036439736" ref="nofollow noopener noreferrer">Teng Yan (@tengyanAI). "Skills å¸‚åœº."</a> - ç¤¾åŒºå¸‚åœºå·²ä¸Šçº¿</p>
<p>[9]: <a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fomarsar0%2Fstatus%2F1998383154181361813" target="_blank" title="https://x.com/omarsar0/status/1998383154181361813" ref="nofollow noopener noreferrer">elvis (@omarsar0). "Skills &gt; Agents."</a> - Anthropic æ¼”è®²æ ¸å¿ƒè§‚ç‚¹</p>
<hr/>
<p>ğŸ’¬ ä½ å¹³æ—¶æ˜¯æ€ä¹ˆåˆ›å»º Skill çš„ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„æ–¹æ³•ï¼</p>
<p>ğŸ‘ è§‰å¾—æœ‰ç”¨çš„è¯ï¼Œè®°å¾—ç‚¹èµæ”¶è—ï¼Œè®©æ›´å¤šäººçœ‹åˆ°è¿™ç¯‡æ–‡ç« ï¼</p>
<p><strong>é…å›¾è¯´æ˜</strong>ï¼šæœ¬æ–‡é…å›¾(é™¤æˆªå›¾å¤–ï¼‰ç”± Nano Banana Pro ç”Ÿæˆ</p>
<hr/>
<ul>
<li>#å…¬ä¼—å·ï¼šé˜¿è¡¡çš„AIæ—¥å¸¸</li>
<li>#å°çº¢ä¹¦ï¼šé˜¿è¡¡çš„AIæ—¥å¸¸</li>
<li>#CSDNï¼šDebugEve</li>
<li>#æ˜é‡‘ï¼šé˜¿è¡¡Eve</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç»™Claude Code/Cursoræˆ´ä¸Šâ€œç´§ç®å’’â€ï¼šSuperpowerså¦‚ä½•è®©AIç¼–ç¨‹å˜å¾—å¯é å¯æ§ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7595901379014819850</link>    <guid>https://juejin.cn/post/7595901379014819850</guid>    <pubDate>2026-01-17T14:46:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595901379014819850" data-draft-id="7595901379014787082" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç»™Claude Code/Cursoræˆ´ä¸Šâ€œç´§ç®å’’â€ï¼šSuperpowerså¦‚ä½•è®©AIç¼–ç¨‹å˜å¾—å¯é å¯æ§ï¼Ÿ"/> <meta itemprop="keywords" content="AIç¼–ç¨‹,å¼€æº"/> <meta itemprop="datePublished" content="2026-01-17T14:46:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§å‚æŠ€æœ¯æ€»ç›‘ä¸‹æµ·"/> <meta itemprop="url" content="https://juejin.cn/user/4091714106833577"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç»™Claude Code/Cursoræˆ´ä¸Šâ€œç´§ç®å’’â€ï¼šSuperpowerså¦‚ä½•è®©AIç¼–ç¨‹å˜å¾—å¯é å¯æ§ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4091714106833577/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§å‚æŠ€æœ¯æ€»ç›‘ä¸‹æµ·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T14:46:36.000Z" title="Sat Jan 17 2026 14:46:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Superpowers é¡¹ç›®æ·±åº¦æŠ€æœ¯åˆ†æï¼šAI ç¼–ç ä»£ç†çš„ç³»ç»ŸåŒ–å·¥ç¨‹æ¡†æ¶</h2>
<h3 data-id="heading-1">1. æ•´ä½“ä»‹ç»</h3>
<h4 data-id="heading-2">1.1 é¡¹ç›®æ¦‚è¦</h4>
<p><strong>é¡¹ç›®åç§°</strong>ï¼š<code>obra/superpowers</code><br/>
<strong>é¡¹ç›®åœ°å€</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fobra%2Fsuperpowers" target="_blank" title="https://github.com/obra/superpowers" ref="nofollow noopener noreferrer">github.com/obra/superpâ€¦</a><br/>
<strong>é¡¹ç›®æ€§è´¨</strong>ï¼šä¸€ä¸ªä¸ºAIç¼–ç ä»£ç†ï¼ˆClaude Code, Codex, OpenCodeï¼‰æ„å»ºçš„ã€åŸºäºæ¨¡å—åŒ–â€œæŠ€èƒ½â€çš„è½¯ä»¶å¼€å‘å·¥ä½œæµå¢å¼ºç³»ç»Ÿã€‚å®ƒé€šè¿‡å¼ºåˆ¶æ€§çš„æµç¨‹å’Œè§„èŒƒï¼Œå°†AIçš„ä»£ç ç”Ÿæˆèƒ½åŠ›å¯¼å‘ç³»ç»ŸåŒ–çš„è½¯ä»¶å·¥ç¨‹å®è·µã€‚</p>
<p><em>ï¼ˆæ³¨ï¼šæœ¬æ–‡åŸºäºæä¾›çš„é¡¹ç›®ä»£ç è¿›è¡Œåˆ†æï¼Œæœªå®æ—¶æŸ¥è¯¢GitHub starä¸forkæ•°æ®ï¼Œæ•…ä¸ä½œå…·ä½“æ•°å­—è¯´æ˜ï¼‰</em></p>
<h4 data-id="heading-3">1.2 æ ¸å¿ƒåŠŸèƒ½ä¸ä»·å€¼ä¸»å¼ </h4>
<p>Superpowers çš„æ ¸å¿ƒåŠŸèƒ½ä¸æ˜¯æä¾›æ–°çš„ä»£ç åº“æˆ–ç®—æ³•ï¼Œè€Œæ˜¯å®šä¹‰å¹¶å¼ºåˆ¶æ‰§è¡Œä¸€å¥—<strong>AIè¾…åŠ©å¼€å‘çš„å·¥ä½œæµ</strong>ã€‚å…¶æ ¸å¿ƒäº¤äº’æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ¸…æ™°å±•ç¤ºäº†ä»éœ€æ±‚æ¾„æ¸…åˆ°æœ€ç»ˆé›†æˆçš„è‡ªåŠ¨åŒ–è¿‡ç¨‹ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant U as ç”¨æˆ·/å¼€å‘è€…
    participant M as ä¸»AIä»£ç† (Main Agent)
    participant S as Superpowers æŠ€èƒ½ç³»ç»Ÿ
    participant SA as å­ä»£ç† (Sub-agent)
    participant G as Git/æ–‡ä»¶ç³»ç»Ÿ

    U-&gt;&gt;M: æå‡ºä¸€ä¸ªå¼€å‘æƒ³æ³•ï¼ˆå¦‚â€œåŠ ä¸ªç™»å½•åŠŸèƒ½â€ï¼‰
    M-&gt;&gt;S: è§¦å‘ `brainstorming` æŠ€èƒ½
    S-&gt;&gt;U: è¿›è¡Œå¤šè½®é—®ç­”ï¼Œæ¾„æ¸…éœ€æ±‚
    U-&gt;&gt;S: ç¡®è®¤åˆ†æ®µè®¾è®¡
    S-&gt;&gt;G: ä¿å­˜è®¾è®¡æ–‡æ¡£åˆ° `docs/plans/`
    
    M-&gt;&gt;S: è§¦å‘ `using-git-worktrees` æŠ€èƒ½
    S-&gt;&gt;G: åˆ›å»ºç‹¬ç«‹Gitå·¥ä½œæ ‘åˆ†æ”¯
    
    M-&gt;&gt;S: è§¦å‘ `writing-plans` æŠ€èƒ½
    S-&gt;&gt;M: ç”Ÿæˆè¯¦ç»†åˆ°åˆ†é’Ÿçº§çš„å®æ–½è®¡åˆ’
    
    loop å¯¹äºè®¡åˆ’ä¸­çš„æ¯ä¸ªä»»åŠ¡
        M-&gt;&gt;S: è§¦å‘ `subagent-driven-development`
        S-&gt;&gt;SA: æ´¾å‘ä»»åŠ¡ç»™ä¸€ä¸ªå…¨æ–°å­ä»£ç†
        SA-&gt;&gt;SA: æ‰§è¡Œä»»åŠ¡ï¼ˆç¼–ç ï¼‰
        SA-&gt;&gt;SA: è‡ªæˆ‘å®¡æŸ¥
        S-&gt;&gt;SA: å¯åŠ¨ä¸¤é˜¶æ®µå®¡æŸ¥ï¼ˆè§„æ ¼ã€è´¨é‡ï¼‰
        alt å®¡æŸ¥å‘ç°é—®é¢˜
            SA-&gt;&gt;SA: è¿›å…¥å®¡æŸ¥å¾ªç¯ä¿®æ­£
        end
        SA-&gt;&gt;G: æäº¤ä»£ç å˜æ›´
    end
    
    M-&gt;&gt;S: è§¦å‘ `requesting-code-review` æŠ€èƒ½
    S-&gt;&gt;M: æŠ¥å‘Šå®¡æŸ¥é—®é¢˜ï¼ˆåˆ†ä¸¥é‡çº§åˆ«ï¼‰
    
    M-&gt;&gt;S: è§¦å‘ `finishing-a-development-branch` æŠ€èƒ½
    S-&gt;&gt;U: æä¾›é€‰é¡¹ï¼ˆåˆå¹¶/PR/ä¿ç•™/ä¸¢å¼ƒï¼‰
    U-&gt;&gt;G: é€‰æ‹©å¹¶å®Œæˆåˆ†æ”¯æ“ä½œ
</code></pre>
<p><strong>é¢ä¸´çš„é—®é¢˜ä¸ç›®æ ‡äººç¾¤</strong>ï¼š</p>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šå½“å‰AIç¼–ç ä»£ç†ï¼ˆå¦‚Claude Codeï¼‰åœ¨å“åº”å¼€æ”¾å¼ç¼–ç¨‹è¯·æ±‚æ—¶ï¼Œè¡Œä¸ºå…·æœ‰ä¸ç¡®å®šæ€§ã€‚å®ƒå¯èƒ½ç›´æ¥ç”Ÿæˆæœªç»æ·±æ€ç†Ÿè™‘çš„ä»£ç ã€è·³è¿‡æµ‹è¯•ã€å¿½è§†æ¶æ„ä¸€è‡´æ€§æˆ–äº§ç”Ÿä¸å¿…è¦çš„å¤æ‚æ€§ï¼ˆè¿åYAGNIåŸåˆ™ï¼‰ã€‚</li>
<li><strong>ç›®æ ‡äººç¾¤</strong>ï¼šä¾èµ–AIä»£ç†è¿›è¡Œä¸­å¤§å‹æˆ–ç”Ÿäº§çº§é¡¹ç›®å¼€å‘çš„è½¯ä»¶å·¥ç¨‹å¸ˆã€æŠ€æœ¯å›¢é˜Ÿé¢†å¯¼è€…ã€‚ä»–ä»¬éœ€è¦AIçš„è¾…åŠ©æ•ˆç‡ï¼Œä½†å¿…é¡»ç¡®ä¿äº§å‡ºä»£ç çš„<strong>å¯ç»´æŠ¤æ€§ã€å¯é æ€§ä¸å·¥ç¨‹è§„èŒƒæ€§</strong>ã€‚</li>
<li><strong>å¯¹åº”åœºæ™¯</strong>ï¼šåŠŸèƒ½å¼€å‘ã€æ¨¡å—é‡æ„ã€é—ç•™ç³»ç»Ÿä¿®æ”¹ç­‰éœ€è¦ä¸¥æ ¼éµå¾ªæµ‹è¯•é©±åŠ¨å¼€å‘ï¼ˆTDDï¼‰ã€ä»£ç å®¡æŸ¥å’Œç‰ˆæœ¬æ§åˆ¶è§„èŒƒçš„é¡¹ç›®ä»»åŠ¡ã€‚</li>
</ul>
<p><strong>è§£å†³æ–¹æ³•ä¸æ¼”è¿›</strong>ï¼š</p>
<ul>
<li><strong>ä¼ ç»Ÿ/åŸå§‹æ–¹å¼</strong>ï¼šå¼€å‘è€…ç›´æ¥å‘AIä»£ç†å‘å‡ºâ€œå†™ä¸€ä¸ªXåŠŸèƒ½â€çš„æŒ‡ä»¤ã€‚AIç›´æ¥ç”Ÿæˆä»£ç å—ï¼Œè¿‡ç¨‹æ˜¯é»‘ç›’çš„ï¼Œç¼ºä¹éœ€æ±‚æ¾„æ¸…ã€è®¾è®¡è¯„å®¡ã€è®¡åˆ’åˆ¶å®šå’Œç³»ç»Ÿæ€§æµ‹è¯•éªŒè¯ç¯èŠ‚ã€‚</li>
<li><strong>Superpowers æ–°æ–¹å¼</strong>ï¼šåœ¨AIä»£ç†çš„åˆå§‹æŒ‡ä»¤ä¸­æ¤å…¥ä¸€å¥—â€œæŠ€èƒ½â€ç³»ç»Ÿã€‚å½“æ£€æµ‹åˆ°å¼€å‘æ„å›¾æ—¶ï¼Œä»£ç†<strong>å¿…é¡»</strong>è§¦å‘ç›¸åº”æŠ€èƒ½ï¼Œå¼•å¯¼ç”¨æˆ·èµ°è¿‡ä¸€ä¸ªåŒ…å«â€œéœ€æ±‚æ¾„æ¸… â†’ è®¾è®¡è¯„å®¡ â†’ è®¡åˆ’åˆ¶å®š â†’ å­ä»£ç†æ‰§è¡Œä¸å®¡æŸ¥ â†’ é›†æˆâ€çš„å®Œæ•´æµç¨‹ã€‚è¿™æœ¬è´¨ä¸Šæ˜¯å°†äººç±»è½¯ä»¶å·¥ç¨‹çš„æœ€ä½³å®è·µï¼ˆå¦‚TDDã€ä»£ç å®¡æŸ¥ã€Gitå·¥ä½œæµï¼‰è½¬åŒ–ä¸ºAIå¯ç†è§£å’Œæ‰§è¡Œçš„å¼ºåˆ¶æ€§åè®®ã€‚</li>
</ul>
<p><strong>å•†ä¸šä»·å€¼ä¼°ç®—é€»è¾‘</strong>ï¼š
ä»·å€¼å¯ä» <strong>â€œé™ä½çš„ä»£ç è¿”å·¥æˆæœ¬â€</strong> å’Œ <strong>â€œæå‡çš„å›¢é˜Ÿå¼€å‘æ•ˆç‡â€</strong> ä¸¤ä¸ªç»´åº¦è¿›è¡Œä¿å®ˆä¼°ç®—ã€‚</p>
<ol>
<li><strong>ä»£ç è¿”å·¥æˆæœ¬</strong>ï¼šå‡è®¾ä¸€ä¸ª10äººå›¢é˜Ÿï¼Œå¹³å‡æ¯äººæœˆè–ªä¸º<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn><mo separator="true">,</mo><mn>000</mn><mtext>ï¼Œæ¯æœˆæœ‰</mtext><mn>20</mn></mrow><annotation encoding="application/x-tex">10,000ï¼Œæ¯æœˆæœ‰20%çš„æ—¶é—´èŠ±è´¹åœ¨ä¿®å¤AIç”Ÿæˆä»£ç çš„ç¼ºé™·ã€ä¸ä¸€è‡´æ€§å’Œæ¶æ„é—®é¢˜ä¸Šã€‚Superpowersé€šè¿‡å¼ºåˆ¶æµç¨‹å¯å°†æ­¤é—®é¢˜å‡å°‘çº¦30%ã€‚åˆ™æœˆèŠ‚çœæˆæœ¬ä¸ºï¼š`10äºº * </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord">10</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">000</span><span class="mord cjk_fallback">ï¼Œæ¯æœˆæœ‰</span><span class="mord">20</span></span></span></span></span>10,000 * 20% * 30% = $6,000`ã€‚</li>
<li><strong>æ•ˆç‡æå‡</strong>ï¼šé€šè¿‡è‡ªåŠ¨åŒ–çš„å­ä»£ç†é©±åŠ¨å¼€å‘ã€ä»£ç å®¡æŸ¥å’ŒGitå·¥ä½œæµç®¡ç†ï¼Œå°†å¼€å‘è€…ä»ç¹ççš„æµç¨‹ç®¡æ§ä¸­è§£æ”¾å‡ºæ¥ã€‚ä¿å®ˆä¼°è®¡æå‡ä¸ªä½“æ•ˆç‡5%ã€‚åˆ™æœˆä»·å€¼ä¸ºï¼š<code>10äºº * $10,000 * 5% = $5,000</code>ã€‚</li>
<li><strong>ç»¼åˆæœˆåº¦ä»·å€¼</strong>ï¼šçº¦ä¸º <strong><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>11</mn><mo separator="true">,</mo><mn>000</mn><mo>âˆ—</mo><mo>âˆ—</mo><mtext>ã€‚å¹´åŒ–ä»·å€¼çº¦</mtext><mo>âˆ—</mo><mo>âˆ—</mo></mrow><annotation encoding="application/x-tex">11,000**ã€‚å¹´åŒ–ä»·å€¼çº¦ **</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"/><span class="mord">11</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">000</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord">âˆ—</span><span class="mord cjk_fallback">ã€‚å¹´åŒ–ä»·å€¼çº¦</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.4653em;"/><span class="mord">âˆ—</span></span></span></span></span>132,000</strong>ã€‚è¿™å°šæœªè®¡ç®—å› ä»£ç è´¨é‡æå‡å¸¦æ¥çš„é•¿æœŸç»´æŠ¤æˆæœ¬é™ä½å’Œç³»ç»Ÿç¨³å®šæ€§æ”¶ç›Šã€‚é¡¹ç›®çš„å®ç°æˆæœ¬ä¸»è¦ä¸ºå¼€å‘ä¸ç»´æŠ¤æ­¤ç±»æ¡†æ¶çš„äººåŠ›æŠ•å…¥ï¼Œå…¶æŠ•èµ„å›æŠ¥ç‡ï¼ˆROIï¼‰åœ¨è§„æ¨¡åŒ–ä½¿ç”¨çš„å›¢é˜Ÿä¸­è¾ƒä¸ºæ˜¾è‘—ã€‚</li>
</ol>
<h3 data-id="heading-4">2. è¯¦ç»†åŠŸèƒ½æ‹†è§£ï¼šäº§å“ä¸æŠ€æœ¯çš„åŒé‡è§†è§’</h3>
<h4 data-id="heading-5">2.1 äº§å“è§†è§’ï¼šç»“æ„åŒ–å¼€å‘æµæ°´çº¿</h4>
<p>Superpowers ä½œä¸ºä¸€ä¸ªâ€œäº§å“â€ï¼Œå…¶æ ¸å¿ƒæ˜¯å°è£…äº†è½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸï¼ˆSDLCï¼‰å…³é”®é˜¶æ®µçš„ä¸€å¥—è‡ªåŠ¨åŒ–æµæ°´çº¿ï¼š</p>
<ul>
<li><strong>éœ€æ±‚å…¥å£ç®¡ç† (<code>brainstorming</code>)</strong>ï¼šæ›¿ä»£äº†ç›´æ¥ç¼–ç çš„å…¥å£ï¼Œå˜ä¸ºSocraticï¼ˆè‹æ ¼æ‹‰åº•å¼ï¼‰å¯¹è¯ï¼Œç¡®ä¿ç›®æ ‡ä¸€è‡´ã€‚</li>
<li><strong>å¼€å‘ç¯å¢ƒæ²™ç›’ (<code>using-git-worktrees</code>)</strong>ï¼šè‡ªåŠ¨åˆ›å»ºéš”ç¦»çš„ç¼–ç ç¯å¢ƒï¼Œé˜²æ­¢æ±¡æŸ“ä¸»åˆ†æ”¯ã€‚</li>
<li><strong>ä»»åŠ¡åˆ†è§£å¼•æ“ (<code>writing-plans</code>)</strong>ï¼šå°†å®è§‚ç›®æ ‡åˆ†è§£ä¸ºåŸå­ä»»åŠ¡ï¼Œæ˜¯åç»­è‡ªåŠ¨åŒ–æ‰§è¡Œçš„è“å›¾ã€‚</li>
<li><strong>åˆ†å¸ƒå¼æ‰§è¡Œå¼•æ“ (<code>subagent-driven-development</code>)</strong>ï¼šåˆ©ç”¨AIä»£ç†å¯å¤šå®ä¾‹çš„ç‰¹æ€§ï¼Œå¹¶è¡Œæˆ–ä¸²è¡Œæ‰§è¡ŒåŸå­ä»»åŠ¡ï¼Œå¹¶å†…ç½®è´¨é‡é—¨ç¦ï¼ˆä¸¤é˜¶æ®µå®¡æŸ¥ï¼‰ã€‚</li>
<li><strong>è´¨é‡ç®¡æ§ç‚¹ (<code>requesting-code-review</code>, <code>test-driven-development</code>)</strong>ï¼šåœ¨æµç¨‹ä¸­ç¡¬æ€§æ’å…¥æ£€æŸ¥ç‚¹ï¼Œç¡®ä¿æµ‹è¯•è¦†ç›–ç‡å’Œä»£ç è§„èŒƒã€‚</li>
<li><strong>å‘å¸ƒåè°ƒå™¨ (<code>finishing-a-development-branch</code>)</strong>ï¼šæ ‡å‡†åŒ–åˆ†æ”¯æ”¶å°¾å·¥ä½œï¼Œæä¾›æ¸…æ™°çš„åç»­æ“ä½œè·¯å¾„ã€‚</li>
</ul>
<h4 data-id="heading-6">2.2 æŠ€æœ¯è§†è§’ï¼šæ’ä»¶åŒ–æŠ€èƒ½æ¶æ„ä¸è¿è¡Œæ—¶</h4>
<p>æŠ€æœ¯ä¸Šï¼ŒSuperpowers æ˜¯ä¸€ä¸ª<strong>åŸºäºæŠ€èƒ½(Skill)çš„æ’ä»¶åŒ–æ¡†æ¶</strong>ï¼Œå…¶æ¶æ„æ ¸å¿ƒå¦‚ä¸‹ï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e1db42d0e80446d58516007ca35d1a6e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5Y6C5oqA5pyv5oC755uR5LiL5rW3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769265996&amp;x-signature=eqWKjlf12Ihy%2FQndRaMkq2GGumc%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<ol>
<li>
<p><strong>æŠ€èƒ½ (<code>Skill</code>) ä½œä¸ºåŸºæœ¬å•å…ƒ</strong>ï¼š</p>
<ul>
<li>æ¯ä¸ªæŠ€èƒ½æ˜¯ä¸€ä¸ªç›®å½•ï¼Œå†…å«ä¸€ä¸ª <code>SKILL.md</code> æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶ä½¿ç”¨ YAML Frontmatter å£°æ˜å…ƒæ•°æ®ï¼ˆåç§°ã€æè¿°ï¼‰ï¼Œä¸»ä½“éƒ¨åˆ†åˆ™æ˜¯è¯¦ç»†çš„ã€ä¾›AIä»£ç†éµå¾ªçš„æŒ‡ä»¤ã€‚</li>
<li><strong>å…³é”®è®¾è®¡</strong>ï¼šæŠ€èƒ½æè¿°ä¸­åŒ…å«å¼ºåˆ¶è§¦å‘æ¡ä»¶ï¼ˆå¦‚ <code>â€œYou MUST use this before any creative workâ€</code>ï¼‰ï¼Œè¿™æ˜¯å·¥ä½œæµå¾—ä»¥å¼ºåˆ¶æ‰§è¡Œçš„åŸºç¡€ã€‚</li>
</ul>
</li>
<li>
<p><strong>æŠ€èƒ½åŠ è½½ä¸è§£æå¼•æ“ (<code>lib/skills-core.js</code>)</strong>ï¼š
è¿™æ˜¯ç³»ç»Ÿçš„æŠ€æœ¯æ ¸å¿ƒï¼Œæä¾›ä»¥ä¸‹å…³é”®æœåŠ¡ï¼š</p>
<ul>
<li><strong>æŠ€èƒ½å‘ç° (<code>findSkillsInDir</code>)</strong>ï¼šé€’å½’æ‰«æç›®å½•ï¼Œæå–æŠ€èƒ½å…ƒæ•°æ®ã€‚</li>
<li><strong>æŠ€èƒ½è·¯å¾„è§£æ (<code>resolveSkillPath</code>)</strong>ï¼šå®ç°â€œä¸ªäººæŠ€èƒ½è¦†ç›–ç³»ç»ŸæŠ€èƒ½â€çš„æœºåˆ¶ï¼Œæ”¯æŒçµæ´»çš„å®šåˆ¶åŒ–ã€‚</li>
<li><strong>å†…å®¹å¤„ç† (<code>stripFrontmatter</code>)</strong>ï¼šå°† <code>SKILL.md</code> ä¸­çš„å¯æ‰§è¡ŒæŒ‡ä»¤éƒ¨åˆ†åˆ†ç¦»å‡ºæ¥ã€‚</li>
<li><strong>æ›´æ–°æ£€æŸ¥ (<code>checkForUpdates</code>)</strong>ï¼šé€šè¿‡Gitå‘½ä»¤æ£€æŸ¥æŠ€èƒ½åº“æ˜¯å¦æœ‰æ›´æ–°ï¼Œä¿æŒæµç¨‹å…ˆè¿›æ€§ã€‚</li>
</ul>
</li>
<li>
<p><strong>é’©å­ (<code>Hooks</code>) æœºåˆ¶</strong>ï¼š
é€šè¿‡ <code>hooks.json</code> å®šä¹‰åœ¨ç‰¹å®šäº‹ä»¶ï¼ˆå¦‚ä¼šè¯å¼€å§‹ <code>SessionStart</code>ï¼‰æ—¶è‡ªåŠ¨æ‰§è¡Œçš„è„šæœ¬ã€‚è¿™å®ç°äº†å¯¹AIä»£ç†ç¯å¢ƒçš„åˆå§‹åŒ–å’Œé…ç½®ï¼Œç¡®ä¿æŠ€èƒ½ç³»ç»Ÿå°±ç»ªã€‚</p>
</li>
<li>
<p><strong>å­ä»£ç†åè°ƒæ¨¡å¼</strong>ï¼š
<code>subagent-driven-development</code> æŠ€èƒ½æ˜¯æŠ€æœ¯å®ç°çš„äº®ç‚¹ã€‚å®ƒå¹¶éç®€å•åœ°å°†ä»»åŠ¡ä¸¢ç»™å¦ä¸€ä¸ªAIå®ä¾‹ï¼Œè€Œæ˜¯è®¾è®¡äº†ä¸€ä¸ª<strong>ä¸¤é˜¶æ®µå®¡æŸ¥å¾ªç¯</strong>ï¼š</p>
<ul>
<li><strong>é˜¶æ®µä¸€ï¼šè§„æ ¼ç¬¦åˆæ€§å®¡æŸ¥</strong>ã€‚å®¡æŸ¥è€…ç‹¬ç«‹é˜…è¯»ä»£ç ï¼ŒéªŒè¯å…¶æ˜¯å¦å®Œå…¨åŒ¹é…ä»»åŠ¡æè¿°ï¼Œä¸ä¿¡ä»»å®æ–½è€…çš„è‡ªæˆ‘æŠ¥å‘Šã€‚</li>
<li><strong>é˜¶æ®µäºŒï¼šä»£ç è´¨é‡å®¡æŸ¥</strong>ã€‚åœ¨è§„æ ¼é€šè¿‡åï¼Œå†è¿›è¡Œä»£ç é£æ ¼ã€æœ€ä½³å®è·µç­‰å®¡æŸ¥ã€‚</li>
<li>ä»»ä½•é˜¶æ®µå‘ç°é—®é¢˜ï¼Œåˆ™é€€å›å®æ–½è€…è¿›å…¥â€œå®¡æŸ¥å¾ªç¯â€ä¿®æ­£ã€‚è¿™æ¨¡ä»¿äº†äººç±»å›¢é˜Ÿä¸­â€œå¼€å‘ â†’ ä»£ç å®¡æŸ¥ â†’ ä¿®æ”¹â€çš„è¿­ä»£è¿‡ç¨‹ï¼Œæ˜¾è‘—æå‡äº†AIç”Ÿæˆä»£ç çš„å¯é æ€§ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-7">3. æŠ€æœ¯éš¾ç‚¹ä¸æŒ‘æˆ˜</h3>
<ol>
<li><strong>æŠ€èƒ½å†²çªä¸ä¼˜å…ˆçº§ç®¡ç†</strong>ï¼šå½“å¤šä¸ªæŠ€èƒ½çš„è§¦å‘æ¡ä»¶åŒæ—¶æ»¡è¶³æ—¶ï¼Œå¦‚ä½•å®šä¹‰å’Œæ‰§è¡Œä¼˜å…ˆçº§ï¼Ÿç³»ç»Ÿç›®å‰ä¼¼ä¹ä¾èµ–æŠ€èƒ½æè¿°ä¸­çš„â€œMUSTâ€ç­‰å¼ºæŒ‡ä»¤å’Œå¼€å‘è€…çš„ä¸Šä¸‹æ–‡ï¼Œæ›´å¤æ‚çš„å†²çªè§£å†³æœºåˆ¶å¯èƒ½æ˜¯æœªæ¥çš„æŒ‘æˆ˜ã€‚</li>
<li><strong>å­ä»£ç†çŠ¶æ€ä¸ä¸Šä¸‹æ–‡éš”ç¦»</strong>ï¼šæ¯ä¸ªå­ä»£ç†åº”æœ‰ç‹¬ç«‹ã€çº¯å‡€çš„ä¸Šä¸‹æ–‡ï¼Œä»¥é˜²æ­¢ä»»åŠ¡é—´æ±¡æŸ“ã€‚ä½†åŒæ—¶ï¼ŒæŸäº›ä»»åŠ¡åˆéœ€è¦äº†è§£é¡¹ç›®å…¨å±€çŠ¶æ€ã€‚å¦‚ä½•åœ¨éš”ç¦»ä¸å…±äº«é—´å–å¾—å¹³è¡¡ï¼Œéœ€è¦ç²¾ç»†çš„è®¾è®¡ã€‚</li>
<li><strong>å¤æ‚æŠ€èƒ½çš„æµ‹è¯•</strong>ï¼šå¦‚ <code>tests/docs/testing.md</code> æ‰€ç¤ºï¼Œæµ‹è¯•åƒ <code>subagent-driven-development</code> è¿™æ ·çš„æŠ€èƒ½ï¼Œéœ€è¦æ­å»ºèƒ½è¿è¡ŒçœŸå®AIä»£ç†çš„Headlessæµ‹è¯•ç¯å¢ƒï¼Œè§£æå¤æ‚çš„ä¼šè¯è½¬å½•æ–‡ä»¶ï¼ˆJSONLæ ¼å¼ï¼‰ï¼Œå¹¶éªŒè¯åˆ†å¸ƒå¼äº¤äº’è¡Œä¸ºã€‚è¿™æ¯”æµ‹è¯•æ™®é€šå‡½æ•°è¦å¤æ‚å¾—å¤šã€‚</li>
<li><strong>æ€§èƒ½ä¸æˆæœ¬æ§åˆ¶</strong>ï¼šæ¯ä¸ªå­ä»£ç†è°ƒç”¨éƒ½æ¶ˆè€—AIæ¨¡å‹çš„Tokenã€‚é¡¹ç›®æä¾›çš„ <code>analyze-token-usage.py</code> å·¥å…·ä¸“é—¨ç”¨äºåˆ†æå„ä»£ç†çš„Tokenæ¶ˆè€—å’Œæˆæœ¬ã€‚ä¼˜åŒ–æç¤ºè¯ï¼ˆPromptï¼‰è®¾è®¡ä»¥å‡å°‘Tokenæµªè´¹ï¼ŒåŒæ—¶ä¿æŒæ•ˆæœï¼Œæ˜¯ä¸€ä¸ªæŒç»­çš„æŠ€æœ¯è¦ç‚¹ã€‚</li>
<li><strong>å¯¹ä¸åŒAIä»£ç†å¹³å°çš„é€‚é…</strong>ï¼šéœ€è¦ä¸ºClaude Codeã€Codexã€OpenCodeåˆ†åˆ«ç¼–å†™å®‰è£…å’Œé€‚é…é€»è¾‘ï¼ˆå¦‚ <code>.codex/INSTALL.md</code>, <code>.opencode/INSTALL.md</code>ï¼‰ï¼Œå¤„ç†ä¸åŒå¹³å°çš„èƒ½åŠ›å·®å¼‚å’Œæ¥å£ï¼Œå¢åŠ äº†ç»´æŠ¤å¤æ‚åº¦ã€‚</li>
</ol>
<h3 data-id="heading-8">4. è¯¦ç»†è®¾è®¡å›¾æ</h3>
<h4 data-id="heading-9">4.1 æ ¸å¿ƒæŠ€èƒ½è§£ææµç¨‹åºåˆ—å›¾</h4>
<p>ä¸‹å›¾è¯¦ç»†æç»˜äº†ä»è§¦å‘æŠ€èƒ½ååˆ°æ‰§è¡ŒæŠ€èƒ½æŒ‡ä»¤çš„å®Œæ•´å†…éƒ¨æµç¨‹ï¼Œç‰¹åˆ«æ˜¯ä¸ªäººæŠ€èƒ½è¦†ç›–ç³»ç»ŸæŠ€èƒ½çš„è§£æé€»è¾‘ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant A as AIä»£ç†
    participant SC as SkillCore (æŠ€èƒ½æ ¸å¿ƒ)
    participant FS as æ–‡ä»¶ç³»ç»Ÿ

    A-&gt;&gt;SC: resolveSkillPath(skillName, superpowersDir, personalDir)
    
    alt æŠ€èƒ½åä»¥ superpowers: å‰ç¼€å¼ºåˆ¶æŒ‡å®š
        SC-&gt;&gt;FS: ä»…åœ¨ superpowersDir ä¸‹æŸ¥æ‰¾ skillName
    else æ™®é€šæŠ€èƒ½å
        SC-&gt;&gt;FS: å…ˆåœ¨ personalDir ä¸‹æŸ¥æ‰¾ skillName
        alt åœ¨ personalDir ä¸­æ‰¾åˆ°
            SC--&gt;&gt;A: è¿”å›ä¸ªäººæŠ€èƒ½è·¯å¾„ (sourceType: â€˜personalâ€˜)
        else æœªåœ¨ personalDir ä¸­æ‰¾åˆ°
            SC-&gt;&gt;FS: åœ¨ superpowersDir ä¸‹æŸ¥æ‰¾ skillName
            alt åœ¨ superpowersDir ä¸­æ‰¾åˆ°
                SC--&gt;&gt;A: è¿”å›ç³»ç»ŸæŠ€èƒ½è·¯å¾„ (sourceType: â€˜superpowersâ€˜)
            else å‡æœªæ‰¾åˆ°
                SC--&gt;&gt;A: è¿”å› null
            end
        end
    end

    A-&gt;&gt;FS: è¯»å–æŠ€èƒ½æ–‡ä»¶ SKILL.md
    A-&gt;&gt;SC: stripFrontmatter(content)
    SC--&gt;&gt;A: è¿”å›çº¯æŒ‡ä»¤å†…å®¹
    A-&gt;&gt;A: å°†æŠ€èƒ½æŒ‡ä»¤æ³¨å…¥è‡ªèº«ä¸Šä¸‹æ–‡å¹¶æ‰§è¡Œ
</code></pre>
<h4 data-id="heading-10">4.2 æ ¸å¿ƒç±»/å‡½æ•°å…³ç³»å›¾</h4>
<p>åŸºäº <code>lib/skills-core.js</code> æ–‡ä»¶ï¼Œå…¶æ ¸å¿ƒå‡½æ•°å…³ç³»å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/668216fe6c4441f7be0932ebb4f565b6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5Y6C5oqA5pyv5oC755uR5LiL5rW3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769265996&amp;x-signature=vbVjxFLnffAeZ1%2FrHII%2FrmcCHyY%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-11">5. æ ¸å¿ƒä»£ç è§£æ</h3>
<p>ä»¥ä¸‹åˆ†æ <code>lib/skills-core.js</code> ä¸­çš„ä¸¤ä¸ªå…³é”®å‡½æ•°ï¼Œå®ƒä»¬ä½“ç°äº†ç³»ç»Ÿçš„æ ¸å¿ƒæœºåˆ¶ã€‚</p>
<h4 data-id="heading-12">5.1 æŠ€èƒ½è·¯å¾„è§£æå‡½æ•° (<code>resolveSkillPath</code>)</h4>
<p>æ­¤å‡½æ•°å®ç°äº†æŠ€èƒ½æŸ¥æ‰¾çš„ä¼˜å…ˆçº§é€»è¾‘ï¼Œæ˜¯â€œä¸ªäººæŠ€èƒ½è¦†ç›–ç³»ç»ŸæŠ€èƒ½â€ç‰¹æ€§çš„æŠ€æœ¯åŸºç¡€ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * è§£ææŠ€èƒ½åç§°åˆ°å…¶æ–‡ä»¶è·¯å¾„ï¼Œå¤„ç†é˜´å½±è¦†ç›–
 * (ä¸ªäººæŠ€èƒ½è¦†ç›– superpowers æŠ€èƒ½)ã€‚
 *
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">skillName</span> - åç§°å¦‚ "superpowers:brainstorming" æˆ– "my-skill"
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">superpowersDir</span> - superpowers æŠ€èƒ½ç›®å½•è·¯å¾„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">personalDir</span> - ä¸ªäººæŠ€èƒ½ç›®å½•è·¯å¾„
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">{skillFile: string, sourceType: string, skillPath: string</span>} | null}
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">resolveSkillPath</span>(<span class="hljs-params">skillName, superpowersDir, personalDir</span>) {
    <span class="hljs-comment">// 1. å¤„ç†å¼ºåˆ¶å‰ç¼€ï¼šå¦‚æœä»¥ `superpowers:` å¼€å¤´ï¼Œåˆ™åªæŸ¥æ‰¾ç³»ç»Ÿç›®å½•</span>
    <span class="hljs-keyword">const</span> forceSuperpowers = skillName.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'superpowers:'</span>);
    <span class="hljs-keyword">const</span> actualSkillName = forceSuperpowers ? skillName.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/^superpowers:/</span>, <span class="hljs-string">''</span>) : skillName;

    <span class="hljs-comment">// 2. ä¼˜å…ˆæŸ¥æ‰¾ä¸ªäººæŠ€èƒ½ (é™¤éæ˜ç¡®å¼ºåˆ¶ä½¿ç”¨ superpowers)</span>
    <span class="hljs-keyword">if</span> (!forceSuperpowers &amp;&amp; personalDir) {
        <span class="hljs-keyword">const</span> personalPath = path.<span class="hljs-title function_">join</span>(personalDir, actualSkillName);
        <span class="hljs-keyword">const</span> personalSkillFile = path.<span class="hljs-title function_">join</span>(personalPath, <span class="hljs-string">'SKILL.md'</span>);
        <span class="hljs-keyword">if</span> (fs.<span class="hljs-title function_">existsSync</span>(personalSkillFile)) {
            <span class="hljs-comment">// æ‰¾åˆ°ä¸ªäººæŠ€èƒ½ï¼Œç«‹å³è¿”å›ï¼Œå®ç°â€œè¦†ç›–â€</span>
            <span class="hljs-keyword">return</span> {
                <span class="hljs-attr">skillFile</span>: personalSkillFile,
                <span class="hljs-attr">sourceType</span>: <span class="hljs-string">'personal'</span>,
                <span class="hljs-attr">skillPath</span>: actualSkillName
            };
        }
    }

    <span class="hljs-comment">// 3. æŸ¥æ‰¾ superpowers ç³»ç»ŸæŠ€èƒ½</span>
    <span class="hljs-keyword">if</span> (superpowersDir) {
        <span class="hljs-keyword">const</span> superpowersPath = path.<span class="hljs-title function_">join</span>(superpowersDir, actualSkillName);
        <span class="hljs-keyword">const</span> superpowersSkillFile = path.<span class="hljs-title function_">join</span>(superpowersPath, <span class="hljs-string">'SKILL.md'</span>);
        <span class="hljs-keyword">if</span> (fs.<span class="hljs-title function_">existsSync</span>(superpowersSkillFile)) {
            <span class="hljs-keyword">return</span> {
                <span class="hljs-attr">skillFile</span>: superpowersSkillFile,
                <span class="hljs-attr">sourceType</span>: <span class="hljs-string">'superpowers'</span>,
                <span class="hljs-attr">skillPath</span>: actualSkillName
            };
        }
    }

    <span class="hljs-comment">// 4. éƒ½æœªæ‰¾åˆ°ï¼Œè¿”å› null</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
</code></pre>
<p><strong>ä»£ç æ³¨é‡Šä¸è§£æ</strong>ï¼š</p>
<ul>
<li><strong>é€»è¾‘ä¼˜å…ˆçº§</strong>ï¼š<code>!forceSuperpowers &amp;&amp; personalDir</code> æ¡ä»¶ç¡®ä¿äº†é»˜è®¤æƒ…å†µä¸‹ä¼˜å…ˆæœç´¢ä¸ªäººç›®å½•ï¼Œè¿™æ˜¯å®ç°è‡ªå®šä¹‰è¦†ç›–çš„å…³é”®ã€‚</li>
<li><strong>è·¯å¾„æ‹¼æ¥</strong>ï¼šä½¿ç”¨ <code>path.join()</code> ç¡®ä¿è·¨å¹³å°è·¯å¾„çš„æ­£ç¡®æ€§ã€‚</li>
<li><strong>å­˜åœ¨æ€§æ£€æŸ¥</strong>ï¼š<code>fs.existsSync()</code> åŒæ­¥æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œæ˜¯å†³å®šæŸ¥æ‰¾åˆ†æ”¯çš„ä¾æ®ã€‚</li>
<li><strong>æ¸…æ™°çš„è¿”å›ç»“æ„</strong>ï¼šè¿”å›å¯¹è±¡åŒ…å«æ–‡ä»¶è·¯å¾„ã€æ¥æºç±»å‹å’ŒæŠ€èƒ½è·¯å¾„ï¼Œä¸ºè°ƒç”¨è€…æä¾›å®Œæ•´ä¿¡æ¯ã€‚</li>
</ul>
<h4 data-id="heading-13">5.2 æ£€æŸ¥æ›´æ–°å‡½æ•° (<code>checkForUpdates</code>)</h4>
<p>æ­¤å‡½æ•°å±•ç¤ºäº†ç³»ç»Ÿä¸Gitçš„é›†æˆï¼Œç”¨äºå®ç°æŠ€èƒ½çš„è‡ªåŠ¨æ›´æ–°æé†’ï¼Œè®¾è®¡ä¸Šè€ƒè™‘äº†å¤±è´¥å®¹å¿ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * æ£€æŸ¥Gitä»“åº“æ˜¯å¦æœ‰å¯ç”¨æ›´æ–°ã€‚
 *
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">repoDir</span> - Gitä»“åº“è·¯å¾„
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">boolean</span>} - å¦‚æœæœ‰æ›´æ–°åˆ™è¿”å› true
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">checkForUpdates</span>(<span class="hljs-params">repoDir</span>) {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// è®¾ç½®3ç§’è¶…æ—¶ï¼Œé¿å…å› ç½‘ç»œé—®é¢˜å¯¼è‡´å¯åŠ¨é˜»å¡</span>
        <span class="hljs-keyword">const</span> output = <span class="hljs-title function_">execSync</span>(<span class="hljs-string">'git fetch origin &amp;&amp; git status --porcelain=v1 --branch'</span>, {
            <span class="hljs-attr">cwd</span>: repoDir,
            <span class="hljs-attr">timeout</span>: <span class="hljs-number">3000</span>, <span class="hljs-comment">// å…³é”®ï¼šè¶…æ—¶è®¾è®¡</span>
            <span class="hljs-attr">encoding</span>: <span class="hljs-string">'utf8'</span>,
            <span class="hljs-attr">stdio</span>: <span class="hljs-string">'pipe'</span> <span class="hljs-comment">// æŠ‘åˆ¶å­è¿›ç¨‹è¾“å‡ºåˆ°çˆ¶è¿›ç¨‹</span>
        });

        <span class="hljs-comment">// è§£æ git status è¾“å‡ºæ¥åˆ¤æ–­æ˜¯å¦è½åäºè¿œç¨‹åˆ†æ”¯</span>
        <span class="hljs-keyword">const</span> statusLines = output.<span class="hljs-title function_">split</span>(<span class="hljs-string">'\n'</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> line <span class="hljs-keyword">of</span> statusLines) {
            <span class="hljs-comment">// æ£€æŸ¥çŠ¶æ€è¡Œä¸­æ˜¯å¦åŒ…å« `[behind ` å­—æ ·</span>
            <span class="hljs-keyword">if</span> (line.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'## '</span>) &amp;&amp; line.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'[behind '</span>)) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// å­˜åœ¨æ›´æ–°</span>
            }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// å·²æ˜¯æœ€æ–°</span>
    } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-comment">// ç½‘ç»œé”™è¯¯ã€gité”™è¯¯ã€è¶…æ—¶ç­‰â€”â€”ä¸é˜»å¡å¼•å¯¼æµç¨‹ï¼Œä¼˜é›…é™çº§</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
}
</code></pre>
<p><strong>ä»£ç æ³¨é‡Šä¸è§£æ</strong>ï¼š</p>
<ul>
<li><strong>é˜²å¾¡æ€§ç¼–ç¨‹</strong>ï¼šæ•´ä¸ªå‡½æ•°è¢«åŒ…è£¹åœ¨ <code>try-catch</code> ä¸­ï¼Œä»»ä½•å¼‚å¸¸ï¼ˆç½‘ç»œä¸é€šã€æ— Gitã€è¶…æ—¶ï¼‰éƒ½ä¼šè¢«æ•è·å¹¶è¿”å› <code>false</code>ï¼Œç¡®ä¿ä¸»æµç¨‹ä¸å› æ›´æ–°æ£€æŸ¥è€Œå´©æºƒã€‚</li>
<li><strong>è¶…æ—¶æ§åˆ¶</strong>ï¼š<code>timeout: 3000</code> æ˜¯å…³é”®è®¾ç½®ï¼Œé˜²æ­¢åœ¨ç½‘ç»œç¼“æ…¢æˆ–ä¸å¯ç”¨æ—¶é•¿æ—¶é—´æŒ‚èµ·ã€‚</li>
<li><strong>é«˜æ•ˆçš„æ›´æ–°åˆ¤æ–­</strong>ï¼šé€šè¿‡ <code>git status --porcelain=v1 --branch</code> è·å–æœºå™¨å¯è¯»çš„çŠ¶æ€ï¼Œå¹¶è§£æ <code>[behind</code> å…³é”®è¯æ¥åˆ¤æ–­æ˜¯å¦è½åï¼Œæ¯”ç›´æ¥æ¯”è¾ƒç‰ˆæœ¬å“ˆå¸Œæ›´é«˜æ•ˆã€‚</li>
<li><strong>å…³æ³¨ç‚¹åˆ†ç¦»</strong>ï¼šæ­¤å‡½æ•°åªè´Ÿè´£æ£€æŸ¥å¹¶è¿”å›å¸ƒå°”å€¼ï¼Œä¸æ‰§è¡Œæ‹‰å–(<code>pull</code>)æ“ä½œï¼ŒèŒè´£å•ä¸€ã€‚</li>
</ul>
<h3 data-id="heading-14">ç»“è®º</h3>
<p>Superpowers é¡¹ç›®ä»£è¡¨äº†ä¸€ç§å‰æ²¿çš„å·¥ç¨‹åŒ–æ€è·¯ï¼š<strong>ä¸æ˜¯è®©äººå»é€‚åº”AIçš„å·¥ä½œæ¨¡å¼ï¼Œè€Œæ˜¯è®©AIçš„è¡Œä¸ºå»é€‚é…å¹¶å¼ºåŒ–äººç±»çš„è½¯ä»¶å·¥ç¨‹è§„èŒƒ</strong>ã€‚å®ƒé€šè¿‡æ’ä»¶åŒ–æŠ€èƒ½æ¶æ„ã€å¼ºåˆ¶æ€§çš„æµç¨‹é’©å­ã€ä»¥åŠåˆ›æ–°çš„å­ä»£ç†åè°ƒä¸å®¡æŸ¥æœºåˆ¶ï¼Œåœ¨AIèƒ½åŠ›ä¸å·¥ç¨‹çºªå¾‹ä¹‹é—´æ¶èµ·äº†ä¸€åº§æ¡¥æ¢ã€‚</p>
<p>ä»æŠ€æœ¯å®ç°ä¸Šçœ‹ï¼Œå…¶æ ¸å¿ƒéš¾ç‚¹ä¸åœ¨äºå¤æ‚çš„ç®—æ³•ï¼Œè€Œåœ¨äºå¯¹AIä»£ç†è¡Œä¸ºæ¨¡å¼çš„ç²¾ç»†å¼•å¯¼ã€å¯¹åˆ†å¸ƒå¼ï¼ˆå­ä»£ç†ï¼‰ä»»åŠ¡çŠ¶æ€çš„ç®¡æ§ï¼Œä»¥åŠå¯¹å¤æ‚æŠ€èƒ½ç»„åˆçš„æµ‹è¯•éªŒè¯ã€‚å®ƒä¸ºâ€œAIè¾…åŠ©è½¯ä»¶å·¥ç¨‹â€ï¼ˆAI4SEï¼‰è¿™ä¸€æ–°å…´é¢†åŸŸæä¾›äº†ä¸€ä¸ªæ‰å®çš„ã€å¯æ‰©å±•çš„å®è·µèŒƒæœ¬ã€‚</p>
<p>ä¸ä¼ ç»Ÿçš„CI/CDæµæ°´çº¿ç›¸æ¯”ï¼ŒSuperpowers çš„æµæ°´çº¿è¿ä½œåœ¨**â€œè®¤çŸ¥å±‚â€**ï¼Œå®ƒè§„èŒƒçš„æ˜¯éœ€æ±‚åˆ†æã€è®¾è®¡ã€ç¼–ç å’Œåˆçº§å®¡æŸ¥è¿™äº›å‰æœŸåˆ›é€ æ€§æ´»åŠ¨ï¼›è€ŒCI/CDæ›´å…³æ³¨æ„å»ºã€æµ‹è¯•ã€éƒ¨ç½²ç­‰åæœŸè‡ªåŠ¨åŒ–æ´»åŠ¨ã€‚äºŒè€…æ˜¯äº’è¡¥è€Œéç«äº‰å…³ç³»ï¼Œå…±åŒæ„æˆä»â€œæƒ³æ³•â€åˆ°â€œä¸Šçº¿â€çš„å®Œæ•´è‡ªåŠ¨åŒ–é“¾æ¡ã€‚</p>
<hr/>
<p><strong>æŠ€æœ¯æ ˆæ€»ç»“</strong>ï¼šNode.js (è¿è¡Œæ—¶) + Git (ç‰ˆæœ¬ä¸æ›´æ–°) + YAML/Markdown (æŠ€èƒ½å®šä¹‰) + ç‰¹å®šAIä»£ç†SDK (Claude/Codex/OpenCode) + è‡ªå®šä¹‰çš„ä»£ç†åè°ƒåè®®ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäº LangChain1.0 æ„å»º RAG Agent æ™ºèƒ½æ£€ç´¢é—®ç­”ç³»ç»Ÿï¼ˆå®Œæ•´å¯è¿è¡Œä»£ç +è¯¦ç»†æ³¨é‡Šï¼‰]]></title>    <link>https://juejin.cn/post/7595878718172250148</link>    <guid>https://juejin.cn/post/7595878718172250148</guid>    <pubDate>2026-01-17T14:55:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595878718172250148" data-draft-id="7595911076014669860" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäº LangChain1.0 æ„å»º RAG Agent æ™ºèƒ½æ£€ç´¢é—®ç­”ç³»ç»Ÿï¼ˆå®Œæ•´å¯è¿è¡Œä»£ç +è¯¦ç»†æ³¨é‡Šï¼‰"/> <meta itemprop="keywords" content="LangChain,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-17T14:55:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="o_insist"/> <meta itemprop="url" content="https://juejin.cn/user/3307750804423832"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäº LangChain1.0 æ„å»º RAG Agent æ™ºèƒ½æ£€ç´¢é—®ç­”ç³»ç»Ÿï¼ˆå®Œæ•´å¯è¿è¡Œä»£ç +è¯¦ç»†æ³¨é‡Šï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3307750804423832/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    o_insist
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T14:55:40.000Z" title="Sat Jan 17 2026 14:55:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>âœ¨ æœ¬æ–‡ä»£ç å‡ä¸ºå¯ç›´æ¥è¿è¡Œçš„å®Œæ•´ä»£ç ï¼ŒåŸºäºLangChainæœ€æ–°ç‰ˆAPIç¼–å†™ï¼Œæ— è¿‡æ—¶è¯­æ³•ï¼Œæ”¾å¿ƒé£Ÿç”¨ï½</p>
<h2 data-id="heading-0">âœ… ä¸€ã€å®‰è£…é¡¹ç›®ä¾èµ–åŒ…</h2>
<pre><code class="hljs language-arduino" lang="arduino"># å®‰è£…æ‰€æœ‰æ ¸å¿ƒä¾èµ–ï¼Œä¸€è¡Œå‘½ä»¤å®Œæˆé…ç½®
pip install langchain langchain-text-splitters langchain-community bs4 python-dotenv
</code></pre>
<hr/>
<h2 data-id="heading-1">âœ… äºŒã€åˆå§‹åŒ–ä¸‰å¤§æ ¸å¿ƒç»„ä»¶ï¼ˆæ ¸å¿ƒé…ç½®ï¼‰</h2>
<p>æ„å»ºRAG Agentçš„æ ¸å¿ƒä¸‰è¦ç´ ï¼š<strong>å¯¹è¯å¤§æ¨¡å‹</strong>ã€<strong>æ–‡æœ¬åµŒå…¥æ¨¡å‹</strong>ã€<strong>å‘é‡å­˜å‚¨å™¨</strong></p>
<h3 data-id="heading-2">1. é…ç½®å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰- å¯¹è¯ç”Ÿæˆæ ¸å¿ƒ</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å¯¼å…¥å¯¹è¯æ¨¡å‹åŠç¯å¢ƒå˜é‡é…ç½®ä¾èµ–</span>
from langchain_openai import ChatOpenAI
import os
from dotenv import load_dotenv

<span class="hljs-comment"># åŠ è½½.envæ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡ï¼ˆç§å¯†å¯†é’¥ç®¡ç†ï¼Œè§„èŒƒå¼€å‘ï¼‰</span>
load_dotenv()

<span class="hljs-comment"># é…ç½®é€šä¹‰åƒé—®å¤§æ¨¡å‹ï¼ˆqwen-maxï¼‰å‚æ•°</span>
<span class="hljs-attr">model_name</span> = <span class="hljs-string">"qwen-max"</span>
<span class="hljs-attr">api_key</span> = os.getenv(<span class="hljs-string">"DASHSCOPE_API_KEY"</span>)
<span class="hljs-attr">base_url</span> = os.getenv(<span class="hljs-string">"DASHSCOPE_BASE_URL"</span>)

<span class="hljs-comment"># åˆå§‹åŒ–èŠå¤©æ¨¡å‹ï¼šä½éšæœºæ€§ä¿è¯å›ç­”ä¸¥è°¨ï¼Œé€‚é…çŸ¥è¯†ç±»é—®ç­”åœºæ™¯</span>
<span class="hljs-attr">model</span> = ChatOpenAI(
    <span class="hljs-attr">model</span>=model_name,
    <span class="hljs-attr">api_key</span>=api_key,
    <span class="hljs-attr">base_url</span>=base_url,
    <span class="hljs-attr">temperature</span>=<span class="hljs-number">0.1</span>,  <span class="hljs-comment"># æ¸©åº¦å€¼è¶Šä½ï¼Œå›ç­”è¶Šç²¾å‡†ã€ç¡®å®šæ€§è¶Šå¼º</span>
)
</code></pre>
<h3 data-id="heading-3">2. é…ç½®æ–‡æœ¬åµŒå…¥æ¨¡å‹ - æ–‡æœ¬å‘é‡åŒ–æ ¸å¿ƒ</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å¯¼å…¥HuggingFaceåµŒå…¥æ¨¡å‹</span>
from langchain_huggingface import HuggingFaceEmbeddings

<span class="hljs-comment"># åˆå§‹åŒ–åµŒå…¥æ¨¡å‹ï¼Œè¡Œä¸šä¸»æµè½»é‡çº§é«˜è´¨é‡é€‰å‹</span>
<span class="hljs-comment"># ç‰¹ç‚¹ï¼šæ–‡æœ¬è¡¨å¾èƒ½åŠ›å¼ºã€é€‚é…ä¸­æ–‡+è‹±æ–‡ï¼Œé¦–æ¬¡è¿è¡Œè‡ªåŠ¨ç¼“å­˜è‡³æœ¬åœ°ï¼Œæ— éœ€é‡å¤ä¸‹è½½</span>
<span class="hljs-attr">embeddings</span> = HuggingFaceEmbeddings(model_name=<span class="hljs-string">"sentence-transformers/all-mpnet-base-v2"</span>)
</code></pre>
<h3 data-id="heading-4">3. é…ç½®å‘é‡å­˜å‚¨å™¨ - å‘é‡æ•°æ®å­˜å‚¨æ ¸å¿ƒ</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å¯¼å…¥å†…å­˜çº§å‘é‡å­˜å‚¨åº“</span>
from langchain_core.vectorstores import InMemoryVectorStore

<span class="hljs-comment"># åˆå§‹åŒ–å†…å­˜å‘é‡åº“ï¼Œè½»é‡åŒ–æ— éƒ¨ç½²ï¼Œæ— éœ€æŒä¹…åŒ–ç£ç›˜ï¼Œé€‚åˆå¿«é€Ÿå¼€å‘/æ¼”ç¤ºåœºæ™¯</span>
<span class="hljs-comment"># ç»‘å®šå·²åˆå§‹åŒ–çš„åµŒå…¥æ¨¡å‹ï¼Œå®ç°æ–‡æœ¬-å‘é‡çš„è‡ªåŠ¨è½¬æ¢ä¸åŒ¹é…</span>
<span class="hljs-attr">vector_store</span> = InMemoryVectorStore(embeddings)
</code></pre>
<hr/>
<h2 data-id="heading-5">âœ… ä¸‰ã€æ–‡æ¡£å¤„ç†å…¨æµç¨‹ï¼šåŠ è½½ â†’ åˆ†ç‰‡ â†’ å…¥åº“ï¼ˆæ„å»ºæ£€ç´¢çŸ¥è¯†åº“ï¼‰</h2>
<p>RAGæ ¸å¿ƒå‰ç½®æ­¥éª¤ï¼šå°†éç»“æ„åŒ–çš„ç½‘é¡µæ–‡æœ¬ï¼Œå¤„ç†ä¸ºç»“æ„åŒ–çš„å‘é‡çŸ¥è¯†åº“ï¼Œå…±åˆ†3æ­¥å®Œæˆï¼Œæµç¨‹æ ‡å‡†åŒ–ä¸”å¯å¤ç”¨</p>
<h3 data-id="heading-6">1. æ–‡æ¡£åŠ è½½ï¼šç²¾å‡†çˆ¬å–ç½‘é¡µæ ¸å¿ƒå†…å®¹</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å¯¼å…¥ç½‘é¡µåŠ è½½å™¨åŠç½‘é¡µè§£æä¾èµ–</span>
import bs4
from langchain_community.document_loaders import WebBaseLoader

<span class="hljs-comment"># ç½‘é¡µè§£æè§„åˆ™ï¼šåªæå–æŒ‡å®šclassçš„æ ¸å¿ƒå†…å®¹ï¼ˆæ ‡é¢˜/å¤´éƒ¨/æ­£æ–‡ï¼‰ï¼Œè¿‡æ»¤å†—ä½™HTMLæ ‡ç­¾ï¼Œæå‡æ•°æ®è´¨é‡</span>
<span class="hljs-attr">bs4_strainer</span> = bs4.SoupStrainer(class_=(<span class="hljs-string">"post-title"</span>, <span class="hljs-string">"post-header"</span>, <span class="hljs-string">"post-content"</span>))

<span class="hljs-comment"># åˆå§‹åŒ–ç½‘é¡µåŠ è½½å™¨ï¼ŒæŒ‡å®šçˆ¬å–è·¯å¾„+è§£æè§„åˆ™</span>
<span class="hljs-attr">loader</span> = WebBaseLoader(
    <span class="hljs-attr">web_paths</span>=(<span class="hljs-string">"https://lilianweng.github.io/posts/2023-06-23-agent/"</span>,),
    <span class="hljs-attr">bs_kwargs</span>={<span class="hljs-string">"parse_only"</span>: bs4_strainer},
)

<span class="hljs-comment"># åŠ è½½ç½‘é¡µæ–‡æ¡£è‡³ä¸Šä¸‹æ–‡</span>
<span class="hljs-attr">docs</span> = loader.load()

<span class="hljs-comment"># æ ¡éªŒåŠ è½½ç»“æœï¼šç¡®ä¿æˆåŠŸåŠ è½½1ç¯‡æ–‡æ¡£</span>
assert len(docs) == 1
<span class="hljs-comment"># è¾“å‡ºæ–‡æ¡£æ€»å­—ç¬¦æ•°ï¼Œç›´è§‚æŸ¥çœ‹æ–‡æœ¬ä½“é‡</span>
print(f"âœ… æ–‡æ¡£åŠ è½½å®Œæˆï¼Œæ€»å­—ç¬¦æ•°ï¼š{len(docs<span class="hljs-section">[0]</span>.page_content)}")
</code></pre>
<h3 data-id="heading-7">2. æ–‡æ¡£åˆ†ç‰‡ï¼šæœ€ä¼˜ç­–ç•¥åˆ‡å‰²æ–‡æœ¬ï¼Œä¿ç•™ä¸Šä¸‹æ–‡å…³è”</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å¯¼å…¥é€’å½’å­—ç¬¦åˆ†å‰²å™¨</span>
from langchain_text_splitters import RecursiveCharacterTextSplitter

<span class="hljs-comment"># åˆå§‹åŒ–æ–‡æœ¬åˆ†å‰²å™¨ï¼Œé‡‡ç”¨è¡Œä¸šæœ€ä¼˜çš„é€’å½’åˆ†å‰²ç­–ç•¥</span>
<span class="hljs-attr">text_splitter</span> = RecursiveCharacterTextSplitter(
    <span class="hljs-attr">chunk_size</span>=<span class="hljs-number">1000</span>,        <span class="hljs-comment"># å•ä¸ªæ–‡æœ¬å—æœ€å¤§å­—ç¬¦æ•°ï¼Œé€‚é…åµŒå…¥æ¨¡å‹è¾“å…¥é•¿åº¦é™åˆ¶</span>
    <span class="hljs-attr">chunk_overlap</span>=<span class="hljs-number">200</span>,      <span class="hljs-comment"># ç›¸é‚»æ–‡æœ¬å—é‡å å­—ç¬¦æ•°ï¼Œé¿å…å…³é”®ä¿¡æ¯è¢«æˆªæ–­ï¼Œä¿ç•™ä¸Šä¸‹æ–‡å…³è”æ€§</span>
    <span class="hljs-attr">add_start_index</span>=<span class="hljs-literal">True</span>,   <span class="hljs-comment"># è®°å½•æ–‡æœ¬å—åœ¨åŸå§‹æ–‡æ¡£ä¸­çš„èµ·å§‹ç´¢å¼•ï¼Œä¾¿äºæº¯æºåŒ¹é…å†…å®¹</span>
)

<span class="hljs-comment"># å¯¹åŠ è½½çš„æ–‡æ¡£è¿›è¡Œåˆ†ç‰‡å¤„ç†</span>
<span class="hljs-attr">all_splits</span> = text_splitter.split_documents(docs)

<span class="hljs-comment"># è¾“å‡ºåˆ†ç‰‡ç»“æœ</span>
print(f"âœ… æ–‡æ¡£åˆ†ç‰‡å®Œæˆï¼ŒåŸå§‹æ–‡æ¡£åˆ‡åˆ†ä¸º {len(all_splits)} ä¸ªå­æ–‡æ¡£")
</code></pre>
<h3 data-id="heading-8">3. å‘é‡å…¥åº“ï¼šå°†åˆ†ç‰‡æ–‡æœ¬å­˜å…¥å‘é‡åº“ï¼Œå®ŒæˆçŸ¥è¯†åº“æ„å»º</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å°†æ‰€æœ‰æ–‡æœ¬åˆ†ç‰‡å­˜å…¥å‘é‡å­˜å‚¨å™¨ï¼Œè‡ªåŠ¨å®Œæˆã€Œæ–‡æœ¬â†’å‘é‡ã€è½¬æ¢+å­˜å‚¨</span>
<span class="hljs-attr">document_ids</span> = vector_store.add_documents(documents=all_splits)

<span class="hljs-comment"># é¢„è§ˆå‰3ä¸ªæ–‡æœ¬å—çš„å”¯ä¸€æ ‡è¯†ID</span>
print(f"âœ… å‘é‡å…¥åº“å®Œæˆï¼Œæ–‡æœ¬å—IDé¢„è§ˆï¼š{document_ids<span class="hljs-section">[:3]</span>}")
</code></pre>
<hr/>
<h2 data-id="heading-9">âœ… å››ã€æ ¸å¿ƒå®ç°ï¼šæ„å»º RAG Agent æ£€ç´¢é—®ç­”æ™ºèƒ½ä½“ï¼ˆä¸¤ç§ä¸»æµæ–¹æ¡ˆï¼‰</h2>
<p>RAGçš„æ ¸å¿ƒä»·å€¼ï¼šè®©å¤§æ¨¡å‹ç»“åˆ<strong>å¤–éƒ¨çŸ¥è¯†åº“</strong>å›ç­”é—®é¢˜ï¼Œè§£å†³å¤§æ¨¡å‹ã€ŒçŸ¥è¯†è¿‡æ—¶ã€äº‹å®æ€§é”™è¯¯ã€é¢†åŸŸçŸ¥è¯†ä¸è¶³ã€çš„ç—›ç‚¹ï¼›</p>
<p>ä»¥ä¸‹æä¾›ä¸¤ç§å·¥ä¸šç•Œä¸»æµçš„RAG Agentå®ç°æ–¹æ¡ˆï¼ŒæŒ‰éœ€é€‰æ‹©å³å¯ï¼Œå‡ä¸ºå¯ç›´æ¥è¿è¡Œçš„æœ€ä¼˜å†™æ³•</p>
<h3 data-id="heading-10">âœ… æ–¹æ¡ˆä¸€ï¼šå·¥å…·è°ƒç”¨å‹ RAG Agentï¼ˆæ¨èï¼‰</h3>
<h4 data-id="heading-11">æ ¸å¿ƒé€»è¾‘</h4>
<p>è‡ªå®šä¹‰æ£€ç´¢å·¥å…·ï¼Œè®©å¤§æ¨¡å‹<strong>è‡ªä¸»å†³ç­–æ˜¯å¦è°ƒç”¨æ£€ç´¢å·¥å…·</strong>ï¼Œå¹¶åŸºäºæ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡ç”Ÿæˆç­”æ¡ˆï¼Œå…·å¤‡ã€Œå·¥å…·è°ƒç”¨æ€ç»´ã€ï¼Œé€‚é…å¤æ‚å¤šè½®é—®ç­”/å¤šæ­¥éª¤æŸ¥è¯¢åœºæ™¯ï¼Œçµæ´»æ€§æ‹‰æ»¡ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¯¼å…¥å·¥å…·è£…é¥°å™¨ï¼Œå°è£…è‡ªå®šä¹‰æ£€ç´¢å·¥å…·</span>
<span class="hljs-keyword">from</span> langchain.tools <span class="hljs-keyword">import</span> tool

<span class="hljs-comment"># å°è£…æ£€ç´¢å·¥å…·ï¼šè¿”å›æ£€ç´¢åˆ°çš„ä¸Šä¸‹æ–‡å†…å®¹+åŸå§‹æ–‡æ¡£å¯¹è±¡ï¼ŒæŒ‡å®šè¿”å›æ ¼å¼è§„èŒƒ</span>
<span class="hljs-meta">@tool(<span class="hljs-params">response_format=<span class="hljs-string">"content_and_artifact"</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">retrieve_context</span>(<span class="hljs-params">query: <span class="hljs-built_in">str</span></span>):
    <span class="hljs-string">"""æ ¸å¿ƒæ£€ç´¢å·¥å…·ï¼šæ ¹æ®ç”¨æˆ·æŸ¥è¯¢è¯­å¥ï¼Œä»å‘é‡åº“ä¸­æ£€ç´¢ç›¸å…³ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè¾…åŠ©å›ç­”é—®é¢˜"""</span>
    <span class="hljs-comment"># ç›¸ä¼¼åº¦æ£€ç´¢ï¼šè¿”å›åŒ¹é…åº¦æœ€é«˜çš„2æ¡æ–‡æœ¬å†…å®¹ï¼ˆkå€¼å¯æŒ‰éœ€è°ƒæ•´ï¼‰</span>
    retrieved_docs = vector_store.similarity_search(query, k=<span class="hljs-number">2</span>)
    <span class="hljs-comment"># æ ¼å¼åŒ–æ‹¼æ¥æ£€ç´¢ç»“æœï¼šå¸¦ä¸Šå…ƒæ•°æ®+æ–‡æœ¬å†…å®¹ï¼Œæå‡å¤§æ¨¡å‹ç†è§£æ•ˆç‡</span>
    serialized_context = <span class="hljs-string">"\n\n"</span>.join(
        (<span class="hljs-string">f"Source: <span class="hljs-subst">{doc.metadata}</span>\nContent: <span class="hljs-subst">{doc.page_content}</span>"</span>)
        <span class="hljs-keyword">for</span> doc <span class="hljs-keyword">in</span> retrieved_docs
    )
    <span class="hljs-comment"># è¿”å›æ ¼å¼åŒ–æ–‡æœ¬ + åŸå§‹æ–‡æ¡£ï¼Œå…¼é¡¾å¯è¯»æ€§ä¸æº¯æºæ€§</span>
    <span class="hljs-keyword">return</span> serialized_context, retrieved_docs

<span class="hljs-comment"># æ„å»ºå·¥å…·è°ƒç”¨å‹æ™ºèƒ½ä½“</span>
<span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> create_agent

<span class="hljs-comment"># é…ç½®æ™ºèƒ½ä½“æ ¸å¿ƒå‚æ•°ï¼šç»‘å®šå¤§æ¨¡å‹+æ£€ç´¢å·¥å…·+ç³»ç»Ÿæç¤ºè¯</span>
tools = [retrieve_context]
<span class="hljs-comment"># ç³»ç»Ÿæç¤ºè¯ï¼šæ˜ç¡®æ™ºèƒ½ä½“èƒ½åŠ›è¾¹ç•Œä¸è¡Œä¸ºå‡†åˆ™ï¼Œç²¾å‡†å¼•å¯¼å¤§æ¨¡å‹è°ƒç”¨å·¥å…·</span>
system_prompt = (
    <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„é—®ç­”åŠ©æ‰‹ï¼Œä½ å¯ä»¥è°ƒç”¨æ£€ç´¢å·¥å…·è·å–å¤–éƒ¨çŸ¥è¯†åº“çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚\n"</span>
    <span class="hljs-string">"è¯·åŠ¡å¿…ä½¿ç”¨æ£€ç´¢å·¥å…·è¾…åŠ©å›ç­”ç”¨æˆ·çš„æŸ¥è¯¢é—®é¢˜ï¼Œç¡®ä¿ç­”æ¡ˆçš„å‡†ç¡®æ€§å’Œäº‹å®æ€§ã€‚"</span>
)
<span class="hljs-comment"># åˆå§‹åŒ–å·¥å…·è°ƒç”¨å‹RAG Agent</span>
agent = create_agent(model, tools, system_prompt=system_prompt)
</code></pre>
<h4 data-id="heading-12">âœ… æµ‹è¯•æ–¹æ¡ˆä¸€ï¼šå¤æ‚å¤šæ­¥éª¤æŸ¥è¯¢ï¼ˆæ™ºèƒ½ä½“è‡ªä¸»è°ƒç”¨å·¥å…·ï¼‰</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># æµ‹è¯•æé—®ï¼šå¤šæ­¥éª¤å¤æ‚æŸ¥è¯¢ï¼Œè€ƒéªŒæ™ºèƒ½ä½“çš„å·¥å…·è°ƒç”¨èƒ½åŠ›ä¸é€»è¾‘æ¨ç†èƒ½åŠ›</span>
query = (
    <span class="hljs-string">"What is the standard method for Task Decomposition?\n\n"</span>
    <span class="hljs-string">"Once you get the answer, look up common extensions of that method."</span>
)

<span class="hljs-meta"># æµå¼è¾“å‡ºå›ç­”ç»“æœï¼Œå®æ—¶æŸ¥çœ‹æ™ºèƒ½ä½“çš„æ€è€ƒ+å›ç­”è¿‡ç¨‹ï¼ˆä½“éªŒæ›´ä½³ï¼‰</span>
print(<span class="hljs-string">"===== å·¥å…·è°ƒç”¨å‹RAG Agent å›ç­”ç»“æœ ====="</span>)
<span class="hljs-keyword">for</span> <span class="hljs-keyword">event</span> <span class="hljs-keyword">in</span> agent.stream(
    {<span class="hljs-string">"messages"</span>: [{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: query}]},
    stream_mode=<span class="hljs-string">"values"</span>,
):
    <span class="hljs-keyword">event</span>[<span class="hljs-string">"messages"</span>][<span class="hljs-number">-1</span>].pretty_print()
</code></pre>
<hr/>
<h3 data-id="heading-13">âœ… æ–¹æ¡ˆäºŒï¼šä¸Šä¸‹æ–‡æ³¨å…¥å‹ RAG Agentï¼ˆæç®€é«˜æ•ˆï¼‰</h3>
<h4 data-id="heading-14">æ ¸å¿ƒé€»è¾‘</h4>
<p>é€šè¿‡<strong>ä¸­é—´ä»¶(middleware)</strong> å®ç°ã€Œå…¨è‡ªåŠ¨æ£€ç´¢+ä¸Šä¸‹æ–‡æ³¨å…¥ã€ï¼Œæ— éœ€æ˜¾å¼å®šä¹‰å·¥å…·ï¼Œæ™ºèƒ½ä½“ä¼šåœ¨å›ç­”å‰<strong>è‡ªåŠ¨æ£€ç´¢</strong>å¹¶å°†ä¸Šä¸‹æ–‡æ³¨å…¥åˆ°ç³»ç»Ÿæç¤ºè¯ä¸­ï¼Œå…¨ç¨‹æ— æ„Ÿè°ƒç”¨ï¼Œä»£ç æç®€ã€è¿è¡Œé«˜æ•ˆï¼Œé€‚é…ç®€å•å•è½®é—®ç­”åœºæ™¯ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ„å»ºä¸Šä¸‹æ–‡æ³¨å…¥å‹æ™ºèƒ½ä½“</span>
<span class="hljs-keyword">from</span> langchain.agents.middleware <span class="hljs-keyword">import</span> dynamic_prompt, ModelRequest

<span class="hljs-comment"># å®šä¹‰åŠ¨æ€æç¤ºè¯ä¸­é—´ä»¶ï¼šè‡ªåŠ¨æ£€ç´¢+æ³¨å…¥ä¸Šä¸‹æ–‡ï¼Œæ— æ„ŸçŸ¥å®Œæˆæ£€ç´¢é€»è¾‘</span>
<span class="hljs-meta">@dynamic_prompt</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">prompt_with_context</span>(<span class="hljs-params">request: ModelRequest</span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""æ ¸å¿ƒä¸­é—´ä»¶ï¼šä»è¯·æ±‚ä¸­æå–ç”¨æˆ·æœ€æ–°é—®é¢˜ï¼Œæ£€ç´¢ç›¸å…³ä¸Šä¸‹æ–‡å¹¶æ³¨å…¥ç³»ç»Ÿæç¤ºè¯"""</span>
    <span class="hljs-comment"># æå–ç”¨æˆ·æœ€æ–°çš„æŸ¥è¯¢è¯­å¥</span>
    last_query = request.state[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>].text
    <span class="hljs-comment"># è‡ªåŠ¨æ‰§è¡Œç›¸ä¼¼åº¦æ£€ç´¢ï¼Œè·å–ç›¸å…³ä¸Šä¸‹æ–‡</span>
    retrieved_docs = vector_store.similarity_search(last_query)
    <span class="hljs-comment"># æ ¼å¼åŒ–æ‹¼æ¥æ£€ç´¢åˆ°çš„æ–‡æœ¬å†…å®¹</span>
    docs_content = <span class="hljs-string">"\n\n"</span>.join(doc.page_content <span class="hljs-keyword">for</span> doc <span class="hljs-keyword">in</span> retrieved_docs)
    <span class="hljs-comment"># æ„é€ å¸¦ä¸Šä¸‹æ–‡çš„ç³»ç»Ÿæç¤ºè¯ï¼Œè®©å¤§æ¨¡å‹åŸºäºå¤–éƒ¨çŸ¥è¯†å›ç­”</span>
    system_message = (
        <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šä¸”ä¹äºåŠ©äººçš„é—®ç­”åŠ©æ‰‹ï¼Œè¯·ä¸¥æ ¼åŸºäºä¸‹æ–¹æä¾›çš„ä¸Šä¸‹æ–‡ä¿¡æ¯å›ç­”ç”¨æˆ·é—®é¢˜ï¼š\n\n"</span>
        <span class="hljs-string">f"<span class="hljs-subst">{docs_content}</span>"</span>
    )
    <span class="hljs-keyword">return</span> system_message

<span class="hljs-comment"># åˆå§‹åŒ–ä¸Šä¸‹æ–‡æ³¨å…¥å‹RAG Agentï¼šæ— éœ€ä¼ å…¥å·¥å…·ï¼Œä¸­é—´ä»¶è‡ªåŠ¨å®Œæˆæ£€ç´¢é€»è¾‘</span>
agent = create_agent(model, tools=[], middleware=[prompt_with_context])
</code></pre>
<h4 data-id="heading-15">âœ… æµ‹è¯•æ–¹æ¡ˆäºŒï¼šåŸºç¡€å•è½®æŸ¥è¯¢ï¼ˆæç®€é«˜æ•ˆï¼‰</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æµ‹è¯•æé—®ï¼šåŸºç¡€å•è½®æŸ¥è¯¢ï¼ŒéªŒè¯ä¸Šä¸‹æ–‡æ³¨å…¥æ•ˆæœ</span>
<span class="hljs-attr">query</span> = <span class="hljs-string">"What is task decomposition?"</span>

<span class="hljs-comment"># æµå¼è¾“å‡ºå›ç­”ç»“æœ</span>
print("\<span class="hljs-attr">n</span>===== ä¸Šä¸‹æ–‡æ³¨å…¥å‹RAG Agent å›ç­”ç»“æœ =====<span class="hljs-string">")
for step in agent.stream(
    {"</span>messages<span class="hljs-string">": [{"</span>role<span class="hljs-string">": "</span>user<span class="hljs-string">", "</span>content<span class="hljs-string">": query}]},
    stream_mode="</span>values<span class="hljs-string">",
):
    step["</span>messages<span class="hljs-string">"][-1].pretty_print()
</span></code></pre>
<hr/>
<h2 data-id="heading-16">âœ¨ æ ¸å¿ƒçŸ¥è¯†ç‚¹è¡¥å……ï¼ˆæ˜é‡‘ä¸“å±ï¼ŒåŠ åˆ†é¡¹ï¼‰</h2>
<h3 data-id="heading-17">âœ… ä¸¤ç§Agentæ–¹æ¡ˆå¯¹æ¯” &amp; é€‰å‹å»ºè®®</h3>
<ol>
<li><strong>å·¥å…·è°ƒç”¨å‹ï¼ˆæ–¹æ¡ˆä¸€ï¼‰</strong> ï¼šé€‚åˆã€Œå¤æ‚æŸ¥è¯¢ã€å¤šè½®é—®ç­”ã€å¤šæ­¥éª¤æ¨ç†ã€åœºæ™¯ï¼Œå¤§æ¨¡å‹è‡ªä¸»å†³ç­–æ˜¯å¦è°ƒç”¨å·¥å…·ï¼Œçµæ´»æ€§å¼ºï¼Œæ˜¯å·¥ä¸šç•Œä¸»æµæ–¹æ¡ˆï¼›</li>
<li><strong>ä¸Šä¸‹æ–‡æ³¨å…¥å‹ï¼ˆæ–¹æ¡ˆäºŒï¼‰</strong> ï¼šé€‚åˆã€Œç®€å•å•è½®é—®ç­”ã€å¿«é€Ÿå¼€å‘ã€åœºæ™¯ï¼Œä»£ç é‡å°‘ã€æ— æ„ŸçŸ¥æ£€ç´¢ï¼Œå¼€å‘æ•ˆç‡é«˜ï¼Œä½†çµæ´»æ€§ç¨å¼±ã€‚</li>
</ol>
<h3 data-id="heading-18">âœ… æ ¸å¿ƒä¼˜åŒ–ç‚¹è¯´æ˜</h3>
<ol>
<li><code>temperature=0.1</code>ï¼šä½æ¸©åº¦å€¼ä¿è¯å›ç­”çš„<strong>ç²¾å‡†æ€§å’Œç¡®å®šæ€§</strong>ï¼Œé€‚é…çŸ¥è¯†ç±»é—®ç­”åœºæ™¯ï¼Œé¿å…ç”Ÿæˆæ— å…³å†…å®¹ï¼›</li>
<li><code>chunk_overlap=200</code>ï¼šæ–‡æœ¬å—é‡å è®¾è®¡ï¼Œå½»åº•è§£å†³ã€Œå…³é”®ä¿¡æ¯è¢«æˆªæ–­ã€çš„é—®é¢˜ï¼Œæå‡æ£€ç´¢å¬å›ç‡ï¼›</li>
<li>æµå¼è¾“å‡º<code>stream()</code>ï¼šå®æ—¶è¿”å›å›ç­”å†…å®¹ï¼Œæå‡ç”¨æˆ·ä½“éªŒï¼Œé¿å…é•¿æ—¶é—´ç­‰å¾…ï¼›</li>
<li><code>InMemoryVectorStore</code>ï¼šè½»é‡åŒ–å‘é‡åº“ï¼Œæ— éœ€éƒ¨ç½²ã€æ— éœ€æŒä¹…åŒ–ï¼Œé€‚åˆå¿«é€Ÿå¼€å‘å’Œæ¼”ç¤ºï¼Œç”Ÿäº§ç¯å¢ƒå¯æ›¿æ¢ä¸ºChroma/Pineconeç­‰æŒä¹…åŒ–å‘é‡åº“ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-19">âœ¨ æ€»ç»“</h3>
<p>æœ¬æ–‡å®Œæ•´å®ç°äº†åŸºäºLangChainçš„RAG Agentæ™ºèƒ½æ£€ç´¢é—®ç­”ç³»ç»Ÿï¼Œä»ã€Œä¾èµ–å®‰è£…â†’ç»„ä»¶é…ç½®â†’æ–‡æ¡£å¤„ç†â†’æ™ºèƒ½ä½“æ„å»ºâ†’æµ‹è¯•éªŒè¯ã€å…¨æµç¨‹é—­ç¯ï¼Œä»£ç å¯ç›´æ¥å¤åˆ¶è¿è¡Œï¼Œä¸¤ç§ä¸»æµæ–¹æ¡ˆå…¨è¦†ç›–ï¼Œé€‚é…ä¸åŒä¸šåŠ¡åœºæ™¯ã€‚RAGä½œä¸ºLLMè½åœ°çš„æ ¸å¿ƒæŠ€æœ¯ä¹‹ä¸€ï¼Œè¯¥å¥—ä»£ç å¯æ— ç¼è¿ç§»è‡³PDF/æ–‡æ¡£/æœ¬åœ°çŸ¥è¯†åº“ç­‰åœºæ™¯ï¼Œå®ç”¨æ€§æ‹‰æ»¡ã€‚</p>
<h3 data-id="heading-20">ä»£ç ä»“åº“</h3>
<p>giteeï¼š<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgitee.com%2Fo_insist%2Flangchain1.0_learn.git" title="https://link.juejin.cn/?target=https%3A%2F%2Fgitee.com%2Fo_insist%2Flangchain1.0_learn.git" target="_blank">gitee.com/o_insist/laâ€¦</a></p>
<p>githubï¼š<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fo-insist%2Flangchain1.0_learn.git" title="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fo-insist%2Flangchain1.0_learn.git" target="_blank">github.com/o-insist/laâ€¦</a></p>
<p>ğŸ”¥ ç‚¹èµ+æ”¶è—ï¼Œåç»­æŒç»­æ›´æ–°LangChain/RAG/Agentç›¸å…³å®æˆ˜æ•™ç¨‹ï¼Œå¹²è´§æ»¡æ»¡ï½</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2025ï¼šVibe Codingå¯¹æˆ‘çš„å½±å“]]></title>    <link>https://juejin.cn/post/7595974133097512994</link>    <guid>https://juejin.cn/post/7595974133097512994</guid>    <pubDate>2026-01-18T03:20:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595974133097512994" data-draft-id="7595974133097381922" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2025ï¼šVibe Codingå¯¹æˆ‘çš„å½±å“"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-18T03:20:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ShanekAI"/> <meta itemprop="url" content="https://juejin.cn/user/2027971409616333"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2025ï¼šVibe Codingå¯¹æˆ‘çš„å½±å“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2027971409616333/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ShanekAI
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T03:20:03.000Z" title="Sun Jan 18 2026 03:20:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>èµ·åˆåœ¨chatgptåˆšå‡ºæ¥çš„æ—¶å€™ï¼Œç”¨å®ƒåšä¸€äº›ç¼–ç ï¼Œreviewä»£ç ï¼Œæ„Ÿè§‰ç¡®å®æœ‰ç‚¹ä¸œè¥¿ï¼Œä½†æ˜¯æ€»è§‰å¾—å®ƒæ˜¯ä¸€ä¸ªæ™ºèƒ½ç‚¹çš„æœç´¢å™¨ç½¢äº†ï¼Œè€Œä¸”æ¯æ¬¡çš„è¾“å‡ºä¹Ÿä¸ä¸€å®šç›¸åŒï¼Œæ‰€ä»¥æœ‰ç‚¹è½»è§†äº†AIçš„å½±å“ã€‚ç›´åˆ°cursorå‡ºæ¥çš„æ—¶å€™ï¼Œæˆ‘ç¬¬ä¸€æ¬¡æ„Ÿè§‰åˆ°äº†é¢ è¦†ï¼Œå¯¹AIçš„è®¤çŸ¥ä¹Ÿä¸å†å±€é™äºä¸€ä¸ªæ™ºèƒ½æœç´¢å™¨çš„å½±å“ä¸­ï¼Œå¼€å§‹æ­£è§†å®ƒï¼Œå¼€å§‹äº†è§£å®ƒï¼Œå¼€å§‹å­¦ä¹ å®ƒï¼Œå¼€å§‹ç”¨å¥½å®ƒã€‚ç°åœ¨å®ƒå®Œå®Œå…¨å…¨å°±æ˜¯ä¸€ä¸ªä¸“å®¶ï¼Œç»™ä»–å¥½ç”¨çš„å·¥å…·ï¼ˆMCPã€Skillsï¼‰ç­‰ï¼Œæ¸…æ™°çš„é—®é¢˜æè¿°ä¸ç²¾ç¡®çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå®ƒå®Œå…¨å¯ä»¥è§£å†³å·¥ä½œä¸­é‚£äº›éœ€æ±‚ã€‚</p>
<hr/>
<h2 data-id="heading-0">AIç¼–ç </h2>
<p>ç°åœ¨æˆ‘ä¸ç®¡æ˜¯å·¥ä½œéœ€æ±‚ï¼Œè¿˜æ˜¯ä¸ªäººç©ä¸€ç©çš„é¡¹ç›®ï¼Œç™¾åˆ†ä¹‹å…­åä»¥ä¸Šçš„ä»£ç éƒ½æ˜¯AIç”Ÿæˆï¼Œçœ‹ä¼¼è¿™ä¸ªæ¯”ä¾‹ä¸æ˜¯å¾ˆé«˜ï¼Œå…¶å®å¾ˆå¤§ç¨‹åº¦æ˜¯æˆ‘æ²¡æœ‰ç»™å®ƒæè¿°æ¸…æ¥šï¼Œè®©ä»–mockäº†ä¸€äº›å®ç°ï¼Œä½†æ˜¯æˆ‘æ”¹åŠ¨èµ·æ¥ä¹Ÿæ¯”è¾ƒå¿«ï¼Œå°±ä¸€ç›´è¿™ä¹ˆé…åˆç€ï¼›è¿˜æœ‰ä¸€ä¸ªåŸå› æ˜¯å…¬å¸è¦æ±‚çš„å•æµ‹è¦†ç›–ç‡è¦95%ï¼Œæœ‰ç‚¹å¤¸å¼ ï¼Œè€ŒAIå¯èƒ½ç¡®å®åœ¨è¿™å—çš„é¢„æ–™ç›¸å¯¹å°‘ï¼Œå¯¼è‡´ç”Ÿæˆçš„å•æµ‹çš„è´¨é‡ä¸æ˜¯å¾ˆé«˜ï¼Œæ‰€ä»¥ä¸€èˆ¬æˆ‘è¦ä»‹å…¥ä¸€ä¸‹ï¼Œå¤šæ•°éœ€æ±‚ç¼–ç åœºæ™¯ï¼Œå®ƒéƒ½å¯ä»¥ç‹¬è‡ªå®Œæˆã€‚</p>
<p>ä½†æ˜¯è¿™ä¹Ÿå¯¼è‡´äº†ä»»åŠ¡çš„å·¥æœŸç¼©çŸ­ï¼ŒåŸæœ¬ä¸¤å‘¨çš„è¿­ä»£å¼€å‘ï¼Œæœ‰äº†AIè¾…åŠ©ï¼Œé¢†å¯¼åªæ„¿æ„ç»™ä½ ä¸¤å¤©ï¼Œä½†æ˜¯ä½ è¿˜æ˜¯éœ€è¦è‡ªæµ‹+è¾“å‡ºæŠ¥å‘Šï¼Œå¹¶ä¸”æ¯ä¸ªä»»åŠ¡å°±ç®—AIç¼–ç ä¹Ÿä¸èƒ½ä¿è¯æ²¡æœ‰æ•…éšœï¼Œå°±ä¼šå¯¼è‡´æ–°çš„ä»»åŠ¡å¼€å§‹å¼€å‘äº†ï¼Œè¿˜åœ¨æ”¹ä¹‹å‰ä»»åŠ¡çš„bug,å¿ƒç´¯çš„è¯´ä¸å‡ºè¯æ¥ã€‚</p>
<h2 data-id="heading-1">AIææ•ˆ</h2>
<p>è¿™ä¸ªè¯æ˜¯æœ€è¿‘ä¸€å¹´æœ€ç«çƒ­çš„è¯ï¼Œä¸ç®¡æ˜¯å¤§å‚ã€ä¸­å‚ã€å°å‚ã€‚éœ€æ±‚ææ•ˆã€æµ‹è¯•ææ•ˆã€å¼€å‘ææ•ˆç­‰æœ€ç»ˆéƒ½ä¼šåœ¨äººå‘˜ææ•ˆä¸Šé—­ç¯ã€‚ä¸çŸ¥é“è¿™æ˜¯ä¸æ˜¯æŠ€æœ¯å˜é©æ‰€å¸¦æ¥çš„å¿…è¦ç»“æœå‘¢ï¼Œåæ­£è¿‡å»ä¸€å¹´ä»»åŠ¡åœ¨å¢åŠ ï¼Œäººå‘˜åœ¨å‡å°‘è¿™ä»¶äº‹åœ¨æˆ‘çš„é¡¹ç›®ï¼Œæˆ‘å‘¨å›´çš„é¡¹ç›®å›¢é˜Ÿæˆäº†ä¸€ä»¶å¾ˆæ­£å¸¸çš„äº‹äº†ã€‚</p>
<h2 data-id="heading-2">å¼€æºç¤¾åŒº</h2>
<p>è¿‡å»å‡ ä¸ªæœˆæˆ‘ä¹Ÿä¸æ€ä¹ˆåšåˆ†äº«äº†ï¼Œæˆ‘è¯´çš„å†…å®¹åŠ¨åŠ¨æ‰‹æŒ‡ï¼Œåˆ°chatgptã€Google AI studioç­‰å¹³å°åŸºæœ¬èƒ½è·å¾—æ›´é«˜è´¨é‡çš„å›ç­”ï¼Œè€Œä¸”æˆ‘ä¹Ÿå‡å°‘äº†çœ‹ç¤¾åŒºå†…å®¹çš„ä¹ æƒ¯ï¼Œå› ä¸ºæœ‰äº›æ–‡ç« ä»AIæ‹·è´è¿‡æ¥ï¼Œä¸ç»è¿‡éªŒè¯å°±å‘å‡ºæ¥ï¼Œè¿™äº›ä¸è´Ÿè´£ä»»çš„åšæ³•ï¼Œæœ‰å¯èƒ½å¯¼è‡´åˆ«äººåœ¨ç”Ÿäº§ä¸­é‡åˆ°é—®é¢˜ï¼Œå¸Œæœ›åˆ†äº«çš„äººï¼Œæœ€èµ·ç æŠŠéªŒè¯è¿‡çš„å†…å®¹å‘å‡ºæ¥ã€‚</p>
<h2 data-id="heading-3">åšå®¢</h2>
<p>ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰å‘ç°ï¼Œåšå®¢å½¢å¼çš„åˆ†äº«è¶Šæ¥è¶Šå—æ¬¢è¿ã€‚æ˜¯ä¸æ˜¯æ¯”èµ·å†°å†·çš„æ–‡å­—ï¼Œå¯è§çš„å£è¿°æ˜¯ä¸€ç§æ›´å¥½çš„åˆ†äº«å‘¢ï¼Ÿ</p>
<h2 data-id="heading-4">å†™åœ¨æœ€å</h2>
<p>AIæ˜¯ä¼šè¶Šæ¥è¶Šå‰å®³ï¼Œä¸å…¶åšæŠ±æ€¨çš„çººç»‡å·¥ï¼Œä¸å¦‚å­¦ä¹ ç”¨å¥½çººç»‡æœºå§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§æ¨¡å‹è®­ç»ƒå…¨æµç¨‹å®æˆ˜æŒ‡å—åŸºç¡€ç¯‡ï¼ˆä¸‰ï¼‰â€”â€”å¤§æ¨¡å‹æœ¬åœ°éƒ¨ç½²å®æˆ˜ï¼ˆVllmä¸Ollamaï¼‰]]></title>    <link>https://juejin.cn/post/7595896809652437032</link>    <guid>https://juejin.cn/post/7595896809652437032</guid>    <pubDate>2026-01-18T03:19:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595896809652437032" data-draft-id="7595414148487282728" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§æ¨¡å‹è®­ç»ƒå…¨æµç¨‹å®æˆ˜æŒ‡å—åŸºç¡€ç¯‡ï¼ˆä¸‰ï¼‰â€”â€”å¤§æ¨¡å‹æœ¬åœ°éƒ¨ç½²å®æˆ˜ï¼ˆVllmä¸Ollamaï¼‰"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,LangChain,DeepSeek"/> <meta itemprop="datePublished" content="2026-01-18T03:19:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§æ¨¡å‹çœŸå¥½ç©"/> <meta itemprop="url" content="https://juejin.cn/user/3140624091453053"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§æ¨¡å‹è®­ç»ƒå…¨æµç¨‹å®æˆ˜æŒ‡å—åŸºç¡€ç¯‡ï¼ˆä¸‰ï¼‰â€”â€”å¤§æ¨¡å‹æœ¬åœ°éƒ¨ç½²å®æˆ˜ï¼ˆVllmä¸Ollamaï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3140624091453053/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§æ¨¡å‹çœŸå¥½ç©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T03:19:25.000Z" title="Sun Jan 18 2026 03:19:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»20åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252b3a}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px;color:#5e7ce0}.markdown-body h1{font-size:24px;margin-bottom:5px;margin-top:80px;position:relative;text-align:center}.markdown-body h2{font-size:20px;padding-bottom:12px;border-bottom:1px solid #dfe1e6}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px;margin-top:30px}.markdown-body h5{font-size:14px;margin-top:20px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #dfe1e6;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#ffeeed;color:#c73636;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#252b3a;background:#f8f8f8}.markdown-body a{position:relative;text-decoration:none;color:#5e7ce0;padding-right:18px;padding-bottom:4px}.markdown-body a[href^=http]:after{position:absolute;display:inline-block;width:16px;height:16px;margin-left:2px;margin-top:6px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAIRlWElmTU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAACCgAwAEAAAAAQAAACAAAAAAX7wP8AAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KGV7hBwAABWVJREFUWAnlVktsVFUY/s85997pC9BOTKxRWnEKsXWlxjWJj0RWJjrFAAXjAlewYWOkgauACVu7a2IiNUEyExM3yoZE3Wmi7qgPJthJBDE6JUNpO3Mf5/j95/bOTOcBlBgXejJ37rn/Of/7O/9/iP7vQ/zTAcjnC4ry+a5ii1OkiYTpuvjvEc0Gp51uivP+ZW+QBuSW4QjW5rptAa1Ey0uOGKOxwPetVyafN6p/52/PkNBbjdAhGaGEpMRjLZTryB8+9MUSYSGNRIcBvm8kBAY9tHYlHz78nTs392xIkwv9FA3Oe33bdoX1ZZKOS0bH0CXI6RugYLW6BwIu5gskkQ4sEG0wYF25PjBzbZfSYY6kDLUmWMt7FR7Lw3xYUkaTdjxHfTPnPwav0iEGYADVa9XIRIEyxrAA0jIQxgFL22gYwF7A8/DAzNVdksJvJaTEUZ2kYnZWziN5s1ADPHneEIXByotYuMSrf9JEbbsuv7VcvbaKML8plXtQR0EdIYDqWEmtOgAomZFH8EjWSnek2ulmtljljttHbmaIHCCCHzd9MjwfsmscBeZH9Jyd10nMvz92UQrtCBKvMF06mQy0SiEdRMEGg8mN0YjAlgoDDkPrMI5qJKSkKKydpbB2CZjJkhIBvOBw2CGQgii85bpx//dMqFRKam5uvH7w+K97oe+Cl0HO68uIBH0qyEzpOMwIbZIcFq0I+9cwoElizCjk2KFI1y7Nnx614W1db58fOXIlMzs7Xn/jeDmvBV2Q0mXjGf554O/m4LZHp2N8r61WPMvLZWLdiC4GMAk5BjeeB5lhv39l6+BIbu3m760hXMDKBD08XBKzR8fr04nygnIypOOAJUx/fHrsi0Mnys+vVK+V4VUohaiyPCo2Q9DFALvF/ikw8WS4QvVZALS5ksw47/7R8ejgTPk1UFqU6/3zp8bOM7B/kdu/fkguPGU5JibW+F0sTjWOUw8DklRrg4BiLGeBqbaRLxjlT4no0InFV402RcftJz41cH/f/JnHP3kZaaF6VX/liwist9vYG5+NU9Cg3MNkt/+lU5wS8fTxq3mc7ILjDlAE4CJpe89BOWPiIjBhi9O6PI4G1jsc6RGB3lZwmS76k8H0zOKTkFboG8jS2krFKCX2fvTeaPHIBwAkMHHgncURnL3nuCSnxSopdIzN5th0BIonJ0Lf9yUA9iMkzdRWl3BixOusfDcwQVcS4UKIFwYfGPnM8wY/DyP9NFMXaTE5BU39tGkDgGZz+fJJG0oYcSaOafLcqdECY4LzfSObSzyUOgxqtyisr8SSNOOAkubWoh3TTaeA2YtFEXPnm5x81/j+6MI6JqyS25WSNU6hbCMKHG84marJbdR+vwakRhQLRuQpbzHRLjmpmijI+OmWCtq+LzWtnX5v30gHSsqmWne74DtiACi2+Wz0iXbuLt9D2cDyoPEkWOiyp5XUIwLMi/wJY1FbH5B9ONtdC1KrsD/Q0MCQAS0wccILORDW25amAeOtooAj/KQxfzF17uwTSQ1v3dJ7jnLINwdZYRDa4tPU0sHVXFo/vxFF5BqFqxRfOmgPCk4ft2NgKTCy2Y47JIEg+MIhjYsLy5I25qUYTQlCjMRHsr/UwdYwIK33UO1J5fFNB9XNO6akcywJofVmXQDP2wfrSPcI2xG5BSs3I+IosHr4EtvO1TDAu16xHQq5+ykMblfRXLbhEoFIdDTBdhldvzl+3CMg60ZktI2vNzLW6IIp0waLklot9L63yzuUp8dJd7bglPFe3hIXstBEP58/s6Ocyr4rH2+866ZNbriTzA0RSOWCwakMl1QJgculxPt8Z7O5GLdtW6bvU8R/nO1vb+hMExVAVtEAAAAASUVORK5CYII=");background-size:100%}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #5e7ce0}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #5e7ce0;border-spacing:0}.markdown-body thead{color:#fff;text-align:left}.markdown-body thead tr{background:#5e7ce0}.markdown-body thead th{border-bottom:1px solid #dfe1e6}.markdown-body tr{background-color:#fff}.markdown-body tr:nth-child(2n){background-color:#f2f5fc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#252b3a;padding:1px 23px;margin:22px 0;border-left:4px solid #5e7ce0;background-color:#f2f5fc}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{padding-left:10px;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5e7ce0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ul li::marker{content:"â€¢";color:#5e7ce0}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]:before{display:inline-block;width:16px;height:16px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAhRJREFUeAHtnLEuBFEUhs9cu7JCskEhIrZAgYZGoREPwBuIygOoPITKA6jEG/AAolFoaFCgICIKZBNiY8Pyz5rNOWe9wNz5T7N3Z2eT/b/7zZlpziat3xKWBDJoEyh5EDd3DTk5r8vV7Yc8vzbl6zvfwvSERIYHyzI90SeLc1WZrFV85PR9oi+N/YMnOT6t/3tiLAeXFqqytjrSFacDYmfvQS6u37tOiPHA7FS/bK6PmWhpj4AJRYGA9MiKzLpK6An+cqiNVmRleUhArrec6PNzt/5sttLgh0cvcvfY6Px+ZNY9I6Ax6gKErY1xmZ8ZyD0E5MJGIgsyIZsunT3g7qALJuTdAp0nWyMTsunS2QNukbpwOcRaPpvOHvxzQow2ZBvrs+nsfLL8o0QQBJFdMO1XGkEjaIQlQCMsD/YIGkEjLAEaYXmwR9AIGmEJ0AjLgz2CRtAIS4BGWB7sETSCRlgCNMLyYI+gETTCEqARlgd7BI2gEZYAjbA82CNoBI2wBGiE5cEeQSNohCVAIywP9ggaQSMsARphebBH0AgaYQnQCMsjYC5SF2agYi2fTWcPGA7VFfO0n8+mswdMyOrCNJwnpz/P6xqZkE2Xzh4w8qcLI4Hbu/dydvkWBRAAQBZk0uOOyKyzp5PARRiF1puNtR+NTh+oMCvtJ+D8F2N6j6x+PrwzG46gRTDDm5BtsAGBg0X924Qfj7i23p7HNgQAAAAASUVORK5CYII=");background-size:100%;position:relative;right:2px;top:-5px}.markdown-body input[type=checkbox]:checked:before{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAABMtJREFUeAHtXM2KFDEQzrQKruIu4mEXRFlUVLz4A4K7B99AcO8io0/gwQfxDVzFuwu+gQf34EG8iOAPKAh6EFlBFMSf/qa2uqszlVR6ZtYxM5PDJNVVSer78nU6KrHzpyxuVlwx44AY2O0T8eb9D7f5fMu9fPvdff7y0/36nbdgdhUdd+jgHnf62JxbObvgjh/d60Pu2R35ajx49Mk9frqlBk7Kw8sXF9y1K4t9cCoi7tz/4F68/tYXMIkPzpzY725dP9yA1tsjoIRpIQHogRWYZSmwJ4Reh06nI2Nd7rYEA8zAzqXAxhgq/pc1d9vHKbEX+Dr4JbzypJDc/YxXYi/wifRLeOXpU5q7n/FK7EXsnBBeeRoqd7/EHj1ZhleeiMjdz8pArRKR+0pb+UsCuK0SkftKW/kzeFmrRHCAxWzufsaJOkqExWzufpOI8EpP1jnCJCK80pN1jjCJ4ICwMigidz/jRD3bI7bZUInIfaWt/KUSuK0SEd4jqFvufgYva5UIDrCYzd3POFFHifhfV/7k8lwPw7D5mUSEV3r854ju2pK7ffOIWzk/X+Go803Lr+ooGqoiwkyP9xzRXVt0q9sE3CgJYTLqfNPyE/irpkoEe2um6ck4bSiBSeD8JBl41jY/Hgd1lIiaaeoyLlsjgUGAjEH3DB4DtUpEW2Z3Mj5GAgA8efbVvXpX/200nln5IMYvKhHDrvylcwdc9+pSNdeg46WQsP7wo2s7fpWYaPT926fw9ZiVk4BpywYJkGuvlJs4EuWS0p/HTyHh3kbzH2najM85cR0lgpPiYMtukFB26m1u5Ua+vkFkWP3Zn0KCJDg1Px6f42Wtvhrhdyz8ncanrFKCmGH1wrwDMCrh/uxPIUFTAvdHbeVPsc1fVRE+c7Ud/k6fWt7XHFlYqcqQ5wTRvWpiY4wrIZwfDUL+akDRUBXB/jCzFCH9SHCzTDRUmsro7z+cEvrHwxOZn2ZTL/pVFcEBtRLoiWXfxQ5ehvoHHx4vpIwUEuJKSMvPz5/zQq0qwmIy5m+rjBQSwnsCQYnlgwjfT72av6oifOba2qnKcOXeGVIP0rT3BALTNr8mBWSpRHAgmJSTtLGhDHwj+A9GPCbX2DNiBSRoShg0H8zl5y/njxIhJ0WntralDJmIbO+UEvz85Zwt9wj7HIDB5Ttp7RkyGbRDSqC49vOjX50P9aexmr+qInzmajvtO13H02SpyrCVMNj8dT7/4BwByDXzRIC0LWXEldA/njVfip9GpV9VERxQM0lPhrVDyrCVMJr5/fwZJ+qWewR1lSuNJ21sXxnjVgIhck5VhM/cqG1WBpIAMX4Z9Xz+eP58sFUiOBArLQcZpQ0CNCXt1HzA5OfPOFGrrwYHyKTwbNJsxolaJUJbKeo0mu/4uMeXBHBbJSK88qP5jo97fAYva5UIDgivHEXk7mecqKNEhFeOhsjdbxKR+0pb+UsCuK0qIveVtvJn8LJWieAAi9nc/YwTdZQIi9nc/SYR4ZWenSO2yZvgcwTuRYZKWBnUI3e/xF7gcmio5L4HWPlL7AVuyPol95W28me8EnuBa8J+sZjM3c94JfYCd6VxTXjaCjDLe+K9cwTuSuOa8LQUYPXvh1d3w0HC7JK8kMK0/rcJfwHkVMYgi4xhOgAAAABJRU5ErkJggg==");background-size:100%}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä¸Šç¯‡æ–‡ç«  <a href="https://juejin.cn/post/7594655863548297268" target="_blank" title="https://juejin.cn/post/7594655863548297268">å¤§æ¨¡å‹è®­ç»ƒå…¨æµç¨‹å®æˆ˜æŒ‡å—åŸºç¡€ç¯‡ï¼ˆäºŒï¼‰â€”â€”å¤§æ¨¡å‹æ–‡ä»¶ç»“æ„è§£è¯»ä¸åŸç†è§£æ</a>å‰–æäº†å¤§æ¨¡å‹çš„æ ¸å¿ƒæ–‡ä»¶ç»„æˆä¸ç”ŸæˆåŸç†ï¼Œå¹¶é€šè¿‡å®æˆ˜æ¼”ç¤ºäº†ä»æ¨¡å‹åŠ è½½åˆ°æ–‡æœ¬ç”Ÿæˆçš„å®Œæ•´æµç¨‹ã€‚é‚£ä¹ˆåœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¯¸å¦‚ DeepSeekã€è±†åŒ…è¿™ç±»å¤§å®¶æ—¥å¸¸ä½¿ç”¨çš„å¤§æ¨¡å‹ï¼Œç©¶ç«Ÿæ˜¯å¦‚ä½•é«˜æ•ˆéƒ¨ç½²å¹¶æ”¯æ’‘å¤§è§„æ¨¡è°ƒç”¨å‘¢ï¼Ÿæœ¬ç¯‡ç¬”è€…ä¸å¤§å®¶ä¸€èµ·å®æˆ˜ä¸¤ç§ä¸»æµéƒ¨ç½²æ–¹æ¡ˆï¼š<strong>é€‚åˆæœ¬åœ°å¿«é€Ÿå®éªŒçš„ Ollama éƒ¨ç½²</strong>ä¸<strong>é¢å‘ç”Ÿäº§ç¯å¢ƒçš„é«˜æ€§èƒ½ Vllm éƒ¨ç½²</strong>ã€‚ç¬”è€…å°†ä»ç¯å¢ƒå‡†å¤‡ã€éƒ¨ç½²æ­¥éª¤åˆ°è°ƒç”¨ç¤ºä¾‹é€ä¸€å±•å¼€ï¼Œå¸®åŠ©å¤§å®¶åœ¨ä¸åŒåœºæ™¯ä¸‹éƒ½èƒ½é¡ºåˆ©æ­å»ºè‡ªå·±çš„å¤§æ¨¡å‹æœåŠ¡ã€‚(æ¸©é¦¨æç¤ºï¼šæœ¬ç« å†…å®¹è¾ƒé•¿ï¼Œä½†è¯¦å®è®°è½½äº†æœ¬åœ°éƒ¨ç½²çš„ç›¸å…³æ­¥éª¤ï¼Œå¹¶ç»™å‡ºäº†ä¼˜åŒ–æŒ‡å—ï¼Œå¤§å®¶å¦‚æœå¯¹éƒ¨ç½²æœ¬åœ°å¤§æ¨¡å‹ä¸ç†Ÿæ‚‰å¯æ”¶è—é˜…è¯»ï¼Œæ„Ÿè°¢æ”¯æŒ)ã€‚</p>
<p>å¤§æ¨¡å‹è®­ç»ƒå¯¹è®¡ç®—èµ„æºæœ‰ä¸€å®šè¦æ±‚ï¼Œå°¤å…¶æ˜¯GPUæ˜¾å­˜ã€‚ä¸ºé™ä½å­¦ä¹ é—¨æ§›ï¼Œç¬”è€…ä¸å›½å†…ä¸»æµäº‘å¹³å°åˆä½œï¼Œå¤§å®¶å¯ä»¥é€šè¿‡æ‰“å¼€é“¾æ¥: <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.lab4ai.cn%2Fregister%3FagentID%3Duser-XorgKKc56U" target="_blank" title="https://www.lab4ai.cn/register?agentID=user-XorgKKc56U" ref="nofollow noopener noreferrer">www.lab4ai.cn/register?agâ€¦</a> ï¼Œä½“éªŒ<strong>H100 GPU 6.5å°æ—¶</strong>çš„ç®—åŠ›ã€‚æœ¬ç³»åˆ—æ‰€æœ‰å®æˆ˜æ•™ç¨‹å‡å°†åœ¨è¯¥å¹³å°ä¸Šå®Œæˆï¼Œå¸®åŠ©å¤§å®¶ä½æˆæœ¬ä¸Šæ‰‹å®è·µã€‚</p>
<p>é™¤å¤§æ¨¡å‹è®­ç»ƒå¤–ï¼Œç¬”è€…ä¹Ÿåœ¨åŒæ­¥æ›´æ–°<a href="https://juejin.cn/column/7526240014499495972" target="_blank" title="https://juejin.cn/column/7526240014499495972">ã€Šæ·±å…¥æµ…å‡ºLangChain&amp;LangGraph AI Agent æ™ºèƒ½ä½“å¼€å‘ã€‹</a>å…è´¹ä¸“æ ï¼Œè¦è¯´æ˜è¯¥ä¸“æ é€‚åˆæ‰€æœ‰å¯¹ LangChain æ„Ÿå…´è¶£çš„å­¦ä¹ è€…ï¼Œæ— è®ºä¹‹å‰æ˜¯å¦æ¥è§¦è¿‡ LangChainã€‚è¯¥ä¸“æ åŸºäºç¬”è€…åœ¨å®é™…é¡¹ç›®ä¸­çš„æ·±åº¦ä½¿ç”¨ç»éªŒï¼Œç³»ç»Ÿè®²è§£äº†ä½¿ç”¨LangChain/LangGraphå¦‚ä½•å¼€å‘æ™ºèƒ½ä½“ï¼Œç›®å‰å·²æ›´æ–° 37 è®²ï¼Œå¹¶æŒç»­è¡¥å……å®æˆ˜ä¸æ‹“å±•å†…å®¹ã€‚æ¬¢è¿æ„Ÿå…´è¶£çš„åŒå­¦å…³æ³¨ç¬”è€…çš„æ˜é‡‘è´¦å·ä¸ä¸“æ ï¼Œä¹Ÿå¯å…³æ³¨ç¬”è€…çš„åŒåå¾®ä¿¡å…¬ä¼—å·<strong>å¤§æ¨¡å‹çœŸå¥½ç©</strong>ï¼Œæ¯æœŸåˆ†äº«æ¶‰åŠçš„ä»£ç å‡å¯åœ¨å…¬ä¼—å·ç§ä¿¡: <strong>LangChainæ™ºèƒ½ä½“å¼€å‘</strong>å…è´¹è·å–ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€æœ¬åœ°éƒ¨ç½²å¤§æ¨¡å‹ä¼˜åŠ¿</h2>
<p>ç›¸ä¿¡å¾ˆå¤šåŒå­¦å’Œæˆ‘ä¸€æ ·ï¼Œå¹³æ—¶ä¼šç›´æ¥ä½¿ç”¨ DeepSeekã€é€šä¹‰åƒé—®ç­‰æä¾›çš„ API æœåŠ¡â€”â€”è¿™ç§æ–¹å¼ç¡®å®æ–¹ä¾¿å¿«æ·ã€‚æ—¢ç„¶äº‘ç«¯è°ƒç”¨å¦‚æ­¤ä¾¿åˆ©ï¼Œä¸ºä»€ä¹ˆè¿˜è¦å­¦ä¹ æœ¬åœ°éƒ¨ç½²å¤§æ¨¡å‹å‘¢ï¼Ÿ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d41b84e1bee84b248ed58599ea821c06~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=nep5%2B2JfDst5NdX%2BS80d6%2FnhF3Q%3D" alt="0.png" loading="lazy"/></p>
<p>ä¸äº‘ç«¯éƒ¨ç½²ç›¸æ¯”ï¼Œå°†å¤§æ¨¡å‹éƒ¨ç½²åœ¨æœ¬åœ°é€šå¸¸å…·å¤‡ä»¥ä¸‹å‡ ç‚¹ä¼˜åŠ¿ï¼š</p>
<ol>
<li><strong>æ•°æ®éšç§ä¸å®‰å…¨å¯æ§</strong><br/>
è®¸å¤šä¼ä¸šä¼šä½¿ç”¨å†…éƒ¨æ•°æ®è®­ç»ƒæˆ–å¾®è°ƒå¤§æ¨¡å‹ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­éš¾å…éœ€è¦æ¨¡å‹å‚ä¸æ•°æ®å¤„ç†ã€‚ä¸ºé¿å…ä¼ä¸šæœºå¯†ã€ä¸ªäººéšç§æˆ–å—ç›‘ç®¡æ•°æ®ä¸Šä¼ è‡³ç¬¬ä¸‰æ–¹å¹³å°ï¼Œæœ¬åœ°éƒ¨ç½²èƒ½æ›´å¥½åœ°æ»¡è¶³æ•°æ®åˆè§„è¦æ±‚ï¼Œä¿éšœæ•°æ®ä¸å‡ºåŸŸã€‚</li>
<li><strong>å®Œå…¨è‡ªä¸»çš„æ§åˆ¶æƒ</strong><br/>
äº‘ç«¯æœåŠ¡å¯èƒ½å› å‚å•†é™é€Ÿã€æœåŠ¡ä¸­æ–­æˆ–æ¨¡å‹ç‰ˆæœ¬æ›´æ–°è€Œå¯¼è‡´è°ƒç”¨å¤±è´¥æˆ–æ•ˆæœæ³¢åŠ¨ï¼ˆä¾‹å¦‚å¹´åˆ DeepSeek æœåŠ¡å—æ”»å‡»ï¼Œæˆ–å¹³æ—¶å¿˜è®°ç»­è´¹å¯¼è‡´è°ƒç”¨å¤±è´¥ï¼‰ã€‚æœ¬åœ°éƒ¨ç½²åˆ™ç¡®ä¿æ¨¡å‹ç‰ˆæœ¬ã€æœåŠ¡ç¨³å®šæ€§å®Œå…¨ç”±è‡ªå·±æŒæ§ï¼Œé¿å…å› å¤–éƒ¨å› ç´ å½±å“ä¸šåŠ¡è¿ç»­æ€§ã€‚</li>
<li><strong>é•¿æœŸæˆæœ¬æ›´å¯æ§</strong><br/>
è™½ç„¶åˆæœŸéœ€è¦æŠ•å…¥ç¡¬ä»¶ä¸éƒ¨ç½²æˆæœ¬ï¼Œä½†é•¿æœŸä½¿ç”¨è¾¹é™…æˆæœ¬æä½ï¼Œå°¤å…¶é€‚åˆé«˜é¢‘è°ƒç”¨æˆ–è§„æ¨¡åŒ–åº”ç”¨åœºæ™¯ã€‚è¿™ä¹Ÿé¿å…äº†å› ä¾›åº”å•†å®šä»·ç­–ç•¥è°ƒæ•´è€Œå¸¦æ¥çš„ä¸ç¡®å®šæ€§ï¼Œæœ‰åˆ©äºé•¿æœŸé¡¹ç›®è§„åˆ’ã€‚</li>
</ol>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œå¯¹äºé‡è§†æ•°æ®å®‰å…¨ã€éœ€è¦ç¨³å®šæœåŠ¡æˆ–é•¿æœŸæˆæœ¬æ§åˆ¶çš„ä¼ä¸šã€ç§‘ç ”å›¢é˜ŸåŠå¼€å‘è€…æ¥è¯´ï¼ŒæŒæ¡æœ¬åœ°éƒ¨ç½²å¤§æ¨¡å‹çš„èƒ½åŠ›å…·æœ‰é‡è¦ä»·å€¼ã€‚å®ƒä¸ä»…æ˜¯æŠ€æœ¯ä¿éšœï¼Œä¹Ÿé€æ¸æˆä¸ºä¸€é¡¹æ ¸å¿ƒç«äº‰ä¼˜åŠ¿ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œç¬”è€…å°†ä¸ºå¤§å®¶åˆ†äº«ä¸¤ç§å®ç”¨çš„éƒ¨ç½²æ–¹æ¡ˆï¼šé€‚åˆç”Ÿäº§ç¯å¢ƒçš„é«˜æ€§èƒ½Â <strong>Vllm</strong>Â éƒ¨ç½²æ–¹æ¡ˆï¼Œä»¥åŠé€‚åˆæœ¬åœ°å¿«é€Ÿå®éªŒçš„Â <strong>Ollama</strong>Â éƒ¨ç½²æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-2">äºŒã€VLLMå¤§æ¨¡å‹éƒ¨ç½²æ–¹æ¡ˆ</h2>
<h3 data-id="heading-3">2.1 è®¤è¯†VLLM</h3>
<p>è™½ç„¶å¯ä»¥ä½¿ç”¨Â <code>transformers</code>Â åº“æ¥å®Œæˆå¤§æ¨¡å‹çš„è°ƒç”¨å’Œæ¨ç†ï¼Œä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¾€å¾€éœ€è¦æ›´é«˜çš„æ¨ç†æ•ˆç‡ã€‚ä¸ºæ­¤ä¸“ä¸ºé«˜æ€§èƒ½æ¨ç†çš„Â <code>vllm</code>Â åº“åº”è¿è€Œç”Ÿã€‚</p>
<p>vLLM æ˜¯åŠ å·å¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡å¼€å‘çš„ä¸€ä¸ª Python åº“ï¼Œå…¶æ ¸å¿ƒä¼˜åŠ¿åœ¨äº<strong>åˆ›æ–°çš„å†…å­˜ç®¡ç†æŠ€æœ¯ã€é«˜æ•ˆçš„ä»»åŠ¡è°ƒåº¦èƒ½åŠ›ï¼Œä»¥åŠå‡ºè‰²çš„æ˜“ç”¨æ€§å’Œå…¼å®¹æ€§</strong>ã€‚è¿™ä½¿å¾—å®ƒèƒ½åœ¨ç›¸åŒç¡¬ä»¶ä¸Šæ˜¾è‘—æå‡æ¨¡å‹æ¨ç†çš„ååé‡ä¸å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚å› æ­¤ï¼ŒvLLM éå¸¸é€‚åˆéœ€è¦å¿«é€Ÿå“åº”ã€é«˜å¹¶å‘çš„ç”Ÿäº§ç¯å¢ƒã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒvLLM ç›®å‰ä»…æ”¯æŒ Linux ç³»ç»Ÿï¼Œåœ¨ Windows ä¸‹æ— æ³•ä½¿ç”¨ã€‚å¦‚æœå¤§å®¶ä½¿ç”¨çš„æ˜¯ Windows ç¯å¢ƒï¼Œå¯ä»¥è€ƒè™‘ä¸‹æ–‡å°†ä»‹ç»çš„ Ollama æ¡†æ¶ä½œä¸ºæ›¿ä»£æ–¹æ¡ˆã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2c34d4f9eae04f16afd73c0a1f6c2a4f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=diIqHenp4rb7rspq7FA65SaVEXA%3D" alt="1.png" loading="lazy"/></p>
<p>vllmçš„æ ¸å¿ƒä¼˜åŠ¿æ€»ç»“ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹:</p>
<ol>
<li><strong>æè‡´çš„å†…å­˜æ•ˆç‡:</strong> åˆ©ç”¨åˆ†é¡µæ³¨æ„åŠ›æœºåˆ¶å’ŒKVç¼“å­˜ï¼Œ å°†æ˜¾å­˜åˆ©ç”¨ç‡æé«˜åˆ°90%</li>
<li><strong>æé«˜çš„ååé‡ä¸å¹¶å‘ï¼š</strong> åŠ¨æ€åˆå¹¶æ–°è¯·æ±‚åˆ°æ­£åœ¨è¿›è¡Œçš„æ‰¹å¤„ç†ä¸­ï¼Œ<strong>æŒç»­â€œæ¦¨å¹²â€GPUç®—åŠ›</strong>ï¼Œååé‡å¯è¾¾ä¼ ç»Ÿé™æ€æ‰¹å¤„ç†çš„2.8å€</li>
<li><strong>å¼€ç®±å³ç”¨çš„æ˜“ç”¨æ€§ï¼š</strong> vllmä¸Â <strong>HuggingFace</strong>Â æ— ç¼é›†æˆï¼Œæ›´æ˜¯æä¾›Â <strong>OpenAIå…¼å®¹çš„API</strong>ï¼Œæ— éœ€å¤æ‚è½¬æ¢å³å¯åŠ è½½ä¸»æµå¼€æºæ¨¡å‹ï¼›ç°æœ‰åº”ç”¨å¯æ— ç¼è¿ç§»ï¼Œæå¤§é™ä½éƒ¨ç½²é—¨æ§›ã€‚</li>
</ol>
<h3 data-id="heading-4">2.2 VLLMå¤§æ¨¡å‹éƒ¨ç½²æ–¹æ¡ˆå®æˆ˜</h3>
<p>æ—¢ç„¶vllméƒ¨ç½²æœ‰è¿™ä¹ˆå¤§çš„ä¼˜ç‚¹ï¼Œé‚£æ¥ä¸‹æ¥å¿…ç„¶è¦å­¦ä¹ ä¸€ä¸‹vllmçš„éƒ¨ç½²æ–¹æ³•äº†ï¼Œæœ¬æ¬¡å®éªŒç¯å¢ƒåŒæ ·æ˜¯åœ¨ä¹ç« äº‘æç®—åŠ›å¹³å°ä¸‹è¿›è¡Œéƒ¨ç½²ï¼Œå¤§å®¶å¯ä»¥é€šè¿‡æ‰“å¼€é“¾æ¥: <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.lab4ai.cn%2Fregister%3FagentID%3Duser-XorgKKc56U" target="_blank" title="https://www.lab4ai.cn/register?agentID=user-XorgKKc56U" ref="nofollow noopener noreferrer">www.lab4ai.cn/register?agâ€¦</a> ï¼Œå…è´¹ä½“éªŒ<strong>H100 GPU 6.5å°æ—¶</strong>çš„ç®—åŠ›ã€‚æœ¬ç³»åˆ—æ‰€æœ‰å®æˆ˜æ•™ç¨‹å‡å°†åœ¨è¯¥å¹³å°ä¸Šå®Œæˆï¼Œå¸®åŠ©å¤§å®¶ä½æˆæœ¬ä¸Šæ‰‹å®è·µã€‚</p>
<ol>
<li>
<p><strong>åˆ›å»ºå®ä¾‹ï¼š</strong> æ‰“å¼€<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.lab4ai.cn%2Fhome" target="_blank" title="https://www.lab4ai.cn/home" ref="nofollow noopener noreferrer">Lab4AIå®˜ç½‘</a>ï¼Œæ–°å»ºä¸€ä¸ª VS Code äº‘å®ä¾‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a8434c7ac534356a5b3d4c0e85259c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=9e7XrogfNS7mfeo5FGEc9O%2FjP%2Bs%3D" alt="2.png" loading="lazy"/></p>
</li>
<li>
<p><strong>é€‰æ‹©é•œåƒï¼š</strong> åœ¨æ–°å»ºå®ä¾‹é¡µé¢ï¼Œé€‰æ‹©é€‚åˆçš„é•œåƒå¹¶å®Œæˆåˆ›å»ºã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5d0ec9a3e32b42c2a2167a665e80efd9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=XD%2FLoJOTYIgnFko7EA5JFYd8egE%3D" alt="3.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1823c4078e624aea836abb580e3acc29~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=hEWjRJtYYNb0KQk34nizWi0Uptg%3D" alt="4.png" loading="lazy"/></p>
</li>
<li>
<p><strong>æ£€æŸ¥ç¯å¢ƒï¼š</strong> ç‚¹å‡» VS Code ä¸­çš„ Terminalï¼Œå¯ä»¥çœ‹åˆ°ç³»ç»Ÿå·²é¢„ç½®åä¸ºÂ <code>lf</code>Â çš„ Anaconda è™šæ‹Ÿç¯å¢ƒï¼Œå…¶ä¸­å·²å®‰è£…Â <code>llamafactory</code>Â åº“åŠå…¶ä¾èµ–ï¼ˆåŒ…æ‹¬ vLLMï¼‰ã€‚<br/>
æ‰§è¡ŒÂ <code>pip show vllm</code>Â å¯æŸ¥çœ‹å½“å‰ vLLM ç‰ˆæœ¬ã€‚å¤§å®¶ä¹Ÿå¯ä»¥é€šè¿‡Â <code>pip install vllm==xxx</code>Â å®‰è£…æŒ‡å®šç‰ˆæœ¬ï¼Œä½†é¢„ç½®ç‰ˆæœ¬é€šå¸¸å·²è¶³å¤Ÿæ–°ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b7016163cbf4616b68b598651c7913b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=GoprIr6ei81FYAIBDRda6I6PHdQ%3D" alt="6.png" loading="lazy"/></p>
</li>
<li>
<p><strong>æŸ¥çœ‹æ˜¾å­˜ï¼š</strong> vLLM å¯¹æ˜¾å­˜è¦æ±‚è¾ƒé«˜ã€‚æ‰§è¡ŒÂ <code>nvidia-smi</code>Â å‘½ä»¤æŸ¥çœ‹å½“å‰ GPU èµ„æºã€‚å¦‚å›¾æ‰€ç¤ºï¼Œç¯å¢ƒé…å¤‡äº†ä¸€å— 80G æ˜¾å­˜çš„ H100 æ˜¾å¡ã€‚<br/>
<strong>æ³¨æ„</strong>ï¼šä¸€ä¸ª 32B å‚æ•°æ¨¡å‹çº¦éœ€ 66G æ˜¾å­˜ï¼ŒH100 å•å¡éƒ¨ç½²å¯èƒ½ç´§å¼ ã€‚ä¸ºä¾¿äºæ¼”ç¤ºï¼Œç¬”è€…é€‰ç”¨æ›´è½»é‡çš„Â <code>Qwen3-4B</code>Â æ¨¡å‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2a867871529944edbb69efb34add09eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=4fZYhgeGZIXnbalzGINZnHTahHE%3D" alt="19.png" loading="lazy"/></p>
</li>
<li>
<p><strong>ä¸‹è½½æ¨¡å‹:</strong> è¿è¡Œå¤§æ¨¡å‹ç¬¬ä¸€æ­¥é¦–å…ˆè¦ä¸‹è½½å¤§æ¨¡å‹ï¼Œå¤§å®¶è¿˜è®°å¾— <a href="https://juejin.cn/post/7594728203258347554" target="_blank" title="https://juejin.cn/post/7594728203258347554">å¤§æ¨¡å‹è®­ç»ƒå…¨æµç¨‹å®æˆ˜æŒ‡å—åŸºç¡€ç¯‡ï¼ˆäºŒï¼‰â€”â€”å¤§æ¨¡å‹æ–‡ä»¶ç»“æ„è§£è¯»ä¸åŸç†è§£æ</a> ä¸Šä¸€å°èŠ‚å†…å®¹ä¸­æ•™å¤§å®¶å¦‚ä½•ä»modelscopeå¤„è·å¾—æ¨¡å‹çš„æ–¹æ³•å§ï¼Œè®¿é—® ModelScope å®˜ç½‘ï¼Œæœç´¢Â <code>Qwen3-4B</code>Â æ¨¡å‹ã€‚ç‚¹å‡»ä¸‹è½½ï¼Œé¡µé¢ä¼šæ˜¾ç¤ºä¸‹è½½å‘½ä»¤ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8e605b79d9034fccbfa28c8178a924e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=yfF8jxYROfdreb%2F63UKs9F8nR8M%3D" alt="7.png" loading="lazy"/></p>
</li>
<li>
<p><strong>æ‰§è¡Œä¸‹è½½:</strong> åœ¨ç»ˆç«¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤<code>modelscope download --model Qwen/Qwen3-4B --local_dir ./Qwen3-4B</code>å°†Qwen3-4Bæ¨¡å‹ä¸‹è½½åˆ°å½“å‰ç›®å½•ä¸‹çš„<code>Qwen3-4B</code>æ–‡ä»¶å¤¹ä¸­ã€‚ä¸‹è½½å®Œæˆåæƒ…å†µå¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cf52a154926046fa8604371f0c3dcfc8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=WTdcKxNLjIOGM95Zx58HqIvq2%2FY%3D" alt="8.png" loading="lazy"/></p>
</li>
<li>
<p><strong>å¯åŠ¨ vLLM æœåŠ¡:</strong> æ¨¡å‹å°±ç»ªåï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨å…¼å®¹ OpenAI API æ ¼å¼çš„æ¨ç†æœåŠ¡å™¨ï¼š<code>vllm serve ./Qwen3-4B/ --served-model-name Qwen3-4B --max-model-len 32768 --gpu-memory-utilization 0.9  --port 6666</code> å³å¯å¼€å¯å…¼å®¹OpenAIæ ¼å¼è¯·æ±‚çš„æœåŠ¡å™¨ï¼ŒæœåŠ¡æˆåŠŸå¯åŠ¨åï¼Œç»ˆç«¯ä¼šæ˜¾ç¤ºè¿è¡Œæ—¥å¿—:</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc93963b77554ba3a09eb65a7ed7dbfd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=AtUNomw888pTZKJR%2F3IZH%2F0jS84%3D" alt="9.png" loading="lazy"/></p>
</li>
<li>
<p><strong>æµ‹è¯•è°ƒç”¨:</strong> åœ¨æœåŠ¡å™¨æ ¹ç›®å½•ä¸‹æ–°å»ºÂ <code>test.py</code>Â æ–‡ä»¶ï¼Œå¹¶å†™å…¥ä»¥ä¸‹æµ‹è¯•ä»£ç ï¼ˆå› å¯åŠ¨æ—¶æœªæŒ‡å®š API Keyï¼Œæ­¤å¤„å¯ä»»æ„å¡«å†™ï¼‰ã€‚æ‰§è¡ŒÂ <code>python test.py</code>ï¼ŒæˆåŠŸè¿”å›æ¨¡å‹å“åº”å³è¡¨ç¤ºéƒ¨ç½²æˆåŠŸã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> openai <span class="hljs-keyword">import</span> OpenAI
client = OpenAI(base_url=<span class="hljs-string">"http://localhost:6666/v1"</span>, api_key=<span class="hljs-string">"EMPTY"</span>)
response = client.chat.completions.create(model=<span class="hljs-string">"Qwen3-4B"</span>, messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ å¥½"</span>}])
<span class="hljs-built_in">print</span>(response.choices[<span class="hljs-number">0</span>].message.content)
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f27b5e54fac488dabf514f3559789d7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=cXsD16ZVk1Au7s%2BlwWQkyx3S2YY%3D" alt="12.png" loading="lazy"/></p>
</li>
</ol>
<p>ä»¥ä¸Šå°±æ˜¯ä½¿ç”¨ vLLM æœ¬åœ°éƒ¨ç½²å¤§æ¨¡å‹çš„å®Œæ•´æµç¨‹ã€‚æŒæ¡æœ¬åœ°å¤§æ¨¡å‹æœåŠ¡çš„éƒ¨ç½²èƒ½åŠ›ï¼Œå¯¹äºåç»­çš„æ•°æ®æ²»ç†ã€æ¨¡å‹è®­ç»ƒä¸éƒ¨ç½²éƒ½è‡³å…³é‡è¦ã€‚</p>
<h3 data-id="heading-5">2.3 VLLMå¸¸ç”¨éƒ¨ç½²å‚æ•°è¯¦è§£</h3>
<p>ä¸Šä¸€èŠ‚ä»…å±•ç¤ºäº†éƒ¨åˆ†å‘½ä»¤è¡Œå‚æ•°ï¼Œä¸‹è¡¨åˆ—å‡ºäº†æ›´å¤šç”Ÿäº§ä¸­å¸¸ç”¨çš„å‚æ•°åŠå…¶è¯´æ˜ï¼š</p>























































<table><thead><tr><th>å‚æ•°</th><th>æ¨èå€¼</th><th>ä½œç”¨è¯´æ˜</th></tr></thead><tbody><tr><td><code>--max-model-len</code></td><td><code>32768</code></td><td>è®¾ç½®æ¨¡å‹çš„æœ€å¤§ä¸Šä¸‹æ–‡é•¿åº¦ï¼ŒQwen3æ¨¡å‹æ”¯æŒ32Kä¸Šä¸‹æ–‡ã€‚</td></tr><tr><td><code>--gpu-memory-utilization</code></td><td><code>0.8-0.95</code></td><td>GPUæ˜¾å­˜åˆ©ç”¨ç‡ï¼Œå€¼è¶Šé«˜é¢„ç•™ç©ºé—´è¶Šå°‘ã€‚</td></tr><tr><td><code>--tensor-parallel-size</code></td><td>GPUæ•°é‡</td><td><strong>å¼ é‡å¹¶è¡Œå¤§å°</strong>ï¼Œ<strong>å¿…é¡»ç­‰äºä½¿ç”¨çš„GPUæ•°é‡</strong>ï¼ˆé»˜è®¤å•å¡ä¸º1ï¼‰ï¼Œå¦‚æœä½ ä½¿ç”¨ä¸¤å¼ å¡ï¼Œè¿™é‡Œå°±æ˜¯2ï¼Œæ³¨æ„æ•°ç›®åªèƒ½æ˜¯<code>2^n</code>æ¬¡ã€‚</td></tr><tr><td><code>--max-num-seqs</code></td><td><code>256</code></td><td>åŒæ—¶å¤„ç†çš„æœ€å¤§è¯·æ±‚æ•°ï¼Œå½±å“å¹¶å‘èƒ½åŠ›ã€‚</td></tr><tr><td><code>--enforce-eager</code></td><td>(æ— å€¼)</td><td><strong>åœ¨Ascend NPUä¸Šè¿è¡Œå¯èƒ½éœ€è¦æ·»åŠ æ­¤å‚æ•°</strong>ï¼Œä»¥é¿å…ç¼–è¯‘é”™è¯¯ã€‚</td></tr><tr><td><code>--api-key</code></td><td>å¦‚Â <code>abc123</code></td><td>è®¾ç½®APIå¯†é’¥ï¼Œå¢åŠ åŸºç¡€å®‰å…¨æ€§ã€‚</td></tr><tr><td><code>--enable-function-calling</code></td><td>(æ— å€¼)</td><td><strong>å¯ç”¨å·¥å…·åŠŸèƒ½ï¼ˆä¹‹åç¬”è€…ä¼šè®²è§£ï¼‰</strong></td></tr><tr><td><code>--pipeline-parallel-size</code></td><td>GPUæ•°é‡</td><td>æµæ°´çº¿å¹¶è¡Œå¤§å°ï¼Œæµæ°´çº¿é€šè¿‡å°†æ¨¡å‹å±‚åˆ†å¸ƒåˆ°å¤šä¸ªGPUï¼Œæ¯ä¸ªGPUé¡ºåºå¤„ç†ï¼Œå¯ä¸<code>tensor-parallel-size</code>å‚æ•°åˆç”¨</td></tr><tr><td><code>--enable-expert-parallel</code></td><td>True or False</td><td>é’ˆå¯¹MoEæ¨¡å‹çš„ä¼˜åŒ–ï¼Œä¾‹å¦‚DeepSeek-V3ç­‰æ¨¡å‹ï¼Œå¹³è¡¡ä¸åŒMoEä¸“å®¶è®¡ç®—å¼€é”€</td></tr></tbody></table>
<p>æ ¹æ®ä»¥ä¸Šå‚æ•°ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨ 4 å¼  GPU æ¥æ¨ç†Â <code>Qwen3-32B</code>Â æ¨¡å‹ï¼Œå‘½ä»¤åº”å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-bash" lang="bash">vllm serve \
    --model â€œQwen3-32Bæ¨¡å‹æ‰€å­˜ä½ç½®â€ \
    --tensor-parallel-size 4 \
    --trust-remote-code \
    --gpu-memory-utilization 0.8 \
    --max-num-seqs 32 \
    --max-model-len 8192 \
    --port 8000
</code></pre>
<p>å‚æ•°ç»„åˆæ¸…æ™°æ˜äº†ï¼Œç›¸ä¿¡å¤§å®¶éƒ½å·²ç»å­¦ä¼šå•¦ï¼</p>
<h3 data-id="heading-6">2.4 VLLMä¼˜åŒ–æŠ€å·§</h3>
<p>å…¶å®åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ä¸ºäº†æœ€å¤§é™åº¦çš„å‹æ¦¨ç®—åŠ›ï¼Œè¿˜æœ‰å¾ˆå¤šçš„vllmçš„ä¼˜åŒ–æŠ€å·§ï¼Œç¬”è€…å¸¸ç”¨çš„æŠ€å·§æœ‰å¦‚ä¸‹2ç‚¹ï¼š</p>
<ol>
<li><strong>å¤šå®ä¾‹è´Ÿè½½å‡è¡¡</strong><br/>
å½“æœ‰å¤šä¸ªç›¸åŒæ¨¡å‹åŒæ—¶éƒ¨ç½²æ—¶ï¼ˆä¾‹å¦‚ 8 å¼ å¡ï¼Œæ¯ 2 å¼ éƒ¨ç½²ä¸€ä¸ªÂ <code>Qwen3-32B</code>ï¼Œå…± 4 ä¸ªå®ä¾‹ï¼‰ï¼Œå¯åœ¨å‰ç«¯ä½¿ç”¨Â <strong>Nginx åšè´Ÿè½½å‡è¡¡</strong>ï¼Œå®ç°ååé‡çš„çº¿æ€§å¢é•¿ã€‚ï¼ˆå¦‚æœ‰éœ€è¦ï¼Œç¬”è€…åç»­å¯ä¸“é—¨åˆ†äº«æ­¤æ–¹æ¡ˆã€‚ï¼‰</li>
<li><strong>è¶…å¤§æ¨¡å‹éƒ¨ç½²ç­–ç•¥</strong><br/>
éƒ¨ç½²å‚æ•°é‡æå¤§çš„æ¨¡å‹æ—¶ï¼Œéœ€è¦åˆç†ç»„åˆÂ <strong>TPï¼ˆå¼ é‡å¹¶è¡Œï¼‰</strong> ã€<strong>PPï¼ˆæµæ°´çº¿å¹¶è¡Œï¼‰</strong> Â å’ŒÂ <strong>EPï¼ˆä¸“å®¶å¹¶è¡Œï¼‰</strong> Â ç­–ç•¥ã€‚é€šå¸¸å¯ä»¥é€‚å½“è°ƒå¤§ TP å’Œ PPï¼Œå¹¶å°† EP è®¾ä¸ºÂ <code>True</code>ï¼Œä»¥åœ¨å¤š GPU åŒæ­¥å¼€é”€ä¸æ•´ä½“æ€§èƒ½ä¹‹é—´å–å¾—æœ€ä½³å¹³è¡¡ã€‚</li>
</ol>
<h2 data-id="heading-7">ä¸‰ã€Ollamaå¤§æ¨¡å‹éƒ¨ç½²æ–¹æ¡ˆ</h2>
<h3 data-id="heading-8">3.1 è®¤è¯†Ollama</h3>
<p>VLLM éƒ¨ç½²æ–¹æ¡ˆè™½ç„¶å¼ºå¤§ï¼Œä½†å®ƒä¸»è¦é¢å‘ç”Ÿäº§ç¯å¢ƒï¼Œéœ€è¦ Linux ç³»ç»Ÿå’Œé«˜æ€§èƒ½æ˜¾å¡ã€‚å¦‚æœå¤§å®¶æƒ³åœ¨ä¸ªäººç”µè„‘ä¸Šå¿«é€Ÿä½“éªŒæ¨¡å‹ï¼Œæˆ–è€…åœ¨ Windows ç³»ç»Ÿä¸­è¿›è¡Œæœ¬åœ°è°ƒç”¨ï¼Œæœ‰ä»€ä¹ˆæ›´è½»ä¾¿çš„æ–¹æ¡ˆå‘¢ï¼ŸOllama æ­£æ˜¯ä¸ºæ­¤è€Œç”Ÿã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24e2cdc9b1264615b194683ec18f5b99~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=jUfa0Ygn2kJJOiV3vj%2FKdQ0oRIE%3D" alt="13.png" loading="lazy"/></p>
<p>ollamaæ˜¯åœ¨llama.cppåŸºç¡€ä¸Šå°è£…çš„ç®€åŒ–çš„æœ¬åœ°éƒ¨ç½²å·¥å…·ï¼Œæä¾›äº†ä¸€é”®è¿è¡ŒåŠŸèƒ½ï¼Œéå¸¸é€‚åˆå¤§å®¶éæŠ€æœ¯æ¨¡å‹çš„å¿«é€ŸéªŒè¯ã€‚ä¸vllmç›¸æ¯”ä¸»è¦æœ‰å¦‚ä¸‹ä¸‰ç‚¹ä¼˜åŠ¿ï¼š</p>
<ol>
<li><strong>éƒ¨ç½²æå…¶ç®€å•ï¼Œå¼€ç®±å³ç”¨</strong>ï¼šOllamaæä¾›ä¸€é”®å®‰è£…è„šæœ¬å’Œç®€å•çš„å‘½ä»¤è¡Œæ“ä½œï¼Œä¸‹è½½åå³å¯å¿«é€Ÿè¿è¡Œæ¨¡å‹ï¼Œéå¸¸é€‚åˆä¸ªäººå¿«é€Ÿä½“éªŒã€‚è€ŒvLLmé€šå¸¸éœ€è¦é…ç½®Pythonç¯å¢ƒã€å®‰è£…CUDAä¾èµ–å¹¶è¿›è¡Œæ›´å¤šåˆå§‹åŒ–è®¾ç½®ï¼Œé—¨æ§›ç›¸å¯¹è¾ƒé«˜ã€‚</li>
<li><strong>å¯¹ä¸ªäººç¡¬ä»¶æ›´å‹å¥½ï¼Œèµ„æºè¦æ±‚ä½</strong>ï¼šOllamaä¸“æ³¨äºåœ¨æ¶ˆè´¹çº§ç¡¬ä»¶ï¼ˆåŒ…æ‹¬è‹¹æœèŠ¯ç‰‡ã€æ™®é€šCPUå’Œæ¶ˆè´¹çº§GPUï¼‰ä¸Šè¿è¡Œã€‚å®ƒé€šè¿‡é«˜æ•ˆçš„æ¨¡å‹é‡åŒ–æŠ€æœ¯ï¼Œèƒ½ç”¨æ›´å°‘çš„å†…å­˜æˆ–æ˜¾å­˜è¿è¡Œå¤§æ¨¡å‹ï¼ˆä¸ä¸€å®šéœ€è¦æ˜¾å¡ï¼Œå†…å­˜ä¹Ÿå¯ä»¥ï¼‰ã€‚</li>
<li><strong>å†…ç½®æ¨¡å‹åº“ï¼Œç®¡ç†æ¨¡å‹éå¸¸ä¾¿æ·</strong>ï¼šOllamaå†…ç½®äº†ä¸€ä¸ªåŒ…å«å¤§é‡ä¸»æµå¼€æºé¢„é‡åŒ–æ¨¡å‹çš„â€œåº”ç”¨å•†åº—â€ã€‚å¤§å®¶å¯ä»¥åƒå®‰è£…è½¯ä»¶ä¸€æ ·ï¼Œé€šè¿‡ä¸€æ¡å‘½ä»¤ï¼ˆå¦‚Â <code>ollama pull Qwen3:4b</code>, ç°åœ¨ç”šè‡³ä¸éœ€è¦å‘½ä»¤åœ¨ç•Œé¢ä¹Ÿå¯ä»¥æ“ä½œï¼‰è½»æ¾æ‹‰å–ã€è¿è¡Œå’Œåˆ‡æ¢ä¸åŒæ¨¡å‹ï¼Œæ— éœ€æ‰‹åŠ¨å¤„ç†å¤æ‚çš„æ¨¡å‹è½¬æ¢å’Œä¼˜åŒ–æ­¥éª¤ã€‚</li>
</ol>
<h3 data-id="heading-9">3.2 ollamaéƒ¨ç½²å®æˆ˜æ¼”ç¤º</h3>
<p>ä¸‹é¢ç¬”è€…ä»¥ Windows ç³»ç»Ÿä¸ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•å®‰è£…å’Œä½¿ç”¨ Ollama éƒ¨ç½²å¤§æ¨¡å‹ã€‚ç›®å‰æœ€æ–°ç‰ˆæœ¬çš„ Ollama å·²æä¾›å›¾å½¢ç•Œé¢ï¼Œå¯æ–¹ä¾¿åœ°é…ç½®æ¨¡å‹è·¯å¾„ã€‚è‹¥æƒ³äº†è§£æ›´å¤šç»†èŠ‚æˆ–ä½¿ç”¨æ—§ç‰ˆæœ¬ï¼Œå¯å‚è€ƒç¬”è€…ä¹‹å‰çš„æ–‡ç« ï¼š<a href="https://juejin.cn/post/7470146014363009061" target="_blank" title="https://juejin.cn/post/7470146014363009061">äººå·¥æ™ºèƒ½å¤§æ¨¡å‹å…¥é—¨åˆ†äº«ï¼ˆä¸€ï¼‰â€”â€”åˆ©ç”¨ollamaæ­å»ºæœ¬åœ°å¤§æ¨¡å‹æœåŠ¡ï¼ˆDeepSeek-R1)</a></p>
<ol>
<li>
<p><strong>ä¸‹è½½å®‰è£…åŒ…ï¼š</strong> è®¿é—®Â <a href="https://link.juejin.cn?target=https%3A%2F%2Follama.com%2F" target="_blank" title="https://ollama.com/" ref="nofollow noopener noreferrer">Ollama å®˜ç½‘</a>ï¼Œç‚¹å‡»å³ä¸Šè§’ â€œDownloadâ€ æŒ‰é’®ï¼Œé€‰æ‹© Windows ç³»ç»Ÿå¹¶ä¸‹è½½å®‰è£…åŒ…ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a0eda4c6f0e645a98df63ecb0c7a84a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=wibNnPUUMzKpSS5Nb8g7%2Fa2RXg4%3D" alt="14.png" loading="lazy"/></p>
</li>
<li>
<p><strong>å®‰è£…è½¯ä»¶ï¼š</strong> åŒå‡»ä¸‹è½½å¥½çš„Â <code>.exe</code>Â æ–‡ä»¶ï¼Œç‚¹å‡» â€œInstallâ€ å®Œæˆå®‰è£…ï¼Œé»˜è®¤å®‰è£…è‡³ C ç›˜ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1587217b45bf48d6845c8a760f01ec28~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=TNCPp%2Bb0gteraO7FbI7QIyx5whs%3D" alt="2.jpg" loading="lazy"/></p>
</li>
<li>
<p><strong>ä¿®æ”¹æ¨¡å‹å­˜æ”¾è·¯å¾„ï¼š</strong> å®‰è£…å®Œæˆåï¼Œå»ºè®®å…ˆæ‰“å¼€è½¯ä»¶è®¾ç½®ï¼Œå°†æ¨¡å‹ä¿å­˜ç›®å½•ä¿®æ”¹åˆ°éç³»ç»Ÿç›˜ï¼ˆå¦‚ D ç›˜æˆ– E ç›˜ï¼‰ï¼Œä»¥é¿å…å ç”¨è¿‡å¤šç³»ç»Ÿç©ºé—´ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ba70d6866cce4cdc91251d815117bdf8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=mO37Bj%2ByG5gKjZ4GXDPiy63bgLI%3D" alt="3.jpg" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f35fc63194f4734813b2dca7ef0a15f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=Dr89udfJ4fx7iGZjOWu8wRhhwVY%3D" alt="4.jpg" loading="lazy"/></p>
</li>
<li>
<p><strong>æŸ¥æ‰¾æ¨¡å‹ï¼š</strong> åœ¨Â <a href="https://link.juejin.cn?target=https%3A%2F%2Follama.com%2F" target="_blank" title="https://ollama.com/" ref="nofollow noopener noreferrer">Ollama å®˜ç½‘</a>Â çš„æ¨¡å‹æœç´¢é¡µä¸­ï¼Œæœç´¢Â <code>qwen3</code>:</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/006c6ba028ca4ad799ccff3edb188c44~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=3vOgR%2FAqB9WjTqDUrVtjMekP8F8%3D" alt="15.png" loading="lazy"/></p>
</li>
<li>
<p><strong>ä¸‹è½½å¹¶è¿è¡Œæ¨¡å‹ï¼š</strong> è¿›å…¥ Qwen3 æ¨¡å‹é¡µé¢ï¼Œé¡µé¢ä¼šæ˜¾ç¤ºè¿è¡Œå‘½ä»¤Â <code>ollama run qwen3</code>ï¼ˆé»˜è®¤ä¸‹è½½ 8B ç‰ˆæœ¬ï¼‰ã€‚è‹¥æƒ³ä¸‹è½½ 4B ç‰ˆæœ¬ï¼Œåˆ™æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc62384b1b54407fbee6b2b21f3ceec4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=heIy9xPPanqywBczgYNLv1Jgjmo%3D" alt="16.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3860a97ca5cd41d1960931bc000f42ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=uk5gceFLc8aCDH6nf%2BRth5Xreao%3D" alt="10.jpg" loading="lazy"/></p>
</li>
<li>
<p><strong>åœ¨ Ollama ç•Œé¢ä¸­æµ‹è¯•ï¼š</strong> ä¸‹è½½å®Œæˆåï¼Œå¯ç›´æ¥åœ¨ Ollama è‡ªå¸¦çš„å¯¹è¯ç•Œé¢ä¸­è¾“å…¥é—®é¢˜è¿›è¡Œæµ‹è¯•ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd1d7e4e568f44b2aeda2074fca5db76~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=5RlTDgzNKxEeA2QSPMw%2Fbp6iGRU%3D" alt="6.jpg" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/814eab1cc7cd4732b34f2c0960d93645~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=SqQCD3qYgTdjpd7sg9syoAY95RU%3D" alt="7.jpg" loading="lazy"/></p>
</li>
<li>
<p><strong>é€šè¿‡ OpenAI å…¼å®¹ API è°ƒç”¨ï¼š</strong> Ollama åŒæ ·æä¾›å…¼å®¹ OpenAI æ ¼å¼çš„ API æœåŠ¡ï¼ˆé»˜è®¤ç«¯å£ä¸ºÂ <code>11434</code>ï¼‰ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹ Python ä»£ç è¿›è¡Œè°ƒç”¨ï¼ˆè‹¥æœ¬åœ°æœªå®‰è£…Â <code>openai</code>Â åº“ï¼Œéœ€å…ˆæ‰§è¡ŒÂ <code>pip install openai</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> openai <span class="hljs-keyword">import</span> OpenAI
client = OpenAI(base_url=<span class="hljs-string">"http://localhost:11434/v1"</span>, api_key=<span class="hljs-string">"EMPTY"</span>) <span class="hljs-comment">#api_keyéšä¾¿å¡«</span>
response = client.chat.completions.create(model=<span class="hljs-string">"qwen3:4b"</span>, messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ å¥½"</span>}])
<span class="hljs-built_in">print</span>(response.choices[<span class="hljs-number">0</span>].message.content)
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f6d83a270f2b4aee98e2a5d2da1adc35~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=K%2FxFG7c9H4yyih46S7HKK0hYBZ4%3D" alt="11.jpg" loading="lazy"/></p>
</li>
<li>
<p><strong>äº†è§£æ¨¡å‹å­˜å‚¨ç»“æ„ï¼š</strong> Ollama ä¸‹è½½çš„æ¨¡å‹é»˜è®¤ä¿å­˜åœ¨ä½ è®¾ç½®çš„ç›®å½•ä¸‹ï¼ˆä¾‹å¦‚Â <code>E:\Ollama\models</code>ï¼‰ã€‚ç›®å½•å†…ä¸»è¦åŒ…å«ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼š</p>
<ul>
<li><code>blobs</code>ï¼šå­˜æ”¾æ¨¡å‹å…·ä½“çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆé€šå¸¸ä»¥Â <code>sh</code>Â å¼€å¤´çš„å“ˆå¸Œæ–‡ä»¶å‘½åï¼‰ã€‚</li>
<li><code>manifests</code>ï¼šå­˜æ”¾æ¨¡å‹çš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œç”¨äºå®šä¹‰å“ªäº›æ–‡ä»¶å±äºå“ªä¸ªæ¨¡å‹ã€‚</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ab4694ca92e49b8973dfe0766adfb76~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=iJEvcbFBsSIMiCqcnDnOYoudrb4%3D" alt="8.jpg" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0cbebbcf64234b689e21aad2e6caec51~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=apFu8bzxQtkC2g3M%2FFlSAVpI6Nk%3D" alt="9.jpg" loading="lazy"/></p>
</li>
<li>
<p><strong>æ›´å¤šé…ç½®:</strong> å¦‚éœ€äº†è§£æ›´è¯¦ç»†çš„é…ç½®é€‰é¡¹ï¼ˆå¦‚ä¿®æ”¹ç«¯å£ã€å¯ç”¨ GPU ç­‰ï¼‰ï¼Œå¯å‚è€ƒç¬”è€…ä¹‹å‰çš„æ–‡ç« ï¼š <a href="https://juejin.cn/post/7470146014363009061" target="_blank" title="https://juejin.cn/post/7470146014363009061">äººå·¥æ™ºèƒ½å¤§æ¨¡å‹å…¥é—¨åˆ†äº«ï¼ˆä¸€ï¼‰â€”â€”åˆ©ç”¨ollamaæ­å»ºæœ¬åœ°å¤§æ¨¡å‹æœåŠ¡ï¼ˆDeepSeek-R1)</a>ï¼Œéå¸¸ç®€å•ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†~</p>
</li>
</ol>
<h3 data-id="heading-10">3.3 ollamaä¸é‡åŒ–</h3>
<p>ç»†å¿ƒè§‚å¯Ÿçš„å¤§å®¶ä¼šå‘ç°ï¼šåœ¨ Ollama ä¸­ä¸‹è½½çš„ Qwen3-4B æ¨¡å‹åªæœ‰çº¦ 2.5 GBï¼Œè€Œåœ¨ ModelScope ä¸‹è½½çš„åŸå§‹æ¨¡å‹å´æœ‰ 8.1 GBã€‚Ollama ç”¨äº†ä»€ä¹ˆâ€œé­”æ³•â€è®©æ¨¡å‹å˜å¾—å¦‚æ­¤å°å·§ï¼Ÿè¿™èƒŒåçš„å…³é”®æŠ€æœ¯å°±æ˜¯<strong>æ¨¡å‹é‡åŒ–</strong>ã€‚</p>
<p><a href="https://juejin.cn/post/7594728203258347554" target="_blank" title="https://juejin.cn/post/7594728203258347554">å¤§æ¨¡å‹è®­ç»ƒå…¨æµç¨‹å®æˆ˜æŒ‡å—åŸºç¡€ç¯‡ï¼ˆäºŒï¼‰â€”â€”å¤§æ¨¡å‹æ–‡ä»¶ç»“æ„è§£è¯»ä¸åŸç†è§£æ</a> æ–‡ç« ä¸­å¤§å®¶äº†è§£åˆ°ï¼Œå¤§æ¨¡å‹ä¸»è¦ç”±ç»“æ„å’Œå¤§é‡å‚æ•°æ„æˆï¼Œä¿å­˜è¿™äº›å‚æ•°å ç”¨äº†ç»å¤§éƒ¨åˆ†å­˜å‚¨ç©ºé—´ã€‚</p>
<p>è¿™äº›å‚æ•°çš„å‚¨å­˜å½¢å¼é€šå¸¸éƒ½æ˜¯æµ®ç‚¹æ•°ï¼Œé‡åŒ–å°±æ˜¯æŠŠæµ®ç‚¹æ•°çš„æœ‰æ•ˆæ•°å­—çš„ä½æ•°è¿›è¡Œç¼©å°ï¼Œä¸¾ä¸ªå½¢è±¡çš„ä¾‹å­ï¼Œåœ†å‘¨ç‡å¯ä»¥ç”¨3.1415926535æ¥è¡¨ç¤ºï¼Œç„¶è€Œé»˜è®¤3.14ä¹Ÿå¯ä»¥è¡¨ç¤ºåœ†å‘¨ç‡ï¼Œå­˜å‚¨3.1415926535è¦11ä½æ•°å­—ï¼Œå­˜å‚¨3.14åªéœ€è¦3ä½æ•°å­—ï¼Œå­˜å‚¨ä½æ•°å°‘äº†ï¼Œå­˜å‚¨æ¨¡å‹çš„å¤§å°ä¹Ÿè‡ªç„¶å°äº†ã€‚åœ¨å¤§æ¨¡å‹ä¸Šå°±æ˜¯æŠŠFP16çš„æ ¼å¼é‡åŒ–ä¸ºINT4æ ¼å¼ï¼Œå°†æœ‰æ•ˆä½æ•°ä»16ä½é™åˆ°4ä½ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/06fa6227607f438bb82d2cbf3a17551d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=FIdXYEIO163fSGTgnhMrOd%2F7%2B20%3D" alt="17.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/23e7e016df4c43268683dc06091f5435~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769311165&amp;x-signature=hTFPBkT65Kj%2Br%2F1JfUtTwn7UXK0%3D" alt="18.png" loading="lazy"/></p>
<p>Ollama æ˜¯åŸºäºÂ <code>llama.cpp</code>Â æ„å»ºçš„ï¼Œ<code>llama.cpp</code>Â æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„çº¯ C/C++ å¤§è¯­è¨€æ¨¡å‹æ¨ç†æ¡†æ¶ï¼Œæ”¯æŒåœ¨ CPU æˆ– GPU ä¸Šé«˜æ•ˆè¿è¡Œï¼Œå¹¶èƒ½å¤Ÿå°†åŸå§‹æ¨¡å‹è¿›è¡Œé‡åŒ–ï¼Œæ˜¾è‘—å‡å°‘æ¨¡å‹ä½“ç§¯ã€‚é‡åŒ–åçš„æ¨¡å‹å¯ä»¥æ–¹ä¾¿åœ°å‘å¸ƒå’Œéƒ¨ç½²ï¼Œå› æ­¤ Ollama é»˜è®¤ä½¿ç”¨é‡åŒ–åçš„æ¨¡å‹ã€‚</p>
<p>è¿›ä¸€æ­¥æ¥è¯´ï¼Œ<code>llama.cpp</code>Â åœ¨è½¬æ¢æ¨¡å‹æ—¶é€šå¸¸å°†å…¶ä¿å­˜ä¸ºÂ <strong>GGUF</strong>Â æ ¼å¼ã€‚è¿™æ˜¯ä¸€ç§ç”±Â <code>llama.cpp</code>Â åˆ›å§‹äººè®¾è®¡çš„äºŒè¿›åˆ¶æ ¼å¼ï¼Œé’ˆå¯¹é«˜æ•ˆæ¨ç†è¿›è¡Œäº†ä¼˜åŒ–ã€‚ä¸ Transformer åŸç”Ÿä½¿ç”¨çš„Â <code>*.safetensors</code>Â æ ¼å¼ä¸åŒï¼ŒGGUF æ ¼å¼é€šå¸¸å°†æ‰€æœ‰æ¨¡å‹æ•°æ®æ•´åˆä¸ºå•ä¸€æ–‡ä»¶ã€‚Ollama åŸç”Ÿæ”¯æŒè¯¥æ ¼å¼ï¼Œè¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆåœ¨ Ollama åç«¯æ–‡ä»¶ä¸­ä¼šæœ‰ä¸€ä¸ªä½“ç§¯ç‰¹åˆ«å¤§çš„æ–‡ä»¶â€”â€”å®ƒæœ¬è´¨ä¸Šå°±æ˜¯æ•´ä¸ªé‡åŒ–åçš„æ¨¡å‹ã€‚</p>
<p>ä»¥ä¸Šå°±æ˜¯ç¬”è€…ä»Šå¤©åˆ†äº«çš„å…¨éƒ¨å†…å®¹å•¦ï¼æœ¬æ•™ç¨‹ç¤ºä¾‹ä»£ç å¯ä»¥å…³æ³¨ç¬”è€…åŒåå…¬ä¼—å·ï¼š<strong>å¤§æ¨¡å‹çœŸå¥½ç©</strong>ï¼Œå¹¶ç§ä¿¡<strong>å¤§æ¨¡å‹è®­ç»ƒ</strong>å…è´¹è·å¾—ã€‚</p>
<p>è¦æƒ³å®Œå…¨å­¦æ‡‚è¿˜æ˜¯éœ€è¦äº²æ‰‹å®è·µä¸€ä¸‹ï¼Œå¤§å®¶å¯ä»¥ç…§ç€ç¬”è€…çš„æ•™ç¨‹äº²æ‰‹å®è·µä¸€éã€‚ä¸ºé™ä½å¤§å®¶å­¦ä¹ é—¨æ§›ï¼Œç¬”è€…ä¸å›½å†…ä¸»æµäº‘å¹³å°åˆä½œï¼Œå¤§å®¶å¯ä»¥é€šè¿‡æ‰“å¼€é“¾æ¥: <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.lab4ai.cn%2Fregister%3FagentID%3Duser-XorgKKc56U" target="_blank" title="https://www.lab4ai.cn/register?agentID=user-XorgKKc56U" ref="nofollow noopener noreferrer">www.lab4ai.cn/register?agâ€¦</a> ï¼Œä½“éªŒ<strong>H100 GPU 6.5å°æ—¶</strong>çš„ç®—åŠ›ã€‚æœ¬ç³»åˆ—æ‰€æœ‰å®æˆ˜æ•™ç¨‹å‡å°†åœ¨è¯¥å¹³å°ä¸Šå®Œæˆï¼Œå¸®åŠ©å¤§å®¶ä½æˆæœ¬ä¸Šæ‰‹å®è·µã€‚</p>
<h2 data-id="heading-11">å››ã€æ€»ç»“</h2>
<p>æœ¬æœŸå†…å®¹è¯¦ç»†åˆ†äº«äº†ä¸¤ç§ä¸»æµæœ¬åœ°éƒ¨ç½²æ–¹æ¡ˆï¼šé¢å‘ç”Ÿäº§ç¯å¢ƒã€æ”¯æŒé«˜å¹¶å‘çš„é«˜æ€§èƒ½Â <strong>VLLM</strong>Â éƒ¨ç½²ï¼ˆé€‚åˆLinuxç³»ç»Ÿï¼‰ï¼Œä»¥åŠé¢å‘ä¸ªäººå¿«é€Ÿä½“éªŒã€å¯¹ç¡¬ä»¶è¦æ±‚ä½çš„è½»é‡çº§Â <strong>Ollama</strong>Â éƒ¨ç½²ï¼ˆæ”¯æŒWindowsï¼‰ï¼Œæä¾›äº†ä»ç¯å¢ƒå‡†å¤‡åˆ°ä»£ç è°ƒç”¨çš„å®Œæ•´å®æˆ˜æ­¥éª¤ï¼Œå¹¶è§£é‡Šäº†æ¨¡å‹é‡åŒ–åŸç†ï¼Œæ—¨åœ¨å¸®åŠ©è¯»è€…åœ¨ä¸åŒåœºæ™¯ä¸‹å¿«é€Ÿæ­å»ºè‡ªå·±çš„å¤§æ¨¡å‹æœåŠ¡ã€‚</p>
<p>æœ¬åœ°éƒ¨ç½²çš„å¤§æ¨¡å‹ä½œä¸ºä¸‡èƒ½çš„apiï¼Œ å¯ä»¥ç¼–å†™è°ƒç”¨è„šæœ¬è¿›è¡Œè‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡çš„æ‰¹å¤„ç†ï¼Œå°†æ¥æˆ‘ä»¬æ•°æ®å¤„ç†æµç¨‹ä¸€å®šä¼šç”¨åˆ°ã€‚ä¸‹æœŸåˆ†äº«ç¬”è€…å°†ä¸ºå¤§å®¶è®²è§£å¤§æ¨¡å‹è¯·æ±‚çš„å„ç§æ–¹å¼ï¼Œå¸®åŠ©å¤§å®¶æŒæ¡åˆ©ç”¨å¤§æ¨¡å‹apiå¼€å‘å„ç§å„æ ·åº”ç”¨çš„èƒ½åŠ›ï¼Œå¤§å®¶æ•¬è¯·æœŸå¾…ï¼å¤§å®¶è¯»å®Œæ„Ÿå…´è¶£å¯ä»¥å…³æ³¨ç¬”è€…çš„åŒåå¾®ä¿¡å…¬ä¼—å·ï¼šå¤§æ¨¡å‹çœŸå¥½ç©ï¼Œè·å–æœ¬ç³»åˆ—åˆ†äº«ä»¥åŠå…¶å®ƒç³»åˆ—åˆ†äº«çš„å…¨éƒ¨å†…å®¹ã€‚</p>
<p>å¤§æ¨¡å‹è®­ç»ƒå¯¹è®¡ç®—èµ„æºæœ‰ä¸€å®šè¦æ±‚ï¼Œå°¤å…¶æ˜¯GPUæ˜¾å­˜ã€‚ä¸ºé™ä½å­¦ä¹ é—¨æ§›ï¼Œç¬”è€…ä¸å›½å†…ä¸»æµäº‘å¹³å°åˆä½œï¼Œå¤§å®¶å¯ä»¥é€šè¿‡æ‰“å¼€é“¾æ¥: <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.lab4ai.cn%2Fregister%3FagentID%3Duser-XorgKKc56U" target="_blank" title="https://www.lab4ai.cn/register?agentID=user-XorgKKc56U" ref="nofollow noopener noreferrer">www.lab4ai.cn/register?agâ€¦</a>ï¼Œä½“éªŒ<strong>H100 GPU 6.5å°æ—¶</strong>çš„ç®—åŠ›ã€‚æœ¬ç³»åˆ—æ‰€æœ‰å®æˆ˜æ•™ç¨‹å‡å°†åœ¨è¯¥å¹³å°ä¸Šå®Œæˆï¼Œå¸®åŠ©å¤§å®¶ä½æˆæœ¬ä¸Šæ‰‹å®è·µã€‚</p>
<p>é™¤å¤§æ¨¡å‹è®­ç»ƒå¤–ï¼Œç¬”è€…ä¹Ÿåœ¨åŒæ­¥æ›´æ–°<a href="https://juejin.cn/column/7526240014499495972" title="https://juejin.cn/column/7526240014499495972" target="_blank">ã€Šæ·±å…¥æµ…å‡ºLangChain&amp;LangGraph AI Agent æ™ºèƒ½ä½“å¼€å‘ã€‹</a>å…è´¹ä¸“æ ï¼Œè¦è¯´æ˜è¯¥ä¸“æ é€‚åˆæ‰€æœ‰å¯¹ LangChain æ„Ÿå…´è¶£çš„å­¦ä¹ è€…ï¼Œæ— è®ºä¹‹å‰æ˜¯å¦æ¥è§¦è¿‡ LangChainã€‚è¯¥ä¸“æ åŸºäºç¬”è€…åœ¨å®é™…é¡¹ç›®ä¸­çš„æ·±åº¦ä½¿ç”¨ç»éªŒï¼Œç³»ç»Ÿè®²è§£äº†ä½¿ç”¨LangChain/LangGraphå¦‚ä½•å¼€å‘æ™ºèƒ½ä½“ï¼Œç›®å‰å·²æ›´æ–° 37 è®²ï¼Œå¹¶æŒç»­è¡¥å……å®æˆ˜ä¸æ‹“å±•å†…å®¹ã€‚æ¬¢è¿æ„Ÿå…´è¶£çš„åŒå­¦å…³æ³¨ç¬”è€…çš„æ˜é‡‘è´¦å·ä¸ä¸“æ ï¼Œä¹Ÿå¯å…³æ³¨ç¬”è€…çš„åŒåå¾®ä¿¡å…¬ä¼—å·<strong>å¤§æ¨¡å‹çœŸå¥½ç©</strong>ï¼Œæ¯æœŸåˆ†äº«æ¶‰åŠçš„ä»£ç å‡å¯åœ¨å…¬ä¼—å·ç§ä¿¡: <strong>LangChainæ™ºèƒ½ä½“å¼€å‘</strong>å…è´¹è·å–ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€æ·±åº¦å­¦ä¹ Day10ã€‘å‘Šåˆ«çè°ƒå‚ï¼ä¼˜åŒ–å™¨ä¸å­¦ä¹ ç‡è°ƒåº¦å™¨å®æˆ˜æŒ‡å—]]></title>    <link>https://juejin.cn/post/7596299957277016091</link>    <guid>https://juejin.cn/post/7596299957277016091</guid>    <pubDate>2026-01-17T15:20:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596299957277016091" data-draft-id="7595423767721607177" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€æ·±åº¦å­¦ä¹ Day10ã€‘å‘Šåˆ«çè°ƒå‚ï¼ä¼˜åŒ–å™¨ä¸å­¦ä¹ ç‡è°ƒåº¦å™¨å®æˆ˜æŒ‡å—"/> <meta itemprop="keywords" content="æ·±åº¦å­¦ä¹ "/> <meta itemprop="datePublished" content="2026-01-17T15:20:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æŸ æŸ é…±"/> <meta itemprop="url" content="https://juejin.cn/user/3739876675556569"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€æ·±åº¦å­¦ä¹ Day10ã€‘å‘Šåˆ«çè°ƒå‚ï¼ä¼˜åŒ–å™¨ä¸å­¦ä¹ ç‡è°ƒåº¦å™¨å®æˆ˜æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3739876675556569/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æŸ æŸ é…±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T15:20:48.000Z" title="Sat Jan 17 2026 15:20:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä¸ºä»€ä¹ˆåŒæ ·çš„æ¨¡å‹ï¼Œæ¢ä¸€ä¸ªä¼˜åŒ–å™¨å’Œå­¦ä¹ ç‡è°ƒåº¦å™¨ï¼Œè®­ç»ƒæ•ˆæœå°±å¤©å·®åœ°åˆ«ï¼Ÿä»Šå¤©ä¸ºä½ æ­ç§˜ã€‚</p>
</blockquote>
<p><strong>æ‘˜è¦</strong>ï¼šä¸Šä¸€ç¯‡æˆ‘ä»¬é è¿ç§»å­¦ä¹ â€œæŠ„ä½œä¸šâ€æå®šäº†é«˜å‡†ç¡®ç‡æ¨¡å‹ï¼Œä½†è®­ç»ƒæ—¶ä½ å¤§æ¦‚ç‡ä¼šé‡åˆ°ï¼šLossåƒåè¿‡å±±è½¦éœ‡è¡ä¸æ”¶æ•›ã€è®­ç»ƒåˆ°ä¸€åŠå‡†ç¡®ç‡å¡ä½ä¸åŠ¨ã€æ¢ä¸ªä¼˜åŒ–å™¨ç»“æœå¤©å·®åœ°åˆ«â€¦â€¦ä»Šå¤©ï¼Œæˆ‘å¸¦ä½ å½»åº•ææ‡‚è®­ç»ƒçš„â€œæ ¸å¿ƒå¼•æ“â€ï¼ˆä¼˜åŒ–å™¨ï¼‰å’Œâ€œå…³é”®æ²¹é—¨â€ï¼ˆå­¦ä¹ ç‡ï¼‰ï¼šç”¨ä»£ç å¯è§†åŒ–å¯¹æ¯”SGDã€Adamã€AdamWã€Muonå››å¤§ä¼˜åŒ–å™¨çš„æ”¶æ•›è½¨è¿¹ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ ç”¨StepLRã€CosineAnnealingç­‰è°ƒåº¦å™¨å®ç°â€œè‡ªåŠ¨æ¢æŒ¡â€ï¼Œä»æ­¤å‘Šåˆ«çè°ƒå‚ï¼Œè®©æ¨¡å‹è®­ç»ƒåˆå¿«åˆç¨³ï¼</p>
<p><em>å…³é”®è¯ï¼šPyTorch, ä¼˜åŒ–å™¨, å­¦ä¹ ç‡è°ƒåº¦å™¨, SGD, Adam, AdamW, Muon, CosineAnnealingLR, æ”¶æ•›å¯è§†åŒ–</em></p>
<h2 data-id="heading-0">1. å¼€ç¯‡çµé­‚æ‹·é—®ï¼šä½ æ˜¯ä¸æ˜¯åœ¨â€œçè°ƒå‚â€ï¼Ÿ</h2>
<p>Day9æˆ‘ä»¬ç”¨å¾®è°ƒè®­ç»ƒResNet-18æ—¶ï¼Œæˆ‘ç‰¹æ„æŒ‡å®šäº†<code>SGD+CosineAnnealingLR</code>çš„ç»„åˆï¼Œå½“æ—¶ä½ å¯èƒ½æ²¡å¤šæƒ³â€”â€”ä½†å¦‚æœæŠŠä¼˜åŒ–å™¨æ¢æˆAdamï¼Œå­¦ä¹ ç‡å›ºå®šä¸º0.1ï¼Œä½ ä¼šå‘ç°ï¼šè¦ä¹ˆLossç›´æ¥ç‚¸åˆ°NaNï¼Œè¦ä¹ˆè®­ç»ƒ20ä¸ªEpochå‡†ç¡®ç‡è¿˜æ²¡åˆ°80%ã€‚</p>
<p>è¿™å°±æ˜¯ä¼˜åŒ–å™¨å’Œå­¦ä¹ ç‡çš„â€œå¨åŠ›â€ï¼šå®ƒä»¬å†³å®šäº†æ¨¡å‹â€œå­¦ä¹ çš„æ•ˆç‡â€å’Œâ€œæœ€ç»ˆçš„ä¸Šé™â€ã€‚å¾ˆå¤šæ–°æ‰‹è°ƒå‚å…¨é è’™ï¼š</p>
<ul>
<li>Losséœ‡è¡ï¼Ÿå°±éšä¾¿æŠŠå­¦ä¹ ç‡ç ä¸€åŠï¼›</li>
<li>æ”¶æ•›æ…¢ï¼Ÿå°±ç›²ç›®æ¢æˆAdamï¼›</li>
<li>è¿‡æ‹Ÿåˆï¼Ÿå°±ä¹±åŠ æƒé‡è¡°å‡ï¼›</li>
</ul>
<p>æœ¬è´¨æ˜¯æ²¡ææ‡‚ï¼šä¸åŒä¼˜åŒ–å™¨çš„â€œè„¾æ°”â€ä¸åŒï¼Œå­¦ä¹ ç‡çš„â€œè°ƒèŠ‚é€»è¾‘â€ä¹Ÿä¸åŒã€‚ä»Šå¤©æˆ‘ä»¬ä¸èŠæ¯ç‡¥å…¬å¼ï¼Œç”¨â€œå¼€è½¦â€ç±»æ¯”ææ‡‚ä¸€åˆ‡ï¼š</p>
<ul>
<li><strong>ä¼˜åŒ–å™¨</strong>ï¼šç›¸å½“äºæ±½è½¦çš„â€œå¼•æ“â€â€”â€”SGDæ˜¯â€œæ‰‹åŠ¨æŒ¡å¼•æ“â€ï¼ˆç¨³ä½†éœ€è¦æŠ€å·§ï¼‰ï¼ŒAdamæ˜¯â€œè‡ªåŠ¨æŒ¡å¼•æ“â€ï¼ˆå¿«ä½†å¯èƒ½åˆ¹ä¸ä½ï¼‰ï¼›</li>
<li><strong>å­¦ä¹ ç‡</strong>ï¼šç›¸å½“äºâ€œæ²¹é—¨å¤§å°â€â€”â€”å¤ªå¤§å®¹æ˜“â€œå†²å‡ºè·¯åŸºâ€ï¼ˆLosséœ‡è¡ï¼‰ï¼Œå¤ªå°â€œçˆ¬å¡å¤ªæ…¢â€ï¼ˆæ”¶æ•›æ…¢ï¼‰ï¼›</li>
<li><strong>è°ƒåº¦å™¨</strong>ï¼šç›¸å½“äºâ€œè‡ªåŠ¨æ¢æŒ¡ç³»ç»Ÿâ€â€”â€”æ ¹æ®è®­ç»ƒè¿›åº¦è‡ªåŠ¨è°ƒæ²¹é—¨ï¼Œä¸ç”¨æ‰‹åŠ¨å¹²é¢„ã€‚</li>
</ul>
<h2 data-id="heading-1">2. å››å¤§ä¼˜åŒ–å™¨æ·±åº¦è§£æï¼šè„¾æ°”ã€ç”¨æ³•ã€é¿å‘ç‚¹</h2>
<p>æˆ‘ä»¬èšç„¦å·¥ä¸šç•Œæœ€å¸¸ç”¨çš„å››å¤§ä¼˜åŒ–å™¨ï¼šSGDï¼ˆå«åŠ¨é‡ï¼‰ã€Adamã€AdamWã€Muonï¼Œä»â€œé€šä¿—åŸç†â€â€œä¼˜ç¼ºç‚¹â€â€œé€‚ç”¨åœºæ™¯â€ä¸‰ä¸ªç»´åº¦è®²é€ï¼Œè¿˜é™„MATLABè€é¸Ÿçš„è¸©å‘æ€»ç»“ã€‚</p>
<h3 data-id="heading-2">2.1 SGDï¼ˆéšæœºæ¢¯åº¦ä¸‹é™ï¼‰ï¼šç¨³å¦‚è€ç‹—çš„â€œæ‰‹åŠ¨æŒ¡â€</h3>
<h4 data-id="heading-3">åŸç†é€šä¿—è¯´</h4>
<p>æœ€åŸºç¡€çš„ä¼˜åŒ–å™¨ï¼Œæ ¸å¿ƒé€»è¾‘å°±æ˜¯â€œæœç€Lossä¸‹é™æœ€å¿«çš„æ–¹å‘èµ°ä¸€æ­¥â€ã€‚å°±åƒä½ å¼€è½¦ï¼Œæ¯æ¬¡åªçœ‹çœ¼å‰çš„è·¯ï¼Œæœç€ä¸‹å¡æ–¹å‘å¼€â€”â€”è™½ç„¶æ…¢ï¼Œä½†ä¸ä¼šè·‘åã€‚</p>
<p>ä½†çº¯SGDæœ‰ä¸ªå‘ï¼šå®¹æ˜“å¡åœ¨â€œå±€éƒ¨å°å±±å¡â€ï¼ˆå±€éƒ¨æœ€ä¼˜è§£ï¼‰ã€‚æ‰€ä»¥å®é™…ç”¨çš„éƒ½æ˜¯<code>SGD+åŠ¨é‡ï¼ˆmomentumï¼‰</code>ï¼šç›¸å½“äºå¼€è½¦å¸¦äº†â€œæƒ¯æ€§â€ï¼Œå°±ç®—é‡åˆ°å°åœŸå¡ï¼Œä¹Ÿèƒ½é æƒ¯æ€§å†²è¿‡å»ã€‚</p>
<h4 data-id="heading-4">ä¼˜ç¼ºç‚¹</h4>
<ul>
<li>ä¼˜ç‚¹ï¼šæ”¶æ•›ç¨³å®šã€æ³›åŒ–èƒ½åŠ›å¼ºï¼ˆä¸å®¹æ˜“è¿‡æ‹Ÿåˆï¼‰ã€æ˜¾å­˜å ç”¨æœ€å°ï¼ˆé€‚åˆå¤§æ¨¡å‹ï¼‰ï¼›</li>
<li>ç¼ºç‚¹ï¼šæ”¶æ•›æ…¢ã€éœ€è¦æ‰‹åŠ¨è°ƒå­¦ä¹ ç‡ã€å¯¹åˆå§‹åŒ–æ•æ„Ÿã€‚</li>
</ul>
<h4 data-id="heading-5">é€‚ç”¨åœºæ™¯&amp;è¸©å‘ç‚¹</h4>
<p>âœ… é€‚ç”¨ï¼šæ•°æ®é‡å¤§ï¼ˆå¦‚CIFAR-10ã€ImageNetï¼‰ã€éœ€è¦é«˜æ³›åŒ–ï¼ˆæ¯”å¦‚åˆ†ç±»ä»»åŠ¡ï¼‰ã€å¤§æ¨¡å‹è®­ç»ƒï¼›</p>
<p>âŒ è¸©å‘ï¼šåƒä¸‡åˆ«ç”¨å¤ªå¤§çš„å­¦ä¹ ç‡ï¼ˆæ¯”å¦‚0.1ä»¥ä¸Šï¼‰ï¼Œå°¤å…¶æ˜¯å¾®è°ƒé¢„è®­ç»ƒæ¨¡å‹æ—¶ï¼Œå®¹æ˜“å†²æ‰é¢„è®­ç»ƒæƒé‡ï¼›åŠ¨é‡ä¸€èˆ¬è®¾0.9ï¼ˆé»˜è®¤å€¼å°±å¤Ÿç”¨ï¼‰ã€‚</p>
<h3 data-id="heading-6">2.2 Adamï¼šå¿«åˆ°é£èµ·çš„â€œè‡ªåŠ¨æŒ¡â€</h3>
<h4 data-id="heading-7">åŸç†é€šä¿—è¯´</h4>
<p>Adam=SGD+åŠ¨é‡+è‡ªé€‚åº”å­¦ä¹ ç‡ã€‚ç›¸å½“äºç»™æ±½è½¦è£…äº†â€œæ™ºèƒ½å¯¼èˆª+è‡ªåŠ¨æ²¹é—¨â€ï¼šä¸ä»…èƒ½é æƒ¯æ€§å†²å¡ï¼Œè¿˜èƒ½æ ¹æ®è·¯å†µè‡ªåŠ¨è°ƒæ²¹é—¨å¤§å°â€”â€”åœ¨å¹³å¦è·¯æ®µï¼ˆLosså˜åŒ–å°ï¼‰åŠ å¤§æ²¹é—¨ï¼Œåœ¨é¢ ç°¸è·¯æ®µï¼ˆLossæ³¢åŠ¨å¤§ï¼‰å‡å°æ²¹é—¨ã€‚</p>
<h4 data-id="heading-8">ä¼˜ç¼ºç‚¹</h4>
<ul>
<li>ä¼˜ç‚¹ï¼šæ”¶æ•›é€Ÿåº¦æå¿«ï¼ˆæ¯”SGDå¿«2-3å€ï¼‰ã€å¯¹å­¦ä¹ ç‡ä¸æ•æ„Ÿï¼ˆé»˜è®¤0.001å°±å¤Ÿç”¨ï¼‰ã€é€‚åˆå°æ•°æ®ï¼›</li>
<li>ç¼ºç‚¹ï¼šæ³›åŒ–èƒ½åŠ›ç•¥å·®ï¼ˆå®¹æ˜“è¿‡æ‹Ÿåˆï¼‰ã€æ˜¾å­˜å ç”¨æ¯”SGDé«˜ã€éƒ¨åˆ†ä»»åŠ¡æœ€ç»ˆå‡†ç¡®ç‡ä¸å¦‚SGDã€‚</li>
</ul>
<h4 data-id="heading-9">é€‚ç”¨åœºæ™¯&amp;è¸©å‘ç‚¹</h4>
<p>âœ… é€‚ç”¨ï¼šæ•°æ®é‡å°ï¼ˆå¦‚å‡ ç™¾å¼ å›¾ç‰‡ï¼‰ã€å¿«é€ŸéªŒè¯æ¨¡å‹å¯è¡Œæ€§ã€å¾®è°ƒå°æ¨¡å‹ï¼›</p>
<p>âŒ è¸©å‘ï¼šè®­ç»ƒå¤§æ¨¡å‹æ—¶åˆ«ç”¨Adamï¼æ˜¾å­˜ä¼šæ¯”SGDå¤šå 20%-30%ï¼›é‡åˆ°è¿‡æ‹Ÿåˆæ—¶ï¼Œä¼˜å…ˆåŠ æƒé‡è¡°å‡ï¼Œè€Œä¸æ˜¯ç›²ç›®è°ƒå­¦ä¹ ç‡ã€‚</p>
<h3 data-id="heading-10">2.3 AdamWï¼šAdamçš„â€œä¿®å¤ç‰ˆâ€ï¼Œå·¥ä¸šç•Œé¦–é€‰</h3>
<h4 data-id="heading-11">åŸç†é€šä¿—è¯´</h4>
<p>Adamæœ‰ä¸ªè‡´å‘½ç¼ºé™·ï¼šæƒé‡è¡°å‡ï¼ˆL2æ­£åˆ™ï¼‰æ˜¯â€œåŠ åœ¨æ¢¯åº¦ä¸Šâ€çš„ï¼Œå¯¼è‡´æ­£åˆ™æ•ˆæœæ‰“æŠ˜æ‰£ã€‚AdamWç›´æ¥æŠŠæƒé‡è¡°å‡â€œç‹¬ç«‹å‡ºæ¥â€ï¼Œç›¸å½“äºç»™AdamåŠ äº†ä¸ªâ€œç²¾å‡†åˆ¹è½¦â€â€”â€”æ—¢ä¿ç•™äº†Adamçš„å¿«ï¼Œåˆæœ‰äº†SGDçš„ç¨³ã€‚</p>
<h4 data-id="heading-12">ä¼˜ç¼ºç‚¹</h4>
<ul>
<li>ä¼˜ç‚¹ï¼šå…¼é¡¾Adamçš„å¿«å’ŒSGDçš„ç¨³ã€æ³›åŒ–èƒ½åŠ›å¼ºã€å¯¹å¤šæ•°ä»»åŠ¡éƒ½å‹å¥½ï¼›</li>
<li>ç¼ºç‚¹ï¼šæ˜¾å­˜å ç”¨æ¯”SGDé«˜ï¼ˆå’ŒAdamå·®ä¸å¤šï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-13">é€‚ç”¨åœºæ™¯&amp;è¸©å‘ç‚¹</h4>
<p>âœ… é€‚ç”¨ï¼šç»å¤§å¤šæ•°åœºæ™¯ï¼ˆåˆ†ç±»ã€æ£€æµ‹ã€åˆ†å‰²ï¼‰ã€å°¤å…¶æ˜¯é¢„è®­ç»ƒæ¨¡å‹å¾®è°ƒï¼›</p>
<p>âŒ è¸©å‘ï¼šPyTorché‡ŒAdamWçš„é»˜è®¤å­¦ä¹ ç‡æ˜¯0.001ï¼Œå¾®è°ƒæ—¶å»ºè®®é™åˆ°1e-4ï¼ˆå’ŒSGDåŒç†ï¼Œé¿å…å†²æ‰é¢„è®­ç»ƒæƒé‡ï¼‰ã€‚</p>
<h3 data-id="heading-14">2.4 Muonï¼šå°ä¼—ä½†é«˜æ•ˆçš„â€œæ€§èƒ½çº§å¼•æ“â€</h3>
<h4 data-id="heading-15">åŸç†é€šä¿—è¯´</h4>
<p>Muonæ˜¯è¾ƒæ–°çš„ä¼˜åŒ–å™¨ï¼Œä¸“é—¨é’ˆå¯¹ç¥ç»ç½‘ç»œéšè—å±‚çš„äºŒç»´æƒé‡å‚æ•°è®¾è®¡ï¼Œæ ¸å¿ƒæ˜¯â€œåŠ¨æ€è°ƒæ•´åŠ¨é‡å’Œå­¦ä¹ ç‡â€â€”â€”æ¯”Adamæ›´çµæ´»ï¼Œæ¯”SGDæ›´å¿«ã€‚ç›¸å½“äºç»™æ±½è½¦è£…äº†â€œAIå¯¼èˆªâ€ï¼Œèƒ½æå‰é¢„åˆ¤è·¯å†µï¼Œè°ƒæ•´æ²¹é—¨å’Œæ¡£ä½ã€‚</p>
<h4 data-id="heading-16">ä¼˜ç¼ºç‚¹</h4>
<ul>
<li>ä¼˜ç‚¹ï¼šæ”¶æ•›é€Ÿåº¦æ¯”Adamå¿«ã€æ³›åŒ–èƒ½åŠ›æ¥è¿‘SGDã€å¯¹å¤æ‚ä»»åŠ¡ï¼ˆå¤§æ¨¡å‹è®­ç»ƒï¼‰è¡¨ç°å¥½ï¼›</li>
<li>ç¼ºç‚¹ï¼šéœ€è¦æœ€æ–°ç‰ˆæœ¬çš„pytorchï¼ˆ2.9.0ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-17">é€‚ç”¨åœºæ™¯&amp;è¸©å‘ç‚¹</h4>
<p>âœ… é€‚ç”¨ï¼šå¤æ‚ä»»åŠ¡ï¼ˆåŒ»ç–—å½±åƒã€å·¥ä¸šç¼ºé™·æ£€æµ‹ï¼‰ã€æƒ³è¿½æ±‚æ›´å¿«æ”¶æ•›åˆæ€•è¿‡æ‹Ÿåˆï¼›</p>
<p>âŒ è¸©å‘ï¼šéœ€è¦ç‰ˆæœ¬å·12.6ä»¥ä¸Šçš„<code>cuda</code>ï¼Œåªèƒ½å¤„ç†ç¥ç»ç½‘ç»œçš„äºŒç»´æƒé‡å‚æ•°ã€‚</p>
<h2 data-id="heading-18">3. å­¦ä¹ ç‡è°ƒåº¦å™¨ï¼šè®©æ¨¡å‹â€œè‡ªåŠ¨æ¢æŒ¡â€çš„ç¥å™¨</h2>
<p>å°±ç®—é€‰å¯¹äº†ä¼˜åŒ–å™¨ï¼Œå›ºå®šå­¦ä¹ ç‡ä¹Ÿä¼šé‡åˆ°é—®é¢˜ï¼šå‰æœŸå­¦ä¹ ç‡å¤ªå°ï¼Œæ”¶æ•›æ…¢ï¼›åæœŸå­¦ä¹ ç‡å¤ªå¤§ï¼ŒLosséœ‡è¡ä¸æ”¶æ•›ã€‚è°ƒåº¦å™¨çš„ä½œç”¨å°±æ˜¯â€œåŠ¨æ€è°ƒå­¦ä¹ ç‡â€â€”â€”å‰æœŸåŠ å¤§æ²¹é—¨å†²ï¼ŒåæœŸå‡å°æ²¹é—¨ç¨³ï¼Œä¸ç”¨æ‰‹åŠ¨å¹²é¢„ã€‚</p>
<p>æˆ‘ä»¬é‡ç‚¹è®²3ä¸ªå·¥ä¸šç•Œæœ€å¸¸ç”¨çš„è°ƒåº¦å™¨ï¼Œè¿˜æ˜¯ç”¨â€œå¼€è½¦â€ç±»æ¯”ï¼š</p>
<h3 data-id="heading-19">3.1 StepLRï¼šå›ºå®šèŠ‚å¥â€œé™æ¡£â€</h3>
<h4 data-id="heading-20">åŸç†é€šä¿—è¯´</h4>
<p>æ¯è®­ç»ƒ<code>step_size</code>ä¸ªEpochï¼Œå°±æŠŠå­¦ä¹ ç‡ä¹˜ä»¥<code>gamma</code>ï¼ˆè¡°å‡ç³»æ•°ï¼‰ã€‚æ¯”å¦‚<code>step_size=10, gamma=0.1</code>ï¼šå‰10ä¸ªEpochç”¨åˆå§‹å­¦ä¹ ç‡ï¼Œ11-20ä¸ªEpochç”¨0.1å€å­¦ä¹ ç‡ï¼Œ21-30ä¸ªç”¨0.01å€â€”â€”ç›¸å½“äºå›ºå®šæ¯å¼€10å…¬é‡Œé™ä¸€æ¡£ã€‚</p>
<h4 data-id="heading-21">å…³é”®ä»£ç </h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ¯10ä¸ªEpochå­¦ä¹ ç‡è¡°å‡ä¸ºåŸæ¥çš„0.1</span>
scheduler = optim.lr_scheduler.StepLR(optimizer, step_size=<span class="hljs-number">10</span>, gamma=<span class="hljs-number">0.1</span>)
</code></pre>
<h4 data-id="heading-22">é€‚ç”¨åœºæ™¯</h4>
<p>é€‚åˆè®­ç»ƒèŠ‚å¥æ¸…æ™°çš„ä»»åŠ¡ï¼ˆå¦‚CIFAR-10åˆ†ç±»ï¼‰ï¼Œä¼˜ç‚¹æ˜¯ç®€å•ç²—æš´ã€æ˜“ç†è§£ï¼Œç¼ºç‚¹æ˜¯ä¸å¤Ÿçµæ´»ï¼ˆä¸ç®¡Lossæœ‰æ²¡æœ‰æ”¶æ•›éƒ½é™æ¡£ï¼‰ã€‚</p>
<h3 data-id="heading-23">3.2 CosineAnnealingLRï¼šæ¨¡æ‹Ÿä½™å¼¦æ›²çº¿â€œå¹³æ»‘æ¢æŒ¡â€</h3>
<h4 data-id="heading-24">åŸç†é€šä¿—è¯´</h4>
<p>å­¦ä¹ ç‡éšEpochæŒ‰â€œä½™å¼¦æ›²çº¿â€å˜åŒ–ï¼šå…ˆä»åˆå§‹å€¼æ…¢æ…¢é™åˆ°0ï¼Œå†æ…¢æ…¢å‡å›æ¥ï¼ˆå¯é€‰ï¼‰ã€‚å°±åƒå¼€è½¦æ—¶æ ¹æ®å¡åº¦å¹³æ»‘è°ƒæ•´æ²¹é—¨ï¼Œè€Œä¸æ˜¯çŒ›è¸©æˆ–çŒ›æ¾â€”â€”<a href="https://juejin.cn/post/7595423675459190822" target="_blank" title="https://juejin.cn/post/7595423675459190822">ã€æ·±åº¦å­¦ä¹ Day9ã€‘</a>æˆ‘ä»¬ç”¨çš„å°±æ˜¯è¿™ä¸ªï¼Œèƒ½æœ‰æ•ˆé¿å…åæœŸLosséœ‡è¡ã€‚</p>
<h4 data-id="heading-25">å…³é”®ä»£ç </h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># T_maxï¼šå­¦ä¹ ç‡ä»æœ€å¤§é™åˆ°æœ€å°çš„Epochæ•°ï¼ˆä¸€èˆ¬è®¾ä¸ºæ€»Epochæ•°ï¼‰</span>
scheduler = optim.lr_scheduler.CosineAnnealingLR(optimizer, T_max=<span class="hljs-number">20</span>)
</code></pre>
<h4 data-id="heading-26">é€‚ç”¨åœºæ™¯</h4>
<p>å‡ ä¹æ‰€æœ‰ä»»åŠ¡ï¼ˆå°¤å…¶æ˜¯é¢„è®­ç»ƒæ¨¡å‹å¾®è°ƒï¼‰ï¼Œä¼˜ç‚¹æ˜¯æ”¶æ•›ç¨³å®šã€æœ€ç»ˆå‡†ç¡®ç‡é«˜ï¼Œç¼ºç‚¹æ˜¯éœ€è¦æå‰ç¡®å®šæ€»Epochæ•°ã€‚</p>
<h3 data-id="heading-27">3.3 ReduceLROnPlateauï¼šæ ¹æ®â€œè·¯å†µâ€æ™ºèƒ½æ¢æŒ¡</h3>
<h4 data-id="heading-28">åŸç†é€šä¿—è¯´</h4>
<p>ä¸æŒ‰å›ºå®šEpoché™æ¡£ï¼Œè€Œæ˜¯ç›‘æ§æŸä¸ªæŒ‡æ ‡ï¼ˆå¦‚éªŒè¯é›†å‡†ç¡®ç‡ï¼‰ï¼šå¦‚æœæŒ‡æ ‡è¿ç»­<code>patience</code>ä¸ªEpochæ²¡æå‡ï¼Œå°±è‡ªåŠ¨é™ä½å­¦ä¹ ç‡ã€‚ç›¸å½“äºæ±½è½¦çš„â€œè‡ªé€‚åº”å·¡èˆªâ€ï¼Œæ ¹æ®å®é™…è·¯å†µè°ƒæ•´æ²¹é—¨ï¼Œæœ€æ™ºèƒ½çš„è°ƒåº¦å™¨ã€‚</p>
<h4 data-id="heading-29">å…³é”®ä»£ç </h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç›‘æ§éªŒè¯é›†å‡†ç¡®ç‡ï¼Œè¿ç»­5ä¸ªEpochæ²¡æå‡å°±é™æ¡£ï¼ˆgamma=0.1ï¼‰</span>
scheduler = optim.lr_scheduler.ReduceLROnPlateau(optimizer, mode=<span class="hljs-string">'max'</span>, patience=<span class="hljs-number">5</span>, gamma=<span class="hljs-number">0.1</span>)
</code></pre>
<h4 data-id="heading-30">é€‚ç”¨åœºæ™¯</h4>
<p>é€‚åˆä¸çŸ¥é“æ€»Epochæ•°ã€ä»»åŠ¡å¤æ‚ï¼ˆå¦‚æ£€æµ‹ã€åˆ†å‰²ï¼‰ï¼Œä¼˜ç‚¹æ˜¯æ™ºèƒ½ã€ä¸ç”¨æ‰‹åŠ¨è°ƒEpochï¼Œç¼ºç‚¹æ˜¯éœ€è¦æ¯æ¬¡Epochéƒ½è¯„ä¼°éªŒè¯é›†ï¼ˆå¤šèŠ±ä¸€ç‚¹æ—¶é—´ï¼‰ã€‚</p>
<h2 data-id="heading-31">4. ä»£ç å®æˆ˜ï¼šå¯è§†åŒ–å¯¹æ¯”+è°ƒåº¦å™¨å®æˆ˜</h2>
<p>æˆ‘ä»¬ç”¨<a href="https://juejin.cn/post/7595423675459190822" target="_blank" title="https://juejin.cn/post/7595423675459190822">ã€æ·±åº¦å­¦ä¹ Day9ã€‘</a>çš„â€œé­”æ”¹ResNet-18+CIFAR-10â€ä»»åŠ¡ï¼Œåšä¸¤ä¸ªæ ¸å¿ƒå®æˆ˜ï¼šâ‘  å¯è§†åŒ–å››å¤§ä¼˜åŒ–å™¨çš„æ”¶æ•›è½¨è¿¹ï¼›â‘¡ å¯¹æ¯”ä¸åŒè°ƒåº¦å™¨çš„æ•ˆæœã€‚ä»£ç å¯ç›´æ¥å¤åˆ¶è¿è¡Œã€‚</p>
<h3 data-id="heading-32">4.1 å®æˆ˜1ï¼šå››å¤§ä¼˜åŒ–å™¨æ”¶æ•›è½¨è¿¹å¯è§†åŒ–</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">import</span> torch.nn <span class="hljs-keyword">as</span> nn
<span class="hljs-keyword">import</span> torch.optim <span class="hljs-keyword">as</span> optim
<span class="hljs-keyword">import</span> torchvision
<span class="hljs-keyword">import</span> torchvision.transforms <span class="hljs-keyword">as</span> transforms
<span class="hljs-keyword">from</span> torchvision.models <span class="hljs-keyword">import</span> resnet18, ResNet18_Weights
<span class="hljs-keyword">import</span> time

<span class="hljs-comment"># ========== ç¯å¢ƒé…ç½®+æ•°æ®å‡†å¤‡ ==========</span>
device = torch.device(<span class="hljs-string">"cuda:0"</span> <span class="hljs-keyword">if</span> torch.cuda.is_available() <span class="hljs-keyword">else</span> <span class="hljs-string">"cpu"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ä½¿ç”¨è®¾å¤‡ï¼š<span class="hljs-subst">{device}</span>"</span>)
batch_size = <span class="hljs-number">128</span>
epochs = <span class="hljs-number">20</span>
lr = <span class="hljs-number">0.01</span>  

<span class="hljs-comment"># æ•°æ®é¢„å¤„ç†</span>
transform_train = transforms.Compose([
    transforms.RandomCrop(<span class="hljs-number">32</span>, padding=<span class="hljs-number">4</span>),
    transforms.RandomHorizontalFlip(),
    transforms.ToTensor(),
    transforms.Normalize((<span class="hljs-number">0.4914</span>, <span class="hljs-number">0.4822</span>, <span class="hljs-number">0.4465</span>), (<span class="hljs-number">0.2023</span>, <span class="hljs-number">0.1994</span>, <span class="hljs-number">0.2010</span>)),
])
transform_test = transforms.Compose([
    transforms.ToTensor(),
    transforms.Normalize((<span class="hljs-number">0.4914</span>, <span class="hljs-number">0.4822</span>, <span class="hljs-number">0.4465</span>), (<span class="hljs-number">0.2023</span>, <span class="hljs-number">0.1994</span>, <span class="hljs-number">0.2010</span>)),
])

trainset = torchvision.datasets.CIFAR10(root=<span class="hljs-string">'./data'</span>, train=<span class="hljs-literal">True</span>, download=<span class="hljs-literal">True</span>, transform=transform_train)
trainloader = torch.utils.data.DataLoader(trainset, batch_size=batch_size, shuffle=<span class="hljs-literal">True</span>)
testset = torchvision.datasets.CIFAR10(root=<span class="hljs-string">'./data'</span>, train=<span class="hljs-literal">False</span>, download=<span class="hljs-literal">True</span>, transform=transform_test)
testloader = torch.utils.data.DataLoader(testset, batch_size=<span class="hljs-number">100</span>, shuffle=<span class="hljs-literal">False</span>)

<span class="hljs-comment"># ========== å®šä¹‰é­”æ”¹ResNet-18ï¼ˆå¤ç”¨Day9ä»£ç ï¼‰ ==========</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_modified_resnet18</span>():
    model = resnet18(weights=ResNet18_Weights.DEFAULT)
    model.conv1 = nn.Conv2d(<span class="hljs-number">3</span>, <span class="hljs-number">64</span>, kernel_size=<span class="hljs-number">3</span>, stride=<span class="hljs-number">1</span>, padding=<span class="hljs-number">1</span>, bias=<span class="hljs-literal">False</span>)
    model.maxpool = nn.Identity()
    num_ftrs = model.fc.in_features
    model.fc = nn.Linear(num_ftrs, <span class="hljs-number">10</span>)
    <span class="hljs-keyword">return</span> model.to(device)

<span class="hljs-comment"># ========== æ‹†åˆ†2D/é2Då‚æ•°çš„å‡½æ•°ï¼ˆé€‚é…Muonï¼‰ ==========</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">split_muon_adam_params</span>(<span class="hljs-params">model</span>):
    muon_params = []  <span class="hljs-comment"># 2Då‚æ•°ï¼ˆä»…å…¨è¿æ¥å±‚æƒé‡ï¼‰</span>
    adam_params = []  <span class="hljs-comment"># é2Då‚æ•°ï¼ˆå·ç§¯å±‚/åç½®ï¼‰</span>
    <span class="hljs-keyword">for</span> name, param <span class="hljs-keyword">in</span> model.named_parameters():
        <span class="hljs-keyword">if</span> param.dim() == <span class="hljs-number">2</span>:
            muon_params.append(param)
        <span class="hljs-keyword">else</span>:
            adam_params.append(param)
    <span class="hljs-keyword">return</span> muon_params, adam_params

<span class="hljs-comment"># ========== æµ‹è¯•é›†è¯„ä¼°å‡½æ•° ==========</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">evaluate_test</span>(<span class="hljs-params">model, testloader, device</span>):
    model.<span class="hljs-built_in">eval</span>() 
    correct = <span class="hljs-number">0</span>
    total = <span class="hljs-number">0</span>
    <span class="hljs-keyword">with</span> torch.no_grad():  
        <span class="hljs-keyword">for</span> inputs, labels <span class="hljs-keyword">in</span> testloader:
            inputs, labels = inputs.to(device), labels.to(device)
            outputs = model(inputs)
            _, predicted = outputs.<span class="hljs-built_in">max</span>(<span class="hljs-number">1</span>)
            total += labels.size(<span class="hljs-number">0</span>)
            correct += predicted.eq(labels).<span class="hljs-built_in">sum</span>().item()
    test_acc = <span class="hljs-number">100.</span> * correct / total
    <span class="hljs-keyword">return</span> test_acc

<span class="hljs-comment"># ========== é‡å®šä¹‰è®­ç»ƒå‡½æ•°ï¼ˆæ”¯æŒç»„åˆä¼˜åŒ–å™¨ï¼‰ ==========</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">train_optimizer</span>(<span class="hljs-params">model, optimizer, criterion, trainloader, testloader, epochs, device, optimizer_name, schedulers=<span class="hljs-literal">None</span></span>):
    model.train()
    loss_history = [] 
    train_acc_history = []  
    test_acc_history = []   
    total_time = <span class="hljs-number">0.0</span>   
    max_memory = <span class="hljs-number">0.0</span>  
    <span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(epochs):
        epoch_start = time.time()
        running_loss = <span class="hljs-number">0.0</span>
        correct = <span class="hljs-number">0</span>
        total = <span class="hljs-number">0</span>
        model.train()
        <span class="hljs-keyword">for</span> i, (inputs, labels) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(trainloader):
            inputs, labels = inputs.to(device), labels.to(device)
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(optimizer, <span class="hljs-built_in">list</span>):
                <span class="hljs-keyword">for</span> opt <span class="hljs-keyword">in</span> optimizer:
                    opt.zero_grad()
            <span class="hljs-keyword">else</span>:
                optimizer.zero_grad()
            outputs = model(inputs)
            loss = criterion(outputs, labels)
            loss.backward()
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(optimizer, <span class="hljs-built_in">list</span>):
                <span class="hljs-keyword">for</span> opt <span class="hljs-keyword">in</span> optimizer:
                    opt.step()
            <span class="hljs-keyword">else</span>:
                optimizer.step()
            running_loss += loss.item()
            _, predicted = outputs.<span class="hljs-built_in">max</span>(<span class="hljs-number">1</span>)
            total += labels.size(<span class="hljs-number">0</span>)
            correct += predicted.eq(labels).<span class="hljs-built_in">sum</span>().item()
        epoch_loss = running_loss / <span class="hljs-built_in">len</span>(trainloader)
        train_acc = <span class="hljs-number">100.</span> * correct / total
        <span class="hljs-comment"># è®¡ç®—å½“å‰Epochæµ‹è¯•å‡†ç¡®ç‡</span>
        test_acc = evaluate_test(model, testloader, device)
        epoch_time = time.time() - epoch_start
        loss_history.append(epoch_loss)
        train_acc_history.append(train_acc)
        test_acc_history.append(test_acc)
        total_time += epoch_time

        <span class="hljs-keyword">if</span> schedulers <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(schedulers, <span class="hljs-built_in">list</span>):
                <span class="hljs-keyword">for</span> sch <span class="hljs-keyword">in</span> schedulers:
                    sch.step()
            <span class="hljs-keyword">else</span>:
                schedulers.step()
    <span class="hljs-keyword">return</span> loss_history, train_acc_history, test_acc_history, total_time, max_memory

<span class="hljs-comment"># ========== åˆå§‹åŒ–å››å¤§ä¼˜åŒ–å™¨+è®­ç»ƒ ==========</span>
results = {}
criterion = nn.CrossEntropyLoss()

<span class="hljs-comment"># 1. SGDï¼ˆæ— åŠ¨é‡ï¼‰</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n===== å¼€å§‹è®­ç»ƒï¼šSGDï¼ˆæ— åŠ¨é‡ï¼‰====="</span>)
model_sgd = get_modified_resnet18()
optimizer_sgd = optim.SGD(model_sgd.parameters(), lr=lr)
scheduler_sgd = optim.lr_scheduler.CosineAnnealingLR(optimizer_sgd, T_max=epochs)
loss_sgd, train_acc_sgd, test_acc_sgd, time_sgd, mem_sgd = train_optimizer(
    model_sgd, optimizer_sgd, criterion, trainloader, testloader, epochs, device, <span class="hljs-string">"SGD"</span>, scheduler_sgd
)
results[<span class="hljs-string">"SGD"</span>] = (loss_sgd, train_acc_sgd, test_acc_sgd, time_sgd, mem_sgd)

<span class="hljs-comment"># 2. SGD+momentum</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n===== å¼€å§‹è®­ç»ƒï¼šSGD+momentum====="</span>)
model_sgd_mom = get_modified_resnet18()
optimizer_sgd_mom = optim.SGD(model_sgd_mom.parameters(), lr=lr, momentum=<span class="hljs-number">0.9</span>, weight_decay=<span class="hljs-number">5e-4</span>)
scheduler_sgd_mom = optim.lr_scheduler.CosineAnnealingLR(optimizer_sgd_mom, T_max=epochs)
loss_sgd_mom, train_acc_sgd_mom, test_acc_sgd_mom, time_sgd_mom, mem_sgd_mom = train_optimizer(
    model_sgd_mom, optimizer_sgd_mom, criterion, trainloader, testloader, epochs, device, <span class="hljs-string">"SGD+momentum"</span>, scheduler_sgd_mom
)
results[<span class="hljs-string">"SGD+momentum"</span>] = (loss_sgd_mom, train_acc_sgd_mom, test_acc_sgd_mom, time_sgd_mom, mem_sgd_mom)

<span class="hljs-comment"># 3. AdamWï¼ˆå·¥ä¸šç•Œé¦–é€‰ï¼‰</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n===== å¼€å§‹è®­ç»ƒï¼šAdamW====="</span>)
model_adamw = get_modified_resnet18()
optimizer_adamw = optim.AdamW(model_adamw.parameters(), lr=lr*<span class="hljs-number">0.1</span>) 
scheduler_adamw = optim.lr_scheduler.CosineAnnealingLR(optimizer_adamw, T_max=epochs)
loss_adamw, train_acc_adamw, test_acc_adamw, time_adamw, mem_adamw = train_optimizer(
    model_adamw, optimizer_adamw, criterion, trainloader, testloader, epochs, device, <span class="hljs-string">"AdamW"</span>, scheduler_adamw
)
results[<span class="hljs-string">"AdamW"</span>] = (loss_adamw, train_acc_adamw, test_acc_adamw, time_adamw, mem_adamw)

<span class="hljs-comment"># 4. Muon+Adamï¼ˆæ‹†åˆ†2D/é2Då‚æ•°ï¼‰</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n===== å¼€å§‹è®­ç»ƒï¼šMuon+Adam====="</span>)
model_muon = get_modified_resnet18()
muon_params, adam_params = split_muon_adam_params(model_muon)
optimizer_muon = optim.Muon(muon_params, lr=lr*<span class="hljs-number">0.1</span>)  
optimizer_adam = optim.Adam(adam_params, lr=lr*<span class="hljs-number">0.1</span>)
optimizer_comb = [optimizer_muon, optimizer_adam]
scheduler_muon = optim.lr_scheduler.CosineAnnealingLR(optimizer_muon, T_max=epochs)
scheduler_adam = optim.lr_scheduler.CosineAnnealingLR(optimizer_adam, T_max=epochs)
schedulers_comb = [scheduler_muon, scheduler_adam]
loss_muon, train_acc_muon, test_acc_muon, time_muon, mem_muon = train_optimizer(
    model_muon, optimizer_comb, criterion, trainloader, testloader, epochs, device, <span class="hljs-string">"Muon+Adam"</span>, schedulers_comb
)
results[<span class="hljs-string">"Muon+Adam"</span>] = (loss_muon, train_acc_muon, test_acc_muon, time_muon, mem_muon)
</code></pre>
<h3 data-id="heading-33">4.2 å®æˆ˜2ï¼šè°ƒåº¦å™¨æ•ˆæœå¯¹æ¯”ï¼ˆä»¥SGDä¸ºä¾‹ï¼‰</h3>
<pre><code class="hljs language-scss" lang="scss"># å»¶ç»­ä¸Šé¢çš„ç¯å¢ƒå’Œæ¨¡å‹ï¼Œå¯¹æ¯”<span class="hljs-number">3</span>ç§è°ƒåº¦å™¨
def <span class="hljs-built_in">train_scheduler</span>(model, optimizer, scheduler, criterion, trainloader, testloader, epochs, device, scheduler_name):
    model.<span class="hljs-built_in">train</span>()
    loss_history = []
    acc_history = []
    val_acc_history = []
    total_time = <span class="hljs-number">0.0</span>
    max_memory = <span class="hljs-number">0.0</span>
    for epoch in <span class="hljs-built_in">range</span>(epochs):
        epoch_start = time.<span class="hljs-built_in">time</span>()
        running_loss = <span class="hljs-number">0.0</span>
        correct = <span class="hljs-number">0</span>
        total = <span class="hljs-number">0</span>
        for i, (inputs, labels) in <span class="hljs-built_in">enumerate</span>(trainloader):
            inputs, labels = inputs.<span class="hljs-built_in">to</span>(device), labels.<span class="hljs-built_in">to</span>(device)
            optimizer.<span class="hljs-built_in">zero_grad</span>()
            outputs = <span class="hljs-built_in">model</span>(inputs)
            loss = <span class="hljs-built_in">criterion</span>(outputs, labels)
            loss.<span class="hljs-built_in">backward</span>()
            optimizer.<span class="hljs-built_in">step</span>()
            running_loss += loss.<span class="hljs-built_in">item</span>()
            _, predicted = outputs.<span class="hljs-built_in">max</span>(<span class="hljs-number">1</span>)
            total += labels.<span class="hljs-built_in">size</span>(<span class="hljs-number">0</span>)
            correct += predicted.<span class="hljs-built_in">eq</span>(labels).<span class="hljs-built_in">sum</span>().<span class="hljs-built_in">item</span>()

        val_acc = <span class="hljs-built_in">evaluate</span>(model, testloader, device)
        # æ›´æ–°è°ƒåº¦å™¨ï¼ˆæ³¨æ„ï¼šReduceLROnPlateauéœ€è¦ä¼ éªŒè¯é›†æŒ‡æ ‡ï¼‰
        if <span class="hljs-built_in">isinstance</span>(scheduler, optim.lr_scheduler.ReduceLROnPlateau):
            scheduler.<span class="hljs-built_in">step</span>(val_acc)
        else:
            scheduler.<span class="hljs-built_in">step</span>()
        epoch_loss = running_loss / <span class="hljs-built_in">len</span>(trainloader)
        epoch_acc = <span class="hljs-number">100</span>. * correct / total
        loss_history.<span class="hljs-built_in">append</span>(epoch_loss)
        acc_history.<span class="hljs-built_in">append</span>(epoch_acc)
        val_acc_history.<span class="hljs-built_in">append</span>(val_acc)
        total_time += time.<span class="hljs-built_in">time</span>() - epoch_start

        current_lr = optimizer.param_groups[<span class="hljs-number">0</span>][<span class="hljs-string">'lr'</span>]
        <span class="hljs-built_in">print</span>(f<span class="hljs-string">"ã€{scheduler_name}ã€‘Epoch [{epoch+1}/{epochs}], Loss: {epoch_loss:.3f}, Train Acc: {epoch_acc:.2f}%, Val Acc: {val_acc:.2f}%, LR: {current_lr:.6f}"</span>)
    return loss_history, acc_history, val_acc_history, total_time, max_memory

# å®šä¹‰è¯„ä¼°å‡½æ•°
def <span class="hljs-built_in">evaluate</span>(model, testloader, device):
    model.<span class="hljs-built_in">eval</span>()
    correct = <span class="hljs-number">0</span>
    total = <span class="hljs-number">0</span>
    with torch.<span class="hljs-built_in">no_grad</span>():
        for inputs, labels in testloader:
            inputs, labels = inputs.<span class="hljs-built_in">to</span>(device), labels.<span class="hljs-built_in">to</span>(device)
            outputs = <span class="hljs-built_in">model</span>(inputs)
            _, predicted = outputs.<span class="hljs-built_in">max</span>(<span class="hljs-number">1</span>)
            total += labels.<span class="hljs-built_in">size</span>(<span class="hljs-number">0</span>)
            correct += predicted.<span class="hljs-built_in">eq</span>(labels).<span class="hljs-built_in">sum</span>().<span class="hljs-built_in">item</span>()
    return <span class="hljs-number">100</span>. * correct / total

# ========== åˆå§‹åŒ–<span class="hljs-number">3</span>ç§è°ƒåº¦å™¨+è®­ç»ƒ ==========
scheduler_results = {}
base_optimizer = optim<span class="hljs-selector-class">.SGD</span>(get_modified_resnet18()<span class="hljs-selector-class">.parameters</span>(), lr=lr, momentum=<span class="hljs-number">0.9</span>, weight_decay=<span class="hljs-number">5</span>e-<span class="hljs-number">4</span>)

# <span class="hljs-number">1</span>. æ— è°ƒåº¦å™¨ï¼ˆå›ºå®šå­¦ä¹ ç‡ï¼‰
<span class="hljs-built_in">print</span>("\n===== å¼€å§‹è®­ç»ƒï¼šæ— è°ƒåº¦å™¨ï¼ˆå›ºå®šLRï¼‰=====")
model_no_sched = <span class="hljs-built_in">get_modified_resnet18</span>()
optimizer_no_sched = optim<span class="hljs-selector-class">.SGD</span>(model_no_sched.parameters(), lr=lr, momentum=<span class="hljs-number">0.9</span>, weight_decay=<span class="hljs-number">5</span>e-<span class="hljs-number">4</span>)
loss_no_sched, acc_no_sched, val_no_sched, time_no_sched, mem_no_sched = <span class="hljs-built_in">train_scheduler</span>(
    model_no_sched, optimizer_no_sched, None, criterion, trainloader, testloader, epochs, device, "æ— è°ƒåº¦å™¨"
)
scheduler_results<span class="hljs-selector-attr">[<span class="hljs-string">"æ— è°ƒåº¦å™¨"</span>]</span> = (loss_no_sched, acc_no_sched, val_no_sched, time_no_sched, mem_no_sched)

# <span class="hljs-number">2</span>. StepLR
<span class="hljs-built_in">print</span>("\n===== å¼€å§‹è®­ç»ƒï¼šStepLR=====")
model_step = <span class="hljs-built_in">get_modified_resnet18</span>()
optimizer_step = optim<span class="hljs-selector-class">.SGD</span>(model_step.parameters(), lr=lr, momentum=<span class="hljs-number">0.9</span>, weight_decay=<span class="hljs-number">5</span>e-<span class="hljs-number">4</span>)
scheduler_step = optim<span class="hljs-selector-class">.lr_scheduler</span><span class="hljs-selector-class">.StepLR</span>(optimizer_step, step_size=<span class="hljs-number">10</span>, gamma=<span class="hljs-number">0.1</span>)
loss_step, acc_step, val_step, time_step, mem_step = <span class="hljs-built_in">train_scheduler</span>(
    model_step, optimizer_step, scheduler_step, criterion, trainloader, testloader, epochs, device, "StepLR"
)
scheduler_results<span class="hljs-selector-attr">[<span class="hljs-string">"StepLR"</span>]</span> = (loss_step, acc_step, val_step, time_step, mem_step)

# <span class="hljs-number">3</span>. CosineAnnealingLR
<span class="hljs-built_in">print</span>("\n===== å¼€å§‹è®­ç»ƒï¼šCosineAnnealingLR=====")
model_cosine = <span class="hljs-built_in">get_modified_resnet18</span>()
optimizer_cosine = optim<span class="hljs-selector-class">.SGD</span>(model_cosine.parameters(), lr=<span class="hljs-number">0.001</span>, momentum=<span class="hljs-number">0.9</span>, weight_decay=<span class="hljs-number">5</span>e-<span class="hljs-number">4</span>)
scheduler_cosine = optim<span class="hljs-selector-class">.lr_scheduler</span><span class="hljs-selector-class">.CosineAnnealingLR</span>(optimizer_cosine, T_max=<span class="hljs-number">10</span>)
loss_cosine, acc_cosine, val_cosine, time_cosine, mem_cosine = <span class="hljs-built_in">train_scheduler</span>(
    model_cosine, optimizer_cosine, scheduler_cosine, criterion, trainloader, testloader, epochs, device, "CosineAnnealingLR"
)
scheduler_results<span class="hljs-selector-attr">[<span class="hljs-string">"CosineAnnealingLR"</span>]</span> = (loss_cosine, acc_cosine, val_cosine, time_cosine, mem_cosine)
</code></pre>
<h3 data-id="heading-34">4.3 å®æˆ˜å…³é”®è¯´æ˜ï¼ˆæ–°æ‰‹å¿…çœ‹ï¼‰</h3>
<ol>
<li>å­¦ä¹ ç‡ç»Ÿä¸€ï¼šä¸ºäº†å…¬å¹³å¯¹æ¯”ï¼ŒSGD+momentumç”¨0.01ï¼ŒAdamWå’ŒMuonç”¨0.001ï¼ˆAdamWé»˜è®¤å€¼ï¼‰ï¼Œé¿å…å› å­¦ä¹ ç‡ä¸åŒå¯¼è‡´ç»“æœåå·®ï¼›</li>
<li>è¦ç”¨Muonçš„è¯ï¼Œéœ€è¦å…ˆæ›´æ–°é©±åŠ¨ï¼Œéœ€è¦æœ€æ–°ç‰ˆæœ¬çš„PyTorchã€‚å¦‚æœå®‰è£…å¤±è´¥ï¼Œå¯è·³è¿‡Muonï¼Œé‡ç‚¹å¯¹æ¯”SGDã€SGD+momentumã€AdamWï¼›</li>
</ol>
<h2 data-id="heading-35">5. å®éªŒç»“æœå¯¹æ¯”ä¸ç»“è®ºï¼ˆ2080Tiå®æµ‹ï¼‰</h2>
<h3 data-id="heading-36">5.1 å››å¤§ä¼˜åŒ–å™¨å¯¹æ¯”</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dbdcd76cd5e146c0b79558abf3b88179~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p-g5p-g6YWx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769268048&amp;x-signature=43nOgGkfP70JI2vtkyiqT7yCenE%3D" alt="optimizer_comparison.png" loading="lazy"/></p>



































<table><thead><tr><th>ä¼˜åŒ–å™¨</th><th>Epoch20å‡†ç¡®ç‡</th><th>æ€»è®­ç»ƒæ—¶é—´</th><th>æ ¸å¿ƒç»“è®º</th></tr></thead><tbody><tr><td>SGDï¼ˆæ— åŠ¨é‡ï¼‰</td><td>92.34%</td><td>18åˆ†é’Ÿ</td><td>æ”¶æ•›æ…¢ï¼Œä¸æ¨è</td></tr><tr><td>SGD+momentum</td><td>95.53%</td><td>19åˆ†é’Ÿ</td><td>ç¨³ä¸”çœæ˜¾å­˜ï¼Œåˆ†ç±»ä»»åŠ¡é¦–é€‰</td></tr><tr><td>AdamW</td><td>94.21%</td><td>18åˆ†é’Ÿ</td><td>å¿«ä¸”å‡†ï¼Œå¤æ‚ä»»åŠ¡é¦–é€‰</td></tr><tr><td>Muon+Adam</td><td>94.72%</td><td>18åˆ†é’Ÿ</td><td>å¿«ï¼Œä½†éœ€æ›´æ–°cudaé©±åŠ¨</td></tr></tbody></table>
<h3 data-id="heading-37">5.2 è°ƒåº¦å™¨å¯¹æ¯”</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5f5e779c82748249a97ede0702336e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p-g5p-g6YWx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769268048&amp;x-signature=rjPwvzIqXre%2FkVasKoI%2Byu70W9M%3D" alt="scheduler_comparison.png" loading="lazy"/></p>
<ul>
<li>æ— è°ƒåº¦å™¨ï¼ˆå›ºå®šLRï¼‰ï¼šEpoch10åå‡†ç¡®ç‡å°±å¡ä½ï¼ˆ92%å·¦å³ï¼‰ï¼ŒLosséœ‡è¡ï¼›</li>
<li>StepLRï¼šEpoch10é™æ¡£åå‡†ç¡®ç‡æå‡åˆ°94%ï¼Œä½†åæœŸè¿˜æ˜¯éœ‡è¡ï¼›</li>
<li>CosineAnnealingLRï¼šæœ€ç»ˆå‡†ç¡®ç‡94.2%ï¼ŒLosså…¨ç¨‹å¹³æ»‘ä¸‹é™ï¼Œæ— éœ‡è¡â€”â€”è¿™å°±æ˜¯<a href="https://juejin.cn/post/7595423675459190822" target="_blank" title="https://juejin.cn/post/7595423675459190822">ã€æ·±åº¦å­¦ä¹ Day9ã€‘</a> é€‰å®ƒçš„åŸå› ï¼</li>
</ul>
<h3 data-id="heading-38">5.3 ç»ˆæè°ƒå‚å»ºè®®ï¼ˆMATLABè€é¸Ÿæ€»ç»“ï¼‰</h3>
<p>ä¸ç”¨è®°å¤æ‚å…¬å¼ï¼ŒæŒ‰è¿™ä¸ªä¼˜å…ˆçº§é€‰å°±è¡Œï¼š</p>
<ol>
<li>åˆ†ç±»ä»»åŠ¡ï¼ˆCIFAR-10ã€ImageNetï¼‰ï¼š<code>SGD+momentum+CosineAnnealingLR</code>ï¼ˆç¨³ã€çœæ˜¾å­˜ã€æ³›åŒ–å¥½ï¼‰ï¼›</li>
<li>å¤æ‚ä»»åŠ¡ï¼ˆæ£€æµ‹ã€åˆ†å‰²ã€åŒ»ç–—å½±åƒï¼‰ï¼š<code>AdamW+CosineAnnealingLR</code>ï¼ˆå¿«ã€å‡†ã€å®¹é”™ç‡é«˜ï¼‰ï¼›</li>
<li>å°æ•°æ®/å¿«é€ŸéªŒè¯ï¼š<code>AdamW+æ— è°ƒåº¦å™¨</code>ï¼ˆé»˜è®¤lr=0.001ï¼Œå¼€ç®±å³ç”¨ï¼‰ï¼›</li>
<li>å¤§æ¨¡å‹/æ˜¾å­˜ç´§å¼ ï¼š<code>SGD+momentum+StepLR</code>ï¼ˆæ˜¾å­˜å ç”¨æœ€å°ï¼‰ã€‚</li>
</ol>
<h2 data-id="heading-39">6. é¢è¯•é¿å‘æŒ‡å—ï¼ˆé«˜é¢‘é—®é¢˜+æ ‡å‡†ç­”æ¡ˆï¼‰</h2>
<h3 data-id="heading-40">Q1ï¼šAdamå’ŒSGDè°æ›´å¥½ï¼Ÿä»€ä¹ˆæ—¶å€™ç”¨Adamï¼Œä»€ä¹ˆæ—¶å€™ç”¨SGDï¼Ÿ</h3>
<p>ç­”ï¼šæ²¡æœ‰ç»å¯¹çš„å¥½åï¼Œçœ‹åœºæ™¯ï¼š</p>
<ul>
<li>æ•°æ®é‡å¤§ã€éœ€è¦é«˜æ³›åŒ–ï¼ˆå¦‚åˆ†ç±»ä»»åŠ¡ï¼‰ï¼šç”¨SGDï¼ˆ+momentumï¼‰â€”â€”æ³›åŒ–èƒ½åŠ›å¼ºï¼Œæ˜¾å­˜å ç”¨å°ï¼›</li>
<li>æ•°æ®é‡å°ã€å¤æ‚ä»»åŠ¡ã€å¿«é€ŸéªŒè¯ï¼šç”¨Adam/AdamWâ€”â€”æ”¶æ•›å¿«ï¼Œå¯¹å­¦ä¹ ç‡ä¸æ•æ„Ÿã€‚</li>
</ul>
<h3 data-id="heading-41">Q2ï¼šAdamWå’ŒAdamçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆå·¥ä¸šç•Œç°åœ¨éƒ½ç”¨AdamWï¼Ÿ</h3>
<p>ç­”ï¼šæ ¸å¿ƒåŒºåˆ«æ˜¯â€œæƒé‡è¡°å‡çš„å®ç°æ–¹å¼â€ï¼š</p>
<ul>
<li>Adamï¼šæƒé‡è¡°å‡æ˜¯â€œåŠ åœ¨æ¢¯åº¦ä¸Šâ€çš„ï¼Œç›¸å½“äºâ€œè¡°å‡åå†æ›´æ–°æ¢¯åº¦â€ï¼Œæ­£åˆ™æ•ˆæœæ‰“æŠ˜æ‰£ï¼›</li>
<li>AdamWï¼šæƒé‡è¡°å‡æ˜¯â€œç‹¬ç«‹äºæ¢¯åº¦æ›´æ–°â€çš„ï¼Œç›¸å½“äºâ€œå…ˆæ›´æ–°æ¢¯åº¦ï¼Œå†å•ç‹¬è¡°å‡æƒé‡â€ï¼Œæ­£åˆ™æ•ˆæœæ›´ç²¾å‡†ã€‚</li>
</ul>
<p>å·¥ä¸šç•Œç”¨AdamWæ˜¯å› ä¸ºå®ƒå…¼é¡¾äº†Adamçš„å¿«å’ŒSGDçš„æ³›åŒ–èƒ½åŠ›ï¼Œå°¤å…¶æ˜¯é¢„è®­ç»ƒæ¨¡å‹å¾®è°ƒæ—¶ï¼Œæ•ˆæœæ¯”Adamå¥½å¾ˆå¤šã€‚</p>
<h3 data-id="heading-42">Q3ï¼šå­¦ä¹ ç‡è°ƒåº¦å™¨çš„æ ¸å¿ƒä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿå¸¸ç”¨çš„è°ƒåº¦å™¨æœ‰å“ªäº›ï¼Ÿ</h3>
<p>ç­”ï¼šæ ¸å¿ƒä½œç”¨æ˜¯â€œåŠ¨æ€è°ƒæ•´å­¦ä¹ ç‡â€ï¼Œè§£å†³å›ºå®šå­¦ä¹ ç‡çš„ç—›ç‚¹ï¼šå‰æœŸæ”¶æ•›æ…¢ã€åæœŸéœ‡è¡ä¸æ”¶æ•›ã€‚</p>
<p>å¸¸ç”¨çš„3ç§ï¼šStepLRï¼ˆå›ºå®šèŠ‚å¥é™æ¡£ï¼‰ã€CosineAnnealingLRï¼ˆå¹³æ»‘é™æ¡£ï¼Œé¦–é€‰ï¼‰ã€ReduceLROnPlateauï¼ˆæ ¹æ®éªŒè¯é›†æŒ‡æ ‡æ™ºèƒ½é™æ¡£ï¼‰ã€‚</p>
<h3 data-id="heading-43">Q4ï¼šä¸ºä»€ä¹ˆå¾®è°ƒé¢„è®­ç»ƒæ¨¡å‹æ—¶ï¼Œå­¦ä¹ ç‡è¦è®¾å¾—å¾ˆå°ï¼ˆæ¯”å¦‚1e-4ï¼‰ï¼Ÿ</h3>
<p>ç­”ï¼šé¢„è®­ç»ƒæ¨¡å‹çš„æƒé‡å·²ç»æ˜¯â€œæ¯”è¾ƒä¼˜â€çš„çŠ¶æ€ï¼Œç›¸å½“äºæ¨¡å‹å·²ç»â€œå­¦ä¼šäº†é€šç”¨çŸ¥è¯†â€ã€‚å¦‚æœå­¦ä¹ ç‡å¤ªå¤§ï¼Œä¼šå¿«é€Ÿå†²æ‰è¿™äº›ä¼˜è´¨æƒé‡ï¼Œå¯¼è‡´æ¨¡å‹æ€§èƒ½ä¸‹é™â€”â€”å°±åƒè€å¸æœºå¼€è½¦ï¼Œåœ¨é«˜é€Ÿä¸Šä¸éœ€è¦çŒ›è¸©æ²¹é—¨ï¼Œè½»è½»ç‚¹ä¸€ä¸‹å°±è¡Œã€‚</p>
<h2 data-id="heading-44">ğŸ“Œ ä¸‹æœŸé¢„å‘Š</h2>
<p>æå®šäº†ä¼˜åŒ–å™¨ï¼Œæˆ‘ä»¬çš„æ¨¡å‹è®­ç»ƒå·²ç»å¾ˆä¸“ä¸šäº†ã€‚ ä½†ç›´åˆ°ç°åœ¨ï¼Œæˆ‘ä»¬éƒ½æ˜¯åœ¨åš <strong>â€œç›‘ç£å­¦ä¹ â€</strong> â€”â€” å¿…é¡»è¦æœ‰æ ‡ç­¾ï¼ˆLabelï¼‰æ‰èƒ½è®­ç»ƒã€‚ å¦‚æœæˆ‘æœ‰ä¸€å †å›¾ï¼Œä½†<strong>æ²¡æœ‰æ ‡ç­¾</strong>æ€ä¹ˆåŠï¼Ÿèƒ½ä¸èƒ½è®©ç¥ç»ç½‘ç»œè‡ªå·±å­¦ä¼šâ€œä»€ä¹ˆæ˜¯å›¾â€ï¼Ÿ ä¸‹ä¸€ç¯‡ï¼Œæˆ‘ä»¬å°†è¿›å…¥æ— ç›‘ç£å­¦ä¹ çš„å¥‡å¹»é¢†åŸŸ â€”â€” <strong>è‡ªç¼–ç å™¨ (AutoEncoder, AE) ä¸æ•°æ®é™ç»´</strong>ã€‚ ä½œä¸º MATLAB è€é¸Ÿï¼Œä½ ä¼šå‘ç°è¿™ä¸å°±æ˜¯ç¥ç»ç½‘ç»œç‰ˆçš„ <strong>PCA (ä¸»æˆåˆ†åˆ†æ)</strong> å—ï¼Ÿæˆ‘ä»¬å°†ç”¨å®ƒæ¥åšå›¾åƒå»å™ªå’Œå‹ç¼©ï¼Œéå¸¸å¥½ç©ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Mybatisæ‰§è¡ŒMapperè¿‡ç¨‹è¯¦è§£]]></title>    <link>https://juejin.cn/post/7595894884958191667</link>    <guid>https://juejin.cn/post/7595894884958191667</guid>    <pubDate>2026-01-18T04:01:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595894884958191667" data-draft-id="7596299957277458459" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Mybatisæ‰§è¡ŒMapperè¿‡ç¨‹è¯¦è§£"/> <meta itemprop="keywords" content="Java,æºç é˜…è¯»,MyBatis"/> <meta itemprop="datePublished" content="2026-01-18T04:01:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜ä¾ å®¢è¡Œ"/> <meta itemprop="url" content="https://juejin.cn/user/556801719828361"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Mybatisæ‰§è¡ŒMapperè¿‡ç¨‹è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/556801719828361/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜ä¾ å®¢è¡Œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T04:01:45.000Z" title="Sun Jan 18 2026 04:01:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸Šä¸€ç¯‡ã€Š<a href="https://juejin.cn/post/7589212818808176703" target="_blank" title="https://juejin.cn/post/7589212818808176703">MybatisäºŒçº§ç¼“å­˜å®ç°è¯¦è§£</a>ã€‹ä»‹ç»äº†äºŒçº§ç¼“å­˜çš„å®ç°ç±»å‹ã€åˆ›å»ºå’Œä½¿ç”¨ã€‚ç°åœ¨æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹ï¼ŒMybatisä¸­Mapperæ¥å£æ˜¯å¦‚ä½•è¢«ä»£ç†å¹¶æ‰§è¡ŒSQLè¯­å¥çš„ï¼Ÿ</p>
<blockquote>
<p>æ³¨ï¼šæœ¬æ–‡ä¸­æºç æ¥è‡ªmybatis 3.4.xç‰ˆæœ¬ï¼Œåœ°å€<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmybatis%2Fmybatis-3.git" target="_blank" title="https://github.com/mybatis/mybatis-3.git" ref="nofollow noopener noreferrer">github.com/mybatis/mybâ€¦</a></p>
</blockquote>
<h2 data-id="heading-0">ä¸€ æ³¨å†ŒMapperæ¥å£</h2>
<h3 data-id="heading-1">1.1è§£æMapper</h3>
<h4 data-id="heading-2">XMLæ–¹å¼è§£æ</h4>
<p>åœ¨ä¸»é…ç½®æ–‡ä»¶ (å¦‚mybatis-config.xml)ï¼Œå¯ä»¥åšå¦‚ä¸‹é…ç½®ï¼Œæ¥æŒ‡å®šMapperé›†ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- æ–¹å¼1ï¼šæŒ‡å®šåŒ…åï¼Œæ‰¹é‡æ³¨å†Œ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"com.example.mapper"</span>/&gt;</span>
    
    <span class="hljs-comment">&lt;!-- æ–¹å¼2ï¼šæŒ‡å®šXMLæ–‡ä»¶è·¯å¾„ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">"com/example/mapper/UserMapper.xml"</span>/&gt;</span>
    
    <span class="hljs-comment">&lt;!-- æ–¹å¼3ï¼šæŒ‡å®šURL --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">url</span>=<span class="hljs-string">"file:///var/mappers/UserMapper.xml"</span>/&gt;</span>
    
    <span class="hljs-comment">&lt;!-- æ–¹å¼4ï¼šæŒ‡å®šæ¥å£ç±»å --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.mapper.UserMapper"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span>
</code></pre>
<p>XMLConfigBuilder.mapperElement()ä¼šå¤„ç†è¿™äº›é…ç½®ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a042d7d118b346abad08f66c766b17b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769313705&amp;x-signature=n6VcP4LT5bnHkEQ1hoFNzwg4aUo%3D" alt="" loading="lazy"/>
ç„¶åXMLMapperBuilder#bindMapperForNamespaceï¼Œæ³¨å†ŒMapperæ¥å£åˆ°Configuration</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">bindMapperForNamespace</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// mapper.xmlçš„namespaceå°±æ˜¯æ¥å£çš„å…¨é™å®šå</span>
    <span class="hljs-type">String</span> <span class="hljs-variable">namespace</span> <span class="hljs-operator">=</span> builderAssistant.getCurrentNamespace();
    <span class="hljs-keyword">if</span> (namespace != <span class="hljs-literal">null</span>) {
        Class&lt;?&gt; boundType = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">try</span> {
            boundType = Resources.classForName(namespace);
        } <span class="hljs-keyword">catch</span> (ClassNotFoundException e) {
            <span class="hljs-comment">//ignore, bound type is not required</span>
        }
        <span class="hljs-keyword">if</span> (boundType != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">if</span> (!configuration.hasMapper(boundType)) {               
                configuration.addLoadedResource(<span class="hljs-string">"namespace:"</span> + namespace);
                <span class="hljs-comment">// æ³¨å†Œmapperæ¥å£</span>
                configuration.addMapper(boundType);
            }
        }
    }
}
</code></pre>
<h4 data-id="heading-3">æ³¨è§£æ–¹å¼è§£æ</h4>
<p>MyBatisä¸­æä¾›äº†@Mapperæ³¨è§£ï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½•åœ°æ–¹æ£€æŸ¥æˆ–å¤„ç†è¯¥æ³¨è§£ã€‚@Mapperæ˜¯ä¸ºSpring Bootç­‰æ¡†æ¶æä¾›çš„æ ‡è®°æ³¨è§£ï¼š</p>
<ul>
<li>Spring Bootçš„@MapperScanä¼šæ‰«æ@Mapperæ³¨è§£</li>
<li>MyBatis-Spring-Boot-Starterä¼šå¤„ç†@Mapperæ³¨è§£</li>
</ul>
<p>MyBatisæœ¬èº«åªæä¾›äº†Configuration.addMapper()ç­‰APIä¾›å¤–éƒ¨æ¡†æ¶è°ƒç”¨ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed931f8786dd4dd8ab03c35cfab9ca93~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769313705&amp;x-signature=ebwjLb3Op%2Be8UcHt%2FdZlztfFZVk%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-4">1.2 æ³¨å†ŒMapper</h3>
<p>æ³¨å†ŒMapperï¼Œå…¶å®å°±æ˜¯å°†Mapperçš„Classå¯¹è±¡ã€ä»£ç†å·¥å‚æ·»åŠ åˆ°MapperRegistryçš„knownMappersä¸­ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f8be7b3c419f48c1a9729ed5f20fcaaf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769313705&amp;x-signature=oJlGuqHlor9quZmKsMpACU%2F0h98%3D" alt="" loading="lazy"/></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> &lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">addMapper</span><span class="hljs-params">(Class&lt;T&gt; type)</span> {
    <span class="hljs-comment">//...</span>
    knownMappers.put(type, <span class="hljs-keyword">new</span> <span class="hljs-title class_">MapperProxyFactory</span>&lt;T&gt;(type));
}
</code></pre>
<h3 data-id="heading-5">1.3 è·å–Mapperä»£ç†</h3>
<p>è·å–Mapperæ—¶å…¶å®åˆ›å»ºäº†ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œé€šè¿‡ä»£ç†å°†é™æ€æ¥å£å®šä¹‰ä¸åŠ¨æ€SQLæ‰§è¡Œå®Œç¾ç»“åˆã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// MapperRegistry#getMapper</span>
<span class="hljs-keyword">public</span> &lt;T&gt; T <span class="hljs-title function_">getMapper</span><span class="hljs-params">(Class&lt;T&gt; type, SqlSession sqlSession)</span> {
    <span class="hljs-keyword">final</span> MapperProxyFactory&lt;T&gt; mapperProxyFactory = (MapperProxyFactory&lt;T&gt;) knownMappers.get(type);
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// åˆ›å»ºmapperä»£ç†å¯¹è±¡</span>
        <span class="hljs-keyword">return</span> mapperProxyFactory.newInstance(sqlSession);
    } <span class="hljs-keyword">catch</span> (Exception e) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BindingException</span>(<span class="hljs-string">"Error getting mapper instance. Cause: "</span> + e, e);
    }
}
</code></pre>
<p>MapperProxyå£°æ˜äº†ä»£ç†é€»è¾‘ï¼šè°ƒç”¨æ¥å£æ–¹æ³•è§¦å‘æ‰§è¡ŒSQLè¯­å¥ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åˆ›å»ºä»£ç†å¯¹è±¡MapperProxy</span>
<span class="hljs-keyword">public</span> T <span class="hljs-title function_">newInstance</span><span class="hljs-params">(SqlSession sqlSession)</span> {
<span class="hljs-comment">// MapperProxyå³ä»£ç†é€»è¾‘</span>
<span class="hljs-keyword">final</span> MapperProxy&lt;T&gt; mapperProxy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MapperProxy</span>&lt;T&gt;(sqlSession, mapperInterface, methodCache);
<span class="hljs-keyword">return</span> (T) Proxy.newProxyInstance(mapperInterface.getClassLoader(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[] { mapperInterface }, mapperProxy);
}
</code></pre>
<p>MapperProxyå®ç°äº†InvocationHandlerï¼ˆJDKåŠ¨æ€ä»£ç†ï¼‰ï¼Œä¼šæ‹¦æˆªMapperæ¥å£æ–¹æ³•æ‰§è¡Œï¼š</p>
<ul>
<li>Objectæ–¹æ³• â†’ ç›´æ¥æ‰§è¡Œ</li>
<li>é»˜è®¤æ–¹æ³• â†’ åå°„è°ƒç”¨</li>
<li>ä¸šåŠ¡æ–¹æ³• â†’ åˆ›å»º/è·å–MapperMethodå†æ‰§è¡Œ</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f219a08f83de43339f5801b1207fc0f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769313705&amp;x-signature=u5ESa4K92A63GuiMdUHZS3Pc%2BiU%3D" alt="" loading="lazy"/></p>
<p>MapperMethodä¸­ä¼šæ ¹æ®æ–¹æ³•åå¯¹åº”çš„SQLç±»å‹ï¼Œæ‰§è¡Œä¸åŒçš„æ–¹æ³•ï¼Œå¦‚</p>
<ul>
<li>SELECT â†’ sqlSession.selectList()</li>
<li>INSERT â†’ sqlSession.insert()</li>
<li>UPDATE â†’ sqlSession.update()</li>
<li>DELETE â†’ sqlSession.delete()</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1da034452e3a4c0c894de7ac0752016e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769313705&amp;x-signature=9brl0tsx601%2FcU6tVW2HnbYCoiQ%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-6">äºŒ æ³¨å†ŒMappedStatement</h2>
<h3 data-id="heading-7">2.1 ä»€ä¹ˆæ˜¯MappedStatement</h3>
<p>MappedStatement æ˜¯ MyBatis ä¸­ SQL è¯­å¥çš„å®Œæ•´æè¿°å¯¹è±¡ï¼Œå®ƒå°è£…äº†ä¸€æ¡ SQL è¯­å¥çš„æ‰€æœ‰é…ç½®ä¿¡æ¯å’Œå…ƒæ•°æ®ï¼Œæ˜¯è¿æ¥ Mapper æ¥å£æ–¹æ³•å’Œå®é™… SQL æ‰§è¡Œçš„æ¡¥æ¢ã€‚</p>
<ol>
<li>SQL è¯­å¥çš„å…ƒæ•°æ®å®¹å™¨</li>
</ol>
<ul>
<li>å­˜å‚¨ SQL è¯­å¥çš„ IDï¼ˆé€šå¸¸æ˜¯ namespace.methodNameï¼‰</li>
<li>ä¿å­˜ SqlSourceï¼ˆåŠ¨æ€ SQL æ¥æºï¼‰</li>
<li>è®°å½• SQL å‘½ä»¤ç±»å‹ï¼ˆINSERT/UPDATE/DELETE/SELECTï¼‰</li>
</ul>
<ol start="2">
<li>å‚æ•°å’Œç»“æœæ˜ å°„é…ç½®</li>
</ol>
<ul>
<li>ParameterMapï¼šå‚æ•°æ˜ å°„é…ç½®</li>
<li>ResultMapï¼šç»“æœé›†æ˜ å°„é…ç½®</li>
<li>æ”¯æŒåµŒå¥—ç»“æœæ˜ å°„</li>
</ul>
<ol start="3">
<li>æ‰§è¡Œé…ç½®ä¿¡æ¯</li>
</ol>
<ul>
<li>StatementTypeï¼šè¯­å¥ç±»å‹ï¼ˆPREPARED/SIMPLE/CALLABLEï¼‰</li>
<li>timeoutï¼šè¶…æ—¶æ—¶é—´</li>
<li>fetchSizeï¼šæŠ“å–å¤§å°</li>
<li>KeyGeneratorï¼šä¸»é”®ç”Ÿæˆå™¨</li>
</ul>
<ol start="4">
<li>ç¼“å­˜ç›¸å…³é…ç½®</li>
</ol>
<ul>
<li>Cacheï¼šå…³è”çš„ç¼“å­˜å¯¹è±¡</li>
<li>useCacheï¼šæ˜¯å¦ä½¿ç”¨ç¼“å­˜</li>
<li>flushCacheRequiredï¼šæ˜¯å¦éœ€è¦åˆ·æ–°ç¼“å­˜</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/12ec416d7e4a407688d1949dfd36e1fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769313705&amp;x-signature=7HXga8FjPL11bfSdYRON5lN7Y0w%3D" alt="" loading="lazy"/></p>
<p>å…¶ä¸­çš„å…³é”®æ–¹æ³•æ˜¯getBoundSql(Object parameterObject)ï¼šæ ¹æ®å‚æ•°å¯¹è±¡ç”Ÿæˆ BoundSqlï¼ˆåŒ…å«æœ€ç»ˆå¯æ‰§è¡Œçš„ SQL å’Œå‚æ•°æ˜ å°„ï¼‰ã€‚</p>
<h3 data-id="heading-8">2.2 æ³¨å†ŒMappedStatement</h3>
<p>MappedStatement å¯¹è±¡åœ¨ MyBatis åˆå§‹åŒ–æ—¶åˆ›å»ºï¼Œå­˜å‚¨åœ¨ Configuration çš„ mappedStatements Map ä¸­ï¼Œæ•´ä¸ªåº”ç”¨ç”Ÿå‘½å‘¨æœŸå†…å¤ç”¨ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/77531218ea374e30889515ef938f0098~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769313705&amp;x-signature=C6CzqfDP2SkAQnlf6FzBrulpDiw%3D" alt="" loading="lazy"/></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è§£æMapper.xmlæ–‡ä»¶æ—¶ï¼Œå°†SQLè¯­å¥å°è£…æˆMappedStatement</span>
buildStatementFromContext(context.evalNodes(<span class="hljs-string">"select|insert|update|delete"</span>));
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/32bc72403416431b9eeb70adc08f5516~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769313705&amp;x-signature=B740cTegkfmuuDT7TA6xV3BkXOw%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-9">ä¸‰ Mapperæ–¹æ³•æ‰§è¡Œè¯¦è§£</h2>
<p>ä¾‹å¦‚ä¸‹é¢è¯­å¥ï¼Œåœ¨mybatisåº•å±‚æ˜¯å¦‚ä½•æ‰§è¡Œçš„å‘¢ï¼Ÿ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Mapperæ¥å£</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserMapper</span> {
    User <span class="hljs-title function_">selectById</span><span class="hljs-params">(<span class="hljs-number">1L</span>)</span>;
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">SqlSession</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sqlSessionFactory.openSession();
<span class="hljs-comment">// åˆ›å»ºä»£ç†å¯¹è±¡</span>
<span class="hljs-type">UserMapper</span> <span class="hljs-variable">mapper</span> <span class="hljs-operator">=</span> session.getMapper(UserMapper.class);
<span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> mapper.selectById(<span class="hljs-number">1L</span>);
</code></pre>
<h3 data-id="heading-10">3.1 MapperMethodä»£ç†æ‹¦æˆª</h3>
<p>MapperMethodæœ‰ä¸¤ä¸ªå±æ€§ï¼š</p>
<ol>
<li>SqlCommand commandï¼šä»MappedStatementè·å–æ¥å£æ–¹æ³•å¯¹åº”çš„SQLè¯­å¥å…ƒæ•°æ®
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f2afd01674854d81ac7dc093151cc779~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769313705&amp;x-signature=AoIggoHBu%2BhKBPZJg6vW20WVmdQ%3D" alt="image.png" loading="lazy"/></li>
<li>MethodSignature methodï¼šæä¾›æ¥å£æ–¹æ³•å…ƒæ•°æ®ï¼Œå¦‚è¿”å›å€¼ç±»å‹ã€å‚æ•°è§£æ
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b24b24e8824b41bf81c275804e8cea7a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769313705&amp;x-signature=mE0KUJTQfGJov6POJS0V5n1c7ps%3D" alt="image.png" loading="lazy"/></li>
</ol>
<p>MapperMethodçš„ä»£ç†é€»è¾‘ä¸­ï¼Œå½“æ‰§è¡Œselectæ—¶ï¼Œä¼šæ ¹æ®è¿”å›ç±»å‹è¿›ä¸€æ­¥åˆ†å‘ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ba9450b08e974ff79d653a40dd5d528b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769313705&amp;x-signature=xSB9Dg71ttfix8kyI6NlhROcc34%3D" alt="" loading="lazy"/>
UserMapper#selectByIdæ˜¾ç„¶å¯¹åº”sqlSession.selectOneã€‚</p>
<h3 data-id="heading-11">3.2 SqlSessionæµç¨‹è°ƒåº¦</h3>
<p>DefaultSqlSession#selectOneï¼Œåº•å±‚ä¼šæ‰§è¡ŒselectListï¼Œç„¶åè·å–å”¯ä¸€ä¸€ä¸ªå…ƒç´ ï¼ˆæŸ¥è¯¢åˆ°å¤šä¸ªæ—¶ä¼šæŠ¥é”™ï¼‰
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/11d23fd993f34770b75a4249ec308334~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769313705&amp;x-signature=qxIPEgG%2BPshv%2BffUDFAu%2BK6%2Fkyk%3D" alt="" loading="lazy"/>
ä¹‹å‰å·²åˆ†æè¿‡äºŒçº§ã€ä¸€çº§ç¼“å­˜é€»è¾‘ï¼Œä¸å†èµ˜è¿°ã€‚</p>
<p>æ¥çœ‹æ•°æ®åº“æŸ¥è¯¢ï¼Œä¼šè°ƒç”¨BaseExecutorå­ç±»å®ç°çš„doQuery()ï¼Œåˆ›å»ºStatementHandleræ¥æ‰§è¡ŒSQLã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d0534a94a824beda57e5617fa10e966~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769313705&amp;x-signature=RWiveWD6K7rE0xDr8fBESuq5UJ4%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-12">3.3 StatementHandleræ‰§è¡ŒSQL</h3>
<p>StatementHandler æ˜¯ MyBatis å¯¹ JDBC Statement æ“ä½œçš„ç»Ÿä¸€å°è£…ï¼Œé€šè¿‡ç­–ç•¥æ¨¡å¼æ”¯æŒä¸åŒç±»å‹çš„Statementï¼Œæ˜¯è¿æ¥ Executor å’Œ JDBC çš„å…³é”®æ¡¥æ¢ã€‚</p>
<p>ä¸»è¦èŒè´£åŒ…æ‹¬ï¼š</p>
<ol>
<li>åˆ›å»º Statement å¯¹è±¡</li>
<li>è®¾ç½® SQL å‚æ•°ï¼ˆå§”æ‰˜ç»™ ParameterHandlerï¼‰</li>
<li>æ‰§è¡Œ SQL è¯­å¥</li>
<li>å¤„ç†ç»“æœé›†ï¼ˆå§”æ‰˜ç»™ ResultSetHandlerï¼‰</li>
<li>å¤„ç†ä¸»é”®ç”Ÿæˆï¼ˆå§”æ‰˜ç»™ KeyGeneratorï¼‰</li>
</ol>
<p>è¯¥æ¥å£æœ‰ä»¥ä¸‹å®ç°ï¼š</p>
<ol>
<li>BaseStatementHandlerï¼šæŠ½è±¡åŸºç±»</li>
<li>RoutingStatementHandlerï¼šç­–ç•¥è·¯ç”±ï¼Œæ ¹æ® MappedStatement çš„ StatementType åˆ›å»ºå…·ä½“å®ç°ï¼Œå°†æ–¹æ³•è°ƒç”¨éƒ½å§”æ´¾ç»™å†…éƒ¨çš„ delegate å¯¹è±¡ã€‚</li>
<li>SimpleStatementHandlerï¼š</li>
</ol>
<ul>
<li>å¯¹åº” JDBC çš„ Statement</li>
<li>ä¸æ”¯æŒé¢„ç¼–è¯‘ï¼Œæ¯æ¬¡æ‰§è¡Œéƒ½ç¼–è¯‘ SQL</li>
<li>ä¸æ”¯æŒå‚æ•°å ä½ç¬¦ï¼ˆ?ï¼‰ï¼ŒSQL ç›´æ¥æ‹¼æ¥</li>
</ul>
<ol start="4">
<li>PreparedStatementHandlerï¼ˆæœ€å¸¸ç”¨ï¼‰</li>
</ol>
<ul>
<li>å¯¹åº” JDBC çš„ PreparedStatement</li>
<li>æ”¯æŒé¢„ç¼–è¯‘ï¼ŒSQL å¯å¤ç”¨</li>
<li>æ”¯æŒå‚æ•°å ä½ç¬¦ï¼ˆ?ï¼‰ï¼Œé˜²æ­¢ SQL æ³¨å…¥</li>
<li>é€šè¿‡ ParameterHandler è®¾ç½®å‚æ•°</li>
</ul>
<ol start="5">
<li>CallableStatementHandlerå¯¹åº” JDBC çš„ CallableStatementï¼Œç”¨äºè°ƒç”¨å­˜å‚¨è¿‡ç¨‹ã€‚</li>
</ol>
<p>PreparedStatementHandleråˆ›å»ºPreparedStatementåï¼Œå°±å¯ä»¥å’Œæ•°æ®åº“äº¤äº’äº†ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/345fe2320cb74b659b8ac2bd8363ffd8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769313705&amp;x-signature=styXbwMNkWCS1r0j4DmLOK64%2BRg%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-13">3.4 ResultSetHandlerå¤„ç†ç»“æœé›†</h3>
<p>ResultSetHandler æ˜¯ MyBatis ä¸­è´Ÿè´£å°† JDBC ResultSet æ˜ å°„ä¸º Java å¯¹è±¡çš„æ ¸å¿ƒç»„ä»¶ï¼Œæ˜¯å¯¹ORMåŠŸèƒ½çš„å®ç°ã€‚</p>
<p>ResultSetHandler åªæœ‰ä¸€ä¸ªå®ç°ç±»DefaultResultSetHandler ï¼Œå¤„ç†æ™®é€šæŸ¥è¯¢ç»“æœé›†çš„é€»è¾‘å¦‚ä¸‹ï¼š</p>
<ul>
<li>ResultSetWrapperï¼šå°è£… JDBC ResultSetï¼Œæä¾›å…ƒæ•°æ®è®¿é—®å’Œç±»å‹å¤„ç†ã€‚</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> List&lt;Object&gt; <span class="hljs-title function_">handleResultSets</span><span class="hljs-params">(Statement stmt)</span> <span class="hljs-keyword">throws</span> SQLException {
    <span class="hljs-keyword">final</span> List&lt;Object&gt; multipleResults = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();

    <span class="hljs-comment">// 1. è·å–ç»“æœé›†</span>
    <span class="hljs-type">ResultSetWrapper</span> <span class="hljs-variable">rsw</span> <span class="hljs-operator">=</span> getFirstResultSet(stmt);

    <span class="hljs-comment">// 2. è·å– ResultMap é…ç½®ï¼Œé€šå¸¸åªæœ‰ä¸€ä¸ª</span>
    List&lt;ResultMap&gt; resultMaps = mappedStatement.getResultMaps();

    <span class="hljs-comment">// 3. éå†å¤„ç†æ¯ä¸ªç»“æœé›†</span>
    <span class="hljs-keyword">while</span> (rsw != <span class="hljs-literal">null</span> &amp;&amp; resultMapCount &gt; resultSetCount) {
        <span class="hljs-type">ResultMap</span> <span class="hljs-variable">resultMap</span> <span class="hljs-operator">=</span> resultMaps.get(resultSetCount);
        <span class="hljs-comment">// å¤„ç†ç»“æœé›†</span>
        handleResultSet(rsw, resultMap, multipleResults, <span class="hljs-literal">null</span>);
        rsw = getNextResultSet(stmt);
        resultSetCount++;
    }

    <span class="hljs-keyword">return</span> multipleResults;
}
</code></pre>
<p>åœ¨å¤„ç†ç»“æœé›†æ—¶ï¼Œä¼šä½¿ç”¨åˆ°ResultHandlerå³ç»“æœå¤„ç†å™¨ï¼Œå£°æ˜å¦‚ä½•æ¶ˆè´¹æŸ¥è¯¢åˆ°çš„æ¯æ¡è®°å½•ã€‚DefaultResultHandleræ˜¯ ResultHandlerçš„é»˜è®¤å®ç°ï¼Œç”¨äºæ”¶é›†æŸ¥è¯¢ç»“æœå¹¶å­˜å‚¨åˆ° List é›†åˆä¸­ ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å°†æŸ¥è¯¢ç»“æœæ”¶é›†åˆ° List</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DefaultResultHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ResultHandler</span>&lt;Object&gt; {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;Object&gt; list;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleResult</span><span class="hljs-params">(ResultContext&lt;? extends Object&gt; context)</span> {
        list.add(context.getResultObject());
    }

    <span class="hljs-keyword">public</span> List&lt;Object&gt; <span class="hljs-title function_">getResultList</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> list;
    }
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[çº¿ä¸Šæ•…éšœæ’æŸ¥æ ‡å‡†åŒ–æµç¨‹ï¼šä»å…¨å±€å®šä½åˆ°æ ¹å› åˆ†æ]]></title>    <link>https://juejin.cn/post/7595858760134639679</link>    <guid>https://juejin.cn/post/7595858760134639679</guid>    <pubDate>2026-01-17T15:19:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595858760134639679" data-draft-id="7595858760134623295" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="çº¿ä¸Šæ•…éšœæ’æŸ¥æ ‡å‡†åŒ–æµç¨‹ï¼šä»å…¨å±€å®šä½åˆ°æ ¹å› åˆ†æ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-17T15:19:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é£çš„å½’å®¿55"/> <meta itemprop="url" content="https://juejin.cn/user/2840793779297303"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            çº¿ä¸Šæ•…éšœæ’æŸ¥æ ‡å‡†åŒ–æµç¨‹ï¼šä»å…¨å±€å®šä½åˆ°æ ¹å› åˆ†æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2840793779297303/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é£çš„å½’å®¿55
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T15:19:24.000Z" title="Sat Jan 17 2026 15:19:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">ä»‹ç»</h4>
<p>è¯•æƒ³ä¸€ä¸‹ï¼Œä½ æ˜¯ä¸€ä¸ªåç«¯æœåŠ¡å™¨è´Ÿè´£äººï¼Œåœ¨ä¸€ä¸ªå¤œæ·±äººé™çš„å¤œæ™šï¼Œçªç„¶æŠ¥è­¦çŸ­ä¿¡å“èµ·ï¼Œä½ èµ·æ¥ä¸€çœ‹ï¼Œç›‘æ§ä¸­çš„æŠ¥é”™çœ¼èŠ±ç¼­ä¹±ï¼Œä½ æ˜¯å¦ä¼šæœ‰ç‚¹æ— ä»å…¥æ‰‹ï¼Œä½ æ˜¯å¦ä¼šæƒ³ï¼Œè¦æ˜¯æœ‰ä¸€ä¸ªæµç¨‹ï¼Œåªè¦è·Ÿç€æµç¨‹å°±èƒ½æ’æŸ¥å¹¶è§£å†³å¤§éƒ¨åˆ†é—®é¢˜å°±å¥½äº†ã€‚ è€Œè¿™ç¯‡æ–‡ç« å°±æ˜¯æ ¹æ®ç¬”è€…å®é™…çº¿ä¸Šé—®é¢˜å¤„ç†çš„ç»éªŒæ•´ç†çš„ä¸€ä¸ªæ’æŸ¥é—®é¢˜çš„ä¸€èˆ¬æ€è·¯ï¼Œå¸Œæœ›èƒ½å¯¹ä½ æœ‰æ‰€å¯å‘ï¼Œå¯ä»¥åœ¨å¼‚å¸¸æµ·å•¸ä¸­æŠ½ä¸å‰¥èŒ§çš„æ‰¾åˆ°æ ¹å› ï¼Œæˆ–è€…æœ€å°‘èƒ½æœ‰ä¸ªæ•´ä½“çš„æ–¹å‘ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé—®é¢˜çš„æ’æŸ¥å®Œå…¨ä¾èµ–äºç›‘æ§ï¼Œå› ä¸ºè¿™ç¯‡æ–‡ç« ä¸»è¦è®²è§£æ’æŸ¥é—®é¢˜çš„æ–¹å¼ï¼Œå› æ­¤å¯¹äºæ‰€ä½¿ç”¨çš„ç›‘æ§åªä¼šç®€å•ä»‹ç»ï¼Œéœ€è¦è¯»è€…æ ¹æ®éœ€è¦è‡ªè¡Œå®ç°ã€‚</p>
<h4 data-id="heading-1">ä¸€ã€ç¡®å®šé—®é¢˜æœåŠ¡</h4>
<p>ç¬¬ä¸€æ­¥å…ˆé€šè¿‡ç½‘å…³çš„ç›‘æ§ï¼Œæ¯”å¦‚nginxçš„ç›‘æ§ï¼Œå°è¯•å¿«é€Ÿå®šä½å‡ºé—®é¢˜çš„æœåŠ¡ã€‚è¿™ä¸€æ­¥çš„ä¸»è¦ç›®çš„æ˜¯é€šè¿‡æŸ¥çœ‹ç½‘å…³ç›‘æ§ï¼Œèƒ½å¤Ÿå¯¹ç³»ç»Ÿçš„æ•´ä½“çŠ¶å†µæœ‰æ‰€äº†è§£ï¼Œè¿™æ ·åœ¨åç»­æ’æŸ¥æ—¶å°±èƒ½æœ‰é‡ç‚¹ã€‚å…¶ä¸­æœ€ä¸»è¦çš„å°±æ˜¯é€šè¿‡ç½‘å…³ç›‘æ§å°è¯•å®šä½é—®é¢˜æœåŠ¡ï¼Œå¦‚æœèƒ½å®šä½åˆ°å…·ä½“æœåŠ¡ï¼Œå°±èƒ½ä¸€ä¸‹å­ç¼©å°æ’æŸ¥èŒƒå›´ï¼Œè¦æ˜¯å®šä½ä¸å‡ºæ¥ä¹Ÿæ²¡å…³ç³»ï¼Œå¯ä»¥ç®€å•çš„é€šè¿‡ç½‘å…³äº†è§£ç³»ç»Ÿçš„æ•´ä½“çŠ¶æ€ï¼Œç„¶åå¿«é€Ÿè¿›å…¥ä¸‹ä¸ªæ­¥éª¤è¿›è¡Œæ’æŸ¥ã€‚</p>
<h6 data-id="heading-2">ç½‘å…³ç›‘æ§ä»‹ç»</h6>
<p>ç¬”è€…çš„åç«¯æœåŠ¡å™¨æ˜¯ä½¿ç”¨nginxä½œä¸ºç½‘å…³çš„ï¼Œé€šè¿‡prometheusçš„åº“å¯¼å‡ºäº†ç›‘æ§æ•°æ®åˆ°prometheusä¸­ï¼Œç„¶åç•Œé¢æ˜¯ä½¿ç”¨grafanaå±•ç¤ºçš„ã€‚æœ‰å…´è¶£çš„è¯»è€…å¯ä»¥æŸ¥çœ‹ç¬”è€…ä¹‹å‰çš„æ–‡ç« ï¼Œè®²è§£äº†å¦‚ä½•æ­å»ºè¿™ä¸ªç½‘å…³ç›‘æ§ï¼š<a href="https://juejin.cn/post/7588080521445294126" target="_blank" title="https://juejin.cn/post/7588080521445294126">openrestyç›‘æ§</a>ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç›‘æ§ç¤ºä¾‹å›¾ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/18306ac3ac3b4f8b84e2f3562c0d64f0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO55qE5b2S5a6_NTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769267964&amp;x-signature=9y7FDzuEONn7hj4p45t5fsXM%2F0I%3D" alt="2.png" loading="lazy"/></p>
<p>è¿™ä¸ªç›‘æ§ä¸­åŒ…æ‹¬äº†å¸¸è§çš„ä¸€äº›æŒ‡æ ‡ï¼Œå¦‚qpsï¼Œå»¶è¿Ÿï¼Œ4xxå’Œ5xxçŠ¶æ€ç çš„é”™è¯¯æ•°ã€‚ç„¶ååˆåˆ†ä¸ºä¸Šä¸‹ä¸¤éƒ¨åˆ†ï¼Œä¸ŠåŠéƒ¨åˆ†æ˜¯ç³»ç»Ÿæ•´ä½“çš„æ•°æ®ï¼Œä¸‹åŠéƒ¨åˆ†æ˜¯ä»¥æœåŠ¡ä¸ºç»´åº¦è¿›è¡Œç»Ÿè®¡çš„å„ä¸ªç»´åº¦çš„å¯¹åº”æŒ‡æ ‡ï¼Œå¦‚qpsï¼Œå»¶è¿Ÿå’Œé”™è¯¯ç‡ã€‚ ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„æŒ‡æ ‡æ˜¯upstreamè¿æ¥æ•°ï¼Œä»–æ˜¯nginxä¸­ä½¿ç”¨çš„upstreamè¿›è¡Œåå‘ä»£ç†æ—¶ï¼Œæ¯ä¸ªupstreamçš„è¿æ¥æ•°ã€‚å› ä¸ºæ¯ä¸ªupstreamåŸºæœ¬ä¸Šå¯¹åº”ä¸€ä¸ªæœåŠ¡ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç†è§£ä¸ºåå‘ä»£ç†ä¸­è¿æ¥ä¸Šæ¸¸æœåŠ¡çš„è¿æ¥æ•°ã€‚ <strong>è¿™é‡Œç€é‡å£°æ˜ä¸‹ï¼Œå¼ºçƒˆå»ºè®®åœ¨ä½¿ç”¨nginxæ—¶ä½¿ç”¨upstreamç®¡ç†ä¸Šæ¸¸æœåŠ¡ï¼ŒåŒæ—¶ä¸ºupstreamé…ç½®è¿æ¥æ± ï¼Œè¿™æ ·åœ¨ä¿è¯åå‘ä»£ç†çš„æ€§èƒ½çš„åŒæ—¶ï¼Œä¹Ÿç¡®ä¿äº†ç›‘æ§çš„ç¨³å®šæ€§ï¼Œå› ä¸ºåœ¨æœåŠ¡æ²¡å‡ºé—®é¢˜æ—¶ï¼Œå› ä¸ºè¿æ¥æ± çš„å­˜åœ¨ï¼Œè¿™ä¸ªç›‘æ§ä¸€èˆ¬å˜åŒ–ä¸ä¼šå¾ˆå¤§ã€‚</strong></p>
<h6 data-id="heading-3">æ’æŸ¥æ–¹å¼</h6>
<ol>
<li>æŸ¥çœ‹ç›‘æ§ä¸­çš„upstreamæ´»è·ƒè¿æ¥æ•°ï¼Œä»–æ˜¯nginxåå‘ä»£ç†è¿æ¥ä¸Šæ¸¸æœåŠ¡çš„è¿æ¥æ•°ã€‚å¦‚æœæŸä¸ªæœåŠ¡å‡ºé—®é¢˜äº†ï¼Œæ¯”å¦‚å“åº”æ…¢æˆ–è€…ä¸å¤„ç†è¯·æ±‚ï¼Œé‚£è¿™ä¸ªè¿æ¥æ•°å°±ä¼šé£™å‡ï¼Œé‚£å°±èƒ½ç›´æ¥å®šä½åˆ°å‡ºé—®é¢˜çš„æœåŠ¡äº†ã€‚</li>
<li>æŸ¥çœ‹æœåŠ¡ç»´åº¦çš„å„ä¸ªæ•°æ®ï¼Œç¡®è®¤æ˜¯å¦æœ‰å¼‚å¸¸æŒ‡æ ‡ã€‚æ¯”å¦‚è¦æ˜¯æŸäº›æœåŠ¡çš„å»¶è¿Ÿå‡é«˜ï¼Œé‚£å°±èƒ½åœ¨å»¶è¿ŸæŒ‡æ ‡ä¸­çœ‹åˆ°æœåŠ¡çš„æ›²çº¿é£™å‡ã€‚æˆ–è€…æŸä¸ªæœåŠ¡å‡ºé—®é¢˜æ— æ³•å¤„ç†è¯·æ±‚ï¼Œåˆ™5xxçŠ¶æ€ç çš„ç›‘æ§ä¹Ÿèƒ½å‘ç°å¯¹åº”çš„æœåŠ¡ã€‚ è¿™éƒ¨åˆ†çš„ç›‘æ§ä¹Ÿæ˜¯å®šä½é—®é¢˜æœåŠ¡çš„ä¸€ä¸ªæ–¹å¼ã€‚</li>
</ol>
<h4 data-id="heading-4">äºŒã€æŸ¥çœ‹é—®é¢˜ç›‘æ§å¤§å±</h4>
<p>è¿™ä¸€æ­¥éœ€è¦å…ˆå»ºç«‹ä¸€ä¸ªç›‘æ§å¤§å±ï¼Œè¿™é‡Œé¢ä¸“é—¨æ”¾ä¸€äº›ä¹‹å‰å‡ºç°é¢‘ç‡æ¯”è¾ƒé«˜çš„é—®é¢˜çš„å¯¹åº”æŒ‡æ ‡ï¼Œç›®æ ‡æ˜¯é€šè¿‡æŠŠæ‰€æœ‰å‡ºç°é¢‘ç‡é«˜çš„å¼‚å¸¸æŒ‡æ ‡éƒ½æ”¾åˆ°ä¸€ä¸ªç›‘æ§ä¸­ï¼Œè¿™æ ·å¯ä»¥æœ€å¿«çš„å‘ç°é—®é¢˜ã€‚å¹¶ä¸”å¯ä»¥ä¸ºæ¯ä¸ªæŒ‡æ ‡å†™ä¸€ä¸ªé’ˆå¯¹çš„å¤„ç†é—®é¢˜æ–¹å¼ï¼Œå¹¶å›ºåŒ–åˆ°è¿ç»´æ–‡æ¡£ä¸­ï¼Œè¿™æ ·å³ä½¿æ˜¯å›¢é˜Ÿä¸­çš„ä¸€ä¸ªæ–°åŒäº‹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¿ç»´æ–‡æ¡£å’Œç›‘æ§å¤§å±å¾ˆå®¹æ˜“çš„è§£å†³ä¸€äº›å¸¸è§é—®é¢˜ã€‚</p>
<p>ä¸€ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹æ˜¯ï¼Œè¿™ä¸ªç›‘æ§å¤§å±å°½é‡æ”¾ä¸€äº›å‡ºé—®é¢˜æ—¶å¿…é¡»è§£å†³çš„æŒ‡æ ‡ï¼Œæ¯”å¦‚æœºå™¨çš„cpuä½¿ç”¨ç‡ï¼ŒæœåŠ¡çš„k8sçš„podå®¹å™¨å®ä¾‹çš„cpuä½¿ç”¨ç‡ï¼Œjavaçš„æœ€æ–°å¼‚å¸¸æ•°æ®ç­‰ã€‚å½“è¿™ä¸ªç•Œé¢çš„è¿™äº›æŒ‡æ ‡å‡ºç°é—®é¢˜æ—¶ï¼Œå¯ä»¥ä¸ç”¨ç®¡å‡ºé—®é¢˜çš„åŸå› ï¼Œç›´æ¥å…ˆç€æ‰‹è§£å†³ï¼Œæ¯”å¦‚è¿›è¡Œæœºå™¨ä¸ŠæœåŠ¡çš„è¿å‡ºæ¥é™ä½æœºå™¨cpuï¼ŒæœåŠ¡æ‰©å®¹æ¥é™ä½podçš„cpuç­‰ã€‚è¿™äº›éƒ½æ˜¯èµ„æºé—®é¢˜ï¼Œ<strong>å…ˆè§£å†³æˆ–è€…ç¼“è§£èµ„æºé—®é¢˜ï¼Œç„¶åå†è¿›ä¸€æ­¥è¿›è¡Œé—®é¢˜æ’æŸ¥ï¼Œå› ä¸ºå½“èµ„æºä¸è¶³æ—¶å®¹æ˜“å‡ºç°å¾ˆå¤šå…¶ä»–ç°è±¡ï¼Œæ¯”å¦‚æœåŠ¡çš„æŸä¸ªæ–¹æ³•å»¶è¿Ÿå‡é«˜ã€‚å½“æ—¶è¿™ä¸ªå»¶è¿Ÿå‡é«˜ä¸ä¸€å®šæ˜¯ä»£ç æœ‰é—®é¢˜ï¼Œå¯èƒ½æ˜¯cpuä¸è¶³å¯¼è‡´çš„ï¼Œå¦‚æœå…ˆæ’æŸ¥å»¶è¿Ÿé—®é¢˜ï¼Œå°±å®¹æ˜“è¯¯å…¥æ­§é€”ï¼Œå¯¼è‡´æŸ¥é”™æ–¹å‘ã€‚</strong></p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç›‘æ§å¤§å±çš„ç¤ºä¾‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bf2213ef28414ba59fa73faf59509060~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO55qE5b2S5a6_NTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769267964&amp;x-signature=qjhT4D6Ze3mEBboJlsH51Ow5Mhw%3D" alt="3.jpg" loading="lazy"/></p>
<h6 data-id="heading-5">ç½‘å…³ç›‘æ§ä»‹ç»</h6>
<p>è¿™ä¸ªç›‘æ§å¤§å±åŒ…æ‹¬äº†ä¸€äº›å¸¸è§çš„å®¹æ˜“å‡ºé—®é¢˜çš„ç›‘æ§ï¼Œå½“å‘ç°å¯¹åº”æŒ‡æ ‡æœ‰é—®é¢˜æ—¶ï¼Œä¼˜å…ˆæ ¹æ®å¯¹åº”çš„æ–¹å¼è¿›è¡Œå¤„ç†ï¼Œæ¥è§£å†³æˆ–è€…ç¼“è§£é—®é¢˜ã€‚</p>
<ol>
<li>ç¬¬ä¸€ä¸ªæœåŠ¡å™¨èµ„æºæ€»è§ˆè¡¨æ—¶æœºå™¨å®ä¾‹çš„ç›‘æ§ä¿¡æ¯ï¼Œä¸€èˆ¬é€šè¿‡node-exporterå¯¼å‡ºï¼Œæä¾›äº†ä¸€äº›æœºå™¨çš„ç›‘æ§æ•°æ®ï¼Œå…¶ä¸­é‡ç‚¹ç›‘æ§çš„æ˜¯æœºå™¨çš„cpuä¿¡æ¯ã€‚</li>
<li>CPU Quotaæ˜¯k8sä¸­podçš„cpuç›¸å…³æŒ‡æ ‡ï¼Œé€šè¿‡prometheusä¸­k8sç›¸å…³ç›‘æ§å¯ä»¥é€šè¿‡kube-state-metricsç»„ä»¶å¯¼å‡ºï¼Œå…¶ä¸­éœ€è¦é‡ç‚¹å…³æ³¨çš„æ˜¯CPU Throttlingè¿™ä¸€é¡¹ï¼Œè¿™ä¸ªä»£è¡¨çš„æ˜¯podå› ä¸ºcpuè¶…å‡ºé…ç½®çš„limitå¯¼è‡´è¢«å®¹å™¨é™åˆ¶cpuçš„æŒ‡æ ‡ï¼Œå¦‚æœè¶…è¿‡ä¸€å®šé˜ˆå€¼ï¼Œæ¯”å¦‚25%ï¼Œä»£è¡¨podçš„cpuä¸å¤Ÿç”¨äº†ï¼Œéœ€è¦æé«˜podçš„cpu limitæˆ–è€…å¢åŠ æœåŠ¡å®ä¾‹ã€‚</li>
<li>JavaExceptionTableå’ŒNginxErrorTableï¼Œè¿™ä¸¤ä¸ªjavaæœåŠ¡å’Œnginxä¸­æœ€è¿‘5åˆ†é’Ÿçš„ä¸šåŠ¡æŠ¥é”™ä¿¡æ¯ï¼Œæ¯”å¦‚javaçš„errorçº§åˆ«æ‰“å°çš„å¼‚å¸¸æ—¥å¿—ï¼Œæˆ–è€…æ¡†æ¶æŠ›å‡ºçš„å¼‚å¸¸ç­‰ã€‚è¿™ä¸¤ä¸ªæŒ‡æ ‡å¯ä»¥å‘Šè¯‰æˆ‘ä»¬ç³»ç»Ÿæ­£åœ¨å‘ç”Ÿä»€ä¹ˆé”™è¯¯ï¼Œå¸®åŠ©æˆ‘ä»¬å¿«é€Ÿæ’æŸ¥é—®é¢˜ã€‚è¿™ä¸¤ä¸ªæŒ‡æ ‡çš„å¯¼å‡ºæ–¹å¼å¯ä»¥æŸ¥çœ‹ç¬”è€…ä¹‹å‰çš„æ–‡ç« ï¼Œjavaå¼‚å¸¸ï¼š<a href="https://juejin.cn/post/7580287891274186815" target="_blank" title="https://juejin.cn/post/7580287891274186815">ç›‘æ§åˆ©å™¨ï¼šjavaå¼‚å¸¸ç›‘æ§</a>  ï¼Œnginxå¼‚å¸¸ï¼š<a href="https://juejin.cn/post/7588080521445294126" target="_blank" title="https://juejin.cn/post/7588080521445294126">openrestyç›‘æ§</a></li>
<li>DeploymentErroræ˜¯k8sä¸­Deploymenté¢„æœŸæ•°é‡å’Œå®é™…æ•°é‡ä¸åŒ¹é…çš„Deploymentä¿¡æ¯ï¼Œä»–ä»£è¡¨å¯¹åº”çš„æœåŠ¡æœ‰æœåŠ¡å®ä¾‹åœ¨é‡å¯ï¼Œå¯ä»¥ä»k8sçš„ç›‘æ§ä¸­å¯¼å‡ºã€‚</li>
<li>æ…¢sqlç›‘æ§ï¼Œæˆªå›¾ä¸­è¿˜æ²¡åŠ å…¥ï¼Œè¿™ä¸ªå±•ç¤ºæœ€è¿‘5åˆ†é’Ÿçš„æ•°æ®åº“çš„æ…¢sqlï¼Œæ¯”å¦‚mysqlæˆ–è€…mongoçš„æ…¢sqlï¼Œè¿™éƒ¨åˆ†æ•°æ®å¯ä»¥é€šè¿‡å¯¹æ¥å¯¹åº”æœåŠ¡å•†çš„æ¥å£è¿›è¡Œå¯¼å‡ºåˆ°prometheusï¼Œå¦‚æœæœ‰çš„è¯å¯èƒ½æ˜¯æ•°æ®åº“å±‚é¢æœ‰é—®é¢˜ï¼Œéœ€è¦è¿›è¡Œæ€§èƒ½ä¼˜åŒ–æˆ–è€…æ’æŸ¥æ˜¯å¦ç¼“å­˜ç©¿é€äº†</li>
<li>äº‹ä»¶ä¸­å¿ƒç›‘æ§ï¼Œæˆªå›¾ä¸­è¿˜æ²¡åŠ ï¼Œè¿™ä¸ªå±•ç¤ºæœ€è¿‘5åˆ†é’Ÿçš„äº‹ä»¶ï¼ŒåŒ…æ‹¬æ“ä½œå’Œç³»ç»Ÿäº‹ä»¶ï¼Œæ¯”å¦‚æ•°æ®åº“æ˜¯å¦æœ‰é‡å¯æˆ–è€…é…ç½®å˜æ›´ï¼Œæ˜¯å¦æœ‰åˆ›å»ºæ–°ç´¢å¼•ï¼Œæ˜¯å¦æœ‰æœåŠ¡å‘å¸ƒæˆ–è€…é…ç½®å‘å¸ƒç­‰ï¼Œè¿™ä¸ªéœ€è¦å»ºç«‹äº‹ä»¶ä¸­å¿ƒï¼Œå¦‚æœçœ‹åˆ°æœ€è¿‘æœ‰æ•°æ®åº“é‡å¯æˆ–è€…åˆ›å»ºç´¢å¼•ä¹‹ç±»çš„äº‹ä»¶ï¼Œå°±å¯ä»¥ä¼˜å…ˆè€ƒè™‘æ˜¯å¯¹åº”æ“ä½œå¯¼è‡´çš„é—®é¢˜ã€‚</li>
</ol>
<h6 data-id="heading-6">æ’æŸ¥æ–¹å¼</h6>
<p>å…¶å®ä¸Šé¢ä»‹ç»äº†ä¸€äº›é—®é¢˜æ’æŸ¥æ–¹å¼äº†ï¼Œè¿™é‡Œç»Ÿä¸€æ±‡æ€»ä¸‹</p>
<ol>
<li>æŸ¥çœ‹æœºå™¨èŠ‚ç‚¹çš„cpuæ•°æ®ï¼Œå¦‚æœæŸä¸€å°æœºå™¨çš„cpuå¾ˆé«˜ï¼Œé‚£è¿™å°æœºå™¨ä¸Šçš„æœåŠ¡å®ä¾‹å¯èƒ½éƒ½æœ‰é—®é¢˜ï¼Œéœ€è¦é¦–å…ˆæƒ³åŠæ³•é™ä½æœºå™¨cpuï¼Œæ¯”å¦‚å°†ä¸€ä¸ªæœåŠ¡å®ä¾‹è¿å‡ºè¿™å°æœºå™¨ï¼Œæˆ–è€…æ‰©å®¹æœºå™¨</li>
<li>æŸ¥çœ‹podèŠ‚ç‚¹çš„cpu throttlingæ•°æ®ï¼Œå¦‚æœæŸä¸€ä¸ªpodçš„cpu throttlingæ¯”è¾ƒé«˜ï¼Œè¯´æ˜podçš„cpuä¸å¤Ÿç”¨ï¼Œå·²ç»è¢«k8sé™åˆ¶cpuçš„ä½¿ç”¨äº†ï¼ŒæœåŠ¡å®ä¾‹ä¼šå‡ºé—®é¢˜ï¼Œæ­¤æ—¶è€ƒè™‘ä¸´æ—¶æ‰©å®¹å®¹å™¨çš„cpu limit</li>
<li>æŸ¥çœ‹javaå’Œnginxçš„å¼‚å¸¸æ•°æ®ï¼Œç›‘æ§ä¸­å±•ç¤ºæœ€è¿‘å‡ åˆ†é’Ÿçš„javaå’Œnginxçš„å¼‚å¸¸æ•°æ®ï¼Œè¿™ä¸ªå¯ä»¥çœ‹å‡ºæœåŠ¡ç°åœ¨åœ¨æŠ¥ä»€ä¹ˆé”™ï¼Œè¯´ä¸å®šå°±èƒ½ä¸€ä¸‹å®šä½åˆ°é—®é¢˜çš„åŸå› </li>
<li>æŸ¥çœ‹DeploymentErrorï¼Œå¦‚æœæœ‰æœåŠ¡å®é™…æ•°é‡ä¸€ç›´æ¯”æœŸæœ›æ•°é‡å°‘ï¼Œå¯èƒ½æ˜¯æœåŠ¡è¢«æ‰“æŒ‚äº†ï¼Œä¸€ç›´åœ¨é‡å¯ï¼Œæ­¤æ—¶å¯ä»¥è€ƒè™‘æ‰©å®¹æœåŠ¡å®ä¾‹æ•°é‡</li>
<li>æŸ¥çœ‹æ…¢sqlï¼Œå¦‚æœçªç„¶æœ‰å¾ˆå¤šæ…¢sqlï¼Œåˆ™ä»£è¡¨æ˜¯æ•°æ®åº“å±‚é¢å‡ºäº†é—®é¢˜ï¼Œä¼˜å…ˆä»æ…¢sqlä¸‹æ‰‹æ’æŸ¥é—®é¢˜ï¼Œç¡®è®¤æ˜¯ä»£ç çš„sqlæœ‰é—®é¢˜ï¼Œè¿˜æ˜¯æ•°æ®åº“æ€§èƒ½ä¸è¶³ç­‰é—®é¢˜ã€‚</li>
<li>æŸ¥çœ‹äº‹ä»¶ä¸­å¿ƒæ¶ˆæ¯ï¼Œäº‹ä»¶ä¸­å¿ƒä¼šæ”¶é›†æœ€è¿‘å‡ åˆ†é’Ÿçš„æ‰€æœ‰äººå·¥æ“ä½œï¼Œäº‘æœåŠ¡æä¾›å•†çš„äº‹ä»¶ï¼Œæ¯”å¦‚è¦æ˜¯å‘ç°æœ‰ä¸ªmysqlé‡å¯äº‹ä»¶ï¼Œå°±èƒ½ä¸€ä¸‹å®šä½åŸå› ã€‚</li>
</ol>
<h4 data-id="heading-7">ä¸‰ã€æŒ‡å®šæœåŠ¡æ·±å…¥æ’æŸ¥</h4>
<p>åœ¨å‰ä¸¤æ­¥ä¸­ï¼Œè¦æ˜¯èƒ½ç¡®å®šé—®é¢˜æœåŠ¡ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥é’ˆå¯¹å¯¹åº”æœåŠ¡è¿›è¡Œæ·±å…¥æ’æŸ¥ï¼Œå¦‚æœæœ‰å¤šä¸ªæœåŠ¡éƒ½æœ‰é—®é¢˜ï¼Œé‚£æˆ‘ä»¬å¯ä»¥æ‰¾ä¸€ä¸ªæ ¸å¿ƒçš„æœåŠ¡å…ˆæ·±å…¥æ’æŸ¥ï¼Œç„¶åé¡ºè—¤æ‘¸ç“œæ‰¾å‡ºé—®é¢˜æœåŠ¡ã€‚è¿™é‡Œä¸»è¦ä½¿ç”¨é“¾è·¯è¿½è¸ªç³»ç»Ÿï¼Œæ¯”å¦‚<strong>skywalkingæˆ–è€…OpenTelemetry</strong>ç­‰ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d1bd81766ae4d74856602d0528c373d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO55qE5b2S5a6_NTU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769267964&amp;x-signature=%2BrrpdYxz5cIcP5O69ehAQiKSzPI%3D" alt="4.jpg" loading="lazy"/></p>
<h6 data-id="heading-8">æ’æŸ¥æ–¹å¼</h6>
<ol>
<li>æœåŠ¡çš„é—®é¢˜å¯èƒ½æ¶‰åŠ<strong>åº”ç”¨å±‚å’Œæ•°æ®åº“å±‚</strong>ä¸¤ä¸ªæ–¹é¢ï¼Œæˆ‘ä»¬å…ˆä»æ•°æ®åº“å±‚å¼€å§‹çœ‹ï¼Œè¿™éƒ¨åˆ†æ¯”è¾ƒç®€å•ï¼Œå…ˆé€šè¿‡ä¹‹å‰ä»‹ç»çš„æ…¢sqlå’Œäº‹ä»¶ä¸­å¿ƒæŸ¥çœ‹ï¼Œæ˜¯å¦æœ‰æ…¢sqlæˆ–è€…åˆ›å»ºç´¢å¼•ç­‰å®¹æ˜“é˜»å¡æ•´ä¸ªè¡¨çš„äº‹ä»¶ï¼Œå¦‚æœæœ‰çš„è¯å°±ä¼˜å…ˆè§£å†³ï¼Œå¦‚æœæ²¡æœ‰çš„è¯å°±è¿›å…¥åº”ç”¨å±‚çš„é—®é¢˜æ’æŸ¥ã€‚</li>
<li>é’ˆå¯¹æœåŠ¡çš„æ‰€æœ‰æœåŠ¡å®ä¾‹ï¼Œ<strong>å…ˆè§£å†³èµ„æºçš„é—®é¢˜</strong>ï¼ŒæŸ¥çœ‹æœåŠ¡å®ä¾‹æ‰€åœ¨çš„æœåŠ¡å™¨æ˜¯å¦æœ‰cpué«˜ï¼Œioé«˜ç­‰èµ„æºé—®é¢˜ï¼Œæˆ–è€…æœåŠ¡å®ä¾‹çš„å®¹å™¨æ˜¯å¦æœ‰cpuèµ„æºç“¶é¢ˆï¼Œå¦‚å‡ºç°cpu throttlingé«˜ç­‰ï¼Œå…ˆé€šè¿‡æ‰©å®¹æˆ–è€…è¿ç§»è§£å†³èµ„æºä¸Šçš„ç“¶é¢ˆã€‚</li>
<li>å¦‚æœèµ„æºçš„ç“¶é¢ˆå·²ç»è§£å†³ï¼Œä½†æ˜¯é—®é¢˜ä¾æ—§å­˜åœ¨ï¼Œæ­¤æ—¶éœ€è¦é’ˆå¯¹æœåŠ¡æœ¬èº«è¿›è¡Œæ’æŸ¥ã€‚è¿™é‡Œä¸€èˆ¬åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œ<strong>ä¸€ä¸ªæ˜¯è¯·æ±‚å¤ªå¤šï¼ŒæœåŠ¡å®ä¾‹æ¥ä¸åŠå¤„ç†ï¼Œä¸€ä¸ªæ˜¯è¯·æ±‚å¤„ç†å¤ªæ…¢å¯¼è‡´è¯·æ±‚å †ç§¯ï¼Œä»è€Œå¤„ç†å¤±è´¥</strong>ã€‚ è¿™é‡Œéœ€è¦ç”¨åˆ°é“¾è·¯è¿½è¸ªç›‘æ§ç”¨äº æŸ¥çœ‹ä¸€æ®µæ—¶é—´å†…çš„æœ€æ…¢è¯·æ±‚ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé“¾è·¯è¿½è¸ªç³»ç»Ÿéœ€è¦è®°å½•æ‰€æœ‰ä½äºä¸€å®šé˜ˆå€¼çš„æ…¢è¯·æ±‚ï¼Œé¿å…æ•°æ®ä¸å…¨ã€‚</li>
<li>å¦‚æœè¯·æ±‚å¤„ç†æ—¶é—´éƒ½å¾ˆå¿«ï¼Œæ²¡æœ‰æ¯”è¾ƒæ…¢çš„è¯·æ±‚ï¼Œé‚£è€ƒè™‘æ˜¯è¯·æ±‚æ•°è¶…å‡ºäº†æœåŠ¡å®ä¾‹çš„å¤„ç†èƒ½åŠ›ï¼Œä¼˜å…ˆè€ƒè™‘å¢åŠ æœåŠ¡å®ä¾‹è¿›è¡Œæ‰©å®¹ã€‚è¿™é‡ŒåŒæ—¶ä¹Ÿå¯ä»¥çœ‹ä¸‹javaçš„jvmç›‘æ§ï¼Œç¡®è®¤æ˜¯å¦æœ‰jvmå›æ”¶æ—¶é—´é•¿çš„é—®é¢˜ï¼Œè¿™ä¸ªä¹Ÿä¼šå¯¼è‡´å¤„ç†èƒ½åŠ›é™ä½ã€‚</li>
<li>å¦‚æœæœ‰å¾ˆå¤šè¯·æ±‚æ¯”è¾ƒæ…¢ï¼Œå¯ä»¥é€šè¿‡é“¾è·¯è¿½è¸ªçš„åŠŸèƒ½æŸ¥çœ‹æ˜¯å“ªä¸ªæ­¥éª¤æ‰§è¡Œçš„æ¯”è¾ƒæ…¢ï¼Œä»è€Œè¿›ä¸€æ­¥è¿›è¡Œæ’æŸ¥å¯¹åº”æ­¥éª¤ï¼Œæ¯”å¦‚æŸä¸ªä¸‹æ¸¸æœåŠ¡æ¯”è¾ƒæ…¢ï¼Œæˆ–è€…æŸæ®µå‡½æ•°æ‰§è¡Œæ…¢ç­‰ã€‚</li>
<li>å¦‚æœæ˜¯ä¸‹æ¸¸æœåŠ¡æ¯”è¾ƒæ…¢ï¼Œé‚£å°±ç»§ç»­å»æŸ¥å¯¹åº”æœåŠ¡ã€‚ å¦‚æœæ˜¯æŸæ®µå‡½æ•°æ‰§è¡Œæ¯”è¾ƒæ…¢ï¼Œå°±éœ€è¦é€šè¿‡ä»£ç é€»è¾‘è¿›è¡Œæ’æŸ¥ï¼Œå¿…ç„¶æ—¶å¯ä»¥é€šè¿‡<strong>arthasååŠ©æ’æŸ¥javaåº”ç”¨çš„é—®é¢˜</strong>ï¼ŒåŒ…æ‹¬ä½¿ç”¨traceå‘½ä»¤æŸ¥çœ‹æ–¹æ³•è°ƒç”¨é“¾è€—æ—¶ï¼Œ<strong>ä½¿ç”¨profilerå‘½ä»¤å¯¼å‡ºcpuç«ç„°å›¾è¿›è¡Œåˆ†æï¼ˆæ’æŸ¥æœåŠ¡å®ä¾‹çš„cpuä½¿ç”¨ç‡é«˜çš„åŸå› æ—¶éƒ½ä½¿ç”¨æ­¤æ–¹æ³•ï¼‰</strong>ï¼Œä½¿ç”¨threadè¿›è¡Œçº¿ç¨‹é˜»å¡åˆ†æç­‰ã€‚</li>
</ol>
<h4 data-id="heading-9">æ€»ç»“</h4>
<p>è¿™é‡Œç»Ÿä¸€æ•´ç†ä¸‹æµç¨‹ï¼š</p>
<ol>
<li><strong>å…¨å±€æ€åŠ¿æ„ŸçŸ¥</strong>
é¦–å…ˆé€šè¿‡ç½‘å…³å±‚ç›‘æ§æŒæ¡ç³»ç»Ÿæ•´ä½“è¿è¡ŒçŠ¶æ€ï¼Œå¿«é€Ÿè¯†åˆ«å¼‚å¸¸æœåŠ¡èŠ‚ç‚¹ï¼Œæ˜ç¡®é—®é¢˜è¾¹ç•Œã€‚</li>
<li><strong>å…³é”®æŒ‡æ ‡å¿«é€Ÿæ­¢è¡€</strong>
é€šè¿‡ç›‘æ§å¤§å±èšç„¦æ ¸å¿ƒæŒ‡æ ‡ï¼ˆç¡¬ä»¶èµ„æºã€æ•°æ®åº“è´Ÿè½½ã€åº”ç”¨æ€§èƒ½ç­‰ï¼‰ï¼Œè¿™äº›æŒ‡æ ‡å…·æœ‰å¼ºä»£è¡¨æ€§ï¼š</li>
</ol>
<ul>
<li>ä»»ä½•ä¸€é¡¹å¼‚å¸¸éƒ½éœ€ç«‹å³å¹²é¢„ï¼Œä¼˜å…ˆè§£å†³ä»¥å¿«é€Ÿæ¢å¤æœåŠ¡èƒ½åŠ›</li>
<li>åŒæ—¶ä½œä¸ºç³»ç»Ÿå¥åº·åº¦çš„åŸºå‡†å‚è€ƒï¼Œå½¢æˆå¸¸æ€åŒ–ç›‘æ§æœºåˆ¶</li>
</ul>
<ol start="3">
<li><strong>æ¨¡å—æ·±åº¦æ ¹å› åˆ†æ</strong>
é‡‡ç”¨åˆ†å±‚è¯Šæ–­ç­–ç•¥ï¼Œéµå¾ª"èµ„æºä¼˜å…ˆ"åŸåˆ™ï¼š</li>
</ol>
<ul>
<li><strong>ç¬¬ä¸€ä¼˜å…ˆçº§ï¼šèµ„æºç“¶é¢ˆæ’æŸ¥</strong>
ç¡®è®¤CPUã€å†…å­˜ã€IOç­‰èµ„æºæ˜¯å¦å……è¶³ï¼Œé¿å…å› èµ„æºä¸è¶³å¯¼è‡´çš„å»¶æ—¶å‡è±¡ï¼ˆå¦‚CPUäº‰ç”¨å¼•å‘æ–¹æ³•æ‰§è¡Œæ—¶é—´è¢«åŠ¨æ‹‰é•¿ï¼‰</li>
<li><strong>ç¬¬äºŒä¼˜å…ˆçº§ï¼šå¼‚å¸¸äº‹ä»¶å®šä½</strong>
é€šè¿‡å¼‚å¸¸ä¸­å¿ƒå¿«é€Ÿæ•è·é”™è¯¯æ—¥å¿—ã€å‘Šè­¦äº‹ä»¶ï¼Œæ˜ç¡®æ•…éšœç‚¹</li>
<li><strong>æœ€ç»ˆèšç„¦ï¼šå»¶æ—¶åˆ†è§£å½’å› </strong>
ç»“åˆé“¾è·¯è¿½è¸ªç³»ç»Ÿï¼Œå°†æ€»å»¶æ—¶æ‹†è§£ä¸ºæœåŠ¡è°ƒç”¨é“¾å„é˜¶æ®µè€—æ—¶ï¼Œé”å®šçœŸå®æ€§èƒ½ç“¶é¢ˆç¯èŠ‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ç†è§£MySQLæ•°æ®åº“ç´¢å¼•]]></title>    <link>https://juejin.cn/post/7595901379015081994</link>    <guid>https://juejin.cn/post/7595901379015081994</guid>    <pubDate>2026-01-17T15:43:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595901379015081994" data-draft-id="7595901379015065610" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ç†è§£MySQLæ•°æ®åº“ç´¢å¼•"/> <meta itemprop="keywords" content="MySQL"/> <meta itemprop="datePublished" content="2026-01-17T15:43:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸‰æ°´ä¸æ»´"/> <meta itemprop="url" content="https://juejin.cn/user/283045639753100"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ç†è§£MySQLæ•°æ®åº“ç´¢å¼•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/283045639753100/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸‰æ°´ä¸æ»´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T15:43:36.000Z" title="Sat Jan 17 2026 15:43:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ·±å…¥ç†è§£ MySQL æ•°æ®åº“ç´¢å¼•</h2>
<p>æœ¬æ–‡å°†è¯¦ç»†æ‹†è§£ MySQL æ•°æ®åº“ç´¢å¼•çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œæ¶µç›–<strong>åº•å±‚æ•°æ®ç»“æ„</strong>ã€<strong>åŠŸèƒ½åˆ†ç±»</strong>ã€<strong>èšç°‡ä¸éèšç°‡ç´¢å¼•å·®å¼‚</strong>ï¼Œä»¥åŠ<strong>ç´¢å¼•åˆ›å»ºåŸåˆ™å’Œå¤±æ•ˆåœºæ™¯</strong>ï¼ŒåŠ©åŠ›å¤¯å®æ•°æ®åº“æ€§èƒ½ä¼˜åŒ–åŸºç¡€ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€ æŒ‰åº•å±‚æ•°æ®ç»“æ„åˆ†ç±»</h3>
<p>MySQL ç´¢å¼•çš„æ€§èƒ½å’Œé€‚ç”¨åœºæ™¯ï¼Œç”±å…¶åº•å±‚æ•°æ®ç»“æ„å†³å®šã€‚ä»¥ä¸‹æ˜¯å››ç§æ ¸å¿ƒç´¢å¼•ç±»å‹çš„å¯¹æ¯”ä¸è¯¦è§£ï¼š</p>








































<table><thead><tr><th>ç´¢å¼•ç±»å‹</th><th>é€‚ç”¨åœºæ™¯</th><th>æ”¯æŒæ“ä½œ</th><th>ä¼˜ç¼ºç‚¹</th><th>å­˜å‚¨å¼•æ“æ”¯æŒ</th></tr></thead><tbody><tr><td>B+æ ‘ç´¢å¼•</td><td>å¸¸è§„æŸ¥è¯¢ï¼ˆç­‰å€¼ã€èŒƒå›´ã€æ’åºï¼‰</td><td>ç­‰å€¼æŸ¥è¯¢ï¼ˆ=ï¼‰ã€èŒƒå›´æŸ¥è¯¢ï¼ˆ&gt;ã€&lt;ã€BETWEENï¼‰ã€æ’åºï¼ˆORDER BYï¼‰ã€LIKE å‰ç¼€åŒ¹é…</td><td>ä¼˜ç‚¹ï¼šé€‚é…ç»å¤§å¤šæ•°æŸ¥è¯¢ï¼Œæ—¶é—´å¤æ‚åº¦ O(log N)ï¼›ç¼ºç‚¹ï¼šä¸æ”¯æŒå“ˆå¸Œå¿«é€Ÿå®šä½</td><td>InnoDBã€MyISAMã€Memoryï¼ˆå¯é…ç½®ï¼‰</td></tr><tr><td>å“ˆå¸Œç´¢å¼•</td><td>é«˜é¢‘ç­‰å€¼æŸ¥è¯¢</td><td>ä»…æ”¯æŒç­‰å€¼æŸ¥è¯¢ï¼ˆ=ï¼‰</td><td>ä¼˜ç‚¹ï¼šç­‰å€¼æŸ¥è¯¢é€Ÿåº¦æå¿«ï¼Œæ—¶é—´å¤æ‚åº¦ O(1)ï¼›ç¼ºç‚¹ï¼šä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢ã€æ’åºã€æ¨¡ç³ŠåŒ¹é…</td><td>ä»… Memory å­˜å‚¨å¼•æ“</td></tr><tr><td>å…¨æ–‡ç´¢å¼•</td><td>å¤§æ–‡æœ¬å†…å®¹æ£€ç´¢</td><td>è‡ªç„¶è¯­è¨€æœç´¢ï¼ˆMATCH...AGAINSTï¼‰</td><td>ä¼˜ç‚¹ï¼šé«˜æ•ˆåˆ†è¯æ£€ç´¢é•¿æ–‡æœ¬ï¼›ç¼ºç‚¹ï¼šä¸é€‚åˆå°æ•°æ®é‡æˆ–é¢‘ç¹æ›´æ–°åœºæ™¯</td><td>InnoDBã€MyISAM</td></tr><tr><td>ç©ºé—´ç´¢å¼•</td><td>GIS åœ°ç†ä¿¡æ¯æ•°æ®æŸ¥è¯¢</td><td>ç©ºé—´å…³ç³»æŸ¥è¯¢ï¼ˆåŒ…å«ã€ç›¸äº¤ã€è·ç¦»è®¡ç®—ï¼‰</td><td>ä¼˜ç‚¹ï¼šä¸“ä¸ºç©ºé—´æ•°æ®ä¼˜åŒ–ï¼›ç¼ºç‚¹ï¼šæ”¯æŒæœ‰é™ï¼Œåº”ç”¨åœºæ™¯å°ä¼—</td><td>MyISAMï¼ˆInnoDB 8.0+ éƒ¨åˆ†æ”¯æŒï¼‰</td></tr></tbody></table>
<h4 data-id="heading-2">1.1 B+æ ‘ç´¢å¼•</h4>
<p>B+æ ‘ç´¢å¼•æ˜¯ MySQL <strong>é»˜è®¤ä¸”åº”ç”¨æœ€å¹¿</strong>çš„ç´¢å¼•ç±»å‹ï¼Œæ˜¯ InnoDB å’Œ MyISAM å¼•æ“çš„æ ¸å¿ƒç´¢å¼•ç»“æ„ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒç‰¹ç‚¹</strong>ï¼šæ•°æ®æŒ‰å±‚çº§ç»„ç»‡æˆæ ‘çŠ¶ç»“æ„ï¼Œå¶å­èŠ‚ç‚¹å­˜å‚¨å…¨éƒ¨ç´¢å¼•æ•°æ®å¹¶é€šè¿‡é“¾è¡¨ç›¸è¿ï¼Œæ—¢ä¿è¯ç­‰å€¼æŸ¥è¯¢æ•ˆç‡ï¼Œåˆæ”¯æŒèŒƒå›´éå†å’Œæ’åºã€‚</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šä¸»é”®ã€å¤–é”®ã€é¢‘ç¹ä½œä¸º WHERE æ¡ä»¶ã€å‚ä¸æ’åºå’Œè¡¨è¿æ¥çš„å­—æ®µã€‚</li>
</ul>
<h4 data-id="heading-3">1.2 å“ˆå¸Œç´¢å¼•</h4>
<p>å“ˆå¸Œç´¢å¼•åŸºäºå“ˆå¸Œè¡¨å®ç°ï¼Œä»…é€‚ç”¨äº Memory å­˜å‚¨å¼•æ“ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒç‰¹ç‚¹</strong>ï¼šé€šè¿‡å“ˆå¸Œå‡½æ•°å°†ç´¢å¼•é”®æ˜ å°„ä¸ºå“ˆå¸Œå€¼ï¼ŒæŸ¥è¯¢æ—¶ç›´æ¥å®šä½æ•°æ®ä½ç½®ï¼Œç­‰å€¼æŸ¥è¯¢é€Ÿåº¦è¿œè¶… B+æ ‘ï¼›ä½†æ— æ³•åº”å¯¹èŒƒå›´æŸ¥è¯¢ã€æ’åºç­‰æ“ä½œï¼Œä¸”å­˜åœ¨å“ˆå¸Œå†²çªé£é™©ã€‚</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šæ•°æ®é‡å°ã€æŸ¥è¯¢ä»¥ç­‰å€¼åŒ¹é…ä¸ºä¸»çš„ä¸´æ—¶è¡¨æˆ–å†…å­˜è¡¨ã€‚</li>
</ul>
<h4 data-id="heading-4">1.3 å…¨æ–‡ç´¢å¼•</h4>
<p>å…¨æ–‡ç´¢å¼•ä¸“ä¸ºæ–‡æœ¬æ£€ç´¢è®¾è®¡ï¼Œé’ˆå¯¹ CHARã€VARCHARã€TEXT ç±»å‹å­—æ®µä¼˜åŒ–ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒç‰¹ç‚¹</strong>ï¼šé‡‡ç”¨åˆ†è¯æŠ€æœ¯æ‹†åˆ†æ–‡æœ¬ï¼Œå¿½ç•¥åœç”¨è¯ï¼ˆå¦‚ <code>a</code>ã€<code>the</code>ï¼‰ï¼Œæ”¯æŒè‡ªç„¶è¯­è¨€æ¨¡å¼å’Œå¸ƒå°”æ¨¡å¼æ£€ç´¢ã€‚</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šæ–°é—»ç½‘ç«™ã€åšå®¢ç³»ç»Ÿã€æœç´¢å¼•æ“ç­‰éœ€è¦å…¨æ–‡å…³é”®è¯åŒ¹é…çš„åœºæ™¯ã€‚</li>
</ul>
<h4 data-id="heading-5">1.4 ç©ºé—´ç´¢å¼•</h4>
<p>ç©ºé—´ç´¢å¼•åŸºäº R-Tree ç»“æ„å®ç°ï¼Œç”¨äºå¤„ç†åœ°ç†ä¿¡æ¯æ•°æ®ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒç‰¹ç‚¹</strong>ï¼šä¼˜åŒ–ç©ºé—´æ•°æ®çš„å­˜å‚¨ä¸æŸ¥è¯¢ï¼Œå¯å¿«é€Ÿåˆ¤æ–­ç‚¹ã€çº¿ã€é¢ä¹‹é—´çš„ç©ºé—´å…³ç³»ã€‚</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šåœ°å›¾æœåŠ¡ã€ä½ç½®è½¨è¿¹åˆ†æç­‰ GIS ç›¸å…³åº”ç”¨ã€‚</li>
</ul>
<h4 data-id="heading-6">1.5 å“ˆå¸Œç´¢å¼• vs B+æ ‘ç´¢å¼• æ ¸å¿ƒæŠ‰æ‹©</h4>








































<table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>å“ˆå¸Œç´¢å¼•</th><th>B+æ ‘ç´¢å¼•</th></tr></thead><tbody><tr><td>èŒƒå›´æŸ¥è¯¢</td><td>âŒ ä¸æ”¯æŒ</td><td>âœ… æ”¯æŒ</td></tr><tr><td>æ’åºæ“ä½œ</td><td>âŒ ä¸æ”¯æŒ</td><td>âœ… æ”¯æŒ</td></tr><tr><td>æ¨¡ç³ŠæŸ¥è¯¢</td><td>âŒ ä¸æ”¯æŒ</td><td>âœ… æ”¯æŒ LIKE 'xx%'</td></tr><tr><td>è”åˆç´¢å¼•é€‚é…</td><td>âŒ ä¸æ”¯æŒæœ€å·¦å‰ç¼€åŸåˆ™</td><td>âœ… å®Œç¾æ”¯æŒ</td></tr><tr><td>å­˜å‚¨å¼•æ“å…¼å®¹æ€§</td><td>ä»… Memory</td><td>å…¨å¼•æ“å…¼å®¹</td></tr><tr><td>ç­‰å€¼æŸ¥è¯¢æ•ˆç‡</td><td>O(1)ï¼Œé€Ÿåº¦æå¿«</td><td>O(log N)ï¼Œç¨³å®šé«˜æ•ˆ</td></tr></tbody></table>
<p><strong>æŠ‰æ‹©å»ºè®®</strong>ï¼šç»å¤§å¤šæ•°ä¸šåŠ¡åœºæ™¯ä¼˜å…ˆé€‰æ‹© B+æ ‘ç´¢å¼•ï¼›ä»…å½“æ•°æ®å­˜äº Memory å¼•æ“ä¸”æŸ¥è¯¢ä¸ºçº¯ç­‰å€¼åŒ¹é…æ—¶ï¼Œè€ƒè™‘å“ˆå¸Œç´¢å¼•ã€‚</p>
<h3 data-id="heading-7">äºŒã€ æŒ‰åŠŸèƒ½ä¸ç”¨é€”åˆ†ç±»</h3>
<p>ä»ä¸šåŠ¡åŠŸèƒ½è§’åº¦ï¼ŒMySQL ç´¢å¼•å¯åˆ†ä¸ºä»¥ä¸‹ 6 ç±»ï¼Œå„è‡ªæ‰¿æ‹…ä¸åŒçš„æ€§èƒ½ä¼˜åŒ–èŒè´£ï¼š</p>
<h4 data-id="heading-8">2.1 ä¸»é”®ç´¢å¼•ï¼ˆPrimary Key Indexï¼‰</h4>
<ul>
<li><strong>æ ¸å¿ƒç‰¹ç‚¹</strong>ï¼šç‰¹æ®Šçš„å”¯ä¸€ç´¢å¼•ï¼Œ<strong>ä¸å…è®¸ NULL å€¼å’Œé‡å¤æ•°æ®</strong>ï¼Œä¸€å¼ è¡¨<strong>ä»…èƒ½æœ‰ä¸€ä¸ªä¸»é”®ç´¢å¼•</strong>ã€‚</li>
<li><strong>å¼•æ“ç‰¹æ€§</strong>ï¼šInnoDB ä¸­ï¼Œä¸»é”®ç´¢å¼•å°±æ˜¯<strong>èšç°‡ç´¢å¼•</strong>ï¼Œæ•°æ®è¡Œç›´æ¥å­˜å‚¨åœ¨ç´¢å¼•å¶å­èŠ‚ç‚¹ï¼›MyISAM æ— èšç°‡ç´¢å¼•æ¦‚å¿µï¼Œä¸»é”®ç´¢å¼•ä»…ä¸ºæ™®é€šå”¯ä¸€ç´¢å¼•ã€‚</li>
<li><strong>åˆ›å»ºæ–¹å¼</strong>ï¼š
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> table_name (
    id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,
    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>)
);
</code></pre>
</li>
<li><strong>ä¸»é”®é€‰å‹å»ºè®®</strong>ï¼šä¼˜å…ˆä½¿ç”¨<strong>è‡ªå¢ä¸»é”®</strong>ã€‚è‡ªå¢ä¸»é”®æ’å…¥æ—¶æŒ‰é¡ºåºå†™å…¥æ•°æ®é¡µï¼Œå‡å°‘é¡µåˆ†è£‚å’Œç¢ç‰‡ï¼›éè‡ªå¢ä¸»é”®ï¼ˆå¦‚ UUIDï¼‰ä¼šå¯¼è‡´æ•°æ®éšæœºå†™å…¥ï¼Œå¢åŠ  I/O å¼€é”€ã€‚</li>
</ul>
<h4 data-id="heading-9">2.2 å”¯ä¸€ç´¢å¼•ï¼ˆUnique Indexï¼‰</h4>
<ul>
<li><strong>æ ¸å¿ƒç‰¹ç‚¹</strong>ï¼šä¿è¯ç´¢å¼•åˆ—å€¼å”¯ä¸€ï¼Œ<strong>å…è®¸ NULL å€¼</strong>ï¼ˆNULL ä¸å‚ä¸å”¯ä¸€æ€§æ ¡éªŒï¼‰ï¼Œä¸€å¼ è¡¨å¯åˆ›å»ºå¤šä¸ªå”¯ä¸€ç´¢å¼•ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šé˜²æ­¢æ•°æ®é‡å¤ï¼ŒåŒæ—¶åŠ é€Ÿç­‰å€¼æŸ¥è¯¢ã€‚</li>
<li><strong>åˆ›å»ºæ–¹å¼</strong>ï¼š
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">UNIQUE</span> INDEX idx_unique_email <span class="hljs-keyword">ON</span> <span class="hljs-keyword">user</span>(email);
</code></pre>
</li>
</ul>
<h4 data-id="heading-10">2.3 æ™®é€šç´¢å¼•ï¼ˆNormal Indexï¼‰</h4>
<ul>
<li><strong>æ ¸å¿ƒç‰¹ç‚¹</strong>ï¼šæœ€åŸºç¡€çš„ç´¢å¼•ç±»å‹ï¼Œ<strong>æ— å”¯ä¸€æ€§å’Œéç©ºçº¦æŸ</strong>ï¼Œä»…ç”¨äºåŠ é€ŸæŸ¥è¯¢ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šæå‡é«˜é¢‘æŸ¥è¯¢å­—æ®µçš„æ£€ç´¢æ•ˆç‡ï¼Œæ˜¯ä¸šåŠ¡å¼€å‘ä¸­ä½¿ç”¨æœ€é¢‘ç¹çš„ç´¢å¼•ã€‚</li>
<li><strong>åˆ›å»ºæ–¹å¼</strong>ï¼š
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> INDEX idx_normal_name <span class="hljs-keyword">ON</span> <span class="hljs-keyword">user</span>(name);
</code></pre>
</li>
</ul>
<h4 data-id="heading-11">2.4 å…¨æ–‡ç´¢å¼•ï¼ˆFull-Text Indexï¼‰</h4>
<ul>
<li><strong>æ ¸å¿ƒç‰¹ç‚¹</strong>ï¼šä¸“ä¸ºæ–‡æœ¬æ£€ç´¢è®¾è®¡ï¼Œä¸åº•å±‚æ•°æ®ç»“æ„ä¸­çš„å…¨æ–‡ç´¢å¼•ä¸€è‡´ï¼Œéœ€é€šè¿‡ <code>MATCH...AGAINST</code> è¯­æ³•æŸ¥è¯¢ã€‚</li>
<li><strong>ä½¿ç”¨ç¤ºä¾‹</strong>ï¼š
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆ›å»ºç´¢å¼•</span>
<span class="hljs-keyword">CREATE</span> FULLTEXT INDEX idx_fulltext_content <span class="hljs-keyword">ON</span> article(content);
<span class="hljs-comment">-- æ£€ç´¢åŒ…å« "MySQL ä¼˜åŒ–" çš„æ–‡ç« </span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> article <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">MATCH</span>(content) AGAINST (<span class="hljs-string">'MySQL ä¼˜åŒ–'</span>);
</code></pre>
</li>
</ul>
<h4 data-id="heading-12">2.5 è¦†ç›–ç´¢å¼•ï¼ˆCovering Indexï¼‰</h4>
<ul>
<li><strong>æ ¸å¿ƒç‰¹ç‚¹</strong>ï¼šæŸ¥è¯¢æ‰€éœ€çš„æ‰€æœ‰åˆ—éƒ½åŒ…å«åœ¨ç´¢å¼•ä¸­ï¼Œæ— éœ€å›è¡¨è¯»å–æ•°æ®è¡Œï¼Œ<strong>é¿å…ç£ç›˜ I/O æ“ä½œ</strong>ï¼Œå¤§å¹…æå‡æŸ¥è¯¢æ€§èƒ½ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šå°†â€œç´¢å¼•æŸ¥è¯¢ + æ•°æ®æŸ¥è¯¢â€ç®€åŒ–ä¸ºâ€œç´¢å¼•æŸ¥è¯¢â€ï¼Œæ˜¯é«˜æ€§èƒ½æŸ¥è¯¢çš„å…³é”®ä¼˜åŒ–æ‰‹æ®µã€‚</li>
<li><strong>ç¤ºä¾‹</strong>ï¼š
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆ›å»ºè¦†ç›–ç´¢å¼•ï¼ˆåŒ…å« idã€nameï¼‰</span>
<span class="hljs-keyword">CREATE</span> INDEX idx_covering_id_name <span class="hljs-keyword">ON</span> <span class="hljs-keyword">user</span>(id, name);
<span class="hljs-comment">-- æŸ¥è¯¢æ—¶ç›´æ¥ä»ç´¢å¼•è·å–æ•°æ®ï¼Œæ— éœ€å›è¡¨</span>
<span class="hljs-keyword">SELECT</span> id, name <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">&gt;</span> <span class="hljs-number">100</span>;
</code></pre>
</li>
</ul>
<h4 data-id="heading-13">2.6 ç»„åˆç´¢å¼•ï¼ˆComposite Indexï¼‰</h4>
<ul>
<li><strong>æ ¸å¿ƒç‰¹ç‚¹</strong>ï¼šå°†å¤šä¸ªå­—æ®µç»„åˆæˆä¸€ä¸ªç´¢å¼•ï¼Œéµå¾ª<strong>æœ€å·¦å‰ç¼€åŒ¹é…åŸåˆ™</strong>ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šä¼˜åŒ–å¤šå­—æ®µè”åˆæŸ¥è¯¢ï¼Œç›¸æ¯”å¤šä¸ªå•åˆ—ç´¢å¼•ï¼Œå‡å°‘ç´¢å¼•ç»´æŠ¤æˆæœ¬å’Œå­˜å‚¨ç©ºé—´å ç”¨ã€‚</li>
<li><strong>åˆ›å»ºä¸ä½¿ç”¨ç¤ºä¾‹</strong>ï¼š
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆ›å»ºç»„åˆç´¢å¼• (a, b, c)</span>
<span class="hljs-keyword">CREATE</span> INDEX idx_composite_a_b_c <span class="hljs-keyword">ON</span> test(a, b, c);
<span class="hljs-comment">-- æœ‰æ•ˆä½¿ç”¨ï¼šåŒ¹é…æœ€å·¦å‰ç¼€</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> test <span class="hljs-keyword">WHERE</span> a <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> test <span class="hljs-keyword">WHERE</span> a <span class="hljs-operator">=</span> <span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> b <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;
<span class="hljs-comment">-- æ— æ•ˆä½¿ç”¨ï¼šæœªåŒ¹é…æœ€å·¦å‰ç¼€</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> test <span class="hljs-keyword">WHERE</span> b <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> test <span class="hljs-keyword">WHERE</span> c <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;
</code></pre>
</li>
</ul>
<h3 data-id="heading-14">ä¸‰ã€ æŒ‰å­˜å‚¨æ–¹å¼åˆ’åˆ†ï¼šèšç°‡ç´¢å¼• vs éèšç°‡ç´¢å¼•</h3>
<p>ç´¢å¼•ä¸æ•°æ®çš„å­˜å‚¨å…³ç³»ï¼Œå†³å®šäº†æŸ¥è¯¢çš„åº•å±‚æ‰§è¡Œé€»è¾‘ï¼Œè¿™æ˜¯ InnoDB å’Œ MyISAM å¼•æ“çš„æ ¸å¿ƒå·®å¼‚ç‚¹ã€‚</p>








































<table><thead><tr><th>ç‰¹æ€§</th><th>èšç°‡ç´¢å¼•ï¼ˆClustered Indexï¼‰</th><th>éèšç°‡ç´¢å¼•ï¼ˆNon-Clustered Indexï¼‰</th></tr></thead><tbody><tr><td>å­˜å‚¨å…³ç³»</td><td>ç´¢å¼•ä¸æ•°æ®è¡Œå­˜å‚¨åœ¨ä¸€èµ·ï¼Œç´¢å¼•å³æ•°æ®</td><td>ç´¢å¼•ä¸æ•°æ®è¡Œåˆ†ç¦»ï¼Œç´¢å¼•å¶å­èŠ‚ç‚¹å­˜ä¸»é”®/æŒ‡é’ˆ</td></tr><tr><td>æ•°é‡é™åˆ¶</td><td>ä¸€å¼ è¡¨<strong>ä»…èƒ½æœ‰ä¸€ä¸ª</strong></td><td>ä¸€å¼ è¡¨<strong>å¯ä»¥æœ‰å¤šä¸ª</strong></td></tr><tr><td>æŸ¥è¯¢æ€§èƒ½</td><td>ä¸»é”®æŸ¥è¯¢ã€èŒƒå›´æŸ¥è¯¢é€Ÿåº¦æå¿«ï¼Œæ— éœ€å›è¡¨</td><td>éœ€è¦é€šè¿‡ä¸»é”®/æŒ‡é’ˆå›è¡¨ï¼Œæ€§èƒ½ç•¥ä½</td></tr><tr><td>ç©ºé—´å ç”¨</td><td>è¾ƒå°ï¼Œæ— éœ€é¢å¤–å­˜å‚¨ç´¢å¼•æŒ‡é’ˆ</td><td>è¾ƒå¤§ï¼Œæ¯ä¸ªç´¢å¼•éƒ½éœ€ç‹¬ç«‹å­˜å‚¨ç©ºé—´</td></tr><tr><td>æ•°æ®æ›´æ–°å½±å“</td><td>æ’å…¥/æ›´æ–°å¯èƒ½å¯¼è‡´æ•°æ®é¡µåˆ†è£‚</td><td>ä¸å½±å“æ•°æ®ç‰©ç†é¡ºåºï¼Œæ›´æ–°æˆæœ¬ä½</td></tr><tr><td>å­˜å‚¨å¼•æ“æ”¯æŒ</td><td>InnoDBï¼ˆä¸»é”®é»˜è®¤æ˜¯èšç°‡ç´¢å¼•ï¼‰</td><td>MyISAMï¼ˆæ‰€æœ‰ç´¢å¼•å‡ä¸ºéèšç°‡ç´¢å¼•ï¼‰ã€InnoDBï¼ˆéä¸»é”®ç´¢å¼•ï¼‰</td></tr></tbody></table>
<h4 data-id="heading-15">3.1 èšç°‡ç´¢å¼•</h4>
<ul>
<li><strong>æ ¸å¿ƒé€»è¾‘</strong>ï¼šInnoDB ä¸­ï¼Œèšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ç›´æ¥å­˜å‚¨å®Œæ•´æ•°æ®è¡Œï¼Œæ•°æ®æŒ‰ä¸»é”®é¡ºåºç‰©ç†æ’åˆ—ã€‚</li>
<li><strong>ä¸»é”®ç¼ºå¤±å¤„ç†</strong>ï¼šè‹¥æœªæ˜¾å¼å®šä¹‰ä¸»é”®ï¼ŒInnoDB ä¼šé€‰æ‹©ç¬¬ä¸€ä¸ªéç©ºå”¯ä¸€ç´¢å¼•ä½œä¸ºèšç°‡ç´¢å¼•ï¼›è‹¥æ²¡æœ‰ï¼Œåˆ™è‡ªåŠ¨ç”Ÿæˆ 6 å­—èŠ‚çš„éšå« <code>ROWID</code> ä½œä¸ºèšç°‡ç´¢å¼•ã€‚</li>
</ul>
<h4 data-id="heading-16">3.2 éèšç°‡ç´¢å¼•</h4>
<ul>
<li><strong>æ ¸å¿ƒé€»è¾‘</strong>ï¼šä¹Ÿå«äºŒçº§ç´¢å¼•/è¾…åŠ©ç´¢å¼•ï¼Œå¶å­èŠ‚ç‚¹ä¸å­˜å‚¨æ•°æ®è¡Œï¼Œè€Œæ˜¯å­˜å‚¨<strong>èšç°‡ç´¢å¼•çš„ä¸»é”®å€¼</strong>ã€‚</li>
<li><strong>æŸ¥è¯¢æµç¨‹</strong>ï¼šé€šè¿‡éèšç°‡ç´¢å¼•æŸ¥è¯¢æ—¶ï¼Œå…ˆæ‰¾åˆ°ä¸»é”®å€¼ï¼Œå†é€šè¿‡ä¸»é”®å€¼æŸ¥è¯¢èšç°‡ç´¢å¼•è·å–å®Œæ•´æ•°æ®ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸º<strong>å›è¡¨</strong>ã€‚</li>
</ul>
<h4 data-id="heading-17">3.3 ä¸ºä»€ä¹ˆéèšç°‡ç´¢å¼•å¶å­èŠ‚ç‚¹å­˜ä¸»é”®å€¼ï¼Ÿ</h4>
<p>æ ¸å¿ƒç›®çš„æ˜¯<strong>é™ä½ç´¢å¼•ç»´æŠ¤æˆæœ¬</strong>ï¼šå½“æ•°æ®è¡Œå› é¡µåˆ†è£‚ç­‰åŸå› å‘ç”Ÿç‰©ç†ä½ç½®ç§»åŠ¨æ—¶ï¼Œåªéœ€æ›´æ–°èšç°‡ç´¢å¼•çš„å­˜å‚¨ä½ç½®ï¼Œéèšç°‡ç´¢å¼•æ— éœ€ä¿®æ”¹â€”â€”å› ä¸ºå®ƒå­˜å‚¨çš„æ˜¯é€»è¾‘ä¸»é”®å€¼ï¼Œè€Œéç‰©ç†åœ°å€ã€‚</p>
<h3 data-id="heading-18">å››ã€ ç´¢å¼•åˆ›å»ºé»„é‡‘åŸåˆ™</h3>
<p>ç´¢å¼•å¹¶éè¶Šå¤šè¶Šå¥½ï¼Œåˆç†çš„ç´¢å¼•è®¾è®¡éœ€å…¼é¡¾æŸ¥è¯¢æ€§èƒ½å’Œç»´æŠ¤æˆæœ¬ï¼Œéµå¾ªä»¥ä¸‹åŸåˆ™ï¼š</p>
<ol>
<li><strong>å°è¡¨ä¸å»ºç´¢å¼•</strong>ï¼šæ•°æ®é‡å°æ—¶ï¼Œå…¨è¡¨æ‰«æé€Ÿåº¦æ¯”ç´¢å¼•æŸ¥è¯¢æ›´å¿«ï¼Œå»ºç´¢å¼•åè€Œå¢åŠ å¼€é”€ã€‚</li>
<li><strong>é«˜é¢‘æŸ¥è¯¢å­—æ®µä¼˜å…ˆå»ºç´¢å¼•</strong>ï¼šå°†ç´¢å¼•ç”¨äº WHERE æ¡ä»¶ã€æ’åºã€è¡¨è¿æ¥çš„æ ¸å¿ƒå­—æ®µã€‚</li>
<li><strong>é«˜é¢‘æ›´æ–°å­—æ®µæ…å»ºç´¢å¼•</strong>ï¼šç´¢å¼•ä¼šå¢åŠ æ•°æ®æ’å…¥ã€æ›´æ–°ã€åˆ é™¤çš„ç»´æŠ¤æˆæœ¬ï¼Œæ›´æ–°é¢‘ç¹çš„å­—æ®µï¼ˆå¦‚è®¢å•çŠ¶æ€ï¼‰ä¸å®œå»ºç´¢å¼•ã€‚</li>
<li><strong>åŒºåˆ†åº¦ä½çš„å­—æ®µä¸å»ºç´¢å¼•</strong>ï¼šå¦‚æ€§åˆ«ã€çŠ¶æ€å­—æ®µï¼ŒåŸºæ•°å¤ªå°ï¼Œç´¢å¼•è¿‡æ»¤æ•ˆæœå·®ï¼Œå…¨è¡¨æ‰«ææ›´é«˜æ•ˆã€‚</li>
<li><strong>ä¼˜å…ˆç»„åˆç´¢å¼•ï¼Œé¿å…å†—ä½™ç´¢å¼•</strong>ï¼šç»„åˆç´¢å¼•å¯è¦†ç›–å¤šå­—æ®µæŸ¥è¯¢ï¼Œå‡å°‘ç´¢å¼•æ•°é‡ï¼›é¿å…åˆ›å»ºåŠŸèƒ½é‡å¤çš„ç´¢å¼•ï¼ˆå¦‚å·²æœ‰ (a,b)ï¼Œæ— éœ€å†å»º (a)ï¼‰ã€‚</li>
<li><strong>å­—ç¬¦ä¸²å­—æ®µç”¨å‰ç¼€ç´¢å¼•</strong>ï¼šå¯¹é•¿å­—ç¬¦ä¸²å­—æ®µï¼Œå¯åªå¯¹å‰ N ä¸ªå­—ç¬¦å»ºç´¢å¼•ï¼ˆå¦‚ <code>idx_prefix_name ON user(name(10))</code>ï¼‰ï¼Œå‡å°‘ç´¢å¼•å­˜å‚¨ç©ºé—´ã€‚</li>
<li><strong>å°½é‡ä¿è¯ç´¢å¼•åˆ—éç©º</strong>ï¼šNULL å€¼ä¼šé™ä½ç´¢å¼•æ•ˆç‡ï¼Œå¯é€šè¿‡é»˜è®¤å€¼ï¼ˆå¦‚ 0ã€ç©ºå­—ç¬¦ä¸²ï¼‰æ›¿ä»£ NULLã€‚</li>
</ol>
<h3 data-id="heading-19">äº”ã€ ç´¢å¼•å¤±æ•ˆåå¤§åœºæ™¯åŠé¿å‘æ–¹æ¡ˆ</h3>
<p>ç´¢å¼•å¤±æ•ˆæ˜¯æ•°æ®åº“æ€§èƒ½é—®é¢˜çš„é«˜å‘åŒºï¼Œä»¥ä¸‹æ˜¯æœ€å¸¸è§çš„å¤±æ•ˆåœºæ™¯åŠè§£å†³æ–¹æ¡ˆï¼š</p>
<ol>
<li>
<p><strong>è¿åæœ€å·¦å‰ç¼€åŸåˆ™</strong></p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼šç»„åˆç´¢å¼• (a,b,c)ï¼ŒæŸ¥è¯¢æ¡ä»¶ä¸º <code>b=2</code> æˆ– <code>c=3</code>ã€‚</li>
<li><strong>æ–¹æ¡ˆ</strong>ï¼šæŸ¥è¯¢æ¡ä»¶å¿…é¡»åŒ…å«ç»„åˆç´¢å¼•çš„æœ€å·¦åˆ—ï¼Œå¦‚ <code>a=1 AND b=2</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>LIKE é€šé…ç¬¦ä»¥ % å¼€å¤´</strong></p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼š<code>SELECT * FROM user WHERE name LIKE '%tom'</code>ã€‚</li>
<li><strong>æ–¹æ¡ˆ</strong>ï¼šé¿å…å·¦æ¨¡ç³ŠåŒ¹é…ï¼Œæ”¹ä¸ºå³æ¨¡ç³Š <code>LIKE 'tom%'</code>ï¼›è‹¥éœ€å…¨æ¨¡ç³ŠåŒ¹é…ï¼Œè€ƒè™‘å…¨æ–‡ç´¢å¼•ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç´¢å¼•åˆ—å‚ä¸è®¡ç®—æˆ–å‡½æ•°æ“ä½œ</strong></p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼š<code>SELECT * FROM user WHERE id + 1 = 100</code>ã€<code>WHERE DATE(create_time) = '2026-01-01'</code>ã€‚</li>
<li><strong>æ–¹æ¡ˆ</strong>ï¼šå°†è®¡ç®—é€»è¾‘ç§»åˆ°ç­‰å·å³ä¾§ï¼Œå¦‚ <code>id = 99</code>ï¼›MySQL 8.0+ å¯åˆ›å»ºå‡½æ•°ç´¢å¼•ã€‚</li>
</ul>
</li>
<li>
<p><strong>OR æ¡ä»¶ä¸¤ä¾§å­—æ®µæœªå…¨éƒ¨å»ºç´¢å¼•</strong></p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼š<code>SELECT * FROM user WHERE id=1 OR age=18</code>ï¼ˆä»… id æœ‰ç´¢å¼•ï¼‰ã€‚</li>
<li><strong>æ–¹æ¡ˆ</strong>ï¼šç¡®ä¿ OR ä¸¤ä¾§å­—æ®µéƒ½æœ‰ç´¢å¼•ï¼Œæˆ–æ”¹ç”¨ UNION åˆå¹¶ç»“æœã€‚</li>
</ul>
</li>
<li>
<p><strong>å­—æ®µç±»å‹ä¸åŒ¹é…</strong></p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼šç´¢å¼•å­—æ®µ <code>id</code> ä¸º VARCHAR ç±»å‹ï¼ŒæŸ¥è¯¢æ—¶å†™ <code>WHERE id=123</code>ï¼ˆæœªåŠ å¼•å·ï¼‰ã€‚</li>
<li><strong>æ–¹æ¡ˆ</strong>ï¼šä¿è¯æŸ¥è¯¢å€¼ä¸å­—æ®µç±»å‹ä¸€è‡´ï¼Œå¦‚ <code>WHERE id='123'</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>ä½¿ç”¨ä¸æ”¯æŒç´¢å¼•çš„æ“ä½œç¬¦</strong></p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼š<code>!=</code>ã€<code>&lt;&gt;</code>ã€<code>NOT IN</code>ã€<code>NOT EXISTS</code> ç­‰ã€‚</li>
<li><strong>æ–¹æ¡ˆ</strong>ï¼šå°½é‡ç”¨ç­‰å€¼æŸ¥è¯¢æ›¿ä»£ï¼Œå¦‚ç”¨ <code>IN</code> æ›¿ä»£ <code>NOT IN</code>ï¼Œæˆ–è°ƒæ•´æŸ¥è¯¢é€»è¾‘ã€‚</li>
</ul>
</li>
<li>
<p><strong>IS NULL / IS NOT NULL æ»¥ç”¨</strong></p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼šå¯¹å…è®¸ NULL çš„ç´¢å¼•åˆ—æ‰§è¡Œ <code>WHERE column IS NULL</code>ã€‚</li>
<li><strong>æ–¹æ¡ˆ</strong>ï¼šç´¢å¼•åˆ—å°½é‡è®¾ä¸ºéç©ºï¼›è‹¥å¿…é¡»æŸ¥è¯¢ NULL å€¼ï¼Œå¯é€šè¿‡ <code>EXPLAIN</code> éªŒè¯ç´¢å¼•æ˜¯å¦ç”Ÿæ•ˆã€‚</li>
</ul>
</li>
<li>
<p><strong>è¡¨å…³è”å­—æ®µç¼–ç ä¸ä¸€è‡´</strong></p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼šA è¡¨ <code>name</code> å­—æ®µä¸º utf8ï¼ŒB è¡¨ <code>name</code> å­—æ®µä¸º utf8mb4ï¼Œå…³è”æŸ¥è¯¢æ—¶ç´¢å¼•å¤±æ•ˆã€‚</li>
<li><strong>æ–¹æ¡ˆ</strong>ï¼šä¿è¯å…³è”å­—æ®µçš„å­—ç¬¦é›†å’Œæ’åºè§„åˆ™ä¸€è‡´ã€‚</li>
</ul>
</li>
<li>
<p><strong>ä¼˜åŒ–å™¨é€‰æ‹©å…¨è¡¨æ‰«æ</strong></p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼šç´¢å¼•åˆ—åŒºåˆ†åº¦æä½ï¼Œä¼˜åŒ–å™¨åˆ¤æ–­å…¨è¡¨æ‰«ææ¯”ç´¢å¼•æŸ¥è¯¢æ›´å¿«ã€‚</li>
<li><strong>æ–¹æ¡ˆ</strong>ï¼šé€šè¿‡ <code>FORCE INDEX</code> å¼ºåˆ¶ä½¿ç”¨ç´¢å¼•ï¼Œæˆ–ä¼˜åŒ–ç´¢å¼•å­—æ®µçš„åŒºåˆ†åº¦ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç´¢å¼•åˆ—å‚ä¸åˆ—å¯¹æ¯”</strong></p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼š<code>SELECT * FROM test WHERE a = b</code>ï¼ˆaã€b å‡ä¸ºç´¢å¼•åˆ—ï¼‰ã€‚</li>
<li><strong>æ–¹æ¡ˆ</strong>ï¼šé¿å…åˆ—ä¸åˆ—ç›´æ¥å¯¹æ¯”ï¼Œå¯é€šè¿‡ä¸šåŠ¡é€»è¾‘è°ƒæ•´æŸ¥è¯¢æ¡ä»¶ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-20">å…­ã€ æ€»ç»“</h3>
<p>MySQL ç´¢å¼•æ˜¯æ€§èƒ½ä¼˜åŒ–çš„æ ¸å¿ƒå·¥å…·ï¼Œå…¶æœ¬è´¨æ˜¯<strong>ç”¨ç©ºé—´æ¢æ—¶é—´</strong>ã€‚å¼€å‘è€…éœ€æ ¹æ®ä¸šåŠ¡åœºæ™¯ï¼Œä»<strong>æ•°æ®ç»“æ„</strong>ã€<strong>åŠŸèƒ½ç”¨é€”</strong>ã€<strong>å­˜å‚¨æ–¹å¼</strong>ä¸‰ä¸ªç»´åº¦é€‰æ‹©åˆé€‚çš„ç´¢å¼•ç±»å‹ï¼ŒåŒæ—¶éµå¾ªåˆ›å»ºåŸåˆ™ã€è§„é¿å¤±æ•ˆåœºæ™¯ï¼Œæ‰èƒ½æœ€å¤§åŒ–å‘æŒ¥ç´¢å¼•çš„æ€§èƒ½ä¼˜åŠ¿ã€‚</p>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œé€šè¿‡ <code>EXPLAIN</code> å‘½ä»¤åˆ†ææŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ï¼ŒéªŒè¯ç´¢å¼•æ˜¯å¦æœ‰æ•ˆä½¿ç”¨â€”â€”è¿™æ˜¯æ’æŸ¥ç´¢å¼•é—®é¢˜çš„æœ€ä½³å®è·µã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ç†è§£ InnoDB çš„ MVCCï¼šä¸æ˜¯ä¹è§‚é”ï¼Œæ˜¯æ›´ä¼˜é›…çš„å¹¶å‘æ§åˆ¶æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7595894884957634611</link>    <guid>https://juejin.cn/post/7595894884957634611</guid>    <pubDate>2026-01-17T15:51:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595894884957634611" data-draft-id="7595800318517952518" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ç†è§£ InnoDB çš„ MVCCï¼šä¸æ˜¯ä¹è§‚é”ï¼Œæ˜¯æ›´ä¼˜é›…çš„å¹¶å‘æ§åˆ¶æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="MySQL"/> <meta itemprop="datePublished" content="2026-01-17T15:51:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸‰æ°´ä¸æ»´"/> <meta itemprop="url" content="https://juejin.cn/user/283045639753100"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ç†è§£ InnoDB çš„ MVCCï¼šä¸æ˜¯ä¹è§‚é”ï¼Œæ˜¯æ›´ä¼˜é›…çš„å¹¶å‘æ§åˆ¶æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/283045639753100/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸‰æ°´ä¸æ»´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T15:51:38.000Z" title="Sat Jan 17 2026 15:51:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»19åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ·±å…¥ç†è§£InnoDBçš„MVCCï¼šä¸æ˜¯ä¹è§‚é”ï¼Œæ˜¯æ›´ä¼˜é›…çš„å¹¶å‘æ§åˆ¶æ–¹æ¡ˆ</h2>
<p>MVCCï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰å¸¸è¢«è¯¯å½’ä¸ºä¹è§‚é”çš„å®ç°ï¼Œå®åˆ™äºŒè€…æ ¸å¿ƒè®¾è®¡æ€è·¯ä¸å®ç°é€»è¾‘æˆªç„¶ä¸åŒã€‚ä¹è§‚é”ä¸æ‚²è§‚é”æ˜¯é”æœºåˆ¶çš„è®¾è®¡æ€æƒ³ï¼Œè€ŒMVCCæ˜¯InnoDBä¸ºå®ç°äº‹åŠ¡éš”ç¦»ã€æå‡è¯»å†™å¹¶å‘æ€§èƒ½æ‰“é€ çš„ç‹¬ç«‹å¹¶å‘æ§åˆ¶ä½“ç³»ï¼Œé€šè¿‡ç‰ˆæœ¬æ§åˆ¶ä¸å¯è§æ€§ç®—æ³•ï¼Œä»æ ¹æœ¬ä¸Šå‡å°‘é”çš„ä¾èµ–ï¼Œå®ç°é«˜æ•ˆçš„è¯»å†™å¹¶è¡Œã€‚</p>
<p>æœ¬æ–‡å°†ä»é”æœºåˆ¶åŸºç¡€å‡ºå‘ï¼Œæ·±å…¥æ‹†è§£InnoDB MVCCçš„æ ¸å¿ƒåŸç†ã€å®ç°ç»„ä»¶ä¸å·¥ä½œæµç¨‹ï¼Œå˜æ¸…å…¶ä¸é”æœºåˆ¶çš„åŒºåˆ«ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€æ•°æ®åº“å¹¶å‘æ§åˆ¶åŸºç¡€ï¼šé”æœºåˆ¶çš„æ ¸å¿ƒåˆ†ç±»</h2>
<p>å¹¶å‘æ§åˆ¶æ˜¯ä¿è¯å¤šäº‹åŠ¡å¹¶è¡Œæ‰§è¡Œæ—¶æ•°æ®ä¸€è‡´æ€§çš„æ ¸å¿ƒï¼Œä¼ ç»Ÿæ–¹æ¡ˆä¾èµ–é”æœºåˆ¶ï¼ŒæŒ‰æ“ä½œç±»å‹å’Œè®¾è®¡æ€æƒ³å¯åˆ†ä¸ºä¸¤ç±»æ ¸å¿ƒåˆ’åˆ†ï¼Œä¹Ÿæ˜¯ç†è§£MVCCçš„å‰æã€‚</p>
<h3 data-id="heading-2">1. æŒ‰æ•°æ®åº“æ“ä½œç±»å‹åˆ’åˆ†</h3>
<p>é”çš„æ–½åŠ ä¸æ“ä½œç±»å‹å¼ºç›¸å…³ï¼Œä¸åŒè¯­å¥å¯¹åº”ä¸åŒé”ç±»å‹ï¼Œä¿éšœæ“ä½œçš„æ’ä»–æ€§æˆ–å…±äº«æ€§ï¼š</p>
<p><strong>1.è¯»é”ï¼š</strong> é’ˆå¯¹DQLæŸ¥è¯¢è¯­å¥ï¼ˆå¦‚SELECTï¼‰ï¼Œå…±äº«é”ï¼Œå¤šä¸ªäº‹åŠ¡å¯åŒæ—¶åŠ è¯»é”ï¼Œäº’ä¸é˜»å¡ã€‚</p>
<p><strong>2.å†™é”ï¼š</strong> é’ˆå¯¹DMLæ“ä½œè¯­å¥ï¼ˆå¦‚INSERT/UPDATE/DELETEï¼‰ï¼Œæ’ä»–é”ï¼ŒåŒä¸€èµ„æºä»…èƒ½è¢«ä¸€ä¸ªäº‹åŠ¡åŠ å†™é”ï¼Œé˜»å¡å…¶ä»–è¯»å†™æ“ä½œã€‚</p>
<p><strong>3.å…ƒæ•°æ®é”ï¼š</strong> é’ˆå¯¹DDLå®šä¹‰è¯­å¥ï¼ˆå¦‚CREATE/DROP TABLEï¼‰ï¼Œé”å®šè¡¨ç»“æ„ï¼Œé˜²æ­¢ç»“æ„ä¿®æ”¹ä¸æ•°æ®æ“ä½œå¹¶å‘å†²çªã€‚</p>
<h3 data-id="heading-3">2. æŒ‰è®¾è®¡æ€æƒ³åˆ’åˆ†ï¼šæ‚²è§‚é” vs ä¹è§‚é”</h3>
<p>è¿™æ˜¯é”æœºåˆ¶çš„ä¸¤å¤§æ ¸å¿ƒè®¾è®¡æ€è·¯ï¼Œæ ¸å¿ƒå·®å¼‚åœ¨äºæ˜¯å¦é¢„è®¾å¹¶å‘å†²çªï¼Œå†³å®šäº†åŠ é”æ—¶æœºä¸å†²çªå¤„ç†æ–¹å¼ï¼Œä¹Ÿæ˜¯æ˜“ä¸MVCCæ··æ·†çš„å…³é”®ç‚¹ã€‚</p>
<blockquote>
<h4 data-id="heading-4">æ‚²è§‚é”</h4>
<ul>
<li>æ ¸å¿ƒå‡è®¾ï¼šé¢„è®¾ä¼šå‘ç”Ÿå¹¶å‘å†²çª</li>
<li>åŠ é”æ—¶æœºï¼šæ“ä½œèµ„æºå‰ä¸»åŠ¨åŠ é”</li>
<li>å†²çªå¤„ç†ï¼šé”å®šèµ„æºåï¼Œå…¶ä»–äº‹åŠ¡ç›´æ¥é˜»å¡</li>
<li>å®ç°æ–¹å¼ï¼šè¡Œçº§é”ã€è¡¨çº§é”ã€Java synchronized ç­‰</li>
<li>æ€§èƒ½å¼€é”€ï¼šåŠ é”/è§£é” + é˜»å¡ç­‰å¾…ï¼Œå¼€é”€è¾ƒå¤§</li>
<li>é€‚ç”¨åœºæ™¯ï¼šå¹¶å‘å†²çª<strong>é¢‘ç¹</strong>çš„å†™å¤šè¯»å°‘åœºæ™¯</li>
</ul>
</blockquote>
<blockquote>
<h4 data-id="heading-5">ä¹è§‚é”</h4>
<ul>
<li>æ ¸å¿ƒå‡è®¾ï¼šé¢„è®¾ä¸ä¼šå‘ç”Ÿå¹¶å‘å†²çª</li>
<li>åŠ é”æ—¶æœºï¼šå…¨ç¨‹ä¸åŠ é”ï¼Œæ— é”æ“ä½œ</li>
<li>å†²çªå¤„ç†ï¼šæ“ä½œå®Œæˆåï¼Œé€šè¿‡æ ¡éªŒåˆ¤æ–­æ˜¯å¦å†²çª</li>
<li>å®ç°æ–¹å¼ï¼šç‰ˆæœ¬å·æœºåˆ¶ï¼ŒCASåŸå­æ“ä½œ</li>
<li>æ€§èƒ½å¼€é”€ï¼šæ— é”å¼€é”€ï¼Œä»…éœ€æ ¡éªŒï¼Œè½»é‡çº§</li>
<li>é€‚ç”¨åœºæ™¯ï¼šå¹¶å‘å†²çª<strong>è¾ƒå°‘</strong>çš„è¯»å¤šå†™å°‘åœºæ™¯</li>
</ul>
</blockquote>
<p>ç®€å•æ¥è¯´ï¼Œæ‚²è§‚é”æ˜¯ <strong>â€œå…ˆé”åæ“ä½œï¼Œé˜»å¡å¼</strong>â€ï¼Œä¹è§‚é”æ˜¯ <strong>â€œå…ˆæ“ä½œåæ ¡éªŒï¼Œéé˜»å¡å¼â€</strong> ï¼Œä½†äºŒè€…å‡å±äºé”æœºåˆ¶èŒƒç•´ï¼Œè€ŒMVCCè·³å‡ºäº†è¿™ä¸€æ¡†æ¶ï¼Œé€šè¿‡å¤šç‰ˆæœ¬æ•°æ®å®ç°æ— é”è¯»ã€‚</p>
<h2 data-id="heading-6">äºŒã€MVCCçš„æ ¸å¿ƒå®šä½ï¼šä¸ºä½•éœ€è¦ç‹¬ç«‹çš„å¹¶å‘æ§åˆ¶ä½“ç³»ï¼Ÿ</h2>
<p>ä¼ ç»Ÿé”æœºåˆ¶å­˜åœ¨ä¸€ä¸ªè‡´å‘½é—®é¢˜ï¼š<strong>è¯»å†™äº’æ–¥</strong>ã€‚</p>
<p>å³ä½¿æ˜¯ä¹è§‚é”ï¼Œå†™æ“ä½œä»éœ€é€šè¿‡æ ¡éªŒä¿è¯åŸå­æ€§ï¼Œè¯»æ“ä½œè‹¥è¦è·å–æœ€æ–°æ•°æ®ï¼Œä»å¯èƒ½è¢«å†™æ“ä½œé˜»å¡ï¼›è€Œæ‚²è§‚é”çš„è¯»å†™äº’æ–¥åˆ™æ›´ä¸ºä¸¥æ ¼ã€‚</p>
<p>åœ¨è¯»å¤šå†™å°‘çš„å®é™…ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œè¿™ç§äº’æ–¥ä¼šä¸¥é‡é™ä½å¹¶å‘æ€§èƒ½â€”â€”å¤§é‡è¯»æ“ä½œå› å°‘é‡å†™æ“ä½œè¢«é˜»å¡ï¼Œæ•°æ®åº“æ•´ä½“ååé‡å—é™ã€‚</p>
<p><strong>MVCCï¼ˆMulti-Version Concurrency Controlï¼Œå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰</strong> æ­£æ˜¯ä¸ºè§£å†³è¿™ä¸€é—®é¢˜è€Œç”Ÿï¼šä¸ºæ¯è¡Œæ•°æ®ç»´æŠ¤å¤šä¸ªå†å²ç‰ˆæœ¬ï¼Œè¯»æ“ä½œé€šè¿‡è¯»å–å†å²ç‰ˆæœ¬å®ç° <strong>â€œæ— é”å¿«ç…§è¯»â€</strong> ï¼Œå†™æ“ä½œä»…ä¿®æ”¹æœ€æ–°ç‰ˆæœ¬å¹¶è®°å½•å†å²ï¼Œä»æ ¹æœ¬ä¸Šå®ç°è¯»å†™åˆ†ç¦»ï¼Œè®©è¯»æ“ä½œä¸é˜»å¡å†™ã€å†™æ“ä½œä¸é˜»å¡è¯»ã€‚</p>
<p>ä½œä¸ºInnoDBå­˜å‚¨å¼•æ“çš„æ ¸å¿ƒç‰¹æ€§ï¼ŒMVCCä¸»è¦<strong>æœåŠ¡äºäº‹åŠ¡éš”ç¦»çº§åˆ«</strong>çš„å®ç°ï¼Œæ˜¯InnoDBæ”¯æŒé«˜å¹¶å‘è¯»å†™çš„åº•å±‚åŸºçŸ³ï¼Œå…¶æ ¸å¿ƒå¹¶éé”ï¼Œè€Œæ˜¯<strong>ç‰ˆæœ¬æ§åˆ¶+å¯è§æ€§</strong>åˆ¤æ–­ã€‚</p>
<h2 data-id="heading-7">ä¸‰ã€InnoDB MVCCçš„æ ¸å¿ƒå®ç°ç»„ä»¶ï¼šä¸‰å¤§æ ¸å¿ƒæ¨¡å—ååŒå·¥ä½œ</h2>
<p>InnoDBçš„MVCCå¹¶éå•ä¸€æœºåˆ¶ï¼Œè€Œæ˜¯ç”±éšè—å­—æ®µã€Undo Logã€Read Viewä¸‰å¤§æ ¸å¿ƒç»„ä»¶ååŒæ„æˆï¼Œä¸‰è€…å„å¸å…¶èŒï¼Œåˆ†åˆ«å®ç°ç‰ˆæœ¬æ ‡è¯†ã€å†å²ç‰ˆæœ¬å­˜å‚¨ã€å¯è§æ€§åˆ¤æ–­ï¼Œå…±åŒæ”¯æ’‘å¤šç‰ˆæœ¬æ•°æ®çš„ç®¡ç†ä¸è¯»å–ã€‚</p>
<h3 data-id="heading-8">1. éšè—ç³»ç»Ÿåˆ—ï¼šæ•°æ®ç‰ˆæœ¬çš„â€œèº«ä»½æ ‡è¯†â€</h3>
<p>InnoDBä¼šä¸ºè¡¨ä¸­æ¯ä¸€è¡Œè®°å½•è‡ªåŠ¨æ·»åŠ ä¸‰ä¸ªéšè—ç³»ç»Ÿåˆ—ï¼ˆRowIDä¸ºå¯é€‰ï¼‰ï¼Œæ— éœ€ç”¨æˆ·å®šä¹‰ï¼Œç”¨äºè®°å½•æ•°æ®çš„ç‰ˆæœ¬ä¿¡æ¯ã€åˆ é™¤çŠ¶æ€ä¸å†å²ç‰ˆæœ¬æŒ‡é’ˆï¼Œæ˜¯MVCCçš„åŸºç¡€æ ‡è¯†ã€‚</p>
<blockquote>
<h4 data-id="heading-9">DB_TRX_ID</h4>
<ul>
<li>æ ¸å¿ƒä½œç”¨ï¼šè®°å½•è¡Œæ•°æ®æœ€è¿‘ä¸€æ¬¡ä¿®æ”¹ï¼ˆæ’å…¥/æ›´æ–°ï¼‰çš„äº‹åŠ¡ID</li>
<li>è¯´æ˜ï¼šäº‹åŠ¡IDæ˜¯InnoDBè‡ªå¢çš„å”¯ä¸€æ ‡è¯†ï¼Œæ–°äº‹åŠ¡å¼€å¯æ—¶åˆ†é…å”¯ä¸€ID</li>
</ul>
</blockquote>
<blockquote>
<h4 data-id="heading-10">DB_ROLL_PTR</h4>
<ul>
<li>æ ¸å¿ƒä½œç”¨ï¼šå›æ»šæŒ‡é’ˆï¼ŒæŒ‡å‘è¯¥è®°å½•å¯¹åº”çš„Undo Log</li>
<li>è¯´æ˜ï¼šå½¢æˆUndo Logæ—¥å¿—é“¾ï¼Œé€šè¿‡æŒ‡é’ˆå¯è¿½æº¯æ•°æ®çš„æ‰€æœ‰å†å²ç‰ˆæœ¬</li>
</ul>
</blockquote>
<blockquote>
<h4 data-id="heading-11">è¡Œåˆ é™¤æ ‡è®°</h4>
<ul>
<li>æ ¸å¿ƒä½œç”¨ï¼šæ ‡è®°è¡Œæ˜¯å¦è¢«é€»è¾‘åˆ é™¤</li>
<li>è¯´æ˜ï¼šå¹¶éç‹¬ç«‹å­—æ®µï¼Œå­˜å‚¨åœ¨è®°å½•å¤´ä¿¡æ¯ä¸­ï¼ŒDELETEæ“ä½œä»…ä¿®æ”¹è¯¥æ ‡è®°ï¼Œä¸ç‰©ç†åˆ é™¤æ•°æ®</li>
</ul>
</blockquote>
<blockquote>
<h4 data-id="heading-12">RowID (å¯é€‰)Â </h4>
<ul>
<li>æ ¸å¿ƒä½œç”¨ï¼šéšè—è‡ªå¢ID</li>
<li>è¯´æ˜ï¼šä»…å½“è¡¨æœªæŒ‡å®šä¸»é”®/å”¯ä¸€éç©ºç´¢å¼•æ—¶ï¼ŒInnoDBè‡ªåŠ¨ç”Ÿæˆï¼Œä½œä¸ºè¡Œçš„å”¯ä¸€æ ‡è¯†</li>
</ul>
</blockquote>
<h3 data-id="heading-13">2. Undo Logï¼šæ•°æ®å†å²ç‰ˆæœ¬çš„â€œå­˜å‚¨ä»“åº“â€</h3>
<p>Undo Logï¼ˆå›æ»šæ—¥å¿—ï¼‰æ˜¯InnoDBå®ç°äº‹åŠ¡å›æ»šä¸MVCCçš„æ ¸å¿ƒæ—¥å¿—ï¼Œè®°å½•æ•°æ®ä¿®æ”¹å‰çš„æ—§ç‰ˆæœ¬ï¼Œé€šè¿‡DB_ROLL_PTRå½¢æˆæ—¥å¿—é“¾ï¼Œä¸ºå¿«ç…§è¯»æä¾›å†å²ç‰ˆæœ¬æ•°æ®ï¼ŒåŒæ—¶æ”¯æ’‘äº‹åŠ¡çš„<strong>åŸå­æ€§</strong>ã€‚</p>
<h4 data-id="heading-14">ï¼ˆ1ï¼‰Undo Logçš„ä¸¤å¤§æ ¸å¿ƒåŠŸèƒ½</h4>
<ul>
<li>äº‹åŠ¡å›æ»šï¼šå½“äº‹åŠ¡æœªæäº¤/è¢«å›æ»šæ—¶ï¼Œé€šè¿‡Undo Logæ¢å¤æ•°æ®åˆ°ä¿®æ”¹å‰çš„åŸå§‹çŠ¶æ€ï¼Œæ’¤é”€æœªæäº¤äº‹åŠ¡å¯¹æ•°æ®åº“çš„å½±å“ï¼Œä¿è¯äº‹åŠ¡åŸå­æ€§ã€‚</li>
<li>MVCCå¿«ç…§è¯»ï¼šä¿å­˜æ•°æ®çš„æ‰€æœ‰å†å²ç‰ˆæœ¬ï¼Œå…¶ä»–äº‹åŠ¡å¯é€šè¿‡DB_ROLL_PTRè¿½æº¯Undo Logï¼Œè¯»å–ç¬¦åˆå¯è§æ€§è¦æ±‚çš„å†å²ç‰ˆæœ¬ï¼Œå®ç°æ— é”è¯»ã€‚</li>
</ul>
<h4 data-id="heading-15">ï¼ˆ2ï¼‰Undo Logçš„å…³é”®ç‰¹æ€§</h4>
<ul>
<li>é€»è¾‘æ—¥å¿—ï¼šè®°å½•çš„æ˜¯é€»è¾‘æ“ä½œï¼Œè€Œéç‰©ç†æ•°æ®æœ¬èº«ã€‚ä¾‹å¦‚æ›´æ–°ä¸€è¡Œæ•°æ®ï¼ŒUndo Logè®°å½•â€œåå‘æ›´æ–°æ“ä½œâ€ï¼›åˆ é™¤ä¸€è¡Œæ•°æ®ï¼Œè®°å½•â€œæ’å…¥æ“ä½œâ€ï¼Œå›æ»šæ—¶æ‰§è¡Œåå‘æ“ä½œå³å¯æ¢å¤æ•°æ®ã€‚</li>
<li>å­˜å‚¨ä½ç½®ï¼šç»Ÿä¸€å­˜å‚¨åœ¨InnoDBçš„å›æ»šæ®µä¸­ï¼Œç”±å¼•æ“ç»Ÿä¸€ç®¡ç†ã€‚</li>
</ul>
<h4 data-id="heading-16">ï¼ˆ3ï¼‰Undo Logçš„åˆ†ç±»ä¸ç”Ÿå‘½å‘¨æœŸ</h4>
<p>æ ¹æ®æ“ä½œç±»å‹ï¼ŒUndo Logåˆ†ä¸ºä¸¤ç±»ï¼Œç”Ÿå‘½å‘¨æœŸå·®å¼‚æ˜¾è‘—ï¼Œç›´æ¥å½±å“æ•°æ®åº“å­˜å‚¨ä¸æ€§èƒ½ï¼š</p>
<ul>
<li>Insert Undo Logï¼šè®°å½•INSERTæ“ä½œçš„æ—¥å¿—ï¼Œä»…ç”¨äºäº‹åŠ¡å›æ»šã€‚äº‹åŠ¡æäº¤åå¯ç›´æ¥åˆ é™¤ï¼Œå› ä¸ºå…¶ä»–äº‹åŠ¡ä¸ä¼šè®¿é—®æ’å…¥çš„æ–°è¡Œçš„å†å²ç‰ˆæœ¬ã€‚</li>
<li>Update Undo Logï¼šè®°å½•UPDATE/DELETEæ“ä½œçš„æ—¥å¿—ï¼Œç”¨äºäº‹åŠ¡å›æ»šä¸MVCCå¿«ç…§è¯»ã€‚äº‹åŠ¡æäº¤åä»éœ€ä¿ç•™ï¼Œç›´åˆ°ç³»ç»Ÿä¸­æ²¡æœ‰æ¯”è¯¥æ—¥å¿—æ›´æ—©çš„Read Viewï¼ˆè¯»è§†å›¾ï¼‰ï¼Œæ‰ä¼šè¢«å¼•æ“æ¸…ç†ã€‚</li>
</ul>
<p><strong>é‡è¦é—®é¢˜ï¼š</strong> é•¿äº‹åŠ¡ä¼šå¯¼è‡´Update Undo Logæ— æ³•åŠæ—¶æ¸…ç†â€”â€”å› ä¸ºé•¿äº‹åŠ¡ç”Ÿæˆçš„Read Viewä¼šä¸€ç›´ä¾èµ–æ—§ç‰ˆæœ¬çš„Undo Logï¼Œæœ€ç»ˆé€ æˆå­˜å‚¨ç©ºé—´å ç”¨è¿‡å¤§ã€æ€§èƒ½ä¸‹é™ã€‚</p>
<p><strong>ä¼˜åŒ–å»ºè®®ï¼š</strong> ä¸šåŠ¡ä¸­ä¸¥æ ¼é¿å…é•¿æ—¶é—´æœªæäº¤çš„äº‹åŠ¡ï¼ŒåŠæ—¶é‡Šæ”¾Read Viewä¾èµ–ã€‚</p>
<h3 data-id="heading-17">3. Read Viewï¼šæ•°æ®ç‰ˆæœ¬çš„â€œå¯è§æ€§è£åˆ¤â€</h3>
<p>Read Viewï¼ˆè¯»è§†å›¾ï¼‰æ˜¯äº‹åŠ¡æ‰§è¡Œå¿«ç…§è¯»æ—¶ç”Ÿæˆçš„ä¸€è‡´æ€§å¿«ç…§ï¼Œæœ¬è´¨æ˜¯ä¸€ç»„å…ƒæ•°æ®é›†åˆï¼Œç”¨äºåˆ¤æ–­å½“å‰äº‹åŠ¡å¯¹å“ªäº›æ•°æ®ç‰ˆæœ¬å¯è§ï¼Œæ˜¯MVCCå®ç°äº‹åŠ¡éš”ç¦»çš„æ ¸å¿ƒï¼Œå†³å®šäº†ä¸åŒäº‹åŠ¡èƒ½çœ‹åˆ°çš„æ•°æ®ç‰ˆæœ¬èŒƒå›´ã€‚</p>
<h4 data-id="heading-18">ï¼ˆ1ï¼‰Read Viewçš„æ ¸å¿ƒç»„æˆ</h4>
<p>ç”ŸæˆRead Viewæ—¶ï¼Œä¼šè®°å½•å½“å‰æ•°æ®åº“çš„äº‹åŠ¡çŠ¶æ€ï¼ŒåŒ…å«ä¸‰ä¸ªå…³é”®å±æ€§ï¼š</p>
<ul>
<li>alive_trx_listï¼šå½“å‰ç³»ç»Ÿä¸­æ´»è·ƒçš„äº‹åŠ¡IDåˆ—è¡¨ï¼ˆæ‰€æœ‰æœªæäº¤çš„äº‹åŠ¡IDï¼‰ã€‚</li>
<li>up_limit_idï¼šalive_trx_listä¸­çš„æœ€å°äº‹åŠ¡IDï¼Œä»£è¡¨å½“å‰æœ€æ—©çš„æ´»è·ƒäº‹åŠ¡ã€‚</li>
<li>low_limit_idï¼šç³»ç»Ÿå½“å‰å·²åˆ†é…çš„æœ€å¤§äº‹åŠ¡ID+1ï¼Œä»£è¡¨ä¸‹ä¸€ä¸ªå³å°†å¼€å¯çš„äº‹åŠ¡IDã€‚</li>
</ul>
<h4 data-id="heading-19">ï¼ˆ2ï¼‰æ ¸å¿ƒå¯è§æ€§ç®—æ³•</h4>
<p>ç”ŸæˆRead Viewåï¼ŒInnoDBé€šè¿‡æ•°æ®è¡Œçš„DB_TRX_IDï¼ˆæœ€è¿‘ä¿®æ”¹äº‹åŠ¡IDï¼‰ä¸Read Viewçš„ä¸‰ä¸ªå±æ€§å¯¹æ¯”ï¼Œåˆ¤æ–­è¯¥æ•°æ®ç‰ˆæœ¬æ˜¯å¦å¯¹å½“å‰äº‹åŠ¡å¯è§ï¼Œå¯é‡å¤è¯»éš”ç¦»çº§åˆ«ä¸‹çš„åˆ¤æ–­é€»è¾‘ä¸ºæ ¸å¿ƒï¼ˆä¹Ÿæ˜¯InnoDBé»˜è®¤éš”ç¦»çº§åˆ«ï¼‰ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>è‹¥Â DB_TRX_ID &lt; up_limit_idÂ ï¼šè¯¥æ•°æ®ç‰ˆæœ¬åœ¨Read Viewç”Ÿæˆå‰å·²æäº¤ï¼Œå¯¹å½“å‰äº‹åŠ¡å¯è§ã€‚</li>
<li>è‹¥Â DB_TRX_ID &gt;= low_limit_idÂ ï¼šè¯¥æ•°æ®ç‰ˆæœ¬åœ¨Read Viewç”Ÿæˆåæ‰è¢«ä¿®æ”¹ï¼Œå¯¹å½“å‰äº‹åŠ¡ä¸å¯è§ã€‚</li>
<li>è‹¥Â DB_TRX_IDÂ åœ¨Â alive_trx_listÂ ä¸­ï¼šç”ŸæˆRead Viewæ—¶ï¼Œè¯¥ä¿®æ”¹äº‹åŠ¡ä»æœªæäº¤ï¼Œå¯¹å½“å‰äº‹åŠ¡ä¸å¯è§ã€‚</li>
<li>è‹¥ä»¥ä¸Šå‡ä¸æ»¡è¶³ï¼Œä¸”DB_ROLL_PTRä¸ä¸ºç©ºï¼šé€šè¿‡å›æ»šæŒ‡é’ˆè¿½æº¯Undo Logä¸­çš„æ›´æ—©å†å²ç‰ˆæœ¬ï¼Œé‡å¤ä¸Šè¿°åˆ¤æ–­ï¼Œç›´åˆ°æ‰¾åˆ°å¯è§ç‰ˆæœ¬æˆ–è¿½æº¯è‡³æœ€åŸå§‹ç‰ˆæœ¬ã€‚</li>
</ol>
<p>ç®€å•æ¥è¯´ï¼ŒRead Viewçš„æ ¸å¿ƒä½œç”¨æ˜¯ä¸ºäº‹åŠ¡åˆ’å®šä¸€ä¸ª <strong>â€œå¯è§èŒƒå›´â€</strong> ï¼Œä»…è®©äº‹åŠ¡çœ‹åˆ°è¯¥èŒƒå›´ä¹‹å†…çš„ã€å·²æäº¤çš„æ•°æ®ç‰ˆæœ¬ï¼Œä¿è¯å¿«ç…§è¯»çš„ä¸€è‡´æ€§ã€‚</p>
<h2 data-id="heading-20">å››ã€MVCCçš„ä¸¤å¤§æ ¸å¿ƒè¯»æ“ä½œï¼šå¿«ç…§è¯» vs å½“å‰è¯»</h2>
<p>InnoDBä¸­ï¼Œè¯»æ“ä½œåˆ†ä¸ºå¿«ç…§è¯»å’Œå½“å‰è¯»ï¼ŒäºŒè€…å‡æ”¯æŒMVCCï¼Œä½†åŠ é”ç­–ç•¥ã€æ•°æ®ç‰ˆæœ¬è¯»å–è§„åˆ™æˆªç„¶ä¸åŒï¼Œä¹Ÿæ˜¯MVCCå®ç° <strong>â€œè¯»å†™å¹¶è¡Œâ€</strong> çš„å…³é”®è®¾è®¡ã€‚</p>
<h3 data-id="heading-21">1. å¿«ç…§è¯»ï¼ˆSnapshot Readï¼‰</h3>
<p>æ™®é€šSELECTè¯­å¥çš„é»˜è®¤è¯»æ–¹å¼ï¼Œä¹Ÿæ˜¯MVCCçš„æ ¸å¿ƒåº”ç”¨åœºæ™¯ï¼Œå®ç°æ— é”è¯»ã€‚</p>
<ul>
<li>æ ¸å¿ƒç‰¹æ€§ï¼šè¯»å–çš„æ˜¯æ•°æ®çš„å¿«ç…§ç‰ˆæœ¬ï¼ˆå†å²ç‰ˆæœ¬ï¼‰ï¼Œå³äº‹åŠ¡å¿«ç…§ç”Ÿæˆæ—¶çš„æ•°æ®çŠ¶æ€ï¼Œè€Œéæœ€æ–°ç‰ˆæœ¬ã€‚</li>
<li>åŠ é”ç­–ç•¥ï¼šå…¨ç¨‹ä¸åŠ é”ï¼Œä¸ä¼šé˜»å¡å…¶ä»–äº‹åŠ¡çš„å†™æ“ä½œï¼Œä¹Ÿä¸ä¼šè¢«å†™æ“ä½œé˜»å¡ã€‚</li>
<li>æ•°æ®æ¥æºï¼šé€šè¿‡Undo Logè¿½æº¯å†å²ç‰ˆæœ¬ï¼Œç»“åˆRead Viewçš„å¯è§æ€§ç®—æ³•ç­›é€‰å¯è§ç‰ˆæœ¬ã€‚</li>
<li>é€‚ç”¨åœºæ™¯ï¼šæ™®é€šæŸ¥è¯¢ï¼Œæ— éœ€è·å–æœ€æ–°æ•°æ®ï¼Œè¿½æ±‚é«˜å¹¶å‘è¯»æ€§èƒ½ã€‚</li>
</ul>
<h3 data-id="heading-22">2. å½“å‰è¯»ï¼ˆCurrent Readï¼‰</h3>
<p>åŠ é”æŸ¥è¯¢/å†™æ“ä½œçš„è¯»æ–¹å¼ï¼Œç”¨äºè·å–æ•°æ®çš„æœ€æ–°ç‰ˆæœ¬ï¼Œä¿è¯æ“ä½œçš„åŸå­æ€§ä¸ä¸€è‡´æ€§ã€‚</p>
<ul>
<li>æ ¸å¿ƒç‰¹æ€§ï¼šè¯»å–çš„æ˜¯æ•°æ®çš„æœ€æ–°ç‰ˆæœ¬ï¼Œå¹¶å¯¹è¯»å–çš„æ•°æ®åŠ é”ï¼Œé˜²æ­¢å…¶ä»–äº‹åŠ¡åŒæ—¶ä¿®æ”¹ã€‚</li>
<li>åŠ é”ç­–ç•¥ï¼šå¿…é¡»åŠ é”ï¼ŒåŠ æ’ä»–é”ï¼ˆFOR UPDATEï¼‰æˆ–å…±äº«é”ï¼ˆLOCK IN SHARE MODEï¼‰ã€‚</li>
<li>é€‚ç”¨æ“ä½œï¼šSELECT ... FOR UPDATEã€SELECT ... LOCK IN SHARE MODEã€UPDATEã€DELETEã€INSERTï¼ˆå†™æ“ä½œå‰éœ€å…ˆè¯»å–æœ€æ–°æ•°æ®ï¼Œå±äºéšå¼å½“å‰è¯»ï¼‰ã€‚</li>
<li>ç‰¹ç‚¹ï¼šæ”¯æŒMVCCï¼Œä½†éœ€è¦é¢å¤–çš„é”æ“ä½œä¿è¯ä¸€è‡´æ€§ï¼Œè¯»å†™ä¹‹é—´ä»ä¼šäº’æ–¥ã€‚</li>
</ul>
<h3 data-id="heading-23">å¿«ç…§è¯»ä¸å½“å‰è¯»æ ¸å¿ƒå¯¹æ¯”</h3>
<blockquote>
<h4 data-id="heading-24">å¿«ç…§è¯»</h4>
<ul>
<li>æ“ä½œç¤ºä¾‹ï¼šæ™®é€šSELECT</li>
<li>æ˜¯å¦åŠ é”ï¼šä¸åŠ é”</li>
<li>è¯»å–ç‰ˆæœ¬ï¼šå†å²å¿«ç…§ç‰ˆæœ¬</li>
<li>æ•°æ®æ¥æºï¼šUndo Log + å¯è§æ€§ç®—æ³•</li>
<li>å¹¶å‘ç‰¹æ€§ï¼šè¯»ä¸é˜»å¡å†™ï¼Œå†™ä¸é˜»å¡è¯»</li>
<li>MVCCï¼šæ ¸å¿ƒåº”ç”¨ï¼Œæ— é”å®ç°</li>
</ul>
</blockquote>
<blockquote>
<h4 data-id="heading-25">å½“å‰è¯»</h4>
<ul>
<li>æ“ä½œç¤ºä¾‹ï¼šSELECTâ€¦FORã€UPDATEã€DELETE</li>
<li>æ˜¯å¦åŠ é”ï¼šåŠ æ’ä»–/å…±äº«é”</li>
<li>è¯»å–ç‰ˆæœ¬ï¼šæœ€æ–°æ•°æ®ç‰ˆæœ¬</li>
<li>æ•°æ®æ¥æºï¼šæ•°æ®åº“ä¸»è¡¨ï¼ˆæœ€æ–°æ•°æ®ï¼‰</li>
<li>å¹¶å‘ç‰¹æ€§ï¼šè¯»é˜»å¡å†™ï¼Œå†™é˜»å¡è¯»</li>
<li>MVCCï¼šæ”¯æŒï¼Œä½†éœ€ç»“åˆé”æœºåˆ¶</li>
</ul>
</blockquote>
<h2 data-id="heading-26">äº”ã€MVCCä¸äº‹åŠ¡éš”ç¦»çº§åˆ«çš„å…³è”ï¼šRead Viewç”Ÿæˆæ—¶æœºæ˜¯å…³é”®</h2>
<p>InnoDBçš„å››å¤§äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼ˆè¯»æœªæäº¤ã€è¯»å·²æäº¤ã€å¯é‡å¤è¯»ã€ä¸²è¡ŒåŒ–ï¼‰ï¼Œé™¤ä¸²è¡ŒåŒ–å¤–ï¼Œå…¶ä½™å‡åŸºäºMVCCå®ç°ï¼Œè€Œä¸åŒéš”ç¦»çº§åˆ«ä¸‹Read Viewçš„ç”Ÿæˆæ—¶æœºï¼Œæ˜¯å†³å®šéš”ç¦»çº§åˆ«ç‰¹æ€§çš„æ ¸å¿ƒï¼Œä¹Ÿæ˜¯MVCCå®ç°ä¸åŒä¸€è‡´æ€§ä¿éšœçš„å…³é”®ã€‚</p>
<h3 data-id="heading-27">1. è¯»æœªæäº¤ï¼ˆRead Uncommittedï¼‰</h3>
<ul>
<li>æ ¸å¿ƒç‰¹æ€§ï¼šä¸ä½¿ç”¨Read Viewï¼Œç›´æ¥è¯»å–æ•°æ®çš„æœ€æ–°ç‰ˆæœ¬ï¼Œå³ä½¿è¯¥ç‰ˆæœ¬ç”±æœªæäº¤äº‹åŠ¡ä¿®æ”¹ï¼ˆä¼šå‘ç”Ÿè„è¯»ï¼‰ã€‚</li>
<li>å®ç°ï¼šæ— éœ€Undo Logæ”¯æ’‘ï¼Œæ€§èƒ½æœ€é«˜ï¼Œä½†ä¸€è‡´æ€§æœ€å·®ï¼Œå®é™…ä¸šåŠ¡ä¸­å‡ ä¹ä¸ä½¿ç”¨ã€‚</li>
</ul>
<h3 data-id="heading-28">2. è¯»å·²æäº¤ï¼ˆRead Committedï¼‰</h3>
<ul>
<li>æ ¸å¿ƒç‰¹æ€§ï¼šæ¯æ¬¡å¿«ç…§è¯»éƒ½ä¼šç”Ÿæˆæ–°çš„Read Viewï¼Œå› æ­¤åŒä¸€äº‹åŠ¡å†…å¤šæ¬¡æŸ¥è¯¢ï¼Œç»“æœå¯èƒ½ä¸åŒï¼ˆé˜²æ­¢è„è¯»ï¼Œä¼šå‘ç”Ÿä¸å¯é‡å¤è¯»ï¼‰ã€‚</li>
<li>å¯è§æ€§ï¼šä»…èƒ½çœ‹åˆ°å½“å‰æŸ¥è¯¢å‰å·²æäº¤çš„æ•°æ®ç‰ˆæœ¬ï¼Œæœªæäº¤çš„ç‰ˆæœ¬å§‹ç»ˆä¸å¯è§ã€‚</li>
<li>é€‚ç”¨åœºæ™¯ï¼šå¯¹ä¸€è‡´æ€§è¦æ±‚ä¸€èˆ¬ï¼Œè¿½æ±‚è¯»æ€§èƒ½çš„åœºæ™¯ï¼Œä¹Ÿæ˜¯Oracleçš„é»˜è®¤éš”ç¦»çº§åˆ«ã€‚</li>
</ul>
<h3 data-id="heading-29">3. å¯é‡å¤è¯»ï¼ˆRepeatable Readï¼‰</h3>
<ul>
<li>æ ¸å¿ƒç‰¹æ€§ï¼šäº‹åŠ¡å¯åŠ¨æ—¶ç”Ÿæˆä¸€æ¬¡Read Viewï¼Œæ•´ä¸ªäº‹åŠ¡æœŸé—´å¤ç”¨è¯¥å¿«ç…§ï¼Œæ‰€æœ‰å¿«ç…§è¯»å‡åŸºäºæ­¤Read Viewï¼ˆé˜²æ­¢è„è¯»ã€ä¸å¯é‡å¤è¯»ï¼ŒInnoDBé€šè¿‡é—´éš™é”é¢å¤–é˜²æ­¢å¹»è¯»ï¼‰ã€‚</li>
<li>å¯è§æ€§ï¼šä»…èƒ½çœ‹åˆ°äº‹åŠ¡å¯åŠ¨å‰å·²æäº¤çš„æ•°æ®ç‰ˆæœ¬ï¼Œäº‹åŠ¡æœŸé—´å…¶ä»–äº‹åŠ¡æäº¤çš„ä¿®æ”¹ï¼Œå§‹ç»ˆä¸å¯è§ã€‚</li>
<li>ç‰¹ç‚¹ï¼šInnoDBé»˜è®¤éš”ç¦»çº§åˆ«ï¼Œå…¼é¡¾ä¸€è‡´æ€§ä¸å¹¶å‘æ€§èƒ½ï¼Œæ˜¯ä¸šåŠ¡ä¸­æœ€å¸¸ç”¨çš„çº§åˆ«ã€‚</li>
</ul>
<h3 data-id="heading-30">4. ä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰</h3>
<ul>
<li>æ ¸å¿ƒç‰¹æ€§ï¼šä¸ä½¿ç”¨Read Viewï¼Œæ”¾å¼ƒMVCCï¼Œé€šè¿‡åŠ é”å®ç°ä¸²è¡ŒåŒ–æ‰§è¡Œï¼Œæ‰€æœ‰è¯»æ“ä½œå‡åŠ å…±äº«é”ï¼Œå†™æ“ä½œåŠ æ’ä»–é”ï¼Œäº‹åŠ¡æŒ‰é¡ºåºæ‰§è¡Œã€‚</li>
<li>ä¸€è‡´æ€§ï¼šæœ€é«˜ï¼Œé˜²æ­¢è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»ï¼Œä½†å¹¶å‘æ€§èƒ½æœ€å·®ï¼Œä»…é€‚ç”¨äºå¹¶å‘å†²çªæå°‘çš„åœºæ™¯ã€‚</li>
</ul>
<p>æ ¸å¿ƒç»“è®ºï¼šMVCCä¸»è¦æ”¯æ’‘è¯»å·²æäº¤å’Œå¯é‡å¤è¯»ä¸¤ä¸ªéš”ç¦»çº§åˆ«ï¼ŒäºŒè€…çš„æ ¸å¿ƒå·®å¼‚ä»…åœ¨äºRead Viewçš„ç”Ÿæˆæ—¶æœºâ€”â€”æ¯æ¬¡æŸ¥è¯¢ç”Ÿæˆ vs äº‹åŠ¡å¯åŠ¨æ—¶ç”Ÿæˆä¸€æ¬¡ï¼Œè¿™ä¸€å¾®å°å·®å¼‚ï¼Œå†³å®šäº†éš”ç¦»çº§åˆ«çš„ä¸€è‡´æ€§ç‰¹æ€§ã€‚</p>
<h2 data-id="heading-31">å…­ã€InnoDB MVCCçš„å®Œæ•´å·¥ä½œæµç¨‹</h2>
<p>MVCCçš„ä¸‰å¤§æ ¸å¿ƒç»„ä»¶ï¼ˆéšè—å­—æ®µã€Undo Logã€Read Viewï¼‰ä¸ä¸¤å¤§è¯»æ“ä½œé…åˆï¼Œå½¢æˆä¸€å¥—å®Œæ•´çš„å¹¶å‘æ§åˆ¶æµç¨‹ï¼Œæ¶µç›–æ•°æ®ä¿®æ”¹ã€å¿«ç…§è¯»ã€äº‹åŠ¡æäº¤/å›æ»šå…¨ç”Ÿå‘½å‘¨æœŸï¼Œä»¥ä¸‹ä»¥å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ä¸ºä¾‹ï¼Œæ‹†è§£å®Œæ•´å·¥ä½œæµç¨‹ã€‚</p>
<h3 data-id="heading-32">é˜¶æ®µ1ï¼šäº‹åŠ¡ä¿®æ”¹æ•°æ®ï¼ˆINSERT/UPDATE/DELETEï¼‰</h3>
<ol>
<li>äº‹åŠ¡å¼€å¯ï¼ŒInnoDBä¸ºå…¶åˆ†é…å”¯ä¸€çš„äº‹åŠ¡IDï¼ˆDB_TRX_IDï¼‰ï¼›</li>
<li>æ‰§è¡Œä¿®æ”¹æ“ä½œå‰ï¼Œå…ˆå°†æ•°æ®çš„æ—§ç‰ˆæœ¬å†™å…¥Undo Logï¼Œç”Ÿæˆå¯¹åº”çš„Insert/Update Undo Logï¼›</li>
<li>æ›´æ–°æ•°æ®è¡Œçš„éšè—å­—æ®µï¼šå°†DB_TRX_IDæ”¹ä¸ºå½“å‰äº‹åŠ¡IDï¼ŒDB_ROLL_PTRæŒ‡å‘åˆšç”Ÿæˆçš„Undo Logï¼Œå½¢æˆæ—¥å¿—é“¾ï¼›</li>
<li>è‹¥ä¸ºDELETEæ“ä½œï¼Œä»…ä¿®æ”¹è¡Œåˆ é™¤æ ‡è®°ï¼Œä¸ç‰©ç†åˆ é™¤æ•°æ®ï¼Œæ—§ç‰ˆæœ¬å†™å…¥Update Undo Logã€‚</li>
</ol>
<h3 data-id="heading-33">é˜¶æ®µ2ï¼šäº‹åŠ¡æ‰§è¡Œå¿«ç…§è¯»ï¼ˆæ™®é€šSELECTï¼‰</h3>
<ol>
<li>äº‹åŠ¡é¦–æ¬¡æ‰§è¡Œå¿«ç…§è¯»æ—¶ï¼Œç”ŸæˆRead Viewï¼Œè®°å½•å½“å‰ç³»ç»Ÿçš„æ´»è·ƒäº‹åŠ¡åˆ—è¡¨ã€up_limit_idã€low_limit_idï¼›</li>
<li>è¯»å–æ•°æ®è¡Œçš„æœ€æ–°ç‰ˆæœ¬ï¼Œè·å–å…¶DB_TRX_IDï¼›</li>
<li>é€šè¿‡å¯è§æ€§ç®—æ³•åˆ¤æ–­è¯¥ç‰ˆæœ¬æ˜¯å¦å¯¹å½“å‰äº‹åŠ¡å¯è§ï¼šè‹¥å¯è§ï¼Œç›´æ¥è¿”å›è¯¥ç‰ˆæœ¬æ•°æ®ï¼›è‹¥ä¸å¯è§ï¼Œé€šè¿‡DB_ROLL_PTRè¿½æº¯Undo Logä¸­çš„å†å²ç‰ˆæœ¬ï¼Œé‡å¤å¯è§æ€§åˆ¤æ–­ï¼Œç›´åˆ°æ‰¾åˆ°å¯è§ç‰ˆæœ¬ï¼›</li>
<li>åŒä¸€äº‹åŠ¡å†…åç»­çš„å¿«ç…§è¯»ï¼Œå¤ç”¨å·²ç”Ÿæˆçš„Read Viewï¼Œä¿è¯è¯»å–ç»“æœä¸€è‡´ã€‚</li>
</ol>
<h3 data-id="heading-34">é˜¶æ®µ3ï¼šäº‹åŠ¡æäº¤/å›æ»š</h3>
<h4 data-id="heading-35">1.Â äº‹åŠ¡æäº¤ï¼š</h4>
<ul>
<li>Insert Undo Logï¼šç›´æ¥åˆ é™¤ï¼Œæ— éœ€ä¿ç•™ï¼›</li>
<li>Update Undo Logï¼šä¿ç•™ï¼Œç”¨äºæ”¯æ’‘å…¶ä»–äº‹åŠ¡çš„å¿«ç…§è¯»ï¼Œç›´åˆ°æ— æ›´æ—©çš„Read Viewä¾èµ–æ—¶è¢«å¼•æ“æ¸…ç†ï¼›</li>
</ul>
<h4 data-id="heading-36">2.Â äº‹åŠ¡å›æ»šï¼š</h4>
<ul>
<li>é€šè¿‡Undo Logä¸­çš„å†å²ç‰ˆæœ¬ï¼Œç»“åˆDB_ROLL_PTRè¿½æº¯ï¼Œå°†æ•°æ®æ¢å¤åˆ°ä¿®æ”¹å‰çš„çŠ¶æ€ï¼›</li>
<li>æ’¤é”€æ‰€æœ‰ä¿®æ”¹æ“ä½œï¼Œé‡Šæ”¾äº‹åŠ¡ç›¸å…³èµ„æºã€‚</li>
</ul>
<h2 data-id="heading-37">ä¸ƒã€MVCCä¸é”æœºåˆ¶çš„æ ¸å¿ƒå¯¹æ¯”ï¼šè·³å‡ºé”çš„æ¡†æ¶ï¼Œå®ç°æ›´ä¼˜å¹¶å‘</h2>
<p>MVCCä¸æ‚²è§‚é”/ä¹è§‚é”å‡ä¸ºå¹¶å‘æ§åˆ¶æ–¹æ¡ˆï¼Œä½†äºŒè€…å±äºä¸åŒçš„æŠ€æœ¯ä½“ç³»ï¼Œæ ¸å¿ƒç‰¹æ€§ã€å®ç°æ–¹å¼ã€é€‚ç”¨åœºæ™¯å·®å¼‚æ˜¾è‘—ï¼Œå˜æ¸…äºŒè€…åŒºåˆ«ï¼Œæ‰èƒ½çœŸæ­£ç†è§£MVCCçš„è®¾è®¡ä»·å€¼ã€‚</p>
<blockquote>
<h3 data-id="heading-38">é”æœºåˆ¶ï¼ˆæ‚²è§‚/ä¹è§‚ï¼‰</h3>
<ul>
<li>æ ¸å¿ƒè®¾è®¡ï¼šåŸºäºé”çš„å†²çªæ§åˆ¶ï¼›è¯»å†™äº’æ–¥/äº‹åæ ¡éªŒ</li>
<li>åŠ é”å¼€é”€ï¼šæ‚²è§‚é”åŠ é”å¼€é”€å¤§ï¼Œä¹è§‚é”æ— åŠ é”å¼€é”€ä½†éœ€æ ¡éªŒ</li>
<li>å¹¶å‘æ€§èƒ½ï¼šè¯»å†™äº’æ–¥ï¼Œæ˜“é˜»å¡ï¼Œå¹¶å‘æ€§èƒ½è¾ƒä½</li>
<li>å®ç°åŸºç¡€ï¼šæ•°æ®åº“é”æœºåˆ¶/CASåŸå­æ“ä½œ/ç‰ˆæœ¬å·</li>
<li>ç©ºé—´å¼€é”€ï¼šå‡ ä¹æ— é¢å¤–ç©ºé—´å¼€é”€</li>
<li>é€‚ç”¨åœºæ™¯ï¼šå†™å¤šè¯»å°‘/å†²çªé¢‘ç¹ï¼ˆæ‚²è§‚é”ï¼‰ï¼›è¯»å¤šå†™å°‘/å†²çªæå°‘ï¼ˆä¹è§‚é”ï¼‰</li>
</ul>
</blockquote>
<blockquote>
<h3 data-id="heading-39">MVCC</h3>
<ul>
<li>æ ¸å¿ƒè®¾è®¡ï¼šåŸºäºå¤šç‰ˆæœ¬çš„å¯è§æ€§æ§åˆ¶ï¼Œè¯»å†™åˆ†ç¦»</li>
<li>åŠ é”å¼€é”€ï¼šå¿«ç…§è¯»æ— åŠ é”å¼€é”€ï¼Œå½“å‰è¯»éœ€åŠ é”</li>
<li>å¹¶å‘æ€§èƒ½ï¼šå¿«ç…§è¯»ä¸é˜»å¡å†™ï¼Œå†™ä¸é˜»å¡è¯»ï¼Œè¯»å†™å¹¶è¡Œï¼Œå¹¶å‘æ€§èƒ½é«˜</li>
<li>å®ç°åŸºç¡€ï¼šéšè—å­—æ®µ + Undo Log + Read View</li>
<li>ç©ºé—´å¼€é”€ï¼šéœ€å­˜å‚¨Undo Logå†å²ç‰ˆæœ¬ï¼Œç©ºé—´å¼€é”€è¾ƒå¤§</li>
<li>é€‚ç”¨åœºæ™¯ï¼šè¯»å¤šå†™å°‘çš„è¯»å†™æ··åˆåœºæ™¯ï¼Œè¿½æ±‚é«˜å¹¶å‘è¯»æ€§èƒ½</li>
</ul>
</blockquote>
<h2 data-id="heading-40">å…«ã€MVCCçš„ä¼˜ç¼ºç‚¹ï¼šç†æ€§çœ‹å¾…å…¶è®¾è®¡ä»·å€¼</h2>
<p>MVCCæ˜¯InnoDBä¸ºè¯»å¤šå†™å°‘åœºæ™¯é‡èº«æ‰“é€ çš„æœ€ä¼˜è§£ï¼Œä½†å¹¶éä¸‡èƒ½ï¼Œå…¶ä¼˜ç‚¹ä¸å±€é™æ€§å‡æºäºæ ¸å¿ƒè®¾è®¡â€”â€”å¤šç‰ˆæœ¬æ•°æ®å­˜å‚¨ï¼Œéœ€ç»“åˆä¸šåŠ¡åœºæ™¯åˆç†ä½¿ç”¨ã€‚</p>
<h3 data-id="heading-41"><strong>ä¼˜ç‚¹ï¼šæ‰“é€ é«˜æ€§èƒ½çš„è¯»å†™å¹¶è¡Œä½“ç³»</strong></h3>
<ol>
<li>æè‡´æå‡å¹¶å‘æ€§èƒ½ï¼šå¿«ç…§è¯»æ— é”åŒ–ï¼Œä»æ ¹æœ¬ä¸Šè§£å†³äº†ä¼ ç»Ÿé”æœºåˆ¶çš„è¯»å†™äº’æ–¥é—®é¢˜ï¼Œè¯»æ“ä½œä¸é˜»å¡å†™ã€å†™æ“ä½œä¸é˜»å¡è¯»ï¼Œå¤§å¹…æå‡æ•°æ®åº“ååé‡ã€‚</li>
<li>å‡å°‘é”å¼€é”€ï¼šå¤§é‡è¯»æ“ä½œé€šè¿‡è¯»å–å†å²ç‰ˆæœ¬å®Œæˆï¼Œæ— éœ€åŠ é”/è§£é”ï¼Œé™ä½äº†é”æœºåˆ¶å¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚</li>
<li>åŸç”Ÿæ”¯æŒäº‹åŠ¡éš”ç¦»ï¼šé€šè¿‡Read Viewçš„ç”Ÿæˆæ—¶æœºä¸å¯è§æ€§ç®—æ³•ï¼ŒåŸç”Ÿå®ç°è¯»å·²æäº¤ã€å¯é‡å¤è¯»ä¸¤å¤§éš”ç¦»çº§åˆ«ï¼Œæ— éœ€é¢å¤–çš„é”ç­–ç•¥ã€‚</li>
<li>ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼šé€šè¿‡å¤šç‰ˆæœ¬ä¸å¯è§æ€§åˆ¤æ–­ï¼Œè®©äº‹åŠ¡çœ‹åˆ°ä¸€è‡´æ€§çš„å¿«ç…§æ•°æ®ï¼Œé¿å…è„è¯»ã€ä¸å¯é‡å¤è¯»ç­‰é—®é¢˜ã€‚</li>
</ol>
<h3 data-id="heading-42">å±€é™æ€§ï¼šè®¾è®¡å¸¦æ¥çš„å›ºæœ‰é—®é¢˜</h3>
<ol>
<li>é¢å¤–ç©ºé—´å¼€é”€ï¼šéœ€è¦å­˜å‚¨Undo Logçš„å†å²ç‰ˆæœ¬æ•°æ®ï¼Œéšç€äº‹åŠ¡çš„æ‰§è¡Œï¼ŒUndo Logä¼šä¸æ–­è†¨èƒ€ï¼Œå ç”¨ç£ç›˜ç©ºé—´ã€‚</li>
<li>é•¿äº‹åŠ¡æ€§èƒ½é—®é¢˜ï¼šé•¿äº‹åŠ¡çš„Read Viewä¼šæŒç»­ä¾èµ–æ—§ç‰ˆæœ¬çš„Undo Logï¼Œå¯¼è‡´å¼•æ“æ— æ³•åŠæ—¶æ¸…ç†ï¼Œä¸ä»…å ç”¨ç©ºé—´ï¼Œè¿˜ä¼šå¢åŠ å¿«ç…§è¯»æ—¶çš„ç‰ˆæœ¬è¿½æº¯å¼€é”€ã€‚</li>
<li>å†™æ“ä½œä»éœ€åŠ é”ï¼šMVCCä»…ä¼˜åŒ–è¯»æ“ä½œï¼Œå†™æ“ä½œï¼ˆINSERT/UPDATE/DELETEï¼‰ä»éœ€åŠ æ’ä»–é”ï¼Œå†™æ“ä½œé¢‘ç¹çš„åœºæ™¯ä¸‹ï¼ŒMVCCçš„ä¼˜åŠ¿ä¼šå¤§å¹…å‡å¼±ã€‚</li>
<li>ä»…é€‚ç”¨äºInnoDBï¼šMVCCæ˜¯InnoDBçš„å­˜å‚¨å¼•æ“ç‰¹æ€§ï¼ŒMyISAMç­‰å…¶ä»–å­˜å‚¨å¼•æ“ä¸æ”¯æŒï¼Œé€šç”¨æ€§æœ‰é™ã€‚</li>
</ol>
<h2 data-id="heading-43">ä¹ã€MVCCå¿«ç…§è¯»å®æˆ˜ç¤ºä¾‹ï¼šç›´è§‚ç†è§£å¤šç‰ˆæœ¬å¯è§æ€§</h2>
<p>é€šè¿‡ä¸€ä¸ªç®€å•çš„å¹¶å‘äº‹åŠ¡ç¤ºä¾‹ï¼Œç›´è§‚æ„Ÿå—MVCCå¿«ç…§è¯»çš„æ ¸å¿ƒç‰¹æ€§â€”â€”ä¸åŒäº‹åŠ¡çœ‹åˆ°ä¸åŒçš„æ•°æ®ç‰ˆæœ¬ï¼Œå†™æ“ä½œä¸é˜»å¡è¯»æ“ä½œã€‚</p>
<h3 data-id="heading-44">1. å‡†å¤‡è¡¨ç»“æ„ä¸æµ‹è¯•æ•°æ®</h3>
<blockquote>
<p>-- åˆ›å»ºè®¢å•è¡¨<br/>
<strong>CREATE TABLE orders (<br/>
id INT AUTO_INCREMENT PRIMARY KEY,<br/>
status VARCHAR(20) NOT NULL<br/>
);</strong><br/>
-- æ’å…¥æµ‹è¯•æ•°æ®<br/>
<strong>INSERT INTO orders (status) VALUES ('pending'), ('shipped'), ('delivered');</strong></p>
</blockquote>
<h3 data-id="heading-45">2. æ¨¡æ‹Ÿå¹¶å‘äº‹åŠ¡æ“ä½œ</h3>
<p>å¼€å¯ä¸¤ä¸ªäº‹åŠ¡Aå’ŒBï¼Œæ¨¡æ‹Ÿå¹¶å‘çš„ä¿®æ”¹ä¸æŸ¥è¯¢æ“ä½œï¼Œéš”ç¦»çº§åˆ«ä¸ºInnoDBé»˜è®¤çš„å¯é‡å¤è¯»ã€‚</p>
<blockquote>
<p>-- äº‹åŠ¡Aï¼šå¼€å¯äº‹åŠ¡ï¼Œæ‰§è¡Œå¿«ç…§è¯»ä¸ä¿®æ”¹<br/>
<strong>START TRANSACTION;</strong><br/>
-- å¿«ç…§è¯»ï¼šè¯»å–äº‹åŠ¡å¯åŠ¨æ—¶çš„å¿«ç…§ç‰ˆæœ¬ï¼Œæ­¤æ—¶id=1çš„statusä¸ºpending<br/>
<strong>SELECT * FROM orders;</strong><br/>
-- å½“å‰è¯»+ä¿®æ”¹ï¼šä¿®æ”¹id=1çš„statusä¸ºcancelledï¼ŒåŠ æ’ä»–é”ï¼Œå†™å…¥Undo Log<br/>
<strong>UPDATE orders SET status = 'cancelled' WHERE id = 1;</strong></p>
<p>-- äº‹åŠ¡Bï¼šåœ¨äº‹åŠ¡Aæœªæäº¤æ—¶ï¼Œå¼€å¯äº‹åŠ¡æ‰§è¡Œå¿«ç…§è¯»<br/>
<strong>START TRANSACTION;</strong><br/>
-- å¿«ç…§è¯»ï¼šè¯»å–çš„æ˜¯id=1ä¿®æ”¹å‰çš„å†å²ç‰ˆæœ¬ï¼Œstatusä»ä¸ºpendingï¼Œä¸å—äº‹åŠ¡Aä¿®æ”¹å½±å“<br/>
<strong>SELECT * FROM orders WHERE id = 1;</strong></p>
</blockquote>
<h3 data-id="heading-46">3. æ‰§è¡Œç»“æœåˆ†æ</h3>
<ul>
<li>äº‹åŠ¡Aï¼šåœ¨è‡ªèº«æœªæäº¤æ—¶ï¼Œèƒ½çœ‹åˆ°ä¿®æ”¹åçš„ç‰ˆæœ¬ï¼ˆcancelledï¼‰ï¼Œå› ä¸ºè‡ªèº«çš„ä¿®æ”¹å¯¹å½“å‰äº‹åŠ¡å¯è§ã€‚</li>
<li>äº‹åŠ¡Bï¼šåœ¨äº‹åŠ¡Aæäº¤å‰ï¼Œå§‹ç»ˆè¯»å–çš„æ˜¯ä¿®æ”¹å‰çš„å¿«ç…§ç‰ˆæœ¬ï¼ˆpendingï¼‰ï¼Œä¸ä¼šè¢«äº‹åŠ¡Açš„å†™æ“ä½œé˜»å¡ï¼Œå®ç°äº†â€œå†™ä¸é˜»å¡è¯»â€ã€‚</li>
<li>äº‹åŠ¡Aæäº¤åï¼Œäº‹åŠ¡Bçš„å¿«ç…§è¯»ä»ä¸ºpendingï¼ˆå¯é‡å¤è¯»ç‰¹æ€§ï¼‰ï¼Œç›´åˆ°äº‹åŠ¡Bæäº¤å¹¶é‡æ–°å¼€å¯ï¼Œæ‰èƒ½çœ‹åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚</li>
</ul>
<p>è¿™ä¸€ç¤ºä¾‹æ¸…æ™°ä½“ç°äº†MVCCçš„æ ¸å¿ƒä»·å€¼ï¼šå¤šç‰ˆæœ¬æ•°æ®è®©å¹¶å‘äº‹åŠ¡å®ç°æ•°æ®éš”ç¦»ï¼Œè¯»å†™æ“ä½œå¹¶è¡Œæ‰§è¡Œï¼Œäº’ä¸é˜»å¡ã€‚</p>
<h2 data-id="heading-47">åã€æ€»ç»“ï¼šMVCCçš„æ ¸å¿ƒæœ¬è´¨ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-48">1. æ ¸å¿ƒæœ¬è´¨ï¼šä¸æ˜¯é”ï¼Œæ˜¯å¤šç‰ˆæœ¬çš„å¯è§æ€§æ§åˆ¶</h3>
<p>MVCCçš„æ ¸å¿ƒå¹¶éä¹è§‚é”ï¼Œä¹Ÿéæ‚²è§‚é”ï¼Œè€Œæ˜¯ä¸ºæ¯è¡Œæ•°æ®ç»´æŠ¤å¤šä¸ªå†å²ç‰ˆæœ¬ï¼Œé€šè¿‡Read Viewåˆ¤æ–­ç‰ˆæœ¬å¯è§æ€§ï¼Œè®©è¯»æ“ä½œé€šè¿‡æ— é”çš„å¿«ç…§è¯»å®ç°é«˜æ€§èƒ½ï¼Œå†™æ“ä½œé€šè¿‡åŠ é”+Undo Logè®°å½•å†å²å®ç°åŸå­æ€§ã€‚å®ƒæ˜¯InnoDBè·³å‡ºä¼ ç»Ÿé”æœºåˆ¶æ¡†æ¶ï¼Œä¸ºè¯»å¤šå†™å°‘åœºæ™¯æ‰“é€ çš„ç‹¬ç«‹å¹¶å‘æ§åˆ¶ä½“ç³»ï¼Œæ˜¯æ•°æ®åº“é«˜æ€§èƒ½çš„æ ¸å¿ƒåŸºçŸ³ã€‚</p>
<h3 data-id="heading-49">2. MVCCæ ¸å¿ƒç»„ä»¶è®°å¿†å£è¯€</h3>
<ul>
<li>éšè—å­—æ®µï¼šç»™æ•°æ®æ‰“ç‰ˆæœ¬æ ‡ç­¾ï¼Œè®°å½•ä¿®æ”¹äº‹åŠ¡ä¸å†å²æŒ‡é’ˆï¼›</li>
<li>Undo Logï¼šå­˜æ•°æ®å†å²ç‰ˆæœ¬ï¼Œæ”¯æ’‘å›æ»šä¸å¿«ç…§è¯»ï¼›</li>
<li>Read Viewï¼šåšå¯è§æ€§è£åˆ¤ï¼Œä¸ºäº‹åŠ¡åˆ’å®šæ•°æ®å¯è§èŒƒå›´ï¼›</li>
<li>ä¸‰å¤§ç»„ä»¶é…åˆï¼šç‰ˆæœ¬æ‰“æ ‡â†’å†å²å­˜å‚¨â†’å¯è§æ€§åˆ¤æ–­ï¼Œå®ç°å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ã€‚</li>
</ul>
<h3 data-id="heading-50">3. æœ€ä½³å®è·µï¼šè®©MVCCå‘æŒ¥æœ€å¤§ä»·å€¼</h3>
<ol>
<li>ä½¿ç”¨é»˜è®¤çš„å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ï¼šå…¼é¡¾ä¸€è‡´æ€§ä¸å¹¶å‘æ€§èƒ½ï¼ŒInnoDBé€šè¿‡é—´éš™é”é¢å¤–é˜²æ­¢å¹»è¯»ï¼Œæ»¡è¶³ç»å¤§å¤šæ•°ä¸šåŠ¡éœ€æ±‚ã€‚</li>
<li>ä¸¥æ ¼é¿å…é•¿äº‹åŠ¡ï¼šåŠæ—¶æäº¤/å›æ»šäº‹åŠ¡ï¼Œé‡Šæ”¾Read Viewå¯¹Undo Logçš„ä¾èµ–ï¼Œè®©å¼•æ“èƒ½åŠæ—¶æ¸…ç†æ—§æ—¥å¿—ï¼Œé¿å…ç©ºé—´è†¨èƒ€ä¸æ€§èƒ½ä¸‹é™ã€‚</li>
<li>åŒºåˆ†å¿«ç…§è¯»ä¸å½“å‰è¯»ï¼šæ™®é€šæŸ¥è¯¢ä½¿ç”¨å¿«ç…§è¯»è¿½æ±‚æ€§èƒ½ï¼Œéœ€è¦æœ€æ–°æ•°æ®/åŸå­æ“ä½œæ—¶ä½¿ç”¨å½“å‰è¯»ï¼ˆFOR UPDATEï¼‰ã€‚</li>
<li>ä¼˜åŒ–å†™æ“ä½œï¼šå†™æ“ä½œé¢‘ç¹çš„è¡¨ï¼Œå¯é€‚å½“è°ƒæ•´ç´¢å¼•ï¼Œå‡å°‘è¡Œé”çš„ç²’åº¦ï¼Œé™ä½å†™æ“ä½œä¹‹é—´çš„é˜»å¡ï¼Œé…åˆMVCCæå‡æ•´ä½“æ€§èƒ½ã€‚</li>
<li>ç›‘æ§Undo LogçŠ¶æ€ï¼šå…³æ³¨å›æ»šæ®µçš„ä½¿ç”¨æƒ…å†µï¼ŒåŠæ—¶æ¸…ç†æ— æ•ˆçš„Undo Logï¼Œé¿å…ç£ç›˜ç©ºé—´è¢«è¿‡åº¦å ç”¨ã€‚</li>
</ol>
<p>MVCCæ˜¯InnoDBå­˜å‚¨å¼•æ“çš„<strong>ç²¾é«“</strong>ï¼Œä¹Ÿæ˜¯åç«¯å¼€å‘å¿…é¡»åƒé€çš„æ•°æ®åº“<strong>æ ¸å¿ƒæŠ€æœ¯</strong>â€”â€”ç†è§£MVCCï¼Œä¸ä»…èƒ½è®©ä½ åœ¨é«˜å¹¶å‘ä¸šåŠ¡è®¾è®¡ä¸­åšå‡ºæ›´åˆç†çš„æŠ€æœ¯é€‰æ‹©ï¼Œè¿˜èƒ½å¸®åŠ©ä½ å¿«é€Ÿå®šä½æ•°æ®åº“æ€§èƒ½é—®é¢˜ã€‚</p>
<p>å…¶æ ¸å¿ƒè®¾è®¡æ€æƒ³å€¼å¾—æˆ‘ä»¬å€Ÿé‰´ï¼šé¢å¯¹å¹¶å‘é—®é¢˜ï¼Œå¹¶éåªæœ‰â€œé”â€è¿™ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡åˆç†çš„ç‰ˆæœ¬æ§åˆ¶ä¸å¯è§æ€§åˆ¤æ–­ï¼Œä»æ ¹æœ¬ä¸Šå‡å°‘å†²çªç‚¹ï¼Œå¾€å¾€èƒ½å®ç°æ›´ä¼˜çš„æ€§èƒ½ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3çš„v-modelå¦‚ä½•å®ç°è¡¨å•åŒå‘ç»‘å®šï¼Ÿ]]></title>    <link>https://juejin.cn/post/7595864836360798260</link>    <guid>https://juejin.cn/post/7595864836360798260</guid>    <pubDate>2026-01-17T11:05:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595864836360798260" data-draft-id="7595896809651830824" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3çš„v-modelå¦‚ä½•å®ç°è¡¨å•åŒå‘ç»‘å®šï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,Trae"/> <meta itemprop="datePublished" content="2026-01-17T11:05:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="kknone"/> <meta itemprop="url" content="https://juejin.cn/user/1366025597879930"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3çš„v-modelå¦‚ä½•å®ç°è¡¨å•åŒå‘ç»‘å®šï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1366025597879930/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    kknone
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T11:05:23.000Z" title="Sat Jan 17 2026 11:05:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦è¡¨å•è¾“å…¥ç»‘å®šï¼Ÿ</h3>
<p>ä½ æœ‰æ²¡æœ‰è¿‡è¿™æ ·çš„ç»å†ï¼Ÿåšç™»å½•é¡µæ—¶ï¼Œæƒ³è®©ç”¨æˆ·è¾“å…¥çš„ç”¨æˆ·åå®æ—¶æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼›æˆ–è€…åšè®¾ç½®é¡µæ—¶ï¼Œä¿®æ”¹å¼€å…³æŒ‰é’®çš„çŠ¶æ€è¦åŒæ­¥åˆ°åå°æ•°æ®ã€‚è¿™æ—¶å€™ï¼Œå¦‚æœæ‰‹åŠ¨ç›‘å¬æ¯ä¸ªè¾“å…¥æ¡†çš„äº‹ä»¶ã€æ‰‹åŠ¨æ›´æ–°æ•°æ®ï¼Œä»£ç ä¼šå˜å¾—éå¸¸ç¹çâ€”â€”æ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"username"</span> <span class="hljs-attr">oninput</span>=<span class="hljs-string">"updateUsername(event)"</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">updateUsername</span>(<span class="hljs-params">e</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">username</span> = e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>;
}
</code></pre>
<p>ä¸ä»…è¦å†™ä¸€å †äº‹ä»¶ç›‘å¬ï¼Œè¿˜è¦å¤„ç†ä¸åŒè¡¨å•å…ƒç´ çš„å·®å¼‚ï¼ˆæ¯”å¦‚å¤é€‰æ¡†çš„<code>checked</code>å±æ€§ã€ä¸‹æ‹‰æ¡†çš„<code>selected</code>å±æ€§ï¼‰ã€‚è€ŒVue3çš„<strong>è¡¨å•è¾“å…¥ç»‘å®š</strong>å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜â€”â€”å®ƒå¸®ä½ æŠŠâ€œè¾“å…¥â†’æ•°æ®â†’è§†å›¾â€çš„åŒæ­¥é€»è¾‘å°è£…æˆäº†ä¸€ä¸ªç®€å•çš„æŒ‡ä»¤ï¼š<code>v-model</code>ã€‚</p>
<h3 data-id="heading-1">äºŒã€åŒå‘ç»‘å®šï¼šVue3çš„â€œæ•°æ®-è§†å›¾â€åŒæ­¥é­”æ³•</h3>
<p>åœ¨è®²<code>v-model</code>ä¹‹å‰ï¼Œæˆ‘ä»¬å¾—å…ˆææ‡‚<strong>åŒå‘ç»‘å®š</strong>çš„æ ¸å¿ƒé€»è¾‘ã€‚ç®€å•æ¥è¯´ï¼ŒåŒå‘ç»‘å®šå°±æ˜¯ï¼š</p>
<ul>
<li>å½“ç”¨æˆ·ä¿®æ”¹è§†å›¾ï¼ˆæ¯”å¦‚è¾“å…¥æ–‡å­—ã€ç‚¹å‡»å¤é€‰æ¡†ï¼‰ï¼Œæ•°æ®è‡ªåŠ¨æ›´æ–°ï¼›</li>
<li>å½“ä»£ç ä¿®æ”¹æ•°æ®ï¼ˆæ¯”å¦‚<code>this.username = 'admin'</code>ï¼‰ï¼Œè§†å›¾è‡ªåŠ¨åŒæ­¥ã€‚</li>
</ul>
<h4 data-id="heading-2">åŒå‘ç»‘å®šçš„åŸç†æµç¨‹å›¾</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
A[ç”¨æˆ·ä¿®æ”¹è§†å›¾ è¾“å…¥/ç‚¹å‡»] --&gt; B[è§¦å‘å¯¹åº”äº‹ä»¶ input/change]
B --&gt; C[æ›´æ–°æ•°æ®å¦‚username è¾“å…¥å†…å®¹]
C --&gt; D[Vueå“åº”å¼ç³»ç»Ÿæ£€æµ‹åˆ°æ•°æ®å˜åŒ–]
D --&gt; E[è‡ªåŠ¨æ›´æ–°è§†å›¾æ˜¾ç¤º]
</code></pre>
<p>ä¸¾ä¸ªä¾‹å­ï¼šå½“ä½ åœ¨è¾“å…¥æ¡†é‡Œæ•²â€œhelloâ€ï¼ŒVueä¼šåšè¿™å‡ ä»¶äº‹ï¼š</p>
<ol>
<li>ç›‘å¬è¾“å…¥æ¡†çš„<code>input</code>äº‹ä»¶ï¼Œæ‹¿åˆ°ä½ è¾“å…¥çš„â€œhelloâ€ï¼›</li>
<li>æŠŠ<code>username</code>æ•°æ®æ›´æ–°ä¸ºâ€œhelloâ€ï¼›</li>
<li>å“åº”å¼ç³»ç»Ÿå‘ç°<code>username</code>å˜äº†ï¼Œç«‹åˆ»é€šçŸ¥è¾“å…¥æ¡†æ˜¾ç¤ºâ€œhelloâ€ã€‚</li>
</ol>
<h3 data-id="heading-3">ä¸‰ã€v-modelæŒ‡ä»¤ï¼šåŒå‘ç»‘å®šçš„è¯­æ³•ç³–</h3>
<p>Vue3ä¸ºåŒå‘ç»‘å®šæä¾›äº†<strong>è¯­æ³•ç³–</strong>â€”â€”<code>v-model</code>ï¼Œå®ƒæŠŠâ€œç»‘å®švalue+ç›‘å¬äº‹ä»¶â€çš„é€»è¾‘å°è£…æˆäº†ä¸€ä¸ªæŒ‡ä»¤ã€‚æ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"username"</span>&gt;</span>
</code></pre>
<p>ç­‰ä»·äºï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">:value</span>=<span class="hljs-string">"username"</span> @<span class="hljs-attr">input</span>=<span class="hljs-string">"username = $event.target.value"</span>&gt;</span>
</code></pre>
<p>æ˜¯ä¸æ˜¯ç®€æ´å¤šäº†ï¼Ÿ<code>v-model</code>å¸®ä½ çœæ‰äº†æ‰‹åŠ¨å†™äº‹ä»¶ç›‘å¬çš„éº»çƒ¦ï¼Œè€Œä¸”é€‚ç”¨äºæ‰€æœ‰è¡¨å•å…ƒç´ ã€‚</p>
<h3 data-id="heading-4">å››ã€v-modelåœ¨ä¸åŒè¡¨å•å…ƒç´ ä¸­çš„åº”ç”¨</h3>
<p><code>v-model</code>ä¸æ˜¯åªèƒ½ç”¨åœ¨æ–‡æœ¬è¾“å…¥æ¡†ï¼Œå®ƒæ”¯æŒæ‰€æœ‰å¸¸è§çš„è¡¨å•å…ƒç´ ï¼Œæˆ‘ä»¬é€ä¸ªçœ‹ï¼š</p>
<h4 data-id="heading-5">1. æ–‡æœ¬è¾“å…¥æ¡†ï¼ˆinput[type="text"]ï¼‰ä¸å¤šè¡Œæ–‡æœ¬ï¼ˆtextareaï¼‰</h4>
<ul>
<li>æ–‡æœ¬è¾“å…¥æ¡†ï¼šç›´æ¥ç»‘å®šå­—ç¬¦ä¸²ç±»å‹çš„å“åº”å¼æ•°æ®ï¼›</li>
<li>å¤šè¡Œæ–‡æœ¬ï¼ˆtextareaï¼‰ï¼š<strong>ä¸èƒ½ç”¨æ’å€¼è¡¨è¾¾å¼</strong>ï¼ˆ<code>{{ message }}</code>ï¼‰ï¼Œå¿…é¡»ç”¨<code>v-model</code>ã€‚</li>
</ul>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">const</span> username = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>) <span class="hljs-comment">// å­—ç¬¦ä¸²ç±»å‹</span>
<span class="hljs-keyword">const</span> intro = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)    <span class="hljs-comment">// å¤šè¡Œæ–‡æœ¬å†…å®¹</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>ç”¨æˆ·åï¼š<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"username"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>ä¸ªäººç®€ä»‹ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"intro"</span> <span class="hljs-attr">rows</span>=<span class="hljs-string">"3"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<h4 data-id="heading-6">2. å¤é€‰æ¡†ï¼ˆinput[type="checkbox"]ï¼‰</h4>
<p>å¤é€‰æ¡†åˆ†ä¸¤ç§æƒ…å†µï¼š</p>
<ul>
<li><strong>å•ä¸ªå¤é€‰æ¡†</strong>ï¼šç»‘å®šå¸ƒå°”å€¼ï¼ˆ<code>true/false</code>ï¼‰ï¼Œè¡¨ç¤ºâ€œæ˜¯å¦é€‰ä¸­â€ï¼›</li>
<li><strong>å¤šä¸ªå¤é€‰æ¡†</strong>ï¼šç»‘å®š<strong>æ•°ç»„</strong>ï¼Œæ•°ç»„å…ƒç´ æ˜¯é€‰ä¸­çš„<code>value</code>å€¼ã€‚</li>
</ul>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">const</span> rememberMe = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>) <span class="hljs-comment">// å•ä¸ªå¤é€‰æ¡†ï¼ˆå¸ƒå°”å€¼ï¼‰</span>
<span class="hljs-keyword">const</span> hobbies = <span class="hljs-title function_">ref</span>([])       <span class="hljs-comment">// å¤šä¸ªå¤é€‰æ¡†ï¼ˆæ•°ç»„ï¼‰</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- å•ä¸ªå¤é€‰æ¡†ï¼šè®°ä½æˆ‘ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"rememberMe"</span>&gt;</span> è®°ä½æˆ‘<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- å¤šä¸ªå¤é€‰æ¡†ï¼šçˆ±å¥½ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"reading"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"hobbies"</span>&gt;</span> é˜…è¯»<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"sports"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"hobbies"</span>&gt;</span> è¿åŠ¨<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"coding"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"hobbies"</span>&gt;</span> ç¼–ç¨‹<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<h4 data-id="heading-7">3. å•é€‰æŒ‰é’®ï¼ˆinput[type="radio"]ï¼‰</h4>
<p>å•é€‰æŒ‰é’®ç»‘å®š<strong>å­—ç¬¦ä¸²</strong>ï¼Œå€¼ä¸ºé€‰ä¸­çš„<code>value</code>å±æ€§ã€‚</p>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">const</span> gender = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'male'</span>) <span class="hljs-comment">// é»˜è®¤é€‰ä¸­â€œç”·â€</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"radio"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"male"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"gender"</span>&gt;</span> ç”·<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"radio"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"female"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"gender"</span>&gt;</span> å¥³<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<h4 data-id="heading-8">4. ä¸‹æ‹‰æ¡†ï¼ˆselectï¼‰</h4>
<p>ä¸‹æ‹‰æ¡†çš„<code>v-model</code>ç»‘å®šé€‰ä¸­çš„<code>value</code>å€¼ï¼Œ<code>option</code>çš„<code>value</code>å±æ€§å¯¹åº”é€‰é¡¹å€¼ã€‚</p>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">const</span> city = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'beijing'</span>) <span class="hljs-comment">// é»˜è®¤é€‰ä¸­â€œåŒ—äº¬â€</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>åŸå¸‚ï¼š
      <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"city"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"beijing"</span>&gt;</span>åŒ—äº¬<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"shanghai"</span>&gt;</span>ä¸Šæµ·<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"guangzhou"</span>&gt;</span>å¹¿å·<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<h3 data-id="heading-9">äº”ã€æ•°æ®å“åº”å¼ï¼šåŒå‘ç»‘å®šçš„åº•å±‚æ”¯æ’‘</h3>
<p>ä½ å¯èƒ½ä¼šé—®ï¼šâ€œä¸ºä»€ä¹ˆæ•°æ®å˜äº†ï¼Œè§†å›¾ä¼šè‡ªåŠ¨æ›´æ–°ï¼Ÿâ€è¿™è¦å½’åŠŸäºVue3çš„<strong>å“åº”å¼ç³»ç»Ÿ</strong>ã€‚</p>
<details>
<summary>å¾€æœŸæ–‡ç« å½’æ¡£</summary>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa5c224e347f70fd63a2d8eeea20041df%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a5c224e347f70fd63a2d8eeea20041df/" ref="nofollow noopener noreferrer">Vue3ä¸­å¦‚ä½•é€šè¿‡äº‹ä»¶ç¼“å­˜ä¸é˜²æŠ–èŠ‚æµä¼˜åŒ–é«˜é¢‘äº‹ä»¶æ€§èƒ½ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fad67c4eb6d76cf7707bdfe6a8146c34f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ad67c4eb6d76cf7707bdfe6a8146c34f/" ref="nofollow noopener noreferrer">Vue3è·¨ç»„ä»¶é€šä¿¡ä¸­ï¼Œå…¨å±€äº‹ä»¶æ€»çº¿ä¸provide/injectè¯¥å¦‚ä½•æ­£ç¡®é€‰æ‹©ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F1c1e80d697cca0923f29ec70ebb8ccd1%2F" target="_blank" title="https://blog.cmdragon.cn/posts/1c1e80d697cca0923f29ec70ebb8ccd1/" ref="nofollow noopener noreferrer">Vue3è¡¨å•äº‹ä»¶å¤„ç†ï¼šv-modelå¦‚ä½•å®ç°æ•°æ®ç»‘å®šã€éªŒè¯ä¸æäº¤ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb990828143d70aa87f9aa52e16692e48%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b990828143d70aa87f9aa52e16692e48/" ref="nofollow noopener noreferrer">Vueåº”ç”¨å¦‚ä½•åŸºäºDOMäº‹ä»¶ä¼ æ’­æœºåˆ¶ä¸äº‹ä»¶ä¿®é¥°ç¬¦å®ç°é«˜æ•ˆäº‹ä»¶å¤„ç†ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb44316e0866e9f2e6aef927dbcf5152b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b44316e0866e9f2e6aef927dbcf5152b/" ref="nofollow noopener noreferrer">Vue3ä¸­å¦‚ä½•åœ¨è°ƒç”¨äº‹ä»¶å¤„ç†å‡½æ•°æ—¶åŒæ—¶ä¼ é€’è‡ªå®šä¹‰å‚æ•°å’ŒåŸç”ŸDOMäº‹ä»¶ï¼Ÿå‚æ•°é¡ºåºæœ‰å“ªäº›æ³¨æ„äº‹é¡¹ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F021636c2a06f5e2d3d01977a12ddf559%2F" target="_blank" title="https://blog.cmdragon.cn/posts/021636c2a06f5e2d3d01977a12ddf559/" ref="nofollow noopener noreferrer">ä»æ•è·åˆ°å†’æ³¡ï¼šVueäº‹ä»¶ä¿®é¥°ç¬¦å¦‚ä½•é‡å¡‘äº‹ä»¶æ‰§è¡Œé¡ºåºï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb3cddf7023ab537e623a61bc01dab6bb%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b3cddf7023ab537e623a61bc01dab6bb/" ref="nofollow noopener noreferrer">Vueäº‹ä»¶å¤„ç†ï¼šå†…è”è¿˜æ˜¯æ–¹æ³•äº‹ä»¶å¤„ç†å™¨ï¼Œè¯¥å¦‚ä½•æŠ‰æ‹©ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbd4d9607ce1bc34cc3bda0a1a46c40f6%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bd4d9607ce1bc34cc3bda0a1a46c40f6/" ref="nofollow noopener noreferrer">Vueäº‹ä»¶ç»‘å®šä¸­v-onä¸@è¯­æ³•å¦‚ä½•å–èˆï¼Ÿå‚æ•°ä¼ é€’ä¸åŸç”Ÿäº‹ä»¶å¤„ç†æœ‰å“ªäº›å®æˆ˜æŠ€å·§ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa5f2bacb74476fd7f5e02bb3f1ba6b2b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a5f2bacb74476fd7f5e02bb3f1ba6b2b/" ref="nofollow noopener noreferrer">Vue 3ä¸­åˆ—è¡¨æ’åºæ—¶ä¸ºä½•å¿…é¡»å¤åˆ¶æ•°ç»„è€Œéç›´æ¥ä¿®æ”¹åŸå§‹æ•°æ®ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd3b06b57fb7f126787e6ed22dce1e341%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d3b06b57fb7f126787e6ed22dce1e341/" ref="nofollow noopener noreferrer">Vueè™šæ‹Ÿæ»šåŠ¨å¦‚ä½•å°†åˆ—è¡¨DOMæ•°é‡ä»ä¸‡çº§é™è‡³åä½æ•°ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F3100cc5a2e16f8dac36f722594e6af32%2F" target="_blank" title="https://blog.cmdragon.cn/posts/3100cc5a2e16f8dac36f722594e6af32/" ref="nofollow noopener noreferrer">Vue3ä¸­v-ifä¸v-forç›´æ¥æ··ç”¨ä¸ºä½•ä¼šæŠ¥é”™ï¼Ÿè®¡ç®—å±æ€§å¦‚ä½•è§£å†³ä¼˜å…ˆçº§å†²çªï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F455dc2d47c38d12c1cf350e490041e8b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/455dc2d47c38d12c1cf350e490041e8b/" ref="nofollow noopener noreferrer">ä¸ºä½•åœ¨Vue3é€’å½’ç»„ä»¶ä¸­å¿…é¡»ç”¨v-ifåˆ¤æ–­å­é¡¹å­˜åœ¨ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F3f842bbd7ba0f9c91151b983bf784c8b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/3f842bbd7ba0f9c91151b983bf784c8b/" ref="nofollow noopener noreferrer">Vue3åˆ—è¡¨æ¸²æŸ“ä¸­ï¼Œå¦‚ä½•ç”¨æ•°ç»„æ–¹æ³•ä¸è®¡ç®—å±æ€§ä¼˜åŒ–v-forçš„æ•°æ®å¤„ç†ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F1eb3ffac668a743843b5ea1738301d40%2F" target="_blank" title="https://blog.cmdragon.cn/posts/1eb3ffac668a743843b5ea1738301d40/" ref="nofollow noopener noreferrer">Vue v-forçš„keyï¼šä¸ºä»€ä¹ˆå®ƒèƒ½è§£å†³åˆ—è¡¨æ¸²æŸ“ä¸­çš„â€œç„å­¦é”™è¯¯â€ï¼Ÿé€‰é”™ä¼šæœ‰å“ªäº›åæœï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F138b13c5341f6a1fa9015400433a3611%2F" target="_blank" title="https://blog.cmdragon.cn/posts/138b13c5341f6a1fa9015400433a3611/" ref="nofollow noopener noreferrer">Vue3ä¸­v-forä¸v-ifä¸ºä½•ä¸èƒ½ç›´æ¥å…±å­˜äºåŒä¸€å…ƒç´ ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F0242a94dc552b93a1bc335ac4fc33db5%2F" target="_blank" title="https://blog.cmdragon.cn/posts/0242a94dc552b93a1bc335ac4fc33db5/" ref="nofollow noopener noreferrer">Vue3ä¸­v-ifä¸v-showçš„æœ¬è´¨åŒºåˆ«åŠåŠ¨æ€ç»„ä»¶çŠ¶æ€ä¿æŒçš„å…³é”®ç­–ç•¥æ˜¯ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F97c66a18ae0e9b57c6a69b8b3a41ddf6%2F" target="_blank" title="https://blog.cmdragon.cn/posts/97c66a18ae0e9b57c6a69b8b3a41ddf6/" ref="nofollow noopener noreferrer">Vue3ä¸­v-showå¦‚ä½•é€šè¿‡CSSä¿®æ”¹displayå±æ€§æ§åˆ¶æ¡ä»¶æ˜¾ç¤ºï¼Ÿä¸v-ifçš„åº”ç”¨åœºæ™¯è¯¥å¦‚ä½•åŒºåˆ†ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F8a1ddfac64b25062ac56403e4c1201d2%2F" target="_blank" title="https://blog.cmdragon.cn/posts/8a1ddfac64b25062ac56403e4c1201d2/" ref="nofollow noopener noreferrer">Vue3æ¡ä»¶æ¸²æŸ“ä¸­v-ifç³»åˆ—æŒ‡ä»¤å¦‚ä½•åˆç†ä½¿ç”¨ä¸è§„é¿é”™è¯¯ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F218c3a59282c3b757447ee08a01937bb%2F" target="_blank" title="https://blog.cmdragon.cn/posts/218c3a59282c3b757447ee08a01937bb/" ref="nofollow noopener noreferrer">Vue3åŠ¨æ€æ ·å¼æ§åˆ¶ï¼šrefã€reactiveã€watchä¸computedçš„åº”ç”¨åœºæ™¯ä¸åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F1bab953e41f66ac53de099fa9fe76483%2F" target="_blank" title="https://blog.cmdragon.cn/posts/1bab953e41f66ac53de099fa9fe76483/" ref="nofollow noopener noreferrer">Vue3ä¸­åŠ¨æ€æ ·å¼æ•°ç»„çš„åé¡¹è¦†ç›–è§„åˆ™å¦‚ä½•ä¸è®¡ç®—å±æ€§ç»“åˆå®ç°å¤æ‚çŠ¶æ€æ ·å¼ç®¡ç†ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc85e1fe16a7ae45e965b4e2df4d9d2f4%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c85e1fe16a7ae45e965b4e2df4d9d2f4/" ref="nofollow noopener noreferrer">Vueæµ…å“åº”å¼å¦‚ä½•è§£å†³æ·±å±‚å“åº”å¼çš„æ€§èƒ½é—®é¢˜ï¼Ÿé€‚ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbe04b02d2723994632de0d4ca22a3391%2F" target="_blank" title="https://blog.cmdragon.cn/posts/be04b02d2723994632de0d4ca22a3391/" ref="nofollow noopener noreferrer">Vue 3ç»„åˆå¼APIä¸­refä¸reactiveçš„æ ¸å¿ƒå“åº”å¼å·®å¼‚åŠä½¿ç”¨æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbe04b02d2723994632de0d4ca22a3391%2F" target="_blank" title="https://blog.cmdragon.cn/posts/be04b02d2723994632de0d4ca22a3391/" ref="nofollow noopener noreferrer">Vue 3ç»„åˆå¼APIä¸­refä¸reactiveçš„æ ¸å¿ƒå“åº”å¼å·®å¼‚åŠä½¿ç”¨æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa0af08dd60a37b9a890a9957f2cbfc9f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a0af08dd60a37b9a890a9957f2cbfc9f/" ref="nofollow noopener noreferrer">Vue3å“åº”å¼ç³»ç»Ÿä¸­ï¼Œå¯¹è±¡æ–°å¢å±æ€§ã€æ•°ç»„æ”¹ç´¢å¼•ã€åŸå§‹å€¼ä»£ç†çš„é—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbc287e1e36287afd90750fd907eca85e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bc287e1e36287afd90750fd907eca85e/" ref="nofollow noopener noreferrer">Vue 3ä¸­watchä¾¦å¬å™¨çš„æ­£ç¡®ä½¿ç”¨å§¿åŠ¿ä½ æŒæ¡äº†å—ï¼Ÿæ·±åº¦ç›‘å¬ã€ä¸watchEffectçš„å·®å¼‚åŠå¸¸è§æŠ¥é”™è§£æ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F654b9447ef1ba7ec1126a1bc26a4726d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/654b9447ef1ba7ec1126a1bc26a4726d/" ref="nofollow noopener noreferrer">Vueå“åº”å¼å£°æ˜çš„APIå·®å¼‚ã€åº•å±‚åŸç†ä¸å¸¸è§é™·é˜±ä½ éƒ½ææ‡‚äº†å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F654b9447ef1ba7ec1126a1bc26a4726d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/654b9447ef1ba7ec1126a1bc26a4726d/" ref="nofollow noopener noreferrer">Vueå“åº”å¼å£°æ˜çš„APIå·®å¼‚ã€åº•å±‚åŸç†ä¸å¸¸è§é™·é˜±ä½ éƒ½ææ‡‚äº†å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc405a8d9950af5b7c63b56c348ac36b6%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c405a8d9950af5b7c63b56c348ac36b6/" ref="nofollow noopener noreferrer">ä¸ºä»€ä¹ˆVue 3éœ€è¦refå‡½æ•°ï¼Ÿå®ƒçš„å“åº”å¼åŸç†ä¸æ­£ç¡®ç”¨æ³•æ˜¯ä»€ä¹ˆï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa7e9abb9691a81e4404d9facabe0f7c3%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a7e9abb9691a81e4404d9facabe0f7c3/" ref="nofollow noopener noreferrer">Vue 3ä¸­reactiveå‡½æ•°å¦‚ä½•é€šè¿‡Proxyå®ç°å“åº”å¼ï¼Ÿä½¿ç”¨æ—¶è¦é¿å¼€å“ªäº›è¯¯åŒºï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbd995ea45161727597fb85b62566c43d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bd995ea45161727597fb85b62566c43d/" ref="nofollow noopener noreferrer">Vue3å“åº”å¼ç³»ç»Ÿçš„åº•å±‚åŸç†ä¸å®è·µè¦ç‚¹ä½ çœŸçš„æ‡‚å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F53e3f270a80675df662c6857a3332c0f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/53e3f270a80675df662c6857a3332c0f/" ref="nofollow noopener noreferrer">Vue 3æ¨¡æ¿å¦‚ä½•é€šè¿‡ç¼–è¯‘ä¸‰é˜¶æ®µå®ç°ä»å£°æ˜å¼è¯­æ³•åˆ°é«˜æ•ˆæ¸²æŸ“çš„è·¨è¶Š - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fddbce4f2a23aa72c96b1c0473900321e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ddbce4f2a23aa72c96b1c0473900321e/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueæ¨¡æ¿å¼•ç”¨ï¼šä»æ”¶DOMâ€œå¿«é€’â€åˆ°è°ƒå­ç»„ä»¶æ–¹æ³•ï¼Œä½ ç©æ˜ç™½äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F23a2d5a334e15575277814c16e45df50%2F" target="_blank" title="https://blog.cmdragon.cn/posts/23a2d5a334e15575277814c16e45df50/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueæ¨¡æ¿é‡Œçš„JSè¡¨è¾¾å¼æœ‰å•¥ä¸èƒ½ç¢°ï¼Ÿè®¡ç®—å±æ€§ä¸ºå•¥æ¯”æ–¹æ³•æ›´èƒ½æ‰“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6be38de6382e31d282659b689c5b17f0%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6be38de6382e31d282659b689c5b17f0/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueçš„v-modelè¡¨å•ç»‘å®šï¼šè¯­æ³•ç³–ã€åŠ¨æ€å€¼ã€ä¿®é¥°ç¬¦çš„å°æŠ€å·§ä½ éƒ½æŒæ¡äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F60ce517684f4a418f453d66aa805606c%2F" target="_blank" title="https://blog.cmdragon.cn/posts/60ce517684f4a418f453d66aa805606c/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3äº‹ä»¶å¤„ç†çš„æŒ‘æˆ˜é¢˜ï¼šv-onã€ä¿®é¥°ç¬¦ã€è‡ªå®šä¹‰äº‹ä»¶ä½ èƒ½é€šå…³å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fe4ae7d5e4a9205bb11b2baccb230c637%2F" target="_blank" title="https://blog.cmdragon.cn/posts/e4ae7d5e4a9205bb11b2baccb230c637/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3çš„v-æŒ‡ä»¤ï¼šæ•°æ®å’ŒDOMçš„â€œç¿»è¯‘å®˜â€åˆ°åº•æœ‰å¤šå°‘æœ¬äº‹ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F999ce4fb32259ff4fbf4bf7bcb851654%2F" target="_blank" title="https://blog.cmdragon.cn/posts/999ce4fb32259ff4fbf4bf7bcb851654/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3ï¼Œæ’å€¼ã€åŠ¨æ€ç»‘å®šå’Œé¿å‘æŠ€å·§ä½ éƒ½ææ‡‚äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa6997d81b49cd232b87e1cf603888ad1%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a6997d81b49cd232b87e1cf603888ad1/" ref="nofollow noopener noreferrer">æƒ³è®©PostgreSQLå¿«åˆ°é£èµ·ï¼Ÿå…ˆæ‰¾å¥åº·å¯†ç è¿˜æ˜¯å…ˆæ¢å¼•æ“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F1fee7afbb9abd4540b8aa9c141d6845d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/1fee7afbb9abd4540b8aa9c141d6845d/" ref="nofollow noopener noreferrer">æƒ³è®©PostgreSQLæŸ¥è¯¢å¿«åˆ°é£èµ·ï¼Ÿåˆ†åŒºè¡¨ã€ç‰©åŒ–è§†å›¾ã€å¹¶è¡ŒæŸ¥è¯¢è¿™ä¸‰æ‹›çµä¸çµï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F79c590fbd87ece535b11a71c9667884f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/79c590fbd87ece535b11a71c9667884f/" ref="nofollow noopener noreferrer">å­æŸ¥è¯¢æ€»æ‹–æ…¢æŸ¥è¯¢ï¼ŸæŠŠå®ƒå˜æˆè¿æ¥å°±èƒ½è§£å†³ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F748cdac2536008199abf8a8a2cd0ec85%2F" target="_blank" title="https://blog.cmdragon.cn/posts/748cdac2536008199abf8a8a2cd0ec85/" ref="nofollow noopener noreferrer">PostgreSQLå…¨è¡¨æ‰«ææ…¢åˆ°å´©æºƒï¼Ÿå»ºç´¢å¼•+æ”¹æŸ¥è¯¢+æ›´ç»Ÿè®¡ä¿¡æ¯ä¸‰æ‹›èƒ½ç ´ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F32ca943703226d317d4276a8fb53b0dd%2F" target="_blank" title="https://blog.cmdragon.cn/posts/32ca943703226d317d4276a8fb53b0dd/" ref="nofollow noopener noreferrer">å¤æ‚æŸ¥è¯¢æ€»æ‹–åè…¿ï¼ŸPostgreSQLå¤šåˆ—ç´¢å¼•+è¦†ç›–ç´¢å¼•çš„ç¥ä»™æŠ€å·§ä½ getæ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fca93f1d53aa910e7ba5ffd8df611c12b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ca93f1d53aa910e7ba5ffd8df611c12b/" ref="nofollow noopener noreferrer">åªç»™è¡¨å­é›†å»ºç´¢å¼•ï¼Ÿç”¨å‡½æ•°ç»“æœå»ºç´¢å¼•ï¼ŸPostgreSQLè¿™ä¿©æ“ä½œå‡­å•¥èƒ½çœç©ºé—´åˆåŠ é€Ÿï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Ff507856ebfddd592448813c510a53669%2F" target="_blank" title="https://blog.cmdragon.cn/posts/f507856ebfddd592448813c510a53669/" ref="nofollow noopener noreferrer">B-treeç´¢å¼•åƒå­—å…¸æŸ¥è¯ä¸€æ ·å·¥ä½œï¼Ÿé‚£å“ªäº›æ•°æ®åº“æŸ¥è¯¢å®ƒèƒ½åŠ é€Ÿï¼Œå“ªäº›ä¸èƒ½ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb2213bfcb5b88a862f2138404c03d596%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b2213bfcb5b88a862f2138404c03d596/" ref="nofollow noopener noreferrer">æƒ³æŠ“PostgreSQLé‡Œçš„æ…¢SQLï¼Ÿpg_stat_statementsåŸºç¡€é»‘åŒ£å­å’Œpg_stat_monitoræ—¶é—´çª—ï¼Œè°èƒ½å¸®ä½ æ›´å‡†æªå‡ºæ€§èƒ½å°å·ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F26614eb7da6c476dde41d367ad888d2f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/26614eb7da6c476dde41d367ad888d2f/" ref="nofollow noopener noreferrer">PostgreSQLçš„â€œæ—¶å…‰æœºâ€MVCCå’Œé”æœºåˆ¶æ˜¯æ€ä¹ˆæå®šé«˜å¹¶å‘çš„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F69f99bc6972a860d559c74aad7280da4%2F" target="_blank" title="https://blog.cmdragon.cn/posts/69f99bc6972a860d559c74aad7280da4/" ref="nofollow noopener noreferrer">PostgreSQLæ€§èƒ½æš´æ¶¨çš„å…³é”®ï¼Ÿå†…å­˜IOå¹¶å‘å‚æ•°å±…ç„¶è¦è¿™ä¹ˆè®¾ç½®ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F7b7053f392147a8b3b1a16bebeb08d0a%2F" target="_blank" title="https://blog.cmdragon.cn/posts/7b7053f392147a8b3b1a16bebeb08d0a/" ref="nofollow noopener noreferrer">å¤§è¡¨æŸ¥è¯¢æ…¢åˆ°ç¿»éæ•´ä¸ªä¹¦æ¶ï¼ŸPostgreSQLåˆ†åŒºè¡¨æ•™ä½ æ€ä¹ˆâ€œåˆ†ç±»â€æ‰é«˜æ•ˆ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc856e3cb073822349f3bf2d29995dcfc%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c856e3cb073822349f3bf2d29995dcfc/" ref="nofollow noopener noreferrer">PostgreSQL æŸ¥è¯¢æ…¢ï¼Ÿæ˜¯ä¸æ˜¯å¿˜äº†ä¼˜åŒ– GROUP BYã€ORDER BY å’Œçª—å£å‡½æ•°ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc096347d18e67b7431faacd2c4757093%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c096347d18e67b7431faacd2c4757093/" ref="nofollow noopener noreferrer">PostgreSQLé‡Œçš„å­æŸ¥è¯¢å’ŒCTEå±…ç„¶åœ¨æ€§èƒ½ä¸Šâ€œææ¶â€ï¼Ÿåˆ°åº•è¯¥ç«™å“ªè¾¹ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F2eca89463454fd4250d7b66243b9fe5a%2F" target="_blank" title="https://blog.cmdragon.cn/posts/2eca89463454fd4250d7b66243b9fe5a/" ref="nofollow noopener noreferrer">PostgreSQLé€‰Joinç­–ç•¥æœ‰å•¥å°ä¹ä¹ï¼ŸNested Loop/Merge/Hashè°æ˜¯å®ƒçš„èœï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F068ecb772a87d7df20a8c9fb4b233f8e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/068ecb772a87d7df20a8c9fb4b233f8e/" ref="nofollow noopener noreferrer">PostgreSQLæ–°æ‰‹SQLæ€»ç¿»è½¦ï¼Ÿè¿™7ä¸ªæ€§èƒ½é™·é˜±ä½ è¸©è¿‡æ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd498f63cd0a2d5a77e445c688a8b88db%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d498f63cd0a2d5a77e445c688a8b88db/" ref="nofollow noopener noreferrer">PostgreSQLç´¢å¼•é€‰B-Treeè¿˜æ˜¯GiSTï¼Ÿâ€œç‘å£«å†›åˆ€â€å’Œâ€œå¤šé¢æ‰‹â€çš„å·®åˆ«ä½ å±…ç„¶è¿˜ä¸çŸ¥é“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F9101b75bdec6faea9b35d54f14e37f36%2F" target="_blank" title="https://blog.cmdragon.cn/posts/9101b75bdec6faea9b35d54f14e37f36/" ref="nofollow noopener noreferrer">æƒ³çŸ¥é“æ•°æ®åº“æ€ä¹ˆç»™æŸ¥è¯¢â€œç®—æˆæœ¬é€‰è·¯çº¿â€ï¼ŸEXPLAINèƒ½å¸®ä½ çœ‹æ˜ç™½ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd527f8ebb6e3dae2c7dfe4c8d8979444%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d527f8ebb6e3dae2c7dfe4c8d8979444/" ref="nofollow noopener noreferrer">PostgreSQLå¤„ç†SQLå±…ç„¶åƒåšè›‹ç³•ï¼Ÿè§£æåˆ°æ‰§è¡Œçš„4æ­¥é‡Œè—ç€å¤šå°‘æŸ¥è¯¢ä¼˜åŒ–çš„å°å¿ƒæœºï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6bfdae84f313cf7ad0bb7045c4392347%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6bfdae84f313cf7ad0bb7045c4392347/" ref="nofollow noopener noreferrer">PostgreSQLå¤‡ä»½ä¸æ˜¯å¤åˆ¶æ–‡ä»¶ï¼Ÿç‰©ç†vsé€»è¾‘å’‹é€‰ï¼Ÿè¯¯åˆ è¿˜èƒ½ç²¾å‡†æ¢å¤åˆ°1åˆ†é’Ÿå‰ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fde3672803de34dbad244d0a8d48b0eb5%2F" target="_blank" title="https://blog.cmdragon.cn/posts/de3672803de34dbad244d0a8d48b0eb5/" ref="nofollow noopener noreferrer">è½¬è´¦ä¸ç¿»è½¦ã€å¹¶å‘ä¸å¹²æ‰°ï¼ŒPostgreSQLçš„ACIDç‰¹æ€§åˆ°åº•æœ‰å•¥é­”æ³•ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fe463e8a2668abdf00a228c9b79324ded%2F" target="_blank" title="https://blog.cmdragon.cn/posts/e463e8a2668abdf00a228c9b79324ded/" ref="nofollow noopener noreferrer">é“¶è¡Œè½¬è´¦ä¸ç™½æ‰£é’±ã€ç”µå•†ä¸‹å•ä¸è¶…å–ï¼ŒPostgreSQLäº‹åŠ¡çš„è¯€çªæ˜¯å•¥ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F5c967e595058c4a1fc4474a68e64031d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/5c967e595058c4a1fc4474a68e64031d/" ref="nofollow noopener noreferrer">PostgreSQLé‡Œçš„PL/pgSQLåˆ°åº•æ˜¯å•¥ï¼Ÿèƒ½è®©SQLä»â€œè¯´ç›®æ ‡â€å˜â€œè®²æ­¥éª¤â€ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F325047855e3e23b5ef82f7d2db134fbd%2F" target="_blank" title="https://blog.cmdragon.cn/posts/325047855e3e23b5ef82f7d2db134fbd/" ref="nofollow noopener noreferrer">PostgreSQLè§†å›¾ä¸å­˜æ•°æ®ï¼Ÿé‚£å®ƒæ€ä¹ˆç®€åŒ–æŸ¥è¯¢è¿˜èƒ½é€’å½’ç”Ÿæˆåºåˆ—å’Œæ§åˆ¶æƒé™ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd2dba50bb6e4df7b27e735245a06a2a2%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d2dba50bb6e4df7b27e735245a06a2a2/" ref="nofollow noopener noreferrer">PostgreSQLç´¢å¼•è¿™ä¹ˆç©ï¼Œæ‰èƒ½è®©ä½ çš„æŸ¥è¯¢çœŸçš„â€œé£â€èµ·æ¥ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F849ae5bab0f8c66e94c2f6ad1bb798e3%2F" target="_blank" title="https://blog.cmdragon.cn/posts/849ae5bab0f8c66e94c2f6ad1bb798e3/" ref="nofollow noopener noreferrer">PostgreSQLçš„è¡¨å…³ç³»å’Œçº¦æŸï¼Œå’‹å¸®ä½ æå®šç”¨æˆ·è®¢å•ä¸æ··ä¹±ã€å­¦ç”Ÿé€‰è¯¾ä¸é‡å¤ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fef4800975ffa84f1ca51976a70a1585b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ef4800975ffa84f1ca51976a70a1585b/" ref="nofollow noopener noreferrer">PostgreSQLæŸ¥è¯¢çš„ç­›å­ã€æ’åºã€èšåˆã€åˆ†ç»„ï¼Ÿä½ ä¼šç”¨å®ƒä»¬æå®šæ•°æ®å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbf54711525c507c5eacfa7b0151c39d2%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bf54711525c507c5eacfa7b0151c39d2/" ref="nofollow noopener noreferrer">PostgreSQLæ•°æ®ç±»å‹æ€ä¹ˆé€‰æ‰é«˜æ•ˆä¸è¸©å‘ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F887809b3e0375f5956873cd442f516d8%2F" target="_blank" title="https://blog.cmdragon.cn/posts/887809b3e0375f5956873cd442f516d8/" ref="nofollow noopener noreferrer">æƒ³è§£é”PostgreSQLæŸ¥è¯¢ä»åŸºç¡€åˆ°è¿›é˜¶çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Ÿä½ éƒ½getäº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F934be1203725e8be9d6f6e9104e5abcc%2F" target="_blank" title="https://blog.cmdragon.cn/posts/934be1203725e8be9d6f6e9104e5abcc/" ref="nofollow noopener noreferrer">PostgreSQL DELETEå±…ç„¶æœ‰è¿™äº›æ“ä½œï¼Ÿè¿”å›æ•°æ®ã€è¿è¡¨åˆ ä½ è¯•è¿‡æ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F0f0622e9b7402b599e618150d0596ffe%2F" target="_blank" title="https://blog.cmdragon.cn/posts/0f0622e9b7402b599e618150d0596ffe/" ref="nofollow noopener noreferrer">PostgreSQL UPDATEè¯­å¥æ€ä¹ˆç©ï¼Ÿä»æ”¹é‚®ç®±åˆ°æ‰¹é‡æ›´æ–°çš„é¿å‘æŠ€å·§ä½ éƒ½ä¼šå—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F0e3bf7efc030b024ea67ee855a00f2de%2F" target="_blank" title="https://blog.cmdragon.cn/posts/0e3bf7efc030b024ea67ee855a00f2de/" ref="nofollow noopener noreferrer">PostgreSQLæ’å…¥æ•°æ®è¿˜åœ¨é€æ¡æ•²ï¼Ÿæ‰¹é‡ã€å†²çªå¤„ç†ã€è¿”å›è‡ªå¢IDçš„æŠ€å·§ä½ ä¼šå—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb6cd3c86da6aac26ed829e472d34078e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b6cd3c86da6aac26ed829e472d34078e/" ref="nofollow noopener noreferrer">PostgreSQLçš„â€œä»“åº“-æˆ¿é—´-è´§æ¶â€æ¸¸æˆï¼Œä½ èƒ½å»ºå‡ºç”µå•†æ•°æ®åº“å’Œè¡¨å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fba1f545a3410144552fbdbfcf31b5265%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ba1f545a3410144552fbdbfcf31b5265/" ref="nofollow noopener noreferrer">PostgreSQL 17å®‰è£…æ€»ç¿»è½¦ï¼ŸWindows/macOS/Linuxé¿å‘æŒ‡å—å¸®ä½ æå®šï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb5474d1480509c5072085abc80b3dd9f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b5474d1480509c5072085abc80b3dd9f/" ref="nofollow noopener noreferrer">èƒ½å½“å…³ç³»å‹æ•°æ®åº“è¿˜èƒ½ç©å¯¹è±¡ç‰¹æ€§ï¼Œèƒ½æ‹†å¤æ‚æŸ¥è¯¢è¿˜èƒ½è‡ªåŠ¨ç®¡åº“å­˜ï¼ŒPostgreSQLå‡­ä»€ä¹ˆè¿™ä¹ˆé¦™ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fcc098d8836e787baa8a4d92e4d56d5c5%2F" target="_blank" title="https://blog.cmdragon.cn/posts/cc098d8836e787baa8a4d92e4d56d5c5/" ref="nofollow noopener noreferrer">ç»™æ¥å£åŠ æ–°å­—æ®µåˆä¸æå´©è€å®¢æˆ·ç«¯ï¼ŸFastAPIçš„å¤šç‰ˆæœ¬APIé å“ªä¸‰æ‹›å®ç°ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F46d05151c5bd31cf37a7bcf0b8f5b0b8%2F" target="_blank" title="https://blog.cmdragon.cn/posts/46d05151c5bd31cf37a7bcf0b8f5b0b8/" ref="nofollow noopener noreferrer">æµé‡çªå¢è¦æå´©FastAPIï¼Ÿç†”æ–­æµ‹è¯•æ˜¯æ€ä¹ˆé˜²ç³»ç»Ÿé›ªå´©çš„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F65ce343cc5df9faf3a8e2eeaab42ae45%2F" target="_blank" title="https://blog.cmdragon.cn/posts/65ce343cc5df9faf3a8e2eeaab42ae45/" ref="nofollow noopener noreferrer">FastAPIç§’æ€åº“å­˜æ€»å˜è´Ÿæ•°ï¼ŸRedisåˆ†å¸ƒå¼é”èƒ½å¸®ä½ å®ˆä½åº•çº¿å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Feed6cd8985d9be0a4b092a7da38b3e0c%2F" target="_blank" title="https://blog.cmdragon.cn/posts/eed6cd8985d9be0a4b092a7da38b3e0c/" ref="nofollow noopener noreferrer">FastAPIçš„CIæµæ°´çº¿æ€ä¹ˆè‡ªåŠ¨æµ‹ç«¯ç‚¹ï¼Œè¿˜èƒ½è®©AllureæŠ¥å‘Šç¾åˆ°çŠ¯è§„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6157d87338ce894d18c013c3c4777abb%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6157d87338ce894d18c013c3c4777abb/" ref="nofollow noopener noreferrer">å¦‚ä½•ç”¨GitHub Actionsä¸ºFastAPIé¡¹ç›®æ‰“é€ è‡ªåŠ¨åŒ–æµ‹è¯•æµæ°´çº¿ï¼Ÿ - cmdragon's Blog</a></li>
</ul>
</details>
<details>
<summary>å…è´¹å¥½ç”¨çš„çƒ­é—¨åœ¨çº¿å·¥å…·</summary>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ffile-converter" target="_blank" title="https://tools.cmdragon.cn/zh/apps/file-converter" ref="nofollow noopener noreferrer">æ–‡ä»¶æ ¼å¼è½¬æ¢å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fm3u8-player" target="_blank" title="https://tools.cmdragon.cn/zh/apps/m3u8-player" ref="nofollow noopener noreferrer">M3U8åœ¨çº¿æ’­æ”¾å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fquick-image-design" target="_blank" title="https://tools.cmdragon.cn/zh/apps/quick-image-design" ref="nofollow noopener noreferrer">å¿«å›¾è®¾è®¡ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-to-image-advanced" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-to-image-advanced" ref="nofollow noopener noreferrer">é«˜çº§æ–‡å­—è½¬å›¾ç‰‡è½¬æ¢å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fraid-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/raid-calculator" ref="nofollow noopener noreferrer">RAID è®¡ç®—å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fphotoshop-online" target="_blank" title="https://tools.cmdragon.cn/zh/apps/photoshop-online" ref="nofollow noopener noreferrer">åœ¨çº¿PS - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmermaid-live-editor" target="_blank" title="https://tools.cmdragon.cn/zh/apps/mermaid-live-editor" ref="nofollow noopener noreferrer">Mermaid åœ¨çº¿ç¼–è¾‘å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmath-solver-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/math-solver-calculator" ref="nofollow noopener noreferrer">æ•°å­¦æ±‚è§£è®¡ç®—å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsmart-teleprompter" target="_blank" title="https://tools.cmdragon.cn/zh/apps/smart-teleprompter" ref="nofollow noopener noreferrer">æ™ºèƒ½æè¯å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmagic-resume" target="_blank" title="https://tools.cmdragon.cn/zh/apps/magic-resume" ref="nofollow noopener noreferrer">é­”æ³•ç®€å† - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-puzzle-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-puzzle-tool" ref="nofollow noopener noreferrer">Image Puzzle Tool - å›¾ç‰‡æ‹¼å›¾å·¥å…· | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsubtitle-downloader" target="_blank" title="https://tools.cmdragon.cn/zh/apps/subtitle-downloader" ref="nofollow noopener noreferrer">å­—å¹•ä¸‹è½½å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Flyrics-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/lyrics-generator" ref="nofollow noopener noreferrer">æ­Œè¯ç”Ÿæˆå·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcloud-drive-search" target="_blank" title="https://tools.cmdragon.cn/zh/apps/cloud-drive-search" ref="nofollow noopener noreferrer">ç½‘ç›˜èµ„æºèšåˆæœç´¢ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fascii-art-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ascii-art-generator" ref="nofollow noopener noreferrer">ASCIIå­—ç¬¦ç”»ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fjwt-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/jwt-tool" ref="nofollow noopener noreferrer">JSON Web Tokens å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbcrypt-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/bcrypt-tool" ref="nofollow noopener noreferrer">Bcrypt å¯†ç å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fgif-composer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/gif-composer" ref="nofollow noopener noreferrer">GIF åˆæˆå™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fgif-decomposer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/gif-decomposer" ref="nofollow noopener noreferrer">GIF åˆ†è§£å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-steganography" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-steganography" ref="nofollow noopener noreferrer">æ–‡æœ¬éšå†™æœ¯ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh" target="_blank" title="https://tools.cmdragon.cn/zh" ref="nofollow noopener noreferrer">CMDragon åœ¨çº¿å·¥å…· - é«˜çº§AIå·¥å…·ç®±ä¸å¼€å‘è€…å¥—ä»¶ | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%3Fcategory%3Dtrending" target="_blank" title="https://tools.cmdragon.cn/zh/apps?category=trending" ref="nofollow noopener noreferrer">åº”ç”¨å•†åº— - å‘ç°1000+æå‡æ•ˆç‡ä¸å¼€å‘çš„AIå·¥å…·å’Œå®ç”¨ç¨‹åº | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fchangelog" target="_blank" title="https://tools.cmdragon.cn/zh/changelog" ref="nofollow noopener noreferrer">CMDragon æ›´æ–°æ—¥å¿— - æœ€æ–°æ›´æ–°ã€åŠŸèƒ½ä¸æ”¹è¿› | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fsponsor" target="_blank" title="https://tools.cmdragon.cn/zh/sponsor" ref="nofollow noopener noreferrer">æ”¯æŒæˆ‘ä»¬ - æˆä¸ºèµåŠ©è€… | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-to-image-ai" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-to-image-ai" ref="nofollow noopener noreferrer">AIæ–‡æœ¬ç”Ÿæˆå›¾åƒ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftemp-email" target="_blank" title="https://tools.cmdragon.cn/zh/apps/temp-email" ref="nofollow noopener noreferrer">ä¸´æ—¶é‚®ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fqrcode-parser" target="_blank" title="https://tools.cmdragon.cn/zh/apps/qrcode-parser" ref="nofollow noopener noreferrer">äºŒç»´ç è§£æå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-to-mindmap" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-to-mindmap" ref="nofollow noopener noreferrer">æ–‡æœ¬è½¬æ€ç»´å¯¼å›¾ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fregex-visualizer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/regex-visualizer" ref="nofollow noopener noreferrer">æ­£åˆ™è¡¨è¾¾å¼å¯è§†åŒ–å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsteganography-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/steganography-tool" ref="nofollow noopener noreferrer">æ–‡ä»¶éšå†™å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fiptv-explorer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/iptv-explorer" ref="nofollow noopener noreferrer">IPTV é¢‘é“æ¢ç´¢å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsnapdrop" target="_blank" title="https://tools.cmdragon.cn/zh/apps/snapdrop" ref="nofollow noopener noreferrer">å¿«ä¼  - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Flucky-draw" target="_blank" title="https://tools.cmdragon.cn/zh/apps/lucky-draw" ref="nofollow noopener noreferrer">éšæœºæŠ½å¥–å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fanime-scene-finder" target="_blank" title="https://tools.cmdragon.cn/zh/apps/anime-scene-finder" ref="nofollow noopener noreferrer">åŠ¨æ¼«åœºæ™¯æŸ¥æ‰¾å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftime-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/time-toolkit" ref="nofollow noopener noreferrer">æ—¶é—´å·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fspeed-test" target="_blank" title="https://tools.cmdragon.cn/zh/apps/speed-test" ref="nofollow noopener noreferrer">ç½‘é€Ÿæµ‹è¯• - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbackground-remover" target="_blank" title="https://tools.cmdragon.cn/zh/apps/background-remover" ref="nofollow noopener noreferrer">AI æ™ºèƒ½æŠ å›¾å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbackground-replacer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/background-replacer" ref="nofollow noopener noreferrer">èƒŒæ™¯æ›¿æ¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fartistic-qrcode" target="_blank" title="https://tools.cmdragon.cn/zh/apps/artistic-qrcode" ref="nofollow noopener noreferrer">è‰ºæœ¯äºŒç»´ç ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fopen-graph-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/open-graph-generator" ref="nofollow noopener noreferrer">Open Graph å…ƒæ ‡ç­¾ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-comparison" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-comparison" ref="nofollow noopener noreferrer">å›¾åƒå¯¹æ¯”å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-compressor" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-compressor" ref="nofollow noopener noreferrer">å›¾ç‰‡å‹ç¼©ä¸“ä¸šç‰ˆ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fpassword-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/password-generator" ref="nofollow noopener noreferrer">å¯†ç ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsvg-optimizer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/svg-optimizer" ref="nofollow noopener noreferrer">SVGä¼˜åŒ–å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcolor-palette" target="_blank" title="https://tools.cmdragon.cn/zh/apps/color-palette" ref="nofollow noopener noreferrer">è°ƒè‰²æ¿ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fonline-metronome" target="_blank" title="https://tools.cmdragon.cn/zh/apps/online-metronome" ref="nofollow noopener noreferrer">åœ¨çº¿èŠ‚æ‹å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-geolocation" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-geolocation" ref="nofollow noopener noreferrer">IPå½’å±åœ°æŸ¥è¯¢ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcss-grid-layout" target="_blank" title="https://tools.cmdragon.cn/zh/apps/css-grid-layout" ref="nofollow noopener noreferrer">CSSç½‘æ ¼å¸ƒå±€ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Femail-validator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/email-validator" ref="nofollow noopener noreferrer">é‚®ç®±éªŒè¯å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcalligraphy-practice" target="_blank" title="https://tools.cmdragon.cn/zh/apps/calligraphy-practice" ref="nofollow noopener noreferrer">ä¹¦æ³•ç»ƒä¹ å­—å¸– - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ffinance-calculator-suite" target="_blank" title="https://tools.cmdragon.cn/zh/apps/finance-calculator-suite" ref="nofollow noopener noreferrer">é‡‘èè®¡ç®—å™¨å¥—ä»¶ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fchinese-kinship-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/chinese-kinship-calculator" ref="nofollow noopener noreferrer">ä¸­å›½äº²æˆšå…³ç³»è®¡ç®—å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fprotobuf-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/protobuf-toolkit" ref="nofollow noopener noreferrer">Protocol Buffer å·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-geolocation" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-geolocation" ref="nofollow noopener noreferrer">IPå½’å±åœ°æŸ¥è¯¢ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-upscaler" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-upscaler" ref="nofollow noopener noreferrer">å›¾ç‰‡æ— æŸæ”¾å¤§ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-compare" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-compare" ref="nofollow noopener noreferrer">æ–‡æœ¬æ¯”è¾ƒå·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-batch-lookup" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-batch-lookup" ref="nofollow noopener noreferrer">IPæ‰¹é‡æŸ¥è¯¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fdomain-finder" target="_blank" title="https://tools.cmdragon.cn/zh/apps/domain-finder" ref="nofollow noopener noreferrer">åŸŸåæŸ¥è¯¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fdns-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/dns-toolkit" ref="nofollow noopener noreferrer">DNSå·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ffavicon-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/favicon-generator" ref="nofollow noopener noreferrer">ç½‘ç«™å›¾æ ‡ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fsitemap_index.xml" target="_blank" title="https://tools.cmdragon.cn/sitemap_index.xml" ref="nofollow noopener noreferrer">XML Sitemap</a></li>
</ul>
</details>
<p>Vue3ç”¨<code>ref</code>æˆ–<code>reactive</code>åˆ›å»ºå“åº”å¼æ•°æ®ï¼Œå½“æ•°æ®å˜åŒ–æ—¶ï¼ŒVueä¼šè‡ªåŠ¨è¿½è¸ªä¾èµ–ï¼ˆæ¯”å¦‚æ¨¡æ¿ä¸­ç”¨åˆ°<code>username</code>çš„åœ°æ–¹ï¼‰ï¼Œå¹¶æ›´æ–°å¯¹åº”çš„è§†å›¾ã€‚è€Œ<code>v-model</code>æ­£æ˜¯åˆ©ç”¨äº†è¿™ä¸ªç³»ç»Ÿï¼Œè®©æ•°æ®å’Œè§†å›¾åŒå‘åŒæ­¥ã€‚</p>
<p>æ¯”å¦‚ç”¨<code>ref</code>åˆ›å»º<code>username</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> username = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)
</code></pre>
<p><code>ref</code>ä¼šæŠŠ<code>username</code>åŒ…è£…æˆä¸€ä¸ª<strong>å“åº”å¼å¯¹è±¡</strong>ï¼Œå½“ä½ ä¿®æ”¹<code>username.value</code>ï¼ˆæˆ–é€šè¿‡<code>v-model</code>ä¿®æ”¹ï¼‰ï¼ŒVueä¼šç«‹åˆ»çŸ¥é“ï¼Œå¹¶æ›´æ–°è§†å›¾ã€‚</p>
<h3 data-id="heading-10">å…­ã€å®é™…æ¡ˆä¾‹ï¼šæ‰“é€ ä¸€ä¸ªæ³¨å†Œè¡¨å•</h3>
<p>è®©æˆ‘ä»¬æŠŠå‰é¢çš„çŸ¥è¯†ç‚¹æ•´åˆèµ·æ¥ï¼Œåšä¸€ä¸ª<strong>æ³¨å†Œè¡¨å•</strong>ï¼ŒåŒ…å«ç”¨æˆ·åã€å¯†ç ã€è®°ä½æˆ‘ã€æ€§åˆ«ã€çˆ±å¥½ã€åŸå¸‚ï¼Œæäº¤æ—¶æ‰“å°è¡¨å•æ•°æ®ã€‚</p>
<h4 data-id="heading-11">å®Œæ•´ä»£ç ï¼ˆå¸¦æ ·å¼ï¼‰</h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-comment">// ç”¨refåˆ›å»ºè¡¨å•å¯¹è±¡ï¼ŒåŒ…å«æ‰€æœ‰å­—æ®µ</span>
<span class="hljs-keyword">const</span> form = <span class="hljs-title function_">ref</span>({
  <span class="hljs-attr">username</span>: <span class="hljs-string">''</span>,
  <span class="hljs-attr">password</span>: <span class="hljs-string">''</span>,
  <span class="hljs-attr">rememberMe</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">gender</span>: <span class="hljs-string">'male'</span>,
  <span class="hljs-attr">hobbies</span>: [],
  <span class="hljs-attr">city</span>: <span class="hljs-string">'beijing'</span>
})

<span class="hljs-comment">// æäº¤å¤„ç†å‡½æ•°ï¼šé˜»æ­¢é»˜è®¤åˆ·æ–°ï¼Œæ‰“å°è¡¨å•æ•°æ®</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSubmit</span> = (<span class="hljs-params">e</span>) =&gt; {
  e.<span class="hljs-title function_">preventDefault</span>()
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¡¨å•æ•°æ®ï¼š'</span>, form.<span class="hljs-property">value</span>)
  <span class="hljs-comment">// è¿™é‡Œå¯ä»¥åŠ å‘é€è¯·æ±‚åˆ°åå°çš„é€»è¾‘ï¼Œæ¯”å¦‚axios.post('/api/register', form.value)</span>
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"register-form"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>ç”¨æˆ·æ³¨å†Œ<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> @<span class="hljs-attr">submit.prevent</span>=<span class="hljs-string">"handleSubmit"</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- ç”¨æˆ·å --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"username"</span>&gt;</span>ç”¨æˆ·åï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> 
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> 
          <span class="hljs-attr">id</span>=<span class="hljs-string">"username"</span> 
          <span class="hljs-attr">v-model</span>=<span class="hljs-string">"form.username"</span> 
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥ç”¨æˆ·å"</span>
          <span class="hljs-attr">required</span>
        &gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      
      <span class="hljs-comment">&lt;!-- å¯†ç  --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"password"</span>&gt;</span>å¯†ç ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> 
          <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span> 
          <span class="hljs-attr">id</span>=<span class="hljs-string">"password"</span> 
          <span class="hljs-attr">v-model</span>=<span class="hljs-string">"form.password"</span> 
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥å¯†ç "</span>
          <span class="hljs-attr">required</span>
        &gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      
      <span class="hljs-comment">&lt;!-- è®°ä½æˆ‘ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"form.rememberMe"</span>&gt;</span> è®°ä½ç™»å½•çŠ¶æ€<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      
      <span class="hljs-comment">&lt;!-- æ€§åˆ« --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>æ€§åˆ«ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"radio"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"male"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"form.gender"</span>&gt;</span> ç”·
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"radio"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"female"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"form.gender"</span>&gt;</span> å¥³
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      
      <span class="hljs-comment">&lt;!-- çˆ±å¥½ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>çˆ±å¥½ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"reading"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"form.hobbies"</span>&gt;</span> é˜…è¯»
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"sports"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"form.hobbies"</span>&gt;</span> è¿åŠ¨
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"coding"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"form.hobbies"</span>&gt;</span> ç¼–ç¨‹
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      
      <span class="hljs-comment">&lt;!-- åŸå¸‚ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"city"</span>&gt;</span>åŸå¸‚ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"city"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"form.city"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"beijing"</span>&gt;</span>åŒ—äº¬<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"shanghai"</span>&gt;</span>ä¸Šæµ·<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"guangzhou"</span>&gt;</span>å¹¿å·<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"shenzhen"</span>&gt;</span>æ·±åœ³<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      
      <span class="hljs-comment">&lt;!-- æäº¤æŒ‰é’® --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"submit-btn"</span>&gt;</span>æ³¨å†Œ<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.register-form</span> {
  <span class="hljs-attribute">max-width</span>: <span class="hljs-number">400px</span>;
  <span class="hljs-attribute">margin</span>: <span class="hljs-number">20px</span> auto;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
  <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#eee</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
}
<span class="hljs-selector-class">.form-group</span> {
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">15px</span>;
}
<span class="hljs-selector-tag">label</span> {
  <span class="hljs-attribute">display</span>: block;
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">5px</span>;
}
<span class="hljs-selector-tag">input</span>, select {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">8px</span>;
  <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ddd</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>;
}
<span class="hljs-selector-class">.submit-btn</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#42b983</span>;
  <span class="hljs-attribute">color</span>: white;
  <span class="hljs-attribute">border</span>: none;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>;
  <span class="hljs-attribute">cursor</span>: pointer;
}
<span class="hljs-selector-class">.submit-btn</span><span class="hljs-selector-pseudo">:hover</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#3aa776</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<h4 data-id="heading-12">ä»£ç è¯´æ˜</h4>
<ol>
<li><strong>è¡¨å•æ•°æ®ç®¡ç†</strong>ï¼šç”¨<code>ref</code>åˆ›å»º<code>form</code>å¯¹è±¡ï¼ŒæŠŠæ‰€æœ‰è¡¨å•å­—æ®µæ”¾åœ¨ä¸€èµ·ï¼Œæ–¹ä¾¿ç®¡ç†ï¼›</li>
<li><strong>æäº¤å¤„ç†</strong>ï¼šç”¨<code>@submit.prevent</code>é˜»æ­¢è¡¨å•é»˜è®¤çš„åˆ·æ–°è¡Œä¸ºï¼Œæ‰“å°è¡¨å•æ•°æ®ï¼›</li>
<li><strong>å“åº”å¼åŒæ­¥</strong>ï¼šæ¯ä¸ªå­—æ®µç”¨<code>v-model</code>ç»‘å®šåˆ°<code>form</code>å¯¹è±¡çš„å±æ€§ï¼Œè¾“å…¥æ—¶è‡ªåŠ¨åŒæ­¥ã€‚</li>
</ol>
<h3 data-id="heading-13">ä¸ƒã€è¯¾åQuizï¼šå·©å›ºä½ çš„ç†è§£</h3>
<p>æ¥åšä¸¤ä¸ªå°ç»ƒä¹ ï¼Œæ£€éªŒä¸€ä¸‹å­¦ä¹ æˆæœï½</p>
<h4 data-id="heading-14">1. é—®é¢˜ï¼šv-modelçš„è¯­æ³•ç³–æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿè¯·å†™å‡ºç­‰ä»·çš„åŸç”Ÿç»‘å®šä»£ç ã€‚</h4>
<p><strong>ç­”æ¡ˆè§£æ</strong>ï¼š<br/>
v-modelæ˜¯<code>value</code>å±æ€§ç»‘å®š + <code>input</code>äº‹ä»¶ç›‘å¬çš„è¯­æ³•ç³–ã€‚æ¯”å¦‚<code>&lt;input v-model="message"&gt;</code>ç­‰ä»·äºï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">:value</span>=<span class="hljs-string">"message"</span> @<span class="hljs-attr">input</span>=<span class="hljs-string">"message = $event.target.value"</span>&gt;</span>
</code></pre>
<ul>
<li><code>:value="message"</code>ï¼šæŠŠæ•°æ®ç»‘å®šåˆ°è¾“å…¥æ¡†çš„valueå±æ€§ï¼›</li>
<li><code>@input</code>ï¼šç›‘å¬è¾“å…¥äº‹ä»¶ï¼ŒæŠŠè¾“å…¥å†…å®¹æ›´æ–°åˆ°<code>message</code>ã€‚</li>
</ul>
<h4 data-id="heading-15">2. é—®é¢˜ï¼šå¤šä¸ªå¤é€‰æ¡†å¦‚ä½•ç”¨v-modelå®ç°å¤šé€‰ï¼Ÿè¯·å†™å‡ºç¤ºä¾‹ä»£ç ã€‚</h4>
<p><strong>ç­”æ¡ˆè§£æ</strong>ï¼š<br/>
å¤šä¸ªå¤é€‰æ¡†éœ€è¦ç»‘å®šåˆ°<strong>æ•°ç»„ç±»å‹</strong>çš„å“åº”å¼æ•°æ®ã€‚æ¯ä¸ªå¤é€‰æ¡†çš„<code>value</code>å¯¹åº”æ•°ç»„ä¸­çš„å…ƒç´ ï¼Œé€‰ä¸­æ—¶åŠ å…¥æ•°ç»„ï¼Œå–æ¶ˆæ—¶ç§»é™¤ã€‚ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">const</span> hobbies = <span class="hljs-title function_">ref</span>([]) <span class="hljs-comment">// æ•°ç»„ç±»å‹</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"reading"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"hobbies"</span>&gt;</span> é˜…è¯»<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"sports"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"hobbies"</span>&gt;</span> è¿åŠ¨<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"coding"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"hobbies"</span>&gt;</span> ç¼–ç¨‹<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<p>æ¯”å¦‚é€‰ä¸­â€œé˜…è¯»â€å’Œâ€œç¼–ç¨‹â€ï¼Œ<code>hobbies.value</code>ä¼šå˜æˆ<code>['reading', 'coding']</code>ã€‚</p>
<h3 data-id="heading-16">å…«ã€å¸¸è§æŠ¥é”™ä¸è§£å†³æ–¹æ¡ˆ</h3>
<p>å­¦ä¹ è¿‡ç¨‹ä¸­é‡åˆ°æŠ¥é”™åˆ«æ…Œï¼Œä»¥ä¸‹æ˜¯è¡¨å•ç»‘å®šå¸¸è§çš„3ä¸ªé”™è¯¯åŠè§£å†³åŠæ³•ï¼š</p>
<h4 data-id="heading-17">1. æŠ¥é”™ï¼š<code>v-model is not allowed on &lt;input type="file"&gt;</code></h4>
<ul>
<li><strong>åŸå› </strong>ï¼šæ–‡ä»¶è¾“å…¥æ¡†ï¼ˆ<code>type="file"</code>ï¼‰çš„<code>value</code>æ˜¯<strong>åªè¯»</strong>çš„ï¼Œæ— æ³•é€šè¿‡<code>v-model</code>ä¿®æ”¹ã€‚</li>
<li><strong>è§£å†³åŠæ³•</strong>ï¼šç”¨<code>ref</code>è·å–DOMå…ƒç´ ï¼Œç›‘å¬<code>change</code>äº‹ä»¶æ‹¿æ–‡ä»¶ï¼š
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">const</span> fileInput = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>)
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleFile</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> file = fileInput.<span class="hljs-property">value</span>.<span class="hljs-property">files</span>[<span class="hljs-number">0</span>] <span class="hljs-comment">// è·å–é€‰ä¸­çš„æ–‡ä»¶</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ–‡ä»¶ï¼š'</span>, file)
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"file"</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"fileInput"</span> @<span class="hljs-attr">change</span>=<span class="hljs-string">"handleFile"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
</li>
</ul>
<h4 data-id="heading-18">2. æŠ¥é”™ï¼š<code>Property "message" was accessed during render but is not defined</code></h4>
<ul>
<li><strong>åŸå› </strong>ï¼šæ¨¡æ¿é‡Œç”¨äº†<code>message</code>ï¼Œä½†æ²¡åœ¨<code>setup</code>ä¸­å®šä¹‰å“åº”å¼æ•°æ®ã€‚</li>
<li><strong>è§£å†³åŠæ³•</strong>ï¼šç”¨<code>ref</code>æˆ–<code>reactive</code>å®šä¹‰<code>message</code>ï¼š
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">const</span> message = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>) <span class="hljs-comment">// å¿…é¡»å®šä¹‰ï¼</span>
</code></pre>
</li>
</ul>
<h4 data-id="heading-19">3. æŠ¥é”™ï¼š<code>v-model requires a valid Vue instance</code></h4>
<ul>
<li><strong>åŸå› </strong>ï¼šå¯èƒ½åœ¨éVueç»„ä»¶ä¸­ç”¨äº†<code>v-model</code>ï¼ˆæ¯”å¦‚çº¯HTMLæ–‡ä»¶æ²¡æŒ‚è½½Vueï¼‰ï¼Œæˆ–ç»„ä»¶æœªæ­£ç¡®æ³¨å†Œã€‚</li>
<li><strong>è§£å†³åŠæ³•</strong>ï¼šç¡®ä¿åœ¨Vueç»„ä»¶ä¸­ä½¿ç”¨ï¼Œå¹¶æ­£ç¡®æŒ‚è½½åº”ç”¨ï¼š
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// main.js</span>
<span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span>
<span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>).<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>) <span class="hljs-comment">// æŒ‚è½½åˆ°#appå…ƒç´ </span>
</code></pre>
</li>
</ul>
<h3 data-id="heading-20">å‚è€ƒé“¾æ¥</h3>
<p>å®˜ç½‘è¡¨å•å¤„ç†æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2Fguide%2Fessentials%2Fforms.html" target="_blank" title="https://vuejs.org/guide/essentials/forms.html" ref="nofollow noopener noreferrer">vuejs.org/guide/essenâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[CSS Container Queriesï¼šå®ç°å“åº”å¼è®¾è®¡çš„æ–°æ€è·¯]]></title>    <link>https://juejin.cn/post/7595896809651879976</link>    <guid>https://juejin.cn/post/7595896809651879976</guid>    <pubDate>2026-01-17T11:10:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595896809651879976" data-draft-id="7595864836360814644" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="CSS Container Queriesï¼šå®ç°å“åº”å¼è®¾è®¡çš„æ–°æ€è·¯"/> <meta itemprop="keywords" content="CSS"/> <meta itemprop="datePublished" content="2026-01-17T11:10:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AIäº§å“åº“AIProduchHub"/> <meta itemprop="url" content="https://juejin.cn/user/2420466240993888"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            CSS Container Queriesï¼šå®ç°å“åº”å¼è®¾è®¡çš„æ–°æ€è·¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2420466240993888/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AIäº§å“åº“AIProduchHub
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T11:10:47.000Z" title="Sat Jan 17 2026 11:10:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">CSS Container Queriesï¼šå®ç°å“åº”å¼è®¾è®¡çš„æ–°æ€è·¯</h2>
<p>ä½œä¸ºä¸€åå‰ç«¯å¼€å‘è€…ï¼Œæˆ‘ç›¸ä¿¡ä½ ä¸€å®šå¯¹åª’ä½“æŸ¥è¯¢ï¼ˆMedia Queriesï¼‰ä¸é™Œç”Ÿã€‚å¤šå¹´æ¥ï¼Œæˆ‘ä»¬ä¸€ç›´ä¾èµ– <code>@media</code> è§„åˆ™æ¥åˆ›å»ºå“åº”å¼è®¾è®¡ï¼Œæ ¹æ®å±å¹•å°ºå¯¸è°ƒæ•´æ ·å¼ã€‚ä½†éšç€ç»„ä»¶åŒ–å¼€å‘çš„æ™®åŠå’Œè®¾è®¡å¤æ‚æ€§çš„å¢åŠ ï¼Œæˆ‘ä»¬é€æ¸å‘ç°äº†åª’ä½“æŸ¥è¯¢çš„å±€é™æ€§ã€‚ä»Šå¤©ï¼Œæˆ‘æƒ³å’Œå¤§å®¶åˆ†äº«ä¸€ä¸ªæ¿€åŠ¨äººå¿ƒçš„æ–°ç‰¹æ€§â€”â€”CSS Container Queriesï¼Œå®ƒæ­£åœ¨æ”¹å˜æˆ‘ä»¬æ€è€ƒå’Œå®ç°å“åº”å¼è®¾è®¡çš„æ–¹å¼ã€‚</p>
<h3 data-id="heading-1">åª’ä½“æŸ¥è¯¢çš„å›°å¢ƒ</h3>
<p>åœ¨æ·±å…¥äº†è§£ Container Queries ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹ä¼ ç»Ÿåª’ä½“æŸ¥è¯¢çš„é™åˆ¶ã€‚</p>
<p>æƒ³è±¡è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªå¡ç‰‡ç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶å¯èƒ½ä¼šå‡ºç°åœ¨é¡µé¢çš„ä¸åŒä½ç½®â€”â€”æœ‰æ—¶å æ®æ•´ä¸ªå®½åº¦ï¼Œæœ‰æ—¶åªå æ®ä¾§è¾¹æ çš„ä¸€å°éƒ¨åˆ†ã€‚ä½¿ç”¨ä¼ ç»Ÿçš„åª’ä½“æŸ¥è¯¢ï¼Œæˆ‘ä»¬åªèƒ½åŸºäºæ•´ä¸ªè§†å£çš„å°ºå¯¸æ¥è°ƒæ•´æ ·å¼ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.card</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">1rem</span>;
  <span class="hljs-attribute">background</span>: white;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
}

<span class="hljs-selector-class">.card</span> <span class="hljs-selector-tag">h2</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.2rem</span>;
}

<span class="hljs-keyword">@media</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">768px</span>) {
  <span class="hljs-selector-class">.card</span> <span class="hljs-selector-tag">h2</span> {
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.5rem</span>;
  }
}
</code></pre>
<p>è¿™ç§æ–¹æ³•çš„é—®é¢˜åœ¨äºï¼Œå³ä½¿å¡ç‰‡æœ¬èº«å¾ˆå°ï¼ˆæ¯”å¦‚åœ¨ä¾§è¾¹æ ä¸­ï¼‰ï¼Œä½†å¦‚æœè§†å£å®½åº¦è¶…è¿‡äº†768pxï¼Œæ ‡é¢˜ä»ç„¶ä¼šä½¿ç”¨è¾ƒå¤§çš„å­—ä½“ï¼Œè¿™å¯èƒ½å¯¼è‡´å¸ƒå±€é—®é¢˜ã€‚</p>
<h3 data-id="heading-2">Container Queries çš„é©å‘½æ€§æ€è·¯</h3>
<p>Container Queries çš„å‡ºç°è§£å†³äº†è¿™ä¸ªæ ¹æœ¬é—®é¢˜ã€‚å®ƒå…è®¸æˆ‘ä»¬åŸºäº<strong>å®¹å™¨çš„å°ºå¯¸</strong>è€Œä¸æ˜¯è§†å£çš„å°ºå¯¸æ¥åº”ç”¨æ ·å¼ã€‚è¿™æ„å‘³ç€ç»„ä»¶å¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…å¯ç”¨ç©ºé—´æ¥è°ƒæ•´å¤–è§‚ï¼ŒçœŸæ­£å®ç°äº†ç»„ä»¶çº§åˆ«çš„å“åº”å¼è®¾è®¡ã€‚</p>
<h4 data-id="heading-3">åŸºæœ¬è¯­æ³•å’Œä½¿ç”¨</h4>
<p>è¦ä½¿ç”¨ Container Queriesï¼Œé¦–å…ˆéœ€è¦å®šä¹‰ä¸€ä¸ªå®¹å™¨ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.card-container</span> {
  container-type: inline-size;
  <span class="hljs-comment">/* æˆ–è€…ä½¿ç”¨ç®€å†™ */</span>
  container: card-container / inline-size;
}
</code></pre>
<p>ç„¶åå°±å¯ä»¥ä½¿ç”¨ <code>@container</code> è§„åˆ™äº†ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.card</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">1rem</span>;
  <span class="hljs-attribute">background</span>: white;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
}

<span class="hljs-selector-class">.card</span> <span class="hljs-selector-tag">h2</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.2rem</span>;
}

<span class="hljs-keyword">@container</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">400px</span>) {
  <span class="hljs-selector-class">.card</span> <span class="hljs-selector-tag">h2</span> {
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.5rem</span>;
  }
  
  <span class="hljs-selector-class">.card</span> {
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">2rem</span>;
  }
}

<span class="hljs-keyword">@container</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">600px</span>) {
  <span class="hljs-selector-class">.card</span> {
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">align-items</span>: center;
  }
  
  <span class="hljs-selector-class">.card</span> <span class="hljs-selector-tag">h2</span> {
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.8rem</span>;
  }
}
</code></pre>
<h3 data-id="heading-4">å®é™…åº”ç”¨æ¡ˆä¾‹</h3>
<p>è®©æˆ‘é€šè¿‡ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­æ¥å±•ç¤º Container Queries çš„å¼ºå¤§ä¹‹å¤„ã€‚å‡è®¾æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªäº§å“å¡ç‰‡ç»„ä»¶ï¼Œå®ƒéœ€è¦åœ¨ä¸åŒçš„å®¹å™¨ä¸­è¡¨ç°å‡ºä¸åŒçš„å¸ƒå±€ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"main-content"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"product-card"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"product.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"äº§å“å›¾ç‰‡"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"product-info"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>äº§å“æ ‡é¢˜<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>äº§å“æè¿°æ–‡æœ¬...<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"product-price"</span>&gt;</span>Â¥199<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>ç«‹å³è´­ä¹°<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">aside</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"sidebar"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"product-card"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- ç›¸åŒçš„HTMLç»“æ„ --&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">aside</span>&gt;</span>
</code></pre>
<p>CSSå®ç°ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* å®šä¹‰å®¹å™¨ */</span>
<span class="hljs-selector-class">.main-content</span>,
<span class="hljs-selector-class">.sidebar</span> {
  container-type: inline-size;
}

<span class="hljs-comment">/* åŸºç¡€æ ·å¼ */</span>
<span class="hljs-selector-class">.product-card</span> {
  <span class="hljs-attribute">background</span>: white;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">12px</span>;
  <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">2px</span> <span class="hljs-number">8px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.1</span>);
  <span class="hljs-attribute">overflow</span>: hidden;
}

<span class="hljs-selector-class">.product-card</span> <span class="hljs-selector-tag">img</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;
  <span class="hljs-attribute">object-fit</span>: cover;
}

<span class="hljs-selector-class">.product-info</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">1rem</span>;
}

<span class="hljs-selector-class">.product-info</span> <span class="hljs-selector-tag">h3</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.1rem</span>;
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">0.5rem</span>;
}

<span class="hljs-selector-class">.product-price</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.2rem</span>;
  <span class="hljs-attribute">font-weight</span>: bold;
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#e74c3c</span>;
  <span class="hljs-attribute">margin</span>: <span class="hljs-number">0.5rem</span> <span class="hljs-number">0</span>;
}

<span class="hljs-comment">/* ä¸­ç­‰å°ºå¯¸å®¹å™¨ */</span>
<span class="hljs-keyword">@container</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">320px</span>) {
  <span class="hljs-selector-class">.product-card</span> {
    <span class="hljs-attribute">display</span>: flex;
  }
  
  <span class="hljs-selector-class">.product-card</span> <span class="hljs-selector-tag">img</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">150px</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">120px</span>;
    <span class="hljs-attribute">flex-shrink</span>: <span class="hljs-number">0</span>;
  }
  
  <span class="hljs-selector-class">.product-info</span> <span class="hljs-selector-tag">h3</span> {
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.2rem</span>;
  }
}

<span class="hljs-comment">/* å¤§å°ºå¯¸å®¹å™¨ */</span>
<span class="hljs-keyword">@container</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">500px</span>) {
  <span class="hljs-selector-class">.product-card</span> <span class="hljs-selector-tag">img</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">150px</span>;
  }
  
  <span class="hljs-selector-class">.product-info</span> {
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">1.5rem</span>;
  }
  
  <span class="hljs-selector-class">.product-info</span> <span class="hljs-selector-tag">h3</span> {
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.4rem</span>;
  }
  
  <span class="hljs-selector-class">.product-price</span> {
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.4rem</span>;
  }
}
</code></pre>
<h3 data-id="heading-5">å®¹å™¨ç±»å‹è¯¦è§£</h3>
<p>Container Queries æ”¯æŒå‡ ç§ä¸åŒçš„å®¹å™¨ç±»å‹ï¼š</p>
<h4 data-id="heading-6">1. inline-size</h4>
<p>è¿™æ˜¯æœ€å¸¸ç”¨çš„ç±»å‹ï¼Œç›‘å¬å®¹å™¨çš„å†…è”å°ºå¯¸ï¼ˆé€šå¸¸æ˜¯å®½åº¦ï¼‰ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.container</span> {
  container-type: inline-size;
}
</code></pre>
<h4 data-id="heading-7">2. size</h4>
<p>ç›‘å¬å®¹å™¨çš„æ‰€æœ‰å°ºå¯¸ï¼ˆå®½åº¦å’Œé«˜åº¦ï¼‰ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.container</span> {
  container-type: size;
}

<span class="hljs-keyword">@container</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">400px</span>) <span class="hljs-keyword">and</span> (<span class="hljs-attribute">min-height</span>: <span class="hljs-number">300px</span>) {
  <span class="hljs-comment">/* æ ·å¼è§„åˆ™ */</span>
}
</code></pre>
<h4 data-id="heading-8">3. normal</h4>
<p>é»˜è®¤å€¼ï¼Œä¸åˆ›å»ºå®¹å™¨æŸ¥è¯¢ä¸Šä¸‹æ–‡ã€‚</p>
<h3 data-id="heading-9">å‘½åå®¹å™¨æŸ¥è¯¢</h3>
<p>ä¸ºäº†æ›´å¥½åœ°ç»„ç»‡ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥ç»™å®¹å™¨å‘½åï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.sidebar</span> {
  container: sidebar-container / inline-size;
}

<span class="hljs-selector-class">.main-content</span> {
  container: main-container / inline-size;
}

<span class="hljs-keyword">@container</span> sidebar-container (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">300px</span>) {
  <span class="hljs-selector-class">.product-card</span> {
    <span class="hljs-comment">/* ä¾§è¾¹æ ç‰¹å®šæ ·å¼ */</span>
  }
}

<span class="hljs-keyword">@container</span> main-container (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">800px</span>) {
  <span class="hljs-selector-class">.product-card</span> {
    <span class="hljs-comment">/* ä¸»å†…å®¹åŒºç‰¹å®šæ ·å¼ */</span>
  }
}
</code></pre>
<h3 data-id="heading-10">ä¸CSS Grid/Flexboxçš„å®Œç¾ç»“åˆ</h3>
<p>Container Queries ä¸ç°ä»£å¸ƒå±€æŠ€æœ¯ç»“åˆä½¿ç”¨æ—¶å¨åŠ›æ›´å¤§ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.grid-container</span> {
  container-type: inline-size;
  <span class="hljs-attribute">display</span>: grid;
  <span class="hljs-attribute">gap</span>: <span class="hljs-number">1rem</span>;
  <span class="hljs-attribute">grid-template-columns</span>: <span class="hljs-built_in">repeat</span>(auto-fit, <span class="hljs-built_in">minmax</span>(<span class="hljs-number">250px</span>, <span class="hljs-number">1</span>fr));
}

<span class="hljs-selector-class">.grid-item</span> {
  container-type: inline-size;
}

<span class="hljs-keyword">@container</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">300px</span>) {
  <span class="hljs-selector-class">.grid-item</span> <span class="hljs-selector-class">.content</span> {
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">flex-direction</span>: column;
    <span class="hljs-attribute">gap</span>: <span class="hljs-number">1rem</span>;
  }
}

<span class="hljs-keyword">@container</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">400px</span>) {
  <span class="hljs-selector-class">.grid-item</span> <span class="hljs-selector-class">.content</span> {
    <span class="hljs-attribute">flex-direction</span>: row;
    <span class="hljs-attribute">align-items</span>: center;
  }
}
</code></pre>
<h3 data-id="heading-11">æ€§èƒ½è€ƒé‡å’Œæœ€ä½³å®è·µ</h3>
<p>åœ¨ä½¿ç”¨ Container Queries æ—¶ï¼Œæœ‰å‡ ä¸ªé‡è¦çš„æ€§èƒ½å’Œä½¿ç”¨åŸåˆ™ï¼š</p>
<h4 data-id="heading-12">1. é¿å…å¾ªç¯ä¾èµ–</h4>
<p>ç¡®ä¿å®¹å™¨çš„å°ºå¯¸ä¸ä¾èµ–äºå…¶å†…å®¹çš„æŸ¥è¯¢ç»“æœï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* é¿å…è¿™æ ·åš */</span>
<span class="hljs-selector-class">.container</span> {
  container-type: inline-size;
  <span class="hljs-attribute">width</span>: fit-content; <span class="hljs-comment">/* å¯èƒ½å¯¼è‡´å¾ªç¯ä¾èµ– */</span>
}
</code></pre>
<h4 data-id="heading-13">2. åˆç†ä½¿ç”¨å®¹å™¨ç±»å‹</h4>
<p>åªæœ‰åœ¨çœŸæ­£éœ€è¦æ—¶æ‰è®¾ç½® <code>container-type: size</code>ï¼Œå› ä¸ºå®ƒçš„æ€§èƒ½å¼€é”€æ¯” <code>inline-size</code> æ›´å¤§ã€‚</p>
<h4 data-id="heading-14">3. æ¸è¿›å¢å¼º</h4>
<p>ä¸ºä¸æ”¯æŒ Container Queries çš„æµè§ˆå™¨æä¾›å›é€€æ–¹æ¡ˆï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* å›é€€æ ·å¼ */</span>
<span class="hljs-selector-class">.card</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">1rem</span>;
}

<span class="hljs-selector-class">.card</span> <span class="hljs-selector-tag">h2</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.2rem</span>;
}

<span class="hljs-comment">/* æ”¯æŒ Container Queries æ—¶çš„å¢å¼º */</span>
<span class="hljs-keyword">@supports</span> (<span class="hljs-attribute">container-type</span>: inline-size) {
  <span class="hljs-selector-class">.card-container</span> {
    container-type: inline-size;
  }
  
  <span class="hljs-keyword">@container</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">400px</span>) {
    <span class="hljs-selector-class">.card</span> {
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">2rem</span>;
    }
    
    <span class="hljs-selector-class">.card</span> <span class="hljs-selector-tag">h2</span> {
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.5rem</span>;
    }
  }
}
</code></pre>
<h3 data-id="heading-15">æµè§ˆå™¨å…¼å®¹æ€§å’ŒPolyfill</h3>
<p>æˆªè‡³2024å¹´ï¼ŒContainer Queries å·²ç»åœ¨ç°ä»£æµè§ˆå™¨ä¸­å¾—åˆ°äº†è‰¯å¥½æ”¯æŒï¼š</p>
<ul>
<li>Chrome 105+</li>
<li>Firefox 110+</li>
<li>Safari 16+</li>
</ul>
<p>å¯¹äºéœ€è¦æ”¯æŒæ—§ç‰ˆæµè§ˆå™¨çš„é¡¹ç›®ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ polyfill æˆ–é‡‡ç”¨æ¸è¿›å¢å¼ºçš„ç­–ç•¥ã€‚</p>
<h3 data-id="heading-16">å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨åœºæ™¯</h3>
<h4 data-id="heading-17">1. ç»„ä»¶åº“å¼€å‘</h4>
<p>åœ¨å¼€å‘å¯å¤ç”¨ç»„ä»¶æ—¶ï¼ŒContainer Queries è®©ç»„ä»¶çœŸæ­£åšåˆ°äº†è‡ªé€‚åº”ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.button-group</span> {
  container-type: inline-size;
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">gap</span>: <span class="hljs-number">0.5rem</span>;
}

<span class="hljs-keyword">@container</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">200px</span>) {
  <span class="hljs-selector-class">.button-group</span> {
    <span class="hljs-attribute">flex-direction</span>: column;
  }
}
</code></pre>
<h4 data-id="heading-18">2. å¤æ‚å¸ƒå±€ç³»ç»Ÿ</h4>
<p>åœ¨å¤æ‚çš„åå°ç®¡ç†ç³»ç»Ÿä¸­ï¼Œä¸åŒåŒºåŸŸçš„ç»„ä»¶å¯ä»¥æ ¹æ®å®é™…ç©ºé—´çµæ´»è°ƒæ•´ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.dashboard-widget</span> {
  container-type: inline-size;
}

<span class="hljs-keyword">@container</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">300px</span>) {
  <span class="hljs-selector-class">.chart-widget</span> {
    <span class="hljs-comment">/* æ˜¾ç¤ºå®Œæ•´å›¾è¡¨ */</span>
  }
}

<span class="hljs-keyword">@container</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">299px</span>) {
  <span class="hljs-selector-class">.chart-widget</span> {
    <span class="hljs-comment">/* æ˜¾ç¤ºç®€åŒ–ç‰ˆæœ¬ */</span>
  }
}
</code></pre>
<p>CSS Container Queries ä»£è¡¨äº†å“åº”å¼è®¾è®¡æ€ç»´çš„é‡å¤§è½¬å˜ã€‚ä»å…³æ³¨å…¨å±€è§†å£åˆ°å…³æ³¨å±€éƒ¨å®¹å™¨ï¼Œè¿™ç§å˜åŒ–è®©æˆ‘ä»¬èƒ½å¤Ÿåˆ›å»ºæ›´åŠ çµæ´»ã€å¯å¤ç”¨çš„ç»„ä»¶ã€‚è™½ç„¶å®ƒè¿˜æ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°çš„ç‰¹æ€§ï¼Œä½†æˆ‘ç›¸ä¿¡éšç€æµè§ˆå™¨æ”¯æŒçš„å®Œå–„å’Œå¼€å‘è€…è®¤çŸ¥çš„æå‡ï¼ŒContainer Queries å°†æˆä¸ºç°ä»£å‰ç«¯å¼€å‘çš„é‡è¦å·¥å…·ã€‚</p>
<p>ä½œä¸ºå‰ç«¯å¼€å‘è€…ï¼Œæˆ‘å»ºè®®å¤§å®¶å¼€å§‹åœ¨æ–°é¡¹ç›®ä¸­å°è¯•ä½¿ç”¨ Container Queriesï¼Œç‰¹åˆ«æ˜¯åœ¨ç»„ä»¶åŒ–å¼€å‘ä¸­ã€‚å®ƒä¸ä»…èƒ½è§£å†³ä¼ ç»Ÿåª’ä½“æŸ¥è¯¢çš„å±€é™æ€§ï¼Œæ›´èƒ½è®©æˆ‘ä»¬çš„ä»£ç æ›´åŠ æ¨¡å—åŒ–å’Œå¯ç»´æŠ¤ã€‚</p>
<p>å“åº”å¼è®¾è®¡çš„æœªæ¥å·²ç»åˆ°æ¥ï¼Œä½ å‡†å¤‡å¥½æ‹¥æŠ±è¿™ä¸ªå˜åŒ–äº†å—ï¼Ÿ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€å‰ç«¯å…¥é—¨ã€‘å¦‚ä½•ç”¨JSåšä¾§è¾¹æ å±•å¼€å’Œå…³é—­åŠ¨ç”»ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7595842144907100210</link>    <guid>https://juejin.cn/post/7595842144907100210</guid>    <pubDate>2026-01-17T11:17:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595842144907100210" data-draft-id="7595808703074566170" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€å‰ç«¯å…¥é—¨ã€‘å¦‚ä½•ç”¨JSåšä¾§è¾¹æ å±•å¼€å’Œå…³é—­åŠ¨ç”»ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-17T11:17:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="vmiao"/> <meta itemprop="url" content="https://juejin.cn/user/2930638589534635"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€å‰ç«¯å…¥é—¨ã€‘å¦‚ä½•ç”¨JSåšä¾§è¾¹æ å±•å¼€å’Œå…³é—­åŠ¨ç”»ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2930638589534635/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    vmiao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T11:17:55.000Z" title="Sat Jan 17 2026 11:17:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ‘˜è¦</h2>
<p>åœ¨å¾ˆå¤šç”µå•†çš„pcç«¯ç½‘é¡µï¼Œæˆ‘ä»¬å¾€å¾€èƒ½çœ‹åˆ°é‚£ä¸ªå†ç†Ÿæ‚‰ä¸è¿‡çš„ä¾§è¾¹æ ã€‚å½“æˆ‘ä»¬é¼ æ ‡æ”¾ä¸Šå»æ—¶ï¼Œå®ƒå°±ä¼šä¸æ»‘çš„å¼¹å‡ºä¸€ä¸ªå†…å®¹çš„ç›’å­ï¼Œå½“ä½ ç¦»å¼€ï¼Œè¿™ä¸ªç›’å­åˆåƒå¼¹ç°§ä¸€æ ·æ”¶ç¼©å›å»ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦ç”¨JSåšå‡ºè¿™ä¸ªç®€å•çš„åŠ¨ç”»æ•ˆæœ...</p>
<h2 data-id="heading-1">ä¸€ã€ç¼“åŠ¨åŠ¨ç”»åŸç†</h2>
<p>æ³¨ï¼šä»¥å·¦å³ç§»åŠ¨æ•ˆæœä¸ºä¾‹</p>
<p>1.é¦–å…ˆè·å¾—ç›’å­åŸå§‹çš„ä½ç½® ï¼ˆç›’å­è¦æœ‰å®šä½ï¼Œå› ä¸ºæ˜¯åˆ©ç”¨ç›’å­çš„leftå±æ€§ç§»åŠ¨ï¼‰<br/>
2.è®©ç›’å­åœ¨å½“å‰ä½ç½®ä¸Šç§»åŠ¨ä¸€ä¸ªè·ç¦»<br/>
3.æ·»åŠ å®šæ—¶å™¨setInterval()é‡å¤2ä¸­çš„æ“ä½œ<br/>
4.åˆ°è¾¾æŒ‡å®šä½ç½®åæ¸…é™¤å®šæ—¶å™¨ clearInterval</p>
<h2 data-id="heading-2">äºŒã€ä»£ç å®ç°</h2>
<p>1.é¦–å…ˆå‡†å¤‡ä¸€ä¸ªå¤§ç›’å­,åŒ…å«ä¸€ä¸ªspanå’Œä¸€ä¸ªç”¨æ¥æ»‘åŠ¨çš„ç›’å­</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span> = <span class="hljs-string">"slider_bar"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>å±•å¼€<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span> = <span class="hljs-string">"con"</span>&gt;</span>å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>2.ä¸ºç›’å­è®¾ç½®æ ·å¼</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.slider_bar</span>{
    <span class="hljs-attribute">position</span>:absolute;
    <span class="hljs-attribute">right</span>:<span class="hljs-number">0</span>;
    <span class="hljs-attribute">top</span>:<span class="hljs-number">500px</span>;
    <span class="hljs-attribute">width</span>:<span class="hljs-number">100px</span>;
    <span class="hljs-attribute">height</span>:<span class="hljs-number">100px</span>;
}
<span class="hljs-selector-class">.span</span>{
    <span class="hljs-attribute">display</span>:block;
    <span class="hljs-attribute">width</span>:<span class="hljs-number">100px</span>;
    <span class="hljs-attribute">height</span>:<span class="hljs-number">100px</span>;
    <span class="hljs-attribute">background-color</span>:pink;
}
<span class="hljs-selector-class">.con</span>{
    <span class="hljs-attribute">position</span>:absolute;
    <span class="hljs-attribute">left</span>:<span class="hljs-number">0</span>;
    <span class="hljs-attribute">top</span>:<span class="hljs-number">0</span>;
    <span class="hljs-attribute">width</span>:<span class="hljs-number">300px</span>;
    <span class="hljs-attribute">height</span>:<span class="hljs-number">100px</span>;
    <span class="hljs-attribute">z-index</span>:-<span class="hljs-number">1</span>;
}
</code></pre>
<p>å› ä¸ºcssçš„å±‚å æ€§ï¼Œè¦ç»™.conè®¾ç½®z-index:-1,æŠŠæ»‘åŠ¨ç›’å­æ”¾åœ¨spanä¸‹é¢éšè—èµ·æ¥</p>
<p>3.å†™ä¸€ä¸ªèƒ½å¤Ÿå®ç°å·¦å³ç§»åŠ¨åŠ¨ç”»å‡½æ•°</p>
<pre><code class="hljs language-ini" lang="ini">function animate(obj,target,callback){
    clearInterval(obj.timer)<span class="hljs-comment">;</span>
    <span class="hljs-attr">obj.timer</span> = setInterval(function(){
        var <span class="hljs-attr">step</span> = (target - obj.<span class="hljs-literal">off</span>setLeft)/<span class="hljs-number">10</span><span class="hljs-comment">;</span>
        <span class="hljs-attr">step</span> = step &gt; <span class="hljs-number">0</span> ? Math.ceil(step) : Math.floor(step)<span class="hljs-comment">; </span>
        if(<span class="hljs-attr">obj.offsetLeft</span> == target){
            clearInterval(obj.timer)<span class="hljs-comment">;</span>
            if(callback){
                callback()<span class="hljs-comment">;</span>
            }
        }
        else{
            <span class="hljs-attr">obj.style.left</span> = obj.<span class="hljs-literal">off</span>setLeft + step + <span class="hljs-string">'px'</span><span class="hljs-comment">;</span>
        }
    },30)
}
</code></pre>
<p>4.ç»‘å®šæ˜¾ç¤ºå’Œéšè—äº‹ä»¶</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">var</span> sliderbar = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">".slider_bar"</span>);
    <span class="hljs-keyword">var</span> con = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">".con"</span>);
    sliderbar.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"mouseenter"</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
      <span class="hljs-title function_">animate</span>(con,-<span class="hljs-number">200</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
          sliderbar.<span class="hljs-property">children</span>[<span class="hljs-number">0</span>].<span class="hljs-property">innerHTML</span> = <span class="hljs-string">'å…³é—­'</span>;
     ) })  
    }
    sliderbar.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"mouseleave"</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
      <span class="hljs-title function_">animate</span>(con,<span class="hljs-number">0</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
          sliderbar.<span class="hljs-property">children</span>[<span class="hljs-number">0</span>].<span class="hljs-property">innerHTML</span> = <span class="hljs-string">'å±•å¼€'</span>;
     ) })  
    }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> 
</code></pre>
<h2 data-id="heading-3">ä¸‰ã€ç‰¹åˆ«æ ‡æ³¨</h2>
<p>1.å½“æ­¥é•¿(step)ä¸ºæ­£æ•°æ—¶ï¼Œè¦å‘ä¸Šå–æ•´(Math.ceil());ä¸ºè´Ÿæ•°æ—¶ï¼Œè¦å‘ä¸‹å–æ•´(Math.floor())ã€‚
2.è¿åŠ¨é€Ÿåº¦å…ˆå¿«åæ…¢ï¼Œç¼“åŠ¨æ•ˆæœï¼Œç”¨å…¬å¼ï¼šï¼ˆç›®æ ‡ä½ç½®-ç°åœ¨ä½ç½®ï¼‰/10.
3.å›è°ƒå‡½æ•°åšå‚æ•°ï¼Œcallbackå°±ç›¸å½“äºå£°æ˜çš„å‡½æ•°ä½“ï¼Œæ‰€ä»¥å‡½æ•°è°ƒç”¨ç›´æ¥å†™callback();</p>
<h2 data-id="heading-4">å››ã€å®Œæ•´ä»£ç ç¤ºä¾‹</h2>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ç¼“åŠ¨åŠ¨ç”»åŸç†<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
      <span class="hljs-selector-class">.slider_bar</span> {
          <span class="hljs-attribute">right</span>: <span class="hljs-number">0</span>;
          <span class="hljs-attribute">top</span>: <span class="hljs-number">500px</span>;
          <span class="hljs-attribute">position</span>: absolute;
          <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
          <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
      }

      <span class="hljs-selector-tag">span</span> {
          <span class="hljs-attribute">display</span>: block;
          <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
          <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
          <span class="hljs-attribute">background-color</span>: pink;
      }

      <span class="hljs-selector-class">.con</span> {
          <span class="hljs-attribute">position</span>: absolute;
          <span class="hljs-attribute">left</span>: <span class="hljs-number">0px</span>;
          <span class="hljs-attribute">top</span>: <span class="hljs-number">0px</span>;
          <span class="hljs-attribute">width</span>: <span class="hljs-number">300px</span>;
          <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
          <span class="hljs-attribute">background-color</span>: blueviolet;
          <span class="hljs-attribute">z-index</span>: -<span class="hljs-number">1</span>;
      }
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/practice1/animate.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"slider_bar"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>å±•å¼€<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"con"</span>&gt;</span>é—®é¢˜åé¦ˆ<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
      <span class="hljs-keyword">var</span> sliderBar = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">".slider_bar"</span>);
      <span class="hljs-keyword">var</span> con = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">".con"</span>);
      sliderBar.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"mouseenter"</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
          <span class="hljs-title function_">animate</span>(con, -<span class="hljs-number">200</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
              sliderBar.<span class="hljs-property">children</span>[<span class="hljs-number">0</span>].<span class="hljs-property">innerHTML</span> = <span class="hljs-string">'å…³é—­'</span>;
          });
      })
      sliderBar.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"mouseleave"</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
          <span class="hljs-title function_">animate</span>(con, <span class="hljs-number">0</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
              sliderBar.<span class="hljs-property">children</span>[<span class="hljs-number">0</span>].<span class="hljs-property">innerHTML</span> = <span class="hljs-string">'å±•å¼€'</span>;
          });
      })
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>JSæ–‡ä»¶</p>
<pre><code class="hljs language-ini" lang="ini">function animate(obj, target, callback) {
    clearInterval(obj.timer)<span class="hljs-comment">;</span>
    <span class="hljs-attr">obj.timer</span> = setInterval(function () {
        var <span class="hljs-attr">step</span> = (target - obj.<span class="hljs-literal">off</span>setLeft) / <span class="hljs-number">10</span><span class="hljs-comment">;</span>
        <span class="hljs-attr">step</span> = step &gt; <span class="hljs-number">0</span> ? Math.ceil(step) : Math.floor(step)<span class="hljs-comment">;</span>
        if (<span class="hljs-attr">obj.offsetLeft</span> == target) {
            clearInterval(obj.timer)<span class="hljs-comment">;</span>
            if (callback) {
                callback()<span class="hljs-comment">;</span>
            }
        }
        else {
            <span class="hljs-attr">obj.style.left</span> = obj.<span class="hljs-literal">off</span>setLeft + step + <span class="hljs-string">'px'</span><span class="hljs-comment">;</span>
        }
    }, 30)
}
</code></pre>
<p>å®Œæ•´ä»£ç ç¤ºä¾‹çš„å‰é¢çº¯æ‰‹æ“ï¼Œæ²¡åœ¨ç¼–è¾‘å™¨é‡Œé¢å†™ï¼Œå¦‚æœæœ‰é”™è¯¯å¸Œæœ›æ˜å‹ä»¬å¸®æˆ‘æŒ‡å‡ºæˆ‘å†æ”¹æ­£ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PromiseåŸºç¡€çŸ¥è¯†æ•´ç†ï¼Œçœ‹çœ‹è¿˜æœ‰ä½ ä¸æ¸…æ¥šçš„å—]]></title>    <link>https://juejin.cn/post/7595894884957175859</link>    <guid>https://juejin.cn/post/7595894884957175859</guid>    <pubDate>2026-01-17T13:04:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595894884957175859" data-draft-id="7595858063503294498" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="PromiseåŸºç¡€çŸ¥è¯†æ•´ç†ï¼Œçœ‹çœ‹è¿˜æœ‰ä½ ä¸æ¸…æ¥šçš„å—"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2026-01-17T13:04:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="sophieæ—­"/> <meta itemprop="url" content="https://juejin.cn/user/2559318799692952"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            PromiseåŸºç¡€çŸ¥è¯†æ•´ç†ï¼Œçœ‹çœ‹è¿˜æœ‰ä½ ä¸æ¸…æ¥šçš„å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2559318799692952/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    sophieæ—­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T13:04:53.000Z" title="Sat Jan 17 2026 13:04:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»34åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>Promise ä½œä¸º å¼‚æ­¥ç¼–ç¨‹çš„è€ç”Ÿå¸¸è°ˆï¼Œè¿™é‡Œä¸å…ä¿—ä¹Ÿæ•´ç†ä¸€ç•ªï¼Œä»¥åå…³äº PromiseåŸºç¡€çŸ¥è¯†çœ‹è¿™ç¯‡å°±å¥½äº†ã€‚æ•´ç†è¿‡åï¼Œæˆ‘æƒ³è¯´ä¸€å¥è¯ï¼š<code>å›è°ƒå‡½æ•°å¯ä»¥è¯´æ˜¯javascriptä¸­ï¼Œæ‰€æœ‰å¼‚æ­¥ç¼–ç¨‹æ–¹å¼çš„æ ¹åŸº</code>,Promise æ— éæ˜¯ ä»¥æ›´å¥½ç»´æŠ¤æ›´ä¼˜é›…çš„å½¢å¼è®©æˆ‘ä»¬ä½¿ç”¨å›è°ƒå‡½æ•°ï¼Œå¹¶ä¸ç®—æ˜¯ä¸€ä¸ª å…¨æ–°çš„æ‘†è„±å›è°ƒå‡½æ•°çš„è§£æ³•ã€‚</p>
<h2 data-id="heading-1">Promise æ„é€ å‡½æ•°</h2>
<h4 data-id="heading-2">å®Œæ•´ä»£ç ç¤ºä¾‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. ä½¿ç”¨Promiseæ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ï¼ˆæ‰¿è¯ºï¼‰</span>
<span class="hljs-comment">// æ„é€ å‡½æ•°æ¥æ”¶ä¸€ä¸ªã€Œå…‘ç°æ‰¿è¯ºçš„é€»è¾‘å‡½æ•°ã€ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¢«åŒæ­¥æ‰§è¡Œ</span>
<span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Promiseæ„é€ å‡½æ•°çš„æ‰§è¡Œå‡½æ•°ï¼šåŒæ­¥æ‰§è¡Œ'</span>);
  
  <span class="hljs-comment">// resolveå’Œrejectéƒ½æ˜¯å‡½æ•°ï¼Œç”¨äºä¿®æ”¹PromiseçŠ¶æ€</span>
  <span class="hljs-comment">// 2. è°ƒç”¨resolveï¼šå°†PromiseçŠ¶æ€æ”¹ä¸ºfulfilledï¼ˆæˆåŠŸï¼‰ï¼Œå¹¶ä¼ é€’ç»“æœ</span>
  <span class="hljs-title function_">resolve</span>(<span class="hljs-number">100</span>); <span class="hljs-comment">// è¿™é‡Œä¼ å…¥å›ºå®šå€¼100ä½œä¸ºå¼‚æ­¥ä»»åŠ¡çš„æ“ä½œç»“æœ</span>
  
  <span class="hljs-comment">// 3. PromiseçŠ¶æ€ä¸€æ—¦ç¡®å®šå°±æ— æ³•ä¿®æ”¹ï¼Œæ‰€ä»¥ä¸‹é¢çš„rejectä¸ä¼šç”Ÿæ•ˆï¼ˆæ³¨é‡Šæ‰æ›´ç›´è§‚ï¼‰</span>
  <span class="hljs-comment">// reject(new Error('promise rejected')); // å°†çŠ¶æ€æ”¹ä¸ºrejectedï¼ˆå¤±è´¥ï¼‰ï¼Œä¼ é€’é”™è¯¯ç†ç”±</span>
});

<span class="hljs-comment">// 4. ç”¨thenæ–¹æ³•æŒ‡å®šçŠ¶æ€å˜æ›´åçš„å›è°ƒ</span>
<span class="hljs-comment">// thenæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šonFulfilledï¼ˆæˆåŠŸå›è°ƒï¼‰ã€onRejectedï¼ˆå¤±è´¥å›è°ƒï¼‰</span>
promise.<span class="hljs-title function_">then</span>(
  <span class="hljs-comment">// onFulfilledï¼šPromiseçŠ¶æ€ä¸ºfulfilledæ—¶æ‰§è¡Œï¼Œæ¥æ”¶resolveä¼ é€’çš„ç»“æœ</span>
  <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'PromiseæˆåŠŸ:'</span>, value); <span class="hljs-comment">// è¾“å‡º PromiseæˆåŠŸ: 100</span>
  },
  <span class="hljs-comment">// onRejectedï¼šPromiseçŠ¶æ€ä¸ºrejectedæ—¶æ‰§è¡Œï¼Œæ¥æ”¶rejectä¼ é€’çš„é”™è¯¯</span>
  <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Promiseå¤±è´¥:'</span>, error.<span class="hljs-property">message</span>);
  }
);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'åŒæ­¥ä»£ç ï¼šåœ¨Promiseåˆ›å»ºåæ‰§è¡Œ'</span>);
</code></pre>
<h4 data-id="heading-3">ä»£ç è¾“å‡ºç»“æœ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">Promise</span>æ„é€ å‡½æ•°çš„æ‰§è¡Œå‡½æ•°ï¼šåŒæ­¥æ‰§è¡Œ
åŒæ­¥ä»£ç ï¼šåœ¨<span class="hljs-title class_">Promise</span>åˆ›å»ºåæ‰§è¡Œ
<span class="hljs-title class_">Promise</span>æˆåŠŸ: <span class="hljs-number">100</span>
</code></pre>
<h4 data-id="heading-4">é€ç‚¹è§£è¯»ï¼ˆæ ¸å¿ƒè§£é‡Šï¼‰</h4>
<ol>
<li>
<p><strong>æ„é€ å‡½æ•°å‚æ•°ï¼ˆå…‘ç°æ‰¿è¯ºçš„é€»è¾‘ï¼‰</strong>ï¼š</p>
<ul>
<li><code>new Promise((resolve, reject) =&gt; { ... })</code> ä¸­çš„ç®­å¤´å‡½æ•°å°±æ˜¯ã€Œå…‘ç°æ‰¿è¯ºçš„é€»è¾‘ã€ã€‚</li>
<li>è¿™ä¸ªå‡½æ•°<strong>åŒæ­¥æ‰§è¡Œ</strong>ï¼šæ‰€ä»¥å…ˆè¾“å‡º <code>Promiseæ„é€ å‡½æ•°çš„æ‰§è¡Œå‡½æ•°ï¼šåŒæ­¥æ‰§è¡Œ</code>ï¼Œå†æ‰§è¡Œåç»­çš„åŒæ­¥ä»£ç ã€‚</li>
</ul>
</li>
<li>
<p><strong>resolve å’Œ reject å‚æ•°</strong>ï¼š</p>
<ul>
<li><code>äºŒè€…éƒ½æ˜¯æµè§ˆå™¨å†…ç½®çš„å‡½æ•°ï¼Œä¸æ˜¯æˆ‘ä»¬å®šä¹‰çš„ã€‚</code></li>
<li><code>resolve(100)</code>ï¼šæŠŠ Promise çŠ¶æ€æ”¹ä¸º <code>fulfilled</code>ï¼ˆæˆåŠŸï¼‰ï¼Œå¹¶æŠŠ <code>100</code> ä½œä¸ºã€ŒæˆåŠŸç»“æœã€ä¼ é€’ç»™ <code>then</code> çš„ç¬¬ä¸€ä¸ªå›è°ƒã€‚</li>
<li><code>reject(new Error('promise rejected'))</code>ï¼šæŠŠçŠ¶æ€æ”¹ä¸º <code>rejected</code>ï¼ˆå¤±è´¥ï¼‰ï¼Œå¹¶æŠŠé”™è¯¯å¯¹è±¡ä½œä¸ºã€Œå¤±è´¥ç†ç”±ã€ä¼ é€’ç»™ <code>then</code> çš„ç¬¬äºŒä¸ªå›è°ƒã€‚</li>
</ul>
</li>
<li>
<p><strong>çŠ¶æ€ä¸€æ—¦ç¡®å®šå°±ä¸èƒ½ä¿®æ”¹</strong>ï¼š</p>
<ul>
<li>ä»£ç ä¸­å…ˆè°ƒç”¨äº† <code>resolve(100)</code>ï¼Œæ­¤æ—¶ Promise çŠ¶æ€å·²ç»å›ºå®šä¸ºæˆåŠŸï¼Œå³ä¾¿åç»­è°ƒç”¨ <code>reject</code>ï¼ˆå“ªæ€•å–æ¶ˆæ³¨é‡Šï¼‰ï¼Œä¹Ÿä¸ä¼šæ”¹å˜çŠ¶æ€ï¼Œ<code>then</code> çš„å¤±è´¥å›è°ƒæ°¸è¿œä¸ä¼šæ‰§è¡Œã€‚</li>
</ul>
</li>
<li>
<p><strong>then æ–¹æ³•çš„å›è°ƒ</strong>ï¼š</p>
<ul>
<li><code>then</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼šåªæœ‰ Promise çŠ¶æ€ä¸º <code>fulfilled</code> æ—¶æ‰æ‰§è¡Œï¼Œæ¥æ”¶ <code>resolve</code> ä¼ é€’çš„å€¼ã€‚</li>
<li><code>then</code> çš„ç¬¬äºŒä¸ªå‚æ•°ï¼šåªæœ‰ Promise çŠ¶æ€ä¸º <code>rejected</code> æ—¶æ‰æ‰§è¡Œï¼Œæ¥æ”¶ <code>reject</code> ä¼ é€’çš„é”™è¯¯ã€‚</li>
<li>æ³¨æ„ï¼š<code>then</code> çš„å›è°ƒæ˜¯<strong>å¾®ä»»åŠ¡</strong>ï¼Œæ‰€ä»¥ä¼šç­‰æ‰€æœ‰åŒæ­¥ä»£ç æ‰§è¡Œå®Œåæ‰æ‰§è¡Œï¼ˆå…ˆè¾“å‡º <code>åŒæ­¥ä»£ç ï¼šåœ¨Promiseåˆ›å»ºåæ‰§è¡Œ</code>ï¼Œå†è¾“å‡º <code>PromiseæˆåŠŸ: 100</code>ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<h4 data-id="heading-5">æ€»ç»“</h4>
<ol>
<li>Promise æ„é€ å‡½æ•°çš„æ‰§è¡Œå‡½æ•°æ˜¯<strong>åŒæ­¥æ‰§è¡Œ</strong>çš„ï¼Œé‡Œé¢çš„ <code>resolve/reject</code> ç”¨äºä¿®æ”¹ Promise çŠ¶æ€ï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰ã€‚</li>
<li>Promise çŠ¶æ€ä¸€æ—¦é€šè¿‡ <code>resolve</code> æˆ– <code>reject</code> ç¡®å®šï¼Œå°±<strong>æ°¸ä¹…ä¸å¯ä¿®æ”¹</strong>ï¼Œåç»­è°ƒç”¨å¦ä¸€ä¸ªå‡½æ•°ä¹Ÿæ— æ•ˆã€‚</li>
<li><code>then</code> æ–¹æ³•çš„ä¸¤ä¸ªå›è°ƒåˆ†åˆ«å¯¹åº”ã€ŒæˆåŠŸçŠ¶æ€ã€å’Œã€Œå¤±è´¥çŠ¶æ€ã€çš„å¤„ç†é€»è¾‘ï¼Œä¸”å›è°ƒæ˜¯<strong>å¾®ä»»åŠ¡</strong>ï¼ˆæ™šäºåŒæ­¥ä»£ç æ‰§è¡Œï¼‰ã€‚</li>
</ol>
<h2 data-id="heading-6">Promise é“¾å¼è°ƒç”¨ ç”¨èµ·æ¥ï¼</h2>
<h4 data-id="heading-7">é”™è¯¯å†™æ³•ï¼šåµŒå¥—thenï¼ˆå›è°ƒåœ°ç‹±ï¼‰</h4>
<p>ä½¿ç”¨Promiseã€Œå¸¸è§è¯¯åŒºã€ï¼Œæœ¬è´¨å’Œä¼ ç»Ÿå›è°ƒåµŒå¥—æ²¡åŒºåˆ«ï¼Œå®Œå…¨æµªè´¹äº†Promiseçš„ä¼˜åŠ¿ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é”™è¯¯ï¼šåµŒå¥—ä½¿ç”¨thenï¼Œå½¢æˆå›è°ƒåœ°ç‹±</span>
<span class="hljs-title function_">ajax</span>(<span class="hljs-string">'urls.json'</span>).<span class="hljs-title function_">then</span>(
  <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬ä¸€æ­¥ï¼šæ‹¿åˆ°urls.jsonç»“æœ'</span>, res);
    <span class="hljs-comment">// è¯¯åŒºï¼šåœ¨ç¬¬ä¸€ä¸ªthençš„å›è°ƒé‡ŒåµŒå¥—ç¬¬äºŒä¸ªthen</span>
    <span class="hljs-title function_">ajax</span>(res.<span class="hljs-property">userUrl</span>).<span class="hljs-title function_">then</span>(
      <span class="hljs-function">(<span class="hljs-params">userRes</span>) =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬äºŒæ­¥ï¼šæ‹¿åˆ°ç”¨æˆ·æ•°æ®'</span>, userRes);
        <span class="hljs-comment">// å¦‚æœè¿˜æœ‰ç¬¬ä¸‰ä¸ªè¯·æ±‚ï¼Œä¼šç»§ç»­åµŒå¥—ï¼Œä»£ç è¶Šæ¥è¶Šæ·±</span>
      },
      <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬äºŒæ­¥è¯·æ±‚å¤±è´¥'</span>, err);
      }
    );
  },
  <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬ä¸€æ­¥è¯·æ±‚å¤±è´¥'</span>, err);
  }
);
</code></pre>
<p>è¿™ç§å†™æ³•çš„é—®é¢˜ï¼š</p>
<ul>
<li>ä»£ç å±‚çº§åµŒå¥—ï¼Œè¶Šå¾€åè¶Šæ·±ï¼Œå¯è¯»æ€§å·®ï¼ˆå›è°ƒåœ°ç‹±ï¼‰</li>
<li>é”™è¯¯å¤„ç†éœ€è¦åœ¨æ¯ä¸ªåµŒå¥—çš„thené‡Œå•ç‹¬å†™ï¼Œå†—ä½™ä¸”éº»çƒ¦</li>
</ul>
<h4 data-id="heading-8">æ­£ç¡®å†™æ³•ï¼šthené“¾å¼è°ƒç”¨ï¼ˆæ‰å¹³åŒ–ï¼‰</h4>
<p>æ ¸å¿ƒåŸç†ï¼š<strong>then æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ–°çš„ Promise</strong>ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥é“¾å¼è°ƒç”¨ï¼Œè€ŒéåµŒå¥—ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ­£ç¡®ï¼šé“¾å¼è°ƒç”¨thenï¼Œæ‰å¹³åŒ–ä»£ç </span>
<span class="hljs-title function_">ajax</span>(<span class="hljs-string">'urls.json'</span>)
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬ä¸€æ­¥ï¼šæ‹¿åˆ°urls.jsonç»“æœ'</span>, res);
    <span class="hljs-comment">// å…³é”®ï¼šè¿”å›ä¸‹ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡çš„Promise</span>
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">ajax</span>(res.<span class="hljs-property">userUrl</span>); 
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">userRes</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬äºŒæ­¥ï¼šæ‹¿åˆ°ç”¨æˆ·æ•°æ®'</span>, userRes);
    <span class="hljs-comment">// å¯ä»¥ç»§ç»­é“¾å¼è°ƒç”¨ç¬¬ä¸‰ä¸ªå¼‚æ­¥ä»»åŠ¡</span>
    <span class="hljs-comment">// return ajax(ç¬¬ä¸‰ä¸ªåœ°å€);</span>
  })
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
    <span class="hljs-comment">// ç»Ÿä¸€é”™è¯¯å¤„ç†ï¼šä»»ä½•ä¸€æ­¥å¤±è´¥éƒ½ä¼šèµ°åˆ°è¿™é‡Œ</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¯·æ±‚å¤±è´¥ï¼š'</span>, err.<span class="hljs-property">message</span>);
  });
</code></pre>
<h5 data-id="heading-9">æ‰§è¡Œç»“æœï¼ˆ500msåï¼‰</h5>
<pre><code class="hljs language-css" lang="css">ç¬¬ä¸€æ­¥ï¼šæ‹¿åˆ°urls<span class="hljs-selector-class">.json</span>ç»“æœ { userUrl: <span class="hljs-string">'/user'</span> }
ç¬¬äºŒæ­¥ï¼šæ‹¿åˆ°ç”¨æˆ·æ•°æ® { name: <span class="hljs-string">'å¼ ä¸‰'</span>, age: <span class="hljs-number">20</span> }
</code></pre>
<h4 data-id="heading-10">æ ¸å¿ƒé€»è¾‘æ‹†è§£ï¼ˆä¸ºä»€ä¹ˆé“¾å¼è°ƒç”¨èƒ½é¿å…å›è°ƒåœ°ç‹±ï¼‰</h4>
<ol>
<li><code>ajax('urls.json').then(...)</code> æ‰§è¡Œåï¼Œè¿”å›ä¸€ä¸ª<strong>æ–°çš„ Promise</strong>ï¼ˆè®°ä¸º P1ï¼‰ã€‚</li>
<li>ç¬¬ä¸€ä¸ª then çš„å›è°ƒé‡Œ <code>return ajax(res.userUrl)</code>ï¼Œè¿™ä¸ª ajax è°ƒç”¨ä¼šè¿”å›å¦ä¸€ä¸ª Promiseï¼ˆè®°ä¸º P2ï¼‰ã€‚</li>
<li>Promise çš„è§„åˆ™ï¼šå¦‚æœ then çš„å›è°ƒè¿”å›ä¸€ä¸ª Promiseï¼ˆP2ï¼‰ï¼Œé‚£ä¹ˆ then å¯¹åº”çš„æ–° Promiseï¼ˆP1ï¼‰ä¼šã€Œç»§æ‰¿ã€P2 çš„çŠ¶æ€â€”â€”P2 æˆåŠŸï¼ŒP1 å°±æˆåŠŸï¼›P2 å¤±è´¥ï¼ŒP1 å°±å¤±è´¥ã€‚</li>
<li>ç¬¬äºŒä¸ª <code>then(...)</code> å…¶å®æ˜¯æŒ‚è½½åœ¨ P1 ä¸Šçš„å›è°ƒï¼Œè€ŒéåµŒå¥—åœ¨ç¬¬ä¸€ä¸ª then å†…éƒ¨ï¼Œæ‰€ä»¥ä»£ç æ˜¯æ‰å¹³çš„ã€‚</li>
</ol>
<h4 data-id="heading-11">æ€»ç»“</h4>
<ol>
<li>Promise é¿å…å›è°ƒåœ°ç‹±çš„æ ¸å¿ƒæ˜¯ <strong>then çš„é“¾å¼è°ƒç”¨</strong>ï¼Œè€ŒéåµŒå¥—ä½¿ç”¨ thenã€‚</li>
<li>å…³é”®è§„åˆ™ï¼š<code>then</code> ä¼šè¿”å›æ–° Promiseï¼Œè‹¥ then å›è°ƒè¿”å› Promiseï¼Œåˆ™æ–° Promise ç»§æ‰¿è¯¥ Promise çš„çŠ¶æ€ã€‚</li>
<li>é“¾å¼è°ƒç”¨+catch å¯ä»¥å®ç°<strong>æ‰å¹³åŒ–ä»£ç ç»“æ„</strong>å’Œ<strong>ç»Ÿä¸€é”™è¯¯å¤„ç†</strong>ï¼Œè¿™æ˜¯ Promise å¯¹æ¯”ä¼ ç»Ÿå›è°ƒçš„æ ¸å¿ƒä¼˜åŠ¿ã€‚</li>
</ol>
<h2 data-id="heading-12">Promise é“¾å¼è°ƒç”¨ çš„ ç‰¹æ®Šæ€§</h2>
<h4 data-id="heading-13">å…ˆå¯¹æ¯”ä¸¤ç§é“¾å¼è°ƒç”¨çš„æœ¬è´¨åŒºåˆ«</h4>
<h5 data-id="heading-14">1. ä¼ ç»Ÿé“¾å¼è°ƒç”¨ï¼ˆè¿”å› thisï¼‰</h5>
<p>æ¯”å¦‚ jQuery çš„é“¾å¼è°ƒç”¨ï¼Œæ ¸å¿ƒæ˜¯æ–¹æ³•å†…éƒ¨è¿”å› <code>this</code>ï¼ˆè‡ªèº«ï¼‰ï¼Œæ‰€æœ‰æ–¹æ³•éƒ½æ“ä½œåŒä¸€ä¸ªå¯¹è±¡ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¼ ç»Ÿé“¾å¼è°ƒç”¨ï¼šè¿”å›this</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyObj</span> {
  name = <span class="hljs-string">''</span>;
  <span class="hljs-title function_">setName</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>; <span class="hljs-comment">// è¿”å›è‡ªèº«ï¼ˆåŒä¸€ä¸ªå¯¹è±¡ï¼‰</span>
  }
  <span class="hljs-title function_">logName</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>; <span class="hljs-comment">// è¿”å›è‡ªèº«</span>
  }
}

<span class="hljs-keyword">const</span> obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyObj</span>();
obj.<span class="hljs-title function_">setName</span>(<span class="hljs-string">'å¼ ä¸‰'</span>).<span class="hljs-title function_">logName</span>(); 
<span class="hljs-comment">// è¿™é‡Œ setName å’Œ logName æ“ä½œçš„æ˜¯åŒä¸€ä¸ª obj å¯¹è±¡</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-title function_">setName</span>(<span class="hljs-string">'å¼ ä¸‰'</span>) === obj); <span class="hljs-comment">// trueï¼ˆè¿”å›çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼‰</span>
</code></pre>
<h5 data-id="heading-15">2. Promise çš„é“¾å¼è°ƒç”¨ï¼ˆè¿”å›æ–°å¯¹è±¡ï¼‰</h5>
<p>Promise çš„ <code>then</code> æ¯è°ƒç”¨ä¸€æ¬¡ï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ª<strong>å…¨æ–°çš„ Promise</strong>ï¼Œå’ŒåŸå¯¹è±¡æ¯«æ— å…³ç³»ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Promiseé“¾å¼è°ƒç”¨ï¼šè¿”å›æ–°å¯¹è±¡</span>
<span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-number">100</span>));
<span class="hljs-keyword">const</span> p2 = p1.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> res + <span class="hljs-number">10</span>); <span class="hljs-comment">// p2 æ˜¯å…¨æ–°çš„Promise</span>
<span class="hljs-keyword">const</span> p3 = p2.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> res + <span class="hljs-number">10</span>); <span class="hljs-comment">// p3 æ˜¯å…¨æ–°çš„Promise</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p1 === p2); <span class="hljs-comment">// falseï¼ˆä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p2 === p3); <span class="hljs-comment">// falseï¼ˆä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼‰</span>

<span class="hljs-comment">// æ‰§è¡Œç»“æœï¼šéªŒè¯æ¯ä¸ªthenå¯¹åº”ä¸åŒçš„Promise</span>
p3.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)); <span class="hljs-comment">// 120</span>
</code></pre>
<h4 data-id="heading-16">é€å¥æ‹†é‚£æ®µã€Œç»•å£çš„è¯ã€</h4>
<blockquote>
<p>å¦‚æœæˆ‘ä»¬è¿™é‡Œä¸æ–­çš„é“¾å¼è°ƒç”¨thenæ–¹æ³•ï¼Œç„¶åå‘¢è¿™é‡Œæ¯ä¸€ä¸ªthenæ–¹æ³•ï¼Œå®ƒå®é™…ä¸Šéƒ½æ˜¯åœ¨ä¸ºä¸Šä¸€ä¸ªthenæ–¹æ³•è¿”å›çš„promiseå¯¹è±¡å»æ·»åŠ çŠ¶æ€æ˜ç¡®è¿‡åçš„å›è°ƒã€‚</p>
</blockquote>
<p>æˆ‘ç”¨ã€Œåˆ†æ­¥æ‹†è§£+ä»£ç æ ‡æ³¨ã€çš„æ–¹å¼è§£é‡Šï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºåŸå§‹Promise p1ï¼ˆç¬¬ä¸€ä¸ªæ‰¿è¯ºï¼‰</span>
<span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'åˆå§‹å€¼'</span>));

<span class="hljs-comment">// ç¬¬äºŒæ­¥ï¼šè°ƒç”¨p1.then() â†’ è¿”å›æ–°Promise p2ï¼ˆç¬¬äºŒä¸ªæ‰¿è¯ºï¼‰</span>
<span class="hljs-comment">// è¿™ä¸ªthenæ˜¯ç»™p1åŠ å›è°ƒï¼šp1æˆåŠŸåæ‰§è¡Œå›è°ƒï¼Œç„¶åå†³å®šp2çš„çŠ¶æ€</span>
<span class="hljs-keyword">const</span> p2 = p1.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'p1çš„å›è°ƒ:'</span>, res); <span class="hljs-comment">// è¾“å‡ºï¼šp1çš„å›è°ƒ: åˆå§‹å€¼</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">'p1å›è°ƒçš„è¿”å›å€¼'</span>; <span class="hljs-comment">// è¿™ä¸ªè¿”å›å€¼ä¼šå†³å®šp2çš„çŠ¶æ€ï¼ˆæˆåŠŸï¼Œå€¼ä¸ºè¿™ä¸ªå­—ç¬¦ä¸²ï¼‰</span>
});

<span class="hljs-comment">// ç¬¬ä¸‰æ­¥ï¼šè°ƒç”¨p2.then() â†’ è¿”å›æ–°Promise p3ï¼ˆç¬¬ä¸‰ä¸ªæ‰¿è¯ºï¼‰</span>
<span class="hljs-comment">// è¿™ä¸ªthenæ˜¯ç»™p2åŠ å›è°ƒï¼šp2æˆåŠŸåæ‰§è¡Œå›è°ƒï¼Œç„¶åå†³å®šp3çš„çŠ¶æ€</span>
<span class="hljs-keyword">const</span> p3 = p2.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'p2çš„å›è°ƒ:'</span>, res); <span class="hljs-comment">// è¾“å‡ºï¼šp2çš„å›è°ƒ: p1å›è°ƒçš„è¿”å›å€¼</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">'p2å›è°ƒçš„è¿”å›å€¼'</span>;
});

<span class="hljs-comment">// ç¬¬å››æ­¥ï¼šè°ƒç”¨p3.then() â†’ è¿”å›æ–°Promise p4ï¼ˆç¬¬å››ä¸ªæ‰¿è¯ºï¼‰</span>
<span class="hljs-comment">// è¿™ä¸ªthenæ˜¯ç»™p3åŠ å›è°ƒï¼šp3æˆåŠŸåæ‰§è¡Œå›è°ƒï¼Œç„¶åå†³å®šp4çš„çŠ¶æ€</span>
<span class="hljs-keyword">const</span> p4 = p3.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'p3çš„å›è°ƒ:'</span>, res); <span class="hljs-comment">// è¾“å‡ºï¼šp3çš„å›è°ƒ: p2å›è°ƒçš„è¿”å›å€¼</span>
});
</code></pre>
<h5 data-id="heading-17">æ‹†è§£é€»è¾‘ï¼ˆå¯¹åº”ä½ é‚£æ®µè¯ï¼‰ï¼š</h5>
<ol>
<li>ã€Œä¸æ–­é“¾å¼è°ƒç”¨ thenã€â†’ ä»£ç ä¸­ <code>p1.then() â†’ p2.then() â†’ p3.then()</code> å°±æ˜¯é“¾å¼è°ƒç”¨ã€‚</li>
<li>ã€Œæ¯ä¸€ä¸ª then æ–¹æ³•ï¼Œéƒ½æ˜¯ä¸ºä¸Šä¸€ä¸ª then è¿”å›çš„ Promise å¯¹è±¡åŠ å›è°ƒã€ï¼š
<ul>
<li><code>p2.then(...)</code> â†’ æ˜¯ç»™ã€Œp1.then() è¿”å›çš„ p2ã€åŠ å›è°ƒï¼›</li>
<li><code>p3.then(...)</code> â†’ æ˜¯ç»™ã€Œp2.then() è¿”å›çš„ p3ã€åŠ å›è°ƒï¼›</li>
<li>æ¯ä¸ª then éƒ½ä¸æ˜¯ç»™åŸå§‹çš„ p1 åŠ å›è°ƒï¼Œè€Œæ˜¯ç»™ã€Œä¸Šä¸€ä¸ª then ç”Ÿæˆçš„æ–° Promiseã€åŠ å›è°ƒã€‚</li>
</ul>
</li>
<li>ã€ŒçŠ¶æ€æ˜ç¡®è¿‡åçš„å›è°ƒã€ï¼šåªæœ‰å½“è¢«ç»‘å®šçš„ Promiseï¼ˆæ¯”å¦‚ p2ï¼‰çŠ¶æ€å˜ä¸º fulfilled/rejectedï¼Œè¿™ä¸ª then çš„å›è°ƒæ‰ä¼šæ‰§è¡Œã€‚</li>
</ol>
<h4 data-id="heading-18">ä¸ºä»€ä¹ˆè¦è¿”å›å…¨æ–°çš„ Promiseï¼Ÿï¼ˆæ ¸å¿ƒç›®çš„ï¼‰</h4>
<p>ã€Œ<code>è¿”å›å…¨æ–°Promiseçš„ç›®çš„æ˜¯å®ç°Promiseé“¾æ¡ï¼Œä¸€ä¸ªæ‰¿è¯ºç»“æŸåè¿”å›æ–°æ‰¿è¯ºï¼Œæ¯ä¸ªæ‰¿è¯ºè´Ÿè´£ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œç›¸äº’æ— å½±å“</code>ã€ï¼Œç”¨ä¾‹å­éªŒè¯ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åœºæ™¯ï¼šç¬¬ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼ˆå»¶è¿Ÿ1sï¼‰ï¼Œç¬¬äºŒä¸ªå¼‚æ­¥ä»»åŠ¡ï¼ˆå»¶è¿Ÿ2sï¼‰</span>
<span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'ç¬¬ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡å®Œæˆ'</span>), <span class="hljs-number">1000</span>);
});

<span class="hljs-comment">// ç¬¬ä¸€ä¸ªthenï¼šè´Ÿè´£ç¬¬ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡çš„ç»“æœå¤„ç†ï¼Œè¿”å›æ–°Promiseï¼ˆç¬¬äºŒä¸ªå¼‚æ­¥ä»»åŠ¡ï¼‰</span>
<span class="hljs-keyword">const</span> p2 = p1.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res); <span class="hljs-comment">// 1såè¾“å‡ºï¼šç¬¬ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡å®Œæˆ</span>
  <span class="hljs-comment">// è¿”å›æ–°Promiseï¼ˆç¬¬äºŒä¸ªå¼‚æ­¥ä»»åŠ¡ï¼‰ï¼Œå’Œp1å®Œå…¨ç‹¬ç«‹</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'ç¬¬äºŒä¸ªå¼‚æ­¥ä»»åŠ¡å®Œæˆ'</span>), <span class="hljs-number">2000</span>);
  });
});

<span class="hljs-comment">// ç¬¬äºŒä¸ªthenï¼šåªå…³å¿ƒp2ï¼ˆç¬¬äºŒä¸ªå¼‚æ­¥ä»»åŠ¡ï¼‰çš„çŠ¶æ€ï¼Œå’Œp1æ— å…³</span>
p2.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res); <span class="hljs-comment">// å†ç­‰2såè¾“å‡ºï¼šç¬¬äºŒä¸ªå¼‚æ­¥ä»»åŠ¡å®Œæˆ</span>
});

<span class="hljs-comment">// æ­¤æ—¶æ“ä½œp1ï¼Œä¸ä¼šå½±å“p2</span>
p1.<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'p1çš„å¦ä¸€ä¸ªå›è°ƒ'</span>)); <span class="hljs-comment">// 1såè¾“å‡ºï¼Œå’Œp2æ— å…³</span>
</code></pre>
<ul>
<li>æ¯ä¸ª Promiseï¼ˆp1/p2ï¼‰éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œp1 å®Œæˆä¸å½±å“ p2 çš„æ‰§è¡Œé€»è¾‘ï¼Œp2 å»¶è¿Ÿä¹Ÿä¸ä¼šå¹²æ‰° p1 çš„å…¶ä»–å›è°ƒï¼›</li>
<li>è‹¥ then è¿”å› <code>this</code>ï¼ˆåŒä¸€ä¸ªå¯¹è±¡ï¼‰ï¼Œåˆ™æ— æ³•å®ç°ã€Œä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡å®Œæˆåï¼Œå†å¯åŠ¨ä¸‹ä¸€ä¸ªç‹¬ç«‹çš„å¼‚æ­¥ä»»åŠ¡ã€ï¼Œå› ä¸ºæ‰€æœ‰ then éƒ½ç»‘å®šåœ¨åŒä¸€ä¸ªå¯¹è±¡ä¸Šï¼ŒçŠ¶æ€åªèƒ½å˜ä¸€æ¬¡ã€‚</li>
</ul>
<h4 data-id="heading-19">æ€»ç»“</h4>
<ol>
<li>Promise é“¾å¼è°ƒç”¨â‰ ä¼ ç»Ÿé“¾å¼è°ƒç”¨ï¼šä¼ ç»Ÿæ˜¯è¿”å› <code>this</code>ï¼ˆåŒä¸€å¯¹è±¡ï¼‰ï¼ŒPromise æ˜¯è¿”å›<strong>å…¨æ–°çš„ Promise å¯¹è±¡</strong>ã€‚</li>
<li>é“¾å¼è°ƒç”¨çš„æœ¬è´¨ï¼šæ¯ä¸ª <code>then</code> éƒ½æ˜¯ç»™ã€Œä¸Šä¸€ä¸ª <code>then</code> è¿”å›çš„æ–° Promiseã€ç»‘å®šå›è°ƒï¼Œè€Œéç»™åŸå§‹ Promise ç»‘å®šã€‚</li>
<li>è¿”å›æ–° Promise çš„æ ¸å¿ƒä»·å€¼ï¼š<code>è®©æ¯ä¸ªå¼‚æ­¥ä»»åŠ¡éƒ½å¯¹åº”ä¸€ä¸ªç‹¬ç«‹çš„ã€Œæ‰¿è¯ºã€ï¼Œä»»åŠ¡ä¹‹é—´ç›¸äº’ç‹¬ç«‹ã€æŒ‰é¡ºåºæ‰§è¡Œï¼Œå®ç°çœŸæ­£çš„å¼‚æ­¥é“¾æ¡ã€‚</code></li>
</ol>
<h5 data-id="heading-20">è¡¥å……ï¼šthen å›è°ƒè¿”å› Promise â†’ åä¸€ä¸ª then ç­‰å¾…è¯¥ Promise ç»“æŸ</h5>
<ul>
<li>ç¬¬äºŒä¸ª then å›è°ƒè¿”å› <code>delayTask(1000, ...)</code>ï¼ˆä¸€ä¸ªéœ€è¦ç­‰å¾…1sçš„ Promiseï¼‰ï¼›</li>
<li>æ­¤æ—¶ç¬¬ä¸‰ä¸ª then ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯ç­‰å¾…è¿™ä¸ªè¿”å›çš„ Promise çŠ¶æ€å˜ä¸º <code>fulfilled</code>ï¼ˆ1såå®Œæˆï¼‰ï¼›</li>
<li>ç­‰ä»·äºï¼š<code>ç¬¬ä¸‰ä¸ª then</code> ç›´æ¥ç»‘å®šåˆ°ã€Œç¬¬äºŒä¸ª then è¿”å›çš„è¿™ä¸ª delayTask Promiseã€ä¸Šï¼Œæˆä¸ºå®ƒçš„å›è°ƒã€‚</li>
</ul>
<p>ä¸ºäº†è®©ä½ æ›´æ¸…æ¥šã€Œåä¸€ä¸ª then ç­‰ä»·äºç»™è¿”å›çš„ Promise æ³¨å†Œå›è°ƒã€ï¼ŒæŠŠä¸Šé¢çš„ä»£ç æ‹†æˆéé“¾å¼å†™æ³•ï¼Œé€»è¾‘å®Œå…¨ä¸€è‡´ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ‹†åˆ†æˆéé“¾å¼å†™æ³•ï¼Œç­‰ä»·äºä¸Šé¢çš„é“¾å¼è°ƒç”¨</span>
<span class="hljs-keyword">const</span> p1 = <span class="hljs-title function_">delayTask</span>(<span class="hljs-number">1000</span>, <span class="hljs-string">'ç¬¬ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ç»“æœ'</span>);

<span class="hljs-comment">// ç¬¬ä¸€ä¸ªthenï¼šè¿”å›p2</span>
<span class="hljs-keyword">const</span> p2 = p1.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res1</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬ä¸€ä¸ªthenå›è°ƒæ‰§è¡Œ:'</span>, res1);
  <span class="hljs-keyword">return</span> <span class="hljs-string">'ç¬¬ä¸€ä¸ªthençš„è¿”å›å€¼ï¼ˆæ™®é€šå€¼ï¼‰'</span>;
});

<span class="hljs-comment">// ç¬¬äºŒä¸ªthenï¼šè¿”å›p3</span>
<span class="hljs-keyword">const</span> p3 = p2.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res2</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬äºŒä¸ªthenå›è°ƒæ‰§è¡Œ:'</span>, res2);
  <span class="hljs-comment">// è¿”å›ä¸€ä¸ªæ–°çš„Promise p_temp</span>
  <span class="hljs-keyword">const</span> p_temp = <span class="hljs-title function_">delayTask</span>(<span class="hljs-number">1000</span>, <span class="hljs-string">'ç¬¬äºŒä¸ªthenè¿”å›çš„Promiseç»“æœ'</span>);
  <span class="hljs-keyword">return</span> p_temp;
});

<span class="hljs-comment">// ç¬¬ä¸‰ä¸ªthenï¼šç­‰ä»·äºç»™p_tempæ³¨å†Œå›è°ƒï¼ˆå› ä¸ºp3çš„çŠ¶æ€ç”±p_tempå†³å®šï¼‰</span>
<span class="hljs-keyword">const</span> p4 = p3.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res3</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬ä¸‰ä¸ªthenå›è°ƒæ‰§è¡Œ:'</span>, res3);
  <span class="hljs-keyword">return</span> <span class="hljs-string">'æœ€ç»ˆç»“æœ'</span>;
});

<span class="hljs-comment">// ç­‰ä»·äºç›´æ¥ç»™p_tempæ³¨å†Œå›è°ƒï¼š</span>
<span class="hljs-comment">// p_temp.then((res3) =&gt; {</span>
<span class="hljs-comment">//   console.log('ç¬¬ä¸‰ä¸ªthenå›è°ƒæ‰§è¡Œ:', res3);</span>
<span class="hljs-comment">// });</span>
</code></pre>
<h2 data-id="heading-21">catch() ä¸ <code>then(æˆåŠŸ, å¤±è´¥)</code> çš„å¤±è´¥å›è°ƒ æ˜¯å¦å®Œå…¨ç­‰ä»·ï¼Ÿ</h2>
<h4 data-id="heading-22">å…ˆæ˜ç¡®æ ¸å¿ƒç»“è®ºï¼ˆå…ˆè®°é‡ç‚¹ï¼‰</h4>
<ul>
<li><code>catch()</code> ç­‰ä»·äº <code>then(undefined, å¤±è´¥å›è°ƒ)</code>ï¼Œä½†<strong>ç»‘å®šçš„æ˜¯ä¸Šä¸€ä¸ª then è¿”å›çš„æ–° Promise</strong>ï¼›</li>
<li><code>then(æˆåŠŸå›è°ƒ, å¤±è´¥å›è°ƒ)</code> ä¸­çš„å¤±è´¥å›è°ƒï¼Œ<strong>åªç»‘å®šå½“å‰ Promise</strong>ï¼Œç®¡ä¸åˆ°åç»­ then é‡Œçš„æ–° Promise å¼‚å¸¸ï¼›</li>
<li>Promise é“¾æ¡ä¸­ï¼Œå¼‚å¸¸ä¼šã€Œå‘åä¼ é€’ã€ï¼Œç›´åˆ°è¢«æŸä¸ªå¤±è´¥å›è°ƒæ•è·ã€‚</li>
</ul>
<h4 data-id="heading-23">å¯¹æ¯”ç¤ºä¾‹ï¼šthenç¬¬äºŒä¸ªå‚æ•° vs catchï¼ˆç›´è§‚çœ‹å·®å¼‚ï¼‰</h4>
<p>æˆ‘ä»¬ç”¨ã€Œä¸¤æ­¥å¼‚æ­¥ä»»åŠ¡ã€çš„åœºæ™¯ï¼Œæ¨¡æ‹Ÿç¬¬ä¸€æ­¥æˆåŠŸã€ç¬¬äºŒæ­¥å¤±è´¥çš„æƒ…å†µï¼Œå¯¹æ¯”ä¸¤ç§å†™æ³•çš„ç»“æœï¼š</p>
<h5 data-id="heading-24">ç¬¬ä¸€æ­¥ï¼šå°è£…æ¨¡æ‹Ÿå¼‚æ­¥å‡½æ•°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨¡æ‹Ÿå¼‚æ­¥ä»»åŠ¡1ï¼šä¸€å®šæˆåŠŸï¼Œè¿”å›"ç¬¬ä¸€æ­¥ç»“æœ"</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">task1</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-title function_">resolve</span>(<span class="hljs-string">"ç¬¬ä¸€æ­¥ç»“æœ"</span>);
  });
}

<span class="hljs-comment">// æ¨¡æ‹Ÿå¼‚æ­¥ä»»åŠ¡2ï¼šä¸€å®šå¤±è´¥ï¼ŒæŠ›å‡ºå¼‚å¸¸</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">task2</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"ç¬¬äºŒæ­¥æ‰§è¡Œå¤±è´¥"</span>));
  });
}
</code></pre>
<h5 data-id="heading-25">åœºæ™¯1ï¼šç”¨ then çš„ç¬¬äºŒä¸ªå‚æ•°æ³¨å†Œå¤±è´¥å›è°ƒï¼ˆåªèƒ½æ•è·ç¬¬ä¸€æ­¥å¼‚å¸¸ï¼‰</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å†™æ³•1ï¼šthen(æˆåŠŸå›è°ƒ, å¤±è´¥å›è°ƒ)</span>
<span class="hljs-title function_">task1</span>()
  .<span class="hljs-title function_">then</span>(
    <span class="hljs-comment">// æˆåŠŸå›è°ƒï¼šç¬¬ä¸€æ­¥æˆåŠŸåæ‰§è¡Œï¼Œè°ƒç”¨task2ï¼ˆè¿”å›å¤±è´¥çš„Promiseï¼‰</span>
    <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç¬¬ä¸€æ­¥æˆåŠŸï¼š"</span>, res);
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">task2</span>(); <span class="hljs-comment">// è¿”å›ä¸€ä¸ªå¤±è´¥çš„æ–°Promiseï¼ˆè®°ä¸ºP2ï¼‰</span>
    },
    <span class="hljs-comment">// å¤±è´¥å›è°ƒï¼šåªç»‘å®štask1è¿”å›çš„Promiseï¼ˆè®°ä¸ºP1ï¼‰ï¼Œåªèƒ½æ•è·P1çš„å¼‚å¸¸</span>
    <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ•è·åˆ°å¼‚å¸¸ï¼š"</span>, err.<span class="hljs-property">message</span>);
    }
  );

<span class="hljs-comment">/* è¾“å‡ºç»“æœï¼š
ç¬¬ä¸€æ­¥æˆåŠŸï¼š ç¬¬ä¸€æ­¥ç»“æœ
Uncaught (in promise) Error: ç¬¬äºŒæ­¥æ‰§è¡Œå¤±è´¥
*/</span>
</code></pre>
<p><strong>å…³é”®é—®é¢˜</strong>ï¼šç¬¬äºŒæ­¥çš„å¼‚å¸¸æ²¡è¢«æ•è·ï¼å› ä¸º then çš„ç¬¬äºŒä¸ªå‚æ•°åªè´Ÿè´£ã€Œtask1 è¿”å›çš„ P1ã€ï¼Œç®¡ä¸åˆ°ã€Œç¬¬ä¸€ä¸ª then è¿”å›çš„ P2ï¼ˆtask2 çš„ Promiseï¼‰ã€çš„å¼‚å¸¸ã€‚</p>
<h5 data-id="heading-26">åœºæ™¯2ï¼šç”¨ catch æ³¨å†Œå¤±è´¥å›è°ƒï¼ˆèƒ½æ•è·æ•´ä¸ªé“¾æ¡çš„å¼‚å¸¸ï¼‰</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å†™æ³•2ï¼šthen(æˆåŠŸå›è°ƒ) + catch(å¤±è´¥å›è°ƒ)</span>
<span class="hljs-title function_">task1</span>()
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç¬¬ä¸€æ­¥æˆåŠŸï¼š"</span>, res);
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">task2</span>(); <span class="hljs-comment">// è¿”å›å¤±è´¥çš„P2</span>
  })
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
    <span class="hljs-comment">// catchç»‘å®šçš„æ˜¯ã€Œä¸Šä¸€ä¸ªthenè¿”å›çš„P2ã€ï¼Œèƒ½æ•è·P2çš„å¼‚å¸¸</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ•è·åˆ°å¼‚å¸¸ï¼š"</span>, err.<span class="hljs-property">message</span>);
  });

<span class="hljs-comment">/* è¾“å‡ºç»“æœï¼š
ç¬¬ä¸€æ­¥æˆåŠŸï¼š ç¬¬ä¸€æ­¥ç»“æœ
æ•è·åˆ°å¼‚å¸¸ï¼š ç¬¬äºŒæ­¥æ‰§è¡Œå¤±è´¥
*/</span>
</code></pre>
<p><strong>æ ¸å¿ƒåŸå› </strong>ï¼šcatch ç­‰ä»·äº <code>then(undefined, å¤±è´¥å›è°ƒ)</code>ï¼Œè¿™ä¸ªå¤±è´¥å›è°ƒç»‘å®šåœ¨ã€Œç¬¬ä¸€ä¸ª then è¿”å›çš„ P2ã€ä¸Šï¼Œåˆšå¥½èƒ½æ•è· P2 çš„å¼‚å¸¸ã€‚</p>
<h4 data-id="heading-27">æ‹†è§£å¼‚å¸¸ä¼ é€’+å›è°ƒç»‘å®šé€»è¾‘ï¼ˆä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿï¼‰</h4>
<p>æˆ‘ä»¬ç”¨ã€ŒPromise é“¾æ¡å¯¹è±¡å…³ç³»ã€æ¥æ‹†è§£ä¸Šé¢çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">task1</span>() â†’ è¿”å› P1ï¼ˆæˆåŠŸçŠ¶æ€ï¼‰
â†“
P1<span class="hljs-selector-class">.then</span>(æˆåŠŸå›è°ƒ, å¤±è´¥å›è°ƒ) â†’ è¿”å› P2ï¼ˆç”±æˆåŠŸå›è°ƒçš„è¿”å›å€¼å†³å®šï¼š<span class="hljs-built_in">task2</span>() è¿”å›å¤±è´¥çš„Promise â†’ P2 å¤±è´¥ï¼‰
â†“
P2<span class="hljs-selector-class">.catch</span>(å¤±è´¥å›è°ƒ) â†’ ç»‘å®šåœ¨ P2 ä¸Šï¼Œæ•è· P2 çš„å¤±è´¥
</code></pre>
<h5 data-id="heading-28">å…³é”®ç»†èŠ‚ï¼š</h5>
<ol>
<li><code>then(æˆåŠŸå›è°ƒ, å¤±è´¥å›è°ƒ)</code> çš„å¤±è´¥å›è°ƒ â†’ åªç»‘å®š <strong>P1</strong>ï¼Œåªèƒ½å¤„ç† P1 çš„å¼‚å¸¸ï¼ˆæ¯”å¦‚ task1 å¤±è´¥ï¼‰ï¼›</li>
<li><code>catch()</code> â†’ ç»‘å®š <strong>P2</strong>ï¼Œèƒ½å¤„ç† P2 çš„å¼‚å¸¸ï¼ˆåŒ…æ‹¬ P2 è‡ªèº«å¤±è´¥ã€æˆ– P1 æœªè¢«æ•è·çš„å¼‚å¸¸å‘åä¼ é€’è¿‡æ¥ï¼‰ï¼›</li>
<li>å¼‚å¸¸ä¼ é€’è§„åˆ™ï¼šå¦‚æœä¸€ä¸ª Promise å¤±è´¥ä¸”æ²¡æœ‰å¯¹åº”çš„å¤±è´¥å›è°ƒï¼Œå¼‚å¸¸ä¼šã€Œé¡ºç€é“¾æ¡å¾€åä¼ ã€ï¼Œç›´åˆ°è¢«æŸä¸ª catch/then å¤±è´¥å›è°ƒæ•è·ã€‚</li>
</ol>
<h4 data-id="heading-29">è¡¥å……ï¼šå¦‚æœç¬¬ä¸€æ­¥å°±å¤±è´¥ï¼Œä¸¤ç§å†™æ³•çš„è¡¨ç°</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ”¹é€ task1ï¼šè®©ç¬¬ä¸€æ­¥ç›´æ¥å¤±è´¥</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">task1</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"ç¬¬ä¸€æ­¥æ‰§è¡Œå¤±è´¥"</span>));
  });
}

<span class="hljs-comment">// å†™æ³•1ï¼šthençš„ç¬¬äºŒä¸ªå‚æ•° â†’ èƒ½æ•è·P1çš„å¼‚å¸¸</span>
<span class="hljs-title function_">task1</span>().<span class="hljs-title function_">then</span>(
  <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res),
  <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"thenæ•è·ï¼š"</span>, err.<span class="hljs-property">message</span>) <span class="hljs-comment">// è¾“å‡ºï¼šthenæ•è·ï¼šç¬¬ä¸€æ­¥æ‰§è¡Œå¤±è´¥</span>
);

<span class="hljs-comment">// å†™æ³•2ï¼šcatch â†’ ä¹Ÿèƒ½æ•è·ï¼ˆå› ä¸ºP1çš„å¼‚å¸¸ä¼ é€’åˆ°P2ï¼Œè¢«catchæ•è·ï¼‰</span>
<span class="hljs-title function_">task1</span>()
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res))
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"catchæ•è·ï¼š"</span>, err.<span class="hljs-property">message</span>)); <span class="hljs-comment">// è¾“å‡ºï¼šcatchæ•è·ï¼šç¬¬ä¸€æ­¥æ‰§è¡Œå¤±è´¥</span>
</code></pre>
<p>è¿™è¯´æ˜ï¼š<strong>catch èƒ½æ•è·æ•´ä¸ªé“¾æ¡ä¸­ã€Œå‰é¢æ‰€æœ‰æœªè¢«å¤„ç†çš„å¼‚å¸¸ã€ï¼Œè€Œ then ç¬¬äºŒä¸ªå‚æ•°åªèƒ½æ•è·ã€Œå½“å‰ Promiseã€çš„å¼‚å¸¸</strong>ã€‚</p>
<h4 data-id="heading-30">ä¸ºä»€ä¹ˆ catch æ›´é€‚åˆé“¾å¼è°ƒç”¨ï¼Ÿ</h4>
<ul>
<li>é“¾å¼è°ƒç”¨çš„æ ¸å¿ƒæ˜¯ã€Œå¤šä¸ªå¼‚æ­¥ä»»åŠ¡ä¾æ¬¡æ‰§è¡Œã€ï¼Œæ¯ä¸ªä»»åŠ¡å¯¹åº”é“¾æ¡ä¸­çš„ä¸€ä¸ª Promiseï¼›</li>
<li>ç”¨ catch å¯ä»¥ã€Œç»Ÿä¸€æ•è·æ•´ä¸ªé“¾æ¡çš„æ‰€æœ‰å¼‚å¸¸ã€ï¼Œæ— éœ€åœ¨æ¯ä¸ª then é‡Œå†™å¤±è´¥å›è°ƒï¼›</li>
<li>ç”¨ then ç¬¬äºŒä¸ªå‚æ•°åˆ™éœ€è¦ã€Œæ¯ä¸ª then éƒ½å†™å¤±è´¥å›è°ƒã€ï¼Œå¦åˆ™åç»­ Promise çš„å¼‚å¸¸ä¼šé€ƒé€¸ï¼ˆæœªæ•è·ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-31">æ€»ç»“</h4>
<ol>
<li><code>catch()</code> æ˜¯ <code>then(undefined, å¤±è´¥å›è°ƒ)</code> çš„è¯­æ³•ç³–ï¼Œä½†ç»‘å®šçš„æ˜¯<strong>ä¸Šä¸€ä¸ª then è¿”å›çš„æ–° Promise</strong>ï¼Œè€ŒéåŸå§‹ Promiseï¼›</li>
<li><code>then(æˆåŠŸ, å¤±è´¥)</code> çš„å¤±è´¥å›è°ƒ<strong>ä»…ç»‘å®šå½“å‰ Promise</strong>ï¼Œæ— æ³•æ•è·åç»­ then ä¸­è¿”å›çš„æ–° Promise å¼‚å¸¸ï¼›</li>
<li>Promise å¼‚å¸¸ä¼šã€Œå‘åä¼ é€’ã€ï¼Œcatch å› ç»‘å®šåœ¨é“¾æ¡æœ«ç«¯çš„ Promise ä¸Šï¼Œèƒ½æ•è·æ•´ä¸ªé“¾æ¡çš„æ‰€æœ‰æœªå¤„ç†å¼‚å¸¸ï¼Œè¿™ä¹Ÿæ˜¯å®ƒæ›´é€‚åˆé“¾å¼è°ƒç”¨çš„æ ¸å¿ƒåŸå› ã€‚</li>
</ol>
<h2 data-id="heading-32">unhandledrejection æ˜¯å¦æ¨èä½¿ç”¨</h2>
<h4 data-id="heading-33">ä¸€ã€å…ˆç®€å•äº†è§£å…¨å±€æ•è·ï¼ˆä»…ä½œè®¤çŸ¥ï¼Œä¸æ¨èä½¿ç”¨ï¼‰</h4>
<h5 data-id="heading-34">1. æµè§ˆå™¨ç¯å¢ƒï¼ˆwindow ä¸Šæ³¨å†Œ unhandledrejectionï¼‰</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æµè§ˆå™¨ä¸­å…¨å±€æ•è·æœªå¤„ç†çš„Promiseå¼‚å¸¸ï¼ˆä»…æ¼”ç¤ºï¼Œä¸æ¨èï¼‰</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'unhandledrejection'</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-comment">// é˜»æ­¢æµè§ˆå™¨é»˜è®¤çš„é”™è¯¯æç¤ºï¼ˆæ¯”å¦‚æ§åˆ¶å°çš„çº¢è‰²æŠ¥é”™ï¼‰</span>
  event.<span class="hljs-title function_">preventDefault</span>();
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å…¨å±€æ•è·æœªå¤„ç†çš„Promiseå¼‚å¸¸ï¼š'</span>, event.<span class="hljs-property">reason</span>.<span class="hljs-property">message</span>);
});

<span class="hljs-comment">// æµ‹è¯•ï¼šæŠ›å‡ºä¸€ä¸ªæœªæ‰‹åŠ¨æ•è·çš„Promiseå¼‚å¸¸</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è¿™æ˜¯ä¸€ä¸ªæœªè¢«æ‰‹åŠ¨æ•è·çš„å¼‚å¸¸'</span>));
});
<span class="hljs-comment">// æ§åˆ¶å°ä¼šè¾“å‡ºï¼šå…¨å±€æ•è·æœªå¤„ç†çš„Promiseå¼‚å¸¸ï¼šè¿™æ˜¯ä¸€ä¸ªæœªè¢«æ‰‹åŠ¨æ•è·çš„å¼‚å¸¸</span>
</code></pre>
<h5 data-id="heading-35">2. Node.js ç¯å¢ƒï¼ˆprocess ä¸Šæ³¨å†Œ unhandledRejectionï¼‰</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Node.jsä¸­å…¨å±€æ•è·ï¼ˆä»…æ¼”ç¤ºï¼Œä¸æ¨èï¼‰</span>
process.<span class="hljs-title function_">on</span>(<span class="hljs-string">'unhandledRejection'</span>, <span class="hljs-function">(<span class="hljs-params">reason, promise</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å…¨å±€æ•è·æœªå¤„ç†çš„Promiseå¼‚å¸¸ï¼š'</span>, reason.<span class="hljs-property">message</span>);
});

<span class="hljs-comment">// æµ‹è¯•</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Nodeä¸­æœªè¢«æ‰‹åŠ¨æ•è·çš„å¼‚å¸¸'</span>));
});
</code></pre>
<h4 data-id="heading-36">äºŒã€ä¸ºä»€ä¹ˆå¼ºçƒˆä¸æ¨èå…¨å±€æ•è·ï¼Ÿï¼ˆæ ¸å¿ƒåŸå› ï¼‰</h4>
<p>ã€Œä¸æ¨èå…¨å±€ç»Ÿä¸€å¤„ç†ã€ï¼Œæ ¸å¿ƒé—®é¢˜æœ‰è¿™å‡ ç‚¹ï¼š</p>
<ol>
<li><strong>è°ƒè¯•å›°éš¾</strong>ï¼šå…¨å±€æ•è·ä¼šã€Œå…œåº•ã€æ‰€æœ‰æœªå¤„ç†çš„å¼‚å¸¸ï¼Œä½†æ— æ³•ç²¾å‡†å®šä½å¼‚å¸¸å‘ç”Ÿçš„ä½ç½®â€”â€”ä¸€ä¸ªå¤§å‹é¡¹ç›®ä¸­ï¼Œä½ æ— æ³•ä»å…¨å±€å›è°ƒé‡Œå¿«é€ŸçŸ¥é“æ˜¯å“ªä¸€è¡Œä»£ç ã€å“ªä¸ªå¼‚æ­¥ä»»åŠ¡æŠ›å‡ºçš„å¼‚å¸¸ã€‚</li>
<li><strong>æ©ç›–é—®é¢˜</strong>ï¼šå…¨å±€æ•è·ä¼šè®©å¼€å‘è€…äº§ç”Ÿã€Œåæ­£æœ‰å…œåº•ï¼Œä¸ç”¨æ‰‹åŠ¨å†™ catchã€çš„æƒ°æ€§ï¼Œå¯¼è‡´ä»£ç ä¸­å¤§é‡å¼‚å¸¸æ²¡æœ‰è¢«ã€Œé’ˆå¯¹æ€§å¤„ç†ã€ï¼ˆæ¯”å¦‚æŸä¸ªæ¥å£å¤±è´¥éœ€è¦é‡è¯•ï¼Œå¦ä¸€ä¸ªéœ€è¦æç¤ºç”¨æˆ·ï¼Œå…¨å±€æ•è·åªèƒ½ç»Ÿä¸€æ‰“å°ï¼Œæ— æ³•å·®å¼‚åŒ–å¤„ç†ï¼‰ã€‚</li>
<li><strong>ä¸å¯æ§æ€§</strong>ï¼šå…¨å±€äº‹ä»¶æ˜¯ã€Œæœ€åä¸€é“é˜²çº¿ã€ï¼Œè‹¥ä»£ç ä¸­æ¼å†™ catchï¼Œå…¨å±€æ•è·ä¼šæ¥ä½å¼‚å¸¸ï¼Œä½†è¿™å±äºã€Œè¢«åŠ¨è¡¥æ•‘ã€ï¼Œè€Œéã€Œä¸»åŠ¨å¤„ç†ã€ï¼Œå®¹æ˜“åŸ‹ä¸‹çº¿ä¸Šbugï¼ˆæ¯”å¦‚å¼‚å¸¸å¤„ç†é€»è¾‘ä¸åŒ¹é…åœºæ™¯ï¼‰ã€‚</li>
</ol>
<h4 data-id="heading-37">ä¸‰ã€æ›´ä¼˜çš„åšæ³•ï¼šæ˜¾å¼æ•è·æ¯ä¸€ä¸ªå¯èƒ½çš„å¼‚å¸¸</h4>
<p>æœ€ä½³å®è·µæ˜¯ã€Œé“¾å¼è°ƒç”¨æœ«å°¾åŠ  catchã€+ã€Œé’ˆå¯¹ä¸åŒåœºæ™¯å·®å¼‚åŒ–å¤„ç†å¼‚å¸¸ã€ï¼Œç”šè‡³å¯ä»¥ç»™ä¸åŒå¼‚æ­¥ä»»åŠ¡åŠ ã€Œä¸“å±çš„å¼‚å¸¸å¤„ç†ã€ã€‚</p>
<h5 data-id="heading-38">ç¤ºä¾‹1ï¼šåŸºç¡€ç‰ˆâ€”â€”é“¾å¼æœ«å°¾ç»Ÿä¸€ catch</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨¡æ‹Ÿä¸¤ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œç¬¬äºŒæ­¥å¯èƒ½å¤±è´¥</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">task1</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'ç¬¬ä¸€æ­¥æˆåŠŸ'</span>));
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">task2</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-comment">// æ¨¡æ‹Ÿéšæœºå¤±è´¥</span>
    <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() &gt; <span class="hljs-number">0.5</span> 
      ? <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'ç¬¬äºŒæ­¥æˆåŠŸ'</span>) 
      : <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'ç¬¬äºŒæ­¥æ¥å£è°ƒç”¨å¤±è´¥'</span>));
  });
}

<span class="hljs-comment">// æ˜¾å¼æ•è·ï¼šé“¾å¼æœ«å°¾åŠ catchï¼Œé’ˆå¯¹æ€§å¤„ç†</span>
<span class="hljs-title function_">task1</span>()
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res);
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">task2</span>();
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res);
  })
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
    <span class="hljs-comment">// ç²¾å‡†å¤„ç†ï¼šåŒºåˆ†ä¸åŒå¼‚å¸¸ï¼Œåšä¸åŒæ“ä½œ</span>
    <span class="hljs-keyword">if</span> (err.<span class="hljs-property">message</span> === <span class="hljs-string">'ç¬¬äºŒæ­¥æ¥å£è°ƒç”¨å¤±è´¥'</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¤„ç†ç¬¬äºŒæ­¥å¤±è´¥ï¼š'</span>, <span class="hljs-string">'é‡è¯•ä¸€æ¬¡æˆ–æç¤ºç”¨æˆ·'</span>);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å…¶ä»–å¼‚å¸¸ï¼š'</span>, err.<span class="hljs-property">message</span>);
    }
  });
</code></pre>
<h5 data-id="heading-39">ç¤ºä¾‹2ï¼šè¿›é˜¶ç‰ˆâ€”â€”åˆ†é˜¶æ®µæ•è·ï¼ˆä¸åŒä»»åŠ¡å•ç‹¬å¤„ç†ï¼‰</h5>
<p>å¦‚æœæŸä¸ªå¼‚æ­¥ä»»åŠ¡çš„å¼‚å¸¸éœ€è¦ã€Œå•ç‹¬å¤„ç†ï¼Œä¸ä¸­æ–­åç»­æµç¨‹ã€ï¼Œå¯ä»¥åœ¨è¯¥ä»»åŠ¡çš„ then åç´§è·Ÿ catchï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">task1</span>()
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res);
    <span class="hljs-comment">// ç¬¬äºŒæ­¥å¤±è´¥åå•ç‹¬å¤„ç†ï¼Œä¸å½±å“åç»­æµç¨‹</span>
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">task2</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬äºŒæ­¥å•ç‹¬å¤„ç†å¤±è´¥ï¼š'</span>, err.<span class="hljs-property">message</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-string">'ç¬¬äºŒæ­¥å¤±è´¥åçš„å…œåº•å€¼'</span>; <span class="hljs-comment">// è¿”å›å…œåº•å€¼ï¼Œè®©é“¾æ¡ç»§ç»­</span>
    });
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
    <span class="hljs-comment">// `æ— è®ºç¬¬äºŒæ­¥æˆåŠŸ/å¤±è´¥ï¼Œéƒ½ä¼šæ‰§è¡Œè¿™é‡Œ`--- é‡ç‚¹ï¼ï¼ï¼</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬ä¸‰æ­¥ï¼šæ¥æ”¶ç¬¬äºŒæ­¥ç»“æœ'</span>, res);
  })
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
    <span class="hljs-comment">// æ•è·å…¶ä»–æœªå¤„ç†çš„å¼‚å¸¸</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å…¨å±€å…œåº•ï¼ˆæå°‘è§¦å‘ï¼‰ï¼š'</span>, err.<span class="hljs-property">message</span>);
  });
</code></pre>
<h4 data-id="heading-40">æ€»ç»“</h4>
<ol>
<li>å…¨å±€ <code>unhandledrejection</code>/<code>unhandledRejection</code> æ˜¯ã€Œå…œåº•æ–¹æ¡ˆã€ï¼Œä»…é€‚åˆä¸´æ—¶è°ƒè¯•æˆ–ç´§æ€¥è¡¥æ•‘ï¼Œ<strong>ä¸æ¨èä½œä¸ºå¸¸è§„å¼‚å¸¸å¤„ç†æ–¹å¼</strong>ï¼›</li>
<li>æœ€ä½³å®è·µæ˜¯ã€Œæ˜¾å¼æ•è·ã€ï¼šåœ¨ Promise é“¾æ¡æœ«å°¾åŠ  <code>catch</code>ï¼Œé’ˆå¯¹ä¸åŒå¼‚å¸¸åšã€Œå·®å¼‚åŒ–å¤„ç†ã€ï¼ˆé‡è¯•ã€å…œåº•ã€æç¤ºç”¨æˆ·ç­‰ï¼‰ï¼›</li>
<li>è‹¥éœ€è¦ä¿ç•™é“¾æ¡æ‰§è¡Œï¼Œå¯åœ¨å•ä¸ªå¼‚æ­¥ä»»åŠ¡åç´§è·Ÿ catchï¼Œè¿”å›å…œåº•å€¼ï¼Œé¿å…æ•´ä¸ªé“¾æ¡ä¸­æ–­ã€‚</li>
<li><strong><code>å…³äºcatchè¿”å›å€¼ï¼š</code></strong>
<ul>
<li>å¦‚æœ catch å›è°ƒ<strong>è¿”å›æ­£å¸¸å€¼</strong>ï¼ˆæ™®é€šå€¼ / æˆåŠŸçš„ Promiseï¼‰â†’ æ–° Promise çŠ¶æ€ä¸º <code>fulfilled</code>ï¼ˆæˆåŠŸï¼‰ï¼›</li>
<li>å¦‚æœ catch å›è°ƒ<strong>æŠ›å‡ºå¼‚å¸¸ / è¿”å›å¤±è´¥çš„ Promise</strong> â†’ æ–° Promise çŠ¶æ€ä¸º <code>rejected</code>ï¼ˆå¤±è´¥ï¼‰</li>
</ul>
</li>
</ol>
<ul>
<li>å¦‚æœ catch å›è°ƒ<strong>æŠ›å‡ºå¼‚å¸¸ / è¿”å›å¤±è´¥çš„ Promise</strong> â†’ æ–° Promise çŠ¶æ€ä¸º <code>rejected</code>ï¼ˆå¤±è´¥ï¼‰</li>
</ul>
<h2 data-id="heading-41">Promise.reslove</h2>
<h4 data-id="heading-42">ä¸€ã€Promise.resolve() åŸºæœ¬ç”¨æ³•</h4>
<p><code>Promise.resolve(value)</code> æ˜¯åˆ›å»ºã€Œå·²æˆåŠŸ Promiseã€çš„å¿«æ·æ–¹å¼ï¼Œæ— éœ€æ‰‹åŠ¨å†™ <code>new Promise</code> + <code>resolve</code>ï¼Œæ ¸å¿ƒé€»è¾‘å°±æ˜¯ï¼š<strong>æ¥æ”¶ä¸€ä¸ªå€¼ï¼Œè¿”å›ä¸€ä¸ªçŠ¶æ€ä¸º fulfilled çš„ Promiseï¼Œä¸”è¯¥å€¼ä¼šä½œä¸º Promise çš„æˆåŠŸç»“æœ</strong>ã€‚</p>
<h5 data-id="heading-43">ä»£ç ç¤ºä¾‹ï¼šPromise.resolve() åŸºç¡€ä½¿ç”¨</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç”¨ Promise.resolve å¿«é€Ÿåˆ›å»ºæˆåŠŸçš„ Promise</span>
<span class="hljs-keyword">const</span> p1 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'foo'</span>);

<span class="hljs-comment">// è°ƒç”¨ then æ¥æ”¶ç»“æœï¼ˆä½ æåˆ°çš„ unfulfilled æ˜¯ç¬”è¯¯ï¼Œæ­£ç¡®æ˜¯ fulfilledï¼‰</span>
p1.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æˆåŠŸå›è°ƒæ‹¿åˆ°çš„å€¼ï¼š'</span>, res); <span class="hljs-comment">// è¾“å‡ºï¼šæˆåŠŸå›è°ƒæ‹¿åˆ°çš„å€¼ï¼šfoo</span>
});
</code></pre>
<h4 data-id="heading-44">äºŒã€ç­‰ä»·é€»è¾‘ï¼šPromise.resolve() â‰ˆ new Promise + resolve</h4>
<p>ä½ æåˆ°ã€Œè¿™ç§æ–¹å¼å®Œå…¨ç­‰ä»·äº new Promise ç„¶åç›´æ¥ resolve è¯¥å€¼ã€ï¼Œæˆ‘ä»¬ç”¨ä»£ç éªŒè¯è¿™ä¸ªç­‰ä»·æ€§ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ–¹å¼1ï¼šPromise.resolve å¿«æ·å†™æ³•</span>
<span class="hljs-keyword">const</span> p1 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'foo'</span>);

<span class="hljs-comment">// æ–¹å¼2ï¼šnew Promise å®Œæ•´å†™æ³•ï¼ˆå’Œæ–¹å¼1å®Œå…¨ç­‰ä»·ï¼‰</span>
<span class="hljs-keyword">const</span> p2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
  <span class="hljs-comment">// åœ¨æ‰§è¡Œå‡½æ•°ä¸­ç›´æ¥ resolve 'foo'ï¼ŒPromise çŠ¶æ€ç«‹å³å˜ä¸º fulfilled</span>
  <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'foo'</span>);
});

<span class="hljs-comment">// æµ‹è¯•ä¸¤ä¸ª Promise çš„æ‰§è¡Œç»“æœï¼ˆå®Œå…¨ä¸€è‡´ï¼‰</span>
p1.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'p1ç»“æœï¼š'</span>, res)); <span class="hljs-comment">// p1ç»“æœï¼šfoo</span>
p2.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'p2ç»“æœï¼š'</span>, res)); <span class="hljs-comment">// p2ç»“æœï¼šfoo</span>
</code></pre>
<h5 data-id="heading-45">æ ¸å¿ƒç­‰ä»·ç‚¹ï¼š</h5>
<ul>
<li>ä¸¤è€…åˆ›å»ºçš„ Promise çŠ¶æ€éƒ½æ˜¯ <code>fulfilled</code>ï¼ˆæˆåŠŸï¼‰ï¼›</li>
<li>ä¸¤è€…çš„æˆåŠŸå›è°ƒæ‹¿åˆ°çš„å‚æ•°éƒ½æ˜¯ä¼ å…¥çš„ <code>'foo'</code>ï¼›</li>
<li>ä¸¤è€…çš„æ‰§è¡Œæ—¶æœºä¸€è‡´ï¼š<code>Promise.resolve()</code> å†…éƒ¨çš„é€»è¾‘å’Œ <code>new Promise</code> çš„æ‰§è¡Œå‡½æ•°ä¸€æ ·ï¼Œæ˜¯<strong>åŒæ­¥æ‰§è¡Œ</strong>çš„ï¼ˆä½†å›è°ƒä»ä¸ºå¾®ä»»åŠ¡ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-46">ä¸‰ã€Promise.resolve() çš„è¿›é˜¶åœºæ™¯ï¼ˆæ‹“å±•ç†è§£ï¼‰</h4>
<p>é™¤äº†ä¼ å…¥æ™®é€šå€¼ï¼ˆå­—ç¬¦ä¸²ã€æ•°å­—ç­‰ï¼‰ï¼Œ<code>Promise.resolve()</code> è¿˜æœ‰ä¸¤ä¸ªå¸¸è§åœºæ™¯ï¼Œå¸®ä½ å…¨é¢æŒæ¡ï¼š</p>
<h5 data-id="heading-47">åœºæ™¯1ï¼šä¼ å…¥ Promise å¯¹è±¡</h5>
<p>å¦‚æœä¼ å…¥çš„æ˜¯ä¸€ä¸ªå·²å­˜åœ¨çš„ Promiseï¼Œ<code>Promise.resolve()</code> ä¼šç›´æ¥è¿”å›è¿™ä¸ª Promiseï¼ˆä¸ä¼šåˆ›å»ºæ–°å¯¹è±¡ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> originalPromise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'åŸå§‹Promise'</span>));
<span class="hljs-keyword">const</span> wrappedPromise = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(originalPromise);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(originalPromise === wrappedPromise); <span class="hljs-comment">// trueï¼ˆè¿”å›åŒä¸€ä¸ªå¯¹è±¡ï¼‰</span>
wrappedPromise.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)); <span class="hljs-comment">// åŸå§‹Promise</span>
</code></pre>
<h5 data-id="heading-48">åœºæ™¯2ï¼šä¼ å…¥ã€Œç±» Promise å¯¹è±¡ã€ï¼ˆthenableï¼‰</h5>
<p>å¦‚æœä¼ å…¥çš„æ˜¯æœ‰ <code>then</code> æ–¹æ³•çš„å¯¹è±¡ï¼ˆç§°ä¸º thenableï¼‰ï¼Œ<code>Promise.resolve()</code> ä¼šæ‰§è¡Œå…¶ <code>then</code> æ–¹æ³•ï¼Œå°†å…¶è½¬æ¢æˆæ ‡å‡† Promiseï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å®šä¹‰ä¸€ä¸ª thenable å¯¹è±¡ï¼ˆæœ‰ then æ–¹æ³•ï¼Œä½†ä¸æ˜¯çœŸæ­£çš„ Promiseï¼‰</span>
<span class="hljs-keyword">const</span> thenable = {
  <span class="hljs-title function_">then</span>(<span class="hljs-params">resolve</span>) {
    <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'thenable è½¬æ¢çš„ç»“æœ'</span>);
  }
};

<span class="hljs-comment">// Promise.resolve ä¼šæ‰§è¡Œ then æ–¹æ³•ï¼Œè½¬æ¢æˆæ ‡å‡† Promise</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(thenable).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res); <span class="hljs-comment">// è¾“å‡ºï¼šthenable è½¬æ¢çš„ç»“æœ</span>
});
</code></pre>
<h4 data-id="heading-49">å››ã€ä¸ºä»€ä¹ˆè¦ç”¨ Promise.resolve()ï¼Ÿ</h4>
<p>ç›¸æ¯” <code>new Promise</code> å†™æ³•ï¼Œ<code>Promise.resolve()</code> çš„ä¼˜åŠ¿åœ¨äºï¼š</p>
<ol>
<li><strong>ç®€åŒ–ä»£ç </strong>ï¼šåˆ›å»ºå·²æˆåŠŸçš„ Promise æ—¶ï¼Œå°‘å†™åµŒå¥—çš„æ‰§è¡Œå‡½æ•°ï¼Œä»£ç æ›´ç®€æ´ï¼›</li>
<li><strong>ç»Ÿä¸€æ¥å£</strong>ï¼šå½“ä½ ä¸ç¡®å®šä¸€ä¸ªå€¼æ˜¯æ™®é€šå€¼è¿˜æ˜¯ Promise æ—¶ï¼Œç”¨ <code>Promise.resolve()</code> å¯ä»¥ã€Œå½’ä¸€åŒ–ã€æˆ Promiseï¼Œæ–¹ä¾¿é“¾å¼è°ƒç”¨ï¼š
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å‡è®¾ fn å¯èƒ½è¿”å›æ™®é€šå€¼ï¼Œä¹Ÿå¯èƒ½è¿”å› Promise</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() &gt; <span class="hljs-number">0.5</span> ? <span class="hljs-string">'æ™®é€šå€¼'</span> : <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'Promiseå€¼'</span>);
}

<span class="hljs-comment">// ç”¨ Promise.resolve ç»Ÿä¸€å¤„ç†ï¼Œæ— éœ€åŒºåˆ†ç±»å‹</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-title function_">fn</span>()).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»Ÿä¸€æ‹¿åˆ°ç»“æœï¼š'</span>, res);
});
</code></pre>
</li>
</ol>
<h4 data-id="heading-50">æ€»ç»“</h4>
<ol>
<li><code>Promise.resolve(value)</code> æ˜¯åˆ›å»º<strong>çŠ¶æ€ä¸º fulfilled çš„ Promise</strong> çš„å¿«æ·æ–¹å¼ï¼Œç­‰ä»·äº <code>new Promise((resolve) =&gt; resolve(value))</code>ï¼›</li>
<li>ä¼ å…¥æ™®é€šå€¼æ—¶ï¼Œè¯¥å€¼ä¼šä½œä¸º Promise çš„æˆåŠŸç»“æœï¼Œåœ¨ <code>then</code> çš„æˆåŠŸå›è°ƒä¸­è·å–ï¼›</li>
<li>ä¼ å…¥ Promise/thenable å¯¹è±¡æ—¶ï¼Œ<code>Promise.resolve()</code> ä¼šé€‚é…å¹¶è¿”å›æ ‡å‡† Promiseï¼Œæ ¸å¿ƒä½œç”¨æ˜¯ã€Œå½’ä¸€åŒ–ã€å€¼çš„ç±»å‹ï¼Œæ–¹ä¾¿å¼‚æ­¥å¤„ç†ã€‚</li>
</ol>
<p>æ ¸å¿ƒè®°ä½ï¼š<code>Promise.resolve()</code> çš„æœ¬è´¨æ˜¯ã€Œå¿«é€Ÿç”ŸæˆæˆåŠŸçš„ Promiseã€ï¼Œå‡å°‘å†—ä½™ä»£ç ï¼Œç»Ÿä¸€å¼‚æ­¥/åŒæ­¥å€¼çš„å¤„ç†é€»è¾‘ã€‚</p>
<h2 data-id="heading-51">Promise.reject</h2>
<h4 data-id="heading-52">Promise.reject() å¿«é€Ÿåˆ›å»ºå¤±è´¥çš„ Promise</h4>
<p><code>Promise.reject()</code> æ˜¯åˆ›å»ºã€ŒçŠ¶æ€ä¸º rejectedï¼ˆå¤±è´¥ï¼‰ã€Promise çš„å¿«æ·æ–¹å¼ï¼Œä½ æåˆ°ã€Œæ— è®ºä¼ å…¥ä»€ä¹ˆå‚æ•°ï¼Œéƒ½ä¼šä½œä¸ºå¤±è´¥ç†ç”±ã€ï¼Œä»£ç éªŒè¯ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. ä¼ å…¥æ™®é€šå€¼ï¼ˆå­—ç¬¦ä¸²ï¼‰</span>
<span class="hljs-keyword">const</span> p1 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-string">'æ™®é€šé”™è¯¯ä¿¡æ¯'</span>);
p1.<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'p1å¤±è´¥ç†ç”±ï¼š'</span>, err)); <span class="hljs-comment">// è¾“å‡ºï¼šp1å¤±è´¥ç†ç”±ï¼šæ™®é€šé”™è¯¯ä¿¡æ¯</span>

<span class="hljs-comment">// 2. ä¼ å…¥ Error å¯¹è±¡ï¼ˆæ¨èå†™æ³•ï¼ŒåŒ…å«å †æ ˆä¿¡æ¯ï¼‰</span>
<span class="hljs-keyword">const</span> p2 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'æ ‡å‡†é”™è¯¯å¯¹è±¡'</span>));
p2.<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'p2å¤±è´¥ç†ç”±ï¼š'</span>, err.<span class="hljs-property">message</span>)); <span class="hljs-comment">// è¾“å‡ºï¼šp2å¤±è´¥ç†ç”±ï¼šæ ‡å‡†é”™è¯¯å¯¹è±¡</span>

<span class="hljs-comment">// 3. ä¼ å…¥ Promise å¯¹è±¡ï¼ˆå’Œ resolve ä¸åŒï¼Œä¸ä¼šåŸæ ·è¿”å›ï¼Œè€Œæ˜¯ç›´æ¥ä½œä¸ºå¤±è´¥ç†ç”±ï¼‰</span>
<span class="hljs-keyword">const</span> originalPromise = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'æˆåŠŸçš„Promise'</span>);
<span class="hljs-keyword">const</span> p3 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(originalPromise);
p3.<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'p3å¤±è´¥ç†ç”±æ˜¯åŸPromiseï¼š'</span>, err === originalPromise); <span class="hljs-comment">// è¾“å‡ºï¼štrue</span>
});
</code></pre>
<h5 data-id="heading-53">å…³é”®åŒºåˆ«ï¼ˆå’Œ Promise.resolve å¯¹æ¯”ï¼‰ï¼š</h5>
<ul>
<li><code>Promise.resolve(å·²å­˜åœ¨çš„Promise)</code> â†’ è¿”å›åŸ Promiseï¼›</li>
<li><code>Promise.reject(å·²å­˜åœ¨çš„Promise)</code> â†’ ä¸ä¼šè¿”å›åŸ Promiseï¼Œè€Œæ˜¯æŠŠè¿™ä¸ª Promise å¯¹è±¡<strong>ç›´æ¥ä½œä¸ºå¤±è´¥ç†ç”±</strong>ã€‚</li>
</ul>
<h4 data-id="heading-54">æ€»ç»“</h4>
<ol>
<li><code>Promise.resolve(x)</code> è§„åˆ™ï¼š
<ul>
<li>x æ˜¯æ™®é€šå€¼ â†’ è¿”å› fulfilled çŠ¶æ€çš„ Promiseï¼Œx ä¸ºæˆåŠŸç»“æœï¼›</li>
<li>x æ˜¯ Promise â†’ åŸæ ·è¿”å› xï¼›</li>
<li>x æ˜¯ thenable å¯¹è±¡ â†’ è½¬æ¢æˆåŸç”Ÿ Promiseï¼Œæ‰§è¡Œå…¶ then æ–¹æ³•ã€‚</li>
</ul>
</li>
<li><code>Promise.reject(reason)</code> è§„åˆ™ï¼š
<ul>
<li>æ— è®º reason æ˜¯æ™®é€šå€¼ã€Error å¯¹è±¡ã€ç”šè‡³ Promise å¯¹è±¡ï¼Œéƒ½ä¼šç›´æ¥ä½œä¸ºã€Œå¤±è´¥ç†ç”±ã€ï¼Œè¿”å› rejected çŠ¶æ€çš„ Promiseï¼›</li>
<li>æ¨èä¼ å…¥ <code>Error</code> å¯¹è±¡ï¼ˆè€Œéå­—ç¬¦ä¸²ï¼‰ï¼Œä¾¿äºè°ƒè¯•ï¼ˆåŒ…å«é”™è¯¯å †æ ˆï¼‰ã€‚</li>
</ul>
</li>
<li><code>Promise.resolve/reject</code> çš„æ ¸å¿ƒä»·å€¼ï¼šç®€åŒ– Promise åˆ›å»ºä»£ç ï¼Œç»Ÿä¸€å¼‚æ­¥å€¼çš„å¤„ç†é€»è¾‘ï¼ˆå°¤å…¶æ˜¯ resolve å¯¹ thenable çš„å…¼å®¹ï¼‰ã€‚</li>
</ol>
<h2 data-id="heading-55">ä¸ºä»€ä¹ˆ Promise çš„é€’å½’è°ƒç”¨ä¼šå¯¼è‡´æµè§ˆå™¨å¡æ­»ï¼Œè€Œ setTimeout çš„é€’å½’è°ƒç”¨é€šå¸¸ä¸ä¼šï¼Ÿ</h2>
<h4 data-id="heading-56">å…ˆçœ‹ç›´è§‚å¯¹æ¯”ï¼ˆä»£ç +ç°è±¡ï¼‰</h4>
<p>å…ˆè·‘ä¸¤æ®µä»£ç ï¼Œç›´è§‚æ„Ÿå—å·®å¼‚ï¼š</p>
<h5 data-id="heading-57">ç¤ºä¾‹1ï¼šPromise é€’å½’ï¼ˆå¡æ­»æµè§ˆå™¨ï¼‰</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Promise é€’å½’ï¼šåŒæ­¥å ç”¨ä¸»çº¿ç¨‹ï¼Œæ— å–˜æ¯æœºä¼š</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">promiseRecursion</span>(<span class="hljs-params"/>) {
  <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Promise é€’å½’æ‰§è¡Œ"</span>);
    <span class="hljs-title function_">promiseRecursion</span>(); <span class="hljs-comment">// é€’å½’è°ƒç”¨</span>
  });
}
<span class="hljs-title function_">promiseRecursion</span>();
</code></pre>
<p><strong>ç°è±¡</strong>ï¼šæµè§ˆå™¨æ ‡ç­¾é¡µå¡é¡¿ã€æ— å“åº”ï¼Œæ§åˆ¶å°ç–¯ç‹‚è¾“å‡ºï¼Œä½†é¡µé¢æ— æ³•äº¤äº’ï¼Œç”šè‡³ä¼šè§¦å‘ã€Œé¡µé¢æ— å“åº”ã€æç¤ºã€‚</p>
<h5 data-id="heading-58">ç¤ºä¾‹2ï¼šsetTimeout é€’å½’ï¼ˆä¸å¡æ­»ï¼‰</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// setTimeout é€’å½’ï¼šæ¯æ¬¡æ‰§è¡Œåé‡Šæ”¾ä¸»çº¿ç¨‹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">timeoutRecursion</span>(<span class="hljs-params"/>) {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"setTimeout é€’å½’æ‰§è¡Œ"</span>);
    <span class="hljs-title function_">timeoutRecursion</span>(); <span class="hljs-comment">// é€’å½’è°ƒç”¨</span>
  }, <span class="hljs-number">0</span>);
}
<span class="hljs-title function_">timeoutRecursion</span>();
</code></pre>
<p><strong>ç°è±¡</strong>ï¼šæ§åˆ¶å°æŒç»­è¾“å‡ºï¼Œä½†é¡µé¢ä»èƒ½ç‚¹å‡»ã€æ»šåŠ¨ï¼Œæµè§ˆå™¨å®Œå…¨ä¸å¡é¡¿ã€‚</p>
<h4 data-id="heading-59">æ ¸å¿ƒåŸå› æ‹†è§£ï¼ˆäº‹ä»¶å¾ªç¯+è°ƒç”¨æ ˆï¼‰</h4>
<p>æµè§ˆå™¨çš„ä¸»çº¿ç¨‹æ˜¯ã€Œå•çº¿ç¨‹ã€ï¼Œæ‰€æœ‰ JS æ‰§è¡Œã€DOM æ¸²æŸ“ã€äº‹ä»¶å“åº”éƒ½åœ¨è¿™ä¸€ä¸ªçº¿ç¨‹é‡Œï¼Œèƒ½å¦ã€Œé‡Šæ”¾ä¸»çº¿ç¨‹ã€æ˜¯æ˜¯å¦å¡æ­»çš„å…³é”®ï¼š</p>
<h5 data-id="heading-60">1. Promise é€’å½’ï¼šå¾®ä»»åŠ¡ã€ŒæŠ¢å å¼ã€æ‰§è¡Œï¼Œè°ƒç”¨æ ˆæ°¸ä¸æ¸…ç©º</h5>
<ul>
<li><strong>Promise.then çš„å›è°ƒå±äºã€Œå¾®ä»»åŠ¡ã€</strong>ï¼šå¾®ä»»åŠ¡çš„æ‰§è¡Œè§„åˆ™æ˜¯ã€Œå½“å‰å®ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œç«‹å³æ¸…ç©ºæ‰€æœ‰å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå†æ‰§è¡Œä¸‹ä¸€ä¸ªå®ä»»åŠ¡/æ¸²æŸ“/äº‹ä»¶ã€ã€‚</li>
<li><strong>é€’å½’é€»è¾‘</strong>ï¼š
<ol>
<li>ç¬¬ä¸€æ¬¡è°ƒç”¨ <code>promiseRecursion()</code>ï¼Œ<code>Promise.resolve()</code> ç”Ÿæˆå¾®ä»»åŠ¡ Aï¼›</li>
<li>å½“å‰å®ä»»åŠ¡æ‰§è¡Œå®Œï¼Œæ‰§è¡Œå¾®ä»»åŠ¡ A â†’ æ‰“å°æ—¥å¿—ï¼Œè°ƒç”¨ <code>promiseRecursion()</code> â†’ ç”Ÿæˆå¾®ä»»åŠ¡ Bï¼›</li>
<li>å¾®ä»»åŠ¡ A æ‰§è¡Œå®Œï¼Œç«‹å³æ‰§è¡Œå¾®ä»»åŠ¡ B â†’ æ‰“å°æ—¥å¿—ï¼Œç”Ÿæˆå¾®ä»»åŠ¡ Cï¼›</li>
<li>è¿™ä¸ªè¿‡ç¨‹<strong>æ— é™å¾ªç¯</strong>ï¼Œå¾®ä»»åŠ¡é˜Ÿåˆ—æ°¸è¿œæœ‰æ–°ä»»åŠ¡ï¼Œä¸»çº¿ç¨‹è¢«å¾®ä»»åŠ¡ã€Œå æ»¡ã€ï¼Œæ²¡æœ‰ä»»ä½•æ—¶é—´ç‰‡åˆ†é…ç»™ï¼š
<ul>
<li>DOM æ¸²æŸ“ï¼ˆé¡µé¢å¡æ­»ï¼‰ï¼›</li>
<li>é¼ æ ‡ç‚¹å‡»/æ»šåŠ¨ç­‰äº‹ä»¶å“åº”ï¼ˆäº¤äº’å¤±æ•ˆï¼‰ï¼›</li>
<li>å…¶ä»–å®ä»»åŠ¡ï¼ˆæ¯”å¦‚ setTimeoutã€ç½‘ç»œè¯·æ±‚ï¼‰ã€‚</li>
</ul>
</li>
</ol>
</li>
<li><strong>è°ƒç”¨æ ˆè§’åº¦</strong>ï¼šè™½ç„¶æ¯æ¬¡ then å›è°ƒæ‰§è¡Œå®Œä¼šæ¸…ç©ºå½“å‰è°ƒç”¨æ ˆï¼Œä½†å¾®ä»»åŠ¡çš„ã€Œè¿ç»­æ‰§è¡Œã€è®©ä¸»çº¿ç¨‹æ²¡æœ‰ã€Œç©ºé—²æœŸã€ï¼Œæœ¬è´¨æ˜¯ã€Œæ— é™çš„åŒæ­¥æ‰§è¡Œæµã€ã€‚</li>
</ul>
<h5 data-id="heading-61">2. setTimeout é€’å½’ï¼šå®ä»»åŠ¡ã€Œæ’é˜Ÿå¼ã€æ‰§è¡Œï¼Œæ¯æ¬¡é‡Šæ”¾ä¸»çº¿ç¨‹</h5>
<ul>
<li><strong>setTimeout çš„å›è°ƒå±äºã€Œå®ä»»åŠ¡ã€</strong>ï¼šå®ä»»åŠ¡çš„æ‰§è¡Œè§„åˆ™æ˜¯ã€Œæ‰§è¡Œå®Œä¸€ä¸ªå®ä»»åŠ¡åï¼Œå…ˆæ‰§è¡Œæ‰€æœ‰å¾®ä»»åŠ¡ï¼Œå†å¤„ç†æ¸²æŸ“ï¼Œå†å–ä¸‹ä¸€ä¸ªå®ä»»åŠ¡ã€ã€‚</li>
<li><strong>é€’å½’é€»è¾‘</strong>ï¼š
<ol>
<li>ç¬¬ä¸€æ¬¡è°ƒç”¨ <code>timeoutRecursion()</code>ï¼Œ<code>setTimeout</code> æŠŠå›è°ƒ A åŠ å…¥ã€Œå®ä»»åŠ¡é˜Ÿåˆ—ã€ï¼›</li>
<li>å½“å‰å®ä»»åŠ¡æ‰§è¡Œå®Œï¼Œæ‰§è¡Œå¾®ä»»åŠ¡ â†’ æ¸²æŸ“é¡µé¢ â†’ å¤„ç†äº‹ä»¶ï¼ˆç‚¹å‡»/æ»šåŠ¨ï¼‰â†’ å†æ‰§è¡Œå®ä»»åŠ¡ Aï¼›</li>
<li>å®ä»»åŠ¡ A æ‰§è¡Œï¼šæ‰“å°æ—¥å¿—ï¼Œè°ƒç”¨ <code>timeoutRecursion()</code> â†’ æŠŠå›è°ƒ B åŠ å…¥å®ä»»åŠ¡é˜Ÿåˆ—ï¼›</li>
<li>å®ä»»åŠ¡ A æ‰§è¡Œå®Œï¼Œä¸»çº¿ç¨‹ä¼šã€Œé‡Šæ”¾ã€ï¼Œå…ˆå¤„ç†æ¸²æŸ“ã€äº‹ä»¶å“åº”ï¼Œå†æ‰§è¡Œä¸‹ä¸€ä¸ªå®ä»»åŠ¡ Bï¼›</li>
<li>è¿™ä¸ªè¿‡ç¨‹è™½ç„¶æ— é™ï¼Œä½†<strong>æ¯æ¬¡å®ä»»åŠ¡æ‰§è¡Œå®Œéƒ½ä¼šç»™ä¸»çº¿ç¨‹å–˜æ¯æœºä¼š</strong>ï¼Œé¡µé¢æ¸²æŸ“ã€äº‹ä»¶å“åº”èƒ½æ­£å¸¸è¿›è¡Œï¼Œå› æ­¤ä¸ä¼šå¡æ­»ã€‚</li>
</ol>
</li>
</ul>
<h4 data-id="heading-62">è¡¥å……ï¼šä¸ºä»€ä¹ˆ Promise å¾®ä»»åŠ¡è¦ã€Œç«‹å³æ‰§è¡Œã€ï¼Ÿ</h4>
<p>å¾®ä»»åŠ¡çš„è®¾è®¡åˆè¡·æ˜¯ã€Œå¤„ç†å¼‚æ­¥ä½†éœ€è¦å°½å¿«å®Œæˆçš„é€»è¾‘ã€ï¼ˆæ¯”å¦‚ Promise å›è°ƒã€async/awaitï¼‰ï¼Œä¼˜å…ˆçº§é«˜äºå®ä»»åŠ¡å’Œæ¸²æŸ“ï¼Œè¿™ä¿è¯äº†å¼‚æ­¥é€»è¾‘çš„æ‰§è¡Œé¡ºåºï¼Œä½†æ— é™é€’å½’çš„å¾®ä»»åŠ¡ä¼šæ»¥ç”¨è¿™ä¸ªä¼˜å…ˆçº§ï¼Œå¯¼è‡´ä¸»çº¿ç¨‹é˜»å¡ã€‚</p>
<h4 data-id="heading-63">æ€»ç»“</h4>
<ol>
<li><strong>æ ¸å¿ƒå·®å¼‚</strong>ï¼šPromise é€’å½’æ˜¯ã€Œå¾®ä»»åŠ¡æ— é™è¿ç»­æ‰§è¡Œã€ï¼Œä¸»çº¿ç¨‹æ— å–˜æ¯æœºä¼šï¼›setTimeout é€’å½’æ˜¯ã€Œå®ä»»åŠ¡æ’é˜Ÿæ‰§è¡Œã€ï¼Œæ¯æ¬¡æ‰§è¡Œåé‡Šæ”¾ä¸»çº¿ç¨‹ï¼Œå…è®¸æ¸²æŸ“/äº‹ä»¶å“åº”ã€‚</li>
<li><strong>è°ƒç”¨æ ˆ/é˜Ÿåˆ—</strong>ï¼šPromise é€’å½’è®©å¾®ä»»åŠ¡é˜Ÿåˆ—æ°¸è¿œéç©ºï¼Œä¸»çº¿ç¨‹è¢«å æ»¡ï¼›setTimeout é€’å½’çš„å®ä»»åŠ¡é˜Ÿåˆ—è™½æœ‰ä»»åŠ¡ï¼Œä½†æ¯æ¬¡æ‰§è¡Œå®Œä¼šå¤„ç†æ¸²æŸ“å’Œäº‹ä»¶ã€‚</li>
<li><strong>æœ¬è´¨</strong>ï¼šæµè§ˆå™¨å¡æ­»çš„æ ¸å¿ƒæ˜¯ã€Œä¸»çº¿ç¨‹æ— æ³•å¤„ç†æ¸²æŸ“/äº¤äº’ã€ï¼Œè€Œéã€Œé€’å½’æœ¬èº«ã€â€”â€”setTimeout é€’å½’ç»™äº†ä¸»çº¿ç¨‹å¤„ç†è¿™äº›çš„æ—¶é—´ï¼Œè€Œ Promise é€’å½’æ²¡æœ‰ã€‚</li>
</ol>
<p>å¦‚æœæƒ³è®© Promise é€’å½’ä¸å¡æ­»ï¼Œå¯åœ¨é€’å½’ä¸­åŠ å…¥ <code>setTimeout</code> ã€Œè®©å‡ºä¸»çº¿ç¨‹ã€ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ”¹è¿›ç‰ˆ Promise é€’å½’ï¼šä¸å¡æ­»</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">promiseRecursion</span>(<span class="hljs-params"/>) {
  <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Promise é€’å½’æ‰§è¡Œ"</span>);
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">promiseRecursion</span>(), <span class="hljs-number">0</span>); <span class="hljs-comment">// ç”¨setTimeoutè®©å‡ºä¸»çº¿ç¨‹</span>
  });
}
<span class="hljs-title function_">promiseRecursion</span>();
</code></pre>
<h2 data-id="heading-64">Promise çš„ <code>then</code> æ–¹æ³•çš„æ ¸å¿ƒå®ç°</h2>
<h4 data-id="heading-65">å…ˆæ˜ç¡® then æ–¹æ³•çš„æ ¸å¿ƒéœ€æ±‚</h4>
<ol>
<li><code>then</code> æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š<code>onFulfilled</code>ï¼ˆæˆåŠŸå›è°ƒï¼‰ã€<code>onRejected</code>ï¼ˆå¤±è´¥å›è°ƒï¼‰ï¼›</li>
<li>å›è°ƒéœ€å¼‚æ­¥æ‰§è¡Œï¼ˆå¾®ä»»åŠ¡ï¼Œè¿™é‡Œç”¨ <code>setTimeout</code> æ¨¡æ‹Ÿï¼‰ï¼›</li>
<li>è‹¥ Promise çŠ¶æ€æœªç¡®å®šï¼ˆpendingï¼‰ï¼Œéœ€å…ˆå­˜å‚¨å›è°ƒï¼›è‹¥å·²ç¡®å®šï¼Œç›´æ¥æ‰§è¡Œå›è°ƒï¼›</li>
<li><code>then</code> å¿…é¡»è¿”å›æ–°çš„ Promiseï¼Œå®ç°é“¾å¼è°ƒç”¨ï¼›</li>
<li>ä¸Šä¸€ä¸ª <code>then</code> çš„å›è°ƒè¿”å›å€¼ï¼Œå†³å®šæ–° Promise çš„çŠ¶æ€ã€‚</li>
</ol>
<h4 data-id="heading-66">æç®€ç‰ˆ Promise + then å®ç°</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨¡æ‹Ÿ Promise çš„æ ¸å¿ƒå®ç°ï¼ˆä»…ä¿ç•™ then æ–¹æ³•çš„æ ¸å¿ƒé€»è¾‘ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyPromise</span> {
  <span class="hljs-comment">// å®šä¹‰ä¸‰ç§çŠ¶æ€</span>
  <span class="hljs-keyword">static</span> <span class="hljs-variable constant_">PENDING</span> = <span class="hljs-string">'pending'</span>;
  <span class="hljs-keyword">static</span> <span class="hljs-variable constant_">FULFILLED</span> = <span class="hljs-string">'fulfilled'</span>;
  <span class="hljs-keyword">static</span> <span class="hljs-variable constant_">REJECTED</span> = <span class="hljs-string">'rejected'</span>;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">executor</span>) {
    <span class="hljs-comment">// åˆå§‹çŠ¶æ€</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-title class_">MyPromise</span>.<span class="hljs-property">PENDING</span>;
    <span class="hljs-comment">// æˆåŠŸç»“æœ</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-literal">undefined</span>;
    <span class="hljs-comment">// å¤±è´¥åŸå› </span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = <span class="hljs-literal">undefined</span>;
    <span class="hljs-comment">// å­˜å‚¨ pending çŠ¶æ€æ—¶çš„å›è°ƒï¼ˆå› ä¸ºæ­¤æ—¶çŠ¶æ€æœªç¡®å®šï¼Œéœ€ç­‰å¾…ï¼‰</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledCallbacks</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedCallbacks</span> = [];

    <span class="hljs-comment">// resolve å‡½æ•°ï¼šä¿®æ”¹çŠ¶æ€ä¸ºæˆåŠŸï¼Œæ‰§è¡Œå­˜å‚¨çš„æˆåŠŸå›è°ƒ</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">resolve</span> = (<span class="hljs-params">value</span>) =&gt; {
      <span class="hljs-comment">// çŠ¶æ€ä¸å¯é€†ï¼šåªæœ‰ pending æ—¶æ‰èƒ½ä¿®æ”¹</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-title class_">MyPromise</span>.<span class="hljs-property">PENDING</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-title class_">MyPromise</span>.<span class="hljs-property">FULFILLED</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;
        <span class="hljs-comment">// æ‰§è¡Œæ‰€æœ‰å­˜å‚¨çš„æˆåŠŸå›è°ƒ</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledCallbacks</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">callback</span> =&gt;</span> <span class="hljs-title function_">callback</span>());
      }
    };

    <span class="hljs-comment">// reject å‡½æ•°ï¼šä¿®æ”¹çŠ¶æ€ä¸ºå¤±è´¥ï¼Œæ‰§è¡Œå­˜å‚¨çš„å¤±è´¥å›è°ƒ</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">reject</span> = (<span class="hljs-params">reason</span>) =&gt; {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-title class_">MyPromise</span>.<span class="hljs-property">PENDING</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-title class_">MyPromise</span>.<span class="hljs-property">REJECTED</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span> = reason;
        <span class="hljs-comment">// æ‰§è¡Œæ‰€æœ‰å­˜å‚¨çš„å¤±è´¥å›è°ƒ</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedCallbacks</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">callback</span> =&gt;</span> <span class="hljs-title function_">callback</span>());
      }
    };

    <span class="hljs-comment">// æ‰§è¡Œå™¨å‡½æ•°åŒæ­¥æ‰§è¡Œï¼Œæ•è·æ‰§è¡Œè¿‡ç¨‹ä¸­çš„å¼‚å¸¸</span>
    <span class="hljs-keyword">try</span> {
      <span class="hljs-title function_">executor</span>(resolve, reject);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-title function_">reject</span>(error);
    }
  }

  <span class="hljs-comment">// æ ¸å¿ƒï¼šå®ç° then æ–¹æ³•</span>
  <span class="hljs-title function_">then</span>(<span class="hljs-params">onFulfilled, onRejected</span>) {
    <span class="hljs-comment">// å…¼å®¹ï¼šå¦‚æœæ²¡ä¼ å›è°ƒï¼Œé€ä¼ ç»“æœï¼ˆæ¯”å¦‚ then().then() çš„åœºæ™¯ï¼‰</span>
    onFulfilled = <span class="hljs-keyword">typeof</span> onFulfilled === <span class="hljs-string">'function'</span> ? onFulfilled : <span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> value;
    onRejected = <span class="hljs-keyword">typeof</span> onRejected === <span class="hljs-string">'function'</span> ? onRejected : <span class="hljs-function"><span class="hljs-params">reason</span> =&gt;</span> { <span class="hljs-keyword">throw</span> reason; };

    <span class="hljs-comment">// å…³é”®ï¼šthen è¿”å›æ–°çš„ Promiseï¼Œå®ç°é“¾å¼è°ƒç”¨</span>
    <span class="hljs-keyword">const</span> newPromise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-comment">// å°è£…å›è°ƒæ‰§è¡Œé€»è¾‘ï¼ˆå¤ç”¨ä»£ç ï¼‰</span>
      <span class="hljs-keyword">const</span> <span class="hljs-title function_">executeCallback</span> = (<span class="hljs-params">callback, data</span>) =&gt; {
        <span class="hljs-comment">// å¼‚æ­¥æ‰§è¡Œå›è°ƒï¼ˆç”¨ setTimeout æ¨¡æ‹Ÿå¾®ä»»åŠ¡ï¼‰</span>
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// æ‰§è¡Œå›è°ƒï¼Œè·å–è¿”å›å€¼</span>
            <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">callback</span>(data);
            <span class="hljs-comment">// æ ¸å¿ƒè§„åˆ™ï¼šå›è°ƒè¿”å›å€¼å†³å®šæ–° Promise çš„çŠ¶æ€</span>
            <span class="hljs-title function_">resolvePromise</span>(newPromise, result, resolve, reject);
          } <span class="hljs-keyword">catch</span> (error) {
            <span class="hljs-comment">// å›è°ƒæ‰§è¡Œå‡ºé”™ï¼Œæ–° Promise çŠ¶æ€ä¸ºå¤±è´¥</span>
            <span class="hljs-title function_">reject</span>(error);
          }
        }, <span class="hljs-number">0</span>);
      };

      <span class="hljs-comment">// 1. å¦‚æœå½“å‰ Promise å·²æˆåŠŸ</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-title class_">MyPromise</span>.<span class="hljs-property">FULFILLED</span>) {
        <span class="hljs-title function_">executeCallback</span>(onFulfilled, <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);
      }

      <span class="hljs-comment">// 2. å¦‚æœå½“å‰ Promise å·²å¤±è´¥</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-title class_">MyPromise</span>.<span class="hljs-property">REJECTED</span>) {
        <span class="hljs-title function_">executeCallback</span>(onRejected, <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>);
      }

      <span class="hljs-comment">// 3. å¦‚æœå½“å‰ Promise è¿˜æ˜¯ pendingï¼ˆçŠ¶æ€æœªç¡®å®šï¼‰ï¼Œå­˜å‚¨å›è°ƒ</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-title class_">MyPromise</span>.<span class="hljs-property">PENDING</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledCallbacks</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-title function_">executeCallback</span>(onFulfilled, <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);
        });
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">onRejectedCallbacks</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-title function_">executeCallback</span>(onRejected, <span class="hljs-variable language_">this</span>.<span class="hljs-property">reason</span>);
        });
      }
    });

    <span class="hljs-keyword">return</span> newPromise;
  }
}

<span class="hljs-comment">// è¾…åŠ©å‡½æ•°ï¼šå¤„ç† then å›è°ƒçš„è¿”å›å€¼ï¼Œå†³å®šæ–° Promise çš„çŠ¶æ€</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">resolvePromise</span>(<span class="hljs-params">newPromise, result, resolve, reject</span>) {
  <span class="hljs-comment">// é¿å…å¾ªç¯å¼•ç”¨ï¼ˆæ¯”å¦‚å›è°ƒè¿”å› newPromise æœ¬èº«ï¼‰</span>
  <span class="hljs-keyword">if</span> (result === newPromise) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">'Chaining cycle detected for promise'</span>));
  }

  <span class="hljs-comment">// 1. å¦‚æœè¿”å›å€¼æ˜¯ Promise å®ä¾‹</span>
  <span class="hljs-keyword">if</span> (result <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">MyPromise</span>) {
    <span class="hljs-comment">// ç­‰å¾…è¯¥ Promise å®Œæˆï¼Œå†å†³å®šæ–° Promise çš„çŠ¶æ€</span>
    result.<span class="hljs-title function_">then</span>(resolve, reject);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// 2. å¦‚æœè¿”å›å€¼æ˜¯æ™®é€šå€¼ï¼Œç›´æ¥ resolve æ–° Promise</span>
    <span class="hljs-title function_">resolve</span>(result);
  }
}
</code></pre>
<h4 data-id="heading-67">æ ¸å¿ƒé€»è¾‘æ‹†è§£ï¼ˆé‡ç‚¹ç†è§£ï¼‰</h4>
<h5 data-id="heading-68">1. çŠ¶æ€ç®¡ç†</h5>
<ul>
<li>åˆå§‹çŠ¶æ€ä¸º <code>pending</code>ï¼Œåªæœ‰è°ƒç”¨ <code>resolve</code>/<code>reject</code> ä¸”çŠ¶æ€ä¸º <code>pending</code> æ—¶ï¼Œæ‰èƒ½ä¿®æ”¹çŠ¶æ€ï¼›</li>
<li>çŠ¶æ€ä¸å¯é€†ï¼Œä¸€æ—¦å˜ä¸º <code>fulfilled</code>/<code>rejected</code>ï¼Œæ— æ³•å†æ”¹ã€‚</li>
</ul>
<h5 data-id="heading-69">2. å›è°ƒå­˜å‚¨ï¼ˆpending çŠ¶æ€ï¼‰</h5>
<ul>
<li>å¦‚æœè°ƒç”¨ <code>then</code> æ—¶ï¼ŒPromise è¿˜å¤„äº <code>pending</code>ï¼ˆæ¯”å¦‚å¼‚æ­¥ä»»åŠ¡æ²¡å®Œæˆï¼‰ï¼Œä¼šæŠŠå›è°ƒå­˜å‚¨åˆ°æ•°ç»„ä¸­ï¼›</li>
<li>ç­‰çŠ¶æ€ç¡®å®šåï¼ˆè°ƒç”¨ <code>resolve</code>/<code>reject</code>ï¼‰ï¼Œéå†æ‰§è¡Œå­˜å‚¨çš„å›è°ƒã€‚</li>
</ul>
<h5 data-id="heading-70">3. å¼‚æ­¥æ‰§è¡Œå›è°ƒ</h5>
<ul>
<li>ç”¨ <code>setTimeout</code> æ¨¡æ‹Ÿå¾®ä»»åŠ¡ï¼ˆçœŸå® Promise æ˜¯å¾®ä»»åŠ¡ï¼Œä¼˜å…ˆçº§æ¯”å®ä»»åŠ¡é«˜ï¼Œè¿™é‡Œç®€åŒ–ï¼‰ï¼›</li>
<li>ç¡®ä¿å›è°ƒä¸ä¼šåŒæ­¥æ‰§è¡Œï¼Œç¬¦åˆ Promise è§„èŒƒã€‚</li>
</ul>
<h5 data-id="heading-71">4. é“¾å¼è°ƒç”¨çš„æ ¸å¿ƒï¼ˆè¿”å›æ–° Promiseï¼‰</h5>
<ul>
<li><code>then</code> å¿…é¡»è¿”å›æ–°çš„ <code>MyPromise</code>ï¼Œè€Œé <code>this</code>ï¼›</li>
<li>å›è°ƒçš„è¿”å›å€¼é€šè¿‡ <code>resolvePromise</code> å¤„ç†ï¼š
<ul>
<li>è¿”å›æ™®é€šå€¼ â†’ æ–° Promise çŠ¶æ€ä¸º <code>fulfilled</code>ï¼›</li>
<li>è¿”å› Promise å®ä¾‹ â†’ ç­‰å¾…è¯¥å®ä¾‹å®Œæˆï¼Œç»§æ‰¿å…¶çŠ¶æ€ï¼›</li>
<li>å›è°ƒæŠ›å‡ºå¼‚å¸¸ â†’ æ–° Promise çŠ¶æ€ä¸º <code>rejected</code>ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-72">æµ‹è¯•ä»£ç ï¼ˆéªŒè¯ then åŠŸèƒ½ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æµ‹è¯•1ï¼šåŸºç¡€ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-number">100</span>), <span class="hljs-number">1000</span>);
});

p1.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬ä¸€æ¬¡thenï¼š'</span>, res); <span class="hljs-comment">// 1såè¾“å‡ºï¼šç¬¬ä¸€æ¬¡thenï¼š100</span>
  <span class="hljs-keyword">return</span> res + <span class="hljs-number">10</span>; <span class="hljs-comment">// è¿”å›æ™®é€šå€¼</span>
}).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬äºŒæ¬¡thenï¼š'</span>, res); <span class="hljs-comment">// è¾“å‡ºï¼šç¬¬äºŒæ¬¡thenï¼š110</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyPromise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-title function_">resolve</span>(res + <span class="hljs-number">10</span>)); <span class="hljs-comment">// è¿”å›Promise</span>
}).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬ä¸‰æ¬¡thenï¼š'</span>, res); <span class="hljs-comment">// è¾“å‡ºï¼šç¬¬ä¸‰æ¬¡thenï¼š120</span>
});

<span class="hljs-comment">// æµ‹è¯•2ï¼šå¤±è´¥åœºæ™¯</span>
<span class="hljs-keyword">const</span> p2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyPromise</span>(<span class="hljs-function">(<span class="hljs-params">_, reject</span>) =&gt;</span> {
  <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'å¤±è´¥äº†'</span>));
});

p2.<span class="hljs-title function_">then</span>(
  <span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res),
  <span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¤±è´¥å›è°ƒï¼š'</span>, err.<span class="hljs-property">message</span>); <span class="hljs-comment">// è¾“å‡ºï¼šå¤±è´¥å›è°ƒï¼šå¤±è´¥äº†</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'å›è°ƒé‡ŒæŠ›é”™'</span>);
  }
).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> { <span class="hljs-comment">// æ³¨ï¼šcatch æœ¬è´¨æ˜¯ then(undefined, onRejected)ï¼Œå¯è‡ªè¡Œè¡¥å……å®ç°</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•è·å›è°ƒé”™è¯¯ï¼š'</span>, err.<span class="hljs-property">message</span>); <span class="hljs-comment">// è¾“å‡ºï¼šæ•è·å›è°ƒé”™è¯¯ï¼šå›è°ƒé‡ŒæŠ›é”™</span>
});
</code></pre>
<h4 data-id="heading-73">è¡¥å……ï¼šcatch æ–¹æ³•ï¼ˆå¯é€‰ï¼‰</h4>
<p>å¦‚æœæƒ³è¡¥å…… <code>catch</code> æ–¹æ³•ï¼Œåªéœ€åœ¨ <code>MyPromise</code> ä¸­åŠ ä¸€è¡Œï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">catch</span>(onRejected) {
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">then</span>(<span class="hljs-literal">undefined</span>, onRejected);
}
</code></pre>
<h4 data-id="heading-74">æ€»ç»“</h4>
<ol>
<li><code>then</code> æ–¹æ³•çš„æ ¸å¿ƒæ˜¯ã€ŒçŠ¶æ€åˆ¤æ–­ + å›è°ƒå­˜å‚¨/æ‰§è¡Œ + è¿”å›æ–° Promiseã€ï¼›</li>
<li>å¼‚æ­¥æ‰§è¡Œå›è°ƒã€çŠ¶æ€ä¸å¯é€†ã€é“¾å¼è°ƒç”¨ï¼ˆè¿”å›æ–° Promiseï¼‰æ˜¯ <code>then</code> çš„ä¸‰å¤§å…³é”®ç‰¹æ€§ï¼›</li>
<li>è¿™ä¸ªæç®€å®ç°å»æ‰äº†å¤æ‚çš„è¾¹ç•Œå¤„ç†ï¼ˆå¦‚ thenable å¯¹è±¡ã€å¤šæ¬¡è°ƒç”¨ then ç­‰ï¼‰ï¼Œä½†ä¿ç•™äº† <code>then</code> æœ€æ ¸å¿ƒçš„é€»è¾‘ï¼Œèƒ½å¸®ä½ ç†è§£åŸç”Ÿ Promise çš„ <code>then</code> æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</li>
</ol>
<h2 data-id="heading-75">Promise è®¾è®¡æ¨¡å¼</h2>
<p>Promise çš„å®ç°å¹¶éå•ä¸€è®¾è®¡æ¨¡å¼ï¼Œè€Œæ˜¯<strong>å¤šä¸ªæ¨¡å¼çš„ç»„åˆ</strong>ï¼Œæ¯ä¸ªæ¨¡å¼è§£å†³ä¸€ä¸ªæ ¸å¿ƒé—®é¢˜ï¼Œå…ˆçœ‹å…³é”®æ¨¡å¼åŠå¯¹åº”ä½œç”¨ï¼š</p>






























<table><thead><tr><th>è®¾è®¡æ¨¡å¼</th><th>æ ¸å¿ƒä½œç”¨ï¼ˆPromise ä¸­çš„ä½“ç°ï¼‰</th><th>å¯¹åº”å®ç°ä»£ç ï¼ˆæç®€ç‰ˆ MyPromiseï¼‰</th></tr></thead><tbody><tr><td><strong>çŠ¶æ€æ¨¡å¼</strong></td><td>ç®¡ç† Promise çš„ä¸‰ç§çŠ¶æ€ï¼ˆpending/fulfilled/rejectedï¼‰ï¼Œä¸”çŠ¶æ€ä¸å¯é€†</td><td>1. å®šä¹‰ <code>status</code> å±æ€§ï¼Œåˆå§‹ä¸º pendingï¼›<br/>2. <code>resolve/reject</code> ä»…åœ¨ pending æ—¶ä¿®æ”¹çŠ¶æ€ï¼›<br/>3. <code>then</code> æ–¹æ³•æ ¹æ®ä¸åŒçŠ¶æ€æ‰§è¡Œä¸åŒé€»è¾‘ï¼ˆå­˜å‚¨å›è°ƒ/ç›´æ¥æ‰§è¡Œï¼‰ã€‚</td></tr><tr><td><strong>è§‚å¯Ÿè€…æ¨¡å¼</strong></td><td>è§£å†³ã€ŒçŠ¶æ€å˜æ›´åé€šçŸ¥æ‰€æœ‰å›è°ƒã€çš„é—®é¢˜ï¼ˆæ¯”å¦‚ pending æ—¶å¤šæ¬¡è°ƒç”¨ thenï¼ŒçŠ¶æ€ç¡®å®šåå…¨éƒ¨æ‰§è¡Œï¼‰</td><td>1. å®šä¹‰ <code>onFulfilledCallbacks</code>/<code>onRejectedCallbacks</code> æ•°ç»„ï¼ˆå­˜å‚¨è§‚å¯Ÿè€…ï¼‰ï¼›<br/>2. çŠ¶æ€å˜æ›´æ—¶ï¼ˆresolve/rejectï¼‰ï¼Œéå†æ‰§è¡Œæ•°ç»„ä¸­çš„å›è°ƒï¼ˆé€šçŸ¥è§‚å¯Ÿè€…ï¼‰ã€‚</td></tr><tr><td><strong>å·¥å‚æ¨¡å¼</strong></td><td><code>then</code> æ–¹æ³•è¿”å›æ–°çš„ Promise å®ä¾‹ï¼ˆæ— éœ€æ‰‹åŠ¨ newï¼Œç”± then å†…éƒ¨åˆ›å»ºï¼‰ï¼Œå®ç°é“¾å¼è°ƒç”¨</td><td>1. <code>then</code> å†…éƒ¨åˆ›å»º <code>newPromise</code> å¹¶è¿”å›ï¼›<br/>2. <code>resolvePromise</code> è¾…åŠ©å‡½æ•°æ ¹æ®å›è°ƒè¿”å›å€¼ã€Œç”Ÿäº§ã€æ–° Promise çš„çŠ¶æ€ã€‚</td></tr><tr><td><strong>ç­–ç•¥æ¨¡å¼</strong></td><td>å…è®¸åŠ¨æ€ä¼ å…¥ä¸åŒçš„å›è°ƒç­–ç•¥ï¼ˆonFulfilled/onRejectedï¼‰ï¼ŒçŠ¶æ€å˜æ›´æ—¶æ‰§è¡Œå¯¹åº”ç­–ç•¥</td><td>1. <code>then</code> æ¥æ”¶ä¸¤ä¸ªå›è°ƒå‚æ•°ï¼ˆä¸åŒçš„å¤„ç†ç­–ç•¥ï¼‰ï¼›<br/>2. æˆåŠŸæ—¶æ‰§è¡Œ onFulfilledï¼Œå¤±è´¥æ—¶æ‰§è¡Œ onRejectedã€‚</td></tr></tbody></table>
<h2 data-id="heading-76">å¾®ä»»åŠ¡å°è¿·æ€ï¼š<code>then</code> é‡Œã€Œpush å›è°ƒåˆ°æ•°ç»„ã€å’Œã€Œæ¨åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ã€æ˜¯ä¸€å›äº‹å—</h2>
<h4 data-id="heading-77">å…ˆç»™æ ¸å¿ƒç»“è®º</h4>
<ul>
<li><strong>push å›è°ƒåˆ°æ•°ç»„</strong>ï¼šè§£å†³ã€ŒPromise è¿˜åœ¨ pending çŠ¶æ€æ—¶ï¼Œå›è°ƒè¯¥å­˜å“ªã€çš„é—®é¢˜ï¼ˆå­˜å‚¨é€»è¾‘ï¼‰ï¼›</li>
<li><strong>æ¨åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—</strong>ï¼šè§£å†³ã€Œå›è°ƒè¯¥ä»€ä¹ˆæ—¶å€™æ‰§è¡Œã€çš„é—®é¢˜ï¼ˆæ‰§è¡Œæ—¶æœºé€»è¾‘ï¼‰ï¼›</li>
<li>äºŒè€…å…³ç³»ï¼š<code>push</code> æ˜¯ã€Œä¿å­˜å›è°ƒã€ï¼Œå¾®ä»»åŠ¡é˜Ÿåˆ—æ˜¯ã€Œè°ƒåº¦æ‰§è¡Œã€â€”â€” å…ˆä¿å­˜ï¼Œå†åœ¨åˆé€‚çš„æ—¶æœºä¸¢åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—æ‰§è¡Œã€‚</li>
</ul>
<h4 data-id="heading-78">ä¸€ã€å…ˆåˆ†æ¸…ä¸¤ä¸ªã€Œé˜Ÿåˆ—ã€ï¼šå›è°ƒå­˜å‚¨æ•°ç»„ vs å¾®ä»»åŠ¡é˜Ÿåˆ—</h4>
<p>è¿™æ˜¯æœ€å®¹æ˜“æ··æ·†çš„ç‚¹ï¼Œå…ˆæ˜ç¡®äºŒè€…çš„å®šä½ï¼š</p>























<table><thead><tr><th>ç±»å‹</th><th>ä½œç”¨</th><th>æ—¶æœº</th><th>å¯¹åº” Promise çŠ¶æ€</th></tr></thead><tbody><tr><td>å›è°ƒå­˜å‚¨æ•°ç»„ï¼ˆå¦‚ <code>onFulfilledCallbacks</code>ï¼‰</td><td>ä¸´æ—¶ä¿å­˜å›è°ƒï¼Œé¿å…ä¸¢å¤±</td><td>è°ƒç”¨ <code>then</code> æ—¶ï¼ŒPromise æ˜¯ <code>pending</code> çŠ¶æ€</td><td>pendingï¼ˆå¼‚æ­¥ä»»åŠ¡æœªå®Œæˆï¼‰</td></tr><tr><td>å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼ˆæµè§ˆå™¨/Node å†…ç½®ï¼‰</td><td>è°ƒåº¦å›è°ƒçš„æ‰§è¡Œæ—¶æœºï¼Œä¿è¯å¼‚æ­¥</td><td>å›è°ƒå‡†å¤‡æ‰§è¡Œæ—¶ï¼ˆPromise çŠ¶æ€ç¡®å®šåï¼‰</td><td>fulfilled/rejectedï¼ˆå¼‚æ­¥ä»»åŠ¡å®Œæˆï¼‰</td></tr></tbody></table>
<h4 data-id="heading-79">äºŒã€åˆ†æ­¥æ‹†è§£ï¼šä¸¤ä¸ªæ“ä½œçš„é…åˆæµç¨‹ï¼ˆç»“åˆä»£ç ï¼‰</h4>
<p>ç”¨æˆ‘ä»¬ä¹‹å‰å†™çš„ <code>MyPromise</code> ä»£ç ï¼Œè¿˜åŸå®Œæ•´æ‰§è¡Œæµç¨‹ï¼š</p>
<h5 data-id="heading-80">åœºæ™¯ï¼šå¼‚æ­¥ Promise + è°ƒç”¨ then</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. åˆ›å»ºå¼‚æ­¥ Promiseï¼ˆpending çŠ¶æ€ï¼Œ1s å resolveï¼‰</span>
<span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-number">100</span>), <span class="hljs-number">1000</span>);
});

<span class="hljs-comment">// 2. è°ƒç”¨ thenï¼šæ­¤æ—¶ Promise è¿˜æ˜¯ pendingï¼Œæ‰§è¡Œã€Œpush å›è°ƒåˆ°æ•°ç»„ã€</span>
p.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å›è°ƒæ‰§è¡Œï¼š'</span>, res));
</code></pre>
<h5 data-id="heading-81">æ­¥éª¤1ï¼špush å›è°ƒåˆ°æ•°ç»„ï¼ˆå­˜å‚¨ï¼‰</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// MyPromise çš„ then æ–¹æ³•ä¸­</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-title class_">MyPromise</span>.<span class="hljs-property">PENDING</span>) {
  <span class="hljs-comment">// å…³é”®ï¼šæŠŠå›è°ƒé€»è¾‘åŒ…è£…åï¼Œpush åˆ°å­˜å‚¨æ•°ç»„</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledCallbacks</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">executeCallback</span>(onFulfilled, <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);
  });
}
</code></pre>
<ul>
<li>æ­¤æ—¶ Promise è¿˜åœ¨ <code>pending</code>ï¼ˆ1s åæ‰ resolveï¼‰ï¼Œæ— æ³•æ‰§è¡Œå›è°ƒï¼Œæ‰€ä»¥å…ˆæŠŠã€Œå›è°ƒæ‰§è¡Œé€»è¾‘ã€push åˆ° <code>onFulfilledCallbacks</code> æ•°ç»„é‡Œä¿å­˜ï¼›</li>
<li>è¿™ä¸€æ­¥å’Œã€Œå¾®ä»»åŠ¡é˜Ÿåˆ—ã€æ— å…³ï¼Œåªæ˜¯ã€Œä¸´æ—¶å­˜æ¡£ã€ã€‚</li>
</ul>
<h5 data-id="heading-82">æ­¥éª¤2ï¼šçŠ¶æ€ç¡®å®šåï¼Œæ‰§è¡Œå­˜å‚¨çš„å›è°ƒ â†’ æ¨åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼ˆè°ƒåº¦ï¼‰</h5>
<p>1s åï¼Œè°ƒç”¨ <code>resolve(100)</code>ï¼ŒPromise çŠ¶æ€å˜ä¸º <code>fulfilled</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// resolve å‡½æ•°ä¸­</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-title class_">MyPromise</span>.<span class="hljs-property">FULFILLED</span>;
<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;
<span class="hljs-comment">// éå†æ‰§è¡Œå­˜å‚¨æ•°ç»„ä¸­çš„å›è°ƒ</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">onFulfilledCallbacks</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">callback</span> =&gt;</span> <span class="hljs-title function_">callback</span>());
</code></pre>
<p>æ‰§è¡Œ <code>callback()</code> æ—¶ï¼Œä¼šè°ƒç”¨ <code>executeCallback</code> å‡½æ•°ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">executeCallback</span> = (<span class="hljs-params">callback, data</span>) =&gt; {
  <span class="hljs-comment">// å…³é”®ï¼šç”¨ setTimeout æ¨¡æ‹Ÿå¾®ä»»åŠ¡ï¼ŒæŠŠå›è°ƒæ¨åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—</span>
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">callback</span>(data);
    <span class="hljs-title function_">resolvePromise</span>(newPromise, result, resolve, reject);
  }, <span class="hljs-number">0</span>);
};
</code></pre>
<ul>
<li>æ­¤æ—¶æ‰æŠŠã€ŒçœŸæ­£çš„å›è°ƒæ‰§è¡Œé€»è¾‘ã€æ¨åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼ˆç”¨ setTimeout æ¨¡æ‹Ÿï¼‰ï¼›</li>
<li>è¿™ä¸€æ­¥æ˜¯ã€Œè°ƒåº¦æ‰§è¡Œæ—¶æœºã€ï¼Œä¿è¯å›è°ƒå¼‚æ­¥æ‰§è¡Œï¼Œè€ŒéåŒæ­¥é˜»å¡ã€‚</li>
</ul>
<h4 data-id="heading-83">ä¸‰ã€ç‰¹æ®Šåœºæ™¯ï¼šPromise å·²å®Œæˆï¼ˆé pendingï¼‰</h4>
<p>å¦‚æœè°ƒç”¨ <code>then</code> æ—¶ï¼ŒPromise å·²ç»æ˜¯ <code>fulfilled</code>/<code>rejected</code>ï¼Œå°±ä¸ä¼š push åˆ°å­˜å‚¨æ•°ç»„ï¼Œè€Œæ˜¯<strong>ç›´æ¥æŠŠå›è°ƒæ¨åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// MyPromise çš„ then æ–¹æ³•ä¸­</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-title class_">MyPromise</span>.<span class="hljs-property">FULFILLED</span>) {
  <span class="hljs-comment">// ç›´æ¥æ‰§è¡Œ executeCallback â†’ æ¨åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—</span>
  <span class="hljs-title function_">executeCallback</span>(onFulfilled, <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);
}
</code></pre>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Promise ç«‹å³ resolveï¼ˆçŠ¶æ€ä¸º fulfilledï¼‰</span>
<span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-number">100</span>));
<span class="hljs-comment">// è°ƒç”¨ then æ—¶ï¼ŒçŠ¶æ€å·²ç¡®å®šï¼Œç›´æ¥æŠŠå›è°ƒæ¨åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—</span>
p.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res));
</code></pre>
<h4 data-id="heading-84">å››ã€å…³é”®åŒºåˆ«ï¼šç”¨ç”Ÿæ´»ä¾‹å­ç±»æ¯”</h4>
<p>æŠŠ Promise æ¯”ä½œã€Œå¥¶èŒ¶åº—ã€ï¼š</p>
<ul>
<li><strong>push å›è°ƒåˆ°æ•°ç»„</strong>ï¼šä½ ç‚¹å•æ—¶ï¼Œå¥¶èŒ¶è¿˜æ²¡åšå¥½ï¼ˆpendingï¼‰ï¼Œåº—å‘˜æŠŠä½ çš„ã€Œå–é¤éœ€æ±‚ã€ï¼ˆå›è°ƒï¼‰è®°åœ¨å°æœ¬æœ¬ï¼ˆå­˜å‚¨æ•°ç»„ï¼‰ä¸Šï¼Œé¿å…æ¼å•ï¼›</li>
<li><strong>æ¨åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—</strong>ï¼šå¥¶èŒ¶åšå¥½äº†ï¼ˆfulfilledï¼‰ï¼Œåº—å‘˜å–Šä½ å–é¤ï¼Œä½†åº—é‡Œè§„å®šã€Œå…ˆåšå®Œæ‰€æœ‰å³æ—¶å•ï¼ˆåŒæ­¥ä»£ç ï¼‰ï¼Œå†å«å·å–é¤ï¼ˆå¾®ä»»åŠ¡ï¼‰ã€â€”â€” æŠŠä½ çš„ã€Œå–é¤åŠ¨ä½œã€æ’åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œï¼›</li>
<li>è‹¥ä½ åˆ°åº—æ—¶ï¼Œå¥¶èŒ¶å·²ç»åšå¥½äº†ï¼ˆé pendingï¼‰ï¼šåº—å‘˜ç›´æ¥æŠŠä½ çš„ã€Œå–é¤åŠ¨ä½œã€æ’åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¸ç”¨è®°å°æœ¬æœ¬ã€‚</li>
</ul>
<h4 data-id="heading-85">äº”ã€æ€»ç»“</h4>
<ol>
<li><strong>ä¸æ˜¯ä¸€å›äº‹</strong>ï¼š
<ul>
<li><code>push å›è°ƒåˆ°æ•°ç»„</code>ï¼šæ˜¯ã€Œå­˜å‚¨è¡Œä¸ºã€ï¼Œè§£å†³ pending çŠ¶æ€ä¸‹å›è°ƒçš„ä¿å­˜é—®é¢˜ï¼Œå’Œæ‰§è¡Œæ—¶æœºæ— å…³ï¼›</li>
<li><code>æ¨åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—</code>ï¼šæ˜¯ã€Œè°ƒåº¦è¡Œä¸ºã€ï¼Œè§£å†³å›è°ƒçš„å¼‚æ­¥æ‰§è¡Œæ—¶æœºé—®é¢˜ï¼Œä¿è¯ç¬¦åˆ Promise è§„èŒƒï¼›</li>
</ul>
</li>
<li><strong>å…³è”å…³ç³»</strong>ï¼š
<ul>
<li>è‹¥ Promise æ˜¯ pending â†’ å…ˆ push åˆ°å­˜å‚¨æ•°ç»„ï¼ŒçŠ¶æ€ç¡®å®šåï¼Œå†ä»æ•°ç»„å–å‡ºå›è°ƒï¼Œæ¨åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—æ‰§è¡Œï¼›</li>
<li>è‹¥ Promise å·²å®Œæˆ â†’ è·³è¿‡å­˜å‚¨æ•°ç»„ï¼Œç›´æ¥æŠŠå›è°ƒæ¨åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼›</li>
</ul>
</li>
<li><strong>æ ¸å¿ƒç›®çš„</strong>ï¼š
<ul>
<li>å­˜å‚¨æ•°ç»„ï¼šä¿è¯å›è°ƒä¸ä¸¢å¤±ï¼›</li>
<li>å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼šä¿è¯å›è°ƒå¼‚æ­¥æ‰§è¡Œï¼Œä¸”æ‰§è¡Œé¡ºåºç¬¦åˆè§„èŒƒï¼ˆå¾®ä»»åŠ¡ä¼˜å…ˆçº§ &gt; å®ä»»åŠ¡ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<p>è®°ä½ä¸€å¥è¯å°±èƒ½åˆ†æ¸…ï¼š<strong>å…ˆå­˜ï¼ˆpush æ•°ç»„ï¼‰ï¼Œåè°ƒï¼ˆå¾®ä»»åŠ¡é˜Ÿåˆ—ï¼‰</strong> â€”â€” å­˜å‚¨æ˜¯ä¸ºäº†ä¸ä¸¢ï¼Œå¾®ä»»åŠ¡æ˜¯ä¸ºäº†å¼‚æ­¥ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[| ES6 | å¼‚æ­¥ | é—­åŒ… | åŸå‹é“¾ | DOMæ“ä½œ | äº‹ä»¶å¤„ç† |]]></title>    <link>https://juejin.cn/post/7595890117866045486</link>    <guid>https://juejin.cn/post/7595890117866045486</guid>    <pubDate>2026-01-17T14:07:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595890117866045486" data-draft-id="7595808703074992154" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="| ES6 | å¼‚æ­¥ | é—­åŒ… | åŸå‹é“¾  | DOMæ“ä½œ | äº‹ä»¶å¤„ç† |"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-17T14:07:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åƒå¯»girling"/> <meta itemprop="url" content="https://juejin.cn/user/2276467567770442"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            | ES6 | å¼‚æ­¥ | é—­åŒ… | åŸå‹é“¾  | DOMæ“ä½œ | äº‹ä»¶å¤„ç† |
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2276467567770442/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åƒå¯»girling
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T14:07:20.000Z" title="Sat Jan 17 2026 14:07:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;color:rgba(46,36,36,.87);overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{margin-bottom:5px;font-size:30px;font-weight:500}.markdown-body h1:before{content:"#";margin-right:10px;color:#1976d2}.markdown-body h2{font-size:28px;font-weight:400;border-left:5px solid #454545;margin-top:20px;padding-left:10px;transition:all .3s ease-in-out}.markdown-body h2:hover{border-color:#1976d2}.markdown-body h3{font-size:24px;font-weight:400;margin-top:15px;padding-bottom:0}.markdown-body h4{font-size:20px;font-weight:500}.markdown-body h5{font-size:16px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h2:first-letter,.markdown-body h3:first-letter,.markdown-body p:first-letter{text-transform:capitalize}.markdown-body em{text-emphasis:dot;text-emphasis-position:under}.markdown-body img{display:block;margin:0 auto!important;max-width:100%;border-radius:2px;box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)!important}.markdown-body hr{position:relative;width:98%;height:1px;border:none;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,#ddd,#999,#ddd);overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background:#fff;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center}.markdown-body code{font-weight:900;word-break:break-word;border-radius:2px;overflow-x:auto;font-size:.87em;padding:.065em .4em;background-color:#fbe5e1;color:#c0341d}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:0 4px}.markdown-body pre&gt;code{font-weight:400;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{margin:0 4px;text-decoration:none;color:#027fff;transition:all .3s ease-in-out;padding-bottom:4px;border-bottom:2px solid transparent}.markdown-body a:after{content:"";display:inline-block;width:18px;height:18px;margin-left:4px;vertical-align:middle;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMjdGRkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PHBhdGggZD0iTTkuODE1IDYuNDQ4bDEuOTM2LTEuOTM2YzEuMzM3LTEuMzM2IDMuNTgtMS4yNTkgNS4wMTMuMTczIDEuNDMyIDEuNDMyIDEuNTEgMy42NzYuMTczIDUuMDEzbC0xLjQ1MiAxLjQ1Mi0uOTY4Ljk2OGMtMS4zMzcgMS4zMzYtMy41ODEgMS4yNTktNS4wMTMtLjE3MyIvPjxwYXRoIGQ9Ik0xMS4yNjcgMTUuMzY3bC0xLjkzNiAxLjkzNmMtMS4zMzYgMS4zMzctMy41OCAxLjI2LTUuMDEyLS4xNzMtMS40MzItMS40MzItMS41MS0zLjY3Ni0uMTczLTUuMDEybDEuNDUyLTEuNDUyLjk2OC0uOTY4YzEuMzM2LTEuMzM3IDMuNTgtMS4yNiA1LjAxMi4xNzMiLz48L2c+PC9zdmc+);background-size:cover;background-repeat:no-repeat}.markdown-body a:hover{border-color:#027fff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body a.footnote-backref:after,.markdown-body a.footnote-ref:after,.markdown-body sup a:after{display:none!important}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border:2px solid #c6c6c6}.markdown-body table img{box-shadow:none!important}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body del{color:rgba(0,0,0,.6)}.markdown-body blockquote{position:relative;color:#666;padding:5px 23px 1px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:hsla(0,0%,78.4%,.12);transition:all .2s ease-in-out}.markdown-body blockquote:hover{border-color:#1976d2}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;font-size:24px;font-weight:800;line-height:24px;color:#cbcbcb;opacity:.6}.markdown-body blockquote:before{content:"â€œ";top:4px;left:6px}.markdown-body blockquote:after{content:"â€";right:8px;bottom:-8px}.markdown-body blockquote&gt;p,.markdown-body blockquote blockquote{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body details{outline:none;border:none;border-left:4px solid #1976d2;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary:hover::-webkit-details-marker{color:#1976d2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="an-old-hope">.hljs-comment,.hljs-quote{color:#b6b18b}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#eb3c54}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#e7ce56}.hljs-attribute{color:#ee7c2b}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#4fb4d7}.hljs-section,.hljs-title{color:#78bb65}.hljs-keyword,.hljs-selector-tag{color:#b45ea4}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#1c1d21;color:#c0c5ce}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ES6+ æ–°ç‰¹æ€§</h2>
<p>ES6ï¼ˆECMAScript 2015ï¼‰åŠåç»­çš„ ES7-ES14 è¢«ç»Ÿç§°ä¸º ES6+ï¼Œæ˜¯ JavaScript è¯­è¨€çš„é‡å¤§å‡çº§ï¼Œè§£å†³äº† ES5 æ—¶ä»£çš„è¯­æ³•å†—ä½™ã€ä½œç”¨åŸŸæ··ä¹±ã€åŠŸèƒ½ç¼ºå¤±ç­‰é—®é¢˜ï¼Œå¤§å¹…æå‡äº†ä»£ç çš„å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§å’Œå¼€å‘æ•ˆç‡ã€‚</p>
<h3 data-id="heading-1">1. å—çº§ä½œç”¨åŸŸä¸å˜é‡å£°æ˜</h3>
<p>ES5 ä¸­åªæœ‰å…¨å±€ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸï¼Œ<code>var</code> å£°æ˜çš„å˜é‡å­˜åœ¨ â€œå˜é‡æå‡â€ å’Œ â€œä½œç”¨åŸŸç©¿é€â€ é—®é¢˜ï¼Œææ˜“å¼•å‘ bugã€‚ES6 æ–°å¢ <code>let</code> å’Œ <code>const</code> å…³é”®å­—ï¼Œå¼•å…¥å—çº§ä½œç”¨åŸŸï¼ˆ<code>{}</code> åŒ…è£¹çš„åŒºåŸŸï¼‰ï¼š</p>
<ul>
<li><code>let</code>ï¼šå£°æ˜å¯å˜å˜é‡ï¼Œä»…åœ¨å½“å‰å—çº§ä½œç”¨åŸŸæœ‰æ•ˆï¼Œæ— å˜é‡æå‡ï¼Œä¸å…è®¸é‡å¤å£°æ˜ï¼›</li>
<li><code>const</code>ï¼šå£°æ˜å¸¸é‡ï¼Œä¸€æ—¦èµ‹å€¼ä¸å¯ä¿®æ”¹ï¼ˆå¼•ç”¨ç±»å‹ä»…ä¿è¯åœ°å€ä¸å˜ï¼‰ï¼ŒåŒæ ·éµå¾ªå—çº§ä½œç”¨åŸŸè§„åˆ™ã€‚ç¤ºä¾‹ï¼š</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ES5 é—®é¢˜ï¼šå˜é‡æå‡+ä½œç”¨åŸŸç©¿é€</span>
<span class="hljs-keyword">if</span> (<span class="hljs-literal">true</span>) {
  <span class="hljs-keyword">var</span> a = <span class="hljs-number">10</span>;
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">// 10ï¼ˆå…¨å±€ä½œç”¨åŸŸå¯è®¿é—®ï¼‰</span>

<span class="hljs-comment">// ES6 è§£å†³</span>
<span class="hljs-keyword">if</span> (<span class="hljs-literal">true</span>) {
  <span class="hljs-keyword">let</span> b = <span class="hljs-number">20</span>;
  <span class="hljs-keyword">const</span> c = <span class="hljs-number">30</span>;
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b); <span class="hljs-comment">// ReferenceError: b is not defined</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(c); <span class="hljs-comment">// ReferenceError: c is not defined</span>
</code></pre>
<h3 data-id="heading-2">2. ç®­å¤´å‡½æ•°</h3>
<p>ç®€åŒ–å‡½æ•°å£°æ˜è¯­æ³•ï¼Œæ ¸å¿ƒç‰¹æ€§ï¼š</p>
<ul>
<li>è¯­æ³•ç®€æ´ï¼šå•å‚æ•°å¯çœç•¥æ‹¬å·ï¼Œå•è¿”å›è¯­å¥å¯çœç•¥å¤§æ‹¬å·å’Œ <code>return</code>ï¼›</li>
<li>æ— ç‹¬ç«‹ <code>this</code>ï¼šç®­å¤´å‡½æ•°çš„ <code>this</code> ç»§æ‰¿è‡ªå¤–å±‚ä½œç”¨åŸŸï¼Œè§£å†³äº† ES5 ä¸­ <code>this</code> æŒ‡å‘æ··ä¹±çš„é—®é¢˜ï¼ˆå¦‚å›è°ƒå‡½æ•°ä¸­ <code>this</code> ä¸¢å¤±ï¼‰ï¼›</li>
<li>ä¸èƒ½ä½œä¸ºæ„é€ å‡½æ•°ï¼šæ— æ³•ä½¿ç”¨ <code>new</code> è°ƒç”¨ï¼Œæ—  <code>arguments</code> å¯¹è±¡ï¼ˆå¯æ”¹ç”¨å‰©ä½™å‚æ•°ï¼‰ã€‚ç¤ºä¾‹ï¼š</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ES5 å‡½æ•°</span>
<span class="hljs-keyword">const</span> add = <span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) {
  <span class="hljs-keyword">return</span> a + b;
};

<span class="hljs-comment">// ES6 ç®­å¤´å‡½æ•°</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">add</span> = (<span class="hljs-params">a, b</span>) =&gt; a + b;

<span class="hljs-comment">// this æŒ‡å‘ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"å¼ ä¸‰"</span>,
  <span class="hljs-attr">fn1</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// undefinedï¼ˆthis æŒ‡å‘å…¨å±€ï¼‰</span>
    }, <span class="hljs-number">100</span>);
  },
  <span class="hljs-attr">fn2</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// å¼ ä¸‰ï¼ˆthis ç»§æ‰¿è‡ª fn2 çš„ä½œç”¨åŸŸï¼‰</span>
    }, <span class="hljs-number">100</span>);
  }
};
obj.<span class="hljs-title function_">fn1</span>();
obj.<span class="hljs-title function_">fn2</span>();
</code></pre>
<h3 data-id="heading-3">3. è§£æ„èµ‹å€¼</h3>
<p>å…è®¸ä»æ•°ç»„ / å¯¹è±¡ä¸­æå–å€¼ï¼Œèµ‹å€¼ç»™å˜é‡ï¼Œç®€åŒ–æ•°æ®æå–é€»è¾‘ï¼š</p>
<ul>
<li>æ•°ç»„è§£æ„ï¼šæŒ‰ç´¢å¼•åŒ¹é…ï¼Œæ”¯æŒé»˜è®¤å€¼ï¼›</li>
<li>å¯¹è±¡è§£æ„ï¼šæŒ‰å±æ€§ååŒ¹é…ï¼Œæ”¯æŒé‡å‘½åå’Œé»˜è®¤å€¼ã€‚ç¤ºä¾‹ï¼š</li>
</ul>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// æ•°ç»„è§£æ„</span>
<span class="hljs-type">const</span> [a, b, c = <span class="hljs-number">30</span>] = [<span class="hljs-number">10</span>, <span class="hljs-number">20</span>];
console.<span class="hljs-built_in">log</span>(a, b, c); <span class="hljs-comment">// 10 20 30</span>

<span class="hljs-comment">// å¯¹è±¡è§£æ„</span>
<span class="hljs-type">const</span> { name: userName, age = <span class="hljs-number">18</span> } = { name: <span class="hljs-string">"æå››"</span> };
console.<span class="hljs-built_in">log</span>(userName, age); <span class="hljs-comment">// æå›› 18</span>
</code></pre>
<h3 data-id="heading-4">4. æ‰©å±•è¿ç®—ç¬¦ä¸å‰©ä½™å‚æ•°</h3>
<ul>
<li>æ‰©å±•è¿ç®—ç¬¦ï¼ˆ<code>...</code>ï¼‰ï¼šå°†æ•°ç»„ / å¯¹è±¡å±•å¼€ä¸ºå•ä¸ªå…ƒç´ ï¼Œç”¨äºåˆå¹¶æ•°æ®ã€ä¼ é€’å‚æ•°ï¼›</li>
<li>å‰©ä½™å‚æ•°ï¼ˆ<code>...</code>ï¼‰ï¼šæ”¶é›†å‰©ä½™çš„å‚æ•°ï¼Œè½¬ä¸ºæ•°ç»„ï¼Œæ›¿ä»£ <code>arguments</code>ã€‚ç¤ºä¾‹ï¼š</li>
</ul>
<pre><code class="hljs language-ini" lang="ini">// æ‰©å±•è¿ç®—ç¬¦
const <span class="hljs-attr">arr1</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<span class="hljs-comment">;</span>
const <span class="hljs-attr">arr2</span> = [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]<span class="hljs-comment">;</span>
const <span class="hljs-attr">arr3</span> = [...arr1, ...arr2]<span class="hljs-comment">; // [1,2,3,4,5,6]</span>

const <span class="hljs-attr">obj1</span> = { a: <span class="hljs-number">1</span> }<span class="hljs-comment">;</span>
const <span class="hljs-attr">obj2</span> = { b: <span class="hljs-number">2</span> }<span class="hljs-comment">;</span>
const <span class="hljs-attr">obj3</span> = { ...obj1, ...obj2 }<span class="hljs-comment">; // {a:1, b:2}</span>

// å‰©ä½™å‚æ•°
const <span class="hljs-attr">sum</span> = (...args) =&gt; args.reduce((total, cur) =&gt; total + cur, <span class="hljs-number">0</span>)<span class="hljs-comment">;</span>
console.log(sum(1,2,3))<span class="hljs-comment">; // 6</span>
</code></pre>
<h3 data-id="heading-5">5. æ¨¡æ¿å­—ç¬¦ä¸²</h3>
<p>ç”¨åå¼•å·ï¼ˆ<code>ï¼‰åŒ…è£¹å­—ç¬¦ä¸²ï¼Œæ”¯æŒæ¢è¡Œå’Œå˜é‡æ’å€¼ï¼ˆ</code>${å˜é‡}`ï¼‰ï¼Œè§£å†³ ES5 å­—ç¬¦ä¸²æ‹¼æ¥ç¹ççš„é—®é¢˜ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">name</span> = <span class="hljs-string">"ç‹äº”"</span><span class="hljs-comment">;</span>
const <span class="hljs-attr">age</span> = <span class="hljs-number">20</span><span class="hljs-comment">;</span>
// ES5 æ‹¼æ¥
const <span class="hljs-attr">str1</span> = <span class="hljs-string">"å§“åï¼š"</span> + name + <span class="hljs-string">"ï¼Œå¹´é¾„ï¼š"</span> + age + <span class="hljs-string">"å²"</span><span class="hljs-comment">;</span>
// ES6 æ¨¡æ¿å­—ç¬¦ä¸²
const <span class="hljs-attr">str2</span> = `å§“åï¼š<span class="hljs-variable">${name}</span>ï¼Œå¹´é¾„ï¼š<span class="hljs-variable">${age}</span>å²`<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-6">6. å…¶ä»–æ ¸å¿ƒç‰¹æ€§</h3>
<ul>
<li><code>Set/Map</code> æ•°æ®ç»“æ„ï¼š<code>Set</code> ç”¨äºå­˜å‚¨å”¯ä¸€å€¼ï¼ˆæ•°ç»„å»é‡ï¼‰ï¼Œ<code>Map</code> é”®å€¼å¯¹é›†åˆï¼ˆé”®å¯ä¸ºä»»æ„ç±»å‹ï¼Œæ›¿ä»£å¯¹è±¡ï¼‰ï¼›</li>
<li><code>Class</code> ç±»ï¼šè¯­æ³•ç³–ï¼Œç®€åŒ–åŸå‹é“¾ç»§æ‰¿ï¼Œæä¾› <code>constructor</code>ã€<code>extends</code>ã€<code>super</code> ç­‰å…³é”®å­—ï¼›</li>
<li>æ¨¡å—åŒ–ï¼ˆ<code>import/export</code>ï¼‰ï¼šæ›¿ä»£ CommonJS/AMDï¼Œå®ç°æŒ‰éœ€åŠ è½½ï¼Œæå‡ä»£ç æ¨¡å—åŒ–ç¨‹åº¦ï¼›</li>
<li>å¯é€‰é“¾ï¼ˆ<code>?.</code>ï¼‰ã€ç©ºå€¼åˆå¹¶ï¼ˆ<code>??</code>ï¼‰ï¼šES2020 ç‰¹æ€§ï¼Œç®€åŒ–ç©ºå€¼åˆ¤æ–­ï¼Œé¿å… <code>Cannot read property 'xxx' of undefined</code> é”™è¯¯ã€‚</li>
</ul>
<p>ES6+ æ–°ç‰¹æ€§çš„æ ¸å¿ƒä»·å€¼åœ¨äº â€œè¯­æ³•ç®€åŒ–â€ å’Œ â€œåŠŸèƒ½è¡¥å…¨â€ï¼Œè®© JavaScript ä» â€œè„šæœ¬è¯­è¨€â€ å‘ â€œå·¥ç¨‹åŒ–è¯­è¨€â€ è¿ˆè¿›ï¼Œæ˜¯ç°ä»£å‰ç«¯å¼€å‘ï¼ˆReact/Vue/TypeScriptï¼‰çš„åŸºç¡€ã€‚</p>
<h2 data-id="heading-7">äºŒã€å¼‚æ­¥ï¼ˆPromise, async/awaitï¼‰</h2>
<p>JavaScript æ˜¯å•çº¿ç¨‹è¯­è¨€ï¼Œé»˜è®¤åŒæ­¥æ‰§è¡Œä»£ç ï¼Œä½†ç½‘ç»œè¯·æ±‚ã€å®šæ—¶å™¨ã€æ–‡ä»¶æ“ä½œç­‰åœºæ™¯éœ€è¦å¼‚æ­¥å¤„ç†ï¼Œå¦åˆ™ä¼šé˜»å¡ä¸»çº¿ç¨‹ã€‚å¼‚æ­¥ç¼–ç¨‹ç»å†äº† â€œå›è°ƒå‡½æ•° â†’ Promise â†’ async/awaitâ€ çš„æ¼”è¿›ï¼Œæ ¸å¿ƒç›®æ ‡æ˜¯è§£å†³ â€œå›è°ƒåœ°ç‹±â€ï¼Œè®©å¼‚æ­¥ä»£ç æ›´æ˜“è¯»ã€æ˜“ç»´æŠ¤ã€‚</p>
<h3 data-id="heading-8">1. å¼‚æ­¥ç¼–ç¨‹çš„æ ¸å¿ƒé—®é¢˜ï¼šå›è°ƒåœ°ç‹±</h3>
<p>ES5 ä¸­å¼‚æ­¥æ“ä½œä¾èµ–å›è°ƒå‡½æ•°ï¼Œå¤šä¸ªå¼‚æ­¥åµŒå¥—æ—¶ä¼šå‡ºç° â€œå›è°ƒåœ°ç‹±â€ï¼ˆä»£ç å±‚çº§æ·±ã€å¯è¯»æ€§å·®ã€é”™è¯¯å¤„ç†ç¹çï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å›è°ƒåœ°ç‹±ï¼šè·å–ç”¨æˆ·ä¿¡æ¯ â†’ è·å–ç”¨æˆ·è®¢å• â†’ è·å–è®¢å•è¯¦æƒ…</span>
$.<span class="hljs-title function_">get</span>(<span class="hljs-string">"/api/user"</span>, <span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> {
  $.<span class="hljs-title function_">get</span>(<span class="hljs-string">`/api/order?userId=<span class="hljs-subst">${user.id}</span>`</span>, <span class="hljs-function">(<span class="hljs-params">order</span>) =&gt;</span> {
    $.<span class="hljs-title function_">get</span>(<span class="hljs-string">`/api/orderDetail?orderId=<span class="hljs-subst">${order.id}</span>`</span>, <span class="hljs-function">(<span class="hljs-params">detail</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(detail);
    }, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"è·å–è®¢å•è¯¦æƒ…å¤±è´¥"</span>, err);
    });
  }, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"è·å–è®¢å•å¤±è´¥"</span>, err);
  });
}, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"è·å–ç”¨æˆ·å¤±è´¥"</span>, err);
});
</code></pre>
<p>é—®é¢˜ï¼šå±‚çº§åµŒå¥—è¿‡æ·±ï¼Œé”™è¯¯å¤„ç†åˆ†æ•£ï¼Œä»£ç éš¾ä»¥è°ƒè¯•å’Œç»´æŠ¤ã€‚</p>
<h3 data-id="heading-9">2. Promiseï¼šå¼‚æ­¥æ“ä½œçš„æ ‡å‡†åŒ–å°è£…</h3>
<p>Promise æ˜¯ ES6 å¼•å…¥çš„å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»£è¡¨å¼‚æ­¥æ“ä½œçš„ â€œæœªå®Œæˆ / æˆåŠŸ / å¤±è´¥â€ çŠ¶æ€ï¼Œæ ¸å¿ƒç‰¹æ€§ï¼š</p>
<ul>
<li>ä¸‰ç§çŠ¶æ€ï¼š<code>pending</code>ï¼ˆè¿›è¡Œä¸­ï¼‰ã€<code>fulfilled</code>ï¼ˆå·²æˆåŠŸï¼‰ã€<code>rejected</code>ï¼ˆå·²å¤±è´¥ï¼‰ï¼ŒçŠ¶æ€ä¸€æ—¦æ”¹å˜ä¸å¯é€†è½¬ï¼›</li>
<li>ä¸¤ä¸ªå›è°ƒï¼š<code>then()</code> å¤„ç†æˆåŠŸç»“æœï¼Œ<code>catch()</code> å¤„ç†å¤±è´¥ç»“æœï¼Œæ”¯æŒé“¾å¼è°ƒç”¨ï¼›</li>
<li>è§£å†³å›è°ƒåœ°ç‹±ï¼šé€šè¿‡é“¾å¼è°ƒç”¨æ›¿ä»£åµŒå¥—ï¼Œé”™è¯¯å¯ç»Ÿä¸€æ•è·ã€‚</li>
</ul>
<h4 data-id="heading-10">ï¼ˆ1ï¼‰Promise åŸºæœ¬ç”¨æ³•</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ›å»º Promise å¯¹è±¡</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">getPromise</span> = (<span class="hljs-params">url</span>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();
    xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">"GET"</span>, url);
    xhr.<span class="hljs-property">onload</span> = <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) {
        <span class="hljs-title function_">resolve</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(xhr.<span class="hljs-property">responseText</span>)); <span class="hljs-comment">// æˆåŠŸï¼šè°ƒç”¨ resolve</span>
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(xhr.<span class="hljs-property">statusText</span>)); <span class="hljs-comment">// å¤±è´¥ï¼šè°ƒç”¨ reject</span>
      }
    };
    xhr.<span class="hljs-property">onerror</span> = <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"ç½‘ç»œè¯·æ±‚å¤±è´¥"</span>));
    };
    xhr.<span class="hljs-title function_">send</span>();
  });
};

<span class="hljs-comment">// é“¾å¼è°ƒç”¨ï¼šè§£å†³å›è°ƒåœ°ç‹±</span>
<span class="hljs-title function_">getPromise</span>(<span class="hljs-string">"/api/user"</span>)
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> <span class="hljs-title function_">getPromise</span>(<span class="hljs-string">`/api/order?userId=<span class="hljs-subst">${user.id}</span>`</span>))
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">order</span>) =&gt;</span> <span class="hljs-title function_">getPromise</span>(<span class="hljs-string">`/api/orderDetail?orderId=<span class="hljs-subst">${order.id}</span>`</span>))
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">detail</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(detail))
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"è¯·æ±‚å¤±è´¥"</span>, err)); <span class="hljs-comment">// ç»Ÿä¸€æ•è·æ‰€æœ‰é”™è¯¯</span>
</code></pre>
<h4 data-id="heading-11">ï¼ˆ2ï¼‰Promise å¸¸ç”¨æ–¹æ³•</h4>
<ul>
<li><code>Promise.all()</code>ï¼šæ¥æ”¶å¤šä¸ª Promise æ•°ç»„ï¼Œå…¨éƒ¨æˆåŠŸæ‰è¿”å›ç»“æœæ•°ç»„ï¼Œä¸€ä¸ªå¤±è´¥åˆ™ç«‹å³å¤±è´¥ï¼›</li>
<li><code>Promise.race()</code>ï¼šæ¥æ”¶å¤šä¸ª Promise æ•°ç»„ï¼Œè¿”å›ç¬¬ä¸€ä¸ªå®Œæˆçš„ Promise ç»“æœï¼ˆæ— è®ºæˆåŠŸ / å¤±è´¥ï¼‰ï¼›</li>
<li><code>Promise.resolve()</code>/<code>Promise.reject()</code>ï¼šå¿«é€Ÿåˆ›å»ºæˆåŠŸ / å¤±è´¥çš„ Promise å¯¹è±¡ï¼›</li>
<li><code>Promise.allSettled()</code>ï¼šç­‰å¾…æ‰€æœ‰ Promise å®Œæˆï¼ˆæ— è®ºæˆåŠŸ / å¤±è´¥ï¼‰ï¼Œè¿”å›æ‰€æœ‰ç»“æœï¼ˆåŒ…å«çŠ¶æ€å’Œå€¼ï¼‰ã€‚</li>
</ul>
<p>ç¤ºä¾‹ï¼ˆPromise.allï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åŒæ—¶è¯·æ±‚å¤šä¸ªæ¥å£ï¼Œå…¨éƒ¨å®Œæˆåå¤„ç†</span>
<span class="hljs-keyword">const</span> promise1 = <span class="hljs-title function_">getPromise</span>(<span class="hljs-string">"/api/user"</span>);
<span class="hljs-keyword">const</span> promise2 = <span class="hljs-title function_">getPromise</span>(<span class="hljs-string">"/api/goods"</span>);
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([promise1, promise2])
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">[user, goods]</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç”¨æˆ·ä¿¡æ¯"</span>, user);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å•†å“ä¿¡æ¯"</span>, goods);
  })
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"æŸä¸ªè¯·æ±‚å¤±è´¥"</span>, err));
</code></pre>
<h3 data-id="heading-12">3. async/awaitï¼šå¼‚æ­¥ä»£ç åŒæ­¥åŒ–</h3>
<p>ES2017 å¼•å…¥çš„ <code>async/await</code> æ˜¯ Promise çš„è¯­æ³•ç³–ï¼Œå…è®¸ç”¨ â€œåŒæ­¥ä»£ç çš„å†™æ³•â€ å¤„ç†å¼‚æ­¥æ“ä½œï¼Œæ ¸å¿ƒè§„åˆ™ï¼š</p>
<ul>
<li><code>async</code> ä¿®é¥°å‡½æ•°ï¼šä½¿å‡½æ•°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼›</li>
<li><code>await</code> ä¿®é¥° Promiseï¼šæš‚åœå‡½æ•°æ‰§è¡Œï¼Œç›´åˆ° Promise çŠ¶æ€å˜ä¸ºæˆåŠŸï¼Œè¿”å›ç»“æœï¼›è‹¥ Promise å¤±è´¥ï¼Œéœ€ç”¨ <code>try/catch</code> æ•è·é”™è¯¯ã€‚</li>
</ul>
<h4 data-id="heading-13">ï¼ˆ1ï¼‰åŸºæœ¬ç”¨æ³•ï¼ˆè§£å†³å›è°ƒåœ°ç‹±çš„ç»ˆææ–¹æ¡ˆï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å°è£…å¼‚æ­¥è¯·æ±‚å‡½æ•°ï¼ˆè¿”å› Promiseï¼‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">getUser</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-title function_">getPromise</span>(<span class="hljs-string">"/api/user"</span>);
<span class="hljs-keyword">const</span> <span class="hljs-title function_">getOrder</span> = (<span class="hljs-params">userId</span>) =&gt; <span class="hljs-title function_">getPromise</span>(<span class="hljs-string">`/api/order?userId=<span class="hljs-subst">${userId}</span>`</span>);
<span class="hljs-keyword">const</span> <span class="hljs-title function_">getOrderDetail</span> = (<span class="hljs-params">orderId</span>) =&gt; <span class="hljs-title function_">getPromise</span>(<span class="hljs-string">`/api/orderDetail?orderId=<span class="hljs-subst">${orderId}</span>`</span>);

<span class="hljs-comment">// async/await å†™æ³•ï¼šåŒæ­¥é£æ ¼çš„å¼‚æ­¥ä»£ç </span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">getOrderInfo</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getUser</span>(); <span class="hljs-comment">// ç­‰å¾… getUser å®Œæˆ</span>
    <span class="hljs-keyword">const</span> order = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getOrder</span>(user.<span class="hljs-property">id</span>); <span class="hljs-comment">// ç­‰å¾… getOrder å®Œæˆ</span>
    <span class="hljs-keyword">const</span> detail = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getOrderDetail</span>(order.<span class="hljs-property">id</span>); <span class="hljs-comment">// ç­‰å¾… getOrderDetail å®Œæˆ</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(detail);
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"è¯·æ±‚å¤±è´¥"</span>, err); <span class="hljs-comment">// ç»Ÿä¸€æ•è·æ‰€æœ‰é”™è¯¯</span>
  }
};

<span class="hljs-title function_">getOrderInfo</span>();
</code></pre>
<h4 data-id="heading-14">ï¼ˆ2ï¼‰async/await ä¼˜åŠ¿</h4>
<ul>
<li>ä»£ç æ‰å¹³åŒ–ï¼šæ— åµŒå¥—ï¼Œå¯è¯»æ€§æ¥è¿‘åŒæ­¥ä»£ç ï¼›</li>
<li>é”™è¯¯å¤„ç†ç»Ÿä¸€ï¼šé€šè¿‡ <code>try/catch</code> æ•è·æ‰€æœ‰å¼‚æ­¥é”™è¯¯ï¼Œæ›¿ä»£ Promise çš„ <code>catch()</code>ï¼›</li>
<li>è°ƒè¯•å‹å¥½ï¼šå¯åœ¨ <code>await</code> å¤„æ‰“æ–­ç‚¹ï¼Œè°ƒè¯•æµç¨‹ä¸åŒæ­¥ä»£ç ä¸€è‡´ã€‚</li>
</ul>
<h3 data-id="heading-15">4. å¼‚æ­¥ç¼–ç¨‹çš„æ ¸å¿ƒåŸåˆ™</h3>
<ul>
<li>é¿å…åŒæ­¥é˜»å¡ï¼šå¼‚æ­¥æ“ä½œå§‹ç»ˆä¸é˜»å¡ä¸»çº¿ç¨‹ï¼ˆå¦‚å®šæ—¶å™¨ã€ç½‘ç»œè¯·æ±‚ç”±æµè§ˆå™¨å†…æ ¸çš„çº¿ç¨‹å¤„ç†ï¼‰ï¼›</li>
<li>é”™è¯¯å¤„ç†å…¨è¦†ç›–ï¼šPromise éœ€åŠ  <code>catch()</code>ï¼Œasync/await éœ€åŒ… <code>try/catch</code>ï¼Œé¿å…æœªæ•è·çš„å¼‚æ­¥é”™è¯¯ï¼›</li>
<li>å¹¶è¡Œå¤„ç†ä¼˜åŒ–ï¼šå¤šä¸ªæ— ä¾èµ–çš„å¼‚æ­¥æ“ä½œï¼Œç”¨ <code>Promise.all()</code> æ›¿ä»£ä¸²è¡Œ <code>await</code>ï¼Œæå‡æ‰§è¡Œæ•ˆç‡ã€‚</li>
</ul>
<p>å¼‚æ­¥ç¼–ç¨‹æ˜¯å‰ç«¯å¼€å‘çš„æ ¸å¿ƒéš¾ç‚¹ï¼ŒPromise è§£å†³äº† â€œå›è°ƒåœ°ç‹±â€ çš„ç»“æ„é—®é¢˜ï¼Œasync/await åˆ™è®©å¼‚æ­¥ä»£ç çš„å¯è¯»æ€§è¾¾åˆ°äº†åŒæ­¥ä»£ç çš„æ°´å¹³ï¼Œæ˜¯ç°ä»£å‰ç«¯å¤„ç†ç½‘ç»œè¯·æ±‚ã€å¼‚æ­¥æ•°æ®åŠ è½½çš„æ ‡é…ã€‚</p>
<h2 data-id="heading-16">ä¸‰ã€é—­åŒ…å’ŒåŸå‹é“¾</h2>
<p>é—­åŒ…å’ŒåŸå‹é“¾æ˜¯ JavaScript çš„ä¸¤å¤§æ ¸å¿ƒç‰¹æ€§ï¼Œä¹Ÿæ˜¯é¢è¯•é«˜é¢‘è€ƒç‚¹ã€‚é—­åŒ…å…³ä¹ä½œç”¨åŸŸå’Œå˜é‡ç”Ÿå‘½å‘¨æœŸï¼ŒåŸå‹é“¾åˆ™æ˜¯ JavaScript å®ç°ç»§æ‰¿çš„åº•å±‚æœºåˆ¶ï¼Œç†è§£è¿™ä¸¤ä¸ªæ¦‚å¿µèƒ½å¸®ä½ çªç ´ â€œè¯­æ³•ä½¿ç”¨â€ åˆ° â€œåŸç†ç†è§£â€ çš„ç“¶é¢ˆã€‚</p>
<h3 data-id="heading-17">1. é—­åŒ…ï¼ˆClosureï¼‰</h3>
<h4 data-id="heading-18">ï¼ˆ1ï¼‰é—­åŒ…çš„å®šä¹‰</h4>
<p>é—­åŒ…æ˜¯æŒ‡ â€œæœ‰æƒè®¿é—®å¦ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸä¸­å˜é‡çš„å‡½æ•°â€ï¼Œæœ¬è´¨æ˜¯å‡½æ•°ä½œç”¨åŸŸé“¾çš„ä¿ç•™ï¼šå½“å†…éƒ¨å‡½æ•°è¢«å¤–éƒ¨å¼•ç”¨æ—¶ï¼Œå…¶æ‰€åœ¨çš„ä½œç”¨åŸŸä¸ä¼šè¢«åƒåœ¾å›æ”¶æœºåˆ¶é”€æ¯ï¼Œä»è€Œå¯ä»¥æŒç»­è®¿é—®å¤–å±‚å‡½æ•°çš„å˜é‡ã€‚</p>
<h4 data-id="heading-19">ï¼ˆ2ï¼‰é—­åŒ…çš„å½¢æˆæ¡ä»¶</h4>
<ol>
<li>å­˜åœ¨åµŒå¥—å‡½æ•°ï¼ˆå†…éƒ¨å‡½æ•° + å¤–éƒ¨å‡½æ•°ï¼‰ï¼›</li>
<li>å†…éƒ¨å‡½æ•°å¼•ç”¨å¤–éƒ¨å‡½æ•°çš„å˜é‡ / å‚æ•°ï¼›</li>
<li>å¤–éƒ¨å‡½æ•°æ‰§è¡Œåï¼Œå†…éƒ¨å‡½æ•°è¢«å¤–éƒ¨ç¯å¢ƒå¼•ç”¨ï¼ˆå¦‚è¿”å›ã€èµ‹å€¼ç»™å…¨å±€å˜é‡ï¼‰ã€‚</li>
</ol>
<h4 data-id="heading-20">ï¼ˆ3ï¼‰åŸºæœ¬ç”¨æ³•ä¸ç¤ºä¾‹</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// åŸºç¡€é—­åŒ…ï¼šå¤–éƒ¨å‡½æ•°æ‰§è¡Œåï¼Œå†…éƒ¨å‡½æ•°ä»èƒ½è®¿é—®å…¶å˜é‡</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">outer</span>(<span class="hljs-params"/>) </span>{
  <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">num</span> = <span class="hljs-number">10</span>; <span class="hljs-comment">// å¤–éƒ¨å‡½æ•°çš„å˜é‡</span>
  <span class="hljs-comment">// å†…éƒ¨å‡½æ•°å¼•ç”¨å¤–éƒ¨å˜é‡</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inner</span>(<span class="hljs-params"/>) </span>{
    console.<span class="hljs-title function_ invoke__">log</span>(num);
  }
  <span class="hljs-keyword">return</span> inner; <span class="hljs-comment">// è¿”å›å†…éƒ¨å‡½æ•°ï¼Œä½¿å…¶è¢«å¤–éƒ¨å¼•ç”¨</span>
}

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">fn</span> = <span class="hljs-title function_ invoke__">outer</span>(); <span class="hljs-comment">// outer æ‰§è¡Œå®Œæ¯•ï¼Œä½†å…¶ä½œç”¨åŸŸæœªè¢«é”€æ¯</span>
<span class="hljs-function"><span class="hljs-keyword">fn</span>(<span class="hljs-params"/>)</span>; <span class="hljs-comment">// 10ï¼ˆinner ä»èƒ½è®¿é—® numï¼‰</span>
</code></pre>
<h4 data-id="heading-21">ï¼ˆ4ï¼‰é—­åŒ…çš„æ ¸å¿ƒåº”ç”¨åœºæ™¯</h4>
<ul>
<li>
<p>å°è£…ç§æœ‰å˜é‡ï¼šæ¨¡æ‹Ÿ â€œç§æœ‰å±æ€§ / æ–¹æ³•â€ï¼Œé¿å…å…¨å±€å˜é‡æ±¡æŸ“ï¼›</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å°è£…è®¡æ•°å™¨ï¼šcount æ˜¯ç§æœ‰å˜é‡ï¼Œåªèƒ½é€šè¿‡æ–¹æ³•ä¿®æ”¹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createCounter</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">increment</span>: <span class="hljs-function">() =&gt;</span> count++,
    <span class="hljs-attr">decrement</span>: <span class="hljs-function">() =&gt;</span> count--,
    <span class="hljs-attr">getCount</span>: <span class="hljs-function">() =&gt;</span> count
  };
}

<span class="hljs-keyword">const</span> counter = <span class="hljs-title function_">createCounter</span>();
counter.<span class="hljs-title function_">increment</span>();
counter.<span class="hljs-title function_">increment</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(counter.<span class="hljs-title function_">getCount</span>()); <span class="hljs-comment">// 2</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(counter.<span class="hljs-property">count</span>); <span class="hljs-comment">// undefinedï¼ˆæ— æ³•ç›´æ¥è®¿é—®ï¼‰</span>
</code></pre>
</li>
<li>
<p>é˜²æŠ– / èŠ‚æµå‡½æ•°ï¼šåˆ©ç”¨é—­åŒ…ä¿å­˜å®šæ—¶å™¨ IDã€ä¸Šæ¬¡æ‰§è¡Œæ—¶é—´ç­‰çŠ¶æ€ï¼›</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é˜²æŠ–å‡½æ•°ï¼ˆé—­åŒ…ä¿å­˜ timer å˜é‡ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">debounce</span>(<span class="hljs-params">fn, delay</span>) {
  <span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span>; <span class="hljs-comment">// é—­åŒ…ä¿å­˜ timerï¼Œå¤šæ¬¡è°ƒç”¨å…±äº«åŒä¸€ä¸ª timer</span>
  <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> {
    <span class="hljs-built_in">clearTimeout</span>(timer);
    timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
    }, delay);
  };
}
</code></pre>
</li>
<li>
<p>æŸ¯é‡ŒåŒ–å‡½æ•°ï¼šå°†å¤šå‚æ•°å‡½æ•°è½¬ä¸ºå•å‚æ•°å‡½æ•°ï¼Œåˆ©ç”¨é—­åŒ…ç¼“å­˜å·²ä¼ å…¥çš„å‚æ•°ã€‚</p>
</li>
</ul>
<h4 data-id="heading-22">ï¼ˆ5ï¼‰é—­åŒ…çš„æ³¨æ„äº‹é¡¹</h4>
<ul>
<li>å†…å­˜æ³„æ¼é£é™©ï¼šé—­åŒ…ä¼šä¿ç•™å¤–å±‚ä½œç”¨åŸŸï¼Œè‹¥é•¿æœŸå¼•ç”¨æœªé‡Šæ”¾ï¼ˆå¦‚èµ‹å€¼ç»™å…¨å±€å˜é‡ï¼‰ï¼Œä¼šå¯¼è‡´å˜é‡æ— æ³•è¢«åƒåœ¾å›æ”¶ï¼Œå ç”¨å†…å­˜ï¼›</li>
<li>è§£å†³ï¼šä½¿ç”¨å®Œé—­åŒ…åï¼Œæ‰‹åŠ¨è§£é™¤å¼•ç”¨ï¼ˆå¦‚ <code>fn = null</code>ï¼‰ï¼Œè®©ä½œç”¨åŸŸå¯ä»¥è¢«å›æ”¶ã€‚</li>
</ul>
<h3 data-id="heading-23">2. åŸå‹é“¾ï¼ˆPrototype Chainï¼‰</h3>
<p>JavaScript æ˜¯ â€œåŸºäºåŸå‹çš„é¢å‘å¯¹è±¡è¯­è¨€â€ï¼Œæ²¡æœ‰ç±»ï¼ˆES6 Class æ˜¯è¯­æ³•ç³–ï¼‰ï¼Œæ‰€æœ‰å¯¹è±¡éƒ½é€šè¿‡ â€œåŸå‹â€ å®ç°å±æ€§å’Œæ–¹æ³•çš„ç»§æ‰¿ï¼ŒåŸå‹é“¾æ˜¯å®ç°ç»§æ‰¿çš„æ ¸å¿ƒæœºåˆ¶ã€‚</p>
<h4 data-id="heading-24">ï¼ˆ1ï¼‰æ ¸å¿ƒæ¦‚å¿µ</h4>
<ul>
<li>åŸå‹ï¼ˆ<code>prototype</code>ï¼‰ï¼šå‡½æ•°ç‰¹æœ‰çš„å±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ˜¯å½“å‰å‡½æ•°åˆ›å»ºçš„æ‰€æœ‰å®ä¾‹çš„åŸå‹ï¼›</li>
<li>éšå¼åŸå‹ï¼ˆ<code>__proto__</code>ï¼‰ï¼šæ‰€æœ‰å¯¹è±¡ï¼ˆåŒ…æ‹¬å‡½æ•°ï¼‰éƒ½æœ‰çš„å±æ€§ï¼ŒæŒ‡å‘å…¶æ„é€ å‡½æ•°çš„ <code>prototype</code>ï¼›</li>
<li>åŸå‹é“¾ï¼šå½“è®¿é—®å¯¹è±¡çš„å±æ€§ / æ–¹æ³•æ—¶ï¼Œå…ˆåœ¨è‡ªèº«æŸ¥æ‰¾ï¼Œæ‰¾ä¸åˆ°åˆ™é€šè¿‡ <code>__proto__</code> å‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ° <code>Object.prototype</code>ï¼Œè¿™ä¸ªæŸ¥æ‰¾é“¾æ¡å°±æ˜¯åŸå‹é“¾ã€‚</li>
</ul>
<h4 data-id="heading-25">ï¼ˆ2ï¼‰åŸå‹é“¾çš„åŸºæœ¬ç»“æ„</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ„é€ å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}
<span class="hljs-comment">// ç»™åŸå‹æ·»åŠ æ–¹æ³•</span>
<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayHello</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>`</span>);
};

<span class="hljs-comment">// åˆ›å»ºå®ä¾‹</span>
<span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"å¼ ä¸‰"</span>);

<span class="hljs-comment">// åŸå‹é“¾æŸ¥æ‰¾ï¼šp1 â†’ Person.prototype â†’ Object.prototype â†’ null</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p1.<span class="hljs-property">name</span>); <span class="hljs-comment">// è‡ªèº«å±æ€§ï¼Œç›´æ¥è¿”å›</span>
p1.<span class="hljs-title function_">sayHello</span>(); <span class="hljs-comment">// p1 è‡ªèº«æ—  sayHelloï¼ŒæŸ¥æ‰¾ p1.__proto__ï¼ˆPerson.prototypeï¼‰æ‰¾åˆ°</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p1.<span class="hljs-title function_">toString</span>()); <span class="hljs-comment">// p1 å’Œ Person.prototype æ—  toStringï¼ŒæŸ¥æ‰¾ Object.prototype æ‰¾åˆ°</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p1.<span class="hljs-property">xxx</span>); <span class="hljs-comment">// åŸå‹é“¾æœ«ç«¯ä¸º nullï¼Œè¿”å› undefined</span>
</code></pre>
<h4 data-id="heading-26">ï¼ˆ3ï¼‰åŸå‹é“¾çš„æ ¸å¿ƒåº”ç”¨ï¼šç»§æ‰¿</h4>
<p>ES5 ä¸­é€šè¿‡ä¿®æ”¹åŸå‹é“¾å®ç°ç»§æ‰¿ï¼ˆES6 Class çš„ <code>extends</code> åº•å±‚ä»æ˜¯åŸå‹é“¾ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// çˆ¶ç±»</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}
<span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">eat</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> åƒé¥­`</span>);
};

<span class="hljs-comment">// å­ç±»</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Child</span>(<span class="hljs-params">name, age</span>) {
  <span class="hljs-title class_">Parent</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, name); <span class="hljs-comment">// ç»§æ‰¿çˆ¶ç±»å®ä¾‹å±æ€§</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
}
<span class="hljs-comment">// ç»§æ‰¿çˆ¶ç±»åŸå‹æ–¹æ³•</span>
<span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
<span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Child</span>; <span class="hljs-comment">// ä¿®æ­£æ„é€ å‡½æ•°æŒ‡å‘</span>

<span class="hljs-comment">// å­ç±»æ·»åŠ è‡ªæœ‰æ–¹æ³•</span>
<span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">run</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> è·‘æ­¥ï¼Œå¹´é¾„ <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.age}</span>`</span>);
};

<span class="hljs-keyword">const</span> child = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Child</span>(<span class="hljs-string">"æå››"</span>, <span class="hljs-number">10</span>);
child.<span class="hljs-title function_">eat</span>(); <span class="hljs-comment">// ç»§æ‰¿çˆ¶ç±»æ–¹æ³•</span>
child.<span class="hljs-title function_">run</span>(); <span class="hljs-comment">// å­ç±»è‡ªæœ‰æ–¹æ³•</span>
</code></pre>
<h4 data-id="heading-27">ï¼ˆ4ï¼‰åŸå‹é“¾çš„å…³é”®è§„åˆ™</h4>
<ul>
<li>æ‰€æœ‰å¯¹è±¡çš„æœ€ç»ˆåŸå‹æ˜¯ <code>Object.prototype</code>ï¼Œå…¶ <code>__proto__</code> ä¸º <code>null</code>ï¼›</li>
<li>å‡½æ•°çš„ <code>prototype</code> æ˜¯æ™®é€šå¯¹è±¡ï¼Œ<code>Function.prototype</code> æ˜¯å‡½æ•°ï¼ˆç‰¹æ®Šï¼‰ï¼›</li>
<li>ä¿®æ”¹åŸå‹ä¼šå½±å“æ‰€æœ‰å®ä¾‹ï¼ˆåŸå‹å…±äº«ç‰¹æ€§ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-28">3. é—­åŒ…ä¸åŸå‹é“¾çš„å…³è”</h3>
<p>é—­åŒ…å…³æ³¨ â€œä½œç”¨åŸŸå’Œå˜é‡ä¿ç•™â€ï¼ŒåŸå‹é“¾å…³æ³¨ â€œå¯¹è±¡å±æ€§ç»§æ‰¿â€ï¼ŒäºŒè€…å…±åŒæ„æˆ JavaScript çš„æ ¸å¿ƒåº•å±‚é€»è¾‘ï¼šé—­åŒ…è®©å‡½æ•°å¯ä»¥çªç ´ä½œç”¨åŸŸé™åˆ¶è®¿é—®å˜é‡ï¼ŒåŸå‹é“¾è®©å¯¹è±¡å¯ä»¥çªç ´è‡ªèº«ç»“æ„ç»§æ‰¿æ–¹æ³•ï¼Œæ˜¯ç†è§£ JavaScript è®¾è®¡æ€æƒ³çš„å…³é”®ã€‚</p>
<h2 data-id="heading-29">å››ã€DOM æ“ä½œå’Œäº‹ä»¶å¤„ç†</h2>
<p>DOMï¼ˆæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼‰æ˜¯æµè§ˆå™¨å°† HTML æ–‡æ¡£è§£ææˆçš„æ ‘å½¢ç»“æ„ï¼Œå‰ç«¯å¼€å‘çš„æ ¸å¿ƒæ˜¯é€šè¿‡ JavaScript æ“ä½œ DOM å®ç°é¡µé¢äº¤äº’ï¼Œäº‹ä»¶å¤„ç†åˆ™æ˜¯å“åº”ç”¨æˆ·æ“ä½œï¼ˆç‚¹å‡»ã€è¾“å…¥ã€æ»šåŠ¨ç­‰ï¼‰çš„æ ¸å¿ƒæœºåˆ¶ã€‚</p>
<h3 data-id="heading-30">1. DOM æ“ä½œ</h3>
<p>DOM æ“ä½œåˆ†ä¸º â€œæŸ¥æ‰¾èŠ‚ç‚¹â€â€œåˆ›å»º / æ’å…¥èŠ‚ç‚¹â€â€œä¿®æ”¹èŠ‚ç‚¹â€â€œåˆ é™¤èŠ‚ç‚¹â€ å››ç±»ï¼Œæ ¸å¿ƒæ˜¯æ“ä½œ DOM æ ‘çš„èŠ‚ç‚¹ï¼ˆå…ƒç´ èŠ‚ç‚¹ã€æ–‡æœ¬èŠ‚ç‚¹ã€å±æ€§èŠ‚ç‚¹ï¼‰ã€‚</p>
<h4 data-id="heading-31">ï¼ˆ1ï¼‰æŸ¥æ‰¾ DOM èŠ‚ç‚¹ï¼ˆæ ¸å¿ƒï¼‰</h4>
<p>æŸ¥æ‰¾æ˜¯ DOM æ“ä½œçš„ç¬¬ä¸€æ­¥ï¼Œå¸¸ç”¨æ–¹æ³•ï¼š</p>
<ul>
<li>æŒ‰ ID æŸ¥æ‰¾ï¼š<code>document.getElementById("id")</code> â†’ è¿”å›å•ä¸ªå…ƒç´ ï¼ˆæ•ˆç‡æœ€é«˜ï¼‰ï¼›</li>
<li>æŒ‰ç±»åæŸ¥æ‰¾ï¼š<code>document.getElementsByClassName("className")</code> â†’ è¿”å› HTMLCollectionï¼ˆåŠ¨æ€é›†åˆï¼‰ï¼›</li>
<li>æŒ‰æ ‡ç­¾åæŸ¥æ‰¾ï¼š<code>document.getElementsByTagName("tagName")</code> â†’ è¿”å› HTMLCollectionï¼›</li>
<li>æŒ‰é€‰æ‹©å™¨æŸ¥æ‰¾ï¼š<code>document.querySelector("selector")</code>ï¼ˆè¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…å…ƒç´ ï¼‰ã€<code>document.querySelectorAll("selector")</code>ï¼ˆè¿”å› NodeListï¼Œé™æ€é›†åˆï¼‰â†’ æœ€çµæ´»ï¼Œæ”¯æŒ CSS é€‰æ‹©å™¨ã€‚</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// æŒ‰ ID æŸ¥æ‰¾</span>
<span class="hljs-keyword">const</span> box = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"box"</span>);

<span class="hljs-comment">// æŒ‰é€‰æ‹©å™¨æŸ¥æ‰¾</span>
<span class="hljs-keyword">const</span> item = <span class="hljs-built_in">document</span>.<span class="hljs-built_in">querySelector</span>(<span class="hljs-string">".list .item"</span>);
<span class="hljs-keyword">const</span> items = <span class="hljs-built_in">document</span>.<span class="hljs-built_in">querySelectorAll</span>(<span class="hljs-string">".list .item"</span>); <span class="hljs-comment">// NodeList å¯é€šè¿‡ forEach éå†</span>
</code></pre>
<h4 data-id="heading-32">ï¼ˆ2ï¼‰åˆ›å»ºä¸æ’å…¥èŠ‚ç‚¹</h4>
<p>åŠ¨æ€ç”Ÿæˆé¡µé¢å†…å®¹çš„æ ¸å¿ƒï¼Œå¸¸ç”¨æ–¹æ³•ï¼š</p>
<ul>
<li>
<p>åˆ›å»ºå…ƒç´ ï¼š<code>document.createElement("tagName")</code>ï¼›</p>
</li>
<li>
<p>åˆ›å»ºæ–‡æœ¬èŠ‚ç‚¹ï¼š<code>document.createTextNode("text")</code>ï¼›</p>
</li>
<li>
<p>æ’å…¥èŠ‚ç‚¹ï¼š</p>
<ul>
<li><code>parent.appendChild(child)</code>ï¼šå°†å­èŠ‚ç‚¹æ’å…¥çˆ¶èŠ‚ç‚¹æœ«å°¾ï¼›</li>
<li><code>parent.insertBefore(newNode, referenceNode)</code>ï¼šå°†æ–°èŠ‚ç‚¹æ’å…¥å‚è€ƒèŠ‚ç‚¹ä¹‹å‰ï¼›</li>
<li><code>element.innerHTML</code>ï¼šç›´æ¥é€šè¿‡ HTML å­—ç¬¦ä¸²æ’å…¥èŠ‚ç‚¹ï¼ˆç®€æ´ä½†æœ‰ XSS é£é™©ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// åˆ›å»ºå…ƒç´ å¹¶æ’å…¥
const <span class="hljs-attr">ul</span> = document.querySelector(<span class="hljs-string">"ul"</span>)<span class="hljs-comment">;</span>
const <span class="hljs-attr">li</span> = document.createElement(<span class="hljs-string">"li"</span>)<span class="hljs-comment">;</span>
<span class="hljs-attr">li.textContent</span> = <span class="hljs-string">"æ–°åˆ—è¡¨é¡¹"</span><span class="hljs-comment">; // è®¾ç½®æ–‡æœ¬å†…å®¹ï¼ˆå®‰å…¨ï¼Œæ—  XSSï¼‰</span>
ul.appendChild(li)<span class="hljs-comment">;</span>

// innerHTML æ–¹å¼ï¼ˆæ…ç”¨ï¼Œé¿å…ç”¨æˆ·è¾“å…¥å†…å®¹ï¼‰
ul.innerHTML += "&lt;li&gt;æ–°åˆ—è¡¨é¡¹&lt;/li&gt;"<span class="hljs-comment">;</span>
</code></pre>
<h4 data-id="heading-33">ï¼ˆ3ï¼‰ä¿®æ”¹ DOM èŠ‚ç‚¹</h4>
<ul>
<li>
<p>ä¿®æ”¹å±æ€§ï¼š<code>element.setAttribute("attr", "value")</code>ï¼ˆè®¾ç½®å±æ€§ï¼‰ã€<code>element.getAttribute("attr")</code>ï¼ˆè·å–å±æ€§ï¼‰ã€<code>element.removeAttribute("attr")</code>ï¼ˆç§»é™¤å±æ€§ï¼‰ï¼›</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> img = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"img"</span>);
img.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">"src"</span>, <span class="hljs-string">"new.jpg"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(img.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">"src"</span>)); <span class="hljs-comment">// new.jpg</span>
</code></pre>
</li>
<li>
<p>ä¿®æ”¹æ ·å¼ï¼š</p>
<ul>
<li>è¡Œå†…æ ·å¼ï¼š<code>element.style.cssProperty = "value"</code>ï¼ˆé©¼å³°å‘½åï¼Œå¦‚ <code>backgroundColor</code>ï¼‰ï¼›</li>
<li>ç±»åæ ·å¼ï¼š<code>element.classList.add("className")</code>ã€<code>element.classList.remove("className")</code>ã€<code>element.classList.toggle("className")</code>ï¼ˆæ¨èï¼Œåˆ†ç¦»æ ·å¼å’Œé€»è¾‘ï¼‰ã€‚</li>
</ul>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">div</span> = document.querySelector(<span class="hljs-string">".box"</span>)<span class="hljs-comment">;</span>
<span class="hljs-attr">div.style.width</span> = <span class="hljs-string">"200px"</span><span class="hljs-comment">;</span>
div.classList.add("active")<span class="hljs-comment">; // æ·»åŠ ç±»å</span>
div.classList.toggle("show")<span class="hljs-comment">; // åˆ‡æ¢ç±»å</span>
</code></pre>
</li>
<li>
<p>ä¿®æ”¹æ–‡æœ¬ / HTMLï¼š<code>element.textContent</code>ï¼ˆçº¯æ–‡æœ¬ï¼Œå®‰å…¨ï¼‰ã€<code>element.innerHTML</code>ï¼ˆHTML å­—ç¬¦ä¸²ï¼Œæœ‰ XSS é£é™©ï¼‰ã€‚</p>
</li>
</ul>
<h4 data-id="heading-34">ï¼ˆ4ï¼‰åˆ é™¤ DOM èŠ‚ç‚¹</h4>
<ul>
<li><code>parent.removeChild(child)</code>ï¼šçˆ¶èŠ‚ç‚¹ç§»é™¤å­èŠ‚ç‚¹ï¼›</li>
<li><code>element.remove()</code>ï¼šå…ƒç´ è‡ªèº«ç§»é™¤ï¼ˆES6+ æ–¹æ³•ï¼Œæ›´ç®€æ´ï¼‰ã€‚</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">const</span> <span class="hljs-selector-tag">li</span> = <span class="hljs-selector-tag">document</span><span class="hljs-selector-class">.querySelector</span>(<span class="hljs-string">"li"</span>);
<span class="hljs-selector-tag">li</span><span class="hljs-selector-class">.parentElement</span><span class="hljs-selector-class">.removeChild</span>(li); <span class="hljs-comment">// ä¼ ç»Ÿæ–¹å¼</span>
<span class="hljs-comment">// æˆ–</span>
<span class="hljs-selector-tag">li</span><span class="hljs-selector-class">.remove</span>(); <span class="hljs-comment">// ç®€æ´æ–¹å¼</span>
</code></pre>
<h4 data-id="heading-35">ï¼ˆ5ï¼‰DOM æ“ä½œçš„æ€§èƒ½ä¼˜åŒ–</h4>
<p>DOM æ“ä½œæ˜¯ â€œé‡æ“ä½œâ€ï¼Œé¢‘ç¹ä¿®æ”¹ä¼šè§¦å‘æµè§ˆå™¨é‡æ’ï¼ˆReflowï¼‰/ é‡ç»˜ï¼ˆRepaintï¼‰ï¼Œå¯¼è‡´é¡µé¢å¡é¡¿ï¼Œä¼˜åŒ–æ‰‹æ®µï¼š</p>
<ul>
<li>
<p>æ‰¹é‡æ“ä½œï¼šå…ˆå°†èŠ‚ç‚¹è„±ç¦»æ–‡æ¡£æµï¼ˆå¦‚éšè—çˆ¶èŠ‚ç‚¹ï¼‰ï¼Œæ“ä½œå®Œæˆåå†æ¢å¤ï¼›</p>
</li>
<li>
<p>ä½¿ç”¨æ–‡æ¡£ç¢ç‰‡ï¼š<code>document.createDocumentFragment()</code>ï¼Œæ‰¹é‡æ’å…¥èŠ‚ç‚¹ä»…è§¦å‘ä¸€æ¬¡é‡æ’ï¼›</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">fragment</span> = document.createDocumentFragment()<span class="hljs-comment">;</span>
for (let <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; 1000; i++) {</span>
  const <span class="hljs-attr">li</span> = document.createElement(<span class="hljs-string">"li"</span>)<span class="hljs-comment">;</span>
  <span class="hljs-attr">li.textContent</span> = `é¡¹ <span class="hljs-variable">${i}</span>`<span class="hljs-comment">;</span>
  fragment.appendChild(li)<span class="hljs-comment">; // å…ˆæ’å…¥ç¢ç‰‡ï¼Œæ— é‡æ’</span>
}
document.querySelector("ul").appendChild(fragment)<span class="hljs-comment">; // ä»…ä¸€æ¬¡é‡æ’</span>
</code></pre>
</li>
<li>
<p>é¿å…é¢‘ç¹æŸ¥è¯¢ DOMï¼šå°†æŸ¥è¯¢ç»“æœç¼“å­˜åˆ°å˜é‡ï¼Œå‡å°‘ DOM éå†ã€‚</p>
</li>
</ul>
<h3 data-id="heading-36">2. äº‹ä»¶å¤„ç†</h3>
<p>äº‹ä»¶æ˜¯æµè§ˆå™¨è§¦å‘çš„ â€œä¿¡å·â€ï¼ˆå¦‚ç‚¹å‡»ã€è¾“å…¥ã€åŠ è½½ï¼‰ï¼Œäº‹ä»¶å¤„ç†æ˜¯ JavaScript å“åº”ç”¨æˆ·æ“ä½œçš„æ ¸å¿ƒï¼Œåˆ†ä¸º â€œäº‹ä»¶ç»‘å®šâ€â€œäº‹ä»¶æµâ€â€œäº‹ä»¶å¯¹è±¡â€â€œäº‹ä»¶ä¼˜åŒ–â€ å››éƒ¨åˆ†ã€‚</p>
<h4 data-id="heading-37">ï¼ˆ1ï¼‰äº‹ä»¶ç»‘å®šæ–¹å¼</h4>
<ul>
<li>
<p>è¡Œå†…ç»‘å®šï¼ˆä¸æ¨èï¼‰ï¼š<code>&lt;button onclick="handleClick()"&gt;ç‚¹å‡»&lt;/button&gt;</code> â†’ è€¦åˆåº¦é«˜ï¼Œä¸åˆ©äºç»´æŠ¤ï¼›</p>
</li>
<li>
<p>DOM0 çº§ç»‘å®šï¼š<code>element.onclick = function() {}</code> â†’ ç®€å•ï¼Œä½†ä¸€ä¸ªäº‹ä»¶åªèƒ½ç»‘å®šä¸€ä¸ªå¤„ç†å‡½æ•°ï¼›</p>
</li>
<li>
<p>DOM2 çº§ç»‘å®šï¼š<code>element.addEventListener("eventName", handler, useCapture)</code> â†’ æ¨èï¼Œæ”¯æŒç»‘å®šå¤šä¸ªå¤„ç†å‡½æ•°ï¼Œå¯æ§åˆ¶äº‹ä»¶é˜¶æ®µï¼›</p>
</li>
</ul>
<blockquote>
<ul>
<li>
<p><strong>DOM0 çº§</strong>ï¼šæµè§ˆå™¨åŸç”Ÿæ”¯æŒï¼Œæ— å®˜æ–¹è§„èŒƒ â†’ <code>element.onclick = function() {}</code></p>
</li>
<li>
<p><strong>DOM1 çº§</strong>ï¼šä»…è§„èŒƒ DOM ç»“æ„ï¼Œæœªæ–°å¢äº‹ä»¶ç»‘å®šæ–¹å¼ â†’ æ— äº‹ä»¶ç›¸å…³å†…å®¹</p>
</li>
<li>
<p><strong>DOM2 çº§</strong>ï¼šW3C å‘å¸ƒæ ‡å‡†ï¼Œæ–°å¢ <code>addEventListener</code> â†’ æ”¯æŒå¤šç»‘å®šã€äº‹ä»¶é˜¶æ®µ</p>
</li>
<li>
<p><strong>DOM3 çº§</strong>ï¼šåœ¨ DOM2 åŸºç¡€ä¸Šæ–°å¢äº†æ›´å¤šäº‹ä»¶ç±»å‹ï¼ˆå¦‚é”®ç›˜ã€é¼ æ ‡æ»šè½®äº‹ä»¶ï¼‰</p>
</li>
</ul>
</blockquote>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"button"</span>);
<span class="hljs-comment">// DOM0 çº§</span>
btn.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç‚¹å‡»1"</span>);
};
btn.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç‚¹å‡»2"</span>); <span class="hljs-comment">// è¦†ç›–ä¸Šä¸€ä¸ªå¤„ç†å‡½æ•°</span>
};

<span class="hljs-comment">// DOM2 çº§</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç‚¹å‡»1"</span>);
btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"click"</span>, handleClick);
btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"click"</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç‚¹å‡»2"</span>)); <span class="hljs-comment">// å¯ç»‘å®šå¤šä¸ª</span>
btn.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">"click"</span>, handleClick); <span class="hljs-comment">// å¯ç§»é™¤</span>
</code></pre>
<h4 data-id="heading-38">ï¼ˆ2ï¼‰äº‹ä»¶æµï¼ˆäº‹ä»¶ä¼ æ’­æœºåˆ¶ï¼‰</h4>
<p>äº‹ä»¶æµåˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š</p>
<ol>
<li>æ•è·é˜¶æ®µï¼šäº‹ä»¶ä» <code>document</code> å‘ä¸‹ä¼ æ’­åˆ°ç›®æ ‡å…ƒç´ ï¼›</li>
<li>ç›®æ ‡é˜¶æ®µï¼šäº‹ä»¶åˆ°è¾¾ç›®æ ‡å…ƒç´ ï¼›</li>
<li>å†’æ³¡é˜¶æ®µï¼šäº‹ä»¶ä»ç›®æ ‡å…ƒç´ å‘ä¸Šä¼ æ’­åˆ° <code>document</code>ã€‚</li>
</ol>
<p><code>addEventListener</code> çš„ç¬¬ä¸‰ä¸ªå‚æ•° <code>useCapture</code>ï¼š<code>true</code> è¡¨ç¤ºåœ¨æ•è·é˜¶æ®µè§¦å‘ï¼Œ<code>false</code>ï¼ˆé»˜è®¤ï¼‰è¡¨ç¤ºåœ¨å†’æ³¡é˜¶æ®µè§¦å‘ã€‚</p>
<h4 data-id="heading-39">ï¼ˆ3ï¼‰äº‹ä»¶å¯¹è±¡ï¼ˆEventï¼‰</h4>
<p>äº‹ä»¶å¤„ç†å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯äº‹ä»¶å¯¹è±¡ï¼ŒåŒ…å«äº‹ä»¶çš„æ ¸å¿ƒä¿¡æ¯ï¼š</p>
<ul>
<li><code>event.target</code>ï¼šè§¦å‘äº‹ä»¶çš„åŸå§‹å…ƒç´ ï¼ˆäº‹ä»¶æºï¼‰ï¼›</li>
<li><code>event.currentTarget</code>ï¼šç»‘å®šäº‹ä»¶çš„å…ƒç´ ï¼›</li>
<li><code>event.preventDefault()</code>ï¼šé˜»æ­¢é»˜è®¤è¡Œä¸ºï¼ˆå¦‚è¡¨å•æäº¤ã€é“¾æ¥è·³è½¬ï¼‰ï¼›</li>
<li><code>event.stopPropagation()</code>ï¼šé˜»æ­¢äº‹ä»¶ä¼ æ’­ï¼ˆå†’æ³¡ / æ•è·ï¼‰ï¼›</li>
<li><code>event.stopImmediatePropagation()</code>ï¼šé˜»æ­¢äº‹ä»¶ä¼ æ’­ï¼Œä¸”é˜»æ­¢å½“å‰å…ƒç´ åç»­çš„äº‹ä»¶å¤„ç†å‡½æ•°æ‰§è¡Œã€‚</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é˜»æ­¢é“¾æ¥è·³è½¬</span>
<span class="hljs-keyword">const</span> a = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"a"</span>);
a.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"click"</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  e.<span class="hljs-title function_">preventDefault</span>(); <span class="hljs-comment">// é˜»æ­¢é»˜è®¤è·³è½¬</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç‚¹å‡»é“¾æ¥ï¼Œä¸è·³è½¬"</span>);
});

<span class="hljs-comment">// äº‹ä»¶å§”æ‰˜ï¼ˆåˆ©ç”¨äº‹ä»¶å†’æ³¡ï¼‰</span>
<span class="hljs-keyword">const</span> ul = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"ul"</span>);
ul.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"click"</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">target</span>.<span class="hljs-property">tagName</span> === <span class="hljs-string">"LI"</span>) { <span class="hljs-comment">// åˆ¤æ–­ç‚¹å‡»çš„æ˜¯ li å…ƒç´ </span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç‚¹å‡»äº†åˆ—è¡¨é¡¹"</span>, e.<span class="hljs-property">target</span>.<span class="hljs-property">textContent</span>);
  }
});
</code></pre>
<h4 data-id="heading-40">ï¼ˆ4ï¼‰æ ¸å¿ƒä¼˜åŒ–ï¼šäº‹ä»¶å§”æ‰˜</h4>
<p>åˆ©ç”¨äº‹ä»¶å†’æ³¡ï¼Œå°†å­å…ƒç´ çš„äº‹ä»¶ç»‘å®šåˆ°çˆ¶å…ƒç´ ï¼Œå‡å°‘äº‹ä»¶ç»‘å®šæ•°é‡ï¼Œä¼˜åŒ–æ€§èƒ½ï¼ˆå°¤å…¶é€‚åˆåŠ¨æ€ç”Ÿæˆçš„å…ƒç´ ï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// åŠ¨æ€ç”Ÿæˆçš„ li æ— éœ€å•ç‹¬ç»‘å®šäº‹ä»¶ï¼Œçˆ¶å…ƒç´  ul å§”æ‰˜å¤„ç†
const <span class="hljs-attr">ul</span> = document.querySelector(<span class="hljs-string">"ul"</span>)<span class="hljs-comment">;</span>
ul.addEventListener("click", (e) =&gt; {
  if (e.target.classList.contains("item")) {
    console.log("ç‚¹å‡»äº†åŠ¨æ€ç”Ÿæˆçš„åˆ—è¡¨é¡¹")<span class="hljs-comment">;</span>
  }
})<span class="hljs-comment">;</span>

// åŠ¨æ€æ·»åŠ  li
const <span class="hljs-attr">li</span> = document.createElement(<span class="hljs-string">"li"</span>)<span class="hljs-comment">;</span>
li.classList.add("item")<span class="hljs-comment">;</span>
<span class="hljs-attr">li.textContent</span> = <span class="hljs-string">"åŠ¨æ€é¡¹"</span><span class="hljs-comment">;</span>
ul.appendChild(li)<span class="hljs-comment">;</span>
</code></pre>
<h4 data-id="heading-41">ï¼ˆ5ï¼‰å¸¸è§äº‹ä»¶ç±»å‹</h4>
<ul>
<li>é¼ æ ‡äº‹ä»¶ï¼š<code>click</code>ã€<code>dblclick</code>ã€<code>mouseover</code>ã€<code>mouseout</code>ã€<code>mousedown</code>ã€<code>mouseup</code>ï¼›</li>
<li>é”®ç›˜äº‹ä»¶ï¼š<code>keydown</code>ã€<code>keyup</code>ã€<code>keypress</code>ï¼›</li>
<li>è¡¨å•äº‹ä»¶ï¼š<code>input</code>ã€<code>change</code>ã€<code>submit</code>ã€<code>focus</code>ã€<code>blur</code>ï¼›</li>
<li>é¡µé¢äº‹ä»¶ï¼š<code>load</code>ã€<code>DOMContentLoaded</code>ï¼ˆDOM è§£æå®Œæˆï¼‰ã€<code>scroll</code>ã€<code>resize</code>ã€‚</li>
</ul>
<p>DOM æ“ä½œå’Œäº‹ä»¶å¤„ç†æ˜¯å‰ç«¯äº¤äº’çš„åŸºç¡€ï¼Œæ ¸å¿ƒåŸåˆ™æ˜¯ â€œå‡å°‘ DOM æ“ä½œæ¬¡æ•°â€â€œåˆç†åˆ©ç”¨äº‹ä»¶æœºåˆ¶â€ï¼Œæ—¢ä¿è¯äº¤äº’çš„æµç•…æ€§ï¼Œåˆé¿å…æ€§èƒ½é—®é¢˜ã€‚</p>
<h2 data-id="heading-42">æ€»ç»“</h2>
<ol>
<li>ES6+ æ–°ç‰¹æ€§æ ¸å¿ƒæ˜¯ç®€åŒ–è¯­æ³•ã€è¡¥å…¨åŠŸèƒ½ï¼Œæ˜¯ç°ä»£å‰ç«¯å¼€å‘çš„åŸºç¡€ï¼Œé‡ç‚¹æŒæ¡å—çº§ä½œç”¨åŸŸã€ç®­å¤´å‡½æ•°ã€è§£æ„ã€async/await ç­‰é«˜é¢‘ç”¨æ³•ï¼›</li>
<li>å¼‚æ­¥ç¼–ç¨‹ä»å›è°ƒåœ°ç‹±æ¼”è¿›åˆ° Promise/async/awaitï¼Œæ ¸å¿ƒæ˜¯è®©å¼‚æ­¥ä»£ç æ›´æ˜“è¯»ã€æ˜“ç»´æŠ¤ï¼Œasync/await æ˜¯å½“å‰æœ€ä¼˜å†™æ³•ï¼›</li>
<li>é—­åŒ…æ˜¯ä½œç”¨åŸŸé“¾çš„ä¿ç•™ï¼Œç”¨äºå°è£…ç§æœ‰å˜é‡ã€å®ç°é˜²æŠ–èŠ‚æµï¼Œéœ€æ³¨æ„å†…å­˜æ³„æ¼ï¼›åŸå‹é“¾æ˜¯ JS ç»§æ‰¿çš„åº•å±‚æœºåˆ¶ï¼Œæ‰€æœ‰å¯¹è±¡é€šè¿‡ <code>__proto__</code> å½¢æˆç»§æ‰¿é“¾æ¡ï¼›</li>
<li>DOM æ“ä½œéœ€æ³¨é‡æ€§èƒ½ï¼ˆæ‰¹é‡æ“ä½œã€æ–‡æ¡£ç¢ç‰‡ï¼‰ï¼Œäº‹ä»¶å¤„ç†æ ¸å¿ƒæ˜¯äº‹ä»¶å§”æ‰˜ï¼Œåˆ©ç”¨å†’æ³¡å‡å°‘ç»‘å®šæ•°é‡ï¼Œæå‡é¡µé¢æ€§èƒ½ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JS -å½»åº•ææ‡‚ callã€applyã€bind çš„åŒºåˆ«ä¸åº”ç”¨]]></title>    <link>https://juejin.cn/post/7595878718172217380</link>    <guid>https://juejin.cn/post/7595878718172217380</guid>    <pubDate>2026-01-17T14:13:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595878718172217380" data-draft-id="7595878718172168228" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JS -å½»åº•ææ‡‚ callã€applyã€bind çš„åŒºåˆ«ä¸åº”ç”¨"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-01-17T14:13:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‘ç°ä¸€åªå¤§å‘†ç“œ"/> <meta itemprop="url" content="https://juejin.cn/user/180747382561607"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JS -å½»åº•ææ‡‚ callã€applyã€bind çš„åŒºåˆ«ä¸åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/180747382561607/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‘ç°ä¸€åªå¤§å‘†ç“œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T14:13:04.000Z" title="Sat Jan 17 2026 14:13:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>åœ¨ JavaScript ä¸­ï¼Œ<code>this</code> çš„æŒ‡å‘æ˜¯åŠ¨æ€çš„ï¼Œè¿™è™½ç„¶çµæ´»ï¼Œä½†ä¹Ÿå¸¸è®©æˆ‘ä»¬å¤´ç–¼ã€‚è€Œ <code>call</code>ã€<code>apply</code> å’Œ <code>bind</code> å°±æ˜¯æˆ‘ä»¬æ‰‹ä¸­çš„â€œé­”æ³•æ£’â€ï¼Œä¸“é—¨ç”¨æ¥<strong>æ‰‹åŠ¨æ§åˆ¶ this çš„æŒ‡å‘</strong>ã€‚å®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿåˆ†åˆ«åœ¨ä»€ä¹ˆåœºæ™¯ä¸‹ä½¿ç”¨ï¼Ÿæœ¬æ–‡å¸¦ä½ ä¸€æ¢ç©¶ç«Ÿã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ ä¸‰å¤§æ–¹æ³•è¯¦è§£</h2>
<p>è¿™ä¸‰ä¸ªæ–¹æ³•éƒ½æŒ‚è½½åœ¨ <code>Function.prototype</code> ä¸Šï¼Œè¿™æ„å‘³ç€æ‰€æœ‰çš„å‡½æ•°éƒ½å¯ä»¥è°ƒç”¨å®ƒä»¬ã€‚</p>
<h3 data-id="heading-2">1. call()</h3>
<ul>
<li>
<p><strong>ä½œç”¨</strong>ï¼šä¿®æ”¹å‡½æ•°çš„ <code>this</code> æŒ‡å‘ï¼Œå¹¶<strong>ç«‹å³æ‰§è¡Œ</strong>è¯¥å‡½æ•°ã€‚</p>
</li>
<li>
<p><strong>å‚æ•°</strong>ï¼š</p>
<ol>
<li><code>thisArg</code>ï¼š<code>this</code> éœ€è¦ç»‘å®šçš„å¯¹è±¡ã€‚</li>
<li><code>arg1, arg2, ...</code>ï¼š<strong>å‚æ•°åˆ—è¡¨</strong>ï¼Œç›´æ¥æŒ‰é¡ºåºä¼ å…¥ã€‚</li>
</ol>
</li>
<li>
<p><strong>é»˜è®¤è¡Œä¸º</strong>ï¼šå¦‚æœä¸ä¼  <code>thisArg</code> æˆ–ä¼  <code>null</code>/<code>undefined</code>ï¼Œåœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹æŒ‡å‘ <code>window</code>ã€‚</p>
</li>
</ul>
<pre><code class="hljs language-js" lang="js">fn.<span class="hljs-title function_">call</span>(obj, agr1,agr2,arg3,arg4,.....)
</code></pre>
<h3 data-id="heading-3">2. apply()</h3>
<ul>
<li>
<p><strong>ä½œç”¨</strong>ï¼šä¿®æ”¹å‡½æ•°çš„ <code>this</code> æŒ‡å‘ï¼Œå¹¶<strong>ç«‹å³æ‰§è¡Œ</strong>è¯¥å‡½æ•°ã€‚</p>
</li>
<li>
<p><strong>å‚æ•°</strong>ï¼š</p>
<ol>
<li><code>thisArg</code>ï¼š<code>this</code> éœ€è¦ç»‘å®šçš„å¯¹è±¡ã€‚</li>
<li><code>argsArray</code>ï¼š<strong>æ•°ç»„ï¼ˆæˆ–ç±»æ•°ç»„ï¼‰</strong> ï¼Œæ•°ç»„å†…çš„å…ƒç´ ä¼šè¢«å±•å¼€ä¼ å…¥å‡½æ•°ã€‚</li>
</ol>
</li>
</ul>
<pre><code class="hljs language-js" lang="js">fn.<span class="hljs-title function_">apply</span>(obj, [agr1,agr2,arg3,arg4,.....])
</code></pre>
<h3 data-id="heading-4">3. bind()</h3>
<ul>
<li><strong>ä½œç”¨</strong>ï¼šä¿®æ”¹å‡½æ•°çš„ <code>this</code> æŒ‡å‘ï¼Œä½†<strong>ä¸ä¼šç«‹å³æ‰§è¡Œ</strong>ã€‚</li>
<li><strong>è¿”å›å€¼</strong>ï¼šè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼ˆç§°ä¸ºç»‘å®šå‡½æ•°ï¼‰ã€‚</li>
<li><strong>ç¡¬ç»‘å®š</strong>ï¼š<code>bind</code> è¿”å›çš„æ–°å‡½æ•°ï¼Œå…¶ <code>this</code> æŒ‡å‘ä¸€æ—¦è¢«ç»‘å®šï¼Œåç»­å†ä½¿ç”¨ <code>call</code> æˆ– <code>apply</code> éƒ½æ— æ³•å†æ¬¡ä¿®æ”¹ã€‚</li>
<li><strong>å‚æ•°</strong>ï¼šä¸ <code>call</code> ç›¸åŒï¼Œæ¥å—å‚æ•°åˆ—è¡¨ã€‚æ”¯æŒ<strong>æŸ¯é‡ŒåŒ–</strong>ï¼ˆé¢„è®¾éƒ¨åˆ†å‚æ•°ï¼‰ã€‚</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">bind</span>(thisArg, arg1, arg2, arg3, ...)
</code></pre>
<h2 data-id="heading-5">äºŒã€ æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”ï¼ˆä¸€å¼ è¡¨çœ‹æ‡‚ï¼‰</h2>

































<table><thead><tr><th><strong>æ–¹æ³•</strong></th><th><strong>æ‰§è¡Œæ—¶æœº</strong></th><th><strong>å‚æ•°æ ¼å¼</strong></th><th><strong>è¿”å›å€¼</strong></th><th><strong>æ ¸å¿ƒåœºæ™¯</strong></th></tr></thead><tbody><tr><td><strong>call</strong></td><td><strong>ç«‹å³æ‰§è¡Œ</strong></td><td>å‚æ•°åˆ—è¡¨ (arg1, arg2)</td><td>å‡½æ•°æ‰§è¡Œç»“æœ</td><td>å¯¹è±¡ç»§æ‰¿ã€å€Ÿç”¨æ–¹æ³•</td></tr><tr><td><strong>apply</strong></td><td><strong>ç«‹å³æ‰§è¡Œ</strong></td><td><strong>æ•°ç»„</strong> ([arg1, arg2])</td><td>å‡½æ•°æ‰§è¡Œç»“æœ</td><td>æ•°å­¦è®¡ç®—ã€æ•°ç»„åˆå¹¶</td></tr><tr><td><strong>bind</strong></td><td><strong>ç¨åæ‰§è¡Œ</strong></td><td>å‚æ•°åˆ—è¡¨ (arg1, arg2)</td><td><strong>æ–°å‡½æ•°</strong></td><td>äº‹ä»¶ç»‘å®šã€å›è°ƒå‡½æ•°</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-6">ä¸‰ã€ ä»£ç å®æˆ˜ä¸çº é”™</h2>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç»å…¸çš„ä¾‹å­æ¥çœ‹å®ƒä»¬çš„å…·ä½“è¡¨ç°ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Original'</span>,
  <span class="hljs-attr">fn</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>, a, b);
  }
}

<span class="hljs-keyword">const</span> db = { <span class="hljs-attr">name</span>: <span class="hljs-string">'DataBase'</span> };

<span class="hljs-comment">// 1. åŸå§‹è°ƒç”¨</span>
obj.<span class="hljs-title function_">fn</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>); 
<span class="hljs-comment">// è¾“å‡º: "Original" 1 2</span>

<span class="hljs-comment">// 2. call è°ƒç”¨ï¼šä¼ å‚åˆ—è¡¨</span>
obj.<span class="hljs-property">fn</span>.<span class="hljs-title function_">call</span>(db, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>); 
<span class="hljs-comment">// è¾“å‡º: "DataBase" 3 4</span>

<span class="hljs-comment">// 3. apply è°ƒç”¨ï¼šä¼ å‚æ•°ç»„</span>
obj.<span class="hljs-property">fn</span>.<span class="hljs-title function_">apply</span>(db, [<span class="hljs-number">5</span>, <span class="hljs-number">6</span>]); 
<span class="hljs-comment">// è¾“å‡º: "DataBase" 5 6</span>

<span class="hljs-comment">// 4. bind è°ƒç”¨ï¼šè¿”å›æ–°å‡½æ•°ï¼Œæ‰‹åŠ¨æ‰§è¡Œ</span>
<span class="hljs-keyword">const</span> boundFn = obj.<span class="hljs-property">fn</span>.<span class="hljs-title function_">bind</span>(db, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>);
<span class="hljs-title function_">boundFn</span>(); 
<span class="hljs-comment">// è¾“å‡º: "DataBase" 7 8</span>

<span class="hljs-comment">// 5. bind çš„è¿ç»­ä¿®æ”¹æ— æ•ˆæ€§ï¼ˆé¢è¯•å‘ç‚¹ï¼‰</span>
<span class="hljs-keyword">const</span> doubleBind = obj.<span class="hljs-property">fn</span>.<span class="hljs-title function_">bind</span>(db).<span class="hljs-title function_">bind</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'Error'</span> });
<span class="hljs-title function_">doubleBind</span>();
<span class="hljs-comment">// è¾“å‡º: "DataBase" undefined undefined (ç¬¬äºŒæ¬¡ bind æ— æ•ˆ)</span>
</code></pre>
<hr/>
<h2 data-id="heading-7">å››ã€ å¸¸è§åº”ç”¨åœºæ™¯ï¼ˆé¢è¯•åŠ åˆ†é¡¹ï¼‰</h2>
<p>ä»…ä»…çŸ¥é“è¯­æ³•æ˜¯ä¸å¤Ÿçš„ï¼Œé¢è¯•å®˜æ›´çœ‹é‡ä½ çŸ¥é“æ€ä¹ˆç”¨ã€‚</p>
<h3 data-id="heading-8">1. æ•°ç»„æ±‚æœ€å¤§å€¼ (apply)</h3>
<p>åˆ©ç”¨ <code>apply</code> æ¥å—æ•°ç»„å‚æ•°çš„ç‰¹æ€§ï¼Œç»“åˆ <code>Math.max</code>ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> nums = [<span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">1</span>];
<span class="hljs-keyword">const</span> max = <span class="hljs-title class_">Math</span>.<span class="hljs-property">max</span>.<span class="hljs-title function_">apply</span>(<span class="hljs-literal">null</span>, nums); <span class="hljs-comment">// 20</span>
<span class="hljs-comment">// ES6 å†™æ³•: Math.max(...nums)</span>
</code></pre>
<h3 data-id="heading-9">2. ç±»æ•°ç»„è½¬æ•°ç»„ (call)</h3>
<p>åˆ©ç”¨ <code>call</code> å€Ÿç”¨æ•°ç»„çš„ <code>slice</code> æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">func</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> args = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">slice</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(args); <span class="hljs-comment">// å˜æˆäº†çœŸæ•°ç»„</span>
}
</code></pre>
<h3 data-id="heading-10">3. React/Vue ä¸­çš„äº‹ä»¶ç»‘å®š (bind)</h3>
<p>é˜²æ­¢å›è°ƒå‡½æ•°åœ¨æ‰§è¡Œæ—¶ <code>this</code> ä¸¢å¤±ï¼ˆæŒ‡å‘ <code>undefined</code> æˆ– <code>window</code>ï¼‰ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-variable language_">this</span>.<span class="hljs-property">handleClick</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleClick</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);
</code></pre>
<hr/>
<h2 data-id="heading-11">äº”ã€ é¢è¯•æ¨¡æ‹Ÿé¢˜</h2>
<h3 data-id="heading-12">Q1ï¼š<code>call</code> å’Œ <code>apply</code> çš„å”¯ä¸€åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>å‚è€ƒå›ç­”ï¼š</p>
<p>å®ƒä»¬çš„å”¯ä¸€åŒºåˆ«åœ¨äºä¼ å‚æ–¹å¼ã€‚call éœ€è¦æŠŠå‚æ•°æŒ‰é¡ºåºä¸€ä¸ªä¸ªä¼ è¿›å»ï¼ˆå‚æ•°åˆ—è¡¨ï¼‰ï¼Œè€Œ apply éœ€è¦æŠŠå‚æ•°æ”¾åœ¨ä¸€ä¸ªæ•°ç»„ï¼ˆæˆ–ç±»æ•°ç»„ï¼‰é‡Œä¼ è¿›å»ã€‚åŠ©è®°å£è¯€ï¼š"a" for array (apply), "c" for comma (call)ã€‚</p>
<h3 data-id="heading-13">Q2ï¼šä¸ºä»€ä¹ˆ <code>bind</code> è¿”å›çš„å‡½æ•°ï¼Œå†æ¬¡ä½¿ç”¨ <code>call</code> æ— æ³•ä¿®æ”¹ <code>this</code>ï¼Ÿ</h3>
<p>å‚è€ƒå›ç­”ï¼š</p>
<p>è¿™æ¶‰åŠ bind çš„å†…éƒ¨å®ç°ã€‚bind è¿”å›çš„å‡½æ•°å†…éƒ¨å·²ç»é€šè¿‡é—­åŒ…é”å®šäº† thisï¼ˆé€šå¸¸ç§°ä¸ºç¡¬ç»‘å®šï¼‰ã€‚ä¹Ÿå°±æ˜¯ç±»ä¼¼ <code>return function() { return originalFn.apply(that, arguments) }</code> çš„ç»“æ„ã€‚æ— è®ºå¤–éƒ¨æ€ä¹ˆ callï¼Œå†…éƒ¨çš„ apply æ°¸è¿œä½¿ç”¨çš„æ˜¯ç¬¬ä¸€æ¬¡ç»‘å®šçš„ thatã€‚</p>
<h3 data-id="heading-14">Q3ï¼šæ‰‹å†™ä¸€ä¸ªç®€å•çš„ <code>bind</code>ï¼Ÿ</h3>
<pre><code class="hljs language-JavaScript" lang="JavaScript">      <span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myBind</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">context, ...args</span>) {
        <span class="hljs-comment">// 1. ä¿å­˜å½“å‰çš„å‡½æ•°ï¼ˆthis æŒ‡å‘åŸå‡½æ•°ï¼‰</span>
        <span class="hljs-keyword">const</span> fn = <span class="hljs-variable language_">this</span>;
        <span class="hljs-comment">// 2. è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">...innerArgs</span>) {
          <span class="hljs-comment">// 3. å°†é¢„è®¾å‚æ•°å’Œæ–°å‚æ•°åˆå¹¶ï¼Œå¹¶ç”¨ apply æ‰§è¡ŒåŸå‡½æ•°</span>
          <span class="hljs-keyword">return</span> fn.<span class="hljs-title function_">apply</span>(context, args.<span class="hljs-title function_">concat</span>(innerArgs));
        };
      };
      <span class="hljs-keyword">const</span> obj = {
        <span class="hljs-attr">name</span>: <span class="hljs-string">"Original"</span>,
        <span class="hljs-attr">fn</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">a, b</span>) {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>, a, b);
        },
      };
      <span class="hljs-keyword">const</span> boundFn = obj.<span class="hljs-property">fn</span>.<span class="hljs-title function_">myBind</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'DataBase'</span> }, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>);
      <span class="hljs-title function_">boundFn</span>();
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä» Generator åˆ° Async/Awaitï¼šå½»åº•ææ‡‚ JS å¼‚æ­¥ç¼–ç¨‹çš„ç»ˆæè§£å†³æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7595886887523565608</link>    <guid>https://juejin.cn/post/7595886887523565608</guid>    <pubDate>2026-01-17T14:24:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595886887523565608" data-draft-id="7595893785907167266" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä» Generator åˆ° Async/Awaitï¼šå½»åº•ææ‡‚ JS å¼‚æ­¥ç¼–ç¨‹çš„ç»ˆæè§£å†³æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-01-17T14:24:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="NEXT06"/> <meta itemprop="url" content="https://juejin.cn/user/1176918763246011"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä» Generator åˆ° Async/Awaitï¼šå½»åº•ææ‡‚ JS å¼‚æ­¥ç¼–ç¨‹çš„ç»ˆæè§£å†³æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1176918763246011/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    NEXT06
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T14:24:21.000Z" title="Sat Jan 17 2026 14:24:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    11
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ JavaScript çš„å‘å±•é•¿æ²³ä¸­ï¼Œå¼‚æ­¥ç¼–ç¨‹ä¸€ç›´æ˜¯å¼€å‘è€…æœ€å¤´ç–¼çš„ç—›ç‚¹ä¹‹ä¸€ã€‚ä»æœ€æ—©çš„å›è°ƒå‡½æ•°ï¼Œåˆ° Promise çš„é“¾å¼è°ƒç”¨ï¼Œå†åˆ°å¦‚ä»Šçš„ Async/Awaitï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨è¿½æ±‚ä¸€ä¸ªç»ˆæç›®æ ‡ï¼š<strong>ç”¨åŒæ­¥çš„æ€ç»´ï¼Œå†™å¼‚æ­¥çš„ä»£ç ã€‚</strong></p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬ä¸è°ˆæ¯ç‡¥çš„ API æ–‡æ¡£ï¼Œè€Œæ˜¯æ·±å…¥åº•å±‚ï¼Œä» Generator åŸç†å‡ºå‘ï¼Œå½»åº•ææ‡‚ä¸ºä»€ä¹ˆÂ Async/AwaitÂ è¢«ç§°ä¸º JS å¼‚æ­¥ç¼–ç¨‹çš„â€œç»ˆæè§£å†³æ–¹æ¡ˆâ€ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦ Async/Awaitï¼Ÿ</h2>
<p>è¦ç†è§£ä¸€é¡¹æŠ€æœ¯ï¼Œå¿…é¡»å…ˆç†è§£å®ƒè¦è§£å†³çš„é—®é¢˜ã€‚</p>
<h3 data-id="heading-1">1. å›è°ƒåœ°ç‹±ï¼ˆCallback Hellï¼‰çš„æ¢¦é­‡</h3>
<p>åœ¨ ES6 ä¹‹å‰ï¼Œå¼‚æ­¥æ“ä½œä¸¥é‡ä¾èµ–å›è°ƒå‡½æ•°ã€‚ä¸€æ—¦ä¸šåŠ¡é€»è¾‘å¤æ‚ï¼Œæ¯”å¦‚éœ€è¦ä¸²è¡Œè¯·æ±‚ Aã€Bã€C ä¸‰ä¸ªæ¥å£ï¼Œä»£ç å°±ä¼šå˜æˆè¿™æ ·ï¼š</p>
<p>JavaScript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">getData</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">a</span>) {
    <span class="hljs-title function_">getMoreData</span>(a, <span class="hljs-keyword">function</span>(<span class="hljs-params">b</span>) {
        <span class="hljs-title function_">getEvenMoreData</span>(b, <span class="hljs-keyword">function</span>(<span class="hljs-params">c</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(c); <span class="hljs-comment">// è‘—åçš„â€œé‡‘å­—å¡”â€ä»£ç </span>
        });
    });
});
</code></pre>
<p>è¿™ç§ä»£ç <strong>å¯è¯»æ€§å·®ã€éš¾ä»¥è°ƒè¯•ã€ä¸”é”™è¯¯å¤„ç†æå…¶ç¹ç</strong>ã€‚</p>
<h3 data-id="heading-2">2. Promise çš„è¿›æ­¥ä¸å±€é™</h3>
<p>Promise çš„å‡ºç°å°†å›è°ƒåµŒå¥—æ‰å¹³åŒ–äº†ï¼Œå®ƒé€šè¿‡é“¾å¼è°ƒç”¨ï¼ˆ.then()ï¼‰è§£å†³äº†â€œé‡‘å­—å¡”â€é—®é¢˜ï¼š</p>
<p>JavaScript</p>
<pre><code class="hljs language-ini" lang="ini">getData()
  .then(<span class="hljs-attr">a</span> =&gt; getMoreData(a))
  .then(<span class="hljs-attr">b</span> =&gt; getEvenMoreData(b))
  .catch(<span class="hljs-attr">err</span> =&gt; console.error(err))<span class="hljs-comment">;</span>
</code></pre>
<p>è¿™æ— ç–‘æ˜¯å·¨å¤§çš„è¿›æ­¥ã€‚ä½†å®ƒä¾ç„¶ä¸å¤Ÿå®Œç¾ï¼šå¤§é‡çš„Â .thenÂ ç ´åäº†ä»£ç çš„è¯­ä¹‰è¿ç»­æ€§ï¼Œæˆ‘ä»¬ä¾ç„¶æ— æ³•åƒå†™åŒæ­¥ä»£ç é‚£æ ·ç›´è§‚åœ°è¡¨è¾¾é€»è¾‘ã€‚</p>
<p><strong>æˆ‘ä»¬çš„ç»ˆæè¯‰æ±‚æ˜¯</strong>ï¼šèƒ½å¦è®©å¼‚æ­¥ä»£ç çœ‹èµ·æ¥å°±åƒÂ const a = logic(); const b = logic(a);Â è¿™æ ·ç¬¦åˆäººç±»çº¿æ€§ç›´è§‰ï¼Ÿ</p>
<p>ç­”æ¡ˆå°±æ˜¯Â <strong>Async/Await</strong>ã€‚</p>
<h2 data-id="heading-3">äºŒã€ æ ¸å¿ƒåŸç†ï¼šå¹¶éé­”æ³•ï¼Œè€Œæ˜¯è¯­æ³•ç³–</h2>
<p>Async/Await å¹¶æ²¡æœ‰å¼•å…¥å…¨æ–°çš„åº•å±‚æœºåˆ¶ï¼Œå®ƒæœ¬è´¨ä¸Šæ˜¯Â <strong>Generator å‡½æ•° + Promise + è‡ªåŠ¨æ‰§è¡Œå™¨</strong>Â çš„è¯­æ³•ç³–ã€‚</p>
<p>è¦ç†è§£å®ƒï¼Œå¿…é¡»ç†è§£Â <strong>Generatorï¼ˆç”Ÿæˆå™¨ï¼‰</strong> Â çš„æ ¸å¿ƒèƒ½åŠ›ï¼š<strong>æš‚åœä¸æ¢å¤</strong>ã€‚</p>
<h3 data-id="heading-4">1. Generatorï¼šäº¤å‡ºæ‰§è¡Œæƒ</h3>
<p>Generator å‡½æ•°ï¼ˆfunction*ï¼‰é€šè¿‡Â yieldÂ å…³é”®å­—ï¼Œå¯ä»¥è®©å‡½æ•°åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­<strong>æš‚åœ</strong>ï¼Œå°† CPU æ§åˆ¶æƒäº¤è¿˜ç»™å¤–éƒ¨ï¼Œå¹¶åœ¨æœªæ¥æŸä¸ªæ—¶åˆ»ä»æ–­ç‚¹å¤„<strong>æ¢å¤</strong>æ‰§è¡Œã€‚</p>
<p>JavaScript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span>* <span class="hljs-title function_">generatorFn</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Start'</span>);
    <span class="hljs-comment">// 1. å‡½æ•°æ‰§è¡Œåˆ°è¿™é‡Œæš‚åœï¼Œäº¤å‡ºæ§åˆ¶æƒï¼Œå¹¶è¿”å› 'Hello'</span>
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">yield</span> <span class="hljs-string">'Hello'</span>; 
    <span class="hljs-comment">// 3. å¤–éƒ¨è°ƒç”¨ next(val) åï¼Œå‡½æ•°ä»è¿™é‡Œæ¢å¤ï¼Œresult æ¥æ”¶å¤–éƒ¨ä¼ å…¥çš„å€¼</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Resumed with:'</span>, result); 
}

<span class="hljs-keyword">const</span> iterator = <span class="hljs-title function_">generatorFn</span>();
<span class="hljs-keyword">const</span> first = iterator.<span class="hljs-title function_">next</span>(); <span class="hljs-comment">// è¾“å‡º: Start, first.value = 'Hello'</span>
<span class="hljs-comment">// 2. è¿™é‡Œå¯ä»¥åšä»»ä½•å¼‚æ­¥æ“ä½œ...</span>
iterator.<span class="hljs-title function_">next</span>(<span class="hljs-string">'World'</span>);        <span class="hljs-comment">// è¾“å‡º: Resumed with: World</span>
</code></pre>
<h3 data-id="heading-5">2. Async/Await çš„å®ç°å…¬å¼</h3>
<p>å¦‚æœæˆ‘ä»¬å°† Generator å’Œ Promise ç»“åˆèµ·æ¥ï¼Œå°±å¾—åˆ°äº† Async/Await çš„é›å½¢ï¼š</p>
<ol>
<li><strong>æš‚åœ</strong>ï¼šé‡åˆ°Â awaitÂ (å³Â yield)ï¼Œå‡½æ•°æš‚åœæ‰§è¡Œã€‚</li>
<li><strong>ç­‰å¾…</strong>ï¼šawaitÂ åé¢é€šå¸¸è·Ÿç€ä¸€ä¸ª Promiseï¼ˆå¼‚æ­¥çŠ¶æ€å®¹å™¨ï¼‰ã€‚</li>
<li><strong>æ¢å¤</strong>ï¼šå½“ Promise çŠ¶æ€å˜ä¸º Resolvedï¼Œè‡ªåŠ¨æ‰§è¡Œå™¨è°ƒç”¨Â next(data)ï¼Œå°†ç»“æœä¼ å›å‡½æ•°å†…éƒ¨ï¼Œä»£ç ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚</li>
</ol>
<blockquote>
<p><strong>å…¬å¼æ€»ç»“</strong>ï¼š<br/>
async functionÂ â‰ˆÂ function*Â + è‡ªåŠ¨æ‰§è¡Œå™¨ï¼ˆè‡ªåŠ¨å¤„ç† yield å’Œ nextï¼‰</p>
</blockquote>
<h2 data-id="heading-6">ä¸‰ã€ å®æˆ˜ï¼šä»é”™è¯¯ç¤ºèŒƒåˆ°æœ€ä½³å®è·µ</h2>
<p>åŸºäºå¤§å®¶æä¾›çš„ç´ æï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹åœ¨æµè§ˆå™¨å’Œ Node.js ç¯å¢ƒä¸‹ï¼Œå¦‚ä½•æ­£ç¡®ä½¿ç”¨ Async/Awaitï¼ˆåŒ…å«å¯¹åŸå§‹ç´ æä¸­é”™è¯¯çš„ä¿®æ­£ï¼‰ã€‚</p>
<h3 data-id="heading-7">åœºæ™¯ä¸€ï¼šæµè§ˆå™¨ç«¯ Fetch è¯·æ±‚</h3>
<p>åŸå§‹ç´ æä¸­ç›´æ¥Â console.log(res)Â æ˜¯æ‹¿ä¸åˆ°æ•°æ®çš„ï¼Œå› ä¸ºÂ fetchÂ è¿”å›çš„ Response å¯¹è±¡è§£æ JSON ä¹Ÿæ˜¯å¼‚æ­¥çš„ã€‚</p>
<p><strong>æœ€ä½³å®è·µï¼š</strong></p>
<p>Html</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// ES8 async ä¿®é¥°å‡½æ•°</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">main</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¼€å§‹è¯·æ±‚...'</span>);
        
        <span class="hljs-comment">// 1. await ç­‰å¾… fetch å®Œæˆï¼Œæ‹¿åˆ°å“åº”å¤´</span>
        <span class="hljs-comment">// è¿™é‡Œçš„ await ç›¸å½“äºæš‚åœå‡½æ•°ï¼Œç›´åˆ°ç½‘ç»œè¯·æ±‚è¿”å›</span>
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://api.github.com/users/shunwuyu/repos'</span>);
        
        <span class="hljs-comment">// 2. æ³¨æ„ï¼è§£æ JSON ä¹Ÿæ˜¯å¼‚æ­¥æ“ä½œï¼Œå¿…é¡»å†æ¬¡ await</span>
        <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
        
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•°æ®è·å–æˆåŠŸ:'</span>, data);
    } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-comment">// åŒæ­¥å†™æ³•çš„æœ€å¤§ä¼˜åŠ¿ï¼šå¯ä»¥ç›´æ¥ç”¨ try-catch æ•è·å¼‚æ­¥é”™è¯¯</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è¯·æ±‚å¤±è´¥:'</span>, error);
    }
}
<span class="hljs-title function_">main</span>();
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 data-id="heading-8">åœºæ™¯äºŒï¼šNode.js æ–‡ä»¶è¯»å–</h3>
<p>åœ¨ç°ä»£ Node.js ä¸­ï¼Œæˆ‘ä»¬å¸¸ç”¨Â fs/promisesã€‚</p>
<p><strong>ä¿®æ­£åçš„æœ€ä½³å®è·µï¼š</strong></p>
<p>JavaScript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">'fs/promises'</span>; <span class="hljs-comment">// å¼•å…¥è¿”å› Promise çš„ fs æ¨¡å—</span>
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">'path'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">main</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">const</span> filePath = <span class="hljs-string">'./1.html'</span>;
    
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// åƒå†™åŒæ­¥ä»£ç ä¸€æ ·è¯»å–æ–‡ä»¶</span>
        <span class="hljs-comment">// ç”šè‡³ä¸éœ€è¦å›è°ƒå‡½æ•°ï¼Œä¹Ÿä¸éœ€è¦ .then</span>
        <span class="hljs-keyword">const</span> html = <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">readFile</span>(filePath, <span class="hljs-string">'utf-8'</span>);
        
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ–‡ä»¶è¯»å–æˆåŠŸï¼Œé•¿åº¦:'</span>, html.<span class="hljs-property">length</span>);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(html.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, <span class="hljs-number">50</span>) + <span class="hljs-string">'...'</span>); <span class="hljs-comment">// æ‰“å°å‰50ä¸ªå­—ç¬¦</span>
        
    } <span class="hljs-keyword">catch</span> (err) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ–‡ä»¶è¯»å–å‡ºé”™:'</span>, err);
    }
}

<span class="hljs-title function_">main</span>();
</code></pre>
<h2 data-id="heading-9">å››ã€ æ€»ç»“</h2>
<p>Async/Await çš„å‡ºç°ï¼Œæ ‡å¿—ç€ JavaScript å¼‚æ­¥ç¼–ç¨‹çš„æˆç†Ÿã€‚</p>
<ol>
<li>å®ƒåˆ©ç”¨Â <strong>Generator</strong>Â å®ç°äº†å‡½æ•°çš„æš‚åœä¸æ¢å¤ã€‚</li>
<li>å®ƒåˆ©ç”¨Â <strong>Promise</strong>Â å°è£…äº†å¼‚æ­¥æ“ä½œçš„çŠ¶æ€ã€‚</li>
<li>å®ƒé€šè¿‡Â <strong>è‡ªåŠ¨æ‰§è¡Œ</strong>Â æœºåˆ¶ï¼Œè®©æˆ‘ä»¬èƒ½ä»¥ç¬¦åˆç›´è§‰çš„çº¿æ€§é€»è¾‘ç¼–å†™å¤æ‚çš„å¼‚æ­¥ä»£ç ã€‚</li>
</ol>
<p>æŒæ¡äº† Async/Awaitï¼Œä¸ä»…ä»…æ˜¯æŒæ¡äº†ä¸€ä¸ªå…³é”®å­—ï¼Œæ›´æ˜¯æŒæ¡äº† JavaScript åç¨‹æ§åˆ¶çš„ç²¾é«“ã€‚æ‹’ç»å›è°ƒåœ°ç‹±ï¼Œä»ä»Šå¤©å¼€å§‹ã€‚</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JS-new æ“ä½œç¬¦]]></title>    <link>https://juejin.cn/post/7596025264455712804</link>    <guid>https://juejin.cn/post/7596025264455712804</guid>    <pubDate>2026-01-17T14:26:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596025264455712804" data-draft-id="7595994039108943908" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JS-new æ“ä½œç¬¦"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-01-17T14:26:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‘ç°ä¸€åªå¤§å‘†ç“œ"/> <meta itemprop="url" content="https://juejin.cn/user/180747382561607"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JS-new æ“ä½œç¬¦
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/180747382561607/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‘ç°ä¸€åªå¤§å‘†ç“œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T14:26:08.000Z" title="Sat Jan 17 2026 14:26:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>åœ¨ JavaScript é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œ<code>new</code> å…³é”®å­—æ˜¯å®ä¾‹åŒ–å¯¹è±¡çš„æ ¸å¿ƒã€‚é¢è¯•å®˜å¸¸å¸¸é€šè¿‡â€œæ‰‹å†™ newâ€æ¥è€ƒå¯Ÿä½ å¯¹<strong>åŸå‹é“¾</strong>ã€<strong>this ç»‘å®š</strong>ä»¥åŠ<strong>æ„é€ å‡½æ•°è¿”å›å€¼</strong>çš„ç†è§£ã€‚æœ¬æ–‡å°†å¸¦ä½ ä»åŸç†åˆ°å®ç°ï¼Œå½»åº•ææ‡‚ <code>new</code> èƒŒåçš„é­”æ³•ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ <code>new</code> åˆ°åº•å¹²äº†ä»€ä¹ˆï¼Ÿ</h2>
<p>å½“æˆ‘ä»¬ä½¿ç”¨ <code>new Person()</code> æ—¶ï¼ŒJS å¼•æ“åœ¨èƒŒåé»˜é»˜æ‰§è¡Œäº†ä»¥ä¸‹ <strong>4 ä¸ªæ­¥éª¤</strong>ï¼š</p>
<ol>
<li>
<p><strong>åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡</strong>ï¼šåœ¨å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºå¯¹è±¡ï¼ˆä¾‹å¦‚ <code>obj = {}</code>ï¼‰ã€‚</p>
</li>
<li>
<p><strong>é“¾æ¥åŸå‹</strong>ï¼šå°†æ–°å¯¹è±¡çš„ <code>__proto__</code> å±æ€§æŒ‡å‘æ„é€ å‡½æ•°çš„ <code>prototype</code>ï¼Œä»è€Œå®ç°åŸå‹ç»§æ‰¿ï¼ˆè®©å®ä¾‹èƒ½è®¿é—®åŸå‹ä¸Šçš„æ–¹æ³•ï¼‰ã€‚</p>
</li>
<li>
<p><strong>ç»‘å®š this</strong>ï¼šå°†æ„é€ å‡½æ•°å†…éƒ¨çš„ <code>this</code> ç»‘å®šåˆ°è¿™ä¸ªæ–°å¯¹è±¡ä¸Šï¼Œå¹¶æ‰§è¡Œæ„é€ å‡½æ•°ï¼ˆä¸ºæ–°å¯¹è±¡æ·»åŠ å±æ€§ï¼‰ã€‚</p>
</li>
<li>
<p><strong>è¿”å›å¯¹è±¡</strong>ï¼š</p>
<ul>
<li>å¦‚æœæ„é€ å‡½æ•°æ˜¾å¼è¿”å›äº†ä¸€ä¸ª<strong>å¯¹è±¡</strong>ï¼ˆæˆ–å‡½æ•°ï¼‰ï¼Œåˆ™è¿”å›è¯¥ç»“æœã€‚</li>
<li>å¦‚æœæ„é€ å‡½æ•°æ²¡æœ‰è¿”å›å¯¹è±¡ï¼ˆè¿”å›åŸºæœ¬ç±»å‹æˆ–æ— è¿”å›å€¼ï¼‰ï¼Œåˆ™è¿”å›æ­¥éª¤ 1 åˆ›å»ºçš„<strong>æ–°å¯¹è±¡</strong>ã€‚</li>
</ul>
</li>
</ol>
<h2 data-id="heading-2">äºŒã€ æ‰‹å†™ <code>myNew</code> å®ç°</h2>
<p>æ ¹æ®ä¸Šè¿°åŸç†ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªè‡ªå·±çš„ <code>myNew</code> å‡½æ•°ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">/**
 * æ‰‹å†™ new æ“ä½œç¬¦
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} Constructor æ„é€ å‡½æ•°
 * <span class="hljs-doctag">@param</span>  {<span class="hljs-type">...any</span>} args ä¼ é€’çš„å‚æ•°
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">myNew</span>(<span class="hljs-params">Constructor, ...args</span>) {
  <span class="hljs-comment">// 1. åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¹¶å°†å…¶åŸå‹æŒ‡å‘æ„é€ å‡½æ•°çš„ prototype</span>
  <span class="hljs-keyword">const</span> obj = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);

  <span class="hljs-comment">// 2. å°†æ„é€ å‡½æ•°çš„ this ç»‘å®šåˆ°æ–°å¯¹è±¡ä¸Šï¼Œå¹¶æ‰§è¡Œæ„é€ å‡½æ•°</span>
  <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">apply</span>(obj, args);

  <span class="hljs-comment">// 3. å¤„ç†è¿”å›å€¼é€»è¾‘ (è¿™æ˜¯é¢è¯•ä¸­æœ€å®¹æ˜“å¿½è§†çš„ç»†èŠ‚ï¼)</span>
  <span class="hljs-comment">// å¦‚æœæ„é€ å‡½æ•°è¿”å›çš„æ˜¯å¯¹è±¡(ä¸ä¸ºnull)æˆ–å‡½æ•°ï¼Œåˆ™è¿”å›è¯¥ç»“æœï¼›å¦åˆ™è¿”å›æ–°åˆ›å»ºçš„ obj</span>
  <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">typeof</span> result === <span class="hljs-string">'object'</span> &amp;&amp; result !== <span class="hljs-literal">null</span>) || <span class="hljs-keyword">typeof</span> result === <span class="hljs-string">'function'</span>) {
    <span class="hljs-keyword">return</span> result;
  }
  
  <span class="hljs-comment">// 4. è¿”å›æ–°å¯¹è±¡</span>
  <span class="hljs-keyword">return</span> obj;
}
</code></pre>
<h3 data-id="heading-3">æµ‹è¯•ç”¨ä¾‹ï¼š</h3>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name, age</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
  <span class="hljs-comment">// æƒ…å†µ 1: æ²¡æœ‰è¿”å›å€¼ï¼ˆé»˜è®¤è¿”å› thisï¼‰</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Student</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-comment">// æƒ…å†µ 2: è¿”å›ä¸€ä¸ªå¯¹è±¡</span>
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">name</span>: <span class="hljs-string">'Special Student'</span>, <span class="hljs-attr">grade</span>: <span class="hljs-number">100</span> };
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">NumberObj</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">a</span> = <span class="hljs-number">1</span>;
  <span class="hljs-comment">// æƒ…å†µ 3: è¿”å›ä¸€ä¸ªåŸºæœ¬ç±»å‹</span>
  <span class="hljs-keyword">return</span> <span class="hljs-number">123</span>;
}

<span class="hljs-comment">// æµ‹è¯• 1ï¼šæ­£å¸¸æƒ…å†µ</span>
<span class="hljs-keyword">const</span> per = <span class="hljs-title function_">myNew</span>(<span class="hljs-title class_">Person</span>, <span class="hljs-string">'Ouyang'</span>, <span class="hljs-number">23</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(per); <span class="hljs-comment">// Person { name: 'Ouyang', age: 23 }</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(per <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Person</span>); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// æµ‹è¯• 2ï¼šæ„é€ å‡½æ•°è¿”å›å¯¹è±¡</span>
<span class="hljs-keyword">const</span> stu = <span class="hljs-title function_">myNew</span>(<span class="hljs-title class_">Student</span>, <span class="hljs-string">'XiaoMing'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(stu); <span class="hljs-comment">// { name: 'Special Student', grade: 100 } (this è¢«å¿½ç•¥äº†)</span>

<span class="hljs-comment">// æµ‹è¯• 3ï¼šæ„é€ å‡½æ•°è¿”å›åŸºæœ¬ç±»å‹</span>
<span class="hljs-keyword">const</span> num = <span class="hljs-title function_">myNew</span>(<span class="hljs-title class_">NumberObj</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num); <span class="hljs-comment">// NumberObj { a: 1 } (è¿”å›å€¼ 123 è¢«å¿½ç•¥)</span>
</code></pre>
<hr/>
<h2 data-id="heading-4">ä¸‰ã€ æ·±åº¦è§£æï¼šè¿”å›å€¼é™·é˜±</h2>
<p>è¿™æ˜¯é¢è¯•ä¸­æœ€å¸¸æŒ–çš„å‘ã€‚</p>
<ul>
<li>
<p><strong>åœºæ™¯ A</strong>ï¼šæ„é€ å‡½æ•°å†…éƒ¨æ²¡æœ‰ <code>return</code>ï¼Œæˆ–è€… <code>return</code> ä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹ï¼ˆNumber, String, Boolean, null, undefinedï¼‰ã€‚</p>
<ul>
<li><strong>ç»“æœ</strong>ï¼š<code>new</code> æ“ä½œç¬¦ä¼šå¿½ç•¥è¿™ä¸ªè¿”å›å€¼ï¼Œç›´æ¥è¿”å›<strong>æ–°åˆ›å»ºçš„å®ä¾‹å¯¹è±¡</strong>ã€‚</li>
</ul>
</li>
<li>
<p><strong>åœºæ™¯ B</strong>ï¼šæ„é€ å‡½æ•°å†…éƒ¨ <code>return</code> ä¸€ä¸ªå¼•ç”¨ç±»å‹ï¼ˆObject, Array, Functionï¼‰ã€‚</p>
<ul>
<li><strong>ç»“æœ</strong>ï¼š<code>new</code> æ“ä½œç¬¦ä¼šç›´æ¥è¿”å›è¿™ä¸ª<strong>å¼•ç”¨ç±»å‹</strong>ï¼Œæ–°åˆ›å»ºçš„å®ä¾‹å¯¹è±¡ä¼šè¢«ä¸¢å¼ƒï¼ˆä¸” <code>this</code> ä¸Šçš„å±æ€§èµ‹å€¼ä¹Ÿä¼šå¤±æ•ˆï¼‰ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-5">å››ã€ é¢è¯•æ¨¡æ‹Ÿé¢˜ï¼ˆæŒ‘æˆ˜ä¸€ä¸‹ï¼‰</h2>
<h3 data-id="heading-6">Q1ï¼š<code>Object.create()</code> å’Œ <code>new</code> æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3>
<p><strong>å‚è€ƒå›ç­”ï¼š</strong></p>
<ul>
<li><code>new</code>ï¼šä¸ä»…åˆ›å»ºæ–°å¯¹è±¡å¹¶ç»§æ‰¿åŸå‹ï¼Œè¿˜ä¼š<strong>æ‰§è¡Œæ„é€ å‡½æ•°</strong>ï¼Œè¿›è¡Œå±æ€§åˆå§‹åŒ–ã€‚</li>
<li><code>Object.create()</code>ï¼šåªè´Ÿè´£åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡å¹¶ç»§æ‰¿åŸå‹ï¼Œ<strong>ä¸ä¼šæ‰§è¡Œæ„é€ å‡½æ•°</strong>ã€‚</li>
</ul>
<h3 data-id="heading-7">Q2ï¼šä¸ºä»€ä¹ˆä»£ç ä¸­å»ºè®®ä½¿ç”¨ <code>Object.create</code> è€Œä¸æ˜¯ <code>obj.__proto__</code>ï¼Ÿ</h3>
<p><strong>å‚è€ƒå›ç­”ï¼š</strong> <code>__proto__</code> æ˜¯éæ ‡å‡†å±æ€§ï¼ˆè™½ç„¶æµè§ˆå™¨æ”¯æŒï¼‰ï¼Œç›´æ¥ä¿®æ”¹å®ƒä¼šç ´å JS å¼•æ“çš„ä¼˜åŒ–ï¼Œä¸¥é‡å½±å“æ€§èƒ½ã€‚<code>Object.create()</code> æ˜¯ ES5 æ ‡å‡†æ–¹æ³•ï¼Œæ›´è§„èŒƒä¸”æ€§èƒ½æ›´å¥½ã€‚</p>
<h3 data-id="heading-8">Q3ï¼šå¦‚æœæ„é€ å‡½æ•°è¿”å› <code>null</code>ï¼Œ<code>new</code> å‡ºæ¥çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p><strong>å‚è€ƒå›ç­”ï¼š</strong> ç»“æœæ˜¯<strong>æ–°åˆ›å»ºçš„å®ä¾‹å¯¹è±¡</strong>ã€‚ å› ä¸º <code>typeof null === 'object'</code>ï¼Œä½† <code>null</code> æ˜¯ä¸ªç‰¹æ®Šå€¼ã€‚åœ¨ <code>new</code> çš„è§„èŒƒä¸­ï¼Œå¦‚æœè¿”å›çš„æ˜¯å¯¹è±¡ç±»å‹ä½†å€¼ä¸º <code>null</code>ï¼Œä»ç„¶ä¼šå¿½ç•¥å®ƒï¼Œè¿”å›å®ä¾‹å¯¹è±¡ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨æ‰‹å†™ä»£ç ä¸­æˆ‘ä»¬è¦åˆ¤æ–­ <code>result !== null</code>ã€‚</p>
<hr/>
<h3 data-id="heading-9">ç»“è¯­</h3>
<p>æ‰‹å†™ <code>new</code> æ˜¯å‰ç«¯åŸºç¡€èƒ½åŠ›çš„è¯•é‡‘çŸ³ã€‚ç†è§£äº†è¿™ 4 ä¸ªæ­¥éª¤ï¼Œä½ ä¸ä»…èƒ½è½»æ¾åº”å¯¹é¢è¯•ï¼Œè¿˜èƒ½æ›´æ·±åˆ»åœ°ç†è§£ JavaScript çš„ç»§æ‰¿æœºåˆ¶ã€‚</p>
<p><strong>å¦‚æœä½ è§‰å¾—è¿™ç¯‡ç¬”è®°å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµæ”¶è—ï¼</strong> ğŸš€</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JS-æ·±åº¦è§£æ„JSäº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰]]></title>    <link>https://juejin.cn/post/7595994039109058596</link>    <guid>https://juejin.cn/post/7595994039109058596</guid>    <pubDate>2026-01-17T14:58:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595994039109058596" data-draft-id="7595878718172233764" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JS-æ·±åº¦è§£æ„JSäº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-01-17T14:58:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‘ç°ä¸€åªå¤§å‘†ç“œ"/> <meta itemprop="url" content="https://juejin.cn/user/180747382561607"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JS-æ·±åº¦è§£æ„JSäº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/180747382561607/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‘ç°ä¸€åªå¤§å‘†ç“œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T14:58:21.000Z" title="Sat Jan 17 2026 14:58:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>ä¸ºä»€ä¹ˆ JavaScript æ˜¯å•çº¿ç¨‹çš„å´èƒ½å¤„ç†å¼‚æ­¥ IOï¼Ÿä¸ºä»€ä¹ˆ <code>setTimeout</code> å¹¶ä¸æ€»æ˜¯å‡†æ—¶ï¼Ÿæœ¬æ–‡å°†ä»å®è§‚çš„æ‰§è¡Œæ ˆã€ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¸€ç›´æ·±å…¥åˆ°æµè§ˆå™¨åº•å±‚çš„ä»»åŠ¡è°ƒåº¦é€»è¾‘ï¼Œå¸¦ä½ å½»åº•çœ‹é€äº‹ä»¶å¾ªç¯ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ ä¸ºä»€ä¹ˆéœ€è¦äº‹ä»¶å¾ªç¯ï¼Ÿ</h2>
<p>JavaScript çš„æ ¸å¿ƒæ˜¯<strong>å•çº¿ç¨‹</strong>çš„ï¼Œè¿™æ„å‘³ç€å®ƒåªæœ‰ä¸€ä¸ªä¸»çº¿ç¨‹æ¥å¤„ç† DOM è§£æã€æ ·å¼è®¡ç®—ã€è„šæœ¬æ‰§è¡Œç­‰ã€‚å¦‚æœæŸä¸ªä»»åŠ¡è€—æ—¶è¿‡é•¿ï¼Œé¡µé¢å°±ä¼šâ€œå¡æ­»â€ã€‚ä¸ºäº†åè°ƒåŒæ­¥ä»»åŠ¡ä¸å¼‚æ­¥ä»»åŠ¡ï¼ˆè¾“å…¥äº‹ä»¶ã€ç½‘ç»œè¯·æ±‚ã€å®šæ—¶å™¨ï¼‰ï¼Œæµè§ˆå™¨å¼•å…¥äº†<strong>äº‹ä»¶å¾ªç¯</strong>ç³»ç»Ÿæ¥ç»Ÿä¸€è°ƒåº¦å’Œå¤„ç†è¿™äº›ä»»åŠ¡ã€‚</p>
<hr/>
<h2 data-id="heading-2">äºŒã€ æ ¸å¿ƒç»„ä»¶ï¼šæ‰§è¡Œæ ˆä¸ä»»åŠ¡é˜Ÿåˆ—</h2>
<h3 data-id="heading-3">1. æ‰§è¡Œæ ˆ (Execution Stack)</h3>
<p>å½“å¤šä¸ªæ–¹æ³•è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œå› ä¸ºjsæ˜¯å•çº¿ç¨‹çš„ï¼Œæ‰€ä»¥æ¯æ¬¡åªèƒ½æ‰§è¡Œä¸€ä¸ªæ–¹æ³•ï¼Œäºæ˜¯è¿™äº›æ–¹æ³•è¢«æ’åˆ°äº†ä¸€ä¸ªå•ç‹¬çš„åœ°æ–¹ï¼Œè¿™ä¸ªåœ°æ–¹å°±æ˜¯æ‰§è¡Œæ ˆã€‚æ‰§è¡Œæ ˆé‡Œé¢æ‰§è¡Œçš„éƒ½æ˜¯åŒæ­¥çš„æ“ä½œã€‚</p>
<h3 data-id="heading-4">2. äº‹ä»¶é˜Ÿåˆ— (Task Queue)</h3>
<ul>
<li>åœ¨jsæ‰§è¡Œè¿‡ç¨‹ä¸­å¦‚æœé‡åˆ°å¼‚æ­¥äº‹ä»¶ï¼ˆå¦‚ Ajaxã€å®šæ—¶å™¨ï¼‰ï¼Œå°±ä¼šé¦–å…ˆå°†è¿™ä¸ªå¼‚æ­¥äº‹ä»¶äº¤ç»™å¯¹åº”çš„æµè§ˆå™¨æ¨¡å—ï¼ˆå¦‚ç½‘ç»œè¿›ç¨‹ï¼‰ï¼Œç»§ç»­æ‰§è¡Œæ‰§è¡Œæ ˆé‡Œé¢çš„ä»»åŠ¡ã€‚</li>
<li>å½“å¼‚æ­¥äº‹ä»¶è¿”å›ç»“æœåï¼Œjsä¸ä¼šç«‹å³æ‰§è¡Œè¿™ä¸ªå›è°ƒï¼Œä¼šå°†äº‹ä»¶åŠ å…¥åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­ï¼Œåªæœ‰å½“æ‰§è¡Œæ ˆé‡Œé¢çš„å…¨éƒ¨æ‰§è¡Œå®Œä»¥åï¼Œä¸»çº¿ç¨‹æ‰ä¼šå»æŸ¥æ‰¾äº‹ä»¶é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰ä»»åŠ¡ã€‚</li>
<li>å¦‚æœæœ‰ï¼Œé‚£ä¹ˆä¸»çº¿ç¨‹ä¼šå–å‡ºäº‹ä»¶é˜Ÿåˆ—é‡Œé¢æ’åœ¨æœ€å‰é¢çš„äº‹ä»¶ï¼Œå°†è¿™ä¸ªäº‹ä»¶å¯¹åº”çš„å›è°ƒåŠ å…¥åˆ°æ‰§è¡Œæ ˆä¸­ï¼Œç„¶åæ‰§è¡Œå…¶ä¸­çš„åŒæ­¥ä»£ç ã€‚ç„¶ååœ¨ç»§ç»­è§‚å¯Ÿæ‰§è¡Œæ ˆé‡Œé¢æ˜¯å¦æœ‰ä»»åŠ¡ï¼Œä¾æ¬¡åå¤...å°±å½¢æˆäº†ä¸€ä¸ªæ— é™çš„å¾ªç¯ã€‚</li>
<li>è¿™å°±æ˜¯è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºäº‹ä»¶å¾ªç¯ï¼ˆEvent loopï¼‰çš„åŸå› ã€‚</li>
</ul>
<p><strong>å¾ªç¯é€»è¾‘ï¼š</strong></p>
<ol>
<li>æ£€æŸ¥æ‰§è¡Œæ ˆæ˜¯å¦ä¸ºç©ºã€‚</li>
<li>è‹¥ä¸ºç©ºï¼Œä»äº‹ä»¶é˜Ÿåˆ—å¤´éƒ¨å–å‡ºä¸€ä¸ªä»»åŠ¡æ¨å…¥æ‰§è¡Œæ ˆã€‚</li>
<li>å¾ªç¯å¾€å¤ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€ å¼‚æ­¥ä»»åŠ¡çš„â€œç­‰çº§â€ï¼šå®ä»»åŠ¡ä¸å¾®ä»»åŠ¡</h2>
<p>å¹¶éæ‰€æœ‰çš„å¼‚æ­¥ä»»åŠ¡ä¼˜å…ˆçº§éƒ½ä¸€æ ·ã€‚åœ¨åŒä¸€æ¬¡å¾ªç¯ä¸­ï¼Œ<strong>å¾®ä»»åŠ¡æ°¸è¿œåœ¨ä¸‹ä¸€æ¬¡å®ä»»åŠ¡ä¹‹å‰æ‰§è¡Œ!!!</strong></p>




















<table><thead><tr><th><strong>ç±»å‹</strong></th><th><strong>åŒ…å«ä»»åŠ¡</strong></th><th><strong>æ‰§è¡Œæ—¶æœº</strong></th></tr></thead><tbody><tr><td><strong>å®ä»»åŠ¡ (MacroTask)</strong></td><td><code>setTimeout</code>, <code>setInterval</code>, <code>ajax</code>, <code>domäº‹ä»¶</code></td><td>æ¯æ¬¡äº‹ä»¶å¾ªç¯å¼€å§‹æ—¶å¤„ç†ä¸€ä¸ª</td></tr><tr><td><strong>å¾®ä»»åŠ¡ (MicroTask)</strong></td><td><code>Promise.then/catch</code>, <code>MutaionObserver</code>, <code>process.nextTick</code> (Node.js)</td><td>å½“å‰æ‰§è¡Œæ ˆæ¸…ç©ºåï¼Œç«‹å³æ¸…ç©ºæ•´ä¸ªå¾®ä»»åŠ¡é˜Ÿåˆ—</td></tr></tbody></table>
<blockquote>
<p><strong>æ³¨æ„ï¼š</strong> <code>new Promise()</code> æ„é€ å‡½æ•°å†…éƒ¨çš„ä»£ç æ˜¯<strong>åŒæ­¥</strong>æ‰§è¡Œçš„ï¼Œåªæœ‰ <code>.then()</code> æˆ– <code>.catch()</code> é‡Œçš„å›è°ƒæ‰æ˜¯å¾®ä»»åŠ¡ã€‚ï¼ˆåç»­ä¼šä¸“é—¨å‡ºä¸€ç¯‡promiseç›¸å…³æ–‡ç« ï¼‰</p>
</blockquote>
<hr/>
<h2 data-id="heading-6">å››ã€ åº•å±‚æ­ç§˜ï¼šå®šæ—¶å™¨æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</h2>
<p>å¾ˆå¤šå¼€å‘è€…è®¤ä¸º <code>setTimeout</code> æ˜¯ç›´æ¥è¿›å…¥æ¶ˆæ¯é˜Ÿåˆ—çš„ï¼Œä½†æµè§ˆå™¨åº•å±‚å…¶å®ç»´æŠ¤äº†ä¸€ä¸ª<strong>å»¶è¿Ÿæ‰§è¡Œé˜Ÿåˆ— (Delayed Incoming Queue)</strong> ã€‚</p>
<h3 data-id="heading-7">1. ä»»åŠ¡æ•°æ®ç»“æ„</h3>
<p>å½“è°ƒç”¨ <code>setTimeout</code> æ—¶ï¼Œæ¸²æŸ“è¿›ç¨‹å†…éƒ¨ä¼šåˆ›å»ºä¸€ä¸ªä»»åŠ¡ç»“æ„ä½“ï¼š</p>
<pre><code class="hljs language-C++" lang="C++"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">DelayTask</span>{
  int64 id;
  CallBackFunction cbf;
  <span class="hljs-type">int</span> start_time;
  <span class="hljs-type">int</span> delay_time;
};
</code></pre>
<h3 data-id="heading-8">2. æ‰§è¡Œå¾ªç¯æ¨¡æ‹Ÿ</h3>
<p>æµè§ˆå™¨çš„ä¸»çº¿ç¨‹å¾ªç¯é€»è¾‘ä¼ªä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-C++" lang="C++"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MainThread</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-keyword">for</span>(;;) {
    <span class="hljs-comment">// 1. æ‰§è¡Œæ™®é€šæ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„ä¸€ä¸ªä»»åŠ¡ (å®ä»»åŠ¡)</span>
    Task task = task_queue.<span class="hljs-built_in">takeTask</span>();
    <span class="hljs-built_in">ProcessTask</span>(task);
    
    <span class="hljs-comment">// 2. æ‰§è¡Œå¾®ä»»åŠ¡é˜Ÿåˆ— (æœ¬é˜¶æ®µç”± JS å¼•æ“æ§åˆ¶)</span>
    <span class="hljs-comment">// ProcessMicrotasks(); </span>

    <span class="hljs-comment">// 3. æ‰§è¡Œå»¶è¿Ÿé˜Ÿåˆ—ä¸­åˆ°æœŸçš„ä»»åŠ¡ (å®šæ—¶å™¨ä»»åŠ¡åœ¨æ­¤å¤„ç†)</span>
    <span class="hljs-built_in">ProcessDelayTask</span>();

    <span class="hljs-keyword">if</span>(!keep_running) <span class="hljs-keyword">break</span>; 
  }
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong> æµè§ˆå™¨ä¼šåœ¨å¤„ç†å®Œä¸€ä¸ªæ™®é€šå®ä»»åŠ¡åï¼Œå»æ£€æŸ¥å»¶è¿Ÿé˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰ä»»åŠ¡åˆ°æœŸï¼ˆ<code>ProcessDelayTask</code>ï¼‰ï¼Œå¹¶ä¾æ¬¡æ‰§è¡Œå®ƒä»¬ã€‚</p>
<hr/>
<h2 data-id="heading-9">äº”ã€ é¢è¯•æ¨¡æ‹Ÿé¢˜</h2>
<h3 data-id="heading-10">Q1ï¼šä¸ºä»€ä¹ˆ <code>setTimeout(fn, 0)</code> å¹¶ä¸ä¸€å®šæ˜¯ 0ms åæ‰§è¡Œï¼Ÿ</h3>
<p><strong>å‚è€ƒå›ç­”ï¼š</strong></p>
<ol>
<li><strong>æµè§ˆå™¨æœ€å°é™åˆ¶</strong>ï¼šHTML5 è§„èŒƒè§„å®šï¼Œå¦‚æœå®šæ—¶å™¨åµŒå¥—è¶…è¿‡ 5 å±‚ï¼Œæœ€å°å»¶è¿Ÿä¸º 4msã€‚</li>
<li><strong>Event Loop é˜»å¡</strong>ï¼šç”±äºå®šæ—¶å™¨ä»»åŠ¡æ˜¯åœ¨ <code>ProcessDelayTask</code> ä¸­å¤„ç†çš„ï¼Œå¦‚æœå½“å‰çš„å®ä»»åŠ¡ï¼ˆæ¯”å¦‚ä¸€ä¸ªå¤æ‚çš„è®¡ç®—å¾ªç¯ï¼‰æ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼Œä¸»çº¿ç¨‹å°±æ— æ³•åŠæ—¶è·³è½¬åˆ°å»¶è¿Ÿé˜Ÿåˆ—çš„æ£€æŸ¥æ­¥éª¤ï¼Œå¯¼è‡´å®šæ—¶å™¨æ¨è¿Ÿæ‰§è¡Œã€‚</li>
</ol>
<h3 data-id="heading-11">Q2ï¼šè¯´å‡ºä»¥ä¸‹ä»£ç çš„æ‰“å°é¡ºåºï¼š</h3>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'1'</span>);
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'2'</span>), <span class="hljs-number">0</span>);
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'3'</span>));
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'4'</span>);
</code></pre>
<p>å‚è€ƒå›ç­”ï¼š</p>
<p>1 -&gt; 4 -&gt; 3 -&gt; 2ã€‚</p>
<ul>
<li><code>1, 4</code> æ˜¯åŒæ­¥ä»»åŠ¡ï¼Œç›´æ¥è¾“å‡ºã€‚</li>
<li><code>3</code> æ˜¯å¾®ä»»åŠ¡ï¼Œåœ¨å½“å‰è„šæœ¬ï¼ˆå®ä»»åŠ¡ï¼‰æ‰§è¡Œå®Œåç«‹å³æ‰§è¡Œã€‚</li>
<li><code>2</code> æ˜¯ä¸‹ä¸€æ¬¡å®ä»»åŠ¡ã€‚</li>
</ul>
<h3 data-id="heading-12">Q3ï¼š<code>MutationObserver</code> å±äºä»€ä¹ˆä»»åŠ¡ï¼Ÿå®ƒæœ‰ä»€ä¹ˆåº”ç”¨åœºæ™¯ï¼Ÿ</h3>
<p>å‚è€ƒå›ç­”ï¼š</p>
<p>MutationObserver å±äºå¾®ä»»åŠ¡ã€‚å®ƒç”¨äºç›‘å¬ DOM æ ‘çš„å˜åŒ–ã€‚ç”±äºå®ƒæ˜¯å¾®ä»»åŠ¡ï¼Œå®ƒä¼šåœ¨ DOM å˜åŒ–å¼•èµ·çš„å¤šæ¬¡ä¿®æ”¹å…¨éƒ¨å®Œæˆåï¼Œåœ¨æµè§ˆå™¨é‡æ–°æ¸²æŸ“ä¹‹å‰å¼‚æ­¥æ‰§è¡Œï¼Œè¿™æ¯”ä¼ ç»Ÿçš„ Mutation Events æ€§èƒ½æ›´é«˜ï¼Œä¸”ä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹æ¸²æŸ“ã€‚</p>
<hr/>
<h2 data-id="heading-13">å…­ã€ æ€»ç»“å»ºè®®</h2>
<ul>
<li><strong>ç†è§£å¾®ä»»åŠ¡çš„ä¼˜å…ˆçº§</strong>ï¼šå¾®ä»»åŠ¡æ˜¯åœ¨å½“å‰å®ä»»åŠ¡ç»“æŸåçš„â€œæ’é˜Ÿâ€è¡Œä¸ºï¼Œé€‚åˆå¤„ç†éœ€è¦ç«‹å³åé¦ˆçš„å¼‚æ­¥é€»è¾‘ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LeetCode 11. ç››æœ€å¤šæ°´çš„å®¹å™¨]]></title>    <link>https://juejin.cn/post/7595893785907232802</link>    <guid>https://juejin.cn/post/7595893785907232802</guid>    <pubDate>2026-01-17T15:17:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595893785907232802" data-draft-id="7595886887523631144" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LeetCode 11. ç››æœ€å¤šæ°´çš„å®¹å™¨"/> <meta itemprop="keywords" content="é¢è¯•,ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-17T15:17:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="NEXT06"/> <meta itemprop="url" content="https://juejin.cn/user/1176918763246011"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LeetCode 11. ç››æœ€å¤šæ°´çš„å®¹å™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1176918763246011/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    NEXT06
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T15:17:39.000Z" title="Sat Jan 17 2026 15:17:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å›¾è§£ç®—æ³•ï¼šä¸ºä»€ä¹ˆä¸€å®šè¦ç§»åŠ¨é‚£ä¸ªçŸ­æ¿ï¼Ÿ| LeetCode 11. ç››æœ€å¤šæ°´çš„å®¹å™¨</h2>
<blockquote>
<p><strong>å‰è¨€</strong>ï¼šåœ¨é¢è¯•ä¸­ï¼Œæœ‰ä¸€ç±»é¢˜ç›®çœ‹ä¼¼ç®€å•ï¼Œæš´åŠ›è§£æ³•ä¹Ÿèƒ½åšï¼Œä½†é¢è¯•å®˜çœŸæ­£æƒ³çœ‹çš„æ˜¯ä½ å¦‚ä½•å°†Â </p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">O</span>(N2)
</code></pre>
<p>Â çš„å¤æ‚åº¦ä¼˜åŒ–åˆ°Â </p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">O</span>(N)
</code></pre>
<p>ã€‚LeetCode 11 é¢˜â€œç››æœ€å¤šæ°´çš„å®¹å™¨â€å°±æ˜¯è¿™ç±»é¢˜ç›®çš„å…¸èŒƒã€‚ä»Šå¤©æˆ‘ä»¬ä¸èƒŒä»£ç ï¼Œè€Œæ˜¯æ·±å…¥æ¢è®¨èƒŒåçš„<strong>è´ªå¿ƒç­–ç•¥</strong>ä¸<strong>åŒæŒ‡é’ˆ</strong>æ€ç»´ã€‚</p>
</blockquote>
<h3 data-id="heading-1">ä¸€ã€ é¢˜ç›®ç›´è§‰ä¸â€œæœ¨æ¡¶æ•ˆåº”â€</h3>
<p>é¢˜ç›®çš„ç›®æ ‡éå¸¸ç›´è§‚ï¼šåœ¨ä¸€ä¸ªæ•°ç»„ä¸­æ‰¾åˆ°ä¸¤æ¡å‚çº¿ï¼Œä½¿å¾—å®ƒä»¬ä¸ X è½´å›´æˆçš„å®¹å™¨èƒ½ç››æœ€å¤šçš„æ°´ã€‚</p>
<p>æˆ‘ä»¬è¦è®¡ç®—çš„æ˜¯çŸ©å½¢é¢ç§¯ï¼š</p>
<pre><code class="hljs language-css" lang="css">Area=<span class="hljs-attribute">Width</span>Ã—HeightArea=<span class="hljs-attribute">Width</span>Ã—<span class="hljs-attribute">Height</span>
</code></pre>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªç‰©ç†å¸¸è¯†è‡³å…³é‡è¦ï¼Œé‚£å°±æ˜¯<strong>æœ¨æ¡¶æ•ˆåº” (Short Board Effect)</strong> ï¼š<br/>
ä¸€ä¸ªæœ¨æ¡¶èƒ½è£…å¤šå°‘æ°´ï¼Œå–å†³äº<strong>æœ€çŸ­</strong>çš„é‚£å—æœ¨æ¿ã€‚</p>
<p>æ˜ å°„åˆ°é¢˜ç›®ä¸­ï¼š</p>
<ul>
<li><strong>å®½åº¦ (Width)</strong> ï¼šä¸¤æ¡å‚çº¿åœ¨ X è½´ä¸Šçš„è·ç¦»Â right - leftã€‚</li>
<li><strong>é«˜åº¦ (Height)</strong> ï¼šä¸¤æ¡å‚çº¿ä¸­<strong>è¾ƒçŸ®</strong>çš„é‚£ä¸€æ¡ï¼Œå³Â Math.min(height[left], height[right])ã€‚</li>
</ul>
<h3 data-id="heading-2">äºŒã€ ç—›ç‚¹ï¼šä¸ºä»€ä¹ˆæš´åŠ›è§£æ³•ä¸è¡Œï¼Ÿ</h3>
<p>æœ€å®¹æ˜“æƒ³åˆ°çš„æ€è·¯æ˜¯åŒé‡å¾ªç¯ï¼šè®¡ç®—æ‰€æœ‰ä¸¤ä¸¤ç»„åˆçš„é¢ç§¯ï¼Œç„¶åå–æœ€å¤§å€¼ã€‚</p>
<p>ç„¶è€Œä»¥æˆ‘çš„ç»éªŒï¼Œå½“ä½ å†™ä¸‹åŒå¾ªç¯çš„æ—¶å€™ï¼Œä½ è‡ªå·±å¿ƒä¸­çš„æ— å¥ˆï¼Œæ²¡æœ‰äººä¼šæ¯”ä½ æ›´äº†è§£</p>
<p>é¢è¯•å®˜åœ¨äº†è§£åˆ°ä½ çš„è§£é¢˜æ€è·¯æ—¶ï¼Œå°±å·²ç»å°†ä½ passæ‰äº†</p>
<p>ä»»ä½•ç®—æ³•é¢˜ï¼Œå†™åŒå¾ªç¯çš„ç»“æœåªæœ‰æ­»è·¯ä¸€æ¡ï¼ˆå› ä¸ºä»–ä¼šè®¤ä¸ºä½ å¯¹ç©ºé—´ä¸æ—¶é—´å¤æ‚åº¦æ²¡æœ‰æ¦‚å¿µï¼Œæˆ–è€…ä½ çš„å®åŠ›å°±è¿™ä¹ˆå¤šï¼‰</p>
<p>JavaScript</p>
<pre><code class="hljs language-ini" lang="ini">//  æš´åŠ›è§£æ³•
let <span class="hljs-attr">max</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
for (let <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; len; i++) {</span>
    for (let <span class="hljs-attr">j</span> = i + <span class="hljs-number">1</span><span class="hljs-comment">; j &lt; len; j++) {</span>
        // è®¡ç®—æ¯ä¸€å¯¹ç»„åˆ...
    }
}
</code></pre>
<p><strong>è¿™ç§è§£æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯</strong></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">O</span>(N2)
</code></pre>
<p>ã€‚<br/>
é¢˜ç›®æç¤ºä¸­æ•°ç»„é•¿åº¦Â </p>
<pre><code class="hljs">NN
</code></pre>
<p>Â å¯è¾¾Â </p>
<pre><code class="hljs">105105
</code></pre>
<p>ã€‚è¿™æ„å‘³ç€è®¡ç®—é‡é«˜è¾¾Â </p>
<pre><code class="hljs">10101010
</code></pre>
<p>Â æ¬¡ã€‚åœ¨é€šå¸¸çš„ç®—æ³•ç«èµ›æˆ–é¢è¯•æ ‡å‡†ä¸­ï¼Œè¿™ç»å¯¹ä¼šè§¦å‘Â <strong>TLE (Time Limit Exceeded)</strong> Â è¶…æ—¶é”™è¯¯ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦ä¸€ç§æ›´èªæ˜çš„åšæ³•ï¼Œå°†å¤æ‚åº¦é™ç»´æ‰“å‡»åˆ°</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">O</span>(N)
</code></pre>
<p>ã€‚</p>
<h3 data-id="heading-3">ä¸‰ã€ æ ¸å¿ƒï¼šåŒæŒ‡é’ˆæ³•ä¸è´ªå¿ƒç­–ç•¥</h3>
<p>æˆ‘ä»¬è¦ä¼˜åŒ–çš„æ ¸å¿ƒæ˜¯ï¼š<strong>å¦‚ä½•å°½å¯èƒ½å°‘åœ°éå†ï¼Œå´èƒ½ä¿è¯ä¸æ¼æ‰æœ€å¤§å€¼ï¼Ÿ</strong></p>
<h4 data-id="heading-4">1. åˆå§‹å¸ƒå±€ï¼šæ‹‰æ»¡å®½åº¦</h4>
<p>æ—¢ç„¶é¢ç§¯ = å®½ Ã— é«˜ï¼Œæˆ‘ä»¬ä¸å¦¨å…ˆè®©<strong>å®½åº¦æœ€å¤§</strong>ã€‚<br/>
æˆ‘ä»¬åœ¨æ•°ç»„çš„å¤´å°¾å„æ”¾ç½®ä¸€ä¸ªæŒ‡é’ˆï¼šleftÂ æŒ‡å‘å¼€å¤´ï¼ŒrightÂ æŒ‡å‘ç»“å°¾ã€‚</p>
<p>æ­¤æ—¶ï¼Œå®¹å™¨çš„åº•å®½æ˜¯æœ€å¤§çš„ã€‚æ¥ä¸‹æ¥çš„æ¯ä¸€æ­¥ç§»åŠ¨ï¼Œå®½åº¦å¿…ç„¶å‡å°ã€‚ä¸ºäº†å¼¥è¡¥å®½åº¦çš„æŸå¤±ï¼Œæˆ‘ä»¬å¿…é¡»å¯»æ‰¾<strong>æ›´é«˜</strong>çš„å‚çº¿ã€‚</p>
<h4 data-id="heading-5">2. å†³ç­–å›°å¢ƒï¼šç§»åŠ¨å“ªä¸€æ ¹ï¼Ÿ</h4>
<p>è¿™æ˜¯æœ¬é¢˜æœ€éš¾ç†è§£çš„ç‚¹ã€‚å‡è®¾ç°åœ¨çš„çŠ¶å†µæ˜¯ï¼š</p>
<ul>
<li>
<p>å·¦è¾¹æŸ±å­é«˜åº¦Â left_h = 2</p>
</li>
<li>
<p>å³è¾¹æŸ±å­é«˜åº¦Â right_h = 8</p>
</li>
<li>
<p>å½“å‰å®½åº¦Â w = 10</p>
</li>
<li>
<p>å½“å‰é¢ç§¯ =Â </p>
<pre><code class="hljs language-ini" lang="ini">2Ã—<span class="hljs-attr">10</span>=<span class="hljs-number">202</span>Ã—<span class="hljs-number">10</span>=<span class="hljs-number">20</span>
</code></pre>
</li>
</ul>
<p>ç°åœ¨æˆ‘ä»¬éœ€è¦å‘å†…ç§»åŠ¨ä¸€ä¸ªæŒ‡é’ˆï¼Œæ˜¯ç§»å·¦è¾¹çš„ï¼ˆçŸ®çš„ï¼‰ï¼Œè¿˜æ˜¯ç§»å³è¾¹çš„ï¼ˆé«˜çš„ï¼‰ï¼Ÿ</p>
<h5 data-id="heading-6">å‡è®¾æˆ‘ä»¬ç§»åŠ¨é«˜çš„é‚£ä¸€è¾¹ï¼ˆå³è¾¹ï¼‰ï¼š</h5>
<p>å®½åº¦è‚¯å®šå˜å°äº†ï¼ˆå˜æˆ 9ï¼‰ã€‚<br/>
è€Œæ°´ä½é«˜åº¦å–å†³äºè°ï¼Ÿä¾ç„¶æ˜¯å·¦è¾¹é‚£ä¸ªä¸åŠ¨çš„çŸ­æ¿ï¼ˆé«˜åº¦ 2ï¼‰ã€‚<br/>
æ— è®ºå³è¾¹æ–°é‡åˆ°çš„æŸ±å­æ˜¯é«˜è€¸å…¥äº‘è¿˜æ˜¯çŸ®å°ä¸å ªï¼Œå®¹å™¨çš„æœ‰æ•ˆé«˜åº¦<strong>æœ€é«˜åªèƒ½æ˜¯ 2</strong>ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">æ–°é¢ç§¯=<span class="hljs-number">9</span>Ã—minâ¡(<span class="hljs-number">2</span>,æ–°é«˜åº¦)â‰¤<span class="hljs-number">18</span>æ–°é¢ç§¯=<span class="hljs-number">9</span>Ã—<span class="hljs-built_in">min</span>(<span class="hljs-number">2</span>,æ–°é«˜åº¦)â‰¤<span class="hljs-number">18</span>
</code></pre>
<p><strong>ç»“è®ºï¼š</strong> Â ç§»åŠ¨é«˜æ¿ï¼Œå®½åº¦å‡å°ï¼Œé«˜åº¦å—é™äºä¸åŠ¨çš„çŸ­æ¿ï¼ˆæ— æ³•å¢åŠ ï¼‰ã€‚<strong>é¢ç§¯åªä¼šå˜å°ï¼Œç»å¯¹ä¸å¯èƒ½å˜å¤§ã€‚</strong> Â è¿™æ˜¯ä¸€æ¡æ­»è·¯ã€‚</p>
<h5 data-id="heading-7">è´ªå¿ƒç­–ç•¥ï¼šç§»åŠ¨çŸ®çš„é‚£ä¸€è¾¹ï¼ˆå·¦è¾¹ï¼‰ï¼š</h5>
<p>è™½ç„¶å®½åº¦å˜å°äº†ï¼ˆå˜æˆ 9ï¼‰ï¼Œä½†æˆ‘ä»¬æŠ›å¼ƒäº†å½“å‰çš„çŸ­æ¿ï¼ˆé«˜åº¦ 2ï¼‰ã€‚<br/>
å¦‚æœè¿æ°”å¥½ï¼Œå·¦è¾¹æ–°é‡åˆ°çš„æŸ±å­é«˜åº¦æ˜¯ 10ï¼Œé‚£ä¹ˆæ–°çš„æœ‰æ•ˆé«˜åº¦å°±å˜æˆäº† 8ï¼ˆå—é™äºå³è¾¹ï¼‰ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">æ–°é¢ç§¯=9Ã—<span class="hljs-attr">8</span>=<span class="hljs-number">72</span>æ–°é¢ç§¯=<span class="hljs-number">9</span>Ã—<span class="hljs-number">8</span>=<span class="hljs-number">72</span>
</code></pre>
<p><strong>ç»“è®ºï¼š</strong> Â åªæœ‰ç§»åŠ¨çŸ­æ¿ï¼Œæˆ‘ä»¬æ‰<strong>æœ‰å¯èƒ½</strong>æ‰¾åˆ°æ›´é«˜çš„æŸ±å­æ¥å¼¥è¡¥å®½åº¦çš„æŸå¤±ã€‚</p>
<p><strong>è¿™å°±æ˜¯æœ¬é¢˜çš„è´ªå¿ƒé€»è¾‘ï¼š</strong> Â æ¯ä¸€æ­¥æˆ‘ä»¬éƒ½æ’é™¤æ‰é‚£ä¸ªâ€œå¯¼è‡´å½“å‰é«˜åº¦å—é™â€çš„çŸ­æ¿ï¼Œå› ä¸ºå®ƒå·²ç»å‘æŒ¥äº†å®ƒçš„æœ€å¤§æ½œåŠ›ï¼ˆåœ¨å½“å‰æœ€å®½çš„æƒ…å†µä¸‹ï¼‰ï¼Œä¿ç•™å®ƒæ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚</p>
<h3 data-id="heading-8">å››ã€ ä»£ç å®ç°</h3>
<p>ç†è§£äº†ä¸Šè¿°é€»è¾‘ï¼Œä»£ç å®ç°å°±éå¸¸ç®€å•äº†ã€‚</p>
<p>JavaScript</p>
<pre><code class="hljs language-ini" lang="ini">/**
 * @param {number<span class="hljs-section">[]</span>} height
 * @return {number}
 */
var <span class="hljs-attr">maxArea</span> = function(height) {
    // 1. å®šä¹‰åŒæŒ‡é’ˆï¼Œåˆ†åˆ«æŒ‡å‘å¤´å°¾
    let <span class="hljs-attr">left</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
    let <span class="hljs-attr">right</span> = height.length - <span class="hljs-number">1</span><span class="hljs-comment">;</span>
    let <span class="hljs-attr">maxWater</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
    
    // 2. å½“æŒ‡é’ˆæœªç›¸é‡æ—¶å¾ªç¯
    while (left &lt; right) {
        // 3. è®¡ç®—å½“å‰é¢ç§¯
        // é«˜åº¦å–å†³äºçŸ­æ¿ (æœ¨æ¡¶æ•ˆåº”)
        const <span class="hljs-attr">currentHeight</span> = Math.min(height[left], height[right])<span class="hljs-comment">;</span>
        const <span class="hljs-attr">currentWidth</span> = right - left<span class="hljs-comment">;</span>
        
        // æ›´æ–°å†å²æœ€å¤§å€¼
        <span class="hljs-attr">maxWater</span> = Math.max(maxWater, currentHeight * currentWidth)<span class="hljs-comment">;</span>
        
        // 4. æ ¸å¿ƒå†³ç­–ï¼šç§»åŠ¨è¾ƒçŸ®çš„ä¸€ä¾§
        // å¦‚æœå·¦è¾¹æ˜¯çŸ­æ¿ï¼Œé‚£å·¦è¾¹è¿™å—æ¿å­åœ¨å½“å‰å®½åº¦ä¸‹å·²ç»å‘æŒ¥äº†æœ€å¤§ä»·å€¼ï¼Œ
        // å†å¾€é‡Œç¼©å®½åº¦åªä¼šå˜å°ï¼Œä¿ç•™å·¦è¾¹æ²¡æ„ä¹‰ï¼Œä¸å¦‚å‘å³ç§»è¯•è¯•çœ‹æœ‰æ²¡æœ‰æ›´é«˜çš„ã€‚
        if (height<span class="hljs-section">[left]</span> &lt; height<span class="hljs-section">[right]</span>) {
            left++<span class="hljs-comment">;</span>
        } else {
            right--<span class="hljs-comment">;</span>
        }
    }
    
    return maxWater<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-9">äº”ã€ å¤æ‚åº¦åˆ†æ</h3>
<ul>
<li>
<p><strong>æ—¶é—´å¤æ‚åº¦ï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">O</span>(N)
</code></pre>
<p>åŒæŒ‡é’ˆÂ leftÂ å’ŒÂ rightÂ æ€»å…±éå†æ•´ä¸ªæ•°ç»„ä¸€æ¬¡ã€‚ç›¸æ¯”äºæš´åŠ›è§£æ³•çš„Â </p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">O</span>(N2)
</code></pre>
<p>ï¼Œæ•ˆç‡æå‡æ˜¯å·¨å¤§çš„ã€‚</p>
</li>
<li>
<p><strong>ç©ºé—´å¤æ‚åº¦ï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">O</span>(<span class="hljs-number">1</span>)<span class="hljs-built_in">O</span>(<span class="hljs-number">1</span>) 
</code></pre>
<p>æˆ‘ä»¬åªéœ€è¦å­˜å‚¨æŒ‡é’ˆç´¢å¼•å’ŒÂ maxWaterÂ å‡ ä¸ªå˜é‡ï¼Œä¸éœ€è¦é¢å¤–çš„æ•°ç»„ç©ºé—´ã€‚</p>
</li>
</ul>
<h3 data-id="heading-10">å…­ã€ æ€»ç»“</h3>
<p>æ‰€è°“ç®—æ³•ä¼˜åŒ–ï¼Œå¾€å¾€ä¸æ˜¯ä»£ç å†™å¾—æœ‰å¤šå¤æ‚ï¼Œè€Œæ˜¯<strong>æ€ç»´æ¨¡å‹çš„è½¬æ¢</strong>ã€‚</p>
<p>LeetCode 11 é¢˜é€šè¿‡è§‚å¯Ÿâ€œæœ¨æ¡¶æ•ˆåº”â€ï¼Œè®©æˆ‘ä»¬æ˜ç™½ï¼šä¿ç•™é•¿æ¿ã€æŠ›å¼ƒçŸ­æ¿æ˜¯å”¯ä¸€å¯èƒ½è·å¾—æ›´å¤§æ”¶ç›Šçš„è·¯å¾„ã€‚è¿™ç§é€šè¿‡æ’é™¤æ³•å°†æœç´¢ç©ºé—´ä»äºŒç»´çŸ©é˜µï¼ˆæ‰€æœ‰ç»„åˆï¼‰å‹ç¼©åˆ°ä¸€ç»´çº¿æ€§æ‰«æï¼ˆåŒæŒ‡é’ˆï¼‰çš„è¿‡ç¨‹ï¼Œå°±æ˜¯ç®—æ³•ä¸­çš„<strong>é™ç»´æ‰“å‡»</strong>ã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®ä½ å½»åº•ææ‡‚åŒæŒ‡é’ˆè§£æ³•ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¢ç´¢ç°ä»£åŒ– i18n æ–¹æ¡ˆï¼šä»å·¥ç¨‹è‡ªåŠ¨åŒ–åˆ° AI é©±åŠ¨çš„æ¼”è¿›]]></title>    <link>https://juejin.cn/post/7596025264455778340</link>    <guid>https://juejin.cn/post/7596025264455778340</guid>    <pubDate>2026-01-17T15:37:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596025264455778340" data-draft-id="7595858760133820479" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¢ç´¢ç°ä»£åŒ– i18n æ–¹æ¡ˆï¼šä»å·¥ç¨‹è‡ªåŠ¨åŒ–åˆ° AI é©±åŠ¨çš„æ¼”è¿›"/> <meta itemprop="keywords" content="å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-17T15:37:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°èœ—1å·"/> <meta itemprop="url" content="https://juejin.cn/user/835284568117806"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¢ç´¢ç°ä»£åŒ– i18n æ–¹æ¡ˆï¼šä»å·¥ç¨‹è‡ªåŠ¨åŒ–åˆ° AI é©±åŠ¨çš„æ¼”è¿›
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/835284568117806/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°èœ—1å·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T15:37:43.000Z" title="Sat Jan 17 2026 15:37:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æœ€è¿‘å‚ä¸çš„ä¸€ä¸ªä¸­å¤§å‹å‰ç«¯é¡¹ç›®ä¸­ï¼Œéšç€ä¸šåŠ¡éœ€æ±‚çš„å¿«é€Ÿå˜åŒ–å’Œä»£ç çš„é¢‘ç¹é‡æ„ï¼Œå›½é™…åŒ–ï¼ˆi18nï¼‰é€æ¸ä»â€œåŸºç¡€è®¾æ–½â€æ¼”å˜æˆäº†ä¸€ä¸ªæ˜æ˜¾çš„å·¥ç¨‹è´Ÿæ‹…ã€‚</p>
<p>ä¸€ä¸ªéå¸¸å…¸å‹çš„åœºæ™¯æ˜¯ï¼š<strong>ç»„ä»¶é€»è¾‘å·²ç»ä¿®æ”¹å®Œæˆï¼Œä½† <code>locales</code> ç›®å½•ä¸‹çš„ JSON æ–‡ä»¶å´é•¿æœŸå¤„äºæ»åçŠ¶æ€</strong>ã€‚æ–°å¢çš„æ–‡æ¡ˆæ²¡æœ‰åŠæ—¶è¡¥é½ï¼Œåˆ é™¤çš„é¡µé¢å´é—ç•™äº†ä¸€å †æ— äººä½¿ç”¨çš„ Keyã€‚éšç€é¡¹ç›®è§„æ¨¡æ‰©å¤§ï¼Œè¿™ç±»é—®é¢˜ä¼šè¢«ä¸æ–­æ”¾å¤§ã€‚</p>
<p>è¿™èƒŒåå…¶å®æš´éœ²çš„æ˜¯ä¸€ä¸ªæ›´æœ¬è´¨çš„é—®é¢˜ï¼š<strong>ä¼ ç»Ÿ i18n çš„å·¥ä½œæµï¼Œä¸ç°ä»£å‰ç«¯å¼€å‘èŠ‚å¥å¹¶ä¸åŒ¹é…</strong>ã€‚</p>
<p>åœ¨æ·±å…¥æ¢è®¨æ”¹è¿›æ–¹æ¡ˆä¹‹å‰ï¼Œæˆ‘ä»¬æœ‰å¿…è¦å…ˆå›é¡¾ä¸€ä¸‹å½“å‰ä¸»æµ i18n æ–¹æ¡ˆçš„è®¾è®¡æ€è·¯åŠå…¶å±€é™ã€‚</p>
<h2 data-id="heading-0">1. ä¼ ç»ŸåŸºçŸ³ï¼švue-i18n çš„è®¾è®¡å–èˆ</h2>
<p>åœ¨ Vue ç”Ÿæ€ä¸­ï¼Œ<code>vue-i18n</code> å‡ ä¹æ˜¯äº‹å®æ ‡å‡†ã€‚å®ƒæˆç†Ÿã€ç¨³å®šï¼Œå¹¶ä¸”è¦†ç›–äº†å¤§å¤šæ•°å›½é™…åŒ–åœºæ™¯ã€‚</p>
<p>ä»å®ç°æœºåˆ¶ä¸Šçœ‹ï¼Œ<code>vue-i18n</code> çš„æ ¸å¿ƒæ˜¯ <strong>è¿è¡Œæ—¶ï¼ˆRuntimeï¼‰æ›¿æ¢</strong>ï¼š</p>
<ul>
<li>å¼€å‘è€…åœ¨æ¨¡æ¿æˆ–è„šæœ¬ä¸­é€šè¿‡ <code>$t('key')</code> è®¿é—®æ–‡æ¡ˆ</li>
<li>è¿è¡Œæ—¶æ ¹æ®å½“å‰è¯­è¨€ç¯å¢ƒï¼Œä»é¢„å…ˆåŠ è½½çš„ JSON è¯­è¨€åŒ…ä¸­æŸ¥æ‰¾å¹¶è¿”å›å¯¹åº”å­—ç¬¦ä¸²</li>
<li>åŒæ—¶æ”¯æŒå¤æ•°è§„åˆ™ã€æ—¥æœŸ/æ•°å­—æ ¼å¼åŒ–ç­‰é«˜çº§èƒ½åŠ›</li>
</ul>
<p>ä»â€œæ¡†æ¶æ’ä»¶â€çš„è§’åº¦æ¥çœ‹ï¼Œè¿™æ ·çš„è®¾è®¡å¹¶æ²¡æœ‰é—®é¢˜ï¼Œä½†åœ¨çœŸå®å·¥ç¨‹å®è·µä¸­ï¼Œå®ƒä¹Ÿå¸¦æ¥äº†ä¸€äº›é•¿æœŸè¢«å¿½è§†çš„æˆæœ¬ã€‚</p>
<p><strong>å¸¸è§ç—›ç‚¹åŒ…æ‹¬ï¼š</strong></p>
<ul>
<li><strong>Key è®¾è®¡æˆæœ¬é«˜</strong><br/>
ä¸ºæ¯ä¸€æ¡æ–‡æ¡ˆè®¾è®¡ä¸€ä¸ªâ€œè¯­ä¹‰æ¸…æ™°ã€å±‚çº§åˆç†ã€å¯é•¿æœŸç»´æŠ¤â€çš„ Keyï¼Œæœ¬èº«å°±æ˜¯ä¸€é¡¹éšæ€§å·¥ä½œé‡ã€‚</li>
<li><strong>ä»£ç ä¸æ–‡æ¡ˆå¼ºè§£è€¦</strong><br/>
Key åˆ†æ•£åœ¨ä¸šåŠ¡ä»£ç ä¸­ï¼ŒçœŸå®æ–‡æ¡ˆå´é›†ä¸­åœ¨ JSON æ–‡ä»¶é‡Œï¼Œåˆ é™¤æˆ–é‡æ„é¡µé¢æ—¶ï¼Œå¾ˆå®¹æ˜“ç•™ä¸‹å¤§é‡â€œæ— æ•ˆç¿»è¯‘â€ã€‚</li>
<li><strong>ä¸Šä¸‹æ–‡ç¼ºå¤±å¯¼è‡´ç¿»è¯‘è´¨é‡ä¸ç¨³å®š</strong><br/>
æ— è®ºæ˜¯äººå·¥ç¿»è¯‘è¿˜æ˜¯æœºå™¨ç¿»è¯‘ï¼Œå•ç‹¬é¢å¯¹ä¸€ä¸ª Keyï¼Œå¾ˆéš¾å‡†ç¡®ç†è§£å…¶çœŸå®ä½¿ç”¨åœºæ™¯ã€‚<br/>
è¿™äº›é—®é¢˜å¹¶é <code>vue-i18n</code> æœ¬èº«çš„ç¼ºé™·ï¼Œè€Œæ˜¯ <strong>â€œKey é©±åŠ¨â€è¿™ä¸€è®¾è®¡èŒƒå¼çš„å¤©ç„¶ä»£ä»·</strong>ã€‚</li>
</ul>
<h2 data-id="heading-1">2. è‡ªåŠ¨åŒ–æ–¹å‘çš„æ¢ç´¢ï¼šåŸºäº AST çš„ i18n å·¥å…·</h2>
<p>ä¸ºäº†é™ä½ Key ç»´æŠ¤å’Œæ‰‹å·¥åŒæ­¥çš„æˆæœ¬ï¼Œç¤¾åŒºä¸­é€æ¸å‡ºç°äº†ä¸€ç±»è‡ªåŠ¨åŒ–å·¥å…·ï¼Œä¾‹å¦‚<br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fauto-i18n%2Fauto-i18n-translation-plugins" target="_blank" title="https://github.com/auto-i18n/auto-i18n-translation-plugins" ref="nofollow noopener noreferrer">auto-i18n-translation-plugins</a>ã€‚</p>
<p>è¿™ç±»æ–¹æ¡ˆçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š<strong>è®©å·¥å…·ç†è§£ä»£ç ï¼Œè€Œä¸æ˜¯è®©äººç»´æŠ¤æ˜ å°„å…³ç³»</strong>ã€‚</p>
<p>å…¶å…¸å‹æµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li><strong>é™æ€æ‰«æ</strong><br/>
åŸºäº AST åˆ†ææºä»£ç ï¼Œæå–å…¶ä¸­çš„ä¸­æ–‡å­—ç¬¦ä¸²</li>
<li><strong>è‡ªåŠ¨æ›¿æ¢</strong><br/>
å°†æºç ä¸­çš„ä¸­æ–‡æ›¿æ¢ä¸ºç”Ÿæˆçš„ Keyï¼ˆé€šå¸¸æ˜¯ Hash å€¼ï¼‰</li>
<li><strong>è‡ªåŠ¨ç¿»è¯‘</strong><br/>
è°ƒç”¨ Google / ç™¾åº¦ç­‰ç¿»è¯‘ APIï¼Œç”Ÿæˆå¤šè¯­è¨€æ–‡æ¡ˆ</li>
<li><strong>é…ç½®å†™å…¥</strong><br/>
è‡ªåŠ¨ç»´æŠ¤è¯­è¨€åŒ…æ–‡ä»¶<br/>
åœ¨å·¥ç¨‹æ•ˆç‡å±‚é¢ï¼Œè¿™ä¸€æ­¥å·²ç»æ˜¯ä¸€æ¬¡æ˜æ˜¾çš„è·ƒè¿ï¼š<br/>
<strong>å¼€å‘è€…å‡ ä¹å¯ä»¥å¿½ç•¥ i18n çš„å­˜åœ¨ï¼Œå…ˆå®Œæˆä¸šåŠ¡ï¼Œå†ç”±å·¥å…·å…œåº•ã€‚</strong></li>
</ol>
<p>ä½†å½“é¡¹ç›®è¿›å…¥æ›´å¤æ‚çš„ä¸šåŠ¡é¢†åŸŸåï¼Œæ–°çš„é—®é¢˜ä¹Ÿéšä¹‹å‡ºç°ã€‚</p>
<p><strong>ä¸»è¦ç“¶é¢ˆåœ¨äºç¿»è¯‘è´¨é‡ï¼š</strong></p>
<ul>
<li>é€šç”¨ç¿»è¯‘ API ç¼ºä¹é¢†åŸŸä¸Šä¸‹æ–‡</li>
<li>æ— æ³•åŒºåˆ†ä¸šåŠ¡è¯­ä¹‰ï¼ˆå¦‚é‡‘èã€åŒ»ç–—ã€åå°ç³»ç»Ÿç­‰ï¼‰</li>
<li>ä»ç„¶éœ€è¦å¤§é‡äººå·¥æ ¡å¯¹</li>
</ul>
<p>è¿™ç±»å·¥å…·è§£å†³äº†â€œæ•ˆç‡é—®é¢˜â€ï¼Œä½†å¹¶æ²¡æœ‰çœŸæ­£è§£å†³â€œå‡†ç¡®æ€§é—®é¢˜â€ã€‚</p>
<h2 data-id="heading-2">3. è¿›ä¸€æ­¥æ¼”è¿›ï¼šAI é©±åŠ¨çš„ i18n è®¾è®¡æ€è·¯</h2>
<p>åœ¨å½“å‰ LLM å·²ç»é«˜åº¦æˆç†Ÿçš„èƒŒæ™¯ä¸‹ï¼Œæˆ‘è®¤ä¸º i18n æ–¹æ¡ˆçš„è®¾è®¡ç›®æ ‡å¯ä»¥è¿›ä¸€æ­¥å‡çº§ï¼š</p>
<blockquote>
<p><strong>ä»¥ Developer Experience ä¸ºæ ¸å¿ƒï¼Œå°½å¯èƒ½è´´è¿‘è‡ªç„¶è¯­è¨€ï¼Œå¹¶æŠŠç¿»è¯‘è´¨é‡äº¤ç»™æ›´â€œç†è§£ä¸Šä¸‹æ–‡â€çš„æ¨¡å‹ã€‚</strong></p>
</blockquote>
<h3 data-id="heading-3">3.1 è¯­æ³•å±‚é¢çš„å–èˆï¼šå›å½’è‡ªç„¶è¯­è¨€</h3>
<p>é¦–å…ˆï¼Œä¸€ä¸ªå…³é”®å†³ç­–æ˜¯ï¼š<strong>ä¸å†å¼ºåˆ¶å¼€å‘è€…æ‰‹åŠ¨å®šä¹‰ Key</strong>ã€‚</p>
<p>ä»£ç ä¸­çš„å›½é™…åŒ–è°ƒç”¨ï¼Œåº”è¯¥å°½é‡æ¥è¿‘è‡ªç„¶è¯­è¨€æœ¬èº«ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// åŸºç¡€ç”¨æ³•ï¼šç›´æ¥ä½¿ç”¨ä¸­æ–‡</span>
<span class="hljs-keyword">const</span> msg = t<span class="hljs-string">`ä½ å¥½`</span>;

<span class="hljs-comment">// å¸¦ä¸Šä¸‹æ–‡çš„ç”¨æ³•</span>
<span class="hljs-keyword">const</span> status = <span class="hljs-title function_">t</span>(<span class="hljs-string">"å¾…å®¡æ ¸"</span>, <span class="hljs-string">"é‡‘èé£æ§ä¸šåŠ¡çŠ¶æ€"</span>);
</code></pre>
<p>è¿™æ ·çš„è¯­æ³•å¸¦æ¥å‡ ä¸ªç›´æ¥æ”¶ç›Šï¼š</p>
<ul>
<li>æ–‡æ¡ˆåœ¨ä»£ç ä¸­æ˜¯å¯è¯»çš„ï¼Œè€Œä¸æ˜¯æŠ½è±¡çš„ Key</li>
<li>Code Review æ—¶æ— éœ€åœ¨ JSON æ–‡ä»¶å’Œä¸šåŠ¡ä»£ç ä¹‹é—´æ¥å›åˆ‡æ¢</li>
<li>ä¸Šä¸‹æ–‡ä¿¡æ¯å¯ä»¥æ˜¾å¼ä¼ é€’ç»™ç¿»è¯‘ç³»ç»Ÿ</li>
</ul>
<h3 data-id="heading-4">3.2 æ›´åˆç†çš„ Key ç”Ÿæˆç­–ç•¥</h3>
<p>åœ¨ç”Ÿæˆè¯­è¨€åŒ…æ—¶ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥æ”¾å¼ƒä¸å¯è¯»çš„ Hash Keyï¼Œè€Œé‡‡ç”¨ï¼š</p>
<blockquote>
<p><strong>ã€Œä¸­æ–‡åŸæ–‡ + ä¸Šä¸‹æ–‡æ³¨é‡Šã€ä½œä¸ºå”¯ä¸€æ ‡è¯†</strong></p>
</blockquote>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"å¾…å®¡æ ¸#é‡‘èé£æ§ä¸šåŠ¡çŠ¶æ€"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"english"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Pending Review"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>è¿™ç§è®¾è®¡çš„ä¼˜åŠ¿åœ¨äºï¼š</p>
<ul>
<li><strong>å¤©ç„¶é¿å…è¯­ä¹‰å†²çª</strong> åŒæ ·æ˜¯â€œå–æ¶ˆâ€ï¼Œåœ¨â€œè®¢å•æ“ä½œâ€å’Œâ€œè´¦æˆ·æ³¨é”€â€åœºæ™¯ä¸‹å¯ä»¥é€šè¿‡ä¸Šä¸‹æ–‡åŒºåˆ†</li>
<li><strong>Key æœ¬èº«å³æ–‡æ¡£</strong> è¯­è¨€åŒ…æ–‡ä»¶åœ¨äººå·¥å®¡æ ¸æ—¶éå¸¸ç›´è§‚</li>
<li><strong>æ›´é€‚åˆå¤šè¯­è¨€æ‰©å±•</strong> åœ¨åç»­ç”Ÿæˆæ—¥æ–‡ã€æ³•æ–‡ã€éŸ©æ–‡ç­‰è¯­è¨€æ—¶ï¼Œå¯ä»¥å¤ç”¨åŒä¸€å¥— Key ä½“ç³»ï¼Œæ— éœ€é¢å¤–ç»´æŠ¤æ˜ å°„å…³ç³»</li>
</ul>
<h3 data-id="heading-5">3.3 è™šæ‹Ÿæ¨¡å—ï¼šè®©ç¿»è¯‘æ•°æ®æˆä¸ºæ„å»ºäº§ç‰©</h3>
<p>ä¸ºäº†é¿å…æ‰‹åŠ¨ç®¡ç†ä¸­é—´æ–‡ä»¶ï¼Œå¯ä»¥åˆ©ç”¨ Vite / Rollup çš„ <strong>Virtual Moduleï¼ˆè™šæ‹Ÿæ¨¡å—ï¼‰</strong> èƒ½åŠ›ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œæ’ä»¶å¯ä»¥åœ¨æ„å»ºé˜¶æ®µåŠ¨æ€ç”Ÿæˆä¸€ä¸ªæ¨¡å—ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { t } <span class="hljs-keyword">from</span> <span class="hljs-string">"virtual:ai-i18n"</span>;
</code></pre>
<p>æ„å»ºå·¥å…·ä¼šæ‹¦æˆªè¯¥å¯¼å…¥ï¼Œå¹¶è¿”å›ç”±æ’ä»¶å®æ—¶ç”Ÿæˆçš„è¿è¡Œæ—¶ä»£ç ï¼Œå…¶ä¸­å·²ç»åŒ…å«ï¼š</p>
<ul>
<li>å½“å‰è¯­è¨€åŒ…</li>
<li><code>t</code>ã€<code>setLang</code> ç­‰è¾…åŠ©å‡½æ•°</li>
</ul>
<p>è¿™æ ·ä¸€æ¥ï¼š</p>
<ul>
<li>ç¿»è¯‘æ•°æ®æˆä¸ºæ„å»ºæµç¨‹çš„ä¸€éƒ¨åˆ†</li>
<li>ä¸éœ€è¦å…³å¿ƒ JSON æ–‡ä»¶çš„åŠ è½½å’ŒåŒæ­¥é—®é¢˜</li>
<li>å·¥ç¨‹ç»“æ„æ›´åŠ æ¸…æ™°</li>
</ul>
<p><strong>è™šæ‹Ÿæ¨¡å—çš„è®¾è®¡æ„ä¹‰</strong>ï¼š</p>
<ol>
<li><strong>è¯­è¨€åŒ…å±äºæ„å»ºäº§ç‰©ï¼Œè€Œä¸æ˜¯æºç æ–‡ä»¶</strong></li>
<li><strong>æ— éœ€ç”Ÿæˆä¸­é—´æ–‡ä»¶ï¼Œä¹Ÿæ— éœ€ commit</strong></li>
<li><strong>æå¤§æå‡å¼€å‘è€…ä½“éªŒ</strong>ï¼Œè®©æ–‡æ¡ˆå†™ä½œåƒåŸç”Ÿè¯­è¨€ç‰¹æ€§ä¸€æ ·è‡ªç„¶</li>
</ol>
<h3 data-id="heading-6">3.4 è‡ªåŠ¨å¯¼å…¥ï¼Œè¿›ä¸€æ­¥å‹ç¼©å¿ƒæ™ºè´Ÿæ‹…</h3>
<p>é…åˆ <code>unplugin-auto-import</code>ï¼Œç”šè‡³å¯ä»¥çœç•¥æ˜¾å¼çš„ importï¼š</p>
<pre><code class="hljs language-ts" lang="ts">t<span class="hljs-string">`ä½ å¥½`</span>;
</code></pre>
<p>ä»å¼€å‘ä½“éªŒä¸Šçœ‹ï¼Œè¿™å·²ç»æ¥è¿‘â€œåŸç”Ÿå†™æ–‡æ¡ˆâ€çš„æ„Ÿè§‰ã€‚</p>
<h2 data-id="heading-7">4. æ’ä»¶é€‰é¡¹ï¼šç›®æ ‡è¯­è¨€ä¸é»˜è®¤è¯­è¨€</h2>
<p>æ’ä»¶æä¾›çµæ´»é…ç½®ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title function_">aiI18nPlugin</span>({
  <span class="hljs-attr">targetLangs</span>: [<span class="hljs-string">"english"</span>, <span class="hljs-string">"ja"</span>, <span class="hljs-string">"fr"</span>], <span class="hljs-comment">// æ‰€æœ‰éœ€è¦ç”Ÿæˆçš„ç›®æ ‡è¯­è¨€</span>
  <span class="hljs-attr">defaultLang</span>: <span class="hljs-string">"english"</span>, <span class="hljs-comment">// é»˜è®¤ç¿»è¯‘è¯­è¨€</span>
});
</code></pre>
<ul>
<li>å¦‚æœæœªä¼  <code>defaultLang</code>ï¼Œé»˜è®¤ä½¿ç”¨ <code>'english'</code></li>
<li><code>targetLangs</code> è‡³å°‘åŒ…å«é»˜è®¤è¯­è¨€</li>
<li>åç»­ç”Ÿæˆè¯­è¨€åŒ…çš„ç»“æ„ç»Ÿä¸€ä¸ºå•æ–‡ä»¶ JSON</li>
</ul>
<h2 data-id="heading-8">5. æ’ä»¶è¾“å‡ºæ–‡ä»¶ï¼šå• JSON + å¯äººå·¥æ ¡å‡†</h2>
<p>ä¸ºäº†æœ€å¤§åŒ–å¯ç»´æŠ¤æ€§ï¼Œè¾“å‡ºè¯­è¨€åŒ…ä¸ºï¼š</p>
<pre><code class="hljs language-bash" lang="bash">locales/i18n.json
</code></pre>
<p>æ ¼å¼ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"æäº¤#è¡¨å•æ“ä½œ"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"english"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Submit"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"ja"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"fr"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"å¾…å®¡æ ¸#é‡‘èé£æ§ä¸šåŠ¡çŠ¶æ€"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"english"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Pending Review"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li><strong>å•æ–‡ä»¶ç®¡ç†</strong>ï¼šé¿å…å¤šè¯­è¨€æ–‡ä»¶åˆ†æ•£ï¼Œæ–¹ä¾¿æŸ¥æ‰¾ä¸å®¡æ ¸</li>
<li><strong>åªå¤„ç†æœªç¿»è¯‘ Key</strong>ï¼šæ’ä»¶ä¸ä¼šè¦†ç›–å·²æœ‰ç¿»è¯‘</li>
<li><strong>æ”¯æŒäººå·¥æ ¡å‡†</strong>ï¼šä½ å¯ä»¥åœ¨ <code>locales/i18n.json</code> ä¸­ç›´æ¥ä¿®æ”¹æˆ–è¡¥å……ç¿»è¯‘</li>
<li><strong>å¢é‡æ›´æ–°</strong>ï¼šæ¯æ¬¡æ„å»ºåªç”Ÿæˆç¼ºå¤±ç¿»è¯‘ï¼Œä¿è¯å†å²ç¿»è¯‘å®‰å…¨</li>
</ul>
<h2 data-id="heading-9">6. ä¸ºä»€ä¹ˆè¿™é‡Œé€‰æ‹© LLMï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿç¿»è¯‘ APIï¼Ÿ</h2>
<p>å¼•å…¥ LLM å¹¶ä¸æ˜¯ä¸ºäº†è¿½é€æ¦‚å¿µï¼Œè€Œæ˜¯ä¸ºäº†è§£å†³ä¼ ç»Ÿç¿»è¯‘ API çš„ç»“æ„æ€§çŸ­æ¿ã€‚</p>
<h3 data-id="heading-10">6.1 é¢†åŸŸè¯­ä¹‰çš„ç†è§£èƒ½åŠ›</h3>
<p>é€šè¿‡ Prompt Engineeringï¼Œå¯ä»¥æ˜¾å¼å‘Šè¯‰æ¨¡å‹å½“å‰çš„ä¸šåŠ¡èƒŒæ™¯ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>é‡‘èé£æ§ç³»ç»Ÿ</li>
<li>SaaS ç®¡ç†åå°</li>
<li>ç”µå•†äº¤æ˜“æµç¨‹</li>
</ul>
<p>é…åˆ Few-Shot ç¤ºä¾‹æˆ–æœ¯è¯­è¡¨æ³¨å…¥ï¼Œç”Ÿæˆçš„ç¿»è¯‘åœ¨<strong>å‡†ç¡®æ€§å’Œä¸“ä¸šåº¦</strong>ä¸Šï¼Œæ˜æ˜¾ä¼˜äºé€šç”¨ APIã€‚</p>
<h3 data-id="heading-11">6.2 æˆæœ¬ä¸éšç§çš„å¯æ§æ€§</h3>
<p>ç¿»è¯‘ä»»åŠ¡æœ¬èº«æ˜¯ä½å¤æ‚åº¦ä»»åŠ¡ï¼Œéå¸¸é€‚åˆï¼š</p>
<ul>
<li>æœ¬åœ°è¿è¡Œ 4B~8B çº§åˆ«æ¨¡å‹ï¼ˆå¦‚ Qwenã€Llama ç³»åˆ—ï¼‰</li>
<li>é€šè¿‡ Ollama ç­‰å·¥å…·è¿›è¡Œéƒ¨ç½²</li>
<li>ç»“åˆ LangChain è¿›è¡Œæ‰¹å¤„ç†è°ƒç”¨</li>
</ul>
<p>è¿™ç§æ–¹å¼çš„ä¼˜åŠ¿åŒ…æ‹¬ï¼š</p>
<ul>
<li>æ— ç½‘ç»œä¾èµ–ï¼Œéšç§å¯æ§</li>
<li>æ— è°ƒç”¨è´¹ç”¨</li>
<li>æ‰¹é‡ç¿»è¯‘æ•ˆç‡é«˜</li>
</ul>
<p>åœ¨ä¼ä¸šç¯å¢ƒä¸­ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ›¿æ¢ä¸º GPT-4ã€DeepSeek ç­‰å•†ä¸š APIï¼Œæ–¹æ¡ˆæœ¬èº«å¹¶ä¸å—é™ã€‚</p>
<h2 data-id="heading-12">7. æ’ä»¶å®ç°è¦ç‚¹ï¼ˆVite Pluginï¼‰</h2>
<p>æ’ä»¶çš„æ ¸å¿ƒèŒè´£å¯ä»¥å½’çº³ä¸ºä¸¤ç‚¹ï¼š</p>
<ol>
<li><strong>æ”¶é›†éœ€è¦ç¿»è¯‘çš„æ–‡æ¡ˆ</strong></li>
<li><strong>åœ¨åˆé€‚çš„æ—¶æœºæ‰¹é‡è°ƒç”¨ LLMï¼Œå¹¶æŒä¹…åŒ–ç»“æœåˆ°å•æ–‡ä»¶ JSON</strong></li>
</ol>
<p>å…³é”®å®ç°ç»†èŠ‚åŒ…æ‹¬ï¼š</p>
<ul>
<li>ç¿»è¯‘é˜Ÿåˆ—ä¸æ‰¹å¤„ç†æœºåˆ¶</li>
<li>æœ¬åœ°ç¼“å­˜ä¸æŒä¹…åŒ–</li>
<li>é¿å…é‡å¤ç¿»è¯‘å·²å­˜åœ¨ Key</li>
</ul>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">/**
 * vite-plugin-ai-i18n.ts
 *
 * è¯´æ˜ï¼š
 * è¿™æ˜¯ä¸€ä¸ªç”¨äºè§£é‡Š AI i18n æ’ä»¶æ ¸å¿ƒæµç¨‹çš„ä¼ªä»£ç ç¤ºä¾‹ã€‚
 * é‡ç‚¹åœ¨äºæ¶æ„ã€æ•°æ®æµå’Œè®¾è®¡æ€è·¯ï¼Œè€Œéå…·ä½“ API æˆ–å¯è¿è¡Œå®ç°ã€‚
 */</span>

<span class="hljs-keyword">import</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">"fs"</span>;
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">"path"</span>;

<span class="hljs-comment">// -------------------------</span>
<span class="hljs-comment">// è™šæ‹Ÿæ¨¡å—å®šä¹‰</span>
<span class="hljs-comment">// -------------------------</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">VIRTUAL_MODULE_ID</span> = <span class="hljs-string">"virtual:ai-i18n"</span>;
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">RESOLVED_VIRTUAL_MODULE_ID</span> = <span class="hljs-string">"\0"</span> + <span class="hljs-variable constant_">VIRTUAL_MODULE_ID</span>;

<span class="hljs-comment">// -------------------------</span>
<span class="hljs-comment">// è¾“å‡ºæ–‡ä»¶ä¸é»˜è®¤è¯­è¨€</span>
<span class="hljs-comment">// -------------------------</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">LOCALES_DIR</span> = path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">"locales"</span>);
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">LOCALE_FILE</span> = path.<span class="hljs-title function_">join</span>(<span class="hljs-variable constant_">LOCALES_DIR</span>, <span class="hljs-string">"i18n.json"</span>);
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_LANG</span> = <span class="hljs-string">"english"</span>;

<span class="hljs-comment">// -------------------------</span>
<span class="hljs-comment">// ç±»å‹å®šä¹‰ï¼ˆç®€åŒ–ï¼‰</span>
<span class="hljs-comment">// -------------------------</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Lang</span> = <span class="hljs-built_in">string</span>;
<span class="hljs-keyword">type</span> <span class="hljs-title class_">TranslationKey</span> = <span class="hljs-built_in">string</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">PendingItem</span> {
  <span class="hljs-attr">key</span>: <span class="hljs-title class_">TranslationKey</span>; <span class="hljs-comment">// å”¯ä¸€æ ‡è¯†ï¼šåŸæ–‡#ä¸Šä¸‹æ–‡</span>
  <span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// åŸæ–‡</span>
  context?: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// å¯é€‰ä¸Šä¸‹æ–‡ä¿¡æ¯</span>
}

<span class="hljs-keyword">type</span> <span class="hljs-title class_">LangMessages</span> = <span class="hljs-title class_">Record</span>&lt;<span class="hljs-title class_">Lang</span>, <span class="hljs-built_in">string</span>&gt;;
<span class="hljs-keyword">type</span> <span class="hljs-title class_">AllMessages</span> = <span class="hljs-title class_">Record</span>&lt;<span class="hljs-title class_">TranslationKey</span>, <span class="hljs-title class_">LangMessages</span>&gt;;

<span class="hljs-comment">// -------------------------</span>
<span class="hljs-comment">// å·¥å…·å‡½æ•°ï¼ˆä¼ªå®ç°ï¼‰</span>
<span class="hljs-comment">// -------------------------</span>

<span class="hljs-comment">/**
 * è¯»å–å·²æœ‰ JSON è¯­è¨€åŒ…
 * å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¿”å›ç©ºå¯¹è±¡
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">loadLocales</span>(<span class="hljs-params"/>): <span class="hljs-title class_">AllMessages</span> {
  <span class="hljs-keyword">if</span> (!fs.<span class="hljs-title function_">existsSync</span>(<span class="hljs-variable constant_">LOCALE_FILE</span>)) <span class="hljs-keyword">return</span> {};
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-variable constant_">LOCALE_FILE</span>, <span class="hljs-string">"utf-8"</span>));
}

<span class="hljs-comment">/**
 * å°†æœ€ç»ˆè¯­è¨€åŒ…å†™å…¥æœ¬åœ° JSON
 * è‡ªåŠ¨åˆ›å»ºç›®å½•
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">saveLocales</span>(<span class="hljs-params">messages: AllMessages</span>) {
  <span class="hljs-keyword">if</span> (!fs.<span class="hljs-title function_">existsSync</span>(<span class="hljs-variable constant_">LOCALES_DIR</span>)) fs.<span class="hljs-title function_">mkdirSync</span>(<span class="hljs-variable constant_">LOCALES_DIR</span>);
  fs.<span class="hljs-title function_">writeFileSync</span>(<span class="hljs-variable constant_">LOCALE_FILE</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(messages, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>));
}

<span class="hljs-comment">/**
 * æ‰«ææºç ä¸­æ‰€æœ‰ t(...) / t`...` çš„è°ƒç”¨
 * å®é™…å®ç°åº”ä½¿ç”¨ AST
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">scanForI18nTexts</span>(<span class="hljs-params">code: <span class="hljs-built_in">string</span></span>): <span class="hljs-title class_">PendingItem</span>[] {
  <span class="hljs-comment">// ä¼ªé€»è¾‘ç¤ºæ„ï¼š</span>
  <span class="hljs-comment">// 1. éå†ä»£ç  AST</span>
  <span class="hljs-comment">// 2. æ‰¾åˆ° t`xxx` æˆ– t('xxx', 'context')</span>
  <span class="hljs-comment">// 3. è¿”å› PendingItem åˆ—è¡¨</span>
  <span class="hljs-keyword">return</span> [];
}

<span class="hljs-comment">// -------------------------</span>
<span class="hljs-comment">// æ’ä»¶ä¸»é€»è¾‘</span>
<span class="hljs-comment">// -------------------------</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">aiI18nPlugin</span>(<span class="hljs-params">options: {
  targetLangs?: Lang[]; // ç›®æ ‡è¯­è¨€åˆ—è¡¨
  defaultLang?: Lang; // é»˜è®¤è¯­è¨€
}</span>) {
  <span class="hljs-keyword">const</span> defaultLang = options.<span class="hljs-property">defaultLang</span> || <span class="hljs-variable constant_">DEFAULT_LANG</span>;
  <span class="hljs-keyword">const</span> targetLangs = options.<span class="hljs-property">targetLangs</span> || [defaultLang];

  <span class="hljs-comment">// åŠ è½½å·²æœ‰ç¿»è¯‘ï¼ˆäººå·¥å¯æ ¡å‡†ï¼‰</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">allMessages</span>: <span class="hljs-title class_">AllMessages</span> = <span class="hljs-title function_">loadLocales</span>();

  <span class="hljs-comment">// å¾…ç¿»è¯‘é˜Ÿåˆ—ï¼Œåªæ”¶é›†å°šæœªå­˜åœ¨çš„ Key</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">pendingQueue</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">PendingItem</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();

  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"vite-plugin-ai-i18n"</span>,

    <span class="hljs-comment">// -------------------------</span>
    <span class="hljs-comment">// è™šæ‹Ÿæ¨¡å—è§£æ</span>
    <span class="hljs-comment">// -------------------------</span>
    <span class="hljs-title function_">resolveId</span>(<span class="hljs-params">id: <span class="hljs-built_in">string</span></span>) {
      <span class="hljs-keyword">if</span> (id === <span class="hljs-variable constant_">VIRTUAL_MODULE_ID</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable constant_">RESOLVED_VIRTUAL_MODULE_ID</span>;
    },

    <span class="hljs-comment">// -------------------------</span>
    <span class="hljs-comment">// è™šæ‹Ÿæ¨¡å—åŠ è½½</span>
    <span class="hljs-comment">// -------------------------</span>
    <span class="hljs-title function_">load</span>(<span class="hljs-params">id: <span class="hljs-built_in">string</span></span>) {
      <span class="hljs-keyword">if</span> (id === <span class="hljs-variable constant_">RESOLVED_VIRTUAL_MODULE_ID</span>) {
        <span class="hljs-comment">// è¿™é‡Œè¿”å›è¿è¡Œæ—¶ä»£ç ï¼š</span>
        <span class="hljs-comment">// - messages: å½“å‰è¯­è¨€åŒ…</span>
        <span class="hljs-comment">// - t: ç¿»è¯‘å‡½æ•°</span>
        <span class="hljs-comment">// - setLang/getCurrentLang: è¯­è¨€åˆ‡æ¢å‡½æ•°</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">`
          const messages = <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(allMessages)}</span>;
          let currentLang = '<span class="hljs-subst">${defaultLang}</span>';

          export function t(text, context = '') {
            const key = context ? \`\${text}#\${context}\` : text;
            return messages[key]?.[currentLang] || text;
          }

          export function setLang(lang) { currentLang = lang; }
          export function getCurrentLang() { return currentLang; }
        `</span>;
      }
    },

    <span class="hljs-comment">// -------------------------</span>
    <span class="hljs-comment">// æºç æ‰«æé˜¶æ®µ</span>
    <span class="hljs-comment">// -------------------------</span>
    <span class="hljs-title function_">transform</span>(<span class="hljs-params">code: <span class="hljs-built_in">string</span>, id: <span class="hljs-built_in">string</span></span>) {
      <span class="hljs-comment">// å¿½ç•¥ node_modules</span>
      <span class="hljs-keyword">if</span> (id.<span class="hljs-title function_">includes</span>(<span class="hljs-string">"node_modules"</span>)) <span class="hljs-keyword">return</span>;

      <span class="hljs-comment">// æ‰«ææºç ï¼Œæ”¶é›† t(...) / t`...` è°ƒç”¨</span>
      <span class="hljs-keyword">const</span> foundItems = <span class="hljs-title function_">scanForI18nTexts</span>(code);

      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> foundItems) {
        <span class="hljs-comment">// key = åŸæ–‡ + å¯é€‰ä¸Šä¸‹æ–‡</span>
        <span class="hljs-keyword">const</span> key = item.<span class="hljs-property">context</span> ? <span class="hljs-string">`<span class="hljs-subst">${item.text}</span>#<span class="hljs-subst">${item.context}</span>`</span> : item.<span class="hljs-property">text</span>;

        <span class="hljs-comment">// é’ˆå¯¹æ¯ä¸ªç›®æ ‡è¯­è¨€ï¼Œåˆ¤æ–­æ˜¯å¦å·²å­˜åœ¨ç¿»è¯‘</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> lang <span class="hljs-keyword">of</span> targetLangs) {
          <span class="hljs-keyword">const</span> langMessages = allMessages[key] || {};
          <span class="hljs-keyword">if</span> (!langMessages[lang]) {
            <span class="hljs-comment">// å°šæœªå­˜åœ¨ç¿»è¯‘ï¼ŒåŠ å…¥å¾…ç¿»è¯‘é˜Ÿåˆ—</span>
            pendingQueue.<span class="hljs-title function_">set</span>(<span class="hljs-string">`<span class="hljs-subst">${lang}</span>:<span class="hljs-subst">${key}</span>`</span>, { ...item, key });
          }
        }
      }

      <span class="hljs-comment">// è¿”å›åŸå§‹ä»£ç ï¼Œä¸ä¿®æ”¹</span>
      <span class="hljs-keyword">return</span> code;
    },

    <span class="hljs-comment">// -------------------------</span>
    <span class="hljs-comment">// æ„å»ºç»“æŸ / æ‰¹é‡ç¿»è¯‘</span>
    <span class="hljs-comment">// -------------------------</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildEnd</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">if</span> (!pendingQueue.<span class="hljs-property">size</span>) <span class="hljs-keyword">return</span>;

      <span class="hljs-comment">// æŒ‰è¯­è¨€åˆ†ç»„</span>
      <span class="hljs-keyword">const</span> <span class="hljs-attr">groupedByLang</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-title class_">Lang</span>, <span class="hljs-title class_">PendingItem</span>[]&gt; = {};
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [compoundKey, item] <span class="hljs-keyword">of</span> pendingQueue) {
        <span class="hljs-keyword">const</span> [lang] = compoundKey.<span class="hljs-title function_">split</span>(<span class="hljs-string">":"</span>);
        groupedByLang[lang] ||= [];
        groupedByLang[lang].<span class="hljs-title function_">push</span>(item);
      }

      <span class="hljs-comment">// å¯¹æ¯ä¸ªç›®æ ‡è¯­è¨€è°ƒç”¨ LLM ç¿»è¯‘ï¼ˆä¼ªé€»è¾‘ï¼‰</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> lang <span class="hljs-keyword">in</span> groupedByLang) {
        <span class="hljs-keyword">const</span> items = groupedByLang[lang];

        <span class="hljs-comment">// === è¿™é‡Œå¯ä»¥è°ƒç”¨ LLM API ===</span>
        <span class="hljs-comment">// const results = await llm.translateBatch(items)</span>

        <span class="hljs-comment">// ä¼ªç»“æœç¤ºä¾‹</span>
        <span class="hljs-keyword">const</span> <span class="hljs-attr">results</span>: { <span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> }[] = [];

        <span class="hljs-comment">// å°†ç¿»è¯‘ç»“æœå†™å…¥å†…å­˜ç¼“å­˜</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> { key, value } <span class="hljs-keyword">of</span> results) {
          allMessages[key] ||= {};
          allMessages[key][lang] = value;
        }
      }

      <span class="hljs-comment">// æŒä¹…åŒ–åˆ°å• JSON æ–‡ä»¶ï¼Œäººå·¥å¯æ ¡å‡†</span>
      <span class="hljs-title function_">saveLocales</span>(allMessages);

      <span class="hljs-comment">// æ¸…ç©ºé˜Ÿåˆ—ï¼Œé¿å…é‡å¤ç¿»è¯‘</span>
      pendingQueue.<span class="hljs-title function_">clear</span>();
    },
  };
}
</code></pre>
<h2 data-id="heading-13">8. å®é™…ä½¿ç”¨ä½“éªŒ</h2>
<p>å°è£…åï¼Œå¼€å‘ä¾§ä½¿ç”¨æ–¹å¼éå¸¸ç®€å•ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;div&gt;{{ t`ä½ å¥½` }}&lt;/div&gt;
&lt;button&gt;{{ t('æäº¤', 'è¡¨å•æ“ä½œ') }}&lt;/button&gt;
</code></pre>
<p>åˆ‡æ¢è¯­è¨€ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title function_">setLang</span>(<span class="hljs-string">"english"</span>);
</code></pre>
<p>æ‰©å±•æ–°è¯­è¨€ï¼ˆå¦‚æ—¥æ–‡ã€æ³•æ–‡ã€éŸ©æ–‡ï¼‰æ—¶ï¼Œåªéœ€è°ƒæ•´æ’ä»¶é…ç½®ä¸­çš„ <code>targetLangs</code>ï¼Œ<strong>æ— éœ€é¢å¤–ç»´æŠ¤ Key æˆ–å¤åˆ¶æ–‡æ¡ˆæ–‡ä»¶</strong>ã€‚</p>
<h2 data-id="heading-14">9. æ€»ç»“</h2>
<p>è¿™å¥— i18n æ–¹æ¡ˆçš„æ ¸å¿ƒä»·å€¼ä¸åœ¨äºâ€œAI ç¿»è¯‘â€æœ¬èº«ï¼Œè€Œåœ¨äºï¼š</p>
<ol>
<li><strong>æ–‡æ¡ˆå›å½’è‡ªç„¶è¯­è¨€ï¼Œè€Œä¸æ˜¯ Key</strong></li>
<li><strong>ç¿»è¯‘ä¸ç»´æŠ¤æˆæœ¬å‰ç§»åˆ°å·¥å…·é“¾</strong></li>
<li><strong>é€šè¿‡ä¸Šä¸‹æ–‡ + LLM æå‡ç¿»è¯‘è´¨é‡</strong></li>
<li><strong>å• JSON æ–‡ä»¶ + è™šæ‹Ÿæ¨¡å— + å¢é‡ç¿»è¯‘é™ä½å¤šè¯­è¨€é•¿æœŸæˆæœ¬</strong></li>
<li><strong>æ”¯æŒäººå·¥æ ¡å‡†ï¼Œåªå¤„ç†æœªç¿»è¯‘ Keyï¼Œå®‰å…¨å¯é </strong></li>
</ol>
<p>ç›®å‰è¿™ä»æ˜¯ä¸€ä¸ªæŒç»­æ¼”è¿›ä¸­çš„å®è·µæ–¹æ¡ˆï¼Œä½†åœ¨å¤æ‚ä¸šåŠ¡ã€å¤šè¯­è¨€é¡¹ç›®ä¸­ï¼Œå·²ç»å±•ç°å‡ºæ˜æ˜¾çš„å·¥ç¨‹ä»·å€¼ã€‚</p>
<p>å¦‚æœä½ å¯¹ i18nã€å·¥ç¨‹è‡ªåŠ¨åŒ–æˆ– AI åœ¨å‰ç«¯å·¥å…·é“¾ä¸­çš„åº”ç”¨æœ‰ä¸åŒçœ‹æ³•ï¼Œæ¬¢è¿ä¸€èµ·äº¤æµå’Œæ¢è®¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»¥é€»è¾‘é—¨è§’åº¦æ·±å…¥ç†è§£promiseç»„åˆæ–¹æ³•]]></title>    <link>https://juejin.cn/post/7595896809652125736</link>    <guid>https://juejin.cn/post/7595896809652125736</guid>    <pubDate>2026-01-17T15:51:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595896809652125736" data-draft-id="7595974133097168930" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»¥é€»è¾‘é—¨è§’åº¦æ·±å…¥ç†è§£promiseç»„åˆæ–¹æ³•"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2026-01-17T15:51:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="xier123456"/> <meta itemprop="url" content="https://juejin.cn/user/546930955651113"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»¥é€»è¾‘é—¨è§’åº¦æ·±å…¥ç†è§£promiseç»„åˆæ–¹æ³•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/546930955651113/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    xier123456
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T15:51:41.000Z" title="Sat Jan 17 2026 15:51:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    19
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åœ¨æ•°å­—ç”µè·¯è®¾è®¡ä¸­ï¼Œé€»è¾‘é—¨æ˜¯æ„å»ºå¤æ‚ç³»ç»Ÿçš„åŸºç¡€å…ƒä»¶ã€‚åŒæ ·ï¼Œåœ¨ç°ä»£ JavaScript å¼‚æ­¥ç¼–ç¨‹ä¸­ï¼ŒPromise çš„ç»„åˆæ–¹æ³•ï¼ˆ<code>all</code>ã€<code>allSettled</code>ã€<code>any</code>ã€<code>race</code>ï¼‰æ„æˆäº†å¼‚æ­¥æµç¨‹æ§åˆ¶çš„åŸºç¡€ç”µè·¯ã€‚<br/>
æœ¬æ–‡å°†æ·±å…¥æ¢è®¨è¿™äº›æ–¹æ³•çš„è¡Œä¸ºæ¨¡å¼ï¼Œé€šè¿‡é€»è¾‘é—¨æ¯”å–»å»ºç«‹ç›´è§‚ç†è§£ï¼Œå¹¶å¸®åŠ©ä½ å½»åº•æŒæ¡ Promise çš„ç»„åˆæ–¹æ³•â€”â€”ç”šè‡³æ¨æ¼”å‡ºæ–°çš„æˆ–è€…ä½ æœªå‘ç°çš„å¼‚æ­¥æ§åˆ¶æ¨¡å¼ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">æ ¸å¿ƒæ¦‚å¿µå®šä¹‰</h2>
<p>æˆ‘ä»¬å…ˆå»ºç«‹ç»Ÿä¸€çš„é€»è¾‘ç³»ç»Ÿï¼š</p>
<ul>
<li><strong>Promise çŠ¶æ€æ˜ å°„</strong>ï¼š
<ul>
<li><strong>Fulfilled (1)</strong>ï¼šæˆåŠŸï¼Œå¼‚æ­¥æ“ä½œå®Œæˆå¹¶è¿”å›ç»“æœ</li>
<li><strong>Rejected (0)</strong>ï¼šå¤±è´¥ï¼Œå¼‚æ­¥æ“ä½œæŠ›å‡ºé”™è¯¯</li>
</ul>
</li>
<li><strong>è¾“å…¥å‘é‡</strong>ï¼šä¸€ä¸ª Promise æ•°ç»„ï¼Œæ¯ä¸ª Promise æ˜¯ä¸€ä¸ªè¾“å…¥ä¿¡å·</li>
<li><strong>è¾“å‡º</strong>ï¼šä¸€ä¸ªæ–°çš„ Promiseï¼Œå…¶çŠ¶æ€ç”±è¾“å…¥å‘é‡çš„çŠ¶æ€ç»„åˆå†³å®š</li>
</ul>
<h3 data-id="heading-1">çŠ¶æ€å¸¸é‡</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PENDING</span> = <span class="hljs-string">"pending"</span>;
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">FULFILLED</span> = <span class="hljs-string">"fulfilled"</span>;  
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">REJECTED</span> = <span class="hljs-string">"rejected"</span>;     
</code></pre>
<hr/>
<h2 data-id="heading-2">1ï¸.<code>Promise.all()</code>ï¼šé€»è¾‘ä¸é—¨ï¼ˆAND Gateï¼‰</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é€»è¾‘è¡¨è¾¾å¼: OUTPUT = INPUTâ‚ âˆ§ INPUTâ‚‚ âˆ§ ... âˆ§ INPUTâ‚™</span>
<span class="hljs-comment">// æ‰€æœ‰è¾“å…¥ä¸º 1 æ—¶ï¼Œè¾“å‡ºä¸º 1ï¼›ä»»ä¸€è¾“å…¥ä¸º 0 æ—¶ï¼Œè¾“å‡ºä¸º 0</span>
</code></pre>
<h3 data-id="heading-3">é€»è¾‘é—¨ç±»æ¯”</h3>
<ul>
<li><strong>AND é—¨ç‰¹æ€§</strong>ï¼šå…¨é«˜ç”µå¹³ â†’ é«˜ç”µå¹³ï¼›ä»»ä¸€ä½ç”µå¹³ â†’ ä½ç”µå¹³</li>
<li><strong>å¯¹åº”è¡Œä¸º</strong>ï¼šæ‰€æœ‰ Promise æˆåŠŸæ‰æˆåŠŸï¼Œä»»ä¸€å¤±è´¥ç«‹å³å¤±è´¥</li>
<li><strong>å…¸å‹åœºæ™¯</strong>ï¼šå¤šä¸ªä¾èµ–æ¥å£å¿…é¡»å…¨éƒ¨åŠ è½½æˆåŠŸï¼ˆå¦‚ç”¨æˆ·èµ„æ–™ + æƒé™ + é…ç½®ï¼‰</li>
</ul>
<h3 data-id="heading-4">çœŸå€¼è¡¨</h3>



































<table><thead><tr><th>Promiseâ‚</th><th>Promiseâ‚‚</th><th><code>Promise.all</code></th><th>è§£é‡Š</th></tr></thead><tbody><tr><td>1 (æˆåŠŸ)</td><td>1 (æˆåŠŸ)</td><td>1 (æˆåŠŸ)</td><td>å…¨éƒ¨æˆåŠŸ</td></tr><tr><td>1 (æˆåŠŸ)</td><td>0 (å¤±è´¥)</td><td>0 (å¤±è´¥)</td><td>å¿«é€Ÿå¤±è´¥</td></tr><tr><td>0 (å¤±è´¥)</td><td>1 (æˆåŠŸ)</td><td>0 (å¤±è´¥)</td><td>å¿«é€Ÿå¤±è´¥</td></tr><tr><td>0 (å¤±è´¥)</td><td>0 (å¤±è´¥)</td><td>0 (å¤±è´¥)</td><td>å¿«é€Ÿå¤±è´¥</td></tr></tbody></table>
<h3 data-id="heading-5">ç‰¹æ€§</h3>
<ol>
<li><strong>å¿«é€Ÿå¤±è´¥</strong>ï¼šç¬¬ä¸€ä¸ª reject ç«‹å³ reject æ•´ä½“</li>
<li><strong>é¡ºåºç»“æœ</strong>ï¼šæˆåŠŸæ—¶æŒ‰è¾“å…¥é¡ºåºè¿”å›å€¼æ•°ç»„</li>
<li><strong>çŸ­è·¯æ±‚å€¼</strong>ï¼šå¤±è´¥åä¸å†ç­‰å¾…å…¶ä»– Promise</li>
</ol>
<h3 data-id="heading-6">å®ç°</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">Promise</span>.<span class="hljs-property">myAll</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">iterable</span>) {
  <span class="hljs-keyword">if</span> (iterable == <span class="hljs-literal">null</span> || <span class="hljs-keyword">typeof</span> iterable[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>] !== <span class="hljs-string">"function"</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">"Argument is not iterable"</span>));
  }

  <span class="hljs-keyword">const</span> promises = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(iterable);
  <span class="hljs-keyword">if</span> (promises.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>([]);

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(promises.<span class="hljs-property">length</span>);
    <span class="hljs-keyword">let</span> settledCount = <span class="hljs-number">0</span>;

    promises.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> {
      <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(item)
        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> {
          result[index] = value;
          settledCount++;
          <span class="hljs-keyword">if</span> (settledCount === promises.<span class="hljs-property">length</span>) <span class="hljs-title function_">resolve</span>(result);
        })
        .<span class="hljs-title function_">catch</span>(reject); <span class="hljs-comment">// ä»»ä¸€å¤±è´¥ï¼Œæ•´ä½“å¤±è´¥</span>
    });
  });
};
</code></pre>
<hr/>
<h2 data-id="heading-7">2. <code>Promise.any()</code>ï¼šé€»è¾‘æˆ–é—¨ï¼ˆOR Gateï¼‰</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é€»è¾‘è¡¨è¾¾å¼: OUTPUT = INPUTâ‚ âˆ¨ INPUTâ‚‚ âˆ¨ ... âˆ¨ INPUTâ‚™</span>
<span class="hljs-comment">// ä»»ä¸€è¾“å…¥ä¸º 1 æ—¶ï¼Œè¾“å‡ºä¸º 1ï¼›æ‰€æœ‰è¾“å…¥ä¸º 0 æ—¶ï¼Œè¾“å‡ºä¸º 0</span>
</code></pre>
<h3 data-id="heading-8">é€»è¾‘é—¨ç±»æ¯”</h3>
<ul>
<li><strong>OR é—¨ç‰¹æ€§</strong>ï¼šä»»ä¸€é«˜ç”µå¹³ â†’ é«˜ç”µå¹³ï¼›å…¨ä½ç”µå¹³ â†’ ä½ç”µå¹³</li>
<li><strong>å¯¹åº”è¡Œä¸º</strong>ï¼šä»»ä¸€ Promise æˆåŠŸå³æˆåŠŸï¼Œå…¨éƒ¨å¤±è´¥æ‰å¤±è´¥</li>
<li><strong>å…¸å‹åœºæ™¯</strong>ï¼šå¤š CDN åŠ è½½èµ„æºï¼Œå–æœ€å¿«æˆåŠŸçš„å“åº”</li>
</ul>
<h3 data-id="heading-9">çœŸå€¼è¡¨</h3>



































<table><thead><tr><th>Promiseâ‚</th><th>Promiseâ‚‚</th><th><code>Promise.any</code></th><th>è§£é‡Š</th></tr></thead><tbody><tr><td>1 (æˆåŠŸ)</td><td>1 (æˆåŠŸ)</td><td>1 (æˆåŠŸ)</td><td>ä»»ä¸€æˆåŠŸå³å¯</td></tr><tr><td>1 (æˆåŠŸ)</td><td>0 (å¤±è´¥)</td><td>1 (æˆåŠŸ)</td><td>ä»»ä¸€æˆåŠŸå³å¯</td></tr><tr><td>0 (å¤±è´¥)</td><td>1 (æˆåŠŸ)</td><td>1 (æˆåŠŸ)</td><td>ä»»ä¸€æˆåŠŸå³å¯</td></tr><tr><td>0 (å¤±è´¥)</td><td>0 (å¤±è´¥)</td><td>0 (å¤±è´¥)</td><td>å…¨éƒ¨å¤±è´¥</td></tr></tbody></table>
<h3 data-id="heading-10">ç‰¹æ€§</h3>
<ol>
<li><strong>å¿«é€ŸæˆåŠŸ</strong>ï¼šç¬¬ä¸€ä¸ª fulfill ç«‹å³ resolve æ•´ä½“</li>
<li><strong>AggregateError</strong>ï¼šå…¨éƒ¨å¤±è´¥æ—¶ï¼Œèšåˆæ‰€æœ‰é”™è¯¯</li>
<li><strong>ä¹è§‚ç­–ç•¥</strong>ï¼šä¼˜å…ˆå¯»æ‰¾æˆåŠŸè·¯å¾„</li>
</ol>
<h3 data-id="heading-11">å®ç°</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">Promise</span>.<span class="hljs-property">myAny</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">iterable</span>) {
  <span class="hljs-keyword">if</span> (iterable == <span class="hljs-literal">null</span> || <span class="hljs-keyword">typeof</span> iterable[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>] !== <span class="hljs-string">"function"</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">"Argument is not iterable"</span>));
  }

  <span class="hljs-keyword">const</span> promises = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(iterable);
  <span class="hljs-keyword">if</span> (promises.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(
      <span class="hljs-keyword">new</span> <span class="hljs-title class_">AggregateError</span>([], <span class="hljs-string">"All promises were rejected"</span>)
    );
  }

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> errors = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(promises.<span class="hljs-property">length</span>);
    <span class="hljs-keyword">let</span> settledCount = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> resolved = <span class="hljs-literal">false</span>;

    promises.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> {
      <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(item)
        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> {
          <span class="hljs-keyword">if</span> (!resolved) {
            resolved = <span class="hljs-literal">true</span>;
            <span class="hljs-title function_">resolve</span>(value); <span class="hljs-comment">// ç¬¬ä¸€ä¸ªæˆåŠŸå³è¿”å›</span>
          }
        })
        .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">reason</span> =&gt;</span> {
          errors[index] = reason;
          settledCount++;
          <span class="hljs-keyword">if</span> (settledCount === promises.<span class="hljs-property">length</span> &amp;&amp; !resolved) {
            <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AggregateError</span>(errors, <span class="hljs-string">"All promises were rejected"</span>));
          }
        });
    });
  });
};
</code></pre>
<hr/>
<h2 data-id="heading-12">3ï¸.<code>Promise.race()</code>ï¼šé€‰æ‹©å™¨ / é”å­˜å™¨ï¼ˆSelector / Latchï¼‰</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é€»è¾‘è¡¨è¾¾å¼: OUTPUT = FIRST_SETTLED(INPUTâ‚, INPUTâ‚‚, ..., INPUTâ‚™)</span>
<span class="hljs-comment">// è¾“å‡ºç­‰äºç¬¬ä¸€ä¸ª settledï¼ˆfulfilled æˆ– rejectedï¼‰çš„è¾“å…¥</span>
</code></pre>
<h3 data-id="heading-13">é€»è¾‘é—¨ç±»æ¯”</h3>
<ul>
<li><strong>é€‰æ‹©å™¨ç‰¹æ€§</strong>ï¼šæ•è·ç¬¬ä¸€ä¸ªå˜åŒ–çš„ä¿¡å·</li>
<li><strong>å¯¹åº”è¡Œä¸º</strong>ï¼šè°å…ˆ settleï¼ˆæ— è®ºæˆåŠŸ/å¤±è´¥ï¼‰ï¼Œè°å†³å®šç»“æœ</li>
<li><strong>å…¸å‹åœºæ™¯</strong>ï¼šè¶…æ—¶æ§åˆ¶ã€ç«æ€è¯·æ±‚ã€æœ€å¿«å“åº”è·å–</li>
</ul>
<h3 data-id="heading-14">è¡Œä¸ºè¡¨</h3>




















<table><thead><tr><th>ç¬¬ä¸€ä¸ª settled</th><th>ç»“æœ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>fulfilled</td><td>æˆåŠŸ</td><td>è¿”å›å…¶å€¼</td></tr><tr><td>rejected</td><td>å¤±è´¥</td><td>æŠ›å‡ºå…¶é”™è¯¯</td></tr></tbody></table>
<h3 data-id="heading-15">ç‰¹æ€§</h3>
<ol>
<li><strong>èµ¢å®¶é€šåƒ</strong>ï¼šç¬¬ä¸€ä¸ª settle çš„ Promise å†³å®šä¸€åˆ‡</li>
<li><strong>å¿½ç•¥åç»­</strong>ï¼šå…¶ä½™ Promise è¢«ä¸¢å¼ƒï¼ˆä½†ä»åœ¨åå°è¿è¡Œï¼‰</li>
<li><strong>éç¡®å®šæ€§</strong>ï¼šç»“æœå–å†³äºæ‰§è¡Œæ—¶åº</li>
</ol>
<h3 data-id="heading-16">å®ç°</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">Promise</span>.<span class="hljs-property">myRace</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">iterable</span>) {
  <span class="hljs-keyword">if</span> (iterable == <span class="hljs-literal">null</span> || <span class="hljs-keyword">typeof</span> iterable[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>] !== <span class="hljs-string">"function"</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">"Argument is not iterable"</span>));
  }

  <span class="hljs-keyword">const</span> promises = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(iterable);
  <span class="hljs-comment">// è§„èŒƒï¼šPromise.race([]) æ°¸è¿œ pending</span>
  <span class="hljs-keyword">if</span> (promises.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">() =&gt;</span> {}); <span class="hljs-comment">// æ°¸ä¸ settle</span>
  }

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    promises.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
      <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(item).<span class="hljs-title function_">then</span>(resolve, reject);
    });
  });
};
</code></pre>
<hr/>
<h2 data-id="heading-17">4ï¸.<code>Promise.allSettled()</code>ï¼šçŠ¶æ€æ”¶é›†å™¨ï¼ˆState Collectorï¼‰</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é€»è¾‘è¡¨è¾¾å¼: OUTPUT = COLLECT(STATUS(INPUTâ‚), ..., STATUS(INPUTâ‚™))</span>
<span class="hljs-comment">// æ”¶é›†æ‰€æœ‰ Promise çš„æœ€ç»ˆçŠ¶æ€ï¼Œæ°¸ä¸ reject</span>
</code></pre>
<h3 data-id="heading-18">é€»è¾‘é—¨ç±»æ¯”</h3>
<ul>
<li><strong>çŠ¶æ€å¯„å­˜å™¨</strong>ï¼šè®°å½•æ¯ä¸€ä½çš„æœ€ç»ˆçŠ¶æ€ï¼Œä¸åšé€»è¾‘è¿ç®—</li>
<li><strong>å¯¹åº”è¡Œä¸º</strong>ï¼šç­‰å¾…æ‰€æœ‰ Promise settleï¼Œè¿”å›å®Œæ•´çŠ¶æ€å¿«ç…§</li>
<li><strong>å…¸å‹åœºæ™¯</strong>ï¼šæ‰¹é‡ä»»åŠ¡æ—¥å¿—ã€ç»“æœåˆ†æã€å®¹é”™æ±‡æ€»</li>
</ul>
<h3 data-id="heading-19">è¾“å‡º</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æˆåŠŸ</span>
{ <span class="hljs-attr">status</span>: <span class="hljs-string">'fulfilled'</span>, <span class="hljs-attr">value</span>: result }

<span class="hljs-comment">// å¤±è´¥</span>
{ <span class="hljs-attr">status</span>: <span class="hljs-string">'rejected'</span>, <span class="hljs-attr">reason</span>: error } 
</code></pre>
<h3 data-id="heading-20">ç‰¹æ€§</h3>
<ol>
<li><strong>æ°¸ä¸å¤±è´¥</strong>ï¼šè¿”å›çš„ Promise æ€»æ˜¯ fulfilled</li>
<li><strong>å®Œæ•´è¯Šæ–­</strong>ï¼šæ¯ä¸ª Promise çš„çŠ¶æ€å’Œæ•°æ®éƒ½å¯è¿½æº¯</li>
<li><strong>æ— çŸ­è·¯</strong>ï¼šå¿…é¡»ç­‰æ‰€æœ‰ Promise settle</li>
</ol>
<h3 data-id="heading-21">è§„èŒƒ</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">Promise</span>.<span class="hljs-property">myAllSettled</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">iterable</span>) {
  <span class="hljs-keyword">if</span> (iterable == <span class="hljs-literal">null</span> || <span class="hljs-keyword">typeof</span> iterable[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>] !== <span class="hljs-string">"function"</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">"Argument is not iterable"</span>));
  }

  <span class="hljs-keyword">const</span> promises = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(iterable);
  <span class="hljs-keyword">if</span> (promises.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>([]);

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(promises.<span class="hljs-property">length</span>);
    <span class="hljs-keyword">let</span> completedCount = <span class="hljs-number">0</span>;

    promises.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> {
      <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(item)
        .<span class="hljs-title function_">then</span>(
          <span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> {
            result[index] = { <span class="hljs-attr">status</span>: <span class="hljs-variable constant_">FULFILLED</span>, value };
          },
          <span class="hljs-function"><span class="hljs-params">reason</span> =&gt;</span> {
            result[index] = { <span class="hljs-attr">status</span>: <span class="hljs-variable constant_">REJECTED</span>, reason }; 
          }
        )
        .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> {
          completedCount++;
          <span class="hljs-keyword">if</span> (completedCount === promises.<span class="hljs-property">length</span>) <span class="hljs-title function_">resolve</span>(result);
        });
    });
  });
};
</code></pre>
<hr/>
<h2 data-id="heading-22">å››æ–¹æ³•å¯¹æ¯”çŸ©é˜µ</h2>













































<table><thead><tr><th>æ–¹æ³•</th><th>é€»è¾‘ç±»æ¯”</th><th>æˆåŠŸæ¡ä»¶</th><th>å¤±è´¥æ¡ä»¶</th><th>è¾“å‡ºç±»å‹</th><th>æ˜¯å¦çŸ­è·¯</th></tr></thead><tbody><tr><td><code>Promise.all</code></td><td>AND é—¨</td><td>å…¨éƒ¨æˆåŠŸ</td><td>ä»»ä¸€å¤±è´¥</td><td>å€¼æ•°ç»„</td><td>âœ…ï¼ˆå¤±è´¥ï¼‰</td></tr><tr><td><code>Promise.any</code></td><td>OR é—¨</td><td>ä»»ä¸€æˆåŠŸ</td><td>å…¨éƒ¨å¤±è´¥</td><td>å•ä¸ªå€¼</td><td>âœ…ï¼ˆæˆåŠŸï¼‰</td></tr><tr><td><code>Promise.race</code></td><td>é€‰æ‹©å™¨</td><td>ç¬¬ä¸€ä¸ªæˆåŠŸ</td><td>ç¬¬ä¸€ä¸ªå¤±è´¥</td><td>å•ä¸ªå€¼</td><td>âœ…</td></tr><tr><td><code>Promise.allSettled</code></td><td>çŠ¶æ€å¯„å­˜å™¨</td><td>æ€»æ˜¯æˆåŠŸ</td><td>æ°¸ä¸å¤±è´¥</td><td>çŠ¶æ€å¯¹è±¡æ•°ç»„</td><td>âŒ</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-23">é«˜çº§ç»„åˆæ¨¡å¼ï¼ˆå¼‚æ­¥â€œç»„åˆç”µè·¯â€ï¼‰</h2>
<h3 data-id="heading-24">1. å¸¦è¶…æ—¶çš„ AND è¿ç®—</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">allWithTimeout</span>(<span class="hljs-params">promises, timeoutMs</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">race</span>([
    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(promises),
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">_, reject</span>) =&gt;</span>
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Timeout'</span>)), timeoutMs)
    )
  ]);
}
<span class="hljs-comment">// ç”µè·¯ï¼šAND é—¨ + è¶…æ—¶é€‰æ‹©å™¨</span>
</code></pre>
<h3 data-id="heading-25">2. å¤šæ•°è¡¨å†³ç”µè·¯ï¼ˆMajority Voteï¼‰</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">majority</span>(<span class="hljs-params">promises</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">allSettled</span>(promises).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">results</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> successes = results.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-property">status</span> === <span class="hljs-string">'fulfilled'</span>);
    <span class="hljs-keyword">const</span> failures = results.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-property">status</span> === <span class="hljs-string">'rejected'</span>);

    <span class="hljs-keyword">if</span> (successes.<span class="hljs-property">length</span> &gt; failures.<span class="hljs-property">length</span>) {
      <span class="hljs-keyword">return</span> successes.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">s</span> =&gt;</span> s.<span class="hljs-property">value</span>);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AggregateError</span>(
        failures.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">f</span> =&gt;</span> f.<span class="hljs-property">reason</span>),
        <span class="hljs-string">'Majority of promises rejected'</span>
      );
    }
  });
}
<span class="hljs-comment">// ç”µè·¯ï¼šçŠ¶æ€å¯„å­˜å™¨ + æ¯”è¾ƒå™¨ + é€‰æ‹©å™¨</span>
</code></pre>
<h3 data-id="heading-26">3. ä¼˜å…ˆçº§ä»²è£å™¨ï¼ˆé¡ºåºå°è¯•ï¼‰</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">priorityArbitrator</span>(<span class="hljs-params">promiseFactories</span>) {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> factory <span class="hljs-keyword">of</span> promiseFactories) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-title function_">factory</span>();
    } <span class="hljs-keyword">catch</span> {
      <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// å°è¯•ä¸‹ä¸€ä¸ª</span>
    }
  }
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'All attempts failed'</span>);
}
<span class="hljs-comment">// ç”µè·¯ï¼šä¼˜å…ˆçº§ç¼–ç å™¨ + OR é—¨</span>
</code></pre>
<hr/>
<p>é€šè¿‡é€»è¾‘é—¨è§†è§’ç†è§£ Promise ç»„åˆæ–¹æ³•ï¼Œæˆ‘ä»¬èƒ½ï¼š</p>
<ol>
<li><strong>å»ºç«‹ç›´è§‰æ¨¡å‹</strong>ï¼šå°†æŠ½è±¡å¼‚æ­¥æµæ˜ å°„åˆ°ç†Ÿæ‚‰ç”µè·¯æ¦‚å¿µ</li>
<li><strong>é¢„æµ‹è¡Œä¸º</strong>ï¼šåƒåˆ†æçœŸå€¼è¡¨ä¸€æ ·æ¨ç†å¤æ‚å¼‚æ­¥é€»è¾‘</li>
<li><strong>è®¾è®¡æ–°æ¨¡å¼</strong>ï¼šå€Ÿé‰´ç”µè·¯è®¾è®¡æ€æƒ³æ„å»ºè‡ªå®šä¹‰æ§åˆ¶æµ</li>
<li><strong>è°ƒè¯•ä¼˜åŒ–</strong>ï¼šè¯†åˆ«â€œçŸ­è·¯ç‚¹â€ã€â€œç«äº‰æ¡ä»¶â€ã€â€œçŠ¶æ€ä¸¢å¤±â€ç­‰é—®é¢˜</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Web å¤šåª’ä½“æŠ€æœ¯æ ˆç®€è¿°]]></title>    <link>https://juejin.cn/post/7595890117866373166</link>    <guid>https://juejin.cn/post/7595890117866373166</guid>    <pubDate>2026-01-17T15:50:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595890117866373166" data-draft-id="7596299957277081627" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Web å¤šåª’ä½“æŠ€æœ¯æ ˆç®€è¿°"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-17T15:50:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ¸©å®‡é£"/> <meta itemprop="url" content="https://juejin.cn/user/4300945219403368"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Web å¤šåª’ä½“æŠ€æœ¯æ ˆç®€è¿°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4300945219403368/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ¸©å®‡é£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T15:50:55.000Z" title="Sat Jan 17 2026 15:50:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»53åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Web å¤šåª’ä½“æŠ€æœ¯æ ˆæ˜¯ç°ä»£ Web åº”ç”¨å¤„ç†éŸ³è§†é¢‘å†…å®¹çš„æŠ€æœ¯é›†åˆã€‚æœ¬æ–‡ä»æŠ€æœ¯åŸç†å‡ºå‘ï¼Œç³»ç»Ÿä»‹ç»ä»åª’ä½“é‡‡é›†ã€ç¼–è§£ç ã€ä¼ è¾“åˆ°æ’­æ”¾æ¸²æŸ“çš„å®Œæ•´æŠ€æœ¯é“¾è·¯ï¼Œæ¶µç›– getUserMediaã€MediaRecorderã€HTMLMediaElementã€MSEã€Web Audio APIã€WebCodecsã€HLS/DASHã€WebRTC ç­‰æ ¸å¿ƒ APIï¼Œä»¥åŠ DRMã€æ€§èƒ½ä¼˜åŒ–ç­‰å·¥ç¨‹å®è·µã€‚</p>
<h2 data-id="heading-0">æ ¸å¿ƒæ¦‚å¿µä¸æœ¯è¯­</h2>
<p>åœ¨æ·±å…¥æŠ€æœ¯ç»†èŠ‚å‰ï¼Œå…ˆäº†è§£ä¸€äº›å¤šåª’ä½“é¢†åŸŸçš„æ ¸å¿ƒæ¦‚å¿µï¼š</p>
<p><strong>åŸºç¡€æœ¯è¯­ï¼š</strong></p>
<ul>
<li><strong>ç ç‡(Bitrate)</strong>ï¼šè§†é¢‘æ¯ç§’ä¼ è¾“çš„æ•°æ®é‡ï¼Œå•ä½é€šå¸¸ä¸º Kbps/Mbpsã€‚ç ç‡è¶Šé«˜ç”»è´¨è¶Šå¥½ï¼Œä½†æ–‡ä»¶è¶Šå¤§ã€‚ä¾‹å¦‚ 1080p è§†é¢‘é€šå¸¸éœ€è¦ 5-10 Mbps ç ç‡</li>
<li><strong>å¸§ç‡(fps)</strong>ï¼šæ¯ç§’æ˜¾ç¤ºçš„ç”»é¢æ•°é‡ã€‚å¸¸è§å€¼æœ‰ 24fps(ç”µå½±)ã€30fps(æ ‡å‡†è§†é¢‘)ã€60fps(é«˜æµç•…åº¦)</li>
<li><strong>åˆ†è¾¨ç‡(Resolution)</strong>ï¼šè§†é¢‘ç”»é¢çš„åƒç´ å°ºå¯¸ï¼Œå¦‚ 1920Ã—1080(1080p)ã€3840Ã—2160(4K)</li>
<li><strong>ç¼–è§£ç å™¨(Codec)</strong>ï¼šå‹ç¼©(ç¼–ç )å’Œè§£å‹(è§£ç )éŸ³è§†é¢‘æ•°æ®çš„ç®—æ³•ï¼Œå¦‚ H.264ã€AAC</li>
</ul>
<p><strong>è§†é¢‘ç›¸å…³ï¼š</strong></p>
<ul>
<li><strong>YUV/RGB</strong>ï¼šé¢œè‰²ç©ºé—´æ ¼å¼ã€‚RGB æ¯ä¸ªåƒç´ ç”¨çº¢ç»¿è“ä¸‰è‰²è¡¨ç¤ºï¼ŒYUV åˆ†ç¦»äº®åº¦(Y)å’Œè‰²åº¦(UV)ï¼Œæ›´é€‚åˆå‹ç¼©</li>
<li><strong>I/P/B å¸§</strong>ï¼šè§†é¢‘ç¼–ç çš„ä¸‰ç§å¸§ç±»å‹
<ul>
<li>I å¸§(å…³é”®å¸§)ï¼šå®Œæ•´ç”»é¢ï¼Œè§£ç ä¸ä¾èµ–å…¶ä»–å¸§</li>
<li>P å¸§(é¢„æµ‹å¸§)ï¼šå­˜å‚¨ä¸å‰ä¸€å¸§çš„å·®å¼‚</li>
<li>B å¸§(åŒå‘å¸§)ï¼šå‚è€ƒå‰åå¸§ï¼Œå‹ç¼©ç‡æœ€é«˜</li>
</ul>
</li>
<li><strong>PTS/DTS</strong>ï¼šæ—¶é—´æˆ³ï¼Œç”¨äºéŸ³è§†é¢‘åŒæ­¥
<ul>
<li>PTS(Presentation Time Stamp)ï¼šæ˜¾ç¤ºæ—¶é—´æˆ³</li>
<li>DTS(Decode Time Stamp)ï¼šè§£ç æ—¶é—´æˆ³</li>
</ul>
</li>
</ul>
<p><strong>éŸ³é¢‘ç›¸å…³ï¼š</strong></p>
<ul>
<li><strong>PCM(Pulse Code Modulation)</strong>ï¼šè„‰å†²ç¼–ç è°ƒåˆ¶ï¼ŒéŸ³é¢‘çš„åŸå§‹æœªå‹ç¼©æ ¼å¼</li>
<li><strong>é‡‡æ ·ç‡(Sample Rate)</strong>ï¼šæ¯ç§’é‡‡æ ·æ¬¡æ•°ï¼Œå¦‚ 44.1kHz(CD éŸ³è´¨)ã€48kHz(ä¸“ä¸šéŸ³é¢‘)</li>
<li><strong>é‡‡æ ·æ·±åº¦(Bit Depth)</strong>ï¼šæ¯ä¸ªé‡‡æ ·çš„ä½æ•°ï¼Œå¦‚ 16bitã€24bitã€‚ä½æ•°è¶Šé«˜éŸ³è´¨è¶Šå¥½</li>
</ul>
<p><strong>æµåª’ä½“ç›¸å…³ï¼š</strong></p>
<ul>
<li><strong>HLS/DASH</strong>ï¼šHTTP è‡ªé€‚åº”æµåè®®ï¼Œå°†è§†é¢‘åˆ‡åˆ†æˆå°ç‰‡æ®µé€šè¿‡ HTTP ä¼ è¾“</li>
<li><strong>ABR(Adaptive Bitrate)</strong>ï¼šè‡ªé€‚åº”ç ç‡ï¼Œæ ¹æ®ç½‘ç»œçŠ¶å†µåŠ¨æ€åˆ‡æ¢ä¸åŒç ç‡æ¡£ä½</li>
<li><strong>MSE(Media Source Extensions)</strong>ï¼šå…è®¸ JavaScript æ§åˆ¶è§†é¢‘æµçš„æ’­æ”¾</li>
<li><strong>CDN(Content Delivery Network)</strong>ï¼šå†…å®¹åˆ†å‘ç½‘ç»œï¼ŒåŠ é€Ÿè§†é¢‘ä¼ è¾“</li>
</ul>
<p><strong>å®æ—¶é€šä¿¡ç›¸å…³ï¼š</strong></p>
<ul>
<li><strong>WebRTC</strong>ï¼šWeb å®æ—¶é€šä¿¡æŠ€æœ¯ï¼Œæ”¯æŒæµè§ˆå™¨é—´ç‚¹å¯¹ç‚¹éŸ³è§†é¢‘ä¼ è¾“</li>
<li><strong>ICE/STUN/TURN</strong>ï¼šWebRTC è¿æ¥å»ºç«‹ç›¸å…³åè®®</li>
<li><strong>å»¶è¿Ÿ(Latency)</strong>ï¼šä»å‘é€ç«¯åˆ°æ¥æ”¶ç«¯çš„æ—¶é—´å·®ï¼Œå®æ—¶é€šä¿¡è¦æ±‚ä½å»¶è¿Ÿ(&lt;200ms)</li>
</ul>
<h2 data-id="heading-1">å¤šåª’ä½“å¤„ç†å…¨æµç¨‹</h2>
<p>ç†è§£ Web å¤šåª’ä½“æŠ€æœ¯æ ˆï¼Œéœ€è¦å…ˆäº†è§£å¤šåª’ä½“æ•°æ®ä»é‡‡é›†åˆ°æ’­æ”¾çš„å®Œæ•´æµç¨‹ã€‚è¿™ä¸ªæµç¨‹æ¶‰åŠå¤šä¸ªå…³é”®ç¯èŠ‚ï¼Œæ¯ä¸ªç¯èŠ‚éƒ½æœ‰å¯¹åº”çš„ Web æŠ€æœ¯æ”¯æŒã€‚</p>
<h3 data-id="heading-2">æ ¸å¿ƒæµç¨‹</h3>
<pre><code class="hljs">é‡‡é›† â†’ ç¼–ç  â†’ å°è£… â†’ ä¼ è¾“ â†’ è§£å°è£… â†’ è§£ç  â†’ æ¸²æŸ“
</code></pre>
<p><strong>1. é‡‡é›†(Capture)</strong></p>
<p>ä»ç‰©ç†è®¾å¤‡è·å–åŸå§‹éŸ³è§†é¢‘æ•°æ®ï¼š</p>
<ul>
<li><strong>è§†é¢‘é‡‡é›†</strong>ï¼šæ‘„åƒå¤´è¾“å‡º YUV/RGB åŸå§‹åƒç´ æ•°æ®ã€‚æ¯ä¸ªåƒç´ åŒ…å«é¢œè‰²ä¿¡æ¯(RGB å„å  1 å­—èŠ‚)ï¼Œ1080p(1920Ã—1080)ä¸€å¸§çº¦ 6MBï¼Œ30fps è§†é¢‘æµè¾¾åˆ°çº¦ 180MB/ç§’</li>
<li><strong>éŸ³é¢‘é‡‡é›†</strong>ï¼šéº¦å…‹é£è¾“å‡º PCM(Pulse Code Modulationï¼Œè„‰å†²ç¼–ç è°ƒåˆ¶)åŸå§‹éŸ³é¢‘æ•°æ®ã€‚é‡‡æ ·ç‡é€šå¸¸ä¸º 48kHz(æ¯ç§’é‡‡æ · 48000 æ¬¡)ï¼Œ16bit é‡‡æ ·æ·±åº¦ï¼Œç«‹ä½“å£°çº¦ 192KB/ç§’</li>
</ul>
<p><strong>2. ç¼–ç (Encoding)</strong></p>
<p>åŸå§‹æ•°æ®ä½“ç§¯å·¨å¤§ï¼Œå¿…é¡»å‹ç¼©æ‰èƒ½ä¼ è¾“å’Œå­˜å‚¨ï¼š</p>
<ul>
<li><strong>è§†é¢‘ç¼–ç </strong>ï¼šH.264/H.265/VP9/AV1 ç­‰ç¼–ç å™¨å°†åŸå§‹åƒç´ å‹ç¼©ä¸ºç æµï¼Œå‹ç¼©æ¯”å¯è¾¾ 100:1
<ul>
<li><strong>I å¸§(å…³é”®å¸§ Intra Frame)</strong>ï¼šå®Œæ•´å›¾åƒï¼Œè§£ç ä¸ä¾èµ–å…¶ä»–å¸§ï¼Œæ–‡ä»¶ä½“ç§¯å¤§</li>
<li><strong>P å¸§(é¢„æµ‹å¸§ Predicted Frame)</strong>ï¼šåªå­˜å‚¨ä¸å‰ä¸€å¸§çš„å·®å¼‚ï¼ŒèŠ‚çœç©ºé—´</li>
<li><strong>B å¸§(åŒå‘é¢„æµ‹å¸§ Bi-directional Frame)</strong>ï¼šå‚è€ƒå‰åå¸§çš„å·®å¼‚ï¼Œå‹ç¼©ç‡æœ€é«˜</li>
</ul>
</li>
<li><strong>éŸ³é¢‘ç¼–ç </strong>ï¼šAAC/Opus/MP3 å°† PCM å‹ç¼©ä¸ºç æµï¼Œå‹ç¼©æ¯”çº¦ 10:1</li>
</ul>
<p><strong>3. å°è£…(Muxing)</strong></p>
<p>å°†ç¼–ç åçš„éŸ³è§†é¢‘æµã€å­—å¹•ã€å…ƒæ•°æ®ç­‰æ‰“åŒ…åˆ°å®¹å™¨æ ¼å¼ï¼š</p>
<ul>
<li><strong>MP4</strong>ï¼šæœ€é€šç”¨çš„å®¹å™¨æ ¼å¼ï¼ŒåŒ…å« ftyp/moov/mdat ç­‰ Box ç»“æ„</li>
<li><strong>WebM</strong>ï¼šå¼€æºå®¹å™¨ï¼ŒåŸºäº Matroska</li>
<li><strong>FLV</strong>ï¼šFlash Video å®¹å™¨ï¼Œé€æ¸è¢«æ·˜æ±°</li>
</ul>
<p>å®¹å™¨è´Ÿè´£å°†å¤šä¸ªæµ(éŸ³é¢‘ã€è§†é¢‘ã€å­—å¹•)äº¤ç»‡å­˜å‚¨ï¼Œå¹¶è®°å½•æ—¶é—´æˆ³(PTS/DTS)ç”¨äºåŒæ­¥ã€‚</p>
<p><strong>4. ä¼ è¾“(Transmission)</strong></p>
<p>é€šè¿‡ç½‘ç»œåè®®ä¼ è¾“åª’ä½“æ•°æ®ï¼š</p>
<ul>
<li><strong>HTTP + è‡ªé€‚åº”æµåè®®</strong>ï¼š
<ul>
<li><strong>HLS (HTTP Live Streaming)</strong>ï¼šApple æå‡ºï¼Œå°†è§†é¢‘åˆ‡åˆ†æˆ TS ç‰‡æ®µ(é€šå¸¸ 6-10 ç§’)ï¼Œé€šè¿‡ m3u8 ç´¢å¼•æ–‡ä»¶æè¿°ç‰‡æ®µåˆ—è¡¨ã€‚å®¢æˆ·ç«¯æ ¹æ®ç½‘ç»œçŠ¶å†µé€‰æ‹©ä¸åŒç ç‡çš„ç‰‡æ®µ</li>
<li><strong>DASH (Dynamic Adaptive Streaming over HTTP)</strong>ï¼šå›½é™…æ ‡å‡†ï¼Œä½¿ç”¨ MPD(Media Presentation Description)æè¿°ç‰‡æ®µï¼Œæ”¯æŒ MP4/WebM å®¹å™¨</li>
<li>è‡ªé€‚åº”åŸç†ï¼šåŒä¸€è§†é¢‘å‡†å¤‡å¤šä¸ªç ç‡ç‰ˆæœ¬(å¦‚ 480p/720p/1080p)ï¼Œå®¢æˆ·ç«¯ç›‘æµ‹å¸¦å®½åŠ¨æ€åˆ‡æ¢</li>
</ul>
</li>
<li><strong>RTP/RTCP</strong>ï¼šWebRTC å®æ—¶ä¼ è¾“åè®®ï¼ŒåŸºäº UDP ä¼ è¾“ï¼Œå®¹å¿ä¸¢åŒ…æ¢å–ä½å»¶è¿Ÿ</li>
<li><strong>WebSocket</strong>ï¼šä¿¡ä»¤é€šé“å’Œè‡ªå®šä¹‰ä¼ è¾“</li>
</ul>
<p><strong>5. è§£å°è£…(Demuxing)</strong></p>
<p>ä»å®¹å™¨æ ¼å¼ä¸­åˆ†ç¦»éŸ³è§†é¢‘æµï¼š</p>
<ul>
<li>è§£æå®¹å™¨ç»“æ„ï¼Œæå–éŸ³é¢‘æµã€è§†é¢‘æµã€å­—å¹•æµ</li>
<li>è·å–æ¯ä¸ªæµçš„ç¼–ç å‚æ•°(codecã€åˆ†è¾¨ç‡ã€ç ç‡ç­‰)</li>
</ul>
<p><strong>6. è§£ç (Decoding)</strong></p>
<p>å°†å‹ç¼©çš„ç æµè¿˜åŸä¸ºåŸå§‹æ•°æ®ï¼š</p>
<ul>
<li><strong>ç¡¬ä»¶è§£ç </strong>ï¼šè°ƒç”¨ GPU è§£ç å•å…ƒ(å¦‚ NVDECã€VideoToolboxã€MediaCodec)ï¼ŒåŠŸè€—ä½ã€æ€§èƒ½é«˜</li>
<li><strong>è½¯ä»¶è§£ç </strong>ï¼šä½¿ç”¨ CPU è§£ç ï¼Œå…¼å®¹æ€§å¥½ä½†æ€§èƒ½å—é™</li>
</ul>
<p><strong>7. æ¸²æŸ“(Rendering)</strong></p>
<p>å°†è§£ç åçš„æ•°æ®è¾“å‡ºåˆ°æ˜¾ç¤ºè®¾å¤‡ï¼š</p>
<ul>
<li><strong>è§†é¢‘æ¸²æŸ“</strong>ï¼šYUV â†’ RGB é¢œè‰²ç©ºé—´è½¬æ¢ â†’ è¾“å‡ºåˆ° Canvas/WebGL</li>
<li><strong>éŸ³é¢‘æ¸²æŸ“</strong>ï¼šPCM æ•°æ® â†’ éŸ³é¢‘é©±åŠ¨ â†’ æ‰¬å£°å™¨</li>
<li><strong>éŸ³è§†é¢‘åŒæ­¥(A/V Sync)</strong>ï¼šæ ¹æ® PTS(Presentation Time Stamp)æ—¶é—´æˆ³å¯¹é½éŸ³è§†é¢‘å¸§</li>
</ul>
<h3 data-id="heading-3">Web æŠ€æœ¯æ ˆæ˜ å°„</h3>


















































<table><thead><tr><th>ç¯èŠ‚</th><th>ç›¸å…³æŠ€æœ¯</th><th>ç« èŠ‚</th></tr></thead><tbody><tr><td>é‡‡é›†</td><td>getUserMediaã€getDisplayMedia</td><td>åª’ä½“æ•è·ä¸è¾“å…¥æŠ€æœ¯</td></tr><tr><td>ç¼–ç /è§£ç </td><td>WebCodecsã€ç¼–ç æ ¼å¼(H.264/AAC)</td><td>ç¼–è§£ç ä¸å®¹å™¨æ ¼å¼ã€åª’ä½“å¤„ç†ä¸ç¼–è¾‘æŠ€æœ¯</td></tr><tr><td>å°è£…/è§£å°è£…</td><td>å®¹å™¨æ ¼å¼(MP4/WebM)</td><td>ç¼–è§£ç ä¸å®¹å™¨æ ¼å¼</td></tr><tr><td>ä¼ è¾“</td><td>HLSã€DASHã€WebRTCã€WebSocket</td><td>æµåª’ä½“ä¼ è¾“æŠ€æœ¯ã€å®æ—¶é€šä¿¡æŠ€æœ¯</td></tr><tr><td>æ’­æ”¾æ§åˆ¶</td><td>HTMLMediaElementã€MSE</td><td>åª’ä½“æ’­æ”¾ä¸æ§åˆ¶æŠ€æœ¯</td></tr><tr><td>æ¸²æŸ“å¤„ç†</td><td>Canvasã€WebGLã€Web Audio API</td><td>åª’ä½“å¤„ç†ä¸ç¼–è¾‘æŠ€æœ¯</td></tr><tr><td>å­˜å‚¨</td><td>IndexedDBã€Blobã€Cache API</td><td>åª’ä½“å­˜å‚¨ä¸ç®¡ç†æŠ€æœ¯</td></tr><tr><td>å®‰å…¨</td><td>EMEã€DRM</td><td>å®‰å…¨ä¸ç‰ˆæƒä¿æŠ¤</td></tr></tbody></table>
<h3 data-id="heading-4">å…¸å‹åœºæ™¯æµç¨‹</h3>
<p><strong>åœºæ™¯ 1ï¼šæœ¬åœ°è§†é¢‘æ’­æ”¾</strong></p>
<pre><code class="hljs language-objectivec" lang="objectivec">ç½‘ç»œè¯·æ±‚ â†’ ä¸‹è½½ <span class="hljs-built_in">MP4</span> â†’ æµè§ˆå™¨è§£å°è£… â†’ è§£ç  â†’ æ¸²æŸ“
(HTMLMediaElement è‡ªåŠ¨å®Œæˆæ•´ä¸ªæµç¨‹)
</code></pre>
<p><strong>åœºæ™¯ 2ï¼šç›´æ’­æ¨æµ</strong></p>
<pre><code class="hljs">getUserMedia é‡‡é›† â†’ MediaRecorder ç¼–ç  â†’ WebSocket ä¼ è¾“ â†’ æœåŠ¡ç«¯è½¬å‘
</code></pre>
<p><strong>åœºæ™¯ 3ï¼šè‡ªé€‚åº”æµæ’­æ”¾(HLS/DASH)</strong></p>
<pre><code class="hljs language-scss" lang="scss">MSE è¯·æ±‚ç‰‡æ®µ â†’ åˆ†æ®µä¸‹è½½ â†’ JavaScript æ§åˆ¶è¿½åŠ æ•°æ® â†’ æµè§ˆå™¨è§£ç æ¸²æŸ“
(æ ¹æ®å¸¦å®½åŠ¨æ€åˆ‡æ¢ç ç‡)
</code></pre>
<p><strong>åœºæ™¯ 4ï¼šWebRTC è§†é¢‘é€šè¯</strong></p>
<pre><code class="hljs language-scss" lang="scss">å‘é€ç«¯ï¼šgetUserMedia é‡‡é›† â†’ ç¼–ç  â†’ RTP æ‰“åŒ… â†’ UDP ä¼ è¾“
æ¥æ”¶ç«¯ï¼šæ¥æ”¶ RTP â†’ è§£åŒ… â†’ è§£ç  â†’ æ¸²æŸ“
(ç«¯åˆ°ç«¯ä½å»¶è¿Ÿï¼Œæ— éœ€æœåŠ¡ç«¯è½¬ç )
</code></pre>
<h2 data-id="heading-5">åª’ä½“æ•è·ä¸è¾“å…¥æŠ€æœ¯</h2>
<p>åª’ä½“æ•è·ä¸è¾“å…¥æŠ€æœ¯æ˜¯ Web å¤šåª’ä½“åº”ç”¨çš„èµ·ç‚¹ï¼Œè´Ÿè´£è·å–ç”¨æˆ·è®¾å¤‡çš„éŸ³è§†é¢‘è¾“å…¥ã€‚é€šè¿‡è¿™äº› APIï¼Œæµè§ˆå™¨å¯ä»¥è®¿é—®æ‘„åƒå¤´ã€éº¦å…‹é£ã€å±å¹•ç­‰åª’ä½“æºï¼Œä¸ºè§†é¢‘ä¼šè®®ã€ç›´æ’­æ¨æµã€åœ¨çº¿å½•åˆ¶ç­‰åº”ç”¨æä¾›åŸºç¡€èƒ½åŠ›ã€‚</p>















































<table><thead><tr><th>API</th><th>ä¸»è¦åŠŸèƒ½</th><th>è¾“å…¥æº</th><th>è¾“å‡º</th><th>å…¸å‹ç”¨é€”</th></tr></thead><tbody><tr><td>getUserMedia</td><td>è®¿é—®éŸ³è§†é¢‘è®¾å¤‡</td><td>æ‘„åƒå¤´ã€éº¦å…‹é£</td><td>MediaStream</td><td>è§†é¢‘é€šè¯ã€ç›´æ’­é‡‡é›†</td></tr><tr><td>getDisplayMedia</td><td>æ•è·å±å¹•å†…å®¹</td><td>å±å¹•ã€çª—å£ã€æ ‡ç­¾é¡µ</td><td>MediaStream</td><td>å±å¹•å…±äº«ã€å½•å±</td></tr><tr><td>MediaRecorder</td><td>å½•åˆ¶åª’ä½“æµ</td><td>MediaStream</td><td>Blob(è§†é¢‘æ–‡ä»¶)</td><td>å½•åˆ¶ä¿å­˜ã€ä¸Šä¼ </td></tr><tr><td>ImageCapture</td><td>æ‹ç…§</td><td>VideoTrack</td><td>Blob/ImageBitmap</td><td>é«˜è´¨é‡æˆªå›¾ã€è¯ä»¶ç…§</td></tr><tr><td>MediaStream</td><td>æµå¯¹è±¡ç®¡ç†</td><td>-</td><td>è½¨é“æ“ä½œæ¥å£</td><td>æµçš„ç»„åˆã€æ§åˆ¶</td></tr></tbody></table>
<h3 data-id="heading-6">MediaDevices.getUserMedia - é‡‡é›†æ‘„åƒå¤´ä¸éº¦å…‹é£</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FMediaDevices%2FgetUserMedia" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia" ref="nofollow noopener noreferrer"><code>getUserMedia</code></a> æ˜¯ MediaDevices API çš„æ ¸å¿ƒæ–¹æ³•ï¼Œç”¨äºè¯·æ±‚è®¿é—®ç”¨æˆ·çš„æ‘„åƒå¤´å’Œéº¦å…‹é£è®¾å¤‡ã€‚</p>
<p><strong>åŸºç¡€ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">navigator.<span class="hljs-property">mediaDevices</span>
  .<span class="hljs-title function_">getUserMedia</span>({ <span class="hljs-attr">video</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">audio</span>: <span class="hljs-literal">true</span> })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">stream</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> video = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"video"</span>);
    video.<span class="hljs-property">srcObject</span> = stream; <span class="hljs-comment">// å°†åª’ä½“æµç»‘å®šåˆ° video å…ƒç´ </span>
  })
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"æ— æ³•è®¿é—®åª’ä½“è®¾å¤‡:"</span>, error);
  });
</code></pre>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li><strong>è®¾å¤‡è®¿é—®æ§åˆ¶</strong> - è¯·æ±‚æ‘„åƒå¤´ã€éº¦å…‹é£æƒé™ï¼Œæµè§ˆå™¨ä¼šå¼¹å‡ºæˆæƒæç¤º</li>
<li><strong>çº¦æŸå‚æ•°(Constraints)</strong> - æŒ‡å®šåˆ†è¾¨ç‡ã€å¸§ç‡ã€è®¾å¤‡ ID ç­‰å‚æ•°
<ul>
<li>è§†é¢‘çº¦æŸï¼š<code>width</code>ã€<code>height</code>ã€<code>frameRate</code>ã€<code>facingMode</code></li>
<li>éŸ³é¢‘çº¦æŸï¼š<code>echoCancellation</code>(å›å£°æ¶ˆé™¤)ã€<code>noiseSuppression</code>(å™ªå£°æŠ‘åˆ¶)ã€<code>autoGainControl</code>(è‡ªåŠ¨å¢ç›Š)</li>
</ul>
</li>
<li><strong>å¤šè®¾å¤‡æ”¯æŒ</strong> - é€šè¿‡ <code>facingMode</code> é€‰æ‹©å‰ç½®æˆ–åç½®æ‘„åƒå¤´</li>
<li><strong>è¿”å› MediaStream</strong> - è·å–åŒ…å«éŸ³è§†é¢‘è½¨é“çš„æµå¯¹è±¡ï¼Œå¯ç”¨äºæ’­æ”¾ã€å½•åˆ¶æˆ–ä¼ è¾“</li>
</ol>
<h3 data-id="heading-7">MediaDevices.getDisplayMedia - æ•è·å±å¹•å†…å®¹</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FMediaDevices%2FgetDisplayMedia" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getDisplayMedia" ref="nofollow noopener noreferrer"><code>getDisplayMedia</code></a> ç”¨äºæ•è·ç”¨æˆ·å±å¹•ã€çª—å£æˆ–æ ‡ç­¾é¡µçš„å†…å®¹ï¼Œæ˜¯å®ç°å±å¹•å…±äº«åŠŸèƒ½çš„æ ¸å¿ƒ APIã€‚</p>
<p><strong>åŸºç¡€ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">navigator.<span class="hljs-property">mediaDevices</span>
  .<span class="hljs-title function_">getDisplayMedia</span>({ <span class="hljs-attr">video</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">audio</span>: <span class="hljs-literal">true</span> })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">stream</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> video = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"video"</span>);
    video.<span class="hljs-property">srcObject</span> = stream; <span class="hljs-comment">// æ˜¾ç¤ºæ•è·çš„å±å¹•å†…å®¹</span>
  })
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"æ— æ³•æ•è·å±å¹•:"</span>, error);
  });
</code></pre>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li><strong>æ•è·æºé€‰æ‹©</strong> - æµè§ˆå™¨å¼¹å‡ºé€‰æ‹©å™¨ï¼Œç”¨æˆ·å¯é€‰æ‹©æ•´ä¸ªå±å¹•ã€ç‰¹å®šçª—å£æˆ–æµè§ˆå™¨æ ‡ç­¾é¡µ</li>
<li><strong>è§†é¢‘æ•è·</strong> - ä»¥è§†é¢‘æµå½¢å¼è·å–å±å¹•å†…å®¹ï¼Œæ”¯æŒè®¾ç½®åˆ†è¾¨ç‡å’Œå¸§ç‡</li>
<li><strong>éŸ³é¢‘æ•è·</strong> - å¯åŒæ—¶æ•è·ç³»ç»ŸéŸ³é¢‘æˆ–æ ‡ç­¾é¡µéŸ³é¢‘(æµè§ˆå™¨æ”¯æŒæœ‰é™)</li>
<li><strong>å…‰æ ‡æ•è·æ§åˆ¶</strong> - é€šè¿‡ <code>cursor</code> å‚æ•°æ§åˆ¶æ˜¯å¦æ˜¾ç¤ºé¼ æ ‡å…‰æ ‡</li>
<li><strong>è¿”å› MediaStream</strong> - ä¸ getUserMedia ç›¸åŒçš„æµå¯¹è±¡ï¼Œå¯ç”¨äºå½•åˆ¶æˆ– WebRTC ä¼ è¾“</li>
</ol>
<h3 data-id="heading-8">MediaRecorder - å½•åˆ¶éŸ³è§†é¢‘æµ</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FMediaRecorder" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/API/MediaRecorder" ref="nofollow noopener noreferrer"><code>MediaRecorder</code></a> ç”¨äºå°† MediaStream å½•åˆ¶ä¸ºéŸ³è§†é¢‘æ–‡ä»¶ï¼Œæ”¯æŒå®æ—¶å½•åˆ¶å’Œä¿å­˜ã€‚</p>
<p><strong>åŸºç¡€ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> stream = <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">mediaDevices</span>.<span class="hljs-title function_">getUserMedia</span>({ <span class="hljs-attr">video</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">audio</span>: <span class="hljs-literal">true</span> });
<span class="hljs-keyword">const</span> recorder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MediaRecorder</span>(stream);

<span class="hljs-keyword">const</span> chunks = [];
recorder.<span class="hljs-property">ondataavailable</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  chunks.<span class="hljs-title function_">push</span>(e.<span class="hljs-property">data</span>); <span class="hljs-comment">// æ”¶é›†å½•åˆ¶çš„æ•°æ®å—</span>
};

recorder.<span class="hljs-property">onstop</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Blob</span>(chunks, { <span class="hljs-attr">type</span>: <span class="hljs-string">"video/webm"</span> }); <span class="hljs-comment">// ç”Ÿæˆè§†é¢‘æ–‡ä»¶</span>
  <span class="hljs-keyword">const</span> url = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);
};

recorder.<span class="hljs-title function_">start</span>(); <span class="hljs-comment">// å¼€å§‹å½•åˆ¶</span>
<span class="hljs-comment">// recorder.stop();  // åœæ­¢å½•åˆ¶</span>
</code></pre>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li><strong>å½•åˆ¶ MediaStream</strong> - å°†éŸ³è§†é¢‘æµå½•åˆ¶ä¸º Blob æ•°æ®</li>
<li><strong>ç¼–ç æ ¼å¼æ”¯æŒ</strong> - æ”¯æŒ WebMã€MP4 ç­‰å®¹å™¨æ ¼å¼ï¼Œç¼–ç å™¨ä¸º VP8/VP9/H.264</li>
<li><strong>å®æ—¶æ•°æ®è¾“å‡º</strong> - é€šè¿‡ <code>dataavailable</code> äº‹ä»¶åˆ†æ®µè¾“å‡ºæ•°æ®ï¼Œæ”¯æŒæµå¼ä¿å­˜</li>
<li><strong>å½•åˆ¶æ§åˆ¶</strong> - æä¾› <code>start()</code>ã€<code>stop()</code>ã€<code>pause()</code>ã€<code>resume()</code> æ–¹æ³•</li>
<li><strong>ç ç‡æ§åˆ¶</strong> - å¯è®¾ç½® <code>videoBitsPerSecond</code> å’Œ <code>audioBitsPerSecond</code> æ§åˆ¶å½•åˆ¶è´¨é‡</li>
</ol>
<h3 data-id="heading-9">ImageCapture - æ‹ç…§ä¸å›¾åƒæ•è·</h3>
<p><code>ImageCapture</code> ç”¨äºä»è§†é¢‘æµä¸­æ•è·é«˜è´¨é‡çš„é™æ€å›¾åƒï¼Œæä¾›æ¯” Canvas æˆªå›¾æ›´ç²¾ç¡®çš„æ§åˆ¶ã€‚</p>
<p><strong>åŸºç¡€ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> stream = <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">mediaDevices</span>.<span class="hljs-title function_">getUserMedia</span>({ <span class="hljs-attr">video</span>: <span class="hljs-literal">true</span> });
<span class="hljs-keyword">const</span> track = stream.<span class="hljs-title function_">getVideoTracks</span>()[<span class="hljs-number">0</span>];
<span class="hljs-keyword">const</span> imageCapture = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImageCapture</span>(track);

<span class="hljs-comment">// æ‹ç…§</span>
<span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">await</span> imageCapture.<span class="hljs-title function_">takePhoto</span>();
<span class="hljs-keyword">const</span> img = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"img"</span>);
img.<span class="hljs-property">src</span> = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);

<span class="hljs-comment">// è·å–å½“å‰å¸§</span>
<span class="hljs-keyword">const</span> bitmap = <span class="hljs-keyword">await</span> imageCapture.<span class="hljs-title function_">grabFrame</span>();
<span class="hljs-comment">// åœ¨ Canvas ä¸­æ¸²æŸ“ ImageBitmap</span>
</code></pre>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li><strong>é«˜è´¨é‡æ‹ç…§</strong> - <code>takePhoto()</code> ä½¿ç”¨è®¾å¤‡çš„æœ€é«˜åˆ†è¾¨ç‡å’Œå›¾åƒå¤„ç†èƒ½åŠ›</li>
<li><strong>å®æ—¶å¸§æ•è·</strong> - <code>grabFrame()</code> å¿«é€Ÿè·å–å½“å‰è§†é¢‘å¸§çš„ ImageBitmap å¯¹è±¡</li>
<li><strong>æ‘„åƒå¤´å‚æ•°æ§åˆ¶</strong> - å¯è°ƒæ•´ç„¦è·ã€æ›å…‰ã€ç™½å¹³è¡¡ç­‰æ‘„åƒå¤´å‚æ•°(å–å†³äºç¡¬ä»¶æ”¯æŒ)</li>
<li><strong>èƒ½åŠ›æŸ¥è¯¢</strong> - é€šè¿‡ <code>getPhotoCapabilities()</code> è·å–è®¾å¤‡æ”¯æŒçš„æ‹ç…§å‚æ•°èŒƒå›´</li>
</ol>
<h3 data-id="heading-10">MediaStream - åª’ä½“æµç®¡ç†</h3>
<p><code>MediaStream</code> æ˜¯è¡¨ç¤ºéŸ³è§†é¢‘æµçš„æ ¸å¿ƒå¯¹è±¡ï¼ŒåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªåª’ä½“è½¨é“(MediaStreamTrack)ã€‚</p>
<p><strong>åŸºç¡€ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> stream = <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">mediaDevices</span>.<span class="hljs-title function_">getUserMedia</span>({ <span class="hljs-attr">video</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">audio</span>: <span class="hljs-literal">true</span> });

<span class="hljs-comment">// è·å–è½¨é“</span>
<span class="hljs-keyword">const</span> videoTrack = stream.<span class="hljs-title function_">getVideoTracks</span>()[<span class="hljs-number">0</span>];
<span class="hljs-keyword">const</span> audioTrack = stream.<span class="hljs-title function_">getAudioTracks</span>()[<span class="hljs-number">0</span>];

<span class="hljs-comment">// åœæ­¢ç‰¹å®šè½¨é“</span>
videoTrack.<span class="hljs-title function_">stop</span>();

<span class="hljs-comment">// æ·»åŠ /ç§»é™¤è½¨é“</span>
stream.<span class="hljs-title function_">addTrack</span>(newTrack);
stream.<span class="hljs-title function_">removeTrack</span>(audioTrack);
</code></pre>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li><strong>è½¨é“ç®¡ç†</strong> - åŒ…å«å¤šä¸ª MediaStreamTrack(éŸ³é¢‘è½¨ã€è§†é¢‘è½¨)ï¼Œå¯ç‹¬ç«‹æ“ä½œ</li>
<li><strong>è½¨é“æ§åˆ¶</strong> - å¯ç”¨/ç¦ç”¨è½¨é“(<code>track.enabled</code>)ï¼Œåœæ­¢è½¨é“(<code>track.stop()</code>)</li>
<li><strong>çº¦æŸè°ƒæ•´</strong> - è¿è¡Œæ—¶é€šè¿‡ <code>applyConstraints()</code> ä¿®æ”¹åˆ†è¾¨ç‡ã€å¸§ç‡ç­‰å‚æ•°</li>
<li><strong>å…‹éš†æµ</strong> - <code>clone()</code> åˆ›å»ºç‹¬ç«‹çš„æµå‰¯æœ¬ï¼Œç”¨äºä¸åŒçš„å¤„ç†ç®¡é“</li>
<li><strong>äº‹ä»¶ç›‘å¬</strong> - ç›‘å¬è½¨é“æ·»åŠ (<code>addtrack</code>)ã€ç§»é™¤(<code>removetrack</code>)ç­‰äº‹ä»¶</li>
</ol>
<p><strong>MediaStreamTrack å…³é”®å±æ€§ï¼š</strong></p>
<ul>
<li><code>kind</code> - è½¨é“ç±»å‹(<code>'audio'</code> æˆ– <code>'video'</code>)</li>
<li><code>label</code> - è®¾å¤‡åç§°</li>
<li><code>enabled</code> - æ˜¯å¦å¯ç”¨(mute/unmute)</li>
<li><code>readyState</code> - è½¨é“çŠ¶æ€(<code>'live'</code> æˆ– <code>'ended'</code>)</li>
</ul>
<h3 data-id="heading-11">Blob ä¸ File - åª’ä½“æ•°æ®å°è£…</h3>
<p>Blob(Binary Large Object)æ˜¯æµè§ˆå™¨ä¸­è¡¨ç¤ºäºŒè¿›åˆ¶æ•°æ®çš„å¯¹è±¡ï¼ŒFile æ˜¯ Blob çš„å­ç±»ã€‚åª’ä½“æ•è·å’Œå½•åˆ¶çš„è¾“å‡ºé€šå¸¸æ˜¯ Blob å¯¹è±¡ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<p>Blob å¯¹è±¡æ˜¯å¯¹äºŒè¿›åˆ¶æ•°æ®çš„å¼•ç”¨ï¼Œä¸ç›´æ¥å°†æ•°æ®åŠ è½½åˆ°å†…å­˜ï¼Œè€Œæ˜¯æŒ‰éœ€è¯»å–ã€‚<code>URL.createObjectURL()</code> ä¸º Blob åˆ›å»ºä¸´æ—¶ URLï¼Œå¯ç›´æ¥ç”¨äº <code>&lt;video&gt;</code> æ’­æ”¾æˆ–ä¸‹è½½ã€‚</p>
<p><strong>åŸºç¡€ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// MediaRecorder è¾“å‡º Blob</span>
<span class="hljs-keyword">const</span> recorder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MediaRecorder</span>(stream);
<span class="hljs-keyword">const</span> chunks = [];
recorder.<span class="hljs-property">ondataavailable</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> chunks.<span class="hljs-title function_">push</span>(e.<span class="hljs-property">data</span>);
recorder.<span class="hljs-property">onstop</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Blob</span>(chunks, { <span class="hljs-attr">type</span>: <span class="hljs-string">"video/webm"</span> });

  <span class="hljs-comment">// ç›´æ¥æ’­æ”¾</span>
  video.<span class="hljs-property">src</span> = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);

  <span class="hljs-comment">// ä¸‹è½½ä¿å­˜</span>
  <span class="hljs-keyword">const</span> a = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"a"</span>);
  a.<span class="hljs-property">href</span> = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);
  a.<span class="hljs-property">download</span> = <span class="hljs-string">"recording.webm"</span>;
  a.<span class="hljs-title function_">click</span>();

  <span class="hljs-comment">// é‡Šæ”¾ URL</span>
  <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">revokeObjectURL</span>(blob);
};

<span class="hljs-comment">// è¯»å–æœ¬åœ°è§†é¢‘æ–‡ä»¶</span>
<span class="hljs-keyword">const</span> input = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'input[type="file"]'</span>);
input.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"change"</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> file = e.<span class="hljs-property">target</span>.<span class="hljs-property">files</span>[<span class="hljs-number">0</span>]; <span class="hljs-comment">// File æ˜¯ Blob å­ç±»</span>
  video.<span class="hljs-property">src</span> = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(file);
});
</code></pre>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>å½•åˆ¶ä¿å­˜</strong>ï¼šMediaRecorder ç”Ÿæˆ Blobï¼Œåˆ›å»ºä¸‹è½½é“¾æ¥</li>
<li><strong>æœ¬åœ°é¢„è§ˆ</strong>ï¼šç”¨æˆ·é€‰æ‹©æ–‡ä»¶åå³æ—¶é¢„è§ˆï¼Œæ— éœ€ä¸Šä¼ æœåŠ¡å™¨</li>
<li><strong>åˆ†ç‰‡ä¸Šä¼ </strong>ï¼šblob.slice() åˆ‡åˆ†å¤§æ–‡ä»¶ï¼Œå®ç°æ–­ç‚¹ç»­ä¼ </li>
</ul>
<h2 data-id="heading-12">åª’ä½“æ’­æ”¾ä¸æ§åˆ¶æŠ€æœ¯</h2>
<p>åª’ä½“æ’­æ”¾ä¸æ§åˆ¶æŠ€æœ¯æ˜¯ Web å¤šåª’ä½“çš„æ ¸å¿ƒèƒ½åŠ›ï¼Œä»åŸºç¡€çš„ HTML5 Video/Audio åˆ°é«˜çº§çš„æµåª’ä½“æ’­æ”¾ã€åŠ å¯†å†…å®¹ä¿æŠ¤ï¼Œä¸ºå„ç±»éŸ³è§†é¢‘åº”ç”¨æä¾›å®Œæ•´çš„æ’­æ”¾è§£å†³æ–¹æ¡ˆã€‚</p>









































<table><thead><tr><th>æŠ€æœ¯</th><th>ä¸»è¦åŠŸèƒ½</th><th>ä½¿ç”¨åœºæ™¯</th><th>æµè§ˆå™¨æ”¯æŒ</th></tr></thead><tbody><tr><td>HTMLMediaElement</td><td>åŸºç¡€æ’­æ”¾æ§åˆ¶</td><td>ç®€å•éŸ³è§†é¢‘æ’­æ”¾</td><td>å…¨å¹³å°æ”¯æŒ</td></tr><tr><td>MSE</td><td>æµåª’ä½“æ’­æ”¾</td><td>è‡ªé€‚åº”ç ç‡ã€ç›´æ’­</td><td>ç°ä»£æµè§ˆå™¨</td></tr><tr><td>EME</td><td>åŠ å¯†å†…å®¹æ’­æ”¾</td><td>DRM ä¿æŠ¤å†…å®¹</td><td>ç°ä»£æµè§ˆå™¨</td></tr><tr><td>Picture-in-Picture</td><td>ç”»ä¸­ç”»æ¨¡å¼</td><td>æ‚¬æµ®æ’­æ”¾</td><td>ä¸»æµæµè§ˆå™¨</td></tr><tr><td>MediaCapabilities</td><td>èƒ½åŠ›æ£€æµ‹</td><td>ç¼–è§£ç èƒ½åŠ›æŸ¥è¯¢</td><td>ç°ä»£æµè§ˆå™¨</td></tr></tbody></table>
<h3 data-id="heading-13">HTMLMediaElement - åŸºç¡€æ’­æ”¾ API</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FHTMLMediaElement" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement" ref="nofollow noopener noreferrer"><code>HTMLMediaElement</code></a> å°è£…äº†æµè§ˆå™¨å†…ç½®çš„åª’ä½“è§£ç å™¨å’Œæ¸²æŸ“å™¨ï¼Œå°†åº•å±‚çš„è§£å¤ç”¨ã€è§£ç ã€éŸ³è§†é¢‘åŒæ­¥ç­‰å¤æ‚æ“ä½œæŠ½è±¡ä¸ºç®€å•çš„ DOM APIã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<p>æµè§ˆå™¨å†…éƒ¨å®Œæˆä»¥ä¸‹æµç¨‹ï¼š</p>
<ol>
<li><strong>ç½‘ç»œè¯·æ±‚</strong> - é€šè¿‡ HTTP è¯·æ±‚è·å–åª’ä½“æ–‡ä»¶</li>
<li><strong>è§£å¤ç”¨(Demuxing)</strong> - ä»å®¹å™¨æ ¼å¼(MP4/WebM)ä¸­åˆ†ç¦»éŸ³é¢‘æµã€è§†é¢‘æµ</li>
<li><strong>è§£ç (Decoding)</strong> - ä½¿ç”¨ç¡¬ä»¶æˆ–è½¯ä»¶è§£ç å™¨è§£ç éŸ³è§†é¢‘æ•°æ®</li>
<li><strong>éŸ³è§†é¢‘åŒæ­¥(A/V Sync)</strong> - æ ¹æ® PTS(Presentation Time Stamp)åŒæ­¥éŸ³è§†é¢‘å¸§</li>
<li><strong>æ¸²æŸ“</strong> - è§†é¢‘å¸§æ¸²æŸ“åˆ° Canvas/GPUï¼ŒéŸ³é¢‘è¾“å‡ºåˆ°æ‰¬å£°å™¨</li>
</ol>
<p><strong>åŸºç¡€ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">video</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"video.mp4"</span> <span class="hljs-attr">controls</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">video</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> video = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"video"</span>);
video.<span class="hljs-title function_">play</span>(); <span class="hljs-comment">// è§¦å‘è§£ç å’Œæ¸²æŸ“ç®¡çº¿</span>
video.<span class="hljs-property">currentTime</span> = <span class="hljs-number">10</span>; <span class="hljs-comment">// Seek æ“ä½œï¼šå®šä½åˆ°å…³é”®å¸§ï¼Œé‡æ–°è§£ç </span>
</code></pre>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li><strong>ç»Ÿä¸€æ¥å£</strong> - å±è”½ä¸åŒå¹³å°(Windows/macOS/Linux)çš„è§£ç å™¨å·®å¼‚</li>
<li><strong>è‡ªåŠ¨åŒæ­¥</strong> - å†…éƒ¨ç»´æŠ¤éŸ³è§†é¢‘æ—¶é—´æˆ³å¯¹é½ï¼Œä¿è¯åŒæ­¥æ’­æ”¾</li>
<li><strong>ç¼“å†²ç®¡ç†</strong> - é¢„åŠ è½½ä¸€å®šæ—¶é•¿çš„æ•°æ®ï¼Œå¹³è¡¡åŠ è½½é€Ÿåº¦å’Œå†…å­˜å ç”¨</li>
<li><strong>Seek ä¼˜åŒ–</strong> - å®šä½åˆ°æœ€è¿‘çš„å…³é”®å¸§(I-frame)ï¼Œé¿å…è§£ç æ•´ä¸ª GOP</li>
</ol>
<h3 data-id="heading-14">Media Source Extensions - æµåª’ä½“æ’­æ”¾</h3>
<p>MSE å°†åª’ä½“æ•°æ®çš„"è·å–"å’Œ"è§£ç "åˆ†ç¦»ï¼Œè®© JavaScript æ§åˆ¶å‘è§£ç å™¨è¾“é€æ•°æ®çš„æ—¶æœºå’Œå†…å®¹ï¼Œæ‰“ç ´äº† <code>&lt;video&gt;</code> åªèƒ½æ’­æ”¾å®Œæ•´æ–‡ä»¶çš„é™åˆ¶ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<p>ä¼ ç»Ÿ <code>&lt;video src="url"&gt;</code> æ¨¡å¼ä¸‹ï¼Œæµè§ˆå™¨è´Ÿè´£æ•´ä¸ªæµç¨‹ï¼šä¸‹è½½ â†’ è§£å¤ç”¨ â†’ è§£ç ã€‚MSE æ”¹å˜äº†è¿™ä¸ªæµç¨‹ï¼š</p>
<ol>
<li><strong>JavaScript æ§åˆ¶æ•°æ®æµ</strong> - é€šè¿‡ <code>SourceBuffer.appendBuffer()</code> æ‰‹åŠ¨å‘è§£ç å™¨è¾“é€æ•°æ®</li>
<li><strong>åˆ†æ®µä¼ è¾“</strong> - è§†é¢‘è¢«åˆ‡åˆ†æˆå°ç‰‡æ®µ(é€šå¸¸ 2-10 ç§’)ï¼ŒæŒ‰éœ€è·å–</li>
<li><strong>ABR(Adaptive Bitrate)å®ç°</strong> - JavaScript æ ¹æ®ç½‘ç»œå¸¦å®½é€‰æ‹©ä¸åŒç ç‡çš„ç‰‡æ®µ</li>
<li><strong>æ—¶é—´è½´æ‹¼æ¥</strong> - å¤šä¸ªç‰‡æ®µåœ¨æ—¶é—´è½´ä¸Šæ— ç¼è¿æ¥ï¼Œç”¨æˆ·æ„ŸçŸ¥ä¸ºè¿ç»­æ’­æ”¾</li>
</ol>
<p><strong>åŸºç¡€ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> mediaSource = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MediaSource</span>();
video.<span class="hljs-property">src</span> = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(mediaSource);

mediaSource.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"sourceopen"</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> sourceBuffer = mediaSource.<span class="hljs-title function_">addSourceBuffer</span>(<span class="hljs-string">'video/mp4; codecs="avc1.42E01E"'</span>);

  <span class="hljs-comment">// JavaScript ä¸»åŠ¨é€å…¥æ•°æ®</span>
  sourceBuffer.<span class="hljs-title function_">appendBuffer</span>(segmentData);
});
</code></pre>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li><strong>è§£è€¦æ•°æ®è·å–ä¸æ’­æ”¾</strong> - JavaScript å†³å®šè·å–å“ªä¸ªç‰‡æ®µã€ä½•æ—¶è·å–</li>
<li><strong>æ— ç¼ç ç‡åˆ‡æ¢</strong> - åœ¨ç‰‡æ®µè¾¹ç•Œåˆ‡æ¢ä¸åŒæ¸…æ™°åº¦ï¼Œä¸ä¸­æ–­æ’­æ”¾</li>
<li><strong>ç¼“å†²åŒºç²¾ç¡®æ§åˆ¶</strong> - é€šè¿‡ <code>remove()</code> æ¸…ç†è¿‡æœŸæ•°æ®ï¼ŒèŠ‚çœå†…å­˜</li>
<li><strong>ç›´æ’­æ”¯æŒ</strong> - æŒç»­ append æ–°æ•°æ®å®ç°æ— é™æ—¶é•¿ç›´æ’­</li>
</ol>
<h3 data-id="heading-15">Encrypted Media Extensions - åŠ å¯†å†…å®¹æ’­æ”¾</h3>
<p>EME åœ¨æµè§ˆå™¨å’Œ CDM(Content Decryption Module)ä¹‹é—´å»ºç«‹é€šä¿¡é€šé“ï¼Œè®© Web åº”ç”¨å¯ä»¥æ’­æ”¾åŠ å¯†å†…å®¹ï¼ŒåŒæ—¶ä¿è¯è§£å¯†å¯†é’¥å¯¹ JavaScript ä¸å¯è§ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<p>åŠ å¯†è§†é¢‘æ’­æ”¾æµç¨‹ï¼š</p>
<ol>
<li><strong>æ£€æµ‹åŠ å¯†æ•°æ®</strong> - æµè§ˆå™¨è§£æåª’ä½“æ–‡ä»¶ï¼Œå‘ç° PSSH(Protection System Specific Header)ï¼Œè§¦å‘ <code>encrypted</code> äº‹ä»¶</li>
<li><strong>é€‰æ‹© DRM ç³»ç»Ÿ</strong> - JavaScript è¯·æ±‚å¯¹åº”çš„ CDM(å¦‚ Widevine)</li>
<li><strong>è®¸å¯è¯äº¤æ¢</strong> - CDM ç”Ÿæˆè®¸å¯è¯è¯·æ±‚ â†’ å‘é€åˆ°è®¸å¯è¯æœåŠ¡å™¨ â†’ è·å–è§£å¯†å¯†é’¥</li>
<li><strong>è§£å¯†æ’­æ”¾</strong> - CDM åœ¨å®‰å…¨ç¯å¢ƒä¸­è§£å¯†æ•°æ®ï¼Œè§£å¯†åçš„æ•°æ®ç›´æ¥é€å…¥è§£ç å™¨ï¼ŒJavaScript æ— æ³•è®¿é—®</li>
</ol>
<p><strong>å®‰å…¨éš”ç¦»ï¼š</strong></p>
<ul>
<li>è§£å¯†å¯†é’¥å­˜å‚¨åœ¨ TEE(Trusted Execution Environment)æˆ–ç¡¬ä»¶å®‰å…¨æ¨¡å—ä¸­</li>
<li>è§£å¯†è¿‡ç¨‹å¯¹ JavaScript å’Œæ“ä½œç³»ç»Ÿé€æ˜ï¼Œé˜²æ­¢å¯†é’¥æ³„éœ²</li>
</ul>
<p><strong>åŸºç¡€ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">video.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"encrypted"</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  navigator
    .<span class="hljs-title function_">requestMediaKeySystemAccess</span>(<span class="hljs-string">"com.widevine.alpha"</span>, config)
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">access</span>) =&gt;</span> access.<span class="hljs-title function_">createMediaKeys</span>())
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">keys</span>) =&gt;</span> {
      video.<span class="hljs-title function_">setMediaKeys</span>(keys);
      <span class="hljs-comment">// è¯·æ±‚è®¸å¯è¯ï¼ŒCDM å†…éƒ¨å®Œæˆè§£å¯†</span>
    });
});
</code></pre>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li><strong>å¯†é’¥éš”ç¦»</strong> - è§£å¯†å¯†é’¥å¯¹ Web å±‚ä¸å¯è§ï¼Œé˜²æ­¢ç›—ç‰ˆ</li>
<li><strong>ç¡¬ä»¶åŠ é€Ÿè§£å¯†</strong> - ä½¿ç”¨ TEE/Secure Path å®ç°ç¡¬ä»¶çº§ä¿æŠ¤</li>
<li><strong>çµæ´»çš„ DRM æ–¹æ¡ˆ</strong> - æ”¯æŒ Widevine(Chrome/Android)ã€FairPlay(Safari/iOS)ã€PlayReady(Edge)</li>
<li><strong>ç¦»çº¿æ’­æ”¾</strong> - æŒä¹…åŒ–è®¸å¯è¯æ”¯æŒä¸‹è½½åç¦»çº¿è§‚çœ‹</li>
</ol>
<h3 data-id="heading-16">Picture-in-Picture - ç”»ä¸­ç”»æ¨¡å¼</h3>
<p>Picture-in-Picture å°†è§†é¢‘æ¸²æŸ“ç®¡çº¿ä»ç½‘é¡µçš„æ¸²æŸ“å±‚åˆ†ç¦»å‡ºæ¥ï¼Œåˆ›å»ºç‹¬ç«‹çš„ç³»ç»Ÿçº§æ‚¬æµ®çª—å£ï¼Œå®ç°è§†é¢‘ä¸é¡µé¢å†…å®¹çš„è§£è€¦ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<ol>
<li><strong>æ¸²æŸ“åˆ†ç¦»</strong> - è§†é¢‘å¸§ä¸å†æ¸²æŸ“åˆ°ç½‘é¡µçš„ Canvas å±‚ï¼Œè€Œæ˜¯è¾“å‡ºåˆ°æ“ä½œç³»ç»Ÿæä¾›çš„ç‹¬ç«‹çª—å£</li>
<li><strong>ç³»ç»Ÿé›†æˆ</strong> - æµè§ˆå™¨è°ƒç”¨æ“ä½œç³»ç»Ÿçš„çª—å£ç®¡ç† API(macOS çš„ PiPã€Windows çš„ Compact Overlay)</li>
<li><strong>Z-index æœ€é«˜</strong> - æ‚¬æµ®çª—å§‹ç»ˆå¤„äºæ‰€æœ‰çª—å£ä¹‹ä¸Šï¼ŒåŒ…æ‹¬å…¨å±åº”ç”¨</li>
<li><strong>ç‹¬ç«‹ç”Ÿå‘½å‘¨æœŸ</strong> - å…³é—­ç½‘é¡µæ ‡ç­¾ï¼Œç”»ä¸­ç”»çª—å£å¯ç»§ç»­æ’­æ”¾</li>
</ol>
<p><strong>åŸºç¡€ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">video.<span class="hljs-title function_">requestPictureInPicture</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">pipWindow</span>) =&gt;</span> {
  <span class="hljs-comment">// è§†é¢‘å·²è½¬ç§»åˆ°ç³»ç»Ÿçª—å£</span>
});
</code></pre>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li><strong>ç³»ç»Ÿçº§æ‚¬æµ®</strong> - è§†é¢‘æ‚¬æµ®åœ¨æ‰€æœ‰åº”ç”¨ä¹‹ä¸Šï¼Œä¸å—æµè§ˆå™¨çª—å£é™åˆ¶</li>
<li><strong>è·¨æ ‡ç­¾é¡µæŒä¹…åŒ–</strong> - åˆ‡æ¢æ ‡ç­¾é¡µã€æœ€å°åŒ–æµè§ˆå™¨ï¼Œè§†é¢‘ç»§ç»­æ’­æ”¾</li>
<li><strong>çª—å£å°ºå¯¸æ§åˆ¶</strong> - ç”¨æˆ·å¯æ‹–æ‹½è°ƒæ•´å¤§å°ï¼ŒJavaScript å¯è¯»å–çª—å£å°ºå¯¸</li>
<li><strong>è‡ªå®šä¹‰æ§åˆ¶æŒ‰é’®</strong> - é€šè¿‡ Media Session API åœ¨ç”»ä¸­ç”»çª—å£æ·»åŠ æ“ä½œæŒ‰é’®</li>
</ol>
<h3 data-id="heading-17">åª’ä½“èƒ½åŠ›æ£€æµ‹ä¸è‡ªåŠ¨æ’­æ”¾ç­–ç•¥</h3>
<p><strong>MediaCapabilities API - èƒ½åŠ›æ£€æµ‹</strong></p>
<p>æŸ¥è¯¢æµè§ˆå™¨å¯¹ç‰¹å®šç¼–è§£ç æ ¼å¼çš„æ”¯æŒå’Œæ€§èƒ½ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ£€æµ‹è§£ç èƒ½åŠ›</span>
navigator.<span class="hljs-property">mediaCapabilities</span>
  .<span class="hljs-title function_">decodingInfo</span>({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"file"</span>, <span class="hljs-comment">// 'file' æˆ– 'media-source'</span>
    <span class="hljs-attr">video</span>: {
      <span class="hljs-attr">contentType</span>: <span class="hljs-string">'video/mp4; codecs="avc1.42E01E"'</span>,
      <span class="hljs-attr">width</span>: <span class="hljs-number">1920</span>,
      <span class="hljs-attr">height</span>: <span class="hljs-number">1080</span>,
      <span class="hljs-attr">bitrate</span>: <span class="hljs-number">5000000</span>,
      <span class="hljs-attr">framerate</span>: <span class="hljs-number">30</span>,
    },
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ”¯æŒ:"</span>, result.<span class="hljs-property">supported</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æµç•…:"</span>, result.<span class="hljs-property">smooth</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"çœç”µ:"</span>, result.<span class="hljs-property">powerEfficient</span>);
  });
</code></pre>
<p><strong>canPlayType - åŸºç¡€æ ¼å¼æ£€æµ‹</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> video = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"video"</span>);
<span class="hljs-keyword">const</span> canPlay = video.<span class="hljs-title function_">canPlayType</span>(<span class="hljs-string">'video/mp4; codecs="avc1.42E01E"'</span>);
<span class="hljs-comment">// è¿”å› 'probably' | 'maybe' | ''</span>
</code></pre>
<p><strong>è‡ªåŠ¨æ’­æ”¾ç­–ç•¥</strong></p>
<p>ç°ä»£æµè§ˆå™¨é™åˆ¶è‡ªåŠ¨æ’­æ”¾ä»¥æ”¹å–„ç”¨æˆ·ä½“éªŒï¼Œå¿…é¡»æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ä¹‹ä¸€ï¼š</p>
<ol>
<li>ç”¨æˆ·ä¸é¡µé¢æœ‰è¿‡äº¤äº’</li>
<li>è§†é¢‘é™éŸ³æ’­æ”¾</li>
<li>ç”¨æˆ·åœ¨è¯¥ç«™ç‚¹æœ‰åª’ä½“æ’­æ”¾å†å²</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é™éŸ³è‡ªåŠ¨æ’­æ”¾</span>
video.<span class="hljs-property">muted</span> = <span class="hljs-literal">true</span>;
video.<span class="hljs-title function_">play</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"è‡ªåŠ¨æ’­æ”¾å¤±è´¥ï¼Œéœ€è¦ç”¨æˆ·äº¤äº’"</span>);
});
</code></pre>
<h2 data-id="heading-18">æµåª’ä½“ä¼ è¾“æŠ€æœ¯</h2>
<p>æµåª’ä½“ä¼ è¾“æŠ€æœ¯è§£å†³éŸ³è§†é¢‘å†…å®¹å¦‚ä½•é€šè¿‡ç½‘ç»œé«˜æ•ˆä¼ è¾“å’Œæ’­æ”¾çš„é—®é¢˜ã€‚ä¸åŒäºä¸‹è½½å®Œæ•´æ–‡ä»¶åæ’­æ”¾ï¼Œæµåª’ä½“é‡‡ç”¨è¾¹ä¼ è¾“è¾¹æ’­æ”¾çš„æ–¹å¼ï¼Œåœ¨å»¶è¿Ÿã€æµç•…æ€§ã€ä¼ è¾“æˆæœ¬ä¹‹é—´å–å¾—å¹³è¡¡ã€‚</p>
<p>åª’ä½“æµä¼ è¾“åè®®æ ¸å¿ƒè¦è§£å†³å››ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li><strong>æµå¼ä¼ è¾“ vs å®Œæ•´æ–‡ä»¶</strong> - å°†è§†é¢‘åˆ†æ®µæˆ–æŒç»­æ¨é€æ•°æ®ï¼Œè¾¹ä¸‹è½½è¾¹æ’­æ”¾</li>
<li><strong>å®æ—¶æ€§ä¸ç¼“å†²</strong> - åœ¨å»¶è¿Ÿå’Œæµç•…æ€§ä¹‹é—´å¹³è¡¡ï¼Œç›´æ’­éœ€è¦ä½å»¶è¿Ÿï¼Œä½†ç½‘ç»œæŠ–åŠ¨éœ€è¦ç¼“å†²åŒºå¹³æ»‘</li>
<li><strong>è‡ªé€‚åº”ç ç‡(ABR)</strong> - ç½‘ç»œå¸¦å®½æ³¢åŠ¨æ—¶åŠ¨æ€åˆ‡æ¢ä¸åŒç ç‡çš„è§†é¢‘æµï¼Œä¿è¯ä¸å¡é¡¿</li>
<li><strong>ä¼ è¾“å±‚é€‰æ‹©</strong> - TCP å¯é ä½†æœ‰é˜Ÿå¤´é˜»å¡ï¼ŒUDP ä½å»¶è¿Ÿä½†å¯èƒ½ä¸¢åŒ…ï¼Œä¸åŒåœºæ™¯é€‰æ‹©ä¸åŒä¼ è¾“å±‚</li>
</ol>
<p><strong>ä¸»æµåª’ä½“æµä¼ è¾“åè®®ï¼š</strong></p>



































<table><thead><tr><th>åè®®</th><th>ä¼ è¾“æ–¹å¼</th><th>å»¶è¿Ÿ</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>HLS/DASH</td><td>HTTP è‡ªé€‚åº”æµ</td><td>6-30 ç§’</td><td>ç‚¹æ’­ã€ç›´æ’­(å¯æ¥å—å»¶è¿Ÿ)</td></tr><tr><td>FLV</td><td>HTTP æµå¼</td><td>3-10 ç§’</td><td>ä½å»¶è¿Ÿç›´æ’­</td></tr><tr><td>RTMP/RTSP</td><td>TCP æµå¼</td><td>1-3 ç§’</td><td>æœåŠ¡ç«¯æ¨æµ</td></tr><tr><td>SRT</td><td>UDP å¯é ä¼ è¾“</td><td>&lt;1 ç§’</td><td>ä¸“ä¸šç›´æ’­ä¼ è¾“</td></tr></tbody></table>
<p><strong>åº•å±‚ä¼ è¾“é€šé“(å¯ä¸ä¸Šè¿°åè®®ç»„åˆä½¿ç”¨)ï¼š</strong></p>






























<table><thead><tr><th>é€šé“</th><th>ç‰¹æ€§</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>WebSocket</td><td>åŒå‘é€šä¿¡ã€æŒä¹…è¿æ¥</td><td>ä¿¡ä»¤äº¤æ¢ã€å®æ—¶æ¶ˆæ¯</td></tr><tr><td>SSE</td><td>æœåŠ¡ç«¯æ¨é€ã€è‡ªåŠ¨é‡è¿</td><td>é€šçŸ¥æ¨é€ã€å®æ—¶æ›´æ–°</td></tr><tr><td>WebTransport</td><td>QUIC ä½å»¶è¿Ÿã€å¤šè·¯å¤ç”¨</td><td>ä½å»¶è¿Ÿæµåª’ä½“ä¼ è¾“</td></tr><tr><td>WebRTC</td><td>P2P ç›´è¿ã€ç«¯åˆ°ç«¯åŠ å¯†</td><td>å®æ—¶éŸ³è§†é¢‘é€šè¯</td></tr></tbody></table>
<h3 data-id="heading-19">HLS/DASH - HTTP è‡ªé€‚åº”æµ</h3>
<p>HLS/DASH æ˜¯æµåª’ä½“ç›´æ’­å’Œç‚¹æ’­çš„ä¸»æµæ–¹æ¡ˆï¼Œé€šè¿‡ HTTP åˆ†æ®µä¼ è¾“å®ç°å‡†å®æ—¶æ’­æ”¾ã€‚(<a href="https://link.juejin.cn?target=https%3A%2F%2Fdatatracker.ietf.org%2Fdoc%2Fhtml%2Frfc8216" target="_blank" title="https://datatracker.ietf.org/doc/html/rfc8216" ref="nofollow noopener noreferrer">HLS è§„èŒƒ</a> | <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.iso.org%2Fstandard%2F79329.html" target="_blank" title="https://www.iso.org/standard/79329.html" ref="nofollow noopener noreferrer">DASH è§„èŒƒ</a>)</p>
<p><strong>åŸç†ï¼š</strong></p>
<p>ä¼ ç»Ÿæ–¹å¼ä¸‹ï¼Œè§†é¢‘æ˜¯ä¸€ä¸ªå®Œæ•´çš„å¤§æ–‡ä»¶ï¼Œå¿…é¡»å®Œæ•´ä¸‹è½½æˆ–ä½¿ç”¨ RTMP ç­‰ä¸“ç”¨æµåè®®ã€‚HLS/DASH çš„æ ¸å¿ƒæ€æƒ³æ˜¯"åŒ–æ•´ä¸ºé›¶"ï¼š</p>
<ol>
<li>
<p><strong>æœåŠ¡ç«¯å¤„ç†æµç¨‹ï¼š</strong></p>
<ul>
<li><strong>åˆ‡ç‰‡(Segmentation)</strong> - ç¼–ç å™¨å°†è¿ç»­çš„è§†é¢‘æµæŒ‰æ—¶é—´åˆ‡åˆ†æˆç‹¬ç«‹çš„å°æ–‡ä»¶
<ul>
<li>HLSï¼šç”Ÿæˆ .ts æ–‡ä»¶(MPEG-TS å®¹å™¨)ï¼Œæ¯æ®µ 2-10 ç§’</li>
<li>DASHï¼šç”Ÿæˆ .m4s æ–‡ä»¶(fMP4 å®¹å™¨)ï¼Œæ¯æ®µ 2-10 ç§’</li>
</ul>
</li>
<li><strong>å¤šç ç‡è½¬ç </strong> - åŒä¸€å†…å®¹ç”Ÿæˆå¤šä¸ªç ç‡ç‰ˆæœ¬(å¦‚ 360p/720p/1080p)</li>
<li><strong>ç´¢å¼•æ–‡ä»¶ç”Ÿæˆ</strong> - åˆ›å»ºæè¿°ç‰‡æ®µåˆ—è¡¨çš„æ¸…å•æ–‡ä»¶
<ul>
<li>HLSï¼š.m3u8 æ–‡ä»¶ï¼Œæ–‡æœ¬æ ¼å¼ï¼Œåˆ—å‡ºæ‰€æœ‰ .ts ç‰‡æ®µçš„ URL å’Œæ—¶é•¿</li>
<li>DASHï¼š.mpd æ–‡ä»¶(XML)ï¼Œæè¿°ä¸åŒç ç‡çš„ç‰‡æ®µä½ç½®</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>å®¢æˆ·ç«¯æ’­æ”¾æµç¨‹ï¼š</strong></p>
<ul>
<li><strong>ä¸‹è½½ç´¢å¼•</strong> - è¯·æ±‚ m3u8/mpd æ–‡ä»¶ï¼Œè§£æç‰‡æ®µåˆ—è¡¨</li>
<li><strong>å¸¦å®½æ£€æµ‹</strong> - æµ‹é‡å½“å‰ç½‘ç»œé€Ÿåº¦</li>
<li><strong>ç‰‡æ®µé€‰æ‹©</strong> - æ ¹æ®å¸¦å®½é€‰æ‹©åˆé€‚ç ç‡çš„ç‰‡æ®µ URL</li>
<li><strong>ä¸‹è½½ä¸æ’­æ”¾</strong> - ä¸‹è½½ç‰‡æ®µ â†’ é€šè¿‡ MSE é€å…¥è§£ç å™¨ â†’ æ’­æ”¾</li>
<li><strong>å¾ªç¯æ›´æ–°</strong> - å®šæœŸè¯·æ±‚ç´¢å¼•æ–‡ä»¶è·å–æ–°ç‰‡æ®µ(ç›´æ’­åœºæ™¯)</li>
</ul>
</li>
<li>
<p><strong>è‡ªé€‚åº”åˆ‡æ¢æœºåˆ¶ï¼š</strong></p>
<ul>
<li>å®¢æˆ·ç«¯æŒç»­ç›‘æµ‹ä¸‹è½½é€Ÿåº¦å’Œç¼“å†²åŒºçŠ¶æ€</li>
<li>ç½‘é€Ÿä¸‹é™ï¼šåˆ‡æ¢åˆ°ä½ç ç‡ç‰‡æ®µï¼Œé¿å…å¡é¡¿</li>
<li>ç½‘é€Ÿæå‡ï¼šåˆ‡æ¢åˆ°é«˜ç ç‡ç‰‡æ®µï¼Œæå‡ç”»è´¨</li>
<li>åˆ‡æ¢å‘ç”Ÿåœ¨ç‰‡æ®µè¾¹ç•Œï¼Œç”¨æˆ·æ— æ„ŸçŸ¥</li>
</ul>
</li>
</ol>
<p><strong>å»¶è¿Ÿæ¥æºï¼š</strong></p>
<ul>
<li>åˆ‡ç‰‡æ—¶é•¿(6-10 ç§’) - å¿…é¡»ç­‰å¾…å®Œæ•´ç‰‡æ®µç”Ÿæˆ</li>
<li>æœåŠ¡ç«¯ç¼“å†²(2-3 ä¸ªç‰‡æ®µ) - ä¿è¯åˆ‡æ¢çš„å¹³æ»‘æ€§</li>
<li>å®¢æˆ·ç«¯æ’­æ”¾ç¼“å†²(1-2 ä¸ªç‰‡æ®µ) - æŠµæŠ—ç½‘ç»œæŠ–åŠ¨</li>
<li>æ€»å»¶è¿Ÿï¼š15-30 ç§’(æ ‡å‡† HLS)ï¼Œ3-5 ç§’(LL-HLS ä½å»¶è¿Ÿæ¨¡å¼)</li>
</ul>
<p><strong>åŸºç¡€ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// HLS æ’­æ”¾(ä½¿ç”¨ hls.js)</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Hls</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"hls.js"</span>;
<span class="hljs-keyword">const</span> hls = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hls</span>();
hls.<span class="hljs-title function_">loadSource</span>(<span class="hljs-string">"https://example.com/live.m3u8"</span>);
hls.<span class="hljs-title function_">attachMedia</span>(video);
</code></pre>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li><strong>æ— éœ€ä¸“ç”¨åè®®</strong> - å¤ç”¨ HTTPï¼Œç©¿é€é˜²ç«å¢™ï¼Œåˆ©ç”¨ç°æœ‰ CDN</li>
<li><strong>å¤§è§„æ¨¡åˆ†å‘</strong> - ç‰‡æ®µä¸ºé™æ€æ–‡ä»¶ï¼ŒCDN ç¼“å­˜å‘½ä¸­ç‡é«˜</li>
<li><strong>è‡ªé€‚åº”ç ç‡</strong> - ç½‘ç»œæ³¢åŠ¨æ—¶åŠ¨æ€è°ƒæ•´ï¼Œä¿è¯æµç•…æ’­æ”¾</li>
<li><strong>æ— çŠ¶æ€</strong> - æœåŠ¡ç«¯æ— éœ€ç»´æŠ¤è¿æ¥çŠ¶æ€ï¼Œæ˜“äºæ¨ªå‘æ‰©å±•</li>
</ol>
<h3 data-id="heading-20">FLV - ä½å»¶è¿Ÿç›´æ’­æµ</h3>
<p>FLV(Flash Video)æ˜¯ Adobe è®¾è®¡çš„è½»é‡çº§å®¹å™¨æ ¼å¼ï¼Œé€šè¿‡ HTTP æµå¼ä¼ è¾“å®ç°ä½å»¶è¿Ÿç›´æ’­ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<p>ä¸åŒäº HLS/DASH çš„åˆ‡ç‰‡æ¨¡å¼ï¼ŒFLV é‡‡ç”¨è¿ç»­æµå¼ä¼ è¾“ï¼š</p>
<ol>
<li><strong>æµå¼å°è£…</strong> - FLV å®¹å™¨ç»“æ„ç®€å•ï¼Œç”± FLV Header + Tag åºåˆ—ç»„æˆ
<ul>
<li>æ¯ä¸ª Tag åŒ…å«ä¸€ä¸ªè§†é¢‘å¸§ã€éŸ³é¢‘å¸§æˆ–è„šæœ¬æ•°æ®</li>
<li>Tag ä¹‹é—´ç‹¬ç«‹ï¼Œå¯ä»¥é€ä¸ªè§£æï¼Œæ— éœ€ç­‰å¾…å®Œæ•´æ–‡ä»¶</li>
</ul>
</li>
<li><strong>HTTP é•¿è¿æ¥æ¨é€</strong> - æœåŠ¡ç«¯é€šè¿‡ HTTP é•¿è¿æ¥æŒç»­æ¨é€ FLV Tag
<ul>
<li>ä½¿ç”¨ Transfer-Encoding: chunked åˆ†å—ä¼ è¾“</li>
<li>å®¢æˆ·ç«¯è¾¹æ¥æ”¶è¾¹è§£æï¼Œå®æ—¶é€å…¥è§£ç å™¨</li>
</ul>
</li>
<li><strong>æ— éœ€åˆ‡ç‰‡</strong> - æ•°æ®è¿ç»­æ¨é€ï¼Œé¿å…äº† HLS ç­‰å¾…ç‰‡æ®µç”Ÿæˆçš„å»¶è¿Ÿ</li>
<li><strong>æµè§ˆå™¨æ’­æ”¾</strong> - Flash å·²æ·˜æ±°ï¼Œç°ä»£æµè§ˆå™¨é€šè¿‡ flv.js è§£æ FLV å¹¶ç”¨ MSE æ’­æ”¾</li>
</ol>
<p><strong>å»¶è¿Ÿæ¥æºï¼š</strong></p>
<ul>
<li>ç¼–ç å»¶è¿Ÿ(1-2 ç§’) - è§†é¢‘é‡‡é›†ã€ç¼–ç </li>
<li>ç½‘ç»œä¼ è¾“(0.5-1 ç§’) - æ¨æµåˆ°æœåŠ¡å™¨ã€CDN åˆ†å‘</li>
<li>æ’­æ”¾ç¼“å†²(1-2 ç§’) - å®¢æˆ·ç«¯ç¼“å†²åŒº</li>
<li>æ€»å»¶è¿Ÿï¼š3-10 ç§’</li>
</ul>
<p><strong>åŸºç¡€ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> flvjs <span class="hljs-keyword">from</span> <span class="hljs-string">"flv.js"</span>;
<span class="hljs-keyword">const</span> player = flvjs.<span class="hljs-title function_">createPlayer</span>({
  <span class="hljs-attr">type</span>: <span class="hljs-string">"flv"</span>,
  <span class="hljs-attr">url</span>: <span class="hljs-string">"http://example.com/live.flv"</span>,
});
player.<span class="hljs-title function_">attachMediaElement</span>(video);
player.<span class="hljs-title function_">load</span>();
player.<span class="hljs-title function_">play</span>();
</code></pre>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li><strong>ä½å»¶è¿Ÿ</strong> - æ— éœ€åˆ‡ç‰‡ï¼Œè¿ç»­æ¨é€ï¼Œå»¶è¿Ÿä½äº HLS</li>
<li><strong>ç®€å•é«˜æ•ˆ</strong> - å®¹å™¨æ ¼å¼ç®€å•ï¼Œè§£æå¼€é”€å°</li>
<li><strong>HTTP ä¼ è¾“</strong> - å¤ç”¨ HTTP åè®®ï¼Œç©¿é€é˜²ç«å¢™</li>
<li><strong>é€å¸§è§£æ</strong> - Tag ç‹¬ç«‹å°è£…ï¼Œæ”¯æŒå®æ—¶æµå¼è§£æ</li>
</ol>
<h3 data-id="heading-21">RTMP/RTSP - æœåŠ¡ç«¯æ¨æµåè®®</h3>
<p>RTMP(Real-Time Messaging Protocol)å’Œ RTSP(Real-Time Streaming Protocol)æ˜¯ä¼ ç»Ÿçš„æµåª’ä½“åè®®ï¼Œä¸»è¦ç”¨äºæœåŠ¡ç«¯æ¨æµã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<p><strong>RTMPï¼š</strong></p>
<ol>
<li><strong>æ¡æ‰‹åå•†</strong> - å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å»ºç«‹ TCP è¿æ¥ï¼Œæ¡æ‰‹åå•†ç‰ˆæœ¬å’Œå‚æ•°</li>
<li><strong>æ¶ˆæ¯åˆ†å—(Chunk)</strong> - å°†éŸ³è§†é¢‘æ•°æ®åˆ†å‰²ä¸ºå›ºå®šå¤§å°çš„ Chunkï¼Œäº¤ç»‡ä¼ è¾“
<ul>
<li>éŸ³é¢‘ã€è§†é¢‘ã€å…ƒæ•°æ®å…±ç”¨ä¸€ä¸ª TCP è¿æ¥</li>
<li>ä½¿ç”¨ Chunk Stream ID åŒºåˆ†ä¸åŒç±»å‹çš„æ•°æ®</li>
</ul>
</li>
<li><strong>æ—¶é—´æˆ³åŒæ­¥</strong> - æ¯ä¸ª Chunk æºå¸¦æ—¶é—´æˆ³ï¼Œæ¥æ”¶ç«¯æ ¹æ®æ—¶é—´æˆ³åŒæ­¥éŸ³è§†é¢‘</li>
<li><strong>ä½å»¶è¿Ÿä¼ è¾“</strong> - TCP ä¿è¯å¯é æ€§ï¼Œæ•°æ®å®æ—¶æ¨é€ï¼Œå»¶è¿Ÿ 1-3 ç§’</li>
</ol>
<p><strong>RTSPï¼š</strong></p>
<ol>
<li><strong>ä¼šè¯æ§åˆ¶</strong> - RTSP ç±»ä¼¼ HTTPï¼Œä½¿ç”¨æ–‡æœ¬å‘½ä»¤æ§åˆ¶æµåª’ä½“ä¼šè¯(SETUPã€PLAYã€PAUSEã€TEARDOWN)</li>
<li><strong>åª’ä½“ä¼ è¾“</strong> - RTSP æœ¬èº«ä¸ä¼ è¾“åª’ä½“æ•°æ®ï¼Œåª’ä½“é€šè¿‡ RTP/RTCP ä¼ è¾“
<ul>
<li>RTP(Real-time Transport Protocol)ï¼šä¼ è¾“éŸ³è§†é¢‘æ•°æ®åŒ…</li>
<li>RTCP(RTP Control Protocol)ï¼šç›‘æ§ä¼ è¾“è´¨é‡</li>
</ul>
</li>
<li><strong>åˆ†ç¦»æ§åˆ¶å’Œæ•°æ®</strong> - RTSP æ§åˆ¶é€šé“(TCP)å’Œ RTP æ•°æ®é€šé“(UDP)åˆ†ç¦»</li>
</ol>
<p><strong>æµè§ˆå™¨é™åˆ¶ï¼š</strong></p>
<ul>
<li>æµè§ˆå™¨åŸç”Ÿä¸æ”¯æŒ RTMP/RTSP</li>
<li>éœ€è¦æœåŠ¡ç«¯è½¬æ¢ä¸º HLS/FLV/WebRTC åæ‰èƒ½åœ¨ Web æ’­æ”¾</li>
<li>ä¸»è¦ç”¨äºæ¨æµç«¯(å¦‚ OBS æ¨æµåˆ°æœåŠ¡å™¨)</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># OBS æ¨æµåˆ° RTMP æœåŠ¡å™¨</span>
rtmp://live.example.com/app/stream_key

<span class="hljs-comment"># æœåŠ¡ç«¯å°† RTMP è½¬æ¢ä¸º HLS ä¾›æµè§ˆå™¨æ’­æ”¾</span>
ffmpeg -i rtmp://input -f hls output.m3u8
</code></pre>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li><strong>ä½å»¶è¿Ÿæ¨æµ</strong> - å®æ—¶ä¼ è¾“ï¼Œå»¶è¿Ÿ 1-3 ç§’</li>
<li><strong>å¯é ä¼ è¾“</strong> - åŸºäº TCPï¼Œä¿è¯æ•°æ®å®Œæ•´æ€§</li>
<li><strong>å¹¿æ³›æ”¯æŒ</strong> - æ¨æµè½¯ä»¶(OBSã€FFmpeg)ã€æµåª’ä½“æœåŠ¡å™¨(Nginx-RTMP)å¹¿æ³›æ”¯æŒ</li>
<li><strong>æˆç†Ÿç¨³å®š</strong> - åè®®æˆç†Ÿï¼Œç”Ÿæ€å®Œå–„</li>
</ol>
<h3 data-id="heading-22">SRT - å®‰å…¨å¯é ä¼ è¾“</h3>
<p>SRT(Secure Reliable Transport)æ˜¯åŸºäº UDP çš„æ–°ä¸€ä»£æµåª’ä½“ä¼ è¾“åè®®ï¼Œä¸ºä¸“ä¸šç›´æ’­åœºæ™¯è®¾è®¡ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<p>ä¼ ç»Ÿ TCP åè®®åœ¨å¼±ç½‘ç¯å¢ƒä¸‹æ€§èƒ½å·®(é˜Ÿå¤´é˜»å¡ã€ä¸¢åŒ…é‡ä¼ å¯¼è‡´å»¶è¿Ÿ)ï¼Œçº¯ UDP åˆä¸å¯é ã€‚SRT åœ¨ UDP åŸºç¡€ä¸Šå®ç°äº†å¯é ä¼ è¾“æœºåˆ¶ï¼š</p>
<ol>
<li><strong>åŸºäº UDP</strong> - é¿å… TCP çš„é˜Ÿå¤´é˜»å¡é—®é¢˜</li>
<li><strong>ARQ è‡ªåŠ¨é‡ä¼ </strong> - æ£€æµ‹åˆ°ä¸¢åŒ…åï¼Œé€‰æ‹©æ€§é‡ä¼ ä¸¢å¤±çš„æ•°æ®åŒ…
<ul>
<li>æ¥æ”¶ç«¯å‘é€ NAK(Negative Acknowledgment)é€šçŸ¥ä¸¢åŒ…</li>
<li>å‘é€ç«¯é‡ä¼ ä¸¢å¤±çš„åŒ…ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæµ</li>
</ul>
</li>
<li><strong>å‰å‘çº é”™(FEC)</strong> - å¯é€‰çš„ FEC æœºåˆ¶ï¼Œå‘é€å†—ä½™æ•°æ®ç”¨äºçº é”™
<ul>
<li>è½»å¾®ä¸¢åŒ…å¯é€šè¿‡ FEC ç›´æ¥æ¢å¤ï¼Œæ— éœ€é‡ä¼ </li>
</ul>
</li>
<li><strong>åŠ¨æ€ç¼“å†²</strong> - æ ¹æ®ç½‘ç»œçŠ¶å†µåŠ¨æ€è°ƒæ•´ç¼“å†²åŒºå¤§å°
<ul>
<li>å¹³è¡¡å»¶è¿Ÿå’ŒæŠ—ä¸¢åŒ…èƒ½åŠ›</li>
</ul>
</li>
<li><strong>AES åŠ å¯†</strong> - å†…ç½®ç«¯åˆ°ç«¯åŠ å¯†ï¼Œä¿æŠ¤ä¼ è¾“å†…å®¹å®‰å…¨</li>
<li><strong>å¸¦å®½è‡ªé€‚åº”</strong> - æ£€æµ‹ç½‘ç»œæ‹¥å¡ï¼ŒåŠ¨æ€è°ƒæ•´å‘é€é€Ÿç‡</li>
</ol>
<p><strong>å»¶è¿Ÿç‰¹æ€§ï¼š</strong></p>
<ul>
<li>å¯é…ç½®å»¶è¿Ÿ(é€šå¸¸ 200ms-2s)</li>
<li>å»¶è¿Ÿè¶Šé«˜ï¼ŒæŠ—ä¸¢åŒ…èƒ½åŠ›è¶Šå¼º</li>
<li>é€‚åˆä¸“ä¸šç›´æ’­åœºæ™¯(æ¼”å”±ä¼šã€ä½“è‚²èµ›äº‹è½¬æ’­)</li>
</ul>
<p><strong>æµè§ˆå™¨é™åˆ¶ï¼š</strong></p>
<ul>
<li>æµè§ˆå™¨ä¸ç›´æ¥æ”¯æŒ SRT</li>
<li>éœ€è¦æœåŠ¡ç«¯æ¥æ”¶ SRT æµï¼Œè½¬æ¢ä¸º HLS/WebRTC ä¾›æµè§ˆå™¨æ’­æ”¾</li>
</ul>
<p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># FFmpeg ä½¿ç”¨ SRT æ¨æµ</span>
ffmpeg -i input.mp4 -f mpegts <span class="hljs-string">"srt://server:port?streamid=live/stream"</span>

<span class="hljs-comment"># æœåŠ¡ç«¯æ¥æ”¶ SRTï¼Œè½¬å‘ä¸º HLS</span>
srt-live-transmit srt://:9000 http://localhost:8080/live.m3u8
</code></pre>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li><strong>æŠ—ä¸¢åŒ…</strong> - ARQ + FEC æœºåˆ¶ï¼Œå¼±ç½‘ç¯å¢ƒä¸‹ä¿æŒç¨³å®šä¼ è¾“</li>
<li><strong>ä½å»¶è¿Ÿ</strong> - åŸºäº UDPï¼Œé¿å… TCP é˜Ÿå¤´é˜»å¡ï¼Œå»¶è¿Ÿ &lt;1 ç§’</li>
<li><strong>å®‰å…¨ä¼ è¾“</strong> - AES åŠ å¯†ï¼Œä¿æŠ¤å†…å®¹å®‰å…¨</li>
<li><strong>ç©¿é€ NAT</strong> - å†…ç½®æ‰“æ´æœºåˆ¶ï¼Œç®€åŒ–éƒ¨ç½²</li>
<li><strong>å¼€æºåè®®</strong> - ç¤¾åŒºæ´»è·ƒï¼Œå·¥å…·é“¾å®Œå–„</li>
</ol>
<h3 data-id="heading-23">æµåª’ä½“ç¼“å­˜æŠ€æœ¯</h3>
<p>æµåª’ä½“æ’­æ”¾ä¸­ï¼Œç¼“å­˜æŠ€æœ¯ç”¨äºå®ç°ç¦»çº¿æ’­æ”¾ã€å‡å°‘é‡å¤è¯·æ±‚ã€é™ä½å¸¦å®½æˆæœ¬ã€‚</p>
<p><strong>IndexedDB - ç¦»çº¿è§†é¢‘å­˜å‚¨</strong></p>
<p>IndexedDB å¯ä»¥å­˜å‚¨å¤§å®¹é‡ Blob æ•°æ®ï¼Œå®ç°è§†é¢‘ç¦»çº¿æ’­æ”¾ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å­˜å‚¨è§†é¢‘ç‰‡æ®µ</span>
<span class="hljs-keyword">const</span> request = indexedDB.<span class="hljs-title function_">open</span>(<span class="hljs-string">"VideoCache"</span>, <span class="hljs-number">1</span>);
request.<span class="hljs-property">onupgradeneeded</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> db = e.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>;
  db.<span class="hljs-title function_">createObjectStore</span>(<span class="hljs-string">"videos"</span>, { <span class="hljs-attr">keyPath</span>: <span class="hljs-string">"id"</span> });
};

request.<span class="hljs-property">onsuccess</span> = <span class="hljs-keyword">async</span> (e) =&gt; {
  <span class="hljs-keyword">const</span> db = e.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>;
  <span class="hljs-keyword">const</span> tx = db.<span class="hljs-title function_">transaction</span>(<span class="hljs-string">"videos"</span>, <span class="hljs-string">"readwrite"</span>);
  <span class="hljs-keyword">const</span> store = tx.<span class="hljs-title function_">objectStore</span>(<span class="hljs-string">"videos"</span>);

  <span class="hljs-comment">// ä¸‹è½½å¹¶ç¼“å­˜è§†é¢‘</span>
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">"video.mp4"</span>);
  <span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">blob</span>();
  <span class="hljs-keyword">await</span> store.<span class="hljs-title function_">put</span>({ <span class="hljs-attr">id</span>: <span class="hljs-string">"video123"</span>, blob, <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() });

  <span class="hljs-comment">// ç¦»çº¿æ’­æ”¾</span>
  <span class="hljs-keyword">const</span> cachedVideo = <span class="hljs-keyword">await</span> store.<span class="hljs-title function_">get</span>(<span class="hljs-string">"video123"</span>);
  video.<span class="hljs-property">src</span> = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(cachedVideo.<span class="hljs-property">blob</span>);
};
</code></pre>
<p><strong>Cache API - HLS ç‰‡æ®µç¼“å­˜</strong></p>
<p>Cache API é…åˆ Service Worker ç¼“å­˜ HLS ç‰‡æ®µï¼Œå®ç°æµåª’ä½“ç¦»çº¿æ’­æ”¾ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Service Worker ä¸­ç¼“å­˜ HLS ç‰‡æ®µ</span>
self.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"fetch"</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">request</span>.<span class="hljs-property">url</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-string">".ts"</span>) || e.<span class="hljs-property">request</span>.<span class="hljs-property">url</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-string">".m3u8"</span>)) {
    e.<span class="hljs-title function_">respondWith</span>(
      caches.<span class="hljs-title function_">match</span>(e.<span class="hljs-property">request</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (response) <span class="hljs-keyword">return</span> response; <span class="hljs-comment">// è¿”å›ç¼“å­˜</span>

        <span class="hljs-keyword">return</span> <span class="hljs-title function_">fetch</span>(e.<span class="hljs-property">request</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
          <span class="hljs-keyword">const</span> cloned = response.<span class="hljs-title function_">clone</span>();
          caches.<span class="hljs-title function_">open</span>(<span class="hljs-string">"hls-cache"</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">cache</span>) =&gt;</span> {
            cache.<span class="hljs-title function_">put</span>(e.<span class="hljs-property">request</span>, cloned); <span class="hljs-comment">// ç¼“å­˜ç‰‡æ®µ</span>
          });
          <span class="hljs-keyword">return</span> response;
        });
      })
    );
  }
});
</code></pre>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>PWA ç¦»çº¿æ’­æ”¾</strong>ï¼šé¢„ç¼“å­˜è§†é¢‘èµ„æºï¼Œç”¨æˆ·ç¦»çº¿æ—¶ä»å¯è§‚çœ‹</li>
<li><strong>HLS ç‰‡æ®µä¼˜åŒ–</strong>ï¼šç¼“å­˜å·²ä¸‹è½½çš„ .ts ç‰‡æ®µï¼Œç”¨æˆ· seek æ—¶æ— éœ€é‡å¤è¯·æ±‚</li>
<li><strong>ç›´æ’­å›çœ‹</strong>ï¼šç¼“å­˜ç›´æ’­ç‰‡æ®µåˆ° IndexedDBï¼Œç”¨æˆ·å¯å›çœ‹æœ€è¿‘å†…å®¹</li>
</ul>
<h2 data-id="heading-24">åª’ä½“å¤„ç†ä¸ç¼–è¾‘æŠ€æœ¯</h2>
<p>åª’ä½“å¤„ç†ä¸ç¼–è¾‘æŠ€æœ¯æä¾›å¯¹éŸ³è§†é¢‘æ•°æ®çš„åƒç´ çº§ã€é‡‡æ ·çº§æ“ä½œèƒ½åŠ›ï¼Œä»éŸ³é¢‘åˆ†æã€è§†é¢‘ç‰¹æ•ˆã€åˆ°è‡ªå®šä¹‰ç¼–è§£ç ï¼Œå®ç°å¤æ‚çš„å¤šåª’ä½“å¤„ç†éœ€æ±‚ã€‚</p>





















































<table><thead><tr><th>æŠ€æœ¯</th><th>å¤„ç†å¯¹è±¡</th><th>æ€§èƒ½</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>Web Audio API</td><td>éŸ³é¢‘é‡‡æ ·</td><td>å®æ—¶</td><td>éŸ³é¢‘åˆæˆã€ç‰¹æ•ˆã€å¯è§†åŒ–</td></tr><tr><td>Canvas 2D</td><td>è§†é¢‘å¸§(åƒç´ )</td><td>ä¸­ç­‰</td><td>æ°´å°ã€æ»¤é•œã€æˆªå›¾</td></tr><tr><td>WebGL</td><td>è§†é¢‘å¸§(GPU)</td><td>é«˜</td><td>å®æ—¶ç‰¹æ•ˆã€3D æ¸²æŸ“</td></tr><tr><td>WebGPU</td><td>é€šç”¨è®¡ç®—</td><td>æé«˜</td><td>AI æ¨ç†ã€å¤æ‚è®¡ç®—</td></tr><tr><td>WebCodecs</td><td>ç¼–è§£ç </td><td>é«˜</td><td>è‡ªå®šä¹‰ç¼–è§£ç ã€è½¬ç </td></tr><tr><td>WebAssembly</td><td>é€šç”¨è®¡ç®—</td><td>é«˜</td><td>FFmpegã€è‡ªå®šä¹‰ç®—æ³•</td></tr><tr><td>OffscreenCanvas</td><td>ç¦»å±æ¸²æŸ“</td><td>é«˜</td><td>åå°å¤„ç†ã€å¤šçº¿ç¨‹</td></tr></tbody></table>
<h3 data-id="heading-25">Web Audio API - éŸ³é¢‘å¤„ç†</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWeb_Audio_API" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API" ref="nofollow noopener noreferrer">Web Audio API</a> æä¾›éŸ³é¢‘å¤„ç†çš„æ¨¡å—åŒ–èŠ‚ç‚¹ç³»ç»Ÿï¼Œå¯å¯¹éŸ³é¢‘æµè¿›è¡Œåˆ†æã€åˆæˆå’Œç‰¹æ•ˆå¤„ç†ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<p>ä¼ ç»Ÿæ–¹å¼ä¸‹ï¼ŒéŸ³é¢‘æ’­æ”¾æ˜¯é»‘ç›’æ“ä½œï¼Œæ— æ³•è®¿é—®éŸ³é¢‘æ•°æ®ã€‚Web Audio API å°†éŸ³é¢‘å¤„ç†æŠ½è±¡ä¸º"èŠ‚ç‚¹å›¾"æ¨¡å‹ï¼š</p>
<ol>
<li><strong>éŸ³é¢‘ä¸Šä¸‹æ–‡(AudioContext)</strong> - ç®¡ç†å’Œåè°ƒæ‰€æœ‰éŸ³é¢‘æ“ä½œ</li>
<li><strong>èŠ‚ç‚¹(AudioNode)</strong> - éŸ³é¢‘å¤„ç†çš„åŸºæœ¬å•å…ƒï¼Œæ¯ä¸ªèŠ‚ç‚¹æ‰§è¡Œç‰¹å®šåŠŸèƒ½ï¼š
<ul>
<li><strong>æºèŠ‚ç‚¹</strong> - äº§ç”ŸéŸ³é¢‘ï¼šMediaStreamSourceã€BufferSourceã€Oscillator(æŒ¯è¡å™¨)</li>
<li><strong>æ•ˆæœèŠ‚ç‚¹</strong> - å¤„ç†éŸ³é¢‘ï¼šGainNode(éŸ³é‡)ã€BiquadFilterNode(æ»¤æ³¢å™¨)ã€ConvolverNode(æ··å“)</li>
<li><strong>åˆ†æèŠ‚ç‚¹</strong> - åˆ†æéŸ³é¢‘ï¼šAnalyserNode(é¢‘è°±åˆ†æ)</li>
<li><strong>ç›®æ ‡èŠ‚ç‚¹</strong> - è¾“å‡ºéŸ³é¢‘ï¼šAudioDestination(æ‰¬å£°å™¨)</li>
</ul>
</li>
<li><strong>èŠ‚ç‚¹è¿æ¥</strong> - èŠ‚ç‚¹ä¹‹é—´é€šè¿‡ connect() è¿æ¥ï¼Œå½¢æˆéŸ³é¢‘å¤„ç†ç®¡çº¿</li>
</ol>
<p>æ•°æ®æµï¼š<code>æºèŠ‚ç‚¹ â†’ æ•ˆæœèŠ‚ç‚¹ â†’ åˆ†æèŠ‚ç‚¹ â†’ ç›®æ ‡èŠ‚ç‚¹(æ‰¬å£°å™¨)</code></p>
<p><strong>åŸºç¡€ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> audioContext = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AudioContext</span>();

<span class="hljs-comment">// ä» &lt;audio&gt; åˆ›å»ºæºèŠ‚ç‚¹</span>
<span class="hljs-keyword">const</span> source = audioContext.<span class="hljs-title function_">createMediaElementSource</span>(audioElement);

<span class="hljs-comment">// åˆ›å»ºéŸ³é‡æ§åˆ¶èŠ‚ç‚¹</span>
<span class="hljs-keyword">const</span> gainNode = audioContext.<span class="hljs-title function_">createGain</span>();
gainNode.<span class="hljs-property">gain</span>.<span class="hljs-property">value</span> = <span class="hljs-number">0.5</span>; <span class="hljs-comment">// 50% éŸ³é‡</span>

<span class="hljs-comment">// åˆ›å»ºé¢‘è°±åˆ†æèŠ‚ç‚¹</span>
<span class="hljs-keyword">const</span> analyser = audioContext.<span class="hljs-title function_">createAnalyser</span>();

<span class="hljs-comment">// è¿æ¥èŠ‚ç‚¹</span>
source.<span class="hljs-title function_">connect</span>(gainNode).<span class="hljs-title function_">connect</span>(analyser).<span class="hljs-title function_">connect</span>(audioContext.<span class="hljs-property">destination</span>);

<span class="hljs-comment">// è·å–é¢‘è°±æ•°æ®</span>
<span class="hljs-keyword">const</span> dataArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(analyser.<span class="hljs-property">frequencyBinCount</span>);
analyser.<span class="hljs-title function_">getByteFrequencyData</span>(dataArray); <span class="hljs-comment">// å®æ—¶é¢‘è°±æ•°æ®</span>
</code></pre>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li><strong>æ¨¡å—åŒ–å¤„ç†</strong> - é€šè¿‡è¿æ¥ä¸åŒèŠ‚ç‚¹å®ç°å¤æ‚éŸ³é¢‘å¤„ç†</li>
<li><strong>å®æ—¶åˆ†æ</strong> - è·å–æ³¢å½¢ã€é¢‘è°±æ•°æ®ï¼Œå®ç°éŸ³é¢‘å¯è§†åŒ–</li>
<li><strong>éŸ³é¢‘åˆæˆ</strong> - ä½¿ç”¨æŒ¯è¡å™¨åˆæˆå£°éŸ³ï¼Œå®ç°ç”µå­éŸ³ä¹</li>
<li><strong>ç©ºé—´éŸ³æ•ˆ</strong> - PannerNode å®ç° 3D éŸ³é¢‘å®šä½</li>
</ol>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>éŸ³é¢‘å¯è§†åŒ–</strong>ï¼šé€šè¿‡ AnalyserNode å®æ—¶è·å–é¢‘è°±æ•°æ®ï¼Œæ— éœ€è§£ç æ•´ä¸ªéŸ³é¢‘æ–‡ä»¶ï¼Œé™ä½å†…å­˜å ç”¨</li>
<li><strong>åœ¨çº¿ DAW(æ•°å­—éŸ³é¢‘å·¥ä½œç«™)</strong>ï¼šæ¨¡å—åŒ–èŠ‚ç‚¹æ¶æ„å¤©ç„¶é€‚åˆéŸ³è½¨æ··éŸ³ã€æ•ˆæœå™¨å åŠ ç­‰éŸ³ä¹åˆ¶ä½œåœºæ™¯</li>
<li><strong>è¯­éŸ³é€šè¯é™å™ª</strong>ï¼šGainNode + BiquadFilterNode å®æ—¶å¤„ç† getUserMedia éŸ³é¢‘æµï¼Œæ— éœ€æœåŠ¡ç«¯å¤„ç†</li>
</ul>
<h3 data-id="heading-26">Canvas 2D - è§†é¢‘å¸§å¤„ç†</h3>
<p>Canvas 2D æä¾›åƒç´ çº§çš„å›¾åƒæ“ä½œèƒ½åŠ›ï¼Œå¯å°†è§†é¢‘å¸§ç»˜åˆ¶åˆ°ç”»å¸ƒåè¿›è¡Œå¤„ç†ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<p>è§†é¢‘æ’­æ”¾æ—¶ï¼Œæ¯ä¸€å¸§æ˜¯ä¸€å¼ å›¾åƒã€‚Canvas å¯ä»¥å°†è§†é¢‘å¸§è¯»å–ä¸ºåƒç´ æ•°æ®ï¼Œè¿›è¡Œåƒç´ çº§æ“ä½œåé‡æ–°ç»˜åˆ¶ï¼š</p>
<ol>
<li><strong>ç»˜åˆ¶è§†é¢‘å¸§</strong> - <code>drawImage(video, 0, 0)</code> å°†å½“å‰å¸§ç»˜åˆ¶åˆ° Canvas</li>
<li><strong>è¯»å–åƒç´ æ•°æ®</strong> - <code>getImageData()</code> è·å– RGBA åƒç´ æ•°ç»„ï¼Œæ¯ 4 ä¸ªå€¼è¡¨ç¤ºä¸€ä¸ªåƒç´ (R, G, B, A)</li>
<li><strong>å¤„ç†åƒç´ </strong> - éå†åƒç´ æ•°ç»„ï¼Œä¿®æ”¹é¢œè‰²å€¼å®ç°æ»¤é•œã€ç‰¹æ•ˆ</li>
<li><strong>å†™å›åƒç´ </strong> - <code>putImageData()</code> å°†å¤„ç†åçš„åƒç´ å†™å› Canvas</li>
</ol>
<p><strong>åŸºç¡€ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"canvas"</span>);
<span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">"2d"</span>);
<span class="hljs-keyword">const</span> video = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"video"</span>);

<span class="hljs-keyword">function</span> <span class="hljs-title function_">processFrame</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// ç»˜åˆ¶è§†é¢‘å¸§åˆ° Canvas</span>
  ctx.<span class="hljs-title function_">drawImage</span>(video, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>);

  <span class="hljs-comment">// è¯»å–åƒç´ æ•°æ®</span>
  <span class="hljs-keyword">const</span> imageData = ctx.<span class="hljs-title function_">getImageData</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>);
  <span class="hljs-keyword">const</span> data = imageData.<span class="hljs-property">data</span>; <span class="hljs-comment">// RGBA æ•°ç»„</span>

  <span class="hljs-comment">// åƒç´ å¤„ç†ï¼šç°åº¦åŒ–</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; data.<span class="hljs-property">length</span>; i += <span class="hljs-number">4</span>) {
    <span class="hljs-keyword">const</span> gray = (data[i] + data[i + <span class="hljs-number">1</span>] + data[i + <span class="hljs-number">2</span>]) / <span class="hljs-number">3</span>;
    data[i] = data[i + <span class="hljs-number">1</span>] = data[i + <span class="hljs-number">2</span>] = gray;
  }

  <span class="hljs-comment">// å†™å› Canvas</span>
  ctx.<span class="hljs-title function_">putImageData</span>(imageData, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);

  <span class="hljs-title function_">requestAnimationFrame</span>(processFrame);
}
</code></pre>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li><strong>åƒç´ çº§æ“ä½œ</strong> - ç›´æ¥è®¿é—®å’Œä¿®æ”¹æ¯ä¸ªåƒç´ çš„ RGBA å€¼</li>
<li><strong>å®æ—¶å¤„ç†</strong> - é…åˆ requestAnimationFrame å®æ—¶å¤„ç†è§†é¢‘å¸§</li>
<li><strong>æ»¤é•œæ•ˆæœ</strong> - å®ç°ç°åº¦ã€åè‰²ã€æ¨¡ç³Šç­‰å›¾åƒæ»¤é•œ</li>
<li><strong>æ°´å°å åŠ </strong> - åœ¨è§†é¢‘ä¸Šç»˜åˆ¶æ–‡å­—ã€å›¾åƒæ°´å°</li>
</ol>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>è§†é¢‘æˆªå›¾</strong>ï¼šdrawImage å°†å½“å‰å¸§ç»˜åˆ¶åˆ° Canvasï¼ŒtoBlob å¯¼å‡ºå›¾ç‰‡ï¼Œé¿å…ä¾èµ–æœåŠ¡ç«¯æˆªå›¾</li>
<li><strong>ç®€å•æ»¤é•œ</strong>ï¼šéå†åƒç´ æ•°ç»„ä¿®æ”¹ RGB å€¼ï¼Œæ— éœ€ä¾èµ– GPUï¼Œé€‚åˆè½»é‡çº§å¤„ç†(å¦‚ç°åº¦ã€åè‰²)</li>
<li><strong>éšç§ä¿æŠ¤</strong>ï¼šå®æ—¶æ£€æµ‹äººè„¸åŒºåŸŸåï¼Œä¿®æ”¹è¯¥åŒºåŸŸåƒç´ ä¸ºæ¨¡ç³Šæˆ–é©¬èµ›å…‹ï¼Œåœ¨å®¢æˆ·ç«¯å®Œæˆæ•æ„Ÿä¿¡æ¯è„±æ•</li>
</ul>
<h3 data-id="heading-27">WebGL - GPU åŠ é€Ÿæ¸²æŸ“</h3>
<p>WebGL åˆ©ç”¨ GPU å¹¶è¡Œè®¡ç®—èƒ½åŠ›ï¼Œå®ç°é«˜æ€§èƒ½çš„è§†é¢‘å¤„ç†å’Œç‰¹æ•ˆæ¸²æŸ“ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<p>Canvas 2D åœ¨ CPU ä¸Šé€åƒç´ å¤„ç†ï¼Œå¯¹äºé«˜åˆ†è¾¨ç‡è§†é¢‘æ€§èƒ½ä¸è¶³ã€‚WebGL å°†è§†é¢‘ä½œä¸ºçº¹ç†(Texture)ä¸Šä¼ åˆ° GPUï¼Œé€šè¿‡ç€è‰²å™¨(Shader)å¹¶è¡Œå¤„ç†æ‰€æœ‰åƒç´ ï¼š</p>
<ol>
<li><strong>çº¹ç†ä¸Šä¼ </strong> - å°†è§†é¢‘å¸§ä¸Šä¼ ä¸º GPU çº¹ç†</li>
<li><strong>é¡¶ç‚¹ç€è‰²å™¨</strong> - å¤„ç†å‡ ä½•å˜æ¢(ä½ç½®ã€ç¼©æ”¾ã€æ—‹è½¬)</li>
<li><strong>ç‰‡æ®µç€è‰²å™¨</strong> - å¤„ç†æ¯ä¸ªåƒç´ çš„é¢œè‰²ï¼Œå®ç°ç‰¹æ•ˆ</li>
<li><strong>GPU å¹¶è¡Œè®¡ç®—</strong> - æ‰€æœ‰åƒç´ åŒæ—¶å¤„ç†ï¼Œé€Ÿåº¦è¿œè¶… CPU</li>
</ol>
<p><strong>ä½¿ç”¨æµç¨‹ï¼š</strong></p>
<p>WebGL å¤„ç†è§†é¢‘æœ‰ä¸¤ç§æ•°æ®æ¥æºï¼š</p>
<p><strong>æ–¹å¼ 1ï¼šä½¿ç”¨ video å…ƒç´ è§£ç </strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. video è‡ªåŠ¨è§£ç è§†é¢‘æ–‡ä»¶</span>
<span class="hljs-keyword">const</span> video = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"video"</span>);
video.<span class="hljs-property">src</span> = <span class="hljs-string">"video.mp4"</span>;
video.<span class="hljs-title function_">play</span>();

<span class="hljs-comment">// 2. WebGL å°† video å½“å‰å¸§ä¸Šä¼ ä¸ºçº¹ç†</span>
<span class="hljs-keyword">const</span> gl = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">"webgl"</span>);
<span class="hljs-keyword">const</span> texture = gl.<span class="hljs-title function_">createTexture</span>();
gl.<span class="hljs-title function_">bindTexture</span>(gl.<span class="hljs-property">TEXTURE_2D</span>, texture);

<span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// video å†…éƒ¨å·²å®Œæˆè§£ç ï¼Œè¿™é‡Œç›´æ¥å°†è§£ç åçš„å¸§ä¸Šä¼  GPU</span>
  gl.<span class="hljs-title function_">texImage2D</span>(gl.<span class="hljs-property">TEXTURE_2D</span>, <span class="hljs-number">0</span>, gl.<span class="hljs-property">RGBA</span>, gl.<span class="hljs-property">RGBA</span>, gl.<span class="hljs-property">UNSIGNED_BYTE</span>, video);

  <span class="hljs-comment">// ä½¿ç”¨ç€è‰²å™¨å¤„ç†çº¹ç†</span>
  gl.<span class="hljs-title function_">useProgram</span>(shaderProgram);
  gl.<span class="hljs-title function_">drawArrays</span>(gl.<span class="hljs-property">TRIANGLES</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>);

  <span class="hljs-title function_">requestAnimationFrame</span>(render);
}
</code></pre>
<p><strong>æ–¹å¼ 2ï¼šä½¿ç”¨ WebCodecs æ‰‹åŠ¨è§£ç </strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. WebCodecs è§£ç å™¨</span>
<span class="hljs-keyword">const</span> decoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VideoDecoder</span>({
  <span class="hljs-attr">output</span>: <span class="hljs-function">(<span class="hljs-params">videoFrame</span>) =&gt;</span> {
    <span class="hljs-comment">// videoFrame æ˜¯è§£ç åçš„åŸå§‹å¸§å¯¹è±¡</span>
    <span class="hljs-comment">// 2. å°† VideoFrame ä¸Šä¼ ä¸º WebGL çº¹ç†(ä¸ video ç”¨æ³•ç›¸åŒ)</span>
    gl.<span class="hljs-title function_">texImage2D</span>(gl.<span class="hljs-property">TEXTURE_2D</span>, <span class="hljs-number">0</span>, gl.<span class="hljs-property">RGBA</span>, gl.<span class="hljs-property">RGBA</span>, gl.<span class="hljs-property">UNSIGNED_BYTE</span>, videoFrame);

    <span class="hljs-comment">// 3. WebGL ç€è‰²å™¨å¤„ç†</span>
    gl.<span class="hljs-title function_">useProgram</span>(shaderProgram);
    gl.<span class="hljs-title function_">drawArrays</span>(gl.<span class="hljs-property">TRIANGLES</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>);

    <span class="hljs-comment">// 4. é‡Šæ”¾å¸§å¯¹è±¡</span>
    videoFrame.<span class="hljs-title function_">close</span>();
  },
  <span class="hljs-attr">error</span>: <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(e),
});

decoder.<span class="hljs-title function_">configure</span>({ <span class="hljs-attr">codec</span>: <span class="hljs-string">"vp8"</span>, <span class="hljs-attr">codedWidth</span>: <span class="hljs-number">1920</span>, <span class="hljs-attr">codedHeight</span>: <span class="hljs-number">1080</span> });

<span class="hljs-comment">// é€å…¥å‹ç¼©æ•°æ®ï¼Œè§£ç å™¨ä¼šè‡ªåŠ¨è§£ç å¹¶è°ƒç”¨ output å›è°ƒ</span>
decoder.<span class="hljs-title function_">decode</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">EncodedVideoChunk</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">"key"</span>, <span class="hljs-attr">timestamp</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">data</span>: encodedData }));
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li><code>gl.texImage2D()</code> å¯ä»¥æ¥å— <code>video</code> å…ƒç´ æˆ– <code>VideoFrame</code> å¯¹è±¡</li>
<li>æ— è®ºå“ªç§æ–¹å¼ï¼Œä¼ ç»™ WebGL çš„éƒ½æ˜¯è§£ç åçš„åŸå§‹åƒç´ æ•°æ®</li>
<li>video æ–¹å¼æ›´ç®€å•ï¼ŒWebCodecs æ–¹å¼æä¾›æ›´ç²¾ç»†çš„æ§åˆ¶</li>
</ul>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li><strong>GPU åŠ é€Ÿ</strong> - åˆ©ç”¨å¹¶è¡Œè®¡ç®—ï¼Œå¤„ç† 4K è§†é¢‘ä»ä¿æŒ 60fps</li>
<li><strong>å¤æ‚ç‰¹æ•ˆ</strong> - å®æ—¶æ¨¡ç³Šã€è‰²å½©æ ¡æ­£ã€ç»¿å¹•æŠ å›¾</li>
<li><strong>3D å˜æ¢</strong> - è§†é¢‘ä½œä¸ºçº¹ç†è´´å›¾åˆ° 3D æ¨¡å‹</li>
<li><strong>ç€è‰²å™¨ç¼–ç¨‹</strong> - GLSL ç¼–å†™è‡ªå®šä¹‰åƒç´ å¤„ç†é€»è¾‘</li>
</ol>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>å®æ—¶ç¾é¢œç›´æ’­</strong>ï¼šç€è‰²å™¨å¹¶è¡Œå¤„ç†æ‰€æœ‰åƒç´ å®ç°ç£¨çš®ï¼Œ1080p ä¿æŒ 60fpsï¼ŒCanvas 2D é€åƒç´ å¤„ç†ä¼šä¸¥é‡æ‰å¸§</li>
<li><strong>ç»¿å¹•æŠ å›¾</strong>ï¼šç€è‰²å™¨åˆ¤æ–­è‰²åº¦èŒƒå›´æ›¿æ¢èƒŒæ™¯ï¼ŒGPU ç™¾ä¸‡åƒç´ å¹¶è¡Œå¤„ç†å®æ—¶å®Œæˆï¼ŒCPU ä¸²è¡Œè®¡ç®—æ— æ³•è¾¾åˆ°å®æ—¶è¦æ±‚</li>
<li><strong>VR è§†é¢‘æ’­æ”¾å™¨</strong>ï¼šå°† 360Â° è§†é¢‘æ˜ å°„ä¸ºçƒä½“çº¹ç†å¹¶æ¸²æŸ“è§†è§’å˜æ¢ï¼ŒWebGL 3D èƒ½åŠ›ä¿è¯ 90fpsï¼Œæ»¡è¶³ VR ä½å»¶è¿Ÿéœ€æ±‚</li>
</ul>
<h3 data-id="heading-28">WebCodecs - åº•å±‚ç¼–è§£ç æ§åˆ¶</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWebCodecs_API" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/API/WebCodecs_API" ref="nofollow noopener noreferrer">WebCodecs</a> æä¾›å¯¹è§†é¢‘ç¼–è§£ç å™¨çš„ç›´æ¥è®¿é—®ï¼Œå®ç°è‡ªå®šä¹‰ç¼–è§£ç æµç¨‹ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<p>ä¼ ç»Ÿæ–¹å¼ä¸‹ï¼Œç¼–è§£ç ç”±æµè§ˆå™¨å†…éƒ¨å¤„ç†ï¼Œå¼€å‘è€…æ— æ³•å¹²é¢„ã€‚WebCodecs æš´éœ²äº†ç¼–è§£ç å™¨æ¥å£ï¼Œå…è®¸ JavaScript ç›´æ¥æ§åˆ¶ï¼š</p>
<ol>
<li><strong>è§£ç å™¨(VideoDecoder)</strong> - å°†ç¼–ç åçš„è§†é¢‘å¸§(EncodedVideoChunk)è§£ç ä¸ºåŸå§‹å¸§(VideoFrame)</li>
<li><strong>ç¼–ç å™¨(VideoEncoder)</strong> - å°†åŸå§‹å¸§ç¼–ç ä¸ºå‹ç¼©æ•°æ®</li>
<li><strong>å¸§çº§æ§åˆ¶</strong> - é€å¸§å¤„ç†ï¼Œå¯åœ¨ç¼–è§£ç è¿‡ç¨‹ä¸­æ’å…¥è‡ªå®šä¹‰é€»è¾‘</li>
</ol>
<p><strong>åŸºç¡€ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> decoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VideoDecoder</span>({
  <span class="hljs-attr">output</span>: <span class="hljs-function">(<span class="hljs-params">frame</span>) =&gt;</span> {
    <span class="hljs-comment">// å¤„ç†è§£ç åçš„åŸå§‹å¸§</span>
    ctx.<span class="hljs-title function_">drawImage</span>(frame, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
    frame.<span class="hljs-title function_">close</span>();
  },
  <span class="hljs-attr">error</span>: <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(e),
});

decoder.<span class="hljs-title function_">configure</span>({
  <span class="hljs-attr">codec</span>: <span class="hljs-string">"vp8"</span>,
  <span class="hljs-attr">codedWidth</span>: <span class="hljs-number">1920</span>,
  <span class="hljs-attr">codedHeight</span>: <span class="hljs-number">1080</span>,
});

<span class="hljs-comment">// é€å…¥ç¼–ç æ•°æ®</span>
decoder.<span class="hljs-title function_">decode</span>(
  <span class="hljs-keyword">new</span> <span class="hljs-title class_">EncodedVideoChunk</span>({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"key"</span>,
    <span class="hljs-attr">timestamp</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">data</span>: encodedData,
  })
);
</code></pre>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li><strong>è‡ªå®šä¹‰ç¼–è§£ç </strong> - ä¸ä¾èµ– video å…ƒç´ ï¼Œå®Œå…¨æ§åˆ¶ç¼–è§£ç æµç¨‹</li>
<li><strong>æ ¼å¼è½¬æ¢</strong> - è§£ç åé‡æ–°ç¼–ç ï¼Œå®ç°æ ¼å¼è½¬æ¢</li>
<li><strong>å¸§çº§å¤„ç†</strong> - åœ¨è§£ç åã€ç¼–ç å‰æ’å…¥è‡ªå®šä¹‰å¤„ç†</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong> - ç›´æ¥è®¿é—®ç¡¬ä»¶ç¼–è§£ç å™¨ï¼Œæ€§èƒ½æ¥è¿‘åŸç”Ÿ</li>
</ol>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>æµè§ˆå™¨ç«¯è½¬ç </strong>ï¼šè§£ç  H.264 â†’ å¸§çº§å¤„ç† â†’ é‡æ–°ç¼–ç ä¸º VP9ï¼Œæ— éœ€ä¸Šä¼ æœåŠ¡å™¨ï¼ŒèŠ‚çœå¸¦å®½å’Œéšç§ä¿æŠ¤</li>
<li><strong>WebRTC è‡ªå®šä¹‰ç¼–ç </strong>ï¼šæ•è·æµåè‡ªå®šä¹‰ç¼–ç å‚æ•°(ç ç‡ã€å…³é”®å¸§é—´éš”)ï¼Œvideo å…ƒç´ æ— æ³•ç²¾ç»†æ§åˆ¶ç¼–ç è¿‡ç¨‹</li>
<li><strong>è§†é¢‘ç¼–è¾‘å™¨</strong>ï¼šé€å¸§è§£ç ã€å‰ªè¾‘ã€ç‰¹æ•ˆå¤„ç†åé‡æ–°ç¼–ç ï¼Œvideo å…ƒç´ åªæ”¯æŒæ’­æ”¾æ— æ³•é€å¸§æ§åˆ¶</li>
</ul>
<h3 data-id="heading-29">WebAssembly - é«˜æ€§èƒ½è®¡ç®—</h3>
<p>WebAssembly å°† C/C++ ç­‰è¯­è¨€ç¼–è¯‘ä¸ºæµè§ˆå™¨å¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æ ¼å¼ï¼Œæ€§èƒ½æ¥è¿‘åŸç”Ÿä»£ç ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<p>JavaScript æ˜¯è§£é‡Šæ‰§è¡Œï¼Œæ€§èƒ½æœ‰é™ã€‚WebAssembly æ˜¯ç¼–è¯‘å‹äºŒè¿›åˆ¶æ ¼å¼ï¼Œåœ¨æµè§ˆå™¨ä¸­æ¥è¿‘åŸç”Ÿæ€§èƒ½è¿è¡Œï¼š</p>
<ol>
<li><strong>ç¼–è¯‘</strong> - å°† C/C++ ä»£ç ç¼–è¯‘ä¸º .wasm æ–‡ä»¶</li>
<li><strong>åŠ è½½</strong> - JavaScript åŠ è½½ .wasm æ¨¡å—</li>
<li><strong>è°ƒç”¨</strong> - JavaScript è°ƒç”¨ WASM å¯¼å‡ºçš„å‡½æ•°ï¼Œä¼ é€’éŸ³è§†é¢‘æ•°æ®</li>
</ol>
<p>å…¸å‹åº”ç”¨ï¼šFFmpeg.wasm å°† FFmpeg ç¼–è¯‘ä¸º WASMï¼Œåœ¨æµè§ˆå™¨ä¸­å®ç°è§†é¢‘è½¬ç ã€å‰ªè¾‘ç­‰å¤æ‚æ“ä½œã€‚</p>
<p><strong>åŸºç¡€ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { createFFmpeg } <span class="hljs-keyword">from</span> <span class="hljs-string">"@ffmpeg/ffmpeg"</span>;

<span class="hljs-keyword">const</span> ffmpeg = <span class="hljs-title function_">createFFmpeg</span>({ <span class="hljs-attr">log</span>: <span class="hljs-literal">true</span> });
<span class="hljs-keyword">await</span> ffmpeg.<span class="hljs-title function_">load</span>();

<span class="hljs-comment">// åœ¨æµè§ˆå™¨ä¸­è½¬ç è§†é¢‘</span>
ffmpeg.<span class="hljs-title function_">FS</span>(<span class="hljs-string">"writeFile"</span>, <span class="hljs-string">"input.mp4"</span>, <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchFile</span>(videoFile));
<span class="hljs-keyword">await</span> ffmpeg.<span class="hljs-title function_">run</span>(<span class="hljs-string">"-i"</span>, <span class="hljs-string">"input.mp4"</span>, <span class="hljs-string">"-vf"</span>, <span class="hljs-string">"scale=640:480"</span>, <span class="hljs-string">"output.mp4"</span>);
<span class="hljs-keyword">const</span> data = ffmpeg.<span class="hljs-title function_">FS</span>(<span class="hljs-string">"readFile"</span>, <span class="hljs-string">"output.mp4"</span>);
</code></pre>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li><strong>æ¥è¿‘åŸç”Ÿæ€§èƒ½</strong> - æ‰§è¡Œé€Ÿåº¦æ˜¯çº¯ JavaScript çš„æ•°å€</li>
<li><strong>å¤ç”¨ç°æœ‰ä»£ç </strong> - å°† C/C++ åº“(FFmpegã€OpenCV)ç§»æ¤åˆ°æµè§ˆå™¨</li>
<li><strong>CPU å¯†é›†è®¡ç®—</strong> - é€‚åˆè§†é¢‘ç¼–è§£ç ã€å›¾åƒå¤„ç†ç­‰è®¡ç®—å¯†é›†ä»»åŠ¡</li>
<li><strong>è·¨å¹³å°</strong> - ä¸€æ¬¡ç¼–è¯‘ï¼Œæ‰€æœ‰æµè§ˆå™¨è¿è¡Œ</li>
</ol>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>FFmpeg.wasm è§†é¢‘å¤„ç†</strong>ï¼šå¤ç”¨ FFmpeg C ä»£ç å®ç°å¤æ‚è½¬ç ã€å‰ªè¾‘ï¼ŒJavaScript é‡å†™æ€§èƒ½å’Œå·¥ç¨‹é‡ä¸å¯æ¥å—</li>
<li><strong>OpenCV.js è®¡ç®—æœºè§†è§‰</strong>ï¼šäººè„¸è¯†åˆ«ã€ç‰©ä½“æ£€æµ‹ç®—æ³•éœ€è¦å¤§é‡çŸ©é˜µè¿ç®—ï¼ŒWASM æ¯” JS å¿« 5-10 å€</li>
<li><strong>éŸ³é¢‘å¤„ç†ç®—æ³•</strong>ï¼šOpus ç¼–è§£ç å™¨ã€éŸ³é¢‘é™å™ªç®—æ³•ï¼ŒC å®ç°æ€§èƒ½è¿œè¶… JavaScript ä¸”ç®—æ³•åº“å·²æˆç†Ÿ</li>
</ul>
<h3 data-id="heading-30">OffscreenCanvas - ç¦»å±æ¸²æŸ“</h3>
<p>OffscreenCanvas å…è®¸åœ¨ Web Worker ä¸­è¿›è¡Œ Canvas æ¸²æŸ“ï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<p>Canvas æ¸²æŸ“åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œå¤æ‚è®¡ç®—ä¼šé˜»å¡ UIã€‚OffscreenCanvas å°† Canvas è½¬ç§»åˆ° Worker çº¿ç¨‹ï¼š</p>
<ol>
<li><strong>åˆ›å»ºç¦»å± Canvas</strong> - <code>canvas.transferControlToOffscreen()</code></li>
<li><strong>è½¬ç§»åˆ° Worker</strong> - é€šè¿‡ postMessage å°† OffscreenCanvas å‘é€åˆ° Worker</li>
<li><strong>Worker ä¸­æ¸²æŸ“</strong> - Worker çº¿ç¨‹ç‹¬ç«‹æ¸²æŸ“ï¼Œä¸é˜»å¡ä¸»çº¿ç¨‹</li>
<li><strong>è‡ªåŠ¨åŒæ­¥</strong> - æ¸²æŸ“ç»“æœè‡ªåŠ¨åŒæ­¥åˆ°é¡µé¢ Canvas</li>
</ol>
<p><strong>åŸºç¡€ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¸»çº¿ç¨‹</span>
<span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"canvas"</span>);
<span class="hljs-keyword">const</span> offscreen = canvas.<span class="hljs-title function_">transferControlToOffscreen</span>();
<span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">"worker.js"</span>);
worker.<span class="hljs-title function_">postMessage</span>({ <span class="hljs-attr">canvas</span>: offscreen }, [offscreen]);

<span class="hljs-comment">// worker.js</span>
self.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> canvas = e.<span class="hljs-property">data</span>.<span class="hljs-property">canvas</span>;
  <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">"2d"</span>);

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
    ctx.<span class="hljs-title function_">drawImage</span>(video, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
    <span class="hljs-comment">// å¤æ‚çš„åƒç´ å¤„ç†...</span>
    <span class="hljs-title function_">requestAnimationFrame</span>(render);
  }
  <span class="hljs-title function_">render</span>();
};
</code></pre>
<p><strong>æ ¸å¿ƒèƒ½åŠ›ï¼š</strong></p>
<ol>
<li><strong>å¤šçº¿ç¨‹æ¸²æŸ“</strong> - æ¸²æŸ“æ“ä½œåœ¨ Worker æ‰§è¡Œï¼Œä¸»çº¿ç¨‹æµç•…</li>
<li><strong>å¹¶è¡Œå¤„ç†</strong> - å¤šä¸ª Worker åŒæ—¶å¤„ç†ä¸åŒå¸§</li>
<li><strong>ä¸é˜»å¡ UI</strong> - å³ä½¿å¤æ‚è®¡ç®—ä¹Ÿä¸å½±å“ç”¨æˆ·äº¤äº’</li>
<li><strong>è‡ªåŠ¨åŒæ­¥</strong> - æ— éœ€æ‰‹åŠ¨ä¼ é€’æ¸²æŸ“ç»“æœ</li>
</ol>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>è§†é¢‘æ°´å°æ‰¹å¤„ç†</strong>ï¼šå¤šä¸ª Worker å¹¶è¡Œå¤„ç†ä¸åŒç‰‡æ®µï¼Œå……åˆ†åˆ©ç”¨å¤šæ ¸ CPUï¼Œä¸»çº¿ç¨‹ Canvas ä¼šé˜»å¡ UI</li>
<li><strong>å®æ—¶è§†é¢‘å¤„ç†</strong>ï¼šWorker æ‰§è¡Œå¤æ‚åƒç´ è®¡ç®—(å¦‚é£æ ¼åŒ–æ»¤é•œ)ï¼Œä¸»çº¿ç¨‹ä¿æŒ 60fps äº¤äº’å“åº”</li>
<li><strong>åå°è§†é¢‘æ¸²æŸ“</strong>ï¼šåˆ‡æ¢æ ‡ç­¾é¡µå Worker ç»§ç»­æ¸²æŸ“ï¼Œä¸»çº¿ç¨‹ Canvas åœ¨åå°ä¼šæš‚åœ</li>
</ul>
<h2 data-id="heading-31">ç¼–è§£ç ä¸å®¹å™¨æ ¼å¼</h2>
<p>ç¼–è§£ç ä¸å®¹å™¨æ ¼å¼æ˜¯å¤šåª’ä½“æŠ€æœ¯çš„åŸºç¡€ï¼Œå†³å®šäº†éŸ³è§†é¢‘çš„å‹ç¼©æ•ˆç‡ã€ä¼ è¾“æˆæœ¬å’Œæ’­æ”¾å…¼å®¹æ€§ã€‚ç¼–ç å™¨(Encoder)å°†åŸå§‹éŸ³è§†é¢‘æ•°æ®å‹ç¼©ä¸ºç æµï¼Œè§£ç å™¨(Decoder)å°†ç æµè¿˜åŸä¸ºå¯æ’­æ”¾çš„æ•°æ®ï¼Œå®¹å™¨æ ¼å¼(Container)è´Ÿè´£å°†éŸ³é¢‘æµã€è§†é¢‘æµã€å­—å¹•ç­‰å¤šä¸ªæµå°è£…åœ¨ä¸€èµ·ã€‚ç†è§£ç¼–è§£ç åŸç†å’Œæ ¼å¼é€‰æ‹©ï¼Œå¯¹ä¼˜åŒ–æ–‡ä»¶å¤§å°ã€ç”»è´¨ã€åŠ è½½é€Ÿåº¦è‡³å…³é‡è¦ã€‚</p>
<p><strong>æŠ€æœ¯åˆ†å±‚å…³ç³»ï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss">åŸå§‹æ•°æ® â†’ ç¼–ç å™¨(Encoder) â†’ å‹ç¼©ç æµ â†’ å®¹å™¨å°è£…(Muxer) â†’ åª’ä½“æ–‡ä»¶
åª’ä½“æ–‡ä»¶ â†’ å®¹å™¨è§£å°è£…(Demuxer) â†’ å‹ç¼©ç æµ â†’ è§£ç å™¨(Decoder) â†’ åŸå§‹æ•°æ®
</code></pre>
<h3 data-id="heading-32">è§†é¢‘ç¼–ç æ ¼å¼</h3>
<p>è§†é¢‘ç¼–ç é€šè¿‡æ—¶é—´å†—ä½™(å¸§é—´é¢„æµ‹)å’Œç©ºé—´å†—ä½™(å¸§å†…å‹ç¼©)å®ç°é«˜å‹ç¼©æ¯”ï¼Œå°†åŸå§‹åƒç´ æ•°æ®å‹ç¼©è‡³åŸå¤§å°çš„ 1%ã€‚</p>
<p><strong>ä¸»æµç¼–ç æ ¼å¼å¯¹æ¯”ï¼š</strong></p>





























































<table><thead><tr><th>ç¼–ç æ ¼å¼</th><th>æ ‡å‡†ç»„ç»‡</th><th>å‹ç¼©æ•ˆç‡</th><th>è®¡ç®—å¤æ‚åº¦</th><th>æµè§ˆå™¨æ”¯æŒ</th><th>ä¸“åˆ©/æˆæƒ</th></tr></thead><tbody><tr><td>H.264/AVC</td><td>ITU/MPEG</td><td>åŸºå‡†(1x)</td><td>ä¸­</td><td>å…¨å¹³å°</td><td>ä¸“åˆ©(å…è´¹ä¸Šé™)</td></tr><tr><td>H.265/HEVC</td><td>ITU/MPEG</td><td>2x H.264</td><td>é«˜</td><td>éƒ¨åˆ†</td><td>ä¸“åˆ©(å¤æ‚è´¹ç”¨)</td></tr><tr><td>VP8</td><td>Google</td><td>0.8x H.264</td><td>ä¸­</td><td>Chrome/Firefox</td><td>å…è´¹å¼€æº</td></tr><tr><td>VP9</td><td>Google</td><td>1.5x H.264</td><td>é«˜</td><td>Chrome/Firefox/Edge</td><td>å…è´¹å¼€æº</td></tr><tr><td>AV1</td><td>AOMedia</td><td>2x H.264</td><td>æé«˜</td><td>ç°ä»£æµè§ˆå™¨</td><td>å…è´¹å¼€æº</td></tr><tr><td>H.266/VVC</td><td>ITU/MPEG</td><td>2.5x H.264</td><td>æé«˜</td><td>æ— </td><td>ä¸“åˆ©</td></tr></tbody></table>
<p><strong>H.264/AVC - æœ€å¹¿æ³›æ”¯æŒçš„ç¼–ç æ ¼å¼</strong></p>
<p>H.264(Advanced Video Coding)æ˜¯ç›®å‰å…¼å®¹æ€§æœ€å¥½çš„è§†é¢‘ç¼–ç æ ¼å¼ï¼Œå‡ ä¹æ‰€æœ‰è®¾å¤‡å’Œæµè§ˆå™¨éƒ½æ”¯æŒç¡¬ä»¶è§£ç ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<ol>
<li><strong>å¸§å†…é¢„æµ‹(Intra Prediction)</strong> - I å¸§å†…éƒ¨ï¼Œä»ç›¸é‚»åƒç´ é¢„æµ‹å½“å‰åƒç´ ï¼Œå»é™¤ç©ºé—´å†—ä½™</li>
<li><strong>å¸§é—´é¢„æµ‹(Inter Prediction)</strong> - P/B å¸§å‚è€ƒå…¶ä»–å¸§ï¼Œåªå­˜å‚¨å·®å¼‚(è¿åŠ¨çŸ¢é‡ + æ®‹å·®)</li>
<li><strong>å˜æ¢ç¼–ç (DCT)</strong> - å°†åƒç´ æ•°æ®è½¬æ¢ä¸ºé¢‘åŸŸï¼Œé«˜é¢‘åˆ†é‡(ç»†èŠ‚)å¯ä»¥é‡åŒ–ä¸¢å¼ƒ</li>
<li><strong>ç†µç¼–ç (CABAC/CAVLC)</strong> - å¯¹é‡åŒ–åçš„æ•°æ®è¿›è¡Œæ— æŸå‹ç¼©ï¼Œè¿›ä¸€æ­¥å‡å°ä½“ç§¯</li>
</ol>
<p><strong>ç¼–ç æ¡£æ¬¡(Profile)ï¼š</strong></p>
<ul>
<li><strong>Baseline</strong> - ä½å¤æ‚åº¦ï¼Œé€‚åˆç§»åŠ¨è®¾å¤‡ï¼Œä¸æ”¯æŒ B å¸§</li>
<li><strong>Main</strong> - ä¸­ç­‰å¤æ‚åº¦ï¼Œæ”¯æŒ B å¸§ï¼Œé€‚åˆå¤§å¤šæ•°åœºæ™¯</li>
<li><strong>High</strong> - é«˜å‹ç¼©ç‡ï¼Œæ”¯æŒ 8Ã—8 å˜æ¢ï¼Œé€‚åˆé«˜æ¸…è§†é¢‘</li>
</ul>
<p><strong>æµè§ˆå™¨æ”¯æŒï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ£€æµ‹ H.264 æ”¯æŒ</span>
<span class="hljs-keyword">const</span> video = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"video"</span>);
<span class="hljs-keyword">const</span> canPlay = video.<span class="hljs-title function_">canPlayType</span>(<span class="hljs-string">'video/mp4; codecs="avc1.42E01E"'</span>);
<span class="hljs-comment">// 'probably' - å®Œå…¨æ”¯æŒ, 'maybe' - å¯èƒ½æ”¯æŒ, '' - ä¸æ”¯æŒ</span>
</code></pre>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>å¹¿æ³›åˆ†å‘</strong>ï¼šéœ€è¦æœ€å¤§å…¼å®¹æ€§æ—¶é¦–é€‰ï¼Œæ‰€æœ‰å¹³å°ç¡¬ä»¶è§£ç </li>
<li><strong>å®æ—¶é€šä¿¡</strong>ï¼šWebRTC é»˜è®¤ç¼–ç ï¼Œç¡¬ä»¶ç¼–è§£ç é™ä½åŠŸè€—</li>
<li><strong>æµåª’ä½“ç›´æ’­</strong>ï¼šHLS/DASH ä¸»æµç¼–ç ï¼ŒCDN ç¼“å­˜å‹å¥½</li>
</ul>
<p><strong>H.265/HEVC - é«˜æ•ˆä½†æˆæƒå¤æ‚</strong></p>
<p>H.265(High Efficiency Video Coding)åœ¨ç›¸åŒç”»è´¨ä¸‹ç ç‡å‡åŠï¼Œä½†ä¸“åˆ©æˆæƒè´¹ç”¨å¤æ‚ï¼Œæµè§ˆå™¨æ”¯æŒæœ‰é™ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<p>ç›¸æ¯” H.264 çš„æ”¹è¿›ï¼š</p>
<ol>
<li><strong>æ›´å¤§çš„ç¼–ç å—</strong> - æ”¯æŒæœ€å¤§ 64Ã—64 CTU(Coding Tree Unit)ï¼Œæ›´é€‚åˆé«˜åˆ†è¾¨ç‡</li>
<li><strong>æ›´å¤šé¢„æµ‹æ¨¡å¼</strong> - 35 ç§å¸§å†…é¢„æµ‹æ–¹å‘(H.264 ä»… 9 ç§)</li>
<li><strong>æ›´çµæ´»çš„å˜æ¢</strong> - æ”¯æŒ 4Ã—4 åˆ° 32Ã—32 çš„å¤šç§å˜æ¢å°ºå¯¸</li>
<li><strong>å¹¶è¡Œå¤„ç†ä¼˜åŒ–</strong> - Tileã€WPP ç­‰æŠ€æœ¯æé«˜ç¼–ç å¹¶è¡Œåº¦</li>
</ol>
<p><strong>æµè§ˆå™¨æ”¯æŒï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Safari(macOS/iOS)å’Œ Edge æ”¯æŒï¼ŒChrome/Firefox éœ€ç¡¬ä»¶æ”¯æŒ</span>
video.<span class="hljs-title function_">canPlayType</span>(<span class="hljs-string">'video/mp4; codecs="hev1.1.6.L120.90"'</span>);
</code></pre>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>4K/8K è§†é¢‘</strong>ï¼šé«˜åˆ†è¾¨ç‡ä¸‹å‹ç¼©ä¼˜åŠ¿æ˜æ˜¾ï¼Œå‡å°‘å¸¦å®½æˆæœ¬</li>
<li><strong>ä¸“ä¸šåˆ¶ä½œ</strong>ï¼šåæœŸåˆ¶ä½œä¿ç•™æ›´å¤šç»†èŠ‚ï¼Œå‡å°‘å­˜å‚¨æˆæœ¬</li>
<li><strong>Apple ç”Ÿæ€</strong>ï¼šiOS/macOS å…¨å¹³å°ç¡¬ä»¶æ”¯æŒ</li>
</ul>
<p><strong>VP9 - Google å¼€æºç¼–ç </strong></p>
<p>VP9 æ˜¯ Google å¼€å‘çš„å¼€æºç¼–ç æ ¼å¼ï¼Œå‹ç¼©æ•ˆç‡æ¥è¿‘ H.265ï¼ŒYouTube å¤§é‡ä½¿ç”¨ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<ol>
<li><strong>è¶…çº§å—(Superblock)</strong> - æœ€å¤§æ”¯æŒ 64Ã—64 å—å¤§å°</li>
<li><strong>è‡ªé€‚åº”ç¯è·¯æ»¤æ³¢</strong> - å‡å°‘æ–¹å—æ•ˆåº”ï¼Œæå‡ä¸»è§‚ç”»è´¨</li>
<li><strong>10bit è‰²æ·±</strong> - æ”¯æŒ HDR è§†é¢‘</li>
<li><strong>å¹¶è¡Œç¼–ç </strong> - æ”¯æŒ Tile å¹¶è¡Œï¼Œæé«˜ç¼–ç é€Ÿåº¦</li>
</ol>
<p><strong>æµè§ˆå™¨æ”¯æŒï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Chrome/Firefox/Edge åŸç”Ÿæ”¯æŒ</span>
video.<span class="hljs-title function_">canPlayType</span>(<span class="hljs-string">'video/webm; codecs="vp9"'</span>);
</code></pre>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>YouTube/Netflix</strong>ï¼šä¸»æµæµåª’ä½“å¹³å°ä½¿ç”¨ï¼Œå‡å°‘ CDN æˆæœ¬</li>
<li><strong>å¼€æºé¡¹ç›®</strong>ï¼šæ— ä¸“åˆ©è´¹ç”¨ï¼Œé€‚åˆå¼€æºåº”ç”¨</li>
<li><strong>WebM å®¹å™¨</strong>ï¼šä¸ WebM æ­é…ï¼Œå®Œå…¨å¼€æºæ ˆ</li>
</ul>
<p><strong>AV1 - ä¸‹ä¸€ä»£å¼€æºç¼–ç </strong></p>
<p>AV1(AOMedia Video 1)æ˜¯ç”± AOMedia è”ç›Ÿ(Googleã€Mozillaã€Netflix ç­‰)å¼€å‘çš„å…è´¹å¼€æºç¼–ç æ ¼å¼ï¼Œå‹ç¼©æ•ˆç‡è¶…è¶Š H.265ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<ol>
<li><strong>æ›´å¤æ‚çš„é¢„æµ‹</strong> - å¸§å†…é¢„æµ‹æ”¯æŒ 71 ç§æ¨¡å¼</li>
<li><strong>å·ç§¯ç¥ç»ç½‘ç»œæ»¤æ³¢</strong> - AI è¾…åŠ©å»å—ã€å»å™ª</li>
<li><strong>å…¨å±€è¿åŠ¨è¡¥å¿</strong> - å¤„ç†æ‘„åƒæœºè¿åŠ¨</li>
<li><strong>è¶…åˆ†è¾¨ç‡</strong> - è§£ç ç«¯æ”¾å¤§ç”»é¢ï¼Œé™ä½ä¼ è¾“ç ç‡</li>
</ol>
<p><strong>æµè§ˆå™¨æ”¯æŒï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Chrome 90+ã€Firefox 67+ã€Edge 90+ æ”¯æŒ</span>
video.<span class="hljs-title function_">canPlayType</span>(<span class="hljs-string">'video/mp4; codecs="av01.0.05M.08"'</span>);
</code></pre>
<p><strong>æŒ‘æˆ˜ï¼š</strong></p>
<ul>
<li><strong>ç¼–ç æ…¢</strong> - ç¼–ç å¤æ‚åº¦æ˜¯ H.264 çš„ 100 å€+</li>
<li><strong>ç¡¬ä»¶æ”¯æŒä¸è¶³</strong> - ç¡¬ä»¶ç¼–è§£ç å™¨æ™®åŠè¾ƒæ…¢</li>
</ul>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>æµåª’ä½“ä¼˜åŒ–</strong>ï¼šNetflixã€YouTube é€æ­¥è¿ç§»ï¼ŒèŠ‚çœ 30-40% å¸¦å®½</li>
<li><strong>å­˜æ¡£å‹ç¼©</strong>ï¼šé•¿æœŸå­˜å‚¨è§†é¢‘ï¼Œç©ºé—´èŠ‚çœæ˜¾è‘—</li>
<li><strong>æœªæ¥æ ‡å‡†</strong>ï¼šå…ä¸“åˆ©è´¹ï¼Œé•¿æœŸæ›¿ä»£ H.264</li>
</ul>
<h3 data-id="heading-33">éŸ³é¢‘ç¼–ç æ ¼å¼</h3>
<p>éŸ³é¢‘ç¼–ç é€šè¿‡å¿ƒç†å£°å­¦æ¨¡å‹å»é™¤äººè€³ä¸æ•æ„Ÿçš„é¢‘ç‡ï¼Œå®ç° 10:1 çš„å‹ç¼©æ¯”ã€‚</p>
<p><strong>ä¸»æµç¼–ç æ ¼å¼å¯¹æ¯”ï¼š</strong></p>













































<table><thead><tr><th>ç¼–ç æ ¼å¼</th><th>å¼€å‘è€…</th><th>å‹ç¼©æ•ˆç‡</th><th>å»¶è¿Ÿ</th><th>æµè§ˆå™¨æ”¯æŒ</th><th>ä¸“åˆ©/æˆæƒ</th></tr></thead><tbody><tr><td>MP3</td><td>Fraunhofer</td><td>åŸºå‡†(1x)</td><td>~50ms</td><td>å…¨å¹³å°</td><td>ä¸“åˆ©å·²è¿‡æœŸ</td></tr><tr><td>AAC</td><td>MPEG</td><td>1.3x MP3</td><td>~50ms</td><td>å…¨å¹³å°</td><td>ä¸“åˆ©(å…è´¹ä¸Šé™)</td></tr><tr><td>Opus</td><td>Xiph/IETF</td><td>1.5x MP3</td><td>5-66ms</td><td>ç°ä»£æµè§ˆå™¨</td><td>å…è´¹å¼€æº</td></tr><tr><td>Vorbis</td><td>Xiph</td><td>1.2x MP3</td><td>~50ms</td><td>Chrome/Firefox</td><td>å…è´¹å¼€æº</td></tr></tbody></table>
<p><strong>AAC - æœ€å¹¿æ³›çš„éŸ³é¢‘ç¼–ç </strong></p>
<p>AAC(Advanced Audio Coding)æ˜¯ MP3 çš„ç»§ä»»è€…ï¼Œåœ¨ç›¸åŒç ç‡ä¸‹éŸ³è´¨æ›´å¥½ï¼Œæ˜¯ MP4 å®¹å™¨çš„æ ‡å‡†éŸ³é¢‘ç¼–ç ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<ol>
<li><strong>æ”¹è¿›çš„æ»¤æ³¢å™¨ç»„</strong> - æ›´ç²¾ç¡®çš„é¢‘åŸŸåˆ†è§£</li>
<li><strong>æ—¶åŸŸå™ªå£°æ•´å½¢(TNS)</strong> - å¤„ç†ç¬æ€ä¿¡å·(å¦‚æ‰“å‡»ä¹)</li>
<li><strong>è”åˆç«‹ä½“å£°ç¼–ç </strong> - æ›´é«˜æ•ˆçš„åŒå£°é“ç¼–ç </li>
<li><strong>æ›´çµæ´»çš„ç ç‡æ§åˆ¶</strong> - VBR(å¯å˜ç ç‡)æ›´å¥½åœ°é€‚åº”å¤æ‚åº¦</li>
</ol>
<p><strong>æ¡£æ¬¡(Profile)ï¼š</strong></p>
<ul>
<li><strong>AAC-LC</strong> - ä½å¤æ‚åº¦ï¼Œé€šç”¨åœºæ™¯</li>
<li><strong>HE-AAC</strong> - é«˜æ•ˆï¼Œä½ç ç‡è¯­éŸ³/éŸ³ä¹</li>
<li><strong>HE-AACv2</strong> - è¶…ä½ç ç‡ï¼Œé€‚åˆæµåª’ä½“</li>
</ul>
<p><strong>æµè§ˆå™¨æ”¯æŒï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">audio.<span class="hljs-title function_">canPlayType</span>(<span class="hljs-string">'audio/mp4; codecs="mp4a.40.2"'</span>); <span class="hljs-comment">// AAC-LC</span>
</code></pre>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>æµåª’ä½“éŸ³é¢‘</strong>ï¼šYouTubeã€Spotify æ ‡å‡†éŸ³é¢‘ç¼–ç </li>
<li><strong>ç§»åŠ¨è®¾å¤‡</strong>ï¼šç¡¬ä»¶ç¼–è§£ç ï¼Œä½åŠŸè€—</li>
<li><strong>MP4 è§†é¢‘</strong>ï¼šæ ‡é…éŸ³é¢‘è½¨é“</li>
</ul>
<p><strong>Opus - ä½å»¶è¿Ÿé«˜è´¨é‡</strong></p>
<p>Opus æ˜¯ä¸ºå®æ—¶é€šä¿¡å’Œæµåª’ä½“è®¾è®¡çš„ç¼–ç æ ¼å¼ï¼Œå»¶è¿Ÿä½è‡³ 5msï¼Œå‹ç¼©æ•ˆç‡è¶…è¶Š AACã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<p>ç»“åˆä¸¤ç§ç¼–ç å™¨ï¼š</p>
<ol>
<li><strong>SILK</strong> - å¤„ç†è¯­éŸ³(ä½é¢‘)ï¼ŒåŸºäºçº¿æ€§é¢„æµ‹</li>
<li><strong>CELT</strong> - å¤„ç†éŸ³ä¹(å…¨é¢‘)ï¼ŒåŸºäº MDCT å˜æ¢</li>
<li><strong>è‡ªé€‚åº”åˆ‡æ¢</strong> - æ ¹æ®å†…å®¹ç‰¹æ€§åŠ¨æ€é€‰æ‹©ç¼–ç å™¨</li>
</ol>
<p><strong>ç ç‡èŒƒå›´ï¼š</strong> 6 kbps(çª„å¸¦è¯­éŸ³) åˆ° 510 kbps(å…¨é¢‘ç«‹ä½“å£°)</p>
<p><strong>æµè§ˆå™¨æ”¯æŒï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">audio.<span class="hljs-title function_">canPlayType</span>(<span class="hljs-string">'audio/webm; codecs="opus"'</span>);
</code></pre>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>WebRTC éŸ³é¢‘</strong>ï¼šé»˜è®¤éŸ³é¢‘ç¼–ç ï¼Œä½å»¶è¿Ÿé«˜è´¨é‡</li>
<li><strong>æ¸¸æˆè¯­éŸ³</strong>ï¼š5-10ms å»¶è¿Ÿï¼Œå®æ—¶äº’åŠ¨æµç•…</li>
<li><strong>æ’­å®¢æµåª’ä½“</strong>ï¼šä½ç ç‡é«˜è´¨é‡ï¼ŒèŠ‚çœå¸¦å®½</li>
</ul>
<h3 data-id="heading-34">å®¹å™¨æ ¼å¼</h3>
<p>å®¹å™¨æ ¼å¼è´Ÿè´£å°†éŸ³é¢‘æµã€è§†é¢‘æµã€å­—å¹•ã€å…ƒæ•°æ®å°è£…åœ¨ä¸€èµ·ï¼Œå¹¶è®°å½•æ—¶é—´æˆ³ã€ç´¢å¼•ä¿¡æ¯ã€‚</p>
<p><strong>ä¸»æµå®¹å™¨æ ¼å¼å¯¹æ¯”ï¼š</strong></p>















































<table><thead><tr><th>å®¹å™¨æ ¼å¼</th><th>å¸¸è§ç¼–ç </th><th>æµå¼æ”¯æŒ</th><th>æµè§ˆå™¨æ”¯æŒ</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td>MP4/fMP4</td><td>H.264+AAC</td><td>fMP4 æ”¯æŒ</td><td>å…¨å¹³å°</td><td>é€šç”¨ã€ç´¢å¼•åœ¨å°¾éƒ¨</td></tr><tr><td>WebM</td><td>VP8/VP9+Opus</td><td>æ”¯æŒ</td><td>Chrome/Firefox</td><td>å¼€æºã€æµå¼å‹å¥½</td></tr><tr><td>TS</td><td>H.264+AAC</td><td>æ”¯æŒ</td><td>MSE è§£æ</td><td>HLS æ ‡å‡†ã€å®¹é”™æ€§å¥½</td></tr><tr><td>MKV</td><td>ä»»æ„</td><td>æ”¯æŒ</td><td>éœ€è½¬æ¢</td><td>åŠŸèƒ½æœ€å¼ºã€å¼€æº</td></tr><tr><td>FLV</td><td>H.264+AAC</td><td>æ”¯æŒ</td><td>éœ€ flv.js</td><td>ç®€å•ã€ç›´æ’­å¸¸ç”¨</td></tr></tbody></table>
<p><strong>MP4 ä¸ fMP4</strong></p>
<p>MP4(MPEG-4 Part 14)æ˜¯æœ€é€šç”¨çš„å®¹å™¨æ ¼å¼ï¼ŒfMP4(Fragmented MP4)æ˜¯ä¸ºæµåª’ä½“ä¼˜åŒ–çš„å˜ä½“ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<p><strong>ä¼ ç»Ÿ MP4 ç»“æ„ï¼š</strong></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[ftyp]</span><span class="hljs-selector-attr">[mdat(è§†é¢‘æ•°æ®)]</span><span class="hljs-selector-attr">[moov(ç´¢å¼•)]</span>
</code></pre>
<ul>
<li><strong>moov box</strong> åœ¨æ–‡ä»¶æœ«å°¾ï¼Œè®°å½•æ‰€æœ‰å¸§çš„ä½ç½®å’Œæ—¶é—´æˆ³</li>
<li>å¿…é¡»å®Œæ•´ä¸‹è½½æ‰èƒ½ seekï¼Œä¸é€‚åˆæµåª’ä½“</li>
</ul>
<p><strong>fMP4(Fragmented MP4)ç»“æ„ï¼š</strong></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[ftyp]</span><span class="hljs-selector-attr">[moov(åˆå§‹åŒ–)]</span><span class="hljs-selector-attr">[moof(ç‰‡æ®µç´¢å¼•)]</span><span class="hljs-selector-attr">[mdat(ç‰‡æ®µæ•°æ®)]</span><span class="hljs-selector-attr">[moof]</span><span class="hljs-selector-attr">[mdat]</span>...
</code></pre>
<ul>
<li><strong>moov</strong> æå‰ï¼ŒåªåŒ…å«åˆå§‹åŒ–ä¿¡æ¯</li>
<li>æ¯ä¸ªç‰‡æ®µç‹¬ç«‹ï¼Œæ”¯æŒæµå¼æ’­æ”¾å’Œ DASH</li>
</ul>
<p><strong>æµè§ˆå™¨ä½¿ç”¨ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// MP4 ç›´æ¥æ’­æ”¾</span>
video.<span class="hljs-property">src</span> = <span class="hljs-string">"video.mp4"</span>;

<span class="hljs-comment">// fMP4 é€šè¿‡ MSE æ’­æ”¾(DASH)</span>
<span class="hljs-keyword">const</span> mediaSource = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MediaSource</span>();
video.<span class="hljs-property">src</span> = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(mediaSource);
mediaSource.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"sourceopen"</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> sourceBuffer = mediaSource.<span class="hljs-title function_">addSourceBuffer</span>(<span class="hljs-string">'video/mp4; codecs="avc1.42E01E,mp4a.40.2"'</span>);
  sourceBuffer.<span class="hljs-title function_">appendBuffer</span>(fmp4Segment);
});
</code></pre>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>MP4</strong>ï¼šç‚¹æ’­è§†é¢‘ã€å½•åˆ¶ä¿å­˜ã€å…¼å®¹æ€§ä¼˜å…ˆ</li>
<li><strong>fMP4</strong>ï¼šDASH æµåª’ä½“ã€ä½å»¶è¿Ÿç›´æ’­</li>
</ul>
<p><strong>WebM</strong></p>
<p>WebM æ˜¯ Google æ¨å‡ºçš„å¼€æºå®¹å™¨æ ¼å¼ï¼Œé…åˆ VP8/VP9 ç¼–ç ä½¿ç”¨ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<p>åŸºäº Matroska(MKV)çš„å­é›†ï¼š</p>
<ul>
<li>ä»…æ”¯æŒ VP8/VP9 è§†é¢‘ + Vorbis/Opus éŸ³é¢‘</li>
<li>æµå¼å‹å¥½ï¼Œæ— éœ€å®Œæ•´æ–‡ä»¶å³å¯å¼€å§‹æ’­æ”¾</li>
<li>æ”¯æŒè‡ªé€‚åº”æµ(WebM DASH)</li>
</ul>
<p><strong>æµè§ˆå™¨ä½¿ç”¨ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">video.<span class="hljs-property">src</span> = <span class="hljs-string">"video.webm"</span>;
video.<span class="hljs-title function_">canPlayType</span>(<span class="hljs-string">'video/webm; codecs="vp9,opus"'</span>);
</code></pre>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>å¼€æºé¡¹ç›®</strong>ï¼šå®Œå…¨å…è´¹ï¼Œæ— ä¸“åˆ©é™åˆ¶</li>
<li><strong>å±å¹•å½•åˆ¶</strong>ï¼šMediaRecorder API é»˜è®¤è¾“å‡ºæ ¼å¼</li>
<li><strong>Chrome ä¼˜åŒ–</strong>ï¼šChrome åŸç”Ÿæ”¯æŒï¼Œæ€§èƒ½æœ€ä½³</li>
</ul>
<p><strong>TS(MPEG Transport Stream)</strong></p>
<p>TS æ˜¯ä¸ºå¹¿æ’­ç”µè§†è®¾è®¡çš„å®¹å™¨æ ¼å¼ï¼Œå®¹é”™æ€§å¼ºï¼ŒHLS åè®®çš„æ ‡å‡†å®¹å™¨ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<ol>
<li><strong>å›ºå®šé•¿åº¦åŒ…(188 å­—èŠ‚)</strong> - æ¯ä¸ªåŒ…ç‹¬ç«‹ï¼Œä¸¢åŒ…ä¸å½±å“åç»­æ•°æ®</li>
<li><strong>æ— å…¨å±€ç´¢å¼•</strong> - æ”¯æŒä»ä»»æ„ä½ç½®å¼€å§‹æ’­æ”¾</li>
<li><strong>åŒæ­¥å­—èŠ‚(0x47)</strong> - å¿«é€Ÿå®šä½åŒ…è¾¹ç•Œ</li>
<li><strong>å¤šè·¯å¤ç”¨</strong> - éŸ³è§†é¢‘äº¤ç»‡ï¼Œæ˜“äºå®æ—¶ä¼ è¾“</li>
</ol>
<p><strong>æµè§ˆå™¨ä½¿ç”¨ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é€šè¿‡ MSE è§£æ TS(éœ€åº“å¦‚ hls.js)</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Hls</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"hls.js"</span>;
<span class="hljs-keyword">const</span> hls = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hls</span>();
hls.<span class="hljs-title function_">loadSource</span>(<span class="hljs-string">"stream.m3u8"</span>); <span class="hljs-comment">// HLS ç´¢å¼•ï¼ŒæŒ‡å‘ .ts ç‰‡æ®µ</span>
hls.<span class="hljs-title function_">attachMedia</span>(video);
</code></pre>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>HLS ç›´æ’­</strong>ï¼šApple HLS åè®®æ ‡å‡†å®¹å™¨</li>
<li><strong>æ•°å­—ç”µè§†</strong>ï¼šIPTVã€DVB å¹¿æ’­æ ‡å‡†</li>
<li><strong>å¼±ç½‘ç¯å¢ƒ</strong>ï¼šå®¹é”™æ€§å¼ºï¼Œéƒ¨åˆ†ä¸¢åŒ…ä¸å½±å“æ’­æ”¾</li>
</ul>
<h3 data-id="heading-35">ç¼–ç å‚æ•°ä¸è´¨é‡æ§åˆ¶</h3>
<p>ç¼–ç å‚æ•°ç›´æ¥å½±å“æ–‡ä»¶å¤§å°ã€ç”»è´¨å’Œå…¼å®¹æ€§ã€‚</p>
<p><strong>å…³é”®å‚æ•°ï¼š</strong></p>
<ol>
<li>
<p><strong>ç ç‡(Bitrate)</strong> - æ¯ç§’æ•°æ®é‡ï¼Œç›´æ¥å†³å®šæ–‡ä»¶å¤§å°å’Œç”»è´¨</p>
<ul>
<li>1080p H.264: 3-8 Mbps(é«˜è´¨é‡), 1-3 Mbps(æµåª’ä½“)</li>
<li>720p H.264: 1.5-4 Mbps</li>
<li>CBR(å›ºå®šç ç‡) vs VBR(å¯å˜ç ç‡)ï¼šVBR åŒä½“ç§¯ä¸‹ç”»è´¨æ›´å¥½</li>
</ul>
</li>
<li>
<p><strong>åˆ†è¾¨ç‡(Resolution)</strong> - ç”»é¢å°ºå¯¸</p>
<ul>
<li>å¸¸è§ï¼š480p(640Ã—480)ã€720p(1280Ã—720)ã€1080p(1920Ã—1080)ã€4K(3840Ã—2160)</li>
<li>ç½‘ç»œé€‚é…ï¼šå‡†å¤‡å¤šä¸ªåˆ†è¾¨ç‡å®ç° ABR(è‡ªé€‚åº”ç ç‡)</li>
</ul>
</li>
<li>
<p><strong>å¸§ç‡(Frame Rate)</strong> - æ¯ç§’å¸§æ•°</p>
<ul>
<li>ç”µå½±ï¼š24fpsï¼Œç½‘ç»œè§†é¢‘ï¼š25/30fpsï¼Œæ¸¸æˆ/ä½“è‚²ï¼š60fps</li>
<li>å¸§ç‡è¶Šé«˜è¶Šæµç•…ï¼Œä½†æ–‡ä»¶æ›´å¤§</li>
</ul>
</li>
<li>
<p><strong>GOP(Group of Pictures)</strong> - å…³é”®å¸§é—´éš”</p>
<ul>
<li>I å¸§ï¼šå®Œæ•´å›¾åƒï¼Œä½“ç§¯å¤§</li>
<li>P å¸§ï¼šå‚è€ƒå‰ä¸€å¸§ï¼Œä½“ç§¯ä¸­</li>
<li>B å¸§ï¼šå‚è€ƒå‰åå¸§ï¼Œä½“ç§¯å°</li>
<li>GOP è¶Šå¤§å‹ç¼©ç‡è¶Šé«˜ï¼Œä½† seek æ…¢(éœ€å®šä½åˆ°æœ€è¿‘çš„ I å¸§)</li>
<li>å…¸å‹å€¼ï¼šGOP=60(2 ç§’ä¸€ä¸ª I å¸§ @ 30fps)</li>
</ul>
</li>
</ol>
<p><strong>è´¨é‡ä¸å¤§å°å¹³è¡¡ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// FFmpeg ç¼–ç ç¤ºä¾‹</span>
<span class="hljs-comment">// é«˜è´¨é‡(å¤§æ–‡ä»¶)</span>
ffmpeg -i input.<span class="hljs-property">mp4</span> -<span class="hljs-attr">c</span>:v libx264 -crf <span class="hljs-number">18</span> -preset slow output.<span class="hljs-property">mp4</span>

<span class="hljs-comment">// æµåª’ä½“ä¼˜åŒ–(ä¸­ç­‰è´¨é‡)</span>
ffmpeg -i input.<span class="hljs-property">mp4</span> -<span class="hljs-attr">c</span>:v libx264 -crf <span class="hljs-number">23</span> -preset medium -maxrate 3M -bufsize 6M output.<span class="hljs-property">mp4</span>

<span class="hljs-comment">// ä½ç ç‡(å°æ–‡ä»¶)</span>
ffmpeg -i input.<span class="hljs-property">mp4</span> -<span class="hljs-attr">c</span>:v libx264 -crf <span class="hljs-number">28</span> -preset fast output.<span class="hljs-property">mp4</span>
</code></pre>
<p><strong>CRF(Constant Rate Factor)ï¼š</strong></p>
<ul>
<li>0-51ï¼Œå€¼è¶Šå°è´¨é‡è¶Šé«˜</li>
<li>æ¨èï¼š18(è§†è§‰æ— æŸ)ã€23(é«˜è´¨é‡)ã€28(å¯æ¥å—)</li>
</ul>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>é«˜è´¨é‡å­˜æ¡£</strong>ï¼šCRF 18ï¼Œæ…¢é€Ÿé¢„è®¾ï¼Œä¿ç•™ç»†èŠ‚</li>
<li><strong>æµåª’ä½“åˆ†å‘</strong>ï¼šCRF 23ï¼Œå¤šç ç‡ï¼Œè‡ªé€‚åº”æ’­æ”¾</li>
<li><strong>ç¤¾äº¤åª’ä½“</strong>ï¼šCRF 28ï¼Œå¿«é€Ÿç¼–ç ï¼Œæ–‡ä»¶å°</li>
</ul>
<h2 data-id="heading-36">å‰ç«¯å¤šåª’ä½“åº“ä¸æ¡†æ¶</h2>
<p>è™½ç„¶æµè§ˆå™¨æä¾›äº†åŸç”Ÿçš„å¤šåª’ä½“ APIï¼Œä½†å®é™…å¼€å‘ä¸­ç›´æ¥ä½¿ç”¨åŸç”Ÿ API å­˜åœ¨æµè§ˆå™¨å…¼å®¹æ€§ã€åè®®è§£æã€UI å®šåˆ¶ç­‰è¯¸å¤šé—®é¢˜ã€‚å¤šåª’ä½“åº“å’Œæ¡†æ¶å°è£…äº†åº•å±‚å¤æ‚æ€§ï¼Œæä¾›å¼€ç®±å³ç”¨çš„è§£å†³æ–¹æ¡ˆã€‚æœ¬ç« ä»‹ç»ä¸»æµçš„æ’­æ”¾å™¨åº“ã€WebRTC åº“ã€éŸ³è§†é¢‘å¤„ç†åº“ï¼Œé‡ç‚¹å¯¹æ¯”å„åº“çš„æŠ€æœ¯å·®å¼‚å’Œé€‚ç”¨åœºæ™¯ã€‚</p>
<h3 data-id="heading-37">è§†é¢‘æ’­æ”¾å™¨åº“</h3>
<p><strong>æ ¸å¿ƒå·®å¼‚ç»´åº¦ï¼š</strong> åè®®æ”¯æŒã€UI å®šåˆ¶èƒ½åŠ›ã€æ’ä»¶ç”Ÿæ€ã€ä½“ç§¯æ€§èƒ½</p>
<p><strong>ä¸»æµæ’­æ”¾å™¨åº“å¯¹æ¯”ï¼š</strong></p>




































































<table><thead><tr><th>åº“</th><th>å®šä½</th><th>åè®®æ”¯æŒ</th><th>UI</th><th>ä½“ç§¯</th><th>æ’ä»¶ç”Ÿæ€</th><th>å…¸å‹åœºæ™¯</th></tr></thead><tbody><tr><td><strong>Video.js</strong></td><td>é€šç”¨æ’­æ”¾å™¨æ¡†æ¶</td><td>éœ€æ’ä»¶æ‰©å±•</td><td>å®Œæ•´ UI</td><td>~250KB</td><td>ä¸°å¯Œ</td><td>é€šç”¨è§†é¢‘ç½‘ç«™</td></tr><tr><td><strong>hls.js</strong></td><td>HLS ä¸“ç”¨è§£æå™¨</td><td>HLS</td><td>æ—  UI</td><td>~100KB</td><td>æ— </td><td>è½»é‡ HLS æ’­æ”¾</td></tr><tr><td><strong>Shaka Player</strong></td><td>ä¸“ä¸šæµåª’ä½“</td><td>DASH + HLS</td><td>åŸºç¡€ UI</td><td>~300KB</td><td>å°‘é‡</td><td>DRM å•†ä¸šå¹³å°</td></tr><tr><td><strong>DPlayer</strong></td><td>å¼¹å¹•æ’­æ”¾å™¨</td><td>éœ€æ’ä»¶</td><td>ç²¾ç¾ UI</td><td>~200KB</td><td>å°‘é‡</td><td>å¼¹å¹•è§†é¢‘ç½‘ç«™</td></tr><tr><td><strong>flv.js</strong></td><td>FLV ç›´æ’­ä¸“ç”¨</td><td>FLV</td><td>æ—  UI</td><td>~200KB</td><td>æ— </td><td>ä½å»¶è¿Ÿç›´æ’­</td></tr><tr><td><strong>xgplayer</strong></td><td>è¥¿ç“œæ’­æ”¾å™¨</td><td>å¯æ‰©å±•</td><td>ç°ä»£ UI</td><td>~150KB</td><td>ä¸­ç­‰</td><td>ç§»åŠ¨ç«¯è§†é¢‘</td></tr></tbody></table>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvideojs%2Fvideo.js" target="_blank" title="https://github.com/videojs/video.js" ref="nofollow noopener noreferrer">Video.js</a></strong> - æœ€æµè¡Œçš„é€šç”¨æ’­æ”¾å™¨ï¼Œæ’ä»¶æ¶æ„æ”¯æŒåŠŸèƒ½æ‰©å±•ï¼Œå…¼å®¹æ€§å¥½è¦†ç›–æ—§æµè§ˆå™¨ã€‚æ ¸å¿ƒæœ€å°åŒ–ï¼ŒåŠŸèƒ½é€šè¿‡æ’ä»¶å®ç°(HLSã€DASHã€å¹¿å‘Šã€å­—å¹•ç­‰)ã€‚ç¤¾åŒºæ´»è·ƒï¼Œç¬¬ä¸‰æ–¹æ’ä»¶ä¸°å¯Œã€‚</p>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvideo-dev%2Fhls.js" target="_blank" title="https://github.com/video-dev/hls.js" ref="nofollow noopener noreferrer">hls.js</a></strong> - çº¯ HLS è§£æå™¨ï¼Œä¸æä¾› UIï¼Œä¸“æ³¨åè®®è§£æå’Œ ABR é€»è¾‘ã€‚ä½“ç§¯å°å·§é€‚åˆæ€§èƒ½æ•æ„Ÿåœºæ™¯ï¼Œéœ€è‡ªå·±å®ç°æ’­æ”¾æ§åˆ¶ç•Œé¢ã€‚å†…ç½®è‡ªé€‚åº”ç ç‡ç®—æ³•æˆç†Ÿç¨³å®šã€‚</p>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fshaka-project%2Fshaka-player" target="_blank" title="https://github.com/shaka-project/shaka-player" ref="nofollow noopener noreferrer">Shaka Player</a></strong> - Google å¼€å‘çš„ä¸“ä¸šæµåª’ä½“æ’­æ”¾å™¨ï¼ŒåŒæ—¶æ”¯æŒ DASH å’Œ HLSï¼Œå†…ç½®å®Œæ•´ DRM æ”¯æŒ(Widevine/PlayReady/FairPlay)ã€‚å•†ä¸šçº§è§£å†³æ–¹æ¡ˆï¼Œé€‚åˆä»˜è´¹è§†é¢‘å¹³å°ã€‚</p>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FDIYgod%2FDPlayer" target="_blank" title="https://github.com/DIYgod/DPlayer" ref="nofollow noopener noreferrer">DPlayer</a></strong> - å›½å†…å¼€å‘çš„å¼¹å¹•æ’­æ”¾å™¨ï¼Œæä¾›ç²¾ç¾ UI å’Œå¼¹å¹•åŠŸèƒ½ã€‚æ”¯æŒ HLSã€FLVã€DASH(é€šè¿‡æ’ä»¶)ï¼ŒAPI ç®€æ´æ˜“ç”¨ã€‚é€‚åˆéœ€è¦å¼¹å¹•åŠŸèƒ½çš„è§†é¢‘ç½‘ç«™ã€‚</p>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fbilibili%2Fflv.js" target="_blank" title="https://github.com/bilibili/flv.js" ref="nofollow noopener noreferrer">flv.js</a></strong> - B ç«™å¼€æºçš„ FLV è§£æå™¨ï¼Œä¸“é—¨ç”¨äºä½å»¶è¿Ÿç›´æ’­(3-10 ç§’å»¶è¿Ÿ)ã€‚ä»…æ”¯æŒ FLV å®¹å™¨ï¼Œä¸æ”¯æŒå…¶ä»–æ ¼å¼ã€‚é’ˆå¯¹ç›´æ’­åœºæ™¯ä¼˜åŒ–ç¼“å†²ç­–ç•¥ã€‚</p>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fbytedance%2Fxgplayer" target="_blank" title="https://github.com/bytedance/xgplayer" ref="nofollow noopener noreferrer">xgplayer</a></strong> - å­—èŠ‚è·³åŠ¨å¼€æºçš„æ’­æ”¾å™¨ï¼Œæä¾›ç°ä»£åŒ– UI å’Œç§»åŠ¨ç«¯ä¼˜åŒ–ã€‚æ’ä»¶åŒ–æ¶æ„ï¼Œæ”¯æŒ HLSã€FLVã€DASHã€‚æ€§èƒ½ä¼˜åŒ–å’Œç§»åŠ¨ç«¯ä½“éªŒè¾ƒå¥½ã€‚</p>
<p><strong>æŠ€æœ¯å·®å¼‚æ€»ç»“ï¼š</strong></p>
<ul>
<li><strong>Video.js</strong>ï¼šæ’ä»¶ç”Ÿæ€æœ€ä¸°å¯Œï¼Œé€‚åˆéœ€è¦å¤§é‡å®šåˆ¶åŠŸèƒ½çš„åœºæ™¯</li>
<li><strong>hls.js/flv.js</strong>ï¼šçº¯è§£æå™¨æ—  UIï¼Œé€‚åˆå·²æœ‰ UI æ¡†æ¶æˆ–éœ€è¦å®Œå…¨è‡ªå®šä¹‰çš„åœºæ™¯</li>
<li><strong>Shaka Player</strong>ï¼šDRM æ”¯æŒæœ€å®Œå–„ï¼Œé€‚åˆå•†ä¸šä»˜è´¹å†…å®¹</li>
<li><strong>DPlayer/xgplayer</strong>ï¼šUI ç²¾ç¾ç°ä»£ï¼Œé€‚åˆå¿«é€Ÿæ­å»ºè§†é¢‘ç½‘ç«™</li>
</ul>
<h3 data-id="heading-38">WebRTC åº“ä¸æ¡†æ¶</h3>
<p><strong>æ ¸å¿ƒå·®å¼‚ç»´åº¦ï¼š</strong> æ¶æ„æ¨¡å¼(P2P/SFU)ã€ä¿¡ä»¤å¤„ç†ã€API å¤æ‚åº¦ã€æ‰©å±•æ€§</p>
<p><strong>å®¢æˆ·ç«¯åº“å¯¹æ¯”ï¼š</strong></p>


















































<table><thead><tr><th>åº“</th><th>æ¶æ„</th><th>ä¿¡ä»¤</th><th>API é£æ ¼</th><th>ä½“ç§¯</th><th>å­¦ä¹ æ›²çº¿</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>simple-peer</strong></td><td>P2P</td><td>éœ€è‡ªå®ç°</td><td>äº‹ä»¶é©±åŠ¨</td><td>~20KB</td><td>ä½</td><td>ç®€å• P2P åº”ç”¨</td></tr><tr><td><strong>PeerJS</strong></td><td>P2P</td><td>æä¾›æ‰˜ç®¡æœåŠ¡</td><td>å›è°ƒé£æ ¼</td><td>~50KB</td><td>ä½</td><td>å¿«é€ŸåŸå‹å¼€å‘</td></tr><tr><td><strong>mediasoup-client</strong></td><td>SFU</td><td>é…åˆæœåŠ¡ç«¯</td><td>Promise</td><td>~200KB</td><td>é«˜</td><td>å¤§è§„æ¨¡ä¼šè®®</td></tr><tr><td><strong>Agora SDK</strong></td><td>å•†ä¸šæ–¹æ¡ˆ</td><td>äº‘æœåŠ¡</td><td>Promise</td><td>~1MB</td><td>ä¸­</td><td>ä¼ä¸šçº§åº”ç”¨</td></tr></tbody></table>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffeross%2Fsimple-peer" target="_blank" title="https://github.com/feross/simple-peer" ref="nofollow noopener noreferrer">simple-peer</a></strong> - æœ€è½»é‡çš„ WebRTC å°è£…ï¼Œå°† RTCPeerConnection ç®€åŒ–ä¸ºäº‹ä»¶é©±åŠ¨ APIã€‚ä¿¡ä»¤äº¤æ¢ç”±å¼€å‘è€…è‡ªè¡Œå®ç°(WebSocket/HTTP ç­‰)ã€‚é€‚åˆå·²æœ‰åç«¯ä¿¡ä»¤æœåŠ¡å™¨çš„åœºæ™¯ï¼Œä»…æ”¯æŒ P2P(1 å¯¹ 1)ã€‚</p>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fpeers%2Fpeerjs" target="_blank" title="https://github.com/peers/peerjs" ref="nofollow noopener noreferrer">PeerJS</a></strong> - æä¾›æ‰˜ç®¡ä¿¡ä»¤æœåŠ¡å™¨çš„ P2P åº“ï¼Œé€šè¿‡å”¯ä¸€ Peer ID æ ‡è¯†ç”¨æˆ·ã€‚é›¶é…ç½®å¿«é€Ÿå¼€å‘ï¼Œé€‚åˆåŸå‹éªŒè¯å’Œå°è§„æ¨¡åº”ç”¨ã€‚å…¬å…±ä¿¡ä»¤æœåŠ¡å™¨å…è´¹ä½†ä¸é€‚åˆç”Ÿäº§ç¯å¢ƒï¼ŒP2P æ¶æ„é™åˆ¶å‚ä¸äººæ•°ã€‚</p>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fversatica%2Fmediasoup-client-aiortc" target="_blank" title="https://github.com/versatica/mediasoup-client-aiortc" ref="nofollow noopener noreferrer">mediasoup-client</a></strong> - mediasoup SFU æœåŠ¡å™¨çš„é…å¥—å®¢æˆ·ç«¯ï¼Œæ”¯æŒå¤§è§„æ¨¡å¤šäººä¼šè®®(æ•°ç™¾äºº)ã€‚SFU æ¶æ„æœåŠ¡å™¨è½¬å‘æµï¼Œæ”¯æŒ Simulcast å¤šè·¯å‘é€ã€‚ç²¾ç»†æ§åˆ¶ç¼–ç å‚æ•°ï¼Œé€‚åˆä¸“ä¸šè§†é¢‘ä¼šè®®äº§å“ï¼Œä½†å­¦ä¹ æ›²çº¿é™¡å³­éœ€è¦éƒ¨ç½²æœåŠ¡å™¨ã€‚</p>
<p><strong>æœåŠ¡ç«¯æ–¹æ¡ˆå¯¹æ¯”ï¼š</strong></p>













































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>æ¶æ„</th><th>è¯­è¨€</th><th>å¹¶å‘èƒ½åŠ›</th><th>éƒ¨ç½²å¤æ‚åº¦</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td><strong>Janus Gateway</strong></td><td>SFU/MCU</td><td>C</td><td>é«˜</td><td>ä¸­</td><td>æ’ä»¶æ¶æ„ã€æ€§èƒ½ä¼˜ç§€</td></tr><tr><td><strong>mediasoup</strong></td><td>SFU</td><td>C++/Node.js</td><td>æé«˜</td><td>é«˜</td><td>Simulcastã€å½•åˆ¶ã€è½¬ç </td></tr><tr><td><strong>Jitsi</strong></td><td>SFU</td><td>Java</td><td>é«˜</td><td>ä½</td><td>ä¸€ä½“åŒ–æ–¹æ¡ˆã€å¼€ç®±å³ç”¨</td></tr><tr><td><strong>Kurento</strong></td><td>MCU</td><td>Java</td><td>ä¸­</td><td>ä¸­</td><td>åª’ä½“å¤„ç†èƒ½åŠ›å¼º</td></tr></tbody></table>
<p><strong>æŠ€æœ¯å·®å¼‚æ€»ç»“ï¼š</strong></p>
<ul>
<li><strong>simple-peer/PeerJS</strong>ï¼šP2P æ¶æ„ï¼Œé€‚åˆ 1 å¯¹ 1 æˆ–å°è§„æ¨¡(2-4 äºº)åœºæ™¯ï¼Œå»¶è¿Ÿæœ€ä½</li>
<li><strong>mediasoup</strong>ï¼šSFU æ¶æ„ï¼Œé€‚åˆå¤§è§„æ¨¡ä¼šè®®(10+ äºº)ï¼ŒæœåŠ¡å™¨è½¬å‘é™ä½å®¢æˆ·ç«¯å‹åŠ›</li>
<li><strong>å•†ä¸šæ–¹æ¡ˆ</strong>ï¼šå£°ç½‘/è…¾è®¯äº‘ç­‰æä¾›å®Œæ•´äº‘æœåŠ¡ï¼Œå…è¿ç»´ä½†æˆæœ¬è¾ƒé«˜</li>
</ul>
<h3 data-id="heading-39">éŸ³é¢‘å¤„ç†åº“</h3>
<p><strong>æ ¸å¿ƒå·®å¼‚ç»´åº¦ï¼š</strong> ä½¿ç”¨åœºæ™¯(æ¸¸æˆ/éŸ³ä¹/åˆ†æ)ã€API å¤æ‚åº¦ã€åŠŸèƒ½æ·±åº¦</p>


















































<table><thead><tr><th>åº“</th><th>å®šä½</th><th>åŸºç¡€æŠ€æœ¯</th><th>æ ¸å¿ƒåŠŸèƒ½</th><th>ä½“ç§¯</th><th>å­¦ä¹ æ›²çº¿</th><th>å…¸å‹åœºæ™¯</th></tr></thead><tbody><tr><td><strong>Tone.js</strong></td><td>éŸ³ä¹åˆ›ä½œæ¡†æ¶</td><td>Web Audio API</td><td>åˆæˆå™¨ã€éŸ³åºå™¨ã€æ•ˆæœå™¨</td><td>~200KB</td><td>é«˜</td><td>DAWã€ç”µå­éŸ³ä¹</td></tr><tr><td><strong>Howler.js</strong></td><td>æ¸¸æˆéŸ³é¢‘åº“</td><td>HTML5 Audio</td><td>æ’­æ”¾æ§åˆ¶ã€ç©ºé—´éŸ³æ•ˆ</td><td>~20KB</td><td>ä½</td><td>æ¸¸æˆéŸ³æ•ˆã€BGM</td></tr><tr><td><strong>WaveSurfer.js</strong></td><td>æ³¢å½¢å¯è§†åŒ–</td><td>Web Audio + Canvas</td><td>æ³¢å½¢ç»˜åˆ¶ã€åŒºåŸŸé€‰æ‹©</td><td>~100KB</td><td>ä¸­</td><td>éŸ³é¢‘ç¼–è¾‘å™¨</td></tr><tr><td><strong>Pizzicato.js</strong></td><td>éŸ³æ•ˆå¤„ç†</td><td>Web Audio API</td><td>éŸ³æ•ˆåº“(æ··å“/å»¶è¿Ÿ)</td><td>~50KB</td><td>ä½</td><td>éŸ³æ•ˆå¢å¼º</td></tr></tbody></table>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTonejs%2FTone.js" target="_blank" title="https://github.com/Tonejs/Tone.js" ref="nofollow noopener noreferrer">Tone.js</a></strong> - ä¸“ä¸šéŸ³ä¹åˆ›ä½œæ¡†æ¶ï¼Œå†…ç½®éŸ³é˜¶ã€èŠ‚å¥ã€å’Œå£°ç­‰éŸ³ä¹æ¦‚å¿µã€‚æä¾› Transport æ—¶é—´è½´å®ç° DAW çº§ç²¾ç¡®æ—¶åºæ§åˆ¶ã€‚é€‚åˆåœ¨çº¿ DAWã€éŸ³ä¹å¯è§†åŒ–ã€ç”µå­éŸ³ä¹åº”ç”¨ï¼Œä½†å­¦ä¹ æ›²çº¿é™¡å³­ã€‚</p>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fgoldfire%2Fhowler.js" target="_blank" title="https://github.com/goldfire/howler.js" ref="nofollow noopener noreferrer">Howler.js</a></strong> - ç®€å•æ˜“ç”¨çš„æ¸¸æˆéŸ³é¢‘åº“ï¼Œè‡ªåŠ¨é™çº§(Web Audio â†’ HTML5 Audio)ä¿è¯å…¼å®¹æ€§ã€‚æä¾›éŸ³æ•ˆæ± ã€é¢„åŠ è½½ã€ç©ºé—´éŸ³é¢‘ç­‰æ¸¸æˆä¼˜åŒ–åŠŸèƒ½ã€‚API ç®€æ´ï¼Œé€‚åˆæ¸¸æˆéŸ³æ•ˆå’ŒèƒŒæ™¯éŸ³ä¹æ’­æ”¾ã€‚</p>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fkatspaugh%2Fwavesurfer.js" target="_blank" title="https://github.com/katspaugh/wavesurfer.js" ref="nofollow noopener noreferrer">WaveSurfer.js</a></strong> - éŸ³é¢‘æ³¢å½¢å¯è§†åŒ–åº“ï¼Œç»˜åˆ¶æ³¢å½¢å›¾å¹¶æ”¯æŒåŒºåŸŸé€‰æ‹©ã€ç¼©æ”¾ã€æ’­æ”¾æ§åˆ¶ã€‚é€‚åˆéŸ³é¢‘ç¼–è¾‘å™¨ã€æ’­å®¢å‰ªè¾‘ã€éŸ³é¢‘åˆ†æå·¥å…·ã€‚</p>
<p><strong>æŠ€æœ¯å·®å¼‚æ€»ç»“ï¼š</strong></p>
<ul>
<li><strong>Tone.js</strong>ï¼šéŸ³ä¹å¯¼å‘ï¼Œå¤æ‚åº¦é«˜ï¼Œé€‚åˆä¸“ä¸šéŸ³ä¹åˆ¶ä½œ</li>
<li><strong>Howler.js</strong>ï¼šæ¸¸æˆå¯¼å‘ï¼Œç®€å•æ˜“ç”¨ï¼Œé€‚åˆéŸ³æ•ˆæ’­æ”¾</li>
<li><strong>WaveSurfer.js</strong>ï¼šå¯è§†åŒ–å¯¼å‘ï¼Œé€‚åˆéŸ³é¢‘ç¼–è¾‘å’Œåˆ†æ</li>
</ul>
<h3 data-id="heading-40">è§†é¢‘å¤„ç†åº“</h3>





































<table><thead><tr><th>åº“</th><th>å®šä½</th><th>æ ¸å¿ƒèƒ½åŠ›</th><th>ä½“ç§¯</th><th>æ€§èƒ½</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>FFmpeg.wasm</strong></td><td>å®Œæ•´è§†é¢‘å¤„ç†</td><td>è½¬ç ã€å‰ªè¾‘ã€æ»¤é•œ</td><td>~25MB</td><td>ä¸­</td><td>æ ¼å¼è½¬æ¢ã€å¤æ‚å¤„ç†</td></tr><tr><td><strong>Remotion</strong></td><td>ç¨‹åºåŒ–è§†é¢‘ç”Ÿæˆ</td><td>React ç»„ä»¶ â†’ è§†é¢‘</td><td>~5MB</td><td>é«˜(æœåŠ¡ç«¯æ¸²æŸ“)</td><td>æ¨¡æ¿è§†é¢‘ç”Ÿæˆ</td></tr><tr><td><strong>fabric.js</strong></td><td>Canvas è§†é¢‘ç¼–è¾‘</td><td>å›¾å±‚ã€æ»¤é•œã€åˆæˆ</td><td>~200KB</td><td>é«˜</td><td>å®æ—¶è§†é¢‘ç¼–è¾‘</td></tr></tbody></table>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fffmpegwasm%2Fffmpeg.wasm" target="_blank" title="https://github.com/ffmpegwasm/ffmpeg.wasm" ref="nofollow noopener noreferrer">FFmpeg.wasm</a></strong> - FFmpeg çš„ WebAssembly ç‰ˆæœ¬ï¼Œæ”¯æŒæ‰€æœ‰ FFmpeg å‘½ä»¤ã€‚åŠŸèƒ½å®Œæ•´ä½†ä½“ç§¯å¤§(~25MB)ï¼Œé¦–æ¬¡åŠ è½½æ…¢ã€‚WASM æ€§èƒ½æ¥è¿‘åŸç”Ÿï¼Œæ¯”çº¯ JS å¿« 5-10 å€ã€‚é€‚åˆæµè§ˆå™¨ç«¯è§†é¢‘è½¬ç ã€æ ¼å¼è½¬æ¢ã€æ·»åŠ æ°´å°ç­‰å¤æ‚æ“ä½œã€‚</p>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fremotion-dev%2Fremotion" target="_blank" title="https://github.com/remotion-dev/remotion" ref="nofollow noopener noreferrer">Remotion</a></strong> - ç”¨ React ç»„ä»¶ç¼–å†™è§†é¢‘ï¼Œæ”¯æŒç¨‹åºåŒ–ç”Ÿæˆã€‚åœ¨æœåŠ¡ç«¯æ¸²æŸ“ä¸ºè§†é¢‘æ–‡ä»¶ï¼Œæ”¯æŒæ¨¡æ¿å˜é‡æ›¿æ¢ã€‚é€‚åˆæ‰¹é‡ç”Ÿæˆè¥é”€è§†é¢‘ã€æ•°æ®å¯è§†åŒ–è§†é¢‘ã€åŠ¨æ€æ¨¡æ¿è§†é¢‘ã€‚</p>
<p><strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffabricjs%2Ffabric.js" target="_blank" title="https://github.com/fabricjs/fabric.js" ref="nofollow noopener noreferrer">fabric.js</a></strong> - Canvas åº“ï¼Œæ”¯æŒå›¾å±‚ã€æ»¤é•œã€å›¾åƒåˆæˆã€‚å¯ç”¨äºå®æ—¶è§†é¢‘ç¼–è¾‘(é€å¸§å¤„ç†)ï¼Œæä¾›ä¸°å¯Œçš„å›¾å½¢ç»˜åˆ¶èƒ½åŠ›ã€‚é€‚åˆè§†é¢‘è´´çº¸ã€æ°´å°ã€æ»¤é•œç­‰å®æ—¶ç¼–è¾‘åœºæ™¯ã€‚</p>
<h2 data-id="heading-41">å®‰å…¨ä¸ç‰ˆæƒä¿æŠ¤</h2>
<p>åœ¨çº¿éŸ³è§†é¢‘å†…å®¹é¢ä¸´ç›—ç‰ˆã€ç›—é“¾ã€éæ³•ä¸‹è½½ç­‰å¨èƒã€‚å®‰å…¨ä¸ç‰ˆæƒä¿æŠ¤æŠ€æœ¯é€šè¿‡å†…å®¹åŠ å¯†ã€æ•°å­—ç‰ˆæƒç®¡ç†(DRM)ã€è®¿é—®æ§åˆ¶ç­‰æ‰‹æ®µï¼Œç¡®ä¿å†…å®¹åªèƒ½è¢«æˆæƒç”¨æˆ·åœ¨åˆæ³•æ¡ä»¶ä¸‹è®¿é—®å’Œæ’­æ”¾ã€‚</p>
<h3 data-id="heading-42">DRM æ•°å­—ç‰ˆæƒç®¡ç†</h3>
<p>DRM(Digital Rights Management)é€šè¿‡åŠ å¯†å†…å®¹å’Œå¯†é’¥ç®¡ç†ï¼Œé˜²æ­¢æœªæˆæƒçš„å¤åˆ¶å’Œä¼ æ’­ã€‚æµè§ˆå™¨é€šè¿‡ EME(Encrypted Media Extensions)æ ‡å‡†æ”¯æŒ DRM æ’­æ”¾ã€‚</p>
<p><strong>ä¸»æµ DRM æ–¹æ¡ˆå¯¹æ¯”ï¼š</strong></p>













































<table><thead><tr><th>DRM æ–¹æ¡ˆ</th><th>å¼€å‘è€…</th><th>å¹³å°æ”¯æŒ</th><th>å®‰å…¨çº§åˆ«</th><th>æˆæƒè´¹ç”¨</th><th>å…¸å‹åº”ç”¨</th></tr></thead><tbody><tr><td><strong>Widevine</strong></td><td>Google</td><td>Chrome/Firefox/Edge/å®‰å“</td><td>L1-L3</td><td>å•†ä¸šæˆæƒ</td><td>YouTube/Netflix</td></tr><tr><td><strong>FairPlay</strong></td><td>Apple</td><td>Safari/iOS/tvOS</td><td>ç¡¬ä»¶çº§</td><td>å•†ä¸šæˆæƒ</td><td>Apple TV+</td></tr><tr><td><strong>PlayReady</strong></td><td>Microsoft</td><td>Edge/Xbox/Windows</td><td>ç¡¬ä»¶çº§</td><td>å•†ä¸šæˆæƒ</td><td>Microsoft ç”Ÿæ€</td></tr><tr><td><strong>ClearKey</strong></td><td>W3C</td><td>æ‰€æœ‰ç°ä»£æµè§ˆå™¨</td><td>è½¯ä»¶çº§</td><td>å…è´¹å¼€æº</td><td>æµ‹è¯•/ä½å®‰å…¨åœºæ™¯</td></tr></tbody></table>
<p><strong>åŸç†ï¼š</strong></p>
<p>DRM ä¿æŠ¤åˆ†ä¸ºä¸‰ä¸ªå…³é”®ç¯èŠ‚ï¼š</p>
<ol>
<li><strong>å†…å®¹åŠ å¯†</strong> - æœåŠ¡å™¨ä½¿ç”¨å¯†é’¥åŠ å¯†è§†é¢‘å†…å®¹ï¼Œç”ŸæˆåŠ å¯†è§†é¢‘æ–‡ä»¶</li>
<li><strong>å¯†é’¥æœåŠ¡å™¨</strong> - å®¢æˆ·ç«¯æ’­æ”¾æ—¶å‘è®¸å¯è¯æœåŠ¡å™¨è¯·æ±‚è§£å¯†å¯†é’¥</li>
<li><strong>è§£å¯†æ’­æ”¾</strong> - æµè§ˆå™¨ CDM(Content Decryption Module)åœ¨æ²™ç®±ä¸­è§£å¯†å¹¶æ’­æ”¾ï¼Œå¯†é’¥ä¸æš´éœ²ç»™ JavaScript</li>
</ol>
<p><strong>Widevine å®‰å…¨çº§åˆ«ï¼š</strong></p>
<ul>
<li><strong>L1(Level 1)</strong> - ç¡¬ä»¶çº§ä¿æŠ¤ï¼Œè§£å¯†å’Œè§£ç åœ¨ TEE(å¯ä¿¡æ‰§è¡Œç¯å¢ƒ)ä¸­è¿›è¡Œï¼Œæœ€é«˜å®‰å…¨</li>
<li><strong>L2</strong> - è§£ç åœ¨ TEEï¼Œä½†è§†é¢‘è§£ç åœ¨éå®‰å…¨åŒºåŸŸ</li>
<li><strong>L3</strong> - çº¯è½¯ä»¶å®ç°ï¼Œæœ€ä½å®‰å…¨ç­‰çº§ï¼Œæ˜“è¢«ç ´è§£</li>
</ul>
<h3 data-id="heading-43">EME - Encrypted Media Extensions</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FEncrypted_Media_Extensions_API" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/API/Encrypted_Media_Extensions_API" ref="nofollow noopener noreferrer">EME</a> æ˜¯ W3C æ ‡å‡†ï¼Œå®šä¹‰äº†æµè§ˆå™¨å¦‚ä½•æ’­æ”¾åŠ å¯†åª’ä½“å†…å®¹ã€‚é€šè¿‡ <code>MediaKeys</code> API ä¸ CDM é€šä¿¡ï¼Œè·å–è§£å¯†å¯†é’¥ã€‚</p>
<p><strong>åŸºæœ¬æµç¨‹ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> video = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"video"</span>);
<span class="hljs-keyword">const</span> config = [
  {
    <span class="hljs-attr">initDataTypes</span>: [<span class="hljs-string">"cenc"</span>],
    <span class="hljs-attr">videoCapabilities</span>: [
      {
        <span class="hljs-attr">contentType</span>: <span class="hljs-string">'video/mp4; codecs="avc1.42E01E"'</span>,
      },
    ],
  },
];

<span class="hljs-comment">// 1. æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦æ”¯æŒè¯¥ DRM æ–¹æ¡ˆ</span>
navigator
  .<span class="hljs-title function_">requestMediaKeySystemAccess</span>(<span class="hljs-string">"com.widevine.alpha"</span>, config)
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">keySystemAccess</span>) =&gt;</span> {
    <span class="hljs-comment">// 2. åˆ›å»º MediaKeys å¯¹è±¡</span>
    <span class="hljs-keyword">return</span> keySystemAccess.<span class="hljs-title function_">createMediaKeys</span>();
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">mediaKeys</span>) =&gt;</span> {
    <span class="hljs-comment">// 3. å°† MediaKeys ç»‘å®šåˆ° video å…ƒç´ </span>
    <span class="hljs-keyword">return</span> video.<span class="hljs-title function_">setMediaKeys</span>(mediaKeys);
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// 4. æ’­æ”¾åŠ å¯†å†…å®¹ï¼Œè§¦å‘ encrypted äº‹ä»¶</span>
    video.<span class="hljs-property">src</span> = <span class="hljs-string">"encrypted-video.mp4"</span>;
    video.<span class="hljs-title function_">play</span>();
  });

<span class="hljs-comment">// 5. å¤„ç† encrypted äº‹ä»¶ï¼Œè¯·æ±‚è®¸å¯è¯</span>
video.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"encrypted"</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> session = video.<span class="hljs-property">mediaKeys</span>.<span class="hljs-title function_">createSession</span>();

  <span class="hljs-comment">// 6. å‘è®¸å¯è¯æœåŠ¡å™¨è¯·æ±‚å¯†é’¥</span>
  session
    .<span class="hljs-title function_">generateRequest</span>(event.<span class="hljs-property">initDataType</span>, event.<span class="hljs-property">initData</span>)
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// 7. è·å–è®¸å¯è¯æœåŠ¡å™¨å“åº”</span>
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">"https://license-server.com/license"</span>, {
        <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
        <span class="hljs-attr">body</span>: session.<span class="hljs-property">message</span>, <span class="hljs-comment">// åŒ…å«è®¾å¤‡ä¿¡æ¯å’Œå†…å®¹ ID</span>
      });
    })
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> response.<span class="hljs-title function_">arrayBuffer</span>())
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">license</span>) =&gt;</span> {
      <span class="hljs-comment">// 8. æ›´æ–°ä¼šè¯ï¼ŒCDM è§£å¯†å†…å®¹</span>
      <span class="hljs-keyword">return</span> session.<span class="hljs-title function_">update</span>(license);
    });
});
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>è§£å¯†å¯†é’¥åœ¨ CDM æ²™ç®±ä¸­ï¼ŒJavaScript æ— æ³•è®¿é—®</li>
<li>è®¸å¯è¯æœåŠ¡å™¨éªŒè¯ç”¨æˆ·èº«ä»½ã€è®¾å¤‡ã€è®¢é˜…çŠ¶æ€ç­‰</li>
<li>L1 çº§åˆ« DRM è¦æ±‚ç¡¬ä»¶ TEE æ”¯æŒ(å¦‚ ARM TrustZone)</li>
</ul>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>ä»˜è´¹è§†é¢‘å¹³å°</strong>ï¼šNetflixã€Disney+ ä½¿ç”¨ Widevine/FairPlay/PlayReady ä¸‰å¥— DRM è¦†ç›–æ‰€æœ‰å¹³å°</li>
<li><strong>åœ¨çº¿æ•™è‚²</strong>ï¼šé˜²æ­¢è¯¾ç¨‹è§†é¢‘è¢«å½•å±å’Œåˆ†äº«ï¼Œé€šå¸¸ä½¿ç”¨ L1 çº§ Widevine</li>
<li><strong>ä¼ä¸šåŸ¹è®­</strong>ï¼šå†…éƒ¨æ•æ„Ÿå†…å®¹åŠ å¯†æ’­æ”¾ï¼Œé™åˆ¶æ’­æ”¾è®¾å¤‡å’Œæ¬¡æ•°</li>
</ul>
<h3 data-id="heading-44">HLS å†…å®¹åŠ å¯†</h3>
<p>HLS æ”¯æŒ AES-128 åŠ å¯†ï¼Œæ— éœ€ DRM å³å¯å®ç°åŸºç¡€å†…å®¹ä¿æŠ¤ã€‚é€‚åˆå¯¹å®‰å…¨æ€§è¦æ±‚ä¸é«˜çš„åœºæ™¯ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<ol>
<li><strong>å¯†é’¥æ–‡ä»¶</strong> - æœåŠ¡å™¨ç”Ÿæˆ AES-128 å¯†é’¥ï¼Œå­˜å‚¨åœ¨å¯†é’¥æœåŠ¡å™¨</li>
<li><strong>m3u8 ç´¢å¼•</strong> - æ’­æ”¾åˆ—è¡¨ä¸­å£°æ˜å¯†é’¥ URLï¼š<code>#EXT-X-KEY:METHOD=AES-128,URI="https://key-server.com/key"</code></li>
<li><strong>å®¢æˆ·ç«¯è§£å¯†</strong> - æ’­æ”¾å™¨è¯·æ±‚å¯†é’¥ï¼Œä½¿ç”¨ AES-128 è§£å¯† TS ç‰‡æ®µ</li>
</ol>
<p><strong>åŸºç¡€ç”¨æ³•ï¼š</strong></p>
<pre><code class="hljs language-m3u8" lang="m3u8">#EXTM3U
#EXT-X-VERSION:3
#EXT-X-KEY:METHOD=AES-128,URI="https://example.com/key?token=abc123"
#EXTINF:10.0,
segment0.ts
#EXTINF:10.0,
segment1.ts
</code></pre>
<p><strong>å®‰å…¨æ€§åˆ†æï¼š</strong></p>
<ul>
<li><strong>ä¼˜ç‚¹</strong>ï¼šå®ç°ç®€å•ï¼Œæ— éœ€ DRM æˆæƒè´¹ç”¨ï¼Œæ‰€æœ‰æµè§ˆå™¨æ”¯æŒ</li>
<li><strong>ç¼ºç‚¹</strong>ï¼šå¯†é’¥åœ¨ JavaScript ä¸­æš´éœ²ï¼Œå®¹æ˜“è¢«æŠ“åŒ…è·å–ï¼Œå®‰å…¨æ€§ä½äº DRM</li>
</ul>
<p><strong>å¢å¼ºæ–¹æ¡ˆï¼š</strong></p>
<ul>
<li><strong>åŠ¨æ€å¯†é’¥</strong> - æ¯ä¸ªç‰‡æ®µä½¿ç”¨ä¸åŒå¯†é’¥ï¼Œå¢åŠ ç ´è§£éš¾åº¦</li>
<li><strong>Token é‰´æƒ</strong> - å¯†é’¥ URL å¸¦æ—¶æ•ˆ Tokenï¼Œé˜²æ­¢å¯†é’¥è¢«ç›—ç”¨</li>
<li><strong>å¯†é’¥è½®æ¢</strong> - å®šæœŸæ›´æ¢å¯†é’¥ï¼Œé™åˆ¶å¯†é’¥æœ‰æ•ˆæœŸ</li>
</ul>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>UGC å¹³å°</strong>ï¼šB ç«™ã€æŠ–éŸ³ç­‰é˜²æ­¢è§†é¢‘è¢«ç›´æ¥ä¸‹è½½ï¼Œä½†ä¸è¦æ±‚ DRM çº§å®‰å…¨</li>
<li><strong>ä¼ä¸šå†…ç½‘</strong>ï¼šå†…éƒ¨åŸ¹è®­è§†é¢‘ï¼Œç‰©ç†éš”ç¦»ç¯å¢ƒæ— éœ€é«˜å®‰å…¨æ€§</li>
<li><strong>ä½æˆæœ¬ä¿æŠ¤</strong>ï¼šå°å‹è§†é¢‘å¹³å°ï¼Œæ— é¢„ç®—é‡‡è´­ DRM æˆæƒ</li>
</ul>
<h3 data-id="heading-45">è®¿é—®æ§åˆ¶æŠ€æœ¯</h3>
<p>é€šè¿‡é‰´æƒæœºåˆ¶æ§åˆ¶è°å¯ä»¥è®¿é—®è§†é¢‘èµ„æºï¼Œé˜²æ­¢ç›—é“¾å’Œæœªæˆæƒè®¿é—®ã€‚</p>
<p><strong>ä¸»æµè®¿é—®æ§åˆ¶æ–¹æ¡ˆå¯¹æ¯”ï¼š</strong></p>















































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>åŸç†</th><th>å®‰å…¨æ€§</th><th>å®ç°å¤æ‚åº¦</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>Token é‰´æƒ</strong></td><td>URL å¸¦æ—¶æ•ˆç­¾å Token</td><td>é«˜</td><td>ä¸­</td><td>ä»˜è´¹å†…å®¹ã€ç›´æ’­</td></tr><tr><td><strong>URL ç­¾å</strong></td><td>åŸºäºå¯†é’¥çš„ HMAC ç­¾å</td><td>é«˜</td><td>ä¸­</td><td>CDN é˜²ç›—é“¾</td></tr><tr><td><strong>Referer</strong></td><td>æ£€æŸ¥ HTTP Referer å¤´</td><td>ä½</td><td>ä½</td><td>åŸºç¡€é˜²ç›—é“¾</td></tr><tr><td><strong>IP ç™½åå•</strong></td><td>é™åˆ¶å…è®¸è®¿é—®çš„ IP æ®µ</td><td>ä¸­</td><td>ä½</td><td>ä¼ä¸šå†…ç½‘ã€VPN</td></tr><tr><td><strong>Cookie é‰´æƒ</strong></td><td>æ£€æŸ¥ç™»å½• Cookie</td><td>ä¸­</td><td>ä½</td><td>ç™»å½•ç”¨æˆ·éªŒè¯</td></tr></tbody></table>
<p><strong>Token é‰´æƒåŸç†ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æœåŠ¡ç«¯ç”Ÿæˆå¸¦ç­¾åçš„ URL(Node.js ç¤ºä¾‹)</span>
<span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">"crypto"</span>);

<span class="hljs-keyword">function</span> <span class="hljs-title function_">generateSecureUrl</span>(<span class="hljs-params">videoPath, secretKey, expireSeconds</span>) {
  <span class="hljs-keyword">const</span> expireTime = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() / <span class="hljs-number">1000</span>) + expireSeconds;
  <span class="hljs-keyword">const</span> message = <span class="hljs-string">`<span class="hljs-subst">${videoPath}</span><span class="hljs-subst">${expireTime}</span>`</span>;
  <span class="hljs-keyword">const</span> signature = crypto.<span class="hljs-title function_">createHmac</span>(<span class="hljs-string">"sha256"</span>, secretKey).<span class="hljs-title function_">update</span>(message).<span class="hljs-title function_">digest</span>(<span class="hljs-string">"hex"</span>);

  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${videoPath}</span>?expire=<span class="hljs-subst">${expireTime}</span>&amp;sign=<span class="hljs-subst">${signature}</span>`</span>;
}

<span class="hljs-comment">// ç”Ÿæˆ 1 å°æ—¶æœ‰æ•ˆçš„è§†é¢‘ URL</span>
<span class="hljs-keyword">const</span> secureUrl = <span class="hljs-title function_">generateSecureUrl</span>(<span class="hljs-string">"/videos/movie.m3u8"</span>, <span class="hljs-string">"my-secret-key"</span>, <span class="hljs-number">3600</span>);
<span class="hljs-comment">// /videos/movie.m3u8?expire=1704067200&amp;sign=a3f2c9...</span>
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// CDN è¾¹ç¼˜èŠ‚ç‚¹éªŒè¯(ä¼ªä»£ç )</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">validateToken</span>(<span class="hljs-params">url, secretKey</span>) {
  <span class="hljs-keyword">const</span> { videoPath, expire, sign } = <span class="hljs-title function_">parseUrl</span>(url);

  <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦è¿‡æœŸ</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() / <span class="hljs-number">1000</span> &gt; expire) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// è¿‡æœŸ</span>
  }

  <span class="hljs-comment">// é‡æ–°è®¡ç®—ç­¾å</span>
  <span class="hljs-keyword">const</span> message = <span class="hljs-string">`<span class="hljs-subst">${videoPath}</span><span class="hljs-subst">${expire}</span>`</span>;
  <span class="hljs-keyword">const</span> expectedSign = crypto.<span class="hljs-title function_">createHmac</span>(<span class="hljs-string">"sha256"</span>, secretKey).<span class="hljs-title function_">update</span>(message).<span class="hljs-title function_">digest</span>(<span class="hljs-string">"hex"</span>);

  <span class="hljs-keyword">return</span> sign === expectedSign; <span class="hljs-comment">// ç­¾ååŒ¹é…</span>
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li><strong>æ—¶æ•ˆæ€§</strong> - Token å¸¦è¿‡æœŸæ—¶é—´ï¼Œé˜²æ­¢ URL è¢«é•¿æœŸç›—ç”¨</li>
<li><strong>ä¸å¯ä¼ªé€ </strong> - ç­¾ååŸºäºæœåŠ¡ç«¯å¯†é’¥ï¼Œæ”»å‡»è€…æ— æ³•ä¼ªé€ æœ‰æ•ˆç­¾å</li>
<li><strong>å•æ¬¡ä½¿ç”¨</strong> - å¯å¢åŠ éšæœº nonceï¼Œé˜²æ­¢ URL è¢«é‡å¤ä½¿ç”¨</li>
</ul>
<p><strong>Referer é˜²ç›—é“¾ï¼š</strong></p>
<pre><code class="hljs language-nginx" lang="nginx"># Nginx é…ç½®ç¤ºä¾‹
location ~* \.(m3u8|ts|mp4)$ {
    valid_referers none blocked *.example.com;
    if ($invalid_referer) {
        return 403;
    }
}
</code></pre>
<p><strong>å±€é™æ€§</strong> - Referer å¯è¢«ä¼ªé€ ï¼Œä»…é€‚åˆåŸºç¡€é˜²æŠ¤</p>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>ä»˜è´¹è§†é¢‘</strong> - Token é‰´æƒ + DRMï¼ŒåŒé‡ä¿æŠ¤é«˜ä»·å€¼å†…å®¹</li>
<li><strong>ç›´æ’­é‰´æƒ</strong> - åŠ¨æ€ç”Ÿæˆæ¨æµ/æ‹‰æµ Tokenï¼Œé˜²æ­¢æœªæˆæƒæ¨æµ</li>
<li><strong>CDN é˜²ç›—é“¾</strong> - URL ç­¾åé˜²æ­¢è§†é¢‘è¢«å…¶ä»–ç½‘ç«™ç›—é“¾æ¶ˆè€—å¸¦å®½</li>
</ul>
<h2 data-id="heading-46">æ€§èƒ½ä¼˜åŒ–ä¸è´¨é‡ç›‘æ§</h2>
<p>å¤šåª’ä½“åº”ç”¨çš„ç”¨æˆ·ä½“éªŒç›´æ¥å–å†³äºæ’­æ”¾æ€§èƒ½å’Œè´¨é‡ç¨³å®šæ€§ã€‚æœ¬ç« ä»‹ç»å…³é”®æ€§èƒ½æŒ‡æ ‡(QoE/QoS)ã€ä¼˜åŒ–ç­–ç•¥(ABRã€é¢„åŠ è½½ã€å¤šçº¿ç¨‹)ã€ä»¥åŠç›‘æ§å·¥å…·,å¸®åŠ©å¼€å‘è€…æ„å»ºé«˜æ€§èƒ½ã€ä½å¡é¡¿çš„éŸ³è§†é¢‘åº”ç”¨ã€‚</p>
<h3 data-id="heading-47">å…³é”®æ€§èƒ½æŒ‡æ ‡</h3>
<p><strong>QoE(Quality of Experience)ç”¨æˆ·ä½“éªŒè´¨é‡æŒ‡æ ‡ï¼š</strong></p>









































<table><thead><tr><th>æŒ‡æ ‡</th><th>å®šä¹‰</th><th>ç›®æ ‡å€¼</th><th>å½±å“å› ç´ </th></tr></thead><tbody><tr><td><strong>é¦–å±æ—¶é—´</strong></td><td>ç‚¹å‡»æ’­æ”¾åˆ°æ˜¾ç¤ºé¦–å¸§çš„æ—¶é—´</td><td>&lt;1 ç§’(ç‚¹æ’­)/&lt;3 ç§’(ç›´æ’­)</td><td>ç½‘ç»œå»¶è¿Ÿã€DNS è§£æã€CDN</td></tr><tr><td><strong>å¡é¡¿ç‡</strong></td><td>æ’­æ”¾è¿‡ç¨‹ä¸­å¡é¡¿æ—¶é•¿å æ¯”</td><td>&lt;0.5%</td><td>ç¼“å†²ç­–ç•¥ã€ç½‘ç»œæŠ–åŠ¨</td></tr><tr><td><strong>å¡é¡¿æ¬¡æ•°</strong></td><td>æ’­æ”¾è¿‡ç¨‹ä¸­å¡é¡¿å‘ç”Ÿæ¬¡æ•°</td><td>&lt;2 æ¬¡/å°æ—¶</td><td>å¸¦å®½æ³¢åŠ¨ã€ABR åˆ‡æ¢</td></tr><tr><td><strong>æ’­æ”¾ç ç‡</strong></td><td>å®é™…æ’­æ”¾çš„ç ç‡æ¡£ä½</td><td>è‡ªé€‚åº”æœ€é«˜</td><td>å¸¦å®½ã€è®¾å¤‡æ€§èƒ½</td></tr><tr><td><strong>æ’­æ”¾æˆåŠŸç‡</strong></td><td>æˆåŠŸæ’­æ”¾å æ’­æ”¾è¯·æ±‚çš„æ¯”ä¾‹</td><td>&gt;99%</td><td>æ ¼å¼å…¼å®¹æ€§ã€DRM é”™è¯¯</td></tr></tbody></table>
<p><strong>QoS(Quality of Service)ç½‘ç»œè´¨é‡æŒ‡æ ‡ï¼š</strong></p>









































<table><thead><tr><th>æŒ‡æ ‡</th><th>å®šä¹‰</th><th>ç›®æ ‡å€¼</th><th>å½±å“</th></tr></thead><tbody><tr><td><strong>ç ç‡</strong></td><td>è§†é¢‘ä¼ è¾“é€Ÿç‡</td><td>æ ¹æ®åˆ†è¾¨ç‡é€‰æ‹©</td><td>ç”»è´¨ã€å¸¦å®½æ¶ˆè€—</td></tr><tr><td><strong>ä¸¢åŒ…ç‡</strong></td><td>ä¸¢å¤±çš„æ•°æ®åŒ…å æ¯”</td><td>&lt;1%(ç›´æ’­/&lt;0.1%ç‚¹æ’­)</td><td>ç”»é¢å¤±çœŸã€å¡é¡¿</td></tr><tr><td><strong>RTT</strong></td><td>å¾€è¿”æ—¶å»¶</td><td>&lt;100ms(å®æ—¶é€šä¿¡)</td><td>äº¤äº’å»¶è¿Ÿæ„Ÿ</td></tr><tr><td><strong>æŠ–åŠ¨</strong></td><td>å»¶è¿Ÿçš„å˜åŒ–ç¨‹åº¦</td><td>&lt;30ms</td><td>æ’­æ”¾æµç•…æ€§</td></tr><tr><td><strong>å¸¦å®½</strong></td><td>å¯ç”¨ç½‘ç»œä¼ è¾“é€Ÿåº¦</td><td>&gt;ç ç‡ 1.5 å€</td><td>èƒ½å¦æµç•…æ’­æ”¾</td></tr></tbody></table>
<p><strong>ç›‘æ§å®ç°ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨ HTMLMediaElement ç›‘æ§æ’­æ”¾æŒ‡æ ‡</span>
<span class="hljs-keyword">const</span> video = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"video"</span>);
<span class="hljs-keyword">const</span> metrics = {
  <span class="hljs-attr">startTime</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
  <span class="hljs-attr">bufferingCount</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">bufferingDuration</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">currentBitrate</span>: <span class="hljs-number">0</span>,
};

<span class="hljs-comment">// é¦–å±æ—¶é—´</span>
video.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"loadeddata"</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> ttfb = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - metrics.<span class="hljs-property">startTime</span>;
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`é¦–å±æ—¶é—´: <span class="hljs-subst">${ttfb}</span>ms`</span>);
  <span class="hljs-comment">// ä¸ŠæŠ¥ç›‘æ§ç³»ç»Ÿ</span>
  <span class="hljs-title function_">reportMetric</span>(<span class="hljs-string">"ttfb"</span>, ttfb);
});

<span class="hljs-comment">// å¡é¡¿ç›‘æ§</span>
<span class="hljs-keyword">let</span> bufferingStart = <span class="hljs-number">0</span>;
video.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"waiting"</span>, <span class="hljs-function">() =&gt;</span> {
  bufferingStart = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
  metrics.<span class="hljs-property">bufferingCount</span>++;
});

video.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"playing"</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">if</span> (bufferingStart) {
    <span class="hljs-keyword">const</span> bufferingTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - bufferingStart;
    metrics.<span class="hljs-property">bufferingDuration</span> += bufferingTime;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å¡é¡¿: <span class="hljs-subst">${bufferingTime}</span>ms, æ€»å¡é¡¿: <span class="hljs-subst">${metrics.bufferingCount}</span> æ¬¡`</span>);
  }
});

<span class="hljs-comment">// è®¡ç®—å¡é¡¿ç‡</span>
video.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"ended"</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> totalDuration = video.<span class="hljs-property">duration</span> * <span class="hljs-number">1000</span>;
  <span class="hljs-keyword">const</span> bufferingRate = (metrics.<span class="hljs-property">bufferingDuration</span> / totalDuration) * <span class="hljs-number">100</span>;
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å¡é¡¿ç‡: <span class="hljs-subst">${bufferingRate.toFixed(<span class="hljs-number">2</span>)}</span>%`</span>);
});
</code></pre>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>è§†é¢‘å¹³å°</strong> - å®æ—¶ç›‘æ§å¡é¡¿ç‡å’Œé¦–å±æ—¶é—´,å‘ç° CDN èŠ‚ç‚¹æ•…éšœå’Œç½‘ç»œæ‹¥å¡</li>
<li><strong>ç›´æ’­åº”ç”¨</strong> - ç›‘æ§ç«¯åˆ°ç«¯å»¶è¿Ÿå’Œä¸¢åŒ…ç‡,ä¿è¯å®æ—¶æ€§</li>
<li><strong>æ•™è‚²å¹³å°</strong> - ç›‘æ§æ’­æ”¾æˆåŠŸç‡,åŠæ—¶å‘ç°æ ¼å¼å…¼å®¹æ€§å’Œ DRM æˆæƒé—®é¢˜</li>
</ul>
<h3 data-id="heading-48">ä¼˜åŒ–ç­–ç•¥</h3>
<p><strong>ä¸»æµä¼˜åŒ–ç­–ç•¥å¯¹æ¯”ï¼š</strong></p>






















































<table><thead><tr><th>ç­–ç•¥</th><th>åŸç†</th><th>æ•ˆæœ</th><th>å®ç°æˆæœ¬</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>é¢„åŠ è½½</strong></td><td>æå‰åŠ è½½å…³é”®èµ„æº</td><td>å‡å°‘é¦–å±æ—¶é—´ 50%+</td><td>ä½</td><td>ç‚¹æ’­ã€é¢„çŸ¥æ’­æ”¾</td></tr><tr><td><strong>ABR è‡ªé€‚åº”ç ç‡</strong></td><td>åŠ¨æ€åˆ‡æ¢ç ç‡æ¡£ä½</td><td>å‡å°‘å¡é¡¿ 70%+</td><td>ä¸­</td><td>æ‰€æœ‰æµåª’ä½“</td></tr><tr><td><strong>åˆ†ç‰‡åŠ è½½</strong></td><td>æŒ‰éœ€åŠ è½½è§†é¢‘ç‰‡æ®µ</td><td>å‡å°‘åˆå§‹åŠ è½½ 90%+</td><td>ä½</td><td>é•¿è§†é¢‘ã€ç‚¹æ’­</td></tr><tr><td><strong>P2P CDN</strong></td><td>ç”¨æˆ·é—´å…±äº«æ•°æ®</td><td>èŠ‚çœå¸¦å®½ 30-70%</td><td>é«˜</td><td>å¤§è§„æ¨¡ç›´æ’­</td></tr><tr><td><strong>å¤šçº¿ç¨‹è§£ç </strong></td><td>Web Workers è§£ç </td><td>æå‡è§£ç æ€§èƒ½ 2-3 å€</td><td>ä¸­</td><td>è½¯è§£å¤æ‚ç¼–ç </td></tr><tr><td><strong>Service Worker</strong></td><td>ç¦»çº¿ç¼“å­˜èµ„æº</td><td>ç¦»çº¿æ’­æ”¾ã€ç§’å¼€</td><td>ä¸­</td><td>PWAã€é‡å¤è§‚çœ‹</td></tr></tbody></table>
<h4 data-id="heading-49">é¢„åŠ è½½ä¼˜åŒ–</h4>
<p><strong>Link Preload - æå‰åŠ è½½å…³é”®èµ„æºï¼š</strong></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- é¢„åŠ è½½è§†é¢‘æ–‡ä»¶ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"preload"</span> <span class="hljs-attr">as</span>=<span class="hljs-string">"video"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"intro.mp4"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"video/mp4"</span> /&gt;</span>

<span class="hljs-comment">&lt;!-- é¢„åŠ è½½ HLS æ’­æ”¾åˆ—è¡¨ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"preload"</span> <span class="hljs-attr">as</span>=<span class="hljs-string">"fetch"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"video.m3u8"</span> <span class="hljs-attr">crossorigin</span> /&gt;</span>

<span class="hljs-comment">&lt;!-- é¢„åŠ è½½æµ·æŠ¥å›¾ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"preload"</span> <span class="hljs-attr">as</span>=<span class="hljs-string">"image"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"poster.jpg"</span> /&gt;</span>
</code></pre>
<p><strong>Video Preload å±æ€§ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> video = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">"video"</span>);

<span class="hljs-comment">// none - ä¸é¢„åŠ è½½(çœæµé‡)</span>
video.<span class="hljs-property">preload</span> = <span class="hljs-string">"none"</span>;

<span class="hljs-comment">// metadata - ä»…åŠ è½½å…ƒæ•°æ®(æ—¶é•¿ã€å°ºå¯¸ã€é¦–å¸§)</span>
video.<span class="hljs-property">preload</span> = <span class="hljs-string">"metadata"</span>; <span class="hljs-comment">// é»˜è®¤å€¼</span>

<span class="hljs-comment">// auto - é¢„åŠ è½½æ•´ä¸ªè§†é¢‘(é€‚åˆ Wi-Fi)</span>
video.<span class="hljs-property">preload</span> = <span class="hljs-string">"auto"</span>;
</code></pre>
<p><strong>æ™ºèƒ½é¢„åŠ è½½ç­–ç•¥ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ ¹æ®ç½‘ç»œç±»å‹å†³å®šé¢„åŠ è½½ç­–ç•¥</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getPreloadStrategy</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> connection = navigator.<span class="hljs-property">connection</span> || navigator.<span class="hljs-property">mozConnection</span> || navigator.<span class="hljs-property">webkitConnection</span>;

  <span class="hljs-keyword">if</span> (!connection) <span class="hljs-keyword">return</span> <span class="hljs-string">"metadata"</span>;

  <span class="hljs-comment">// 4G/5G é¢„åŠ è½½è§†é¢‘</span>
  <span class="hljs-keyword">if</span> (connection.<span class="hljs-property">effectiveType</span> === <span class="hljs-string">"4g"</span> || connection.<span class="hljs-property">effectiveType</span> === <span class="hljs-string">"5g"</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">"auto"</span>;
  }

  <span class="hljs-comment">// 3G ä»…åŠ è½½å…ƒæ•°æ®</span>
  <span class="hljs-keyword">if</span> (connection.<span class="hljs-property">effectiveType</span> === <span class="hljs-string">"3g"</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">"metadata"</span>;
  }

  <span class="hljs-comment">// 2G/æ…¢é€Ÿç½‘ç»œä¸é¢„åŠ è½½</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">"none"</span>;
}

video.<span class="hljs-property">preload</span> = <span class="hljs-title function_">getPreloadStrategy</span>();
</code></pre>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>çŸ­è§†é¢‘åˆ—è¡¨</strong> - é¢„åŠ è½½å¯è§†åŒºåŸŸçš„ä¸‹ä¸€ä¸ªè§†é¢‘,å®ç°å¿«é€Ÿåˆ‡æ¢</li>
<li><strong>ä»˜è´¹è¯•çœ‹</strong> - ä»… preload metadata,é¿å…æµªè´¹å¸¦å®½</li>
<li><strong>è‡ªåŠ¨æ’­æ”¾</strong> - Wi-Fi ä¸‹ preload auto,ç§»åŠ¨ç½‘ç»œ preload none</li>
</ul>
<h4 data-id="heading-50">ABR è‡ªé€‚åº”ç ç‡</h4>
<p>ABR(Adaptive Bitrate)æ ¹æ®ç½‘ç»œå¸¦å®½åŠ¨æ€åˆ‡æ¢è§†é¢‘ç ç‡æ¡£ä½,å¹³è¡¡ç”»è´¨å’Œæµç•…æ€§ã€‚</p>
<p><strong>åŸç†ï¼š</strong></p>
<ol>
<li><strong>å¸¦å®½æ£€æµ‹</strong> - æµ‹é‡å½“å‰ä¸‹è½½é€Ÿåº¦</li>
<li><strong>ç ç‡é€‰æ‹©</strong> - é€‰æ‹©ç•¥ä½äºå¸¦å®½çš„ç ç‡æ¡£ä½(å¦‚ 480p/720p/1080p)</li>
<li><strong>å¹³æ»‘åˆ‡æ¢</strong> - åœ¨ç‰‡æ®µè¾¹ç•Œåˆ‡æ¢,ç”¨æˆ·æ— æ„ŸçŸ¥</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨ hls.js çš„ ABR é…ç½®</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Hls</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"hls.js"</span>;

<span class="hljs-keyword">const</span> hls = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hls</span>({
  <span class="hljs-comment">// ABR ç®—æ³•é…ç½®</span>
  <span class="hljs-attr">abrEwmaDefaultEstimate</span>: <span class="hljs-number">500000</span>, <span class="hljs-comment">// åˆå§‹å¸¦å®½ä¼°è®¡(500 Kbps)</span>
  <span class="hljs-attr">abrEwmaSlowVoD</span>: <span class="hljs-number">3</span>, <span class="hljs-comment">// æ…¢é€Ÿç½‘ç»œè¡°å‡å› å­</span>
  <span class="hljs-attr">abrEwmaFastVoD</span>: <span class="hljs-number">3</span>, <span class="hljs-comment">// å¿«é€Ÿç½‘ç»œè¡°å‡å› å­</span>
  <span class="hljs-attr">abrBandWidthFactor</span>: <span class="hljs-number">0.95</span>, <span class="hljs-comment">// å¸¦å®½å®‰å…¨ç³»æ•°(é€‰æ‹© 95% ç ç‡)</span>
  <span class="hljs-attr">abrBandWidthUpFactor</span>: <span class="hljs-number">0.7</span>, <span class="hljs-comment">// ä¸Šè°ƒç ç‡é˜ˆå€¼(å¸¦å®½éœ€è¾¾åˆ° 70%)</span>
});

hls.<span class="hljs-title function_">loadSource</span>(<span class="hljs-string">"video.m3u8"</span>);
hls.<span class="hljs-title function_">attachMedia</span>(video);

<span class="hljs-comment">// ç›‘å¬ç ç‡åˆ‡æ¢</span>
hls.<span class="hljs-title function_">on</span>(<span class="hljs-title class_">Hls</span>.<span class="hljs-property">Events</span>.<span class="hljs-property">LEVEL_SWITCHED</span>, <span class="hljs-function">(<span class="hljs-params">event, data</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> level = hls.<span class="hljs-property">levels</span>[data.<span class="hljs-property">level</span>];
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`åˆ‡æ¢åˆ°: <span class="hljs-subst">${level.height}</span>p, ç ç‡: <span class="hljs-subst">${level.bitrate / <span class="hljs-number">1000</span>}</span> Kbps`</span>);
});

<span class="hljs-comment">// æ‰‹åŠ¨é”å®šç ç‡æ¡£ä½</span>
hls.<span class="hljs-property">currentLevel</span> = <span class="hljs-number">2</span>; <span class="hljs-comment">// é”å®šåˆ°ç¬¬ 3 ä¸ªç ç‡æ¡£ä½</span>
hls.<span class="hljs-property">currentLevel</span> = -<span class="hljs-number">1</span>; <span class="hljs-comment">// æ¢å¤è‡ªåŠ¨ ABR</span>
</code></pre>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>ç§»åŠ¨ç½‘ç»œ</strong> - ç½‘ç»œæ³¢åŠ¨å¤§,ABR è‡ªåŠ¨é™ä½ç ç‡é¿å…å¡é¡¿</li>
<li><strong>å¼±ç½‘ç¯å¢ƒ</strong> - 2G/3G ç½‘ç»œè‡ªåŠ¨æ’­æ”¾ä½ç ç‡,ä¿è¯æµç•…</li>
<li><strong>Wi-Fi åˆ‡æ¢</strong> - ä»ç§»åŠ¨ç½‘ç»œåˆ‡åˆ° Wi-Fi,è‡ªåŠ¨æå‡ç ç‡</li>
</ul>
<h4 data-id="heading-51">å¤šçº¿ç¨‹å¤„ç†</h4>
<p>åˆ©ç”¨ Web Workers åœ¨åå°çº¿ç¨‹å¤„ç†è§£ç ã€è½¬ç ç­‰ CPU å¯†é›†ä»»åŠ¡,é¿å…é˜»å¡ä¸»çº¿ç¨‹ã€‚</p>
<p><strong>Web Workers è§†é¢‘å¤„ç†ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// main.js - ä¸»çº¿ç¨‹</span>
<span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">"video-processor.worker.js"</span>);

<span class="hljs-comment">// å‘é€è§†é¢‘å¸§åˆ° Worker</span>
worker.<span class="hljs-title function_">postMessage</span>({
  <span class="hljs-attr">type</span>: <span class="hljs-string">"process"</span>,
  <span class="hljs-attr">frame</span>: videoFrame,
  <span class="hljs-attr">filter</span>: <span class="hljs-string">"grayscale"</span>,
});

<span class="hljs-comment">// æ¥æ”¶å¤„ç†åçš„å¸§</span>
worker.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> processedFrame = event.<span class="hljs-property">data</span>.<span class="hljs-property">frame</span>;
  <span class="hljs-title function_">drawToCanvas</span>(processedFrame);
};
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// video-processor.worker.js - Worker çº¿ç¨‹</span>
self.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> { frame, filter } = event.<span class="hljs-property">data</span>;

  <span class="hljs-comment">// CPU å¯†é›†å‹å¤„ç†(ä¸é˜»å¡ä¸»çº¿ç¨‹)</span>
  <span class="hljs-keyword">const</span> processed = <span class="hljs-title function_">applyFilter</span>(frame, filter);

  <span class="hljs-comment">// è¿”å›ç»“æœ</span>
  self.<span class="hljs-title function_">postMessage</span>({ <span class="hljs-attr">frame</span>: processed });
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">applyFilter</span>(<span class="hljs-params">frame, filter</span>) {
  <span class="hljs-comment">// åƒç´ å¤„ç†é€»è¾‘</span>
  <span class="hljs-comment">// ...</span>
  <span class="hljs-keyword">return</span> processedFrame;
}
</code></pre>
<p><strong>SharedArrayBuffer - é›¶æ‹·è´æ•°æ®å…±äº«ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ›å»ºå…±äº«å†…å­˜</span>
<span class="hljs-keyword">const</span> sharedBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SharedArrayBuffer</span>(<span class="hljs-number">1920</span> * <span class="hljs-number">1080</span> * <span class="hljs-number">4</span>); <span class="hljs-comment">// 1080p RGBA</span>
<span class="hljs-keyword">const</span> sharedArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8ClampedArray</span>(sharedBuffer);

<span class="hljs-comment">// ä¸»çº¿ç¨‹å†™å…¥å¸§æ•°æ®</span>
ctx.<span class="hljs-title function_">getImageData</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1920</span>, <span class="hljs-number">1080</span>).<span class="hljs-property">data</span>.<span class="hljs-title function_">set</span>(sharedArray);

<span class="hljs-comment">// Worker ç›´æ¥è¯»å–,æ— éœ€æ‹·è´</span>
worker.<span class="hljs-title function_">postMessage</span>({ <span class="hljs-attr">buffer</span>: sharedBuffer }, []);
</code></pre>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>è½¯ä»¶è§£ç </strong> - WebCodecs è§£ç åœ¨ Worker,é¿å…ä¸»çº¿ç¨‹æ‰å¸§</li>
<li><strong>å®æ—¶æ»¤é•œ</strong> - ç¾é¢œã€æ»¤é•œåœ¨ Worker å¤„ç†,ä¿æŒ UI æµç•…</li>
<li><strong>è§†é¢‘è½¬ç </strong> - FFmpeg.wasm åœ¨ Worker è¿è¡Œ,ä¸é˜»å¡ç•Œé¢</li>
</ul>
<h4 data-id="heading-52">Service Worker ç¦»çº¿ç¼“å­˜</h4>
<p>Service Worker æ‹¦æˆªç½‘ç»œè¯·æ±‚,å®ç°è§†é¢‘èµ„æºçš„ç¦»çº¿ç¼“å­˜å’Œç§’å¼€ã€‚</p>
<p><strong>åŸºç¡€å®ç°ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// sw.js - Service Worker</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">CACHE_NAME</span> = <span class="hljs-string">"video-cache-v1"</span>;
<span class="hljs-keyword">const</span> urlsToCache = [<span class="hljs-string">"/video.m3u8"</span>, <span class="hljs-string">"/segment-0.ts"</span>, <span class="hljs-string">"/segment-1.ts"</span>];

<span class="hljs-comment">// å®‰è£…æ—¶ç¼“å­˜èµ„æº</span>
self.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"install"</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  event.<span class="hljs-title function_">waitUntil</span>(caches.<span class="hljs-title function_">open</span>(<span class="hljs-variable constant_">CACHE_NAME</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">cache</span>) =&gt;</span> cache.<span class="hljs-title function_">addAll</span>(urlsToCache)));
});

<span class="hljs-comment">// æ‹¦æˆªè¯·æ±‚,ä¼˜å…ˆè¿”å›ç¼“å­˜</span>
self.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"fetch"</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  event.<span class="hljs-title function_">respondWith</span>(
    caches.<span class="hljs-title function_">match</span>(event.<span class="hljs-property">request</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
      <span class="hljs-comment">// ç¼“å­˜å‘½ä¸­,ç›´æ¥è¿”å›</span>
      <span class="hljs-keyword">if</span> (response) {
        <span class="hljs-keyword">return</span> response;
      }

      <span class="hljs-comment">// ç¼“å­˜æœªå‘½ä¸­,è¯·æ±‚ç½‘ç»œ</span>
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">fetch</span>(event.<span class="hljs-property">request</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">networkResponse</span>) =&gt;</span> {
        <span class="hljs-comment">// ç¼“å­˜å“åº”</span>
        <span class="hljs-keyword">if</span> (networkResponse.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) {
          <span class="hljs-keyword">const</span> responseClone = networkResponse.<span class="hljs-title function_">clone</span>();
          caches.<span class="hljs-title function_">open</span>(<span class="hljs-variable constant_">CACHE_NAME</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">cache</span>) =&gt;</span> {
            cache.<span class="hljs-title function_">put</span>(event.<span class="hljs-property">request</span>, responseClone);
          });
        }
        <span class="hljs-keyword">return</span> networkResponse;
      });
    })
  );
});
</code></pre>
<p><strong>æ™ºèƒ½ç¼“å­˜ç­–ç•¥ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ ¹æ®æ–‡ä»¶ç±»å‹é‡‡ç”¨ä¸åŒç­–ç•¥</span>
self.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"fetch"</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> url = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(event.<span class="hljs-property">request</span>.<span class="hljs-property">url</span>);

  <span class="hljs-comment">// m3u8 - ç½‘ç»œä¼˜å…ˆ(åŠæ—¶æ›´æ–°)</span>
  <span class="hljs-keyword">if</span> (url.<span class="hljs-property">pathname</span>.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">".m3u8"</span>)) {
    event.<span class="hljs-title function_">respondWith</span>(<span class="hljs-title function_">networkFirst</span>(event.<span class="hljs-property">request</span>));
  }

  <span class="hljs-comment">// ts ç‰‡æ®µ - ç¼“å­˜ä¼˜å…ˆ(ä¸å˜å†…å®¹)</span>
  <span class="hljs-keyword">if</span> (url.<span class="hljs-property">pathname</span>.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">".ts"</span>)) {
    event.<span class="hljs-title function_">respondWith</span>(<span class="hljs-title function_">cacheFirst</span>(event.<span class="hljs-property">request</span>));
  }
});

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">cacheFirst</span>(<span class="hljs-params">request</span>) {
  <span class="hljs-keyword">const</span> cache = <span class="hljs-keyword">await</span> caches.<span class="hljs-title function_">open</span>(<span class="hljs-variable constant_">CACHE_NAME</span>);
  <span class="hljs-keyword">const</span> cached = <span class="hljs-keyword">await</span> cache.<span class="hljs-title function_">match</span>(request);
  <span class="hljs-keyword">return</span> cached || <span class="hljs-title function_">fetch</span>(request);
}

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">networkFirst</span>(<span class="hljs-params">request</span>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(request);
    <span class="hljs-keyword">const</span> cache = <span class="hljs-keyword">await</span> caches.<span class="hljs-title function_">open</span>(<span class="hljs-variable constant_">CACHE_NAME</span>);
    cache.<span class="hljs-title function_">put</span>(request, response.<span class="hljs-title function_">clone</span>());
    <span class="hljs-keyword">return</span> response;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-keyword">return</span> caches.<span class="hljs-title function_">match</span>(request); <span class="hljs-comment">// ç½‘ç»œå¤±è´¥å›é€€ç¼“å­˜</span>
  }
}
</code></pre>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>ç¦»çº¿æ’­æ”¾</strong> - ç¼“å­˜å®Œæ•´è§†é¢‘,æ”¯æŒé£è¡Œæ¨¡å¼è§‚çœ‹</li>
<li><strong>ç§’å¼€ä¼˜åŒ–</strong> - ç¼“å­˜é¦–ä¸ªç‰‡æ®µ,æ’­æ”¾ç«‹å³å¼€å§‹</li>
<li><strong>å‡å°‘æµé‡</strong> - é‡å¤è§‚çœ‹çš„è§†é¢‘ä»ç¼“å­˜åŠ è½½</li>
</ul>
<h3 data-id="heading-53">ç›‘æ§å·¥å…·</h3>
<p><strong>Chrome DevTools Media Panelï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è®¿é—® chrome://media-internals/ æŸ¥çœ‹ï¼š</span>
<span class="hljs-comment">// - è§£ç å™¨ä¿¡æ¯(ç¡¬ä»¶/è½¯ä»¶)</span>
<span class="hljs-comment">// - ç¼“å†²çŠ¶æ€</span>
<span class="hljs-comment">// - ç½‘ç»œè¯·æ±‚æ—¶é—´çº¿</span>
<span class="hljs-comment">// - ä¸¢å¸§ç»Ÿè®¡</span>
</code></pre>
<p><strong>WebRTC internalsï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è®¿é—® chrome://webrtc-internals/ æŸ¥çœ‹ï¼š</span>
<span class="hljs-comment">// - ICE è¿æ¥çŠ¶æ€</span>
<span class="hljs-comment">// - å®æ—¶ç ç‡/ä¸¢åŒ…ç‡/RTT</span>
<span class="hljs-comment">// - ç¼–è§£ç å™¨å‚æ•°</span>
</code></pre>
<p><strong>Performance API ç›‘æ§ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨ Performance Observer ç›‘æ§</span>
<span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PerformanceObserver</span>(<span class="hljs-function">(<span class="hljs-params">list</span>) =&gt;</span> {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> list.<span class="hljs-title function_">getEntries</span>()) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${entry.name}</span>: <span class="hljs-subst">${entry.duration}</span>ms`</span>);
    <span class="hljs-title function_">reportMetric</span>(entry);
  }
});

observer.<span class="hljs-title function_">observe</span>({ <span class="hljs-attr">entryTypes</span>: [<span class="hljs-string">"measure"</span>, <span class="hljs-string">"resource"</span>] });

<span class="hljs-comment">// æ ‡è®°å…³é”®æ—¶é—´ç‚¹</span>
performance.<span class="hljs-title function_">mark</span>(<span class="hljs-string">"video-load-start"</span>);
video.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"loadeddata"</span>, <span class="hljs-function">() =&gt;</span> {
  performance.<span class="hljs-title function_">mark</span>(<span class="hljs-string">"video-load-end"</span>);
  performance.<span class="hljs-title function_">measure</span>(<span class="hljs-string">"video-load-duration"</span>, <span class="hljs-string">"video-load-start"</span>, <span class="hljs-string">"video-load-end"</span>);
});
</code></pre>
<p><strong>å…¸å‹åœºæ™¯ï¼š</strong></p>
<ul>
<li><strong>æ€§èƒ½å›å½’</strong> - CI/CD ä¸­è‡ªåŠ¨åŒ–ç›‘æ§é¦–å±æ—¶é—´,å‘ç°æ€§èƒ½åŠ£åŒ–</li>
<li><strong>A/B æµ‹è¯•</strong> - å¯¹æ¯”ä¸åŒä¼˜åŒ–ç­–ç•¥çš„å®é™…æ•ˆæœ</li>
<li><strong>ç”¨æˆ·ç›‘æ§</strong> - æ”¶é›†çœŸå®ç”¨æˆ·çš„æ’­æ”¾è´¨é‡æ•°æ®,ä¼˜åŒ– CDN ç­–ç•¥</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android 15 æ˜¾ç¤ºå­ç³»ç»Ÿæ·±åº¦è§£æ(ä¸€)ï¼šæ˜¾ç¤ºæ¡†æ¶æ€»è§ˆä¸SurfaceFlingeræ ¸å¿ƒæœºåˆ¶]]></title>    <link>https://juejin.cn/post/7595808703074910234</link>    <guid>https://juejin.cn/post/7595808703074910234</guid>    <pubDate>2026-01-17T12:33:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595808703074910234" data-draft-id="7596299957276704795" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android 15 æ˜¾ç¤ºå­ç³»ç»Ÿæ·±åº¦è§£æ(ä¸€)ï¼šæ˜¾ç¤ºæ¡†æ¶æ€»è§ˆä¸SurfaceFlingeræ ¸å¿ƒæœºåˆ¶"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-01-17T12:33:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†¬å¥‡Lab"/> <meta itemprop="url" content="https://juejin.cn/user/1857501105781193"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android 15 æ˜¾ç¤ºå­ç³»ç»Ÿæ·±åº¦è§£æ(ä¸€)ï¼šæ˜¾ç¤ºæ¡†æ¶æ€»è§ˆä¸SurfaceFlingeræ ¸å¿ƒæœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1857501105781193/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†¬å¥‡Lab
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T12:33:45.000Z" title="Sat Jan 17 2026 12:33:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»18åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<blockquote>
<p>"åœ¨Androidç³»ç»Ÿä¸­ï¼Œæ˜¾ç¤ºå­ç³»ç»Ÿå°±åƒä¸€ä¸ªç²¾å¯†çš„äº¤å“ä¹å›¢ï¼Œåº”ç”¨å±‚æ˜¯ä½œæ›²å®¶ï¼ŒSurfaceFlingeræ˜¯æŒ‡æŒ¥å®¶ï¼Œå„ä¸ªLayeræ˜¯æ¼”å¥å®¶ï¼Œè€Œå±å¹•åˆ™æ˜¯èˆå°ã€‚åªæœ‰å„ä¸ªè§’è‰²å®Œç¾é…åˆï¼Œæ‰èƒ½å‘ˆç°æµç•…ä¸æ»‘çš„è§†è§‰ä½“éªŒã€‚"</p>
</blockquote>
<p>ä½œä¸ºAndroidç³»ç»Ÿä¸­æœ€å¤æ‚ã€æœ€æ ¸å¿ƒçš„å­ç³»ç»Ÿä¹‹ä¸€ï¼Œæ˜¾ç¤ºå­ç³»ç»Ÿæ‰¿æ‹…ç€å°†åº”ç”¨ç»˜åˆ¶çš„å†…å®¹é«˜æ•ˆå‘ˆç°åˆ°å±å¹•ä¸Šçš„é‡ä»»ã€‚æ— è®ºæ˜¯æ»‘åŠ¨åˆ—è¡¨çš„ä¸æ»‘æµç•…ï¼Œè¿˜æ˜¯è§†é¢‘æ’­æ”¾çš„ç”»é¢ç¨³å®šï¼ŒèƒŒåéƒ½ç¦»ä¸å¼€æ˜¾ç¤ºå­ç³»ç»Ÿçš„ç²¾å¯†è°ƒåº¦ã€‚</p>
<p><strong>Android 15åœ¨æ˜¾ç¤ºç³»ç»Ÿæ–¹é¢è¿›è¡Œäº†é‡å¤§ä¼˜åŒ–</strong>ï¼ŒåŒ…æ‹¬Canvasç°ä»£åŒ–æ”¹é€ ã€CanvasKité›†æˆã€HWC 3.0æ”¯æŒç­‰ï¼Œä½¿å¾—æ¸²æŸ“æ€§èƒ½å’ŒåŠŸè€—éƒ½æœ‰äº†æ˜¾è‘—æå‡ã€‚ä½œä¸ºã€ŠAndroid 15æ ¸å¿ƒå­ç³»ç»Ÿæ·±åº¦è§£æã€‹ç³»åˆ—çš„ç¬¬ä¸€ç¯‡ï¼Œæœ¬æ–‡å°†å¸¦ä½ æ·±å…¥ç†è§£Androidæ˜¾ç¤ºæ¡†æ¶çš„æ•´ä½“æ¶æ„ï¼Œå¹¶é‡ç‚¹å‰–æSurfaceFlingerè¿™ä¸€æ ¸å¿ƒæœåŠ¡çš„å·¥ä½œæœºåˆ¶ã€‚</p>
<h3 data-id="heading-1">ä½ å°†å­¦åˆ°ä»€ä¹ˆ</h3>
<ul>
<li>Androidæ˜¾ç¤ºæ ˆçš„å®Œæ•´åˆ†å±‚æ¶æ„</li>
<li>SurfaceFlingeræœåŠ¡çš„å¯åŠ¨ä¸åˆå§‹åŒ–æµç¨‹</li>
<li>Surfaceçš„æœ¬è´¨åŠå…¶åˆ›å»ºç®¡ç†æœºåˆ¶</li>
<li>SurfaceFlingerçš„åˆæˆå¾ªç¯æ ¸å¿ƒæµç¨‹</li>
<li>å®ç”¨çš„è°ƒè¯•æŠ€å·§å’Œé—®é¢˜æ’æŸ¥æ–¹æ³•</li>
<li>Android 15çš„æ˜¾ç¤ºç³»ç»Ÿæ–°ç‰¹æ€§</li>
</ul>
<h3 data-id="heading-2">å‰ç½®çŸ¥è¯†</h3>
<ul>
<li>Androidåº”ç”¨å¼€å‘åŸºç¡€ï¼ˆå››å¤§ç»„ä»¶ã€Viewç»˜åˆ¶æµç¨‹ï¼‰</li>
<li>åŸºæœ¬çš„Linuxè¿›ç¨‹é—´é€šä¿¡æ¦‚å¿µ</li>
<li>å›¾å½¢å­¦åŸºç¡€æ¦‚å¿µï¼ˆå¸§ç¼“å†²ã€åŒç¼“å†²ç­‰ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-3">Androidæ˜¾ç¤ºç³»ç»Ÿæ¶æ„æ€»è§ˆ</h2>
<p>Androidçš„æ˜¾ç¤ºç³»ç»Ÿé‡‡ç”¨ç»å…¸çš„åˆ†å±‚è®¾è®¡ï¼Œä»åº”ç”¨å±‚åˆ°ç¡¬ä»¶é©±åŠ¨å±‚å…±åˆ†ä¸ºå››å±‚ï¼Œæ¯ä¸€å±‚éƒ½æœ‰æ˜ç¡®çš„èŒè´£è¾¹ç•Œã€‚</p>
<h3 data-id="heading-4">æ˜¾ç¤ºæ ˆçš„åˆ†å±‚æ¶æ„</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bec8ea58ee554bfc8fb9011a2bea40f3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769258025&amp;x-signature=lTBvPLWeVV6IdxfJfII%2B8dhW4g4%3D" alt="01-01-android-display-architecture.png" loading="lazy"/></p>
<p><em>å›¾1: Androidæ˜¾ç¤ºç³»ç»Ÿçš„å››å±‚æ¶æ„</em></p>
<p>è®©æˆ‘ä»¬ä»ä¸Šåˆ°ä¸‹é€å±‚è§£æï¼š</p>
<h4 data-id="heading-5">1. åº”ç”¨å±‚ (Application Layer)</h4>
<p>åº”ç”¨å±‚æ˜¯å¼€å‘è€…æœ€ç†Ÿæ‚‰çš„éƒ¨åˆ†ï¼Œæä¾›äº†å¤šç§ç»˜åˆ¶APIï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// View/Canvas - æœ€å¸¸ç”¨çš„ç»˜åˆ¶æ–¹å¼</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomView</span>(context: Context) : View(context) {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onDraw</span><span class="hljs-params">(canvas: <span class="hljs-type">Canvas</span>)</span></span> {
        canvas.drawCircle(<span class="hljs-number">100f</span>, <span class="hljs-number">100f</span>, <span class="hljs-number">50f</span>, paint)
    }
}

<span class="hljs-comment">// SurfaceView - ç‹¬ç«‹Surfaceï¼Œæ”¯æŒå­çº¿ç¨‹ç»˜åˆ¶</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">GameView</span>(context: Context) : SurfaceView(context), SurfaceHolder.Callback {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">surfaceCreated</span><span class="hljs-params">(holder: <span class="hljs-type">SurfaceHolder</span>)</span></span> {
        <span class="hljs-comment">// åœ¨ç‹¬ç«‹çº¿ç¨‹ä¸­ç»˜åˆ¶</span>
        thread {
            <span class="hljs-keyword">val</span> canvas = holder.lockCanvas()
            <span class="hljs-comment">// ç»˜åˆ¶æ¸¸æˆç”»é¢</span>
            holder.unlockCanvasAndPost(canvas)
        }
    }
}

<span class="hljs-comment">// TextureView - å¯ä»¥åƒæ™®é€šViewä¸€æ ·å˜æ¢</span>
<span class="hljs-keyword">val</span> textureView = TextureView(context)
textureView.surfaceTextureListener = <span class="hljs-keyword">object</span> : SurfaceTextureListener {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSurfaceTextureAvailable</span><span class="hljs-params">(surface: <span class="hljs-type">SurfaceTexture</span>, width: <span class="hljs-type">Int</span>, height: <span class="hljs-type">Int</span>)</span></span> {
        <span class="hljs-comment">// ç»˜åˆ¶é€»è¾‘</span>
    }
}
</code></pre>
<p><strong>ä¸‰ç§ç»˜åˆ¶æ–¹å¼çš„åŒºåˆ«</strong>ï¼š</p>
<ul>
<li><strong>View/Canvas</strong>: æœ€ç®€å•ï¼Œä½†åªèƒ½åœ¨UIçº¿ç¨‹ç»˜åˆ¶ï¼Œé€‚åˆé™æ€å†…å®¹</li>
<li><strong>SurfaceView</strong>: æ‹¥æœ‰ç‹¬ç«‹Surfaceï¼Œå¯å­çº¿ç¨‹ç»˜åˆ¶ï¼Œé€‚åˆæ¸¸æˆå’Œè§†é¢‘</li>
<li><strong>TextureView</strong>: åŸºäºSurfaceTextureï¼Œæ”¯æŒViewå˜æ¢ï¼ˆæ—‹è½¬ã€ç¼©æ”¾ï¼‰ï¼Œä½†æ€§èƒ½ç•¥ä½</li>
</ul>
<h4 data-id="heading-6">2. Frameworkå±‚ (Framework Layer)</h4>
<p>Frameworkå±‚è´Ÿè´£ç®¡ç†çª—å£å’Œåè°ƒç»˜åˆ¶ï¼š</p>
<p><strong>WindowManager</strong>: çª—å£ç®¡ç†å™¨ï¼Œè´Ÿè´£Windowçš„æ·»åŠ ã€åˆ é™¤å’Œå¸ƒå±€</p>
<ul>
<li>æ¯ä¸ªActivityã€Dialogã€PopupWindowéƒ½å¯¹åº”ä¸€ä¸ªWindow</li>
<li>ç®¡ç†Windowçš„Z-orderï¼ˆå±‚çº§é¡ºåºï¼‰</li>
<li>ä¸WindowManagerServiceé€šä¿¡</li>
</ul>
<p><strong>ViewRootImpl</strong>: è¿æ¥Viewå’ŒWindowManagerçš„æ¡¥æ¢</p>
<ul>
<li>æ¯ä¸ªWindowéƒ½æœ‰ä¸€ä¸ªViewRootImpl</li>
<li>è´Ÿè´£Viewæ ‘çš„measureã€layoutã€draw</li>
<li>ç®¡ç†Surfaceçš„åˆ›å»ºå’Œæ›´æ–°</li>
<li>å¤„ç†è¾“å…¥äº‹ä»¶åˆ†å‘</li>
</ul>
<p><strong>Surface (Javaå±‚)</strong>: è·¨è¿›ç¨‹ç»˜åˆ¶çš„"ç”»å¸ƒ"</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// frameworks/base/core/java/android/view/Surface.java</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Surface</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Parcelable</span> {
    <span class="hljs-comment">// Nativeå±‚Surfaceçš„å¼•ç”¨</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> mNativeObject;

    <span class="hljs-comment">// é”å®šç”»å¸ƒè¿›è¡Œç»˜åˆ¶</span>
    <span class="hljs-keyword">public</span> Canvas <span class="hljs-title function_">lockCanvas</span><span class="hljs-params">(Rect inOutDirty)</span> {
        <span class="hljs-comment">// ä»BufferQueueè·å–GraphicBuffer</span>
        <span class="hljs-comment">// è¿”å›Canvasä¾›åº”ç”¨ç»˜åˆ¶</span>
    }

    <span class="hljs-comment">// æäº¤ç»˜åˆ¶ç»“æœ</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlockCanvasAndPost</span><span class="hljs-params">(Canvas canvas)</span> {
        <span class="hljs-comment">// å°†GraphicBufferæäº¤åˆ°BufferQueue</span>
    }
}
</code></pre>
<h4 data-id="heading-7">3. Nativeå±‚ (Native Layer)</h4>
<p>Nativeå±‚æ˜¯æ˜¾ç¤ºç³»ç»Ÿçš„æ ¸å¿ƒï¼Œä¸»è¦åŒ…å«ï¼š</p>
<p><strong>SurfaceFlinger</strong>: ç³»ç»ŸåˆæˆæœåŠ¡ï¼Œæœ¬æ–‡é‡ç‚¹è®²è§£å¯¹è±¡</p>
<ul>
<li>è¿è¡Œåœ¨ç‹¬ç«‹è¿›ç¨‹ï¼ˆPIDé€šå¸¸è¾ƒå°ï¼‰</li>
<li>è´Ÿè´£æ‰€æœ‰Layerçš„åˆæˆ</li>
<li>é©±åŠ¨æ•´ä¸ªæ¸²æŸ“ç®¡çº¿</li>
</ul>
<p><strong>BufferQueue</strong>: ç”Ÿäº§è€…-æ¶ˆè´¹è€…é˜Ÿåˆ—</p>
<ul>
<li>åº”ç”¨ï¼ˆProducerï¼‰è´Ÿè´£ç”Ÿäº§GraphicBuffer</li>
<li>SurfaceFlingerï¼ˆConsumerï¼‰è´Ÿè´£æ¶ˆè´¹GraphicBuffer</li>
<li>å…¸å‹é…ç½®ï¼š2-3ä¸ªBufferï¼ˆåŒç¼“å†²/ä¸‰é‡ç¼“å†²ï¼‰</li>
</ul>
<p><strong>GraphicBuffer</strong>: è·¨è¿›ç¨‹å…±äº«çš„å›¾å½¢ç¼“å†²åŒº</p>
<ul>
<li>åŸºäºåŒ¿åå…±äº«å†…å­˜(ashmem)æˆ–ION</li>
<li>é€šè¿‡Gralloc HALåˆ†é…</li>
<li>å¯åŒæ—¶è¢«CPUå’ŒGPUè®¿é—®</li>
</ul>
<p><strong>HWC (Hardware Composer)</strong>: ç¡¬ä»¶åˆæˆå™¨</p>
<ul>
<li>ç”±ç¡¬ä»¶å‚å•†å®ç°çš„HALå±‚</li>
<li>å¯ä»¥åˆ©ç”¨ç¡¬ä»¶åŠ é€ŸåˆæˆLayer</li>
<li>Android 15ä½¿ç”¨HWC 3.0ç‰ˆæœ¬</li>
</ul>
<h4 data-id="heading-8">4. é©±åŠ¨å±‚ (Driver Layer)</h4>
<p><strong>Display Driver</strong>: æ˜¾ç¤ºé©±åŠ¨</p>
<ul>
<li>æ§åˆ¶å±å¹•æ˜¾ç¤ºæ—¶åº</li>
<li>äº§ç”Ÿç¡¬ä»¶Vsyncä¿¡å·</li>
<li>ç®¡ç†æ˜¾ç¤ºæ¨¡å¼ï¼ˆåˆ†è¾¨ç‡ã€åˆ·æ–°ç‡ï¼‰</li>
</ul>
<p><strong>GPU Driver</strong>: å›¾å½¢å¤„ç†å™¨é©±åŠ¨</p>
<ul>
<li>æ‰§è¡ŒOpenGL ES / VulkanæŒ‡ä»¤</li>
<li>è¿›è¡Œå›¾å½¢æ¸²æŸ“</li>
<li>ä¸Display DriverååŒå·¥ä½œ</li>
</ul>
<h3 data-id="heading-9">ä»åº”ç”¨ç»˜åˆ¶åˆ°å±å¹•æ˜¾ç¤ºçš„å®Œæ•´æµç¨‹</h3>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œç†è§£æ•°æ®æ˜¯å¦‚ä½•ä»åº”ç”¨æµå‘å±å¹•çš„ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// 1. åº”ç”¨å±‚ï¼šå¼€å‘è€…è°ƒç”¨View.invalidate()</span>
customView.invalidate()

<span class="hljs-comment">// 2. Frameworkå±‚ï¼šViewRootImplè°ƒåº¦ç»˜åˆ¶</span>
<span class="hljs-comment">// ViewRootImpl.scheduleTraversals()</span>
<span class="hljs-comment">//   â†’ Choreographer.postCallback(CALLBACK_TRAVERSAL)</span>
<span class="hljs-comment">//   â†’ ç­‰å¾…Vsyncä¿¡å·</span>

<span class="hljs-comment">// 3. Vsyncä¿¡å·åˆ°è¾¾</span>
<span class="hljs-comment">//   â†’ ViewRootImpl.doTraversal()</span>
<span class="hljs-comment">//   â†’ performDraw()</span>
<span class="hljs-comment">//   â†’ drawSoftware() æˆ– drawHardware()</span>

<span class="hljs-comment">// 4. ç»˜åˆ¶åˆ°Surface</span>
<span class="hljs-comment">//   â†’ Canvas canvas = surface.lockCanvas()</span>
<span class="hljs-comment">//   â†’ view.draw(canvas)  // æ‰§è¡ŒonDraw()</span>
<span class="hljs-comment">//   â†’ surface.unlockCanvasAndPost(canvas)</span>

<span class="hljs-comment">// 5. Nativeå±‚ï¼šBufferæäº¤åˆ°BufferQueue</span>
<span class="hljs-comment">//   â†’ BufferQueue.queueBuffer()</span>
<span class="hljs-comment">//   â†’ é€šçŸ¥SurfaceFlingeræœ‰æ–°å†…å®¹</span>

<span class="hljs-comment">// 6. SurfaceFlingeråˆæˆ</span>
<span class="hljs-comment">//   â†’ ä»BufferQueueè·å–Buffer</span>
<span class="hljs-comment">//   â†’ å†³å®šGPUåˆæˆè¿˜æ˜¯HWCåˆæˆ</span>
<span class="hljs-comment">//   â†’ å°†æ‰€æœ‰Layeråˆæˆåˆ°FrameBuffer</span>

<span class="hljs-comment">// 7. é©±åŠ¨å±‚ï¼šè¾“å‡ºåˆ°å±å¹•</span>
<span class="hljs-comment">//   â†’ Display Driveræ˜¾ç¤ºFrameBufferå†…å®¹</span>
</code></pre>

**å°çŸ¥è¯†**: åœ¨Androidç³»ç»Ÿä¸­ï¼Œå‡ ä¹æ‰€æœ‰çš„æ¸²æŸ“éƒ½ä¼šèµ°SurfaceFlingerè¿›è¡Œåˆæˆï¼ŒåŒ…æ‹¬SystemUIï¼ˆçŠ¶æ€æ ã€å¯¼èˆªæ ï¼‰ã€Wallpaperï¼ˆå£çº¸ï¼‰ã€ä»¥åŠæ‰€æœ‰åº”ç”¨çª—å£ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆSurfaceFlingeræ€§èƒ½å¦‚æ­¤å…³é”®çš„åŸå› ã€‚

<h3 data-id="heading-10">Android 15æ˜¾ç¤ºç³»ç»Ÿçš„æ–°ç‰¹æ€§</h3>
<p>Android 15åœ¨æ˜¾ç¤ºç³»ç»Ÿæ–¹é¢è¿›è¡Œäº†å¤šé¡¹é‡è¦ä¼˜åŒ–ï¼š</p>
<p><strong>1. Canvasç°ä»£åŒ–æ”¹é€ </strong></p>
<ul>
<li>å¼•å…¥CanvasKitï¼ˆåŸºäºSkiaçš„Webæ¸²æŸ“å¼•æ“ï¼‰</li>
<li>æ”¹è¿›Canvas APIæ€§èƒ½</li>
<li>æ›´å¥½çš„æ–‡æœ¬æ¸²æŸ“æ•ˆæœ</li>
</ul>
<p><strong>2. HWC 3.0æ”¯æŒ</strong></p>
<ul>
<li>æ›´çµæ´»çš„Layeråˆæˆç­–ç•¥</li>
<li>æ”¹è¿›çš„è‰²å½©ç®¡ç†</li>
<li>æ›´ä½çš„åŠŸè€—</li>
</ul>
<p><strong>3. åŠ¨æ€åˆ·æ–°ç‡ä¼˜åŒ–</strong></p>
<ul>
<li>æ›´æ™ºèƒ½çš„åˆ·æ–°ç‡åˆ‡æ¢</li>
<li>å‡å°‘ä¸å¿…è¦çš„é«˜åˆ·æ–°ç‡</li>
<li>æ”¹å–„ç”µæ± ç»­èˆª</li>
</ul>
<p><strong>4. HDRæ”¯æŒå¢å¼º</strong></p>
<ul>
<li>æ›´å®Œå–„çš„HDR10+æ”¯æŒ</li>
<li>æ”¹è¿›çš„è‰²å½©ç©ºé—´è½¬æ¢</li>
<li>æ›´å¥½çš„HDRå†…å®¹æ˜¾ç¤ºæ•ˆæœ</li>
</ul>
<hr/>
<h2 data-id="heading-11">SurfaceFlingeræœåŠ¡å¯åŠ¨ä¸åˆå§‹åŒ–</h2>
<p>SurfaceFlingerä½œä¸ºAndroidæ˜¾ç¤ºç³»ç»Ÿçš„æ ¸å¿ƒæœåŠ¡ï¼Œå…¶å¯åŠ¨å’Œåˆå§‹åŒ–è¿‡ç¨‹å¥ å®šäº†æ•´ä¸ªæ˜¾ç¤ºç³»ç»Ÿçš„åŸºç¡€ã€‚</p>
<h3 data-id="heading-12">SurfaceFlingerçš„å¯åŠ¨æ—¶æœº</h3>
<p>SurfaceFlingerç”±initè¿›ç¨‹åœ¨ç³»ç»Ÿå¯åŠ¨æ—©æœŸæ‹‰èµ·ï¼Œå…¶å¯åŠ¨é…ç½®å®šä¹‰åœ¨<code>surfaceflinger.rc</code>ä¸­ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># frameworks/native/services/surfaceflinger/surfaceflinger.rc</span>
service surfaceflinger /system/bin/surfaceflinger
    class core animation
    user system
    group graphics drmrpc readproc
    capabilities SYS_NICE
    onrestart restart --only-if-running zygote
    task_profiles HighPerformance
    socket pdx/system/vr/display/client     stream 0666 system graphics u:object_r:pdx_display_client_endpoint_socket:s0
    socket pdx/system/vr/display/manager    stream 0666 system graphics u:object_r:pdx_display_manager_endpoint_socket:s0
    socket pdx/system/vr/display/vsync      stream 0666 system graphics u:object_r:pdx_display_vsync_endpoint_socket:s0
</code></pre>
<p><strong>å…³é”®é…ç½®è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>class core animation</code>: å±äºæ ¸å¿ƒæœåŠ¡ï¼Œåœ¨<code>animation</code>ç±»å¯åŠ¨</li>
<li><code>user system</code>: ä»¥systemç”¨æˆ·èº«ä»½è¿è¡Œ</li>
<li><code>group graphics</code>: æ‹¥æœ‰graphicsç»„æƒé™ï¼Œå¯è®¿é—®GPUè®¾å¤‡</li>
<li><code>task_profiles HighPerformance</code>: é«˜æ€§èƒ½è°ƒåº¦ç­–ç•¥</li>
<li><code>onrestart restart --only-if-running zygote</code>: å¦‚æœå´©æºƒï¼Œé‡å¯Zygoteï¼ˆå› ä¸ºæ‰€æœ‰åº”ç”¨éƒ½ä¾èµ–å®ƒï¼‰</li>
</ul>
<h3 data-id="heading-13">æœåŠ¡å¯åŠ¨æµç¨‹</h3>
<p>SurfaceFlingerçš„å¯åŠ¨ä»<code>main.cpp</code>å¼€å§‹ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// frameworks/native/services/surfaceflinger/main_surfaceflinger.cpp</span>
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span>, <span class="hljs-type">char</span>**)</span> </span>{
    <span class="hljs-comment">// è®¾ç½®çº¿ç¨‹ä¼˜å…ˆçº§</span>
    <span class="hljs-built_in">signal</span>(SIGPIPE, SIG_IGN);

    <span class="hljs-comment">// åˆ›å»ºProcessStateï¼ˆBinderé€šä¿¡åŸºç¡€ï¼‰</span>
    <span class="hljs-function">sp&lt;ProcessState&gt; <span class="hljs-title">ps</span><span class="hljs-params">(ProcessState::self())</span></span>;
    ps-&gt;<span class="hljs-built_in">setThreadPoolMaxThreadCount</span>(<span class="hljs-number">4</span>);
    ps-&gt;<span class="hljs-built_in">startThreadPool</span>();

    <span class="hljs-comment">// åˆ›å»ºSurfaceFlingerå®ä¾‹</span>
    sp&lt;SurfaceFlinger&gt; flinger = surfaceflinger::<span class="hljs-built_in">createSurfaceFlinger</span>();

    <span class="hljs-comment">// è®¾ç½®ä¸ºç³»ç»ŸæœåŠ¡</span>
    flinger-&gt;<span class="hljs-built_in">init</span>();

    <span class="hljs-comment">// æ³¨å†Œåˆ°ServiceManager</span>
    <span class="hljs-function">sp&lt;IServiceManager&gt; <span class="hljs-title">sm</span><span class="hljs-params">(defaultServiceManager())</span></span>;
    sm-&gt;<span class="hljs-built_in">addService</span>(<span class="hljs-built_in">String16</span>(SurfaceFlinger::<span class="hljs-built_in">getServiceName</span>()), flinger,
                   <span class="hljs-literal">false</span>, IServiceManager::DUMP_FLAG_PRIORITY_CRITICAL |
                          IServiceManager::DUMP_FLAG_PROTO);

    <span class="hljs-comment">// å¯åŠ¨çº¿ç¨‹æ± </span>
    <span class="hljs-built_in">startDisplayService</span>(); <span class="hljs-comment">// dependency on SF getting registered above</span>

    <span class="hljs-comment">// è¿è¡Œä¸»å¾ªç¯</span>
    flinger-&gt;<span class="hljs-built_in">run</span>();

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 data-id="heading-14">æ ¸å¿ƒæ•°æ®ç»“æ„åˆå§‹åŒ–</h3>
<p>åœ¨<code>SurfaceFlinger::init()</code>ä¸­ï¼Œä¼šåˆå§‹åŒ–å¤§é‡æ ¸å¿ƒç»„ä»¶ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// frameworks/native/services/surfaceflinger/SurfaceFlinger.cpp (ç®€åŒ–)</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SurfaceFlinger::init</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">ALOGI</span>(<span class="hljs-string">"SurfaceFlinger is starting"</span>);

    <span class="hljs-comment">// 1. åˆ›å»ºHWComposerï¼ˆç¡¬ä»¶åˆæˆå™¨ï¼‰</span>
    mCompositionEngine-&gt;<span class="hljs-built_in">setHwComposer</span>(<span class="hljs-built_in">getFactory</span>().<span class="hljs-built_in">createHWComposer</span>(mHwcServiceName));

    <span class="hljs-comment">// 2. åˆ›å»ºRenderEngineï¼ˆGPUæ¸²æŸ“å¼•æ“ï¼‰</span>
    mCompositionEngine-&gt;<span class="hljs-built_in">setRenderEngine</span>(
        renderengine::RenderEngine::<span class="hljs-built_in">create</span>(
            renderengine::RenderEngineCreationArgs::<span class="hljs-built_in">Builder</span>()
                .<span class="hljs-built_in">setPixelFormat</span>(defaultCompositionPixelFormat)
                .<span class="hljs-built_in">setImageCacheSize</span>(maxFrameBufferAcquiredBuffers)
                .<span class="hljs-built_in">setUseColorManagerment</span>(useColorManagement)
                .<span class="hljs-built_in">setEnableProtectedContext</span>(<span class="hljs-built_in">enable_protected_contents</span>(<span class="hljs-literal">false</span>))
                .<span class="hljs-built_in">setPrecacheToneMapperShaderOnly</span>(<span class="hljs-literal">false</span>)
                .<span class="hljs-built_in">setSupportsBackgroundBlur</span>(mSupportsBlur)
                .<span class="hljs-built_in">setContextPriority</span>(useContextPriority
                    ? renderengine::RenderEngine::ContextPriority::REALTIME
                    : renderengine::RenderEngine::ContextPriority::MEDIUM)
                .<span class="hljs-built_in">build</span>()));

    <span class="hljs-comment">// 3. åˆ›å»ºSchedulerï¼ˆè°ƒåº¦å™¨ï¼Œç®¡ç†Vsyncï¼‰</span>
    mScheduler = <span class="hljs-built_in">getFactory</span>().<span class="hljs-built_in">createScheduler</span>(...)

    <span class="hljs-comment">// 4. åˆå§‹åŒ–DisplayDevice</span>
    <span class="hljs-built_in">initializeDisplays</span>();

    <span class="hljs-comment">// 5. åˆ›å»ºEventThreadï¼ˆäº‹ä»¶çº¿ç¨‹ï¼‰</span>
    mEventThreads.<span class="hljs-built_in">push_back</span>(
        mScheduler-&gt;<span class="hljs-built_in">makeEventThread</span>(<span class="hljs-string">"app"</span>, ...));  <span class="hljs-comment">// app-vsync</span>
    mEventThreads.<span class="hljs-built_in">push_back</span>(
        mScheduler-&gt;<span class="hljs-built_in">makeEventThread</span>(<span class="hljs-string">"appSf"</span>, ...)); <span class="hljs-comment">// sf-vsync</span>

    <span class="hljs-comment">// 6. å¯åŠ¨åˆæˆå¾ªç¯</span>
    mScheduler-&gt;<span class="hljs-built_in">startThin</span>();

    <span class="hljs-built_in">ALOGI</span>(<span class="hljs-string">"SurfaceFlinger init completed"</span>);
}
</code></pre>
<p><strong>æ ¸å¿ƒç»„ä»¶è¯´æ˜</strong>ï¼š</p>
<p><strong>HWComposer (Hardware Composer)</strong></p>
<ul>
<li>ä¸ç¡¬ä»¶åˆæˆå™¨HALäº¤äº’</li>
<li>ç®¡ç†Displayè®¾å¤‡</li>
<li>å†³å®šLayerçš„åˆæˆç­–ç•¥ï¼ˆGPU vs ç¡¬ä»¶ï¼‰</li>
</ul>
<p><strong>RenderEngine</strong></p>
<ul>
<li>å°è£…GPUæ¸²æŸ“èƒ½åŠ›</li>
<li>é€šå¸¸åŸºäºOpenGL ESæˆ–Skia</li>
<li>è´Ÿè´£GPUåˆæˆè·¯å¾„</li>
</ul>
<p><strong>Scheduler</strong></p>
<ul>
<li>ç®¡ç†Vsyncä¿¡å·</li>
<li>è°ƒåº¦åˆæˆæ—¶æœº</li>
<li>æ§åˆ¶åˆ·æ–°ç‡</li>
</ul>
<p><strong>EventThread</strong></p>
<ul>
<li>åˆ†å‘Vsyncäº‹ä»¶</li>
<li><code>app-vsync</code>: é€šçŸ¥åº”ç”¨å±‚ï¼ˆChoreographerï¼‰</li>
<li><code>sf-vsync</code>: é€šçŸ¥SurfaceFlingerè‡ªå·±</li>
</ul>
<h3 data-id="heading-15">ä¸ç³»ç»ŸæœåŠ¡çš„äº¤äº’</h3>
<p>SurfaceFlingeréœ€è¦ä¸å¤šä¸ªç³»ç»ŸæœåŠ¡åä½œï¼š</p>
<p><strong>1. å‘ServiceManageræ³¨å†Œ</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// æ³¨å†Œä¸ºISurfaceComposeræœåŠ¡</span>
sm-&gt;<span class="hljs-built_in">addService</span>(<span class="hljs-built_in">String16</span>(<span class="hljs-string">"SurfaceFlinger"</span>), flinger, ...)
</code></pre>
<p>å…¶ä»–è¿›ç¨‹å¯é€šè¿‡ä»¥ä¸‹æ–¹å¼è·å–SurfaceFlingeræœåŠ¡ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp">sp&lt;ISurfaceComposer&gt; sf = <span class="hljs-built_in">interface_cast</span>&lt;ISurfaceComposer&gt;(
    <span class="hljs-built_in">defaultServiceManager</span>()-&gt;<span class="hljs-built_in">getService</span>(<span class="hljs-built_in">String16</span>(<span class="hljs-string">"SurfaceFlinger"</span>)));
</code></pre>
<p><strong>2. ä¸WindowManagerServiceåä½œ</strong></p>
<ul>
<li>WMSè´Ÿè´£çª—å£ç®¡ç†å’Œç­–ç•¥å†³ç­–</li>
<li>SurfaceFlingerè´Ÿè´£å®é™…çš„å›¾å½¢åˆæˆ</li>
<li>é€šè¿‡Binder IPCè¿›è¡Œé€šä¿¡</li>
</ul>
<p><strong>3. æ¥æ”¶ç¡¬ä»¶Vsync</strong></p>
<ul>
<li>ä»Display Driveræ¥æ”¶ç¡¬ä»¶Vsyncä¸­æ–­</li>
<li>é€šè¿‡HWC HALä¼ é€’ç»™SurfaceFlinger</li>
<li>é©±åŠ¨æ•´ä¸ªæ¸²æŸ“ç®¡çº¿</li>
</ul>
<hr/>
<h2 data-id="heading-16">Surfaceåˆ›å»ºä¸ç®¡ç†æœºåˆ¶</h2>
<p>Surfaceæ˜¯Androidæ˜¾ç¤ºç³»ç»Ÿä¸­æœ€æ ¸å¿ƒçš„æ¦‚å¿µä¹‹ä¸€ï¼Œç†è§£Surfaceçš„æœ¬è´¨å’Œç®¡ç†æœºåˆ¶æ˜¯æŒæ¡æ˜¾ç¤ºç³»ç»Ÿçš„å…³é”®ã€‚</p>
<h3 data-id="heading-17">Surfaceçš„æœ¬è´¨ï¼šè·¨è¿›ç¨‹å…±äº«çš„ç”»å¸ƒ</h3>
<p><strong>Surfaceæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè·¨è¿›ç¨‹å…±äº«çš„ç»˜åˆ¶ç¼“å†²åŒºçš„å°è£…</strong>ã€‚å®ƒè¿æ¥äº†ä¸¤ä¸ªè§’è‰²ï¼š</p>
<ul>
<li><strong>ç”Ÿäº§è€…ï¼ˆProducerï¼‰</strong>: åº”ç”¨è¿›ç¨‹ï¼Œè´Ÿè´£ç»˜åˆ¶å†…å®¹</li>
<li><strong>æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰</strong>: SurfaceFlingerè¿›ç¨‹ï¼Œè´Ÿè´£åˆæˆæ˜¾ç¤º</li>
</ul>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// Surfaceçš„æ ¸å¿ƒç»“æ„ï¼ˆç®€åŒ–ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Surface</span> {
    <span class="hljs-comment">// æŒ‡å‘Nativeå±‚Surfaceå¯¹è±¡</span>
    sp&lt;IGraphicBufferProducer&gt; mGraphicBufferProducer;

    <span class="hljs-comment">// å½“å‰æ­£åœ¨ä½¿ç”¨çš„GraphicBuffer</span>
    sp&lt;GraphicBuffer&gt; mLockedBuffer;

    <span class="hljs-comment">// BufferQueueçš„é…ç½®</span>
    <span class="hljs-type">uint32_t</span> mReqWidth;
    <span class="hljs-type">uint32_t</span> mReqHeight;
    PixelFormat mReqFormat;
};
</code></pre>
<h3 data-id="heading-18">Surfaceåˆ›å»ºæµç¨‹è¯¦è§£</h3>
<p>è®©æˆ‘ä»¬è·Ÿè¸ªä¸€ä¸ªActivityçª—å£çš„Surfaceåˆ›å»ºå…¨è¿‡ç¨‹ï¼š</p>
<h4 data-id="heading-19">1. åº”ç”¨ä¾§ï¼šActivityå¯åŠ¨</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Activity.onCreate()è¢«è°ƒç”¨å</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">Activity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)
        <span class="hljs-comment">// æ­¤æ—¶è¿˜æ²¡æœ‰Surface</span>
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onResume</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onResume()
        <span class="hljs-comment">// ViewRootImplå·²åˆ›å»ºï¼ŒSurfaceå³å°†åˆ›å»º</span>
    }
}
</code></pre>
<h4 data-id="heading-20">2. Frameworkä¾§ï¼šViewRootImplåˆ›å»ºSurface</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// frameworks/base/core/java/android/view/ViewRootImpl.java (ç®€åŒ–)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewRootImpl</span> {
    <span class="hljs-keyword">final</span> <span class="hljs-type">Surface</span> <span class="hljs-variable">mSurface</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Surface</span>(); <span class="hljs-comment">// åˆ›å»ºSurfaceå¯¹è±¡</span>

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">performTraversals</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ç¬¬ä¸€æ¬¡å¸ƒå±€æ—¶ï¼Œè¯·æ±‚åˆ›å»ºSurface</span>
        <span class="hljs-keyword">if</span> (mSurfaceHolder == <span class="hljs-literal">null</span>) {
            relayoutWindow(params, viewVisibility, insetsPending);
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">relayoutWindow</span><span class="hljs-params">(WindowManager.LayoutParams params, ...)</span> {
        <span class="hljs-comment">// é€šè¿‡WMSè¯·æ±‚SurfaceFlingeråˆ›å»ºSurface</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">relayoutResult</span> <span class="hljs-operator">=</span> mWindowSession.relayout(
            mWindow, params, ..., mSurface); <span class="hljs-comment">// mSurfaceä½œä¸ºè¾“å‡ºå‚æ•°</span>

        <span class="hljs-keyword">return</span> relayoutResult;
    }
}
</code></pre>
<h4 data-id="heading-21">3. Nativeä¾§ï¼šSurfaceFlingeråˆ›å»ºLayerå’ŒBufferQueue</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// frameworks/native/services/surfaceflinger/SurfaceFlinger.cpp (ç®€åŒ–)</span>
<span class="hljs-function"><span class="hljs-type">status_t</span> <span class="hljs-title">SurfaceFlinger::createLayer</span><span class="hljs-params">(<span class="hljs-type">const</span> String8&amp; name,
                                     <span class="hljs-type">const</span> sp&lt;Client&gt;&amp; client,
                                     <span class="hljs-type">uint32_t</span> w, <span class="hljs-type">uint32_t</span> h,
                                     PixelFormat format,
                                     <span class="hljs-type">uint32_t</span> flags,
                                     sp&lt;IBinder&gt;* handle,
                                     sp&lt;IGraphicBufferProducer&gt;* gbp)</span> </span>{
    <span class="hljs-comment">// 1. åˆ›å»ºLayerå¯¹è±¡</span>
    sp&lt;Layer&gt; layer;
    <span class="hljs-keyword">switch</span> (flags &amp; ISurfaceComposerClient::eFXSurfaceMask) {
        <span class="hljs-keyword">case</span> ISurfaceComposerClient::eFXSurfaceBufferQueue:
            <span class="hljs-comment">// æ™®é€šçš„Buffer Layer</span>
            layer = <span class="hljs-keyword">new</span> <span class="hljs-built_in">BufferQueueLayer</span>(<span class="hljs-keyword">this</span>, client, name, w, h, flags);
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> ISurfaceComposerClient::eFXSurfaceEffect:
            <span class="hljs-comment">// ç‰¹æ•ˆLayerï¼ˆå¦‚æ¨¡ç³Šã€é¢œè‰²ï¼‰</span>
            layer = <span class="hljs-keyword">new</span> <span class="hljs-built_in">EffectLayer</span>(<span class="hljs-keyword">this</span>, client, name, w, h, flags);
            <span class="hljs-keyword">break</span>;
    }

    <span class="hljs-comment">// 2. åˆ›å»ºBufferQueue</span>
    sp&lt;IGraphicBufferProducer&gt; producer;
    sp&lt;IGraphicBufferConsumer&gt; consumer;
    BufferQueue::<span class="hljs-built_in">createBufferQueue</span>(&amp;producer, &amp;consumer);

    <span class="hljs-comment">// 3. Layerä¸BufferQueueå…³è”</span>
    layer-&gt;<span class="hljs-built_in">setBufferConsumer</span>(consumer);

    <span class="hljs-comment">// 4. è¿”å›ç»™åº”ç”¨</span>
    *handle = layer-&gt;<span class="hljs-built_in">getHandle</span>();
    *gbp = producer; <span class="hljs-comment">// è¿”å›Produceræ¥å£</span>

    <span class="hljs-comment">// 5. å°†LayeråŠ å…¥Layeræ ‘</span>
    mCurrentState.layersSortedByZ.<span class="hljs-built_in">add</span>(layer);

    <span class="hljs-keyword">return</span> NO_ERROR;
}
</code></pre>
<p><strong>åˆ›å»ºæµç¨‹æ€»ç»“</strong>ï¼š</p>
<ol>
<li>Activityå¯åŠ¨ â†’ ViewRootImplåˆ›å»º</li>
<li>ViewRootImplé€šè¿‡WMSè¯·æ±‚åˆ›å»ºSurface</li>
<li>SurfaceFlingeråˆ›å»ºå¯¹åº”çš„Layerå’ŒBufferQueue</li>
<li>IGraphicBufferProducerè¿”å›ç»™åº”ç”¨</li>
<li>åº”ç”¨é€šè¿‡Produceræ¥å£è¿›è¡Œç»˜åˆ¶</li>
</ol>
<h3 data-id="heading-22">Layerçš„ç±»å‹ä¸ç®¡ç†</h3>
<p>åœ¨SurfaceFlingerå†…éƒ¨ï¼Œæ¯ä¸ªSurfaceå¯¹åº”ä¸€ä¸ªLayerã€‚Androidå®šä¹‰äº†å¤šç§Layerç±»å‹ï¼š</p>
<p><strong>BufferQueueLayerï¼ˆæœ€å¸¸è§ï¼‰</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BufferQueueLayer</span> : <span class="hljs-keyword">public</span> BufferLayer {
    <span class="hljs-comment">// æŒæœ‰BufferQueueçš„Consumerç«¯</span>
    sp&lt;BufferQueueConsumer&gt; mConsumer;

    <span class="hljs-comment">// Layerçš„å±æ€§</span>
    Rect mBounds;          <span class="hljs-comment">// ä½ç½®å’Œå¤§å°</span>
    <span class="hljs-type">float</span> mAlpha;          <span class="hljs-comment">// é€æ˜åº¦</span>
    <span class="hljs-type">int32_t</span> mZOrder;       <span class="hljs-comment">// Zè½´é¡ºåº</span>
    mat4 mTransform;       <span class="hljs-comment">// å˜æ¢çŸ©é˜µ</span>
};
</code></pre>
<p><strong>EffectLayerï¼ˆç‰¹æ•ˆLayerï¼‰</strong></p>
<ul>
<li>ç”¨äºé¢œè‰²å¡«å……ã€æ¨¡ç³Šæ•ˆæœç­‰</li>
<li>ä¸éœ€è¦BufferQueue</li>
<li>ç›´æ¥ç”±GPUæ¸²æŸ“ç‰¹æ•ˆ</li>
</ul>
<p><strong>ContainerLayerï¼ˆå®¹å™¨Layerï¼‰</strong></p>
<ul>
<li>ä¸åŒ…å«å®é™…å†…å®¹</li>
<li>ç”¨äºç»„ç»‡Layerå±‚çº§</li>
<li>ä¾‹å¦‚ï¼šActivityRecordçš„æ ¹Layer</li>
</ul>
<h3 data-id="heading-23">Layeræ ‘çš„ç»„ç»‡ç»“æ„</h3>
<p>æ‰€æœ‰Layerç»„ç»‡æˆä¸€æ£µæ ‘ï¼Œæ ¹æ®Z-orderè¿›è¡Œæ’åºï¼š</p>
<pre><code class="hljs language-ini" lang="ini">RootLayer
  â”œâ”€â”€ WallpaperLayer (<span class="hljs-attr">Z</span>=-<span class="hljs-number">1</span>)
  â”œâ”€â”€ AppLayer1 (<span class="hljs-attr">Z</span>=<span class="hljs-number">0</span>)
  â”‚     â”œâ”€â”€ SurfaceView1 (<span class="hljs-attr">Z</span>=<span class="hljs-number">0</span>)
  â”‚     â””â”€â”€ SurfaceView2 (<span class="hljs-attr">Z</span>=<span class="hljs-number">1</span>)
  â”œâ”€â”€ AppLayer2 (<span class="hljs-attr">Z</span>=<span class="hljs-number">1</span>)
  â”œâ”€â”€ SystemUI (<span class="hljs-attr">Z</span>=<span class="hljs-number">100000</span>)
  â”‚     â”œâ”€â”€ StatusBar
  â”‚     â””â”€â”€ NavigationBar
  â””â”€â”€ BootAnimation (<span class="hljs-attr">Z</span>=<span class="hljs-number">200000</span>)
</code></pre>
<p><strong>Z-orderæ’åºè§„åˆ™</strong>ï¼š</p>
<ul>
<li>æ•°å€¼è¶Šå¤§ï¼Œè¶Šé è¿‘ç”¨æˆ·ï¼ˆæ˜¾ç¤ºåœ¨ä¸Šå±‚ï¼‰</li>
<li>SystemUIå±‚çº§æœ€é«˜ï¼Œå§‹ç»ˆæ˜¾ç¤ºåœ¨æœ€ä¸Šé¢</li>
<li>æ™®é€šåº”ç”¨çš„Z-orderé€šå¸¸åœ¨0é™„è¿‘</li>
<li>åŒä¸€çˆ¶Layerä¸‹çš„å­Layerï¼Œä¹Ÿæœ‰ç›¸å¯¹Z-order</li>
</ul>
<h3 data-id="heading-24">Layerçš„å…³é”®å±æ€§</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// Layerçš„æ ¸å¿ƒå±æ€§ï¼ˆç®€åŒ–ï¼‰</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">LayerState</span> {
    <span class="hljs-comment">// å‡ ä½•å±æ€§</span>
    Rect crop;              <span class="hljs-comment">// è£å‰ªåŒºåŸŸ</span>
    Rect frame;             <span class="hljs-comment">// æ˜¾ç¤ºåŒºåŸŸ</span>
    <span class="hljs-type">float</span> cornerRadius;     <span class="hljs-comment">// åœ†è§’åŠå¾„</span>
    mat4 matrix;            <span class="hljs-comment">// å˜æ¢çŸ©é˜µï¼ˆæ—‹è½¬ã€ç¼©æ”¾ã€å¹³ç§»ï¼‰</span>

    <span class="hljs-comment">// è§†è§‰å±æ€§</span>
    half4 color;            <span class="hljs-comment">// é¢œè‰²ï¼ˆRGBAï¼‰</span>
    <span class="hljs-type">float</span> alpha;            <span class="hljs-comment">// ä¸é€æ˜åº¦</span>
    <span class="hljs-type">uint32_t</span> flags;         <span class="hljs-comment">// æ ‡å¿—ä½ï¼ˆéšè—ã€å®‰å…¨ç­‰ï¼‰</span>

    <span class="hljs-comment">// åˆæˆå±æ€§</span>
    <span class="hljs-type">int32_t</span> z;              <span class="hljs-comment">// Zè½´é¡ºåº</span>
    <span class="hljs-type">uint32_t</span> layerStack;    <span class="hljs-comment">// æ‰€å±Display</span>

    <span class="hljs-comment">// å†…å®¹å±æ€§</span>
    sp&lt;GraphicBuffer&gt; buffer;         <span class="hljs-comment">// å½“å‰Buffer</span>
    sp&lt;Fence&gt; acquireFence;           <span class="hljs-comment">// åŒæ­¥Fence</span>
    Rect transparentRegion;           <span class="hljs-comment">// é€æ˜åŒºåŸŸ</span>
    Region opaqueRegion;              <span class="hljs-comment">// ä¸é€æ˜åŒºåŸŸ</span>
};
</code></pre>
<hr/>
<h2 data-id="heading-25">SurfaceFlingerçš„åˆæˆæµç¨‹</h2>
<p>SurfaceFlingerçš„åˆæˆæµç¨‹æ˜¯æ˜¾ç¤ºç³»ç»Ÿçš„æ ¸å¿ƒï¼Œç†è§£è¿™ä¸ªæµç¨‹æ˜¯æŒæ¡Androidæ˜¾ç¤ºæœºåˆ¶çš„å…³é”®ã€‚</p>
<h3 data-id="heading-26">åˆæˆå¾ªç¯çš„è§¦å‘æœºåˆ¶</h3>
<p>SurfaceFlingerçš„åˆæˆå¾ªç¯ç”±ä¸¤ç§æ–¹å¼è§¦å‘ï¼š</p>
<p><strong>1. Vsyncä¿¡å·è§¦å‘ï¼ˆä¸»è¦æ–¹å¼ï¼‰</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// Vsyncåˆ°è¾¾ â†’ Schedulerè°ƒåº¦ â†’ SurfaceFlinger::composite()</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SurfaceFlinger::onVsync</span><span class="hljs-params">(<span class="hljs-type">nsecs_t</span> expectedVsyncTime)</span> </span>{
    <span class="hljs-comment">// æ”¶åˆ°Vsyncä¿¡å·ï¼Œå¼€å§‹æ–°çš„ä¸€å¸§</span>
    <span class="hljs-built_in">composite</span>();
}
</code></pre>
<p><strong>2. Transactionè§¦å‘ï¼ˆå±æ€§å˜æ›´ï¼‰</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// åº”ç”¨ä¿®æ”¹Layerå±æ€§ â†’ æäº¤Transaction â†’ è§¦å‘åˆæˆ</span>
surface.<span class="hljs-built_in">setPosition</span>(<span class="hljs-number">100</span>, <span class="hljs-number">200</span>);  <span class="hljs-comment">// Javaå±‚</span>
surface.<span class="hljs-built_in">setAlpha</span>(<span class="hljs-number">0.5f</span>);
<span class="hljs-comment">// â†’ Nativeå±‚æäº¤Transaction</span>
<span class="hljs-comment">// â†’ SurfaceFlingerå¤„ç†Transaction</span>
<span class="hljs-comment">// â†’ è§¦å‘é‡æ–°åˆæˆ</span>
</code></pre>
<h3 data-id="heading-27">åˆæˆæµç¨‹æ ¸å¿ƒæ­¥éª¤</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b459bd57ba3442d69d427cc15b4e8e89~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769258025&amp;x-signature=7hkthaAV9%2F9wt%2BkJakXorjl0lkU%3D" alt="01-02-surfaceflinger-composition-flow.png" loading="lazy"/></p>
<p><em>å›¾2: SurfaceFlingerçš„åˆæˆæµç¨‹</em></p>
<p>è®©æˆ‘ä»¬æ·±å…¥åˆ†æåˆæˆæµç¨‹çš„æ¯ä¸ªé˜¶æ®µï¼š</p>
<h4 data-id="heading-28">é˜¶æ®µ1ï¼šTransactionå¤„ç† (<code>commitTransactions</code>)</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// frameworks/native/services/surfaceflinger/SurfaceFlinger.cpp (ç®€åŒ–)</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SurfaceFlinger::commitTransactions</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">ATRACE_CALL</span>();

    <span class="hljs-comment">// 1. å¤„ç†ç­‰å¾…ä¸­çš„Transactions</span>
    <span class="hljs-type">bool</span> transactionFlushNeeded = <span class="hljs-built_in">transactionFlushNeeded</span>();
    <span class="hljs-keyword">if</span> (transactionFlushNeeded) {
        <span class="hljs-built_in">commitTransactionsLocked</span>(eDisplayTransactionNeeded);
    }
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SurfaceFlinger::commitTransactionsLocked</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> transactionFlags)</span> </span>{
    <span class="hljs-comment">// éå†æ‰€æœ‰Transactions</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span>&amp; [handle, compositorState] : mCompositorStates) {
        sp&lt;Layer&gt; layer = <span class="hljs-built_in">fromHandleLocked</span>(handle).<span class="hljs-built_in">promote</span>();
        <span class="hljs-keyword">if</span> (layer) {
            <span class="hljs-comment">// åº”ç”¨å±æ€§å˜æ›´åˆ°Layer</span>
            layer-&gt;<span class="hljs-built_in">setPosition</span>(compositorState.x, compositorState.y);
            layer-&gt;<span class="hljs-built_in">setAlpha</span>(compositorState.alpha);
            layer-&gt;<span class="hljs-built_in">setMatrix</span>(compositorState.matrix);
            <span class="hljs-comment">// ... å…¶ä»–å±æ€§</span>
        }
    }

    <span class="hljs-comment">// æ ‡è®°éœ€è¦é‡æ–°è®¡ç®—å¯è§åŒºåŸŸ</span>
    mVisibleRegionsDirty = <span class="hljs-literal">true</span>;
}
</code></pre>
<p><strong>Transactionå¤„ç†çš„å…³é”®ä»»åŠ¡</strong>ï¼š</p>
<ul>
<li>åº”ç”¨Layerå±æ€§å˜æ›´ï¼ˆä½ç½®ã€å¤§å°ã€é€æ˜åº¦ç­‰ï¼‰</li>
<li>æ›´æ–°Layeræ ‘ç»“æ„ï¼ˆæ·»åŠ ã€åˆ é™¤Layerï¼‰</li>
<li>æ ‡è®°éœ€è¦é‡æ–°è®¡ç®—çš„åŒºåŸŸ</li>
</ul>
<h4 data-id="heading-29">é˜¶æ®µ2ï¼šLayeréå†ä¸å‡†å¤‡ (<code>latchBuffers</code>)</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SurfaceFlinger::latchBuffers</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-built_in">ATRACE_CALL</span>();

    <span class="hljs-comment">// éå†æ‰€æœ‰Layer</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span>&amp; layer : mDrawingState.layersSortedByZ) {
        <span class="hljs-comment">// 1. ä»BufferQueueè·å–æœ€æ–°çš„Buffer</span>
        <span class="hljs-type">bool</span> bufferUpdated = layer-&gt;<span class="hljs-built_in">latchBuffer</span>();

        <span class="hljs-comment">// 2. æ›´æ–°Layerçš„å†…å®¹åŒºåŸŸ</span>
        <span class="hljs-keyword">if</span> (bufferUpdated) {
            Region dirtyRegion = layer-&gt;<span class="hljs-built_in">getDirtyRegion</span>();
            mDirtyRegion.<span class="hljs-built_in">orSelf</span>(dirtyRegion);
        }
    }

    <span class="hljs-comment">// è®¡ç®—å¯è§åŒºåŸŸ</span>
    <span class="hljs-built_in">computeVisibleRegions</span>();
}
</code></pre>
<p><strong>å…³é”®æ“ä½œ</strong>ï¼š</p>
<ul>
<li><strong>latchBuffer()</strong>: ä»BufferQueueè·å–æœ€æ–°çš„GraphicBuffer</li>
<li><strong>getDirtyRegion()</strong>: è®¡ç®—éœ€è¦é‡ç»˜çš„åŒºåŸŸ</li>
<li><strong>computeVisibleRegions()</strong>: è®¡ç®—æ¯ä¸ªLayerçš„å¯è§éƒ¨åˆ†ï¼ˆè€ƒè™‘é®æŒ¡å…³ç³»ï¼‰</li>
</ul>
<h4 data-id="heading-30">é˜¶æ®µ3ï¼šåˆæˆç­–ç•¥å†³ç­–</h4>
<p>SurfaceFlingeréœ€è¦å†³å®šä½¿ç”¨GPUåˆæˆè¿˜æ˜¯HWCç¡¬ä»¶åˆæˆï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ç®€åŒ–çš„å†³ç­–é€»è¾‘</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SurfaceFlinger::computeCompositionType</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// 1. å…ˆå‡è®¾æ‰€æœ‰Layeréƒ½ç”¨GPUåˆæˆ</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span>&amp; layer : layers) {
        layer-&gt;<span class="hljs-built_in">setCompositionType</span>(CompositionType::CLIENT);
    }

    <span class="hljs-comment">// 2. è¯¢é—®HWCæ˜¯å¦èƒ½ç¡¬ä»¶åˆæˆ</span>
    hwc-&gt;<span class="hljs-built_in">validateDisplay</span>(displayId, &amp;numTypes, &amp;numRequests);

    <span class="hljs-comment">// 3. HWCä¼šä¿®æ”¹Layerçš„åˆæˆç±»å‹</span>
    <span class="hljs-comment">// CompositionType::DEVICE - HWCå¯ä»¥ç¡¬ä»¶åˆæˆ</span>
    <span class="hljs-comment">// CompositionType::CLIENT - éœ€è¦GPUåˆæˆ</span>
    <span class="hljs-comment">// CompositionType::SOLID_COLOR - çº¯è‰²å¡«å……</span>
    <span class="hljs-comment">// CompositionType::CURSOR - ç¡¬ä»¶å…‰æ ‡</span>
}
</code></pre>
<p><strong>åˆæˆç±»å‹è¯´æ˜</strong>ï¼š</p>






























<table><thead><tr><th align="left">åˆæˆç±»å‹</th><th align="left">è¯´æ˜</th><th align="left">æ€§èƒ½</th></tr></thead><tbody><tr><td align="left"><code>DEVICE</code></td><td align="left">HWCç¡¬ä»¶åˆæˆ</td><td align="left">æœ€é«˜ï¼ˆä½åŠŸè€—ï¼‰</td></tr><tr><td align="left"><code>CLIENT</code></td><td align="left">GPUåˆæˆï¼ˆOpenGL/Vulkanï¼‰</td><td align="left">ä¸­ç­‰</td></tr><tr><td align="left"><code>SOLID_COLOR</code></td><td align="left">çº¯è‰²å¡«å……ï¼ˆæ— Bufferï¼‰</td><td align="left">æœ€é«˜</td></tr><tr><td align="left"><code>CURSOR</code></td><td align="left">ç¡¬ä»¶å…‰æ ‡å åŠ </td><td align="left">æœ€é«˜</td></tr></tbody></table>

**ä¼˜åŒ–æŠ€å·§**: HWCç¡¬ä»¶åˆæˆçš„åŠŸè€—è¿œä½äºGPUåˆæˆã€‚åº”ç”¨å¼€å‘æ—¶ï¼Œå°½é‡é¿å…ä½¿ç”¨HWCä¸æ”¯æŒçš„ç‰¹æ€§ï¼ˆå¦‚å¤æ‚çš„Shaderã€æ—‹è½¬ç­‰ï¼‰ï¼Œè®©æ›´å¤šLayerèµ°ç¡¬ä»¶åˆæˆè·¯å¾„ã€‚

<h4 data-id="heading-31">é˜¶æ®µ4ï¼šæ‰§è¡Œåˆæˆ</h4>
<p>æ ¹æ®åˆæˆç­–ç•¥ï¼Œåˆ†åˆ«æ‰§è¡ŒGPUåˆæˆå’ŒHWCåˆæˆï¼š</p>
<p><strong>GPUåˆæˆè·¯å¾„</strong>ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SurfaceFlinger::doComposeSurfaces</span><span class="hljs-params">(<span class="hljs-type">const</span> DisplayDevice&amp; display)</span> </span>{
    <span class="hljs-keyword">auto</span>&amp; engine = <span class="hljs-built_in">getRenderEngine</span>();

    <span class="hljs-comment">// 1. å‡†å¤‡æ¸²æŸ“ç›®æ ‡ï¼ˆFrameBufferæˆ–ç¦»å±Bufferï¼‰</span>
    <span class="hljs-type">const</span> <span class="hljs-keyword">auto</span>&amp; outputState = display.<span class="hljs-built_in">getState</span>();
    <span class="hljs-keyword">auto</span> framebuffer = outputState.framebuffer;

    <span class="hljs-comment">// 2. è®¾ç½®æ¸²æŸ“å‚æ•°</span>
    engine-&gt;<span class="hljs-built_in">setViewportAndProjection</span>(width, height, viewport, projection);
    engine-&gt;<span class="hljs-built_in">setOutputDataSpace</span>(outputDataSpace);
    engine-&gt;<span class="hljs-built_in">setDisplayMaxLuminance</span>(maxLuminance);

    <span class="hljs-comment">// 3. éå†éœ€è¦GPUåˆæˆçš„Layer</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span>&amp; layer : clientCompositionLayers) {
        <span class="hljs-comment">// æ„å»ºLayeræ¸²æŸ“è®¾ç½®</span>
        <span class="hljs-keyword">auto</span> settings = layer-&gt;<span class="hljs-built_in">prepareClientCompositionSettings</span>(
            clip, needsFiltering, isSecure, ...);

        <span class="hljs-comment">// æ·»åŠ åˆ°æ¸²æŸ“åˆ—è¡¨</span>
        clientCompositionList.<span class="hljs-built_in">push_back</span>(settings);
    }

    <span class="hljs-comment">// 4. æ‰§è¡Œæ¸²æŸ“</span>
    engine-&gt;<span class="hljs-built_in">drawLayers</span>(clientCompositionList, framebuffer, ...);
}
</code></pre>
<p><strong>HWCåˆæˆè·¯å¾„</strong>ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SurfaceFlinger::presentDisplay</span><span class="hljs-params">(<span class="hljs-type">const</span> DisplayDevice&amp; display)</span> </span>{
    <span class="hljs-keyword">auto</span>&amp; hwc = <span class="hljs-built_in">getHwComposer</span>();

    <span class="hljs-comment">// 1. è®¾ç½®Layerä¿¡æ¯åˆ°HWC</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span>&amp; layer : layers) {
        <span class="hljs-keyword">if</span> (layer-&gt;<span class="hljs-built_in">getCompositionType</span>() == CompositionType::DEVICE) {
            hwc-&gt;<span class="hljs-built_in">setLayerBuffer</span>(displayId, layerId,
                               layer-&gt;<span class="hljs-built_in">getBuffer</span>(),
                               layer-&gt;<span class="hljs-built_in">getAcquireFence</span>());
            hwc-&gt;<span class="hljs-built_in">setLayerDisplayFrame</span>(displayId, layerId, layer-&gt;<span class="hljs-built_in">getFrame</span>());
            hwc-&gt;<span class="hljs-built_in">setLayerSourceCrop</span>(displayId, layerId, layer-&gt;<span class="hljs-built_in">getCrop</span>());
            <span class="hljs-comment">// ... å…¶ä»–å±æ€§</span>
        }
    }

    <span class="hljs-comment">// 2. æ‰§è¡Œç¡¬ä»¶åˆæˆ</span>
    hwc-&gt;<span class="hljs-built_in">presentDisplay</span>(displayId, &amp;presentFence);

    <span class="hljs-comment">// 3. ç­‰å¾…åˆæˆå®Œæˆ</span>
    presentFence-&gt;<span class="hljs-built_in">waitForever</span>();
}
</code></pre>
<h4 data-id="heading-32">é˜¶æ®µ5ï¼šè¾“å‡ºåˆ°Display</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SurfaceFlinger::postComposition</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// 1. è·å–Present Fence</span>
    <span class="hljs-keyword">auto</span> fence = display-&gt;<span class="hljs-built_in">getCompositionDisplay</span>()-&gt;<span class="hljs-built_in">getReleaseFence</span>();

    <span class="hljs-comment">// 2. å‘é€åˆ°Display Driver</span>
    display-&gt;<span class="hljs-built_in">present</span>();

    <span class="hljs-comment">// 3. é‡Šæ”¾æ—§çš„Buffer</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span>&amp; layer : layers) {
        layer-&gt;<span class="hljs-built_in">onPostComposition</span>(fence);
    }

    <span class="hljs-comment">// 4. é€šçŸ¥åº”ç”¨Bufferå¯ä»¥é‡Šæ”¾</span>
    mTransactionCallbackInvoker.<span class="hljs-built_in">sendCallbacks</span>();
}
</code></pre>
<h3 data-id="heading-33">Frame bufferç®¡ç†ä¸FenceåŒæ­¥</h3>
<p><strong>Frame buffer</strong>ï¼š</p>
<ul>
<li>å­˜å‚¨æœ€ç»ˆåˆæˆç»“æœçš„Buffer</li>
<li>é€šå¸¸æœ‰2-3ä¸ªï¼ˆåŒç¼“å†²/ä¸‰é‡ç¼“å†²ï¼‰</li>
<li>ä¸€ä¸ªæ­£åœ¨æ˜¾ç¤ºï¼Œä¸€ä¸ªæ­£åœ¨åˆæˆï¼Œä¸€ä¸ªç©ºé—²</li>
</ul>
<p><strong>FenceåŒæ­¥æœºåˆ¶</strong>ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// Fenceç”¨äºåŒæ­¥GPU/HWCçš„å¼‚æ­¥æ“ä½œ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Fence</span> {
    <span class="hljs-type">int</span> mFenceFd;  <span class="hljs-comment">// å†…æ ¸fenceæ–‡ä»¶æè¿°ç¬¦</span>

    <span class="hljs-comment">// ç­‰å¾…fenceä¿¡å·ï¼ˆé˜»å¡ï¼‰</span>
    <span class="hljs-function"><span class="hljs-type">status_t</span> <span class="hljs-title">wait</span><span class="hljs-params">(<span class="hljs-type">int</span> timeout)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">sync_wait</span>(mFenceFd, timeout);
    }

    <span class="hljs-comment">// æ£€æŸ¥fenceæ˜¯å¦å·²ç»ä¿¡å·</span>
    <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">isValid</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> mFenceFd != <span class="hljs-number">-1</span>; }
};

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
sp&lt;Fence&gt; acquireFence = layer-&gt;<span class="hljs-built_in">getAcquireFence</span>();
acquireFence-&gt;<span class="hljs-built_in">waitForever</span>(<span class="hljs-string">"Waiting for buffer"</span>);
<span class="hljs-comment">// Bufferç°åœ¨å¯ä»¥å®‰å…¨è¯»å–äº†</span>
</code></pre>
<p><strong>Fenceçš„ä½œç”¨</strong>ï¼š</p>
<ul>
<li><strong>acquireFence</strong>: åº”ç”¨å†™å®ŒBufferåè®¾ç½®ï¼ŒSurfaceFlingerç­‰å¾…æ­¤Fenceæ‰èƒ½è¯»å–Buffer</li>
<li><strong>releaseFence</strong>: SurfaceFlingerè¯»å®ŒBufferåè®¾ç½®ï¼Œåº”ç”¨ç­‰å¾…æ­¤Fenceæ‰èƒ½é‡ç”¨Buffer</li>
<li><strong>presentFence</strong>: æ˜¾ç¤ºå®Œæˆåè®¾ç½®ï¼Œç”¨äºç»Ÿè®¡çœŸå®çš„æ˜¾ç¤ºæ—¶é—´</li>
</ul>
<hr/>
<h2 data-id="heading-34">è°ƒè¯•æŠ€å·§ä¸å¸¸è§é—®é¢˜</h2>
<p>æŒæ¡è°ƒè¯•æŠ€å·§æ˜¯ç†è§£å’Œè§£å†³æ˜¾ç¤ºé—®é¢˜çš„å…³é”®ã€‚</p>
<h3 data-id="heading-35">dumpsys SurfaceFlingerè¯¦è§£</h3>
<p><code>dumpsys SurfaceFlinger</code>æ˜¯æœ€å¸¸ç”¨çš„è°ƒè¯•å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹SurfaceFlingerå®Œæ•´çŠ¶æ€</span>
adb shell dumpsys SurfaceFlinger

<span class="hljs-comment"># æŸ¥çœ‹Layeråˆ—è¡¨</span>
adb shell dumpsys SurfaceFlinger --list

<span class="hljs-comment"># æŸ¥çœ‹Vsyncä¿¡æ¯</span>
adb shell dumpsys SurfaceFlinger --vsync-info

<span class="hljs-comment"># æŸ¥çœ‹Displayä¿¡æ¯</span>
adb shell dumpsys SurfaceFlinger --display-id

<span class="hljs-comment"># æŸ¥çœ‹æ¸²æŸ“ç»Ÿè®¡</span>
adb shell dumpsys SurfaceFlinger --frame-stats
</code></pre>
<p><strong>è¾“å‡ºç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">SurfaceFlinger (platform 35, AOSP-Android 15)
Build: Android 15 / xxxxx

Displays:
  Display 0 (primary)
    size: 1080x2400
    refresh: 90 Hz
    power: ON

Visible Layers:
  Layer 1234 (com.example.app/MainActivity)
    <span class="hljs-attr">z</span>=<span class="hljs-number">0</span>, alpha=<span class="hljs-number">1.0</span>, pos=(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), size=(<span class="hljs-number">1080</span>, <span class="hljs-number">2400</span>)
    <span class="hljs-attr">compositionType</span>=DEVICE
    <span class="hljs-attr">buffer</span>=<span class="hljs-number">0</span>x7f8a9c0000 (<span class="hljs-number">1080</span>x2400 RGBA_8888)

  Layer 5678 (StatusBar)
    <span class="hljs-attr">z</span>=<span class="hljs-number">100000</span>, alpha=<span class="hljs-number">1.0</span>, pos=(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), size=(<span class="hljs-number">1080</span>, <span class="hljs-number">100</span>)
    <span class="hljs-attr">compositionType</span>=DEVICE
    <span class="hljs-attr">buffer</span>=<span class="hljs-number">0</span>x7f8a9d0000 (<span class="hljs-number">1080</span>x100 RGBA_8888)
</code></pre>
<h3 data-id="heading-36">å¸¸ç”¨è°ƒè¯•å±æ€§</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¼ºåˆ¶GPUåˆæˆï¼ˆç¦ç”¨HWCï¼‰</span>
adb shell setprop debug.sf.disable_hwc 1

<span class="hljs-comment"># æ˜¾ç¤ºLayerè¾¹ç•Œ</span>
adb shell setprop debug.sf.show_layers 1

<span class="hljs-comment"># æ˜¾ç¤ºCPUä½¿ç”¨æƒ…å†µ</span>
adb shell setprop debug.sf.show_cpu 1

<span class="hljs-comment"># æ˜¾ç¤ºåˆ·æ–°ç‡</span>
adb shell setprop debug.sf.show_refresh_rate 1

<span class="hljs-comment"># ç¦ç”¨ä¸‰é‡ç¼“å†²</span>
adb shell setprop debug.sf.enable_triple_buffer 0

<span class="hljs-comment"># é‡å¯SurfaceFlingerä½¿å±æ€§ç”Ÿæ•ˆ</span>
adb shell stop surfaceflinger &amp;&amp; adb shell start surfaceflinger
</code></pre>
<h3 data-id="heading-37">é»‘å±/èŠ±å±é—®é¢˜æ’æŸ¥</h3>
<p><strong>é»‘å±é—®é¢˜æ’æŸ¥æ€è·¯</strong>ï¼š</p>
<ol>
<li><strong>æ£€æŸ¥Surfaceæ˜¯å¦åˆ›å»ºæˆåŠŸ</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash">adb shell dumpsys SurfaceFlinger --list | grep &lt;package-name&gt;
<span class="hljs-comment"># å¦‚æœæ²¡æœ‰è¾“å‡ºï¼Œè¯´æ˜Surfaceæœªåˆ›å»º</span>
</code></pre>
<ol start="2">
<li><strong>æ£€æŸ¥Bufferæ˜¯å¦æäº¤</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash">adb shell dumpsys SurfaceFlinger | grep -A20 &lt;layer-name&gt;
<span class="hljs-comment"># æŸ¥çœ‹bufferå­—æ®µæ˜¯å¦ä¸ºnull</span>
</code></pre>
<ol start="3">
<li><strong>æ£€æŸ¥Displayç”µæºçŠ¶æ€</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash">adb shell dumpsys SurfaceFlinger | grep power
<span class="hljs-comment"># åº”è¯¥æ˜¾ç¤º power: ON</span>
</code></pre>
<ol start="4">
<li><strong>æŸ¥çœ‹æ—¥å¿—</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash">adb logcat -b all | grep -E <span class="hljs-string">"SurfaceFlinger|BufferQueue|GraphicBuffer"</span>
</code></pre>
<p><strong>èŠ±å±é—®é¢˜æ’æŸ¥</strong>ï¼š</p>
<ul>
<li>æ£€æŸ¥Bufferæ ¼å¼æ˜¯å¦æ­£ç¡®ï¼ˆRGBA vs YUVï¼‰</li>
<li>æ£€æŸ¥strideå¯¹é½é—®é¢˜</li>
<li>æŸ¥çœ‹æ˜¯å¦æœ‰GPUæ¸²æŸ“é”™è¯¯</li>
</ul>
<h3 data-id="heading-38">æ€§èƒ½åˆ†æå·¥å…·</h3>
<p><strong>systrace / Perfetto</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŠ“å–æ˜¾ç¤ºç³»ç»Ÿtrace</span>
python systrace.py -t 10 gfx view <span class="hljs-built_in">sched</span> freq -o trace.html

<span class="hljs-comment"># é‡ç‚¹å…³æ³¨ï¼š</span>
<span class="hljs-comment"># - SurfaceFlinger: åˆæˆè€—æ—¶</span>
<span class="hljs-comment"># - RenderThread: åº”ç”¨ä¾§æ¸²æŸ“è€—æ—¶</span>
<span class="hljs-comment"># - VSYNC: æ˜¯å¦æŒ‰æ—¶å®Œæˆ</span>
</code></pre>
<p><strong>GPUå‘ˆç°æ¨¡å¼</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœ¨å¼€å‘è€…é€‰é¡¹ä¸­å¯ç”¨"GPUå‘ˆç°æ¨¡å¼åˆ†æ"</span>
<span class="hljs-comment"># æˆ–é€šè¿‡å‘½ä»¤ï¼š</span>
adb shell setprop debug.hwui.profile <span class="hljs-literal">true</span>
adb shell setprop debug.hwui.profile.maxframes 128
</code></pre>
<hr/>
<h2 data-id="heading-39">æ€»ç»“ä¸å±•æœ›</h2>
<p>æœ¬æ–‡ä½œä¸ºã€ŠAndroid 15æ ¸å¿ƒå­ç³»ç»Ÿæ·±åº¦è§£æã€‹ç³»åˆ—çš„å¼€ç¯‡ä¹‹ä½œï¼Œå…¨é¢ä»‹ç»äº†Androidæ˜¾ç¤ºç³»ç»Ÿçš„æ•´ä½“æ¶æ„å’ŒSurfaceFlingerçš„æ ¸å¿ƒæœºåˆ¶ã€‚</p>
<h3 data-id="heading-40">æ ¸å¿ƒè¦ç‚¹å›é¡¾</h3>
<ol>
<li>
<p><strong>Androidæ˜¾ç¤ºç³»ç»Ÿé‡‡ç”¨å››å±‚æ¶æ„</strong>ï¼šåº”ç”¨å±‚ã€Frameworkå±‚ã€Nativeå±‚ã€é©±åŠ¨å±‚ï¼Œå„å¸å…¶èŒï¼ŒååŒå·¥ä½œ</p>
</li>
<li>
<p><strong>SurfaceFlingeræ˜¯æ˜¾ç¤ºç³»ç»Ÿçš„æ ¸å¿ƒ</strong>ï¼š</p>
<ul>
<li>è´Ÿè´£æ‰€æœ‰Layerçš„åˆæˆ</li>
<li>ç”±Vsyncé©±åŠ¨å·¥ä½œ</li>
<li>æ™ºèƒ½é€‰æ‹©GPU/HWCåˆæˆç­–ç•¥</li>
</ul>
</li>
<li>
<p><strong>Surfaceæ˜¯è·¨è¿›ç¨‹å…±äº«çš„ç»˜åˆ¶ç¼“å†²åŒº</strong>ï¼š</p>
<ul>
<li>åº”ç”¨é€šè¿‡Produceræ¥å£ç»˜åˆ¶</li>
<li>SurfaceFlingeré€šè¿‡Consumeræ¥å£æ¶ˆè´¹</li>
<li>BufferQueueå®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼</li>
</ul>
</li>
<li>
<p><strong>åˆæˆæµç¨‹åŒ…å«äº”ä¸ªå…³é”®é˜¶æ®µ</strong>ï¼š</p>
<ul>
<li>Transactionå¤„ç†</li>
<li>Layeréå†ä¸å‡†å¤‡</li>
<li>åˆæˆç­–ç•¥å†³ç­–</li>
<li>æ‰§è¡Œåˆæˆï¼ˆGPUæˆ–HWCï¼‰</li>
<li>è¾“å‡ºåˆ°Display</li>
</ul>
</li>
<li>
<p><strong>Android 15çš„æ˜¾ç¤ºä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>Canvasç°ä»£åŒ–</li>
<li>HWC 3.0æ”¯æŒ</li>
<li>åŠ¨æ€åˆ·æ–°ç‡</li>
<li>HDRå¢å¼º</li>
</ul>
</li>
</ol>
<h3 data-id="heading-41">ä¸‹ä¸€æ­¥å­¦ä¹ </h3>
<p>åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ã€Šå›¾å½¢ç¼“å†²åŒºç®¡ç†ä¸HWCç¡¬ä»¶åˆæˆã€‹ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ï¼š</p>
<ul>
<li>GraphicBufferå’ŒBufferQueueçš„å®ç°ç»†èŠ‚</li>
<li>Gralloc HALçš„å·¥ä½œæœºåˆ¶</li>
<li>HWC 3.0çš„æ¶æ„å’Œåˆæˆç­–ç•¥</li>
<li>FenceåŒæ­¥çš„åº•å±‚åŸç†</li>
<li>Android 15çš„Bufferç®¡ç†ä¼˜åŒ–</li>
</ul>
<h3 data-id="heading-42">å®è·µå»ºè®®</h3>
<ol>
<li><strong>åŠ¨æ‰‹å®éªŒ</strong>ï¼šä¿®æ”¹<code>debug.sf.*</code>å±æ€§ï¼Œè§‚å¯Ÿæ˜¾ç¤ºè¡Œä¸ºå˜åŒ–</li>
<li><strong>é˜…è¯»æºç </strong>ï¼šä»<code>main_surfaceflinger.cpp</code>å¼€å§‹ï¼Œè·Ÿè¸ªå®Œæ•´å¯åŠ¨æµç¨‹</li>
<li><strong>ä½¿ç”¨å·¥å…·</strong>ï¼šç†Ÿç»ƒä½¿ç”¨systraceå’Œdumpsysåˆ†æå®é™…é—®é¢˜</li>
<li><strong>å…³æ³¨æ€§èƒ½</strong>ï¼šç†è§£HWCç¡¬ä»¶åˆæˆçš„ä¼˜åŠ¿ï¼Œä¼˜åŒ–åº”ç”¨æ¸²æŸ“ç­–ç•¥</li>
</ol>
<hr/>
<h2 data-id="heading-43">å‚è€ƒèµ„æº</h2>
<h3 data-id="heading-44">æºç è·¯å¾„</h3>
<pre><code class="hljs language-bash" lang="bash">frameworks/native/services/surfaceflinger/  <span class="hljs-comment"># SurfaceFlingerä¸»ç›®å½•</span>
frameworks/native/libs/gui/                 <span class="hljs-comment"># GUIåº“(Surface, BufferQueue)</span>
frameworks/native/libs/ui/                  <span class="hljs-comment"># UIåº“(GraphicBuffer)</span>
frameworks/base/core/java/android/view/     <span class="hljs-comment"># Frameworkå±‚</span>
</code></pre>
<h3 data-id="heading-45">å®˜æ–¹æ–‡æ¡£</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fsource.android.com%2Fdocs%2Fcore%2Fgraphics" target="_blank" title="https://source.android.com/docs/core/graphics" ref="nofollow noopener noreferrer">Android Graphics Architecture</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fsource.android.com%2Fdocs%2Fcore%2Fgraphics%2Fsurfaceflinger-windowmanager" target="_blank" title="https://source.android.com/docs/core/graphics/surfaceflinger-windowmanager" ref="nofollow noopener noreferrer">SurfaceFlinger and WindowManager</a></li>
</ul>
<h3 data-id="heading-46">è°ƒè¯•å‘½ä»¤é€ŸæŸ¥</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># SurfaceFlingerçŠ¶æ€</span>
adb shell dumpsys SurfaceFlinger

<span class="hljs-comment"># Layeråˆ—è¡¨</span>
adb shell dumpsys SurfaceFlinger --list

<span class="hljs-comment"># å¼ºåˆ¶GPUåˆæˆ</span>
adb shell setprop debug.sf.disable_hwc 1

<span class="hljs-comment"># SystraceæŠ“å–</span>
python systrace.py -t 10 gfx view <span class="hljs-built_in">sched</span> -o trace.html
</code></pre>
<h3 data-id="heading-47">ç³»åˆ—æ–‡ç« </h3>
<ul>
<li><a href="https://link.juejin.cn?target=.%2F02-android15-display-subsystem-02-graphicbuffer-hwc" target="_blank" title="./02-android15-display-subsystem-02-graphicbuffer-hwc" ref="nofollow noopener noreferrer">ä¸‹ä¸€ç¯‡ï¼šAndroid 15 æ˜¾ç¤ºå­ç³»ç»Ÿæ·±åº¦è§£æ(äºŒ)ï¼šå›¾å½¢ç¼“å†²åŒºç®¡ç†ä¸HWCç¡¬ä»¶åˆæˆ</a></li>
</ul>
<hr/>
<p><em>æ¬¢è¿æ¥æˆ‘ä¸­çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fhome.wonlab.top" target="_blank" title="https://home.wonlab.top" ref="nofollow noopener noreferrer">ä¸ªäººä¸»é¡µ</a>æ‰¾åˆ°æ›´å¤šæœ‰ç”¨çš„çŸ¥è¯†å’Œæœ‰è¶£çš„äº§å“</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AsyncTaskæºç è§£æ]]></title>    <link>https://juejin.cn/post/7595974133096955938</link>    <guid>https://juejin.cn/post/7595974133096955938</guid>    <pubDate>2026-01-17T13:39:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595974133096955938" data-draft-id="7595974133096792098" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AsyncTaskæºç è§£æ"/> <meta itemprop="keywords" content="æºç "/> <meta itemprop="datePublished" content="2026-01-17T13:39:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="XRay"/> <meta itemprop="url" content="https://juejin.cn/user/3966693685869288"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AsyncTaskæºç è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3966693685869288/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    XRay
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T13:39:05.000Z" title="Sat Jan 17 2026 13:39:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>æˆ‘ä»¬åœ¨çº¿ç¨‹ä¸­æ‰§è¡Œè€—æ—¶ä»»åŠ¡çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœéœ€è¦æ›´æ–° UI æ˜¾ç¤ºä»»åŠ¡è¿›åº¦ï¼Œå¯ä»¥ä½¿ç”¨ Handler æ¥æ›´æ–° UIï¼Œä½†æ˜¯è¿™æ ·åšç›¸å¯¹æ¯”è¾ƒéº»çƒ¦ï¼Œå¦‚æœä½¿ç”¨ AsyncTask æ¥å®ç°ï¼Œä»£ç ä¼šç®€æ´å¾ˆå¤šã€‚ä»å®ç°ä¸Šæ¥è¯´ï¼ŒAsynTask å°è£…äº†çº¿ç¨‹æ± å’Œ Handlerã€‚</p>
<h3 data-id="heading-1">AsyncTaskç®€ä»‹</h3>
<p>AsyncTask ç»è¿‡å‡ æ¬¡ä¿®æ”¹ï¼Œå¯¼è‡´äº†å¯¹äºä¸åŒçš„ API ç‰ˆæœ¬çš„ AsyncTask å…·æœ‰ä¸åŒçš„è¡¨ç°ï¼Œå°¤å…¶æ˜¯å¤šä»»åŠ¡çš„å¹¶å‘æ‰§è¡Œä¸Šã€‚</p>
<p>æ‰“å¼€ AsyncTask çš„æºç ï¼ˆè·¯å¾„ï¼šframeworks\base\core\java\android\os\AsyncTask.javaï¼Œæœ¬æ–‡åŸºäºAndroid 11.0ï¼‰ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Deprecated</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AsyncTask</span>&lt;Params, Progress, Result&gt; {
    ...
}
</code></pre>
<p>å‘ç°ä¸Šé¢å·²ç»æ ‡è®°äº† @Deprecatedï¼Œå®˜æ–¹æ›´æ¨èå¼€å‘è€…ä½¿ç”¨ Kotlin çš„åç¨‹è¿›è¡Œå¼‚æ­¥æ“ä½œï¼š</p>
<blockquote>
<p>Deprecated
Use the standard java.util.concurrent or Kotlin concurrency utilities instead.</p>
</blockquote>
<p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.android.com%2Freference%2Fandroid%2Fos%2FAsyncTask" title="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.android.com%2Freference%2Fandroid%2Fos%2FAsyncTask" target="_blank">AsyncTaskçš„å®˜æ–¹æ–‡æ¡£</a> ä¸­åˆ—ä¸¾äº†æŠŠå®ƒæ ‡è®°ä¸ºè¿‡æ—¶çš„åŸå› ï¼Œå…¶å®è¿™ä¹Ÿæ˜¯ AsyncTask ä¸€ç›´ä»¥æ¥éƒ½è¢«è¯Ÿç—…çš„åœ°æ–¹ï¼š</p>
<ol>
<li>å®¹æ˜“å¯¼è‡´ context çš„æ³„éœ²ï¼›</li>
<li>å¿˜è®°å›è°ƒï¼›</li>
<li>æ¨ªç«–å±åˆ‡æ¢å¯¼è‡´å´©æºƒï¼›</li>
<li>ä¸åŒç‰ˆæœ¬çš„ AsyncTask çš„å…¼å®¹é—®é¢˜ï¼›</li>
<li>åœ¨ doInBackground() ä¸­æŠŠå¼‚å¸¸ç›´æ¥åæ‰äº†ï¼›</li>
</ol>
<p>AsyncTask æ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ³›å‹ç±»ï¼Œå®ƒæä¾›äº† Paramsã€Progress å’Œ Result è¿™ä¸‰ä¸ªæ³›å‹å‚æ•°ï¼Œå…¶ä¸­ Params è¡¨ç¤ºå‚æ•°çš„ç±»å‹ï¼ŒProgress è¡¨ç¤ºåå°ä»»åŠ¡çš„æ‰§è¡Œè¿›åº¦çš„ç±»å‹ï¼Œè€Œ Result åˆ™è¡¨ç¤ºåå°ä»»åŠ¡çš„è¿”å›ç»“æœçš„ç±»å‹ï¼Œå¦‚æœ AsyncTask ç¡®å®ä¸éœ€è¦ä¼ é€’å…·ä½“çš„å‚æ•°ï¼Œé‚£ä¹ˆè¿™ä¸‰ä¸ªæ³›å‹å‚æ•°å¯ä»¥ç”¨ Void æ¥ä»£æ›¿ã€‚</p>
<p>AsyncTask æä¾›äº† 4 ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼Œå®ƒä»¬çš„å«ä¹‰å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<ol>
<li>onPreExecute()ï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œåœ¨å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œä¹‹å‰ï¼Œæ­¤æ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼Œä¸€èˆ¬å¯ä»¥ç”¨äºåšä¸€äº›å‡†å¤‡å·¥ä½œã€‚</li>
<li>doInBackground(Params...params)ï¼Œåœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡Œï¼Œæ­¤æ–¹æ³•ç”¨äºæ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ï¼Œparams å‚æ•°è¡¨ç¤ºå¼‚æ­¥ä»»åŠ¡çš„è¾“å…¥å‚æ•°ã€‚åœ¨æ­¤æ–¹æ³•ä¸­å¯ä»¥é€šè¿‡ publishProgress() æ–¹æ³•æ¥æ›´æ–°ä»»åŠ¡çš„è¿›åº¦ï¼ŒpublishProgress() æ–¹æ³•ä¼šè°ƒç”¨ onProgressUpdate() æ–¹æ³•ã€‚å¦å¤–æ­¤æ–¹æ³•éœ€è¦è¿”å›è®¡ç®—ç»“æœç»™ onPostExecute() æ–¹æ³•ã€‚</li>
<li>onProgressUpdate(Progress...values)ï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œå½“åå°ä»»åŠ¡çš„æ‰§è¡Œè¿›åº¦å‘ç”Ÿæ”¹å˜æ—¶æ­¤æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚</li>
<li>onPostExecute(Result result)ï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œåœ¨å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œä¹‹åï¼Œæ­¤æ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼Œå…¶ä¸­ result å‚æ•°æ˜¯åå°ä»»åŠ¡çš„è¿”å›å€¼ï¼Œå³ dolnBackground() çš„è¿”å›å€¼ã€‚</li>
</ol>
<p>ä¸Šé¢è¿™å‡ ä¸ªæ–¹æ³•ï¼ŒonPreExecute() å…ˆæ‰§è¡Œï¼Œæ¥ç€æ˜¯ doInBackground()ï¼Œæœ€åæ‰æ˜¯ onPostExecute()ã€‚</p>
<p>é™¤äº†ä¸Šè¿°å››ä¸ªæ–¹æ³•ä»¥å¤–ï¼ŒAsyncTask è¿˜æä¾›äº† onCancelled() æ–¹æ³•ï¼Œå®ƒåŒæ ·åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œå½“å¼‚æ­¥ä»»åŠ¡è¢«å–æ¶ˆæ—¶ï¼ŒonCancelled() æ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼Œè¿™ä¸ªæ—¶å€™ onPostExecute() åˆ™ä¸ä¼šè¢«è°ƒç”¨ã€‚</p>
<h3 data-id="heading-2">AsyncTaskçš„ä½¿ç”¨</h3>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ AsyncTask æ¨¡æ‹Ÿè€—æ—¶ä¸‹è½½ä»»åŠ¡çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> {

    <span class="hljs-keyword">private</span> TextView myText;

    <span class="hljs-keyword">private</span> DownloadFilesTask task;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Bundle savedInstanceState)</span> {
        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        myText = findViewById(R.id.my_text);

        task = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DownloadFilesTask</span>(<span class="hljs-built_in">this</span>, myText);
        task.execute();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DownloadFilesTask</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AsyncTask</span>&lt;Void, Integer, Boolean&gt; {

        <span class="hljs-keyword">private</span> TextView myText;

        <span class="hljs-keyword">private</span> Context context;

        <span class="hljs-keyword">public</span> <span class="hljs-title function_">DownloadFilesTask</span><span class="hljs-params">(Context context, TextView myText)</span> {
            <span class="hljs-built_in">this</span>.context = context;
            <span class="hljs-built_in">this</span>.myText = myText;
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onPreExecute</span><span class="hljs-params">()</span> {
            <span class="hljs-comment">// å¼€å§‹ä¸‹è½½å‰æç¤º</span>
            Toast.makeText(context, <span class="hljs-string">"Start download"</span>, Toast.LENGTH_SHORT).show();
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">protected</span> Boolean <span class="hljs-title function_">doInBackground</span><span class="hljs-params">(Void... voids)</span> {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">100</span>; i++) {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-comment">// æ¨¡æ‹Ÿè€—æ—¶ä¸‹è½½</span>
                    Thread.sleep(<span class="hljs-number">100</span>);
                } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);
                }
                <span class="hljs-comment">// é€šçŸ¥ä¸»çº¿ç¨‹æ›´æ–°ä¸‹è½½è¿›åº¦</span>
                publishProgress((i));
                <span class="hljs-comment">// Escape early if cancel() is called</span>
                <span class="hljs-keyword">if</span> (isCancelled()) <span class="hljs-keyword">break</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onProgressUpdate</span><span class="hljs-params">(Integer... progress)</span> {
            <span class="hljs-comment">// UIæ›´æ–°ä¸‹è½½è¿›åº¦</span>
            myText.setText(<span class="hljs-string">" Current progress is : "</span> + Integer.valueOf(progress[<span class="hljs-number">0</span>]));
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onPostExecute</span><span class="hljs-params">(Boolean result)</span> {
            <span class="hljs-comment">// ä»»åŠ¡ç»“æŸåï¼Œæ˜¾ç¤ºä¸‹è½½æˆåŠŸè¿˜æ˜¯å¤±è´¥</span>
            <span class="hljs-keyword">if</span> (result) {
                Toast.makeText(context, <span class="hljs-string">"Download succeed"</span>, Toast.LENGTH_SHORT).show();
            } <span class="hljs-keyword">else</span> {
                Toast.makeText(context, <span class="hljs-string">"Download failed"</span>, Toast.LENGTH_SHORT).show();
            }
        }
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onDestroy</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.onDestroy();
        <span class="hljs-keyword">if</span> (task != <span class="hljs-literal">null</span>) {
            task.cancel(<span class="hljs-literal">true</span>);
            task = <span class="hljs-literal">null</span>;
        }
    }
}
</code></pre>
<p>ä½¿ç”¨ AsyncTask è¦æ³¨æ„:</p>
<ul>
<li>AsyncTask çš„å¯¹è±¡å¿…é¡»åœ¨ä¸»çº¿ç¨‹ä¸­åˆ›å»ºã€‚</li>
<li>ä¸è¦åœ¨ç¨‹åºä¸­ç›´æ¥è°ƒç”¨ onPreExecute()ã€onPostExecute()ã€doInBackground() å’Œ
onProgressUpdate() æ–¹æ³•ã€‚</li>
</ul>
<p>AsyncTask åœ¨ä¸åŒçš„ç‰ˆæœ¬ä¸­æ‰§è¡Œä»»åŠ¡çš„æ–¹å¼ä¸åŒï¼š</p>
<ul>
<li>åœ¨ Android1.6 ä»¥å‰ï¼ŒAsyncTask æ˜¯ä¸²è¡Œæ‰§è¡Œä»»åŠ¡çš„ã€‚</li>
<li>ä» Android1.6 åˆ° 2.3ï¼Œæ˜¯å¹¶è¡Œæ‰§è¡Œï¼Œå®ç°åŸç†æ˜¯ç”¨ä¸€ä¸ªçº¿ç¨‹æ•°ä¸º 5 çš„çº¿ç¨‹æ± è¿›è¡Œå¹¶è¡Œæ‰§è¡Œï¼Œä½†æ˜¯å¦‚æœå‰ 5 ä¸ªä»»åŠ¡æ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼Œå°±ä¼šé˜»å¡åé¢ä»»åŠ¡çš„æ‰§è¡Œï¼Œæ‰€ä»¥ä¸é€‚åˆå¤§é‡ä»»åŠ¡å¹¶å‘æ‰§è¡Œã€‚</li>
<li>Android3.0 ä¹‹åï¼Œä¸ºäº†é¿å… AsyncTask æ‰€å¸¦æ¥çš„å¹¶å‘é”™è¯¯ï¼Œåˆæ”¹ä¸ºäº†ä¸²è¡Œæ‰§è¡Œä»»åŠ¡ï¼Œä¸è¿‡ä½ å¯ä»¥é€šè¿‡ AsyncTask çš„ executeOnExecutor() æ–¹æ³•è‡ªå·±æŒ‡å®šçº¿ç¨‹æ± æ¥å¹¶è¡Œåœ°æ‰§è¡Œä»»åŠ¡ã€‚</li>
</ul>
<p>ä¸‹é¢æˆ‘ä»¬æ¥éªŒè¯ä¸€ä¸‹åœ¨ Android 11.0 ä¸­æ˜¯ä¸²è¡Œè¿˜æ˜¯å¹¶è¡Œã€‚</p>
<p>æ€ä¹ˆéªŒè¯å‘¢ï¼Ÿæˆ‘ä»¬åŒæ—¶æ‰§è¡Œ 3 ä¸ª AsyncTask, åœ¨ AsyncTask çš„ doInBackground() æ–¹æ³•é‡Œé¢ sleep 2 ç§’åæ‰“å°ä¸€æ¡ Logï¼Œå¦‚æœæ˜¯å¹¶è¡Œæ‰§è¡Œï¼Œå¤§æ¦‚ 2s å·¦å³å°±èƒ½æŠŠ 3 ä¸ª Log éƒ½æ‰“å°å‡ºæ¥ï¼›åä¹‹ï¼Œå¦‚æœæ˜¯ä¸²è¡Œæ‰§è¡Œï¼Œæ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹å¤§æ¦‚éœ€è¦ 6s å·¦å³ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> {

    <span class="hljs-keyword">private</span> MyAsyncTask mTask;

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">TAG</span> <span class="hljs-operator">=</span> <span class="hljs-string">"MyAsyncTask"</span>;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> {
        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
            mTask = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyAsyncTask</span>();
            mTask.execute();
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyAsyncTask</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AsyncTask</span>&lt;Void, Void, Void&gt; {

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onPreExecute</span><span class="hljs-params">()</span> {
            <span class="hljs-built_in">super</span>.onPreExecute();
            Log.d(TAG, <span class="hljs-string">"onPreExecute"</span>);
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">protected</span> Void <span class="hljs-title function_">doInBackground</span><span class="hljs-params">(Void... voids)</span> {
            <span class="hljs-keyword">try</span> {
                Thread.sleep(<span class="hljs-number">2000</span>);
            } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);
            }
            Log.d(TAG, Thread.currentThread().getName() + <span class="hljs-string">": doInBackground"</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onPostExecute</span><span class="hljs-params">(Void unused)</span> {
            <span class="hljs-built_in">super</span>.onPostExecute(unused);
            Log.d(TAG, <span class="hljs-string">"onPostExecute"</span>);
        }
    }
}
</code></pre>
<p>æ‰“å°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-number">2024-04-11 21:59:44.819 </span><span class="hljs-number">10346</span><span class="hljs-number">-10346</span> <span class="hljs-string">MyAsyncTask</span> <span class="hljs-string">com.example.test</span> <span class="hljs-string">D</span> <span class="hljs-string">onPreExecute</span>
<span class="hljs-number">2024-04-11 21:59:44.820 </span><span class="hljs-number">10346</span><span class="hljs-number">-10346</span> <span class="hljs-string">MyAsyncTask</span> <span class="hljs-string">com.example.test</span> <span class="hljs-string">D</span> <span class="hljs-string">onPreExecute</span>
<span class="hljs-number">2024-04-11 21:59:46.821 </span><span class="hljs-number">10346</span><span class="hljs-number">-10371</span> <span class="hljs-string">MyAsyncTask</span> <span class="hljs-string">com.example.test</span> <span class="hljs-string">D</span> <span class="hljs-string">AsyncTask</span> <span class="hljs-comment">#1: doInBackground</span>
<span class="hljs-number">2024-04-11 21:59:46.822 </span><span class="hljs-number">10346</span><span class="hljs-number">-10346</span> <span class="hljs-string">MyAsyncTask</span> <span class="hljs-string">com.example.test</span> <span class="hljs-string">D</span> <span class="hljs-string">onPostExecute</span>
<span class="hljs-number">2024-04-11 21:59:48.834 </span><span class="hljs-number">10346</span><span class="hljs-number">-10372</span> <span class="hljs-string">MyAsyncTask</span> <span class="hljs-string">com.example.test</span> <span class="hljs-string">D</span> <span class="hljs-string">AsyncTask</span> <span class="hljs-comment">#2: doInBackground</span>
<span class="hljs-number">2024-04-11 21:59:48.835 </span><span class="hljs-number">10346</span><span class="hljs-number">-10346</span> <span class="hljs-string">MyAsyncTask</span> <span class="hljs-string">com.example.test</span> <span class="hljs-string">D</span> <span class="hljs-string">onPostExecute</span>
<span class="hljs-number">2024-04-11 21:59:50.842 </span><span class="hljs-number">10346</span><span class="hljs-number">-10371</span> <span class="hljs-string">MyAsyncTask</span> <span class="hljs-string">com.example.test</span> <span class="hljs-string">D</span> <span class="hljs-string">AsyncTask</span> <span class="hljs-comment">#1: doInBackground</span>
<span class="hljs-number">2024-04-11 21:59:50.843 </span><span class="hljs-number">10346</span><span class="hljs-number">-10346</span> <span class="hljs-string">MyAsyncTask</span> <span class="hljs-string">com.example.test</span> <span class="hljs-string">D</span> <span class="hljs-string">onPostExecute</span>
</code></pre>
<p>æ•´ä¸ªè¿‡ç¨‹è€—æ—¶å¤§æ¦‚ 6 ç§’ï¼Œç”±æ­¤å¯çŸ¥åœ¨ Android 11.0 ä¸­ <strong>AsyncTask é»˜è®¤æ˜¯ä¸²è¡Œæ‰§è¡Œå¼‚æ­¥ä»»åŠ¡çš„</strong>ã€‚</p>
<h3 data-id="heading-3">æºç è§£æ</h3>
<p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡æºç æ¥åˆ†æ AsyncTask çš„å®ç°åŸç†ï¼Œå…ˆæ¥çœ‹çœ‹ AsyncTask çš„æ„é€ æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AsyncTask</span>&lt;Params, Progress, Result&gt; {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> InternalHandler sHandler;

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> WorkerRunnable&lt;Params, Result&gt; mWorker;

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> FutureTask&lt;Result&gt; mFuture;

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Handler mHandler;

    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„å¼‚æ­¥ä»»åŠ¡ï¼Œå¿…é¡»åœ¨ UI çº¿ç¨‹ä¸Šè°ƒç”¨æ­¤æ„é€ å‡½æ•°ã€‚</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">AsyncTask</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">this</span>((Looper) <span class="hljs-literal">null</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">AsyncTask</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Handler handler)</span> {
        <span class="hljs-built_in">this</span>(handler != <span class="hljs-literal">null</span> ? handler.getLooper() : <span class="hljs-literal">null</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">AsyncTask</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Looper callbackLooper)</span> {
        mHandler = callbackLooper == <span class="hljs-literal">null</span> || callbackLooper == Looper.getMainLooper()
                ? getMainHandler()
                : <span class="hljs-keyword">new</span> <span class="hljs-title class_">Handler</span>(callbackLooper);

        mWorker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WorkerRunnable</span>&lt;Params, Result&gt;() {
            <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">call</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
                mTaskInvoked.set(<span class="hljs-literal">true</span>);
                <span class="hljs-type">Result</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
                <span class="hljs-keyword">try</span> {
                    Process.setThreadPriority(Process.THREAD_PRIORITY_BACKGROUND);
                    <span class="hljs-comment">//noinspection unchecked</span>
                    result = doInBackground(mParams);
                    Binder.flushPendingCommands();
                } <span class="hljs-keyword">catch</span> (Throwable tr) {
                    mCancelled.set(<span class="hljs-literal">true</span>);
                    <span class="hljs-keyword">throw</span> tr;
                } <span class="hljs-keyword">finally</span> {
                    postResult(result);
                }
                <span class="hljs-keyword">return</span> result;
            }
        };

        mFuture = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FutureTask</span>&lt;Result&gt;(mWorker) {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">done</span><span class="hljs-params">()</span> {
                <span class="hljs-keyword">try</span> {
                    postResultIfNotInvoked(get());
                } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                    android.util.Log.w(LOG_TAG, e);
                } <span class="hljs-keyword">catch</span> (ExecutionException e) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"An error occurred while executing doInBackground()"</span>,
                            e.getCause());
                } <span class="hljs-keyword">catch</span> (CancellationException e) {
                    postResultIfNotInvoked(<span class="hljs-literal">null</span>);
                }
            }
        };
    }
}
</code></pre>
<p>åœ¨ AsyncTask çš„æ„é€ æ–¹æ³•ä¸­ï¼Œåˆ†åˆ«å¯¹ mHandlerã€mWorkerã€mFuture è¿›è¡Œäº†åˆå§‹åŒ–ï¼Œ WorkerRunnable æ˜¯ AsyncTask çš„æŠ½è±¡é™æ€å†…éƒ¨ç±»ï¼Œå®ç°äº† Callable æ¥å£ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WorkerRunnable</span>&lt;Params, Result&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Callable</span>&lt;Result&gt; {
    Params[] mParams;
}
</code></pre>
<p>åœ¨è¿™é‡Œåˆ›å»ºäº† WorkerRunnable çš„å®ä¾‹ mWorkerï¼Œ å¹¶å¯¹ call() æ–¹æ³•è¿›è¡Œäº†å®ç°ï¼Œç„¶åæŠŠ mWorker ä½œä¸ºå‚æ•°ä¼ ç»™äº† FutureTaskï¼ŒFutureTask é‡å†™äº† done() æ–¹æ³•ï¼Œdone() æ–¹æ³•åœ¨ä»»åŠ¡æ‰§è¡Œç»“æŸçš„æ—¶å€™è°ƒç”¨ã€‚</p>
<p>ä¸‹é¢çœ‹çœ‹ AsyncTask çš„ execute() æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AsyncTask</span>&lt;Params, Progress, Result&gt; {

    <span class="hljs-comment">// æŒ‰é¡ºåºä¸€æ¬¡æ‰§è¡Œä¸€ä¸ªä»»åŠ¡</span>
    <span class="hljs-meta">@Deprecated</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Executor</span> <span class="hljs-variable">SERIAL_EXECUTOR</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SerialExecutor</span>();

    <span class="hljs-meta">@UnsupportedAppUsage</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">Executor</span> <span class="hljs-variable">sDefaultExecutor</span> <span class="hljs-operator">=</span> SERIAL_EXECUTOR;

    <span class="hljs-meta">@MainThread</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> AsyncTask&lt;Params, Progress, Result&gt; <span class="hljs-title function_">execute</span><span class="hljs-params">(Params... params)</span> {
        <span class="hljs-keyword">return</span> executeOnExecutor(sDefaultExecutor, params);
    }

    <span class="hljs-meta">@MainThread</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> AsyncTask&lt;Params, Progress, Result&gt; <span class="hljs-title function_">executeOnExecutor</span><span class="hljs-params">(Executor exec,
                                                                       Params... params)</span> {
        <span class="hljs-keyword">if</span> (mStatus != Status.PENDING) {
            <span class="hljs-keyword">switch</span> (mStatus) {
                <span class="hljs-keyword">case</span> RUNNING:
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(<span class="hljs-string">"Cannot execute task:"</span>
                            + <span class="hljs-string">" the task is already running."</span>);
                <span class="hljs-keyword">case</span> FINISHED:
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(<span class="hljs-string">"Cannot execute task:"</span>
                            + <span class="hljs-string">" the task has already been executed "</span>
                            + <span class="hljs-string">"(a task can be executed only once)"</span>);
            }
        }

        mStatus = Status.RUNNING;

        onPreExecute();

        mWorker.mParams = params;
        exec.execute(mFuture);

        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
    }
}
</code></pre>
<p>åœ¨ executeOnExecutor() æ–¹æ³•ä¸­ï¼ŒAsyncTask çš„ onPreExecute æ–¹æ³•æœ€å…ˆæ‰§è¡Œï¼Œç„¶åçº¿ç¨‹æ± å¼€å§‹æ‰§è¡Œã€‚çº¿ç¨‹æ± æ‰§è¡Œå‰ï¼Œä¼šæŠŠ params èµ‹å€¼ç»™ mWorker.mParamsï¼Œçº¿ç¨‹æ± çš„ execute() æ–¹æ³•ä¼ å…¥çš„å‚æ•°ä¸º mFutureã€‚</p>
<p>å½“ä½ è°ƒç”¨ AsyncTask çš„ execute() æ–¹æ³•æ—¶ï¼Œä½¿ç”¨çš„æ˜¯é»˜è®¤çš„çº¿ç¨‹æ±  sDefaultExecutorï¼Œé‡Œé¢æ‰§è¡Œä»»åŠ¡æ˜¯ä¸²è¡Œçš„ã€‚SerialExecutor ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SerialExecutor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Executor</span> {
    <span class="hljs-keyword">final</span> ArrayDeque&lt;Runnable&gt; mTasks = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayDeque</span>&lt;Runnable&gt;();
    Runnable mActive;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">execute</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Runnable r)</span> {
        mTasks.offer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() {
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
                <span class="hljs-keyword">try</span> {
                    r.run();
                } <span class="hljs-keyword">finally</span> {
                    scheduleNext();
                }
            }
        });
        <span class="hljs-keyword">if</span> (mActive == <span class="hljs-literal">null</span>) {
            scheduleNext();
        }
    }

    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">scheduleNext</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> ((mActive = mTasks.poll()) != <span class="hljs-literal">null</span>) {
            THREAD_POOL_EXECUTOR.execute(mActive);
        }
    }
}
</code></pre>
<p>SerialExecutor æ˜¯ AsyncTask çš„å†…éƒ¨ç±»ï¼ŒSerialExecutor çš„ execute() æ–¹æ³•ä¸Šä½¿ç”¨äº† synchronized å…³é”®å­—ä¿®é¥°ï¼Œé”çš„æ˜¯è¿™ä¸ª SerialExecutor çš„å®ä¾‹ï¼Œåˆç”±äº SerialExecutor çš„å®ä¾‹â€”â€”sDefaultExecutor æ˜¯ static volatile ç±»å‹çš„ï¼Œä¸€ä¸ªè¿›ç¨‹ä¸­åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥å¿…é¡»ç­‰å¾…å‰ä¸€ä¸ªä»»åŠ¡åœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡Œå®Œäº†æ‰ä¼šæ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚execute() æ–¹æ³•ä¼ å…¥çš„å‚æ•°ä¸º FutureTaskï¼ŒFutureTask å®ç°äº† Runnable æ¥å£ã€‚execute() æ–¹æ³•é¦–å…ˆä¼šæŠŠ FutureTask å¯¹è±¡æ’å…¥åˆ°ä»»åŠ¡é˜Ÿåˆ— mTasks ä¸­ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™æ²¡æœ‰æ­£åœ¨æ´»åŠ¨çš„ AsyncTask ä»»åŠ¡ï¼Œå°±ä¼šè°ƒç”¨ SerialExecutor çš„ scheduleNext() æ–¹æ³•æ¥æ‰§è¡Œä¸‹ä¸€ä¸ª AsyncTask ä»»åŠ¡ã€‚åŒæ—¶å½“ä¸€ä¸ª AsyncTask ä»»åŠ¡æ‰§è¡Œå®Œåï¼ŒAsyncTask ä¼šç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡ç›´åˆ°æ‰€æœ‰çš„ä»»åŠ¡éƒ½è¢«æ‰§è¡Œä¸ºæ­¢ã€‚</p>
<p>AsyncTask ä¸­çš„å¦ä¸€ä¸ªçº¿ç¨‹æ±  THREAD_POOL_EXECUTOR ç”¨äºçœŸæ­£åœ°æ‰§è¡Œä»»åŠ¡ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CORE_POOL_SIZE</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">MAXIMUM_POOL_SIZE</span> <span class="hljs-operator">=</span> <span class="hljs-number">20</span>;
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">KEEP_ALIVE_SECONDS</span> <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;

<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ThreadFactory</span> <span class="hljs-variable">sThreadFactory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadFactory</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">mCount</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">1</span>);

    <span class="hljs-keyword">public</span> Thread <span class="hljs-title function_">newThread</span><span class="hljs-params">(Runnable r)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(r, <span class="hljs-string">"AsyncTask #"</span> + mCount.getAndIncrement());
    }
};

<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Executor THREAD_POOL_EXECUTOR;

<span class="hljs-keyword">static</span> {
    <span class="hljs-type">ThreadPoolExecutor</span> <span class="hljs-variable">threadPoolExecutor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(
            CORE_POOL_SIZE, MAXIMUM_POOL_SIZE, KEEP_ALIVE_SECONDS, TimeUnit.SECONDS,
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">SynchronousQueue</span>&lt;Runnable&gt;(), sThreadFactory);
    <span class="hljs-comment">// ä»»åŠ¡è¢«æ‹’ç»æ‰§è¡Œçš„ç­–ç•¥ </span>
    threadPoolExecutor.setRejectedExecutionHandler(sRunOnSerialPolicy);
    THREAD_POOL_EXECUTOR = threadPoolExecutor;
}
</code></pre>
<p>THREAD_POOL_EXECUTOR çš„æ ¸å¿ƒçº¿ç¨‹æ•°ä¸º1ï¼Œæœ€å¤§çº¿ç¨‹æ•°ä¸º20ï¼Œé—²ç½®æ—¶é—´ä¸º3ç§’ã€‚</p>
<p>å‰é¢åˆ†æ Android 11.0 ä¸­é»˜è®¤æ˜¯ä¸²è¡Œè¿˜æ˜¯å¹¶è¡Œçš„ä¾‹å­ä¸­ï¼Œä½ å¯ä»¥æŠŠ execute() æ–¹æ³•æ”¹æˆå¹¶è¡Œæ‰§è¡Œçš„æ–¹å¼ï¼Œä¼ å…¥è¿™ä¸ªçº¿ç¨‹æ± ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++){
    mTask = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyAsyncTask</span>();
    mTask.executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR);
}
</code></pre>
<p>å†çœ‹çœ‹æ‰“å°çš„æ—¶é—´æ˜¯ä¸æ˜¯ä¸ä¸€æ ·ã€‚</p>
<p>ç”±äº FutureTask çš„ run() æ–¹æ³•ä¼šè°ƒç”¨ mWorker çš„ call() æ–¹æ³•ï¼Œå› æ­¤ mWorker çš„ call() æ–¹æ³•æœ€ç»ˆä¼šåœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡Œã€‚</p>
<pre><code class="hljs language-java" lang="java">mWorker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WorkerRunnable</span>&lt;Params, Result&gt;() {
    <span class="hljs-keyword">public</span> Result <span class="hljs-title function_">call</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
        mTaskInvoked.set(<span class="hljs-literal">true</span>);
        <span class="hljs-type">Result</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">try</span> {
            Process.setThreadPriority(Process.THREAD_PRIORITY_BACKGROUND);
            <span class="hljs-comment">//noinspection unchecked</span>
            result = doInBackground(mParams);
            Binder.flushPendingCommands();
        } <span class="hljs-keyword">catch</span> (Throwable tr) {
            mCancelled.set(<span class="hljs-literal">true</span>);
            <span class="hljs-keyword">throw</span> tr;
        } <span class="hljs-keyword">finally</span> {
            postResult(result);
        }
        <span class="hljs-keyword">return</span> result;
    }
};
</code></pre>
<p>åœ¨ mWorker çš„ call() æ–¹æ³•ä¸­ï¼Œé¦–å…ˆå°† mTaskInvoked è®¾ä¸º trueï¼Œè¡¨ç¤ºå½“å‰ä»»åŠ¡å·²ç»è¢«è°ƒç”¨è¿‡äº†ï¼Œç„¶åæ‰§è¡Œ doInBackground() æ–¹æ³•ï¼Œæ¥ç€å°†å…¶è¿”å›å€¼ä¼ é€’ç»™ postResult() æ–¹æ³•ï¼Œå®ƒçš„å®ç°å¦‚ä¸‹æ‰€ç¤º:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> Result <span class="hljs-title function_">postResult</span><span class="hljs-params">(Result result)</span> {
    <span class="hljs-type">Message</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> getHandler().obtainMessage(MESSAGE_POST_RESULT,
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">AsyncTaskResult</span>&lt;Result&gt;(<span class="hljs-built_in">this</span>, result));
    message.sendToTarget();
    <span class="hljs-keyword">return</span> result;
}
</code></pre>
<p>postResult() æ–¹æ³•ä¼šé€šè¿‡ mHandler å‘é€ä¸€ä¸ª MESSAGE_POST_RESULT çš„æ¶ˆæ¯ï¼ŒmHandler æ¥è‡ª getMainHandler() æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Handler <span class="hljs-title function_">getMainHandler</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">synchronized</span> (AsyncTask.class) {
        <span class="hljs-keyword">if</span> (sHandler == <span class="hljs-literal">null</span>) {
            sHandler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InternalHandler</span>(Looper.getMainLooper());
        }
        <span class="hljs-keyword">return</span> sHandler;
    }
}
</code></pre>
<p>åœ¨ getMainHandler() æ–¹æ³•ä¸­æ–°å»ºäº† InternalHandler å®ä¾‹ï¼Œä¼ å‚ä¸ºä¸»çº¿ç¨‹çš„ Looper å¯¹è±¡ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ InternalHandler çš„ handleMessage() æ–¹æ³•è¿è¡Œåœ¨ä¸»çº¿ç¨‹ã€‚InternalHandlerä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InternalHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Handler</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">InternalHandler</span><span class="hljs-params">(Looper looper)</span> {
        <span class="hljs-built_in">super</span>(looper);
    }

    <span class="hljs-meta">@SuppressWarnings({"unchecked", "RawUseOfParameterizedType"})</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleMessage</span><span class="hljs-params">(Message msg)</span> {
        AsyncTaskResult&lt;?&gt; result = (AsyncTaskResult&lt;?&gt;) msg.obj;
        <span class="hljs-keyword">switch</span> (msg.what) {
            <span class="hljs-keyword">case</span> MESSAGE_POST_RESULT:
                <span class="hljs-comment">// There is only one result</span>
                result.mTask.finish(result.mData[<span class="hljs-number">0</span>]);
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> MESSAGE_POST_PROGRESS:
                result.mTask.onProgressUpdate(result.mData);
                <span class="hljs-keyword">break</span>;
        }
    }
}
</code></pre>
<p>InternalHandler æ”¶åˆ° MESSAGE_POST_RESULT æ¶ˆæ¯åè°ƒç”¨ AsyncTask çš„ finish() æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">finish</span><span class="hljs-params">(Result result)</span> {
    <span class="hljs-keyword">if</span> (isCancelled()) {
        onCancelled(result);
    } <span class="hljs-keyword">else</span> {
        onPostExecute(result);
    }
    mStatus = Status.FINISHED;
}
</code></pre>
<p>é‡Œé¢åˆ¤æ–­å¦‚æœ AsyncTask è¢«å–æ¶ˆæ‰§è¡Œäº†ï¼Œå°±è°ƒç”¨ onCancelled() æ–¹æ³•ï¼Œå¦åˆ™è°ƒç”¨ onPostExecute() æ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ° doInBackground() çš„è¿”å›ç»“æœä¼šä¼ é€’ç»™ onPostExecute() æ–¹æ³•ï¼Œåˆ°è¿™é‡Œ AsyncTask çš„å·¥ä½œæµç¨‹å°±åˆ†æå®Œæ¯•äº†ã€‚</p>
<p>å‰é¢çš„ä»£ç ä¸­åˆ›å»º THREAD_POOL_EXECUTOR çš„æ—¶å€™ï¼Œç»™å®ƒè®¾ç½®äº†æ‹’ç»ç­–ç•¥ sRunOnSerialPolicyï¼Œå½“THREAD_POOL_EXECUTOR æ‹’ç»æ‰§è¡Œä»»åŠ¡çš„æ—¶å€™ï¼Œå…·ä½“çš„å¤„ç†é€»è¾‘å°±ä¼šåˆ†å‘åˆ° sRunOnSerialPolicy é‡Œé¢çš„rejectedExecution()æ–¹æ³•ï¼Œå…¶ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">BACKUP_POOL_SIZE</span> <span class="hljs-operator">=</span> <span class="hljs-number">5</span>;
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ThreadPoolExecutor sBackupExecutor;
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> LinkedBlockingQueue&lt;Runnable&gt; sBackupExecutorQueue;

<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">RejectedExecutionHandler</span> <span class="hljs-variable">sRunOnSerialPolicy</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RejectedExecutionHandler</span>() {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">rejectedExecution</span><span class="hljs-params">(Runnable r, ThreadPoolExecutor e)</span> {
        android.util.Log.w(LOG_TAG, <span class="hljs-string">"Exceeded ThreadPoolExecutor pool size"</span>);
        <span class="hljs-comment">// As a last ditch fallback, run it on an executor with an unbounded queue.</span>
        <span class="hljs-comment">// Create this executor lazily, hopefully almost never.</span>
        <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) {
            <span class="hljs-keyword">if</span> (sBackupExecutor == <span class="hljs-literal">null</span>) {
                sBackupExecutorQueue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;();
                sBackupExecutor = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(
                        BACKUP_POOL_SIZE, BACKUP_POOL_SIZE, KEEP_ALIVE_SECONDS,
                        TimeUnit.SECONDS, sBackupExecutorQueue, sThreadFactory);
                sBackupExecutor.allowCoreThreadTimeOut(<span class="hljs-literal">true</span>);
            }
        }
        sBackupExecutor.execute(r);
    }
};
</code></pre>
<p>é‡Œé¢å¯ç”¨äº†ä¸€ä¸ªå¤‡ç”¨çš„çº¿ç¨‹æ± ï¼Œæ ¸å¿ƒçº¿ç¨‹æ•°ä¸º 5 ï¼Œè®©å¤‡ç”¨çš„çº¿ç¨‹æ± æ¥æ‰§è¡Œè¢«æ‹’ç»çš„ä»»åŠ¡ã€‚è¿™é‡Œè®¾ç½®äº†æ ¸å¿ƒçº¿ç¨‹ä¹Ÿéµå¾ªé—²æ—¶ç­–ç•¥ï¼Œè®©æ ¸å¿ƒçº¿ç¨‹åœ¨æ²¡æœ‰ä»»åŠ¡æ‰§è¡Œä¸€æ®µæ—¶é—´åè‡ªåŠ¨ç»ˆæ­¢ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>