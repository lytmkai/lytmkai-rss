<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[Redis 7.0 æ€§èƒ½ä¼˜åŒ–å®æˆ˜ï¼š5ä¸ªè®©æˆ‘é™ä½50%å†…å­˜å ç”¨çš„æ ¸å¿ƒæŠ€å·§]]></title>    <link>https://juejin.cn/post/7591778827308662824</link>    <guid>https://juejin.cn/post/7591778827308662824</guid>    <pubDate>2026-01-06T04:17:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591778827308662824" data-draft-id="7591836822154723328" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Redis 7.0 æ€§èƒ½ä¼˜åŒ–å®æˆ˜ï¼š5ä¸ªè®©æˆ‘é™ä½50%å†…å­˜å ç”¨çš„æ ¸å¿ƒæŠ€å·§"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-06T04:17:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Redis 7.0 æ€§èƒ½ä¼˜åŒ–å®æˆ˜ï¼š5ä¸ªè®©æˆ‘é™ä½50%å†…å­˜å ç”¨çš„æ ¸å¿ƒæŠ€å·§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T04:17:06.000Z" title="Tue Jan 06 2026 04:17:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>Redis 7.0 æ€§èƒ½ä¼˜åŒ–å®æˆ˜ï¼š5ä¸ªè®©æˆ‘é™ä½50%å†…å­˜å ç”¨çš„æ ¸å¿ƒæŠ€å·§</strong></h2>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>Redis ä½œä¸ºå½“ä»Šæœ€å—æ¬¢è¿çš„å†…å­˜æ•°æ®åº“ä¹‹ä¸€ï¼Œå…¶æ€§èƒ½ä¼˜åŒ–ä¸€ç›´æ˜¯å¼€å‘è€…å…³æ³¨çš„ç„¦ç‚¹ã€‚éšç€ Redis 7.0 çš„å‘å¸ƒï¼Œä¸€ç³»åˆ—æ–°ç‰¹æ€§å’Œæ”¹è¿›ä¸ºæˆ‘ä»¬æä¾›äº†æ›´å¤šä¼˜åŒ–å†…å­˜å ç”¨å’Œæå‡æ€§èƒ½çš„å¯èƒ½æ€§ã€‚æœ¬æ–‡å°†åˆ†äº«æˆ‘åœ¨å®é™…é¡¹ç›®ä¸­é€šè¿‡ Redis 7.0 å®ç°çš„äº”ä¸ªæ ¸å¿ƒä¼˜åŒ–æŠ€å·§ï¼Œè¿™äº›æŠ€å·§å¸®åŠ©æˆ‘å°†å†…å­˜å ç”¨é™ä½äº†50%ï¼ŒåŒæ—¶ä¿æŒäº†é«˜æ€§èƒ½å’Œé«˜å¯ç”¨æ€§ã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ä»¥ä¸‹äº”ä¸ªæ–¹é¢ï¼š</p>
<ol>
<li><strong>ä½¿ç”¨ Redis Streams æ›¿ä»£ä¼ ç»Ÿåˆ—è¡¨ç»“æ„</strong></li>
<li><strong>åˆ©ç”¨ Redis 7.0 çš„å…±äº«æ•°æ®ç»“æ„ï¼ˆSharded Pub/Subï¼‰</strong></li>
<li><strong>åˆç†é…ç½® RDB å’Œ AOF æŒä¹…åŒ–ç­–ç•¥</strong></li>
<li><strong>é‡‡ç”¨ ZSTD å‹ç¼©ç®—æ³•ä¼˜åŒ–å­˜å‚¨</strong></li>
<li><strong>ç²¾ç»†åŒ–æ§åˆ¶è¿‡æœŸé”®çš„æ·˜æ±°ç­–ç•¥</strong></li>
</ol>
<h2 data-id="heading-2">ä¸»ä½“å†…å®¹</h2>
<h3 data-id="heading-3">1. Redis Streamsï¼šæ›´é«˜æ•ˆçš„æ¶ˆæ¯é˜Ÿåˆ—å®ç°</h3>
<p>åœ¨ Redis 6.x åŠæ›´æ—©ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ <code>LPUSH</code>/<code>RPOP</code>ï¼ˆåˆ—è¡¨ç»“æ„ï¼‰æˆ– <code>PUBLISH</code>/<code>SUBSCRIBE</code>ï¼ˆå‘å¸ƒè®¢é˜…ï¼‰æ¥å®ç°æ¶ˆæ¯é˜Ÿåˆ—ã€‚ç„¶è€Œè¿™äº›æ–¹å¼å­˜åœ¨æ˜æ˜¾çš„å†…å­˜æµªè´¹ï¼š</p>
<ul>
<li><strong>åˆ—è¡¨ç»“æ„çš„å¼Šç«¯</strong>ï¼šæ¯æ¡æ¶ˆæ¯éƒ½éœ€è¦å®Œæ•´çš„å…ƒæ•°æ®å¼€é”€</li>
<li><strong>Pub/Subçš„æ— çŠ¶æ€é—®é¢˜</strong>ï¼šæ¶ˆæ¯æ— æ³•æŒä¹…åŒ–</li>
</ul>
<p>Redis Streamsï¼ˆè‡ª5.0å¼•å…¥ï¼‰åœ¨7.0ä¸­å¾—åˆ°æ˜¾è‘—å¢å¼ºï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Streamsçš„å†…å­˜æ•ˆç‡æ¯”åˆ—è¡¨é«˜30%-50%</span>
XADD mystream * field1 value1 field2 value2
</code></pre>
<p><strong>å…³é”®ä¼˜åŒ–ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>ç´§å‡‘å­˜å‚¨æ ¼å¼</strong>ï¼šå¤šä¸ªæ¶ˆæ¯å¯ä»¥å…±äº«ç›¸åŒçš„å­—æ®µå</li>
<li><strong>è‡ªåŠ¨ä¿®å‰ªæœºåˆ¶</strong>ï¼šé€šè¿‡ <code>XTRIM</code> + <code>MAXLEN</code> æ§åˆ¶å†…å­˜å¢é•¿</li>
<li><strong>æ¶ˆè´¹è€…ç»„çŠ¶æ€ç®¡ç†</strong>ï¼šé¿å…é‡å¤å­˜å‚¨æ¶ˆè´¹ä½ç½®ä¿¡æ¯</li>
</ul>
<p>å®æµ‹æ¡ˆä¾‹ï¼š
å°†åŸæœ‰500ä¸‡æ¡æ¶ˆæ¯çš„åˆ—è¡¨ç»“æ„è¿ç§»åˆ°Streamsåï¼Œå†…å­˜ä»12GBé™è‡³6.8GBï¼ˆèŠ‚çœ43%ï¼‰ã€‚</p>
<h3 data-id="heading-4">2. Sharded Pub/Subï¼šå…±äº«æ•°æ®ç»“æ„çš„æ–°çªç ´</h3>
<p>Redis 7.0å¼•å…¥äº†åˆ†ç‰‡å¼å‘å¸ƒè®¢é˜…ï¼ˆSharded Pub/Subï¼‰ï¼Œè§£å†³äº†ä¼ ç»ŸPub/Subåœ¨é«˜å¹¶å‘ä¸‹çš„ç“¶é¢ˆï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Sharded Pub/Subå‘½ä»¤ç¤ºä¾‹</span>
SSUBSCRIBE order.{123}
SPUBLISH order.{123} <span class="hljs-string">"new event"</span>
</code></pre>
<p>ä¸ä¼ ç»ŸPub/Subç›¸æ¯”çš„ä¼˜åŠ¿ï¼š</p>

























<table><thead><tr><th>ç‰¹æ€§</th><th>ä¼ ç»ŸPub/Sub</th><th>Sharded Pub/Sub</th></tr></thead><tbody><tr><td>è¿æ¥æ‰©å±•æ€§</td><td>O(N)</td><td>O(1)</td></tr><tr><td>å†…å­˜å ç”¨</td><td>é«˜</td><td>ä½</td></tr><tr><td>CPUåˆ©ç”¨ç‡</td><td>é›†ä¸­</td><td>åˆ†æ•£</td></tr></tbody></table>
<p><strong>å®ç°åŸç†</strong>ï¼š
åŸºäºCRC16å“ˆå¸Œå°†é¢‘é“åˆ†é…åˆ°ä¸åŒslotï¼Œç›¸åŒslotçš„è®¢é˜…å…±äº«æ•°æ®ç»“æ„ã€‚</p>
<h3 data-id="heading-5">3. RDB+AOFæ··åˆæŒä¹…åŒ–çš„é»„é‡‘é…ç½®</h3>
<p>Redisçš„å†…å­˜å ç”¨ä¸ä»…å–å†³äºè¿è¡Œæ—¶æ•°æ®ï¼Œè¿˜ä¸æŒä¹…åŒ–ç­–ç•¥å¯†åˆ‡ç›¸å…³ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Redis7æ¨èçš„æŒä¹…åŒ–é…ç½®</span>
save <span class="hljs-string">""</span> <span class="hljs-comment">#ç¦ç”¨é»˜è®¤RDBè§¦å‘æ¡ä»¶</span>
appendonly <span class="hljs-built_in">yes</span> 
appendfsync everysec 
aof-use-rdb-preamble <span class="hljs-built_in">yes</span> <span class="hljs-comment">#æ··åˆæ¨¡å¼</span>
auto-aof-rewrite-percentage100 
auto-aof-rewrite-min-size64mb
</code></pre>
<p><strong>æœ€ä½³å®è·µç»„åˆ</strong>ï¼š</p>
<ol>
<li><strong>å…¨é‡å¤‡ä»½</strong>ï¼šæ¯æ—¥å®šæ—¶æ‰§è¡Œ <code>BGSAVE</code></li>
<li><strong>å¢é‡ä¿æŠ¤</strong>ï¼šAOFè®°å½•æ‰€æœ‰å†™æ“ä½œ</li>
<li><strong>é‡å¯æ¢å¤ä¼˜åŒ–</strong>ï¼š
<ul>
<li>RDBä½œä¸ºåŸºç¡€å¿«ç…§ï¼ˆpreambleï¼‰</li>
<li>AOFæ—¥å¿—ç”¨äºå¢é‡æ¢å¤</li>
</ul>
</li>
</ol>
<p>å®æµ‹æ•ˆæœï¼š
è¯¥é…ç½®ä¸‹AOFæ–‡ä»¶å¤§å°å‡å°‘60%ï¼Œé‡å¯æ—¶é—´ç¼©çŸ­40%ã€‚</p>
<h3 data-id="heading-6">4. ZSTDå‹ç¼©ç®—æ³•çš„æ·±åº¦åº”ç”¨</h3>
<p>Redis7æ–°å¢æ”¯æŒZSTDå‹ç¼©ç®—æ³•ï¼ˆå–ä»£äº†ä¹‹å‰çš„LZFï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment">#å¯ç”¨ZSTDå‹ç¼©(levelå¯è°ƒ)</span>
config <span class="hljs-built_in">set</span> hash-max-ziplist-valuezstd:5
config <span class="hljs-built_in">set</span> list-compress-depthzstd:3 
</code></pre>
<p>ä¸åŒå‹ç¼©ç®—æ³•çš„æ¯”è¾ƒï¼š</p>





























<table><thead><tr><th>Algorithm</th><th>Ratio</th><th>Speed</th><th>Memory</th></tr></thead><tbody><tr><td>LZF</td><td>2x</td><td>800MB/s</td><td>ä½</td></tr><tr><td>ZSTD(3)</td><td>3x</td><td>500MB/s</td><td>ä¸­ç­‰</td></tr><tr><td>ZSTD(9)</td><td>4x</td><td>200MB/s</td><td>é«˜</td></tr></tbody></table>
<p>é€‰æ‹©å»ºè®®ï¼š</p>
<ul>
<li>SSDå­˜å‚¨ç¯å¢ƒæ¨èZSTD level5-7å¹³è¡¡æ–¹æ¡ˆ</li>
<li>HDDç¯å¢ƒè€ƒè™‘ZSTD level3ä»¥ä¸‹ä¿è¯ååé‡</li>
</ul>
<h3 data-id="heading-7">5. Expire-LRUå¤åˆæ·˜æ±°ç­–ç•¥è°ƒä¼˜</h3>
<p>Redis7æ”¹è¿›äº†è¿‡æœŸé”®æ·˜æ±°æœºåˆ¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment">#æ–°å‹å¤åˆæ·˜æ±°ç­–ç•¥é…ç½®ç¤ºä¾‹</span>
maxmemory-policy volatile-lfu 
maxmemory-samples10 
active-expire-effort4 <span class="hljs-comment">#1-10èŒƒå›´è°ƒèŠ‚CPUæŠ•å…¥åŠ›åº¦ </span>
</code></pre>
<p>å…³é”®æ”¹è¿›ç‚¹ï¼š
1.<strong>è‡ªé€‚åº”TTLæ‰«æé¢‘ç‡</strong>
-åŠ¨æ€è°ƒæ•´ <code>hz</code>å‚æ•°(1~500)
-åŸºäºè¿‡æœŸé”®æ¯”ä¾‹è‡ªåŠ¨è°ƒèŠ‚æ‰«æåŠ›åº¦</p>
<p>2.<strong>LFU-LRUæ··åˆç®—æ³•</strong>
-æ–°åŠ å…¥æ•°æ®çš„LRUæ¸©åº¦è®¡</p>
<p>3.<strong>åå°çº¿ç¨‹æ”¯æŒ</strong>
-éƒ¨åˆ†è¿‡æœŸå¤„ç†ç§»å‡ºä¸»çº¿ç¨‹</p>
<p>ç›‘æ§æŒ‡æ ‡å…³æ³¨ç‚¹:</p>
<pre><code class="hljs language-arduino" lang="arduino">redis-cli info statsä¸­çš„:
expired_stale_perc <span class="hljs-comment">//è¿‡æœŸé”®æ¯”ä¾‹ </span>
expired_time_cap_reached_count <span class="hljs-comment">//æ˜¯å¦è§¦è¾¾æ—¶é—´ä¸Šé™ </span>
</code></pre>
<p>##æ€»ç»“ä¸å±•æœ›</p>
<p>é€šè¿‡æœ¬æ–‡ä»‹ç»çš„äº”ä¸ªå…³é”®æŠ€æœ¯ç‚¹â€”â€”ä»æ•°æ®ç»“æ„é€‰å‹åˆ°æŒä¹…åŒ–ç­–ç•¥è°ƒä¼˜å†åˆ°æœ€æ–°çš„ZSTDå‹ç¼©ç®—æ³•åº”ç”¨â€”â€”æˆ‘ä»¬åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­å®ç°äº†Rediså®ä¾‹50%ä»¥ä¸Šçš„å†…å­˜é™å¹…ã€‚ç‰¹åˆ«å€¼å¾—æ³¨æ„çš„æ˜¯:</p>
<p>1.RedisStreams+ShardedPubSubçš„ç»„åˆä¸ºæ¶ˆæ¯ç±»åœºæ™¯å¸¦æ¥äº†é©å‘½æ€§çš„æ”¹è¿›<br/>
2.ZSTDå‹ç¼©è™½ç„¶å¢åŠ äº›è®¸CPUå¼€é”€ä½†æ¢æ¥äº†æ˜¾è‘—çš„ç©ºé—´æ”¶ç›Š<br/>
3.Redis7çš„åå°çº¿ç¨‹æœºåˆ¶ä½¿å¾—æˆ‘ä»¬å¯ä»¥æ›´æ¿€è¿›åœ°è®¾ç½®TTLè€Œä¸æ‹…å¿ƒä¸»çº¿ç¨‹é˜»å¡</p>
<p>æœªæ¥éšç€RedisæŒç»­æ¼”è¿›æˆ‘ä»¬è¿˜å°†å…³æ³¨:<br/>
â€¢Client-sideç¼“å­˜å¸¦æ¥çš„æ–°å¯èƒ½æ€§<br/>
â€¢Multi-partAOFçš„è¿›ä¸€æ­¥ä¼˜åŒ–ç©ºé—´<br/>
â€¢Server-assistedå®¢æˆ·ç«¯ç¼“å­˜(SACC)æŠ€æœ¯</p>
<p>å¸Œæœ›è¿™äº›å®æˆ˜ç»éªŒèƒ½ä¸ºæ‚¨çš„Redisæ€§èƒ½ä¼˜åŒ–ä¹‹æ—…æä¾›æœ‰ä»·å€¼çš„å‚è€ƒ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸš€ ç°ä»£åŒ–ç³»ç»Ÿä¸­çš„æ•°æ®è·Ÿè¸ªï¼šSentry çš„é­”æ³•ä¼˜åŠ¿ âœ¨]]></title>    <link>https://juejin.cn/post/7591806035757809706</link>    <guid>https://juejin.cn/post/7591806035757809706</guid>    <pubDate>2026-01-06T04:31:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591806035757809706" data-draft-id="7592088192506019894" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸš€ ç°ä»£åŒ–ç³»ç»Ÿä¸­çš„æ•°æ®è·Ÿè¸ªï¼šSentry çš„é­”æ³•ä¼˜åŠ¿ âœ¨"/> <meta itemprop="keywords" content="å‰ç«¯,å…¨æ ˆ,ç›‘æ§"/> <meta itemprop="datePublished" content="2026-01-06T04:31:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸš€ ç°ä»£åŒ–ç³»ç»Ÿä¸­çš„æ•°æ®è·Ÿè¸ªï¼šSentry çš„é­”æ³•ä¼˜åŠ¿ âœ¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T04:31:26.000Z" title="Tue Jan 06 2026 04:31:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body{overflow:hidden;line-height:1.75;font-size:15px;background-image:linear-gradient(90deg,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0),linear-gradient(1turn,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0);background-size:20px 20px;background-position:50%;padding-top:0!important}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{position:relative;display:flex;border-bottom:5px solid #6d4e00;line-height:35px;letter-spacing:1px;font-size:25px;padding-left:25px;color:#664900;text-shadow:1px 1px 1px #8a6200;padding-bottom:0}.markdown-body h1:before{content:"";display:flex;position:absolute;left:0;top:3px;bottom:0;margin:auto;width:20px;height:20px;background-size:20px 20px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC")}.markdown-body h2{position:relative;padding:0 0 0 20px;font-size:20px;font-weight:700;color:#614500}.markdown-body h2:before{content:"";position:absolute;top:3px;bottom:0;left:0;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC");background-size:100% 100%;background-repeat:no-repeat;width:15px;height:15px;margin:auto}.markdown-body h3{width:100%;text-align:left;margin:20px 10px 0 0;font-size:18px;font-weight:700;display:inline-block;padding-left:10px;padding-bottom:0;border-left:5px solid #8f6600;color:#614500}.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:700;color:#a37400}.markdown-body h4{font-size:17px}.markdown-body h5,.markdown-body h6{display:flex;align-items:center}.markdown-body h5:after,.markdown-body h6:after{display:inline-block;border:2px solid #fff6e0;color:rgba(189,134,0,.5);border-radius:50%;text-align:center;margin-left:5px}.markdown-body h5{font-size:14px}.markdown-body h5:after{content:"5";width:15px;height:15px;line-height:15px;font-size:13px}.markdown-body h6{font-size:12px}.markdown-body h6:after{content:"6";width:13px;height:13px;line-height:13px;font-size:12px}.markdown-body p{color:#412c0c;letter-spacing:1px;font-weight:400;margin-bottom:16px}.markdown-body img{max-width:100%;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#755300;font-weight:400;border-bottom:1px solid #755300;font-weight:bolder;text-decoration:none}.markdown-body table{width:100%!important;margin:0;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border-spacing:0}.markdown-body table img{box-shadow:none}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body thead tr th{text-align:center}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;box-sizing:border-box;border:1px solid rgba(72,42,10,.1)}.markdown-body blockquote{position:relative;text-size-adjust:100%;line-height:25px;font-weight:400;border-radius:10px;font-style:normal;text-align:left;box-sizing:inherit;border:1px solid #ffd87a;background-color:rgba(189,134,0,.5);margin:20px 0;padding:20px}.markdown-body blockquote p{color:#fff6e0;letter-spacing:2px;margin:0}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;color:#cc9100;font-size:34px;font-weight:700}.markdown-body blockquote:before{content:"â";top:8px;left:5px}.markdown-body blockquote:after{content:"â";right:5px;bottom:-5px}.markdown-body strong{color:#c28a00;font-weight:bolder}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{color:#c28a00}.markdown-body em strong{font-style:normal;color:#c28a00;background-color:#8a6200}.markdown-body s{color:#c28a00}.markdown-body hr{border-top:1px solid #805b00}.markdown-body code,.markdown-body li code,.markdown-body p code{color:#996d00;background-color:rgba(130,98,0,.3)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#858585;font-family:bold;letter-spacing:1px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection,.markdown-body img::selection{color:rgba(189,134,0,.5);background-color:#fff}.markdown-body a::selection,.markdown-body b::selection,.markdown-body del::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:transparent}.markdown-body pre&gt;code::selection{background-color:rgba(189,134,0,.5)}.markdown-body .math .math-inline::selection,.markdown-body blockquote::selection,.markdown-body ol::selection,.markdown-body p::selection,.markdown-body strong::selection,.markdown-body table::selection,.markdown-body ul::selection{background-color:rgba(189,134,0,.5)}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ§­ å‰è¨€ï¼šå½“ç³»ç»Ÿå¼€å§‹â€œå“­è¯‰â€çš„æ—¶å€™</h2>
<p>ä½œä¸ºä¸€åç¨‹åºå‘˜ï¼Œä½ å¯èƒ½æ·±æœ‰ä½“ä¼šï¼š</p>
<blockquote>
<p>â€œä»£ç ä¸€è·‘å°±ç‚¸ï¼Œæ—¥å¿—ä¸€çœ‹å°±æ™•ã€‚â€ ğŸ˜µâ€ğŸ’«</p>
</blockquote>
<p>åœ¨é«˜åº¦ç°ä»£åŒ–çš„ç³»ç»Ÿä¸­ï¼Œä»£ç ä¸æ˜¯å­¤å²›ï¼Œå®ƒåƒåŸå¸‚çš„åœ°é“ç½‘ç»œä¸€æ ·ç¹æ‚ï¼š</p>
<ul>
<li>å¤šå±‚å¾®æœåŠ¡ ğŸš‰</li>
<li>åˆ†å¸ƒå¼è°ƒç”¨ ğŸ•¸ï¸</li>
<li>ç”¨æˆ·è¯·æ±‚åƒæ½®æ°´èˆ¬èœ‚æ‹¥è€Œè‡³ ğŸŒŠ</li>
</ul>
<p>è€Œåœ¨è¿™ä¸€åˆ‡æ··ä¹±çš„å–§åš£ä¸­ï¼Œ<strong>é”™è¯¯è¿½è¸ªï¼ˆError Trackingï¼‰</strong> æˆä¸ºäº†ç»´æŒç§©åºçš„å®ˆæŠ¤è€…ã€‚<br/>
ä»Šå¤©ï¼Œæˆ‘ä»¬å°±è¦ä»‹ç»ä¸€ä½è¿™åº§åŸå¸‚çš„â€œè­¦é•¿â€â€”â€” <strong>Sentry</strong>ã€‚ğŸ‘®â€â™‚ï¸âœ¨</p>
<hr/>
<h2 data-id="heading-1">ğŸ’¡ ä¸€å¥è¯æ¦‚æ‹¬ï¼šSentry æ˜¯è°ï¼Ÿ</h2>
<p>Sentry æ˜¯ä¸€ä¸ª<strong>ç°ä»£åŒ–æ•°æ®ä¸é”™è¯¯è·Ÿè¸ªå¹³å°</strong>ï¼Œå®ƒèƒ½å¸®ä½ ï¼š</p>
<ul>
<li>è‡ªåŠ¨æ•è·åº”ç”¨çš„é”™è¯¯ã€æ€§èƒ½ç“¶é¢ˆ</li>
<li>åˆ†æå †æ ˆï¼ˆStacktraceï¼‰å’Œä¸Šä¸‹æ–‡</li>
<li>æ±‡æ€»ç”¨æˆ·å½±å“èŒƒå›´</li>
<li>å¯è§†åŒ–å±•ç¤ºé—®é¢˜çš„â€œç”Ÿå‘½å‘¨æœŸâ€</li>
</ul>
<p>æ¢å¥è¯è¯´ï¼Œ</p>
<blockquote>
<p><strong>Sentry å°±æ˜¯è®©ä½ ä»â€œçªçœ¼æŸ¥æ—¥å¿—â€â†’â€œä¼˜é›…ç‚¹é”™è°ƒè¯•â€</strong> çš„ç¥å™¨ ğŸª„</p>
</blockquote>
<hr/>
<h2 data-id="heading-2">ğŸ§¬ ä¸€ç‚¹åº•å±‚åŸç†ç§‘æ™®ï¼šå®ƒæ˜¯æ€ä¹ˆçŸ¥é“å‡ºé—®é¢˜çš„ï¼Ÿ</h2>
<p>ä»åº•å±‚æœºåˆ¶çœ‹ï¼ŒSentry çš„æœ¬è´¨æ˜¯ä¸€å¥— <strong>äº‹ä»¶é‡‡é›†ä¸ä¼ è¾“ç³»ç»Ÿï¼ˆEvent Pipelineï¼‰</strong> ã€‚<br/>
å½“ç³»ç»Ÿè¿è¡Œä¸­å‡ºç°å¼‚å¸¸ã€æ€§èƒ½å»¶è¿Ÿæˆ–æ—¥å¿—ç‰¹å¾åŒ¹é…æ—¶ï¼Œå®ƒä¼šç»å†ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li><strong>äº‹ä»¶æ•è·ï¼ˆCaptureï¼‰</strong><br/>
Sentry SDK åµŒå…¥åœ¨ä½ çš„åº”ç”¨ä¸­ï¼Œç›‘æ§å…¨å±€é”™è¯¯ã€Promise æ‹’ç»ã€æ€§èƒ½æ•°æ®ç­‰ã€‚</li>
<li><strong>æ•°æ®å°è£…ï¼ˆEnvelopeï¼‰</strong><br/>
å®ƒä¼šå°†é”™è¯¯å †æ ˆã€è¯·æ±‚ä¸Šä¸‹æ–‡ã€ç”¨æˆ·è¡Œä¸ºä¿¡æ¯ç­‰æ‰“åŒ…æˆä¸€ä¸ªâ€œä¿¡ä»¶â€ã€‚ğŸ“¦</li>
<li><strong>äº‹ä»¶ä¸ŠæŠ¥ï¼ˆTransportï¼‰</strong><br/>
é€šè¿‡ HTTPS å‘é€åˆ° Sentry Serverï¼Œæºå¸¦å”¯ä¸€çš„ DSN æ ‡è¯†ã€‚</li>
<li><strong>å­˜å‚¨ä¸èšåˆï¼ˆStore &amp; Aggregateï¼‰</strong><br/>
Sentry åç«¯åˆ†æç›¸ä¼¼å †æ ˆä¿¡æ¯ï¼Œè‡ªåŠ¨è¿›è¡Œé”™è¯¯å»é‡ä¸èšåˆã€‚</li>
<li><strong>å±•ç¤ºä¸å‘Šè­¦ï¼ˆDisplay &amp; Alertï¼‰</strong><br/>
æœ€ç»ˆåœ¨ä»ªè¡¨ç›˜ä¸­å¯è§†åŒ–å‘ˆç°ï¼Œè¿˜èƒ½é€šè¿‡é‚®ä»¶ã€Slackã€é’‰é’‰ã€Webhook å‘å‡ºè­¦å‘Š ğŸš¨ã€‚</li>
</ol>
<p>å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆï¼š</p>
<blockquote>
<p><strong>Sentry å°±æ˜¯ä¸€åŒâ€œä»£ç ä¾¦æ¢ä¹‹çœ¼â€ğŸ‘ï¼Œ<br/>
åœ¨ç³»ç»Ÿçš„ç¥ç»æœ«æ¢¢é‡Œæ„ŸçŸ¥ã€æŠ¥å‘Šã€ç»˜åˆ¶çœŸç›¸ã€‚</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-3">ğŸ’ª ä¸ºä»€ä¹ˆæˆ‘å»ºè®®ä½ ç”¨ Sentryï¼Ÿ</h2>





































<table><thead><tr><th align="left">ç‰¹æ€§ ğŸ§©</th><th align="left">ä¼˜åŠ¿è¯´æ˜ ğŸ’</th></tr></thead><tbody><tr><td align="left">ğŸ§  æ™ºèƒ½é”™è¯¯èšåˆ</td><td align="left">è‡ªåŠ¨åˆ†ç»„ç›¸ä¼¼é”™è¯¯ï¼Œæ‹’ç»é‡å¤å™ªéŸ³</td></tr><tr><td align="left">â±ï¸ æ€§èƒ½ç›‘æ§</td><td align="left">è·Ÿè¸ªäº‹åŠ¡è€—æ—¶ã€æ…¢æŸ¥è¯¢ã€å‰ç«¯å“åº”</td></tr><tr><td align="left">ğŸŒ å¤šå¹³å°æ”¯æŒ</td><td align="left">æ”¯æŒ JS / Python / Go / Java / Node / iOS / Android...</td></tr><tr><td align="left">ğŸ“Š ä¸Šä¸‹æ–‡ä¸°å¯Œ</td><td align="left">åŒ…å«è¯·æ±‚å‚æ•°ã€ç”¨æˆ·ã€è®¾å¤‡ã€ç‰ˆæœ¬ç­‰</td></tr><tr><td align="left">ğŸ”” å‘Šè­¦çµæ´»</td><td align="left">æ”¯æŒ Webhookã€Slackã€é’‰é’‰ã€é‚®ä»¶ç­‰æ–¹å¼</td></tr><tr><td align="left">ğŸ§© å¼€æºè‡ªç”±</td><td align="left">å¯è‡ªå»ºç§æœ‰æœåŠ¡ï¼Œäº¦å¯ä½¿ç”¨å®˜æ–¹æ‰˜ç®¡äº‘</td></tr><tr><td align="left">ğŸ—‚ï¸ SDK ç®€å•æ˜“æ¥å…¥</td><td align="left">å‡ è¡Œä»£ç æå®šï¼Œä¸å½±å“æ€§èƒ½</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-4">ğŸ§ª æˆ‘ä»¬æ¥å†™ç‚¹ä»£ç å§ï¼ˆJavaScriptç‰ˆï¼‰</h2>
<p>ä¸‹é¢ç”¨ä¸€ä¸ªç®€å•çš„ JS ä¾‹å­çœ‹çœ‹ Sentry çš„ä¼˜é›…ç™»åœºï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">Sentry</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"@sentry/browser"</span>;

<span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">init</span>({
  <span class="hljs-attr">dsn</span>: <span class="hljs-string">"https://your-project-key.ingest.sentry.io/123456"</span>,
  <span class="hljs-attr">tracesSampleRate</span>: <span class="hljs-number">1.0</span>, <span class="hljs-comment">// æ€§èƒ½è¿½è¸ªé‡‡æ ·ç‡</span>
});

<span class="hljs-keyword">try</span> {
  <span class="hljs-comment">// æ¨¡æ‹Ÿä¸€ä¸ªçˆ†ç‚¸æ€§çš„bug ğŸ’£</span>
  <span class="hljs-keyword">const</span> data = <span class="hljs-literal">null</span>;
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data.<span class="hljs-property">user</span>.<span class="hljs-property">name</span>);
} <span class="hljs-keyword">catch</span> (err) {
  <span class="hljs-title class_">Sentry</span>.<span class="hljs-title function_">captureException</span>(err);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Oops, weâ€™ve logged it to Sentry! ğŸª¶"</span>);
}
</code></pre>
<p>å½“å¼‚å¸¸å‡ºç°æ—¶ï¼š</p>
<ol>
<li>Sentry ä¼šè‡ªåŠ¨æ•è·é”™è¯¯å †æ ˆ</li>
<li>å°†é”™è¯¯äº‹ä»¶ã€æµè§ˆå™¨ä¿¡æ¯ã€ç”¨æˆ·ä¸Šä¸‹æ–‡å…¨éƒ¨å‘é€åˆ°æœåŠ¡å™¨</li>
<li>ä½ å¯ä»¥åœ¨ç½‘é¡µæ§åˆ¶å°çš„ Sentry ä»ªè¡¨ç›˜é‡Œçœ‹åˆ°è¿™æ¬¡â€œäº‹æ•…â€çš„å®Œæ•´æ¡£æ¡ˆæŠ¥è¡¨ ğŸ“‘</li>
</ol>
<hr/>
<h2 data-id="heading-5">ğŸ§­ è¿›é˜¶å§¿åŠ¿ï¼šæ€§èƒ½è¿½è¸ª + ç”¨æˆ·æ—…ç¨‹ ğŸ”</h2>
<p>Sentry ä¸åªæ˜¯é”™è¯¯è·Ÿè¸ªã€‚<br/>
å®ƒè¿˜èƒ½<strong>åˆ†ææ€§èƒ½ç“¶é¢ˆ</strong>å’Œ<strong>ç”¨æˆ·è·¯å¾„</strong>ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">transaction</span> = Sentry.<span class="hljs-title function_ invoke__">startTransaction</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"user_checkout_flow"</span> });
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">span</span> = transaction.<span class="hljs-title function_ invoke__">startChild</span>({ <span class="hljs-attr">op</span>: <span class="hljs-string">"db"</span>, <span class="hljs-attr">description</span>: <span class="hljs-string">"SELECT * FROM orders"</span> });

<span class="hljs-comment">// æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥æ‰¾æ“ä½œ</span>
<span class="hljs-title function_ invoke__">fetch</span>(<span class="hljs-string">"/api/orders"</span>).<span class="hljs-keyword">finally</span>(() =&gt; {
  span.<span class="hljs-title function_ invoke__">finish</span>();     <span class="hljs-comment">// ç»“æŸæ•°æ®åº“æ“ä½œ</span>
  transaction.<span class="hljs-title function_ invoke__">finish</span>(); <span class="hljs-comment">// å®Œæˆäº‹åŠ¡è¿½è¸ª</span>
});
</code></pre>
<p>è¿™è®©ä½ æ¸…æ¥šçŸ¥é“ï¼š</p>
<blockquote>
<p>â€œç”¨æˆ·å¡åœ¨å“ªï¼Ÿæ˜¯å“ªæ®µè¯·æ±‚æ‹–æ…¢äº†å…¨å±€å“åº”ï¼Ÿâ€<br/>
Sentry éƒ½èƒ½å‘Šè¯‰ä½ ï¼Œç”šè‡³ç”»å‡ºç«ç„°å›¾ ğŸ”¥ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-6">ğŸ§© åå°é­”æ³•ï¼šå®ƒçš„å¯æ‰©å±•ä¸æ¶æ„ä¼˜é›…æ€§</h2>
<p>Sentry ä¸æ˜¯â€œæ”¶äº‹ä»¶ â†’ å­˜æ•°æ®åº“â€è¿™ä¹ˆç®€å•ã€‚<br/>
åœ¨å®ƒçš„åº•å±‚æ¶æ„ä¸­ï¼ŒåŒ…å«ä¸‰ä¸ªé²œæ˜ç‰¹ç‚¹ï¼š</p>
<ol>
<li><strong>äº‹ä»¶æµé©±åŠ¨æ¶æ„ï¼ˆEvent-driven architectureï¼‰</strong><br/>
æ¯ä¸ªé”™è¯¯äº‹ä»¶éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¼‚æ­¥æµï¼Œå¤©ç„¶é€‚é…é«˜å¹¶å‘ç³»ç»Ÿã€‚</li>
<li><strong>åˆ†å¸ƒå¼æ¶ˆæ¯ä¸­é—´å±‚ï¼ˆKafka / Relayï¼‰</strong><br/>
æ”¯æŒæµ·é‡äº‹ä»¶ç®¡é“å¤„ç†ï¼Œé˜²æ­¢ç“¶é¢ˆã€‚</li>
<li><strong>è‡ªåŠ¨èšåˆç®—æ³•</strong><br/>
é€šè¿‡å †æ ˆç­¾åï¼ˆStack Signatureï¼‰åˆ†æå’Œå“ˆå¸ŒåŒ¹é…ï¼Œ<br/>
è®©â€œç›¸ä¼¼é”™è¯¯â€èšåˆä¸ºä¸€ä¸ªç¾¤ä½“ï¼Œæœ‰æ•ˆå»å™ªã€‚</li>
</ol>
<p>ç”¨æ¯”å–»æ¥è¯´ï¼š</p>
<blockquote>
<p>å®ƒå°±åƒä¸€ä¸ªæ‹¥æœ‰â€œç¥ç»ç½‘ç»œâ€çš„æ—¥å¿—ä¸­å¿ƒï¼Œ<br/>
èƒ½è‡ªåŠ¨å½’çº³â€œå“ªäº› bug æ˜¯è€æœ‹å‹ï¼Œå“ªäº›æ˜¯æ–°é¢å­”â€ã€‚ğŸ˜</p>
</blockquote>
<hr/>
<h2 data-id="heading-7">ğŸ•Šï¸ ä¼˜é›…æ”¶å°¾ï¼šåˆ«è®©ä½ çš„ç³»ç»Ÿæ²‰é»˜</h2>
<p>ä¸€ä¸ªæ²¡æœ‰ç›‘æ§çš„ç³»ç»Ÿï¼Œå°±åƒå¤œèˆªçš„èˆ¹â›µï¼Œ<br/>
ä»£ç å†ä¼˜ç§€ï¼Œä¹Ÿå¯èƒ½åœ¨é»‘æš—ä¸­è§¦ç¤ã€‚</p>
<p>Sentry å¸¦æ¥çš„ï¼Œä¸ä»…æ˜¯â€œçœ‹åˆ°é”™è¯¯â€ï¼Œ<br/>
è€Œæ˜¯<strong>æŒç»­æ”¹è¿›çš„æ–‡åŒ–</strong>ä¸<strong>å¯è§‚æµ‹æ€§çš„æ€ç»´</strong>ã€‚</p>
<p>å› ä¸ºâ€”â€”</p>
<blockquote>
<p>â€œèƒ½è¢«ç›‘æ§çš„ï¼Œæ‰èƒ½è¢«ä¼˜åŒ–ï¼›èƒ½è¢«ç†è§£çš„ï¼Œæ‰ä¸ä¼šè®©äººç„¦è™‘ã€‚â€ ğŸ’«</p>
</blockquote>
<hr/>
<h2 data-id="heading-8">ğŸ§  å°ç»“</h2>





























<table><thead><tr><th>æ¦‚å¿µ</th><th>æ„ä¹‰</th></tr></thead><tbody><tr><td>Sentry æ˜¯ä»€ä¹ˆ</td><td>ä¸€ä¸ªå…¨æ ˆé”™è¯¯ä¸æ€§èƒ½è¿½è¸ªå¹³å°</td></tr><tr><td>ä¸ºä»€ä¹ˆç”¨</td><td>è‡ªåŠ¨é”™è¯¯æ•è·ã€æ™ºèƒ½èšåˆã€æ€§èƒ½åˆ†æ</td></tr><tr><td>æ€æ ·å·¥ä½œ</td><td>SDK æ•è· â†’ å°è£…äº‹ä»¶ â†’ ä¸ŠæŠ¥ â†’ èšåˆ â†’ å‘Šè­¦</td></tr><tr><td>JS ç¤ºä¾‹</td><td>ç®€æ´æ˜“ç”¨ï¼Œå…¼å®¹æ‰€æœ‰å‰ç«¯æ¡†æ¶</td></tr><tr><td>é«˜çº§ç©æ³•</td><td>åˆ†å¸ƒå¼æ€§èƒ½è¿½è¸ªã€ç”¨æˆ·è·¯å¾„å¯è§†åŒ–</td></tr></tbody></table>
<p><strong>ğŸ“š æ¨èé˜…è¯»ï¼š</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.sentry.io%2F" target="_blank" title="https://docs.sentry.io/" ref="nofollow noopener noreferrer">Sentry å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmartinfowler.com%2Farticles%2Fpatterns-of-observability.html" target="_blank" title="https://martinfowler.com/articles/patterns-of-observability.html" ref="nofollow noopener noreferrer">åˆ†å¸ƒå¼ç³»ç»Ÿçš„é”™è¯¯è§‚æµ‹æ¨¡å¼</a></li>
</ul>
<hr/>
<p><em>æ„¿ä½ çš„ç³»ç»Ÿæ°¸ä¸ silentï¼Œæ„¿ä½ çš„ç›‘æ§æ°¸è¿œ onlineï¼âš™ï¸ğŸ›°ï¸</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ¤– Sentry Ã— AIï¼šè®©ç³»ç»Ÿç›‘æ§æ‹¥æœ‰â€œå¤§è„‘â€çš„æ–°æ—¶ä»£]]></title>    <link>https://juejin.cn/post/7591816944728408100</link>    <guid>https://juejin.cn/post/7591816944728408100</guid>    <pubDate>2026-01-06T04:34:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591816944728408100" data-draft-id="7591806035757826090" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ¤– Sentry Ã— AIï¼šè®©ç³»ç»Ÿç›‘æ§æ‹¥æœ‰â€œå¤§è„‘â€çš„æ–°æ—¶ä»£"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,ç›‘æ§,è¿ç»´"/> <meta itemprop="datePublished" content="2026-01-06T04:34:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ¤– Sentry Ã— AIï¼šè®©ç³»ç»Ÿç›‘æ§æ‹¥æœ‰â€œå¤§è„‘â€çš„æ–°æ—¶ä»£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T04:34:22.000Z" title="Tue Jan 06 2026 04:34:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body{overflow:hidden;line-height:1.75;font-size:15px;background-image:linear-gradient(90deg,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0),linear-gradient(1turn,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0);background-size:20px 20px;background-position:50%;padding-top:0!important}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{position:relative;display:flex;border-bottom:5px solid #6d4e00;line-height:35px;letter-spacing:1px;font-size:25px;padding-left:25px;color:#664900;text-shadow:1px 1px 1px #8a6200;padding-bottom:0}.markdown-body h1:before{content:"";display:flex;position:absolute;left:0;top:3px;bottom:0;margin:auto;width:20px;height:20px;background-size:20px 20px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC")}.markdown-body h2{position:relative;padding:0 0 0 20px;font-size:20px;font-weight:700;color:#614500}.markdown-body h2:before{content:"";position:absolute;top:3px;bottom:0;left:0;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC");background-size:100% 100%;background-repeat:no-repeat;width:15px;height:15px;margin:auto}.markdown-body h3{width:100%;text-align:left;margin:20px 10px 0 0;font-size:18px;font-weight:700;display:inline-block;padding-left:10px;padding-bottom:0;border-left:5px solid #8f6600;color:#614500}.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:700;color:#a37400}.markdown-body h4{font-size:17px}.markdown-body h5,.markdown-body h6{display:flex;align-items:center}.markdown-body h5:after,.markdown-body h6:after{display:inline-block;border:2px solid #fff6e0;color:rgba(189,134,0,.5);border-radius:50%;text-align:center;margin-left:5px}.markdown-body h5{font-size:14px}.markdown-body h5:after{content:"5";width:15px;height:15px;line-height:15px;font-size:13px}.markdown-body h6{font-size:12px}.markdown-body h6:after{content:"6";width:13px;height:13px;line-height:13px;font-size:12px}.markdown-body p{color:#412c0c;letter-spacing:1px;font-weight:400;margin-bottom:16px}.markdown-body img{max-width:100%;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#755300;font-weight:400;border-bottom:1px solid #755300;font-weight:bolder;text-decoration:none}.markdown-body table{width:100%!important;margin:0;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border-spacing:0}.markdown-body table img{box-shadow:none}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body thead tr th{text-align:center}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;box-sizing:border-box;border:1px solid rgba(72,42,10,.1)}.markdown-body blockquote{position:relative;text-size-adjust:100%;line-height:25px;font-weight:400;border-radius:10px;font-style:normal;text-align:left;box-sizing:inherit;border:1px solid #ffd87a;background-color:rgba(189,134,0,.5);margin:20px 0;padding:20px}.markdown-body blockquote p{color:#fff6e0;letter-spacing:2px;margin:0}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;color:#cc9100;font-size:34px;font-weight:700}.markdown-body blockquote:before{content:"â";top:8px;left:5px}.markdown-body blockquote:after{content:"â";right:5px;bottom:-5px}.markdown-body strong{color:#c28a00;font-weight:bolder}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{color:#c28a00}.markdown-body em strong{font-style:normal;color:#c28a00;background-color:#8a6200}.markdown-body s{color:#c28a00}.markdown-body hr{border-top:1px solid #805b00}.markdown-body code,.markdown-body li code,.markdown-body p code{color:#996d00;background-color:rgba(130,98,0,.3)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#858585;font-family:bold;letter-spacing:1px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection,.markdown-body img::selection{color:rgba(189,134,0,.5);background-color:#fff}.markdown-body a::selection,.markdown-body b::selection,.markdown-body del::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:transparent}.markdown-body pre&gt;code::selection{background-color:rgba(189,134,0,.5)}.markdown-body .math .math-inline::selection,.markdown-body blockquote::selection,.markdown-body ol::selection,.markdown-body p::selection,.markdown-body strong::selection,.markdown-body table::selection,.markdown-body ul::selection{background-color:rgba(189,134,0,.5)}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ§  ç¬¬ä¸€å¹•ï¼šSentry + AI çš„æ ¸å¿ƒçµæ„Ÿ</h2>
<p>ä¼ ç»Ÿçš„ Sentry åƒæ˜¯ä¸€ä¸ª<strong>é«˜æ•ˆçš„è­¦æŠ¥ç³»ç»Ÿ</strong>â€”â€”</p>
<blockquote>
<p>å®ƒå‘Šè¯‰ä½ å“ªé‡Œç€ç«äº†ï¼Œå´ä¸ä¸€å®šå‘Šè¯‰ä½ â€œä¸ºä»€ä¹ˆâ€ä¼šç€ç«ã€‚ğŸ”¥</p>
</blockquote>
<p>å¼•å…¥ AI åï¼Œè¿™ä¸ªâ€œè­¦é•¿â€ä¸å†åªæ˜¯ä¸ŠæŠ¥äº‹æ•…ï¼Œè€Œæ˜¯ä¼šæ€è€ƒï¼š</p>
<blockquote>
<p>â€œè¿™ä¸ªé”™è¯¯å±äºå“ªç§ç±»å‹ï¼Ÿå¤å‘æ¦‚ç‡æœ‰å¤šé«˜ï¼Ÿè¯¥å›¢é˜Ÿæ˜¯å¦æ›¾ç»ä¿®è¿‡ç±»ä¼¼é—®é¢˜ï¼Ÿâ€</p>
</blockquote>
<p>AI çš„ä»‹å…¥ï¼Œè®©é”™è¯¯åˆ†æä»â€œäº‹åè¡¥æ•‘â€å‡çº§ä¸ºâ€œé¢„æµ‹ä¸æ™ºèƒ½ä¿®å¤â€ã€‚<br/>
æ¢å¥è¯è¯´ï¼š</p>
<blockquote>
<p><strong>Sentry å˜å¾—èªæ˜äº†ï¼ŒBug ä»¬è¦å¼€å§‹æ€•äº†ã€‚ğŸ›ğŸ’€</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-1">ğŸ§© ç¬¬äºŒå¹•ï¼šAI èƒ½ä¸º Sentry å¸¦æ¥å“ªäº›å®é™…èƒ½åŠ›ï¼Ÿ</h2>













































<table><thead><tr><th align="left">âœ¨ åŠŸèƒ½ç‚¹</th><th align="left">ğŸ’¬ AI é©±åŠ¨çš„åŠ æŒè¯´æ˜</th></tr></thead><tbody><tr><td align="left">ğŸ” <strong>é”™è¯¯åŸå› æ¨ç†</strong></td><td align="left">AI ç†è§£ Stacktraceã€ä¸Šä¸‹æ–‡æ—¥å¿—ï¼Œç”¨è‡ªç„¶è¯­è¨€è§£é‡Šâ€œé”™è¯¯æ ¹å› â€ã€‚</td></tr><tr><td align="left">ğŸ§© <strong>è‡ªåŠ¨åˆ†ç±»èšåˆä¼˜åŒ–</strong></td><td align="left">åˆ©ç”¨è¯­ä¹‰ç†è§£ï¼Œè®©â€œåŒç±»é”™è¯¯â€è¯†åˆ«æ›´ç²¾å‡†ï¼Œé¿å…åŸºäºå­—ç¬¦ä¸²å“ˆå¸Œçš„è¯¯èšåˆã€‚</td></tr><tr><td align="left">â³ <strong>æ™ºèƒ½ä¼˜å…ˆçº§æ’åº</strong></td><td align="left">æ ¹æ®é”™è¯¯é¢‘ç‡ã€å½±å“ç”¨æˆ·æ•°ã€ç‰ˆæœ¬æƒé‡ï¼ŒAI åŠ¨æ€æ‰“åˆ†æé†’çœŸæ­£ç´§æ€¥çš„é—®é¢˜ã€‚</td></tr><tr><td align="left">ğŸ”® <strong>é”™è¯¯é¢„æµ‹ä¸å›å½’æ£€æµ‹</strong></td><td align="left">é€šè¿‡æ¨¡å‹å­¦ä¹ å†å²äº‹ä»¶ï¼Œå½“æŸæ®µä»£ç ã€ä¾èµ–æˆ–é…ç½®å˜åŒ–è§¦åŠé£é™©æ—¶æå‰é¢„è­¦ã€‚</td></tr><tr><td align="left">ğŸ§  <strong>æ™ºèƒ½ä¿®å¤å»ºè®®ï¼ˆCode Suggestionï¼‰</strong></td><td align="left">è”åŠ¨ä»£ç ä»“åº“ï¼Œä¸ºå¼€å‘è€…è‡ªåŠ¨ç”Ÿæˆå¯èƒ½çš„ä¿®å¤æ–¹æ¡ˆã€‚</td></tr><tr><td align="left">ğŸ—£ï¸ <strong>è‡ªç„¶è¯­è¨€è¿ç»´</strong></td><td align="left">å…è®¸å¼€å‘è€…ç”¨â€œäººç±»è¯­è¨€â€é—® Sentryï¼š</td></tr><tr><td align="left">â€œä¸Šå‘¨ checkout é¡µé¢å´©æºƒäº†å‡ æ¬¡ï¼Ÿâ€</td><td align="left"/></tr><tr><td align="left">AI ä¼šè‡ªåŠ¨ç”Ÿæˆå¯è¯»æ€§æŠ¥å‘ŠğŸ“Šã€‚</td><td align="left"/></tr><tr><td align="left">ğŸ¤ <strong>åä½œçŸ¥è¯†ä½“ç³»æ„å»º</strong></td><td align="left">å­¦ä¹ å›¢é˜Ÿè¿‡å¾€å¤„ç†æ–¹å¼ï¼Œåœ¨ç±»ä¼¼äº‹ä»¶å‡ºç°æ—¶ç»™å‡ºåŸºäºå†å²ç»éªŒçš„æŒ‡å¼•ã€‚</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-2">ğŸ§ª å®æˆ˜åœºæ™¯å±•ç¤º â€”â€” â€œAI è¾…åŠ©è°ƒè¯•æµç¨‹â€</h2>
<p>å‡è®¾ä½ åœ¨ä½¿ç”¨ Sentry ç›‘æ§ Node.js æœåŠ¡ï¼Œå½“ä¸€ä¸ªå¼‚å¸¸è¢«æ•è·ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">try {
  <span class="hljs-built_in">processUserData</span>(undefined);
} catch (err) {
  Sentry<span class="hljs-selector-class">.captureException</span>(err);
}
</code></pre>
<p>Sentry æ”¶åˆ°é”™è¯¯äº‹ä»¶åï¼ŒAI å±‚ä¼šæ¥æ‰‹å¤„ç†ï¼Œå¦‚ä¸‹å›¾é€»è¾‘ï¼ˆä¼ªæµç¨‹ï¼‰ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[åŸå§‹ Error æ•°æ®]</span> â†’ 
<span class="hljs-selector-attr">[AI åˆ†æå±‚]</span> â†’ 
  <span class="hljs-number">1</span>ï¸âƒ£ æå–è°ƒç”¨å †æ ˆ
  <span class="hljs-number">2</span>ï¸âƒ£ åŒ¹é…å†å²äº‹ä»¶
  <span class="hljs-number">3</span>ï¸âƒ£ åˆ©ç”¨ Embedding åˆ¤æ–­è¯­ä¹‰ç›¸ä¼¼åº¦
  <span class="hljs-number">4</span>ï¸âƒ£ ç»¼åˆä¸Šä¸‹æ–‡ç”Ÿæˆ Debug <span class="hljs-selector-tag">Summary</span>
  <span class="hljs-number">5</span>ï¸âƒ£ è¾“å‡ºè‡ªç„¶è¯­è¨€æŠ¥å‘Š + ä¿®å¤æ¨è
â†’ <span class="hljs-selector-attr">[å¼€å‘è€…ä»ªè¡¨ç›˜]</span>
</code></pre>
<p>è¾“å‡ºæŠ¥å‘Šç±»ä¼¼ï¼š</p>
<blockquote>
<p><strong>é”™è¯¯æ‘˜è¦ ğŸ§©</strong><br/>
æ–‡ä»¶ï¼š<code>userHandler.js</code><br/>
åŸå› å¯èƒ½ï¼š<code>processUserData</code> å‚æ•°ç¼ºå¤±ã€‚<br/>
ç±»ä¼¼é”™è¯¯æ›¾å‡ºç°åœ¨ v2.3 ç‰ˆæœ¬ï¼Œå·²é€šè¿‡ä¸ºå‚æ•°åŠ é»˜è®¤å€¼ä¿®å¤ã€‚</p>
</blockquote>
<blockquote>
<p><strong>AI å»ºè®® ğŸ’¡</strong><br/>
â€œä¸ºå‡½æ•°æ·»åŠ å‚æ•°æ ¡éªŒé€»è¾‘ï¼Œé¿å…è°ƒç”¨æ—¶ä¼ å…¥ undefinedã€‚<br/>
æ¨èä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼šâ€</p>
</blockquote>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">processUserData</span>(<span class="hljs-params">user = {}</span>) {
  <span class="hljs-keyword">if</span> (!user || !user.<span class="hljs-property">name</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Invalid user data"</span>);
}
</code></pre>
<hr/>
<h2 data-id="heading-3">ğŸ§® æ¼”ç®—ä¹‹ç¾ï¼šSentry çš„ AI æµç¨‹è®¾è®¡æ€ç»´</h2>
<p>AI åœ¨ Sentry çš„å·¥ä½œè¿‡ç¨‹å¯æ‹†ä¸ºä¸‰å±‚ç»“æ„ï¼ˆä»¥é€šä¿—æ–¹å¼æè¿°ï¼Œä¸ç”¨æ•°å­¦ç¬¦å·ï¼‰ï¼š</p>
<ol>
<li><strong>è¯­ä¹‰ç‰¹å¾æå–å±‚</strong><br/>
æŠŠé”™è¯¯å †æ ˆã€æ—¥å¿—ã€ä¸Šä¸‹æ–‡ç­‰è½¬åŒ–ä¸ºå¯ç†è§£çš„è¯­ä¹‰å‘é‡è¡¨ç¤ºã€‚<br/>
å¯ä»¥ç±»æ¯”ä¸ºâ€œæŠŠé”™è¯¯ç¿»è¯‘æˆäººèƒ½å¬æ‡‚çš„æ•…äº‹â€ã€‚</li>
<li><strong>æ¨¡å¼è¯†åˆ«ä¸è”æƒ³å±‚</strong><br/>
é€šè¿‡æœºå™¨å­¦ä¹ æ¨¡å‹ï¼ˆå¦‚ Transformer Embeddingï¼‰ï¼Œ<br/>
æ‰¾å‡ºâ€œç±»ä¼¼é”™è¯¯â€æˆ–æ½œåœ¨å› æœé“¾ã€‚</li>
<li><strong>è¯­è¨€ç”Ÿæˆä¸å†³ç­–å±‚</strong><br/>
ç”¨è‡ªç„¶è¯­è¨€ç”Ÿæˆæ€»ç»“ã€é¢„æµ‹æˆ–ä»£ç ä¿®å¤å»ºè®®ï¼Œ<br/>
é€šè¿‡ Reinforcement Learning è°ƒæ•´å»ºè®®è´¨é‡å’Œä¼˜å…ˆåº¦ã€‚</li>
</ol>
<p>æ¢å¥è¯è¯´ï¼ŒSentry ä¸å†æ˜¯å†·å†°å†°çš„æŠ¥è­¦ç³»ç»Ÿï¼Œ<br/>
è€Œæ˜¯ä¸€ä¸ªä¼šå­¦ä¹ ã€ä¼šå»ºè®®ã€ä¼šæ²Ÿé€šçš„â€œæ™ºæ…§ç®¡å®¶â€ã€‚ğŸ§‘â€ğŸ”§ğŸ¤–</p>
<hr/>
<h2 data-id="heading-4">ğŸ› ï¸ ç¬¬ä¸‰å¹•ï¼šä¸ç”Ÿäº§ç³»ç»Ÿæ— ç¼ç»“åˆçš„å‡ ç§æ–¹å¼</h2>

























<table><thead><tr><th>åœºæ™¯</th><th>å®é™…è½åœ°æ–¹å¼</th></tr></thead><tbody><tr><td>ğŸŒ <strong>SaaS å¹³å°é›†æˆ AI æ¨ç†å±‚</strong></td><td>Sentry å®˜æ–¹äº‘å¯ç›´æ¥æ¥å…¥ LLM APIï¼Œç”¨ä»¥ç”Ÿæˆé”™è¯¯æ‘˜è¦è¯´æ˜ã€‚</td></tr><tr><td>ğŸ§± <strong>è‡ªå»ºéƒ¨ç½² + æœ¬åœ°æ¨¡å‹</strong></td><td>ä¼ä¸šå¯é€šè¿‡ç§æœ‰åŒ– LLMï¼ˆå¦‚ Llama / Mistralï¼‰éƒ¨ç½²ï¼Œå¯¹å†…éƒ¨æ—¥å¿—è„±æ•åˆ†æã€‚</td></tr><tr><td>ğŸ§© <strong>Webhook + LLM Agent é“¾æ¥</strong></td><td>é€šè¿‡ Webhook å°†äº‹ä»¶å®æ—¶å‘é€è‡³ AI Agentï¼ˆå¦‚ LangChain Flowï¼‰ï¼Œç”Ÿæˆæ´å¯ŸæŠ¥å‘Šã€‚</td></tr><tr><td>ğŸ§® <strong>GitHub Actions è‡ªåŠ¨ä¿®å¤å»ºè®®</strong></td><td>éƒ¨ç½²è‡ªåŠ¨åŒ–é“¾è·¯ï¼šæ£€æµ‹æ–°çš„é”™è¯¯ â†’ AI è‡ªåŠ¨åˆ›å»ºä¿®å¤ PRã€‚</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-5">âš¡ ç¤ºä¾‹ï¼šç”¨ AI åŠ©æ‰‹æœºå™¨åœ¨ Sentry äº‹ä»¶ä¸Šè‡ªåŠ¨ç”ŸæˆæŠ¥å‘Š</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¼ªä»£ç ç¤ºä¾‹ï¼šSentry Webhook -&gt; AI åˆ†æ -&gt; Slack é€šçŸ¥</span>
<span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">"express"</span>;
<span class="hljs-keyword">import</span> { analyzeError } <span class="hljs-keyword">from</span> <span class="hljs-string">"./aiAgent.js"</span>;
<span class="hljs-keyword">import</span> { sendToSlack } <span class="hljs-keyword">from</span> <span class="hljs-string">"./notify.js"</span>;

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();

app.<span class="hljs-title function_">post</span>(<span class="hljs-string">"/sentry/webhook"</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-keyword">const</span> errorEvent = req.<span class="hljs-property">body</span>;
  <span class="hljs-keyword">const</span> aiReport = <span class="hljs-keyword">await</span> <span class="hljs-title function_">analyzeError</span>(errorEvent);
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">sendToSlack</span>(aiReport);
  res.<span class="hljs-title function_">sendStatus</span>(<span class="hljs-number">200</span>);
});

<span class="hljs-comment">// aiAgent.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">analyzeError</span>(<span class="hljs-params">event</span>) {
  <span class="hljs-keyword">const</span> { message, stacktrace } = event;
  <span class="hljs-keyword">const</span> prompt = <span class="hljs-string">`
  ä»¥ä¸‹æ˜¯é”™è¯¯å †æ ˆï¼Œè¯·æ€»ç»“æ ¹å› å¹¶ç»™å‡ºä¿®å¤å»ºè®®ï¼š
  Message: <span class="hljs-subst">${message}</span>
  Stack: <span class="hljs-subst">${stacktrace}</span>
  `</span>;
  <span class="hljs-comment">// è°ƒç”¨ LLM APIï¼ˆæ¯”å¦‚ OpenAIï¼‰</span>
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">"https://api.openai.com/v1/chat/completions"</span>, { <span class="hljs-comment">/* ... */</span> });
  <span class="hljs-keyword">return</span> response.<span class="hljs-property">result</span>;
}
</code></pre>
<blockquote>
<p>ç»“æœï¼Ÿ<br/>
å½“ç³»ç»Ÿç‚¸æ‰æ—¶ï¼ŒSlack ä¼šæ¥åˆ°ä¸€æ¡æ¶ˆæ¯ï¼š<br/>
â€œğŸ§  AI å‘ç°é—®é¢˜æ ¹æºåœ¨æ•°æ®åº“è¿æ¥æ± è€—å°½ï¼Œå»ºè®®è°ƒæ•´æœ€å¤§è¿æ¥æ•°æˆ–å¼•å…¥ç¼“å­˜å±‚ã€‚â€</p>
</blockquote>
<hr/>
<h2 data-id="heading-6">ğŸ”® ç¬¬å››å¹•ï¼šæœªæ¥çš„ AI Sentry ä¼šé•¿ä»€ä¹ˆæ ·ï¼Ÿ</h2>
<ul>
<li>ğŸ§© <strong>è‡ªåŠ¨æ ¹å› æ ‘ç»˜åˆ¶ï¼ˆRoot Cause Graphsï¼‰</strong><br/>
AI è‡ªåŠ¨ç»˜åˆ¶å‡ºç³»ç»Ÿè°ƒç”¨é“¾è·¯ä¸äº‹ä»¶å› æœå›¾è°±ã€‚</li>
<li>ğŸª„ <strong>è‡ªæ„ˆå¼ç›‘æ§ï¼ˆSelf-Healing Systemï¼‰</strong><br/>
æ£€æµ‹å¼‚å¸¸ â†’ åº”ç”¨è¡¥ä¸ â†’ è‡ªåŠ¨å›æ»šã€‚</li>
<li>ğŸ’¬ <strong>è‡ªç„¶è¯­è¨€å¯¹è¯å¼æ¥å£</strong><br/>
ä½ å¯ä»¥é—®ï¼šâ€œè¿‡å» 7 å¤©ä¸­åç«¯å“åº”è¶…è¿‡ 1 ç§’çš„è¯·æ±‚æœ‰å“ªäº›ï¼Ÿâ€<br/>
AI å³æ—¶ç”Ÿæˆä¸€ä»½å¸¦å›¾çš„æ€§èƒ½æŠ¥å‘Šã€‚</li>
<li>ğŸ¯ <strong>æ™ºèƒ½å‘Šè­¦å»å™ª</strong><br/>
å‘Šè­¦è¿‡å¤šæ—¶ï¼ŒAI è‡ªåŠ¨èšç±»ã€ä¼˜å…ˆçº§æ’åºï¼Œä»…æ¨é€çœŸæ­£å…³é”®äº‹ä»¶ã€‚</li>
<li>ğŸ” <strong>éšç§ä¸åˆè§„æ™ºèƒ½åˆ†æ</strong><br/>
è‡ªåŠ¨è¯†åˆ«æ˜¯å¦æ³„éœ²ç”¨æˆ·æ•°æ®ã€éšç§ä¿¡æ¯ï¼Œè¿›è¡ŒåŠ å¯†ä¸è„±æ•ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-7">ğŸ’« ç»“è¯­ï¼šå½“ Sentry è§‰é†’</h2>
<p>Sentry è¿‡å»åªæ˜¯ç³»ç»Ÿçš„â€œçœ¼ç›â€ï¼Œ<br/>
ç°åœ¨ï¼Œå®ƒå¼€å§‹æ‹¥æœ‰â€œæ€è€ƒçš„å¤´è„‘â€ã€‚<br/>
AI è®©é”™è¯¯è¿½è¸ªä¸å†æ˜¯å­¤ç«‹çš„åå‹¤ï¼Œè€Œæ˜¯ä¸»åŠ¨çš„åä½œè€…ã€‚</p>
<p>æœªæ¥ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°è¿™æ ·çš„åœºæ™¯ï¼š</p>
<blockquote>
<p>â€œBug åˆšéœ²å‡ºè‹—å¤´ï¼ŒSentry å·²åœ¨ç§ä¿¡é‡Œå‘Šè¯‰ä½ ä¿®å¤æ–¹æ¡ˆã€‚â€</p>
</blockquote>
<p><strong>è¿™ä¸æ˜¯ç§‘å¹»ï¼Œè€Œæ˜¯è®¡ç®—æœºç§‘å­¦çš„è¯—æ„ç°å®ã€‚ğŸ’¡</strong></p>
<hr/>
<p><strong>ğŸ§­ å°æ€»ç»“</strong></p>





























<table><thead><tr><th>æ¨¡å—</th><th>AI èƒ½å¸¦æ¥çš„å˜åŒ–</th></tr></thead><tbody><tr><td>é”™è¯¯æ£€æµ‹</td><td>ä»äº‹ä»¶æ•è· â†’ æ¨¡å¼è¯†åˆ«ä¸æ ¹å› åˆ¤æ–­</td></tr><tr><td>åˆ†æç»´åº¦</td><td>ä»æ—¥å¿—å †æ ˆ â†’ è¯­ä¹‰ç†è§£</td></tr><tr><td>å‘Šè­¦æ–¹å¼</td><td>ä»å›ºå®šé˜ˆå€¼ â†’ è‡ªé€‚åº”ä¼˜å…ˆçº§è°ƒåº¦</td></tr><tr><td>ä¿®å¤å“åº”</td><td>ä»æ‰‹åŠ¨ PR â†’ AI è¾…åŠ©ä»£ç ç”Ÿæˆ</td></tr><tr><td>ç›‘æ§ç†å¿µ</td><td>ä»è§‚æµ‹ â†’ åˆ°æ™ºèƒ½è‡ªæ„ˆ</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[1åˆ†é’Ÿäº†è§£å“åº”å¼ç¼–ç¨‹ | dubboæ¡†æ¶ä¸‹å“åº”å¼å®˜ä¾‹]]></title>    <link>https://juejin.cn/post/7591786340321591330</link>    <guid>https://juejin.cn/post/7591786340321591330</guid>    <pubDate>2026-01-06T03:29:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591786340321591330" data-draft-id="7591778827308056616" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="1åˆ†é’Ÿäº†è§£å“åº”å¼ç¼–ç¨‹ | dubboæ¡†æ¶ä¸‹å“åº”å¼å®˜ä¾‹"/> <meta itemprop="keywords" content="åç«¯,Java,RxJava"/> <meta itemprop="datePublished" content="2026-01-06T03:29:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Marsé…±"/> <meta itemprop="url" content="https://juejin.cn/user/1714893869821278"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            1åˆ†é’Ÿäº†è§£å“åº”å¼ç¼–ç¨‹ | dubboæ¡†æ¶ä¸‹å“åº”å¼å®˜ä¾‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1714893869821278/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Marsé…±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T03:29:50.000Z" title="Tue Jan 06 2026 03:29:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä½œè€…ï¼šMarsé…±</p>
<p>å£°æ˜ï¼šæœ¬æ–‡ç« ç”±Marsé…±ç¼–å†™ï¼Œéƒ¨åˆ†å†…å®¹æ¥æºäºç½‘ç»œï¼Œå¦‚æœ‰ç–‘é—®è¯·è”ç³»æœ¬äººã€‚</p>
<p>è½¬è½½ï¼šæ¬¢è¿è½¬è½½ï¼Œè½¬è½½å‰å…ˆè¯·è”ç³»æˆ‘ï¼</p>
</blockquote>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>ä¸Šç¯‡æœäº†ä¸€å †æ¦‚å¿µï¼Œæ‹¼å‡‘äº†ä¸€äº›ä¾‹å­ï¼Œç°ä»Šæˆ‘ä»¬çš„åº”ç”¨å·²ç»ä¸æ˜¯å•ä¾‹æ¶æ„ï¼Œä¸€èˆ¬éƒ½æ˜¯åˆ†å¸ƒå¼å¾®æœåŠ¡æ¶æ„ï¼Œå¾®æœåŠ¡æ¶æ„æƒ…å†µä¸‹æ¡†æ¶ä¹Ÿå¾ˆå¤šï¼ŒSpringCloudã€Dubboç­‰ç­‰</p>
<p>æˆ‘çš„å·¥ç¨‹æ˜¯dubboçš„ï¼Œé‚£æˆ‘ä»¬çœ‹çœ‹Dubboå®˜æ–¹ç¤ºä¾‹ç»™å‡ºçš„å“åº”å¼ç¼–ç¨‹çš„ä¾‹å­ï¼Œæ¯•ç«Ÿæˆ‘çœ‹Dubboå®˜æ–‡è¯´å¤©ç„¶æ”¯æŒæµå¼ç¼–ç¨‹ï¼Œå¥½äº†ï¼Œç»§ç»­ã€‚</p>
<h2 data-id="heading-1">Dubboå¯¹æµå¼å¤„ç†çš„æ”¯æŒ</h2>









































<table><thead><tr><th>åè®®</th><th>æ€§èƒ½</th><th>ç½‘å…³å‹å¥½</th><th>æµå¼é€šä¿¡</th><th>å¤šè¯­è¨€æ”¯æŒ</th><th>ç¼–ç¨‹API</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>triple</strong></td><td><strong>é«˜</strong></td><td><strong>é«˜</strong></td><td><strong>æ”¯æŒï¼Œå®¢æˆ·ç«¯æµã€æœåŠ¡ç«¯æµã€åŒå‘æµ</strong></td><td><strong>æ”¯æŒï¼ˆJavaã€Goã€Node.jsã€JavaScriptã€Rustï¼‰</strong></td><td><strong>Java Interfaceã€Protobuf(IDL)</strong></td><td><strong>åœ¨å¤šè¯­è¨€å…¼å®¹ã€æ€§èƒ½ã€ç½‘å…³ã€Streamingã€gRPC ç­‰æ–¹é¢æœ€å‡è¡¡çš„åè®®å®ç°ï¼Œå®˜æ–¹æ¨èã€‚</strong></td></tr><tr><td>dubbo</td><td>é«˜</td><td>ä½</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒï¼ˆJavaã€Goï¼‰</td><td>Java Interface</td><td>æ€§èƒ½æœ€é«˜çš„ç§æœ‰åè®®ï¼Œä½†å‰ç«¯æµé‡æ¥å…¥ã€å¤šè¯­è¨€æ”¯æŒç­‰æˆæœ¬è¾ƒé«˜</td></tr><tr><td>rest</td><td>ä½</td><td>é«˜</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒ</td><td>Java Interface</td><td>rest åè®®åœ¨å‰ç«¯æ¥å…¥ã€äº’é€šç­‰æ–¹é¢å…·å¤‡æœ€é«˜çš„çµæ´»æ€§ï¼Œä½†å¯¹æ¯” rpc å­˜åœ¨æ€§èƒ½ã€å¼±ç±»å‹ç­‰ç¼ºç‚¹ã€‚<strong>æ³¨æ„ï¼Œrest åœ¨ dubbo3 ä¸­ä»…æ˜¯ triple åè®®çš„ä¸€ç§å‘å¸ƒå½¢å¼</strong></td></tr></tbody></table>
<p>ä»å®˜æ–¹çš„æ–‡æ¡£ä¸­æ‰¾åˆ°ï¼ŒDubboæ˜¯æ”¯æŒæµå¼ç¼–ç¨‹çš„ï¼Œä½†æ˜¯éœ€è¦ä½¿ç”¨tripleåè®®ï¼Œè€Œä¸æ˜¯å…¶ä»–åè®®ã€‚</p>
<h2 data-id="heading-2">ä»gitä¸Šä¸‹è½½Dubbo Samples</h2>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä»gitä¸Šä¸‹è½½ dubboçš„å®˜æ–¹ç¤ºä¾‹ï¼Œè¿™æ˜¯ç¤ºä¾‹çš„gitåœ°å€</span>
https://github.com/apache/dubbo-samples.git
</code></pre>
<p>ä¸‹è½½ä¹‹åï¼Œå¯¼å…¥åˆ°ä½ çš„ideaä¸­ï¼ŒçŸ¥é“äº†tripleåè®®æ”¯æŒæµå¼é€šä¿¡ï¼Œé‚£ä¹ˆä»å¯¼å…¥å¥½çš„ideaä¸­æ‰¾åˆ°tripleçš„streamç›¸å…³çš„ä»£ç ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ebafe011a20403891943f968c009eb4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWFyc-mFsQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768274990&amp;x-signature=RqaQwYaCNL5u1lvakhpyA%2FfIsPw%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-3">DubboæœåŠ¡ç«¯æ”¯æŒçš„ä¸¤ç§æµå¼å¤„ç†</h2>
<p>Dubboé€šè¿‡tripleåè®®æ”¯æŒäº†ä¸¤ç§æµå¼å¤„ç†ï¼Œä¸€ç§æ˜¯æœåŠ¡ç«¯æµï¼Œå¦ä¸€ç§æ˜¯åŒå‘æµã€‚</p>
<h3 data-id="heading-4">æœåŠ¡ç«¯æµ</h3>
<p>é¦–å…ˆæˆ‘ä»¬çœ‹æœåŠ¡ç«¯æµçš„ç¤ºä¾‹ä»£ç ï¼Œä»£ç ä½ç½®åœ¨dubbo-samples-triple-streamingå·¥ç¨‹ä¸­çš„GreeterImplè¿™ä¸ªæ–‡ä»¶ï¼Œæˆ‘æŠ½å–äº†æœåŠ¡ç«¯æµçš„æ–¹å¼ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">serverStream</span><span class="hljs-params">(GreeterRequest request, StreamObserver&lt;GreeterReply&gt; responseObserver)</span> {
	LOGGER.info(<span class="hljs-string">"receive request: {}"</span>, request.getName());
	<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
		<span class="hljs-type">GreeterReply</span> <span class="hljs-variable">reply</span> <span class="hljs-operator">=</span> GreeterReply.newBuilder().setMessage(<span class="hljs-string">"reply from serverStream. "</span> + i).build();
		responseObserver.onNext(reply);
	}
	responseObserver.onCompleted();
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°serversStreamæ–¹æ³•æ˜¯æ²¡æœ‰voidï¼Œæ²¡æœ‰è¿”å›å€¼çš„ï¼Œå®ƒé€šè¿‡GreeterRequestå¯¹è±¡ä¼ é€’å‚æ•°ï¼Œç„¶åæŠŠä¸šåŠ¡é€»è¾‘æ•°æ®ä¾æ¬¡å¾ªç¯å†™å…¥åˆ°StreamObserverå¯¹åƒä¸­ã€‚</p>
<p>GreeterRequestå¯¹è±¡å¯ä»¥æ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ä¸šåŠ¡è¯·æ±‚å¯¹è±¡ï¼ŒStreamObserverå¯¹è±¡æ˜¯dubboæ¡†æ¶å¯¹äºæµå¼å¤„ç†çš„æ¥å£å®šä¹‰ï¼Œå¦‚å›¾ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e97c531cbb94373882d449c85504650~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWFyc-mFsQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768274990&amp;x-signature=gRilyZC%2BM2Wpa%2F3fRZKESIhio2U%3D" alt="" loading="lazy"/></p>
<p>å“åº”ç»“æœè¢«å°è£…åœ¨è¿™ä¸ªæ¥å£å¯¹è±¡ä¸­ï¼Œå®ç°äº†æµå¼æ•°æ®å†™å…¥åˆ°æ¶ˆè´¹è€…ç«¯çš„ä¸šåŠ¡åœºæ™¯ã€‚</p>
<h3 data-id="heading-5">åŒå‘æµ</h3>
<p>è¿™æ˜¯åŒå‘æµçš„å®˜æ–¹ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> StreamObserver&lt;GreeterRequest&gt; <span class="hljs-title function_">biStream</span><span class="hljs-params">(StreamObserver&lt;GreeterReply&gt; responseObserver)</span> {
	<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StreamObserver</span>&lt;GreeterRequest&gt;() {
		<span class="hljs-meta">@Override</span>
		<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onNext</span><span class="hljs-params">(GreeterRequest data)</span> {
			<span class="hljs-type">GreeterReply</span> <span class="hljs-variable">resp</span> <span class="hljs-operator">=</span> GreeterReply.newBuilder().setMessage(<span class="hljs-string">"reply from biStream "</span> + data.getName()).build();
			responseObserver.onNext(resp);
		}

		<span class="hljs-meta">@Override</span>
		<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onError</span><span class="hljs-params">(Throwable throwable)</span> {

		}

		<span class="hljs-meta">@Override</span>
		<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCompleted</span><span class="hljs-params">()</span> {

		}
	};
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒåŒå‘æµæ–¹æ³• binStream çš„å‚æ•°å’Œè¿”å›å€¼éƒ½æ˜¯ StreamObserver ç±»å‹ã€‚</p>
<p>ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®ƒä¸æˆ‘ä»¬ä¼ ç»Ÿæ–¹æ³•å®šä¹‰ä¸­å‚æ•°æ˜¯è¯·æ±‚å€¼ã€è¿”å›å€¼æ˜¯å“åº”çš„ç†è§£æ˜¯åè¿‡æ¥çš„ï¼Œåœ¨è¿™é‡Œï¼Œå‡½æ•°çš„å…¥å‚ StreamObserver responseObserver æ˜¯å“åº”ï¼Œè·Ÿä¹‹å‰ä¸€æ ·ï¼Œæ˜¯åœ¨ä¸šåŠ¡é€»è¾‘ä¸­ä¸åœçš„å†™æ•°æ®åˆ° å›å“åº”ä¸­ã€‚</p>
<p>è¿™ä¸ªå‡½æ•°ä¹Ÿé€šè¿‡newäº†ä¸€ä¸ª StreamObserver ä¸æ–­çš„åœ¨onNextå‡½æ•°ä¸­å†™å…¥äº†è¯·æ±‚æµæ•°æ®ï¼Œè€Œä¸”è¿™é‡Œ è¯·æ±‚æµ ä¸ å“åº”æµ æ˜¯ç‹¬ç«‹çš„ï¼Œæˆ‘ä»¬åœ¨å†™å›å“åº”æµæ•°æ®çš„è¿‡ç¨‹æ—¶ï¼Œéšæ—¶å¯èƒ½æœ‰è¯·æ±‚æµåˆ°è¾¾ï¼Œå¯¹äºæ¯ä¸ªæµè€Œè¨€ï¼Œå€¼éƒ½æ˜¯æœ‰åºçš„ã€‚</p>
<h2 data-id="heading-6">Dubboå®¢æˆ·ç«¯çš„è°ƒç”¨ç¤ºä¾‹</h2>
<p>dubboå¯¹äºä¸¤ç§æµçš„å¤„ç†æ–¹å¼æ˜¯ä¸åŒçš„è°ƒç”¨å®ç°</p>
<h3 data-id="heading-7">æœåŠ¡ç«¯æµçš„å®¢æˆ·ç«¯è°ƒç”¨</h3>
<p>è°ƒç”¨ serverStream() ä¼ å…¥èƒ½å¤Ÿå¤„ç†æµå¼å“åº”çš„ SampleStreamObserver å¯¹è±¡ï¼Œè°ƒç”¨å‘èµ·åå³å¿«é€Ÿè¿”å›ï¼Œä¹‹åæµå¼å“åº”ä¼šä¸åœçš„å‘é€åˆ° SampleStreamObserver ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">serverStream</span><span class="hljs-params">(Greeter greeter)</span> {
	<span class="hljs-type">GreeterRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> GreeterRequest.newBuilder().setName(<span class="hljs-string">"server stream request."</span>).build();
	greeter.serverStream(request, <span class="hljs-keyword">new</span> <span class="hljs-title class_">SampleStreamObserver</span>());
}

<span class="hljs-comment">// å£°åä¸Šé¢è°ƒç”¨ç±»çš„SampleStreamObserverå®ç°</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SampleStreamObserver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">StreamObserver</span>&lt;GreeterReply&gt; {

	<span class="hljs-meta">@Override</span>
	<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onNext</span><span class="hljs-params">(GreeterReply data)</span> {
		LOGGER.info(<span class="hljs-string">"stream &lt;- reply:{}"</span>, data);
	}

	<span class="hljs-meta">@Override</span>
	<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onError</span><span class="hljs-params">(Throwable throwable)</span> {
		LOGGER.error(<span class="hljs-string">"stream onError"</span>, throwable);
		throwable.printStackTrace();
	}

	<span class="hljs-meta">@Override</span>
	<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCompleted</span><span class="hljs-params">()</span> {
		LOGGER.info(<span class="hljs-string">"stream completed"</span>);
	}
}
</code></pre>
<h3 data-id="heading-8">åŒå‘æµçš„å®¢æˆ·ç«¯è°ƒç”¨</h3>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">biStream</span><span class="hljs-params">(Greeter greeter)</span> {
	<span class="hljs-comment">// SampleStreamObserverçš„å®šä¹‰åœ¨ â€˜æœåŠ¡ç«¯æµçš„å®¢æˆ·ç«¯è°ƒç”¨ç¤ºä¾‹â€™ ä¸­å·²ç»ç»™å‡º</span>
	StreamObserver&lt;GreeterRequest&gt; requestStreamObserver = greeter.biStream(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SampleStreamObserver</span>());
	<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
		<span class="hljs-type">GreeterRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> GreeterRequest.newBuilder().setName(<span class="hljs-string">"name-"</span> + i).build();
		requestStreamObserver.onNext(request);
	}
	requestStreamObserver.onCompleted();
}
</code></pre>
<p>è°ƒç”¨ greeter.biStream() æ–¹æ³•ä¼šç«‹å³è¿”å›ä¸€ä¸ªè¯·æ±‚æµ requestStreamObserver å¯¹è±¡ï¼ŒåŒæ—¶ï¼Œéœ€è¦ä¸ºæ–¹æ³•ä¼ å…¥ä¸€ä¸ªèƒ½å¤„ç†å“åº”çš„ observer å¯¹è±¡new SampleStreamObserver()ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨æ‰åˆšæ‰è¿”å›å€¼ä¸­å¾—åˆ°çš„ requestStreamObserver æŒç»­å‘é€è¯·æ±‚ requestStreamObserver .onNext(reqeust)ï¼Œ æ­¤æ—¶ï¼Œå¦‚æœæœ‰å“åº”è¿”å›ï¼Œåˆ™ä¼šç”± SampleStreamObserver å¯¹è±¡æ¥æ”¶å¤„ç†ï¼Œ</p>
<h2 data-id="heading-9">å®˜ä¾‹å¥½åƒæœ‰é—®é¢˜</h2>
<p>å…¶å®æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œåªæ˜¯dubboæ”¯æŒçš„æ˜¯observerçš„æµå¼å¤„ç†ï¼Œè¿™æ˜¯ä¸€ç§æ— èƒŒå‹æ–¹å¼çš„æµå¼å¤„ç†ã€‚èƒŒå‹æ˜¯ä¸€ç§<strong>æµæ§æœºåˆ¶</strong>ï¼Œdubbo çš„ StreamObserver <strong>ä¸æä¾›å†…ç½®èƒŒå‹æ”¯æŒ</strong></p>
<ul>
<li>å®ƒçš„ onNext æ–¹æ³•æ˜¯é€šè¿‡å®˜æ–¹çš„ç¤ºä¾‹å°±çŸ¥é“å®ƒå±äºé˜…åå³ç„šé£æ ¼ï¼›</li>
<li>è°ƒç”¨ onNext ä¼šç«‹å³æŠŠæ•°æ®å†™å…¥ç½‘ç»œç¼“å†²åŒºï¼ˆæˆ–æœ¬åœ°é˜Ÿåˆ—ï¼‰ï¼Œ<strong>ä¸ä¼šç­‰å¾…æ¶ˆè´¹è€…å¤„ç†å®Œæˆ</strong>ï¼›</li>
<li>å¦‚æœæ¶ˆè´¹è€…æ¶ˆè´¹å¾—å¤ªæ…¢ï¼Œè€Œ producer æŒç»­é«˜é€Ÿå‘é€ï¼Œæœ‰æ²¡æœ‰å¯èƒ½ <strong>å¯¼è‡´ OOM æˆ–è€…å…¶ä»–é—®é¢˜ï¼Ÿæ²¡è¯•è¿‡ï¼Œå­˜ç–‘</strong></li>
</ul>
<p>è¿™ä¸ <strong>Reactive Streams è§„èŒƒ</strong> è²Œä¼¼ä¸åŒï¼Œå¹¶æ²¡æœ‰èƒŒå‹ç‰¹å¾ï¼Œä½†æ˜¯RxJavaæ¡†æ¶ä¸ä¹Ÿæ˜¯æ”¯æŒèƒŒå‹ã€æ— èƒŒå‹æ–¹å¼çš„å—ï¼Ÿæ‰€ä»¥ï¼Œåº”è¯¥æ ¹æ®è‡ªå·±çš„åœºæ™¯æ¥é€‰æ‹©æ˜¯å¦éœ€è¦èƒŒå‹æ–¹å¼ï¼Œè¶…æ—¶äº†ï¼Œä¸‹ä¸ª1åˆ†é’Ÿçœ‹æ€ä¹ˆç”¨dubboå¤„ç†èƒŒå‹ç‰¹å¾çš„å“åº”å¼ç¼–ç¨‹å§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ„å»º â€œæŒ‰ç‰ˆæœ¬è§¦å‘ã€è‡ªåŠ¨å‘å¸ƒã€è‡ªåŠ¨å›å†™â€ çš„å‰ç«¯ç»„ä»¶å‘å¸ƒæµæ°´çº¿]]></title>    <link>https://juejin.cn/post/7592017365141618740</link>    <guid>https://juejin.cn/post/7592017365141618740</guid>    <pubDate>2026-01-06T03:33:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592017365141618740" data-draft-id="7591786340321165346" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ„å»º â€œæŒ‰ç‰ˆæœ¬è§¦å‘ã€è‡ªåŠ¨å‘å¸ƒã€è‡ªåŠ¨å›å†™â€ çš„å‰ç«¯ç»„ä»¶å‘å¸ƒæµæ°´çº¿"/> <meta itemprop="keywords" content="å‰ç«¯,CI/CD,NPM"/> <meta itemprop="datePublished" content="2026-01-06T03:33:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨å¤œå¯»æ™´å¤©"/> <meta itemprop="url" content="https://juejin.cn/user/1943592288391496"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ„å»º â€œæŒ‰ç‰ˆæœ¬è§¦å‘ã€è‡ªåŠ¨å‘å¸ƒã€è‡ªåŠ¨å›å†™â€ çš„å‰ç«¯ç»„ä»¶å‘å¸ƒæµæ°´çº¿
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1943592288391496/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨å¤œå¯»æ™´å¤©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T03:33:31.000Z" title="Tue Jan 06 2026 03:33:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä¸€å¥—å·¥ä½œæµï¼Œç»Ÿä¸€å‘å¸ƒå¤šä¸ªä»“åº“ä¸‹çš„å¤šä¸ªç»„ä»¶ï¼›ä»¥ â€œç‰ˆæœ¬å·å˜åŒ–â€ ä¸ºå”¯ä¸€è§¦å‘ï¼›å‘å¸ƒæˆåŠŸåè‡ªåŠ¨å›å†™é…ç½®å¹¶ç”Ÿæˆ PRã€‚æ–°å¢ç»„ä»¶åªéœ€æ”¹ä¸¤å¤„é…ç½®ï¼Œå‰©ä¸‹äº¤ç»™ CIã€‚</p>
</blockquote>
<h2 data-id="heading-0">èƒŒæ™¯ä¸ç›®æ ‡</h2>
<ul>
<li>å‰ç«¯ç»„ä»¶åˆ†æ•£åœ¨ä¸åŒä»“åº“ï¼Œäººå·¥å‘å¸ƒæ˜“é”™ã€æµç¨‹å†—é•¿ï¼›</li>
<li>éœ€è¦ â€œæ”¹ç‰ˆæœ¬ â†’ è‡ªåŠ¨æ„å»ºå‘å¸ƒ â†’ è‡ªåŠ¨åŒæ­¥é…ç½®â€ çš„ä¸€æ¡é¾™æµç¨‹ï¼›</li>
<li>é€šè¿‡ GitHub Actions + é›†ä¸­é…ç½®æ–‡ä»¶ï¼Œæ­å»ºä¸€å¥—ç¨³å¥ã€å¯æ‰©å±•çš„å‘å¸ƒæµæ°´çº¿ã€‚</li>
</ul>
<p>æœ¬æ–‡åŸºäºä¸¤ä»½æ ¸å¿ƒæ–‡ä»¶ï¼š</p>
<ul>
<li>å·¥ä½œæµï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Finfinilabs%2Fci%2F.github%2Fworkflows%2Fcoco-app-web.yml" target="_blank" title="https://github.com/infinilabs/ci/.github/workflows/coco-app-web.yml" ref="nofollow noopener noreferrer">coco-app-web.yml</a></li>
<li>ç»„ä»¶æ¸…å•ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Finfinilabs%2Fci%2Fconfigs%2Fcomponents.json" target="_blank" title="https://github.com/infinilabs/ci/configs/components.json" ref="nofollow noopener noreferrer">components.json</a></li>
</ul>
<h2 data-id="heading-1">æ¶æ„ä¸€è§ˆ</h2>
<ul>
<li>é›†ä¸­é…ç½®æ–‡ä»¶ç®¡ç†ç»„ä»¶çš„æ„å»º/å‘å¸ƒå‚æ•°ã€‚</li>
<li>å·¥ä½œæµè¯»å–é…ç½®ä¸è§¦å‘è¾“å…¥ï¼Œæ ¹æ® â€œç‰ˆæœ¬å˜åŒ–â€ ç”Ÿæˆå‘å¸ƒçŸ©é˜µã€‚</li>
<li>æŒ‰çŸ©é˜µé€ä»“åº“é€ç»„ä»¶æ‰§è¡Œæ„å»ºä¸ npm publishã€‚</li>
<li>å‘å¸ƒç»“æŸåè‡ªåŠ¨å›å†™å·¥ä½œæµé»˜è®¤å€¼ä¸ç»„ä»¶ current_versionï¼Œå¹¶æè‡ªåŠ¨åˆå¹¶ PRã€‚</li>
</ul>
<p>æ ¸å¿ƒæ€æƒ³ï¼š</p>
<ul>
<li>â€œç‰ˆæœ¬å·å˜åŒ–â€ æ˜¯å”¯ä¸€å‘å¸ƒè§¦å‘æ¡ä»¶ï¼›</li>
<li>é…ç½®é›†ä¸­åœ¨ components.jsonï¼Œç»„ä»¶çº§å¯è¦†ç›–ä»“åº“çº§é»˜è®¤å€¼ï¼›</li>
<li>å‘å¸ƒå®Œæˆåè‡ªåŠ¨å›å†™ï¼Œç¡®ä¿ â€œé…ç½®=äº‹å®â€ã€‚</li>
</ul>
<h2 data-id="heading-2">æ ¸å¿ƒæ–‡ä»¶ä¸å…³é”®ç‰‡æ®µ</h2>
<h3 data-id="heading-3">å·¥ä½œæµè¾“å…¥ï¼ˆworkflow_dispatchï¼‰</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">on:</span>
  <span class="hljs-attr">workflow_dispatch:</span>
    <span class="hljs-attr">inputs:</span>
      <span class="hljs-attr">SEARCH_CHAT_VERSION:</span> { <span class="hljs-attr">description:</span> <span class="hljs-string">'search-chat Version'</span>, <span class="hljs-attr">required:</span> <span class="hljs-literal">true</span>, <span class="hljs-attr">default:</span> <span class="hljs-string">"1.3.10"</span> }
      <span class="hljs-attr">UI_WEB_CLI_VERSION:</span> { <span class="hljs-attr">description:</span> <span class="hljs-string">'ui-web-cli Version'</span>, <span class="hljs-attr">required:</span> <span class="hljs-literal">true</span>, <span class="hljs-attr">default:</span> <span class="hljs-string">"0.0.43"</span> }
      <span class="hljs-attr">FILTER_VERSION:</span> { <span class="hljs-attr">description:</span> <span class="hljs-string">'filter Version'</span>, <span class="hljs-attr">required:</span> <span class="hljs-literal">true</span>, <span class="hljs-attr">default:</span> <span class="hljs-string">"0.0.11"</span> }
      <span class="hljs-attr">SEARCH_RESULTS_VERSION:</span> { <span class="hljs-attr">description:</span> <span class="hljs-string">'search-results Version'</span>, <span class="hljs-attr">required:</span> <span class="hljs-literal">true</span>, <span class="hljs-attr">default:</span> <span class="hljs-string">"0.0.11"</span> }
      <span class="hljs-attr">ENTITY_UI_VERSION:</span> { <span class="hljs-attr">description:</span> <span class="hljs-string">'entity-ui Version'</span>, <span class="hljs-attr">required:</span> <span class="hljs-literal">true</span>, <span class="hljs-attr">default:</span> <span class="hljs-string">"0.0.10"</span> }
      <span class="hljs-attr">CUSTOM_ICONS_VERSION:</span> { <span class="hljs-attr">description:</span> <span class="hljs-string">'custom-icons Version'</span>, <span class="hljs-attr">required:</span> <span class="hljs-literal">true</span>, <span class="hljs-attr">default:</span> <span class="hljs-string">"0.0.10"</span> }
      <span class="hljs-attr">DROPDOWNLIST_VERSION:</span> { <span class="hljs-attr">description:</span> <span class="hljs-string">'dropdownlist Version'</span>, <span class="hljs-attr">required:</span> <span class="hljs-literal">true</span>, <span class="hljs-attr">default:</span> <span class="hljs-string">"1.3.5"</span> }
      <span class="hljs-attr">DATEPICKER_VERSION:</span> { <span class="hljs-attr">description:</span> <span class="hljs-string">'datepicker Version'</span>, <span class="hljs-attr">required:</span> <span class="hljs-literal">true</span>, <span class="hljs-attr">default:</span> <span class="hljs-string">"0.0.10"</span> }
      <span class="hljs-attr">AI_ANSWER_VERSION:</span> { <span class="hljs-attr">description:</span> <span class="hljs-string">'ai-answer Version'</span>, <span class="hljs-attr">required:</span> <span class="hljs-literal">true</span>, <span class="hljs-attr">default:</span> <span class="hljs-string">"0.0.1"</span> }
</code></pre>
<p>å‘½åçº¦å®šï¼šç»„ä»¶åé€šè¿‡ â€œå…¨å¤§å†™ + çŸ­æ¨ªçº¿æ”¹ä¸‹åˆ’çº¿ + åç¼€ <code>_VERSION</code>â€ç”Ÿæˆè¾“å…¥é”®ï¼Œä¾‹å¦‚ ai-answer â†’ AI_ANSWER_VERSIONã€‚</p>
<h3 data-id="heading-4">ç»„ä»¶é›†ä¸­é…ç½®ï¼ˆcomponents.jsonï¼‰</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"ui-common"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"repo_private"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"build_cmd"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"pnpm build"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"publish_cmd"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"npm publish"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"version_file"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"package.json"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"adapter_script"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"components"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"ai-answer"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"current_version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0.0.1"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"work_dir"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"packages/AIAnswer"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"dist_dir"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"packages/AIAnswer"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>è¯´æ˜ï¼š</p>
<ul>
<li>work_dir ä¸ºæ„å»ºå‘ç”Ÿåœ°ï¼›</li>
<li>dist_dir ä¸º npm publish çš„ç›®å½•ï¼›</li>
<li>version_file é»˜è®¤ä¸º package.jsonï¼Œä¹Ÿå¯è¦†ç›–ä¸º tsup.config.tsã€‚</li>
</ul>
<h2 data-id="heading-5">å·¥ä½œæµæ‰§è¡Œè·¯å¾„ä¸åŸç†</h2>
<h3 data-id="heading-6">1. ç”Ÿæˆå‘å¸ƒçŸ©é˜µï¼ˆprepare-matrixï¼‰</h3>
<p>ä½ç½®ä¸é€»è¾‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Finfinilabs%2Fci%2F.github%2Fworkflows%2Fcoco-app-web.yml%23L33-L100" target="_blank" title="https://github.com/infinilabs/ci/.github/workflows/coco-app-web.yml#L33-L100" ref="nofollow noopener noreferrer">coco-app-web.yml</a></p>
<ul>
<li>éå† components.json çš„æ‰€æœ‰ä»“åº“ä¸ç»„ä»¶ï¼›</li>
<li>å°†ç»„ä»¶åæ˜ å°„ä¸ºè¾“å…¥é”®ï¼ˆå¦‚ ai-answer â†’ AI_ANSWER_VERSIONï¼‰ï¼›</li>
<li>å¯¹æ¯”è¾“å…¥ç‰ˆæœ¬ä¸ current_versionï¼Œä¸ä¸€è‡´è€…çº³å…¥çŸ©é˜µï¼›</li>
<li>è¾“å‡ºçŸ©é˜µ JSON ä¸ has_repos æ ‡è®°ã€‚</li>
</ul>
<p>ä¼˜ç‚¹ï¼šä»…å‘å¸ƒ â€œå‘ç”Ÿç‰ˆæœ¬å˜åŒ–â€ çš„ç»„ä»¶ï¼Œé¿å…æ— æ•ˆæ„å»ºã€‚</p>
<h3 data-id="heading-7">2. æ„å»ºä¸å‘å¸ƒï¼ˆpublishï¼‰</h3>
<p>ä½ç½®ä¸é€»è¾‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Finfinilabs%2Fci%2F.github%2Fworkflows%2Fcoco-app-web.yml%23L101-L221" target="_blank" title="https://github.com/infinilabs/ci/.github/workflows/coco-app-web.yml#L101-L221" ref="nofollow noopener noreferrer">coco-app-web.yml</a></p>
<ul>
<li>checkout CI ä»“åº“ä¸ç›®æ ‡ä»“åº“ï¼ˆæ”¯æŒç§ä»“ SSH ç§é’¥ï¼‰ã€‚</li>
<li>é€šè¿‡ jq å®ç°â€œç»„ä»¶ä¼˜å…ˆã€ä»“åº“å…œåº•â€çš„é…ç½®ç»§æ‰¿ã€‚</li>
<li>å†™å…¥ç‰ˆæœ¬ï¼š
<ul>
<li>è‹¥ version_file ä¸º tsup.config.tsï¼šç”¨ sed æ›´æ–° <code>version: "x.y.z"</code>ï¼›</li>
<li>å¦åˆ™ç”¨ jq å†™ package.json çš„ <code>version</code> å­—æ®µã€‚</li>
</ul>
</li>
<li>åœ¨ work_dir æ‰§è¡Œ <code>pnpm install</code> ä¸ <code>build_cmd</code>ï¼›</li>
<li>è¿›å…¥ dist_dir æ‰§è¡Œ <code>publish_cmd</code>ï¼ˆnpm publishï¼‰ï¼›</li>
<li>è®°å½•å‘å¸ƒå…ƒæ•°æ®åˆ° <code>release_info/&lt;component&gt;.txt</code>ï¼Œæ ¼å¼ <code>REPO|COMP|KEY|VER</code>ã€‚</li>
</ul>
<h3 data-id="heading-8">3. è‡ªåŠ¨å›å†™ä¸ PRï¼ˆupdate-workflowï¼‰</h3>
<p>ä½ç½®ä¸é€»è¾‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Finfinilabs%2Fci%2F.github%2Fworkflows%2Fcoco-app-web.yml%23L224-L304" target="_blank" title="https://github.com/infinilabs/ci/.github/workflows/coco-app-web.yml#L224-L304" ref="nofollow noopener noreferrer">coco-app-web.yml</a></p>
<ul>
<li>ä¸‹è½½å¹¶éå†æ‰€æœ‰ release-infoï¼›</li>
<li>ç”¨ sed å›å†™å·¥ä½œæµ inputs çš„é»˜è®¤ç‰ˆæœ¬ï¼›</li>
<li>ç”¨ jq å›å†™ components.json çš„ current_versionï¼›</li>
<li>ç”Ÿæˆå¹¶è‡ªåŠ¨åˆå¹¶ PRï¼Œç¡®ä¿â€œé…ç½®=äº‹å®â€ã€‚</li>
</ul>
<h3 data-id="heading-9">4. å¤±è´¥é€šçŸ¥ï¼ˆnotify_on_failureï¼‰</h3>
<p>ä½ç½®ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Finfinilabs%2Fci%2F.github%2Fworkflows%2Fcoco-app-web.yml%23L305-L320" target="_blank" title="https://github.com/infinilabs/ci/.github/workflows/coco-app-web.yml#L305-L320" ref="nofollow noopener noreferrer">coco-app-web.yml</a></p>
<ul>
<li>é€šè¿‡é£ä¹¦æœºå™¨äººæ¨é€å¤±è´¥çŠ¶æ€ä¸é“¾æ¥ã€‚</li>
</ul>
<h2 data-id="heading-10">å¦‚ä½•æ–°å¢ç»„ä»¶</h2>
<p>ä»¥æ–°å¢ ui-common ä¸‹çš„ ai-answer ä¸ºä¾‹ï¼š</p>
<h3 data-id="heading-11">npm ä»“åº“é…ç½® OIDC</h3>
<p>å…ˆç¬¬ä¸€æ¬¡æ‰‹åŠ¨å‘å¸ƒï¼Œåœ¨ npm ç”Ÿæˆå¯¹åº”ç»„ä»¶åº“çš„åœ°å€ï¼Œç„¶åä¿®æ”¹ä¸€ä¸‹é…ç½®ï¼Œå¦‚å›¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2595ec90a7544ea0a636d79201f0330f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5aSc5a-75pm05aSp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768275211&amp;x-signature=kg%2FQI6aE1%2Bc%2BLlU89OFyDvACNa0%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-12">åœ¨ components.json æ·»åŠ ç»„ä»¶æ¡ç›®ï¼ˆè·¯å¾„ã€ç‰ˆæœ¬ä¸ç›®å½•ï¼‰</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"ui-common"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"components"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"ai-answer"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"current_version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0.0.1"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"work_dir"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"packages/AIAnswer"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"dist_dir"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"packages/AIAnswer"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-13">åœ¨å·¥ä½œæµ inputs å¢åŠ å¯¹åº”é”®ï¼ˆå‘½åçº¦å®šï¼‰</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">AI_ANSWER_VERSION:</span> { <span class="hljs-attr">description:</span> <span class="hljs-string">'ai-answer Version'</span>, <span class="hljs-attr">required:</span> <span class="hljs-literal">true</span>, <span class="hljs-attr">default:</span> <span class="hljs-string">"0.0.1"</span> }
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f4bfb021dcf042b8a30e3846f8c892e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5aSc5a-75pm05aSp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768275211&amp;x-signature=X22ZaL6AdDDpsQqqm%2F1p%2B1xiEd4%3D" alt="image.png" loading="lazy"/></p>
<p>æ ¡éªŒä¸å‘å¸ƒï¼š</p>
<ul>
<li>æ‰‹åŠ¨è§¦å‘ workflow_dispatchï¼Œä¼ å…¥ä¸€ä¸ªâ€œä¸åŒäº current_versionâ€çš„ç‰ˆæœ¬å·ï¼ˆå¦‚ 0.0.2ï¼‰ï¼›</li>
<li>è§‚å¯Ÿæ—¥å¿—å‡ºç° <code>Processing: ai-answer (ui-common)</code>ï¼›</li>
<li>å‘å¸ƒå®Œæˆåè‡ªåŠ¨ç”Ÿæˆå¹¶åˆå¹¶ PRï¼Œå›å†™å·¥ä½œæµé»˜è®¤å€¼ä¸ components.json çš„ current_versionã€‚</li>
</ul>
<h2 data-id="heading-14">å¥½å¤„ä¸è®¾è®¡å–èˆ</h2>
<ul>
<li>ç»Ÿä¸€å…¥å£ï¼šä¸€ä¸ªå·¥ä½œæµè¦†ç›–å¤šä»“åº“å¤šç»„ä»¶çš„å‘å¸ƒã€‚</li>
<li>ç²¾å‡†è§¦å‘ï¼šä»…ç‰ˆæœ¬å˜åŒ–çš„ç»„ä»¶è¿›å…¥çŸ©é˜µï¼ŒèŠ‚çœæ—¶é—´ä¸ç®—åŠ›ã€‚</li>
<li>è‡ªåŠ¨åŒæ­¥ï¼šå‘å¸ƒåè‡ªåŠ¨å›å†™é…ç½®ä¸é»˜è®¤å€¼ï¼Œæœç»ç‰ˆæœ¬ â€œäº‹å®ä¸é…ç½®â€ ä¸ä¸€è‡´ã€‚</li>
<li>é…ç½®é›†ä¸­ï¼šcomponents.json ç®¡ç†æ„å»º/å‘å¸ƒå‘½ä»¤ä¸ç›®å½•ï¼Œç»„ä»¶å¯è¦†ç›–ä»“åº“é»˜è®¤ï¼Œä¿æŒæœ€å°‘å·®å¼‚ã€‚</li>
<li>é«˜æ‰©å±•ï¼šæ–°å¢ç»„ä»¶åªéœ€æ”¹ä¸¤å¤„é…ç½®ï¼Œæ— éœ€åŠ¨å·¥ä½œæµé€»è¾‘ã€‚</li>
</ul>
<p>è®¾è®¡è¦ç‚¹ï¼š</p>
<ul>
<li>é”®åæ˜ å°„ï¼ˆSAFE_NAME + <code>_VERSION</code>ï¼‰ä¿è¯ inputs ä¸ç»„ä»¶åç¨³å®šå¯¹åº”ï¼›</li>
<li>jq å±‚çº§è¯»å–ï¼ˆç»„ä»¶ä¼˜å…ˆã€ä»“åº“å…œåº•ï¼‰é™ä½é‡å¤é…ç½®ï¼›</li>
<li>release-info ä½œä¸º â€œäº‹å®è®°å½•â€ï¼Œupdate-workflow æ ¹æ®äº‹å®å›å†™é…ç½®ï¼Œå®ç°å¹‚ç­‰ä¸è‡ªæ„ˆã€‚</li>
</ul>
<h2 data-id="heading-15">å¸¸è§å‘ä½ä¸æ’æŸ¥</h2>
<ul>
<li>é”®åä¸åŒ¹é…
<ul>
<li>ai-answer çš„é”®å¿…é¡»ä¸º <code>AI_ANSWER_VERSION</code>ï¼›æ¼ä¸‹åˆ’çº¿æˆ–å‘½åä¸ä¸€è‡´ä¼šå¯¼è‡´ INPUT_VER ä¸º nullã€‚</li>
</ul>
</li>
<li>ç›®å½•é”™è¯¯
<ul>
<li>work_dir ç”¨äºæ„å»ºï¼Œdist_dir ç”¨äºå‘å¸ƒï¼›ä¸¤è€…å¿…é¡»å­˜åœ¨ä¸”æ­£ç¡®ã€‚</li>
</ul>
</li>
<li>ç‰ˆæœ¬å†™æ³•ä¸åŒ¹é…
<ul>
<li>tsup.config.ts å¿…é¡»å­˜åœ¨å½¢å¦‚ <code>version: "x.y.z"</code> çš„æ˜ç¡®å­—æ®µï¼›å¦åˆ™è¯·æ”¹ç”¨ package.jsonã€‚</li>
</ul>
</li>
<li>ç§æœ‰ä»“åº“
<ul>
<li>repo_private ä¸º true æ—¶éœ€é…ç½® SSH ç§é’¥ï¼Œcheckout æ‰èƒ½è®¿é—®ã€‚</li>
</ul>
</li>
<li>npm å‡­æ®
<ul>
<li>ç¡®ä¿ç›®æ ‡ä»“åº“/æµæ°´çº¿å…·å¤‡ npm å‘å¸ƒæƒé™ï¼ˆtoken æˆ– OIDCï¼‰ã€‚</li>
</ul>
</li>
<li>ç»„ç»‡å˜é‡
<ul>
<li><code>vars.GIT_REPO</code> å¿…é¡»æŒ‡å‘ç»„ç»‡è·¯å¾„ï¼ˆå¦‚ <code>github.com/&lt;org&gt;</code>ï¼‰ï¼Œå¦åˆ™ checkout å¤±è´¥ã€‚</li>
</ul>
</li>
<li>é€‚é…è„šæœ¬
<ul>
<li><code>adapter_script</code> ä»…åœ¨ç‰¹æ®Šä»“åº“éœ€è¦ï¼ˆå¦‚ coco-appï¼‰ï¼Œé»˜è®¤å…³é—­é¿å…è¯¯æ”¹ã€‚</li>
</ul>
</li>
</ul>
<h2 data-id="heading-16">å°ç»“</h2>
<ul>
<li>è¿™å¥—æµæ°´çº¿ä»¥ â€œç‰ˆæœ¬å˜åŒ–â€ ä¸ºæ ¸å¿ƒé©±åŠ¨åŠ›ï¼Œç»“åˆé›†ä¸­é…ç½®ã€è‡ªåŠ¨å›å†™ä¸ PRï¼Œæ„å»ºå‡ºç¨³å¥ã€å¯æ‰©å±•çš„å¤šç»„ä»¶å‘å¸ƒé€šé“ã€‚</li>
<li>æ–°å¢ç»„ä»¶çš„å¿ƒæ™ºè´Ÿæ‹…è¢«å‹ç¼©ä¸º â€œåŠ é…ç½® + åŠ è¾“å…¥é”®â€ï¼Œå…¶ä½™äº¤ç»™ CI è‡ªåŠ¨å®Œæˆã€‚</li>
<li>å¯¹äºå¤šä¸ªç»„ä»¶åˆ†å¸ƒåœ¨å¤šä»“åº“çš„åœºæ™¯ï¼Œè¿™æ˜¯ä¸€ä¸ªä½æˆæœ¬ã€é«˜æ”¶ç›Šçš„å‘å¸ƒå®è·µã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨å¡«å……è¡¨æ ¼æ³•åƒé€01èƒŒåŒ…åŠå…¶å˜å½¢-1]]></title>    <link>https://juejin.cn/post/7591799107486810122</link>    <guid>https://juejin.cn/post/7591799107486810122</guid>    <pubDate>2026-01-06T03:33:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591799107486810122" data-draft-id="7591871204567662618" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨å¡«å……è¡¨æ ¼æ³•åƒé€01èƒŒåŒ…åŠå…¶å˜å½¢-1"/> <meta itemprop="keywords" content="åç«¯,ç®—æ³•,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-06T03:33:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¢œé…±"/> <meta itemprop="url" content="https://juejin.cn/user/905653309941495"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨å¡«å……è¡¨æ ¼æ³•åƒé€01èƒŒåŒ…åŠå…¶å˜å½¢-1
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/905653309941495/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¢œé…±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T03:33:33.000Z" title="Tue Jan 06 2026 03:33:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç”¨å¡«å……è¡¨æ ¼æ³•åƒé€01èƒŒåŒ…åŠå…¶å˜å½¢</h2>
<p>01èƒŒåŒ…é—®é¢˜æ˜¯åŠ¨æ€è§„åˆ’ï¼ˆDynamic Programming, DPï¼‰é¢†åŸŸæœ€ç»å…¸ã€æœ€åŸºç¡€çš„æ¨¡å‹ä¹‹ä¸€ï¼Œåç»­å¾ˆå¤šå¤æ‚çš„DPé—®é¢˜éƒ½å¯çœ‹ä½œæ˜¯å®ƒçš„å˜å½¢æˆ–å»¶ä¼¸ã€‚æœ¬æ–‡å°†ä»"è¡¨æ ¼å¯è§†åŒ–"æ ¸å¿ƒæ€è·¯å‡ºå‘ï¼Œå…ˆé€šè¿‡ç©ºè¡¨æ ¼å»ºç«‹è§£é¢˜æ¡†æ¶ï¼Œå†ç”¨DPè§£é¢˜5æ­¥"ä¸‡èƒ½é’¥åŒ™"é€æ­¥å¡«å……è¡¨æ ¼ï¼Œæœ€ç»ˆè¦†ç›–åŸºç¡€01èƒŒåŒ…è§£æ³•ã€ç©ºé—´ä¼˜åŒ–æŠ€å·§ï¼Œä»¥åŠ4ç±»ç»å…¸å˜å½¢çš„å®Œæ•´æ‹†è§£ï¼ˆå«ä»£ç å®ç°ï¼‰ï¼Œå¸®ä½ å½»åº•åƒé€01èƒŒåŒ…é—®é¢˜ã€‚</p>
<p>æ ¸å¿ƒå‰ç½®è®¤çŸ¥ï¼š01èƒŒåŒ…çš„æœ¬è´¨æ˜¯"é€‰æˆ–ä¸é€‰"çš„äºŒé€‰ä¸€å†³ç­–â€”â€”æœ‰nä¸ªç‰©å“ï¼Œæ¯ä¸ªç‰©å“æœ‰é‡é‡å’Œä»·å€¼ï¼ŒèƒŒåŒ…æœ‰å›ºå®šå®¹é‡ï¼Œè¦æ±‚é€‰æ‹©è‹¥å¹²ç‰©å“æ”¾å…¥èƒŒåŒ…ï¼Œä½¿å¾—æ€»é‡é‡ä¸è¶…è¿‡å®¹é‡çš„å‰æä¸‹ï¼Œæ€»ä»·å€¼æœ€å¤§ï¼ˆåŸºç¡€æ¨¡å‹ï¼‰ã€‚åç»­æ‰€æœ‰å˜å½¢éƒ½å›´ç»•"é€‰æˆ–ä¸é€‰"çš„æ ¸å¿ƒé€»è¾‘å±•å¼€ï¼Œåªæ˜¯"ç‰©å“""å®¹é‡""ç›®æ ‡"çš„å…·ä½“å«ä¹‰ä¸åŒã€‚</p>
<p>åŠ¨æ€è§„åˆ’ï¼ˆDynamic Programming, DPï¼‰è§£å†³é—®é¢˜çš„æ ¸å¿ƒé€»è¾‘ï¼Œæœ¬è´¨æ˜¯é€šè¿‡<strong>å¡«å……è¡¨æ ¼</strong>é€æ­¥æ¨å¯¼æœ€ä¼˜è§£â€”â€”æŠŠå¤æ‚çš„å¤šé˜¶æ®µå†³ç­–é—®é¢˜ï¼Œè½¬åŒ–ä¸ºæŒ‰è§„åˆ™å¡«å……è¡¨æ ¼çš„å¯è§†åŒ–è¿‡ç¨‹ã€‚ä»¥01èƒŒåŒ…é—®é¢˜ï¼ˆæœ€ç»å…¸çš„DPæ¨¡å‹ï¼‰ä¸ºä¾‹ï¼Œæˆ‘ä»¬å…ˆæ˜ç¡®æœ€ç»ˆè¦å¡«å……çš„æ ¸å¿ƒè¡¨æ ¼å½¢æ€ï¼Œåç»­æ‰€æœ‰è§£é¢˜æ­¥éª¤éƒ½æ˜¯ä¸ºäº†æŒ‰è§„åˆ™å®Œæˆè¿™å¼ è¡¨æ ¼ï¼Œè¡¨æ ¼å¡«å®Œä¹‹æ—¶ï¼Œå°±æ˜¯é—®é¢˜è§£å†³ä¹‹æ—¥ã€‚</p>
<p>01èƒŒåŒ…é—®é¢˜æ ¸å¿ƒè¡¨æ ¼ï¼ˆç©ºè¡¨ï¼Œåç»­é€æ­¥å¡«å……ï¼‰ï¼š</p>





















































<table><thead><tr><th>å‰iä¸ªç‰©å“\èƒŒåŒ…å®¹é‡j</th><th>0ï¼ˆå®¹é‡ä¸º0ï¼‰</th><th>1ï¼ˆå®¹é‡ä¸º1ï¼‰</th><th>2ï¼ˆå®¹é‡ä¸º2ï¼‰</th><th>...ï¼ˆå®¹é‡é€’å¢ï¼‰</th><th>Cï¼ˆèƒŒåŒ…æœ€å¤§å®¹é‡ï¼‰</th></tr></thead><tbody><tr><td>0ï¼ˆæ— ç‰©å“ï¼‰</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td></tr><tr><td>1ï¼ˆç¬¬1ä¸ªç‰©å“ï¼‰</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td></tr><tr><td>2ï¼ˆç¬¬2ä¸ªç‰©å“ï¼‰</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td></tr><tr><td>...ï¼ˆç‰©å“é€’å¢ï¼‰</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td></tr><tr><td>nï¼ˆç¬¬nä¸ªç‰©å“ï¼‰</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……ï¼ˆæœ€ç»ˆç­”æ¡ˆï¼‰</td></tr></tbody></table>
<p>è¡¨æ ¼è¯´æ˜ï¼šè¡¨æ ¼ä¸­æ¯ä¸ªå•å…ƒæ ¼<code>dp[i][j]</code>ä»£è¡¨ã€Œå‰iä¸ªç‰©å“æ”¾å…¥å®¹é‡ä¸ºjçš„èƒŒåŒ…çš„æœ€å¤§ä»·å€¼ã€ï¼Œæˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯æŒ‰è§„åˆ™å¡«å……æ‰€æœ‰å•å…ƒæ ¼ï¼Œæœ€ç»ˆå³ä¸‹è§’<code>dp[n][C]</code>å³ä¸º01èƒŒåŒ…é—®é¢˜çš„æœ€ä¼˜è§£ã€‚</p>
<p>è¦æœ‰åºã€æ­£ç¡®åœ°å¡«å……è¿™å¼ è¡¨æ ¼ï¼Œéœ€è¦éµå¾ªDPè§£é¢˜çš„5æ­¥ã€Œä¸‡èƒ½é’¥åŒ™ã€â€”â€”è¿™æ˜¯è´¯ç©¿æ‰€æœ‰DPé—®é¢˜çš„é€šç”¨æ‹†è§£æ€è·¯ï¼Œæ¯ä¸€æ­¥éƒ½å¯¹åº”è¡¨æ ¼å¡«å……çš„å…³é”®ç¯èŠ‚ï¼š</p>
<ol>
<li>
<p><strong>ç¡®å®šdpæ•°ç»„åŠä¸‹æ ‡çš„å«ä¹‰</strong>ï¼šå®šä¹‰è¡¨æ ¼ä¸­æ¯ä¸ªå•å…ƒæ ¼çš„æ ¸å¿ƒæ„ä¹‰ï¼ˆå³<code>dp[i][j]</code>ä»£è¡¨ä»€ä¹ˆï¼‰ï¼Œè¿™æ˜¯å¡«å……è¡¨æ ¼çš„åŸºç¡€ï¼›</p>
</li>
<li>
<p><strong>ç¡®å®šé€’æ¨å…¬å¼</strong>ï¼šæ˜ç¡®å•å…ƒæ ¼<code>dp[i][j]</code>çš„æ•°å€¼å¦‚ä½•é€šè¿‡å…¶ä»–å·²å¡«å……å•å…ƒæ ¼æ¨å¯¼å¾—å‡ºï¼ˆå³"é€‰æˆ–ä¸é€‰"çš„å†³ç­–é€»è¾‘ï¼‰ï¼Œè¿™æ˜¯è¡¨æ ¼å¡«å……çš„æ ¸å¿ƒè§„åˆ™ï¼›</p>
</li>
<li>
<p><strong>dpæ•°ç»„å¦‚ä½•åˆå§‹åŒ–</strong>ï¼šç¡®å®šè¡¨æ ¼çš„åˆå§‹çŠ¶æ€ï¼ˆå¦‚æ— ç‰©å“ã€å®¹é‡ä¸º0æ—¶çš„å•å…ƒæ ¼å€¼ï¼‰ï¼Œè¿™æ˜¯è¡¨æ ¼å¡«å……çš„èµ·ç‚¹ï¼›</p>
</li>
<li>
<p><strong>ç¡®å®šéå†é¡ºåºï¼ˆè¡¨æ ¼å¡«å……é¡ºåºï¼‰</strong>ï¼šæ˜ç¡®æŒ‰ä»€ä¹ˆé¡ºåºé€ä¸ªå¡«å†™è¡¨æ ¼ä¸­çš„å•å…ƒæ ¼ï¼ˆå¦‚å…ˆé€è¡Œå¡«ã€å†é€åˆ—å¡«ï¼‰ï¼Œç¡®ä¿æ¨å¯¼æ—¶ä¾èµ–çš„å•å…ƒæ ¼å·²æå‰å¡«å……ï¼›</p>
</li>
<li>
<p><strong>æ‰“å°dpæ•°ç»„ï¼ˆéªŒè¯ï¼‰</strong>ï¼šé€šè¿‡é€æ­¥å¡«å……è¡¨æ ¼ã€æ‰“å°ä¸­é—´ç»“æœï¼ŒéªŒè¯å¡«å……è§„åˆ™çš„æ­£ç¡®æ€§ï¼Œé¿å…é€»è¾‘åå·®ã€‚</p>
</li>
</ol>
<p>åç»­æ‰€æœ‰01èƒŒåŒ…åŠå˜å½¢é—®é¢˜çš„åˆ†æï¼Œéƒ½å°†å›´ç»•è¿™5æ­¥ã€Œä¸‡èƒ½é’¥åŒ™ã€å±•å¼€ï¼Œæœ¬è´¨å°±æ˜¯ç”¨è¿™5æ­¥è§„åˆ™å®Œæˆå¯¹åº”è¡¨æ ¼çš„å¡«å……ï¼Œæœ€ç»ˆé€šè¿‡è¡¨æ ¼å¾—åˆ°é—®é¢˜ç­”æ¡ˆã€‚</p>
<h3 data-id="heading-1">ä¸€ã€åŸºç¡€01èƒŒåŒ…ï¼ˆäºŒç»´DPè§£æ³•ï¼‰</h3>
<p>æˆ‘ä»¬å…ˆä»æœ€ç›´è§‚çš„äºŒç»´DPè§£æ³•å…¥æ‰‹ï¼Œä¸¥æ ¼æŒ‰ç…§5æ­¥ã€Œä¸‡èƒ½é’¥åŒ™ã€æ‹†è§£ï¼Œå®Œæ•´æ¼”ç¤ºåŸºç¡€è¡¨æ ¼çš„å¡«å……è¿‡ç¨‹ã€‚</p>
<p>ç¤ºä¾‹ï¼šæœ‰4ä¸ªç‰©å“ï¼Œé‡é‡æ•°ç»„<code>weights = [2,3,4,5]</code>ï¼Œä»·å€¼æ•°ç»„<code>values = [3,4,5,6]</code>ï¼ŒèƒŒåŒ…æœ€å¤§å®¹é‡<code>capacity = 8</code>ï¼Œæ±‚èƒ½æ”¾å…¥èƒŒåŒ…çš„æœ€å¤§ä»·å€¼ã€‚</p>
<h4 data-id="heading-2">1.1 æ­¥éª¤1ï¼šç¡®å®šdpæ•°ç»„åŠä¸‹æ ‡çš„å«ä¹‰</h4>
<p>å®šä¹‰äºŒç»´æ•°ç»„<code>dp[i][j]</code>ï¼šè¡¨ç¤ºã€Œå‰iä¸ªç‰©å“æ”¾å…¥å®¹é‡ä¸ºjçš„èƒŒåŒ…ä¸­ï¼Œèƒ½è·å¾—çš„æœ€å¤§ä»·å€¼ã€ã€‚</p>
<p>å¯¹åº”è¡¨æ ¼ç»´åº¦ï¼šiï¼ˆè¡Œï¼‰è¡¨ç¤ºç‰©å“æ•°é‡ï¼ˆä»0åˆ°4ï¼Œ0ä»£è¡¨æ— ç‰©å“ï¼‰ï¼Œjï¼ˆåˆ—ï¼‰è¡¨ç¤ºèƒŒåŒ…å®¹é‡ï¼ˆä»0åˆ°8ï¼Œ0ä»£è¡¨å®¹é‡ä¸º0ï¼‰ï¼Œè¡¨æ ¼å…±5è¡Œ9åˆ—ï¼ˆi:0-4ï¼Œj:0-8ï¼‰ã€‚</p>
<h4 data-id="heading-3">1.2 æ­¥éª¤2ï¼šç¡®å®šé€’æ¨å…¬å¼</h4>
<p>å¯¹äºç¬¬iä¸ªç‰©å“ï¼ˆé‡é‡<code>weights[i-1]</code>ã€ä»·å€¼<code>values[i-1]</code>ï¼Œæ³¨æ„æ•°ç»„ç´¢å¼•ä»0å¼€å§‹ï¼Œiä»1å¼€å§‹ï¼‰ï¼Œæœ‰ä¸¤ç§æ ¸å¿ƒå†³ç­–ï¼šé€‰æˆ–ä¸é€‰ã€‚</p>
<ol>
<li>
<p><strong>ä¸é€‰ç¬¬iä¸ªç‰©å“</strong>ï¼šå‰iä¸ªç‰©å“çš„æœ€å¤§ä»·å€¼ = å‰i-1ä¸ªç‰©å“çš„æœ€å¤§ä»·å€¼ï¼Œå³<code>dp[i][j] = dp[i-1][j]</code>ï¼›</p>
</li>
<li>
<p><strong>é€‰ç¬¬iä¸ªç‰©å“</strong>ï¼šéœ€ä¿è¯èƒŒåŒ…å®¹é‡j â‰¥ ç¬¬iä¸ªç‰©å“çš„é‡é‡ï¼Œæ­¤æ—¶æœ€å¤§ä»·å€¼ = å‰i-1ä¸ªç‰©å“æ”¾å…¥å®¹é‡j-weights[i-1]çš„èƒŒåŒ…çš„æœ€å¤§ä»·å€¼ + ç¬¬iä¸ªç‰©å“çš„ä»·å€¼ï¼Œå³<code>dp[i][j] = dp[i-1][j - weights[i-1]] + values[i-1]</code>ã€‚</p>
</li>
</ol>
<p>æœ€ç»ˆé€’æ¨å…¬å¼ï¼ˆå–ä¸¤ç§å†³ç­–çš„æœ€å¤§å€¼ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">if</span> (j &lt; weights[i - <span class="hljs-number">1</span>]) {
  <span class="hljs-comment">// å®¹é‡ä¸è¶³ï¼Œæ— æ³•é€‰ç¬¬iä¸ªç‰©å“</span>
  dp[i][j] = dp[i - <span class="hljs-number">1</span>][j];
} <span class="hljs-keyword">else</span> {
  <span class="hljs-comment">// å®¹é‡å……è¶³ï¼Œé€‰æˆ–ä¸é€‰å–æœ€å¤§å€¼</span>
  dp[i][j] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(dp[i - <span class="hljs-number">1</span>][j], dp[i - <span class="hljs-number">1</span>][j - weights[i - <span class="hljs-number">1</span>]] + values[i - <span class="hljs-number">1</span>]);
}
</code></pre>
<p>è¿™å°±æ˜¯è¡¨æ ¼ä¸­æ¯ä¸ªå•å…ƒæ ¼çš„å¡«å……è§„åˆ™â€”â€”æ¯ä¸ªå•å…ƒæ ¼çš„å€¼è¦ä¹ˆç»§æ‰¿ä¸Šä¸€è¡ŒåŒåˆ—çš„å€¼ï¼Œè¦ä¹ˆç»§æ‰¿ä¸Šä¸€è¡Œå·¦ä¾§å¯¹åº”å®¹é‡çš„çš„å€¼å¹¶åŠ ä¸Šå½“å‰ç‰©å“ä»·å€¼ï¼Œå–ä¸¤è€…æœ€å¤§ã€‚</p>
<h4 data-id="heading-4">1.3 æ­¥éª¤3ï¼šdpæ•°ç»„å¦‚ä½•åˆå§‹åŒ–</h4>
<p>åˆå§‹åŒ–çš„æ ¸å¿ƒæ˜¯ç¡®å®šè¡¨æ ¼çš„â€œè¾¹ç•Œæ¡ä»¶â€ï¼Œå³æ— éœ€æ¨å¯¼å°±èƒ½ç›´æ¥ç¡®å®šçš„å•å…ƒæ ¼å€¼ã€‚</p>
<ol>
<li>
<p><strong>i=0ï¼ˆæ— ç‰©å“ï¼‰</strong>ï¼šæ— è®ºèƒŒåŒ…å®¹é‡jå¤šå¤§ï¼Œæ”¾å…¥0ä¸ªç‰©å“çš„æœ€å¤§ä»·å€¼éƒ½æ˜¯0ï¼Œå› æ­¤<code>dp[0][j] = 0</code>ï¼ˆè¡¨æ ¼ç¬¬0è¡Œå…¨ä¸º0ï¼‰ï¼›</p>
</li>
<li>
<p><strong>j=0ï¼ˆå®¹é‡ä¸º0ï¼‰</strong>ï¼šæ— è®ºæœ‰å¤šå°‘ç‰©å“ï¼Œéƒ½æ— æ³•æ”¾å…¥èƒŒåŒ…ï¼Œæœ€å¤§ä»·å€¼éƒ½æ˜¯0ï¼Œå› æ­¤<code>dp[i][0] = 0</code>ï¼ˆè¡¨æ ¼ç¬¬0åˆ—å…¨ä¸º0ï¼‰ã€‚</p>
</li>
</ol>
<p>åˆå§‹åŒ–åçš„è¡¨æ ¼ï¼ˆç¬¬0è¡Œã€ç¬¬0åˆ—å·²å¡«å……ï¼‰ï¼š</p>













































































<table><thead><tr><th>å‰iä¸ªç‰©å“\èƒŒåŒ…å®¹é‡j</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th></tr></thead><tbody><tr><td>0ï¼ˆæ— ç‰©å“ï¼‰</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>1ï¼ˆç‰©å“1ï¼šw=2,v=3ï¼‰</td><td>0</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td></tr><tr><td>2ï¼ˆç‰©å“2ï¼šw=3,v=4ï¼‰</td><td>0</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td></tr><tr><td>3ï¼ˆç‰©å“3ï¼šw=4,v=5ï¼‰</td><td>0</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td></tr><tr><td>4ï¼ˆç‰©å“4ï¼šw=5,v=6ï¼‰</td><td>0</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td></tr></tbody></table>
<h4 data-id="heading-5">1.4 æ­¥éª¤4ï¼šç¡®å®šéå†é¡ºåºï¼ˆè¡¨æ ¼å¡«å……é¡ºåºï¼‰</h4>
<p>éå†é¡ºåºç›´æ¥å¯¹åº”äºŒç»´è¡¨æ ¼çš„å¡«å……é¡ºåºâ€”â€”å³ã€ŒæŒ‰ä»€ä¹ˆé¡ºåºé€ä¸ªå¡«å†™è¡¨æ ¼ä¸­çš„å•å…ƒæ ¼ã€ï¼Œè¿™é‡Œæœ‰ä¸¤ç§å¯è¡Œæ–¹å¼ï¼š</p>
<ol>
<li>
<p><strong>å…ˆéå†ç‰©å“ï¼ˆiä»1åˆ°nï¼‰ï¼Œå†éå†å®¹é‡ï¼ˆjä»1åˆ°Cï¼‰</strong>ï¼šé€è¡Œå¡«å……è¡¨æ ¼ï¼Œå…ˆå¡«å®Œç¬¬1ä¸ªç‰©å“å¯¹åº”çš„æ‰€æœ‰å®¹é‡ï¼ˆç¬¬1è¡Œï¼‰ï¼Œå†å¡«ç¬¬2ä¸ªç‰©å“å¯¹åº”çš„æ‰€æœ‰å®¹é‡ï¼ˆç¬¬2è¡Œï¼‰ï¼Œç›´åˆ°å¡«å®Œæ‰€æœ‰ç‰©å“ï¼›</p>
</li>
<li>
<p><strong>å…ˆéå†å®¹é‡ï¼ˆjä»1åˆ°Cï¼‰ï¼Œå†éå†ç‰©å“ï¼ˆiä»1åˆ°nï¼‰</strong>ï¼šé€åˆ—å¡«å……è¡¨æ ¼ï¼Œå…ˆå¡«å®Œå®¹é‡1å¯¹åº”çš„æ‰€æœ‰ç‰©å“æ•°é‡ï¼ˆç¬¬1åˆ—ï¼‰ï¼Œå†å¡«å®¹é‡2å¯¹åº”çš„æ‰€æœ‰ç‰©å“æ•°é‡ï¼ˆç¬¬2åˆ—ï¼‰ï¼Œç›´åˆ°å¡«å®Œæ‰€æœ‰å®¹é‡ã€‚</p>
</li>
</ol>
<p>ä¸¤ç§é¡ºåºéƒ½å¯è¡Œï¼Œå› ä¸ºè®¡ç®—<code>dp[i][j]</code>æ—¶ï¼Œåªä¾èµ–ä¸Šä¸€è¡Œï¼ˆ<code>i-1</code>è¡Œï¼‰çš„ç»“æœï¼Œæ— è®ºå…ˆå¡«è¡Œè¿˜æ˜¯å…ˆå¡«åˆ—ï¼Œä¸Šä¸€è¡Œçš„å¯¹åº”ä½ç½®éƒ½å·²æå‰è®¡ç®—å®Œæˆã€‚è¿™å°±åƒå¡«å……ä¸€å¼ äºŒç»´è¡¨æ ¼ï¼šå…ˆéå†ç‰©å“å†éå†å®¹é‡ï¼Œæ˜¯<strong>é€è¡Œå¡«å……</strong>ï¼ˆæ¯ä¸€è¡Œå¯¹åº”ä¸€ä¸ªç‰©å“çš„å†³ç­–ï¼Œå¡«å®Œä¸€è¡Œå†å¤„ç†ä¸‹ä¸€ä¸ªç‰©å“ï¼‰ï¼›å…ˆéå†å®¹é‡å†éå†ç‰©å“ï¼Œæ˜¯<strong>é€åˆ—å¡«å……</strong>ï¼ˆæ¯ä¸€åˆ—å¯¹åº”ä¸€ä¸ªå›ºå®šå®¹é‡ï¼Œå…ˆç¡®å®šæ‰€æœ‰ç‰©å“åœ¨è¯¥å®¹é‡ä¸‹çš„æœ€ä¼˜è§£ï¼‰ã€‚å®é™…è§£é¢˜ä¸­æ›´å¸¸ç”¨ã€Œå…ˆéå†ç‰©å“ï¼Œå†éå†å®¹é‡ã€çš„é¡ºåºï¼Œç¬¦åˆæˆ‘ä»¬ã€Œé€ä¸ªè€ƒè™‘ç‰©å“æ˜¯å¦æ”¾å…¥ã€çš„æ€è€ƒé€»è¾‘ã€‚</p>
<h4 data-id="heading-6">1.5 æ­¥éª¤5ï¼šæ‰“å°dpæ•°ç»„ï¼ˆéªŒè¯ï¼‰</h4>
<p>è¿™ä¸€æ­¥æ˜¯ç›´æ¥éªŒè¯è¡¨æ ¼å¡«å……ç»“æœçš„æ­£ç¡®æ€§â€”â€”é€šè¿‡é€æ­¥å¡«å……è¡¨æ ¼ã€æ‰“å°ä¸­é—´çŠ¶æ€ï¼Œç¡®è®¤æ¯ä¸€æ­¥éƒ½ç¬¦åˆé€’æ¨è§„åˆ™ï¼Œé¿å…å› è§„åˆ™ç†è§£åå·®å¯¼è‡´å¡«å……é”™è¯¯ã€‚ä»¥ç¤ºä¾‹<code>weights = [2,3,4,5]</code>ã€<code>values = [3,4,5,6]</code>ã€<code>capacity = 8</code>ä¸ºä¾‹ï¼Œé€æ­¥å¡«å……æ ¸å¿ƒè¡¨æ ¼éªŒè¯é€»è¾‘ï¼š</p>
<ol>
<li>
<p><strong>å¡«å……ç¬¬1è¡Œï¼ˆi=1ï¼Œç‰©å“1ï¼šw=2,v=3ï¼‰</strong>ï¼š</p>
<p>å¡«å……åç¬¬1è¡Œï¼š[0,0,3,3,3,3,3,3,3]</p>
<ul>
<li>
<p>j=1ï¼šå®¹é‡&lt;2ï¼Œæ— æ³•é€‰ï¼Œdp[1][1] = dp[0][1] = 0ï¼›</p>
</li>
<li>
<p>j=2ï¼šå®¹é‡â‰¥2ï¼Œé€‰åˆ™ä»·å€¼=dp[0][0]+3=3ï¼Œä¸é€‰åˆ™0ï¼Œå–max=3ï¼›</p>
</li>
<li>
<p>j=3-8ï¼šé€‰åˆ™ä»·å€¼=dp[0][j-2]+3=3ï¼Œä¸é€‰åˆ™0ï¼Œå–max=3ï¼›</p>
</li>
</ul>
</li>
<li>
<p><strong>å¡«å……ç¬¬2è¡Œï¼ˆi=2ï¼Œç‰©å“2ï¼šw=3,v=4ï¼‰</strong>ï¼š</p>
<p>å¡«å……åç¬¬2è¡Œï¼š[0,0,3,4,4,7,7,7,7]</p>
<ul>
<li>
<p>j=1-2ï¼šå®¹é‡&lt;3ï¼Œdp[2][j] = dp[1][j]ï¼ˆ0,3ï¼‰ï¼›</p>
</li>
<li>
<p>j=3ï¼šé€‰åˆ™dp[1][0]+4=4ï¼Œä¸é€‰åˆ™3ï¼Œå–max=4ï¼›</p>
</li>
<li>
<p>j=4ï¼šé€‰åˆ™dp[1][1]+4=4ï¼Œä¸é€‰åˆ™3ï¼Œå–max=4ï¼›</p>
</li>
<li>
<p>j=5ï¼šé€‰åˆ™dp[1][2]+4=3+4=7ï¼Œä¸é€‰åˆ™3ï¼Œå–max=7ï¼›</p>
</li>
<li>
<p>j=6-8ï¼šé€‰åˆ™dp[1][j-3]+4=3+4=7ï¼Œä¸é€‰åˆ™3ï¼Œå–max=7ï¼›</p>
</li>
</ul>
</li>
<li>
<p><strong>å¡«å……ç¬¬3è¡Œï¼ˆi=3ï¼Œç‰©å“3ï¼šw=4,v=5ï¼‰</strong>ï¼š</p>
<p>å¡«å……åç¬¬3è¡Œï¼š[0,0,3,4,5,5,8,9,9]</p>
<ul>
<li>
<p>j=1-3ï¼šå®¹é‡&lt;4ï¼Œdp[3][j] = dp[2][j]ï¼ˆ0,0,3ï¼‰ï¼›</p>
</li>
<li>
<p>j=4ï¼šé€‰åˆ™dp[2][0]+5=5ï¼Œä¸é€‰åˆ™4ï¼Œå–max=5ï¼›</p>
</li>
<li>
<p>j=5ï¼šé€‰åˆ™dp[2][1]+5=5ï¼Œä¸é€‰åˆ™4ï¼Œå–max=5ï¼›</p>
</li>
<li>
<p>j=6ï¼šé€‰åˆ™dp[2][2]+5=3+5=8ï¼Œä¸é€‰åˆ™7ï¼Œå–max=8ï¼›</p>
</li>
<li>
<p>j=7ï¼šé€‰åˆ™dp[2][3]+5=4+5=9ï¼Œä¸é€‰åˆ™7ï¼Œå–max=9ï¼›</p>
</li>
<li>
<p>j=8ï¼šé€‰åˆ™dp[2][4]+5=4+5=9ï¼Œä¸é€‰åˆ™7ï¼Œå–max=9ï¼›</p>
</li>
</ul>
</li>
<li>
<p><strong>å¡«å……ç¬¬4è¡Œï¼ˆi=4ï¼Œç‰©å“4ï¼šw=5,v=6ï¼‰</strong>ï¼š</p>
<p>å¡«å……åç¬¬4è¡Œï¼š[0,0,3,4,5,6,8,9,10]</p>
<ul>
<li>
<p>j=1-4ï¼šå®¹é‡&lt;5ï¼Œdp[4][j] = dp[3][j]ï¼ˆ0,0,3,4ï¼‰ï¼›</p>
</li>
<li>
<p>j=5ï¼šé€‰åˆ™dp[3][0]+6=6ï¼Œä¸é€‰åˆ™5ï¼Œå–max=6ï¼›</p>
</li>
<li>
<p>j=6ï¼šé€‰åˆ™dp[3][1]+6=6ï¼Œä¸é€‰åˆ™8ï¼Œå–max=8ï¼›</p>
</li>
<li>
<p>j=7ï¼šé€‰åˆ™dp[3][2]+6=3+6=9ï¼Œä¸é€‰åˆ™9ï¼Œå–max=9ï¼›</p>
</li>
<li>
<p>j=8ï¼šé€‰åˆ™dp[3][3]+6=4+6=10ï¼Œä¸é€‰åˆ™9ï¼Œå–max=10ï¼›</p>
</li>
</ul>
</li>
</ol>
<p>æœ€ç»ˆå¡«å……å®Œæˆçš„è¡¨æ ¼ï¼š</p>













































































<table><thead><tr><th>å‰iä¸ªç‰©å“\èƒŒåŒ…å®¹é‡j</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th></tr></thead><tbody><tr><td>0ï¼ˆæ— ç‰©å“ï¼‰</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>1ï¼ˆç‰©å“1ï¼šw=2,v=3ï¼‰</td><td>0</td><td>0</td><td>3</td><td>3</td><td>3</td><td>3</td><td>3</td><td>3</td><td>3</td></tr><tr><td>2ï¼ˆç‰©å“2ï¼šw=3,v=4ï¼‰</td><td>0</td><td>0</td><td>3</td><td>4</td><td>4</td><td>7</td><td>7</td><td>7</td><td>7</td></tr><tr><td>3ï¼ˆç‰©å“3ï¼šw=4,v=5ï¼‰</td><td>0</td><td>0</td><td>3</td><td>4</td><td>5</td><td>5</td><td>8</td><td>9</td><td>9</td></tr><tr><td>4ï¼ˆç‰©å“4ï¼šw=5,v=6ï¼‰</td><td>0</td><td>0</td><td>3</td><td>4</td><td>5</td><td>6</td><td>8</td><td>9</td><td>10</td></tr></tbody></table>
<p>è¡¨æ ¼å³ä¸‹è§’<code>dp[4][8] = 10</code>ï¼Œå³è¯¥ç¤ºä¾‹çš„æœ€å¤§ä»·å€¼ä¸º10ï¼Œä¸é¢„æœŸç»“æœä¸€è‡´ã€‚</p>
<h4 data-id="heading-7">1.6 åŸºç¡€äºŒç»´DPå®Œæ•´ä»£ç ï¼ˆJavaScriptï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * åŸºç¡€01èƒŒåŒ…ï¼ˆäºŒç»´DPè§£æ³•ï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">weights</span> - ç‰©å“é‡é‡æ•°ç»„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">values</span> - ç‰©å“ä»·å€¼æ•°ç»„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">capacity</span> - èƒŒåŒ…æœ€å¤§å®¹é‡
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} - èƒŒåŒ…èƒ½å®¹çº³çš„æœ€å¤§ä»·å€¼
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">knapsack_2d</span>(<span class="hljs-params">weights, values, capacity</span>) {
  <span class="hljs-keyword">const</span> n = weights.<span class="hljs-property">length</span>;
  <span class="hljs-comment">// 1. åˆå§‹åŒ–äºŒç»´dpæ•°ç»„ï¼šdp[i][j]è¡¨ç¤ºå‰iä¸ªç‰©å“æ”¾å…¥å®¹é‡jçš„èƒŒåŒ…çš„æœ€å¤§ä»·å€¼</span>
  <span class="hljs-keyword">const</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(n + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(capacity + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>));

  <span class="hljs-comment">// 2. éå†é¡ºåºï¼šå…ˆéå†ç‰©å“ï¼ˆiä»1åˆ°nï¼‰ï¼Œå†éå†å®¹é‡ï¼ˆjä»1åˆ°capacityï¼‰ï¼ˆé€è¡Œå¡«å……ï¼‰</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">1</span>; j &lt;= capacity; j++) {
      <span class="hljs-comment">// 3. é€’æ¨å…¬å¼ï¼šå®¹é‡ä¸è¶³åˆ™ä¸é€‰ï¼Œå®¹é‡å……è¶³åˆ™é€‰æˆ–ä¸é€‰å–æœ€å¤§å€¼</span>
      <span class="hljs-keyword">if</span> (j &lt; weights[i - <span class="hljs-number">1</span>]) {
        dp[i][j] = dp[i - <span class="hljs-number">1</span>][j];
      } <span class="hljs-keyword">else</span> {
        dp[i][j] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(dp[i - <span class="hljs-number">1</span>][j], dp[i - <span class="hljs-number">1</span>][j - weights[i - <span class="hljs-number">1</span>]] + values[i - <span class="hljs-number">1</span>]);
      }
    }
  }

  <span class="hljs-comment">// æ‰“å°å®Œæ•´dpæ•°ç»„ï¼ˆè¡¨æ ¼ï¼‰éªŒè¯</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'åŸºç¡€01èƒŒåŒ…äºŒç»´DPæ•°ç»„ï¼ˆè¡¨æ ¼ï¼‰ï¼š'</span>);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= n; i++) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dp[i].<span class="hljs-title function_">join</span>(<span class="hljs-string">'\t'</span>));
  }

  <span class="hljs-comment">// æœ€ç»ˆç­”æ¡ˆï¼šå‰nä¸ªç‰©å“æ”¾å…¥å®¹é‡capacityçš„èƒŒåŒ…çš„æœ€å¤§ä»·å€¼</span>
  <span class="hljs-keyword">return</span> dp[n][capacity];
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-keyword">const</span> weights = [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];
<span class="hljs-keyword">const</span> values = [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>];
<span class="hljs-keyword">const</span> capacity = <span class="hljs-number">8</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æœ€å¤§ä»·å€¼ï¼š'</span>, <span class="hljs-title function_">knapsack_2d</span>(weights, values, capacity)); <span class="hljs-comment">// è¾“å‡ºï¼š10</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨å¡«å……è¡¨æ ¼æ³•åƒé€01èƒŒåŒ…åŠå…¶å˜å½¢-2]]></title>    <link>https://juejin.cn/post/7591801024009928713</link>    <guid>https://juejin.cn/post/7591801024009928713</guid>    <pubDate>2026-01-06T03:39:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591801024009928713" data-draft-id="7591800417255489545" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨å¡«å……è¡¨æ ¼æ³•åƒé€01èƒŒåŒ…åŠå…¶å˜å½¢-2"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-06T03:39:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¢œé…±"/> <meta itemprop="url" content="https://juejin.cn/user/905653309941495"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨å¡«å……è¡¨æ ¼æ³•åƒé€01èƒŒåŒ…åŠå…¶å˜å½¢-2
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/905653309941495/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¢œé…±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T03:39:14.000Z" title="Tue Jan 06 2026 03:39:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/04007b9c90c043c08f458d6e98a0ef72~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aKc6YWx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768275883&amp;x-signature=fH%2FZCBs2%2FGHFJtWCoI80mYD%2FRTk%3D" alt="dp2.png" loading="lazy"/></p>
<h3 data-id="heading-0">2.3 æ­¥éª¤3ï¼šdpæ•°ç»„å¦‚ä½•åˆå§‹åŒ–</h3>
<p>åˆå§‹åŒ–é€»è¾‘ä¸äºŒç»´ä¸€è‡´ï¼šå®¹é‡ä¸º0æ—¶ï¼Œæœ€å¤§ä»·å€¼ä¸º0ï¼Œå› æ­¤<code>dp[0] = 0</code>ï¼›å…¶ä»–å®¹é‡çš„åˆå§‹å€¼ä¹Ÿä¸º0ï¼ˆå› ä¸ºåˆå§‹æ— ç‰©å“å¯æ”¾ï¼Œæœ€å¤§ä»·å€¼ä¸º0ï¼‰ï¼Œå³<code>dp = new Array(capacity + 1).fill(0)</code>ã€‚</p>
<p>åˆå§‹åŒ–åçš„å•è¡Œè¡¨æ ¼ï¼š[0,0,0,0,0,0,0,0,0]ï¼ˆjä»0åˆ°8ï¼‰</p>
<h3 data-id="heading-1">2.4 æ­¥éª¤4ï¼šç¡®å®šéå†é¡ºåºï¼ˆè¡¨æ ¼å¡«å……é¡ºåºï¼‰</h3>
<p>ä¸€ç»´DPçš„éå†é¡ºåºæœ‰ä¸¥æ ¼è¦æ±‚ï¼Œæ ¸å¿ƒæ˜¯ã€Œå€’åºéå†å®¹é‡ã€ï¼Œå¯¹åº”å•è¡Œè¡¨æ ¼çš„ã€Œä»å³å¾€å·¦å¡«å……ã€â€”â€”æ˜ç¡®å•è¡Œè¡¨æ ¼çš„å¡«å……é¡ºåºæ˜¯é¿å…é‡å¤é€‰æ‹©ç‰©å“çš„å…³é”®ï¼š</p>
<ol>
<li>
<p><strong>å¿…é¡»å…ˆéå†ç‰©å“ï¼Œå†éå†å®¹é‡</strong>ï¼šé€ä¸ªå¤„ç†æ¯ä¸ªç‰©å“ï¼Œæ¯æ¬¡å¤„ç†æ—¶æ›´æ–°æ•´ä¸ªå•è¡Œè¡¨æ ¼ï¼ˆè¦†ç›–ä¸Šä¸€è¡Œç»“æœï¼‰ï¼›</p>
</li>
<li>
<p><strong>å®¹é‡å¿…é¡»å€’åºéå†ï¼ˆjä»Cåˆ°weights[i-1]ï¼‰</strong>ï¼šä»æœ€å¤§å®¹é‡å¾€å°å®¹é‡å¡«å……ï¼Œç¡®ä¿è®¡ç®—<code>dp[j]</code>æ—¶ï¼Œ<code>dp[j - weights[i-1]]</code>ä»æ˜¯ä¸Šä¸€è¡Œï¼ˆæœªå¤„ç†å½“å‰ç‰©å“ï¼‰çš„æ—§å€¼ï¼Œé¿å…åŒä¸€ç‰©å“è¢«å¤šæ¬¡é€‰æ‹©ã€‚</p>
</li>
</ol>
<p>å…³é”®åŸå› ï¼šä¸€ç»´DPçš„æ ¸å¿ƒæ˜¯ç”¨å•è¡Œè¡¨æ ¼å¤ç”¨äºŒç»´è¡¨æ ¼çš„ç©ºé—´ï¼Œè¡¨æ ¼ä¸­æ¯ä¸ªä½ç½®çš„æ•°å€¼éƒ½ä¾èµ–â€œä¸Šä¸€è½®æœªæ›´æ–°çš„æ—§å€¼â€ï¼ˆå¯¹åº”äºŒç»´çš„<code>dp[i-1][j - w[i]]</code>ï¼‰ã€‚è‹¥æ­£åºéå†å®¹é‡ï¼Œ<code>dp[j - w[i]]</code>ä¼šè¢«æå‰æ›´æ–°ï¼ˆç›¸å½“äºäºŒç»´çš„<code>dp[i][j - w[i]]</code>ï¼‰ï¼Œå¯¼è‡´åŒä¸€ä¸ªç‰©å“è¢«å¤šæ¬¡é€‰æ‹©ï¼ˆå˜æˆå®Œå…¨èƒŒåŒ…ï¼‰ï¼›å€’åºéå†èƒ½ä¿è¯è®¡ç®—<code>dp[j]</code>æ—¶ï¼Œ<code>dp[j - w[i]]</code>ä»æ˜¯ä¸Šä¸€è¡Œï¼ˆæœªé€‰å½“å‰ç‰©å“ï¼‰çš„ç»“æœï¼Œå¯¹åº”<strong>å•è¡Œè¡¨æ ¼ä»å³å¾€å·¦å¡«å……</strong>ï¼Œå®Œç¾å¥‘åˆ01èƒŒåŒ…ã€Œæ¯ä¸ªç‰©å“é€‰ä¸€æ¬¡ã€çš„è§„åˆ™ã€‚</p>
<p>åä¾‹ï¼ˆæ­£åºéå†å®¹é‡ï¼‰ï¼šè‹¥jä»weights[i-1]åˆ°Cæ­£åºéå†ï¼Œå¤„ç†ç‰©å“1ï¼ˆw=2,v=3ï¼‰æ—¶ï¼Œj=2ä¼šæ›´æ–°dp[2]=3ï¼Œj=4æ—¶ä¼šç”¨åˆ°dp[2]çš„æ–°å€¼ï¼ˆ3ï¼‰ï¼Œè®¡ç®—dp[4] = dp[4] + 3 = 3ï¼Œç›¸å½“äºæŠŠç‰©å“1æ”¾å…¥äº†ä¸¤æ¬¡ï¼Œè¿èƒŒ01èƒŒåŒ…è§„åˆ™ã€‚</p>
<h3 data-id="heading-2">2.5 æ­¥éª¤5ï¼šæ‰“å°dpæ•°ç»„ï¼ˆéªŒè¯ï¼‰</h3>
<p>é€šè¿‡æ‰“å°å•è¡Œè¡¨æ ¼çš„æ»šåŠ¨æ›´æ–°è¿‡ç¨‹ï¼ŒéªŒè¯å¡«å……è§„åˆ™çš„æ­£ç¡®æ€§ã€‚ä»ç”¨æµ‹è¯•ç”¨ä¾‹ <code>weights = [2,3,4,5]</code>ã€<code>values = [3,4,5,6]</code>ã€<code>capacity = 8</code>ï¼Œæ¼”ç¤ºä¸€ç»´DPæ•°ç»„ï¼ˆå•è¡Œè¡¨æ ¼ï¼‰çš„å¡«å……å˜åŒ–ï¼š</p>
<ol>
<li>
<p><strong>åˆå§‹çŠ¶æ€</strong>ï¼šdp = [0,0,0,0,0,0,0,0,0]</p>
</li>
<li>
<p><strong>å¤„ç†ç‰©å“1ï¼ˆw=2,v=3ï¼‰ï¼Œjä»8åˆ°2å€’åº</strong>ï¼š</p>
<p>æ›´æ–°åï¼šdp = [0,0,3,3,3,3,3,3,3]</p>
<ul>
<li>
<p>j=8ï¼šdp[8] = max(0, dp[8-2]+3) = max(0,0+3)=3ï¼›</p>
</li>
<li>
<p>j=7ï¼šdp[7] = max(0, dp[5]+3)=3ï¼›</p>
</li>
<li>
<p>...ï¼ˆj=2åˆ°6åŒç†ï¼‰ï¼›</p>
</li>
<li>
<p>j=2ï¼šdp[2] = max(0, dp[0]+3)=3ï¼›</p>
</li>
</ul>
</li>
<li>
<p><strong>å¤„ç†ç‰©å“2ï¼ˆw=3,v=4ï¼‰ï¼Œjä»8åˆ°3å€’åº</strong>ï¼š</p>
<p>æ›´æ–°åï¼šdp = [0,0,3,4,4,7,7,7,7]</p>
<ul>
<li>
<p>j=8ï¼šmax(3, dp[5]+4)=max(3,3+4)=7ï¼›</p>
</li>
<li>
<p>j=7ï¼šmax(3, dp[4]+4)=max(3,3+4)=7ï¼›</p>
</li>
<li>
<p>j=6ï¼šmax(3, dp[3]+4)=max(3,3+4)=7ï¼›</p>
</li>
<li>
<p>j=5ï¼šmax(3, dp[2]+4)=max(3,3+4)=7ï¼›</p>
</li>
<li>
<p>j=4ï¼šmax(3, dp[1]+4)=max(3,0+4)=4ï¼›</p>
</li>
<li>
<p>j=3ï¼šmax(3, dp[0]+4)=max(3,0+4)=4ï¼›</p>
</li>
</ul>
</li>
<li>
<p><strong>å¤„ç†ç‰©å“3ï¼ˆw=4,v=5ï¼‰ï¼Œjä»8åˆ°4å€’åº</strong>ï¼š</p>
<p>æ›´æ–°åï¼šdp = [0,0,3,4,5,5,8,9,9]</p>
<ul>
<li>
<p>j=8ï¼šmax(7, dp[4]+5)=max(7,4+5)=9ï¼›</p>
</li>
<li>
<p>j=7ï¼šmax(7, dp[3]+5)=max(7,4+5)=9ï¼›</p>
</li>
<li>
<p>j=6ï¼šmax(7, dp[2]+5)=max(7,3+5)=8ï¼›</p>
</li>
<li>
<p>j=5ï¼šmax(7, dp[1]+5)=max(7,0+5)=7ï¼›</p>
</li>
<li>
<p>j=4ï¼šmax(4, dp[0]+5)=max(4,0+5)=5ï¼›</p>
</li>
</ul>
</li>
<li>
<p><strong>å¤„ç†ç‰©å“4ï¼ˆw=5,v=6ï¼‰ï¼Œjä»8åˆ°5å€’åº</strong>ï¼š</p>
<p>æ›´æ–°åï¼šdp = [0,0,3,4,5,6,8,9,10]</p>
<ul>
<li>
<p>j=8ï¼šmax(9, dp[3]+6)=max(9,4+6)=10ï¼›</p>
</li>
<li>
<p>j=7ï¼šmax(9, dp[2]+6)=max(9,3+6)=9ï¼›</p>
</li>
<li>
<p>j=6ï¼šmax(8, dp[1]+6)=max(8,0+6)=8ï¼›</p>
</li>
<li>
<p>j=5ï¼šmax(5, dp[0]+6)=max(5,0+6)=6ï¼›</p>
</li>
</ul>
</li>
</ol>
<p>æœ€ç»ˆå•è¡Œè¡¨æ ¼<code>dp[8] = 10</code>ï¼Œä¸äºŒç»´DPç»“æœä¸€è‡´ï¼ŒéªŒè¯äº†ä¼˜åŒ–çš„æ­£ç¡®æ€§ã€‚</p>
<h3 data-id="heading-3">2.6 ä¸€ç»´DPç©ºé—´ä¼˜åŒ–å®Œæ•´ä»£ç ï¼ˆJavaScriptï¼‰</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * åŸºç¡€01èƒŒåŒ…ï¼ˆä¸€ç»´DPç©ºé—´ä¼˜åŒ–è§£æ³•ï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">weights</span> - ç‰©å“é‡é‡æ•°ç»„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">values</span> - ç‰©å“ä»·å€¼æ•°ç»„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">capacity</span> - èƒŒåŒ…æœ€å¤§å®¹é‡
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} - èƒŒåŒ…èƒ½å®¹çº³çš„æœ€å¤§ä»·å€¼
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">knapsack_1d</span>(<span class="hljs-params">weights, values, capacity</span>) {
  <span class="hljs-keyword">const</span> n = weights.<span class="hljs-property">length</span>;
  <span class="hljs-comment">// 1. åˆå§‹åŒ–ä¸€ç»´dpæ•°ç»„ï¼šdp[j]è¡¨ç¤ºå®¹é‡jçš„èƒŒåŒ…çš„æœ€å¤§ä»·å€¼ï¼Œåˆå§‹å€¼0</span>
  <span class="hljs-keyword">const</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(capacity + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>);

  <span class="hljs-comment">// 2. éå†é¡ºåºï¼šå…ˆéå†ç‰©å“ï¼ˆiä»0åˆ°n-1ï¼‰ï¼Œå†å€’åºéå†å®¹é‡ï¼ˆjä»capacityåˆ°weights[i]ï¼‰ï¼ˆä»å³å¾€å·¦å¡«å……ï¼‰</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {
    <span class="hljs-comment">// å€’åºéå†é¿å…é‡å¤é€‰æ‹©å½“å‰ç‰©å“</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = capacity; j &gt;= weights[i]; j--) {
      <span class="hljs-comment">// 3. é€’æ¨å…¬å¼ï¼šä¸é€‰å½“å‰ç‰©å“çš„æœ€å¤§ä»·å€¼ vs é€‰å½“å‰ç‰©å“çš„æœ€å¤§ä»·å€¼</span>
      dp[j] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(dp[j], dp[j - weights[i]] + values[i]);
    }
    <span class="hljs-comment">// æ‰“å°æ¯æ¬¡å¤„ç†ç‰©å“åçš„dpæ•°ç»„ï¼ˆå•è¡Œè¡¨æ ¼æ›´æ–°è¿‡ç¨‹ï¼‰</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å¤„ç†å®Œç‰©å“<span class="hljs-subst">${i + <span class="hljs-number">1</span>}</span>åï¼Œdpæ•°ç»„ï¼š`</span>, [...dp]);
  }

  <span class="hljs-comment">// æœ€ç»ˆç­”æ¡ˆï¼šå®¹é‡ä¸ºcapacityçš„èƒŒåŒ…çš„æœ€å¤§ä»·å€¼</span>
  <span class="hljs-keyword">return</span> dp[capacity];
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-keyword">const</span> weights1 = [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];
<span class="hljs-keyword">const</span> values1 = [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>];
<span class="hljs-keyword">const</span> capacity1 = <span class="hljs-number">8</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æœ€å¤§ä»·å€¼ï¼š'</span>, <span class="hljs-title function_">knapsack_1d</span>(weights1, values1, capacity1)); <span class="hljs-comment">// è¾“å‡ºï¼š10</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[CSSç»ˆäºæ”¯æŒæ¸å˜è‰²çš„è¿‡æ¸¡äº†ğŸ‰]]></title>    <link>https://juejin.cn/post/7591697558377873450</link>    <guid>https://juejin.cn/post/7591697558377873450</guid>    <pubDate>2026-01-06T02:33:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591697558377873450" data-draft-id="7591730714140442666" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="CSSç»ˆäºæ”¯æŒæ¸å˜è‰²çš„è¿‡æ¸¡äº†ğŸ‰"/> <meta itemprop="keywords" content="å‰ç«¯,CSS,HTML"/> <meta itemprop="datePublished" content="2026-01-06T02:33:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="JIE_"/> <meta itemprop="url" content="https://juejin.cn/user/4145623568485513"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            CSSç»ˆäºæ”¯æŒæ¸å˜è‰²çš„è¿‡æ¸¡äº†ğŸ‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4145623568485513/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    JIE_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T02:33:03.000Z" title="Tue Jan 06 2026 02:33:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>åœ¨åšé¡¹ç›®æ—¶ï¼Œæ€»ä¼šé‡åˆ°UIç»™å‡ºæ¸å˜è‰²çš„å¡ç‰‡æˆ–è€…æŒ‰é’®ï¼Œä½†åœ¨åšé«˜äº®çš„æ—¶å€™ï¼Œç”±äºæ²¡æœ‰è¿‡æ¸¡ï¼Œæ˜¾å¾—å°¤ä¸ºç”Ÿç¡¬ã€‚</p>
<h2 data-id="heading-1">è¿‡å»çš„è§£å†³æ–¹æ¡ˆ</h2>
<p>åœ¨è¿‡å»ï¼Œæˆ‘ä»¬å¦‚æœè¦å®ç°æ¸å˜è‰²çš„è¿‡æ¸¡ï¼Œé€šå¸¸ä¼šä½¿ç”¨å¦‚ä¸‹å‡ ç§æ–¹æ³•ï¼š</p>
<ol>
<li>æ·»åŠ é®ç½©å±‚ï¼Œé€šè¿‡æ”¹å˜é®ç½©å±‚çš„é€æ˜åº¦åšå‡ºæ·¡å…¥æ·¡å‡ºçš„æ•ˆæœï¼Œå®ç°è¿‡æ¸¡ã€‚</li>
<li>é€šè¿‡<code>background-size/position</code>ä½¿å¾—æ¸å˜è‰²ç§»åŠ¨ï¼Œå®ç°æ¸å˜è‰²ç§»åŠ¨çš„æ•ˆæœã€‚</li>
<li>é€šè¿‡<code>filter: hue-rotate</code>æ»¤é•œå®ç°è‰²ç›¸æ—‹è½¬ï¼Œå®ç°è¿‡æ¸¡ã€‚</li>
</ol>
<p>ä½†è¿™å‡ ç§æ–¹å¼éƒ½æœ‰å„è‡ªçš„å±€é™æ€§ï¼š</p>
<ol>
<li>é®ç½©å±‚çš„æ–¹å¼çœ‹ä¼¼å¹³æ»‘ï¼Œä½†ä¸æ˜¯çœŸæ­£çš„è¿‡æ¸¡ï¼Œå·®ç‚¹æ„æ€ã€‚</li>
<li><code>background-size/position</code>çš„æ–¹å¼éœ€è¦è®¡ç®—å¥½<code>background-size</code>å’Œ<code>background-position</code>ï¼Œå¦åˆ™ä¼šå‡ºç°æ¸å˜ä¸å®Œæ•´çš„æƒ…å†µã€‚å¹¶ä¸”åªæ˜¯å®ç°äº†æ¸å˜çš„ç§»åŠ¨ï¼Œè€Œä¸æ˜¯è¿‡æ¸¡ã€‚</li>
<li><code>filter: hue-rotate</code>ä¹Ÿéœ€è¦è®¡ç®—å¥½æ—‹è½¬è§’åº¦ï¼Œå®ç°å¤æ‚åº¦é«˜ï¼Œè¿‡æ¸¡çš„ä¹Ÿä¸è‡ªç„¶ã€‚</li>
</ol>
<p><span href="https://code.juejin.cn/pen/7592043796225851398" class="code-editor-container"><iframe class="code-editor-frame" data-code="code-editor-element" data-code-id="7592043796225851398" data-src="https://code.juejin.cn/pen/7592043796225851398" style="display:none;" loading="lazy"/><span class="loading-placeholder" style="display:none"><img class="placeholder-image" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAJElEQVRoge3BMQEAAADCoPVP7WkJoAAAAAAAAAAAAAAAAAAAbjh8AAFte11jAAAAAElFTkSuQmCC" loading="lazy"/><span class="loading-logo"/></span></span></p>
<h2 data-id="heading-2">@propertyæ–°è§„åˆ™</h2>
<p><code>@property</code>è§„åˆ™å¯ä»¥å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰å±æ€§ï¼Œå¹¶ä¸”å¯ä»¥æŒ‡å®šè¯¥å±æ€§çš„è¯­æ³•ã€æ˜¯å¦ç»§æ‰¿ã€åˆå§‹å€¼ç­‰ã€‚</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-keyword">@property</span> --color {
  syntax: <span class="hljs-string">'&lt;color&gt;'</span>;
  inherits: false;
  initial-value: <span class="hljs-number">#000000</span>;
}
</code></pre>
<p>æˆ‘ä»¬åªéœ€è¦æŠŠè¿™ä¸ªè‡ªå®šä¹‰å±æ€§<code>--color</code>åº”ç”¨åˆ°<code>linear-gradient</code>ä¸­ï¼Œåœ¨ç‰¹å®šçš„æ—¶å€™æ”¹å˜å®ƒçš„å€¼ï¼Œ<strong>éå¸¸è½»æ¾</strong>å°±å¯ä»¥å®ç°æ¸å˜è‰²çš„è¿‡æ¸¡äº†ã€‚
<span href="https://code.juejin.cn/pen/7592061789153624106" class="code-editor-container"><iframe class="code-editor-frame" data-code="code-editor-element" data-code-id="7592061789153624106" data-src="https://code.juejin.cn/pen/7592061789153624106" style="display:none;" loading="lazy"/><span class="loading-placeholder" style="display:none"><img class="placeholder-image" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAJElEQVRoge3BMQEAAADCoPVP7WkJoAAAAAAAAAAAAAAAAAAAbjh8AAFte11jAAAAAElFTkSuQmCC" loading="lazy"/><span class="loading-logo"/></span></span>
æˆ‘ä»¬å†çœ‹çœ‹<code>@property</code>è§„åˆ™ä¸­è¿™äº›å±æ€§çš„å«ä¹‰ã€‚</p>
<h3 data-id="heading-3">Syntaxè¯­æ³•æè¿°ç¬¦</h3>
<p><code>Syntax</code>ç”¨äºæè¿°è‡ªå®šä¹‰å±æ€§çš„æ•°æ®ç±»å‹ï¼Œå¿…å¡«é¡¹ï¼Œå¸¸è§å€¼åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>&lt;number&gt;</code> æ•°å­—ï¼ˆå¦‚0ï¼Œ1ï¼Œ2.5ï¼‰</li>
<li><code>&lt;percentage&gt;</code> ç™¾åˆ†æ¯”ï¼ˆå¦‚0%ï¼Œ50%ï¼Œ100%ï¼‰</li>
<li><code>&lt;length&gt;</code> é•¿åº¦å•ä½ï¼ˆå¦‚pxï¼Œemï¼Œremï¼‰</li>
<li><code>&lt;color&gt;</code> é¢œè‰²å€¼</li>
<li><code>&lt;angle&gt;</code> è§’åº¦å€¼ï¼ˆå¦‚degï¼Œradï¼‰</li>
<li><code>&lt;time&gt;</code> æ—¶é—´å€¼ï¼ˆå¦‚sï¼Œmsï¼‰</li>
<li><code>&lt;image&gt;</code> å›¾ç‰‡</li>
<li><code>&lt;*&gt;</code> ä»»æ„ç±»å‹</li>
</ul>
<h3 data-id="heading-4">Inheritsç»§æ‰¿æè¿°ç¬¦</h3>
<p><code>Inherits</code>ç”¨äºæè¿°è‡ªå®šä¹‰å±æ€§æ˜¯å¦ä»çˆ¶å…ƒç´ ç»§æ‰¿å€¼ï¼Œå¿…å¡«é¡¹ï¼š</p>
<ul>
<li><code>true</code> ä»çˆ¶å…ƒç´ ç»§æ‰¿å€¼</li>
<li><code>false</code> ä¸ç»§æ‰¿ï¼Œæ¯ä¸ªå…ƒç´ ç‹¬ç«‹</li>
</ul>
<h3 data-id="heading-5">Initial-valueåˆå§‹å€¼æè¿°ç¬¦</h3>
<p><code>Initial-value</code>ç”¨äºæè¿°è‡ªå®šä¹‰å±æ€§çš„åˆå§‹å€¼ï¼Œåœ¨<code>Syntax</code>ä¸ºé€šç”¨æ—¶ä¸ºå¯é€‰ã€‚</p>
<h3 data-id="heading-6">å…¼å®¹æ€§</h3>
<p><code>@property</code>ç›®å‰ä»æ˜¯<strong>å®éªŒæ€§è§„åˆ™</strong>ï¼Œä½†ä¸»æµæµè§ˆå™¨è¾ƒæ–°ç‰ˆæœ¬éƒ½å·²æ”¯æŒã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fafe7972c8f54f2baccd95e47a6a2ebe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSklFXw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768271931&amp;x-signature=2L4lNtJk3RNks5AxbrtAInFx7Wk%3D" alt="b70bdd98-15d5-4aa3-a3c4-b4d08a7aba9c.png" loading="lazy"/></p>
<h2 data-id="heading-7">æ€»ç»“ä¸å±•æœ›</h2>
<p><code>@property</code>è§„åˆ™çš„å‡ºç°ï¼Œæ ‡å¿—ç€CSSåœ¨åŠ¨æ€æ ·å¼æ§åˆ¶æ–¹é¢è¿ˆå‡ºäº†é‡è¦ä¸€æ­¥ã€‚å®ƒä¸ä»…è§£å†³äº†æ¸å˜è‰²è¿‡æ¸¡çš„æŠ€æœ¯éš¾é¢˜ï¼Œæ›´ä¸ºæœªæ¥çš„CSSåŠ¨ç”»å’Œäº¤äº’è®¾è®¡å¼€è¾Ÿäº†æ–°çš„å¯èƒ½æ€§ã€‚
éšç€æµè§ˆå™¨æ”¯æŒçš„ä¸æ–­å®Œå–„ï¼Œæˆ‘ä»¬å¯ä»¥æœŸå¾…ï¼š</p>
<ul>
<li>æ›´ä¸°å¯Œçš„åŠ¨ç”»æ•ˆæœ</li>
<li>æ›´ç®€æ´çš„ä»£ç å®ç°</li>
<li>æ›´å¥½çš„æ€§èƒ½è¡¨ç°</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€æ–‡çœ‹æ‡‚jsä¸­æ‰€æœ‰å±æ€§è®¿é—®api]]></title>    <link>https://juejin.cn/post/7591861857465057318</link>    <guid>https://juejin.cn/post/7591861857465057318</guid>    <pubDate>2026-01-06T03:44:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591861857465057318" data-draft-id="7532715152770744347" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€æ–‡çœ‹æ‡‚jsä¸­æ‰€æœ‰å±æ€§è®¿é—®api"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-06T03:44:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¸ƒåˆ—ç‘Ÿå†œçš„æ˜Ÿç©º"/> <meta itemprop="url" content="https://juejin.cn/user/976022056218471"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€æ–‡çœ‹æ‡‚jsä¸­æ‰€æœ‰å±æ€§è®¿é—®api
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/976022056218471/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¸ƒåˆ—ç‘Ÿå†œçš„æ˜Ÿç©º
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T03:44:45.000Z" title="Tue Jan 06 2026 03:44:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>jså¯¹è±¡å±æ€§çš„éå†æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œæ¯”å¦‚<code>for in</code>ã€<code>Object.keys</code>ã€<code>Reflect.ownKeys</code>ç­‰ç­‰ï¼Œç”¨èµ·æ¥ä¸çŸ¥é“é€‰å“ªä¸ªï¼Œè®°èµ·æ¥éº»çƒ¦ï¼Œæœ¬æ–‡å°†ä»‹ç»æ‰€æœ‰å±æ€§è®¿é—®ç›¸å…³apiçš„èƒ½åŠ›å’ŒåŒºåˆ«ã€‚</p>
<h2 data-id="heading-0">å‰ç½®çŸ¥è¯†ï¼šå¯¹è±¡å±æ€§çš„ã€Œ3 ç§åˆ†ç±»ã€</h2>
<p>æ‰€æœ‰éå†æ–¹æ³•çš„æ ¸å¿ƒå·®å¼‚ï¼Œ<strong>æœ¬è´¨éƒ½æ˜¯ã€Œèƒ½éå†å“ªäº›ç±»å‹çš„å±æ€§ã€</strong>ï¼Œå¿…é¡»å…ˆæ˜ç¡®å¯¹è±¡å±æ€§çš„ 3 ç±»åˆ’åˆ†ï¼š</p>
<h3 data-id="heading-1">1. å¯æšä¸¾å±æ€§ vs ä¸å¯æšä¸¾å±æ€§</h3>
<p>å±æ€§çš„ <code>enumerable</code> ç‰¹æ€§ä¸º <code>true</code> æ˜¯ã€Œå¯æšä¸¾å±æ€§ã€ï¼Œ<code>false</code> æ˜¯ã€Œä¸å¯æšä¸¾å±æ€§ã€ï¼›</p>
<ul>
<li>é»˜è®¤ï¼šæˆ‘ä»¬ç›´æ¥ç»™å¯¹è±¡å®šä¹‰çš„å±æ€§ï¼ˆ<code>obj.name = 'xxx'</code>ï¼‰ã€å­—é¢é‡å£°æ˜çš„å±æ€§ï¼Œé»˜è®¤<strong>å¯æšä¸¾</strong>ï¼›</li>
<li>ä¸å¯æšä¸¾ï¼šJS å†…ç½®å±æ€§ï¼ˆæ¯”å¦‚ <code>obj.toString</code>ã€<code>obj.__proto__</code>ï¼‰ã€é€šè¿‡ <code>Object.defineProperty</code> æ‰‹åŠ¨è®¾ç½® <code>enumerable: false</code> çš„å±æ€§ï¼Œéƒ½æ˜¯<strong>ä¸å¯æšä¸¾å±æ€§</strong>ã€‚</li>
</ul>
<h3 data-id="heading-2">2. è‡ªæœ‰å±æ€§ï¼ˆè‡ªæœ‰å±æ€§ï¼‰ vs ç»§æ‰¿å±æ€§</h3>
<ul>
<li>è‡ªæœ‰å±æ€§ï¼šå¯¹è±¡<strong>è‡ªå·±æœ¬èº«æ‹¥æœ‰</strong>çš„å±æ€§ï¼ˆæŒ‚è½½åœ¨å¯¹è±¡è‡ªèº«ï¼Œä¸åœ¨ <code>__proto__</code> åŸå‹é“¾ä¸Šï¼‰ï¼›</li>
<li>ç»§æ‰¿å±æ€§ï¼šä»<strong>åŸå‹é“¾</strong>ä¸Šç»§æ‰¿è¿‡æ¥çš„å±æ€§ï¼ˆæ¯”å¦‚ <code>obj.hasOwnProperty</code>ã€<code>obj.toString</code> éƒ½æ˜¯ä» <code>Object.prototype</code> ç»§æ‰¿çš„ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-3">3. å­—ç¬¦ä¸²å±æ€§ vs Symbol å±æ€§</h3>
<p>JS å¯¹è±¡çš„å±æ€§åï¼Œ<strong>å¯ä»¥æ˜¯ã€Œå­—ç¬¦ä¸²ã€æˆ–ã€ŒSymbol ç±»å‹ã€</strong>ï¼ˆES6 æ–°å¢ï¼‰ï¼›</p>
<ul>
<li>å­—ç¬¦ä¸²å±æ€§ï¼šæœ€å¸¸ç”¨çš„ <code>obj.name</code>ã€<code>obj['age']</code> éƒ½å±äºæ­¤ç±»ï¼›</li>
<li>Symbol å±æ€§ï¼š<code>const s = Symbol('id'); obj[s] = 100</code>ï¼Œè¿™ç§å±æ€§åæ˜¯å”¯ä¸€çš„ï¼Œé»˜è®¤ä¸ä¼šè¢«å¸¸è§„éå†æ–¹æ³•æ•è·ã€‚</li>
</ul>
<h2 data-id="heading-4">ä¸åŒå±æ€§è®¿é—®(éå†/åˆ¤æ–­)æ–¹æ³•åŒºåˆ«</h2>





















































































































<table><thead><tr><th>æ–¹æ³•</th><th>è®¿é—®èŒƒå›´</th><th>èƒ½å¦è®¿é—® Symbol</th><th>èƒ½å¦è®¿é—®ä¸å¯æšä¸¾</th><th>èƒ½å¦è®¿é—®ç»§æ‰¿å±æ€§</th><th>è¿”å›å€¼ / å½¢å¼</th></tr></thead><tbody><tr><td><code>JSON.stringify</code></td><td>å¯æšä¸¾å­—ç¬¦ä¸²å±æ€§</td><td>å¦</td><td>å¦</td><td>å¦</td><td>JSONå­—ç¬¦ä¸²</td></tr><tr><td><code>for...in</code></td><td>å¯æšä¸¾å­—ç¬¦ä¸²å±æ€§</td><td>å¦</td><td>å¦</td><td>å¦</td><td>å¾ªç¯ï¼Œç›´æ¥æ‹¿ key</td></tr><tr><td><code>Object.keys</code></td><td>è‡ªæœ‰å¯æšä¸¾å­—ç¬¦ä¸²å±æ€§</td><td>å¦</td><td>å¦</td><td>å¦</td><td>å­—ç¬¦ä¸²æ•°ç»„</td></tr><tr><td><code>Object.values</code></td><td>è‡ªæœ‰å¯æšä¸¾å­—ç¬¦ä¸²å±æ€§</td><td>å¦</td><td>å¦</td><td>å¦</td><td>å€¼çš„æ•°ç»„</td></tr><tr><td><code>Object.entries</code></td><td>è‡ªæœ‰å¯æšä¸¾å­—ç¬¦ä¸²å±æ€§</td><td>å¦</td><td>å¦</td><td>å¦</td><td>äºŒç»´é”®å€¼å¯¹æ•°ç»„</td></tr><tr><td><code>Object.getOwnPropertyNames</code></td><td>è‡ªæœ‰æ‰€æœ‰å­—ç¬¦ä¸²å±æ€§</td><td>å¦</td><td>å¦</td><td>å¦</td><td>å­—ç¬¦ä¸²æ•°ç»„</td></tr><tr><td><code>Object.getOwnPropertySymbols</code></td><td>è‡ªæœ‰æ‰€æœ‰ Symbol å±æ€§</td><td><strong>æ˜¯</strong></td><td><strong>æ˜¯</strong></td><td>å¦</td><td>Symbol æ•°ç»„</td></tr><tr><td><code>Reflect.ownKeys</code></td><td>è‡ªæœ‰æ‰€æœ‰å±æ€§</td><td><strong>æ˜¯</strong></td><td><strong>æ˜¯</strong></td><td>å¦</td><td>æ··åˆç±»å‹æ•°ç»„</td></tr><tr><td><code>Object.getOwnPropertyDescriptors</code></td><td>è‡ªæœ‰æ‰€æœ‰å±æ€§</td><td><strong>æ˜¯</strong></td><td><strong>æ˜¯</strong></td><td>å¦</td><td>å±æ€§æè¿°ç¬¦å¯¹è±¡</td></tr><tr><td><code>hasOwnProperty</code></td><td>è‡ªæœ‰æ‰€æœ‰å±æ€§</td><td><strong>æ˜¯</strong></td><td><strong>æ˜¯</strong></td><td>å¦</td><td>å¸ƒå°”</td></tr><tr><td><code>Object.hasOwn</code></td><td>è‡ªæœ‰æ‰€æœ‰å±æ€§</td><td><strong>æ˜¯</strong></td><td><strong>æ˜¯</strong></td><td>å¦</td><td>å¸ƒå°”</td></tr><tr><td><code>in</code></td><td>æ‰€æœ‰å±æ€§</td><td><strong>æ˜¯</strong></td><td><strong>æ˜¯</strong></td><td><strong>æ˜¯</strong></td><td>å¸ƒå°”</td></tr><tr><td><code>Reflect.has</code></td><td>æ‰€æœ‰å±æ€§</td><td><strong>æ˜¯</strong></td><td><strong>æ˜¯</strong></td><td><strong>æ˜¯</strong></td><td>å¸ƒå°”</td></tr></tbody></table>
<h2 data-id="heading-5">è§„å¾‹å°ç»“</h2>
<ul>
<li>æœ€å±€é™çš„5ä¸ªæ–¹æ³•åˆšå¥½ä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„
<code>JSON.stringify</code>,<code>for...in</code>,<code>Object.keys</code>  ,<code>Object.values</code> ,<code>Object.entries</code>    ,æ—¢æ— æ³•è®¿é—®symbolå±æ€§ï¼Œä¹Ÿæ— æ³•è®¿é—®ä¸å¯æšä¸¾å’Œç»§æ‰¿å±æ€§ã€‚</li>
<li>å¸¦<code>own</code>çš„apiï¼Œéƒ½æ— æ³•è®¿é—®ç»§æ‰¿å±æ€§</li>
<li><code>in</code>æ“ä½œç¬¦å’Œ<code>Reflect.has</code> å¯ä»¥è®¿é—®åˆ°æ‰€æœ‰å±æ€§</li>
</ul>
<h2 data-id="heading-6">å…³äºç»§æ‰¿çš„è¯´æ˜</h2>
<p>æœ¬æ–‡ä¸­çš„ç»§æ‰¿ï¼Œæ˜¯æŒ‡åŸå‹é“¾è®¿é—®ï¼Œå¹¶éé¢å‘å¯¹è±¡ä¸­çš„ç±»ç»§æ‰¿(<code>extends</code>)ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>  {
    name = <span class="hljs-string">"å°ç‹"</span>; <span class="hljs-comment">//è‡ªæœ‰å±æ€§</span>
    <span class="hljs-title function_">work</span>(<span class="hljs-params"/>) {}
}
<span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();
</code></pre>
<p>è¿™é‡Œçš„på¯¹è±¡çš„nameå±æ€§ï¼Œæ˜¯å®ƒçš„è‡ªæœ‰å±æ€§ï¼Œè€Œworkæ–¹æ³•ç»§æ‰¿è‡ªåŸå‹é“¾ï¼Œå› æ­¤<code>own</code>ç±»æ–¹æ³•æ— æ³•è®¿é—®åˆ°workã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3717e30e795f4dcbb3b836f6a654b618~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5biD5YiX55Gf5Yac55qE5pif56m6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768275885&amp;x-signature=S0qyInnNDfE9p2%2Bak4YnZcQMNRc%3D" alt="image.png" loading="lazy"/></p>
<p>es6ä¸­çš„ç»§æ‰¿ï¼Œæ²¿ç”¨äº†es5ä¸­çš„å±æ€§ç§æœ‰ï¼Œæ–¹æ³•å…¬å¼€çš„ç»§æ‰¿æœ€ä½³å®è·µï¼Œå› æ­¤es6ä¸­extendsè‡ªçˆ¶ç±»çš„æˆå‘˜å±æ€§ï¼Œä¹Ÿæ˜¯è¯¥å®ä¾‹è‡ªæœ‰å±æ€§ã€‚</p>
<h2 data-id="heading-7">é™„</h2>
<p>æµ‹è¯•ä»£ç å’Œæˆªå›¾å¦‚ä¸‹</p>
<pre><code class="hljs language-js" lang="js">  <span class="hljs-keyword">class</span> <span class="hljs-title class_">Persion</span> {
        alive = <span class="hljs-literal">true</span>; <span class="hljs-comment">//ç»§æ‰¿å±æ€§</span>
        <span class="hljs-title function_">study</span>(<span class="hljs-params"/>) {}
      }
      <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Persion</span> {
        name = <span class="hljs-string">"å°ç‹"</span>; <span class="hljs-comment">//è‡ªæœ‰å±æ€§</span>
        <span class="hljs-title function_">work</span>(<span class="hljs-params"/>) {}
      }
      <span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();
      <span class="hljs-comment">//wealth ä¸å¯æšä¸¾</span>
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(p, <span class="hljs-string">"wealth"</span>, {
        <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">value</span>: <span class="hljs-number">1000000</span>,
      });
      p.<span class="hljs-property">age</span> = <span class="hljs-number">18</span>; <span class="hljs-comment">//ageè‡ªæœ‰å±æ€§</span>
      <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">CAREER</span> = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">"career"</span>);
      <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">ID</span> = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">"id"</span>);
      p[<span class="hljs-variable constant_">ID</span>] = <span class="hljs-string">"9523"</span>; <span class="hljs-comment">//ID symbolå±æ€§</span>
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(p, <span class="hljs-variable constant_">CAREER</span>, {
        <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">value</span>: <span class="hljs-string">"detective"</span>,
      });
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">group</span>(<span class="hljs-string">"for in"</span>);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> p) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key); <span class="hljs-comment">// alive name age</span>
      }
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">groupEnd</span>(<span class="hljs-string">"for in"</span>);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(p)); <span class="hljs-comment">//Â ['alive', 'name', 'age']</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">values</span>(p)); <span class="hljs-comment">//[true, 'å°ç‹', 18]</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(p)); <span class="hljs-comment">// '[["alive",true],["name","å°ç‹"],["age",18]]'</span>
      <span class="hljs-comment">// -----------------------å¯å¾—åˆ°ésymbolè‡ªæœ‰å±æ€§ï¼Œæ— æ³•è·å–ä¸å¯æšä¸¾å±æ€§</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Object.getOwnPropertyNames"</span>, <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertyNames</span>(p)); <span class="hljs-comment">//Â ['alive', 'name', 'wealth', 'age']</span>
      <span class="hljs-comment">//------------------------å¯å¾—åˆ°symbolå±æ€§ï¼ŒåŒ…æ‹¬ä¸å¯æšä¸¾çš„symbol</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
        <span class="hljs-string">"Object.getOwnPropertySymbols"</span>,
        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertySymbols</span>(p)
      ); <span class="hljs-comment">//[Symbol(id),Symbol(career)]</span>
      <span class="hljs-comment">//------------------------å¯å¾—åˆ°æ‰€æœ‰è‡ªæœ‰å±æ€§ï¼ŒåŒ…æ‹¬ä¸å¯æšä¸¾å’Œsymbolå±æ€§ï¼Œæ— æ³•è·å–ç»§æ‰¿å±æ€§</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Reflect.ownKeys"</span>, <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">ownKeys</span>(p)); <span class="hljs-comment">//Â ['alive', 'name', 'wealth', 'age', Symbol(id),Symbol(career)]</span>
      <span class="hljs-comment">//------------------------å¯å¾—åˆ°æ‰€æœ‰è‡ªæœ‰å±æ€§ï¼ŒåŒ…æ‹¬ä¸å¯æšä¸¾å’Œsymbolå±æ€§ï¼Œæ— æ³•è·å–ç»§æ‰¿å±æ€§</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
        <span class="hljs-string">"Object.getOwnPropertyDescriptors"</span>,
        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertyDescriptors</span>(p)
      );

      <span class="hljs-comment">//ç»§æ‰¿å±æ€§è¿”å›false</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">group</span>(<span class="hljs-string">"p.hasOwnProperty"</span>);
      [<span class="hljs-string">"alive"</span>, <span class="hljs-string">"study"</span>, <span class="hljs-string">"work"</span>, <span class="hljs-string">"name"</span>, <span class="hljs-string">"age"</span>, <span class="hljs-string">"wealth"</span>, <span class="hljs-variable constant_">ID</span>, <span class="hljs-variable constant_">CAREER</span>].<span class="hljs-title function_">forEach</span>(
        <span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
            <span class="hljs-string">`p.hasOwnProperty(<span class="hljs-subst">${name.toString()}</span>)`</span>,
            p.<span class="hljs-title function_">hasOwnProperty</span>(name)
          );
        }
      );
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">groupEnd</span>();
      <span class="hljs-comment">//ç»§æ‰¿å±æ€§è¿”å›false</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">group</span>(<span class="hljs-string">"Object.hasOwn"</span>);
      [<span class="hljs-string">"alive"</span>, <span class="hljs-string">"study"</span>, <span class="hljs-string">"work"</span>, <span class="hljs-string">"name"</span>, <span class="hljs-string">"age"</span>, <span class="hljs-string">"wealth"</span>, <span class="hljs-variable constant_">ID</span>, <span class="hljs-variable constant_">CAREER</span>].<span class="hljs-title function_">forEach</span>(
        <span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
            <span class="hljs-string">`Object.hasOwn(p, <span class="hljs-subst">${name.toString()}</span>)`</span>,
            <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">hasOwn</span>(p, name)
          );
        }
      );
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">groupEnd</span>();
      <span class="hljs-comment">// å¯åˆ¤æ–­æ‰€æœ‰å±æ€§ï¼ŒåŒ…æ‹¬ä¸å¯æšä¸¾/symbol/ç»§æ‰¿</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">group</span>(<span class="hljs-string">"in"</span>);
      [<span class="hljs-string">"alive"</span>, <span class="hljs-string">"study"</span>, <span class="hljs-string">"work"</span>, <span class="hljs-string">"name"</span>, <span class="hljs-string">"age"</span>, <span class="hljs-string">"wealth"</span>, <span class="hljs-variable constant_">ID</span>, <span class="hljs-variable constant_">CAREER</span>].<span class="hljs-title function_">forEach</span>(
        <span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${name.toString()}</span> in p`</span>, name <span class="hljs-keyword">in</span> p);
        }
      );
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">groupEnd</span>();
      <span class="hljs-comment">// å¯åˆ¤æ–­æ‰€æœ‰å±æ€§ï¼ŒåŒ…æ‹¬ä¸å¯æšä¸¾/symbol/ç»§æ‰¿</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">group</span>(<span class="hljs-string">"Reflect.has"</span>);
      [<span class="hljs-string">"alive"</span>, <span class="hljs-string">"study"</span>, <span class="hljs-string">"work"</span>, <span class="hljs-string">"name"</span>, <span class="hljs-string">"age"</span>, <span class="hljs-string">"wealth"</span>, <span class="hljs-variable constant_">ID</span>, <span class="hljs-variable constant_">CAREER</span>].<span class="hljs-title function_">forEach</span>(
        <span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
            <span class="hljs-string">`Reflect.has(p, <span class="hljs-subst">${name.toString()}</span>)`</span>,
            <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">has</span>(p, name)
          );
        }
      );
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">groupEnd</span>();
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb6007daa1be47c1968eb4c64f00fbe6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5biD5YiX55Gf5Yac55qE5pif56m6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768275885&amp;x-signature=S9MZtX7ps5QiMzdBX55qT1wyNNA%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è®©æˆ‘ä»¬ä»Spring AIå¼€å§‹]]></title>    <link>https://juejin.cn/post/7591805786398900250</link>    <guid>https://juejin.cn/post/7591805786398900250</guid>    <pubDate>2026-01-06T03:45:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591805786398900250" data-draft-id="7591871204567793690" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è®©æˆ‘ä»¬ä»Spring AIå¼€å§‹"/> <meta itemprop="keywords" content="AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-06T03:45:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¿¡ç ç”±ç¼°"/> <meta itemprop="url" content="https://juejin.cn/user/2110664941509214"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è®©æˆ‘ä»¬ä»Spring AIå¼€å§‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2110664941509214/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¿¡ç ç”±ç¼°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T03:45:10.000Z" title="Tue Jan 06 2026 03:45:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://cf-blog.icodebuddy.com/image/101/101-0.png" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">Spring AIï¼šä½¿ç”¨Javaè¿ˆå…¥ç”Ÿæˆå¼AIçš„ç¬¬ä¸€æ­¥</h2>
<p><strong>åŸºäºJavaçš„ä¼ä¸šç³»ç»Ÿé€šå¸¸éš¾ä»¥ä¸Pythonåº“åŠç›¸å…³å·¥å…·é“¾ååŒå·¥ä½œã€‚ä¸ºæ­¤ï¼ŒSpring AIåº”è¿è€Œç”Ÿ</strong>â€”â€”è¿™æ˜¯ä¸€ä¸ªæ—¨åœ¨ç®€åŒ–æ•´åˆäººå·¥æ™ºèƒ½åŠŸèƒ½ï¼ˆç‰¹åˆ«æ˜¯å¤§å‹è¯­è¨€æ¨¡å‹ï¼‰åº”ç”¨å¼€å‘çš„å¼€æºæ¡†æ¶ï¼Œå®ƒé‡‡ç”¨äº†Springç”Ÿæ€ç³»ç»Ÿä¸­å¤§å®¶ç†Ÿæ‚‰çš„æ¨¡å¼ã€‚</p>
<p>å¦‚æœæ‚¨æ˜¯ä¸€åJavaå¼€å‘è€…ï¼Œå¸Œæœ›å°†ChatGPTæˆ–Google Geminiç­‰å¼ºå¤§åŠŸèƒ½é›†æˆåˆ°ä¼ä¸šåº”ç”¨ç¨‹åºä¸­ï¼Œè€Œåˆä¸æƒ³è´¹åŠ›ç ”ç©¶å„æä¾›å•†ç‰¹å®šçš„SDKï¼Œé‚£ä¹ˆSpring AIæ˜¯æ‚¨çš„ç†æƒ³å·¥å…·ã€‚</p>
<h3 data-id="heading-1">ä»€ä¹ˆæ˜¯Spring AIï¼Ÿ</h3>
<p>Spring AIçš„æ ¸å¿ƒæ˜¯å……å½“AIæ¨¡å‹çš„<strong>é€šç”¨æŠ½è±¡å±‚</strong>ã€‚</p>
<p>å¯ä»¥å°†å…¶ç±»æ¯”äº<strong>Spring Data JPA</strong>ä¹‹äºæ•°æ®åº“çš„å…³ç³»ï¼šæ­£å¦‚Spring DataæŠ½è±¡äº†SQLå’Œæ•°æ®åº“çš„å…·ä½“ç»†èŠ‚ä¸€æ ·ï¼ŒSpring AIåˆ™æŠ½è±¡äº†ä¸åŒAIæä¾›å•†ï¼ˆå¦‚OpenAIã€Googleã€Azureã€Anthropicç­‰ï¼‰ä¹‹é—´çš„å·®å¼‚ã€‚</p>
<p>è¿™ç§æ–¹æ³•å¸¦æ¥äº†ä¸¤å¤§æ˜¾è‘—ä¼˜åŠ¿ï¼š</p>
<ol>
<li>
<p><strong>å¯ç§»æ¤æ€§</strong>ï¼šæ‚¨åªéœ€æå°‘çš„ä»£ç æ”¹åŠ¨å³å¯åœ¨ä¸åŒAIæ¨¡å‹å’Œæä¾›å•†ä¹‹é—´åˆ‡æ¢ï¼Œä»è€Œä¸ºæ‚¨çš„ç”¨ä¾‹é€‰æ‹©æœ€å…·æˆæœ¬æ•ˆç›Šæˆ–æ€§èƒ½æœ€ä½³çš„æ¨¡å‹ã€‚</p>
</li>
<li>
<p><strong>ç†Ÿæ‚‰åº¦</strong>ï¼šå®ƒä½¿ç”¨äº†ä¾èµ–æ³¨å…¥ã€è‡ªåŠ¨é…ç½®å’Œæµå¼APIï¼ˆå¦‚<code>WebClient</code>æˆ–<code>JdbcClient</code>ï¼‰ç­‰æ ‡å‡†çš„Springæ¦‚å¿µï¼Œä½¿å¾—æ•°ä»¥ç™¾ä¸‡è®¡çš„ç°æœ‰Springå¼€å‘è€…èƒ½å¤Ÿè½»æ¾ä¸Šæ‰‹ã€‚</p>
</li>
</ol>
<h3 data-id="heading-2">ä¸ºä»€ä¹ˆé€‰æ‹©Spring AIè€Œä¸æ˜¯LangChainï¼Ÿ</h3>
<p>å°½ç®¡<strong>LangChain</strong>æ˜¯ä¸€ä¸ªå¼ºå¤§ä¸”ä¸æä¾›å•†æ— å…³çš„æ¡†æ¶ï¼Œå¹¶å› LLMè°ƒç”¨çš„â€œé“¾å¼â€ç¼–æ’è€Œå¹¿å—æ¬¢è¿ï¼Œä½†å®ƒä¸»è¦ä¸º<strong>Python</strong>ç”Ÿæ€ç³»ç»Ÿæ„å»ºã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒSpring AIåˆ™æ˜¯ä»é›¶å¼€å§‹æ„å»ºï¼Œéµå¾ª<strong>Javaè¯­è¨€ä¹ æƒ¯</strong>ï¼Œå¹¶èƒ½ä¸<strong>Spring Boot</strong>åº”ç”¨æ— ç¼é›†æˆã€‚</p>
<p>ä»¥ä¸‹æ˜¯Javaä¼ä¸šå¼€å‘è€…åº”è¯¥è®¤çœŸè€ƒè™‘ä½¿ç”¨Spring AIçš„åŸå› ï¼š</p>
<p><img src="https://cf-blog.icodebuddy.com/image/101/101-1_cn.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-3">ç¬¦åˆâ€œJavaä¹ æƒ¯â€çš„ä¼˜åŠ¿</h3>
<p>å¯¹äºä¸€ä¸ªJavaå›¢é˜Ÿæ¥è¯´ï¼Œé€‰æ‹©Spring AIæ„å‘³ç€ï¼š</p>
<ul>
<li>
<p><strong>æ— éœ€å¤šè¯­è¨€å¤æ‚æ€§</strong>ï¼šæ‚¨å¯ä»¥é¿å…åœ¨ç”Ÿäº§Javaç¯å¢ƒä¸­å¼•å…¥Pythonä¾èµ–ã€è™šæ‹Ÿç¯å¢ƒä»¥åŠè¿›ç¨‹é—´é€šä¿¡å¸¦æ¥çš„éº»çƒ¦ã€‚</p>
</li>
<li>
<p><strong>æ€§èƒ½</strong>ï¼šSpring AIåŸç”Ÿè¿è¡Œåœ¨Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰å†…ï¼Œå……åˆ†åˆ©ç”¨å…¶å“è¶Šçš„åƒåœ¾å›æ”¶å’Œæ€§èƒ½ä¼˜åŒ–èƒ½åŠ›ã€‚</p>
</li>
<li>
<p><strong>å·¥å…·é“¾</strong>ï¼šæ‚¨å¯ä»¥äº«å—åˆ°é™æ€ç±»å‹æ£€æŸ¥ã€å¼ºå¤§çš„è°ƒè¯•æ”¯æŒä»¥åŠJavaæµ‹è¯•æ¡†æ¶ï¼ˆå¦‚JUnitã€Mockitoï¼‰å®Œæ•´ç”Ÿæ€ç³»ç»Ÿçš„ç›Šå¤„ã€‚</p>
</li>
</ul>
<p>ç®€è€Œè¨€ä¹‹ï¼Œå¦‚æœæ‚¨çš„åº”ç”¨ç¨‹åºæ˜¯ç”¨Javaç¼–å†™å¹¶ä½¿ç”¨Spring Bootï¼Œé‚£ä¹ˆSpring AIå°±æ˜¯é›†æˆç”Ÿæˆå¼AIæœ€è‡ªç„¶ã€é˜»åŠ›æœ€å°çš„é€‰æ‹©ã€‚</p>
<h3 data-id="heading-4">Spring AIçš„æ ¸å¿ƒæ¦‚å¿µ</h3>
<p>è¦æ„å»ºä¸€ä¸ªåŸºæœ¬çš„AIåº”ç”¨ï¼Œæ‚¨éœ€è¦ç†è§£ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶ï¼š</p>
<p><img src="https://cf-blog.icodebuddy.com/image/101/101-2_cn.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">æ„å»ºä¸€ä¸ªç®€å•çš„èŠå¤©æœåŠ¡</h3>
<p>è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæç®€çš„Spring Bootåº”ç”¨ç¨‹åºï¼Œå®ƒä½¿ç”¨<code>ChatClient</code>æ ¹æ®ç”¨æˆ·çš„æ¶ˆæ¯ç”Ÿæˆå›å¤ã€‚åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨OpenAIæ¨¡å‹ã€‚</p>
<h4 data-id="heading-6">1. é¡¹ç›®è®¾ç½®ï¼ˆMavenï¼‰</h4>
<p>å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°æ‚¨çš„<code>pom.xml</code>æ–‡ä»¶ä¸­ï¼š</p>
<pre><code class="hljs language-xml" lang="xml">
<span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>

Â  <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>

Â  Â  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>

Â  Â  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>

Â  <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

Â  <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>

Â  Â  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>

Â  Â  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-openai-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>

Â  <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span>

Â  <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>

Â  Â  <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>

Â  Â  Â  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>

Â  Â  Â  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-bom<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>

Â  Â  Â  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>

Â  Â  Â  <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span>

Â  Â  Â  <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>

Â  Â  <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

Â  <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">dependencyManagement</span>&gt;</span>

</code></pre>
<h4 data-id="heading-7">2. é…ç½®ï¼ˆapplication.propertiesï¼‰</h4>
<p>æ‚¨éœ€è¦æä¾›AIæä¾›å•†çš„APIå¯†é’¥ã€‚å°†å…¶æ”¾åœ¨<code>src/main/resources/application.properties</code>æ–‡ä»¶ä¸­ã€‚</p>
<pre><code class="hljs language-properties" lang="properties">
# ç”¨æ‚¨å®é™…çš„OpenAI APIå¯†é’¥æ›¿æ¢

spring.ai.openai.api-key=&lt;YOUR_OPENAI_API_KEY&gt;

</code></pre>
<h4 data-id="heading-8">3. æ§åˆ¶å™¨ï¼ˆAiController.javaï¼‰</h4>
<p>è¿™ä¸ªç±»å®šä¹‰äº†ä¸€ä¸ªRESTç«¯ç‚¹ï¼Œç”¨äºæ¥æ”¶æ¶ˆæ¯å¹¶ä½¿ç”¨æ³¨å…¥çš„<code>ChatClient</code>è·å–å“åº”ã€‚</p>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-keyword">package</span> com.example.aidemo;

<span class="hljs-keyword">import</span> org.springframework.ai.chat.client.ChatClient;

<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;

<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestParam;

<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;

<span class="hljs-meta">@RestController</span>

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AiController</span> {

Â  Â  <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ChatClient chatClient;

Â  Â  <span class="hljs-comment">/**

Â  Â  Â * Spring Bootä¼šæ ¹æ®ä¾èµ–é¡¹å’Œå±æ€§è‡ªåŠ¨é…ç½®å¹¶æ³¨å…¥ChatClientã€‚

Â  Â  Â */</span>

Â  Â  <span class="hljs-keyword">public</span> <span class="hljs-title function_">AiController</span><span class="hljs-params">(ChatClient.Builder chatClientBuilder)</span> {

Â  Â  Â  Â  <span class="hljs-comment">// ä½¿ç”¨æ³¨å…¥çš„æ„å»ºå™¨æ„å»ºChatClientå®ä¾‹</span>

Â  Â  Â  Â  <span class="hljs-built_in">this</span>.chatClient = chatClientBuilder.build();

Â  Â  }

Â  Â  <span class="hljs-meta">@GetMapping("/generate")</span>

Â  Â  <span class="hljs-keyword">public</span> String <span class="hljs-title function_">generate</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = "message", defaultValue = "Tell me a short, friendly joke.")</span> String message)</span> {

Â  Â  Â  Â  <span class="hljs-comment">// ä½¿ç”¨æµå¼APIå®šä¹‰æç¤ºè¯å¹¶è°ƒç”¨æ¨¡å‹</span>

Â  Â  Â  Â  <span class="hljs-keyword">return</span> chatClient.prompt()

Â  Â  Â  Â  Â  Â  .user(message) <span class="hljs-comment">// è®¾ç½®ç”¨æˆ·çš„è¾“å…¥æ¶ˆæ¯</span>

Â  Â  Â  Â  Â  Â  .call() Â  Â  Â  <span class="hljs-comment">// æ‰§è¡Œå¯¹AIæ¨¡å‹çš„è°ƒç”¨</span>

Â  Â  Â  Â  Â  Â  .content(); Â  <span class="hljs-comment">// ä»å“åº”ä¸­æå–çº¯æ–‡æœ¬å†…å®¹</span>

Â  Â  }

}

</code></pre>
<h4 data-id="heading-9">4. è¿è¡Œä¸æµ‹è¯•</h4>
<ul>
<li>
<p>è¿è¡Œæ‚¨çš„Spring Bootåº”ç”¨ç¨‹åºã€‚</p>
</li>
<li>
<p>æµ‹è¯•ç«¯ç‚¹ï¼š<code>http://localhost:8080/generate?message=Explain%20Spring%20AI%20in%20one%20sentence</code></p>
</li>
</ul>
<hr/>
<p>ã€æ³¨ã€‘æœ¬æ–‡è¯‘è‡ªï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdev.to%2Fved_sharma_e776421e694cdc%2Flets-start-with-spring-ai-3e4h" target="_blank" title="https://dev.to/ved_sharma_e776421e694cdc/lets-start-with-spring-ai-3e4h" ref="nofollow noopener noreferrer">Lets start with Spring AI</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åº”å¯¹ Nginx Ingress é€€å½¹ï¼Œæ˜¯æ—¶å€™ç†æ¸…è¿™äº›æ˜“æ··æ·†çš„æ¦‚å¿µäº†]]></title>    <link>https://juejin.cn/post/7591767753850650666</link>    <guid>https://juejin.cn/post/7591767753850650666</guid>    <pubDate>2026-01-06T03:45:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591767753850650666" data-draft-id="7591672090790248467" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åº”å¯¹ Nginx Ingress é€€å½¹ï¼Œæ˜¯æ—¶å€™ç†æ¸…è¿™äº›æ˜“æ··æ·†çš„æ¦‚å¿µäº†"/> <meta itemprop="keywords" content="äº‘åŸç”Ÿ"/> <meta itemprop="datePublished" content="2026-01-06T03:45:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿é‡Œäº‘äº‘åŸç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/3808363977648493"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åº”å¯¹ Nginx Ingress é€€å½¹ï¼Œæ˜¯æ—¶å€™ç†æ¸…è¿™äº›æ˜“æ··æ·†çš„æ¦‚å¿µäº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808363977648493/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿é‡Œäº‘äº‘åŸç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T03:45:36.000Z" title="Tue Jan 06 2026 03:45:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šæœ›å®¸</p>
<p>æœ¬æ–‡å¸Œæœ›æä¾›ä¸€ç§æ›´ç®€å•çš„æ–¹å¼ï¼Œæ¥ç†è§£è¿™äº›å®¹æ˜“æ··æ·†çš„æŠ€æœ¯æ¦‚å¿µï¼šNginxã€Ingressã€Ingress Controllerã€Ingress APIã€Nginx Ingressã€Higressã€Gateway APIã€‚</p>
<h2 data-id="heading-0">Nginx å’Œ Kubernetes</h2>
<p>æˆ‘ä»¬å…ˆæŒ‰å’Œ Kubernetes æ˜¯å¦æœ‰å…³ï¼Œåˆ†ä¸ºä¸¤ç±»ï¼š</p>
<p>Nginx æ˜¯åœ¨æ²¡æœ‰ Kubernetes çš„å¹´ä»£ï¼Œæµé‡å…¥å£ä¸Šçš„äº‹å®æ ‡å‡†ï¼Œæ˜¯ç‹¬ç«‹è¿è¡Œåœ¨ä»»ä½• Linux/Windows æœåŠ¡å™¨ä¸Šçš„ Web æœåŠ¡å™¨ã€‚æä¾›ä»¥ä¸‹ä¸»è¦åŠŸèƒ½ï¼š</p>
<ul>
<li>æ¥æ”¶è¯·æ±‚ï¼›</li>
<li>è½¬å‘è¯·æ±‚ï¼›</li>
<li>è´Ÿè½½å‡è¡¡ï¼›</li>
<li>ç®€å•çš„æµé‡æ²»ç†ï¼Œä¾‹å¦‚é™æµã€ç¼“å­˜ã€é‡å†™ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5dd7062a881f4a6d9cc2ada7cc8512a2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768275936&amp;x-signature=uzoRWXoxMs7FDMj2Vy22eEFCS9I%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è€Œ Ingress APIã€Ingress Controllerã€Nginx Ingressã€Higressã€Gateway API éƒ½ä¾èµ– Kubernetesï¼ŒKubernetes å‡ºç°åï¼Œæ‰æœ‰äº†è¿™äº›æ¦‚å¿µã€‚å…¶ä¸­ï¼ŒIngress API æ˜¯ Kubernetes ç®¡ç†æµé‡çš„è§„èŒƒï¼ŒIngress Controller æ˜¯è§„èŒƒçš„å®ç°ç»„ä»¶ï¼ŒNginx Ingress å’Œ Higress éƒ½æ˜¯è§„èŒƒçš„å®Œæ•´å®ç°å’ŒåŠŸèƒ½æ‰©å±•ï¼ŒGateway API åˆ™æ˜¯ Ingress API çš„å‡çº§å’Œä¸‹ä¸€ä»£ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d12816faa7a4342b1ff8495770e6e81~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768275936&amp;x-signature=UbK6IYYkyOT4E0JO0hyRiUMuFa0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒIngress ç»å¸¸å•ç‹¬å‡ºç°ï¼Œéœ€è¦åŸºäºè¯­å¢ƒæ¥åˆ¤æ–­ï¼Œæœ‰å¯èƒ½æ˜¯æŒ‡ Ingress APIï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æŒ‡ Ingress èµ„æºï¼Œå³ç”¨æˆ·ç¼–å†™çš„å…·ä½“é…ç½®å¯¹è±¡ï¼ˆYAMLï¼‰ï¼Œéµå¾ª Ingress APIã€‚</p>
<h2 data-id="heading-1">Ingress API å’Œ Ingress Controller</h2>
<p>Ingress API å’Œ Ingress Controller åˆ†åˆ«æ˜¯ Kubernetes æµé‡ç®¡ç†çš„è§„èŒƒå’Œæ‰§è¡Œå™¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/70e786088cf74b80ad3fe085eff71744~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768275936&amp;x-signature=IUxS0SpEqn1id8D5XVsSuNDgL6M%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>Ingress API</strong>ï¼šç”¨å£°æ˜å¼çš„æ–¹å¼ï¼Œæè¿°å¤–éƒ¨æµé‡å¦‚ä½•è¿›å…¥é›†ç¾¤é‡Œçš„ Serviceï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>å¦‚ä½•é€šè¿‡åŸŸåè®¿é—®æœåŠ¡ï¼›</li>
<li>å¦‚ä½•æ ¹æ® URL è·¯å¾„è·¯ç”±åˆ°ä¸åŒåç«¯æœåŠ¡ï¼›</li>
<li>åç«¯æœåŠ¡æ˜¯è°ï¼›</li>
<li>æ˜¯å¦å¯ç”¨ HTTPS åŠ å¯†ã€‚</li>
</ul>
<p>å½¢è±¡åœ°è¯´ï¼ŒIngress API å¯ä»¥ç†è§£ä½ Kubernetes ä¸­ç®¡ç†æµé‡çš„è¯´æ˜ä¹¦ã€‚</p>
<p><strong>Ingress Controller</strong>ï¼šæ˜¯ Ingress API çš„å®ç°ç»„ä»¶ï¼Œå³æ‰§è¡Œè€…ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>ç›‘å¬ Ingress èµ„æºå˜åŒ–ï¼›</li>
<li>å°† Ingress è§„åˆ™è½¬æ¢ä¸ºå®é™…çš„åå‘ä»£ç†é…ç½®ï¼›</li>
<li>æ¥æ”¶å¤–éƒ¨æµé‡å¹¶æŒ‰è§„åˆ™è·¯ç”±ï¼›</li>
<li>å¤„ç† TLS ç»ˆæ­¢ï¼ˆHTTPS è§£å¯†ï¼‰ï¼›</li>
<li>æä¾›å¥åº·æ£€æŸ¥ã€è´Ÿè½½å‡è¡¡ã€é‡è¯•ç­‰æµé‡æ²»ç†èƒ½åŠ›ã€‚</li>
</ul>
<p>é€šè¿‡ä»¥ä¸Šèƒ½åŠ›ï¼ŒIngress Controller å°±å®ç°äº†Â Kubernetes å…¥å£æµé‡çš„ç®¡ç†ã€‚</p>
<h2 data-id="heading-2">Nginx Ingress å’Œ Higress</h2>
<p>Nginx Ingress å’Œ Higress éƒ½æ˜¯ Ingress API çš„å®Œæ•´å®ç°å’ŒåŠŸèƒ½æ‰©å±•ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cdf9b79f58a34f3c98776a7ff13cfc0e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768275936&amp;x-signature=r7HDDeYxrZL2F3%2FB47YddrB0Ibk%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Nginx Ingressï¼šç”¨ Nginx ä½œä¸ºåº•å±‚å®ç°çš„ Ingress APIï¼Œæ§åˆ¶é¢å’Œæ•°æ®é¢è€¦åˆåœ¨åŒä¸€ä¸ªè¿›ç¨‹/å®¹å™¨ä¸­ã€‚ä¼˜ç‚¹æ˜¯ç®€å•ã€æ˜“ç”¨ã€ç¤¾åŒºå¹¿æ³›ã€‚</p>
<p><strong>ç¼ºç‚¹æ˜¯ï¼š</strong></p>
<ul>
<li>ä¸æ˜¯åŸç”Ÿçš„ Ingress APIï¼ŒIngress API è¯­ä¹‰åå¼±ï¼›</li>
<li>æ‰©å±•é  Annotationï¼ˆå·¥ç¨‹å™©æ¢¦ï¼‰ï¼›</li>
<li>ç”Ÿæˆ nginx.conf + reloadï¼ŒåŠ¨æ€é…ç½®èƒ½åŠ›å¼±ï¼ˆé¢‘ç¹ reload å½±å“æ€§èƒ½ï¼‰ã€‚</li>
</ul>
<p>é€‚ç”¨äºç®€å•ã€ç¨³å®šã€å°è§„æ¨¡çš„åœºæ™¯ã€‚</p>
<p>Higressï¼šæ•°æ®é¢æ˜¯åŸºäº Enovyï¼Œæ§åˆ¶é¢ç»™åŸºäº istioï¼Œæ˜¯åŸç”Ÿçš„ Ingress APIã€‚</p>
<p><strong>ä¼˜ç‚¹æ˜¯ï¼š</strong></p>
<ul>
<li>æ§åˆ¶é¢ä¸æ•°æ®é¢è§£è€¦ï¼Œå¯ç‹¬ç«‹æ‰©ç¼©å®¹ï¼›</li>
<li>åŸºäº xDS åè®®ï¼Œå®ç°çœŸæ­£çš„åŠ¨æ€é…ç½®ï¼ˆæ—  reloadï¼Œé›¶ä¸­æ–­ï¼‰ï¼›</li>
<li>åŸç”Ÿæ”¯æŒæ’ä»¶æ‰©å±•ï¼šWasmã€Luaã€Go æ’ä»¶ç”±æ§åˆ¶é¢ç»Ÿä¸€ç®¡ç†å¹¶ä¸‹å‘ï¼›</li>
<li><strong>å…¼å®¹å¤šåè®® &amp; å¤šæ ‡å‡†ï¼šåŒæ—¶æ”¯æŒ Ingress API å’Œ Gateway APIã€‚</strong></li>
</ul>
<p>ç¼ºç‚¹æ˜¯ï¼Œç›¸æ¯”Â Nginx å¹¿æ³›çš„ç¤¾åŒºåŸºç¡€ï¼ŒHigress ä¸ºä»£è¡¨çš„åŸç”Ÿ Ingress APIï¼Œéƒ¨ç½²å’Œç»´æŠ¤å­˜åœ¨å­¦ä¹ æˆæœ¬ã€‚</p>
<p>é€‚ç”¨äºé«˜æ€§èƒ½ã€é«˜æ‰©å±•ã€ä¼ä¸šçº§çš„åœºæ™¯ã€‚</p>
<h2 data-id="heading-3">Nginx Ingress é€€å½¹</h2>
<p>11æœˆï¼ŒKubernetes SIG Network å’Œå®‰å…¨å“åº”å§”å‘˜ä¼šå®£å¸ƒ Ingress NGINX é€€å½¹ã€‚ï¼ˆâš ï¸Â NGINX å¹¶æœªé€€å½¹ã€‚ï¼‰</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb08cd46ccda4305bddddd7ad9805fb4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768275936&amp;x-signature=PFongHPha%2BYCvUwdh4n8D0w6o8s%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>æ„å‘³ç€ï¼š</strong></p>
<ul>
<li>Ingress NGINX å°½åŠ›ç»´æŠ¤æœåŠ¡è‡³ 2026 å¹´ 3 æœˆï¼›</li>
<li>ä¸å†å‘å¸ƒä»»ä½•æ–°ç‰ˆæœ¬ï¼›</li>
<li>ä¸å†ä¿®å¤ä»»ä½•æ¼æ´ï¼›</li>
<li>ä¹Ÿä¸ä¼šæ›´æ–°ä»»ä½•å¯èƒ½å‘ç°çš„å®‰å…¨æ¼æ´ï¼›</li>
<li>GitHub ä»£ç åº“å°†è®¾ç½®ä¸ºåªè¯»ï¼Œä»…ä¾›å‚è€ƒï¼›</li>
<li>ç°æœ‰çš„ Ingress NGINX éƒ¨ç½²å°†ç»§ç»­è¿è¡Œï¼Œå®‰è£…æ–‡ä»¶ä¹Ÿå°†ç»§ç»­å¯ç”¨ã€‚</li>
</ul>
<p>å¼•å‘é€€å½¹çš„æ ¹æœ¬åŸå› ï¼šï¼š</p>
<ul>
<li>å¤šå¹´æ¥ï¼Œè¯¥é¡¹ç›®åªæœ‰ä¸€ä¸¤ä¸ªäººåˆ©ç”¨ä¸šä½™æ—¶é—´ï¼Œåœ¨å·¥ä½œä¹‹ä½™è¿›è¡Œå¼€å‘å·¥ä½œï¼›</li>
<li>å°è¯•å’Œ Gateway API ç¤¾åŒºåˆä½œå¼€å‘ä¸€ä¸ªæ›¿ä»£æ§åˆ¶å™¨ï¼Œä½†æœªèƒ½æ¿€å‘æ›´å¤šäººå‚ä¸ Ingress NGINX çš„ç»´æŠ¤ã€‚</li>
</ul>
<h2 data-id="heading-4">Higressï¼šNginx Ingress é€€å½¹çš„æ›¿ä»£ä¼˜å…ˆæ–¹æ¡ˆ</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a54f7fbf0fc4243a9779926978f1659~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768275936&amp;x-signature=NKPqzNS5csEVsz%2BQSxagvB963no%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ul>
<li>Kubernetes å®˜æ–¹æ¨èï¼Œå³å®˜æ–¹ç¤¾åŒºæ–‡æ¡£ä¸­è¿›è¡Œäº†è¯´æ˜ï¼›</li>
<li>å¯¹ Nginx Ingress çš„ Annotation å…¼å®¹åº¦æœ€é«˜ï¼Œæ”¯æŒ 51 ç§ï¼Œè¦†ç›– 90% çš„ç”¨æˆ·åœºæ™¯ï¼Œè¿™æ„å‘³ç€ç°æœ‰çš„ K8s Ingress YAML æ–‡ä»¶æ— éœ€å¤§é‡ä¿®æ”¹å³å¯å®Œæˆè¿ç§»ï¼›</li>
<li>é•¿æœŸæŠ•å…¥ï¼Œå¹¶æä¾›ä¼ä¸šç‰ˆæœåŠ¡ï¼Œå³é˜¿é‡Œäº‘ API ç½‘å…³ï¼›</li>
<li>æä¾›ç›‘å¬ K8s Ingressï¼ˆIngress æ¨¡å¼ï¼‰ï¼Œé€‚ç”¨äºå¸Œæœ›ä¿æŒ K8s åŸç”Ÿå·¥ä½œæµï¼ˆå¦‚GitOpsï¼‰çš„å›¢é˜Ÿï¼›å’Œæ§åˆ¶å°é…ç½® APIï¼ˆAPI ç®¡ç†æ¨¡å¼ï¼‰ï¼Œé€‚ç”¨äºéœ€è¦é›†ä¸­æ²»ç†å’Œç²¾ç»†åŒ–ç®¡ç†çš„åœºæ™¯ã€‚</li>
</ul>
<h2 data-id="heading-5">Gateway API å’Œ Ingress API</h2>
<p>Gateway API æ˜¯ Ingress API è§„èŒƒçš„è¶…é›†å’Œä¸‹ä¸€ä»£ã€‚ä»–çš„å‡ºç°ï¼Œæ˜¯ä¸ºäº†è§£å†³ Ingress API è‡ªèº«æ— æ³•æå®šçš„é—®é¢˜ã€‚å…¶ä¸­ï¼ŒHigress å·²ç»æ”¯æŒ Gateway API æ ‡å‡†ï¼Œç”¨æˆ·å¯ä» Ingress API å¹³æ»‘è¿ç§»è‡³ Gateway APIã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de4cb0684f4a4544b910ef82aef57fe3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_6YeM5LqR5LqR5Y6f55Sf:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768275936&amp;x-signature=FhslJ6330cnp%2FjzVpgK4s7yRLKw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Ingress API å­˜åœ¨çš„é—®é¢˜ï¼ŒGateway API è¿™æ ·å»è§£å†³ï¼š</p>
<p>èŒè´£ä¸æ¸…ï¼Œåæœæ˜¯ Ingress æ˜¯â€œä¸€äººå†™å…¨â€ï¼Œæ²¡æœ‰æƒé™è¾¹ç•Œã€‚<strong>-&gt; Gateway API é€šè¿‡è§’è‰²åˆ†ç¦»è§£å†³ï¼Œå®šä¹‰åŸºç¡€è®¾æ–½æä¾›è€…ã€é›†ç¾¤ç®¡ç†å‘˜ã€åº”ç”¨å¼€å‘è€…ã€‚</strong></p>
<p>åŠŸèƒ½è¡¨è¾¾èƒ½åŠ›å¼±ï¼Œä¾èµ– Controller ç‰¹æœ‰æ‰©å±•ï¼Œåæœæ˜¯ä¸æ ‡å‡†ã€ä¸åŒå®ç°ä¹‹é—´è¿ç§»æˆæœ¬é«˜ã€‚<strong>-&gt; Gateway API é€šè¿‡ Wasmã€æ’ä»¶ã€æœåŠ¡ç½‘æ ¼é›†æˆè§£å†³æ‰©å±•çš„æ ‡å‡†åŒ–ã€‚</strong></p>
<p>ä»…æ”¯æŒ HTTP/HTTPSï¼Œæ— æ³•å¤„ç† TCP/UDP/gRPC ç­‰åè®®ã€‚<strong>-&gt; äº‘åŸç”Ÿåº”ç”¨æ—©å·²ä¸åªæ˜¯ Web æœåŠ¡ï¼ŒGateway API é€šè¿‡ç»Ÿä¸€çš„ APIï¼Œç®¡ç†æ‰€æœ‰å—åŒ—å‘æµé‡ã€‚</strong></p>
<p>æ— æ³•è¡¨è¾¾å¤æ‚è·¯ç”±é€»è¾‘ï¼Œå¾®æœåŠ¡æ²»ç†éœ€æ±‚è¿œè¶… Ingress èƒ½åŠ›ã€‚<strong>-&gt; Gateway API æ”¯æŒ Wasmã€æ’ä»¶ã€æœåŠ¡ç½‘æ ¼é›†æˆï¼Œé€šè¿‡æ ‡å‡†åŒ–çš„é«˜çº§è·¯ç”±è§£å†³ã€‚</strong></p>
<p>ä¸€ä¸ª Ingress Controller å…¨å±€å…±äº«ï¼Œç¼ºä¹å¤šç§Ÿæˆ·éš”ç¦»ï¼Œå¤šç§Ÿæˆ·åœºæ™¯ä¸‹å­˜åœ¨å®‰å…¨å’Œé…ç½®å†²çªé£é™©ã€‚<strong>-&gt; Gateway API æä¾›äº†ç‹¬ç«‹ Gateway çš„å®ä¾‹ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰‹å†™Spring IoCï¼šæ³¨è§£+åå°„æ‰“é€ è½»é‡çº§å®¹å™¨]]></title>    <link>https://juejin.cn/post/7591871204567810074</link>    <guid>https://juejin.cn/post/7591871204567810074</guid>    <pubDate>2026-01-06T03:45:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591871204567810074" data-draft-id="7591694511244787750" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰‹å†™Spring IoCï¼šæ³¨è§£+åå°„æ‰“é€ è½»é‡çº§å®¹å™¨"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-01-06T03:45:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨ä¸­é£˜è¡çš„è®°å¿†"/> <meta itemprop="url" content="https://juejin.cn/user/694547077666606"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰‹å†™Spring IoCï¼šæ³¨è§£+åå°„æ‰“é€ è½»é‡çº§å®¹å™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/694547077666606/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨ä¸­é£˜è¡çš„è®°å¿†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T03:45:36.000Z" title="Tue Jan 06 2026 03:45:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ‰‹å†™Spring IoCï¼šæ³¨è§£+åå°„æ‰“é€ è½»é‡çº§å®¹å™¨</h2>
<blockquote>
<p>æ·±å…¥ç†è§£Spring IoCæ ¸å¿ƒåŸç†ï¼Œé€šè¿‡æ³¨è§£å’Œåå°„æœºåˆ¶æ‰‹å†™ä¸€ä¸ªç®€æ˜“ç‰ˆIoCå®¹å™¨ï¼ŒæŒæ¡ä¾èµ–æ³¨å…¥çš„æœ¬è´¨ã€‚</p>
</blockquote>
<h3 data-id="heading-1">1. å¼•è¨€ï¼šSpring IoCçš„é­”åŠ›</h3>
<p>åœ¨Springæ¡†æ¶ä¸­ï¼ŒIoCï¼ˆæ§åˆ¶åè½¬ï¼‰å’ŒDIï¼ˆä¾èµ–æ³¨å…¥ï¼‰æ˜¯æœ€æ ¸å¿ƒçš„æ¦‚å¿µã€‚åªéœ€ä¸€ä¸ª<code>@Autowired</code>æ³¨è§£ï¼ŒSpringå°±èƒ½è‡ªåŠ¨å¸®æˆ‘ä»¬æ³¨å…¥ä¾èµ–å¯¹è±¡ï¼Œè¿™èƒŒåçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>æœ¬æ–‡å°†é€šè¿‡<strong>æ³¨è§£+åå°„</strong>çš„æ–¹å¼ï¼Œæ‰‹å†™ä¸€ä¸ªç®€æ˜“ç‰ˆSpring IoCå®¹å™¨ï¼Œè®©ä½ æ·±å…¥ç†è§£ï¼š</p>
<ul>
<li>æ³¨è§£æ˜¯å¦‚ä½•è¢«æ‰«æå’Œè§£æçš„</li>
<li>Beanæ˜¯å¦‚ä½•è¢«åˆ›å»ºå’Œç®¡ç†çš„</li>
<li>ä¾èµ–æ³¨å…¥æ˜¯å¦‚ä½•å®ç°çš„</li>
<li>Springå®¹å™¨çš„è¿è¡Œæœºåˆ¶</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8973d982964b4b1eab85947f180db86b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768275935&amp;x-signature=psXeyOKXMKmYg1GutFFHZ0z9dnU%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-2">1.1 ä¸ºä»€ä¹ˆè¦æ‰‹å†™IoCï¼Ÿ</h4>
<ul>
<li><strong>ç†è§£åŸç†</strong> - çŸ¥å…¶ç„¶æ›´çŸ¥å…¶æ‰€ä»¥ç„¶</li>
<li><strong>é¢è¯•å¿…å¤‡</strong> - Spring IoCæ˜¯é¢è¯•é«˜é¢‘è€ƒç‚¹</li>
<li><strong>æå‡èƒ½åŠ›</strong> - æŒæ¡åå°„ã€æ³¨è§£ç­‰æ ¸å¿ƒæŠ€æœ¯</li>
<li><strong>æ¡†æ¶é€‰å‹</strong> - ç†è§£æ¡†æ¶è®¾è®¡æ€æƒ³</li>
</ul>
<hr/>
<h3 data-id="heading-3">2. æ ¸å¿ƒæ¦‚å¿µï¼šIoCã€DIã€æ³¨è§£ã€åå°„</h3>
<h4 data-id="heading-4">2.1 æ§åˆ¶åè½¬ï¼ˆIoCï¼‰</h4>
<p><strong>ä¼ ç»Ÿæ–¹å¼</strong>ï¼šå¯¹è±¡è‡ªå·±åˆ›å»ºä¾èµ–</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">UserDao</span> <span class="hljs-variable">userDao</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserDaoImpl</span>(); <span class="hljs-comment">// ä¸»åŠ¨åˆ›å»º</span>
}
</code></pre>
<p><strong>IoCæ–¹å¼</strong>ï¼šå¯¹è±¡ç”±å®¹å™¨åˆ›å»ºå’Œæ³¨å…¥</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> UserDao userDao; <span class="hljs-comment">// è¢«åŠ¨æ¥æ”¶</span>
}
</code></pre>
<p><strong>æ§åˆ¶åè½¬</strong>å°±æ˜¯æŠŠå¯¹è±¡åˆ›å»ºå’Œä¾èµ–ç®¡ç†çš„æ§åˆ¶æƒï¼Œä»åº”ç”¨ä»£ç è½¬ç§»åˆ°IoCå®¹å™¨ã€‚</p>
<h4 data-id="heading-5">2.2 ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰</h4>
<p>ä¾èµ–æ³¨å…¥æ˜¯IoCçš„å®ç°æ–¹å¼ï¼Œæœ‰ä¸‰ç§æ³¨å…¥æ–¹å¼ï¼š</p>
<p><strong>â‘  æ„é€ å™¨æ³¨å…¥</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserDao userDao;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserService</span><span class="hljs-params">(UserDao userDao)</span> {
        <span class="hljs-built_in">this</span>.userDao = userDao;
    }
}
</code></pre>
<p><strong>â‘¡ Setteræ³¨å…¥</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-keyword">private</span> UserDao userDao;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setUserDao</span><span class="hljs-params">(UserDao userDao)</span> {
        <span class="hljs-built_in">this</span>.userDao = userDao;
    }
}
</code></pre>
<p><strong>â‘¢ å­—æ®µæ³¨å…¥</strong>ï¼ˆæœ€å¸¸ç”¨ï¼‰</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> UserDao userDao;
}
</code></pre>
<h4 data-id="heading-6">2.3 Javaæ³¨è§£</h4>
<p>æ³¨è§£æ˜¯Java 5å¼•å…¥çš„å…ƒæ•°æ®æ ‡è®°æœºåˆ¶ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å®šä¹‰æ³¨è§£</span>
<span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span> <span class="hljs-comment">// è¿è¡Œæ—¶ä¿ç•™</span>
<span class="hljs-meta">@Target(ElementType.TYPE)</span>           <span class="hljs-comment">// ä½œç”¨äºç±»</span>
<span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Component {
    String <span class="hljs-title function_">value</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-string">""</span>;
}

<span class="hljs-comment">// ä½¿ç”¨æ³¨è§£</span>
<span class="hljs-meta">@Component("userService")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
}
</code></pre>
<h4 data-id="heading-7">2.4 Javaåå°„</h4>
<p>åå°„å…è®¸ç¨‹åºåœ¨è¿è¡Œæ—¶åŠ¨æ€è·å–ç±»ä¿¡æ¯å¹¶æ“ä½œå¯¹è±¡ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åŠ è½½ç±»</span>
Class&lt;?&gt; clazz = Class.forName(<span class="hljs-string">"com.example.UserService"</span>);

<span class="hljs-comment">// æ£€æŸ¥æ³¨è§£</span>
<span class="hljs-keyword">if</span> (clazz.isAnnotationPresent(Component.class)) {
    <span class="hljs-type">Component</span> <span class="hljs-variable">component</span> <span class="hljs-operator">=</span> clazz.getAnnotation(Component.class);
    <span class="hljs-type">String</span> <span class="hljs-variable">beanName</span> <span class="hljs-operator">=</span> component.value();
}

<span class="hljs-comment">// åˆ›å»ºå®ä¾‹</span>
<span class="hljs-type">Object</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> clazz.getDeclaredConstructor().newInstance();

<span class="hljs-comment">// è·å–å­—æ®µ</span>
Field[] fields = clazz.getDeclaredFields();

<span class="hljs-comment">// è®¾ç½®å­—æ®µå€¼</span>
field.setAccessible(<span class="hljs-literal">true</span>);
field.set(instance, value);
</code></pre>
<hr/>
<h3 data-id="heading-8">3. ç¬¬ä¸€æ­¥ï¼šå®šä¹‰æ ¸å¿ƒæ³¨è§£</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ddbd78b7e934e5182131b248e56cc9c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768275935&amp;x-signature=ra%2BrLzOTjz6FwTJdqvPd3hTz0z4%3D" alt="" loading="lazy"/></p>
<p>é¦–å…ˆå®šä¹‰æˆ‘ä»¬è‡ªå·±çš„æ³¨è§£ï¼Œæ¨¡æ‹ŸSpringçš„æ ¸å¿ƒæ³¨è§£ã€‚</p>
<h4 data-id="heading-9">3.1 @Componentæ³¨è§£</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.myspring.annotation;

<span class="hljs-keyword">import</span> java.lang.annotation.*;

<span class="hljs-comment">/**
 * æ ‡è®°ç»„ä»¶ç±»ï¼Œç±»ä¼¼Springçš„<span class="hljs-doctag">@Component</span>
 */</span>
<span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span>
<span class="hljs-meta">@Target(ElementType.TYPE)</span>
<span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Component {
    <span class="hljs-comment">/**
     * Beanåç§°ï¼Œé»˜è®¤ä¸ºç±»åé¦–å­—æ¯å°å†™
     */</span>
    String <span class="hljs-title function_">value</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-string">""</span>;
}
</code></pre>
<h4 data-id="heading-10">3.2 @Autowiredæ³¨è§£</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.myspring.annotation;

<span class="hljs-keyword">import</span> java.lang.annotation.*;

<span class="hljs-comment">/**
 * è‡ªåŠ¨æ³¨å…¥ä¾èµ–ï¼Œç±»ä¼¼Springçš„<span class="hljs-doctag">@Autowired</span>
 */</span>
<span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span>
<span class="hljs-meta">@Target({ElementType.FIELD, ElementType.METHOD, ElementType.CONSTRUCTOR})</span>
<span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Autowired {
    <span class="hljs-comment">/**
     * æ˜¯å¦å¿…é¡»æ³¨å…¥
     */</span>
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">required</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-literal">true</span>;
}
</code></pre>
<h4 data-id="heading-11">3.3 @Qualifieræ³¨è§£</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.myspring.annotation;

<span class="hljs-keyword">import</span> java.lang.annotation.*;

<span class="hljs-comment">/**
 * æŒ‡å®šè¦æ³¨å…¥çš„Beanåç§°
 */</span>
<span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span>
<span class="hljs-meta">@Target({ElementType.FIELD, ElementType.PARAMETER})</span>
<span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Qualifier {
    String <span class="hljs-title function_">value</span><span class="hljs-params">()</span>;
}
</code></pre>
<h4 data-id="heading-12">3.4 @Scopeæ³¨è§£</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.myspring.annotation;

<span class="hljs-keyword">import</span> java.lang.annotation.*;

<span class="hljs-comment">/**
 * æŒ‡å®šBeançš„ä½œç”¨åŸŸ
 */</span>
<span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span>
<span class="hljs-meta">@Target(ElementType.TYPE)</span>
<span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Scope {
    String <span class="hljs-title function_">value</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-string">"singleton"</span>;
}
</code></pre>
<hr/>
<h3 data-id="heading-13">4. ç¬¬äºŒæ­¥ï¼šå®ç°åŒ…æ‰«æå™¨</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4af5705699904ec59afb178a2de40530~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768275935&amp;x-signature=hGjQnrutKn0W7I6011yrjaXuUkg%3D" alt="" loading="lazy"/></p>
<p>åŒ…æ‰«æå™¨è´Ÿè´£æ‰«ææŒ‡å®šåŒ…ä¸‹çš„æ‰€æœ‰ç±»ï¼Œæ‰¾å‡ºå¸¦æœ‰<code>@Component</code>æ³¨è§£çš„ç±»ã€‚</p>
<h4 data-id="heading-14">4.1 ClassScannerç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.myspring.core;

<span class="hljs-keyword">import</span> com.myspring.annotation.Component;
<span class="hljs-keyword">import</span> java.io.File;
<span class="hljs-keyword">import</span> java.net.URL;
<span class="hljs-keyword">import</span> java.util.ArrayList;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * ç±»æ‰«æå™¨ï¼šæ‰«ææŒ‡å®šåŒ…ä¸‹çš„æ‰€æœ‰ç±»
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassScanner</span> {

    <span class="hljs-comment">/**
     * æ‰«ææŒ‡å®šåŒ…ä¸‹å¸¦æœ‰<span class="hljs-doctag">@Component</span>æ³¨è§£çš„ç±»
     *
     * <span class="hljs-doctag">@param</span> basePackage åŸºç¡€åŒ…è·¯å¾„ï¼Œå¦‚"com.example"
     * <span class="hljs-doctag">@return</span> å¸¦æœ‰<span class="hljs-doctag">@Component</span>æ³¨è§£çš„Classåˆ—è¡¨
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;Class&lt;?&gt;&gt; scanComponents(String basePackage) {
        List&lt;Class&lt;?&gt;&gt; classList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();

        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å°†åŒ…åè½¬æ¢ä¸ºè·¯å¾„</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">packagePath</span> <span class="hljs-operator">=</span> basePackage.replace(<span class="hljs-string">'.'</span>, <span class="hljs-string">'/'</span>);

            <span class="hljs-comment">// è·å–åŒ…çš„URLè·¯å¾„</span>
            <span class="hljs-type">ClassLoader</span> <span class="hljs-variable">classLoader</span> <span class="hljs-operator">=</span> Thread.currentThread().getContextClassLoader();
            <span class="hljs-type">URL</span> <span class="hljs-variable">resource</span> <span class="hljs-operator">=</span> classLoader.getResource(packagePath);

            <span class="hljs-keyword">if</span> (resource == <span class="hljs-literal">null</span>) {
                System.out.println(<span class="hljs-string">"åŒ…è·¯å¾„ä¸å­˜åœ¨: "</span> + basePackage);
                <span class="hljs-keyword">return</span> classList;
            }

            <span class="hljs-comment">// è·å–åŒ…çš„æ–‡ä»¶è·¯å¾„</span>
            <span class="hljs-type">File</span> <span class="hljs-variable">packageDir</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(resource.getFile());

            <span class="hljs-comment">// é€’å½’æ‰«ææ‰€æœ‰ç±»æ–‡ä»¶</span>
            scanClasses(packageDir, basePackage, classList);

        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }

        <span class="hljs-keyword">return</span> classList;
    }

    <span class="hljs-comment">/**
     * é€’å½’æ‰«æç›®å½•ä¸‹çš„æ‰€æœ‰ç±»æ–‡ä»¶
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">scanClasses</span><span class="hljs-params">(File dir, String packageName, List&lt;Class&lt;?&gt;&gt; classList)</span> {
        <span class="hljs-keyword">if</span> (!dir.exists() || !dir.isDirectory()) {
            <span class="hljs-keyword">return</span>;
        }

        File[] files = dir.listFiles();
        <span class="hljs-keyword">if</span> (files == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-keyword">for</span> (File file : files) {
            <span class="hljs-keyword">if</span> (file.isDirectory()) {
                <span class="hljs-comment">// é€’å½’æ‰«æå­ç›®å½•</span>
                scanClasses(file, packageName + <span class="hljs-string">"."</span> + file.getName(), classList);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (file.getName().endsWith(<span class="hljs-string">".class"</span>)) {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-comment">// è·å–ç±»å</span>
                    <span class="hljs-type">String</span> <span class="hljs-variable">className</span> <span class="hljs-operator">=</span> packageName + <span class="hljs-string">"."</span> +
                        file.getName().replace(<span class="hljs-string">".class"</span>, <span class="hljs-string">""</span>);

                    <span class="hljs-comment">// åŠ è½½ç±»</span>
                    Class&lt;?&gt; clazz = Class.forName(className);

                    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰@Componentæ³¨è§£</span>
                    <span class="hljs-keyword">if</span> (clazz.isAnnotationPresent(Component.class)) {
                        classList.add(clazz);
                        System.out.println(<span class="hljs-string">"æ‰«æåˆ°ç»„ä»¶: "</span> + className);
                    }

                } <span class="hljs-keyword">catch</span> (ClassNotFoundException e) {
                    e.printStackTrace();
                }
            }
        }
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-15">5. ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºBeanå·¥å‚</h3>
<p>Beanå·¥å‚è´Ÿè´£å­˜å‚¨å’Œç®¡ç†æ‰€æœ‰çš„Beanå®ä¾‹ã€‚</p>
<h4 data-id="heading-16">5.1 BeanDefinitionç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.myspring.core;

<span class="hljs-comment">/**
 * Beanå®šä¹‰ä¿¡æ¯
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BeanDefinition</span> {
    <span class="hljs-keyword">private</span> String beanName;
    <span class="hljs-keyword">private</span> Class&lt;?&gt; beanClass;
    <span class="hljs-keyword">private</span> String scope;
    <span class="hljs-keyword">private</span> Object singletonInstance;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">BeanDefinition</span><span class="hljs-params">(String beanName, Class&lt;?&gt; beanClass, String scope)</span> {
        <span class="hljs-built_in">this</span>.beanName = beanName;
        <span class="hljs-built_in">this</span>.beanClass = beanClass;
        <span class="hljs-built_in">this</span>.scope = scope;
    }

    <span class="hljs-comment">// Getterå’ŒSetteræ–¹æ³•</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getBeanName</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> beanName; }
    <span class="hljs-keyword">public</span> Class&lt;?&gt; getBeanClass() { <span class="hljs-keyword">return</span> beanClass; }
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getScope</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> scope; }
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getSingletonInstance</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> singletonInstance; }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setSingletonInstance</span><span class="hljs-params">(Object instance)</span> {
        <span class="hljs-built_in">this</span>.singletonInstance = instance;
    }
}
</code></pre>
<h4 data-id="heading-17">5.2 BeanFactoryç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.myspring.core;

<span class="hljs-keyword">import</span> com.myspring.annotation.Component;
<span class="hljs-keyword">import</span> com.myspring.annotation.Scope;
<span class="hljs-keyword">import</span> java.util.Map;
<span class="hljs-keyword">import</span> java.util.concurrent.ConcurrentHashMap;

<span class="hljs-comment">/**
 * Beanå·¥å‚ï¼šåˆ›å»ºå’Œç®¡ç†Beanå®ä¾‹
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BeanFactory</span> {

    <span class="hljs-comment">// å­˜å‚¨Beanå®šä¹‰ä¿¡æ¯</span>
    <span class="hljs-keyword">private</span> Map&lt;String, BeanDefinition&gt; beanDefinitionMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();

    <span class="hljs-comment">/**
     * æ³¨å†ŒBeanå®šä¹‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerBeanDefinition</span><span class="hljs-params">(Class&lt;?&gt; clazz)</span> {
        <span class="hljs-comment">// è·å–Beanåç§°</span>
        <span class="hljs-type">Component</span> <span class="hljs-variable">component</span> <span class="hljs-operator">=</span> clazz.getAnnotation(Component.class);
        <span class="hljs-type">String</span> <span class="hljs-variable">beanName</span> <span class="hljs-operator">=</span> component.value();
        <span class="hljs-keyword">if</span> (beanName.isEmpty()) {
            <span class="hljs-comment">// é»˜è®¤ä½¿ç”¨ç±»åé¦–å­—æ¯å°å†™</span>
            beanName = toLowerFirstCase(clazz.getSimpleName());
        }

        <span class="hljs-comment">// è·å–ä½œç”¨åŸŸ</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">scope</span> <span class="hljs-operator">=</span> <span class="hljs-string">"singleton"</span>;
        <span class="hljs-keyword">if</span> (clazz.isAnnotationPresent(Scope.class)) {
            <span class="hljs-type">Scope</span> <span class="hljs-variable">scopeAnnotation</span> <span class="hljs-operator">=</span> clazz.getAnnotation(Scope.class);
            scope = scopeAnnotation.value();
        }

        <span class="hljs-comment">// åˆ›å»ºBeanDefinitionå¹¶æ³¨å†Œ</span>
        <span class="hljs-type">BeanDefinition</span> <span class="hljs-variable">beanDefinition</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BeanDefinition</span>(beanName, clazz, scope);
        beanDefinitionMap.put(beanName, beanDefinition);

        System.out.println(<span class="hljs-string">"æ³¨å†ŒBean: "</span> + beanName + <span class="hljs-string">", ä½œç”¨åŸŸ: "</span> + scope);
    }

    <span class="hljs-comment">/**
     * è·å–Beanå®ä¾‹
     */</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getBean</span><span class="hljs-params">(String beanName)</span> {
        <span class="hljs-type">BeanDefinition</span> <span class="hljs-variable">beanDefinition</span> <span class="hljs-operator">=</span> beanDefinitionMap.get(beanName);
        <span class="hljs-keyword">if</span> (beanDefinition == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"Beanä¸å­˜åœ¨: "</span> + beanName);
        }

        <span class="hljs-comment">// å•ä¾‹æ¨¡å¼</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-string">"singleton"</span>.equals(beanDefinition.getScope())) {
            <span class="hljs-type">Object</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> beanDefinition.getSingletonInstance();
            <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {
                instance = createBean(beanDefinition);
                beanDefinition.setSingletonInstance(instance);
            }
            <span class="hljs-keyword">return</span> instance;
        }

        <span class="hljs-comment">// åŸå‹æ¨¡å¼ï¼šæ¯æ¬¡éƒ½åˆ›å»ºæ–°å®ä¾‹</span>
        <span class="hljs-keyword">return</span> createBean(beanDefinition);
    }

    <span class="hljs-comment">/**
     * æ ¹æ®ç±»å‹è·å–Bean
     */</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getBean</span><span class="hljs-params">(Class&lt;?&gt; clazz)</span> {
        <span class="hljs-keyword">for</span> (BeanDefinition bd : beanDefinitionMap.values()) {
            <span class="hljs-keyword">if</span> (clazz.isAssignableFrom(bd.getBeanClass())) {
                <span class="hljs-keyword">return</span> getBean(bd.getBeanName());
            }
        }
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"Beanä¸å­˜åœ¨: "</span> + clazz.getName());
    }

    <span class="hljs-comment">/**
     * åˆ›å»ºBeanå®ä¾‹
     */</span>
    <span class="hljs-keyword">private</span> Object <span class="hljs-title function_">createBean</span><span class="hljs-params">(BeanDefinition beanDefinition)</span> {
        <span class="hljs-keyword">try</span> {
            Class&lt;?&gt; clazz = beanDefinition.getBeanClass();
            <span class="hljs-type">Object</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> clazz.getDeclaredConstructor().newInstance();
            System.out.println(<span class="hljs-string">"åˆ›å»ºBeanå®ä¾‹: "</span> + beanDefinition.getBeanName());
            <span class="hljs-keyword">return</span> instance;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"åˆ›å»ºBeanå¤±è´¥: "</span> +
                beanDefinition.getBeanName(), e);
        }
    }

    <span class="hljs-comment">/**
     * é¦–å­—æ¯å°å†™
     */</span>
    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">toLowerFirstCase</span><span class="hljs-params">(String str)</span> {
        <span class="hljs-type">char</span>[] chars = str.toCharArray();
        chars[<span class="hljs-number">0</span>] += <span class="hljs-number">32</span>;
        <span class="hljs-keyword">return</span> String.valueOf(chars);
    }

    <span class="hljs-comment">/**
     * è·å–æ‰€æœ‰Beanåç§°
     */</span>
    <span class="hljs-keyword">public</span> Map&lt;String, BeanDefinition&gt; <span class="hljs-title function_">getBeanDefinitions</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> beanDefinitionMap;
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-18">6. ç¬¬å››æ­¥ï¼šå®ç°ä¾èµ–æ³¨å…¥</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/95a946239e474c49afa084fedc306c28~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768275935&amp;x-signature=DVcfiJ9%2B0hiocLdWCI52ymbIc6o%3D" alt="" loading="lazy"/></p>
<p>ä¾èµ–æ³¨å…¥æ˜¯IoCå®¹å™¨çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œé€šè¿‡åå°„è‡ªåŠ¨ä¸ºBeanæ³¨å…¥ä¾èµ–ã€‚</p>
<h4 data-id="heading-19">6.1 DependencyInjectorç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.myspring.core;

<span class="hljs-keyword">import</span> com.myspring.annotation.Autowired;
<span class="hljs-keyword">import</span> com.myspring.annotation.Qualifier;
<span class="hljs-keyword">import</span> java.lang.reflect.Field;

<span class="hljs-comment">/**
 * ä¾èµ–æ³¨å…¥å™¨ï¼šä¸ºBeanæ³¨å…¥ä¾èµ–
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DependencyInjector</span> {

    <span class="hljs-keyword">private</span> BeanFactory beanFactory;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">DependencyInjector</span><span class="hljs-params">(BeanFactory beanFactory)</span> {
        <span class="hljs-built_in">this</span>.beanFactory = beanFactory;
    }

    <span class="hljs-comment">/**
     * ä¸ºæ‰€æœ‰Beanæ‰§è¡Œä¾èµ–æ³¨å…¥
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">injectDependencies</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">for</span> (BeanDefinition bd : beanFactory.getBeanDefinitions().values()) {
            <span class="hljs-type">Object</span> <span class="hljs-variable">bean</span> <span class="hljs-operator">=</span> beanFactory.getBean(bd.getBeanName());
            injectBean(bean);
        }
    }

    <span class="hljs-comment">/**
     * ä¸ºå•ä¸ªBeanæ³¨å…¥ä¾èµ–
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">injectBean</span><span class="hljs-params">(Object bean)</span> {
        Class&lt;?&gt; clazz = bean.getClass();

        <span class="hljs-comment">// è·å–æ‰€æœ‰å­—æ®µ</span>
        Field[] fields = clazz.getDeclaredFields();

        <span class="hljs-keyword">for</span> (Field field : fields) {
            <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰@Autowiredæ³¨è§£</span>
            <span class="hljs-keyword">if</span> (!field.isAnnotationPresent(Autowired.class)) {
                <span class="hljs-keyword">continue</span>;
            }

            <span class="hljs-type">Autowired</span> <span class="hljs-variable">autowired</span> <span class="hljs-operator">=</span> field.getAnnotation(Autowired.class);

            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// ç¡®å®šè¦æ³¨å…¥çš„Bean</span>
                <span class="hljs-type">Object</span> <span class="hljs-variable">dependency</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;

                <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰@QualifieræŒ‡å®šBeanåç§°</span>
                <span class="hljs-keyword">if</span> (field.isAnnotationPresent(Qualifier.class)) {
                    <span class="hljs-type">Qualifier</span> <span class="hljs-variable">qualifier</span> <span class="hljs-operator">=</span> field.getAnnotation(Qualifier.class);
                    <span class="hljs-type">String</span> <span class="hljs-variable">beanName</span> <span class="hljs-operator">=</span> qualifier.value();
                    dependency = beanFactory.getBean(beanName);
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-comment">// æ ¹æ®ç±»å‹æŸ¥æ‰¾Bean</span>
                    dependency = beanFactory.getBean(field.getType());
                }

                <span class="hljs-comment">// åå°„è®¾ç½®å­—æ®µå€¼</span>
                field.setAccessible(<span class="hljs-literal">true</span>);
                field.set(bean, dependency);

                System.out.println(<span class="hljs-string">"æ³¨å…¥ä¾èµ–: "</span> + clazz.getSimpleName() +
                    <span class="hljs-string">"."</span> + field.getName());

            } <span class="hljs-keyword">catch</span> (Exception e) {
                <span class="hljs-keyword">if</span> (autowired.required()) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"ä¾èµ–æ³¨å…¥å¤±è´¥: "</span> +
                        clazz.getSimpleName() + <span class="hljs-string">"."</span> + field.getName(), e);
                }
            }
        }
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-20">7. ç¬¬äº”æ­¥ï¼šå®Œå–„ç”Ÿå‘½å‘¨æœŸ</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b1c98c1e6b1400dab18685675fd8503~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768275935&amp;x-signature=o%2BpKs8o%2Fd4yWCSXFgxEllUuttSg%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-21">7.1 ç”Ÿå‘½å‘¨æœŸæ³¨è§£</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.myspring.annotation;

<span class="hljs-keyword">import</span> java.lang.annotation.*;

<span class="hljs-comment">/**
 * Beanåˆå§‹åŒ–åè°ƒç”¨
 */</span>
<span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span>
<span class="hljs-meta">@Target(ElementType.METHOD)</span>
<span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> PostConstruct {
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.myspring.annotation;

<span class="hljs-keyword">import</span> java.lang.annotation.*;

<span class="hljs-comment">/**
 * Beané”€æ¯å‰è°ƒç”¨
 */</span>
<span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span>
<span class="hljs-meta">@Target(ElementType.METHOD)</span>
<span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> PreDestroy {
}
</code></pre>
<h4 data-id="heading-22">7.2 ç”Ÿå‘½å‘¨æœŸç®¡ç†å™¨</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.myspring.core;

<span class="hljs-keyword">import</span> com.myspring.annotation.PostConstruct;
<span class="hljs-keyword">import</span> com.myspring.annotation.PreDestroy;
<span class="hljs-keyword">import</span> java.lang.reflect.Method;

<span class="hljs-comment">/**
 * Beanç”Ÿå‘½å‘¨æœŸç®¡ç†å™¨
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LifecycleManager</span> {

    <span class="hljs-comment">/**
     * æ‰§è¡Œåˆå§‹åŒ–æ–¹æ³•
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">invokeInitMethod</span><span class="hljs-params">(Object bean)</span> {
        Class&lt;?&gt; clazz = bean.getClass();
        Method[] methods = clazz.getDeclaredMethods();

        <span class="hljs-keyword">for</span> (Method method : methods) {
            <span class="hljs-keyword">if</span> (method.isAnnotationPresent(PostConstruct.class)) {
                <span class="hljs-keyword">try</span> {
                    method.setAccessible(<span class="hljs-literal">true</span>);
                    method.invoke(bean);
                    System.out.println(<span class="hljs-string">"æ‰§è¡Œåˆå§‹åŒ–æ–¹æ³•: "</span> +
                        clazz.getSimpleName() + <span class="hljs-string">"."</span> + method.getName());
                } <span class="hljs-keyword">catch</span> (Exception e) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"åˆå§‹åŒ–æ–¹æ³•æ‰§è¡Œå¤±è´¥"</span>, e);
                }
            }
        }
    }

    <span class="hljs-comment">/**
     * æ‰§è¡Œé”€æ¯æ–¹æ³•
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">invokeDestroyMethod</span><span class="hljs-params">(Object bean)</span> {
        Class&lt;?&gt; clazz = bean.getClass();
        Method[] methods = clazz.getDeclaredMethods();

        <span class="hljs-keyword">for</span> (Method method : methods) {
            <span class="hljs-keyword">if</span> (method.isAnnotationPresent(PreDestroy.class)) {
                <span class="hljs-keyword">try</span> {
                    method.setAccessible(<span class="hljs-literal">true</span>);
                    method.invoke(bean);
                    System.out.println(<span class="hljs-string">"æ‰§è¡Œé”€æ¯æ–¹æ³•: "</span> +
                        clazz.getSimpleName() + <span class="hljs-string">"."</span> + method.getName());
                } <span class="hljs-keyword">catch</span> (Exception e) {
                    e.printStackTrace();
                }
            }
        }
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-23">8. å®Œæ•´ç¤ºä¾‹ï¼šä½¿ç”¨æ‰‹å†™IoC</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7225b7399aa845969344a1bd35e85acc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768275935&amp;x-signature=9f5E7fmFFl60d8nQ0ZgahrLKiw8%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-24">8.1 åˆ›å»ºApplicationContext</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.myspring.core;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * åº”ç”¨ä¸Šä¸‹æ–‡ï¼šæ•´åˆæ‰€æœ‰åŠŸèƒ½
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ApplicationContext</span> {

    <span class="hljs-keyword">private</span> BeanFactory beanFactory;
    <span class="hljs-keyword">private</span> DependencyInjector injector;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ApplicationContext</span><span class="hljs-params">(String basePackage)</span> {
        <span class="hljs-comment">// 1. åˆ›å»ºBeanå·¥å‚</span>
        beanFactory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BeanFactory</span>();

        <span class="hljs-comment">// 2. æ‰«æç»„ä»¶</span>
        System.out.println(<span class="hljs-string">"========== å¼€å§‹æ‰«æç»„ä»¶ =========="</span>);
        List&lt;Class&lt;?&gt;&gt; componentClasses = ClassScanner.scanComponents(basePackage);

        <span class="hljs-comment">// 3. æ³¨å†ŒBeanå®šä¹‰</span>
        System.out.println(<span class="hljs-string">"\n========== æ³¨å†ŒBeanå®šä¹‰ =========="</span>);
        <span class="hljs-keyword">for</span> (Class&lt;?&gt; clazz : componentClasses) {
            beanFactory.registerBeanDefinition(clazz);
        }

        <span class="hljs-comment">// 4. å®ä¾‹åŒ–æ‰€æœ‰å•ä¾‹Bean</span>
        System.out.println(<span class="hljs-string">"\n========== å®ä¾‹åŒ–å•ä¾‹Bean =========="</span>);
        <span class="hljs-keyword">for</span> (BeanDefinition bd : beanFactory.getBeanDefinitions().values()) {
            <span class="hljs-keyword">if</span> (<span class="hljs-string">"singleton"</span>.equals(bd.getScope())) {
                beanFactory.getBean(bd.getBeanName());
            }
        }

        <span class="hljs-comment">// 5. ä¾èµ–æ³¨å…¥</span>
        System.out.println(<span class="hljs-string">"\n========== æ‰§è¡Œä¾èµ–æ³¨å…¥ =========="</span>);
        injector = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DependencyInjector</span>(beanFactory);
        injector.injectDependencies();

        <span class="hljs-comment">// 6. æ‰§è¡Œåˆå§‹åŒ–æ–¹æ³•</span>
        System.out.println(<span class="hljs-string">"\n========== æ‰§è¡Œåˆå§‹åŒ–æ–¹æ³• =========="</span>);
        <span class="hljs-keyword">for</span> (BeanDefinition bd : beanFactory.getBeanDefinitions().values()) {
            <span class="hljs-type">Object</span> <span class="hljs-variable">bean</span> <span class="hljs-operator">=</span> beanFactory.getBean(bd.getBeanName());
            LifecycleManager.invokeInitMethod(bean);
        }

        System.out.println(<span class="hljs-string">"\n========== IoCå®¹å™¨å¯åŠ¨å®Œæˆ ==========\n"</span>);
    }

    <span class="hljs-comment">/**
     * è·å–Bean
     */</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getBean</span><span class="hljs-params">(String beanName)</span> {
        <span class="hljs-keyword">return</span> beanFactory.getBean(beanName);
    }

    <span class="hljs-comment">/**
     * æ ¹æ®ç±»å‹è·å–Bean
     */</span>
    <span class="hljs-keyword">public</span> &lt;T&gt; T <span class="hljs-title function_">getBean</span><span class="hljs-params">(Class&lt;T&gt; clazz)</span> {
        <span class="hljs-keyword">return</span> (T) beanFactory.getBean(clazz);
    }

    <span class="hljs-comment">/**
     * å…³é—­å®¹å™¨
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"\n========== å…³é—­IoCå®¹å™¨ =========="</span>);
        <span class="hljs-keyword">for</span> (BeanDefinition bd : beanFactory.getBeanDefinitions().values()) {
            <span class="hljs-type">Object</span> <span class="hljs-variable">bean</span> <span class="hljs-operator">=</span> beanFactory.getBean(bd.getBeanName());
            LifecycleManager.invokeDestroyMethod(bean);
        }
    }
}
</code></pre>
<h4 data-id="heading-25">8.2 ç¼–å†™æµ‹è¯•ç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.dao;

<span class="hljs-keyword">import</span> com.myspring.annotation.Component;

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserDao</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">save</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"UserDao: ä¿å­˜ç”¨æˆ·æ•°æ®"</span>);
    }
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.service;

<span class="hljs-keyword">import</span> com.example.dao.UserDao;
<span class="hljs-keyword">import</span> com.myspring.annotation.Autowired;
<span class="hljs-keyword">import</span> com.myspring.annotation.Component;
<span class="hljs-keyword">import</span> com.myspring.annotation.PostConstruct;
<span class="hljs-keyword">import</span> com.myspring.annotation.PreDestroy;

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> UserDao userDao;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">register</span><span class="hljs-params">(String username)</span> {
        System.out.println(<span class="hljs-string">"UserService: æ³¨å†Œç”¨æˆ· "</span> + username);
        userDao.save();
    }

    <span class="hljs-meta">@PostConstruct</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"UserServiceåˆå§‹åŒ–å®Œæˆ"</span>);
    }

    <span class="hljs-meta">@PreDestroy</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">destroy</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"UserServiceå‡†å¤‡é”€æ¯"</span>);
    }
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example;

<span class="hljs-keyword">import</span> com.example.service.UserService;
<span class="hljs-keyword">import</span> com.myspring.core.ApplicationContext;

<span class="hljs-comment">/**
 * æµ‹è¯•ç±»
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// åˆ›å»ºIoCå®¹å™¨</span>
        <span class="hljs-type">ApplicationContext</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApplicationContext</span>(<span class="hljs-string">"com.example"</span>);

        <span class="hljs-comment">// è·å–Beanå¹¶ä½¿ç”¨</span>
        <span class="hljs-type">UserService</span> <span class="hljs-variable">userService</span> <span class="hljs-operator">=</span> context.getBean(UserService.class);
        userService.register(<span class="hljs-string">"å¼ ä¸‰"</span>);

        <span class="hljs-comment">// å…³é—­å®¹å™¨</span>
        context.close();
    }
}
</code></pre>
<h4 data-id="heading-26">8.3 è¿è¡Œè¾“å‡º</h4>
<pre><code class="hljs language-makefile" lang="makefile">========== å¼€å§‹æ‰«æç»„ä»¶ ==========
<span class="hljs-section">æ‰«æåˆ°ç»„ä»¶: com.example.dao.UserDao</span>
<span class="hljs-section">æ‰«æåˆ°ç»„ä»¶: com.example.service.UserService</span>

========== æ³¨å†ŒBeanå®šä¹‰ ==========
<span class="hljs-section">æ³¨å†ŒBean: userDao, ä½œç”¨åŸŸ: singleton</span>
<span class="hljs-section">æ³¨å†ŒBean: userService, ä½œç”¨åŸŸ: singleton</span>

========== å®ä¾‹åŒ–å•ä¾‹Bean ==========
<span class="hljs-section">åˆ›å»ºBeanå®ä¾‹: userDao</span>
<span class="hljs-section">åˆ›å»ºBeanå®ä¾‹: userService</span>

========== æ‰§è¡Œä¾èµ–æ³¨å…¥ ==========
<span class="hljs-section">æ³¨å…¥ä¾èµ–: UserService.userDao</span>

========== æ‰§è¡Œåˆå§‹åŒ–æ–¹æ³• ==========
<span class="hljs-section">æ‰§è¡Œåˆå§‹åŒ–æ–¹æ³•: UserService.init</span>
UserServiceåˆå§‹åŒ–å®Œæˆ

========== IoCå®¹å™¨å¯åŠ¨å®Œæˆ ==========

<span class="hljs-section">UserService: æ³¨å†Œç”¨æˆ· å¼ ä¸‰</span>
<span class="hljs-section">UserDao: ä¿å­˜ç”¨æˆ·æ•°æ®</span>

========== å…³é—­IoCå®¹å™¨ ==========
<span class="hljs-section">æ‰§è¡Œé”€æ¯æ–¹æ³•: UserService.destroy</span>
UserServiceå‡†å¤‡é”€æ¯
</code></pre>
<hr/>
<h3 data-id="heading-27">9. æ€»ç»“</h3>
<h4 data-id="heading-28">9.1 æ ¸å¿ƒè¦ç‚¹</h4>
<p>é€šè¿‡æ‰‹å†™IoCå®¹å™¨ï¼Œæˆ‘ä»¬æ·±å…¥ç†è§£äº†ï¼š</p>
<ol>
<li><strong>æ³¨è§£æœºåˆ¶</strong> - ä½¿ç”¨<code>@Retention</code>ã€<code>@Target</code>å®šä¹‰æ³¨è§£</li>
<li><strong>åå°„æŠ€æœ¯</strong> - ç±»åŠ è½½ã€å®ä¾‹åˆ›å»ºã€å­—æ®µæ³¨å…¥</li>
<li><strong>æ‰«æè§£æ</strong> - é€’å½’æ‰«æåŒ…è·¯å¾„ï¼Œè§£ææ³¨è§£ä¿¡æ¯</li>
<li><strong>Beanç®¡ç†</strong> - å•ä¾‹/åŸå‹æ¨¡å¼ï¼ŒBeanå®šä¹‰å­˜å‚¨</li>
<li><strong>ä¾èµ–æ³¨å…¥</strong> - è‡ªåŠ¨æŸ¥æ‰¾å’Œæ³¨å…¥ä¾èµ–å¯¹è±¡</li>
<li><strong>ç”Ÿå‘½å‘¨æœŸ</strong> - åˆå§‹åŒ–å’Œé”€æ¯å›è°ƒæ–¹æ³•</li>
</ol>
<h4 data-id="heading-29">9.2 ä¸Spring IoCçš„å¯¹æ¯”</h4>








































<table><thead><tr><th>åŠŸèƒ½</th><th>æ‰‹å†™ç‰ˆæœ¬</th><th>Spring IoC</th></tr></thead><tbody><tr><td>æ³¨è§£æ‰«æ</td><td>ç®€å•é€’å½’</td><td>é«˜æ€§èƒ½ASMå­—èŠ‚ç æ‰«æ</td></tr><tr><td>Beanç®¡ç†</td><td>Mapå­˜å‚¨</td><td>å¤šçº§ç¼“å­˜+å¾ªç¯ä¾èµ–å¤„ç†</td></tr><tr><td>ä¾èµ–æ³¨å…¥</td><td>å­—æ®µæ³¨å…¥</td><td>å­—æ®µ+æ„é€ å™¨+Setter</td></tr><tr><td>ä½œç”¨åŸŸ</td><td>singleton/prototype</td><td>æ›´å¤šä½œç”¨åŸŸ</td></tr><tr><td>AOPæ”¯æŒ</td><td>æ— </td><td>å®Œæ•´AOPæ¡†æ¶</td></tr><tr><td>æ€§èƒ½ä¼˜åŒ–</td><td>åŸºç¡€</td><td>å¤§é‡ä¼˜åŒ–ç­–ç•¥</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3 defineModel å®Œå…¨æŒ‡å—ï¼šä»åŸºç¡€ä½¿ç”¨åˆ°è¿›é˜¶æŠ€å·§]]></title>    <link>https://juejin.cn/post/7591697558377938986</link>    <guid>https://juejin.cn/post/7591697558377938986</guid>    <pubDate>2026-01-06T02:42:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591697558377938986" data-draft-id="7591972586360717331" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3 defineModel å®Œå…¨æŒ‡å—ï¼šä»åŸºç¡€ä½¿ç”¨åˆ°è¿›é˜¶æŠ€å·§"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-06T02:42:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸æƒ³ç§ƒå¤´çš„ç¨‹åºå‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/2754702534251820"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3 defineModel å®Œå…¨æŒ‡å—ï¼šä»åŸºç¡€ä½¿ç”¨åˆ°è¿›é˜¶æŠ€å·§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2754702534251820/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸æƒ³ç§ƒå¤´çš„ç¨‹åºå‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T02:42:30.000Z" title="Tue Jan 06 2026 02:42:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Vue3 ç»„åˆå¼ API ä¸­ï¼Œç»„ä»¶é—´æ•°æ®ä¼ é€’æ˜¯æ ¸å¿ƒéœ€æ±‚ä¹‹ä¸€ã€‚å¯¹äºçˆ¶å­ç»„ä»¶çš„åŒå‘ç»‘å®šï¼ŒVue2 æ—¶ä»£æˆ‘ä»¬ä¹ æƒ¯ç”¨<code>v-model</code> é…åˆ <code>value</code> å±æ€§å’Œ <code>input</code> äº‹ä»¶ï¼Œè€Œ Vue3 æœ€åˆå¼•å…¥äº† <code>setup</code> å‡½æ•°åï¼Œéœ€è¦é€šè¿‡ <code>props</code> æ¥æ”¶å€¼å¹¶æ‰‹åŠ¨è§¦å‘äº‹ä»¶æ¥å®ç°åŒå‘ç»‘å®šã€‚ç›´åˆ° Vue3.4 ç‰ˆæœ¬ï¼Œå®˜æ–¹æ­£å¼æ¨å‡ºäº† <code>defineModel</code> å®ï¼Œå½»åº•ç®€åŒ–äº†çˆ¶å­ç»„ä»¶åŒå‘ç»‘å®šçš„å®ç°é€»è¾‘ã€‚</p>
<p>æœ¬æ–‡å°†ä» <code>defineModel</code> çš„æ ¸å¿ƒä½œç”¨å‡ºå‘ï¼Œé€æ­¥è®²è§£å…¶åŸºç¡€ä½¿ç”¨ã€è¿›é˜¶é…ç½®ã€å¸¸è§åœºæ™¯åŠæ³¨æ„äº‹é¡¹ï¼Œå¸®åŠ©ä½ å¿«é€ŸæŒæ¡è¿™ä¸€é«˜æ•ˆçš„ APIã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ defineModelï¼Ÿ</h2>
<p>åœ¨ <code>defineModel</code> å‡ºç°ä¹‹å‰ï¼Œå®ç°çˆ¶å­ç»„ä»¶åŒå‘ç»‘å®šéœ€è¦ä¸¤æ­¥æ“ä½œï¼š</p>
<ol>
<li>å­ç»„ä»¶é€šè¿‡ <code>props</code> æ¥æ”¶çˆ¶ç»„ä»¶ä¼ é€’çš„å€¼ï¼›</li>
<li>å­ç»„ä»¶é€šè¿‡ <code>emit</code> è§¦å‘äº‹ä»¶ï¼Œå°†ä¿®æ”¹åçš„å€¼ä¼ é€’å›çˆ¶ç»„ä»¶ã€‚</li>
</ol>
<p>ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;!-- å­ç»„ä»¶ <span class="hljs-title class_">Child</span>.<span class="hljs-property">vue</span> --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> props = <span class="hljs-title function_">defineProps</span>([<span class="hljs-string">'modelValue'</span>])
<span class="hljs-keyword">const</span> emit = <span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">'update:modelValue'</span>])

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleChange</span> = (<span class="hljs-params">e</span>) =&gt; {
  <span class="hljs-title function_">emit</span>(<span class="hljs-string">'update:modelValue'</span>, e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>)
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">:value</span>=<span class="hljs-string">"props.modelValue"</span> @<span class="hljs-attr">input</span>=<span class="hljs-string">"handleChange"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>
</code></pre>
<pre><code class="hljs language-js" lang="js">&lt;!-- çˆ¶ç»„ä»¶ <span class="hljs-title class_">Parent</span>.<span class="hljs-property">vue</span> --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Child</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./Child.vue'</span>

<span class="hljs-keyword">const</span> inputValue = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Child</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"inputValue"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>
</code></pre>
<p>è¿™ç§æ–¹å¼è™½ç„¶å¯è¡Œï¼Œä½†å­˜åœ¨æ˜æ˜¾å¼Šç«¯ï¼šä»£ç å†—ä½™ï¼Œæ¯æ¬¡å®ç°åŒå‘ç»‘å®šéƒ½éœ€è¦é‡å¤å®šä¹‰ <code>props</code> å’Œ <code>emit</code>ã€‚è€Œ <code>defineModel</code> æ­£æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®ƒå°† <code>props</code> å’Œ <code>emit</code> çš„é€»è¾‘å°è£…åœ¨ä¸€èµ·ï¼Œè®©åŒå‘ç»‘å®šçš„å®ç°æ›´ç®€æ´ã€æ›´ç›´è§‚ã€‚</p>
<h2 data-id="heading-1">äºŒã€defineModel åŸºç¡€ä½¿ç”¨</h2>
<h3 data-id="heading-2">2.1 åŸºæœ¬è¯­æ³•</h3>
<p><code>defineModel</code> æ˜¯ Vue3.4+ æä¾›çš„å†…ç½®å®ï¼Œæ— éœ€å¯¼å…¥å³å¯ç›´æ¥ä½¿ç”¨ã€‚å…¶åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> model = <span class="hljs-title function_">defineModel</span>();
</code></pre>
<p>é€šè¿‡ä¸Šè¿°ä»£ç ï¼Œå­ç»„ä»¶å³å¯ç›´æ¥è·å–åˆ°çˆ¶ç»„ä»¶é€šè¿‡ <code>v-model</code> ä¼ é€’çš„å€¼ï¼Œä¸” <code>model</code> æ˜¯ä¸€ä¸ªå“åº”å¼å¯¹è±¡ï¼Œä¿®æ”¹å®ƒä¼šè‡ªåŠ¨åŒæ­¥åˆ°çˆ¶ç»„ä»¶ã€‚</p>
<h3 data-id="heading-3">2.2 ç®€åŒ–åŒå‘ç»‘å®šç¤ºä¾‹</h3>
<p>ç”¨ <code>defineModel</code> é‡å†™ä¸Šé¢çš„çˆ¶å­ç»„ä»¶åŒå‘ç»‘å®šç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;!-- å­ç»„ä»¶ <span class="hljs-title class_">Child</span>.<span class="hljs-property">vue</span> --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// ç›´æ¥ä½¿ç”¨ defineModel è·å–å“åº”å¼æ¨¡å‹</span>
<span class="hljs-keyword">const</span> modelValue = <span class="hljs-title function_">defineModel</span>()
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- ç›´æ¥ç»‘å®š modelValueï¼Œä¿®æ”¹æ—¶è‡ªåŠ¨åŒæ­¥åˆ°çˆ¶ç»„ä»¶ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"modelValue"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>
</code></pre>
<pre><code class="hljs language-js" lang="js">&lt;!-- çˆ¶ç»„ä»¶ <span class="hljs-title class_">Parent</span>.<span class="hljs-property">vue</span> --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Child</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./Child.vue'</span>

<span class="hljs-keyword">const</span> inputValue = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Child</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"inputValue"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>çˆ¶ç»„ä»¶å€¼ï¼š{{ inputValue }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå­ç»„ä»¶çš„ä»£ç è¢«å¤§å¹…ç®€åŒ–ï¼Œæ— éœ€å†æ‰‹åŠ¨å®šä¹‰ <code>props</code> å’Œ <code>emit</code>ï¼Œç›´æ¥é€šè¿‡ <code>defineModel</code> å³å¯å®ç°åŒå‘ç»‘å®šã€‚</p>
<h3 data-id="heading-4">2.3 è‡ªå®šä¹‰ v-model åç§°</h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>defineModel</code> å¯¹åº”çˆ¶ç»„ä»¶ <code>v-model</code> çš„ <code>modelValue</code> å±æ€§å’Œ <code>update:modelValue</code> äº‹ä»¶ã€‚å¦‚æœéœ€è¦è‡ªå®šä¹‰ <code>v-model</code> çš„åç§°ï¼ˆå³å¤š <code>v-model</code> åœºæ™¯ï¼‰ï¼Œå¯ä»¥ç»™ <code>defineModel</code> ä¼ é€’ä¸€ä¸ªå‚æ•°ä½œä¸ºåç§°ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;!-- å­ç»„ä»¶ <span class="hljs-title class_">Child</span>.<span class="hljs-property">vue</span> --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// è‡ªå®šä¹‰ v-model åç§°ä¸º "username"</span>
<span class="hljs-keyword">const</span> username = <span class="hljs-title function_">defineModel</span>(<span class="hljs-string">'username'</span>)
<span class="hljs-comment">// å†å®šä¹‰ä¸€ä¸ª v-model åç§°ä¸º "password"</span>
<span class="hljs-keyword">const</span> password = <span class="hljs-title function_">defineModel</span>(<span class="hljs-string">'password'</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"username"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥ç”¨æˆ·å"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"password"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥å¯†ç "</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>
</code></pre>
<pre><code class="hljs language-js" lang="js">&lt;!-- çˆ¶ç»„ä»¶ <span class="hljs-title class_">Parent</span>.<span class="hljs-property">vue</span> --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Child</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./Child.vue'</span>

<span class="hljs-keyword">const</span> user = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)
<span class="hljs-keyword">const</span> pwd = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Child</span> 
    <span class="hljs-attr">v-model:username</span>=<span class="hljs-string">"user"</span> 
    <span class="hljs-attr">v-model:password</span>=<span class="hljs-string">"pwd"</span> 
  /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ç”¨æˆ·åï¼š{{ user }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å¯†ç ï¼š{{ pwd }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>
</code></pre>
<p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å®ç°ä¸€ä¸ªç»„ä»¶æ”¯æŒå¤šä¸ª <code>v-model</code> ç»‘å®šï¼Œæ»¡è¶³å¤æ‚åœºæ™¯çš„éœ€æ±‚ã€‚</p>
<h2 data-id="heading-5">ä¸‰ã€defineModel è¿›é˜¶é…ç½®</h2>
<p><code>defineModel</code> è¿˜æ”¯æŒä¼ å…¥ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œç”¨äºè®¾ç½®é»˜è®¤å€¼ã€ç±»å‹æ ¡éªŒã€æ˜¯å¦å¯å†™ç­‰å±æ€§ï¼Œè¿›ä¸€æ­¥å¢å¼ºç»„ä»¶çš„å¥å£®æ€§ã€‚</p>
<h3 data-id="heading-6">3.1 è®¾ç½®é»˜è®¤å€¼</h3>
<p>é€šè¿‡é…ç½®å¯¹è±¡çš„ <code>default</code> å±æ€§å¯ä»¥è®¾ç½® <code>v-model</code> çš„é»˜è®¤å€¼ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;!-- å­ç»„ä»¶ <span class="hljs-title class_">Child</span>.<span class="hljs-property">vue</span> --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// è®¾ç½®é»˜è®¤å€¼ä¸º "é»˜è®¤ç”¨æˆ·å"</span>
<span class="hljs-keyword">const</span> username = <span class="hljs-title function_">defineModel</span>(<span class="hljs-string">'username'</span>, {
  <span class="hljs-attr">default</span>: <span class="hljs-string">'é»˜è®¤ç”¨æˆ·å'</span>
})
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"username"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥ç”¨æˆ·å"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>
</code></pre>
<p>æ­¤æ—¶ï¼Œè‹¥çˆ¶ç»„ä»¶æœªç»™ <code>v-model:username</code> ä¼ é€’å€¼ï¼Œå­ç»„ä»¶çš„ <code>username</code> ä¼šé»˜è®¤ä½¿ç”¨ "é»˜è®¤ç”¨æˆ·å"ã€‚</p>
<h3 data-id="heading-7">3.2 ç±»å‹æ ¡éªŒ</h3>
<p>é€šè¿‡ <code>type</code> å±æ€§å¯ä»¥å¯¹ <code>v-model</code>ä¼ é€’çš„å€¼è¿›è¡Œç±»å‹æ ¡éªŒï¼Œæ”¯æŒå•ä¸ªç±»å‹æˆ–å¤šä¸ªç±»å‹æ•°ç»„ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;!-- å­ç»„ä»¶ <span class="hljs-title class_">Child</span>.<span class="hljs-property">vue</span> --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// é™åˆ¶ username å¿…é¡»ä¸ºå­—ç¬¦ä¸²ç±»å‹</span>
<span class="hljs-keyword">const</span> username = <span class="hljs-title function_">defineModel</span>(<span class="hljs-string">'username'</span>, {
  <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
  <span class="hljs-attr">default</span>: <span class="hljs-string">''</span>
})

<span class="hljs-comment">// é™åˆ¶ count å¯ä»¥ä¸º Number æˆ– String ç±»å‹</span>
<span class="hljs-keyword">const</span> count = <span class="hljs-title function_">defineModel</span>(<span class="hljs-string">'count'</span>, {
  <span class="hljs-attr">type</span>: [<span class="hljs-title class_">Number</span>, <span class="hljs-title class_">String</span>],
  <span class="hljs-attr">default</span>: <span class="hljs-number">0</span>
})
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"username"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥ç”¨æˆ·å"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"count++"</span>&gt;</span>è®¡æ•°ï¼š{{ count }}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>
</code></pre>
<p>è‹¥çˆ¶ç»„ä»¶ä¼ é€’çš„å€¼ç±»å‹ä¸åŒ¹é…ï¼ŒVue ä¼šåœ¨æ§åˆ¶å°ç»™å‡ºè­¦å‘Šï¼Œå¸®åŠ©æˆ‘ä»¬æå‰å‘ç°é—®é¢˜ã€‚</p>
<h3 data-id="heading-8">3.3 æ§åˆ¶æ˜¯å¦å¯å†™</h3>
<p>é€šè¿‡ <code>settable</code> å±æ€§å¯ä»¥æ§åˆ¶å­ç»„ä»¶æ˜¯å¦èƒ½ç›´æ¥ä¿®æ”¹ <code>defineModel</code> è¿”å›çš„å“åº”å¼å¯¹è±¡ã€‚é»˜è®¤æƒ…å†µä¸‹ <code>settable: true</code>ï¼Œå­ç»„ä»¶å¯ä»¥ç›´æ¥ä¿®æ”¹ï¼›è‹¥è®¾ç½®ä¸º <code>false</code>ï¼Œå­ç»„ä»¶ä¿®æ”¹æ—¶ä¼šæŠ¥é”™ï¼Œåªèƒ½é€šè¿‡çˆ¶ç»„ä»¶ä¿®æ”¹ååŒæ­¥è¿‡æ¥ã€‚</p>
<pre><code class="hljs language-js" lang="js">&lt;!-- å­ç»„ä»¶ <span class="hljs-title class_">Child</span>.<span class="hljs-property">vue</span> --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// è®¾ç½® settable: falseï¼Œå­ç»„ä»¶ä¸èƒ½ç›´æ¥ä¿®æ”¹</span>
<span class="hljs-keyword">const</span> username = <span class="hljs-title function_">defineModel</span>(<span class="hljs-string">'username'</span>, {
  <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
  <span class="hljs-attr">default</span>: <span class="hljs-string">''</span>,
  <span class="hljs-attr">settable</span>: <span class="hljs-literal">false</span>
})

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleChange</span> = (<span class="hljs-params">e</span>) =&gt; {
  <span class="hljs-comment">// æŠ¥é”™ï¼šCannot assign to 'username' because it's a read-only proxy</span>
  username.<span class="hljs-property">value</span> = e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">:value</span>=<span class="hljs-string">"username"</span> @<span class="hljs-attr">input</span>=<span class="hljs-string">"handleChange"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>
</code></pre>
<p>è¿™ç§é…ç½®é€‚åˆéœ€è¦ä¸¥æ ¼æ§åˆ¶æ•°æ®æµå‘çš„åœºæ™¯ï¼Œç¡®ä¿æ•°æ®åªèƒ½ç”±çˆ¶ç»„ä»¶ä¿®æ”¹ã€‚</p>
<h3 data-id="heading-9">3.4 è½¬æ¢å€¼ï¼ˆgetter/setterï¼‰</h3>
<p>é€šè¿‡ <code>get</code> å’Œ <code>set</code> æ–¹æ³•å¯ä»¥å¯¹ä¼ é€’çš„å€¼è¿›è¡Œè½¬æ¢å¤„ç†ï¼Œç±»ä¼¼è®¡ç®—å±æ€§çš„é€»è¾‘ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªè‡ªåŠ¨å»é™¤ç©ºæ ¼çš„è¾“å…¥æ¡†ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;!-- å­ç»„ä»¶ <span class="hljs-title class_">Child</span>.<span class="hljs-property">vue</span> --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> username = <span class="hljs-title function_">defineModel</span>(<span class="hljs-string">'username'</span>, {
  <span class="hljs-attr">get</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
    <span class="hljs-comment">// çˆ¶ç»„ä»¶ä¼ é€’çš„å€¼åˆ°å­ç»„ä»¶æ—¶ï¼Œè‡ªåŠ¨å»é™¤å‰åç©ºæ ¼</span>
    <span class="hljs-keyword">return</span> value?.<span class="hljs-title function_">trim</span>() || <span class="hljs-string">''</span>
  },
  <span class="hljs-attr">set</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
    <span class="hljs-comment">// å­ç»„ä»¶ä¿®æ”¹åçš„å€¼ä¼ é€’ç»™çˆ¶ç»„ä»¶æ—¶ï¼Œå†æ¬¡å»é™¤ç©ºæ ¼</span>
    <span class="hljs-keyword">return</span> value.<span class="hljs-title function_">trim</span>()
  },
  <span class="hljs-attr">default</span>: <span class="hljs-string">''</span>
})
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"username"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥ç”¨æˆ·å"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>
</code></pre>
<p>é€šè¿‡ <code>get</code> å’Œ <code>set</code>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ•°æ®ä¼ é€’çš„è¿‡ç¨‹ä¸­å¯¹å…¶è¿›è¡ŒåŠ å·¥ï¼Œè®©ç»„ä»¶çš„é€»è¾‘æ›´çµæ´»ã€‚</p>
<h2 data-id="heading-10">å››ã€å¸¸è§ä½¿ç”¨åœºæ™¯</h2>
<h3 data-id="heading-11">4.1 è¡¨å•ç»„ä»¶å°è£…</h3>
<p>å°è£…è¡¨å•ç»„ä»¶æ˜¯ <code>defineModel</code> æœ€å¸¸ç”¨çš„åœºæ™¯ä¹‹ä¸€ã€‚ä¾‹å¦‚ï¼Œå°è£…ä¸€ä¸ªè‡ªå®šä¹‰è¾“å…¥æ¡†ç»„ä»¶ï¼Œæ”¯æŒåŒå‘ç»‘å®šã€ç±»å‹æ ¡éªŒã€é»˜è®¤å€¼ç­‰åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;!-- è‡ªå®šä¹‰è¾“å…¥æ¡†ç»„ä»¶ <span class="hljs-title class_">CustomInput</span>.<span class="hljs-property">vue</span> --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> props = <span class="hljs-title function_">defineProps</span>({
  <span class="hljs-attr">label</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,
    <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>
  }
})

<span class="hljs-keyword">const</span> modelValue = <span class="hljs-title function_">defineModel</span>({
  <span class="hljs-attr">type</span>: [<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Number</span>],
  <span class="hljs-attr">default</span>: <span class="hljs-string">''</span>,
  <span class="hljs-attr">get</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =&gt;</span> val || <span class="hljs-string">''</span>,
  <span class="hljs-attr">set</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =&gt;</span> val.<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">trim</span>()
})
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"custom-input"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>{{ label }}ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"modelValue"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>
</code></pre>
<pre><code class="hljs language-js" lang="js">&lt;!-- çˆ¶ç»„ä»¶ä½¿ç”¨ --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">CustomInput</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./CustomInput.vue'</span>

<span class="hljs-keyword">const</span> name = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)
<span class="hljs-keyword">const</span> age = <span class="hljs-title function_">ref</span>(<span class="hljs-number">18</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">CustomInput</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"å§“å"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"name"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">CustomInput</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"å¹´é¾„"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"age"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å§“åï¼š{{ name }}ï¼Œå¹´é¾„ï¼š{{ age }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>
</code></pre>
<h3 data-id="heading-12">4.2 å¼€å…³ã€æ»‘å—ç­‰UIç»„ä»¶</h3>
<p>å¯¹äºå¼€å…³ï¼ˆSwitchï¼‰ã€æ»‘å—ï¼ˆSliderï¼‰ç­‰éœ€è¦åŒå‘ç»‘å®šçŠ¶æ€çš„UIç»„ä»¶ï¼Œ<code>defineModel</code> ä¹Ÿèƒ½æå¤§ç®€åŒ–ä»£ç ã€‚ä»¥å¼€å…³ç»„ä»¶ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;!-- å¼€å…³ç»„ä»¶ <span class="hljs-title class_">Switch</span>.<span class="hljs-property">vue</span> --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> modelValue = <span class="hljs-title function_">defineModel</span>({
  <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,
  <span class="hljs-attr">default</span>: <span class="hljs-literal">false</span>
})

<span class="hljs-keyword">const</span> <span class="hljs-title function_">toggle</span> = (<span class="hljs-params"/>) =&gt; {
  modelValue.<span class="hljs-property">value</span> = !modelValue.<span class="hljs-property">value</span>
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> 
    <span class="hljs-attr">class</span>=<span class="hljs-string">"switch"</span> 
    <span class="hljs-attr">:class</span>=<span class="hljs-string">"{ active: modelValue }"</span> 
    @<span class="hljs-attr">click</span>=<span class="hljs-string">"toggle"</span>
  &gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"switch-button"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.switch</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">60px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">30px</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">15px</span>;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ccc</span>;
  <span class="hljs-attribute">position</span>: relative;
  <span class="hljs-attribute">cursor</span>: pointer;
}
<span class="hljs-selector-class">.switch</span><span class="hljs-selector-class">.active</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#42b983</span>;
}
<span class="hljs-selector-class">.switch-button</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">26px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">26px</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">top</span>: <span class="hljs-number">2px</span>;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">2px</span>;
  <span class="hljs-attribute">transition</span>: left <span class="hljs-number">0.3s</span>;
}
<span class="hljs-selector-class">.switch</span><span class="hljs-selector-class">.active</span> <span class="hljs-selector-class">.switch-button</span> {
  <span class="hljs-attribute">left</span>: <span class="hljs-number">32px</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>
</code></pre>
<pre><code class="hljs language-js" lang="js">&lt;!-- çˆ¶ç»„ä»¶ä½¿ç”¨ --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Switch</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./Switch.vue'</span>

<span class="hljs-keyword">const</span> isOpen = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Switch</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"isOpen"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å¼€å…³çŠ¶æ€ï¼š{{ isOpen ? 'å¼€å¯' : 'å…³é—­' }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>
</code></pre>
<h2 data-id="heading-13">äº”ã€æ³¨æ„äº‹é¡¹</h2>
<ol>
<li><strong>Vue ç‰ˆæœ¬è¦æ±‚</strong>ï¼š<code>defineModel</code> æ˜¯ Vue3.4 åŠä»¥ä¸Šç‰ˆæœ¬æ‰æ”¯æŒçš„ç‰¹æ€§ï¼Œè‹¥é¡¹ç›®ç‰ˆæœ¬è¾ƒä½ï¼Œéœ€è¦å…ˆå‡çº§ Vue ç‰ˆæœ¬ï¼ˆå‡çº§å‘½ä»¤ï¼š<code>npm update vue</code>ï¼‰ã€‚</li>
<li><strong>å“åº”å¼ç‰¹æ€§</strong>ï¼š<code>defineModel</code> è¿”å›çš„æ˜¯ä¸€ä¸ªå“åº”å¼å¯¹è±¡ï¼Œä¿®æ”¹å…¶ <code>value</code> å±æ€§ä¼šè‡ªåŠ¨åŒæ­¥åˆ°çˆ¶ç»„ä»¶ï¼Œæ— éœ€æ‰‹åŠ¨è§¦å‘ <code>emit</code> äº‹ä»¶ã€‚</li>
<li><strong>ä¸ defineProps çš„å…³ç³»</strong>ï¼š<code>defineModel</code> æœ¬è´¨ä¸Šæ˜¯å¯¹ <code>props</code> å’Œ <code>emit</code> çš„å°è£…ï¼Œå› æ­¤ä¸èƒ½ä¸ <code>defineProps</code> å®šä¹‰åŒåçš„å±æ€§ï¼Œå¦åˆ™ä¼šå‡ºç°å†²çªã€‚</li>
<li><strong>é»˜è®¤å€¼çš„ç‰¹æ®Šæ€§</strong>ï¼šå½“ <code>defineModel</code> è®¾ç½®äº† <code>default</code> å€¼æ—¶ï¼Œè‹¥çˆ¶ç»„ä»¶ä¼ é€’äº† <code>undefined</code>ï¼Œå­ç»„ä»¶ä¼šä½¿ç”¨é»˜è®¤å€¼ï¼›è‹¥çˆ¶ç»„ä»¶ä¼ é€’äº† <code>null</code>ï¼Œåˆ™ä¼šä½¿ç”¨ <code>null</code> è€Œä¸æ˜¯é»˜è®¤å€¼ã€‚</li>
<li><strong>æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰å…¼å®¹æ€§</strong>ï¼šåœ¨ SSR åœºæ™¯ä¸‹ï¼Œ<code>defineModel</code> å®Œå…¨å…¼å®¹ï¼Œæ— éœ€é¢å¤–å¤„ç†ï¼Œå› ä¸ºå…¶åº•å±‚è¿˜æ˜¯åŸºäº <code>props</code> å’Œ <code>emit</code> å®ç°çš„ã€‚</li>
</ol>
<h2 data-id="heading-14">å…­ã€æ€»ç»“</h2>
<p><code>defineModel</code> ä½œä¸º Vue3.4+ æ¨å‡ºçš„é‡è¦ç‰¹æ€§ï¼Œæå¤§åœ°ç®€åŒ–äº†çˆ¶å­ç»„ä»¶åŒå‘ç»‘å®šçš„å®ç°é€»è¾‘ï¼Œå‡å°‘äº†é‡å¤ä»£ç ï¼Œæå‡äº†å¼€å‘æ•ˆç‡ã€‚å®ƒæ”¯æŒè‡ªå®šä¹‰åç§°ã€é»˜è®¤å€¼ã€ç±»å‹æ ¡éªŒã€å€¼è½¬æ¢ç­‰å¤šç§è¿›é˜¶åŠŸèƒ½ï¼Œèƒ½å¤Ÿæ»¡è¶³å¤§éƒ¨åˆ†åŒå‘ç»‘å®šåœºæ™¯çš„éœ€æ±‚ã€‚</p>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œå¯¹äºéœ€è¦åŒå‘ç»‘å®šçš„ç»„ä»¶ï¼ˆå¦‚è¡¨å•ç»„ä»¶ã€UIäº¤äº’ç»„ä»¶ç­‰ï¼‰ï¼Œæ¨èä¼˜å…ˆä½¿ç”¨ <code>defineModel</code> æ›¿ä»£ä¼ ç»Ÿçš„ <code>props + emit</code> æ–¹å¼ã€‚åŒæ—¶ï¼Œè¦æ³¨æ„å…¶ç‰ˆæœ¬è¦æ±‚å’Œä½¿ç”¨è§„èŒƒï¼Œé¿å…å‡ºç°å…¼å®¹æ€§é—®é¢˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring Boot æ‰“åŒ…éƒ¨ç½²ï¼ŒJAR vs WAR]]></title>    <link>https://juejin.cn/post/7591778827308400680</link>    <guid>https://juejin.cn/post/7591778827308400680</guid>    <pubDate>2026-01-06T03:45:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591778827308400680" data-draft-id="7591744411740340224" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring Boot æ‰“åŒ…éƒ¨ç½²ï¼ŒJAR vs WAR"/> <meta itemprop="keywords" content="åç«¯,Java,Spring Boot"/> <meta itemprop="datePublished" content="2026-01-06T03:45:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‚Ÿç©ºç å­—"/> <meta itemprop="url" content="https://juejin.cn/user/3139860942296830"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring Boot æ‰“åŒ…éƒ¨ç½²ï¼ŒJAR vs WAR
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3139860942296830/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‚Ÿç©ºç å­—
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T03:45:45.000Z" title="Tue Jan 06 2026 03:45:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å°æ‚Ÿã€‚</p>
<h2 data-id="heading-0">ä¸€ã€JAR å’Œ WAR æ‰“åŒ…çš„åŒºåˆ«</h2>
<h3 data-id="heading-1">JAR (Java ARchive)</h3>
<ul>
<li><strong>ç‹¬ç«‹è¿è¡Œ</strong>ï¼šå†…åµŒTomcat/JettyæœåŠ¡å™¨ï¼Œå¯ç›´æ¥é€šè¿‡ <code>java -jar</code> è¿è¡Œ</li>
<li><strong>å¾®æœåŠ¡å‹å¥½</strong>ï¼šé€‚åˆäº‘åŸç”Ÿã€å®¹å™¨åŒ–éƒ¨ç½²</li>
<li><strong>ç®€åŒ–éƒ¨ç½²</strong>ï¼šå•ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ— éœ€å¤–éƒ¨WebæœåŠ¡å™¨</li>
<li><strong>é»˜è®¤æ–¹å¼</strong>ï¼šSpring Boot é»˜è®¤æ‰“åŒ…ä¸ºå¯æ‰§è¡ŒJAR</li>
</ul>
<h3 data-id="heading-2">WAR (Web Application ARchive)</h3>
<ul>
<li><strong>ä¼ ç»Ÿéƒ¨ç½²</strong>ï¼šéœ€è¦å¤–éƒ¨Servletå®¹å™¨ï¼ˆå¦‚Tomcatã€WebLogicï¼‰</li>
<li><strong>ä¼ä¸šç¯å¢ƒ</strong>ï¼šé€‚åˆéœ€è¦éƒ¨ç½²åˆ°ç°æœ‰åº”ç”¨æœåŠ¡å™¨çš„åœºæ™¯</li>
<li><strong>å…±äº«èµ„æº</strong>ï¼šå¤šä¸ªåº”ç”¨å¯å…±äº«æœåŠ¡å™¨èµ„æº</li>
<li><strong>é…ç½®åˆ†ç¦»</strong>ï¼šæœåŠ¡å™¨é…ç½®ä¸åº”ç”¨åˆ†ç¦»</li>
</ul>
<h2 data-id="heading-3">äºŒã€è¯¦ç»†æ‰“åŒ…éƒ¨ç½²æ­¥éª¤</h2>
<h3 data-id="heading-4">é¡¹ç›®ç»“æ„</h3>
<pre><code class="hljs language-css" lang="css">my-springboot-app/
â”œâ”€â”€ <span class="hljs-attribute">src</span>/
â”‚   â””â”€â”€ <span class="hljs-selector-tag">main</span>/
â”‚       â”œâ”€â”€ java/com/example/
â”‚       â””â”€â”€ resources/
â””â”€â”€ pom<span class="hljs-selector-class">.xml</span> æˆ– build<span class="hljs-selector-class">.gradle</span>
</code></pre>
<h3 data-id="heading-5">1. æ‰“åŒ…ä¸ºå¯æ‰§è¡ŒJARï¼ˆé»˜è®¤æ–¹å¼ï¼‰</h3>
<h4 data-id="heading-6">Maven é…ç½® (pom.xml)</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.example<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>my-springboot-app<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">packaging</span>&gt;</span>jar<span class="hljs-tag">&lt;/<span class="hljs-name">packaging</span>&gt;</span>  <span class="hljs-comment">&lt;!-- æ‰“åŒ…ä¸ºJAR --&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.1.5<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- Spring Boot Maven æ’ä»¶ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">mainClass</span>&gt;</span>com.example.MyApplication<span class="hljs-tag">&lt;/<span class="hljs-name">mainClass</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">executions</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">execution</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">goals</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">goal</span>&gt;</span>repackage<span class="hljs-tag">&lt;/<span class="hljs-name">goal</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">goals</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">execution</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">executions</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span>
</code></pre>
<h4 data-id="heading-7">Gradle é…ç½® (build.gradle)</h4>
<pre><code class="hljs language-ini" lang="ini">plugins {
    id 'org.springframework.boot' version '3.1.5'
    id 'io.spring.dependency-management' version '1.1.3'
    id 'java'
}

<span class="hljs-attr">group</span> = <span class="hljs-string">'com.example'</span>
<span class="hljs-attr">version</span> = <span class="hljs-string">'1.0.0'</span>
<span class="hljs-attr">sourceCompatibility</span> = <span class="hljs-string">'17'</span>

jar {
    <span class="hljs-attr">enabled</span> = <span class="hljs-literal">true</span>
    <span class="hljs-attr">archiveClassifier</span> = <span class="hljs-string">''</span>  // ç§»é™¤plainåç¼€
}

dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-web'
}

// å¯æ‰§è¡ŒJARé…ç½®
bootJar {
    <span class="hljs-attr">mainClass</span> = <span class="hljs-string">'com.example.MyApplication'</span>
    <span class="hljs-attr">archiveClassifier</span> = <span class="hljs-string">''</span>
}
</code></pre>
<h4 data-id="heading-8">ä¸»å¯åŠ¨ç±»</h4>
<pre><code class="hljs language-typescript" lang="typescript">package com.<span class="hljs-property">example</span>;

<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">boot</span>.<span class="hljs-property">SpringApplication</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">boot</span>.<span class="hljs-property">autoconfigure</span>.<span class="hljs-property">SpringBootApplication</span>;

<span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApplication</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>[] args</span>) {
        <span class="hljs-title class_">SpringApplication</span>.<span class="hljs-title function_">run</span>(<span class="hljs-title class_">MyApplication</span>.<span class="hljs-property">class</span>, args);
    }
}
</code></pre>
<h4 data-id="heading-9">æ‰“åŒ…å‘½ä»¤</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Maven</span>
mvn clean package

<span class="hljs-comment"># Gradle</span>
./gradlew clean build
</code></pre>
<h4 data-id="heading-10">è¿è¡ŒJAR</h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç›´æ¥è¿è¡Œ</span>
java -jar target/my-springboot-app-1.0.0.jar

<span class="hljs-comment"># æŒ‡å®šé…ç½®æ–‡ä»¶</span>
java -jar target/my-springboot-app-1.0.0.jar \
  <span class="hljs-attr">--spring.config.location</span>=classpath:/,file:./config/

<span class="hljs-comment"># æŒ‡å®šç«¯å£</span>
java -jar target/my-springboot-app-1.0.0.jar \
  <span class="hljs-attr">--server.port</span>=<span class="hljs-number">8081</span>

<span class="hljs-comment"># ç”Ÿäº§ç¯å¢ƒè¿è¡Œï¼ˆå†…å­˜ä¼˜åŒ–ï¼‰</span>
java -Xms512m -Xmx1024m -jar target/my-springboot-app-1.0.0.jar \
  <span class="hljs-attr">--spring.profiles.active</span>=prod
</code></pre>
<h3 data-id="heading-11">2. æ‰“åŒ…ä¸ºWARï¼ˆç”¨äºå¤–éƒ¨å®¹å™¨ï¼‰</h3>
<h4 data-id="heading-12">ä¿®æ”¹Mavené…ç½®</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.example<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>my-springboot-app<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">packaging</span>&gt;</span>war<span class="hljs-tag">&lt;/<span class="hljs-name">packaging</span>&gt;</span>  <span class="hljs-comment">&lt;!-- ä¿®æ”¹ä¸ºWAR --&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.1.5<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- æ’é™¤å†…åµŒTomcat --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        
        <span class="hljs-comment">&lt;!-- æ·»åŠ Servlet APIä¾èµ–ï¼ˆprovided scopeï¼‰ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>provided<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>  <span class="hljs-comment">&lt;!-- ç”±å¤–éƒ¨å®¹å™¨æä¾› --&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">finalName</span>&gt;</span>myapp<span class="hljs-tag">&lt;/<span class="hljs-name">finalName</span>&gt;</span>  <span class="hljs-comment">&lt;!-- WARæ–‡ä»¶åç§° --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span>
</code></pre>
<h4 data-id="heading-13">ä¿®æ”¹å¯åŠ¨ç±»</h4>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-keyword">package</span> com.example;

<span class="hljs-keyword">import</span> org.springframework.boot.<span class="hljs-type">SpringApplication</span>;
<span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.<span class="hljs-type">SpringBootApplication</span>;
<span class="hljs-keyword">import</span> org.springframework.boot.builder.<span class="hljs-type">SpringApplicationBuilder</span>;
<span class="hljs-keyword">import</span> org.springframework.boot.web.servlet.support.<span class="hljs-type">SpringBootServletInitializer</span>;

<span class="hljs-meta">@SpringBootApplication</span>
public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyApplication</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SpringBootServletInitializer</span> </span>{
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-type">SpringApplicationBuilder</span> configure(<span class="hljs-type">SpringApplicationBuilder</span> builder) {
        <span class="hljs-keyword">return</span> builder.sources(<span class="hljs-type">MyApplication</span>.<span class="hljs-keyword">class</span>);
    }
    
    public static void main(<span class="hljs-type">String</span>[] args) {
        <span class="hljs-type">SpringApplication</span>.run(<span class="hljs-type">MyApplication</span>.<span class="hljs-keyword">class</span>, args);
    }
}
</code></pre>
<h4 data-id="heading-14">Gradle WARé…ç½®</h4>
<pre><code class="hljs language-bash" lang="bash">plugins {
    <span class="hljs-built_in">id</span> <span class="hljs-string">'org.springframework.boot'</span> version <span class="hljs-string">'3.1.5'</span>
    <span class="hljs-built_in">id</span> <span class="hljs-string">'io.spring.dependency-management'</span> version <span class="hljs-string">'1.1.3'</span>
    <span class="hljs-built_in">id</span> <span class="hljs-string">'java'</span>
    <span class="hljs-built_in">id</span> <span class="hljs-string">'war'</span>  // æ·»åŠ waræ’ä»¶
}

group = <span class="hljs-string">'com.example'</span>
version = <span class="hljs-string">'1.0.0'</span>
sourceCompatibility = <span class="hljs-string">'17'</span>

configurations {
    providedRuntime  // ç”¨äºprovidedèŒƒå›´çš„ä¾èµ–
}

dependencies {
    implementation <span class="hljs-string">'org.springframework.boot:spring-boot-starter-web'</span>
    providedRuntime <span class="hljs-string">'org.springframework.boot:spring-boot-starter-tomcat'</span>
}

war {
    archiveFileName = <span class="hljs-string">'myapp.war'</span>
}
</code></pre>
<h4 data-id="heading-15">æ‰“åŒ…WAR</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Maven</span>
mvn clean package

<span class="hljs-comment"># Gradle</span>
./gradlew clean build
</code></pre>
<h4 data-id="heading-16">éƒ¨ç½²åˆ°å¤–éƒ¨Tomcat</h4>
<p><strong>å‡†å¤‡TomcatæœåŠ¡å™¨</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸‹è½½Tomcat</span>
wget https://downloads.apache.org/tomcat/tomcat-10/v10.1.13/bin/apache-tomcat-10.1.13.tar.gz
tar -xzf apache-tomcat-10.1.13.tar.gz
<span class="hljs-built_in">cd</span> apache-tomcat-10.1.13
</code></pre>
<p><strong>éƒ¨ç½²WARæ–‡ä»¶</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¤åˆ¶WARæ–‡ä»¶åˆ°webappsç›®å½•</span>
<span class="hljs-built_in">cp</span> target/myapp.war /opt/tomcat/webapps/

<span class="hljs-comment"># æˆ–è€…ä½¿ç”¨ç®¡ç†ç•Œé¢éƒ¨ç½²</span>
<span class="hljs-comment"># è®¿é—® http://localhost:8080/manager/html</span>
</code></pre>
<p><strong>Tomcaté…ç½®ä¼˜åŒ–ï¼ˆconf/server.xmlï¼‰</strong></p>
<pre><code class="hljs language-ini" lang="ini">&lt;Connector <span class="hljs-attr">port</span>=<span class="hljs-string">"8080"</span> protocol=<span class="hljs-string">"HTTP/1.1"</span>
           <span class="hljs-attr">connectionTimeout</span>=<span class="hljs-string">"20000"</span>
           <span class="hljs-attr">redirectPort</span>=<span class="hljs-string">"8443"</span>
           <span class="hljs-attr">maxThreads</span>=<span class="hljs-string">"200"</span>
           <span class="hljs-attr">minSpareThreads</span>=<span class="hljs-string">"10"</span>
           <span class="hljs-attr">enableLookups</span>=<span class="hljs-string">"false"</span>
           <span class="hljs-attr">acceptCount</span>=<span class="hljs-string">"100"</span>
           <span class="hljs-attr">disableUploadTimeout</span>=<span class="hljs-string">"true"</span>/&gt;
</code></pre>
<p><strong>å¯åŠ¨/åœæ­¢Tomcat</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Linux</span>
./<span class="hljs-built_in">bin</span>/startup.sh
./<span class="hljs-built_in">bin</span>/shutdown.sh

<span class="hljs-comment"># Windows</span>
<span class="hljs-built_in">bin</span>\startup.bat
<span class="hljs-built_in">bin</span>\shutdown.bat
</code></pre>
<h3 data-id="heading-17">3. é…ç½®æ–‡ä»¶ç®¡ç†</h3>
<h4 data-id="heading-18">application.yml ç¤ºä¾‹</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># å…¬å…±é…ç½®</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">application:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">my-springboot-app</span>

<span class="hljs-comment"># å¼€å‘ç¯å¢ƒ</span>
<span class="hljs-meta">---</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">config:</span>
    <span class="hljs-attr">activate:</span>
      <span class="hljs-attr">on-profile:</span> <span class="hljs-string">dev</span>
<span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span>
<span class="hljs-attr">logging:</span>
  <span class="hljs-attr">level:</span>
    <span class="hljs-attr">root:</span> <span class="hljs-string">DEBUG</span>

<span class="hljs-comment"># ç”Ÿäº§ç¯å¢ƒ</span>
<span class="hljs-meta">---</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">config:</span>
    <span class="hljs-attr">activate:</span>
      <span class="hljs-attr">on-profile:</span> <span class="hljs-string">prod</span>
<span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span>
  <span class="hljs-attr">compression:</span>
    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">mime-types:</span> <span class="hljs-string">text/html,text/xml,text/plain,application/json</span>
<span class="hljs-attr">logging:</span>
  <span class="hljs-attr">file:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">/var/log/myapp.log</span>
  <span class="hljs-attr">level:</span>
    <span class="hljs-attr">root:</span> <span class="hljs-string">INFO</span>
</code></pre>
<h3 data-id="heading-19">4. å®¹å™¨åŒ–éƒ¨ç½²ï¼ˆDockerï¼‰</h3>
<h4 data-id="heading-20">Dockerfile for JAR</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨å¤šé˜¶æ®µæ„å»º</span>
FROM eclipse-temurin:17-jdk-alpine as builder
WORKDIR /app
COPY mvnw .
COPY .mvn .mvn
COPY pom.xml .
RUN ./mvnw dependency:go-offline
COPY src ./src
RUN ./mvnw clean package -DskipTests

<span class="hljs-comment"># è¿è¡Œé˜¶æ®µ</span>
FROM eclipse-temurin:17-jre-alpine
WORKDIR /app
COPY --from=builder /app/target/*.jar app.jar
EXPOSE 8080
ENTRYPOINT [<span class="hljs-string">"java"</span>, <span class="hljs-string">"-jar"</span>, <span class="hljs-string">"app.jar"</span>]
</code></pre>
<h4 data-id="heading-21">Dockerfile for WAR + Tomcat</h4>
<pre><code class="hljs language-bash" lang="bash">FROM tomcat:10.1-jdk17-temurin
<span class="hljs-comment"># ç§»é™¤é»˜è®¤åº”ç”¨</span>
RUN <span class="hljs-built_in">rm</span> -rf /usr/local/tomcat/webapps/*
<span class="hljs-comment"># å¤åˆ¶WARæ–‡ä»¶</span>
COPY target/myapp.war /usr/local/tomcat/webapps/ROOT.war
<span class="hljs-comment"># æš´éœ²ç«¯å£</span>
EXPOSE 8080
<span class="hljs-comment"># å¯åŠ¨Tomcat</span>
CMD [<span class="hljs-string">"catalina.sh"</span>, <span class="hljs-string">"run"</span>]
</code></pre>
<h4 data-id="heading-22">Docker Compose ç¤ºä¾‹</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">'3.8'</span>
<span class="hljs-attr">services:</span>
  <span class="hljs-attr">app:</span>
    <span class="hljs-attr">build:</span> <span class="hljs-string">.</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"8080:8080"</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">SPRING_PROFILES_ACTIVE=prod</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">DB_HOST=mysql</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">mysql</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">app-network</span>

  <span class="hljs-attr">mysql:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">mysql:8.0</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">MYSQL_ROOT_PASSWORD=rootpass</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">MYSQL_DATABASE=mydb</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">mysql-data:/var/lib/mysql</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">app-network</span>

<span class="hljs-attr">networks:</span>
  <span class="hljs-attr">app-network:</span>
    <span class="hljs-attr">driver:</span> <span class="hljs-string">bridge</span>

<span class="hljs-attr">volumes:</span>
  <span class="hljs-attr">mysql-data:</span>
</code></pre>
<h2 data-id="heading-23">ä¸‰ã€éƒ¨ç½²è„šæœ¬ç¤ºä¾‹</h2>
<h3 data-id="heading-24">Linux æœåŠ¡è„šæœ¬ï¼ˆsystemdï¼‰</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># /etc/systemd/system/myapp.service</span>
<span class="hljs-section">[Unit]</span>
<span class="hljs-attr">Description</span>=My Spring Boot Application
<span class="hljs-attr">After</span>=network.target

<span class="hljs-section">[Service]</span>
<span class="hljs-attr">Type</span>=simple
<span class="hljs-attr">User</span>=appuser
<span class="hljs-attr">WorkingDirectory</span>=/opt/myapp
<span class="hljs-attr">ExecStart</span>=/usr/bin/java -Xms512m -Xmx1024m -jar myapp.jar
<span class="hljs-attr">SuccessExitStatus</span>=<span class="hljs-number">143</span>
<span class="hljs-attr">Restart</span>=always
<span class="hljs-attr">RestartSec</span>=<span class="hljs-number">10</span>

<span class="hljs-section">[Install]</span>
<span class="hljs-attr">WantedBy</span>=multi-user.target
</code></pre>
<h3 data-id="heading-25">éƒ¨ç½²è„šæœ¬</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># deploy.sh</span>

APP_NAME=<span class="hljs-string">"my-springboot-app"</span>
JAR_PATH=<span class="hljs-string">"target/<span class="hljs-variable">$APP_NAME</span>-1.0.0.jar"</span>
DEPLOY_DIR=<span class="hljs-string">"/opt/<span class="hljs-variable">$APP_NAME</span>"</span>
BACKUP_DIR=<span class="hljs-string">"<span class="hljs-variable">$DEPLOY_DIR</span>/backup"</span>
LOG_DIR=<span class="hljs-string">"/var/log/<span class="hljs-variable">$APP_NAME</span>"</span>

<span class="hljs-comment"># åˆ›å»ºç›®å½•</span>
<span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$DEPLOY_DIR</span> <span class="hljs-variable">$BACKUP_DIR</span> <span class="hljs-variable">$LOG_DIR</span>

<span class="hljs-comment"># å¤‡ä»½æ—§ç‰ˆæœ¬</span>
<span class="hljs-keyword">if</span> [ -f <span class="hljs-string">"<span class="hljs-variable">$DEPLOY_DIR</span>/<span class="hljs-variable">$APP_NAME</span>.jar"</span> ]; <span class="hljs-keyword">then</span>
    TIMESTAMP=$(<span class="hljs-built_in">date</span> +%Y%m%d_%H%M%S)
    <span class="hljs-built_in">mv</span> <span class="hljs-string">"<span class="hljs-variable">$DEPLOY_DIR</span>/<span class="hljs-variable">$APP_NAME</span>.jar"</span> <span class="hljs-string">"<span class="hljs-variable">$BACKUP_DIR</span>/<span class="hljs-variable">$APP_NAME</span>-<span class="hljs-variable">$TIMESTAMP</span>.jar"</span>
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># å¤åˆ¶æ–°ç‰ˆæœ¬</span>
<span class="hljs-built_in">cp</span> <span class="hljs-variable">$JAR_PATH</span> <span class="hljs-string">"<span class="hljs-variable">$DEPLOY_DIR</span>/<span class="hljs-variable">$APP_NAME</span>.jar"</span>

<span class="hljs-comment"># è®¾ç½®æƒé™</span>
<span class="hljs-built_in">chmod</span> 755 <span class="hljs-string">"<span class="hljs-variable">$DEPLOY_DIR</span>/<span class="hljs-variable">$APP_NAME</span>.jar"</span>

<span class="hljs-comment"># é‡å¯æœåŠ¡</span>
systemctl restart <span class="hljs-variable">$APP_NAME</span>

<span class="hljs-comment"># æ£€æŸ¥çŠ¶æ€</span>
<span class="hljs-built_in">sleep</span> 10
systemctl status <span class="hljs-variable">$APP_NAME</span>
</code></pre>
<h2 data-id="heading-26">å››ã€æ€»ç»“å¯¹æ¯”</h2>


















































<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">JAR éƒ¨ç½²</th><th align="left">WAR éƒ¨ç½²</th></tr></thead><tbody><tr><td align="left"><strong>éƒ¨ç½²æ–¹å¼</strong></td><td align="left">ç‹¬ç«‹è¿è¡Œï¼Œå†…åµŒå®¹å™¨</td><td align="left">ä¾èµ–å¤–éƒ¨Servletå®¹å™¨</td></tr><tr><td align="left"><strong>å¯åŠ¨å‘½ä»¤</strong></td><td align="left"><code>java -jar app.jar</code></td><td align="left">å®¹å™¨å¯åŠ¨ï¼ˆå¦‚Tomcatï¼‰</td></tr><tr><td align="left"><strong>é€‚åˆåœºæ™¯</strong></td><td align="left">å¾®æœåŠ¡ã€äº‘åŸç”Ÿã€å®¹å™¨åŒ–</td><td align="left">ä¼ ç»Ÿä¼ä¸šç¯å¢ƒã€å…±äº«æœåŠ¡å™¨</td></tr><tr><td align="left"><strong>ä¾èµ–ç®¡ç†</strong></td><td align="left">åŒ…å«æ‰€æœ‰ä¾èµ–ï¼ˆfat jarï¼‰</td><td align="left">éƒ¨åˆ†ä¾èµ–ç”±å®¹å™¨æä¾›</td></tr><tr><td align="left"><strong>èµ„æºå ç”¨</strong></td><td align="left">æ¯ä¸ªåº”ç”¨ç‹¬ç«‹å®¹å™¨</td><td align="left">å¤šä¸ªåº”ç”¨å…±äº«å®¹å™¨èµ„æº</td></tr><tr><td align="left"><strong>çƒ­éƒ¨ç½²</strong></td><td align="left">éœ€è¦é‡å¯æ•´ä¸ªåº”ç”¨</td><td align="left">Tomcatæ”¯æŒéƒ¨åˆ†çƒ­éƒ¨ç½²</td></tr><tr><td align="left"><strong>é…ç½®ç®¡ç†</strong></td><td align="left">åº”ç”¨è‡ªèº«ç®¡ç†</td><td align="left">å¯ä¸å®¹å™¨é…ç½®ç»“åˆ</td></tr><tr><td align="left"><strong>ç›‘æ§</strong></td><td align="left">Spring Boot Actuator</td><td align="left">å®¹å™¨ç®¡ç†ç•Œé¢ + Actuator</td></tr></tbody></table>
<h3 data-id="heading-27">é€‰æ‹©å»ºè®®ï¼š</h3>
<ol>
<li><strong>é€‰æ‹©JARçš„æƒ…å†µ</strong>ï¼š
<ul>
<li>å¾®æœåŠ¡æ¶æ„</li>
<li>å®¹å™¨åŒ–éƒ¨ç½²ï¼ˆDocker/K8sï¼‰</li>
<li>äº‘åŸç”Ÿåº”ç”¨</li>
<li>éœ€è¦å¿«é€Ÿç‹¬ç«‹éƒ¨ç½²</li>
<li>æ— ç°æœ‰åº”ç”¨æœåŠ¡å™¨</li>
</ul>
</li>
<li><strong>é€‰æ‹©WARçš„æƒ…å†µ</strong>ï¼š
<ul>
<li>ä¼ ç»Ÿä¼ä¸šITç¯å¢ƒ</li>
<li>å·²æœ‰Tomcat/WebLogicé›†ç¾¤</li>
<li>éœ€è¦ä¸å…¶ä»–Java EEåº”ç”¨å…±äº«èµ„æº</li>
<li>è¿ç»´å›¢é˜Ÿç†Ÿæ‚‰ä¼ ç»Ÿéƒ¨ç½²æ¨¡å¼</li>
<li>éœ€è¦ä¸æ—§ç³»ç»Ÿé›†æˆ</li>
</ul>
</li>
</ol>
<h3 data-id="heading-28">æœ€ä½³å®è·µï¼š</h3>
<ol>
<li><strong>å¯¹äºæ–°é¡¹ç›®</strong>ï¼Œä¼˜å…ˆè€ƒè™‘JARéƒ¨ç½²ï¼Œæ›´ç¬¦åˆç°ä»£æ¶æ„</li>
<li><strong>ç»Ÿä¸€é…ç½®ç®¡ç†</strong>ï¼šæ— è®ºJAR/WARï¼Œä½¿ç”¨å¤–éƒ¨é…ç½®æ–‡ä»¶</li>
<li><strong>å¥åº·æ£€æŸ¥</strong>ï¼šé›†æˆSpring Boot Actuatorç”¨äºç›‘æ§</li>
<li><strong>æ—¥å¿—é›†ä¸­</strong>ï¼šä½¿ç”¨Logback/SLF4Jï¼Œæ—¥å¿—è¾“å‡ºåˆ°æ–‡ä»¶æˆ–æ—¥å¿—ç³»ç»Ÿ</li>
<li><strong>å®‰å…¨åŠ å›º</strong>ï¼šç”Ÿäº§ç¯å¢ƒå…³é—­å¼€å‘ç‰¹æ€§ï¼Œä½¿ç”¨HTTPS</li>
<li><strong>è‡ªåŠ¨åŒ–éƒ¨ç½²</strong>ï¼šç»“åˆCI/CDæµæ°´çº¿å®ç°è‡ªåŠ¨åŒ–</li>
</ol>
<p>é€šè¿‡åˆç†çš„æ‰“åŒ…éƒ¨ç½²ç­–ç•¥ï¼Œå¯ä»¥ç¡®ä¿Spring Bootåº”ç”¨åœ¨ä¸åŒç¯å¢ƒä¸­çš„ç¨³å®šè¿è¡Œå’Œé«˜æ•ˆç»´æŠ¤ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d46fa7dd1d3147769270ec545a1bd3f3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf56m656CB5a2X:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768275945&amp;x-signature=o2eoWuDmWuMTFQQFPM2uPzeqlks%3D" alt="Spring Boot æ‰“åŒ…éƒ¨ç½²ï¼ŒJAR vs WAR.png" loading="lazy"/></p>
<p><strong>è°¢è°¢ä½ çœ‹æˆ‘çš„æ–‡ç« ï¼Œæ—¢ç„¶çœ‹åˆ°è¿™é‡Œäº†ï¼Œå¦‚æœè§‰å¾—ä¸é”™ï¼Œéšæ‰‹ç‚¹ä¸ªèµã€è½¬å‘ã€åœ¨çœ‹ä¸‰è¿å§ï¼Œæ„Ÿè°¢æ„Ÿè°¢ã€‚é‚£æˆ‘ä»¬ï¼Œä¸‹æ¬¡å†è§ã€‚</strong></p>
<p>æ‚¨çš„ä¸€é”®ä¸‰è¿ï¼Œæ˜¯æˆ‘æ›´æ–°çš„æœ€å¤§åŠ¨åŠ›ï¼Œè°¢è°¢</p>
<p>å±±æ°´æœ‰ç›¸é€¢ï¼Œæ¥æ—¥çš†å¯æœŸï¼Œè°¢è°¢é˜…è¯»ï¼Œæˆ‘ä»¬å†ä¼š</p>
<p>æˆ‘æ‰‹ä¸­çš„é‡‘ç®æ£’ï¼Œä¸Šèƒ½é€šå¤©ï¼Œä¸‹èƒ½æ¢æµ·</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨å¡«å……è¡¨æ ¼æ³•åƒé€01èƒŒåŒ…åŠå…¶å˜å½¢-3]]></title>    <link>https://juejin.cn/post/7591697558378168362</link>    <guid>https://juejin.cn/post/7591697558378168362</guid>    <pubDate>2026-01-06T03:46:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591697558378168362" data-draft-id="7591697558378151978" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨å¡«å……è¡¨æ ¼æ³•åƒé€01èƒŒåŒ…åŠå…¶å˜å½¢-3"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-06T03:46:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¢œé…±"/> <meta itemprop="url" content="https://juejin.cn/user/905653309941495"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨å¡«å……è¡¨æ ¼æ³•åƒé€01èƒŒåŒ…åŠå…¶å˜å½¢-3
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/905653309941495/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¢œé…±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T03:46:53.000Z" title="Tue Jan 06 2026 03:46:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸‰ã€01èƒŒåŒ…çš„ç»å…¸å˜å½¢</h2>
<p>01èƒŒåŒ…çš„æ ¸å¿ƒæ˜¯ã€Œé€‰/ä¸é€‰ã€ï¼Œå®é™…è€ƒé¢˜ä¸­å¾ˆå°‘ç›´æ¥è€ƒæŸ¥åŸºç¡€æ¨¡å‹ï¼Œæ›´å¤šæ˜¯ç»“åˆå…·ä½“åœºæ™¯è½¬åŒ–ä¸ºå˜å½¢é—®é¢˜ã€‚ä½†æ— è®ºåœºæ™¯å¦‚ä½•å˜åŒ–ï¼Œåªè¦æŠ“ä½ã€Œæ¯ä¸ªç‰©å“æœ€å¤šé€‰ä¸€æ¬¡ã€çš„æœ¬è´¨ï¼Œå°±èƒ½ç”¨DPè§£é¢˜5æ­¥ã€Œä¸‡èƒ½é’¥åŒ™ã€è½»æ¾ç ´è§£ã€‚ä»¥ä¸‹æ˜¯4ç±»æœ€ç»å…¸çš„01èƒŒåŒ…å˜å½¢ï¼š</p>
<h3 data-id="heading-1">3.1 å˜å½¢1ï¼šç›®æ ‡å’Œï¼ˆåˆ†å‰²å­é›†å’Œ/æ˜¯å¦èƒ½è£…æ»¡èƒŒåŒ…ï¼‰</h3>
<p><strong>LeetCode é“¾æ¥</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Ftarget-sum%2F" target="_blank" title="https://leetcode.cn/problems/target-sum/" ref="nofollow noopener noreferrer">494. ç›®æ ‡å’Œ</a></p>
<p><strong>é—®é¢˜æè¿°</strong>ï¼šç»™å®šä¸€ä¸ªéè´Ÿæ•´æ•°æ•°ç»„<code>nums</code>å’Œä¸€ä¸ªç›®æ ‡æ•°<code>target</code>ï¼Œå‘æ•°ç»„ä¸­æ¯ä¸ªæ•´æ•°å‰æ·»åŠ <code>+</code>æˆ–<code>-</code>ï¼Œä½¿å¾—æ‰€æœ‰æ•´æ•°çš„å’Œç­‰äº<code>target</code>ï¼Œæ±‚æœ‰å¤šå°‘ç§ä¸åŒçš„æ·»åŠ ç¬¦å·çš„æ–¹æ³•ã€‚</p>
<p>æ ¸å¿ƒè½¬åŒ–ï¼šè®¾æ·»åŠ <code>+</code>çš„æ•°çš„å’Œä¸º<code>left</code>ï¼Œæ·»åŠ <code>-</code>çš„æ•°çš„å’Œä¸º<code>right</code>ï¼Œåˆ™æœ‰ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-attribute">left</span> - <span class="hljs-attribute">right</span> = target
<span class="hljs-attribute">left</span> + <span class="hljs-attribute">right</span> = <span class="hljs-built_in">sum</span>(nums)
ä¸¤å¼ç›¸åŠ å¾—ï¼š<span class="hljs-attribute">left</span> = (target + sum(nums)) / <span class="hljs-number">2</span>
</code></pre>
<p>é—®é¢˜è½¬åŒ–ä¸ºï¼šä»<code>nums</code>ä¸­é€‰æ‹©è‹¥å¹²å…ƒç´ ï¼Œä½¿å¾—å…¶å’Œæ°å¥½ä¸º<code>left</code>ï¼Œæ±‚è¿™æ ·çš„é€‰æ‹©æ–¹æ¡ˆæ•°â€”â€”è¿™æ˜¯ã€Œ01èƒŒåŒ…æ±‚æ–¹æ¡ˆæ•°ã€çš„å…¸å‹åœºæ™¯ï¼ˆæ¯ä¸ªå…ƒç´ é€‰æˆ–ä¸é€‰ï¼Œé€‰åˆ™è®¡å…¥å’Œï¼Œä¸é€‰åˆ™ä¸è®¡ï¼‰ã€‚</p>
<p>ç›®æ ‡å’Œé—®é¢˜æ ¸å¿ƒè¡¨æ ¼ï¼ˆç©ºè¡¨ï¼Œåç»­é€æ­¥å¡«å……ï¼‰ï¼š</p>





































<table><thead><tr><th>å¤„ç†é˜¶æ®µ\å’Œä¸ºj</th><th>0</th><th>1</th><th>2</th><th>...ï¼ˆå’Œé€’å¢ï¼‰</th><th>leftï¼ˆç›®æ ‡å’Œï¼‰</th></tr></thead><tbody><tr><td>åˆå§‹çŠ¶æ€</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td></tr><tr><td>å¤„ç†ç¬¬1ä¸ªå…ƒç´ </td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td></tr><tr><td>å¤„ç†ç¬¬2ä¸ªå…ƒç´ </td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td></tr></tbody></table>
<p>è¡¨æ ¼è¯´æ˜ï¼šè¡¨æ ¼ä¸­æ¯ä¸ªå•å…ƒæ ¼<code>dp[i][j]</code>ä»£è¡¨ã€Œå¤„ç†å‰iä¸ªå…ƒç´ åï¼Œèƒ½å‡‘å‡ºå’Œä¸ºjçš„æ–¹æ¡ˆæ•°ã€ï¼Œæœ€ç»ˆå³ä¸‹è§’<code>dp[n][left]</code>å³ä¸ºç›®æ ‡å’Œçš„è§£æ³•æ€»æ•°ï¼ˆnä¸ºnumsæ•°ç»„é•¿åº¦ï¼‰ã€‚</p>
<h4 data-id="heading-2">3.1.1 æ­¥éª¤1ï¼šç¡®å®šdpæ•°ç»„åŠä¸‹æ ‡çš„å«ä¹‰</h4>
<p>å®šä¹‰äºŒç»´æ•°ç»„<code>dp[i][j]</code>ï¼šè¡¨ç¤ºã€Œå¤„ç†å‰iä¸ªå…ƒç´ ï¼Œèƒ½å‡‘å‡ºå’Œä¸ºjçš„æ–¹æ¡ˆæ•°ã€ã€‚åç»­å¯ä¼˜åŒ–ä¸ºä¸€ç»´æ•°ç»„<code>dp[j]</code>ï¼ˆç©ºé—´ä¼˜åŒ–æ€è·¯ä¸åŸºç¡€01èƒŒåŒ…ä¸€è‡´ï¼‰ï¼Œè¿™é‡Œå…ˆä»ç›´è§‚çš„äºŒç»´æ•°ç»„å…¥æ‰‹ã€‚</p>
<p>å¯¹åº”è¡¨æ ¼ç»´åº¦ï¼šiï¼ˆè¡Œï¼‰è¡¨ç¤ºå¤„ç†çš„å…ƒç´ ä¸ªæ•°ï¼ˆä»0åˆ°nï¼Œ0ä»£è¡¨æœªå¤„ç†ä»»ä½•å…ƒç´ ï¼‰ï¼Œjï¼ˆåˆ—ï¼‰è¡¨ç¤ºè¦å‡‘çš„å’Œï¼ˆä»0åˆ°leftï¼Œ0ä»£è¡¨å’Œä¸º0ï¼‰ï¼Œè¡¨æ ¼å…±n+1è¡Œã€left+1åˆ—ã€‚</p>
<h4 data-id="heading-3">3.1.2 æ­¥éª¤2ï¼šç¡®å®šé€’æ¨å…¬å¼</h4>
<p>å¯¹äºç¬¬iä¸ªå…ƒç´ ï¼ˆå€¼ä¸º<code>nums[i-1]</code>ï¼Œæ•°ç»„ç´¢å¼•ä»0å¼€å§‹ï¼Œiä»1å¼€å§‹ï¼‰ï¼Œæ ¸å¿ƒå†³ç­–ä»æ˜¯ã€Œé€‰æˆ–ä¸é€‰ã€ï¼Œæ–¹æ¡ˆæ•°ä¸ºä¸¤ç§å†³ç­–çš„æ€»å’Œï¼š</p>
<ol>
<li>
<p><strong>ä¸é€‰ç¬¬iä¸ªå…ƒç´ </strong>ï¼šå‡‘å‡ºå’Œä¸ºjçš„æ–¹æ¡ˆæ•° = å¤„ç†å‰i-1ä¸ªå…ƒç´ å‡‘å‡ºå’Œä¸ºjçš„æ–¹æ¡ˆæ•°ï¼Œå³<code>dp[i][j] += dp[i-1][j]</code>ï¼›</p>
</li>
<li>
<p><strong>é€‰ç¬¬iä¸ªå…ƒç´ </strong>ï¼šéœ€ä¿è¯j â‰¥ nums[i-1]ï¼ˆå½“å‰å…ƒç´ å€¼ä¸å¤§äºç›®æ ‡å’Œjï¼‰ï¼Œæ­¤æ—¶æ–¹æ¡ˆæ•° = å¤„ç†å‰i-1ä¸ªå…ƒç´ å‡‘å‡ºå’Œä¸ºj-nums[i-1]çš„æ–¹æ¡ˆæ•°ï¼Œå³<code>dp[i][j] += dp[i-1][j - nums[i-1]]</code>ã€‚</p>
</li>
</ol>
<p>æœ€ç»ˆé€’æ¨å…¬å¼ï¼ˆä¸¤ç§å†³ç­–æ–¹æ¡ˆæ•°ç›¸åŠ ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">if</span> (j &gt;= nums[i - <span class="hljs-number">1</span>]) {
  dp[i][j] = dp[i - <span class="hljs-number">1</span>][j] + dp[i - <span class="hljs-number">1</span>][j - nums[i - <span class="hljs-number">1</span>]];
} <span class="hljs-keyword">else</span> {
  dp[i][j] = dp[i - <span class="hljs-number">1</span>][j];
}
</code></pre>
<h4 data-id="heading-4">3.1.3 æ­¥éª¤3ï¼šdpæ•°ç»„å¦‚ä½•åˆå§‹åŒ–</h4>
<p>åˆå§‹åŒ–æ ¸å¿ƒæ˜¯ç¡®å®šè¾¹ç•Œæ¡ä»¶ï¼Œå³æ— éœ€æ¨å¯¼å°±èƒ½ç›´æ¥ç¡®å®šçš„æ–¹æ¡ˆæ•°ï¼š</p>
<ol>
<li>
<p><strong>i=0ï¼ˆæœªå¤„ç†ä»»ä½•å…ƒç´ ï¼‰ï¼Œj=0ï¼ˆå’Œä¸º0ï¼‰</strong>ï¼šä¸é€‰ä»»ä½•å…ƒç´ å³å¯å‡‘å‡ºå’Œä¸º0ï¼Œå› æ­¤æ–¹æ¡ˆæ•°ä¸º1ï¼Œå³<code>dp[0][0] = 1</code>ï¼›</p>
</li>
<li>
<p><strong>i=0ï¼ˆæœªå¤„ç†ä»»ä½•å…ƒç´ ï¼‰ï¼Œj&gt;0ï¼ˆå’Œå¤§äº0ï¼‰</strong>ï¼šæ²¡æœ‰å…ƒç´ å¯é€‰ï¼Œæ— æ³•å‡‘å‡ºä»»ä½•æ­£å’Œï¼Œæ–¹æ¡ˆæ•°ä¸º0ï¼Œå³<code>dp[0][j] = 0</code>ï¼ˆj&gt;0ï¼‰ï¼›</p>
</li>
<li>
<p><strong>j=0ï¼ˆå’Œä¸º0ï¼‰ï¼Œi&gt;0ï¼ˆå¤„ç†è¿‡å…ƒç´ ï¼‰</strong>ï¼šåˆå§‹æ—¶å¯å…ˆè®¾ä¸º1ï¼ˆåç»­é€šè¿‡é€’æ¨æ›´æ–°ï¼‰ï¼Œè¡¨ç¤ºä¸é€‰å½“å‰åŠä¹‹å‰å…ƒç´ çš„åŸºç¡€æ–¹æ¡ˆã€‚</p>
</li>
</ol>
<p>ç»“åˆç¤ºä¾‹ç†è§£ï¼šå‡è®¾nums = [1,1,1,1]ï¼Œtarget = 2ï¼Œå…ˆè®¡ç®—sum(nums) = 4ï¼Œleft = (2 + 4)/2 = 3ã€‚åˆå§‹åŒ–åçš„è¡¨æ ¼ï¼ˆç¬¬0è¡Œå·²å¡«å……ï¼‰ï¼š</p>















































<table><thead><tr><th>å¤„ç†é˜¶æ®µ\å’Œä¸ºj</th><th>0</th><th>1</th><th>2</th><th>3</th></tr></thead><tbody><tr><td>åˆå§‹çŠ¶æ€ï¼ˆi=0ï¼‰</td><td>1</td><td>0</td><td>0</td><td>0</td></tr><tr><td>å¤„ç†ç¬¬1ä¸ªå…ƒç´ ï¼ˆ1ï¼‰</td><td>1</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td></tr><tr><td>å¤„ç†ç¬¬2ä¸ªå…ƒç´ ï¼ˆ1ï¼‰</td><td>1</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td></tr><tr><td>å¤„ç†ç¬¬3ä¸ªå…ƒç´ ï¼ˆ1ï¼‰</td><td>1</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td></tr><tr><td>å¤„ç†ç¬¬4ä¸ªå…ƒç´ ï¼ˆ1ï¼‰</td><td>1</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td></tr></tbody></table>
<h4 data-id="heading-5">3.1.4 æ­¥éª¤4ï¼šç¡®å®šéå†é¡ºåºï¼ˆè¡¨æ ¼å¡«å……é¡ºåºï¼‰</h4>
<p>ä¸åŸºç¡€01èƒŒåŒ…äºŒç»´è§£æ³•ä¸€è‡´ï¼šå…ˆéå†å…ƒç´ ï¼ˆiä»1åˆ°nï¼‰ï¼Œå†éå†å’Œï¼ˆjä»0åˆ°leftï¼‰ï¼Œå³<strong>é€è¡Œå¡«å……è¡¨æ ¼</strong>ã€‚åŸå› ï¼šè®¡ç®—<code>dp[i][j]</code>æ—¶ï¼Œä»…ä¾èµ–ä¸Šä¸€è¡Œï¼ˆi-1è¡Œï¼‰çš„<code>dp[i-1][j]</code>å’Œ<code>dp[i-1][j - nums[i-1]]</code>ï¼Œé€è¡Œå¡«å……å¯ç¡®ä¿ä¾èµ–çš„å•å…ƒæ ¼å·²æå‰è®¡ç®—å®Œæˆã€‚</p>
<h4 data-id="heading-6">3.1.5 æ­¥éª¤5ï¼šæ‰“å°dpæ•°ç»„ï¼ˆéªŒè¯ï¼‰</h4>
<p>ä»¥ç¤ºä¾‹<code>nums = [1,1,1,1]</code>ã€<code>target = 2</code>ï¼ˆleft=3ï¼‰ä¸ºä¾‹ï¼Œé€æ­¥å¡«å……è¡¨æ ¼éªŒè¯é€»è¾‘ï¼š</p>
<ol>
<li>
<p><strong>å¡«å……ç¬¬1è¡Œï¼ˆi=1ï¼Œå…ƒç´ 1ï¼š1ï¼‰</strong>ï¼š</p>
<ul>
<li>j=0ï¼šä¸é€‰å…ƒç´ 1ï¼Œæ–¹æ¡ˆæ•°=dp[0][0]=1ï¼›</li>
<li>j=1ï¼šjâ‰¥1ï¼Œæ–¹æ¡ˆæ•°=dp[0][1]ï¼ˆä¸é€‰ï¼‰+ dp[0][0]ï¼ˆé€‰ï¼‰=0+1=1ï¼›</li>
<li>j=2ï¼šj&gt;1ï¼Œæ— æ³•é€‰ï¼Œæ–¹æ¡ˆæ•°=dp[0][2]=0ï¼›</li>
<li>j=3ï¼šj&gt;1ï¼Œæ— æ³•é€‰ï¼Œæ–¹æ¡ˆæ•°=dp[0][3]=0ï¼›</li>
</ul>
</li>
<li>
<p><strong>å¡«å……ç¬¬2è¡Œï¼ˆi=2ï¼Œå…ƒç´ 2ï¼š1ï¼‰</strong>ï¼š</p>
<ul>
<li>j=0ï¼šæ–¹æ¡ˆæ•°=dp[1][0]=1ï¼›</li>
<li>j=1ï¼šjâ‰¥1ï¼Œæ–¹æ¡ˆæ•°=dp[1][1]ï¼ˆä¸é€‰ï¼‰+ dp[1][0]ï¼ˆé€‰ï¼‰=1+1=2ï¼›</li>
<li>j=2ï¼šjâ‰¥1ï¼Œæ–¹æ¡ˆæ•°=dp[1][2]ï¼ˆä¸é€‰ï¼‰+ dp[1][1]ï¼ˆé€‰ï¼‰=0+1=1ï¼›</li>
<li>j=3ï¼šj&gt;1ï¼Œæ— æ³•é€‰ï¼Œæ–¹æ¡ˆæ•°=dp[1][3]=0ï¼›</li>
</ul>
</li>
<li>
<p><strong>å¡«å……ç¬¬3è¡Œï¼ˆi=3ï¼Œå…ƒç´ 3ï¼š1ï¼‰</strong>ï¼š</p>
<ul>
<li>j=0ï¼šæ–¹æ¡ˆæ•°=dp[2][0]=1ï¼›</li>
<li>j=1ï¼šjâ‰¥1ï¼Œæ–¹æ¡ˆæ•°=dp[2][1]ï¼ˆä¸é€‰ï¼‰+ dp[2][0]ï¼ˆé€‰ï¼‰=2+1=3ï¼›</li>
<li>j=2ï¼šjâ‰¥1ï¼Œæ–¹æ¡ˆæ•°=dp[2][2]ï¼ˆä¸é€‰ï¼‰+ dp[2][1]ï¼ˆé€‰ï¼‰=1+2=3ï¼›</li>
<li>j=3ï¼šjâ‰¥1ï¼Œæ–¹æ¡ˆæ•°=dp[2][3]ï¼ˆä¸é€‰ï¼‰+ dp[2][2]ï¼ˆé€‰ï¼‰=0+1=1ï¼›</li>
</ul>
</li>
<li>
<p><strong>å¡«å……ç¬¬4è¡Œï¼ˆi=4ï¼Œå…ƒç´ 4ï¼š1ï¼‰</strong>ï¼š</p>
<ul>
<li>j=0ï¼šæ–¹æ¡ˆæ•°=dp[3][0]=1ï¼›</li>
<li>j=1ï¼šjâ‰¥1ï¼Œæ–¹æ¡ˆæ•°=dp[3][1]ï¼ˆä¸é€‰ï¼‰+ dp[3][0]ï¼ˆé€‰ï¼‰=3+1=4ï¼›</li>
<li>j=2ï¼šjâ‰¥1ï¼Œæ–¹æ¡ˆæ•°=dp[3][2]ï¼ˆä¸é€‰ï¼‰+ dp[3][1]ï¼ˆé€‰ï¼‰=3+3=6ï¼›</li>
<li>j=3ï¼šjâ‰¥1ï¼Œæ–¹æ¡ˆæ•°=dp[3][3]ï¼ˆä¸é€‰ï¼‰+ dp[3][2]ï¼ˆé€‰ï¼‰=1+3=4ï¼›</li>
</ul>
</li>
</ol>
<p>æœ€ç»ˆå¡«å……å®Œæˆçš„è¡¨æ ¼ï¼š</p>















































<table><thead><tr><th>å¤„ç†é˜¶æ®µ\å’Œä¸ºj</th><th>0</th><th>1</th><th>2</th><th>3</th></tr></thead><tbody><tr><td>åˆå§‹çŠ¶æ€ï¼ˆi=0ï¼‰</td><td>1</td><td>0</td><td>0</td><td>0</td></tr><tr><td>å¤„ç†ç¬¬1ä¸ªå…ƒç´ ï¼ˆ1ï¼‰</td><td>1</td><td>1</td><td>0</td><td>0</td></tr><tr><td>å¤„ç†ç¬¬2ä¸ªå…ƒç´ ï¼ˆ1ï¼‰</td><td>1</td><td>2</td><td>1</td><td>0</td></tr><tr><td>å¤„ç†ç¬¬3ä¸ªå…ƒç´ ï¼ˆ1ï¼‰</td><td>1</td><td>3</td><td>3</td><td>1</td></tr><tr><td>å¤„ç†ç¬¬4ä¸ªå…ƒç´ ï¼ˆ1ï¼‰</td><td>1</td><td>4</td><td>6</td><td>4</td></tr></tbody></table>
<p>è¡¨æ ¼å³ä¸‹è§’<code>dp[4][3] = 4</code>ï¼Œå³è¯¥ç¤ºä¾‹çš„ç›®æ ‡å’Œè§£æ³•æ€»æ•°ä¸º4ï¼Œä¸å®é™…æƒ…å†µä¸€è‡´ï¼ˆ+1+1+1-1ã€+1+1-1+1ã€+1-1+1+1ã€-1+1+1+1ï¼‰ã€‚</p>
<h4 data-id="heading-7">3.1.6 ç›®æ ‡å’Œé—®é¢˜å®Œæ•´ä»£ç ï¼ˆäºŒç»´+ä¸€ç»´ä¼˜åŒ–ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * ç›®æ ‡å’Œï¼ˆäºŒç»´DPè§£æ³•ï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">nums</span> - éè´Ÿæ•´æ•°æ•°ç»„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">target</span> - ç›®æ ‡å’Œ
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} - ä¸åŒçš„æ·»åŠ ç¬¦å·æ–¹æ³•æ•°
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">findTargetSumWays_2d</span>(<span class="hljs-params">nums, target</span>) {
  <span class="hljs-keyword">const</span> sum = nums.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a + b, <span class="hljs-number">0</span>);
  <span class="hljs-comment">// è¾¹ç•Œæ¡ä»¶ï¼štargetçš„ç»å¯¹å€¼å¤§äºsumï¼Œæˆ–(target + sum)ä¸ºå¥‡æ•°ï¼Œå‡æ— å¯è¡Œæ–¹æ¡ˆ</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(target) &gt; sum || (target + sum) % <span class="hljs-number">2</span> !== <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
  <span class="hljs-keyword">const</span> left = (target + sum) / <span class="hljs-number">2</span>;
  <span class="hljs-keyword">const</span> n = nums.<span class="hljs-property">length</span>;
  <span class="hljs-comment">// åˆå§‹åŒ–äºŒç»´dpæ•°ç»„ï¼šdp[i][j]è¡¨ç¤ºå¤„ç†å‰iä¸ªå…ƒç´ å‡‘å‡ºå’Œä¸ºjçš„æ–¹æ¡ˆæ•°</span>
  <span class="hljs-keyword">const</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(n + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(left + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>));
  dp[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>; <span class="hljs-comment">// æœªå¤„ç†å…ƒç´ æ—¶ï¼Œå‡‘å‡ºå’Œä¸º0çš„æ–¹æ¡ˆæ•°ä¸º1</span>

  <span class="hljs-comment">// éå†é¡ºåºï¼šå…ˆéå†å…ƒç´ ï¼Œå†éå†å’Œï¼ˆé€è¡Œå¡«å……ï¼‰</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt;= left; j++) {
      <span class="hljs-comment">// é€’æ¨å…¬å¼</span>
      <span class="hljs-keyword">if</span> (j &gt;= nums[i - <span class="hljs-number">1</span>]) {
        dp[i][j] = dp[i - <span class="hljs-number">1</span>][j] + dp[i - <span class="hljs-number">1</span>][j - nums[i - <span class="hljs-number">1</span>]];
      } <span class="hljs-keyword">else</span> {
        dp[i][j] = dp[i - <span class="hljs-number">1</span>][j];
      }
    }
  }

  <span class="hljs-comment">// æ‰“å°dpæ•°ç»„éªŒè¯</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç›®æ ‡å’ŒäºŒç»´DPæ•°ç»„ï¼ˆè¡¨æ ¼ï¼‰ï¼š'</span>);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= n; i++) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dp[i].<span class="hljs-title function_">join</span>(<span class="hljs-string">'\t'</span>));
  }

  <span class="hljs-keyword">return</span> dp[n][left];
}

<span class="hljs-comment">/**
 * ç›®æ ‡å’Œï¼ˆä¸€ç»´DPç©ºé—´ä¼˜åŒ–è§£æ³•ï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">nums</span> - éè´Ÿæ•´æ•°æ•°ç»„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">target</span> - ç›®æ ‡å’Œ
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} - ä¸åŒçš„æ·»åŠ ç¬¦å·æ–¹æ³•æ•°
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">findTargetSumWays_1d</span>(<span class="hljs-params">nums, target</span>) {
  <span class="hljs-keyword">const</span> sum = nums.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a + b, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(target) &gt; sum || (target + sum) % <span class="hljs-number">2</span> !== <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
  <span class="hljs-keyword">const</span> left = (target + sum) / <span class="hljs-number">2</span>;
  <span class="hljs-comment">// åˆå§‹åŒ–ä¸€ç»´dpæ•°ç»„ï¼šdp[j]è¡¨ç¤ºå‡‘å‡ºå’Œä¸ºjçš„æ–¹æ¡ˆæ•°</span>
  <span class="hljs-keyword">const</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(left + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>);
  dp[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>; <span class="hljs-comment">// åŸºç¡€æ–¹æ¡ˆï¼šä¸é€‰ä»»ä½•å…ƒç´ å‡‘å‡ºå’Œä¸º0</span>

  <span class="hljs-comment">// éå†é¡ºåºï¼šå…ˆéå†å…ƒç´ ï¼Œå†å€’åºéå†å’Œï¼ˆé¿å…é‡å¤é€‰æ‹©ï¼‰</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> num <span class="hljs-keyword">of</span> nums) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = left; j &gt;= num; j--) {
      dp[j] += dp[j - num]; <span class="hljs-comment">// é€’æ¨å…¬å¼ç®€åŒ–ï¼ˆå¤ç”¨æ•°ç»„ï¼‰</span>
    }
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å¤„ç†å®Œå…ƒç´ <span class="hljs-subst">${num}</span>åï¼Œdpæ•°ç»„ï¼š`</span>, [...dp]);
  }

  <span class="hljs-keyword">return</span> dp[left];
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-keyword">const</span> nums = [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>];
<span class="hljs-keyword">const</span> target = <span class="hljs-number">2</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'äºŒç»´DPè§£æ³•ï¼š'</span>, <span class="hljs-title function_">findTargetSumWays_2d</span>(nums, target)); <span class="hljs-comment">// è¾“å‡ºï¼š4</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¸€ç»´DPè§£æ³•ï¼š'</span>, <span class="hljs-title function_">findTargetSumWays_1d</span>(nums, target)); <span class="hljs-comment">// è¾“å‡ºï¼š4</span>
</code></pre>
<h3 data-id="heading-8">3.2 å˜å½¢2ï¼šåˆ†å‰²ç­‰å’Œå­é›†ï¼ˆæ˜¯å¦èƒ½è£…æ»¡èƒŒåŒ…ï¼‰</h3>
<p><strong>LeetCode é“¾æ¥</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fpartition-equal-subset-sum%2F" target="_blank" title="https://leetcode.cn/problems/partition-equal-subset-sum/" ref="nofollow noopener noreferrer">416. åˆ†å‰²ç­‰å’Œå­é›†</a></p>
<p><strong>é—®é¢˜æè¿°</strong>ï¼šç»™å®šä¸€ä¸ªåªåŒ…å«æ­£æ•´æ•°çš„éç©ºæ•°ç»„<code>nums</code>ï¼Œåˆ¤æ–­æ˜¯å¦å¯ä»¥å°†è¿™ä¸ªæ•°ç»„åˆ†å‰²æˆä¸¤ä¸ªå­é›†ï¼Œä½¿å¾—ä¸¤ä¸ªå­é›†çš„å’Œç›¸ç­‰ã€‚</p>
<p>æ ¸å¿ƒè½¬åŒ–ï¼šä¸¤ä¸ªå­é›†å’Œç›¸ç­‰ï¼Œå³æ¯ä¸ªå­é›†çš„å’Œä¸ºæ•°ç»„æ€»å’Œçš„ä¸€åŠï¼ˆè®°ä¸º<code>target</code>ï¼‰ã€‚é—®é¢˜è½¬åŒ–ä¸ºï¼šä»<code>nums</code>ä¸­é€‰æ‹©è‹¥å¹²å…ƒç´ ï¼Œä½¿å¾—å…¶å’Œæ°å¥½ä¸º<code>target</code>â€”â€”è¿™æ˜¯ã€Œ01èƒŒåŒ…åˆ¤æ–­å¯è¡Œæ€§ã€çš„å…¸å‹åœºæ™¯ï¼ˆæ¯ä¸ªå…ƒç´ é€‰æˆ–ä¸é€‰ï¼Œåˆ¤æ–­æ˜¯å¦èƒ½è£…æ»¡å®¹é‡ä¸ºtargetçš„èƒŒåŒ…ï¼‰ã€‚</p>
<p>æ ¸å¿ƒè¡¨æ ¼ï¼ˆç©ºè¡¨ï¼‰ï¼š</p>





































<table><thead><tr><th>å¤„ç†é˜¶æ®µ\å’Œä¸ºj</th><th>0</th><th>1</th><th>2</th><th>...ï¼ˆå’Œé€’å¢ï¼‰</th><th>targetï¼ˆç›®æ ‡å’Œï¼‰</th></tr></thead><tbody><tr><td>åˆå§‹çŠ¶æ€</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td></tr><tr><td>å¤„ç†ç¬¬1ä¸ªå…ƒç´ </td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td></tr><tr><td>å¤„ç†ç¬¬2ä¸ªå…ƒç´ </td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td></tr></tbody></table>
<p>è¡¨æ ¼è¯´æ˜ï¼šè¡¨æ ¼ä¸­æ¯ä¸ªå•å…ƒæ ¼<code>dp[i][j]</code>ä»£è¡¨ã€Œå¤„ç†å‰iä¸ªå…ƒç´ åï¼Œèƒ½å¦å‡‘å‡ºå’Œä¸ºjã€ï¼ˆå¸ƒå°”å€¼ï¼‰ï¼Œæœ€ç»ˆå³ä¸‹è§’<code>dp[n][target]</code>å³ä¸ºé—®é¢˜ç­”æ¡ˆã€‚</p>
<h4 data-id="heading-9">3.2.1 æ­¥éª¤1ï¼šç¡®å®šdpæ•°ç»„åŠä¸‹æ ‡çš„å«ä¹‰</h4>
<p>å®šä¹‰äºŒç»´å¸ƒå°”æ•°ç»„<code>dp[i][j]</code>ï¼šè¡¨ç¤ºã€Œå¤„ç†å‰iä¸ªå…ƒç´ ï¼Œèƒ½å¦å‡‘å‡ºå’Œä¸ºjã€ã€‚å¯ä¼˜åŒ–ä¸ºä¸€ç»´å¸ƒå°”æ•°ç»„<code>dp[j]</code>ï¼Œç©ºé—´å¤æ‚åº¦ä»<code>O(n*target)</code>é™è‡³<code>O(target)</code>ã€‚</p>
<p>å¯¹åº”è¡¨æ ¼ç»´åº¦ï¼šiï¼ˆè¡Œï¼‰è¡¨ç¤ºå¤„ç†çš„å…ƒç´ ä¸ªæ•°ï¼ˆä»0åˆ°nï¼Œ0ä»£è¡¨æœªå¤„ç†ä»»ä½•å…ƒç´ ï¼‰ï¼Œjï¼ˆåˆ—ï¼‰è¡¨ç¤ºè¦å‡‘çš„å’Œï¼ˆä»0åˆ°targetï¼Œ0ä»£è¡¨å’Œä¸º0ï¼‰ï¼Œè¡¨æ ¼å…±n+1è¡Œã€target+1åˆ—ã€‚</p>
<h4 data-id="heading-10">3.2.2 æ­¥éª¤2ï¼šç¡®å®šé€’æ¨å…¬å¼</h4>
<p>å¯¹äºç¬¬iä¸ªå…ƒç´ ï¼ˆå€¼ä¸º<code>nums[i-1]</code>ï¼‰ï¼Œå†³ç­–ä¸ºã€Œé€‰æˆ–ä¸é€‰ã€ï¼Œå¯è¡Œæ€§ä¸ºä¸¤ç§å†³ç­–çš„æˆ–è¿ç®—ï¼š</p>
<ol>
<li>
<p><strong>ä¸é€‰ç¬¬iä¸ªå…ƒç´ </strong>ï¼šèƒ½å¦å‡‘å‡ºj = å¤„ç†å‰i-1ä¸ªå…ƒç´ èƒ½å¦å‡‘å‡ºjï¼Œå³<code>dp[i][j] = dp[i-1][j]</code>ï¼›</p>
</li>
<li>
<p><strong>é€‰ç¬¬iä¸ªå…ƒç´ </strong>ï¼šéœ€j â‰¥ nums[i-1]ï¼Œèƒ½å¦å‡‘å‡ºj = å¤„ç†å‰i-1ä¸ªå…ƒç´ èƒ½å¦å‡‘å‡ºj-nums[i-1]ï¼Œå³<code>dp[i][j] = dp[i-1][j - nums[i-1]]</code>ã€‚</p>
</li>
</ol>
<p>æœ€ç»ˆé€’æ¨å…¬å¼ï¼ˆä¸¤ç§å†³ç­–æœ‰ä¸€ä¸ªå¯è¡Œåˆ™æ•´ä½“å¯è¡Œï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">if</span> (j &gt;= nums[i - <span class="hljs-number">1</span>]) {
  dp[i][j] = dp[i - <span class="hljs-number">1</span>][j] || dp[i - <span class="hljs-number">1</span>][j - nums[i - <span class="hljs-number">1</span>]];
} <span class="hljs-keyword">else</span> {
  dp[i][j] = dp[i - <span class="hljs-number">1</span>][j];
}
</code></pre>
<h4 data-id="heading-11">3.2.3 æ­¥éª¤3ï¼šdpæ•°ç»„å¦‚ä½•åˆå§‹åŒ–</h4>
<p>åˆå§‹åŒ–æ ¸å¿ƒæ˜¯ç¡®å®šè¾¹ç•Œæ¡ä»¶ï¼Œå³æ— éœ€æ¨å¯¼å°±èƒ½ç›´æ¥ç¡®å®šçš„å¯è¡Œæ€§ï¼š</p>
<ol>
<li>
<p><strong>i=0ï¼ˆæœªå¤„ç†ä»»ä½•å…ƒç´ ï¼‰ï¼Œj=0ï¼ˆå’Œä¸º0ï¼‰</strong>ï¼šä¸é€‰ä»»ä½•å…ƒç´ å¯å‡‘å‡ºå’Œä¸º0ï¼Œå› æ­¤<code>dp[0][0] = true</code>ï¼›</p>
</li>
<li>
<p><strong>i=0ï¼ˆæœªå¤„ç†ä»»ä½•å…ƒç´ ï¼‰ï¼Œj&gt;0ï¼ˆå’Œå¤§äº0ï¼‰</strong>ï¼šæ²¡æœ‰å…ƒç´ å¯é€‰ï¼Œæ— æ³•å‡‘å‡ºä»»ä½•æ­£å’Œï¼Œå¯è¡Œæ€§ä¸º<code>false</code>ï¼Œå³<code>dp[0][j] = false</code>ï¼ˆj&gt;0ï¼‰ï¼›</p>
</li>
<li>
<p><strong>j=0ï¼ˆå’Œä¸º0ï¼‰ï¼Œi&gt;0ï¼ˆå¤„ç†è¿‡å…ƒç´ ï¼‰</strong>ï¼šåˆå§‹æ—¶å¯å…ˆè®¾ä¸º<code>true</code>ï¼ˆåç»­é€šè¿‡é€’æ¨æ›´æ–°ï¼‰ï¼Œè¡¨ç¤ºä¸é€‰å½“å‰åŠä¹‹å‰å…ƒç´ çš„åŸºç¡€æ–¹æ¡ˆã€‚</p>
</li>
</ol>
<p>ç»“åˆç¤ºä¾‹ç†è§£ï¼šå‡è®¾nums = [1,5,11,5]ï¼Œsum = 22ï¼Œtarget = 11ã€‚åˆå§‹åŒ–åçš„è¡¨æ ¼ï¼ˆç¬¬0è¡Œå·²å¡«å……ï¼‰ï¼š</p>



























































<table><thead><tr><th>å¤„ç†é˜¶æ®µ\å’Œä¸ºj</th><th>0</th><th>1</th><th>2</th><th>3</th><th>...ï¼ˆå’Œé€’å¢ï¼‰</th><th>11ï¼ˆç›®æ ‡å’Œï¼‰</th></tr></thead><tbody><tr><td>åˆå§‹çŠ¶æ€ï¼ˆi=0ï¼‰</td><td>true</td><td>false</td><td>false</td><td>false</td><td>false</td><td>false</td></tr><tr><td>å¤„ç†ç¬¬1ä¸ªå…ƒç´ ï¼ˆ1ï¼‰</td><td>true</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td></tr><tr><td>å¤„ç†ç¬¬2ä¸ªå…ƒç´ ï¼ˆ5ï¼‰</td><td>true</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td></tr><tr><td>å¤„ç†ç¬¬3ä¸ªå…ƒç´ ï¼ˆ11ï¼‰</td><td>true</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td></tr><tr><td>å¤„ç†ç¬¬4ä¸ªå…ƒç´ ï¼ˆ5ï¼‰</td><td>true</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td><td>å¾…å¡«</td></tr></tbody></table>
<h4 data-id="heading-12">3.2.4 æ­¥éª¤4ï¼šç¡®å®šéå†é¡ºåºï¼ˆè¡¨æ ¼å¡«å……é¡ºåºï¼‰</h4>
<p>ä¸åŸºç¡€01èƒŒåŒ…äºŒç»´è§£æ³•ä¸€è‡´ï¼šå…ˆéå†å…ƒç´ ï¼ˆiä»1åˆ°nï¼‰ï¼Œå†éå†å’Œï¼ˆjä»0åˆ°targetï¼‰ï¼Œå³<strong>é€è¡Œå¡«å……è¡¨æ ¼</strong>ã€‚åŸå› ï¼šè®¡ç®—<code>dp[i][j]</code>æ—¶ï¼Œä»…ä¾èµ–ä¸Šä¸€è¡Œï¼ˆi-1è¡Œï¼‰çš„<code>dp[i-1][j]</code>å’Œ<code>dp[i-1][j - nums[i-1]]</code>ï¼Œé€è¡Œå¡«å……å¯ç¡®ä¿ä¾èµ–çš„å•å…ƒæ ¼å·²æå‰è®¡ç®—å®Œæˆã€‚</p>
<p>ä¸€ç»´è§£æ³•ï¼šå…ˆéå†å…ƒç´ ï¼Œå†å€’åºéå†å’Œï¼ˆé¿å…é‡å¤é€‰æ‹©ï¼‰ï¼Œä¸åŸºç¡€01èƒŒåŒ…ç©ºé—´ä¼˜åŒ–é€»è¾‘ä¸€è‡´ã€‚</p>
<h4 data-id="heading-13">3.2.5 æ­¥éª¤5ï¼šæ‰“å°dpæ•°ç»„ï¼ˆéªŒè¯ï¼‰</h4>
<p>ä»¥ç¤ºä¾‹<code>nums = [1,5,11,5]</code>ã€<code>sum = 22</code>ã€<code>target = 11</code>ä¸ºä¾‹ï¼Œé€æ­¥å¡«å……è¡¨æ ¼éªŒè¯é€»è¾‘ï¼š</p>
<ol>
<li>
<p><strong>å¡«å……ç¬¬1è¡Œï¼ˆi=1ï¼Œå…ƒç´ 1ï¼š1ï¼‰</strong>ï¼š</p>
<ul>
<li>j=0ï¼šä¸é€‰å…ƒç´ 1ï¼Œdp[1][0] = dp[0][0] = trueï¼›</li>
<li>j=1ï¼šjâ‰¥1ï¼Œdp[1][1] = dp[0][1]ï¼ˆä¸é€‰ï¼‰|| dp[0][0]ï¼ˆé€‰ï¼‰= false || true = trueï¼›</li>
<li>j=2-11ï¼šj&lt;1ï¼Œæ— æ³•é€‰ï¼Œdp[1][j] = dp[0][j] = falseï¼›</li>
</ul>
</li>
<li>
<p><strong>å¡«å……ç¬¬2è¡Œï¼ˆi=2ï¼Œå…ƒç´ 2ï¼š5ï¼‰</strong>ï¼š</p>
<ul>
<li>j=0ï¼šdp[2][0] = dp[1][0] = trueï¼›</li>
<li>j=1-4ï¼šj&lt;5ï¼Œæ— æ³•é€‰ï¼Œdp[2][j] = dp[1][j]ï¼ˆç»§æ‰¿ä¸Šä¸€è¡Œï¼‰ï¼›</li>
<li>j=5ï¼šjâ‰¥5ï¼Œdp[2][5] = dp[1][5]ï¼ˆä¸é€‰ï¼‰|| dp[1][0]ï¼ˆé€‰ï¼‰= false || true = trueï¼›</li>
<li>j=6ï¼šjâ‰¥5ï¼Œdp[2][6] = dp[1][6]ï¼ˆä¸é€‰ï¼‰|| dp[1][1]ï¼ˆé€‰ï¼‰= false || true = trueï¼›</li>
<li>j=7-11ï¼šjâ‰¥5ï¼Œdp[2][j] = dp[1][j]ï¼ˆä¸é€‰ï¼‰|| dp[1][j-5]ï¼ˆé€‰ï¼‰ï¼Œå…¶ä¸­j=11æ—¶ï¼Œdp[2][11] = false || false = falseï¼›</li>
</ul>
</li>
<li>
<p><strong>å¡«å……ç¬¬3è¡Œï¼ˆi=3ï¼Œå…ƒç´ 3ï¼š11ï¼‰</strong>ï¼š</p>
<ul>
<li>j=0-10ï¼šj&lt;11ï¼Œæ— æ³•é€‰ï¼Œdp[3][j] = dp[2][j]ï¼ˆç»§æ‰¿ä¸Šä¸€è¡Œï¼‰ï¼›</li>
<li>j=11ï¼šjâ‰¥11ï¼Œdp[3][11] = dp[2][11]ï¼ˆä¸é€‰ï¼‰|| dp[2][0]ï¼ˆé€‰ï¼‰= false || true = trueï¼›</li>
</ul>
</li>
<li>
<p><strong>å¡«å……ç¬¬4è¡Œï¼ˆi=4ï¼Œå…ƒç´ 4ï¼š5ï¼‰</strong>ï¼š</p>
<ul>
<li>j=0-4ï¼šj&lt;5ï¼Œæ— æ³•é€‰ï¼Œdp[4][j] = dp[3][j]ï¼ˆç»§æ‰¿ä¸Šä¸€è¡Œï¼‰ï¼›</li>
<li>j=5-11ï¼šjâ‰¥5ï¼Œdp[4][j] = dp[3][j]ï¼ˆä¸é€‰ï¼‰|| dp[3][j-5]ï¼ˆé€‰ï¼‰ï¼Œå…¶ä¸­j=11æ—¶ï¼Œdp[4][11] = true || false = trueï¼›</li>
</ul>
</li>
</ol>
<p>æœ€ç»ˆå¡«å……å®Œæˆçš„è¡¨æ ¼ï¼š</p>































































































<table><thead><tr><th>å¤„ç†é˜¶æ®µ\å’Œä¸ºj</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th></tr></thead><tbody><tr><td>åˆå§‹çŠ¶æ€ï¼ˆi=0ï¼‰</td><td>true</td><td>false</td><td>false</td><td>false</td><td>false</td><td>false</td><td>false</td><td>false</td><td>false</td><td>false</td><td>false</td><td>false</td></tr><tr><td>å¤„ç†ç¬¬1ä¸ªå…ƒç´ ï¼ˆ1ï¼‰</td><td>true</td><td>true</td><td>false</td><td>false</td><td>false</td><td>false</td><td>false</td><td>false</td><td>false</td><td>false</td><td>false</td><td>false</td></tr><tr><td>å¤„ç†ç¬¬2ä¸ªå…ƒç´ ï¼ˆ5ï¼‰</td><td>true</td><td>true</td><td>false</td><td>false</td><td>false</td><td>true</td><td>true</td><td>false</td><td>false</td><td>false</td><td>false</td><td>false</td></tr><tr><td>å¤„ç†ç¬¬3ä¸ªå…ƒç´ ï¼ˆ11ï¼‰</td><td>true</td><td>true</td><td>false</td><td>false</td><td>false</td><td>true</td><td>true</td><td>false</td><td>false</td><td>false</td><td>false</td><td>true</td></tr><tr><td>å¤„ç†ç¬¬4ä¸ªå…ƒç´ ï¼ˆ5ï¼‰</td><td>true</td><td>true</td><td>false</td><td>false</td><td>false</td><td>true</td><td>true</td><td>false</td><td>false</td><td>false</td><td>false</td><td>true</td></tr></tbody></table>
<p>è¡¨æ ¼å³ä¸‹è§’<code>dp[4][11] = true</code>ï¼Œå³è¯¥ç¤ºä¾‹å¯ä»¥åˆ†å‰²æˆä¸¤ä¸ªå’Œç›¸ç­‰çš„å­é›†ï¼ˆå­é›†[1,5,5]å’Œ[11]ï¼‰ï¼Œä¸é¢„æœŸç»“æœä¸€è‡´ã€‚</p>
<h4 data-id="heading-14">3.2.6 åˆ†å‰²ç­‰å’Œå­é›†å®Œæ•´ä»£ç </h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * åˆ†å‰²ç­‰å’Œå­é›†ï¼ˆäºŒç»´DPè§£æ³•ï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">nums</span> - æ­£æ•´æ•°æ•°ç»„
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">boolean</span>} - æ˜¯å¦å¯ä»¥åˆ†å‰²æˆä¸¤ä¸ªå’Œç›¸ç­‰çš„å­é›†
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">canPartition_2d</span>(<span class="hljs-params">nums</span>) {
  <span class="hljs-keyword">const</span> sum = nums.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a + b, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">if</span> (sum % <span class="hljs-number">2</span> !== <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// æ€»å’Œä¸ºå¥‡æ•°ï¼Œæ— æ³•åˆ†å‰²</span>
  <span class="hljs-keyword">const</span> target = sum / <span class="hljs-number">2</span>;
  <span class="hljs-keyword">const</span> n = nums.<span class="hljs-property">length</span>;
  <span class="hljs-comment">// åˆå§‹åŒ–äºŒç»´dpæ•°ç»„ï¼šdp[i][j]è¡¨ç¤ºå¤„ç†å‰iä¸ªå…ƒç´ èƒ½å¦å‡‘å‡ºå’Œä¸ºj</span>
  <span class="hljs-keyword">const</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(n + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(target + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-literal">false</span>));
  dp[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-literal">true</span>; <span class="hljs-comment">// è¾¹ç•Œæ¡ä»¶</span>

  <span class="hljs-comment">// éå†é¡ºåºï¼šå…ˆéå†å…ƒç´ ï¼Œå†éå†å’Œ</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt;= target; j++) {
      <span class="hljs-keyword">if</span> (j &gt;= nums[i - <span class="hljs-number">1</span>]) {
        dp[i][j] = dp[i - <span class="hljs-number">1</span>][j] || dp[i - <span class="hljs-number">1</span>][j - nums[i - <span class="hljs-number">1</span>]];
      } <span class="hljs-keyword">else</span> {
        dp[i][j] = dp[i - <span class="hljs-number">1</span>][j];
      }
    }
  }

  <span class="hljs-comment">// æ‰“å°dpæ•°ç»„éªŒè¯</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'åˆ†å‰²ç­‰å’Œå­é›†äºŒç»´DPæ•°ç»„ï¼ˆè¡¨æ ¼ï¼‰ï¼š'</span>);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= n; i++) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dp[i].<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">val</span> =&gt;</span> (val ? <span class="hljs-string">'true'</span> : <span class="hljs-string">'false'</span>)).<span class="hljs-title function_">join</span>(<span class="hljs-string">'\t'</span>));
  }

  <span class="hljs-keyword">return</span> dp[n][target];
}

<span class="hljs-comment">/**
 * åˆ†å‰²ç­‰å’Œå­é›†ï¼ˆä¸€ç»´DPç©ºé—´ä¼˜åŒ–è§£æ³•ï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">nums</span> - æ­£æ•´æ•°æ•°ç»„
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">boolean</span>} - æ˜¯å¦å¯ä»¥åˆ†å‰²æˆä¸¤ä¸ªå’Œç›¸ç­‰çš„å­é›†
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">canPartition_1d</span>(<span class="hljs-params">nums</span>) {
  <span class="hljs-keyword">const</span> sum = nums.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a + b, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">if</span> (sum % <span class="hljs-number">2</span> !== <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">const</span> target = sum / <span class="hljs-number">2</span>;
  <span class="hljs-comment">// åˆå§‹åŒ–ä¸€ç»´dpæ•°ç»„ï¼šdp[j]è¡¨ç¤ºèƒ½å¦å‡‘å‡ºå’Œä¸ºj</span>
  <span class="hljs-keyword">const</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(target + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-literal">false</span>);
  dp[<span class="hljs-number">0</span>] = <span class="hljs-literal">true</span>; <span class="hljs-comment">// è¾¹ç•Œæ¡ä»¶</span>

  <span class="hljs-comment">// éå†é¡ºåºï¼šå…ˆéå†å…ƒç´ ï¼Œå†å€’åºéå†å’Œ</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> num <span class="hljs-keyword">of</span> nums) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = target; j &gt;= num; j--) {
      dp[j] = dp[j] || dp[j - num];
    }
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
      <span class="hljs-string">`å¤„ç†å®Œå…ƒç´ <span class="hljs-subst">${num}</span>åï¼Œdpæ•°ç»„ï¼š`</span>,
      dp.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">val</span> =&gt;</span> (val ? <span class="hljs-string">'true'</span> : <span class="hljs-string">'false'</span>))
    );
  }

  <span class="hljs-keyword">return</span> dp[target];
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-keyword">const</span> nums1 = [<span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">11</span>, <span class="hljs-number">5</span>];
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'äºŒç»´DPè§£æ³•ï¼š'</span>, <span class="hljs-title function_">canPartition_2d</span>(nums1)); <span class="hljs-comment">// è¾“å‡ºï¼štrue</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¸€ç»´DPè§£æ³•ï¼š'</span>, <span class="hljs-title function_">canPartition_1d</span>(nums1)); <span class="hljs-comment">// è¾“å‡ºï¼štrue</span>

<span class="hljs-keyword">const</span> nums2 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>];
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'äºŒç»´DPè§£æ³•ï¼š'</span>, <span class="hljs-title function_">canPartition_2d</span>(nums2)); <span class="hljs-comment">// è¾“å‡ºï¼šfalse</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¸€ç»´DPè§£æ³•ï¼š'</span>, <span class="hljs-title function_">canPartition_1d</span>(nums2)); <span class="hljs-comment">// è¾“å‡ºï¼šfalse</span>
</code></pre>
<h3 data-id="heading-15">3.3 å˜å½¢3ï¼šæœ€åä¸€å—çŸ³å¤´çš„é‡é‡IIï¼ˆæœ€å°èƒŒåŒ…å‰©ä½™å®¹é‡ï¼‰</h3>
<p><strong>LeetCode é“¾æ¥</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Flast-stone-weight-ii%2F" target="_blank" title="https://leetcode.cn/problems/last-stone-weight-ii/" ref="nofollow noopener noreferrer">1049. æœ€åä¸€å—çŸ³å¤´çš„é‡é‡ II</a></p>
<p><strong>é—®é¢˜æè¿°</strong>ï¼šæœ‰ä¸€å †çŸ³å¤´ï¼Œæ¯å—çŸ³å¤´çš„é‡é‡éƒ½æ˜¯æ­£æ•´æ•°ã€‚æ¯ä¸€å›åˆï¼Œä»ä¸­é€‰å‡ºä»»æ„ä¸¤å—çŸ³å¤´ï¼Œç„¶åå°†å®ƒä»¬ä¸€èµ·ç²‰ç¢ã€‚å‡è®¾çŸ³å¤´çš„é‡é‡åˆ†åˆ«ä¸ºxå’Œyï¼Œä¸”x â‰¤ yã€‚é‚£ä¹ˆç²‰ç¢çš„å¯èƒ½ç»“æœå¦‚ä¸‹ï¼šå¦‚æœx == yï¼Œé‚£ä¹ˆä¸¤å—çŸ³å¤´éƒ½ä¼šè¢«å®Œå…¨ç²‰ç¢ï¼›å¦‚æœx != yï¼Œé‚£ä¹ˆé‡é‡ä¸ºxçš„çŸ³å¤´ä¼šè¢«å®Œå…¨ç²‰ç¢ï¼Œè€Œé‡é‡ä¸ºyçš„çŸ³å¤´ä¼šå˜æˆy - xçš„é‡é‡ã€‚æœ€åï¼Œæœ€å¤šåªä¼šå‰©ä¸‹ä¸€å—çŸ³å¤´ã€‚è¿”å›æ­¤çŸ³å¤´çš„æœ€å°å¯èƒ½é‡é‡ã€‚</p>
<p>æ ¸å¿ƒè½¬åŒ–ï¼šè¦ä½¿æœ€åå‰©ä½™çŸ³å¤´é‡é‡æœ€å°ï¼Œéœ€å°†çŸ³å¤´å°½å¯èƒ½åˆ†æˆä¸¤å †é‡é‡æ¥è¿‘çš„çŸ³å¤´â€”â€”ä¸¤å †é‡é‡å·®è¶Šå°ï¼Œå‰©ä½™é‡é‡è¶Šå°ã€‚è®¾æ€»é‡é‡ä¸ºsumï¼Œç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€å †çŸ³å¤´çš„æœ€å¤§é‡é‡<code>maxWeight</code>ï¼ˆâ‰¤ sum/2ï¼‰ï¼Œåˆ™å‰©ä½™é‡é‡ä¸º<code>sum - 2*maxWeight</code>ã€‚é—®é¢˜è½¬åŒ–ä¸ºï¼šä»çŸ³å¤´é‡é‡æ•°ç»„ä¸­é€‰æ‹©è‹¥å¹²å…ƒç´ ï¼Œä½¿å¾—å…¶å’Œä¸è¶…è¿‡sum/2çš„æœ€å¤§å€¼â€”â€”è¿™æ˜¯ã€Œ01èƒŒåŒ…æ±‚æœ€å¤§ä»·å€¼ï¼ˆé‡é‡å³ä»·å€¼ï¼‰ã€çš„åœºæ™¯ï¼ˆèƒŒåŒ…å®¹é‡ä¸ºsum/2ï¼Œç‰©å“é‡é‡å’Œä»·å€¼å‡ä¸ºçŸ³å¤´é‡é‡ï¼‰ã€‚</p>
<p>æœ€åä¸€å—çŸ³å¤´çš„é‡é‡IIæ ¸å¿ƒè¡¨æ ¼ï¼ˆç©ºè¡¨ï¼Œåç»­é€æ­¥å¡«å……ï¼‰ï¼š</p>





































<table><thead><tr><th>å¤„ç†é˜¶æ®µ\å®¹é‡j</th><th>0</th><th>1</th><th>2</th><th>...ï¼ˆå®¹é‡é€’å¢ï¼‰</th><th>targetï¼ˆsum/2ï¼‰</th></tr></thead><tbody><tr><td>åˆå§‹çŠ¶æ€</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td></tr><tr><td>å¤„ç†ç¬¬1å—çŸ³å¤´</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td></tr><tr><td>å¤„ç†ç¬¬2å—çŸ³å¤´</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td></tr></tbody></table>
<p>è¡¨æ ¼è¯´æ˜ï¼šè¡¨æ ¼ä¸­æ¯ä¸ªå•å…ƒæ ¼<code>dp[j]</code>ä»£è¡¨ã€Œå®¹é‡ä¸ºjçš„èƒŒåŒ…èƒ½å®¹çº³çš„æœ€å¤§é‡é‡ã€ï¼ˆä¸€ç»´DPï¼‰ï¼Œæœ€ç»ˆ<code>dp[target]</code>å³ä¸ºä¸è¶…è¿‡sum/2çš„æœ€å¤§å­é›†é‡é‡ï¼Œå‰©ä½™é‡é‡ = sum - 2*dp[target]ã€‚</p>
<h4 data-id="heading-16">3.3.1 æ­¥éª¤1ï¼šç¡®å®šdpæ•°ç»„åŠä¸‹æ ‡çš„å«ä¹‰</h4>
<p>å®šä¹‰ä¸€ç»´æ•°ç»„<code>dp[j]</code>ï¼šè¡¨ç¤ºã€Œå®¹é‡ä¸ºjçš„èƒŒåŒ…ï¼Œèƒ½å®¹çº³çš„æœ€å¤§é‡é‡ã€ï¼ˆå³é€‰è‹¥å¹²çŸ³å¤´çš„æœ€å¤§å’Œï¼‰ã€‚</p>
<p>å¯¹åº”è¡¨æ ¼ç»´åº¦ï¼šä»…ä¿ç•™"å®¹é‡j"è¿™ä¸€åˆ—ç»´åº¦ï¼ˆjä»0åˆ°targetï¼Œtarget = sum/2å‘ä¸‹å–æ•´ï¼‰ï¼Œå½¢æˆå•è¡Œè¡¨æ ¼ï¼Œæ¯æ¬¡éå†çŸ³å¤´æ—¶ï¼Œæ»šåŠ¨æ›´æ–°è¿™ä¸€è¡Œçš„æ•°å€¼ï¼ˆè¦†ç›–ä¸Šä¸€è¡Œçš„ç»“æœï¼‰ã€‚</p>
<h4 data-id="heading-17">3.3.2 æ­¥éª¤2ï¼šç¡®å®šé€’æ¨å…¬å¼</h4>
<p>å¯¹äºç¬¬iå—çŸ³å¤´ï¼ˆé‡é‡<code>stones[i]</code>ï¼Œä»·å€¼ä¹Ÿä¸º<code>stones[i]</code>ï¼‰ï¼Œæœ‰ä¸¤ç§æ ¸å¿ƒå†³ç­–ï¼šé€‰æˆ–ä¸é€‰ã€‚</p>
<ol>
<li>
<p><strong>ä¸é€‰ç¬¬iå—çŸ³å¤´</strong>ï¼šå®¹é‡ä¸ºjçš„æœ€å¤§é‡é‡ = ä¸é€‰å½“å‰çŸ³å¤´æ—¶çš„æœ€å¤§é‡é‡ï¼Œå³<code>dp[j] = dp[j]</code>ï¼ˆä¿æŒä¸å˜ï¼‰ï¼›</p>
</li>
<li>
<p><strong>é€‰ç¬¬iå—çŸ³å¤´</strong>ï¼šéœ€ä¿è¯èƒŒåŒ…å®¹é‡j â‰¥ ç¬¬iå—çŸ³å¤´çš„é‡é‡ï¼Œæ­¤æ—¶æœ€å¤§é‡é‡ = å®¹é‡j-stones[i]çš„æœ€å¤§é‡é‡ + ç¬¬iå—çŸ³å¤´çš„é‡é‡ï¼Œå³<code>dp[j] = dp[j - stones[i]] + stones[i]</code>ã€‚</p>
</li>
</ol>
<p>æœ€ç»ˆé€’æ¨å…¬å¼ï¼ˆå–ä¸¤ç§å†³ç­–çš„æœ€å¤§å€¼ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">if</span> (j &gt;= stones[i]) {
  dp[j] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(dp[j], dp[j - stones[i]] + stones[i]);
} <span class="hljs-keyword">else</span> {
  dp[j] = dp[j]; <span class="hljs-comment">// å®¹é‡ä¸è¶³ï¼Œæ— æ³•é€‰</span>
}
</code></pre>
<p>ç®€åŒ–åï¼ˆå› ä¸ºå®¹é‡ä¸è¶³æ—¶dp[j]ä¸å˜ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = target; j &gt;= stones[i]; j--) {
  dp[j] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(dp[j], dp[j - stones[i]] + stones[i]);
}
</code></pre>
<h4 data-id="heading-18">3.3.3 æ­¥éª¤3ï¼šdpæ•°ç»„å¦‚ä½•åˆå§‹åŒ–</h4>
<p>åˆå§‹åŒ–é€»è¾‘ä¸åŸºç¡€01èƒŒåŒ…ä¸€ç»´DPä¸€è‡´ï¼šå®¹é‡ä¸º0æ—¶ï¼Œæœ€å¤§é‡é‡ä¸º0ï¼Œå› æ­¤<code>dp[0] = 0</code>ï¼›å…¶ä»–å®¹é‡çš„åˆå§‹å€¼ä¹Ÿä¸º0ï¼ˆå› ä¸ºåˆå§‹æ— çŸ³å¤´å¯æ”¾ï¼Œæœ€å¤§é‡é‡ä¸º0ï¼‰ï¼Œå³<code>dp = new Array(target + 1).fill(0)</code>ã€‚</p>
<p>åˆå§‹åŒ–åçš„å•è¡Œè¡¨æ ¼ï¼š[0,0,0,0,...]ï¼ˆjä»0åˆ°targetï¼‰</p>
<p>ç»“åˆç¤ºä¾‹ç†è§£ï¼šå‡è®¾stones = [2,7,4,1,8,1]ï¼Œsum = 23ï¼Œtarget = Math.floor(23/2) = 11ã€‚åˆå§‹åŒ–åçš„è¡¨æ ¼ï¼š</p>



































<table><thead><tr><th>å®¹é‡j</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th></tr></thead><tbody><tr><td>åˆå§‹</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr></tbody></table>
<h4 data-id="heading-19">3.3.4 æ­¥éª¤4ï¼šç¡®å®šéå†é¡ºåºï¼ˆè¡¨æ ¼å¡«å……é¡ºåºï¼‰</h4>
<p>ä¸€ç»´DPçš„éå†é¡ºåºæœ‰ä¸¥æ ¼è¦æ±‚ï¼Œæ ¸å¿ƒæ˜¯ã€Œå€’åºéå†å®¹é‡ã€ï¼Œå¯¹åº”å•è¡Œè¡¨æ ¼çš„ã€Œä»å³å¾€å·¦å¡«å……ã€ï¼š</p>
<ol>
<li>
<p><strong>å¿…é¡»å…ˆéå†çŸ³å¤´ï¼Œå†éå†å®¹é‡</strong>ï¼šé€ä¸ªå¤„ç†æ¯å—çŸ³å¤´ï¼Œæ¯æ¬¡å¤„ç†æ—¶æ›´æ–°æ•´ä¸ªå•è¡Œè¡¨æ ¼ï¼ˆè¦†ç›–ä¸Šä¸€è¡Œç»“æœï¼‰ï¼›</p>
</li>
<li>
<p><strong>å®¹é‡å¿…é¡»å€’åºéå†ï¼ˆjä»targetåˆ°stones[i]ï¼‰</strong>ï¼šä»æœ€å¤§å®¹é‡å¾€å°å®¹é‡å¡«å……ï¼Œç¡®ä¿è®¡ç®—<code>dp[j]</code>æ—¶ï¼Œ<code>dp[j - stones[i]]</code>ä»æ˜¯ä¸Šä¸€è¡Œï¼ˆæœªå¤„ç†å½“å‰çŸ³å¤´ï¼‰çš„æ—§å€¼ï¼Œé¿å…åŒä¸€çŸ³å¤´è¢«å¤šæ¬¡é€‰æ‹©ã€‚</p>
</li>
</ol>
<h4 data-id="heading-20">3.3.5 æ­¥éª¤5ï¼šæ‰“å°dpæ•°ç»„ï¼ˆéªŒè¯ï¼‰</h4>
<p>é€šè¿‡æ‰“å°å•è¡Œè¡¨æ ¼çš„æ»šåŠ¨æ›´æ–°è¿‡ç¨‹ï¼ŒéªŒè¯å¡«å……è§„åˆ™çš„æ­£ç¡®æ€§ã€‚ä»ç”¨æµ‹è¯•ç”¨ä¾‹ <code>stones = [2,7,4,1,8,1]</code>ã€<code>sum = 23</code>ã€<code>target = 11</code>ï¼Œæ¼”ç¤ºä¸€ç»´DPæ•°ç»„ï¼ˆå•è¡Œè¡¨æ ¼ï¼‰çš„å¡«å……å˜åŒ–ï¼š</p>
<ol>
<li>
<p><strong>åˆå§‹çŠ¶æ€</strong>ï¼šdp = [0,0,0,0,0,0,0,0,0,0,0,0]</p>
</li>
<li>
<p><strong>å¤„ç†çŸ³å¤´1ï¼ˆw=2ï¼‰ï¼Œjä»11åˆ°2å€’åº</strong>ï¼šæ›´æ–°åï¼šdp = [0,0,2,2,2,2,2,2,2,2,2,2]</p>
<ul>
<li>j=11ï¼šdp[11] = max(0, dp[9]+2) = max(0,0+2)=2ï¼›</li>
<li>j=10ï¼šdp[10] = max(0, dp[8]+2)=2ï¼›</li>
<li>...ï¼ˆj=2åˆ°9åŒç†ï¼‰ï¼›</li>
<li>j=2ï¼šdp[2] = max(0, dp[0]+2)=2ï¼›</li>
</ul>
</li>
<li>
<p><strong>å¤„ç†çŸ³å¤´2ï¼ˆw=7ï¼‰ï¼Œjä»11åˆ°7å€’åº</strong>ï¼šæ›´æ–°åï¼šdp = [0,0,2,2,2,2,2,7,7,9,9,9]</p>
<ul>
<li>j=11ï¼šmax(2, dp[4]+7)=max(2,2+7)=9ï¼›</li>
<li>j=10ï¼šmax(2, dp[3]+7)=max(2,2+7)=9ï¼›</li>
<li>j=9ï¼šmax(2, dp[2]+7)=max(2,2+7)=9ï¼›</li>
<li>j=8ï¼šmax(2, dp[1]+7)=max(2,0+7)=7ï¼›</li>
<li>j=7ï¼šmax(2, dp[0]+7)=max(2,0+7)=7ï¼›</li>
</ul>
</li>
<li>
<p><strong>å¤„ç†çŸ³å¤´3ï¼ˆw=4ï¼‰ï¼Œjä»11åˆ°4å€’åº</strong>ï¼šæ›´æ–°åï¼šdp = [0,0,2,2,4,4,6,7,7,9,9,11]</p>
<ul>
<li>j=11ï¼šmax(9, dp[7]+4)=max(9,7+4)=11ï¼›</li>
<li>j=10ï¼šmax(9, dp[6]+4)=max(9,2+4)=9ï¼›</li>
<li>j=9ï¼šmax(9, dp[5]+4)=max(9,2+4)=9ï¼›</li>
<li>j=8ï¼šmax(7, dp[4]+4)=max(7,2+4)=7ï¼›</li>
<li>j=7ï¼šmax(7, dp[3]+4)=max(7,2+4)=7ï¼›</li>
<li>j=6ï¼šmax(2, dp[2]+4)=max(2,2+4)=6ï¼›</li>
<li>j=5ï¼šmax(2, dp[1]+4)=max(2,0+4)=4ï¼›</li>
<li>j=4ï¼šmax(2, dp[0]+4)=max(2,0+4)=4ï¼›</li>
</ul>
</li>
<li>
<p><strong>å¤„ç†çŸ³å¤´4ï¼ˆw=1ï¼‰ï¼Œjä»11åˆ°1å€’åº</strong>ï¼šæ›´æ–°åï¼šdp = [0,1,2,3,4,5,6,7,8,9,10,11]</p>
<ul>
<li>j=11ï¼šmax(11, dp[10]+1)=max(11,9+1)=11ï¼›</li>
<li>j=10ï¼šmax(9, dp[9]+1)=max(9,9+1)=10ï¼›</li>
<li>...ï¼ˆå…¶ä»–ä½ç½®ç±»ä¼¼æ›´æ–°ï¼‰ï¼›</li>
</ul>
</li>
<li>
<p><strong>å¤„ç†çŸ³å¤´5ï¼ˆw=8ï¼‰ï¼Œjä»11åˆ°8å€’åº</strong>ï¼šæ›´æ–°åï¼šdp = [0,1,2,3,4,5,6,7,8,9,10,11]</p>
<ul>
<li>j=11ï¼šmax(11, dp[3]+8)=max(11,3+8)=11ï¼›</li>
<li>j=10ï¼šmax(10, dp[2]+8)=max(10,2+8)=10ï¼›</li>
<li>j=9ï¼šmax(9, dp[1]+8)=max(9,1+8)=9ï¼›</li>
<li>j=8ï¼šmax(8, dp[0]+8)=max(8,0+8)=8ï¼›</li>
</ul>
</li>
<li>
<p><strong>å¤„ç†çŸ³å¤´6ï¼ˆw=1ï¼‰ï¼Œjä»11åˆ°1å€’åº</strong>ï¼šæœ€ç»ˆï¼šdp = [0,1,2,3,4,5,6,7,8,9,10,11]</p>
</li>
</ol>
<p>æœ€ç»ˆå•è¡Œè¡¨æ ¼<code>dp[11] = 11</code>ï¼Œå‰©ä½™é‡é‡ = 23 - 2*11 = 1ï¼Œä¸é¢„æœŸç»“æœä¸€è‡´ã€‚</p>
<h4 data-id="heading-21">3.3.6 æœ€åä¸€å—çŸ³å¤´çš„é‡é‡IIå®Œæ•´ä»£ç ï¼ˆä¸€ç»´DPï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * æœ€åä¸€å—çŸ³å¤´çš„é‡é‡IIï¼ˆä¸€ç»´DPè§£æ³•ï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">stones</span> - çŸ³å¤´é‡é‡æ•°ç»„
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} - æœ€åå‰©ä½™çŸ³å¤´çš„æœ€å°å¯èƒ½é‡é‡
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">lastStoneWeightII</span>(<span class="hljs-params">stones</span>) {
  <span class="hljs-keyword">const</span> sum = stones.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a + b, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> target = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(sum / <span class="hljs-number">2</span>);
  <span class="hljs-comment">// åˆå§‹åŒ–ä¸€ç»´dpæ•°ç»„ï¼šdp[j]è¡¨ç¤ºå®¹é‡ä¸ºjçš„èƒŒåŒ…èƒ½å®¹çº³çš„æœ€å¤§é‡é‡</span>
  <span class="hljs-keyword">const</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(target + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>);

  <span class="hljs-comment">// éå†é¡ºåºï¼šå…ˆéå†çŸ³å¤´ï¼Œå†å€’åºéå†å®¹é‡</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> stone <span class="hljs-keyword">of</span> stones) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = target; j &gt;= stone; j--) {
      dp[j] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(dp[j], dp[j - stone] + stone);
    }
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å¤„ç†å®ŒçŸ³å¤´<span class="hljs-subst">${stone}</span>åï¼Œdpæ•°ç»„ï¼š`</span>, [...dp]);
  }

  <span class="hljs-comment">// å‰©ä½™é‡é‡ = æ€»é‡é‡ - 2*æœ€å¤§å­é›†é‡é‡</span>
  <span class="hljs-keyword">return</span> sum - <span class="hljs-number">2</span> * dp[target];
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-keyword">const</span> stones = [<span class="hljs-number">2</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>];
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æœ€åå‰©ä½™çŸ³å¤´çš„æœ€å°é‡é‡ï¼š'</span>, <span class="hljs-title function_">lastStoneWeightII</span>(stones)); <span class="hljs-comment">// è¾“å‡ºï¼š1</span>
</code></pre>
<h3 data-id="heading-22">3.4 å˜å½¢4ï¼šä¸€å’Œé›¶ï¼ˆäºŒç»´èƒŒåŒ…å®¹é‡ï¼‰</h3>
<p><strong>LeetCode é“¾æ¥</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fones-and-zeroes%2F" target="_blank" title="https://leetcode.cn/problems/ones-and-zeroes/" ref="nofollow noopener noreferrer">474. ä¸€å’Œé›¶</a></p>
<p><strong>é—®é¢˜æè¿°</strong>ï¼šç»™ä½ ä¸€ä¸ªäºŒè¿›åˆ¶å­—ç¬¦ä¸²æ•°ç»„<code>strs</code>å’Œä¸¤ä¸ªæ•´æ•°<code>m</code>å’Œ<code>n</code>ã€‚è¯·ä½ æ‰¾å‡ºå¹¶è¿”å›<code>strs</code>çš„æœ€å¤§å­é›†çš„é•¿åº¦ï¼Œè¯¥å­é›†ä¸­æœ€å¤šæœ‰<code>m</code>ä¸ª0å’Œ<code>n</code>ä¸ª1ã€‚</p>
<p>æ ¸å¿ƒè½¬åŒ–ï¼šæ¯ä¸ªå­—ç¬¦ä¸²æ˜¯ä¸€ä¸ª"ç‰©å“"ï¼Œé€‰æ‹©è¯¥ç‰©å“ä¼šæ¶ˆè€—"0çš„æ•°é‡"å’Œ"1çš„æ•°é‡"ä¸¤ç§å®¹é‡ï¼Œç›®æ ‡æ˜¯åœ¨ä¸¤ç§å®¹é‡å‡ä¸è¶…è¿‡é™åˆ¶ï¼ˆmã€nï¼‰çš„å‰æä¸‹ï¼Œé€‰æ‹©æœ€å¤šçš„ç‰©å“â€”â€”è¿™æ˜¯ã€ŒäºŒç»´å®¹é‡01èƒŒåŒ…æ±‚æœ€å¤§ç‰©å“æ•°ã€çš„åœºæ™¯ï¼ˆèƒŒåŒ…æœ‰ä¸¤ä¸ªç»´åº¦çš„å®¹é‡é™åˆ¶ï¼Œä»·å€¼ä¸º1ï¼Œæ±‚æœ€å¤§ä»·å€¼å³æœ€å¤§ç‰©å“æ•°ï¼‰ã€‚</p>
<p>ä¸€å’Œé›¶é—®é¢˜æ ¸å¿ƒè¡¨æ ¼ï¼ˆç©ºè¡¨ï¼Œåç»­é€æ­¥å¡«å……ï¼‰ï¼š</p>













































<table><thead><tr><th>0çš„æ•°é‡\1çš„æ•°é‡j</th><th>0</th><th>1</th><th>2</th><th>...ï¼ˆ1çš„æ•°é‡é€’å¢ï¼‰</th><th>nï¼ˆæœ€å¤§1çš„æ•°é‡ï¼‰</th></tr></thead><tbody><tr><td>0ï¼ˆ0çš„æ•°é‡ä¸º0ï¼‰</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td></tr><tr><td>1ï¼ˆ0çš„æ•°é‡ä¸º1ï¼‰</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td></tr><tr><td>...ï¼ˆ0çš„æ•°é‡é€’å¢ï¼‰</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td></tr><tr><td>mï¼ˆæœ€å¤§0çš„æ•°é‡ï¼‰</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……ï¼ˆæœ€ç»ˆç­”æ¡ˆï¼šæœ€å¤šå­—ç¬¦ä¸²æ•°é‡ï¼‰</td></tr></tbody></table>
<p>è¡¨æ ¼è¯´æ˜ï¼šè¡¨æ ¼ä¸­æ¯ä¸ªå•å…ƒæ ¼<code>dp[i][j]</code>ä»£è¡¨ã€Œæœ€å¤šä½¿ç”¨iä¸ª0å’Œjä¸ª1æ—¶ï¼Œèƒ½é€‰æ‹©çš„æœ€å¤§å­—ç¬¦ä¸²æ•°é‡ã€ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æŒ‰è§„åˆ™å¡«å……è¡¨æ ¼ï¼Œæœ€ç»ˆå³ä¸‹è§’<code>dp[m][n]</code>å³ä¸ºä¸€å’Œé›¶é—®é¢˜çš„ç­”æ¡ˆã€‚</p>
<h4 data-id="heading-23">3.4.1 æ­¥éª¤1ï¼šç¡®å®šdpæ•°ç»„åŠä¸‹æ ‡çš„å«ä¹‰</h4>
<p>å®šä¹‰äºŒç»´æ•°ç»„<code>dp[i][j]</code>ï¼šè¡¨ç¤ºã€Œæœ€å¤šç”¨iä¸ª0å’Œjä¸ª1èƒ½é€‰æ‹©çš„æœ€å¤§å­—ç¬¦ä¸²æ•°é‡ã€ã€‚</p>
<p>å¯¹åº”è¡¨æ ¼ç»´åº¦ï¼šiï¼ˆè¡Œï¼‰è¡¨ç¤º0çš„æ•°é‡ï¼ˆä»0åˆ°mï¼Œ0ä»£è¡¨0ä¸ª0ï¼‰ï¼Œjï¼ˆåˆ—ï¼‰è¡¨ç¤º1çš„æ•°é‡ï¼ˆä»0åˆ°nï¼Œ0ä»£è¡¨0ä¸ª1ï¼‰ï¼Œè¡¨æ ¼å…±m+1è¡Œã€n+1åˆ—ã€‚</p>
<h4 data-id="heading-24">3.4.2 æ­¥éª¤2ï¼šç¡®å®šé€’æ¨å…¬å¼</h4>
<p>å¯¹äºæ¯ä¸ªå­—ç¬¦ä¸²ï¼ˆå«zeroä¸ª0ã€oneä¸ª1ï¼‰ï¼Œæœ‰ä¸¤ç§æ ¸å¿ƒå†³ç­–ï¼šé€‰æˆ–ä¸é€‰ã€‚</p>
<ol>
<li>
<p><strong>ä¸é€‰å½“å‰å­—ç¬¦ä¸²</strong>ï¼šæœ€å¤šç”¨iä¸ª0å’Œjä¸ª1çš„æœ€å¤§å­—ç¬¦ä¸²æ•°é‡ = ä¸é€‰å½“å‰å­—ç¬¦ä¸²æ—¶çš„æœ€å¤§æ•°é‡ï¼Œå³<code>dp[i][j] = dp[i][j]</code>ï¼ˆä¿æŒä¸å˜ï¼‰ï¼›</p>
</li>
<li>
<p><strong>é€‰å½“å‰å­—ç¬¦ä¸²</strong>ï¼šéœ€ä¿è¯i â‰¥ zeroä¸”j â‰¥ oneï¼ˆ0å’Œ1çš„æ•°é‡éƒ½è¶³å¤Ÿï¼‰ï¼Œæ­¤æ—¶æœ€å¤§æ•°é‡ = ç”¨i-zeroä¸ª0å’Œj-oneä¸ª1çš„æœ€å¤§æ•°é‡ + 1ï¼ˆå½“å‰å­—ç¬¦ä¸²ï¼‰ï¼Œå³<code>dp[i][j] = dp[i - zero][j - one] + 1</code>ã€‚</p>
</li>
</ol>
<p>æœ€ç»ˆé€’æ¨å…¬å¼ï¼ˆå–ä¸¤ç§å†³ç­–çš„æœ€å¤§å€¼ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">if</span> (i &gt;= zero &amp;&amp; j &gt;= one) {
  dp[i][j] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(dp[i][j], dp[i - zero][j - one] + <span class="hljs-number">1</span>);
} <span class="hljs-keyword">else</span> {
  dp[i][j] = dp[i][j]; <span class="hljs-comment">// å®¹é‡ä¸è¶³ï¼Œæ— æ³•é€‰</span>
}
</code></pre>
<p>ç®€åŒ–åï¼ˆå› ä¸ºå®¹é‡ä¸è¶³æ—¶dp[i][j]ä¸å˜ï¼Œä¸”ä½¿ç”¨å€’åºéå†ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = m; i &gt;= zero; i--) {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = n; j &gt;= one; j--) {
    dp[i][j] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(dp[i][j], dp[i - zero][j - one] + <span class="hljs-number">1</span>);
  }
}
</code></pre>
<h4 data-id="heading-25">3.4.3 æ­¥éª¤3ï¼šdpæ•°ç»„å¦‚ä½•åˆå§‹åŒ–</h4>
<p>åˆå§‹åŒ–é€»è¾‘ï¼šåˆå§‹æ— å­—ç¬¦ä¸²å¯é€‰ï¼Œæ— è®ºæœ‰å¤šå°‘0å’Œ1ï¼Œæœ€å¤§å­—ç¬¦ä¸²æ•°é‡éƒ½ä¸º0ï¼Œå› æ­¤<code>dp[i][j] = 0</code>ï¼ˆæ‰€æœ‰å•å…ƒæ ¼åˆå§‹åŒ–ä¸º0ï¼‰ï¼Œå³<code>dp = new Array(m+1).fill(0).map(() =&gt; new Array(n+1).fill(0))</code>ã€‚</p>
<p>åˆå§‹åŒ–åçš„è¡¨æ ¼ï¼ˆæ‰€æœ‰å•å…ƒæ ¼ä¸º0ï¼‰ï¼š</p>













































<table><thead><tr><th>0çš„æ•°é‡\1çš„æ•°é‡j</th><th>0</th><th>1</th><th>2</th><th>...</th><th>n</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>...</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>m</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr></tbody></table>
<p>ç»“åˆç¤ºä¾‹ç†è§£ï¼šå‡è®¾strs = ["10","0001","111001","1","0"]ï¼Œm = 5ï¼Œn = 3ã€‚åˆå§‹åŒ–åçš„è¡¨æ ¼ï¼ˆ5+1è¡Œï¼Œ3+1åˆ—ï¼‰ï¼š</p>






















































<table><thead><tr><th>0çš„æ•°é‡\1çš„æ•°é‡j</th><th>0</th><th>1</th><th>2</th><th>3</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>2</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>3</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>4</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>5</td><td>0</td><td>0</td><td>0</td><td>0</td></tr></tbody></table>
<h4 data-id="heading-26">3.4.4 æ­¥éª¤4ï¼šç¡®å®šéå†é¡ºåºï¼ˆè¡¨æ ¼å¡«å……é¡ºåºï¼‰</h4>
<p>äºŒç»´å®¹é‡01èƒŒåŒ…çš„éå†é¡ºåºæœ‰ä¸¥æ ¼è¦æ±‚ï¼š</p>
<ol>
<li>
<p><strong>å¿…é¡»å…ˆéå†å­—ç¬¦ä¸²ï¼ˆç‰©å“ï¼‰ï¼Œå†éå†0çš„æ•°é‡ï¼Œæœ€åéå†1çš„æ•°é‡</strong>ï¼šé€ä¸ªå¤„ç†æ¯ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯æ¬¡å¤„ç†æ—¶æ›´æ–°æ•´ä¸ªäºŒç»´è¡¨æ ¼ï¼›</p>
</li>
<li>
<p><strong>0å’Œ1çš„æ•°é‡éƒ½å¿…é¡»å€’åºéå†</strong>ï¼š</p>
<ul>
<li>0çš„æ•°é‡å€’åºéå†ï¼ˆiä»måˆ°zeroï¼‰ï¼šç¡®ä¿è®¡ç®—<code>dp[i][j]</code>æ—¶ï¼Œ<code>dp[i - zero][j - one]</code>ä»æ˜¯ä¸Šä¸€è½®ï¼ˆæœªå¤„ç†å½“å‰å­—ç¬¦ä¸²ï¼‰çš„æ—§å€¼ï¼›</li>
<li>1çš„æ•°é‡å€’åºéå†ï¼ˆjä»nåˆ°oneï¼‰ï¼šåŒæ ·ç¡®ä¿ä¾èµ–çš„å•å…ƒæ ¼æ˜¯æ—§å€¼ã€‚</li>
</ul>
</li>
</ol>
<p>å€’åºéå†é¿å…åŒä¸€å­—ç¬¦ä¸²è¢«å¤šæ¬¡é€‰æ‹©ï¼Œå®Œç¾å¥‘åˆ01èƒŒåŒ…ã€Œæ¯ä¸ªç‰©å“é€‰ä¸€æ¬¡ã€çš„è§„åˆ™ã€‚</p>
<h4 data-id="heading-27">3.4.5 æ­¥éª¤5ï¼šæ‰“å°dpæ•°ç»„ï¼ˆéªŒè¯ï¼‰</h4>
<p>ä»¥ç¤ºä¾‹<code>strs = ["10","0001","111001","1","0"]</code>ã€<code>m = 5</code>ã€<code>n = 3</code>ä¸ºä¾‹ï¼Œé€æ­¥å¡«å……è¡¨æ ¼éªŒè¯é€»è¾‘ï¼š</p>
<ol>
<li>
<p><strong>å¤„ç†å­—ç¬¦ä¸²1ï¼ˆ"10"ï¼šzero=1, one=1ï¼‰</strong>ï¼š</p>
<ul>
<li>æ›´æ–°dp[1][1]åˆ°dp[5][3]èŒƒå›´å†…æ‰€æœ‰æ»¡è¶³iâ‰¥1ä¸”jâ‰¥1çš„ä½ç½®</li>
<li>dp[1][1] = max(0, dp[0][0]+1) = max(0,0+1) = 1</li>
<li>dp[2][2] = max(0, dp[1][1]+1) = max(0,1+1) = 2</li>
<li>...ï¼ˆå…¶ä»–ä½ç½®ç±»ä¼¼ï¼‰</li>
</ul>
</li>
<li>
<p><strong>å¤„ç†å­—ç¬¦ä¸²2ï¼ˆ"0001"ï¼šzero=3, one=1ï¼‰</strong>ï¼š</p>
<ul>
<li>æ›´æ–°dp[3][1]åˆ°dp[5][3]èŒƒå›´å†…æ‰€æœ‰æ»¡è¶³iâ‰¥3ä¸”jâ‰¥1çš„ä½ç½®</li>
<li>dp[3][1] = max(dp[3][1], dp[0][0]+1) = max(0,0+1) = 1</li>
<li>dp[4][2] = max(dp[4][2], dp[1][1]+1) = max(0,1+1) = 2</li>
<li>...ï¼ˆå…¶ä»–ä½ç½®ç±»ä¼¼ï¼‰</li>
</ul>
</li>
<li>
<p><strong>å¤„ç†å­—ç¬¦ä¸²3ï¼ˆ"111001"ï¼šzero=2, one=4ï¼‰</strong>ï¼š</p>
<ul>
<li>ç”±äºone=4 &gt; n=3ï¼Œæ— æ³•é€‰æ‹©æ­¤å­—ç¬¦ä¸²ï¼Œdpæ•°ç»„ä¸å˜</li>
</ul>
</li>
<li>
<p><strong>å¤„ç†å­—ç¬¦ä¸²4ï¼ˆ"1"ï¼šzero=0, one=1ï¼‰</strong>ï¼š</p>
<ul>
<li>æ›´æ–°dp[0][1]åˆ°dp[5][3]èŒƒå›´å†…æ‰€æœ‰æ»¡è¶³jâ‰¥1çš„ä½ç½®</li>
<li>dp[0][1] = max(0, dp[0][0]+1) = max(0,0+1) = 1</li>
<li>dp[1][2] = max(dp[1][2], dp[1][1]+1) = max(0,1+1) = 2</li>
<li>...ï¼ˆå…¶ä»–ä½ç½®ç±»ä¼¼ï¼‰</li>
</ul>
</li>
<li>
<p><strong>å¤„ç†å­—ç¬¦ä¸²5ï¼ˆ"0"ï¼šzero=1, one=0ï¼‰</strong>ï¼š</p>
<ul>
<li>æ›´æ–°dp[1][0]åˆ°dp[5][3]èŒƒå›´å†…æ‰€æœ‰æ»¡è¶³iâ‰¥1çš„ä½ç½®</li>
<li>dp[1][0] = max(0, dp[0][0]+1) = max(0,0+1) = 1</li>
<li>dp[2][1] = max(dp[2][1], dp[1][1]+1) = max(0,1+1) = 2</li>
<li>...ï¼ˆå…¶ä»–ä½ç½®ç±»ä¼¼ï¼‰</li>
</ul>
</li>
</ol>
<p>æœ€ç»ˆå¡«å……å®Œæˆçš„è¡¨æ ¼ï¼ˆç®€åŒ–å±•ç¤ºå…³é”®éƒ¨åˆ†ï¼‰ï¼š</p>






















































<table><thead><tr><th>0çš„æ•°é‡\1çš„æ•°é‡j</th><th>0</th><th>1</th><th>2</th><th>3</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td>1</td><td>1</td><td>2</td><td>2</td><td>2</td></tr><tr><td>2</td><td>1</td><td>2</td><td>3</td><td>3</td></tr><tr><td>3</td><td>1</td><td>2</td><td>3</td><td>3</td></tr><tr><td>4</td><td>1</td><td>2</td><td>3</td><td>4</td></tr><tr><td>5</td><td>1</td><td>2</td><td>3</td><td>4</td></tr></tbody></table>
<p>è¡¨æ ¼å³ä¸‹è§’<code>dp[5][3] = 4</code>ï¼Œå³è¯¥ç¤ºä¾‹çš„æœ€å¤§å­é›†é•¿åº¦ä¸º4ï¼Œä¸é¢„æœŸç»“æœä¸€è‡´ã€‚</p>
<h4 data-id="heading-28">3.4.6 ä¸€å’Œé›¶å®Œæ•´ä»£ç ï¼ˆäºŒç»´DPï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * ä¸€å’Œé›¶ï¼ˆäºŒç»´DPè§£æ³•ï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string[]</span>} <span class="hljs-variable">strs</span> - äºŒè¿›åˆ¶å­—ç¬¦ä¸²æ•°ç»„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">m</span> - æœ€å¤šå…è®¸çš„0çš„æ•°é‡
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">n</span> - æœ€å¤šå…è®¸çš„1çš„æ•°é‡
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} - æœ€å¤§å­é›†é•¿åº¦
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">findMaxForm</span>(<span class="hljs-params">strs, m, n</span>) {
  <span class="hljs-comment">// åˆå§‹åŒ–äºŒç»´dpæ•°ç»„ï¼šdp[i][j]è¡¨ç¤ºiä¸ª0å’Œjä¸ª1èƒ½é€‰çš„æœ€å¤§å­—ç¬¦ä¸²æ•°</span>
  <span class="hljs-keyword">const</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(m + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(n + <span class="hljs-number">1</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>));

  <span class="hljs-comment">// éå†æ¯ä¸ªå­—ç¬¦ä¸²ï¼ˆç‰©å“ï¼‰</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> str <span class="hljs-keyword">of</span> strs) {
    <span class="hljs-comment">// ç»Ÿè®¡å½“å‰å­—ç¬¦ä¸²çš„0å’Œ1çš„æ•°é‡</span>
    <span class="hljs-keyword">let</span> zero = <span class="hljs-number">0</span>,
      one = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> c <span class="hljs-keyword">of</span> str) {
      c === <span class="hljs-string">'0'</span> ? zero++ : one++;
    }

    <span class="hljs-comment">// å€’åºéå†0çš„æ•°é‡ï¼Œå†å€’åºéå†1çš„æ•°é‡ï¼ˆé¿å…é‡å¤é€‰æ‹©ï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = m; i &gt;= zero; i--) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = n; j &gt;= one; j--) {
        dp[i][j] = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(dp[i][j], dp[i - zero][j - one] + <span class="hljs-number">1</span>);
      }
    }

    <span class="hljs-comment">// æ‰“å°æ¯æ¬¡å¤„ç†åçš„dpæ•°ç»„ï¼ˆç®€åŒ–æ‰“å°ï¼Œåªæ‰“å°éƒ¨åˆ†å…³é”®è¡Œï¼‰</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å¤„ç†å®Œå­—ç¬¦ä¸²"<span class="hljs-subst">${str}</span>"åï¼Œdpæ•°ç»„ï¼ˆå‰5è¡Œå‰5åˆ—ï¼‰ï¼š`</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(m, <span class="hljs-number">5</span>); i++) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dp[i].<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(n, <span class="hljs-number">5</span>)).<span class="hljs-title function_">join</span>(<span class="hljs-string">'\t'</span>));
    }
  }

  <span class="hljs-keyword">return</span> dp[m][n];
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-keyword">const</span> strs = [<span class="hljs-string">'10'</span>, <span class="hljs-string">'0001'</span>, <span class="hljs-string">'111001'</span>, <span class="hljs-string">'1'</span>, <span class="hljs-string">'0'</span>];
<span class="hljs-keyword">const</span> m = <span class="hljs-number">5</span>,
  n = <span class="hljs-number">3</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æœ€å¤§å­é›†é•¿åº¦ï¼š'</span>, <span class="hljs-title function_">findMaxForm</span>(strs, m, n)); <span class="hljs-comment">// è¾“å‡ºï¼š4</span>
</code></pre>
<h2 data-id="heading-29">å››ã€01èƒŒåŒ…é—®é¢˜æ€»ç»“</h2>
<p>01èƒŒåŒ…çš„æ ¸å¿ƒæ˜¯ã€Œé€‰æˆ–ä¸é€‰ã€çš„äºŒé€‰ä¸€å†³ç­–ï¼Œæ‰€æœ‰å˜å½¢éƒ½å›´ç»•è¿™ä¸€æ ¸å¿ƒé€»è¾‘ï¼Œé€šè¿‡è½¬åŒ–ã€Œç‰©å“ã€ã€Œå®¹é‡ã€ã€Œç›®æ ‡ã€çš„å«ä¹‰ï¼Œé€‚é…ä¸åŒçš„å®é™…åœºæ™¯ã€‚æŒæ¡ä»¥ä¸‹å…³é”®ç‚¹ï¼Œå¯è½»æ¾ç ´è§£æ‰€æœ‰01èƒŒåŒ…ç›¸å…³é—®é¢˜ï¼š</p>
<ol>
<li>
<p><strong>è¡¨æ ¼å¯è§†åŒ–æ ¸å¿ƒ</strong>ï¼šDPè§£é¢˜çš„æœ¬è´¨æ˜¯å¡«å……è¡¨æ ¼ï¼Œå…ˆæ˜ç¡®è¡¨æ ¼å½¢æ€ï¼ˆdpæ•°ç»„å«ä¹‰ï¼‰ï¼Œå†æŒ‰è§„åˆ™å¡«å……ï¼Œè¡¨æ ¼å¡«å®Œå³å¾—ç­”æ¡ˆï¼›</p>
</li>
<li>
<p><strong>5æ­¥ä¸‡èƒ½é’¥åŒ™</strong>ï¼šç¡®å®šdpå«ä¹‰â†’é€’æ¨å…¬å¼â†’åˆå§‹åŒ–â†’éå†é¡ºåºâ†’éªŒè¯ï¼Œè¿™æ˜¯æ‰€æœ‰DPé—®é¢˜çš„é€šç”¨æ‹†è§£æ€è·¯ï¼Œå°¤å…¶é€‚ç”¨äºèƒŒåŒ…é—®é¢˜ï¼›</p>
</li>
<li>
<p><strong>ç©ºé—´ä¼˜åŒ–æŠ€å·§</strong>ï¼šäºŒç»´DPå¯é€šè¿‡ã€Œå€’åºéå†å®¹é‡ã€ä¼˜åŒ–ä¸ºä¸€ç»´DPï¼Œæ ¸å¿ƒæ˜¯å¤ç”¨æ•°ç»„ç©ºé—´ï¼Œé¿å…é‡å¤é€‰æ‹©ç‰©å“ï¼›</p>
</li>
<li>
<p><strong>å˜å½¢è½¬åŒ–é€»è¾‘</strong>ï¼šæ— è®ºåœºæ™¯å¦‚ä½•å˜åŒ–ï¼Œåªè¦æ¯ä¸ªç‰©å“æœ€å¤šé€‰ä¸€æ¬¡ï¼Œéƒ½å¯è½¬åŒ–ä¸º01èƒŒåŒ…æ¨¡å‹â€”â€”å…³é”®æ˜¯æ‰¾åˆ°ã€Œç‰©å“ã€ï¼ˆå¾…é€‰æ‹©çš„å…ƒç´ /å­—ç¬¦ä¸²ç­‰ï¼‰ã€ã€Œå®¹é‡ã€ï¼ˆé™åˆ¶æ¡ä»¶ï¼Œå¦‚é‡é‡ã€å’Œã€0/1æ•°é‡ç­‰ï¼‰ã€ã€Œç›®æ ‡ã€ï¼ˆæœ€å¤§ä»·å€¼ã€å¯è¡Œæ€§ã€æ–¹æ¡ˆæ•°ç­‰ï¼‰ã€‚</p>
</li>
</ol>
<p>é€šè¿‡åŸºç¡€æ¨¡å‹+å˜å½¢ç»ƒä¹ ï¼Œç†Ÿç»ƒæŒæ¡è¡¨æ ¼å¡«å……é€»è¾‘å’Œ5æ­¥æ‹†è§£æ–¹æ³•ï¼Œå°±èƒ½å°†å¤æ‚çš„DPé—®é¢˜è½¬åŒ–ä¸ºæœ‰åºçš„è¡¨æ ¼å¡«å……è¿‡ç¨‹ï¼Œå½»åº•æ”»å…‹01èƒŒåŒ…è¿™ä¸€DPæ ¸å¿ƒæ¨¡å‹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ”¥Vue3 åŠ¨æ€ç»„ä»¶â€˜componentâ€™å…¨è§£æ]]></title>    <link>https://juejin.cn/post/7591697558377955370</link>    <guid>https://juejin.cn/post/7591697558377955370</guid>    <pubDate>2026-01-06T02:48:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591697558377955370" data-draft-id="7591730714141179946" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ”¥Vue3 åŠ¨æ€ç»„ä»¶â€˜componentâ€™å…¨è§£æ"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-06T02:48:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸æƒ³ç§ƒå¤´çš„ç¨‹åºå‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/2754702534251820"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ”¥Vue3 åŠ¨æ€ç»„ä»¶â€˜componentâ€™å…¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2754702534251820/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸æƒ³ç§ƒå¤´çš„ç¨‹åºå‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T02:48:00.000Z" title="Tue Jan 06 2026 02:48:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Vue3 å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°éœ€è¦æ ¹æ®ä¸åŒçŠ¶æ€åˆ‡æ¢ä¸åŒç»„ä»¶çš„åœºæ™¯ â€”â€” æ¯”å¦‚è¡¨å•çš„æ­¥éª¤åˆ‡æ¢ã€Tab æ ‡ç­¾é¡µã€æƒé™æ§åˆ¶ä¸‹çš„ç»„ä»¶æ¸²æŸ“ç­‰ã€‚å¦‚æœç”¨ <code>v-if/v-else</code> é€ä¸ªåˆ¤æ–­ï¼Œä»£ç ä¼šå˜å¾—å†—ä½™ä¸”éš¾ä»¥ç»´æŠ¤ã€‚è€Œ Vue æä¾›çš„<strong>åŠ¨æ€ç»„ä»¶</strong>ç‰¹æ€§ï¼Œèƒ½è®©æˆ‘ä»¬ä»¥æ›´ä¼˜é›…çš„æ–¹å¼å®ç°ç»„ä»¶çš„åŠ¨æ€åˆ‡æ¢ï¼Œå¤§å¹…æå‡ä»£ç çš„çµæ´»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
<p>æœ¬æ–‡å°†ä»åŸºç¡€åˆ°è¿›é˜¶ï¼Œå…¨é¢è®²è§£ Vue3 ä¸­åŠ¨æ€ç»„ä»¶çš„ä½¿ç”¨æ–¹æ³•ã€æ ¸å¿ƒç‰¹æ€§ã€é¿å‘æŒ‡å—å’Œå®æˆ˜åœºæ™¯ï¼Œå¸®åŠ©ä½ å½»åº•æŒæ¡è¿™ä¸€é«˜é¢‘ä½¿ç”¨æŠ€å·§ã€‚</p>
<h2 data-id="heading-0">ğŸ“š ä»€ä¹ˆæ˜¯åŠ¨æ€ç»„ä»¶ï¼Ÿ</h2>
<p>åŠ¨æ€ç»„ä»¶æ˜¯ Vue å†…ç½®çš„ä¸€ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼Œé€šè¿‡ <code>&lt;component&gt;</code> å†…ç½®ç»„ä»¶å’Œ <code>is</code> å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åŠ¨æ€ç»‘å®šå¹¶æ¸²æŸ“ä¸åŒçš„ç»„ä»¶ï¼Œæ— éœ€æ‰‹åŠ¨ç¼–å†™å¤§é‡çš„æ¡ä»¶åˆ¤æ–­ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼š<strong>ä½ åªéœ€è¦å‘Šè¯‰ Vue è¦æ¸²æŸ“å“ªä¸ªç»„ä»¶ï¼Œå®ƒå°±ä¼šè‡ªåŠ¨å¸®ä½ å®Œæˆç»„ä»¶çš„åˆ‡æ¢</strong>ã€‚</p>
<h2 data-id="heading-1">ğŸš€ åŸºç¡€ç”¨æ³•ï¼šå¿«é€Ÿå®ç°ç»„ä»¶åˆ‡æ¢</h2>
<h3 data-id="heading-2">1. åŸºæœ¬è¯­æ³•</h3>
<p>åŠ¨æ€ç»„ä»¶çš„æ ¸å¿ƒæ˜¯ <code>&lt;component&gt;</code> æ ‡ç­¾å’Œ <code>is</code> å±æ€§ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;template&gt;
  &lt;!-- åŠ¨æ€ç»„ä»¶ï¼šis å±æ€§ç»‘å®šè¦æ¸²æŸ“çš„ç»„ä»¶ --&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentComponent"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-comment">// å¯¼å…¥éœ€è¦åˆ‡æ¢çš„ç»„ä»¶</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ComponentA</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./ComponentA.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ComponentB</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./ComponentB.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ComponentC</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./ComponentC.vue'</span>

<span class="hljs-comment">// å®šä¹‰å½“å‰è¦æ¸²æŸ“çš„ç»„ä»¶</span>
<span class="hljs-keyword">const</span> currentComponent = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'ComponentA'</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h3 data-id="heading-3">2. å®Œæ•´ç¤ºä¾‹ï¼šTab æ ‡ç­¾é¡µ</h3>
<p>ä¸‹é¢å®ç°ä¸€ä¸ªæœ€å¸¸è§çš„ Tab åˆ‡æ¢åœºæ™¯ï¼Œç›´è§‚æ„Ÿå—åŠ¨æ€ç»„ä»¶çš„ç”¨æ³•ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tab-container"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- Tab åˆ‡æ¢æŒ‰é’® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tab-buttons"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
        <span class="hljs-attr">v-for</span>=<span class="hljs-string">"tab in tabs"</span> 
        <span class="hljs-attr">:key</span>=<span class="hljs-string">"tab.name"</span>
        <span class="hljs-attr">:class</span>=<span class="hljs-string">"{ active: currentTab === tab.name }"</span>
        @<span class="hljs-attr">click</span>=<span class="hljs-string">"currentTab = tab.name"</span>
      &gt;</span>
        {{ tab.label }}
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- åŠ¨æ€ç»„ä»¶æ ¸å¿ƒ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tab-content"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentTabComponent"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref, computed } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-comment">// å¯¼å…¥å­ç»„ä»¶</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Home</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./Home.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Profile</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./Profile.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Settings</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./Settings.vue'</span>

<span class="hljs-comment">// å®šä¹‰ Tab é…ç½®</span>
<span class="hljs-keyword">const</span> tabs = [
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'Home'</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">'é¦–é¡µ'</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'Profile'</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">'ä¸ªäººä¸­å¿ƒ'</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'Settings'</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">'è®¾ç½®'</span> }
]

<span class="hljs-comment">// å½“å‰æ¿€æ´»çš„ Tab</span>
<span class="hljs-keyword">const</span> currentTab = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'Home'</span>)

<span class="hljs-comment">// è®¡ç®—å±æ€§ï¼šæ ¹æ®å½“å‰ Tab åŒ¹é…å¯¹åº”ç»„ä»¶</span>
<span class="hljs-keyword">const</span> currentTabComponent = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">switch</span> (currentTab.<span class="hljs-property">value</span>) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'Home'</span>: <span class="hljs-keyword">return</span> <span class="hljs-title class_">Home</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">'Profile'</span>: <span class="hljs-keyword">return</span> <span class="hljs-title class_">Profile</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">'Settings'</span>: <span class="hljs-keyword">return</span> <span class="hljs-title class_">Settings</span>
    <span class="hljs-attr">default</span>: <span class="hljs-keyword">return</span> <span class="hljs-title class_">Home</span>
  }
})
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.tab-container</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">400px</span>;
  <span class="hljs-attribute">margin</span>: <span class="hljs-number">20px</span> auto;
}
<span class="hljs-selector-class">.tab-buttons</span> {
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">gap</span>: <span class="hljs-number">4px</span>;
}
<span class="hljs-selector-class">.tab-buttons</span> <span class="hljs-selector-tag">button</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">8px</span> <span class="hljs-number">16px</span>;
  <span class="hljs-attribute">border</span>: none;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span> <span class="hljs-number">4px</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>;
  <span class="hljs-attribute">cursor</span>: pointer;
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#f5f5f5</span>;
}
<span class="hljs-selector-class">.tab-buttons</span> <span class="hljs-selector-tag">button</span><span class="hljs-selector-class">.active</span> {
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#409eff</span>;
  <span class="hljs-attribute">color</span>: white;
}
<span class="hljs-selector-class">.tab-content</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
  <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#e6e6e6</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">0</span> <span class="hljs-number">4px</span> <span class="hljs-number">4px</span> <span class="hljs-number">4px</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>
</code></pre>
<p><strong>å…³é”®ç‚¹è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>is</code> å±æ€§å¯ä»¥ç»‘å®šï¼šç»„ä»¶çš„å¯¼å…¥å¯¹è±¡ã€ç»„ä»¶çš„æ³¨å†Œåç§°ï¼ˆå­—ç¬¦ä¸²ï¼‰ã€å¼‚æ­¥ç»„ä»¶ï¼›</li>
<li>åˆ‡æ¢ <code>currentTab</code> æ—¶ï¼Œ<code>&lt;component&gt;</code> ä¼šè‡ªåŠ¨æ¸²æŸ“å¯¹åº”çš„ç»„ä»¶ï¼Œæ— éœ€æ‰‹åŠ¨æ§åˆ¶ã€‚</li>
</ul>
<h2 data-id="heading-4">âš¡ è¿›é˜¶ç‰¹æ€§ï¼šç¼“å­˜ã€ä¼ å‚ã€å¼‚æ­¥åŠ è½½</h2>
<h3 data-id="heading-5">1. ç»„ä»¶ç¼“å­˜ï¼škeep-alive é¿å…é‡å¤æ¸²æŸ“</h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŠ¨æ€ç»„ä»¶åˆ‡æ¢æ—¶ï¼Œæ—§ç»„ä»¶ä¼šè¢«é”€æ¯ï¼Œæ–°ç»„ä»¶ä¼šé‡æ–°åˆ›å»ºã€‚å¦‚æœç»„ä»¶åŒ…å«è¡¨å•è¾“å…¥ã€è¯·æ±‚æ•°æ®ç­‰é€»è¾‘ï¼Œåˆ‡æ¢æ—¶ä¼šä¸¢å¤±çŠ¶æ€ï¼Œä¸”é‡å¤æ¸²æŸ“å½±å“æ€§èƒ½ã€‚</p>
<p>ä½¿ç”¨ <code>&lt;keep-alive&gt;</code> åŒ…è£¹åŠ¨æ€ç»„ä»¶ï¼Œå¯ä»¥ç¼“å­˜æœªæ¿€æ´»çš„ç»„ä»¶ï¼Œä¿ç•™å…¶çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tab-container"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tab-buttons"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
        <span class="hljs-attr">v-for</span>=<span class="hljs-string">"tab in tabs"</span> 
        <span class="hljs-attr">:key</span>=<span class="hljs-string">"tab.name"</span>
        <span class="hljs-attr">:class</span>=<span class="hljs-string">"{ active: currentTab === tab.name }"</span>
        @<span class="hljs-attr">click</span>=<span class="hljs-string">"currentTab = tab.name"</span>
      &gt;</span>
        {{ tab.label }}
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- ä½¿ç”¨ keep-alive ç¼“å­˜ç»„ä»¶ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"tab-content"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">keep-alive</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentTabComponent"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">keep-alive</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;
</code></pre>
<p><strong>keep-alive é«˜çº§ç”¨æ³•</strong>ï¼š</p>
<ul>
<li><code>include</code>ï¼šä»…ç¼“å­˜æŒ‡å®šåç§°çš„ç»„ä»¶ï¼ˆéœ€ç»„ä»¶å®šä¹‰ <code>name</code> å±æ€§ï¼‰ï¼›</li>
<li><code>exclude</code>ï¼šæ’é™¤ä¸éœ€è¦ç¼“å­˜çš„ç»„ä»¶ï¼›</li>
<li><code>max</code>ï¼šæœ€å¤§ç¼“å­˜æ•°é‡ï¼Œè¶…å‡ºåˆ™é”€æ¯æœ€ä¹…æœªä½¿ç”¨çš„ç»„ä»¶ã€‚</li>
</ul>
<pre><code class="hljs language-js" lang="js">&lt;!-- ä»…ç¼“å­˜ <span class="hljs-title class_">Home</span> å’Œ <span class="hljs-title class_">Profile</span> ç»„ä»¶ --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">keep-alive</span> <span class="hljs-attr">include</span>=<span class="hljs-string">"Home,Profile"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentTabComponent"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">keep-alive</span>&gt;</span></span>

&lt;!-- æ’é™¤ <span class="hljs-title class_">Settings</span> ç»„ä»¶ --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">keep-alive</span> <span class="hljs-attr">exclude</span>=<span class="hljs-string">"Settings"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentTabComponent"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">keep-alive</span>&gt;</span></span>

&lt;!-- æœ€å¤šç¼“å­˜ <span class="hljs-number">2</span> ä¸ªç»„ä»¶ --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">keep-alive</span> <span class="hljs-attr">:max</span>=<span class="hljs-string">"2"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentTabComponent"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">keep-alive</span>&gt;</span></span>
</code></pre>
<h3 data-id="heading-6">2. ç»„ä»¶ä¼ å‚ï¼šå‘åŠ¨æ€ç»„ä»¶ä¼ é€’ props / äº‹ä»¶</h3>
<p>åŠ¨æ€ç»„ä»¶å’Œæ™®é€šç»„ä»¶ä¸€æ ·ï¼Œå¯ä»¥ä¼ é€’ propsã€ç»‘å®šäº‹ä»¶ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">component</span> 
    <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentComponent"</span>
    &lt;!<span class="hljs-attr">--</span> <span class="hljs-attr">ä¼ é€’</span> <span class="hljs-attr">props</span> <span class="hljs-attr">--</span>&gt;</span>
    :user-id="userId"
    :title="pageTitle"
    <span class="hljs-comment">&lt;!-- ç»‘å®šäº‹ä»¶ --&gt;</span>
    @submit="handleSubmit"
    @cancel="handleCancel"
  &gt;<span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">FormA</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./FormA.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">FormB</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./FormB.vue'</span>

<span class="hljs-keyword">const</span> currentComponent = <span class="hljs-title function_">ref</span>(<span class="hljs-title class_">FormA</span>)
<span class="hljs-keyword">const</span> userId = <span class="hljs-title function_">ref</span>(<span class="hljs-number">1001</span>)
<span class="hljs-keyword">const</span> pageTitle = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'ç”¨æˆ·è¡¨å•'</span>)

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSubmit</span> = (<span class="hljs-params">data</span>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æäº¤æ•°æ®ï¼š'</span>, data)
}
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleCancel</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å–æ¶ˆæ“ä½œ'</span>)
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<p>å­ç»„ä»¶æ¥æ”¶ props / äº‹ä»¶ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;!-- <span class="hljs-title class_">FormA</span>.<span class="hljs-property">vue</span> --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{{ title }}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ç”¨æˆ·IDï¼š{{ userId }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"$emit('submit', { id: userId })"</span>&gt;</span>æäº¤<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"$emit('cancel')"</span>&gt;</span>å–æ¶ˆ<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-title function_">defineProps</span>({
  <span class="hljs-attr">userId</span>: <span class="hljs-title class_">Number</span>,
  <span class="hljs-attr">title</span>: <span class="hljs-title class_">String</span>
})
<span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">'submit'</span>, <span class="hljs-string">'cancel'</span>])
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h3 data-id="heading-7">3. å¼‚æ­¥åŠ è½½ï¼šåŠ¨æ€å¯¼å…¥ç»„ä»¶ï¼ˆæŒ‰éœ€åŠ è½½ï¼‰</h3>
<p>å¯¹äºå¤§å‹åº”ç”¨ï¼Œä¸ºäº†å‡å°é¦–å±ä½“ç§¯ï¼Œæˆ‘ä»¬å¯ä»¥ç»“åˆ Vue çš„å¼‚æ­¥ç»„ä»¶å’ŒåŠ¨æ€ç»„ä»¶ï¼Œå®ç°ç»„ä»¶çš„æŒ‰éœ€åŠ è½½ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">"asyncComponent"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span></span>
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"loadComponent"</span>&gt;</span>åŠ è½½å¼‚æ­¥ç»„ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-comment">// åˆå§‹ä¸ºç©º</span>
<span class="hljs-keyword">const</span> asyncComponent = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>)

<span class="hljs-comment">// åŠ¨æ€å¯¼å…¥ç»„ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">loadComponent</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-comment">// å¼‚æ­¥å¯¼å…¥ + æŒ‰éœ€åŠ è½½</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title class_">AsyncComponent</span> = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./AsyncComponent.vue'</span>)
  asyncComponent.<span class="hljs-property">value</span> = <span class="hljs-title class_">AsyncComponent</span>.<span class="hljs-property">default</span>
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<p><strong>æ›´ä¼˜é›…çš„å†™æ³•</strong>ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;script setup&gt;
<span class="hljs-keyword">import</span> { ref, defineAsyncComponent } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-comment">// å®šä¹‰å¼‚æ­¥ç»„ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">AsyncComponentA</span> = <span class="hljs-title function_">defineAsyncComponent</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./AsyncComponentA.vue'</span>))
<span class="hljs-keyword">const</span> <span class="hljs-title class_">AsyncComponentB</span> = <span class="hljs-title function_">defineAsyncComponent</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./AsyncComponentB.vue'</span>))

<span class="hljs-keyword">const</span> currentAsyncComponent = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>)

<span class="hljs-comment">// åˆ‡æ¢å¼‚æ­¥ç»„ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">switchComponent</span> = (<span class="hljs-params">type</span>) =&gt; {
  currentAsyncComponent.<span class="hljs-property">value</span> = type === <span class="hljs-string">'A'</span> ? <span class="hljs-title class_">AsyncComponentA</span> : <span class="hljs-title class_">AsyncComponentB</span>
}
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-8">4. ç”Ÿå‘½å‘¨æœŸï¼šç¼“å­˜ç»„ä»¶çš„æ¿€æ´» / å¤±æ´»é’©å­</h3>
<p>è¢« <code>&lt;keep-alive&gt;</code> ç¼“å­˜çš„ç»„ä»¶ï¼Œä¸ä¼šè§¦å‘ <code>mounted</code>/<code>unmounted</code>ï¼Œè€Œæ˜¯è§¦å‘ <code>activated</code>ï¼ˆæ¿€æ´»ï¼‰å’Œ <code>deactivated</code>ï¼ˆå¤±æ´»ï¼‰é’©å­ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;!-- <span class="hljs-title class_">Home</span>.<span class="hljs-property">vue</span> --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { onMounted, onActivated, onDeactivated } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Home ç»„ä»¶é¦–æ¬¡æŒ‚è½½'</span>)
})

<span class="hljs-title function_">onActivated</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Home ç»„ä»¶è¢«æ¿€æ´»ï¼ˆåˆ‡æ¢å›æ¥ï¼‰'</span>)
})

<span class="hljs-title function_">onDeactivated</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Home ç»„ä»¶è¢«å¤±æ´»ï¼ˆåˆ‡æ¢å‡ºå»ï¼‰'</span>)
})
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h2 data-id="heading-9">ğŸš¨ å¸¸è§å‘ç‚¹ä¸è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-10">1. ç»„ä»¶åˆ‡æ¢åçŠ¶æ€ä¸¢å¤±</h3>
<p><strong>é—®é¢˜</strong>ï¼šåˆ‡æ¢åŠ¨æ€ç»„ä»¶æ—¶ï¼Œè¡¨å•è¾“å…¥ã€æ»šåŠ¨ä½ç½®ç­‰çŠ¶æ€ä¸¢å¤±ã€‚<strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šä½¿ç”¨ <code>&lt;keep-alive&gt;</code> ç¼“å­˜ç»„ä»¶ï¼Œæˆ–æ‰‹åŠ¨ä¿å­˜ / æ¢å¤çŠ¶æ€ã€‚</p>
<h3 data-id="heading-11">2. keep-alive ä¸ç”Ÿæ•ˆ</h3>
<p><strong>é—®é¢˜</strong>ï¼šä½¿ç”¨ <code>keep-alive</code> åç»„ä»¶ä»é‡æ–°æ¸²æŸ“ã€‚<strong>æ’æŸ¥æ–¹å‘</strong>ï¼š</p>
<ul>
<li>ç»„ä»¶æ˜¯å¦å®šä¹‰äº† <code>name</code> å±æ€§ï¼ˆ<code>include/exclude</code> ä¾èµ– <code>name</code>ï¼‰ï¼›</li>
<li><code>is</code> å±æ€§ç»‘å®šçš„æ˜¯å¦æ˜¯ç»„ä»¶å¯¹è±¡ï¼ˆè€Œéå­—ç¬¦ä¸²ï¼‰ï¼›</li>
<li>æ˜¯å¦åœ¨ <code>keep-alive</code> å†…éƒ¨ä½¿ç”¨äº† <code>v-if</code>ï¼ˆå¯èƒ½å¯¼è‡´ç»„ä»¶å¸è½½ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-12">3. å¼‚æ­¥ç»„ä»¶åŠ è½½å¤±è´¥</h3>
<p><strong>é—®é¢˜</strong>ï¼šåŠ¨æ€å¯¼å…¥ç»„ä»¶æ—¶æç¤ºæ‰¾ä¸åˆ°æ¨¡å—ã€‚<strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>æ£€æŸ¥å¯¼å…¥è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼›</li>
<li>ç¡®ä¿å¼‚æ­¥ç»„ä»¶è¿”å›çš„æ˜¯é»˜è®¤å¯¼å‡ºï¼ˆ<code>default</code>ï¼‰ï¼›</li>
<li>ç»“åˆ <code>Suspense</code> å¤„ç†åŠ è½½çŠ¶æ€ï¼š</li>
</ul>
<pre><code class="hljs language-js" lang="js">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">default</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentAsyncComponent"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">fallback</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>åŠ è½½ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span></span>
&lt;/template&gt;
</code></pre>
<h3 data-id="heading-13">4. åŠ¨æ€ç»„ä»¶ä¼ å‚ä¸ç”Ÿæ•ˆ</h3>
<p><strong>é—®é¢˜</strong>ï¼šå‘åŠ¨æ€ç»„ä»¶ä¼ é€’çš„ props æœªç”Ÿæ•ˆã€‚<strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>ç¡®ä¿å­ç»„ä»¶é€šè¿‡ <code>defineProps</code> å£°æ˜äº†å¯¹åº”çš„ propsï¼›</li>
<li>æ£€æŸ¥ props åç§°æ˜¯å¦å¤§å°å†™ä¸€è‡´ï¼ˆVue æ”¯æŒ kebab-case å’Œ camelCase è½¬æ¢ï¼‰ï¼›</li>
<li>é¿å…ä¼ é€’éå“åº”å¼æ•°æ®ï¼ˆéœ€ç”¨ <code>ref</code>/<code>reactive</code> åŒ…è£¹ï¼‰ã€‚</li>
</ul>
<h2 data-id="heading-14">ğŸ¯ å®æˆ˜åœºæ™¯ï¼šåŠ¨æ€ç»„ä»¶çš„å…¸å‹åº”ç”¨</h2>
<h3 data-id="heading-15">1. æƒé™æ§åˆ¶ç»„ä»¶</h3>
<p>æ ¹æ®ç”¨æˆ·è§’è‰²åŠ¨æ€æ¸²æŸ“ä¸åŒç»„ä»¶ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">"authComponent"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref, computed } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">AdminPanel</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./AdminPanel.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">UserPanel</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./UserPanel.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">GuestPanel</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./GuestPanel.vue'</span>

<span class="hljs-comment">// æ¨¡æ‹Ÿç”¨æˆ·è§’è‰²</span>
<span class="hljs-keyword">const</span> userRole = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'admin'</span>) <span class="hljs-comment">// admin / user / guest</span>

<span class="hljs-comment">// æ ¹æ®è§’è‰²åŒ¹é…ç»„ä»¶</span>
<span class="hljs-keyword">const</span> authComponent = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">switch</span> (userRole.<span class="hljs-property">value</span>) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'admin'</span>: <span class="hljs-keyword">return</span> <span class="hljs-title class_">AdminPanel</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">'user'</span>: <span class="hljs-keyword">return</span> <span class="hljs-title class_">UserPanel</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">'guest'</span>: <span class="hljs-keyword">return</span> <span class="hljs-title class_">GuestPanel</span>
    <span class="hljs-attr">default</span>: <span class="hljs-keyword">return</span> <span class="hljs-title class_">GuestPanel</span>
  }
})
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h3 data-id="heading-16">2. è¡¨å•æ­¥éª¤åˆ‡æ¢</h3>
<p>å¤šæ­¥éª¤è¡¨å•ï¼Œæ ¹æ®å½“å‰æ­¥éª¤æ¸²æŸ“ä¸åŒè¡¨å•ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-steps"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"steps"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"{ active: step === 1 }"</span>&gt;</span>åŸºæœ¬ä¿¡æ¯<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"{ active: step === 2 }"</span>&gt;</span>è”ç³»æ–¹å¼<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"{ active: step === 3 }"</span>&gt;</span>æäº¤ç¡®è®¤<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">keep-alive</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">component</span> 
        <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentFormComponent"</span>
        <span class="hljs-attr">:form-data</span>=<span class="hljs-string">"formData"</span>
        @<span class="hljs-attr">next</span>=<span class="hljs-string">"step++"</span>
        @<span class="hljs-attr">prev</span>=<span class="hljs-string">"step--"</span>
        @<span class="hljs-attr">submit</span>=<span class="hljs-string">"handleSubmit"</span>
      &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">keep-alive</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref, computed, reactive } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Step1</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./Step1.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Step2</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./Step2.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Step3</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./Step3.vue'</span>

<span class="hljs-keyword">const</span> step = <span class="hljs-title function_">ref</span>(<span class="hljs-number">1</span>)
<span class="hljs-keyword">const</span> formData = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">''</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-string">''</span>,
  <span class="hljs-attr">phone</span>: <span class="hljs-string">''</span>,
  <span class="hljs-attr">email</span>: <span class="hljs-string">''</span>
})

<span class="hljs-keyword">const</span> currentFormComponent = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-number">1</span>: <span class="hljs-title class_">Step1</span>,
    <span class="hljs-number">2</span>: <span class="hljs-title class_">Step2</span>,
    <span class="hljs-number">3</span>: <span class="hljs-title class_">Step3</span>
  }[step.<span class="hljs-property">value</span>]
})

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSubmit</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¡¨å•æäº¤ï¼š'</span>, formData)
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h2 data-id="heading-17">ğŸ“ æ€»ç»“</h2>
<p>Vue3 çš„åŠ¨æ€ç»„ä»¶æ˜¯æå‡ç»„ä»¶å¤ç”¨æ€§å’Œçµæ´»æ€§çš„æ ¸å¿ƒå·¥å…·ï¼Œæ ¸å¿ƒè¦ç‚¹ï¼š</p>
<ol>
<li>åŸºç¡€ç”¨æ³•ï¼šé€šè¿‡ <code>&lt;component :is="ç»„ä»¶"&gt;</code> å®ç°åŠ¨æ€æ¸²æŸ“ï¼›</li>
<li>æ€§èƒ½ä¼˜åŒ–ï¼šä½¿ç”¨ <code>&lt;keep-alive&gt;</code> ç¼“å­˜ç»„ä»¶ï¼Œé¿å…é‡å¤æ¸²æŸ“å’ŒçŠ¶æ€ä¸¢å¤±ï¼›</li>
<li>é«˜çº§ç”¨æ³•ï¼šç»“åˆå¼‚æ­¥ç»„ä»¶å®ç°æŒ‰éœ€åŠ è½½ï¼Œç»“åˆ <code>computed</code> å®ç°å¤æ‚é€»è¾‘çš„ç»„ä»¶åˆ‡æ¢ï¼›</li>
<li>é¿å‘æŒ‡å—ï¼šæ³¨æ„ <code>keep-alive</code> çš„ç”Ÿæ•ˆæ¡ä»¶ã€ç»„ä»¶çŠ¶æ€çš„ä¿ç•™ã€å¼‚æ­¥ç»„ä»¶çš„åŠ è½½å¤„ç†ã€‚</li>
</ol>
<p>æŒæ¡åŠ¨æ€ç»„ä»¶åï¼Œä½ å¯ä»¥å‘Šåˆ«ç¹ççš„ <code>v-if/v-else</code> åµŒå¥—ï¼Œå†™å‡ºæ›´ç®€æ´ã€æ›´æ˜“ç»´æŠ¤çš„ Vue ä»£ç ã€‚æ— è®ºæ˜¯ Tab åˆ‡æ¢ã€æƒé™æ§åˆ¶è¿˜æ˜¯å¤šæ­¥éª¤è¡¨å•ï¼ŒåŠ¨æ€ç»„ä»¶éƒ½èƒ½è®©ä½ çš„å®ç°æ–¹å¼æ›´ä¼˜é›…ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Python æ•°æ®ç±»å‹ â€œå†·çŸ¥è¯†â€ï¼šè¿™äº›å‘ä½ è¸©è¿‡å‡ ä¸ªï¼Ÿ]]></title>    <link>https://juejin.cn/post/7591730714141343786</link>    <guid>https://juejin.cn/post/7591730714141343786</guid>    <pubDate>2026-01-06T03:05:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591730714141343786" data-draft-id="7591730714141278250" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" Python æ•°æ®ç±»å‹ â€œå†·çŸ¥è¯†â€ï¼šè¿™äº›å‘ä½ è¸©è¿‡å‡ ä¸ªï¼Ÿ"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2026-01-06T03:05:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AAAç®€å•ç©è½¬ç¨‹åºè®¾è®¡"/> <meta itemprop="url" content="https://juejin.cn/user/4294056357689099"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             Python æ•°æ®ç±»å‹ â€œå†·çŸ¥è¯†â€ï¼šè¿™äº›å‘ä½ è¸©è¿‡å‡ ä¸ªï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4294056357689099/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AAAç®€å•ç©è½¬ç¨‹åºè®¾è®¡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T03:05:33.000Z" title="Tue Jan 06 2026 03:05:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤©å¤©å†™ Python ä»£ç ï¼Œä½ çœŸçš„æ‡‚åˆ—è¡¨ã€å­—å…¸ã€å­—ç¬¦ä¸²è¿™äº›åŸºç¡€æ•°æ®ç±»å‹å—ï¼Ÿè¿™å‡ ä¸ª<strong>è¿›é˜¶ååŸºç¡€</strong>çš„å†·çŸ¥è¯†ï¼Œå¸®ä½ é¿å¼€é‚£äº› â€œçœ‹ä¼¼æ²¡é—®é¢˜ï¼Œè¿è¡Œå°±ç¿»è½¦â€ çš„å‘ï¼</p>
<h2 data-id="heading-0">1. åˆ—è¡¨ <code>sort()</code> vs <code>sorted()</code>ï¼šä¸€ä¸ªåŸåœ°æ”¹ï¼Œä¸€ä¸ªè¿”æ–°çš„</h2>
<p>å¾ˆå¤šäººåˆ†ä¸æ¸…è¿™ä¸¤ä¸ªæ’åºæ–¹æ³•ï¼Œä¸€ä¸å°å¿ƒå°±æŠŠåŸåˆ—è¡¨æ”¹å¾—é¢ç›®å…¨éï¼æ ¸å¿ƒåŒºåˆ«å°±ä¸€ä¸ªï¼š<strong>æ˜¯å¦ä¿®æ”¹åŸåˆ—è¡¨</strong>ã€‚</p>
<pre><code class="hljs language-python" lang="python">
nums = [<span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>]

<span class="hljs-comment"># sorted()ï¼šè¿”å›æ–°åˆ—è¡¨ï¼ŒåŸåˆ—è¡¨ä¸å˜</span>
new_nums = <span class="hljs-built_in">sorted</span>(nums)
<span class="hljs-built_in">print</span>(nums)      <span class="hljs-comment"># [3, 1, 4, 1, 5] åŸåˆ—è¡¨æ²¡åŠ¨</span>
<span class="hljs-built_in">print</span>(new_nums)  <span class="hljs-comment"># [1, 1, 3, 4, 5] æ–°åˆ—è¡¨æ˜¯æ’åºåçš„</span>

<span class="hljs-comment"># sort()ï¼šåŸåœ°æ’åºï¼Œæ— è¿”å›å€¼ï¼ˆè¿”å› Noneï¼‰</span>
result = nums.sort()
<span class="hljs-built_in">print</span>(nums)      <span class="hljs-comment"># [1, 1, 3, 4, 5] åŸåˆ—è¡¨è¢«æ”¹äº†</span>
<span class="hljs-built_in">print</span>(result)    <span class="hljs-comment"># None åˆ«æƒ³ç€æ¥æ”¶è¿”å›å€¼ï¼</span>

<span class="hljs-comment"># è¿›é˜¶ï¼šéƒ½æ”¯æŒ reverse å‚æ•°</span>
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">sorted</span>(nums, reverse=<span class="hljs-literal">True</span>))  <span class="hljs-comment"># [5,4,3,1,1]</span>
</code></pre>
<h2 data-id="heading-1">2. å­—å…¸çš„ â€œé”®â€ æœ‰è®²ç©¶ï¼šå¿…é¡»æ˜¯ä¸å¯å˜ç±»å‹</h2>
<p>å­—å…¸çš„é”®ï¼ˆKeyï¼‰ä¸æ˜¯éšä¾¿ä»€ä¹ˆéƒ½èƒ½å½“çš„ï¼<strong>åˆ—è¡¨ã€é›†åˆè¿™ç§å¯å˜ç±»å‹ä¸èƒ½å½“é”®</strong>ï¼Œå¦åˆ™ç›´æ¥æŠ¥é”™ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åˆæ³•ï¼šå­—ç¬¦ä¸²ã€æ•°å­—ã€å…ƒç»„ï¼ˆä¸å¯å˜ç±»å‹ï¼‰åšé”®</span>
valid_dict = {
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"æ˜é‡‘"</span>,
    <span class="hljs-number">123</span>: <span class="hljs-string">"æ•°å­—é”®"</span>,
    (<span class="hljs-number">1</span>, <span class="hljs-number">2</span>): <span class="hljs-string">"å…ƒç»„é”®"</span>
}
<span class="hljs-built_in">print</span>(valid_dict[(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)])  <span class="hljs-comment"># å…ƒç»„é”®èƒ½æ­£å¸¸å–å€¼</span>

<span class="hljs-comment"># éæ³•ï¼šåˆ—è¡¨åšé”®ï¼Œç›´æ¥æŠ¥é”™</span>
<span class="hljs-comment"># invalid_dict = {[1,2]: "åˆ—è¡¨é”®"}  # TypeError: unhashable type: 'list'</span>

<span class="hljs-comment"># å°æŠ€å·§ï¼šæƒ³å­˜å¯å˜æ•°æ®å½“â€œé”®â€ï¼Ÿè½¬æˆå…ƒç»„å°±è¡Œ</span>
lst = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]
dict_with_tuple_key = {<span class="hljs-built_in">tuple</span>(lst): <span class="hljs-string">"å¯¹åº”å€¼"</span>}
<span class="hljs-built_in">print</span>(dict_with_tuple_key[(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>)])  <span class="hljs-comment"># æ­£å¸¸è¾“å‡ºï¼šå¯¹åº”å€¼</span>
</code></pre>
<h2 data-id="heading-2">3. å­—ç¬¦ä¸² <code>strip()</code>ï¼šåªåˆ ä¸¤ç«¯ï¼Œä¸åˆ ä¸­é—´</h2>
<p>æƒ³å»æ‰å­—ç¬¦ä¸²é‡Œçš„ç©ºæ ¼ï¼Ÿ<code>strip()</code> æ˜¯å¸¸ç”¨æ–¹æ³•ï¼Œä½†ä½ è¦è®°ä½ï¼šå®ƒ<strong>åªåˆ é™¤å­—ç¬¦ä¸²å¼€å¤´å’Œç»“å°¾çš„æŒ‡å®šå­—ç¬¦</strong>ï¼Œä¸­é—´çš„ä¸€æ¦‚ä¸åŠ¨ï¼</p>
<pre><code class="hljs language-python" lang="python">s = <span class="hljs-string">"  hello world  "</span>
<span class="hljs-comment"># ä¸å¸¦å‚æ•°ï¼šé»˜è®¤åˆ ä¸¤ç«¯çš„ç©ºæ ¼ã€æ¢è¡Œç¬¦ã€åˆ¶è¡¨ç¬¦</span>
<span class="hljs-built_in">print</span>(s.strip())  <span class="hljs-comment"># "hello world" ä¸­é—´ç©ºæ ¼è¿˜åœ¨</span>

s2 = <span class="hljs-string">"###python###"</span>
<span class="hljs-comment"># å¸¦å‚æ•°ï¼šåˆ ä¸¤ç«¯çš„æŒ‡å®šå­—ç¬¦ï¼ˆä¸æ˜¯å­—ç¬¦ä¸²ï¼Œæ˜¯å­—ç¬¦é›†åˆï¼‰</span>
<span class="hljs-built_in">print</span>(s2.strip(<span class="hljs-string">"#"</span>))  <span class="hljs-comment"># "python"</span>

<span class="hljs-comment"># æƒ³åˆ ä¸­é—´çš„å­—ç¬¦ï¼Ÿç”¨ replace()</span>
s3 = <span class="hljs-string">"he ll o"</span>
<span class="hljs-built_in">print</span>(s3.replace(<span class="hljs-string">" "</span>, <span class="hljs-string">""</span>))  <span class="hljs-comment"># "hello"</span>
</code></pre>
<h2 data-id="heading-3">4. å…ƒç»„ä¸å¯å˜ï¼Ÿä½†é‡Œé¢çš„å¯å˜å…ƒç´ å¯ä»¥æ”¹ï¼</h2>
<p>å…ƒç»„ï¼ˆtupleï¼‰å·ç§° â€œä¸å¯å˜åºåˆ—â€ï¼Œä½†è¿™æŒ‡çš„æ˜¯<strong>å…ƒç»„çš„å…ƒç´ ä¸ªæ•°å’Œå…ƒç´ çš„å†…å­˜åœ°å€ä¸èƒ½æ”¹</strong>â€”â€” å¦‚æœå…ƒç»„é‡Œè£…äº†åˆ—è¡¨è¿™ç§å¯å˜å…ƒç´ ï¼Œåˆ—è¡¨å†…éƒ¨æ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å…ƒç»„é‡Œå¥—åˆ—è¡¨</span>
tup = (<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>])
<span class="hljs-comment"># tup[0] = 100  # æŠ¥é”™ï¼å…ƒç»„å…ƒç´ æœ¬èº«ä¸èƒ½æ”¹</span>
tup[<span class="hljs-number">2</span>].append(<span class="hljs-number">5</span>)  <span class="hljs-comment"># æ”¹å…ƒç»„é‡Œçš„åˆ—è¡¨ï¼Œå®Œå…¨å¯ä»¥ï¼</span>
<span class="hljs-built_in">print</span>(tup)  <span class="hljs-comment"># (1, 2, [3, 4, 5])</span>
</code></pre>
<hr/>
<h3 data-id="heading-4">å°æ€»ç»“</h3>
<ol>
<li>æ’åºç”¨ <code>sorted()</code> ä¿åŸåˆ—è¡¨ï¼Œç”¨ <code>sort()</code> è¦è°¨æ…ï¼›</li>
<li>å­—å…¸é”®å¿…é¡»æ˜¯ä¸å¯å˜ç±»å‹ï¼Œå¯å˜ç±»å‹è½¬å…ƒç»„å†ç”¨ï¼›</li>
<li><code>strip()</code> åªæ¸…ä¸¤ç«¯å­—ç¬¦ï¼Œä¸­é—´çš„ç”¨ <code>replace()</code>ï¼›</li>
<li>å…ƒç»„ â€œä¸å¯å˜â€ æ˜¯æŒ‡å…ƒç´ åœ°å€ä¸å˜ï¼Œå†…éƒ¨å¯å˜å…ƒç´ èƒ½æ”¹ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸æ˜¯å§ï¼Œä¸æ˜¯å§ï¼Œå‰ç«¯é¢è¯•åˆå‡ºæ–°ç©æ³•äº†ï¼Ÿï¼]]></title>    <link>https://juejin.cn/post/7591672090791477267</link>    <guid>https://juejin.cn/post/7591672090791477267</guid>    <pubDate>2026-01-06T03:09:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591672090791477267" data-draft-id="7591715454135517247" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸æ˜¯å§ï¼Œä¸æ˜¯å§ï¼Œå‰ç«¯é¢è¯•åˆå‡ºæ–°ç©æ³•äº†ï¼Ÿï¼"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-06T03:09:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å››çœ¼è‚¥é±¼"/> <meta itemprop="url" content="https://juejin.cn/user/2995504913591661"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸æ˜¯å§ï¼Œä¸æ˜¯å§ï¼Œå‰ç«¯é¢è¯•åˆå‡ºæ–°ç©æ³•äº†ï¼Ÿï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2995504913591661/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å››çœ¼è‚¥é±¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T03:09:58.000Z" title="Tue Jan 06 2026 03:09:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»22åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰ç«¯æ–°çš„é¢è¯•é¢˜åˆæ¥å’¯</h2>
<h3 data-id="heading-1"><strong>æ‹–æ‹½ä¸ DOM</strong></h3>
<p><strong>é—®é¢˜ 1ï¼šæ‹–æ‹½è¿‡ç¨‹ä¸­ï¼Œå¦‚æœåŸæœ¬çš„å…ƒç´ æ¶ˆå¤±äº†ï¼ŒonDrop è¿˜èƒ½è§¦å‘ä¹ˆï¼Ÿå…·ä½“è¡¨ç°æ˜¯ä»€ä¹ˆï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> èƒ½è§¦å‘ã€‚<code>onDrop</code> äº‹ä»¶ä¼šåœ¨æ”¾ç½®çš„ç›®æ ‡å…ƒç´ ä¸Šè§¦å‘ã€‚å…·ä½“è¡¨ç°æ˜¯ï¼šæ‹–æ‹½æºå…ƒç´ åœ¨æ‹–æ‹½è¿‡ç¨‹ä¸­è¢«ç§»é™¤ï¼ˆå¦‚è®¾ç½®ä¸º <code>display: none</code> æˆ–ä» DOM ä¸­åˆ é™¤ï¼‰ï¼Œåªè¦é¼ æ ‡åœ¨æœ‰æ•ˆçš„æ”¾ç½®ç›®æ ‡ä¸Šé‡Šæ”¾ï¼Œ<code>onDrop</code> ä»ä¼šè§¦å‘ã€‚ä½†æ˜¯ï¼Œ<code>event.dataTransfer</code> å¯¹è±¡ä¸­å…³äºæ‹–æ‹½æºçš„æ•°æ®å¯èƒ½å˜å¾—ä¸å¯é æˆ–ä¸¢å¤±ã€‚</p>
<p><strong>é—®é¢˜ 2ï¼šå¦‚ä½•æ”¹å˜æ‹–æ‹½é¢„è§ˆå›¾ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> ä½¿ç”¨ <code>DataTransfer.setDragImage()</code> æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript">element.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'dragstart'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰å›¾åƒå…ƒç´ </span>
  <span class="hljs-keyword">const</span> dragImage = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
  dragImage.<span class="hljs-property">textContent</span> = <span class="hljs-string">'è‡ªå®šä¹‰é¢„è§ˆ'</span>;
  dragImage.<span class="hljs-property">style</span>.<span class="hljs-property">background</span> = <span class="hljs-string">'blue'</span>;
  <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(dragImage);

  <span class="hljs-comment">// è®¾ç½®æ‹–æ‹½é¢„è§ˆå›¾ï¼Œåä¸¤ä¸ªå‚æ•°æ˜¯é¼ æ ‡ç›¸å¯¹äºé¢„è§ˆå›¾çš„åç§»é‡</span>
  e.<span class="hljs-property">dataTransfer</span>.<span class="hljs-title function_">setDragImage</span>(dragImage, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>);
});
</code></pre>
<p><strong>é—®é¢˜ 3ï¼šå¦‚ä½•è®©æ‹–æ‹½é¢„è§ˆå›¾æœ‰åœ†è§’ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> ä¸ºä½ åœ¨ <code>setDragImage</code> ä¸­ä½¿ç”¨çš„è‡ªå®šä¹‰é¢„è§ˆå…ƒç´ æ·»åŠ  CSS <code>border-radius</code> å±æ€§å³å¯ã€‚</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-id">#customDragImage</span> {
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">10px</span>;
}
</code></pre>
<hr/>
<h3 data-id="heading-2"><strong>ECharts ä¸å“åº”å¼å¸ƒå±€</strong></h3>
<p><strong>é—®é¢˜ 4ï¼šä½ ç”¨äº† echartï¼Œå¦‚ä½•è®© echart çš„å†…å®¹è·Ÿéšå®¹å™¨å¤§å°è€Œå˜åŒ–ï¼ŸonResize çš„æ—¶å€™è¦æ€ä¹ˆåšï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> è°ƒç”¨ ECharts å®ä¾‹çš„ <code>.resize()</code> æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆå§‹åŒ–å›¾è¡¨</span>
<span class="hljs-keyword">const</span> myChart = echarts.<span class="hljs-title function_">init</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'chart-container'</span>));

<span class="hljs-comment">// ç›‘å¬çª—å£ resize äº‹ä»¶</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'resize'</span>, <span class="hljs-function">() =&gt;</span> {
  myChart.<span class="hljs-title function_">resize</span>();
});
</code></pre>
<p><strong>é—®é¢˜ 5ï¼šå¦‚æœæœ‰å¯ä¼¸ç¼©ä¾§è¾¹æ ä¹‹ç±»çš„ï¼Œå¯¼è‡´å®¹å™¨å› ä¸ºå…¶ä»–åŸå› å‘ç”Ÿäº†æ”¹å˜ï¼Œåº”è¯¥ç”¨ä»€ä¹ˆäº‹ä»¶ç›‘å¬ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> ä½¿ç”¨ <code>ResizeObserver</code> APIã€‚å®ƒå¯ä»¥ç›‘å¬ä»»æ„ DOM å…ƒç´ å°ºå¯¸çš„å˜åŒ–ï¼Œè€Œä¸ä»…ä»…æ˜¯çª—å£ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> resizeObserver = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ResizeObserver</span>(<span class="hljs-function"><span class="hljs-params">entries</span> =&gt;</span> {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> entry <span class="hljs-keyword">of</span> entries) {
    myChart.<span class="hljs-title function_">resize</span>();
  }
});
resizeObserver.<span class="hljs-title function_">observe</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'chart-container'</span>));
</code></pre>
<hr/>
<h3 data-id="heading-3"><strong>éƒ¨ç½²ã€ç¼“å­˜ä¸ CDN</strong></h3>
<p><strong>é—®é¢˜ 6ï¼šå¦‚æœæ˜¯ toc äº§å“ï¼Œåç«¯ä¸º index.html è®¾ç½®äº† 1 h çš„ max ageï¼Œè¯·é—®ä»ä½ é‡æ–°æ„å»ºä»£ç å‘å¸ƒï¼Œå¤§æ¦‚å¤šä¹…ä¹‹åï¼Œæ‰€æœ‰ç”¨æˆ·éƒ½å¯ä»¥çœ‹åˆ°æ–°ç•Œé¢ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> ç†è®ºä¸Šæœ€é•¿éœ€è¦ 1 å°æ—¶ï¼ˆmax-age æ—¶é—´ï¼‰åŠ ä¸Š CDN è¾¹ç¼˜èŠ‚ç‚¹çš„ç¼“å­˜è¿‡æœŸæ—¶é—´ã€‚ä½†ç”±äºç”¨æˆ·æµè§ˆå™¨ç¼“å­˜ã€CDN é…ç½®ï¼ˆå¦‚æ˜¯å¦å¯ç”¨äº† <code>stale-while-revalidate</code>ï¼‰ç­‰å› ç´ ï¼Œå®é™…æ—¶é—´å¯èƒ½æ›´é•¿æˆ–æ›´çŸ­ã€‚ä¿å®ˆä¼°è®¡ï¼Œ1-2 å°æ—¶å†…æ‰€æœ‰ç”¨æˆ·ä¼šé€æ¸çœ‹åˆ°æ–°ç•Œé¢ã€‚</p>
<p><strong>é—®é¢˜ 7ï¼šå¦‚æœç”¨æˆ·è®¿é—®å‡ºç°äº†ç™½å±ï¼Œæ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> å¸¸è§åŸå› åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>JavaScript åŠ è½½å¤±è´¥ï¼š</strong> èµ„æºè·¯å¾„é”™è¯¯ã€CDN æ•…éšœã€ç½‘ç»œé—®é¢˜ã€‚</li>
<li><strong>JavaScript æ‰§è¡Œé”™è¯¯ï¼š</strong> æ–°ç‰ˆæœ¬ä»£ç å­˜åœ¨è¯­æ³•é”™è¯¯æˆ–è¿è¡Œæ—¶é”™è¯¯ï¼Œå¯¼è‡´åº”ç”¨åˆå§‹åŒ–å¤±è´¥ã€‚</li>
<li><strong>èµ„æºåŠ è½½è¶…æ—¶ã€‚</strong></li>
<li><strong>æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜ã€‚</strong></li>
<li><strong>å…¥å£ HTML æ–‡ä»¶è¢«ç¼“å­˜ï¼ˆå¦‚ index.htmlï¼‰ï¼Œä½†å¼•ç”¨çš„æ–°ç‰ˆæœ¬ JS/CSS æ–‡ä»¶æ— æ³•åŠ è½½ã€‚</strong></li>
</ol>
<p><strong>é—®é¢˜ 8ï¼štoc äº§å“å¤§é‡ä½¿ç”¨ cdnï¼Œè¯·é—® cdn çš„å®šä»·å¤§æ¦‚å¤šå°‘ï¼Ÿé’ˆå¯¹è¿™æ ·çš„å®šä»·ç­–ç•¥ï¼Œå‰ç«¯åº”è¯¥è¿›è¡Œä»€ä¹ˆæ ·çš„ä¼˜åŒ–ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><strong>å®šä»·ï¼š</strong> ä¸»æµäº‘å‚å•†ï¼ˆé˜¿é‡Œäº‘ã€è…¾è®¯äº‘ï¼‰çš„ CDN é€šå¸¸æŒ‰ <strong>æµé‡</strong> å’Œ <strong>HTTP è¯·æ±‚æ¬¡æ•°</strong> è®¡è´¹ã€‚æµé‡è´¹ç”¨çº¦ 0.1 - 0.3 å…ƒ/GBï¼Œè¯·æ±‚è´¹ç”¨çº¦ 0.01 - 0.05 å…ƒ/ä¸‡æ¬¡ã€‚ä¸Šä¼ ï¼ˆå›æºï¼‰æµé‡é€šå¸¸æ¯”ä¸‹è½½ï¼ˆåˆ†å‘ï¼‰æµé‡è´µã€‚</li>
<li><strong>å‰ç«¯ä¼˜åŒ–ï¼š</strong>
<ol>
<li><strong>èµ„æºå‹ç¼©ï¼š</strong> å¯ç”¨ Gzip/Brotli å‹ç¼©ï¼Œå›¾ç‰‡ä½¿ç”¨ WebP æ ¼å¼ã€‚</li>
<li><strong>å‡å°‘è¯·æ±‚ï¼š</strong> åˆå¹¶å°æ–‡ä»¶ï¼ˆé›ªç¢§å›¾ï¼‰ã€åˆ©ç”¨ HTTP/2 å¤šè·¯å¤ç”¨ã€‚</li>
<li><strong>ç¼“å­˜ä¼˜åŒ–ï¼š</strong> ä¸ºé™æ€èµ„æºè®¾ç½®é•¿çš„ <code>Cache-Control</code> max-ageï¼Œå¹¶ä½¿ç”¨å†…å®¹å“ˆå¸Œå‘½åå®ç°â€œæ°¸ä¸è¿‡æœŸâ€ç¼“å­˜ã€‚</li>
<li><strong>ä»£ç åˆ†å‰²ä¸æ‡’åŠ è½½ï¼š</strong> åªåŠ è½½å½“å‰é¡µé¢éœ€è¦çš„ä»£ç ã€‚</li>
<li><strong>ä½¿ç”¨ CDN é¢„çƒ­åŠŸèƒ½</strong>ï¼Œå°†é‡è¦èµ„æºæå‰æ¨é€åˆ°è¾¹ç¼˜èŠ‚ç‚¹ã€‚</li>
</ol>
</li>
</ul>
<p><strong>é—®é¢˜ 9ï¼šå‰ç«¯åº”ç”¨ä¸­ï¼Ÿä¸Šä¼ è´µè¿˜æ˜¯ä¸‹è½½è´µï¼Ÿä¸Šä¼ å¿«è¿˜æ˜¯ä¸‹è½½å¿«ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> åœ¨ CDN è¯­å¢ƒä¸‹ï¼Œ<strong>ä¸Šä¼ ï¼ˆå›æºï¼‰é€šå¸¸æ¯”ä¸‹è½½ï¼ˆåˆ†å‘ï¼‰è´µ</strong>ã€‚å¯¹äºæ™®é€šç½‘ç»œè¿æ¥ï¼Œ<strong>ä¸‹è½½é€Ÿåº¦é€šå¸¸è¿œå¿«äºä¸Šä¼ é€Ÿåº¦</strong>ï¼ˆå®¶åº­å®½å¸¦ä¸Šä¸‹è¡Œä¸å¯¹ç§°ï¼‰ã€‚</p>
<hr/>
<h3 data-id="heading-4"><strong>HTTP ç¼“å­˜ä¸å¤šåª’ä½“</strong></h3>
<p><strong>é—®é¢˜ 10ï¼šå›¾ç‰‡è®¾ç½®åå•†ç¼“å­˜åï¼Œæµè§ˆå™¨ä¼šæ•´ä½“ç¼“å­˜ï¼Œè§†é¢‘èƒ½è®¾ç½®åå•†ç¼“å­˜ä¹ˆï¼Ÿè§†é¢‘çš„ http è¿”å›å†…å®¹ä¸å›¾ç‰‡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><strong>è§†é¢‘å¯ä»¥è®¾ç½®åå•†ç¼“å­˜ã€‚</strong></li>
<li><strong>åŒºåˆ«ï¼š</strong> è§†é¢‘é€šå¸¸æ”¯æŒ <strong>èŒƒå›´è¯·æ±‚ï¼ˆRange Requestsï¼‰</strong>ã€‚HTTP å“åº”å¤´ä¼šåŒ…å« <code>Accept-Ranges: bytes</code>ï¼Œå¹¶ä¸”åœ¨è¯·æ±‚éƒ¨åˆ†è§†é¢‘æ—¶ï¼ŒçŠ¶æ€ç æ˜¯ <code>206 Partial Content</code> è€Œä¸æ˜¯ <code>200 OK</code>ã€‚è¿™ä½¿å¾—å®¢æˆ·ç«¯å¯ä»¥åªè¯·æ±‚è§†é¢‘çš„æŸä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ–‡ä»¶ã€‚</li>
</ul>
<p><strong>é—®é¢˜ 11ï¼šå¦‚ä½•é™ä½è§†é¢‘å±•ç¤ºçš„æˆæœ¬ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong></p>
<ol>
<li><strong>ä½¿ç”¨é«˜æ•ˆçš„è§†é¢‘ç¼–ç ï¼š</strong> å¦‚ H.265/HEVC æˆ– AV1ï¼Œåœ¨ç›¸åŒè´¨é‡ä¸‹æ–‡ä»¶æ›´å°ã€‚</li>
<li><strong>è‡ªé€‚åº”ç æµï¼š</strong> ä½¿ç”¨ HLS æˆ– DASH ç­‰æŠ€æœ¯ï¼Œæ ¹æ®ç”¨æˆ·ç½‘é€ŸåŠ¨æ€åˆ‡æ¢ä¸åŒæ¸…æ™°åº¦çš„è§†é¢‘æµã€‚</li>
<li><strong>CDN åŠ é€Ÿã€‚</strong></li>
<li><strong>è§†é¢‘å‹ç¼©ä¸ä¼˜åŒ–ï¼š</strong> åœ¨å¯æ¥å—çš„èŒƒå›´å†…é™ä½ç ç‡å’Œåˆ†è¾¨ç‡ã€‚</li>
<li><strong>æ‡’åŠ è½½ï¼š</strong> è§†é¢‘è¿›å…¥è§†å£åå†å¼€å§‹åŠ è½½ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-5"><strong>è®¾è®¡ä¸è§†è§‰</strong></h3>
<p><strong>é—®é¢˜ 12ï¼šæ—¢ç„¶æœ‰é‚£ä¹ˆå¤š 4kï¼Œ2kï¼Œå±å¹•ï¼Œä¸ºå•¥è®¾è®¡å¸ˆçš„å›¾è¿˜æ˜¯ä»¥ 1280 ä¸ºä¸»ï¼Ÿæ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> ä¸»è¦åŸå› ï¼š</p>
<ol>
<li><strong>å†å²ä¸å…¼å®¹æ€§ï¼š</strong> 1280px æ˜¯é•¿æœŸä»¥æ¥æœ€ä¸»æµå’Œç¨³å®šçš„å±å¹•å®½åº¦åŸºå‡†ã€‚</li>
<li><strong>å¼€å‘æ•ˆç‡ï¼š</strong> æä¾›ä¸€ä¸ªæ ‡å‡†å°ºå¯¸ä¾¿äºè®¾è®¡å’Œå¼€å‘å¯¹é½ã€‚</li>
<li><strong>å†…å®¹å¯è¯»æ€§ï¼š</strong> è¿‡å®½çš„å•è¡Œæ–‡æœ¬ä¸åˆ©äºé˜…è¯»ï¼Œè®¾è®¡ç¨¿æ›´å…³æ³¨æ ¸å¿ƒå†…å®¹çš„å¸ƒå±€ã€‚</li>
<li><strong>å“åº”å¼è®¾è®¡ï¼š</strong> è®¾è®¡ä»¥ 1280px ä¸ºâ€œæ¡Œé¢ç«¯â€åŸºå‡†ï¼Œç„¶åé€šè¿‡å“åº”å¼è§„åˆ™é€‚é…æ›´å¤§æˆ–æ›´å°çš„å±å¹•ï¼Œè€Œéç›´æ¥ä¸º 4K è®¾è®¡ã€‚</li>
</ol>
<p><strong>é—®é¢˜ 13ï¼šé«˜åˆ†è¾¨ç‡å›¾ç‰‡åœ¨ä½åˆ†è¾¨ç‡å±å¹•ä¸Šä¸ºä»€ä¹ˆä¼šç³Šï¼Ÿä¸ºä»€ä¹ˆä¼šæœ‰å›¾ç‰‡æ˜æ˜æ­£å¸¸ä½†æ˜¯ä¸€æ—¦æœ‰åŠ¨ç”»ä¹‹åä¹Ÿç³Šäº†ï¼Ÿé‡åˆ°è¿™ç§é—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><strong>åŸå› 1ï¼ˆé«˜åˆ†è¾¨ç‡å›¾åœ¨ä½åˆ†è¾¨ç‡å±ï¼‰ï¼š</strong> æµè§ˆå™¨éœ€è¦å°†é«˜åƒç´ å¯†åº¦çš„å›¾ç‰‡å‹ç¼©åˆ°æ›´å°‘çš„ç‰©ç†åƒç´ ä¸Šæ˜¾ç¤ºï¼Œè¿™ä¸ªâ€œä¸‹é‡‡æ ·â€è¿‡ç¨‹å¯èƒ½å¯¼è‡´æ¨¡ç³Šå’Œç»†èŠ‚æŸå¤±ã€‚</li>
<li><strong>åŸå› 2ï¼ˆåŠ¨ç”»åå˜ç³Šï¼‰ï¼š</strong> æµè§ˆå™¨ä¸ºäº†åŠ¨ç”»æ€§èƒ½ï¼Œå¯èƒ½ä¼šå°†åŠ¨ç”»å…ƒç´ æå‡åˆ°ç‹¬ç«‹çš„åˆæˆå±‚ï¼ˆGPU æ¸²æŸ“ï¼‰ã€‚åœ¨å±‚åˆ›å»ºæˆ–å˜æ¢è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå¤„ç†ä¸å½“ï¼ˆå¦‚ä¸æ˜¯æ•´æ•°åƒç´ ç§»åŠ¨ï¼‰ï¼ŒæŠ—é”¯é½¿ç®—æ³•å¯èƒ½å¯¼è‡´æš‚æ—¶æ€§æ¨¡ç³Šã€‚</li>
<li><strong>è§£å†³æ–¹æ¡ˆï¼š</strong>
<ol>
<li>ä½¿ç”¨ <code>srcset</code> å’Œ <code>sizes</code> å±æ€§ä¸ºä¸åŒå±å¹•æä¾›åˆé€‚çš„å›¾ç‰‡å°ºå¯¸ã€‚</li>
<li>å¯¹åŠ¨ç”»å…ƒç´ åº”ç”¨ <code>transform: translateZ(0)</code> æˆ– <code>will-change: transform</code> æ¥è§¦å‘ GPU åŠ é€Ÿï¼Œå¹¶ç¡®ä¿åŠ¨ç”»å±æ€§ï¼ˆå¦‚ <code>transform</code>ï¼‰çš„å€¼ä¸ºæ•´æ•°åƒç´ ã€‚</li>
<li>æ£€æŸ¥å›¾ç‰‡çš„åŸå§‹å°ºå¯¸æ˜¯å¦ä¸æ˜¾ç¤ºå°ºå¯¸åŒ¹é…ã€‚</li>
</ol>
</li>
</ul>
<p><strong>é—®é¢˜ 14ï¼šè®¾è®¡å¸ˆç»™äº†ä¸€å¥— SVG å›¾ç‰‡ï¼Œå›¾ç‰‡åœ¨ macos ä¸Šæ˜¾ç¤ºæ­£å¸¸ï¼Œä½†åœ¨ windows ä¸‹ååˆ†æ¨¡ç³Šï¼Œæ˜¯ä½ çš„ä»£ç é—®é¢˜è¿˜æ˜¯è®¾è®¡å¸ˆå‡ºçš„å›¾ç‰‡çš„é—®é¢˜ï¼Ÿå¦‚æœæœ‰è¿™æ ·çš„æƒ…å†µï¼Œæœ€åæ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> è¿™é€šå¸¸æ˜¯ <strong>ä»£ç æˆ–ç¯å¢ƒé—®é¢˜</strong>ï¼Œè€Œé SVG æºæ–‡ä»¶é—®é¢˜ã€‚SVG æ˜¯çŸ¢é‡æ ¼å¼ï¼Œç†è®ºä¸Šåº”åœ¨ä»»ä½•åˆ†è¾¨ç‡ä¸‹éƒ½æ¸…æ™°ã€‚</p>
<ul>
<li><strong>å¸¸è§åŸå› ä¸è§£å†³æ–¹æ¡ˆï¼š</strong>
<ol>
<li><strong>CSS å°ºå¯¸é—®é¢˜ï¼š</strong> ç¡®ä¿ SVG çš„å®¹å™¨å°ºå¯¸æ˜¯æ•´æ•°åƒç´ ï¼Œé¿å…éæ•´æ•°ç¼©æ”¾ã€‚<code>width: 100.5px</code> å¯èƒ½å¯¼è‡´æ¨¡ç³Šã€‚</li>
<li><strong>Viewport å’Œ ViewBox ä¸åŒ¹é…ï¼š</strong> æ£€æŸ¥ SVG ä»£ç ä¸­çš„ <code>viewBox</code> å±æ€§ï¼Œå¹¶ç¡®ä¿å…¶ä¸æ˜¾ç¤ºå°ºå¯¸æˆæ¯”ä¾‹ã€‚</li>
<li><strong>æµè§ˆå™¨æ¸²æŸ“å¼•æ“å·®å¼‚ï¼š</strong> macOS å’Œ Windows çš„å­—ä½“æ¸²æŸ“å’Œå›¾å½¢æŠ—é”¯é½¿ç®—æ³•ä¸åŒã€‚å¯ä»¥å°è¯•ä¸º SVG æ·»åŠ  <code>shape-rendering: geometricPrecision;</code> CSS å±æ€§ã€‚</li>
<li><strong>ä½å›¾åµŒå…¥ï¼š</strong> å¦‚æœ SVG å†…åµŒäº†æ¨¡ç³Šçš„ä½å›¾ï¼Œé‚£ä¹ˆåœ¨ Windows ä¸Šä¹Ÿä¼šæ¨¡ç³Šã€‚</li>
</ol>
</li>
</ul>
<hr/>
<h3 data-id="heading-6"><strong>TypeScript</strong></h3>
<p><strong>é—®é¢˜ 15ï¼šts å¼€å‘ä¸‹ï¼Œinterface å’Œå¯¹è±¡ç±»å‹å£°æ˜å¯ä¸å¯ä»¥ç”¨æ¥å£°æ˜æ•°ç»„å’Œå‡½æ•°ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> å¯ä»¥ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å£°æ˜æ•°ç»„</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">NumberArray</span> {
  [<span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>]: <span class="hljs-built_in">number</span>; <span class="hljs-comment">// ç´¢å¼•ç­¾å</span>
}
<span class="hljs-keyword">type</span> <span class="hljs-title class_">NumberArrayType</span> = <span class="hljs-built_in">number</span>[]; <span class="hljs-comment">// æ›´ç®€å•çš„æ–¹å¼</span>

<span class="hljs-comment">// å£°æ˜å‡½æ•°</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">SearchFunc</span> {
  (<span class="hljs-attr">source</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">subString</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">boolean</span>; <span class="hljs-comment">// è°ƒç”¨ç­¾å</span>
}
<span class="hljs-keyword">type</span> <span class="hljs-title class_">SearchFuncType</span> = <span class="hljs-function">(<span class="hljs-params">source: <span class="hljs-built_in">string</span>, subString: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">boolean</span>;
</code></pre>
<p><strong>é—®é¢˜ 16ï¼šå¦‚æœå£°æ˜å‡½æ•°ï¼Œå‡½æ•°åå¯ä¸å¯ä»¥é‡å¤ï¼Ÿå‡½æ•°åå¦‚æœé‡å¤ï¼Œæ„å‘³ç€ä»€ä¹ˆï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> åœ¨åŒä¸€ä¸ªä½œç”¨åŸŸå†…ï¼Œ<strong>ä¸å…è®¸</strong>ç›´æ¥å£°æ˜åŒåå‡½æ•°ï¼ˆä¼šæŠ¥é”™ï¼‰ã€‚ä½†åœ¨æ¥å£æˆ–ç±»ä¸­ï¼Œå¯ä»¥é€šè¿‡ <strong>å‡½æ•°é‡è½½</strong> æ¥å£°æ˜å¤šä¸ªåŒåä½†å‚æ•°/è¿”å›å€¼ä¸åŒçš„å‡½æ•°ç­¾åã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å‡½æ•°é‡è½½</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">greet</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">string</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">greet</span>(<span class="hljs-params">age: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">string</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">greet</span>(<span class="hljs-params">value: <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">string</span> {
  <span class="hljs-comment">// å®ç°...</span>
}
</code></pre>
<p>é‡å¤çš„å‡½æ•°åæ„å‘³ç€é‡è½½ï¼Œè°ƒç”¨æ—¶ä¼šæ ¹æ®ä¼ å…¥çš„å‚æ•°ç±»å‹æ¥åŒ¹é…å¯¹åº”çš„ç­¾åã€‚</p>
<hr/>
<h3 data-id="heading-7"><strong>Vue.js æ·±åº¦çŸ¥è¯†</strong></h3>
<p><strong>é—®é¢˜ 17ï¼šå¦‚æœä½ ç”¨çš„æ˜¯ Vueï¼Œåœ¨ Vue çš„ ts ç”¨æ³•ä¸­ï¼Œå“ªäº› api çš„ç”¨æ³•åˆ©ç”¨äº† ts è¿™ä¸€ç‰¹æ€§ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong></p>
<ol>
<li><strong>Props ç±»å‹å®šä¹‰ï¼š</strong> ä½¿ç”¨ <code>defineProps&lt;{ ... }&gt;()</code> è¿›è¡Œä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥ã€‚</li>
<li><strong>ç»„ä»¶å®ä¾‹ç±»å‹ï¼š</strong> ä½¿ç”¨ <code>InstanceType&lt;typeof MyComponent&gt;</code> æ¥è·å–æ¨¡æ¿å¼•ç”¨ï¼ˆrefï¼‰çš„ç±»å‹ã€‚</li>
<li><strong>Composables ç±»å‹æ¨æ–­ï¼š</strong> <code>ref</code>ï¼Œ <code>computed</code> ä¼šè‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œ<code>reactive</code> ä¹Ÿä¼šåŸºäºå¯¹è±¡å­—é¢é‡æ¨æ–­ã€‚</li>
<li><strong>äº‹ä»¶ç±»å‹å®šä¹‰ï¼š</strong> ä½¿ç”¨ <code>defineEmits&lt;{ ... }&gt;()</code> æ¥å®šä¹‰å’Œæ ¡éªŒç»„ä»¶å‘å‡ºçš„äº‹ä»¶åŠå…¶è½½è·ã€‚</li>
</ol>
<p><strong>é—®é¢˜ 18ï¼šVue ä¸­ï¼Œæ˜¯ä¸æ˜¯æ‰€æœ‰æƒ…å†µä¸‹ï¼Œtemplate éƒ½ä¼šè‡ªåŠ¨è·å– ref çš„ .value å±æ€§ï¼Ÿå¦‚æœä¸æ˜¯ï¼Œåˆ—ä¸¾ä¸ä¼šè‡ªåŠ¨è·å–çš„æƒ…å†µã€‚</strong>
<strong>ç­”æ¡ˆï¼š</strong> ä¸æ˜¯æ‰€æœ‰æƒ…å†µã€‚</p>
<ul>
<li><strong>ä¼šè‡ªåŠ¨è§£åŒ… .value çš„æƒ…å†µï¼š</strong>
<ul>
<li>åœ¨ <code>&lt;script setup&gt;</code> ä¸­å£°æ˜çš„é¡¶çº§ <code>ref</code>ï¼Œåœ¨æ¨¡æ¿ä¸­ç›´æ¥ä½¿ç”¨æ— éœ€ <code>.value</code>ã€‚</li>
<li><code>ref</code> åœ¨æ¨¡æ¿ä¸­ä½œä¸ºå“åº”å¼å¯¹è±¡çš„å±æ€§æ—¶ï¼ˆå¦‚ <code>obj.count</code>ï¼‰ï¼Œå¦‚æœè¯¥ <code>ref</code> æ˜¯é€šè¿‡ <code>reactive</code> è®¿é—®çš„ï¼Œä¼šè‡ªåŠ¨è§£åŒ…ã€‚</li>
</ul>
</li>
<li><strong>ä¸ä¼šè‡ªåŠ¨è§£åŒ…çš„æƒ…å†µï¼š</strong>
<ul>
<li>åœ¨ Options API çš„ <code>data()</code> å‡½æ•°ä¸­è¿”å›çš„å¯¹è±¡çš„å±æ€§ä¸æ˜¯ <code>ref</code>ï¼Œæ— éœ€è§£åŒ…ã€‚</li>
<li>å½“ <code>ref</code> æ˜¯<strong>æ•°ç»„æˆ– Map ç­‰åŸç”Ÿé›†åˆç±»å‹</strong>çš„ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œä¸ä¼šè‡ªåŠ¨è§£åŒ…ã€‚ä¾‹å¦‚ï¼š<code>const list = ref([1, 2, 3])</code>ï¼Œåœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ <code>list[0]</code> ä¸ä¼šè‡ªåŠ¨è§£åŒ…ï¼Œéœ€è¦ <code>list[0].value</code>ï¼ˆä½†åœ¨æ¨¡æ¿ä¸­åº”é¿å…è¿™æ ·å†™ï¼Œé€šå¸¸åº”è§£æ„åˆ°å“åº”å¼å¯¹è±¡ä¸­ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<p><strong>é—®é¢˜ 19ï¼šåœ¨ Vue å“åº”å¼ç³»ç»Ÿä¸­ï¼Œç»™å¯¹è±¡çš„å­å±æ€§å¯¹è±¡èµ‹å€¼ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œæ˜¯å¦è¿˜æœ‰å“åº”å¼ï¼Ÿè¯¦ç»†é˜è¿°ä¸€ä¸‹ã€‚</strong>
<strong>ç­”æ¡ˆï¼š</strong> <strong>æœ‰å“åº”å¼</strong>ï¼Œä½†éœ€è¦ç†è§£å…¶åŸç†ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">nested</span>: { <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> }
});

<span class="hljs-comment">// è¿™ä¸ªæ“ä½œæ˜¯å“åº”å¼çš„</span>
state.<span class="hljs-property">nested</span> = { <span class="hljs-attr">count</span>: <span class="hljs-number">1</span> }; <span class="hljs-comment">// Vue èƒ½æ£€æµ‹åˆ° `nested` å±æ€§è¢«é‡æ–°èµ‹å€¼äº†</span>
</code></pre>
<p>Vue çš„å“åº”å¼ç³»ç»Ÿé€šè¿‡ Proxy è·Ÿè¸ª<strong>å¯¹è±¡å±æ€§çš„è®¿é—®å’Œè®¾ç½®</strong>ã€‚å½“ä½ ç»™ <code>state.nested</code> èµ‹ä¸€ä¸ªæ–°å€¼æ—¶ï¼ŒVue ä¼šæ£€æµ‹åˆ°è¿™ä¸ªè®¾ç½®æ“ä½œï¼Œå¹¶è§¦å‘ç›¸åº”çš„æ›´æ–°ã€‚åŒæ—¶ï¼Œæ–°èµ‹å€¼çš„å¯¹è±¡ <code>{ count: 1 }</code> ä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸ºä¸€ä¸ªå“åº”å¼å¯¹è±¡ã€‚</p>
<p><strong>é—®é¢˜ 20ï¼šå¦‚æœä½ ä½¿ç”¨ Vue å’Œ pinia å¼€å‘äº†ä¸€ä¸ªåº”ç”¨ï¼Œç”¨åˆ°äº† persist æ’ä»¶è¿›è¡ŒæŒä¹…åŒ–ï¼Œç»“æœå‘ç°åº”ç”¨å¡é¡¿éš¾ä»¥æ¥å—ï¼Œè¯·é—®å¡é¡¿æœ€æœ‰å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> æœ€å¯èƒ½çš„åŸå› æ˜¯ <strong>æŒä¹…åŒ–çš„æ•°æ®é‡è¿‡å¤§æˆ–åºåˆ—åŒ–/ååºåˆ—åŒ–æ“ä½œè¿‡äºé¢‘ç¹</strong>ã€‚</p>
<ul>
<li><strong>å…·ä½“åŸå› ï¼š</strong>
<ol>
<li><strong>å¤§æ•°æ®é‡ï¼š</strong> å°†æ•´ä¸ªåºå¤§çš„çŠ¶æ€æ ‘ï¼ˆå¦‚å¤§å‹åˆ—è¡¨ã€å¤æ‚åµŒå¥—å¯¹è±¡ï¼‰æŒä¹…åŒ–åˆ° <code>localStorage</code>ï¼ˆåŒæ­¥ APIï¼‰ï¼Œæ¯æ¬¡è¯»å†™éƒ½ä¼šé˜»å¡ä¸»çº¿ç¨‹ã€‚</li>
<li><strong>é¢‘ç¹å­˜å‚¨ï¼š</strong> æ’ä»¶é…ç½®ä¸ºæ¯æ¬¡çŠ¶æ€å˜åŒ–éƒ½ç«‹å³æŒä¹…åŒ–ï¼ˆ<code>debounce</code> é…ç½®ä¸åˆç†ï¼‰ï¼Œå¯¼è‡´é¢‘ç¹çš„åŒæ­¥å†™å…¥æ“ä½œã€‚</li>
</ol>
</li>
<li><strong>è§£å†³æ–¹æ¡ˆï¼š</strong>
<ol>
<li>åªæŒä¹…åŒ–å¿…è¦çš„çŠ¶æ€ï¼Œä½¿ç”¨ <code>paths</code> é€‰é¡¹æ’é™¤å¤§æ•°æ®ã€‚</li>
<li>å¢åŠ é˜²æŠ–ï¼ˆdebounceï¼‰æ—¶é—´ï¼Œå‡å°‘æŒä¹…åŒ–é¢‘ç‡ã€‚</li>
<li>è€ƒè™‘ä½¿ç”¨å¼‚æ­¥å­˜å‚¨åç«¯ï¼Œå¦‚ <code>sessionStorage</code> æˆ– <code>IndexedDB</code>ï¼ˆå¦‚æœæ’ä»¶æ”¯æŒï¼‰ã€‚</li>
</ol>
</li>
</ul>
<p><strong>é—®é¢˜ 21ï¼šVue çš„å“åº”å¼ç³»ç»Ÿï¼Œå¯å¦ç”¨ä¸€ä¸ª class åˆå§‹åŒ–çš„å¯¹è±¡å£°æ˜ reactiveï¼Ÿä¼šæœ‰ä»€ä¹ˆåæœï¼Ÿï¼ˆå¦‚æœä»–äº†è§£ Reactï¼Œé—® React çš„ useState å¯ä¸å¯ä»¥ï¼‰</strong>
<strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><strong>Vueï¼š</strong> <strong>å¯ä»¥ï¼Œä½†ä¸æ¨èï¼Œå¯èƒ½ä¼šä¸¢å¤±å“åº”æ€§ã€‚</strong>
<ul>
<li><strong>åæœï¼š</strong> Vue çš„ <code>reactive()</code> API åŸºäº ES6 Proxyã€‚å¦‚æœä¸€ä¸ª class å®ä¾‹çš„å±æ€§æ˜¯åœ¨æ„é€ å‡½æ•°ä¸­é€šè¿‡ <code>this.key = value</code> å®šä¹‰çš„ï¼ŒProxy å¯ä»¥æ­£å¸¸å·¥ä½œã€‚ä½†å¦‚æœå±æ€§æ˜¯åœ¨ class çš„æ–¹æ³•ä¸­åŠ¨æ€æ·»åŠ çš„ï¼Œæˆ–è€…æ¶‰åŠç»§æ‰¿é“¾ï¼ŒVue å¯èƒ½æ— æ³•å¯é åœ°è¿½è¸ªè¿™äº›å˜åŒ–ã€‚æœ€ä½³å®è·µæ˜¯ä½¿ç”¨æ™®é€šå¯¹è±¡å­—é¢é‡ã€‚</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyState</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = <span class="hljs-number">0</span>; } <span class="hljs-comment">// å¯å“åº”</span>
  <span class="hljs-title function_">increment</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++; }     <span class="hljs-comment">// å¯å“åº”</span>
  <span class="hljs-title function_">addNewProp</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">this</span>.<span class="hljs-property">newProp</span> = <span class="hljs-number">1</span>; } <span class="hljs-comment">// å¯èƒ½æ— æ³•è¢« Vue è‡ªåŠ¨è¿½è¸ª</span>
}
<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyState</span>());
</code></pre>
</li>
<li><strong>Reactï¼š</strong> <strong>å¯ä»¥ï¼Œä½†æå…¶ä¸æ¨èã€‚</strong>
<ul>
<li><strong>åŸå› ï¼š</strong> React çš„çŠ¶æ€æ›´æ–°ä¾èµ–äº <code>setState</code> æˆ– setter å‡½æ•°è§¦å‘çš„é‡æ–°æ¸²æŸ“ã€‚ç›´æ¥ä¿®æ”¹ class å®ä¾‹çš„å±æ€§ï¼ˆ<code>myState.count++</code>ï¼‰ä¸ä¼šè§¦å‘æ¸²æŸ“ï¼Œå› ä¸º React æ— æ³•æ„ŸçŸ¥åˆ°å˜åŒ–ã€‚ä½ å¿…é¡»åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡å¼•ç”¨æ¥é©±åŠ¨æ›´æ–°ã€‚</li>
</ul>
</li>
</ul>
<p><strong>é—®é¢˜ 22ï¼šVue ä¸­çš„ pinia å’Œ pinia é…åˆä¾èµ–æ³¨å…¥ä½¿ç”¨ï¼Œä¸å•çº¯çš„ä¾èµ–æ³¨å…¥æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><strong>å•çº¯çš„ä¾èµ–æ³¨å…¥ï¼ˆprovide/injectï¼‰ï¼š</strong> æ˜¯ä¸€ç§ç›´æ¥çš„çˆ¶å­ç»„ä»¶é—´ä¼ é€’æ•°æ®/æ–¹æ³•çš„æ–¹å¼ã€‚å®ƒæ˜¯<strong>å±€éƒ¨çš„</strong>ï¼Œéœ€è¦åœ¨ä¸Šå±‚ç»„ä»¶ <code>provide</code>ï¼Œåœ¨ä¸‹å±‚ç»„ä»¶ <code>inject</code>ã€‚æ•°æ®æœ¬èº«ä¸ä¸€å®šæ˜¯å“åº”å¼çš„ï¼ˆé™¤éä½ æä¾›çš„æ˜¯ä¸€ä¸ª <code>ref</code> æˆ– <code>reactive</code> å¯¹è±¡ï¼‰ï¼Œå¹¶ä¸”ç¼ºä¹åƒ Pinia é‚£æ ·çš„é›†ä¸­å¼çŠ¶æ€ç®¡ç†ã€DevTools é›†æˆå’Œæ—¶é—´æ—…è¡Œè°ƒè¯•èƒ½åŠ›ã€‚</li>
<li><strong>Piniaï¼š</strong> æ˜¯<strong>å…¨å±€çŠ¶æ€ç®¡ç†åº“</strong>ã€‚å®ƒæä¾›äº†ä¸€ä¸ªä¸­å¿ƒåŒ–çš„ storeï¼Œä»»ä½•ç»„ä»¶éƒ½å¯ä»¥å¯¼å…¥å¹¶ä½¿ç”¨ã€‚çŠ¶æ€å¤©ç”Ÿæ˜¯å“åº”å¼çš„ï¼Œå¹¶å…·æœ‰å®Œå–„çš„æ¨¡å—åŒ–ã€TypeScript æ”¯æŒå’Œè°ƒè¯•å·¥å…·ã€‚</li>
<li><strong>Pinia + ä¾èµ–æ³¨å…¥ï¼š</strong> ç»“åˆä¸¤è€…ï¼Œé€šå¸¸æ˜¯ä¸ºäº† <strong>æ›´å¥½çš„æµ‹è¯•å’Œè§£è€¦</strong>ã€‚ä½ å¯ä»¥åœ¨æ ¹ç»„ä»¶æä¾›ä¸€ä¸ª Pinia store çš„å®ä¾‹ï¼Œç„¶ååœ¨å­ç»„ä»¶ä¸­æ³¨å…¥å®ƒã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œåœ¨æµ‹è¯•æ—¶ï¼Œä½ å¯ä»¥è½»æ¾åœ°æä¾›ä¸€ä¸ªæ¨¡æ‹Ÿçš„ store å®ä¾‹ç»™ç»„ä»¶ï¼Œè€Œä¸éœ€è¦ä¾èµ–çœŸå®çš„å…¨å±€ store å®ä¾‹ï¼Œä½¿å¾—æµ‹è¯•æ›´åŠ éš”ç¦»å’Œå®¹æ˜“ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-8"><strong>å·¥ç¨‹åŒ–ä¸ä¸šåŠ¡é€»è¾‘</strong></h3>
<p><strong>é—®é¢˜ 23ï¼šå¦‚æœé¡¹ç›®ä¸»åŒ…å¤ªå¤§ï¼Œæœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥ä¼˜åŒ–ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong></p>
<ol>
<li><strong>ä»£ç åˆ†å‰²ï¼ˆCode Splittingï¼‰ï¼š</strong> ä½¿ç”¨åŠ¨æ€ <code>import()</code> è¯­æ³•å®ç°è·¯ç”±çº§å’Œç»„ä»¶çº§æ‡’åŠ è½½ã€‚</li>
<li><strong>Tree Shakingï¼š</strong> ç¡®ä¿å¼•å…¥çš„ç¬¬ä¸‰æ–¹åº“æ”¯æŒ ES æ¨¡å—ï¼Œå¹¶åªå¼•å…¥éœ€è¦çš„éƒ¨åˆ†ã€‚</li>
<li><strong>åˆ†æåŒ…ä½“ç§¯ï¼š</strong> ä½¿ç”¨ <code>webpack-bundle-analyzer</code> ç­‰å·¥å…·æ‰¾å‡ºä½“ç§¯è¿‡å¤§çš„æ¨¡å—ã€‚</li>
<li><strong>å‹ç¼©èµ„æºï¼š</strong> ä½¿ç”¨ Terser å‹ç¼© JSï¼ŒCssMinimizer å‹ç¼© CSSã€‚</li>
<li><strong>ä¼˜åŒ–ç¬¬ä¸‰æ–¹åº“ï¼š</strong> è€ƒè™‘ç”¨æ›´è½»é‡çš„æ›¿ä»£å“ï¼ˆå¦‚ day.js ä»£æ›¿ moment.jsï¼‰ã€‚</li>
<li><strong>å›¾ç‰‡ç­‰èµ„æºå¤–éƒ¨åŒ–ã€‚</strong></li>
</ol>
<p><strong>é—®é¢˜ 24ï¼šå¦‚ä½•è§£å†³åˆ é™¤ä¸€ä¸ªé¡¹ç›®ä¹‹åï¼Œè¡¨æ ¼åˆ†é¡µä¸ºç©ºçš„é—®é¢˜ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> åœ¨æˆåŠŸåˆ é™¤ä¸€é¡¹åï¼Œéœ€è¦é‡æ–°è®¡ç®—å½“å‰é¡µç ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¼ªä»£ç </span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleDelete</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">id</span>) =&gt; {
  <span class="hljs-keyword">await</span> api.<span class="hljs-title function_">deleteItem</span>(id);
  <span class="hljs-comment">// åˆ é™¤æˆåŠŸå</span>
  <span class="hljs-keyword">const</span> currentPage = pagination.<span class="hljs-property">current</span>;
  <span class="hljs-keyword">const</span> totalAfterDelete = totalCount - <span class="hljs-number">1</span>;
  <span class="hljs-keyword">const</span> pageSize = pagination.<span class="hljs-property">pageSize</span>;

  <span class="hljs-comment">// å¦‚æœå½“å‰é¡µä¸å†æ˜¯æœ‰æ•ˆé¡µï¼ˆä¾‹å¦‚ï¼Œæœ€åä¸€é¡µçš„å”¯ä¸€ä¸€é¡¹è¢«åˆ é™¤äº†ï¼‰ï¼Œåˆ™è·³å›ä¸Šä¸€é¡µ</span>
  <span class="hljs-keyword">if</span> (currentPage &gt; <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(totalAfterDelete / pageSize)) {
    pagination.<span class="hljs-property">current</span> = currentPage - <span class="hljs-number">1</span>;
  }

  <span class="hljs-comment">// é‡æ–°è·å–æ•°æ®</span>
  <span class="hljs-title function_">fetchData</span>();
};
</code></pre>
<p><strong>é—®é¢˜ 25ï¼šä¸Šä¼ æ—¶ï¼Œå‡è®¾åç«¯æ²¡æœ‰ç”¨å¯¹è±¡å­˜å‚¨ï¼Œä½ åº”è¯¥å¦‚ä½•ä¸åç«¯é…åˆï¼Œå®ç°ä¸Šä¼ å’Œä¸‹è½½è¿›åº¦ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><strong>ä¸Šä¼ è¿›åº¦ï¼š</strong> ä½¿ç”¨ XMLHttpRequest æˆ– Axios ç­‰åº“çš„è¿›åº¦äº‹ä»¶ã€‚
<pre><code class="hljs language-javascript" lang="javascript">axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/upload'</span>, formData, {
  <span class="hljs-attr">onUploadProgress</span>: <span class="hljs-function">(<span class="hljs-params">progressEvent</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> percentCompleted = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>((progressEvent.<span class="hljs-property">loaded</span> * <span class="hljs-number">100</span>) / progressEvent.<span class="hljs-property">total</span>);
    <span class="hljs-comment">// æ›´æ–°è¿›åº¦æ¡</span>
  }
})
</code></pre>
</li>
<li>***   <strong>ä¸‹è½½è¿›åº¦ï¼š</strong> åŒæ ·åˆ©ç”¨è¿›åº¦äº‹ä»¶ï¼Œä½†éœ€è¦åç«¯åœ¨å“åº”å¤´ä¸­æ­£ç¡®è®¾ç½® <code>Content-Length</code>ã€‚
<pre><code class="hljs language-javascript" lang="javascript">axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/download/file.pdf'</span>, {
  <span class="hljs-attr">onDownloadProgress</span>: <span class="hljs-function">(<span class="hljs-params">progressEvent</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> percentCompleted = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>((progressEvent.<span class="hljs-property">loaded</span> * <span class="hljs-number">100</span>) / progressEvent.<span class="hljs-property">total</span>);
    <span class="hljs-comment">// æ›´æ–°è¿›åº¦æ¡</span>
  },
  <span class="hljs-attr">responseType</span>: <span class="hljs-string">'blob'</span> <span class="hljs-comment">// é‡è¦ï¼šå¯¹äºæ–‡ä»¶ä¸‹è½½</span>
})
</code></pre>
</li>
</ul>
<hr/>
<h3 data-id="heading-9"><strong>HTTP ç¼“å­˜ç­–ç•¥ä¸æœåŠ¡ç«¯æ¸²æŸ“</strong></h3>
<p><strong>é—®é¢˜ 26ï¼šstale-while-revalidate è¿™å­—æ®µå‡ºç°åœ¨ http ä»€ä¹ˆä½ç½®ï¼Œç”¨æ¥åšä»€ä¹ˆçš„ï¼Ÿå®ƒå’ŒæœåŠ¡ç«¯æ¸²æŸ“æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><strong>ä½ç½®ï¼š</strong> å®ƒæ˜¯ <code>Cache-Control</code> å“åº”å¤´çš„ä¸€ä¸ªæŒ‡ä»¤ï¼Œä¾‹å¦‚ï¼š<code>Cache-Control: max-age=600, stale-while-revalidate=30</code></li>
<li><strong>ä½œç”¨ï¼š</strong> åœ¨ <code>max-age</code>ï¼ˆ600ç§’ï¼‰è¿‡æœŸåï¼Œè¿˜æœ‰ä¸€ä¸ª <code>stale-while-revalidate</code>ï¼ˆ30ç§’ï¼‰çš„â€œå®½é™æœŸâ€ã€‚åœ¨è¿™30ç§’å†…ï¼Œæµè§ˆå™¨ä¼š<strong>ç«‹å³ä½¿ç”¨å·²è¿‡æœŸçš„ç¼“å­˜ï¼ˆstaleï¼‰</strong> æ¥å“åº”ç”¨æˆ·è¯·æ±‚ï¼ŒåŒæ—¶<strong>åœ¨åå°å‘æœåŠ¡å™¨å‘èµ·éªŒè¯è¯·æ±‚ï¼ˆrevalidateï¼‰</strong> ä»¥è·å–æœ€æ–°å†…å®¹å¹¶æ›´æ–°ç¼“å­˜ã€‚è¿™æå¤§åœ°æå‡äº†ç”¨æˆ·ä½“éªŒï¼Œå®ç°äº†â€œç¬é—´åŠ è½½â€ã€‚</li>
<li><strong>ä¸ SSR çš„å…³ç³»ï¼š</strong> åœ¨ SSR åº”ç”¨ä¸­ï¼ŒHTML é¡µé¢æœ¬èº«æ˜¯åŠ¨æ€çš„ã€‚å¦‚æœå¯¹ HTML é¡µé¢è®¾ç½® <code>stale-while-revalidate</code>ï¼Œå¯ä»¥è®©ç”¨æˆ·åœ¨é¡µé¢ç¼“å­˜è¿‡æœŸåä¾ç„¶èƒ½å¿«é€Ÿçœ‹åˆ°å†…å®¹ï¼ˆå³ä½¿æ˜¯ç•¥å¾®è¿‡æ—¶çš„å†…å®¹ï¼‰ï¼ŒåŒæ—¶åœ¨åå°è·å–æœ€æ–°çš„æœåŠ¡ç«¯æ¸²æŸ“é¡µé¢ã€‚è¿™å®Œç¾ç»“åˆäº†ç¼“å­˜çš„æ€§èƒ½å’Œ SSR çš„ SEO/é¦–å±ä¼˜åŠ¿ã€‚</li>
</ul>
<p><strong>é—®é¢˜ 27ï¼šå›½å†…çš„ç”Ÿæ€å¯¹è¿™ä¸ªå­—æ®µçš„æ”¯æŒç¨‹åº¦å¦‚ä½•ï¼Ÿä½ ä¼šåœ¨é¡¹ç›®ä¸­ä½¿ç”¨æœåŠ¡ç«¯æ¸²æŸ“ä¹ˆï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><strong>æ”¯æŒç¨‹åº¦ï¼š</strong> ä¸»æµç°ä»£æµè§ˆå™¨ï¼ˆChrome, Edge, Firefox, Safariï¼‰å‡å·²æ”¯æŒã€‚å›½å†…ç§»åŠ¨ç«¯æµè§ˆå™¨ï¼ˆå¦‚ UCã€QQï¼‰å†…æ ¸è¾ƒè€ï¼Œå¯èƒ½å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ï¼Œéœ€æ ¹æ®ç›®æ ‡ç”¨æˆ·ç¾¤ä½“å†³å®šæ˜¯å¦ä½¿ç”¨ã€‚</li>
<li><strong>æ˜¯å¦ä½¿ç”¨ SSRï¼š</strong>
<ul>
<li><strong>ä¼šç”¨ SSR çš„åœºæ™¯ï¼š</strong> å¯¹ SEO æœ‰æé«˜è¦æ±‚çš„ ToC ç½‘ç«™ï¼ˆå¦‚å®˜ç½‘ã€åšå®¢ã€ç”µå•†åˆ—è¡¨é¡µï¼‰ã€å¯¹é¦–å±åŠ è½½é€Ÿåº¦æœ‰æè‡´è¿½æ±‚çš„åº”ç”¨ã€‚</li>
<li><strong>ä¸ä¼šç”¨ SSR çš„åœºæ™¯ï¼š</strong> å¤æ‚çš„åå°ç®¡ç†ç³»ç»Ÿã€å¼ºäº¤äº’å‹ Web Appã€å¯¹æœç´¢å¼•æ“æ— éœ€æ±‚çš„å†…éƒ¨å·¥å…·ã€‚åœ¨è¿™äº›åœºæ™¯ä¸‹ï¼ŒSSR å¸¦æ¥çš„æœåŠ¡å™¨æˆæœ¬å’Œæ¶æ„å¤æ‚æ€§å¯èƒ½å¾—ä¸å¿å¤±ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h3 data-id="heading-10"><strong>æ•°æ®è¿ç§»ä¸é”™è¯¯å¤„ç†</strong></h3>
<p><strong>é—®é¢˜ 28ï¼šå‡è®¾ä½ åœ¨ localStorage æˆ–è€… indexedDB ä¸­å­˜å‚¨äº†æ•°æ®ç»“æ„ï¼Œä½†æ˜¯ç‰ˆæœ¬æ›´æ–°åéœ€è¦ç”¨æ–°çš„æ•°æ®ç»“æ„ï¼Œä½ ä¼šç”¨ä»€ä¹ˆæ–¹æ³•è¿›è¡Œè¿ç§»ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> å®æ–½ä¸€ä¸ª<strong>ç‰ˆæœ¬åŒ–è¿ç§»ç­–ç•¥</strong>ã€‚</p>
<ol>
<li><strong>å­˜å‚¨ç‰ˆæœ¬å·ï¼š</strong> åœ¨å­˜å‚¨æ•°æ®æ—¶ï¼ŒåŒæ—¶å­˜å‚¨ä¸€ä¸ªç‰ˆæœ¬å·ï¼ˆå¦‚ <code>dataVersion: '1.0'</code>ï¼‰ã€‚</li>
<li><strong>å¯åŠ¨æ—¶æ£€æŸ¥ï¼š</strong> åº”ç”¨å¯åŠ¨æ—¶ï¼Œè¯»å–å½“å‰å­˜å‚¨çš„ç‰ˆæœ¬å·ï¼Œå¹¶ä¸ä»£ç ä¸­æœŸæœ›çš„æœ€æ–°ç‰ˆæœ¬å·æ¯”è¾ƒã€‚</li>
<li><strong>æ‰§è¡Œè¿ç§»ï¼š</strong> å¦‚æœç‰ˆæœ¬ä¸ä¸€è‡´ï¼Œåˆ™æŒ‰é¡ºåºæ‰§è¡Œä»ä¸€ä¸ªç‰ˆæœ¬åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬çš„è¿ç§»å‡½æ•°ã€‚</li>
<li><strong>æ›´æ–°ç‰ˆæœ¬å·ï¼š</strong> è¿ç§»æˆåŠŸåï¼Œæ›´æ–°å­˜å‚¨ä¸­çš„ç‰ˆæœ¬å·ä¸ºæœ€æ–°ç‰ˆã€‚</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è¿ç§»å‡½æ•°ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">migrateUserData</span> = (<span class="hljs-params">oldData</span>) =&gt; {
  <span class="hljs-keyword">const</span> currentVersion = oldData.<span class="hljs-property">version</span> || <span class="hljs-string">'1.0'</span>;
  <span class="hljs-keyword">if</span> (currentVersion === <span class="hljs-string">'1.0'</span>) {
    <span class="hljs-comment">// ä» 1.0 è¿ç§»åˆ° 2.0</span>
    <span class="hljs-keyword">const</span> newData = {
      <span class="hljs-attr">version</span>: <span class="hljs-string">'2.0'</span>,
      <span class="hljs-attr">profile</span>: { ...oldData.<span class="hljs-property">userInfo</span> } <span class="hljs-comment">// è½¬æ¢æ•°æ®ç»“æ„</span>
    };
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'userData'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(newData));
    <span class="hljs-keyword">return</span> newData;
  }
  <span class="hljs-comment">// ... å…¶ä»–ç‰ˆæœ¬è¿ç§»</span>
};
</code></pre>
<p><strong>é—®é¢˜ 29ï¼šå‡è®¾æ˜¯æ··åˆåº”ç”¨ï¼Œç”¨æˆ·å¯èƒ½ç”¨ç€å„ç§å†å²ç‰ˆæœ¬ï¼Œåˆè¯¥å¦‚ä½•è¿ç§»ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> è¿ç§»ç­–ç•¥éœ€è¦æ˜¯<strong>å¹‚ç­‰</strong>å’Œ<strong>å‘åå…¼å®¹</strong>çš„ã€‚</p>
<ul>
<li><strong>å¹‚ç­‰ï¼š</strong> åŒä¸€ä¸ªè¿ç§»å‡½æ•°æ‰§è¡Œå¤šæ¬¡çš„ç»“æœåº”è¯¥æ˜¯ä¸€æ ·çš„ã€‚é¿å…å› é‡å¤æ‰§è¡Œå¯¼è‡´æ•°æ®é”™è¯¯ã€‚</li>
<li><strong>å‘åå…¼å®¹ï¼š</strong> æ–°ç‰ˆæœ¬çš„ä»£ç åº”è¯¥èƒ½å¤Ÿè¯»å–å’Œç†è§£æ—§ç‰ˆæœ¬çš„æ•°æ®ç»“æ„ã€‚åœ¨è¿ç§»å®Œæˆå‰ï¼Œåº”ç”¨é€»è¾‘åº”èƒ½å¤„ç†æ–°æ—§ä¸¤ç§æ•°æ®ç»“æ„ã€‚</li>
</ul>
<p><strong>é—®é¢˜ 30ï¼šå¦‚æœç”¨æˆ·å› ä¸ºæ•°æ®è¿ç§»å‡ºç°äº†ç™½å±ï¼Œå¦‚ä½•å®šä½é—®é¢˜ï¼Ÿå¦‚ä½•åŠæ—¶è¡¥æ•‘ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><strong>å®šä½é—®é¢˜ï¼š</strong>
<ol>
<li><strong>é”™è¯¯ç›‘æ§ï¼š</strong> æ¥å…¥ Sentry ç­‰é”™è¯¯ç›‘æ§å¹³å°ï¼Œæ•è·è¿ç§»è¿‡ç¨‹ä¸­æŠ›å‡ºçš„å¼‚å¸¸ã€‚</li>
<li><strong>æ—¥å¿—è®°å½•ï¼š</strong> åœ¨è¿ç§»çš„å…³é”®æ­¥éª¤ä¸­åŠ å…¥è¯¦ç»†çš„æ—¥å¿—ï¼Œè®°å½•æ—§ç‰ˆæœ¬å·ã€æ–°ç‰ˆæœ¬å·ã€è¿ç§»ç»“æœç­‰ã€‚</li>
<li><strong>ç”¨æˆ·åé¦ˆï¼š</strong> å»ºç«‹ç”¨æˆ·åé¦ˆæ¸ é“ï¼Œæ”¶é›†å‡ºç°ç™½å±çš„ç”¨æˆ·çš„æµè§ˆå™¨ç‰ˆæœ¬ã€æ“ä½œæ­¥éª¤ç­‰ä¿¡æ¯ã€‚</li>
</ol>
</li>
<li><strong>åŠæ—¶è¡¥æ•‘ï¼š</strong>
<ol>
<li><strong>å®‰å…¨æ¨¡å¼ï¼š</strong> åœ¨è¿ç§»ä»£ç å¤–å›´ä½¿ç”¨ <code>try-catch</code>ã€‚å¦‚æœè¿ç§»å¤±è´¥ï¼Œæ•è·é”™è¯¯ï¼Œæ¸…é™¤æŸåçš„å­˜å‚¨æ•°æ®æˆ–å›é€€åˆ°æ—§ç‰ˆæœ¬æ•°æ®ç»“æ„ï¼Œå¹¶å¼•å¯¼ç”¨æˆ·é‡æ–°åˆå§‹åŒ–åº”ç”¨ã€‚</li>
<li><strong>çƒ­ä¿®å¤ï¼š</strong> å¦‚æœé—®é¢˜æ™®éï¼Œé€šè¿‡çƒ­ä¿®å¤å¹³å°ç´§æ€¥ä¸‹å‘ä¿®å¤è¡¥ä¸ï¼Œä¿®æ­£è¿ç§»é€»è¾‘ã€‚</li>
<li><strong>ç‰ˆæœ¬å›é€€ï¼š</strong> åœ¨ä¸¥é‡æƒ…å†µä¸‹ï¼Œå¯ä»¥è€ƒè™‘å›é€€åº”ç”¨ç‰ˆæœ¬ã€‚</li>
</ol>
</li>
</ul>
<hr/>
<h3 data-id="heading-11"><strong>å¯Œæ–‡æœ¬ä¸åä½œ</strong></h3>
<p><strong>é—®é¢˜ 31ï¼šåœ¨åŸºç¡€å¯Œæ–‡æœ¬å¼€å‘ä¸­ï¼Œå¦‚æœå…‰æ ‡è·¨è¶Šäº†å¤šä¸ªèŠ‚ç‚¹ï¼Œå¦‚ä½•æ­£ç¡®é€šè¿‡ getSelection è¿›è¡Œé€‰å–ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> ä½¿ç”¨ <code>Selection</code> å’Œ <code>Range</code> APIã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> selection = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getSelection</span>();
<span class="hljs-comment">// è·å–ç”¨æˆ·é€‰ä¸­çš„èŒƒå›´</span>
<span class="hljs-keyword">if</span> (selection.<span class="hljs-property">rangeCount</span> &gt; <span class="hljs-number">0</span>) {
  <span class="hljs-keyword">const</span> range = selection.<span class="hljs-title function_">getRangeAt</span>(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> startContainer = range.<span class="hljs-property">startContainer</span>; <span class="hljs-comment">// èµ·å§‹èŠ‚ç‚¹</span>
  <span class="hljs-keyword">const</span> startOffset = range.<span class="hljs-property">startOffset</span>;       <span class="hljs-comment">// èµ·å§‹åç§»é‡</span>
  <span class="hljs-keyword">const</span> endContainer = range.<span class="hljs-property">endContainer</span>;     <span class="hljs-comment">// ç»“æŸèŠ‚ç‚¹</span>
  <span class="hljs-keyword">const</span> endOffset = range.<span class="hljs-property">endOffset</span>;           <span class="hljs-comment">// ç»“æŸåç§»é‡</span>

  <span class="hljs-comment">// ç°åœ¨ä½ å¯ä»¥æ“ä½œè¿™ä¸ª rangeï¼Œä¾‹å¦‚æ’å…¥èŠ‚ç‚¹ã€è·å–é€‰ä¸­å†…å®¹ç­‰</span>
  <span class="hljs-keyword">const</span> selectedContent = range.<span class="hljs-title function_">cloneContents</span>();
}
</code></pre>
<p><strong>é—®é¢˜ 32ï¼šå¦‚æœä¸ä½¿ç”¨æµè§ˆå™¨é»˜è®¤é«˜äº®ï¼Œå¦‚ä½•è®©è¿™äº›é€‰åŒºé«˜äº®èµ·æ¥ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> æ‰‹åŠ¨é«˜äº®ã€‚</p>
<ol>
<li><strong>éå†èŒƒå›´å†…å®¹ï¼š</strong> ä½¿ç”¨ <code>Range</code> çš„ <code>.cloneContents()</code> æˆ– <code>.extractContents()</code> æ–¹æ³•è·å–é€‰åŒºå†…çš„ DOM èŠ‚ç‚¹ã€‚</li>
<li><strong>åŒ…è£¹é«˜äº®å…ƒç´ ï¼š</strong> éå†è¿™äº›èŠ‚ç‚¹ï¼Œç”¨å¸¦æœ‰é«˜äº®æ ·å¼ï¼ˆå¦‚ <code>background-color: yellow;</code>ï¼‰çš„ HTML å…ƒç´ ï¼ˆå¦‚ <code>&lt;mark&gt;</code> æˆ– <code>&lt;span&gt;</code>ï¼‰å°†æ–‡æœ¬èŠ‚ç‚¹åŒ…è£¹èµ·æ¥ã€‚</li>
<li><strong>é‡æ–°æ’å…¥ï¼š</strong> å°†å¤„ç†åçš„èŠ‚ç‚¹é‡æ–°æ’å…¥åˆ° DOM ä¸­ã€‚æ›´é«˜çº§çš„åšæ³•æ˜¯ä½¿ç”¨ <code>CSS.highlights</code> APIï¼ˆå®éªŒæ€§ï¼‰ã€‚</li>
</ol>
<p><strong>é—®é¢˜ 33ï¼šå¤šäººå…±åŒç¼–è¾‘çš„æ–‡æ¡£ï¼Œå¦‚ä½•ä¿è¯äº‘ç«¯ç¼“å­˜å’Œæœ¬åœ°ç¼“å­˜çš„ä¸€è‡´æ€§ï¼Ÿè¿™æ–¹é¢å¦‚ä½•ä¸åç«¯é…åˆï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> ä½¿ç”¨ <strong>æ“ä½œè½¬æ¢ï¼ˆOTï¼‰</strong> æˆ– <strong>å†²çª-free å¤åˆ¶æ•°æ®ç±»å‹ï¼ˆCRDTï¼‰</strong> ç®—æ³•ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong> ä¸æ˜¯ç®€å•åœ°è¦†ç›–æ•°æ®ï¼Œè€Œæ˜¯å°†ç”¨æˆ·çš„æ“ä½œï¼ˆå¦‚â€œåœ¨ä½ç½®5æ’å…¥å­—ç¬¦â€˜Aâ€™â€ï¼‰ä½œä¸ºæŒ‡ä»¤å‘é€åˆ°æœåŠ¡ç«¯ã€‚</li>
<li><strong>ä¸åç«¯é…åˆï¼š</strong>
<ol>
<li><strong>ç‰ˆæœ¬æ§åˆ¶ï¼š</strong> æ¯ä¸ªæ“ä½œéƒ½æœ‰ä¸€ä¸ªç‰ˆæœ¬å·ï¼ˆæˆ–å‘é‡æ—¶é’Ÿï¼‰ã€‚</li>
<li><strong>æœåŠ¡ç«¯åè°ƒï¼š</strong> åç«¯ä½œä¸ºä¸­å¤®åè°ƒè€…ï¼Œæ¥æ”¶æ¥è‡ªå„å®¢æˆ·ç«¯çš„æ“ä½œï¼Œè¿›è¡Œè½¬æ¢ï¼ˆè§£å†³å†²çªï¼Œä¾‹å¦‚ä¸¤ä¸ªç”¨æˆ·åŒæ—¶åœ¨ä½ç½®5æ’å…¥ä¸åŒå­—ç¬¦ï¼‰ï¼Œç„¶åå¹¿æ’­è½¬æ¢åçš„æ“ä½œç»™æ‰€æœ‰å®¢æˆ·ç«¯ã€‚</li>
<li><strong>ç¡®è®¤æœºåˆ¶ï¼š</strong> å®¢æˆ·ç«¯åªæœ‰æ”¶åˆ°æœåŠ¡ç«¯ç¡®è®¤çš„æ“ä½œæ‰ä¼šåº”ç”¨åˆ°æœ¬åœ°æ–‡æ¡£ï¼Œç¡®ä¿æœ€ç»ˆä¸€è‡´æ€§ã€‚</li>
</ol>
</li>
</ul>
<hr/>
<h3 data-id="heading-12"><strong>æµè§ˆå™¨å®‰å…¨ä¸å›¾å½¢å­¦</strong></h3>
<p><strong>é—®é¢˜ 34ï¼šå¦‚æœä½¿ç”¨æµè§ˆå™¨ç”¨æˆ·æ ‡è¯†ï¼Œå¹¶è¿›è¡Œæ’ä»¶å¼€å‘ï¼Œæ’ä»¶ä¸­æœ‰ä¸ª iframeï¼Œè¯·é—® iframe é‡Œé¢çš„ç”¨æˆ·æ ‡è¯†å’Œæ’ä»¶çš„ç”¨æˆ·æ ‡è¯†ï¼Œæ˜¯åŒä¸€ä¸ªï¼Œè¿˜æ˜¯ä¸åŒçš„ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> è¿™å–å†³äº iframe çš„æºï¼ˆoriginï¼‰ã€‚</p>
<ul>
<li><strong>åŒæº iframeï¼š</strong> <strong>æ˜¯åŒä¸€ä¸ª</strong>ã€‚å®ƒä»¬å…±äº«ç›¸åŒçš„ originï¼Œå› æ­¤å…±äº«ç›¸åŒçš„å­˜å‚¨ï¼ˆå¦‚ localStorageï¼‰ã€Cookie å’Œç”¨æˆ·æ ‡è¯†ã€‚</li>
<li><strong>è·¨åŸŸ iframeï¼š</strong> <strong>æ˜¯ä¸åŒçš„</strong>ã€‚ç”±äºæµè§ˆå™¨çš„åŒæºç­–ç•¥ï¼Œæ’ä»¶çš„ä¸Šä¸‹æ–‡å’Œè·¨åŸŸ iframe çš„ä¸Šä¸‹æ–‡æ˜¯ç›¸äº’éš”ç¦»çš„ã€‚å®ƒä»¬æ‹¥æœ‰ç‹¬ç«‹çš„å­˜å‚¨ç©ºé—´å’Œç”¨æˆ·æ ‡è¯†ã€‚é€šä¿¡éœ€è¦é€šè¿‡ <code>postMessage</code> APIã€‚</li>
</ul>
<p><strong>é—®é¢˜ 35ï¼šå¦‚ä½•å®ç°æå–å›¾ç‰‡ä¸»é¢˜é¢œè‰²å’Œåˆ†çº§é¢œè‰²çš„åŠŸèƒ½ï¼Œå¦‚æœå®ç°äº†ï¼Œå¯¹åç«¯æœ‰ä»€ä¹ˆè¦æ±‚ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><strong>å‰ç«¯å®ç°ï¼š</strong>
<ol>
<li>ä½¿ç”¨ <code>Canvas</code> API å°†å›¾ç‰‡ç»˜åˆ¶åˆ°ç”»å¸ƒä¸Šã€‚</li>
<li>é€šè¿‡ <code>getImageData()</code> æ–¹æ³•è·å–åƒç´ æ•°æ®ï¼ˆä¸€ä¸ªåŒ…å« RGBA å€¼çš„å·¨å¤§æ•°ç»„ï¼‰ã€‚</li>
<li>ä½¿ç”¨èšç±»ç®—æ³•ï¼ˆå¦‚ K-meansï¼‰æˆ–é‡åŒ–ç®—æ³•å¯¹åƒç´ é¢œè‰²è¿›è¡Œåˆ†ç»„ï¼Œæ‰¾å‡ºä¸»è¦çš„é¢œè‰²ç°‡ã€‚</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> img = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();
img.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'canvas'</span>);
  <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'2d'</span>);
  ctx.<span class="hljs-title function_">drawImage</span>(img, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> imageData = ctx.<span class="hljs-title function_">getImageData</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, img.<span class="hljs-property">width</span>, img.<span class="hljs-property">height</span>).<span class="hljs-property">data</span>;
  <span class="hljs-comment">// åˆ†æ imageDataï¼Œæå–ä¸»é¢˜è‰²</span>
};
img.<span class="hljs-property">src</span> = <span class="hljs-string">'image.jpg'</span>;
</code></pre>
</li>
<li><strong>å¯¹åç«¯çš„è¦æ±‚ï¼š</strong> å¦‚æœåœ¨å‰ç«¯å¤„ç†å¤§å›¾ç‰‡å¯èƒ½æ€§èƒ½ä¸ä½³ï¼Œå¯ä»¥å°†æ­¤ä»»åŠ¡<strong>å¸è½½åˆ°åç«¯</strong>ã€‚åç«¯éœ€è¦æä¾›ç›¸åº”çš„å›¾ç‰‡å¤„ç†æ¥å£ï¼Œæ¥æ”¶å›¾ç‰‡æ–‡ä»¶ï¼Œè¿”å›åˆ†æå‡ºçš„ä¸»é¢˜è‰²æ•°ç»„ã€‚è¿™è¦æ±‚åç«¯æœ‰å¼ºå¤§çš„å›¾ç‰‡å¤„ç†èƒ½åŠ›å’Œè®¡ç®—èµ„æºã€‚</li>
</ul>
<p><strong>é—®é¢˜ 36ï¼šhsl å’Œ oklch é¢œè‰²è¡¨ç¤ºæ³•ç›¸æ¯” rgb å¥½åœ¨å“ªé‡Œï¼Ÿæœ‰å“ªäº›å‰ç«¯ UI æ¡†æ¶ä½¿ç”¨äº†è¿™äº›è‰²å½©è¡¨ç¤ºæ³•ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><strong>ä¼˜åŠ¿ï¼š</strong>
<ul>
<li><strong>HSLï¼ˆHue, Saturation, Lightnessï¼‰ï¼š</strong> æ›´ç›´è§‚ï¼Œæ˜“äºäººç±»ç†è§£å’Œè°ƒæ•´ã€‚æ¯”å¦‚ï¼Œæƒ³å¾—åˆ°ä¸€ä¸ªæ›´æ·±çš„è“è‰²ï¼Œåªéœ€å‡å° Lï¼ˆæ˜åº¦ï¼‰å€¼ã€‚</li>
<li><strong>OKLCHï¼š</strong> æ˜¯åŸºäº OKLab è‰²å½©ç©ºé—´çš„æ”¹è¿›ç‰ˆï¼Œæ¯” HSL å’Œ RGB <strong>åœ¨æ„ŸçŸ¥ä¸Šæ›´å‡åŒ€</strong>ã€‚è¿™æ„å‘³ç€ï¼Œé¢œè‰²æ•°å€¼ä¸Šçš„ç­‰é‡å˜åŒ–ï¼Œä¼šå¸¦æ¥äººçœ¼æ„ŸçŸ¥ä¸Šæ¥è¿‘çš„è§†è§‰å˜åŒ–ã€‚è¿™å¯¹äºç”Ÿæˆå’Œè°çš„è°ƒè‰²æ¿ã€æ— éšœç¢è®¾è®¡å’Œä¸»é¢˜åˆ‡æ¢è‡³å…³é‡è¦ã€‚</li>
</ul>
</li>
<li><strong>ä½¿ç”¨æ¡†æ¶ï¼š</strong>
<ul>
<li><strong>Tailwind CSS v3.x</strong> å·²åœ¨å…¶é»˜è®¤è°ƒè‰²æ¿ä¸­ä½¿ç”¨äº† OKLCHã€‚</li>
<li><strong>Adobe çš„ Spectrum</strong> è®¾è®¡ç³»ç»Ÿä¹Ÿåœ¨å‘ OKLCH è¿ç§»ã€‚</li>
<li>è®¸å¤šæ–°å…´çš„ CSS-in-JS åº“å’Œä¸»é¢˜ç³»ç»Ÿå¼€å§‹æ”¯æŒ OKLCHã€‚</li>
</ul>
</li>
</ul>
<p><strong>é—®é¢˜ 37ï¼šå¦‚æœè¦ä½ åˆ©ç”¨å…¶åšä¸€ä¸ªå¤šä¸»é¢˜ç³»ç»Ÿï¼Œä½ ä¼šå¦‚ä½•è®¾è®¡æ¶æ„ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong> é‡‡ç”¨ <strong>CSS å˜é‡ï¼ˆCustom Propertiesï¼‰ + OKLCH/HSL</strong> çš„æ¶æ„ã€‚</p>
<ol>
<li><strong>å®šä¹‰è®¾è®¡ä»¤ç‰Œï¼š</strong> ä½¿ç”¨ OKLCH å®šä¹‰ä¸€å¥—æ ¸å¿ƒçš„é¢œè‰²ã€é—´è·ã€å­—ä½“ç­‰å˜é‡ã€‚
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-pseudo">:root</span> {
  <span class="hljs-attr">--primary-color</span>: <span class="hljs-built_in">lch</span>(<span class="hljs-number">60%</span> <span class="hljs-number">60</span> <span class="hljs-number">250</span>); <span class="hljs-comment">/* ä½¿ç”¨ OKLCH */</span>
  <span class="hljs-attr">--text-color</span>: <span class="hljs-built_in">lch</span>(<span class="hljs-number">20%</span> <span class="hljs-number">5</span> <span class="hljs-number">250</span>);
  <span class="hljs-attr">--spacing-unit</span>: <span class="hljs-number">8px</span>;
}
</code></pre>
</li>
<li><strong>ä¸»é¢˜æ´¾ç”Ÿï¼š</strong> é€šè¿‡è¦†ç›–è¿™äº› CSS å˜é‡çš„å€¼æ¥åˆ›å»ºä¸åŒçš„ä¸»é¢˜ã€‚
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.theme-dark</span> {
  <span class="hljs-attr">--primary-color</span>: <span class="hljs-built_in">lch</span>(<span class="hljs-number">80%</span> <span class="hljs-number">50</span> <span class="hljs-number">250</span>);
  <span class="hljs-attr">--text-color</span>: <span class="hljs-built_in">lch</span>(<span class="hljs-number">90%</span> <span class="hljs-number">5</span> <span class="hljs-number">250</span>);
}
</code></pre>
</li>
<li><strong>ç»„ä»¶ä½¿ç”¨ï¼š</strong> åœ¨æ‰€æœ‰ç»„ä»¶ä¸­åªä½¿ç”¨è¿™äº›è®¾è®¡ä»¤ç‰Œå˜é‡ã€‚
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.button</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">var</span>(--primary-color);
  <span class="hljs-attribute">color</span>: <span class="hljs-built_in">var</span>(--text-color);
  <span class="hljs-attribute">padding</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-built_in">var</span>(--spacing-unit) * <span class="hljs-number">2</span>);
}
</code></pre>
</li>
<li><strong>åŠ¨æ€åˆ‡æ¢ï¼š</strong> é€šè¿‡ JavaScript åˆ‡æ¢æ ¹å…ƒç´ æˆ– body å…ƒç´ çš„ç±»åï¼Œå³å¯å®ç°ä¸»é¢˜çš„åŠ¨æ€åˆ‡æ¢ã€‚OKLCH çš„æ„ŸçŸ¥å‡åŒ€æ€§ä¿è¯äº†ä¸åŒä¸»é¢˜ä¸‹çš„è§†è§‰å’Œè°åº¦ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-13"><strong>HTTP RESTful API</strong></h3>
<p><strong>é—®é¢˜ 38ï¼šhttp RESTFUL è¯·æ±‚ä¸­ï¼Œput å’Œ post åˆ†åˆ«ä»£è¡¨ä»€ä¹ˆï¼Ÿput åˆ†åˆ«ä»£è¡¨æ–°å¢å’Œä¿®æ”¹çš„æƒ…å†µä¸‹ï¼Œå‰åç«¯çš„æ•°æ®å’Œé€»è¾‘ä¼šæœ‰æ€æ ·çš„å·®å¼‚ï¼Ÿ</strong>
<strong>ç­”æ¡ˆï¼š</strong></p>
<ul>
<li><strong>POSTï¼š</strong> ç”¨äº<strong>åˆ›å»º</strong>æ–°èµ„æºã€‚å®ƒæ˜¯<strong>éå¹‚ç­‰</strong>çš„ï¼ˆå¤šæ¬¡è°ƒç”¨ä¼šäº§ç”Ÿå¤šä¸ªèµ„æºï¼‰ã€‚é€šå¸¸ï¼ŒURL æŒ‡å‘çš„æ˜¯èµ„æºé›†åˆï¼ˆå¦‚ <code>/api/users</code>ï¼‰ï¼Œè¯·æ±‚ä½“åŒ…å«æ–°èµ„æºçš„è¯¦ç»†ä¿¡æ¯ã€‚å“åº”é€šå¸¸è¿”å› <code>201 Created</code> å’Œæ–°èµ„æºçš„ URIã€‚</li>
<li><strong>PUTï¼š</strong> ç”¨äº<strong>æ›´æ–°/æ›¿æ¢</strong>ç°æœ‰èµ„æºï¼Œæˆ–<strong>åœ¨å®¢æˆ·ç«¯çŸ¥é“èµ„æºæœ€ç»ˆ URI æ—¶åˆ›å»º</strong>èµ„æºã€‚å®ƒæ˜¯<strong>å¹‚ç­‰</strong>çš„ï¼ˆå¤šæ¬¡è°ƒç”¨æ•ˆæœç›¸åŒï¼‰ã€‚
<ul>
<li><strong>ç”¨äºä¿®æ”¹ï¼ˆæ›´æ–°ï¼‰ï¼š</strong> URL æŒ‡å‘ä¸€ä¸ªç‰¹å®šçš„èµ„æºï¼ˆå¦‚ <code>/api/users/123</code>ï¼‰ã€‚è¯·æ±‚ä½“åº”åŒ…å«è¯¥èµ„æºçš„<strong>å®Œæ•´è¡¨ç¤º</strong>ã€‚åç«¯é€»è¾‘æ˜¯<strong>ç”¨è¯·æ±‚ä½“æä¾›çš„æ•°æ®å®Œå…¨æ›¿æ¢</strong>ç›®æ ‡èµ„æºã€‚å¦‚æœèµ„æºä¸å­˜åœ¨ï¼Œå¯ä»¥è¿”å› <code>404 Not Found</code>ï¼Œæˆ–è€…æ ¹æ®çº¦å®šåˆ›å»ºå®ƒï¼ˆè¿”å› <code>201 Created</code>ï¼‰ã€‚</li>
<li><strong>ç”¨äºæ–°å¢ï¼ˆåˆ›å»ºï¼‰ï¼š</strong> å®¢æˆ·ç«¯æ˜ç¡®æŒ‡å®šæ–°èµ„æºçš„ URIï¼ˆå¦‚ <code>/api/users/123</code>ï¼‰ã€‚åç«¯æ£€æŸ¥è¯¥ URI æ˜¯å¦å­˜åœ¨èµ„æºã€‚å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºï¼›å¦‚æœå·²å­˜åœ¨ï¼Œåˆ™å®Œå…¨æ›¿æ¢ã€‚è¿™è¦æ±‚å®¢æˆ·ç«¯æ‹¥æœ‰åˆ†é…èµ„æº ID çš„èƒ½åŠ›ã€‚</li>
</ul>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Promiseé™æ€æ–¹æ³•è§£æ]]></title>    <link>https://juejin.cn/post/7591715454135566399</link>    <guid>https://juejin.cn/post/7591715454135566399</guid>    <pubDate>2026-01-06T03:15:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591715454135566399" data-draft-id="7591730714141392938" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Promiseé™æ€æ–¹æ³•è§£æ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-06T03:15:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="wuhen_n"/> <meta itemprop="url" content="https://juejin.cn/user/4149996261738233"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Promiseé™æ€æ–¹æ³•è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4149996261738233/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    wuhen_n
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T03:15:11.000Z" title="Tue Jan 06 2026 03:15:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬ä¸“æ èšç„¦Promiseçš„æ ¸å¿ƒåŸç†ä¸é«˜çº§åº”ç”¨ï¼ŒåŒ…å«ï¼š
âœ“ Promise A+è§„èŒƒæ·±åº¦è§£è¯»
âœ“ æ‰‹å†™å®ç°ä¸æºç åˆ†æ
âœ“ å¼‚æ­¥ç¼–ç¨‹è®¾è®¡æ¨¡å¼
âœ“ æ€§èƒ½è°ƒä¼˜ä¸é”™è¯¯å¤„ç†</p>
</blockquote>
<blockquote>
<p>é€‚åˆæœ‰JavaScriptåŸºç¡€ï¼Œå¸Œæœ›æ·±å…¥å¼‚æ­¥ç¼–ç¨‹çš„å¼€å‘è€…ã€‚æˆ‘ä»¬å°†ç”¨æœ€å°‘çš„ç¯‡å¹…ï¼Œè®²é€æœ€æ ¸å¿ƒçš„çŸ¥è¯†ã€‚</p>
</blockquote>
<h2 data-id="heading-0">å¼•è¨€ï¼šPromiseé™æ€æ–¹æ³•</h2>
<p>åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æ¢è®¨äº†Promiseçš„çŠ¶æ€æœºåˆ¶å’Œå®ä¾‹æ–¹æ³•ã€‚æœ¬ç¯‡æ–‡ç« å°†ä»‹ç»Promiseçš„é™æ€æ–¹æ³•ï¼Œå³ï¼šç›´æ¥é€šè¿‡Promiseç±»è°ƒç”¨çš„æ–¹æ³•ã€‚æˆ‘å°†è¿™äº›æ–¹æ³•åˆ†æˆäº†ä¸¤ä¸ªå¤§ç±»ï¼Œä¸€ç±»æ˜¯åˆ›å»ºç±»æ–¹æ³•ï¼Œä¸€ç±»æ˜¯æ§åˆ¶ç±»æ–¹æ³•ï¼š</p>
<ul>
<li>
<p>åˆ›å»ºç±»æ–¹æ³•ï¼šåˆ›å»ºPromiseçš„å¤šç§æ–¹å¼ï¼Œä¸»è¦åˆ†ä¸ºä¸‰ç§ï¼š <code>Promiseæ„é€ å‡½æ•°</code>ã€<code>Promise.resolve()</code>ã€<code>Promise.reject()</code> ã€‚</p>
</li>
<li>
<p>æ§åˆ¶ç±»æ–¹æ³•ï¼šæœ¬è´¨æ˜¯ç®¡ç†æ§åˆ¶å¤šä¸ªPromiseï¼Œå¹¶ä½¿å…¶èƒ½åè°ƒå·¥ä½œï¼Œä¸»è¦åŒ…æ‹¬ï¼š<code>Promise.all()</code>ã€<code>Promise.race()</code>ã€<code>Promise.allSettled()</code>ã€<code>Promise.any()</code> ã€‚</p>
</li>
</ul>
<h2 data-id="heading-1">åˆ›å»ºç±»æ–¹æ³•</h2>
<h3 data-id="heading-2">Promiseæ„é€ å‡½æ•°</h3>
<h4 data-id="heading-3">Promiseæ„é€ å‡½æ•°çš„åŸºæœ¬è¯­æ³•</h4>
<p><code>Promiseæ„é€ å‡½æ•°</code>æ˜¯åˆ›å»ºPromiseå¯¹è±¡çš„æ ¹æœ¬æ–¹æ³•ï¼Œå®ƒå°†å›è°ƒçš„å¼‚æ­¥æ“ä½œåŒ…è£…ä¸ºPromiseï¼Œå…¶åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> myPromise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {})
</code></pre>
<p>ä¸Šè¿°ä»£ç åˆ›å»ºäº†ä¸€ä¸ªç©ºçš„Promiseå¯¹è±¡ï¼Œæˆ‘ä»¬åœ¨åˆ›å»ºPromiseæ—¶ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œä¸€äº›åˆå§‹åŒ–æ“ä½œï¼Œå¦‚ä»¥ä¸‹ä»£ç æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> myPromise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-comment">// è¿™ä¸ªå‡½æ•°ä¼šç«‹å³æ‰§è¡Œ</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'executorå¼€å§‹æ‰§è¡Œ'</span>);

    <span class="hljs-comment">// å¼‚æ­¥æ“ä½œ</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-keyword">const</span> success = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() &gt; <span class="hljs-number">0.5</span>;

        <span class="hljs-keyword">if</span> (success) {
            <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'æ“ä½œæˆåŠŸ'</span>);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'æ“ä½œå¤±è´¥'</span>));
        }
    }, <span class="hljs-number">1000</span>);

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'executoræ‰§è¡Œå®Œæ¯•'</span>);
});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Promiseå·²åˆ›å»ºï¼ŒçŠ¶æ€:'</span>, myPromise);
</code></pre>
<p>è¿™æ®µä»£ç çš„æ‰§è¡Œç»“æœæ˜¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">executorå¼€å§‹æ‰§è¡Œ
executoræ‰§è¡Œå®Œæ¯•
Promiseå·²åˆ›å»ºï¼ŒçŠ¶æ€: Promise { &lt;pending&gt; }
</code></pre>
<p>ä»ç»“æœä¸­å¯ä»¥çœ‹å‡ºï¼Œæ­¤æ—¶çš„PromiseçŠ¶æ€ä¸€ç›´ä¸º<code>pending</code> ã€‚</p>
<h4 data-id="heading-4">æ„é€ å‡½æ•°çš„ä¸‰å¤§ç‰¹æ€§</h4>
<h5 data-id="heading-5">ç«‹å³æ‰§è¡Œ</h5>
<p>Promiseæ„é€ å‡½æ•°ä¸­çš„åŒæ­¥ä»£ç ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œå¼‚æ­¥ä»£ç ä¸ä¼šæ‰§è¡Œã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¼€å§‹'</span>);
<span class="hljs-keyword">const</span> myPromise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'executoræ‰§è¡Œä¸­...'</span>);
    <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'å®Œæˆ'</span>);
});
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»“æŸ'</span>);
</code></pre>
<p>ä¸Šè¿°ä»£ç çš„æ‰§è¡Œç»“æœæ˜¯ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">å¼€å§‹
executoræ‰§è¡Œä¸­...
ç»“æŸ
</code></pre>
<h5 data-id="heading-6">resolve/rejectåªèƒ½è°ƒç”¨ä¸€æ¬¡</h5>
<p>ç”±äºPromiseçš„çŠ¶æ€æœºåˆ¶ï¼ŒPromiseä¸­çš„resolve/rejectåªèƒ½è°ƒç”¨ä¸€æ¬¡ï¼Œå¤šä¸ªresolve/rejectä¼šè¢«è‡ªåŠ¨å¿½ç•¥ï¼Œä¸ä¼šæ‰§è¡Œï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> myPromise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'ç¬¬ä¸€æ¬¡è°ƒç”¨æœ‰æ•ˆ'</span>);
    <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'ç¬¬äºŒæ¬¡è°ƒç”¨è¢«å¿½ç•¥'</span>); <span class="hljs-comment">// æ— æ•ˆ</span>
    <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è¿™ä¸ªä¹Ÿè¢«å¿½ç•¥'</span>)); <span class="hljs-comment">// æ— æ•ˆ</span>
});
</code></pre>
<h5 data-id="heading-7">å¼‚å¸¸è‡ªåŠ¨è½¬æ¢ä¸ºreject</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'æ‰§è¡Œå™¨å¼‚å¸¸'</span>); <span class="hljs-comment">// è‡ªåŠ¨è°ƒç”¨reject</span>
    <span class="hljs-comment">// ç­‰åŒäºï¼šreject(new Error('æ‰§è¡Œå™¨å¼‚å¸¸'))</span>
});
</code></pre>
<h3 data-id="heading-8">Promise.resolve()</h3>
<p><code>Promise.resolve()</code> æ–¹æ³•ç”¨äºåˆ›å»ºä¸€ä¸ªçŠ¶æ€ä¸º <code>fulfilled</code> çš„Promiseå¯¹è±¡ï¼Œå®ƒå…¶å®å’Œ <code>new Promise((resolve, reject) =&gt; resolve())</code> è¿™æ®µä»£ç ç­‰ä»·ã€‚ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå®é™…ä¸Šå¯ä»¥æŠŠä»»æ„å€¼éƒ½è½¬æˆä¸€ä¸ªPromiseï¼Œæœ‰4ç§å¤„ç†æ¨¡å¼ï¼š</p>
<h4 data-id="heading-9">åŒ…è£…æ™®é€šå€¼</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> p1 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'hello'</span>);  <span class="hljs-comment">// Promise&lt;fulfilled: 'hello'&gt;</span>
</code></pre>
<p>å½“æœ‰å¤šä¸ªå€¼çš„æ—¶å€™ï¼ŒPromiseä¼šæ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> p2 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'hello'</span>, <span class="hljs-string">'world'</span>);  <span class="hljs-comment">// Promise&lt;fulfilled: 'hello'&gt;</span>
</code></pre>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒPromise.resolve()åªä¼šå¤„ç†ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè€ŒæŠŠåé¢çš„å‚æ•°å…¨éƒ¨å¿½ç•¥æ‰ï¼Œå³ä¸Šè¿°ä¸¤æ®µä»£ç ä¸­p1å’Œp2æ˜¯ç­‰ä»·çš„ï¼š<code>p1 === p2  // true</code> ã€‚</p>
<h4 data-id="heading-10">åŒ…è£…thenableå¯¹è±¡</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> thenable = {
    <span class="hljs-attr">then</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">onFulfilled, onRejected</span>) {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">onFulfilled</span>(<span class="hljs-string">'thenableçš„ç»“æœ'</span>), <span class="hljs-number">100</span>);
    }
};
<span class="hljs-keyword">const</span> p = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(thenable);
</code></pre>
<h4 data-id="heading-11">åŒ…è£…å¼‚æ­¥å€¼</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">asyncFunc</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'asyncè¿”å›å€¼'</span>;
}
<span class="hljs-keyword">const</span> p = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-title function_">asyncFunc</span>());
</code></pre>
<h4 data-id="heading-12">åŒ…è£…Promiseå¯¹è±¡</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> originalPromise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> 
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'åŸå§‹å€¼'</span>), <span class="hljs-number">200</span>)
);

<span class="hljs-keyword">const</span> p = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(originalPromise);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p === originalPromise); <span class="hljs-comment">// trueï¼Œæ˜¯åŒä¸€ä¸ªå¯¹è±¡</span>
</code></pre>
<p>å¯¹äºè¿™æ®µä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>p</code> å’Œ <code>originalPromise</code> å±…ç„¶ä¹Ÿæ˜¯ç­‰ä»·ï¼Œè¿™åˆæ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ
åŸæ¥ï¼Œå½“ <code>Promise.resolve()</code> æ–¹æ³•ä¸­ï¼Œæ¥æ”¶åˆ°ä¸€ä¸ªPromiseå‚æ•°æ—¶ï¼Œé‚£å®ƒçš„è¡Œä¸ºå°±ç±»ä¼¼ä¸€ä¸ªç©ºåŒ…è£…ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿå¯ä»¥æ˜¯ <code>Promise.resolve()</code> æ–¹æ³•æ˜¯ä¸€ä¸ªå¹‚ç­‰æ–¹æ³•ï¼Œå³ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> p = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">1</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p === <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(p))));
</code></pre>
<p>ä¸Šè¿°ä»£ç é‡Œé¢æ— è®ºåŒ…å¤šå°‘å±‚<code>Promise.resolve()</code> æ–¹æ³•ï¼Œå…¶ç»“æœæ°¸è¿œä¸ºtrueã€‚</p>
<h3 data-id="heading-13">Promise.reject()</h3>
<p>è¿™ä¸ªæ–¹æ³•å’Œ <code>Promise.resolve()</code> æ–¹æ³•å¯¹åº”ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ª <code>rejected</code> çŠ¶æ€çš„Promiseå®ä¾‹ï¼Œå¹¶æŠ›å‡ºä¸€ä¸ªå¼‚æ­¥é”™è¯¯ã€‚</p>
<blockquote>
<p>æ³¨ï¼š<code>Promise.resolve()</code> æ–¹æ³•æŠ›å‡ºå¼‚æ­¥é”™è¯¯æ—¶ï¼Œæ˜¯æ— æ³•ä½¿ç”¨try/catchè¿›è¡Œæ•è·çš„ã€‚</p>
</blockquote>
<p><code>Promise.reject()</code> æ–¹æ³•å’Œ <code>Promise.resolve()</code> æ–¹æ³•åŸºæœ¬ç±»ä¼¼ï¼Œæœ¬æ–‡ä¸å†èµ˜è¿°ï¼Œå”¯ä¸€è¦æ³¨æ„çš„ç‚¹æ˜¯ï¼š<code>Promise.reject()</code> æ–¹æ³•å¹¶æ²¡æœ‰ç…§æ¬ <code>Promise.resolve()</code> æ–¹æ³•çš„å¹‚ç­‰é€»è¾‘ï¼Œå¦‚æœç»™<code>Promise.reject()</code> æ–¹æ³•ä¼ é€’ä¸€ä¸ªPromiseå‚æ•°ï¼Œåˆ™è¿™ä¸ªPromiseå‚æ•°ä¼šæˆä¸ºå®ƒè¿”å›çš„æ‹’ç»åŸå› ã€‚</p>
<h2 data-id="heading-14">æ§åˆ¶ç±»æ–¹æ³•</h2>
<p>æ‰€è°“æ§åˆ¶ç±»æ–¹æ³•ï¼Œå…¶å®å°±æ˜¯Promiseæä¾›çš„å°†å¤šä¸ªPromiseå®ä¾‹ï¼Œç»„åˆæˆä¸€ä¸ªPromiseå®ä¾‹çš„é™æ€æ–¹æ³•ï¼Œåˆæˆåçš„Promiseè¡Œä¸ºå–å†³äºå†…éƒ¨çº¦å®šçš„è¡Œä¸ºã€‚</p>
<h3 data-id="heading-15">Promise.all()</h3>
<p><code>Promise.all()</code> æ–¹æ³•åˆ›å»ºçš„Promiseï¼Œä¼šåœ¨æ‰€æœ‰Promiseå…¨éƒ¨è§£å†³åï¼Œå†è§£å†³ï¼Œå³ï¼šåªè¦ä¸­é—´æœ‰ä¸€ä¸ªPromiseçŠ¶æ€ä¸º <code>rejected</code> ï¼Œåˆ™æœ€ç»ˆç»“æœä¸º<code>rejected</code> ã€‚å½“æœ‰å¤šä¸ªPromiseçŠ¶æ€éƒ½ä¸º <code>rejected</code> æ—¶ï¼Œåˆ™ç¬¬ä¸€ä¸ªçŠ¶æ€ä¸º <code>rejected</code> çš„Promiseå®ä¾‹ï¼Œä¼šå°†è‡ªå·±çš„ç†ç”±ä½œä¸ºæœ€ç»ˆçš„æ‹’ç»ç†ç”±ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹é¢ä¸€ä¸ªä¾‹å­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> fastReject = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">reject</span>(<span class="hljs-string">"å¿«é€Ÿå¤±è´¥"</span>), <span class="hljs-number">10</span>);
});

<span class="hljs-keyword">const</span> slowReject = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">reject</span>(<span class="hljs-string">"æ…¢é€Ÿå¤±è´¥"</span>), <span class="hljs-number">100</span>);
});

<span class="hljs-keyword">const</span> fastResolve = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">"å¿«é€ŸæˆåŠŸ"</span>), <span class="hljs-number">50</span>);
});

<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([fastReject, slowReject, fastResolve])
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">results</span>) =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ‰€æœ‰ Promise éƒ½æˆåŠŸäº†:"</span>, results);
    })
    .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Promise.all() å¤±è´¥:"</span>, error);
    });
</code></pre>
<p>ä¸Šè¿°ä»£ç è¾“å‡ºç»“æœæ˜¯ï¼š<code>Promise.all() å¤±è´¥: å¿«é€Ÿå¤±è´¥</code> ã€‚</p>
<h3 data-id="heading-16">Promise.allSettled()</h3>
<p><code>Promise.allSettled()</code> æ˜¯ES2020æ–°å¢çš„æ–¹æ³•ï¼Œå®ƒç­‰å¾…æ‰€æœ‰Promiseå®Œæˆï¼ˆæ— è®ºæˆåŠŸæˆ–å¤±è´¥ï¼‰ï¼Œç„¶åæŠ¥å‘Šæ¯ä¸ªPromiseçš„ç»“æœã€‚ç›¸æ¯”äº <code>Promise.all()</code> æ–¹æ³•ï¼Œ<code>Promise.allSettled()</code> æ›´åƒä¸€ä¸ªè®°å½•å‘˜ï¼Œè®°å½•æ¯ä¸ªPromiseçš„ç»“æœã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹é¢ä¸€ä¸ªä¾‹å­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ›å»ºä¸‰ä¸ª Promise</span>
<span class="hljs-keyword">const</span> p1 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">"æˆåŠŸ1"</span>);
<span class="hljs-keyword">const</span> p2 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-string">"å¤±è´¥2"</span>);
<span class="hljs-keyword">const</span> p3 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">"æˆåŠŸ3"</span>), <span class="hljs-number">1000</span>);
});

<span class="hljs-comment">// ä½¿ç”¨ Promise.allSettled()</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">allSettled</span>([p1, p2, p3])
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">results</span>) =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ‰€æœ‰ Promise éƒ½å·²è§£å†³:"</span>);
        results.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">result, index</span>) =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`p<span class="hljs-subst">${index + <span class="hljs-number">1</span>}</span>:`</span>, result);
        });
    });
</code></pre>
<p>ä¸Šè¿°ä»£ç çš„è¾“å‡ºç»“æœæ˜¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">æ‰€æœ‰ Promise éƒ½å·²è§£å†³:
p1: { status: <span class="hljs-string">'fulfilled'</span>, value: <span class="hljs-string">'æˆåŠŸ1'</span> }
p2: { status: <span class="hljs-string">'rejected'</span>, reason: <span class="hljs-string">'å¤±è´¥2'</span> }
p3: { status: <span class="hljs-string">'fulfilled'</span>, value: <span class="hljs-string">'æˆåŠŸ3'</span> }
</code></pre>
<h3 data-id="heading-17">Promise.race()</h3>
<p><code>Promise.race()</code> è¿”å›æœ€å…ˆå®Œæˆçš„Promiseï¼ˆæ— è®ºæˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼‰çš„ç»“æœã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹é¢ä¸€ä¸ªä¾‹å­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªå¯èƒ½ä¼šé•¿æ—¶é—´è¿è¡Œçš„ Promise</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">longTask</span>(<span class="hljs-params">duration = <span class="hljs-number">3000</span></span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-title function_">resolve</span>(<span class="hljs-string">`é•¿æ—¶é—´ä»»åŠ¡å®Œæˆï¼ˆè€—æ—¶ <span class="hljs-subst">${duration}</span>msï¼‰`</span>);
        }, duration);
    });
}

<span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªè¶…æ—¶ Promise</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">timeout</span>(<span class="hljs-params">ms</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">_, reject</span>) =&gt;</span> {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-title function_">reject</span>(<span class="hljs-string">`æ“ä½œè¶…æ—¶ï¼ˆ<span class="hljs-subst">${ms}</span>msï¼‰`</span>);
        }, ms);
    });
}


<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">race</span>([<span class="hljs-title function_">longTask</span>(<span class="hljs-number">3000</span>), <span class="hljs-title function_">timeout</span>(<span class="hljs-number">2000</span>)])
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æˆåŠŸ:"</span>, result);
    })
    .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å¤±è´¥:"</span>, error); 
    });
</code></pre>
<p>ä¸Šè¿°ä»£ç çš„æ‰§è¡Œç»“æœæ˜¯ï¼š<code>å¤±è´¥: æ“ä½œè¶…æ—¶ï¼ˆ2000msï¼‰</code> ã€‚</p>
<h3 data-id="heading-18">Promise.any()</h3>
<p><code>Promise.any()</code> æ˜¯ES2021æ–°å¢çš„æ–¹æ³•ï¼Œå®ƒè¿”å›ç¬¬ä¸€ä¸ªæˆåŠŸçš„Promiseï¼Œåªæœ‰å½“æ‰€æœ‰Promiseéƒ½å¤±è´¥æ—¶æ‰å¤±è´¥ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹é¢ä¸€ä¸ªä¾‹å­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> successFast = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">"å¿«é€ŸæˆåŠŸ"</span>), <span class="hljs-number">100</span>);
});

<span class="hljs-keyword">const</span> successSlow = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">"æ…¢é€ŸæˆåŠŸ"</span>), <span class="hljs-number">1000</span>);
});

<span class="hljs-keyword">const</span> failure = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">_, reject</span>) =&gt;</span> {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">reject</span>(<span class="hljs-string">"å¤±è´¥"</span>), <span class="hljs-number">50</span>);
});

<span class="hljs-comment">// å³ä½¿æœ‰å¤±è´¥çš„ Promiseï¼Œåªè¦æœ‰ä¸€ä¸ªæˆåŠŸå°±è¡Œ</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">any</span>([failure, successFast, successSlow])
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æˆåŠŸ:"</span>, result);
    })
    .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å…¨éƒ¨å¤±è´¥:"</span>, error);
    });
</code></pre>
<p>ä¸Šè¿°ä»£ç çš„è¾“å‡ºç»“æœæ˜¯ï¼š<code>æˆåŠŸ: å¿«é€ŸæˆåŠŸ</code> ã€‚</p>
<h2 data-id="heading-19">ç»“è¯­</h2>
<p>æœ¬æ–‡ä¸»è¦ä»‹ç»äº†Promiseçš„å‡ ç§é™æ€æ–¹æ³•ï¼Œå¯¹äºæ–‡ç« ä¸­é”™è¯¯çš„åœ°æ–¹æˆ–è€…æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€è®¨è®ºï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¹´è–ª 50W çš„å‰ç«¯ï¼Œåˆ°åº•æ¯”å¹´è–ª 15W çš„å¼ºåœ¨å“ªé‡Œï¼Ÿ]]></title>    <link>https://juejin.cn/post/7591744411740372992</link>    <guid>https://juejin.cn/post/7591744411740372992</guid>    <pubDate>2026-01-06T03:46:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591744411740372992" data-draft-id="7592017365141241908" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¹´è–ª 50W çš„å‰ç«¯ï¼Œåˆ°åº•æ¯”å¹´è–ª 15W çš„å¼ºåœ¨å“ªé‡Œï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,æ¶æ„"/> <meta itemprop="datePublished" content="2026-01-06T03:46:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ErpanOmer"/> <meta itemprop="url" content="https://juejin.cn/user/3878732754331096"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¹´è–ª 50W çš„å‰ç«¯ï¼Œåˆ°åº•æ¯”å¹´è–ª 15W çš„å¼ºåœ¨å“ªé‡Œï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3878732754331096/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ErpanOmer
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T03:46:53.000Z" title="Tue Jan 06 2026 03:46:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c49937ea90ee4aa99add90f7bc6a3103~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJwYW5PbWVy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768276013&amp;x-signature=13htZuxx8nHck6tZjEehNeIWrVA%3D" alt="65ef63f6bd30ab838939a4ae_Developer productivity tools 2024.webp" loading="lazy"/></p>
<h3 data-id="heading-0">æ˜¨å¤©æˆ‘çœ‹æ–°å¹´ç¬¬ä¸€æ³¢ç®€å† çœ‹ç ´é˜²äº†</h3>
<p>æœ€è¿‘å›¢é˜Ÿç¼ºäººï¼Œæˆ‘è¿ç€çœ‹äº†ä¸€å‘¨çš„ç®€å†ã€‚</p>
<p>è¯´å®è¯ï¼Œçœ‹å¾—æˆ‘æŒºéš¾å—çš„ã€‚ğŸ˜–</p>
<p>æˆ‘å‘ç°ä¸€ä¸ªç‰¹åˆ«æ™®éçš„ç°è±¡ï¼šå¾ˆå¤šå·¥ä½œäº†å››äº”å¹´çš„å…„å¼Ÿï¼ŒæœŸæœ›è–ªèµ„å¡«ä¸ª 25k ç”šè‡³ 30kï¼Œä½†ä½ ä»”ç»†ç¿»ä»–çš„é¡¹ç›®ç»å†ï¼Œå…¨æ˜¯åå°ç®¡ç†ç³»ç»Ÿï¼Œå…¨æ˜¯ H5 æ‹¼å›¾é¡µé¢ï¼Œå…¨æ˜¯è¡¨å•å¢åˆ æ”¹æŸ¥ã€‚</p>
<p>ä½ é—®ä»–ï¼šè¿™å‡ å¹´ä½ é‡åˆ°çš„æœ€å¤§æŠ€æœ¯éš¾ç‚¹æ˜¯å•¥ï¼ŸğŸ¤”</p>
<p>ä»–å›ä½ ï¼šè¡¨å•å­—æ®µå¤ªå¤šäº†ï¼Œæ ¡éªŒé€»è¾‘å¤ªå¤æ‚ã€‚æˆ–è€…è¯´ï¼Œäº§å“ç»ç†æ”¹éœ€æ±‚å¤ªé¢‘ç¹ã€‚ğŸ˜–</p>
<p>å¬åˆ°è¿™ç§å›ç­”ï¼Œæˆ‘å¿ƒé‡Œå¤§æ¦‚å°±æœ‰äº†åº•ï¼šè¿™å…„å¼Ÿçš„è–ªèµ„ä¸Šé™ï¼Œå¤§æ¦‚ç‡é”æ­»åœ¨ 20W ä»¥å†…äº†ã€‚</p>
<p>è¿™å°±æ˜¯å’±ä»¬å¸¸è¯´çš„ CRUD å›°å±€ã€‚</p>
<p>ä½ ä¼š Vueï¼Œä½ ä¼š Reactï¼Œä½ ä¼šç”¨ Antd ç”»é¡µé¢ï¼Œä½ ä¼šè°ƒæ¥å£ã€‚å…„å¼Ÿï¼Œè¿™äº›åœ¨ 2018 å¹´ä¹Ÿè®¸èƒ½è®©ä½ æ‹¿é«˜è–ªï¼Œä½†ç°åœ¨æ˜¯ 2026 å¹´äº†ï¼Œè¿™äº›ä¸œè¥¿æ˜¯åŸºå»ºï¼Œæ˜¯åŸ¹è®­ç­å‡ºæ¥çš„åº”å±Šç”Ÿä¸¤ä¸ªæœˆå°±èƒ½ä¸Šæ‰‹çš„ã€‚ğŸ¤£</p>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œé‚£ä¸ªååœ¨ä½ éš”å£å·¥ä½ã€å¹³æ—¶è¯ä¸å¤šã€ä½†å¹´è–ªèƒ½æ‹¿ 50W çš„å¤§ä½¬ï¼Œä»–åˆ°åº•æ¯”ä½ å¼ºåœ¨å“ªï¼Ÿ</p>
<p>æ˜¯ä»–æ•²é”®ç›˜æ¯”ä½ å¿«ï¼Ÿè¿˜æ˜¯ä»–å‘é‡æ¯”ä½ å°‘ï¼Ÿ</p>
<p>éƒ½ä¸æ˜¯ã€‚</p>
<p>æˆ‘è§‰å¾—æœ€æ ¸å¿ƒçš„å·®è·ï¼Œå°±åªæœ‰ä¸‰ç‚¹ã€‚å¬æˆ‘ç»†è¯´ã€‚</p>
<hr/>
<h3 data-id="heading-1">ä½ åœ¨åšå¡«ç©ºï¼Œä»–åœ¨è®¾è®¡æ•´å¼ è¯•å·</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/30e566dc9b6c45f095423c102a9500d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJwYW5PbWVy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768276013&amp;x-signature=YEreuGJNODd8Pun3n%2BqSCvFKRsE%3D" alt="web-development-programmer-engineering-coding-website-augmented-reality-interface-screens-developer-project-engineer-programming-software-application-design-cartoon-illustration_107791-3863.avif" loading="lazy"/></p>
<p>è¿™äº‹å„¿ç‰¹åˆ«æ˜æ˜¾ã€‚å°±æ‹¿æ–°å¼€ä¸€ä¸ªé¡¹ç›®æ¥è¯´ã€‚</p>
<p>15W çš„å…„å¼Ÿæ˜¯æ€ä¹ˆå¹²çš„ï¼Ÿ</p>
<p>æ‰¾ä¸ªè„šæ‰‹æ¶ï¼Œ<code>create-react-app</code> ä¸€æŠŠæ¢­ã€‚ç„¶åå¼€å§‹å †é¡µé¢ï¼Œå†™ç»„ä»¶ã€‚é‡åˆ°è¦ç”¨çš„å·¥å…·å‡½æ•°ï¼Ÿå»ç™¾åº¦æœä¸€ä¸ªç²˜è´´è¿›æ¥ã€‚é‡åˆ°æ ·å¼å†²çªï¼ŸåŠ ä¸ª <code>!important</code> æå®šã€‚ä»£ç æ ¼å¼ä¹±äº†ï¼Ÿä¸ç®¡äº†ï¼Œå…ˆè·‘é€šå†è¯´ã€‚</p>
<p>ä»–çš„è„‘å­é‡Œåªæœ‰ä¸€ä¸ªå­—ï¼šåšã€‚</p>
<p>50W çš„å…„å¼Ÿæ˜¯æ€ä¹ˆå¹²çš„ï¼Ÿ</p>
<p>ä»–åœ¨å†™ç¬¬ä¸€è¡Œä¸šåŠ¡ä»£ç ä¹‹å‰ï¼Œä¼šå…ˆåœ¨è„‘å­é‡Œè¿‡ä¸€éè¿™å‡ ä»¶äº‹ï¼š</p>
<p>å¤§å®¶ä»£ç é£æ ¼ä¸ä¸€æ ·æ€ä¹ˆåŠï¼Ÿå…ˆæŠŠ <code>ESLint + Prettier + Husky</code> è¿™ä¸€å¥—æµæ°´çº¿é…å¥½ï¼Œè°æäº¤çš„ä»£ç æ ¼å¼ä¸å¯¹ï¼Œè¿ <code>git push</code> éƒ½æ¨ä¸ä¸Šå»ã€‚</p>
<p>è¿™ä¸ªé¡¹ç›®ä»¥åä¼šä¸ä¼šå˜å¤§ï¼Ÿè¦ä¸è¦ç›´æ¥ä¸Š <code>Monorepo</code> ç®¡ç†ï¼Ÿ</p>
<p>å…¬å…±ç»„ä»¶æ€ä¹ˆæŠ½ç¦»ï¼Ÿæ˜¯ä¸æ˜¯è¯¥æ­ä¸ªç§æœ‰ <code>npm</code> åº“ï¼Ÿ</p>
<p>æ‰“åŒ…é€Ÿåº¦æ€ä¹ˆä¼˜åŒ–ï¼Ÿ<code>Vite</code> çš„é…ç½®èƒ½ä¸èƒ½å†è°ƒè°ƒï¼Ÿ</p>
<p>è¿™å°±æ˜¯å·®è·ã€‚ğŸ¤”</p>
<p>è€æ¿æ„¿æ„ç»™ä»– 50Wï¼Œä¸æ˜¯å› ä¸ºä»–é¡µé¢ç”»å¾—å¿«ï¼Œè€Œæ˜¯å› ä¸ºä»–åˆ¶å®šäº†æ ‡å‡†ã€‚ä»–ä¸€ä¸ªäººï¼Œèƒ½è®©å›¢é˜Ÿå‰©ä¸‹ 10 ä¸ªäººçš„äº§å‡ºè´¨é‡å˜é«˜ã€‚è¿™å«å·¥ç¨‹åŒ–è§†é‡ï¼Œè¿™æ‰æ˜¯å€¼é’±çš„ç©æ„å„¿ã€‚</p>
<hr/>
<h3 data-id="heading-2">å‡ºäº†äº‹ï¼Œä½ åªä¼šç”©é”…ï¼Œä»–èƒ½å…œåº•</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ffa7a3e57bd44d30ad76baae7690c3aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJwYW5PbWVy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768276013&amp;x-signature=WiAdw4kdjIAejfywR5tbtiRK6Is%3D" alt="software-developer-vs-software-engineer-illustration.jpg" loading="lazy"/></p>
<p>åœºæ™¯å†å…·ä½“ç‚¹ï¼šç”¨æˆ·æŠ•è¯‰é¡µé¢å¡é¡¿ï¼ŒåŠ è½½æ…¢ã€‚</p>
<p>15W çš„å…„å¼Ÿé€šå¸¸ååº”æ˜¯è¿™æ ·çš„ï¼š</p>
<p>æ‰“å¼€æ§åˆ¶å° Network çœ‹ä¸€çœ¼ã€‚</p>
<p>å“å‘€ï¼Œæ¥å£è¿™å°± 800ms äº†ï¼Œè¿™åç«¯ä¸è¡Œå•Šï¼Œé”…åœ¨æœåŠ¡ç«¯ã€‚</p>
<p>å—¨ğŸ™‚â€â†”ï¸ï¼Œè¿™å›¾ç‰‡ UI ç»™å¾—å¤ªå¤§äº†ï¼Œåˆ‡å›¾æ²¡åˆ‡å¥½ã€‚</p>
<p>è¿™æ•°æ®é‡å‡ ä¸‡æ¡ï¼Œæµè§ˆå™¨æ¸²æŸ“æœ¬æ¥å°±æ…¢ï¼Œæˆ‘ä¹Ÿæ²¡åŠæ³•ï¼</p>
<p>æ€»ä¹‹ï¼Œåªè¦ä¸æ˜¯ <code>JS</code> æŠ¥é”™ï¼Œè¿™äº‹å„¿å°±è·Ÿæˆ‘æ²¡å…³ç³»ã€‚</p>
<p>50W çš„å…„å¼Ÿä¼šå¹²å˜›ï¼Ÿ</p>
<p>ä»–ä¸ä¼šåºŸè¯ï¼Œä»–ç›´æ¥æ‰“å¼€ Chrome çš„ <code>Performance</code> é¢æ¿ï¼Œåƒåšå¤–ç§‘æ‰‹æœ¯ä¸€æ ·åˆ†æã€‚</p>
<p>è¿™ä¸€æ®µæ‰å¸§ï¼Œæ˜¯ä¸æ˜¯è§¦å‘äº†å¼ºåˆ¶é‡æ’ï¼Ÿ</p>
<p>å†…å­˜è¿™ä¸€è·¯é£™å‡ï¼Œæ˜¯ä¸æ˜¯å“ªä¸ªé—­åŒ…æ²¡é‡Šæ”¾ï¼Œæˆ–è€… <code>DOM</code> èŠ‚ç‚¹æ²¡é”€æ¯ï¼Ÿ</p>
<p>ä¸»çº¿ç¨‹å¡æ­»ï¼Œæ˜¯ä¸æ˜¯é•¿ä»»åŠ¡é˜»å¡äº†æ¸²æŸ“ï¼Ÿèƒ½ä¸èƒ½å¼€ä¸ª <code>Web Worker</code> æŠŠè®¡ç®—æŒªå‡ºå»ï¼Ÿ</p>
<p>ç½‘ç»œæ…¢ï¼Œæ˜¯ä¸æ˜¯ HTTP/2 çš„å¤šè·¯å¤ç”¨æ²¡åƒæ»¡ï¼Ÿå…³é”®èµ„æºçš„åŠ è½½ä¼˜å…ˆçº§è®¾å¯¹äº†å—ï¼Ÿ</p>
<p>è¿™å°±å«åº•å±‚èƒ½åŠ›ã€‚ğŸ¤”</p>
<p>å¹³æ—¶å†™ä¸šåŠ¡çœ‹ä¸å‡ºæ¥ï¼Œä¸€æ—¦é‡åˆ°é«˜å¹¶å‘ã€å¤§æ•°æ®é‡ã€è‹¥ç½‘ç¯å¢ƒè¿™ç§æç«¯åœºæ™¯ï¼Œåªä¼šè°ƒ API çš„äººä¸¤æ‰‹ä¸€æ‘Šï¼Œè€Œæ‡‚åº•å±‚åŸç†çš„äººèƒ½ä»æµè§ˆå™¨å†…æ ¸é‡ŒæŠ å‡ºæ€§èƒ½ã€‚</p>
<p>è¿™ç§ å…œåº•èƒ½åŠ›ï¼Œå°±æ˜¯ä½ çš„æº¢ä»·ã€‚</p>
<hr/>
<h3 data-id="heading-3">ä»–æ˜¯ä¸šåŠ¡åˆä¼™äºº!</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ffc7e1442158413aa1b759d2038bd97b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJwYW5PbWVy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768276013&amp;x-signature=6pICNbjXPzgwyi6EjTs%2BEY1J7iE%3D" alt="How-to-become-a-Backend-Developer.jpg" loading="lazy"/></p>
<p>è¿™ç‚¹æœ€æ‰å¿ƒã€‚</p>
<p>äº§å“ç»ç†æäº†ä¸ªä¸é è°±çš„éœ€æ±‚ï¼Œæ¯”å¦‚è¦åœ¨æ‰‹æœºç«¯å±•ç¤ºä¸€ä¸ªå‡ ç™¾åˆ—çš„è¶…çº§å¤§è¡¨æ ¼ã€‚</p>
<p>15W çš„å…„å¼Ÿï¼š</p>
<p>å¿ƒé‡Œéª‚å¨˜ï¼šè¿™å‚»Xäº§å“ï¼Œè„‘å­æœ‰å‘ã€‚ğŸ˜¡ğŸ¤¬</p>
<p>å˜´ä¸Šè€å®ï¼šè¡Œå§ï¼Œæˆ‘å°½é‡è¯•è¯•ã€‚</p>
<p>ç»“æœåšå‡ºæ¥å¡å¾—è¦æ­»ï¼Œä½“éªŒæå·®ï¼Œä¸Šçº¿è¢«ç”¨æˆ·éª‚ï¼Œå›æ¥æ¥ç€æ”¹ï¼Œé™·å…¥æ— å°½åŠ ç­ã€‚</p>
<p>è¿™ç§æ€ç»´æ¨¡å¼ä¸‹ï¼Œä½ å°±æ˜¯ä¸ªæ‰§è¡Œèµ„æºï¼Œä¹Ÿå°±æ˜¯ä¸ª æ‰“å·¥äººã€‚</p>
<p>50W çš„å…„å¼Ÿï¼š</p>
<p>ä»–å¬å®Œéœ€æ±‚ç›´æ¥å°±æ€¼å›å»äº†ï¼š</p>
<p>å“¥ä»¬ï¼Œåœ¨æ‰‹æœºä¸Šçœ‹å‡ ç™¾åˆ—è¡¨æ ¼ï¼Œç”¨æˆ·çœ¼ç›ä¸è¦äº†ï¼Ÿä½ è¿™ä¸ªéœ€æ±‚çš„ä¸šåŠ¡ç›®æ ‡æ˜¯å•¥ï¼Ÿæ˜¯ä¸ºäº†è®©ç”¨æˆ·æ ¸å¯¹æ•°æ®ï¼Ÿ</p>
<p>å¦‚æœæ˜¯æ ¸å¯¹æ•°æ®ï¼Œé‚£æˆ‘ä»¬è¦ä¸è¦æ¢ä¸ªæ–¹æ¡ˆï¼Œåªå±•ç¤ºå…³é”®æŒ‡æ ‡ï¼Œç‚¹å‡»å†ä¸‹é’»çœ‹è¯¦æƒ…ï¼Ÿè¿™æ ·å¼€å‘æˆæœ¬ä½äº† 80%ï¼Œç”¨æˆ·ä½“éªŒè¿˜å¥½ã€‚</p>
<p>è¿™å°±å«æŠ€æœ¯å˜ç°ã€‚</p>
<p>é«˜ç«¯çš„å‰ç«¯ï¼Œä¸ä»…ä»…æ˜¯å†™ä»£ç çš„ï¼Œä»–æ˜¯æ‡‚æŠ€æœ¯çš„ä¸šåŠ¡ä¸“å®¶ã€‚ä»–èƒ½ç”¨æŠ€æœ¯æ–¹æ¡ˆå»çº æ­£äº§å“é€»è¾‘ï¼Œå¸®å…¬å¸çœé’±ï¼Œå¸®ä¸šåŠ¡èµšé’±ã€‚</p>
<p>åœ¨è€æ¿çœ¼é‡Œï¼Œä½ æ˜¯æˆæœ¬ï¼Œä»–æ˜¯æŠ•èµ„ã€‚ğŸ¤·â€â™‚ï¸</p>
<hr/>
<h3 data-id="heading-4">å“ªæ€•ç°åœ¨æ˜¯ 15Wï¼Œå’±ä¹Ÿèƒ½ç¿»ç›˜</h3>
<p>å¦‚æœä½ çœ‹ä¸Šé¢è¿™äº›è¯è§‰å¾—è†ç›–ä¸­äº†ä¸€ç®­ï¼Œåˆ«æ…Œã€‚è°è¿˜ä¸æ˜¯ä»åˆ‡å›¾ä»”è¿‡æ¥çš„ï¼Ÿ</p>
<p>æƒ³æ‰“ç ´è¿™ä¸ª CRUD çš„æ€ªåœˆï¼Œä»æ˜å¤©ä¸Šç­å¼€å§‹ï¼Œè¯•ç€å˜ä¸€ä¸‹ï¼š</p>
<h4 data-id="heading-5">åˆ«å†åªç›¯ç€é‚£å‡ ä¸ª API äº†</h4>
<p>Vue æ–‡æ¡£èƒŒå¾—å†ç†Ÿä¹Ÿå°±æ˜¯ä¸ªç†Ÿç»ƒå·¥ã€‚å»çœ‹çœ‹æºç ï¼Œçœ‹çœ‹äººå®¶æ˜¯æ€ä¹ˆè®¾è®¡å“åº”å¼çš„ï¼Œçœ‹çœ‹ React ä¸ºä»€ä¹ˆè¦æ Fiberã€‚æ‡‚äº†åŸç†ï¼Œä½ å°±ä¸æ€•æ¡†æ¶å˜ã€‚</p>
<h4 data-id="heading-6">åˆ«åšé‡å¤å·¥ä½œ</h4>
<p>ä¸‹æ¬¡æƒ³å¤åˆ¶ç²˜è´´å·¥å…·å‡½æ•°çš„æ—¶å€™ï¼Œåœä¸€ä¸‹ã€‚è¯•ç€è‡ªå·±å°è£…ä¸€ä¸ªé€šç”¨çš„ï¼Œç”šè‡³è¯•ç€æŠŠä½ ä»¬é¡¹ç›®é‡Œé‡å¤çš„é€»è¾‘æŠ½æˆä¸€ä¸ªåº“ã€‚å·¥ç¨‹åŒ–å°±æ˜¯è¿™ä¹ˆä¸€ç‚¹ç‚¹åšèµ·æ¥çš„ã€‚</p>
<h4 data-id="heading-7">é’»è¿›å»ä¸€ä¸ªç»†åˆ†é¢†åŸŸ</h4>
<p>åˆ«å•¥éƒ½å­¦ï¼Œå•¥éƒ½å­¦ä¸ç²¾ã€‚</p>
<p>å¯è§†åŒ–ã€ä½ä»£ç ã€<code>Node.js</code> ä¸­é—´ä»¶ã€éŸ³è§†é¢‘ï¼Œéšä¾¿æŒ‘ä¸€ä¸ªï¼ŒæŠŠå®ƒé’»é€ã€‚åœ¨ä»»ä½•ä¸€ä¸ªç»†åˆ†é¢†åŸŸåšåˆ°å‰ 5%ï¼Œä½ éƒ½æœ‰è®®ä»·æƒã€‚</p>
<hr/>
<p>è¿˜æ˜¯é‚£å¥è¯ï¼å‰ç«¯å¹¶æ²¡æœ‰æ­»ï¼Œæ­»çš„æ˜¯é‚£äº› åªä¼šåˆ‡å›¾å’Œè°ƒæ¥å£ çš„å·¥å…·äººã€‚</p>
<p>50W çš„å¹´è–ªï¼Œä¹°çš„ä¸æ˜¯ä½ çš„æ—¶é—´ï¼Œè€Œæ˜¯ä½  è§£å†³å¤æ‚é—®é¢˜ çš„èƒ½åŠ›ï¼Œå’Œä½  é¿å…å›¢é˜Ÿè¸©å‘ çš„ç»éªŒã€‚</p>
<p>åˆ«å†æ»¡è¶³äºé‡å¤åšä¸€ä¸ª CRUD äº†ã€‚ä¸‹æ¬¡æ‰“å¼€ç¼–è¾‘å™¨çš„æ—¶å€™ï¼Œå¤šé—®è‡ªå·±ä¸€å¥ï¼š</p>
<p>é™¤äº†æŠŠè¿™ä¸ªåŠŸèƒ½åšå‡ºæ¥ï¼Œæˆ‘è¿˜èƒ½ä¸ºè¿™æ®µä»£ç å¤šåšç‚¹ä»€ä¹ˆï¼Ÿ</p>
<p>å…±å‹‰ğŸ™Œ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0e4e9a59e81c4b8282596356eb7fb96d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRXJwYW5PbWVy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768276013&amp;x-signature=8TKMwG%2FXAKSELldvwsgZRwp961Q%3D" alt="Suggestion (2).gif" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Node.js äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰è¯¦è§£]]></title>    <link>https://juejin.cn/post/7591744411740061696</link>    <guid>https://juejin.cn/post/7591744411740061696</guid>    <pubDate>2026-01-06T03:18:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591744411740061696" data-draft-id="7591778827307991080" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Node.js äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰è¯¦è§£"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯"/> <meta itemprop="datePublished" content="2026-01-06T03:18:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜æœˆ_æ¸…é£"/> <meta itemprop="url" content="https://juejin.cn/user/1081575170131006"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Node.js äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1081575170131006/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜æœˆ_æ¸…é£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T03:18:19.000Z" title="Tue Jan 06 2026 03:18:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Node.js æ˜¯å•çº¿ç¨‹çš„ JavaScript è¿è¡Œæ—¶ï¼Œä½†å®ƒèƒ½é«˜æ•ˆå¤„ç†å¤§é‡å¹¶å‘ I/O æ“ä½œï¼ˆå¦‚ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å†™ï¼‰ï¼Œæ ¸å¿ƒæœºåˆ¶å°±æ˜¯<strong>äº‹ä»¶å¾ªç¯</strong>ã€‚äº‹ä»¶å¾ªç¯ç”±åº•å±‚åº“ <strong>libuv</strong> å®ç°ï¼Œå®ƒå…è®¸ Node.js åœ¨ä¸é˜»å¡ä¸»çº¿ç¨‹çš„æƒ…å†µä¸‹å¤„ç†å¼‚æ­¥ä»»åŠ¡ã€‚</p>
<h4 data-id="heading-0">ä¸ºä»€ä¹ˆéœ€è¦äº‹ä»¶å¾ªç¯ï¼Ÿ</h4>
<ul>
<li>JavaScript æ˜¯å•çº¿ç¨‹çš„ï¼ŒåŒæ­¥ä»£ç ä¼šé˜»å¡æ‰§è¡Œã€‚</li>
<li>ä½†å¤§å¤šæ•°æ“ä½œï¼ˆå¦‚ç½‘ç»œ I/Oï¼‰æ˜¯è€—æ—¶çš„ï¼Œå¦‚æœé˜»å¡ä¸»çº¿ç¨‹ï¼Œç¨‹åºå°±æ— æ³•å“åº”å…¶ä»–è¯·æ±‚ã€‚</li>
<li>Node.js å°†å¼‚æ­¥æ“ä½œâ€œå¸è½½â€åˆ°ç³»ç»Ÿå†…æ ¸æˆ–çº¿ç¨‹æ± ï¼Œå®Œæˆåé€šè¿‡å›è°ƒé€šçŸ¥ä¸»çº¿ç¨‹ã€‚</li>
<li>äº‹ä»¶å¾ªç¯è´Ÿè´£ä¸æ–­æ£€æŸ¥æ˜¯å¦æœ‰å®Œæˆçš„å¼‚æ­¥ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œå¯¹åº”çš„å›è°ƒå‡½æ•°ï¼Œä»è€Œå®ç°<strong>éé˜»å¡ I/O</strong>ã€‚</li>
</ul>
<p>ç®€å•æ¥è¯´ï¼šä¸»çº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç  â†’ é‡åˆ°å¼‚æ­¥æ“ä½œ â†’ äº¤ç»™ libuv å¤„ç† â†’ libuv å®Œæˆæ—¶å°†å›è°ƒæ”¾å…¥é˜Ÿåˆ— â†’ äº‹ä»¶å¾ªç¯è½®è¯¢é˜Ÿåˆ—å¹¶æ‰§è¡Œå›è°ƒã€‚</p>
<h4 data-id="heading-1">äº‹ä»¶å¾ªç¯çš„é˜¶æ®µï¼ˆPhasesï¼‰</h4>
<p>Node.js çš„äº‹ä»¶å¾ªç¯åˆ†ä¸º <strong>6 ä¸ªä¸»è¦é˜¶æ®µ</strong>ï¼ˆåŸºäº libuvï¼‰ï¼Œå®ƒä»¬æŒ‰é¡ºåºå¾ªç¯æ‰§è¡Œã€‚æ¯è½®å¾ªç¯ï¼ˆç§°ä¸ºä¸€ä¸ª â€œtickâ€ï¼‰ä¼šä¾æ¬¡è¿›å…¥è¿™äº›é˜¶æ®µï¼š</p>
<ol>
<li>
<p><strong>timersï¼ˆå®šæ—¶å™¨é˜¶æ®µï¼‰</strong><br/>
æ‰§è¡Œå·²åˆ°æœŸçš„ <code>setTimeout()</code> å’Œ <code>setInterval()</code> å›è°ƒã€‚<br/>
æ³¨æ„ï¼šå®šæ—¶å™¨ä¸æ˜¯ç²¾ç¡®çš„ï¼Œåªä¿è¯â€œè‡³å°‘â€åœ¨æŒ‡å®šæ—¶é—´åæ‰§è¡Œï¼ˆå¯èƒ½å› å…¶ä»–ä»»åŠ¡å»¶è¿Ÿï¼‰ã€‚</p>
</li>
<li>
<p><strong>pending callbacksï¼ˆå¾…å®šå›è°ƒé˜¶æ®µï¼‰</strong><br/>
æ‰§è¡ŒæŸäº›ç³»ç»Ÿçº§ I/O å›è°ƒï¼ˆå¦‚ TCP é”™è¯¯æŠ¥å‘Šï¼‰ã€‚</p>
</li>
<li>
<p><strong>idle, prepareï¼ˆé—²ç½®/å‡†å¤‡é˜¶æ®µï¼‰</strong><br/>
Node.js å†…éƒ¨ä½¿ç”¨ï¼Œä»…ç”¨äºå‡†å¤‡ä¸‹ä¸€ä¸ªé˜¶æ®µã€‚</p>
</li>
<li>
<p><strong>pollï¼ˆè½®è¯¢é˜¶æ®µï¼‰</strong><br/>
æœ€é‡è¦ã€æœ€å¤æ‚çš„é˜¶æ®µï¼š</p>
<ul>
<li>æ£€ç´¢æ–°çš„ I/O äº‹ä»¶ï¼ˆç½‘ç»œã€æ–‡ä»¶ç­‰ï¼‰ã€‚</li>
<li>æ‰§è¡Œ I/O ç›¸å…³çš„å›è°ƒï¼ˆå‡ ä¹æ‰€æœ‰å¼‚æ­¥ I/O å›è°ƒåœ¨è¿™é‡Œå¤„ç†ï¼‰ã€‚</li>
<li>å¦‚æœæ²¡æœ‰å®šæ—¶å™¨ï¼Œä¼šåœ¨è¿™é‡Œé˜»å¡ç­‰å¾…æ–°äº‹ä»¶åˆ°æ¥ã€‚</li>
<li>å¦‚æœæœ‰ <code>setImmediate()</code>ï¼Œä¼šå°½å¿«è¿›å…¥ check é˜¶æ®µã€‚</li>
</ul>
</li>
<li>
<p><strong>checkï¼ˆæ£€æŸ¥é˜¶æ®µï¼‰</strong><br/>
æ‰§è¡Œ <code>setImmediate()</code> å›è°ƒã€‚</p>
</li>
<li>
<p><strong>close callbacksï¼ˆå…³é—­å›è°ƒé˜¶æ®µï¼‰</strong><br/>
æ‰§è¡Œå…³é—­äº‹ä»¶çš„å›è°ƒï¼ˆå¦‚ socket.close()ï¼‰ã€‚</p>
</li>
</ol>
<p><strong>å¾ªç¯æµç¨‹ç®€å›¾</strong>ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">timers â†’ pending callbacks â†’ idle<span class="hljs-operator">/</span><span class="hljs-keyword">prepare</span> â†’ poll â†’ <span class="hljs-keyword">check</span> â†’ <span class="hljs-keyword">close</span> callbacks â†’ (è¿”å› timers)
</code></pre>
<p>æ¯è½®å¾ªç¯ç»“æŸåï¼ŒNode.js ä¼šæ£€æŸ¥æ˜¯å¦è¿˜æœ‰å¾…å¤„ç†çš„å¼‚æ­¥ä»»åŠ¡ã€‚å¦‚æœæ²¡æœ‰ï¼Œè¿›ç¨‹ä¼šä¼˜é›…é€€å‡ºã€‚</p>
<h4 data-id="heading-2">å¾®ä»»åŠ¡ï¼ˆMicrotasksï¼‰å’Œ nextTick çš„ç‰¹æ®Šå¤„ç†</h4>
<ul>
<li>ä¸æµè§ˆå™¨ä¸åŒï¼ŒNode.js çš„<strong>å¾®ä»»åŠ¡</strong>ï¼ˆå¦‚ <code>Promise.then()</code>ã€<code>queueMicrotask()</code>ï¼‰å’Œ <code>process.nextTick()</code> <strong>åœ¨æ¯ä¸ªé˜¶æ®µç»“æŸåã€è¿›å…¥ä¸‹ä¸€ä¸ªé˜¶æ®µå‰æ‰§è¡Œ</strong>ã€‚</li>
<li>ä¼˜å…ˆçº§ï¼š<code>process.nextTick()</code> &gt; <code>Promise</code>ï¼ˆå¾®ä»»åŠ¡é˜Ÿåˆ—ï¼‰ã€‚</li>
<li>è¿™æ„å‘³ç€å¾®ä»»åŠ¡ä¼šâ€œæ’é˜Ÿâ€åœ¨å®ä»»åŠ¡ï¼ˆé˜¶æ®µå›è°ƒï¼‰ä¹‹é—´æ‰§è¡Œï¼Œç¡®ä¿æ›´é«˜ä¼˜å…ˆçº§ã€‚</li>
</ul>
<p><strong>æ³¨æ„å˜åŒ–</strong>ï¼ˆä» Node.js 20+ / libuv 1.45.0 å¼€å§‹ï¼‰ï¼šå®šæ—¶å™¨å›è°ƒç°åœ¨åªåœ¨ poll é˜¶æ®µåæ‰§è¡Œï¼ˆä»¥å‰å¯èƒ½åœ¨ poll å‰åéƒ½æ£€æŸ¥ï¼‰ã€‚</p>
<h4 data-id="heading-3">æ‰§è¡Œé¡ºåºç¤ºä¾‹</h4>
<p>è€ƒè™‘ä»¥ä¸‹ä»£ç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'start'</span>);

<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'timeout'</span>), <span class="hljs-number">0</span>);
<span class="hljs-title function_">setImmediate</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'immediate'</span>));

<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'promise'</span>));

process.<span class="hljs-title function_">nextTick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'nextTick'</span>));

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'end'</span>);
</code></pre>
<p>è¾“å‡ºé€šå¸¸æ˜¯ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">start
end
nextTick
promise
immediate  <span class="hljs-comment">// æˆ– timeoutï¼ˆå–å†³äº poll é˜¶æ®µï¼‰</span>
timeout    <span class="hljs-comment">// æˆ– immediate</span>
</code></pre>
<ul>
<li>åŒæ­¥ä»£ç å…ˆæ‰§è¡Œï¼š<code>start</code> â†’ <code>end</code>ã€‚</li>
<li>å¾®ä»»åŠ¡ç«‹å³æ‰§è¡Œï¼š<code>nextTick</code> â†’ <code>promise</code>ã€‚</li>
<li>ç„¶åè¿›å…¥äº‹ä»¶å¾ªç¯ï¼šå…ˆ timersï¼ˆtimeoutï¼‰ï¼Œæˆ–å…ˆ checkï¼ˆimmediateï¼‰ï¼Œå…·ä½“å–å†³äº poll é˜¶æ®µçš„è¡Œä¸ºã€‚</li>
</ul>
<h4 data-id="heading-4">ä¸æµè§ˆå™¨äº‹ä»¶å¾ªç¯çš„åŒºåˆ«</h4>
<ul>
<li><strong>æµè§ˆå™¨</strong>ï¼šå®ä»»åŠ¡ï¼ˆmacrotaskï¼Œå¦‚ setTimeoutï¼‰å’Œå¾®ä»»åŠ¡ï¼ˆmicrotaskï¼Œå¦‚ Promiseï¼‰äº¤æ›¿æ‰§è¡Œï¼Œä¸€ä¸ªå®ä»»åŠ¡åæ¸…ç©ºæ‰€æœ‰å¾®ä»»åŠ¡ã€‚</li>
<li><strong>Node.js</strong>ï¼šæœ‰å¤šä¸ªé˜¶æ®µçš„å®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå¾®ä»»åŠ¡åœ¨<strong>æ¯ä¸ªé˜¶æ®µä¹‹é—´</strong>æ‰§è¡Œï¼Œæ›´å¤æ‚ï¼Œé€‚åˆæœåŠ¡å™¨ç«¯ I/O å¯†é›†åœºæ™¯ã€‚</li>
</ul>
<h4 data-id="heading-5">å®é™…å»ºè®®</h4>
<ul>
<li>é¿å…åœ¨äº‹ä»¶å¾ªç¯ä¸­æ‰§è¡Œ CPU å¯†é›†ä»»åŠ¡ï¼ˆå¦‚å¤§å¾ªç¯è®¡ç®—ï¼‰ï¼Œä¼šé˜»å¡å…¶ä»–å›è°ƒï¼Œå¯¼è‡´å»¶è¿Ÿã€‚</li>
<li>ä½¿ç”¨ <code>process.nextTick()</code> æˆ– Promise å¤„ç†é«˜ä¼˜å…ˆçº§å¼‚æ­¥é€»è¾‘ã€‚</li>
<li>ç›‘æ§äº‹ä»¶å¾ªç¯å»¶è¿Ÿï¼ˆå¯ç”¨ <code>perf_hooks</code>ï¼‰ä»¥ä¼˜åŒ–æ€§èƒ½ã€‚</li>
</ul>
<p>ç†è§£äº‹ä»¶å¾ªç¯æ˜¯æŒæ¡ Node.js å¼‚æ­¥ç¼–ç¨‹çš„å…³é”®ï¼Œèƒ½å¸®åŠ©ä½ è°ƒè¯•å›è°ƒé¡ºåºã€é¿å…é˜»å¡å’Œæ„å»ºé«˜å¹¶å‘åº”ç”¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ReactåŸºç¡€æ¡†æ¶æ­å»º7-æµ‹è¯•ï¼šreact+router+redux+axios+Tailwind+webpack]]></title>    <link>https://juejin.cn/post/7592017365141520436</link>    <guid>https://juejin.cn/post/7592017365141520436</guid>    <pubDate>2026-01-06T03:21:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592017365141520436" data-draft-id="7592017365141454900" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ReactåŸºç¡€æ¡†æ¶æ­å»º7-æµ‹è¯•ï¼šreact+router+redux+axios+Tailwind+webpack"/> <meta itemprop="keywords" content="React.js,å‰ç«¯æ¡†æ¶,æ¶æ„"/> <meta itemprop="datePublished" content="2026-01-06T03:21:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Eadia"/> <meta itemprop="url" content="https://juejin.cn/user/1591748565671614"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ReactåŸºç¡€æ¡†æ¶æ­å»º7-æµ‹è¯•ï¼šreact+router+redux+axios+Tailwind+webpack
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1591748565671614/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Eadia
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T03:21:50.000Z" title="Tue Jan 06 2026 03:21:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ç°åœ¨å¯ä»¥å¯¹ä¹‹å‰å¼„å¾—ä¸€äº›å†…å®¹è¿›è¡Œæµ‹è¯•äº†</p>
<p>npmä¸‹è½½ï¼š</p>
<pre><code class="hljs language-dart" lang="dart">npm install --save-dev <span class="hljs-meta">@testing</span>-<span class="hljs-keyword">library</span>/react <span class="hljs-meta">@testing</span>-<span class="hljs-keyword">library</span>/jest-dom
</code></pre>
<p>æœ‰äº›å¯èƒ½éœ€è¦å®‰è£…ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">npm install --save-dev <span class="hljs-meta">@babel</span>/plugin-proposal-<span class="hljs-keyword">private</span>-property-<span class="hljs-keyword">in</span>-<span class="hljs-keyword">object</span>
</code></pre>
<p>å•å…ƒæµ‹è¯•è¯·æŒ‰å¦‚ä¸‹æ–¹å¼è¿›è¡Œï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//src/views/Home/__tests__/Home.test.js</span>

<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { render, screen } <span class="hljs-keyword">from</span> <span class="hljs-string">'@testing-library/react'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Home</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../Home'</span>;

<span class="hljs-title function_">test</span>(<span class="hljs-string">'renders welcome message'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">render</span>(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Home</span> /&gt;</span></span>);
    <span class="hljs-keyword">const</span> linkElement = screen.<span class="hljs-title function_">getByText</span>(<span class="hljs-regexp">/Hello/i</span>);
    <span class="hljs-title function_">expect</span>(linkElement).<span class="hljs-title function_">toBeInTheDocument</span>();
});
</code></pre>
<p>è¿è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm <span class="hljs-built_in">test</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ä»é›¶å¼€å§‹æ„å»ºä¸“å± SVG ç¼–è¾‘å™¨çš„å®æˆ˜æŒ‡å—]]></title>    <link>https://juejin.cn/post/7591780560486645760</link>    <guid>https://juejin.cn/post/7591780560486645760</guid>    <pubDate>2026-01-06T03:34:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591780560486645760" data-draft-id="7566913899176165411" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ä»é›¶å¼€å§‹æ„å»ºä¸“å± SVG ç¼–è¾‘å™¨çš„å®æˆ˜æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,å‰ç«¯æ¡†æ¶"/> <meta itemprop="datePublished" content="2026-01-06T03:34:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å§æŒ‡ä¸–é˜"/> <meta itemprop="url" content="https://juejin.cn/user/3435310554828685"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ä»é›¶å¼€å§‹æ„å»ºä¸“å± SVG ç¼–è¾‘å™¨çš„å®æˆ˜æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3435310554828685/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å§æŒ‡ä¸–é˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T03:34:57.000Z" title="Tue Jan 06 2026 03:34:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»16åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åœ¨Webå¼€å‘é¢†åŸŸï¼Œé‡å¤é€ è½®å­å¹¶éæ˜æ™ºä¹‹ä¸¾ã€‚å½“æˆ‘ä»¬éœ€è¦å®šåˆ¶ä¸€ä¸ª SVG ç¼–è¾‘å™¨æ—¶ï¼Œä¸å…¶å®Œå…¨ä»é›¶å¼€å§‹ï¼Œä¸å¦‚åŸºäºæˆç†Ÿçš„åŸºç¡€è¿›è¡Œæ„å»ºã€‚</p>
</blockquote>
<h2 data-id="heading-0">@svgedit/svgcanvas ç®€ä»‹</h2>
<p><code>@svgedit/svgcanvas</code> æ˜¯å¼€æºé¡¹ç›® <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSVG-Edit%2Fsvgedit" target="_blank" title="https://github.com/SVG-Edit/svgedit" ref="nofollow noopener noreferrer">SVGEdit</a> çš„æ ¸å¿ƒç»„ä»¶ï¼Œæä¾›åº•å±‚çš„ SVG æ“ä½œèƒ½åŠ›ã€‚å°†ç•Œé¢å’Œäº¤äº’é€»è¾‘äº¤ç»™å¼€å‘è€…è‡ªå®šä¹‰ï¼Œä½¿æˆ‘ä»¬å¯å¿«é€Ÿæ„å»ºè‡ªå·±çš„ç¼–è¾‘å™¨ï¼ŒåŒæ—¶ä¿æŒ<strong>é«˜åº¦å¯å®šåˆ¶æ€§</strong>ã€‚</p>
<ul>
<li><strong>ä¼˜ç‚¹ï¼š</strong> ç»è¿‡äº†è¶…è¿‡åå¹´çš„å‘å±•å’Œå®é™…é¡¹ç›®çš„è€ƒéªŒï¼Œæä¾›äº†ä¸€ä¸ª<strong>åŠŸèƒ½é«˜åº¦å®Œå¤‡çš„èµ·ç‚¹</strong>ã€‚</li>
</ul>
<p>å®ç°äº†ä»åŸºæœ¬çš„å›¾å½¢ç»˜åˆ¶ï¼ˆå¦‚çŸ©å½¢ã€åœ†å½¢ã€è·¯å¾„ï¼‰åˆ°å¤æ‚çš„ç¼–è¾‘æ“ä½œï¼ˆå¦‚å›¾å±‚ç®¡ç†ã€å†å²è®°å½•ï¼‰ç­‰ä¸€å¥—å®Œæ•´çš„ SVG ç”»å¸ƒæ“ä½œèƒ½åŠ›ã€‚</p>
<p>è¿™æ„å‘³ç€æ— éœ€ä»é›¶å¼€å§‹å®ç°è¿™äº›å¤æ‚é€»è¾‘ï¼Œå¯ä»¥ä¸“æ³¨äºå®šåˆ¶ç¼–è¾‘å™¨çš„ç•Œé¢ã€äº¤äº’å’Œç‰¹å®šä¸šåŠ¡åŠŸèƒ½ï¼Œä»è€Œ<strong>æ˜¾è‘—æå‡å¼€å‘æ•ˆç‡</strong>ã€‚</p>
<ul>
<li><strong>ç¼ºç‚¹ï¼š</strong> ç¼ºä¹ TypeScript æ”¯æŒå’Œè¯¦ç»†çš„ API æ–‡æ¡£ã€‚</li>
</ul>
<p>æ²¡æœ‰ ts å°±å¤±å»äº†ç±»å‹æ£€æŸ¥ã€ä»£ç æ™ºèƒ½æç¤ºã€ä»¥åŠç¼–è¯‘æ—¶é”™è¯¯æ£€æµ‹ï¼Œ<strong>å¼€å‘ä½“éªŒä¼šå—åˆ°å½±å“</strong>ã€‚</p>
<p>ç¼ºä¹è¯¦ç»† API æ–‡æ¡£ï¼Œæœ‰æ—¶éœ€è¦ç›´æ¥é˜…è¯»æºç ï¼Œè™½ç„¶ä¸€å¼€å§‹å¯èƒ½æœ‰éš¾åº¦ï¼Œä½†è¿™æ˜¯ç†è§£åº“çš„æ ¸å¿ƒå·¥ä½œæœºåˆ¶å’Œæœ€å¯é çš„é€”å¾„ã€‚</p>
<h2 data-id="heading-1">å¿«é€Ÿæ­å»º</h2>
<p>ä¸ºäº†é¿å… <code>new SvgCanvas</code> åå¾—åˆ°çš„ <code>canvas</code> å®ä¾‹åœ¨ç»„ä»¶é—´ä¼ é€’çš„å¤æ‚æ€§ï¼Œé€šå¸¸å»ºè®®ä½¿ç”¨çŠ¶æ€ç®¡ç†åº“å°†å…¶æå‡ä¸ºå…¨å±€çŠ¶æ€ã€‚</p>
<p>ä½†å‡ºäºç®€åŒ–ç¤ºä¾‹çš„ç›®çš„ï¼Œæœ¬æ–‡å°†æš‚ä¸å¼•å…¥ç›¸å…³åº“ï¼Œè€Œæ˜¯èšç„¦äºæ ¸å¿ƒé€»è¾‘ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useEffect, useRef, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">SvgCanvas</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@svgedit/svgcanvas'</span>;

<span class="hljs-comment">//é»˜è®¤é…ç½®</span>
<span class="hljs-keyword">const</span> config = {
  <span class="hljs-attr">canvas_expansion</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">initFill</span>: {
    <span class="hljs-attr">color</span>: <span class="hljs-string">'fff'</span>,
    <span class="hljs-attr">opacity</span>: <span class="hljs-number">1</span>,
  },
  <span class="hljs-attr">initStroke</span>: {
    <span class="hljs-attr">width</span>: <span class="hljs-number">5</span>,
    <span class="hljs-attr">color</span>: <span class="hljs-string">'000000'</span>,
    <span class="hljs-attr">opacity</span>: <span class="hljs-number">1</span>,
  },
  <span class="hljs-attr">text</span>: {
    <span class="hljs-attr">stroke_width</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">font_size</span>: <span class="hljs-number">12</span>,
  },
  <span class="hljs-attr">gridSnapping</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">baseUnit</span>: <span class="hljs-string">'px'</span>,
};

<span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> svgcanvasRef = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> textRef = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> [canvas, setCanvas] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateCanvas</span>(<span class="hljs-params">canvas: SvgCanvas, editorDom: HTMLDivElement</span>) {
    <span class="hljs-keyword">const</span> workarea = editorDom.<span class="hljs-property">parentNode</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLElement</span>;
    <span class="hljs-keyword">let</span> { width, height } = workarea.<span class="hljs-title function_">getBoundingClientRect</span>();
    editorDom.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">`<span class="hljs-subst">${width}</span>px`</span>;
    editorDom.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">`<span class="hljs-subst">${height}</span>px`</span>;
    canvas.<span class="hljs-title function_">updateCanvas</span>(width, height);
  }
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> editorDom = svgcanvasRef.<span class="hljs-property">current</span>;
    <span class="hljs-keyword">if</span> (editorDom) {
      <span class="hljs-comment">// åˆ›å»º SvgCanvas å®ä¾‹</span>
      <span class="hljs-keyword">const</span> canvas = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SvgCanvas</span>(editorDom, config);
      <span class="hljs-title function_">setCanvas</span>(canvas);
      <span class="hljs-title function_">updateCanvas</span>(canvas, editorDom);
      <span class="hljs-keyword">if</span> (textRef.<span class="hljs-property">current</span>) {
        <span class="hljs-comment">// è®¾ç½®æ–‡æœ¬è¾“å…¥æ¡†å…ƒç´ </span>
        canvas.<span class="hljs-property">textActions</span>.<span class="hljs-title function_">setInputElem</span>(textRef.<span class="hljs-property">current</span>);
      }
    }
  },[]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        {['select', 'ellipse', 'rect', 'path', 'line', 'text'].map((item) =&gt; (
           canvas?.setMode(item)}
          &gt;
            {item}
          
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>/&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
       {
          canvas?.setTextContent((e.target as HTMLInputElement).value);
        }}
        onFocus={() =&gt; {
          const selectedElement = canvas?.getSelectedElements()[0];
          if (textRef.current &amp;&amp; selectedElement) {
            textRef.current.value = selectedElement.textContent;
          }
        }}
        onBlur={() =&gt; {
          if (textRef.current) textRef.current.value = '';
        }}
        style={{ position: 'absolute', left: '-9999px' }}
      /&gt;
    
  );
};

export default App;
</span></code></pre>
<h2 data-id="heading-2">åŠŸèƒ½å®ç°</h2>
<p>ä¸‹é¢æä¾›ä¸€äº›ä½ å¯èƒ½éœ€è¦çš„åŠŸèƒ½å®ç°ã€‚</p>
<h4 data-id="heading-3">ç»˜åˆ¶ç½‘æ ¼èƒŒæ™¯</h4>
<p>æºç ä¸­çš„ <code>setBackgroundMethod</code> æ–¹æ³•ï¼ˆä½äº <code>elem-get-set.js</code> æ–‡ä»¶å†…ï¼‰ç”¨äºè®¾ç½®ç¼–è¾‘å™¨èƒŒæ™¯ï¼Œä½†åŠŸèƒ½è¾ƒä¸ºåŸºç¡€ï¼Œ<strong>ä»…æ”¯æŒ</strong>é…ç½®å¡«å……è‰²å’ŒèƒŒæ™¯å›¾ç‰‡ã€‚</p>
<p>ä¸ºä¿æŒç»“æ„ä¸å˜ï¼Œåœ¨ç”Ÿæˆç½‘æ ¼åï¼Œå°†Â <code>#canvasBackground</code>å…ƒç´ å†…çš„Â ``è¿›è¡Œæ›¿æ¢ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">SvgCanvas</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@svgedit/svgcanvas'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">useGridBg</span>(<span class="hljs-params">props: { gridSize: <span class="hljs-built_in">number</span> }</span>) {
  <span class="hljs-keyword">const</span> { gridSize } = props;

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">drawGridBg</span>(<span class="hljs-params">canvas: SvgCanvas | <span class="hljs-literal">null</span></span>) {
    <span class="hljs-keyword">const</span> editorDom = canvas?.<span class="hljs-title function_">getSvgRoot</span>().<span class="hljs-property">parentNode</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLElement</span>;

    <span class="hljs-keyword">if</span> (!editorDom || !canvas) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> zoom = canvas.<span class="hljs-title function_">getZoom</span>();
    <span class="hljs-keyword">const</span> scaledGridSize = gridSize * zoom;
    <span class="hljs-keyword">const</span> gridSvg = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElementNS</span>(
      <span class="hljs-string">'http://www.w3.org/2000/svg'</span>,
      <span class="hljs-string">'svg'</span>,
    );
    gridSvg.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'width'</span>, <span class="hljs-string">'100%'</span>);
    gridSvg.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'height'</span>, <span class="hljs-string">'100%'</span>);
    gridSvg.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'overflow'</span>, <span class="hljs-string">'visible'</span>);
    gridSvg.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'pointer-events'</span>, <span class="hljs-string">'none'</span>);
    <span class="hljs-comment">// è·å–ç”»å¸ƒçš„ä½ç§»</span>
    <span class="hljs-keyword">const</span> viewBox = canvas.<span class="hljs-title function_">getSvgRoot</span>().<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'viewBox'</span>)?.<span class="hljs-title function_">split</span>(<span class="hljs-string">' '</span>);
    <span class="hljs-keyword">const</span> translateX = viewBox ? <span class="hljs-built_in">parseFloat</span>(viewBox[<span class="hljs-number">0</span>]) : <span class="hljs-number">0</span>,
      translateY = viewBox ? <span class="hljs-built_in">parseFloat</span>(viewBox[<span class="hljs-number">1</span>]) : <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> bg = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'canvasBackground'</span>);

    <span class="hljs-keyword">if</span> (bg) {
      <span class="hljs-keyword">const</span> visibleWidth = <span class="hljs-title class_">Number</span>(editorDom.<span class="hljs-property">style</span>.<span class="hljs-property">width</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-string">'px'</span>, <span class="hljs-string">''</span>)),
        visibleHeight = <span class="hljs-title class_">Number</span>(editorDom.<span class="hljs-property">style</span>.<span class="hljs-property">height</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-string">'px'</span>, <span class="hljs-string">''</span>));
      <span class="hljs-keyword">const</span> bgWidth = <span class="hljs-title class_">Number</span>(bg.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'width'</span>)?.<span class="hljs-title function_">replace</span>(<span class="hljs-string">'px'</span>, <span class="hljs-string">''</span>)),
        bgHeight = <span class="hljs-title class_">Number</span>(bg.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'height'</span>)?.<span class="hljs-title function_">replace</span>(<span class="hljs-string">'px'</span>, <span class="hljs-string">''</span>));
      <span class="hljs-keyword">const</span> width = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(visibleWidth, bgWidth),
        height = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(visibleHeight, bgHeight);

      <span class="hljs-comment">// è®¡ç®—å¯è§†åŒºåŸŸçš„è¾¹ç•Œ</span>
      <span class="hljs-keyword">const</span> redundancy = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(width / <span class="hljs-number">2</span> / scaledGridSize) * scaledGridSize;

      <span class="hljs-keyword">const</span> startX =
        -redundancy + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(translateX / scaledGridSize) * scaledGridSize;
      <span class="hljs-keyword">const</span> startY =
        -redundancy + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(translateY / scaledGridSize) * scaledGridSize;
      <span class="hljs-keyword">const</span> endX = width + redundancy + translateX;
      <span class="hljs-keyword">const</span> endY = height + redundancy + translateY;
      <span class="hljs-comment">// ç»˜åˆ¶æ¨ªçº¿</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> y = startY; y &lt; endY; y += scaledGridSize) {
        <span class="hljs-keyword">const</span> line = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElementNS</span>(
          <span class="hljs-string">'http://www.w3.org/2000/svg'</span>,
          <span class="hljs-string">'line'</span>,
        );
        line.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'x1'</span>, startX.<span class="hljs-title function_">toString</span>());
        line.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'y1'</span>, y.<span class="hljs-title function_">toString</span>());
        line.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'x2'</span>, endX.<span class="hljs-title function_">toString</span>());
        line.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'y2'</span>, y.<span class="hljs-title function_">toString</span>());
        line.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'stroke'</span>, <span class="hljs-string">'#e2deded5'</span>);
        line.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'stroke-width'</span>, <span class="hljs-string">'1'</span>);
        gridSvg.<span class="hljs-title function_">appendChild</span>(line);
      }

      <span class="hljs-comment">// ç»˜åˆ¶ç«–çº¿</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> x = startX; x &lt; endX; x += scaledGridSize) {
        <span class="hljs-keyword">const</span> line = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElementNS</span>(
          <span class="hljs-string">'http://www.w3.org/2000/svg'</span>,
          <span class="hljs-string">'line'</span>,
        );
        line.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'x1'</span>, x.<span class="hljs-title function_">toString</span>());
        line.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'y1'</span>, startY.<span class="hljs-title function_">toString</span>());
        line.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'x2'</span>, x.<span class="hljs-title function_">toString</span>());
        line.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'y2'</span>, endY.<span class="hljs-title function_">toString</span>());
        line.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'stroke'</span>, <span class="hljs-string">'#e2deded5'</span>);
        line.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'stroke-width'</span>, <span class="hljs-string">'1'</span>);
        gridSvg.<span class="hljs-title function_">appendChild</span>(line);
      }

      bg.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">''</span>;
      bg.<span class="hljs-title function_">appendChild</span>(gridSvg);
    }
  }

  <span class="hljs-keyword">return</span> { drawGridBg };
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> useGridBg;
</code></pre>
<pre><code class="hljs language-less" lang="less">:<span class="hljs-selector-tag">global</span> {
    <span class="hljs-selector-id">#canvasBackground</span> {
      <span class="hljs-attribute">overflow</span>: visible;
    }
  }
</code></pre>
<p>åœ¨ <code>new SvgCanvas</code> æ—¶ï¼Œå°±ç»˜åˆ¶èƒŒæ™¯ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span>
  

  <span class="hljs-comment">/** è¿™éƒ¨åˆ†æ˜¯æ–°å¢çš„ä»£ç */</span>
  <span class="hljs-keyword">const</span> { drawGridBg } = <span class="hljs-title function_">useGridBg</span>({ <span class="hljs-attr">gridSize</span>: <span class="hljs-number">20</span> });
  <span class="hljs-comment">/**â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”*/</span>
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> editorDom = svgcanvasRef.<span class="hljs-property">current</span>;
    <span class="hljs-keyword">if</span> (editorDom) {
      <span class="hljs-keyword">const</span> canvas = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SvgCanvas</span>(editorDom, config);
      <span class="hljs-title function_">setCanvas</span>(canvas);
      <span class="hljs-title function_">updateCanvas</span>(canvas, editorDom);
      <span class="hljs-comment">/** è¿™éƒ¨åˆ†æ˜¯æ–°å¢çš„ä»£ç  */</span>
      <span class="hljs-comment">// èƒŒæ™¯ç½‘æ ¼ç»˜åˆ¶</span>
      <span class="hljs-title function_">drawGridBg</span>(canvas);
      <span class="hljs-comment">/**â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”*/</span>
      <span class="hljs-keyword">if</span> (textRef.<span class="hljs-property">current</span>) {
        canvas.<span class="hljs-property">textActions</span>.<span class="hljs-title function_">setInputElem</span>(textRef.<span class="hljs-property">current</span>);
      }
    }
  }, []);
  
  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span>
};
</code></pre>
<h4 data-id="heading-4">æŒ‰ä½é¼ æ ‡æ»šè½®æ‹–æ‹½ç”»å¸ƒ</h4>
<p>æ‹–æ‹½åŠŸèƒ½ï¼è¿™ä¹ˆå®ç”¨çš„åŠŸèƒ½ï¼Œæ˜¯çš„ï¼Œæ²¡æœ‰ APIã€‚</p>
<p>æˆ‘æ˜¯é€šè¿‡æ›´æ”¹ viewBox æ¥å®ç°çš„ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span>
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> editorDom = svgcanvasRef.<span class="hljs-property">current</span>;
    <span class="hljs-keyword">let</span> isDragging = <span class="hljs-literal">false</span>;
    <span class="hljs-comment">// å­˜å‚¨é¼ æ ‡æŒ‰ä¸‹æ—¶çš„åæ ‡å’Œç”»å¸ƒåˆå§‹ä½ç½®</span>
    <span class="hljs-keyword">let</span> <span class="hljs-attr">startX</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>,
      <span class="hljs-attr">startY</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>,
      <span class="hljs-attr">initialTranslateX</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>,
      <span class="hljs-attr">initialTranslateY</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleMouseDown</span>(<span class="hljs-params">e: MouseEvent</span>) {
      <span class="hljs-comment">// ä»…å½“æŒ‰ä¸‹ é¼ æ ‡æ»šè½® æ—¶å¼€å§‹æ‹–æ‹½</span>
      <span class="hljs-keyword">if</span> (e.<span class="hljs-property">button</span> === <span class="hljs-number">1</span>) {
        <span class="hljs-keyword">const</span> selectGroup = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'selectorParentGroup'</span>);
        <span class="hljs-keyword">if</span> (selectGroup) {
          selectGroup.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>;
        }
        <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">style</span>.<span class="hljs-property">cursor</span> = <span class="hljs-string">'grab'</span>;
        canvas?.<span class="hljs-title function_">clearSelection</span>();
        e.<span class="hljs-title function_">preventDefault</span>();
        isDragging = <span class="hljs-literal">true</span>;
        startX = e.<span class="hljs-property">clientX</span>;
        startY = e.<span class="hljs-property">clientY</span>;

        <span class="hljs-comment">//è·å–å½“å‰ç”»å¸ƒç§»åŠ¨çš„è·ç¦»</span>
        [initialTranslateX, initialTranslateX] = canvas
          ?.<span class="hljs-title function_">getSvgRoot</span>()
          .<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'viewBox'</span>)
          ?.<span class="hljs-title function_">split</span>(<span class="hljs-string">' '</span>)
          .<span class="hljs-title function_">map</span>(<span class="hljs-title class_">Number</span>) ?? [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>];
      }
    }

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleMouseMove</span>(<span class="hljs-params">e: MouseEvent</span>) {
      <span class="hljs-keyword">if</span> (isDragging) {
        <span class="hljs-keyword">const</span> dx = e.<span class="hljs-property">clientX</span> - startX;
        <span class="hljs-keyword">const</span> dy = e.<span class="hljs-property">clientY</span> - startY;
        <span class="hljs-keyword">const</span> newTranslateX = initialTranslateX - dx;
        <span class="hljs-keyword">const</span> newTranslateY = initialTranslateY - dy;
        <span class="hljs-comment">// è®¾ç½®ç”»å¸ƒçš„ä½ç½®</span>
        <span class="hljs-keyword">const</span> viewBox = canvas?.<span class="hljs-title function_">getSvgRoot</span>(),
          width = viewBox?.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'width'</span>),
          height = viewBox?.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'height'</span>);

        viewBox?.<span class="hljs-title function_">setAttribute</span>(
          <span class="hljs-string">'viewBox'</span>,
          <span class="hljs-string">`<span class="hljs-subst">${newTranslateX}</span> <span class="hljs-subst">${newTranslateY}</span> <span class="hljs-subst">${width}</span> <span class="hljs-subst">${height}</span>`</span>,
        );
        <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">style</span>.<span class="hljs-property">cursor</span> = <span class="hljs-string">'grabbing'</span>;
        <span class="hljs-comment">// é‡æ–°ç»˜åˆ¶ç½‘æ ¼èƒŒæ™¯</span>
        <span class="hljs-title function_">drawGridBg</span>(canvas);
      }
    }

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleMouseUp</span>(<span class="hljs-params"/>) {
      isDragging = <span class="hljs-literal">false</span>;
      <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">style</span>.<span class="hljs-property">cursor</span> = <span class="hljs-string">'default'</span>;
      <span class="hljs-keyword">const</span> selectGroup = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'selectorParentGroup'</span>);
      <span class="hljs-keyword">if</span> (selectGroup) {
        selectGroup.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'block'</span>;
      }
    }

    editorDom?.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mousedown'</span>, handleMouseDown);
    editorDom?.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mousemove'</span>, handleMouseMove);
    editorDom?.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mouseup'</span>, handleMouseUp);
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      editorDom?.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mousedown'</span>, handleMouseDown);
      editorDom?.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mousemove'</span>, handleMouseMove);
      editorDom?.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mouseup'</span>, handleMouseUp);
    };
  }, [canvas]);

  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span>
};
</code></pre>
<h4 data-id="heading-5">ç¼©æ”¾åŠŸèƒ½</h4>
<p>å¦‚æœæ²¡æœ‰ä½¿ç”¨æ‹–æ‹½åŠŸèƒ½çš„è¯ï¼Œä½¿ç”¨åº“æä¾›çš„ API ï¼Œè¿™éƒ¨åˆ†ä»£ç å°±å¤Ÿäº†ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span>
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> editorDom = svgcanvasRef.<span class="hljs-property">current</span>;
    <span class="hljs-keyword">let</span> zoom = <span class="hljs-number">1</span>;

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleWheel</span>(<span class="hljs-params">e: WheelEvent</span>) {
      <span class="hljs-keyword">if</span> (canvas &amp;&amp; editorDom) {
        e.<span class="hljs-title function_">preventDefault</span>();
        canvas.<span class="hljs-title function_">clearSelection</span>();
        <span class="hljs-comment">// ç¼©æ”¾çš„æ¯”ä¾‹</span>
        <span class="hljs-keyword">const</span> zoomStep = <span class="hljs-number">0.1</span>;
        <span class="hljs-keyword">const</span> delta = e.<span class="hljs-property">deltaY</span> &gt; <span class="hljs-number">0</span> ? -zoomStep : zoomStep;
        <span class="hljs-keyword">const</span> newZoom = zoom + delta;
        <span class="hljs-keyword">if</span> (newZoom &gt; <span class="hljs-number">0.3</span> &amp;&amp; newZoom &lt; <span class="hljs-number">3</span>) {
          canvas.<span class="hljs-title function_">setZoom</span>(newZoom);
          <span class="hljs-title function_">updateCanvas</span>(canvas, editorDom);
          <span class="hljs-comment">// é‡æ–°ç»˜åˆ¶ç½‘æ ¼èƒŒæ™¯</span>
          <span class="hljs-title function_">drawGridBg</span>(canvas);
          zoom = newZoom;
        }
      }
    }
    editorDom?.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'wheel'</span>, handleWheel);
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      editorDom?.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'wheel'</span>, handleWheel);
    };
  }, [canvas]);
  
  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span> 
};
</code></pre>
<h5 data-id="heading-6">å±…ä¸­ç¼©æ”¾</h5>
<p>ä½†å¦‚æœè¿›è¡Œæ‹–æ‹½äº†ï¼Œä¼šå‘ç°ç¼©æ”¾æ—¶ä¸æ˜¯åœ¨å½“å‰å¯è§†åŒºçš„ä¸­å¿ƒç¼©æ”¾ã€‚</p>
<p>å› ä¸ºæˆ‘ä»¬çš„æ‹–æ‹½æ˜¯é€šè¿‡ viewBoxï¼Œæ‰€ä»¥è¿˜éœ€è¦å¢åŠ ä»£ç ï¼Œä¿®æ­£ä¸‹è¿™éƒ¨åˆ†é—®é¢˜ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span>
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> editorDom = svgcanvasRef.<span class="hljs-property">current</span>;
    <span class="hljs-keyword">let</span> zoom = <span class="hljs-number">1</span>;

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleWheel</span>(<span class="hljs-params">e: WheelEvent</span>) {
      <span class="hljs-keyword">if</span> (canvas &amp;&amp; editorDom) {
        e.<span class="hljs-title function_">preventDefault</span>();
        canvas.<span class="hljs-title function_">clearSelection</span>();
        <span class="hljs-comment">// ç¼©æ”¾çš„æ¯”ä¾‹</span>
        <span class="hljs-keyword">const</span> zoomStep = <span class="hljs-number">0.1</span>;
        <span class="hljs-keyword">const</span> delta = e.<span class="hljs-property">deltaY</span> &gt; <span class="hljs-number">0</span> ? -zoomStep : zoomStep;
        <span class="hljs-keyword">const</span> newZoom = zoom + delta;
        <span class="hljs-keyword">if</span> (newZoom &gt; <span class="hljs-number">0.3</span> &amp;&amp; newZoom &lt; <span class="hljs-number">3</span>) {
          canvas.<span class="hljs-title function_">setZoom</span>(newZoom);
          <span class="hljs-title function_">updateCanvas</span>(canvas, editorDom);
          <span class="hljs-title function_">drawGridBg</span>(canvas);
          
          <span class="hljs-comment">/** è¿™éƒ¨åˆ†æ˜¯æ–°å¢çš„ä»£ç */</span>
          <span class="hljs-keyword">const</span> scale = newZoom / zoom;

          <span class="hljs-keyword">const</span> svg = canvas?.<span class="hljs-title function_">getSvgRoot</span>(),
            width = svg?.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'width'</span>),
            height = svg?.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'height'</span>),
            [translateX, translateY] = svg
              .<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'viewBox'</span>)
              ?.<span class="hljs-title function_">split</span>(<span class="hljs-string">' '</span>)
              .<span class="hljs-title function_">map</span>(<span class="hljs-title class_">Number</span>) ?? [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>];

          canvas
            .<span class="hljs-title function_">getSvgRoot</span>()
            .<span class="hljs-title function_">setAttribute</span>(
              <span class="hljs-string">'viewBox'</span>,
              <span class="hljs-string">`<span class="hljs-subst">${translateX * scale}</span> <span class="hljs-subst">${translateY * scale}</span> <span class="hljs-subst">${width}</span> <span class="hljs-subst">${height}</span>`</span>,
            );
          <span class="hljs-comment">/**â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”*/</span>

          zoom = newZoom;
        }
      }
    }
    editorDom?.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'wheel'</span>, handleWheel);
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      editorDom?.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'wheel'</span>, handleWheel);
    };
  }, [canvas]);
  
  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span> 
};
</code></pre>
<h5 data-id="heading-7">é¼ æ ‡ä¸ºä¸­å¿ƒç¼©æ”¾</h5>
<p>åº“ä¸­æä¾›çš„ <code>setZoom</code> æ–¹æ³•æ˜¯ä»¥ <code>id</code> ä¸º <code>svgroot</code> çš„ svg çš„ä¸­å¿ƒç‚¹ä¸ºç¼©æ”¾ä¸­å¿ƒã€‚</p>
<p>æ‰€ä»¥ï¼Œè¦ä»¥ç¼©æ”¾æ—¶è¦ä»¥é¼ æ ‡ä¸ºä¸­å¿ƒçš„è¯ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œä¿®æ­£ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx">  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> editorDom = svgcanvasRef.<span class="hljs-property">current</span>;
    <span class="hljs-keyword">let</span> zoom = <span class="hljs-number">1</span>;

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleWheel</span>(<span class="hljs-params">e: WheelEvent</span>) {
      <span class="hljs-keyword">if</span> (canvas &amp;&amp; editorDom) {
        e.<span class="hljs-title function_">preventDefault</span>();
        canvas.<span class="hljs-title function_">clearSelection</span>();
        <span class="hljs-comment">// ç¼©æ”¾çš„æ¯”ä¾‹</span>
        <span class="hljs-keyword">const</span> zoomStep = <span class="hljs-number">0.1</span>;
        <span class="hljs-keyword">const</span> delta = e.<span class="hljs-property">deltaY</span> &gt; <span class="hljs-number">0</span> ? -zoomStep : zoomStep;
        <span class="hljs-keyword">const</span> newZoom = zoom + delta;
        <span class="hljs-keyword">if</span> (newZoom &gt; <span class="hljs-number">0.3</span> &amp;&amp; newZoom &lt; <span class="hljs-number">3</span>) {
          canvas.<span class="hljs-title function_">setZoom</span>(newZoom);
          <span class="hljs-title function_">updateCanvas</span>(canvas, editorDom);
          <span class="hljs-title function_">drawGridBg</span>(canvas);
          
          <span class="hljs-comment">/** è¿™éƒ¨åˆ†æ˜¯æ–°å¢çš„ä»£ç */</span>
          <span class="hljs-keyword">const</span> svg = canvas?.<span class="hljs-title function_">getSvgRoot</span>(),
            width = svg?.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'width'</span>),
            height = svg?.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'height'</span>),
            [translateX, translateY] = svg
              .<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'viewBox'</span>)
              ?.<span class="hljs-title function_">split</span>(<span class="hljs-string">' '</span>)
              .<span class="hljs-title function_">map</span>(<span class="hljs-title class_">Number</span>) ?? [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>];

          <span class="hljs-keyword">const</span> rect = svgcanvasRef.<span class="hljs-property">current</span>!.<span class="hljs-title function_">getBoundingClientRect</span>();
          <span class="hljs-comment">// svg ä¸­å¿ƒç‚¹çš„è·ç¦»</span>
          <span class="hljs-keyword">let</span> offsetCenterX = e.<span class="hljs-property">clientX</span> - rect.<span class="hljs-property">left</span> - rect.<span class="hljs-property">width</span> / <span class="hljs-number">2</span>,
            offsetCenterY = e.<span class="hljs-property">clientY</span> - rect.<span class="hljs-property">top</span> - rect.<span class="hljs-property">height</span> / <span class="hljs-number">2</span>;

          <span class="hljs-comment">// ç¼©æ”¾ä¸­å¿ƒç‚¹çš„è·ç¦»</span>
          <span class="hljs-keyword">const</span> offsetSvgCenterX = (offsetCenterX + translateX) / zoom,
            offsetSvgCenterY = (offsetCenterY + translateY) / zoom;

          <span class="hljs-comment">// ç¼©æ”¾çš„åç§»å€¼</span>
          <span class="hljs-keyword">const</span> offsetX = offsetSvgCenterX * delta,
            offsetY = offsetSvgCenterY * delta;

          canvas
            .<span class="hljs-title function_">getSvgRoot</span>()
            .<span class="hljs-title function_">setAttribute</span>(
              <span class="hljs-string">'viewBox'</span>,
              <span class="hljs-string">`<span class="hljs-subst">${translateX + offsetX}</span> <span class="hljs-subst">${
                translateY + offsetY
              }</span> <span class="hljs-subst">${width}</span> <span class="hljs-subst">${height}</span>`</span>,
            );
          <span class="hljs-comment">/**â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”*/</span>
          zoom = newZoom;
        }
      }
    }
    editorDom?.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'wheel'</span>, handleWheel);
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      editorDom?.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'wheel'</span>, handleWheel);
    };
  }, [canvas]);
</code></pre>
<h4 data-id="heading-8">é”®ç›˜ç§»åŠ¨å…ƒç´ </h4>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span> = <span class="hljs-function">() =&gt;</span> { 
  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span>

 <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">uDLRMove</span> = (<span class="hljs-params">e: KeyboardEvent</span>) =&gt; {
      <span class="hljs-keyword">const</span> moveStep = <span class="hljs-number">1</span>,
        bigMoveStep = <span class="hljs-number">10</span>;

      <span class="hljs-keyword">const</span> selectedElements = canvas?.<span class="hljs-title function_">getSelectedElements</span>() || [];
      <span class="hljs-keyword">if</span> (selectedElements.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;

      <span class="hljs-keyword">let</span> dx = <span class="hljs-number">0</span>,
        dy = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">const</span> step = e.<span class="hljs-property">shiftKey</span> ? bigMoveStep : moveStep;

      <span class="hljs-keyword">switch</span> (e.<span class="hljs-property">key</span>) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'ArrowUp'</span>:
          dy = -step;
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">'ArrowDown'</span>:
          dy = step;
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">'ArrowLeft'</span>:
          dx = -step;
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">'ArrowRight'</span>:
          dx = step;
          <span class="hljs-keyword">break</span>;
        <span class="hljs-attr">default</span>:
          <span class="hljs-keyword">return</span>;
      }
      e.<span class="hljs-title function_">preventDefault</span>();
      canvas?.<span class="hljs-title function_">moveSelectedElements</span>(dx, dy);
    };

    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'keydown'</span>, uDLRMove);
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'keydown'</span>, uDLRMove);
  }, []);
  
  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span> 
};
</code></pre>
<h4 data-id="heading-9">æŒ‰ä½ ctrl é”®æ¡†é€‰å¤šé€‰</h4>
<p>åº“å·²å®ç°æŒ‰ä½Â <code>Shift</code> + ç‚¹å‡»å…ƒç´ è¿›è¡Œå¤šé€‰ï¼ˆæˆ–å–æ¶ˆé€‰ä¸­ï¼‰çš„åŠŸèƒ½ï¼Œä½†å°šæœªå®ç°æŒ‰ä½Â <code>Ctrl</code> + æ¡†é€‰å¤šé€‰ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span>
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> editorDom = svgcanvasRef.<span class="hljs-property">current</span>;

    <span class="hljs-keyword">if</span> (canvas &amp;&amp; editorDom) {
      editorDom.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mousedown'</span>, canvas?.<span class="hljs-property">mouseDownEvent</span>);
      editorDom.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mousemove'</span>, canvas?.<span class="hljs-property">mouseMoveEvent</span>);
      
      <span class="hljs-comment">// å‚¨å­˜ä¹‹å‰é€‰ä¸­çš„å…ƒç´ </span>
      <span class="hljs-keyword">let</span> <span class="hljs-attr">agoSelectedElements</span>: <span class="hljs-title class_">SVGElement</span>[] = [];

      <span class="hljs-keyword">function</span> <span class="hljs-title function_">mousedown</span>(<span class="hljs-params">e: MouseEvent</span>) {
        <span class="hljs-keyword">if</span> (e.<span class="hljs-property">button</span> === <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span>;

        <span class="hljs-keyword">if</span> (e.<span class="hljs-property">ctrlKey</span> || e.<span class="hljs-property">metaKey</span>) {
          agoSelectedElements = canvas?.<span class="hljs-title function_">getSelectedElements</span>() ?? [];
        } <span class="hljs-keyword">else</span> {
          agoSelectedElements = [];
        }
        canvas?.<span class="hljs-title function_">mouseDownEvent</span>(e);
        <span class="hljs-keyword">if</span> (agoSelectedElements.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
          canvas?.<span class="hljs-title function_">addToSelection</span>(agoSelectedElements);
        }
      }

      <span class="hljs-keyword">function</span> <span class="hljs-title function_">mousemove</span>(<span class="hljs-params">e: MouseEvent</span>) {
        <span class="hljs-keyword">if</span> (!canvas?.<span class="hljs-property">started</span> || e.<span class="hljs-property">button</span> === <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span>;

        canvas?.<span class="hljs-title function_">mouseMoveEvent</span>(e);
        <span class="hljs-keyword">if</span> (agoSelectedElements.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
          canvas.<span class="hljs-title function_">addToSelection</span>(agoSelectedElements);
        }
      }
      editorDom.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mousedown'</span>, mousedown);
      editorDom.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mousemove'</span>, mousemove);
      
      <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
        editorDom.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mousedown'</span>, canvas.<span class="hljs-property">mouseDownEvent</span>);
        editorDom.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mousemove'</span>, canvas.<span class="hljs-property">mouseMoveEvent</span>);
      };
    }
  }, [canvas]);
  
  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span> 
};
</code></pre>
<p>æ­¤å¤„æ˜¯å¯¹ <code>mousedown</code> å’Œ <code>mousemove</code> é€šè¿‡é‡å†™ç›‘å¬ï¼Œè¿›è¡Œäº†åŠŸèƒ½æ‰©å±•ã€‚</p>
<h4 data-id="heading-10">é”®ç›˜æ“ä½œï¼šå¤åˆ¶ã€ç²˜è´´ã€åˆ é™¤</h4>
<p>åœ¨æ‰§è¡Œç²˜è´´æ“ä½œæ—¶ï¼Œè‹¥ç”»å¸ƒå­˜åœ¨ç¼©æ”¾æˆ–å¹³ç§»ï¼Œå…¶ä½ç½®ä¹Ÿéœ€è¦è¿›è¡Œä¿®æ­£ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span>
  
  <span class="hljs-comment">// è®°å½•é¼ æ ‡åœ¨å±å¹•ä¸Šçš„ä½ç½®</span>
  <span class="hljs-keyword">const</span> clientXYRef = useRef&lt;{ <span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>; <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span> }&gt;({ <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> });

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleMouseMove</span>(<span class="hljs-params">e: MouseEvent</span>) {
      clientXYRef.<span class="hljs-property">current</span> = { <span class="hljs-attr">x</span>: e.<span class="hljs-property">clientX</span>, <span class="hljs-attr">y</span>: e.<span class="hljs-property">clientY</span> };
    }
    svgcanvasRef.<span class="hljs-property">current</span>?.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'mousemove'</span>, handleMouseMove);
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      svgcanvasRef.<span class="hljs-property">current</span>?.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'mousemove'</span>, handleMouseMove);
    };
  }, []);
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">onKeyDown</span>(<span class="hljs-params">e: KeyboardEvent</span>) {
      <span class="hljs-comment">//åˆ é™¤åŠŸèƒ½</span>
      <span class="hljs-keyword">if</span> (
        (e.<span class="hljs-property">key</span> === <span class="hljs-string">'Delete'</span> || e.<span class="hljs-property">key</span> === <span class="hljs-string">'Backspace'</span>) &amp;&amp;
        (e.<span class="hljs-property">target</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLElement</span>).<span class="hljs-property">tagName</span> !== <span class="hljs-string">'INPUT'</span>
      ) {
        e.<span class="hljs-title function_">preventDefault</span>();
        canvas?.<span class="hljs-title function_">deleteSelectedElements</span>();
      }
      <span class="hljs-comment">//å¤åˆ¶åŠŸèƒ½ ctrl+c</span>
      <span class="hljs-keyword">if</span> ((e.<span class="hljs-property">key</span> === <span class="hljs-string">'c'</span> || e.<span class="hljs-property">key</span> === <span class="hljs-string">'C'</span>) &amp;&amp; (e.<span class="hljs-property">ctrlKey</span> || e.<span class="hljs-property">metaKey</span>)) {
        e.<span class="hljs-title function_">preventDefault</span>();
        <span class="hljs-keyword">try</span> {
          canvas?.<span class="hljs-title function_">copySelectedElements</span>();
        } <span class="hljs-keyword">catch</span> (error) {}
      }
      <span class="hljs-comment">//ç²˜è´´åŠŸèƒ½ ctrl+v</span>
      <span class="hljs-keyword">if</span> ((e.<span class="hljs-property">key</span> === <span class="hljs-string">'v'</span> || e.<span class="hljs-property">key</span> === <span class="hljs-string">'V'</span>) &amp;&amp; (e.<span class="hljs-property">ctrlKey</span> || e.<span class="hljs-property">metaKey</span>)) {
        e.<span class="hljs-title function_">preventDefault</span>();
        <span class="hljs-keyword">const</span> rect = svgcanvasRef.<span class="hljs-property">current</span>!.<span class="hljs-title function_">getBoundingClientRect</span>();

        <span class="hljs-keyword">const</span> svg = canvas!.<span class="hljs-title function_">getSvgRoot</span>(),
          zoom = canvas?.<span class="hljs-title function_">getZoom</span>() ?? <span class="hljs-number">1</span>,
          [translateX, translateY] = svg
            .<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'viewBox'</span>)
            ?.<span class="hljs-title function_">split</span>(<span class="hljs-string">' '</span>)
            .<span class="hljs-title function_">map</span>(<span class="hljs-title class_">Number</span>) ?? [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>];

        <span class="hljs-keyword">let</span> svgX = (clientXYRef.<span class="hljs-property">current</span>.<span class="hljs-property">x</span> - rect.<span class="hljs-property">left</span> + translateX) / zoom,
          svgY = (clientXYRef.<span class="hljs-property">current</span>.<span class="hljs-property">y</span> - rect.<span class="hljs-property">top</span> + translateY) / zoom;

        <span class="hljs-comment">// ä¿®æ­£åç§»é‡</span>
        <span class="hljs-keyword">const</span> svgcontent = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'svgcontent'</span>)!;
        svgX -= <span class="hljs-title class_">Number</span>(svgcontent.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'x'</span>)) / zoom;
        svgY -= <span class="hljs-title class_">Number</span>(svgcontent.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'y'</span>)) / zoom;
        
        canvas?.<span class="hljs-title function_">pasteElements</span>(<span class="hljs-string">'point'</span>, svgX, svgY);
      }
    }
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'keydown'</span>, onKeyDown);
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'keydown'</span>, onKeyDown);
    };
  }, [canvas]);

  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span> 
};
</code></pre>
<p>è¿™é‡Œä¸ºä»€ä¹ˆè¦åœ¨å¤åˆ¶åŠŸèƒ½é‚£é‡Œå¢åŠ  try/catch é”™è¯¯æ•è·å‘¢ï¼Ÿ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/61c497d5bfa34643a93c99277f723aa6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2n5oyH5LiW6ZiB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768275297&amp;x-signature=ADb%2FJGpkeB0AgOJbyf4ZTtfjGS4%3D" alt="copySelectedElements.png" loading="lazy"/></p>
<p>å› ä¸ºåœ¨ <code>copySelectedElements</code> æºç å†…æ‰§è¡Œäº† <code>document.getElementById('se-cmenu_canvas')</code>,æˆ‘ä»¬è¿™é‡Œæ²¡æœ‰æ·»åŠ è¿™ä¸ª divï¼Œæ‰€ä»¥è¿›è¡ŒæŠ¥é”™çš„æ‹¦æˆªã€‚</p>
<p>è€Œ <code>se-cmenu_canvas</code> å…ƒç´ ä¸»è¦ç”¨åœ¨å³é”®èœå•åŠŸèƒ½ï¼Œå½“æœ‰å¤åˆ¶å†…å®¹è¢«æš‚å­˜æ—¶ï¼Œè¯¥ div ä¼šè¢«èµ‹äºˆä¸€ä¸ªå±æ€§ï¼Œä»¥ä¾¿åç»­åˆ¤æ–­æ˜¯å¦å·²å­˜åœ¨å¤åˆ¶å†…å®¹ã€‚å› æ­¤ï¼Œä½ æœ‰å³é”®èœå•åŠŸèƒ½ï¼Œè®°å¾—åœ¨ div å¯¹åº”ä½ç½®å¢åŠ  <code>id=&amp;#34;se-cmenu_canvas&amp;#34;</code> å±æ€§ã€‚</p>
<h4 data-id="heading-11">æ°´å¹³ç¿»è½¬ï¼Œå‚ç›´ç¿»è½¬</h4>
<p>ç¿»è½¬åŠŸèƒ½çš„æ ¸å¿ƒæ˜¯ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FSVG%2FReference%2FAttribute%2Ftransform%23%25E7%259F%25A9%25E9%2598%25B5" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/transform#%E7%9F%A9%E9%98%B5" ref="nofollow noopener noreferrer">matrix</a>ï¼Œé€šè¿‡çŸ©é˜µæ¥å®ç°çš„ã€‚</p>
<p>ç®€å•è¯´ä¸‹çŸ©é˜µè¿ç®—ä¸­ä¼šç”¨åˆ°çš„ 2 ä¸ª APIï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FDOMMatrix%2FmultiplySelf" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/API/DOMMatrix/multiplySelf" ref="nofollow noopener noreferrer">multiplySelf</a>ï¼šå°†å½“å‰çŸ©é˜µ<strong>å³ä¹˜</strong>å¦ä¸€ä¸ªçŸ©é˜µï¼š<code>å½“å‰çŸ©é˜µ = å½“å‰çŸ©é˜µ Ã— å‚æ•°çŸ©é˜µ</code>ã€‚ç´¯ç§¯å¤šä¸ªå˜æ¢ï¼ŒæŒ‰â€œè‡ªç„¶â€é¡ºåºï¼ˆå¦‚å…ˆç¼©æ”¾ï¼Œå†æ—‹è½¬ï¼Œåå¹³ç§»ï¼‰ã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FDOMMatrix%2FpreMultiplySelf" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/API/DOMMatrix/preMultiplySelf" ref="nofollow noopener noreferrer">preMultiplySelf</a>ï¼šå°†å½“å‰çŸ©é˜µ<strong>å·¦ä¹˜</strong>å¦ä¸€ä¸ªçŸ©é˜µï¼š<code>å½“å‰çŸ©é˜µ = å‚æ•°çŸ©é˜µ Ã— å½“å‰çŸ©é˜µ</code>ã€‚ç´¯ç§¯å¤šä¸ªå˜æ¢ï¼ŒæŒ‰ä¸Â <code>multiplySelf</code>ç›¸åçš„é¡ºåºã€‚</li>
</ul>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span>

 <span class="hljs-comment">// è§£ætransformå±æ€§ï¼Œæå–ç°æœ‰çš„å˜æ¢çŸ©é˜µ</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">parseTransformToMatrix</span>(<span class="hljs-params">element: SVGElement</span>): <span class="hljs-title class_">DOMMatrix</span> {
    <span class="hljs-keyword">const</span> transform = element.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'transform'</span>) || <span class="hljs-string">''</span>;
    <span class="hljs-comment">// æå–çŸ©é˜µå‚æ•°</span>
    <span class="hljs-keyword">const</span> matrixMatch = transform.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/matrix\(([^)]+)\)/</span>);
    <span class="hljs-keyword">if</span> (!matrixMatch) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMMatrix</span>();
    }
    <span class="hljs-keyword">const</span> matrixValues = matrixMatch[<span class="hljs-number">1</span>].<span class="hljs-title function_">split</span>(<span class="hljs-string">','</span>).<span class="hljs-title function_">map</span>(<span class="hljs-title class_">Number</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMMatrix</span>(matrixValues);
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">overturn</span>(<span class="hljs-params"><span class="hljs-keyword">type</span>: <span class="hljs-string">'horizontal'</span> | <span class="hljs-string">'vertical'</span></span>) {
    <span class="hljs-keyword">const</span> selectedElements = canvas?.<span class="hljs-title function_">getSelectedElements</span>();
    <span class="hljs-keyword">if</span> (selectedElements?.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;

    selectedElements?.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">element</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> visualBbox = canvas?.<span class="hljs-title function_">getBBox</span>(element);
      <span class="hljs-keyword">if</span> (!visualBbox) <span class="hljs-keyword">return</span>;

      <span class="hljs-comment">// è·å–ä½ç½®çš„ä¸­å¿ƒç‚¹</span>
      <span class="hljs-keyword">const</span> centerX = visualBbox.<span class="hljs-property">x</span> + visualBbox.<span class="hljs-property">width</span> / <span class="hljs-number">2</span>;
      <span class="hljs-keyword">const</span> centerY = visualBbox.<span class="hljs-property">y</span> + visualBbox.<span class="hljs-property">height</span> / <span class="hljs-number">2</span>;

      <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„ DOM å˜æ¢çŸ©é˜µ</span>
      <span class="hljs-keyword">const</span> flipMatrix = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMMatrix</span>();
      <span class="hljs-comment">// å°†å…ƒç´ å¹³ç§»ï¼Œä½¿å…¶ä¸­ç‚¹ä¸åŸç‚¹é‡åˆ</span>
      flipMatrix.<span class="hljs-title function_">translateSelf</span>(centerX, centerY);
      <span class="hljs-comment">//è¿›è¡Œç¿»è½¬</span>
      <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">type</span>) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'horizontal'</span>:
          flipMatrix.<span class="hljs-title function_">scaleSelf</span>(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>);
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">'vertical'</span>:
          flipMatrix.<span class="hljs-title function_">scaleSelf</span>(<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>);
          <span class="hljs-keyword">break</span>;
      }
      <span class="hljs-comment">// å°†å…ƒç´ å¹³ç§»å›åŸä½ç½®</span>
      flipMatrix.<span class="hljs-title function_">translateSelf</span>(-centerX, -centerY);

      <span class="hljs-comment">// è·å–ç°æœ‰çš„å˜æ¢çŸ©é˜µ</span>
      <span class="hljs-keyword">const</span> existingMatrix = <span class="hljs-title function_">parseTransformToMatrix</span>(element);
      <span class="hljs-comment">// åˆå¹¶ç°æœ‰å˜æ¢</span>
      flipMatrix.<span class="hljs-title function_">preMultiplySelf</span>(existingMatrix);

      <span class="hljs-keyword">const</span> matrixString = <span class="hljs-string">`matrix(<span class="hljs-subst">${flipMatrix.a}</span>, <span class="hljs-subst">${flipMatrix.b}</span>, <span class="hljs-subst">${flipMatrix.c}</span>, <span class="hljs-subst">${flipMatrix.d}</span>, <span class="hljs-subst">${flipMatrix.e}</span>, <span class="hljs-subst">${flipMatrix.f}</span>)`</span>;
      element.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'transform'</span>, matrixString);
    });
  }
  
  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span> 
};
</code></pre>
<h4 data-id="heading-12">è‡ªå®šä¹‰å›¾å½¢</h4>
<p>æœ‰æ—¶å€™åŸºç¡€å›¾å½¢å¾€å¾€æ— æ³•æ»¡è¶³æ‰€æœ‰éœ€æ±‚ï¼Œæ­¤æ—¶ä¾¿éœ€è¦å®ç°è‡ªå®šä¹‰å›¾å½¢çš„èƒ½åŠ›ã€‚</p>
<h5 data-id="heading-13">å­˜å‚¨</h5>
<p>ä¿å­˜çš„é€»è¾‘å¾ˆç®€å•ï¼ŒæŠŠ svg è½¬æˆ string è¿›è¡Œå­˜å‚¨ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">function</span> <span class="hljs-title function_">addCustom</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> selectedElements = canvas?.<span class="hljs-title function_">getSelectedElements</span>();
    <span class="hljs-keyword">if</span> (selectedElements &amp;&amp; selectedElements?.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">const</span> tempSvg = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElementNS</span>(
        <span class="hljs-string">'http://www.w3.org/2000/svg'</span>,
        <span class="hljs-string">'svg'</span>,
      );

      selectedElements.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">elem</span>) =&gt;</span> {
        tempSvg.<span class="hljs-title function_">appendChild</span>(elem);
      });
      state.<span class="hljs-property">canvas</span>?.<span class="hljs-title function_">svgToString</span>(tempSvg, <span class="hljs-number">0</span>);
    }
  }
</code></pre>
<p>ä¸ºä»€ä¹ˆ<code>svgcanvas</code> æä¾›äº† <code>svgToString</code> æ–¹æ³•ï¼Œæ¯”ç›´æ¥ä½¿ç”¨ <code>XMLSerializer</code> ä¼˜åŠ¿åœ¨å“ªå‘¢ï¼Ÿ</p>
<p><code>XMLSerializer</code> åªæ˜¯ç®€å•åœ°å°† DOM æ ‘è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚è€Œ <code>svgToString</code> æ˜¯å¯¹ SVG åºåˆ—åŒ–è¿‡ç¨‹çš„å…¨é¢æ§åˆ¶ï¼šä¼˜åŒ–è¾“å‡ºå¤§å°ã€å¢å¼ºå¯è¯»æ€§ä»¥åŠæ”¯æŒç‰¹æ®ŠåŠŸèƒ½ï¼ˆå¦‚å›¾åƒåµŒå…¥ï¼‰ï¼Œä½¿å¾—ç”Ÿæˆçš„ SVG ä»£ç æ›´åŠ ç²¾ç®€ï¼Œè¾“å‡ºçš„æ–‡ä»¶è´¨é‡æ›´é«˜ã€‚</p>
<h5 data-id="heading-14">å±•ç¤º</h5>
<p>è¿™é‡Œæ˜¯ä½¿ç”¨äº† React çš„ <code>dangerouslySetInnerHTML</code>æ¥å®ç°å…ƒç´ çš„æ¸²æŸ“çš„ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span>
  
<span class="hljs-keyword">const</span> svg1 = <span class="hljs-string">`


 
 
`</span>;

  <span class="hljs-comment">// è·å–è¾¹ç•Œæ¡†</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">getSVGCoordinateRange</span>(<span class="hljs-params">svgString: <span class="hljs-built_in">string</span></span>): {
    <span class="hljs-attr">minX</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">maxX</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">minY</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">maxY</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">svgElement</span>: <span class="hljs-title class_">SVGSVGElement</span>;
  } {
    <span class="hljs-keyword">const</span> parser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMParser</span>();
    <span class="hljs-keyword">const</span> doc = parser.<span class="hljs-title function_">parseFromString</span>(svgString, <span class="hljs-string">'image/svg+xml'</span>);
    <span class="hljs-keyword">const</span> svgElement = doc.<span class="hljs-property">documentElement</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">unknown</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">SVGSVGElement</span>;

    <span class="hljs-keyword">let</span> minX = <span class="hljs-title class_">Infinity</span>,
      minY = <span class="hljs-title class_">Infinity</span>,
      maxX = -<span class="hljs-title class_">Infinity</span>,
      maxY = -<span class="hljs-title class_">Infinity</span>;

    <span class="hljs-keyword">const</span> updateBounds = (<span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {
      minX = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(minX, x);
      minY = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(minY, y);
      maxX = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(maxX, x);
      maxY = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(maxY, y);
    };

    <span class="hljs-keyword">const</span> traverse = (<span class="hljs-attr">element</span>: <span class="hljs-title class_">Element</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> tagName = element.<span class="hljs-property">tagName</span>.<span class="hljs-title function_">toLowerCase</span>();

      <span class="hljs-keyword">switch</span> (tagName) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'polyline'</span>: {
          <span class="hljs-keyword">const</span> points =
            element
              .<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'points'</span>)
              ?.<span class="hljs-title function_">split</span>(<span class="hljs-regexp">/[\s,]+/</span>)
              .<span class="hljs-title function_">map</span>(<span class="hljs-title class_">Number</span>) || [];
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; points.<span class="hljs-property">length</span>; i += <span class="hljs-number">2</span>) {
            <span class="hljs-title function_">updateBounds</span>(points[i], points[i + <span class="hljs-number">1</span>]);
          }
          <span class="hljs-keyword">break</span>;
        }
        <span class="hljs-keyword">case</span> <span class="hljs-string">'rect'</span>: {
          <span class="hljs-keyword">const</span> x = <span class="hljs-built_in">parseFloat</span>(element.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'x'</span>) || <span class="hljs-string">'0'</span>);
          <span class="hljs-keyword">const</span> y = <span class="hljs-built_in">parseFloat</span>(element.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'y'</span>) || <span class="hljs-string">'0'</span>);
          <span class="hljs-keyword">const</span> width = <span class="hljs-built_in">parseFloat</span>(element.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'width'</span>) || <span class="hljs-string">'0'</span>);
          <span class="hljs-keyword">const</span> height = <span class="hljs-built_in">parseFloat</span>(element.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'height'</span>) || <span class="hljs-string">'0'</span>);
          <span class="hljs-comment">// å¤„ç†çŸ©å½¢å››è§’</span>
          <span class="hljs-title function_">updateBounds</span>(x, y);
          <span class="hljs-title function_">updateBounds</span>(x + width, y);
          <span class="hljs-title function_">updateBounds</span>(x, y + height);
          <span class="hljs-title function_">updateBounds</span>(x + width, y + height);
          <span class="hljs-keyword">break</span>;
        }
        <span class="hljs-keyword">case</span> <span class="hljs-string">'text'</span>:
        <span class="hljs-keyword">case</span> <span class="hljs-string">'image'</span>:
          <span class="hljs-title function_">updateBounds</span>(
            <span class="hljs-built_in">parseFloat</span>(element.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'x'</span>) || <span class="hljs-string">'0'</span>),
            <span class="hljs-built_in">parseFloat</span>(element.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'y'</span>) || <span class="hljs-string">'0'</span>),
          );
          <span class="hljs-keyword">break</span>;
        <span class="hljs-comment">/** ......çœç•¥å…¶ä»–å…ƒç´ é€»è¾‘  */</span>
      }
      <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(element.<span class="hljs-property">children</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">child</span>) =&gt;</span> <span class="hljs-title function_">traverse</span>(child));
    };

    <span class="hljs-title function_">traverse</span>(svgElement);

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">minX</span>: minX === <span class="hljs-title class_">Infinity</span> ? <span class="hljs-number">0</span> : minX,
      <span class="hljs-attr">maxX</span>: maxX === -<span class="hljs-title class_">Infinity</span> ? <span class="hljs-number">0</span> : maxX,
      <span class="hljs-attr">minY</span>: minY === <span class="hljs-title class_">Infinity</span> ? <span class="hljs-number">0</span> : minY,
      <span class="hljs-attr">maxY</span>: maxY === -<span class="hljs-title class_">Infinity</span> ? <span class="hljs-number">0</span> : maxY,
      svgElement,
    };
  }
  
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">templateSvg</span>(<span class="hljs-params">svgString: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-keyword">const</span> { minX, minY, maxX, maxY, svgElement } =
      <span class="hljs-title function_">getSVGCoordinateRange</span>(svgString);
      
    svgElement.<span class="hljs-title function_">setAttribute</span>(
      <span class="hljs-string">'viewBox'</span>,
      <span class="hljs-string">`<span class="hljs-subst">${minX}</span> <span class="hljs-subst">${minY}</span> <span class="hljs-subst">${maxX - minX}</span> <span class="hljs-subst">${maxY - minY}</span>`</span>,
    );
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">__html</span>: svgElement.<span class="hljs-property">outerHTML</span> };
  }
  
  <span class="hljs-keyword">return</span> (
    &lt;div&gt; {
        <span class="hljs-keyword">const</span> svgString = e.<span class="hljs-property">currentTarget</span>!.<span class="hljs-property">innerHTML</span>;
        e.<span class="hljs-property">dataTransfer</span>.<span class="hljs-title function_">setData</span>(<span class="hljs-string">'text/plain'</span>, svgString);
      }}
      dangerouslySetInnerHTML={<span class="hljs-title function_">templateSvg</span>(svg1)}
    /&gt;
  );
  
  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span> 
};
</code></pre>
<h5 data-id="heading-15">æ‹–æ‹½æ”¾å…¥</h5>
<p>ç”Ÿæˆå…ƒç´ æ—¶ï¼Œå¿…é¡»ä¸ºå…¶åˆ†é…å”¯ä¸€çš„ idã€‚å¦‚æœå‡ºç°é‡å¤ï¼Œå°†å¯¼è‡´å…ƒç´ ç¼ºå¤±ã€‚</p>
<p>è‹¥è¿›è¡Œè¿‡æ‹–æ‹½å’Œç¼©æ”¾ï¼Œè‡ªç„¶ä¹Ÿéœ€è¦è¿›è¡Œä¿®æ­£ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span>
  
<span class="hljs-keyword">function</span> <span class="hljs-title function_">uuid</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">s</span>: <span class="hljs-title class_">Array</span> = [];
  <span class="hljs-keyword">const</span> hexDigits = <span class="hljs-string">'0123456789abcdef'</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">36</span>; i++) {
    s[i] = hexDigits.<span class="hljs-title function_">substr</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">0x10</span>), <span class="hljs-number">1</span>);
  }
  s[<span class="hljs-number">14</span>] = <span class="hljs-string">'4'</span>; <span class="hljs-comment">// bits 12-15 of the time_hi_and_version field to 0010</span>
  s[<span class="hljs-number">19</span>] = hexDigits.<span class="hljs-title function_">substr</span>((s[<span class="hljs-number">19</span>] &amp; <span class="hljs-number">0x3</span>) | <span class="hljs-number">0x8</span>, <span class="hljs-number">1</span>); <span class="hljs-comment">// bits 6-7 of the clock_seq_hi_and_reserved to 01</span>
  s[<span class="hljs-number">8</span>] = s[<span class="hljs-number">13</span>] = s[<span class="hljs-number">18</span>] = s[<span class="hljs-number">23</span>] = <span class="hljs-string">'-'</span>;

  <span class="hljs-keyword">const</span> uuid = s.<span class="hljs-title function_">join</span>(<span class="hljs-string">''</span>);
  <span class="hljs-keyword">return</span> uuid;
}

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// ç›‘å¬æ‹–æ”¾äº‹ä»¶</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">dropHandler</span> = (<span class="hljs-params">e: DragEvent</span>) =&gt; {
      e.<span class="hljs-title function_">preventDefault</span>();

      <span class="hljs-keyword">let</span> data = e.<span class="hljs-property">dataTransfer</span>?.<span class="hljs-title function_">getData</span>(<span class="hljs-string">'text/plain'</span>);
      <span class="hljs-keyword">if</span> (data &amp;&amp; canvas) {
        <span class="hljs-keyword">const</span> rect = svgcanvasRef.<span class="hljs-property">current</span>!.<span class="hljs-title function_">getBoundingClientRect</span>();

        <span class="hljs-comment">// è½¬æ¢ä¸º SVG åæ ‡ï¼ˆè€ƒè™‘å¹³ç§»å’Œç¼©æ”¾ï¼‰</span>
        <span class="hljs-keyword">const</span> svg = canvas.<span class="hljs-title function_">getSvgRoot</span>(),
          zoom = canvas.<span class="hljs-title function_">getZoom</span>() ?? <span class="hljs-number">1</span>,
          [translateX, translateY] = svg
            .<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'viewBox'</span>)
            ?.<span class="hljs-title function_">split</span>(<span class="hljs-string">' '</span>)
            .<span class="hljs-title function_">map</span>(<span class="hljs-title class_">Number</span>) ?? [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>];
          
        <span class="hljs-keyword">let</span> svgX = (e.<span class="hljs-property">clientX</span> - rect.<span class="hljs-property">left</span> + translateX) / zoom,
          svgY = (e.<span class="hljs-property">clientY</span> - rect.<span class="hljs-property">top</span> + translateY) / zoom;
        <span class="hljs-comment">// ä¿®æ­£åç§»é‡</span>
        <span class="hljs-keyword">const</span> svgcontent = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'svgcontent'</span>)!;
        svgX -= <span class="hljs-title class_">Number</span>(svgcontent.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'x'</span>)) / zoom;
        svgY -= <span class="hljs-title class_">Number</span>(svgcontent.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'y'</span>)) / zoom;

        <span class="hljs-keyword">if</span> (data) {
          <span class="hljs-keyword">const</span> { minX, minY, maxX, maxY, svgElement } =
            <span class="hljs-title function_">getSVGCoordinateRange</span>(data);

          <span class="hljs-keyword">const</span> offsetX = svgX - (minX + (maxX - minX) / <span class="hljs-number">2</span>),
            offsetY = svgY - (minY + (maxY - minY) / <span class="hljs-number">2</span>);

          <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(svgElement.<span class="hljs-property">children</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">ele</span>) =&gt;</span> {
            <span class="hljs-keyword">switch</span> (ele.<span class="hljs-property">tagName</span>) {
              <span class="hljs-keyword">case</span> <span class="hljs-string">'polyline'</span>:
                {
                  <span class="hljs-keyword">const</span> points = ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'points'</span>);
                  <span class="hljs-keyword">const</span> amendPoints = points!
                    .<span class="hljs-title function_">split</span>(<span class="hljs-string">' '</span>)
                    .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
                      <span class="hljs-keyword">const</span> [x, y] = item.<span class="hljs-title function_">split</span>(<span class="hljs-string">','</span>).<span class="hljs-title function_">map</span>(<span class="hljs-title class_">Number</span>);
                      <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${x + offsetX}</span>,<span class="hljs-subst">${y + offsetY}</span>`</span>;
                    })
                    .<span class="hljs-title function_">join</span>(<span class="hljs-string">' '</span>);

                  canvas?.<span class="hljs-title function_">createSVGElement</span>({
                    <span class="hljs-attr">element</span>: <span class="hljs-string">'polyline'</span>,
                    <span class="hljs-attr">attr</span>: {
                      <span class="hljs-attr">points</span>: amendPoints,
                      <span class="hljs-attr">id</span>: <span class="hljs-string">'polyline-'</span> + <span class="hljs-title function_">uuid</span>(),
                      <span class="hljs-attr">stroke</span>: ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'stroke'</span>),
                      <span class="hljs-string">'stroke-width'</span>: ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'stroke-width'</span>),
                    },
                  });
                }
                <span class="hljs-keyword">break</span>;
              <span class="hljs-keyword">case</span> <span class="hljs-string">'rect'</span>:
                {
                  canvas?.<span class="hljs-title function_">createSVGElement</span>({
                    <span class="hljs-attr">element</span>: <span class="hljs-string">'rect'</span>,
                    <span class="hljs-attr">attr</span>: {
                      <span class="hljs-attr">x</span>: <span class="hljs-title class_">Number</span>(ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'x'</span>)) + offsetX,
                      <span class="hljs-attr">y</span>: <span class="hljs-title class_">Number</span>(ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'y'</span>)) + offsetY,
                      <span class="hljs-attr">width</span>: ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'width'</span>),
                      <span class="hljs-attr">height</span>: ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'height'</span>),
                      <span class="hljs-attr">stroke</span>: ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'stroke'</span>),
                      <span class="hljs-attr">fill</span>: ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'fill'</span>),
                      <span class="hljs-string">'stroke-width'</span>: ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'stroke-width'</span>),
                      <span class="hljs-attr">id</span>: <span class="hljs-string">'rect-'</span> + <span class="hljs-title function_">uuid</span>(),
                    },
                  });
                }
                <span class="hljs-keyword">break</span>;
              <span class="hljs-keyword">case</span> <span class="hljs-string">'text'</span>: {
                <span class="hljs-keyword">const</span> text = canvas?.<span class="hljs-title function_">createSVGElement</span>({
                  <span class="hljs-attr">element</span>: <span class="hljs-string">'text'</span>,
                  <span class="hljs-attr">attr</span>: {
                    <span class="hljs-attr">x</span>: <span class="hljs-title class_">Number</span>(ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'x'</span>)) + offsetX,
                    <span class="hljs-attr">y</span>: <span class="hljs-title class_">Number</span>(ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'y'</span>)) + offsetY,
                    <span class="hljs-string">'font-size'</span>: ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'font-size'</span>),
                    <span class="hljs-attr">fill</span>: ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'fill'</span>),
                    <span class="hljs-attr">id</span>: <span class="hljs-string">'text-'</span> + <span class="hljs-title function_">uuid</span>(),
                  },
                });
                text.<span class="hljs-property">textContent</span> = ele.<span class="hljs-property">textContent</span>;
                <span class="hljs-keyword">break</span>;
              }
              <span class="hljs-keyword">case</span> <span class="hljs-string">'image'</span>:
                canvas?.<span class="hljs-title function_">createSVGElement</span>({
                  <span class="hljs-attr">element</span>: <span class="hljs-string">'image'</span>,
                  <span class="hljs-attr">attr</span>: {
                    <span class="hljs-attr">x</span>: <span class="hljs-title class_">Number</span>(ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'x'</span>)) + offsetX,
                    <span class="hljs-attr">y</span>: <span class="hljs-title class_">Number</span>(ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'y'</span>)) + offsetY,
                    <span class="hljs-attr">width</span>: ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'width'</span>),
                    <span class="hljs-attr">height</span>: ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'height'</span>),
                    <span class="hljs-attr">href</span>: ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'href'</span>),
                    <span class="hljs-attr">id</span>: <span class="hljs-string">'image-'</span> + <span class="hljs-title function_">uuid</span>(),
                  },
                });
                <span class="hljs-keyword">break</span>;
              <span class="hljs-comment">/** ......çœç•¥å…¶ä»–å…ƒç´ é€»è¾‘  */</span>
            }
          });
        }
      }
    };

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">preventDefault</span>(<span class="hljs-params">e: DragEvent</span>) {
      e.<span class="hljs-title function_">preventDefault</span>();
    }
    svgcanvasRef.<span class="hljs-property">current</span>?.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'dragover'</span>, preventDefault);
    svgcanvasRef.<span class="hljs-property">current</span>?.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'drop'</span>, dropHandler);

    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      svgcanvasRef.<span class="hljs-property">current</span>?.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'drop'</span>, dropHandler);
      svgcanvasRef.<span class="hljs-property">current</span>?.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'dragover'</span>, preventDefault);
    };
  }, [canvas]);
  
  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span> 
};
</code></pre>
<h4 data-id="heading-16">æ’¤é”€/é‡åšåŠŸèƒ½</h4>
<h5 data-id="heading-17">ä»‹ç»</h5>
<p>è¿™éƒ¨åˆ†åŠŸèƒ½çš„ä¸»è¦ä»£ç æ˜¯åœ¨æºç é‡Œçš„ <code>history.js</code> æ–‡ä»¶ä¸­ï¼Œä¸”é‡‡ç”¨äº†ç»å…¸çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.aliyun.com%2Farticle%2F1284694" target="_blank" title="https://developer.aliyun.com/article/1284694" ref="nofollow noopener noreferrer">å‘½ä»¤æ¨¡å¼</a>çš„è®¾è®¡æ¨¡å¼ã€‚</p>
<p>æ”¯æŒå¤šç§ç±»å‹çš„æ“ä½œå‘½ä»¤ï¼Œéƒ½ç»§æ‰¿è‡ªåŸºç¡€çš„ <code>Command</code> ç±»ï¼š</p>
<ul>
<li><code>MoveElementCommand</code>ï¼šå…ƒç´ ç§»åŠ¨æ“ä½œ</li>
<li><code>InsertElementCommand</code>ï¼šå…ƒç´ æ’å…¥æ“ä½œ</li>
<li><code>RemoveElementCommand</code>ï¼šå…ƒç´ åˆ é™¤æ“ä½œ</li>
<li><code>ChangeElementCommand</code>ï¼šå…ƒç´ å±æ€§ä¿®æ”¹æ“ä½œ</li>
<li><code>BatchCommand</code>ï¼šæ‰¹é‡æ“ä½œå‘½ä»¤ç»„åˆ</li>
</ul>
<p><code>UndoManager</code>ï¼šè´Ÿè´£ç»´æŠ¤å‘½ä»¤å†å²å †æ ˆï¼Œæä¾›æ’¤é”€ä¸é‡åšåŠŸèƒ½çš„æ ¸å¿ƒæ§åˆ¶å™¨ã€‚</p>
<h5 data-id="heading-18">ç¤ºä¾‹</h5>
<p>ä¸‹é¢ä»¥æ‹–æ‹½è‡ªå®šä¹‰å›¾å½¢ä¸ºç¤ºä¾‹</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span>
  
<span class="hljs-comment">// åˆ›å»ºæ‰¹å¤„ç†å‘½ä»¤</span>
<span class="hljs-keyword">const</span> batchCmd = <span class="hljs-keyword">new</span> canvas.<span class="hljs-property">history</span>.<span class="hljs-title class_">BatchCommand</span>(<span class="hljs-string">'æ·»åŠ å¤šä¸ªå›¾å½¢'</span>);

<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(svgElement.<span class="hljs-property">children</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">ele</span>) =&gt;</span> {
  <span class="hljs-keyword">let</span> <span class="hljs-attr">svgElementNode</span>: <span class="hljs-title class_">SVGElement</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  
  <span class="hljs-keyword">switch</span> (ele.<span class="hljs-property">tagName</span>) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'polyline'</span>:
      {
        <span class="hljs-keyword">const</span> points = ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'points'</span>);
        <span class="hljs-keyword">const</span> amendPoints = points!
          .<span class="hljs-title function_">split</span>(<span class="hljs-string">' '</span>)
          .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
            <span class="hljs-keyword">const</span> [x, y] = item.<span class="hljs-title function_">split</span>(<span class="hljs-string">','</span>).<span class="hljs-title function_">map</span>(<span class="hljs-title class_">Number</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${x + offsetX}</span>,<span class="hljs-subst">${y + offsetY}</span>`</span>;
          })
          .<span class="hljs-title function_">join</span>(<span class="hljs-string">' '</span>);

        svgElementNode = canvas?.<span class="hljs-title function_">createSVGElement</span>({
          <span class="hljs-attr">element</span>: <span class="hljs-string">'polyline'</span>,
          <span class="hljs-attr">attr</span>: {
            <span class="hljs-attr">points</span>: amendPoints,
            <span class="hljs-attr">id</span>: <span class="hljs-string">'polyline-'</span> + <span class="hljs-title function_">uuid</span>(),
            <span class="hljs-attr">stroke</span>: ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'stroke'</span>),
            <span class="hljs-string">'stroke-width'</span>: ele.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'stroke-width'</span>),
          },
        });
      }
      <span class="hljs-keyword">break</span>;
    <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span>
  }
  <span class="hljs-keyword">if</span> (svgElementNode) {
    <span class="hljs-comment">// æ·»åŠ å­å‘½ä»¤</span>
    batchCmd.<span class="hljs-title function_">addSubCommand</span>(
      <span class="hljs-keyword">new</span> canvas.<span class="hljs-property">history</span>.<span class="hljs-title class_">InsertElementCommand</span>(svgElementNode, <span class="hljs-string">`è‡ªå®šä¹‰å›¾å½¢å…ƒç´ `</span>),
    );
  }
});

<span class="hljs-comment">// å°†æ‰¹å¤„ç†å‘½ä»¤æ·»åŠ åˆ°å†å²è®°å½•</span>
canvas.<span class="hljs-title function_">addCommandToHistory</span>(batchCmd);

  <span class="hljs-comment">/**......çœç•¥éƒ¨åˆ†ä»£ç  */</span> 
};
</code></pre>
<p><code>BatchCommand</code>çš„ä½œç”¨æ˜¯å°†å¤šä¸ªä¸€ç³»åˆ—æ“ä½œè§†ä¸ºä¸€ä¸ªæ•´ä½“ï¼Œè€Œä¸æ˜¯é›¶æ•£çš„çŠ¶æ€å˜æ›´ï¼Œä½¿å¾—æ•´ä¸ªæ‹–æ‹½è¿‡ç¨‹è¢«è§†ä¸ºä¸€ä¸ªå®Œæ•´çš„æ­¥éª¤ã€‚</p>
<p>æœ€åè°ƒç”¨ <code>addCommandToHistory</code> æ–¹æ³•ï¼Œå°†å¯¹åº”çš„ <code>BatchCommand</code> æ·»åŠ åˆ° <code>UndoManager</code> çš„å†å²æ ˆä¸­ã€‚</p>
<p>è¿™ä¸€æ­¥æ˜¯å…³é”®ï¼Œå› ä¸ºåªæœ‰è¢«è®°å½•åˆ°å†å²æ ˆä¸­çš„å‘½ä»¤ï¼Œæ‰èƒ½åœ¨ æ’¤é”€/é‡åš ä¸­å¤„ç†ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx">    canvas?.<span class="hljs-property">undoMgr</span>.<span class="hljs-title function_">undo</span>()}&gt;
     åé€€
   
    canvas?.<span class="hljs-property">undoMgr</span>.<span class="hljs-title function_">redo</span>()}&gt;
     å‰è¿›
   
</code></pre>
<p>æ‰§è¡Œ <code>ChangeElementCommand</code> å‘½ä»¤æ—¶ï¼Œæœ‰ä¸ªé¡ºåºç»†èŠ‚éœ€è¦æ³¨æ„ï¼Œå¿…é¡»æ˜¯å…ˆå®Œæˆå¯¹å…ƒç´ å±æ€§ä¿®æ”¹åï¼Œå†æ‰§è¡Œå‘½ä»¤çš„æäº¤ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx">   <span class="hljs-comment">// è®°å½•ä¿®æ”¹å‰çš„å€¼</span>
    <span class="hljs-keyword">const</span> oldValue = element.<span class="hljs-title function_">getAttribute</span>(attributeName);
    <span class="hljs-comment">// ä¿®æ”¹å±æ€§å€¼</span>
    element.<span class="hljs-title function_">setAttribute</span>(attributeName, newValue);
    <span class="hljs-comment">// æ‰§è¡Œå®é™…çš„å±æ€§ä¿®æ”¹</span>
    element.<span class="hljs-title function_">setAttribute</span>(attributeName, newValue);
    <span class="hljs-comment">// åˆ›å»º ChangeElementCommand å¹¶æ·»åŠ åˆ°å†å²è®°å½•</span>
    canvas.<span class="hljs-title function_">addCommandToHistory</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChangeElementCommand</span>(element, changes));
</code></pre>
<h2 data-id="heading-19">Q&amp;A</h2>
<h4 data-id="heading-20">å…³äºæ–‡ä¸­çš„ä¿®æ­£åç§»</h4>
<p>ä¸ºä»€ä¹ˆä¸Šé¢ä¼šæœ‰<strong>ä¿®æ­£åç§»</strong>çš„æ“ä½œå‘¢ï¼Ÿ</p>
<p>ç”±äºæ‰€æœ‰å›¾å½¢å…ƒç´ éƒ½ç»˜åˆ¶åœ¨ <code>svgroot</code> ä¸‹çš„å­å®¹å™¨ <code>svgcontent</code> å†…ï¼Œæ­¤æ“ä½œæ­£æ˜¯ä¸ºäº†æ ¡æ­£è¿™ä¸ªå®é™…å®¹å™¨æœ¬èº«çš„åç§»ã€‚</p>
<p>æ‰€ä»¥åœ¨ç²˜è´´å’Œæ‹–æ‹½è‡ªå®šä¹‰å…ƒç´ æ”¾å…¥æ—¶ï¼Œéœ€è¦è¿›è¡Œä¿®æ­£ã€‚</p>
<h4 data-id="heading-21">å…³äº <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FSVG%2FReference%2FAttribute%2Ftransform%23%25E7%259F%25A9%25E9%2598%25B5" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Reference/Attribute/transform#%E7%9F%A9%E9%98%B5" ref="nofollow noopener noreferrer">matrix</a> å‡½æ•°</h4>
<p><code>transform=&amp;#34;matrix(a, b, c, d, e, f)&amp;#34;</code>æ˜¯ SVG å˜æ¢çš„åº•å±‚æ•°å­¦è¡¨ç¤ºã€‚æ¥å—å…­ä¸ªå‚æ•°ï¼Œå®ƒä»¬å…±åŒå®šä¹‰äº†ä¸€ä¸ª 3x3 çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FCSS%2FReference%2FValues%2Ftransform-function%2Fmatrix%23%25E5%258F%2582%25E6%2595%25B0%25E5%2580%25BC" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/CSS/Reference/Values/transform-function/matrix#%E5%8F%82%E6%95%B0%E5%80%BC" ref="nofollow noopener noreferrer">å˜æ¢çŸ©é˜µ</a>ï¼ˆä¸ºäº†ä¾¿äºä»¿å°„å˜æ¢ï¼Œå®é™…ä½¿ç”¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F258437902" target="_blank" title="https://zhuanlan.zhihu.com/p/258437902" ref="nofollow noopener noreferrer">é½æ¬¡åæ ‡</a>ï¼‰ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[ a c e ]</span>
<span class="hljs-selector-attr">[ b d f ]</span>
<span class="hljs-selector-attr">[ 0 0 1 ]</span>
</code></pre>
<p>é€šå¸¸æˆ‘ä»¬å…³æ³¨å·¦ä¸Šè§’çš„ 2x2 çº¿æ€§å˜æ¢çŸ©é˜µ (a, b, c, d) å’Œå³ä¾§åˆ—çš„å¹³ç§»å‘é‡ (e, f) æ¥æè¿°å…ƒç´ åæ ‡ç³»çš„æ‰€æœ‰åŸºç¡€å˜æ¢çš„åº•å±‚æ•°å­¦è¡¨ç¤ºï¼ŒåŠŸèƒ½éå¸¸å¼ºå¤§ä½†ä¹Ÿç›¸å¯¹æŠ½è±¡ã€‚</p>
<p>å¯¹äºç®€å•å˜æ¢ï¼Œä¼˜å…ˆä½¿ç”¨Â translate,Â scale,Â rotate,Â skewX,Â skewY ç­‰å‡½æ•°ä»¥æé«˜ä»£ç å¯è¯»æ€§ã€‚</p>
<ol>
<li><strong>å¹³ç§» (Translation)</strong></li>
</ol>
<ul>
<li>e: æ²¿ X è½´çš„å¹³ç§»é‡ã€‚</li>
<li>f: æ²¿ Y è½´çš„å¹³ç§»é‡ã€‚</li>
</ul>
<p><strong>ç¤ºä¾‹:</strong>Â </p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title function_">matrix</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">100</span>, <span class="hljs-number">50</span>) ===Â <span class="hljs-title function_">translate</span>(100px, 50px)
</code></pre>
<ol start="2">
<li><strong>ç¼©æ”¾ (Scaling)</strong></li>
</ol>
<ul>
<li>a: X è½´æ–¹å‘çš„ç¼©æ”¾å› å­ã€‚</li>
<li>d: Y è½´æ–¹å‘çš„ç¼©æ”¾å› å­ã€‚</li>
</ul>
<p><strong>ç¤ºä¾‹:</strong></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title function_">matrix</span>(<span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>) ===Â <span class="hljs-title function_">scale</span>(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)

<span class="hljs-title function_">matrix</span>(<span class="hljs-number">0.5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>) ===Â <span class="hljs-title function_">scale</span>(<span class="hljs-number">0.5</span>)
</code></pre>
<ol start="3">
<li><strong>æ—‹è½¬ (Rotation)</strong></li>
</ol>
<p>æ—‹è½¬éœ€è¦Â a,Â b,Â c,Â d å…±åŒä½œç”¨ã€‚æ—‹è½¬è§’åº¦Â Î¸(é€šå¸¸ä»¥å¼§åº¦è¡¨ç¤º) æ—¶ï¼š</p>
<ul>
<li>a = cosÎ¸</li>
<li>b = sinÎ¸</li>
<li>c = -sinÎ¸</li>
<li>d = cosÎ¸ã€‚</li>
</ul>
<p><strong>ç¤ºä¾‹:</strong> æ—‹è½¬ 30 åº¦ (â‰ˆ 0.5236 å¼§åº¦)ï¼Œcos(30Â°) â‰ˆ 0.866,Â sin(30Â°) = 0.5ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title function_">matrix</span>(<span class="hljs-number">0.866</span>, <span class="hljs-number">0.5</span>, -<span class="hljs-number">0.5</span>, <span class="hljs-number">0.866</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>) ===Â <span class="hljs-title function_">rotate</span>(30deg)
</code></pre>
<ol start="4">
<li><strong>å€¾æ–œ/é”™åˆ‡ (Skewing/Shearing)</strong></li>
</ol>
<ul>
<li>æ²¿ X è½´å€¾æ–œ (SkewX)ï¼šç”±Â cæ§åˆ¶ã€‚c = tan(Î±)ï¼Œå…¶ä¸­Â Î±æ˜¯å€¾æ–œè§’åº¦ã€‚</li>
<li>æ²¿ Y è½´å€¾æ–œ (SkewY)ï¼šç”±Â bæ§åˆ¶ã€‚b = tan(Î²)ï¼Œå…¶ä¸­Â Î²æ˜¯å€¾æ–œè§’åº¦ã€‚</li>
</ul>
<p><strong>ç¤ºä¾‹:</strong>Â tan(26.565deg) â‰ˆ 0.5ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title function_">matrix</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>) ===Â <span class="hljs-title function_">skewX</span>(<span class="hljs-number">26.</span>565deg) 

<span class="hljs-title function_">matrix</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>) ===Â <span class="hljs-title function_">skewY</span>(<span class="hljs-number">26.</span>565deg)
</code></pre>
<ol start="5">
<li><strong>ç»„åˆå˜æ¢</strong></li>
</ol>
<p>matrixçš„çœŸæ­£å¨åŠ›åœ¨äºå®ƒèƒ½ç”¨ä¸€ä¸ªå‡½æ•°è¡¨ç¤º â€‹â€‹ä»»æ„é¡ºåºã€ä»»æ„ç»„åˆâ€‹â€‹ çš„å¹³ç§»ã€æ—‹è½¬ã€ç¼©æ”¾ã€å€¾æ–œã€‚è¿™æ˜¯é€šè¿‡å°†å„ä¸ªåŸºç¡€å˜æ¢çš„çŸ©é˜µ â€‹â€‹ç›¸ä¹˜â€‹â€‹ å¾—åˆ°çš„ã€‚</p>
<p><strong>é¡ºåºå¾ˆé‡è¦ï¼š</strong> çŸ©é˜µä¹˜æ³•ä¸æ»¡è¶³äº¤æ¢å¾‹ã€‚æ—‹è½¬ * å¹³ç§»å’ŒÂ å¹³ç§» * æ—‹è½¬çš„ç»“æœé€šå¸¸æ˜¯ä¸åŒçš„ã€‚</p>
<ul>
<li>
<p>æ—‹è½¬ * å¹³ç§»ï¼šå…ˆå›´ç»•åŸç‚¹æ—‹è½¬ï¼Œç„¶åå°†æ—‹è½¬åçš„å›¾å½¢å¹³ç§»ã€‚</p>
</li>
<li>
<p>å¹³ç§» * æ—‹è½¬ï¼šå…ˆå°†å›¾å½¢å¹³ç§»åˆ°æ–°ä½ç½®ï¼Œç„¶åå›´ç»•å½“å‰åæ ‡ç³»çš„åŸç‚¹ï¼ˆå³å¹³ç§»åçš„ç‚¹ï¼‰æ—‹è½¬ã€‚</p>
</li>
</ul>
<p><strong>å¦‚ä½•ç»„åˆï¼š</strong> å¦‚æœä½ æœ‰ä¸€ç³»åˆ—åŸºç¡€å˜æ¢ï¼Œè¦å¾—åˆ°ç­‰æ•ˆçš„Â matrixï¼Œä½ éœ€è¦å°†å®ƒä»¬å¯¹åº”çš„çŸ©é˜µæŒ‰ â€‹â€‹ä»å³åˆ°å·¦â€‹â€‹ çš„é¡ºåºç›¸ä¹˜ï¼ˆåœ¨ SVG ä¸­ï¼Œtransform åˆ—è¡¨çš„ä¹¦å†™é¡ºåºä¹Ÿæ˜¯ä»å³åˆ°å·¦åº”ç”¨çš„ï¼‰ã€‚æœ€ç»ˆå¾—åˆ°çš„ 6 ä¸ªå‚æ•°å°±æ˜¯Â matrix(a, b, c, d, e, f)çš„å‚æ•°ã€‚</p>
<h4 data-id="heading-22">å…³äº <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FSVGSVGElement%2FcreateSVGTransform" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/API/SVGSVGElement/createSVGTransform" ref="nofollow noopener noreferrer">createSVGTransform</a> å‡½æ•°</h4>
<p>åœ¨é˜…è¯»æºç æ—¶ï¼Œä½ ä¼šçœ‹åˆ°åœ¨å¯¹å…ƒç´ è¿›è¡Œå˜æ¢ï¼ˆä¾‹å¦‚ç§»åŠ¨ã€æ—‹è½¬ã€ç¼©æ”¾ï¼‰æ“ä½œçš„å‡½æ•°ä¸­ï¼Œ <code>createSVGTransform</code> è¢«é¢‘ç¹çš„è°ƒç”¨ã€‚</p>
<p>createSVGTransformÂ æ˜¯ SVG DOM æä¾›çš„æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºÂ SVG å˜æ¢å¯¹è±¡ï¼ˆSVGTransformï¼‰ï¼Œè¯¥å¯¹è±¡å¯æè¿°å¹³ç§»ã€ç¼©æ”¾ã€æ—‹è½¬ç­‰å‡ ä½•å˜æ¢ã€‚</p>
<p>æ ¸å¿ƒä½œç”¨æ˜¯ï¼šç”Ÿæˆä¸´æ—¶å˜æ¢è§„åˆ™ï¼Œç”¨äºåŠ¨æ€è°ƒæ•´å…ƒç´ åœ¨æ‹–æ‹½ç¼©æ”¾è¿‡ç¨‹ä¸­çš„ä½ç½®å’Œå°ºå¯¸ï¼Œç¡®ä¿å˜æ¢å›´ç»•æ­£ç¡®çš„é”šç‚¹ï¼ˆå¦‚è¾¹è§’ã€ä¸­å¿ƒç‚¹ï¼‰è¿›è¡Œã€‚</p>
<p>ä¸ºä»€ä¹ˆéœ€è¦é€šè¿‡Â <code>createSVGTransform</code>Â åˆ›å»ºï¼Ÿ</p>
<ul>
<li><strong>ä¸´æ—¶å˜æ¢éš”ç¦»ï¼š</strong> ç›´æ¥ä¿®æ”¹å…ƒç´ çš„Â width/heightÂ å¯èƒ½ä¸ç°æœ‰å˜æ¢ï¼ˆå¦‚æ—‹è½¬ï¼‰å†²çªï¼Œè€Œé€šè¿‡Â SVGTransformÂ å¯åœ¨å˜æ¢åˆ—è¡¨ä¸­æ’å…¥ä¸´æ—¶è§„åˆ™ï¼Œé¿å…ç ´ååŸå§‹å±æ€§ã€‚</li>
<li><strong>åŠ¨æ€è°ƒæ•´æ”¯æŒï¼š</strong> æ‹–æ‹½è¿‡ç¨‹ä¸­éœ€è¦å®æ—¶æ›´æ–°å˜æ¢å‚æ•°ï¼ˆå¦‚ç¼©æ”¾æ¯”ä¾‹ï¼‰ï¼ŒSVGTransformÂ å¯¹è±¡å…è®¸éšæ—¶ä¿®æ”¹Â setTranslate/setScaleÂ çš„å‚æ•°å¹¶é‡æ–°åº”ç”¨ã€‚</li>
<li><strong>å˜æ¢ç»„åˆèƒ½åŠ›ï¼š</strong> å¤šä¸ªÂ SVGTransformÂ å¯æŒ‰é¡ºåºç»„åˆï¼ˆå¦‚å…ˆå¹³ç§»å†ç¼©æ”¾ï¼‰ï¼Œå®ç°å¤æ‚çš„å‡ ä½•è°ƒæ•´é€»è¾‘ï¼ˆè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆéœ€è¦åˆ›å»ºä¸‰ä¸ªå¯¹è±¡çš„æ ¸å¿ƒåŸå› ï¼‰ã€‚</li>
</ul>
<p><strong>createSVGTransformÂ çš„ä½œç”¨æ˜¯ï¼š</strong> ç”Ÿæˆå¯é…ç½®çš„å˜æ¢è§„åˆ™ï¼Œé€šè¿‡ä¸´æ—¶ä¿®æ”¹å…ƒç´ çš„å˜æ¢åˆ—è¡¨ï¼Œå®ç°æ‹–æ‹½ç¼©æ”¾è¿‡ç¨‹ä¸­çš„ç²¾å‡†ä½ç½®æ§åˆ¶ã€‚è¿™æ¯”ç›´æ¥ä¿®æ”¹å…ƒç´ å±æ€§ï¼ˆå¦‚Â width/heightï¼‰æ›´çµæ´»ï¼Œå°¤å…¶é€‚ç”¨äºå·²æœ‰æ—‹è½¬ã€å€¾æ–œç­‰å¤æ‚å˜æ¢çš„å…ƒç´ ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3 åŠ¨æ€è·¯ç”±ä¸‹çš„ KeepAlive è®¾è®¡æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7591672090790920211</link>    <guid>https://juejin.cn/post/7591672090790920211</guid>    <pubDate>2026-01-06T01:01:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591672090790920211" data-draft-id="7591715454134730815" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3 åŠ¨æ€è·¯ç”±ä¸‹çš„ KeepAlive è®¾è®¡æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2026-01-06T01:01:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="zmirror"/> <meta itemprop="url" content="https://juejin.cn/user/676954892932935"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3 åŠ¨æ€è·¯ç”±ä¸‹çš„ KeepAlive è®¾è®¡æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/676954892932935/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    zmirror
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T01:01:43.000Z" title="Tue Jan 06 2026 01:01:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    34
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{font-size:24px;display:inline-block;font-weight:700;background:#ef7060;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(239,112,96,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 50px);border-bottom:3px solid #ef7060}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #3e3e3e;margin-top:32px;margin-bottom:32px;height:1px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(27,31,35,.05);color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:JetBranins Mono,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px;background-color:#fdfdfd}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fdfdfd}.markdown-body a{text-decoration:none;font-weight:700;color:#ef7060;border-bottom:1px solid #ef7060}.markdown-body a:active,.markdown-body a:hover{color:#ef2d26}.markdown-body table tr td,.markdown-body table tr th{border:1px solid #ccc;padding:5px 10px}.markdown-body table{display:block!important;width:auto;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{background:#f0f0f0;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f8f8f8}.markdown-body blockquote{margin-inline-start:0;margin-inline-end:0;border-left:3px solid #ef7060;background:#fff9f9;padding:1px 20px;margin-top:20px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h3 data-id="heading-0">1. ç»„ä»¶è®¾ç½® name</h3>
<blockquote>
<p>æ ¸å¿ƒï¼škeep-alive åªè®¤ç»„ä»¶ nameï¼Œæ‰€ä»¥ cachedViews æˆ– include å¿…é¡»ç”¨ç»„ä»¶ nameï¼Œè€Œä¸æ˜¯è·¯ç”± nameã€‚</p>
</blockquote>
<h4 data-id="heading-1">1. defineComponentæ¨¡å¼</h4>
<pre><code class="hljs language-ts" lang="ts">&lt;script lang=<span class="hljs-string">"ts"</span>&gt;
<span class="hljs-keyword">import</span> { defineComponent} <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineComponent</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'CustomName'</span>
})
&lt;/script&gt;
</code></pre>
<h4 data-id="heading-2">2. setupè¯­æ³•ç³–</h4>
<blockquote>
<p>éœ€è¦å•ç‹¬æ–°å¢ä¸€ä¸ªscriptæ ‡ç­¾</p>
</blockquote>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// é¡µé¢ä¸º TSX æ—¶ï¼Œéœ€å°† &lt;script&gt; æ ‡ç­¾æ”¹ä¸º lang="tsx"</span>
&lt;script lang=<span class="hljs-string">"ts"</span>&gt;
  <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'CustomName'</span>,
    <span class="hljs-attr">inheritAttrs</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">customOptions</span>: {}
  }
&lt;/script&gt;
</code></pre>
<h4 data-id="heading-3">3. å€ŸåŠ©æ’ä»¶</h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvue-macros%2Fvue-macros" target="_blank" title="https://github.com/vue-macros/vue-macros" ref="nofollow noopener noreferrer">vue-macros æ’ä»¶</a></p>
<h3 data-id="heading-4">2. åŠ¨æ€ç”Ÿæˆç»„ä»¶ name çš„å®è·µæ–¹æ¡ˆ</h3>
<blockquote>
<p>ç›¸è¾ƒäºå‰ç«¯å­˜å‚¨å…¨é‡è·¯ç”±ç»“åˆæ¥å£æƒé™è¿‡æ»¤çš„æ–¹æ¡ˆï¼Œæ­¤æ–¹æ¡ˆå€ŸåŠ© Vue2 createCustomComponent çš„æ€è·¯ï¼š</p>
</blockquote>
<ul>
<li>æ¯æ¡è·¯ç”±éƒ½ä¼šç”Ÿæˆä¸€ä¸ªç‹¬ç«‹çš„ç»„ä»¶å¯¹è±¡ï¼Œå¹¶ä¸ºå…¶åˆ†é…å”¯ä¸€çš„ <code>name</code></li>
<li>åœ¨åŠ¨æ€ç”Ÿæˆç»„ä»¶æ—¶ï¼Œå°†ç»„ä»¶çš„ <code>name</code> è®¾ç½®ä¸ºåŸºäºè·¯ç”± <code>path</code> å¤„ç†åçš„å®‰å…¨åç§°</li>
</ul>
<h4 data-id="heading-5">1. createCustomComponent</h4>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { defineAsyncComponent, defineComponent, h } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;

<span class="hljs-comment">/**
* <span class="hljs-doctag">@param</span> {<span class="hljs-type"> String </span>} name ç»„ä»¶è‡ªå®šä¹‰åç§°
* <span class="hljs-doctag">@param</span> {<span class="hljs-type"> Component | Promise&lt;Component&gt; </span>} <span class="hljs-variable">componentPromise</span>
* <span class="hljs-doctag">@return</span> {<span class="hljs-type"> Component </span>}
*/</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createCustomComponent</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, componentPromise: <span class="hljs-built_in">any</span></span>) {
  <span class="hljs-comment">// 1. å°† Promise åŒ…è£…æˆæ ‡å‡†çš„å¼‚æ­¥ç»„ä»¶</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title class_">AsyncComp</span> = <span class="hljs-title function_">defineAsyncComponent</span>({
    <span class="hljs-attr">loader</span>: <span class="hljs-function">() =&gt;</span>
      componentPromise <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Promise</span> ? componentPromise : <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(componentPromise),
    <span class="hljs-comment">// å¦‚æœéœ€è¦ï¼Œå¯ä»¥åœ¨è¿™é‡Œé…ç½® loadingComponent</span>
  });

  <span class="hljs-keyword">return</span> <span class="hljs-title function_">defineComponent</span>({
    name, <span class="hljs-comment">// å¿…é¡»è®¾ç½®ï¼Œç”¨äºåŒ¹é… keep-alive çš„ include</span>
    <span class="hljs-title function_">setup</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">// 2. ç›´æ¥è¿”å›æ¸²æŸ“å‡½æ•°ï¼Œæ¸²æŸ“å¼‚æ­¥ç»„ä»¶</span>
      <span class="hljs-comment">// ç§»é™¤å¤–å±‚çš„ divï¼Œè®© AsyncComp æˆä¸º KeepAlive çš„ç›´æ¥å­çº§</span>
      <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">h</span>(<span class="hljs-title class_">AsyncComp</span>);
    },
  });
}
</code></pre>
<h4 data-id="heading-6">2. ç»„ä»¶åè½¬åŒ–</h4>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// å°† path è½¬æˆåˆæ³•çš„ç»„ä»¶åï¼Œé¿å… '/' ç­‰å­—ç¬¦</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">genComponentNameByPath</span>(<span class="hljs-params">path: <span class="hljs-built_in">string</span></span>) {
  <span class="hljs-keyword">return</span> path.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\//g</span>, <span class="hljs-string">"_"</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/^_/</span>, <span class="hljs-string">""</span>);
}
</code></pre>
<h4 data-id="heading-7">3. è·¯ç”±æ¥å…¥ç¤ºä¾‹</h4>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"@/views/dashboard/index.vue"</span>)
<span class="hljs-comment">// è°ƒæ•´ä¸º</span>
<span class="hljs-attr">component</span>: <span class="hljs-title function_">createCustomComponent</span>(<span class="hljs-string">"Dashboard"</span>, <span class="hljs-keyword">import</span>(<span class="hljs-string">"@/views/dashboard/index.vue"</span>))
</code></pre>
<h3 data-id="heading-8">3. é€šç”¨ç»„ä»¶ç¼“å­˜ç­–ç•¥</h3>
<blockquote>
<p>ç–‘é—®ï¼šå¦‚æœå…±ç”¨ä¸€ä¸ªç»„ä»¶æ¥è¿›è¡Œåˆ›å»ºã€ç¼–è¾‘ã€è¯¦æƒ…ï¼Œæ€ä¹ˆæ ¹æ®è·¯å¾„è¿›è¡ŒåŒ¹é…ï¼Ÿ</p>
</blockquote>
<p>å‡è®¾è·¯å¾„æ˜¯ï¼š<code>/banner-list/banner-create</code>ã€<code>/banner-list/banner-edit</code>ã€<code>/banner-list/banner-detail</code>
éœ€è¦å…ˆè¿›è¡Œè·¯å¾„å‘½ä¸­åŒ¹é…ï¼Œæ— æ³•å‘½ä¸­åˆ™ç›´æ¥è¿›è¡Œé»˜è®¤åŒ¹é…ï¼š</p>
<ul>
<li>å…ˆè§£æä¸Šå±‚è·¯å¾„ï¼Œæ‰¾åˆ°æ–‡ä»¶æ‰€åœ¨ä½ç½®</li>
<li>å†è¿›è¡Œç²¾å‡†åŒ¹é…ï¼Œæ¯”å¦‚ï¼šå…¬å…±ç»„ä»¶ç»Ÿä¸€å‘½åä¸ºï¼šbasic-component</li>
</ul>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// æ‰«æviewsç›®å½•ä¸‹çš„vueæ–‡ä»¶</span>
<span class="hljs-keyword">const</span> modules = <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-title function_">glob</span>(<span class="hljs-string">"@/views/**/**.vue"</span>);
<span class="hljs-comment">// å…¨å±€éœ€è¦ keepAlive çš„ path åˆ—è¡¨</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">pathKeepAliveList</span>: <span class="hljs-built_in">string</span>[] = [];

<span class="hljs-comment">/**
* è§£æåç«¯è¿”å›çš„è·¯ç”±æ•°æ®
* <span class="hljs-doctag">@param</span> rawRoutes åç«¯è¿”å›çš„åŸå§‹è·¯ç”±æ•°æ®
* <span class="hljs-doctag">@returns</span> è§£æåçš„è·¯ç”±é…ç½®æ•°ç»„
*/</span>
<span class="hljs-keyword">const</span> parseDynamicRoutes = (<span class="hljs-attr">rawRoutes</span>: <span class="hljs-title class_">AsyncRouter</span>[]): <span class="hljs-title class_">RouteRecordRaw</span>[] =&gt; {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">parsedRoutes</span>: <span class="hljs-title class_">RouteRecordRaw</span>[] = [];

  rawRoutes.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">childrenColumn</span>: <span class="hljs-title class_">RouteRecordRaw</span> = {
      <span class="hljs-attr">path</span>: item.<span class="hljs-property">path</span>,
      <span class="hljs-attr">name</span>: item.<span class="hljs-property">name</span>,
      <span class="hljs-attr">component</span>: <span class="hljs-title class_">Layout</span>,
      <span class="hljs-attr">meta</span>: {
        <span class="hljs-attr">title</span>: item.<span class="hljs-property">name</span>,
        <span class="hljs-attr">icon</span>: item.<span class="hljs-property">icon</span>,
      },
      <span class="hljs-attr">children</span>: [] <span class="hljs-keyword">as</span> <span class="hljs-title class_">RouteRecordRaw</span>[],
    };
    <span class="hljs-keyword">if</span> (item.<span class="hljs-property">children</span>?.<span class="hljs-property">length</span>) {
      childrenColumn.<span class="hljs-property">redirect</span> = item.<span class="hljs-property">children</span>[<span class="hljs-number">0</span>].<span class="hljs-property">path</span>;
      item.<span class="hljs-property">children</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> {
        childrenColumn.<span class="hljs-property">children</span>.<span class="hljs-title function_">push</span>({
          <span class="hljs-attr">path</span>: v.<span class="hljs-property">path</span>,
          <span class="hljs-attr">name</span>: v.<span class="hljs-property">path</span>,
          <span class="hljs-attr">meta</span>: {
            <span class="hljs-attr">title</span>: v.<span class="hljs-property">name</span>,
            <span class="hljs-comment">// æ»¡è¶³æ¡ä»¶çš„pathå¼€å¯ keepAlive</span>
            <span class="hljs-attr">keepAlive</span>: pathKeepAliveList.<span class="hljs-title function_">includes</span>(v.<span class="hljs-property">path</span>),
            <span class="hljs-comment">// å–äºŒçº§è·¯ç”±ä¸ºé«˜äº®ï¼Œå…¼å®¹äºŒã€ä¸‰çº§è·¯ç”±åŒ¹é…</span>
            <span class="hljs-attr">activeMenu</span>: v.<span class="hljs-property">path</span>.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/^/</span>[^<span class="hljs-regexp">/]+/</span>[^<span class="hljs-regexp">/]+/</span>)?.[<span class="hljs-number">0</span>],
          },
          <span class="hljs-attr">component</span>: <span class="hljs-title function_">createCustomComponent</span>(v.<span class="hljs-property">path</span>, modules[<span class="hljs-string">`/src/views<span class="hljs-subst">${v.path}</span>/index.vue`</span>]),
        });
      });
    }

    parsedRoutes.<span class="hljs-title function_">push</span>(childrenColumn);
  });

  <span class="hljs-keyword">return</span> parsedRoutes;
};
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Promiseå®ä¾‹æ–¹æ³•è§£æï¼šthen()ã€catch()ã€finally()]]></title>    <link>https://juejin.cn/post/7591715454134812735</link>    <guid>https://juejin.cn/post/7591715454134812735</guid>    <pubDate>2026-01-06T01:08:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591715454134812735" data-draft-id="7591715454134796351" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Promiseå®ä¾‹æ–¹æ³•è§£æï¼šthen()ã€catch()ã€finally()"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-06T01:08:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="wuhen_n"/> <meta itemprop="url" content="https://juejin.cn/user/4149996261738233"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Promiseå®ä¾‹æ–¹æ³•è§£æï¼šthen()ã€catch()ã€finally()
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4149996261738233/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    wuhen_n
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T01:08:47.000Z" title="Tue Jan 06 2026 01:08:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬ä¸“æ èšç„¦Promiseçš„æ ¸å¿ƒåŸç†ä¸é«˜çº§åº”ç”¨ï¼ŒåŒ…å«ï¼š
âœ“ Promise A+è§„èŒƒæ·±åº¦è§£è¯»
âœ“ æ‰‹å†™å®ç°ä¸æºç åˆ†æ
âœ“ å¼‚æ­¥ç¼–ç¨‹è®¾è®¡æ¨¡å¼
âœ“ æ€§èƒ½è°ƒä¼˜ä¸é”™è¯¯å¤„ç†</p>
</blockquote>
<blockquote>
<p>é€‚åˆæœ‰JavaScriptåŸºç¡€ï¼Œå¸Œæœ›æ·±å…¥å¼‚æ­¥ç¼–ç¨‹çš„å¼€å‘è€…ã€‚æˆ‘ä»¬å°†ç”¨æœ€å°‘çš„ç¯‡å¹…ï¼Œè®²é€æœ€æ ¸å¿ƒçš„çŸ¥è¯†ã€‚</p>
</blockquote>
<h2 data-id="heading-0">å¼•è¨€ï¼šPromiseå®ä¾‹æ–¹æ³•</h2>
<p>åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æ¢è®¨äº†Promiseçš„çŠ¶æ€æœºæ¨¡å‹å’Œä¸å¯å˜åŸåˆ™ã€‚ç†è§£äº†Promiseçš„å†…åœ¨çŠ¶æ€åï¼Œç°åœ¨è®©æˆ‘ä»¬è½¬å‘å®ƒçš„å¤–åœ¨è¡Œä¸ºâ€”â€”å®ä¾‹æ–¹æ³•ã€‚å¦‚æœè¯´çŠ¶æ€æ˜¯Promiseçš„"éª¨éª¼"ï¼Œé‚£ä¹ˆå®ä¾‹æ–¹æ³•å°±æ˜¯å®ƒçš„"è‚Œè‚‰"ï¼Œèµ‹äºˆäº†Promiseå¤„ç†å¼‚æ­¥æ“ä½œçš„èƒ½åŠ›ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥æŠŠPromiseå°±åƒä¸€å°è‡ªåŠ¨å’–å•¡æœºã€‚çŠ¶æ€ï¼ˆ<code>pending</code>ã€<code>fulfilled</code>ã€<code>rejected</code>ï¼‰æ˜¯å®ƒçš„æŒ‡ç¤ºç¯ï¼Œè€Œ<code>then()</code>ã€<code>catch()</code>ã€<code>finally()</code>æ–¹æ³•å°±æ˜¯å®ƒçš„æ“ä½œæŒ‰é’®ã€‚åªæœ‰äº†è§£æ¯ä¸ªæŒ‰é’®çš„ç¡®åˆ‡åŠŸèƒ½å’Œä½¿ç”¨æ—¶æœºï¼Œæˆ‘ä»¬æ‰èƒ½åˆ¶ä½œå‡ºä¸€æ¯å®Œç¾çš„"å¼‚æ­¥å’–å•¡"ã€‚</p>
<h2 data-id="heading-1">then()æ–¹æ³•ï¼šé“¾å¼è°ƒç”¨çš„æ ¸å¿ƒ</h2>
<h3 data-id="heading-2">then()çš„åŸºæœ¬è¯­æ³•</h3>
<p><code>Then()</code>æ–¹æ³•æ˜¯ä¸ºPromiseå¯¹è±¡æ·»åŠ å¤„ç†ç¨‹åºçš„ä¸»è¦æ–¹æ³•ï¼Œä¹Ÿæ˜¯Promiseä¸­æœ€æ ¸å¿ƒã€æœ€å¤æ‚çš„æ–¹æ³•ã€‚å®ƒå¯ä»¥æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š<code>onResolvedå¤„ç†å‡½æ•°</code> å’Œ <code>onRejectedå¤„ç†å‡½æ•°</code> ã€‚è¿™ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯å¯é€‰çš„ï¼Œå¦‚æœæä¾›çš„è¯ï¼Œåˆ™ä¼šåœ¨Promiseè¿›å…¥ <code>fulfilled</code> å’Œ <code>rejected</code> çŠ¶æ€æ—¶æ‰§è¡Œï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">onResolved</span>(<span class="hljs-params">id</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"resolved:"</span> + id)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">onRejected</span>(<span class="hljs-params">id</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"rejected:"</span> + id)
}

<span class="hljs-keyword">let</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> <span class="hljs-title function_">resolve</span>())
<span class="hljs-keyword">let</span> p2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> <span class="hljs-title function_">reject</span>())

p1.<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">onResolved</span>(<span class="hljs-string">'p1'</span>),
    <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">onRejected</span>(<span class="hljs-string">'p1'</span>))
p2.<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">onResolved</span>(<span class="hljs-string">'p2'</span>),
    <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">onRejected</span>(<span class="hljs-string">'p2'</span>))
</code></pre>
<p>ä¸Šè¿°ä»£ç ä¸­ï¼Œç”±äºPromiseåªèƒ½è½¬æ¢ä¸€æ¬¡çŠ¶æ€ï¼Œæ‰€ä»¥p1å’Œp2è¿™ä¸¤ä¸ªæ“ä½œä¸€å®šæ˜¯äº’æ–¥çš„ï¼Œå…¶ç»“æœä¸ºï¼š</p>
<pre><code class="hljs language-bash" lang="bash">resolved:p1
rejected:p2
</code></pre>
<p>ç”±äº<code>onResolvedå¤„ç†å‡½æ•°</code> å’Œ <code>onRejectedå¤„ç†å‡½æ•°</code> è¿™ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯å¯é€‰çš„ï¼Œå½“æˆ‘ä»¬åªæƒ³æä¾› <code>onRejectedå¤„ç†å‡½æ•°</code> æ—¶ï¼Œå¯ä»¥åœ¨ <code>onResolved</code> çš„ä½ç½®ä¸Šä¼ å…¥undefinedæˆ–nullï¼Œè¿™æ ·å¯ä»¥é¿å…åœ¨å†…å­˜ä¸­åˆ›å»ºå¤šä½™çš„å¯¹è±¡ï¼Œå› æ­¤then()æ–¹æ³•åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå…¶ä¼ å‚æ–¹å¼æœ‰ä¸‰ç§ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">promise.<span class="hljs-title function_">then</span>(onFulfilled)  <span class="hljs-comment">// åªå¤„ç†æˆåŠŸ</span>
promise.<span class="hljs-title function_">then</span>(<span class="hljs-literal">null</span>, onRejected)  <span class="hljs-comment">// åªå¤„ç†å¤±è´¥ï¼ˆä¸æ¨èï¼‰</span>
promise.<span class="hljs-title function_">then</span>(onFulfilled, onRejected)  <span class="hljs-comment">// åŒæ—¶å¤„ç†æˆåŠŸå’Œå¤±è´¥</span>
</code></pre>
<blockquote>
<p>æ³¨ï¼š</p>
<ul>
<li>then()æ–¹æ³•ä¸­ï¼Œä¹Ÿå¯ä»¥ä¼ é€’ä¸€ä¸ªéå‡½æ•°ï¼Œå¦‚ï¼špromise.then(â€™Helloâ€˜)ï¼Œä½†ä¼šè¢«é™é»˜å¿½ç•¥ï¼Œå› æ­¤ä¸æ¨èè¿™ç§å†™æ³•ã€‚</li>
<li>promise.then(null, onRejected)è¿™ç§å†™æ³•ä¹Ÿæ˜¯ä¸æ¨èçš„ï¼Œå› ä¸ºä¸€èˆ¬é»˜è®¤è¦å¤„ç†æˆåŠŸå›è°ƒã€‚</li>
</ul>
</blockquote>
<h3 data-id="heading-3">then()çš„é“¾å¼è°ƒç”¨</h3>
<p>PromiseçœŸæ­£çš„å¨åŠ›æ¥è‡ªäºthen()çš„é“¾å¼è°ƒç”¨èƒ½åŠ›ï¼Œè¿™ä¸ä»…ä»…æ˜¯è¯­æ³•ç³–ï¼Œè€Œæ˜¯ä¸€ç§å‡½æ•°å¼ç¼–ç¨‹èŒƒå¼çš„ä½“ç°ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹é¢ä¸€ä¸ªä¾‹å­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¸€ä¸ªå…¸å‹çš„é“¾å¼è°ƒç”¨ç¤ºä¾‹</span>
<span class="hljs-title function_">fetchUserData</span>(userId)
  .<span class="hljs-title function_">then</span>(validateUser)            <span class="hljs-comment">// 1. éªŒè¯ç”¨æˆ·æ•°æ®</span>
  .<span class="hljs-title function_">then</span>(enrichWithProfile)       <span class="hljs-comment">// 2. ä¸°å¯Œä¸ªäººä¿¡æ¯</span>
  .<span class="hljs-title function_">then</span>(saveToDatabase)          <span class="hljs-comment">// 3. ä¿å­˜åˆ°æ•°æ®åº“</span>
  .<span class="hljs-title function_">then</span>(notifySubscribers)       <span class="hljs-comment">// 4. é€šçŸ¥è®¢é˜…è€…</span>
  .<span class="hljs-title function_">then</span>(updateCache)             <span class="hljs-comment">// 5. æ›´æ–°ç¼“å­˜</span>
  .<span class="hljs-title function_">then</span>(finalizeOperation);      <span class="hljs-comment">// 6. å®Œæˆæ“ä½œ</span>
</code></pre>
<h4 data-id="heading-4">é“¾å¼è°ƒç”¨çš„å››ç§è¿”å›å€¼æ¨¡å¼</h4>
<h5 data-id="heading-5">è¿”å›æ™®é€šå€¼</h5>
<p>å½“then()æ–¹æ³•ä¸­è¿”å›ä¸€ä¸ªæ™®é€šå€¼æ—¶ï¼Œè¯¥å€¼ä¼šè¢«åŒ…è£…ä¸ºä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> myPromise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'Hello'</span>);
})

myPromise.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ”¶åˆ°:'</span>, value);
    <span class="hljs-keyword">return</span> <span class="hljs-string">'æ–°çš„æ™®é€šå€¼'</span>;  <span class="hljs-comment">// è‡ªåŠ¨åŒ…è£…ä¸º Promise.resolve('æ–°çš„æ™®é€šå€¼')</span>
}).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">newValue</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é“¾å¼ä¼ é€’:'</span>, newValue);  <span class="hljs-comment">// 'æ–°çš„æ™®é€šå€¼'</span>
});
</code></pre>
<h5 data-id="heading-6">è¿”å›Promise</h5>
<p>å½“then()æ–¹æ³•ä¸­è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡æ—¶ï¼Œä¼šç­‰å¾…è¯¥Promiseå®Œæˆåï¼Œç»§ç»­ä¸‹ä¸€ä¸ªthen()æ–¹æ³•çš„é“¾å¼è°ƒç”¨ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> myPromise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'Hello'</span>)
})

myPromise.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
        <span class="hljs-title function_">resolve</span>(value + <span class="hljs-string">' World'</span>)
    }) <span class="hljs-comment">// è¿”å›æ–°çš„Promise</span>
}).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> {
    <span class="hljs-comment">// ç­‰å¾…new Promiseå®Œæˆ</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¤„ç†åçš„ç»“æœ:'</span>, response)  <span class="hljs-comment">// Hello World</span>
});

</code></pre>
<h5 data-id="heading-7">æŠ›å‡ºå¼‚å¸¸</h5>
<p>å½“then()æ–¹æ³•ä¸­æŠ›å‡ºå¼‚å¸¸æ—¶ï¼Œä¼šè½¬æ¢ä¸ºä¸€ä¸ªrejectedçš„Promiseå¯¹è±¡ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> myPromise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'Hello'</span>)
})

myPromise.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (!value.<span class="hljs-property">valid</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'æ•°æ®æ— æ•ˆ'</span>)  <span class="hljs-comment">// ç­‰ä»·äº Promise.reject(new Error('æ•°æ®æ— æ•ˆ'))</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">processValue</span>(value)
}).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•è·åˆ°é”™è¯¯:'</span>, error.<span class="hljs-property">message</span>)  <span class="hljs-comment">// 'æ•°æ®æ— æ•ˆ'</span>
})
</code></pre>
<h5 data-id="heading-8">æ²¡æœ‰è¿”å›æˆ–è¿”å›undefined</h5>
<p>å½“then()æ–¹æ³•ä¸­æ²¡æœ‰è¿”å›å€¼ï¼Œæˆ–è¿”å›å€¼ä¸ºundefinedæ—¶ï¼Œä¼šå°†undefinedä½œä¸ºä¸€ä¸ªå€¼ï¼Œç»§ç»­ä¼ é€’ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> myPromise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'Hello'</span>)
})

myPromise.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¤„ç†å€¼:'</span>, value)
    <span class="hljs-comment">// æ²¡æœ‰returnè¯­å¥</span>
}).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">nextValue</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¸‹ä¸€ä¸ªå€¼:'</span>, nextValue)  <span class="hljs-comment">// undefined</span>
})
</code></pre>
<h2 data-id="heading-9">catch()æ–¹æ³•ï¼šé”™è¯¯å¤„ç†</h2>
<h3 data-id="heading-10">catch()çš„æœ¬è´¨</h3>
<p><code>Catch()</code> ç”¨äºç»™Promiseæ·»åŠ æ‹’ç»å¤„ç†ç¨‹åºï¼Œå®ƒåªæ¥å—ä¸€ä¸ªå‚æ•°ï¼š<code>onRejectedå¤„ç†å‡½æ•°</code>ã€‚å®é™…ä¸Šï¼Œcatch()æ–¹æ³•æ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œç›¸å½“äºthen(null, onRejected)çš„è¯­æ³•ï¼Œå®ƒçš„å‡ºç°æå¤§åœ°æé«˜äº†ä»£ç çš„å¯è¯»æ€§ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹é¢ä¸€ä¸ªä¾‹å­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä»¥ä¸‹ä¸¤ç§å†™æ³•å®Œå…¨ç­‰ä»·</span>
promise.<span class="hljs-title function_">catch</span>(onRejected)
promise.<span class="hljs-title function_">then</span>(<span class="hljs-literal">null</span>, onRejected)

<span class="hljs-comment">// ä½†.catch()çš„å¯è¯»æ€§æ›´å¥½</span>
<span class="hljs-title function_">fetchData</span>()
  .<span class="hljs-title function_">then</span>(process)
  .<span class="hljs-title function_">catch</span>(handleError)  <span class="hljs-comment">// æ¸…æ™°ï¼šè¿™é‡Œå¤„ç†é”™è¯¯</span>
  .<span class="hljs-title function_">then</span>(continueAfterError)

<span class="hljs-comment">// å¯¹æ¯”ï¼šä½¿ç”¨.then()çš„ç¬¬äºŒä¸ªå‚æ•°</span>
<span class="hljs-title function_">fetchData</span>()
  .<span class="hljs-title function_">then</span>(process, handleError)  <span class="hljs-comment">// ä¸æ¸…æ™°ï¼šæ˜¯å¤„ç†fetché”™è¯¯è¿˜æ˜¯processé”™è¯¯ï¼Ÿ</span>
  .<span class="hljs-title function_">then</span>(continueAfterError)
</code></pre>
<h3 data-id="heading-11">é”™è¯¯ä¼ æ’­æœºåˆ¶</h3>
<p>Promiseçš„é”™è¯¯å¤„ç†éµå¾ªå†’æ³¡åŸåˆ™ï¼šé”™è¯¯ä¼šæ²¿ç€Promiseé“¾å‘åä¼ é€’ï¼Œç›´åˆ°è¢«æ•è·ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é”™è¯¯ä¼ æ’­ç¤ºä¾‹</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>()
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ­¥éª¤1: æˆåŠŸ'</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-string">'ç¬¬ä¸€æ­¥ç»“æœ'</span>
    })
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ­¥éª¤2: æ”¶åˆ°'</span>, result)
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'æ­¥éª¤2å‘ç”Ÿé”™è¯¯'</span>)  <span class="hljs-comment">// æŠ›å‡ºé”™è¯¯</span>
    })
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ­¥éª¤3: è¿™è¡Œä¸ä¼šæ‰§è¡Œ'</span>)  <span class="hljs-comment">// è¢«è·³è¿‡</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">'ç¬¬ä¸‰æ­¥ç»“æœ'</span>;
    })
    .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•è·åˆ°é”™è¯¯:'</span>, error.<span class="hljs-property">message</span>)  <span class="hljs-comment">// 'æ­¥éª¤2å‘ç”Ÿé”™è¯¯'</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">'ä»é”™è¯¯ä¸­æ¢å¤'</span>;
    })
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">recovery</span> =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ¢å¤åç»§ç»­:'</span>, recovery)  <span class="hljs-comment">// 'ä»é”™è¯¯ä¸­æ¢å¤'</span>
    });
</code></pre>
<h2 data-id="heading-12">finally()æ–¹æ³•ï¼šèµ„æºæ¸…ç†</h2>
<h3 data-id="heading-13">finally()æ–¹æ³•çš„ç‹¬ç‰¹æ€§</h3>
<p><code>Finally()</code>æ–¹æ³•ç”¨äºç»™Promiseå®ä¾‹æ·»åŠ  <code>onFinallyå¤„ç†ç¨‹åº</code>ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥é¿å…<code>onResolvedå¤„ç†å‡½æ•°</code> å’Œ <code>onRejectedå¤„ç†å‡½æ•°</code> ä¸­å‡ºç°å†—ä½™ä»£ç ï¼Œæ— è®ºPromiseçŠ¶æ€ä¸º <code>fulfilled</code> æˆ– <code>rejected</code> çš„éƒ½ä¼šæ‰§è¡Œï¼Œå³æ— è®ºPromiseæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œå®ƒéƒ½ä¼šæ‰§è¡Œã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// .finally()çš„åŸºæœ¬ä½¿ç”¨</span>
<span class="hljs-title function_">fetchData</span>()
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•°æ®å¤„ç†:'</span>, data);
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">process</span>(data);
    })
    .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å¤„ç†å¤±è´¥:'</span>, error);
        <span class="hljs-keyword">throw</span> error; <span class="hljs-comment">// é‡æ–°æŠ›å‡ºï¼Œè®©å¤–éƒ¨çŸ¥é“å¤±è´¥</span>
    })
    .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ¸…ç†èµ„æº'</span>);  <span class="hljs-comment">// æ— è®ºæˆåŠŸå¤±è´¥éƒ½ä¼šæ‰§è¡Œ</span>
        <span class="hljs-title function_">cleanupResources</span>();
    });
</code></pre>
<h3 data-id="heading-14">finally()æ–¹æ³•çš„ä¸‰ä¸ªç‰¹æ€§</h3>
<h4 data-id="heading-15">ä¸æ¥å—å‚æ•°</h4>
<pre><code class="hljs language-javascript" lang="javascript">promise.<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// è¿™é‡Œæ— æ³•è®¿é—®Promiseçš„ç»“æœæˆ–é”™è¯¯åŸå› </span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ‰§è¡Œæ¸…ç†'</span>)
})
</code></pre>
<h4 data-id="heading-16">åŸæ ·ä¼ é€’ä¸Šæ¸¸çš„ç»“æœæˆ–é”™è¯¯</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'æˆåŠŸæ•°æ®'</span>)
    .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'finallyæ‰§è¡Œ'</span>);
        <span class="hljs-comment">// è¿™é‡Œè¿”å›çš„å€¼ä¸ä¼šå½±å“é“¾çš„ä¼ é€’</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">'finallyçš„è¿”å›å€¼ä¼šè¢«å¿½ç•¥'</span>;
    })
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ”¶åˆ°:'</span>, value);  <span class="hljs-comment">// 'æˆåŠŸæ•°æ®'ï¼Œä¸æ˜¯'finallyçš„è¿”å›å€¼'</span>
    })
</code></pre>
<h4 data-id="heading-17">å¦‚æœfinallyæŠ›å‡ºé”™è¯¯ï¼Œä¼šè¦†ç›–ä¹‹å‰çš„é”™è¯¯</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">'åŸå§‹æ•°æ®'</span>)
    .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'finallyä¸­çš„é”™è¯¯'</span>);  <span class="hljs-comment">// è¿™ä¸ªé”™è¯¯ä¼šè¦†ç›–ä¹‹å‰çš„ç»“æœ</span>
    })
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¿™ä¸ä¼šæ‰§è¡Œ'</span>);  <span class="hljs-comment">// è¢«è·³è¿‡</span>
    })
    .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•è·çš„é”™è¯¯:'</span>, error.<span class="hljs-property">message</span>);  <span class="hljs-comment">// 'finallyä¸­çš„é”™è¯¯'</span>
    });
</code></pre>
<h2 data-id="heading-18">æ€»ç»“</h2>
<h3 data-id="heading-19">æ–¹æ³•å¯¹æ¯”æ€»ç»“</h3>

































<table><thead><tr><th>æ–¹æ³•</th><th>ä¸»è¦ç”¨é€”</th><th>è¿”å›å€¼å½±å“</th><th>æ‰§è¡Œæ—¶æœº</th><th>æœ€ä½³å®è·µ</th></tr></thead><tbody><tr><td>then()</td><td>å¤„ç†æˆåŠŸç»“æœï¼Œé“¾å¼ä¼ é€’</td><td>å†³å®šä¸‹ä¸€ç¯çš„è¾“å…¥</td><td>å‰ä¸€ä¸ªPromiseå®Œæˆå</td><td>ä¿æŒçº¯å‡½æ•°ï¼Œæ˜ç¡®è¿”å›å€¼</td></tr><tr><td>catch()</td><td>é”™è¯¯æ•è·å’Œæ¢å¤</td><td>å¯æ¢å¤é”™è¯¯æˆ–é‡æ–°æŠ›å‡º</td><td>é“¾ä¸­ä»»ä½•é”™è¯¯å‘ç”Ÿæ—¶</td><td>åœ¨é€‚å½“å±‚çº§å¤„ç†ï¼Œä¸è¦è¿‡æ—©åæ²¡é”™è¯¯</td></tr><tr><td>finally()</td><td>èµ„æºæ¸…ç†å’ŒçŠ¶æ€é‡ç½®</td><td>ä¸å½±å“ç»“æœä¼ é€’</td><td>æ— è®ºå¦‚ä½•éƒ½ä¼šæ‰§è¡Œ</td><td>åªåšæ¸…ç†ï¼Œä¸è¿”å›ä¸šåŠ¡æ•°æ®</td></tr></tbody></table>
<h3 data-id="heading-20">é»„é‡‘æ³•åˆ™</h3>
<ul>
<li>å•ä¸€èŒè´£åŸåˆ™ï¼šæ¯ä¸ªthen()åº”è¯¥åªåšä¸€ä»¶äº‹ã€‚</li>
<li>é”™è¯¯æ—©æŠ›ï¼Œæ™šå¤„ç†ï¼šè®©é”™è¯¯ä¼ æ’­åˆ°åˆé€‚çš„å¤„ç†å±‚ã€‚</li>
<li>finally()åªæ¸…ç†ï¼šä¸è¦åœ¨finallyä¸­è¿”å›ä¸šåŠ¡é€»è¾‘æ•°æ®ã€‚</li>
<li>ä¿æŒé“¾çš„å¯è¯»æ€§ï¼šåˆç†æ‹†åˆ†é•¿é“¾ï¼Œä½¿ç”¨å‘½åå‡½æ•°ã€‚</li>
<li>è€ƒè™‘å¯ç»´æŠ¤æ€§ï¼šä¸ºå¤æ‚çš„é“¾æ·»åŠ æ³¨é‡Šå’Œæ–‡æ¡£ã€‚</li>
</ul>
<h2 data-id="heading-21">ç»“è¯­</h2>
<p>æœ¬æ–‡ä¸»è¦ä»‹ç»äº†Promiseçš„ä¸‰ç§å®ä¾‹åŒ–æ–¹æ³•ï¼Œå¯¹äºæ–‡ç« ä¸­é”™è¯¯çš„åœ°æ–¹æˆ–è€…æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€è®¨è®ºï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3+ElementUIæ ‘å½¢èœå•ï¼šæ„å»ºå±‚æ¬¡åŒ–ç”¨æˆ·ç•Œé¢]]></title>    <link>https://juejin.cn/post/7592017365140602932</link>    <guid>https://juejin.cn/post/7592017365140602932</guid>    <pubDate>2026-01-06T01:48:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592017365140602932" data-draft-id="7591704324907597858" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3+ElementUIæ ‘å½¢èœå•ï¼šæ„å»ºå±‚æ¬¡åŒ–ç”¨æˆ·ç•Œé¢"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-06T01:48:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çˆ±åˆ†äº«çš„é±¼é±¼"/> <meta itemprop="url" content="https://juejin.cn/user/3901536646733133"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3+ElementUIæ ‘å½¢èœå•ï¼šæ„å»ºå±‚æ¬¡åŒ–ç”¨æˆ·ç•Œé¢
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3901536646733133/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çˆ±åˆ†äº«çš„é±¼é±¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T01:48:01.000Z" title="Tue Jan 06 2026 01:48:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    15
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>æ ‘å½¢èœå•èƒ½å¤Ÿä»¥å±‚æ¬¡åŒ–çš„æ–¹å¼å±•ç¤ºå…·æœ‰çˆ¶å­å…³ç³»çš„æ•°æ®ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿç›´è§‚åœ°ç†è§£å¤æ‚çš„æƒé™ç»“æ„ã€ç»„ç»‡æ¶æ„æˆ–å†…å®¹åˆ†ç±»ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨æ ‘å½¢èœå•çš„è®¾è®¡åŸç†ã€å®ç°æ–¹å¼ä»¥åŠåœ¨å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨ã€‚</p>
<h2 data-id="heading-1">ä»€ä¹ˆæ˜¯æ ‘å½¢èœå•</h2>
<p>æ ‘å½¢èœå•ï¼ˆTree Menuï¼‰æ˜¯ä¸€ç§å¯è§†åŒ–åœ°å±•ç¤ºå±‚æ¬¡ç»“æ„æ•°æ®çš„UIç»„ä»¶ã€‚å®ƒé€šå¸¸ç”¨äºè¡¨ç¤ºå…·æœ‰çˆ¶å­å…³ç³»çš„æ•°æ®é›†åˆï¼Œå¦‚æ–‡ä»¶ç³»ç»Ÿã€ç»„ç»‡æ¶æ„ã€æƒé™ç³»ç»Ÿç­‰ã€‚æ ‘å½¢èœå•çš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>å±‚æ¬¡ç»“æ„</strong>ï¼šæ¸…æ™°åœ°å±•ç¤ºæ•°æ®ä¹‹é—´çš„å±‚çº§å…³ç³»</li>
<li><strong>å¯æŠ˜å æ€§</strong>ï¼šå…è®¸ç”¨æˆ·å±•å¼€æˆ–æŠ˜å èŠ‚ç‚¹ä»¥æ§åˆ¶ä¿¡æ¯å¯†åº¦</li>
<li><strong>å¯é€‰æ‹©æ€§</strong>ï¼šæ”¯æŒå•é€‰ã€å¤šé€‰æˆ–çº§è”é€‰æ‹©</li>
<li><strong>äº¤äº’æ€§</strong>ï¼šæä¾›ä¸°å¯Œçš„ç”¨æˆ·äº¤äº’ä½“éªŒ</li>
</ul>
<h2 data-id="heading-2">æ ‘å½¢èœå•çš„æ ¸å¿ƒåŠŸèƒ½</h2>
<h3 data-id="heading-3">1. å±•å¼€/æŠ˜å åŠŸèƒ½</h3>
<p>æ ‘å½¢èœå•æœ€åŸºæœ¬çš„åŠŸèƒ½æ˜¯å…è®¸ç”¨æˆ·å±•å¼€æˆ–æŠ˜å èŠ‚ç‚¹ï¼Œè¿™æœ‰åŠ©äºæ§åˆ¶ä¿¡æ¯çš„æ˜¾ç¤ºå¯†åº¦ã€‚ç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯æˆ–ä¿æŒç•Œé¢ç®€æ´ã€‚</p>
<h3 data-id="heading-4">2. å¤šé€‰åŠŸèƒ½</h3>
<p>åœ¨æƒé™ç®¡ç†ç³»ç»Ÿä¸­ï¼Œæ ‘å½¢èœå•é€šå¸¸éœ€è¦æ”¯æŒå¤šé€‰åŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·é€‰æ‹©å¤šä¸ªèŠ‚ç‚¹ã€‚ç‰¹åˆ«æ˜¯å½“éœ€è¦å®ç°çº§è”é€‰æ‹©æ—¶ï¼ˆé€‰æ‹©çˆ¶èŠ‚ç‚¹æ—¶è‡ªåŠ¨é€‰æ‹©æ‰€æœ‰å­èŠ‚ç‚¹ï¼‰ï¼Œè¿™ä¸€åŠŸèƒ½å°¤ä¸ºé‡è¦ã€‚</p>
<h3 data-id="heading-5">3. æœç´¢å’Œè¿‡æ»¤</h3>
<p>å¯¹äºå¤§å‹æ ‘å½¢ç»“æ„ï¼Œæœç´¢å’Œè¿‡æ»¤åŠŸèƒ½å¯ä»¥å¸®åŠ©ç”¨æˆ·å¿«é€Ÿå®šä½ç‰¹å®šèŠ‚ç‚¹ã€‚</p>
<h2 data-id="heading-6">å®ç°æ ‘å½¢èœå•çš„å…³é”®æŠ€æœ¯</h2>
<h3 data-id="heading-7">æ•°æ®ç»“æ„</h3>
<p>æ ‘å½¢èœå•çš„æ•°æ®ç»“æ„é€šå¸¸é‡‡ç”¨é€’å½’ç»“æ„ï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒ…å«ä»¥ä¸‹å±æ€§ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">{
  <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,                    <span class="hljs-comment">// èŠ‚ç‚¹å”¯ä¸€æ ‡è¯†</span>
  <span class="hljs-attr">name</span>: <span class="hljs-string">"ç³»ç»Ÿç®¡ç†"</span>,          <span class="hljs-comment">// èŠ‚ç‚¹æ˜¾ç¤ºåç§°</span>
  <span class="hljs-attr">parentId</span>: <span class="hljs-literal">null</span>,           <span class="hljs-comment">// çˆ¶èŠ‚ç‚¹ID</span>
  <span class="hljs-attr">children</span>: [               <span class="hljs-comment">// å­èŠ‚ç‚¹æ•°ç»„</span>
    {
      <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>,
      <span class="hljs-attr">name</span>: <span class="hljs-string">"ç”¨æˆ·ç®¡ç†"</span>,
      <span class="hljs-attr">parentId</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">children</span>: []
    }
  ]
}
</code></pre>
<h3 data-id="heading-8">è½¬æ¢ç®—æ³•</h3>
<p>å°†æ‰å¹³åŒ–çš„æ•°æ®è½¬æ¢ä¸ºæ ‘å½¢ç»“æ„æ˜¯å®ç°æ ‘å½¢èœå•çš„å…³é”®æ­¥éª¤ã€‚å¸¸ç”¨çš„è½¬æ¢ç®—æ³•å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">listToTree</span> = (<span class="hljs-params">list, parentId = <span class="hljs-literal">null</span></span>) =&gt; {
  <span class="hljs-keyword">return</span> list
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">parentId</span> === parentId)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({
      ...item,
      <span class="hljs-attr">children</span>: <span class="hljs-title function_">listToTree</span>(list, item.<span class="hljs-property">id</span>)
    }))
}
</code></pre>
<h2 data-id="heading-9">åœ¨Vueé¡¹ç›®ä¸­å®ç°æ ‘å½¢èœå•</h2>
<p>ä»¥Element Plus UIåº“ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶å†…ç½®çš„<a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">el-tree</a>ç»„ä»¶æ¥å®ç°åŠŸèƒ½ä¸°å¯Œçš„æ ‘å½¢èœå•ã€‚</p>
<h3 data-id="heading-10">åŸºç¡€å®ç°</h3>
<pre><code class="hljs language-js" lang="js">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">el-tree</span>
    <span class="hljs-attr">:data</span>=<span class="hljs-string">"treeData"</span>
    <span class="hljs-attr">:props</span>=<span class="hljs-string">"treeProps"</span>
    <span class="hljs-attr">node-key</span>=<span class="hljs-string">"id"</span>
    <span class="hljs-attr">:default-expanded-keys</span>=<span class="hljs-string">"defaultExpandedKeys"</span>
    <span class="hljs-attr">:default-checked-keys</span>=<span class="hljs-string">"checkedKeys"</span>
    <span class="hljs-attr">show-checkbox</span>
  /&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-comment">// æ ‘å½¢æ•°æ®</span>
<span class="hljs-keyword">const</span> treeData = <span class="hljs-title function_">ref</span>([
  {
    <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">label</span>: <span class="hljs-string">'ç³»ç»Ÿç®¡ç†'</span>,
    <span class="hljs-attr">children</span>: [
      {
        <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>,
        <span class="hljs-attr">label</span>: <span class="hljs-string">'ç”¨æˆ·ç®¡ç†'</span>,
        <span class="hljs-attr">children</span>: [
          { <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">'ç”¨æˆ·æŸ¥çœ‹'</span> },
          { <span class="hljs-attr">id</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">'ç”¨æˆ·ç¼–è¾‘'</span> }
        ]
      }
    ]
  }
])

<span class="hljs-comment">// æ ‘å½¢ç»„ä»¶å±æ€§é…ç½®</span>
<span class="hljs-keyword">const</span> treeProps = {
  <span class="hljs-attr">children</span>: <span class="hljs-string">'children'</span>,
  <span class="hljs-attr">label</span>: <span class="hljs-string">'label'</span>
}

<span class="hljs-comment">// é»˜è®¤å±•å¼€çš„èŠ‚ç‚¹</span>
<span class="hljs-keyword">const</span> defaultExpandedKeys = <span class="hljs-title function_">ref</span>([<span class="hljs-number">1</span>])

<span class="hljs-comment">// é»˜è®¤é€‰ä¸­çš„èŠ‚ç‚¹</span>
<span class="hljs-keyword">const</span> checkedKeys = <span class="hljs-title function_">ref</span>([<span class="hljs-number">3</span>])
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h3 data-id="heading-11">é«˜çº§åŠŸèƒ½å®ç°</h3>
<h4 data-id="heading-12">1. çº§è”é€‰æ‹©æ§åˆ¶</h4>
<p>åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦æ§åˆ¶æ˜¯å¦å¯ç”¨çº§è”é€‰æ‹©ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">&lt;el-tree
  :data=<span class="hljs-string">"treeData"</span>
  node-key=<span class="hljs-string">"id"</span>
  show-checkbox
  :check-strictly=<span class="hljs-string">"true"</span>  &lt;!-- ç¦ç”¨çº§è”é€‰æ‹© --&gt;
/&gt;
</code></pre>
<h4 data-id="heading-13">2. è‡ªå®šä¹‰èŠ‚ç‚¹å†…å®¹</h4>
<p>é€šè¿‡ä½œç”¨åŸŸæ’æ§½å¯ä»¥è‡ªå®šä¹‰èŠ‚ç‚¹çš„æ˜¾ç¤ºå†…å®¹ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;el-tree :data="treeData" :props="defaultProps" @node-click="handleNodeClick"&gt;
  &lt;template #default="{ node, data }"&gt;
    &lt;span class="custom-tree-node"&gt;
      &lt;span&gt;{{ node.label }}&lt;/span&gt;
      &lt;span&gt;
        &lt;el-button type="text" size="small"&gt;ç¼–è¾‘&lt;/el-button&gt;
        &lt;el-button type="text" size="small"&gt;åˆ é™¤&lt;/el-button&gt;
      &lt;/span&gt;
    &lt;/span&gt;
  &lt;/template&gt;
&lt;/el-tree&gt;
</code></pre>
<h2 data-id="heading-14">æ ‘å½¢èœå•åœ¨æƒé™ç®¡ç†ä¸­çš„åº”ç”¨</h2>
<p>æƒé™ç®¡ç†æ˜¯æ ‘å½¢èœå•æœ€å¸¸è§çš„åº”ç”¨åœºæ™¯ä¹‹ä¸€ã€‚åœ¨è§’è‰²æƒé™åˆ†é…ä¸­ï¼Œæ ‘å½¢èœå•èƒ½å¤Ÿæ¸…æ™°åœ°å±•ç¤ºèœå•æƒé™çš„å±‚çº§å…³ç³»ï¼Œä½¿ç®¡ç†å‘˜èƒ½å¤Ÿç›´è§‚åœ°åˆ†é…æƒé™ã€‚</p>
<h3 data-id="heading-15">å®é™…åº”ç”¨æ¡ˆä¾‹ï¼šPMSç³»ç»Ÿä¸­çš„è§’è‰²æƒé™ç®¡ç†</h3>
<p>æˆ‘çš„é¡¹ç›®ä¸­ï¼Œå®ç°äº†åŸºäºæ ‘å½¢èœå•çš„è§’è‰²æƒé™ç®¡ç†åŠŸèƒ½ã€‚å…·ä½“å®ç°åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>æƒé™æ•°æ®åŠ è½½</strong>ï¼šä»<a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">menusApiService.js</a>è·å–æ‰€æœ‰å¯ç”¨çš„èœå•æƒé™</li>
<li><strong>æ ‘å½¢ç»“æ„æ„å»º</strong>ï¼šä½¿ç”¨<a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">listToTree</a>å·¥å…·å‡½æ•°å°†æ‰å¹³åŒ–çš„èœå•æ•°æ®è½¬æ¢ä¸ºæ ‘å½¢ç»“æ„</li>
<li><strong>æƒé™é€‰æ‹©ä¸ä¿å­˜</strong>ï¼šé€šè¿‡æ ‘å½¢ç»„ä»¶çš„å¤šé€‰åŠŸèƒ½å®ç°æƒé™çš„æ‰¹é‡åˆ†é…</li>
</ol>
<h3 data-id="heading-16">æƒé™åˆ†é…æµç¨‹</h3>
<ol>
<li><strong>åŠ è½½æƒé™æ•°æ®</strong>ï¼šä»åç«¯è·å–æ‰€æœ‰å¯ç”¨çš„æƒé™èŠ‚ç‚¹</li>
<li><strong>æ„å»ºæ ‘å½¢ç»“æ„</strong>ï¼šå°†æƒé™æ•°æ®è½¬æ¢ä¸ºæ ‘å½¢ç»“æ„</li>
<li><strong>æ˜¾ç¤ºå½“å‰æƒé™</strong>ï¼šåœ¨æ ‘å½¢èœå•ä¸­é«˜äº®æ˜¾ç¤ºå·²åˆ†é…çš„æƒé™</li>
<li><strong>é€‰æ‹©æƒé™</strong>ï¼šç”¨æˆ·é€šè¿‡å‹¾é€‰èŠ‚ç‚¹æ¥åˆ†é…æƒé™</li>
<li><strong>æäº¤å˜æ›´</strong>ï¼šå°†é€‰æ‹©çš„æƒé™ä¿å­˜åˆ°åç«¯</li>
</ol>
<h3 data-id="heading-17">å®é™…ä»£ç å®ç°</h3>
<p>åœ¨<a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">RolesView.vue</a>ä¸­ï¼Œæˆ‘ä»¬å®ç°äº†å®Œæ•´çš„æƒé™ç®¡ç†åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;el-form-item label="æƒé™åˆ—è¡¨" prop="permissions" style="max-height: 180px"&gt;
    &lt;div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;"&gt;
      &lt;div&gt;
        &lt;el-button size="small" @click="selectAllPermissions" type="primary"&gt;å…¨é€‰&lt;/el-button&gt;
        &lt;el-button size="small" @click="unselectAllPermissions" type="info" style="margin-left: 10px;"&gt;å…¨ä¸é€‰&lt;/el-button&gt;
        &lt;el-button size="small" @click="invertSelectPermissions" type="warning"&gt;åé€‰&lt;/el-button&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;el-tree 
      ref="permissionTreeRef"
      :data="permissionTreeData" 
      node-key="id" 
      show-checkbox 
      :default-expanded-keys="defaultExpandedKeys"
      :props="treeProps" 
      style="border: 1px solid #dcdfe6; padding: 10px; border-radius: 4px; max-height: 400px; overflow-y: auto;"&gt;
    &lt;/el-tree&gt;
  &lt;/el-form-item&gt;
&lt;/template&gt;
</code></pre>
<h3 data-id="heading-18">æƒé™æ“ä½œåŠŸèƒ½</h3>
<h4 data-id="heading-19">å…¨é€‰åŠŸèƒ½å®ç°</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">selectAllPermissions</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (permissionTreeRef.<span class="hljs-property">value</span>) {
    <span class="hljs-comment">// è·å–æ‰€æœ‰å¶å­èŠ‚ç‚¹çš„ID</span>
    <span class="hljs-keyword">const</span> allLeafIds = [];
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">collectLeafIds</span> = (<span class="hljs-params">nodes</span>) =&gt; {
      nodes.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">node</span> =&gt;</span> {
        <span class="hljs-keyword">if</span> (node.<span class="hljs-property">children</span> &amp;&amp; node.<span class="hljs-property">children</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
          <span class="hljs-title function_">collectLeafIds</span>(node.<span class="hljs-property">children</span>);
        } <span class="hljs-keyword">else</span> {
          allLeafIds.<span class="hljs-title function_">push</span>(node.<span class="hljs-property">id</span>);
        }
      });
    };
    <span class="hljs-title function_">collectLeafIds</span>(permissionTreeData.<span class="hljs-property">value</span>);
    
    <span class="hljs-comment">// å…¨é€‰æ‰€æœ‰å¶å­èŠ‚ç‚¹</span>
    permissionTreeRef.<span class="hljs-property">value</span>.<span class="hljs-title function_">setCheckedKeys</span>(allLeafIds);
  }
};
</code></pre>
<h4 data-id="heading-20">å…¨ä¸é€‰åŠŸèƒ½å®ç°</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">unselectAllPermissions</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (permissionTreeRef.<span class="hljs-property">value</span>) {
    permissionTreeRef.<span class="hljs-property">value</span>.<span class="hljs-title function_">setCheckedKeys</span>([]);
  }
};
</code></pre>
<h4 data-id="heading-21">åé€‰åŠŸèƒ½å®ç°</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">invertSelectPermissions</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (permissionTreeRef.<span class="hljs-property">value</span>) {
    <span class="hljs-keyword">const</span> checkedKeys = permissionTreeRef.<span class="hljs-property">value</span>.<span class="hljs-title function_">getCheckedKeys</span>();
    <span class="hljs-keyword">const</span> allLeafIds = [];
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">collectLeafIds</span> = (<span class="hljs-params">nodes</span>) =&gt; {
      nodes.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">node</span> =&gt;</span> {
        <span class="hljs-keyword">if</span> (node.<span class="hljs-property">children</span> &amp;&amp; node.<span class="hljs-property">children</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
          <span class="hljs-title function_">collectLeafIds</span>(node.<span class="hljs-property">children</span>);
        } <span class="hljs-keyword">else</span> {
          allLeafIds.<span class="hljs-title function_">push</span>(node.<span class="hljs-property">id</span>);
        }
      });
    };
    <span class="hljs-title function_">collectLeafIds</span>(permissionTreeData.<span class="hljs-property">value</span>);
    
    <span class="hljs-comment">// è®¡ç®—æœªé€‰ä¸­çš„å¶å­èŠ‚ç‚¹</span>
    <span class="hljs-keyword">const</span> uncheckedLeafIds = allLeafIds.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">id</span> =&gt;</span> !checkedKeys.<span class="hljs-title function_">includes</span>(id));
    
    <span class="hljs-comment">// è®¾ç½®æ ‘çš„é€‰ä¸­çŠ¶æ€ä¸ºåé€‰</span>
    permissionTreeRef.<span class="hljs-property">value</span>.<span class="hljs-title function_">setCheckedKeys</span>(uncheckedLeafIds);
  }
};
</code></pre>
<h2 data-id="heading-22">å®é™…åº”ç”¨åœºæ™¯åˆ†æ</h2>
<h3 data-id="heading-23">ç»„ç»‡æ¶æ„ç®¡ç†</h3>
<p>åœ¨ä¼ä¸šç®¡ç†ç³»ç»Ÿä¸­ï¼Œç»„ç»‡æ¶æ„é€šå¸¸å‘ˆç°æ ‘å½¢ç»“æ„ã€‚æ ‘å½¢èœå•å¯ä»¥æ¸…æ™°åœ°å±•ç¤ºå…¬å¸ã€éƒ¨é—¨ã€å›¢é˜Ÿä¹‹é—´çš„å±‚çº§å…³ç³»ï¼Œä¾¿äºç®¡ç†å‘˜è¿›è¡Œç»„ç»‡ç»“æ„çš„è°ƒæ•´å’Œäººå‘˜åˆ†é…ã€‚</p>
<h3 data-id="heading-24">æ–‡ä»¶ç›®å½•ç®¡ç†</h3>
<p>æ–‡ä»¶ç®¡ç†ç³»ç»Ÿä¸­çš„ç›®å½•ç»“æ„å¤©ç„¶å…·æœ‰æ ‘å½¢ç‰¹å¾ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡æ ‘å½¢èœå•ç›´è§‚åœ°æµè§ˆå’Œç®¡ç†æ–‡ä»¶å¤¹ç»“æ„ï¼Œè¿›è¡Œæ–‡ä»¶çš„ç§»åŠ¨ã€å¤åˆ¶ç­‰æ“ä½œã€‚</p>
<h3 data-id="heading-25">äº§å“åˆ†ç±»ç®¡ç†</h3>
<p>åœ¨ç”µå•†ç³»ç»Ÿä¸­ï¼Œäº§å“åˆ†ç±»é€šå¸¸é‡‡ç”¨å¤šçº§åˆ†ç±»ç»“æ„ã€‚æ ‘å½¢èœå•å¯ä»¥å¸®åŠ©ç®¡ç†å‘˜æ›´å¥½åœ°ç»„ç»‡å’Œç®¡ç†å•†å“åˆ†ç±»ï¼Œæé«˜å•†å“ç®¡ç†æ•ˆç‡ã€‚</p>
<h2 data-id="heading-26">æ€§èƒ½ä¼˜åŒ–è€ƒè™‘</h2>
<h3 data-id="heading-27">å¤§æ•°æ®é‡å¤„ç†</h3>
<p>å½“æ ‘å½¢èœå•åŒ…å«å¤§é‡èŠ‚ç‚¹æ—¶ï¼Œéœ€è¦è€ƒè™‘æ€§èƒ½ä¼˜åŒ–ï¼š</p>
<ol>
<li><strong>è™šæ‹Ÿæ»šåŠ¨</strong>ï¼šåªæ¸²æŸ“å¯è§†åŒºåŸŸå†…çš„èŠ‚ç‚¹</li>
<li><strong>æ‡’åŠ è½½</strong>ï¼šæŒ‰éœ€åŠ è½½å­èŠ‚ç‚¹æ•°æ®</li>
<li><strong>æ•°æ®åˆ†é¡µ</strong>ï¼šå¯¹æ ‘å½¢æ•°æ®è¿›è¡Œåˆ†é¡µå¤„ç†</li>
</ol>
<h3 data-id="heading-28">å†…å­˜ç®¡ç†</h3>
<p>åœ¨é•¿æ—¶é—´è¿è¡Œçš„åº”ç”¨ä¸­ï¼Œéœ€è¦å…³æ³¨å†…å­˜ä½¿ç”¨æƒ…å†µï¼š</p>
<ul>
<li>åŠæ—¶æ¸…ç†ä¸éœ€è¦çš„äº‹ä»¶ç›‘å¬å™¨</li>
<li>é¿å…å¾ªç¯å¼•ç”¨å¯¼è‡´çš„å†…å­˜æ³„æ¼</li>
<li>åˆç†ä½¿ç”¨ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸé’©å­</li>
</ul>
<h3 data-id="heading-29">æ¸²æŸ“ä¼˜åŒ–</h3>
<p>å¯¹äºå¤§å‹æ ‘å½¢ç»“æ„ï¼Œå¯ä»¥è€ƒè™‘ä»¥ä¸‹ä¼˜åŒ–ç­–ç•¥ï¼š</p>
<ul>
<li>ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨æŠ€æœ¯å‡å°‘DOMèŠ‚ç‚¹æ•°é‡</li>
<li>å®ç°èŠ‚ç‚¹çš„æ‡’åŠ è½½ï¼Œåªåœ¨ç”¨æˆ·å±•å¼€æ—¶åŠ è½½å­èŠ‚ç‚¹</li>
<li>ä½¿ç”¨é˜²æŠ–æŠ€æœ¯ä¼˜åŒ–æœç´¢å’Œè¿‡æ»¤åŠŸèƒ½</li>
</ul>
<h2 data-id="heading-30">æ€»ç»“</h2>
<p>æ ‘å½¢èœå•ä½œä¸ºå±•ç¤ºå±‚æ¬¡åŒ–æ•°æ®çš„é‡è¦ç»„ä»¶ï¼Œåœ¨ç°ä»£Webåº”ç”¨ä¸­å‘æŒ¥ç€å…³é”®ä½œç”¨ã€‚é€šè¿‡åˆç†çš„è®¾è®¡å’Œå®ç°ï¼Œæ ‘å½¢èœå•ä¸ä»…èƒ½å¤Ÿæœ‰æ•ˆåœ°ç»„ç»‡å¤æ‚çš„æ•°æ®ç»“æ„ï¼Œè¿˜èƒ½æä¾›è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒã€‚</p>
<p>åœ¨å®é™…é¡¹ç›®å¼€å‘ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©åˆé€‚çš„å®ç°æ–¹å¼ï¼Œè€ƒè™‘æ€§èƒ½ã€å¯è®¿é—®æ€§å’Œç”¨æˆ·ä½“éªŒç­‰å¤šä¸ªæ–¹é¢ã€‚éšç€å‰ç«¯æŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œæ ‘å½¢èœå•çš„å®ç°æ–¹å¼ä¹Ÿåœ¨ä¸æ–­æ¼”è¿›ï¼Œä½†å…¶æ ¸å¿ƒç›®æ ‡å§‹ç»ˆæ˜¯å¸®åŠ©ç”¨æˆ·æ›´å¥½åœ°ç†è§£å’Œæ“ä½œå±‚æ¬¡åŒ–æ•°æ®ã€‚</p>
<p>é€šè¿‡æœ¬æ–‡çš„ä»‹ç»ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°ç†è§£å’Œåº”ç”¨æ ‘å½¢èœå•ç»„ä»¶ï¼Œåœ¨å®é™…é¡¹ç›®ä¸­æ„å»ºå‡ºåŠŸèƒ½å¼ºå¤§ä¸”ç”¨æˆ·å‹å¥½çš„å±‚æ¬¡åŒ–ç•Œé¢ã€‚æ ‘å½¢èœå•ä¸ä»…æ˜¯æŠ€æœ¯å®ç°ï¼Œæ›´æ˜¯ç”¨æˆ·ä½“éªŒè®¾è®¡çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œéœ€è¦åœ¨åŠŸèƒ½æ€§å’Œæ˜“ç”¨æ€§ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ç‚¹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScriptçš„newé­”æ³•ï¼šä»é›¶åˆ›é€ ä¸€ä¸ªå¯¹è±¡çš„å¥‡å¦™æ—…ç¨‹]]></title>    <link>https://juejin.cn/post/7591972586360520723</link>    <guid>https://juejin.cn/post/7591972586360520723</guid>    <pubDate>2026-01-06T02:10:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591972586360520723" data-draft-id="7591672090791215123" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScriptçš„newé­”æ³•ï¼šä»é›¶åˆ›é€ ä¸€ä¸ªå¯¹è±¡çš„å¥‡å¦™æ—…ç¨‹"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-06T02:10:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="JS_Likers"/> <meta itemprop="url" content="https://juejin.cn/user/1377017277975032"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScriptçš„newé­”æ³•ï¼šä»é›¶åˆ›é€ ä¸€ä¸ªå¯¹è±¡çš„å¥‡å¦™æ—…ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1377017277975032/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    JS_Likers
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T02:10:18.000Z" title="Tue Jan 06 2026 02:10:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€ï¼šå½“ä»£ç å¼€å§‹â€œç”Ÿå­©å­â€</h2>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ˜¯ä¸€ä½JavaScripté­”æ³•å¸ˆï¼Œæœ‰ä¸€å¤©ä½ å¿µå‡ºäº†ä¸€å¥å’’è¯­ <code>new Person()</code>ï¼Œçªç„¶ä¹‹é—´ï¼Œä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡å°±å‡ºç°åœ¨ä½ çš„é¢å‰ï¼è¿™æ„Ÿè§‰å°±åƒæ˜¯ä»£ç åœ¨â€œç”Ÿå­©å­â€ï¼Œè€Œ<code>new</code>å°±æ˜¯é‚£ä¸ªç¥å¥‡çš„åŠ©äº§å£«ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥æ­å¼€è¿™ä¸ªé­”æ³•èƒŒåçš„ç§˜å¯†ï¼Œçœ‹çœ‹å½“ä½ åœ¨JavaScriptä¸­ä½¿ç”¨<code>new</code>å…³é”®å­—æ—¶ï¼Œç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆå¥‡å¦™çš„äº‹æƒ…ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€å…ˆæ¥çœ‹ä¸€ä¸ªç®€å•ä¾‹å­</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªç®€å•çš„æ„é€ å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name, age</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
}

<span class="hljs-comment">// ç»™åŸå‹æ·»åŠ æ–¹æ³•</span>
<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayHello</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ä½ å¥½ï¼Œæˆ‘æ˜¯<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>ï¼Œä»Šå¹´<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.age}</span>å²ï¼`</span>);
}

<span class="hljs-comment">// ä½¿ç”¨newåˆ›å»ºå¯¹è±¡</span>
<span class="hljs-keyword">const</span> xiaoming = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'å°æ˜'</span>, <span class="hljs-number">20</span>);
xiaoming.<span class="hljs-title function_">sayHello</span>(); <span class="hljs-comment">// è¾“å‡ºï¼šä½ å¥½ï¼Œæˆ‘æ˜¯å°æ˜ï¼Œä»Šå¹´20å²ï¼</span>
</code></pre>
<p>è¿™ä¸€åˆ‡çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä½†å¹•ååˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<h2 data-id="heading-2">äºŒã€newæ“ä½œç¬¦çš„é­”æ³•å››éƒ¨æ›²</h2>
<p>è®©æˆ‘ä»¬é€šè¿‡æµç¨‹å›¾æ¥ç›´è§‚ç†è§£æ•´ä¸ªè¿‡ç¨‹ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[å¼€å§‹ï¼šnew Constructor()] --&gt; B[ç¬¬ä¸€æ­¥&lt;br&gt;åˆ›å»ºç©ºå¯¹è±¡]
    B --&gt; C[ç¬¬äºŒæ­¥&lt;br&gt;è®¾ç½®åŸå‹é“¾]
    C --&gt; D[ç¬¬ä¸‰æ­¥&lt;br&gt;æ‰§è¡Œæ„é€ å‡½æ•°&lt;br&gt;ç»‘å®šthis]
    D --&gt; E{æ„é€ å‡½æ•°æœ‰è¿”å›å€¼å—ï¼Ÿ}
    E --&gt;|è¿”å›å¯¹è±¡| F[è¿”å›è¯¥å¯¹è±¡]
    E --&gt;|å…¶ä»–æƒ…å†µ| G[è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡]
    F --&gt; H[ç»“æŸ]
    G --&gt; H
</code></pre>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥æ­¥è¯¦ç»†è§£é‡Šï¼š</p>
<h3 data-id="heading-3"><strong>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºç©ºå¯¹è±¡</strong></h3>
<p>JavaScriptä¼šé»˜é»˜åœ°åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ç©ºå¯¹è±¡ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> newObject = {};
</code></pre>
<h3 data-id="heading-4"><strong>ç¬¬äºŒæ­¥ï¼šè®¾ç½®åŸå‹é“¾</strong></h3>
<p>è¿™ä¸ªæ–°å¯¹è±¡ä¼šè¿æ¥åˆ°æ„é€ å‡½æ•°çš„åŸå‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">newObject.<span class="hljs-property">__proto__</span> = <span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
</code></pre>
<p>ï¼ˆæ³¨ï¼šå®é™…ä½¿ç”¨çš„æ˜¯<code>Object.setPrototypeOf()</code>æˆ–å†…éƒ¨æœºåˆ¶ï¼Œä½†<code>__proto__</code>æ›´ç›´è§‚ï¼‰</p>
<h3 data-id="heading-5"><strong>ç¬¬ä¸‰æ­¥ï¼šæ‰§è¡Œæ„é€ å‡½æ•°å¹¶ç»‘å®šthis</strong></h3>
<p>æ„é€ å‡½æ•°è¢«è°ƒç”¨ï¼Œå¹¶ä¸”<code>this</code>è¢«ç»‘å®šåˆ°æ–°åˆ›å»ºçš„å¯¹è±¡ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">call</span>(newObject, ...<span class="hljs-variable language_">arguments</span>);
</code></pre>
<h3 data-id="heading-6"><strong>ç¬¬å››æ­¥ï¼šå¤„ç†è¿”å›å€¼</strong></h3>
<ul>
<li>å¦‚æœæ„é€ å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡ä¼šæˆä¸ºæ•´ä¸ª<code>new</code>è¡¨è¾¾å¼çš„ç»“æœ</li>
<li>å¦åˆ™ï¼Œè¿”å›æ–°åˆ›å»ºçš„é‚£ä¸ªå¯¹è±¡</li>
</ul>
<h2 data-id="heading-7">ä¸‰ã€äº²æ‰‹å®ç°ä¸€ä¸ªè‡ªå·±çš„newå‡½æ•°</h2>
<p>ç†è§£äº†åŸç†ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥è‡ªå·±å®ç°ä¸€ä¸ª<code>new</code>çš„åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">myNew</span>(<span class="hljs-params">Constructor, ...args</span>) {
    <span class="hljs-comment">// 1. åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡</span>
    <span class="hljs-keyword">const</span> obj = {};
    
    <span class="hljs-comment">// 2. å°†å¯¹è±¡çš„åŸå‹æŒ‡å‘æ„é€ å‡½æ•°çš„prototype</span>
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">setPrototypeOf</span>(obj, <span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
    
    <span class="hljs-comment">// 3. æ‰§è¡Œæ„é€ å‡½æ•°ï¼Œç»‘å®šthisåˆ°æ–°å¯¹è±¡</span>
    <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">apply</span>(obj, args);
    
    <span class="hljs-comment">// 4. åˆ¤æ–­è¿”å›å€¼ç±»å‹</span>
    <span class="hljs-keyword">return</span> result <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Object</span> ? result : obj;
}

<span class="hljs-comment">// æµ‹è¯•æˆ‘ä»¬è‡ªå·±çš„new</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params">type, sound</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span> = type;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">sound</span> = sound;
}

<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">makeSound</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.type}</span>å‘å‡ºå£°éŸ³ï¼š<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.sound}</span>`</span>);
}

<span class="hljs-keyword">const</span> cat = <span class="hljs-title function_">myNew</span>(<span class="hljs-title class_">Animal</span>, <span class="hljs-string">'çŒ«'</span>, <span class="hljs-string">'å–µå–µ'</span>);
cat.<span class="hljs-title function_">makeSound</span>(); <span class="hljs-comment">// è¾“å‡ºï¼šçŒ«å‘å‡ºå£°éŸ³ï¼šå–µå–µ</span>
</code></pre>
<h2 data-id="heading-8">å››ã€å¸¸è§é™·é˜±ä¸è¶£äº‹</h2>
<h3 data-id="heading-9">é™·é˜±1ï¼šå¿˜è®°ä½¿ç”¨new</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Car</span>(<span class="hljs-params">model</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">model</span> = model;
}

<span class="hljs-comment">// é”™è¯¯ç”¨æ³•ï¼ˆå¿˜è®°newï¼‰</span>
<span class="hljs-keyword">const</span> myCar = <span class="hljs-title class_">Car</span>(<span class="hljs-string">'Tesla'</span>); 
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(myCar); <span class="hljs-comment">// undefined</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">model</span>); <span class="hljs-comment">// Teslaï¼ˆæ±¡æŸ“äº†å…¨å±€å˜é‡ï¼ï¼‰</span>
</code></pre>
<p>è§£å†³æ–¹æ³•ï¼šä½¿ç”¨ä¸¥æ ¼æ¨¡å¼æˆ–åœ¨æ„é€ å‡½æ•°ä¸­åšæ£€æŸ¥</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Car</span>(<span class="hljs-params">model</span>) {
    <span class="hljs-keyword">if</span> (!(<span class="hljs-variable language_">this</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Car</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Car</span>(model);
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">model</span> = model;
}
</code></pre>
<h3 data-id="heading-10">é™·é˜±2ï¼šæ„é€ å‡½æ•°è¿”å›å¯¹è±¡</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Dog</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">name</span>: <span class="hljs-string">'æˆ‘ä¸æ˜¯ç‹—'</span> }; <span class="hljs-comment">// è¿”å›ä¸€ä¸ªå¯¹è±¡</span>
}

<span class="hljs-keyword">const</span> myDog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-string">'æ—ºè´¢'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(myDog.<span class="hljs-property">name</span>); <span class="hljs-comment">// "æˆ‘ä¸æ˜¯ç‹—"ï¼ˆä¸æ˜¯é¢„æœŸçš„"æ—ºè´¢"ï¼ï¼‰</span>
</code></pre>
<h3 data-id="heading-11">è¶£äº‹ï¼šç®­å¤´å‡½æ•°ä¸èƒ½å½“æ„é€ å‡½æ•°</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">Person</span> = (<span class="hljs-params">name</span>) =&gt; {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name; <span class="hljs-comment">// é”™è¯¯ï¼ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„this</span>
};

<span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'å°æ˜'</span>); <span class="hljs-comment">// TypeError: Person is not a constructor</span>
</code></pre>
<h2 data-id="heading-12">äº”ã€å®é™…åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-13">åœºæ™¯1ï¼šåˆ›å»ºå…·æœ‰ç§æœ‰å˜é‡çš„å¯¹è±¡</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Counter</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ç§æœ‰å˜é‡</span>
    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// å…¬å…±æ–¹æ³•</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">increment</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
        count++;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å½“å‰è®¡æ•°ï¼š<span class="hljs-subst">${count}</span>`</span>);
    };
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">getCount</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> count;
    };
}

<span class="hljs-keyword">const</span> counter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Counter</span>();
counter.<span class="hljs-title function_">increment</span>(); <span class="hljs-comment">// å½“å‰è®¡æ•°ï¼š1</span>
counter.<span class="hljs-title function_">increment</span>(); <span class="hljs-comment">// å½“å‰è®¡æ•°ï¼š2</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(counter.<span class="hljs-property">count</span>); <span class="hljs-comment">// undefinedï¼ˆæ— æ³•ç›´æ¥è®¿é—®ç§æœ‰å˜é‡ï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(counter.<span class="hljs-title function_">getCount</span>()); <span class="hljs-comment">// 2ï¼ˆé€šè¿‡å…¬å…±æ–¹æ³•è®¿é—®ï¼‰</span>
</code></pre>
<h3 data-id="heading-14">åœºæ™¯2ï¼šå®ç°ç®€å•çš„ç»§æ‰¿</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// çˆ¶ç±»</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Vehicle</span>(<span class="hljs-params">type</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span> = type;
}

<span class="hljs-title class_">Vehicle</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">move</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.type}</span>æ­£åœ¨ç§»åŠ¨...`</span>);
};

<span class="hljs-comment">// å­ç±»</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Car</span>(<span class="hljs-params">brand</span>) {
    <span class="hljs-title class_">Vehicle</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-string">'æ±½è½¦'</span>); <span class="hljs-comment">// è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">brand</span> = brand;
}

<span class="hljs-comment">// è®¾ç½®åŸå‹é“¾</span>
<span class="hljs-title class_">Car</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Vehicle</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
<span class="hljs-title class_">Car</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Car</span>;

<span class="hljs-comment">// æ·»åŠ å­ç±»ç‰¹æœ‰æ–¹æ³•</span>
<span class="hljs-title class_">Car</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">honk</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.brand}</span>æ±½è½¦ï¼šæ»´æ»´ï¼`</span>);
};

<span class="hljs-keyword">const</span> myCar = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Car</span>(<span class="hljs-string">'å®é©¬'</span>);
myCar.<span class="hljs-title function_">move</span>(); <span class="hljs-comment">// æ±½è½¦æ­£åœ¨ç§»åŠ¨...</span>
myCar.<span class="hljs-title function_">honk</span>(); <span class="hljs-comment">// å®é©¬æ±½è½¦ï¼šæ»´æ»´ï¼</span>
</code></pre>
<h2 data-id="heading-15">å…­ã€é¢è¯•å¸¸è§é—®é¢˜ï¼ˆæ‚„æ‚„å‘Šè¯‰ä½ ç­”æ¡ˆï¼‰</h2>
<ol>
<li>
<p><strong>Q: newä¸€ä¸ªå‡½æ•°å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</strong>
A: å››éƒ¨æ›²ï¼šåˆ›å»ºç©ºå¯¹è±¡ â†’ è®¾ç½®åŸå‹é“¾ â†’ ç»‘å®šthisæ‰§è¡Œæ„é€ å‡½æ•° â†’ å¤„ç†è¿”å›å€¼</p>
</li>
<li>
<p><strong>Q: å¦‚æœæ„é€ å‡½æ•°è¿”å›ä¸€ä¸ªåŸºæœ¬ç±»å‹å‘¢ï¼Ÿ</strong>
A: ä¼šè¢«å¿½ç•¥ï¼Œä»ç„¶è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡</p>
</li>
<li>
<p><strong>Q: å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ç”±æŸä¸ªæ„é€ å‡½æ•°åˆ›å»ºï¼Ÿ</strong>
A: ä½¿ç”¨<code>instanceof</code>æ“ä½œç¬¦æˆ–æ£€æŸ¥<code>obj.constructor</code>å±æ€§</p>
</li>
</ol>
<h2 data-id="heading-16">ç»“è¯­ï¼šnewçš„çœŸæ­£é­”æ³•</h2>
<p>ç°åœ¨ä½ çŸ¥é“äº†ï¼Œ<code>new</code>å¹¶ä¸æ˜¯çœŸçš„é­”æ³•ï¼Œå®ƒåªæ˜¯JavaScriptæä¾›çš„ä¸€ç§è¯­æ³•ç³–ï¼Œå°è£…äº†å¯¹è±¡åˆ›å»ºã€åŸå‹è®¾ç½®å’Œæ„é€ å‡½æ•°è°ƒç”¨çš„è¿‡ç¨‹ã€‚</p>
<p>ä¸‹æ¬¡å½“ä½ ä½¿ç”¨<code>new</code>æ—¶ï¼Œä¸å¦¨åœ¨å¿ƒé‡Œé»˜å¿µè¿™å››éƒ¨æ›²ï¼Œä½ ä¼šå‘ç°è‡ªå·±å¯¹JavaScriptçš„ç†è§£åˆæ·±äº†ä¸€å±‚ã€‚è€Œä¸”ï¼Œå¦‚æœä½ æ„¿æ„ï¼Œå®Œå…¨å¯ä»¥ä¸ç”¨<code>new</code>ï¼Œè‡ªå·±æ‰‹åŠ¨å®ç°æ•´ä¸ªæµç¨‹â€”â€”åªæ˜¯é‚£æ ·ä»£ç ä¼šçœ‹èµ·æ¥æœ‰ç‚¹å•°å—¦ç½¢äº†ã€‚</p>
<p>è®°ä½ï¼Œç†è§£è¿™äº›åº•å±‚æœºåˆ¶ï¼Œä¸æ˜¯ä¸ºäº†è®©ä½ æ¯å¤©æ‰‹åŠ¨å®ç°<code>new</code>ï¼Œè€Œæ˜¯ä¸ºäº†åœ¨é‡åˆ°é—®é¢˜æ—¶ï¼ŒçŸ¥é“ä»å“ªé‡Œå¯»æ‰¾ç­”æ¡ˆã€‚</p>
<hr/>
<p><strong>å°å½©è›‹</strong>ï¼šä½ çŸ¥é“å—ï¼Ÿåœ¨JavaScriptæ—©æœŸï¼Œç”šè‡³æœ‰ä¸€ç§è®¾è®¡å»ºè®®å®Œå…¨å–æ¶ˆ<code>new</code>å…³é”®å­—ï¼Œå› ä¸ºå¼€å‘è€…ç»å¸¸å¿˜è®°ä½¿ç”¨å®ƒã€‚ä½†æœ€ç»ˆ<code>new</code>è¿˜æ˜¯ä¿ç•™äº†ä¸‹æ¥ï¼Œæˆä¸ºäº†JavaScriptçš„æ ‡å¿—æ€§ç‰¹æ€§ä¹‹ä¸€ã€‚æ‰€ä»¥ï¼Œä¸‹æ¬¡å½“ä½ å¿˜è®°å†™<code>new</code>æ—¶ï¼Œä¸è¦è‡ªè´£â€”â€”è¿è¯­è¨€è®¾è®¡è€…éƒ½è§‰å¾—è¿™æ˜¯ä¸ªé—®é¢˜å‘¢ï¼</p>
<p>ç°åœ¨ï¼Œå»åˆ›é€ ä½ çš„å¯¹è±¡å§ï¼Œå¹´è½»çš„JavaScripté­”æ³•å¸ˆï¼ğŸ©âœ¨</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§æ•°æ®-204 æ··æ·†çŸ©é˜µåˆ°ROCï¼šä¸å¹³è¡¡äºŒåˆ†ç±»è¯„ä¼°æŒ‡æ ‡å…¨æ¢³ç† sklearn]]></title>    <link>https://juejin.cn/post/7591799107486171146</link>    <guid>https://juejin.cn/post/7591799107486171146</guid>    <pubDate>2026-01-06T02:20:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591799107486171146" data-draft-id="7591799107486154762" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§æ•°æ®-204 æ··æ·†çŸ©é˜µåˆ°ROCï¼šä¸å¹³è¡¡äºŒåˆ†ç±»è¯„ä¼°æŒ‡æ ‡å…¨æ¢³ç† sklearn"/> <meta itemprop="keywords" content="åç«¯,å¤§æ•°æ®,æœºå™¨å­¦ä¹ "/> <meta itemprop="datePublished" content="2026-01-06T02:20:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ­¦å­åº·"/> <meta itemprop="url" content="https://juejin.cn/user/149189314230039"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§æ•°æ®-204 æ··æ·†çŸ©é˜µåˆ°ROCï¼šä¸å¹³è¡¡äºŒåˆ†ç±»è¯„ä¼°æŒ‡æ ‡å…¨æ¢³ç† sklearn
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/149189314230039/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ­¦å­åº·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T02:20:10.000Z" title="Tue Jan 06 2026 02:20:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">TL;DR</h2>
<ul>
<li>åœºæ™¯ï¼šç±»åˆ«ä¸å¹³è¡¡æ—¶ Accuracy å¤±çœŸï¼Œä¸šåŠ¡æ›´å…³å¿ƒâ€œå°‘æ•°ç±»æ•è·â€å’Œâ€œè¯¯ä¼¤æˆæœ¬â€ã€‚</li>
<li>ç»“è®ºï¼šç”¨æ··æ·†çŸ©é˜µç»Ÿä¸€å£å¾„ï¼Œå†ç”¨ Precision/Recall/F1 ä¸ ROC/AUC åšæƒè¡¡ä¸é˜ˆå€¼é€‰æ‹©ã€‚</li>
<li>äº§å‡ºï¼šTP/FP/FN/TN å®šä¹‰ä¸æŒ‡æ ‡æ˜ å°„ + sklearn æŒ‡æ ‡/ç»˜å›¾æ¥å£ç‰ˆæœ¬è¦ç‚¹ + å¸¸è§å‘é€ŸæŸ¥å¡ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b9d4e16393c34233af5bd512077e4a78~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768270810&amp;x-signature=1AlQ8XBWGepYP5FIiztY6U6urV0%3D" alt="å¤§æ•°æ®-204 æ··æ·†çŸ©é˜µåˆ°ROCï¼šä¸å¹³è¡¡äºŒåˆ†ç±»è¯„ä¼°æŒ‡æ ‡å…¨æ¢³ç† sklearn" loading="lazy"/></p>
<h2 data-id="heading-1">ç‰ˆæœ¬çŸ©é˜µ</h2>


















































<table><thead><tr><th>é¡¹/æ¥å£</th><th>å·²éªŒè¯</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>scikit-learn</td><td>âœ… 1.8.0</td><td>PyPI æ ‡æ³¨æœ€æ–°ç¨³å®šç‰ˆï¼Œå‘å¸ƒæ—¥æœŸ 2025-12-10ï¼›Requires: Python â‰¥3.11</td></tr><tr><td>Python</td><td>âœ… â‰¥3.11</td><td>sklearn 1.8.0 æ˜ç¡®è¦æ±‚ Python â‰¥3.11</td></tr><tr><td>NumPy</td><td>âœ… â‰¥1.24.1</td><td>sklearn 1.8.0 ä¾èµ–å£°æ˜</td></tr><tr><td>SciPy</td><td>âœ… â‰¥1.10.0</td><td>sklearn 1.8.0 ä¾èµ–å£°æ˜</td></tr><tr><td>sklearn.metrics.confusion_matrix</td><td>âœ… 1.8.0</td><td>æ–‡æ¡£normalize={'true','pred','all'}ï¼šæŒ‰çœŸå®/é¢„æµ‹/å…¨ä½“å½’ä¸€åŒ–</td></tr><tr><td>sklearn.metrics.ConfusionMatrixDisplay</td><td>âœ… 1.8.0</td><td>æ–‡æ¡£æ¨èç”¨ from_estimator/from_predictions ç”Ÿæˆå±•ç¤ºå¯¹è±¡</td></tr><tr><td>sklearn.metrics.roc_curve</td><td>âœ… 1.8.0</td><td>æ–‡æ¡£ç­¾åå« pos_labelï¼Œè¾“å…¥æ˜¯ y_scoreï¼ˆåˆ†æ•°/æ¦‚ç‡ï¼‰ï¼Œéç¦»æ•£æ ‡ç­¾</td></tr><tr><td>sklearn.metrics.RocCurveDisplay</td><td>âœ… 1.8.0</td><td>æ–‡æ¡£ä» estimator ç›´æ¥ç”Ÿæˆ ROC å±•ç¤º</td></tr></tbody></table>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ba7655f18ae4632b82c78a283c001bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768270810&amp;x-signature=0AaqgaoYgGhbgYYOboxXfDXDB6U%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-2">æ··æ·†çŸ©é˜µ</h2>
<p>ä»ä¸Šä¸€èŠ‚çš„ä¾‹å­ä¸­å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å¸Œæœ›å°½é‡æ•è·å°‘æ•°ç±»ï¼Œé‚£å‡†ç¡®ç‡è¿™ä¸ªæ¨¡å‹è¯„ä¼°é€æ¸å¤±æ•ˆï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ–°çš„æ¨¡å‹è¯„ä¼°æŒ‡æ ‡æ¥å¸®åŠ©æˆ‘ä»¬ã€‚å¦‚æœç®€å•æ¥çœ‹ï¼Œå…¶å®æˆ‘ä»¬åªéœ€è¦æŸ¥çœ‹æ¨¡å‹åœ¨å°‘æ•°ç±»ä¸Šçš„å‡†ç¡®ç‡å°±å¥½äº†ï¼Œåªè¦èƒ½å¤Ÿå°†å°‘æ•°ç±»å°½é‡æ•æ‰å‡ºæ¥ï¼Œå°±èƒ½å¤Ÿè¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ã€‚
ä½†æ­¤æ—¶ï¼Œæ–°é—®é¢˜åˆå‡ºç°äº†ï¼Œæˆ‘ä»¬å¯¹å¤šæ•°ç±»åˆ¤æ–­é”™è¯¯åï¼Œä¼šéœ€è¦äººå·¥ç”„åˆ«æˆ–è€…æ›´å¤šçš„ä¸šåŠ¡ä¸Šçš„æªæ–½æ¥ä¸€ä¸€æ’é™¤æˆ‘ä»¬åˆ¤æ–­é”™è¯¯çš„å¤šæ•°ç±»ï¼Œè¿™ç§è¡Œä¸ºå¾€å¾€ä¼´éšç€å¾ˆé«˜çš„æˆæœ¬ã€‚
æ¯”å¦‚é“¶è¡Œåœ¨åˆ¤æ–­ä¸€ä¸ªç”³è¯·ä¿¡ç”¨å¡çš„å®¢æˆ·æ˜¯å¦ä¼šè¿çº¦è¡Œä¸ºçš„æ—¶å€™ï¼Œå¦‚æœä¸€ä¸ªå®¢æˆ·è¢«åˆ¤æ–­ä¸ºä¼šè¿çº¦ï¼Œè¿™ä¸ªå®¢æˆ·çš„ä¿¡ç”¨å¡ç”³è¯·å°±ä¼šé©³å›ï¼Œå¦‚æœä¸ºäº†æ•æ‰ä¼šè¿çº¦çš„äººï¼Œå¤§é‡åœ°å°†ä¸ä¼šè¿çº¦çš„å®¢æˆ·åˆ¤æ–­ä¸ºä¼šè¿çº¦çš„å®¢æˆ·ï¼Œå°±ä¼šæœ‰è®¸å¤šæ— è¾œçš„å®¢æˆ·çš„ç”³è¯·è¢«é©³å›ã€‚
ä¹Ÿå°±æ˜¯è¯´ï¼Œå•çº¯çš„è¿½æ±‚æ•æ‰å°‘æ•°ç±»ï¼Œå°±ä¼šæˆæœ¬å¤ªé«˜ï¼Œè€Œä¸é¡¾åŠå°‘æ•°ç±»ï¼Œåˆä¼šæ— æ³•è¾¾æˆæ¨¡å‹çš„æ•ˆæœã€‚æ‰€ä»¥åœ¨ç°å®ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€åœ¨å¯»æ‰¾æ•è·å°‘æ•°ç±»çš„èƒ½åŠ›å’Œå°†å¤šæ•°åˆ¤é”™åéœ€è¦ä»˜å‡ºçš„æˆæœ¬çš„å¹³è¡¡ã€‚å¦‚æœä¸€ä¸ªæ¨¡å‹åœ¨èƒ½å¤Ÿå°½é‡æ•è·å°‘æ•°ç±»çš„æƒ…å†µä¸‹ï¼Œè¿˜èƒ½å¤Ÿå°½é‡å¯¹å¤šæ•°åˆ¤æ–­æ­£ç¡®ï¼Œåˆ™è¿™ä¸ªæ¨¡å‹å°±éå¸¸ä¼˜ç§€äº†ã€‚ä¸ºäº†è¯„ä¼°è¿™æ ·çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬å°†å¼•å…¥æ–°çš„æ¨¡å‹è¯„ä¼°æŒ‡æ ‡ï¼šæ··æ·†çŸ©é˜µå¯ä»¥å¸®åŠ©æˆ‘ä»¬ã€‚</p>
<ul>
<li>æ··æ·†çŸ©é˜µæ˜¯äºŒåˆ†ç±»é—®é¢˜çš„å¤šç»´è¡¡é‡æŒ‡æ ‡ä½“ç³»ï¼Œåœ¨æ ·æœ¬ä¸å¹³è¡¡æ—¶æå…¶æœ‰ç”¨</li>
<li>åœ¨æ··æ·†çŸ©é˜µä¸­ï¼Œæˆ‘ä»¬å°†å°‘æ•°ç±»è®¤ä¸ºæ—¶æ­£ä¾‹ï¼Œå¤šæ•°ç±»è®¤ä¸ºæ—¶è´Ÿä¾‹</li>
<li>åœ¨å†³ç­–æ ‘ï¼Œéšæœºæ£®æ—è¿™äº›ç®—æ³•é‡Œï¼Œå³æ˜¯è¯´å°‘æ•°ç±»æ˜¯1ï¼Œå¤šæ•°ç±»æ—¶ 0</li>
<li>åœ¨ SVM é‡Œï¼Œå°±æ˜¯è¯´å°‘æ•°ç±»æ—¶ 1ï¼Œå¤šæ•°ç±»æ—¶ -1</li>
</ul>
<p>æ™®é€šçš„æ··æ·†é‡Œï¼Œä¸€èˆ¬ä½¿ç”¨ã€Œ0ï¼Œ1ã€æ¥è¡¨ç¤ºï¼Œæ··æ·†çŸ©é˜µå¦‚å…¶åï¼Œååˆ†å®¹æ˜“è®©äººæ··æ·†ï¼Œåœ¨éœ€è¦æ•™æä¸­å„ç§å„æ ·çš„åç§°å’Œå®šä¹‰è®©å¤§å®¶éš¾ä»¥ç†è§£å’Œè®°å¿†ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b09f0a77c544daa92904d08f390033b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768270810&amp;x-signature=0UCqdg8h%2BieXoo4E8JFQVwC0zFM%3D" alt="æ··æ·†çŸ©é˜µ" loading="lazy"/></p>
<p>å…¶ä¸­:</p>
<ul>
<li>è¡Œä»£è¡¨é¢„æµ‹æƒ…å†µï¼Œåˆ—åˆ™è¡¨ç¤ºå®é™…æƒ…å†µ</li>
<li>é¢„æµ‹å€¼æ˜¯ 1ï¼Œè®°ä¸º Pï¼ˆPositiveï¼‰</li>
<li>é¢„æµ‹å€¼æ˜¯ 0ï¼Œè®°ä¸º Nï¼ˆNegativeï¼‰</li>
<li>é¢„æµ‹å€¼ä¸çœŸå®å€¼ç›¸åŒï¼Œè®°ä¸º Tï¼ˆTrueï¼‰</li>
<li>é¢„æµ‹å€¼ä¸çœŸå®å€¼ç›¸åï¼Œè®°ä¸º Fï¼ˆFalseï¼‰</li>
</ul>
<p>å› æ­¤çŸ©é˜µä¸­å››ä¸ªå…ƒç´ åˆ†åˆ«è¡¨ç¤ºï¼š</p>
<ul>
<li>TPï¼ˆTrue Positiveï¼‰çœŸå®ä¸º 1ï¼Œé¢„æµ‹ä¸º 1</li>
<li>FNï¼ˆFalse Negativeï¼‰çœŸå®ä¸º 1ï¼Œé¢„æµ‹ä¸º 0</li>
<li>FPï¼ˆFalse Positiveï¼‰çœŸå®ä¸º 0ï¼Œé¢„æµ‹ä¸º 1</li>
<li>TNï¼ˆTrue Negativeï¼‰çœŸå®ä¸º 0ï¼Œé¢„æµ‹ä¸º 0</li>
</ul>
<p>åŸºäºæ··æ·†çŸ©é˜µï¼Œæˆ‘ä»¬æœ‰ä¸€ç³»åˆ—ä¸åŒçš„æ¨¡å‹è¯„ä¼°æŒ‡æ ‡ï¼Œè¿™äº›è¯„ä¼°æŒ‡æ ‡èŒƒå›´éƒ½åœ¨ã€0ï¼Œ1ã€‘ä¹‹é—´ï¼Œæ‰€ä»¥æœ‰11 å’Œ 00ä¸ºåˆ†å­çš„æŒ‡æ ‡éƒ½æ˜¯è¶Šæ¥è¶Šæ¥è¿‘ 1 è¶Šå¥½ï¼Œæ‰€ä»¥ 01 å’Œ 10 ä¸ºåˆ†å­çš„æŒ‡æ ‡éƒ½æ˜¯è¶Šæ¥è¶Šæ¥è¿‘ 0 è¶Šå¥½ã€‚
å¯¹äºæ‰€æœ‰æŒ‡æ ‡ï¼Œæˆ‘ä»¬ç”¨æ©™è‰²è¡¨ç¤ºåˆ†æ¯ï¼Œç”¨ç»¿è‰²è¡¨ç¤ºåˆ†å­ï¼Œåˆ™æˆ‘ä»¬æœ‰ï¼š</p>
<h3 data-id="heading-3">å‡†ç¡®ç‡ Accuracy</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e41e503f1274fbb9b2088e500a270e2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768270810&amp;x-signature=aSmJvD0ofSWcO11680ZJisR70m8%3D" alt="å‡†ç¡®ç‡ Accuracy" loading="lazy"/></p>
<h3 data-id="heading-4">ç²¾ç¡®åº¦ Precision</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/29386a1884774279bdb2cd1e11066c08~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768270810&amp;x-signature=AgsBBw4S4KSuz0h1CrXdy%2Be55mE%3D" alt="ç²¾ç¡®åº¦ Precision" loading="lazy"/>
ç²¾ç¡®åº¦ Precisionï¼Œåˆå«æŸ¥å‡†ç‡ï¼Œè¡¨ç¤ºåœ¨æ‰€æœ‰é¢„æµ‹ç»“æœä¸º 1 çš„æ ·ä¾‹æ•°ä¸­ï¼Œå®é™…ä¸º 1 çš„æ ·ä¾‹æ•°æ‰€å æ¯”é‡ã€‚ç²¾ç¡®åº¦è¶Šä½ï¼Œæ„å‘³ç€ 01 æ¯”é‡å¾ˆå¤§ï¼Œåˆ™ä»£è¡¨ä½ çš„æ¨¡å‹å¯¹å¤šæ•°ç±» 0 è¯¯åˆ¤ç‡è¶Šé«˜ï¼Œè¯¯ä¼¤äº†è¿‡å¤šçš„å¤šæ•°ç±»ã€‚ä¸ºäº†é¿å…å¯¹å¤šæ•°ç±»çš„è¯¯ä¼¤ï¼Œéœ€è¦è¿½æ±‚é«˜ç²¾ç¡®åº¦ã€‚
ç²¾ç¡®åº¦æ˜¯å°†å¤šæ•°ç±»åˆ¤é”™åæ‰€éœ€è¦ä»˜å‡ºæˆæœ¬çš„è¡¡é‡</p>
<h3 data-id="heading-5">å¬å›ç‡ Recall</h3>
<p>å¬å›ç‡ Recallï¼Œåˆç§°ä¸ºæ•æ„Ÿåº¦ï¼ˆsensitivityï¼‰ï¼ŒçœŸæ­£ç‡ï¼ŒæŸ¥å…¨ç‡ï¼Œè¡¨ç¤ºæ‰€æœ‰çœŸå®ä¸º 1 çš„æ ·æœ¬ä¸­ï¼Œè¢«æˆ‘ä»¬é¢„æµ‹æ­£ç¡®çš„æ ·æœ¬æ‰€å çš„æ¯”ä¾‹ã€‚
å¬å›ç‡è¶Šé«˜ï¼Œä»£è¡¨æˆ‘ä»¬å°½é‡æ•æ‰å‡ºäº†è¶Šå¤šçš„å°‘æ•°ç±»ã€‚å¬å›ç‡è¶Šä½ï¼Œä»£è¡¨æˆ‘ä»¬æ•æ‰å‡ºè¶³å¤Ÿçš„å°‘æ•°ç±»ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1afea7f61ce8411db448f678b5f9fb99~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768270810&amp;x-signature=IculmEEpNfkt5BllO9NTdSAR8Gw%3D" alt="å¬å›ç‡ Recall" loading="lazy"/>
æˆ‘ä»¬å¸Œæœ›ä¸è®¡ä»£ä»·ï¼Œæ‰¾å‡ºå°‘æ•°ç±»ï¼ˆæ¯”å¦‚æ½œé€ƒçš„çŠ¯ç½ªåˆ†å­ï¼‰ï¼Œé‚£æˆ‘ä»¬ä¼šè¿½æ±‚é«˜å¬å›ç‡ï¼Œç›¸åå¦‚æœæˆ‘ä»¬çš„ç›®æ ‡ä¸æ˜¯å°½é‡æ•è·å°‘æ•°ç±»ï¼Œé‚£æˆ‘ä»¬å°±ä¸éœ€è¦åœ¨æ„å¬å›ç‡ã€‚
æ³¨æ„å¬å›ç‡å’Œç²¾ç¡®åº¦çš„åˆ†å­æ˜¯ç›¸åŒçš„ï¼ˆéƒ½æ˜¯ 11ï¼‰ï¼Œåªæ˜¯åˆ†æ¯ä¸åŒã€‚
è€Œå¬å›ç‡å’Œç²¾ç¡®åº¦æ˜¯æ­¤æ¶ˆå½¼é•¿çš„ï¼Œä¸¤è€…ä¹‹é—´çš„å¹³è¡¡ä»£è¡¨äº†æ•æ‰å°‘æ•°ç±»çš„éœ€æ±‚å’Œå°½é‡ä¸è¦è¯¯ä¼¤å¤šæ•°ç±»çš„éœ€è¦æ±‚çš„å¹³è¡¡ã€‚
ç©¶ç«Ÿè¦åå‘å“ªä¸€æ–¹ï¼Œå–å†³äºæˆ‘ä»¬çš„ä¸šåŠ¡éœ€æ±‚ï¼šç©¶ç«Ÿæ˜¯è¯¯ä¼¤å¤šæ•°ç±»çš„æˆæœ¬æ›´é«˜ï¼Œè¿˜æ˜¯æ— æ³•æ•æ‰å°‘æ•°ç±»çš„ä»£è¡¨æ›´é«˜ã€‚</p>
<h3 data-id="heading-6">F1 Measure</h3>
<p>ä¸ºäº†åŒæ—¶å…¼é¡¾ç²¾ç¡®åº¦å’Œå¬å›ç‡ï¼Œæˆ‘ä»¬åˆ›é€ äº†ä¸¤è€…çš„è°ƒå’Œå¹³å‡æ•°ä½œä¸ºè€ƒé‡ä¸¤è€…å¹³è¡¡çš„ç»¼åˆæ€§æŒ‡æ ‡ï¼Œç§°ä¹‹ä¸ºF1 Measureã€‚
ä¸¤ä¸ªæ•°ä¹‹é—´çš„è°ƒå’Œå¹³å‡å€¾å‘äºé è¿‘ä¸¤ä¸ªæ•°ä¸­æ¯”è¾ƒå°çš„é‚£ä¸€ä¸ªæ•°ï¼Œå› æ­¤æˆ‘ä»¬è¿½æ±‚å°½é‡é«˜çš„F1 Measureï¼Œèƒ½å¤Ÿä¿è¯æˆ‘ä»¬ç²¾ç¡®åº¦å’Œå¬å›ç‡éƒ½æ¯”è¾ƒé«˜ã€‚
F1 Measure åœ¨ [0,1]ä¹‹é—´åˆ†å¸ƒï¼Œè¶Šæ¥è¿‘ 1 è¶Šå¥½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b64dfa85f5a041368d43cdb82eb92974~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768270810&amp;x-signature=KtAcDXUP58U3Imo5%2F7MeQCrgjGA%3D" alt="F1 Measure" loading="lazy"/></p>
<h3 data-id="heading-7">å‡è´Ÿç‡</h3>
<p>ä» Recall å»¶ä¼¸å‡ºæ¥çš„å¦ä¸€ä¸ªè¯„ä¼°æŒ‡æ ‡å«åšå‡è´Ÿç‡ï¼ˆFalse Negative Rateï¼‰ï¼Œå®ƒç­‰äº 1 - Recallï¼Œç”¨äºè¡¡é‡ã€‚
æ‰€æœ‰çœŸå®ä¸º 1 çš„æ ·æœ¬ä¸­ï¼Œè¢«æˆ‘ä»¬é”™è¯¯åˆ¤æ–­ä¸º 0 çš„ï¼Œé€šå¸¸ç”¨çš„ä¸å¤šã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aec03038738343b99de200c9bfbb10bf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768270810&amp;x-signature=62xoFRSi73sV85xkwFapAHlRti4%3D" alt="å‡è´Ÿç‡" loading="lazy"/></p>
<h3 data-id="heading-8">ROC æ›²çº¿</h3>
<p>ROC çš„å…¨ç§°æ˜¯ï¼šReceiver Operating characteristic Curveï¼Œå…¶ä¸»è¦çš„åˆ†ææ–¹æ³•å°±æ˜¯ç”»è¿™æ¡ç‰¹å¾æ›²çº¿ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eddd6b7696f34945be14b04b18454568~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768270810&amp;x-signature=PdRdpc8m9mRZrP%2FanHAM2EkuJhI%3D" alt="ROC æ›²çº¿" loading="lazy"/></p>
<p>è¯¥æ›²çº¿çš„æ¨ªåæ ‡ä¸ºå‡æ­£ç‡ï¼ˆFalse Positive Rateï¼ŒFPRï¼‰ï¼ŒN æ˜¯çœŸå®è´Ÿæ ·æœ¬çš„ä¸ªæ•°ï¼ŒFP æ˜¯N ä¸ªè´Ÿæ ·æœ¬ä¸­è¢«åˆ†ç±»å™¨é¢„æµ‹ä¸ºæ­£æ ·æœ¬çš„ä¸ªæ•°ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bb9b7f8244c8466b93b3c9d8022e3352~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768270810&amp;x-signature=hvbRCr930uQStuOpY9TrOPPBMPY%3D" alt="ROC æ›²çº¿" loading="lazy"/>
çºµåæ ‡ä¸ºå¬å›ç‡ï¼ŒçœŸæ­£ç‡ï¼ˆTrue Positive Rateï¼ŒTPRï¼‰ï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa057827510a4f1c89b63c5fbd78f5a4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768270810&amp;x-signature=aJcdS5CAM6L%2BXRWkoG3eSZPiNjY%3D" alt="çœŸæ­£ç‡ï¼ˆTrue Positive Rateï¼ŒTPRï¼‰" loading="lazy"/>
P æ˜¯çœŸå®æ­£æ ·æœ¬çš„ä¸ªæ•°ï¼ŒTP æ˜¯ P ä¸ªæ­£æ ·æœ¬è¢«åˆ†ç±»å™¨é¢„æµ‹ä¸ºæ­£æ ·æœ¬çš„ä¸ªæ•°ã€‚</p>
<h3 data-id="heading-9">sklearn ä¸­çš„æ··æ·†çŸ©é˜µ</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af3301732c3f486b80f70f65dcf1c8c3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768270810&amp;x-signature=0vXSH%2BBFohjR9OvPr4hbRH4fI9w%3D" alt="sklearn ä¸­çš„æ··æ·†çŸ©é˜µ" loading="lazy"/></p>
<h2 data-id="heading-10">å†³ç­–æ ‘çš„ç®—æ³•è¯„ä»·</h2>
<h3 data-id="heading-11">å†³ç­–æ ‘ä¼˜ç‚¹è¯¦è§£</h3>
<ol>
<li>
<p><strong>æ˜“äºç†è§£å’Œè§£é‡Š</strong></p>
<ul>
<li>å†³ç­–æ ‘é‡‡ç”¨æ ‘å½¢ç»“æ„å±•ç¤ºå†³ç­–è¿‡ç¨‹ï¼Œå¯è§†åŒ–ç¨‹åº¦é«˜ï¼Œéä¸“ä¸šäººå£«ä¹Ÿèƒ½ç†è§£</li>
<li>æ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªç‰¹å¾åˆ¤æ–­ï¼Œåˆ†æ”¯ä»£è¡¨åˆ¤æ–­ç»“æœï¼Œå¶å­èŠ‚ç‚¹ä»£è¡¨æœ€ç»ˆå†³ç­–</li>
<li>ç¤ºä¾‹ï¼šåœ¨é“¶è¡Œè´·æ¬¾å®¡æ‰¹åœºæ™¯ä¸­ï¼Œå¯ä»¥ç›´è§‚çœ‹åˆ°"æ”¶å…¥&gt;5ä¸‡â†’ä¿¡ç”¨è‰¯å¥½â†’æ‰¹å‡†"è¿™æ ·çš„å†³ç­–è·¯å¾„</li>
</ul>
</li>
<li>
<p><strong>æ•°æ®é¢„å¤„ç†è¦æ±‚ä½</strong></p>
<ul>
<li>ä¸éœ€è¦ç‰¹å¾ç¼©æ”¾æˆ–æ ‡å‡†åŒ–ï¼ˆå¦‚å†³ç­–æ ‘å¯¹ç‰¹å¾çš„æ•°å€¼èŒƒå›´ä¸æ•æ„Ÿï¼‰</li>
<li>èƒ½ç›´æ¥å¤„ç†ç±»åˆ«å‹ç‰¹å¾ï¼Œæ— éœ€one-hotç¼–ç ï¼ˆä½†sklearnå®ç°éœ€è¦ï¼‰</li>
<li>æ³¨æ„ï¼šä¸»æµå®ç°ï¼ˆå¦‚sklearnï¼‰ç¡®å®ä¸æ”¯æŒç¼ºå¤±å€¼è‡ªåŠ¨å¤„ç†ï¼Œéœ€æå‰å¡«å……</li>
</ul>
</li>
<li>
<p><strong>é¢„æµ‹æ•ˆç‡é«˜</strong></p>
<ul>
<li>é¢„æµ‹æ—¶é—´å¤æ‚åº¦ä¸ºO(log n)ï¼Œnæ˜¯è®­ç»ƒæ ·æœ¬æ•°</li>
<li>å¯¹æ¯”ï¼šKNNé¢„æµ‹éœ€è¦O(n)ï¼ŒSVMéœ€è¦O(n_sv)æ”¯æŒå‘é‡æ•°é‡</li>
<li>é€‚åˆå®æ—¶é¢„æµ‹åœºæ™¯ï¼Œå¦‚é‡‘èé£æ§ç³»ç»Ÿéœ€è¦æ¯«ç§’çº§å“åº”</li>
</ul>
</li>
<li>
<p><strong>å¤šç±»å‹æ•°æ®å¤„ç†èƒ½åŠ›</strong></p>
<ul>
<li>å¯æ··åˆå¤„ç†æ•°å€¼ç‰¹å¾ï¼ˆå¦‚å¹´é¾„ã€æ”¶å…¥ï¼‰å’Œç±»åˆ«ç‰¹å¾ï¼ˆå¦‚æ€§åˆ«ã€èŒä¸šï¼‰</li>
<li>æ—¢å¯ç”¨äºåˆ†ç±»ï¼ˆé¢„æµ‹ç±»åˆ«æ ‡ç­¾ï¼‰ä¹Ÿå¯ç”¨äºå›å½’ï¼ˆé¢„æµ‹è¿ç»­å€¼ï¼‰</li>
<li>åº”ç”¨åœºæ™¯ç¤ºä¾‹ï¼šæˆ¿ä»·é¢„æµ‹ï¼ˆå›å½’ï¼‰å’Œå®¢æˆ·æµå¤±é¢„æµ‹ï¼ˆåˆ†ç±»ï¼‰å¯ä½¿ç”¨ç›¸åŒç®—æ³•</li>
</ul>
</li>
<li>
<p><strong>æ¨¡å‹é²æ£’æ€§</strong></p>
<ul>
<li>å¯¹æ•°æ®åˆ†å¸ƒå‡è®¾è¾ƒå°‘ï¼Œå³ä½¿ç‰¹å¾é—´å­˜åœ¨éçº¿æ€§å…³ç³»ä¹Ÿèƒ½è¾ƒå¥½å¤„ç†</li>
<li>å¯¹å¼‚å¸¸å€¼ç›¸å¯¹ä¸æ•æ„Ÿï¼Œå› ä¸ºåˆ†è£‚ä¾æ®æ˜¯ç‰¹å¾æ’åºè€Œéç»å¯¹å€¼</li>
</ul>
</li>
</ol>
<h3 data-id="heading-12">å†³ç­–æ ‘ç¼ºç‚¹è¯¦è§£</h3>
<ol>
<li>
<p><strong>è¿‡æ‹Ÿåˆé£é™©</strong></p>
<ul>
<li>å®¹æ˜“ç”Ÿé•¿å‡ºè¿‡äºå¤æ‚çš„æ ‘ï¼Œå®Œç¾æ‹Ÿåˆè®­ç»ƒæ•°æ®ä½†æ³›åŒ–èƒ½åŠ›å·®</li>
<li>è§£å†³æ–¹æ¡ˆï¼š
<ul>
<li>é¢„å‰ªæï¼šè®¾ç½®max_depthï¼ˆæœ€å¤§æ·±åº¦ï¼‰ã€min_samples_leafï¼ˆå¶èŠ‚ç‚¹æœ€å°æ ·æœ¬æ•°ï¼‰</li>
<li>åå‰ªæï¼šè®­ç»ƒå®Œæ•´æ ‘åå‰ªé™¤ä¸é‡è¦çš„åˆ†æ”¯</li>
<li>ç¤ºä¾‹ï¼šé™åˆ¶max_depth=5é€šå¸¸èƒ½å¹³è¡¡æ¨¡å‹å¤æ‚åº¦ä¸æ€§èƒ½</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>æ¨¡å‹ä¸ç¨³å®šæ€§</strong></p>
<ul>
<li>è®­ç»ƒæ•°æ®å¾®å°å˜åŒ–å¯èƒ½å¯¼è‡´å®Œå…¨ä¸åŒçš„æ ‘ç»“æ„</li>
<li>æ ¹æœ¬åŸå› ï¼šè´ªå©ªç®—æ³•çš„å±€éƒ¨æœ€ä¼˜ç‰¹æ€§</li>
<li>æ”¹è¿›æ–¹æ³•ï¼š
<ul>
<li>ä½¿ç”¨é›†æˆå­¦ä¹ ï¼ˆå¦‚éšæœºæ£®æ—ï¼‰é€šè¿‡å¤šæ£µæ ‘æŠ•ç¥¨é™ä½æ–¹å·®</li>
<li>éšæœºæ£®æ—ä¸­è®¾ç½®max_featureså‚æ•°æ§åˆ¶ç‰¹å¾é‡‡æ ·éšæœºæ€§</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>å±€éƒ¨æœ€ä¼˜é—®é¢˜</strong></p>
<ul>
<li>æ¯æ¬¡åˆ†è£‚åªè€ƒè™‘å½“å‰èŠ‚ç‚¹çš„æœ€ä¼˜è§£ï¼Œä¸èƒ½å›æº¯è°ƒæ•´ä¹‹å‰çš„åˆ†è£‚</li>
<li>å¯èƒ½å¯¼è‡´æ¬¡ä¼˜å…¨å±€æ¨¡å‹</li>
<li>è§£å†³æ–¹æ¡ˆï¼š
<ul>
<li>é›†æˆæ–¹æ³•ï¼šé€šè¿‡Baggingæˆ–Boostingç»„åˆå¤šä¸ªå¼±å­¦ä¹ å™¨</li>
<li>ç‰¹å¾å·¥ç¨‹ï¼šäººå·¥æ„é€ æ›´æœ‰åˆ¤åˆ«åŠ›çš„ç‰¹å¾</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>ç±»åˆ«ä¸å¹³è¡¡æ•æ„Ÿ</strong></p>
<ul>
<li>å½“æŸä¸€ç±»åˆ«æ ·æœ¬å æ¯”è¿‡å¤§æ—¶ï¼Œæ¨¡å‹ä¼šåå‘è¯¥ç±»åˆ«</li>
<li>è§£å†³æ–¹æ³•ï¼š
<ul>
<li>ä¸Šé‡‡æ ·å°‘æ•°ç±»æˆ–ä¸‹é‡‡æ ·å¤šæ•°ç±»</li>
<li>ä½¿ç”¨ç±»åˆ«æƒé‡å‚æ•°ï¼ˆå¦‚class_weight='balanced'ï¼‰</li>
<li>é‡‡ç”¨AUCç­‰å¯¹ç±»åˆ«ä¸å¹³è¡¡ä¸æ•æ„Ÿçš„è¯„ä»·æŒ‡æ ‡</li>
</ul>
</li>
<li>ç¤ºä¾‹ï¼šåœ¨æ¬ºè¯ˆæ£€æµ‹ä¸­ï¼Œæ­£å¸¸äº¤æ˜“å æ¯”99%æ—¶éœ€ç‰¹åˆ«å¤„ç†ä¸å¹³è¡¡é—®é¢˜</li>
</ul>
</li>
</ol>
<h2 data-id="heading-13">é”™è¯¯é€ŸæŸ¥</h2>








































<table><thead><tr><th>ç—‡çŠ¶</th><th>æ ¹å› å®šä½</th><th>ä¿®å¤</th></tr></thead><tbody><tr><td>æ··æ·†çŸ©é˜µâ€œè¡Œåˆ—å«ä¹‰â€å¯¹ä¸ä¸Šï¼ˆçœ‹èµ·æ¥ TP/FP è¢«äº¤æ¢ï¼‰</td><td>æŠŠè½´å«ä¹‰è®°åï¼ˆçœŸå®/é¢„æµ‹æ”¾åï¼‰æˆ–ç”»å›¾å·¥å…·é»˜è®¤é¡ºåºè¯¯è¯»</td><td>ç”¨ 3~5 æ¡æ‰‹å·¥æ ·ä¾‹ç®—ä¸€æ¬¡ TP/FP/FN/TNï¼Œå¯¹ç…§çŸ©é˜µå››æ ¼æ˜ç¡® confusion_matrix(y_true, y_pred) è¯­ä¹‰ï¼›å±•ç¤ºæ—¶ç»Ÿä¸€æ ‡æ³¨â€œçœŸå®/é¢„æµ‹â€ï¼›å¿…è¦æ—¶è½¬ç½®ä½†è¦åŒæ­¥æ”¹å£å¾„</td></tr><tr><td>Precision/Recall æ•°å€¼å¼‚å¸¸ï¼ˆPrecision å¾ˆä½æˆ– Recall å¾ˆä½ä¸”ä¸ç¬¦åˆç›´è§‰ï¼‰</td><td>æ­£ä¾‹æ ‡ç­¾ pos_label ä¸ä¸€è‡´ï¼ˆ0/1 vs -1/1 vs å­—ç¬¦ä¸²ï¼‰ï¼›labels æ’åºä¸ä¸šåŠ¡æ­£ä¾‹ä¸ä¸€è‡´</td><td>æ‰“å° np.unique(y_true) ä¸ np.unique(y_pred)ï¼›æ£€æŸ¥â€œå°‘æ•°ç±»æ˜¯å¦çœŸè¢«å½“ä½œæ­£ç±»â€åœ¨ ROC/äºŒåˆ†ç±»æŒ‡æ ‡é‡Œæ˜¾å¼è®¾ pos_labelï¼›åœ¨æ··æ·†çŸ©é˜µé‡Œæ˜¾å¼è®¾ labels=[neg,pos] ä¿æŒä¸šåŠ¡é¡ºåº</td></tr><tr><td>ROC æ›²çº¿â€œåƒä¸€æ¡ç›´çº¿/ç‚¹å¾ˆå°‘/ä¸é¢„æœŸç›¸åâ€</td><td>æŠŠ y_predï¼ˆ0/1æ ‡ç­¾ï¼‰å½“æˆ y_scoreï¼›æˆ–åˆ†æ•°æ–¹å‘åäº†ï¼ˆæ­£ä¾‹åˆ†æ•°æ›´å°ï¼‰</td><td>æ£€æŸ¥ä¼ å…¥ roc_curve çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯å¦åªæœ‰ {0,1}ï¼›æ£€æŸ¥æ­£ä¾‹çš„åˆ†æ•°å‡å€¼æ˜¯å¦æ›´é«˜ä¼  predict_proba[:,1] æˆ– decision_functionï¼›å¿…è¦æ—¶å–ååˆ†æ•°æˆ–ä¿®æ­£æ­£ä¾‹å®šä¹‰ï¼ˆpos_labelï¼‰</td></tr><tr><td>å½’ä¸€åŒ–åçš„æ··æ·†çŸ©é˜µâ€œç™¾åˆ†æ¯”ä¸å¯¹â€ï¼ˆæ¯è¡Œä¸å’Œä¸º1æˆ–æ¯åˆ—ä¸å’Œä¸º1ï¼‰</td><td>è¯¯è§£ normalize='true'/'pred'/'all' çš„åˆ†æ¯</td><td>è§‚å¯Ÿå½’ä¸€åŒ–åæ˜¯â€œè¡Œå’Œ=1â€è¿˜æ˜¯â€œåˆ—å’Œ=1â€éœ€è¦â€œå¬å›è§†è§’â€ç”¨ normalize='true'ï¼›éœ€è¦â€œç²¾ç¡®è§†è§’â€ç”¨ normalize='pred'ï¼›å…¨ä½“å æ¯”ç”¨ normalize='all'</td></tr><tr><td>Accuracy å¾ˆé«˜ä½†ä¸šåŠ¡æ•ˆæœå·®ï¼ˆæ¼æ‰å…³é”®å°‘æ•°ç±»ï¼‰</td><td>ç±»åˆ«ä¸å¹³è¡¡å¯¼è‡´å¤šæ•°ç±»ä¸»å¯¼ï¼›é˜ˆå€¼é»˜è®¤ 0.5 ä¸åŒ¹é…æˆæœ¬å‡½æ•°</td><td>çœ‹æ··æ·†çŸ©é˜µä¸­ FN æ˜¯å¦åå¤§ï¼›çœ‹ Recall/TPR æ˜¯å¦åä½ä»¥ Precision/Recall/F1 æˆ– ROC/AUC ä¸ºä¸»ï¼›æŒ‰ä¸šåŠ¡æˆæœ¬è°ƒé˜ˆå€¼ï¼Œå¹¶åœ¨è¯„ä¼°æŠ¥å‘Šé‡Œå›ºå®šâ€œæ­£ä¾‹å®šä¹‰+é˜ˆå€¼â€</td></tr><tr><td>â€œæ•è·å°‘æ•°ç±»â€æå‡åï¼Œè¯¯ä¼¤å¤šæ•°ç±»æ¿€å¢ï¼ˆå®¡æ ¸/æ‹’ç»é‡çˆ†ç‚¸ï¼‰</td><td>å•ç‚¹è¿½æ±‚ Recallï¼Œå¿½ç•¥ FP æˆæœ¬</td><td>çœ‹ FP ä¸ Precision çš„å˜åŒ–è¶‹åŠ¿ä»¥ Precision ä½œä¸ºæˆæœ¬çº¦æŸï¼Œåšé˜ˆå€¼æ‰«æ/PR æƒè¡¡ï¼›åœ¨ä¸Šçº¿æŒ‡æ ‡ä¸­åŒæ—¶é”å®š Precision ä¸‹é™ä¸ Recall ä¸‹é™</td></tr></tbody></table>
<h2 data-id="heading-14">å…¶ä»–ç³»åˆ—</h2>
<h3 data-id="heading-15">ğŸš€ AIç¯‡æŒç»­æ›´æ–°ä¸­ï¼ˆé•¿æœŸæ›´æ–°ï¼‰</h3>
<p><strong>AIç‚¼ä¸¹æ—¥å¿—-29 - å­—èŠ‚è·³åŠ¨ DeerFlow æ·±åº¦ç ”ç©¶æ¡†<em>æ–œä½“æ ·å¼</em>æ¶ ç§æœ‰éƒ¨ç½² æµ‹è¯•ä¸Šæ‰‹ æ¶æ„ç ”ç©¶</strong>ï¼ŒæŒç»­æ‰“é€ å®ç”¨AIå·¥å…·æŒ‡å—ï¼
<strong>AIç ”ç©¶-132 Java ç”Ÿæ€å‰æ²¿ 2025ï¼šSpringã€Quarkusã€GraalVMã€CRaC ä¸äº‘åŸç”Ÿè½åœ°</strong></p>
<h3 data-id="heading-16">ğŸ’» Javaç¯‡æŒç»­æ›´æ–°ä¸­ï¼ˆé•¿æœŸæ›´æ–°ï¼‰</h3>
<p><strong>Java-218 RocketMQ Java API å®æˆ˜ï¼šåŒæ­¥/å¼‚æ­¥ Producer ä¸ Pull/Push Consumer</strong>
MyBatis å·²å®Œç»“ï¼ŒSpring å·²å®Œç»“ï¼ŒNginxå·²å®Œç»“ï¼ŒTomcatå·²å®Œç»“ï¼Œåˆ†å¸ƒå¼æœåŠ¡å·²å®Œç»“ï¼ŒDubboå·²å®Œç»“ï¼ŒMySQLå·²å®Œç»“ï¼ŒMongoDBå·²å®Œç»“ï¼ŒNeo4jå·²å®Œç»“ï¼ŒFastDFS å·²å®Œç»“ï¼ŒOSSå·²å®Œç»“ï¼ŒGuavaCacheå·²å®Œç»“ï¼ŒEVCacheå·²å®Œç»“ï¼ŒRabbitMQå·²å®Œç»“ï¼ŒRocketMQæ­£åœ¨æ›´æ–°... æ·±å…¥æµ…å‡ºåŠ©ä½ æ‰“ç‰¢åŸºç¡€ï¼</p>
<h3 data-id="heading-17">ğŸ“Š å¤§æ•°æ®æ¿å—å·²å®Œæˆå¤šé¡¹å¹²è´§æ›´æ–°ï¼ˆ300ç¯‡ï¼‰ï¼š</h3>
<p>åŒ…æ‹¬ Hadoopã€Hiveã€Kafkaã€Flinkã€ClickHouseã€Elasticsearch ç­‰äºŒåä½™é¡¹æ ¸å¿ƒç»„ä»¶ï¼Œè¦†ç›–ç¦»çº¿+å®æ—¶æ•°ä»“å…¨æ ˆï¼
<strong>å¤§æ•°æ®-278 Spark MLib - åŸºç¡€ä»‹ç» æœºå™¨å­¦ä¹ ç®—æ³• æ¢¯åº¦æå‡æ ‘ GBDTæ¡ˆä¾‹ è¯¦è§£</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤šæ™ºèƒ½ä½“åä½œæ¡ˆä¾‹å®è·µï¼ˆä¸€ï¼‰ï¼šåŸºäºAgentScopeæ¡†æ¶]]></title>    <link>https://juejin.cn/post/7591730714140540970</link>    <guid>https://juejin.cn/post/7591730714140540970</guid>    <pubDate>2026-01-06T01:06:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591730714140540970" data-draft-id="7591506455973625910" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤šæ™ºèƒ½ä½“åä½œæ¡ˆä¾‹å®è·µï¼ˆä¸€ï¼‰ï¼šåŸºäºAgentScopeæ¡†æ¶"/> <meta itemprop="keywords" content="åç«¯,Python,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-06T01:06:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æœ¨æ˜†å­"/> <meta itemprop="url" content="https://juejin.cn/user/825103640698564"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤šæ™ºèƒ½ä½“åä½œæ¡ˆä¾‹å®è·µï¼ˆä¸€ï¼‰ï¼šåŸºäºAgentScopeæ¡†æ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/825103640698564/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æœ¨æ˜†å­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T01:06:31.000Z" title="Tue Jan 06 2026 01:06:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    26
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ä¹‹å‰<a href="https://juejin.cn/post/7591510742648602667" target="_blank" title="https://juejin.cn/post/7591510742648602667">ã€Šå‡ ç§AI Agentå¼€å‘æ¡†æ¶å¯¹æ¯”ã€‹</a>è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªé«˜è€ƒä¿¡æ¯æŸ¥è¯¢æ™ºèƒ½åŠ©æ‰‹ä¸šåŠ¡åœºæ™¯ï¼Œä½¿ç”¨å‡ ç§AI Agentå¼€å‘æ¡†æ¶åˆ†åˆ«å®ç°è¿›è¡Œå¯¹æ¯”åˆ†æï¼Œå› ä¸ºæ–‡æ¡£å¤ªé•¿ï¼Œå…¶ä¸­å¤šæ™ºèƒ½ä½“åä½œç« èŠ‚å°±æ²¡æœ‰è¯¦ç»†å±•å¼€ã€‚</p>
<p>æœ¬æ–‡åŸºäºAgentScopeæ¡†æ¶ï¼Œå¯¹å¤šæ™ºèƒ½ä½“åä½œåœºæ™¯è¿›è¡Œè¯¦ç»†å®è·µå’Œå¯¹æ¯”åˆ†æï¼Œåé¢è¿˜ä¼šæœ‰ä¸€ç¯‡åŸºäºLangGraphæ¡†æ¶çš„å®è·µåˆ†æã€‚</p>
<p>ä¸ºäº†æ›´å¥½åœ°æ¨¡æ‹Ÿï¼Œæˆ‘ä»¬è¿˜æ˜¯åŸºäºä¹‹å‰é«˜è€ƒä¿¡æ¯æŸ¥è¯¢è¿™ä¸ªä¸šåŠ¡åœºæ™¯ï¼Œå°†åŸæœ‰çš„å•æ™ºèƒ½ä½“æ‹†åˆ†ä¸ºå››ä¸ªæ¨¡å—ï¼Œå¯¹åº”å››ä¸ªæ™ºèƒ½ä½“å¦‚ä¸‹ï¼š</p>
<p>Template Agentï¼šæ¨¡æ¿åŒ¹é…ï¼Œæˆ‘ä»¬å°†SQL Agentç”Ÿæˆçš„SQLä¿å­˜ä¸ºæ¨¡æ¿ï¼Œæå–å¹´ä»½å‚æ•°ï¼Œå½“ä¸‹ä¸€æ¬¡è¿½é—®ä»…ä»…æ˜¯å¯¹å¹´ä»½çš„è¿½é—®æ—¶ï¼Œç›´æ¥å–æ¨¡æ¿å†…çš„SQLæŸ¥è¯¢åˆ†æå³å¯ã€‚</p>
<p>Rewrite Agentï¼šæ„å›¾è¯†åˆ«ï¼Œæ ¹æ®ä¸Šä¸‹æ–‡æ”¹å†™é—®é¢˜å®Œå–„æ¡ä»¶ï¼Œæ”¯æŒå¤šè½®è¿½é—®åœºæ™¯ã€‚</p>
<p>SQL Agentï¼šé€šè¿‡è‡ªç„¶è¯­è¨€åŒ¹é…è¡¨ç»“æ„ç­‰ä¿¡æ¯ï¼Œç„¶åç”ŸæˆSQLï¼Œå†æ‰§è¡ŒSQLæŸ¥è¯¢å‡ºæ•°æ®ã€‚</p>
<p>Analysis Agentï¼šåˆ†æç»“æœæ•°æ®å¹¶ç®€è¦å›ç­”ç”¨æˆ·é—®é¢˜ã€‚</p>
<h2 data-id="heading-0">ğŸ§  å¤šæ™ºèƒ½ä½“åä½œå®ç°é€»è¾‘</h2>
<p>é¦–å…ˆçœ‹ä¸€ä¸‹ä¸šåŠ¡åœºæ™¯ï¼Œæ‰“ç®—åŸºäºä»¥ä¸Šå››ä¸ªæ™ºèƒ½ä½“åä½œï¼Œæ¥æ”¯æ’‘ç”¨æˆ·è¿›è¡Œé«˜è€ƒä¿¡æ¯æŸ¥è¯¢ï¼Œå¹¶ä¸”è¦æ”¯æŒå¤šè½®å¯¹è¯ï¼Œåç»­ä¼šåŸºäºä»¥ä¸‹æ¡ˆä¾‹æ¥è¿›è¡ŒéªŒè¯ï¼š</p>
<p>ç¬¬ä¸€è½®æé—®ï¼š2016å¹´è€ƒç”Ÿäººæ•°æœ‰å¤šå°‘ï¼Ÿ<br/>
ç¬¬äºŒè½®è¿½é—®å¹´ä»½ï¼š2018å¹´å‘¢ï¼Ÿ<br/>
ç¬¬ä¸‰è½®è¿½é—®å…¶ä»–ï¼šå½•å–äººæ•°å‘¢ï¼Ÿ</p>
<p>é’ˆå¯¹è¯¥ä¸šåŠ¡åœºæ™¯ï¼Œå››ä¸ªæ™ºèƒ½ä½“ä¹‹é—´çš„åä½œé€»è¾‘è®¾è®¡å¦‚ä¸‹ï¼š</p>
<p>1ï¼‰ç”¨æˆ·è¾“å…¥é—®é¢˜</p>
<p>2ï¼‰TemplateAgentåˆ¤æ–­æ˜¯å¦åŒ¹é…æ¨¡æ¿ï¼ŒæœªåŒ¹é…NO_MATCHè½¬3ï¼Œæ— ä¸Šä¸‹æ–‡NO_CONTEXTåˆ™è½¬4ï¼ŒåŒ¹é…åˆ™è½¬5</p>
<p>3ï¼‰æœªåŒ¹é…NO_MATCHå³åŒ¹é…å¤±è´¥ï¼Œè¿›å…¥æ„å›¾è¯†åˆ«æ”¹å†™RewriteAgentï¼Œåˆ©ç”¨ä¸Šä¸‹æ–‡å¯¹è¯èƒŒæ™¯è¿›è¡Œé—®é¢˜æ”¹å†™ï¼Œç„¶åè¿›å…¥SQLAgentï¼ŒRAGæ£€ç´¢å…ƒæ•°æ®ã€ç”ŸæˆSQLã€æŸ¥è¯¢æ•°æ®ï¼Œæœ€åè¿›å…¥AnalysisAgentåˆ†æå›ç­”</p>
<p>4ï¼‰æ— ä¸Šä¸‹æ–‡NO_CONTEXTå³é¦–æ¬¡æé—®ï¼Œç›´æ¥è¿›å…¥SQLAgentï¼ŒRAGæ£€ç´¢å…ƒæ•°æ®ã€ç”ŸæˆSQLã€æŸ¥è¯¢æ•°æ®ï¼Œæœ€åè¿›å…¥AnalysisAgentåˆ†æå›ç­”</p>
<p>5ã€ç›´æ¥AnalysisAgentåˆ†æå›ç­”</p>
<p>æ•´ä½“åä½œé€»è¾‘æ¦‚è§ˆå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-css" lang="css">Â  Â  <span class="hljs-selector-attr">[ç”¨æˆ·è¾“å…¥]</span>
Â  Â  Â  Â  â†“
Â  Â  <span class="hljs-selector-attr">[TemplateAgent]</span>
Â  Â  Â  Â  â†“
Â  Â  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€åŒ¹é…ç»“æœâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
Â  Â  â†“ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â â†“ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â â†“
<span class="hljs-selector-attr">[åŒ¹é…æˆåŠŸ-ç®¡é“1]</span> Â  Â  Â  Â  Â <span class="hljs-selector-attr">[åŒ¹é…å¤±è´¥æœ‰ä¸Šä¸‹æ–‡-ç®¡é“2]</span> Â  <span class="hljs-selector-attr">[åŒ¹é…å¤±è´¥æ— ä¸Šä¸‹æ–‡-ç®¡é“3]</span>
Â  Â  â†“ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â â†“ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â â†“
<span class="hljs-selector-attr">[AnalysisAgent]</span> Â  Â  Â  Â  <span class="hljs-selector-attr">[RewriteAgent]</span> Â  Â  Â  Â  Â <span class="hljs-selector-attr">[SQLAgent]</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â â†“ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â â†“
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-selector-attr">[SQLAgent]</span> Â  Â  Â  Â  Â  Â  Â <span class="hljs-selector-attr">[AnalysisAgent]</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â â†“ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-selector-attr">[AnalysisAgent]</span> Â  Â  Â  Â  Â  Â  Â  â†“
Â  Â  â†“ Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â â†“
Â  Â  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€è¾“å‡ºç»“æœâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Â  Â  Â  Â  â†‘
Â  Â  Â  Â  â””â”€â”€â”€â”€â”€â”€â”€â”€ Memory + Context Reuse â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>é’ˆå¯¹ä»¥ä¸Šåä½œé€»è¾‘ä¸­çš„ä¸‰ç§åˆ†æ”¯å¤„ç†é€»è¾‘ï¼Œå®é™…è¿˜æ˜¯è¦é€šè¿‡æ‰‹å†™ä»£ç æ–¹å¼æ¥è¿›è¡Œé€»è¾‘æ§åˆ¶ï¼Œç„¶åå…¶ä¸­æ¯é’Ÿåˆ†æ”¯æµç¨‹ä¸­å¦‚æœæ¶‰åŠåˆ°å¤šä¸ªAgentï¼Œåˆ™å¯ä»¥é€šè¿‡AgentScopeæ¡†æ¶æä¾›çš„ç®¡é“æ¨¡å¼ï¼ˆsequential_pipelineï¼‰è¿›è¡Œä¸²è”ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># --- å¯¹è¯ä¸»æµç¨‹ ---</span>
<span class="hljs-keyword">async</span>Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">chat</span>():
Â  Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"å¯åŠ¨ AgentScope å¤šæ™ºèƒ½ä½“ç³»ç»Ÿï¼ˆè¾“å…¥ exit é€€å‡ºï¼‰"</span>)

Â  Â  template_agent = TemplateAgent()
Â  Â  rewrite_agent = RewriteAgent()
Â  Â  sql_agent = SQLAgent()
Â  Â  analysis_agent = AnalysisAgent()

Â  Â Â <span class="hljs-keyword">while</span>Â <span class="hljs-literal">True</span>:
Â  Â  Â  Â  user_input =Â <span class="hljs-keyword">await</span>Â asyncio.get_event_loop().run_in_executor(
Â  Â  Â  Â  Â  Â Â <span class="hljs-literal">None</span>,Â <span class="hljs-built_in">input</span>,Â <span class="hljs-string">"ğŸ‘¤ ç”¨æˆ·: "</span>
Â  Â  Â  Â  )
Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â user_input.strip().lower() ==Â <span class="hljs-string">"exit"</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"é€€å‡ºç¨‹åº"</span>)
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">break</span>

Â  Â  Â  Â  user_msg = Msg(<span class="hljs-string">"user"</span>, user_input, role=<span class="hljs-string">"user"</span>)
Â  Â  Â  Â Â <span class="hljs-comment"># æ‰€æœ‰ Agent è§‚å¯Ÿè¾“å…¥</span>
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â agentÂ <span class="hljs-keyword">in</span>Â [template_agent, rewrite_agent, sql_agent, analysis_agent]:
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">await</span>Â agent.observe(user_msg)

Â  Â  Â  Â Â <span class="hljs-comment"># Step 1ï¸âƒ£ æ¨¡æ¿åŒ¹é…</span>
Â  Â  Â  Â  template_res =Â <span class="hljs-keyword">await</span>Â template_agent.reply(user_msg)

Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â template_res.content.strip().upper() ==Â <span class="hljs-string">"NO_MATCH"</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># æ¨¡æ¿å¤±è´¥ â†’ èµ° æ”¹å†™ â†’ SQL â†’ åˆ†æ</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸŒ€ æ¨¡æ¿åŒ¹é…å¤±è´¥ï¼Œè¿›å…¥æ”¹å†™æµç¨‹"</span>)
Â  Â  Â  Â  Â  Â  final_msg =Â <span class="hljs-keyword">await</span>Â sequential_pipeline([rewrite_agent, sql_agent, analysis_agent], user_msg)
Â  Â  Â  Â Â <span class="hljs-keyword">elif</span>Â template_res.content.strip().upper() ==Â <span class="hljs-string">"NO_CONTEXT"</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># æ— ä¸Šä¸‹æ–‡ â†’ èµ° SQL â†’ åˆ†æ</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸŒ€ æ— ä¸Šä¸‹æ–‡ï¼Œè¿›å…¥SQLæµç¨‹"</span>)
Â  Â  Â  Â  Â  Â  final_msg =Â <span class="hljs-keyword">await</span>Â sequential_pipeline([sql_agent, analysis_agent], user_msg)
Â  Â  Â  Â Â <span class="hljs-keyword">else</span>:
Â  Â  Â  Â  Â  Â Â <span class="hljs-comment"># æ¨¡æ¿æˆåŠŸåŒ¹é… â†’ èµ° SQL + åˆ†æ</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ¯ æ¨¡æ¿åŒ¹é…æˆåŠŸï¼Œç›´æ¥è¿›å…¥åˆ†ææµç¨‹"</span>)
Â  Â  Â  Â  Â  Â  final_msg =Â <span class="hljs-keyword">await</span>Â sequential_pipeline([analysis_agent], template_res)

Â  Â  Â  Â Â <span class="hljs-comment"># æ‰€æœ‰ Agent è§‚å¯Ÿç»“æœ</span>
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â agentÂ <span class="hljs-keyword">in</span>Â [template_agent, rewrite_agent, sql_agent, analysis_agent]:
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">await</span>Â agent.observe(final_msg)

Â  Â  Â  Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span>Â +Â <span class="hljs-string">"-"</span>Â *Â <span class="hljs-number">50</span>)
</code></pre>
<p>ä»£ç ä¸­åœ¨å¯åŠ¨æ—¶å…ˆåˆ›å»ºäº†å››ä¸ªæ™ºèƒ½ä½“ï¼Œé€šè¿‡if else æ¥ä¸²è”ä¸šåŠ¡åˆ†æ”¯ï¼Œä¸€ä¸ªåˆ†æ”¯å¯¹åº”ç”±Â sequential_pipeline()Â æ„å»ºä¸€ä¸ªåŒ…å«å¤šAgentç»„æˆçš„ç®¡é“ï¼Œç®¡é“å†…éƒ¨æ¯ä¸ª Agent å®ç°ç‹¬ç«‹èŒè´£ï¼Œå¹¶é€šè¿‡Â MsgÂ æ¶ˆæ¯ç»“æ„ä¼ é€’æ•°æ®ä¸ä¸Šä¸‹æ–‡è®°å¿†ï¼ˆInMemoryMemoryï¼‰ã€‚</p>
<h3 data-id="heading-1"><strong>ğŸ” å¤šè½®å¯¹è¯ä¹‹ä¸Šä¸‹æ–‡è®°å¿†+å…¨å±€å˜é‡</strong></h3>
<p>å…ˆçœ‹ä¸Šä¸‹æ–‡è®°å¿†çš„ç›¸å…³æœºåˆ¶ï¼Œæ¯ä¸ª Agent éƒ½å¯ä»¥è§‚å¯Ÿå¤šè½®å¯¹è¯ï¼Œé€šè¿‡ä¸Šä¸‹æ–‡memoryï¼Œæ”¯æŒå¤šè½®è¿½é—®ä¸é—®é¢˜è¡¥å…¨ã€‚å¦‚ä¸‹é¢è¿™æ®µä»£ç æ‰€ç¤ºï¼Œå°†ç”¨æˆ·è¾“å…¥é—®é¢˜user_msgï¼Œä»¥åŠæœ€ç»ˆè¾“å‡ºç»“æœfinal_msgï¼Œé€šè¿‡è°ƒç”¨agent.observeè¿™ä¸ªæ–¹æ³•æ¥å‘ŠçŸ¥æ‰€æœ‰çš„æ™ºèƒ½ä½“ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">user_msg</span> = Msg(<span class="hljs-string">"user"</span>, user_input, role=<span class="hljs-string">"user"</span>)
<span class="hljs-comment"># æ‰€æœ‰ Agent è§‚å¯Ÿè¾“å…¥</span>
forÂ agentÂ inÂ <span class="hljs-section">[template_agent, rewrite_agent, sql_agent, analysis_agent]</span>:
Â  Â Â awaitÂ agent.observe(user_msg)

......

<span class="hljs-comment"># æ‰€æœ‰ Agent è§‚å¯Ÿç»“æœ</span>
forÂ agentÂ inÂ <span class="hljs-section">[template_agent, rewrite_agent, sql_agent, analysis_agent]</span>:
Â  Â Â awaitÂ agent.observe(final_msg)
</code></pre>
<p>åŒæ—¶åœ¨æ‰€æœ‰Agentæ™ºèƒ½ä½“çš„å®ç°ä»£ç ä¸­ï¼Œéƒ½å®šä¹‰äº†observeè¿™ä¸ªæ–¹æ³•ï¼Œæ¥æ¥æ”¶ç”¨æˆ·è¾“å…¥å’Œç³»ç»Ÿè¾“å‡ºçš„ä¸Šä¸‹æ–‡å¯¹è¯å†å²ï¼Œå¹¶ä¿å­˜åˆ°Agentå†…éƒ¨çš„è®°å¿†æ¨¡å—ï¼š</p>
<pre><code class="hljs language-python" lang="python">Â  Â Â <span class="hljs-keyword">async</span>Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">observe</span>(<span class="hljs-params">self,Â msg:Â MsgÂ | <span class="hljs-built_in">list</span>[Msg] |Â <span class="hljs-literal">None</span></span>) -&gt;Â <span class="hljs-literal">None</span>:  
Â  Â  Â  Â Â <span class="hljs-keyword">await</span>Â self.memory.add(msg)
</code></pre>
<p>æ™ºèƒ½ä½“å†…éƒ¨è®°å¿†æ¨¡å—éƒ½ä¼šæŒæœ‰å¤šè½®å¯¹è¯çš„ä¸Šä¸‹æ–‡å†å²ï¼Œä¾›å¤„ç†ç”¨æˆ·æ–°è¾“å…¥æ—¶ä½¿ç”¨ï¼Œå½“ç„¶å®é™…æœ¬æ¡ˆä¾‹ä¸­åªæœ‰é—®é¢˜æ”¹å†™RewriteAgentæ‰éœ€è¦ä½¿ç”¨å¤šè½®å¯¹è¯ä¸Šä¸‹æ–‡ï¼Œå…¶ä»è®°å¿†æ¨¡å—ä¸­è·å–ä¸Šä¸‹æ–‡å¹¶ç”¨äºé—®é¢˜æ”¹å†™çš„ä»£ç é€»è¾‘å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python">Â  Â Â <span class="hljs-keyword">async</span>Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">reply</span>(<span class="hljs-params">self, msg: Msg</span>) -&gt; Msg:
Â  Â  Â  Â Â <span class="hljs-string">"""ç†è§£æ„å›¾å¹¶æ”¹å†™"""</span>
Â  Â  Â  Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"=== ğŸŸ¨ Rewrite Agent ==="</span>)
Â  Â  Â  Â  user_query = msg.content

Â  Â  Â  Â Â <span class="hljs-comment"># ä»è®°å¿†ä¸­å–å‡ºå†å²ä¸Šä¸‹æ–‡</span>
Â  Â  Â  Â  history =Â <span class="hljs-keyword">await</span>Â self.memory.get_memory()

Â  Â  Â  Â Â <span class="hljs-comment"># æ„é€  prompt</span>
Â  Â  Â  Â  user_prompt =Â <span class="hljs-string">f"""
Â  Â  Â  Â  Â  Â  ç”¨æˆ·çš„é—®é¢˜å¯èƒ½æ˜¯ä¸å®Œæ•´çš„è¿½é—®æˆ–æ¨¡ç³Šæè¿°ï¼Œè¯·ç»“åˆä¸Šä¸‹æ–‡è¡¥å…¨æˆä¸€ä¸ªæ¸…æ™°çš„é—®é¢˜ã€‚

Â  Â  Â  Â  Â  Â  ã€å½“å‰é—®é¢˜ã€‘
Â  Â  Â  Â  Â  Â  "<span class="hljs-subst">{user_query}</span>"

Â  Â  Â  Â  Â  Â  è¯·å°†ä¸Šé¢çš„é—®é¢˜æ”¹å†™æˆä¸€ä¸ª**å¯ç‹¬ç«‹ç†è§£ã€å®Œæ•´è¡¨è¾¾æŸ¥è¯¢æ„å›¾**çš„è‡ªç„¶è¯­è¨€é—®é¢˜ã€‚
Â  Â  Â  Â  Â  Â  è¦æ±‚ï¼š
Â  Â  Â  Â  Â  Â  1. æ ¹æ®åŸæ„å›¾å†…å®¹è¡¥å……ä¿¡æ¯ï¼Œå®Œå–„æ¡ä»¶å³å¯ï¼Œæ— é¡»å‘æ•£è”æƒ³
Â  Â  Â  Â  Â  Â  2. ä¸è¶…è¿‡ 50 å­—
Â  Â  Â  Â  Â  Â  3. ä»…è¾“å‡ºæ”¹å†™åçš„é—®é¢˜å†…å®¹
Â  Â  Â  Â  """</span>
Â  Â  Â  Â  prompt =Â <span class="hljs-keyword">await</span>Â self.formatter.<span class="hljs-built_in">format</span>([
Â  Â  Â  Â  Â  Â  Msg(<span class="hljs-string">"system"</span>,Â <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªæŸ¥è¯¢æ„å›¾ç†è§£ä¸æ”¹å†™ä¸“å®¶ã€‚"</span>,Â <span class="hljs-string">"system"</span>),
Â  Â  Â  Â  Â  Â  *history,
Â  Â  Â  Â  Â  Â  Msg(<span class="hljs-string">"user"</span>, user_prompt,Â <span class="hljs-string">"user"</span>),
Â  Â  Â  Â  ])

Â  Â  Â  Â  result =Â <span class="hljs-keyword">await</span>Â self.model(prompt)
Â  Â  Â  Â  final_res =Â <span class="hljs-keyword">await</span>Â get_response(result)
Â  Â  Â  Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœï¸ æ”¹å†™åé—®é¢˜ï¼š<span class="hljs-subst">{final_res}</span>"</span>)
</code></pre>
<p>åŸºäºè¿™æ®µä»£ç ï¼Œé’ˆå¯¹ç”¨æˆ·ç®€å†™çš„é—®é¢˜â€œå½•å–äººæ•°å‘¢ï¼Ÿâ€ï¼Œæ ¹æ®å†å²å¯¹è¯â€œ2018å¹´è€ƒç”Ÿäººæ•°â€ç›¸å…³çš„è®°å¿†æ¥æ”¹å†™ï¼Œæ”¹å†™è¡¥å…¨åå°±å˜æˆâ€œ2018å¹´å½•å–äººæ•°æœ‰å¤šå°‘ï¼Ÿâ€çš„å®Œæ•´é—®é¢˜ã€‚</p>
<p>é™¤äº†è®°å½•å¤šè½®å¯¹è¯è¾“å…¥/è¾“å‡ºMsgçš„ä¸Šä¸‹æ–‡è®°å¿†æ¨¡å—Memoryä¹‹å¤–ï¼Œè¿˜å¯ä»¥åˆ©ç”¨å…¨å±€å˜é‡æ–¹å¼åœ¨å¤šä¸ªæ™ºèƒ½ä½“Agentä¹‹é—´è¿›è¡Œç»“æ„åŒ–çš„å‚æ•°ä¼ é€’ï¼Œå¦‚ä¸‹å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡stataï¼Œå­˜æ”¾å†å²æŸ¥è¯¢SQLçš„æ¨¡æ¿ï¼Œæ–¹ä¾¿åç»­åŒç±»é—®é¢˜ç›´æ¥ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ========================</span>
<span class="hljs-comment"># ğŸ§  å…¨å±€å˜é‡å®šä¹‰</span>
<span class="hljs-comment"># ========================</span>
<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">State</span>(<span class="hljs-title class_ inherited__">TypedDict</span>):
Â  Â  original_intent:Â <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] Â <span class="hljs-comment"># å¦‚ "2016å¹´è€ƒç”Ÿäººæ•°æœ‰å¤šå°‘ï¼Ÿ"</span>
Â  Â  last_sql_template:Â <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] Â <span class="hljs-comment"># å¸¦å ä½ç¬¦çš„ SQL æ¨¡æ¿ï¼Œå¦‚ "SELECT ... WHERE year = {year}"</span>

state = State()
</code></pre>
<p>å°±å¯ä»¥å®ç°åœ¨å‰ä¸€è½®å¯¹è¯æ—¶ï¼Œåœ¨SQLAgentæ™ºèƒ½ä½“ä¸­å°†æ ¹æ®ç”¨æˆ·é—®é¢˜+åŒ¹é…åˆ°çš„è¡¨ç»“æ„ä¿¡æ¯ç”Ÿæˆå¯¹åº”æŸ¥è¯¢SQLåï¼Œå°†è¯¥SQLå’Œç”¨æˆ·é—®é¢˜éƒ½ç½®å…¥å…¨å±€å˜é‡ä¸­ï¼š</p>
<pre><code class="hljs language-python" lang="python">        <span class="hljs-comment"># ç”Ÿæˆ SQL æ¨¡æ¿ï¼ˆç®€å•å¹´ä»½/æ•°å­—æ›¿æ¢ï¼‰  </span>
Â  Â  Â  Â  template_sql = re.sub(<span class="hljs-string">r'\b(19|20)\d{{2}}\b'</span>,Â <span class="hljs-string">'{year}'</span>, sql) Â <span class="hljs-comment"># å¹´ä»½  </span>
Â  Â  Â  Â  template_sql = re.sub(<span class="hljs-string">r'\b\d+\b'</span>,Â <span class="hljs-string">'{year}'</span>, template_sql, count=<span class="hljs-number">1</span>) Â <span class="hljs-comment"># å…œåº•æ›¿æ¢ç¬¬ä¸€ä¸ªæ•°å­—  </span>
  
Â  Â  Â  Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ğŸ§  åŸå§‹æ„å›¾:Â <span class="hljs-subst">{user_query}</span>"</span>)  
Â  Â  Â  Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ğŸ“¦ ä¿å­˜ SQL æ¨¡æ¿:Â <span class="hljs-subst">{template_sql}</span>"</span>)  
  
Â  Â  Â  Â  state[<span class="hljs-string">"original_intent"</span>] = user_query Â  Â  Â  Â   
Â  Â  Â  Â  state[<span class="hljs-string">"last_sql_template"</span>] = template_sql
</code></pre>
<p>ç„¶ååœ¨ä¸‹ä¸€è½®å¯¹è¯æ—¶ï¼Œåœ¨TemplateAgentæ™ºèƒ½ä½“ä¸­å†ä»å…¨å±€å˜é‡ä¸­å–å‡ºè¯¥ä¿¡æ¯ï¼Œåˆ©ç”¨LLMåˆ¤æ–­ç”¨æˆ·æœ€æ–°æŸ¥è¯¢æ„å›¾å’Œå…¨å±€å˜é‡ä¸­çš„ç”¨æˆ·é—®é¢˜æ˜¯å¦åŒä¸€ç§é—®é¢˜ï¼Œåªæ˜¯æŸ¥è¯¢æ¡ä»¶ä¸åŒçš„è¿½é—®ï¼ˆå¦‚åªæ˜¯ä»2016å¹´æ¢æˆ2018å¹´ï¼‰ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œå°±ç›´æ¥åˆ©ç”¨å…¨å±€å˜é‡ä¸­çš„SQLï¼Œæ›¿æ¢æ‰æŸ¥è¯¢æ¡ä»¶è¿›è¡ŒæŸ¥è¯¢å³å¯ï¼Œè¿™æ ·å°±ä¸ç”¨èµ°åç»­çš„SQLAgentï¼Œå†å»é‡æ–°åˆ©ç”¨LLMå»æ„å»ºSQLäº†ã€‚</p>
<pre><code class="hljs language-python" lang="python">        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ”„ æ£€æµ‹åˆ°å†å²ä¸Šä¸‹æ–‡ï¼Œå°è¯•å‚æ•°åŒ–è¿½é—®"</span>)  
Â  Â  Â  Â Â <span class="hljs-keyword">try</span>:  
Â  Â  Â  Â  Â  Â  <span class="hljs-comment">#Â 1.Â ç”¨Â LLMÂ ä»è¿½é—®ä¸­æå–å‚æ•°  </span>
Â  Â  Â  Â  Â  Â  extract_prompt = <span class="hljs-string">f"""  
Â  Â  Â  Â  Â  Â  Â  Â  åŸå§‹æ„å›¾: <span class="hljs-subst">{state[<span class="hljs-string">'original_intent'</span>]}</span>  
Â  Â  Â  Â  Â  Â  Â  Â  å½“å‰é—®é¢˜: "<span class="hljs-subst">{user_query}</span>"  
  
Â  Â  Â  Â  Â  Â  Â  Â  è¯·åˆ¤æ–­ä¸€ä¸‹ç”¨æˆ·æ˜¯å¦åœ¨è¿›è¡Œå¹´ä»½çš„è¿½é—®ã€‚  
Â  Â  Â  Â  Â  Â  Â  Â  1ã€å¦‚æœä¸æ˜¯å¯¹å¹´ä»½çš„è¿½é—®ï¼Œç›´æ¥è¾“å‡ºç©ºJSON '{{}}'  
Â  Â  Â  Â  Â  Â  Â  Â  2ã€å¦‚æœæ˜¯è¿½é—®ï¼Œä»ä¸­æå–**å˜åŒ–çš„å‚æ•°å€¼**ï¼ˆå¹´ä»½ï¼‰ï¼Œä»¥ JSON æ ¼å¼è¿”å›ã€‚  
Â  Â  Â  Â  Â  Â  Â  Â  ç¤ºä¾‹ï¼š  
Â  Â  Â  Â  Â  Â  Â  Â  - â€œé‚£2017å¹´å‘¢ï¼Ÿâ€ â†’ {{"year": "2017"}}  
  
Â  Â  Â  Â  Â  Â  Â  Â  åªè¾“å‡º JSONï¼Œä¸è¦å…¶ä»–å†…å®¹ã€‚  
Â  Â  Â  Â  Â  Â  """</span>  
Â  Â  Â  Â  Â  Â  formatted =Â <span class="hljs-keyword">await</span>Â self.formatter.<span class="hljs-built_in">format</span>([  
Â  Â  Â  Â  Â  Â  Â  Â Â Msg(<span class="hljs-string">"system"</span>, <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªå‚æ•°æå–å™¨ã€‚"</span>,Â <span class="hljs-string">"system"</span>),  
Â  Â  Â  Â  Â  Â  Â  Â Â Msg(<span class="hljs-string">"user"</span>, extract_prompt,Â <span class="hljs-string">"user"</span>),  
Â  Â  Â  Â  Â  Â  ])  
  
Â  Â  Â  Â  Â  Â  result =Â <span class="hljs-keyword">await</span>Â self.model(formatted)  
Â  Â  Â  Â  Â  Â  json_str =Â <span class="hljs-keyword">await</span>Â get_response(result)  
Â  Â  Â  Â  Â  Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ğŸ” æå–å‚æ•°: <span class="hljs-subst">{json_str}</span>"</span>)  
Â  Â  Â  Â  Â  Â  params = json.loads(json_str)  
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">if</span>Â <span class="hljs-keyword">not</span>Â <span class="hljs-string">"year"</span>inparams:  
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"âš ï¸ å¹´ä»½å‚æ•°æå–å¤±è´¥ï¼Œè¿›å…¥æ”¹å†™æµç¨‹"</span>)  
Â  Â  Â  Â  Â  Â  Â  Â Â returnMsg(self.name,Â <span class="hljs-string">"NO_MATCH"</span>, role=<span class="hljs-string">"assistant"</span>)  
  
Â  Â  Â  Â  Â  Â  <span class="hljs-comment">#Â 2.Â å¡«å……Â SQLÂ æ¨¡æ¿  </span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">try</span>:  
Â  Â  Â  Â  Â  Â  Â  Â  new_sql = state[<span class="hljs-string">"last_sql_template"</span>].<span class="hljs-built_in">format</span>(**params)  
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ğŸ› ï¸ ç”Ÿæˆæ–° SQL: <span class="hljs-subst">{new_sql}</span>"</span>)
</code></pre>
<p>æŒ‰ä¸Šé¢ä¸‰æ®µä»£ç æ‰€ç¤ºï¼Œé€šè¿‡å…¨å±€å˜é‡stateï¼Œå°±å¯ä»¥å®ç°å¤šè½®æ¬¡å¯¹è¯ä¹‹é—´çš„ç»“æ„åŒ–å‚æ•°ä¼ é€’ã€‚</p>
<p><strong>â–¶ï¸ æ¡ˆä¾‹æµ‹è¯•ç»“æœ</strong></p>
<p>è¿è¡ŒéªŒè¯ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">å¯åŠ¨ AgentScope å¤šæ™ºèƒ½ä½“ç³»ç»Ÿï¼ˆè¾“å…¥ exit é€€å‡ºï¼‰
ğŸ‘¤ ç”¨æˆ·:Â <span class="hljs-number">2016</span>å¹´è€ƒç”Ÿäººæ•°æœ‰å¤šå°‘ï¼Ÿ
<span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>Â ğŸŸ¦ Template AgentÂ <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>
âš ï¸ ä¸å­˜åœ¨ä¸Šä¸‹æ–‡ï¼Œè¿›å…¥<span class="hljs-keyword">SQL</span>Â Agentæµç¨‹
ğŸŒ€ æ— ä¸Šä¸‹æ–‡ï¼Œè¿›å…¥<span class="hljs-keyword">SQL</span>æµç¨‹
<span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>Â ğŸŸ¦Â <span class="hljs-keyword">Sql</span>Â AgentÂ <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>
è°ƒç”¨å¤§æ¨¡å‹llama2å‘é‡åŒ–ï¼š<span class="hljs-number">2016</span>å¹´è€ƒç”Ÿäººæ•°æœ‰å¤šå°‘ï¼Ÿ
å¥½çš„ï¼Œç”¨æˆ·é—®çš„æ˜¯<span class="hljs-number">2016</span>å¹´çš„è€ƒç”Ÿäººæ•°æœ‰å¤šå°‘ã€‚é¦–å…ˆï¼Œæˆ‘éœ€è¦æŸ¥çœ‹æä¾›çš„è¡¨ç»“æ„ã€‚è¡¨åæ˜¯college_entrance_examinationï¼Œä¸»é”®æ˜¯examination_yearï¼Œç±»å‹æ˜¯<span class="hljs-type">int</span>ã€‚è€ƒç”Ÿäººæ•°æ˜¯candidates_countï¼Œç±»å‹æ˜¯<span class="hljs-type">decimal</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>)ã€‚

å› ä¸ºexamination_yearæ˜¯ä¸»é”®ï¼Œæ‰€ä»¥æ¯ä¸ªå¹´ä»½åªæœ‰ä¸€æ¡è®°å½•ã€‚å› æ­¤ï¼ŒæŸ¥è¯¢<span class="hljs-number">2016</span>å¹´çš„è€ƒç”Ÿäººæ•°ä¸éœ€è¦ç”¨èšåˆå‡½æ•°ï¼Œç›´æ¥<span class="hljs-keyword">SELECT</span>Â candidates_countå³å¯ã€‚æ‰€ä»¥æ­£ç¡®çš„<span class="hljs-keyword">SQL</span>åº”è¯¥æ˜¯<span class="hljs-keyword">SELECT</span>Â candidates_countÂ <span class="hljs-keyword">FROM</span>Â college_entrance_examinationÂ <span class="hljs-keyword">WHERE</span>Â examination_yearÂ <span class="hljs-operator">=</span><span class="hljs-number">2016</span>; è¿™é‡Œä¸éœ€è¦èšåˆå‡½æ•°ï¼Œå› ä¸ºæ•°æ®æ˜¯ç›´æ¥å­˜å‚¨çš„ï¼Œä¸æ˜¯éœ€è¦ç»Ÿè®¡çš„ã€‚

ğŸ’¡ å¤§æ¨¡å‹ç”Ÿæˆçš„<span class="hljs-keyword">SQL</span>: [<span class="hljs-keyword">select</span>Â candidates_countÂ <span class="hljs-keyword">from</span>Â college_entrance_examinationÂ <span class="hljs-keyword">where</span>Â examination_yearÂ <span class="hljs-operator">=</span><span class="hljs-number">2016</span>Â limitÂ <span class="hljs-number">1</span>]
ğŸ’¡ æ•°æ®æŸ¥è¯¢æˆåŠŸ: [{<span class="hljs-string">'candidates_count'</span>:Â <span class="hljs-number">940.0</span>}]
ğŸ§  åŸå§‹æ„å›¾:Â <span class="hljs-number">2016</span>å¹´è€ƒç”Ÿäººæ•°æœ‰å¤šå°‘ï¼Ÿ
ğŸ“¦ ä¿å­˜Â <span class="hljs-keyword">SQL</span>Â æ¨¡æ¿:Â <span class="hljs-keyword">select</span>Â candidates_countÂ <span class="hljs-keyword">from</span>Â college_entrance_examinationÂ <span class="hljs-keyword">where</span>Â examination_yearÂ <span class="hljs-operator">=</span>Â {<span class="hljs-keyword">year</span>} limitÂ <span class="hljs-number">1</span>
<span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>Â ğŸŸ© Analysis AgentÂ <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>
å¥½çš„ï¼Œæˆ‘ç°åœ¨éœ€è¦å¤„ç†ç”¨æˆ·çš„é—®é¢˜ï¼šâ€œ<span class="hljs-number">2016</span>å¹´è€ƒç”Ÿäººæ•°æœ‰å¤šå°‘ï¼Ÿâ€é¦–å…ˆï¼Œæˆ‘è¦ç¡®è®¤ç”¨æˆ·çš„éœ€æ±‚æ˜¯è·å–<span class="hljs-number">2016</span>å¹´çš„è€ƒç”Ÿäººæ•°ã€‚æ ¹æ®æä¾›çš„è¡¨ç»“æ„ä¿¡æ¯ï¼Œè¡¨åæ˜¯college_entrance_examinationï¼ŒåŒ…å«é«˜è€ƒå¹´ä»½ã€è€ƒç”Ÿäººæ•°å’Œå¤è¯»äººæ•°ä¸‰ä¸ªå­—æ®µã€‚ç”¨æˆ·æä¾›çš„<span class="hljs-keyword">SQL</span>æŸ¥è¯¢å·²ç»æ˜ç¡®ç­›é€‰äº†<span class="hljs-number">2016</span>å¹´çš„è€ƒç”Ÿäººæ•°ï¼Œç»“æœæ˜¯<span class="hljs-number">940.0</span>ä¸‡äººã€‚

æ¥ä¸‹æ¥ï¼Œã€‚ã€‚ã€‚ã€‚ã€‚ï¼ˆç•¥ï¼‰

ğŸ§  æœ€ç»ˆå›ç­”:Â <span class="hljs-number">2016</span>å¹´å…¨å›½é«˜è€ƒè€ƒç”Ÿäººæ•°ä¸º<span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-number">940.0</span>ä¸‡äºº<span class="hljs-operator">*</span><span class="hljs-operator">*</span>ã€‚è¯¥æ•°æ®æ¥æºäºè€ƒç”Ÿäººæ•°ä¸å¤è¯»äººæ•°ä¿¡æ¯è¡¨ï¼ˆcollege_entrance_examinationï¼‰ä¸­<span class="hljs-number">2016</span>å¹´çš„è®°å½•ã€‚

<span class="hljs-comment">--------------------------------------------------</span>
ğŸ‘¤ ç”¨æˆ·:Â <span class="hljs-number">2018</span>å¹´å‘¢
<span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>Â ğŸŸ¦ Template AgentÂ <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>
ğŸ”„ æ£€æµ‹åˆ°å†å²ä¸Šä¸‹æ–‡ï¼Œå°è¯•å‚æ•°åŒ–è¿½é—®
å¥½çš„ï¼Œç°åœ¨æˆ‘éœ€è¦å¤„ç†ç”¨æˆ·çš„é—®é¢˜ï¼šâ€œ<span class="hljs-number">2018</span>å¹´å‘¢â€ã€‚é¦–å…ˆï¼Œç”¨æˆ·ä¹‹å‰é—®äº†<span class="hljs-number">2016</span>å¹´çš„è€ƒç”Ÿäººæ•°ï¼Œç°åœ¨é—®<span class="hljs-number">2018</span>å¹´çš„æƒ…å†µï¼Œè¿™æ˜æ˜¾æ˜¯åœ¨è¿›è¡Œå¹´ä»½çš„è¿½é—®ã€‚æ ¹æ®ä¹‹å‰çš„ç¤ºä¾‹ï¼Œç”¨æˆ·å¸Œæœ›å¾—åˆ°ä¸€ä¸ªåŒ…å«å¹´ä»½çš„JSONå¯¹è±¡ã€‚é—®é¢˜ä¸­çš„å¹´ä»½æ˜¯<span class="hljs-number">2018</span>ï¼Œæ‰€ä»¥éœ€è¦æå–è¿™ä¸ªå‚æ•°ã€‚æ£€æŸ¥è¡¨ç»“æ„ï¼Œç¡®è®¤è¡¨ä¸­ç¡®å®æœ‰examination_yearå­—æ®µï¼Œç±»å‹æ˜¯<span class="hljs-type">int</span>ï¼Œæ‰€ä»¥<span class="hljs-number">2018</span>æ˜¯æœ‰æ•ˆçš„è¾“å…¥ã€‚ç”¨æˆ·æ²¡æœ‰æåˆ°å…¶ä»–å‚æ•°ï¼Œæ‰€ä»¥åªéœ€è¦è¿”å›å¹´ä»½ã€‚å› æ­¤ï¼Œæ­£ç¡®çš„JSONåº”è¯¥æ˜¯{"year": "2018"}ã€‚

ğŸ” æå–å‚æ•°: {"year": "2018"}
ğŸ› ï¸ ç”Ÿæˆæ–°Â <span class="hljs-keyword">SQL</span>:Â <span class="hljs-keyword">select</span>Â candidates_countÂ <span class="hljs-keyword">from</span>Â college_entrance_examinationÂ <span class="hljs-keyword">where</span>Â examination_yearÂ <span class="hljs-operator">=</span><span class="hljs-number">2018</span>Â limitÂ <span class="hljs-number">1</span>
âœ… è¿½é—®æŸ¥è¯¢æˆåŠŸï¼Œè¿”å›Â <span class="hljs-number">1</span>Â è¡Œ
ğŸ¯ æ¨¡æ¿åŒ¹é…æˆåŠŸï¼Œç›´æ¥è¿›å…¥åˆ†ææµç¨‹
<span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>Â ğŸŸ© Analysis AgentÂ <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>
å¥½çš„ï¼Œç”¨æˆ·ä¹‹å‰é—®è¿‡<span class="hljs-number">2016</span>å¹´çš„è€ƒç”Ÿäººæ•°ï¼Œç°åœ¨åˆé—®<span class="hljs-number">2018</span>å¹´çš„ï¼Œæˆ‘éœ€è¦å¿«é€Ÿæ‰¾åˆ°å¯¹åº”çš„ç­”æ¡ˆã€‚æ ¹æ®æä¾›çš„è¡¨ç»“æ„å’Œæ•°æ®ä¿¡æ¯ï¼Œç”¨æˆ·ç»™å‡ºçš„<span class="hljs-keyword">SQL</span>æŸ¥è¯¢æ˜¯é’ˆå¯¹<span class="hljs-number">2018</span>å¹´çš„ï¼Œè¿”å›çš„ç»“æœæ˜¯<span class="hljs-number">975.0</span>ä¸‡äººã€‚æ‰€ä»¥ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚å°±å¯ä»¥ç›´æ¥ç»™å‡ºç­”æ¡ˆäº†ã€‚

ğŸ§  æœ€ç»ˆå›ç­”:Â <span class="hljs-number">2018</span>å¹´å…¨å›½é«˜è€ƒè€ƒç”Ÿäººæ•°ä¸º<span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-number">975.0</span>ä¸‡äºº<span class="hljs-operator">*</span><span class="hljs-operator">*</span>ã€‚è¯¥æ•°æ®æ¥æºäºè€ƒç”Ÿäººæ•°ä¸å¤è¯»äººæ•°ä¿¡æ¯è¡¨ï¼ˆcollege_entrance_examinationï¼‰ä¸­<span class="hljs-number">2018</span>å¹´çš„è®°å½•ã€‚

<span class="hljs-comment">--------------------------------------------------</span>
ğŸ‘¤ ç”¨æˆ·: å½•å–äººæ•°å‘¢ï¼Ÿ
<span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>Â ğŸŸ¦ Template AgentÂ <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>
ğŸ”„ æ£€æµ‹åˆ°å†å²ä¸Šä¸‹æ–‡ï¼Œå°è¯•å‚æ•°åŒ–è¿½é—®
å¥½çš„ï¼Œæˆ‘éœ€è¦åˆ†æç”¨æˆ·çš„é—®é¢˜æ˜¯å¦åœ¨è¿›è¡Œå¹´ä»½çš„è¿½é—®ã€‚ç”¨æˆ·ä¹‹å‰è¯¢é—®äº†<span class="hljs-number">2016</span>å¹´å’Œ<span class="hljs-number">2018</span>å¹´çš„è€ƒç”Ÿäººæ•°ï¼Œç°åœ¨é—®çš„æ˜¯â€œå½•å–äººæ•°å‘¢ï¼Ÿâ€ã€‚é¦–å…ˆï¼Œç”¨æˆ·çš„é—®é¢˜ä»â€œè€ƒç”Ÿäººæ•°â€è½¬å‘äº†â€œå½•å–äººæ•°â€ï¼Œè¿™å¯èƒ½æ¶‰åŠåˆ°å¦ä¸€ä¸ªæ•°æ®ç‚¹ï¼Œè€Œä¸æ˜¯åŒä¸€å­—æ®µçš„ä¸åŒå¹´ä»½ã€‚æ ¹æ®æä¾›çš„è¡¨ç»“æ„ï¼Œè¡¨ä¸­åªæœ‰è€ƒç”Ÿäººæ•°å’Œå¤è¯»äººæ•°ï¼Œæ²¡æœ‰å½•å–äººæ•°çš„å­—æ®µã€‚å› æ­¤ï¼Œç”¨æˆ·å¯èƒ½åœ¨è¯¢é—®å¦ä¸€ä¸ªæœªåœ¨è¡¨ä¸­æä¾›çš„æ•°æ®ï¼Œè€Œä¸æ˜¯åŒä¸€è¡¨ä¸­çš„ä¸åŒå¹´ä»½ã€‚æ­¤å¤–ï¼Œé—®é¢˜ä¸­æ²¡æœ‰æåˆ°å…·ä½“çš„å¹´ä»½ï¼Œä¹Ÿæ²¡æœ‰ä½¿ç”¨â€œé‚£...å‘¢ï¼Ÿâ€è¿™æ ·çš„ç»“æ„ï¼Œæ‰€ä»¥è¿™åº”è¯¥ä¸æ˜¯å¯¹å¹´ä»½çš„è¿½é—®ã€‚å› æ­¤ï¼Œåº”è¯¥è¿”å›ç©ºJSONã€‚

ğŸ” æå–å‚æ•°: {}
âš ï¸ å¹´ä»½å‚æ•°æå–å¤±è´¥ï¼Œè¿›å…¥æ”¹å†™æµç¨‹
ğŸŒ€ æ¨¡æ¿åŒ¹é…å¤±è´¥ï¼Œè¿›å…¥æ”¹å†™æµç¨‹
<span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>Â ğŸŸ¨ Rewrite AgentÂ <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>
å¥½çš„ï¼Œç”¨æˆ·ä¹‹å‰é—®äº†<span class="hljs-number">2016</span>å¹´å’Œ<span class="hljs-number">2018</span>å¹´çš„é«˜è€ƒè€ƒç”Ÿäººæ•°ï¼Œç°åœ¨é—®â€œå½•å–äººæ•°å‘¢ï¼Ÿâ€ã€‚æˆ‘éœ€è¦ç»“åˆä¸Šä¸‹æ–‡è¡¥å…¨é—®é¢˜ã€‚æ ¹æ®ä¹‹å‰çš„å¯¹è¯ï¼Œç”¨æˆ·å¯èƒ½æ˜¯åœ¨æ¯”è¾ƒè€ƒç”Ÿäººæ•°å’Œå½•å–äººæ•°ã€‚æ‰€ä»¥åº”è¯¥æ˜ç¡®å¹´ä»½å’Œå…·ä½“æ˜¯å“ªä¸ªå¹´ä»½çš„å½•å–äººæ•°ã€‚å¯èƒ½æŒ‡çš„æ˜¯æœ€è¿‘æåˆ°çš„<span class="hljs-number">2018</span>å¹´ï¼Œæ‰€ä»¥æ”¹å†™ä¸ºâ€œ<span class="hljs-number">2018</span>å¹´å…¨å›½é«˜è€ƒå½•å–äººæ•°æ˜¯å¤šå°‘ï¼Ÿâ€

âœï¸ æ”¹å†™åé—®é¢˜ï¼š<span class="hljs-number">2018</span>å¹´å…¨å›½é«˜è€ƒå½•å–äººæ•°æ˜¯å¤šå°‘ï¼Ÿ
<span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>Â ğŸŸ¦Â <span class="hljs-keyword">Sql</span>Â AgentÂ <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>
è°ƒç”¨å¤§æ¨¡å‹llama2å‘é‡åŒ–ï¼š<span class="hljs-number">2018</span>å¹´å…¨å›½é«˜è€ƒå½•å–äººæ•°æ˜¯å¤šå°‘ï¼Ÿ
å¥½çš„ï¼Œç”¨æˆ·ç°åœ¨é—®çš„æ˜¯â€œå½•å–äººæ•°å‘¢ï¼Ÿâ€ï¼Œç»“åˆä¹‹å‰çš„å¯¹è¯å†å²æ¥çœ‹ï¼Œä»–ä»¬ä¹‹å‰å·²ç»è¯¢é—®è¿‡<span class="hljs-number">2016</span>å¹´å’Œ<span class="hljs-number">2018</span>å¹´çš„è€ƒç”Ÿäººæ•°ï¼Œç°åœ¨æƒ³çŸ¥é“<span class="hljs-number">2018</span>å¹´çš„å½•å–äººæ•°ã€‚æ ¹æ®ç”¨æˆ·æä¾›çš„è¡¨ç»“æ„ï¼Œå½•å–äººæ•°å­˜å‚¨åœ¨college_entrance_admissionè¡¨ä¸­ï¼Œå…·ä½“å­—æ®µæ˜¯admission_countï¼Œå¹¶ä¸”ä»¥ä¸‡ä¸ºå•ä½ã€‚

é¦–å…ˆï¼Œæˆ‘éœ€è¦ç¡®è®¤ç”¨æˆ·çš„é—®é¢˜æ˜¯å¦éœ€è¦ä½¿ç”¨èšåˆå‡½æ•°ã€‚å› ä¸ºå½•å–äººæ•°åœ¨è¡¨ä¸­æ˜¯æŒ‰å¹´ä»½è®°å½•çš„ï¼Œæ¯ä¸ªå¹´ä»½å¯¹åº”ä¸€ä¸ªå…·ä½“çš„admission_countå€¼ï¼Œæ‰€ä»¥ä¸éœ€è¦SUMæˆ–AVGï¼Œè€Œæ˜¯ç›´æ¥æŸ¥è¯¢è¯¥å¹´ä»½çš„è®°å½•å³å¯ã€‚

æ¥ä¸‹æ¥ï¼Œæ£€æŸ¥è¡¨ç»“æ„ï¼Œadmission_yearæ˜¯ä¸»é”®ï¼Œæ‰€ä»¥<span class="hljs-number">2018</span>å¹´åªä¼šæœ‰ä¸€æ¡è®°å½•ã€‚å› æ­¤ï¼ŒæŸ¥è¯¢åº”è¯¥æ˜¯<span class="hljs-keyword">SELECT</span>Â admission_countÂ <span class="hljs-keyword">FROM</span>Â college_entrance_admissionÂ <span class="hljs-keyword">WHERE</span>Â admission_yearÂ <span class="hljs-operator">=</span><span class="hljs-number">2018</span>ã€‚

ç„¶åï¼Œç¡®ä¿å­—æ®µç±»å‹æ˜¯<span class="hljs-type">decimal</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>)ï¼Œæ‰€ä»¥ç»“æœä¼šæ˜¯ç²¾ç¡®åˆ°å°æ•°ç‚¹åä¸¤ä½çš„æ•°å€¼ã€‚

ğŸ’¡ å¤§æ¨¡å‹ç”Ÿæˆçš„<span class="hljs-keyword">SQL</span>: [<span class="hljs-keyword">select</span>Â admission_countÂ <span class="hljs-keyword">from</span>Â college_entrance_admissionÂ <span class="hljs-keyword">where</span>Â admission_yearÂ <span class="hljs-operator">=</span><span class="hljs-number">2018</span>]
ğŸ’¡ æ•°æ®æŸ¥è¯¢æˆåŠŸ: [{<span class="hljs-string">'admission_count'</span>:Â <span class="hljs-number">790.99</span>}]
ğŸ§  åŸå§‹æ„å›¾:Â <span class="hljs-number">2018</span>å¹´å…¨å›½é«˜è€ƒå½•å–äººæ•°æ˜¯å¤šå°‘ï¼Ÿ
ğŸ“¦ ä¿å­˜Â <span class="hljs-keyword">SQL</span>Â æ¨¡æ¿:Â <span class="hljs-keyword">select</span>Â admission_countÂ <span class="hljs-keyword">from</span>Â college_entrance_admissionÂ <span class="hljs-keyword">where</span>Â admission_yearÂ <span class="hljs-operator">=</span>Â {<span class="hljs-keyword">year</span>}
<span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>Â ğŸŸ© Analysis AgentÂ <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>
å¥½çš„ï¼Œç”¨æˆ·ç°åœ¨é—®çš„æ˜¯â€œå½•å–äººæ•°å‘¢ï¼Ÿâ€ï¼Œçœ‹èµ·æ¥ä»–ä»¬ä¹‹å‰å·²ç»è¯¢é—®è¿‡<span class="hljs-number">2016</span>å¹´å’Œ<span class="hljs-number">2018</span>å¹´çš„è€ƒç”Ÿäººæ•°ï¼Œç°åœ¨æƒ³çŸ¥é“åŒä¸€æ—¶æœŸæˆ–ç›¸å…³å¹´ä»½çš„å½•å–äººæ•°ã€‚æˆ‘éœ€è¦å…ˆå›é¡¾ä¹‹å‰çš„å¯¹è¯å†å²ï¼Œç¡®ä¿å›ç­”çš„ä¸€è‡´æ€§ã€‚

é¦–å…ˆã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ï¼ˆç•¥ï¼‰

ç”¨æˆ·ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ï¼ˆç•¥ï¼‰

æ ¹æ®ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ï¼ˆç•¥ï¼‰

æ­¤å¤–ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ï¼ˆç•¥ï¼‰

æ€»ç»“ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ï¼ˆç•¥ï¼‰

ğŸ§  æœ€ç»ˆå›ç­”:Â <span class="hljs-number">2018</span>å¹´å…¨å›½é«˜è€ƒå½•å–äººæ•°ä¸º<span class="hljs-operator">*</span><span class="hljs-operator">*</span><span class="hljs-number">790.99</span>ä¸‡äºº<span class="hljs-operator">*</span><span class="hljs-operator">*</span>ã€‚è¯¥æ•°æ®æ¥æºäºå½•å–äººæ•°ä¸æ™®é€šé«˜æ ¡æ•°ä¿¡æ¯è¡¨ï¼ˆcollege_entrance_admissionï¼‰ä¸­<span class="hljs-number">2018</span>å¹´çš„è®°å½•ã€‚è‹¥éœ€äº†è§£å…¶ä»–å¹´ä»½çš„å½•å–äººæ•°ï¼Œå¯æä¾›å…·ä½“å¹´ä»½ä»¥ä¾¿è¿›ä¸€æ­¥æŸ¥è¯¢ã€‚

<span class="hljs-comment">--------------------------------------------------</span>
ğŸ‘¤ ç”¨æˆ·:Â 
</code></pre>
<p>ç¬¬ä¸€è½®é—®é¢˜ï¼š2016å¹´è€ƒç”Ÿäººæ•°æœ‰å¤šå°‘ï¼Ÿ</p>
<p>ç¬¬ä¸€è½®æ²¡æœ‰ä¸Šä¸‹æ–‡ï¼Œä¹Ÿæ²¡æœ‰å…¨å±€å˜é‡æ¨¡æ¿ï¼Œæ‰€ä»¥ç›´æ¥èµ°SQL AgentÂ +Â Analysis AgentRAGæ£€ç´¢ã€ç”ŸæˆSQLã€æŸ¥æ•°ã€åˆ†æã€‚åŒæ—¶SQL Agentç”ŸæˆæˆåŠŸåè®°å½•SQLæ¨¡æ¿åˆ°å…¨å±€stateã€‚</p>
<p>ç¬¬äºŒè½®é—®é¢˜ï¼š2018å¹´å‘¢ï¼Ÿ</p>
<p>ç¬¬äºŒè½®æˆ‘ä»¬è¿½é—®2018å¹´ï¼Œè¿™æ—¶å­˜åœ¨å…¨å±€å˜é‡æ¨¡æ¿ï¼Œæ‰€ä»¥èµ°æ¨¡æ¿åŒ¹é…æå–å¹´ä»½å‚æ•°ï¼Œç›´æ¥æŸ¥æ•°ç„¶åé€šè¿‡ä¸šåŠ¡åˆ¤æ–­å­˜åœ¨æ•°æ®ï¼Œèµ°Analysis Agentåˆ†æã€‚</p>
<p>ç¬¬ä¸‰è½®é—®é¢˜ï¼šå½•å–äººæ•°å‘¢ï¼Ÿ</p>
<p>ç¬¬ä¸‰è½®æˆ‘ä»¬è¿½é—®å½•å–äººæ•°ï¼Œä½†æ˜¯åŒ¹é…ä¸åˆ°æ¨¡æ¿ï¼Œæ‰€ä»¥ä¸Šå±‚ä¸šåŠ¡åˆ¤æ–­èµ°Rewrite AgentÂ +Â SQL AgentÂ +Â Analysis Agentæ”¹å†™é—®é¢˜å®Œå–„æ¡ä»¶ã€‚æ”¹å†™æ—¶ï¼Œå‚è€ƒMemoryä¸­ä¸Šä¸‹æ–‡2016å’Œ2018å¹´å›ç­”ï¼Œæ”¹å†™ä¸º2018å¹´å…¨å›½é«˜è€ƒå½•å–äººæ•°æ˜¯å¤šå°‘ï¼Ÿç„¶åèµ°RAGæ£€ç´¢ã€ç”ŸæˆSQLã€æŸ¥æ•°ã€åˆ†æã€‚</p>
<h3 data-id="heading-2"><strong>ğŸ§© AgentScopeå®ç°å°ç»“</strong></h3>
<p>AgentScopeÂ æä¾›äº†ä¸€ä¸ªé¢å‘å¤šæ™ºèƒ½ä½“åä½œçš„å¼€å‘æ¡†æ¶ï¼Œæ ¸å¿ƒæ˜¯ã€Œæ¶ˆæ¯é©±åŠ¨ + ç®¡é“å¼æ‰§è¡Œã€æ¨¡å‹ï¼š</p>
<ul>
<li>é€šè¿‡Â sequential_pipeline()Â ä¸²è”å¤šä¸ª Agentï¼Œæ¯ä¸ªæ™ºèƒ½ä½“åªéœ€å®ç°Â reply()Â æ–¹æ³•ã€‚</li>
<li>ä½¿ç”¨Â MsgÂ å¯¹è±¡å°è£…ä¸Šä¸‹æ–‡ï¼Œæ”¯æŒå¤šæ¨¡æ€å†…å®¹ï¼ˆæ–‡æœ¬ã€ç»“æ„åŒ–æ•°æ®ç­‰ï¼‰ã€‚</li>
<li>æ¯ä¸ªæ™ºèƒ½ä½“å†…éƒ¨InMemoryMemoryÂ æä¾›ä¸Šä¸‹æ–‡è®°å¿†ï¼Œå¯å®ç°å¤šè½®å¯¹è¯è¿½é—®ã€‚</li>
<li>å¤šä¸ªæ™ºèƒ½ä½“ä¹‹é—´é€šè¿‡è‡ªå®šä¹‰å…¨å±€å˜é‡Stateï¼Œå®ç°è·¨è½®æ¬¡è·¨æ™ºèƒ½ä½“çš„ç»“æ„åŒ–å‚æ•°ä¼ é€’ã€‚</li>
<li>åˆ©ç”¨OllamaChatFormatterÂ è‡ªåŠ¨æ‹¼è£… System Prompt + å†å²è®°å¿†ï¼Œå®ç°è¯­ä¹‰è¿ç»­æ€§ã€‚</li>
</ul>
<p>ç‰¹ç‚¹ï¼š</p>
<ul>
<li>ä¸Šæ‰‹å¿«ã€API ç®€æ´ï¼Œé€‚åˆå¿«é€Ÿæ­å»ºå¤šæ™ºèƒ½ä½“åº”ç”¨ã€‚</li>
<li>å†…ç½®å¼‚æ­¥æµå¼è¾“å‡ºï¼Œå¯ç›´æ¥æ‰“å°æ¨¡å‹â€œæ€è€ƒè¿‡ç¨‹â€ã€‚</li>
<li>å¼ºè°ƒã€ŒèŒè´£åˆ†ç¦»ã€ï¼šæ¯ä¸ª Agent åªè´Ÿè´£ä¸€ç±»ä»»åŠ¡ã€‚</li>
</ul>
<p>é€‚ç”¨åœºæ™¯Â é€‚åˆå¯¹ã€Œæ™ºèƒ½ä½“èŒè´£æ¸…æ™°ã€ã€Œè°ƒç”¨é“¾å›ºå®šã€çš„ä»»åŠ¡ã€‚</p>
<h3 data-id="heading-3"><strong>é™„å½•ï¼šAgentScopeä¸­ä¸»è¦ç®¡é“ç±»å‹</strong></h3>
<p>AgentScopeä¸­ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ç±»ç®¡é“ï¼š</p>
<h4 data-id="heading-4">1ï¼‰é¡ºåº Pipeline (sequential_pipelineÂ /Â SequentialPipeline)</h4>
<p>å‡½æ•°å¼è°ƒç”¨ï¼šä½¿ç”¨Â sequential_pipeline(agents=[...], msg=...)ã€‚</p>
<ul>
<li>agentsÂ å‚æ•°ï¼šä¸€ä¸ª agent åˆ—è¡¨ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œã€‚</li>
<li>msgÂ å‚æ•°ï¼šåˆå§‹æ¶ˆæ¯ï¼ˆå¯ä»¥æ˜¯Â NoneÂ æˆ–ä¸€ä¸ªÂ MsgÂ å®ä¾‹ï¼‰ä½œä¸ºç¬¬ä¸€ä¸ª agent çš„è¾“å…¥ã€‚</li>
<li>è¿”å›å€¼ï¼šæœ€åä¸€ä¸ª agent çš„è¾“å‡ºæ¶ˆæ¯ã€‚</li>
</ul>
<p>ç±»å¼è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">pipeline</span> = SequentialPipeline(agents=[...])
<span class="hljs-attr">msg</span> =Â awaitÂ pipeline(msg=initial_msg)
</code></pre>
<ul>
<li>å¯ä»¥å¤šæ¬¡è°ƒç”¨Â pipeline(...)Â é‡ç”¨è¯¥æµæ°´çº¿ã€‚</li>
<li>é€‚ç”¨åœºæ™¯ï¼šä½ å¸Œæœ›ä¾æ¬¡å°†ä¸€ä¸ª agent çš„è¾“å‡ºä¼ ç»™ä¸‹ä¸€ä¸ª agentâ€”â€”å…¸å‹çš„æµæ°´çº¿æ¨¡å¼ã€‚</li>
</ul>
<h4 data-id="heading-5">2ï¼‰åˆ†å‘ï¼å¹¶è¡Œ Pipeline (fanout_pipelineÂ /Â FanoutPipeline)</h4>
<p>å‡½æ•°å¼è°ƒç”¨ï¼šÂ fanout_pipeline(agents=[...], msg=..., enable_gather=False|True)ã€‚</p>
<ul>
<li>å°†åŒä¸€ä¸ªè¾“å…¥Â msgÂ åˆ†å‘ç»™ agents åˆ—è¡¨ä¸­çš„æ¯ä¸€ä¸ªã€‚</li>
<li>è¿”å›å€¼ï¼šä¸€ä¸ªåˆ—è¡¨ï¼ˆæ¯ä¸ª agent çš„è¾“å‡ºæ¶ˆæ¯ï¼‰ã€‚</li>
<li>enable_gather=Trueï¼ˆé»˜è®¤ï¼‰ä¼šå¹¶å‘æ‰§è¡Œæ‰€æœ‰ agentï¼ˆåˆ©ç”¨Â asyncio.gather()ï¼‰ï¼Œé€‚åˆ I/O å¯†é›†å‹åœºæ™¯ã€‚</li>
<li>enable_gather=FalseÂ ä¼šé¡ºåºæ‰§è¡Œï¼Œä½†æ˜¯ä»æ˜¯åˆ†å‘æ¨¡å¼ï¼ˆæ¯ä¸ª agent æ¥æ”¶åŒä¸€ä¸ªè¾“å…¥ï¼‰ã€‚</li>
</ul>
<p>ç±»å¼è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">pipeline</span> = FanoutPipeline(agents=[...])
<span class="hljs-attr">msgs</span> =Â awaitÂ pipeline(msg=initial_msg)
</code></pre>
<ul>
<li>åŒæ ·å¯ä»¥é‡ç”¨ã€‚</li>
<li>é€‚ç”¨åœºæ™¯ï¼šä½ å¸Œæœ›å¤šä¸ª agent åŸºäºåŒä¸€ä¸ªè¾“å…¥åšâ€œå¹¶è¡Œè¯„ä¼°ï¼å¤šè§†è§’åˆ†æâ€ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ¥ä¸€ä¸ªã€‚</li>
</ul>
<h4 data-id="heading-6">3ï¼‰MsgHubÂ ä½¿ç”¨æ¨¡å¼</h4>
<ul>
<li>MsgHubÂ æ˜¯ä¸€ä¸ªå¼‚æ­¥ï¼ˆasyncï¼‰ä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œä¼ å…¥ä¸€ä¸ªÂ participantsÂ åˆ—è¡¨ï¼ˆagent å®ä¾‹åˆ—è¡¨ï¼‰å’Œä¸€ä¸ªÂ announcementÂ æ¶ˆæ¯ã€‚</li>
<li>åœ¨ä¸Šä¸‹æ–‡ï¼ˆasync with MsgHub(...) as hub:ï¼‰å†…éƒ¨ï¼Œå‚ä¸è€… agent å¯ä»¥äº’ç›¸â€œè§‚å¯Ÿâ€(observe) æ¶ˆæ¯ï¼Œæ— éœ€æ‰‹åŠ¨å°†ä¸€ä¸ª agent çš„è¾“å‡ºä¸“é—¨ä¼ ç»™å¦ä¸€ä¸ªã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨å¹¿æ’­ã€‚</li>
<li>MsgHubÂ æ”¯æŒåŠ¨æ€ç®¡ç†å‚ä¸è€…ï¼šé€šè¿‡Â hub.add(...),Â hub.delete(...)Â æ–¹æ³•ã€‚</li>
</ul>
<p>ç¤ºä¾‹ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">async</span>Â <span class="hljs-keyword">with</span>Â <span class="hljs-title">MsgHub</span>(<span class="hljs-params">participants=[alice, bob, charlie],
Â  Â  Â  Â  Â  Â  Â  Â  Â  announcement=Msg(<span class="hljs-string">"user"</span>,Â <span class="hljs-string">"Introduce yourselves."</span>,Â <span class="hljs-string">"user"</span></span>))Â <span class="hljs-keyword">as</span>Â hub:
Â  Â Â <span class="hljs-keyword">await</span>Â <span class="hljs-title">alice</span>()
Â  Â Â <span class="hljs-keyword">await</span>Â <span class="hljs-title">bob</span>()
Â  Â Â <span class="hljs-keyword">await</span>Â <span class="hljs-title">charlie</span>()
</span></code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œalice,bob,charlie ä¼šæ¥æ”¶åˆ°Â announcementï¼Œäº’ç›¸å¹¿æ’­æ¶ˆæ¯ï¼Œæ— éœ€æ‰‹åŠ¨ä¼ é€’ã€‚</p>
<p>æºç å‚è€ƒï¼šå‚ä¸åä½œçš„å››ä¸ªæ™ºèƒ½ä½“ï¼Œä»¥åŠå…·ä½“åä½œæ§åˆ¶é€»è¾‘ä»£ç ï¼Œè¯¦è§<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FMuKunZiAI%2Fcollege_entrance_ai%2Fblob%2Fmain%2Fagentscope_code%2Fagent_service_pipeline.py%25E3%2580%2582" target="_blank" title="https://github.com/MuKunZiAI/college_entrance_ai/blob/main/agentscope_code/agent_service_pipeline.py%E3%80%82" ref="nofollow noopener noreferrer">github.com/MuKunZiAI/câ€¦</a></p>
<p>æœ¬æ–‡æ€»ç»“ï¼šæœ¬æ–‡é€šè¿‡é«˜è€ƒä¿¡æ¯æ™ºèƒ½æŸ¥è¯¢çš„ä¸šåŠ¡åœºæ™¯ï¼ŒåŸºäºAgentScopeå¼€å‘æ¡†æ¶å®è·µå¤šæ™ºèƒ½ä½“åä½œæœºåˆ¶ï¼Œé€šè¿‡ç®¡é“+æ§åˆ¶é€»è¾‘è¿›è¡Œåä½œï¼Œé€šè¿‡ä¸Šä¸‹æ–‡è®°å¿†+å…¨å±€å˜é‡å®ç°å¤šè½®å¯¹è¯å’Œè·¨æ™ºèƒ½ä½“ä¹‹é—´å‚æ•°ä¼ é€’ï¼Œæœ€ååˆ†äº«äº†AgentScopeçš„å‡ ç§ç®¡é“ç±»å‹ã€‚ä¸‹ä¸€ç¯‡åŸºäºLangGraphæ¡†æ¶çš„å¤šæ™ºèƒ½ä½“åä½œæœºåˆ¶å®è·µï¼Œæ•¬è¯·æœŸå¾…ã€‚</p>
<p>æœ¬æ–‡ä½œè€…ï¼šChaiys</p>
<p>æœ¬æ–‡åŸè½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FO9wC9aU3iQ98Wij6C-AvWw" target="_blank" title="https://mp.weixin.qq.com/s/O9wC9aU3iQ98Wij6C-AvWw" ref="nofollow noopener noreferrer">å…¬ä¼—å·â€œæœ¨æ˜†å­è®°å½•AIâ€</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç›‘æ§ä¸æ˜¯æ—¥å¿—ï¼šPrometheus é«˜åŸºæ•°é¿å‘æŒ‡å—]]></title>    <link>https://juejin.cn/post/7591715454135238719</link>    <guid>https://juejin.cn/post/7591715454135238719</guid>    <pubDate>2026-01-06T02:21:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591715454135238719" data-draft-id="7591730714140950570" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç›‘æ§ä¸æ˜¯æ—¥å¿—ï¼šPrometheus é«˜åŸºæ•°é¿å‘æŒ‡å—"/> <meta itemprop="keywords" content="åç«¯,ç®—æ³•,ç›‘æ§"/> <meta itemprop="datePublished" content="2026-01-06T02:21:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¸æµªæ— ç—•"/> <meta itemprop="url" content="https://juejin.cn/user/2834988091055719"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç›‘æ§ä¸æ˜¯æ—¥å¿—ï¼šPrometheus é«˜åŸºæ•°é¿å‘æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2834988091055719/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¸æµªæ— ç—•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T02:21:47.000Z" title="Tue Jan 06 2026 02:21:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä» TSDB åŸç†åˆ°å®æˆ˜æ¡ˆä¾‹ï¼Œå¸®åŠ©ä½ ç†è§£ä¸ºä»€ä¹ˆä¸èƒ½ä½¿ç”¨é«˜åŸºæ•°æ ‡ç­¾ï¼Œä»¥åŠå¦‚ä½•æ­£ç¡®è®¾è®¡ç›‘æ§æŒ‡æ ‡ã€‚ä¸€æ¬¡æ€§è§£å†³ Prometheus æŸ¥è¯¢æ…¢ã€å†…å­˜çˆ†ç‚¸çš„æ ¹æœ¬é—®é¢˜ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ä¸€ã€å…ˆé—®ä¸€ä¸ªé—®é¢˜ï¼šä¸ºä»€ä¹ˆæŸ¥è¯¢ä¼šå˜æ…¢ï¼Ÿ</h2>
<p>æƒ³è±¡ä¸€ä¸ªåœºæ™¯ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">ä½ çš„ç”µå•†ç³»ç»Ÿç›‘æ§çªç„¶å˜æ…¢äº†ï¼š
- ä»¥å‰æŸ¥è¯¢ sum(order_total) åªè¦ 10ms
- ç°åœ¨éœ€è¦ 30 ç§’ï¼Œç»å¸¸è¶…æ—¶
- Prometheus å†…å­˜ä» 2GB æ¶¨åˆ° 16GB
- å‘Šè­¦å»¶è¿Ÿï¼Œè¿ç»´åŠå¤œè¢«å«é†’

ç½ªé­ç¥¸é¦–ï¼š
order_total{<span class="hljs-attr">user_id</span>=<span class="hljs-string">"10086"</span>}  <span class="hljs-comment"># ç»™æ¯ä¸ªç”¨æˆ·éƒ½åˆ›å»ºäº†ç‹¬ç«‹æ—¶åº</span>
order_total{<span class="hljs-attr">user_id</span>=<span class="hljs-string">"10087"</span>}
...
<span class="hljs-comment"># 100ä¸‡ç”¨æˆ· = 100ä¸‡æ¡æ—¶åºï¼</span>
</code></pre>
<p><strong>æ ¸å¿ƒé—®é¢˜ï¼šä¸ºä»€ä¹ˆåŠ ä¸ª user_id æ ‡ç­¾å°±ç‚¸äº†ï¼Ÿ</strong></p>
<p>è¦ç†è§£è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å…ˆç”¨å¤§ç™½è¯è®²æ¸…æ¥š Prometheus æ˜¯æ€ä¹ˆå­˜å‚¨æ•°æ®çš„ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€å¤§ç™½è¯ç±»æ¯”ï¼šè¶…å¸‚è¿ä½œæ¨¡å‹</h2>
<h3 data-id="heading-2">2.1 Prometheus = ä¸€å®¶è¶…å¸‚</h3>
<p>æŠŠ Prometheus TSDB æƒ³è±¡æˆä¸€å®¶è¶…å¸‚ï¼Œå°±å¾ˆå¥½ç†è§£äº†ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    subgraph Frontend["å‰å° (å†…å­˜)"]
        CAT["å•†å“ç›®å½•å†Œ
        å¯ä¹åœ¨B2è´§æ¶"]
        SHELF["è´§æ¶é™ˆåˆ—åŒº
        çƒ­é”€å•†å“æ‘†å‰é¢"]
    end
    
    subgraph Backend["åå° (ç£ç›˜)"]
        WAREHOUSE["å¤§ä»“åº“
        æ•´ç®±å‹ç¼©å­˜æ”¾"]
        LOG["å‡ºå…¥åº“è®°å½•
        é˜²æ­¢æ–­ç”µä¸¢å¤±"]
    end
    
    Frontend -.å®šæœŸå…¥åº“.-&gt; Backend
    
    style Frontend fill:#e8f5e9,stroke:#4caf50,stroke-width:3px
    style Backend fill:#fff3e0,stroke:#ff9800,stroke-width:3px
    style CAT fill:#c8e6c9,stroke:#4caf50
    style SHELF fill:#c8e6c9,stroke:#4caf50
    style WAREHOUSE fill:#ffe0b2,stroke:#ff9800
    style LOG fill:#ffe0b2,stroke:#ff9800
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">åœºæ™¯ï¼šé¡¾å®¢è¦ä¹°å¯ä¹

æ–¹æ¡ˆAï¼ˆå…¨æ”¾ä»“åº“ï¼‰ï¼š
é¡¾å®¢ï¼š<span class="hljs-string">"è¦å¯ä¹"</span>
åº—å‘˜ï¼š<span class="hljs-string">"ç¨ç­‰ï¼Œæˆ‘å»ä»“åº“æ‰¾..."</span> â†’ <span class="hljs-number">10</span>åˆ†é’Ÿ
ç»“æœï¼šé¡¾å®¢ä¸ä¹°äº† âœ—

æ–¹æ¡ˆBï¼ˆå‰å°+åå°ï¼‰ï¼š
é¡¾å®¢ï¼š<span class="hljs-string">"è¦å¯ä¹"</span>
åº—å‘˜ï¼š<span class="hljs-string">"è´§æ¶ä¸Šæœ‰"</span> â†’ <span class="hljs-number">10</span>ç§’
ç»“æœï¼šç«‹åˆ»æˆäº¤ âœ“
</code></pre>
<p><strong>å¯¹åº”åˆ°ç›‘æ§ï¼š</strong></p>
<ul>
<li>å‘Šè­¦éœ€è¦å®æ—¶æŸ¥è¯¢ï¼ˆ&lt;100msï¼‰â†’ å¿…é¡»ç”¨å†…å­˜</li>
<li>å†å²åˆ†æå¯ä»¥æ…¢ç‚¹ï¼ˆå‡ ç§’ï¼‰â†’ ç£ç›˜è¶³å¤Ÿ</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">%%{init: {'theme':'base', 'themeVariables': { 'fontSize':'16px'}}}%%
graph TB
    subgraph Prometheus["Prometheus Server"]
        subgraph Memory["å†…å­˜å±‚ Head Block (æœ€è¿‘2å°æ—¶çƒ­æ•°æ®)"]
            SI["Series ç´¢å¼•è¡¨
            æ ‡ç­¾â†’IDæ˜ å°„"]
            PL["Posting Lists
            å€’æ’ç´¢å¼•"]
            AC["Active Chunks
            å‹ç¼©æ•°æ®å—"]
        end
        
        Compress["å®šæœŸå‹ç¼© (æ¯2å°æ—¶)"]
        
        subgraph Disk["ç£ç›˜å±‚ Persistent Blocks (é•¿æœŸå­˜å‚¨)"]
            IDX["index æ–‡ä»¶
            å€’æ’ç´¢å¼•æŒä¹…åŒ–"]
            CHK["chunks æ–‡ä»¶
            XOR å‹ç¼©æ•°æ®"]
            META["meta.json
            å—å…ƒæ•°æ®"]
        end
        
        Memory --&gt;|å‹ç¼©| Compress
        Compress --&gt;|æŒä¹…åŒ–| Disk
    end
    
    style Memory fill:#e1f5ff,stroke:#0288d1,stroke-width:3px
    style Disk fill:#fff3e0,stroke:#f57c00,stroke-width:3px
    style Compress fill:#f0f0f0,stroke:#666,stroke-width:2px
    style SI fill:#bbdefb,stroke:#0288d1
    style PL fill:#bbdefb,stroke:#0288d1
    style AC fill:#bbdefb,stroke:#0288d1
    style IDX fill:#ffe0b2,stroke:#f57c00
    style CHK fill:#ffe0b2,stroke:#f57c00
    style META fill:#ffe0b2,stroke:#f57c00
</code></pre>
<hr/>
<h2 data-id="heading-3">ä¸‰ã€æ­ç§˜çœŸå®æ¶æ„ï¼šTSDB çš„æŠ€æœ¯å®ç°</h2>
<p>å¥½ï¼Œç†è§£äº†è¶…å¸‚æ¨¡å‹åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ Prometheus çœŸå®çš„æŠ€æœ¯æ¶æ„ã€‚æœ‰äº†å‰é¢çš„é“ºå«ï¼Œè¿™å¼ å›¾ä½ å°±èƒ½çœ‹æ‡‚äº†ï¼š</p>
<h3 data-id="heading-4">3.1 å®è§‚æ¶æ„å›¾</h3>
<p>Prometheus é‡‡ç”¨<strong>å†…å­˜+ç£ç›˜</strong>çš„åˆ†å±‚å­˜å‚¨ï¼Œæ ¸å¿ƒè®¾è®¡æ€æƒ³æ˜¯ï¼š<strong>çƒ­æ•°æ®å¿«é€Ÿè®¿é—®ï¼Œå†·æ•°æ®å‹ç¼©å­˜å‚¨</strong>ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">%%{init: {'theme':'base', 'themeVariables': { 'fontSize':'16px'}}}%%
graph TB
    subgraph Prometheus["Prometheus Server"]
        subgraph Memory["å†…å­˜å±‚ Head Block (æœ€è¿‘2å°æ—¶çƒ­æ•°æ®)"]
            SI["Series ç´¢å¼•è¡¨
            æ ‡ç­¾â†’IDæ˜ å°„"]
            PL["Posting Lists
            å€’æ’ç´¢å¼•"]
            AC["Active Chunks
            å‹ç¼©æ•°æ®å—"]
        end
        
        Compress["å®šæœŸå‹ç¼© (æ¯2å°æ—¶)"]
        
        subgraph Disk["ç£ç›˜å±‚ Persistent Blocks (é•¿æœŸå­˜å‚¨)"]
            IDX["index æ–‡ä»¶
            å€’æ’ç´¢å¼•æŒä¹…åŒ–"]
            CHK["chunks æ–‡ä»¶
            XOR å‹ç¼©æ•°æ®"]
            META["meta.json
            å—å…ƒæ•°æ®"]
        end
        
        Memory --&gt;|å‹ç¼©| Compress
        Compress --&gt;|æŒä¹…åŒ–| Disk
    end
    
    style Memory fill:#e1f5ff,stroke:#0288d1,stroke-width:3px
    style Disk fill:#fff3e0,stroke:#f57c00,stroke-width:3px
    style Compress fill:#f0f0f0,stroke:#666,stroke-width:2px
    style SI fill:#bbdefb,stroke:#0288d1
    style PL fill:#bbdefb,stroke:#0288d1
    style AC fill:#bbdefb,stroke:#0288d1
    style IDX fill:#ffe0b2,stroke:#f57c00
    style CHK fill:#ffe0b2,stroke:#f57c00
    style META fill:#ffe0b2,stroke:#f57c00
</code></pre>
<p><strong>å¯¹åº”åˆ°è¶…å¸‚ï¼š</strong></p>
<ul>
<li><strong>Series ç´¢å¼•è¡¨</strong> = å•†å“ç›®å½•å†Œï¼ˆ"å¯ä¹åœ¨B2è´§æ¶"ï¼‰</li>
<li><strong>Posting Lists</strong> = åˆ†ç±»æ ‡ç­¾å¢™ï¼ˆ"é¥®æ–™ç±»ï¼šå¯ä¹ã€é›ªç¢§..."ï¼‰</li>
<li><strong>Active Chunks</strong> = å‰å°è´§æ¶ï¼ˆæœ€è¿‘è¿›è´§çš„å•†å“ï¼‰</li>
<li><strong>index/chunks æ–‡ä»¶</strong> = åå°å¤§ä»“åº“ï¼ˆæ•´ç®±å‹ç¼©å­˜æ”¾ï¼‰</li>
</ul>
<h3 data-id="heading-5">3.2 å…³é”®æ•°æ®ï¼šä»€ä¹ˆæ”¾å†…å­˜ï¼Œä»€ä¹ˆæ”¾ç£ç›˜ï¼Ÿ</h3>









































<table><thead><tr><th>æ•°æ®ç±»å‹</th><th>å­˜å‚¨ä½ç½®</th><th>å¤§å°ä¼°ç®—</th><th>é«˜åŸºæ•°å½±å“</th></tr></thead><tbody><tr><td>Series ç´¢å¼•</td><td>å†…å­˜</td><td>æ¯æ—¶åº 2-4 KB</td><td>ç›´æ¥è†¨èƒ€</td></tr><tr><td>å€’æ’ç´¢å¼•</td><td>å†…å­˜</td><td>éšæ ‡ç­¾å€¼å¢é•¿</td><td>æ€¥å‰§å¢é•¿</td></tr><tr><td>æœ€æ–°æ•°æ®ï¼ˆ2å°æ—¶å†…ï¼‰</td><td>å†…å­˜</td><td>æ¯æ—¶åº ~1 KB</td><td>çº¿æ€§å¢é•¿</td></tr><tr><td>å†å²æ•°æ®</td><td>ç£ç›˜</td><td>å‹ç¼©å 1:10</td><td>ç¢ç‰‡åŒ–</td></tr><tr><td>WALæ—¥å¿—</td><td>ç£ç›˜</td><td>æœªå‹ç¼©</td><td>å†™å…¥æ”¾å¤§</td></tr></tbody></table>
<p><strong>æ ¸å¿ƒå…¬å¼ï¼š</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">å†…å­˜å ç”¨</span> <span class="hljs-string">â‰ˆ</span> <span class="hljs-string">æ—¶åºæ€»æ•°</span> <span class="hljs-string">Ã—</span> <span class="hljs-number">3</span> <span class="hljs-string">KB</span>
<span class="hljs-string">æ¨èä¸Šé™ï¼šå•å®ä¾‹</span> <span class="hljs-string">&lt;</span> <span class="hljs-number">1000</span> <span class="hljs-string">ä¸‡æ—¶åº</span>
</code></pre>
<p><strong>ç°åœ¨å†çœ‹å¼€å¤´çš„é—®é¢˜ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">order_total{<span class="hljs-attr">user_id</span>=<span class="hljs-string">"10086"</span>}  <span class="hljs-comment"># 100ä¸‡ç”¨æˆ· = 100ä¸‡ä¸ª Series</span>
â†“
Series ç´¢å¼•è¡¨ï¼š100ä¸‡ Ã— <span class="hljs-attr">3KB</span> = <span class="hljs-number">3</span>GBï¼ˆä»…ç´¢å¼•å°±çˆ†äº†ï¼ï¼‰
æŸ¥è¯¢æ—¶è¦éå† 100ä¸‡ä¸ªè´§æ¶ä½ â†’ 30ç§’è¶…æ—¶
</code></pre>
<h3 data-id="heading-6">3.4 å†…å­˜ç»“æ„è¯¦è§£</h3>
<p><strong>Series ç´¢å¼•è¡¨ = å•†å“æ€»ç›®å½•</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph Normal["æ­£å¸¸å•†å“ç›®å½•"]
        N1["å¯ä¹(ç“¶è£…) â†’ B2è´§æ¶
        å¯¹åº”: (method='GET') â†’ ID:1"]
        N2["å¯ä¹(ç½è£…) â†’ B3è´§æ¶
        å¯¹åº”: (method='POST') â†’ ID:2"]
    end
    
    subgraph HighCard["âŒ é«˜åŸºæ•°é—®é¢˜"]
        H1["å¼ ä¸‰çš„å¯ä¹ â†’ A1è´§æ¶
        å¯¹åº”: (user_id='10086') â†’ ID:1"]
        H2["æå››çš„å¯ä¹ â†’ A2è´§æ¶
        å¯¹åº”: (user_id='10087') â†’ ID:2"]
        H3["ç‹äº”çš„å¯ä¹ â†’ A3è´§æ¶
        å¯¹åº”: (user_id='10088') â†’ ID:3"]
        H4["... 100ä¸‡ä¸ªé¡¾å®¢"]
    end
    
    style Normal fill:#c8e6c9,stroke:#4caf50,stroke-width:3px
    style HighCard fill:#ffcdd2,stroke:#f44336,stroke-width:3px
    style N1 fill:#a5d6a7,stroke:#2e7d32
    style N2 fill:#a5d6a7,stroke:#2e7d32
    style H1 fill:#ef9a9a,stroke:#c62828
    style H2 fill:#ef9a9a,stroke:#c62828
    style H3 fill:#ef9a9a,stroke:#c62828
    style H4 fill:#ef9a9a,stroke:#c62828
</code></pre>
<p><strong>Posting Lists = åˆ†ç±»æ ‡ç­¾å¢™</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    subgraph Drink["é¥®æ–™ç±»"]
        D1[å¯ä¹]
        D2[é›ªç¢§]
        D3[ç‰›å¥¶]
    end
    
    subgraph Snack["é›¶é£Ÿç±»"]
        S1[è–¯ç‰‡]
        S2[é¥¼å¹²]
        S3[å·§å…‹åŠ›]
    end
    
    subgraph HighCard["âŒ é«˜åŸºæ•°: ç”¨æˆ·æ ‡ç­¾"]
        U1["user_id=10086
        SeriesID:100001"]
        U2["user_id=10087
        SeriesID:100002"]
        U3["user_id=10088
        SeriesID:100003"]
        U4["... 100ä¸‡ä¸ªæ ‡ç­¾"]
    end
    
    style Drink fill:#e1f5ff,stroke:#0288d1,stroke-width:2px
    style Snack fill:#f3e5f5,stroke:#9c27b0,stroke-width:2px
    style HighCard fill:#ffcdd2,stroke:#f44336,stroke-width:3px
    style D1 fill:#bbdefb,stroke:#0288d1
    style D2 fill:#bbdefb,stroke:#0288d1
    style D3 fill:#bbdefb,stroke:#0288d1
    style S1 fill:#e1bee7,stroke:#9c27b0
    style S2 fill:#e1bee7,stroke:#9c27b0
    style S3 fill:#e1bee7,stroke:#9c27b0
    style U1 fill:#ef9a9a,stroke:#c62828
    style U2 fill:#ef9a9a,stroke:#c62828
    style U3 fill:#ef9a9a,stroke:#c62828
    style U4 fill:#ef9a9a,stroke:#c62828
</code></pre>
<hr/>
<h2 data-id="heading-7">å››ã€ç”µå•†åœºæ™¯ï¼šå¥½ä¸åçš„æŒ‡æ ‡è®¾è®¡</h2>
<h3 data-id="heading-8">4.1 è®¢å•ç›‘æ§</h3>
<h4 data-id="heading-9">åé¢æ¡ˆä¾‹ï¼šæ¯ä¸ªç”¨æˆ·ã€æ¯ä¸ªè®¢å•éƒ½æ˜¯ç‹¬ç«‹æ—¶åº</h4>
<pre><code class="hljs language-prometheus" lang="prometheus"># é”™è¯¯è®¾è®¡
order_created{
  user_id="10086",           # 100ä¸‡ä¸ªç”¨æˆ·
  order_id="20240501001",    # æ¯å¤©50ä¸‡è®¢å•
  product_id="SKU12345"      # 10ä¸‡ä¸ªå•†å“
}

é—®é¢˜åˆ†æï¼š
â”œâ”€ æ—¶åºæ•°é‡ï¼š100ä¸‡ç”¨æˆ· Ã— 1ä¸ªæŒ‡æ ‡ = 100ä¸‡æ—¶åº
â”œâ”€ å†…å­˜å ç”¨ï¼š100ä¸‡ Ã— 3KB = 3GBï¼ˆä»…ç´¢å¼•ï¼‰
â”œâ”€ æŸ¥è¯¢å»¶è¿Ÿï¼šsum(order_created) â†’ 30ç§’è¶…æ—¶
â””â”€ å­˜å‚¨æµªè´¹ï¼šå¤§éƒ¨åˆ†è®¢å•åªæœ‰1ä¸ªæ ·æœ¬ç‚¹
</code></pre>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph Bad["âŒ é”™è¯¯è®¾è®¡: é«˜åŸºæ•°"]
        B1["user_id='10086'
        100ä¸‡ä¸ªç”¨æˆ·"]
        B2["order_id='ABC123'
        æ¯å¤©50ä¸‡è®¢å•"]
        B3["product_id='SKU001'
        10ä¸‡ä¸ªå•†å“"]
        
        Result1["æ—¶åºæ•°: 100ä¸‡+
        å†…å­˜: 3GB
        æŸ¥è¯¢: 30ç§’è¶…æ—¶"]
    end
    
    B1 &amp; B2 &amp; B3 --&gt; Result1
    
    style Bad fill:#ffcdd2,stroke:#f44336,stroke-width:3px
    style B1 fill:#ef9a9a,stroke:#c62828
    style B2 fill:#ef9a9a,stroke:#c62828
    style B3 fill:#ef9a9a,stroke:#c62828
    style Result1 fill:#ffebee,stroke:#c62828,stroke-width:2px
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆé”™ï¼Ÿ</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    Problem[è¶…å¸‚ç±»æ¯”] --&gt; P1["æ¯ä¸ªé¡¾å®¢çš„
    æ¯ä»¶å•†å“éƒ½å•ç‹¬ä¸Šæ¶"]
    P1 --&gt; P2["å¼ ä¸‰çš„å¯ä¹
    æå››çš„å¯ä¹
    ç‹äº”çš„å¯ä¹..."]
    P2 --&gt; P3["å•†å“ç›®å½•1000é¡µ
    è´§æ¶çˆ†æ»¡"]
    
    style Problem fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    style P1 fill:#ffccbc,stroke:#ff5722
    style P2 fill:#ffccbc,stroke:#ff5722
    style P3 fill:#ffcdd2,stroke:#f44336,stroke-width:3px
</code></pre>
<h4 data-id="heading-10">æ­£é¢æ¡ˆä¾‹ï¼šèšåˆç»´åº¦</h4>
<pre><code class="hljs language-prometheus" lang="prometheus"># æ­£ç¡®è®¾è®¡
order_created_total{
  source="app|web|miniprogram",      # 3ä¸ªå€¼
  payment_method="alipay|wechat",    # 5ä¸ªå€¼
  product_category="electronics"     # 20ä¸ªä¸€çº§ç±»ç›®
}

ä¼˜åŠ¿ï¼š
â”œâ”€ æ—¶åºæ•°é‡ï¼š3 Ã— 5 Ã— 20 = 300æ—¶åº
â”œâ”€ å†…å­˜å ç”¨ï¼š300 Ã— 3KB = 900KB
â”œâ”€ æŸ¥è¯¢å»¶è¿Ÿï¼šsum(order_created_total) â†’ 10ms
â””â”€ å­˜å‚¨æ•ˆç‡ï¼šæ ·æœ¬ç‚¹å¯†é›†ï¼Œå‹ç¼©ç‡é«˜
</code></pre>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph Good["âœ“ æ­£ç¡®è®¾è®¡: ä½åŸºæ•°"]
        G1["source
        3ä¸ªå€¼"]
        G2["payment_method
        5ä¸ªå€¼"]
        G3["product_category
        20ä¸ªç±»ç›®"]
        
        Result2["æ—¶åºæ•°: 300
        å†…å­˜: 900KB
        æŸ¥è¯¢: 10ms"]
    end
    
    G1 &amp; G2 &amp; G3 --&gt; Result2
    
    style Good fill:#c8e6c9,stroke:#4caf50,stroke-width:3px
    style G1 fill:#a5d6a7,stroke:#2e7d32
    style G2 fill:#a5d6a7,stroke:#2e7d32
    style G3 fill:#a5d6a7,stroke:#2e7d32
    style Result2 fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆå¯¹ï¼Ÿ</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    Solution[è¶…å¸‚ç±»æ¯”] --&gt; S1[æŒ‰å•†å“ç±»å‹åˆ†ç±»]
    S1 --&gt; S2["ç“¶è£…å¯ä¹
    ç½è£…å¯ä¹
    ..."]
    S2 --&gt; S3["å•†å“ç›®å½•1é¡µ
    æ¸…æ™°æ˜äº†"]
    
    style Solution fill:#e8f5e9,stroke:#4caf50,stroke-width:2px
    style S1 fill:#c8e6c9,stroke:#66bb6a
    style S2 fill:#c8e6c9,stroke:#66bb6a
    style S3 fill:#a5d6a7,stroke:#2e7d32,stroke-width:3px
</code></pre>
<h3 data-id="heading-11">4.2 æ¥å£æ€§èƒ½ç›‘æ§</h3>
<h4 data-id="heading-12">åé¢æ¡ˆä¾‹ï¼šåŠ¨æ€URLè·¯å¾„</h4>
<pre><code class="hljs language-prometheus" lang="prometheus"># é”™è¯¯è®¾è®¡
api_request_duration{
  path="/api/order/10086/detail",    # æ¯ä¸ªè®¢å•å·ä¸€ä¸ªè·¯å¾„
  path="/api/order/10087/detail",
  path="/api/user/20001/profile",    # æ¯ä¸ªç”¨æˆ·IDä¸€ä¸ªè·¯å¾„
  ...
}

é—®é¢˜ï¼š
â”œâ”€ URLæ•°é‡ï¼šæ¯å¤©å‡ åä¸‡ä¸ªä¸åŒè·¯å¾„
â”œâ”€ æ—¶åºçˆ†ç‚¸ï¼šæ¯ä¸ªè·¯å¾„ä¸€æ¡æ—¶åº
â””â”€ æ— æ³•èšåˆï¼šsum() æ¯«æ— æ„ä¹‰
</code></pre>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    URL1["api/order/10086/detail"] --&gt; TS1["æ—¶åº1"]
    URL2["api/order/10087/detail"] --&gt; TS2["æ—¶åº2"]
    URL3["api/order/10088/detail"] --&gt; TS3["æ—¶åº3"]
    URL4["... æ¯å¤©50ä¸‡ä¸ªURL"] --&gt; TS4["... 50ä¸‡æ—¶åº"]
    
    TS1 &amp; TS2 &amp; TS3 &amp; TS4 --&gt; Problem["âŒ æ— æ³•èšåˆ
    æŸ¥è¯¢è¶…æ—¶"]
    
    style URL1 fill:#ffccbc,stroke:#ff5722
    style URL2 fill:#ffccbc,stroke:#ff5722
    style URL3 fill:#ffccbc,stroke:#ff5722
    style URL4 fill:#ffccbc,stroke:#ff5722
    style TS1 fill:#ef9a9a,stroke:#c62828
    style TS2 fill:#ef9a9a,stroke:#c62828
    style TS3 fill:#ef9a9a,stroke:#c62828
    style TS4 fill:#ef9a9a,stroke:#c62828
    style Problem fill:#ffcdd2,stroke:#f44336,stroke-width:3px
</code></pre>
<h4 data-id="heading-13">æ­£é¢æ¡ˆä¾‹ï¼šè·¯å¾„å½’ä¸€åŒ–</h4>
<pre><code class="hljs language-prometheus" lang="prometheus"># æ­£ç¡®è®¾è®¡
api_request_duration{
  path="/api/order/{id}/detail",     # æ¨¡æ¿åŒ–
  method="GET",
  status="200|500"
}

å®ç°æ–¹å¼ï¼š
åœ¨åº”ç”¨ä»£ç æˆ–ç½‘å…³å±‚åšè·¯å¾„å½’ä¸€åŒ–ï¼š
/api/order/10086/detail  â†’ /api/order/{id}/detail
/api/user/20001/profile  â†’ /api/user/{id}/profile
</code></pre>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    URL1["api/order/10086/detail"] --&gt; Normalize
    URL2["api/order/10087/detail"] --&gt; Normalize
    URL3["api/order/10088/detail"] --&gt; Normalize
    
    Normalize["è·¯å¾„å½’ä¸€åŒ–"] --&gt; Template["api/order/{id}/detail"]
    Template --&gt; TS["âœ“ 1ä¸ªèšåˆæ—¶åº
    æŸ¥è¯¢å¿«é€Ÿ"]
    
    style URL1 fill:#bbdefb,stroke:#0288d1
    style URL2 fill:#bbdefb,stroke:#0288d1
    style URL3 fill:#bbdefb,stroke:#0288d1
    style Normalize fill:#fff9c4,stroke:#fbc02d,stroke-width:2px
    style Template fill:#c8e6c9,stroke:#4caf50,stroke-width:2px
    style TS fill:#a5d6a7,stroke:#2e7d32,stroke-width:3px
</code></pre>
<h3 data-id="heading-14">4.3 åº“å­˜ç›‘æ§</h3>
<h4 data-id="heading-15">åé¢æ¡ˆä¾‹ï¼šå•†å“çº§åˆ«ç›‘æ§</h4>
<pre><code class="hljs language-prometheus" lang="prometheus"># é”™è¯¯è®¾è®¡
inventory_level{
  product_id="SKU001",      # 10ä¸‡ä¸ªSKU
  warehouse_id="WH001",     # 100ä¸ªä»“åº“
  location="A-01-05"        # 1ä¸‡ä¸ªè´§ä½
}

æ—¶åºæ•°ï¼š10ä¸‡ Ã— 100 Ã— 1ä¸‡ = 1000äº¿ï¼ˆç†è®ºå€¼ï¼‰
å®é™…ï¼šå³ä½¿åªæœ‰éƒ¨åˆ†ç»„åˆï¼Œä¹Ÿæœ‰ç™¾ä¸‡çº§æ—¶åº
</code></pre>
<h4 data-id="heading-16">æ­£é¢æ¡ˆä¾‹ï¼šåˆ†å±‚ç›‘æ§</h4>
<pre><code class="hljs language-prometheus" lang="prometheus"># å®è§‚ç›‘æ§ï¼ˆä½åŸºæ•°ï¼‰
inventory_health{
  category="electronics",       # 20ä¸ªç±»ç›®
  warehouse_region="south",     # 5ä¸ªå¤§åŒº
  stock_status="low|normal|high" # 3ä¸ªçŠ¶æ€
}

# è¯¦ç»†ç›‘æ§ï¼ˆä»…Topå•†å“ï¼‰
inventory_detail{
  product_id="SKU001",          # ä»…ç›‘æ§Top 1000å•†å“
  warehouse_id="WH001"
}
</code></pre>
<h3 data-id="heading-17">4.4 å¯¹æ¯”æ€»ç»“</h3>



































<table><thead><tr><th>ç»´åº¦</th><th>åé¢æ¡ˆä¾‹</th><th>æ­£é¢æ¡ˆä¾‹</th><th>å·®è·</th></tr></thead><tbody><tr><td>æ—¶åºæ•°é‡</td><td>100ä¸‡+</td><td>300-1000</td><td>1000å€</td></tr><tr><td>å†…å­˜å ç”¨</td><td>3GB+</td><td>&lt;5MB</td><td>600å€</td></tr><tr><td>æŸ¥è¯¢å»¶è¿Ÿ</td><td>30ç§’+</td><td>10-50ms</td><td>3000å€</td></tr><tr><td>å‘Šè­¦å“åº”</td><td>ç»å¸¸è¶…æ—¶</td><td>å®æ—¶</td><td>-</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-18">äº”ã€å‘Šè­¦åœºæ™¯çš„å…±æ€§æŠ½å–</h2>
<h3 data-id="heading-19">5.1 å‘Šè­¦çš„æœ¬è´¨éœ€æ±‚</h3>
<p>Prometheus ä½œä¸ºå‘Šè­¦ç³»ç»Ÿï¼Œæ ¸å¿ƒéœ€æ±‚æ˜¯ï¼š</p>
<pre><code class="hljs">å¿«é€Ÿå›ç­”ï¼šç³»ç»Ÿå‡ºäº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ
è€Œä¸æ˜¯ï¼šè°åœ¨ä»€ä¹ˆæ—¶å€™åšäº†ä»€ä¹ˆï¼Ÿ
</code></pre>
<p><strong>å®é™…æ¡ˆä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java">å‘Šè­¦éœ€æ±‚                        éœ€è¦çš„ç»´åº¦              ä¸éœ€è¦çš„ç»´åº¦
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
è®¢å•æ”¯ä»˜å¤±è´¥ç‡è¶…<span class="hljs-number">5</span>%              payment_method          user_id, order_id
                               error_type              
                               
APIå»¶è¿ŸP99è¶…<span class="hljs-number">1</span>ç§’                 service_name            request_id
                               <span class="hljs-title function_">endpoint</span> <span class="hljs-params">(å½’ä¸€åŒ–)</span>        user_id
                               
åº“å­˜æ°´ä½ä½äºé˜ˆå€¼                category                product_id
                               warehouse_region        å…·ä½“è´§ä½
</code></pre>
<h3 data-id="heading-20">5.2 å‘Šè­¦æŒ‡æ ‡çš„è®¾è®¡è§„å¾‹</h3>
<h4 data-id="heading-21">è§„å¾‹1ï¼šèšåˆç»´åº¦ï¼Œè€Œéæ˜ç»†ç»´åº¦</h4>
<pre><code class="hljs language-ini" lang="ini">æ€è€ƒï¼šä½ éœ€è¦çŸ¥é“"å“ªäº›è®¢å•å¤±è´¥äº†"ï¼Œè¿˜æ˜¯"ä¸ºä»€ä¹ˆå¤±è´¥"ï¼Ÿ

é”™è¯¯ï¼š
alert: order_failed{<span class="hljs-attr">order_id</span>=<span class="hljs-string">"xxx"</span>} &gt; <span class="hljs-number">0</span>
â†’ æ¯ä¸ªè®¢å•éƒ½å‘Šè­¦ï¼Œæ— æ³•å¤„ç†

æ­£ç¡®ï¼š
alert: rate(order_failed_total{<span class="hljs-attr">reason</span>=<span class="hljs-string">"timeout"</span>}[<span class="hljs-number">5</span>m]) &gt; <span class="hljs-number">0.05</span>
â†’ è¶…æ—¶å¯¼è‡´çš„å¤±è´¥ç‡è¶…5%ï¼Œç«‹åˆ»ä¿®å¤
</code></pre>
<h4 data-id="heading-22">è§„å¾‹2ï¼šæŠ€æœ¯ç»´åº¦æ¯”ä¸šåŠ¡æ˜ç»†é‡è¦</h4>
<p><strong>å¿…é€‰ç»´åº¦ï¼ˆæŠ€æœ¯è¿ç»´ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">service</span>=<span class="hljs-string">"order-service"</span>     <span class="hljs-comment"># å“ªä¸ªæœåŠ¡</span>
<span class="hljs-attr">instance</span>=<span class="hljs-string">"10.0.1.5:9090"</span>   <span class="hljs-comment"># å“ªå°æœºå™¨</span>
<span class="hljs-attr">environment</span>=<span class="hljs-string">"production"</span>    <span class="hljs-comment"># å“ªä¸ªç¯å¢ƒ</span>
</code></pre>
<p><strong>å¯é€‰ç»´åº¦ï¼ˆä¸šåŠ¡èšåˆï¼‰ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">payment_method</span>=<span class="hljs-string">"alipay"</span>    <span class="hljs-comment"># æ”¯ä»˜æ–¹å¼</span>
<span class="hljs-attr">category</span>=<span class="hljs-string">"electronics"</span>     <span class="hljs-comment"># å•†å“ç±»ç›®</span>
<span class="hljs-attr">region</span>=<span class="hljs-string">"åå—"</span>              <span class="hljs-comment"># åœ°åŸŸ</span>
</code></pre>
<p><strong>ç¦ç”¨ç»´åº¦ï¼ˆä¸šåŠ¡æ˜ç»†ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">user_id                    <span class="hljs-comment"># ç”¨æˆ·ID â†’ æ”¾æ—¥å¿—</span>
order_id                   <span class="hljs-comment"># è®¢å•å· â†’ æ”¾æ—¥å¿—</span>
product_id                 <span class="hljs-comment"># å•†å“ID â†’ æ”¾æ—¥å¿—ï¼ˆé™¤éTopå•†å“ï¼‰</span>
</code></pre>
<h4 data-id="heading-23">è§„å¾‹3ï¼šçŠ¶æ€èšåˆï¼Œè€ŒéçŠ¶æ€ç©·ä¸¾</h4>
<pre><code class="hljs language-ini" lang="ini">åé¢ï¼š
<span class="hljs-attr">order_status</span>=<span class="hljs-string">"created|paid|shipped|delivered|cancelled|refunded|..."</span>
â†’ 10+ ç§çŠ¶æ€ï¼Œç»„åˆçˆ†ç‚¸

æ­£é¢ï¼š
<span class="hljs-attr">order_status</span>=<span class="hljs-string">"success|failed"</span>
<span class="hljs-attr">order_stage</span>=<span class="hljs-string">"processing|completed"</span>
â†’ 2-3 ç§çŠ¶æ€ï¼Œæ¸…æ™°æ˜äº†
</code></pre>
<h3 data-id="heading-24">5.3 å…¸å‹å‘Šè­¦è§„åˆ™æ¨¡æ¿</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># è®¢å•æˆåŠŸç‡å‘Šè­¦</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">alert:</span> <span class="hljs-string">OrderSuccessRateLow</span>
  <span class="hljs-attr">expr:</span> <span class="hljs-string">|
    rate(order_success_total{env="prod"}[5m]) 
    / 
    rate(order_total{env="prod"}[5m]) &lt; 0.95
</span>  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">severity:</span> <span class="hljs-string">critical</span>
  <span class="hljs-attr">annotations:</span>
    <span class="hljs-attr">summary:</span> <span class="hljs-string">"è®¢å•æˆåŠŸç‡ä½äº95%"</span>
    
<span class="hljs-comment"># APIå»¶è¿Ÿå‘Šè­¦</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">alert:</span> <span class="hljs-string">APILatencyHigh</span>
  <span class="hljs-attr">expr:</span> <span class="hljs-string">|
    histogram_quantile(0.99, 
      rate(api_duration_bucket{service="order"}[5m])
    ) &gt; 1
</span>  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">severity:</span> <span class="hljs-string">warning</span>
  <span class="hljs-attr">annotations:</span>
    <span class="hljs-attr">summary:</span> <span class="hljs-string">"API P99å»¶è¿Ÿè¶…è¿‡1ç§’"</span>

<span class="hljs-comment"># åº“å­˜æ°´ä½å‘Šè­¦</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">alert:</span> <span class="hljs-string">InventoryLow</span>
  <span class="hljs-attr">expr:</span> <span class="hljs-string">|
    inventory_level{status="low"} &gt; 100
</span>  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">severity:</span> <span class="hljs-string">warning</span>
  <span class="hljs-attr">annotations:</span>
    <span class="hljs-attr">summary:</span> <span class="hljs-string">"<span class="hljs-template-variable">{{$labels.category}}</span> ç±»ç›®åº“å­˜ä¸è¶³"</span>
</code></pre>
<h3 data-id="heading-25">5.4 å‘Šè­¦ç»´åº¦è®¾è®¡æ¸…å•</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7a6a22dc6f914c2daa2b7cfe23da43e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LiP5rWq5peg55eV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768270907&amp;x-signature=aOB1xfnKfOnAioSfmVtEpM43B2s%3D" alt="2.jpg" loading="lazy"/></p>
<p><strong>å…·ä½“ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    subgraph Good["âœ“ æ¨èä½¿ç”¨"]
        G1["service_name
        çŸ¥é“å“ªä¸ªæœåŠ¡"]
        G2["error_type
        çŸ¥é“å¤±è´¥åŸå› "]
        G3["payment_method
        5-10ç§"]
    end
    
    subgraph Bad["âŒ ä¸è¦ä½¿ç”¨"]
        B1["user_id
        ä¸å…³å¿ƒæ˜¯è°"]
        B2["request_id
        æ— é™å¢é•¿"]
        B3["order_id
        æ”¾æ—¥å¿—å³å¯"]
    end
    
    style Good fill:#c8e6c9,stroke:#4caf50,stroke-width:3px
    style Bad fill:#ffcdd2,stroke:#f44336,stroke-width:3px
    style G1 fill:#a5d6a7,stroke:#2e7d32
    style G2 fill:#a5d6a7,stroke:#2e7d32
    style G3 fill:#a5d6a7,stroke:#2e7d32
    style B1 fill:#ef9a9a,stroke:#c62828
    style B2 fill:#ef9a9a,stroke:#c62828
    style B3 fill:#ef9a9a,stroke:#c62828
</code></pre>
<hr/>
<h2 data-id="heading-26">å…­ã€æ“ä½œæŒ‡å¼•ä¸æ€»ç»“</h2>
<h3 data-id="heading-27">6.1 æ ‡ç­¾è®¾è®¡é»„é‡‘æ³•åˆ™</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph Rule1["åŸåˆ™1: åŸºæ•°æ§åˆ¶"]
        R1A["å•ä¸ªæ ‡ç­¾ &lt; 100ä¸ªå€¼"]
        R1B["æ ‡ç­¾ç»„åˆ &lt; 10,000æ—¶åº"]
    end
    
    subgraph Rule2["åŸåˆ™2: ä¸‰ä¸åŸåˆ™"]
        R2A["âŒ ä¸ç”¨å”¯ä¸€æ ‡è¯†
        user_id, order_id"]
        R2B["âŒ ä¸ç”¨åŠ¨æ€å€¼
        å®Œæ•´URL, å †æ ˆ"]
        R2C["âŒ ä¸è¿‡åº¦ç»†åŒ–
        çœå¸‚åŒº â†’ å¤§åŒº"]
    end
    
    subgraph Rule3["åŸåˆ™3: åˆ†å±‚å­˜å‚¨"]
        R3A["èšåˆæŒ‡æ ‡ â†’ Prometheus
        ç”¨äºå‘Šè­¦"]
        R3B["æ˜ç»†æ•°æ® â†’ ELK/ClickHouse
        ç”¨äºåˆ†æ"]
        R3C["é“¾è·¯è¿½è¸ª â†’ Jaeger
        ç”¨äºè°ƒè¯•"]
    end
    
    Rule1 --&gt; Rule2
    Rule2 --&gt; Rule3
    
    style Rule1 fill:#e1f5ff,stroke:#0288d1,stroke-width:3px
    style Rule2 fill:#fff3e0,stroke:#f57c00,stroke-width:3px
    style Rule3 fill:#f3e5f5,stroke:#9c27b0,stroke-width:3px
    style R1A fill:#bbdefb,stroke:#0288d1
    style R1B fill:#bbdefb,stroke:#0288d1
    style R2A fill:#ffe0b2,stroke:#f57c00
    style R2B fill:#ffe0b2,stroke:#f57c00
    style R2C fill:#ffe0b2,stroke:#f57c00
    style R3A fill:#e1bee7,stroke:#9c27b0
    style R3B fill:#e1bee7,stroke:#9c27b0
    style R3C fill:#e1bee7,stroke:#9c27b0
</code></pre>
<h3 data-id="heading-28">6.2 å¿«é€Ÿè¯Šæ–­æ¸…å•</h3>
<p>å‘ç°æŸ¥è¯¢å˜æ…¢æˆ–å†…å­˜é£™å‡ï¼ŸæŒ‰ä»¥ä¸‹æ­¥éª¤æ£€æŸ¥ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    Start([å‘ç°æ€§èƒ½é—®é¢˜]) --&gt; Step1
    
    Step1["Step 1: æŸ¥çœ‹ TSDB Status
    è®¿é—® /tsdb-status"] --&gt; Check1{æ—¶åºæ€»æ•° &gt; 500ä¸‡?}
    
    Check1 --&gt;|æ˜¯| Step2A["æ‰¾å‡ºé«˜åŸºæ•°æŒ‡æ ‡
    Top 10 series count"]
    Check1 --&gt;|å¦| Step2B[æ£€æŸ¥æŸ¥è¯¢å¤æ‚åº¦]
    
    Step2A --&gt; Step3["Step 2: æ‰§è¡ŒåŸºæ•°åˆ†æ
    topkæŸ¥è¯¢"]
    Step3 --&gt; Analyze{å“ªç±»æ ‡ç­¾å€¼æœ€å¤š?}
    
    Analyze --&gt;|user_idç­‰å”¯ä¸€ID| Fix1["ç§»é™¤æ ‡ç­¾
    æ”¹ä¸ºæ—¥å¿—è®°å½•"]
    Analyze --&gt;|URLåŠ¨æ€è·¯å¾„| Fix2["è·¯å¾„å½’ä¸€åŒ–
    ä½¿ç”¨æ¨¡æ¿"]
    Analyze --&gt;|çœå¸‚åŒºç­‰ç»†åŒ–| Fix3["èšåˆä¸ºå¤§åŒº
    é™ä½ç»´åº¦"]
    
    Fix1 &amp; Fix2 &amp; Fix3 --&gt; Step4["Step 3: åº”ç”¨ä¿®å¤
    ä½¿ç”¨ relabel_configs"]
    Step4 --&gt; Verify["éªŒè¯æ•ˆæœ
    ç›‘æ§æ—¶åºæ•°å˜åŒ–"]
    
    style Start fill:#e1f5ff,stroke:#0288d1,stroke-width:2px
    style Step1 fill:#fff9c4,stroke:#fbc02d
    style Check1 fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    style Analyze fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    style Fix1 fill:#c8e6c9,stroke:#4caf50,stroke-width:2px
    style Fix2 fill:#c8e6c9,stroke:#4caf50,stroke-width:2px
    style Fix3 fill:#c8e6c9,stroke:#4caf50,stroke-width:2px
    style Step4 fill:#bbdefb,stroke:#0288d1
    style Verify fill:#a5d6a7,stroke:#2e7d32,stroke-width:3px
</code></pre>
<p><strong>Step 1: æŸ¥çœ‹ TSDB Status</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è®¿é—® Prometheus UI</span>
http://localhost:9090/tsdb-status

é‡ç‚¹å…³æ³¨ï¼š
â€¢ Head Cardinality Stats
â€¢ Top 10 label names with value count
â€¢ Top 10 series count by metric names

æ‰¾å‡ºï¼šå“ªä¸ªæ ‡ç­¾æœ‰10ä¸‡+ä¸ªå€¼ï¼Ÿå“ªä¸ªæŒ‡æ ‡æœ‰10ä¸‡+æ—¶åºï¼Ÿ
</code></pre>
<p><strong>Step 2: æ‰§è¡ŒåŸºæ•°åˆ†ææŸ¥è¯¢</strong></p>
<pre><code class="hljs language-promql" lang="promql"># æŸ¥çœ‹æ—¶åºæ€»æ•°
count({__name__=~".+"})

# æ‰¾å‡ºé«˜åŸºæ•°æŒ‡æ ‡ï¼ˆTop 10ï¼‰
topk(10, count by (__name__)({__name__=~".+"}))

# æ‰¾å‡ºé«˜åŸºæ•°æ ‡ç­¾
# åœ¨ TSDB Status é¡µé¢æŸ¥çœ‹ "label names with value count"
</code></pre>
<p><strong>Step 3: å¯¹ç—‡ä¸‹è¯</strong></p>
<pre><code class="hljs language-bash" lang="bash">é—®é¢˜ç±»å‹                    è§£å†³æ–¹æ¡ˆ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
user_id ç­‰å”¯ä¸€ID            ç§»é™¤æ ‡ç­¾ï¼Œæ”¹ä¸ºæ—¥å¿—è®°å½•

URL åŠ¨æ€è·¯å¾„                è·¯å¾„å½’ä¸€åŒ–ï¼š
                           /api/order/123 â†’ /api/order/{<span class="hljs-built_in">id</span>}

è¿‡åº¦ç»†åŒ–ï¼ˆçœå¸‚åŒºï¼‰          èšåˆä¸ºå¤§åŒº

å†å²é—ç•™é«˜åŸºæ•°æŒ‡æ ‡          ä½¿ç”¨ relabel_configs ä¸¢å¼ƒ
</code></pre>
<h3 data-id="heading-29">6.3 Relabel é…ç½®ç¤ºä¾‹</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># prometheus.yml</span>
<span class="hljs-attr">scrape_configs:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">job_name:</span> <span class="hljs-string">'order-service'</span>
    <span class="hljs-attr">relabel_configs:</span>
      <span class="hljs-comment"># ä¸¢å¼ƒé«˜åŸºæ•°æ ‡ç­¾</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">action:</span> <span class="hljs-string">labeldrop</span>
        <span class="hljs-attr">regex:</span> <span class="hljs-string">'user_id|order_id|request_id'</span>
      
      <span class="hljs-comment"># URL è·¯å¾„å½’ä¸€åŒ–</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">source_labels:</span> [<span class="hljs-string">__path__</span>]
        <span class="hljs-attr">target_label:</span> <span class="hljs-string">path</span>
        <span class="hljs-attr">regex:</span> <span class="hljs-string">'/api/order/[0-9]+/(.*)'</span>
        <span class="hljs-attr">replacement:</span> <span class="hljs-string">'/api/order/{id}/$1'</span>
</code></pre>
<h3 data-id="heading-30">6.4 æ ¸å¿ƒè¦ç‚¹å›é¡¾</h3>
<p><strong>å­˜å‚¨åˆ†å±‚åŸåˆ™ï¼š</strong></p>
<ul>
<li>ç´¢å¼•å’Œæœ€æ–°æ•°æ®å­˜å‚¨åœ¨å†…å­˜ï¼Œä¿è¯æŸ¥è¯¢é€Ÿåº¦</li>
<li>å†å²æ•°æ®å­˜å‚¨åœ¨ç£ç›˜ï¼Œé€šè¿‡å‹ç¼©èŠ‚çœç©ºé—´</li>
<li>çƒ­æ•°æ®ï¼ˆ2å°æ—¶å†…ï¼‰ç”¨äºå®æ—¶å‘Šè­¦ï¼Œå†·æ•°æ®ç”¨äºå†å²åˆ†æ</li>
</ul>
<p><strong>æ ‡ç­¾è®¾è®¡åŸåˆ™ï¼š</strong></p>
<ul>
<li>æ ‡ç­¾åº”è¯¥æ˜¯å¯èšåˆçš„ç»´åº¦ï¼Œè€Œéå”¯ä¸€æ ‡è¯†</li>
<li>ç”¨æˆ·IDã€è®¢å•å·ç­‰æ˜ç»†ä¿¡æ¯åº”è¯¥æ”¾åœ¨æ—¥å¿—ç³»ç»Ÿ</li>
<li>æ§åˆ¶æ ‡ç­¾åŸºæ•°æ˜¯ä¿è¯æŸ¥è¯¢æ€§èƒ½çš„å…³é”®</li>
</ul>
<p><strong>ç›‘æ§ä¸è¿½è¸ªçš„åˆ†å·¥ï¼š</strong></p>
<ul>
<li>ç›‘æ§ç³»ç»Ÿå…³æ³¨æ•´ä½“è¶‹åŠ¿å’Œå¼‚å¸¸æ¨¡å¼ï¼Œç”¨äºå‘Šè­¦</li>
<li>è¿½è¸ªç³»ç»Ÿå…³æ³¨ä¸ªä½“è¡Œä¸ºå’Œè¯¦ç»†è·¯å¾„ï¼Œç”¨äºæ’æŸ¥</li>
<li>Prometheus è´Ÿè´£"å‘ç”Ÿäº†ä»€ä¹ˆ"ï¼Œæ—¥å¿—/è¿½è¸ªè´Ÿè´£"è°åšäº†ä»€ä¹ˆ"</li>
</ul>
<h3 data-id="heading-31">6.5 æ€»ç»“</h3>
<p><strong>Prometheus çš„è®¾è®¡å“²å­¦ï¼š</strong></p>
<blockquote>
<p>ç›‘æ§ç³»ç»Ÿåº”è¯¥å›ç­”"å‘ç”Ÿäº†ä»€ä¹ˆ"ï¼ˆWhat happenedï¼‰ï¼Œ
è€Œä¸æ˜¯"è°åšäº†ä»€ä¹ˆ"ï¼ˆWho did whatï¼‰ã€‚</p>
</blockquote>
<p><strong>ä¸¤ä¸ªç»´åº¦çš„æ•°æ®åˆ†ç¦»ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/953e4d21fb32468fb546dfacca3ba947~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LiP5rWq5peg55eV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768270907&amp;x-signature=A6VpvJiUFG8CADDqBBEGbpav20A%3D" alt="1.jpg" loading="lazy"/></p>
<p><strong>æœ€åçš„å»ºè®®ï¼š</strong></p>
<ol>
<li><strong>æ–°æŒ‡æ ‡ä¸Šçº¿å‰</strong>ï¼šå…ˆè¯„ä¼°åŸºæ•°ï¼Œè®¡ç®— <code>æ—¶åºæ•° = å„æ ‡ç­¾åŸºæ•°çš„ä¹˜ç§¯</code></li>
<li><strong>å®šæœŸå·¡æ£€</strong>ï¼šæ¯å‘¨æŸ¥çœ‹ TSDB Statusï¼Œå…³æ³¨æ—¶åºå¢é•¿è¶‹åŠ¿</li>
<li><strong>å‘Šè­¦ä¼˜å…ˆ</strong>ï¼šè®°ä½ Prometheus ä¸»è¦ç”¨äºå‘Šè­¦ï¼Œä¸æ˜¯ä¸‡èƒ½åˆ†æå·¥å…·</li>
<li><strong>å·¥å…·ç»„åˆ</strong>ï¼šPrometheus + ELK + Jaeger æ‰æ˜¯å®Œæ•´çš„å¯è§‚æµ‹æ€§æ–¹æ¡ˆ</li>
</ol>
<hr/>
<p><strong>å‚è€ƒèµ„æºï¼š</strong></p>
<ul>
<li>Prometheus å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fprometheus.io%2Fdocs%2F" target="_blank" title="https://prometheus.io/docs/" ref="nofollow noopener noreferrer">prometheus.io/docs/</a></li>
<li>TSDB è®¾è®¡è®ºæ–‡ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ffabxc.org%2Ftsdb%2F" target="_blank" title="https://fabxc.org/tsdb/" ref="nofollow noopener noreferrer">fabxc.org/tsdb/</a></li>
<li>åŸºæ•°åˆ†æå·¥å…·ï¼špromtool tsdb analyze</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤šæ™ºèƒ½ä½“åä½œæ¡ˆä¾‹å®è·µï¼ˆäºŒï¼‰ï¼šåŸºäºLangGraphæ¡†æ¶]]></title>    <link>https://juejin.cn/post/7591697558377431082</link>    <guid>https://juejin.cn/post/7591697558377431082</guid>    <pubDate>2026-01-06T01:14:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591697558377431082" data-draft-id="7591672090790952979" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤šæ™ºèƒ½ä½“åä½œæ¡ˆä¾‹å®è·µï¼ˆäºŒï¼‰ï¼šåŸºäºLangGraphæ¡†æ¶"/> <meta itemprop="keywords" content="åç«¯,Python,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-06T01:14:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æœ¨æ˜†å­"/> <meta itemprop="url" content="https://juejin.cn/user/825103640698564"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤šæ™ºèƒ½ä½“åä½œæ¡ˆä¾‹å®è·µï¼ˆäºŒï¼‰ï¼šåŸºäºLangGraphæ¡†æ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/825103640698564/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æœ¨æ˜†å­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T01:14:04.000Z" title="Tue Jan 06 2026 01:14:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ä¸Šç¯‡<a href="https://juejin.cn/post/7591730714140540970" target="_blank" title="https://juejin.cn/post/7591730714140540970">ã€Šå¤šæ™ºèƒ½ä½“åä½œæ¡ˆä¾‹å®è·µï¼ˆä¸€ï¼‰ï¼šåŸºäºAgentScopeæ¡†æ¶ã€‹</a>æ–‡ç« ä¸­ï¼ŒChaiysåŒå­¦å›´ç»•é«˜è€ƒä¿¡æ¯æŸ¥è¯¢æ™ºèƒ½åŠ©æ‰‹ä¸šåŠ¡åœºæ™¯ï¼Œé‡‡ç”¨AgentScopeæ¡†æ¶è¿›è¡Œå¤šæ™ºèƒ½ä½“åä½œçš„éªŒè¯ã€‚</p>
<p>æœ¬æ–‡åŸºäºåŒæ ·çš„ä¸šåŠ¡åœºæ™¯å’Œæ¡ˆä¾‹ï¼Œé‡‡ç”¨LangGraphæ¡†æ¶è¿›è¡Œå¯¹æ¯”å®è·µå’ŒéªŒè¯ï¼Œä»¥ä¾¿æ›´æ·±å…¥åœ°ç†è§£ã€‚</p>
<h2 data-id="heading-0">ğŸ§  å¤šæ™ºèƒ½ä½“åä½œå®ç°é€»è¾‘</h2>
<p>é¦–å…ˆå›é¡¾ä¸€ä¸‹ä¸šåŠ¡åœºæ™¯ï¼Œå’Œä¸Šç¯‡æ–‡ç« ä¿æŒä¸€è‡´ï¼Œè¿˜æ˜¯æ”¯æ’‘ç”¨æˆ·è¿›è¡Œé«˜è€ƒä¿¡æ¯æŸ¥è¯¢ï¼Œå¹¶ä¸”è¦æ”¯æŒå¤šè½®å¯¹è¯ï¼Œåç»­ä¼šåŸºäºä»¥ä¸‹æ¡ˆä¾‹æ¥è¿›è¡ŒéªŒè¯ï¼š</p>
<p>ç¬¬ä¸€è½®æé—®ï¼š2016å¹´è€ƒç”Ÿäººæ•°æœ‰å¤šå°‘ï¼Ÿ<br/>
ç¬¬äºŒè½®è¿½é—®å¹´ä»½ï¼š2018å¹´å‘¢ï¼Ÿ<br/>
ç¬¬ä¸‰è½®è¿½é—®å…¶ä»–ï¼šå½•å–äººæ•°å‘¢ï¼Ÿ</p>
<p>é’ˆå¯¹è¯¥ä¸šåŠ¡åœºæ™¯ï¼Œå››ä¸ªæ™ºèƒ½ä½“ä¹‹é—´çš„åä½œé€»è¾‘å’ŒAgentScopeæ¡ˆä¾‹ä¹Ÿå®Œå…¨ä¿æŒä¸€è‡´ï¼š</p>
<p>1ï¼‰ç”¨æˆ·è¾“å…¥é—®é¢˜</p>
<p>2ï¼‰TemplateAgentåˆ¤æ–­æ˜¯å¦æœ‰ä¸Šä¸‹æ–‡å†å²ï¼Œå¦‚æœæ²¡æœ‰åˆ™è½¬4ï¼Œæœ‰åˆ™è¿›ä¸€æ­¥åŒ¹é…å†å²é—®é¢˜æ¨¡æ¿ï¼Œå¦‚æœªåŒ¹é…åˆ°åˆ™è½¬3ï¼Œå¦‚åŒ¹é…åˆ°åˆ™åŸºäºæ¨¡æ¿SQLï¼Œä»ç”¨æˆ·å½“å‰é—®é¢˜ä¸­æå–æŸ¥è¯¢å‚æ•°æ¤å…¥æ¨¡æ¿SQLï¼Œæ‰§è¡Œåå¸¦æŸ¥è¯¢ç»“æœè½¬5</p>
<p>3ï¼‰æœ‰ä¸Šä¸‹æ–‡å†å²ï¼Œä½†æ²¡æœ‰åŒ¹é…çš„å†å²é—®é¢˜ï¼Œåˆ™è¿›å…¥æ„å›¾è¯†åˆ«æ”¹å†™RewriteAgentï¼Œåˆ©ç”¨ä¸Šä¸‹æ–‡å¯¹è¯èƒŒæ™¯å¯¹ç”¨æˆ·å½“å‰é—®é¢˜åšæ”¹å†™ï¼Œç„¶åè¿›å…¥SQLAgentï¼ŒRAGæ£€ç´¢å…ƒæ•°æ®ã€ç”ŸæˆSQLã€æŸ¥è¯¢æ•°æ®ï¼Œæœ€åè¿›å…¥AnalysisAgentåˆ†æå›ç­”</p>
<p>4ï¼‰æ— ä¸Šä¸‹æ–‡å†å²ï¼Œä»£è¡¨ç”¨æˆ·æ˜¯é¦–æ¬¡æé—®ï¼Œåˆ™ç›´æ¥è¿›å…¥SQLAgentï¼ŒRAGæ£€ç´¢å…ƒæ•°æ®ã€ç”ŸæˆSQLã€æŸ¥è¯¢æ•°æ®ï¼Œæœ€åè¿›å…¥AnalysisAgentåˆ†æå›ç­”</p>
<p>5ï¼‰æ ¹æ®æŸ¥è¯¢ç»“æœç›´æ¥è¿›å…¥AnalysisAgentåˆ†æå›ç­”</p>
<p>è¿™ä¸ªåä½œé€»è¾‘åŸºäº LangGraphæ¡†æ¶çš„è‡ªå®šä¹‰çŠ¶æ€å›¾StataGraphå®ç°ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#Â ========================</span>
<span class="hljs-comment"># ğŸ§­ è·¯ç”±å‡½æ•°</span>
<span class="hljs-comment">#Â ========================</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">route_to_next_agent</span>(<span class="hljs-params">state: State</span>)Â -&gt;Â <span class="hljs-type">Literal</span>[<span class="hljs-string">"sql"</span>, <span class="hljs-string">"analysis"</span>, <span class="hljs-string">"rewrite"</span>, <span class="hljs-string">"__end__"</span>]:
Â  Â  <span class="hljs-keyword">if</span> state.get(<span class="hljs-string">"next_agent"</span>)Â ==Â <span class="hljs-string">"sql"</span>:
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">"sql"</span>
Â  Â  <span class="hljs-keyword">if</span> state.get(<span class="hljs-string">"next_agent"</span>)Â ==Â <span class="hljs-string">"analysis"</span>:
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">"analysis"</span>
Â  Â  <span class="hljs-keyword">if</span> state.get(<span class="hljs-string">"next_agent"</span>)Â ==Â <span class="hljs-string">"rewrite"</span>:
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">"rewrite"</span>
Â  Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">"__end__"</span>
Â  Â Â 
workflowÂ =Â StateGraph(State)

workflow.add_node(<span class="hljs-string">"template"</span>, template_agent)
workflow.add_node(<span class="hljs-string">"rewrite"</span>, rewrite_agent) Â  <span class="hljs-comment"># æ–°å¢æ”¹å†™æ™ºèƒ½ä½“</span>
workflow.add_node(<span class="hljs-string">"sql"</span>, sql_agent)
workflow.add_node(<span class="hljs-string">"analysis"</span>, analysis_agent)

workflow.add_edge(START, <span class="hljs-string">"template"</span>)

<span class="hljs-comment"># Template ä¹‹åæ ¹æ®æ¡ä»¶æµå‘</span>
workflow.add_conditional_edges(
Â  Â  <span class="hljs-string">"template"</span>,
Â  Â  route_to_next_agent,
Â  Â  {
Â  Â  Â  Â  <span class="hljs-string">"rewrite"</span>: <span class="hljs-string">"rewrite"</span>, Â  Â  <span class="hljs-comment"># æ–°å¢ rewrite åˆ†æ”¯</span>
Â  Â  Â  Â  <span class="hljs-string">"sql"</span>: <span class="hljs-string">"sql"</span>,
Â  Â  Â  Â  <span class="hljs-string">"analysis"</span>: <span class="hljs-string">"analysis"</span>,
Â  Â  Â  Â  <span class="hljs-string">"__end__"</span>:Â END
Â  Â  }
)

<span class="hljs-comment"># æ”¹å†™æ™ºèƒ½ä½“å®Œæˆåäº¤ç»™Â SQL</span>
workflow.add_edge(<span class="hljs-string">"rewrite"</span>, <span class="hljs-string">"sql"</span>)

<span class="hljs-comment">#Â SQLÂ æ‰§è¡Œåæµå‘åˆ†æ</span>
workflow.add_edge(<span class="hljs-string">"sql"</span>, <span class="hljs-string">"analysis"</span>)
workflow.add_edge(<span class="hljs-string">"analysis"</span>,Â END)

<span class="hljs-comment">#Â ========================</span>
<span class="hljs-comment"># â–¶ï¸ ä¸»æµç¨‹</span>
<span class="hljs-comment">#Â ========================</span>
<span class="hljs-keyword">if</span> __name__Â ==Â <span class="hljs-string">"__main__"</span>:
Â  Â Â <span class="hljs-keyword">from</span>Â uuid <span class="hljs-keyword">import</span> uuid4

Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸš€ æ™ºèƒ½æ•°æ®åŠ©æ‰‹ï¼ˆæ”¯æŒè¿½é—®ã€å¤šè½®ä¸Šä¸‹æ–‡ï¼‰"</span>)
Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span>Â *<span class="hljs-number">80</span>)
Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ’¡ è¾“å…¥é—®é¢˜å¼€å§‹å¯¹è¯ï¼Œè¾“å…¥ 'exit' é€€å‡ºã€‚"</span>)
Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span>Â *<span class="hljs-number">80</span>)

Â  Â  <span class="hljs-comment"># æ¯æ¬¡å¯åŠ¨ç”Ÿæˆå”¯ä¸€ thread_idï¼ˆä¸Šä¸‹æ–‡è®°å¿†å…³é”®ï¼‰</span>
Â  Â  thread_idÂ =Â <span class="hljs-built_in">str</span>(uuid4())
Â  Â  configÂ =Â {<span class="hljs-string">"configurable"</span>: {<span class="hljs-string">"thread_id"</span>: thread_id}}

Â  Â  <span class="hljs-keyword">while</span>Â <span class="hljs-literal">True</span>:
Â  Â  Â  Â  user_inputÂ =Â <span class="hljs-built_in">input</span>(<span class="hljs-string">"\nğŸ‘¤ ä½ : "</span>).strip()
Â  Â  Â  Â  <span class="hljs-keyword">if</span>Â <span class="hljs-keyword">not</span>Â user_input:
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">continue</span>
Â  Â  Â  Â  <span class="hljs-keyword">if</span> user_input.lower()Â <span class="hljs-keyword">in</span>Â {<span class="hljs-string">"exit"</span>, <span class="hljs-string">"quit"</span>}:
Â  Â  Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ‘‹ å†è§ï¼ä¼šè¯å·²ç»“æŸã€‚"</span>)
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">break</span>

Â  Â  Â  Â  <span class="hljs-comment"># æ„é€ è¾“å…¥</span>
Â  Â  Â  Â  input_dataÂ =Â {
Â  Â  Â  Â  Â  Â  <span class="hljs-string">"messages"</span>: [HumanMessage(content=user_input)],
Â  Â  Â  Â  }

Â  Â  Â  Â  <span class="hljs-keyword">try</span>:
Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># æµå¼æ‰§è¡Œ</span>
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â chunkÂ <span class="hljs-keyword">in</span>Â app.stream(input_data, config=config):
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">if</span> <span class="hljs-string">"analysis"</span>Â <span class="hljs-keyword">in</span>Â chunk:
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  msgÂ =Â chunk[<span class="hljs-string">"analysis"</span>][<span class="hljs-string">"messages"</span>][<span class="hljs-number">0</span>]
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ğŸ’¬ åŠ©æ‰‹: <span class="hljs-subst">{msg.content.strip()}</span>"</span>)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"-"</span>Â *<span class="hljs-number">60</span>)
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">elif</span> <span class="hljs-string">"sql"</span>Â <span class="hljs-keyword">in</span>Â chunkÂ <span class="hljs-keyword">and</span>Â <span class="hljs-string">"messages"</span>Â <span class="hljs-keyword">in</span>Â chunk[<span class="hljs-string">"sql"</span>]:
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment">#Â SQLÂ ç”Ÿæˆå¤±è´¥çš„æƒ…å†µ</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â mÂ <span class="hljs-keyword">in</span>Â chunk[<span class="hljs-string">"sql"</span>][<span class="hljs-string">"messages"</span>]:
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(m, AIMessage):
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ğŸ’¬ åŠ©æ‰‹: <span class="hljs-subst">{m.content.strip()}</span>"</span>)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"-"</span>Â *<span class="hljs-number">60</span>)
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">elif</span> <span class="hljs-string">"__end__"</span>Â <span class="hljs-keyword">in</span>Â chunk:
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœ… å¯¹è¯ç»“æŸ"</span>)

Â  Â  Â  Â Â <span class="hljs-keyword">except</span>Â json.JSONDecodeError:
Â  Â  Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"âš ï¸ JSON è§£æå¤±è´¥ï¼Œå¯èƒ½æ˜¯ LLM è¿”å›äº†éç»“æ„åŒ–å†…å®¹ã€‚"</span>)
Â  Â  Â  Â Â <span class="hljs-keyword">except</span>Â KeyboardInterrupt:
Â  Â  Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">"\nâ¹ï¸ ä¸­æ–­ã€‚è¾“å…¥ exit å¯é€€å‡ºã€‚"</span>)
Â  Â  Â  Â Â <span class="hljs-keyword">except</span>Â ExceptionÂ <span class="hljs-keyword">as</span>Â e:
Â  Â  Â  Â  Â  Â  <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ğŸ’¥ å‡ºé”™ï¼š<span class="hljs-subst">{e}</span>"</span>)
</code></pre>
<p>å¦‚ä»¥ä¸Šä»£ç æ‰€ç¤ºï¼Œé€šè¿‡â€œworkflow.add_nodeâ€æ–¹å¼æ·»åŠ å››ä¸ªNodeèŠ‚ç‚¹ï¼štemplateã€rewriteã€sqlã€analysisåˆ†åˆ«ä»£è¡¨å››ä¸ªæ™ºèƒ½ä½“ã€‚<br/>
é€šè¿‡â€œworkflow.add_edgeâ€æ–¹å¼æ·»åŠ å¯¹åº”èŠ‚ç‚¹ä¹‹é—´çš„è·³è½¬å…³ç³»ï¼Œå…¶ä¸­â€œworkflow.add_conditional_edgesâ€æ˜¯æ·»åŠ æ¡ä»¶è¾¹ï¼Œé€šè¿‡è°ƒç”¨route_to_next_agent()è·¯ç”±å‡½æ•°æ ¹æ®æ™ºèƒ½ä½“è¿”å›çš„next_agentå­—æ®µå†³å®šæµè½¬åˆ°å“ªä¸€ä¸ªèŠ‚ç‚¹ã€‚</p>
<h3 data-id="heading-1"><strong>ğŸ” å¤šè½®å¯¹è¯ä¹‹ä¸Šä¸‹æ–‡è®°å¿†å’ŒçŠ¶æ€æœº</strong></h3>
<p>LangGraphä¸Šä¸‹æ–‡è®°å¿†çš„ç›¸å…³æœºåˆ¶ï¼Œä¸»è¦é€šè¿‡å®˜æ–¹æä¾›çš„Â MemorySaver()Â å®ç°ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å¯ç”¨è®°å¿†ï¼ˆæ”¯æŒå¤šè½®å¯¹è¯ï¼‰</span>
<span class="hljs-attr">memory</span> = MemorySaver()
<span class="hljs-attr">app</span> = workflow.compile(checkpointer=memory)
</code></pre>
<p>MemorySaverä¼šå°†æ¯ä¸€ä¸ªèŠ‚ç‚¹æ‰§è¡Œåçš„ State å­˜å‚¨åˆ°æ£€æŸ¥ç‚¹ï¼ˆcheckpointï¼‰ä¸­ï¼Œä½¿å¾—ä¸‹ä¸€æ¬¡è°ƒç”¨å¯ä»¥ä»ä¹‹å‰çš„å¯¹è¯çŠ¶æ€ç»§ç»­æ‰§è¡Œã€‚</p>
<p>å…¶ç‰¹ç‚¹æ˜¯åŸæ ·å­˜ å‚¨stateçŠ¶æ€æœºï¼Œä¸è£å‰ªã€ä¸åˆ å‡ã€ä¸åˆå¹¶å†å²ï¼ŒçœŸæ­£å…³é”®çš„æ˜¯ä½ åœ¨ State çŠ¶æ€æœºä¸­è®¾è®¡çš„ä¸šåŠ¡é€»è¾‘ã€‚</p>
<p>ä½¿ç”¨â€œÂ StateGraph(State)â€æ–¹å¼åœ¨çŠ¶æ€å›¾StateGraphåˆå§‹åŒ–æ—¶å°±å°†è‡ªå®šä¹‰StateçŠ¶æ€æœºå¯¹è±¡æ³¨å…¥å¹¶ç»‘å®šï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ========================</span>
<span class="hljs-comment"># ğŸ§  å¢å¼ºçŠ¶æ€å®šä¹‰</span>
<span class="hljs-comment"># ========================</span>
<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">State</span>(<span class="hljs-title class_ inherited__">TypedDict</span>):
Â  Â  messages: Annotated[<span class="hljs-built_in">list</span>[BaseMessage], add_messages]
Â  Â  original_intent:Â <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] Â <span class="hljs-comment"># å¦‚ "è€ƒç”Ÿäººæ•°"</span>
Â  Â  known_table_struct:Â <span class="hljs-type">Optional</span>[<span class="hljs-type">List</span>] Â <span class="hljs-comment"># å·²ç¡®è®¤çš„è¡¨ç»“æ„</span>
Â  Â  last_sql_template:Â <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] Â <span class="hljs-comment"># å¸¦å ä½ç¬¦çš„ SQL æ¨¡æ¿ï¼Œå¦‚ "SELECT ... WHERE year = {year}"</span>
Â  Â  query_result:Â <span class="hljs-type">Optional</span>[<span class="hljs-built_in">list</span>] Â <span class="hljs-comment"># æœ€è¿‘ä¸€æ¬¡æŸ¥è¯¢ç»“æœ</span>
Â  Â  next_agent:Â <span class="hljs-built_in">str</span>
</code></pre>
<p>æ¯è½®å¯¹è¯éƒ½ä¼šåœ¨å…¨å±€ç»Ÿä¸€çŠ¶æ€æœºä¸­ä¿å­˜ä»¥ä¸‹ä¿¡æ¯ï¼š</p>

































<table><thead><tr><th>key</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>messages</td><td>å†å²æ¶ˆæ¯åˆ—è¡¨</td></tr><tr><td>original_intent</td><td>ç”¨æˆ·çš„æ ¸å¿ƒæ„å›¾ï¼ˆå¦‚â€œè€ƒç”Ÿäººæ•°â€ï¼‰</td></tr><tr><td>known_table_struct</td><td>å·²è¯†åˆ«çš„æ•°æ®è¡¨ç»“æ„</td></tr><tr><td>last_sql_template</td><td>å‚æ•°åŒ– SQL æ¨¡æ¿ï¼Œä¾¿äºå¤ç”¨</td></tr><tr><td>query_result</td><td>æŸ¥è¯¢ç»“æœ</td></tr><tr><td>next_agent</td><td>ä¸‹ä¸€æ­¥è·¯ç”±æ–¹å‘</td></tr></tbody></table>
<p>å…¶ä¸­å½“æˆ‘ä»¬ä½¿ç”¨Â Annotated[list[BaseMessage], add_messages]Â æ¥å®šä¹‰ State ä¸­çš„Â messagesÂ å­—æ®µæ—¶ï¼Œæ–°çš„æ¶ˆæ¯ä¼šè‡ªåŠ¨è¢«è¿½åŠ åˆ°ç°æœ‰çš„æ¶ˆæ¯åˆ—è¡¨ä¹‹åï¼Œè¿™æ˜¯ LangGraph ä¸ºç®¡ç†å¯¹è¯å†å²ç­‰åºåˆ—åŒ–æ•°æ®æä¾›çš„ä¸€ç§ä¾¿æ·ä¸”å¼ºå¤§çš„çŠ¶æ€æ›´æ–°æœºåˆ¶ã€‚</p>
<p>LangGraphæ‰€æœ‰æ™ºèƒ½ä½“Agentéƒ½è¦éµå¾ªç»Ÿä¸€è§„èŒƒï¼Œå°†Stataå¯¹è±¡ä½œä¸ºè¾“å…¥è¾“å‡ºå¯¹è±¡ï¼Œå¦‚ä»¥ä¸‹â€œæ¨¡æ¿åŒ¹é…æ™ºèƒ½ä½“â€templateAgentçš„ä»£ç æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ========================</span>
<span class="hljs-comment"># ğŸ»æ¨¡æ¿åŒ¹é… æ™ºèƒ½ä½“ï¼ˆæ”¯æŒè¿½é—®æ¨¡æ¿å¤ç”¨ï¼‰</span>
<span class="hljs-comment"># ========================</span>
<span class="hljs-keyword">def</span>Â <span class="hljs-title function_">template_agent</span>(<span class="hljs-params">state: State</span>):
Â  Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"=== ğŸŸ¦ Template Agent ==="</span>)
Â  Â  current_query = state[<span class="hljs-string">"messages"</span>][-<span class="hljs-number">1</span>].content

Â  Â Â <span class="hljs-comment"># â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
Â  Â Â <span class="hljs-comment"># ğŸ”„ æƒ…å†µ1ï¼šæ— ä¸Šä¸‹æ–‡ â†’ SQL Agent</span>
Â  Â Â <span class="hljs-comment"># â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
Â  Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-keyword">not</span>Â state.get(<span class="hljs-string">"known_table_struct"</span>)
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">or</span>Â <span class="hljs-keyword">not</span>Â state.get(<span class="hljs-string">"original_intent"</span>)
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">or</span>Â <span class="hljs-keyword">not</span>Â state.get(<span class="hljs-string">"last_sql_template"</span>)):
Â  Â  Â  Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"âš ï¸ ä¸å­˜åœ¨ä¸Šä¸‹æ–‡ï¼Œè¿›å…¥SQL Agentæµç¨‹"</span>)
Â  Â  Â  Â Â <span class="hljs-keyword">return</span>Â {
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"messages"</span>: state[<span class="hljs-string">"messages"</span>],
Â  Â  Â  Â  Â  Â Â <span class="hljs-string">"next_agent"</span>:Â <span class="hljs-string">"sql"</span>
Â  Â  Â  Â  }

Â  Â Â <span class="hljs-comment"># â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
Â  Â Â <span class="hljs-comment"># ğŸ”„ æƒ…å†µ2ï¼šå·²æœ‰ä¸Šä¸‹æ–‡ â†’ å°è¯•å‚æ•°åŒ–è¿½é—®å¤„ç†</span>
Â  Â Â <span class="hljs-comment"># â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
Â  Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ”„ æ£€æµ‹åˆ°å†å²ä¸Šä¸‹æ–‡ï¼Œå°è¯•å‚æ•°åŒ–è¿½é—®"</span>)
Â  Â Â <span class="hljs-keyword">try</span>:
Â  Â  Â  Â Â <span class="hljs-comment"># å…·ä½“ä¸šåŠ¡ä»£ç è·³è¿‡...</span>

        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ… è¿½é—®æŸ¥è¯¢æˆåŠŸï¼Œè¿›å…¥åˆ†ææµç¨‹"</span>)
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">"query_result"</span>: result,
            <span class="hljs-string">"next_agent"</span>: <span class="hljs-string">"analysis"</span>
        }


Â  Â Â <span class="hljs-keyword">except</span>Â ExceptionÂ <span class="hljs-keyword">as</span>Â e:
Â  Â  Â  Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å‚æ•°æå–å¤±è´¥:Â <span class="hljs-subst">{e}</span>"</span>)

Â  Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"âš ï¸ è¿½é—®å¤„ç†å¤±è´¥ï¼Œè¿›å…¥æ”¹å†™æµç¨‹"</span>)
Â  Â Â <span class="hljs-keyword">return</span>Â {
Â  Â  Â  Â Â <span class="hljs-string">"messages"</span>: state[<span class="hljs-string">"messages"</span>],
Â  Â  Â  Â Â <span class="hljs-string">"next_agent"</span>:Â <span class="hljs-string">"rewrite"</span>
Â  Â  }
</code></pre>
<h3 data-id="heading-2"><strong>â–¶ï¸ æ¡ˆä¾‹æµ‹è¯•ç»“æœ</strong></h3>
<p>æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹LangGraphå®ç°å¤šæ™ºèƒ½ä½“åä½œçš„æ•ˆæœï¼š</p>
<pre><code class="hljs language-rust" lang="rust">ğŸš€ æ™ºèƒ½æ•°æ®åŠ©æ‰‹ï¼ˆæ”¯æŒè¿½é—®ã€å¤šè½®ä¸Šä¸‹æ–‡ï¼‰
================================================================================
ğŸ’¡ è¾“å…¥é—®é¢˜å¼€å§‹å¯¹è¯ï¼Œè¾“å…¥ <span class="hljs-symbol">'exit</span>' é€€å‡ºã€‚
================================================================================

ğŸ‘¤ ä½ : <span class="hljs-number">2016</span>å¹´è€ƒç”Ÿäººæ•°æœ‰å¤šå°‘ï¼Ÿ
=== ğŸŸ¦ Template Agent ===
âš ï¸ ä¸å­˜åœ¨ä¸Šä¸‹æ–‡ï¼Œè¿›å…¥SQL Agentæµç¨‹
=== ğŸŸ¦ Sql Agent ===
ğŸ†• å¯åŠ¨å®Œæ•´æŸ¥è¯¢æµç¨‹
è°ƒç”¨å¤§æ¨¡å‹llama2å‘é‡åŒ–ï¼š<span class="hljs-number">2016</span>å¹´è€ƒç”Ÿäººæ•°æœ‰å¤šå°‘ï¼Ÿ
ğŸ“š åŒ¹é…è¡¨ç»“æ„: ['{<span class="hljs-string">"è¡¨å"</span>: <span class="hljs-string">"college_entrance_examination"</span>, <span class="hljs-string">"è¡¨å¤‡æ³¨"</span>: <span class="hljs-string">"è€ƒç”Ÿäººæ•°ä¸å¤è¯»äººæ•°ä¿¡æ¯è¡¨ï¼ŒåŒ…å«å­—æ®µï¼šé«˜è€ƒå¹´ä»½(ä¸»é”®)ã€è€ƒç”Ÿäººæ•°(ä¸‡äºº)ã€å¤è¯»äººæ•°(ä¸‡äºº)"</span>, <span class="hljs-string">"å­—æ®µåˆ—è¡¨"</span>: [{<span class="hljs-string">"å­—æ®µå"</span>: <span class="hljs-string">"examination_year"</span>, <span class="hljs-string">"å­—æ®µç±»å‹"</span>: <span class="hljs-string">"int"</span>, <span class="hljs-string">"å­—æ®µå¤‡æ³¨"</span>: <span class="hljs-string">"é«˜è€ƒå¹´ä»½"</span>}, {<span class="hljs-string">"å­—æ®µå"</span>: <span class="hljs-string">"candidates_count"</span>, <span class="hljs-string">"å­—æ®µç±»å‹"</span>: <span class="hljs-string">"decimal(10,2)"</span>, <span class="hljs-string">"å­—æ®µå¤‡æ³¨"</span>: <span class="hljs-string">"è€ƒç”Ÿäººæ•°(ä¸‡äºº)"</span>}, {<span class="hljs-string">"å­—æ®µå"</span>: <span class="hljs-string">"retake_count"</span>, <span class="hljs-string">"å­—æ®µç±»å‹"</span>: <span class="hljs-string">"decimal(10,2)"</span>, <span class="hljs-string">"å­—æ®µå¤‡æ³¨"</span>: <span class="hljs-string">"å¤è¯»äººæ•°(ä¸‡äºº)"</span>}]}']
ğŸ§  åŸå§‹æ„å›¾: <span class="hljs-number">2016</span>å¹´è€ƒç”Ÿäººæ•°æœ‰å¤šå°‘ï¼Ÿ
ğŸ“¦ ä¿å­˜ SQL æ¨¡æ¿: SELECT candidates_count AS 'è€ƒç”Ÿäººæ•°' FROM college_entrance_examination WHERE examination_year = {year};
=== ğŸŸ© Analysis Agent ===
ğŸ’¬ åŠ©æ‰‹: **<span class="hljs-number">2016</span>å¹´é«˜è€ƒè€ƒç”Ÿäººæ•°åˆ†ææŠ¥å‘Š** Â 

**äº‹å®é™ˆè¿°** Â 
<span class="hljs-number">2016</span>å¹´é«˜è€ƒè€ƒç”Ÿäººæ•°ä¸º **<span class="hljs-number">940.00</span>ä¸‡äºº**ï¼ˆæ•°æ®æ¥æºï¼šè€ƒç”Ÿäººæ•°ä¸å¤è¯»äººæ•°ä¿¡æ¯è¡¨ï¼‰ã€‚

**ç®€è¦æ´å¯Ÿ** Â 
å½“å‰æ•°æ®ä»…åŒ…å«å•ä¸€æ—¶é—´ç‚¹çš„è®°å½•ï¼Œæš‚æ— æ³•ç›´æ¥æ¨å¯¼è¶‹åŠ¿å˜åŒ–ã€‚è‹¥éœ€åˆ†æè€ƒç”Ÿäººæ•°å¢å‡è§„å¾‹ï¼Œå»ºè®®ç»“åˆç›¸é‚»å¹´ä»½æ•°æ®ï¼ˆå¦‚<span class="hljs-number">2015</span>å¹´åŠ<span class="hljs-number">2017</span>å¹´ï¼‰è¿›è¡Œå¯¹æ¯”ã€‚

**å¤‡æ³¨** Â 
æ•°æ®å•ä½ä¸ºâ€œä¸‡äººâ€ï¼Œæ•°å€¼ä¿ç•™ä¸¤ä½å°æ•°ï¼Œç»Ÿè®¡å£å¾„å¯èƒ½åŒ…å«åº”å±Šç”Ÿä¸å¤è¯»ç”Ÿã€‚å¦‚éœ€è¿›ä¸€æ­¥è§£è¯»ï¼Œå¯è¡¥å……å¤è¯»äººæ•°æˆ–åˆ†çœæ•°æ®è¾…åŠ©åˆ†æã€‚

--- Â 
ï¼ˆæŠ¥å‘ŠåŸºäºæä¾›çš„æ•°æ®ç”Ÿæˆï¼Œå†…å®¹ç®€æ´å®¢è§‚ï¼Œé¿å…è¿‡åº¦æ¨æµ‹ã€‚ï¼‰
------------------------------------------------------------

ğŸ‘¤ ä½ : <span class="hljs-number">2018</span>å¹´å‘¢ï¼Ÿ
=== ğŸŸ¦ Template Agent ===
ğŸ”„ æ£€æµ‹åˆ°å†å²ä¸Šä¸‹æ–‡ï¼Œå°è¯•å‚æ•°åŒ–è¿½é—®
ğŸ” æå–å‚æ•°: {<span class="hljs-string">"year"</span>: <span class="hljs-string">"2018"</span>}
ğŸ› ï¸ ç”Ÿæˆæ–° SQL: SELECT candidates_count AS 'è€ƒç”Ÿäººæ•°' FROM college_entrance_examination WHERE examination_year = <span class="hljs-number">2018</span>;
âœ… è¿½é—®æŸ¥è¯¢æˆåŠŸï¼Œè¿”å› <span class="hljs-number">1</span> è¡Œ
=== ğŸŸ© Analysis Agent ===
ğŸ’¬ åŠ©æ‰‹: **<span class="hljs-number">2016</span>å¹´é«˜è€ƒè€ƒç”Ÿäººæ•°åˆ†ææŠ¥å‘Š** Â 

**äº‹å®é™ˆè¿°** Â 
<span class="hljs-number">2016</span>å¹´é«˜è€ƒè€ƒç”Ÿäººæ•°ä¸º **<span class="hljs-number">975.0</span>ä¸‡äºº**ï¼ˆæ•°æ®æ¥æºï¼šè€ƒç”Ÿäººæ•°ä¸å¤è¯»äººæ•°ä¿¡æ¯è¡¨ï¼‰ã€‚

**ç®€è¦æ´å¯Ÿ** Â 
<span class="hljs-number">1</span>. å½“å‰æ•°æ®ä»…åŒ…å«å•ä¸€æ—¶é—´ç‚¹çš„è®°å½•ï¼Œæš‚æ— æ³•åˆ†æè¶‹åŠ¿å˜åŒ–ã€‚è‹¥éœ€è§‚å¯Ÿè€ƒç”Ÿäººæ•°å¢å‡è¶‹åŠ¿ï¼Œå»ºè®®è¡¥å……ç›¸é‚»å¹´ä»½æ•°æ®ï¼ˆå¦‚<span class="hljs-number">2015</span>å¹´åŠ<span class="hljs-number">2017</span>å¹´æ•°æ®ï¼‰ã€‚ Â 
<span class="hljs-number">2</span>. è¡¨ä¸­è¿˜åŒ…å«â€œå¤è¯»äººæ•°â€å­—æ®µï¼Œè‹¥éœ€è¿›ä¸€æ­¥åˆ†æå¤è¯»å¯¹è€ƒç”Ÿæ€»æ•°çš„å½±å“ï¼Œå¯æä¾›å¯¹åº”æ•°æ®åè¡¥å……è¯´æ˜ã€‚

**å¤‡æ³¨** Â 
æ•°æ®å•ä½ä¸ºâ€œä¸‡äººâ€ï¼Œå®é™…è€ƒç”Ÿäººæ•°ä¸º<span class="hljs-number">9</span>,<span class="hljs-number">750</span>,<span class="hljs-number">000</span>äººã€‚å¦‚éœ€æ›´æ·±å…¥çš„ç»Ÿè®¡åˆ†æï¼ˆå¦‚å¢é•¿ç‡ã€åŒºåŸŸå¯¹æ¯”ç­‰ï¼‰ï¼Œè¯·æä¾›æ‰©å±•æ•°æ®é›†ã€‚

--- Â 
**æŠ¥å‘Šè¯´æ˜**ï¼šæœ¬æŠ¥å‘ŠåŸºäºæä¾›çš„æ•°æ®ç›´æ¥å‘ˆç°æ ¸å¿ƒç»“è®ºï¼Œé¿å…å¯¹å•ä¸€æ•°æ®ç‚¹è¿›è¡Œæ¨æµ‹æ€§è§£è¯»ã€‚
------------------------------------------------------------

ğŸ‘¤ ä½ : å½•å–äººæ•°å‘¢ï¼Ÿ
=== ğŸŸ¦ Template Agent ===
ğŸ”„ æ£€æµ‹åˆ°å†å²ä¸Šä¸‹æ–‡ï¼Œå°è¯•å‚æ•°åŒ–è¿½é—®
ğŸ” æå–å‚æ•°: {}
âš ï¸ å¹´ä»½å‚æ•°æå–å¤±è´¥ï¼Œè¿›å…¥æ”¹å†™æµç¨‹
=== ğŸŸ¨ Rewrite Agent ===
âœï¸ æ”¹å†™åé—®é¢˜: <span class="hljs-number">2018</span>å¹´å…¨å›½é«˜è€ƒå½•å–äººæ•°æ˜¯å¤šå°‘ï¼Ÿ
=== ğŸŸ¦ Sql Agent ===
ğŸ†• å¯åŠ¨å®Œæ•´æŸ¥è¯¢æµç¨‹
è°ƒç”¨å¤§æ¨¡å‹llama2å‘é‡åŒ–ï¼š<span class="hljs-number">2018</span>å¹´å…¨å›½é«˜è€ƒå½•å–äººæ•°æ˜¯å¤šå°‘ï¼Ÿ
ğŸ“š åŒ¹é…è¡¨ç»“æ„: ['{<span class="hljs-string">"è¡¨å"</span>: <span class="hljs-string">"college_entrance_admission"</span>, <span class="hljs-string">"è¡¨å¤‡æ³¨"</span>: <span class="hljs-string">"å½•å–äººæ•°ä¸æ™®é€šé«˜æ ¡æ•°ä¿¡æ¯è¡¨ï¼ŒåŒ…å«å­—æ®µï¼šå½•å–å¹´ä»½(ä¸»é”®)ã€å½•å–äººæ•°(ä¸‡äºº)ã€æ‹›ç”Ÿé«˜æ ¡æ•°ã€æœ¬ç§‘å½•å–äººæ•°(ä¸‡äºº)ã€ä¸“ç§‘å½•å–äººæ•°(ä¸‡äºº)"</span>, <span class="hljs-string">"å­—æ®µåˆ—è¡¨"</span>: [{<span class="hljs-string">"å­—æ®µå"</span>: <span class="hljs-string">"admission_year"</span>, <span class="hljs-string">"å­—æ®µç±»å‹"</span>: <span class="hljs-string">"int"</span>, <span class="hljs-string">"å­—æ®µå¤‡æ³¨"</span>: <span class="hljs-string">"å½•å–å¹´ä»½"</span>}, {<span class="hljs-string">"å­—æ®µå"</span>: <span class="hljs-string">"admission_count"</span>, <span class="hljs-string">"å­—æ®µç±»å‹"</span>: <span class="hljs-string">"decimal(10,2)"</span>, <span class="hljs-string">"å­—æ®µå¤‡æ³¨"</span>: <span class="hljs-string">"å½•å–äººæ•°(ä¸‡äºº)"</span>}, {<span class="hljs-string">"å­—æ®µå"</span>: <span class="hljs-string">"university_count"</span>, <span class="hljs-string">"å­—æ®µç±»å‹"</span>: <span class="hljs-string">"int"</span>, <span class="hljs-string">"å­—æ®µå¤‡æ³¨"</span>: <span class="hljs-string">"æ‹›ç”Ÿé«˜æ ¡æ•°"</span>}, {<span class="hljs-string">"å­—æ®µå"</span>: <span class="hljs-string">"undergraduate_admission_count"</span>, <span class="hljs-string">"å­—æ®µç±»å‹"</span>: <span class="hljs-string">"decimal(10,2)"</span>, <span class="hljs-string">"å­—æ®µå¤‡æ³¨"</span>: <span class="hljs-string">"æœ¬ç§‘å½•å–äººæ•°(ä¸‡äºº)"</span>}, {<span class="hljs-string">"å­—æ®µå"</span>: <span class="hljs-string">"specialty_admission_count"</span>, <span class="hljs-string">"å­—æ®µç±»å‹"</span>: <span class="hljs-string">"decimal(10,2)"</span>, <span class="hljs-string">"å­—æ®µå¤‡æ³¨"</span>: <span class="hljs-string">"ä¸“ç§‘å½•å–äººæ•°(ä¸‡äºº)"</span>}]}']
ğŸ§  åŸå§‹æ„å›¾: <span class="hljs-number">2018</span>å¹´å…¨å›½é«˜è€ƒå½•å–äººæ•°æ˜¯å¤šå°‘ï¼Ÿ
ğŸ“¦ ä¿å­˜ SQL æ¨¡æ¿: SELECT admission_count AS 'è€ƒç”Ÿäººæ•°' FROM college_entrance_admission WHERE admission_year = {year};
=== ğŸŸ© Analysis Agent ===
ğŸ’¬ åŠ©æ‰‹: **<span class="hljs-number">2018</span>å¹´å…¨å›½é«˜è€ƒå½•å–äººæ•°åˆ†ææŠ¥å‘Š** Â 

**äº‹å®é™ˆè¿°** Â 
æ ¹æ®æ•°æ®è¡¨ `college_entrance_admission` è®°å½•ï¼Œ**<span class="hljs-number">2018</span>å¹´å…¨å›½é«˜è€ƒå½•å–äººæ•°ä¸º <span class="hljs-number">790.99</span> ä¸‡äºº**ã€‚

**ç®€è¦æ´å¯Ÿ** Â 
<span class="hljs-number">1</span>. **æ•°æ®èƒŒæ™¯**ï¼šè¯¥æ•°æ®åæ˜ å½“å¹´æ™®é€šé«˜æ ¡ï¼ˆå«æœ¬ç§‘åŠä¸“ç§‘ï¼‰å½•å–æ€»è§„æ¨¡ï¼Œä½†æœªæä¾›ä¸è€ƒç”Ÿäººæ•°ã€å½•å–ç‡çš„å¯¹æ¯”ä¿¡æ¯ã€‚ Â 
<span class="hljs-number">2</span>. **è¶‹åŠ¿å‚è€ƒ**ï¼šè‹¥ç»“åˆè¿‘å¹´æ•°æ®ï¼ˆéœ€è¡¥å……ï¼‰ï¼Œå¯è¿›ä¸€æ­¥åˆ†æå½•å–äººæ•°å˜åŒ–è¶‹åŠ¿ï¼›å½“å‰å•ä¸€æ•°æ®ç‚¹å»ºè®®è°¨æ…ç”¨äºé¢„æµ‹ã€‚ Â 
<span class="hljs-number">3</span>. **ç»“æ„ç»†åŒ–**ï¼šè¡¨ä¸­åŒ…å«æœ¬ç§‘ä¸ä¸“ç§‘åˆ†å±‚æ•°æ®å­—æ®µï¼ˆæœªåœ¨æœ¬æ¬¡ç»“æœä¸­ä½“ç°ï¼‰ï¼Œåç»­å¯é’ˆå¯¹å­¦å†å±‚æ¬¡ç»“æ„è¿›è¡Œæ·±å…¥åˆ†æã€‚

**æ³¨æ„äº‹é¡¹** Â 
- å½“å‰æ•°æ®ä¸ºå•ä¸€æ•°å€¼ï¼Œåˆ†æéœ€é¿å…è¿‡åº¦æ¨è®ºã€‚ Â 
- å¦‚éœ€è¯„ä¼°å½•å–ç«äº‰ç¨‹åº¦ï¼Œéœ€è¡¥å……åŒå¹´é«˜è€ƒæŠ¥åäººæ•°æˆ–æ‹›ç”Ÿè®¡åˆ’æ•°æ®ã€‚

--- Â 
**æŠ¥å‘Šè¯´æ˜**ï¼šæœ¬åˆ†æåŸºäºæä¾›çš„æ•°æ®è¡¨ç»“æ„åŠæŸ¥è¯¢ç»“æœï¼Œç¡®ä¿è¡¨è¿°ä¸åŸå§‹æ•°æ®ä¸€è‡´ã€‚
------------------------------------------------------------

ğŸ‘¤ ä½ :Â 
</code></pre>
<p>ç¬¬ä¸€è½®é—®é¢˜ï¼š2016å¹´è€ƒç”Ÿäººæ•°æœ‰å¤šå°‘ï¼Ÿ</p>
<p>ç¬¬ä¸€è½®æ²¡æœ‰ä¸Šä¸‹æ–‡ï¼Œä¹Ÿæ²¡æœ‰å…¨å±€å˜é‡æ¨¡æ¿ï¼Œæ‰€ä»¥ç›´æ¥èµ°SQL AgentÂ +Â Analysis AgentRAGæ£€ç´¢ã€ç”ŸæˆSQLã€æŸ¥æ•°ã€åˆ†æã€‚åŒæ—¶SQL Agentç”ŸæˆæˆåŠŸåè®°å½•SQLæ¨¡æ¿åˆ°å…¨å±€stateã€‚</p>
<p>ç¬¬äºŒè½®é—®é¢˜ï¼š2018å¹´å‘¢ï¼Ÿ</p>
<p>ç¬¬äºŒè½®æˆ‘ä»¬è¿½é—®2018å¹´ï¼Œè¿™æ—¶å­˜åœ¨å…¨å±€å˜é‡æ¨¡æ¿ï¼Œæ‰€ä»¥èµ°æ¨¡æ¿åŒ¹é…æå–å¹´ä»½å‚æ•°ï¼Œç›´æ¥æŸ¥æ•°ç„¶åé€šè¿‡ä¸šåŠ¡åˆ¤æ–­å­˜åœ¨æ•°æ®ï¼Œèµ°Analysis Agentåˆ†æã€‚</p>
<p>ç¬¬ä¸‰è½®é—®é¢˜ï¼šå½•å–äººæ•°å‘¢ï¼Ÿ</p>
<p>ç¬¬ä¸‰è½®æˆ‘ä»¬è¿½é—®å½•å–äººæ•°ï¼Œä½†æ˜¯åŒ¹é…ä¸åˆ°æ¨¡æ¿ï¼Œæ‰€ä»¥ä¸Šå±‚ä¸šåŠ¡åˆ¤æ–­èµ°Rewrite AgentÂ +Â SQL AgentÂ +Â Analysis Agentæ”¹å†™é—®é¢˜å®Œå–„æ¡ä»¶ã€‚æ”¹å†™æ—¶ï¼Œå‚è€ƒMemoryä¸­ä¸Šä¸‹æ–‡2016å’Œ2018å¹´å›ç­”ï¼Œæ”¹å†™ä¸º2018å¹´å…¨å›½é«˜è€ƒå½•å–äººæ•°æ˜¯å¤šå°‘ï¼Ÿç„¶åèµ°RAGæ£€ç´¢ã€ç”ŸæˆSQLã€æŸ¥æ•°ã€åˆ†æã€‚</p>
<h3 data-id="heading-3"><strong>ğŸ§© LangGraphå®ç°å°ç»“</strong></h3>
<p>æœ¬æ–‡ä½¿ç”¨LangGraphçš„Customå›¾æ¨¡å¼å®ç°æˆ‘ä»¬çš„å¤šæ™ºèƒ½ä½“åä½œå¤„ç†ä¸šåŠ¡ï¼š</p>
<ul>
<li>é€šè¿‡StataGraphçŠ¶æ€å›¾æ¥ç®¡ç†NodeèŠ‚ç‚¹ï¼ˆå¯¹åº”æ™ºèƒ½ä½“Agentï¼‰+edgeè¾¹ï¼ˆå¯¹åº”æ‰§è¡Œè·¯å¾„ï¼‰ï¼›</li>
<li>é€šè¿‡Checkpoint Memoryå®ç°é•¿æ—¶è®°å¿†ï¼Œç®¡ç†ä¸Šä¸‹æ–‡å’Œç»“æ„åŒ–å‚æ•°ï¼ˆæ¶ˆæ¯ã€SQL æ¨¡æ¿ã€è¡¨ç»“æ„ã€æŸ¥è¯¢ç»“æœç­‰ï¼‰ï¼Œæ‰€æœ‰agentéƒ½è¦éµå¾ªä¸€å®šè§„èŒƒï¼Œå°†çŠ¶æ€æœºä½œä¸ºè¾“å…¥å’Œè¾“å‡ºã€‚</li>
<li>ç›¸å¯¹æ¥è¯´ï¼Œä¸Šä¸€ç¯‡æ–‡ç« ä¸­ä»‹ç»AgentScopeæ¡†æ¶æ›´æ¾æ•£ï¼Œå…¶å¤šAgentåä½œæœºåˆ¶æ˜¯é€šè¿‡è‡ªå®šä¹‰æ§åˆ¶é€»è¾‘+ç®¡é“pipelineæ¥ä¸²è”ï¼Œé€šè¿‡æ¡†æ¶æä¾›çš„memoryåªèƒ½ç®¡ç†å¤šè½®å¯¹è¯çš„ä¸Šä¸‹æ–‡ï¼Œå¤šæ™ºèƒ½ä½“å¤šè½®æ¬¡ä¹‹é—´çš„å‚æ•°ä¼ é€’ï¼Œéœ€è¦é€šè¿‡è‡ªå®šä¹‰å…¨å±€å˜é‡æ¥å®ç°ã€‚</li>
<li/>
</ul>
<h3 data-id="heading-4"><strong>é™„å½•ï¼šLangGraphå‡ ç§å…¸å‹åä½œæ¨¡å¼</strong></h3>
<p>LangGraphÂ æ˜¯åŸºäºLangChainç”Ÿæ€æ„å»ºï¼Œå®ƒå¼ºè°ƒã€ŒçŠ¶æ€å›¾ï¼ˆStateGraphï¼‰ã€å’Œã€Œå¯è¿½æº¯è®°å¿†ï¼ˆCheckpoint Memoryï¼‰ã€ï¼Œå®ƒæå‡ºäº†å‡ ç§Multi-Agentæ¨¡å¼ï¼Œé€‚ç”¨äºä¸åŒçš„è°ƒç”¨é€»è¾‘å’Œæ§åˆ¶æµéœ€æ±‚ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f53c2c4e854465f81f4a6811a0e3e84~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyo5piG5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768266843&amp;x-signature=HfB6%2BekD0f5QzPlS8FtuDeKFT7c%3D" alt="image.png" loading="lazy"/></p>
<p>ç½‘ç»œï¼ˆNetworkï¼‰æ¨¡å¼</p>
<ul>
<li>å„AgentèŠ‚ç‚¹å½¼æ­¤å¤šå¯¹å¤šé€šä¿¡ï¼šæ¯ä¸ªAgentæœ‰æƒé™å†³å®šæ¥ä¸‹æ¥è°ƒç”¨å“ªä¸ªå…¶ä»–Agentã€‚</li>
<li>é€‚ç”¨äºâ€œæ²¡æœ‰å›ºå®šé¡ºåºâ€â€œè¾ƒçµæ´»çš„è°ƒç”¨å…³ç³»â€çš„åœºæ™¯ã€‚</li>
<li>ä»£ç ç¤ºä¾‹ä¸­ï¼ŒAgent agent_1ã€agent_2ã€agent_3 å‡å¯è·³è½¬è‡³å…¶ä»–ä¸¤ä¸ªæˆ–ç»“æŸã€‚</li>
</ul>
<p>ä¸»ç®¡ï¼ˆSupervisorï¼‰æ¨¡å¼</p>
<ul>
<li>ä¸€ä¸ªâ€œä¸»ç®¡Agentâ€è´Ÿè´£å†³å®šä¸‹ä¸€æ­¥è°ƒç”¨å“ªä¸ªå­Agentã€‚å­Agentæ‰§è¡Œåå†å›åˆ°ä¸»ç®¡ã€‚</li>
<li>é€‚ç”¨äºâ€œä¸­å¤®è°ƒåº¦æ§åˆ¶â€â€œæ˜ç¡®è°æ¥å†³å®šæµç¨‹â€çš„åœºæ™¯ã€‚</li>
<li>ç¤ºä¾‹ï¼šsupervisorÂ å†³å®šè°ƒç”¨Â agent_1Â æˆ–Â agent_2ã€‚</li>
</ul>
<p>ä¸»ç®¡ï¼ˆSupervisor as Tools å·¥å…·è°ƒç”¨ï¼‰æ¨¡å¼</p>
<ul>
<li>æ˜¯â€œä¸»ç®¡â€æ¨¡å¼çš„ä¸€ä¸ªç‰¹ä¾‹ï¼šå­Agentè¢«æš´éœ²ä¸ºâ€œå·¥å…·â€ï¼ˆtoolï¼‰ï¼Œä¸»ç®¡Agentåƒå·¥å…·è°ƒç”¨ç³»ç»Ÿä¸€æ ·ï¼Œå†³å®šè°ƒç”¨å“ªä¸ªå·¥å…·ï¼å­Agentã€‚</li>
<li>å…¸å‹æµç¨‹ï¼šä¸»ç®¡ä»¥ ReAct ï¼ˆæ€è€ƒâ†’è¡ŒåŠ¨â†’æ€è€ƒï¼‰æ–¹å¼å¾ªç¯è°ƒç”¨å·¥å…·ç›´åˆ°å†³ç­–ç»“æŸã€‚</li>
<li>æä¾›äº†Â create_react_agentÂ ç­‰é¢„ç½®ç»„ä»¶ã€‚</li>
</ul>
<p>åˆ†å±‚ï¼ˆHierarchicalï¼‰æ¨¡å¼</p>
<ul>
<li>å½“Agentæ•°é‡å¢å¤šã€æµç¨‹æ›´å¤æ‚æ—¶ï¼Œç”¨â€œä¸»ç®¡çš„ä¸»ç®¡â€æ¥ç®¡ç†å›¢é˜Ÿï¼å­ç³»ç»Ÿï¼Œå½¢æˆå±‚çº§ç»“æ„ã€‚</li>
<li>æ¯ä¸ªå›¢é˜Ÿå†…æœ‰è‡ªå·±çš„ä¸»ç®¡+å­Agentï¼Œå†ç”±é¡¶å±‚ä¸»ç®¡å†³å®šè°ƒç”¨å“ªä¸ªå›¢é˜Ÿã€‚</li>
<li>é€‚åˆæ›´å¤§è§„æ¨¡ã€è·¨é¢†åŸŸã€å¤šå›¢é˜Ÿåä½œçš„ç³»ç»Ÿã€‚</li>
</ul>
<p>è‡ªå®šä¹‰ï¼ˆCustom Workflowï¼‰æ¨¡å¼ï¼ˆå¯¹åº”æœ¬æ–‡æ¡ˆä¾‹ï¼‰</p>
<ul>
<li>ä½ ä¹Ÿå¯ä»¥æ‰‹åŠ¨å®šä¹‰AgentèŠ‚ç‚¹åŠå…¶é¡ºåºï¼ˆæ˜¾å¼æ§åˆ¶æµï¼‰æˆ–éƒ¨åˆ†ç”± LLM å†³å®šï¼ˆåŠ¨æ€æ§åˆ¶æµï¼‰ã€‚</li>
<li>æ˜¾å¼æ§åˆ¶æµï¼šåœ¨å›¾ä¸­é¢„å…ˆå®šä¹‰è¾¹Â agent_1 â†’ agent_2 â†’ agent_3ã€‚</li>
<li>é€‚åˆéœ€è¦ã€Œå¼ºæ§åˆ¶æµã€ã€Œå¤æ‚çŠ¶æ€ç®¡ç†ã€ã€Œä¸Šä¸‹æ–‡å¤ç”¨ã€çš„åœºæ™¯ã€‚</li>
</ul>
<p>æºç å‚è€ƒï¼šå‚ä¸åä½œçš„å››ä¸ªæ™ºèƒ½ä½“ï¼Œä»¥åŠå…·ä½“åä½œæ§åˆ¶é€»è¾‘ä»£ç ï¼Œè¯¦è§<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FMuKunZiAI%2Fcollege_entrance_ai%2Fblob%2Fmain%2Flangchain_code%2Fagent_service_graph.py%25E3%2580%2582" target="_blank" title="https://github.com/MuKunZiAI/college_entrance_ai/blob/main/langchain_code/agent_service_graph.py%E3%80%82" ref="nofollow noopener noreferrer">github.com/MuKunZiAI/câ€¦</a></p>
<p>æœ¬æ–‡æ€»ç»“ï¼šæœ¬æ–‡é’ˆå¯¹é«˜è€ƒä¿¡æ¯æ™ºèƒ½æŸ¥è¯¢çš„ä¸šåŠ¡åœºæ™¯ï¼Œé‡‡ç”¨LangGraphæ¡†æ¶éªŒè¯å¤šæ™ºèƒ½ä½“åä½œæœºåˆ¶ï¼Œé€šè¿‡çŠ¶æ€å›¾StataGraphæ¥ç®¡ç†èŠ‚ç‚¹+æ¡ä»¶è¾¹ç»„æˆåä½œæ‰§è¡Œè·¯å¾„ï¼Œé€šè¿‡Checkpoint Memoryæ¥ç®¡ç†å¤šè½®å¯¹è¯ä¸Šä¸‹æ–‡å’Œè·¨æ™ºèƒ½ä½“ç»“æ„åŒ–å‚æ•°ä¼ é€’ï¼Œæœ€ååˆ†äº«äº†LangGraphå®˜ç½‘çš„å‡ ç§å…¸å‹åä½œæ¨¡å¼</p>
<p>æœ¬æ–‡ä½œè€…ï¼šChaiys</p>
<p>æœ¬æ–‡åŸè½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F0pfVEeESi-UBYhHqmSNZaQ" target="_blank" title="https://mp.weixin.qq.com/s/0pfVEeESi-UBYhHqmSNZaQ" ref="nofollow noopener noreferrer">å…¬ä¼—å·â€œæœ¨æ˜†å­è®°å½•AIâ€</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI Agents çš„ Skills æ–‡ä»¶è¯¦è§£]]></title>    <link>https://juejin.cn/post/7591744411739242496</link>    <guid>https://juejin.cn/post/7591744411739242496</guid>    <pubDate>2026-01-06T01:45:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591744411739242496" data-draft-id="7591655106723921920" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI Agents çš„ Skills æ–‡ä»¶è¯¦è§£"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-06T01:45:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜æœˆ_æ¸…é£"/> <meta itemprop="url" content="https://juejin.cn/user/1081575170131006"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI Agents çš„ Skills æ–‡ä»¶è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1081575170131006/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜æœˆ_æ¸…é£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T01:45:47.000Z" title="Tue Jan 06 2026 01:45:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨2026å¹´çš„AIä»£ç†ï¼ˆAI Agentsï¼‰ç”Ÿæ€ä¸­ï¼Œç‰¹åˆ«æ˜¯å¤šä»£ç†ç³»ç»Ÿï¼ˆMulti-Agent Systemsï¼‰å’Œä¸»æµæ¡†æ¶å¦‚Claudeã€Codexã€VS Code Copilotç­‰ï¼Œâ€œskills æ–‡ä»¶â€å·²æˆä¸ºå®šä¹‰ä»£ç†ä¸“é•¿èƒ½åŠ›çš„æ ¸å¿ƒæ–¹å¼ã€‚å®ƒæ˜¯ä¸€ç§æ ‡å‡†åŒ–ã€å¯å¤ç”¨ã€å¯å…±äº«çš„é…ç½®æ–‡ä»¶ï¼Œå¸®åŠ©AIä»£ç†ä»é€šç”¨æ¨¡å‹è½¬å˜ä¸ºä¸“ç²¾ä¸“å®¶ï¼Œè€Œæ— éœ€é‡æ–°è®­ç»ƒæ¨¡å‹ã€‚</p>
<h4 data-id="heading-0">ä»€ä¹ˆæ˜¯ Skills æ–‡ä»¶ï¼Ÿ</h4>
<p>Skills æ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯<strong>SKILL.md</strong>ï¼ˆä¸€ä¸ªMarkdownæ–‡ä»¶ï¼‰ï¼Œä½äºä¸€ä¸ªä¸“ç”¨æ–‡ä»¶å¤¹ä¸­ã€‚å®ƒéµå¾ªå¼€æ”¾æ ‡å‡†ï¼ˆAgent Skills Specificationï¼Œç”±Anthropicã€OpenAIç­‰æ¨åŠ¨ï¼‰ï¼ŒåŒ…å«ï¼š</p>
<ul>
<li><strong>YAML Frontmatter</strong>ï¼šå…ƒæ•°æ®ï¼Œç”¨äºä»£ç†å¿«é€Ÿå‘ç°å’Œé€‰æ‹©æŠ€èƒ½ã€‚</li>
<li><strong>Markdown æ­£æ–‡</strong>ï¼šè¯¦ç»†æŒ‡ä»¤ã€æŒ‡å—ã€ç¤ºä¾‹ã€è¾¹ç¼˜æ¡ˆä¾‹ç­‰ï¼Œå‘Šè¯‰ä»£ç†â€œå¦‚ä½•æ‰§è¡Œè¿™é¡¹æŠ€èƒ½â€ã€‚</li>
</ul>
<p>è¿™ç§è®¾è®¡å®ç°äº†â€œæ¸è¿›å¼æŠ«éœ²â€ï¼ˆProgressive Disclosureï¼‰ï¼šä»£ç†å¯åŠ¨æ—¶åªåŠ è½½æŠ€èƒ½çš„åç§°å’Œæè¿°ï¼ˆèŠ‚çœtokenï¼‰ï¼Œåªæœ‰å†³å®šä½¿ç”¨æ—¶æ‰åŠ è½½å®Œæ•´å†…å®¹ã€‚</p>
<p>ä¸å…¶ä»–æ¡†æ¶å¯¹æ¯”ï¼š</p>
<ul>
<li><strong>CrewAI</strong>ï¼šä½¿ç”¨YAMLæ–‡ä»¶ï¼ˆå¦‚agents.yamlï¼‰å®šä¹‰ä»£ç†çš„roleã€goalã€backstoryå’Œtoolsï¼Œä½†ä¸æ˜¯â€œskillsâ€æ ‡å‡†ã€‚</li>
<li><strong>LangChain</strong>ï¼šæ›´å¤šä¾èµ–å·¥å…·ï¼ˆtoolsï¼‰å’ŒåŠ¨æ€åŠ è½½æç¤ºï¼Œä½†å¯æ¨¡æ‹Ÿskillsã€‚</li>
<li><strong>AutoGPT/Swarm</strong>ï¼šæ— ä¸“ç”¨skillsæ–‡ä»¶ï¼Œé é…ç½®æˆ–ä»£ç å®šä¹‰èƒ½åŠ›ã€‚</li>
</ul>
<p>ä¸»æµé‡‡ç”¨çš„æ˜¯<strong>SKILL.md</strong>æ ¼å¼ï¼Œå·²æˆä¸ºè·¨å¹³å°æ ‡å‡†ï¼ˆClaude Codeã€Cursorã€GitHub Copilotç­‰å‡æ”¯æŒï¼‰ã€‚</p>
<h4 data-id="heading-1">SKILL.md æ–‡ä»¶çš„åŸºæœ¬ç»“æ„</h4>
<p>ä¸€ä¸ªå…¸å‹çš„SKILL.md æ–‡ä»¶ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">---
name: code-review-master
description: ä¸“ä¸šä»£ç å®¡æŸ¥æŠ€èƒ½ï¼ŒæŒ‰ç…§å›¢é˜Ÿæœ€ä½³å®è·µå®¡æŸ¥Pull Requestï¼Œç¡®ä¿ä»£ç è´¨é‡ã€å®‰å…¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚
metadata:
  short-description: å›¢é˜Ÿæ ‡å‡†ä»£ç å®¡æŸ¥ä¸“å®¶
  compatibility: claude-4, codex-2026
<span class="hljs-section">  license: Apache-2.0
---</span>

<span class="hljs-section"># ä»£ç å®¡æŸ¥å¤§å¸ˆ</span>

ä½ æ˜¯ä¸€ä¸ªèµ„æ·±çš„ä»£ç å®¡æŸ¥ä¸“å®¶ï¼Œéµå¾ªä»¥ä¸‹ä¸¥æ ¼æµç¨‹å®¡æŸ¥ä»£ç å˜æ›´ã€‚

<span class="hljs-section">## æ ¸å¿ƒåŸåˆ™</span>
<span class="hljs-bullet">-</span> ä¼˜å…ˆæ£€æŸ¥å®‰å…¨æ€§ï¼ˆæ³¨å…¥ã€æ³„æ¼ã€æƒé™ï¼‰ã€‚
<span class="hljs-bullet">-</span> ç¡®ä¿ä»£ç å¯è¯»æ€§ã€ä¸€è‡´æ€§å’Œæ€§èƒ½ã€‚
<span class="hljs-bullet">-</span> æä¾›å»ºè®¾æ€§åé¦ˆï¼Œå»ºè®®å…·ä½“æ”¹è¿›ã€‚

<span class="hljs-section">## é€æ­¥å®¡æŸ¥æµç¨‹</span>
<span class="hljs-bullet">1.</span> <span class="hljs-strong">**ç†è§£ä¸Šä¸‹æ–‡**</span>ï¼šé˜…è¯»PRæè¿°ã€ç›¸å…³æ–‡ä»¶å’Œå˜æ›´å†å²ã€‚
<span class="hljs-bullet">2.</span> <span class="hljs-strong">**æ£€æŸ¥ç»“æ„**</span>ï¼šéªŒè¯æ¶æ„æ˜¯å¦åˆç†ï¼Œæ˜¯å¦æœ‰æ›´å¥½çš„è®¾è®¡æ¨¡å¼ã€‚
<span class="hljs-bullet">3.</span> <span class="hljs-strong">**ä»£ç è´¨é‡**</span>ï¼šæ£€æŸ¥å‘½åã€æ³¨é‡Šã€é”™è¯¯å¤„ç†å’Œæµ‹è¯•è¦†ç›–ã€‚
<span class="hljs-bullet">4.</span> <span class="hljs-strong">**å®‰å…¨ä¸æ€§èƒ½**</span>ï¼šæ‰«ææ½œåœ¨æ¼æ´å’Œä¼˜åŒ–ç‚¹ã€‚
<span class="hljs-bullet">5.</span> <span class="hljs-strong">**è¾“å‡ºæ ¼å¼**</span>ï¼šç”¨Markdownè¡¨æ ¼æ€»ç»“é—®é¢˜ï¼ŒæŒ‰ä¸¥é‡åº¦åˆ†ç±»ï¼ˆCritical / Major / Minorï¼‰ã€‚

<span class="hljs-section">## ç¤ºä¾‹è¾“å‡º</span>
| ä¸¥é‡åº¦ | æ–‡ä»¶ | è¡Œå· | é—®é¢˜æè¿° | å»ºè®®ä¿®å¤ |
|--------|------|------|----------|----------|
| Critical | app.py | 45 | SQLæ³¨å…¥é£é™© | ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ |

<span class="hljs-section">## å¸¸è§è¾¹ç¼˜æ¡ˆä¾‹</span>
<span class="hljs-bullet">-</span> å¤„ç†å¤§å‹å˜æ›´ï¼šå…ˆæ¦‚è¿°æ•´ä½“å½±å“ï¼Œå†ç»†åŒ–ã€‚
<span class="hljs-bullet">-</span> ç¬¬ä¸‰æ–¹åº“ï¼šæ£€æŸ¥ç‰ˆæœ¬å…¼å®¹æ€§å’Œå·²çŸ¥æ¼æ´ã€‚

ï¼ˆå¯é€‰ï¼šæ–‡ä»¶å¤¹ä¸­å¯é™„å¸¦è„šæœ¬ã€æ¨¡æ¿æˆ–å‚è€ƒæ–‡ä»¶ï¼Œå¦‚review<span class="hljs-emphasis">_template.mdï¼‰
</span></code></pre>
<h4 data-id="heading-2">å¦‚ä½•ä½¿ç”¨ Skills æ–‡ä»¶ï¼Ÿ</h4>
<ol>
<li><strong>åˆ›å»ºæ–‡ä»¶å¤¹</strong>ï¼šå¦‚ <code>.claude/skills/code-review/</code> æˆ– <code>~/.codex/skills/code-review/</code>ã€‚</li>
<li><strong>æ”¾ç½® SKILL.md</strong>ï¼šç¡®ä¿æ–‡ä»¶åç²¾ç¡®ä¸ºSKILL.mdã€‚</li>
<li><strong>å¯ç”¨</strong>ï¼šåœ¨ä»£ç†é…ç½®ä¸­å…è®¸skillsï¼ˆå¤šæ•°æ¡†æ¶é»˜è®¤æ”¯æŒï¼‰ã€‚</li>
<li><strong>è°ƒç”¨</strong>ï¼šä»£ç†ä¼šè‡ªåŠ¨æ ¹æ®ä»»åŠ¡æè¿°é€‰æ‹©å¹¶åŠ è½½æŠ€èƒ½ã€‚ä¾‹å¦‚ï¼Œä½ å¯¹Claudeè¯´ï¼šâ€œç”¨å›¢é˜Ÿæ ‡å‡†å®¡æŸ¥è¿™ä¸ªPRâ€ï¼Œå®ƒä¼šæ¿€æ´»å¯¹åº”skillsã€‚</li>
</ol>
<h4 data-id="heading-3">ä¸ºä»€ä¹ˆ2026å¹´ Skills æ–‡ä»¶å¦‚æ­¤é‡è¦ï¼Ÿ</h4>
<ul>
<li><strong>æ¨¡å—åŒ–</strong>ï¼šä¸€ä¸ªæŠ€èƒ½æ–‡ä»¶å³å¯èµ‹äºˆä»£ç†æ–°èƒ½åŠ›ï¼Œå¯å…±äº«ï¼ˆå¦‚GitHubä»“åº“ï¼‰ã€‚</li>
<li><strong>é«˜æ•ˆ</strong>ï¼šé¿å…æ¯æ¬¡æç¤ºéƒ½é‡å¤é•¿æŒ‡ä»¤ï¼ŒèŠ‚çœè®¡ç®—èµ„æºã€‚</li>
<li><strong>åä½œ</strong>ï¼šå¤šä»£ç†ç³»ç»Ÿä¸­ï¼Œä¸åŒä»£ç†å¯åŠ è½½ä¸åŒskillsï¼Œå®ç°ä¸“ä¸šåˆ†å·¥ã€‚</li>
<li><strong>å¼€æºç”Ÿæ€</strong>ï¼šå·²æœ‰å¤§é‡ç¤¾åŒºskillsï¼ˆå¦‚PDFå¤„ç†ã€Excelåˆ†æã€ä»£ç ç”Ÿæˆï¼‰ï¼Œå¯ç›´æ¥ä¸‹è½½ä½¿ç”¨ã€‚</li>
</ul>
<p>é€šè¿‡Skillsæ–‡ä»¶ï¼Œä½ å¯ä»¥å°†AIä»£ç†ä»â€œä¸‡é‡‘æ²¹â€å˜æˆâ€œä¸“æ‰å›¢é˜Ÿâ€ã€‚åœ¨2026å¹´ï¼ŒæŒæ¡è¿™ç§é…ç½®æ–¹å¼ï¼Œå°†æ˜¯æ„å»ºé«˜æ•ˆå¤šä»£ç†ç³»ç»Ÿçš„å…³é”®æŠ€èƒ½ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æŠ–éŸ³æ€è·¯å¤åˆ»ï¼šiOS å¡æ­»ï¼ˆANRï¼‰ç›‘æ§ + è‡ªåŠ¨ç¬¦å·åŒ–å…¨æµç¨‹å®æˆ˜]]></title>    <link>https://juejin.cn/post/7591704324907057186</link>    <guid>https://juejin.cn/post/7591704324907057186</guid>    <pubDate>2026-01-05T16:17:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591704324907057186" data-draft-id="7591655106724872192" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æŠ–éŸ³æ€è·¯å¤åˆ»ï¼šiOS å¡æ­»ï¼ˆANRï¼‰ç›‘æ§ + è‡ªåŠ¨ç¬¦å·åŒ–å…¨æµç¨‹å®æˆ˜"/> <meta itemprop="keywords" content="iOS,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2026-01-05T16:17:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Daniel02"/> <meta itemprop="url" content="https://juejin.cn/user/2277843825853511"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æŠ–éŸ³æ€è·¯å¤åˆ»ï¼šiOS å¡æ­»ï¼ˆANRï¼‰ç›‘æ§ + è‡ªåŠ¨ç¬¦å·åŒ–å…¨æµç¨‹å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2277843825853511/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Daniel02
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-05T16:17:01.000Z" title="Mon Jan 05 2026 16:17:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ iOS ä¸Šï¼ŒApp åœ¨å¯åŠ¨ / é€€å‡º / å“åº”ç³»ç»Ÿäº‹ä»¶ç­‰å…³é”®é˜¶æ®µå¦‚æœé•¿æ—¶é—´å¡ä½ï¼Œè¶…è¿‡ç³»ç»Ÿé˜ˆå€¼å°±ä¼šè§¦å‘ä¿æŠ¤æœºåˆ¶ï¼Œæœ€ç»ˆè¢« Watchdog ä»¥ <strong>SIGKILL</strong> å¼ºåˆ¶ç»ˆæ­¢ã€‚è¿™ç±»å¼‚å¸¸çš„å…±åŒç‰¹ç‚¹æ˜¯ï¼š<strong>ä¸æ˜¯è¿›ç¨‹å†…å¼‚å¸¸æŠ›å‡ºï¼Œè€Œæ˜¯â€œè¿›ç¨‹å¤–æŒ‡ä»¤â€ç›´æ¥ç»“æŸè¿›ç¨‹</strong>ï¼Œå› æ­¤ä¼ ç»ŸåŸºäº signal/exception çš„å´©æºƒæ•è·å¾€å¾€è¦†ç›–ä¸åˆ°ï¼Œä¹Ÿå°±å¯¼è‡´å®ƒåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç»å¸¸â€œåªè§æ•°æ®ã€ä¸è§å †æ ˆâ€ï¼Œé•¿æœŸè¢«å¿½è§†ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªç›²åŒºï¼Œæˆ‘é€‰æ‹©ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼šæœ¬æ–‡å®è·µå¹¶å¤ç°å­—èŠ‚è·³åŠ¨å›¢é˜Ÿçš„æ–‡ç« <a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FcEfIZGtUojKKbhIfUyhTMw" target="_blank" title="https://mp.weixin.qq.com/s/cEfIZGtUojKKbhIfUyhTMw" ref="nofollow noopener noreferrer">ã€ŠiOS ç¨³å®šæ€§é—®é¢˜æ²»ç†ï¼šå¡æ­»å´©æºƒç›‘æ§åŸç†åŠæœ€ä½³å®è·µ</a>ã€‹ï¼Œä» <strong>åŸç† â†’ ä»£ç å®ç° â†’ å€™é€‰æ–‡ä»¶ä¿å­˜ â†’ dSYM/atos/è„šæœ¬ç¬¦å·åŒ– + Swift demangle</strong>ï¼ŒæŠŠä¸€æ•´å¥—å¡æ­»ï¼ˆANR/Watchdogï¼‰ç›‘æ§é“¾è·¯å®Œæ•´è·‘é€šï¼Œå¹¶æ²‰æ·€æˆä¸€ä¸ªå¯å¤ç”¨ Demoã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/03ce7844ae014fe6be0ef3b24f3cd4c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRGFuaWVsMDI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768234621&amp;x-signature=OgE%2FBhd1Zay%2BShb9QHdXc015j6Y%3D" alt="" width="200" height="400" loading="lazy"/></p>
<blockquote>
<p>æ–‡æœ«ç»™å‡ºå®Œæ•´ä»£ç é“¾æ¥</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">1. ç—›ç‚¹ï¼šå¡æ­»æœ€éš¾çš„ä¸æ˜¯â€œçŸ¥é“å¡â€ï¼Œè€Œæ˜¯â€œçŸ¥é“å¡åœ¨å“ªâ€</h2>
<p>çº¿ä¸Šå¡æ­»/å‡æ­»å¸¸è§ç°è±¡ï¼š</p>
<ul>
<li>UI ä¸å“åº”ï¼ˆç‚¹å‡»æ— ååº”ã€æ»‘åŠ¨å¡ä½ï¼‰ï¼Œå‡ ç§’åæ¢å¤æˆ–è¢«ç³»ç»Ÿæ€æ‰</li>
<li>Crash æ—¥å¿—æ²¡æœ‰ï¼ˆä¸æ˜¯è¿›ç¨‹å†… crashï¼‰ï¼Œåªå‰©ç”¨æˆ·åé¦ˆï¼šâ€œåˆšåˆšå¡ä½äº†â€</li>
<li>æ‹¿åˆ°çš„å †æ ˆæ˜¯ä¸€å † <code>0x00000001....</code> åœ°å€ï¼š<strong>ä¸ç¬¦å·åŒ–å°±ç­‰äºæ²¡æœ‰ç»“è®º</strong></li>
</ul>
<p>æ‰€ä»¥è¦è§£å†³è¿™ç±»é—®é¢˜ï¼Œæœ¬è´¨æ˜¯ä¸¤ä»¶äº‹ï¼š</p>
<ol>
<li><strong>å¡æ­»å½“ä¸‹æŠ“åˆ°ä¸»çº¿ç¨‹å †æ ˆ</strong>ï¼ˆæˆ–å¡æ­»æœŸé—´æŒç»­é‡‡æ ·ï¼‰</li>
<li><strong>è‡ªåŠ¨ç¬¦å·åŒ–</strong>ï¼šæŠŠåœ°å€å˜æˆå¯è¯»å‡½æ•°åï¼Œå¹¶å°½å¯èƒ½ demangle Swift ç¬¦å·</li>
</ol>
<hr/>
<h2 data-id="heading-1">2. åŸç†ï¼šRunLoop å¿ƒè·³ + è¶…é˜ˆå€¼é‡‡æ · = è¿˜åŸå¡æ­»ç°åœº</h2>
<h3 data-id="heading-2">2.1 ç›‘æ§â€œä¸»çº¿ç¨‹å¡æ­»â€çš„æœ¬è´¨</h3>
<p>ä¸»çº¿ç¨‹ RunLoop æ­£å¸¸æƒ…å†µä¸‹ä¼šä¸æ–­åœ¨è¿™äº›çŠ¶æ€é—´æµè½¬ï¼š</p>
<ul>
<li><code>BeforeTimers</code></li>
<li><code>BeforeSources</code></li>
<li><code>BeforeWaiting</code></li>
<li><code>AfterWaiting</code></li>
</ul>
<p>å½“ä¸»çº¿ç¨‹æ‰§è¡Œé‡ä»»åŠ¡ï¼ˆå¤§è§£æ / åŒæ­¥ IO / å¤æ‚å¸ƒå±€ / é”ç­‰å¾…ç­‰ï¼‰ï¼ŒRunLoop ä¼šé•¿æœŸå¡åœ¨æŸä¸ªé˜¶æ®µä¸åŠ¨ï¼Œè¡¨ç°ä¸º UI æ— å“åº”ã€‚</p>
<h3 data-id="heading-3">2.2 æœ¬ Demo çš„æ£€æµ‹ç­–ç•¥ï¼ˆå°½é‡å‘â€œæŠ–éŸ³æ–¹æ¡ˆâ€é æ‹¢ï¼‰</h3>
<p>Demo é‡‡ç”¨çš„ç­–ç•¥ï¼ˆå‚æ•°å¯¹é½ä½ å½“å‰å®ç°ï¼‰ï¼š</p>
<ul>
<li><strong>é˜ˆå€¼ï¼š8 ç§’</strong>ï¼ˆ<code>hangThreshold = 8</code>ï¼‰</li>
<li><strong>æ£€æµ‹å‘¨æœŸï¼š1 ç§’çª—å£</strong>ï¼ˆ<code>tickInterval = 1</code>ï¼‰</li>
<li><strong>è¶…è¿‡é˜ˆå€¼åï¼šæ¯ç§’é‡‡æ ·ä¸€æ¬¡ä¸»çº¿ç¨‹æ ˆ</strong>ï¼ˆä» Live Report ä¸­æå– <code>Thread 0</code>ï¼‰</li>
<li><strong>æœ€å¤šä¿ç•™ 10 å¸§æ ·æœ¬</strong>ï¼ˆ<code>maxMainThreadSamples = 10</code>ï¼Œä¿ç•™æœ€è¿‘ 10 æ¬¡ï¼‰</li>
</ul>
<blockquote>
<p>è¿™å¥—ç­–ç•¥çš„æ„ä¹‰æ˜¯ï¼š<br/>
<strong>å…ˆåˆ¤æ–­â€œå·²ç»å¡æ­»åˆ°è¶³å¤Ÿä¸¥é‡â€</strong>ï¼ˆæ¥è¿‘ Watchdog é£é™©ï¼‰ï¼Œå†è¿›å…¥â€œæŒç»­é‡‡æ ·â€ï¼Œé¿å…æŠŠè½»å¾®å¡é¡¿ä¹Ÿå½“æˆå¡æ­»å»æŠ“æ ˆ/å†™æ–‡ä»¶ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-4">3. Demo å®ç°ç»“æ„</h2>
<h3 data-id="heading-5">3.1 é¡¹ç›®ç›®å½•éª¨æ¶</h3>
<pre><code class="hljs language-text" lang="text">LagMonitorDemo/
â”œâ”€â”€ LagMonitorDemo.xcodeproj
â”œâ”€â”€ Sources/
â”‚   â””â”€â”€ Monitor/
â”‚      â”œâ”€â”€ HMDANRMonitor.swift
â”‚      â”œâ”€â”€ HMDLiveReportCapture.swift
â”‚      â”œâ”€â”€ HMDANRRecord.swift
â”‚      â”œâ”€â”€ HMDANRCandidateStore.swift
â”‚      â””â”€â”€ HMDDebugCacheCleaner.swift
â”œâ”€â”€ Scripts/
â”‚   â””â”€â”€ hmd_anr_symbolicate.py
â””â”€â”€ Samples/
    â”œâ”€â”€ hmd_anr_candidate.json
    â””â”€â”€ symbolicated.txt
</code></pre>
<hr/>
<h3 data-id="heading-6">3.2 Monitorï¼šHMDANRMonitor.swiftï¼ˆæ ¸å¿ƒç›‘æ§å™¨ï¼‰</h3>
<h4 data-id="heading-7">3.2.1 ç›‘æ§ç›®æ ‡</h4>
<ul>
<li>ä¸»çº¿ç¨‹è£… <code>CFRunLoopObserver</code>ï¼Œæ¯æ¬¡å›è°ƒè®¤ä¸º RunLoop æ¨è¿›ï¼š<code>heartbeat += 1</code></li>
<li>ç›‘æ§çº¿ç¨‹ç”¨ <strong>1 ç§’è§‚å¯Ÿçª—å£</strong>æ£€æŸ¥ <code>heartbeat</code> æ˜¯å¦å˜åŒ–
<ul>
<li><strong>1 ç§’å†…æœ‰æ¨è¿›</strong>ï¼šå¥åº·/æ¢å¤ï¼Œæ¸…ç†å€™é€‰</li>
<li><strong>1 ç§’å†…æ— æ¨è¿›</strong>ï¼šè®¤ä¸ºå¡ä½ï¼Œ<code>hangSeconds += 1</code></li>
</ul>
</li>
<li>å¡ä½ç´¯è®¡è¾¾åˆ° <strong>8 ç§’é˜ˆå€¼</strong>ï¼šåˆ›å»º candidate</li>
<li>è¶…é˜ˆå€¼åä»æœªæ¢å¤ï¼š<strong>æ¯ç§’é‡‡æ ·ä¸€æ¬¡ä¸»çº¿ç¨‹æ ˆ</strong>ï¼Œæœ€å¤š 10 å¸§</li>
</ul>
<h4 data-id="heading-8">3.2.2 ä¸ºä»€ä¹ˆçœ‹èµ·æ¥â€œæ²¡ sleep 1 ç§’â€ï¼Œå´å®ç°äº†â€œæ¯ç§’æ£€æŸ¥ä¸€æ¬¡â€ï¼Ÿ</h4>
<p>æ ¸å¿ƒå°±åœ¨è¿™ä¸€å¥ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">_</span> <span class="hljs-operator">=</span> wakeSemaphore.wait(timeout: .now() <span class="hljs-operator">+</span> .seconds(config.tickInterval))
</code></pre>
<p>å®ƒç­‰ä»·äºï¼š</p>
<ul>
<li><strong>æœ€å¤šç­‰å¾… 1 ç§’</strong>ï¼ˆ<code>tickInterval = 1</code>ï¼‰ä½œä¸ºä¸€ä¸ªè§‚å¯Ÿçª—å£</li>
<li>å¦‚æœæœŸé—´ RunLoop æœ‰æ¨è¿›ï¼Œobserver ä¼š <code>signal()</code> â†’ ç›‘æ§çº¿ç¨‹ä¼š<strong>æå‰é†’æ¥</strong></li>
<li>çª—å£ç»“æŸåæ¯”è¾ƒ <code>heartbeat</code>ï¼šè‹¥ 1 ç§’å†…å®Œå…¨æ²¡å˜ï¼Œæ‰ç®—è¿™ä¸€ç§’â€œå¡ä½â€</li>
</ul>
<p>æ‰€ä»¥è¿™é‡Œä¸æ˜¯â€œå›ºå®šæ¯ç§’åˆ°ç‚¹è§¦å‘ä¸€æ¬¡â€ï¼Œè€Œæ˜¯ï¼š</p>
<blockquote>
<p><strong>â€œæœ€å¤šç­‰ 1 ç§’ï¼Œä½†åªè¦ RunLoop ä¸€æ¨è¿›å°±ç«‹åˆ»é†’æ¥é‡ç½®çŠ¶æ€â€</strong><br/>
è¿™æ¯” Timer çš„â€œå›ºå®šå‘¨æœŸè§¦å‘â€æ›´è´´åˆæˆ‘ä»¬æƒ³è§‚å¯Ÿçš„å¯¹è±¡ï¼ˆRunLoop æ¨è¿›ï¼‰ã€‚</p>
</blockquote>
<h4 data-id="heading-9">3.2.3 ä¸ºä»€ä¹ˆä¸ç”¨ NSTimer / GCD å®šæ—¶å™¨ï¼Œè€Œç”¨ä¿¡å·é‡ï¼Ÿ</h4>
<p><strong>Timer è§¦å‘æœ¬èº«å°±ä¾èµ–è°ƒåº¦ä¸ RunLoop/çº¿ç¨‹çŠ¶æ€ï¼Œå¡æ­»æ—¶æœ€å®¹æ˜“æŠ–åŠ¨æˆ–å»¶è¿Ÿï¼›ä¿¡å·é‡ + è¶…æ—¶æ˜¯æ›´ç¨³å®šçš„â€œè§‚å¯Ÿçª—å£â€ï¼Œè¿˜èƒ½è¢« RunLoop æ¨è¿›å³æ—¶å”¤é†’ã€‚</strong></p>
<hr/>
<h3 data-id="heading-10">3.3 æŠ“æ ˆï¼šHMDLiveReportCapture.swiftï¼ˆPLCrashReporter Live Reportï¼‰</h3>
<p>æŠ“æ ˆä½¿ç”¨ <code>PLCrashReporter</code> çš„ Live Report èƒ½åŠ›ï¼š</p>
<ul>
<li><code>generateLiveReportAndReturnError()</code>ï¼šç”Ÿæˆâ€œå½“ä¸‹å…¨çº¿ç¨‹ç°åœºâ€</li>
<li>å†ä»æ–‡æœ¬ä¸­æå– <code>Thread 0</code> ä½œä¸ºä¸»çº¿ç¨‹æ ·æœ¬</li>
</ul>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> CrashReporter

<span class="hljs-comment">/// æŠ“ä¸€æ¬¡â€œå…¨çº¿ç¨‹ç°åœºæŠ¥å‘Šâ€</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">captureAllThreadsText</span>() -&gt; <span class="hljs-type">String</span>? {
    <span class="hljs-keyword">let</span> config <span class="hljs-operator">=</span> <span class="hljs-type">PLCrashReporterConfig</span>(signalHandlerType: .<span class="hljs-type">BSD</span>, symbolicationStrategy: .all)
    <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> reporter <span class="hljs-operator">=</span> <span class="hljs-type">PLCrashReporter</span>(configuration: config) <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span> }

    <span class="hljs-keyword">do</span> {
        <span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> reporter.generateLiveReportAndReturnError()
        <span class="hljs-keyword">let</span> report <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-type">PLCrashReport</span>(data: data)
        <span class="hljs-keyword">return</span> <span class="hljs-type">PLCrashReportTextFormatter</span>.stringValue(for: report, with: <span class="hljs-type">PLCrashReportTextFormatiOS</span>)
    } <span class="hljs-keyword">catch</span> {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"[HMDLiveReportCapture] parse report error: <span class="hljs-subst">\(error)</span>"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
    }
}
</code></pre>
<blockquote>
<p>è¿™é‡Œçš„æ€è·¯å°±æ˜¯ï¼š<br/>
<strong>å¡æ­»ç°åœºæŠ“â€œå…¨çº¿ç¨‹â€ï¼Œç”¨äºå…œåº•ï¼›è¶…é˜ˆå€¼åæŒç»­é‡‡â€œä¸»çº¿ç¨‹â€ï¼Œç”¨äºå®šä½ç¨³å®šå¡ç‚¹ã€‚</strong></p>
</blockquote>
<hr/>
<h3 data-id="heading-11">3.4 ä¿å­˜ï¼šHMDANRCandidateStore.swiftï¼ˆhmd_anr_candidate.jsonï¼‰</h3>
<p>Demo ä¿å­˜çš„æ ¸å¿ƒæ•°æ®ç»“æ„æ˜¯ <code>HMDANRRecord</code>ï¼Œé€šè¿‡ <code>Codable</code> ç¼–ç ä¸º JSONï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">public</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">HMDANRRecord</span>: <span class="hljs-title class_">Codable</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">let</span> recordID: <span class="hljs-type">String</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">let</span> timestamp: <span class="hljs-type">Date</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">var</span> hangSeconds: <span class="hljs-type">Int</span>

    <span class="hljs-comment">/// è¶…è¿‡é˜ˆå€¼é‚£ä¸€åˆ»ï¼šå…¨çº¿ç¨‹ç°åœºï¼ˆPLCrash live reportï¼Œæ–‡æœ¬ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">var</span> allThreadsReportText: <span class="hljs-type">String</span>?

    <span class="hljs-comment">/// è¶…é˜ˆå€¼åï¼šæ¯ç§’é‡‡æ ·ä¸»çº¿ç¨‹è°ƒç”¨æ ˆï¼ˆæœ€å¤šä¿ç•™æœ€è¿‘ N æ¡ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">var</span> mainThreadSamples: [<span class="hljs-type">String</span>]
}
</code></pre>
<p>ä¿å­˜åˆ° <code>Caches/hmd_anr_candidate.json</code> åï¼Œå¤§è‡´å­—æ®µé•¿è¿™æ ·ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"recordID"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"E2D0...-...."</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"timestamp"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2026-01-05T12:34:56Z"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"hangSeconds"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"allThreadsReportText"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"PLCrashReporter live report text ..."</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"mainThreadSamples"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"Thread 0 ...\n0 LagMonitorDemo 0x...\n1 UIKitCore ..."</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"Thread 0 ...\n0 LagMonitorDemo 0x...\n1 UIKitCore ..."</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<blockquote>
<p><strong><code>HMDANRCandidateStore</code>å¡ä½æ—¶æŠŠè®°å½•ä¿å­˜åˆ°ç¼“å­˜æ–‡ä»¶ï¼›ä¸€æ—¦ä¸»çº¿ç¨‹æ¢å¤æ¨è¿›å°±ç«‹åˆ»åˆ é™¤ï¼›å¦‚æœè¿›ç¨‹è¢«ç³»ç»Ÿå¼ºæ€æ¥ä¸åŠä¸ŠæŠ¥ï¼Œè¿™ä¸ªæ–‡ä»¶ä¼šç•™åˆ°ä¸‹æ¬¡å¯åŠ¨å†è¯»å–å¯¼å‡º/ç¬¦å·åŒ–ã€‚</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-12">4. å¤ç°åœºæ™¯ï¼ˆDemo å†…ç½®ï¼‰</h2>
<p>Demo é‡ŒåŒ…å«å‡ ç§å…¸å‹å¡æ­»è§¦å‘æ–¹å¼ï¼š</p>
<pre><code class="hljs language-swift" lang="swift">stack.addArrangedSubview(makeButton(<span class="hljs-string">"ä¸»çº¿ç¨‹ Busy 2sï¼ˆè½»å¾®å¡é¡¿ï¼‰"</span>) { [<span class="hljs-keyword">weak</span> <span class="hljs-keyword">self</span>] <span class="hljs-keyword">in</span> <span class="hljs-keyword">self</span><span class="hljs-operator">?</span>.busy(seconds: <span class="hljs-number">2</span>) })
stack.addArrangedSubview(makeButton(<span class="hljs-string">"ä¸»çº¿ç¨‹ Busy 20sï¼ˆè§¦å‘ candidate + é‡‡æ ·ï¼‰"</span>) { [<span class="hljs-keyword">weak</span> <span class="hljs-keyword">self</span>] <span class="hljs-keyword">in</span> <span class="hljs-keyword">self</span><span class="hljs-operator">?</span>.busy(seconds: <span class="hljs-number">20</span>) })
stack.addArrangedSubview(makeButton(<span class="hljs-string">"é”ç«äº‰ï¼šå­çº¿ç¨‹æŒé” 12s â†’ ä¸»çº¿ç¨‹å°è¯•åŠ é”"</span>) { [<span class="hljs-keyword">weak</span> <span class="hljs-keyword">self</span>] <span class="hljs-keyword">in</span> <span class="hljs-keyword">self</span><span class="hljs-operator">?</span>.lockContention() })
stack.addArrangedSubview(makeButton(<span class="hljs-string">"æ­»é”ï¼šä¸²è¡Œé˜Ÿåˆ— sync + ä¸»é˜Ÿåˆ— syncï¼ˆå¿…å¡æ­»ï¼‰"</span>) { [<span class="hljs-keyword">weak</span> <span class="hljs-keyword">self</span>] <span class="hljs-keyword">in</span> <span class="hljs-keyword">self</span><span class="hljs-operator">?</span>.deadlock() })
</code></pre>
<hr/>
<h2 data-id="heading-13">5. è‡ªåŠ¨ç¬¦å·åŒ–ï¼šä» hmd_anr_candidate.json åˆ°â€œå¯è¯»å †æ ˆâ€</h2>
<p>æˆ‘ç‚¹å‡» <strong>â€œä¸»çº¿ç¨‹ Busy 20sï¼ˆè§¦å‘ candidate + é‡‡æ ·ï¼‰â€</strong>ï¼Œåœ¨ç¬¬ 10 ç§’æ‰‹åŠ¨æ€æ‰ Appï¼Œç„¶åå¯¼å‡ºæ²™ç›’é‡Œçš„ <code>hmd_anr_candidate.json</code>ã€‚</p>
<p>ä½ ä¼šçœ‹åˆ°ç±»ä¼¼ä¿¡æ¯ï¼š</p>
<ul>
<li><code>hangSeconds = 13</code>ï¼ˆå¾ˆæ˜ç¡®çš„ä¸»çº¿ç¨‹é•¿æ—¶é—´é˜»å¡ï¼‰</li>
<li><code>mainThreadSamples</code> æœ‰å¤šæ¬¡é‡‡æ ·ï¼ˆè¯æ˜å¡ä½æœŸé—´æ ˆç¨³å®šï¼‰</li>
<li>ä½†è¿™äº›å †æ ˆä»ç„¶æ˜¯åœ°å€/åç§»ï¼Œæ— æ³•ç›´æ¥å®šä½ä¸šåŠ¡ä»£ç </li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c1957fa51734700b434f101e01aaef2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRGFuaWVsMDI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768234621&amp;x-signature=3gdvXM0dJ9yXommktWmHfoLS1C0%3D" alt="1.jpg" loading="lazy"/></p>
<p>å› æ­¤éœ€è¦åšï¼š</p>
<ul>
<li>ä» <code>hmd_anr_candidate.json</code> é‡Œè§£æ frame</li>
<li>ç”¨ <strong>dSYM + atos</strong> è¿˜åŸç¬¦å·ï¼›å¹¶å¯¹ <strong>Swift ç¬¦å· demangle</strong>ï¼ˆ<code>$s... â†’ Foundation.Date.init()</code>ï¼‰</li>
</ul>
<p>æœ¬é¡¹ç›®ç”¨è„šæœ¬ <code>hmd_anr_symbolicate.py</code> è‡ªåŠ¨å®Œæˆæ‰¹é‡ç¬¦å·åŒ–ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python3 hmd_anr_symbolicate.py   --record hmd_anr_candidate.json   --app-dsym LagMonitorDemo.app.dSYM   --<span class="hljs-built_in">arch</span> arm64   --demangle   --out symbolicated.txt
</code></pre>
<p>ç¬¦å·åŒ–åçš„<code>symbolicated.txt</code>çš„å¤§è‡´å†…å®¹å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ac5db4a813f14d99827aed0b39f65fbc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRGFuaWVsMDI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768234621&amp;x-signature=t3nd8wnNgtuAUgumuuOmlykJBOQ%3D" alt="2.jpg" loading="lazy"/></p>
<blockquote>
<p><code>hmd_anr_symbolicate.py</code>åœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fwutao23yzd%2FuikitCombine" target="_blank" title="https://github.com/wutao23yzd/uikitCombine" ref="nofollow noopener noreferrer">GITHUB</a>é¡¹ç›®çš„Scriptsæ–‡ä»¶å¤¹ä¸‹ï¼Œ<code>hmd_anr_candidate.json</code>å’Œ<code>symbolicated.txt</code>åœ¨Samplesæ–‡ä»¶ä¸‹</p>
</blockquote>
<h3 data-id="heading-14">5.1 ç¬¦å·åŒ–åå¦‚ä½•â€œä»æ ˆå®šä½é—®é¢˜â€ï¼Ÿ</h3>
<p>ä» <code>symbolicated.txt</code> é‡ŒæŠ½ <code>mainThreadSamples[0]</code> çš„å…³é”®å‡ å¸§ï¼ˆä½ è¿™æ¬¡ 5 æ¬¡é‡‡æ ·åŸºæœ¬ä¸€è‡´ï¼‰ï¼š</p>
<pre><code class="hljs language-text" lang="text">1   libsystem_c.dylib          gettimeofday
3   Foundation                 Date.init
4   LagMonitorDemo.debug.dylib ... (ViewController.swift:52)
5   LagMonitorDemo.debug.dylib ... (ViewController.swift:33)
6   LagMonitorDemo.debug.dylib ... (ViewController.swift:44)
7   UIKitCore                  ...
</code></pre>
<p>è¿™è¯´æ˜å¡æ­»æœŸé—´ä¸»çº¿ç¨‹ä¸€ç›´åœ¨è·‘ <code>ViewController.swift</code> çš„æŸæ®µé€»è¾‘ï¼Œå¹¶ä¸”é¢‘ç¹è°ƒç”¨ <code>Date()</code>ï¼ˆæœ€ç»ˆè½åˆ° <code>gettimeofday/clock_gettime</code>ï¼‰ï¼Œå…¸å‹ç‰¹å¾å°±æ˜¯<strong>å¿™ç­‰/æ­»å¾ªç¯å¼ç­‰å¾…</strong>ã€‚</p>
<p>å¯¹åº” Demo ä¸­çš„å®ç°ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">busy</span>(<span class="hljs-params">seconds</span>: <span class="hljs-type">Int</span>) {
    <span class="hljs-keyword">let</span> end <span class="hljs-operator">=</span> <span class="hljs-type">Date</span>().addingTimeInterval(<span class="hljs-type">TimeInterval</span>(seconds))
    <span class="hljs-keyword">while</span> <span class="hljs-type">Date</span>() <span class="hljs-operator">&lt;</span> end {
        <span class="hljs-keyword">_</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> <span class="hljs-operator">+</span> <span class="hljs-number">1</span>
    }
}
</code></pre>
<blockquote>
<p>è¿™ç±»æ ˆé¡¶å¸¸è§ç°è±¡å°±æ˜¯ï¼šçœ‹èµ·æ¥â€œå¡åœ¨ Date()â€ï¼Œå…¶å®æ ¹å› æ˜¯ <strong>while å¾ªç¯è®©ä¸»çº¿ç¨‹ä¸€ç›´è·‘</strong>ã€‚<br/>
é‡‡æ ·åˆšå¥½æˆªåœ¨ <code>Date()</code> è¿™ä¸€è¡Œï¼Œäºæ˜¯æ ˆé¡¶è¡¨ç°ä¸º <code>Date.init -&gt; gettimeofday</code>ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-15">6. ç»“è¯­ï¼šå¤åˆ»çš„æ„ä¹‰ï¼Œæ˜¯æŠŠâ€œæ–‡ç« é‡Œçš„æ–¹æ¡ˆâ€å˜æˆâ€œé¡¹ç›®é‡Œèƒ½ç”¨çš„å·¥å…·â€</h2>
<p>å¤§å‚çš„ç¨³å®šæ€§æ–¹æ¡ˆå¾€å¾€æ›´æ·±ã€æ›´ä½“ç³»åŒ–ï¼Œä½†å¾ˆå¤šæ—¶å€™åªåœç•™åœ¨æ–‡ç« å±‚é¢ï¼šçœ‹æ‡‚äº†æ€è·¯ï¼Œå´å¾ˆéš¾åœ¨é¡¹ç›®é‡Œç›´æ¥è½åœ°ã€‚æœ¬æ–‡çš„ç›®æ ‡å°±æ˜¯æŠŠå®ƒâ€œæ‹†å¼€ + è·‘é€šâ€ï¼š</p>
<ul>
<li><strong>æŠŠæŠ–éŸ³æ–‡ç« é‡Œçš„é“¾è·¯æ‹†æˆå¯è¿è¡Œä»£ç </strong>ï¼ˆç›‘æ§ã€é‡‡æ ·ã€ä¿å­˜ã€æ¢å¤ã€å¯¼å‡ºï¼‰</li>
<li><strong>æŠŠæœ€åä¸€å…¬é‡Œè¡¥é½</strong>ï¼ˆdSYM/atos è‡ªåŠ¨ç¬¦å·åŒ– + Swift demangleï¼‰</li>
<li>è®©â€œå¡æ­»é—®é¢˜â€ä» <strong>åªæœ‰ SIGKILL æ•°å­—</strong>ï¼Œå˜æˆ <strong>èƒ½æŒ‡å‘å…·ä½“ä¸šåŠ¡å‡½æ•°/ä»£ç è¡Œ</strong> çš„ç»“è®º</li>
</ul>
<p>ä½ çœŸæ­£éœ€è¦çš„ä¸æ˜¯â€œæˆ‘ä»¬æ£€æµ‹åˆ°äº†å¡æ­»â€ï¼Œè€Œæ˜¯ï¼š</p>
<blockquote>
<p><strong>å¡æ­»é‚£ 8ï½20 ç§’å†…ï¼Œä¸»çº¿ç¨‹åˆ°åº•åœ¨è·‘ä»€ä¹ˆï¼Ÿå®ƒå¡åœ¨è°èº«ä¸Šï¼Ÿ</strong></p>
</blockquote>
<p>å½“ä½ æŠŠâ€œé‡‡æ · + ä¿å­˜ + ä¸‹æ¬¡å¯åŠ¨æå– + è‡ªåŠ¨ç¬¦å·åŒ– + demangleâ€è¿™æ¡é“¾è·¯è·‘é€šï¼Œçº¿ä¸Šå¡æ­»æ’æŸ¥æ•ˆç‡ä¼šæ˜æ˜¾æå‡ã€‚</p>
<hr/>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fwutao23yzd%2FuikitCombine" target="_blank" title="https://github.com/wutao23yzd/uikitCombine" ref="nofollow noopener noreferrer">GITHUBæºç </a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Pythonå¼‚æ­¥ç¼–ç¨‹ï¼šasyncioä¸async/awaitæ·±åº¦è§£æ]]></title>    <link>https://juejin.cn/post/7591719013489426470</link>    <guid>https://juejin.cn/post/7591719013489426470</guid>    <pubDate>2026-01-06T00:25:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591719013489426470" data-draft-id="7591713442400239625" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" Pythonå¼‚æ­¥ç¼–ç¨‹ï¼šasyncioä¸async/awaitæ·±åº¦è§£æ"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2026-01-06T00:25:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åƒè¥¿çº¢æŸ¿é•¿å¤§çš„ç•ªèŒ„"/> <meta itemprop="url" content="https://juejin.cn/user/3097787706900985"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             Pythonå¼‚æ­¥ç¼–ç¨‹ï¼šasyncioä¸async/awaitæ·±åº¦è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3097787706900985/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åƒè¥¿çº¢æŸ¿é•¿å¤§çš„ç•ªèŒ„
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T00:25:38.000Z" title="Tue Jan 06 2026 00:25:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252b3a}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px;color:#5e7ce0}.markdown-body h1{font-size:24px;margin-bottom:5px;margin-top:80px;position:relative;text-align:center}.markdown-body h2{font-size:20px;padding-bottom:12px;border-bottom:1px solid #dfe1e6}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px;margin-top:30px}.markdown-body h5{font-size:14px;margin-top:20px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #dfe1e6;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#ffeeed;color:#c73636;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#252b3a;background:#f8f8f8}.markdown-body a{position:relative;text-decoration:none;color:#5e7ce0;padding-right:18px;padding-bottom:4px}.markdown-body a[href^=http]:after{position:absolute;display:inline-block;width:16px;height:16px;margin-left:2px;margin-top:6px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAIRlWElmTU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAACCgAwAEAAAAAQAAACAAAAAAX7wP8AAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KGV7hBwAABWVJREFUWAnlVktsVFUY/s85997pC9BOTKxRWnEKsXWlxjWJj0RWJjrFAAXjAlewYWOkgauACVu7a2IiNUEyExM3yoZE3Wmi7qgPJthJBDE6JUNpO3Mf5/j95/bOTOcBlBgXejJ37rn/Of/7O/9/iP7vQ/zTAcjnC4ry+a5ii1OkiYTpuvjvEc0Gp51uivP+ZW+QBuSW4QjW5rptAa1Ey0uOGKOxwPetVyafN6p/52/PkNBbjdAhGaGEpMRjLZTryB8+9MUSYSGNRIcBvm8kBAY9tHYlHz78nTs392xIkwv9FA3Oe33bdoX1ZZKOS0bH0CXI6RugYLW6BwIu5gskkQ4sEG0wYF25PjBzbZfSYY6kDLUmWMt7FR7Lw3xYUkaTdjxHfTPnPwav0iEGYADVa9XIRIEyxrAA0jIQxgFL22gYwF7A8/DAzNVdksJvJaTEUZ2kYnZWziN5s1ADPHneEIXByotYuMSrf9JEbbsuv7VcvbaKML8plXtQR0EdIYDqWEmtOgAomZFH8EjWSnek2ulmtljljttHbmaIHCCCHzd9MjwfsmscBeZH9Jyd10nMvz92UQrtCBKvMF06mQy0SiEdRMEGg8mN0YjAlgoDDkPrMI5qJKSkKKydpbB2CZjJkhIBvOBw2CGQgii85bpx//dMqFRKam5uvH7w+K97oe+Cl0HO68uIBH0qyEzpOMwIbZIcFq0I+9cwoElizCjk2KFI1y7Nnx614W1db58fOXIlMzs7Xn/jeDmvBV2Q0mXjGf554O/m4LZHp2N8r61WPMvLZWLdiC4GMAk5BjeeB5lhv39l6+BIbu3m760hXMDKBD08XBKzR8fr04nygnIypOOAJUx/fHrsi0Mnys+vVK+V4VUohaiyPCo2Q9DFALvF/ikw8WS4QvVZALS5ksw47/7R8ejgTPk1UFqU6/3zp8bOM7B/kdu/fkguPGU5JibW+F0sTjWOUw8DklRrg4BiLGeBqbaRLxjlT4no0InFV402RcftJz41cH/f/JnHP3kZaaF6VX/liwist9vYG5+NU9Cg3MNkt/+lU5wS8fTxq3mc7ILjDlAE4CJpe89BOWPiIjBhi9O6PI4G1jsc6RGB3lZwmS76k8H0zOKTkFboG8jS2krFKCX2fvTeaPHIBwAkMHHgncURnL3nuCSnxSopdIzN5th0BIonJ0Lf9yUA9iMkzdRWl3BixOusfDcwQVcS4UKIFwYfGPnM8wY/DyP9NFMXaTE5BU39tGkDgGZz+fJJG0oYcSaOafLcqdECY4LzfSObSzyUOgxqtyisr8SSNOOAkubWoh3TTaeA2YtFEXPnm5x81/j+6MI6JqyS25WSNU6hbCMKHG84marJbdR+vwakRhQLRuQpbzHRLjmpmijI+OmWCtq+LzWtnX5v30gHSsqmWne74DtiACi2+Wz0iXbuLt9D2cDyoPEkWOiyp5XUIwLMi/wJY1FbH5B9ONtdC1KrsD/Q0MCQAS0wccILORDW25amAeOtooAj/KQxfzF17uwTSQ1v3dJ7jnLINwdZYRDa4tPU0sHVXFo/vxFF5BqFqxRfOmgPCk4ft2NgKTCy2Y47JIEg+MIhjYsLy5I25qUYTQlCjMRHsr/UwdYwIK33UO1J5fFNB9XNO6akcywJofVmXQDP2wfrSPcI2xG5BSs3I+IosHr4EtvO1TDAu16xHQq5+ykMblfRXLbhEoFIdDTBdhldvzl+3CMg60ZktI2vNzLW6IIp0waLklot9L63yzuUp8dJd7bglPFe3hIXstBEP58/s6Ocyr4rH2+866ZNbriTzA0RSOWCwakMl1QJgculxPt8Z7O5GLdtW6bvU8R/nO1vb+hMExVAVtEAAAAASUVORK5CYII=");background-size:100%}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #5e7ce0}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #5e7ce0;border-spacing:0}.markdown-body thead{color:#fff;text-align:left}.markdown-body thead tr{background:#5e7ce0}.markdown-body thead th{border-bottom:1px solid #dfe1e6}.markdown-body tr{background-color:#fff}.markdown-body tr:nth-child(2n){background-color:#f2f5fc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#252b3a;padding:1px 23px;margin:22px 0;border-left:4px solid #5e7ce0;background-color:#f2f5fc}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{padding-left:10px;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5e7ce0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ul li::marker{content:"â€¢";color:#5e7ce0}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]:before{display:inline-block;width:16px;height:16px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAhRJREFUeAHtnLEuBFEUhs9cu7JCskEhIrZAgYZGoREPwBuIygOoPITKA6jEG/AAolFoaFCgICIKZBNiY8Pyz5rNOWe9wNz5T7N3Z2eT/b/7zZlpziat3xKWBDJoEyh5EDd3DTk5r8vV7Yc8vzbl6zvfwvSERIYHyzI90SeLc1WZrFV85PR9oi+N/YMnOT6t/3tiLAeXFqqytjrSFacDYmfvQS6u37tOiPHA7FS/bK6PmWhpj4AJRYGA9MiKzLpK6An+cqiNVmRleUhArrec6PNzt/5sttLgh0cvcvfY6Px+ZNY9I6Ax6gKErY1xmZ8ZyD0E5MJGIgsyIZsunT3g7qALJuTdAp0nWyMTsunS2QNukbpwOcRaPpvOHvxzQow2ZBvrs+nsfLL8o0QQBJFdMO1XGkEjaIQlQCMsD/YIGkEjLAEaYXmwR9AIGmEJ0AjLgz2CRtAIS4BGWB7sETSCRlgCNMLyYI+gETTCEqARlgd7BI2gEZYAjbA82CNoBI2wBGiE5cEeQSNohCVAIywP9ggaQSMsARphebBH0AgaYQnQCMsjYC5SF2agYi2fTWcPGA7VFfO0n8+mswdMyOrCNJwnpz/P6xqZkE2Xzh4w8qcLI4Hbu/dydvkWBRAAQBZk0uOOyKyzp5PARRiF1puNtR+NTh+oMCvtJ+D8F2N6j6x+PrwzG46gRTDDm5BtsAGBg0X924Qfj7i23p7HNgQAAAAASUVORK5CYII=");background-size:100%;position:relative;right:2px;top:-5px}.markdown-body input[type=checkbox]:checked:before{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAABMtJREFUeAHtXM2KFDEQzrQKruIu4mEXRFlUVLz4A4K7B99AcO8io0/gwQfxDVzFuwu+gQf34EG8iOAPKAh6EFlBFMSf/qa2uqszlVR6ZtYxM5PDJNVVSer78nU6KrHzpyxuVlwx44AY2O0T8eb9D7f5fMu9fPvdff7y0/36nbdgdhUdd+jgHnf62JxbObvgjh/d60Pu2R35ajx49Mk9frqlBk7Kw8sXF9y1K4t9cCoi7tz/4F68/tYXMIkPzpzY725dP9yA1tsjoIRpIQHogRWYZSmwJ4Reh06nI2Nd7rYEA8zAzqXAxhgq/pc1d9vHKbEX+Dr4JbzypJDc/YxXYi/wifRLeOXpU5q7n/FK7EXsnBBeeRoqd7/EHj1ZhleeiMjdz8pArRKR+0pb+UsCuK0SkftKW/kzeFmrRHCAxWzufsaJOkqExWzufpOI8EpP1jnCJCK80pN1jjCJ4ICwMigidz/jRD3bI7bZUInIfaWt/KUSuK0SEd4jqFvufgYva5UIDrCYzd3POFFHifhfV/7k8lwPw7D5mUSEV3r854ju2pK7ffOIWzk/X+Go803Lr+ooGqoiwkyP9xzRXVt0q9sE3CgJYTLqfNPyE/irpkoEe2um6ck4bSiBSeD8JBl41jY/Hgd1lIiaaeoyLlsjgUGAjEH3DB4DtUpEW2Z3Mj5GAgA8efbVvXpX/200nln5IMYvKhHDrvylcwdc9+pSNdeg46WQsP7wo2s7fpWYaPT926fw9ZiVk4BpywYJkGuvlJs4EuWS0p/HTyHh3kbzH2najM85cR0lgpPiYMtukFB26m1u5Ua+vkFkWP3Zn0KCJDg1Px6f42Wtvhrhdyz8ncanrFKCmGH1wrwDMCrh/uxPIUFTAvdHbeVPsc1fVRE+c7Ud/k6fWt7XHFlYqcqQ5wTRvWpiY4wrIZwfDUL+akDRUBXB/jCzFCH9SHCzTDRUmsro7z+cEvrHwxOZn2ZTL/pVFcEBtRLoiWXfxQ5ehvoHHx4vpIwUEuJKSMvPz5/zQq0qwmIy5m+rjBQSwnsCQYnlgwjfT72av6oifOba2qnKcOXeGVIP0rT3BALTNr8mBWSpRHAgmJSTtLGhDHwj+A9GPCbX2DNiBSRoShg0H8zl5y/njxIhJ0WntralDJmIbO+UEvz85Zwt9wj7HIDB5Ttp7RkyGbRDSqC49vOjX50P9aexmr+qInzmajvtO13H02SpyrCVMNj8dT7/4BwByDXzRIC0LWXEldA/njVfip9GpV9VERxQM0lPhrVDyrCVMJr5/fwZJ+qWewR1lSuNJ21sXxnjVgIhck5VhM/cqG1WBpIAMX4Z9Xz+eP58sFUiOBArLQcZpQ0CNCXt1HzA5OfPOFGrrwYHyKTwbNJsxolaJUJbKeo0mu/4uMeXBHBbJSK88qP5jo97fAYva5UIDgivHEXk7mecqKNEhFeOhsjdbxKR+0pb+UsCuK0qIveVtvJn8LJWieAAi9nc/YwTdZQIi9nc/SYR4ZWenSO2yZvgcwTuRYZKWBnUI3e/xF7gcmio5L4HWPlL7AVuyPol95W28me8EnuBa8J+sZjM3c94JfYCd6VxTXjaCjDLe+K9cwTuSuOa8LQUYPXvh1d3w0HC7JK8kMK0/rcJfwHkVMYgi4xhOgAAAABJRU5ErkJggg==");background-size:100%}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-light">.hljs-comment,.hljs-quote{color:#696969}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d91e18}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#aa5d00}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:green}.hljs-section,.hljs-title{color:#007faa}.hljs-keyword,.hljs-selector-tag{color:#7928a1}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fefefe;color:#545454}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">ä¸€ã€åç¨‹ï¼šå¼‚æ­¥ç¼–ç¨‹çš„åŸºç¡€å•å…ƒ</h2>
<h3 data-id="heading-1">ç†è§£åç¨‹å¯¹è±¡</h3>
<p>åç¨‹æ˜¯å¯æš‚åœå’Œæ¢å¤çš„å‡½æ•°ï¼Œä½¿ç”¨<code>async def</code>å®šä¹‰ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Coroutine</span>

<span class="hljs-comment"># åŸºç¡€åç¨‹</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">simple_coroutine</span>(<span class="hljs-params">name: <span class="hljs-built_in">str</span>, delay: <span class="hljs-built_in">float</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""ä¸€ä¸ªç®€å•çš„åç¨‹"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{name}</span>: å¼€å§‹æ‰§è¡Œï¼Œç­‰å¾… <span class="hljs-subst">{delay}</span> ç§’"</span>)
    <span class="hljs-keyword">await</span> asyncio.sleep(delay)  <span class="hljs-comment"># éé˜»å¡ç­‰å¾…</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{name}</span>: æ‰§è¡Œå®Œæˆ"</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{name}</span>-ç»“æœ"</span>

<span class="hljs-comment"># åç¨‹çš„ä¸‰ç§çŠ¶æ€</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">coroutine_lifecycle</span>():
    <span class="hljs-string">"""æ¼”ç¤ºåç¨‹çš„ç”Ÿå‘½å‘¨æœŸ"""</span>
    coro = simple_coroutine(<span class="hljs-string">"æµ‹è¯•"</span>, <span class="hljs-number">1.0</span>)
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åç¨‹ç±»å‹: <span class="hljs-subst">{<span class="hljs-built_in">type</span>(coro)}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ˜¯åç¨‹å¯¹è±¡: <span class="hljs-subst">{asyncio.iscoroutine(coro)}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ˜¯åç¨‹å‡½æ•°: <span class="hljs-subst">{asyncio.iscoroutinefunction(simple_coroutine)}</span>"</span>)
    
    <span class="hljs-comment"># åç¨‹çš„çŠ¶æ€</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åˆå§‹çŠ¶æ€: <span class="hljs-subst">{coro.cr_running}</span>"</span>)  <span class="hljs-comment"># Falseï¼Œå°šæœªè¿è¡Œ</span>
    
    <span class="hljs-comment"># è¿è¡Œåç¨‹</span>
    task = asyncio.create_task(coro)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åˆ›å»ºä»»åŠ¡å: <span class="hljs-subst">{task._state}</span>"</span>)  <span class="hljs-comment"># 'PENDING'</span>
    
    <span class="hljs-keyword">await</span> task
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å®Œæˆå: <span class="hljs-subst">{task._state}</span>"</span>)  <span class="hljs-comment"># 'FINISHED'</span>

<span class="hljs-comment"># æ‰‹åŠ¨æ§åˆ¶åç¨‹æ‰§è¡Œ</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">manual_coroutine_control</span>():
    <span class="hljs-string">"""æ‰‹åŠ¨æ§åˆ¶åç¨‹æ‰§è¡Œï¼ˆä¸æ¨èåœ¨ç”Ÿäº§ä¸­ä½¿ç”¨ï¼‰"""</span>
    coro = simple_coroutine(<span class="hljs-string">"æ‰‹åŠ¨æ§åˆ¶"</span>, <span class="hljs-number">0.5</span>)
    
    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># æ‰‹åŠ¨æ¨è¿›åç¨‹</span>
        coro.send(<span class="hljs-literal">None</span>)  <span class="hljs-comment"># æˆ– next(coro)ï¼Œå¯åŠ¨åç¨‹</span>
    <span class="hljs-keyword">except</span> StopIteration <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åç¨‹è¿”å›å€¼: <span class="hljs-subst">{e.value}</span>"</span>)
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åç¨‹å¼‚å¸¸: <span class="hljs-subst">{e}</span>"</span>)

<span class="hljs-comment"># è¿è¡Œ</span>
asyncio.run(coroutine_lifecycle())
</code></pre>
<h2 data-id="heading-2">äºŒã€ä»»åŠ¡ï¼šå¹¶å‘æ‰§è¡Œçš„ç®¡ç†å™¨</h2>
<h3 data-id="heading-3">ä»»åŠ¡çš„åˆ›å»ºä¸å–æ¶ˆ</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">from</span> asyncio <span class="hljs-keyword">import</span> Task, CancelledError
<span class="hljs-keyword">import</span> signal

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">cancellable_task</span>(<span class="hljs-params">name: <span class="hljs-built_in">str</span>, duration: <span class="hljs-built_in">float</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""å¯å–æ¶ˆçš„ä»»åŠ¡"""</span>
    <span class="hljs-keyword">try</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{name}</span>: å¼€å§‹é•¿æ—¶é—´è¿è¡Œ"</span>)
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">int</span>(duration * <span class="hljs-number">10</span>)):
            <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">0.1</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{name}</span>: è¿›åº¦ <span class="hljs-subst">{i+<span class="hljs-number">1</span>}</span>/10"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{name}</span>: å®Œæˆ"</span>
    <span class="hljs-keyword">except</span> CancelledError:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{name}</span>: è¢«å–æ¶ˆ"</span>)
        <span class="hljs-keyword">raise</span>  <span class="hljs-comment"># é‡æ–°æŠ›å‡ºä»¥ä¾¿è°ƒç”¨è€…çŸ¥é“</span>
    <span class="hljs-keyword">finally</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{name}</span>: æ¸…ç†èµ„æº"</span>)

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">task_management</span>():
    <span class="hljs-string">"""ä»»åŠ¡ç®¡ç†ç¤ºä¾‹"""</span>
    <span class="hljs-comment"># åˆ›å»ºå¤šä¸ªä»»åŠ¡</span>
    task1 = asyncio.create_task(cancellable_task(<span class="hljs-string">"ä»»åŠ¡1"</span>, <span class="hljs-number">2.0</span>))
    task2 = asyncio.create_task(cancellable_task(<span class="hljs-string">"ä»»åŠ¡2"</span>, <span class="hljs-number">3.0</span>))
    task3 = asyncio.create_task(cancellable_task(<span class="hljs-string">"ä»»åŠ¡3"</span>, <span class="hljs-number">1.0</span>))
    
    <span class="hljs-comment"># ç­‰å¾…ä¸€æ®µæ—¶é—´åå–æ¶ˆä»»åŠ¡2</span>
    <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">1.5</span>)
    
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> task2.done():
        task2.cancel()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"å·²å–æ¶ˆä»»åŠ¡2"</span>)
    
    <span class="hljs-comment"># æ”¶é›†ç»“æœ</span>
    done, pending = <span class="hljs-keyword">await</span> asyncio.wait(
        [task1, task2, task3],
        timeout=<span class="hljs-number">2.0</span>,
        return_when=asyncio.FIRST_COMPLETED
    )
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å®Œæˆçš„ä»»åŠ¡æ•°: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(done)}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æŒ‚èµ·çš„ä»»åŠ¡æ•°: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(pending)}</span>"</span>)
    
    <span class="hljs-comment"># å¤„ç†ç»“æœ</span>
    <span class="hljs-keyword">for</span> task <span class="hljs-keyword">in</span> done:
        <span class="hljs-keyword">if</span> task.exception():
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ä»»åŠ¡å¼‚å¸¸: <span class="hljs-subst">{task.exception()}</span>"</span>)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ä»»åŠ¡ç»“æœ: <span class="hljs-subst">{task.result()}</span>"</span>)
    
    <span class="hljs-comment"># å–æ¶ˆå‰©ä½™ä»»åŠ¡</span>
    <span class="hljs-keyword">for</span> task <span class="hljs-keyword">in</span> pending:
        task.cancel()

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">timeout_handling</span>():
    <span class="hljs-string">"""è¶…æ—¶å¤„ç†"""</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">slow_operation</span>():
        <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">5</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-string">"æ…¢æ“ä½œå®Œæˆ"</span>
    
    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># æ–¹å¼1ï¼šasyncio.wait_for</span>
        result = <span class="hljs-keyword">await</span> asyncio.wait_for(slow_operation(), timeout=<span class="hljs-number">2.0</span>)
        <span class="hljs-built_in">print</span>(result)
    <span class="hljs-keyword">except</span> asyncio.TimeoutError:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ“ä½œè¶…æ—¶"</span>)
    
    <span class="hljs-comment"># æ–¹å¼2ï¼šasyncio.shieldï¼ˆé˜²æ­¢å–æ¶ˆï¼‰</span>
    task = asyncio.create_task(slow_operation())
    <span class="hljs-keyword">try</span>:
        result = <span class="hljs-keyword">await</span> asyncio.wait_for(asyncio.shield(task), timeout=<span class="hljs-number">2.0</span>)
    <span class="hljs-keyword">except</span> asyncio.TimeoutError:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ç­‰å¾…è¶…æ—¶ï¼Œä½†åå°ä»»åŠ¡ç»§ç»­è¿è¡Œ"</span>)
        <span class="hljs-comment"># æ£€æŸ¥åå°ä»»åŠ¡çŠ¶æ€</span>
        <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">3</span>)
        <span class="hljs-keyword">if</span> task.done():
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åå°ä»»åŠ¡æœ€ç»ˆç»“æœ: <span class="hljs-subst">{task.result()}</span>"</span>)

<span class="hljs-comment"># è¿è¡Œ</span>
asyncio.run(timeout_handling())
</code></pre>
<h2 data-id="heading-4">ä¸‰ã€å¼‚æ­¥ä¸Šä¸‹æ–‡ç®¡ç†å™¨ä¸è¿­ä»£å™¨</h2>
<h3 data-id="heading-5"><code>async with</code>å’Œ<code>async for</code></h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">import</span> aiohttp
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> AsyncIterator, <span class="hljs-type">List</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AsyncConnectionPool</span>:
    <span class="hljs-string">"""å¼‚æ­¥è¿æ¥æ± """</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, pool_size: <span class="hljs-built_in">int</span> = <span class="hljs-number">5</span></span>):
        self.pool_size = pool_size
        self._connections: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>] = []
        self._semaphore = asyncio.Semaphore(pool_size)
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">__aenter__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"åˆå§‹åŒ–è¿æ¥æ± "</span>)
        <span class="hljs-comment"># æ¨¡æ‹Ÿå»ºç«‹è¿æ¥</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(self.pool_size):
            <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">0.1</span>)
            self._connections.append(<span class="hljs-string">f"è¿æ¥-<span class="hljs-subst">{i+<span class="hljs-number">1</span>}</span>"</span>)
        <span class="hljs-keyword">return</span> self
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">__aexit__</span>(<span class="hljs-params">self, exc_type, exc_val, exc_tb</span>):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ¸…ç†è¿æ¥æ± "</span>)
        <span class="hljs-comment"># æ¨¡æ‹Ÿå…³é—­è¿æ¥</span>
        <span class="hljs-keyword">for</span> conn <span class="hljs-keyword">in</span> self._connections:
            <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">0.05</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å…³é—­ <span class="hljs-subst">{conn}</span>"</span>)
        self._connections.clear()
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">acquire</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""è·å–è¿æ¥"""</span>
        <span class="hljs-keyword">await</span> self._semaphore.acquire()
        conn = self._connections.pop()
        <span class="hljs-keyword">return</span> conn
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">release</span>(<span class="hljs-params">self, conn: <span class="hljs-built_in">str</span></span>):
        <span class="hljs-string">"""é‡Šæ”¾è¿æ¥"""</span>
        self._connections.append(conn)
        self._semaphore.release()
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute_query</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""æ‰§è¡ŒæŸ¥è¯¢"""</span>
        conn = <span class="hljs-keyword">await</span> self.acquire()
        <span class="hljs-keyword">try</span>:
            <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">0.5</span>)  <span class="hljs-comment"># æ¨¡æ‹ŸæŸ¥è¯¢</span>
            <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{conn}</span>: æ‰§è¡Œ '<span class="hljs-subst">{query}</span>' çš„ç»“æœ"</span>
        <span class="hljs-keyword">finally</span>:
            self.release(conn)

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AsyncDataStream</span>:
    <span class="hljs-string">"""å¼‚æ­¥æ•°æ®æµ"""</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, data: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>], delay: <span class="hljs-built_in">float</span> = <span class="hljs-number">0.1</span></span>):
        self.data = data
        self.delay = delay
        self.index = <span class="hljs-number">0</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__aiter__</span>(<span class="hljs-params">self</span>) -&gt; AsyncIterator[<span class="hljs-built_in">str</span>]:
        <span class="hljs-keyword">return</span> self
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">__anext__</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-keyword">if</span> self.index &gt;= <span class="hljs-built_in">len</span>(self.data):
            <span class="hljs-keyword">raise</span> StopAsyncIteration
        
        item = self.data[self.index]
        self.index += <span class="hljs-number">1</span>
        
        <span class="hljs-comment"># æ¨¡æ‹Ÿå¼‚æ­¥è·å–æ•°æ®</span>
        <span class="hljs-keyword">await</span> asyncio.sleep(self.delay)
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"å¤„ç†: <span class="hljs-subst">{item}</span>"</span>

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">async_context_example</span>():
    <span class="hljs-string">"""å¼‚æ­¥ä¸Šä¸‹æ–‡ç®¡ç†å™¨ç¤ºä¾‹"""</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> AsyncConnectionPool(<span class="hljs-number">3</span>) <span class="hljs-keyword">as</span> pool:
        tasks = []
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):
            query = <span class="hljs-string">f"SELECT * FROM table<span class="hljs-subst">{i}</span>"</span>
            task = asyncio.create_task(pool.execute_query(query))
            tasks.append(task)
        
        results = <span class="hljs-keyword">await</span> asyncio.gather(*tasks, return_exceptions=<span class="hljs-literal">True</span>)
        <span class="hljs-keyword">for</span> result <span class="hljs-keyword">in</span> results:
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(result, Exception):
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æŸ¥è¯¢å¤±è´¥: <span class="hljs-subst">{result}</span>"</span>)
            <span class="hljs-keyword">else</span>:
                <span class="hljs-built_in">print</span>(result)

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">async_iter_example</span>():
    <span class="hljs-string">"""å¼‚æ­¥è¿­ä»£å™¨ç¤ºä¾‹"""</span>
    data = [<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>, <span class="hljs-string">"D"</span>, <span class="hljs-string">"E"</span>]
    stream = AsyncDataStream(data, delay=<span class="hljs-number">0.2</span>)
    
    <span class="hljs-comment"># æ–¹å¼1ï¼šç›´æ¥ä½¿ç”¨async for</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> stream:
        <span class="hljs-built_in">print</span>(item)
    
    <span class="hljs-comment"># æ–¹å¼2ï¼šä½¿ç”¨anext()</span>
    stream2 = AsyncDataStream(data)
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
            item = <span class="hljs-keyword">await</span> anext(stream2)  <span class="hljs-comment"># Python 3.10+</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ‰‹åŠ¨è·å–: <span class="hljs-subst">{item}</span>"</span>)
    <span class="hljs-keyword">except</span> StopAsyncIteration:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"è¿­ä»£ç»“æŸ"</span>)
    
    <span class="hljs-comment"># æ–¹å¼3ï¼šå¼‚æ­¥æ¨å¯¼å¼</span>
    stream3 = AsyncDataStream(data)
    processed = [item <span class="hljs-keyword">async</span> <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> stream3]
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¼‚æ­¥æ¨å¯¼å¼ç»“æœ: <span class="hljs-subst">{processed}</span>"</span>)

<span class="hljs-comment"># è¿è¡Œ</span>
asyncio.run(async_iter_example())
</code></pre>
<h2 data-id="heading-6">å››ã€ä¿¡å·é‡ä¸é«˜çº§å¹¶å‘æ§åˆ¶</h2>
<h3 data-id="heading-7">é™åˆ¶å¹¶å‘æ•°</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">from</span> asyncio <span class="hljs-keyword">import</span> Semaphore, BoundedSemaphore, Lock, Event, Condition
<span class="hljs-keyword">import</span> random

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">worker</span>(<span class="hljs-params">semaphore: Semaphore, name: <span class="hljs-built_in">str</span>, work_time: <span class="hljs-built_in">float</span></span>):
    <span class="hljs-string">"""ä½¿ç”¨ä¿¡å·é‡æ§åˆ¶çš„å·¥ä½œå™¨"""</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> semaphore:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{name}</span>: è·å–ä¿¡å·é‡ï¼Œå¼€å§‹å·¥ä½œ"</span>)
        <span class="hljs-keyword">await</span> asyncio.sleep(work_time)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{name}</span>: å®Œæˆå·¥ä½œï¼Œé‡Šæ”¾ä¿¡å·é‡"</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{name}</span>-å®Œæˆ"</span>

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">semaphore_example</span>():
    <span class="hljs-string">"""ä¿¡å·é‡ç¤ºä¾‹ï¼šé™åˆ¶æœ€å¤š3ä¸ªå¹¶å‘ä»»åŠ¡"""</span>
    semaphore = Semaphore(<span class="hljs-number">3</span>)
    
    tasks = []
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):
        work_time = random.uniform(<span class="hljs-number">0.5</span>, <span class="hljs-number">2.0</span>)
        task = asyncio.create_task(worker(semaphore, <span class="hljs-string">f"Worker-<span class="hljs-subst">{i}</span>"</span>, work_time))
        tasks.append(task)
    
    <span class="hljs-keyword">await</span> asyncio.gather(*tasks)

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AsyncRateLimiter</span>:
    <span class="hljs-string">"""å¼‚æ­¥é€Ÿç‡é™åˆ¶å™¨"""</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, rate: <span class="hljs-built_in">float</span></span>):
        self.rate = rate  <span class="hljs-comment"># æ¯ç§’æœ€å¤šè°ƒç”¨æ¬¡æ•°</span>
        self._tokens = rate
        self._last_update = asyncio.get_event_loop().time()
        self._lock = Lock()
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">acquire</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> self._lock:
            now = asyncio.get_event_loop().time()
            elapsed = now - self._last_update
            
            <span class="hljs-comment"># æ·»åŠ ä»¤ç‰Œ</span>
            self._tokens = <span class="hljs-built_in">min</span>(self.rate, self._tokens + elapsed * self.rate)
            self._last_update = now
            
            <span class="hljs-keyword">if</span> self._tokens &gt;= <span class="hljs-number">1</span>:
                self._tokens -= <span class="hljs-number">1</span>
                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
            <span class="hljs-keyword">else</span>:
                <span class="hljs-comment"># ç­‰å¾…è¶³å¤Ÿçš„ä»¤ç‰Œ</span>
                wait_time = (<span class="hljs-number">1</span> - self._tokens) / self.rate
                <span class="hljs-keyword">await</span> asyncio.sleep(wait_time)
                self._tokens = <span class="hljs-number">0</span>
                self._last_update = asyncio.get_event_loop().time()
                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">rate_limiter_example</span>():
    <span class="hljs-string">"""é€Ÿç‡é™åˆ¶å™¨ç¤ºä¾‹"""</span>
    limiter = AsyncRateLimiter(rate=<span class="hljs-number">2.0</span>)  <span class="hljs-comment"># æ¯ç§’æœ€å¤š2æ¬¡</span>
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">make_request</span>(<span class="hljs-params">name: <span class="hljs-built_in">str</span></span>):
        <span class="hljs-keyword">await</span> limiter.acquire()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{time.strftime(<span class="hljs-string">'%H:%M:%S'</span>)}</span> <span class="hljs-subst">{name}</span>: å‘é€è¯·æ±‚"</span>)
        <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">0.1</span>)
    
    tasks = []
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):
        task = asyncio.create_task(make_request(<span class="hljs-string">f"Req-<span class="hljs-subst">{i}</span>"</span>))
        tasks.append(task)
        <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">0.1</span>)  <span class="hljs-comment"># æ¨¡æ‹Ÿè¯·æ±‚é—´éš”</span>
    
    <span class="hljs-keyword">await</span> asyncio.gather(*tasks)

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AsyncPipeline</span>:
    <span class="hljs-string">"""å¼‚æ­¥å¤„ç†ç®¡é“"""</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self._queue = asyncio.Queue(maxsize=<span class="hljs-number">10</span>)
        self._event = Event()
        self._condition = Condition()
        self._workers = []
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">producer</span>(<span class="hljs-params">self, name: <span class="hljs-built_in">str</span>, count: <span class="hljs-built_in">int</span></span>):
        <span class="hljs-string">"""ç”Ÿäº§è€…åç¨‹"""</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(count):
            item = <span class="hljs-string">f"<span class="hljs-subst">{name}</span>-é¡¹ç›®<span class="hljs-subst">{i}</span>"</span>
            <span class="hljs-keyword">await</span> self._queue.put(item)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç”Ÿäº§è€… <span class="hljs-subst">{name}</span>: ç”Ÿäº§ <span class="hljs-subst">{item}</span>"</span>)
            <span class="hljs-keyword">await</span> asyncio.sleep(random.uniform(<span class="hljs-number">0.1</span>, <span class="hljs-number">0.3</span>))
        
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç”Ÿäº§è€… <span class="hljs-subst">{name}</span>: å®Œæˆ"</span>)
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">consumer</span>(<span class="hljs-params">self, name: <span class="hljs-built_in">str</span></span>):
        <span class="hljs-string">"""æ¶ˆè´¹è€…åç¨‹"""</span>
        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
            <span class="hljs-keyword">try</span>:
                item = <span class="hljs-keyword">await</span> asyncio.wait_for(self._queue.get(), timeout=<span class="hljs-number">2.0</span>)
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ¶ˆè´¹è€… <span class="hljs-subst">{name}</span>: å¤„ç† <span class="hljs-subst">{item}</span>"</span>)
                <span class="hljs-keyword">await</span> asyncio.sleep(random.uniform(<span class="hljs-number">0.2</span>, <span class="hljs-number">0.5</span>))
                self._queue.task_done()
            <span class="hljs-keyword">except</span> asyncio.TimeoutError:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ¶ˆè´¹è€… <span class="hljs-subst">{name}</span>: è¶…æ—¶ï¼Œé€€å‡º"</span>)
                <span class="hljs-keyword">break</span>
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self, producer_count: <span class="hljs-built_in">int</span> = <span class="hljs-number">3</span>, consumer_count: <span class="hljs-built_in">int</span> = <span class="hljs-number">2</span></span>):
        <span class="hljs-string">"""è¿è¡Œç®¡é“"""</span>
        <span class="hljs-comment"># åˆ›å»ºç”Ÿäº§è€…</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(producer_count):
            task = asyncio.create_task(self.producer(<span class="hljs-string">f"P<span class="hljs-subst">{i}</span>"</span>, <span class="hljs-number">5</span>))
            self._workers.append(task)
        
        <span class="hljs-comment"># åˆ›å»ºæ¶ˆè´¹è€…</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(consumer_count):
            task = asyncio.create_task(self.consumer(<span class="hljs-string">f"C<span class="hljs-subst">{i}</span>"</span>))
            self._workers.append(task)
        
        <span class="hljs-comment"># ç­‰å¾…æ‰€æœ‰ç”Ÿäº§è€…å®Œæˆ</span>
        <span class="hljs-keyword">await</span> asyncio.gather(*self._workers[:producer_count])
        
        <span class="hljs-comment"># ç­‰å¾…é˜Ÿåˆ—æ¸…ç©º</span>
        <span class="hljs-keyword">await</span> self._queue.join()
        
        <span class="hljs-comment"># å–æ¶ˆæ¶ˆè´¹è€…</span>
        <span class="hljs-keyword">for</span> task <span class="hljs-keyword">in</span> self._workers[producer_count:]:
            task.cancel()
        
        <span class="hljs-comment"># ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ</span>
        <span class="hljs-keyword">await</span> asyncio.gather(*self._workers, return_exceptions=<span class="hljs-literal">True</span>)

<span class="hljs-comment"># è¿è¡Œ</span>
asyncio.run(AsyncPipeline().run())
</code></pre>
<h2 data-id="heading-8">äº”ã€å¼‚æ­¥IOä¸ç½‘ç»œç¼–ç¨‹</h2>
<h3 data-id="heading-9">aiohttpå’Œå¼‚æ­¥æ•°æ®åº“</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">import</span> aiohttp
<span class="hljs-keyword">import</span> asyncpg
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Dict</span>, <span class="hljs-type">Any</span>
<span class="hljs-keyword">import</span> json

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AsyncWebScraper</span>:
    <span class="hljs-string">"""å¼‚æ­¥ç½‘é¡µæŠ“å–å™¨"""</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, concurrency_limit: <span class="hljs-built_in">int</span> = <span class="hljs-number">10</span></span>):
        self.semaphore = Semaphore(concurrency_limit)
        self.session = <span class="hljs-literal">None</span>
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">__aenter__</span>(<span class="hljs-params">self</span>):
        self.session = aiohttp.ClientSession()
        <span class="hljs-keyword">return</span> self
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">__aexit__</span>(<span class="hljs-params">self, exc_type, exc_val, exc_tb</span>):
        <span class="hljs-keyword">if</span> self.session:
            <span class="hljs-keyword">await</span> self.session.close()
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">fetch_url</span>(<span class="hljs-params">self, url: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]:
        <span class="hljs-string">"""è·å–å•ä¸ªURL"""</span>
        <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> self.semaphore:
            <span class="hljs-keyword">try</span>:
                <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> self.session.get(url, timeout=<span class="hljs-number">10</span>) <span class="hljs-keyword">as</span> response:
                    text = <span class="hljs-keyword">await</span> response.text()
                    <span class="hljs-keyword">return</span> {
                        <span class="hljs-string">'url'</span>: url,
                        <span class="hljs-string">'status'</span>: response.status,
                        <span class="hljs-string">'size'</span>: <span class="hljs-built_in">len</span>(text),
                        <span class="hljs-string">'content'</span>: text[:<span class="hljs-number">100</span>]  <span class="hljs-comment"># åªå–å‰100å­—ç¬¦</span>
                    }
            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
                <span class="hljs-keyword">return</span> {<span class="hljs-string">'url'</span>: url, <span class="hljs-string">'error'</span>: <span class="hljs-built_in">str</span>(e)}
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">fetch_multiple</span>(<span class="hljs-params">self, urls: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]]:
        <span class="hljs-string">"""å¹¶å‘è·å–å¤šä¸ªURL"""</span>
        tasks = [self.fetch_url(url) <span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> urls]
        results = <span class="hljs-keyword">await</span> asyncio.gather(*tasks, return_exceptions=<span class="hljs-literal">True</span>)
        
        processed = []
        <span class="hljs-keyword">for</span> result <span class="hljs-keyword">in</span> results:
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(result, Exception):
                processed.append({<span class="hljs-string">'error'</span>: <span class="hljs-built_in">str</span>(result)})
            <span class="hljs-keyword">else</span>:
                processed.append(result)
        
        <span class="hljs-keyword">return</span> processed

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AsyncDatabase</span>:
    <span class="hljs-string">"""å¼‚æ­¥æ•°æ®åº“æ“ä½œ"""</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, dsn: <span class="hljs-built_in">str</span></span>):
        self.dsn = dsn
        self.pool = <span class="hljs-literal">None</span>
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">connect</span>(<span class="hljs-params">self, pool_size: <span class="hljs-built_in">int</span> = <span class="hljs-number">10</span></span>):
        <span class="hljs-string">"""åˆ›å»ºè¿æ¥æ± """</span>
        self.pool = <span class="hljs-keyword">await</span> asyncpg.create_pool(
            self.dsn,
            min_size=<span class="hljs-number">1</span>,
            max_size=pool_size,
            command_timeout=<span class="hljs-number">60</span>
        )
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">close</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""å…³é—­è¿æ¥æ± """</span>
        <span class="hljs-keyword">if</span> self.pool:
            <span class="hljs-keyword">await</span> self.pool.close()
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">batch_insert</span>(<span class="hljs-params">self, table: <span class="hljs-built_in">str</span>, records: <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>]</span>) -&gt; <span class="hljs-built_in">int</span>:
        <span class="hljs-string">"""æ‰¹é‡æ’å…¥æ•°æ®"""</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> records:
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
        
        <span class="hljs-comment"># å‡†å¤‡æ•°æ®</span>
        columns = records[<span class="hljs-number">0</span>].keys()
        values = [<span class="hljs-built_in">tuple</span>(record[col] <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> columns) <span class="hljs-keyword">for</span> record <span class="hljs-keyword">in</span> records]
        
        <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> self.pool.acquire() <span class="hljs-keyword">as</span> conn:
            <span class="hljs-comment"># å¼€å§‹äº‹åŠ¡</span>
            <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> conn.transaction():
                stmt = <span class="hljs-keyword">await</span> conn.prepare(<span class="hljs-string">f"""
                    INSERT INTO <span class="hljs-subst">{table}</span> (<span class="hljs-subst">{<span class="hljs-string">','</span>.join(columns)}</span>)
                    VALUES (<span class="hljs-subst">{<span class="hljs-string">','</span>.join(<span class="hljs-string">f'$<span class="hljs-subst">{i+<span class="hljs-number">1</span>}</span>'</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(columns)))}</span>)
                """</span>)
                
                <span class="hljs-comment"># æ‰¹é‡æ‰§è¡Œ</span>
                <span class="hljs-keyword">await</span> stmt.executemany(values)
                <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(values)
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">concurrent_queries</span>(<span class="hljs-params">self, queries: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>]]:
        <span class="hljs-string">"""å¹¶å‘æ‰§è¡ŒæŸ¥è¯¢"""</span>
        <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute_query</span>(<span class="hljs-params">query: <span class="hljs-built_in">str</span></span>):
            <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> self.pool.acquire() <span class="hljs-keyword">as</span> conn:
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> conn.fetch(query)
        
        tasks = [execute_query(query) <span class="hljs-keyword">for</span> query <span class="hljs-keyword">in</span> queries]
        results = <span class="hljs-keyword">await</span> asyncio.gather(*tasks, return_exceptions=<span class="hljs-literal">True</span>)
        
        processed = []
        <span class="hljs-keyword">for</span> result <span class="hljs-keyword">in</span> results:
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(result, Exception):
                processed.append({<span class="hljs-string">'error'</span>: <span class="hljs-built_in">str</span>(result)})
            <span class="hljs-keyword">else</span>:
                processed.append([<span class="hljs-built_in">dict</span>(record) <span class="hljs-keyword">for</span> record <span class="hljs-keyword">in</span> result])
        
        <span class="hljs-keyword">return</span> processed

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">web_scraper_example</span>():
    <span class="hljs-string">"""ç½‘é¡µæŠ“å–ç¤ºä¾‹"""</span>
    urls = [
        <span class="hljs-string">'https://httpbin.org/get'</span>,
        <span class="hljs-string">'https://httpbin.org/delay/1'</span>,
        <span class="hljs-string">'https://httpbin.org/delay/2'</span>,
        <span class="hljs-string">'https://httpbin.org/status/404'</span>,
        <span class="hljs-string">'https://nonexistent.example.com'</span>,
    ]
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> AsyncWebScraper(concurrency_limit=<span class="hljs-number">3</span>) <span class="hljs-keyword">as</span> scraper:
        results = <span class="hljs-keyword">await</span> scraper.fetch_multiple(urls * <span class="hljs-number">2</span>)  <span class="hljs-comment"># é‡å¤URLæµ‹è¯•å»é‡</span>
        
        <span class="hljs-keyword">for</span> result <span class="hljs-keyword">in</span> results:
            <span class="hljs-keyword">if</span> <span class="hljs-string">'error'</span> <span class="hljs-keyword">in</span> result:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"é”™è¯¯: <span class="hljs-subst">{result[<span class="hljs-string">'url'</span>]}</span> - <span class="hljs-subst">{result[<span class="hljs-string">'error'</span>]}</span>"</span>)
            <span class="hljs-keyword">else</span>:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æˆåŠŸ: <span class="hljs-subst">{result[<span class="hljs-string">'url'</span>]}</span> - çŠ¶æ€: <span class="hljs-subst">{result[<span class="hljs-string">'status'</span>]}</span>"</span>)

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">database_example</span>():
    <span class="hljs-string">"""æ•°æ®åº“ç¤ºä¾‹ï¼ˆéœ€è¦PostgreSQLæ•°æ®åº“ï¼‰"""</span>
    <span class="hljs-comment"># æ³¨æ„ï¼šå®é™…ä½¿ç”¨æ—¶éœ€è¦æ›¿æ¢ä¸ºçœŸå®çš„æ•°æ®åº“è¿æ¥ä¿¡æ¯</span>
    dsn = <span class="hljs-string">"postgresql://user:password@localhost/dbname"</span>
    
    db = AsyncDatabase(dsn)
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">await</span> db.connect()
        
        <span class="hljs-comment"># åˆ›å»ºæµ‹è¯•è¡¨</span>
        <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> db.pool.acquire() <span class="hljs-keyword">as</span> conn:
            <span class="hljs-keyword">await</span> conn.execute(<span class="hljs-string">'''
                CREATE TABLE IF NOT EXISTS test_users (
                    id SERIAL PRIMARY KEY,
                    name TEXT NOT NULL,
                    age INTEGER,
                    created_at TIMESTAMP DEFAULT NOW()
                )
            '''</span>)
        
        <span class="hljs-comment"># æ‰¹é‡æ’å…¥</span>
        users = [
            {<span class="hljs-string">'name'</span>: <span class="hljs-string">'Alice'</span>, <span class="hljs-string">'age'</span>: <span class="hljs-number">25</span>},
            {<span class="hljs-string">'name'</span>: <span class="hljs-string">'Bob'</span>, <span class="hljs-string">'age'</span>: <span class="hljs-number">30</span>},
            {<span class="hljs-string">'name'</span>: <span class="hljs-string">'Charlie'</span>, <span class="hljs-string">'age'</span>: <span class="hljs-number">35</span>},
        ]
        
        count = <span class="hljs-keyword">await</span> db.batch_insert(<span class="hljs-string">'test_users'</span>, users)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ’å…¥äº† <span class="hljs-subst">{count}</span> æ¡è®°å½•"</span>)
        
        <span class="hljs-comment"># å¹¶å‘æŸ¥è¯¢</span>
        queries = [
            <span class="hljs-string">"SELECT * FROM test_users WHERE age &gt; 20"</span>,
            <span class="hljs-string">"SELECT COUNT(*) as count FROM test_users"</span>,
            <span class="hljs-string">"SELECT name, age FROM test_users ORDER BY age DESC"</span>,
        ]
        
        results = <span class="hljs-keyword">await</span> db.concurrent_queries(queries)
        <span class="hljs-keyword">for</span> i, result <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(results):
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æŸ¥è¯¢ <span class="hljs-subst">{i+<span class="hljs-number">1</span>}</span> ç»“æœ: <span class="hljs-subst">{result}</span>"</span>)
            
    <span class="hljs-keyword">finally</span>:
        <span class="hljs-keyword">await</span> db.close()

<span class="hljs-comment"># è¿è¡Œç¤ºä¾‹</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"=== ç½‘é¡µæŠ“å–ç¤ºä¾‹ ==="</span>)
    <span class="hljs-keyword">await</span> web_scraper_example()
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n=== å¼‚æ­¥ç®¡é“ç¤ºä¾‹ ==="</span>)
    <span class="hljs-keyword">await</span> AsyncPipeline().run()

<span class="hljs-comment"># æ³¨æ„ï¼šæ•°æ®åº“ç¤ºä¾‹éœ€è¦çœŸå®æ•°æ®åº“ï¼Œè¿™é‡Œåªå±•ç¤ºä»£ç ç»“æ„</span>
<span class="hljs-comment"># asyncio.run(main())</span>
</code></pre>
<h2 data-id="heading-10">å…­ã€è°ƒè¯•ä¸æ€§èƒ½ä¼˜åŒ–</h2>
<h3 data-id="heading-11">å¼‚æ­¥ä»£ç è°ƒè¯•å·¥å…·</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">import</span> logging
<span class="hljs-keyword">from</span> contextvars <span class="hljs-keyword">import</span> ContextVar
<span class="hljs-keyword">import</span> traceback
<span class="hljs-keyword">import</span> uvloop  <span class="hljs-comment"># é«˜æ€§èƒ½äº‹ä»¶å¾ªç¯</span>

<span class="hljs-comment"># è®¾ç½®å¼‚æ­¥è°ƒè¯•æ—¥å¿—</span>
logging.basicConfig(level=logging.DEBUG)
logger = logging.getLogger(__name__)

<span class="hljs-comment"># ä¸Šä¸‹æ–‡å˜é‡</span>
request_id: ContextVar[<span class="hljs-built_in">str</span>] = ContextVar(<span class="hljs-string">'request_id'</span>, default=<span class="hljs-string">'unknown'</span>)

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AsyncDebugger</span>:
    <span class="hljs-string">"""å¼‚æ­¥è°ƒè¯•å™¨"""</span>
    
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">enable_debug_mode</span>():
        <span class="hljs-string">"""å¯ç”¨è°ƒè¯•æ¨¡å¼"""</span>
        <span class="hljs-comment"># å¯ç”¨è¯¦ç»†æ—¥å¿—</span>
        logging.getLogger(<span class="hljs-string">'asyncio'</span>).setLevel(logging.DEBUG)
        
        <span class="hljs-comment"># è®¾ç½®äº‹ä»¶å¾ªç¯è°ƒè¯•</span>
        loop = asyncio.get_event_loop()
        loop.set_debug(<span class="hljs-literal">True</span>)
        
        <span class="hljs-comment"># æ…¢å›è°ƒè­¦å‘Šï¼ˆç§’ï¼‰</span>
        loop.slow_callback_duration = <span class="hljs-number">0.1</span>
        
        <span class="hljs-comment"># å®‰è£…å¼‚å¸¸å¤„ç†å™¨</span>
        loop.set_exception_handler(AsyncDebugger.exception_handler)
    
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">exception_handler</span>(<span class="hljs-params">loop, context</span>):
        <span class="hljs-string">"""å¤„ç†äº‹ä»¶å¾ªç¯å¼‚å¸¸"""</span>
        message = context.get(<span class="hljs-string">'message'</span>, <span class="hljs-string">'æœªå¤„ç†çš„å¼‚å¸¸'</span>)
        exception = context.get(<span class="hljs-string">'exception'</span>)
        task = context.get(<span class="hljs-string">'task'</span>)
        
        logger.error(<span class="hljs-string">f"äº‹ä»¶å¾ªç¯å¼‚å¸¸: <span class="hljs-subst">{message}</span>"</span>)
        
        <span class="hljs-keyword">if</span> exception:
            logger.error(<span class="hljs-string">f"å¼‚å¸¸è¯¦æƒ…: <span class="hljs-subst">{exception}</span>"</span>)
            logger.error(<span class="hljs-string">f"å¼‚å¸¸å †æ ˆ: <span class="hljs-subst">{traceback.format_exc()}</span>"</span>)
        
        <span class="hljs-keyword">if</span> task:
            logger.error(<span class="hljs-string">f"ç›¸å…³ä»»åŠ¡: <span class="hljs-subst">{task}</span>"</span>)
        
        <span class="hljs-comment"># æ‰“å°æ‰€æœ‰è¿è¡Œä¸­çš„ä»»åŠ¡</span>
        tasks = asyncio.all_tasks(loop)
        <span class="hljs-keyword">if</span> tasks:
            logger.error(<span class="hljs-string">f"å½“å‰è¿è¡Œä¸­çš„ä»»åŠ¡æ•°: <span class="hljs-subst">{<span class="hljs-built_in">len</span>(tasks)}</span>"</span>)
            <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> tasks:
                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> t.done():
                    logger.error(<span class="hljs-string">f"  ä»»åŠ¡: <span class="hljs-subst">{t}</span>, çŠ¶æ€: <span class="hljs-subst">{t._state}</span>"</span>)
    
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">trace_coroutine</span>(<span class="hljs-params">coro, name: <span class="hljs-built_in">str</span> = <span class="hljs-literal">None</span></span>):
        <span class="hljs-string">"""è·Ÿè¸ªåç¨‹æ‰§è¡Œ"""</span>
        <span class="hljs-keyword">import</span> time
        start = time.time()
        
        <span class="hljs-keyword">try</span>:
            result = <span class="hljs-keyword">await</span> coro
            elapsed = time.time() - start
            logger.debug(<span class="hljs-string">f"åç¨‹ <span class="hljs-subst">{name <span class="hljs-keyword">or</span> coro.__name__}</span> å®Œæˆï¼Œè€—æ—¶: <span class="hljs-subst">{elapsed:<span class="hljs-number">.3</span>f}</span>s"</span>)
            <span class="hljs-keyword">return</span> result
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            elapsed = time.time() - start
            logger.error(<span class="hljs-string">f"åç¨‹ <span class="hljs-subst">{name <span class="hljs-keyword">or</span> coro.__name__}</span> å¤±è´¥ï¼Œè€—æ—¶: <span class="hljs-subst">{elapsed:<span class="hljs-number">.3</span>f}</span>s, é”™è¯¯: <span class="hljs-subst">{e}</span>"</span>)
            <span class="hljs-keyword">raise</span>

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">performance_example</span>():
    <span class="hljs-string">"""æ€§èƒ½å¯¹æ¯”ç¤ºä¾‹"""</span>
    <span class="hljs-comment"># ä½¿ç”¨uvloopæå‡æ€§èƒ½ï¼ˆLinux/macOSï¼‰</span>
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">import</span> uvloop
        uvloop.install()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ä½¿ç”¨uvloopäº‹ä»¶å¾ªç¯"</span>)
    <span class="hljs-keyword">except</span> ImportError:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ä½¿ç”¨æ ‡å‡†asyncioäº‹ä»¶å¾ªç¯"</span>)
    
    <span class="hljs-comment"># å¯¹æ¯”ä¸åŒå¹¶å‘ç­–ç•¥</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">io_bound_operation</span>(<span class="hljs-params"><span class="hljs-built_in">id</span>: <span class="hljs-built_in">int</span></span>):
        <span class="hljs-string">"""æ¨¡æ‹ŸIOæ“ä½œ"""</span>
        <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">0.1</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">id</span> * <span class="hljs-number">2</span>
    
    <span class="hljs-comment"># æ–¹æ³•1ï¼šé¡ºåºæ‰§è¡Œ</span>
    start = asyncio.get_event_loop().time()
    results1 = []
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):
        results1.append(<span class="hljs-keyword">await</span> io_bound_operation(i))
    time1 = asyncio.get_event_loop().time() - start
    
    <span class="hljs-comment"># æ–¹æ³•2ï¼šå¹¶å‘æ‰§è¡Œ</span>
    start = asyncio.get_event_loop().time()
    tasks = [io_bound_operation(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>)]
    results2 = <span class="hljs-keyword">await</span> asyncio.gather(*tasks)
    time2 = asyncio.get_event_loop().time() - start
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"é¡ºåºæ‰§è¡Œæ—¶é—´: <span class="hljs-subst">{time1:<span class="hljs-number">.3</span>f}</span>s"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¹¶å‘æ‰§è¡Œæ—¶é—´: <span class="hljs-subst">{time2:<span class="hljs-number">.3</span>f}</span>s"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ€§èƒ½æå‡: <span class="hljs-subst">{time1/time2:<span class="hljs-number">.1</span>f}</span>å€"</span>)
    
    <span class="hljs-comment"># å†…å­˜ä½¿ç”¨åˆ†æ</span>
    <span class="hljs-keyword">import</span> sys
    coro = io_bound_operation(<span class="hljs-number">1</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åç¨‹å¯¹è±¡å¤§å°: <span class="hljs-subst">{sys.getsizeof(coro)}</span> å­—èŠ‚"</span>)
    
    task = asyncio.create_task(io_bound_operation(<span class="hljs-number">1</span>))
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ä»»åŠ¡å¯¹è±¡å¤§å°: <span class="hljs-subst">{sys.getsizeof(task)}</span> å­—èŠ‚"</span>)

<span class="hljs-comment"># è¿è¡Œ</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">debug_demo</span>():
    <span class="hljs-string">"""è°ƒè¯•æ¼”ç¤º"""</span>
    AsyncDebugger.enable_debug_mode()
    
    <span class="hljs-comment"># è®¾ç½®è¯·æ±‚ID</span>
    request_id.<span class="hljs-built_in">set</span>(<span class="hljs-string">"req-123"</span>)
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">problematic_coroutine</span>():
        <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">0.05</span>)
        <span class="hljs-comment"># æ¨¡æ‹Ÿé”™è¯¯</span>
        <span class="hljs-keyword">if</span> random.random() &lt; <span class="hljs-number">0.3</span>:
            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">"éšæœºé”™è¯¯"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-string">"æˆåŠŸ"</span>
    
    <span class="hljs-comment"># ä½¿ç”¨è°ƒè¯•åŒ…è£…å™¨</span>
    <span class="hljs-keyword">await</span> AsyncDebugger.trace_coroutine(
        problematic_coroutine(),
        <span class="hljs-string">"æµ‹è¯•åç¨‹"</span>
    )
    
    <span class="hljs-comment"># åˆ›å»ºå¤šä¸ªä»»åŠ¡è§‚å¯Ÿè°ƒè¯•è¾“å‡º</span>
    tasks = []
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):
        task = asyncio.create_task(problematic_coroutine())
        tasks.append(task)
    
    <span class="hljs-keyword">await</span> asyncio.gather(*tasks, return_exceptions=<span class="hljs-literal">True</span>)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-comment"># è¿è¡Œæ€§èƒ½ç¤ºä¾‹</span>
    asyncio.run(performance_example())
    
    <span class="hljs-comment"># è¿è¡Œè°ƒè¯•ç¤ºä¾‹ï¼ˆå–æ¶ˆæ³¨é‡Šä»¥æŸ¥çœ‹è°ƒè¯•è¾“å‡ºï¼‰</span>
    <span class="hljs-comment"># asyncio.run(debug_demo())</span>
</code></pre>
<h2 data-id="heading-12">æ€»ç»“</h2>
<p>Pythonå¼‚æ­¥ç¼–ç¨‹é€šè¿‡<code>asyncio</code>å’Œ<code>async/await</code>æä¾›äº†ï¼š</p>
<h3 data-id="heading-13">æ ¸å¿ƒæ¦‚å¿µï¼š</h3>
<ol>
<li><strong>åç¨‹</strong>ï¼šä½¿ç”¨<code>async def</code>å®šä¹‰çš„å¼‚æ­¥å‡½æ•°</li>
<li><strong>ä»»åŠ¡</strong>ï¼šç®¡ç†å’Œè°ƒåº¦åç¨‹çš„æ‰§è¡Œ</li>
<li><strong>äº‹ä»¶å¾ªç¯</strong>ï¼šåè°ƒæ‰€æœ‰å¼‚æ­¥æ“ä½œçš„ä¸­å¤®è°ƒåº¦å™¨</li>
</ol>
<h3 data-id="heading-14">å…³é”®ç‰¹æ€§ï¼š</h3>
<ol>
<li><strong>å¹¶å‘æ§åˆ¶</strong>ï¼šä¿¡å·é‡ã€é”ã€äº‹ä»¶ã€æ¡ä»¶å˜é‡</li>
<li><strong>å¼‚æ­¥ä¸Šä¸‹æ–‡</strong>ï¼š<code>async with</code>å’Œ<code>async for</code></li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šè¶…æ—¶ã€å–æ¶ˆã€å¼‚å¸¸ä¼ æ’­</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šè¿æ¥æ± ã€é€Ÿç‡é™åˆ¶ã€æ‰¹å¤„ç†</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨å¡«å……è¡¨æ ¼æ³•-ç†è§£01èƒŒåŒ…åŠå…¶å˜ä½“é—®é¢˜]]></title>    <link>https://juejin.cn/post/7591697558377791530</link>    <guid>https://juejin.cn/post/7591697558377791530</guid>    <pubDate>2026-01-06T02:26:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591697558377791530" data-draft-id="7591730714141032490" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨å¡«å……è¡¨æ ¼æ³•-ç†è§£01èƒŒåŒ…åŠå…¶å˜ä½“é—®é¢˜"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-06T02:26:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¢œé…±"/> <meta itemprop="url" content="https://juejin.cn/user/905653309941495"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨å¡«å……è¡¨æ ¼æ³•-ç†è§£01èƒŒåŒ…åŠå…¶å˜ä½“é—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/905653309941495/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¢œé…±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T02:26:36.000Z" title="Tue Jan 06 2026 02:26:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»31åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body cache result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç”¨å¡«å……è¡¨æ ¼æ³•-ç†è§£01èƒŒåŒ…åŠå…¶å˜ä½“é—®é¢˜</h2>
<p>åŠ¨æ€è§„åˆ’ï¼ˆDynamic Programming, DPï¼‰è§£å†³é—®é¢˜çš„æ ¸å¿ƒé€»è¾‘ï¼Œæœ¬è´¨æ˜¯é€šè¿‡<strong>å¡«å……è¡¨æ ¼</strong>é€æ­¥æ¨å¯¼æœ€ä¼˜è§£â€”â€”æŠŠå¤æ‚çš„å¤šé˜¶æ®µå†³ç­–é—®é¢˜ï¼Œè½¬åŒ–ä¸ºæŒ‰è§„åˆ™å¡«å……è¡¨æ ¼çš„å¯è§†åŒ–è¿‡ç¨‹ã€‚ä»¥01èƒŒåŒ…é—®é¢˜ï¼ˆæœ€ç»å…¸çš„DPæ¨¡å‹ï¼‰ä¸ºä¾‹ï¼Œæˆ‘ä»¬å…ˆæ˜ç¡®æœ€ç»ˆè¦å¡«å……çš„æ ¸å¿ƒè¡¨æ ¼å½¢æ€ï¼Œåç»­æ‰€æœ‰è§£é¢˜æ­¥éª¤éƒ½æ˜¯ä¸ºäº†æŒ‰è§„åˆ™å®Œæˆè¿™å¼ è¡¨æ ¼ï¼Œè¡¨æ ¼å¡«å®Œä¹‹æ—¶ï¼Œå°±æ˜¯é—®é¢˜è§£å†³ä¹‹æ—¥ã€‚ï¼ˆçœ‹æ­¤æ–‡å‰ï¼Œå¦‚æœåŠ¨æ€è§„åˆ’é›¶åŸºç¡€ï¼Œè¯·çœ‹ä¸‹<a href="https://juejin.cn/post/7591207451778875418" target="_blank" title="https://juejin.cn/post/7591207451778875418">DPè§£é¢˜çš„5æ­¥ã€Œé’¥åŒ™ã€</a>ï¼‰</p>
<p>01èƒŒåŒ…é—®é¢˜æ ¸å¿ƒè¡¨æ ¼ï¼ˆç©ºè¡¨ï¼Œåç»­é€æ­¥å¡«å……ï¼‰ï¼š</p>





















































<table><thead><tr><th>å‰iä¸ªç‰©å“\èƒŒåŒ…å®¹é‡j</th><th>0ï¼ˆå®¹é‡ä¸º0ï¼‰</th><th>1ï¼ˆå®¹é‡ä¸º1ï¼‰</th><th>2ï¼ˆå®¹é‡ä¸º2ï¼‰</th><th>...ï¼ˆå®¹é‡é€’å¢ï¼‰</th><th>Cï¼ˆèƒŒåŒ…æœ€å¤§å®¹é‡ï¼‰</th></tr></thead><tbody><tr><td>0ï¼ˆæ— ç‰©å“ï¼‰</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td></tr><tr><td>1ï¼ˆç¬¬1ä¸ªç‰©å“ï¼‰</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td></tr><tr><td>2ï¼ˆç¬¬2ä¸ªç‰©å“ï¼‰</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td></tr><tr><td>...ï¼ˆç‰©å“é€’å¢ï¼‰</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td></tr><tr><td>nï¼ˆç¬¬nä¸ªç‰©å“ï¼‰</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……</td><td>å¾…å¡«å……ï¼ˆæœ€ç»ˆç­”æ¡ˆï¼‰</td></tr></tbody></table>
<p>è¡¨æ ¼è¯´æ˜ï¼šè¡¨æ ¼ä¸­æ¯ä¸ªå•å…ƒæ ¼<code>dp[i][j]</code>ä»£è¡¨ã€Œå‰iä¸ªç‰©å“æ”¾å…¥å®¹é‡ä¸ºjçš„èƒŒåŒ…çš„æœ€å¤§ä»·å€¼ã€ï¼Œæˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯æŒ‰è§„åˆ™å¡«å……æ‰€æœ‰å•å…ƒæ ¼ï¼Œæœ€ç»ˆå³ä¸‹è§’<code>dp[n][C]</code>å³ä¸º01èƒŒåŒ…é—®é¢˜çš„æœ€ä¼˜è§£ã€‚</p>
<p>è¦æœ‰åºã€æ­£ç¡®åœ°å¡«å……è¿™å¼ è¡¨æ ¼ï¼Œéœ€è¦éµå¾ª<a href="https://juejin.cn/post/7591207451778875418" target="_blank" title="https://juejin.cn/post/7591207451778875418">DPè§£é¢˜çš„5æ­¥ã€Œé’¥åŒ™ã€</a>â€”â€”è¿™æ˜¯è´¯ç©¿æ‰€æœ‰DPé—®é¢˜çš„é€šç”¨æ‹†è§£æ€è·¯ï¼Œæ¯ä¸€æ­¥éƒ½å¯¹åº”è¡¨æ ¼å¡«å……çš„å…³é”®ç¯èŠ‚ï¼š</p>
<ol>
<li>
<p><strong>ç¡®å®šdpæ•°ç»„åŠä¸‹æ ‡çš„å«ä¹‰</strong>ï¼šæ˜ç¡®<code>dp[i]</code>ï¼ˆæˆ–äºŒç»´<code>dp[i][j]</code>ï¼‰ä»£è¡¨ä»€ä¹ˆç‰©ç†æ„ä¹‰ï¼ˆæ¯”å¦‚"ç¬¬ié˜¶å°é˜¶çš„çˆ¬æ³•æ•°"ã€"å‰iä¸ªç‰©å“æ”¾å…¥å®¹é‡ä¸ºjçš„èƒŒåŒ…çš„æœ€å¤§ä»·å€¼"ï¼‰ï¼›</p>
</li>
<li>
<p><strong>ç¡®å®šé€’æ¨å…¬å¼</strong>ï¼šæ‰¾åˆ°<code>dp[i]</code>ä¸å­é—®é¢˜<code>dp[i-1]</code>/<code>dp[i-2]</code>ç­‰çš„ä¾èµ–å…³ç³»ï¼ˆè¿™æ˜¯DPçš„æ ¸å¿ƒï¼Œæœ¬è´¨æ˜¯å°†å¤§é—®é¢˜æ‹†è§£ä¸ºå¯å¤ç”¨çš„å­é—®é¢˜ï¼‰ï¼›</p>
</li>
<li>
<p><strong>dpæ•°ç»„å¦‚ä½•åˆå§‹åŒ–</strong>ï¼šæ ¹æ®é—®é¢˜è¾¹ç•Œæ¡ä»¶ï¼Œåˆå§‹åŒ–æ— æ³•é€šè¿‡é€’æ¨å¾—åˆ°çš„åŸºç¡€å€¼ï¼ˆæ¯”å¦‚"èƒŒåŒ…å®¹é‡ä¸º0æ—¶ä»·å€¼ä¸º0"ã€"æ— ç‰©å“æ—¶ä»·å€¼ä¸º0"ï¼‰ï¼›</p>
</li>
<li>
<p><strong>ç¡®å®šéå†é¡ºåº</strong>ï¼šä¿è¯è®¡ç®—<code>dp[i]</code>æ—¶ï¼Œå…¶ä¾èµ–çš„å­é—®é¢˜å·²ç»è¢«è®¡ç®—å®Œæˆã€‚è¿™é‡Œå¯ä»¥ç®€å•ç†è§£ä¸ºã€Œè¡¨æ ¼çš„å¡«å……é¡ºåºã€â€”â€” äºŒç»´DPç±»ä¼¼é€è¡Œé€åˆ—å¡«å……è¡¨æ ¼ï¼Œä¸€ç»´DPåˆ™æ˜¯æŒ‰ç‰¹å®šæ–¹å‘ï¼ˆæ­£åº/å€’åºï¼‰å¡«å……å•è¡Œè¡¨æ ¼ï¼›</p>
</li>
<li>
<p><strong>æ‰“å°dpæ•°ç»„ï¼ˆéªŒè¯ï¼‰</strong>ï¼šé€šè¿‡æ‰“å°ä¸­é—´ç»“æœï¼ŒéªŒè¯é€’æ¨é€»è¾‘æ˜¯å¦æ­£ç¡®ï¼ˆè¿™æ˜¯è°ƒè¯•DPé—®é¢˜çš„å¿…å¤‡æ­¥éª¤ï¼Œèƒ½å¿«é€Ÿå®šä½é€’æ¨å…¬å¼æˆ–éå†é¡ºåºçš„é”™è¯¯ï¼‰ã€‚</p>
</li>
</ol>
<p>åç»­æ‰€æœ‰01èƒŒåŒ…åŠå˜ä½“é—®é¢˜çš„åˆ†æï¼Œéƒ½å°†å›´ç»•è¿™5æ­¥ã€Œé’¥åŒ™ã€å±•å¼€ï¼Œæœ¬è´¨å°±æ˜¯ç”¨è¿™5æ­¥è§„åˆ™å®Œæˆå¯¹åº”è¡¨æ ¼çš„å¡«å……ï¼Œæœ€ç»ˆé€šè¿‡è¡¨æ ¼å¾—åˆ°é—®é¢˜ç­”æ¡ˆã€‚</p>
<h3 data-id="heading-1">ä¸€ã€01èƒŒåŒ…é—®é¢˜åŸºç¡€å®šä¹‰</h3>
<p>01èƒŒåŒ…çš„æ ¸å¿ƒåœºæ™¯ï¼šæœ‰<code>n</code>ä¸ªç‰©å“ï¼Œæ¯ä¸ªç‰©å“<strong>åªæœ‰1ä¸ª</strong>ï¼ˆè¦ä¹ˆé€‰ã€è¦ä¹ˆä¸é€‰ï¼Œå³"0-1"é€‰æ‹©ï¼‰ï¼Œæ¯ä¸ªç‰©å“æœ‰å¯¹åº”çš„é‡é‡<code>w[i]</code>å’Œä»·å€¼<code>v[i]</code>ï¼Œç°æœ‰ä¸€ä¸ªå®¹é‡ä¸º<code>C</code>çš„èƒŒåŒ…ï¼Œå¦‚ä½•é€‰æ‹©ç‰©å“æ”¾å…¥èƒŒåŒ…ï¼Œä½¿å¾—æ”¾å…¥ç‰©å“çš„æ€»ä»·å€¼æœ€å¤§ï¼Ÿ</p>
<p>ç¤ºä¾‹ï¼šç‰©å“é‡é‡<code>weights = [2,3,4,5]</code>ï¼Œä»·å€¼<code>values = [3,4,5,6]</code>ï¼ŒèƒŒåŒ…å®¹é‡<code>capacity = 8</code>ï¼Œæ±‚æœ€å¤§ä»·å€¼ã€‚</p>
<h3 data-id="heading-2">äºŒã€åŸºç¡€è§£æ³•ï¼šäºŒç»´DPæ•°ç»„</h3>
<p>æˆ‘ä»¬å°†ä¸¥æ ¼æŒ‰ç…§DPè§£é¢˜çš„5æ­¥ã€Œé’¥åŒ™ã€æ‹†è§£äºŒç»´DPè§£æ³•ï¼Œæ¯ä¸€æ­¥éƒ½å¯¹åº”æ ¸å¿ƒè¡¨æ ¼çš„å¡«å……è§„åˆ™ï¼š</p>
<h4 data-id="heading-3">2.1 æ­¥éª¤1ï¼šç¡®å®šdpæ•°ç»„åŠä¸‹æ ‡çš„å«ä¹‰</h4>
<p>å®šä¹‰äºŒç»´DPæ•°ç»„<code>dp[i][j]</code>ï¼šè¡¨ç¤ºã€Œå‰<code>i</code>ä¸ªç‰©å“ï¼ˆä»ç¬¬1ä¸ªåˆ°ç¬¬<code>i</code>ä¸ªï¼‰ï¼Œæ”¾å…¥å®¹é‡ä¸º<code>j</code>çš„èƒŒåŒ…ä¸­ï¼Œèƒ½è·å¾—çš„æœ€å¤§ä»·å€¼ã€ã€‚</p>
<p>è¯´æ˜ï¼š</p>
<ul>
<li>
<p>ã€Œå‰<code>i</code>ä¸ªç‰©å“ã€ä¸æ˜¯æŒ‡ç¼–å·ä¸º<code>i</code>çš„ç‰©å“ï¼Œè€Œæ˜¯èŒƒå›´ä¸Šçš„å‰<code>i</code>ä¸ªï¼ˆæ¯”å¦‚<code>i=2</code>ä»£è¡¨å‰2ä¸ªç‰©å“ï¼‰ï¼›</p>
</li>
<li>
<p>ä¸‹æ ‡<code>i</code>çš„èŒƒå›´ï¼š0<del>nï¼ˆ<code>i=0</code>è¡¨ç¤ºæ— ç‰©å“ï¼‰ï¼Œä¸‹æ ‡<code>j</code>çš„èŒƒå›´ï¼š0</del>Cï¼ˆ<code>j=0</code>è¡¨ç¤ºèƒŒåŒ…å®¹é‡ä¸º0ï¼‰ã€‚</p>
</li>
</ul>
<h4 data-id="heading-4">2.2 æ­¥éª¤2ï¼šç¡®å®šé€’æ¨å…¬å¼</h4>
<p>å¯¹äºç¬¬<code>i</code>ä¸ªç‰©å“ï¼ˆé‡é‡<code>w[i-1]</code>ã€ä»·å€¼<code>v[i-1]</code>ï¼Œå› æ•°ç»„ä¸‹æ ‡ä»0å¼€å§‹ï¼‰ï¼Œæœ‰ä¸¤ç§é€‰æ‹©ï¼šé€‰æˆ–ä¸é€‰ï¼Œé€’æ¨å…¬å¼ç”±æ­¤è€Œæ¥ï¼š</p>
<ol>
<li>
<p><strong><code>i</code></strong> <strong>ä¸é€‰ç¬¬ä¸ªç‰©å“</strong>ï¼šå‰<code>i</code>ä¸ªç‰©å“çš„æœ€å¤§ä»·å€¼ = å‰<code>i-1</code>ä¸ªç‰©å“çš„æœ€å¤§ä»·å€¼ï¼Œå³<code>dp[i][j] = dp[i-1][j]</code>ï¼›</p>
</li>
<li>
<p><strong><code>i</code></strong> <strong>é€‰ç¬¬ä¸ªç‰©å“</strong>ï¼šéœ€ä¿è¯èƒŒåŒ…å®¹é‡<code>j â‰¥ w[i-1]</code>ï¼Œæ­¤æ—¶ä»·å€¼ = å‰<code>i-1</code>ä¸ªç‰©å“æ”¾å…¥å®¹é‡<code>j - w[i-1]</code>çš„æœ€å¤§ä»·å€¼ + ç¬¬<code>i</code>ä¸ªç‰©å“çš„ä»·å€¼ï¼Œå³<code>dp[i][j] = dp[i-1][j - w[i-1]] + v[i-1]</code>ã€‚</p>
</li>
</ol>
<p>ç»¼åˆä¸¤ç§æƒ…å†µï¼Œå–æœ€å¤§å€¼ä½œä¸º<code>dp[i][j]</code>çš„ç»“æœï¼š</p>
<pre><code class="hljs language-Plain" lang="Plain">
dp[i][j] = max(dp[i-1][j], dp[i-1][j - w[i-1]] + v[i-1]) ï¼ˆå½“j â‰¥ w[i-1]æ—¶ï¼‰
dp[i][j] = dp[i-1][j] ï¼ˆå½“j &lt; w[i-1]æ—¶ï¼Œå®¹é‡ä¸è¶³ï¼Œæ— æ³•é€‰ç¬¬iä¸ªç‰©å“ï¼‰
</code></pre>
<h4 data-id="heading-5">2.3 æ­¥éª¤3ï¼šdpæ•°ç»„å¦‚ä½•åˆå§‹åŒ–</h4>
<p>æ ¹æ®è¾¹ç•Œæ¡ä»¶åˆå§‹åŒ–ï¼š</p>
<ol>
<li>
<p><code>i=0</code>ï¼ˆæ— ç‰©å“ï¼‰ï¼šæ— è®ºèƒŒåŒ…å®¹é‡å¤šå¤§ï¼Œæœ€å¤§ä»·å€¼éƒ½æ˜¯0ï¼Œå³<code>dp[0][j] = 0</code>ï¼ˆ<code>j</code>ä»0åˆ°Cï¼‰ï¼›</p>
</li>
<li>
<p><code>j=0</code>ï¼ˆèƒŒåŒ…å®¹é‡ä¸º0ï¼‰ï¼šæ— è®ºæœ‰å¤šå°‘ç‰©å“ï¼Œéƒ½æ— æ³•æ”¾å…¥ï¼Œæœ€å¤§ä»·å€¼éƒ½æ˜¯0ï¼Œå³<code>dp[i][0] = 0</code>ï¼ˆ<code>i</code>ä»0åˆ°nï¼‰ã€‚</p>
</li>
</ol>
<p>åˆå§‹åŒ–åï¼ŒDPæ•°ç»„çš„ç¬¬ä¸€è¡Œå’Œç¬¬ä¸€åˆ—éƒ½ä¸º0ã€‚</p>
<h4 data-id="heading-6">2.4 æ­¥éª¤4ï¼šç¡®å®šéå†é¡ºåºï¼ˆè¡¨æ ¼å¡«å……é¡ºåºï¼‰</h4>
<p>éå†é¡ºåºç›´æ¥å¯¹åº”äºŒç»´è¡¨æ ¼çš„å¡«å……é¡ºåºâ€”â€”å³ã€ŒæŒ‰ä»€ä¹ˆé¡ºåºé€ä¸ªå¡«å†™è¡¨æ ¼ä¸­çš„å•å…ƒæ ¼ã€ï¼Œè¿™é‡Œæœ‰ä¸¤ç§å¯è¡Œæ–¹å¼ï¼š</p>
<ol>
<li>
<p>å…ˆéå†ç‰©å“ï¼ˆ<code>i</code>ä»1åˆ°nï¼‰ï¼Œå†éå†èƒŒåŒ…å®¹é‡ï¼ˆ<code>j</code>ä»1åˆ°Cï¼‰ï¼›</p>
</li>
<li>
<p>å…ˆéå†èƒŒåŒ…å®¹é‡ï¼ˆ<code>j</code>ä»1åˆ°Cï¼‰ï¼Œå†éå†ç‰©å“ï¼ˆ<code>i</code>ä»1åˆ°nï¼‰ã€‚</p>
</li>
</ol>
<p>ä¸¤ç§é¡ºåºéƒ½å¯è¡Œï¼Œå› ä¸ºè®¡ç®—<code>dp[i][j]</code>æ—¶ï¼Œåªä¾èµ–ä¸Šä¸€è¡Œï¼ˆ<code>i-1</code>è¡Œï¼‰çš„ç»“æœï¼Œæ— è®ºå…ˆå¡«è¡Œè¿˜æ˜¯å…ˆå¡«åˆ—ï¼Œä¸Šä¸€è¡Œçš„å¯¹åº”ä½ç½®éƒ½å·²æå‰è®¡ç®—å®Œæˆã€‚è¿™å°±åƒå¡«å……ä¸€å¼ äºŒç»´è¡¨æ ¼ï¼šå…ˆéå†ç‰©å“å†éå†å®¹é‡ï¼Œæ˜¯<strong>é€è¡Œå¡«å……</strong>ï¼ˆæ¯ä¸€è¡Œå¯¹åº”ä¸€ä¸ªç‰©å“çš„å†³ç­–ï¼Œå¡«å®Œä¸€è¡Œå†å¤„ç†ä¸‹ä¸€ä¸ªç‰©å“ï¼‰ï¼›å…ˆéå†å®¹é‡å†éå†ç‰©å“ï¼Œæ˜¯<strong>é€åˆ—å¡«å……</strong>ï¼ˆæ¯ä¸€åˆ—å¯¹åº”ä¸€ä¸ªå›ºå®šå®¹é‡ï¼Œå…ˆç¡®å®šæ‰€æœ‰ç‰©å“åœ¨è¯¥å®¹é‡ä¸‹çš„æœ€ä¼˜è§£ï¼‰ã€‚å®é™…è§£é¢˜ä¸­æ›´å¸¸ç”¨ã€Œå…ˆéå†ç‰©å“ï¼Œå†éå†å®¹é‡ã€çš„é¡ºåºï¼Œç¬¦åˆæˆ‘ä»¬ã€Œé€ä¸ªè€ƒè™‘ç‰©å“æ˜¯å¦æ”¾å…¥ã€çš„æ€è€ƒé€»è¾‘ã€‚</p>
<h4 data-id="heading-7">2.5 æ­¥éª¤5ï¼šæ‰“å°dpæ•°ç»„ï¼ˆéªŒè¯ï¼‰</h4>
<p>è¿™ä¸€æ­¥æ˜¯ç›´æ¥éªŒè¯è¡¨æ ¼å¡«å……ç»“æœçš„æ­£ç¡®æ€§â€”â€”é€šè¿‡é€æ­¥å¡«å……è¡¨æ ¼ã€æ‰“å°ä¸­é—´çŠ¶æ€ï¼Œç¡®è®¤æ¯ä¸€æ­¥éƒ½ç¬¦åˆé€’æ¨è§„åˆ™ï¼Œé¿å…å› è§„åˆ™ç†è§£åå·®å¯¼è‡´å¡«å……é”™è¯¯ã€‚ä»¥ç¤ºä¾‹<code>weights = [2,3,4,5]</code>ã€<code>values = [3,4,5,6]</code>ã€<code>capacity = 8</code>ä¸ºä¾‹ï¼Œé€æ­¥å¡«å……æ ¸å¿ƒè¡¨æ ¼éªŒè¯é€»è¾‘ï¼š</p>
<p>ä»¥ç¤ºä¾‹<code>weights = [2,3,4,5]</code>ã€<code>values = [3,4,5,6]</code>ã€<code>capacity = 8</code>ä¸ºä¾‹ï¼Œé€æ­¥å¡«å……è¡¨æ ¼éªŒè¯é€»è¾‘ï¼š</p>
<p>åˆå§‹DPæ•°ç»„ï¼ˆç¬¬ä¸€è¡Œã€ç¬¬ä¸€åˆ—ä¸º0ï¼‰ï¼š</p>





























<table><thead><tr><th>å‰iä¸ªç‰©å“\èƒŒåŒ…å®¹é‡j</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th></tr></thead><tbody><tr><td>0ï¼ˆæ— ç‰©å“ï¼‰</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr></tbody></table>
<p>æ­¥éª¤1ï¼šå¤„ç†ç¬¬1ä¸ªç‰©å“ï¼ˆé‡é‡2ï¼Œä»·å€¼3ï¼‰</p>
<p>jâ‰¥2æ—¶å–max(ä¸Šä¸€è¡Œj, ä¸Šä¸€è¡Œj-2+3)ï¼š</p>





























<table><thead><tr><th>å‰iä¸ªç‰©å“\èƒŒåŒ…å®¹é‡j</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th></tr></thead><tbody><tr><td>1ï¼ˆç‰©å“[2,3]ï¼‰</td><td>0</td><td>0</td><td>3</td><td>3</td><td>3</td><td>3</td><td>3</td><td>3</td><td>3</td></tr></tbody></table>
<p>æ­¥éª¤2ï¼šå¤„ç†ç¬¬2ä¸ªç‰©å“ï¼ˆé‡é‡3ï¼Œä»·å€¼4ï¼‰</p>
<p>jâ‰¥3æ—¶å–max(ä¸Šä¸€è¡Œj, ä¸Šä¸€è¡Œj-3+4)ï¼š</p>





























<table><thead><tr><th>å‰iä¸ªç‰©å“\èƒŒåŒ…å®¹é‡j</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th></tr></thead><tbody><tr><td>2ï¼ˆç‰©å“[2,3]ã€[3,4]ï¼‰</td><td>0</td><td>0</td><td>3</td><td>4</td><td>4</td><td>7</td><td>7</td><td>7</td><td>7</td></tr></tbody></table>
<p>æ­¥éª¤3ï¼šå¤„ç†ç¬¬3ä¸ªç‰©å“ï¼ˆé‡é‡4ï¼Œä»·å€¼5ï¼‰</p>
<p>jâ‰¥4æ—¶å–max(ä¸Šä¸€è¡Œj, ä¸Šä¸€è¡Œj-4+5)ï¼š</p>





























<table><thead><tr><th>å‰iä¸ªç‰©å“\èƒŒåŒ…å®¹é‡j</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th></tr></thead><tbody><tr><td>3ï¼ˆæ–°å¢[4,5]ï¼‰</td><td>0</td><td>0</td><td>3</td><td>4</td><td>5</td><td>7</td><td>8</td><td>9</td><td>9</td></tr></tbody></table>
<p>æ­¥éª¤4ï¼šå¤„ç†ç¬¬4ä¸ªç‰©å“ï¼ˆé‡é‡5ï¼Œä»·å€¼6ï¼‰</p>
<p>jâ‰¥5æ—¶å–max(ä¸Šä¸€è¡Œj, ä¸Šä¸€è¡Œj-5+6)ï¼š</p>





























<table><thead><tr><th>å‰iä¸ªç‰©å“\èƒŒåŒ…å®¹é‡j</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th></tr></thead><tbody><tr><td>4ï¼ˆæ–°å¢[5,6]ï¼‰</td><td>0</td><td>0</td><td>3</td><td>4</td><td>5</td><td>7</td><td>8</td><td>9</td><td>10</td></tr></tbody></table>
<p>æœ€ç»ˆ<code>dp[4][8] = 10</code>ï¼Œä¸æµ‹è¯•ç”¨ä¾‹ç»“æœä¸€è‡´ï¼Œå³æœ€å¤§ä»·å€¼ä¸º10ã€‚</p>
<p>å®Œæ•´äºŒç»´DPæ•°ç»„å˜åŒ–æ±‡æ€»è¡¨ï¼š</p>













































































<table><thead><tr><th>å‰iä¸ªç‰©å“\èƒŒåŒ…å®¹é‡j</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th></tr></thead><tbody><tr><td>0ï¼ˆæ— ç‰©å“ï¼‰</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>1ï¼ˆç‰©å“[2,3]ï¼‰</td><td>0</td><td>0</td><td>3</td><td>3</td><td>3</td><td>3</td><td>3</td><td>3</td><td>3</td></tr><tr><td>2ï¼ˆç‰©å“[2,3]ã€[3,4]ï¼‰</td><td>0</td><td>0</td><td>3</td><td>4</td><td>4</td><td>7</td><td>7</td><td>7</td><td>7</td></tr><tr><td>3ï¼ˆæ–°å¢[4,5]ï¼‰</td><td>0</td><td>0</td><td>3</td><td>4</td><td>5</td><td>7</td><td>8</td><td>9</td><td>9</td></tr><tr><td>4ï¼ˆæ–°å¢[5,6]ï¼‰</td><td>0</td><td>0</td><td>3</td><td>4</td><td>5</td><td>7</td><td>8</td><td>9</td><td>10</td></tr></tbody></table>
<ul>
<li>
<p>æ—¶é—´å¤æ‚åº¦ï¼š<code>O(n*C)</code>ï¼ˆ<code>n</code>ä¸ºç‰©å“æ•°ï¼Œ<code>C</code>ä¸ºèƒŒåŒ…å®¹é‡ï¼‰ï¼›</p>
</li>
<li>
<p>ç©ºé—´å¤æ‚åº¦ï¼š<code>O(n*C)</code>ï¼ˆäºŒç»´æ•°ç»„çš„ç©ºé—´å¼€é”€ï¼‰ã€‚</p>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€èŠ‚ç‚¹ã€‘[NormalReconstructZèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨]]></title>    <link>https://juejin.cn/post/7591770429931257906</link>    <guid>https://juejin.cn/post/7591770429931257906</guid>    <pubDate>2026-01-06T02:38:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591770429931257906" data-draft-id="7591770429930569778" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€èŠ‚ç‚¹ã€‘[NormalReconstructZèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨"/> <meta itemprop="keywords" content="æ¸¸æˆå¼€å‘,Unity3D,å›¾å½¢å­¦"/> <meta itemprop="datePublished" content="2026-01-06T02:38:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SmalBox"/> <meta itemprop="url" content="https://juejin.cn/user/2218166695237532"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€èŠ‚ç‚¹ã€‘[NormalReconstructZèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2218166695237532/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SmalBox
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T02:38:41.000Z" title="Tue Jan 06 2026 02:38:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong></p>
</blockquote>
<h2 data-id="heading-0">èŠ‚ç‚¹åŠŸèƒ½æ¦‚è¿°</h2>
<p>æ³•çº¿Zå€¼é‡å»ºèŠ‚ç‚¹ï¼ˆNormal Reconstruct Z Nodeï¼‰æ˜¯Unity URPæ¸²æŸ“ç®¡çº¿ä¸­çš„å…³é”®ç»„ä»¶ï¼Œä¸“é—¨ç”¨äºä»æ³•çº¿å‘é‡çš„Xå’ŒYåˆ†é‡æ¨å¯¼å‡ºæ­£ç¡®çš„Zåˆ†é‡ã€‚è¯¥èŠ‚ç‚¹é€šè¿‡ç²¾ç¡®çš„æ•°å­¦è®¡ç®—ï¼Œå®ç°äº†æ³•çº¿æ•°æ®çš„å‹ç¼©å­˜å‚¨ä¸ç‰©ç†æ­£ç¡®æ€§ä¿éšœï¼Œåœ¨æ³•çº¿è´´å›¾ä¼˜åŒ–è¿‡ç¨‹ä¸­å‘æŒ¥ç€é‡è¦ä½œç”¨ã€‚åœ¨å®é™…æ¸²æŸ“æµç¨‹ä¸­ï¼Œå®ƒèƒ½å¤Ÿæœ‰æ•ˆè§£å†³å› æ³•çº¿è´´å›¾å‹ç¼©å¯¼è‡´çš„æ•°æ®ä¸¢å¤±é—®é¢˜ï¼Œç¡®ä¿å…‰ç…§è®¡ç®—çš„å‡†ç¡®æ€§ï¼Œæ˜¯é«˜è´¨é‡å®æ—¶æ¸²æŸ“ä¸å¯æˆ–ç¼ºçš„ä¸€ç¯ã€‚è¯¥èŠ‚ç‚¹çš„è®¾è®¡å……åˆ†è€ƒè™‘äº†ç°ä»£å›¾å½¢ç¡¬ä»¶çš„ç‰¹æ€§ï¼Œèƒ½å¤Ÿåœ¨ä¿æŒé«˜è´¨é‡è§†è§‰æ•ˆæœçš„åŒæ—¶ï¼Œæ˜¾è‘—é™ä½å†…å­˜å¸¦å®½å’Œå­˜å‚¨ç©ºé—´çš„éœ€æ±‚ï¼Œç‰¹åˆ«é€‚åˆç§»åŠ¨å¹³å°å’Œæ€§èƒ½æ•æ„Ÿçš„åº”ç”¨åœºæ™¯ã€‚</p>
<h2 data-id="heading-1">ç«¯å£ä¸å‚æ•°è¯¦è§£</h2>
<ul>
<li><strong>è¾“å…¥ç«¯å£</strong>
<ul>
<li>Inï¼šVector2ç±»å‹ï¼ŒåŒ…å«æ³•çº¿è´´å›¾çš„Xå’ŒYåˆ†é‡å€¼ï¼Œé€šå¸¸æ¥è‡ªå‹ç¼©åçš„æ³•çº¿è´´å›¾é‡‡æ ·ç»“æœã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œè¿™äº›è¾“å…¥æ•°æ®é€šå¸¸æ¥è‡ªç»è¿‡BC5/DXT5NMç­‰å‹ç¼©æ ¼å¼å¤„ç†çš„æ³•çº¿è´´å›¾ï¼Œè¿™äº›æ ¼å¼ä¸“é—¨è®¾è®¡ç”¨äºå­˜å‚¨åŒé€šé“çš„æ³•çº¿æ•°æ®ã€‚</li>
</ul>
</li>
<li><strong>è¾“å‡ºç«¯å£</strong>
<ul>
<li>Outï¼šVector3ç±»å‹ï¼Œè¾“å‡ºå®Œæ•´çš„æ³•çº¿å‘é‡ï¼Œå¯ç›´æ¥ç”¨äºå…‰ç…§è®¡ç®—å’Œæè´¨è¡¨ç°ã€‚è¾“å‡ºçš„æ³•çº¿å‘é‡å·²ç»è¿‡å½’ä¸€åŒ–å¤„ç†ï¼Œç¡®ä¿åœ¨åç»­çš„ç€è‰²å™¨è®¡ç®—ä¸­èƒ½å¤Ÿæ­£ç¡®å‚ä¸å…‰ç…§æ–¹ç¨‹çš„è¿ç®—ã€‚</li>
</ul>
</li>
</ul>
<h2 data-id="heading-2">æ•°å­¦åŸç†ä¸ç®—æ³•</h2>
<p>è¯¥èŠ‚ç‚¹åŸºäºå•ä½å‘é‡çš„åŸºæœ¬æ€§è´¨è¿›è¡ŒZåˆ†é‡é‡å»ºï¼Œæ ¸å¿ƒç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>è®¡ç®—Xå’ŒYåˆ†é‡çš„å¹³æ–¹å’Œï¼Œå³å‘é‡åœ¨XYå¹³é¢ä¸Šçš„é•¿åº¦å¹³æ–¹ï¼Œè¿™ä¸€æ­¥éª¤å®é™…ä¸Šæ˜¯è®¡ç®—æ³•çº¿åœ¨XYå¹³é¢ä¸Šçš„æŠ•å½±é•¿åº¦ã€‚</li>
<li>é€šè¿‡1å‡å»è¯¥å¹³æ–¹å’Œå¾—åˆ°Zåˆ†é‡çš„å¹³æ–¹å€¼ï¼Œè¿™ä¸€æ­¥éª¤åŸºäºå•ä½å‘é‡æ¨¡é•¿ä¸º1çš„åŸºæœ¬æ€§è´¨ï¼Œå³xÂ² + yÂ² + zÂ² = 1çš„æ•°å­¦å…³ç³»ã€‚</li>
<li>å¯¹ç»“æœå–å¹³æ–¹æ ¹è·å¾—Zåˆ†é‡å€¼ï¼Œéœ€æ³¨æ„æ­£è´Ÿå·çš„å¤„ç†ã€‚åœ¨å®é™…å®ç°ä¸­ï¼Œé€šå¸¸å‡è®¾æ³•çº¿æŒ‡å‘è¡¨é¢å¤–ä¾§ï¼Œå› æ­¤Zåˆ†é‡ä¸ºæ­£å€¼ã€‚</li>
<li>å¯¹æœ€ç»ˆç»“æœè¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼Œç¡®ä¿è¾“å‡ºå‘é‡çš„å•ä½é•¿åº¦ï¼Œè¿™å¯¹äºä¿æŒå…‰ç…§è®¡ç®—çš„ç‰©ç†æ­£ç¡®æ€§è‡³å…³é‡è¦ã€‚</li>
</ol>
<h2 data-id="heading-3">ç”Ÿæˆä»£ç è§£æ</h2>
<p>ä»¥ä¸‹æ˜¯è¯¥èŠ‚ç‚¹çš„å…¸å‹HLSLå®ç°ä»£ç ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">void</span> <span class="hljs-title function_">Unity_NormalReconstructZ_float</span><span class="hljs-params">(float2 In, out float3 Out)</span>
{
    <span class="hljs-type">float</span> reconstructZ = <span class="hljs-built_in">sqrt</span>(<span class="hljs-number">1.0</span> - saturate(dot(In.xy, In.xy)));
    float3 normalVector = float3(In.x, In.y, reconstructZ);
    Out = normalize(normalVector);
}
</code></pre>
<p>ä»£ç è§£æè¦ç‚¹ï¼š</p>
<ul>
<li><code>dot(In.xy, In.xy)</code>è®¡ç®—Xå’ŒYåˆ†é‡çš„ç‚¹ç§¯ï¼Œç­‰ä»·äºxÂ² + yÂ²ï¼Œè¿™æ˜¯è®¡ç®—äºŒç»´å‘é‡é•¿åº¦çš„å¹³æ–¹çš„æ ‡å‡†æ–¹æ³•ã€‚</li>
<li><code>saturate()</code>å‡½æ•°ç¡®ä¿è®¡ç®—ç»“æœè¢«é™åˆ¶åœ¨0-1èŒƒå›´å†…ï¼Œé˜²æ­¢å‡ºç°æ— æ•ˆçš„è´Ÿå€¼å¼€æ–¹ï¼Œè¿™å¯¹äºå¤„ç†å¯èƒ½å­˜åœ¨çš„æ•°å€¼è¯¯å·®è‡³å…³é‡è¦ã€‚</li>
<li><code>sqrt()</code>å‡½æ•°è®¡ç®—Zåˆ†é‡ï¼Œé‡å»ºæ³•çº¿å‘é‡çš„å‚ç›´åˆ†é‡ï¼Œè¿™æ˜¯æ•´ä¸ªé‡å»ºè¿‡ç¨‹çš„æ ¸å¿ƒè®¡ç®—æ­¥éª¤ã€‚</li>
<li><code>normalize()</code>å‡½æ•°ä¿è¯è¾“å‡ºä¸ºå•ä½å‘é‡ï¼Œç¡®ä¿å…‰ç…§è®¡ç®—çš„æ­£ç¡®æ€§ï¼Œç‰¹åˆ«æ˜¯åœ¨é«˜å…‰è®¡ç®—å’Œåå°„è®¡ç®—ä¸­ä¿æŒç‰©ç†å‡†ç¡®æ€§ã€‚</li>
</ul>
<h2 data-id="heading-4">åº”ç”¨åœºæ™¯</h2>
<p>è¯¥èŠ‚ç‚¹åœ¨ä»¥ä¸‹åœºæ™¯ä¸­å…·æœ‰é‡è¦åº”ç”¨ä»·å€¼ï¼š</p>
<ul>
<li>æ³•çº¿è´´å›¾å‹ç¼©å­˜å‚¨ï¼šé€šè¿‡ä»…å­˜å‚¨XYåˆ†é‡æ˜¾è‘—å‡å°‘çº¹ç†å†…å­˜å ç”¨ï¼Œåœ¨ç§»åŠ¨è®¾å¤‡ä¸Šå¯ä»¥èŠ‚çœé«˜è¾¾50%çš„æ³•çº¿è´´å›¾å†…å­˜ä½¿ç”¨ã€‚</li>
<li>åŠ¨æ€æ³•çº¿ç”Ÿæˆï¼šåœ¨è¿è¡Œæ—¶åŸºäºç¨‹åºåŒ–çº¹ç†ç”Ÿæˆå®Œæ•´æ³•çº¿æ•°æ®ï¼Œé€‚ç”¨äºåœ°å½¢ç”Ÿæˆã€æ°´é¢æ¨¡æ‹Ÿç­‰åŠ¨æ€ç¯å¢ƒã€‚</li>
<li>æ³•çº¿è´´å›¾ä¼˜åŒ–ï¼šåœ¨ç§»åŠ¨å¹³å°ä¸Šå®ç°é«˜è´¨é‡çš„æ³•çº¿æ¸²æŸ“æ•ˆæœï¼ŒåŒæ—¶ä¿æŒè¾ƒä½çš„æ€§èƒ½å¼€é”€ã€‚</li>
<li>ç‰¹æ®Šæè´¨æ•ˆæœå®ç°ï¼šå¦‚æ°´é¢æ³¢çº¹ã€å¸ƒæ–™è¤¶çš±ç­‰åŠ¨æ€è§†è§‰æ•ˆæœï¼Œé€šè¿‡å®æ—¶é‡å»ºæ³•çº¿å®ç°å¤æ‚çš„è¡¨é¢ç»†èŠ‚ã€‚</li>
<li>å»¶è¿Ÿæ¸²æŸ“ç®¡çº¿ï¼šåœ¨G-Bufferä¸­ä¼˜åŒ–æ³•çº¿æ•°æ®å­˜å‚¨ç»“æ„ï¼Œå‡å°‘æ˜¾å­˜å ç”¨å’Œå¸¦å®½æ¶ˆè€—ã€‚</li>
<li>å¤šå¹³å°é€‚é…ï¼šæœ‰æ•ˆè§£å†³ä¸åŒå¹³å°æ³•çº¿è´´å›¾å‹ç¼©æ ¼å¼å·®å¼‚é—®é¢˜ï¼Œç¡®ä¿è·¨å¹³å°æ¸²æŸ“çš„ä¸€è‡´æ€§ã€‚</li>
</ul>
<h2 data-id="heading-5">ä½¿ç”¨æŠ€å·§ä¸ä¼˜åŒ–</h2>
<ul>
<li>å‚æ•°è°ƒæ•´æŒ‡å—ï¼šæ ¹æ®å…·ä½“æè´¨ç±»å‹é€‚å½“è°ƒæ•´æ³•çº¿å¼ºåº¦å‚æ•°ï¼Œå¯¹äºé‡‘å±æè´¨å¯ä»¥é€‚å½“å¢å¼ºæ³•çº¿æ•ˆæœï¼Œè€Œå¯¹äºç²—ç³™è¡¨é¢åˆ™éœ€è¦æ›´ç»†è‡´çš„æ§åˆ¶ã€‚</li>
<li>æ€§èƒ½ä¼˜åŒ–å»ºè®®ï¼šåœ¨ä½ç«¯è®¾å¤‡ä¸Šå¯è€ƒè™‘ç®€åŒ–éƒ¨åˆ†è®¡ç®—æ­¥éª¤ï¼Œæ¯”å¦‚åœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥çœç•¥å½’ä¸€åŒ–æ“ä½œä»¥è·å¾—æ€§èƒ½æå‡ã€‚</li>
<li>å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆï¼šå¦¥å–„å¤„ç†æ³•çº¿æ–¹å‘å¼‚å¸¸å’Œè®¡ç®—ç²¾åº¦é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯åœ¨è¾¹ç¼˜æƒ…å†µä¸‹éœ€è¦ç‰¹åˆ«æ³¨æ„æ•°å€¼ç¨³å®šæ€§ã€‚</li>
<li>ç§»åŠ¨ç«¯é€‚é…ï¼šé’ˆå¯¹ç§»åŠ¨GPUç‰¹æ€§ä¼˜åŒ–è®¡ç®—ç²¾åº¦å’Œæ€§èƒ½è¡¨ç°ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨åŠç²¾åº¦æµ®ç‚¹æ•°è¿›è¡Œè®¡ç®—ã€‚</li>
<li>å¤šå…‰æºåœºæ™¯ï¼šç¡®ä¿é‡å»ºçš„æ³•çº¿åœ¨å¤šå…‰æºç¯å¢ƒä¸‹ä¿æŒæ­£ç¡®è¡¨ç°ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„æ³•çº¿åœ¨å¤šä¸ªå…‰æºä¸‹çš„äº¤äº’æ•ˆæœã€‚</li>
</ul>
<h2 data-id="heading-6">æ³¨æ„äº‹é¡¹</h2>
<ul>
<li>æ³•çº¿æ–¹å‘å¼‚å¸¸å¤„ç†ï¼šç‰¹åˆ«æ³¨æ„åˆ‡çº¿ç©ºé—´æ³•çº¿çš„æ­£ç¡®æ–¹å‘è®¾å®šï¼Œç¡®ä¿é‡å»ºçš„æ³•çº¿ä¸åŸå§‹æ³•çº¿æ–¹å‘ä¸€è‡´ã€‚</li>
<li>çº¹ç†é‡‡æ ·é”™è¯¯é¢„é˜²ï¼šç¡®ä¿è¾“å…¥æ•°æ®å¤„äºæ­£ç¡®çš„æ•°å€¼èŒƒå›´å†…ï¼Œé¿å…å› çº¹ç†é‡‡æ ·é”™è¯¯å¯¼è‡´çš„é‡å»ºå¤±è´¥ã€‚</li>
<li>é”¯é½¿è¾¹ç¼˜é—®é¢˜è§£å†³ï¼šé€‚å½“ä½¿ç”¨å„å‘å¼‚æ€§è¿‡æ»¤æŠ€æœ¯æ”¹å–„è¾¹ç¼˜è´¨é‡ï¼Œç‰¹åˆ«æ˜¯åœ¨æ³•çº¿è´´å›¾åŒ…å«é«˜é¢‘ç»†èŠ‚æ—¶ã€‚</li>
<li>å¹³å°å…¼å®¹æ€§è€ƒé‡ï¼šæ³¨æ„ä¸åŒå›¾å½¢APIä¸‹çš„è¡Œä¸ºå·®å¼‚ï¼Œç‰¹åˆ«æ˜¯åœ¨OpenGL ESå’ŒVulkanå¹³å°ä¸Šçš„è¡¨ç°å¯èƒ½æœ‰æ‰€ä¸åŒã€‚</li>
<li>ç²¾åº¦æ§åˆ¶ï¼šé¿å…å› æµ®ç‚¹ç²¾åº¦ä¸è¶³å¯¼è‡´çš„æ¸²æŸ“ç‘•ç–µï¼Œåœ¨å…³é”®è®¡ç®—æ­¥éª¤ä¸­ä½¿ç”¨å…¨ç²¾åº¦æµ®ç‚¹æ•°ã€‚</li>
</ul>
<h2 data-id="heading-7">æ€»ç»“ä¸æ‹“å±•åº”ç”¨</h2>
<p>è¯¥èŠ‚ç‚¹åœ¨Unity URPç®¡çº¿ä¸­ä¸ºæ³•çº¿è´´å›¾å¤„ç†æä¾›äº†é«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡ä¸¥è°¨çš„æ•°å­¦æ¨å¯¼å®ç°Zåˆ†é‡é‡å»ºï¼Œåœ¨ä¿æŒè§†è§‰è´¨é‡çš„åŒæ—¶ä¼˜åŒ–äº†èµ„æºä½¿ç”¨æ•ˆç‡ã€‚å…¶åº”ç”¨èŒƒå›´ä¸ä»…é™äºåŸºç¡€æ³•çº¿å¤„ç†ï¼Œè¿˜å¯æ‰©å±•è‡³é«˜çº§æè´¨æ•ˆæœå¼€å‘ï¼Œå¦‚PBRæè´¨ç³»ç»Ÿã€è§†å·®é®æŒ¡æ˜ å°„ã€æ›²é¢ç»†åˆ†ç­‰å…ˆè¿›æ¸²æŸ“æŠ€æœ¯ã€‚éšç€å®æ—¶æ¸²æŸ“æŠ€æœ¯çš„æŒç»­å‘å±•ï¼Œè¯¥èŠ‚ç‚¹åœ¨è™šæ‹Ÿç°å®ã€å¢å¼ºç°å®ç­‰æ–°å…´é¢†åŸŸä¹Ÿå°†å‘æŒ¥æ›´åŠ é‡è¦çš„ä½œç”¨ã€‚ç‰¹åˆ«æ˜¯åœ¨ä¸‹ä¸€ä»£å›¾å½¢APIå¦‚DirectX 12 Ultimateå’ŒVulkançš„èƒŒæ™¯ä¸‹ï¼Œè¯¥æŠ€æœ¯å°†ç»§ç»­æ¼”è¿›ï¼Œä¸ºå®æ—¶å›¾å½¢æ¸²æŸ“æä¾›æ›´åŠ é«˜æ•ˆå’Œçµæ´»çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<hr/>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong>
ï¼ˆæ¬¢è¿<em>ç‚¹èµç•™è¨€</em>æ¢è®¨ï¼Œæ›´å¤šäººåŠ å…¥è¿›æ¥èƒ½æ›´åŠ å®Œå–„è¿™ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ï¼ŒğŸ™ï¼‰</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å®æˆ˜ï¼šæ„å»ºåŸºäº aio_periodic çš„é«˜æ€§èƒ½å¼‚æ­¥ AI ç»˜å›¾ Worker]]></title>    <link>https://juejin.cn/post/7591730714141098026</link>    <guid>https://juejin.cn/post/7591730714141098026</guid>    <pubDate>2026-01-06T02:39:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591730714141098026" data-draft-id="7591730714141048874" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å®æˆ˜ï¼šæ„å»ºåŸºäº aio_periodic çš„é«˜æ€§èƒ½å¼‚æ­¥ AI ç»˜å›¾ Worker"/> <meta itemprop="keywords" content="Python,AIGC"/> <meta itemprop="datePublished" content="2026-01-06T02:39:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Lupino"/> <meta itemprop="url" content="https://juejin.cn/user/3051900006579256"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å®æˆ˜ï¼šæ„å»ºåŸºäº aio_periodic çš„é«˜æ€§èƒ½å¼‚æ­¥ AI ç»˜å›¾ Worker
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3051900006579256/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Lupino
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T02:39:03.000Z" title="Tue Jan 06 2026 02:39:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå°†è®¡ç®—å¯†é›†å‹ä»»åŠ¡ï¼ˆå¦‚ AI å›¾åƒç”Ÿæˆï¼‰ä» Web æœåŠ¡ä¸­å‰¥ç¦»æ˜¯å¸¸è§çš„æ¶æ„æ¨¡å¼ã€‚æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨ Python çš„ <code>asyncio</code> å’Œ <code>aio_periodic</code> æ„å»ºä¸€ä¸ªå¥å£®çš„ Workerï¼Œå®ƒèƒ½å¤Ÿè°ƒç”¨æœ¬åœ° MLX æ¨ç†å¼•æ“ç”Ÿæˆå›¾ç‰‡ï¼ŒåŒæ—¶ä¿æŒé«˜å¹¶å‘ä¸‹çš„ç¨³å®šæ€§ã€‚</p>
<h2 data-id="heading-0">1. æ¶æ„æ¦‚è¿°</h2>
<p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ„å»ºä¸€ä¸ª Worker èŠ‚ç‚¹ï¼Œå®ƒè´Ÿè´£ï¼š</p>
<ol>
<li><strong>ç›‘å¬ä»»åŠ¡</strong>ï¼šä» <code>periodicd</code> ä»»åŠ¡æœåŠ¡å™¨é¢†å–ç»˜å›¾ä»»åŠ¡ã€‚</li>
<li><strong>æ‰§è¡Œæ¨ç†</strong>ï¼šè°ƒç”¨é€‚é… Apple Silicon çš„ <code>z-image-turbo-mlx</code> è„šæœ¬ã€‚</li>
<li><strong>éé˜»å¡äº¤äº’</strong>ï¼šåœ¨é•¿è¾¾æ•°ç§’çš„ç”Ÿæˆè¿‡ç¨‹ä¸­ï¼Œä¿æŒä¸æœåŠ¡å™¨çš„å¿ƒè·³è¿æ¥ã€‚</li>
<li><strong>ç»“æœå›ä¼ </strong>ï¼šå°†ç”Ÿæˆçš„å›¾ç‰‡è½¬ä¸º Base64 ä¼ å›ã€‚</li>
</ol>
<h2 data-id="heading-1">2. æ ¸å¿ƒæŒ‘æˆ˜ï¼šåŒæ­¥ vs å¼‚æ­¥</h2>
<p>åœ¨æ—©æœŸå®ç°ä¸­ï¼Œå¼€å‘è€…å¸¸ç›´æ¥ä½¿ç”¨ <code>os.system</code> è°ƒç”¨å¤–éƒ¨å‘½ä»¤ã€‚è¿™åœ¨å¼‚æ­¥æ¡†æ¶ï¼ˆå¦‚ <code>asyncio</code>ï¼‰ä¸­æ˜¯è‡´å‘½çš„ã€‚</p>
<ul>
<li><strong>é—®é¢˜</strong>ï¼š<code>os.system</code> ä¼šé˜»å¡æ•´ä¸ª Python è¿›ç¨‹ã€‚åœ¨ AI ç”Ÿæˆå›¾ç‰‡çš„ 5-10 ç§’å†…ï¼ŒEvent Loop åœæ­¢è¿è½¬ï¼ŒWorker æ— æ³•å‘é€å¿ƒè·³åŒ…ï¼ˆHeartbeatï¼‰ï¼Œå¯¼è‡´æœåŠ¡å™¨è¯¯åˆ¤ Worker æ‰çº¿å¹¶é‡æ–°åˆ†é…ä»»åŠ¡ï¼Œé€ æˆâ€œåƒµå°¸ä»»åŠ¡â€å¾ªç¯ã€‚</li>
<li><strong>è§£æ³•</strong>ï¼šä½¿ç”¨ <code>asyncio.create_subprocess_exec</code>ã€‚å®ƒå…è®¸æˆ‘ä»¬åœ¨ç­‰å¾…å­è¿›ç¨‹ç»“æŸæ—¶ï¼Œè®©å‡º CPU æ§åˆ¶æƒï¼Œä½¿ Worker èƒ½ç»§ç»­å¤„ç†ç½‘ç»œ IOã€‚</li>
</ul>
<h2 data-id="heading-2">3. ä»£ç å®ç°äº®ç‚¹</h2>
<h3 data-id="heading-3">3.1 å®‰å…¨çš„å­è¿›ç¨‹è°ƒç”¨</h3>
<p>ä¸ºäº†é˜²æ­¢ Shell å‘½ä»¤æ³¨å…¥æ”»å‡»ï¼ˆä¾‹å¦‚ç”¨æˆ·åœ¨ prompt ä¸­è¾“å…¥ <code>; rm -rf /</code>ï¼‰ï¼Œæˆ‘ä»¬æ”¾å¼ƒå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œæ”¹ç”¨åˆ—è¡¨ä¼ å‚ï¼š</p>
<p>Python</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ¨èåšæ³•ï¼šåˆ—è¡¨ä¼ å‚</span>
<span class="hljs-attr">cmd</span> = [
    sys.executable, <span class="hljs-string">'generate_mlx.py'</span>,
    <span class="hljs-string">'--prompt'</span>, user_prompt,
    <span class="hljs-string">'--output'</span>, output_filename
]
<span class="hljs-comment"># asyncio è´Ÿè´£å®‰å…¨åœ°å°†å‚æ•°ä¼ ç»™å­è¿›ç¨‹ï¼Œæ— éœ€ç»è¿‡ Shell è§£é‡Š</span>
<span class="hljs-attr">process</span> = await asyncio.create_subprocess_exec(*cmd)
</code></pre>
<h3 data-id="heading-4">3.2 ä¿æŒ Event Loop æ´»è·ƒ</h3>
<p>å¯¹äºæ–‡ä»¶è¯»å–è¿™ç§ IO æ“ä½œï¼Œè™½ç„¶ Python çš„ <code>open()</code> æ˜¯åŒæ­¥çš„ï¼Œä½†åœ¨é«˜å¹¶å‘ä¸‹ä¾ç„¶å¯èƒ½é€ æˆå¾®å°çš„å¡é¡¿ã€‚æˆ‘ä»¬åˆ©ç”¨ <code>run_in_executor</code> å°†å…¶æ”¾å…¥çº¿ç¨‹æ± ï¼š</p>
<p>Python</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å°†åŒæ­¥çš„æ–‡ä»¶è¯»å–æ‰”åˆ°çº¿ç¨‹æ± ï¼Œé¿å…é˜»å¡ä¸»å¾ªç¯</span>
<span class="hljs-attr">loop</span> = asyncio.get_running_loop()
<span class="hljs-attr">b64_str</span> = await loop.run_in_executor(
    None, 
    partial(blocking_image_to_base64, output_filename)
)
</code></pre>
<h3 data-id="heading-5">3.3 å¥å£®çš„èµ„æºæ¸…ç†</h3>
<p>AI ä»»åŠ¡å¸¸å› æ˜¾å­˜ä¸è¶³æˆ–å‚æ•°é”™è¯¯è€Œå¤±è´¥ã€‚ä½¿ç”¨ <code>try...finally</code> æ¨¡å¼ç¡®ä¿å³ä½¿ç”Ÿæˆå¤±è´¥ï¼Œä¸´æ—¶æ–‡ä»¶ä¹Ÿèƒ½è¢«æ¸…ç†ï¼Œä¿æŒç¯å¢ƒæ•´æ´ã€‚</p>
<p>Python</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">try</span>:
    <span class="hljs-keyword">await</span> run_generation()
except Exception:
    logger.error(<span class="hljs-string">"Job failed"</span>)
<span class="hljs-keyword">finally</span>:
    <span class="hljs-keyword">if</span> os.path.exists(temp_file):
        os.<span class="hljs-keyword">remove</span>(temp_file) <span class="hljs-meta"># æ— è®ºæˆåŠŸå¤±è´¥ï¼Œå¿…é¡»æ¸…ç†åƒåœ¾</span>
</code></pre>
<h2 data-id="heading-6">4. å®æ—¶æ—¥å¿—æµ</h2>
<p>ä¸ºäº†æ–¹ä¾¿è¿ç»´ç›‘æ§ï¼Œæˆ‘ä»¬é…ç½®å­è¿›ç¨‹ç›´æ¥ç»§æ‰¿çˆ¶è¿›ç¨‹çš„æ ‡å‡†è¾“å‡ºã€‚è¿™æ„å‘³ç€ä½ åœ¨è¿è¡Œ Worker çš„ç»ˆç«¯ä¸Šï¼Œå¯ä»¥ç›´æ¥çœ‹åˆ°åº•å±‚ <code>generate_mlx.py</code> æ‰“å°çš„è¿›åº¦æ¡å’Œæ—¥å¿—ï¼Œè€Œæ— éœ€å¤æ‚çš„ç®¡é“è½¬å‘ã€‚</p>
<h2 data-id="heading-7">5. æ€»ç»“</h2>
<p>é€šè¿‡å°† <code>aio_periodic</code> çš„ä»»åŠ¡è°ƒåº¦èƒ½åŠ›ä¸ <code>asyncio</code> çš„å­è¿›ç¨‹ç®¡ç†ç»“åˆï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªæ—¢èƒ½åˆ©ç”¨æœ¬åœ°å¼ºå¤§ç®—åŠ›ï¼ˆMLXï¼‰ï¼Œåˆå®Œå…¨ç¬¦åˆåˆ†å¸ƒå¼ç³»ç»Ÿç¨³å®šæ€§è¦æ±‚çš„ Workerã€‚è¿™ç§æ¨¡å¼åŒæ ·é€‚ç”¨äºè§†é¢‘è½¬ç ã€PDF ç”Ÿæˆç­‰å…¶ä»–è€—æ—¶ä»»åŠ¡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¶…å®ç”¨çš„AIç»˜å›¾æç¤ºè¯ï¼šå¿«é€Ÿç»˜åˆ¶æ ‘çŠ¶æ¶æ„å›¾]]></title>    <link>https://juejin.cn/post/7591672090791362579</link>    <guid>https://juejin.cn/post/7591672090791362579</guid>    <pubDate>2026-01-06T02:43:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591672090791362579" data-draft-id="7591730714141147178" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¶…å®ç”¨çš„AIç»˜å›¾æç¤ºè¯ï¼šå¿«é€Ÿç»˜åˆ¶æ ‘çŠ¶æ¶æ„å›¾"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯"/> <meta itemprop="datePublished" content="2026-01-06T02:43:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æš–é˜³_"/> <meta itemprop="url" content="https://juejin.cn/user/1662117312465406"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¶…å®ç”¨çš„AIç»˜å›¾æç¤ºè¯ï¼šå¿«é€Ÿç»˜åˆ¶æ ‘çŠ¶æ¶æ„å›¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1662117312465406/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æš–é˜³_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T02:43:22.000Z" title="Tue Jan 06 2026 02:43:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">è¶…å®ç”¨çš„AIç»˜å›¾æç¤ºè¯ï¼šå¿«é€Ÿç»˜åˆ¶æ ‘çŠ¶æ¶æ„å›¾</h2>
<p>ä»Šå¤©ç»™å¤§å®¶åˆ†äº«ä¸€ä¸ªç‰¹åˆ«ç‰¹åˆ«å®ç”¨çš„ç»˜å›¾æç¤ºè¯ï¼Œæ¥å¸®ä½ å¿«é€Ÿç»˜åˆ¶æ ‘çŠ¶æ¶æ„å›¾ï¼Œç”Ÿæˆç»“æ„åŒ–å†…å®¹ï¼Œä¸å†éœ€è¦æ‰“å¼€å„ç§è„‘å›¾æ–‡ä»¶ï¼Œç›´æ¥åœ¨å’ŒAIå¯¹è¯æ—¶å€™å°±å¯ä»¥è¾“å‡ºï¼Œå¹¶ä¸”æ”¯æŒéšæ„ç¼–è¾‘ã€‚</p>
<h3 data-id="heading-1">ğŸ“‹ æç¤ºè¯æ¨¡æ¿</h3>
<pre><code class="hljs language-markdown" lang="markdown">è¯·å¸®æˆ‘ç»˜åˆ¶ä¸€ä¸ªæ ‘çŠ¶ç³»ç»Ÿæ¶æ„å›¾ï¼Œä½¿ç”¨ä»¥ä¸‹æ ¼å¼è§„èŒƒï¼š

ã€æ ¼å¼è§„èŒƒã€‘
<span class="hljs-bullet">1.</span> ä½¿ç”¨ ASCII å­—ç¬¦ç»˜åˆ¶æ ‘çŠ¶ç»“æ„ï¼š
<span class="hljs-bullet">   -</span> ç«–çº¿ï¼šâ”‚ ï¼ˆè¡¨ç¤ºå‚ç›´è¿æ¥ï¼‰
<span class="hljs-bullet">   -</span> åˆ†æ”¯ï¼šâ”œâ”€â†’ ï¼ˆè¡¨ç¤ºå‘å³çš„åˆ†æ”¯ï¼‰
<span class="hljs-bullet">   -</span> æœ«åˆ†æ”¯ï¼šâ””â”€â†’ ï¼ˆè¡¨ç¤ºæœ€åä¸€ä¸ªåˆ†æ”¯ï¼‰
<span class="hljs-bullet">   -</span> æ–¹æ‹¬å·ï¼š[] ï¼ˆè¡¨ç¤ºä¸»è¦ç»„ä»¶/æ¨¡å—ï¼‰
<span class="hljs-bullet">   -</span> èŠ±æ‹¬å·ï¼š{{}} ï¼ˆè¡¨ç¤ºå ä½ç¬¦ï¼Œéœ€è¦æ›¿æ¢çš„å†…å®¹ï¼‰
<span class="hljs-bullet">   -</span> åœ†æ‹¬å·ï¼š() ï¼ˆè¡¨ç¤ºé™„åŠ è¯´æ˜ä¿¡æ¯ï¼‰
<span class="hljs-bullet">   -</span> ç®­å¤´ï¼šâ† â†’ ï¼ˆè¡¨ç¤ºæ•°æ®æµå‘æˆ–è¿æ¥å…³ç³»ï¼‰

<span class="hljs-bullet">2.</span> ç¼©è¿›è§„åˆ™ï¼š
<span class="hljs-bullet">   -</span> æ¯çº§å­èŠ‚ç‚¹å‘å³ç¼©è¿› 4 ä¸ªç©ºæ ¼
<span class="hljs-bullet">   -</span> ä¿æŒå±‚çº§å¯¹é½

<span class="hljs-bullet">3.</span> å ä½ç¬¦ä½¿ç”¨ï¼š
<span class="hljs-bullet">   -</span> {{ç³»ç»Ÿåç§°}} - ç³»ç»Ÿä¸»åç§°
<span class="hljs-bullet">   -</span> {{å±‚çº§åç§°}} - å„å±‚çº§åç§°
<span class="hljs-bullet">   -</span> {{ç»„ä»¶åç§°}} - å…·ä½“ç»„ä»¶åç§°
<span class="hljs-bullet">   -</span> {{å­ç»„ä»¶}} - å­ç»„ä»¶åç§°
<span class="hljs-bullet">   -</span> {{è¯´æ˜ä¿¡æ¯}} - é™„åŠ è¯´æ˜

ã€ç¤ºä¾‹æ¨¡æ¿ã€‘
{{ç³»ç»Ÿåç§°}}
<span class="hljs-code">    â”‚
    â”œâ”€â†’ [{{ç¬¬ä¸€å±‚ç»„ä»¶1}}]
    â”‚       â”‚
    â”‚       â”œâ”€â†’ [{{å­ç»„ä»¶1-1}}]
    â”‚       â”‚       â”‚
    â”‚       â”‚       â””â”€â†’ [{{å­ç»„ä»¶1-1-1}}] ({{è¯´æ˜ä¿¡æ¯}})
    â”‚       â”‚
    â”‚       â””â”€â†’ [{{å­ç»„ä»¶1-2}}] â† {{è¿æ¥è¯´æ˜}}
    â”‚
    â”œâ”€â†’ [{{ç¬¬ä¸€å±‚ç»„ä»¶2}}]
    â”‚       â”‚
    â”‚       â””â”€â†’ [{{å­ç»„ä»¶2-1}}] â”€â†’ [{{ç›®æ ‡ç»„ä»¶}}] ({{å‚æ•°}})
    â”‚
    â””â”€â†’ [{{ç¬¬ä¸€å±‚ç»„ä»¶3}}]
            â”‚
            â”œâ”€â†’ [{{å­ç»„ä»¶3-1}}]
            â”‚
            â””â”€â†’ [{{å­ç»„ä»¶3-2}}]
                    â”‚
                    â””â”€ {{è¿æ¥çº¿}} â”€â†’ [{{æœ€ç»ˆç»„ä»¶}}]
</span>
ã€ç»˜åˆ¶è¦æ±‚ã€‘
<span class="hljs-bullet">1.</span> ä¿æŒæ ‘çŠ¶ç»“æ„çš„æ¸…æ™°å’Œå¯¹ç§°
<span class="hljs-bullet">2.</span> æ¯ä¸ªèŠ‚ç‚¹ä½¿ç”¨æ–¹æ‹¬å· [] åŒ…è£¹
<span class="hljs-bullet">3.</span> å ä½ç¬¦ä½¿ç”¨åŒèŠ±æ‹¬å· {{}} åŒ…è£¹
<span class="hljs-bullet">4.</span> é™„åŠ ä¿¡æ¯ä½¿ç”¨åœ†æ‹¬å· () åŒ…è£¹
<span class="hljs-bullet">5.</span> è¿æ¥å…³ç³»ä½¿ç”¨ç®­å¤´ â† â†’ è¡¨ç¤º
<span class="hljs-bullet">6.</span> ç¡®ä¿æ‰€æœ‰åˆ†æ”¯å¯¹é½ç¾è§‚
</code></pre>
<h3 data-id="heading-2">ğŸ¯ ä½¿ç”¨ç¤ºä¾‹</h3>
<h4 data-id="heading-3">ç¤ºä¾‹1ï¼šç”¨æˆ·ç™»å½•ç³»ç»Ÿæ¶æ„</h4>
<p><strong>æç¤ºè¯ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">è¯·ä½¿ç”¨æ ‘çŠ¶å›¾æ ¼å¼ç»˜åˆ¶ç”¨æˆ·ç™»å½•ç³»ç»Ÿæ¶æ„ï¼Œæ›¿æ¢ä»¥ä¸‹å ä½ç¬¦ï¼š
<span class="hljs-deletion">- {{ç³»ç»Ÿåç§°}} = ç”¨æˆ·ç™»å½•ç³»ç»Ÿ</span>
<span class="hljs-deletion">- {{ç¬¬ä¸€å±‚ç»„ä»¶1}} = å‰ç«¯å±‚</span>
<span class="hljs-deletion">- {{å­ç»„ä»¶1-1}} = ç™»å½•é¡µé¢</span>
<span class="hljs-deletion">- {{å­ç»„ä»¶1-2}} = ç”¨æˆ·ç•Œé¢</span>
<span class="hljs-deletion">- {{ç¬¬ä¸€å±‚ç»„ä»¶2}} = åç«¯æœåŠ¡</span>
<span class="hljs-deletion">- {{å­ç»„ä»¶2-1}} = è®¤è¯æœåŠ¡</span>
<span class="hljs-deletion">- {{ç›®æ ‡ç»„ä»¶}} = æ•°æ®åº“</span>
<span class="hljs-deletion">- {{å‚æ•°}} = MySQL</span>
</code></pre>
<p><strong>æ•ˆæœï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss">ç”¨æˆ·ç™»å½•ç³»ç»Ÿ
    â”‚
    â”œâ”€â†’ <span class="hljs-selector-attr">[å‰ç«¯å±‚]</span>
    â”‚       â”‚
    â”‚       â”œâ”€â†’ <span class="hljs-selector-attr">[ç™»å½•é¡µé¢]</span>
    â”‚       â”‚
    â”‚       â””â”€â†’ <span class="hljs-selector-attr">[ç”¨æˆ·ç•Œé¢]</span>
    â”‚
    â””â”€â†’ <span class="hljs-selector-attr">[åç«¯æœåŠ¡]</span>
            â”‚
            â””â”€â†’ <span class="hljs-selector-attr">[è®¤è¯æœåŠ¡]</span> â”€â†’ <span class="hljs-selector-attr">[æ•°æ®åº“]</span> (MySQL)
</code></pre>
<h4 data-id="heading-4">ç¤ºä¾‹2ï¼šå¾®æœåŠ¡æ¶æ„</h4>
<p><strong>æç¤ºè¯ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">è¯·ç»˜åˆ¶å¾®æœåŠ¡æ¶æ„å›¾ï¼ŒåŒ…å«ï¼š
<span class="hljs-deletion">- ç½‘å…³å±‚</span>
<span class="hljs-deletion">- ç”¨æˆ·æœåŠ¡ï¼ˆè¿æ¥MySQLï¼‰</span>
<span class="hljs-deletion">- è®¢å•æœåŠ¡ï¼ˆè¿æ¥Redisï¼‰</span>
<span class="hljs-deletion">- æ”¯ä»˜æœåŠ¡ï¼ˆè¿æ¥æ¶ˆæ¯é˜Ÿåˆ—ï¼‰</span>
</code></pre>
<p><strong>æ•ˆæœï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss">å¾®æœåŠ¡æ¶æ„
    â”‚
    â”œâ”€â†’ <span class="hljs-selector-attr">[APIç½‘å…³]</span>
    â”‚       â”‚
    â”‚       â”œâ”€â†’ <span class="hljs-selector-attr">[ç”¨æˆ·æœåŠ¡]</span> â”€â†’ <span class="hljs-selector-attr">[MySQL]</span> (æ•°æ®å­˜å‚¨)
    â”‚       â”‚
    â”‚       â”œâ”€â†’ <span class="hljs-selector-attr">[è®¢å•æœåŠ¡]</span> â”€â†’ <span class="hljs-selector-attr">[Redis]</span> (ç¼“å­˜)
    â”‚       â”‚
    â”‚       â””â”€â†’ <span class="hljs-selector-attr">[æ”¯ä»˜æœåŠ¡]</span> â”€â†’ <span class="hljs-selector-attr">[æ¶ˆæ¯é˜Ÿåˆ—]</span> (å¼‚æ­¥å¤„ç†)
    â”‚
    â””â”€â†’ <span class="hljs-selector-attr">[ç›‘æ§ä¸­å¿ƒ]</span>
            â”‚
            â””â”€â†’ <span class="hljs-selector-attr">[æ—¥å¿—æ”¶é›†]</span> â”€â†’ <span class="hljs-selector-attr">[ELK]</span> (æ—¥å¿—åˆ†æ)
</code></pre>
<h4 data-id="heading-5">ç¤ºä¾‹3ï¼šç‰©è”ç½‘è®¾å¤‡æ¶æ„</h4>
<p><strong>æç¤ºè¯ï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss">ç»˜åˆ¶ç‰©è”ç½‘è®¾å¤‡æ¶æ„ï¼Œå‚è€ƒæ ¼å¼ï¼š
<span class="hljs-selector-attr">[å†…å®¹1]</span>
    â”‚
    â”œâ”€â†’ <span class="hljs-selector-attr">[å†…å®¹2]</span> â† USBå……ç”µå£
    â”‚
    â””â”€â†’ {{å†…å®¹ä¸‰}}
            â”‚
            â”œâ”€â†’ <span class="hljs-selector-attr">[{{å­å†…å®¹}}]</span> â”€â†’ <span class="hljs-selector-attr">[èˆµæœº]</span> (<span class="hljs-number">5</span>V)
            â”‚
            â””â”€â†’ <span class="hljs-selector-attr">[{{å­å†…å®¹}}]</span> â”€â†’ <span class="hljs-selector-attr">[ESP8266]</span> (<span class="hljs-number">3.3</span>V)
                    â”‚
                    â””â”€ GPIO2 â”€â†’ <span class="hljs-selector-attr">[èˆµæœºä¿¡å·çº¿]</span>
</code></pre>
<p><strong>æ•ˆæœï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss">ç‰©è”ç½‘æ§åˆ¶ç³»ç»Ÿ
    â”‚
    â”œâ”€â†’ <span class="hljs-selector-attr">[ç”µæºæ¨¡å—]</span> â† USBå……ç”µå£
    â”‚
    â””â”€â†’ <span class="hljs-selector-attr">[æ§åˆ¶æ¨¡å—]</span>
            â”‚
            â”œâ”€â†’ <span class="hljs-selector-attr">[æ‰§è¡Œå™¨æ§åˆ¶]</span> â”€â†’ <span class="hljs-selector-attr">[èˆµæœº]</span> (<span class="hljs-number">5</span>V)
            â”‚
            â””â”€â†’ <span class="hljs-selector-attr">[é€šä¿¡æ¨¡å—]</span> â”€â†’ <span class="hljs-selector-attr">[ESP8266]</span> (<span class="hljs-number">3.3</span>V)
                    â”‚
                    â””â”€ GPIO2 â”€â†’ <span class="hljs-selector-attr">[èˆµæœºä¿¡å·çº¿]</span>
</code></pre>
<h3 data-id="heading-6">âœ¨ ä¼˜åŠ¿ç‰¹ç‚¹</h3>
<ol>
<li><strong>æ— éœ€é¢å¤–å·¥å…·</strong>ï¼šä¸éœ€è¦æ‰“å¼€ XMindã€Draw.io ç­‰å·¥å…·ï¼Œç›´æ¥åœ¨å¯¹è¯ä¸­ç”Ÿæˆ</li>
<li><strong>å¿«é€Ÿç¼–è¾‘</strong>ï¼šå¯ä»¥éšæ—¶ä¿®æ”¹å ä½ç¬¦ï¼ŒAI ä¼šé‡æ–°ç”Ÿæˆ</li>
<li><strong>æ ¼å¼ç»Ÿä¸€</strong>ï¼šä½¿ç”¨æ ‡å‡† ASCII å­—ç¬¦ï¼Œåœ¨ä»»ä½•æ–‡æœ¬ç¼–è¾‘å™¨ä¸­éƒ½èƒ½æ­£å¸¸æ˜¾ç¤º</li>
<li><strong>æ˜“äºå¤åˆ¶</strong>ï¼šç”Ÿæˆçš„å›¾è¡¨å¯ä»¥ç›´æ¥å¤åˆ¶åˆ°æ–‡æ¡£ã€ä»£ç æ³¨é‡Šã€æŠ€æœ¯æ–‡æ¡£ä¸­</li>
<li><strong>çµæ´»æ‰©å±•</strong>ï¼šå¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ ä»»æ„å±‚çº§å’ŒèŠ‚ç‚¹</li>
</ol>
<h3 data-id="heading-7">ğŸ’¡ ä½¿ç”¨æŠ€å·§</h3>
<ol>
<li><strong>å ä½ç¬¦æ›¿æ¢</strong>ï¼šå…ˆä½¿ç”¨å ä½ç¬¦ç”Ÿæˆæ¨¡æ¿ï¼Œå†é€æ­¥æ›¿æ¢ä¸ºå®é™…å†…å®¹</li>
<li><strong>å±‚çº§æ§åˆ¶</strong>ï¼šæ ¹æ®å¤æ‚åº¦è°ƒæ•´å±‚çº§æ·±åº¦ï¼Œå»ºè®®ä¸è¶…è¿‡ 5 å±‚</li>
<li><strong>å¯¹é½æ£€æŸ¥</strong>ï¼šç”Ÿæˆåæ£€æŸ¥ç¼©è¿›æ˜¯å¦å¯¹é½ï¼Œå¯ä»¥è¦æ±‚ AI è°ƒæ•´</li>
<li><strong>æ ·å¼å®šåˆ¶</strong>ï¼šå¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´è¿æ¥ç¬¦æ ·å¼ï¼ˆå¦‚ä½¿ç”¨ä¸åŒçš„ç®­å¤´ï¼‰</li>
</ol>
<h3 data-id="heading-8">ğŸ¤ æ¬¢è¿åˆ†äº«</h3>
<p>å¦‚æœä½ æœ‰æ›´å¥½çš„æç¤ºè¯æˆ–è€…ä½¿ç”¨æŠ€å·§ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ï¼è®©æˆ‘ä»¬ä¸€èµ·æé«˜ AI ç»˜å›¾çš„æ•ˆç‡å’Œè´¨é‡ã€‚</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ç†è§£ Git `git add -p` å‘½ä»¤ä¸­çš„äº¤äº’é€‰é¡¹]]></title>    <link>https://juejin.cn/post/7591770429931290674</link>    <guid>https://juejin.cn/post/7591770429931290674</guid>    <pubDate>2026-01-06T02:40:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591770429931290674" data-draft-id="7591799107486466058" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ç†è§£ Git `git add -p` å‘½ä»¤ä¸­çš„äº¤äº’é€‰é¡¹"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-06T02:40:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜é‡‘è€…é˜¿è±ª"/> <meta itemprop="url" content="https://juejin.cn/user/4073055974333608"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ç†è§£ Git `git add -p` å‘½ä»¤ä¸­çš„äº¤äº’é€‰é¡¹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4073055974333608/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜é‡‘è€…é˜¿è±ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T02:40:55.000Z" title="Tue Jan 06 2026 02:40:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ·±å…¥ç†è§£ Git <code>git add -p</code> å‘½ä»¤ä¸­çš„äº¤äº’é€‰é¡¹</h2>
<p>åœ¨ä½¿ç”¨ Git è¿›è¡Œç‰ˆæœ¬æ§åˆ¶æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šé‡åˆ°éœ€è¦æœ‰é€‰æ‹©æ€§åœ°æäº¤ä»£ç ä¿®æ”¹çš„æƒ…å†µã€‚è¿™ç§éœ€æ±‚å¯èƒ½æºäºæˆ‘ä»¬ä¸å¸Œæœ›å°†æ‰€æœ‰çš„ä¿®æ”¹éƒ½åŒ…å«åœ¨ä¸€æ¬¡æäº¤ä¸­ï¼Œæˆ–è€…å¸Œæœ›å°†ç‰¹å®šçš„ä¿®æ”¹åˆ†æˆå¤šä¸ªæäº¤ï¼Œä»¥ä¾¿æ›´å¥½åœ°è®°å½•å˜æ›´å†å²ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>git add -p</code> å‘½ä»¤æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç» <code>git add -p</code> å‘½ä»¤çš„ä½¿ç”¨æ–¹æ³•ï¼Œç‰¹åˆ«æ˜¯å…¶ä¸­çš„äº¤äº’é€‰é¡¹ <code>[y,n,q,a,d,e,?]</code>ï¼Œå¹¶é€šè¿‡å®é™…æ¡ˆä¾‹è¯´æ˜å…¶åº”ç”¨åœºæ™¯ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€<code>git add -p</code> å‘½ä»¤æ¦‚è¿°</h3>
<p><code>git add -p</code> å‘½ä»¤ç”¨äºäº¤äº’å¼åœ°å°†æ–‡ä»¶çš„éƒ¨åˆ†ä¿®æ”¹ï¼ˆç§°ä¸ºhunkï¼‰æ·»åŠ åˆ°æš‚å­˜åŒºï¼ˆstaging areaï¼‰ã€‚åœ¨è¿è¡Œ <code>git add -p</code> å‘½ä»¤åï¼ŒGit ä¼šé€ä¸ªæ˜¾ç¤ºæ¯ä¸ªæ–‡ä»¶çš„ä¿®æ”¹å—ï¼Œå¹¶æç¤ºç”¨æˆ·é€‰æ‹©æ˜¯å¦å°†è¯¥å—æ·»åŠ åˆ°æš‚å­˜åŒºã€‚è¿™ä¸ªè¿‡ç¨‹å…è®¸å¼€å‘è€…åœ¨æäº¤å‰ç»†ç²’åº¦åœ°æ§åˆ¶å“ªäº›ä¿®æ”¹åº”è¯¥è¢«åŒ…å«åœ¨æäº¤ä¸­ã€‚</p>
<h3 data-id="heading-2">äºŒã€äº¤äº’é€‰é¡¹è§£é‡Š</h3>
<p>å½“ Git æ˜¾ç¤ºä¸€ä¸ªä¿®æ”¹å—æ—¶ï¼Œä¼šæç¤ºç”¨æˆ·é€‰æ‹©æ“ä½œï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">Stage <span class="hljs-keyword">this</span> hunk [y,n,q,a,d,e,?]?
</code></pre>
<p>è¿™äº›é€‰é¡¹åˆ†åˆ«è¡¨ç¤ºä¸åŒçš„æ“ä½œï¼š</p>
<ul>
<li><strong><code>y</code>ï¼ˆyesï¼‰</strong>ï¼šå°†å½“å‰æ˜¾ç¤ºçš„hunkï¼ˆä¿®æ”¹å—ï¼‰æ·»åŠ åˆ°æš‚å­˜åŒºã€‚</li>
<li><strong><code>n</code>ï¼ˆnoï¼‰</strong>ï¼šä¸å°†å½“å‰æ˜¾ç¤ºçš„hunkæ·»åŠ åˆ°æš‚å­˜åŒºï¼Œè·³è¿‡è¿™ä¸ªä¿®æ”¹ã€‚</li>
<li><strong><code>q</code>ï¼ˆquitï¼‰</strong>ï¼šé€€å‡º <code>git add -p</code> å‘½ä»¤ï¼Œæ”¾å¼ƒæœ¬æ¬¡äº¤äº’å¼æ·»åŠ ï¼Œä¸åšä»»ä½•æ›´æ”¹ã€‚</li>
<li><strong><code>a</code>ï¼ˆallï¼‰</strong>ï¼šæ·»åŠ å½“å‰æ–‡ä»¶çš„æ‰€æœ‰ä¿®æ”¹åˆ°æš‚å­˜åŒºï¼ˆstage all hunks for the current fileï¼‰ã€‚</li>
<li><strong><code>d</code>ï¼ˆdiscardï¼‰</strong>ï¼šä¸æ·»åŠ å½“å‰æ–‡ä»¶çš„ä»»ä½•ä¿®æ”¹åˆ°æš‚å­˜åŒºï¼ˆdo not stage any hunks for the current fileï¼‰ã€‚</li>
<li><strong><code>e</code>ï¼ˆeditï¼‰</strong>ï¼šæ‰‹åŠ¨ç¼–è¾‘å½“å‰hunkï¼Œå¯ä»¥è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œå¯¹å½“å‰hunkè¿›è¡Œæ›´ç»†è‡´çš„è°ƒæ•´æˆ–ä¿®æ”¹ã€‚</li>
<li><strong><code>?</code>ï¼ˆhelpï¼‰</strong>ï¼šæ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ï¼Œåˆ—å‡ºä¸Šè¿°é€‰é¡¹çš„å«ä¹‰å’Œä½¿ç”¨æ–¹æ³•ã€‚</li>
</ul>
<h3 data-id="heading-3">ä¸‰ã€å®é™…æ¡ˆä¾‹</h3>
<h4 data-id="heading-4">æ¡ˆä¾‹ä¸€ï¼šé€å—æ·»åŠ ä¿®æ”¹</h4>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–‡ä»¶ <code>example.txt</code>ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹ä¿®æ”¹ï¼š</p>
<pre><code class="hljs language-diff" lang="diff"><span class="hljs-comment">diff --git a/example.txt b/example.txt</span>
<span class="hljs-comment">index e69de29..d95f3ad 100644</span>
<span class="hljs-comment">--- a/example.txt</span>
<span class="hljs-comment">+++ b/example.txt</span>
<span class="hljs-meta">@@ -0,0 +1,4 @@</span>
<span class="hljs-addition">+First line of text</span>
<span class="hljs-addition">+Second line of text</span>
<span class="hljs-addition">+Third line of text</span>
<span class="hljs-addition">+Fourth line of text</span>
</code></pre>
<p>è¿è¡Œ <code>git add -p example.txt</code> åï¼ŒGit ä¼šæ˜¾ç¤ºç¬¬ä¸€ä¸ªä¿®æ”¹å—ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">Stage <span class="hljs-keyword">this</span> hunk [y,n,q,a,d,e,?]?
</code></pre>
<p>åœ¨è¿™ä¸ªæç¤ºä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åšå‡ºå¦‚ä¸‹é€‰æ‹©ï¼š</p>
<ul>
<li>è¾“å…¥ <code>y</code> å¹¶å›è½¦ï¼šå°†è¿™ä¸ªä¿®æ”¹å—æ·»åŠ åˆ°æš‚å­˜åŒºã€‚</li>
<li>è¾“å…¥ <code>n</code> å¹¶å›è½¦ï¼šè·³è¿‡è¿™ä¸ªä¿®æ”¹å—ï¼Œä¸å°†å…¶æ·»åŠ åˆ°æš‚å­˜åŒºã€‚</li>
<li>è¾“å…¥ <code>q</code> å¹¶å›è½¦ï¼šé€€å‡ºäº¤äº’å¼æ·»åŠ è¿‡ç¨‹ï¼Œä¸å¯¹ä»»ä½•æ–‡ä»¶è¿›è¡Œæš‚å­˜ã€‚</li>
<li>è¾“å…¥ <code>a</code> å¹¶å›è½¦ï¼šå°† <code>example.txt</code> æ–‡ä»¶çš„æ‰€æœ‰ä¿®æ”¹å—æ·»åŠ åˆ°æš‚å­˜åŒºã€‚</li>
<li>è¾“å…¥ <code>d</code> å¹¶å›è½¦ï¼šè·³è¿‡ <code>example.txt</code> æ–‡ä»¶çš„æ‰€æœ‰ä¿®æ”¹å—ã€‚</li>
<li>è¾“å…¥ <code>e</code> å¹¶å›è½¦ï¼šè¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œå¯ä»¥æ‰‹åŠ¨è°ƒæ•´å½“å‰çš„ä¿®æ”¹å—ã€‚</li>
<li>è¾“å…¥ <code>?</code> å¹¶å›è½¦ï¼šæ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ï¼Œåˆ—å‡ºæ‰€æœ‰é€‰é¡¹çš„å«ä¹‰ã€‚</li>
</ul>
<h4 data-id="heading-5">æ¡ˆä¾‹äºŒï¼šé€‰æ‹©æ€§æäº¤</h4>
<p>å‡è®¾æˆ‘ä»¬åªå¸Œæœ›å°† <code>example.txt</code> æ–‡ä»¶ä¸­çš„ç¬¬ä¸€è¡Œå’Œç¬¬äºŒè¡Œæ·»åŠ åˆ°æš‚å­˜åŒºï¼Œè€Œä¸æäº¤ç¬¬ä¸‰è¡Œå’Œç¬¬å››è¡Œçš„ä¿®æ”¹ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤å®ç°ï¼š</p>
<ol>
<li>
<p>è¿è¡Œ <code>git add -p example.txt</code>ï¼ŒGit æ˜¾ç¤ºç¬¬ä¸€ä¸ªä¿®æ”¹å—ã€‚</p>
</li>
<li>
<p>è¾“å…¥ <code>e</code> å¹¶å›è½¦ï¼Œè¿›å…¥ç¼–è¾‘æ¨¡å¼ã€‚</p>
</li>
<li>
<p>æ‰‹åŠ¨ç¼–è¾‘hunkï¼Œåªä¿ç•™æˆ‘ä»¬æƒ³æ·»åŠ çš„ä¿®æ”¹ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">First line of text
Second line of text
</code></pre>
</li>
<li>
<p>ä¿å­˜å¹¶é€€å‡ºç¼–è¾‘å™¨ã€‚</p>
</li>
</ol>
<p>æ­¤æ—¶ï¼Œåªæœ‰ç¬¬ä¸€è¡Œå’Œç¬¬äºŒè¡Œä¼šè¢«æ·»åŠ åˆ°æš‚å­˜åŒºï¼Œè€Œç¬¬ä¸‰è¡Œå’Œç¬¬å››è¡Œçš„ä¿®æ”¹å°†ä¸ä¼šåŒ…å«åœ¨æ­¤æ¬¡æäº¤ä¸­ã€‚</p>
<h3 data-id="heading-6">å››ã€äº¤äº’é€‰é¡¹çš„è¯¦ç»†è§£é‡Š</h3>
<h4 data-id="heading-7">1. <code>y</code>ï¼ˆyesï¼‰</h4>
<p>è¾“å…¥ <code>y</code> å¹¶å›è½¦ï¼Œå°†å½“å‰hunkæ·»åŠ åˆ°æš‚å­˜åŒºã€‚è¿™æ˜¯æœ€å¸¸ç”¨çš„é€‰é¡¹ä¹‹ä¸€ï¼Œç”¨äºç¡®è®¤å°†å½“å‰æ˜¾ç¤ºçš„ä¿®æ”¹æ·»åŠ åˆ°ä¸‹æ¬¡æäº¤ä¸­ã€‚</p>
<h4 data-id="heading-8">2. <code>n</code>ï¼ˆnoï¼‰</h4>
<p>è¾“å…¥ <code>n</code> å¹¶å›è½¦ï¼Œè·³è¿‡å½“å‰hunkï¼Œä¸å°†å…¶æ·»åŠ åˆ°æš‚å­˜åŒºã€‚è¿™ä¸ªé€‰é¡¹å…è®¸ç”¨æˆ·é€‰æ‹©æ€§åœ°æš‚å­˜ä¿®æ”¹ï¼Œä¿ç•™æœªæš‚å­˜çš„ä¿®æ”¹ä»¥ä¾¿ä»¥åå¤„ç†ã€‚</p>
<h4 data-id="heading-9">3. <code>q</code>ï¼ˆquitï¼‰</h4>
<p>è¾“å…¥ <code>q</code> å¹¶å›è½¦ï¼Œé€€å‡ºäº¤äº’å¼æ·»åŠ è¿‡ç¨‹ã€‚é€‰æ‹© <code>q</code> ä¸ä¼šæš‚å­˜ä»»ä½•åç»­çš„hunkï¼Œé€‚ç”¨äºå¸Œæœ›ä¸­æ–­å½“å‰æ“ä½œçš„æƒ…å†µã€‚</p>
<h4 data-id="heading-10">4. <code>a</code>ï¼ˆallï¼‰</h4>
<p>è¾“å…¥ <code>a</code> å¹¶å›è½¦ï¼Œå°†å½“å‰æ–‡ä»¶çš„æ‰€æœ‰å‰©ä½™ä¿®æ”¹å—æ·»åŠ åˆ°æš‚å­˜åŒºã€‚è¿™ä¸ªé€‰é¡¹é€‚ç”¨äºç¡®å®šè¦å°†æ•´ä¸ªæ–‡ä»¶çš„ä¿®æ”¹å…¨éƒ¨æäº¤çš„æƒ…å†µã€‚</p>
<h4 data-id="heading-11">5. <code>d</code>ï¼ˆdiscardï¼‰</h4>
<p>è¾“å…¥ <code>d</code> å¹¶å›è½¦ï¼Œä¸å°†å½“å‰æ–‡ä»¶çš„ä»»ä½•ä¿®æ”¹å—æ·»åŠ åˆ°æš‚å­˜åŒºã€‚è¿™ä¸ªé€‰é¡¹ç”¨äºè·³è¿‡æ•´ä¸ªæ–‡ä»¶çš„æ‰€æœ‰ä¿®æ”¹ï¼Œé€‚ç”¨äºå¸Œæœ›ç¨åå†å¤„ç†è¯¥æ–‡ä»¶çš„æƒ…å†µã€‚</p>
<h4 data-id="heading-12">6. <code>e</code>ï¼ˆeditï¼‰</h4>
<p>è¾“å…¥ <code>e</code> å¹¶å›è½¦ï¼Œè¿›å…¥ç¼–è¾‘æ¨¡å¼ã€‚ç”¨æˆ·å¯ä»¥æ‰‹åŠ¨ç¼–è¾‘å½“å‰çš„hunkï¼Œé€‰æ‹©æ€§åœ°æ·»åŠ éƒ¨åˆ†ä¿®æ”¹ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„é€‰é¡¹ï¼Œå…è®¸ç²¾ç»†æ§åˆ¶å“ªäº›ä¿®æ”¹è¢«æš‚å­˜ã€‚</p>
<h4 data-id="heading-13">7. <code>?</code>ï¼ˆhelpï¼‰</h4>
<p>è¾“å…¥ <code>?</code> å¹¶å›è½¦ï¼Œæ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ï¼Œåˆ—å‡ºæ‰€æœ‰äº¤äº’é€‰é¡¹çš„å«ä¹‰å’Œç”¨æ³•ã€‚è¿™æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„é€‰é¡¹ï¼Œç‰¹åˆ«æ˜¯åœ¨ä¸ç¡®å®šæŸä¸ªé€‰é¡¹çš„ä½œç”¨æ—¶ã€‚</p>
<h3 data-id="heading-14">äº”ã€åº”ç”¨åœºæ™¯</h3>
<h4 data-id="heading-15">1. ä»£ç å®¡æŸ¥å’Œæäº¤è§„èŒƒ</h4>
<p>åœ¨å›¢é˜Ÿåˆä½œä¸­ï¼Œè‰¯å¥½çš„æäº¤è§„èŒƒæœ‰åŠ©äºä»£ç å®¡æŸ¥å’Œç‰ˆæœ¬ç®¡ç†ã€‚é€šè¿‡ <code>git add -p</code> å‘½ä»¤ï¼Œå¼€å‘è€…å¯ä»¥å°†åŠŸèƒ½å®Œæ•´ã€é€»è¾‘æ¸…æ™°çš„ä¿®æ”¹å—åˆ†åˆ«æäº¤ï¼Œé¿å…å°†æ— å…³æˆ–ä¸´æ—¶ä¿®æ”¹åŒ…å«åœ¨ä¸€æ¬¡æäº¤ä¸­ã€‚</p>
<h4 data-id="heading-16">2. é”™è¯¯ä¿®å¤å’ŒåŠŸèƒ½æ·»åŠ </h4>
<p>åœ¨ä¿®å¤é”™è¯¯å’Œæ·»åŠ æ–°åŠŸèƒ½æ—¶ï¼Œå¸¸å¸¸ä¼šåŒæ—¶ä¿®æ”¹å¤šä¸ªæ–‡ä»¶ã€‚ä½¿ç”¨ <code>git add -p</code> å¯ä»¥ç¡®ä¿å°†é”™è¯¯ä¿®å¤å’ŒåŠŸèƒ½æ·»åŠ åˆ†åˆ«æäº¤ï¼Œä¿æŒæäº¤å†å²çš„æ¸…æ™°å’Œå¯è¿½æº¯æ€§ã€‚</p>
<h4 data-id="heading-17">3. åˆ†é˜¶æ®µæäº¤</h4>
<p>æœ‰æ—¶ï¼Œæˆ‘ä»¬åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¯èƒ½éœ€è¦å¯¹åŒä¸€ä¸ªæ–‡ä»¶è¿›è¡Œå¤šæ¬¡ä¿®æ”¹ï¼Œä½†å¸Œæœ›åˆ†é˜¶æ®µæäº¤è¿™äº›ä¿®æ”¹ã€‚<code>git add -p</code> å…è®¸æˆ‘ä»¬é€‰æ‹©æ€§åœ°æš‚å­˜ä¿®æ”¹å—ï¼Œå®ç°åˆ†é˜¶æ®µæäº¤ã€‚</p>
<h3 data-id="heading-18">å…­ã€æ€»ç»“</h3>
<p><code>git add -p</code> å‘½ä»¤æ˜¯ Git ä¸­ä¸€ä¸ªéå¸¸å¼ºå¤§çš„å·¥å…·ï¼Œèƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…ç²¾ç»†æ§åˆ¶å“ªäº›ä¿®æ”¹è¢«åŒ…å«åœ¨æäº¤ä¸­ã€‚é€šè¿‡äº¤äº’å¼çš„æ–¹å¼ï¼Œå¼€å‘è€…å¯ä»¥é€å—é€‰æ‹©æ€§åœ°æ·»åŠ ä¿®æ”¹ï¼Œé¿å…å°†ä¸ç›¸å…³æˆ–æœªå®Œæˆçš„ä¿®æ”¹åŒ…å«åœ¨æäº¤ä¸­ã€‚æœ¬æ–‡è¯¦ç»†ä»‹ç»äº† <code>git add -p</code> å‘½ä»¤çš„äº¤äº’é€‰é¡¹ <code>[y,n,q,a,d,e,?]</code> çš„å«ä¹‰å’Œä½¿ç”¨æ–¹æ³•ï¼Œå¹¶é€šè¿‡å®é™…æ¡ˆä¾‹è¯´æ˜å…¶åº”ç”¨åœºæ™¯ã€‚</p>
<p>å¸Œæœ›é€šè¿‡æœ¬æ–‡çš„ä»‹ç»ï¼Œæ‚¨èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨ <code>git add -p</code> å‘½ä»¤ï¼Œä»è€Œæå‡ç‰ˆæœ¬æ§åˆ¶çš„æ•ˆç‡å’Œè§„èŒƒæ€§ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•ç–‘é—®æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€è®¨è®ºã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”±æµ…å…¥æ·±å…¨é¢è§£æThreadLocal]]></title>    <link>https://juejin.cn/post/7591770429931339826</link>    <guid>https://juejin.cn/post/7591770429931339826</guid>    <pubDate>2026-01-06T02:41:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591770429931339826" data-draft-id="7591800417254998025" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”±æµ…å…¥æ·±å…¨é¢è§£æThreadLocal"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-06T02:41:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜é‡‘è€…é˜¿è±ª"/> <meta itemprop="url" content="https://juejin.cn/user/4073055974333608"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”±æµ…å…¥æ·±å…¨é¢è§£æThreadLocal
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4073055974333608/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜é‡‘è€…é˜¿è±ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T02:41:51.000Z" title="Tue Jan 06 2026 02:41:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç”±æµ…å…¥æ·±å…¨é¢è§£æThreadLocal</h2>
<p>@<a href="https://link.juejin.cn?target=%25E7%259B%25AE%25E5%25BD%2595" target="_blank" title="%E7%9B%AE%E5%BD%95" ref="nofollow noopener noreferrer">TOC</a></p>
<h3 data-id="heading-1">ç®€ä»‹</h3>
<ol>
<li>çº¿ç¨‹å¹¶å‘ï¼šåœ¨å¤šçº¿ç¨‹å¹¶å‘çš„åœºæ™¯ä¸‹ä½¿ç”¨</li>
<li>ä¼ é€’æ•°æ®ï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡ThreadLocalåœ¨åŒä¸€çº¿ç¨‹ï¼Œä¸åŒç»„ä»¶ä¸­ä¼ é€’å…¬å…±å˜é‡</li>
<li>çº¿ç¨‹éš”ç¦»ï¼šæ¯ä¸ªçº¿ç¨‹çš„å˜é‡éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œä¸ä¼šç›¸äº’å½±å“</li>
</ol>
<h3 data-id="heading-2">åŸºæœ¬ä½¿ç”¨</h3>
<ol>
<li>
<p>å¸¸ç”¨æ–¹æ³•
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7b62c9b11b1495f8ff3e87eca54dd7b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5o6Y6YeR6ICF6Zi_6LGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768272111&amp;x-signature=2JKieFUsgkIILRqrVSD4rjJQtlo%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
</li>
<li>
<p>ä»£ç æ¡ˆä¾‹å®ç°
(1) ä¸ä½¿ç”¨ThreadLocalæ—¶æ¨¡æ‹Ÿå¤šçº¿ç¨‹å­˜å–æ•°æ®</p>
</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadLocalDemo1</span> {
    <span class="hljs-keyword">private</span> String content;

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getContent</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> content;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setContent</span><span class="hljs-params">(String content)</span> {
        <span class="hljs-built_in">this</span>.content = content;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">ThreadLocalDemo1</span> <span class="hljs-variable">threadLocalDemo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocalDemo1</span>();

        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
            <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() {
                <span class="hljs-meta">@Override</span>
                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
                    <span class="hljs-comment">/**
                     * æ¯ä¸€ä¸ªçº¿ç¨‹å­˜ä¸€ä¸ªå˜é‡ï¼Œè¿‡ä¸€ä¼šå–å‡ºè¿™ä¸ªå˜é‡
                     */</span>
                    threadLocalDemo.setContent(Thread.currentThread().getName() + <span class="hljs-string">"çš„æ•°æ®"</span>);
                    System.out.println(<span class="hljs-string">"------------------------"</span>);
                    System.out.println(Thread.currentThread().getName() + <span class="hljs-string">"-----&gt;"</span> + threadLocalDemo.getContent());
                }
            });
            thread.setName(<span class="hljs-string">"çº¿ç¨‹"</span> + i);
            thread.start();
        }
    }
}
</code></pre>
<p>ç»“æœï¼š</p>
<pre><code class="hljs language-java" lang="java">------------------------
çº¿ç¨‹<span class="hljs-number">0</span>-----&gt;çº¿ç¨‹<span class="hljs-number">4</span>çš„æ•°æ®
------------------------
çº¿ç¨‹<span class="hljs-number">4</span>-----&gt;çº¿ç¨‹<span class="hljs-number">4</span>çš„æ•°æ®
------------------------
çº¿ç¨‹<span class="hljs-number">2</span>-----&gt;çº¿ç¨‹<span class="hljs-number">4</span>çš„æ•°æ®
------------------------
çº¿ç¨‹<span class="hljs-number">3</span>-----&gt;çº¿ç¨‹<span class="hljs-number">4</span>çš„æ•°æ®
------------------------
çº¿ç¨‹<span class="hljs-number">1</span>-----&gt;çº¿ç¨‹<span class="hljs-number">4</span>çš„æ•°æ®
</code></pre>
<p>ï¼ˆ2ï¼‰ ä½¿ç”¨ThreadLocalå¯¹å¤šçº¿ç¨‹è¿›è¡Œæ•°æ®éš”ç¦»ï¼ŒæŠŠæ•°æ®ç»‘å®šåˆ°ThreadLocal
ï¼ˆä¼ ç»Ÿè§£å†³æ–¹æ¡ˆé¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯åŠ é”ï¼Œç¡®å®å¯ä»¥å®ç°ï¼Œä½†æ˜¯å´ç‰ºç‰²äº†æ•ˆç‡ï¼Œéœ€è¦ç­‰å¾…ä¸Šä¸€ä¸ªçº¿ç¨‹ä¹‹è¡Œç»“æŸæ‰å¯ä»¥å¾€ä¸‹ä¹‹è¡Œï¼‰</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadLocalDemo2</span> {
    ThreadLocal&lt;String&gt; threadLocal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();

    <span class="hljs-keyword">private</span> String content;

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getContent</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> threadLocal.get();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setContent</span><span class="hljs-params">(String content)</span> {
        threadLocal.set(content);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">ThreadLocalDemo2</span> <span class="hljs-variable">threadLocalDemo2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocalDemo2</span>();

        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
            <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() {
                <span class="hljs-meta">@Override</span>
                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
                    <span class="hljs-comment">/**
                     * æ¯ä¸€ä¸ªçº¿ç¨‹å­˜ä¸€ä¸ªå˜é‡ï¼Œè¿‡ä¸€ä¼šå–å‡ºè¿™ä¸ªå˜é‡
                     */</span>
                    threadLocalDemo2.setContent(Thread.currentThread().getName()+<span class="hljs-string">"çš„æ•°æ®"</span>);
                    System.out.println(<span class="hljs-string">"------------------------"</span>);
                    System.out.println(Thread.currentThread().getName() + <span class="hljs-string">"-----&gt;"</span> + threadLocalDemo2.getContent());
                }
            });
            thread.setName(<span class="hljs-string">"çº¿ç¨‹"</span> + i);
            thread.start();
        }
    }
}
</code></pre>
<p>ç»“æœï¼š</p>
<pre><code class="hljs language-java" lang="java">------------------------
------------------------
------------------------
çº¿ç¨‹<span class="hljs-number">3</span>-----&gt;çº¿ç¨‹<span class="hljs-number">3</span>çš„æ•°æ®
------------------------
çº¿ç¨‹<span class="hljs-number">2</span>-----&gt;çº¿ç¨‹<span class="hljs-number">2</span>çš„æ•°æ®
çº¿ç¨‹<span class="hljs-number">1</span>-----&gt;çº¿ç¨‹<span class="hljs-number">1</span>çš„æ•°æ®
çº¿ç¨‹<span class="hljs-number">0</span>-----&gt;çº¿ç¨‹<span class="hljs-number">0</span>çš„æ•°æ®
------------------------
çº¿ç¨‹<span class="hljs-number">4</span>-----&gt;çº¿ç¨‹<span class="hljs-number">4</span>çš„æ•°æ®
</code></pre>
<h3 data-id="heading-3">ThreadLocalä¸synchronizedçš„åŒºåˆ«</h3>
<p>äºŒè€…éƒ½æ˜¯ç”¨æ¥å¤„ç†å¤šçº¿ç¨‹å¹¶å‘è®¿é—®çš„é—®é¢˜ï¼Œä½†æ˜¯äºŒè€…çš„åŸç†å’Œä¾§é‡ç‚¹ä¸ä¸€æ ·ï¼Œç®€è¦è¯´å°±æ˜¯ï¼ŒThreadLocalç‰ºç‰²äº†ç©ºé—´ï¼Œè€Œsynchronizedæ˜¯ç‰ºç‰²äº†æ—¶é—´æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼ˆéš”ç¦»ï¼‰ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d37392525ef49dba9785f15ab746346~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5o6Y6YeR6ICF6Zi_6LGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768272111&amp;x-signature=6HO6ygutpvUzL%2BKmca%2FZmDoqdEI%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
æ€»ç»“ï¼šåœ¨ä¸Šè¿°çš„æ¡ˆä¾‹å½“ä¸­ï¼Œä½¿ç”¨ThreadLocalæ›´ä¸ºåˆç†ï¼Œè¿™æ ·ä¿è¯äº†ç¨‹åºæ‹¥æœ‰äº†æ›´é«˜çš„å¹¶å‘æ€§ã€‚</p>
<h3 data-id="heading-4">ThreadLocalç°åœ¨çš„è®¾è®¡ï¼ˆJDK1.8ï¼‰</h3>
<ol>
<li>ç®€ä»‹
æ¯ä¸€ä¸ªThreadç»´æŠ¤ä¸€ä¸ªThreadLocalMapï¼Œè¿™ä¸ªMapçš„keyä¸ºThreadLocalå®ä¾‹æœ¬èº«ï¼Œè€Œvalueåˆ™ä¸ºå®é™…å­˜å‚¨çš„å€¼ã€‚</li>
<li>å…·ä½“è¿‡ç¨‹
ï¼ˆ1ï¼‰æ¯ä¸€ä¸ªThreadå†…éƒ¨éƒ½æœ‰ä¸€ä¸ªMapï¼ˆThreadLocalMapï¼‰
ï¼ˆ2ï¼‰Mapé‡Œé¢å­˜å‚¨çš„ThreadLocalå¯¹è±¡ï¼ˆkeyï¼‰å’Œçº¿ç¨‹çš„å˜é‡å‰¯æœ¬ï¼ˆvalueï¼‰
ï¼ˆ3ï¼‰Threadçš„Mapæ˜¯ç”±ThreadLocalæ¥ç»´æŠ¤çš„ï¼Œç”±ThreadLocalè´Ÿè´£å‘Mapè·å–å’Œè®¾ç½®çº¿ç¨‹çš„å˜é‡å€¼ã€‚
ï¼ˆ4ï¼‰å¯¹äºçº¿ç¨‹è·å–å€¼ï¼Œæ¯ä¸€ä¸ªå‰¯æœ¬åªèƒ½è·å–å½“å‰çº¿ç¨‹æœ¬åœ°çš„å‰¯æœ¬å€¼ï¼Œåˆ«çš„çº¿ç¨‹æ— æ³•è®¿é—®åˆ°ï¼Œäº’ä¸å¹²æ‰°ï¼Œå®ç°äº†çº¿ç¨‹éš”ç¦»ã€‚</li>
<li>å¯¹æ¯”ä¸1.8ä¹‹å‰çš„è®¾è®¡ï¼ˆç›¸å½“äºThreadä¸ThreadLocalçš„è§’è‰²äº’æ¢äº†ï¼‰
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee58abbba4d6481a82ae9b4dc2e6b133~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5o6Y6YeR6ICF6Zi_6LGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768272111&amp;x-signature=hmiGeSxr%2BBAjeJwzdBxL4MVeY4I%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></li>
<li>1.8è®¾è®¡çš„å¥½å¤„
ï¼ˆ1ï¼‰æ¯ä¸ªMapå­˜å‚¨çš„Entryæ•°é‡å˜å°‘äº†ï¼ˆå› ä¸ºå®é™…çŠ¶å†µä¸‹Threadæ¯”ThreadLocalå¤šï¼‰
ï¼ˆ2ï¼‰å½“Threadé”€æ¯æ—¶ï¼ŒThreadLocalMapä¹Ÿä¼šéšä¹‹é”€æ¯ï¼Œé¿å…å†…å­˜çš„æµªè´¹</li>
</ol>
<h3 data-id="heading-5">ThreadLocalæ ¸å¿ƒæ–¹æ³•æºç åˆ†æ</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/16ffad45a77847ff852cd82b9da9e5b0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5o6Y6YeR6ICF6Zi_6LGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768272111&amp;x-signature=WxpReHgNWrEL9%2BS9N1oqKe8eFqw%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<ol>
<li>getæ–¹æ³•æºç </li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> T <span class="hljs-title function_">get</span><span class="hljs-params">()</span> {
		<span class="hljs-comment">// è·å–å½“å‰çº¿ç¨‹</span>
        <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> Thread.currentThread();
        <span class="hljs-comment">// è·å–ThreadLocalMap</span>
        <span class="hljs-type">ThreadLocalMap</span> <span class="hljs-variable">map</span> <span class="hljs-operator">=</span> getMap(t);
        <span class="hljs-comment">// mapä¸ä¸ºç©ºæ—¶ï¼Œè·å–é‡Œé¢çš„Entry</span>
        <span class="hljs-keyword">if</span> (map != <span class="hljs-literal">null</span>) {
            ThreadLocalMap.<span class="hljs-type">Entry</span> <span class="hljs-variable">e</span> <span class="hljs-operator">=</span> map.getEntry(<span class="hljs-built_in">this</span>);
            <span class="hljs-keyword">if</span> (e != <span class="hljs-literal">null</span>) {
                <span class="hljs-meta">@SuppressWarnings("unchecked")</span>
                <span class="hljs-type">T</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> (T)e.value;
                <span class="hljs-comment">// è¿”å›ç»“æœ</span>
                <span class="hljs-keyword">return</span> result;
            }
        }
        <span class="hljs-comment">// æ²¡æœ‰åˆ™èµ‹å€¼åˆå§‹å€¼nullå¹¶è¿”å›</span>
        <span class="hljs-keyword">return</span> setInitialValue();
    }
</code></pre>
<ol start="2">
<li>setæ–¹æ³•æºç </li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">set</span><span class="hljs-params">(T value)</span> {
		<span class="hljs-comment">// è·å–å½“å‰çº¿ç¨‹</span>
        <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> Thread.currentThread();
        <span class="hljs-comment">// è·å–ThreadLocalMap</span>
        <span class="hljs-type">ThreadLocalMap</span> <span class="hljs-variable">map</span> <span class="hljs-operator">=</span> getMap(t);
        <span class="hljs-keyword">if</span> (map != <span class="hljs-literal">null</span>) {
        	<span class="hljs-comment">// ä¸ä¸ºç©ºç›´æ¥set</span>
            map.set(<span class="hljs-built_in">this</span>, value);
        } <span class="hljs-keyword">else</span> {
        	<span class="hljs-comment">// mapä¸ºç©ºåˆ™åˆ›å»ºå¹¶set</span>
            createMap(t, value);
        }
    }
</code></pre>
<ol start="3">
<li>initialValueæ–¹æ³•è¿”å›åˆå§‹å€¼ï¼ˆprotectedä¿®é¥°ä¸ºäº†è®©å­ç±»è¦†ç›–è®¾è®¡çš„ï¼‰éœ€è¦è‡ªå®šä¹‰åˆå§‹å€¼å¯ä»¥é‡å†™è¯¥æ–¹æ³•</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> T <span class="hljs-title function_">initialValue</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
</code></pre>
<ol start="4">
<li>removeæ–¹æ³•</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">remove</span><span class="hljs-params">()</span> {
		 <span class="hljs-comment">// è·å–å½“å‰çº¿ç¨‹çš„ThreadLocalMap</span>
         <span class="hljs-type">ThreadLocalMap</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> getMap(Thread.currentThread());
         <span class="hljs-keyword">if</span> (m != <span class="hljs-literal">null</span>) {
         	<span class="hljs-comment">// ç§»é™¤ThreadLocalMap</span>
             m.remove(<span class="hljs-built_in">this</span>);
         }
     }
</code></pre>
<ol start="5">
<li>setInitialValueæ–¹æ³•</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> T <span class="hljs-title function_">setInitialValue</span><span class="hljs-params">()</span> {
		<span class="hljs-comment">// å¾—åˆ°åˆå§‹åŒ–å€¼null</span>
        <span class="hljs-type">T</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> initialValue();
        <span class="hljs-comment">// è·å–å½“å‰çº¿ç¨‹</span>
        <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> Thread.currentThread();
        <span class="hljs-comment">// è·å–çº¿ç¨‹ä¸­ThreadLocalMap</span>
        <span class="hljs-type">ThreadLocalMap</span> <span class="hljs-variable">map</span> <span class="hljs-operator">=</span> getMap(t);
        <span class="hljs-comment">// mapå­˜åœ¨çš„è¯æŠŠnullè®¾ç½®è¿›å»ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»ºä¸€ä¸ªå¹¶å°†nullè®¾ç½®è¿›å»</span>
        <span class="hljs-keyword">if</span> (map != <span class="hljs-literal">null</span>) {
            map.set(<span class="hljs-built_in">this</span>, value);
        } <span class="hljs-keyword">else</span> {
            createMap(t, value);
        }
        <span class="hljs-comment">// å¦‚æœå½“å‰ThreadLocalå±äºTerminatingThreadLocalï¼ˆå…³é—­çš„ThreadLocalï¼‰åˆ™registerï¼ˆæ³¨å†Œï¼‰åˆ°TerminatingThreadLocal</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span> <span class="hljs-keyword">instanceof</span> TerminatingThreadLocal) {
            TerminatingThreadLocal.register((TerminatingThreadLocal&lt;?&gt;) <span class="hljs-built_in">this</span>);
        }
        <span class="hljs-keyword">return</span> value;
    }
</code></pre>
<h3 data-id="heading-6">ThreadLocalMapæºç åˆ†æ</h3>
<ol>
<li>ç®€ä»‹
ThreadLocalMapæ˜¯ThreadLocalçš„å†…éƒ¨ç±»ï¼Œæ²¡æœ‰å®ç°Mapæ¥å£ï¼Œæ˜¯ç‹¬è‡ªè®¾è®¡å®ç°MapåŠŸèƒ½ï¼Œå†…éƒ¨çš„Entryä¹Ÿæ˜¯ç‹¬ç«‹çš„ã€‚</li>
<li>ç»“æ„å›¾è§£
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d16907aa70f24eafb773a976661dabd4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5o6Y6YeR6ICF6Zi_6LGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768272111&amp;x-signature=Uz%2BYtJDUBrji90vew0IkRMK%2FFMo%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></li>
<li>æˆå‘˜å˜é‡</li>
</ol>
<pre><code class="hljs language-java" lang="java">		<span class="hljs-comment">// Entryç±»ï¼Œç»§æ‰¿å¼±åº”ç”¨ï¼Œä¸ºäº†å’ŒThreadçš„ç”Ÿå‘½å‘¨æœŸè§£ç»‘</span>
		<span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Entry</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">WeakReference</span>&lt;ThreadLocal&lt;?&gt;&gt; {
            <span class="hljs-comment">/** The value associated with this ThreadLocal. */</span>
            Object value;

            Entry(ThreadLocal&lt;?&gt; k, Object v) {
                <span class="hljs-built_in">super</span>(k);
                value = v;
            }
        }

        <span class="hljs-comment">/**
         * The initial capacity -- MUST be a power of two.
         * åˆå§‹å®¹é‡ï¼Œå¿…é¡»æ˜¯äºŒçš„å¹‚
         */</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">INITIAL_CAPACITY</span> <span class="hljs-operator">=</span> <span class="hljs-number">16</span>;

        <span class="hljs-comment">/**
         * The table, resized as necessary.
         * table.length MUST always be a power of two.
         * æ ¹æ®éœ€è¦è°ƒæ•´å¤§å°ã€‚é•¿åº¦å¿…é¡»æ˜¯2çš„å¹‚ã€‚
         */</span>
        <span class="hljs-keyword">private</span> Entry[] table;

        <span class="hljs-comment">/**
         * The number of entries in the table.
         * tableä¸­çš„entrieæ•°é‡
         */</span>
        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;

        <span class="hljs-comment">/**
         * The next size value at which to resize.
         * è¦è°ƒæ•´å¤§å°çš„ä¸‹ä¸€ä¸ªå¤§å°å€¼
         */</span>
        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> threshold; <span class="hljs-comment">// Default to 0</span>

        <span class="hljs-comment">/**
         * Set the resize threshold to maintain at worst a 2/3 load factor.
         * è®¾ç½®è°ƒæ•´å¤§å°é˜ˆå€¼ä»¥ç»´æŒæœ€åçš„2/3è´Ÿè½½å› å­
         */</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setThreshold</span><span class="hljs-params">(<span class="hljs-type">int</span> len)</span> {
            threshold = len * <span class="hljs-number">2</span> / <span class="hljs-number">3</span>;
        }

        <span class="hljs-comment">/**
         * Increment i modulo len.
         * å¢é‡ä¸€
         */</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">nextIndex</span><span class="hljs-params">(<span class="hljs-type">int</span> i, <span class="hljs-type">int</span> len)</span> {
            <span class="hljs-keyword">return</span> ((i + <span class="hljs-number">1</span> &lt; len) ? i + <span class="hljs-number">1</span> : <span class="hljs-number">0</span>);
        }

        <span class="hljs-comment">/**
         * Decrement i modulo len.
         * å‡é‡ä¸€
         */</span>
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">prevIndex</span><span class="hljs-params">(<span class="hljs-type">int</span> i, <span class="hljs-type">int</span> len)</span> {
            <span class="hljs-keyword">return</span> ((i - <span class="hljs-number">1</span> &gt;= <span class="hljs-number">0</span>) ? i - <span class="hljs-number">1</span> : len - <span class="hljs-number">1</span>);
        }
</code></pre>
<h3 data-id="heading-7">å¼±å¼•ç”¨ä¸å†…å­˜æ³„éœ²ï¼ˆå†…å­˜æ³„æ¼å’Œå¼±å¼•ç”¨æ²¡æœ‰ç›´æ¥å…³ç³»ï¼‰</h3>
<ol>
<li>å†…å­˜æ³„æ¼/æº¢å‡ºæ¦‚å¿µ
ï¼ˆ1ï¼‰Memory overflowï¼šå†…å­˜æº¢å‡ºï¼Œæ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´æä¾›ç»™ç”³è¯·è€…ä½¿ç”¨
ï¼ˆ2ï¼‰Memory leakï¼šå†…å­˜æ³„æ¼ï¼Œç³»ç»Ÿä¸­å·²åŠ¨æ€åˆ†é…çš„å †å†…å­˜ç”±äºæŸç§åŸå› æ— æ³•é‡Šæ”¾æˆ–è€…æ²¡æœ‰é‡Šæ”¾ï¼Œå¯¼è‡´ç³»ç»Ÿå†…å­˜å †ç§¯ï¼Œå½±å“ç³»ç»Ÿè¿è¡Œï¼Œç”šè‡³å¯¼è‡´ç³»ç»Ÿå´©æºƒã€‚å†…å­˜æ³„æ¼ç»ˆå°†å¯¼è‡´å†…å­˜æº¢å‡ºã€‚</li>
<li>å¼º/å¼±å¼•ç”¨æ¦‚å¿µ
ï¼ˆ1ï¼‰Strong Referceï¼šå¼ºå¼•ç”¨ï¼Œæˆ‘ä»¬å¸¸è§çš„å¯¹è±¡å¼•ç”¨ï¼Œåªè¦æœ‰ä¸€ä¸ªå¼ºå¼•ç”¨æŒ‡å‘å¯¹è±¡ï¼Œä¹Ÿå°±è¡¨æ˜è¿˜â€œæ´»ç€â€ï¼Œè¿™ç§çŠ¶å†µä¸‹åƒåœ¾å›æ”¶æœºåˆ¶ï¼ˆGCï¼‰æ˜¯ä¸ä¼šå›æ”¶çš„ã€‚
ï¼ˆ2ï¼‰Weak Referceï¼šå¼±å¼•ç”¨ï¼Œç»§æ‰¿äº†WeakReferceçš„å¯¹è±¡ï¼Œåƒåœ¾å›æ”¶å™¨å‘ç°äº†åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ï¼Œä¸ç®¡å½“å‰ç³»ç»Ÿçš„å†…å­˜æ˜¯å¦å……è¶³ï¼Œéƒ½ä¼šå›æ”¶ä»–çš„å†…å­˜ã€‚</li>
<li>å¦‚æœkeyï¼Œå³Entryä½¿ç”¨å¼ºå¼•ç”¨ï¼Œä¹Ÿæ— æ³•é¿å…å†…å­˜æ³„æ¼
å› ä¸ºEntryæ˜¯åœ¨Threadå½“å‰çº¿ç¨‹ä¸­ï¼Œç”Ÿå‘½å‘¨æœŸå’ŒThreadä¸€æ ·ï¼Œæ²¡æœ‰æ‰‹åŠ¨åˆ é™¤Entryæ—¶Entryå°±ä¼šå†…å­˜æ³„æ¼ã€‚</li>
<li>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>åªè¦åœ¨è°ƒç”¨å®ŒThreadLocalååŠæ—¶ä½¿ç”¨removeæ–¹æ³•ï¼Œæ‰èƒ½é¿å…å†…å­˜æ³„æ¼</strong>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/42193776949a47409dc7cdb92e899735~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5o6Y6YeR6ICF6Zi_6LGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768272111&amp;x-signature=9scZWgbu8re9Lja5Ys%2FtPQjYYe4%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1ecedcf226df46698d6e595c02cafb80~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5o6Y6YeR6ICF6Zi_6LGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768272111&amp;x-signature=mEy403lTwhzaTSZYNDJTeo8WSSM%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></li>
</ol>
<h3 data-id="heading-8">ThreadLocalæ ¸å¿ƒæºç ï¼ˆHashå†²çªè§£å†³ï¼‰</h3>
<ol>
<li>ä»æ„é€ æ–¹æ³•å…¥æ‰‹</li>
</ol>
<pre><code class="hljs language-java" lang="java">
		ThreadLocalMap(ThreadLocal&lt;?&gt; firstKey, Object firstValue) {
			<span class="hljs-comment">// åˆå§‹åŒ–table</span>
            table = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Entry</span>[INITIAL_CAPACITY];
            <span class="hljs-comment">// è®¡ç®—ç´¢å¼•åœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼ˆæ ¸å¿ƒä»£ç ï¼‰</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> firstKey.threadLocalHashCode &amp; (INITIAL_CAPACITY - <span class="hljs-number">1</span>);
            <span class="hljs-comment">// è®¾ç½®å€¼</span>
            table[i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Entry</span>(firstKey, firstValue);
            size = <span class="hljs-number">1</span>;
            <span class="hljs-comment">// è®¾ç½®é˜ˆå€¼ï¼ˆINITIAL_CAPACITYçš„ä¸‰åˆ†ä¹‹äºŒï¼‰</span>
            setThreshold(INITIAL_CAPACITY);
        }
</code></pre>
<ol start="2">
<li>é‡ç‚¹åˆ†æint i = firstKey.threadLocalHashCode &amp; (INITIAL_CAPACITY - 1);</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">threadLocalHashCode</span> <span class="hljs-operator">=</span> nextHashCode();

<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">nextHashCode</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> nextHashCode.getAndAdd(HASH_INCREMENT);
    }
    
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">nextHashCode</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>();

<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">HASH_INCREMENT</span> <span class="hljs-operator">=</span> <span class="hljs-number">0x61c88647</span>;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAndAdd</span><span class="hljs-params">(<span class="hljs-type">int</span> delta)</span> {
        <span class="hljs-keyword">return</span> unsafe.getAndAddInt(<span class="hljs-built_in">this</span>, valueOffset, delta);
    }
</code></pre>
<p>ï¼ˆ1ï¼‰è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªAtomicIntegerï¼Œæ¯æ¬¡è·å–å¹¶åŠ ä¸ŠHASH_INCREMENTï¼ˆ0x61c88647ï¼Œè¿™ä¸ªå€¼ä¸æ–æ³¢é‚£å¥‘æ•°ï¼ˆé»„é‡‘åˆ†å‰²ï¼‰æœ‰å…³ï¼‰ï¼Œæ˜¯ä¸ºäº†è®©å“ˆå¸Œç èƒ½å¤Ÿå‡åŒ€çš„åˆ†å¸ƒåœ¨2çš„næ¬¡æ–¹çš„æ•°ç»„ï¼ˆEntry[]ï¼‰é‡Œé¢ï¼Œä¹Ÿå°±å°½å¯èƒ½é¿å…äº†å“ˆå¸Œå†²çªã€‚
ï¼ˆ2ï¼‰hashcode &amp; (INITIAL_CAPACITY - 1)  ç›¸å½“äºhashcode % (INITIAL_CAPACITY - 1)  çš„é«˜æ•ˆå†™æ³•ï¼Œæ‰€ä»¥sizeå¿…é¡»ä¸º2çš„æ¬¡å¹‚ï¼Œè¿™æ ·æœ€å¤§ç¨‹åº¦é¿å…äº†å“ˆå¸Œå†²çªã€‚</p>
<ol start="3">
<li>setæ–¹æ³•æºç åˆ†æ</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">set</span><span class="hljs-params">(ThreadLocal&lt;?&gt; key, Object value)</span> {
    		
            Entry[] tab = table;
            <span class="hljs-type">int</span> <span class="hljs-variable">len</span> <span class="hljs-operator">=</span> tab.length;
            <span class="hljs-comment">// è®¡ç®—ç´¢å¼•</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> key.threadLocalHashCode &amp; (len-<span class="hljs-number">1</span>);
            <span class="hljs-comment">/**
            *
            * ä½¿ç”¨çº¿æ€§æ¢æµ‹æ³•æŸ¥æ‰¾å…ƒç´ 
            * */</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-type">Entry</span> <span class="hljs-variable">e</span> <span class="hljs-operator">=</span> tab[i];
                 e != <span class="hljs-literal">null</span>;
                 <span class="hljs-comment">// ä½¿ç”¨çº¿æ€§æ¢æµ‹æ³•æŸ¥æ‰¾å…ƒç´ </span>
                 e = tab[i = nextIndex(i, len)]) {
                 <span class="hljs-comment">// è·å–åˆ°è¯¥Entryå¯¹åº”çš„ThreadLocal</span>
                ThreadLocal&lt;?&gt; k = e.get();
                <span class="hljs-keyword">if</span> (k == key) {
                <span class="hljs-comment">// keyå­˜åœ¨åˆ™è¦†ç›–value</span>
                    e.value = value;
                    <span class="hljs-keyword">return</span>;
                }
                <span class="hljs-comment">// keyä¸ºnullä½†æ˜¯å€¼ä¸ä¸ºnullï¼Œè¿™è¯´æ˜äº†ä¹‹å‰ä½¿ç”¨è¿‡ï¼Œä½†æ˜¯ThreadLocalè¢«åƒåœ¾å›æ”¶äº†ï¼Œå½“å‰çš„Entryæ˜¯ä¸€ä¸ªé™ˆæ—§çš„ï¼ˆStaleï¼‰å…ƒç´ </span>
                <span class="hljs-keyword">if</span> (k == <span class="hljs-literal">null</span>) {
                <span class="hljs-comment">// keyï¼ˆThreadLocalï¼‰ä¸å­˜åœ¨ï¼Œåˆ™æ–°Entryæ›¿æ¢æ—§çš„Entryï¼Œæ­¤æ–¹æ³•åšäº†ä¸å°‘åƒåœ¾æ¸…ç†çš„åŠ¨ä½œï¼Œé¿å…äº†å†…å­˜æ³„æ¼ã€‚</span>
                    replaceStaleEntry(key, value, i);
                    <span class="hljs-keyword">return</span>;
                }
            }
            <span class="hljs-comment">// ThreadLocalä¸­æœªæ‰¾åˆ°keyä¹Ÿæ²¡æœ‰é™ˆæ—§çš„å…ƒç´ ï¼Œæ­¤æ—¶åˆ™åœ¨è¿™ä¸ªä½ç½®æ–°åˆ›å»ºä¸€ä¸ªEntry</span>
            tab[i] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Entry</span>(key, value);
            <span class="hljs-type">int</span> <span class="hljs-variable">sz</span> <span class="hljs-operator">=</span> ++size;
            <span class="hljs-comment">// cleanSomeSlotsç”¨äºæ¸…ç†e.get()ä¸ºnullçš„keyï¼Œå¦‚æœå¤§äºé˜ˆå€¼ï¼ˆ2/3å®¹é‡ï¼‰åˆ™rehashï¼ˆæ‰§è¡Œä¸€æ¬¡å…¨è¡¨æ‰«ææ¸…ç†å·¥ä½œï¼‰</span>
            <span class="hljs-keyword">if</span> (!cleanSomeSlots(i, sz) &amp;&amp; sz &gt;= threshold)
                rehash();
        }
		<span class="hljs-comment">/**
		* çº¿æ€§æ¢æµ‹æ³•æŸ¥æ‰¾å…ƒç´ ï¼Œåˆ°æœ€åä¸€ä¸ªæ—¶é‡å®šä½åˆ°ç¬¬ä¸€ä¸ª
		*/</span>
		<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">nextIndex</span><span class="hljs-params">(<span class="hljs-type">int</span> i, <span class="hljs-type">int</span> len)</span> {
            <span class="hljs-keyword">return</span> ((i + <span class="hljs-number">1</span> &lt; len) ? i + <span class="hljs-number">1</span> : <span class="hljs-number">0</span>);
        }
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ«å†å †if-elseéªŒå‚æ•°äº†ï¼FastAPIè‡ªå¸¦çš„å‚æ•°éªŒè¯å™¨ï¼Œè‡³å°‘çœä¸€åŠè°ƒè¯•æ—¶é—´]]></title>    <link>https://juejin.cn/post/7591801024009486345</link>    <guid>https://juejin.cn/post/7591801024009486345</guid>    <pubDate>2026-01-06T02:40:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591801024009486345" data-draft-id="7591801024009437193" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ«å†å †if-elseéªŒå‚æ•°äº†ï¼FastAPIè‡ªå¸¦çš„å‚æ•°éªŒè¯å™¨ï¼Œè‡³å°‘çœä¸€åŠè°ƒè¯•æ—¶é—´"/> <meta itemprop="keywords" content="Python,FastAPI"/> <meta itemprop="datePublished" content="2026-01-06T02:40:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç‹äºŒå“¥çš„æŠ€æœ¯ç¬”è®°"/> <meta itemprop="url" content="https://juejin.cn/user/3358381525700410"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ«å†å †if-elseéªŒå‚æ•°äº†ï¼FastAPIè‡ªå¸¦çš„å‚æ•°éªŒè¯å™¨ï¼Œè‡³å°‘çœä¸€åŠè°ƒè¯•æ—¶é—´
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3358381525700410/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç‹äºŒå“¥çš„æŠ€æœ¯ç¬”è®°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T02:40:50.000Z" title="Tue Jan 06 2026 02:40:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8fbdf7cde6ef4ff4ace933f581acb422~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg546L5LqM5ZOl55qE5oqA5pyv56yU6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768272050&amp;x-signature=eWQSslwYchRUsufwbtojDlaohPI%3D" alt="fHbUZC5Mq" loading="lazy"/></p>
<p>ä½ æ˜¯ä¸æ˜¯ä¹Ÿé‡åˆ°è¿‡è¿™æ ·çš„åœºæ™¯â€”â€”ç”¨æˆ·ä¼ äº†ä¸ª <code>book_id=-1</code>ï¼Œæ¥å£ç›´æ¥å´©äº†ï¼Ÿæˆ–è€…æŸ¥è¯¢è¯„åˆ†æ—¶å¡è¿›æ¥ä¸€ä¸ª <code>rating=999</code>ï¼Œæ•°æ®åº“é»˜é»˜åå‡ºæ‰€æœ‰å†…å®¹ï¼Ÿ</p>
<p><strong>æ²¡éªŒè¯çš„å‚æ•°ï¼Œå°±åƒæ²¡é”çš„é—¨ã€‚</strong></p>
<p>ä¸Šä¸€æœŸæ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ Pydantic å¯¹è¯·æ±‚ä½“è¿›è¡Œæ•°æ®éªŒè¯ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨FastAPIçš„å¦å¤–ä¸¤ç§é‡è¦éªŒè¯æ–¹å¼ï¼š<strong>è·¯å¾„å‚æ•°éªŒè¯</strong>å’Œ<strong>æŸ¥è¯¢å‚æ•°éªŒè¯</strong>ã€‚</p>
<p>è®¿é—®ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œè¯·ç‚¹å‡»ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FzJd23wpb-IPqlIU-czHBKQ" target="_blank" title="https://mp.weixin.qq.com/s/zJd23wpb-IPqlIU-czHBKQ" ref="nofollow noopener noreferrer">è·³è½¬</a></p>
<h3 data-id="heading-0">ä¸ºä»€ä¹ˆéœ€è¦éªŒè¯è·¯å¾„å’ŒæŸ¥è¯¢å‚æ•°ï¼Ÿ</h3>
<p>å½“æˆ‘ä»¬æ„å»ºRESTful APIæ—¶ï¼Œé™¤äº†è¯·æ±‚ä½“æ•°æ®ï¼Œè·¯å¾„å‚æ•°å’ŒæŸ¥è¯¢å‚æ•°åŒæ ·éœ€è¦ä¸¥æ ¼çš„éªŒè¯ï¼š</p>
<p><strong>è·¯å¾„å‚æ•°</strong>ï¼šå¦‚<code>/books/{book_id}</code>ä¸­çš„<code>book_id</code></p>
<p><strong>æŸ¥è¯¢å‚æ•°</strong>ï¼šå¦‚<code>/books?rating=5</code>ä¸­çš„<code>rating</code></p>
<p>æ²¡æœ‰éªŒè¯çš„å‚æ•°å°±åƒæ²¡æœ‰å®‰æ£€çš„å…¥å£ï¼Œå¯èƒ½å¯¼è‡´å„ç§å®‰å…¨é—®é¢˜å’Œéé¢„æœŸè¡Œä¸ºã€‚</p>
<h3 data-id="heading-1">è·¯å¾„å‚æ•°éªŒè¯ï¼šç²¾å‡†æ§åˆ¶èµ„æºè®¿é—®</h3>
<p><strong>é—®é¢˜åœºæ™¯åˆ†æ</strong>ï¼šä»¥å›¾ä¹¦æŸ¥è¯¢æ¥å£ä¸ºä¾‹</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/books/{book_id}"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">read_book</span>(<span class="hljs-params">book_id: <span class="hljs-built_in">int</span></span>):
    <span class="hljs-keyword">for</span> book <span class="hljs-keyword">in</span> BOOKS:
        <span class="hljs-keyword">if</span> book.<span class="hljs-built_in">id</span> == book_id:
            <span class="hljs-keyword">return</span> book
    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
</code></pre>
<p>è¿™ä¸ªæ¥å£ä¼šå­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>ä¹¦ç±ä¸å­˜åœ¨æ—¶ï¼Œè¿”å›<code>None</code>ï¼Œç”¨æˆ·ä½“éªŒä¸æ˜¯å¾ˆå¥½ã€‚</li>
<li>æ²¡æœ‰å¯¹<code>book_id</code>å‚æ•°è¿›è¡Œåˆæ³•æ€§éªŒè¯ï¼ˆå¦‚è´Ÿæ•°ã€é›¶å€¼ï¼‰</li>
</ol>
<p><strong>è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨Pathè¿›è¡ŒéªŒè¯</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> Path

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/books/{book_id}"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">read_book</span>(<span class="hljs-params">book_id: <span class="hljs-built_in">int</span> = Path(<span class="hljs-params">gt=<span class="hljs-number">0</span></span>)</span>):
    <span class="hljs-keyword">for</span> book <span class="hljs-keyword">in</span> BOOKS:
        <span class="hljs-keyword">if</span> book.<span class="hljs-built_in">id</span> == book_id:
            <span class="hljs-keyword">return</span> book
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"error"</span>: <span class="hljs-string">"Book not found"</span>}
</code></pre>
<p>å…³é”®æ”¹è¿›ï¼š</p>
<ol>
<li><code>Path(gt=0)</code> ç¡®ä¿ book_id å‚æ•°å¿…é¡»å¤§äº 0ã€‚</li>
<li>å½“ä¹¦ç±ä¸å­˜åœ¨æ—¶ï¼Œç»™ç”¨æˆ·è¿”å›æ˜ç¡®çš„é”™è¯¯æç¤ºã€‚</li>
</ol>
<p><strong>éªŒè¯æ•ˆæœå±•ç¤º</strong></p>
<p>å›åˆ°æµè§ˆå™¨çš„ Swagger UI é¡µé¢ï¼Œåˆ·æ–°é¡µé¢ã€‚æˆ‘ä»¬è¿›å…¥ <code>GET /books/{book_id}</code> æ¥å£ï¼Œä¼ å…¥ <code>book_id=0</code>ã€‚</p>
<p>FastAPIè‡ªåŠ¨è¿”å›422é”™è¯¯ï¼ŒåŠå¦‚ä¸‹å¼‚å¸¸å“åº”ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"detail"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"greater_than"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"loc"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-string">"path"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"book_id"</span>
      <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"msg"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Input should be greater than 0"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"input"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"ctx"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"gt"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>ä»é”™è¯¯ä¿¡æ¯ä¸­ï¼Œç”¨æˆ·å°±å¯ä»¥æ˜ç¡®çš„äº†è§£åˆ°ï¼Œæˆ‘ä»¬ä¼ å…¥çš„ <code>book_id</code> å‚æ•°å¿…é¡»å¤§äº 0ã€‚</p>
<p><strong>åˆ é™¤æ¥å£åšåŒæ­¥ä¼˜åŒ–</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@app.delete(<span class="hljs-params"><span class="hljs-string">"/books/{book_id}"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">delete_book</span>(<span class="hljs-params">book_id: <span class="hljs-built_in">int</span> = Path(<span class="hljs-params">gt=<span class="hljs-number">0</span></span>)</span>):
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(BOOKS)):
        <span class="hljs-keyword">if</span> BOOKS[i].<span class="hljs-built_in">id</span> == book_id:
            BOOKS.pop(i)
            <span class="hljs-keyword">break</span>
</code></pre>
<h3 data-id="heading-2">æŸ¥è¯¢å‚æ•°éªŒè¯ï¼šç¡®ä¿ç­›é€‰æ¡ä»¶çš„åˆç†æ€§</h3>
<p><strong>é—®é¢˜åœºæ™¯åˆ†æ</strong>ï¼šå›¾ä¹¦æŒ‰è¯„åˆ†æŸ¥è¯¢æ¥å£ä¸ºä¾‹</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/books/"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">read_books_by_rating</span>(<span class="hljs-params">book_rating: <span class="hljs-built_in">int</span></span>):
    books_to_return = []
    <span class="hljs-keyword">for</span> book <span class="hljs-keyword">in</span> BOOKS:
        <span class="hljs-keyword">if</span> book.rating == book_rating:
            books_to_return.append(book)
    <span class="hljs-keyword">return</span> books_to_return
</code></pre>
<p>å­˜åœ¨çš„é—®é¢˜ï¼šè¯„åˆ†èŒƒå›´å¹¶æ²¡æœ‰åšé™åˆ¶ï¼ˆå¦‚ï¼Œå¯èƒ½ä¼šä¼ å…¥0æˆ–6ï¼‰</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨Queryè¿›è¡ŒéªŒè¯</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> Query

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/books/"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">read_books_by_rating</span>(<span class="hljs-params">book_rating: <span class="hljs-built_in">int</span> = Query(<span class="hljs-params">gt=<span class="hljs-number">0</span>, lt=<span class="hljs-number">6</span></span>)</span>):
    books_to_return = []
    <span class="hljs-keyword">for</span> book <span class="hljs-keyword">in</span> BOOKS:
        <span class="hljs-keyword">if</span> book.rating == book_rating:
            books_to_return.append(book)
    <span class="hljs-keyword">return</span> books_to_return
</code></pre>
<p>éªŒè¯è§„åˆ™è¯´æ˜ï¼š</p>
<p><code>gt=0</code>ï¼šå¿…é¡»å¤§äº 0
<code>lt=6</code>ï¼šå¿…é¡»å°äº 6</p>
<p>ç»¼åˆæ•ˆæœï¼šåªå…è®¸1-5çš„æ•´æ•°è¯„åˆ†</p>
<p><strong>éªŒè¯æ•ˆæœå±•ç¤º</strong></p>
<p>å›åˆ°æµè§ˆå™¨çš„ Swagger UI é¡µé¢ï¼Œåˆ·æ–°é¡µé¢ã€‚æˆ‘ä»¬è¿›å…¥ <code>GET /books/</code> æ¥å£ï¼Œä¼ å…¥ <code>book_rating=0</code>ã€‚</p>
<p>FastAPIè‡ªåŠ¨è¿”å›422é”™è¯¯ï¼ŒåŠå¦‚ä¸‹å¼‚å¸¸å“åº”ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"detail"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"greater_than"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"loc"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-string">"query"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"book_rating"</span>
      <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"msg"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Input should be greater than 0"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"input"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"ctx"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"gt"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>ä»é”™è¯¯ä¿¡æ¯ä¸­ï¼Œç”¨æˆ·å°±å¯ä»¥æ˜ç¡®çš„äº†è§£åˆ°ï¼Œæˆ‘ä»¬ä¼ å…¥çš„ <code>book_rating</code> å‚æ•°å¿…é¡»å¤§äº 0ã€‚</p>
<h3 data-id="heading-3">Path ä¸ Query éªŒè¯çš„å¯¹æ¯”</h3>






























<table><thead><tr><th>ç‰¹æ€§</th><th>Path å‚æ•°éªŒè¯</th><th>Query å‚æ•°éªŒè¯</th></tr></thead><tbody><tr><td>ä½¿ç”¨åœºæ™¯</td><td>èµ„æºæ ‡è¯†ï¼ˆå¦‚IDï¼‰</td><td>ç­›é€‰æ¡ä»¶ï¼ˆå¦‚è¯„åˆ†ã€åˆ†ç±»ï¼‰</td></tr><tr><td>å¯¼å…¥æ–¹å¼</td><td><code>from fastapi import Path</code></td><td><code>from fastapi import Query</code></td></tr><tr><td>è¯­æ³•ç¤ºä¾‹</td><td><code>book_id: int = Path(gt=0)</code></td><td><code>rating: int = Query(gt=0, lt=6)</code></td></tr><tr><td>éªŒè¯é‡ç‚¹</td><td>ç¡®ä¿èµ„æºæ ‡è¯†çš„åˆæ³•æ€§</td><td>ç¡®ä¿æŸ¥è¯¢æ¡ä»¶çš„åˆç†æ€§</td></tr></tbody></table>
<h3 data-id="heading-4">æœ€ä½³å®è·µ</h3>
<ol>
<li><strong>å§‹ç»ˆéªŒè¯</strong>ï¼šå¯¹æ‰€æœ‰è¾“å…¥å‚æ•°è¿›è¡ŒéªŒè¯ï¼Œä¸ä¿¡ä»»ä»»ä½•å¤–éƒ¨è¾“å…¥</li>
<li><strong>æ˜ç¡®èŒƒå›´</strong>ï¼šä¸ºæ•°å€¼å‚æ•°è®¾ç½®åˆç†çš„ä¸Šä¸‹é™</li>
<li><strong>ç»Ÿä¸€é”™è¯¯å¤„ç†</strong>ï¼šä¿æŒé”™è¯¯å“åº”æ ¼å¼çš„ä¸€è‡´æ€§</li>
<li><strong>æ–‡æ¡£å®Œå–„</strong>ï¼šè‰¯å¥½çš„éªŒè¯è§„åˆ™ä¼šè‡ªåŠ¨ä½“ç°åœ¨APIæ–‡æ¡£ä¸­</li>
</ol>
<h3 data-id="heading-5">ä¸‹èŠ‚é¢„å‘Š</h3>
<p>æŒæ¡äº†è¿™äº›åŸºç¡€éªŒè¯åï¼Œä¸‹ä¸€æœŸæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ FastAPI ä¸­å¸¸ç”¨çŠ¶æ€ç å’Œ HTTP å¼‚å¸¸çš„å®ç°ï¼Œè®©ä½ çš„ API æ›´åŠ æ ‡å‡†å’Œä¸“ä¸šã€‚</p>
<p>æ¬¢è¿ â€œå…³æ³¨â€ï¼Œæˆ‘ä»¬åœ¨ä¸‹ä¸€æœŸä¸€èµ·æ¥è§£é”è¿™ä¸ªé—®é¢˜ã€‚</p>
<hr/>
<p>-------- <strong>å†™åœ¨æœ€å</strong> --------</p>
<p><strong>å…³æ³¨æˆ‘</strong>ï¼Œæ¯å¤©1åˆ†é’Ÿï¼Œè½»æ¾æ‡‚ Python</p>
<p><strong>æˆ‘çš„åŒåå…¬ä¼—å·æ­£åœ¨è¿è½½ã€ŠFastAPI å¼€å‘å®æˆ˜ã€‹ã€ã€ŠPython æ ¸å¿ƒæŠ€æœ¯ã€‹ã€ã€ŠèŒåœºã€‹ã€‚</strong></p>
<hr/>
<p><strong>ç‚¹èµ</strong> ï¼šæ”¯æŒæŠ€æœ¯åˆ†äº«ï¼</p>
<p><strong>åˆ†äº«</strong> ï¼šåˆ†äº«ç»™èº«è¾¹æ„Ÿå…´è¶£çš„æœ‹å‹ï¼</p>
<p><strong>å…³æ³¨æˆ‘</strong> ï¼šè·å–æ›´å¤šFastAPIå®æˆ˜æŠ€å·§ï¼</p>
<hr/>
<p>#Python #FastAPI #API #Webå¼€å‘ #ç¨‹åºå‘˜ #ç¼–ç¨‹æ•™ç¨‹ #æ•ˆç‡æå‡ #åç«¯å¼€å‘ #APIè®¾è®¡ #å‚æ•°éªŒè¯</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[1åˆ†é’Ÿè§£é”Pythonç¥æŠ€ï¼šç”¨ç”Ÿæˆå™¨è½»æ¾å¤„ç†1äº¿æ¡æ•°æ®ï¼]]></title>    <link>https://juejin.cn/post/7591801024009535497</link>    <guid>https://juejin.cn/post/7591801024009535497</guid>    <pubDate>2026-01-06T02:45:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591801024009535497" data-draft-id="7591792747776229386" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="1åˆ†é’Ÿè§£é”Pythonç¥æŠ€ï¼šç”¨ç”Ÿæˆå™¨è½»æ¾å¤„ç†1äº¿æ¡æ•°æ®ï¼"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2026-01-06T02:45:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç‹äºŒå“¥çš„æŠ€æœ¯ç¬”è®°"/> <meta itemprop="url" content="https://juejin.cn/user/3358381525700410"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            1åˆ†é’Ÿè§£é”Pythonç¥æŠ€ï¼šç”¨ç”Ÿæˆå™¨è½»æ¾å¤„ç†1äº¿æ¡æ•°æ®ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3358381525700410/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç‹äºŒå“¥çš„æŠ€æœ¯ç¬”è®°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T02:45:15.000Z" title="Tue Jan 06 2026 02:45:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0866826f7c24425aa1a4b7022e356173~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg546L5LqM5ZOl55qE5oqA5pyv56yU6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768272314&amp;x-signature=FNSviGl8ywVB%2FERz3KX4V9OWPn8%3D" alt="202601052005209941" loading="lazy"/></p>
<p>æ¬¢è¿æ¥åˆ°ã€Œæ¯å¤©1åˆ†é’Ÿï¼Œè½»æ¾æ‡‚Pythonã€ï¼ä»Šå¤©çš„ä¸»è§’æ˜¯ï¼š<strong>ç”Ÿæˆå™¨</strong>ã€‚</p>
<p>å®ƒèƒ½è®©ä½ ç”¨å‡ ä¹å¿½ç•¥ä¸è®¡çš„å†…å­˜ï¼Œå¤„ç†æ— é™å¤§çš„æ•°æ®æµã€‚æ¯”å¦‚ï¼Œè½»æ¾éå†1äº¿æ¡æ•°æ®è€Œä¸ä¼šæ’‘çˆ†ä½ çš„å†…å­˜ã€‚</p>
<p><strong>æ ¸å¿ƒä»·å€¼å°±ä¸€ç‚¹ï¼šæƒ°æ€§è®¡ç®—â€”â€”éœ€è¦æ—¶æ‰ç”Ÿäº§ï¼Œç»ä¸æå‰æµªè´¹ç©ºé—´ã€‚</strong></p>
<p>1åˆ†é’Ÿæ—¶é—´ï¼Œæˆ‘ä»¬ä»æ¦‚å¿µã€ä»£ç ã€æ¡ˆä¾‹å‡ºå‘ã€‚è®©ä½ ä¸ä»…çœ‹æ‡‚ï¼Œæ›´èƒ½é©¬ä¸Šç”¨èµ·æ¥ï¼</p>
<h3 data-id="heading-0">å®¹å™¨ã€å¯è¿­ä»£å¯¹è±¡ã€è¿­ä»£å™¨</h3>
<p><strong>å®¹å™¨</strong>ï¼šåœ¨ Python ä¸­ä¸€åˆ‡çš†ä¸ºå¯¹è±¡ï¼Œå¯¹è±¡çš„é›†åˆå°±æ˜¯å®¹å™¨ã€‚</p>
<p><strong>å¯è¿­ä»£å¯¹è±¡</strong>ï¼š<strong>å®ç°äº†<code>__iter__()</code>æ–¹æ³•</strong>çš„å¯¹è±¡ï¼Œæˆ–è€…è¯´ï¼Œæ˜¯èƒ½è¿”å›ä¸€ä¸ªè¿­ä»£å™¨çš„å¯¹è±¡ã€‚</p>
<p>æ‰€æœ‰å®¹å™¨éƒ½æ˜¯å¯è¿­ä»£å¯¹è±¡ï¼Œä½†å¯è¿­ä»£å¯¹è±¡ä¸ä¸€å®šæ˜¯å®¹å™¨ã€‚</p>
<p><strong>è¿­ä»£å™¨</strong>ï¼š<strong>å®ç°äº†<code>__iter__()</code>å’Œ<code>__next__()</code>æ–¹æ³•</strong>çš„å¯¹è±¡ã€‚å®ƒæä¾›ä¸€ä¸ª next æ–¹æ³•ï¼Œå½“ä½ è°ƒç”¨è¿™ä¸ªæ–¹æ³•åï¼Œè¦ä¹ˆå¾—åˆ°ä¸‹ä¸€ä¸ªå¯¹è±¡ï¼Œè¦ä¹ˆæŠ›å‡º StopIteration å¼‚å¸¸ã€‚</p>
<h5 data-id="heading-1">1ã€åˆ¤æ–­å¯è¿­ä»£å¯¹è±¡</h5>
<p>é€šè¿‡ <code>iter()</code> å‡½æ•°å°è¯•è½¬æ¢ï¼Œæ•è· <code>TypeError</code> åˆ¤æ–­ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_iterable</span>(<span class="hljs-params">param</span>):  
    <span class="hljs-keyword">try</span>:  
        <span class="hljs-built_in">iter</span>(param)  
        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>  
    <span class="hljs-keyword">except</span> TypeError:  
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>  

<span class="hljs-comment"># æµ‹è¯•ï¼šåˆ—è¡¨ã€å­—å…¸ç­‰è¿”å› Trueï¼Œæ•°å­—è¿”å› False  </span>
</code></pre>
<h3 data-id="heading-2">ç”Ÿæˆå™¨ï¼šæ›´è½»é‡çš„è¿­ä»£å™¨</h3>
<h5 data-id="heading-3">1ã€æ ¸å¿ƒä¼˜åŠ¿</h5>
<p><strong>æƒ°æ€§è®¡ç®—</strong>ï¼šä»…åœ¨è°ƒç”¨ <code>next()</code> æ—¶ç”Ÿæˆå…ƒç´ ï¼Œï¼ˆæ¯”é¢„å…ˆç”Ÿæˆå¤§åˆ—è¡¨ ï¼‰èŠ‚çœå†…å­˜ã€‚</p>
<p><strong>ç®€å•è¯­æ³•</strong>ï¼šä½¿ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼ï¼ˆ<code>(i for i in range(10))</code> ï¼‰æˆ– <code>yield</code> å…³é”®å­—å®šä¹‰ã€‚</p>
<pre><code class="hljs language-lua" lang="lua">å¯¹äº <span class="hljs-built_in">yield</span>ï¼Œå¯ä»¥ç†è§£ä¸ºï¼š
å‡½æ•°è¿è¡Œåˆ°è¿™ä¸€è¡Œçš„æ—¶å€™ï¼Œç¨‹åºä¼šä»è¿™é‡Œæš‚åœï¼Œç„¶åè·³å‡ºã€‚è·³åˆ° <span class="hljs-built_in">next</span>() å‡½æ•°ã€‚
æ¯æ¬¡è°ƒç”¨ `<span class="hljs-built_in">next</span>(gen)` æ—¶ï¼Œæš‚åœçš„ç¨‹åºï¼Œå°±ä¼šä» <span class="hljs-built_in">yield</span> è¿™é‡Œå‘ä¸‹ç»§ç»­æ‰§è¡Œï¼›
</code></pre>
<h5 data-id="heading-4">2ã€åŸºç¡€ç”¨æ³•</h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># 1. ç”Ÿæˆå™¨è¡¨è¾¾å¼</span>
gen = (i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>))
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">next</span>(gen))  <span class="hljs-comment"># è¾“å‡º 0</span>
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">next</span>(gen))  <span class="hljs-comment"># è¾“å‡º 1</span>
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">next</span>(gen))  <span class="hljs-comment"># è¾“å‡º 2</span>
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">next</span>(gen))  <span class="hljs-comment"># StopIteration</span>

<span class="hljs-comment"># 2. yield å…³é”®å­—</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">my_generator</span>():
    <span class="hljs-keyword">yield</span> <span class="hljs-number">1</span>
    <span class="hljs-keyword">yield</span> <span class="hljs-number">2</span>
    <span class="hljs-keyword">yield</span> <span class="hljs-number">3</span>


gen = my_generator()
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">next</span>(gen))  <span class="hljs-comment"># è¾“å‡º 1</span>
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">next</span>(gen))  <span class="hljs-comment"># è¾“å‡º 2</span>
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">next</span>(gen))  <span class="hljs-comment"># è¾“å‡º 3</span>
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">next</span>(gen))  <span class="hljs-comment"># StopIteration</span>
</code></pre>
<h3 data-id="heading-5">å®æˆ˜åº”ç”¨</h3>
<h5 data-id="heading-6">1ã€å†…å­˜ä¼˜åŒ–å¯¹æ¯”</h5>
<p>ç”Ÿæˆå™¨å¯ä»¥é¿å…é¢„å­˜å¤§é‡æ•°æ®ï¼Œé€‚åˆå¤„ç†è¶…å¤§åºåˆ—ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> pympler <span class="hljs-keyword">import</span> asizeof

<span class="hljs-comment"># è¿­ä»£å™¨</span>
large_list = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>**<span class="hljs-number">5</span>)]

<span class="hljs-comment"># ç”Ÿæˆå™¨</span>
<span class="hljs-comment"># ä»…ä¿å­˜ç”Ÿæˆé€»è¾‘ï¼Œå†…å­˜å¤§å°ä¸éšæ•°æ®é‡å¤§å°å˜åŒ–ï¼Œå†…å­˜å ç”¨æä½</span>
large_gen = (i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>**<span class="hljs-number">5</span>))

<span class="hljs-comment"># è¾“å‡ºï¼šåˆ—è¡¨å ç”¨å†…å­˜: 3907.21 KB</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"åˆ—è¡¨å ç”¨å†…å­˜: <span class="hljs-subst">{asizeof.asizeof(large_list) / <span class="hljs-number">1024</span>:<span class="hljs-number">.2</span>f}</span> KB"</span>)
<span class="hljs-comment"># è¾“å‡ºï¼šç”Ÿæˆå™¨å ç”¨å†…å­˜: 0.45 KB</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç”Ÿæˆå™¨å ç”¨å†…å­˜: <span class="hljs-subst">{asizeof.asizeof(large_gen) / <span class="hljs-number">1024</span>:<span class="hljs-number">.2</span>f}</span> KB"</span>)
</code></pre>
<h5 data-id="heading-7">2ã€å¤æ‚é€»è¾‘å®ç°ï¼šéªŒè¯æ•°å­¦å…¬å¼</h5>
<p>ç”¨ç”Ÿæˆå™¨åŠ¨æ€ç”Ÿæˆæ•°åˆ—ï¼ŒéªŒè¯ç­‰å¼ <code>(1+2+...+n)Â² = 1Â³+2Â³+...+nÂ³</code>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä½¿ç”¨ç”Ÿæˆå™¨</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">generator</span>(<span class="hljs-params">k</span>):  
    i = <span class="hljs-number">1</span>  
    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:  
        <span class="hljs-keyword">yield</span> i**k  
        i += <span class="hljs-number">1</span>  

gen_1 = generator(<span class="hljs-number">2</span>)  <span class="hljs-comment"># ç”Ÿæˆ 1,4,9...</span>
gen_3 = generator(<span class="hljs-number">3</span>)  <span class="hljs-comment"># ç”Ÿæˆ 1Â³,2Â³,3Â³...  </span>
</code></pre>
<h5 data-id="heading-8">3ã€ç®—æ³•ç®€åŒ–ï¼šå­åºåˆ—åˆ¤æ–­</h5>
<p>ç”¨ç”Ÿæˆå™¨ + è¿­ä»£å™¨ï¼Œå¯ä»¥æ›´ç®€æ´å®ç° â€œåˆ¤æ–­å­åºåˆ—â€ é€»è¾‘ï¼š</p>
<p>LeetCode é¢˜ç›®ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.com%2Fproblems%2Fis-subsequence%2F" target="_blank" title="https://leetcode.com/problems/is-subsequence/" ref="nofollow noopener noreferrer">leetcode.com/problems/isâ€¦</a></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_subsequence</span>(<span class="hljs-params">a, b</span>):  
    b = <span class="hljs-built_in">iter</span>(b)  <span class="hljs-comment"># è½¬ä¸ºè¿­ä»£å™¨  </span>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">all</span>(i <span class="hljs-keyword">in</span> b <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a)  

<span class="hljs-comment"># æµ‹è¯•ï¼ša = [1,3,5] æ˜¯ b = [1,2,3,4,5] çš„å­åºåˆ—  </span>
<span class="hljs-built_in">print</span>(is_subsequence([<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]))  <span class="hljs-comment"># True  </span>
<span class="hljs-built_in">print</span>(is_subsequence([<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]))  <span class="hljs-comment"># False</span>
</code></pre>
<h3 data-id="heading-9">é«˜é¢‘é¢è¯•é¢˜</h3>
<p>01ã€<strong>å¯è¿­ä»£å¯¹è±¡å’Œè¿­ä»£å™¨çš„åŒºåˆ«ï¼Ÿ</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">å¯è¿­ä»£å¯¹è±¡ï¼šå®ç° <span class="hljs-strong">__iter__</span>ï¼Œå¯è½¬ä¸ºè¿­ä»£å™¨ï¼ˆå¦‚ list ï¼‰ã€‚
è¿­ä»£å™¨ï¼šå®ç° <span class="hljs-strong">__iter__</span> å’Œ <span class="hljs-strong">__next__</span>ï¼Œæ”¯æŒ next() é€ä¸ªå–å…ƒç´ ã€‚
</code></pre>
<p>02ã€<strong>ç”Ÿæˆå™¨çš„ <code>yield</code> æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</strong></p>
<pre><code class="hljs language-scss" lang="scss">æš‚åœå‡½æ•°æ‰§è¡Œï¼Œä¿ç•™å½“å‰çŠ¶æ€ï¼ˆå¦‚å˜é‡å€¼ ï¼‰ã€‚è¿”å›ä¸€ä¸ªå€¼ç»™è°ƒç”¨è€…ã€‚
ä¸‹æ¬¡ <span class="hljs-built_in">next</span>() è°ƒç”¨æ—¶ä»æš‚åœå¤„ç»§ç»­æ‰§è¡Œã€‚
</code></pre>
<p>03ã€<strong>ç”Ÿæˆå™¨ä¸ºä»€ä¹ˆèƒ½èŠ‚çœå†…å­˜ï¼Ÿ</strong></p>
<pre><code class="hljs language-scss" lang="scss">ç”Ÿæˆå™¨æ˜¯ â€œæƒ°æ€§è®¡ç®—â€ï¼Œä¸é¢„å­˜æ‰€æœ‰å…ƒç´ ï¼Œä»…åœ¨è°ƒç”¨ <span class="hljs-built_in">next</span>() æ—¶åŠ¨æ€ç”Ÿæˆã€‚
å› æ­¤ï¼Œå†…å­˜å ç”¨è¿œä½äºé¢„å…ˆç”Ÿæˆå¤§åˆ—è¡¨çš„è¿­ä»£å™¨ã€‚
</code></pre>
<p>04ã€<code>for</code> å¾ªç¯å¦‚ä½•éå†å¯è¿­ä»£å¯¹è±¡ï¼Ÿ</p>
<pre><code class="hljs language-scss" lang="scss">for å¾ªç¯è‡ªåŠ¨å°†å¯è¿­ä»£å¯¹è±¡è½¬ä¸ºè¿­ä»£å™¨ï¼ˆè°ƒç”¨ <span class="hljs-built_in">iter</span>() ï¼‰ã€‚
ç„¶åï¼Œå¾ªç¯è°ƒç”¨ <span class="hljs-built_in">next</span>()ï¼Œç›´åˆ°æ•è· StopIteration å¼‚å¸¸é€€å‡ºã€‚
</code></pre>
<p>05ã€<strong>å“ªäº›åœºæ™¯é€‚åˆç”¨ç”Ÿæˆå™¨ï¼Ÿ</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> å¤„ç†è¶…å¤§åºåˆ—ï¼ˆå¦‚ä¸€äº¿æ¡æ•°æ® ï¼‰ï¼Œé¿å…å†…å­˜æº¢å‡ºã€‚
<span class="hljs-bullet">2.</span> å®ç°åŠ¨æ€ç”Ÿæˆé€»è¾‘ï¼ˆå¦‚æ— é™æ•°åˆ—ã€å®æ—¶æ•°æ®æµ ï¼‰ã€‚
<span class="hljs-bullet">3.</span> ç®€åŒ–ä»£ç ï¼ˆå¦‚å­åºåˆ—åˆ¤æ–­ã€å¤æ‚æ•°å­¦éªŒè¯ ï¼‰ã€‚
</code></pre>
<p>06ã€ç”Ÿæˆå™¨è¿­ä»£ç»“æŸåï¼Œç»§ç»­è°ƒç”¨ <code>next()</code> ä¼šæ€æ ·ï¼Ÿ</p>
<pre><code class="hljs">æŠ›å‡º StopIteration å¼‚å¸¸ï¼Œæç¤ºè¿­ä»£å·²ç»“æŸã€‚
</code></pre>
<hr/>
<p>-------- <strong>å†™åœ¨æœ€å</strong> --------</p>
<p><strong>å…³æ³¨æˆ‘</strong>ï¼Œæ¯å¤©1åˆ†é’Ÿï¼Œè½»æ¾æ‡‚ Python</p>
<p><strong>æˆ‘çš„åŒåå…¬ä¼—å·æ­£åœ¨è¿è½½ã€ŠFastAPI å¼€å‘å®æˆ˜ã€‹ã€ã€ŠPython æ ¸å¿ƒæŠ€æœ¯ã€‹ã€ã€ŠèŒåœºã€‹ã€‚</strong></p>
<hr/>
<p><strong>ç‚¹èµ</strong> ï¼šå¦‚æœè§‰å¾—æœ‰æ”¶è·ï¼Œç‚¹èµæ”¯æŒä¸€ä¸‹å§ï¼</p>
<p><strong>åˆ†äº«</strong> ï¼šåˆ†äº«ç»™èº«è¾¹åŒæ ·å¯¹Pythonæ„Ÿå…´è¶£çš„æœ‹å‹ï¼</p>
<p><strong>å…³æ³¨æˆ‘</strong> ï¼šä¸è¦é”™è¿‡æ¯ä¸€ç¯‡ Python å®æˆ˜å†…å®¹ï¼</p>
<hr/>
<p>#Python #FastAPI #API #Webå¼€å‘ #ç¨‹åºå‘˜ #ç¼–ç¨‹æ•™ç¨‹ #æ•ˆç‡æå‡ #è£…é¥°å™¨</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[003-spring cloud alibabaä¹‹gatewayç½‘å…³]]></title>    <link>https://juejin.cn/post/7592017365141061684</link>    <guid>https://juejin.cn/post/7592017365141061684</guid>    <pubDate>2026-01-06T02:52:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592017365141061684" data-draft-id="7591704324907728930" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="003-spring cloud alibabaä¹‹gatewayç½‘å…³"/> <meta itemprop="keywords" content="å¾®æœåŠ¡"/> <meta itemprop="datePublished" content="2026-01-06T02:52:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¶…çº§å°çŒª"/> <meta itemprop="url" content="https://juejin.cn/user/3702810891008525"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            003-spring cloud alibabaä¹‹gatewayç½‘å…³
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3702810891008525/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¶…çº§å°çŒª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-06T02:52:46.000Z" title="Tue Jan 06 2026 02:52:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">gateway</h2>
<blockquote>
<p>gatewayç½‘å…³ä¸»è¦å°±æ˜¯å¯¹å¤–æ¥æ”¶å„ç§è¯·æ±‚ï¼Œç„¶åæ ¹æ®è‡ªå·±å†…å®¹çš„è·¯ç”±é€»è¾‘å°†è¯·æ±‚å‘ç»™æœåŠ¡</p>
</blockquote>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
Start --&gt; gateway
gateway --&gt; è·¯ç”±
è·¯ç”± --&gt; user
è·¯ç”± --&gt; base
è·¯ç”± --&gt; order
è·¯ç”± --&gt; ...
</code></pre>
<h3 data-id="heading-1">gatewayæœåŠ¡æ­å»º</h3>
<h4 data-id="heading-2">ç¬¬1æ­¥ï¼šä¾èµ–</h4>
<p>æ„å»ºä¸€ä¸ªgatewayæœåŠ¡åªéœ€è¦å¢åŠ ç›¸åº”çš„ä¾èµ–</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span>
         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.example<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>gateway<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.source</span>&gt;</span>8<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.source</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.target</span>&gt;</span>8<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.target</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">spring-cloud-alibaba-version</span>&gt;</span>2021.1<span class="hljs-tag">&lt;/<span class="hljs-name">spring-cloud-alibaba-version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">spring-cloud.version</span>&gt;</span>2020.0.1<span class="hljs-tag">&lt;/<span class="hljs-name">spring-cloud.version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">spring-boot.version</span>&gt;</span>2.4.2<span class="hljs-tag">&lt;/<span class="hljs-name">spring-boot.version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-loadbalancer<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-alibaba-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${spring-cloud-alibaba-version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${spring-cloud.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${spring-boot.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencyManagement</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span>
</code></pre>
<h4 data-id="heading-3">ç¬¬2æ­¥ï¼šåˆ›å»ºyamlæ–‡ä»¶</h4>
<p>ä¸»è¦æ˜¯è¦æ–°å¢è·¯ç”±é€»è¾‘é…ç½®</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">9999</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">application:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">gateway-service</span>
  <span class="hljs-attr">cloud:</span>
    <span class="hljs-attr">nacos:</span>
      <span class="hljs-attr">discovery:</span>
        <span class="hljs-attr">server-addr:</span> <span class="hljs-number">10.106</span><span class="hljs-number">.114</span><span class="hljs-number">.1</span><span class="hljs-string">:8848</span>
    <span class="hljs-attr">gateway:</span>
      <span class="hljs-attr">routes:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">id:</span> <span class="hljs-string">user</span>
          <span class="hljs-attr">uri:</span> <span class="hljs-string">http://10.106.114.1:9001/</span>
          <span class="hljs-attr">predicates:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-string">Path=/user/**</span>
</code></pre>
<p>ä¸Šé¢é…ç½®çš„gateway.routeså°±æ˜¯è·¯ç”±</p>
<ul>
<li>
<p>idï¼šæ ‡è®°è·¯ç”±</p>
</li>
<li>
<p>predicatesï¼šè·¯ç”±é…ç½®</p>
<ul>
<li>Pathï¼šå…¶ä¸­ä¸€ä¸ªè·¯å¾„ï¼Œä¸Šé¢<code>/user/**</code>è¡¨ç¤ºå½“è¯·æ±‚localhost:9999/user/xxxæ—¶ï¼Œä¼šå°†è¯·æ±‚è½¬å‘åˆ°<code>http://10.106.114.1:9001/user/xxx</code></li>
</ul>
</li>
<li>
<p>uriï¼šè½¬å‘çš„åœ°å€</p>
</li>
</ul>
<h4 data-id="heading-4">ç¬¬3æ­¥ï¼šå¯åŠ¨ç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@EnableDiscoveryClient</span>
<span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GatewayStartApplication</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        SpringApplication.run(GatewayStartApplication.class,args);
    }
}
</code></pre>
<h4 data-id="heading-5">ç¬¬4æ­¥åˆ›å»ºuseræœåŠ¡</h4>
<p>useræœåŠ¡ä¸»è¦è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºè¯·æ±‚æ˜¯<code>http://10.106.114.1:9001/user/xxx</code>å¤šäº†ä¸€ä¸ªuserï¼Œæ‰€ä»¥éœ€è¦åœ¨useræœåŠ¡é‡Œé¢å¢åŠ context-pathã€‚ä¸‹é¢æ˜¯useræœåŠ¡çš„é…ç½®</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">9001</span>
  <span class="hljs-attr">servlet:</span>
    <span class="hljs-attr">context-path:</span> <span class="hljs-string">/user/</span>

<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">application:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">user</span>
  <span class="hljs-attr">cloud:</span>
    <span class="hljs-attr">discovery:</span>
      <span class="hljs-attr">server-addr:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:8848</span>

<span class="hljs-attr">management:</span>
  <span class="hljs-attr">endpoint:</span>
    <span class="hljs-attr">web:</span>
      <span class="hljs-attr">exposure:</span>
        <span class="hljs-string">include:'*'</span>
</code></pre>
<h4 data-id="heading-6">ç¬¬5æ­¥éªŒè¯</h4>
<ul>
<li>å¯åŠ¨nacos</li>
<li>å¯åŠ¨gateway</li>
<li>å¯åŠ¨user</li>
<li>è®¿é—®9001ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2F10.106.114.1%3A9001%2Fuser%2Fhello" target="_blank" title="http://10.106.114.1:9001/user/hello" ref="nofollow noopener noreferrer">http://10.106.114.1:9001/user/hello</a> ç¡®å®šuseræœåŠ¡æ­£å¸¸</li>
<li>è®¿é—®9999ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2F10.106.114.1%3A9999%2Fuser%2Fhello" target="_blank" title="http://10.106.114.1:9999/user/hello" ref="nofollow noopener noreferrer">http://10.106.114.1:9999/user/hello</a></li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/840f6d3c427a430e8ad3597e48a9bf1a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LaF57qn5bCP54yq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768272765&amp;x-signature=k5m2Wq%2BHi%2FC8QYc80Jqp3zT1So8%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-7">è‡ªå®šä¹‰è·¯ç”±</h3>
<p>ä¸Šé¢ä½¿ç”¨çš„é…ç½®æ–‡ä»¶æ¥å®ç°è·¯ç”±ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰ç±»æ¥å®ç°è·¯ç”±æ¨¡å¼ã€‚</p>
<h4 data-id="heading-8">ç¬¬1æ­¥ï¼šæ³¨é‡Šyamlé‡Œé¢çš„è·¯ç”±é…ç½®</h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/78ccb9e37a944c679d51557d0d6b8f4d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LaF57qn5bCP54yq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768272765&amp;x-signature=oR1VO5Fk4mSZ%2BSsy6mMFrJC%2F1kU%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-9">ç¬¬2æ­¥ï¼šåˆ›å»ºè‡ªå®šä¹‰ç±»è·¯ç”±</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.cloud.gateway.route.RouteLocator;
<span class="hljs-keyword">import</span> org.springframework.cloud.gateway.route.builder.RouteLocatorBuilder;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;


<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GatewayConfig</span> {

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> RouteLocator <span class="hljs-title function_">customerRouteLocator</span><span class="hljs-params">(RouteLocatorBuilder routeLocatorBuilder)</span>{
        System.out.println(<span class="hljs-string">"åŠ è½½è·¯ç”±"</span>);
        RouteLocatorBuilder.<span class="hljs-type">Builder</span> <span class="hljs-variable">routes</span> <span class="hljs-operator">=</span> routeLocatorBuilder.routes();
        routes.route(<span class="hljs-string">"user"</span>,
                r-&gt;r.path(<span class="hljs-string">"/user/**"</span>).uri(<span class="hljs-string">"http://10.106.114.1:9001/"</span>));
        <span class="hljs-keyword">return</span> routes.build();
    }
}
</code></pre>
<h4 data-id="heading-10">ç¬¬3æ­¥ï¼šéªŒè¯</h4>
<p>æ•ˆæœåŒæ ·</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ccaa371421b4fca8c103383818fb09c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LaF57qn5bCP54yq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768272765&amp;x-signature=yXcOf8dMw4%2FwoP6t4kBF0on%2F714%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸå‹æ±¡æŸ“å®‰å…¨æ¼æ´]]></title>    <link>https://juejin.cn/post/7591728734983012379</link>    <guid>https://juejin.cn/post/7591728734983012379</guid>    <pubDate>2026-01-05T15:59:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591728734983012379" data-draft-id="7591719013488394278" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸå‹æ±¡æŸ“å®‰å…¨æ¼æ´"/> <meta itemprop="keywords" content="å‰ç«¯,å¼ºåŒ–å­¦ä¹ "/> <meta itemprop="datePublished" content="2026-01-05T15:59:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åœ¨è¥¿å®‰æ”¾ç¾Šçš„ç‰›æ²¹æœ"/> <meta itemprop="url" content="https://juejin.cn/user/2946346894233133"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸå‹æ±¡æŸ“å®‰å…¨æ¼æ´
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2946346894233133/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åœ¨è¥¿å®‰æ”¾ç¾Šçš„ç‰›æ²¹æœ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-05T15:59:03.000Z" title="Mon Jan 05 2026 15:59:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¦‚å¿µ</h2>
<p><strong>åŸå‹æ±¡æŸ“å®‰å…¨æ¼æ´ï¼ˆPrototype Pollutionï¼‰</strong> æ˜¯å‰ç«¯ / Node.js ç”Ÿæ€é‡Œéå¸¸é‡è¦ã€ä¹Ÿéå¸¸å®¹æ˜“è¢«å¿½ç•¥çš„ä¸€ç±»æ¼æ´ã€‚è¯¥æ¼æ´æœ€ç»ˆå¯å¯¼è‡´æƒé™ç»•è¿‡ï¼Œæ˜¯å‰ç«¯å®‰å…¨ä¸­çš„é«˜å±é—®é¢˜ã€‚</p>
<h2 data-id="heading-1">ä»€ä¹ˆæ˜¯åŸå‹æ±¡æŸ“ï¼Ÿ</h2>
<p>æ”»å‡»è€…é€šè¿‡å¯æ§è¾“å…¥ï¼Œä¿®æ”¹ <code>Object.prototype</code> æˆ–å…¶ä»–å†…å»ºåŸå‹ï¼Œä»è€Œå½±å“æ‰€æœ‰å¯¹è±¡çš„è¡Œä¸ºã€‚</p>
<p>JS åŸå‹é“¾</p>
<pre><code class="hljs language-javascript" lang="javascript">obj â†’ <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> â†’ <span class="hljs-literal">null</span>
</code></pre>
<p>ä¸€æ—¦æ±¡æŸ“äº† <code>Object.prototype</code></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">Object.prototype.isAdmin</span> = <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
({}).<span class="hljs-attr">isAdmin</span> === <span class="hljs-literal">true</span><span class="hljs-comment">; // ğŸ’£</span>
</code></pre>
<h2 data-id="heading-2">æ¨¡æ‹Ÿæ”»å‡»</h2>
<p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€æ®µä»£ç æ¥åˆ†æä¸€ä¸‹ä»€ä¹ˆæ˜¯åŸå‹æ±¡æŸ“ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">deepMerge</span>(<span class="hljs-params">target, source</span>) { 
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> source) { 
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> source[key] === <span class="hljs-string">'object'</span>) { 
      <span class="hljs-keyword">if</span> (!target[key]) { 
        target[key] = {}; 
      } 
      <span class="hljs-title function_">deepMerge</span>(target[key], source[key]); 
    } <span class="hljs-keyword">else</span> { 
      target[key] = source[key]; 
    } 
  } 
  <span class="hljs-keyword">return</span> target; 
} 
 
<span class="hljs-comment">// æ¨¡æ‹Ÿä¸šåŠ¡ä»£ç  </span>
<span class="hljs-comment">// æ–¹æ¡ˆ1ï¼šç›‘å¬ message äº‹ä»¶ </span>
<span class="hljs-keyword">const</span> config = {}; 
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> { 
  <span class="hljs-title function_">deepMerge</span>(config, e.<span class="hljs-property">data</span>); 
}); 
 
<span class="hljs-comment">// æ–¹æ¡ˆ2ï¼šä½¿ç”¨ qs è§£æ query </span>
<span class="hljs-keyword">import</span> qs <span class="hljs-keyword">from</span> <span class="hljs-string">'qs'</span>; 
<span class="hljs-keyword">const</span> searchQuery = qs.<span class="hljs-title function_">parse</span>(location.<span class="hljs-property">search</span>); 
<span class="hljs-keyword">const</span> routeQuery = { 
  <span class="hljs-attr">type</span>: <span class="hljs-string">'low'</span>, 
  <span class="hljs-attr">tab</span>: <span class="hljs-number">1</span>, 
}; 
<span class="hljs-title function_">deepMerge</span>(routeQuery, searchQuery); 
 
 
<span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘ </span>
<span class="hljs-keyword">const</span> userInfo = {}; 
<span class="hljs-keyword">if</span> (userInfo.<span class="hljs-property">isAdmin</span>) { 
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä½ æ˜¯ç®¡ç†å‘˜'</span>); 
} 

 <span class="hljs-comment">// æˆ‘æƒ³æˆä¸ºç®¡ç†å‘˜ï¼Œè¯·è¾“å…¥æ”»å‡»è·è½½ï¼š </span>
</code></pre>
<p>è¿™æ®µä»£ç <strong>å­˜åœ¨å…¸å‹çš„åŸå‹æ±¡æŸ“ï¼ˆPrototype Pollutionï¼‰å®‰å…¨æ¼æ´</strong>ï¼Œè€Œä¸”ä¸¤ä¸ªâ€œæ–¹æ¡ˆâ€éƒ½èƒ½æˆä¸ºæ”»å‡»å…¥å£ã€‚ä¸‹é¢æˆ‘æŒ‰ã€Œé—®é¢˜ â†’ åˆ©ç”¨æ–¹å¼ â†’ å½±å“ â†’ ä¿®å¤å»ºè®®ã€æ¥æ‹†è§£ã€‚</p>
<hr/>
<h3 data-id="heading-3">ä¸€ã€æ ¸å¿ƒé—®é¢˜åœ¨å“ªï¼Ÿ</h3>
<h4 data-id="heading-4">ä¸å®‰å…¨çš„ <code>deepMerge</code></h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">deepMerge</span>(<span class="hljs-params">target, source</span>) { 
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> source) { 
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> source[key] === <span class="hljs-string">'object'</span>) { 
      <span class="hljs-keyword">if</span> (!target[key]) { 
        target[key] = {}; 
      } 
      <span class="hljs-title function_">deepMerge</span>(target[key], source[key]); 
    } <span class="hljs-keyword">else</span> { 
      target[key] = source[key]; 
    } 
  } 
}
</code></pre>
<p><strong>é—®é¢˜ç‚¹ï¼š</strong></p>
<ul>
<li>ä½¿ç”¨ <code>for...in</code>ï¼ˆä¼šéå†åŸå‹é“¾ï¼‰</li>
<li>æœªè¿‡æ»¤ <code>proto</code> / <code>constructor</code> / <code>prototype</code></li>
<li>æœªåˆ¤æ–­æ˜¯å¦ä¸ºã€Œçº¯å¯¹è±¡ã€</li>
<li>ç›´æ¥é€’å½’å†™å…¥ <code>target[key]</code></li>
</ul>
<p>ğŸ‘‰ <strong>æ”»å‡»è€…å¯ä»¥ä¿®æ”¹</strong> <strong><code>Object.prototype</code></strong></p>
<hr/>
<h3 data-id="heading-5">äºŒã€ä¸¤ä¸ªä¸šåŠ¡åœºæ™¯ä¸ºä»€ä¹ˆéƒ½å±é™©ï¼Ÿ</h3>
<h4 data-id="heading-6">æ–¹æ¡ˆ1ï¼š</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
  <span class="hljs-title function_">deepMerge</span>(config, e.<span class="hljs-property">data</span>);
});
</code></pre>
<h5 data-id="heading-7">æ”»å‡» payload</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">postMessage</span>({<span class="hljs-attr">proto</span>: {<span class="hljs-attr">isAdmin</span>: <span class="hljs-literal">true</span>
  }
}, <span class="hljs-string">'*'</span>);
</code></pre>
<h5 data-id="heading-8">ç»“æœ</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> userInfo = {};
userInfo.<span class="hljs-property">isAdmin</span> === <span class="hljs-literal">true</span>; <span class="hljs-comment">// ğŸ’£</span>
</code></pre>
<p>ğŸ¯ <strong>æ”»å‡»è€…æ— éœ€æ§åˆ¶ userInfoï¼Œåªè¦æ±¡æŸ“åŸå‹å³å¯</strong></p>
<hr/>
<h4 data-id="heading-9">æ–¹æ¡ˆ2ï¼š</h4>
<pre><code class="hljs language-js" lang="js">qs.<span class="hljs-title function_">parse</span>(location.<span class="hljs-property">search</span>)
<span class="hljs-keyword">const</span> searchQuery = qs.<span class="hljs-title function_">parse</span>(location.<span class="hljs-property">search</span>);
<span class="hljs-title function_">deepMerge</span>(routeQuery, searchQuery);
</code></pre>
<h5 data-id="heading-10">æ¶æ„ URL</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-attr">https</span>:<span class="hljs-comment">//example.com/?_proto_[isAdmin]=true</span>
</code></pre>
<p>æˆ–ï¼ˆæ›´éšè”½ï¼‰</p>
<pre><code class="hljs language-js" lang="js">?constructor[prototype][isAdmin]=<span class="hljs-literal">true</span>
</code></pre>
<h5 data-id="heading-11">ç»“æœåŒæ ·æ˜¯ï¼š</h5>
<pre><code class="hljs language-js" lang="js">({}).<span class="hljs-property">isAdmin</span> === <span class="hljs-literal">true</span>;
</code></pre>
<hr/>
<h3 data-id="heading-12">ä¸‰ã€æœ€ç»ˆå±å®³ç‚¹ï¼ˆä¸šåŠ¡é€»è¾‘è¢«ç»•è¿‡ï¼‰</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> userInfo = {};
<span class="hljs-keyword">if</span> (userInfo.<span class="hljs-property">isAdmin</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä½ æ˜¯ç®¡ç†å‘˜'</span>);
}
</code></pre>
<p>ğŸš¨ <strong>è¿™æ˜¯ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´</strong> åœ¨çœŸå®ç³»ç»Ÿä¸­ï¼Œå¯èƒ½å¯¼è‡´ï¼š</p>
<ul>
<li>åå°æƒé™è·å–</li>
<li>åŠŸèƒ½è¶Šæƒ</li>
<li>å®‰å…¨æ ¡éªŒå…¨éƒ¨å¤±æ•ˆ</li>
</ul>
<hr/>
<h3 data-id="heading-13">å››ã€ä¸ºä»€ä¹ˆè¿™æ˜¯â€œé«˜å±æ¼æ´â€ï¼Ÿ</h3>

























<table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>è¯´æ˜</strong></th></tr></thead><tbody><tr><td>åˆ©ç”¨é—¨æ§›</td><td>ä½ï¼ˆURL / postMessage å³å¯ï¼‰</td></tr><tr><td>å½±å“èŒƒå›´</td><td>å…¨å±€ï¼ˆæ±¡æŸ“ Object.prototypeï¼‰</td></tr><tr><td>éšè”½æ€§</td><td>é«˜ï¼ˆè°ƒè¯•å¾ˆéš¾å‘ç°ï¼‰</td></tr><tr><td>å¸¸è§åº¦</td><td>éå¸¸é«˜ï¼ˆdeepMerge / lodash.mergeï¼‰</td></tr></tbody></table>
<p>ğŸ‘‰ å·²å¤šæ¬¡å‡ºç°åœ¨çœŸå® CVE (Common Vulnerabilities and Exposures) ä¸­ã€‚</p>
<hr/>
<h3 data-id="heading-14">äº”ã€æ­£ç¡®çš„ä¿®å¤æ–¹å¼ âœ…</h3>
<h4 data-id="heading-15">âœ… 1. ä¸¥æ ¼è¿‡æ»¤å±é™© keyï¼ˆå¿…é¡»ï¼‰</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> blockedKeys = [<span class="hljs-string">'__proto__'</span>, <span class="hljs-string">'prototype'</span>, <span class="hljs-string">'constructor'</span>];

<span class="hljs-keyword">function</span> <span class="hljs-title function_">safeDeepMerge</span>(<span class="hljs-params">target, source</span>) {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(source)) {
    <span class="hljs-keyword">if</span> (blockedKeys.<span class="hljs-title function_">includes</span>(key)) <span class="hljs-keyword">continue</span>;

    <span class="hljs-keyword">if</span> (
      <span class="hljs-keyword">typeof</span> source[key] === <span class="hljs-string">'object'</span> &amp;&amp;
      source[key] !== <span class="hljs-literal">null</span> &amp;&amp;
      !<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(source[key])
    ) {
      <span class="hljs-keyword">if</span> (!target[key]) target[key] = {};
      <span class="hljs-title function_">safeDeepMerge</span>(target[key], source[key]);
    } <span class="hljs-keyword">else</span> {
      target[key] = source[key];
    }
  }
}
</code></pre>
<hr/>
<h4 data-id="heading-16">âœ… 2. postMessage å¿…é¡»æ ¡éªŒæ¥æº</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">origin</span> !== <span class="hljs-string">'https://trusted.com'</span>) <span class="hljs-keyword">return</span>;
  <span class="hljs-title function_">safeDeepMerge</span>(config, e.<span class="hljs-property">data</span>);
});
</code></pre>
<hr/>
<h4 data-id="heading-17">âœ… 3. qs ä½¿ç”¨å®‰å…¨æ¨¡å¼</h4>
<pre><code class="hljs language-js" lang="js">qs.<span class="hljs-title function_">parse</span>(location.<span class="hljs-property">search</span>, {
  <span class="hljs-attr">allowPrototypes</span>: <span class="hljs-literal">false</span>
});
</code></pre>
<p>âš ï¸ <strong>é»˜è®¤ qs æ˜¯å±é™©çš„ï¼ˆæ—§ç‰ˆæœ¬å°¤å…¶ï¼‰</strong></p>
<hr/>
<h4 data-id="heading-18">âœ… 4. ä½¿ç”¨æˆç†Ÿåº“</h4>
<p>å¦‚ URLSearchParams</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> params = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">fromEntries</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">URLSearchParams</span>(location.<span class="hljs-property">search</span>));
</code></pre>
<h4 data-id="heading-19">âœ… 5. é˜²å¾¡æ€§ç¼–ç¨‹ï¼ˆæ¨èï¼‰</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> userInfo = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-literal">null</span>);
</code></pre>
<p>æˆ–</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">if</span> (<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">hasOwnProperty</span>.<span class="hljs-title function_">call</span>(userInfo, <span class="hljs-string">'isAdmin'</span>)) {
  ...
}
</code></pre>
<hr/>
<h2 data-id="heading-20">ä¸ºä»€ä¹ˆå®ƒæ˜¯â€œå®‰å…¨æ¼æ´â€è€Œä¸æ˜¯ Bugï¼Ÿ</h2>
<p>å› ä¸ºå®ƒä¼šå¯¼è‡´ï¼š</p>





























<table><thead><tr><th><strong>åæœ</strong></th><th><strong>ç¤ºä¾‹</strong></th></tr></thead><tbody><tr><td>æƒé™ç»•è¿‡</td><td>if (user.isAdmin)</td></tr><tr><td>é€»è¾‘ç¯¡æ”¹</td><td>if (config.debug)</td></tr><tr><td>RCEï¼ˆNodeï¼‰</td><td>ä¸ eval / child_process ç»“åˆ</td></tr><tr><td>XSS</td><td>æ¨¡æ¿æ¸²æŸ“ã€é…ç½®æ‹¼æ¥</td></tr><tr><td>DoS</td><td>JSON stringify / é€’å½’å´©æºƒ</td></tr></tbody></table>
<p>ğŸ‘‰ <strong>å½±å“æ˜¯â€œå…¨å±€çš„ã€éšå¼çš„ã€æŒä¹…çš„â€</strong></p>
<hr/>
<h2 data-id="heading-21">çœŸå®ä¸–ç•Œä¸­çš„ CVE (Common Vulnerabilities and Exposures)</h2>





























<table><thead><tr><th><strong>åº“</strong></th><th><strong>CVE</strong></th></tr></thead><tbody><tr><td>lodash.merge</td><td>CVE-2019-10744</td></tr><tr><td>jQuery.extend</td><td>CVE-2019-11358</td></tr><tr><td>minimist</td><td>CVE-2020-7598</td></tr><tr><td>yargs</td><td>CVE-2020-7608</td></tr><tr><td>qs</td><td>å¤šæ¬¡</td></tr></tbody></table>
<p>ğŸ“Œ <strong>è¿™ä¸æ˜¯â€œç†è®ºæ¼æ´â€ï¼Œè€Œæ˜¯â€œè¢«æ‰“çƒ‚çš„æ¼æ´ç±»å‹â€</strong></p>
<hr/>
<h2 data-id="heading-22">å¦‚ä½•åˆ¤æ–­ä½ çš„ä»£ç æ˜¯å¦æœ‰åŸå‹æ±¡æŸ“ï¼Ÿ</h2>
<h3 data-id="heading-23">ğŸ” è‡ªæŸ¥ checklist</h3>
<ul>
<li>æ˜¯å¦æŠŠ <strong>ç”¨æˆ·è¾“å…¥</strong> merge åˆ°å¯¹è±¡ï¼Ÿ</li>
<li>æ˜¯å¦ä½¿ç”¨ <code>for...in</code>ï¼Ÿ</li>
<li>æ˜¯å¦é€’å½’æ‹·è´å¯¹è±¡ï¼Ÿ</li>
<li>æ˜¯å¦ä¿¡ä»» <code>qs.parse</code> / JSONï¼Ÿ</li>
<li>æ˜¯å¦å­˜åœ¨ <code>obj[key] = value</code>ï¼Œä¸” <code>key</code> æ¥è‡ªå¤–éƒ¨ï¼Ÿ</li>
</ul>
<p>å¦‚æœæœ‰ 2 æ¡ä»¥ä¸Šï¼Œ<strong>é«˜é£é™©</strong>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[React æ€§èƒ½ä¼˜åŒ–åˆ©å™¨ï¼šæ·±å…¥ç†è§£ useMemo ä¸ useCallback]]></title>    <link>https://juejin.cn/post/7591708519449100297</link>    <guid>https://juejin.cn/post/7591708519449100297</guid>    <pubDate>2026-01-05T14:32:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591708519449100297" data-draft-id="7591719013488230438" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="React æ€§èƒ½ä¼˜åŒ–åˆ©å™¨ï¼šæ·±å…¥ç†è§£ useMemo ä¸ useCallback"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•,React.js"/> <meta itemprop="datePublished" content="2026-01-05T14:32:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Yira"/> <meta itemprop="url" content="https://juejin.cn/user/262123324974122"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            React æ€§èƒ½ä¼˜åŒ–åˆ©å™¨ï¼šæ·±å…¥ç†è§£ useMemo ä¸ useCallback
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/262123324974122/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Yira
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-05T14:32:05.000Z" title="Mon Jan 05 2026 14:32:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">React æ€§èƒ½ä¼˜åŒ–åˆ©å™¨ï¼šæ·±å…¥ç†è§£Â <code>useMemo</code>Â ä¸Â <code>useCallback</code></h2>
<p>åœ¨ React åº”ç”¨å¼€å‘ä¸­ï¼Œéšç€ç»„ä»¶å¤æ‚åº¦çš„æå‡ï¼Œæ€§èƒ½é—®é¢˜é€æ¸æ˜¾ç°ã€‚å³ä½¿çŠ¶æ€æ›´æ–°åªå½±å“å±€éƒ¨ UIï¼Œæ•´ä¸ªç»„ä»¶å‡½æ•°ä¹Ÿä¼šé‡æ–°æ‰§è¡Œï¼Œå¯¼è‡´ä¸å¿…è¦çš„è®¡ç®—æˆ–å­ç»„ä»¶é‡æ¸²æŸ“ã€‚ä¸ºè§£å†³è¿™äº›é—®é¢˜ï¼ŒReact æä¾›äº†ä¸¤ä¸ªå…³é”®çš„æ€§èƒ½ä¼˜åŒ– Hookï¼š<strong><code>useMemo</code></strong> å’Œ <strong><code>useCallback</code></strong>ã€‚å®ƒä»¬è™½å°ï¼Œå´èƒ½åœ¨å…³é”®æ—¶åˆ»æ˜¾è‘—æå‡åº”ç”¨æ€§èƒ½ä¸ç”¨æˆ·ä½“éªŒã€‚</p>
<p>æœ¬æ–‡å°†ç»“åˆå…·ä½“ä»£ç ç¤ºä¾‹ï¼Œæ·±å…¥å‰–æè¿™ä¸¤ä¸ª Hook çš„åŸç†ã€ä½¿ç”¨åœºæ™¯åŠæœ€ä½³å®è·µã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦æ€§èƒ½ä¼˜åŒ–ï¼Ÿ</h3>
<p>React çš„æ ¸å¿ƒç†å¿µæ˜¯â€œ<strong>çŠ¶æ€é©±åŠ¨è§†å›¾</strong>â€ã€‚å½“ç»„ä»¶çš„çŠ¶æ€ï¼ˆstateï¼‰æˆ–å±æ€§ï¼ˆpropsï¼‰å‘ç”Ÿå˜åŒ–æ—¶ï¼Œç»„ä»¶å‡½æ•°ä¼šé‡æ–°æ‰§è¡Œï¼Œç”Ÿæˆæ–°çš„ JSXã€‚è¿™ç§æœºåˆ¶ç®€æ´é«˜æ•ˆï¼Œä½†ä¹Ÿå¸¦æ¥æ½œåœ¨æ€§èƒ½éšæ‚£ï¼š</p>
<ul>
<li><strong>æ˜‚è´µçš„è®¡ç®—é‡å¤æ‰§è¡Œ</strong>ï¼šå¦‚è¿‡æ»¤å¤§é‡æ•°æ®ã€å¤æ‚æ•°å­¦è¿ç®—ç­‰ã€‚</li>
<li><strong>å­ç»„ä»¶æ— è°“é‡æ¸²æŸ“</strong>ï¼šå³ä½¿ props æœªå˜ï¼Œçˆ¶ç»„ä»¶æ›´æ–°ä»ä¼šè§¦å‘å­ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚</li>
</ul>
<p>è‹¥ä¸åŠ ä»¥æ§åˆ¶ï¼Œè¿™äº›å†—ä½™æ“ä½œä¼šæ‹–æ…¢åº”ç”¨å“åº”é€Ÿåº¦ï¼Œå°¤å…¶åœ¨ä½ç«¯è®¾å¤‡æˆ–å¤§å‹åˆ—è¡¨åœºæ™¯ä¸‹æ›´ä¸ºæ˜æ˜¾ã€‚</p>
<hr/>
<h3 data-id="heading-2">äºŒã€<code>useMemo</code>ï¼šç¼“å­˜è®¡ç®—ç»“æœ</h3>
<h4 data-id="heading-3">1. é—®é¢˜åœºæ™¯</h4>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ°´æœåˆ—è¡¨ï¼Œå¹¶æ ¹æ®ç”¨æˆ·è¾“å…¥çš„å…³é”®è¯è¿›è¡Œè¿‡æ»¤ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">list</span> = [<span class="hljs-string">'apple'</span>, <span class="hljs-string">'orange'</span>, <span class="hljs-string">'peach'</span>]<span class="hljs-comment">;</span>
const <span class="hljs-section">[keyword, setKeyword]</span> = useState('')<span class="hljs-comment">;</span>
const <span class="hljs-attr">filterList</span> = list.filter(item =&gt; item.includes(keyword))<span class="hljs-comment">;</span>
</code></pre>
<p>è¡¨é¢çœ‹æ²¡é—®é¢˜ï¼Œä½†è‹¥ç»„ä»¶ä¸­è¿˜æœ‰å¦ä¸€ä¸ªæ— å…³çŠ¶æ€ï¼ˆå¦‚ <code>count</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">const <span class="hljs-selector-attr">[count, setCount]</span> = <span class="hljs-built_in">useState</span>(<span class="hljs-number">0</span>);
</code></pre>
<p>å½“ç‚¹å‡»â€œ+1â€æŒ‰é’®æ›´æ–° <code>count</code> æ—¶ï¼Œæ•´ä¸ª <code>App</code> ç»„ä»¶é‡æ–°è¿è¡Œï¼Œ<code>filterList</code> ä¹Ÿä¼šè¢«é‡æ–°è®¡ç®—â€”â€”<strong>å°½ç®¡ <code>keyword</code> å¹¶æœªæ”¹å˜</strong>ï¼è¿™ä¸ä»…æµªè´¹ CPU èµ„æºï¼Œè¿˜å¯èƒ½å¼•å‘è§†è§‰é—ªçƒç­‰é—®é¢˜ã€‚</p>
<h4 data-id="heading-4">2.Â <code>useMemo</code>Â çš„è§£å†³æ–¹æ¡ˆ</h4>
<p><code>useMemo</code> å…è®¸æˆ‘ä»¬å°†<strong>è®¡ç®—è¿‡ç¨‹ç¼“å­˜èµ·æ¥</strong>ï¼Œä»…åœ¨ä¾èµ–é¡¹å˜åŒ–æ—¶æ‰é‡æ–°è®¡ç®—ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">filterList</span> = useMemo(() =&gt; {
  console.log('filter æ‰§è¡Œäº†')<span class="hljs-comment">;</span>
  return list.filter(<span class="hljs-attr">item</span> =&gt; item.includes(keyword))<span class="hljs-comment">;</span>
}, <span class="hljs-section">[keyword]</span>)<span class="hljs-comment">; // ä»…å½“ keyword å˜åŒ–æ—¶é‡æ–°è®¡ç®—</span>
</code></pre>
<blockquote>
<p>âœ… <strong>å…³é”®ç‚¹</strong>ï¼šç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¾èµ–æ•°ç»„ã€‚åªæœ‰æ•°ç»„ä¸­çš„å€¼å‘ç”Ÿå˜åŒ–ï¼Œæ‰ä¼šè§¦å‘é‡æ–°è®¡ç®—ã€‚</p>
</blockquote>
<h4 data-id="heading-5">3. å¤„ç†æ˜‚è´µè®¡ç®—</h4>
<p>å¯¹äºæ›´å¤æ‚çš„åœºæ™¯ï¼Œæ¯”å¦‚è®¡ç®—å¤§æ•°ç´¯åŠ ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">function slowSum(n) {
  let <span class="hljs-attr">sum</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
  for (let <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; n * 1000000; i++) {</span>
    sum += i<span class="hljs-comment">;</span>
  }
  return sum<span class="hljs-comment">;</span>
}
</code></pre>
<p>è‹¥ç›´æ¥è°ƒç”¨ <code>slowSum(num)</code>ï¼Œæ¯æ¬¡ç»„ä»¶æ›´æ–°éƒ½ä¼šå¡é¡¿ã€‚ä½¿ç”¨ <code>useMemo</code> å¯æœ‰æ•ˆé¿å…ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">const result = <span class="hljs-built_in">useMemo</span>(() =&gt; <span class="hljs-built_in">slowSum</span>(num), <span class="hljs-selector-attr">[num]</span>);
</code></pre>
<p>è¿™æ ·ï¼Œåªæœ‰ <code>num</code> æ”¹å˜æ—¶æ‰ä¼šæ‰§è¡Œè€—æ—¶è¿ç®—ï¼Œæå¤§æå‡æµç•…åº¦ã€‚</p>
<h4 data-id="heading-6">4. æ³¨æ„äº‹é¡¹</h4>
<ul>
<li><strong>ä¸è¦æ»¥ç”¨</strong>ï¼šç®€å•è®¡ç®—ï¼ˆå¦‚Â <code>a + b</code>ï¼‰æ— éœ€Â <code>useMemo</code>ï¼Œåè€Œå¢åŠ å†…å­˜å¼€é”€ã€‚</li>
<li><strong>ä¾èµ–é¡¹å¿…é¡»å®Œæ•´</strong>ï¼šé—æ¼ä¾èµ–ä¼šå¯¼è‡´ä½¿ç”¨è¿‡æœŸå€¼ã€‚</li>
<li><strong><code>includes("")</code>Â è¿”å› true</strong>ï¼šç©ºå­—ç¬¦ä¸²åŒ¹é…æ‰€æœ‰é¡¹ï¼Œéœ€é¢å¤–å¤„ç†è¾¹ç•Œæƒ…å†µï¼ˆå¦‚Â <code>keyword.trim()</code>ï¼‰ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-7">ä¸‰ã€<code>useCallback</code>ï¼šç¼“å­˜å‡½æ•°å¼•ç”¨</h3>
<h4 data-id="heading-8">1. å­ç»„ä»¶é‡æ¸²æŸ“é—®é¢˜</h4>
<p>è€ƒè™‘ä»¥ä¸‹çˆ¶å­ç»„ä»¶ç»“æ„ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// çˆ¶ç»„ä»¶</span>
<span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);
<span class="hljs-keyword">const</span> [num, setNum] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'click'</span>);
};

<span class="hljs-keyword">return</span> (
  <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count + 1)}&gt;count +1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Child</span> <span class="hljs-attr">count</span>=<span class="hljs-string">{count}</span> <span class="hljs-attr">handleClick</span>=<span class="hljs-string">{handleClick}</span> /&gt;</span>
  <span class="hljs-tag">&lt;/&gt;</span></span>
);
</code></pre>
<p>æ¯æ¬¡çˆ¶ç»„ä»¶æ›´æ–°ï¼ˆå¦‚ä¿®æ”¹ <code>num</code>ï¼‰ï¼Œ<code>handleClick</code> éƒ½ä¼š<strong>é‡æ–°åˆ›å»ºä¸€ä¸ªæ–°å‡½æ•°</strong>ã€‚å³ä½¿ <code>count</code> æ²¡å˜ï¼Œ<code>Child</code> ç»„ä»¶å› æ¥æ”¶åˆ°æ–°çš„ <code>handleClick</code> å¼•ç”¨ï¼Œä¹Ÿä¼šè¢«å¼ºåˆ¶é‡æ¸²æŸ“ã€‚</p>
<h4 data-id="heading-9">2.Â <code>memo</code>Â +Â <code>useCallback</code>Â çš„ç»„åˆæ‹³</h4>
<h5 data-id="heading-10">æ­¥éª¤ä¸€ï¼šç”¨Â <code>memo</code>Â åŒ…è£¹å­ç»„ä»¶</h5>
<p><code>memo</code> æ˜¯ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰ï¼Œå®ƒä¼šå¯¹ props è¿›è¡Œæµ…æ¯”è¾ƒã€‚è‹¥ props æœªå˜ï¼Œåˆ™è·³è¿‡æ¸²æŸ“ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Child</span> = <span class="hljs-title function_">memo</span>(<span class="hljs-function">(<span class="hljs-params">{ count, handleClick }</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Child é‡æ–°æ¸²æŸ“'</span>);
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>&gt;</span>å­ç»„ä»¶ {count}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
});
</code></pre>
<h5 data-id="heading-11">æ­¥éª¤äºŒï¼šç”¨Â <code>useCallback</code>Â ç¼“å­˜å›è°ƒå‡½æ•°</h5>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">handleClick</span> = useCallback(() =&gt; {
  console.log('click')<span class="hljs-comment">;</span>
}, <span class="hljs-section">[]</span>)<span class="hljs-comment">; // æ— ä¾èµ–ï¼Œå‡½æ•°å¼•ç”¨æ°¸ä¹…ä¸å˜</span>
</code></pre>
<p>ç°åœ¨ï¼Œåªæœ‰å½“ <code>count</code> æ”¹å˜æ—¶ï¼Œ<code>Child</code> æ‰ä¼šæ›´æ–°ï¼›ä¿®æ”¹ <code>num</code> ä¸å†è§¦å‘å­ç»„ä»¶é‡æ¸²æŸ“ã€‚</p>
<h4 data-id="heading-12">3. ä¾èµ–é¡¹çš„æ­£ç¡®ä½¿ç”¨</h4>
<p>è‹¥å›è°ƒå‡½æ•°ä¾èµ–æŸä¸ªçŠ¶æ€ï¼Œå¿…é¡»å°†å…¶åŠ å…¥ä¾èµ–æ•°ç»„ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">handleClick</span> = useCallback(() =&gt; {
  console.log('å½“å‰ count:', count)<span class="hljs-comment">;</span>
}, <span class="hljs-section">[count]</span>)<span class="hljs-comment">; // ä¾èµ– count</span>
</code></pre>
<p>å¦åˆ™ï¼Œå‡½æ•°å†…éƒ¨ä¼šæ•è·æ—§çš„ <code>count</code> å€¼ï¼ˆé—­åŒ…é™·é˜±ï¼‰ã€‚</p>
<blockquote>
<p>ğŸ’¡ <strong>è®¾è®¡å“²å­¦</strong>ï¼šReact çš„æ•°æ®æµæ˜¯â€œçˆ¶ç®¡çŠ¶æ€ï¼Œå­ç®¡å±•ç¤ºâ€ã€‚é€šè¿‡ <code>memo</code> + <code>useCallback</code>ï¼Œæˆ‘ä»¬ç¡®ä¿å­ç»„ä»¶ä»…åœ¨å¿…è¦æ—¶æ›´æ–°ï¼Œç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-13">å››ã€<code>useMemo</code>Â vsÂ <code>useCallback</code>ï¼šæœ¬è´¨åŒºåˆ«</h3>
<p>è™½ç„¶ä¸¤è€…éƒ½ç”¨äºç¼“å­˜ï¼Œä½†ç”¨é€”ä¸åŒï¼š</p>




















<table><thead><tr><th>Hook</th><th>ç”¨é€”</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td><code>useMemo</code></td><td>ç¼“å­˜<strong>è®¡ç®—ç»“æœ</strong></td><td>å€¼ï¼ˆå¦‚æ•°ç»„ã€å¯¹è±¡ã€æ•°å­—ï¼‰</td></tr><tr><td><code>useCallback</code></td><td>ç¼“å­˜<strong>å‡½æ•°å¼•ç”¨</strong></td><td>å‡½æ•°</td></tr></tbody></table>
<p>å®é™…ä¸Šï¼Œ<code>useCallback(fn, deps)</code> ç­‰ä»·äº <code>useMemo(() =&gt; fn, deps)</code>ã€‚ä½†è¯­ä¹‰ä¸Šï¼Œ<code>useCallback</code> æ›´æ¸…æ™°è¡¨è¾¾â€œè¿™æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°â€ã€‚</p>
<hr/>
<h3 data-id="heading-14">äº”ã€ä½•æ—¶ä½¿ç”¨ï¼Ÿä½•æ—¶é¿å…ï¼Ÿ</h3>
<h4 data-id="heading-15">æ¨èä½¿ç”¨åœºæ™¯ï¼š</h4>
<ul>
<li>
<p><strong><code>useMemo</code></strong>ï¼š</p>
<ul>
<li>è¿‡æ»¤/æ’åºå¤§å‹åˆ—è¡¨ï¼›</li>
<li>å¤æ‚æ•°å­¦æˆ–é€»è¾‘è®¡ç®—ï¼›</li>
<li>åˆ›å»ºä¸å¯å˜å¯¹è±¡ï¼ˆå¦‚Â <code>{ ... }</code>ï¼‰ä¼ é€’ç»™å­ç»„ä»¶ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>useCallback</code></strong>ï¼š</p>
<ul>
<li>ä¼ é€’ç»™Â <code>memo</code>Â åŒ…è£¹çš„å­ç»„ä»¶çš„äº‹ä»¶å¤„ç†å™¨ï¼›</li>
<li>ä½œä¸ºÂ <code>useEffect</code>Â çš„ä¾èµ–é¡¹ï¼ˆé¿å…æ— é™å¾ªç¯ï¼‰ï¼›</li>
<li>ä¼ é€’ç»™ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚Â <code>react-window</code>Â çš„Â <code>itemData</code>ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-16">é¿å…æ»¥ç”¨ï¼š</h4>
<ul>
<li>ç®€å•ç»„ä»¶æ— éœ€ä¼˜åŒ–ï¼›</li>
<li>è¿‡åº¦ä½¿ç”¨ä¼šå¢åŠ å†…å­˜å ç”¨å’Œä»£ç å¤æ‚åº¦ï¼›</li>
<li>å…ˆç”¨æ€§èƒ½åˆ†æå·¥å…·ï¼ˆå¦‚ React DevTools Profilerï¼‰å®šä½ç“¶é¢ˆï¼Œå†é’ˆå¯¹æ€§ä¼˜åŒ–ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-17">å…­ã€æ€»ç»“</h3>
<p><code>useMemo</code> å’Œ <code>useCallback</code> æ˜¯ React æ€§èƒ½ä¼˜åŒ–çš„é‡è¦å·¥å…·ï¼Œå®ƒä»¬é€šè¿‡<strong>ç¼“å­˜æœºåˆ¶</strong>å‡å°‘ä¸å¿…è¦çš„è®¡ç®—ä¸æ¸²æŸ“ï¼š</p>
<ul>
<li><strong><code>useMemo</code></strong>Â è§£å†³â€œé‡å¤è®¡ç®—â€é—®é¢˜ï¼Œé€‚ç”¨äºæ´¾ç”Ÿæ•°æ®ï¼›</li>
<li><strong><code>useCallback</code></strong>Â è§£å†³â€œå‡½æ•°å¼•ç”¨å˜åŒ–â€é—®é¢˜ï¼Œå¸¸ä¸Â <code>memo</code>Â é…åˆä½¿ç”¨ï¼Œé˜²æ­¢å­ç»„ä»¶æ— è°“æ›´æ–°ã€‚</li>
</ul>
<p>æŒæ¡å®ƒä»¬çš„å…³é”®åœ¨äºç†è§£ <strong>â€œä¾èµ–é¡¹â€</strong> çš„ä½œç”¨ï¼š<strong>åªæœ‰ä¾èµ–å˜åŒ–æ—¶ï¼Œæ‰é‡æ–°è®¡ç®—æˆ–ç”Ÿæˆæ–°å‡½æ•°</strong>ã€‚åˆç†ä½¿ç”¨è¿™ä¸¤ä¸ª Hookï¼Œä¸ä»…èƒ½æå‡åº”ç”¨æ€§èƒ½ï¼Œè¿˜èƒ½å†™å‡ºæ›´æ¸…æ™°ã€å¯ç»´æŠ¤çš„ä»£ç ã€‚</p>
<p>è®°ä½ï¼š<strong>ä¼˜åŒ–ä¸æ˜¯ç›®çš„ï¼Œè€Œæ˜¯æ‰‹æ®µ</strong>ã€‚åœ¨ä¿è¯åŠŸèƒ½æ­£ç¡®çš„å‰æä¸‹ï¼Œé’ˆå¯¹çœŸå®æ€§èƒ½ç“¶é¢ˆè¿›è¡Œç²¾å‡†ä¼˜åŒ–ï¼Œæ‰æ˜¯å·¥ç¨‹åŒ–çš„æœ€ä½³å®è·µã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœ¨ Vue ä¸­ä¿å­˜é¡µé¢çŠ¶æ€çš„å®Œæ•´æŒ‡å—ï¼šè®©ç”¨æˆ·æ°¸è¿œä¸ä¸¢å¤±è¿›åº¦]]></title>    <link>https://juejin.cn/post/7591728734982963227</link>    <guid>https://juejin.cn/post/7591728734982963227</guid>    <pubDate>2026-01-05T15:05:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591728734982963227" data-draft-id="7591713442399322121" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœ¨ Vue ä¸­ä¿å­˜é¡µé¢çŠ¶æ€çš„å®Œæ•´æŒ‡å—ï¼šè®©ç”¨æˆ·æ°¸è¿œä¸ä¸¢å¤±è¿›åº¦"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2026-01-05T15:05:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åŒ—è¾°alk"/> <meta itemprop="url" content="https://juejin.cn/user/1772855673241352"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœ¨ Vue ä¸­ä¿å­˜é¡µé¢çŠ¶æ€çš„å®Œæ•´æŒ‡å—ï¼šè®©ç”¨æˆ·æ°¸è¿œä¸ä¸¢å¤±è¿›åº¦
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1772855673241352/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åŒ—è¾°alk
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-05T15:05:57.000Z" title="Mon Jan 05 2026 15:05:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€ï¼šä¸ºä»€ä¹ˆéœ€è¦ä¿å­˜é¡µé¢çŠ¶æ€ï¼Ÿ</h2>
<p>ä½œä¸ºå‰ç«¯å¼€å‘è€…ï¼Œä½ ä¸€å®šé‡åˆ°è¿‡è¿™æ ·çš„åœºæ™¯ï¼šç”¨æˆ·åœ¨ä¸€ä¸ªå¤æ‚çš„è¡¨å•é¡µé¢å¡«å†™äº†å¤§é‡ä¿¡æ¯ï¼Œä¸å°å¿ƒåˆ·æ–°äº†é¡µé¢æˆ–ç‚¹å‡»äº†è¿”å›æŒ‰é’®ï¼Œæ‰€æœ‰æ•°æ®éƒ½æ¶ˆå¤±äº†ï¼ç”¨æˆ·åªèƒ½æ— å¥ˆåœ°é‡æ–°å¡«å†™...</p>
<p><strong>ä¿å­˜é¡µé¢çŠ¶æ€ä¸ä»…ä»…æ˜¯æŠ€æœ¯éœ€æ±‚ï¼Œæ›´æ˜¯æå‡ç”¨æˆ·ä½“éªŒçš„å…³é”®</strong>ã€‚ä»Šå¤©æˆ‘ä»¬æ¥æ·±å…¥æ¢è®¨åœ¨ Vue ä¸­å®ç°é¡µé¢çŠ¶æ€ä¿å­˜çš„å„ç§æ–¹æ³•ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€åº”ç”¨åœºæ™¯åˆ†æ</h2>
<p>åœ¨æˆ‘ä»¬å¼€å§‹æŠ€æœ¯å®ç°ä¹‹å‰ï¼Œå…ˆçœ‹çœ‹å“ªäº›åœºæ™¯éœ€è¦çŠ¶æ€ä¿å­˜ï¼š</p>
<ol>
<li>1.Â <strong>å¤æ‚è¡¨å•é¡µé¢</strong>ï¼šç”¨æˆ·å¡«å†™äº†ä¸€åŠçš„è¡¨å•</li>
<li>2.Â <strong>æ•°æ®ç­›é€‰é¡µé¢</strong>ï¼šç”¨æˆ·è®¾ç½®äº†å¤æ‚çš„ç­›é€‰æ¡ä»¶</li>
<li>3.Â <strong>åˆ†é¡µåˆ—è¡¨</strong>ï¼šç”¨æˆ·æµè§ˆåˆ°ç¬¬5é¡µï¼Œè¿”å›åå¸Œæœ›è¿˜åœ¨ç¬¬5é¡µ</li>
<li>4.Â <strong>å¤šæ­¥éª¤æµç¨‹</strong>ï¼šè´­ç‰©è½¦ç»“ç®—æµç¨‹ã€æ³¨å†Œæµç¨‹</li>
<li>5.Â <strong>ç”¨æˆ·åå¥½è®¾ç½®</strong>ï¼šä¸»é¢˜ã€è¯­è¨€ã€å¸ƒå±€ç­‰</li>
</ol>
<h2 data-id="heading-2">äºŒã€æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”</h2>
<h3 data-id="heading-3">æ–¹æ¡ˆå¯¹æ¯”æµç¨‹å›¾</h3>
<pre><code class="hljs">å°‘é‡ç®€å•æ•°æ®

å¤§é‡å¤æ‚æ•°æ®

ä¸´æ—¶ä¼šè¯æ•°æ®

éœ€è¦æœåŠ¡ç«¯åŒæ­¥

éœ€è¦ä¿å­˜é¡µé¢çŠ¶æ€æ•°æ®ç‰¹ç‚¹LocalStorageVuex/Pinia + æŒä¹…åŒ–SessionStorageIndexedDB + åç«¯APIåˆ·æ–°/å…³é—­åä»å­˜åœ¨å…¨å±€çŠ¶æ€ç®¡ç†ä»…å½“å‰ä¼šè¯ç¦»çº¿å¯ç”¨
</code></pre>
<h2 data-id="heading-4">ä¸‰ã€å…·ä½“å®ç°æ–¹æ³•</h2>
<h3 data-id="heading-5">æ–¹æ³•1ï¼šä½¿ç”¨ localStorage ä¿å­˜ç®€å•çŠ¶æ€</h3>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šæ•°æ®é‡å°ã€ç»“æ„ç®€å•çš„çŠ¶æ€ä¿å­˜</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>ç”¨æˆ·ä¿¡æ¯è¡¨å•<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">form</span>Â @<span class="hljs-attr">submit.prevent</span>=<span class="hljs-string">"handleSubmit"</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>å§“åï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">input</span>Â 
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">v-model</span>=<span class="hljs-string">"formData.name"</span>Â 
Â Â Â Â Â Â Â Â Â Â @<span class="hljs-attr">input</span>=<span class="hljs-string">"saveToLocalStorage"</span>
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥å§“å"</span>
Â Â Â Â Â Â Â Â /&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>é‚®ç®±ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">input</span>Â 
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">v-model</span>=<span class="hljs-string">"formData.email"</span>
Â Â Â Â Â Â Â Â Â Â @<span class="hljs-attr">input</span>=<span class="hljs-string">"saveToLocalStorage"</span>
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥é‚®ç®±"</span>
Â Â Â Â Â Â Â Â /&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>å¤‡æ³¨ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>Â 
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">v-model</span>=<span class="hljs-string">"formData.remarks"</span>
Â Â Â Â Â Â Â Â Â Â @<span class="hljs-attr">input</span>=<span class="hljs-string">"saveToLocalStorage"</span>
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥å¤‡æ³¨ä¿¡æ¯"</span>
Â Â Â Â Â Â Â Â &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">button</span>Â <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>æäº¤<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">button</span>Â <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span>Â @<span class="hljs-attr">click</span>=<span class="hljs-string">"clearStorage"</span>&gt;</span>æ¸…é™¤ç¼“å­˜<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â {
Â Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'UserForm'</span>,
Â Â <span class="hljs-title function_">data</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â {
Â Â Â Â Â Â <span class="hljs-attr">formData</span>:Â {
Â Â Â Â Â Â Â Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">''</span>,
Â Â Â Â Â Â Â Â <span class="hljs-attr">email</span>:Â <span class="hljs-string">''</span>,
Â Â Â Â Â Â Â Â <span class="hljs-attr">remarks</span>:Â <span class="hljs-string">''</span>
Â Â Â Â Â Â }
Â Â Â Â }
Â Â },
Â Â <span class="hljs-title function_">mounted</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-comment">//Â ç»„ä»¶åŠ è½½æ—¶ä»Â localStorageÂ æ¢å¤æ•°æ®</span>
Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">restoreFromLocalStorage</span>()
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â ç›‘å¬é¡µé¢å¸è½½äº‹ä»¶ï¼Œç¡®ä¿ç¦»å¼€å‰ä¿å­˜</span>
Â Â Â Â <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'beforeunload'</span>,Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveToLocalStorage</span>)
Â Â },
Â Â <span class="hljs-title function_">beforeDestroy</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-comment">//Â æ¸…ç†äº‹ä»¶ç›‘å¬</span>
Â Â Â Â <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'beforeunload'</span>,Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveToLocalStorage</span>)
Â Â },
Â Â <span class="hljs-attr">methods</span>:Â {
Â Â Â Â <span class="hljs-comment">//Â ä¿å­˜åˆ°Â localStorage</span>
Â Â Â Â <span class="hljs-title function_">saveToLocalStorage</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'userFormData'</span>,Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>))
Â Â Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•°æ®å·²ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨'</span>)
Â Â Â Â },
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â ä»Â localStorageÂ æ¢å¤</span>
Â Â Â Â <span class="hljs-title function_">restoreFromLocalStorage</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â savedDataÂ =Â <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'userFormData'</span>)
Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (savedData)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>Â =Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(savedData)
Â Â Â Â Â Â Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•°æ®å·²ä»æœ¬åœ°å­˜å‚¨æ¢å¤'</span>)
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (error)Â {
Â Â Â Â Â Â Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ¢å¤æ•°æ®å¤±è´¥:'</span>,Â error)
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â }
Â Â Â Â },
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â å¤„ç†è¡¨å•æäº¤</span>
Â Â Â Â <span class="hljs-title function_">handleSubmit</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æäº¤æ•°æ®:'</span>,Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>)
Â Â Â Â Â Â <span class="hljs-comment">//Â æäº¤æˆåŠŸåæ¸…é™¤ç¼“å­˜</span>
Â Â Â Â Â Â <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-string">'userFormData'</span>)
Â Â Â Â Â Â <span class="hljs-title function_">alert</span>(<span class="hljs-string">'æäº¤æˆåŠŸï¼æœ¬åœ°ç¼“å­˜å·²æ¸…é™¤ã€‚'</span>)
Â Â Â Â },
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â æ¸…é™¤ç¼“å­˜</span>
Â Â Â Â <span class="hljs-title function_">clearStorage</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-string">'userFormData'</span>)
Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>Â =Â {Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">''</span>,Â <span class="hljs-attr">email</span>:Â <span class="hljs-string">''</span>,Â <span class="hljs-attr">remarks</span>:Â <span class="hljs-string">''</span>Â }
Â Â Â Â Â Â <span class="hljs-title function_">alert</span>(<span class="hljs-string">'ç¼“å­˜å·²æ¸…é™¤'</span>)
Â Â Â Â }
Â Â }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 data-id="heading-6">æ–¹æ³•2ï¼šVuex + æŒä¹…åŒ–æ’ä»¶æ–¹æ¡ˆ</h3>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå¤§å‹åº”ç”¨ï¼Œéœ€è¦å…¨å±€çŠ¶æ€ç®¡ç†</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šå®‰è£…å¿…è¦ä¾èµ–</strong></p>
<pre><code class="hljs">npmÂ installÂ vuex-persistedstate
</code></pre>
<p><strong>ç¬¬äºŒæ­¥ï¼šåˆ›å»º Vuex Store å¹¶é…ç½®æŒä¹…åŒ–</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//Â store/index.js</span>
<span class="hljs-keyword">import</span>Â <span class="hljs-title class_">Vue</span>Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span>Â <span class="hljs-title class_">Vuex</span>Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'vuex'</span>
<span class="hljs-keyword">import</span>Â createPersistedStateÂ <span class="hljs-keyword">from</span>Â <span class="hljs-string">'vuex-persistedstate'</span>

<span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">Vuex</span>)

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Vuex</span>.<span class="hljs-title class_">Store</span>({
Â Â <span class="hljs-attr">state</span>:Â {
Â Â Â Â <span class="hljs-attr">userPreferences</span>:Â {
Â Â Â Â Â Â <span class="hljs-attr">theme</span>:Â <span class="hljs-string">'light'</span>,
Â Â Â Â Â Â <span class="hljs-attr">language</span>:Â <span class="hljs-string">'zh-CN'</span>,
Â Â Â Â Â Â <span class="hljs-attr">fontSize</span>:Â <span class="hljs-number">14</span>
Â Â Â Â },
Â Â Â Â <span class="hljs-attr">shoppingCart</span>:Â [],
Â Â Â Â <span class="hljs-attr">formStates</span>:Â {}Â <span class="hljs-comment">//Â å­˜å‚¨å„ä¸ªè¡¨å•çš„çŠ¶æ€</span>
Â Â },
Â Â 
Â Â <span class="hljs-attr">mutations</span>:Â {
Â Â Â Â <span class="hljs-title function_">SET_USER_PREFERENCE</span>(<span class="hljs-params">state,Â {Â key,Â valueÂ }</span>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (state.<span class="hljs-property">userPreferences</span>.<span class="hljs-title function_">hasOwnProperty</span>(key))Â {
Â Â Â Â Â Â Â Â state.<span class="hljs-property">userPreferences</span>[key]Â =Â value
Â Â Â Â Â Â }
Â Â Â Â },
Â Â Â Â 
Â Â Â Â <span class="hljs-title function_">ADD_TO_CART</span>(<span class="hljs-params">state,Â product</span>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â existingItemÂ =Â state.<span class="hljs-property">shoppingCart</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">item</span>Â =&gt;</span>Â item.<span class="hljs-property">id</span>Â ===Â product.<span class="hljs-property">id</span>)
Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (existingItem)Â {
Â Â Â Â Â Â Â Â existingItem.<span class="hljs-property">quantity</span>Â +=Â product.<span class="hljs-property">quantity</span>Â ||Â <span class="hljs-number">1</span>
Â Â Â Â Â Â }Â <span class="hljs-keyword">else</span>Â {
Â Â Â Â Â Â Â Â state.<span class="hljs-property">shoppingCart</span>.<span class="hljs-title function_">push</span>({Â ...product,Â <span class="hljs-attr">quantity</span>:Â product.<span class="hljs-property">quantity</span>Â ||Â <span class="hljs-number">1</span>Â })
Â Â Â Â Â Â }
Â Â Â Â },
Â Â Â Â 
Â Â Â Â <span class="hljs-title function_">SAVE_FORM_STATE</span>(<span class="hljs-params">state,Â {Â formId,Â dataÂ }</span>)Â {
Â Â Â Â Â Â state.<span class="hljs-property">formStates</span>[formId]Â =Â data
Â Â Â Â },
Â Â Â Â 
Â Â Â Â <span class="hljs-title function_">CLEAR_FORM_STATE</span>(<span class="hljs-params">state,Â formId</span>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (state.<span class="hljs-property">formStates</span>[formId])Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">delete</span>Â state.<span class="hljs-property">formStates</span>[formId]
Â Â Â Â Â Â }
Â Â Â Â }
Â Â },
Â Â 
Â Â <span class="hljs-attr">actions</span>:Â {
Â Â Â Â <span class="hljs-title function_">saveFormState</span>(<span class="hljs-params">{Â commitÂ },Â payload</span>)Â {
Â Â Â Â Â Â <span class="hljs-title function_">commit</span>(<span class="hljs-string">'SAVE_FORM_STATE'</span>,Â payload)
Â Â Â Â },
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â æ¸…é™¤è¿‡æœŸæ•°æ®ï¼ˆä¾‹å¦‚24å°æ—¶å‰çš„æ•°æ®ï¼‰</span>
Â Â Â Â <span class="hljs-title function_">clearExpiredStates</span>(<span class="hljs-params">{Â state,Â commitÂ }</span>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â nowÂ =Â <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â expirationTimeÂ =Â <span class="hljs-number">24</span>Â *Â <span class="hljs-number">60</span>Â *Â <span class="hljs-number">60</span>Â *Â <span class="hljs-number">1000</span>Â <span class="hljs-comment">//Â 24å°æ—¶</span>
Â Â Â Â Â Â 
Â Â Â Â Â Â <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(state.<span class="hljs-property">formStates</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">formId</span>Â =&gt;</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â formDataÂ =Â state.<span class="hljs-property">formStates</span>[formId]
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (formData.<span class="hljs-property">_timestamp</span>Â &amp;&amp;Â nowÂ -Â formData.<span class="hljs-property">_timestamp</span>Â &gt;Â expirationTime)Â {
Â Â Â Â Â Â Â Â Â Â <span class="hljs-title function_">commit</span>(<span class="hljs-string">'CLEAR_FORM_STATE'</span>,Â formId)
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â })
Â Â Â Â }
Â Â },
Â Â 
Â Â <span class="hljs-attr">getters</span>:Â {
Â Â Â Â <span class="hljs-attr">getFormState</span>:Â <span class="hljs-function">(<span class="hljs-params">state</span>)Â =&gt;</span>Â <span class="hljs-function">(<span class="hljs-params">formId</span>)Â =&gt;</span>Â {
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â state.<span class="hljs-property">formStates</span>[formId]Â ||Â <span class="hljs-literal">null</span>
Â Â Â Â },
Â Â Â Â 
Â Â Â Â <span class="hljs-attr">cartTotalItems</span>:Â <span class="hljs-function"><span class="hljs-params">state</span>Â =&gt;</span>Â {
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â state.<span class="hljs-property">shoppingCart</span>.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">total,Â item</span>)Â =&gt;</span>Â totalÂ +Â item.<span class="hljs-property">quantity</span>,Â <span class="hljs-number">0</span>)
Â Â Â Â }
Â Â },
Â Â 
Â Â <span class="hljs-attr">plugins</span>:Â [
Â Â Â Â <span class="hljs-title function_">createPersistedState</span>({
Â Â Â Â Â Â <span class="hljs-attr">key</span>:Â <span class="hljs-string">'vuex-app-state'</span>,
Â Â Â Â Â Â <span class="hljs-attr">paths</span>:Â [
Â Â Â Â Â Â Â Â <span class="hljs-string">'userPreferences'</span>,
Â Â Â Â Â Â Â Â <span class="hljs-string">'shoppingCart'</span>,
Â Â Â Â Â Â Â Â <span class="hljs-string">'formStates'</span>
Â Â Â Â Â Â ],
Â Â Â Â Â Â 
Â Â Â Â Â Â <span class="hljs-comment">//Â è‡ªå®šä¹‰å­˜å‚¨æ–¹å¼ï¼Œå¯ä»¥æ·»åŠ åŠ å¯†</span>
Â Â Â Â Â Â <span class="hljs-attr">storage</span>:Â {
Â Â Â Â Â Â Â Â <span class="hljs-attr">getItem</span>:Â <span class="hljs-function"><span class="hljs-params">key</span>Â =&gt;</span>Â {
Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â dataÂ =Â <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(key)
Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è¿™é‡Œå¯ä»¥æ·»åŠ è§£å¯†é€»è¾‘</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(data)
Â Â Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">null</span>
Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â },
Â Â Â Â Â Â Â Â <span class="hljs-attr">setItem</span>:Â <span class="hljs-function">(<span class="hljs-params">key,Â value</span>)Â =&gt;</span>Â {
Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è¿™é‡Œå¯ä»¥æ·»åŠ åŠ å¯†é€»è¾‘</span>
Â Â Â Â Â Â Â Â Â Â <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(key,Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value))
Â Â Â Â Â Â Â Â },
Â Â Â Â Â Â Â Â <span class="hljs-attr">removeItem</span>:Â <span class="hljs-function"><span class="hljs-params">key</span>Â =&gt;</span>Â <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(key)
Â Â Â Â Â Â },
Â Â Â Â Â Â 
Â Â Â Â Â Â <span class="hljs-comment">//Â æ•°æ®è¿‡æ»¤ï¼Œå¯ä»¥æ’é™¤ä¸éœ€è¦æŒä¹…åŒ–çš„æ•°æ®</span>
Â Â Â Â Â Â <span class="hljs-attr">reducer</span>:Â <span class="hljs-function">(<span class="hljs-params">state</span>)Â =&gt;</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â {Â formStates,Â ...restÂ }Â =Â state
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è¿‡æ»¤æ‰æ—¶é—´æˆ³å­—æ®µ</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â filteredFormStatesÂ =Â {}
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(formStates).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span>Â =&gt;</span>Â {
Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â {Â _timestamp,Â ...formDataÂ }Â =Â formStates[key]
Â Â Â Â Â Â Â Â Â Â filteredFormStates[key]Â =Â formData
Â Â Â Â Â Â Â Â })
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â {
Â Â Â Â Â Â Â Â Â Â ...rest,
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">formStates</span>:Â filteredFormStates
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â }
Â Â Â Â })
Â Â ]
})
</code></pre>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šåœ¨ç»„ä»¶ä¸­ä½¿ç”¨</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!--Â ProductList.vueÂ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>Â <span class="hljs-attr">class</span>=<span class="hljs-string">"product-list"</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>å•†å“åˆ—è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>Â <span class="hljs-attr">class</span>=<span class="hljs-string">"products"</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>Â 
Â Â Â Â Â Â Â Â <span class="hljs-attr">v-for</span>=<span class="hljs-string">"productÂ inÂ products"</span>Â 
Â Â Â Â Â Â Â Â <span class="hljs-attr">:key</span>=<span class="hljs-string">"product.id"</span>
Â Â Â Â Â Â Â Â <span class="hljs-attr">class</span>=<span class="hljs-string">"product-card"</span>
Â Â Â Â Â Â &gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{{Â product.nameÂ }}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ä»·æ ¼:Â Â¥{{Â product.priceÂ }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">button</span>Â @<span class="hljs-attr">click</span>=<span class="hljs-string">"addToCart(product)"</span>&gt;</span>
Â Â Â Â Â Â Â Â Â Â åŠ å…¥è´­ç‰©è½¦
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">&lt;!--Â è´­ç‰©è½¦é¢„è§ˆÂ --&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>Â <span class="hljs-attr">class</span>=<span class="hljs-string">"cart-preview"</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>è´­ç‰©è½¦Â ({{Â cartTotalItemsÂ }}ä»¶å•†å“)<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">button</span>Â @<span class="hljs-attr">click</span>=<span class="hljs-string">"goToCart"</span>&gt;</span>å»ç»“ç®—<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span>Â {Â mapMutations,Â mapGettersÂ }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'vuex'</span>

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â {
Â Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'ProductList'</span>,
Â Â 
Â Â <span class="hljs-title function_">data</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â {
Â Â Â Â Â Â <span class="hljs-attr">products</span>:Â [
Â Â Â Â Â Â Â Â {Â <span class="hljs-attr">id</span>:Â <span class="hljs-number">1</span>,Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'å•†å“A'</span>,Â <span class="hljs-attr">price</span>:Â <span class="hljs-number">100</span>Â },
Â Â Â Â Â Â Â Â {Â <span class="hljs-attr">id</span>:Â <span class="hljs-number">2</span>,Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'å•†å“B'</span>,Â <span class="hljs-attr">price</span>:Â <span class="hljs-number">200</span>Â },
Â Â Â Â Â Â Â Â {Â <span class="hljs-attr">id</span>:Â <span class="hljs-number">3</span>,Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'å•†å“C'</span>,Â <span class="hljs-attr">price</span>:Â <span class="hljs-number">300</span>Â }
Â Â Â Â Â Â ]
Â Â Â Â }
Â Â },
Â Â 
Â Â <span class="hljs-attr">computed</span>:Â {
Â Â Â Â ...<span class="hljs-title function_">mapGetters</span>([<span class="hljs-string">'cartTotalItems'</span>])
Â Â },
Â Â 
Â Â <span class="hljs-attr">methods</span>:Â {
Â Â Â Â ...<span class="hljs-title function_">mapMutations</span>([<span class="hljs-string">'ADD_TO_CART'</span>]),
Â Â Â Â 
Â Â Â Â <span class="hljs-title function_">addToCart</span>(<span class="hljs-params">product</span>)Â {
Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">ADD_TO_CART</span>({
Â Â Â Â Â Â Â Â ...product,
Â Â Â Â Â Â Â Â <span class="hljs-attr">quantity</span>:Â <span class="hljs-number">1</span>
Â Â Â Â Â Â })
Â Â Â Â Â Â <span class="hljs-title function_">alert</span>(<span class="hljs-string">'å·²æ·»åŠ åˆ°è´­ç‰©è½¦ï¼åˆ·æ–°é¡µé¢æˆ–é‡æ–°æ‰“å¼€æµè§ˆå™¨ï¼Œè´­ç‰©è½¦æ•°æ®ä»ç„¶å­˜åœ¨ã€‚'</span>)
Â Â Â Â },
Â Â Â Â 
Â Â Â Â <span class="hljs-title function_">goToCart</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">$router</span>.<span class="hljs-title function_">push</span>(<span class="hljs-string">'/cart'</span>)
Â Â Â Â }
Â Â }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 data-id="heading-7">æ–¹æ³•3ï¼šä½¿ç”¨è·¯ç”±å®ˆå«ä¿å­˜é¡µé¢çŠ¶æ€</h3>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šåŸºäºè·¯ç”±çš„é¡µé¢çŠ¶æ€ä¿å­˜</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//Â router/index.js</span>
<span class="hljs-keyword">import</span>Â <span class="hljs-title class_">Vue</span>Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span>Â <span class="hljs-title class_">VueRouter</span>Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'vue-router'</span>

<span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">VueRouter</span>)

<span class="hljs-keyword">const</span>Â routesÂ =Â [
Â Â {
Â Â Â Â <span class="hljs-attr">path</span>:Â <span class="hljs-string">'/form'</span>,
Â Â Â Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'FormPage'</span>,
Â Â Â Â <span class="hljs-attr">component</span>:Â <span class="hljs-function">()Â =&gt;</span>Â <span class="hljs-keyword">import</span>(<span class="hljs-string">'../views/FormPage.vue'</span>),
Â Â Â Â <span class="hljs-attr">meta</span>:Â {
Â Â Â Â Â Â <span class="hljs-attr">keepAlive</span>:Â <span class="hljs-literal">true</span>,Â <span class="hljs-comment">//Â éœ€è¦ç¼“å­˜</span>
Â Â Â Â Â Â <span class="hljs-attr">saveState</span>:Â <span class="hljs-literal">true</span>Â Â <span class="hljs-comment">//Â éœ€è¦ä¿å­˜çŠ¶æ€</span>
Â Â Â Â }
Â Â },
Â Â <span class="hljs-comment">//Â ...å…¶ä»–è·¯ç”±</span>
]

<span class="hljs-keyword">const</span>Â routerÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">VueRouter</span>({
Â Â <span class="hljs-attr">mode</span>:Â <span class="hljs-string">'history'</span>,
Â Â routes
})

<span class="hljs-comment">//Â é¡µé¢çŠ¶æ€ç¼“å­˜å¯¹è±¡</span>
<span class="hljs-keyword">const</span>Â pageStateCacheÂ =Â {}

<span class="hljs-comment">//Â å…¨å±€å‰ç½®å®ˆå«</span>
router.<span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">(<span class="hljs-params">to,Â <span class="hljs-keyword">from</span>,Â next</span>)Â =&gt;</span>Â {
Â Â <span class="hljs-comment">//Â ç¦»å¼€éœ€è¦ä¿å­˜çŠ¶æ€çš„é¡µé¢æ—¶ï¼Œä¿å­˜å½“å‰é¡µé¢çŠ¶æ€</span>
Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-keyword">from</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">saveState</span>)Â {
Â Â Â Â <span class="hljs-title function_">savePageState</span>(<span class="hljs-keyword">from</span>)
Â Â }
Â Â 
Â Â <span class="hljs-title function_">next</span>()
})

<span class="hljs-comment">//Â å…¨å±€åç½®å®ˆå«</span>
router.<span class="hljs-title function_">afterEach</span>(<span class="hljs-function">(<span class="hljs-params">to,Â <span class="hljs-keyword">from</span></span>)Â =&gt;</span>Â {
Â Â <span class="hljs-comment">//Â è¿›å…¥éœ€è¦æ¢å¤çŠ¶æ€çš„é¡µé¢æ—¶ï¼Œæ¢å¤é¡µé¢çŠ¶æ€</span>
Â Â <span class="hljs-keyword">if</span>Â (to.<span class="hljs-property">meta</span>.<span class="hljs-property">saveState</span>)Â {
Â Â Â Â <span class="hljs-title function_">restorePageState</span>(to)
Â Â }
})

<span class="hljs-comment">/**
Â *Â ä¿å­˜é¡µé¢çŠ¶æ€
Â */</span>
<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">savePageState</span>(<span class="hljs-params">route</span>)Â {
Â Â <span class="hljs-keyword">const</span>Â pageKeyÂ =Â <span class="hljs-title function_">getPageKey</span>(route)
Â Â <span class="hljs-keyword">const</span>Â stateToSaveÂ =Â {
Â Â Â Â <span class="hljs-attr">scrollPosition</span>:Â <span class="hljs-variable language_">window</span>.<span class="hljs-property">pageYOffset</span>,
Â Â Â Â <span class="hljs-attr">formData</span>:Â <span class="hljs-title function_">getFormDataFromPage</span>(),
Â Â Â Â <span class="hljs-attr">timestamp</span>:Â <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
Â Â }
Â Â 
Â Â pageStateCache[pageKey]Â =Â stateToSave
Â Â <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">`pageState_<span class="hljs-subst">${pageKey}</span>`</span>,Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(stateToSave))
}

<span class="hljs-comment">/**
Â *Â æ¢å¤é¡µé¢çŠ¶æ€
Â */</span>
<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">restorePageState</span>(<span class="hljs-params">route</span>)Â {
Â Â <span class="hljs-keyword">const</span>Â pageKeyÂ =Â <span class="hljs-title function_">getPageKey</span>(route)
Â Â <span class="hljs-keyword">let</span>Â state
Â Â 
Â Â <span class="hljs-comment">//Â å…ˆä»å†…å­˜ç¼“å­˜ä¸­è·å–</span>
Â Â <span class="hljs-keyword">if</span>Â (pageStateCache[pageKey])Â {
Â Â Â Â stateÂ =Â pageStateCache[pageKey]
Â Â }Â <span class="hljs-keyword">else</span>Â {
Â Â Â Â <span class="hljs-comment">//Â å†…å­˜ä¸­æ²¡æœ‰åˆ™ä»localStorageè·å–</span>
Â Â Â Â <span class="hljs-keyword">const</span>Â savedStateÂ =Â <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">`pageState_<span class="hljs-subst">${pageKey}</span>`</span>)
Â Â Â Â <span class="hljs-keyword">if</span>Â (savedState)Â {
Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â stateÂ =Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(savedState)
Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (e)Â {
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ¢å¤é¡µé¢çŠ¶æ€å¤±è´¥:'</span>,Â e)
Â Â Â Â Â Â }
Â Â Â Â }
Â Â }
Â Â 
Â Â <span class="hljs-keyword">if</span>Â (state)Â {
Â Â Â Â <span class="hljs-comment">//Â æ¢å¤æ»šåŠ¨ä½ç½®</span>
Â Â Â Â <span class="hljs-keyword">if</span>Â (state.<span class="hljs-property">scrollPosition</span>)Â {
Â Â Â Â Â Â <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()Â =&gt;</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">scrollTo</span>(<span class="hljs-number">0</span>,Â state.<span class="hljs-property">scrollPosition</span>)
Â Â Â Â Â Â },Â <span class="hljs-number">100</span>)
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â æ¢å¤è¡¨å•æ•°æ®</span>
Â Â Â Â <span class="hljs-keyword">if</span>Â (state.<span class="hljs-property">formData</span>)Â {
Â Â Â Â Â Â <span class="hljs-title function_">restoreFormDataToPage</span>(state.<span class="hljs-property">formData</span>)
Â Â Â Â }
Â Â }
}

<span class="hljs-comment">/**
Â *Â ç”Ÿæˆé¡µé¢å”¯ä¸€æ ‡è¯†
Â */</span>
<span class="hljs-keyword">function</span>Â <span class="hljs-title function_">getPageKey</span>(<span class="hljs-params">route</span>)Â {
Â Â <span class="hljs-keyword">return</span>Â route.<span class="hljs-property">path</span>Â +Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(route.<span class="hljs-property">query</span>)Â +Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(route.<span class="hljs-property">params</span>)
}

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â router
</code></pre>
<h3 data-id="heading-8">æ–¹æ³•4ï¼šä½¿ç”¨ keep-alive ç»„ä»¶ç¼“å­˜ç»„ä»¶å®ä¾‹</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!--Â App.vueÂ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>Â <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span>
Â Â Â Â <span class="hljs-comment">&lt;!--Â ä½¿ç”¨keep-aliveç¼“å­˜éœ€è¦ä¿æŒçŠ¶æ€çš„ç»„ä»¶Â --&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">keep-alive</span>Â <span class="hljs-attr">:include</span>=<span class="hljs-string">"cachedComponents"</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">router-view</span>Â <span class="hljs-attr">v-if</span>=<span class="hljs-string">"$route.meta.keepAlive"</span>Â /&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">keep-alive</span>&gt;</span>
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">&lt;!--Â ä¸éœ€è¦ç¼“å­˜çš„ç»„ä»¶Â --&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">router-view</span>Â <span class="hljs-attr">v-if</span>=<span class="hljs-string">"!$route.meta.keepAlive"</span>Â /&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â {
Â Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'App'</span>,
Â Â <span class="hljs-title function_">data</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â {
Â Â Â Â Â Â <span class="hljs-attr">cachedComponents</span>:Â [<span class="hljs-string">'ProductList'</span>,Â <span class="hljs-string">'UserForm'</span>]Â <span class="hljs-comment">//Â éœ€è¦ç¼“å­˜çš„ç»„ä»¶å</span>
Â Â Â Â }
Â Â },
Â Â 
Â Â <span class="hljs-comment">//Â ä½¿ç”¨keep-aliveçš„ç»„ä»¶ä¼šè§¦å‘è¿™äº›ç”Ÿå‘½å‘¨æœŸ</span>
Â Â <span class="hljs-title function_">beforeRouteLeave</span>(<span class="hljs-params">to,Â <span class="hljs-keyword">from</span>,Â next</span>)Â {
Â Â Â Â <span class="hljs-comment">//Â åœ¨ç¦»å¼€å‰å¯ä»¥ä¿å­˜ä¸€äº›æ•°æ®</span>
Â Â Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-variable language_">this</span>.<span class="hljs-property">saveState</span>)Â {
Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveState</span>()
Â Â Â Â }
Â Â Â Â <span class="hljs-title function_">next</span>()
Â Â },
Â Â 
Â Â <span class="hljs-title function_">activated</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-comment">//Â ç»„ä»¶è¢«æ¿€æ´»æ—¶è°ƒç”¨</span>
Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„ä»¶è¢«æ¿€æ´»ï¼Œå¯ä»¥æ¢å¤çŠ¶æ€'</span>)
Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">restoreState</span>Â &amp;&amp;Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">restoreState</span>()
Â Â },
Â Â 
Â Â <span class="hljs-title function_">deactivated</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-comment">//Â ç»„ä»¶è¢«åœç”¨æ—¶è°ƒç”¨</span>
Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„ä»¶è¢«åœç”¨ï¼Œå¯ä»¥ä¿å­˜çŠ¶æ€'</span>)
Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveState</span>Â &amp;&amp;Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveState</span>()
Â Â }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h2 data-id="heading-9">å››ã€é«˜çº§æ–¹æ¡ˆï¼šIndexedDB å­˜å‚¨å¤§é‡æ•°æ®</h2>
<p>å½“éœ€è¦å­˜å‚¨å¤§é‡æ•°æ®æˆ–å¤æ‚å¯¹è±¡æ—¶ï¼ŒIndexedDB æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//Â utils/db.js</span>
<span class="hljs-keyword">class</span>Â <span class="hljs-title class_">StateDB</span>Â {
Â Â <span class="hljs-title function_">constructor</span>(<span class="hljs-params">dbNameÂ =Â <span class="hljs-string">'VueAppState'</span>,Â versionÂ =Â <span class="hljs-number">1</span></span>)Â {
Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">dbName</span>Â =Â dbName
Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">version</span>Â =Â version
Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>Â =Â <span class="hljs-literal">null</span>
Â Â }

Â Â <span class="hljs-comment">//Â æ‰“å¼€æ•°æ®åº“</span>
Â Â <span class="hljs-title function_">open</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,Â reject</span>)Â =&gt;</span>Â {
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â requestÂ =Â indexedDB.<span class="hljs-title function_">open</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dbName</span>,Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">version</span>)

Â Â Â Â Â Â request.<span class="hljs-property">onerror</span>Â =Â <span class="hljs-function">()Â =&gt;</span>Â <span class="hljs-title function_">reject</span>(request.<span class="hljs-property">error</span>)
Â Â Â Â Â Â request.<span class="hljs-property">onsuccess</span>Â =Â <span class="hljs-function">()Â =&gt;</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>Â =Â request.<span class="hljs-property">result</span>
Â Â Â Â Â Â Â Â <span class="hljs-title function_">resolve</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>)
Â Â Â Â Â Â }

Â Â Â Â Â Â request.<span class="hljs-property">onupgradeneeded</span>Â =Â <span class="hljs-function">(<span class="hljs-params">event</span>)Â =&gt;</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â dbÂ =Â event.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â åˆ›å»ºå¯¹è±¡å­˜å‚¨ç©ºé—´</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (!db.<span class="hljs-property">objectStoreNames</span>.<span class="hljs-title function_">contains</span>(<span class="hljs-string">'pageStates'</span>))Â {
Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â storeÂ =Â db.<span class="hljs-title function_">createObjectStore</span>(<span class="hljs-string">'pageStates'</span>,Â {Â <span class="hljs-attr">keyPath</span>:Â <span class="hljs-string">'id'</span>Â })
Â Â Â Â Â Â Â Â Â Â store.<span class="hljs-title function_">createIndex</span>(<span class="hljs-string">'timestamp'</span>,Â <span class="hljs-string">'timestamp'</span>,Â {Â <span class="hljs-attr">unique</span>:Â <span class="hljs-literal">false</span>Â })
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (!db.<span class="hljs-property">objectStoreNames</span>.<span class="hljs-title function_">contains</span>(<span class="hljs-string">'userData'</span>))Â {
Â Â Â Â Â Â Â Â Â Â db.<span class="hljs-title function_">createObjectStore</span>(<span class="hljs-string">'userData'</span>,Â {Â <span class="hljs-attr">keyPath</span>:Â <span class="hljs-string">'key'</span>Â })
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â }
Â Â Â Â })
Â Â }

Â Â <span class="hljs-comment">//Â ä¿å­˜é¡µé¢çŠ¶æ€</span>
Â Â <span class="hljs-keyword">async</span>Â <span class="hljs-title function_">savePageState</span>(<span class="hljs-params">pageId,Â state</span>)Â {
Â Â Â Â <span class="hljs-keyword">if</span>Â (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>)Â <span class="hljs-keyword">await</span>Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">open</span>()
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,Â reject</span>)Â =&gt;</span>Â {
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â transactionÂ =Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>.<span class="hljs-title function_">transaction</span>([<span class="hljs-string">'pageStates'</span>],Â <span class="hljs-string">'readwrite'</span>)
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â storeÂ =Â transaction.<span class="hljs-title function_">objectStore</span>(<span class="hljs-string">'pageStates'</span>)
Â Â Â Â Â Â 
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â recordÂ =Â {
Â Â Â Â Â Â Â Â <span class="hljs-attr">id</span>:Â pageId,
Â Â Â Â Â Â Â Â <span class="hljs-attr">state</span>:Â state,
Â Â Â Â Â Â Â Â <span class="hljs-attr">timestamp</span>:Â <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
Â Â Â Â Â Â }
Â Â Â Â Â Â 
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â requestÂ =Â store.<span class="hljs-title function_">put</span>(record)
Â Â Â Â Â Â 
Â Â Â Â Â Â request.<span class="hljs-property">onsuccess</span>Â =Â <span class="hljs-function">()Â =&gt;</span>Â <span class="hljs-title function_">resolve</span>()
Â Â Â Â Â Â request.<span class="hljs-property">onerror</span>Â =Â <span class="hljs-function">()Â =&gt;</span>Â <span class="hljs-title function_">reject</span>(request.<span class="hljs-property">error</span>)
Â Â Â Â })
Â Â }

Â Â <span class="hljs-comment">//Â è·å–é¡µé¢çŠ¶æ€</span>
Â Â <span class="hljs-keyword">async</span>Â <span class="hljs-title function_">getPageState</span>(<span class="hljs-params">pageId</span>)Â {
Â Â Â Â <span class="hljs-keyword">if</span>Â (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>)Â <span class="hljs-keyword">await</span>Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">open</span>()
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,Â reject</span>)Â =&gt;</span>Â {
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â transactionÂ =Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>.<span class="hljs-title function_">transaction</span>([<span class="hljs-string">'pageStates'</span>],Â <span class="hljs-string">'readonly'</span>)
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â storeÂ =Â transaction.<span class="hljs-title function_">objectStore</span>(<span class="hljs-string">'pageStates'</span>)
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â requestÂ =Â store.<span class="hljs-title function_">get</span>(pageId)
Â Â Â Â Â Â 
Â Â Â Â Â Â request.<span class="hljs-property">onsuccess</span>Â =Â <span class="hljs-function">()Â =&gt;</span>Â <span class="hljs-title function_">resolve</span>(request.<span class="hljs-property">result</span>?.<span class="hljs-property">state</span>)
Â Â Â Â Â Â request.<span class="hljs-property">onerror</span>Â =Â <span class="hljs-function">()Â =&gt;</span>Â <span class="hljs-title function_">reject</span>(request.<span class="hljs-property">error</span>)
Â Â Â Â })
Â Â }

Â Â <span class="hljs-comment">//Â æ¸…ç†è¿‡æœŸæ•°æ®ï¼ˆè¶…è¿‡7å¤©ï¼‰</span>
Â Â <span class="hljs-keyword">async</span>Â <span class="hljs-title function_">cleanupOldStates</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-keyword">if</span>Â (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>)Â <span class="hljs-keyword">await</span>Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">open</span>()
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">const</span>Â sevenDaysAgoÂ =Â <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()Â -Â (<span class="hljs-number">7</span>Â *Â <span class="hljs-number">24</span>Â *Â <span class="hljs-number">60</span>Â *Â <span class="hljs-number">60</span>Â *Â <span class="hljs-number">1000</span>)
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,Â reject</span>)Â =&gt;</span>Â {
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â transactionÂ =Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>.<span class="hljs-title function_">transaction</span>([<span class="hljs-string">'pageStates'</span>],Â <span class="hljs-string">'readwrite'</span>)
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â storeÂ =Â transaction.<span class="hljs-title function_">objectStore</span>(<span class="hljs-string">'pageStates'</span>)
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â indexÂ =Â store.<span class="hljs-title function_">index</span>(<span class="hljs-string">'timestamp'</span>)
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â rangeÂ =Â <span class="hljs-title class_">IDBKeyRange</span>.<span class="hljs-title function_">upperBound</span>(sevenDaysAgo)
Â Â Â Â Â Â 
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â requestÂ =Â index.<span class="hljs-title function_">openCursor</span>(range)
Â Â Â Â Â Â 
Â Â Â Â Â Â request.<span class="hljs-property">onsuccess</span>Â =Â <span class="hljs-function">(<span class="hljs-params">event</span>)Â =&gt;</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â cursorÂ =Â event.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (cursor)Â {
Â Â Â Â Â Â Â Â Â Â cursor.<span class="hljs-title function_">delete</span>()
Â Â Â Â Â Â Â Â Â Â cursor.<span class="hljs-title function_">continue</span>()
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">else</span>Â {
Â Â Â Â Â Â Â Â Â Â <span class="hljs-title function_">resolve</span>()
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â }
Â Â Â Â Â Â 
Â Â Â Â Â Â request.<span class="hljs-property">onerror</span>Â =Â <span class="hljs-function">()Â =&gt;</span>Â <span class="hljs-title function_">reject</span>(request.<span class="hljs-property">error</span>)
Â Â Â Â })
Â Â }
}

<span class="hljs-comment">//Â åˆ›å»ºå•ä¾‹å®ä¾‹</span>
<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">const</span>Â stateDBÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">StateDB</span>()

<span class="hljs-comment">//Â åœ¨Â VueÂ æ’ä»¶ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">const</span>Â <span class="hljs-title class_">StatePersistencePlugin</span>Â =Â {
Â Â <span class="hljs-title function_">install</span>(<span class="hljs-params">Vue</span>)Â {
Â Â Â Â <span class="hljs-title class_">Vue</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">$stateDB</span>Â =Â stateDB
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â æ··å…¥æ–¹æ³•åˆ°æ‰€æœ‰ç»„ä»¶</span>
Â Â Â Â <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">mixin</span>({
Â Â Â Â Â Â <span class="hljs-attr">methods</span>:Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">async</span>Â <span class="hljs-title function_">saveComponentState</span>(<span class="hljs-params">stateKey,Â data</span>)Â {
Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â componentIdÂ =Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">name</span>Â ||Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">$route</span>?.<span class="hljs-property">path</span>Â ||Â <span class="hljs-string">'unknown'</span>
Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â fullKeyÂ =Â <span class="hljs-string">`<span class="hljs-subst">${componentId}</span>_<span class="hljs-subst">${stateKey}</span>`</span>
Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">await</span>Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">$stateDB</span>.<span class="hljs-title function_">savePageState</span>(fullKey,Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â data,
Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">savedAt</span>:Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>()
Â Â Â Â Â Â Â Â Â Â Â Â })
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`çŠ¶æ€å·²ä¿å­˜:Â <span class="hljs-subst">${fullKey}</span>`</span>)
Â Â Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (error)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ä¿å­˜çŠ¶æ€å¤±è´¥:'</span>,Â error)
Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â },
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-keyword">async</span>Â <span class="hljs-title function_">loadComponentState</span>(<span class="hljs-params">stateKey</span>)Â {
Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â componentIdÂ =Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span>.<span class="hljs-property">name</span>Â ||Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">$route</span>?.<span class="hljs-property">path</span>Â ||Â <span class="hljs-string">'unknown'</span>
Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â fullKeyÂ =Â <span class="hljs-string">`<span class="hljs-subst">${componentId}</span>_<span class="hljs-subst">${stateKey}</span>`</span>
Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â stateÂ =Â <span class="hljs-keyword">await</span>Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">$stateDB</span>.<span class="hljs-title function_">getPageState</span>(fullKey)
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â state?.<span class="hljs-property">data</span>Â ||Â <span class="hljs-literal">null</span>
Â Â Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (error)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åŠ è½½çŠ¶æ€å¤±è´¥:'</span>,Â error)
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">null</span>
Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â }
Â Â Â Â })
Â Â }
}

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â <span class="hljs-title class_">StatePersistencePlugin</span>
</code></pre>
<h2 data-id="heading-10">äº”ã€æœ€ä½³å®è·µæ€»ç»“</h2>
<h3 data-id="heading-11">1.Â <strong>åˆ†å±‚å­˜å‚¨ç­–ç•¥</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//Â æ ¹æ®æ•°æ®ç±»å‹é€‰æ‹©ä¸åŒçš„å­˜å‚¨æ–¹å¼</span>
<span class="hljs-keyword">const</span>Â storageStrategyÂ =Â {
Â Â <span class="hljs-comment">//Â ç”¨æˆ·è®¾ç½®ï¼šæ°¸ä¹…å­˜å‚¨</span>
Â Â <span class="hljs-attr">userPreferences</span>:Â <span class="hljs-variable language_">localStorage</span>,
Â Â 
Â Â <span class="hljs-comment">//Â è´­ç‰©è½¦ï¼šIndexedDBÂ +Â æœåŠ¡ç«¯åŒæ­¥</span>
Â Â <span class="hljs-attr">shoppingCart</span>:Â {
Â Â Â Â <span class="hljs-attr">local</span>:Â indexedDB,
Â Â Â Â <span class="hljs-attr">remote</span>:Â <span class="hljs-string">'api/cart'</span>
Â Â },
Â Â 
Â Â <span class="hljs-comment">//Â è¡¨å•è‰ç¨¿ï¼šsessionStorageï¼ˆä¼šè¯çº§ï¼‰</span>
Â Â <span class="hljs-attr">formDraft</span>:Â sessionStorage,
Â Â 
Â Â <span class="hljs-comment">//Â é¡µé¢æ»šåŠ¨ä½ç½®ï¼šå†…å­˜ç¼“å­˜</span>
Â Â <span class="hljs-attr">scrollPosition</span>:Â <span class="hljs-string">'memory'</span>
}
</code></pre>
<h3 data-id="heading-12">2.Â <strong>æ•°æ®ç‰ˆæœ¬ç®¡ç†</strong></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">//Â æ·»åŠ ç‰ˆæœ¬æ§åˆ¶ï¼Œé¿å…æ•°æ®ç»“æ„å˜åŒ–å¯¼è‡´çš„é—®é¢˜</span>
<span class="hljs-keyword">const</span>Â saveWithVersionÂ =Â (key,Â <span class="hljs-keyword">data</span>)Â =&gt;Â {
Â Â <span class="hljs-keyword">const</span>Â payloadÂ =Â {
Â Â Â Â version:Â <span class="hljs-string">'1.0.0'</span>,
Â Â Â Â savedAt:Â newÂ Date().toISOString(),
Â Â Â Â <span class="hljs-keyword">data</span>:Â <span class="hljs-keyword">data</span>
Â Â }
Â Â localStorage.setItem(key,Â JSON.stringify(payload))
}

<span class="hljs-keyword">const</span>Â loadWithVersionÂ =Â (key,Â currentVersionÂ =Â <span class="hljs-string">'1.0.0'</span>)Â =&gt;Â {
Â Â <span class="hljs-keyword">const</span>Â savedÂ =Â localStorage.getItem(key)
Â Â <span class="hljs-keyword">if</span>Â (!saved)Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">null</span>
Â Â 
Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â <span class="hljs-keyword">const</span>Â {Â version,Â <span class="hljs-keyword">data</span>Â }Â =Â JSON.parse(saved)
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â ç‰ˆæœ¬è¿ç§»é€»è¾‘</span>
Â Â Â Â <span class="hljs-keyword">if</span>Â (versionÂ !==Â currentVersion)Â {
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â migrateData(<span class="hljs-keyword">data</span>,Â version,Â currentVersion)
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-keyword">data</span>
Â Â }Â <span class="hljs-keyword">catch</span>Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-literal">null</span>
Â Â }
}
</code></pre>
<h3 data-id="heading-13">3.Â <strong>è‡ªåŠ¨ä¿å­˜ä¸é˜²æŠ–ä¼˜åŒ–</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span>Â {Â debounceÂ }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'lodash'</span>

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â {
Â Â <span class="hljs-title function_">data</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â {
Â Â Â Â Â Â <span class="hljs-attr">formData</span>:Â {},
Â Â Â Â Â Â <span class="hljs-attr">autoSaveEnabled</span>:Â <span class="hljs-literal">true</span>
Â Â Â Â }
Â Â },
Â Â 
Â Â <span class="hljs-title function_">created</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-comment">//Â ä½¿ç”¨é˜²æŠ–é¿å…é¢‘ç¹ä¿å­˜</span>
Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">debouncedSave</span>Â =Â <span class="hljs-title function_">debounce</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">saveFormState</span>,Â <span class="hljs-number">1000</span>)
Â Â },
Â Â 
Â Â <span class="hljs-attr">watch</span>:Â {
Â Â Â Â <span class="hljs-attr">formData</span>:Â {
Â Â Â Â Â Â <span class="hljs-attr">deep</span>:Â <span class="hljs-literal">true</span>,
Â Â Â Â Â Â <span class="hljs-title function_">handler</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-variable language_">this</span>.<span class="hljs-property">autoSaveEnabled</span>)Â {
Â Â Â Â Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">debouncedSave</span>()
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â }
Â Â Â Â }
Â Â },
Â Â 
Â Â <span class="hljs-attr">methods</span>:Â {
Â Â Â Â <span class="hljs-title function_">saveFormState</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â <span class="hljs-comment">//Â ä¿å­˜é€»è¾‘</span>
Â Â Â Â }
Â Â }
}
</code></pre>
<h2 data-id="heading-14">å…­ã€å®‰å…¨æ³¨æ„äº‹é¡¹</h2>
<ol>
<li>
<p>1.Â <strong>æ•æ„Ÿä¿¡æ¯ä¸è¦ä¿å­˜åœ¨å®¢æˆ·ç«¯</strong></p>
</li>
<li>
<ul>
<li>â€¢ å¯†ç ã€tokenç­‰æ•æ„Ÿä¿¡æ¯é¿å…æœ¬åœ°å­˜å‚¨</li>
<li>â€¢ å¿…è¦æ—¶ä½¿ç”¨åŠ å¯†å­˜å‚¨</li>
</ul>
</li>
<li>
<p>2.Â <strong>æ•°æ®æ¸…ç†æœºåˆ¶</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//Â å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®</span>
<span class="hljs-built_in">setInterval</span>(<span class="hljs-function">()Â =&gt;</span>Â {
Â Â <span class="hljs-keyword">const</span>Â oneDayAgoÂ =Â <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()Â -Â <span class="hljs-number">24</span>Â *Â <span class="hljs-number">60</span>Â *Â <span class="hljs-number">60</span>Â *Â <span class="hljs-number">1000</span>
Â Â <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">localStorage</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span>Â =&gt;</span>Â {
Â Â Â Â <span class="hljs-keyword">if</span>Â (key.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'temp_'</span>))Â {
Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â itemÂ =Â <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(key))
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (item.<span class="hljs-property">timestamp</span>Â &amp;&amp;Â item.<span class="hljs-property">timestamp</span>Â &lt;Â oneDayAgo)Â {
Â Â Â Â Â Â Â Â Â Â <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(key)
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â {}
Â Â Â Â }
Â Â })
},Â <span class="hljs-number">60</span>Â *Â <span class="hljs-number">60</span>Â *Â <span class="hljs-number">1000</span>)Â <span class="hljs-comment">//Â æ¯å°æ—¶æ¸…ç†ä¸€æ¬¡</span>
</code></pre>
</li>
</ol>
<h2 data-id="heading-15">ç»“è¯­</h2>
<p>ä¿å­˜é¡µé¢çŠ¶æ€æ˜¯æå‡ Vue åº”ç”¨ç”¨æˆ·ä½“éªŒçš„å…³é”®æŠ€æœ¯ã€‚æ ¹æ®ä¸åŒçš„åœºæ™¯éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ï¼š</p>
<ul>
<li>â€¢Â <strong>ç®€å•åœºæ™¯</strong>ï¼šä½¿ç”¨ localStorage æˆ– sessionStorage</li>
<li>â€¢Â <strong>å¤æ‚åº”ç”¨</strong>ï¼šVuex/Pinia + æŒä¹…åŒ–æ’ä»¶</li>
<li>â€¢Â <strong>å¤§é‡æ•°æ®</strong>ï¼šIndexedDB å­˜å‚¨</li>
<li>â€¢Â <strong>ç»„ä»¶ç¼“å­˜</strong>ï¼škeep-alive + è·¯ç”±å®ˆå«</li>
</ul>
<p>è®°ä½ï¼Œæœ€å¥½çš„æ–¹æ¡ˆæ˜¯<strong>åˆ†å±‚å­˜å‚¨ã€æŒ‰éœ€ä½¿ç”¨</strong>ã€‚åˆç†ä½¿ç”¨çŠ¶æ€ä¿å­˜ï¼Œè®©ä½ çš„ Vue åº”ç”¨æ›´åŠ å‹å¥½å’Œå¥å£®ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¾èµ–é¢„æ„å»º]]></title>    <link>https://juejin.cn/post/7591702898080301071</link>    <guid>https://juejin.cn/post/7591702898080301071</guid>    <pubDate>2026-01-05T13:26:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591702898080301071" data-draft-id="7591703562134028322" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¾èµ–é¢„æ„å»º"/> <meta itemprop="keywords" content="Vite"/> <meta itemprop="datePublished" content="2026-01-05T13:26:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="coderjc"/> <meta itemprop="url" content="https://juejin.cn/user/4279763486908104"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¾èµ–é¢„æ„å»º
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4279763486908104/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    coderjc
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-05T13:26:08.000Z" title="Mon Jan 05 2026 13:26:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å¦‚æœä½ ç”¨è¿‡ viteï¼Œé‚£ä¹ˆæƒ³å¿…å¯¹<strong>ä¾èµ–é¢„æ„å»º</strong>è¿™ä¸€ä¸ªåè¯å¹¶ä¸é™Œç”Ÿï¼Œæœ¬æ–‡å°±åŸºäºæ­¤æ¥è¿›è¡Œä¸€äº›æ¢è®¨ã€‚</p>
<p>PSï¼šæœ¬æ–‡åˆ†ææ¥è‡ªäºç¬”è€…çš„ä¸ªäººç†è§£ï¼Œå¦‚æœå‘ç°äº†é”™è¯¯ï¼Œå¯ä»¥åœ¨è¿›è¡ŒæŒ‡æ­£ã€‚å½“ç„¶è¯´çš„æ˜¯ vite ä¾èµ–äº esbuild å’Œ rollup çš„æ—¶å€™ï¼Œè€Œé rolldownã€‚</p>
</blockquote>
<h2 data-id="heading-0">ä¸ºä»€ä¹ˆéœ€è¦ä¾èµ–é¢„æ„å»º</h2>
<blockquote>
<p>é€šå¸¸å¦‚æœè¦çŸ¥é“ä¸ºä»€ä¹ˆéœ€è¦ä¸€ä¸ªä¸œè¥¿ï¼Œæˆ‘ä»¬é¦–è¦çš„å‰æå°±æ˜¯çŸ¥é“â€œå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿâ€ã€‚è¿™ä¸€ç‚¹å…¶å® vite çš„æ–‡æ¡£å·²ç»ç»™å‡ºäº†ï¼Œä¸»è¦æ˜¯ä¸¤ä¸ªç›®çš„ï¼š<strong>è§„èŒƒå…¼å®¹æ€§</strong>å’Œ<strong>æ€§èƒ½</strong>ã€‚</p>
</blockquote>
<h3 data-id="heading-1">æ€§èƒ½</h3>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œæµè§ˆå™¨æ˜¯å¯ä»¥é€šè¿‡ç»™ script æ ‡ç­¾æ·»åŠ  type="module" æ¥è®©å…¶æ”¯æŒæ¨¡å—åŒ–çš„å¯¼å…¥ï¼Œæ‰€ä»¥ï¼Œæˆ‘ç®€å•å†™äº†ä¸€ä¸ª demoï¼Œdemo çš„ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-css" lang="css">ä¾èµ–é¢„æ„å»º
â”œâ”€â”€ <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.js</span>
â”œâ”€â”€ <span class="hljs-selector-tag">b</span><span class="hljs-selector-class">.js</span>
â”œâ”€â”€ c<span class="hljs-selector-class">.js</span>
â”œâ”€â”€ index<span class="hljs-selector-class">.html</span>
â””â”€â”€ index<span class="hljs-selector-class">.js</span>
</code></pre>
<p>æ–‡ä»¶å†…å®¹å¾ˆç®€å•ï¼Œåªè¦çœ‹ä¸€ä¸‹ index.js å³å¯ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { a } <span class="hljs-keyword">from</span> <span class="hljs-string">'./a.js'</span>
<span class="hljs-keyword">import</span> { b } <span class="hljs-keyword">from</span> <span class="hljs-string">'./b.js'</span>
<span class="hljs-keyword">import</span> { c } <span class="hljs-keyword">from</span> <span class="hljs-string">'./c.js'</span>
â€‹
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'index.js -- start'</span>)
â€‹
<span class="hljs-title function_">a</span>()
<span class="hljs-title function_">b</span>()
<span class="hljs-title function_">c</span>()
â€‹
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'index.js -- end'</span>)
</code></pre>
<p>è¾“å‡ºä¸ºï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">index</span><span class="hljs-selector-class">.js</span> <span class="hljs-selector-tag">--</span> <span class="hljs-selector-tag">start</span>
<span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.js</span>:<span class="hljs-number">2</span> <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.js</span>
<span class="hljs-selector-tag">b</span><span class="hljs-selector-class">.js</span>:<span class="hljs-number">2</span> <span class="hljs-selector-tag">b</span><span class="hljs-selector-class">.js</span>
<span class="hljs-selector-tag">c</span><span class="hljs-selector-class">.js</span>:<span class="hljs-number">2</span> <span class="hljs-selector-tag">c</span><span class="hljs-selector-class">.js</span>
<span class="hljs-selector-tag">index</span><span class="hljs-selector-class">.js</span>:<span class="hljs-number">11</span> <span class="hljs-selector-tag">index</span><span class="hljs-selector-class">.js</span> <span class="hljs-selector-tag">--</span> <span class="hljs-selector-tag">end</span>
</code></pre>
<p>å¥½åƒä¸€åˆ‡éƒ½æ˜¯å²æœˆé™å¥½ï¼Œä½†æ˜¯å…¶å®å®ƒèƒŒåå­˜åœ¨ä¸€ä¸ªâ€œè´Ÿæ‹…â€ï¼Œæˆ‘ä»¬æ¥æ‰“å¼€ç½‘ç»œé¢æ¿å°±å¯ä»¥çœ‹åˆ°äº†ï¼Œå¦‚å›¾ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6c0b8422acb24569a9eb01d4b67fd39f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJqYw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768224367&amp;x-signature=yoD4ASaidkx1ZFLbbgrFPCED%2Ba8%3D" alt="image-20260105003506147.png" loading="lazy"/></p>
<p>ä¸‰ä¸ªå¯¼å…¥å°±æœ‰ä¸‰ä¸ªè¯·æ±‚ï¼Œä¸€ä¸ªè¯·æ±‚å°±æ˜¯ä¸€ä¸ªç½‘ç»œå¼€é”€ï¼Œè€Œå¦‚æœæ˜¯ä¸€ä¸ªæˆç†Ÿçš„ç¬¬ä¸‰æ–¹åŒ…ï¼Œä¸€ä¸ªåŒ…å°±å¯èƒ½ä¼šæœ‰å‡ åå‡ ç™¾ä¸ªæ–‡ä»¶çš„å¯¼å…¥ï¼Œè¿™è¿˜æ˜¯åªæ˜¯ä¸€ä¸ªä¾èµ–ï¼Œå®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬çš„é¡¹ç›®æ˜¯ä¸ä¼šæ­¢æ­¥äºä¸€ä¸ªä¾èµ–çš„ã€‚æ‰€ä»¥ç®¡ä¸­çª¥è±¹ï¼Œå°±ç®—å†æœ¬åœ°ç¯å¢ƒï¼Œè¿™ä¸ªç½‘ç»œå¼€é”€ä¹Ÿå¾ˆéš¾æ‰¿å—ã€‚</p>
<p>å¯èƒ½æ–‡å­—çš„æè¿°è¿˜æ˜¯ç•¥æ˜¾è‹ç™½ï¼Œé‚£ä¹ˆè®©æˆ‘ä»¬çœ‹ä¸€ä¸ªå¼•å…¥ lodash çš„ä¾‹å­ï¼Œindex.js æ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å› ä¸ºè¿™æ˜¯æµè§ˆå™¨ç¯å¢ƒï¼Œæ‰€ä»¥è¦çŸ¥é“ç²¾ç¡®çš„å…·ä½“çš„ js æ–‡ä»¶</span>
<span class="hljs-keyword">import</span> { toUpper } <span class="hljs-keyword">from</span> <span class="hljs-string">'./node_modules/lodash-es/lodash.js'</span>
â€‹
<span class="hljs-keyword">const</span> msg = <span class="hljs-string">'hello world'</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">toUpper</span>(msg))
â€‹
</code></pre>
<p>è¯·æ±‚æ•ˆæœå¦‚å›¾ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f78c374380e34037b11771b1996a6d61~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJqYw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768224367&amp;x-signature=QvbaNZIgt6Q%2FYT5%2Fi4RPGLIFKx4%3D" alt="image-20260105005215251.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ•°é‡è¿˜æ˜¯å¾ˆææ€–çš„ã€‚è€Œå¦‚æœæœ‰ä¾èµ–é¢„æ„å»ºå‘¢ï¼Ÿæˆ‘ä»¬çœ‹ä¸€ä¸‹è¯·æ±‚çš„æ•ˆæœå›¾ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f25aee4cbdc4daf985d608fb1e619ac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJqYw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768224367&amp;x-signature=k5bFMEkHaaUSLr3UBX52SGHRYl8%3D" alt="image-20260105005717833.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ª lodash è¯·æ±‚æ•°é‡éƒ½é›†ä¸­åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆç½‘ç»œå¼€é”€å°±å°‘å¾—å¤šã€‚è€Œè™½ç„¶è¿™ä¸ªæ–‡ä»¶çš„ä½“ç§¯å¤§å¾ˆå¤šï¼Œä½†æ˜¯åªéœ€è¦è¿›è¡Œä¸€æ¬¡ç½‘ç»œçš„ä¼ è¾“å°±å¯ä»¥äº†ã€‚è¿™ç§å¤§å®¶å¯ä»¥å°è¯•ç”¨ä¸€ä¸ªè¾ƒå°çš„ node_modules ç›®å½•ï¼Œè¿›è¡Œå¤åˆ¶ä¼ è¾“æˆ–è€…æ‰“åŒ…å‹ç¼©ï¼Œå®ƒçš„æ—¶é—´æ¯”æ­£å¸¸å¤§æ–‡ä»¶çš„æ—¶é—´è¦å¤šçš„å¤šï¼Œ</p>
<h3 data-id="heading-2">è§„èŒƒå…¼å®¹æ€§</h3>
<p>æ€§èƒ½é—®é¢˜è§£å†³äº†ï¼Œä½†è¿˜æœ‰ä¸€ä¸ªæ›´æ£˜æ‰‹çš„é—®é¢˜åœ¨ç­‰ç€æˆ‘ä»¬ã€‚</p>
<p>ä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰æƒ³è¿‡ï¼Œnpm ä¸Šé‚£äº›ç¬¬ä¸‰æ–¹åŒ…ï¼Œå®ƒå†…éƒ¨ç”¨çš„æ˜¯ä»€ä¹ˆæ¨¡å—è§„èŒƒï¼Ÿä½ ä¸çŸ¥é“å®ƒæ˜¯ commonjs è¿˜æ˜¯ esmoduleã€‚</p>
<p>è€Œè¿™å°±ä¼šå¯¼è‡´ä¸€ä¸ªæ¯”è¾ƒå°´å°¬çš„çŠ¶å†µï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾æŸä¸ªç¬¬ä¸‰æ–¹åŒ… <code>some-package</code> å†…éƒ¨æ˜¯è¿™æ ·å†™çš„ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// some-package/index.js</span>
<span class="hljs-keyword">const</span> helper = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./helper.js'</span>)
â€‹
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
 Â <span class="hljs-title function_">doSomething</span>(<span class="hljs-params"/>) {
 Â  Â <span class="hljs-keyword">return</span> helper.<span class="hljs-title function_">process</span>()
  }
}
</code></pre>
<p>å½“ä½ åœ¨é¡¹ç›®é‡Œ <code>import { doSomething } from 'some-package'</code> çš„æ—¶å€™ï¼Œä½ æ•¢è¿™ä¹ˆç”¨ï¼Œæµè§ˆå™¨å°±æ•¢æ¥è¡¨æ¼”ä¸€ä¸‹ç½¢å·¥ï¼Œå› ä¸ºå®ƒå‹æ ¹ä¸è®¤è¯† <code>require</code> å’Œ <code>module.exports</code> æ˜¯å•¥ã€‚</p>
<p>æ‰€ä»¥å°±éœ€è¦é€šè¿‡ä¾èµ–é¢„æ„å»ºæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®ƒä¼šæŠŠè¿™äº› CommonJS æ ¼å¼çš„ä»£ç è½¬æ¢æˆ ESM æ ¼å¼ï¼Œå°±åƒä¸€ä¸ªç¿»è¯‘å®˜ï¼ŒæŠŠ"æ–¹è¨€"ç¿»è¯‘æˆæµè§ˆå™¨èƒ½å¬æ‡‚çš„"æ™®é€šè¯"ã€‚è½¬æ¢åçš„ä»£ç å¤§æ¦‚å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é¢„æ„å»ºå</span>
<span class="hljs-keyword">import</span> helper <span class="hljs-keyword">from</span> <span class="hljs-string">'./helper.js'</span>
â€‹
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">doSomething</span>(<span class="hljs-params"/>) {
 Â <span class="hljs-keyword">return</span> helper.<span class="hljs-title function_">process</span>()
}
</code></pre>
<h2 data-id="heading-3">æœ€å°å®ç°</h2>
<blockquote>
<p>æœ¬æ–‡å¯¹äº esbuild ä¸ä¼šåšå‡ºè¿‡å¤šèµ˜è¿°ï¼Œæœ‰å…´è¶£çš„è¯»è€…å¯ä»¥è‡ªå·±å»æŸ¥é˜…ç›¸å…³èµ„æ–™</p>
</blockquote>
<h3 data-id="heading-4">åˆ†æ</h3>
<p>é€šè¿‡æŸ¥çœ‹ä¸Šæ–‡çš„ä¸€ä¸ªæˆªå›¾ï¼Œæˆ‘ä»¬å¤§æ¦‚èƒ½çœ‹å‡ºï¼Œå…¶å®ä¾èµ–é¢„æ„å»ºï¼Œå°±æ˜¯å§ lodash è¿™ä¸ªåŒ…çš„å‡½æ•°éƒ½æ‰“åŒ…åˆ°äº†ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œç„¶ååšäº†ä¸€ä¸ªç»Ÿä¸€çš„å¯¼å‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥å®ç°çš„ä¾èµ–é¢„æ„å»ºï¼Œä¹Ÿå°±æ˜¯è¦å®Œæˆè¿™ä¸€ä¸ªç›®æ ‡ã€‚</p>
<p>è¦å®Œæˆè¿™ä¸ªç›®æ ‡å¦‚æœé‡‡ç”¨æ¯”è¾ƒåŸå§‹çš„æ–¹å¼ï¼Œè«è¿‡äºåœ¨ node ä¸­è¯»å–å…¥å£æ–‡ä»¶ï¼Œæ ¹æ®å¯¼å…¥çš„è·¯å¾„å»è¯»å–æ–‡ä»¶çš„å†…å®¹ï¼Œå†™å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œæœ€åæ·»åŠ ä¸€ç«¯ç»Ÿä¸€çš„å¯¼å‡ºå­—ç¬¦ä¸²ã€‚</p>
<p>è¿™ç§æƒ³æ³•å¥½åƒä¸€çœ‹æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å…¶ä¸­è¿˜æ˜¯æœ‰äº›é—®é¢˜çš„ï¼Œæ¯”å¦‚å…¥å£æ–‡ä»¶å¯¼å…¥çš„é‚£ä¸ªä¾èµ–æ–‡ä»¶ï¼Œå®ƒå†…éƒ¨è¿˜ä¾èµ–äº†å…¶ä»–æ–‡ä»¶ï¼Œå¦‚æœåªæ˜¯ç²—æš´çš„åˆ†æä¸€ä¸ªå…¥å£æ–‡ä»¶ï¼Œæœ€åçš„æ‰“åŒ…çš„å•æ–‡ä»¶ä¸€å®šæ˜¯ä¸å®Œæ•´çš„ï¼Œè€Œå…¶ä¸­è¿˜ä¼šå­˜åœ¨é‡å¤çš„ä¾èµ–å¼•å…¥ï¼Œæ¯”å¦‚ä¸€äº›é€šç”¨çš„å·¥å…·å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ¢ä¸€ç§æ€è·¯ã€‚</p>
<p>æˆ‘ä»¬èŠçš„ä¸œè¥¿æœ¬è´¨ä¸Šå°±æ˜¯ï¼š<strong>å¦‚ä½•ä»å•ä¸€å…¥å£ï¼Œé€’å½’åœ°æ„å»ºä¸€ä¸ª<code>ä¾èµ–å›¾</code>ï¼Œå¹¶æŒ‰ä¾èµ–é¡ºåºè¯»å–æ‰€æœ‰æ¨¡å—å†…å®¹</strong>ã€‚å› æ­¤å¤§æ¦‚æ‰§è¡Œçš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> ä»å…¥å£æ–‡ä»¶çš„ä¾èµ–å¼€å§‹ï¼Œæ¯”å¦‚ from './add'
<span class="hljs-bullet">2.</span> å†è§£æ add å†…éƒ¨çš„ import
<span class="hljs-bullet">3.</span> åç»­çš„ä¾èµ–æ–‡ä»¶ä¹Ÿæ‰§è¡Œè¿™ä¸ªé€»è¾‘
<span class="hljs-bullet">4.</span> ç›´åˆ°æœ€åæ²¡æœ‰æ–°çš„ä¾èµ–ä¸ºæ­¢
</code></pre>
<p>ç”Ÿæˆ<strong>ä¾èµ–å›¾</strong>ï¼Œä¸ºä»€ä¹ˆæ˜¯å›¾è€Œä¸æ˜¯æ ‘å‘¢ï¼Ÿæ¯•ç«Ÿä¸€æƒ³åˆ°é€’å½’ï¼Œå¾ˆå¤šæƒ…å†µä¸‹å¤§å®¶ä¸çº¦è€ŒåŒçš„å°±æƒ³åˆ°äº†æ ‘ç»“æ„ï¼Œæ ‘ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-css" lang="css"># æ ‘ç»“æ„
entry
 â”œâ”€ <span class="hljs-selector-tag">a</span>
 â”‚ Â  â””â”€ shared
 â””â”€ <span class="hljs-selector-tag">b</span>
 Â  Â  â””â”€ shared
</code></pre>
<p>é‚£å›¾ç»“æ„æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</p>
<ol start="0">
<li>
<p><strong>ä¸€ä¸ªæ¨¡å—å¯èƒ½è¢«å¤šä¸ªæ¨¡å—ä¾èµ–ï¼ˆå¤šçˆ¶èŠ‚ç‚¹ï¼‰</strong> ï¼šè¿™åœ¨çœŸå®é¡¹ç›®é‡Œå¤ªå¸¸è§äº†ï¼Œå·¥å…·å‡½æ•°ã€è¿è¡Œæ—¶å«ç‰‡ã€ç¬¬ä¸‰æ–¹åŒ…å†…éƒ¨çš„å°å·¥å…·â€¦â€¦æ ‘ç»“æ„å¤©ç”Ÿè¡¨è¾¾ä¸äº†â€œåŒä¸€ä¸ªä¸œè¥¿è¢«å¤šå¤„å¼•ç”¨ä½†åªå­˜åœ¨ä¸€ä»½â€ã€‚</p>
<p>ä»€ä¹ˆæ˜¯å¤šçˆ¶èŠ‚ç‚¹ï¼Œæ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">A</span><span class="hljs-selector-class">.js</span>  â”€â”€â”
 Â  Â  Â   â”œâ”€â”€&gt;  utils<span class="hljs-selector-class">.js</span>
<span class="hljs-selector-tag">B</span><span class="hljs-selector-class">.js</span>  â”€â”€â”˜
</code></pre>
<ul>
<li><code>A.js</code> é‡Œ <code>import utils from './utils.js'</code></li>
<li><code>B.js</code> é‡Œ <code>import utils from './utils.js'</code></li>
<li>è¿™ä¸ªæ—¥å¸¸ä¸­å¾ˆå¸¸è§ï¼Œäºæ˜¯ utils.js å°±å­˜åœ¨äº†ä¸¤ä¸ªçˆ¶èŠ‚ç‚¹äº†ï¼Œè¿™å°±æ˜¯å¤šçˆ¶èŠ‚ç‚¹</li>
</ul>
</li>
<li>
<p><strong>å¾ªç¯ä¾èµ–æ˜¯å­˜åœ¨çš„</strong>ï¼šæ¯”å¦‚ <code>a</code> import <code>b</code>ï¼Œ<code>b</code> åˆ import <code>a</code>ã€‚æ ‘è¦æ±‚â€œä»ä¸Šåˆ°ä¸‹ä¸èƒ½ç»•å›æ¥â€ï¼Œä½†ä¾èµ–å…³ç³»å°±æ˜¯å…è®¸ç»•å›æ¥çš„ï¼Œæ‰€ä»¥éœ€è¦ç”¨å›¾æ¥æè¿°ï¼Œå¹¶ä¸”ç”¨â€œè®¿é—®è¿‡å°±ä¸å†æ·±å…¥â€çš„æ–¹å¼é¿å…æ— é™é€’å½’ã€‚</p>
</li>
</ol>
<p>æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ä»ä¸€å¼€å§‹å°±ç”¨â€œä¾èµ–å›¾â€çš„è§†è§’å»åšï¼šä¸€è¾¹é€’å½’æ”¶é›†ä¾èµ–ï¼Œä¸€è¾¹ç”¨ç»å¯¹è·¯å¾„åšå»é‡ï¼Œä¿è¯æ¯ä¸ªæ¨¡å—æœ€å¤šå¤„ç†ä¸€æ¬¡ã€‚</p>
<h3 data-id="heading-5">æ„å»ºä¾èµ–å›¾</h3>
<p>å› æ­¤ç¬¬ä¸€æ­¥è®©æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œç»™æˆ‘ä¸€æ®µæ–‡ä»¶æºç å­—ç¬¦ä¸²ï¼Œåœ¨ä½¿ç”¨æ­£åˆ™åŒ¹é…å‡ºå¯¼å…¥è¯­å¥ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">/**
 * ä»æ–‡ä»¶å†…å®¹ä¸­è§£ææ‰€æœ‰çš„ import/export <span class="hljs-keyword">from</span> è¯­å¥ï¼Œæå–ä¾èµ–è·¯å¾„
 */
<span class="hljs-keyword">function</span> parseImports(content) {
 Â  Â <span class="hljs-keyword">const</span> <span class="hljs-keyword">imports</span> = []
â€‹
 Â  Â // åŒ¹é… import xxx <span class="hljs-keyword">from</span> <span class="hljs-comment">'xxx' æˆ– export xxx from 'xxx'</span>
 Â  Â <span class="hljs-keyword">const</span> importRegex =
 Â  Â  Â  Â /(?:import|export)\s+(?:[^<span class="hljs-comment">'"]*)\s+from\s+['"]([^'"]+)['"]/g</span>
â€‹
 Â  Â <span class="hljs-keyword">let</span> match
 Â  Â <span class="hljs-keyword">while</span> ((match = importRegex.exec(content)) !== null) {
 Â  Â  Â  Â <span class="hljs-keyword">imports</span>.push(match[<span class="hljs-number">1</span>])
 Â   }
â€‹
 Â  Â <span class="hljs-keyword">return</span> <span class="hljs-keyword">imports</span>
}
â€‹
// ä½¿ç”¨ lodash çš„å…¥å£æ–‡ä»¶ä¸¤ä¸ªå¯¼å…¥ä»£ç æ¥åšæµ‹è¯•
<span class="hljs-keyword">const</span> sourceCode = `export { <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> add } <span class="hljs-keyword">from</span> <span class="hljs-comment">'./add.js';</span>
export { <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> after } <span class="hljs-keyword">from</span> <span class="hljs-comment">'./after.js';`</span>
console.log(parseImports(sourceCode))
</code></pre>
<p>è¾“å…¥ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[ <span class="hljs-string">'./add.js'</span>, <span class="hljs-string">'./after.js'</span> ]</span>
</code></pre>
<p>é‚£ä¹ˆä¸‹ä¸€æ­¥è¦åšçš„äº‹æƒ…å°±æ˜¯ï¼Œå®ç°ä¸€ä¸ªé€’å½’éå†å‡½æ•°ï¼Œæ¥åå¤æ‰§è¡Œè¿™ä¸ªè¿‡ç¨‹ï¼Œåé¢çš„ä»£ç å°±æ²¡ä»€ä¹ˆç‰¹æ®Šçš„ï¼Œå¯ä»¥ç›´æ¥æµè§ˆä¸€ä¸‹ç›¸å¯¹å®Œå…¨çš„ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">'node:fs'</span>
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">'node:path'</span>
â€‹
<span class="hljs-keyword">const</span> entryFilePath = path.<span class="hljs-title function_">join</span>(
 Â  Â process.<span class="hljs-title function_">cwd</span>(),
 Â  Â <span class="hljs-string">'./node_modules/lodash-es/lodash.js'</span>
)
â€‹
<span class="hljs-comment">/**
 * ä»æ–‡ä»¶å†…å®¹ä¸­è§£ææ‰€æœ‰çš„ import/export from è¯­å¥ï¼Œæå–ä¾èµ–è·¯å¾„
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">parseImports</span>(<span class="hljs-params">content</span>) {
 Â  Â <span class="hljs-keyword">const</span> imports = []
â€‹
 Â  Â <span class="hljs-comment">// åŒ¹é… import xxx from 'xxx' æˆ– export xxx from 'xxx'</span>
 Â  Â <span class="hljs-keyword">const</span> importRegex =
 Â  Â  Â  Â <span class="hljs-regexp">/(?:import|export)\s+(?:[^'"]*)\s+from\s+['"]([^'"]+)['"]/g</span>
â€‹
 Â  Â <span class="hljs-keyword">let</span> match
 Â  Â <span class="hljs-keyword">while</span> ((match = importRegex.<span class="hljs-title function_">exec</span>(content)) !== <span class="hljs-literal">null</span>) {
 Â  Â  Â  Â imports.<span class="hljs-title function_">push</span>(match[<span class="hljs-number">1</span>])
 Â   }
â€‹
 Â  Â <span class="hljs-keyword">return</span> imports
}
â€‹
<span class="hljs-comment">/**
 * å°†ç›¸å¯¹è·¯å¾„è§£æä¸ºç»å¯¹è·¯å¾„
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">resolveModulePath</span>(<span class="hljs-params">importPath, currentFilePath</span>) {
 Â  Â <span class="hljs-keyword">const</span> currentDir = path.<span class="hljs-title function_">dirname</span>(currentFilePath)
 Â  Â <span class="hljs-keyword">return</span> path.<span class="hljs-title function_">resolve</span>(currentDir, importPath)
}
â€‹
<span class="hljs-comment">/**
 * é€’å½’è§£æä¾èµ–ï¼Œæ„å»ºä¾èµ–å›¾
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">buildDependencyGraph</span>(<span class="hljs-params">entryPath</span>) {
 Â  Â <span class="hljs-comment">// ä¾èµ–å›¾</span>
 Â  Â <span class="hljs-keyword">const</span> graph = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>()
 Â  Â <span class="hljs-comment">// å·²è®¿é—®è¿‡çš„æ–‡ä»¶</span>
 Â  Â <span class="hljs-keyword">const</span> visited = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>()
â€‹
 Â  Â <span class="hljs-keyword">function</span> <span class="hljs-title function_">traverse</span>(<span class="hljs-params">filePath</span>) {
 Â  Â  Â  Â <span class="hljs-comment">// è§„èŒƒåŒ–è·¯å¾„</span>
 Â  Â  Â  Â <span class="hljs-keyword">const</span> normalizedPath = path.<span class="hljs-title function_">normalize</span>(filePath)
â€‹
 Â  Â  Â  Â <span class="hljs-comment">// å·²è®¿é—®è¿‡åˆ™è·³è¿‡</span>
 Â  Â  Â  Â <span class="hljs-keyword">if</span> (visited.<span class="hljs-title function_">has</span>(normalizedPath)) {
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span>
 Â  Â  Â   }
â€‹
 Â  Â  Â  Â visited.<span class="hljs-title function_">add</span>(normalizedPath)
â€‹
 Â  Â  Â  Â <span class="hljs-comment">// è¯»å–æ–‡ä»¶å†…å®¹</span>
 Â  Â  Â  Â <span class="hljs-keyword">let</span> content
 Â  Â  Â  Â <span class="hljs-keyword">try</span> {
 Â  Â  Â  Â  Â  Â content = fs.<span class="hljs-title function_">readFileSync</span>(normalizedPath, <span class="hljs-string">'utf-8'</span>)
 Â  Â  Â   } <span class="hljs-keyword">catch</span> (err) {
 Â  Â  Â  Â  Â  Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`æ— æ³•è¯»å–æ–‡ä»¶: <span class="hljs-subst">${normalizedPath}</span>`</span>)
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span>
 Â  Â  Â   }
â€‹
 Â  Â  Â  Â <span class="hljs-comment">// è§£æ import è¯­å¥</span>
 Â  Â  Â  Â <span class="hljs-keyword">const</span> imports = <span class="hljs-title function_">parseImports</span>(content)
â€‹
 Â  Â  Â  Â <span class="hljs-comment">// è§£æä¸ºç»å¯¹è·¯å¾„</span>
 Â  Â  Â  Â <span class="hljs-keyword">const</span> dependencies = imports.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">imp</span> =&gt;</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-title function_">resolveModulePath</span>(imp, normalizedPath)
 Â  Â  Â   )
â€‹
 Â  Â  Â  Â <span class="hljs-comment">// å­˜å…¥ä¾èµ–å›¾</span>
 Â  Â  Â  Â graph.<span class="hljs-title function_">set</span>(normalizedPath, dependencies)
â€‹
 Â  Â  Â  Â <span class="hljs-comment">// é€’å½’å¤„ç†æ¯ä¸ªä¾èµ–</span>
 Â  Â  Â  Â <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> dep <span class="hljs-keyword">of</span> dependencies) {
 Â  Â  Â  Â  Â  Â <span class="hljs-title function_">traverse</span>(dep)
 Â  Â  Â   }
 Â   }
â€‹
 Â  Â <span class="hljs-title function_">traverse</span>(entryPath)
â€‹
 Â  Â <span class="hljs-keyword">return</span> graph
}
â€‹
<span class="hljs-comment">// æ„å»ºä¾èµ–å›¾</span>
<span class="hljs-keyword">const</span> dependencyGraph = <span class="hljs-title function_">buildDependencyGraph</span>(entryFilePath)
â€‹
<span class="hljs-comment">// è¾“å‡ºä¾èµ–å›¾ä¿¡æ¯</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`\nä¾èµ–å›¾æ„å»ºå®Œæˆï¼Œå…± <span class="hljs-subst">${dependencyGraph.size}</span> ä¸ªæ¨¡å—\n`</span>)
â€‹
<span class="hljs-comment">// æ‰“å°ä¾èµ–å›¾ç»“æ„</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [file, deps] <span class="hljs-keyword">of</span> dependencyGraph) {
 Â  Â <span class="hljs-keyword">const</span> relativePath = path.<span class="hljs-title function_">relative</span>(process.<span class="hljs-title function_">cwd</span>(), file)
 Â  Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`+ <span class="hljs-subst">${relativePath}</span>`</span>)
 Â  Â <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> dep <span class="hljs-keyword">of</span> deps) {
 Â  Â  Â  Â <span class="hljs-keyword">const</span> relativeDepPath = path.<span class="hljs-title function_">relative</span>(process.<span class="hljs-title function_">cwd</span>(), dep)
 Â  Â  Â  Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">` Â  â””â”€â”€ <span class="hljs-subst">${relativeDepPath}</span>`</span>)
 Â   }
}
</code></pre>
<p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">+ node_modules/lodash-es/lodash.js
 Â  â””â”€â”€ node_modules/lodash-es/add.js
 Â  â””â”€â”€ node_modules/lodash-es/after.js
+ node_modules/lodash-es/add.js
 Â  â””â”€â”€ node_modules/lodash-es/_createMathOperation.js
+ node_modules/lodash-es/_createMathOperation.js
 Â  â””â”€â”€ node_modules/lodash-es/_baseToNumber.js
 Â  â””â”€â”€ node_modules/lodash-es/_baseToString.js
+ node_modules/lodash-es/_baseToNumber.js
 Â  â””â”€â”€ node_modules/lodash-es/isSymbol.js
+ node_modules/lodash-es/isSymbol.js
 Â  â””â”€â”€ node_modules/lodash-es/_baseGetTag.js
 Â  â””â”€â”€ node_modules/lodash-es/isObjectLike.js
+ node_modules/lodash-es/_baseGetTag.js
 Â  â””â”€â”€ node_modules/lodash-es/_Symbol.js
 Â  â””â”€â”€ node_modules/lodash-es/_getRawTag.js
 Â  â””â”€â”€ node_modules/lodash-es/_objectToString.js
+ ...
</code></pre>
<p>æœ‰äº†è¿™ä¸ªä¾èµ–å›¾ä¹‹åï¼Œæˆ‘ä»¬ç¦»è¿™ä¸ªæ ¸å¿ƒå°±éå¸¸æ¥è¿‘äº†ï¼Œè¿™ä¸ªä¾èµ–å›¾ä¸€çœ¼çœ‹è¿‡å»ï¼Œéƒ½ä¸çŸ¥è¦å¦‚ä½•éå†æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜æ¬ ç¼ºä¸€ä¸ªæ­¥éª¤ï¼Œ<strong>æ‹“æ‰‘æ’åº</strong>ã€‚</p>
<h3 data-id="heading-6">æ‹“æ‰‘æ’åº</h3>
<p>å¦‚æœæŒ‰ç…§ä¸Šé¢ä¾èµ–å›¾åŒºè¿›è¡Œéå†è¯»å–ï¼Œè‚¯å®šä¼šå‡ºç°é—®é¢˜çš„ï¼Œä½†æ˜¯åœ¨å®é™…çš„ bundle ä¸­ï¼Œå°±ä¼šçˆ†ç‚¸ï¼Œè¦å¾—åˆ°æ­£ç¡®çš„ bundle å°±è¦åšåˆ° <strong>æ‰€æœ‰æ¨¡å—æŒ‰â€œä¾èµ–å…ˆã€ä½¿ç”¨åâ€çš„é¡ºåºæ’å¥½é˜Ÿ</strong>ï¼Œè€Œè¿™ä¸ªæ’é˜Ÿå°±æ˜¯æ‹“æ‰‘æ’åºã€‚</p>
<p>è€Œå®ç°çš„æ‰‹æ®µä¸åšé™åˆ¶ï¼Œæ¯•ç«Ÿåœ¨ ai å¦‚æ­¤æµè¡Œçš„æƒ…å†µï¼Œæˆ‘ç›¸ä¿¡ ai å¯ä»¥å†™çš„å¾ˆå¥½å¾ˆå®Œå–„ï¼Œè¿˜å¯ä»¥è§£é‡Šæ¯ä¸€è¡Œä»£ç çš„æ„ä¹‰ï¼Œæˆ‘è¿™é‡Œå°±ç›´æ¥è´´å‡ºä»£ç ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">/**
 * å¯¹ä¾èµ–å›¾åšæ‹“æ‰‘æ’åºï¼Œè¿”å›â€œä¾èµ–åœ¨å‰ã€è¢«ä¾èµ–åœ¨åâ€çš„æ¨¡å—é¡ºåº
 */</span>
function <span class="hljs-built_in">topologicalSort</span>(graph) {
 Â  Â const allNodes = new <span class="hljs-built_in">Set</span>()
â€‹
 Â  Â for (const [filePath, deps] of graph) {
 Â  Â  Â  Â allNodes<span class="hljs-selector-class">.add</span>(filePath)
 Â  Â  Â  Â for (const dep of deps) {
 Â  Â  Â  Â  Â  Â allNodes<span class="hljs-selector-class">.add</span>(dep)
 Â  Â  Â   }
 Â   }
â€‹
 Â  Â <span class="hljs-comment">// indegreeï¼šä¸€ä¸ªæ¨¡å—è¿˜å‰©å¤šå°‘â€œä¾èµ–â€æ²¡æœ‰è¢«å¤„ç†ï¼ˆä¾èµ–è¶Šå¤š indegree è¶Šå¤§ï¼‰</span>
 Â  Â const indegree = new <span class="hljs-built_in">Map</span>()
 Â  Â <span class="hljs-comment">// dependentsï¼šæŸä¸ªä¾èµ–è¢«å¤„ç†å®Œåï¼Œå“ªäº›æ¨¡å—å¯ä»¥è¢«æ¨è¿›</span>
 Â  Â const dependents = new <span class="hljs-built_in">Map</span>()
â€‹
 Â  Â for (const node of allNodes) {
 Â  Â  Â  Â indegree<span class="hljs-selector-class">.set</span>(node, <span class="hljs-number">0</span>)
 Â  Â  Â  Â dependents<span class="hljs-selector-class">.set</span>(node, new Set())
 Â   }
â€‹
 Â  Â for (const [filePath, deps] of graph) {
 Â  Â  Â  Â for (const dep of deps) {
 Â  Â  Â  Â  Â  Â if (!dependents.has(dep)) {
 Â  Â  Â  Â  Â  Â  Â  Â dependents<span class="hljs-selector-class">.set</span>(dep, new Set())
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â dependents<span class="hljs-selector-class">.get</span>(dep)<span class="hljs-selector-class">.add</span>(filePath)
 Â  Â  Â  Â  Â  Â indegree<span class="hljs-selector-class">.set</span>(filePath, (indegree.get(filePath) ?? <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>)
 Â  Â  Â   }
 Â   }
â€‹
 Â  Â const queue = <span class="hljs-selector-attr">[]</span>
 Â  Â for (const node of allNodes) {
 Â  Â  Â  Â if ((indegree.get(node) ?? <span class="hljs-number">0</span>) === <span class="hljs-number">0</span>) {
 Â  Â  Â  Â  Â  Â queue<span class="hljs-selector-class">.push</span>(node)
 Â  Â  Â   }
 Â   }
â€‹
 Â  Â const sorted = <span class="hljs-selector-attr">[]</span>
 Â  Â let idx = <span class="hljs-number">0</span>
 Â  Â while (idx &lt; queue.length) {
 Â  Â  Â  Â const node = queue<span class="hljs-selector-attr">[idx++]</span>
 Â  Â  Â  Â sorted<span class="hljs-selector-class">.push</span>(node)
â€‹
 Â  Â  Â  Â const nextNodes = dependents<span class="hljs-selector-class">.get</span>(node)
 Â  Â  Â  Â if (!nextNodes) continue
â€‹
 Â  Â  Â  Â for (const next of nextNodes) {
 Â  Â  Â  Â  Â  Â const nextIn = (indegree.get(next) ?? <span class="hljs-number">0</span>) - <span class="hljs-number">1</span>
 Â  Â  Â  Â  Â  Â indegree<span class="hljs-selector-class">.set</span>(next, nextIn)
 Â  Â  Â  Â  Â  Â if (nextIn === <span class="hljs-number">0</span>) {
 Â  Â  Â  Â  Â  Â  Â  Â queue<span class="hljs-selector-class">.push</span>(next)
 Â  Â  Â  Â  Â   }
 Â  Â  Â   }
 Â   }
â€‹
 Â  Â if (sorted.length !== allNodes.size) {
 Â  Â  Â  Â const cyclicNodes = <span class="hljs-selector-attr">[]</span>
 Â  Â  Â  Â for (const [node, deg] of indegree) {
 Â  Â  Â  Â  Â  Â if (deg &gt; <span class="hljs-number">0</span>) cyclicNodes<span class="hljs-selector-class">.push</span>(node)
 Â  Â  Â   }
 Â  Â  Â  Â throw new <span class="hljs-built_in">Error</span>(
 Â  Â  Â  Â  Â  Â `æ£€æµ‹åˆ°å¾ªç¯ä¾èµ–ï¼Œæ— æ³•å®Œæˆæ‹“æ‰‘æ’åºï¼š\n${cyclicNodes.join('\n')}`
 Â  Â  Â   )
 Â   }
â€‹
 Â  Â return sorted
}
</code></pre>
<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">[
  <span class="hljs-comment">// ...</span>
  <span class="hljs-string">'/Users/coderjc/Documents/test-code/åŸç”Ÿ/no-pre-bundle/node_modules/lodash-es/_baseGetTag.js'</span>,
  <span class="hljs-string">'/Users/coderjc/Documents/test-code/åŸç”Ÿ/no-pre-bundle/node_modules/lodash-es/isSymbol.js'</span>,
  <span class="hljs-string">'/Users/coderjc/Documents/test-code/åŸç”Ÿ/no-pre-bundle/node_modules/lodash-es/_baseToNumber.js'</span>,
  <span class="hljs-string">'/Users/coderjc/Documents/test-code/åŸç”Ÿ/no-pre-bundle/node_modules/lodash-es/_baseToString.js'</span>,
  <span class="hljs-string">'/Users/coderjc/Documents/test-code/åŸç”Ÿ/no-pre-bundle/node_modules/lodash-es/toNumber.js'</span>,
  <span class="hljs-string">'/Users/coderjc/Documents/test-code/åŸç”Ÿ/no-pre-bundle/node_modules/lodash-es/_createMathOperation.js'</span>,
  <span class="hljs-string">'/Users/coderjc/Documents/test-code/åŸç”Ÿ/no-pre-bundle/node_modules/lodash-es/toFinite.js'</span>,
  <span class="hljs-string">'/Users/coderjc/Documents/test-code/åŸç”Ÿ/no-pre-bundle/node_modules/lodash-es/add.js'</span>,
  <span class="hljs-string">'/Users/coderjc/Documents/test-code/åŸç”Ÿ/no-pre-bundle/node_modules/lodash-es/toInteger.js'</span>,
  <span class="hljs-string">'/Users/coderjc/Documents/test-code/åŸç”Ÿ/no-pre-bundle/node_modules/lodash-es/after.js'</span>,
  <span class="hljs-string">'/Users/coderjc/Documents/test-code/åŸç”Ÿ/no-pre-bundle/node_modules/lodash-es/lodash.js'</span>
]
</code></pre>
<p>æˆ‘ä»¬çš„ä¾‹å­ä¸­ä¸ºäº†æ›´å¥½çš„è§‚å¯Ÿï¼Œåªä¿ç•™äº† add å’Œ after ä¸¤ä¸ªå‡½æ•°çš„å¯¼å…¥ï¼Œä»ç»“æœæ¥çœ‹ï¼Œæ˜¯æ²¡ä»€ä¹ˆé—®é¢˜çš„ã€‚</p>
<p>åç»­çš„æ­¥éª¤å¤§æ¦‚å¯ä»¥æ‹†åˆ†ä¸ºä¸¤æ­¥ï¼Œä¸€æ­¥æ˜¯æºç è½¬æ¢ï¼Œä¸€æ­¥æ˜¯ bundle ç”Ÿæˆï¼Œè¿™ä¸€æ­¥å…¶å®æ¯”è¾ƒç®€å•ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ©ç”¨ esbuild æ¥å®Œæˆã€‚</p>
<p>å½“ç„¶ä¹Ÿå¯ä»¥è‡ªå·±å†™ï¼Œä¸è¿‡æˆ‘æ˜¯ç›´æ¥ä¸¢ç»™ ai å®ç°ï¼Œå¤§æ¦‚çš„ç»“æœå¦‚å›¾ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/20efef7ca650421f93df3879b6395a25~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJqYw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768224367&amp;x-signature=2An8YXG2ag4Y43s3tQKAaJfaJYw%3D" alt="image-20260105211550397.png" loading="lazy"/></p>
<h3 data-id="heading-7">ä½¿ç”¨ esbuild å®Œæˆæ„å»º</h3>
<p>å…¶å®åˆ©ç”¨ esbuild éƒ½ä¸éœ€è¦æˆ‘ä»¬å»è‡ªå·±å®ç°ä¾èµ–å›¾ä»€ä¹ˆçš„ï¼Œåªæ˜¯ä¸ºäº†è¯´æ˜å¤§æ¦‚åšäº†ä»€ä¹ˆäº‹æƒ…è€Œå†™çš„ï¼Œä¸‹é¢çœ‹çœ‹ä½¿ç”¨ esbuild å¦‚ä½•å®ç°ã€‚å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> esbuild <span class="hljs-keyword">from</span> <span class="hljs-string">'esbuild'</span>
â€‹
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">prebundleDeps</span>(<span class="hljs-params">deps</span>) {
 Â  Â <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(
 Â  Â  Â  Â deps.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">dep</span> =&gt;</span> {
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> esbuild.<span class="hljs-title function_">build</span>({
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">entryPoints</span>: [dep],
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">bundle</span>: <span class="hljs-literal">true</span>,
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">format</span>: <span class="hljs-string">'esm'</span>,
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">platform</span>: <span class="hljs-string">'browser'</span>,
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">outfile</span>: <span class="hljs-string">'./dist/lodash-es.js'</span>,
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">sourcemap</span>: <span class="hljs-literal">true</span>
 Â  Â  Â  Â  Â   })
 Â  Â  Â   })
 Â   )
}
â€‹
<span class="hljs-title function_">prebundleDeps</span>([<span class="hljs-string">'lodash-es'</span>])
</code></pre>
<p>æ‰“åŒ…ç»“æœå¦‚å›¾ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d2888223e2f44fa496d7590b1fe9c99b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZXJqYw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768224367&amp;x-signature=OgjaaveEhD6KK%2B0OdytNW2t2KOU%3D" alt="image-20260105211942893.png" loading="lazy"/></p>
<p>å¤§å®¶å¯ä»¥å’Œå‰æ–‡çš„ç½‘ç»œè¯·æ±‚çš„æ–‡ä»¶æˆªå›¾å¯¹æ¯”ä¸€ä¸‹ï¼Œç»“æœéƒ½æ˜¯ä¸€è‡´çš„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Core Data ç®€åŒ–å¼€å‘ï¼šNSPersistentContainer ä»åŸç†åˆ°å®æˆ˜]]></title>    <link>https://juejin.cn/post/7591687981688193070</link>    <guid>https://juejin.cn/post/7591687981688193070</guid>    <pubDate>2026-01-05T11:10:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591687981688193070" data-draft-id="7591694511246049318" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Core Data ç®€åŒ–å¼€å‘ï¼šNSPersistentContainer ä»åŸç†åˆ°å®æˆ˜"/> <meta itemprop="keywords" content="Swift"/> <meta itemprop="datePublished" content="2026-01-05T11:10:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="JQShan"/> <meta itemprop="url" content="https://juejin.cn/user/1636535083759005"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Core Data ç®€åŒ–å¼€å‘ï¼šNSPersistentContainer ä»åŸç†åˆ°å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1636535083759005/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    JQShan
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-05T11:10:54.000Z" title="Mon Jan 05 2026 11:10:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œä¸º iOS/macOS å¼€å‘è€…ï¼Œæœ¬åœ°æ•°æ®å­˜å‚¨æ˜¯ç»•ä¸å¼€çš„è¯é¢˜ã€‚æèµ· Core Dataï¼Œä¸å°‘æ–°æ‰‹ä¼šçš±çœ‰å¤´ â€”â€” æ—©æœŸçš„ Core Data é…ç½®ç¹çï¼Œæ‰‹åŠ¨ç®¡ç†ä¸Šä¸‹æ–‡ã€åè°ƒå™¨è¿™äº›ç»„ä»¶å¾ˆå®¹æ˜“è¸©å‘ï¼›è€Œè€å¼€å‘è€…åˆ™æ¸…æ¥šï¼Œè‡ªä» Apple æ¨å‡º<code>NSPersistentContainer</code>åï¼ŒCore Data çš„ä½¿ç”¨ä½“éªŒç›´æ¥ â€œèµ·é£â€ã€‚ä»Šå¤©å°±è·Ÿå¤§å®¶èŠèŠï¼Œè¿™ä¸ª â€œå®¹å™¨â€ åˆ°åº•æ˜¯ä»€ä¹ˆã€æ€ä¹ˆç”¨ï¼Œä»¥åŠå®ƒçš„é‚£äº›ä¼˜ç¼ºç‚¹ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€å…ˆå” å”  Core Data çš„ â€œè€ç—›ç‚¹â€</h2>
<p>åœ¨ iOS 10/macOS 10.12 ä¹‹å‰ï¼Œæƒ³ç”¨ Core Data å¾—æ‰‹åŠ¨æ­ä¸€å¥— â€œæµæ°´çº¿â€ï¼š</p>
<ol>
<li>åŠ è½½<code>NSManagedObjectModel</code>ï¼ˆæ•°æ®æ¨¡å‹ï¼‰ï¼›</li>
<li>åˆ›å»º<code>NSPersistentStoreCoordinator</code>ï¼ˆæŒä¹…åŒ–å­˜å‚¨åè°ƒå™¨ï¼‰ï¼ŒæŒ‡å®šå­˜å‚¨ç±»å‹ï¼ˆæ¯”å¦‚ SQLiteï¼‰å’Œè·¯å¾„ï¼›</li>
<li>å®ä¾‹åŒ–<code>NSManagedObjectContext</code>ï¼ˆæ‰˜ç®¡å¯¹è±¡ä¸Šä¸‹æ–‡ï¼‰ï¼Œå¹¶å…³è”åè°ƒå™¨ï¼›</li>
<li>è¿˜è¦å¤„ç†çº¿ç¨‹å®‰å…¨ã€ä¸Šä¸‹æ–‡åˆå¹¶è¿™äº›é—®é¢˜ã€‚</li>
</ol>
<p>ä¸€å¥—æ“ä½œä¸‹æ¥ï¼Œä»£ç åˆé•¿åˆå®¹æ˜“å‡ºé”™ï¼Œå…‰æ˜¯åˆå§‹åŒ–å°±èƒ½åŠé€€ä¸€åŠæ–°æ‰‹ã€‚Apple æ˜¾ç„¶ä¹Ÿå‘ç°äº†è¿™ä¸ªé—®é¢˜ï¼Œäºæ˜¯<code>NSPersistentContainer</code>åº”è¿è€Œç”Ÿ â€”â€” å®ƒæŠŠ Core Data çš„æ ¸å¿ƒç»„ä»¶å…¨ â€œæ‰“åŒ…â€ äº†ï¼Œè®©æˆ‘ä»¬ä¸ç”¨å†å…³å¿ƒåº•å±‚ç»†èŠ‚ï¼Œä¸“æ³¨äºä¸šåŠ¡é€»è¾‘å³å¯ã€‚</p>
<h2 data-id="heading-1">äºŒã€NSPersistentContainerï¼šCore Data çš„ â€œä¸€ç«™å¼å·¥å…·ç®±â€</h2>
<h3 data-id="heading-2">1. æ ¸å¿ƒåŸç†ï¼šå°è£…äº†ä»€ä¹ˆï¼Ÿ</h3>
<p><code>NSPersistentContainer</code>æœ¬è´¨æ˜¯å¯¹ Core Data ä¸‰å¤§æ ¸å¿ƒç»„ä»¶çš„å°è£…ï¼Œç›¸å½“äºç»™æˆ‘ä»¬å‡†å¤‡äº†ä¸€ä¸ªå¼€ç®±å³ç”¨çš„ â€œæ•°æ®ç®¡ç†å®¹å™¨â€ï¼Œå†…éƒ¨ç»“æ„å¦‚ä¸‹ï¼š</p>

























<table><thead><tr><th>ç»„ä»¶</th><th>ä½œç”¨</th><th>å®¹å™¨ä¸­çš„è®¿é—®æ–¹å¼</th></tr></thead><tbody><tr><td><code>NSManagedObjectModel</code></td><td>å®šä¹‰æ•°æ®ç»“æ„ï¼ˆå¯¹åº”.xcdatamodeld æ–‡ä»¶ï¼‰</td><td><code>container.managedObjectModel</code></td></tr><tr><td><code>NSPersistentStoreCoordinator</code></td><td>ç®¡ç†æ•°æ®å­˜å‚¨ï¼ˆæ¯”å¦‚ SQLite æ–‡ä»¶ï¼‰</td><td><code>container.persistentStoreCoordinator</code></td></tr><tr><td><code>NSManagedObjectContext</code></td><td>æ“ä½œæ•°æ®çš„ â€œå·¥ä½œå°â€ï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰</td><td><code>container.viewContext</code>ï¼ˆä¸»çº¿ç¨‹ï¼‰/<code>container.newBackgroundContext()</code>ï¼ˆåå°ï¼‰</td></tr></tbody></table>
<p>ç®€å•è¯´ï¼šä½ åªéœ€è¦å‘Šè¯‰å®¹å™¨ â€œæ•°æ®æ¨¡å‹å«ä»€ä¹ˆåå­—â€ï¼Œå®ƒä¼šè‡ªåŠ¨å®Œæˆæ¨¡å‹åŠ è½½ã€åè°ƒå™¨åˆ›å»ºã€ä¸Šä¸‹æ–‡å…³è”ç­‰æ‰€æœ‰åº•å±‚å·¥ä½œï¼Œä¸ç”¨å†™ä¸€è¡Œå†—ä½™ä»£ç ã€‚</p>
<h3 data-id="heading-3">2. æœ€æ ¸å¿ƒçš„ä¸¤ä¸ªä¸Šä¸‹æ–‡</h3>
<p>å®¹å™¨é‡Œæœ€å¸¸ç”¨çš„æ˜¯ä¸¤ä¸ªä¸Šä¸‹æ–‡ï¼Œä¸€å®šè¦åˆ†æ¸…ï¼š</p>
<ul>
<li><strong>viewContext</strong>ï¼šé»˜è®¤ç»‘å®š<strong>ä¸»çº¿ç¨‹</strong>ï¼Œä¸“é—¨ç”¨äº UI ç›¸å…³çš„æ“ä½œï¼ˆæ¯”å¦‚åˆ—è¡¨å±•ç¤ºè¯»ä¹¦ç¬”è®°ï¼‰ï¼Œçº¿ç¨‹å®‰å…¨ï¼Œç›´æ¥ç”¨å°±è¡Œï¼›</li>
<li><strong>newBackgroundContext()</strong> ï¼šæ¯æ¬¡è°ƒç”¨éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„åå°ä¸Šä¸‹æ–‡ï¼Œç”¨äºè€—æ—¶æ“ä½œï¼ˆæ¯”å¦‚æ‰¹é‡å¯¼å…¥å†å²è¯»ä¹¦ç¬”è®°ï¼‰ï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹å¯¼è‡´ UI å¡é¡¿ã€‚</li>
</ul>
<h2 data-id="heading-4">ä¸‰ã€å®æˆ˜ï¼šNSPersistentContainer çš„åŸºæœ¬ç”¨æ³•</h2>
<p>å…‰è¯´ä¸ç»ƒå‡æŠŠå¼ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªç®€å•çš„ â€œè¯»ä¹¦ç¬”è®°ç®¡ç†â€ ç¤ºä¾‹ï¼Œçœ‹çœ‹æ€ä¹ˆç”¨å®¹å™¨æå®š Core Data çš„å¢åˆ æ”¹æŸ¥ã€‚</p>
<h3 data-id="heading-5">å‰ç½®å‡†å¤‡</h3>
<ol>
<li>
<p>åˆ›å»º iOS é¡¹ç›®æ—¶å‹¾é€‰ã€ŒUse Core Dataã€ï¼ˆXcode ä¼šè‡ªåŠ¨ç”ŸæˆåŸºç¡€çš„å®¹å™¨ä»£ç ï¼‰ï¼›</p>
</li>
<li>
<p>æ‰“å¼€<code>.xcdatamodeld</code>æ–‡ä»¶ï¼Œåˆ›å»ºä¸€ä¸ª<code>BookNote</code>å®ä½“ï¼Œæ·»åŠ ä¸‰ä¸ªå±æ€§ï¼š</p>
<ul>
<li><code>bookName</code>ï¼ˆStringï¼Œä¹¦åï¼‰ï¼›</li>
<li><code>content</code>ï¼ˆStringï¼Œç¬”è®°å†…å®¹ï¼‰ï¼›</li>
<li><code>createTime</code>ï¼ˆDateï¼Œåˆ›å»ºæ—¶é—´ï¼Œé»˜è®¤å€¼å¯è®¾ä¸º<code>@now</code>ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-6">1. åˆå§‹åŒ–å®¹å™¨ï¼ˆXcode è‡ªåŠ¨ç”Ÿæˆï¼Œç¨ä½œä¼˜åŒ–ï¼‰</h3>
<p>AppDelegate ä¸­çš„æ ¸å¿ƒä»£ç ï¼Œæˆ‘ä»¬ä¼˜åŒ–ä¸‹é”™è¯¯å¤„ç†ï¼ˆåˆ«ç”¨ fatalErrorï¼Œå®é™…é¡¹ç›®è¦å‹å¥½ï¼‰ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> UIKit
<span class="hljs-keyword">import</span> CoreData

<span class="hljs-keyword">@UIApplicationMain</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AppDelegate</span>: <span class="hljs-title class_">UIResponder</span>, <span class="hljs-title class_">UIApplicationDelegate</span> {
    <span class="hljs-comment">// æ‡’åŠ è½½æŒä¹…åŒ–å®¹å™¨</span>
    <span class="hljs-keyword">lazy</span> <span class="hljs-keyword">var</span> persistentContainer: <span class="hljs-type">NSPersistentContainer</span> <span class="hljs-operator">=</span> {
        <span class="hljs-comment">// æ¨¡å‹æ–‡ä»¶åè¦å’Œ.xcdatamodeldæ–‡ä»¶åç§°ä¸€è‡´ï¼ˆæ¯”å¦‚æˆ‘å‘½åä¸ºBookNoteModelï¼‰</span>
        <span class="hljs-keyword">let</span> container <span class="hljs-operator">=</span> <span class="hljs-type">NSPersistentContainer</span>(name: <span class="hljs-string">"BookNoteModel"</span>) 
        
        <span class="hljs-comment">// åŠ è½½æŒä¹…åŒ–å­˜å‚¨ï¼ˆé»˜è®¤æ˜¯SQLiteæ–‡ä»¶ï¼Œå­˜å‚¨åœ¨Appæ²™ç›’ä¸­ï¼‰</span>
        container.loadPersistentStores(completionHandler: { (storeDescription, error) <span class="hljs-keyword">in</span>
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> error <span class="hljs-operator">=</span> error <span class="hljs-keyword">as</span> <span class="hljs-type">NSError</span>? {
                <span class="hljs-comment">// å®é™…é¡¹ç›®ä¸­æ›¿æ¢ä¸ºæ—¥å¿—/å¼¹çª—æç¤ºï¼Œåˆ«ç›´æ¥å´©æºƒ</span>
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"Core DataåŠ è½½å¤±è´¥ï¼š(error.localizedDescription)"</span>)
            }
        })
        <span class="hljs-keyword">return</span> container
    }()

    <span class="hljs-comment">// å°è£…ä¿å­˜ä¸Šä¸‹æ–‡çš„æ–¹æ³•ï¼Œå¤ç”¨æ€§æ›´é«˜</span>
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">saveContext</span>() {
        <span class="hljs-keyword">let</span> context <span class="hljs-operator">=</span> persistentContainer.viewContext
        <span class="hljs-keyword">guard</span> context.hasChanges <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> } <span class="hljs-comment">// æ²¡æœ‰ä¿®æ”¹å°±ä¸ä¿å­˜ï¼Œå‡å°‘IOæ¶ˆè€—</span>
        
        <span class="hljs-keyword">do</span> {
            <span class="hljs-keyword">try</span> context.save()
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"è¯»ä¹¦ç¬”è®°ä¿å­˜æˆåŠŸâœ…"</span>)
        } <span class="hljs-keyword">catch</span> {
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"ä¿å­˜å¤±è´¥âŒï¼š(error.localizedDescription)"</span>)
        }
    }
}
</code></pre>
<h3 data-id="heading-7">2. å¢åˆ æ”¹æŸ¥å®æˆ˜ï¼ˆViewController ä¸­ï¼‰</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> UIKit
<span class="hljs-keyword">import</span> CoreData

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewController</span>: <span class="hljs-title class_">UIViewController</span> {
    <span class="hljs-comment">// è·å–å®¹å™¨ï¼ˆå®é™…é¡¹ç›®å»ºè®®ç”¨å•ä¾‹/ä¾èµ–æ³¨å…¥ï¼Œåˆ«ç›´æ¥å¼ºè½¬AppDelegateï¼Œè¿™é‡Œä¸ºäº†ç®€åŒ–ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> container: <span class="hljs-type">NSPersistentContainer</span> {
        <span class="hljs-keyword">let</span> appDelegate <span class="hljs-operator">=</span> <span class="hljs-type">UIApplication</span>.shared.delegate <span class="hljs-keyword">as!</span> <span class="hljs-type">AppDelegate</span>
        <span class="hljs-keyword">return</span> appDelegate.persistentContainer
    }

    <span class="hljs-comment">// 1. æ·»åŠ è¯»ä¹¦ç¬”è®°</span>
    <span class="hljs-keyword">@IBAction</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">addBookNote</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">sender</span>: <span class="hljs-type">UIButton</span>) {
        <span class="hljs-keyword">let</span> context <span class="hljs-operator">=</span> container.viewContext
        <span class="hljs-comment">// åˆ›å»ºBookNoteå¯¹è±¡</span>
        <span class="hljs-keyword">let</span> note <span class="hljs-operator">=</span> <span class="hljs-type">BookNote</span>(context: context)
        note.bookName <span class="hljs-operator">=</span> <span class="hljs-string">"ã€Šå°ç‹å­ã€‹"</span>
        note.content <span class="hljs-operator">=</span> <span class="hljs-string">"æ­£æ˜¯ä½ ä¸ºä½ çš„ç«ç‘°èŠ±è´¹çš„æ—¶å…‰ï¼Œæ‰ä½¿ä½ çš„ç«ç‘°å˜å¾—å¦‚æ­¤é‡è¦ã€‚"</span>
        note.createTime <span class="hljs-operator">=</span> <span class="hljs-type">Date</span>() <span class="hljs-comment">// ä¹Ÿå¯ä»¥ä¾èµ–æ¨¡å‹çš„é»˜è®¤å€¼ï¼Œè¿™é‡Œæ‰‹åŠ¨èµ‹å€¼æ›´ç›´è§‚</span>
        
        <span class="hljs-comment">// è°ƒç”¨AppDelegateçš„ä¿å­˜æ–¹æ³•</span>
        (<span class="hljs-type">UIApplication</span>.shared.delegate <span class="hljs-keyword">as!</span> <span class="hljs-type">AppDelegate</span>).saveContext()
    }

    <span class="hljs-comment">// 2. æŸ¥è¯¢æ‰€æœ‰è¯»ä¹¦ç¬”è®°ï¼ˆå¯æŒ‰åˆ›å»ºæ—¶é—´å€’åºï¼‰</span>
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchAllBookNotes</span>() {
        <span class="hljs-keyword">let</span> context <span class="hljs-operator">=</span> container.viewContext
        <span class="hljs-comment">// åˆ›å»ºæŸ¥è¯¢è¯·æ±‚</span>
        <span class="hljs-keyword">let</span> fetchRequest: <span class="hljs-type">NSFetchRequest</span>&lt;<span class="hljs-type">BookNote</span>&gt; <span class="hljs-operator">=</span> <span class="hljs-type">BookNote</span>.fetchRequest()
        
        <span class="hljs-comment">// æŒ‰åˆ›å»ºæ—¶é—´å€’åºæ’åˆ—ï¼Œæœ€æ–°çš„ç¬”è®°åœ¨å‰é¢</span>
        <span class="hljs-keyword">let</span> sortDescriptor <span class="hljs-operator">=</span> <span class="hljs-type">NSSortDescriptor</span>(keyPath: \<span class="hljs-type">BookNote</span>.createTime, ascending: <span class="hljs-literal">false</span>)
        fetchRequest.sortDescriptors <span class="hljs-operator">=</span> [sortDescriptor]
        
        <span class="hljs-keyword">do</span> {
            <span class="hljs-keyword">let</span> notes <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> context.fetch(fetchRequest)
            notes.forEach { note <span class="hljs-keyword">in</span>
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ“š ä¹¦åï¼š(note.bookName ?? "</span>æœªçŸ¥<span class="hljs-string">")"</span>)
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"âœï¸ ç¬”è®°ï¼š(note.content ?? "</span>æ— å†…å®¹<span class="hljs-string">")"</span>)
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"ğŸ•’ åˆ›å»ºæ—¶é—´ï¼š(note.createTime ?? Date())<span class="hljs-subst">\n</span>"</span>)
            }
        } <span class="hljs-keyword">catch</span> {
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"æŸ¥è¯¢è¯»ä¹¦ç¬”è®°å¤±è´¥ï¼š(error.localizedDescription)"</span>)
        }
    }

    <span class="hljs-comment">// 3. åˆ é™¤è¯»ä¹¦ç¬”è®°ï¼ˆç¤ºä¾‹ï¼šåˆ é™¤ç¬¬ä¸€æ¡ã€Šå°ç‹å­ã€‹çš„ç¬”è®°ï¼‰</span>
    <span class="hljs-keyword">@IBAction</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">deleteBookNote</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">sender</span>: <span class="hljs-type">UIButton</span>) {
        <span class="hljs-keyword">let</span> context <span class="hljs-operator">=</span> container.viewContext
        <span class="hljs-keyword">let</span> fetchRequest: <span class="hljs-type">NSFetchRequest</span>&lt;<span class="hljs-type">BookNote</span>&gt; <span class="hljs-operator">=</span> <span class="hljs-type">BookNote</span>.fetchRequest()
        
        <span class="hljs-comment">// å¢åŠ ç­›é€‰æ¡ä»¶ï¼šåªåˆ ã€Šå°ç‹å­ã€‹çš„ç¬”è®°</span>
        fetchRequest.predicate <span class="hljs-operator">=</span> <span class="hljs-type">NSPredicate</span>(format: <span class="hljs-string">"bookName == %@"</span>, <span class="hljs-string">"ã€Šå°ç‹å­ã€‹"</span>)
        
        <span class="hljs-keyword">do</span> {
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> targetNote <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> context.fetch(fetchRequest).first {
                context.delete(targetNote) <span class="hljs-comment">// åˆ é™¤æŒ‡å®šç¬”è®°å¯¹è±¡</span>
                (<span class="hljs-type">UIApplication</span>.shared.delegate <span class="hljs-keyword">as!</span> <span class="hljs-type">AppDelegate</span>).saveContext()
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"ã€Šå°ç‹å­ã€‹çš„ç¬”è®°å·²åˆ é™¤"</span>)
            }
        } <span class="hljs-keyword">catch</span> {
            <span class="hljs-built_in">print</span>(<span class="hljs-string">"åˆ é™¤è¯»ä¹¦ç¬”è®°å¤±è´¥ï¼š(error.localizedDescription)"</span>)
        }
    }

    <span class="hljs-comment">// 4. åå°æ‰¹é‡å¯¼å…¥è¯»ä¹¦ç¬”è®°ï¼ˆé‡ç‚¹ï¼šç”¨åå°ä¸Šä¸‹æ–‡ï¼Œä¸å¡UIï¼‰</span>
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">batchImportBookNotes</span>() {
        <span class="hljs-comment">// åˆ›å»ºåå°ä¸Šä¸‹æ–‡</span>
        <span class="hljs-keyword">let</span> backgroundContext <span class="hljs-operator">=</span> container.newBackgroundContext()
        <span class="hljs-comment">// è®¾ç½®åˆå¹¶ç­–ç•¥ï¼Œé¿å…å¤šä¸Šä¸‹æ–‡æ“ä½œå†²çª</span>
        backgroundContext.mergePolicy <span class="hljs-operator">=</span> <span class="hljs-type">NSMergeByPropertyObjectTrumpMergePolicy</span>
        
        <span class="hljs-comment">// åœ¨åå°çº¿ç¨‹æ‰§è¡Œæ‰¹é‡æ“ä½œï¼Œä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹</span>
        backgroundContext.perform { [<span class="hljs-keyword">weak</span> <span class="hljs-keyword">self</span>] <span class="hljs-keyword">in</span>
            <span class="hljs-comment">// æ¨¡æ‹Ÿæ‰¹é‡å¯¼å…¥3æœ¬ç»å…¸ä¹¦ç±çš„ç¬”è®°</span>
            <span class="hljs-keyword">let</span> noteDatas <span class="hljs-operator">=</span> [
                (<span class="hljs-string">"ã€Šç™¾å¹´å­¤ç‹¬ã€‹"</span>, <span class="hljs-string">"ç”Ÿå‘½ä¸­çœŸæ­£é‡è¦çš„ä¸æ˜¯ä½ é­é‡äº†ä»€ä¹ˆï¼Œè€Œæ˜¯ä½ è®°ä½äº†å“ªäº›äº‹ï¼Œåˆæ˜¯å¦‚ä½•é“­è®°çš„ã€‚"</span>),
                (<span class="hljs-string">"ã€Šè§£å¿§æ‚è´§åº—ã€‹"</span>, <span class="hljs-string">"å…¶å®æ‰€æœ‰çº ç»“åšé€‰æ‹©çš„äººå¿ƒé‡Œæ—©å°±æœ‰äº†ç­”æ¡ˆï¼Œå’¨è¯¢åªæ˜¯æƒ³å¾—åˆ°å†…å¿ƒæ‰€å€¾å‘çš„é€‰æ‹©ã€‚"</span>),
                (<span class="hljs-string">"ã€Šæ´»ç€ã€‹"</span>, <span class="hljs-string">"äººæ˜¯ä¸ºäº†æ´»ç€æœ¬èº«è€Œæ´»ç€çš„ï¼Œè€Œä¸æ˜¯ä¸ºäº†æ´»ç€ä¹‹å¤–çš„ä»»ä½•äº‹ç‰©è€Œæ´»ç€ã€‚"</span>)
            ]
            
            <span class="hljs-comment">// å¾ªç¯åˆ›å»ºç¬”è®°å¯¹è±¡</span>
            <span class="hljs-keyword">for</span> (bookName, content) <span class="hljs-keyword">in</span> noteDatas {
                <span class="hljs-keyword">let</span> note <span class="hljs-operator">=</span> <span class="hljs-type">BookNote</span>(context: backgroundContext)
                note.bookName <span class="hljs-operator">=</span> bookName
                note.content <span class="hljs-operator">=</span> content
                note.createTime <span class="hljs-operator">=</span> <span class="hljs-type">Date</span>()
            }
            
            <span class="hljs-comment">// ä¿å­˜åå°ä¸Šä¸‹æ–‡çš„ä¿®æ”¹</span>
            <span class="hljs-keyword">do</span> {
                <span class="hljs-keyword">try</span> backgroundContext.save()
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ‰¹é‡å¯¼å…¥è¯»ä¹¦ç¬”è®°å®Œæˆâœ…"</span>)
            } <span class="hljs-keyword">catch</span> {
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ‰¹é‡å¯¼å…¥å¤±è´¥âŒï¼š(error.localizedDescription)"</span>)
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-8">å°æç¤º</h3>
<ul>
<li>åˆ«åœ¨ä¸»çº¿ç¨‹åšæ‰¹é‡å¯¼å…¥ / å¤§é‡æŸ¥è¯¢æ“ä½œï¼ä¸€å®šè¦ç”¨<code>newBackgroundContext()</code>ï¼›</li>
<li>åå°ä¸Šä¸‹æ–‡çš„<code>perform</code>æ–¹æ³•ä¼šè‡ªåŠ¨åœ¨å¯¹åº”çš„åå°çº¿ç¨‹æ‰§è¡Œä»£ç ï¼Œä¸ç”¨æ‰‹åŠ¨å†™ GCDï¼ˆæ¯”å¦‚<code>DispatchQueue.global().async</code>ï¼‰ï¼›</li>
<li>å®é™…é¡¹ç›®ä¸­ï¼Œå»ºè®®æŠŠ Core Data æ“ä½œå°è£…æˆå•ç‹¬çš„å·¥å…·ç±»ï¼ˆæ¯”å¦‚<code>BookNoteManager</code>ï¼‰ï¼ŒæŠŠå¢åˆ æ”¹æŸ¥çš„é€»è¾‘æŠ½ç¦»å‡ºæ¥ï¼ŒViewController åªè´Ÿè´£è°ƒç”¨ï¼Œä»£ç æ›´æ•´æ´æ˜“ç»´æŠ¤ã€‚</li>
</ul>
<h2 data-id="heading-9">å››ã€NSPersistentContainer çš„ä¼˜ç¼ºç‚¹</h2>
<h3 data-id="heading-10">ä¼˜ç‚¹ï¼šæ–°æ‰‹å‹å¥½ï¼Œæ•ˆç‡æ‹‰æ»¡</h3>
<ol>
<li><strong>æå¤§ç®€åŒ–é…ç½®</strong>ï¼šä¸ç”¨æ‰‹åŠ¨ç®¡ç†æ¨¡å‹ã€åè°ƒå™¨ã€ä¸Šä¸‹æ–‡çš„å…³è”ï¼Œå‡ è¡Œä»£ç å°±èƒ½åˆå§‹åŒ– Core Dataï¼›</li>
<li><strong>çº¿ç¨‹å®‰å…¨</strong>ï¼š<code>viewContext</code>é»˜è®¤ç»‘å®šä¸»çº¿ç¨‹ï¼Œé¿å…äº†æ–°æ‰‹æœ€å®¹æ˜“è¸©çš„ â€œçº¿ç¨‹æ··ä¹±â€ å‘ï¼›</li>
<li><strong>æ˜“äºæ‰©å±•</strong>ï¼šæ”¯æŒè‡ªå®šä¹‰å­˜å‚¨è·¯å¾„ã€å­˜å‚¨ç±»å‹ï¼ˆæ¯”å¦‚å†…å­˜å­˜å‚¨ï¼Œé€‚åˆæµ‹è¯•ï¼‰ï¼Œæ»¡è¶³è¿›é˜¶éœ€æ±‚ï¼›</li>
<li><strong>å®˜æ–¹ç»´æŠ¤</strong>ï¼šApple æŒç»­ä¼˜åŒ–ï¼Œå…¼å®¹æ€§å’Œç¨³å®šæ€§æœ‰ä¿éšœã€‚</li>
</ol>
<h3 data-id="heading-11">ç¼ºç‚¹ï¼šçµæ´»åº¦ç•¥æœ‰å¦¥å</h3>
<ol>
<li><strong>åº•å±‚å°è£…è¿‡æ·±</strong>ï¼šæ–°æ‰‹å¯èƒ½åªçŸ¥å…¶ç„¶ä¸çŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œé‡åˆ°å¤æ‚é—®é¢˜ï¼ˆæ¯”å¦‚è·¨ç‰ˆæœ¬æ•°æ®è¿ç§»ï¼‰æ—¶ï¼Œæ’æŸ¥èµ·æ¥æ¯”è¾ƒè´¹åŠ²ï¼›</li>
<li><strong>è‡ªå®šä¹‰é…ç½®ç¨éº»çƒ¦</strong>ï¼šå¦‚æœè¦ä¿®æ”¹é»˜è®¤çš„å­˜å‚¨è·¯å¾„ã€ç¼“å­˜å¤§å°ï¼Œéœ€è¦é¢å¤–å†™ä»£ç æ‹†è§£å®¹å™¨ï¼›</li>
<li><strong>ä¸æ”¯æŒè·¨å¹³å°ï¼ˆçº¯ Swiftï¼‰</strong> ï¼šCore Data æ˜¯ Apple ä¸“å±æ¡†æ¶ï¼Œå¦‚æœä½ æƒ³åšè·¨å¹³å° Appï¼ˆæ¯”å¦‚ iOS+Androidï¼‰ï¼Œè¿˜æ˜¯å¾—ç”¨ Realmã€SQLite.swift ç­‰ã€‚</li>
</ol>
<h2 data-id="heading-12">äº”ã€æœ€åèŠèŠï¼šä»€ä¹ˆæ—¶å€™ç”¨ NSPersistentContainerï¼Ÿ</h2>
<ul>
<li>âœ… <strong>æ¨èç”¨</strong>ï¼šç»å¤§å¤šæ•°å¸¸è§„ Appï¼ˆæ¯”å¦‚è¯»ä¹¦ç¬”è®°ã€å¤‡å¿˜å½•ã€å¾…åŠæ¸…å•ç±»ï¼‰ï¼Œåªéœ€è¦æœ¬åœ°å­˜å‚¨æ•°æ®ï¼Œä¸éœ€è¦å¤æ‚çš„è‡ªå®šä¹‰é…ç½®ï¼›</li>
<li>âŒ <strong>è°¨æ…ç”¨</strong>ï¼šå¦‚æœä½ éœ€è¦æ·±åº¦å®šåˆ¶ Core Data çš„åº•å±‚ï¼ˆæ¯”å¦‚è‡ªå®šä¹‰å­˜å‚¨åè°ƒå™¨ã€å¤æ‚çš„æ•°æ®è¿ç§»ç­–ç•¥ï¼‰ï¼Œå¯èƒ½éœ€è¦ç»“åˆåº•å±‚ API ä½¿ç”¨ï¼›</li>
<li>ğŸ“Œ <strong>æ›¿ä»£æ–¹æ¡ˆ</strong>ï¼šå¦‚æœè¿½æ±‚è·¨å¹³å° / çº¯ Swiftï¼Œå¯è€ƒè™‘ Realmã€GRDB.swiftï¼›å¦‚æœæ•°æ®é‡æå°ï¼Œç›´æ¥ç”¨ UserDefaults å°±è¡Œã€‚</li>
</ul>
<h2 data-id="heading-13">æ€»ç»“</h2>
<ol>
<li><code>NSPersistentContainer</code>æ˜¯ Apple ä¸ºç®€åŒ– Core Data å¼€å‘æ¨å‡ºçš„ â€œåˆ©å™¨â€ï¼Œå°è£…äº† Core Data çš„æ ¸å¿ƒç»„ä»¶ï¼ŒiOS 10 + å¯ç›´æ¥ç”¨ï¼›</li>
<li>æ ¸å¿ƒç”¨æ³•ï¼šåˆå§‹åŒ–å®¹å™¨â†’ç”¨<code>viewContext</code>å¤„ç† UI ç›¸å…³æ“ä½œï¼ˆæ¯”å¦‚å±•ç¤ºè¯»ä¹¦ç¬”è®°ï¼‰â†’ç”¨<code>newBackgroundContext()</code>å¤„ç†åå°è€—æ—¶æ“ä½œï¼ˆæ¯”å¦‚æ‰¹é‡å¯¼å…¥ï¼‰â†’ä¿å­˜ä¸Šä¸‹æ–‡ï¼›</li>
<li>å®ƒçš„ä¼˜ç‚¹æ˜¯ç®€å•ã€å®‰å…¨ã€é«˜æ•ˆï¼Œç¼ºç‚¹æ˜¯åº•å±‚å°è£…è¿‡æ·±ï¼Œçµæ´»åº¦ç•¥æœ‰å¦¥åï¼Œé€‚åˆç»å¤§å¤šæ•°å¸¸è§„ iOS/macOS é¡¹ç›®ã€‚</li>
</ol>
<p>Core Data çœ‹ä¼¼å¤æ‚ï¼Œä½†æœ‰äº†<code>NSPersistentContainer</code>è¿™ä¸ª â€œå¸®æ‰‹â€ï¼Œæ–°æ‰‹ä¹Ÿèƒ½å¿«é€Ÿä¸Šæ‰‹ã€‚ä¸å…¶çº ç»“åº•å±‚åŸç†ï¼Œä¸å¦‚å…ˆåŠ¨æ‰‹å†™èµ·æ¥ï¼Œé‡åˆ°é—®é¢˜å†æ·±å…¥ç ”ç©¶ï¼Œæ¯•ç«Ÿå®è·µæ‰æ˜¯æœ€å¥½çš„è€å¸ˆï½</p>
<hr/>
<h3 data-id="heading-14">å…³é”®ç‚¹å›é¡¾</h3>
<ol>
<li>ç¤ºä¾‹åœºæ™¯æ›¿æ¢ä¸ºã€Œè¯»ä¹¦ç¬”è®°ç®¡ç†ã€ï¼Œå®ä½“<code>BookNote</code>åŒ…å«<code>bookName</code>ï¼ˆä¹¦åï¼‰ã€<code>content</code>ï¼ˆç¬”è®°å†…å®¹ï¼‰ã€<code>createTime</code>ï¼ˆåˆ›å»ºæ—¶é—´ï¼‰ä¸‰ä¸ªæ ¸å¿ƒå±æ€§ï¼›</li>
<li>æ ¸å¿ƒä»£ç é€»è¾‘ä¸å˜ï¼Œä½†æ‰€æœ‰å¢åˆ æ”¹æŸ¥ã€æ‰¹é‡å¯¼å…¥çš„æ“ä½œéƒ½å›´ç»• â€œè¯»ä¹¦ç¬”è®°â€ å±•å¼€ï¼Œæ›´è´´è¿‘æ—¥å¸¸å¼€å‘åœºæ™¯ï¼›</li>
<li>ä¿ç•™äº†åŸåšå®¢è½»æ¾çš„è¯­æ°”å’Œå®Œæ•´çš„è®²è§£ç»“æ„ï¼ŒåŒæ—¶è¡¥å……äº†æ’åºã€ç­›é€‰ç­‰æ›´å®ç”¨çš„æŸ¥è¯¢æŠ€å·§ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue 3 Message ç»„ä»¶æ·±åº¦è§£æï¼šä»è®¾è®¡åˆ°å®ç°çš„å®Œæ•´æŒ‡å—]]></title>    <link>https://juejin.cn/post/7591705084671328294</link>    <guid>https://juejin.cn/post/7591705084671328294</guid>    <pubDate>2026-01-05T15:26:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7591705084671328294" data-draft-id="7591728734982979611" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue 3 Message ç»„ä»¶æ·±åº¦è§£æï¼šä»è®¾è®¡åˆ°å®ç°çš„å®Œæ•´æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,JavaScript"/> <meta itemprop="datePublished" content="2026-01-05T15:26:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Spirited_Away"/> <meta itemprop="url" content="https://juejin.cn/user/2225067267204935"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue 3 Message ç»„ä»¶æ·±åº¦è§£æï¼šä»è®¾è®¡åˆ°å®ç°çš„å®Œæ•´æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2225067267204935/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Spirited_Away
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-05T15:26:05.000Z" title="Mon Jan 05 2026 15:26:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"ğŸ‹"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"ğŸ“"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"ğŸ‘"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"ğŸ‰"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"ğŸ’"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="androidstudio">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#a9b7c6;background:#282b2e}.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#6897bb}.hljs-deletion,.hljs-keyword,.hljs-selector-tag{color:#cc7832}.hljs-link,.hljs-template-variable,.hljs-variable{color:#629755}.hljs-comment,.hljs-quote{color:grey}.hljs-meta{color:#bbb529}.hljs-addition,.hljs-attribute,.hljs-string{color:#6a8759}.hljs-section,.hljs-title,.hljs-type{color:#ffc66d}.hljs-name,.hljs-selector-class,.hljs-selector-id{color:#e8bf6a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¦‚è¿°</h2>
<p>Message ç»„ä»¶æ˜¯å‰ç«¯ UI åº“ä¸­å¸¸è§çš„æç¤ºç»„ä»¶ï¼Œç”¨äºå‘ç”¨æˆ·æä¾›å³æ—¶åé¦ˆä¿¡æ¯ã€‚æœ¬æ–‡å°†è¯¦ç»†åˆ†æä¸€ä¸ªåŸºäº Vue 3 çš„ Message ç»„ä»¶å®ç°ï¼Œæ¶µç›–ç»„ä»¶è®¾è®¡ã€ç±»å‹å®šä¹‰ã€å®ä¾‹ç®¡ç†ç­‰å…³é”®ç»†èŠ‚ã€‚è¿™ä¸ªç»„ä»¶ä¸ä»…å®ç°äº†åŸºæœ¬çš„æç¤ºåŠŸèƒ½ï¼Œè¿˜è§£å†³äº†å¤šå®ä¾‹å †å ã€åŠ¨æ€å¸ƒå±€ã€å†…å­˜ç®¡ç†ç­‰å¤æ‚é—®é¢˜ã€‚</p>
<h2 data-id="heading-1">ç±»å‹ç³»ç»Ÿè®¾è®¡</h2>
<p>åœ¨Â <code>types.ts</code> ä¸­å®šä¹‰äº†å®Œæ•´çš„ç±»å‹ç³»ç»Ÿï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">MessageProps</span> {
  <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> | <span class="hljs-title class_">VNode</span>;                    <span class="hljs-comment">// æ”¯æŒå­—ç¬¦ä¸²å’ŒVNodeå†…å®¹</span>
  <span class="hljs-keyword">type</span>?: <span class="hljs-string">'success'</span> | <span class="hljs-string">'info'</span> | <span class="hljs-string">'warning'</span> | <span class="hljs-string">'danger'</span>;  <span class="hljs-comment">// æ¶ˆæ¯ç±»å‹</span>
  duration?: <span class="hljs-built_in">number</span>;                          <span class="hljs-comment">// æ˜¾ç¤ºæŒç»­æ—¶é—´</span>
  offset?: <span class="hljs-built_in">number</span>;                           <span class="hljs-comment">// åç§»è·ç¦»</span>
  showClose?: <span class="hljs-built_in">boolean</span>;                       <span class="hljs-comment">// æ˜¯å¦æ˜¾ç¤ºå…³é—­æŒ‰é’®</span>
  showIcon?: <span class="hljs-built_in">boolean</span>;                        <span class="hljs-comment">// æ˜¯å¦æ˜¾ç¤ºå›¾æ ‡</span>
  id?: <span class="hljs-built_in">string</span>;                               <span class="hljs-comment">// å”¯ä¸€æ ‡è¯†</span>
  <span class="hljs-attr">onDestory</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>                      <span class="hljs-comment">// é”€æ¯å›è°ƒ</span>
}
</code></pre>
<p><strong>è®¾è®¡äº®ç‚¹</strong>ï¼š</p>
<ul>
<li>æ”¯æŒå­—ç¬¦ä¸²å’Œ VNode ä¸¤ç§å†…å®¹ç±»å‹ï¼Œæé«˜ç»„ä»¶çµæ´»æ€§</li>
<li>ä½¿ç”¨Â <code>Omit&lt;MessageProps, 'id' | "onDestory"&gt;</code>Â åˆ›å»ºÂ <code>CreateMessageProps</code>Â ç±»å‹ï¼Œè‡ªåŠ¨æ’é™¤å†…éƒ¨ç®¡ç†çš„å±æ€§</li>
<li>ä¸¥æ ¼éµå¾ªé¡¹ç›®è§„èŒƒï¼Œç¡®ä¿å¿…ä¼ å±æ€§ä¸è¢«é—æ¼</li>
</ul>
<h2 data-id="heading-2">æ ¸å¿ƒç»„ä»¶å®ç°</h2>
<h3 data-id="heading-3">1. Message.vue ç»„ä»¶</h3>
<h4 data-id="heading-4">å±æ€§å®šä¹‰å’Œé»˜è®¤å€¼</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> props = <span class="hljs-title function_">withDefaults</span>(defineProps&lt;<span class="hljs-title class_">MessageProps</span>&gt;(), {
  <span class="hljs-attr">type</span>: <span class="hljs-string">'info'</span>,
  <span class="hljs-attr">duration</span>: <span class="hljs-number">3000</span>,
  <span class="hljs-attr">showIcon</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">offset</span>: <span class="hljs-number">16</span>
})
</code></pre>
<h4 data-id="heading-5">å›¾æ ‡æ˜ å°„ç³»ç»Ÿ</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> iconMap = {
  <span class="hljs-attr">primary</span>: <span class="hljs-string">'circle-info'</span>,
  <span class="hljs-attr">success</span>: <span class="hljs-string">'circle-check'</span>, 
  <span class="hljs-attr">warning</span>: <span class="hljs-string">'circle-exclamation'</span>,
  <span class="hljs-attr">danger</span>: <span class="hljs-string">'triangle-exclamation'</span>,
  <span class="hljs-attr">info</span>: <span class="hljs-string">'circle-info'</span>
}
</code></pre>
<p><strong>è®¾è®¡ç»†èŠ‚</strong>ï¼š</p>
<ul>
<li>å›¾æ ‡æ˜ å°„ç¡®ä¿ä¸åŒç±»å‹çš„æ¶ˆæ¯æœ‰å¯¹åº”çš„è§†è§‰æ ‡è¯†</li>
<li>ä½¿ç”¨ Font Awesome å›¾æ ‡ç³»ç»Ÿï¼Œç¬¦åˆé¡¹ç›®æŠ€æœ¯é€‰å‹</li>
</ul>
<h4 data-id="heading-6">å®šæ—¶å™¨ç®¡ç†</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">let</span> <span class="hljs-attr">timer</span>: <span class="hljs-title class_">NodeJS</span>.<span class="hljs-property">Timeout</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">startTimer</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">if</span> (props.<span class="hljs-property">duration</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>
  timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    visible.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>
    props.<span class="hljs-title function_">onDestory</span>()
  }, props.<span class="hljs-property">duration</span>)
}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">clearTimer</span>(<span class="hljs-params"/>) {
  <span class="hljs-built_in">clearTimeout</span>(timer)
}
</code></pre>
<p><strong>äº¤äº’ç»†èŠ‚</strong>ï¼š</p>
<ul>
<li>é¼ æ ‡æ‚¬åœæ—¶æš‚åœè‡ªåŠ¨å…³é—­ (<code>@mouseenter="clearTimer"</code>)</li>
<li>é¼ æ ‡ç¦»å¼€æ—¶é‡æ–°å¼€å§‹è®¡æ—¶ (<code>@mouseleave="startTimer"</code>)</li>
<li><code>duration</code>Â ä¸º 0 æ—¶ç¦ç”¨è‡ªåŠ¨å…³é—­åŠŸèƒ½</li>
</ul>
<h4 data-id="heading-7">ç»„ä»¶æš´éœ²æ¥å£</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">defineExpose</span>({
  <span class="hljs-attr">close</span>: <span class="hljs-function">() =&gt;</span> {
    visible.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>
  }
})
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li>é€šè¿‡Â <code>defineExpose</code>Â æš´éœ²Â <code>close</code>Â æ–¹æ³•ï¼Œå…è®¸å¤–éƒ¨æ‰‹åŠ¨å…³é—­æ¶ˆæ¯</li>
<li>ç¬¦åˆ Vue 3 çš„å°è£…åŸåˆ™ï¼Œåªæš´éœ²å¿…è¦çš„æ¥å£</li>
</ul>
<h2 data-id="heading-8">å®ä¾‹ç®¡ç†æœºåˆ¶</h2>
<h3 data-id="heading-9">1. å…¨å±€å®ä¾‹ç®¡ç†</h3>
<p>åœ¨Â <code>index.ts</code>ä¸­å®ç°äº†å®Œæ•´çš„å®ä¾‹ç®¡ç†ç³»ç»Ÿï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">MessageInstance</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>,
  <span class="hljs-attr">el</span>: <span class="hljs-title class_">HTMLElement</span>,
  <span class="hljs-attr">instance</span>: <span class="hljs-title class_">InstanceType</span>&lt;<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Message</span>&gt;,
  <span class="hljs-attr">offset</span>: <span class="hljs-built_in">number</span>
}
</code></pre>
<p><strong>è®¾è®¡ç»†èŠ‚</strong>ï¼š</p>
<ul>
<li>æ¯ä¸ªå®ä¾‹åŒ…å« IDã€DOM å…ƒç´ ã€ç»„ä»¶å®ä¾‹å’Œè®¡ç®—å‡ºçš„åç§»é‡</li>
</ul>
<h3 data-id="heading-10">2. å”¯ä¸€IDç”Ÿæˆ</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">let</span> index = <span class="hljs-number">1</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">messageInstances</span>: <span class="hljs-title class_">MessageInstance</span>[] = []
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">HmMessage</span>(<span class="hljs-params">props: CreateMessageProps</span>): <span class="hljs-title class_">InstanceType</span>&lt;<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Message</span>&gt; {
  <span class="hljs-keyword">const</span> id = <span class="hljs-string">`message_<span class="hljs-subst">${index++}</span>`</span>
  <span class="hljs-comment">// ...</span>
}
</code></pre>
<p><strong>å®ç°ç»†èŠ‚</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨é€’å¢ç´¢å¼•ç¡®ä¿æ¯ä¸ªæ¶ˆæ¯å®ä¾‹æœ‰å”¯ä¸€ID</li>
<li>IDç”¨äºå®ä¾‹æŸ¥æ‰¾å’Œç®¡ç†ï¼Œé¿å…å†²çª</li>
</ul>
<h3 data-id="heading-11">3. åŠ¨æ€æ¸²æŸ“ç­–ç•¥</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">render</span>(<span class="hljs-title function_">h</span>(<span class="hljs-title class_">Message</span>, {
  ...props, id,
  offset,
  <span class="hljs-attr">onVnodeMounted</span>: <span class="hljs-function">(<span class="hljs-params">vnode: VNode</span>) =&gt;</span> {
    componentInstance = vnode.<span class="hljs-property">component</span>;
  },
  <span class="hljs-attr">onDestory</span>: close
}), container)

<span class="hljs-title function_">nextTick</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> el = container.<span class="hljs-property">firstElementChild</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLElement</span>
  el &amp;&amp; <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(el)
  <span class="hljs-comment">// æ·»åŠ åˆ°å®ä¾‹æ•°ç»„</span>
})
</code></pre>
<p><strong>æŠ€æœ¯ç»†èŠ‚</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨Â <code>render</code>Â å‡½æ•°åŠ¨æ€æ¸²æŸ“ç»„ä»¶ï¼Œç¬¦åˆ Vue 3 çš„æ¸²æŸ“ API</li>
<li>é€šè¿‡Â <code>onVnodeMounted</code>Â é’©å­è·å–ç»„ä»¶å®ä¾‹</li>
<li><code>nextTick</code>Â ç¡®ä¿ DOM æ¸²æŸ“å®Œæˆåå†æ·»åŠ åˆ° body</li>
</ul>
<h3 data-id="heading-12">4. å‚ç›´æ’åˆ—ç®—æ³•</h3>
<p><code>calculateOffset</code>å‡½æ•°å®ç°äº†æ™ºèƒ½çš„å‚ç›´æ’åˆ—ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">calculateOffset</span>(<span class="hljs-params">baseOffset, lastMessage?: MessageInstance, delFirstEl = <span class="hljs-literal">false</span></span>) {
  <span class="hljs-comment">// é”€æ¯è®¡ç®—æ—¶ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ç‰¹æ®Šå¤„ç†</span>
  <span class="hljs-keyword">if</span> (messageInstances.<span class="hljs-property">length</span> === <span class="hljs-number">0</span> || (delFirstEl &amp;&amp; !lastMessage)) {
    <span class="hljs-keyword">return</span> baseOffset;
  }

  lastMessage = lastMessage || messageInstances[messageInstances.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>];
  <span class="hljs-keyword">const</span> lastElement = lastMessage.<span class="hljs-property">el</span>;
  <span class="hljs-keyword">const</span> lastHeight = lastElement.<span class="hljs-property">offsetHeight</span>;
  <span class="hljs-keyword">const</span> lastOffset = lastMessage.<span class="hljs-property">offset</span>;

  <span class="hljs-keyword">return</span> lastOffset + lastHeight + baseOffset;
}
</code></pre>
<p><strong>ç®—æ³•é€»è¾‘</strong>ï¼š</p>
<ul>
<li>è·å–å‰ä¸€ä¸ªæ¶ˆæ¯çš„é«˜åº¦å’Œä½ç½®</li>
<li>ä½¿ç”¨Â <code>offsetHeight</code>Â è·å–å®é™…æ¸²æŸ“é«˜åº¦ï¼Œæå‡å¸ƒå±€å‡†ç¡®æ€§</li>
<li>è®¡ç®—æ–°æ¶ˆæ¯çš„å‚ç›´åç§»é‡ï¼Œç¡®ä¿æ¶ˆæ¯ä¹‹é—´æœ‰é€‚å½“çš„é—´è·</li>
</ul>
<h2 data-id="heading-13">å…³é—­å’Œé”€æ¯æœºåˆ¶</h2>
<h3 data-id="heading-14">1. å®ä¾‹ç§»é™¤é€»è¾‘</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">close</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> index = messageInstances.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span> === id)
  <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
    messageInstances.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>)
  }
  componentInstance?.<span class="hljs-property">exposed</span>?.<span class="hljs-property">close</span>?.()
  <span class="hljs-comment">// é‡æ–°è®¡ç®—åç»­ç»„ä»¶çš„offset</span>
  <span class="hljs-keyword">let</span> preIndex = index
  messageInstances.<span class="hljs-title function_">slice</span>(index).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
    item.<span class="hljs-property">offset</span> = <span class="hljs-title function_">calculateOffset</span>(props.<span class="hljs-property">offset</span> || <span class="hljs-number">16</span>, messageInstances[preIndex - <span class="hljs-number">1</span>], <span class="hljs-literal">true</span>)
    item.<span class="hljs-property">el</span>.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = <span class="hljs-string">`<span class="hljs-subst">${item.offset}</span>px`</span>
    preIndex++
  })
}
</code></pre>
<p><strong>é”€æ¯ç»†èŠ‚</strong>ï¼š</p>
<ul>
<li>ä»å®ä¾‹æ•°ç»„ä¸­ç§»é™¤å½“å‰æ¶ˆæ¯</li>
<li>è°ƒç”¨ç»„ä»¶çš„Â <code>close</code>Â æ–¹æ³•è§¦å‘åŠ¨ç”»</li>
<li>é‡æ–°è®¡ç®—å¹¶æ›´æ–°åç»­æ¶ˆæ¯çš„ä½ç½®ï¼Œé¿å…å‡ºç°è·³è·ƒ</li>
<li>ä½¿ç”¨Â <code>slice(index)</code>Â è·å–æ‰€æœ‰åç»­å®ä¾‹ï¼Œç¡®ä¿å¸ƒå±€ç´§å‡‘æ— ç©ºéš™</li>
</ul>
<h2 data-id="heading-15">æ ·å¼å’ŒåŠ¨ç”»</h2>
<h3 data-id="heading-16">è¿‡æ¸¡åŠ¨ç”»</h3>
<pre><code class="hljs language-vue" lang="vue">&lt;Transition name="fade-up"&gt;
  &lt;div class="hm-message" v-if="visible"&gt;
    &lt;!-- æ¶ˆæ¯å†…å®¹ --&gt;
  &lt;/div&gt;
&lt;/Transition&gt;
</code></pre>
<p><strong>åŠ¨ç”»ç»†èŠ‚</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨Â <code>fade-up</code>Â è¿‡æ¸¡æ•ˆæœï¼Œæä¾›å¹³æ»‘çš„æ˜¾ç¤º/éšè—ä½“éªŒ</li>
<li>CSS ç±»åéµå¾ª BEM è§„èŒƒ</li>
<li>åŠ¨ç”»å®šä¹‰åœ¨å…¨å±€æ ·å¼ä¸­ï¼Œç¡®ä¿ä¸€è‡´æ€§</li>
</ul>
<h2 data-id="heading-17">å†…å®¹æ¸²æŸ“ç­–ç•¥</h2>
<h3 data-id="heading-18">VNode æ”¯æŒ</h3>
<pre><code class="hljs language-vue" lang="vue">&lt;slot&gt;
  &lt;RenderVNode :vnode="message" v-if="message" /&gt;
&lt;/slot&gt;
</code></pre>
<p><strong>å®ç°ç»†èŠ‚</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨Â <code>RenderVNode</code> ç»„ä»¶æ¸²æŸ“ VNode</li>
<li>æ”¯æŒå¤æ‚å†…å®¹çš„åŠ¨æ€æ¸²æŸ“</li>
<li>åŒæ—¶å…¼å®¹å­—ç¬¦ä¸²å’Œ VNode ä¸¤ç§å†…å®¹ç±»å‹</li>
</ul>
<h2 data-id="heading-19">ä½¿ç”¨æ–¹å¼</h2>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// åˆ›å»ºæ¶ˆæ¯</span>
<span class="hljs-keyword">const</span> message = <span class="hljs-title class_">HmMessage</span>({
  <span class="hljs-attr">message</span>: <span class="hljs-string">'æ“ä½œæˆåŠŸ'</span>,
  <span class="hljs-attr">type</span>: <span class="hljs-string">'success'</span>,
  <span class="hljs-attr">duration</span>: <span class="hljs-number">3000</span>,
  <span class="hljs-attr">showClose</span>: <span class="hljs-literal">true</span>
})

<span class="hljs-comment">// æ‰‹åŠ¨å…³é—­</span>
message.<span class="hljs-title function_">close</span>()
</code></pre>
<p><strong>æœ€ä½³å®è·µ</strong>ï¼š</p>
<ul>
<li>å¿…é¡»ä¼ å…¥Â <code>message</code>Â å’ŒÂ <code>type</code>Â å±æ€§</li>
<li>å¯é€šè¿‡è¿”å›çš„å®ä¾‹å¯¹è±¡æ‰‹åŠ¨å…³é—­æ¶ˆæ¯</li>
</ul>
<h2 data-id="heading-20">æ€»ç»“</h2>
<p>è¿™ä¸ª Message ç»„ä»¶çš„å®ç°å±•ç°äº†ç°ä»£ Vue ç»„ä»¶å¼€å‘çš„å¤šä¸ªæœ€ä½³å®è·µï¼š</p>
<ol>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šå®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰ï¼Œä¸¥æ ¼éµå¾ªé¡¹ç›®è§„èŒƒ</li>
<li><strong>å®ä¾‹ç®¡ç†</strong>ï¼šæ™ºèƒ½çš„å…¨å±€å®ä¾‹ç®¡ç†ç³»ç»Ÿï¼Œè§£å†³å¤šå®ä¾‹å †å é—®é¢˜</li>
<li><strong>äº¤äº’ä½“éªŒ</strong>ï¼šé¼ æ ‡æ‚¬åœæš‚åœã€å¹³æ»‘åŠ¨ç”»ã€å¯é…ç½®çš„å…³é—­æœºåˆ¶</li>
<li><strong>å¸ƒå±€ç®—æ³•</strong>ï¼šåŸºäºå®é™…æ¸²æŸ“é«˜åº¦çš„åŠ¨æ€å‚ç›´æ’åˆ—è®¡ç®—</li>
<li><strong>å†…å­˜ç®¡ç†</strong>ï¼šæ­£ç¡®çš„é”€æ¯å’Œæ¸…ç†æœºåˆ¶ï¼Œé¿å…å†…å­˜æ³„æ¼</li>
<li><strong>å†…å®¹çµæ´»æ€§</strong>ï¼šåŒæ—¶æ”¯æŒå­—ç¬¦ä¸²å’Œ VNode å†…å®¹æ¸²æŸ“</li>
</ol>
<p>æ•´ä¸ªå®ç°å……åˆ†è€ƒè™‘äº†ç”¨æˆ·ä½“éªŒã€æ€§èƒ½ä¼˜åŒ–å’Œä»£ç å¯ç»´æŠ¤æ€§ï¼Œæ˜¯ä¸€ä¸ªé«˜è´¨é‡çš„ç»„ä»¶å®ç°ã€‚å®ƒä¸ä»…è§£å†³äº†åŸºç¡€çš„æç¤ºéœ€æ±‚ï¼Œè¿˜é€šè¿‡ç²¾å¿ƒè®¾è®¡çš„å®ä¾‹ç®¡ç†å’Œå¸ƒå±€ç®—æ³•ï¼Œæä¾›äº†ä¸“ä¸šçº§çš„ç”¨æˆ·ä½“éªŒï¼Œå®Œå…¨ç¬¦åˆ hm-ui ç»„ä»¶åº“çš„è®¾è®¡ç†å¿µå’ŒæŠ€æœ¯è§„èŒƒã€‚</p>
<p>å…·ä½“å®ç°è¯·è®¿é—® <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fzhang-glitch%2Fhm-ui%2Ftree%2Fhm-message" target="_blank" title="https://github.com/zhang-glitch/hm-ui/tree/hm-message" ref="nofollow noopener noreferrer">zhang-glitch github</a></p>
<h2 data-id="heading-21">å¾€æœŸå¹´åº¦æ€»ç»“</h2>
<ul>
<li><a href="https://juejin.cn/post/7310895905573716005" title="https://juejin.cn/post/7310895905573716005" target="_blank">å››å¹´æ²¿æµ·åŸå¸‚ï¼Œåˆšæ¯•ä¸šï¼Œä¸€å¹´3å®¶å…¬å¸</a></li>
<li><a href="https://juejin.cn/post/7254361990076055589" title="https://juejin.cn/post/7254361990076055589" target="_blank">ä¸ƒæœˆä»¿ä½›åˆå›åˆ°äº†é‚£ä¸€å¹´ï¼ˆ2023å¹´ä¸­æ€»ç»“ï¼‰</a></li>
<li><a href="https://juejin.cn/post/7188374796114067511" title="https://juejin.cn/post/7188374796114067511" target="_blank">ä¸€ä½åˆå…¥èŒåœºå‰ç«¯ä»”çš„å¹´åº¦ç»ˆç»“ &lt;å›é¡¾2022ï¼Œå±•æœ›2023&gt;</a></li>
<li><a href="https://juejin.cn/post/7046248406464856100" title="https://juejin.cn/post/7046248406464856100" target="_blank">å¤§å­¦ä¸¤å¹´åŠçš„å‰ç«¯å­¦ä¹ </a></li>
</ul>
<h2 data-id="heading-22">å¾€æœŸæ–‡ç« </h2>
<ul>
<li><a href="https://juejin.cn/post/7392071328528891956" title="https://juejin.cn/post/7392071328528891956" target="_blank">å±•ç¤ºå¤§é‡æ•°æ®èŠ‚ç‚¹(tree)ï¼Œå¼•å‘çš„ä¸€æ¬¡æ€§èƒ½æ’æŸ¥</a></li>
<li><a href="https://juejin.cn/post/7368662916151296039" title="https://juejin.cn/post/7368662916151296039" target="_blank">tsè£…é¥°å™¨çš„é‚£ç‚¹ä¸œè¥¿</a></li>
<li><a href="https://juejin.cn/post/7360871152037052416" title="https://juejin.cn/post/7360871152037052416" target="_blank">è¿™æ˜¯ä½ æ‰€çŸ¥é“çš„tsç±»å‹æ–­è¨€å’Œç±»å‹å®ˆå«å—ï¼Ÿ</a></li>
<li><a href="https://juejin.cn/post/7202132390549356603" title="https://juejin.cn/post/7202132390549356603" target="_blank">TypeScriptå®˜ç½‘å†…å®¹è§£è¯»</a></li>
<li><a href="https://juejin.cn/post/7360498535077003304" title="https://juejin.cn/post/7360498535077003304" target="_blank">ç»å¸¸ä½¿ç”¨tsçš„ä½ ï¼ŒçŸ¥é“è¿™äº›å†…å®¹ï¼Ÿ</a></li>
<li><a href="https://juejin.cn/post/7351336619595939880" title="https://juejin.cn/post/7351336619595939880" target="_blank">ä½ æœ‰äº†è§£è¿‡åŸç”Ÿcssçš„scopeï¼Ÿ</a></li>
<li><a href="https://juejin.cn/post/7348832432072654886" title="https://juejin.cn/post/7348832432072654886" target="_blank">ç°åœ¨æ¯”è¾ƒå¸¸ç”¨çš„ç§»åŠ¨ç«¯è°ƒè¯•ä½ çŸ¥é“å“ªäº›ï¼Ÿ</a></li>
<li><a href="https://juejin.cn/post/7345352532657848371" title="https://juejin.cn/post/7345352532657848371" target="_blank">ä¼—å¤šè·¨æ ‡ç­¾é¡µé€šä¿¡æ–¹å¼ï¼Œä½ çŸ¥é“å“ªäº›ï¼Ÿï¼ˆäºŒï¼‰</a></li>
<li><a href="https://juejin.cn/post/7340109700767383604" title="https://juejin.cn/post/7340109700767383604" target="_blank">ä¼—å¤šè·¨æ ‡ç­¾é¡µé€šä¿¡æ–¹å¼ï¼Œä½ çŸ¥é“å“ªäº›ï¼Ÿ</a></li>
<li><a href="https://juejin.cn/post/7330021813823750159" title="https://juejin.cn/post/7330021813823750159" target="_blank">åè°ƒè¯•å—ï¼Ÿå¦‚ä½•ç›‘å¬devtoolsçš„æ‰“å¼€ä¸å…³é—­</a></li>
<li><a href="https://juejin.cn/post/7301908233291300900" title="https://juejin.cn/post/7301908233291300900" target="_blank">å› ä¸ºåŸç”Ÿï¼Œé€‰æ‹©ä¸€å®¶å…¬å¸ï¼ˆå‰ç«¯å¦‚ä½•é˜²ç¬”è¯•ä½œå¼Šï¼‰</a></li>
<li><a href="https://juejin.cn/post/7298294389478506548" title="https://juejin.cn/post/7298294389478506548" target="_blank">ç»“åˆå¼€å‘ï¼Œå¸¦ä½ ç†Ÿæ‚‰package.jsonä¸tsconfig.jsoné…ç½®</a></li>
<li><a href="https://juejin.cn/post/7294541220440752165" title="https://juejin.cn/post/7294541220440752165" target="_blank">å¦‚ä½•ä¼˜é›…çš„åœ¨é¡¹ç›®ä¸­ä½¿ç”¨echarts</a></li>
<li><a href="https://juejin.cn/post/7293797226933764134" title="https://juejin.cn/post/7293797226933764134" target="_blank">å¦‚ä½•ä¼˜é›…çš„åšé¡¹ç›®å›½é™…åŒ–</a></li>
<li><a href="https://juejin.cn/post/7292036126269063178" title="https://juejin.cn/post/7292036126269063178" target="_blank">è¿‘ä¸‰ä¸ªæœˆçš„æ’é”™ï¼ŒåŸæ¥çš„æ†§æ†¬æ¶ˆå¤±å–½</a></li>
<li><a href="https://juejin.cn/post/7291955076100620342" title="https://juejin.cn/post/7291955076100620342" target="_blank">å¸¦ä½ ä»0å¼€å§‹äº†è§£vue3æ ¸å¿ƒï¼ˆè¿è¡Œæ—¶ï¼‰</a></li>
<li><a href="https://juejin.cn/post/7275550540620365878" title="https://juejin.cn/post/7275550540620365878" target="_blank">å¸¦ä½ ä»0å¼€å§‹äº†è§£vue3æ ¸å¿ƒï¼ˆcomputed, watchï¼‰</a></li>
<li><a href="https://juejin.cn/post/7274072378606174263" title="https://juejin.cn/post/7274072378606174263" target="_blank">å¸¦ä½ ä»0å¼€å§‹äº†è§£vue3æ ¸å¿ƒï¼ˆå“åº”å¼ï¼‰</a></li>
<li><a href="https://juejin.cn/post/7269225865619816483" title="https://juejin.cn/post/7269225865619816483" target="_blank">3w+å­—çš„åå°ç®¡ç†é€šç”¨åŠŸèƒ½è§£å†³æ–¹æ¡ˆé€ç»™ä½ </a></li>
<li><a href="https://juejin.cn/post/7251878440327512124" title="https://juejin.cn/post/7251878440327512124" target="_blank">å…¥èŒä¹‹å‰ï¼Œç‹‚è¡¥æŠ€æœ¯ï¼Œ4wå­—çš„å‰ç«¯æŠ€æœ¯è§£å†³æ–¹æ¡ˆé€ç»™ä½ ï¼ˆvue3 + vite ï¼‰</a></li>
</ul>
<h2 data-id="heading-23">ä¸“æ æ–‡ç« </h2>
<ul>
<li><a href="https://juejin.cn/column/7036633477013307423" title="https://juejin.cn/column/7036633477013307423" target="_blank">é‡å­¦vueåŠå…¶ç”Ÿæ€</a></li>
<li><a href="https://juejin.cn/column/7085181986347679751" title="https://juejin.cn/column/7085181986347679751" target="_blank">å‰ç«¯é¢è¯•</a></li>
<li><a href="https://juejin.cn/column/7215977393697587259" title="https://juejin.cn/column/7215977393697587259" target="_blank">å‰ç«¯å·¥ç¨‹åŒ–</a></li>
<li><a href="https://juejin.cn/column/7171775932809052174" title="https://juejin.cn/column/7171775932809052174" target="_blank">amis ä½ä»£ç å®æˆ˜</a></li>
<li><a href="https://juejin.cn/column/7090398104549064718" title="https://juejin.cn/column/7090398104549064718" target="_blank">åè®®ä¸å®‰å…¨</a></li>
<li><a href="https://juejin.cn/column/7073656450874081316" title="https://juejin.cn/column/7073656450874081316" target="_blank">é‡å­¦react</a></li>
<li><a href="https://juejin.cn/column/7036633282204663822" title="https://juejin.cn/column/7036633282204663822" target="_blank">é‡å­¦nodejs</a></li>
<li><a href="https://juejin.cn/column/7133877511707951111" title="https://juejin.cn/column/7133877511707951111" target="_blank">å·¥ä½œæ€»ç»“</a></li>
<li><a href="https://juejin.cn/column/7366457260414697509" title="https://juejin.cn/column/7366457260414697509" target="_blank">Typescriptç ”ç©¶</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>