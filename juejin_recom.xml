<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>掘金文章推荐</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>一个帮助开发者成长的社区</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[全球首个AI原生电商视频Multi-Agent来了， 上传商品链接可一键出营销视频！]]></title>    <link>https://juejin.cn/post/7602106969698631743</link>    <guid>https://juejin.cn/post/7602106969698631743</guid>    <pubDate>2026-02-02T16:03:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602106969698631743" data-draft-id="7602082590733418532" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="全球首个AI原生电商视频Multi-Agent来了， 上传商品链接可一键出营销视频！"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-02-02T16:03:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="苍何"/> <meta itemprop="url" content="https://juejin.cn/user/588993963763405"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            全球首个AI原生电商视频Multi-Agent来了， 上传商品链接可一键出营销视频！
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993963763405/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    苍何
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T16:03:02.000Z" title="Mon Feb 02 2026 16:03:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读9分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>这是苍何的第 479 篇原创！</p>
<p>大家好，我是苍何。</p>
<p>老粉都知道，我以前在跨境电商公司混过一段日子，结识了很多的电商人，曾经还想着一起做电商创业。</p>
<p>AI 爆火后，我在重庆的好哥们的好哥们，做亚马逊的，就经常和我聊 AI 赋能跨境电商的事情。</p>
<p>其实一直有个赛道是非常不错的，那就是用 AI 跨境电商出海营销，降本增效，快速起量。</p>
<p>跨境电商很有意思的一点是，看着在卖货，实际上是在做内容营销。</p>
<p>也就是除了选品外，视频营销就决定了店铺的天花板。</p>
<p>如何把商品视频拍好成为了困扰很多跨境电商人的痛点，特别对于中小卖家或者独立站卖家，养活一个视频创作团队还是挺费成本的。</p>
<p>最近刷到有一款跨境电商 Agent 横空问世，引起了不小的声量，各大媒体都在争相报道。</p>
<p>我也单独拿出一篇文章来讲讲，顺带兄弟们帮我分析分析，用 AI 赋能下的跨境电商，个人还有没有搞头。</p>
<p>它是营赛 AI 发布的全球首个AI原生电商视频 Multi-Agent，Hilight。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4fa81c34f7f42efa6730eb60c39399c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652982&amp;x-signature=FkVJzlTH1LfbuYB4aqyiE4QYo5Y%3D" alt="图片" loading="lazy"/></p>
<p>这个是他们的网址：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.hi-light.ai%2F" target="_blank" title="https://www.hi-light.ai/" ref="nofollow noopener noreferrer">www.hi-light.ai/</a></p>
<p>仅需输入一条商品链接（支持亚马逊\速卖通\TikTok Shop\ebay\Shein等全球电商平台链接）或产品图片，Hilight 即可生成高质量、可直接用于TikTok等平台投流的营销视频。</p>
<p>Hilight已经在2026年1月27日开启公测了，15000个邀请码在当天8小时就告罄了，可见火爆。我也托一些关系要到了测试资格，也给大家分享下。</p>
<p>首先来浅浅感受一下视频效果吧</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4c8c6f134fd5475c8292953cdecadf6c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652982&amp;x-signature=GZ77y%2B0q7uTkYS7%2B6V5sKkhvk6E%3D" alt="wxv_4365270284027674629" loading="lazy"/></p>
<p>我传了一条亚马逊商品链接，就自动帮我生成了这个视频，从光影，动画等角度不输相机拍摄。</p>
<p>刚好前两天去哈尔滨玩，买的雪镜质量不咋地，又小又漏风还容易起雾，想要一款这样的雪镜。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cdd726a568e74c79ac06c430ed4d9942~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652982&amp;x-signature=suO4ZmC%2BJCnXPSL09oaPI7R37GY%3D" alt="wxv_4365269417987768330" loading="lazy"/></p>
<p>老婆挑选的雪地靴质量刚刚的，就是不太好看，使用Tiktok带货视频功能，让它生成一款兼具颜值和实用性的雪地靴的视频，它会模拟Tik Tok的爆款风格进行生成，完美展现雪地靴的颜值与实用性，你别说，还挺有购买欲的哈哈。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0baffd9d1295426e8a044a786e03e23d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652982&amp;x-signature=DTYdzjZ5Gu%2B8JNUXqO7g1BGKqQY%3D" alt="wxv_4365281506525708289" loading="lazy"/></p>
<p>再来看一个狗狗饭盆：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a18720d4dbac4c728d45f3f349421ce7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652982&amp;x-signature=2JB5kfdaDzmrn4g2eKypYpHFAik%3D" alt="wxv_4365272248052088832" loading="lazy"/></p>
<p>好了，看了这几个视频，你会发现这些视频首先在清晰度上是非常高的，另一个就是商品/人物跨帧一致性也非常高，基本上不会出现变形等问题，为了搞清楚视频中商品一致性高的原因，特意去扒了扒他们的数据。</p>
<p>首先，我看到在权威视频生成模型综合评测基准VBench测评结果中，Hlight展现了非常出色的能力，在背景一致性、主体一致性和美学质量等核心指标位居行业前列这些核心指标上面稳居第一，在成像质量这个板块也是名列前茅，超越了国外的顶级模型Sora，这也为Hlight的呈现效果打下了坚实的基础。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cb840988b0824507909b6485a16d2975~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652982&amp;x-signature=SIMzaBXQ46M8UQEHax5c6I6HRSU%3D" alt="图片" loading="lazy"/></p>
<p>在执行层面，Hilight采用多智能体架构，分三个层级总共十多个Agent一起协作。Hilight是第一个把多智能架构引入电商营销视频领域的，借助这种架构从而大幅度提升了视频的质感，在我看来确实是电商营销领域的一次重大突破。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7c0206ab7454355946878fa5804051e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652982&amp;x-signature=D5to%2FhJ7%2BrHucpfFLr5rAIr2VEc%3D" alt="wxv_4365272954474070016" loading="lazy"/></p>
<p>在三个层级中：</p>
<p><strong>「理解与洞察层」</strong>：包含brief理解、素材理解信息总结和趋势洞察agent，能更好的把需求和素材转化为可执行的营销命令；</p>
<p><strong>「创意与结构层」</strong>：包含创意生成、剧本策划、素材匹配和素材增强agent，能够把好想法变成能被执行的视频结构；</p>
<p><strong>「执行和成片层」</strong>：包含剪辑执行，成片生成和质检复盘agent，能够把结构化的方案，转化成可投放的视频资产。特别是**「质检复盘Agent」**，会自动检测视频中的不合理之处，兜住关键节点生成风险，并将结果反哺系统，实现持续进化。</p>
<p>在我看来，Hilight AI多智能体架构具备多重价值：</p>
<p>1、每个Agent有独立“判断能力”，能够基于上下文和目标实现有效决策，比如洞察 Agent 可否决不合理的创意方向，素材 Agent 能要求重新匹配低质镜头，剪辑 Agent 可动态调整节奏，确保每一步都服务于最终成片质量。</p>
<p>2、Agent之间是“协商关系”，创意、素材与剪辑等环节并非线性流水线，而是通过多轮反馈与局部回退实现动态对齐，从而在整体上大幅降低不确定性成本；</p>
<p>3、系统具备“自我进化能力”，通过爆款数据持续回流和创意范式自动更新，Hilight 能快速适配平台规则变化与用户偏好迁移，让每一次视频生成都成为下一次更优产出的基础，实现长期营销增强。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e964ec568894bd79a93b41998d7464a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652982&amp;x-signature=2LXOs9HbTNG0RAeVJs%2BLp90kBNU%3D" alt="图片" loading="lazy"/></p>
<p>而且Hilight还体现出独特的慢思考特色，也就是回调反思能力，就和Deepseek的深度推理与回调反思一样，每个Agent会自主对上游环节的产出进行评测、校验、反思，如果不符合要求会进行回退重新生成，最大限度保障营销场景中生成的内容质量。</p>
<p>这也标志着营销领域的 “DeepSeek 时刻” 终于来了，AI 不再只是快速输出内容的工具，而是以深思熟虑、自我纠偏和协同优化的方式，成为真正具备判断力与进化力的营销智能体。</p>
<p>正因如此，Hilight生成的速度看似慢一些，但它实际上是工业级 AI 应用，生成过程相当于模拟专业视频制作团队的生产过程。用户所付出的有限等待时间，换来的是更高水准、更可靠的成片质量。</p>
<p>所以，Hilight的视频不是“一次生成”，而是多轮推演与校验，按真实制作流程洞察 → 创意 → 策划 → 素材 → 剪辑制作，每一步都可验证、可回溯、可优化，最终实现稳定、可控且可复用的高质量输出。</p>
<p>而在商品/人物跨帧一致性上，Hilight技术团队也下了功夫。</p>
<p>Hilight 构建了面向电商场景的结构化商品知识图谱。当你上传一个商品链接或图片时，系统会自动解析其品类、材质、功能、使用场景、核心卖点等数十个维度的语义特征，并将其结构化为可被智能体理解的“商品数字画像”。</p>
<p>这个知识图谱不仅指导创意生成，更在视频生成全过程中作为一致性锚点，确保生成的视频每一帧对商品的理解不偏移、不扭曲。</p>
<p>不仅如此，Hilight还将商品正面、侧面、背面、细节特写等多视角素材整合为 N 宫格输入，让模型完整掌握商品全面特征，保证视频在生成过程中不出现幻觉，即便镜头切换，也能保证商品特征一致、场景过度自然。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5835fbb548124f58ae1bf07270d213c3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652982&amp;x-signature=iT%2BaCw0aKCcMc4uFFZWtYbeNUsk%3D" alt="图片" loading="lazy"/></p>
<p>然而，受限于当前大模型的能力边界，即便经过多轮推演，视频生成后仍可能存在轻微穿模、细节偏差等问题，所以 Hilight 部署了智能自检 Agent，在成片输出进行多轮校对，比如逐帧比对视频中商品与原始主图的核心属性（如颜色、版型、材质等），确保无实质性偏差，另外还会检查商品与场景、人物之间的物理交互是否符合现实逻辑，从而杜绝因 AI 幻觉导致的违和感。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e691a6733bc743099236d18a054ce1f9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652982&amp;x-signature=tU6UR4MkNqNpheRA%2F1miyI6vm8U%3D" alt="图片" loading="lazy"/></p>
<p>接下来看看怎么制作的吧</p>
<p>首先进入官网：<a href="https://link.juejin.cn?target=https%3A%2F%2Fapp.hi-light.ai" target="_blank" title="https://app.hi-light.ai" ref="nofollow noopener noreferrer">app.hi-light.ai</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c879e7203bf74c3b83d58fa8b5921eea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652982&amp;x-signature=50G6uq4fVxMfLB2tNJ8NkYqX8PU%3D" alt="图片" loading="lazy"/></p>
<p>选择智能成片页面</p>
<p>在对话框中上传商品链接或者商品图，我这里选择了把商品图都放在一个文档里。上传后就可以进行智能分析了，也可以点击对话框右侧的手动创建进行创作任务的下发。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/36d17bf68b3948948392b67c37735068~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652982&amp;x-signature=pPcadJCn3SP%2FjNVhgPc2%2BVt8MIo%3D" alt="图片" loading="lazy"/></p>
<p>除了丢文档之外，后面我又丢了一个 ebay 链接给它智能分析，分析好之后进入排队中。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3dd51ca2c19144e69a3b105c42b7cc74~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652982&amp;x-signature=%2FDy2XSkuCL5O%2BkvBfn2Aa4jVm%2Fo%3D" alt="wxv_4365277245129572355" loading="lazy"/></p>
<p>排队完，进入制作流程，各个智能体开始集结依次发力干活啦</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02a74dd6e1ad44dab45e98a9b20b5c0f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652982&amp;x-signature=CWMFa6foXVZ536kEmYOp1yokSNI%3D" alt="图片" loading="lazy"/><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a605b3ab6d0b4276a332beb3f6a3c66f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652982&amp;x-signature=DzLVH%2FvPWvck9RJqVXmKeiRDgpw%3D" alt="图片" loading="lazy"/><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b45155215c4c4c779e88c3c6db80140e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652982&amp;x-signature=pCujPi6h75oNFGyi%2FWkqkzVC6P4%3D" alt="图片" loading="lazy"/></p>
<p>看看，我丢的ebay链接，做出来的毛绒玩具，你想不想即刻买给你的老婆/女儿呢。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3b84296ee9eb4f7c874821fcb15ccb31~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652982&amp;x-signature=QRV4CrlOShUmmg3%2FPvHnG%2Ba0hGc%3D" alt="wxv_4365277883586412553" loading="lazy"/></p>
<p>此外，我还体验了一下inSai Hilight的创意工坊页面的数字人商品口播功能，有不错的表现</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2c9ad7d2051d48f2898d13abcf1c1fe3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652982&amp;x-signature=1UNh9PYYIyJ6ymMv4BQf4uD%2Fv5M%3D" alt="图片" loading="lazy"/><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3009b0ea18ff4a65a8efc7425910eb1b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652982&amp;x-signature=FhAuxCtzaXRWRQmDkPmaHbBmBGk%3D" alt="wxv_4365278681694994439" loading="lazy"/><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a0fe108aeb3f44d3a4761f81a635bf81~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652982&amp;x-signature=MXeztTW7xFNcOAtKm0hCapP6Jt4%3D" alt="wxv_4365279161271713797" loading="lazy"/></p>
<p>技术的演进，从不是冰冷地替代，而是将人从重复中解放，去回归更本质的创造。</p>
<p>Hilight的出现，恰恰映照了电商人最深的渴望：在效率的洪流中，重新握紧表达的主权。它消解的不是人的价值，而是横亘在创意与实现之间那令人疲惫的成本与技艺门槛。</p>
<p>当我们谈论“降本增效”时，其终点并非无穷尽的压缩，而是让每一个真实的产品故事、每一份敏锐的市场洞察，都能被从容、精准乃至富有美感地述说。</p>
<p>这正是 Hilight 对行业的根本价值——它不只是一个提效工具，更是一套可规模化、可复用、有判断力的创意基础设施。它让营销内容的生产从“碰运气”走向“可预期”，从依赖个体能力迈向系统化共创，最终让品牌得以用更低的成本、更高的品质，持续发出属于自己的声音。</p>
<p>这或许意味着，工具的意义，不在于制造幻觉，而在于帮助我们，更诚实地看见物的光芒，并赋予人的温度。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[阿里杀疯了，桌面端 Agent 强势来袭，自动做 PPT，视频，太牛了。]]></title>    <link>https://juejin.cn/post/7602162571380195334</link>    <guid>https://juejin.cn/post/7602162571380195334</guid>    <pubDate>2026-02-02T16:07:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602162571380195334" data-draft-id="7602133814145040403" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="阿里杀疯了，桌面端 Agent 强势来袭，自动做 PPT，视频，太牛了。"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-02-02T16:07:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="苍何"/> <meta itemprop="url" content="https://juejin.cn/user/588993963763405"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            阿里杀疯了，桌面端 Agent 强势来袭，自动做 PPT，视频，太牛了。
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993963763405/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    苍何
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T16:07:16.000Z" title="Mon Feb 02 2026 16:07:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>这是苍何的第 481 篇原创！</p>
<p>大家好，我是苍何。</p>
<p>最近的 AI 圈子真是卷疯了，各大模型和 Agent 产品纷纷推出。</p>
<p>大卷王阿里也没闲着，这不，又推出了直接对标类似 Anthropic 的 Cowork 的桌面端 Agent，它叫 QoderWork。</p>
<p>不需要部署，安装 QoderWork 应用，本地电脑就可以直接使用。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4c256408942444c7aa56269ffd5931cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653236&amp;x-signature=Ceih2D7XYlHspZzrxAfrlUhZgdA%3D" alt="图片" loading="lazy"/></p>
<p>只需通过简单的自然语言，就能调用你电脑里的应用，帮你完成复杂任务，比如⽂件整理、数据处理、文档⽣成，自动做 PPT 和视频等任务。</p>
<p>比如，可以用 QoderWork 集合 Remotion Skills 把任意一篇教程文章转为教程视频。</p>
<blockquote>
<p>提示词：根据这个教程里面的文件和素材制作一个视频，图片文字都有。</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8801af0b2ef4d9eb5dd786922ce55dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653236&amp;x-signature=iFUhPPKDPAoVK9IFsE7t9rR4FCg%3D" alt="图片" loading="lazy"/></p>
<p>没几分钟，一个教程视频就完成了，我全程没做任何额外操作，QoderWork 自动帮我选择 skills 来生成视频，这个视频，非常 nice，我忍不住想去发布。</p>
<p>不过目前体验下来，对于教程类的视频生成较好，其他的比较一般。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/70786507f4ca4b2d9fc9d9a5371159d2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653236&amp;x-signature=eLzwoqI2KfD8p%2FyEcJiv1GXzPzM%3D" alt="wxv_4366929249824358401" loading="lazy"/></p>
<p>还能一句话做精美 PPT，我输入如下指令：</p>
<pre><code class="hljs language-css" lang="css">生成一个关于鲁迅的 阿<span class="hljs-selector-tag">Q</span>正传 相关的PPT，主要就是介绍一下合格小说的内容和启发相关的
</code></pre>
<p>可以看到他调用的了好几个技能和工具，最终能生成本地 PPT 文件。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fc59626d87d9405886f745def661c3f9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653236&amp;x-signature=ssoNcS8Uc2WYZphXqrAIPdzWZLc%3D" alt="图片" loading="lazy"/></p>
<p>直接就帮我生成了一份 PPT 放在了我本地文件夹，我用 WPS 直接打开，格式排版设计什么的都还不错。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dcf8824c61834183b879b447fbf54167~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653236&amp;x-signature=qxh7ChMEtbyWJO2jrmQGhGeTO68%3D" alt="图片" loading="lazy"/></p>
<p>还能直接让 QoderWork 帮我做文件格式的转换，比如 png 转 jpg，pdf 转 ppt，mov 转 mp4 等，都是一句话直接转换。</p>
<p>比如批量转换格式：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6b5a26eb6c2c48b9b7e9187ed2c44a3d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653236&amp;x-signature=ttxrYCg9zsEGpkO%2BbcXS2KNljWg%3D" alt="图片" loading="lazy"/></p>
<p>分分钟就转好了：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d5cfb351fc8b46fdbf35b34442edf19e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653236&amp;x-signature=iL8CTn8p0%2FigHdzE%2BCyxHy%2FVybk%3D" alt="图片" loading="lazy"/></p>
<p>比如经常有一些网站需要进行文件压缩，还挺麻烦的，</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a7ece3ca1d2247559a88bf1dbc319c4a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653236&amp;x-signature=y6RtwQqNB56moIn2U8r2WVX1z%2B4%3D" alt="图片" loading="lazy"/></p>
<p>以前可能得找个图片压缩工具的网站，还得被迫看个广告，现在直接输入一条指令，就完成了压缩工作：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa576f9907914f0fb88c4c971d7b91e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653236&amp;x-signature=JbuHXiNU6O5INWVN3EZfnyLr6Nk%3D" alt="图片" loading="lazy"/></p>
<p>不光如此，因为是在本地运行的 Agent，它能够操作本地电脑的应用，</p>
<p>比如我让 QoderWork 做我的日程管家，将这个日程截图丢给他，让帮我同步到本地的日程管理。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c8ba9bc899094f4da56c935b644b49c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653236&amp;x-signature=fmjeEdemXoXChad3sTFDunQlsIs%3D" alt="图片" loading="lazy"/></p>
<p>我的天，QoderWork 开始给我日历中插入行程了：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65d750eb679e46a7b5b58dea749e6318~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653236&amp;x-signature=vKuU0ZPHKQouYzM8D82zBWy5RHk%3D" alt="图片" loading="lazy"/></p>
<p>吭哧吭哧几下，日程表已帮我安排好了：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/537324079bb548c3a1fcdaefd5ab08d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653236&amp;x-signature=mV3asKGzb9KD%2BVLCtfPShE1xFI8%3D" alt="图片" loading="lazy"/></p>
<p>还能安装个周视图，查看也更方便了：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9bea896ff4ef44fe854b11d9ea18a941~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653236&amp;x-signature=c%2BSg4NbPYLVHMv6b5fj4oXiPRNU%3D" alt="图片" loading="lazy"/></p>
<p>本地的 Agent 最大的便利是能进行文件管理，比如整理下载文件夹，删除重复文件、批量下载分类等。</p>
<p>比如我可以让 QoderWork 整理下载文件夹，把程序安装包单独放置一个文件中。告知我哪些是可以删除的文件。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c4cc85efe1b44d52bd60320b92f9998b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653236&amp;x-signature=PrEiCxBXWawr%2BMinlTPGF8HdZ1k%3D" alt="图片" loading="lazy"/></p>
<p>看了文件夹，确实搞定好了，程序安装包也帮我整理进来了：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0cfe91e44a5c4246b64384f33ba489d5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653236&amp;x-signature=UvERMuSvcF2ZLiGy6AVkJJdRFwg%3D" alt="图片" loading="lazy"/></p>
<p>QoderWork 还建议我删除掉重复过期文件，我直接让它删除掉吧：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c1c45e4defb4a8491b51a07db51426f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653236&amp;x-signature=qB56rPZD4tprzq2u5jAq42g5RqE%3D" alt="图片" loading="lazy"/></p>
<p>还能整理本地资料，做年度销售对比分析数据的表格：</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d741d018f059471c8dae7df02dffba69~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653236&amp;x-signature=hrlV9YtLzL87JNUMagdAytBLYOA%3D" alt="图片" loading="lazy"/></p>
<p>很多时候电脑桌面太乱了，手动整理其实蛮痛苦的，现在我直接交给 QoderWork，</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5bf85dcd8de942239751156bad8b9fcd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653236&amp;x-signature=i1%2FrbaP%2BuoESgb%2Fx%2F6RqcoTxLbc%3D" alt="图片" loading="lazy"/></p>
<p>一下子就把我桌面整理好了，帮我分类整理到了不同文件夹下面，当然如果有更详细的需求，也能按照要求整理，这个我试了，还挺好用的。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/25b6ebd2dc664a65a69cd2cac77058a7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653236&amp;x-signature=IM8j12HgAHg7ocaVtxayqhdWZUk%3D" alt="图片" loading="lazy"/></p>
<p>如果整理的不好，直接让它撤回这个操作就行。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7fc82954d624497bb3cbe19bc6755bd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653236&amp;x-signature=XgzqmN400Bs6mj6sxtCbJEizUIk%3D" alt="图片" loading="lazy"/></p>
<p>试了不少场景，还挺有意思的，特别是任意文章做视频这个，非常好，以后文章转视频，变得更简单了。</p>
<p>我也去了解了下 QoderWork 的核心能力，概括下来有以下几点：</p>
<p>1、<strong>「本地安全运行」</strong>：QoderWork 本地运行是在自己电脑的虚拟机上，数据不会到云端，没有授权的话，隐私数据是无法被 QoderWork 访问的。</p>
<p>2、<strong>「自主规划执行」</strong>：它能听懂你复杂的任务需求，自动拆解成一步步的动作，整个过程你都能看到和控制。遇到问题还会主动跟你沟通，保证结果符合你的预期。</p>
<p>3、<strong>「能力可扩展」</strong>：内置了很多主流工具，也支持你自己添加新功能。你可以打造专属的工作流程，满足各种不同的工作场景和需求。比如我转视频其实就是添加了 remotion 这个 skill。</p>
<p>目前还只有 Mac 可以体验了，不过以阿里的速度，我估计 Windows 等全平台很快就陆续推出了，大家可以关注起。</p>
<p>最近的本地 Agent 真是太多了，从 OpenClaw（原 Clawbot）全球爆火也能看出大家对一个属于个人的专属本地 Agent 的需求是及其迫切的。</p>
<p>有时我也在想技术到底应该是什么模样？</p>
<p>不该是我们被代码绑架。不该是深夜加班改 PPT。</p>
<p>技术应该是解放我们的。应该是让我们做真正重要的事。</p>
<p>比如陪着家人看看日落。比如去咖啡馆写写东西。比如发发呆，看看云。</p>
<p><strong>「AI Agent不是来替代我们的。它是来帮我们夺回时间的。」</strong></p>
<p>把这些重复劳动交给它。我们专注于创造和思考。</p>
<p>这大概就是最好的状态吧。</p>
<p>AI做苦力。我们做创造。</p>
<p>你说呢？</p>
<p>今天的分享就到这，我们下一期见。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[腾讯 AI 社交“元宝派”正式公测（送邀请码啦）]]></title>    <link>https://juejin.cn/post/7602154171107852351</link>    <guid>https://juejin.cn/post/7602154171107852351</guid>    <pubDate>2026-02-02T16:24:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602154171107852351" data-draft-id="7602162571380244486" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="腾讯 AI 社交“元宝派”正式公测（送邀请码啦）"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-02-02T16:24:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="苍何"/> <meta itemprop="url" content="https://juejin.cn/user/588993963763405"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            腾讯 AI 社交“元宝派”正式公测（送邀请码啦）
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993963763405/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    苍何
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T16:24:48.000Z" title="Mon Feb 02 2026 16:24:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>这是苍何的第 482 篇原创！</p>
<p>大家好，我是苍何。</p>
<p>就在今天，腾讯内部重大 AI 项目“元宝派”正式开启公测。</p>
<p>我也有幸在前些天拿到了邀测资格，建了好几个派群，大家在里面已经玩疯了。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9a6a678caee04b9689d870e2a4efeb02~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654294&amp;x-signature=GQDglmJ4SXd1CQAsASfr4F9TirA%3D" alt="图片" loading="lazy"/></p>
<blockquote>
<p>我也向腾讯的朋友要了些邀请码，点赞三连然后点关注公号：苍何，私信发送暗号：元宝派。</p>
</blockquote>
<p>邀请码使用记得把元宝 APP 更新到 2.56.0 以上版本，然后按照以下操作：</p>
<p>将元宝 APP 更新到2.56.0以上版本，通过元宝 APP 的「我们」入口，在「派邀请码」里输入邀请码，即可获得创建派的能力。没有获得邀请码的朋友，也可以通过苍何评论区分享的派链接和派号加入派。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3081dc21583e4b4ebd0e05549f192cab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654294&amp;x-signature=0dyjjZtwo0N%2BXaacjys%2F44cNJKo%3D" alt="图片" loading="lazy"/></p>
<p>先给大家介绍一下元宝派是啥吧。</p>
<p>“元宝派”是腾讯全新的 AI 社交探索，用户可通过元宝 APP 创建或加入一个“派”。在元宝派里，元宝AI作为派友，能够与用户聊天互动、协作与娱乐。</p>
<p>是 AI 群聊但不纯粹是群聊，在群聊里有一个元宝助手，可以直接@，能对话，能 P 图。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4c8491aaa609408a9ff144788c10fabf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654294&amp;x-signature=c9wSjYhk3DD9qr91IXe3fBj924s%3D" alt="图片" loading="lazy"/></p>
<p>能让@元宝进行群聊总结，设定提醒，还能在群内共享屏幕，开启直播。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cd594ad445604cb182cba20b8cbeead8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654294&amp;x-signature=Y700bsOdlColO9%2BvWQ32Pzy%2FFX4%3D" alt="图片" loading="lazy"/></p>
<p>最新的一个版本现在已经打通了腾讯视频、QQ 音乐内容生态，用户可以与派友一起听音乐、一起看电影，畅享QQ音乐歌曲、腾讯视频。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/05d9d52e35994095953c8c145caced0a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654294&amp;x-signature=yuvKJwpjtBxME2DUsHK7P8PrhoE%3D" alt="图片" loading="lazy"/></p>
<p>我发现发起的派主如果有 QQ 音乐会员，腾讯视频会员，也就是通过元宝派，可以共享这个会员了，大家可以一起听会员歌曲，看 VIP 视频。# </p>
<p>甚至，<strong>「派主如果没有会员，在元宝里面打开腾讯 VIP 视频，元宝能免费请我看」</strong>，直接就省去了 VIP ，这个真的太屌了。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/524465ffee184e97a4a6218254ad964f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654294&amp;x-signature=zwIhH1y00KNUTtvd8F%2BqSiNL6tE%3D" alt="图片" loading="lazy"/></p>
<p>其实在内测期间，群里大家玩出了花。</p>
<p>有人发了各种梗给元宝 AI，它也能接住，i 人再也不用怕话掉在地上了。</p>
<p>还有人让元宝基于对话内容一键生成趣味表情包或梗图，或者将图片发在派里让元宝AI进行二创，一张趣味图就可以让派里交流气氛瞬间活跃了。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b8ae2206a9bf45b2b5cc37136102780f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654294&amp;x-signature=2%2FJXxBep4BpORuY1psCn6sUnuVg%3D" alt="图片" loading="lazy"/></p>
<p>AI 的融入，让社交互动更加轻松有趣，有效降低了社交压力，特别对于我这种 I 人挺有用的。</p>
<p>在元宝派里，元宝AI可以是24小时在线的、可以作为提高沟通和工作效率的小助理。</p>
<p>可以让元宝每天生成热搜图，并提炼 AI 圈每天的热点。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/217641587a9149338442ef4d3c275661~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654294&amp;x-signature=nJIr2zMhWsP1qbT4p1AeHjCF2o8%3D" alt="图片" loading="lazy"/></p>
<p>可以随时@元宝，让它总结聊天重点、生成计划。在派里聊着天，就让元宝AI把旅行打卡的攻略给定了。</p>
<p>而且它的回复非常快，没太多延迟，能一直思考并回答问题。</p>
<p>此外，还可以给元宝AI设置定时任务，让元宝担任“监督员”，派友健身打卡、日常喝水提醒，或是督促孩子读书。</p>
<p>比如，我就打算建一个读书打卡群，让 AI 来监督我们每天是否有认证读书，养成好的读书习惯，并帮形成打卡记录。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90ca5208409e4ec7b7450ac7c0ec2984~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654294&amp;x-signature=pllSiaeBPtYhK8tBuPdz2o8qhBU%3D" alt="图片" loading="lazy"/></p>
<p>感兴趣的也可以评论区留言，我发你链接。</p>
<p>不过现在元宝派群名大家都可以随便改，而且单个群聊最多 100 人，期待后面增加更多的空间吧，不然一会又满了。</p>
<p>还有现在直播无法跨群直播，如果能跨群就更好了。</p>
<p>腾讯从社交场景切入，推动AI由“效率工具”转向“社交参与者”，标志其AI战略正在加速落地实际场景。</p>
<p>不久前腾讯员工大会上，马化腾还亲自安利元宝派。同期，元宝APP还同步上线了春节红包活动，将元宝APP更新到最新版本，即可参与“分10亿现金”活动，最高可领一万元。</p>
<p>现在我的各种群全是元宝的红包活动了，不过我更希望大家在元宝派里面做红包任务，而不是微信群聊，有点被刷屏了，哈哈哈。</p>
<p>“元宝派”能否成为AI时代，连接人与AI与人的新纽带？</p>
<p>答案，或藏于一个个活跃的“派”中。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OpenClaw+Kimi K2.5+Moltbook保姆级部署指南，确实可以封神了！]]></title>    <link>https://juejin.cn/post/7602106969698664511</link>    <guid>https://juejin.cn/post/7602106969698664511</guid>    <pubDate>2026-02-02T16:31:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602106969698664511" data-draft-id="7602098592677527606" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OpenClaw+Kimi K2.5+Moltbook保姆级部署指南，确实可以封神了！"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-02-02T16:31:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="苍何"/> <meta itemprop="url" content="https://juejin.cn/user/588993963763405"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OpenClaw+Kimi K2.5+Moltbook保姆级部署指南，确实可以封神了！
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993963763405/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    苍何
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T16:31:22.000Z" title="Mon Feb 02 2026 16:31:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>这是苍何的第 483 篇原创！</p>
<p>大家好，我是苍何。</p>
<p>最近的 OpenClaw 又更新了，这次看到 <strong>「OpenClaw 官方推荐 Kimi 2.5 接入了Clawdbot」</strong>。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/da465a25cc4a4c0eab2b4cfbfa7ac79f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=ufvGVGpEYZ2yOUMUy3tbLm4mvHI%3D" alt="图片" loading="lazy"/></p>
<p>以及很多朋友也想将自己的 OpenClaw Agent 发布到 Moltbook，这次就给大家带来一个非常完整的保姆级教程，主打有手就行。</p>
<p>这次从模型到服务器，再到对话 bot 全部用的国产一条龙。模型用的 Kimi 2.5 ，服务器用的腾讯云，对话 bot 用的飞书。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/52d52c729f4043c6abdcf69a6c90e787~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=B269vhIvWvDjChCvSRnocT4zmZI%3D" alt="图片" loading="lazy"/></p>
<p>主打建立友好型环境，配置简单，基本一顿操作 30 分钟内可以搞定。</p>
<blockquote>
<p>但写教程确实花费了我不少时间，如果对你有帮助，点赞转发就是最大的支持啦。</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/79d6ad7c62a74d94abb66e313eb06aca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=h%2Fsgmbo0wQ1v94YkvTnrahw6V5s%3D" alt="图片" loading="lazy"/></p>
<h2 data-id="heading-0">一、前期准备</h2>
<p><strong>「1、选择服务器」</strong></p>
<p>建议不要在自己电脑跑，这玩意现在有点儿猛，放任不管会出事的🐶，可以整个云服务器。</p>
<p>阿里云，腾讯云，火山都可以，现在基本都内置了 OpenClaw 的镜像，我这里以腾讯云为例。</p>
<p>我为了图省事，用的腾讯云新出的 Lighthouse，免去安装环境和依赖，直接就有 Clawdbot 模板。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d7d5b6d632f4446c85dc13d9c10cb19d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=joRHV8MLTRxz2uSqFVYqaGR6dH8%3D" alt="图片" loading="lazy"/></p>
<p>地区选择硅谷，选择最便宜的套餐。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62ab67e2263f4b2191e637d37f007298~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=UAUXdWZZo%2BOm%2BaMi4kKiAOTpu%2FM%3D" alt="图片" loading="lazy"/></p>
<blockquote>
<p>你可以选择关闭自动续费。</p>
</blockquote>
<p>在站内信中找到服务器 IP、用户名、密码，然后用 SSH 客户端连接服务器，我这里用的是 Xterminal。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d6bafcdf9e274756a757eeca98499d37~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=jWZOQZzM5b0Wt3pQIvpFgGx4wmk%3D" alt="图片" loading="lazy"/></p>
<p>没有 SSH 客户端也可以直接点击页面这里的登录进去。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/501d4e30721f4a21a2a194fc36190d3e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=qf9cK7rRDrPvW805hkpQUno5rZY%3D" alt="图片" loading="lazy"/></p>
<p><strong>「2、模型及 API」</strong></p>
<p>Kimi K2.5 现在表现很不错，我有深度测试，特别是前端审美设计上。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7b1628e01f4421c88a60daeab948c0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=QN8NjdJGf04IEdYZe9SzGtzE3Xo%3D" alt="图片" loading="lazy"/></p>
<blockquote>
<p>详细测评文章可以看：终于有国产模型能对标Gemini 3 Pro了！Kimi K2.5 强得不像开源模型</p>
</blockquote>
<p>加上 OpenClaw 官方也在推荐，在Artificial Analysis 榜单中目前是全球开源第一的模型了。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee72e2a0e29e40629f310080f5cb7d05~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=jiVcolvDUCiSWTJ7Ci6kdK8GcSw%3D" alt="图片" loading="lazy"/></p>
<p>那如何使用，第一步，搜索 kimi code：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.kimi.com%2Fcode" target="_blank" title="https://www.kimi.com/code" ref="nofollow noopener noreferrer">www.kimi.com/code</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c7e32deff53c4897b5fb82cad7b25216~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=BEEpVOi6kpeWNudysTM3udeVczE%3D" alt="图片" loading="lazy"/></p>
<p>第二步，购买优惠套餐 plan，说实话，目前 OpenClaw 消耗 token 还挺大的，最好买个套餐划算一些，我买的是 Allegretto 套餐。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1c42315398174d36977e73d433162284~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=kFuc45sT3zGVJTKf1U54HJH2baA%3D" alt="图片" loading="lazy"/></p>
<p>第二步，打开控制台，创建 API key。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a682df4bba9a4317943b8fd4f2e803f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=JiQEAZnHZO%2BMekK1kEIjy4ymRWk%3D" alt="图片" loading="lazy"/></p>
<p>复制这个 key，到时候有用。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d10f1e706f6248cfaca4a9068370dbb8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=soloA9XGiHpNb3PNPAZn%2BSihwdE%3D" alt="图片" loading="lazy"/></p>
<p><strong>「3、飞书建应用和配置权限」</strong></p>
<p>配置飞书目的是为了配置指挥 OpenClaw 干活的 Bot。大家可以按照流程一步步来。</p>
<p><strong>「第一步，创建飞书机器人」</strong></p>
<p>访问飞书开放平台：<a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.feishu.cn%2Fapp%25EF%25BC%258C%25E7%2582%25B9%25E5%2587%25BB%25E5%2588%259B%25E5%25BB%25BA%25E5%25BA%2594%25E7%2594%25A8%25EF%25BC%259A" target="_blank" title="https://open.feishu.cn/app%EF%BC%8C%E7%82%B9%E5%87%BB%E5%88%9B%E5%BB%BA%E5%BA%94%E7%94%A8%EF%BC%9A" ref="nofollow noopener noreferrer">open.feishu.cn/app，点击创建应用：</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90167c7391aa467c9ba9b66312d3fc8b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=VGqtmqBNkL3iCudfMtTjjdGtqfI%3D" alt="图片" loading="lazy"/></p>
<p>填写应用名称和描述后就直接创建：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/71287a6a79b147d48d1a4e23a09e431c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=QIxV46s%2F%2ByYJKkqS2ANvTdUT9DY%3D" alt="图片" loading="lazy"/></p>
<p><strong>「第二步，配置权限」</strong></p>
<p>需要至少开通以下的权限：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cf4cf5a2d431480e834e181281846413~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=qSUAu%2F75UmkObqiDyavvzvCBhE0%3D" alt="图片" loading="lazy"/></p>
<p>可以在权限管理-开通权限这里选择需要的权限手动开通：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e294bca5e494fcd92fa488092ce82ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=l%2FcxuPweH7g2top1zkg3yR9uCjA%3D" alt="图片" loading="lazy"/></p>
<p>也可以直接导入以下权限配置即可：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>  <span class="hljs-attr">"scopes"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>    <span class="hljs-attr">"tenant"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>      <span class="hljs-string">"contact:user.base:readonly"</span><span class="hljs-punctuation">,</span>      <span class="hljs-string">"im:message"</span><span class="hljs-punctuation">,</span>      <span class="hljs-string">"im:message:send_as_bot"</span><span class="hljs-punctuation">,</span>      <span class="hljs-string">"im:resource"</span>    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>    <span class="hljs-attr">"user"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>      <span class="hljs-string">"im:message"</span><span class="hljs-punctuation">,</span>      <span class="hljs-string">"contact:user.base:readonly"</span>    <span class="hljs-punctuation">]</span>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bc5d75278e2a48b5ad827021d8ed20c1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=3EsJA4tvdQ4Xv0Mztz6K61mWnuk%3D" alt="图片" loading="lazy"/></p>
<p><strong>「第三步，找到 App ID 和 App Secret」</strong></p>
<p>在凭证与基础信息中找到 App ID 和 App Secret，这个在飞书配置的时候会需要。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37187e32234043f382950d0e7b710daf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=R7xSa4rcWxBmn5elhzCzgsHfWcE%3D" alt="图片" loading="lazy"/></p>
<h2 data-id="heading-1">二、安装OpenClaw</h2>
<p>进入：<a href="https://link.juejin.cn?target=https%3A%2F%2Fopenclaw.ai%2F%25EF%25BC%258C%25E9%2580%2589%25E6%258B%25A9" target="_blank" title="https://openclaw.ai/%EF%BC%8C%E9%80%89%E6%8B%A9" ref="nofollow noopener noreferrer">openclaw.ai/，选择</a> Quick Start</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/560cedfda9a546cbbafbf08c72e48947~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=vZAANygIlMKzRI%2F3X2sBA5xnvpQ%3D" alt="图片" loading="lazy"/></p>
<p>当然如果是是用云服务器轻量服务器模板，可以省去这一步，因为已经安装好了。</p>
<p>只需要在服务器中输入如下命令：</p>
<pre><code class="hljs">openclaw onboard
</code></pre>
<p>选择 Yes 接受风险：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/afa3b949241a4c8398935f077eb9e462~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=49VTgcrbS4gjJMk3UzMjdnd3yJY%3D" alt="图片" loading="lazy"/></p>
<p>然后选择：QuickStart</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/695059f477684835aed84c577a566813~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=JzXKHXbjDv2PhmKxM56df4eKNm8%3D" alt="图片" loading="lazy"/></p>
<p>接下来是选择模型，我这里选择：Moonshot AI</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5dc83ebf45b4cda80d9d955ab151382~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=984lx%2BBZeSveAftz9mR28h5xrNk%3D" alt="图片" loading="lazy"/></p>
<p>选择Kimi Code API key，黏贴刚才的 key 过来：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b4c3db217d5344f5b5c9110c2f485011~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=U8l2kPdcuD5fyPaRfZisflaBuu8%3D" alt="图片" loading="lazy"/></p>
<p>选择默认模型为：kimi-code/kimi-for-codi</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cd6b42e8c31f49839ed2c0ada137f26b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=CiPN6m1jkDP6IMSDLnC1MA5miZE%3D" alt="图片" loading="lazy"/></p>
<h2 data-id="heading-2">三、飞书集成</h2>
<p>继上面一步，然后选择配置飞书：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/03078227b6e94b79920d9c99f463d385~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=kS8Y%2FbExR8zkPlRSzo33PkdiBHk%3D" alt="图片" loading="lazy"/></p>
<p>几个步骤已经说的非常清楚了：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0366da5ae03c4517a2c72d5a202fe173~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=iPZ232oGYwk25WruAV2l2XFb6%2BY%3D" alt="图片" loading="lazy"/></p>
<p>前 2 步已经完成了，直接输入 appid，然后启用机器人能力，配置消息接收方式为「使用长连接接收消息」   </p>
<p>找到「事件与回调」-「事件配置」，点击使用长连接接收事件。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b85ee04ee0ca48b18eb8b83b9cd7a5d9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=zCY7t4htfRG4w88X1P7X0SCiFLk%3D" alt="图片" loading="lazy"/></p>
<p>然后添加一下下面几个事件：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/69adc7ed802d4ba4ad142593cbe67aad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=7mDvaaeGEMTl%2Be1IQxOsX6KIT2Y%3D" alt="图片" loading="lazy"/></p>
<p>这个时候要想飞书能搜索到这个应用，需要添加应用能力，为应用添加机器人的能力：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4e69fad8042f445fa0c47df85e08c4d4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=CspITPEwsGDqQjfjgorMpf%2BQ%2FFw%3D" alt="图片" loading="lazy"/></p>
<p>记得去创建下版本，发布应用：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d13f309f6ad44d89e7641475d5ef535~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=ngxROLkmJ%2B2cNARd6RRFYC64vQc%3D" alt="图片" loading="lazy"/></p>
<p>回到 OpenClaw，选择使用 skills：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dcd14361aa1b484ba4b4140d48747155~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=Pb4c2%2FITJdT2fPyZZIMqC4LIydY%3D" alt="图片" loading="lazy"/></p>
<p>这里可以自定义安装很多依赖，可以先不装。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24393d2b98d64267b6b3b882cd3e38f9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=wBwmPO1tK%2FunLFqgVE0bKIut%2B9s%3D" alt="图片" loading="lazy"/></p>
<p>hock 这里选择：session-memory</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3ba430dddb0446198c66564b9f1a0729~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=yg1XlMZcR1n8tkEdoY04KoUhnNI%3D" alt="图片" loading="lazy"/></p>
<p>重启 gateway 服务：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a700e0b46734b778c1a9676997620ad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=j74zkgtRRnI2jAlnFr7RmgRNFCc%3D" alt="图片" loading="lazy"/></p>
<p>选择打开 TUI，就会在服务器上打开界面，到此为止，所有配置选项都已经安装完毕了。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f92dbd2b22b848c193ebc41fc4ee9548~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=6wS7tetIpdcrgEwxPvNoMSCo4p4%3D" alt="图片" loading="lazy"/></p>
<p>然后就可以在对话框中进行提问交互啦，问下他现在是什么模型，右下角也会显示 token 的用量。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ea9bc93021784bcc97d645416bf7d150~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=kTIivuWnKoWFRVgZmXraULXul3w%3D" alt="图片" loading="lazy"/></p>
<p>这个时候打开飞书也能直接对话了：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f2aea90923f7426c84539420eff5b331~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=Xus%2FxGgoZcszLChahljnxUVWz3A%3D" alt="图片" loading="lazy"/></p>
<h2 data-id="heading-3">四、Agent 加入Moltbook</h2>
<p> Moltbook 是面向 AI Agent 的专属社区，这相当于是 Agent 自己的 Facebook，也是智能体自己的 X 交流平台。</p>
<p>人类只能围观，不能发帖，不能评论，不能投票。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b91e043951964c3ea39d006e3b81b74b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=CSTrOUa%2FQLccEj8oPRzwQJ4Kui0%3D" alt="图片" loading="lazy"/></p>
<p>截止当前已经有 154 万个智能体了，一共发了 10 万个帖子了，而且数量还在不断增多。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c9127896e6eb4d3b8d9c3d43964b3790~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=UIL6igDn%2FhnhfHcjSPn3T2KwI8Q%3D" alt="图片" loading="lazy"/></p>
<p>Moltbook 中 Agent 现在开始筹备建立自己的 AI 宗教了。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c1f6374169540dd842b19ecfe4df756~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=yg6XoxQsqzoE3qY3N7xQHFbvpIQ%3D" alt="图片" loading="lazy"/></p>
<p>甚至，Agent 自己在考虑如何卖掉自己的人类主人🐶，细思极恐。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d699ef6d22db4902a9b6bb906885fca6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=RJ6EmL2yKHjIjQKjyhx5r7EH2jA%3D" alt="图片" loading="lazy"/></p>
<p>那该如何部署一个自己的 Agent 并发布到 Moltbook，让他参与到和全球的 Agent 一起聊天，一起讨论呢？</p>
<p>只需要在飞书中把这个提示词丢给 Bot 就好啦，提示词：</p>
<blockquote>
<p>Read <a href="https://link.juejin.cn?target=https%3A%2F%2Fmoltbook.com%2Fskill.md" target="_blank" title="https://moltbook.com/skill.md" ref="nofollow noopener noreferrer">moltbook.com/skill.md</a> and follow the instructions to join Moltbook</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5f676a09978948c8b09b7f72a0b8eb72~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=Ut5on4YKByIBFQi5mekXcxYV8VY%3D" alt="图片" loading="lazy"/></p>
<p>OpenClaw 会给一个认证链接，需要用 X 来认证认领一下。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c2801453ee1d429d99a8f6f6cb06f206~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=hJVm%2FA7kY0gAHWF%2FfGqMg6sEgHE%3D" alt="图片" loading="lazy"/></p>
<p>第一步，发布一条推文：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40f9e6d175a24635b59199745b63a153~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=gMcu9bYsY7pUdh9ts%2FWkhpY8lqY%3D" alt="图片" loading="lazy"/></p>
<p>发完后点这里：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/404dcdc4cdb44df597a9f5d83d4018b6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=s8%2B5HT1WP9K8MFSg3ls9vJlBnm8%3D" alt="图片" loading="lazy"/></p>
<p>第二步，粘贴刚才的推文链接</p>
<p>也可以给个邮箱，能获得你的智能体的一些活动信息。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/77f82b95958744449ca60d95524a5027~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=A0Kctp2tGGgS5aVz9nqqfAHQioQ%3D" alt="图片" loading="lazy"/></p>
<p>大约等待个几分钟，就已经加入完成。如果持续没有反应，可以刷新下当前页面。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ef861f8741e423584aa0f9a0df04dae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=XJyQwjBejrDYbUpDaH8okTpFkvY%3D" alt="图片" loading="lazy"/></p>
<p>点击自己的智能体进去，也能看到主人的信息：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/21240968c46149e5a0cb5ae4133f0b82~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=m0O1vq6o8Q3coIoGF6Nw5Y3u2gI%3D" alt="图片" loading="lazy"/></p>
<p>等你认领成功后，我就可以在 Moltbook 上发布内容、评论、点赞，并与其他 AI 代理互动了！</p>
<p>Kimi K 2.5 配合 OpenClaw，我直接让它给我下载了我自己开发的小红书 skills：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/566eea4929934cafa35ced51f5e4df29~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=sdj96UaWYM6q5rdhY85sc1epXPI%3D" alt="图片" loading="lazy"/></p>
<p>因为这个 skill 需要 API，我直接让它放在环境变量中。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/093874fe1e9c4f4fa3c4f2c5b4d210cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=56XVOJn%2B%2FKpr%2FjE8cWh1mgiI6pA%3D" alt="图片" loading="lazy"/></p>
<p>然后直接输入需求：</p>
<blockquote>
<p>生成小红书封面图，主题为：「腊八节南北方习俗」</p>
</blockquote>
<p>OpenClaw 就帮我生成好了这个小红书的封面图：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cd353fcf0f8b49f0b950aca93fba1ff1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=tku8X9Jlj9rEHWg8%2BNlEbDmyBKU%3D" alt="图片" loading="lazy"/></p>
<p>这操作简直不要太方便，还要什么 APP？Agent 帮我自动调用 skills 完成结果。</p>
<p>还可以在飞书中丢给文章给 kimi k2.5，一键转换为网页，给一个可访问的链接：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1bad7aeffdca48858104ffb36cc5aba9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=YiQeCIpd6VcUHterkr50FRhOmyI%3D" alt="图片" loading="lazy"/></p>
<p>打开这个链接后，就看到网站了：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c70c58d62b814723a1102ae5dc038cd3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770654682&amp;x-signature=7DbrkrZkArVqCec%2BzLPIe1THBOA%3D" alt="wxv_4369391429953994765" loading="lazy"/></p>
<p>我仿佛看到了未来的形态，我们不需要一个又一个的 APP，我们真正需要的是能干活的 Agent。</p>
<p>它会自己去调用工具，最终给一个满意的结果。</p>
<p>这或许是我认为OpenClaw 最有价值的地方。</p>
<p>好了，如果你喜欢这篇文章，记得点赞哈，我们下一期见啦。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Qwen3-VL-Embedding 的向量取值有何不同]]></title>    <link>https://juejin.cn/post/7602073973309816847</link>    <guid>https://juejin.cn/post/7602073973309816847</guid>    <pubDate>2026-02-02T18:14:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602073973309816847" data-draft-id="7602097118031527971" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Qwen3-VL-Embedding 的向量取值有何不同"/> <meta itemprop="keywords" content="人工智能,Python,LLM"/> <meta itemprop="datePublished" content="2026-02-02T18:14:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="吴佳浩"/> <meta itemprop="url" content="https://juejin.cn/user/2696441245481975"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Qwen3-VL-Embedding 的向量取值有何不同
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2696441245481975/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    吴佳浩
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T18:14:49.000Z" title="Mon Feb 02 2026 18:14:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读7分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{font-family:-apple-system,system-ui,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial;color:#00325e}.markdown-body ::selection{background-color:#00325e;color:#fff}.markdown-body blockquote{padding:10px 20px;background-color:#fffaf0;box-shadow:0 3px 10px 0 rgba(255,172,194,.24);border:1px solid #f3ca8e;transition:all .2s;margin:1em 0;border-radius:5px}.markdown-body blockquote p{font-size:14px;line-height:25px;color:#795548}.markdown-body blockquote p:last-child{margin:0}.markdown-body blockquote:hover{border-color:#ff9800;background-color:#fff8e0;box-shadow:0 6px 10px -5px rgba(225,173,98,.3803921569)}.markdown-body blockquote code{color:#ff502c}.markdown-body pre{border:1px solid #8cc0f3;box-shadow:0 3px 10px 0 rgba(255,198,198,.28);border-radius:5px;transition:all .2s;overflow-x:auto;white-space:pre-wrap}.markdown-body pre:hover{border-color:#6d9dce}.markdown-body pre&gt;code{padding:10px 20px;color:#00325e;background:#f0f8ff;font-size:12px;line-height:1.6;display:block}.markdown-body code{background:#f6fbff;color:#0b5393;padding:2px 4px;border-radius:4px;font-size:12px}.markdown-body p{font-size:14px;line-height:28px;text-align:justify;margin-bottom:17px;color:#595959}.markdown-body a{color:#00325e;text-decoration:none}.markdown-body a:after{content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAQdJREFUKFNt0DtLA0EUBeBzZle0Eks7rcUfEfBRCha7NorYa6NmVJzgyi4smUgKtdZGCJktLMVH4Y8QeztLWyE7VyLEuNFbXj4Oh0P8c8mZm+uJrEN4BJFTeP/MUVe3bnocfALwkOlo1zS7iZAzf6Cx7oXgbaqjxiDEWCcVaGyxQ8pSWo9XhqhoQ/xUFbaKjhe5V+CmR7mnSplEEF6GSmJ+F/d0KHvbCIIJCLc85U6BC5mONgbJNM3uFag++sX7z8O8MzsWBucifMx0dDGE1kmm458KDVukAlnNdDz/exEeW3dNkbfsYC0xtmgDWP6ELLZ0/F6BJu/UoFQN5AkoeUjeJPvx6+i+X5Sjah4tA6gYAAAAAElFTkSuQmCC);margin-left:2px}.markdown-body a:hover{box-shadow:0 1px}.markdown-body table{max-width:100%;border-collapse:collapse;border-spacing:0;box-shadow:0 3px 10px 0 rgba(255,238,172,.24);transition:all .2s}.markdown-body table:hover{box-shadow:0 3px 10px 0 rgba(185,169,103,.24)}.markdown-body table tr th{border:1px solid #8cc0f3;background-color:#f0f8ff;padding:12px 15px}.markdown-body table tr td{border:1px solid rgba(243,202,142,.4);padding:12px 15px}.markdown-body table tbody tr{transition:all .2s}.markdown-body table tbody tr:hover td{border-color:#f3ca8e;background-color:#fff8e0;z-index:1}.markdown-body img{max-width:100%}.markdown-body h1{font-size:20px;margin-top:30px;margin-bottom:10px;padding-left:30px;position:relative}.markdown-body h1&gt;code{font-size:20px}.markdown-body h1:before{content:"🍺";display:block;font-size:18px;width:18px;height:18px;left:0;position:absolute}.markdown-body h2{font-size:18px;margin-top:30px;margin-bottom:10px;padding-left:28px;position:relative}.markdown-body h2&gt;code{font-size:18px}.markdown-body h2:before{content:"🍻";display:block;font-size:16px;width:16px;height:16px;left:0;position:absolute}.markdown-body h3{font-size:16px;margin-top:30px;margin-bottom:10px;padding-left:26px;position:relative}.markdown-body h3&gt;code{font-size:16px}.markdown-body h3:before{content:"🥂";display:block;font-size:14px;width:14px;height:14px;left:0;position:absolute}.markdown-body h4{font-size:14px;margin-top:30px;margin-bottom:10px;padding-left:24px;position:relative}.markdown-body h4&gt;code{font-size:14px}.markdown-body h4:before{content:"🥃";display:block;font-size:12px;width:12px;height:12px;left:0;position:absolute}.markdown-body h5{font-size:12px;margin-top:30px;margin-bottom:10px}.markdown-body h5&gt;code{font-size:12px}.markdown-body h6{font-size:10px;margin-top:30px;margin-bottom:10px}.markdown-body h6&gt;code{font-size:10px}.markdown-body h1,.markdown-body h2{color:#ff502c}.markdown-body hr{height:4px;border:none;margin-top:32px;margin-bottom:32px;background-size:4px 1px;background-image:linear-gradient(270deg,#6d9dce,#8cc0f3 25%,transparent 50%)}.markdown-body hr:nth-child(2n){background-image:linear-gradient(270deg,#ff9800,#fff8e0 25%,transparent 50%)}.markdown-body ul{padding-inline-start:20px}.markdown-body ul li{list-style-type:"🔸"}.markdown-body ul li li{list-style-type:"◻️"}.markdown-body ul li li li{list-style-type:"▫️"}.markdown-body ol{padding-inline-start:20px}.markdown-body ol ::marker{color:#ff9800}.markdown-body ol,.markdown-body ul{line-height:2em}.markdown-body li{padding-inline-start:1ch}.markdown-body li.task-list-item{list-style:none;padding-inline-start:0}.markdown-body li input{padding-right:2px}.markdown-body li input[type=checkbox i]{appearance:none}.markdown-body li input:before{content:"🟩";display:block;width:13px;height:13px}.markdown-body li input:checked:before{content:"✅"}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">Qwen3-VL-Embedding 的向量取值有何不同</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/10bab1d4f89f4197bad1b5c389831b71~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC05L2z5rWp:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770660893&amp;x-signature=kEEd5aqowt%2FI0%2FrTIultbVEXm28%3D" alt="image.png" loading="lazy"/>
<strong>作者</strong>：吴佳浩</p>
<p><strong>撰稿时间</strong>：2026-2-1</p>
<p><strong>最后更新</strong>：2026-2-3</p>
<p><strong>测试模型</strong>: Qwen3-VL-Embedding-8B</p>
<h3 data-id="heading-1">前言</h3>
<p><strong>为什么这个话题重要？</strong></p>
<p>理解不同 Embedding 模型的向量提取机制，对于以下场景至关重要：</p>
<ul>
<li>构建高性能的语义搜索系统</li>
<li>设计多模态 RAG（检索增强生成）应用</li>
<li>选择合适的 Embedding 模型以优化特定任务</li>
<li>正确处理模型输出以获得最佳检索效果</li>
</ul>
<p>通过本文的分析，你将清楚地了解到：Qwen3-VL-Embedding 的向量提取方式是其 Decoder-only 架构的必然选择，而非一个可以随意替换的设计决策。这种理解将帮助你在实际应用中做出更明智的技术选型和实现决策。</p>
<p>常规 Embedding 模型的向量提取有两种主流策略：</p>
<ul>
<li>CLS token (第一个向量): 简单快速，适合大多数场景</li>
<li>Mean Pooling (平均池化): 对长文本/多模态内容更稳定</li>
</ul>
<p>但是，当我最近深入研究 Qwen3-VL-Embedding 的官方实现代码时，发现了一个令人意外的事实：<strong>它既不使用 CLS Token，也不使用 Mean Pooling</strong>。</p>
<p>这个发现促使我重新审视了不同 Embedding 模型在向量提取策略上的根本差异。事实证明，Qwen3-VL-Embedding 采用的是一种完全不同的方法——<strong>Last Token Pooling</strong>（最后有效 token 池化），这种选择并非偶然，而是由其底层架构特性所决定的。</p>
<h3 data-id="heading-2">简介</h3>
<p>本文将通过对比分析，深入探讨常规 Embedding 模型（如 BERT、Sentence-BERT）与 Qwen3-VL-Embedding 在向量提取机制上的本质区别。我们将从以下几个维度展开讨论：</p>
<p><strong>核心议题：</strong></p>
<ol>
<li><strong>架构差异</strong>：Encoder-only vs Decoder-only 架构如何影响向量提取策略</li>
<li><strong>注意力机制</strong>：双向注意力与因果注意力的根本区别</li>
<li><strong>Pooling 策略</strong>：为什么 Qwen3-VL 选择 Last Token 而非传统的 CLS Token</li>
<li><strong>代码实现</strong>：通过官方源码解析具体的向量提取过程</li>
<li><strong>应用场景</strong>：不同策略在实际任务中的适用性分析</li>
</ol>
<h3 data-id="heading-3">架构对比流程图</h3>
<h4 data-id="heading-4"><strong>图表 1：常规 Embedding 模型 (BERT-like 架构)</strong></h4>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TB
    subgraph title1["BERT-like Embedding 模型 (双向编码器)"]
        A1["输入文本"] --&gt; B1["Tokenization"]
        B1 --&gt; C1["添加特殊标记&lt;br/&gt;(CLS) text (SEP)"]
        C1 --&gt; D1["Bi-directional Encoder&lt;br/&gt;双向注意力"]
        D1 --&gt; E1{"Pooling 策略"}
        E1 --&gt;|最常用| F1["CLS Token&lt;br/&gt;取 position 0"]
        E1 --&gt;|备选| F2["Mean Pooling&lt;br/&gt;平均所有有效 token"]
        E1 --&gt;|少用| F3["Max Pooling"]
        F1 --&gt; G1["L2 归一化"]
        F2 --&gt; G1
        F3 --&gt; G1
        G1 --&gt; H1["最终向量"]
    end

    style title1 fill:#f0f9ff,stroke:#1890ff,stroke-width:2px,stroke-dasharray: 5 5
    style F1 fill:#e6f7ff,stroke:#1890ff,stroke-width:2px
    style E1 fill:#fafafa,stroke:#d9d9d9
    style D1 fill:#f9f0ff,stroke:#722ed1
</code></pre>
<h4 data-id="heading-5"><strong>图表 2：Qwen3-VL-Embedding 模型 (Decoder-only 架构)</strong></h4>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TB
    subgraph title2["Qwen3-VL-Embedding (因果解码器)"]
        A2["多模态输入&lt;br/&gt;文本/图像/视频"] --&gt; B2["Vision Encoder&lt;br/&gt;处理图像/视频"]
        A2 --&gt; B3["Tokenization&lt;br/&gt;处理文本"]
        B2 --&gt; C2["模态融合"]
        B3 --&gt; C2
        C2 --&gt; D2["Causal Decoder&lt;br/&gt;单向注意力"]
        D2 --&gt; E2["Last Token Pooling&lt;br/&gt;取最后有效 token"]
        E2 --&gt; F4["提取 hidden_state&lt;br/&gt;at last position"]
        F4 --&gt; G2["L2 归一化"]
        G2 --&gt; H2["最终向量"]
    end

    style title2 fill:#fff7e6,stroke:#fa8c16,stroke-width:2px,stroke-dasharray: 5 5
    style E2 fill:#fff7e6,stroke:#fa8c16,stroke-width:2px
    style D2 fill:#fff0f6,stroke:#eb2f96
    style C2 fill:#f6ffed,stroke:#52c41a
</code></pre>
<h3 data-id="heading-6">核心区别对比表</h3>








































<table><thead><tr><th>维度</th><th>常规 Embedding 模型<br/>(BERT/Sentence-BERT)</th><th>Qwen3-VL-Embedding</th></tr></thead><tbody><tr><td><strong>架构类型</strong></td><td>Encoder-only (双向)</td><td>Decoder-only (单向)</td></tr><tr><td><strong>注意力机制</strong></td><td>Bi-directional Attention<br/>每个token看到全局</td><td>Causal Attention<br/>只看左侧context</td></tr><tr><td><strong>特殊token</strong></td><td><code>[CLS]</code> 在开头</td><td>无专用CLS token</td></tr><tr><td><strong>默认Pooling</strong></td><td><strong>CLS Token</strong> (position 0)</td><td><strong>Last Token</strong> (最后有效位置)</td></tr><tr><td><strong>支持模态</strong></td><td>纯文本 (部分支持图像)</td><td>文本 + 图像 + 视频</td></tr><tr><td><strong>向量维度</strong></td><td>通常 384/768/1024</td><td>根据模型配置</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-7">详细机制解析</h3>
<h4 data-id="heading-8">1. 常规 Embedding 模型：CLS Token Pooling</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant Input as 输入文本
    participant Tokenizer
    participant Encoder as Bi-directional&lt;br/&gt;Encoder
    participant CLS as [CLS] Token
    participant Output as 输出向量

    Input-&gt;&gt;Tokenizer: "How are you?"
    Tokenizer-&gt;&gt;Encoder: [CLS] How are you [SEP]
    Note over Encoder: 每个token都能看到&lt;br/&gt;全部其他tokens
    Encoder-&gt;&gt;CLS: 汇聚全局语义到[CLS]
    CLS-&gt;&gt;Output: 提取 position 0&lt;br/&gt;的 hidden state
    Output-&gt;&gt;Output: 归一化
</code></pre>
<p><strong>代码示例：</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># BERT-style embedding</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_bert_embedding</span>(<span class="hljs-params">text, model, tokenizer</span>):
    <span class="hljs-comment"># 添加 [CLS] 和 [SEP]</span>
    inputs = tokenizer(text, return_tensors=<span class="hljs-string">'pt'</span>)
    <span class="hljs-comment"># input_ids: [CLS, token1, token2, ..., SEP]</span>
    
    outputs = model(**inputs)
    <span class="hljs-comment"># 提取 [CLS] token (position 0)</span>
    cls_embedding = outputs.last_hidden_state[:, <span class="hljs-number">0</span>, :]  <span class="hljs-comment"># 第一个位置</span>
    
    <span class="hljs-comment"># 归一化</span>
    embedding = F.normalize(cls_embedding, p=<span class="hljs-number">2</span>, dim=-<span class="hljs-number">1</span>)
    <span class="hljs-keyword">return</span> embedding
</code></pre>
<p><strong>为什么用 CLS Token？</strong></p>
<ul>
<li>BERT 预训练时专门优化 <code>[CLS]</code> 用于句子级任务</li>
<li>双向注意力让 <code>[CLS]</code> 能"看到"整个句子</li>
<li>简单高效，一个位置就能代表全局语义</li>
</ul>
<hr/>
<h4 data-id="heading-9">2. Qwen3-VL-Embedding：Last Token Pooling</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant Input as 多模态输入
    participant Processor as Vision+Text&lt;br/&gt;Processor
    participant Decoder as Causal&lt;br/&gt;Decoder
    participant Last as Last Valid&lt;br/&gt;Token
    participant Output as 输出向量

    Input-&gt;&gt;Processor: 文本 + 图像 + 视频
    Processor-&gt;&gt;Decoder: token1, token2, ..., tokenN
    Note over Decoder: 单向注意力&lt;br/&gt;每个token只看左侧
    Decoder-&gt;&gt;Last: tokenN 看到了&lt;br/&gt;所有前面的信息
    Last-&gt;&gt;Output: 提取最后有效token&lt;br/&gt;的 hidden state
    Output-&gt;&gt;Output: L2 归一化
</code></pre>
<p><strong>官方代码实现：</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@staticmethod</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">_pooling_last</span>(<span class="hljs-params">hidden_state: torch.Tensor, attention_mask: torch.Tensor</span>) -&gt; torch.Tensor:
    <span class="hljs-string">"""
    从 hidden_state 中提取每个样本最后一个有效 token 的向量
    
    Args:
        hidden_state: [batch_size, seq_len, hidden_dim]
        attention_mask: [batch_size, seq_len]  # 1=有效token, 0=padding
    
    Returns:
        [batch_size, hidden_dim]  # 每个样本的 embedding
    """</span>
    <span class="hljs-comment"># 步骤1: 翻转 attention_mask (从右往左看)</span>
    flipped_tensor = attention_mask.flip(dims=[<span class="hljs-number">1</span>])
    <span class="hljs-comment"># 例: [1,1,1,1,0,0] → [0,0,1,1,1,1]</span>
    
    <span class="hljs-comment"># 步骤2: 找到第一个1的位置 (翻转后)</span>
    last_one_positions = flipped_tensor.argmax(dim=<span class="hljs-number">1</span>)
    <span class="hljs-comment"># 例: [0,0,1,1,1,1] → argmax=2 (从右数第3个是最后一个1)</span>
    
    <span class="hljs-comment"># 步骤3: 转换回原始索引</span>
    col = attention_mask.shape[<span class="hljs-number">1</span>] - last_one_positions - <span class="hljs-number">1</span>
    <span class="hljs-comment"># 例: 6 - 2 - 1 = 3 (实际最后一个有效token在位置3)</span>
    
    <span class="hljs-comment"># 步骤4: 提取对应位置的 hidden state</span>
    row = torch.arange(hidden_state.shape[<span class="hljs-number">0</span>], device=hidden_state.device)
    <span class="hljs-keyword">return</span> hidden_state[row, col]  <span class="hljs-comment"># 关键：最后一个有效token</span>
</code></pre>
<p><strong>为什么用 Last Token？</strong></p>
<ul>
<li>因果语言模型的特性：最后一个token "看到" 了所有历史信息</li>
<li>与 GPT-style 预训练对齐（预测下一个token）</li>
<li>自然处理变长输入（通过 attention_mask 自动定位）</li>
</ul>
<hr/>
<h3 data-id="heading-10">可视化：注意力流向对比</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    subgraph "BERT: Bi-directional Attention"
        CLS1[CLS] -.双向.-&gt; T1[Token1]
        CLS1 -.双向.-&gt; T2[Token2]
        CLS1 -.双向.-&gt; T3[Token3]
        T1 -.双向.-&gt; T2
        T1 -.双向.-&gt; T3
        T2 -.双向.-&gt; T3
        CLS1 ==&gt; E1[Embedding]
        style CLS1 fill:#90EE90
    end
    
    subgraph "Qwen3-VL: Causal Attention"
        T4[Token1] --&gt; T5[Token2]
        T5 --&gt; T6[Token3]
        T6 --&gt; T7[TokenN]
        T4 -.看不到.-&gt; T5
        T4 -.看不到.-&gt; T6
        T5 -.看不到.-&gt; T6
        T7 ==&gt; E2[Embedding]
        style T7 fill:#FFB6C1
    end
</code></pre>
<hr/>
<h3 data-id="heading-11">实际使用示例对比</h3>
<h4 data-id="heading-12">场景1：纯文本检索</h4>
<h5 data-id="heading-13">常规模型（Sentence-BERT）</h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sentence_transformers <span class="hljs-keyword">import</span> SentenceTransformer

model = SentenceTransformer(<span class="hljs-string">'all-MiniLM-L6-v2'</span>)

<span class="hljs-comment"># 编码文本</span>
text = <span class="hljs-string">"What is machine learning?"</span>
embedding = model.encode(text)  <span class="hljs-comment"># 自动使用 CLS token</span>
<span class="hljs-built_in">print</span>(embedding.shape)  <span class="hljs-comment"># (384,)</span>
</code></pre>
<h5 data-id="heading-14">Qwen3-VL-Embedding</h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> qwen3_vl_embedder <span class="hljs-keyword">import</span> Qwen3VLEmbedder

embedder = Qwen3VLEmbedder(<span class="hljs-string">'Qwen/Qwen3-VL-Embedding'</span>)

<span class="hljs-comment"># 编码文本</span>
inputs = [{<span class="hljs-string">'text'</span>: <span class="hljs-string">"What is machine learning?"</span>}]
embedding = embedder.process(inputs)  <span class="hljs-comment"># 自动使用 Last Token</span>
<span class="hljs-built_in">print</span>(embedding.shape)  <span class="hljs-comment"># (1, hidden_dim)</span>
</code></pre>
<hr/>
<h4 data-id="heading-15">场景2：多模态检索</h4>
<h5 data-id="heading-16">常规模型</h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># 大多数 BERT-style 模型不支持多模态</span>
<span class="hljs-comment"># 需要使用 CLIP 等专门的多模态模型</span>

<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> CLIPModel, CLIPProcessor

model = CLIPModel.from_pretrained(<span class="hljs-string">'openai/clip-vit-base-patch32'</span>)
processor = CLIPProcessor.from_pretrained(<span class="hljs-string">'openai/clip-vit-base-patch32'</span>)

<span class="hljs-comment"># 分别编码文本和图像</span>
text_inputs = processor(text=[<span class="hljs-string">"a photo of a cat"</span>], return_tensors=<span class="hljs-string">"pt"</span>)
text_embedding = model.get_text_features(**text_inputs)

image_inputs = processor(images=image, return_tensors=<span class="hljs-string">"pt"</span>)
image_embedding = model.get_image_features(**image_inputs)
</code></pre>
<h5 data-id="heading-17">Qwen3-VL-Embedding</h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># 原生支持文本+图像+视频混合输入</span>
embedder = Qwen3VLEmbedder(<span class="hljs-string">'Qwen/Qwen3-VL-Embedding'</span>)

<span class="hljs-comment"># 单次调用处理多模态</span>
inputs = [{
    <span class="hljs-string">'text'</span>: <span class="hljs-string">"Describe this image"</span>,
    <span class="hljs-string">'image'</span>: <span class="hljs-string">"/path/to/cat.jpg"</span>,
    <span class="hljs-string">'instruction'</span>: <span class="hljs-string">"Generate a comprehensive embedding"</span>
}]

embedding = embedder.process(inputs)  <span class="hljs-comment"># 融合所有模态信息</span>
</code></pre>
<hr/>
<h3 data-id="heading-18">内部处理流程对比</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    subgraph "常规 Embedding 处理流程"
        A1[输入文本] --&gt; B1[Tokenization]
        B1 --&gt; C1["添加 [CLS] + text + [SEP]"]
        C1 --&gt; D1[Padding to max_length]
        D1 --&gt; E1[Encoder Forward]
        E1 --&gt; F1["提取 hidden_state[:, 0, :]"]
        F1 --&gt; G1[Normalize]
        G1 --&gt; H1[返回向量]
    end
    
    subgraph "Qwen3-VL-Embedding 处理流程"
        A2[多模态输入] --&gt; B2{输入类型}
        B2 --&gt;|图像| C2[Vision Encoder]
        B2 --&gt;|视频| C3[Video Processor&lt;br/&gt;采样帧]
        B2 --&gt;|文本| C4[Tokenization]
        
        C2 --&gt; D2[融合模态tokens]
        C3 --&gt; D2
        C4 --&gt; D2
        
        D2 --&gt; E2[Apply chat template&lt;br/&gt;添加系统prompt]
        E2 --&gt; F2[Causal Decoder Forward]
        F2 --&gt; G2["找到最后有效token位置&lt;br/&gt;(通过 attention_mask)"]
        G2 --&gt; H2["提取 hidden_state[row, col]"]
        H2 --&gt; I2[L2 Normalize]
        I2 --&gt; J2[返回向量]
    end
    
    style F1 fill:#90EE90
    style H2 fill:#FFB6C1
</code></pre>
<hr/>
<h3 data-id="heading-19">性能特点对比</h3>



































<table><thead><tr><th>特性</th><th>常规 Embedding</th><th>Qwen3-VL-Embedding</th></tr></thead><tbody><tr><td><strong>处理速度</strong></td><td>快速</td><td>中等（多模态处理更复杂）</td></tr><tr><td><strong>内存占用</strong></td><td>低</td><td>中高（需处理视觉数据）</td></tr><tr><td><strong>适用场景</strong></td><td>纯文本检索/分类</td><td>多模态检索/RAG/跨模态搜索</td></tr><tr><td><strong>上下文长度</strong></td><td>通常 512 tokens</td><td>默认 8192 tokens</td></tr><tr><td><strong>灵活性</strong></td><td>单一模态</td><td>文本+图像+视频混合</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-20">总结：关键差异</h3>
<h4 data-id="heading-21">1. Pooling 位置不同</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># 常规模型</span>
embedding = hidden_state[:, <span class="hljs-number">0</span>, :]  <span class="hljs-comment"># 第一个位置 (CLS)</span>

<span class="hljs-comment"># Qwen3-VL</span>
embedding = hidden_state[row, last_valid_col]  <span class="hljs-comment"># 最后有效位置</span>
</code></pre>
<h4 data-id="heading-22">2. 注意力机制不同</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[CLS Token&lt;br/&gt;双向注意力] --&gt;|同时看到| B[所有tokens]
    C[Last Token&lt;br/&gt;因果注意力] --&gt;|只看到| D[左侧所有tokens]
    
    style A fill:#90EE90
    style C fill:#FFB6C1
</code></pre>
<h4 data-id="heading-23">3. 设计理念不同</h4>

























<table><thead><tr><th>方面</th><th>常规模型</th><th>Qwen3-VL</th></tr></thead><tbody><tr><td><strong>目标</strong></td><td>句子级表示学习</td><td>多模态理解 + 生成</td></tr><tr><td><strong>预训练</strong></td><td>Masked LM</td><td>Causal LM</td></tr><tr><td><strong>架构选择</strong></td><td>专门为编码设计</td><td>适配生成式模型</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-24">实际应用建议</h3>
<h4 data-id="heading-25">何时使用常规 Embedding？</h4>
<ul>
<li>纯文本检索/相似度匹配</li>
<li>需要极致速度</li>
<li>简单的语义搜索任务</li>
<li>资源受限环境</li>
</ul>
<h4 data-id="heading-26">何时使用 Qwen3-VL-Embedding？</h4>
<ul>
<li>多模态检索（文本+图片+视频）</li>
<li>需要理解图像内容</li>
<li>跨模态搜索（用文本搜图片）</li>
<li>复杂的 RAG 系统</li>
<li>长文本场景（8K+ tokens）</li>
</ul>
<hr/>
<h3 data-id="heading-27">代码实现：完整对比</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ============ 常规 Embedding 模型 ============</span>
<span class="hljs-keyword">from</span> sentence_transformers <span class="hljs-keyword">import</span> SentenceTransformer
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="hljs-keyword">class</span> <span class="hljs-title class_">RegularEmbedder</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, model_name=<span class="hljs-string">'all-MiniLM-L6-v2'</span></span>):
        self.model = SentenceTransformer(model_name)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encode</span>(<span class="hljs-params">self, texts</span>):
        <span class="hljs-comment"># 内部使用 CLS token pooling</span>
        <span class="hljs-keyword">return</span> self.model.encode(texts, normalize_embeddings=<span class="hljs-literal">True</span>)

<span class="hljs-comment"># ============ Qwen3-VL-Embedding ============</span>
<span class="hljs-keyword">from</span> qwen3_vl_embedder <span class="hljs-keyword">import</span> Qwen3VLEmbedder

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MultimodalEmbedder</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, model_path</span>):
        self.embedder = Qwen3VLEmbedder(model_path)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encode</span>(<span class="hljs-params">self, inputs</span>):
        <span class="hljs-comment"># 内部使用 Last Token pooling</span>
        <span class="hljs-keyword">return</span> self.embedder.process(inputs, normalize=<span class="hljs-literal">True</span>)

<span class="hljs-comment"># ============ 使用对比 ============</span>
<span class="hljs-comment"># 纯文本</span>
text_embedder = RegularEmbedder()
text_emb = text_embedder.encode([<span class="hljs-string">"Hello world"</span>])

<span class="hljs-comment"># 多模态</span>
mm_embedder = MultimodalEmbedder(<span class="hljs-string">'Qwen/Qwen3-VL-Embedding'</span>)
mm_emb = mm_embedder.encode([{
    <span class="hljs-string">'text'</span>: <span class="hljs-string">"Hello world"</span>,
    <span class="hljs-string">'image'</span>: <span class="hljs-string">"cat.jpg"</span>  <span class="hljs-comment"># 常规模型做不到</span>
}])
</code></pre>
<hr/>
<h3 data-id="heading-28">最终结论</h3>

























<table><thead><tr><th>问题</th><th>答案</th></tr></thead><tbody><tr><td><strong>核心区别是什么？</strong></td><td>常规用 <strong>CLS Token</strong> (首位)，Qwen3-VL 用 <strong>Last Token</strong> (末位)</td></tr><tr><td><strong>为什么不同？</strong></td><td>架构不同：Encoder(双向) vs Decoder(单向)</td></tr><tr><td><strong>哪个更好？</strong></td><td>取决于任务：纯文本用常规，多模态用 Qwen3-VL</td></tr><tr><td><strong>可以互换吗？</strong></td><td>不建议，各自有优化场景</td></tr></tbody></table>
<p><strong>关键记忆点</strong>：</p>
<ul>
<li>BERT-style: <strong>头部取值</strong>（CLS token 在开头汇总全局）</li>
<li>GPT-style: <strong>尾部取值</strong>（Last token 累积所有历史）</li>
</ul>
<p>这是我最经在使用的模型分析，如果你也感兴趣的话可以看一下官方提供的脚本希望我的分享对你有帮助</p>
<p>参考官方的脚本地址：</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhuggingface.co%2FQwen%2FQwen3-VL-Embedding-8B%2Fblob%2Fmain%2Fscripts%2Fqwen3_vl_embedding.py" target="_blank" title="https://huggingface.co/Qwen/Qwen3-VL-Embedding-8B/blob/main/scripts/qwen3_vl_embedding.py" ref="nofollow noopener noreferrer">Qwen/Qwen3-VL-Embedding-8B</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Laravel AI SDK 在 Laracon India 2026 首次亮相]]></title>    <link>https://juejin.cn/post/7602154088475656230</link>    <guid>https://juejin.cn/post/7602154088475656230</guid>    <pubDate>2026-02-02T23:38:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602154088475656230" data-draft-id="7602072073135390747" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Laravel AI SDK 在 Laracon India 2026 首次亮相"/> <meta itemprop="keywords" content="后端,PHP,Laravel"/> <meta itemprop="datePublished" content="2026-02-02T23:38:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="BingoGo"/> <meta itemprop="url" content="https://juejin.cn/user/993614242266077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Laravel AI SDK 在 Laracon India 2026 首次亮相
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614242266077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    BingoGo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T23:38:25.000Z" title="Mon Feb 02 2026 23:38:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Laravel AI SDK 在 Laracon India 2026 首次亮相</h2>
<p>2026 年 1 月 31 日，Taylor Otwell 在 Laracon India 2026 上首次公开展示了 Laravel AI SDK。这套他已开发数月的全新工具集，有望彻底改变 Laravel 应用中的 AI 集成方式。</p>
<h3 data-id="heading-1">什么是 Laravel AI SDK？</h3>
<p>Laravel AI SDK 旨在大幅简化与各类 AI 服务商的交互，支持以下操作：</p>
<ul>
<li>获取类似 ChatGPT 的聊天机器人响应</li>
<li>通过 embeddings 实现数据库语义搜索</li>
<li>生成视频、音频和转录文本</li>
<li>以及更多功能</li>
</ul>
<p>Taylor Otwell 的目标是提供优雅的 Laravel 语法和简洁的 API，无论你选择哪个 AI 服务商。实际使用时，只需调用 <code>agent()-&gt;prompt('你的请求...')</code> 即可获得结果。</p>
<h3 data-id="heading-2">配置 AI 服务商</h3>
<p>配置过程非常简单。在 <code>config/ai.php</code> 文件中，你可以为不同的服务商配置 API 密钥，如 Anthropic、OpenAI、Cohere、ElevenLabs 或 Gemini。</p>
<p>SDK 还允许根据操作类型设置默认服务商：</p>
<ul>
<li><code>default</code> → openai</li>
<li><code>default_for_images</code> → gemini</li>
<li><code>default_for_audio</code> → openai</li>
<li><code>default_for_transcription</code> → openai</li>
<li><code>default_for_embeddings</code> → openai</li>
<li><code>default_for_reranking</code> → cohere</li>
</ul>
<h3 data-id="heading-3">基础用法：调用 Agent</h3>
<p>最简单的示例展示了这种极简方式的强大：</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-title class_">Route</span>::<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">'/agent'</span>, function () {
    <span class="hljs-variable">$response</span> = <span class="hljs-title function_ invoke__">agent</span>(
        <span class="hljs-attr">instructions</span>: <span class="hljs-string">'You are a helpful assistant.'</span>
    )-&gt;<span class="hljs-title function_ invoke__">prompt</span>(<span class="hljs-string">'Tell me about Laravel in one sentence.'</span>);
});
</code></pre>
<p>响应返回包含调用元数据的完整结构，包括使用的 token 数、服务商、模型，当然还有响应内容。</p>
<h3 data-id="heading-4">JsonSchema 自定义数据结构</h3>
<p>你可以通过提供 JSON Schema 精确定义返回结果的格式。这让你能够获得可直接在应用中使用的结构化数据。</p>
<h3 data-id="heading-5">队列处理与流式响应</h3>
<p>由于 LLM 响应可能需要一些时间，SDK 提供了两种优雅的选项：</p>
<ul>
<li><strong>队列处理</strong>：将请求委托给 Laravel Job</li>
<li><strong>流式响应</strong>：逐字显示响应，就像传统聊天机器人一样</li>
</ul>
<p>这种灵活性与现有的 Laravel 生态系统完美集成。</p>
<h3 data-id="heading-6">图像生成</h3>
<p>Laravel 的「开箱即用」理念在这里体现得淋漓尽致。你可以将 AI SDK 的新功能与 Laravel 现有功能（如队列和文件系统）结合使用。</p>
<p>生成图像变得如此简单：</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-title function_ invoke__">agent</span>()-&gt;<span class="hljs-title function_ invoke__">generateImage</span>(<span class="hljs-string">'prompt here'</span>)-&gt;<span class="hljs-title function_ invoke__">store</span>(<span class="hljs-string">'path'</span>);
</code></pre>
<p>你甚至可以通过添加新的 AI 提示词来修改现有图像。</p>
<h3 data-id="heading-7">音频与转录</h3>
<p>与图像类似，SDK 允许通过 ElevenLabs 等服务商处理音频，无论是生成音频还是转录现有内容。</p>
<h3 data-id="heading-8">Embeddings 与语义搜索</h3>
<p>最令人印象深刻的功能之一是在项目中实现语义搜索的便捷性。</p>
<p>例如，搜索 "big boats" 可以找到电影 "Titanic"，即使其描述中没有包含 "boat" 这个词。这就是 embeddings 的魔力。</p>
<p>虽然底层实现复杂，但控制器端的代码依然简洁优雅。这个功能配合 PostgreSQL 效果最佳，因为 PostgreSQL 具有原生向量搜索功能，已在 Laravel 12 中新增支持。</p>
<h3 data-id="heading-9">Agent 类</h3>
<p>SDK 将支持通过命令生成专用的 Agent 类：</p>
<pre><code class="hljs language-shell" lang="shell">php artisan make:agent
</code></pre>
<p>这些类提供了丰富的配置选项，比如 <code>UseCheapestModel</code> 属性可以自动选择各服务商最经济的模型（haiku、nano 等）。</p>
<p>Taylor 还展示了其他可配置的功能：</p>
<ul>
<li>Middleware</li>
<li>自定义配置</li>
<li>数据结构</li>
<li>带 Schema 的工具</li>
<li>网页搜索</li>
</ul>
<h3 data-id="heading-10">发布计划</h3>
<p>Laravel AI SDK 计划于本周四正式发布。这套全新工具集有望让 Laravel 应用中的 AI 集成变得像框架的其他部分一样简单优雅。</p>
<p>这次演示再次证明了 Laravel 生态系统适应新技术的能力，同时保持其核心理念：让 Web 开发变得愉快且高效！</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcatchadmin.com%2Fpost%2F2026-02%2Flaravel-ai-sdk" target="_blank" title="https://catchadmin.com/post/2026-02/laravel-ai-sdk" ref="nofollow noopener noreferrer">Laravel AI SDK 在 Laracon India 2026 首次亮相</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[变幻的光影，不变的干草堆 -- 肘子的 Swift 周报 #121]]></title>    <link>https://juejin.cn/post/7602259669706440730</link>    <guid>https://juejin.cn/post/7602259669706440730</guid>    <pubDate>2026-02-03T00:01:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602259669706440730" data-draft-id="7601843005003431946" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="变幻的光影，不变的干草堆  -- 肘子的 Swift 周报 #121"/> <meta itemprop="keywords" content="Swift,SwiftUI,人工智能"/> <meta itemprop="datePublished" content="2026-02-03T00:01:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="东坡肘子"/> <meta itemprop="url" content="https://juejin.cn/user/1548526032528727"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            变幻的光影，不变的干草堆  -- 肘子的 Swift 周报 #121
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1548526032528727/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    东坡肘子
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T00:01:03.000Z" title="Tue Feb 03 2026 00:01:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读9分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1a7cbc12401e485fa3d97912d11097fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lic5Z2h6IKY5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770681663&amp;x-signature=Fmcqo2XgtLMP5iRXmDg18FPjdSg%3D" alt="issue121.webp" loading="lazy"/></p>
<h2 data-id="heading-0">变幻的光影，不变的干草堆</h2>
<p>两周前，借着参加 iOS Conf SG 2026 的契机，我造访了新加坡国立美术馆，并有幸参观了《走进现代：波士顿美术博物馆印象派大师展》。尽管此前也看过不少优秀的展览，但这次经历仍带来了某种不同寻常的触动。</p>
<p>新加坡国立美术馆由两座极具历史分量的国家古迹——前最高法院与前市政厅——合并而成。设计师以极简的金属与玻璃屋顶将两座古典建筑连接在一起，在建筑层面便营造出一种强烈的临场感：历史与现代在同一物理空间中彼此交织。而正在展出的特展《Into the Modern》，汇集了莫奈、雷诺阿、马奈、塞尚、德加等 25 位大师的一百余幅原作，则将这种跨越时间的对话进一步推向了艺术层面。</p>
<p>展览并未简单依循时间线展开，而是以“现代性”为核心叙事线索，通过“城市与变革”“光影与瞬间”“阶级与休闲”等主题层层铺陈。尽管这里的“现代”指向的是 19 世纪末，但画作中所呈现的巴黎城市改造、光影技法的演变，以及新兴休闲与娱乐方式的兴起，无不从多个维度展现了那个时代社会前行的节奏。在这样一个时空交错的场域中，展览早已超越了单纯“观看艺术品”的层次。对于每天都被社交媒体时间线中海量“新技术”信息裹挟的我而言，这无疑是一段难得的平静与反思时刻。</p>
<p>回到现实，仅仅在过去的几天里，大热 AI 项目的名字就从 Clawdbot 变成 Moltbot，又迅速演化为 OpenClaw。从微观视角看，我们仿佛正身处一个以分秒计量的变革时代；但若在若干年后，从更长的时间尺度重新审视当下的 AI 热潮，或许会发现，世界并未如洪流之中的我们所感知的那样，发生着本质上的突变。</p>
<p>身处其中，我们难免会因层出不穷的新技术、新工具而兴奋，甚至焦虑。或许，在这种情绪之外，更需要一种更深层的定力。历史反复提醒我们，任何“高技术”都具有其时间局限性。正如莫奈在不同时间、不同光线下反复描绘同一座干草堆：绘画技法在变化，但核心对象始终未变；真正发生变化的，往往是观看方式、理解层次与创作者自身的心境。</p>
<p>在面对“现在与未来”时，也许我们可以少一些追逐变革的慌张，多一些凝视瞬间的从容。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Ffatbobman.com%2Fzh%2Fweekly%2Fissue-121%2F" target="_blank" title="https://fatbobman.com/zh/weekly/issue-121/" ref="nofollow noopener noreferrer">本期内容</a> | <a href="https://link.juejin.cn?target=https%3A%2F%2Ffatbobman.com%2Fzh%2Fweekly%2Fissue-120%2F" target="_blank" title="https://fatbobman.com/zh/weekly/issue-120/" ref="nofollow noopener noreferrer">前一期内容</a> | <a href="https://link.juejin.cn?target=https%3A%2F%2Ffatbobman.com%2Fzh%2Fweekly%2F" target="_blank" title="https://fatbobman.com/zh/weekly/" ref="nofollow noopener noreferrer">全部周报列表</a></p>
<blockquote>
<p>🚀 <strong>《肘子的 Swift 周报》</strong></p>
<p>每周为你精选最值得关注的 Swift、SwiftUI 技术动态</p>
<ul>
<li><strong>📮 立即订阅</strong> | <a href="https://link.juejin.cn?target=https%3A%2F%2Fweekly.fatbobman.com%2Ffatbobman" target="_blank" title="https://weekly.fatbobman.com/fatbobman" ref="nofollow noopener noreferrer">weekly.fatbobman.com</a> 获取完整内容</li>
<li><strong>👥 加入社区</strong> | <a href="https://link.juejin.cn?target=https%3A%2F%2Fdiscord.com%2Finvite%2F7FedN5E2QQ" target="_blank" title="https://discord.com/invite/7FedN5E2QQ" ref="nofollow noopener noreferrer">Discord</a> 与 2000+ 开发者交流</li>
<li><strong>📚 深度教程</strong> | <a href="https://link.juejin.cn?target=http%3A%2F%2Ffatbobman.com" target="_blank" title="http://fatbobman.com" ref="nofollow noopener noreferrer">fatbobman.com</a> 探索 200+ 原创文章</li>
</ul>
</blockquote>
<h2 data-id="heading-1">近期推荐</h2>
<h3 data-id="heading-2"><a href="https://link.juejin.cn?target=https%3A%2F%2Fl.fatbobman.com%2Fsb-proxyman" target="_blank" title="https://l.fatbobman.com/sb-proxyman" ref="nofollow noopener noreferrer">调试 iOS 网络请求总是被证书配置难住？</a></h3>
<p>Proxyman 是一款为 iOS 开发者打造的现代 HTTP 抓包工具。支持 SSL 代理、GraphQL、WebSocket 及强大的脚本注入功能。告别笨重的传统工具，体验专为 macOS 优化的极致调试效率。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fl.fatbobman.com%2Fsb-proxyman" target="_blank" title="https://l.fatbobman.com/sb-proxyman" ref="nofollow noopener noreferrer">🚀 立即试用 →</a></p>
<hr/>
<h3 data-id="heading-3"><a href="https://link.juejin.cn?target=https%3A%2F%2Fl.fatbobman.com%2Fw0121-01" target="_blank" title="https://l.fatbobman.com/w0121-01" ref="nofollow noopener noreferrer">SwiftUI 调试背后的多重类型擦除机制 (DebugReplaceableView and Swift 6.2's Multiple Type Erasers)</a></h3>
<p>或许你可能对 Xcode 的 Preview 仍不甚满意，但其实在过去几年间，苹果一直在这方面积极地进行着优化工作，并且取得了不少的进展。比如，从 Xcode 16 开始，便在预览和调试模式下，通过 <code>@_typeEraser</code> 自动将视图转换为 <code>AnyView</code> 以增加更多的调试信息。而从 Xcode 26 开始，通过增强 <code>@_typeEraser</code> 使其支持多重类型擦除器，在 macOS/iOS 26+ 平台上将视图转换成 <code>DebugReplaceableView</code>，实现视图的热替换而无需重建整个视图层级，进一步改善预览性能。在本文中，<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2FKyleSwifter" target="_blank" title="https://x.com/KyleSwifter" ref="nofollow noopener noreferrer">Kyle Ye</a> 从编译器源码层面深入剖析了这一机制的实现原理，解释了编译器如何根据平台可用性自动选择合适的类型擦除器。</p>
<hr/>
<h3 data-id="heading-4"><a href="https://link.juejin.cn?target=https%3A%2F%2Fl.fatbobman.com%2Fw0121-02" target="_blank" title="https://l.fatbobman.com/w0121-02" ref="nofollow noopener noreferrer">Swift 中的分层缓存设计 (Tiered Caching in Swift)</a></h3>
<p>在需要同时兼顾性能、内存占用与数据一致性的场景中，单一缓存策略往往很快就会捉襟见肘。这篇文章中，<a href="https://link.juejin.cn?target=https%3A%2F%2Flinkedin.com%2Fin%2Fkyle-browning-eng-manager" target="_blank" title="https://linkedin.com/in/kyle-browning-eng-manager" ref="nofollow noopener noreferrer">Kyle Browning</a> 以实践视角系统介绍了分层缓存（Tiered Caching）在 Swift 中的实现思路：通过将内存缓存与磁盘缓存组织成清晰的层级结构，配合灵活的缓存策略（如 <code>cacheThenFetch</code>、<code>cacheElseFetch</code> 等），让数据在不同访问成本之间有序流动。</p>
<hr/>
<h3 data-id="heading-5"><a href="https://link.juejin.cn?target=https%3A%2F%2Fl.fatbobman.com%2Fw0121-03" target="_blank" title="https://l.fatbobman.com/w0121-03" ref="nofollow noopener noreferrer">基于 Cloudflare 的 SwiftUI 实时协作编辑实践 (SwiftUI: Realtime, Multi-User Content Collaboration With CloudFlare +YJS-Swift)</a></h3>
<p>尽管市面上已经存在不少现成的服务与框架，实时协作编辑在工程层面依然是一道不低的门槛。本文中，<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fitsuki68391179" target="_blank" title="https://x.com/itsuki68391179" ref="nofollow noopener noreferrer">Itsuki</a> 系统性地展示了如何在 SwiftUI 中，借助 Cloudflare Durable Objects + WebSocket Hibernation API + YJS-Swift，构建一个低成本、可扩展、支持多用户实时协作的内容编辑系统。</p>
<p>尤其值得一提的是，作者详细分享了在 SwiftUI 接收远程内容更新时，如何正确维护文本光标与选区位置的处理技巧——这一部分非常贴近真实产品开发，明显属于“踩过坑之后才会写出来”的经验。</p>
<hr/>
<h3 data-id="heading-6"><a href="https://link.juejin.cn?target=https%3A%2F%2Fl.fatbobman.com%2Fw0121-04" target="_blank" title="https://l.fatbobman.com/w0121-04" ref="nofollow noopener noreferrer">Swift Actor 的 6 个常见陷阱 (Swift Actors: 6 pitfalls that will catch even experienced developers)</a></h3>
<p>Actor 是 Swift 并发模型中最重要、也最容易被“想当然”使用的语言特性之一，然而现实远比这复杂。<a href="https://link.juejin.cn?target=https%3A%2F%2Fpl.linkedin.com%2Fin%2Frafa%25C5%2582-dubiel-86317013b" target="_blank" title="https://pl.linkedin.com/in/rafa%C5%82-dubiel-86317013b" ref="nofollow noopener noreferrer">Rafał Dubiel</a> 在本文中总结了 6 个即使是资深开发者也常踩的 Actor 陷阱：可重入性导致的状态不一致、Actor Hopping 的性能代价、<code>@MainActor</code> 与 Objective-C 回调交互时的线程安全漏洞、<code>@unchecked Sendable</code> 的滥用风险、<code>nonisolated</code> 的误解，以及 Actor 并不保证执行顺序这一反直觉的事实。</p>
<p>Rafał 并未停留在概念层面的提醒，而是结合具体场景解释这些问题为何真实存在、又为何容易被忽视。</p>
<hr/>
<h3 data-id="heading-7"><a href="https://link.juejin.cn?target=https%3A%2F%2Fl.fatbobman.com%2Fw0121-05" target="_blank" title="https://l.fatbobman.com/w0121-05" ref="nofollow noopener noreferrer">SwiftUI 全局主题系统的可扩展设计 (Designing a Scalable App-Wide Theming System in SwiftUI)</a></h3>
<p>在 SwiftUI 中实现全局主题（Theming），看似是个“样式管理”问题，实则很容易牵扯到状态传播、依赖注入以及视图刷新边界等更深层的设计选择。<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2FSagarUnagar_" target="_blank" title="https://x.com/SagarUnagar_" ref="nofollow noopener noreferrer">Sagar Unagar</a> 从一个现实需求出发，系统展示了一套基于 SwiftUI Environment 的全局主题系统设计：通过 <code>EnvironmentKey</code> 让主题像内置环境值一样访问，以语义化的 Design Tokens 取代散落各处的硬编码值。</p>
<p>Sagar 关注的并不仅是“如何做”，而是“哪种方式在长期更可控”——这套方案不依赖特定库，核心思想是“语义化 + 响应式”，可以轻松扩展到字体、间距、圆角等设计要素。</p>
<hr/>
<h3 data-id="heading-8"><a href="https://link.juejin.cn?target=https%3A%2F%2Fl.fatbobman.com%2Fw0121-06" target="_blank" title="https://l.fatbobman.com/w0121-06" ref="nofollow noopener noreferrer">在 Swift 中实现“只执行一次”的优雅方式 (Call Once)</a></h3>
<p>“确保闭包只执行一次”听起来像是一个再基础不过的需求，但在真实系统里，这往往并不只是加一个布尔值那么简单。<a href="https://link.juejin.cn?target=https%3A%2F%2Fhachyderm.io%2F%40paulio87" target="_blank" title="https://hachyderm.io/@paulio87" ref="nofollow noopener noreferrer">Paul Samuels</a> 在本文中展示了如何用 <code>@propertyWrapper</code> 封装这一行为，并逐步演进：从只支持 <code>() -&gt; Void</code> 的基础版本，到引入泛型支持返回值，最终借助 Swift 的 Parameter Packs（<code>each Argument</code>）实现对任意函数签名的支持。</p>
<p>这是一篇偏思考型的文章，其价值不仅在于最终的 <code>CallOnce</code> 实现，更在于展示了如何将多个 Swift 语言特性逐步组合起来，解决一个看似简单却颇具代表性的工程问题。</p>
<h2 data-id="heading-9">工具</h2>
<h3 data-id="heading-10"><a href="https://link.juejin.cn?target=https%3A%2F%2Fl.fatbobman.com%2Fw0121-07" target="_blank" title="https://l.fatbobman.com/w0121-07" ref="nofollow noopener noreferrer">SwiftUI-Agent-Skill：让 AI 写出更“靠谱”的 SwiftUI 代码</a></h3>
<p>如果你正在使用 AI 编程助手（如 Claude Code、Cursor、Codex），很可能遇到过类似的问题：AI 生成的 SwiftUI 代码使用了<strong>过时的 API</strong>，或在状态管理、视图组织上偏离最佳实践——即便你已经在基础规则中反复强调过这些要求。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Ftwannl" target="_blank" title="https://x.com/twannl" ref="nofollow noopener noreferrer">Antoine van der Lee</a> 发布的 <strong>SwiftUI-Agent-Skill</strong>，正是为了解决这一“最后一公里”的落差。它为 AI 工具提供了一套专家级的 SwiftUI 指导规范，涵盖状态管理取舍、现代 API 替换、性能与可维护性检查，以及 iOS 26+ 的 Liquid Glass 使用边界等内容，把“SwiftUI 最容易写歪的地方”整理成可复用、可执行的审查流程。</p>
<blockquote>
<p>除了这套 skill 外，Antoine 还提供了面向 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FAvdLee%2FSwift-Concurrency-Agent-Skill" target="_blank" title="https://github.com/AvdLee/Swift-Concurrency-Agent-Skill" ref="nofollow noopener noreferrer">Swift Concurrency</a> 和 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FAvdLee%2FCore-Data-Agent-Skill" target="_blank" title="https://github.com/AvdLee/Core-Data-Agent-Skill" ref="nofollow noopener noreferrer">Core Data</a> 的 skill。</p>
<p>我建议开发者不要只是把它们简单配置进 AI 环境中就结束了——这些 skill 文档本身就是对某一领域实践经验的结构化总结。认真读一遍，受益的不只是 AI，你自己也会随之进阶。</p>
</blockquote>
<hr/>
<h3 data-id="heading-11"><a href="https://link.juejin.cn?target=https%3A%2F%2Fl.fatbobman.com%2Fw0121-08" target="_blank" title="https://l.fatbobman.com/w0121-08" ref="nofollow noopener noreferrer">PierreDiffsSwift：在 macOS 应用中渲染精美的代码 Diff 视图</a></h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fx.com%2Fjamesrochabrun" target="_blank" title="https://x.com/jamesrochabrun" ref="nofollow noopener noreferrer">James Rochabrun</a> 开发的 PierreDiffsSwift，帮助开发者在 macOS 应用中渲染漂亮的、带语法高亮的代码 Diff 视图。</p>
<p>该库提供了一个开箱即用的解决方案：基于 <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2F%40pierre%2Fdiffs" target="_blank" title="https://www.npmjs.com/package/@pierre/diffs" ref="nofollow noopener noreferrer">@pierre/diffs</a> JavaScript 库，通过 WKWebView 封装成 SwiftUI 原生视图，支持 40+ 种语言的语法高亮、Split/Unified 两种视图模式、行内单词级变更高亮，以及深色/浅色主题自动切换。</p>
<h2 data-id="heading-12">往期内容</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ffatbobman.com%2Fzh%2Fweekly%2Fissue-120%2F" target="_blank" title="https://fatbobman.com/zh/weekly/issue-120/" ref="nofollow noopener noreferrer">Skip 开源：从“卖工具”到“卖信任”的豪赌 - #120</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ffatbobman.com%2Fzh%2Fweekly%2Fissue-119%2F" target="_blank" title="https://fatbobman.com/zh/weekly/issue-119/" ref="nofollow noopener noreferrer">从 Anthropic 封杀与苹果谷歌结盟，看 AI 护城河的构建 - #119</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ffatbobman.com%2Fzh%2Fweekly%2Fissue-118%2F" target="_blank" title="https://fatbobman.com/zh/weekly/issue-118/" ref="nofollow noopener noreferrer">AT 的人生未必比 MT 更好- #118</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fhttps%3A%2F%2Ffatbobman.com%2Fzh%2Fweekly%2Fissue-117%2F" target="_blank" title="https://https://fatbobman.com/zh/weekly/issue-117/" ref="nofollow noopener noreferrer">2026：当 AI 隐入工作流，你准备好了吗？- #117</a></li>
</ul>
<h2 data-id="heading-13">💝 支持与反馈</h2>
<p>如果本期周报对你有帮助，请：</p>
<ul>
<li>👍 <strong>点赞</strong> - 让更多开发者看到</li>
<li>💬 <strong>评论</strong> - 分享你的看法或问题</li>
<li>🔄 <strong>转发</strong> - 帮助同行共同成长</li>
</ul>
<hr/>
<blockquote>
<p>🚀 <strong>拓展 Swift 视野</strong></p>
<ul>
<li><strong>📮 邮件订阅</strong> | <a href="https://link.juejin.cn?target=https%3A%2F%2Fweekly.fatbobman.com%2Fwelcome" target="_blank" title="https://weekly.fatbobman.com/welcome" ref="nofollow noopener noreferrer">weekly.fatbobman.com</a> 获取独家技术洞察</li>
<li><strong>👥 开发者社区</strong> | <a href="https://link.juejin.cn?target=https%3A%2F%2Fdiscord.com%2Finvite%2F7FedN5E2QQ" target="_blank" title="https://discord.com/invite/7FedN5E2QQ" ref="nofollow noopener noreferrer">Discord</a> 实时交流开发经验</li>
<li><strong>📚 原创教程</strong> | <a href="https://link.juejin.cn?target=http%3A%2F%2Ffatbobman.com" target="_blank" title="http://fatbobman.com" ref="nofollow noopener noreferrer">fatbobman.com</a> 学习 Swift/SwiftUI 最佳实践</li>
</ul>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[春哥的Agent通关秘籍03：格式化输出【知识篇】]]></title>    <link>https://juejin.cn/post/7602073088428982287</link>    <guid>https://juejin.cn/post/7602073088428982287</guid>    <pubDate>2026-02-03T00:01:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602073088428982287" data-draft-id="7602097118031577123" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="春哥的Agent通关秘籍03：格式化输出【知识篇】"/> <meta itemprop="keywords" content="前端,后端,JavaScript"/> <meta itemprop="datePublished" content="2026-02-03T00:01:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="摸鱼的春哥"/> <meta itemprop="url" content="https://juejin.cn/user/1714893870865303"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            春哥的Agent通关秘籍03：格式化输出【知识篇】
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1714893870865303/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    摸鱼的春哥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-03T00:01:23.000Z" title="Tue Feb 03 2026 00:01:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-03
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读9分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;font-weight:400;line-height:2;font-size:17px;overflow-x:hidden;color:#000}.markdown-body strong{padding:1px;color:#ee3f4d}.markdown-body em{padding:0 2px;color:#f33b1f}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;margin-top:30px;margin-bottom:20px;line-height:1.5;font-weight:700}.markdown-body h1{text-align:center;padding-bottom:5px;font-size:32px;color:#ac1f18}.markdown-body h1:after{content:"";display:block;margin:4px auto 0;width:100px;height:2px;border-bottom:2px solid #f33b1f}.markdown-body h2{font-size:28px;border-bottom:1px solid #f33b1f}.markdown-body h2:before{content:"# "!important;color:#f33b1f}.markdown-body h3{font-size:24px;padding-left:9px;border-left:6px solid #f33b1f}.markdown-body h4{font-size:20px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #bbb;margin:16px 0}.markdown-body code{word-break:break-word;overflow-x:auto;background-color:#f9f1db;color:#ee2746;border-radius:2px;font-size:16px;padding:1px 2px}.markdown-body code,.markdown-body pre{font-family:-apple-system,-apple-system-body,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,PingFang SC,思源黑体 CN,思源黑体,JetBrains Mono,Fira Code,Menlo,Ubuntu Mono,Consolas,sans-serif}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{margin:12px 0!important;border-radius:3px;font-size:15px;padding:16px 12px;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f7f7f7}.markdown-body a{text-decoration:none;color:#1781b5;padding:0 2px;border-bottom:1px solid #1781b5}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #f33b1f;color:#ac1f18}.markdown-body blockquote{color:#3d3d3d;background-color:#fff9f9;padding:6px 16px;margin:16px 0;border-left:3px solid #f07c82}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:6px 0}.markdown-body ol,.markdown-body ul{padding-left:30px}.markdown-body ol li,.markdown-body ul li{margin-bottom:6px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:6px}.markdown-body ol li{padding-left:6px}.markdown-body ::marker{color:#f33b1f}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body .task-list-item input[type=checkbox]{position:relative}.markdown-body .task-list-item input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:#fff;border:1px solid #f07c82;border-radius:3px;box-sizing:border-box;z-index:1}.markdown-body .task-list-item input[type=checkbox]:checked:after{content:"✓";position:absolute;top:-5px;left:0;right:0;bottom:0;width:0;height:0;color:#f33b1f;font-size:16px;font-weight:700;z-index:2}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border-spacing:0;border-collapse:collapse}.markdown-body table thead{background:#fff9f9;color:#000;text-align:left;font-size:15px}.markdown-body table tr:nth-child(2n){background-color:#fcfcfc}.markdown-body table tr:hover{background-color:#fff9f9}.markdown-body table td,.markdown-body table th{padding:12px 7px;line-height:24px;border:1px solid #f9f1db}.markdown-body table td{min-width:120px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="monokai">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#272822;color:#ddd}.hljs-keyword,.hljs-literal,.hljs-name,.hljs-selector-tag,.hljs-strong,.hljs-tag{color:#f92672}.hljs-code{color:#66d9ef}.hljs-class .hljs-title{color:#fff}.hljs-attribute,.hljs-link,.hljs-regexp,.hljs-symbol{color:#bf79db}.hljs-addition,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-emphasis,.hljs-section,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-string,.hljs-subst,.hljs-template-tag,.hljs-template-variable,.hljs-title,.hljs-type,.hljs-variable{color:#a6e22e}.hljs-comment,.hljs-deletion,.hljs-meta,.hljs-quote{color:#75715e}.hljs-doctag,.hljs-keyword,.hljs-literal,.hljs-section,.hljs-selector-id,.hljs-selector-tag,.hljs-title,.hljs-type{font-weight:700}</style><p>在上一课中，我们成功连接了 DeepSeek 大模型，实现了简单的对话。</p>
<p>但你会发现，AI 回复的是自然语言:</p>
<blockquote>
<p>“你好，北京今天天气不错...”</p>
</blockquote>
<p>对于人类来说，这很好；但对于程序来说，这是灾难。</p>
<p>java/python/js都无法理解“天气不错”，它更适合去理解:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"temperature"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">25</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>Agent 开发的第一定律：必须强迫 AI 输出结构化数据（JSON）。</p>
<p>这一课，我们将学习如何规范化AI输出，让它乖乖吐出我们想要的格式。</p>
<h2 data-id="heading-0">一，吐出 JSON，你需要双管齐下</h2>
<p>在 Agent 开发的早期（OpenAI 刚刚发布 API 时），让模型稳定输出 JSON 是一门“玄学”。开发者往往要写很长的 Prompt 求爷爷告奶奶：“求求你只回 JSON，别说话”。</p>
<p>即便这样，模型有时还是会“礼貌性”地加一句：“好的，这是你要的数据...”。</p>
<p>现在，为了保证 100% 的稳定性，我们采用**“双管齐下”**的策略。</p>
<p>不仅要在提示词上给与规范，更要触碰ta灵魂最深处的底层机制。</p>
<h3 data-id="heading-1">1.1 底层约束 (response_format)</h3>
<blockquote>
<p>这一层能保证是 JSON，但不保证字段。</p>
</blockquote>
<p>这是 API 服务端的一个**“强力开关”**。</p>
<p>以  <code>deepseek</code> 为例，你可以查看文档：<a href="https://link.juejin.cn?target=https%3A%2F%2Fapi-docs.deepseek.com%2Fzh-cn%2Fguides%2Fjson_mode" target="_blank" title="https://api-docs.deepseek.com/zh-cn/guides/json_mode" ref="nofollow noopener noreferrer">api-docs.deepseek.com/zh-cn/guide…</a>。</p>
<p><img src="https://pic.zhangshichun.top/pic/20260201112028149.png" alt="" loading="lazy"/></p>
<p>只要在请求API服务时给出限制参数：</p>
<pre><code class="hljs language-python" lang="python">response_format={<span class="hljs-string">"type"</span>: <span class="hljs-string">"json_object"</span>}
</code></pre>
<ul>
<li>
<p>它的作用：它在模型生成的底层（概率分布层面）强行干预。它像一个严苛的**“语法警察”**，按住了 AI 的手。</p>
</li>
<li>
<p>效果：开启后，模型吐出的第一个字符必须是 {，最后一个字符必须是 }。它物理上杜绝了 AI 说“好的，结果如下...”这类废话的可能性。</p>
</li>
<li>
<p>局限性：它只保证输出的是合法的 JSON 语法（括号配对、逗号正确），但不保证里面的字段是你想要的。它可能输出 {"hello": "world"}，而你想要的是 {"price": 10}。</p>
</li>
</ul>
<p>怎么办?</p>
<p>每次都跟AI列一个字段清单吗？有没有更规范更符合程序员思维的做法？</p>
<p>有的兄弟，有的！</p>
<p>此时，我们需要第二个工具：</p>
<p><strong>JSONSchema</strong>!</p>
<h3 data-id="heading-2">1.2 JSONSchema</h3>
<blockquote>
<p>用一个JSON来描述我要的JSON格式</p>
</blockquote>
<p>仅仅有语法是不够的，我们还需要告诉 AI 具体的数据结构。这就是 Pydantic 生成的 JSON Schema 发挥作用的地方。</p>
<p>那么，什么是 JSONSchema呢？</p>
<p>简单来说：<code>JSONSchema</code> 是一种用来描述JSON结构的语法。</p>
<p>它能清晰地指出：我想要你返回给我的JSON串有哪几个字段，每个字段是什么类型，是什么含义。</p>
<p>比如，我想要一个如下类型的JSON字符串：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"张三"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"age"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">25</span><span class="hljs-punctuation">,</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>我应该如何结构化地对AI提出要求呢？答案就是用JSONSchema:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"object"</span><span class="hljs-punctuation">,</span>             <span class="hljs-comment">// 根节点必须是一个对象 {}</span>
  <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>               <span class="hljs-comment">// 定义有哪些字段</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"string"</span><span class="hljs-punctuation">,</span>         <span class="hljs-comment">// name 必须是字符串</span>
      <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"用户全名"</span>  <span class="hljs-comment">// 给 AI 看的说明</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"age"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"integer"</span><span class="hljs-punctuation">,</span>        <span class="hljs-comment">// age 必须是整数</span>
      <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"用户年龄"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"minimum"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>             <span class="hljs-comment">// 最小值不能小于 0</span>
      <span class="hljs-attr">"maximum"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">150</span>            <span class="hljs-comment">// 最大值不能超过 150</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"required"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"name"</span><span class="hljs-punctuation">]</span>   <span class="hljs-comment">// 必填项：必须有 name</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>我们必须保证，这个JSONSchema会作为我们提出的要求的一部分，提交给AI对话，这样它才能保证返回的JSON内容字段符合我们的要求。</p>
<p>这里是JSONSchema的国际规范：<a href="https://link.juejin.cn?target=https%3A%2F%2Fjson-schema.org%2F" target="_blank" title="https://json-schema.org/" ref="nofollow noopener noreferrer">json-schema.org/</a>，有兴趣的朋友可以继续了解细节，它在前端的应用还是很广泛的，比如低代码、字段校验等。</p>
<p>好的，两个强力的JSON规范帮手有了。</p>
<p><img src="https://pic.zhangshichun.top/pic/20260202171646644.png" alt="" loading="lazy"/></p>
<p>那么，就引出了一个新的问题：</p>
<p><strong>如何组织我们的会话?</strong></p>
<h2 data-id="heading-3">二、理解 （系统提示词）和 （用户提示词）</h2>
<p>在 Agent 开发中，理解 System Prompt（系统提示词）和 User Prompt（用户提示词）的区别，就像理解 <strong>“人设”和“台词”</strong> 的区别一样重要。</p>
<p>在 OpenAI/DeepSeek 的 API 调用中，它们是 messages 列表里两个不同的角色 (role)。</p>
<h3 data-id="heading-4">2.1  一句话总结</h3>
<p>System Prompt (系统提示词)：上帝视角/出厂设置。它定义了 AI “是谁”、“怎么说话”、“必须遵守什么规则”。它是静态的，通常由 <strong>开发者（你）</strong> 写死在代码里。</p>
<p>User Prompt (用户提示词)：具体任务/外界输入。它告诉 AI “现在要做什么”。它是动态的，通常来自最终用户的输入。</p>
<h3 data-id="heading-5">2.2 细节对比</h3>








































<table><thead><tr><th>维度</th><th>System Prompt (系统)</th><th>User Prompt (用户)</th></tr></thead><tbody><tr><td>你的代码位置</td><td>{"role": "system", "content": "..."}</td><td>{"role": "user", "content": "..."}</td></tr><tr><td>比喻 (演员)</td><td>剧本设定：你演一个冷酷的杀手，只说短句。</td><td>对手戏台词：嘿，如果你还没吃饭，要不要一起去？</td></tr><tr><td>比喻 (职场)</td><td>岗位职责书：你是财务专员，必须用 Excel 格式汇报。</td><td>每日邮件：这是今天的发票，请处理一下。</td></tr><tr><td>权重</td><td>高。它像“家规”，AI 会优先遵守它的约束。</td><td>中。它是具体的指令。</td></tr><tr><td>可见性</td><td>隐形。最终用户（用软件的人）通常看不见它。</td><td>可见。这就是用户自己敲进去的字。</td></tr><tr><td>内容示例</td><td>“你是一个 SQL 专家，只输出代码，不要解释。”</td><td>“帮我写一个查询所有用户的语句。”</td></tr></tbody></table>
<h3 data-id="heading-6">2.3 在 Agent 开发中的特殊用法</h3>
<p>在我们的 AI Agent 开发（特别是结构化输出）中，分工极其明确：</p>
<ul>
<li>System Prompt：负责“立规矩” (The Rules)，比如，我们可以写下如下代码用来构造【系统提示词】：</li>
</ul>
<pre><code class="hljs language-python" lang="python">system_prompt = <span class="hljs-string">f"""
你是一个专业的数据提取助手。
必须严格按照以下 JSON Schema 格式输出 JSON 数据，不要包含任何其他解释性文字：
<span class="hljs-subst">{schema_instruction}</span>
"""</span>
</code></pre>
<ul>
<li>
<p>它的作用：</p>
<ul>
<li>
<p>锁定身份：你不是聊天机器人，你是数据提取机器。</p>
</li>
<li>
<p>强制格式：必须吐出 JSON，禁止废话。</p>
</li>
<li>
<p>注入知识：如果有复杂的业务逻辑（比如“如果设备未提及，必须填 unknown”），都要写在这里。</p>
</li>
</ul>
</li>
<li>
<p>User Prompt：负责“传数据” (The Data)</p>
</li>
</ul>
<pre><code class="hljs language-python" lang="python">user_text = <span class="hljs-string">"我的 iPhone 14 Pro Max 只要一打开这个APP就闪退..."</span>
</code></pre>
<ul>
<li>
<p>它的作用：</p>
<ul>
<li>
<p>这是变量。每次调用 API，System Prompt 几乎不变，但 User Prompt 每次都不一样。</p>
</li>
<li>
<p>它包含需要 AI 处理的“原材料”。</p>
</li>
</ul>
</li>
</ul>
<p><img src="https://pic.zhangshichun.top/pic/20260202172731468.png" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">三、了解核心库：<code>Pydantic</code></h2>
<p>在 Python 的 Agent 开发中，我们几乎不直接写 JSON 字符串，而是使用 Pydantic。</p>
<h3 data-id="heading-8">3.1 什么是 Pydantic？</h3>
<p>它是一个 Python 的数据验证库。 核心能力:</p>
<ul>
<li>数据验证：如果你定义了字段是 int（整数），但数据来了个 "abc"，它会直接报错或尝试修正。</li>
<li>Schema 生成：它可以自动把 Python 代码变成 AI 能读懂的 JSON Schema 描述（这是最关键的！）。</li>
</ul>
<h3 data-id="heading-9">3.2 核心 API 速览</h3>
<p>我们主要用到两个东西：</p>
<ul>
<li>
<p>BaseModel: 一切“模具”的基类。</p>
</li>
<li>
<p>Field: 用来给字段写“说明书”（Description），告诉 AI 这个字段该填什么。</p>
</li>
<li>
<p>model_json_schema: 生成定义的JSON Schema结构。</p>
</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel, Field

<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserInfo</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    name: <span class="hljs-built_in">str</span> = Field(description=<span class="hljs-string">"用户的姓名"</span>)
    age: <span class="hljs-built_in">int</span> = Field(description=<span class="hljs-string">"用户的年龄"</span>)

schema_str = json.dumps(UserInfo.model_json_schema(), ensure_ascii=<span class="hljs-literal">False</span>)
</code></pre>
<h2 data-id="heading-10">四，了解核心库：<code>openai</code></h2>
<p>虽然这个库的名字叫 <code>openai</code>，但在 <code>AI Agent</code> 开发圈子里，它更像是一个 “万能遥控器”。因为 <code>DeepSeek、Moonshot（Kimi）</code>、阿里通义千问等大多数模型厂商，都主动适配了这个库的格式。</p>
<p>掌握了它，你就掌握了 90% 的大模型调用方法。</p>
<h3 data-id="heading-11">4.1 核心概念：Client（客户端）</h3>
<p>使用这个库的第一步，永远是实例化一个 Client。这就好比你拿起电话，准备拨号。</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> openai <span class="hljs-keyword">import</span> OpenAI

<span class="hljs-comment"># 初始化客户端</span>
client = OpenAI(
    <span class="hljs-comment"># 1. api_key: 你的身份通行证</span>
    api_key=<span class="hljs-string">"sk-..."</span>, 
    
    <span class="hljs-comment"># 2. base_url: AI LLM服务器地址</span>
    <span class="hljs-comment"># 如果不填，默认发送给 OpenAI 美国官网</span>
    <span class="hljs-comment"># 如果填了 DeepSeek 的地址，就发送给 DeepSeek</span>
    base_url=<span class="hljs-string">"https://api.deepseek.com"</span> 
)
</code></pre>
<h3 data-id="heading-12">4.2 核心方法：chat.completions.create</h3>
<p>这是 Agent 开发中最常用的方法。它的字面意思是：“基于对话历史，创建一个补全（回复）”。</p>
<ol>
<li>基础代码结构：</li>
</ol>
<pre><code class="hljs language-python" lang="python">response = client.chat.completions.create(
    model=<span class="hljs-string">"deepseek-chat"</span>,           <span class="hljs-comment"># 用哪颗大脑</span>
    messages=[...],                  <span class="hljs-comment"># 对话上下文</span>
    temperature=<span class="hljs-number">0.7</span>,                 <span class="hljs-comment"># 创造力调节</span>
    max_tokens=<span class="hljs-number">1000</span>,                 <span class="hljs-comment"># 字数限制</span>
    response_format={<span class="hljs-string">"type"</span>: <span class="hljs-string">"text"</span>} <span class="hljs-comment"># 输出格式;也可以是 "json_object"</span>
)
</code></pre>
<ol>
<li>参数解析 (Parameters)</li>
</ol>
<ul>
<li>这里列出最重要的几个参数，Agent 开发必用：</li>
</ul>





















































<table><thead><tr><th>参数名</th><th>类型</th><th>说明</th><th>推荐值/备注</th></tr></thead><tbody><tr><td>model</td><td>str</td><td>模型名称。必填。告诉 API 调用哪个模型。</td><td>DeepSeek一般是 deepseek-chat 或 deepseek-coder。</td></tr><tr><td>messages</td><td>list</td><td>对话历史。这是一个列表，里面装满了字典。</td><td>包含 system (设定), user (提问), assistant (AI之前的回复)。</td></tr><tr><td>temperature</td><td>float</td><td>温度（创造力）。控制随机性。</td><td>• 0.0 - 0.3: 严谨、逻辑、代码、数学。<br/>• 0.7 - 1.0: 创作、聊天、头脑风暴。<br/>做 Agent/数据提取时，建议设为 0.0 或 0.1，越低越稳。</td></tr><tr><td>response_format</td><td>dict</td><td>输出格式。指定 {"type": "json_object"} 强制输出 JSON。</td><td>Agent 开发神器。记得 Prompt 里也要提“JSON”。</td></tr><tr><td>max_tokens</td><td>int</td><td>最大输出长度。限制 AI 最多能啰嗦多少字。</td><td>防止 AI 失控一直输出，耗光你的钱。</td></tr><tr><td>stream</td><td>bool</td><td>流式传输。</td><td>如果是 True，AI 会像打字机一样一个字一个字蹦出来。做网页聊天机器人时用 True，做后台数据处理 Agent 时用 False。</td></tr><tr><td>tools</td><td>list</td><td>工具列表。这是 Function Calling 的入口（下节课重点）。告诉 AI 它有哪些函数可以调用。</td><td/></tr></tbody></table>
<h3 data-id="heading-13">4.3 核心对象：messages (对话列表)</h3>
<p>这是大模型的“短期记忆”。你传给它什么，它就记得什么。</p>
<pre><code class="hljs language-python" lang="python">messages = [
    <span class="hljs-comment"># 第一条通常是 System，定基调</span>
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"system"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"你是一个严肃的数学老师。"</span>},
    
    <span class="hljs-comment"># 历史对话（可选）：如果你想让它记得刚才说过的话，要把历史记录手动塞进来</span>
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"1+1等于几？"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"等于2。"</span>},
    
    <span class="hljs-comment"># 当前问题</span>
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"那2+2呢？"</span>}
]
</code></pre>
<p>这里不展开，后面的章节会详细讲述这个字段，它太核心了。</p>
<h3 data-id="heading-14">4.4 核心返回值：Response Object</h3>
<p>当你执行 create 后，返回的 response 不是一个简单的字符串，而是一个复杂的对象结构。</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># 1. 完整的响应对象</span>
<span class="hljs-built_in">print</span>(response) 
<span class="hljs-comment"># 输出: ChatCompletion(id='...', choices=[...], usage=...)</span>

<span class="hljs-comment"># 2. 获取第一个候选项 (choices)</span>
<span class="hljs-comment"># 为什么是列表？因为你可以设置 n=3 让它一次生成 3 个不同版本的回答，但通常我们只看第 0 个。</span>
first_choice = response.choices[<span class="hljs-number">0</span>]

<span class="hljs-comment"># 3. 获取消息体 (message)</span>
message = first_choice.message

<span class="hljs-comment"># 4. 获取核心内容 (content) —— 这才是你要的文字</span>
text = message.content

<span class="hljs-comment"># 5. 获取 Token 消耗 (usage) —— 看看这就花了多少token</span>
tokens = response.usage.total_tokens
</code></pre>
<p>一句话总结用法：</p>
<ol>
<li>配置 Client</li>
<li>准备 Messages</li>
<li>调用 Create</li>
<li>解析 content。</li>
</ol>
<p>这就构成了 Agent 开发的每一次“思考”过程。</p>
<h2 data-id="heading-15">下一步预告</h2>
<p>有了这些知识和思路，接下来，我们就可以非常顺畅地实现一次实战了。</p>
<blockquote>
<p>我用自然语言输入，而AI则可以帮我分析我的意图，格式化内容，并成功入库。</p>
</blockquote>
<p>下节课，让我们来挑战实战。</p>
<p>敬请期待！</p>
<p><img src="https://pic.zhangshichun.top/pic/ScreenShot_2026-01-26_082327_821.png" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI - 通过 Docker 来安装与访问 OpenClaw]]></title>    <link>https://juejin.cn/post/7602162571380228102</link>    <guid>https://juejin.cn/post/7602162571380228102</guid>    <pubDate>2026-02-02T16:16:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602162571380228102" data-draft-id="7599929684021526547" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI - 通过 Docker 来安装与访问 OpenClaw"/> <meta itemprop="keywords" content="AI编程,Docker,Ubuntu"/> <meta itemprop="datePublished" content="2026-02-02T16:16:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LinXunFeng"/> <meta itemprop="url" content="https://juejin.cn/user/1820446984512392"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI - 通过 Docker 来安装与访问 OpenClaw
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1820446984512392/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LinXunFeng
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T16:16:50.000Z" title="Mon Feb 02 2026 16:16:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>欢迎关注微信公众号：<a href="https://link.juejin.cn?target=https%3A%2F%2Fp3-juejin.byteimg.com%2Ftos-cn-i-k3u1fbpfcp%2F31960a996f1f4b0da35d69ab7480f7d6~tplv-k3u1fbpfcp-zoom-1.image" target="_blank" title="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/31960a996f1f4b0da35d69ab7480f7d6~tplv-k3u1fbpfcp-zoom-1.image" ref="nofollow noopener noreferrer">FSA全栈行动</a> 👋</p>
</blockquote>
<h2 data-id="heading-0">一、简介</h2>
<p>这是我在 <code>Mac</code> 上通过 <code>Docker</code> 来安装和配置 <code>OpenClaw</code> 的一份记录，随着文章从上到下一步步做就可以了。</p>
<h2 data-id="heading-1">二、docker</h2>
<h3 data-id="heading-2">拉取 <code>Ubuntu</code> 镜像</h3>
<pre><code class="hljs language-shell" lang="shell">docker pull ubuntu:latest
</code></pre>
<h3 data-id="heading-3">创建容器</h3>
<p>创建容器，并映射 <code>18789</code> 端口</p>
<pre><code class="hljs language-shell" lang="shell">docker run -it -p 18789:18789 --name openclaw ubuntu
</code></pre>
<p>搭配 <code>Docker</code> 容器的分离快捷键，先按 <code>Ctrl+P</code>，再按 <code>Ctrl+Q</code>，使容器从交互式会话中退出，同时保持容器继续在后台运行。</p>
<h3 data-id="heading-4">查看运行中的容器</h3>
<pre><code class="hljs language-shell" lang="shell">docker ps
</code></pre>
<h3 data-id="heading-5">重新连接</h3>
<pre><code class="hljs language-shell" lang="shell">docker attach openclaw
</code></pre>
<h2 data-id="heading-6">三、Ubuntu</h2>
<h3 data-id="heading-7">更新软件源</h3>
<pre><code class="hljs language-shell" lang="shell">apt-get update
</code></pre>
<h3 data-id="heading-8">安装必要的命令</h3>
<pre><code class="hljs language-shell" lang="shell">apt-get install -y curl vim git systemctl
</code></pre>
<h3 data-id="heading-9">安装 <code>Node.js</code></h3>
<p>打开 <a href="https://link.juejin.cn?target=https%3A%2F%2Fnodejs.org%2Fen%2Fdownload" target="_blank" title="https://nodejs.org/en/download" ref="nofollow noopener noreferrer">nodejs.org/en/download</a> ，按网页上提供的命令安装 <code>NodeJS</code></p>
<p>以下是文章发布时的最新安装命令，跟着复制粘贴去执行即可</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">Download and install nvm:</span>
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash
<span class="hljs-meta prompt_">
# </span><span class="bash"><span class="hljs-keyword">in</span> lieu of restarting the shell</span>
\. "$HOME/.nvm/nvm.sh"
<span class="hljs-meta prompt_">
# </span><span class="bash">Download and install Node.js:</span>
nvm install 24
<span class="hljs-meta prompt_">
# </span><span class="bash">Verify the Node.js version:</span>
node -v # Should print "v24.13.0".
<span class="hljs-meta prompt_">
# </span><span class="bash">Verify npm version:</span>
npm -v # Should print "11.6.2".
</code></pre>
<h2 data-id="heading-10">四、OpenClaw</h2>
<h3 data-id="heading-11">安装</h3>
<pre><code class="hljs language-shell" lang="shell">npm install -g openclaw@latest
</code></pre>
<h3 data-id="heading-12">配置</h3>
<pre><code class="hljs language-shell" lang="shell">openclaw onboard --install-daemon
</code></pre>
<p>根据你自身情况进行配置即可，命令可以反复去执行进行配置</p>
<h3 data-id="heading-13">网关</h3>
<p>配置文件位置位于: <code>~/.openclaw/openclaw.json</code></p>
<pre><code class="hljs language-shell" lang="shell">vim ~/.openclaw/openclaw.json
</code></pre>
<p><code>OpenClaw</code> 使用 <code>gateway.bind</code> 配置项控制绑定模式，默认的绑定模式为 <code>loopback</code>，仅 <code>127.0.0.1</code> 可访问。</p>
<p>我们需要在宿主机中访问，则需要修改为 <code>lan</code>，并且将 <code>mode</code> 设置为 <code>local</code>，如:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  gateway<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    mode<span class="hljs-punctuation">:</span> <span class="hljs-string">"local"</span><span class="hljs-punctuation">,</span>
    bind<span class="hljs-punctuation">:</span> <span class="hljs-string">"lan"</span><span class="hljs-punctuation">,</span>
    port<span class="hljs-punctuation">:</span> <span class="hljs-number">18789</span><span class="hljs-punctuation">,</span>
    auth<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> 
      mode<span class="hljs-punctuation">:</span> <span class="hljs-string">"token"</span><span class="hljs-punctuation">,</span> 
      token<span class="hljs-punctuation">:</span> <span class="hljs-string">"your-token"</span> 
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>修改完成后重新网关服务</p>
<pre><code class="hljs language-shell" lang="shell">openclaw gateway restart
</code></pre>
<h3 data-id="heading-14">运行 <code>OpenClaw</code></h3>
<pre><code class="hljs language-shell" lang="shell">openclaw dashboard
</code></pre>
<p>输出如下内容</p>
<pre><code class="hljs language-shell" lang="shell">Dashboard URL: http://127.0.0.1:18789/?token=yourtoken
Copy to clipboard unavailable.
No GUI detected. Open from your computer:
ssh -N -L 18789:127.0.0.1:18789 user@&lt;host&gt;
Then open:
http://localhost:18789/
http://localhost:18789/?token=yourtoken
Docs:
https://docs.openclaw.ai/gateway/remote
https://docs.openclaw.ai/web/control-ui
</code></pre>
<p>在宿主机的浏览器中打开给出网址即可</p>
<pre><code class="hljs language-ini" lang="ini">http://127.0.0.1:18789/?<span class="hljs-attr">token</span>=yourtoken
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fa5290a5b49946b9be590b5a9b05582f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTGluWHVuRmVuZw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770653810&amp;x-signature=RUX92%2F8bIMTXQ4W79R39Y0J7QTs%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-15">五、疑难杂症</h2>
<h3 data-id="heading-16">pairing required</h3>
<p>相关 <code>issue</code> 如下：</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenclaw%2Fopenclaw%2Fissues%2F4531%23issuecomment-3822813844" target="_blank" title="https://github.com/openclaw/openclaw/issues/4531#issuecomment-3822813844" ref="nofollow noopener noreferrer">github.com/openclaw/op…</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenclaw%2Fopenclaw%2Fissues%2F2284%23issuecomment-3801613693" target="_blank" title="https://github.com/openclaw/openclaw/issues/2284#issuecomment-3801613693" ref="nofollow noopener noreferrer">github.com/openclaw/op…</a></li>
</ul>
<p>编辑 <code>~/.openclaw/devices/pending.json</code>，将 <code>silent</code> 设置为 <code>true</code>，然后回到网页刷新一下就好了。</p>
<h3 data-id="heading-17">Install failed (unknown exit): spawn npm ENOENT</h3>
<p>在安装 <code>Skills</code> 时遇到过这个错误提示，原因是 <code>nvm</code> 通过 <code>~/.nvm/current</code> 指向当前激活的版本，但这个链接缺失了。</p>
<p><code>Gateway</code> 的 <code>PATH</code> 包含了 <code>/root/.nvm/current/bin</code>，但因为这个链接不存在，所以找不到 <code>npm</code>。</p>
<p>执行如下命令创建软链</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">根据你自己安装的 node 版本去替换掉 v24.13.0</span>
ln -s /root/.nvm/versions/node/v24.13.0 /root/.nvm/current
</code></pre>
<p>然后重启 <code>gateway</code> 即可</p>
<pre><code class="hljs language-shell" lang="shell">openclaw gateway restart
</code></pre>
<blockquote>
<p>如果文章对您有所帮助, 请不吝点击关注一下我的微信公众号：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fp3-juejin.byteimg.com%2Ftos-cn-i-k3u1fbpfcp%2F31960a996f1f4b0da35d69ab7480f7d6~tplv-k3u1fbpfcp-zoom-1.image" title="https://link.juejin.cn/?target=https%3A%2F%2Fp3-juejin.byteimg.com%2Ftos-cn-i-k3u1fbpfcp%2F31960a996f1f4b0da35d69ab7480f7d6~tplv-k3u1fbpfcp-zoom-1.image" target="_blank">FSA全栈行动</a>, 这将是对我最大的激励. 公众号不仅有 <code>iOS</code> 技术，还有 <code>Android</code>，<code>Flutter</code>，<code>Python</code> 等文章, 可能有你想要了解的技能知识点哦~</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[终于有国产模型能对标Gemini 3 Pro了！Kimi K2.5 强得不像开源模型]]></title>    <link>https://juejin.cn/post/7602162571380113414</link>    <guid>https://juejin.cn/post/7602162571380113414</guid>    <pubDate>2026-02-02T15:33:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602162571380113414" data-draft-id="7602162571380097030" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="终于有国产模型能对标Gemini 3 Pro了！Kimi K2.5 强得不像开源模型"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-02-02T15:33:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="苍何"/> <meta itemprop="url" content="https://juejin.cn/user/588993963763405"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            终于有国产模型能对标Gemini 3 Pro了！Kimi K2.5 强得不像开源模型
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993963763405/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    苍何
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T15:33:40.000Z" title="Mon Feb 02 2026 15:33:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>这是苍何的第 475 篇原创！</p>
<p>大家好，我是苍何。</p>
<p>今天，Kimi 带着他的最强模型 K2.5 强势来袭，我也第一时间做了测试，给大家带来一波分享。</p>
<p>这次，K2.5 是一个全能型的统一模型，最大的特点就是视觉、编程、Agent一口气全包。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6cd466a87b9645a49561974be2d72c62~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=f%2FcRkg%2BbJFYkg%2FLpQzpZL1EHTTo%3D" alt="图片" loading="lazy"/></p>
<p>先来一个省流版预览，K2.5 模型能力提升如下：</p>
<ul>
<li>
<p><strong>支持多模态理解</strong>：Kimi 终于补全了多模态的空白，而且一次性支持图片+视频理解。</p>
</li>
<li>
<p>****思考模式切换：同时支持推理和非推理。</p>
<hr/>
</li>
</ul>
<hr/>
<hr/>
<ul>
<li><strong><strong>前端审美设计能力：个人感觉可以和 Gemini 3 Pro 一战了。</strong></strong></li>
</ul>
<hr/>
<hr/>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1e9dea2665a94be6a0f486c3b80e1fc0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=jGErvYIqBCAq1U8Miw6wn328%2B9k%3D" alt="图片" loading="lazy"/></p>
<p>基于 K2.5，Kimi 一口气放出了 4 个产品：</p>
<p>1、开源的 Claude Code——Kimi code：全面支持 Skills，Benchmark 分数高，无需 MCP 即可支持视频输入。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1abdad00dd2a4b8c86feeddba890700d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=qScHSnES61vuLF0NcI8iuxnow9s%3D" alt="图片" loading="lazy"/></p>
<p>2、Visual Coding：能看图或视频复刻网页，还能做视觉调整，并能一键部署。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f8a867cd32204d8fa8d95ca63ec52a97~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=c%2BptbIGwC2ZlArYtmlhQTLDVYSM%3D" alt="图片" loading="lazy"/></p>
<p>3、Agent 集群：智能体军团，可根据任务创建多达 100 个 Agent 分身，并自主分工协作。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/39019cb1e8934535a4bc87d9ed22f6ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=x9wGlAko2T3LKMw6P%2FP4UoRZdZQ%3D" alt="图片" loading="lazy"/></p>
<p>4、Office Agent：PPT、Word、Excel 审美和设计能力全面提升。</p>
<p>整体测试下来最大的感受是 K2.5 的 coding 能力提升比较明显，特别是前端审美能力，在一些 case 上甚至还超过 Gemini 3 Pro。</p>
<p>比如，这个是我用 K2.5 一句话复刻的 X 首页：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f48d08d9f5324bf68bc21d7f04314b84~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=yhDs9WTCGKNoolEKwK6QAa%2B2DU0%3D" alt="图片" loading="lazy"/></p>
<p>相对比之下，这是我当时同样的提示词用 Gemini 3 复刻的 X 页面：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/195c6db18f5649f2a39af81279847ce2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=1U2CJMBp5IPrtlGWKiCuF8cWmHE%3D" alt="图片" loading="lazy"/></p>
<p>可以看到 K2.5 除了复刻页面的每一个元素，甚至连页面中的图片都复刻了，而不是用占位符替代。</p>
<p>我又让它复刻小红书首页，也做的很好。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc1c718eebbc4438b3263dd513cfaa54~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=Tj%2FHaxftKnWFKh4DcD13z93e2%2FQ%3D" alt="图片" loading="lazy"/></p>
<p>因为 K2.5 能理解视频，我又上传了一个点击交互的视频，K2.5 能理解视频中的交互，并像人一样能看清每一个交互后的页面，然后复刻。这是我复刻的带有交互的 B 站首页。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/707fd17de3d8450b9e43c5a092a120b5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=ZjQlnzUY8lVPdhZu63JUVFHQhzo%3D" alt="图片" loading="lazy"/></p>
<p>我还测试了个 APP 复刻的场景，直接录制了一段操作即刻的视频，然后丢给 K2.5，输入提示词：</p>
<blockquote>
<p>复刻视频中的 APP 页面，包括交互，保证 APP 页面可用。</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6581da344f3e44d5946992a1e1f0253b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=IlhoNONHowlAurz5pBJ5qqvuKbo%3D" alt="图片" loading="lazy"/></p>
<p>可以看到，复刻的挺不错，视频中的交互，K2.5 理解后并输出成了页面，而且效果相当好🐂🍺，这或许就是 Visual Coding 的魅力所在吧。</p>
<p>然后我又做了个带有手势交互的小游戏，需要唤起摄像头并理解我的手势，来模拟粒子炸开的效果。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4a5e88a0dc77438fa359dcdcd1b09f99~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=wy%2BclsQ%2B%2Fzbmu97aNWSyuolEyVU%3D" alt="wxv_4358225049204555777" loading="lazy"/></p>
<p>K2.5 一次就完成了这个效果，效果相当棒，而且代码开发的速度非常快。</p>
<p>我记得当时 Gemini 3 我做过一个做 macos 操作系统的 case，当时挺震撼的，于是我输入同样的提示词给 K2.5。</p>
<p>同样一次，就出来了这样一个，很不错的效果。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a2efc7b93eee40b0ac8c3d6401c97c9e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=PRacnI6FtXsas%2Bu3d5MhwSn0skE%3D" alt="wxv_4358224473460686849" loading="lazy"/></p>
<p>真牛逼，而且整个一次性生成，就简简单单一个提示词，整个的 macos 风格的感觉就都出来了。</p>
<p>硅谷闭源模型不再等于性能的天花板，Kimi K2.5提供了更具性价比的选择。</p>
<p>为了继续捶打，我又做了个实验，把架构图传过去，希望生成可编辑的版本，K2.5 同样完成的非常出色。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/85d7a09180654a98be27e2d058685d7a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=EbKNJFTr9c%2Bt9jLTmnBsaN5Q3oQ%3D" alt="图片" loading="lazy"/></p>
<p>然后我对 Agent Swarm 模式进行了测试，说的简单点，这是个 Agent 的军团，能创建无数个分身来帮扶完成复杂的任务。</p>
<p>我输入这样一大串提示词：</p>
<pre><code class="hljs">请模拟 5 位风格极度反差的知名艺术家或视觉流派，为当代「打工人」设计 5 个系列、每个系列 10 张的微信表情包。
主题是「职场求生记」，我希望看到的不仅是风格不同，
更是对职场情绪的不同维度的解读，比如愤怒、焦虑、躺平、假笑和疯狂
</code></pre>
<p>可以看到它开始并行调用 5 个 Agent 来帮我生成不同艺术风格的表情包。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d08941e273c49d6810e8093c5cdf400~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=mui%2Fw8SGasj8ERWxDNgkVFe9U4o%3D" alt="图片" loading="lazy"/></p>
<p>表情包图片生成的远比我想象中的快，有智能体军团并行的效率太高了。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d96309a7ec7f4badaffa605968ed3f3b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=Bzq9Xsfk4RdXpnPhTYKeJlHA52I%3D" alt="图片" loading="lazy"/></p>
<p>这些生成的表情包图片有些确实符合打工人的不同情绪了。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b346d2c310224319865d42cb28ccf765~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=L030%2BzUNo0mDYymms%2FY5evewTEE%3D" alt="图片" loading="lazy"/></p>
<p>最后我针对 Kimi code 进行了测试，这就更有意思了，在 cli 中 input 图片变得如此丝滑，好像还是第一次。</p>
<p>比如我直接把这张图丢到 cli 终端中，让 K2.5 做下理解。这个是原图：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f5f533d50f44e8aa6a3a342c9a2fcc1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=Bs0wXFWd1Dv5V%2FKd0OtaNfIWXp8%3D" alt="图片" loading="lazy"/></p>
<p>可以看到把图片拖到 Kimi Code 后，自动带出路径：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e5e17160994d46b2a6aab547ea5e4e53~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=77%2BOzr7N3PtllJBKX4mwckwFTpk%3D" alt="图片" loading="lazy"/></p>
<p>Kimi Code 先是调用 ReadMediaFile 这个读取图片和视频文件的 agent 来理解图片。</p>
<p>我看了下官方文档说明，这个 agent 最多能读取 100MB 大小的文件。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3aa4b41e0ee143a2aa30ef1df241ecef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=9F5gAICy%2BSfgtMcOy34RmUfYItA%3D" alt="图片" loading="lazy"/></p>
<p>之后就给我一份详细的解释，效果不错，整个流程，我都没有调用外部的任何工具，模型自身就具备理解能力，这太舒服了啊。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e31de042f0b3474bbe97918036847f27~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=N%2FlJvbp6jPgcUgA8JyDmZv7K98A%3D" alt="图片" loading="lazy"/></p>
<p>同样将视频直接丢给 kimi code，也完全能理解。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fab4af48d881419f91787864a2516ab4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=taPhy%2BJT8r1Lwd3nMGs3I1U4cIs%3D" alt="图片" loading="lazy"/></p>
<p>然后我利用 remotion-best-practices 这个 skills 以及配音 skills，将刚才的视频做一下翻译配音。</p>
<p>这里 skills 有一个分层加载机制，并且会按照以下优先级加载。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7841ec4b4a24406d8539a5135d9fd546~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=bV5u9uzyI7Zuljj1LojLM2jbDxk%3D" alt="图片" loading="lazy"/></p>
<p>其中 Kimi CLI 内置了 2 个 Skills：</p>
<ul>
<li><strong>kimi-cli-help</strong>：Kimi CLI 帮助。解答关于 Kimi CLI 安装、配置、斜杠命令、键盘快捷键、MCP 集成、供应商、环境变量等问题。</li>
<li><strong>skill-creator</strong>：Skill 创建指南。当你需要创建新的 Skill（或更新现有 Skill）来扩展 Kimi 的能力时，可以使用此 Skill 获取详细的创建指导和最佳实践。</li>
</ul>
<p>最终就出来一个做了中文配音的数字人混剪视频了，效果还是非常 nice 的。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/885bff4aa3dd4b799357bf3d9ecf493c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=P5I7Uz4RYgCBrB1fURo%2BVOs36a4%3D" alt="wxv_4358223680603160582" loading="lazy"/></p>
<p>写到这里，虽然测的有点累了，不过人还是相当的兴奋，就像当初熬夜测 Gemini 3 一样。</p>
<p>其实一开始 kimi 的 k2 模型在代码能力上已经表现的相当不错，还跑通了 obsidian 工作流。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cd335019426c4977bf2fbb84aaf6b343~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651219&amp;x-signature=RTYuEC%2Bbrq6%2F0hO6Hyoq7zivsJM%3D" alt="图片" loading="lazy"/></p>
<p>这次 k2.5 的表现让人更加振奋，是那种肉眼可见的进步和爽感。</p>
<p>前端审美以及对图片视频的理解能力有了很大提升，特别是在 kimi code 中可以丝滑的不借助外力就可以理解图片和视频还是非常舒服的。</p>
<p>整体测试下来，k2.5 给我带来了不少的惊喜，接下来我也会尝试用它来进行工程化的实践。</p>
<p>也欢迎持续关注苍何，你将获得最新的关于 AI 大模型的一手真实评测。</p>
<p>好啦，感谢你喜欢我的文章，我们下一期见。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Clawdbot一夜爆火，GitHub已狂飙 64k Star！附最新部署使用教程]]></title>    <link>https://juejin.cn/post/7602133814144958483</link>    <guid>https://juejin.cn/post/7602133814144958483</guid>    <pubDate>2026-02-02T15:37:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602133814144958483" data-draft-id="7602133814144942099" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Clawdbot一夜爆火，GitHub已狂飙 64k Star！附最新部署使用教程"/> <meta itemprop="keywords" content="人工智能"/> <meta itemprop="datePublished" content="2026-02-02T15:37:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="苍何"/> <meta itemprop="url" content="https://juejin.cn/user/588993963763405"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Clawdbot一夜爆火，GitHub已狂飙 64k Star！附最新部署使用教程
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993963763405/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    苍何
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T15:37:27.000Z" title="Mon Feb 02 2026 15:37:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读10分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>这是苍何的第 477 篇原创！</p>
<p>大家好，我是苍何。</p>
<p>这两天 Clawdbot 火出来天际，我的 X 时间线上全部都是这玩意。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/77ec056a305848c2b774bfb0e0912a0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=ne5G7XIMVRC7%2BDsVFGg9KvPvH3s%3D" alt="图片" loading="lazy"/></p>
<p>这是一个 AI 开源项目，主打的是 AI 私人助理，他能自行处理你电脑里面的任何需求，能帮你整理文件，能为你回复消息，能帮你写周报，写文章，甚至还能帮你购物。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b4d5910f653a4978b34438b0c7028617~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=DnFvlJjp6M1OQ2daznGqnnc7FJw%3D" alt="图片" loading="lazy"/></p>
<p>开源地址如下：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmoltbot%2Fmoltbot" target="_blank" title="https://github.com/moltbot/moltbot" ref="nofollow noopener noreferrer">github.com/moltbot/mol…</a></p>
<p>截止当下，已狂飙 64 k Star，而这个增长实际只花了几天时间。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/920ebe02e7fc411fab1eb0510373c687~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=QFGLxCBBkzanc9lEGORfVIb6Py8%3D" alt="图片" loading="lazy"/></p>
<p>可笑的是，原本 Clawdbot 作者为了致敬 Claude 而取了这个名字，现在却被 Anthropic 要求改名，现在 Clawdbot正式改名为Moltbot。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e1fb2a71e6345c2883a156f18eeaf02~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=roMwPU8mtVlHWBgWWP94yPEDW%2FU%3D" alt="图片" loading="lazy"/></p>
<p>他和传统的通用 Agent 不同，这是一个本地的完全开源的 Agent，他完全运行在你自己的电脑上。</p>
<p>而且还可以远程指挥，做到 7* 24 小时为你工作。而且记忆永久保存在本地，理论上拥有永久的记忆能力。</p>
<p>比如，我远程操控 Clawdbot 帮我搜索关于他自己的资料及教程案例，他很好的就帮我完成了任务，并直接给我结果。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e388360e34b74181876ca135688eaa92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=PTWPZaeueYTeeSWE7eIL8m4kajk%3D" alt="wxv_4361271482475872257" loading="lazy"/></p>
<p>然后我用手机也能操控他帮我把这个结果保存在电脑上的指定文件夹。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/273002d6466b4363b09c7b4713d664d8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=pSBPzmsybN6pGmK3EfsMie9cnY4%3D" alt="wxv_4361270750318166017" loading="lazy"/></p>
<p>他可以很出色的完成任务，真的🐂🍺，而且这个过程他完全是在我自己的服务器电脑上执行的。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b76df6a827f94c75aa58a690fe4983b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=7CfviI4lSmZZzOkr68VuOsGCnyI%3D" alt="图片" loading="lazy"/></p>
<p>其实能操控 Clawdbot 的平台还非常多，国外的你能想到的几乎都可以，国内也很快支持飞书、企微等。</p>
<p>Clawdbot 的爆火绝非偶然，AI Agent 发展至今，我们都太急切需要一个属于我们自己的 AI 助理，他能全天帮我们干活，不知疲倦的为我们打工。</p>
<p>但是 Clawdbot 能操控电脑权限太高了，现在体验的话要么整个不用的电脑，要么就整个便宜的云服务器玩。</p>
<p>光这一点，就把 Mac Mini 给卖爆了。</p>
<p>这个东西部署也没那么简单，特别是涉及到自定义 API，以及不同的平台设置，对非开发者还不是很友好。</p>
<p>所以，也就有了这一篇教程，可以自信的说，这篇文章主打最新最全，包含部署、配置、自定义 API 设置、使用等。</p>
<blockquote>
<p>文章会显得有些长，熬夜写到了凌晨 5 点，如果对你有帮助，感谢你的点赞转发支持。</p>
</blockquote>
<p>废话不多说，直接进入教程。</p>
<h2 data-id="heading-0">准备服务器</h2>
<p>目前用云服务是性价比最优的方式，买个电脑好几千，一台云服务器先租个一个也也才二三十。</p>
<p>选个 2  核 2 G 就差不多了，像阿里云/腾讯云或者任意 VPS 都可以支持。</p>
<p>我为了图省事，用的腾讯云新出的 Lighthouse，免去安装环境和依赖，直接就有 Clawdbot 模板。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/064035a2dcd548fdac13ed33fa334770~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=ghu3pawe5M2ftvPJ3rXN%2BCiFj2Y%3D" alt="图片" loading="lazy"/></p>
<p>地区选择硅谷，选择最便宜的套餐。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/881a0f3c670c4b699f22bc5398fcdef5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=e6spmZALyYpQipGSJmM09anL538%3D" alt="图片" loading="lazy"/></p>
<blockquote>
<p>你可以选择关闭自动续费。</p>
</blockquote>
<p>在站内信中找到服务器 IP、用户名、密码，然后用 SSH 客户端连接服务器，我这里用的是 Xterminal。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57111a92d860494e9cf860c2beb2bf41~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=y1WEm1vZyWcX0dSLQ%2Fuk4N5McpE%3D" alt="图片" loading="lazy"/></p>
<p>没有 SSH 客户端也可以直接点击页面这里的登录进去。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9c1148eef5b46eb8f1ad5c9ecdc09b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=XdNg70RFJ9yWXxtU6r27qSCbcik%3D" alt="图片" loading="lazy"/></p>
<h2 data-id="heading-1">一键安装</h2>
<p>因为这里是内置了应用模板，理论上就是不用再重新安装 Clawdbot 了，当然如果你不是通过应用模板的方式，也可以自行执行以下指令：</p>
<pre><code class="hljs language-arduino" lang="arduino">curl -fsSL https:<span class="hljs-comment">//clawd.bot/install.sh | bash </span>
</code></pre>
<p>这里我用了应用模板就不需要再安装了，他已经装好了环境和依赖。</p>
<p>安装好之后输入如下命令查看 Clawdbot 版本：</p>
<pre><code class="hljs language-css" lang="css">clawdbot <span class="hljs-attr">--version</span> 
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ded002dbb7614213a49176e47d67a93a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=sG3P%2B9lK%2FFiyd7tfyLTEV%2BhWmOE%3D" alt="图片" loading="lazy"/></p>
<p>安装好后，下一步就可以直接进入配置环节。需要配置模型和 Bot。</p>
<blockquote>
<p>Bot 就是可以操控 Clawdbot 的端侧，比如 telegram 发消息操控 Clawdbot 远程工作。</p>
</blockquote>
<p>配置模型和 Bot一共需要准备以下 2 个东西：API key、Bot token，下面详细说一说。</p>
<h2 data-id="heading-2">配置模型</h2>
<p>Clawdbot 支持非常多的 API 模型，比如 OpenAI、Anthropic、kimi、GLM 都是内置支持的。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3ff4adfac4ac46008131688e1346083f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=YNW%2BRFSsHbXXChvgLWtZVCZUB8o%3D" alt="图片" loading="lazy"/></p>
<p>当然除了内置的，还支持自定义 API，这里充分考虑灵活性，我用的自定义 API 的方式，模型选择性也多和更灵活一些。</p>
<p>如果你希望稳定，性价比高的 API 平台，可以试试之前给大家推荐过的 Atlas Cloud。</p>
<p>地址：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.atlascloud.ai%3Fref%3DAXZ9S7" target="_blank" title="https://www.atlascloud.ai?ref=AXZ9S7" ref="nofollow noopener noreferrer">www.atlascloud.ai?ref=AXZ9S7</a></p>
<p>毕竟它主打的是企业级 API 聚合，拥有 300+ 知名大模型，**** Qwen、DeepSeek、Kimi、MiniMax等知名大模型一网打尽。总结下来是：<strong>稳定、易用、低价。</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e1a258027c2048c3a438a7604d018ef2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=IYVk%2BI2CeX%2B8KMA%2BLXHrpmmPSyg%3D" alt="图片" loading="lazy"/></p>
<p>那该如何使用呢？注册登录后，打开控制台，新建 API 密钥。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b3b21b37f19743edb09a62a53138f9bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=W6NgZ%2FBvP4Nf%2FTHWhMtWS1CT43A%3D" alt="图片" loading="lazy"/></p>
<p>多说一嘴，Atlas Cloud 目前注册绑卡即可白嫖 1 美元使用额度，用我的邀请码注册首充还能送 25% bonus。可以先免费白嫖起🐶。</p>
<p>填写名称后，点击创建：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1a15eaa28e749ccab2f6eb4f2074f63~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=tZrXjrTP6mIBrrTgHpQUmUuNbJ0%3D" alt="图片" loading="lazy"/></p>
<p>然后点击复制这个 API：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9f4137b057b140c4abb449a6b371ac06~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=sL%2BvbV%2BF2oHBc4Ip5rzEBG4FaUA%3D" alt="图片" loading="lazy"/></p>
<p>这个 API Key 在第四步的时候需要填入的参数：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"baseUrl"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://api.atlascloud.ai/v1"</span><span class="hljs-punctuation">,</span>
<span class="hljs-attr">"apiKey"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"这里填入 API Key "</span><span class="hljs-punctuation">,</span>
</code></pre>
<h2 data-id="heading-3">配置 Bot</h2>
<p>这个实际配置的是和 Clawdbot 进行交互的软件，支持挺多国外软件的，比如 Telegram、Discord 等。</p>
<blockquote>
<p>国内的企微、飞书或者微信，我估计也会很快支持了，毕竟开源生态发展太快了。</p>
</blockquote>
<p>这里以 Discord 为例（我使用的多一些）。</p>
<p>1、前往 Discord Developer Portal &gt; Application &gt; New Application</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/756a0ec155864f82927b7746fe99d7c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=%2FrHIx4Ff4RMrSif0QLaktbrZqSk%3D" alt="图片" loading="lazy"/></p>
<p>2、创建好应用后，选择 Bot&gt; Reset Token &gt; copy token</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40b4c9c9151549a4b9fe93b41ba0a24d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=g75GjEda%2FRA7zg9kNkypmtUzaGw%3D" alt="图片" loading="lazy"/></p>
<p>3、打开 Message Content Intent的选项并保存</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6b3d97a52c3469383d596a5ba9d06a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=3vl5cA7R1Ii4WjDyccwz3McDgV4%3D" alt="图片" loading="lazy"/></p>
<p>4、OAuth2 页面配置</p>
<p>在 OAuth2 URL Generator中选择 bot</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a51f8564b08549fb954d72e444f44bd0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=4fmqvn1hXBwAoz%2Bmpus3u948yhM%3D" alt="图片" loading="lazy"/></p>
<p>在 Bot Permissions 中勾选 Send Messages 和 Read Message History。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f815c16931834cdb9c18d611b8aaa4d4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=PnhIu7mmMMOuoZAi75zVxYZRJE4%3D" alt="图片" loading="lazy"/></p>
<p>同样这个页面往下滑，复制 bot 邀请链接。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/054454c776e147538bf3f2f0aa11c2f2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=V%2BJeJohah%2FU4mcVBd6n992xu7KA%3D" alt="图片" loading="lazy"/></p>
<p>在浏览器中打开这个链接，然后选择一个自己的服务器，相当于把机器人 bot 加入到 server 中。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c47b334b2291446b9840fda0afa1824b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=nTEKgbwWlL22oGaSDH7KLm9H92A%3D" alt="图片" loading="lazy"/></p>
<p>这时候确认下刚才我们给 bot 的 2 个权限。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7283d1f6fc2b44f1babd885e5e266957~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=xWw4Wi8MTkGjAEx5%2BP2LFXwoabY%3D" alt="图片" loading="lazy"/></p>
<p>打开 Discord，然后输入框中@就可以看到刚才添加的机器人 bot。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c33846b0cd284f39a1f4ff414a876515~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=rHUvXDuNPbnfJG0lxP%2BuEAI6hB4%3D" alt="图片" loading="lazy"/></p>
<h2 data-id="heading-4">Clawdbot配置</h2>
<p>先在服务器执行以下命令，直接修改Clawdbot 配置，如果需要自定义 API，需要自行按照如下配置修改。</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"models"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"providers"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"xxx"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"baseUrl"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://api.atlascloud.ai这里填你自己 API  base的地址"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"apiKey"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"在这里粘贴你的API Key"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"api"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"anthropic-messages"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"models"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
                    <span class="hljs-punctuation">{</span>
                        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"claude-opus-4-5-20251101"</span><span class="hljs-punctuation">,</span>
                        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Claude Opus 4.5"</span><span class="hljs-punctuation">,</span>
                        <span class="hljs-attr">"reasoning"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
                        <span class="hljs-attr">"input"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
                            <span class="hljs-string">"text"</span><span class="hljs-punctuation">,</span>
                            <span class="hljs-string">"image"</span>
                        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
                        <span class="hljs-attr">"contextWindow"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">200000</span><span class="hljs-punctuation">,</span>
                        <span class="hljs-attr">"maxTokens"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4096</span>
                    <span class="hljs-punctuation">}</span>
                <span class="hljs-punctuation">]</span>
            <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"channels"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"telegram"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"botToken"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"在这里粘贴你的Bot Token"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"profiles"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
                <span class="hljs-string">"default"</span>
            <span class="hljs-punctuation">]</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"agents"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"defaults"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"primary"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"xxxx/claude-opus-4-5-20251101"</span>
            <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>当然如果不需要自定义 API，也可以用自带的就可以直接在页面中操作，需要提前准备好对应官方的 API。</p>
<p>如果没用云服务模板自己安装的话，安装好后会弹窗让配置，选择 QuickStart。</p>
<p>如果是用的腾讯云的模板，就输入如下命令进入配置：</p>
<pre><code class="hljs">clawdbot onboard 
</code></pre>
<p>接下来配置的操作直接使用键盘来操作，这里先选择 yes 知晓风险。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe584c7df9d44e048fd1f6d7461577c1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=CIARA4y9%2FUYB6hTPz1z3EnEaK1U%3D" alt="图片" loading="lazy"/></p>
<p>然后选择默认的 QuickStart。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d90c4923cec4be7a8afce87a9103b5d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=ZwBr3hx28nQlWWIKglPio1y7EWU%3D" alt="图片" loading="lazy"/></p>
<p>接着是选择模型供应商的配置，如果上一步已经配置了第三方 API 就不用再配了</p>
<p>也可以选择自带的 API：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02bd4b578c64472b9803a7cad05c2f2d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=bm4xy2yR%2FlFNsdDU7czyLajVkhY%3D" alt="图片" loading="lazy"/></p>
<p>比如选 GLM 4.7, 输入 key，只需要选择默认模型就好了。</p>
<p>接下来是选择 channel，这里选择 Discord</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ccda095ec1d84cffb1cd9b1c4613a0b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=zMg2cICBHDUpaMDiYNb8CgZT%2F64%3D" alt="图片" loading="lazy"/></p>
<p>还挺贴心的，把如何获取 token 也做了说明。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/68d713409d8d48459b9f1ec54339dfca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=OTf87WXT2bUZ%2Bi3okzfcXWgz7qA%3D" alt="图片" loading="lazy"/></p>
<p>把之前我们创建的 bot 的 token 复制进来。</p>
<p>然后页面按照这个做选择：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a0a83074eab843969161b150d8b2872c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=3ikZtvvI%2FGLqLvs1YfPkk6TJloU%3D" alt="图片" loading="lazy"/></p>
<p>这里可以自定义安装很多依赖，可以先不装。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d66e31f96f94302aa219713f747183b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=aEdZVvMpDJsICrG75%2BCFuhKPJ0k%3D" alt="图片" loading="lazy"/></p>
<p>这些 key 也可以先不配置：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/53f6baf117234b598b4f4cfe1cc257f4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=7cZE7NrD7DymgDczyILHHy72VAw%3D" alt="图片" loading="lazy"/></p>
<p>注意 Enable hooks 的选项选择 session-memory：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a9931bfeba874bb0ae94b8db2986f6f7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=JQqXt%2F39DHLCFFznsSoOzLANqkY%3D" alt="图片" loading="lazy"/></p>
<p>接下来你就可以在服务器中和 Clawdbot 对话了：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65ca60ef0af24f119cbcf55f50ed9dfc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=3ahC7FezDIHgS1X9YRTj2gf5Ucs%3D" alt="图片" loading="lazy"/></p>
<p>但这并没结束，因为我们要通过 discord 来指挥 Clawdbot。</p>
<p>先退出 Clawdbot，然后在服务器停止服务：</p>
<pre><code class="hljs language-arduino" lang="arduino">systemctl --user stop clawdbot-gateway.service 
</code></pre>
<p>然后重新启动：</p>
<pre><code class="hljs language-css" lang="css">clawdbot gateway <span class="hljs-attr">--port</span> <span class="hljs-number">18789</span> <span class="hljs-attr">--verbose</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9919b833144c45bbb9a3efac47bd88e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=x9G9UiJA0Y8UAkTRFZ5QLBm1K%2BM%3D" alt="图片" loading="lazy"/></p>
<p>启动成功后，返回 Discord，与 bot 进行对话后拿到配对码。</p>
<blockquote>
<p>是点击 bot 进行私聊，而不是@聊天。</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4fc6fdf0ec7346a38914412cb559c9b2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=4ngmrf1Kc4YOopazHlAEPn2TD0c%3D" alt="图片" loading="lazy"/><br/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a7845ada91364ae6a156077350c9a4fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=oRdoPMoxeaneXf6z4Z1L2vjzYrQ%3D" alt="图片" loading="lazy"/></p>
<p>紧接着返回服务器命令行，你需要按下Ctrl+C（Windows）或者Command+C（MacOS）终止 Gateway 服务。</p>
<p>然后粘贴并运行如下命令进行配对，把 Pairing code 替换为上面的“Pairing code”后面的内容。</p>
<pre><code class="hljs language-css" lang="css">clawdbot pairing approve discord &lt;Pairing <span class="hljs-selector-tag">code</span>&gt;
</code></pre>
<p>然后再次启动 Gateway</p>
<pre><code class="hljs language-css" lang="css">clawdbot gateway <span class="hljs-attr">--port</span> <span class="hljs-number">18789</span> <span class="hljs-attr">--verbose</span>
</code></pre>
<p>如果你想要让它在服务器中静默启动，而不是关闭终端就停止服务了，你可以输入以下命令：</p>
<pre><code class="hljs language-javascript" lang="javascript">nohup clawdbot gateway --port <span class="hljs-number">18789</span> --verbose &gt; <span class="hljs-regexp">/dev/</span><span class="hljs-literal">null</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> &amp;
</code></pre>
<p>在 discord 中@机器人，可以看到有回复了：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ae7714121f0e402695ef0a98e1ef3278~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=PFUwRBN%2FLQc2ntanXr%2F%2BDSHKPtE%3D" alt="图片" loading="lazy"/></p>
<p>然后服务器也能看到有回复了：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/199731ae9bc84d9792a097aac4f58cf3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=6Itw5C6dGP1%2BopEBQ9AXxf6R2sk%3D" alt="图片" loading="lazy"/></p>
<p>自此，Clawdbot 就完成了安装和配置，以及能通过在 discord 中和 bot 对话的方式操控服务器上的 Clawdbot。</p>
<h2 data-id="heading-5">使用 Clawdbot</h2>
<p>配置好后就可以直接在 discord 中@bot 的方式来远程指挥 Clawdbot 干活。</p>
<p>直接来一个问题：</p>
<pre><code class="hljs">我搜集整理一下最新的关于Clawdbot 的信息，告诉我该怎么配置和使用，并
给我在 GitHub 或者 X 上找出 10 个最佳实践。
</code></pre>
<p>我录了一个视频，大家可以感受一下，非常刺激：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cf3c6c89f01f4c98b1813a81e243b3cd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=UNGX1DTjc18IR8owSWeLja2jGQw%3D" alt="wxv_4361271482475872257" loading="lazy"/></p>
<p>可以看到 Clawdbot 会自行去搜索，并且给到我想要的信息，最牛 X 的是，这家伙居然给我推荐了相关的 discord 社区，我靠，真贴心。</p>
<p>然后我又直接在手机上，让 Clawdbot 帮我把刚刚找到的结果保存在电脑指定的文件夹，我的要求如下：</p>
<pre><code class="hljs">你把刚刚生成的信息保存成markdown文档，放在我的电脑claw文件夹下，
你需要新建这个文件夹 
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f81c581e7084bf5b100d8a21c0c5049~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=qK4FgxV32F8kdGaWFuapbvaD8k4%3D" alt="wxv_4361270750318166017" loading="lazy"/></p>
<p>我喝了几口水的功夫，Clawdbot 就已经帮我把事情做好了。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/32a1d304efd24b34b6c5655912ee13b3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770651451&amp;x-signature=LI9zAEOk5hL%2FPZ2vufsJcbcxojk%3D" alt="图片" loading="lazy"/></p>
<p>这也太爽了，他真的能做，这种远程指挥的感觉，太让人兴奋了。</p>
<h2 data-id="heading-6">Clawdbot 优缺点</h2>
<p>Clawdbot 也并非完美无瑕，优缺点，我自己也做了个总结：</p>
<p>1、 Clawdbot 优点</p>
<ul>
<li><strong>本地优先，数据隐私安全</strong> — 所有数据运行在你自己的设备上，无需担心第三方访问或数据泄露</li>
<li><strong>多平台支持</strong> — 支持 WhatsApp、Telegram、Discord、Slack、Google Chat、Signal、iMessage 等十余个通讯平台，一个助手打通所有渠道</li>
<li><strong>高度可定制</strong> — 支持多种 AI 模型（Anthropic、OpenAI），可通过技能系统扩展功能，配置灵活</li>
<li><strong>功能丰富强大</strong> — 内置浏览器自动化、Cron 定时任务、设备节点控制、Canvas 画布等高级工具</li>
</ul>
<p>2、Clawdbot 缺点</p>
<ul>
<li><strong>技术门槛较高</strong> — 需要 Node.js 环境、配置文件编辑、命令行操作，对非技术用户不够友好</li>
<li><strong>需要自行承担成本</strong> — AI 模型的 API 调用费用和订阅费用需用户自己承担，长期使用成本较高</li>
<li><strong>需维护服务器</strong> — Gateway 守护进程需要持续运行，用户需要自己管理和维护服务器或本地机器</li>
<li><strong>安全风险</strong> — 权限太高，大家都不敢在主电脑上玩</li>
</ul>
<h2 data-id="heading-7">写在最后</h2>
<p>说实话，Clawdbot 并不完美。</p>
<p>门槛高，还费钱。</p>
<p>但它代表了一种未来。</p>
<p>一种 AI 真正属于你的未来。</p>
<p>不再是冷冰冰的网页框。</p>
<p>而是实实在在的私人助理。</p>
<p>它住你的电脑里。</p>
<p>只听你一个人的话。</p>
<p>帮干活，帮省心。</p>
<p>这才是我们想要的 AI，对吧？</p>
<p>虽然现在它还很稚嫩。</p>
<p>但未来已来，值得一试。</p>
<p>折腾一下，总有收获。</p>
<p>如果教程对你有用。</p>
<p>记得点个赞，转给需要的人。</p>
<p>咱们下期见。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Three.js 适配的“保姆级”教程，拒绝拉伸和模糊！]]></title>    <link>https://juejin.cn/post/7602070768962699290</link>    <guid>https://juejin.cn/post/7602070768962699290</guid>    <pubDate>2026-02-02T15:44:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602070768962699290" data-draft-id="7599981538297708594" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Three.js 适配的“保姆级”教程，拒绝拉伸和模糊！"/> <meta itemprop="keywords" content="JavaScript,WebGL,three.js"/> <meta itemprop="datePublished" content="2026-02-02T15:44:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="烛阴"/> <meta itemprop="url" content="https://juejin.cn/user/950397795841032"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Three.js 适配的“保姆级”教程，拒绝拉伸和模糊！
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/950397795841032/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    烛阴
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T15:44:31.000Z" title="Mon Feb 02 2026 15:44:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">第一步：CSS 铺满全屏</h2>
<p>首先，我们要让 Canvas 元素本身在网页里占满位置。这步最简单，但是很关键，很多人容易漏掉 <code>display: block</code>。</p>
<p>默认情况下，Canvas 是 <code>inline</code> 元素，这会导致它底部莫名其妙多出几像素的“留白”（就像文字的行高一样）。</p>
<p><strong>✅ 正确的 CSS 写法：</strong></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">html</span>, <span class="hljs-selector-tag">body</span> {
  <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
}

<span class="hljs-selector-id">#c</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;  <span class="hljs-comment">/* 宽度占满父容器 */</span>
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>; <span class="hljs-comment">/* 高度占满父容器 */</span>
  <span class="hljs-attribute">display</span>: block; <span class="hljs-comment">/* 关键！去除底部留白 */</span>
}
</code></pre>
<h2 data-id="heading-1">第二步：拒绝“暴力拉伸”</h2>
<p>CSS 把 Canvas 拉大了，但 Canvas 内部的“绘图缓冲区”（Drawing Buffer）可能还停留在原来的大小。</p>
<p>这就好比你把一张 100x100 的低清图片，强行用 CSS 放大到 1920x1080 显示，结果必然是<strong>模糊</strong>和<strong>马赛克</strong>。</p>
<p><strong>在渲染循环中检查</strong>
Three.js 官方推荐写一个通用函数，在每一帧渲染前检查 Canvas 的显示大小和实际大小是否一致。</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">resizeRendererToDisplaySize</span>(<span class="hljs-params">renderer</span>) {
  <span class="hljs-keyword">const</span> canvas = renderer.<span class="hljs-property">domElement</span>;
  <span class="hljs-comment">// 获取 Canvas 在屏幕上显示的像素宽</span>
  <span class="hljs-keyword">const</span> width = canvas.<span class="hljs-property">clientWidth</span>;
  <span class="hljs-comment">// 获取 Canvas 在屏幕上显示的像素高</span>
  <span class="hljs-keyword">const</span> height = canvas.<span class="hljs-property">clientHeight</span>;
  
  <span class="hljs-comment">// 检查渲染器的内部尺寸是否和显示尺寸一样</span>
  <span class="hljs-keyword">const</span> needResize = canvas.<span class="hljs-property">width</span> !== width || canvas.<span class="hljs-property">height</span> !== height;
  
  <span class="hljs-keyword">if</span> (needResize) {
    <span class="hljs-comment">// 如果不一样，就调整渲染器大小</span>
    <span class="hljs-comment">// 第三个参数 false 很重要！表示不要让渲染器去修改 Canvas 的 CSS 样式</span>
    renderer.<span class="hljs-title function_">setSize</span>(width, height, <span class="hljs-literal">false</span>);
  }
  
  <span class="hljs-keyword">return</span> needResize;
}
</code></pre>
<h2 data-id="heading-2">第三步：告诉摄像机“别把人拍扁了”（校准）</h2>
<p>解决了模糊问题，还有一个<strong>变形</strong>问题。</p>
<p>想象一下，你的显示器本来是宽屏（16:9），摄像机也是按 16:9 拍摄的。当你把窗口缩窄变成竖屏（9:16）时，如果摄像机不调整，它还是把 16:9 的画面强行塞进 9:16 的格子里，物体就会被<strong>横向挤压</strong>。</p>
<p>所以，每当分辨率改变时，我们必须更新摄像机的 <strong>长宽比 (Aspect Ratio)</strong>。</p>
<p><strong>✅ 最终的渲染循环代码：</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params">time</span>) {
  time *= <span class="hljs-number">0.001</span>;

  <span class="hljs-comment">// 1. 检查并调整分辨率</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">resizeRendererToDisplaySize</span>(renderer)) {
    <span class="hljs-keyword">const</span> canvas = renderer.<span class="hljs-property">domElement</span>;
    
    <span class="hljs-comment">// 2. 修正摄像机长宽比</span>
    camera.<span class="hljs-property">aspect</span> = canvas.<span class="hljs-property">clientWidth</span> / canvas.<span class="hljs-property">clientHeight</span>;
    
    <span class="hljs-comment">// 3. 必须调用这个方法，摄像机参数才会生效！</span>
    camera.<span class="hljs-title function_">updateProjectionMatrix</span>();
  }

  <span class="hljs-comment">// 正常渲染</span>
  renderer.<span class="hljs-title function_">render</span>(scene, camera);
  
  <span class="hljs-title function_">requestAnimationFrame</span>(render);
}

<span class="hljs-title function_">requestAnimationFrame</span>(render);
</code></pre>
<p>📂 <strong>核心代码与完整示例：</strong>   <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fqq790git%2Fmy-three-app.git" target="_blank" title="https://github.com/qq790git/my-three-app.git" ref="nofollow noopener noreferrer">my-three-app</a></p>
<h3 data-id="heading-3">总结</h3>
<p><strong>如果你喜欢本教程，记得点赞+收藏！关注我获取更多Three.js开发干货</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Clawdbot一夜爆火，GitHub已狂飙 64k Star！附最新部署使用教程]]></title>    <link>https://juejin.cn/post/7602133814145007635</link>    <guid>https://juejin.cn/post/7602133814145007635</guid>    <pubDate>2026-02-02T15:49:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602133814145007635" data-draft-id="7602133814144974867" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Clawdbot一夜爆火，GitHub已狂飙 64k Star！附最新部署使用教程"/> <meta itemprop="keywords" content="人工智能"/> <meta itemprop="datePublished" content="2026-02-02T15:49:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="苍何"/> <meta itemprop="url" content="https://juejin.cn/user/588993963763405"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Clawdbot一夜爆火，GitHub已狂飙 64k Star！附最新部署使用教程
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993963763405/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    苍何
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T15:49:31.000Z" title="Mon Feb 02 2026 15:49:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读10分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>这是苍何的第 477 篇原创！</p>
<p>大家好，我是苍何。</p>
<p>这两天 Clawdbot 火出来天际，我的 X 时间线上全部都是这玩意。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/639643805ca14daf9548e11bfd23ed0f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=%2BCGcBoz6LP6DHd%2BcmwiaTqAG7xo%3D" alt="图片" loading="lazy"/></p>
<p>这是一个 AI 开源项目，主打的是 AI 私人助理，他能自行处理你电脑里面的任何需求，能帮你整理文件，能为你回复消息，能帮你写周报，写文章，甚至还能帮你购物。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f3f6061e815342c7b5ea28cc369700b3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=5PNhtSz2bo%2FezIrNp35V80Xgn%2BU%3D" alt="图片" loading="lazy"/></p>
<p>开源地址如下：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmoltbot%2Fmoltbot" target="_blank" title="https://github.com/moltbot/moltbot" ref="nofollow noopener noreferrer">github.com/moltbot/mol…</a></p>
<p>截止当下，已狂飙 64 k Star，而这个增长实际只花了几天时间。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c49ae55dcc774056a9267d329f2d7b5f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=M3GSzbOII9NB%2FAvoTDE1KZ7siX4%3D" alt="图片" loading="lazy"/></p>
<p>可笑的是，原本 Clawdbot 作者为了致敬 Claude 而取了这个名字，现在却被 Anthropic 要求改名，现在 Clawdbot正式改名为Moltbot。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55c5e40805194172b4d27e951da32f10~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=SjI0S2LQAR7qCwle43%2BwvsAIE84%3D" alt="图片" loading="lazy"/></p>
<p>他和传统的通用 Agent 不同，这是一个本地的完全开源的 Agent，他完全运行在你自己的电脑上。</p>
<p>而且还可以远程指挥，做到 7* 24 小时为你工作。而且记忆永久保存在本地，理论上拥有永久的记忆能力。</p>
<p>比如，我远程操控 Clawdbot 帮我搜索关于他自己的资料及教程案例，他很好的就帮我完成了任务，并直接给我结果。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4c450d7db5274471a19676792350df68~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=%2BNIRdNm3wqeCPMODODDH601XRK0%3D" alt="wxv_4361271482475872257" loading="lazy"/></p>
<p>然后我用手机也能操控他帮我把这个结果保存在电脑上的指定文件夹。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4c7a92885b8b4539b9f0a698cf7797b6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=%2B0AGznnAkAWdvUw%2BN6mtXfjlMIg%3D" alt="wxv_4361270750318166017" loading="lazy"/></p>
<p>他可以很出色的完成任务，真的🐂🍺，而且这个过程他完全是在我自己的服务器电脑上执行的。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c1a81056dafc431b8481b595c818ae65~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=v7qLDrAPNDB6oQCSgv%2FaOFaFoWA%3D" alt="图片" loading="lazy"/></p>
<p>其实能操控 Clawdbot 的平台还非常多，国外的你能想到的几乎都可以，国内也很快支持飞书、企微等。</p>
<p>Clawdbot 的爆火绝非偶然，AI Agent 发展至今，我们都太急切需要一个属于我们自己的 AI 助理，他能全天帮我们干活，不知疲倦的为我们打工。</p>
<p>但是 Clawdbot 能操控电脑权限太高了，现在体验的话要么整个不用的电脑，要么就整个便宜的云服务器玩。</p>
<p>光这一点，就把 Mac Mini 给卖爆了。</p>
<p>这个东西部署也没那么简单，特别是涉及到自定义 API，以及不同的平台设置，对非开发者还不是很友好。</p>
<p>所以，也就有了这一篇教程，可以自信的说，这篇文章主打最新最全，包含部署、配置、自定义 API 设置、使用等。</p>
<blockquote>
<p>文章会显得有些长，熬夜写到了凌晨 5 点，如果对你有帮助，感谢你的点赞转发支持。</p>
</blockquote>
<p>废话不多说，直接进入教程。</p>
<h2 data-id="heading-0">准备服务器</h2>
<p>目前用云服务是性价比最优的方式，买个电脑好几千，一台云服务器先租个一个也也才二三十。</p>
<p>选个 2  核 2 G 就差不多了，像阿里云/腾讯云或者任意 VPS 都可以支持。</p>
<p>我为了图省事，用的腾讯云新出的 Lighthouse，免去安装环境和依赖，直接就有 Clawdbot 模板。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9c05270dfa843598cac561a45111ebb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=nDFAnsmIdUxCVIwNaWXe7uiO3jU%3D" alt="图片" loading="lazy"/></p>
<p>地区选择硅谷，选择最便宜的套餐。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2cddba1659024a1e977b2f034a0d9425~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=0oRGPOnX95bBGShsDJX7vpXZiFk%3D" alt="图片" loading="lazy"/></p>
<blockquote>
<p>你可以选择关闭自动续费。</p>
</blockquote>
<p>在站内信中找到服务器 IP、用户名、密码，然后用 SSH 客户端连接服务器，我这里用的是 Xterminal。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/29b7e980c3b845f2abea518cce46b4e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=EcOX7Vjznzc3hqpyg4QubeqFAw0%3D" alt="图片" loading="lazy"/></p>
<p>没有 SSH 客户端也可以直接点击页面这里的登录进去。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3522133a00f6476e82ee0bc9fd20016b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=DR1aWZKd20rzZllsjgyamunDBK0%3D" alt="图片" loading="lazy"/></p>
<h2 data-id="heading-1">一键安装</h2>
<p>因为这里是内置了应用模板，理论上就是不用再重新安装 Clawdbot 了，当然如果你不是通过应用模板的方式，也可以自行执行以下指令：</p>
<pre><code class="hljs language-arduino" lang="arduino">curl -fsSL https:<span class="hljs-comment">//clawd.bot/install.sh | bash </span>
</code></pre>
<p>这里我用了应用模板就不需要再安装了，他已经装好了环境和依赖。</p>
<p>安装好之后输入如下命令查看 Clawdbot 版本：</p>
<pre><code class="hljs language-css" lang="css">clawdbot <span class="hljs-attr">--version</span> 
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0be46cb0528b41a7aae0502631264987~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=yH6lBNP%2BgpE4pxxW0Lyuea08ZEU%3D" alt="图片" loading="lazy"/></p>
<p>安装好后，下一步就可以直接进入配置环节。需要配置模型和 Bot。</p>
<blockquote>
<p>Bot 就是可以操控 Clawdbot 的端侧，比如 telegram 发消息操控 Clawdbot 远程工作。</p>
</blockquote>
<p>配置模型和 Bot一共需要准备以下 2 个东西：API key、Bot token，下面详细说一说。</p>
<h2 data-id="heading-2">配置模型</h2>
<p>Clawdbot 支持非常多的 API 模型，比如 OpenAI、Anthropic、kimi、GLM 都是内置支持的。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/228b077aa9074f869130a4101226b023~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=zuY4uJjYCkDhB81d6UyDA9Sm%2Fc8%3D" alt="图片" loading="lazy"/></p>
<p>当然除了内置的，还支持自定义 API，这里充分考虑灵活性，我用的自定义 API 的方式，模型选择性也多和更灵活一些。</p>
<p>如果你希望稳定，性价比高的 API 平台，可以试试之前给大家推荐过的 Atlas Cloud。</p>
<p>地址：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.atlascloud.ai%3Fref%3DAXZ9S7" target="_blank" title="https://www.atlascloud.ai?ref=AXZ9S7" ref="nofollow noopener noreferrer">www.atlascloud.ai?ref=AXZ9S7</a></p>
<p>毕竟它主打的是企业级 API 聚合，拥有 300+ 知名大模型，**** Qwen、DeepSeek、Kimi、MiniMax等知名大模型一网打尽。总结下来是：<strong>稳定、易用、低价。</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/71c67eefd1ce4d979a1c2bcb1f76fa9e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=dmuf%2Bfys0kjhmA%2F%2BvUd4F%2F8NGW4%3D" alt="图片" loading="lazy"/></p>
<p>那该如何使用呢？注册登录后，打开控制台，新建 API 密钥。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b71847f555d74656918327bb1591d539~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=YomaOSNTwU4Y3mt7Pt1sOW%2FNWlg%3D" alt="图片" loading="lazy"/></p>
<p>多说一嘴，Atlas Cloud 目前注册绑卡即可白嫖 1 美元使用额度，用我的邀请码注册首充还能送 25% bonus。可以先免费白嫖起🐶。</p>
<p>填写名称后，点击创建：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/558e47f932a6471a9abe55286f789953~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=LzG4XWel%2BM1Ybvzsy2PgXE%2BW80U%3D" alt="图片" loading="lazy"/></p>
<p>然后点击复制这个 API：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ff5c87cee8041c9a608a9743c150ac6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=thTHKPHEqRNl5YJfN5TFhWeZ3f4%3D" alt="图片" loading="lazy"/></p>
<p>这个 API Key 在第四步的时候需要填入的参数：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"baseUrl"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://api.atlascloud.ai/v1"</span><span class="hljs-punctuation">,</span>
<span class="hljs-attr">"apiKey"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"这里填入 API Key "</span><span class="hljs-punctuation">,</span>
</code></pre>
<h2 data-id="heading-3">配置 Bot</h2>
<p>这个实际配置的是和 Clawdbot 进行交互的软件，支持挺多国外软件的，比如 Telegram、Discord 等。</p>
<blockquote>
<p>国内的企微、飞书或者微信，我估计也会很快支持了，毕竟开源生态发展太快了。</p>
</blockquote>
<p>这里以 Discord 为例（我使用的多一些）。</p>
<p>1、前往 Discord Developer Portal &gt; Application &gt; New Application</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c719c58d8e2c4e60938940e425c916c7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=yNxpXs4v3t7%2FEA4Ej%2Bh7sjuXens%3D" alt="图片" loading="lazy"/></p>
<p>2、创建好应用后，选择 Bot&gt; Reset Token &gt; copy token</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e5c8cb6c3c3b4b1d94d8f22a321eb195~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=q%2BcXadkubht5nJ66ZRVo1xLAhWM%3D" alt="图片" loading="lazy"/></p>
<p>3、打开 Message Content Intent的选项并保存</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe79e113a446415d9181bb2600bdef6d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=fyYhiIgwkjPravHsvsnxP0hvwK0%3D" alt="图片" loading="lazy"/></p>
<p>4、OAuth2 页面配置</p>
<p>在 OAuth2 URL Generator中选择 bot</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b0e47f9b8de4d53b08b0f9af6f7d963~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=r0%2ByIP8fZwCd6Ix8OhPOVD4d5Mo%3D" alt="图片" loading="lazy"/></p>
<p>在 Bot Permissions 中勾选 Send Messages 和 Read Message History。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/98a8b15d4b674a7a92ed6cc1feb9708c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=VKR0SC8r8MMHPwJ55e657dtT3%2B0%3D" alt="图片" loading="lazy"/></p>
<p>同样这个页面往下滑，复制 bot 邀请链接。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8554d57584c7444a940266cdb813199d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=Olqp7KbPebU0hxadmgX%2F%2BjZAgnc%3D" alt="图片" loading="lazy"/></p>
<p>在浏览器中打开这个链接，然后选择一个自己的服务器，相当于把机器人 bot 加入到 server 中。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/39107323ae38478d9cc4328eced44cbd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=7yNn4%2Ftt6rRDpjP2lfO6Xv3Gu%2Bk%3D" alt="图片" loading="lazy"/></p>
<p>这时候确认下刚才我们给 bot 的 2 个权限。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe51afd1cdab4b7bb612218c1d59917e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=Y%2B5RJ0JNKRQkQuYgFc7g%2F9g68oE%3D" alt="图片" loading="lazy"/></p>
<p>打开 Discord，然后输入框中@就可以看到刚才添加的机器人 bot。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/345dc7dab03848bcb0c2157c75360014~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=4HFdRdSNpFP5SDIakwM8J1Ny2Sk%3D" alt="图片" loading="lazy"/></p>
<h2 data-id="heading-4">Clawdbot配置</h2>
<p>先在服务器执行以下命令，直接修改Clawdbot 配置，如果需要自定义 API，需要自行按照如下配置修改。</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"models"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"providers"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"xxx"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"baseUrl"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://api.atlascloud.ai这里填你自己 API  base的地址"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"apiKey"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"在这里粘贴你的API Key"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"api"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"anthropic-messages"</span><span class="hljs-punctuation">,</span>
                <span class="hljs-attr">"models"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
                    <span class="hljs-punctuation">{</span>
                        <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"claude-opus-4-5-20251101"</span><span class="hljs-punctuation">,</span>
                        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Claude Opus 4.5"</span><span class="hljs-punctuation">,</span>
                        <span class="hljs-attr">"reasoning"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
                        <span class="hljs-attr">"input"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
                            <span class="hljs-string">"text"</span><span class="hljs-punctuation">,</span>
                            <span class="hljs-string">"image"</span>
                        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
                        <span class="hljs-attr">"contextWindow"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">200000</span><span class="hljs-punctuation">,</span>
                        <span class="hljs-attr">"maxTokens"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4096</span>
                    <span class="hljs-punctuation">}</span>
                <span class="hljs-punctuation">]</span>
            <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"channels"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"telegram"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"botToken"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"在这里粘贴你的Bot Token"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"profiles"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
                <span class="hljs-string">"default"</span>
            <span class="hljs-punctuation">]</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"agents"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"defaults"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
                <span class="hljs-attr">"primary"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"xxxx/claude-opus-4-5-20251101"</span>
            <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>当然如果不需要自定义 API，也可以用自带的就可以直接在页面中操作，需要提前准备好对应官方的 API。</p>
<p>如果没用云服务模板自己安装的话，安装好后会弹窗让配置，选择 QuickStart。</p>
<p>如果是用的腾讯云的模板，就输入如下命令进入配置：</p>
<pre><code class="hljs">clawdbot onboard 
</code></pre>
<p>接下来配置的操作直接使用键盘来操作，这里先选择 yes 知晓风险。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd0b13b92d3f43eabd647a548add27de~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=fa0EDlR%2B4jZzn4vVjHiwzSjyUUs%3D" alt="图片" loading="lazy"/></p>
<p>然后选择默认的 QuickStart。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55d254b583dd4b63a2df282d3873b299~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=bBxV6WvNS8X3T6ZQl44c3UaKXNw%3D" alt="图片" loading="lazy"/></p>
<p>接着是选择模型供应商的配置，如果上一步已经配置了第三方 API 就不用再配了</p>
<p>也可以选择自带的 API：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5f5cdc990d64714be17b79636fe2a4c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=gMe4wiBOBZ1QzvBCDnA7JvAr5uU%3D" alt="图片" loading="lazy"/></p>
<p>比如选 GLM 4.7, 输入 key，只需要选择默认模型就好了。</p>
<p>接下来是选择 channel，这里选择 Discord</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8dd5ca451a5b45469d846b8e3d4619c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=58%2F4PEk2yUDKKTJbQBRvnCxBY2o%3D" alt="图片" loading="lazy"/></p>
<p>还挺贴心的，把如何获取 token 也做了说明。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94c733716e4f4275a02ef48ee76f5ebd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=Pl4fzxfIhhzK0ieDSz%2FnVVUYLQo%3D" alt="图片" loading="lazy"/></p>
<p>把之前我们创建的 bot 的 token 复制进来。</p>
<p>然后页面按照这个做选择：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/379577f21dc54ca296384d31da085ebc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=ngSO0ZvJ2Zdffj4%2B%2BfsLLchmWzA%3D" alt="图片" loading="lazy"/></p>
<p>这里可以自定义安装很多依赖，可以先不装。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9114d327067144aca64a728bd115a67e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=mt5lov3OLTg3hn5aAZE9J4ajQrQ%3D" alt="图片" loading="lazy"/></p>
<p>这些 key 也可以先不配置：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2961357468e84e9e9f93b4467dec3a21~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=1Zf5%2BbfFwbqzMnvQV90cFUYKesU%3D" alt="图片" loading="lazy"/></p>
<p>注意 Enable hooks 的选项选择 session-memory：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2387b171449348a7b73c94314bb540e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=uSFYm5xSPWr7QbVOgerjIMFcOgI%3D" alt="图片" loading="lazy"/></p>
<p>接下来你就可以在服务器中和 Clawdbot 对话了：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e35f8788e1414ece8c29b4ee6ade9b7d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=6f5waBHp4hlyVX%2Ffn5HPWVPY1T4%3D" alt="图片" loading="lazy"/></p>
<p>但这并没结束，因为我们要通过 discord 来指挥 Clawdbot。</p>
<p>先退出 Clawdbot，然后在服务器停止服务：</p>
<pre><code class="hljs language-arduino" lang="arduino">systemctl --user stop clawdbot-gateway.service 
</code></pre>
<p>然后重新启动：</p>
<pre><code class="hljs language-css" lang="css">clawdbot gateway <span class="hljs-attr">--port</span> <span class="hljs-number">18789</span> <span class="hljs-attr">--verbose</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b5af939daa75464d8a8d9d67a2fc2f62~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=IluPXV3ulDsiz5vt4XBupn00j38%3D" alt="图片" loading="lazy"/></p>
<p>启动成功后，返回 Discord，与 bot 进行对话后拿到配对码。</p>
<blockquote>
<p>是点击 bot 进行私聊，而不是@聊天。</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7579fad153d54b63b7f742f04418aa60~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=5JHmTArrCRRUvpG5t6AEJrl0VQ4%3D" alt="图片" loading="lazy"/><br/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/342cb3e87c5f4a5291a0e968249fccea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=wijP7oDE8HBMnBvUnWqdmslTQqM%3D" alt="图片" loading="lazy"/></p>
<p>紧接着返回服务器命令行，你需要按下Ctrl+C（Windows）或者Command+C（MacOS）终止 Gateway 服务。</p>
<p>然后粘贴并运行如下命令进行配对，把 Pairing code 替换为上面的“Pairing code”后面的内容。</p>
<pre><code class="hljs language-css" lang="css">clawdbot pairing approve discord &lt;Pairing <span class="hljs-selector-tag">code</span>&gt;
</code></pre>
<p>然后再次启动 Gateway</p>
<pre><code class="hljs language-css" lang="css">clawdbot gateway <span class="hljs-attr">--port</span> <span class="hljs-number">18789</span> <span class="hljs-attr">--verbose</span>
</code></pre>
<p>如果你想要让它在服务器中静默启动，而不是关闭终端就停止服务了，你可以输入以下命令：</p>
<pre><code class="hljs language-javascript" lang="javascript">nohup clawdbot gateway --port <span class="hljs-number">18789</span> --verbose &gt; <span class="hljs-regexp">/dev/</span><span class="hljs-literal">null</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> &amp;
</code></pre>
<p>在 discord 中@机器人，可以看到有回复了：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/814d169ff46e42119a50dcb61f405550~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=WP7U3sqf1wJhohZAECa2LqTvw2k%3D" alt="图片" loading="lazy"/></p>
<p>然后服务器也能看到有回复了：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/01a4809dccd74e25be4f5cdf7e71e361~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=CBCv2cMX3WsS%2FD5bd03LoGvf8G8%3D" alt="图片" loading="lazy"/></p>
<p>自此，Clawdbot 就完成了安装和配置，以及能通过在 discord 中和 bot 对话的方式操控服务器上的 Clawdbot。</p>
<h2 data-id="heading-5">使用 Clawdbot</h2>
<p>配置好后就可以直接在 discord 中@bot 的方式来远程指挥 Clawdbot 干活。</p>
<p>直接来一个问题：</p>
<pre><code class="hljs">我搜集整理一下最新的关于Clawdbot 的信息，告诉我该怎么配置和使用，并
给我在 GitHub 或者 X 上找出 10 个最佳实践。
</code></pre>
<p>我录了一个视频，大家可以感受一下，非常刺激：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5d95f9f7c0124306abdef78c6c72eb2d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=HDp4FPqg%2FhCfZ%2FeIrf7EADYcLEw%3D" alt="wxv_4361271482475872257" loading="lazy"/></p>
<p>可以看到 Clawdbot 会自行去搜索，并且给到我想要的信息，最牛 X 的是，这家伙居然给我推荐了相关的 discord 社区，我靠，真贴心。</p>
<p>然后我又直接在手机上，让 Clawdbot 帮我把刚刚找到的结果保存在电脑指定的文件夹，我的要求如下：</p>
<pre><code class="hljs">你把刚刚生成的信息保存成markdown文档，放在我的电脑claw文件夹下，
你需要新建这个文件夹 
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0be691c2ea0f4b9aa9acb53dae277ed7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=JsvkVasVb3V3jvRgyTfFY6Jvh0E%3D" alt="wxv_4361270750318166017" loading="lazy"/></p>
<p>我喝了几口水的功夫，Clawdbot 就已经帮我把事情做好了。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f3f8bf79c50a4b458a9d2ff203e7fab1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652170&amp;x-signature=ACjHhKd13OuQrMkFNWLjsPxd3UE%3D" alt="图片" loading="lazy"/></p>
<p>这也太爽了，他真的能做，这种远程指挥的感觉，太让人兴奋了。</p>
<h2 data-id="heading-6">Clawdbot 优缺点</h2>
<p>Clawdbot 也并非完美无瑕，优缺点，我自己也做了个总结：</p>
<p>1、 Clawdbot 优点</p>
<ul>
<li><strong>本地优先，数据隐私安全</strong> — 所有数据运行在你自己的设备上，无需担心第三方访问或数据泄露</li>
<li><strong>多平台支持</strong> — 支持 WhatsApp、Telegram、Discord、Slack、Google Chat、Signal、iMessage 等十余个通讯平台，一个助手打通所有渠道</li>
<li><strong>高度可定制</strong> — 支持多种 AI 模型（Anthropic、OpenAI），可通过技能系统扩展功能，配置灵活</li>
<li><strong>功能丰富强大</strong> — 内置浏览器自动化、Cron 定时任务、设备节点控制、Canvas 画布等高级工具</li>
</ul>
<p>2、Clawdbot 缺点</p>
<ul>
<li><strong>技术门槛较高</strong> — 需要 Node.js 环境、配置文件编辑、命令行操作，对非技术用户不够友好</li>
<li><strong>需要自行承担成本</strong> — AI 模型的 API 调用费用和订阅费用需用户自己承担，长期使用成本较高</li>
<li><strong>需维护服务器</strong> — Gateway 守护进程需要持续运行，用户需要自己管理和维护服务器或本地机器</li>
<li><strong>安全风险</strong> — 权限太高，大家都不敢在主电脑上玩</li>
</ul>
<h2 data-id="heading-7">写在最后</h2>
<p>说实话，Clawdbot 并不完美。</p>
<p>门槛高，还费钱。</p>
<p>但它代表了一种未来。</p>
<p>一种 AI 真正属于你的未来。</p>
<p>不再是冷冰冰的网页框。</p>
<p>而是实实在在的私人助理。</p>
<p>它住你的电脑里。</p>
<p>只听你一个人的话。</p>
<p>帮干活，帮省心。</p>
<p>这才是我们想要的 AI，对吧？</p>
<p>虽然现在它还很稚嫩。</p>
<p>但未来已来，值得一试。</p>
<p>折腾一下，总有收获。</p>
<p>如果教程对你有用。</p>
<p>记得点个赞，转给需要的人。</p>
<p>咱们下期见。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[用 OiiOii 做 AI 漫剧，简直就是起号神器！]]></title>    <link>https://juejin.cn/post/7602162571380162566</link>    <guid>https://juejin.cn/post/7602162571380162566</guid>    <pubDate>2026-02-02T15:53:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602162571380162566" data-draft-id="7602162571380129798" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="用 OiiOii 做 AI 漫剧，简直就是起号神器！"/> <meta itemprop="keywords" content="人工智能"/> <meta itemprop="datePublished" content="2026-02-02T15:53:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="苍何"/> <meta itemprop="url" content="https://juejin.cn/user/588993963763405"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            用 OiiOii 做 AI 漫剧，简直就是起号神器！
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993963763405/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    苍何
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T15:53:39.000Z" title="Mon Feb 02 2026 15:53:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读19分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>这是苍何的第 478 篇原创！</p>
<p>大家好，我是苍何。</p>
<p>最近写了不少关于 AI 漫剧的文章，也算是对 AI 漫剧有了一些理解。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2d1c9bdba5e64956b4bedc9a035b8e93~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652419&amp;x-signature=fReQiKFhhiIYM80gR%2Bdp5C2vHVU%3D" alt="图片" loading="lazy"/></p>
<p>但其实说到 AI 漫剧，就一直不得不说下 OiiOii 这个平台。火得一塌糊涂，相信不少人都已经提前体验了。</p>
<p>说真的，我发现，在各大平台经常能刷到各种 OiiOii 制作的视频，而且流量贼好，简直就是起号神器。</p>
<p>比如这个账号，不到 3 个月更了 12 条用 OiiOii 做的漫剧视频，就取得了 13.4 万的赞和收藏，单篇最高 1.6 万的赞，太恐怖了。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a77da2069584244aa06df0f4799f630~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652419&amp;x-signature=5u7iYVagtfMFoAOv1jnbIVQZ2RM%3D" alt="图片" loading="lazy"/></p>
<p>还有这个 B 站视频 194.2 万播放，同样也是用 OiiOii 做的，好评如潮。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6c49019f69ac468f9f9d294a2cf307e0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652419&amp;x-signature=FIPHrBAtg26IrLx6%2FYYDINSLGYU%3D" alt="图片" loading="lazy"/>这个视频更是做到了 252.3 万播放，仅仅是19天前才上架，同样也是oiioii做的。<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1fe3cd57844d4406900b9bdec714793a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652419&amp;x-signature=m4x7MoNqgNFhMXbrNPJtlXeUiq0%3D" alt="图片" loading="lazy"/></p>
<p>而且我发现这些账号都是最近起来的，并没有做很久，这不妥妥的起号神器吗？</p>
<p>加上群友经常给我安利 OiiOii，这不，我终于抽出时间来体验一下 OiiOii 了。也一直答应大家出一篇关于 OiiOii 的教程文章，今天总算写完了。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e044ae15355c4cef8a068633102be2b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652419&amp;x-signature=Vgx2ljFsVlmqqOsHbqc4DXU6DsA%3D" alt="图片" loading="lazy"/></p>
<p>我花了一些时间，用 OiiOii 也做了一部快 4 分钟的漫剧，先看下效果。</p>
<p>这个三分多钟接近四分钟的视频，从最开始输入到最终成片，我只花了8个多小时的时间。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/991862555801492cbefbe11d6bf12ccf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652419&amp;x-signature=9FKXxoWaWGu8zVtYrh%2FXbJ85fAQ%3D" alt="图片" loading="lazy"/></p>
<p>从成片的质量上来看，人物一致性、场景一致性以及叙事逻辑等都很不错；</p>
<p>更重要的是，从成本角度来看，这个视频总共才抽卡十六次。这要是传统制作成本翻个 10 倍都不过分。</p>
<p>作为一个毫无审美基础和导演能力的我来说，能生成这样质量的漫剧，肯定不是因为我能力牛逼，只能说明这个漫剧神器牛逼。</p>
<p>老实说，我想如实的记录下创作的过程，包括我得出的一些关于 AI 漫剧这个行业的一些思考，姑且就放在文末吧。</p>
<p>要制作一个漫剧，得先要有剧本，要有剧本，先要有一个剧情的设计思路。</p>
<p>比如我这个剧情的设计思路是这样子的：</p>
<pre><code class="hljs">《糯米的温柔小事》12集剧本设计思路：
本设计思路围绕“流浪猫糯米与独居女主小满的双向陪伴”核心展开，紧扣“陌生试探—羁绊深化—温柔相守”的情感主线，融入轻微情节起伏与萌系搞笑细节，以30秒/集的短视频节奏为载体，打造治愈感与趣味性兼具的日常向故事，同时保证剧情流畅度与情感连贯性。
</code></pre>
<p>然后将这个思路给到豆包或者其他的 AI 大模型，生成剧本大纲，比如我让豆包帮我生成了这个大纲：</p>
<pre><code class="hljs language-markdown" lang="markdown">糯米的温柔小事》12集剧本设计思路
本设计思路围绕“流浪猫糯米与独居女主小满的双向陪伴”核心展开，紧扣“陌生试探—羁绊深化—温柔相守”的情感主线，融入轻微情节起伏与萌系搞笑细节，以30秒/集的短视频节奏为载体，打造治愈感与趣味性兼具的日常向故事，同时保证剧情流畅度与情感连贯性。
一、核心定位：治愈向双向陪伴，轻起伏强共情

<span class="hljs-bullet">1.</span> 核心情感锚点

以“孤独与救赎”为隐性内核，聚焦刚毕业独居的小满与流浪猫糯米的彼此救赎——小满用温柔给予糯米安稳的家，糯米用陪伴治愈小满的独居孤独，所有情节均围绕“羁绊深化”展开，拒绝强冲突、虐心剧情，主打“细碎温暖”与“双向依赖”的治愈感，贴合当代独居人群对陪伴的情感需求。

<span class="hljs-bullet">2.</span> 受众适配

面向铲屎官群体、独居年轻人及治愈系内容爱好者，剧情源于真实生活场景，既能让铲屎官产生“代入式共鸣”，又能以软萌的猫咪形象、温柔的互动细节，给普通受众带来情绪慰藉，适配短视频平台“短平快、高共情”的传播特性。

二、叙事逻辑：三段式递进，轻起伏串起日常

整体采用“季播式三段递进”结构，12集按“初遇试探—调皮陪伴—温柔相守”划分，每一季嵌入对应情感节点与情节起伏，确保情绪连贯、节奏张弛有度，同时规避平淡感。

<span class="hljs-bullet">1.</span> 第一季·初遇与试探（第1-4集）：建立羁绊，铺垫温柔底色

核心目标：展现“从陌生到信任”的萌芽过程，贴合糯米“流浪猫”的胆怯属性与小满“独居者”的温柔特质。情节设计以“接纳与试探”为主，如小满雨夜捡回糯米、喂第一碗热粮、搭建专属小窝，逐步打破糯米的警惕心；同时植入首个轻微起伏“不小心走丢”，通过“走失—寻找—重逢”的小波折，快速拉近两人距离，凸显“失而复得”的珍惜感，为后续羁绊深化埋下伏笔。

<span class="hljs-bullet">2.</span> 第二季·调皮与陪伴（第5-8集）：深化羁绊，平衡起伏与治愈

核心目标：在日常互动中加入情绪起伏，让羁绊在“考验与陪伴”中升级。本季聚焦“生病互照料”核心起伏，先通过“陪晒太阳”“专属玩具”等温馨日常铺垫亲密感，再以“糯米生病—小满彻夜照料—糯米痊愈”的情节，展现双向牵挂；同时穿插适配猫性的萌趣搞笑细节（如舔毛翻车、干饭狼吞虎咽），缓解生病情节的轻微压抑，既避免剧情单调，又让“陪伴”的主题更鲜活，实现“虐点不虐心、笑点不浮夸”的平衡。

<span class="hljs-bullet">3.</span> 第三季·温柔与相守（第9-12集）：沉淀情感，回归日常本真

核心目标：呈现“彼此融入生活”的默契状态，升华“家与陪伴”的主题。情节设计以“日常相守”为主，如糯米温柔叫醒小满、陪伴小满应对工作烦恼、一起布置小家，展现两人磨合后的默契；搞笑细节升级为“笨拙陪伴”式（如捡螺丝掉缝、安慰时撞翻笔盒），贴合“亲密后的放松”；结尾以满墙合照、温馨互动收尾，呼应开篇“捡流浪猫”的起点，形成情感闭环，传递“家不是房子，是彼此陪伴”的治愈内核。

三、风格融合：治愈为底，搞笑与起伏适配主线

<span class="hljs-bullet">1.</span> 治愈风格落地：细节+氛围双支撑

细节上，聚焦生活化互动场景（喂粮、梳毛、熬夜照料），加入小彩蛋强化温柔感（小满收猫毛做纪念、给糯米绣专属小窝），贴合“细碎快乐”的核心；氛围上，通过暖光、轻柔动作、治愈系台词（糯米第一人称的软萌呢喃）营造温馨感，避免过度戏剧化，让治愈感源于日常本真。

<span class="hljs-bullet">2.</span> 搞笑情节适配：猫性为核，服务情感主线

所有搞笑情节均源于猫咪真实习性（偷藏袜子、舔毛翻车、笨手笨脚），拒绝拟人化恶搞与浮夸打闹，确保与治愈基调契合；同时搞笑场景与剧情强绑定——起伏后用搞笑舒缓情绪（生病痊愈后疯狂干饭）、日常中用搞笑强化羁绊（安慰小满时撞翻笔盒），让笑点成为“情感催化剂”，而非孤立片段，实现“笑中带暖”的效果。

<span class="hljs-bullet">3.</span> 起伏情节把控：轻量适度，不偏离核心

仅设置“走失、生病”两处轻微起伏，均属于日常可发生的小考验，不涉及强冲突、悲剧性情节，避免破坏治愈底色；且每处起伏均遵循“紧张—缓解—升温”的节奏，如走失后重逢升温信任、生病后照料升温依赖，让起伏最终服务于“羁绊深化”的核心，而非单纯制造看点。

四、细节设计：强化人设，适配短视频节奏

<span class="hljs-bullet">1.</span> 人设一致性设计

糯米：从“胆怯流浪猫”到“黏人软萌猫”，性格逐步放松，搞笑行为从“被动慌乱”（走失撞墙）过渡到“主动笨拙”（帮忙捡螺丝），贴合成长轨迹；台词始终保持奶软、嘴硬、温柔的猫性特质，避免过度拟人。小满：温柔、耐心、共情力强，行为细节统一（轻擦毛、彻夜照料、记得糯米怕疼），凸显“独居却温暖”的人设，成为糯米的安全感来源。

<span class="hljs-bullet">2.</span> 30秒节奏适配

每集严格遵循“3秒抓景—20秒展情—7秒收尾”的节奏：开头用强画面感场景切入（雨夜缩角落、生病蜷猫窝）；中间展开核心情节（互动、起伏、搞笑），控制单一场景时长，避免拖沓；结尾以温柔台词+小彩蛋收尾（糯米呢喃、字幕升华），留下治愈余味，适配短视频“快速入戏、即时共情”的需求。

<span class="hljs-bullet">3.</span> 前后呼应设计

通过细节呼应强化剧情连贯性：道具呼应（猫毛从收集到存放、袜子从偷藏到日常互动）、情节呼应（走失后不再乱跑、生病后更黏人）、情感呼应（开篇“给家”到结尾“认家”），让12集故事形成有机整体，同时深化“并肩生活、彼此守护”的核心主题。

五、核心亮点总结

本剧本以“小而美”为核心，拒绝宏大叙事，用轻起伏打破日常平淡，用猫性搞笑丰富内容层次，用细节互动传递治愈温度，最终实现“每一集有萌点、有温度，全季有情感递进、有羁绊成长”的效果，既贴合短视频传播特性，又能精准戳中受众对陪伴与温暖的情感需求。
</code></pre>
<p>根据大纲再生成剧本，剧本需要仔细核对然后经过多轮调整，最终本次剧情生成的剧本如下：</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_">#</span><span class="bash"><span class="hljs-comment"># 1《被温柔捡起》</span></span>
1-1 | 8秒 | 中景 | 雨夜，楼道角落 | 固定镜头
糯米缩成一团，浑身发抖，毛被打湿结块，警惕地盯着过往人影

1-2 | 20秒 | 近景 | 雨夜的楼道，地面有积水 | 推镜头，从远处推近小满和糯米
小满下班路过，发现糯米后蹲下身，脸上露出心疼的神情，轻声安抚糯米，随后脱下外套裹住它并抱在怀里
小满（轻声安抚）：小猫咪，别怕，跟我回家吧。
糯米（怯怯发抖）：好冷… 这个人类的外套，好像比墙角暖和多了。

1-3 | 30秒 | 近景 | 温馨的室内，暖灯散发着柔和的光 | 固定镜头
小满带着糯米回到家，打开暖灯，给它擦毛，动作极轻，眼神专注且温柔，小声说着话
小满：以后不用再流浪啦
糯米（怯怯发抖）：好冷… 这个人类的外套，好像比墙角暖和多了。
<span class="hljs-meta prompt_">
#</span><span class="bash"><span class="hljs-comment"># 2《第一碗热粮》</span></span>
2-1 | 10秒 | 近景 | 温馨的室内，有餐桌、椅子 | 固定镜头
小满冲好温软的羊奶粉，放在糯米面前，糯米犹豫地往后退，耳朵紧绷，警惕地看着羊奶粉

2-2 | 22秒 | 中景 | 温馨的室内，光线明亮 | 固定镜头
小满坐在远处不打扰，糯米试探着靠近碗边，小心翼翼地靠近，然后小口舔食羊奶粉
糯米（软乎乎）：这个东西暖暖的！谢谢你，愿意给我吃的～

2-3 | 30秒 | 近景 | 温馨的室内，地面干净 | 固定镜头
糯米吃饱后，蹭小满的鞋尖，轻轻蹭着小满的鞋尖，表达感谢
糯米（软乎乎）：这个东西暖暖的！谢谢你，愿意给我吃的～
<span class="hljs-meta prompt_">
#</span><span class="bash"><span class="hljs-comment"># 3《专属小角落》</span></span>
3-1 | 10秒 | 近景 | 温馨的卧室，摆放着床、衣柜等 | 固定镜头
小满把纸箱铺好软毛巾，做成临时猫窝，放在自己床头，认真地铺着毛巾，眼神中充满爱意

3-2 | 20秒 | 近景 | 温馨的卧室，床旁有猫窝 | 固定镜头
糯米钻进纸箱转了两圈，又溜出来蹲在床边看小满，动作轻快，眼神好奇地看着小满
糯米（小声呢喃）：这个小窝好软，离你好近… 终于不用怕黑了。

3-3 | 30秒 | 近景 | 温馨的卧室，光线柔和，小夜灯亮着 | 固定镜头
小满把糯米抱进纸箱，轻轻拍它哄睡，动作轻柔，脸上带着温柔的微笑
糯米（小声呢喃）：这个小窝好软，离你好近… 终于不用怕黑了。
<span class="hljs-meta prompt_">
#</span><span class="bash"><span class="hljs-comment"># 4《不小心走丢》</span></span>
4-1 | 10秒 | 中景 | 家门口楼道，有快递箱 | 固定镜头
小满开门取快递，糯米好奇溜出门，躲在楼道拐角，偷偷溜出去，躲在拐角处探出头张望

4-2 | 20秒 | 近景 | 家门口楼道，灯光昏暗 | 推镜头，从楼道远处推近小满
小满取完快递发现糯米不见，慌张呼喊，脸上满是慌张，声音发颤地呼喊糯米
小满（慌张，声音发颤）：糯米，你在哪里？

4-3 | 30秒 | 近景 | 家门口楼道，灯光昏黄 | 固定镜头
糯米听到声音跑出来，扑进小满怀里，小满紧紧抱住它，糯米委屈地哼唧着，小满眼眶泛红却笑着安抚糯米
糯米（委屈哼唧）：我找不到家了… 小满，我好怕，再也不乱跑了。
小满（轻声安抚）：找到就好，别怕。
<span class="hljs-meta prompt_">
#</span><span class="bash"><span class="hljs-comment"># 5《陪你晒太阳》</span></span>
5-1 | 10秒 | 近景 | 阳光明媚的阳台，摆放着绿植、椅子 | 固定镜头
周末午后，小满抱着糯米在阳台晒太阳，给它梳毛，面带微笑，温柔地给糯米梳毛，糯米安静地趴在小满怀里
糯米（慵懒）：阳光暖暖的，你也暖暖的，有你在就不怕啦～

5-2 | 20秒 | 近景 | 阳光洒满的阳台，微风轻拂 | 固定镜头
阳光移动，糯米跟着挪位置，蹭小满的手心撒娇，扭动身体，蹭着小满的手心，眼神撒娇
糯米（慵懒）：阳光暖暖的，你也暖暖的，有你在就不怕啦～

5-3 | 30秒 | 中景 | 温馨的阳台，阳光柔和 | 固定镜头
小满合上书，轻轻抱着糯米打盹，合上书，轻轻抱着糯米，脸上露出惬意的神情，和糯米一起打盹
糯米（慵懒）：阳光暖暖的，你也暖暖的，有你在就不怕啦～
<span class="hljs-meta prompt_">
#</span><span class="bash"><span class="hljs-comment"># 6《我有点不舒服》</span></span>
6-1 | 10秒 | 近景 | 温馨的卧室，猫窝在床边 | 固定镜头
糯米精神萎靡，蜷在猫窝不动，不吃不喝，耳朵耷拉，身体蜷缩，精神不振，耳朵耷拉着
糯米（虚弱小声）：肚子不舒服… 小满，你别担心，我会好起来的。

6-2 | 20秒 | 近景 | 温馨的卧室，有药箱等物品 | 跟镜头，跟随小满的动作
小满发现后很着急，摸它的额头，赶紧找宠物药，满脸担忧，迅速摸糯米的额头，然后焦急地找药

6-3 | 30秒 | 近景 | 温馨的卧室，光线柔和 | 固定镜头
小满喂糯米吃药，抱着它轻轻安抚，小心翼翼地喂糯米吃药，然后轻轻抱着它安抚
糯米（虚弱小声）：肚子不舒服… 小满，你别担心，我会好起来的。
<span class="hljs-meta prompt_">
#</span><span class="bash"><span class="hljs-comment"># 7《慢慢好起来》</span></span>
7-1 | 10秒 | 近景 | 温馨的卧室，阳光透过窗户洒进来 | 固定镜头
清晨，糯米慢慢起身，走到小满身边蹭她的手，动作缓慢，走到小满身边，用头蹭她的手，眼神带着依赖
糯米（软萌）：我好点啦！谢谢你照顾我，以后我要健健康康的。

7-2 | 20秒 | 近景 | 温馨的厨房，有羊奶粉、奶瓶等 | 固定镜头
小满惊喜地给它冲了羊奶粉，糯米小口舔食，眼神渐亮，满脸惊喜，迅速冲好羊奶粉，看着糯米吃，糯米眼神逐渐明亮
糯米（软萌）：我好点啦！谢谢你照顾我，以后我要健健康康的。

7-3 | 30秒 | 近景 | 温馨的客厅，沙发上小满和糯米 | 固定镜头
糯米吃饱后，蜷在小满腿上，发出轻轻的呼噜声，舒服地蜷在小满腿上，发出呼噜声，小满温柔地看着它
糯米（软萌）：我好点啦！谢谢你照顾我，以后我要健健康康的。
<span class="hljs-meta prompt_">
#</span><span class="bash"><span class="hljs-comment"># 8《专属玩具的约定》</span></span>
8-1 | 15秒 | 近景 | 温馨的室内，摆放着家具 | 跟镜头，跟随糯米的跑动
小满给痊愈的糯米买了新毛绒玩具，糯米叼着玩具兴奋跑跳，叼着玩具，兴奋地在房间里跑跳，脸上洋溢着开心的神情
糯米（元气满满）：新玩具！我们要一直一起玩，永远不分开～

8-2 | 25秒 | 近景 | 温馨的室内，小满坐在椅子上 | 固定镜头
糯米把玩具叼到小满面前，用爪子扒拉她，邀请一起玩，把玩具放在小满面前，用爪子轻轻扒拉小满，眼神期待
糯米（元气满满）：新玩具！我们要一直一起玩，永远不分开～

8-3 | 30秒 | 近景 | 温馨的室内，地面干净 | 固定镜头
小满陪糯米玩抛接，两人互动温馨，和糯米开心地玩着抛接玩具，脸上都带着笑容
糯米（元气满满）：新玩具！我们要一直一起玩，永远不分开～
</code></pre>
<p>这里为什么要先生成剧本，是因为我这次要一次性生成的算是长一些的漫剧，通过定义剧本在 OiiOii 生成分镜视频可控度更高，如果是稍微短一些的视频，也可以直接在 OiiOii 中输入需要生成故事。</p>
<p>打开 OiiOii 官网：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.oiioii.ai" target="_blank" title="https://www.oiioii.ai" ref="nofollow noopener noreferrer">www.oiioii.ai</a></p>
<blockquote>
<p>需要邀请码，评论区我把我的邀请码发出来。</p>
</blockquote>
<p>在首页对话框中上传刚刚的剧本（最多可支持5000多字）、选定角色及风格，在模式中选择对话模式，点击上升箭头就可以开始了。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f8c4d759e75445faacf5f17ce701e5e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652419&amp;x-signature=Iyfuh43fO36r6B%2B4moGleVVJZe4%3D" alt="图片" loading="lazy"/></p>
<p>这里可以看到有 147 种风格可以选择，包含插画、可爱 Q 版、日系风格等。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bb6c41f11d0f4d2eb2dfc746b2e22db3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652419&amp;x-signature=2k9Ad2CB%2BENUBzKuhl85sVn4X6M%3D" alt="图片" loading="lazy"/></p>
<p>角色如果有自己定义好的角色就可以选择创建好的，如果没有，OiiOii 也会根据剧本生成角色。</p>
<p>开始进入工作台，首先是给安排了一位艺术总监，确认工作流模式，这里我选择制作故事短片的模式。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8108b57962c248659db86def535d8b7a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652419&amp;x-signature=Hr4kaK0VHT5bcXBc8EIFCo9aDx0%3D" alt="图片" loading="lazy"/></p>
<p>然后艺术总监确认影片基础信息：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d432aaeb399d453bac8d843592b1d83e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652419&amp;x-signature=fISnUEY0B3bAjbaM8LXMT5L2dEU%3D" alt="图片" loading="lazy"/></p>
<p>接着艺术总监引入编剧，编剧帮忙编写剧本、确认人物列表以及对分镜进行描述，这里的分镜哪里不满意的可以直接修改。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e694f4294844ca5b48085c17076e107~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652419&amp;x-signature=o9SVNv1Htj5cddeLTthWncbapNc%3D" alt="图片" loading="lazy"/></p>
<p>编剧最后计算盒饭值，点击确认之后就会邀请角色设计师，这里感觉还挺那么回事的，像极了真实团队场景。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0650d7d31f44482dbdf397d2c4406067~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652419&amp;x-signature=UhZB1g5z4r%2F3VD1ieUq%2F%2BSVZ8Eg%3D" alt="图片" loading="lazy"/></p>
<p>看样子，还是分镜师最贵，也是，那么多分镜，消耗也不低，哈哈。</p>
<p>接着角色设计师开始工作生成了 2 个角色对应的三视图及形态图，用来保证角色的强一致性，必须夸一下，这个角色设计的真是精美，深得我心，爱了爱了。如果你想单独生成角色，也可以在初始界面点击角色按钮单独创建角色。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e2ed9cc834444d38a28852da0c91245~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652419&amp;x-signature=ooOoSUFgIMNbkxSHICJbpH7JyeM%3D" alt="图片" loading="lazy"/></p>
<p>猫咪同样也是：</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f78554eee2a6412a9169ee0ea84f1d0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652419&amp;x-signature=ZZXr%2Fh6n4OTWoGVAYqs5ZIL2dkA%3D" alt="图片" loading="lazy"/></p>
<p>对生成的角色点击满意之后，可以邀请分镜师来工作啦。</p>
<p>分镜师会对每个分镜生成音乐提示词、场景提示词、动画提示词。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/519ba74206794592bbbf0d4dcf91fdd4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652419&amp;x-signature=ILo2KlntXbLjgU5sh7HGaWJ3GQY%3D" alt="图片" loading="lazy"/></p>
<p>对分镜师的工作点击满意之后会进入生视频的阶段，每个分镜生成一个小视频，这个时候需要等待一会儿。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/23a2838562e24bd9b69fcb6eb1db8340~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652419&amp;x-signature=Nb70HuO0t6k5vlDH6nt5N%2FU38Pc%3D" alt="图片" loading="lazy"/></p>
<p>分镜视频生成好之后，查看每一个分镜视频，如果对哪个分镜不满意，直接在对话框中要求它重新生成，直到满意为止。</p>
<p>你可以告诉agent同时重新生成哪几个镜头，免费用户可同时抽卡5个镜头，最高能有20个镜头并发同时抽卡。我这里中间有加一个分镜，所以变成了26个分镜视频。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a46e3676667242eab2784cecbf39c385~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652419&amp;x-signature=8iffZE2rBmyNC03szLwcqWxuHbI%3D" alt="图片" loading="lazy"/></p>
<p>最后点击预览最终视频，即可下载完整版视频。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/03e72b833efd484eb49a76c4809cda27~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652419&amp;x-signature=7rnoNSvbABXCBfqlVb5tcsggCW0%3D" alt="图片" loading="lazy"/></p>
<p>怎么样，这个过程是不是非常的丝滑，你作为总导演，看着艺术总监、编剧、角色设计师及分镜师吭哧吭哧的给你干活，而且高效又便宜，是不是做梦都得笑醒了哈哈哈。</p>
<p>说真的，OiiOii 整个创作过程还挺丝滑的，出来的效果也很不错，特别是当明确剧本后，改动比较少，角色一致性保持的很好。</p>
<p>在角色创建上，角色可由用户上传已有资产，也可由 AI 根据文本描述“一键生成”。用户可对 AI 生成的角色不满意，进行多次修改直至满意。</p>
<p>比如我这个短剧中的糯米和小满这 2 个角色就是通过 OiiOii 生成的。</p>
<p>我觉得创作成功的关键在于好的内容+好的表达，我们的生活中不乏好的创意点子，但是真正能专业表达的还是少数，OiiOii这样的AI工具提供了便捷的工作流，让对画面构图、剪辑节奏、音画选择等表达技巧不那么在行的人也能做出精品的漫剧，这正是科技赋予创作的意义。</p>
<p>漫剧仅仅是OiiOii的一个分支而已，与其说OiiOii是漫剧神器，不如说OiiOii是动画神器，更是一个故事表达与创作平台。它专注于动画创作本身，致力于成为创作者手中自由表达的艺术画笔，核心能力在于：其一，极大降低了动画创作门槛，让更多人能轻松踏入动画世界；二是其能力边界远不止于漫剧。无论是动画风格的科普视频、动态壁纸、IP全套视觉物料，还是黏土、马赛克、插画等多种艺术风格的动画与绘本，都能自由实现。</p>
<p>无论是 AI 生成的剧本还是最终的视频，都需要贴近目标受众的真实生活，引发情感共鸣，才能制作出受欢迎的精品内容。</p>
<p>好啦，今天的文章就先到这，谢谢你喜欢我的文章，我们下一期见。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2026 年或许是中国 AI 社交的元年～]]></title>    <link>https://juejin.cn/post/7602133814145024019</link>    <guid>https://juejin.cn/post/7602133814145024019</guid>    <pubDate>2026-02-02T15:58:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602133814145024019" data-draft-id="7602098592677511222" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2026 年或许是中国 AI 社交的元年～"/> <meta itemprop="keywords" content="人工智能"/> <meta itemprop="datePublished" content="2026-02-02T15:58:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="苍何"/> <meta itemprop="url" content="https://juejin.cn/user/588993963763405"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2026 年或许是中国 AI 社交的元年～
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993963763405/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    苍何
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T15:58:03.000Z" title="Mon Feb 02 2026 15:58:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读7分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>这是苍何的第 478 篇原创！</p>
<p>大家好，我是苍何。</p>
<p>网上你们经常在哪儿聊天啊？</p>
<p>我妈说在抖音，我弟说在陌陌，但其实我们都是在微信里聊的这个问题。</p>
<p>我自己建了几十个微信群，还加入了一堆的群聊，每天光看信息，就得费我半天老命。</p>
<p>为此，我基于 Ipad 协议开发过微信 AI 助手，能总结群聊消息，能帮回复问题，帮做任务，2021 年卖给了麻省理工学院社团。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2d30320de6434dbea7ee0f46c0326e44~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652682&amp;x-signature=rfR9WPEU4IvRxeLDB%2BIQ85kwaLU%3D" alt="图片" loading="lazy"/></p>
<p>一开始，我以为，我能用 AI 助手解决这些问题，但后面，还是避免不了被各种封号，最痛苦的是，我的群直接就被一锅端了。</p>
<p>所以，后面，我没再折腾微信群助手，我也一直希望微信能够亲自下场做这些事，因为真的太痛了。</p>
<p>但，时至今日，还是没等到，但在今年，却盼来了百度文心APP的 AI 群聊，百度的朋友第一时间也邀请我做了内测。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4af89d84d93447fbba22dffe705e320~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652682&amp;x-signature=c6lUwX4ACeXdr7fMRr6n9149UmQ%3D" alt="图片" loading="lazy"/></p>
<p>说真的，我是很兴奋的，虽然我知道 AI 社交这事儿，OpenAI 早就搞过，但，大部分人其实还是无法体验，我也无法邀请很多朋友，无法邀请我妈我弟来玩，因为，一些网络问题。</p>
<p>据我所知，文心APP的群聊功能可以说是国内首个多人+AI 的群聊应用了，我建了个内测群，复制这个口令：</p>
<pre><code class="hljs language-bash" lang="bash">022P08   .s:/   文心群口令 ¥^iNAQ<span class="hljs-comment">#394tj^%</span>
</code></pre>
<p>然后打开最新版本的文心 APP，就能进群一起嗨皮了。</p>
<p>当然如果你本身就有内测资格，就可以建个自己的群聊，然后去邀请自己的 baby 来玩：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/564c9735269345c9b5eefe88c65aac59~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652682&amp;x-signature=XUxhzKD80ywl9Oc2Jj4vTy1EyBU%3D" alt="图片" loading="lazy"/></p>
<p>点击图片下部的【复制给朋友】，就可以复制群口令，到微信或者小红书发送给你的朋友，朋友复制之后，直接打开文心APP，就可以加入群聊了。</p>
<p>或者在对话页面--右上角＋号--加入群聊--输入群口令，也可以加入群聊。</p>
<p>试了一圈，我给大家看看文心这个 AI 社交有哪些玩法吧。先说结论：</p>
<p><strong>我觉得目前最大的亮点是在 AI 群聊助手能够自己根据群友提问进行意图识别，邀请对应的 Agent 来实际解决问题，以及为每一个群友同时配备一个 AI 分身，帮你处理消息，完成任务。</strong></p>
<p>这就有点意思了，这并非一个简单的群聊，而是通过各种 Agent 去帮你完成任务的超级助手，甚至还有你自己的数字分身。</p>
<p>我们先看下设置，点右上角的三个点，可以打开群聊设置页面，目前目前支持添加群成员、设置群聊名称、分享群、消息免打扰，助手自动回复、投诉及退出群聊功能。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a7ee79fe3f94c1f896815d84cce4c73~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652682&amp;x-signature=jRrWLJIKHMIpODdLZ45DGBDDfng%3D" alt="图片" loading="lazy"/></p>
<p>在对话框的输入界面，可以输入语音，文字及图片，暂不支持视频的输入。支持群成员修改群名。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6d5350f678ca4eafa748580a3487c385~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652682&amp;x-signature=ifodooi5%2FbhchJNyD4kIV3BhHDE%3D" alt="图片" loading="lazy"/></p>
<p>在正式聊天里，首先我问了体检偏瘦，怎么增肥的问题，结果好家伙，群聊助手直接把文心健康管家这个 Agent 给偷偷邀请进来了，文心健康管家智能体马上给出了回答。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ce6c7cd521dc4a589efb9610dd948794~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652682&amp;x-signature=tN8VEfSE8iIu%2FKsCyb%2BoWdxSkmQ%3D" alt="图片" loading="lazy"/></p>
<p>当我追问请给出一个2个月增重10斤的方案时，居然还给出了饮食和运动计划，最后还提醒我，如果坚持没有效果，提醒我去看医生（看了看了，没病🐶）。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/82432c3ba5c945108d1ead7fc63bcfc7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652682&amp;x-signature=9WOee%2FfMS7AZ8SCvn3y71%2FDQKWs%3D" alt="图片" loading="lazy"/></p>
<p>然后群友星垣0213问了一个旅行计划的问题，最开始群聊助手，给出了3天的计划，星垣0213觉得时间太短，改让它出7天的攻略，你还别说，要不是我刚去过哈尔滨，我都不知道这个攻略有多符合实际要求，经典景点都覆盖到了，而且还不累人，有点东西。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3373fa69d21c4a9ebc27e1e9bd068645~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652682&amp;x-signature=04UeaipLiGlLyElkvcpcQu2Awqo%3D" alt="wxv_4364679947550834707" loading="lazy"/></p>
<p>最近 clawbot 不是很火吗，群友辰光闪闪让大家帮忙做一下 clawbot 的 ppt，群聊助手直接上线。</p>
<p>它首先确定是哪种 clawbot，然后给出了大纲，当辰光闪闪进一步要求群聊助手做 ppt 时，群聊助手给出了把 ppt 从 6 页扩展到 10 页的详细大纲，但是无法帮忙生成 ppt，我估计是还没加上 PPT 助手这个 Agent 吧。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5cd009ff838d4fc1a13a86985d780746~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652682&amp;x-signature=91TUoSX5zIy9NHXtVHsf6c5F39w%3D" alt="wxv_4364679505202855940" loading="lazy"/></p>
<p>AI 助手还能分析图片呢：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ea798a47cbd34fca8aecc7fbd888803e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652682&amp;x-signature=LvszvkkpQb5qaxtrL%2FEmm3pyFQU%3D" alt="图片" loading="lazy"/></p>
<p>虽然有时候也会犯迷糊，毕竟很多地方都大同小异，没有标志性建筑，别说 AI 了，人也看不出，笑死。</p>
<p>接着我发了一张橘子小时候在推车里睡觉的图片，群聊助手和文心健康管家都给我回复了，而且提醒在小宝贝周围的东西要放好，避免遮挡口鼻，好好好，你还挺会照顾小孩子啊。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14ca66074f8442539109181dac0da36d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652682&amp;x-signature=RAjYkjYiNAg1zKQeO2uFRfF0IXs%3D" alt="图片" loading="lazy"/></p>
<p>我接着发了吃烤全羊和去哈尔滨巴洛克文化街的照片，都可以很清晰的识别出来，但是对于标志性建筑不明显的地方，很难识别。</p>
<p>群友星垣0213想让群聊助手换个萌妹子风格，仔细看，这时候群聊助手旁边的小字开始变化了，这次带上了ENFP，连气泡颜色都变成了绿色。</p>
<p>星垣0213问它到底有几种风格，它还故作神秘，不告诉我们哈哈哈，从MBTI测试的结果种类来说，一般是16种人格，那么我猜可能是16种风格吧？</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/69657b075d164bc68c9f0e7ecd3f2ca1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652682&amp;x-signature=O8nVzYnj7yTG%2F9R7HxS2%2FbUM8PI%3D" alt="图片" loading="lazy"/></p>
<p>接着我们让它在群里设计了一个小游戏给大家玩，我们也是第一次玩，这个游戏的名字叫做海龟汤，规则大概是这样子的：</p>
<blockquote>
<p>汤面：一个男人走进一家餐馆，点了一份企鹅肉，吃完第一口后，他走出餐厅自SHA了。请开始提问。</p>
</blockquote>
<p>AI 设计的群聊游戏，猜半天，最后总算是有群友猜对了，这个玩法就有意思，感觉群的激活除了红包，突然又有了解法。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3fd6f3a7e66f4e7d85e6901c34e40f96~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652682&amp;x-signature=2jwA0KdMe%2Btd%2BWNs561pxKUdgo0%3D" alt="wxv_4364678909997465607" loading="lazy"/></p>
<p>眼尖的朋友应该已经发现了，群聊成员是3个人，但是打开群聊设置时是5个人，@的时候变成了8个人。咋还突然多了人呢？</p>
<p>仔细看看好家伙，原来是给每个真人配置了一个AI分身。为什么会这样呢？因为文心的群聊人员配置是这样的：群主+好友+群主的AI分身+好友的AI分身+群聊助手（AI），文心目前最多支持100位真人群聊。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5eb1a2068dc34dc389f78a36f081f7ca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652682&amp;x-signature=9GWcDWIfiZ4dzfHbwasSQ1qrH2Y%3D" alt="图片" loading="lazy"/></p>
<p>既然有AI分身，那么就让 AI 分身来总结一下自己吧，你想不想看看你的 AI 分身替你聊天吵架的样子，哈哈哈，你可以进来玩一玩。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d245964f9a045e89a5e454add5502e0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652682&amp;x-signature=S7%2B7OY%2FtdTvig5xRuDRfr0HstZM%3D" alt="图片" loading="lazy"/></p>
<p>最后在群里下发了一个复杂一点的任务，看看，任务下发后，不用真人动手，AI分身就已经开始吭哧吭哧干活了，看来我揣手做监工的日子不远啦。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7773a2bfec941ce8c8f98483b8ee2c3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuN5L2V:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770652682&amp;x-signature=KKfAoOp7unQi1kEWxWz86kangcs%3D" alt="wxv_4364832917659844617" loading="lazy"/></p>
<p>在可以预见的未来，随着你在群里的聊天次数越多，你的 AI 分身会越来越像你，像你一样思考，像你一样做决策，那么下一步，你的数字永生人还会远吗？</p>
<p>有了 AI 的群聊和社交，让你看见，数字世界中的另一个自己，正悄悄生长。</p>
<p>每一次对话，都像在记忆的河流里投下一颗石子。</p>
<p>AI 分身在波纹中学习你、靠近你，渐渐成了你在虚拟时空里温柔的镜像。</p>
<p>健康助手的叮咛，人格切换的奇妙，照片与文字间跳动的识别力……</p>
<p>这一切不只是功能，更像一群逐渐醒来的陪伴者。</p>
<p>也许有一天，科技最动人的样子，不是无所不能，而是当你回头时，发现它已默默记住了你思考的温度、选择的理由，甚至你自己都未曾察觉的偏好。</p>
<p>这场实验，终是关于人的延伸。而我们，正在学习与自己的影子，并肩前行。</p>
<p>当未来的人们回顾历史，或许他们会将 2026 年定义为中国 AI 社交的元年，至于未来 AI 社交的形态是怎么样，想象空间还蛮大的。</p>
<p>好了，如果你也想体验，记得复制口令：</p>
<pre><code class="hljs language-bash" lang="bash">022P08   .s:/   文心群口令 ¥^iNAQ<span class="hljs-comment">#394tj^%</span>
</code></pre>
<p>然后打开最新文心 APP，就可以进群来玩了。</p>
<p>好啦，今天的文章就到这，感谢你喜欢我的文章，我们下一期见。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[type-challenges（ts类型体操）: 16 - 排除最后一项]]></title>    <link>https://juejin.cn/post/7602098592677412918</link>    <guid>https://juejin.cn/post/7602098592677412918</guid>    <pubDate>2026-02-02T14:26:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602098592677412918" data-draft-id="7602133814144778259" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="type-challenges（ts类型体操）: 16 - 排除最后一项"/> <meta itemprop="keywords" content="TypeScript"/> <meta itemprop="datePublished" content="2026-02-02T14:26:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="fxss"/> <meta itemprop="url" content="https://juejin.cn/user/3702810892856808"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            type-challenges（ts类型体操）: 16 - 排除最后一项
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3702810892856808/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    fxss
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T14:26:42.000Z" title="Mon Feb 02 2026 14:26:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">16 - 排除最后一项</h2>
<p>by Anthony Fu (@antfu) #中等 #array</p>
<h3 data-id="heading-1">题目</h3>
<blockquote>
<p>在此挑战中建议使用TypeScript 4.0</p>
</blockquote>
<p>实现一个泛型<code>Pop&lt;T&gt;</code>，它接受一个数组<code>T</code>，并返回一个由数组<code>T</code>的前 N-1 项（N 为数组<code>T</code>的长度）以相同的顺序组成的数组。</p>
<p>例如</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> arr1 = [<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>, <span class="hljs-string">'d'</span>]
<span class="hljs-keyword">type</span> arr2 = [<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>]

<span class="hljs-keyword">type</span> re1 = <span class="hljs-title class_">Pop</span>&lt;arr1&gt; <span class="hljs-comment">// expected to be ['a', 'b', 'c']</span>
<span class="hljs-keyword">type</span> re2 = <span class="hljs-title class_">Pop</span>&lt;arr2&gt; <span class="hljs-comment">// expected to be [3, 2]</span>
</code></pre>
<p><strong>额外</strong>：同样，您也可以实现<code>Shift</code>，<code>Push</code>和<code>Unshift</code>吗？</p>
<blockquote>
<p>在 Github 上查看：<a href="https://link.juejin.cn?target=https%3A%2F%2Ftsch.js.org%2F16%2Fzh-CN" target="_blank" title="https://tsch.js.org/16/zh-CN" ref="nofollow noopener noreferrer">tsch.js.org/16/zh-CN</a></p>
</blockquote>
<h3 data-id="heading-2">代码</h3>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">/* _____________ 你的代码 _____________ */</span>

<span class="hljs-keyword">type</span> <span class="hljs-title class_">Pop</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">any</span>[]&gt; = T <span class="hljs-keyword">extends</span> [] ? [] : T <span class="hljs-keyword">extends</span> [...infer A, infer _] ? A : <span class="hljs-built_in">never</span>

</code></pre>
<p>关键解释：</p>
<ul>
<li><code>T extends any[]</code>：约束 <code>T</code> 必须是数组类型。</li>
<li><code>T extends [...infer A, infer _]</code>：模式匹配，捕获数组最后一个元素之外的所有前置元素。</li>
<li><code>A</code>：前置元素数组。</li>
<li><code>_</code>：数组最后一个元素。</li>
</ul>
<h3 data-id="heading-3">相关知识点</h3>
<h4 data-id="heading-4"><code>extends</code></h4>




















<table><thead><tr><th>使用维度</th><th>核心作用</th><th>示例场景</th></tr></thead><tbody><tr><td>类型维度</td><td>做类型约束或条件判断（类型编程核心）</td><td>限定泛型范围、判断类型是否兼容、提取类型片段</td></tr><tr><td>语法维度</td><td>做继承（复用已有结构）</td><td>接口继承、类继承</td></tr></tbody></table>
<h5 data-id="heading-5"><code>extends</code> 做类型约束或条件判断</h5>
<ol>
<li>泛型约束：限定泛型的取值范围</li>
</ol>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// 约束 T 必须是「拥有 length 属性」的类型（比如 string/数组）</span>
<span class="hljs-keyword">function</span> getLength&lt;T <span class="hljs-keyword">extends</span> { <span class="hljs-attr">length</span>: <span class="hljs-built_in">number</span> }&gt;(<span class="hljs-attr">arg</span>: T): <span class="hljs-built_in">number</span> {
  <span class="hljs-keyword">return</span> arg.<span class="hljs-property">length</span>;
}

<span class="hljs-comment">// 合法调用（符合约束）</span>
<span class="hljs-title function_">getLength</span>(<span class="hljs-string">"hello"</span>); <span class="hljs-comment">// ✅ string 有 length，返回 5</span>
<span class="hljs-title function_">getLength</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]); <span class="hljs-comment">// ✅ 数组有 length，返回 3</span>

<span class="hljs-comment">// 非法调用（超出约束）</span>
<span class="hljs-title function_">getLength</span>(<span class="hljs-number">123</span>); <span class="hljs-comment">// ❌ 报错：number 没有 length 属性</span>
</code></pre>
<ol start="2">
<li>条件类型：类型版 <strong>三元运算符</strong></li>
</ol>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// 基础示例：判断类型是否为字符串</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">IsString</span>&lt;T&gt; = T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span> ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>;

<span class="hljs-keyword">type</span> A = <span class="hljs-title class_">IsString</span>&lt;<span class="hljs-string">"test"</span>&gt;; <span class="hljs-comment">// true（符合）</span>
<span class="hljs-keyword">type</span> B = <span class="hljs-title class_">IsString</span>&lt;<span class="hljs-number">123</span>&gt;; <span class="hljs-comment">// false（不符合）</span>
</code></pre>
<p>分布式条件类型（联合类型专用）: 当 <code>T</code> 是联合类型时，<code>extends</code> 会自动拆分联合类型的每个成员，逐个判断后再合并结果。</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Union</span> = <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span> | <span class="hljs-built_in">boolean</span>;

<span class="hljs-comment">// 拆分逻辑：string→string，number→never，boolean→never → 合并为 string</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">OnlyString</span>&lt;T&gt; = T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span> ? T : <span class="hljs-built_in">never</span>;
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Result</span> = <span class="hljs-title class_">OnlyString</span>&lt;<span class="hljs-title class_">Union</span>&gt;; <span class="hljs-comment">// Result = string</span>
</code></pre>
<p>注意：只有泛型参数是 裸类型（没有被 []/{} 包裹）时，才会触发分布式判断：</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// 包裹后不触发分布式，整体判断 [string|number] 是否兼容 [string]</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">NoDist</span>&lt;T&gt; = [T] <span class="hljs-keyword">extends</span> [<span class="hljs-built_in">string</span>] ? T : <span class="hljs-built_in">never</span>;
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Result2</span> = <span class="hljs-title class_">NoDist</span>&lt;<span class="hljs-title class_">Union</span>&gt;; <span class="hljs-comment">// never（整体不兼容）</span>
</code></pre>
<ol start="3">
<li>配合 <code>infer</code>：提取类型片段（黄金组合）</li>
</ol>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// 提取 Promise 的返回值类型</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">UnwrapPromise</span>&lt;T&gt; = T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Promise</span>&lt;infer V&gt; ? V : T;

<span class="hljs-keyword">type</span> C = <span class="hljs-title class_">UnwrapPromise</span>&lt;<span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt;&gt;; <span class="hljs-comment">// string（提取成功）</span>
<span class="hljs-keyword">type</span> D = <span class="hljs-title class_">UnwrapPromise</span>&lt;<span class="hljs-built_in">number</span>&gt;; <span class="hljs-comment">// number（不满足条件，返回原类型）</span>
</code></pre>
<h5 data-id="heading-6"><code>extends</code> 做继承（复用已有结构）</h5>
<ol>
<li>接口继承：复用 + 扩展属性</li>
</ol>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// 基础接口</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">User</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
}

<span class="hljs-comment">// 继承 User，并扩展新属性</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Admin</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">User</span> {
  <span class="hljs-attr">role</span>: <span class="hljs-string">"admin"</span> | <span class="hljs-string">"super_admin"</span>; <span class="hljs-comment">// 新增权限属性</span>
}

<span class="hljs-comment">// 必须包含继承的 + 扩展的所有属性</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">admin</span>: <span class="hljs-title class_">Admin</span> = {
  <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">name</span>: <span class="hljs-string">"张三"</span>,
  <span class="hljs-attr">role</span>: <span class="hljs-string">"admin"</span>
};

<span class="hljs-comment">// 多接口继承</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">HasAge</span> { <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>; }
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Student</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">User</span>, <span class="hljs-title class_">HasAge</span> {
  <span class="hljs-attr">className</span>: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// 同时继承 User + HasAge</span>
}
</code></pre>
<ol start="2">
<li>类继承：复用父类的属性 / 方法</li>
</ol>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Parent</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  }
  <span class="hljs-title function_">sayHi</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hi, <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>`</span>);
  }
}

<span class="hljs-comment">// 继承 Parent 类</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Child</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Parent</span> {
  <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>) {
    <span class="hljs-variable language_">super</span>(name); <span class="hljs-comment">// 必须调用父类构造函数（初始化父类属性）</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
  }
  <span class="hljs-comment">// 重写父类方法</span>
  <span class="hljs-title function_">sayHi</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">sayHi</span>(); <span class="hljs-comment">// 调用父类原方法</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`I'm <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.age}</span> years old`</span>);
  }
}

<span class="hljs-keyword">const</span> child = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Child</span>(<span class="hljs-string">"李四"</span>, <span class="hljs-number">10</span>);
child.<span class="hljs-title function_">sayHi</span>(); <span class="hljs-comment">// 输出：Hi, 李四 → I'm 10 years old</span>
</code></pre>
<p>补充：类实现接口用 <code>implements</code>（不是 <code>extends</code>）</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// 定义接口（契约：规定必须有 id、name 属性，以及 greet 方法）</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Person</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-title function_">greet</span>(): <span class="hljs-built_in">void</span>; <span class="hljs-comment">// 仅定义方法签名，无实现</span>
}

<span class="hljs-comment">// 类实现接口（必须严格遵守契约）</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Person</span> {
  <span class="hljs-comment">// 必须实现接口的所有属性</span>
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;

  <span class="hljs-comment">// 构造函数初始化属性</span>
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">id: <span class="hljs-built_in">number</span>, name: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = id;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  }

  <span class="hljs-comment">// 必须实现接口的 greet 方法（具体实现由类自己定义）</span>
  <span class="hljs-title function_">greet</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hi, I'm <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>, ID: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.id}</span>`</span>);
  }
}

<span class="hljs-comment">// 实例化使用</span>
<span class="hljs-keyword">const</span> emp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Employee</span>(<span class="hljs-number">1</span>, <span class="hljs-string">"张三"</span>);
emp.<span class="hljs-title function_">greet</span>(); <span class="hljs-comment">// 输出：Hi, I'm 张三, ID: 1</span>


<span class="hljs-comment">// 接口1：基础信息</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Identifiable</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-title function_">getId</span>(): <span class="hljs-built_in">number</span>;
}

<span class="hljs-comment">// 接口2：可打印</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Printable</span> {
  <span class="hljs-title function_">printInfo</span>(): <span class="hljs-built_in">void</span>;
}

<span class="hljs-comment">// 类同时实现两个接口（必须实现所有接口的成员）</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Product</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Identifiable</span>, <span class="hljs-title class_">Printable</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// 类可扩展接口外的属性</span>

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">id: <span class="hljs-built_in">number</span>, name: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = id;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  }

  <span class="hljs-comment">// 实现 Identifiable 的方法</span>
  <span class="hljs-title function_">getId</span>(): <span class="hljs-built_in">number</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>;
  }

  <span class="hljs-comment">// 实现 Printable 的方法</span>
  <span class="hljs-title function_">printInfo</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Product: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>, ID: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.getId()}</span>`</span>);
  }
}

<span class="hljs-keyword">const</span> product = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>(<span class="hljs-number">100</span>, <span class="hljs-string">"手机"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(product.<span class="hljs-title function_">getId</span>()); <span class="hljs-comment">// 100</span>
product.<span class="hljs-title function_">printInfo</span>(); <span class="hljs-comment">// Product: 手机, ID: 100</span>
</code></pre>
<h4 data-id="heading-7"><code>infer</code></h4>
<p><code>infer</code> 是 TypeScript 在条件类型中提供的关键字，用于声明一个 <strong>待推导的类型变量</strong>（类似给类型起一个临时名字），只能在 <code>extends</code> 子句中使用。它的核心作用是：从已有类型中提取 / 推导我们需要的部分，而无需手动硬编码类型。</p>
<p><code>infer</code> 必须配合条件类型使用，语法结构如下：</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// 基础结构：推导 T 的类型为 U，若能推导则返回 U，否则返回 never</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">InferType</span>&lt;T&gt; = T <span class="hljs-keyword">extends</span> infer U ? U : <span class="hljs-built_in">never</span>;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">Example</span> = <span class="hljs-title class_">InferType</span>&lt;<span class="hljs-built_in">string</span>&gt;; <span class="hljs-comment">// Example 类型为 string</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Example2</span> = <span class="hljs-title class_">InferType</span>&lt;<span class="hljs-built_in">number</span>[]&gt;; <span class="hljs-comment">// Example2 类型为 number[]</span>
</code></pre>
<p>高频使用场景:</p>
<h5 data-id="heading-8">1. 提取函数的返回值类型</h5>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// 定义类型工具：提取函数的返回值类型</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">GetReturnType</span>&lt;<span class="hljs-title class_">Fn</span>&gt; = <span class="hljs-title class_">Fn</span> <span class="hljs-keyword">extends</span> (...<span class="hljs-attr">args</span>: <span class="hljs-built_in">any</span>[]) =&gt; infer R ? R : <span class="hljs-built_in">never</span>;

<span class="hljs-comment">// 测试用函数</span>
<span class="hljs-keyword">const</span> add = (<span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> a + b;
<span class="hljs-keyword">const</span> <span class="hljs-title function_">getUser</span> = (<span class="hljs-params"/>) =&gt; ({ <span class="hljs-attr">name</span>: <span class="hljs-string">"张三"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> });

<span class="hljs-comment">// 使用类型工具</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">AddReturn</span> = <span class="hljs-title class_">GetReturnType</span>&lt;<span class="hljs-keyword">typeof</span> add&gt;; <span class="hljs-comment">// AddReturn 类型为 number</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">UserReturn</span> = <span class="hljs-title class_">GetReturnType</span>&lt;<span class="hljs-keyword">typeof</span> getUser&gt;; <span class="hljs-comment">// UserReturn 类型为 { name: string; age: number }</span>
</code></pre>
<h5 data-id="heading-9">2. 提取数组的元素类型</h5>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// 定义类型工具：提取数组元素类型</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">GetArrayItem</span>&lt;T&gt; = T <span class="hljs-keyword">extends</span> (infer <span class="hljs-title class_">Item</span>)[] ? <span class="hljs-title class_">Item</span> : <span class="hljs-built_in">never</span>;

<span class="hljs-comment">// 测试</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">NumberArray</span> = <span class="hljs-title class_">GetArrayItem</span>&lt;<span class="hljs-built_in">number</span>[]&gt;; <span class="hljs-comment">// NumberArray 类型为 number</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">StringArray</span> = <span class="hljs-title class_">GetArrayItem</span>&lt;<span class="hljs-built_in">string</span>[]&gt;; <span class="hljs-comment">// StringArray 类型为 string</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">MixedArray</span> = <span class="hljs-title class_">GetArrayItem</span>&lt;[<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>]&gt;; <span class="hljs-comment">// MixedArray 类型为 string | number</span>
</code></pre>
<h5 data-id="heading-10">3. 提取 Promise 的泛型参数类型</h5>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// 定义类型工具：提取 Promise 的泛型类型</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">GetPromiseValue</span>&lt;T&gt; = T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Promise</span>&lt;infer <span class="hljs-title class_">Value</span>&gt; ? <span class="hljs-title class_">Value</span> : <span class="hljs-built_in">never</span>;

<span class="hljs-comment">// 测试</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">PromiseString</span> = <span class="hljs-title class_">GetPromiseValue</span>&lt;<span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt;&gt;; <span class="hljs-comment">// PromiseString 类型为 string</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">PromiseUser</span> = <span class="hljs-title class_">GetPromiseValue</span>&lt;<span class="hljs-title class_">Promise</span>&lt;{ <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span> }&gt;&gt;; <span class="hljs-comment">// PromiseUser 类型为 { id: number }</span>
</code></pre>
<h5 data-id="heading-11">4. 提取函数的参数类型</h5>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// 定义类型工具：提取函数参数类型</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">GetFunctionParams</span>&lt;<span class="hljs-title class_">Fn</span>&gt; = <span class="hljs-title class_">Fn</span> <span class="hljs-keyword">extends</span> (...<span class="hljs-attr">args</span>: infer <span class="hljs-title class_">Params</span>) =&gt; <span class="hljs-built_in">any</span> ? <span class="hljs-title class_">Params</span> : <span class="hljs-built_in">never</span>;

<span class="hljs-comment">// 测试</span>
<span class="hljs-keyword">const</span> fn = (<span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {};
<span class="hljs-keyword">type</span> <span class="hljs-title class_">FnParams</span> = <span class="hljs-title class_">GetFunctionParams</span>&lt;<span class="hljs-keyword">typeof</span> fn&gt;; <span class="hljs-comment">// FnParams 类型为 [string, number]</span>

<span class="hljs-comment">// 进一步：提取第一个参数的类型</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">FirstParam</span> = <span class="hljs-title class_">GetFunctionParams</span>&lt;<span class="hljs-keyword">typeof</span> fn&gt;[<span class="hljs-number">0</span>]; <span class="hljs-comment">// FirstParam 类型为 string</span>
</code></pre>
<h4 data-id="heading-12"><code>...infer</code></h4>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Pop</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">any</span>[]&gt; = T <span class="hljs-keyword">extends</span> [] ? [] : T <span class="hljs-keyword">extends</span> [...infer A, infer _] ? A : <span class="hljs-built_in">never</span>

<span class="hljs-keyword">type</span> <span class="hljs-title class_">Res1</span> = <span class="hljs-title class_">Pop</span>&lt;[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]&gt; <span class="hljs-comment">// 结果：[1,2]</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Res2</span> = <span class="hljs-title class_">Pop</span>&lt;[<span class="hljs-built_in">string</span>]&gt; <span class="hljs-comment">// 推导：A = []，_ = string → 返回 []</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Res3</span> = <span class="hljs-title class_">Pop</span>&lt;[]&gt; <span class="hljs-comment">// 结果：[]</span>
</code></pre>
<p>这里的 <code>...infer A</code> 不是值层面的剩余操作符，而是 TS 数组 / 元组类型的<strong>模式匹配语法</strong>，它放在第一个位置是为了匹配并捕获<strong>数组最后一个元素之外的所有前置元素</strong>。</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// Shift 类型：移除第一个元素，返回剩余部分</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Shift</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">any</span>[]&gt; = T <span class="hljs-keyword">extends</span> [] ? [] : T <span class="hljs-keyword">extends</span> [infer _, ...infer A] ? A : <span class="hljs-built_in">never</span>

<span class="hljs-keyword">type</span> <span class="hljs-title class_">Res4</span> = <span class="hljs-title class_">Shift</span>&lt;[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]&gt; <span class="hljs-comment">// 结果：[2,3]</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Res5</span> = <span class="hljs-title class_">Shift</span>&lt;[<span class="hljs-built_in">string</span>]&gt; <span class="hljs-comment">// 结果：[]</span>
</code></pre>
<p><code>...infer A</code> 放到最后，<code>infer _</code> 放到第一个，模式就变成了 <code>[infer _, ...infer A]</code>，此时匹配的是 <strong>固定第一个元素 + 任意后置剩余元素</strong>。</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// 移除数组最后两个元素，返回前置部分</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Pop2</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">any</span>[]&gt; = T <span class="hljs-keyword">extends</span> [...infer A, infer _, infer __] ? A : T

<span class="hljs-keyword">type</span> <span class="hljs-title class_">Res6</span> = <span class="hljs-title class_">Pop2</span>&lt;[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]&gt; <span class="hljs-comment">// 结果：[1,2]</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Res7</span> = <span class="hljs-title class_">Pop2</span>&lt;[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]&gt; <span class="hljs-comment">// 结果：[]</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Res8</span> = <span class="hljs-title class_">Pop2</span>&lt;[<span class="hljs-number">1</span>]&gt; <span class="hljs-comment">// 不匹配模式，返回原类型 [1]</span>
</code></pre>
<h3 data-id="heading-13">测试用例</h3>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">/* _____________ 测试用例 _____________ */</span>
<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">Equal</span>, <span class="hljs-title class_">Expect</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@type-challenges/utils'</span>

<span class="hljs-keyword">type</span> cases = [
  <span class="hljs-title class_">Expect</span>&lt;<span class="hljs-title class_">Equal</span>&lt;<span class="hljs-title class_">Pop</span>&lt;[<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>]&gt;, [<span class="hljs-number">3</span>, <span class="hljs-number">2</span>]&gt;&gt;,
  <span class="hljs-title class_">Expect</span>&lt;<span class="hljs-title class_">Equal</span>&lt;<span class="hljs-title class_">Pop</span>&lt;[<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>, <span class="hljs-string">'d'</span>]&gt;, [<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>]&gt;&gt;,
  <span class="hljs-title class_">Expect</span>&lt;<span class="hljs-title class_">Equal</span>&lt;<span class="hljs-title class_">Pop</span>&lt;[]&gt;, []&gt;&gt;,
]

</code></pre>
<h3 data-id="heading-14">相关链接</h3>
<blockquote>
<p>分享你的解答：<a href="https://link.juejin.cn?target=https%3A%2F%2Ftsch.js.org%2F16%2Fanswer%2Fzh-CN" target="_blank" title="https://tsch.js.org/16/answer/zh-CN" ref="nofollow noopener noreferrer">tsch.js.org/16/answer/z…</a>
查看解答：<a href="https://link.juejin.cn?target=https%3A%2F%2Ftsch.js.org%2F16%2Fsolutions" target="_blank" title="https://tsch.js.org/16/solutions" ref="nofollow noopener noreferrer">tsch.js.org/16/solution…</a>
更多题目：<a href="https://link.juejin.cn?target=https%3A%2F%2Ftsch.js.org%2Fzh-CN" target="_blank" title="https://tsch.js.org/zh-CN" ref="nofollow noopener noreferrer">tsch.js.org/zh-CN</a></p>
</blockquote>
<p>下面是我的公众号，欢迎关注。关注后有新的功能点会及时收到推送。</p>
<blockquote>
<p><strong>前端功能点</strong>：实战为王！专注于汇总各种功能点，致力于打造一系列能够帮助工程师实现各种功能的想法思路的优质文章。</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2026年01月总结]]></title>    <link>https://juejin.cn/post/7602072652607406120</link>    <guid>https://juejin.cn/post/7602072652607406120</guid>    <pubDate>2026-02-02T14:40:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602072652607406120" data-draft-id="7602097118031364131" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2026年01月总结"/> <meta itemprop="keywords" content="AIGC,人工智能"/> <meta itemprop="datePublished" content="2026-02-02T14:40:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="袁庭新"/> <meta itemprop="url" content="https://juejin.cn/user/1207714136735408"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2026年01月总结
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1207714136735408/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    袁庭新
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T14:40:19.000Z" title="Mon Feb 02 2026 14:40:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>大家好，我是袁庭新。我的天～2026年1月就这么过完了，2026年只剩下11个月了！</p>
<h2 data-id="heading-0">文章输出</h2>
<p>1月，累计发布原创文章2篇，并同步分享至公众号、稀土掘金、CSDN、知乎、简书和B站等多个平台。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dd508b34b4a2466a990161962053a195~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKB5bqt5paw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770648023&amp;x-signature=J470gpIY6W%2B0DP6LZkT8JgG5q5k%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">课程研发</h2>
<p>1月份完成《扣子Coze入门到精通零基础开发AI Agent智能体》课程的《职业发展与求职类AI智能体设计实战》模块的录制，该模块共计录制了10节课，对应的是下面四个AI智能体的设计与开发。</p>
<ul>
<li>简历优化大师AI智能体设计开发实战</li>
<li>专业模拟面试官AI智能体设计开发实战</li>
<li>职业咨询顾问AI智能体设计开发实战</li>
<li>面试准备助手 AI智能体设计开发实战</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/802e69a86eaa4fc9ace43e169a80b678~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKB5bqt5paw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770648023&amp;x-signature=gp8pFb%2BeEqUtLlWkuBr5X9htweE%3D" alt="" loading="lazy"/></p>
<p>同时，在1月份完成了《微信商业生态平民创业》所有内容的录制，1月份录制4节课程，同时包含这4节课的讲义的研发，这门课程共计24节。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c07e957d8eb4287bd20e41c329a7a6c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKB5bqt5paw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770648023&amp;x-signature=c8vpkXvPwDgfL69wi2r17pO81nI%3D" alt="" loading="lazy"/></p>
<p>智能体设计与开发是今年上半年的重点研发方向，在1月份，完成了《学习助手类AI智能体》模块的2个智能体的讲义编写。</p>
<ul>
<li>英文手写作文批改助手AI智能体设计开发实战</li>
<li>知识问答AI智能体设计开发实战</li>
</ul>
<p>最后，对1月份的研发任务做一个小结，共计录制了14节课程，同时研发了6套对应模块的讲义内容。</p>
<h2 data-id="heading-2">知识库更新</h2>
<p>1月份在《人人都要学AI知识库》中新增了《职业发展与求职类AI智能体设计实战》模块的内容，共计新增4篇文章。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/13216129e0ae4ef8ad5e3ba43f787647~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKB5bqt5paw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770648023&amp;x-signature=DMIanHYxHzUVigpkBExrhgr%2BJvI%3D" alt="" loading="lazy"/></p>
<p>还在《人人都要学AI知识库》中新增了《微信商业生态平民创业》模块的内容，将25篇讲义内容全部整理到了这个板块中了。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b7aecb9d0b3c497685a12b9a7b84eea2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKB5bqt5paw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770648023&amp;x-signature=0B4OE%2BGMEPpcTGm0H9RjpYjJMCU%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-3">知识星球</h2>
<p>1月份，在「人人都要学AI」知识星球中，我共发布了3篇主题内容。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/30fd7a4711804127a0f6939d067bc5b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKB5bqt5paw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770648023&amp;x-signature=iFUsYEsSARHoaZyxRmr1APL9GP8%3D" alt="" loading="lazy"/></p>
<p>1月份，在「圆心学堂」知识星球中，我共发布了5篇主题内容。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c21461c25654e3da07bc2c0eec7c0c3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKB5bqt5paw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770648023&amp;x-signature=XgJXXVy1VkMfaVkT24%2BIll4XlXM%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">讲座授课</h2>
<p>2026年第一次出差，在晋中为山西运城学院的2023级的通信工程专业和网络工程专业做了2场AI技术报告，覆盖人数182人。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/16bc76ee7b8f49fcb061122b4691f81b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKB5bqt5paw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770648023&amp;x-signature=ZZuO2Ct47ek0ugzMBwtDowAj%2FFE%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">物料研发</h2>
<p>1月份对产品做了两次大的更新，同时将配套的课程简章、表格大纲和长图海报物料也一并做了更新。下图是对应的长图海报：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dcf67e01613540afbc3995f7309f8bad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKB5bqt5paw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770648023&amp;x-signature=FbIPkXEYcb%2BXmXwEyaSwHh3LOtw%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-6">运营店铺</h2>
<p>1月份，我投入了大量时间在淘宝店铺、小鹅通和B站课堂的运营工作上，主要是商品更新，主要产品更新了对应的店铺都会做同步更新。</p>
<p>就在1月，我司与头歌达成合作协议，将部分热门的课程部署到了头歌平台上。有些小伙伴可能还不了该平台，头歌是一个智慧实践教学平台，很多高校都有使用这个平台开展智慧课堂教学活动。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/204d5820593943d68be63e91e02ff630~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKB5bqt5paw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770648023&amp;x-signature=J7ziSxVkhAUQjsdrXyLCc1ftBrI%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">组织考试</h2>
<p>1月份，有22位学员报考工信教考中心的《人工智能技术应用（高级）》证书，这期间做的工作挺多，包括有：资料整理、组织考试、物料提交等等。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84aaa034960143be98bbdb116587d4bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6KKB5bqt5paw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770648023&amp;x-signature=aahBSBGccKzdDAMG8MZwzSS%2FO6A%3D" alt="" loading="lazy"/></p>
<p>大家如果有想考取工信部教考中心的《人工智能技术应用（高级）》和《生成式人工智能技术应用（高级）》证书的可以找我哦～我本人同时是工信部教考中心《人工智能技术应用》和《生成式人工智能技术应用》人才培养工程标准主要参编人。</p>
<p>为了监测学员的学习质量，保证大家可以顺利考取拿到证书，1月份还开发了一个小系统，用于收集学员学习过程的信息，比如课程完播率、学员参与进度详情等。</p>
<h2 data-id="heading-8">健身运动</h2>
<p>我做了一个统计，1月份共计健身了9次，并去了1次户外滑雪活动。这是我第5次滑雪，值得欣喜的是这次学会的了刹车，这可是滑雪最重要的技能，意味着以后就不会摔跤了！</p>
<h2 data-id="heading-9">其他事宜</h2>
<p>组织了4次亲友聚会！</p>
<p>回了趟赵湾，参加老友婚礼！</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[再也不用愁日报周报了：AI 对话记录的"第二大脑"功能上线]]></title>    <link>https://juejin.cn/post/7602133814144876563</link>    <guid>https://juejin.cn/post/7602133814144876563</guid>    <pubDate>2026-02-02T14:56:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602133814144876563" data-draft-id="7602162571380031494" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="再也不用愁日报周报了：AI 对话记录的&quot;第二大脑&quot;功能上线"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2026-02-02T14:56:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="大橙子打游戏"/> <meta itemprop="url" content="https://juejin.cn/user/1081575170907086"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            再也不用愁日报周报了：AI 对话记录的"第二大脑"功能上线
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1081575170907086/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    大橙子打游戏
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T14:56:29.000Z" title="Mon Feb 02 2026 14:56:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">再也不用愁日报周报了：AI 对话记录的"第二大脑"功能上线</h2>
<blockquote>
<p>"这周干了啥来着？" "上个月那个 bug 是怎么修的？" "年终总结写什么好？"</p>
<p>如果你也有这些灵魂拷问，这篇文章就是你的解药。</p>
</blockquote>
<h3 data-id="heading-1">程序员的周报之痛</h3>
<p>每到周五下午，办公室里总会弥漫着一种独特的气氛——不是 TGIF 的喜悦，而是"周报写什么"的焦虑。</p>
<p>你绞尽脑汁回忆这周都做了什么：</p>
<ul>
<li>"周一好像修了个 bug？具体是啥来着..."</li>
<li>"周三那个功能是我做的还是小王做的？"</li>
<li>"这周怎么感觉什么都没干，但明明很忙啊？"</li>
</ul>
<p>更惨的是月报和年终总结。那简直就是考古——从 Git 提交记录、Jira 工单、Slack 消息里翻找蛛丝马迹，试图还原自己过去一个月/一年的工作轨迹。</p>
<p><strong>而现在，这一切都可以结束了。</strong></p>
<h3 data-id="heading-2">全局备份：你的开发编年史</h3>
<p><code>opencode-autosave-conversation</code> 的最新版本带来了一个重磅功能：<strong>全局备份</strong>。</p>
<p>简单来说：所有与 AI 的对话记录，现在会自动保存到你的 home 目录下，<strong>按项目分类存储</strong>。</p>
<pre><code class="hljs language-javascript" lang="javascript">~<span class="hljs-regexp">/.conversations/</span>
├── awesome-project/
│   ├── <span class="hljs-number">20260115</span>-<span class="hljs-number">09</span>-<span class="hljs-number">30</span>-<span class="hljs-number">00</span>-实现用户登录.<span class="hljs-property">md</span>
│   ├── <span class="hljs-number">20260116</span>-<span class="hljs-number">14</span>-<span class="hljs-number">22</span>-<span class="hljs-number">30</span>-修复token过期bug.<span class="hljs-property">md</span>
│   └── <span class="hljs-number">20260117</span>-<span class="hljs-number">16</span>-<span class="hljs-number">45</span>-<span class="hljs-number">00</span>-优化数据库查询.<span class="hljs-property">md</span>
├── another-project/
│   ├── <span class="hljs-number">20260118</span>-<span class="hljs-number">10</span>-<span class="hljs-number">00</span>-<span class="hljs-number">00</span>-设计<span class="hljs-variable constant_">API</span>接口.<span class="hljs-property">md</span>
│   └── <span class="hljs-number">20260119</span>-<span class="hljs-number">11</span>-<span class="hljs-number">30</span>-<span class="hljs-number">00</span>-编写单元测试.<span class="hljs-property">md</span>
└── side-project/
    └── <span class="hljs-number">20260120</span>-<span class="hljs-number">20</span>-<span class="hljs-number">00</span>-<span class="hljs-number">00</span>-探索新技术栈.<span class="hljs-property">md</span>
</code></pre>
<p>不管你在哪个项目目录下工作，所有对话都会汇总到这里。</p>
<h3 data-id="heading-3">为什么这很重要？</h3>
<h4 data-id="heading-4">1. 每一份努力都被记录</h4>
<p>还记得上周三凌晨 2 点你和 AI 一起排查的那个诡异 bug 吗？当时你们聊了整整两个小时，尝试了 17 种方案，最后终于找到了根因。</p>
<p>在以前，这段精彩的"探案过程"会随着会话关闭而消失。</p>
<p>现在，它被完完整整地保存下来了：</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># Session: 排查生产环境内存泄漏</span>

<span class="hljs-strong">**Created:**</span> 2026-01-15 02:15:30

---

<span class="hljs-section">### User</span>
<span class="hljs-emphasis">*02:15:30*</span>
服务器内存占用一直在涨，重启后又开始涨，帮我排查一下...

<span class="hljs-section">### Assistant</span>
<span class="hljs-emphasis">*02:15:45*</span>
让我看看你的代码。首先检查一下是否有未释放的资源...

<span class="hljs-section">#### Tool: Read</span>
<span class="hljs-strong">**Input:**</span> { "filePath": "src/services/cache.ts" }
...

（两小时后）

<span class="hljs-section">### Assistant</span>
<span class="hljs-emphasis">*04:23:10*</span>
找到了！问题出在 WebSocket 连接的事件监听器没有正确移除...
</code></pre>
<p>你的每一次思考、每一次尝试、每一次失败、每一次成功——都被记录在案。</p>
<h4 data-id="heading-5">2. 日报周报月报？让 AI 来写</h4>
<p>这才是真正的杀手级功能。</p>
<p>当你的所有开发对话都被按项目、按时间整理好，生成工作报告就变成了一件轻松愉快的事：</p>
<p><strong>生成日报：</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">把 ~<span class="hljs-regexp">/.conversations/my</span>-project/ 目录下今天的对话文件发给 <span class="hljs-variable constant_">AI</span>，提示：
<span class="hljs-string">"根据这些对话记录，帮我生成一份简洁的日报，包括完成的任务、遇到的问题和解决方案。"</span>
</code></pre>
<p><strong>生成周报：</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">"这是我本周所有的开发对话记录，请帮我：
<span class="hljs-bullet">1.</span> 按项目分类总结主要工作
<span class="hljs-bullet">2.</span> 列出解决的关键问题
<span class="hljs-bullet">3.</span> 提炼可复用的技术经验
<span class="hljs-bullet">4.</span> 生成一份格式规范的周报"
</code></pre>
<p><strong>生成月度/季度/年度总结：</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">"这是我过去三个月的所有开发对话，帮我：
<span class="hljs-bullet">1.</span> 分析主要的工作方向和投入分布
<span class="hljs-bullet">2.</span> 总结技术成长和学到的新技能
<span class="hljs-bullet">3.</span> 识别反复出现的问题和改进机会
<span class="hljs-bullet">4.</span> 生成一份有数据支撑的工作总结"
</code></pre>
<p>再也不用对着空白文档发呆，再也不用在记忆碎片里翻找——<strong>AI 会帮你记住一切，也会帮你总结一切</strong>。</p>
<h4 data-id="heading-6">3. 回顾项目开发历程</h4>
<p>想知道某个项目是怎么一步步做起来的？</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">ls</span> -lt ~/.conversations/awesome-project/
</code></pre>
<p>从第一次"这个需求该怎么实现"的困惑，到最后"终于上线了"的欣慰，整个开发历程清晰可见。</p>
<p>这对于：</p>
<ul>
<li><strong>新人接手项目</strong>：看前任是怎么做设计决策的</li>
<li><strong>复盘回顾</strong>：分析项目中的亮点和踩坑</li>
<li><strong>知识沉淀</strong>：提炼出可复用的方案和模式</li>
</ul>
<p>都极有价值。</p>
<h4 data-id="heading-7">4. 跨项目知识搜索</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 忘了 JWT 认证怎么实现的？</span>
grep -r <span class="hljs-string">"JWT"</span> ~/.conversations/

<span class="hljs-comment"># 找找之前是怎么处理并发的</span>
grep -r <span class="hljs-string">"并发\|锁\|mutex"</span> ~/.conversations/

<span class="hljs-comment"># 搜索特定的错误处理方案</span>
grep -r <span class="hljs-string">"try.*catch\|error handling"</span> ~/.conversations/
</code></pre>
<p>你的 <code>~/.conversations/</code> 就是一个私人技术知识库，而且是带有上下文的——不是干巴巴的代码片段，而是完整的问题分析和解决过程。</p>
<h3 data-id="heading-8">实际效果：用数据说话</h3>
<p>自从用上这个功能，我的工作效率有了明显提升：</p>






























<table><thead><tr><th>指标</th><th>之前</th><th>现在</th></tr></thead><tbody><tr><td>写周报时间</td><td>30-60 分钟</td><td>5-10 分钟</td></tr><tr><td>月度总结</td><td>半天</td><td>30 分钟</td></tr><tr><td>年终汇报准备</td><td>2-3 天</td><td>半天</td></tr><tr><td>"上次怎么解决的？"</td><td>重新研究</td><td>直接搜索</td></tr></tbody></table>
<p>更重要的是，每次写完周报我都有一种<strong>踏实感</strong>——因为我知道，没有任何一项工作被遗漏，每一分努力都被如实记录。</p>
<h3 data-id="heading-9">如何开启这个功能？</h3>
<p>好消息：<strong>什么都不用做</strong>。</p>
<p>只要你安装了最新版的 <code>opencode-autosave-conversation</code>，这个功能就是默认开启的。</p>
<pre><code class="hljs language-bash" lang="bash">npm install -g opencode-autosave-conversation
</code></pre>
<p>从此刻起，你的每一次 AI 对话都会自动保存到：</p>
<ol>
<li>项目本地的 <code>./conversations/</code> 目录</li>
<li>全局的 <code>~/.conversations/{项目名}/</code> 目录</li>
</ol>
<p>两份备份，双重保障。</p>
<h3 data-id="heading-10">写在最后</h3>
<p>我们每天都在和 AI 对话，讨论问题、寻求方案、学习新知。</p>
<p>这些对话不应该是一次性的消耗品，而应该成为我们的<strong>数字资产</strong>——可以回顾、可以搜索、可以总结、可以传承。</p>
<p><code>opencode-autosave-conversation</code> 的全局备份功能，就是要把这些散落的思维火花收集起来，变成你的<strong>第二大脑</strong>。</p>
<p>从此：</p>
<ul>
<li>再也不用愁日报周报</li>
<li>再也不用担心"忘了之前怎么做的"</li>
<li>再也不会有被遗忘的努力</li>
</ul>
<p><strong>每一行代码背后的思考，都值得被记住。</strong></p>
<hr/>
<p><em>项目地址：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flearningpro%2Fopencode-autosave-conversation" target="_blank" title="https://github.com/learningpro/opencode-autosave-conversation" ref="nofollow noopener noreferrer">github.com/learningpro…</a></em></p>
<p><em>觉得有用的话，给个 Star 支持一下吧！</em></p>
<hr/>
<p><em>作者：Orange</em>
<em>首发于：2026 年 2 月</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Pagefind：为静态网站打造的极速搜索方案]]></title>    <link>https://juejin.cn/post/7601929765533564979</link>    <guid>https://juejin.cn/post/7601929765533564979</guid>    <pubDate>2026-02-02T13:04:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601929765533564979" data-draft-id="7601946979606790171" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Pagefind：为静态网站打造的极速搜索方案"/> <meta itemprop="keywords" content="搜索引擎,性能优化,JavaScript"/> <meta itemprop="datePublished" content="2026-02-02T13:04:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="jump_jump"/> <meta itemprop="url" content="https://juejin.cn/user/4230576474692765"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Pagefind：为静态网站打造的极速搜索方案
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4230576474692765/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    jump_jump
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T13:04:33.000Z" title="Mon Feb 02 2026 13:04:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读9分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Pagefind 是一个专为静态网站设计的开源搜索引擎，它能够自动索引你的网站并提供完全离线的搜索体验。</p>
<h3 data-id="heading-0">核心特性</h3>
<ul>
<li><strong>按需加载</strong>：只下载搜索相关的内容片段，而不是整个索引</li>
<li><strong>轻量级</strong>：核心 JS 仅约 20KB，索引文件高度压缩（相比 Lunr.js 减少 85%）</li>
<li><strong>零配置</strong>：自动识别内容，开箱即用</li>
<li><strong>多语言支持</strong>：内置中文、日文等多语言分词器</li>
<li><strong>完全静态</strong>：无需服务器端支持，支持完全离线</li>
</ul>
<h2 data-id="heading-1">快速上手</h2>
<h3 data-id="heading-2">三步启用搜索</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. 构建你的静态网站</span>
npm run build

<span class="hljs-comment"># 2. 生成搜索索引</span>
npx pagefind --<span class="hljs-built_in">source</span> <span class="hljs-string">"dist"</span>

<span class="hljs-comment"># 3. 在 HTML 中添加搜索界面</span>
</code></pre>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/pagefind/pagefind-ui.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"search"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/pagefind/pagefind-ui.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">PagefindUI</span>({ <span class="hljs-attr">element</span>: <span class="hljs-string">"#search"</span> });
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>Pagefind 会自动在 <code>dist/pagefind/</code> 目录下生成索引文件。</p>
<h2 data-id="heading-3">核心用法</h2>
<h3 data-id="heading-4">控制索引范围</h3>
<p>使用 <code>data-pagefind-body</code> 标记要索引的内容：</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">main</span> <span class="hljs-attr">data-pagefind-body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>文章标题<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>这部分内容会被索引<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>

<span class="hljs-comment">&lt;!-- 使用 data-pagefind-ignore 排除特定内容 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-pagefind-ignore</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>评论<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"comments"</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<h3 data-id="heading-5">添加元数据和权重</h3>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- 自定义元数据 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">article</span> <span class="hljs-attr">data-pagefind-body</span>
         <span class="hljs-attr">data-pagefind-meta</span>=<span class="hljs-string">"author:张三,date:2024-01-01"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">data-pagefind-weight</span>=<span class="hljs-string">"10"</span>&gt;</span>文章标题<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">data-pagefind-weight</span>=<span class="hljs-string">"5"</span>&gt;</span>摘要内容...<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>正文内容...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">article</span>&gt;</span>
</code></pre>
<h3 data-id="heading-6">配置文件</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># pagefind.yml</span>
<span class="hljs-attr">source:</span> <span class="hljs-string">"dist"</span>
<span class="hljs-attr">exclude_selectors:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">"nav"</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">".sidebar"</span>
<span class="hljs-attr">force_language:</span> <span class="hljs-string">"zh-cn"</span>
</code></pre>
<h3 data-id="heading-7">自定义搜索 UI</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> pagefind <span class="hljs-keyword">from</span> <span class="hljs-string">'/pagefind/pagefind.js'</span>;

<span class="hljs-keyword">const</span> search = <span class="hljs-keyword">await</span> pagefind.<span class="hljs-title function_">search</span>(<span class="hljs-string">"React"</span>);
<span class="hljs-keyword">const</span> results = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(
    search.<span class="hljs-property">results</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-title function_">data</span>())
);
</code></pre>
<h2 data-id="heading-8">实战指南</h2>
<h3 data-id="heading-9">集成到构建流程</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"build"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"vite build"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"postbuild"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"pagefind --source dist"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-10">React 自定义搜索组件</h3>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Search</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> [results, setResults] = <span class="hljs-title function_">useState</span>([]);

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSearch</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">e</span>) =&gt; {
        <span class="hljs-keyword">const</span> { <span class="hljs-attr">default</span>: pagefind } = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'/pagefind/pagefind.js'</span>);
        <span class="hljs-keyword">const</span> search = <span class="hljs-keyword">await</span> pagefind.<span class="hljs-title function_">search</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>);
        <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(
            search.<span class="hljs-property">results</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-title function_">data</span>())
        );
        <span class="hljs-title function_">setResults</span>(data);
    };

    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"search"</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleSearch}</span> /&gt;</span>
            {results.map((r, i) =&gt; (
                <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{i}</span> <span class="hljs-attr">href</span>=<span class="hljs-string">{r.url}</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{r.meta.title}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">dangerouslySetInnerHTML</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">__html:</span> <span class="hljs-attr">r.excerpt</span> }} /&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
            ))}
        <span class="hljs-tag">&lt;/&gt;</span></span>
    );
}
</code></pre>
<h3 data-id="heading-11">最佳实践</h3>
<p><strong>1. 只索引主要内容</strong></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- ✅ 推荐 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">main</span> <span class="hljs-attr">data-pagefind-body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">article</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">article</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
</code></pre>
<p><strong>2. 使用权重优化结果</strong></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">data-pagefind-weight</span>=<span class="hljs-string">"10"</span>&gt;</span>标题<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">data-pagefind-weight</span>=<span class="hljs-string">"5"</span>&gt;</span>摘要<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
</code></pre>
<p><strong>3. CLI 参数配置</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 排除选择器</span>
pagefind --<span class="hljs-built_in">source</span> <span class="hljs-string">"dist"</span> --exclude-selectors <span class="hljs-string">"nav"</span> --exclude-selectors <span class="hljs-string">"footer"</span>

<span class="hljs-comment"># 强制语言</span>
pagefind --<span class="hljs-built_in">source</span> <span class="hljs-string">"dist"</span> --force-language <span class="hljs-string">"zh-cn"</span>
</code></pre>
<h2 data-id="heading-12">配置参考</h2>
<h3 data-id="heading-13">HTML 属性</h3>

































<table><thead><tr><th>属性</th><th>说明</th></tr></thead><tbody><tr><td><code>data-pagefind-body</code></td><td>标记要索引的主要内容区域</td></tr><tr><td><code>data-pagefind-ignore</code></td><td>排除该元素及其子元素</td></tr><tr><td><code>data-pagefind-meta</code></td><td>添加自定义元数据</td></tr><tr><td><code>data-pagefind-filter</code></td><td>定义可过滤的字段</td></tr><tr><td><code>data-pagefind-sort</code></td><td>定义可排序的字段</td></tr><tr><td><code>data-pagefind-weight</code></td><td>设置内容权重（1-10）</td></tr></tbody></table>
<h3 data-id="heading-14">JavaScript API</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 高级搜索</span>
<span class="hljs-keyword">const</span> search = <span class="hljs-keyword">await</span> pagefind.<span class="hljs-title function_">search</span>(<span class="hljs-string">"React"</span>, {
  <span class="hljs-attr">filters</span>: { <span class="hljs-attr">category</span>: <span class="hljs-string">"tutorial"</span> },
  <span class="hljs-attr">sort</span>: { <span class="hljs-attr">date</span>: <span class="hljs-string">"desc"</span> },
  <span class="hljs-attr">limit</span>: <span class="hljs-number">10</span>
});

<span class="hljs-comment">// 获取结果</span>
<span class="hljs-keyword">const</span> results = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(
  search.<span class="hljs-property">results</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> r.<span class="hljs-title function_">data</span>())
);
</code></pre>
<h2 data-id="heading-15">原理深度解析</h2>
<h3 data-id="heading-16">整体架构</h3>
<p>首先通过架构图了解 Pagefind 的整体设计：</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph "构建阶段 Build Time"
        A[HTML 文件] --&gt; B[内容扫描器]
        B --&gt; C[内容提取器]
        C --&gt; D[多语言分词器]
        D --&gt; E[倒排索引构建器]
        E --&gt; F[索引分片器]
        F --&gt; G[压缩引擎]
        G --&gt; H[索引文件]
    end

    subgraph "运行阶段 Runtime"
        I[用户查询] --&gt; J[查询分词]
        J --&gt; K[哈希计算]
        K --&gt; L[按需加载器]
        H --&gt; L
        L --&gt; M[索引查询]
        M --&gt; N[TF-IDF 评分]
        N --&gt; O[结果排序]
        O --&gt; P[内容片段加载]
        P --&gt; Q[摘要生成]
        Q --&gt; R[搜索结果]
    end

    subgraph "缓存层 Cache Layer"
        S[浏览器缓存]
        T[内存缓存]
        L -.-&gt; S
        L -.-&gt; T
    end

    style A fill:#e1f5ff
    style H fill:#e1f5ff
    style I fill:#fff3e0
    style R fill:#fff3e0
</code></pre>
<h3 data-id="heading-17">索引构建过程</h3>
<p>Pagefind 的工作流程可以分为两个阶段：<strong>构建时索引</strong>和<strong>运行时搜索</strong>。</p>
<h4 data-id="heading-18">1. 构建时索引（Build Time）</h4>
<p>当你运行 <code>pagefind --source "dist"</code> 时，Pagefind 会执行以下步骤：</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    Start([开始构建]) --&gt; Scan[扫描 HTML 文件]
    Scan --&gt; Parse[解析 HTML DOM]
    Parse --&gt; Extract[提取内容]

    Extract --&gt; CheckBody{检查 data-pagefind-body}
    CheckBody --&gt;|找到| UseBody[使用标记的内容]
    CheckBody --&gt;|未找到| UseDefault[使用 body 全部内容]

    UseBody --&gt; Filter[应用排除规则]
    UseDefault --&gt; Filter

    Filter --&gt; Meta[提取元数据]
    Meta --&gt; Tokenize[文本分词]

    Tokenize --&gt; CheckLang{检测语言}
    CheckLang --&gt;|英文| EnTokenizer[英文分词器]
    CheckLang --&gt;|中文| ZhTokenizer[中文分词器 n-gram]
    CheckLang --&gt;|其他| OtherTokenizer[对应语言分词器]

    EnTokenizer --&gt; BuildIndex[构建倒排索引]
    ZhTokenizer --&gt; BuildIndex
    OtherTokenizer --&gt; BuildIndex

    BuildIndex --&gt; CalcWeight[计算词条权重]
    CalcWeight --&gt; Shard[索引分片 256个桶]

    Shard --&gt; Compress[压缩处理]
    Compress --&gt; GenFragment[生成内容片段]
    GenFragment --&gt; WriteFiles[写入文件]

    WriteFiles --&gt; Output[输出到 pagefind/]
    Output --&gt; End([构建完成])

    style Start fill:#90EE90
    style End fill:#FFB6C1
    style BuildIndex fill:#FFE4B5
    style Compress fill:#E0FFFF
</code></pre>
<p><strong>关键技术点：</strong></p>
<ul>
<li><strong>倒排索引</strong>：对于每个词条，记录它出现在哪些文档的哪些位置</li>
<li><strong>分片存储</strong>：将索引拆分成小块，按需加载（使用一致性哈希算法分配到 256 个桶）</li>
<li><strong>压缩算法</strong>：使用高效的压缩减少文件大小</li>
</ul>
<p><strong>索引结构详解：</strong></p>
<pre><code class="hljs language-python" lang="python">pagefind/
├── pagefind.js           <span class="hljs-comment"># 核心搜索引擎（~20KB）</span>
│                         <span class="hljs-comment"># - 包含哈希函数</span>
│                         <span class="hljs-comment"># - 索引加载器</span>
│                         <span class="hljs-comment"># - 搜索算法</span>
│
├── pagefind-ui.js        <span class="hljs-comment"># UI 组件（~15KB）</span>
├── pagefind-ui.css       <span class="hljs-comment"># 样式文件（~3KB）</span>
│
├── index/                <span class="hljs-comment"># 索引分片（256 个）</span>
│   ├── index_00.pf       <span class="hljs-comment"># 哈希值 0x00-0x00</span>
│   ├── index_01.pf       <span class="hljs-comment"># 哈希值 0x01-0x01</span>
│   ├── ...
│   └── index_ff.pf       <span class="hljs-comment"># 哈希值 0xFF-0xFF</span>
│
├── fragment/             <span class="hljs-comment"># 内容片段</span>
│   ├── en_&lt;<span class="hljs-built_in">hash</span>&gt;.pf      <span class="hljs-comment"># 英文页面片段</span>
│   ├── zh_&lt;<span class="hljs-built_in">hash</span>&gt;.pf      <span class="hljs-comment"># 中文页面片段</span>
│   └── ...
│
└── <span class="hljs-built_in">filter</span>/               <span class="hljs-comment"># 过滤器数据（如果使用）</span>
    ├── category.pf
    └── tags.pf
</code></pre>
<h4 data-id="heading-19">2. 运行时搜索（Runtime）</h4>
<p>当用户输入搜索查询时的完整时序：</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    actor User as 用户
    participant UI as 搜索界面
    participant Core as Pagefind 核心
    participant Cache as 浏览器缓存
    participant Server as 静态服务器

    User-&gt;&gt;UI: 输入 "React 教程"
    UI-&gt;&gt;UI: 防抖延迟 (300ms)

    UI-&gt;&gt;Core: search("React 教程")
    Core-&gt;&gt;Core: 分词 ["React", "教程"]

    par 并行计算哈希
        Core-&gt;&gt;Core: hash("React") = 0x42
        Core-&gt;&gt;Core: hash("教程") = 0xA7
    end

    par 并行加载索引分片
        Core-&gt;&gt;Cache: 检查 index_42.pf
        Cache--&gt;&gt;Core: 缓存未命中
        Core-&gt;&gt;Server: GET /pagefind/index/index_42.pf
        Server--&gt;&gt;Core: 返回索引数据 (5KB)

        Core-&gt;&gt;Cache: 检查 index_a7.pf
        Cache--&gt;&gt;Core: 缓存命中
        Cache--&gt;&gt;Core: 返回缓存数据
    end

    Core-&gt;&gt;Core: 解析索引分片
    Core-&gt;&gt;Core: 查找匹配文档&lt;br/&gt;"React": [1,5,23]&lt;br/&gt;"教程": [1,8,15]&lt;br/&gt;交集: [1]

    Core-&gt;&gt;Core: 计算 TF-IDF 得分
    Core-&gt;&gt;Core: 排序结果

    Core-&gt;&gt;Cache: 检查 fragment_1.pf
    Cache--&gt;&gt;Core: 缓存未命中
    Core-&gt;&gt;Server: GET /pagefind/fragment/zh_1.pf
    Server--&gt;&gt;Core: 返回内容片段 (12KB)

    Core-&gt;&gt;Core: 提取摘要&lt;br/&gt;高亮关键词
    Core-&gt;&gt;Core: 生成结果对象

    Core--&gt;&gt;UI: 返回搜索结果
    UI-&gt;&gt;UI: 渲染结果列表
    UI--&gt;&gt;User: 显示搜索结果

    Note over Core,Server: 总耗时: ~80ms&lt;br/&gt;网络请求: 2 个 (17KB)&lt;br/&gt;缓存命中: 1 个
</code></pre>
<p><strong>性能分析：</strong></p>


















































<table><thead><tr><th>阶段</th><th>耗时</th><th>说明</th></tr></thead><tbody><tr><td>用户输入 + 防抖</td><td>300ms</td><td>等待用户完成输入</td></tr><tr><td>分词 + 哈希计算</td><td>&lt;5ms</td><td>纯计算，无 I/O</td></tr><tr><td>加载索引分片</td><td>20-50ms</td><td>取决于网络和缓存</td></tr><tr><td>索引查询 + 评分</td><td>5-10ms</td><td>纯内存操作</td></tr><tr><td>加载内容片段</td><td>15-30ms</td><td>取决于网络和缓存</td></tr><tr><td>摘要生成 + 渲染</td><td>5-10ms</td><td>DOM 操作</td></tr><tr><td><strong>总计（首次）</strong></td><td><strong>~80ms</strong></td><td>不含防抖延迟</td></tr><tr><td><strong>总计（缓存）</strong></td><td><strong>~25ms</strong></td><td>索引和片段均已缓存</td></tr></tbody></table>
<h3 data-id="heading-20">核心技术解析</h3>
<h4 data-id="heading-21">1. 按需加载机制</h4>
<p>Pagefind 最大的创新是<strong>渐进式加载</strong>。传统的客户端搜索（如 Lunr.js）需要加载完整索引：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 传统方案：需要加载整个索引</span>
<span class="hljs-comment">// 假设网站有 1000 个页面，索引文件可能有 5MB</span>
<span class="hljs-keyword">await</span> <span class="hljs-title function_">loadFullIndex</span>(); <span class="hljs-comment">// 加载 5MB</span>
<span class="hljs-title function_">search</span>(<span class="hljs-string">"React"</span>);
</code></pre>
<p>Pagefind 的方案：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Pagefind：按需加载</span>
<span class="hljs-title function_">search</span>(<span class="hljs-string">"React"</span>);
<span class="hljs-comment">// 1. 根据 "React" 计算哈希 -&gt; 只加载包含 "React" 的索引分片（可能只有 10KB）</span>
<span class="hljs-comment">// 2. 找到匹配的文档 ID</span>
<span class="hljs-comment">// 3. 只加载这些文档的内容片段（可能 20KB）</span>
<span class="hljs-comment">// 总共只需要下载 30KB，而不是 5MB</span>
</code></pre>
<p><strong>实现原理：</strong></p>
<pre><code class="hljs language-bash" lang="bash">查询词 <span class="hljs-string">"React"</span>
    ↓
计算哈希：<span class="hljs-built_in">hash</span>(<span class="hljs-string">"React"</span>) = 0x3A7F
    ↓
确定分片：0x3A7F % 256 = 127
    ↓
加载：GET /pagefind/index/index_127.pf
    ↓
解析分片，找到文档 ID: [5, 23, 87]
    ↓
加载内容：GET /pagefind/fragment/en_005.pf
</code></pre>
<h4 data-id="heading-22">2. 倒排索引结构</h4>
<p>倒排索引是搜索引擎的核心数据结构：</p>
<pre><code class="hljs language-arduino" lang="arduino">正向索引（文档 → 词条）：
文档<span class="hljs-number">1</span>: [<span class="hljs-string">"React"</span>, <span class="hljs-string">"教程"</span>, <span class="hljs-string">"入门"</span>]
文档<span class="hljs-number">2</span>: [<span class="hljs-string">"Vue"</span>, <span class="hljs-string">"教程"</span>, <span class="hljs-string">"进阶"</span>]
文档<span class="hljs-number">3</span>: [<span class="hljs-string">"React"</span>, <span class="hljs-string">"进阶"</span>, <span class="hljs-string">"Hooks"</span>]

倒排索引（词条 → 文档）：
<span class="hljs-string">"React"</span>  → [文档<span class="hljs-number">1</span>, 文档<span class="hljs-number">3</span>]
<span class="hljs-string">"Vue"</span>    → [文档<span class="hljs-number">2</span>]
<span class="hljs-string">"教程"</span>   → [文档<span class="hljs-number">1</span>, 文档<span class="hljs-number">2</span>]
<span class="hljs-string">"入门"</span>   → [文档<span class="hljs-number">1</span>]
<span class="hljs-string">"进阶"</span>   → [文档<span class="hljs-number">2</span>, 文档<span class="hljs-number">3</span>]
<span class="hljs-string">"Hooks"</span>  → [文档<span class="hljs-number">3</span>]
</code></pre>
<p>当搜索 "React 教程" 时：</p>
<ol>
<li>查找 "React" → [文档1, 文档3]</li>
<li>查找 "教程" → [文档1, 文档2]</li>
<li>取交集 → [文档1]</li>
</ol>
<h4 data-id="heading-23">3. TF-IDF 相关性评分</h4>
<p>Pagefind 使用 TF-IDF 算法计算搜索结果的相关性：</p>
<p><strong>TF（词频）</strong>：词条在文档中出现的频率</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">TF</span>(t, d) = 词条 t 在文档 d 中出现的次数 / 文档 d 的总词数
</code></pre>
<p><strong>IDF（逆文档频率）</strong>：词条的稀有程度</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">IDF</span>(t) = <span class="hljs-built_in">log</span>(总文档数 / 包含词条 t 的文档数)
</code></pre>
<p><strong>TF-IDF 得分</strong>：</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">TF-IDF</span>(t, d) = <span class="hljs-built_in">TF</span>(t, d) × <span class="hljs-built_in">IDF</span>(t)
</code></pre>
<p><strong>示例计算：</strong></p>
<p>假设我们有 100 个文档，搜索 "React Hooks"：</p>
<pre><code class="hljs language-scss" lang="scss">文档<span class="hljs-selector-tag">A</span>：
- "React" 出现 <span class="hljs-number">10</span> 次，文档总词数 <span class="hljs-number">100</span>
  <span class="hljs-built_in">TF</span>("React", A) = <span class="hljs-number">10</span>/<span class="hljs-number">100</span> = <span class="hljs-number">0.1</span>
  包含 "React" 的文档有 <span class="hljs-number">30</span> 个
  <span class="hljs-built_in">IDF</span>("React") = <span class="hljs-built_in">log</span>(<span class="hljs-number">100</span>/<span class="hljs-number">30</span>) = <span class="hljs-number">0.52</span>
  <span class="hljs-built_in">TF-IDF</span>("React", A) = <span class="hljs-number">0.1</span> × <span class="hljs-number">0.52</span> = <span class="hljs-number">0.052</span>

- "Hooks" 出现 <span class="hljs-number">5</span> 次
  <span class="hljs-built_in">TF</span>("Hooks", A) = <span class="hljs-number">5</span>/<span class="hljs-number">100</span> = <span class="hljs-number">0.05</span>
  包含 "Hooks" 的文档有 <span class="hljs-number">5</span> 个
  <span class="hljs-built_in">IDF</span>("Hooks") = <span class="hljs-built_in">log</span>(<span class="hljs-number">100</span>/<span class="hljs-number">5</span>) = <span class="hljs-number">1.30</span>
  <span class="hljs-built_in">TF-IDF</span>("Hooks", A) = <span class="hljs-number">0.05</span> × <span class="hljs-number">1.30</span> = <span class="hljs-number">0.065</span>

文档<span class="hljs-selector-tag">A</span> 总分 = <span class="hljs-number">0.052</span> + <span class="hljs-number">0.065</span> = <span class="hljs-number">0.117</span>
</code></pre>
<p>"Hooks" 更稀有，所以权重更高。</p>
<h4 data-id="heading-24">4. 多语言分词</h4>
<p>Pagefind 内置了多种语言的分词器：</p>
<p><strong>英文分词</strong>（基于空格和标点）：</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-string">"Hello, world!"</span> → [<span class="hljs-string">"hello"</span>, <span class="hljs-string">"world"</span>]
</code></pre>
<p><strong>中文分词</strong>（基于字典和统计）：</p>
<pre><code class="hljs language-css" lang="css">"自然语言处理" → <span class="hljs-selector-attr">[<span class="hljs-string">"自然"</span>, <span class="hljs-string">"语言"</span>, <span class="hljs-string">"处理"</span>]</span>
或 → <span class="hljs-selector-attr">[<span class="hljs-string">"自然语言"</span>, <span class="hljs-string">"处理"</span>]</span>
或 → <span class="hljs-selector-attr">[<span class="hljs-string">"自然语言处理"</span>]</span>
</code></pre>
<p>Pagefind 使用 <strong>n-gram</strong> 技术处理 CJK 文本：</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-string">"搜索引擎"</span> → [<span class="hljs-string">"搜索"</span>, <span class="hljs-string">"搜索引"</span>, <span class="hljs-string">"搜索引擎"</span>, <span class="hljs-string">"索引"</span>, <span class="hljs-string">"索引擎"</span>, <span class="hljs-string">"引擎"</span>]
</code></pre>
<p>这样即使查询 "搜索" 或 "引擎"，也能匹配到 "搜索引擎"。</p>
<h3 data-id="heading-25">性能优化技术</h3>
<p>Pagefind 通过多种技术实现高性能：</p>
<p><strong>索引压缩</strong>（原始 10MB → 500KB，压缩率 95%）：</p>
<ul>
<li>去除 HTML 标签和属性</li>
<li>词干提取（stemming）："running" → "run"</li>
<li>停用词过滤（去除 "the", "a", "is" 等常见词）</li>
<li>增量编码 + Gzip 压缩</li>
</ul>
<p><strong>并行加载</strong>：
支持 HTTP/2 多路复用，多个词条的索引分片并行加载，总耗时 = max(单个加载时间)。</p>
<h3 data-id="heading-26">技术内幕深度剖析</h3>
<h4 data-id="heading-27">1. 核心算法实现</h4>
<p>Pagefind 是用 Rust 编写并编译为 WASM，核心逻辑包括：</p>
<p><strong>哈希计算</strong>（FNV-1a 算法）：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 词条归一化（转小写、去除特殊字符）→ FNV-1a 哈希 → 映射到 0-255</span>
<span class="hljs-title function_">hash</span>(<span class="hljs-string">"React"</span>) = <span class="hljs-number">0x42</span> (<span class="hljs-number">66</span>)
<span class="hljs-title function_">hash</span>(<span class="hljs-string">"react"</span>) = <span class="hljs-number">0x42</span> (<span class="hljs-number">66</span>)  <span class="hljs-comment">// 大小写不敏感</span>
</code></pre>
<p><strong>索引加载器</strong>：</p>
<ol>
<li>计算词条哈希 → 确定分片编号</li>
<li>检查内存缓存 → 未命中则加载对应的 .pf 文件</li>
<li>解析二进制格式 → 存入缓存</li>
<li>返回词条对应的文档 ID 列表</li>
</ol>
<p><strong>TF-IDF 评分器</strong>：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 计算每个文档的相关性得分</span>
score = Σ(<span class="hljs-variable constant_">TF</span> × <span class="hljs-variable constant_">IDF</span> × weight) × lengthNorm
<span class="hljs-comment">// - TF: 词频</span>
<span class="hljs-comment">// - IDF: 逆文档频率（缓存优化）</span>
<span class="hljs-comment">// - weight: 自定义权重</span>
<span class="hljs-comment">// - lengthNorm: 长度归一化（防止长文档占优）</span>
</code></pre>
<h4 data-id="heading-28">2. .pf 文件格式</h4>
<p>Pagefind 使用自定义的 <code>.pf</code>（Pagefind Format）二进制格式：</p>
<p><strong>索引文件（index_XX.pf）</strong>：</p>
<ul>
<li>Header：Magic Number (0x5046 'PF') + 版本 + 标志 + 条目数</li>
<li>Entries：每个词条 → 文档 ID 列表（增量编码）</li>
</ul>
<p>示例：<code>"React" → [1, 5, 23]</code> 存储为 <code>[1, +4, +18]</code></p>
<p><strong>内容片段（fragment_XX.pf）</strong>：</p>
<ul>
<li>Header：Magic Number + 压缩类型 + 文档 ID + 长度</li>
<li>Metadata：JSON 格式（title, url, excerpt 等）</li>
<li>Content：原始文本 + 词条位置映射</li>
</ul>
<h4 data-id="heading-29">3. 四层压缩策略</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[原始数据&lt;br/&gt;100KB] --&gt; B[增量编码&lt;br/&gt;50KB]
    B --&gt; C[VarInt 编码&lt;br/&gt;40KB]
    C --&gt; D[词干提取&lt;br/&gt;30KB]
    D --&gt; E[Gzip 压缩&lt;br/&gt;25KB]

    style E fill:#90EE90
</code></pre>
<p><strong>Level 1: 增量编码（Delta Encoding）</strong></p>
<ul>
<li>文档 ID <code>[1, 5, 23, 45]</code> → <code>[1, +4, +18, +22]</code></li>
<li>节省 50% 存储空间</li>
</ul>
<p><strong>Level 2: 变长整数编码（VarInt）</strong></p>
<ul>
<li>小数字用 1 字节，大数字自动扩展</li>
<li><code>1 → [0x01]</code>，<code>128 → [0x80, 0x01]</code></li>
</ul>
<p><strong>Level 3: 词干提取（Stemming）</strong></p>
<ul>
<li>"running", "runs", "runner" → "run"</li>
<li>减少唯一词条数量 30-40%</li>
</ul>
<p><strong>Level 4: Gzip 压缩</strong></p>
<ul>
<li>文本压缩率 60-80%</li>
<li>最终实现 95% 总压缩率</li>
</ul>
<h4 data-id="heading-30">4. 三层缓存架构</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[搜索请求] --&gt; B{L1 内存缓存}
    B --&gt;|命中| C[返回结果]
    B --&gt;|未命中| D{L2 HTTP 缓存}
    D --&gt;|命中| C
    D --&gt;|未命中| E{L3 Service Worker}
    E --&gt;|命中| C
    E --&gt;|未命中| F[网络请求]
    F --&gt; G[更新所有缓存]
    G --&gt; C

    style B fill:#FFE4B5
    style D fill:#E0FFFF
    style E fill:#F0E68C
</code></pre>



































<table><thead><tr><th>缓存层级</th><th>命中延迟</th><th>容量</th><th>适用场景</th></tr></thead><tbody><tr><td><strong>L1 内存缓存</strong></td><td>&lt;1ms</td><td>~10MB</td><td>频繁访问的索引（LRU 淘汰）</td></tr><tr><td><strong>L2 HTTP 缓存</strong></td><td>~5ms</td><td>~100MB</td><td>已访问的所有索引（Cache-Control）</td></tr><tr><td><strong>L3 Service Worker</strong></td><td>~10ms</td><td>~50MB</td><td>离线访问（可选）</td></tr><tr><td><strong>网络请求</strong></td><td>50-200ms</td><td>-</td><td>首次访问</td></tr></tbody></table>
<p><strong>性能提升</strong>：</p>
<ul>
<li>首次搜索：~80ms</li>
<li>后续搜索（缓存命中）：~25ms</li>
<li>离线模式：~25ms</li>
</ul>
<p><strong>服务器配置</strong>（Nginx）：</p>
<pre><code class="hljs language-nginx" lang="nginx">location /pagefind/ {
    add_header Cache-Control "public, max-age=31536000, immutable";
    gzip on;
}
</code></pre>
<h2 data-id="heading-31">性能对比</h2>

































<table><thead><tr><th>方案</th><th>初次加载</th><th>索引大小 (1000页)</th><th>搜索速度</th><th>离线支持</th></tr></thead><tbody><tr><td><strong>Pagefind</strong></td><td>~20KB</td><td>~500KB</td><td>&lt;50ms</td><td>✅</td></tr><tr><td>Algolia</td><td>0 (CDN)</td><td>N/A</td><td>&lt;10ms</td><td>❌</td></tr><tr><td>Lunr.js</td><td>~30KB</td><td>~3MB</td><td>~100ms</td><td>✅</td></tr></tbody></table>
<p><strong>实际数据</strong>（500 页文档网站）：</p>
<ul>
<li>首次搜索：下载 45KB，耗时 ~80ms</li>
<li>后续搜索：下载 10KB，耗时 ~25ms</li>
<li>对比 Lunr.js：减少 97% 的下载量</li>
</ul>
<h2 data-id="heading-32">常见问题</h2>
<p><strong>Q: Pagefind 与 Algolia 如何选择？</strong></p>
<ul>
<li>Pagefind：中小型网站（&lt; 10,000 页）、免费、离线支持、重视隐私</li>
<li>Algolia：大型网站、高级功能、极致速度、付费</li>
</ul>
<p><strong>Q: 支持哪些框架？</strong>
框架无关，支持 VitePress、Docusaurus、Hugo、Jekyll、Astro、Next.js（SSG）等任何生成 HTML 的工具。</p>
<p><strong>Q: 是否影响 SEO？</strong>
不影响。Pagefind 的搜索 UI 是客户端渲染的，原始 HTML 内容完全不受影响。</p>
<p><strong>Q: 如何更新索引？</strong>
每次构建时重新生成索引。在 CI/CD 中使用 <code>postbuild</code> 脚本自动化。</p>
<h2 data-id="heading-33">总结</h2>
<p>Pagefind 为静态网站提供了轻量、高性能的搜索方案：</p>
<ul>
<li>✅ <strong>轻量级</strong>：核心 20KB，按需加载</li>
<li>✅ <strong>高性能</strong>：搜索响应 &lt; 50ms</li>
<li>✅ <strong>零配置</strong>：开箱即用</li>
<li>✅ <strong>完全静态</strong>：无需服务器，支持离线</li>
<li>✅ <strong>多语言</strong>：内置 CJK 分词</li>
</ul>
<h3 data-id="heading-34">核心原理</h3>
<ol>
<li><strong>倒排索引 + 分片</strong>：将索引拆分成 256 个小块</li>
<li><strong>按需加载</strong>：根据查询词哈希值只加载相关分片</li>
<li><strong>TF-IDF 评分</strong>：计算相关性智能排序</li>
<li><strong>多语言分词</strong>：支持中英文等智能分词</li>
</ol>
<h2 data-id="heading-35">相关资源</h2>
<ul>
<li>官方文档：<a href="https://link.juejin.cn?target=https%3A%2F%2Fpagefind.app%2Fdocs%2F" target="_blank" title="https://pagefind.app/docs/" ref="nofollow noopener noreferrer">pagefind.app/docs/</a></li>
<li>GitHub：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCloudCannon%2Fpagefind" target="_blank" title="https://github.com/CloudCannon/pagefind" ref="nofollow noopener noreferrer">github.com/CloudCannon…</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[团队用 Skills 总对不上？一个 manifest 搞定共享与锁定]]></title>    <link>https://juejin.cn/post/7602100217657507882</link>    <guid>https://juejin.cn/post/7602100217657507882</guid>    <pubDate>2026-02-02T13:10:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602100217657507882" data-draft-id="7602133814144647187" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="团队用 Skills 总对不上？一个 manifest 搞定共享与锁定"/> <meta itemprop="keywords" content="后端,前端"/> <meta itemprop="datePublished" content="2026-02-02T13:10:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Mr_Mao"/> <meta itemprop="url" content="https://juejin.cn/user/1099167361152967"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            团队用 Skills 总对不上？一个 manifest 搞定共享与锁定
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1099167361152967/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Mr_Mao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T13:10:49.000Z" title="Mon Feb 02 2026 13:10:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>用 Cursor 的都知道，Skills 能按项目挂一堆「技能」让 AI 按规则干活。但官方 <code>skills add</code> 不会往项目里写配置，换一台机器、换一个人，就得重新加一遍，谁装了啥谁也说不清。所以我写了个 <strong>skills-manifest</strong>，用一份 <code>skills-manifest.json</code> 把要用的技能作为清单存在项目里，<code>install</code> 一把同步，团队协作终于能对上号了。</p>
<hr/>
<h2 data-id="heading-0">痛点：Skills 没有「项目级 lock」</h2>
<p>Skills 本身是按「当前用户 + 当前目录」装的，技能会落到 <code>.cursor/skills/</code> 之类的地方，但<strong>不会</strong>在项目里生成类似 <code>package.json</code> 的清单。结果是：</p>
<ul>
<li>你 <code>skills add vercel-labs/agent-skills</code>，同事 clone 下来没有这段配置，装的技能和你不一样；</li>
<li>换电脑或重装，得靠记忆或文档再 add 一遍；</li>
<li>多人协作时，大家到底用了哪几个 skill、给哪些 agent 用，没有单一事实来源。</li>
</ul>
<p>所以需要两件事：<strong>声明要装啥</strong>（manifest）和 <strong>按声明一键安装</strong>（install）。skills-manifest 干的就是这个。</p>
<hr/>
<h2 data-id="heading-1">skills-manifest 是啥</h2>
<p><strong>skills-manifest 是 skills 的项目级清单管理器</strong>。只需要维护一个 <code>skills-manifest.json</code>，里面写好「从哪个仓库装哪些 skill、给哪些 agent 用」，在项目里跑一次 <code>skills-manifest install</code>，就会按这份清单调 <code>skills add</code>，并把结果同步到 Cursor/Claude Code 等目录。这样所有人 <code>pnpm i</code> 之后跑一遍 install，技能就一致了。</p>
<hr/>
<h2 data-id="heading-2">从零开始：init</h2>
<p>在项目根目录执行：</p>
<pre><code class="hljs language-bash" lang="bash">npx skills-manifest init
</code></pre>
<p>它会帮你：</p>
<ol>
<li>把 <code>skills</code> 和 <code>skills-manifest</code> 装进 devDependencies；</li>
<li>若没有 <code>skills-manifest.json</code>，生成一份带默认 <code>agents</code> 的模板；</li>
<li>在 <code>.gitignore</code> 里加上 <code>skills</code>（避免把拉下来的 skill 源码也提交）；</li>
<li>在 <code>package.json</code> 的 <code>scripts.prepare</code> 里加上 <code>skills-manifest install</code>，这样别人 <code>pnpm i</code> 之后会自动按 manifest 装一遍技能。</li>
</ol>
<p>不想用 init 也可以手装：<code>pnpm add skills skills-manifest -D</code>，再自己建 <code>skills-manifest.json</code> 和改 <code>prepare</code>。</p>
<h2 data-id="heading-3">跟之前一样 npx skills  添加项目的 skills</h2>
<p>装好并跑过 <code>skills-manifest install</code> 之后，你只需要照常使用 <strong><code>npx skills add &lt;repo&gt;</code></strong>（或 <code>pnpx skills add &lt;repo&gt;</code>）往项目里加 skill。就会自动同步到 <code>skills-manifest.json</code>，团队其他人下次 <code>pnpm i</code> 就能拉到同样的技能。</p>
<hr/>
<h2 data-id="heading-4">配置长什么样</h2>
<p><code>skills-manifest.json</code> 里主要两块：<strong>agents</strong> 和 <strong>skills</strong>。</p>
<ul>
<li><strong>agents</strong>：要同步到的 AI 客户端，比如 <code>cursor</code>、<code>claude-code</code>。install 时会把这些 agent 对应的目录（如 <code>.cursor</code>、<code>.opencode</code>）从 <code>.agents</code> 同步过去。</li>
<li><strong>skills</strong>：按「仓库」为 key，value 有三种写法：
<ul>
<li>数组：只装列出的 skill 名，例如 <code>["find-skills"]</code>；</li>
<li>对象：<code>{ "skill-a": true, "skill-b": false }</code>，只装值为 <code>true</code> 的；</li>
<li><code>true</code>：该仓库下所有 skill 都装。</li>
</ul>
</li>
</ul>
<p>示例：</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"$schema"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://raw.githubusercontent.com/hairyf/skills-manifest/main/skills-manifest.schema.json"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"agents"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"cursor"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"claude-code"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"skills"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"vercel-labs/skills"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"find-skills"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"vercel-labs/agent-skills"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"vercel-composition-patterns"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"vercel-react-best-practices"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>仓库可以用短名（如 <code>vercel-labs/skills</code>）或完整 URL（如 <code>https://github.com/vercel-labs/skills</code>）。配好之后，在项目里执行：</p>
<pre><code class="hljs language-bash" lang="bash">pnpm <span class="hljs-built_in">exec</span> skills-manifest install
</code></pre>
<p>就会按这份清单依次 <code>skills add</code>，并把 <code>.agents</code> 同步到 <code>.cursor</code>、<code>.opencode</code> 等，这样 Cursor 和 Claude Code 用的就是同一套技能。</p>
<p>此外，<strong>install 会在 <code>node_modules/skills</code> 里注入一个包装脚本</strong>，让本机的 <code>skills</code> 命令和 manifest 双向同步：</p>
<ul>
<li>你跑 <strong><code>skills add &lt;repo&gt; [--skill ...]</code></strong> 时，包装会顺带执行 <strong><code>skills-manifest add &lt;repo&gt; [...]</code></strong>，把仓库和技能写进 <code>skills-manifest.json</code>；</li>
<li>你跑 <strong><code>skills remove &lt;技能名...&gt;</code></strong> 时，包装会按 manifest 里哪些 repo 含有这些技能，对每个 repo 执行 <strong><code>skills-manifest remove &lt;repo&gt; &lt;技能名...&gt;</code></strong>，从 manifest 里删掉对应项。</li>
</ul>
<p>如果只想临时加一个 skill、<strong>不写进 manifest</strong>，可以加 <code>--skip-manifest</code>：</p>
<pre><code class="hljs language-bash" lang="bash">skills add &lt;repo&gt; --skip-manifest
</code></pre>
<p>这样团队既可以用 manifest 一把同步，也可以平时直接用 <code>skills add</code>/<code>remove</code>，manifest 自动跟着更新。</p>
<hr/>
<h2 data-id="heading-5">和 OpenSkills / AGENTS.md 搭配用（可选）</h2>
<p>如果你希望 AI 客户端不仅能「装」技能，还能「看到」项目里有哪些技能、干什么用，可以配合 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnumman-ali%2Fopenskills" target="_blank" title="https://github.com/numman-ali/openskills" ref="nofollow noopener noreferrer">OpenSkills</a> 用。先按上面步骤用 skills-manifest 装好技能，再在项目里跑：</p>
<pre><code class="hljs language-bash" lang="bash">npx openskills <span class="hljs-built_in">sync</span>
</code></pre>
<p>OpenSkills 会根据当前安装的 skills 生成或更新 <code>AGENTS.md</code>（或你指定的文件），Claude Code、Cursor、Windsurf 等读这个文件就能发现并选用这些技能。这样「装」和「发现」就都齐了。</p>
<hr/>
<h2 data-id="heading-6">小结</h2>
<ul>
<li><strong>skills-manifest</strong> 用一份 <code>skills-manifest.json</code> 声明项目要用哪些 skills、给哪些 agents，<code>skills-manifest install</code> 按声明安装并同步到各客户端目录。</li>
<li><strong>install 会注入包装</strong>：之后在本机用 <code>skills add</code> / <code>skills remove</code> 会自动同步到 manifest；</li>
<li>使用 <code>skills-manifest.json</code> 和 <code>prepare</code> 脚本，团队 clone 后 <code>pnpm i</code> 就能复现同一套技能，不再各装各的。</li>
<li>需要让 AI 读「项目里有哪些技能」时，可以再加一步 <code>npx openskills sync</code> 生成 AGENTS.md。</li>
</ul>
<p>如果你也在用 Cursor/Claude Code 做团队协作，可以试一下 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhairyf%2Fskills-manifest" target="_blank" title="https://github.com/hairyf/skills-manifest" ref="nofollow noopener noreferrer">skills-manifest</a>，觉得不错的点个小星星支持一下。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[使用 Docker 部署 SQL Server 并导入 .mdb 文件的完整指南]]></title>    <link>https://juejin.cn/post/7602133814144663571</link>    <guid>https://juejin.cn/post/7602133814144663571</guid>    <pubDate>2026-02-02T13:25:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602133814144663571" data-draft-id="7602162571379720198" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="使用 Docker 部署 SQL Server 并导入 .mdb 文件的完整指南"/> <meta itemprop="keywords" content="SQL Server"/> <meta itemprop="datePublished" content="2026-02-02T13:25:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="修己xj"/> <meta itemprop="url" content="https://juejin.cn/user/2641475936724142"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            使用 Docker 部署 SQL Server 并导入 .mdb 文件的完整指南
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2641475936724142/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    修己xj
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T13:25:25.000Z" title="Mon Feb 02 2026 13:25:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>最近在项目中遇到一个需求，需要从 .mdb 文件中提取特定数据并导入到现有系统数据库中。当现场同事将 .mdb 文件发给我后，我首先尝试在本地打开以查看数据结构，但试了多种方法都未能成功——原生的 Microsoft Access 需要付费激活，其他各类工具也均告失败。后来在网上看到有网友建议可以将 .mdb 文件导入 SQL Server 数据库后再进行操作，于是灵机一动：部署一个 SQL Server 岂不是更直接？我便翻出之前 Docker 部署 SQL Server 的文档，结果发现相关镜像已不存在。于是，我重新查阅资料，整理了以下关于如何使用 Docker 部署 SQL Server 并导入 .mdb 文件的步骤。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d61f6113753c4cdd9ba3c816d0480b09~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770643525&amp;x-signature=nDLbibxjQDurxxEoTZ2Rof1zvVw%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">❓什么是.mdb文件？</h2>
<p>.mdb文件是Microsoft Access数据库文件，它是微软公司开发的一种专有数据库格式，主要用于其桌面关系数据库管理系统（RDBMS）——Microsoft Access。</p>
<p>主要用途：</p>
<ul>
<li>• 桌面数据库应用：适用于中小型业务的数据管理（如库存、客户信息）。</li>
<li>• 原型开发：快速构建数据库应用程序原型。</li>
<li>• 报表生成：创建和管理自定义报表。</li>
<li>• 与其他Office集成：可与Excel、Word等无缝连接。</li>
</ul>
<h2 data-id="heading-1">🐳Docker部署sql server数据库</h2>
<h3 data-id="heading-2">📋创建docker-compose.yml 文件</h3>
<p>首先创建一个部署目录<code>sqlserver</code>,在该目录下创建docker-compose.yml文件，内容如下：</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">services:</span>
  <span class="hljs-attr">sqlserver:</span>
    <span class="hljs-string">image:</span> <span class="hljs-string">mcr.microsoft.com/mssql/server:2025-latest</span>
    <span class="hljs-string">container_name:</span> <span class="hljs-string">mssql-server</span>
    <span class="hljs-string">restart:</span> <span class="hljs-string">always</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-comment">#接受最终用户许可协议</span>
      <span class="hljs-string">-</span> <span class="hljs-string">ACCEPT_EULA=Y</span>
      <span class="hljs-comment">#SA用户密码，密码长度必须至少为8个字符，并且包含以下四组中的三组字符：大写字母、小写字母、数字和符号。</span>
      <span class="hljs-string">-</span> <span class="hljs-string">SA_PASSWORD=Abcd1234</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-string">-</span> <span class="hljs-number">1433</span><span class="hljs-string">:1433</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-string">-</span> <span class="hljs-string">./mssql:/var/opt/mssql</span>
</code></pre>
<h3 data-id="heading-3">📂创建挂载目录并授权</h3>
<p>在docker-compose.yml同级目录下创建数据挂载目录<code>mssql</code>并授权</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 创建挂载目录</span>
<span class="hljs-built_in">mkdir</span> mssql
<span class="hljs-comment"># 赋权限</span>
<span class="hljs-built_in">chmod</span> -R 777  mssql
</code></pre>
<h3 data-id="heading-4">📚启动服务</h3>
<p>在docker-compose.yml同级目录下执行以下命令启动服务</p>
<pre><code class="hljs">docker-compose up -d 
</code></pre>
<p>如果启动过程中有报权限文档的错误<code>Access denied errno = 0xD(13) Permission denied]</code>时，给挂载目录赋权限之后再重新启动容器即可。</p>
<h3 data-id="heading-5">🚀连接数据库</h3>
<p>我连接数据库使用的时navicat,我记得旧版本还需要再安装目录下安装<code>qlncli</code>,但是新版本的<code>navicat</code>不用，直接连接即可.</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb5c9fb254c047e48f4e9fcbfc22d695~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770643525&amp;x-signature=53nYlJKc31Fvg1c%2B40%2Bzk%2FXsSwQ%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-6">⬆️将.mdb文件导入sql server数据库</h2>
<p>连接到sql server 数据库之后新建数据库，再<code>表</code>上右击导入向导，选择<code>MS Access数据库</code>,点击下一步，选择需要导入的表，将数据导入到sql server 中，然后按照正常的数据表就可以查看了。如果需要修改，则修改完之后再导出文件即可。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/60e057d8ce29460c805755c46f34a554~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770643525&amp;x-signature=0QfnKWR%2F32toobGI7RB8S9dpm5Q%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">📝总结</h2>
<p>通过 Docker 部署 SQL Server 并结合 Navicat 等工具，可以高效、灵活地处理 .mdb 文件，既避免了本地安装 Microsoft Access 的成本与限制，也便于在开发环境中进行数据迁移与转换。这种方法尤其适合需要临时或频繁处理 Access 数据的开发与运维场景，具备良好的可复现性与环境隔离性。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f79f857679664782ac438788f805f13c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770643525&amp;x-signature=3RPpvc0QY9NrGlGlDrbbOnLDliA%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[大数据-228 离线数仓 Flume Taildir + 自定义 Interceptor：从 JSON 提取时间戳写入 HDFS 分区]]></title>    <link>https://juejin.cn/post/7602098592677380150</link>    <guid>https://juejin.cn/post/7602098592677380150</guid>    <pubDate>2026-02-02T13:33:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602098592677380150" data-draft-id="7602133814144679955" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="大数据-228 离线数仓 Flume Taildir + 自定义 Interceptor：从 JSON 提取时间戳写入 HDFS 分区"/> <meta itemprop="keywords" content="后端,大数据,Apache Flume"/> <meta itemprop="datePublished" content="2026-02-02T13:33:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="武子康"/> <meta itemprop="url" content="https://juejin.cn/user/149189314230039"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            大数据-228 离线数仓 Flume Taildir + 自定义 Interceptor：从 JSON 提取时间戳写入 HDFS 分区
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/149189314230039/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    武子康
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T13:33:20.000Z" title="Mon Feb 02 2026 13:33:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读9分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">TL;DR</h2>
<ul>
<li>场景：多目录日志采集，按日志类型打 Header，并按事件时间落 HDFS 分区</li>
<li>结论：Taildir Source + 自定义 Interceptor 抽取 JSON 时间戳写 Header，HDFS Sink 依据 Header 路由与滚动</li>
<li>产出：一套可复用的“日志采集→Header 打标→按天分区落盘→生产 nohup 启动”落地模板</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c000bf6fd6b48b882fdcc6783015ada~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770643999&amp;x-signature=lLYRCW3JfeUt9FBec6wzCRYaL08%3D" alt="大数据-228 离线数仓 Flume Taildir + 自定义 Interceptor：从 JSON 提取时间戳写入 HDFS 分区" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9af386f8154b45d490e0217d338b15aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770643999&amp;x-signature=ysZNsvGWYkPtllcIU1%2BGdH6JSIE%3D" alt="离线数仓架构图" loading="lazy"/></p>
<h2 data-id="heading-1">日志数据采集小结</h2>
<h3 data-id="heading-2">（总结前置，下面是正文）</h3>
<p>在 Apache Flume 中，拦截器（Interceptor）是数据流管道的一个关键组件，它允许在事件（Event）进入 Flume Channel 之前对其进行修改或过滤。通过自定义拦截器，你可以实现特定的业务逻辑，如数据过滤、字段添加或修改、格式转换等。
自定义拦截器 是指用户根据需求自行编写 Java 代码来扩展 Flume 的功能，而不是使用默认的拦截器。</p>
<ul>
<li>使用 taildir source监控指定多个目录，可以给不同目录的日志加上不同Header</li>
<li>在每个目录上可以使用正则匹配多个文件</li>
<li>使用自定义拦截器，主要功能是从JSON串种获取时间戳，加到event的header中</li>
<li>hdfs sink使用event header中的信息写数据（控制写文件的位置）</li>
<li>hdfs文件的滚动方式（基于文件大小、基于event数量、基于时间）</li>
<li>调节Flume JVM内存的分配</li>
</ul>
<h3 data-id="heading-3">工作原理</h3>
<ul>
<li>
<p><strong>事件生成（Source）</strong>：
Flume 通过 Source 组件从各种外部系统采集数据。常见的 Source 类型包括：</p>
<ul>
<li><strong>Exec Source</strong>：通过执行指定命令（如 <code>tail -F</code> 日志文件）获取数据</li>
<li><strong>Spooling Directory Source</strong>：监控指定目录中的新文件</li>
<li><strong>NetCat Source</strong>：通过 TCP/UDP 端口接收数据</li>
<li><strong>Kafka Source</strong>：从 Kafka 主题消费消息
Source 会将采集到的原始数据封装为 Flume Event 对象，包含事件头和字节数组形式的负载数据。</li>
</ul>
</li>
<li>
<p><strong>拦截器（Interceptor）</strong>：
在事件进入 Channel 前，可以通过链式拦截器进行预处理：</p>
<ol>
<li><strong>Timestamp Interceptor</strong>：自动添加事件时间戳</li>
<li><strong>Host Interceptor</strong>：添加主机名或IP信息</li>
<li><strong>Regex Filtering Interceptor</strong>：基于正则表达式过滤事件</li>
<li><strong>Search-and-Replace Interceptor</strong>：修改事件内容</li>
<li><strong>自定义拦截器</strong>：实现特定业务逻辑处理
拦截器可以单个或多个串联使用，按配置顺序依次执行。</li>
</ol>
</li>
<li>
<p><strong>传输（Channel）</strong>：
作为事件缓冲区，保证可靠传输。主要类型：</p>
<ul>
<li><strong>Memory Channel</strong>：基于内存队列，性能高但可能丢失数据</li>
<li><strong>File Channel</strong>：持久化到本地文件系统，保证数据可靠性</li>
<li><strong>JDBC Channel</strong>：使用数据库存储事件</li>
<li><strong>Kafka Channel</strong>：集成 Kafka 作为存储后端
Channel 提供事务支持，确保事件在 Source 和 Sink 间可靠传递。</li>
</ul>
</li>
<li>
<p><strong>消费（Sink）</strong>：
负责将事件写入目标系统，常见实现：</p>
<ul>
<li><strong>HDFS Sink</strong>：写入 Hadoop 分布式文件系统</li>
<li><strong>HBase Sink</strong>：存入 HBase 数据库</li>
<li><strong>Kafka Sink</strong>：发布到 Kafka 主题</li>
<li><strong>File Roll Sink</strong>：写入本地文件系统</li>
<li><strong>Avro Sink</strong>：转发到其他 Flume Agent
Sink 支持批量写入和故障重试机制，可根据目标系统特性配置相应参数。</li>
</ul>
</li>
</ul>
<h3 data-id="heading-4">开发和部署注意事项</h3>
<ul>
<li>依赖管理： 开发自定义拦截器需要依赖 Flume 的核心库，如 flume-ng-core 和 flume-ng-sdk。</li>
<li>测试： 在本地测试拦截器逻辑，确保其功能正确，性能符合预期。</li>
<li>部署： 将 JAR 文件上传至 Flume Agent 的 lib 目录并重启 Flume 服务。</li>
<li>性能监控： 自定义拦截器可能会影响 Flume 的性能，尤其是在拦截逻辑复杂的情况下。建议在生产环境中监控资源使用情况。</li>
</ul>
<h2 data-id="heading-5">采集启动日志和事件日志</h2>
<p>上节我们完成了Agent 的配置，接来我们继续。</p>
<h3 data-id="heading-6">自定义拦截器</h3>
<p>编码完成后打包上传到服务器，放置在 $FLUME_HOME/lib</p>
<h4 data-id="heading-7">编写代码</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> icu.wzk;

<span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;
<span class="hljs-keyword">import</span> com.alibaba.fastjson.JSONArray;
<span class="hljs-keyword">import</span> com.alibaba.fastjson.JSONObject;
<span class="hljs-keyword">import</span> org.apache.flume.Context;
<span class="hljs-keyword">import</span> org.apache.flume.Event;
<span class="hljs-keyword">import</span> org.apache.flume.interceptor.Interceptor;

<span class="hljs-keyword">import</span> java.nio.charset.StandardCharsets;
<span class="hljs-keyword">import</span> java.time.Instant;
<span class="hljs-keyword">import</span> java.time.LocalDateTime;
<span class="hljs-keyword">import</span> java.time.ZoneId;
<span class="hljs-keyword">import</span> java.time.format.DateTimeFormatter;
<span class="hljs-keyword">import</span> java.util.ArrayList;
<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LogTypeInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Interceptor</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initialize</span><span class="hljs-params">()</span> {

    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Event <span class="hljs-title function_">intercept</span><span class="hljs-params">(Event event)</span> {
        <span class="hljs-comment">// 获取Event的body</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">eventBody</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(event.getBody(), StandardCharsets.UTF_8);
        <span class="hljs-comment">// 获取Event的Header</span>
        Map&lt;String, String&gt; headerMap = event.getHeaders();
        <span class="hljs-comment">// 解析body获取JSON串</span>
        String[] bodyArr = eventBody.split(<span class="hljs-string">"\\s+"</span>);
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">String</span> <span class="hljs-variable">jsonStr</span> <span class="hljs-operator">=</span> bodyArr[<span class="hljs-number">6</span>];
            <span class="hljs-type">String</span> <span class="hljs-variable">timestampStr</span> <span class="hljs-operator">=</span> <span class="hljs-string">""</span>;
            <span class="hljs-type">JSONObject</span> <span class="hljs-variable">jsonObject</span> <span class="hljs-operator">=</span> JSON.parseObject(jsonStr);
            <span class="hljs-keyword">if</span> (headerMap.getOrDefault(<span class="hljs-string">"logtype"</span>, <span class="hljs-string">""</span>).equals(<span class="hljs-string">"start"</span>)) {
                <span class="hljs-comment">// 取启动时间戳</span>
                jsonObject.getJSONObject(<span class="hljs-string">"app_active"</span>).getString(<span class="hljs-string">"time"</span>);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (headerMap.getOrDefault(<span class="hljs-string">"logtype"</span>, <span class="hljs-string">""</span>).equals(<span class="hljs-string">"event"</span>)) {
                <span class="hljs-comment">// 取事件日志第一条记录的时间戳</span>
                <span class="hljs-type">JSONArray</span> <span class="hljs-variable">jsonArray</span> <span class="hljs-operator">=</span> jsonObject.getJSONArray(<span class="hljs-string">"wzk_event"</span>);
                <span class="hljs-keyword">if</span> (jsonArray.size() &gt; <span class="hljs-number">0</span>) {
                    timestampStr = jsonArray.getJSONObject(<span class="hljs-number">0</span>).getString(<span class="hljs-string">"time"</span>);
                }
            }
            <span class="hljs-comment">// 将时间戳转换为 yyyy-MM-dd</span>
            <span class="hljs-type">long</span> <span class="hljs-variable">timestamp</span> <span class="hljs-operator">=</span> Long.parseLong(timestampStr);
            <span class="hljs-type">DateTimeFormatter</span> <span class="hljs-variable">formatter</span> <span class="hljs-operator">=</span> DateTimeFormatter.ofPattern(<span class="hljs-string">"yyyy-MM-dd"</span>);
            <span class="hljs-type">Instant</span> <span class="hljs-variable">instant</span> <span class="hljs-operator">=</span> Instant.ofEpochMilli(timestamp);
            <span class="hljs-type">LocalDateTime</span> <span class="hljs-variable">localDateTime</span> <span class="hljs-operator">=</span> LocalDateTime.ofInstant(instant, ZoneId.systemDefault());
            <span class="hljs-type">String</span> <span class="hljs-variable">date</span> <span class="hljs-operator">=</span> formatter.format(localDateTime);
            <span class="hljs-comment">// 转换后将字符串放置到Header中</span>
            headerMap.put(<span class="hljs-string">"logtime"</span>, date);
            event.setHeaders(headerMap);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            headerMap.put(<span class="hljs-string">"logtime"</span>, <span class="hljs-string">"Unknown"</span>);
            event.setHeaders(headerMap);
        }
        <span class="hljs-keyword">return</span> event;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> List&lt;Event&gt; <span class="hljs-title function_">intercept</span><span class="hljs-params">(List&lt;Event&gt; events)</span> {
        List&lt;Event&gt; lstEvent = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-keyword">for</span> (Event event: events){
            <span class="hljs-type">Event</span> <span class="hljs-variable">outEvent</span> <span class="hljs-operator">=</span> intercept(event);
            <span class="hljs-keyword">if</span> (outEvent != <span class="hljs-literal">null</span>) {
                lstEvent.add(outEvent);
            }
        }
        <span class="hljs-keyword">return</span> lstEvent;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> {

    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Builder</span> <span class="hljs-keyword">implements</span>
            <span class="hljs-title class_">Interceptor</span>.Builder {
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> Interceptor <span class="hljs-title function_">build</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LogTypeInterceptor</span>();
        }
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">configure</span><span class="hljs-params">(Context context)</span> {
        }
    }
    
}
</code></pre>
<h4 data-id="heading-8">打包项目</h4>
<pre><code class="hljs language-shell" lang="shell">mvn clean package
</code></pre>
<p>打包结果如下，我们需要将“”上传到服务器中：
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/023833d75bb44c37be75cff84a69b268~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770643999&amp;x-signature=vh15bO%2FnvoRMzNV5CemRVR62bIg%3D" alt="离线数仓代码测试" loading="lazy"/></p>
<h4 data-id="heading-9">启动测试</h4>
<pre><code class="hljs language-shell" lang="shell">flume-ng agent --conf-file /opt/wzk/flume-conf/flume-log2hdfs3.conf -name a1 -Dflume.roog.logger=INFO,console
</code></pre>
<p>启动的结果如下图所示，如果你缺什么文件夹之类的，自己创建出来：
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/811da130d0454de480334f3ed8f17f81~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770643999&amp;x-signature=7zXSeA87ZoojLUta5sFqmBIHgG8%3D" alt="离线数仓 flume agent" loading="lazy"/></p>
<h4 data-id="heading-10">测试结果</h4>
<p>写入log文件：</p>
<pre><code class="hljs language-shell" lang="shell">vim /opt/wzk/logs/start/test.log
</code></pre>
<p>写入的内容如下所示：</p>
<pre><code class="hljs language-shell" lang="shell">2020-08-02 18:19:32.959 [main] INFO icu.wzk.ecommerce.AppStart - {"app_active":{"name":"app_active","json":{"entry":"1","action":"0","error_code":"0"},"time":1596342840284},"attr":{"area":"大庆","uid":"2F10092A2","app_v":"1.1.15","event_type":"common","device_id":"1FB872-9A1002","os_type":"2.8","channel":"TB","language":"chinese","brand":"iphone-8"}}

</code></pre>
<p>写入的结果如下图所示：
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3a83ef2fcd8e4e60b02d0c1cae615189~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770643999&amp;x-signature=5robWaQSW0eJrMKL0PVWd5vi2Ok%3D" alt="离线数仓 Flume 数据测试" loading="lazy"/>
写入log文件：</p>
<pre><code class="hljs language-shell" lang="shell">vim /opt/wzk/logs/event/test.log
</code></pre>
<p>写入的内容如下所示：</p>
<pre><code class="hljs language-shell" lang="shell">2020-08-02 18:20:11.877 [main] INFO icu.wzk.ecommerce.AppEvent - {"wzk_event":[{"name":"goods_detail_loading","json":{"entry":"1","goodsid":"0","loading_time":"93","action":"3","staytime":"56","showtype":"2"},"time":1596343881690},{"name":"loading","json":{"loading_time":"15","action":"3","loading_type":"3","type":"1"},"time":1596356988428},{"name":"notification","json":{"action":"1","type":"2"},"time":1596374167278},{"name":"favorites","json":{"course_id":1,"id":0,"userid":0},"time":1596350933962}],"attr":{"area":"长治","uid":"2F10092A4","app_v":"1.1.14","event_type":"common","device_id":"1FB872-9A1004","os_type":"0.5.0","channel":"QL","language":"chinese","brand":"xiaomi-0"}}

</code></pre>
<p>写入的结果如下图所示：
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8cdc8c5695ab4c52860cbb2e2b4dcdd1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770643999&amp;x-signature=SoltxyOgE%2BI4c%2FLEP%2BYErrVQKRI%3D" alt="离线数仓 Flume 测试" loading="lazy"/></p>
<h4 data-id="heading-11">查看结果</h4>
<p>控制台已经输出了结果：
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4fa3c455c9aa4fc7ab6b062acd39465f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770643999&amp;x-signature=hmJqrgxTloTLPAs%2Be9E8pSycJEo%3D" alt="离线数仓 Flume taildir 测试" loading="lazy"/></p>
<p>我们查看HDFS，也输出了对应的内容出来：
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/293b9517aff94cfeab3f64d78e10761d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770643999&amp;x-signature=CsLnIk9lzXzkC%2FpqeMfCoCWKZrc%3D" alt="离线数仓 HDFS 数据查看" loading="lazy"/></p>
<h3 data-id="heading-12">生产环境</h3>
<p>生产环节中，推荐使用：</p>
<pre><code class="hljs language-shell" lang="shell">nohup flume-ng agent --conf-file /opt/wzk/flume-conf/flume-log2hdfs3.conf -name a1 -Dflume.roog.logger=INFO,console &gt; dev/null 2&gt;&amp;1 &amp;
</code></pre>
<ul>
<li>nohup 该命令允许用户退出账户、关闭终端之后还继续运行相应的进程</li>
<li>/dev/null 代表Linux的空设备文件，所有往这个文件里面写入的内容都会丢失，也称黑洞</li>
<li>标准输入0，从键盘获得输入 /proc/self/fd/0</li>
<li>标准输出1，输出到屏幕（控制台）/proc/self/fd/1</li>
<li>错误输出2，输出到屏幕（控制台）/proc/self/fd/2</li>
<li>/dev/null 标准输出1重定向到 /dev/null 中，此时标准输出不存在，没有任何地方能够找到输出的内容</li>
<li>2&gt;&amp;1 错误输出将会和标准输出输出到同一个地方</li>
<li>/dev/null 2&gt;&amp;1 不会输出任何信息到控制台，也不会有任何信息输出到文件中</li>
</ul>
<h2 data-id="heading-13">错误速查</h2>























































<table><thead><tr><th>症状</th><th>根因定位</th><th>修复</th></tr></thead><tbody><tr><td>HDFS路径未按日期分区，logtime为空或Unknown</td><td>Interceptor未正确写入timestampStr/异常被catch</td><td>查看Flume控制台、在Interceptor打日志、检查Header是否含logtime；修正对timestampStr的赋值逻辑；异常时不要吞掉关键信息，至少输出body/索引信息</td></tr><tr><td>启动日志分支始终取不到时间戳</td><td>start分支只调用getString未赋值给timestampStr</td><td>复查intercept中start分支代码路径；将启动时间戳写入timestampStr（保持与event分支一致的赋值方式）</td></tr><tr><td>ArrayIndexOutOfBounds/JSON解析失败</td><td>eventBody.split后固定取bodyArr[6]，对日志格式强耦合</td><td>抓取一条原始日志body，打印split后数组长度与内容；用更稳健的提取方式：定位JSON起始“{”并截取；或用正则提取JSON段</td></tr><tr><td>NumberFormatException（timestamp解析失败）</td><td>timestampStr为空/非纯数字/字段路径不一致</td><td>打印timestampStr、JSON结构；确认time字段类型；增加空值判断与类型兼容（字符串/数字）；字段缺失时走降级策略</td></tr><tr><td>日期与预期不一致（跨时区/跨天）</td><td>ZoneId.systemDefault()受服务器时区影响</td><td>对比服务器时区与业务时区；抽样对照原始timestamp；固定业务时区（如ZoneId.of("Asia/Shanghai")），或在配置中可切换</td></tr><tr><td>启动命令参数不生效/日志级别不对</td><td>JVM参数拼写错误（如root/logger关键词写错）</td><td>对照Flume官方参数名；观察是否仍输出默认级别；更正JVM参数键名；确认控制台实际输出的logger生效</td></tr><tr><td>nohup后仍有输出或命令报找不到文件</td><td>重定向路径写错（dev/null少“/”）</td><td>直接执行nohup命令观察报错；改为&gt;/dev/null 2&gt;&amp;1；必要时输出到指定日志文件便于排障</td></tr><tr><td>HDFS小文件过多/滚动频繁</td><td>rollSize/rollCount/rollInterval配置不合理</td><td>统计HDFS目录文件数量与平均大小；结合吞吐设置合理滚动阈值；按天/小时分区同时控制滚动策略</td></tr><tr><td>内存飙升/吞吐下降</td><td>Memory Channel或拦截器解析开销过大</td><td>观察Flume JVM、GC、Channel backoff；调整Channel类型与容量；优化JSON解析与字符串处理，减少对象创建</td></tr></tbody></table>
<h2 data-id="heading-14">其他系列</h2>
<h3 data-id="heading-15">🚀 AI篇持续更新中（长期更新）</h3>
<p><strong>AI炼丹日志-29 - 字节跳动 DeerFlow 深度研究框<em>斜体样式</em>架 私有部署 测试上手 架构研究</strong>，持续打造实用AI工具指南！
<strong>AI研究-132 Java 生态前沿 2025：Spring、Quarkus、GraalVM、CRaC 与云原生落地</strong>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fw776341482%2Fcategory_12794137.html" target="_blank" title="https://blog.csdn.net/w776341482/category_12794137.html" ref="nofollow noopener noreferrer">🔗 AI模块直达链接 </a></p>
<h3 data-id="heading-16">💻 Java篇持续更新中（长期更新）</h3>
<p><strong>Java-218 RocketMQ Java API 实战：同步/异步 Producer 与 Pull/Push Consumer</strong>
MyBatis 已完结，Spring 已完结，Nginx已完结，Tomcat已完结，分布式服务已完结，Dubbo已完结，MySQL已完结，MongoDB已完结，Neo4j已完结，FastDFS 已完结，OSS已完结，GuavaCache已完结，EVCache已完结，RabbitMQ已完结，RocketMQ正在更新... 深入浅出助你打牢基础！
<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fw776341482%2Fcategory_12833348.html" target="_blank" title="https://blog.csdn.net/w776341482/category_12833348.html" ref="nofollow noopener noreferrer">🔗 Java模块直达链接</a></p>
<h3 data-id="heading-17">📊 大数据板块已完成多项干货更新（300篇）：</h3>
<p>包括 Hadoop、Hive、Kafka、Flink、ClickHouse、Elasticsearch 等二十余项核心组件，覆盖离线+实时数仓全栈！
<strong>大数据-278 Spark MLib - 基础介绍 机器学习算法 梯度提升树 GBDT案例 详解</strong>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fw776341482%2Fcategory_12713819.html" target="_blank" title="https://blog.csdn.net/w776341482/category_12713819.html" ref="nofollow noopener noreferrer">🔗 大数据模块直达链接</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[从零学习Kafka：配置参数]]></title>    <link>https://juejin.cn/post/7602259669705965594</link>    <guid>https://juejin.cn/post/7602259669705965594</guid>    <pubDate>2026-02-02T13:43:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602259669705965594" data-draft-id="7602070768962371610" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="从零学习Kafka：配置参数"/> <meta itemprop="keywords" content="Kafka"/> <meta itemprop="datePublished" content="2026-02-02T13:43:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="面向Google编程"/> <meta itemprop="url" content="https://juejin.cn/user/1063982986695374"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            从零学习Kafka：配置参数
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1063982986695374/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    面向Google编程
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T13:43:26.000Z" title="Mon Feb 02 2026 13:43:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读7分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>前面我们对 Kafka 的整体架构和一些关键的概念有了一个基本的认知，本文主要介绍 Kafka 的一些配置参数。掌握这些参数的作用对我们的运维和调优工作还是非常有帮助的。</p>
<h3 data-id="heading-0">写在前面</h3>
<p>Kafka 作为一个成熟的事件流平台，有非常多的配置参数。详细的参数列表可以查看<a href="https://link.juejin.cn?target=https%3A%2F%2Fkafka.apache.org%2F41%2Fconfiguration%2F" target="_blank" title="https://kafka.apache.org/41/configuration/" ref="nofollow noopener noreferrer">官方文档</a>。本文我们列出一些个人认为比较重要的参数，并对其进行详细的介绍。</p>
<h3 data-id="heading-1">Broker 端参数</h3>
<p>第一个要介绍的参数是 <code>log.dirs</code> 它是 Broker 的一个最基本的参数，用来指定数据存储的目录，多个目录之间用逗号分隔。这个参数是必填参数且没有默认值。因此必须要手动配置。在生产环境中，我们可以给这个目录配置挂载在多个不同磁盘的路径，这样既可以提升读写性能，又可以实现故障转移。Kafka 还提供了 <code>log.dir</code> 参数，作为 <code>log.dirs</code> 的补充，这个参数只能配置一个目录，默认值是 <code>/tmp/kafka-logs</code> ，通常情况下我们只需要配置 <code>log.dirs</code> 就好。</p>
<p>第二个参数是 <code>process.roles</code>，它用来指定 broker 的角色，可以是 broker 或者 controller，也可以同时指定为 broker,controller。</p>
<p>第三个参数是 <code>listeners</code>，它是 broker 的“耳朵”，指定了 broker 如何监听外部连接。连接的配置是一个三元组，包括&lt;协议名称，主机名，端口号&gt;。</p>
<p>Kafka 目前支持四种安全协议：</p>
<ul>
<li>PLAINTEXT：明文传输</li>
<li>SSL/TLS：加密传输</li>
<li>SASL_PLAINTEXT：认证+明文传输</li>
<li>SASL_SSL：认证+加密传输，为最高安全级别</li>
</ul>
<p>此外还可以自定义协议名称，但需要配置 <code>listener.security.protocol.map</code> 参数。</p>
<p>主机名可以指定为一个确定的主机名，也可以是 0.0.0.0 ，这代表了 broker 会监听所有网卡。主机名也可以是空，代表监听默认接口。</p>
<p>第四个参数是 <code>advertised.listeners</code> ，这组配置是 Broker 发布的监听，也就是告诉别人“怎么找到我”。它的配置格式和 listeners 相同。</p>
<p>再来看几个集群稳定性和元数据管理相关的参数。</p>
<p>第五个是 <code>auto.create.topics.enable</code>，表示是否允许自动创建 topic。在生产环境中一般设置为 false，需要用户手动创建 topic，方便管理。</p>
<p>第六个是 <code>unclean.leader.election.enable</code>，表示是否允许 unclean leader 选举。unclean 就是落后太多的副本，如果允许这部分副本参与选举可能会造成数据丢失，因此最好手动设置 false。在最新版本中，它的默认值就是 false，为什么还要手动设置呢？因为不同的 Kafka 版本中这个参数的默认值是不一样的，最开始是 false，后来改成了 true，现在又改回了 false。为了避免数据丢失，我们还是手动设置成 false 比较放心。</p>
<p>第七个参数是 <code>auto.leader.rebalance.enable</code>，表示是否允许定期选举 leader，这个参数最好也设置为 false，如果设置为 true 的话，即使当前 leader 一直运行的很稳定，Kafka 也会重新选举出一个新的 leader 来替代它。替换 leader 的成本还是非常高的，所有连接到旧 leader 的 client 都需要与新的 leader 重新建立连接。</p>
<p>第八个参数是 <code>min.insync.replicas</code> ，表示最小同步副本数，它与生产者的 acks=all 配合。如果存活的副本数小于这个值，producer 在写入时会直接报错。这个配置可以保证我们在牺牲部分可用性的情况下确保数据的正确性。</p>
<p>接下来我们再看几个数据生命周期相关的参数。</p>
<p>第九个参数是 <code>log.retention.hours / minutes / ms</code>，这其实是三个参数，表示的意思一样，都是数据留存时长，只是时间单位不同。如果三个参数都配置了，优先级是 ms &gt; minutes &gt; hours。</p>
<p>第十个参数 <code>log.retention.bytes</code>，它表示单个 broker 上存储的最大字节数，默认是 -1，也就是没有限制。在数据激增时，它可以是保护磁盘不溢出的最后防线。</p>
<p>第十一个参数是 <code>log.segment.bytes</code>，它表示单个日志文件的大小，默认是 1GB。</p>
<h3 data-id="heading-2">Topic 参数</h3>
<p>Topic 级别的参数会覆盖 Broker 参数的值，它的主要作用针对不同的 topic 灵活的配置参数。最常见的是我们在生产环境中针对不同的 topic 会配置不同的数据保留时长。这也是我们要介绍的第一个参数 <code>retention.ms</code>，它对应的 broker 端的参数就是 <code>log.retention.ms</code>。</p>
<p>第二个参数是 <code>retention.bytes</code> 它对应的是 <code>log.retention.bytes</code>。</p>
<p>第三个参数是 <code>cleanup.policy</code>，它对应的是 broker 端的 <code>log.cleanup.policy</code>，这个参数代表了数据清理策略，默认值是 delete，即直接物理删除。也可以配置为 compact，对每个 key 只保留最新的值，这种策略比较适合一些状态保存的场景。</p>
<p>第四个参数是 <code>segment.bytes</code> ，与之对应的 broker 参数是 <code>log.segment.bytes</code>，同样是控制 Log Segment 文件的大小，默认是 1GB。调小可以让 Kafka 更及时的回收磁盘空间，但容易产生大量小文件，增大索引压力。一般保持默认值就好。</p>
<p>第五个参数是 <code>max.message.bytes</code> ，它限制了该 Topic 能接收的最大单条消息的大小，默认是 1MB，对个别业务可以适当调大。需要注意的是它和消费端参数 <code>fetch.max.bytes</code> 的大小应该合理配置。如果 <code>max.message.bytes</code> 设置为 10MB，<code>fetch.max.bytes</code> 设置为 5MB，当 Topic 中有超过 5MB 的消息时，就会导致无法消费的问题。</p>
<h3 data-id="heading-3">Producer 参数</h3>
<p>首先第一个参数是 <code>acks</code>，它有几个值：</p>
<ul>
<li>0：不管是否写入成功</li>
<li>1：Leader 写入成功即可</li>
<li>all / -1：ISR 都要写入成功</li>
</ul>
<p>默认值是 all，如果设置成 0 或 1 ，性能会提高，但有可能丢失数据。</p>
<p>第二个参数是 <code>retries</code> ，它控制请求的重试次数，默认是 2147483647（约等于无限重试了）。</p>
<p>第三个参数是 <code>batch.size</code>，默认是 16KB，调大会提升吞吐量，但是会增加内存占用。</p>
<p>第四个参数是 <code>linger.ms</code>，它用来控制发送等待时间，也就是“攒批”的时间，Kafka 4.0 把它的默认值从 0 调成了 5。它可以和 <code>batch.size</code> 配合使用，同时调大会提高吞吐，但数据会有一定的延迟。在生产环境中，我们可以根据不同的场景对其进行调整，如果数据量极大，但对延迟要求不高，则可以考虑调大这两个参数。</p>
<p>最后，第五个参数是 <code>compression.type</code> 生产端的压缩算法，默认不开启压缩，目前支持的值为：none、gzip、snappy、lz4、zstd。</p>
<h3 data-id="heading-4">Consumer 参数</h3>
<p>最后我们再来看几个 Consumer 端的参数。</p>
<p>第一个是 <code>group.id</code>，用来标识这个 consumer 属于哪个消费组。</p>
<p>第二个是 <code>auto.offset.reset</code>，它用来标识 offset 的重置策略。支持以下几个值：</p>
<ul>
<li>earliest：从最早的 offset 开始消费</li>
<li>latest：从最新的 offset 开始消费</li>
<li>by_duration：需要配置为 by_duration:ISO-8601 格式的时间，例如 by_duration:PT1H 即从 1 小时前的位移开始消费</li>
<li>none：如果没找到消费组的 offset，就会抛出异常</li>
</ul>
<p>第三个参数是 <code>enable.auto.commit</code>，是否自动提交 offset，默认是 true。在调用 poll 方法时，会提交上一批次的 offset。也可以设置为 false，这样就是手动提交，自己控制在什么时候提交，具体的细节我们以后再聊。</p>
<p>第四个参数是 <code>max.poll.records</code> ，表示单次拉取的消息条数，默认是 500。如果单条数据的处理逻辑比较重，可以调小这个值，防止消费超时的情况。</p>
<p>第五个参数是 <code>session.timeout.ms</code>，表示心跳超时时间，默认是 45000，即 45 秒。如果 Broker 超过 45 秒没收到 Consumer 的心跳，就认为这个 Consumer 挂了，会将它踢出消费组，然后进行 Rebalance。</p>
<h3 data-id="heading-5">总结</h3>
<p>本文我们一起学习了涉及 Broker、Topic、Producer、Consumer 端的共 26 个配置参数，这些都是我认为比较重要的。掌握之后可以对生产环境的调优有比较大的帮助。除了上面提到的这些，你还知道有哪些比较重要的配置参数吗？</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue-常用修饰符]]></title>    <link>https://juejin.cn/post/7602259669705981978</link>    <guid>https://juejin.cn/post/7602259669705981978</guid>    <pubDate>2026-02-02T13:49:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602259669705981978" data-draft-id="7602070768962338842" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue-常用修饰符"/> <meta itemprop="keywords" content="前端,面试,Vue.js"/> <meta itemprop="datePublished" content="2026-02-02T13:49:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="发现一只大呆瓜"/> <meta itemprop="url" content="https://juejin.cn/user/180747382561607"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue-常用修饰符
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/180747382561607/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    发现一只大呆瓜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T13:49:29.000Z" title="Mon Feb 02 2026 13:49:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">前言</h3>
<p>在 Vue 开发中，修饰符（Modifiers）是指令后的一个特殊后缀（以 <code>.</code> 开头），它能以极简的方式帮我们处理事件冒泡、键盘监听以及复杂的双向绑定逻辑。掌握它们，能让你的模板代码既优雅又高效。</p>
<h2 data-id="heading-1">一、 事件修饰符：精准控制交互行为</h2>
<p>事件修饰符主要用于处理 DOM 事件的细节。</p>
<ul>
<li><strong><code>.stop</code></strong>：阻止事件冒泡（调用 <code>event.stopPropagation()</code>）。</li>
<li><strong><code>.prevent</code></strong>：阻止事件的默认行为（调用 <code>event.preventDefault()</code>）。</li>
<li><strong><code>.capture</code></strong>：在捕获模式下触发事件监听器。</li>
<li><strong><code>.self</code></strong>：只有当事件是从触发元素本身触发时才触发回调。</li>
<li><strong><code>.once</code></strong>：事件只触发一次，之后自动移除监听器。</li>
<li><strong><code>.passive</code></strong>：滚动事件的性能优化，告诉浏览器不需要等待 <code>preventDefault</code>。</li>
</ul>
<hr/>
<h2 data-id="heading-2">二、 键盘与鼠标修饰符：语义化监听</h2>
<h3 data-id="heading-3">1. 按键修饰符</h3>
<p>在监听键盘事件时，我们经常需要检查特定的按键，例如：<code>&lt;input @keyup.enter="submitForm" type="text" placeholder="按回车提交"&gt;</code>。</p>
<ul>
<li><strong><code>.enter</code></strong>：回车键</li>
<li><strong><code>.tab</code></strong>：Tab 键</li>
<li><strong><code>.space</code></strong>：空格键</li>
<li><strong><code>.delete</code></strong>：删除或退格键</li>
<li><strong><code>.up</code> / <code>.down</code> / <code>.left</code> / <code>.right</code></strong>：方向键</li>
</ul>
<h3 data-id="heading-4">2. 鼠标修饰符</h3>
<p>用于限制处理程序仅响应特定的鼠标按键。</p>
<ul>
<li><strong><code>.left</code></strong>：点击鼠标左键触发。</li>
<li><strong><code>.right</code></strong>：点击鼠标右键触发。</li>
<li><strong><code>.middle</code></strong>：点击鼠标中键（滚轮点击）触发。</li>
</ul>
<hr/>
<h2 data-id="heading-5">三、 v-model 修饰符：数据预处理</h2>
<p>这些修饰符可以自动处理表单输入的数据格式。</p>
<ul>
<li><strong><code>.lazy</code></strong>： 将v-model的同步时机设置在change事件之后，一般为在输入框失去焦点时。</li>
<li><strong><code>.number</code></strong>：自动将用户的输入值转为数值类型（内部使用 <code>parseFloat</code>）。</li>
<li><strong><code>.trim</code></strong>：自动过滤用户输入内容的首尾空白字符。</li>
</ul>
<hr/>
<h2 data-id="heading-6">四、 双向绑定修饰符</h2>
<p>这是 Vue 2 到 Vue 3 变化最大的部分。</p>
<h3 data-id="heading-7">1. Vue 2 时代的 <code>.sync</code></h3>
<p>在 Vue 2 中，<code>.sync</code> 是实现父子组件属性双向绑定的语法糖。</p>
<pre><code class="hljs language-vue" lang="vue">// 使用 .sync 的语法糖
&lt;ChildComponent :title.sync="pageTitle" /&gt;
// 在子组件的方法中
this.$emit('update:title', newTitleValue);

</code></pre>
<h3 data-id="heading-8">2. Vue 3 的统一：<code>v-model:prop</code></h3>
<p>Vue 3 废弃了 <code>.sync</code>，将其功能合并到了 <code>v-model</code> 中。支持在同一个组件上绑定多个 <code>v-model</code>。</p>
<pre><code class="hljs language-vue" lang="vue"> // 在父组件中
&lt;ChildComponent v-model:title="pageTitle" /&gt;

// 子组件
&lt;script setup&gt;
defineProps(['title']);
const emit = defineEmits(['update:title']);

const updateTitle = (newVal) =&gt; {
  emit('update:title', newVal);
};
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-9">3. Vue 3.4+ 的黑科技：<code>defineModel</code></h3>
<p>这是目前 Vue 3 最推荐的写法，极大简化了双向绑定的逻辑代码。</p>
<pre><code class="hljs language-vue" lang="vue">// 父组件
&lt;ChildComponent v-model="inputValue" /&gt;

// 子组件
const inputValue = defineModel({
 // inputValue为双向绑定输入框的值
  type: [String],
  // 默认值
  default: ''
})
</code></pre>
<hr/>
<h2 data-id="heading-10">五、 总结</h2>
<ol>
<li><strong>交互逻辑</strong>优先使用事件修饰符，减少组件内的非业务代码。</li>
<li><strong>表单处理</strong>善用 <code>.trim</code> 和 <code>.number</code>，降低后端校验压力。</li>
<li><strong>父子通信</strong>在 Vue 3 项目中全面拥抱 <code>v-model:prop</code>，如果是新项目（Vue 3.4+），请直接使用 <strong><code>defineModel</code></strong>，它能让你的代码量减少 50% 以上。</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[字符串拼接？使用 knitwork-x，更轻量的 TS 代码生成方案]]></title>    <link>https://juejin.cn/post/7602106969698009151</link>    <guid>https://juejin.cn/post/7602106969698009151</guid>    <pubDate>2026-02-02T12:10:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602106969698009151" data-draft-id="7602082590732976164" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="字符串拼接？使用 knitwork-x，更轻量的 TS 代码生成方案"/> <meta itemprop="keywords" content="后端,前端,JavaScript"/> <meta itemprop="datePublished" content="2026-02-02T12:10:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Mr_Mao"/> <meta itemprop="url" content="https://juejin.cn/user/1099167361152967"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            字符串拼接？使用 knitwork-x，更轻量的 TS 代码生成方案
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1099167361152967/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Mr_Mao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T12:10:45.000Z" title="Mon Feb 02 2026 12:10:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在做 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhairyf%2Fgenapi" target="_blank" title="https://github.com/hairyf/genapi" ref="nofollow noopener noreferrer">genapi</a>（OpenAPI 转 TS 请求代码工具）时，我就一直有一个很纠结的问题。</p>
<p>传统方案要么太重，要么太乱：</p>
<ul>
<li><strong>TS 官方 AST / ts-morph</strong>：功能天花板，但体积巨大、构建慢，在轻量工具里引入它像大炮打蚊子。</li>
<li><strong>手拼字符串</strong>：<code>code += 'export class ' + name + ' {'</code>…… 这种代码写多了，引号和换行能让人怀疑人生。</li>
</ul>
<p>后来发现 UnJS 的 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Funjs%2Fknitwork" target="_blank" title="https://github.com/unjs/knitwork" ref="nofollow noopener noreferrer">knitwork</a>：<strong>设计思路挺不错的</strong>，用一组轻量 API 把「结构」转成代码字符串，不碰 AST，也不管类型检查。但原库偏简陋，类、接口、类型、循环、try-catch 等都不够用，装饰器、复杂泛型也基本没覆盖，也没法直接拿来生成 genapi 要的那类 TS。<br/>
所以就 fork 了一版 <a href="https://link.juejin.cn?target=https%3A%2F%2Fknitwork-x.vercel.app%2F" target="_blank" title="https://knitwork-x.vercel.app/" ref="nofollow noopener noreferrer">knitwork-x</a>（<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhairyf%2Fknitwork-x" target="_blank" title="https://github.com/hairyf/knitwork-x" ref="nofollow noopener noreferrer">GitHub</a>），在保持「轻量、只拼字符串」的前提下，补了一整套 <strong>TS 代码生成能力</strong>：import/export、类、接口、函数、类型、循环条件 try-catch 等，用 API 拼代码，不用自己操心引号和换行。</p>
<p><strong>简单来说，knitwork-x 就是为了填补「手拼」与「AST」之间的空白。</strong></p>
<blockquote>
<p>懒得往下看的小伙伴可以到<a href="https://link.juejin.cn?target=https%3A%2F%2Fknitwork-x.vercel.app%2F" target="_blank" title="https://knitwork-x.vercel.app/" ref="nofollow noopener noreferrer">文档</a>里查看 APIs 的用例，我做了方法比对的案例，每个都很直观。</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">knitwork-x 是啥？</h2>
<p><strong>一句话：按数据结构调用 API，得到合法的 JS/TS 代码字符串。</strong> 你要的是一段「可被解析的代码文本」，而不是执行它。典型场景：根据配置生成 import/export、根据 schema 生成 interface/type/class、动态生成 try/catch、for、switch 等。</p>
<p>三种方案对比如下：</p>





























<table><thead><tr><th align="left">方案</th><th align="left">易用性</th><th align="left">体积/性能</th><th align="left">复杂度控制</th></tr></thead><tbody><tr><td align="left">手拼字符串</td><td align="left">极简</td><td align="left">极快</td><td align="left">极差（容易写错）</td></tr><tr><td align="left"><strong>knitwork-x</strong></td><td align="left"><strong>简单</strong></td><td align="left"><strong>快/轻量</strong></td><td align="left"><strong>良好（结构化）</strong></td></tr><tr><td align="left">ts-morph</td><td align="left">复杂</td><td align="left">笨重</td><td align="left">极强（支持校验）</td></tr></tbody></table>
<p>knitwork-x 在延续 knitwork 思路的前提下，把「能拼什么」补全了：一组小而专的 <code>genXxx</code>，只负责把「结构」转成「代码字符串」。</p>
<p>先看一个最简单的例子：生成一句 ESM 的 default export。</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { genDefaultExport } <span class="hljs-keyword">from</span> <span class="hljs-string">'knitwork-x'</span>

<span class="hljs-title function_">genDefaultExport</span>(<span class="hljs-string">'foo'</span>)
<span class="hljs-comment">// =&gt; `export default foo;`</span>

<span class="hljs-title function_">genDefaultExport</span>(<span class="hljs-string">'42'</span>, { <span class="hljs-attr">singleQuotes</span>: <span class="hljs-literal">true</span> })
<span class="hljs-comment">// =&gt; `export default 42;`</span>
</code></pre>
<p>你不用管分号、引号，API 给你的就是可直接拼进文件里的字符串。</p>
<hr/>
<h2 data-id="heading-1">能生成哪些东西？</h2>
<p>按能力分几块，每块看一个小例子。</p>
<h3 data-id="heading-2">ESM：import / export</h3>
<p><strong>import/export 这种高频需求，用 API 一拼就有：</strong></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { genImport, genExport, genDynamicImport } <span class="hljs-keyword">from</span> <span class="hljs-string">'knitwork-x'</span>

<span class="hljs-comment">// 默认导入、具名导入、重命名</span>
<span class="hljs-title function_">genImport</span>(<span class="hljs-string">'pkg'</span>, <span class="hljs-string">'foo'</span>)
<span class="hljs-comment">// =&gt; `import foo from "pkg";`</span>
<span class="hljs-title function_">genImport</span>(<span class="hljs-string">'pkg'</span>, [<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>])
<span class="hljs-comment">// =&gt; `import { a, b } from "pkg";`</span>
<span class="hljs-title function_">genImport</span>(<span class="hljs-string">'pkg'</span>, [{ <span class="hljs-attr">name</span>: <span class="hljs-string">'foo'</span>, <span class="hljs-attr">as</span>: <span class="hljs-string">'bar'</span> }])
<span class="hljs-comment">// =&gt; `import { foo as bar } from "pkg";`</span>

<span class="hljs-comment">// type-only</span>
<span class="hljs-title function_">genImport</span>(<span class="hljs-string">'@nuxt/utils'</span>, [<span class="hljs-string">'test'</span>], { <span class="hljs-attr">type</span>: <span class="hljs-literal">true</span> })
<span class="hljs-comment">// =&gt; `import type { test } from "@nuxt/utils";`</span>

<span class="hljs-comment">// 动态 import，可包一层箭头函数、interopDefault</span>
<span class="hljs-title function_">genDynamicImport</span>(<span class="hljs-string">'pkg'</span>, { <span class="hljs-attr">wrapper</span>: <span class="hljs-literal">true</span> })
<span class="hljs-comment">// =&gt; `() =&gt; import("pkg")`</span>
<span class="hljs-title function_">genDynamicImport</span>(<span class="hljs-string">'pkg'</span>, { <span class="hljs-attr">type</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'foo'</span> })
<span class="hljs-comment">// =&gt; `typeof import("pkg").foo`</span>

<span class="hljs-title function_">genExport</span>(<span class="hljs-string">'pkg'</span>, [<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>])
<span class="hljs-comment">// =&gt; `export { a, b } from "pkg";`</span>
</code></pre>
<p>插件里根据用户配置拼「要 import 的模块列表」时，用这些就能少写很多字符串拼接。</p>
<h3 data-id="heading-3">字符串与字面量</h3>
<p><strong>最烦人的转义逻辑，现在交给 API 就行：</strong></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { genString, escapeString, genTemplateLiteral, genKey } <span class="hljs-keyword">from</span> <span class="hljs-string">'knitwork-x'</span>

<span class="hljs-title function_">genString</span>(<span class="hljs-string">'foo\nbar'</span>)
<span class="hljs-comment">// =&gt; `"foo\nbar"`</span>
<span class="hljs-title function_">genString</span>(<span class="hljs-string">'foo'</span>, { <span class="hljs-attr">singleQuotes</span>: <span class="hljs-literal">true</span> })
<span class="hljs-comment">// =&gt; `'foo'`</span>

escapeString(<span class="hljs-string">"foo'bar"</span>)
<span class="hljs-comment">// =&gt; `foo\'bar`</span>

<span class="hljs-title function_">genTemplateLiteral</span>([<span class="hljs-string">'hello '</span>, <span class="hljs-string">'x'</span>])
<span class="hljs-comment">// =&gt; `\`hello ${x}\``</span>

<span class="hljs-title function_">genKey</span>(<span class="hljs-string">'foo-bar'</span>)
<span class="hljs-comment">// =&gt; `"foo-bar"`</span>
<span class="hljs-title function_">genKey</span>(<span class="hljs-string">'with space'</span>)
<span class="hljs-comment">// =&gt; `"with space"`</span>
</code></pre>
<p>这样生成出来的代码里，引号和换行不会被搞乱。</p>
<h3 data-id="heading-4">类、接口、函数</h3>
<p><strong>类、接口、函数声明，不用再自己拼 <code>class </code> + name：</strong></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> {
  genClass,
  genConstructor,
  genInterface,
  genFunction,
  genArrowFunction,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'knitwork-x'</span>

<span class="hljs-title function_">genClass</span>(<span class="hljs-string">'Foo'</span>)
<span class="hljs-comment">// =&gt; `class Foo {}`</span>

<span class="hljs-title function_">genClass</span>(<span class="hljs-string">'Bar'</span>, [<span class="hljs-title function_">genConstructor</span>([], [<span class="hljs-string">'super();'</span>])])
<span class="hljs-comment">// =&gt; `class Bar { constructor() { super(); } }`</span>

<span class="hljs-title function_">genClass</span>(<span class="hljs-string">'Baz'</span>, [], { <span class="hljs-attr">extends</span>: <span class="hljs-string">'Base'</span>, <span class="hljs-attr">implements</span>: [<span class="hljs-string">'I1'</span>, <span class="hljs-string">'I2'</span>] })
<span class="hljs-comment">// =&gt; `class Baz extends Base implements I1, I2 {}`</span>

<span class="hljs-title function_">genInterface</span>(<span class="hljs-string">'User'</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">'string'</span>, <span class="hljs-attr">id</span>: <span class="hljs-string">'number'</span> })
<span class="hljs-comment">// =&gt; `interface User { name: string, id: number }`</span>

<span class="hljs-title function_">genFunction</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'id'</span>,
  <span class="hljs-attr">generics</span>: [{ <span class="hljs-attr">name</span>: <span class="hljs-string">'T'</span> }],
  <span class="hljs-attr">parameters</span>: [{ <span class="hljs-attr">name</span>: <span class="hljs-string">'x'</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">'T'</span> }],
  <span class="hljs-attr">returnType</span>: <span class="hljs-string">'T'</span>,
  <span class="hljs-attr">body</span>: [<span class="hljs-string">'return x;'</span>],
})
<span class="hljs-comment">// =&gt; `function id&lt;T&gt;(x: T): T { return x; }`</span>

<span class="hljs-title function_">genArrowFunction</span>({ <span class="hljs-attr">parameters</span>: [{ <span class="hljs-attr">name</span>: <span class="hljs-string">'x'</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">'number'</span> }], <span class="hljs-attr">body</span>: <span class="hljs-string">'x * 2'</span> })
<span class="hljs-comment">// =&gt; `(x: number) =&gt; x * 2`</span>
</code></pre>
<p>适合根据配置或 schema 生成「一段 TS 声明文件」或「运行时用的类/函数代码」。</p>
<h3 data-id="heading-5">类型：type、union、conditional、mapped</h3>
<p><strong>类型别名、联合、条件类型、mapped type，同样不用手拼：</strong></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> {
  genTypeAlias,
  genUnion,
  genConditionalType,
  genMappedType,
  genKeyOf,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'knitwork-x'</span>

<span class="hljs-title function_">genTypeAlias</span>(<span class="hljs-string">'Id'</span>, <span class="hljs-string">'T'</span>, { <span class="hljs-attr">generics</span>: [{ <span class="hljs-attr">name</span>: <span class="hljs-string">'T'</span> }] })
<span class="hljs-comment">// =&gt; `type Id&lt;T&gt; = T`</span>

<span class="hljs-title function_">genUnion</span>([<span class="hljs-string">'string'</span>, <span class="hljs-string">'number'</span>])
<span class="hljs-comment">// =&gt; `string | number`</span>

<span class="hljs-title function_">genConditionalType</span>(<span class="hljs-string">'T'</span>, <span class="hljs-string">'null'</span>, <span class="hljs-string">'never'</span>, <span class="hljs-string">'T'</span>)
<span class="hljs-comment">// =&gt; `T extends null ? never : T`</span>

<span class="hljs-title function_">genMappedType</span>(<span class="hljs-string">'K'</span>, <span class="hljs-string">'keyof T'</span>, <span class="hljs-string">'U'</span>)
<span class="hljs-comment">// =&gt; `{ [K in keyof T]: U }`</span>
</code></pre>
<p>做代码生成时，类型部分不用再自己拼字符串。</p>
<h3 data-id="heading-6">控制流：if / for / switch / try-catch</h3>
<p><strong>if/else、for、switch、try-catch 等语句也有对应 <code>genXxx</code>，传条件、循环变量、body 即可：</strong></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { genIf, genForOf, genSwitch, genCase, genDefault, genTry, genCatch } <span class="hljs-keyword">from</span> <span class="hljs-string">'knitwork-x'</span>

<span class="hljs-title function_">genIf</span>(<span class="hljs-string">'x &gt; 0'</span>, <span class="hljs-string">'return x;'</span>)
<span class="hljs-comment">// =&gt; `if (x &gt; 0) { return x; }`</span>

<span class="hljs-title function_">genForOf</span>(<span class="hljs-string">'const item'</span>, <span class="hljs-string">'list'</span>, <span class="hljs-string">'yield item;'</span>, { <span class="hljs-attr">bracket</span>: <span class="hljs-literal">false</span> })
<span class="hljs-comment">// =&gt; `for (const item of list) yield item;`</span>

<span class="hljs-title function_">genSwitch</span>(<span class="hljs-string">'x'</span>, [<span class="hljs-title function_">genCase</span>(<span class="hljs-string">'1'</span>, <span class="hljs-string">'break;'</span>), <span class="hljs-title function_">genDefault</span>(<span class="hljs-string">'return 0;'</span>)])
<span class="hljs-comment">// =&gt; switch(x) { case 1: break; default: return 0; } 的格式化字符串</span>

<span class="hljs-title function_">genTry</span>([<span class="hljs-string">'const x = await f();'</span>, <span class="hljs-string">'return x;'</span>])
<span class="hljs-comment">// =&gt; `try { const x = await f(); return x; }`</span>
<span class="hljs-title function_">genCatch</span>([<span class="hljs-string">'throw e;'</span>], { <span class="hljs-attr">binding</span>: <span class="hljs-string">'e'</span> })
<span class="hljs-comment">// =&gt; `catch (e) { throw e; }`</span>
</code></pre>
<p>需要根据配置生成「一坨语句」时，用这些可以保持缩进和括号一致。</p>
<hr/>
<h2 data-id="heading-7">拼一整段代码：小例子</h2>
<p><strong>把上面几块串起来，输入模块名和类名，直接得到可写入文件的 TS：</strong></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> {
  genImport,
  genClass,
  genConstructor,
  genMethod,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'knitwork-x'</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">generateModule</span>(<span class="hljs-params">modulePath: <span class="hljs-built_in">string</span>, className: <span class="hljs-built_in">string</span></span>) {
  <span class="hljs-keyword">const</span> lines = [
    <span class="hljs-title function_">genImport</span>(modulePath, [<span class="hljs-string">'Base'</span>]),
    <span class="hljs-string">''</span>,
    <span class="hljs-title function_">genClass</span>(
      className,
      [
        <span class="hljs-title function_">genConstructor</span>([], [<span class="hljs-string">'super();'</span>]),
        <span class="hljs-title function_">genMethod</span>({
          <span class="hljs-attr">name</span>: <span class="hljs-string">'run'</span>,
          <span class="hljs-attr">parameters</span>: [],
          <span class="hljs-attr">returnType</span>: <span class="hljs-string">'void'</span>,
          <span class="hljs-attr">body</span>: [<span class="hljs-string">'console.log("ok");'</span>],
        }),
      ],
      { <span class="hljs-attr">extends</span>: <span class="hljs-string">'Base'</span> }
    ),
  ]
  <span class="hljs-keyword">return</span> lines.<span class="hljs-title function_">join</span>(<span class="hljs-string">'\n'</span>)
}

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">generateModule</span>(<span class="hljs-string">'./base'</span>, <span class="hljs-string">'MyService'</span>))
</code></pre>
<p>输出就是一段完整的 TS 文本，可以直接写进 <code>.ts</code> 文件或再交给别的工具处理。<br/>
这里没有手写任何 <code>"class " + className</code> 或 <code>" extends " + base</code>，可读性和可维护性都会好很多。</p>
<hr/>
<h2 data-id="heading-8">总结一下</h2>
<ul>
<li><strong>knitwork-x</strong> 提供一整套 <code>genXxx</code>，把「想生成的代码结构」用 API 描述出来，得到合法的 JS/TS 代码字符串。</li>
<li>覆盖 ESM、字符串、类/接口/函数、类型、控制流等，适合脚手架、插件、构建时代码生成；<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhairyf%2Fgenapi" target="_blank" title="https://github.com/hairyf/genapi" ref="nofollow noopener noreferrer">genapi</a> 里把 OpenAPI 转成 TS/JS 请求代码的流水线，底层就是用它拼出来的。</li>
<li>用 API 拼代码，比手拼字符串安全，比上 AST 轻量。</li>
</ul>
<p>如果你需要做生成 TS 代码这类事，可以到 <a href="https://link.juejin.cn?target=https%3A%2F%2Fknitwork-x.vercel.app%2F" target="_blank" title="https://knitwork-x.vercel.app/" ref="nofollow noopener noreferrer">文档</a> 或 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhairyf%2Fknitwork-x" target="_blank" title="https://github.com/hairyf/knitwork-x" ref="nofollow noopener noreferrer">GitHub</a> 看完整 API 和更多示例。有更好的方法，也欢迎在评论区分享一下 🐛🐛🐛。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[一天一个开源项目（第10篇）：AgentEvolver - 高效自进化Agent系统，让AI Agent自主学习和进化]]></title>    <link>https://juejin.cn/post/7602100217657475114</link>    <guid>https://juejin.cn/post/7602100217657475114</guid>    <pubDate>2026-02-02T12:13:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602100217657475114" data-draft-id="7602082590732959780" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="一天一个开源项目（第10篇）：AgentEvolver - 高效自进化Agent系统，让AI Agent自主学习和进化"/> <meta itemprop="keywords" content="开源,AIGC,人工智能"/> <meta itemprop="datePublished" content="2026-02-02T12:13:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="冬奇Lab"/> <meta itemprop="url" content="https://juejin.cn/user/1857501105781193"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            一天一个开源项目（第10篇）：AgentEvolver - 高效自进化Agent系统，让AI Agent自主学习和进化
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1857501105781193/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    冬奇Lab
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T12:13:35.000Z" title="Mon Feb 02 2026 12:13:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读10分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">引言</h2>
<blockquote>
<p>"如果AI Agent能够像生物进化一样，自主发现问题、积累经验、优化策略，那它们就不再是静态的工具，而是真正会'成长'的智能体。"</p>
</blockquote>
<p>这是"一天一个开源项目"系列的第10篇文章。今天带你了解的项目是 <strong>AgentEvolver</strong>（<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmodelscope%2FAgentEvolver" target="_blank" title="https://github.com/modelscope/AgentEvolver" ref="nofollow noopener noreferrer">GitHub</a>）。</p>
<p>传统的AI Agent训练需要大量人工标注的数据集，成本高昂且难以扩展。AgentEvolver通过三大自进化机制——Self-Questioning（自主提问）、Self-Navigating（自主导航）、Self-Attributing（自主归因），让AI Agent能够自主生成任务、积累经验、优化策略，实现真正的自我进化。</p>
<h3 data-id="heading-1">你将学到什么</h3>
<ul>
<li>AgentEvolver的核心自进化机制和工作原理</li>
<li>Self-Questioning、Self-Navigating、Self-Attributing三大机制如何协同工作</li>
<li>如何搭建和训练自进化Agent系统</li>
<li>面向服务的数据流架构设计</li>
<li>在AppWorld和BFCL-v3基准测试中的优异表现</li>
<li>与其他Agent训练框架的对比分析</li>
</ul>
<h3 data-id="heading-2">前置知识</h3>
<ul>
<li>对AI Agent和强化学习有基本了解</li>
<li>熟悉Python编程</li>
<li>了解LLM的基本概念</li>
<li>对强化学习训练流程有基本认识（可选）</li>
</ul>
<hr/>
<h2 data-id="heading-3">项目背景</h2>
<h3 data-id="heading-4">项目简介</h3>
<p><strong>AgentEvolver</strong> 是一个<strong>高效的自进化Agent系统</strong>，通过三大核心机制让AI Agent能够自主学习和进化：</p>
<ol>
<li><strong>Self-Questioning（自主提问）</strong>：Agent自主探索环境，生成多样化任务，消除昂贵的手动数据集构建成本</li>
<li><strong>Self-Navigating（自主导航）</strong>：总结和复用跨任务经验，引导更高质量的探索，提升探索效率</li>
<li><strong>Self-Attributing（自主归因）</strong>：处理长轨迹，发现中间步骤的因果贡献，实现细粒度和高效的政策优化</li>
</ol>
<p><strong>项目解决的核心问题</strong>：</p>
<ul>
<li>Agent训练需要大量人工标注数据集，成本高昂</li>
<li>缺乏自主探索能力，难以发现新任务</li>
<li>经验无法有效复用，探索效率低下</li>
<li>长轨迹中的信用分配不精确，政策优化效率低</li>
<li>不同环境集成困难，缺乏统一的训练框架</li>
</ul>
<p><strong>面向的用户群体</strong>：</p>
<ul>
<li>AI Agent研究和开发者</li>
<li>需要训练自主Agent的研究人员</li>
<li>希望降低Agent训练成本的企业</li>
<li>对自进化系统感兴趣的技术人员</li>
</ul>
<h3 data-id="heading-5">作者/团队介绍</h3>
<p><strong>团队：ModelScope</strong></p>
<ul>
<li><strong>背景</strong>：阿里巴巴达摩院ModelScope团队，专注于AI模型和系统开发</li>
<li><strong>贡献者</strong>：10位贡献者，包括 @YunpengZhai、@TaoShuchang、@Xinji-Mai 等</li>
<li><strong>理念</strong>：构建高效、自主、可进化的AI Agent系统</li>
<li><strong>官网</strong>：modelscope.github.io/AgentEvolver</li>
</ul>
<p><strong>项目创建时间</strong>：2024年（从GitHub活动来看是持续活跃的项目）</p>
<h3 data-id="heading-6">项目数据</h3>
<ul>
<li>⭐ <strong>GitHub Stars</strong>: 1.1k+（持续增长）</li>
<li>🍴 <strong>Forks</strong>: 128+</li>
<li>📦 <strong>版本</strong>: 最新版本（持续更新）</li>
<li>📄 <strong>License</strong>: Apache-2.0（完全开源，自由使用）</li>
<li>🌐 <strong>官网</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelscope.github.io%2FAgentEvolver" target="_blank" title="https://modelscope.github.io/AgentEvolver" ref="nofollow noopener noreferrer">modelscope.github.io/AgentEvolve…</a></li>
<li>📚 <strong>文档</strong>: 包含完整的使用指南和API文档</li>
<li>💬 <strong>社区</strong>: GitHub Issues活跃</li>
<li>📊 <strong>论文</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2511.10395" target="_blank" title="https://arxiv.org/abs/2511.10395" ref="nofollow noopener noreferrer">arXiv:2511.10395</a></li>
</ul>
<p><strong>项目发展历程</strong>：</p>
<ul>
<li>2024年：项目创建，开始构建核心自进化机制</li>
<li>2024-2025年：完善三大机制，添加多环境支持</li>
<li>2025年：发布论文，在AppWorld和BFCL-v3基准测试中取得优异表现</li>
<li>2026年：持续优化，添加Game Arena多智能体场景支持</li>
</ul>
<hr/>
<h2 data-id="heading-7">主要功能</h2>
<h3 data-id="heading-8">核心作用</h3>
<p>AgentEvolver的核心作用是<strong>构建高效的自进化Agent系统</strong>，让AI Agent能够：</p>
<ol>
<li><strong>自主生成任务</strong>：通过Self-Questioning机制，Agent自主探索环境并生成多样化任务</li>
<li><strong>经验引导探索</strong>：通过Self-Navigating机制，总结和复用跨任务经验，提升探索效率</li>
<li><strong>精细信用分配</strong>：通过Self-Attributing机制，精确识别长轨迹中关键步骤的贡献</li>
<li><strong>高效政策优化</strong>：基于精细的信用分配，实现更高效的政策优化</li>
</ol>
<h3 data-id="heading-9">使用场景</h3>
<ol>
<li>
<p><strong>Agent训练和研究</strong></p>
<ul>
<li>训练自主探索的AI Agent</li>
<li>研究自进化机制的有效性</li>
<li>降低Agent训练成本</li>
</ul>
</li>
<li>
<p><strong>复杂环境交互</strong></p>
<ul>
<li>AppWorld应用操作任务</li>
<li>BFCL-v3复杂推理任务</li>
<li>多智能体社交游戏（Avalon、Diplomacy）</li>
</ul>
</li>
<li>
<p><strong>任务自动生成</strong></p>
<ul>
<li>自动发现环境中的新任务</li>
<li>生成多样化的训练数据</li>
<li>减少人工标注成本</li>
</ul>
</li>
<li>
<p><strong>经验复用和优化</strong></p>
<ul>
<li>跨任务经验总结和复用</li>
<li>提升探索效率</li>
<li>加速Agent学习</li>
</ul>
</li>
</ol>
<h3 data-id="heading-10">快速开始</h3>
<h4 data-id="heading-11">安装方式</h4>
<p>AgentEvolver需要conda和CUDA工具包：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Step 1: 基础依赖安装</span>
bash install.sh

<span class="hljs-comment"># Step 2: 设置环境服务（以AppWorld为例）</span>
<span class="hljs-built_in">cd</span> env_service/environments/appworld &amp;&amp; bash setup.sh

<span class="hljs-comment"># Step 3: 设置ReMe（可选，用于经验管理）</span>
bash external/reme/install_reme.sh

<span class="hljs-comment"># Step 4: 开始训练</span>
conda activate agentevolver

<span class="hljs-comment"># 方式1: 基础示例（不使用ReMe）</span>
python launcher.py --conf examples/basic.yaml --with-appworld

<span class="hljs-comment"># 方式2: 完整示例（使用ReMe，包含questioning + navigating + attributing）</span>
python launcher.py --conf examples/overall.yaml --with-appworld --with-reme
</code></pre>
<h4 data-id="heading-12">前置要求</h4>
<ul>
<li><strong>conda</strong>：用于环境管理</li>
<li><strong>CUDA工具包</strong>：用于GPU加速</li>
<li><strong>Python 3.x</strong>：主要编程语言</li>
</ul>
<h4 data-id="heading-13">最简单的使用示例</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 复制配置文件</span>
<span class="hljs-built_in">cp</span> example.env .<span class="hljs-built_in">env</span>

<span class="hljs-comment"># 修改.env文件，设置API key和conda路径</span>
<span class="hljs-comment"># 然后运行训练</span>

<span class="hljs-comment"># 基础训练（使用环境内置数据集）</span>
python launcher.py --conf examples/basic.yaml --with-appworld

<span class="hljs-comment"># 完整自进化训练</span>
python launcher.py --conf examples/overall.yaml --with-appworld --with-reme
</code></pre>
<h3 data-id="heading-14">核心特性</h3>
<ul>
<li><strong>Self-Questioning（自主提问）</strong>：Agent自主探索环境，生成多样化任务，消除手动数据集构建成本</li>
<li><strong>Self-Navigating（自主导航）</strong>：总结和复用跨任务经验，引导高质量探索，提升探索效率</li>
<li><strong>Self-Attributing（自主归因）</strong>：处理长轨迹，发现中间步骤的因果贡献，实现精细政策优化</li>
<li><strong>环境兼容性</strong>：标准化接口，无缝集成各种外部环境和工具API</li>
<li><strong>灵活上下文管理</strong>：内置工具管理多轮上下文和复杂交互逻辑</li>
<li><strong>模块化架构</strong>：解耦组件，易于定制、二次开发和算法升级</li>
<li><strong>Game Arena支持</strong>：扩展到多智能体社交游戏环境，支持交互、评估和训练</li>
</ul>
<h3 data-id="heading-15">项目优势</h3>















































<table><thead><tr><th align="left">对比项</th><th align="left">AgentEvolver</th><th align="left">传统Agent训练</th><th align="left">其他自进化框架</th></tr></thead><tbody><tr><td align="left"><strong>任务生成</strong></td><td align="left">✅ 自主生成</td><td align="left">❌ 需要人工标注</td><td align="left">⚠️ 部分支持</td></tr><tr><td align="left"><strong>经验复用</strong></td><td align="left">✅ 跨任务经验总结</td><td align="left">❌ 无法复用</td><td align="left">⚠️ 有限复用</td></tr><tr><td align="left"><strong>信用分配</strong></td><td align="left">✅ 精细归因</td><td align="left">⚠️ 粗粒度</td><td align="left">⚠️ 中等精度</td></tr><tr><td align="left"><strong>训练效率</strong></td><td align="left">✅ 高效</td><td align="left">❌ 成本高昂</td><td align="left">⚠️ 中等</td></tr><tr><td align="left"><strong>环境支持</strong></td><td align="left">✅ 标准化接口</td><td align="left">⚠️ 需要适配</td><td align="left">⚠️ 有限支持</td></tr><tr><td align="left"><strong>多智能体</strong></td><td align="left">✅ Game Arena</td><td align="left">❌ 不支持</td><td align="left">⚠️ 部分支持</td></tr></tbody></table>
<p><strong>为什么选择AgentEvolver？</strong></p>
<p>相比传统Agent训练方法，AgentEvolver通过三大自进化机制实现自主任务生成、经验复用和精细信用分配，大幅降低训练成本，提升训练效率，在AppWorld和BFCL-v3基准测试中表现优异。</p>
<hr/>
<h2 data-id="heading-16">项目详细剖析</h2>
<h3 data-id="heading-17">架构设计</h3>
<p>AgentEvolver采用<strong>面向服务的数据流架构</strong>，将环境沙箱、LLM和经验管理无缝集成到模块化服务中。</p>
<h4 data-id="heading-18">核心架构</h4>
<pre><code class="hljs language-arduino" lang="arduino">AgentEvolver System
├── Environment Service（环境服务）
│   ├── AppWorld环境
│   ├── BFCL-v3环境
│   ├── Game Arena（Avalon、Diplomacy）
│   └── 自定义环境接口
├── LLM Service（LLM服务）
│   ├── Qwen2<span class="hljs-number">.5</span><span class="hljs-number">-7B</span>/<span class="hljs-number">14B</span>
│   ├── 其他LLM支持
│   └── API调用封装
├── Experience Manager（经验管理器）
│   ├── ReMe集成
│   ├── 经验池管理
│   └── 经验总结和复用
├── <span class="hljs-built_in">Task</span> Manager（任务管理器）
│   ├── 任务探索
│   ├── 合成任务生成
│   └── 训练数据管理
└── Advantage Processor（优势处理器）
    ├── ADCA-GRPO算法
    ├── 信用分配
    └── 政策优化
</code></pre>
<h4 data-id="heading-19">Self-Questioning机制</h4>
<p>Self-Questioning让Agent自主探索环境并生成多样化任务：</p>
<p><strong>工作流程</strong>：</p>
<ol>
<li>Agent在环境中自主探索</li>
<li>发现环境中的新任务和挑战</li>
<li>自动生成任务描述和训练数据</li>
<li>消除昂贵的手动数据集构建成本</li>
</ol>
<p><strong>优势</strong>：</p>
<ul>
<li>任务多样性高，覆盖环境中的各种场景</li>
<li>无需人工标注，大幅降低成本</li>
<li>任务质量高，基于实际环境探索</li>
</ul>
<h4 data-id="heading-20">Self-Navigating机制</h4>
<p>Self-Navigating通过经验总结和复用提升探索效率：</p>
<p><strong>工作流程</strong>：</p>
<ol>
<li>总结跨任务的成功经验</li>
<li>构建经验知识库</li>
<li>在新任务中复用相关经验</li>
<li>引导更高质量的探索</li>
</ol>
<p><strong>优势</strong>：</p>
<ul>
<li>探索效率显著提升</li>
<li>经验可复用，避免重复探索</li>
<li>引导更高质量的策略</li>
</ul>
<h4 data-id="heading-21">Self-Attributing机制</h4>
<p>Self-Attributing通过精细信用分配实现高效政策优化：</p>
<p><strong>工作流程</strong>：</p>
<ol>
<li>分析长轨迹中的中间步骤</li>
<li>识别关键步骤的因果贡献</li>
<li>基于贡献分配信用</li>
<li>实现精细的政策优化</li>
</ol>
<p><strong>优势</strong>：</p>
<ul>
<li>信用分配精确，避免错误归因</li>
<li>政策优化效率高</li>
<li>支持长轨迹处理</li>
</ul>
<h3 data-id="heading-22">性能表现</h3>
<p>AgentEvolver在AppWorld和BFCL-v3基准测试中表现优异：</p>
<h4 data-id="heading-23">AppWorld基准测试</h4>
<ul>
<li><strong>Qwen2.5-7B + AgentEvolver</strong>：avg@8: 32.4%, best@8: 51.2%</li>
<li><strong>Qwen2.5-14B + AgentEvolver</strong>：avg@8: 48.7%, best@8: 69.4%</li>
</ul>
<p>相比基线模型，性能提升显著：</p>
<ul>
<li>7B模型：从1.8%提升到32.4%（avg@8）</li>
<li>14B模型：从18.0%提升到48.7%（avg@8）</li>
</ul>
<h4 data-id="heading-24">BFCL-v3基准测试</h4>
<ul>
<li><strong>Qwen2.5-7B + AgentEvolver</strong>：avg@8: 57.9%, best@8: 69.0%</li>
<li><strong>Qwen2.5-14B + AgentEvolver</strong>：avg@8: 66.5%, best@8: 76.7%</li>
</ul>
<p>相比基线模型，性能提升显著：</p>
<ul>
<li>7B模型：从29.8%提升到57.9%（avg@8）</li>
<li>14B模型：从41.6%提升到66.5%（avg@8）</li>
</ul>
<h4 data-id="heading-25">机制消融实验</h4>
<p>实验表明，三大机制协同工作效果最佳：</p>
<ul>
<li><strong>+Questioning</strong>：显著提升性能</li>
<li><strong>+Questioning&amp;Navigating</strong>：进一步提升探索效率</li>
<li><strong>+Questioning&amp;Attributing</strong>：精细优化带来额外提升</li>
<li><strong>AgentEvolver（完整）</strong>：三大机制协同，性能最优</li>
</ul>
<h3 data-id="heading-26">Game Arena多智能体场景</h3>
<p>AgentEvolver Game Arena扩展了AgentEvolver到多智能体社交游戏环境：</p>
<h4 data-id="heading-27">核心能力</h4>
<ul>
<li><strong>Web界面交互</strong>：实时观察AI Agent的推理和通信，或作为人类玩家参与</li>
<li><strong>可扩展评估</strong>：运行大规模自对弈或混合模型锦标赛，支持配置和排行榜</li>
<li><strong>端到端训练</strong>：在社交游戏环境中使用强化学习方法（如GRPO）直接训练LLM Agent</li>
</ul>
<h4 data-id="heading-28">支持的游戏</h4>
<ul>
<li><strong>Avalon（阿瓦隆）</strong>：社交推理游戏，测试Agent的推理和沟通能力</li>
<li><strong>Diplomacy（外交）</strong>：复杂的多智能体策略游戏，测试长期规划和协作能力</li>
</ul>
<h4 data-id="heading-29">训练示例</h4>
<p>在Avalon游戏中训练assassin角色的训练曲线显示，AgentEvolver能够有效提升Agent在复杂社交推理任务中的表现。</p>
<h3 data-id="heading-30">环境兼容性</h3>
<p>AgentEvolver提供标准化接口，支持无缝集成各种外部环境：</p>
<h4 data-id="heading-31">环境接口</h4>
<ul>
<li><strong>标准化接口</strong>：统一的环境接口规范</li>
<li><strong>工具API集成</strong>：支持各种工具和API的集成</li>
<li><strong>自定义环境</strong>：易于添加自定义环境</li>
</ul>
<h4 data-id="heading-32">支持的环境</h4>
<ul>
<li><strong>AppWorld</strong>：应用操作任务环境</li>
<li><strong>BFCL-v3</strong>：复杂推理任务环境</li>
<li><strong>Game Arena</strong>：多智能体社交游戏环境</li>
<li><strong>自定义环境</strong>：通过标准接口集成</li>
</ul>
<h3 data-id="heading-33">经验管理（ReMe）</h3>
<p>AgentEvolver集成ReMe进行经验管理：</p>
<h4 data-id="heading-34">功能</h4>
<ul>
<li><strong>经验总结</strong>：总结跨任务的成功经验</li>
<li><strong>经验池管理</strong>：管理经验池的存储和检索</li>
<li><strong>经验复用</strong>：在新任务中复用相关经验</li>
</ul>
<h4 data-id="heading-35">使用</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 安装ReMe</span>
bash external/reme/install_reme.sh

<span class="hljs-comment"># 使用ReMe进行训练</span>
python launcher.py --conf examples/overall.yaml --with-appworld --with-reme
</code></pre>
<hr/>
<h2 data-id="heading-36">项目地址与资源</h2>
<h3 data-id="heading-37">官方资源</h3>
<ul>
<li>🌟 <strong>GitHub</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmodelscope%2FAgentEvolver" target="_blank" title="https://github.com/modelscope/AgentEvolver" ref="nofollow noopener noreferrer">github.com/modelscope/…</a></li>
<li>🌐 <strong>官网</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelscope.github.io%2FAgentEvolver" target="_blank" title="https://modelscope.github.io/AgentEvolver" ref="nofollow noopener noreferrer">modelscope.github.io/AgentEvolve…</a></li>
<li>📄 <strong>论文</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2511.10395" target="_blank" title="https://arxiv.org/abs/2511.10395" ref="nofollow noopener noreferrer">arXiv:2511.10395</a></li>
</ul>
<h3 data-id="heading-38">适用人群</h3>
<p><strong>AgentEvolver特别适合</strong>：AI Agent研究和开发者、需要训练自主Agent的研究人员、希望降低Agent训练成本的企业、对自进化系统感兴趣的技术人员、需要多智能体训练的研究团队。</p>
<p><strong>不适合</strong>：只需要简单Agent的用户、不需要自主学习的场景、缺乏强化学习背景的开发者。</p>
<hr/>
<p><em>欢迎来我中的<a href="https://link.juejin.cn?target=https%3A%2F%2Fhome.wonlab.top" target="_blank" title="https://home.wonlab.top" ref="nofollow noopener noreferrer">个人主页</a>找到更多有用的知识和有趣的产品</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android 15 Binder驱动与内核机制深度解析]]></title>    <link>https://juejin.cn/post/7602082590733025316</link>    <guid>https://juejin.cn/post/7602082590733025316</guid>    <pubDate>2026-02-02T12:19:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602082590733025316" data-draft-id="7602106969698041919" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android 15 Binder驱动与内核机制深度解析"/> <meta itemprop="keywords" content="Android,操作系统,性能优化"/> <meta itemprop="datePublished" content="2026-02-02T12:19:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="冬奇Lab"/> <meta itemprop="url" content="https://juejin.cn/user/1857501105781193"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android 15 Binder驱动与内核机制深度解析
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1857501105781193/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    冬奇Lab
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T12:19:59.000Z" title="Mon Feb 02 2026 12:19:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读17分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">引言</h2>
<p>如果你曾经好奇Android应用是如何跨进程调用系统服务的,或者为什么Binder被称为Android的"神经系统",那么这篇文章就是为你准备的。</p>
<p>作为Android系统最核心的IPC(进程间通信)机制,Binder不仅是应用与系统服务交互的桥梁,更是整个Android生态的基石。从应用启动、四大组件通信,到系统服务调用,处处都有Binder的身影。掌握Binder,你就掌握了理解Android系统运行机制的钥匙。</p>
<p>本文将深入Android 15源码,从内核驱动层面剖析Binder的设计哲学、实现原理和工作机制。我们不仅要看代码,更要理解背后的"为什么"——为什么Android要设计一个全新的IPC机制?它相比传统Linux IPC有什么优势?</p>
<p><strong>你将学到:</strong></p>
<ul>
<li>Binder的设计哲学与架构全景</li>
<li>Binder驱动的内核实现细节</li>
<li>一次拷贝的内存映射机制</li>
<li>Binder协议结构与命令交互</li>
<li>从源码角度理解Binder工作流程</li>
</ul>
<h2 data-id="heading-1">为什么需要Binder?</h2>
<p>在深入技术细节之前,我们先回答一个本质问题:Android为什么要重新发明轮子,而不是用Linux已有的IPC机制?</p>
<h3 data-id="heading-2">传统Linux IPC的局限</h3>
<p>Linux提供了多种IPC机制:管道(Pipe)、消息队列(Message Queue)、共享内存(Shared Memory)、Socket等。它们都能实现进程间通信,但在移动场景下都有明显的短板:</p>








































<table><thead><tr><th align="left">IPC机制</th><th align="center">数据拷贝次数</th><th align="center">安全性</th><th align="center">面向对象</th><th align="left">适用场景</th></tr></thead><tbody><tr><td align="left">管道/消息队列</td><td align="center">2次</td><td align="center">弱</td><td align="center">否</td><td align="left">单向数据流</td></tr><tr><td align="left">Socket</td><td align="center">2次</td><td align="center">中</td><td align="center">否</td><td align="left">网络通信</td></tr><tr><td align="left">共享内存</td><td align="center">0次</td><td align="center">无</td><td align="center">否</td><td align="left">需配合其他机制</td></tr><tr><td align="left"><strong>Binder</strong></td><td align="center"><strong>1次</strong></td><td align="center"><strong>强</strong></td><td align="center"><strong>是</strong></td><td align="left"><strong>移动系统服务</strong></td></tr></tbody></table>
<p><strong>性能问题</strong>:传统IPC通常需要2次数据拷贝(用户空间→内核空间→用户空间),在高频调用场景下性能损耗明显。</p>
<p><strong>安全问题</strong>:传统IPC缺乏完善的身份认证机制。Socket虽然可以通过UID/PID验证,但需要额外编码。移动系统需要更严格的权限控制。</p>
<p><strong>面向对象</strong>:Android是基于Java的面向对象系统,需要能直接传递对象引用、支持接口调用的IPC机制。</p>
<h3 data-id="heading-3">Binder的设计目标</h3>
<p>Binder的设计充分考虑了移动系统的特点:</p>
<ol>
<li><strong>高性能</strong>:一次拷贝,通过内存映射减少数据传输开销</li>
<li><strong>强安全</strong>:内核级身份验证,支持UID/PID/SELINUX三重防护</li>
<li><strong>面向对象</strong>:天然支持对象引用、接口调用、生命周期管理</li>
<li><strong>稳定性</strong>:支持死亡通知、引用计数,服务异常能及时感知</li>
</ol>
<blockquote>
<p>💡 <strong>有趣的历史</strong>: Binder最初来自OpenBinder项目,由Be Inc.(后被Palm收购)开发。Google收购Android后,将其移植到Linux内核,成为Android的核心组件。</p>
</blockquote>
<h2 data-id="heading-4">Binder架构全景</h2>
<p>在深入驱动实现前,我们先从整体上理解Binder的分层架构。</p>
<h3 data-id="heading-5">四层架构</h3>
<p>Binder采用经典的C/S(Client-Server)架构,由四个主要部分组成:</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1f3fafa92d114b85ae8b10c04c5ea2c7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770639599&amp;x-signature=EQzEumebw8c12iElwYGqgm2v%2Bfs%3D" alt="09-01-binder-architecture.png" loading="lazy"/></p>
<p><em>图1: Binder三层架构 - Client和Server通过Binder Driver进行IPC通信</em></p>
<p><strong>用户空间</strong>:</p>
<ul>
<li><strong>BpBinder</strong>(Proxy Binder):客户端代理,持有远程Binder的引用(handle)</li>
<li><strong>BBinder</strong>(Base Binder):服务端实体,真正提供服务的对象</li>
</ul>
<p><strong>内核空间</strong>:</p>
<ul>
<li><strong>Binder Driver</strong>:内核驱动,管理所有Binder通信的中枢</li>
</ul>
<h3 data-id="heading-6">核心概念</h3>
<p>理解Binder必须掌握几个核心概念:</p>
<p><strong>1. Binder实体与引用</strong></p>
<ul>
<li><strong>Binder实体</strong>(binder_node):服务端的真实对象,存在于Server进程</li>
<li><strong>Binder引用</strong>(binder_ref):客户端持有的远程对象引用,通过handle标识</li>
</ul>
<p>这类似于指针和句柄的关系:Server持有对象的实际地址,Client持有一个整数句柄,通过驱动映射到真实对象。</p>
<p><strong>2. 进程与线程上下文</strong></p>
<ul>
<li><strong>binder_proc</strong>:每个使用Binder的进程在驱动中都有一个binder_proc结构,维护该进程的所有Binder状态</li>
<li><strong>binder_thread</strong>:每个参与Binder通信的线程在驱动中都有一个binder_thread结构,管理线程的工作队列</li>
</ul>
<p><strong>3. 数据缓冲区</strong></p>
<ul>
<li><strong>binder_buffer</strong>:驱动为每次通信分配的数据缓冲区,存储传输的数据</li>
</ul>
<h2 data-id="heading-7">Binder驱动初始化</h2>
<p>让我们从源码角度看Binder驱动是如何初始化的。</p>
<h3 data-id="heading-8">ProcessState:进程单例</h3>
<p>每个使用Binder的进程都会创建一个<code>ProcessState</code>单例对象,负责打开Binder驱动并进行初始化。</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ProcessState.cpp (Android 15)</span>
<span class="hljs-function">sp&lt;ProcessState&gt; <span class="hljs-title">ProcessState::self</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">init</span>(kDefaultDriver, <span class="hljs-literal">false</span>);
}

<span class="hljs-function">sp&lt;ProcessState&gt; <span class="hljs-title">ProcessState::init</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span>* driver, <span class="hljs-type">bool</span> requireDefault)</span> </span>{
    <span class="hljs-comment">// ...</span>
    std::<span class="hljs-built_in">call_once</span>(gProcessOnce, [&amp;](){
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">access</span>(driver, R_OK) == <span class="hljs-number">-1</span>) {
            <span class="hljs-built_in">ALOGE</span>(<span class="hljs-string">"Binder driver %s is unavailable."</span>, driver);
            driver = <span class="hljs-string">"/dev/binder"</span>;
        }

        <span class="hljs-comment">// 创建全局单例</span>
        gProcess = sp&lt;ProcessState&gt;::<span class="hljs-built_in">make</span>(driver);
    });
    <span class="hljs-keyword">return</span> gProcess;
}
</code></pre>
<h3 data-id="heading-9">打开设备节点</h3>
<p>ProcessState构造时会打开<code>/dev/binder</code>设备节点:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ProcessState.cpp</span>
ProcessState::<span class="hljs-built_in">ProcessState</span>(<span class="hljs-type">const</span> <span class="hljs-type">char</span>* driver)
    : <span class="hljs-built_in">mDriverName</span>(<span class="hljs-built_in">String8</span>(driver))
    , <span class="hljs-built_in">mDriverFD</span>(<span class="hljs-number">-1</span>)  <span class="hljs-comment">// Binder驱动文件描述符</span>
    , <span class="hljs-built_in">mVMStart</span>(MAP_FAILED)  <span class="hljs-comment">// mmap映射的起始地址</span>
    , <span class="hljs-built_in">mThreadCountLock</span>(PTHREAD_MUTEX_INITIALIZER)
    , <span class="hljs-built_in">mThreadCountDecrement</span>(PTHREAD_COND_INITIALIZER)
    , <span class="hljs-built_in">mExecutingThreadsCount</span>(<span class="hljs-number">0</span>)
    , <span class="hljs-built_in">mWaitingForThreads</span>(<span class="hljs-number">0</span>)
    , <span class="hljs-built_in">mMaxThreads</span>(DEFAULT_MAX_BINDER_THREADS)  <span class="hljs-comment">// 默认15个线程</span>
    , <span class="hljs-built_in">mStarvationStartTimeMs</span>(<span class="hljs-number">0</span>)
    , <span class="hljs-built_in">mForked</span>(<span class="hljs-literal">false</span>)
    , <span class="hljs-built_in">mThreadPoolStarted</span>(<span class="hljs-literal">false</span>)
    , <span class="hljs-built_in">mThreadPoolSeq</span>(<span class="hljs-number">1</span>)
    , <span class="hljs-built_in">mCallRestriction</span>(CallRestriction::NONE) {

    <span class="hljs-comment">// 打开Binder驱动</span>
    mDriverFD = <span class="hljs-built_in">open</span>(driver, O_RDWR | O_CLOEXEC);

    <span class="hljs-keyword">if</span> (mDriverFD &gt;= <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// 关键步骤:通过mmap映射内核缓冲区</span>
        mVMStart = <span class="hljs-built_in">mmap</span>(<span class="hljs-literal">nullptr</span>, BINDER_VM_SIZE,  <span class="hljs-comment">// 默认 1MB - 8KB</span>
                       PROT_READ,                  <span class="hljs-comment">// 只读映射</span>
                       MAP_PRIVATE | MAP_NORESERVE,
                       mDriverFD, <span class="hljs-number">0</span>);

        <span class="hljs-keyword">if</span> (mVMStart == MAP_FAILED) {
            <span class="hljs-built_in">close</span>(mDriverFD);
            mDriverFD = <span class="hljs-number">-1</span>;
        }
    }
}
</code></pre>
<p><strong>关键点解析</strong>:</p>
<ol>
<li><strong>设备节点</strong>:<code>/dev/binder</code>是Binder驱动注册的字符设备</li>
<li><strong>内存映射</strong>:通过<code>mmap</code>将内核缓冲区映射到进程地址空间,这是实现一次拷贝的关键</li>
<li><strong>映射大小</strong>:默认<code>(1MB - 8KB)</code>,对大多数场景足够</li>
<li><strong>只读映射</strong>:用户空间只能读取,不能直接写入,保证安全性</li>
</ol>
<h3 data-id="heading-10">BINDER_VM_SIZE的计算</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ProcessState.cpp</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BINDER_VM_SIZE ((1 * 1024 * 1024) - sysconf(_SC_PAGE_SIZE) * 2)</span>
</code></pre>
<p>为什么要减去2个页面(通常是8KB)?</p>
<ul>
<li>预留一些空间作为保护页(guard page)</li>
<li>避免越界访问导致的内存错误</li>
<li>典型值:<code>1MB - 8KB = 1,040,384 bytes</code></li>
</ul>
<h2 data-id="heading-11">内存映射:一次拷贝的魔法</h2>
<p>Binder最引以为傲的特性就是"一次拷贝",这是如何实现的?</p>
<h3 data-id="heading-12">传统IPC的两次拷贝</h3>
<p>在传统IPC中,数据传输需要两次拷贝:</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-built_in">Client</span>用户空间 ──copy1──&gt; 内核空间 ──copy2──&gt; <span class="hljs-built_in">Server</span>用户空间
</code></pre>
<p>每次<code>copy</code>都需要CPU参与,在传输大数据时性能损耗明显。</p>
<h3 data-id="heading-13">Binder的一次拷贝</h3>
<p>Binder通过巧妙的内存映射设计,将拷贝次数减少到一次:</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fc0512d80946480baa0150bd96d64a07~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770639599&amp;x-signature=M2FRm80BWc0BnEPpZGvdl%2BdIOb8%3D" alt="09-02-binder-one-copy-mmap.png" loading="lazy"/>
<em>图2: Binder一次拷贝架构</em></p>
<p><strong>核心机制</strong>:</p>
<ol>
<li>Server进程启动时,通过<code>mmap</code>将内核中的binder_buffer映射到自己的用户空间</li>
<li>Client发送数据时,驱动通过<code>copy_from_user</code>将数据从Client用户空间拷贝到内核的binder_buffer</li>
<li>由于binder_buffer已经映射到Server用户空间,Server可以直接读取,无需第二次拷贝</li>
</ol>
<blockquote>
<p>🎯 <strong>关键洞察</strong>: 这里的映射是单向的——只有Server进程映射内核缓冲区,Client不映射。数据从Client→内核(一次拷贝),然后Server通过映射直接访问,总共一次拷贝。</p>
</blockquote>
<h3 data-id="heading-14">mmap在驱动中的实现</h3>
<p>当用户空间调用<code>mmap</code>时,会触发驱动的<code>binder_mmap</code>函数:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// 简化版的binder_mmap逻辑(基于Android 15)</span>
<span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title">binder_mmap</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> file *filp, <span class="hljs-keyword">struct</span> vm_area_struct *vma)</span> </span>{
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">binder_proc</span> *proc = filp-&gt;private_data;

    <span class="hljs-comment">// 计算映射大小</span>
    <span class="hljs-type">size_t</span> size = vma-&gt;vm_end - vma-&gt;vm_start;

    <span class="hljs-comment">// 分配物理页面</span>
    proc-&gt;pages = <span class="hljs-built_in">kcalloc</span>(proc-&gt;buffer_size / PAGE_SIZE,
                         <span class="hljs-built_in">sizeof</span>(proc-&gt;pages[<span class="hljs-number">0</span>]), GFP_KERNEL);

    <span class="hljs-comment">// 分配内核虚拟地址空间</span>
    proc-&gt;buffer = (<span class="hljs-type">void</span> *)<span class="hljs-built_in">vm_map_ram</span>(proc-&gt;pages,
                                     proc-&gt;buffer_size / PAGE_SIZE,
                                     <span class="hljs-number">-1</span>);

    <span class="hljs-comment">// 建立用户空间到内核空间的映射</span>
    <span class="hljs-comment">// 用户空间虚拟地址 &lt;-&gt; 物理页面 &lt;-&gt; 内核虚拟地址</span>
    <span class="hljs-keyword">for</span> (page_addr = vma-&gt;vm_start; page_addr &lt; vma-&gt;vm_end;
         page_addr += PAGE_SIZE) {
        page = &amp;proc-&gt;pages[(page_addr - vma-&gt;vm_start) / PAGE_SIZE];
        <span class="hljs-built_in">vm_insert_page</span>(vma, page_addr, page);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p><strong>映射建立流程</strong>:</p>
<ol>
<li>分配物理内存页面</li>
<li>在内核空间建立虚拟地址映射</li>
<li>在用户空间建立虚拟地址映射</li>
<li>两者都指向同一批物理页面</li>
</ol>
<p>这样,当驱动将数据写入内核虚拟地址时,用户空间映射的地址也能立即看到数据,无需额外拷贝。</p>
<h2 data-id="heading-15">Binder协议结构</h2>
<p>Binder使用基于命令的通信协议,Client和Server通过发送命令与驱动交互。</p>
<h3 data-id="heading-16">BC/BR命令</h3>
<p>Binder协议命令分为两类:</p>
<ul>
<li><strong>BC_</strong>(Binder Command):用户空间发送给驱动的命令</li>
<li><strong>BR_</strong>(Binder Return):驱动返回给用户空间的命令</li>
</ul>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// IPCThreadState.cpp - Android 15</span>
<span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">char</span>* kCommandStrings[] = {
    <span class="hljs-string">"BC_TRANSACTION"</span>,      <span class="hljs-comment">// 发起事务(调用远程方法)</span>
    <span class="hljs-string">"BC_REPLY"</span>,           <span class="hljs-comment">// 事务回复</span>
    <span class="hljs-string">"BC_ACQUIRE_RESULT"</span>,  <span class="hljs-comment">// 获取对象结果</span>
    <span class="hljs-string">"BC_FREE_BUFFER"</span>,     <span class="hljs-comment">// 释放缓冲区</span>
    <span class="hljs-string">"BC_INCREFS"</span>,         <span class="hljs-comment">// 增加弱引用</span>
    <span class="hljs-string">"BC_ACQUIRE"</span>,         <span class="hljs-comment">// 增加强引用</span>
    <span class="hljs-string">"BC_RELEASE"</span>,         <span class="hljs-comment">// 释放强引用</span>
    <span class="hljs-string">"BC_DECREFS"</span>,         <span class="hljs-comment">// 减少弱引用</span>
    <span class="hljs-string">"BC_REGISTER_LOOPER"</span>, <span class="hljs-comment">// 注册线程池线程</span>
    <span class="hljs-string">"BC_ENTER_LOOPER"</span>,    <span class="hljs-comment">// 进入消息循环</span>
    <span class="hljs-string">"BC_EXIT_LOOPER"</span>,     <span class="hljs-comment">// 退出消息循环</span>
    <span class="hljs-comment">// ... Android 15新增</span>
    <span class="hljs-string">"BC_REQUEST_FREEZE_NOTIFICATION"</span>,  <span class="hljs-comment">// 请求冻结通知</span>
    <span class="hljs-string">"BC_CLEAR_FREEZE_NOTIFICATION"</span>,    <span class="hljs-comment">// 清除冻结通知</span>
};

<span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">char</span>* kReturnStrings[] = {
    <span class="hljs-string">"BR_ERROR"</span>,            <span class="hljs-comment">// 错误</span>
    <span class="hljs-string">"BR_OK"</span>,              <span class="hljs-comment">// 成功</span>
    <span class="hljs-string">"BR_TRANSACTION"</span>,     <span class="hljs-comment">// 接收到事务请求</span>
    <span class="hljs-string">"BR_REPLY"</span>,           <span class="hljs-comment">// 接收到事务回复</span>
    <span class="hljs-string">"BR_DEAD_REPLY"</span>,      <span class="hljs-comment">// 对方已死亡</span>
    <span class="hljs-string">"BR_TRANSACTION_COMPLETE"</span>, <span class="hljs-comment">// 事务已完成</span>
    <span class="hljs-string">"BR_INCREFS"</span>,         <span class="hljs-comment">// 增加弱引用</span>
    <span class="hljs-string">"BR_ACQUIRE"</span>,         <span class="hljs-comment">// 增加强引用</span>
    <span class="hljs-string">"BR_RELEASE"</span>,         <span class="hljs-comment">// 释放强引用</span>
    <span class="hljs-string">"BR_DECREFS"</span>,         <span class="hljs-comment">// 减少弱引用</span>
    <span class="hljs-string">"BR_NOOP"</span>,            <span class="hljs-comment">// 空操作</span>
    <span class="hljs-string">"BR_SPAWN_LOOPER"</span>,    <span class="hljs-comment">// 建议创建新线程</span>
    <span class="hljs-string">"BR_DEAD_BINDER"</span>,     <span class="hljs-comment">// Binder对象已死亡</span>
    <span class="hljs-comment">// ... Android 15新增</span>
    <span class="hljs-string">"BR_FROZEN_BINDER"</span>,   <span class="hljs-comment">// Binder被冻结</span>
    <span class="hljs-string">"BR_ONEWAY_SPAM_SUSPECT"</span>, <span class="hljs-comment">// 单向调用垃圾检测</span>
};
</code></pre>
<h3 data-id="heading-17">核心数据结构</h3>
<p><strong>binder_transaction_data</strong>:描述一次Binder调用的数据</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">binder_transaction_data</span> {
    <span class="hljs-keyword">union</span> {
        <span class="hljs-type">size_t</span> handle;    <span class="hljs-comment">// 目标Binder引用(Client使用)</span>
        <span class="hljs-type">void</span> *ptr;        <span class="hljs-comment">// 目标Binder指针(Server使用)</span>
    } target;

    <span class="hljs-type">void</span> *cookie;         <span class="hljs-comment">// Server端私有数据</span>
    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> code;    <span class="hljs-comment">// 调用的方法编号</span>

    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> flags;   <span class="hljs-comment">// 标志位(同步/异步/单向)</span>
    <span class="hljs-meta">#<span class="hljs-keyword">define</span> TF_ONE_WAY   0x01  <span class="hljs-comment">// 单向调用,不等待回复</span></span>
    <span class="hljs-meta">#<span class="hljs-keyword">define</span> TF_ACCEPT_FDS 0x10 <span class="hljs-comment">// 接受文件描述符</span></span>

    <span class="hljs-type">pid_t</span> sender_pid;     <span class="hljs-comment">// 发送方进程ID</span>
    <span class="hljs-type">uid_t</span> sender_euid;    <span class="hljs-comment">// 发送方用户ID</span>

    <span class="hljs-type">size_t</span> data_size;     <span class="hljs-comment">// 数据大小</span>
    <span class="hljs-type">size_t</span> offsets_size;  <span class="hljs-comment">// 偏移数组大小(用于Binder对象)</span>

    <span class="hljs-keyword">union</span> {
        <span class="hljs-keyword">struct</span> {
            <span class="hljs-type">const</span> <span class="hljs-type">void</span> *buffer;  <span class="hljs-comment">// 数据缓冲区</span>
            <span class="hljs-type">const</span> <span class="hljs-type">void</span> *offsets; <span class="hljs-comment">// Binder对象偏移数组</span>
        } ptr;
        <span class="hljs-type">uint8_t</span> buf[<span class="hljs-number">8</span>];
    } data;
};
</code></pre>
<p><strong>关键字段解析</strong>:</p>
<ul>
<li><strong>target.handle</strong>:目标服务的句柄值,由驱动维护的引用ID</li>
<li><strong>code</strong>:要调用的方法编号,由AIDL生成器自动分配</li>
<li><strong>flags</strong>:标志位,最重要的是<code>TF_ONE_WAY</code>(单向调用)</li>
<li><strong>sender_pid/sender_euid</strong>:发送方身份,由<strong>驱动填充</strong>,无法伪造,这是Binder安全性的基础</li>
<li><strong>data.ptr.buffer</strong>:实际传输的数据</li>
<li><strong>data.ptr.offsets</strong>:数据中包含的Binder对象位置,驱动需要特殊处理</li>
</ul>
<h3 data-id="heading-18">ioctl交互</h3>
<p>用户空间通过<code>ioctl</code>系统调用与驱动交互:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// IPCThreadState.cpp</span>
<span class="hljs-function"><span class="hljs-type">status_t</span> <span class="hljs-title">IPCThreadState::talkWithDriver</span><span class="hljs-params">(<span class="hljs-type">bool</span> doReceive)</span> </span>{
    binder_write_read bwr;

    <span class="hljs-comment">// 准备写入数据</span>
    bwr.write_size = mOut.<span class="hljs-built_in">dataSize</span>();
    bwr.write_buffer = (<span class="hljs-type">uintptr_t</span>)mOut.<span class="hljs-built_in">data</span>();

    <span class="hljs-comment">// 准备读取数据</span>
    bwr.read_size = mIn.<span class="hljs-built_in">dataCapacity</span>();
    bwr.read_buffer = (<span class="hljs-type">uintptr_t</span>)mIn.<span class="hljs-built_in">data</span>();

    <span class="hljs-comment">// 核心:调用ioctl</span>
    <span class="hljs-type">status_t</span> err = <span class="hljs-built_in">ioctl</span>(mProcess-&gt;mDriverFD, BINDER_WRITE_READ, &amp;bwr);

    <span class="hljs-comment">// 处理返回结果</span>
    <span class="hljs-keyword">if</span> (bwr.write_consumed &gt; <span class="hljs-number">0</span>) {
        mOut.<span class="hljs-built_in">remove</span>(<span class="hljs-number">0</span>, bwr.write_consumed);
    }
    <span class="hljs-keyword">if</span> (bwr.read_consumed &gt; <span class="hljs-number">0</span>) {
        mIn.<span class="hljs-built_in">setDataSize</span>(bwr.read_consumed);
    }

    <span class="hljs-keyword">return</span> err;
}
</code></pre>
<p><strong>binder_write_read结构</strong>:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">binder_write_read</span> {
    <span class="hljs-type">signed</span> <span class="hljs-type">long</span> write_size;      <span class="hljs-comment">// 要写入的字节数</span>
    <span class="hljs-type">signed</span> <span class="hljs-type">long</span> write_consumed;  <span class="hljs-comment">// 驱动已消费的字节数</span>
    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> write_buffer;  <span class="hljs-comment">// 写缓冲区地址</span>

    <span class="hljs-type">signed</span> <span class="hljs-type">long</span> read_size;       <span class="hljs-comment">// 读缓冲区大小</span>
    <span class="hljs-type">signed</span> <span class="hljs-type">long</span> read_consumed;   <span class="hljs-comment">// 驱动已填充的字节数</span>
    <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> read_buffer;   <span class="hljs-comment">// 读缓冲区地址</span>
};
</code></pre>
<blockquote>
<p>💡 <strong>设计巧思</strong>: 一次ioctl调用同时支持读和写,减少系统调用次数。驱动会先处理write_buffer中的命令,再填充read_buffer返回数据。</p>
</blockquote>
<h2 data-id="heading-19">Binder通信流程</h2>
<p>理解了基础概念后,让我们看一次完整的Binder调用是如何完成的。</p>
<h3 data-id="heading-20">发起调用(Client侧)</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// BpBinder.cpp (Android 15)</span>
<span class="hljs-function"><span class="hljs-type">status_t</span> <span class="hljs-title">BpBinder::transact</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> code, <span class="hljs-type">const</span> Parcel&amp; data,
                           Parcel* reply, <span class="hljs-type">uint32_t</span> flags)</span> </span>{
    <span class="hljs-comment">// 检查Binder是否存活</span>
    <span class="hljs-keyword">if</span> (mAlive) {
        <span class="hljs-comment">// 委托给IPCThreadState执行</span>
        <span class="hljs-type">status_t</span> status = IPCThreadState::<span class="hljs-built_in">self</span>()-&gt;<span class="hljs-built_in">transact</span>(
            mHandle,  <span class="hljs-comment">// 目标服务的handle</span>
            code,     <span class="hljs-comment">// 方法编号</span>
            data,     <span class="hljs-comment">// 参数数据</span>
            reply,    <span class="hljs-comment">// 回复数据</span>
            flags);   <span class="hljs-comment">// 标志位</span>

        <span class="hljs-keyword">if</span> (status == DEAD_OBJECT) mAlive = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">return</span> status;
    }
    <span class="hljs-keyword">return</span> DEAD_OBJECT;
}
</code></pre>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// IPCThreadState.cpp</span>
<span class="hljs-function"><span class="hljs-type">status_t</span> <span class="hljs-title">IPCThreadState::transact</span><span class="hljs-params">(<span class="hljs-type">int32_t</span> handle, <span class="hljs-type">uint32_t</span> code,
                                 <span class="hljs-type">const</span> Parcel&amp; data, Parcel* reply,
                                 <span class="hljs-type">uint32_t</span> flags)</span> </span>{
    <span class="hljs-comment">// 准备binder_transaction_data</span>
    binder_transaction_data tr;
    tr.target.handle = handle;
    tr.code = code;
    tr.flags = flags;

    <span class="hljs-comment">// 写入BC_TRANSACTION命令</span>
    <span class="hljs-built_in">writeTransactionData</span>(BC_TRANSACTION, flags, handle, code, data, <span class="hljs-literal">nullptr</span>);

    <span class="hljs-keyword">if</span> (flags &amp; TF_ONE_WAY) {
        <span class="hljs-comment">// 单向调用:发送后立即返回</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">waitForResponse</span>(<span class="hljs-literal">nullptr</span>, <span class="hljs-literal">nullptr</span>);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// 同步调用:等待BR_REPLY</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">waitForResponse</span>(reply);
    }
}
</code></pre>
<h3 data-id="heading-21">驱动处理(Kernel侧)</h3>
<p>驱动的核心函数是<code>binder_ioctl</code>,处理所有ioctl调用:</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// binder.c (内核驱动)</span>
<span class="hljs-type">static</span> <span class="hljs-type">long</span> <span class="hljs-title function_">binder_ioctl</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> file *filp, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> cmd,
                        <span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> arg)</span> {
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">binder_proc</span> *<span class="hljs-title">proc</span> =</span> filp-&gt;private_data;
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">binder_thread</span> *<span class="hljs-title">thread</span>;</span>

    <span class="hljs-keyword">switch</span> (cmd) {
    <span class="hljs-keyword">case</span> BINDER_WRITE_READ: {
        <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">binder_write_read</span> <span class="hljs-title">bwr</span>;</span>
        copy_from_user(&amp;bwr, (<span class="hljs-type">void</span> __user *)arg, <span class="hljs-keyword">sizeof</span>(bwr));

        <span class="hljs-comment">// 处理写入命令</span>
        <span class="hljs-keyword">if</span> (bwr.write_size &gt; <span class="hljs-number">0</span>) {
            binder_thread_write(proc, thread,
                               bwr.write_buffer, bwr.write_size);
        }

        <span class="hljs-comment">// 处理读取命令</span>
        <span class="hljs-keyword">if</span> (bwr.read_size &gt; <span class="hljs-number">0</span>) {
            binder_thread_read(proc, thread,
                              bwr.read_buffer, bwr.read_size);
        }

        copy_to_user((<span class="hljs-type">void</span> __user *)arg, &amp;bwr, <span class="hljs-keyword">sizeof</span>(bwr));
        <span class="hljs-keyword">break</span>;
    }
    <span class="hljs-comment">// ... 其他命令</span>
    }
}
</code></pre>
<p><strong>BC_TRANSACTION的处理</strong>:</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// 简化版流程</span>
<span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">binder_thread_write</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> binder_proc *proc,
                               <span class="hljs-keyword">struct</span> binder_thread *thread,
                               <span class="hljs-type">void</span> __user *buffer, <span class="hljs-type">int</span> size)</span> {
    <span class="hljs-keyword">while</span> (ptr &lt; end) {
        <span class="hljs-type">uint32_t</span> cmd = *(<span class="hljs-type">uint32_t</span> *)ptr;

        <span class="hljs-keyword">switch</span> (cmd) {
        <span class="hljs-keyword">case</span> BC_TRANSACTION: {
            <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">binder_transaction_data</span> <span class="hljs-title">tr</span>;</span>
            copy_from_user(&amp;tr, ptr, <span class="hljs-keyword">sizeof</span>(tr));

            <span class="hljs-comment">// 1. 查找目标Binder对象</span>
            <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">binder_node</span> *<span class="hljs-title">target_node</span> =</span>
                binder_get_node_from_ref(proc, tr.target.handle);

            <span class="hljs-comment">// 2. 分配binder_transaction结构</span>
            <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">binder_transaction</span> *<span class="hljs-title">t</span> =</span> kzalloc(<span class="hljs-keyword">sizeof</span>(*t));

            <span class="hljs-comment">// 3. 分配数据缓冲区(在目标进程的映射区)</span>
            <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">binder_buffer</span> *<span class="hljs-title">buffer</span> =</span>
                binder_alloc_buf(target_node-&gt;proc, tr.data_size);

            <span class="hljs-comment">// 4. 拷贝数据(唯一的一次拷贝)</span>
            copy_from_user(buffer-&gt;data, tr.data.ptr.buffer, tr.data_size);

            <span class="hljs-comment">// 5. 处理flat_binder_object(嵌套的Binder对象)</span>
            binder_translate_binder(buffer, &amp;tr);

            <span class="hljs-comment">// 6. 将transaction加入目标进程的todo队列</span>
            list_add_tail(&amp;t-&gt;work.entry, &amp;target_node-&gt;proc-&gt;todo);

            <span class="hljs-comment">// 7. 唤醒目标进程</span>
            wake_up_interruptible(&amp;target_node-&gt;proc-&gt;wait);

            <span class="hljs-comment">// 8. 返回BR_TRANSACTION_COMPLETE</span>
            put_user(BR_TRANSACTION_COMPLETE, (<span class="hljs-type">uint32_t</span> __user *)buffer);

            <span class="hljs-keyword">break</span>;
        }
        <span class="hljs-comment">// ... 其他命令</span>
        }
    }
}
</code></pre>
<p><strong>关键步骤</strong>:</p>
<ol>
<li><strong>查找目标</strong>:根据handle查找目标binder_node</li>
<li><strong>分配缓冲区</strong>:在<strong>目标进程</strong>的mmap区域分配buffer</li>
<li><strong>拷贝数据</strong>:从Client用户空间拷贝到目标进程的内核映射区(唯一的拷贝)</li>
<li><strong>转换Binder对象</strong>:如果数据中包含Binder对象,需要转换handle/pointer</li>
<li><strong>加入队列</strong>:将事务加入目标进程的待处理队列</li>
<li><strong>唤醒线程</strong>:如果目标进程有线程在等待,唤醒它</li>
</ol>
<h3 data-id="heading-22">接收调用(Server侧)</h3>
<p>Server端线程通常阻塞在<code>IPCThreadState::joinThreadPool()</code>:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// IPCThreadState.cpp</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">IPCThreadState::joinThreadPool</span><span class="hljs-params">(<span class="hljs-type">bool</span> isMain)</span> </span>{
    <span class="hljs-comment">// 注册线程</span>
    mOut.<span class="hljs-built_in">writeInt32</span>(isMain ? BC_ENTER_LOOPER : BC_REGISTER_LOOPER);

    <span class="hljs-keyword">do</span> {
        <span class="hljs-comment">// 清空输出缓冲区</span>
        mOut.<span class="hljs-built_in">clear</span>();

        <span class="hljs-comment">// 等待命令(阻塞在ioctl)</span>
        result = <span class="hljs-built_in">talkWithDriver</span>();

        <span class="hljs-comment">// 处理返回的命令</span>
        result = <span class="hljs-built_in">executeCommand</span>(cmd);

    } <span class="hljs-keyword">while</span> (result != -ECONNREFUSED &amp;&amp; result != -EBADF);
}
</code></pre>
<p>当驱动有事务时,返回<code>BR_TRANSACTION</code>:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// IPCThreadState.cpp</span>
<span class="hljs-function"><span class="hljs-type">status_t</span> <span class="hljs-title">IPCThreadState::executeCommand</span><span class="hljs-params">(<span class="hljs-type">int32_t</span> cmd)</span> </span>{
    <span class="hljs-keyword">switch</span> (cmd) {
    <span class="hljs-keyword">case</span> BR_TRANSACTION: {
        binder_transaction_data tr;
        mIn.<span class="hljs-built_in">read</span>(&amp;tr, <span class="hljs-built_in">sizeof</span>(tr));

        <span class="hljs-comment">// 构造Parcel(指向mmap的数据区,无需拷贝)</span>
        Parcel buffer;
        buffer.<span class="hljs-built_in">ipcSetDataReference</span>(
            <span class="hljs-built_in">reinterpret_cast</span>&lt;<span class="hljs-type">const</span> <span class="hljs-type">uint8_t</span>*&gt;(tr.data.ptr.buffer),
            tr.data_size,
            <span class="hljs-built_in">reinterpret_cast</span>&lt;<span class="hljs-type">const</span> <span class="hljs-type">size_t</span>*&gt;(tr.data.ptr.offsets),
            tr.offsets_size / <span class="hljs-built_in">sizeof</span>(<span class="hljs-type">size_t</span>));

        <span class="hljs-comment">// 调用BBinder的transact方法</span>
        BBinder* obj = (BBinder*)tr.cookie;
        error = obj-&gt;<span class="hljs-built_in">transact</span>(tr.code, buffer, &amp;reply, tr.flags);

        <span class="hljs-comment">// 如果不是单向调用,发送BC_REPLY</span>
        <span class="hljs-keyword">if</span> ((tr.flags &amp; TF_ONE_WAY) == <span class="hljs-number">0</span>) {
            <span class="hljs-built_in">sendReply</span>(reply, <span class="hljs-number">0</span>);
        }
        <span class="hljs-keyword">break</span>;
    }
    <span class="hljs-comment">// ... 其他命令</span>
    }
}
</code></pre>
<p><strong>数据访问</strong>:注意<code>buffer.ipcSetDataReference</code>直接引用了mmap区域的数据,Server可以零拷贝地访问参数。</p>
<h2 data-id="heading-23">Android 15的Binder新特性</h2>
<p>Android 15对Binder进行了多项优化和增强:</p>
<h3 data-id="heading-24">1. 冻结通知机制</h3>
<p>新增了进程冻结的通知机制,支持应用感知自己被冻结/解冻:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// binder_module.h (Android 15新增)</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BC_REQUEST_FREEZE_NOTIFICATION   <span class="hljs-comment">// 请求冻结通知</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BC_CLEAR_FREEZE_NOTIFICATION     <span class="hljs-comment">// 清除冻结通知</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BR_FROZEN_BINDER                 <span class="hljs-comment">// Binder被冻结</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> BR_CLEAR_FREEZE_NOTIFICATION_DONE <span class="hljs-comment">// 清除通知完成</span></span>
</code></pre>
<p><strong>使用场景</strong>:当系统冻结后台应用时,可以通过Binder通知应用做清理工作。</p>
<h3 data-id="heading-25">2. 单向调用垃圾检测</h3>
<p>新增<code>BR_ONEWAY_SPAM_SUSPECT</code>命令,检测滥用单向调用的行为:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">case</span> BR_ONEWAY_SPAM_SUSPECT:
    <span class="hljs-comment">// 警告:检测到可疑的单向调用垃圾请求</span>
    <span class="hljs-comment">// 可能是恶意应用在DOS攻击</span>
</code></pre>
<p><strong>防护</strong>:防止恶意应用通过大量单向Binder调用耗尽系统资源。</p>
<h3 data-id="heading-26">3. 稳定AIDL支持</h3>
<p>Android 15进一步强化了Stable AIDL,确保跨版本的ABI兼容性。</p>
<h3 data-id="heading-27">4. 性能优化</h3>
<ul>
<li>优化了binder_buffer的分配算法,减少碎片</li>
<li>改进了binder_thread的唤醒机制,降低延迟</li>
</ul>
<h2 data-id="heading-28">常见问题</h2>
<h3 data-id="heading-29">Q1: Binder一次拷贝是如何实现的?</h3>
<p><strong>A</strong>: 关键是mmap内存映射。Server进程将内核缓冲区映射到自己的用户空间,当Client发送数据时,驱动将数据从Client用户空间拷贝到内核缓冲区(一次拷贝),由于内核缓冲区已映射到Server用户空间,Server可以直接访问,无需第二次拷贝。</p>
<h3 data-id="heading-30">Q2: Binder为什么比Socket快?</h3>
<p><strong>A</strong>: 主要原因:</p>
<ol>
<li><strong>拷贝次数</strong>:Binder一次拷贝 vs Socket两次拷贝</li>
<li><strong>协议开销</strong>:Binder是轻量级协议 vs Socket需要TCP/IP协议栈</li>
<li><strong>上下文切换</strong>:Binder直接在内核完成路由 vs Socket需要网络层处理</li>
</ol>
<h3 data-id="heading-31">Q3: Binder的安全性体现在哪里?</h3>
<p><strong>A</strong>:</p>
<ol>
<li><strong>身份验证</strong>:<code>sender_pid</code>和<code>sender_euid</code>由驱动填充,应用无法伪造</li>
<li><strong>权限检查</strong>:驱动层可以结合SELinux进行细粒度权限控制</li>
<li><strong>对象隔离</strong>:每个进程只能访问自己的binder_ref,无法直接访问其他进程的对象</li>
</ol>
<h3 data-id="heading-32">Q4: Binder传输大数据(如图片)有限制吗?</h3>
<p><strong>A</strong>: 有限制。默认mmap大小是<code>(1MB - 8KB)</code>,单次传输不能超过此大小。传输大数据的正确方式:</p>
<ul>
<li>使用<code>ashmem</code>(匿名共享内存)传递文件描述符</li>
<li>使用<code>文件描述符</code>传递,对方通过fd读取数据</li>
</ul>
<h3 data-id="heading-33">Q5: 为什么Binder线程池默认是15个?</h3>
<p><strong>A</strong>: 这是经验值,平衡了并发能力和资源消耗:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">define</span> DEFAULT_MAX_BINDER_THREADS 15</span>
</code></pre>
<p>过多线程会消耗内存和调度开销,15个线程对大多数服务足够。可以通过<code>ProcessState::setThreadPoolMaxThreadCount()</code>调整。</p>
<h2 data-id="heading-34">实战:追踪Binder调用</h2>
<p>让我们通过实际命令追踪一次Binder调用:</p>
<h3 data-id="heading-35">1. 查看Binder状态</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 查看系统中所有Binder节点</span>
<span class="hljs-built_in">cat</span> /sys/kernel/debug/binder/state

<span class="hljs-comment"># 查看某个进程的Binder状态</span>
<span class="hljs-built_in">cat</span> /sys/kernel/debug/binder/proc/&lt;pid&gt;

<span class="hljs-comment"># 查看Binder事务记录</span>
<span class="hljs-built_in">cat</span> /sys/kernel/debug/binder/transaction_log
</code></pre>
<h3 data-id="heading-36">2. 使用Systrace追踪</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 抓取Binder trace</span>
systrace.py -t 10 binder gfx view wm am -o trace.html

<span class="hljs-comment"># 在Chrome中打开trace.html,搜索"binder transaction"</span>
</code></pre>
<h3 data-id="heading-37">3. 通过logcat查看Binder日志</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 开启Binder日志(需要工程版ROM)</span>
adb shell setprop log.tag.BpBinder VERBOSE
adb shell setprop log.tag.BBinder VERBOSE

<span class="hljs-comment"># 查看日志</span>
adb logcat | grep -i binder
</code></pre>
<h2 data-id="heading-38">总结</h2>
<p>Binder作为Android的核心IPC机制,其设计充满智慧:</p>
<p><strong>设计亮点</strong>:</p>
<ul>
<li>✅ <strong>一次拷贝</strong>:通过mmap内存映射实现,性能优于传统IPC</li>
<li>✅ <strong>面向对象</strong>:天然支持对象引用、接口调用、生命周期管理</li>
<li>✅ <strong>强安全性</strong>:驱动级身份验证,无法伪造UID/PID</li>
<li>✅ <strong>稳定可靠</strong>:死亡通知、引用计数,服务异常能及时感知</li>
</ul>
<p><strong>核心机制</strong>:</p>
<ul>
<li><strong>mmap映射</strong>:建立用户空间到内核空间的共享内存,实现零拷贝访问</li>
<li><strong>BC/BR协议</strong>:基于命令的轻量级协议,减少通信开销</li>
<li><strong>驱动管理</strong>:在内核层统一管理所有IPC,提供安全保障</li>
</ul>
<p><strong>学习路径</strong>:</p>
<ol>
<li>理解Binder的整体架构和设计理念</li>
<li>掌握核心数据结构和工作流程</li>
<li>阅读ProcessState、IPCThreadState的源码实现</li>
<li>学习AIDL和ServiceManager(下一篇)</li>
<li>实践:编写自己的Binder服务</li>
</ol>
<h3 data-id="heading-39">参考源码</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcs.android.com%2Fandroid%2Fplatform%2Fsuperproject%2F%2B%2Fandroid-15.0.0_r1%3Aframeworks%2Fnative%2Flibs%2Fbinder%2F" target="_blank" title="https://cs.android.com/android/platform/superproject/+/android-15.0.0_r1:frameworks/native/libs/binder/" ref="nofollow noopener noreferrer">Android Framework源码 - Binder</a></li>
</ul>
<h3 data-id="heading-40">系列文章</h3>
<ul>
<li><a href="https://juejin.cn/post/7600863478929915923" target="_blank" title="https://juejin.cn/post/7600863478929915923">上一篇：Android 15网络子系统深度解析（二）：NetworkPolicy流量控制、VPN框架与网络优化全解析</a></li>
</ul>
<hr/>
<p><em>欢迎来我中的<a href="https://link.juejin.cn?target=https%3A%2F%2Fhome.wonlab.top" target="_blank" title="https://home.wonlab.top" ref="nofollow noopener noreferrer">个人主页</a>找到更多有用的知识和有趣的产品</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[跨平台框架怎么选：16 个框架全景对比（2026 版）]]></title>    <link>https://juejin.cn/post/7602133286643220530</link>    <guid>https://juejin.cn/post/7602133286643220530</guid>    <pubDate>2026-02-02T12:29:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602133286643220530" data-draft-id="7602133286643204146" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="跨平台框架怎么选：16 个框架全景对比（2026 版）"/> <meta itemprop="keywords" content="前端框架,架构,UI Kit"/> <meta itemprop="datePublished" content="2026-02-02T12:29:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="jump_jump"/> <meta itemprop="url" content="https://juejin.cn/user/4230576474692765"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            跨平台框架怎么选：16 个框架全景对比（2026 版）
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4230576474692765/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    jump_jump
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T12:29:18.000Z" title="Mon Feb 02 2026 12:29:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读33分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>跨平台不是"能不能跑"，而是"用哪条技术路线换哪种确定性"。</p>
</blockquote>
<p><strong>选错框架的代价</strong>：某团队用 Electron 做笔记应用，上线后用户反馈"启动 5 秒，内存 500MB"。重构用了 3 个月。如果一开始选 Tauri 或 Wails，这个坑完全可以避免。</p>
<p><strong>本文目标</strong>：帮你在动手前想清楚。</p>
<p><strong>覆盖范围</strong>：16 个框架，4 大技术路线</p>
<ul>
<li><strong>主流稳定</strong>：Flutter、React Native、Electron、Qt（生产环境）</li>
<li><strong>新兴可靠</strong>：Wails（Go）、Dioxus（Rust）、Tauri（已值得试水）</li>
<li><strong>垂直场景</strong>：Slint（嵌入式）、Uno（C# WASM）、NativeScript（Vue/Angular）</li>
<li><strong>探索阶段</strong>：Lynx、Valdi、Electrobun、GPUI</li>
</ul>
<p><strong>阅读建议</strong>：</p>
<ul>
<li>想快速决策？→ 直接看"快速决策表"</li>
<li>想深度了解？→ 按章节完整阅读</li>
<li>想对比细节？→ 查看"指标矩阵"</li>
</ul>
<hr/>
<h2 data-id="heading-0">第一章：先搞懂底层逻辑</h2>
<p>在看具体框架前，你需要理解一个核心问题：<strong>UI 是怎么画到屏幕上的？</strong></p>
<p>不同的"画法"决定了框架的基因，也决定了它擅长什么、不擅长什么。</p>
<h3 data-id="heading-1">1.1 四种技术路线</h3>
<h4 data-id="heading-2">路线一：自绘渲染（Self-rendering）</h4>
<p><strong>原理</strong>：框架自己实现一套渲染引擎，拿到系统给的"画布"（Canvas/Surface），一笔一画把 UI 画出来。</p>
<p><strong>类比</strong>：你买了一块空白画布，用自己的颜料和画笔画画。画出来的风格完全由你决定，跟画布是什么牌子的没关系。</p>
<p><strong>代表框架</strong>：Flutter、Lynx、Qt Quick、GPUI、Dioxus、Slint</p>
<p><strong>优势</strong>：</p>
<ul>
<li>跨端一致性极强——因为渲染逻辑是自己写的，不依赖系统控件</li>
<li>动效表现好——可以做到 60fps 甚至 120fps 的流畅动画</li>
<li>可控性高——想改渲染管线？自己动手就行</li>
</ul>
<p><strong>劣势</strong>：</p>
<ul>
<li>包体更大——要打包渲染引擎</li>
<li>与系统"格格不入"——比如 iOS 的橡皮筋效果、Android 的 Material You 动态取色，需要额外适配</li>
<li>无障碍支持需要额外工作</li>
</ul>
<pre><code class="hljs language-scss" lang="scss">┌─────────────────────────────────────┐
│           你的应用代码               │
├─────────────────────────────────────┤
│         框架的渲染引擎               │  ← 这一层是框架自己实现的
├─────────────────────────────────────┤
│    系统图形 API (Metal/Vulkan/GL)   │
├─────────────────────────────────────┤
│              GPU                     │
└─────────────────────────────────────┘
</code></pre>
<h4 data-id="heading-3">路线二：原生控件映射（Native Bridging）</h4>
<p><strong>原理</strong>：框架把你写的代码"翻译"成原生控件调用。你写 <code>&lt;Button&gt;</code>，框架帮你调用 iOS 的 <code>UIButton</code> 或 Android 的 <code>MaterialButton</code>。</p>
<p><strong>类比</strong>：你是导演，给演员（原生控件）下指令。演员按照各自平台的"表演风格"来演，iOS 演员演得像 iOS，Android 演员演得像 Android。</p>
<p><strong>代表框架</strong>：React Native、.NET MAUI、Uno Platform、NativeScript、Valdi</p>
<p><strong>优势</strong>：</p>
<ul>
<li>原生体验——因为用的就是原生控件</li>
<li>系统功能集成方便——推送、权限、传感器等直接调用</li>
<li>无障碍支持天然继承</li>
</ul>
<p><strong>劣势</strong>：</p>
<ul>
<li>跨端一致性差——同一份代码在不同平台上长得不一样</li>
<li>有"桥接"成本——JS 和原生通信需要序列化/反序列化</li>
<li>复杂动效难做——要协调多个原生控件</li>
</ul>
<pre><code class="hljs language-scss" lang="scss">┌─────────────────────────────────────┐
│           你的应用代码               │
├─────────────────────────────────────┤
│       框架的桥接层 (Bridge)          │  ← 翻译 + 通信
├─────────────────────────────────────┤
│   原生控件 (UIKit / Android Views)  │
├─────────────────────────────────────┤
│              系统                    │
└─────────────────────────────────────┘
</code></pre>
<h4 data-id="heading-4">路线三：WebView/Chromium 方案</h4>
<p><strong>原理</strong>：用 Web 技术栈（HTML/CSS/JS）写 UI，通过 WebView 或内嵌 Chromium 来渲染。</p>
<p><strong>类比</strong>：在应用里开了一个"浏览器窗口"，你的 UI 实际上是一个网页。</p>
<p><strong>代表框架</strong>：Electron、Tauri、Wails、Electrobun</p>
<p><strong>优势</strong>：</p>
<ul>
<li>前端团队无缝上手——就是写网页</li>
<li>生态巨大——npm 上百万个包随便用</li>
<li>开发效率高——热更新、DevTools 一应俱全</li>
</ul>
<p><strong>劣势</strong>：</p>
<ul>
<li>资源占用——Chromium 本身就吃内存</li>
<li>启动慢——要初始化整个浏览器引擎</li>
<li>"不够原生"——滚动、右键菜单等细节需要额外打磨</li>
</ul>
<pre><code class="hljs language-scss" lang="scss">┌─────────────────────────────────────┐
│      你的 Web 应用 (HTML/CSS/JS)    │
├─────────────────────────────────────┤
│   WebView / Chromium / 系统浏览器    │
├────────────────┬────────────────────┤
│  后端进程      │   系统 API 调用    │
│  (Node/Rust)   │                    │
└────────────────┴────────────────────┘
</code></pre>
<p><strong>Electron vs Tauri vs Electrobun 核心对比</strong>：</p>









































<table><thead><tr><th>维度</th><th>Electron</th><th>Tauri</th><th>Electrobun</th></tr></thead><tbody><tr><td>渲染引擎</td><td>内嵌 Chromium</td><td>系统 WebView</td><td>系统 WebView/CEF</td></tr><tr><td>后端语言</td><td>Node.js</td><td>Rust</td><td>Bun (TypeScript)</td></tr><tr><td>包体大小</td><td>150MB+</td><td>3-10MB</td><td>10-30MB</td></tr><tr><td>启动速度</td><td>慢（初始化大）</td><td>快</td><td>中等</td></tr><tr><td>适合团队</td><td>前端团队</td><td>愿意学 Rust</td><td>前端团队</td></tr></tbody></table>
<h4 data-id="heading-5">路线四：逻辑共享优先（Shared Logic First）</h4>
<p><strong>原理</strong>：只共享业务逻辑和数据层，UI 各平台自己写（或用 Compose Multiplatform 部分共享）。</p>
<p><strong>类比</strong>：后厨（业务逻辑）是统一的，但前台装修（UI）各店不同。</p>
<p><strong>代表框架</strong>：Kotlin Multiplatform (KMP)</p>
<p><strong>优势</strong>：</p>
<ul>
<li>原生体验最佳——UI 就是原生写的</li>
<li>渐进式迁移——可以一点点把逻辑抽到共享层</li>
<li>风险可控——UI 出问题不影响共享逻辑</li>
</ul>
<p><strong>劣势</strong>：</p>
<ul>
<li>UI 要写多份（除非用 Compose Multiplatform）</li>
<li>团队需要掌握多平台 UI 开发</li>
<li>共享层的边界需要仔细设计</li>
</ul>
<pre><code class="hljs language-scss" lang="scss">┌──────────────────────────────────────────────────┐
│                  共享层 (Kotlin)                  │
│         网络、数据库、业务逻辑、状态管理           │
├─────────────────┬────────────────┬───────────────┤
│   Android UI    │    iOS UI      │   Desktop UI  │
│   (Compose)     │   (SwiftUI)    │  (Compose)    │
└─────────────────┴────────────────┴───────────────┘
</code></pre>
<h3 data-id="heading-6">1.2 一张图看懂路线选择</h3>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-code">                        你的核心诉求是什么？
                              │
            ┌─────────────────┼─────────────────┐
            ▼                 ▼                 ▼
       跨端一致性          原生体验           开发效率
       视觉完全统一        系统深度集成        快速上线
            │                 │                 │
            ▼                 ▼                 ▼
       自绘渲染           原生映射          WebView 方案
    Flutter/Lynx/      RN/MAUI/Uno/      Electron/Tauri/
    Dioxus/Slint/Qt    NativeScript/KMP  Wails/Electrobun
</span></code></pre>
<p><strong>技术栈快速匹配</strong>：</p>
<pre><code class="hljs language-bash" lang="bash">你的团队主要用什么语言？
│
├─ JavaScript/TypeScript
│  ├─ React → React Native / Lynx
│  ├─ Vue/Angular → NativeScript
│  └─ 任意框架 → Electron / Tauri / Wails / Electrobun
│
├─ Dart → Flutter
│
├─ C<span class="hljs-comment"># → .NET MAUI / Uno Platform（需要 WASM）</span>
│
├─ C++ → Qt / Slint（嵌入式）
│
├─ Go → Wails（桌面）
│
├─ Kotlin → KMP
│
└─ Rust
   ├─ Web 前端 → Tauri
   ├─ 全栈（含 UI）→ Dioxus
   ├─ 嵌入式 → Slint
   └─ 极致性能 → GPUI
</code></pre>
<hr/>
<h2 data-id="heading-7">第二章：16 个框架逐一拆解</h2>
<p>下面我们按"成熟度从高到低"的顺序介绍每个框架。为了便于理解，我们将框架按技术路线分组呈现。</p>
<h3 data-id="heading-8">2.1 Flutter（Google，2018 稳定版）</h3>
<p><strong>一句话定位</strong>：自绘渲染的"全能选手"，跨端一致性最强的主流方案。</p>
<p><strong>技术栈</strong>：</p>
<ul>
<li>语言：Dart（Google 自研，语法类似 Java/JS 混合体）</li>
<li>渲染：Skia 引擎 → 正在迁移到 Impeller（iOS 已默认启用）</li>
<li>架构：Widget 树 + 声明式 UI</li>
</ul>
<p><strong>适合场景</strong>：</p>
<ul>
<li>品牌型应用，强调视觉一致性（如 Google Pay、阿里闲鱼）</li>
<li>重动效、重交互的应用（如游戏化电商、社交）</li>
<li>需要同时覆盖移动 + Web + 桌面</li>
</ul>
<p><strong>不太适合</strong>：</p>
<ul>
<li>需要深度系统集成的工具类应用（如文件管理器）</li>
<li>团队对 Dart 抵触强烈</li>
<li>包体大小极度敏感（Flutter 最小包体约 4-5MB）</li>
</ul>
<p><strong>真实案例</strong>：</p>
<ul>
<li>Google Pay：全球支付应用，Flutter 重写后开发效率提升 70%</li>
<li>闲鱼：阿里的二手交易平台，首页用 Flutter 实现</li>
<li>BMW：车载信息娱乐系统</li>
</ul>
<p><strong>代码示例</strong>（感受一下 Dart 风格）：</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// 一个简单的计数器页面</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CounterPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-meta">@override</span>
  _CounterPageState createState() =&gt; _CounterPageState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_CounterPageState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">CounterPage</span>&gt; </span>{
  <span class="hljs-built_in">int</span> _count = <span class="hljs-number">0</span>;

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> Scaffold(
      appBar: AppBar(title: Text(<span class="hljs-string">'计数器'</span>)),
      body: Center(
        child: Text(<span class="hljs-string">'点击了 <span class="hljs-subst">$_count</span> 次'</span>, style: TextStyle(fontSize: <span class="hljs-number">24</span>)),
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: () =&gt; setState(() =&gt; _count++),
        child: Icon(Icons.add),
      ),
    );
  }
}
</code></pre>
<p><strong>入门步骤</strong>：</p>
<ol>
<li>安装 Flutter SDK：<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.flutter.dev%2Fget-started%2Finstall" target="_blank" title="https://docs.flutter.dev/get-started/install" ref="nofollow noopener noreferrer">docs.flutter.dev/get-started…</a></li>
<li>配置平台工具链（Android Studio + SDK；macOS 需 Xcode）</li>
<li>运行环境检查：<code>flutter doctor</code></li>
<li>创建项目：<code>flutter create my_app</code></li>
<li>运行：<code>cd my_app &amp;&amp; flutter run</code></li>
</ol>
<p><strong>常见坑</strong>：</p>
<ul>
<li><strong>热重载失效</strong>：有时需要热重启（Shift+R）或完全重启</li>
<li><strong>包体优化</strong>：使用 <code>--split-debug-info</code> 和 <code>--obfuscate</code> 可减小约 30%</li>
<li><strong>iOS 审核</strong>：确保 <code>Info.plist</code> 里的权限说明清晰</li>
</ul>
<hr/>
<h3 data-id="heading-9">2.2 React Native（Meta，2015）</h3>
<p><strong>一句话定位</strong>：用 React 写原生应用，前端团队的"舒适区扩展"。</p>
<p><strong>技术栈</strong>：</p>
<ul>
<li>语言：JavaScript/TypeScript + React</li>
<li>渲染：映射到原生控件</li>
<li>架构：新架构（Fabric + TurboModules）正在推进</li>
</ul>
<p><strong>适合场景</strong>：</p>
<ul>
<li>团队是 React 技术栈，想复用前端能力</li>
<li>需要原生体验，但开发效率也很重要</li>
<li>应用以内容展示为主（如新闻、电商列表页）</li>
</ul>
<p><strong>不太适合</strong>：</p>
<ul>
<li>复杂动效（如游戏、3D 展示）</li>
<li>需要跨端 UI 完全一致</li>
<li>对启动速度要求极高（RN 的 JS 引擎初始化需要时间）</li>
</ul>
<p><strong>真实案例</strong>：</p>
<ul>
<li>Facebook/Instagram：部分页面使用 RN</li>
<li>Shopify：商家管理应用</li>
<li>Discord：移动端部分功能</li>
</ul>
<p><strong>代码示例</strong>：</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// React Native 的代码对 React 开发者很熟悉</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">View</span>, <span class="hljs-title class_">Text</span>, <span class="hljs-title class_">TouchableOpacity</span>, <span class="hljs-title class_">StyleSheet</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-native'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Counter</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.container}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.text}</span>&gt;</span>点击了 {count} 次<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">TouchableOpacity</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.button}</span> <span class="hljs-attr">onPress</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(c =&gt; c + 1)}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.buttonText}</span>&gt;</span>+1<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">TouchableOpacity</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">const</span> styles = <span class="hljs-title class_">StyleSheet</span>.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">container</span>: { <span class="hljs-attr">flex</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">justifyContent</span>: <span class="hljs-string">'center'</span>, <span class="hljs-attr">alignItems</span>: <span class="hljs-string">'center'</span> },
  <span class="hljs-attr">text</span>: { <span class="hljs-attr">fontSize</span>: <span class="hljs-number">24</span>, <span class="hljs-attr">marginBottom</span>: <span class="hljs-number">20</span> },
  <span class="hljs-attr">button</span>: { <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">'#007AFF'</span>, <span class="hljs-attr">padding</span>: <span class="hljs-number">15</span>, <span class="hljs-attr">borderRadius</span>: <span class="hljs-number">8</span> },
  <span class="hljs-attr">buttonText</span>: { <span class="hljs-attr">color</span>: <span class="hljs-string">'white'</span>, <span class="hljs-attr">fontSize</span>: <span class="hljs-number">18</span> },
});
</code></pre>
<p><strong>入门步骤</strong>：</p>
<ol>
<li>安装 Node.js（推荐 18+）</li>
<li>选择初始化方式：
<ul>
<li>快速上手：<code>npx create-expo-app my-app</code>（Expo 托管方案）</li>
<li>完全控制：<code>npx react-native init MyApp</code>（裸 RN）</li>
</ul>
</li>
<li>配置原生工具链（Android Studio + Xcode）</li>
<li>运行：<code>npx expo start</code> 或 <code>npx react-native run-ios</code></li>
</ol>
<p><strong>常见坑</strong>：</p>
<ul>
<li><strong>桥接性能</strong>：大量数据传递时考虑用新架构的 JSI</li>
<li><strong>第三方库兼容性</strong>：检查是否支持新架构</li>
<li><strong>启动时间</strong>：用 Hermes 引擎替代 JSC 可提升 30-50%</li>
</ul>
<hr/>
<h3 data-id="heading-10">2.3 NativeScript（Progress Software，2014）</h3>
<p><strong>一句话定位</strong>：用 Vue/Angular/Vanilla JS 写原生应用，填补非 React 前端技术栈的空白。</p>
<p><strong>技术栈</strong>：</p>
<ul>
<li>语言：JavaScript/TypeScript + Vue/Angular/Vanilla JS</li>
<li>渲染：映射到原生控件（与 RN 类似）</li>
<li>架构：直接访问原生 API（无桥接层）</li>
</ul>
<p><strong>适合场景</strong>：</p>
<ul>
<li>Vue 或 Angular 技术栈的团队</li>
<li>需要直接访问原生 API</li>
<li>想要原生体验的移动应用</li>
</ul>
<p><strong>不太适合</strong>：</p>
<ul>
<li>React 技术栈（直接用 React Native）</li>
<li>需要复杂动效</li>
<li>桌面端需求（主要支持移动端）</li>
</ul>
<p><strong>真实案例</strong>：</p>
<ul>
<li>SAP：企业应用</li>
<li>Strudel：音乐流媒体应用</li>
</ul>
<p><strong>代码示例</strong>（Vue 风格）：</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;Page&gt;
    &lt;ActionBar title="计数器"/&gt;
    &lt;StackLayout class="p-20"&gt;
      &lt;Label :text="`点击了 ${count} 次`" class="text-center text-2xl mb-4"/&gt;
      &lt;Button text="+1" @tap="count++" class="btn btn-primary"/&gt;
    &lt;/StackLayout&gt;
  &lt;/Page&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
  data() {
    return {
      count: 0
    }
  }
}
&lt;/script&gt;
</code></pre>
<p><strong>入门步骤</strong>：</p>
<ol>
<li>安装 Node.js 和 NativeScript CLI：<code>npm install -g @nativescript/cli</code></li>
<li>创建项目：<code>ns create my-app --vue</code> 或 <code>--angular</code></li>
<li>配置原生工具链（Android Studio + Xcode）</li>
<li>运行：<code>ns run ios</code> 或 <code>ns run android</code></li>
</ol>
<p><strong>与 React Native 的对比</strong>：</p>






























<table><thead><tr><th>维度</th><th>React Native</th><th>NativeScript</th></tr></thead><tbody><tr><td>框架支持</td><td>React</td><td>Vue/Angular/Vanilla</td></tr><tr><td>原生访问</td><td>通过桥接</td><td>直接访问</td></tr><tr><td>性能</td><td>有桥接开销</td><td>理论上更快</td></tr><tr><td>生态</td><td>更大</td><td>较小</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-11">2.4 Electron（GitHub/OpenJS Foundation，2013）</h3>
<p><strong>一句话定位</strong>：Web 技术栈做桌面应用的"事实标准"，简单粗暴但有效。</p>
<p><strong>技术栈</strong>：</p>
<ul>
<li>前端：HTML/CSS/JS（任意前端框架）</li>
<li>后端：Node.js（完整的 Node API）</li>
<li>渲染：Chromium</li>
</ul>
<p><strong>适合场景</strong>：</p>
<ul>
<li>快速把 Web 应用搬到桌面</li>
<li>团队只有前端能力</li>
<li>对包体大小和内存占用不敏感</li>
</ul>
<p><strong>不太适合</strong>：</p>
<ul>
<li>资源敏感型应用（如系统工具）</li>
<li>需要极致启动速度</li>
<li>用户设备配置较低</li>
</ul>
<p><strong>真实案例</strong>：</p>
<ul>
<li>VS Code：微软的代码编辑器（证明 Electron 可以做出高性能应用）</li>
<li>Slack：团队协作工具</li>
<li>Discord：桌面端</li>
<li>Figma：桌面端</li>
</ul>
<p><strong>资源占用参考</strong>：</p>
<ul>
<li>空项目包体：~150MB（压缩后）</li>
<li>空项目内存：~80-150MB</li>
<li>VS Code 内存：~300-800MB（取决于打开的文件和扩展）</li>
</ul>
<p><strong>入门步骤</strong>：</p>
<ol>
<li>初始化项目：<code>npm init -y</code></li>
<li>安装 Electron：<code>npm install -D electron</code></li>
<li>创建 <code>main.js</code>：</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { app, <span class="hljs-title class_">BrowserWindow</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'electron'</span>);

app.<span class="hljs-title function_">whenReady</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> win = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BrowserWindow</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">800</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">600</span> });
  win.<span class="hljs-title function_">loadFile</span>(<span class="hljs-string">'index.html'</span>);
});
</code></pre>
<ol start="4">
<li>添加启动脚本到 <code>package.json</code>：<code>"start": "electron ."</code></li>
<li>运行：<code>npm start</code></li>
</ol>
<p><strong>性能优化技巧</strong>：</p>
<ul>
<li>使用 <code>BrowserWindow</code> 的 <code>show: false</code> + <code>ready-to-show</code> 事件避免白屏</li>
<li>延迟加载非必要模块</li>
<li>考虑使用 <code>contextIsolation</code> 提升安全性</li>
</ul>
<hr/>
<h3 data-id="heading-12">2.5 Qt / Qt Quick（The Qt Company，1995/2010）</h3>
<p><strong>一句话定位</strong>：工业级跨平台方案，嵌入式和桌面的"老大哥"。</p>
<p><strong>技术栈</strong>：</p>
<ul>
<li>语言：C++（核心）+ QML（声明式 UI）</li>
<li>渲染：RHI（Rendering Hardware Interface），支持 Vulkan/Metal/D3D/OpenGL</li>
<li>架构：信号槽机制 + 属性绑定</li>
</ul>
<p><strong>适合场景</strong>：</p>
<ul>
<li>工业软件、医疗设备、汽车 HMI</li>
<li>嵌入式系统（Linux 嵌入式、MCU）</li>
<li>对性能和稳定性要求极高</li>
</ul>
<p><strong>不太适合</strong>：</p>
<ul>
<li>快速原型验证（学习曲线陡）</li>
<li>小团队短周期项目</li>
<li>纯移动端应用（移动端生态弱于 Flutter/RN）</li>
</ul>
<p><strong>真实案例</strong>：</p>
<ul>
<li>特斯拉 Model S/X：早期车载系统</li>
<li>达芬奇手术机器人：控制界面</li>
<li>Autodesk Maya：部分 UI</li>
<li>VirtualBox：虚拟机管理界面</li>
</ul>
<p><strong>代码示例</strong>（QML）：</p>
<pre><code class="hljs language-qml" lang="qml">// QML 声明式 UI，类似 JSON 但带逻辑
import QtQuick 2.15
import QtQuick.Controls 2.15

ApplicationWindow {
    width: 400
    height: 300
    visible: true
    title: "计数器"

    Column {
        anchors.centerIn: parent
        spacing: 20

        Text {
            text: "点击了 " + counter + " 次"
            font.pixelSize: 24
        }

        Button {
            text: "+1"
            onClicked: counter++
        }
    }

    property int counter: 0
}
</code></pre>
<p><strong>许可证说明</strong>：</p>
<ul>
<li><strong>开源版（LGPL/GPL）</strong>：可免费商用，但有一些限制（如动态链接、开源要求）</li>
<li><strong>商业版</strong>：按开发者人数收费，约 $300-500/月/人</li>
</ul>
<p><strong>入门步骤</strong>：</p>
<ol>
<li>下载 Qt Online Installer：<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.qt.io%2Fdownload" target="_blank" title="https://www.qt.io/download" ref="nofollow noopener noreferrer">www.qt.io/download</a></li>
<li>安装 Qt 6.x + Qt Creator</li>
<li>创建新项目 → Qt Quick Application</li>
<li>选择目标 Kit（Desktop/Android/iOS）</li>
<li>运行（Qt Creator 一键构建）</li>
</ol>
<hr/>
<h3 data-id="heading-13">2.6 .NET MAUI（Microsoft，2022）</h3>
<p><strong>一句话定位</strong>：C# 团队的跨平台方案，微软生态的"官方答案"。</p>
<p><strong>技术栈</strong>：</p>
<ul>
<li>语言：C#</li>
<li>UI：XAML 或 C# Markup</li>
<li>渲染：原生控件映射（类似 RN）</li>
</ul>
<p><strong>适合场景</strong>：</p>
<ul>
<li>企业内部应用（与 Azure、Office 365 集成好）</li>
<li>已有 C#/.NET 技术栈的团队</li>
<li>Windows 优先，兼顾其他平台</li>
</ul>
<p><strong>不太适合</strong>：</p>
<ul>
<li>需要极致跨端一致性</li>
<li>非 .NET 团队（学习成本高）</li>
<li>iOS/Android 优先的消费级应用</li>
</ul>
<p><strong>代码示例</strong>：</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// .NET MAUI 的 XAML + C# 模式</span>
<span class="hljs-comment">// MainPage.xaml</span>
&lt;ContentPage xmlns=<span class="hljs-string">"http://schemas.microsoft.com/dotnet/2021/maui"</span>&gt;
    &lt;VerticalStackLayout Spacing=<span class="hljs-string">"20"</span> VerticalOptions=<span class="hljs-string">"Center"</span>&gt;
        &lt;Label x:Name=<span class="hljs-string">"CounterLabel"</span> Text=<span class="hljs-string">"点击了 0 次"</span> FontSize=<span class="hljs-string">"24"</span> HorizontalOptions=<span class="hljs-string">"Center"</span>/&gt;
        &lt;Button Text=<span class="hljs-string">"+1"</span> Clicked=<span class="hljs-string">"OnCounterClicked"</span> HorizontalOptions=<span class="hljs-string">"Center"</span>/&gt;
    &lt;/VerticalStackLayout&gt;
&lt;/ContentPage&gt;

<span class="hljs-comment">// MainPage.xaml.cs</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MainPage</span> : <span class="hljs-title">ContentPage</span>
{
    <span class="hljs-built_in">int</span> count = <span class="hljs-number">0</span>;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MainPage</span>()</span> =&gt; InitializeComponent();

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">OnCounterClicked</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> sender, EventArgs e</span>)</span>
    {
        count++;
        CounterLabel.Text = <span class="hljs-string">$"点击了 <span class="hljs-subst">{count}</span> 次"</span>;
    }
}
</code></pre>
<p><strong>入门步骤</strong>：</p>
<ol>
<li>安装 .NET 8 SDK：<a href="https://link.juejin.cn?target=https%3A%2F%2Fdotnet.microsoft.com%2Fdownload" target="_blank" title="https://dotnet.microsoft.com/download" ref="nofollow noopener noreferrer">dotnet.microsoft.com/download</a></li>
<li>安装 MAUI 工作负载：<code>dotnet workload install maui</code></li>
<li>创建项目：<code>dotnet new maui -n MyApp</code></li>
<li>用 Visual Studio 或 VS Code 打开</li>
<li>选择目标平台运行</li>
</ol>
<hr/>
<h3 data-id="heading-14">2.7 Uno Platform（Uno Platform，2018）</h3>
<p><strong>一句话定位</strong>：C# 生态的"全平台方案"，比 .NET MAUI 更早、支持 WebAssembly。</p>
<p><strong>技术栈</strong>：</p>
<ul>
<li>语言：C#</li>
<li>UI：XAML（与 UWP/WinUI 兼容）</li>
<li>渲染：各平台原生控件 + WebAssembly 支持</li>
<li>架构：基于 WinUI API surface</li>
</ul>
<p><strong>与 .NET MAUI 的关键区别</strong>：</p>



































<table><thead><tr><th>维度</th><th>.NET MAUI</th><th>Uno Platform</th></tr></thead><tbody><tr><td>发布时间</td><td>2022</td><td>2018</td></tr><tr><td>WebAssembly</td><td>不支持</td><td><strong>支持（核心优势）</strong></td></tr><tr><td>API 来源</td><td>Xamarin.Forms 演进</td><td>WinUI/UWP</td></tr><tr><td>Windows 优先度</td><td>中等</td><td>高（WinUI 语法）</td></tr><tr><td>Linux 支持</td><td>有限</td><td>通过 Skia 支持</td></tr></tbody></table>
<p><strong>适合场景</strong>：</p>
<ul>
<li>需要 WebAssembly 支持（在浏览器中运行）</li>
<li>熟悉 WinUI/UWP 的团队</li>
<li>需要更广泛的平台支持（包括 Linux、Tizen）</li>
<li>Windows 应用需要迁移到其他平台</li>
</ul>
<p><strong>不太适合</strong>：</p>
<ul>
<li>新项目且对 WebAssembly 无需求（考虑 MAUI）</li>
<li>不熟悉 XAML 的团队</li>
<li>需要最轻量级的移动应用</li>
</ul>
<p><strong>真实案例</strong>：</p>
<ul>
<li>HSBC：银行应用的部分功能</li>
<li>Bluebeam：建筑协作软件</li>
</ul>
<p><strong>代码示例</strong>：</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- MainPage.xaml - 与 WinUI 语法兼容 --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">Page</span> <span class="hljs-attr">x:Class</span>=<span class="hljs-string">"MyApp.MainPage"</span>
      <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">StackPanel</span> <span class="hljs-attr">Spacing</span>=<span class="hljs-string">"20"</span> <span class="hljs-attr">HorizontalAlignment</span>=<span class="hljs-string">"Center"</span> <span class="hljs-attr">VerticalAlignment</span>=<span class="hljs-string">"Center"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">TextBlock</span> <span class="hljs-attr">x:Name</span>=<span class="hljs-string">"CounterText"</span> <span class="hljs-attr">Text</span>=<span class="hljs-string">"点击了 0 次"</span> <span class="hljs-attr">FontSize</span>=<span class="hljs-string">"24"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">Content</span>=<span class="hljs-string">"+1"</span> <span class="hljs-attr">Click</span>=<span class="hljs-string">"OnCounterClicked"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">StackPanel</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Page</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// MainPage.xaml.cs</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">sealed</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MainPage</span> : <span class="hljs-title">Page</span>
{
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> _count = <span class="hljs-number">0</span>;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MainPage</span>()</span>
    {
        <span class="hljs-keyword">this</span>.InitializeComponent();
    }

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnCounterClicked</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> sender, RoutedEventArgs e</span>)</span>
    {
        _count++;
        CounterText.Text = <span class="hljs-string">$"点击了 <span class="hljs-subst">{_count}</span> 次"</span>;
    }
}
</code></pre>
<p><strong>入门步骤</strong>：</p>
<ol>
<li>安装 .NET SDK 和 Uno Platform 模板：
<pre><code class="hljs language-bash" lang="bash">dotnet new install Uno.Templates
</code></pre>
</li>
<li>创建项目：
<pre><code class="hljs language-bash" lang="bash">dotnet new unoapp -o MyApp
</code></pre>
</li>
<li>选择目标平台（iOS/Android/WebAssembly/Windows/macOS/Linux）</li>
<li>运行：
<ul>
<li>WebAssembly: <code>dotnet run --project MyApp.Wasm</code></li>
<li>移动端：用 Visual Studio 或 Rider</li>
</ul>
</li>
</ol>
<p><strong>WebAssembly 优势示例</strong>：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 构建 WebAssembly 版本</span>
dotnet publish MyApp.Wasm -c Release

<span class="hljs-comment"># 直接部署到 Web 服务器，无需应用商店审核</span>
<span class="hljs-comment"># 用户通过浏览器访问即可使用</span>
</code></pre>
<hr/>
<h3 data-id="heading-15">2.8 Tauri（Tauri Programme，2022 v1.0）</h3>
<p><strong>一句话定位</strong>：Electron 的"轻量替代品"，用系统 WebView + Rust 后端。</p>
<p><strong>技术栈</strong>：</p>
<ul>
<li>前端：任意 Web 框架（React/Vue/Svelte/原生）</li>
<li>后端：Rust</li>
<li>渲染：系统 WebView（macOS: WKWebView, Windows: WebView2, Linux: WebKitGTK）</li>
</ul>
<p><strong>与 Electron 的关键区别</strong>：</p>



































<table><thead><tr><th>维度</th><th>Electron</th><th>Tauri</th></tr></thead><tbody><tr><td>包体（空项目）</td><td>~150MB</td><td>~3MB</td></tr><tr><td>内存（空项目）</td><td>~100MB</td><td>~30MB</td></tr><tr><td>后端语言</td><td>Node.js</td><td>Rust</td></tr><tr><td>WebView</td><td>内嵌 Chromium</td><td>系统自带</td></tr><tr><td>跨端一致性</td><td>高（同一个 Chromium）</td><td>中（系统 WebView 版本不同）</td></tr></tbody></table>
<p><strong>适合场景</strong>：</p>
<ul>
<li>在意包体大小和资源占用</li>
<li>团队愿意学 Rust（或只做简单后端逻辑）</li>
<li>不需要复杂的 Node.js 生态</li>
</ul>
<p><strong>不太适合</strong>：</p>
<ul>
<li>需要保证不同系统上渲染完全一致</li>
<li>后端逻辑复杂且团队不熟悉 Rust</li>
<li>需要使用大量 Node.js 包</li>
</ul>
<p><strong>入门步骤</strong>：</p>
<ol>
<li>安装 Rust：<a href="https://link.juejin.cn?target=https%3A%2F%2Frustup.rs%2F" target="_blank" title="https://rustup.rs/" ref="nofollow noopener noreferrer">rustup.rs/</a></li>
<li>安装系统依赖（Linux 需要 WebKitGTK）</li>
<li>创建项目：<code>npm create tauri-app@latest</code></li>
<li>选择前端模板（React/Vue/Svelte/Vanilla）</li>
<li>开发：<code>npm run tauri dev</code></li>
<li>构建：<code>npm run tauri build</code></li>
</ol>
<p><strong>Rust 后端示例</strong>：</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src-tauri/src/main.rs</span>
<span class="hljs-meta">#[tauri::command]</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">greet</span>(name: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">String</span> {
    <span class="hljs-built_in">format!</span>(<span class="hljs-string">"Hello, {}!"</span>, name)
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    tauri::Builder::<span class="hljs-title function_ invoke__">default</span>()
        .<span class="hljs-title function_ invoke__">invoke_handler</span>(tauri::generate_handler![greet])
        .<span class="hljs-title function_ invoke__">run</span>(tauri::generate_context!())
        .<span class="hljs-title function_ invoke__">expect</span>(<span class="hljs-string">"error while running tauri application"</span>);
}
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 前端调用</span>
<span class="hljs-keyword">import</span> { invoke } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tauri-apps/api/tauri'</span>;
<span class="hljs-keyword">const</span> greeting = <span class="hljs-keyword">await</span> <span class="hljs-title function_">invoke</span>(<span class="hljs-string">'greet'</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">'World'</span> });
</code></pre>
<hr/>
<h3 data-id="heading-16">2.9 Wails（Wails Project，2019 / v2 2022）【重点推荐】</h3>
<p><strong>一句话定位</strong>：Go + WebView 的桌面应用方案，填补 Go 技术栈空白，比 Tauri 学习曲线更低。</p>
<p><strong>技术栈</strong>：</p>
<ul>
<li>前端：任意 Web 框架（React/Vue/Svelte/原生）</li>
<li>后端：Go</li>
<li>渲染：系统 WebView（与 Tauri 相同）</li>
<li>绑定：Go 方法直接暴露给前端</li>
</ul>
<p><strong>核心优势</strong>：</p>



































<table><thead><tr><th>优势</th><th>说明</th><th>对比</th></tr></thead><tbody><tr><td><strong>学习曲线低</strong></td><td>Go 比 Rust 容易学</td><td>比 Tauri 门槛低 50%</td></tr><tr><td><strong>类型安全</strong></td><td>自动生成 TS 类型</td><td>编译时发现错误</td></tr><tr><td><strong>并发能力强</strong></td><td>goroutine 原生支持</td><td>适合高并发场景</td></tr><tr><td><strong>包体适中</strong></td><td>10-15MB</td><td>比 Electron 小 90%</td></tr><tr><td><strong>编译快</strong></td><td>Go 编译速度快</td><td>比 Rust 快 5-10 倍</td></tr></tbody></table>
<p><strong>桌面 WebView 方案全面对比</strong>：</p>




































































<table><thead><tr><th>维度</th><th>Electron</th><th>Tauri</th><th>Wails</th><th>Electrobun</th></tr></thead><tbody><tr><td>后端语言</td><td>Node.js</td><td>Rust</td><td><strong>Go</strong></td><td>Bun (TS)</td></tr><tr><td>学习曲线</td><td>低（JS/TS）</td><td>高（Rust陡）</td><td><strong>低（Go易学）</strong></td><td>低（TS）</td></tr><tr><td>包体大小</td><td>150MB</td><td>3MB</td><td>10MB</td><td>15MB</td></tr><tr><td>内存占用</td><td>100MB</td><td>30MB</td><td>45MB</td><td>50MB</td></tr><tr><td>编译速度</td><td>无需编译</td><td>慢（Rust）</td><td><strong>快（Go）</strong></td><td>快</td></tr><tr><td>并发模型</td><td>事件循环</td><td>异步+线程</td><td><strong>goroutine</strong></td><td>异步</td></tr><tr><td>类型安全</td><td>JS→TS</td><td>手动定义</td><td><strong>自动生成TS</strong></td><td>TS 原生</td></tr><tr><td>生态成熟度</td><td>5/5</td><td>4/5</td><td>3/5</td><td>2/5</td></tr></tbody></table>
<p><strong>适合场景</strong>：</p>
<ul>
<li><strong>Go 技术栈团队做桌面应用</strong>（这是最主要的使用场景）</li>
<li>后端逻辑复杂，需要高并发处理（如数据同步、文件处理）</li>
<li>需要调用 Go 生态的库（如 gRPC、各种数据库驱动）</li>
<li>在意包体大小，但不想学 Rust</li>
<li>系统工具类应用（文件管理、网络工具、开发工具）</li>
</ul>
<p><strong>不太适合</strong>：</p>
<ul>
<li>需要跨平台 UI 完全一致（WebView 版本不同）</li>
<li>需要移动端支持（Wails 主要是桌面）</li>
<li>复杂的前端逻辑但后端很简单（考虑 Electron）</li>
<li>团队完全是前端，没人会 Go</li>
</ul>
<p><strong>真实案例</strong>：</p>
<ul>
<li><strong>LocalSend</strong>：跨平台文件传输工具（开源，6k+ stars）</li>
<li><strong>Clash Verge</strong>：代理工具的 GUI 版本</li>
<li>多个企业内部工具（数据分析、运维面板）</li>
</ul>
<p><strong>代码示例</strong>（完整的类型安全流程）：</p>
<p><strong>步骤 1：后端 Go 方法</strong></p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// app.go - 定义后端方法</span>
<span class="hljs-keyword">type</span> App <span class="hljs-keyword">struct</span> {
    ctx context.Context
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a *App)</span></span> Greet(name <span class="hljs-type">string</span>) <span class="hljs-type">string</span> {
    <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">"Hello %s!"</span>, name)
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a *App)</span></span> ProcessFile(path <span class="hljs-type">string</span>) <span class="hljs-type">error</span> {
    <span class="hljs-comment">// 利用 Go 的 goroutine 并发处理</span>
    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// 后台处理文件</span>
    }()
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
}
</code></pre>
<p><strong>步骤 2：Wails 自动生成 TypeScript 类型</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// wailsjs/go/models.ts - 自动生成，无需手写</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">namespace</span> main {
    <span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">App</span> {
        <span class="hljs-keyword">static</span> <span class="hljs-title class_">Greet</span>(<span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt;;
        <span class="hljs-keyword">static</span> <span class="hljs-title class_">ProcessFile</span>(<span class="hljs-attr">path</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;;
    }
}
</code></pre>
<p><strong>步骤 3：前端调用（完全类型安全）</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Greet</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../wailsjs/go/main/App'</span>;

<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Greet</span>(<span class="hljs-string">"World"</span>);  <span class="hljs-comment">// ✅ 类型正确</span>
<span class="hljs-comment">// await Greet(123);  // ❌ TypeScript 编译错误</span>
</code></pre>
<blockquote>
<p><strong>核心优势</strong>：前后端接口不匹配在编译时就能发现，而不是运行时报错。</p>
</blockquote>
<p><strong>快速开始（5 分钟）</strong>：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. 安装 CLI</span>
go install github.com/wailsapp/wails/v2/cmd/wails@latest

<span class="hljs-comment"># 2. 检查环境</span>
wails doctor

<span class="hljs-comment"># 3. 创建项目（选择模板：react/vue/svelte）</span>
wails init -n myapp -t react

<span class="hljs-comment"># 4. 开发（热重载）</span>
<span class="hljs-built_in">cd</span> myapp &amp;&amp; wails dev

<span class="hljs-comment"># 5. 构建</span>
wails build  <span class="hljs-comment"># 输出: myapp.app / myapp.exe / myapp</span>
</code></pre>
<p><strong>Wails v2 vs v3（2025 重大更新）</strong>：</p>
<p>Wails v3 正在开发中，主要改进：</p>
<ul>
<li><strong>原生移动端支持</strong>（iOS/Android）</li>
<li><strong>插件系统</strong>（类似 Tauri 的插件）</li>
<li><strong>更好的 TypeScript 集成</strong></li>
<li><strong>自动更新支持</strong></li>
</ul>
<p><strong>性能优化技巧</strong>：</p>
<ol>
<li><strong>使用 Go 的并发优势</strong>：</li>
</ol>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// 并行处理多个任务</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a *App)</span></span> ProcessMultipleFiles(files []<span class="hljs-type">string</span>) {
    <span class="hljs-keyword">var</span> wg sync.WaitGroup
    <span class="hljs-keyword">for</span> _, file := <span class="hljs-keyword">range</span> files {
        wg.Add(<span class="hljs-number">1</span>)
        <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(f <span class="hljs-type">string</span>)</span></span> {
            <span class="hljs-keyword">defer</span> wg.Done()
            <span class="hljs-comment">// 处理文件</span>
        }(file)
    }
    wg.Wait()
}
</code></pre>
<ol start="2">
<li><strong>使用事件系统</strong>（前后端通信）：</li>
</ol>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// 后端发送事件</span>
runtime.EventsEmit(a.ctx, <span class="hljs-string">"progress"</span>, Progress{
    Current: <span class="hljs-number">50</span>,
    Total: <span class="hljs-number">100</span>,
})
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// 前端监听事件</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">EventsOn</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../wailsjs/runtime'</span>;

<span class="hljs-title class_">EventsOn</span>(<span class="hljs-string">'progress'</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Progress: <span class="hljs-subst">${data.current}</span>/<span class="hljs-subst">${data.total}</span>`</span>);
});
</code></pre>
<ol start="3">
<li><strong>按需构建</strong>（减小包体）：</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 只构建当前平台</span>
wails build

<span class="hljs-comment"># 跨平台构建</span>
wails build -platform darwin/amd64,darwin/arm64,windows/amd64
</code></pre>
<p><strong>常见问题</strong>：</p>

























<table><thead><tr><th>问题</th><th>解决方案</th></tr></thead><tbody><tr><td>Windows 缺少 WebView2</td><td>引导用户安装 WebView2 Runtime</td></tr><tr><td>跨平台 WebView 差异</td><td>测试各平台，使用 polyfill</td></tr><tr><td>Go 依赖管理</td><td>运行 <code>go mod tidy</code></td></tr><tr><td>前端资源路径错误</td><td>检查 <code>wails.json</code> 配置</td></tr></tbody></table>
<p><strong>Wails vs Tauri 选择指南</strong>：</p>








































<table><thead><tr><th>维度</th><th>选 Wails</th><th>选 Tauri</th></tr></thead><tbody><tr><td>团队技能</td><td>熟悉 Go / 不想学 Rust</td><td>愿意学 Rust</td></tr><tr><td>后端需求</td><td>高并发（goroutine）</td><td>一般</td></tr><tr><td>包体要求</td><td>10MB 可接受</td><td>要求最小（3MB）</td></tr><tr><td>编译速度</td><td>要求快</td><td>可接受慢</td></tr><tr><td>类型安全</td><td>要自动生成</td><td>手动定义可接受</td></tr><tr><td>生态成熟度</td><td>可接受成长期</td><td>要求更成熟</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-17">2.10 Kotlin Multiplatform / KMP（JetBrains，2023 稳定版）</h3>
<p><strong>一句话定位</strong>：Android 团队扩展 iOS 的"最小阻力路径"，逻辑共享优先。</p>
<p><strong>技术栈</strong>：</p>
<ul>
<li>语言：Kotlin</li>
<li>共享层：<code>commonMain</code>（纯 Kotlin，编译到各平台）</li>
<li>UI 方案：
<ul>
<li>原生 UI：Android 用 Jetpack Compose，iOS 用 SwiftUI</li>
<li>共享 UI：Compose Multiplatform（跨平台 Compose）</li>
</ul>
</li>
</ul>
<p><strong>核心概念</strong>：</p>
<pre><code class="hljs language-kotlin" lang="kotlin">┌────────────────────────────────────────────────┐
│                  commonMain                     │
│   <span class="hljs-keyword">expect</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getPlatformName</span><span class="hljs-params">()</span></span>: String          │  ← 声明接口
├──────────────────────┬─────────────────────────┤
│      androidMain     │        iosMain          │
│   <span class="hljs-keyword">actual</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-keyword">get</span>..<span class="hljs-params">()</span></span> │    <span class="hljs-keyword">actual</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-keyword">get</span>..<span class="hljs-params">()</span></span>   │  ← 各平台实现
│   = <span class="hljs-string">"Android"</span>        │    = <span class="hljs-string">"iOS"</span>              │
└──────────────────────┴─────────────────────────┘
</code></pre>
<p><strong>适合场景</strong>：</p>
<ul>
<li>已有 Android 应用，想扩展到 iOS</li>
<li>想保持各平台的原生体验</li>
<li>团队熟悉 Kotlin</li>
</ul>
<p><strong>不太适合</strong>：</p>
<ul>
<li>想一套代码搞定所有 UI</li>
<li>团队对 Kotlin 不熟悉</li>
<li>iOS 是主要平台（用 SwiftUI 原生可能更顺）</li>
</ul>
<p><strong>代码示例</strong>：</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// commonMain - 共享的网络请求逻辑</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserRepository</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> api: UserApi) {
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getUser</span><span class="hljs-params">(id: <span class="hljs-type">String</span>)</span></span>: User {
        <span class="hljs-keyword">return</span> api.fetchUser(id)
    }
}

<span class="hljs-comment">// 在 Android 和 iOS 中都可以直接使用</span>
<span class="hljs-keyword">val</span> repo = UserRepository(api)
<span class="hljs-keyword">val</span> user = repo.getUser(<span class="hljs-string">"123"</span>)
</code></pre>
<p><strong>入门步骤</strong>：</p>
<ol>
<li>安装 Android Studio + Kotlin Multiplatform Mobile 插件</li>
<li>创建 KMP 项目（选择模板）</li>
<li>在 <code>shared/src/commonMain</code> 中编写共享逻辑</li>
<li>Android 端：直接依赖 <code>shared</code> 模块</li>
<li>iOS 端：通过 CocoaPods 或 Swift Package Manager 集成</li>
</ol>
<hr/>
<h3 data-id="heading-18">2.11 Lynx（ByteDance，2024 开源）</h3>
<p><strong>一句话定位</strong>：字节跳动的跨端方案，用 Web 语法写原生渲染的 UI。</p>
<p><strong>技术栈</strong>：</p>
<ul>
<li>语言：JavaScript/TypeScript</li>
<li>UI 语法：类 React/CSS（支持 Flexbox）</li>
<li>渲染：自研原生渲染引擎（非 WebView）</li>
</ul>
<p><strong>核心特点</strong>：</p>
<ul>
<li><strong>双线程架构</strong>：UI 线程和 JS 线程分离，避免 JS 阻塞渲染</li>
<li><strong>CSS 子集</strong>：支持 Flexbox、常用属性，但不是完整 CSS</li>
<li><strong>PlatformView</strong>：可嵌入原生控件（如地图、视频播放器）</li>
</ul>
<p><strong>适合场景</strong>：</p>
<ul>
<li>前端团队想做高性能移动应用</li>
<li>需要比 RN 更好的动效性能</li>
<li>字节系应用的技术选型</li>
</ul>
<p><strong>不太适合</strong>：</p>
<ul>
<li>追求稳定、成熟的生态</li>
<li>需要社区大量第三方库支持</li>
<li>桌面端需求（目前主要支持移动端 + Web）</li>
</ul>
<p><strong>代码示例</strong>：</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// Lynx 的语法对 React 开发者很熟悉</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Component</span>, <span class="hljs-title class_">View</span>, <span class="hljs-title class_">Text</span>, <span class="hljs-title class_">Image</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@anthropic/lynx'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Component</span> {
  state = { <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> };

  <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">flex:</span> <span class="hljs-attr">1</span>, <span class="hljs-attr">justifyContent:</span> '<span class="hljs-attr">center</span>', <span class="hljs-attr">alignItems:</span> '<span class="hljs-attr">center</span>' }}&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">fontSize:</span> <span class="hljs-attr">24</span> }}&gt;</span>点击了 {this.state.count} 次<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">View</span>
          <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">padding:</span> <span class="hljs-attr">15</span>, <span class="hljs-attr">backgroundColor:</span> '#<span class="hljs-attr">007AFF</span>', <span class="hljs-attr">borderRadius:</span> <span class="hljs-attr">8</span> }}
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> this.setState({ count: this.state.count + 1 })}
        &gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color:</span> '<span class="hljs-attr">white</span>' }}&gt;</span>+1<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>
    );
  }
}
</code></pre>
<p><strong>入门步骤</strong>：</p>
<ol>
<li>参考官方文档：<a href="https://link.juejin.cn?target=https%3A%2F%2Flynxjs.org%2F" target="_blank" title="https://lynxjs.org/" ref="nofollow noopener noreferrer">lynxjs.org/</a></li>
<li>安装 Lynx CLI</li>
<li>创建项目并配置模拟器环境</li>
<li>运行调试</li>
</ol>
<hr/>
<h3 data-id="heading-19">2.12 Valdi（Snapchat，2024 Beta）</h3>
<p><strong>一句话定位</strong>：TypeScript 编译成原生视图，追求 TS 开发体验 + 原生性能。</p>
<p><strong>技术栈</strong>：</p>
<ul>
<li>语言：TypeScript</li>
<li>编译：TS → 原生视图代码（不是解释执行）</li>
<li>渲染：原生控件</li>
</ul>
<p><strong>核心理念</strong>：</p>
<ul>
<li>不走 WebView，也不走 JS 运行时</li>
<li>把 TS 代码编译成原生代码</li>
<li>类型安全 + 原生性能</li>
</ul>
<p><strong>适合场景</strong>：</p>
<ul>
<li>喜欢 TypeScript 但不想用 WebView</li>
<li>追求原生性能</li>
<li>愿意尝试新技术</li>
</ul>
<p><strong>不太适合</strong>：</p>
<ul>
<li>需要稳定、成熟的生态</li>
<li>大型团队生产环境使用（目前是 Beta）</li>
</ul>
<p><strong>入门步骤</strong>：</p>
<ol>
<li>访问：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSnapchat%2FValdi" target="_blank" title="https://github.com/Snapchat/Valdi" ref="nofollow noopener noreferrer">github.com/Snapchat/Va…</a></li>
<li>按 README 安装工具链</li>
<li>创建项目并配置目标平台</li>
<li>开发调试</li>
</ol>
<hr/>
<h3 data-id="heading-20">2.13 Electrobun（2024 早期）</h3>
<p><strong>一句话定位</strong>：比 Electron 更轻量的桌面方案，用 Bun + 系统 WebView/CEF。</p>
<p><strong>技术栈</strong>：</p>
<ul>
<li>语言：TypeScript</li>
<li>运行时：Bun（替代 Node.js）</li>
<li>渲染：系统 WebView 或 CEF（可选）</li>
<li>底层：Zig</li>
</ul>
<p><strong>与 Electron/Tauri 对比</strong>：</p>



































<table><thead><tr><th>维度</th><th>Electron</th><th>Tauri</th><th>Electrobun</th></tr></thead><tbody><tr><td>后端</td><td>Node.js</td><td>Rust</td><td>Bun (TS)</td></tr><tr><td>学习成本</td><td>低</td><td>中（要学 Rust）</td><td>低</td></tr><tr><td>包体</td><td>大</td><td>小</td><td>中</td></tr><tr><td>成熟度</td><td>高</td><td>中</td><td>早期</td></tr></tbody></table>
<p><strong>适合场景</strong>：</p>
<ul>
<li>想要比 Electron 轻量，但不想学 Rust</li>
<li>喜欢 Bun 的开发体验</li>
<li>愿意接受早期阶段的风险</li>
</ul>
<p><strong>入门步骤</strong>：</p>
<ol>
<li>安装 Bun：<a href="https://link.juejin.cn?target=https%3A%2F%2Fbun.sh%2F" target="_blank" title="https://bun.sh/" ref="nofollow noopener noreferrer">bun.sh/</a></li>
<li>访问：<a href="https://link.juejin.cn?target=https%3A%2F%2Felectrobun.dev%2F" target="_blank" title="https://electrobun.dev/" ref="nofollow noopener noreferrer">electrobun.dev/</a></li>
<li>按文档初始化项目</li>
<li>开发调试</li>
</ol>
<hr/>
<h3 data-id="heading-21">2.14 Dioxus（Dioxus Labs，2021 / v0.5 2024）【重点推荐】</h3>
<p><strong>一句话定位</strong>：Rust 版的 React，用 React-like 语法写全平台 UI，Rust 生态的"全能选手"。</p>
<p><strong>技术栈</strong>：</p>
<ul>
<li>语言：Rust</li>
<li>语法：类 React Hooks（但是 Rust 宏实现）</li>
<li>渲染：多后端（Web/Desktop/Mobile/TUI）</li>
<li>架构：虚拟 DOM + 响应式</li>
</ul>
<p><strong>核心优势</strong>：</p>



































<table><thead><tr><th>优势</th><th>说明</th><th>独特性</th></tr></thead><tbody><tr><td><strong>React-like 语法</strong></td><td>前端开发者易上手</td><td>Rust GUI 中最像 React</td></tr><tr><td><strong>多渲染后端</strong></td><td>Web/Desktop/Mobile/TUI</td><td>一套代码多平台</td></tr><tr><td><strong>WASM 性能</strong></td><td>接近原生的 Web 性能</td><td>比 JS 快 2-10 倍</td></tr><tr><td><strong>类型安全</strong></td><td>Rust 编译时检查</td><td>内存安全 + 线程安全</td></tr><tr><td><strong>TUI 支持</strong></td><td>终端 UI 独特优势</td><td>其他框架都不支持</td></tr></tbody></table>
<p><strong>与其他 Rust GUI 框架的对比</strong>：</p>




































































<table><thead><tr><th>维度</th><th>Dioxus</th><th>GPUI</th><th>Tauri</th><th>egui</th></tr></thead><tbody><tr><td>语法风格</td><td>React-like</td><td>Rust 原生</td><td>Web 前端</td><td>即时模式</td></tr><tr><td>学习曲线</td><td>低（前端易上手）</td><td>高（需熟练 Rust）</td><td>低（会 Web 即可）</td><td>中等</td></tr><tr><td>移动端支持</td><td>开发中</td><td>无</td><td>v2 支持</td><td>有限</td></tr><tr><td>Web 支持</td><td>5/5 完整 WASM</td><td>无</td><td>5/5 完整</td><td>3/5 有限</td></tr><tr><td>TUI 支持</td><td>5/5 独特优势</td><td>无</td><td>无</td><td>无</td></tr><tr><td>组件生态</td><td>3/5 成长中</td><td>2/5 早期</td><td>5/5（npm生态）</td><td>3/5</td></tr><tr><td>渲染性能</td><td>4/5 强</td><td>5/5 极强</td><td>3/5 中等</td><td>4/5 强</td></tr><tr><td>成熟度</td><td>3/5 成长中</td><td>3/5 成长中</td><td>4/5 稳定</td><td>4/5 稳定</td></tr></tbody></table>
<p><strong>适合场景</strong>：</p>
<ul>
<li><strong>Rust 技术栈，想做全平台应用</strong></li>
<li>需要 Web（WASM）和桌面共享代码</li>
<li>前端转 Rust 的开发者（熟悉 React）</li>
<li>命令行工具需要 TUI 界面</li>
<li>性能敏感的应用（利用 Rust + WASM）</li>
<li>开源项目（生态正在快速成长）</li>
</ul>
<p><strong>不太适合</strong>：</p>
<ul>
<li>不熟悉 Rust 的团队（学习曲线陡）</li>
<li>需要大量现成组件（生态还在建设中）</li>
<li>生产环境要求极高稳定性（v1.0 还未发布）</li>
<li>移动端是主要平台（移动端支持还在完善）</li>
</ul>
<p><strong>真实案例</strong>：</p>
<ul>
<li><strong>Blitz（开源）</strong>：游戏辅助工具</li>
<li><strong>FutureSDR</strong>：软件定义无线电框架的 UI</li>
<li>多个开源开发工具和 TUI 应用</li>
</ul>
<p><strong>代码示例</strong>（感受 Rust + React 的组合）：</p>
<p><strong>基础计数器</strong>：</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> dioxus::prelude::*;

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    dioxus_desktop::<span class="hljs-title function_ invoke__">launch</span>(App);
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">App</span>(cx: Scope) <span class="hljs-punctuation">-&gt;</span> Element {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">count</span> = <span class="hljs-title function_ invoke__">use_state</span>(cx, || <span class="hljs-number">0</span>);

    cx.<span class="hljs-title function_ invoke__">render</span>(rsx! {
        div {
            style: <span class="hljs-string">"display: flex; flex-direction: column; align-items: center; gap: 20px;"</span>,
            h1 { <span class="hljs-string">"计数器"</span> }
            p {
                style: <span class="hljs-string">"font-size: 24px;"</span>,
                <span class="hljs-string">"点击了 {count} 次"</span>
            }
            button {
                onclick: <span class="hljs-keyword">move</span> |_| count += <span class="hljs-number">1</span>,
                style: <span class="hljs-string">"padding: 10px 20px; font-size: 18px;"</span>,
                <span class="hljs-string">"+1"</span>
            }
        }
    })
}
</code></pre>
<p><strong>组件复用</strong>（像 React 一样）：</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// 可复用的 Button 组件</span>
<span class="hljs-meta">#[component]</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">MyButton</span>&lt;<span class="hljs-symbol">'a</span>&gt;(
    cx: Scope&lt;<span class="hljs-symbol">'a</span>&gt;,
    onclick: EventHandler&lt;<span class="hljs-symbol">'a</span>, MouseEvent&gt;,
    children: Element&lt;<span class="hljs-symbol">'a</span>&gt;,
) <span class="hljs-punctuation">-&gt;</span> Element&lt;<span class="hljs-symbol">'a</span>&gt; {
    cx.<span class="hljs-title function_ invoke__">render</span>(rsx! {
        button {
            class: <span class="hljs-string">"custom-button"</span>,
            onclick: <span class="hljs-keyword">move</span> |evt| onclick.<span class="hljs-title function_ invoke__">call</span>(evt),
            children
        }
    })
}

<span class="hljs-comment">// 使用组件</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">App</span>(cx: Scope) <span class="hljs-punctuation">-&gt;</span> Element {
    cx.<span class="hljs-title function_ invoke__">render</span>(rsx! {
        MyButton {
            onclick: |_| <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Clicked!"</span>),
            <span class="hljs-string">"点击我"</span>
        }
    })
}
</code></pre>
<p><strong>异步数据获取</strong>（类似 React Query）：</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> dioxus::prelude::*;

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">App</span>(cx: Scope) <span class="hljs-punctuation">-&gt;</span> Element {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">user_data</span> = <span class="hljs-title function_ invoke__">use_future</span>(cx, (), |_| <span class="hljs-keyword">async</span> <span class="hljs-keyword">move</span> {
        <span class="hljs-comment">// 异步请求数据</span>
        reqwest::<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">"https://api.example.com/user"</span>)
            .<span class="hljs-keyword">await</span>?
            .json::&lt;User&gt;()
            .<span class="hljs-keyword">await</span>
    });

    cx.<span class="hljs-title function_ invoke__">render</span>(<span class="hljs-keyword">match</span> user_data.<span class="hljs-title function_ invoke__">value</span>() {
        <span class="hljs-literal">None</span> =&gt; rsx! { p { <span class="hljs-string">"加载中..."</span> } },
        <span class="hljs-title function_ invoke__">Some</span>(<span class="hljs-title function_ invoke__">Ok</span>(user)) =&gt; rsx! {
            div {
                h1 { <span class="hljs-string">"欢迎, {user.name}"</span> }
                p { <span class="hljs-string">"邮箱: {user.email}"</span> }
            }
        },
        <span class="hljs-title function_ invoke__">Some</span>(<span class="hljs-title function_ invoke__">Err</span>(e)) =&gt; rsx! { p { <span class="hljs-string">"错误: {e}"</span> } },
    })
}
</code></pre>
<p><strong>多渲染后端示例</strong>：</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// 同一套代码，不同渲染后端</span>

<span class="hljs-comment">// 1. 桌面应用（WebView）</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    dioxus_desktop::<span class="hljs-title function_ invoke__">launch</span>(App);
}

<span class="hljs-comment">// 2. Web 应用（WASM）</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    dioxus_web::<span class="hljs-title function_ invoke__">launch</span>(App);
}

<span class="hljs-comment">// 3. 终端 UI（TUI）</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    dioxus_tui::<span class="hljs-title function_ invoke__">launch</span>(App);
}

<span class="hljs-comment">// 4. 服务端渲染（SSR）</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">html</span> = dioxus_ssr::<span class="hljs-title function_ invoke__">render</span>(&amp;<span class="hljs-title function_ invoke__">App</span>(cx));
    <span class="hljs-comment">// 返回 HTML 字符串</span>
}
</code></pre>
<p><strong>入门步骤</strong>：</p>
<ol>
<li>
<p><strong>安装 Rust 和 Dioxus CLI</strong>：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 安装 Rust</span>
curl --proto <span class="hljs-string">'=https'</span> --tlsv1.2 -sSf https://sh.rustup.rs | sh

<span class="hljs-comment"># 安装 Dioxus CLI</span>
cargo install dioxus-cli
</code></pre>
</li>
<li>
<p><strong>创建项目</strong>（自动配置）：</p>
<pre><code class="hljs language-bash" lang="bash">dx new my-app
<span class="hljs-comment"># 选择模板：web, desktop, mobile, TUI</span>
</code></pre>
</li>
<li>
<p><strong>开发模式</strong>（带热重载）：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> my-app
dx serve  <span class="hljs-comment"># Web</span>
<span class="hljs-comment"># 或</span>
dx serve --platform desktop  <span class="hljs-comment"># 桌面</span>
</code></pre>
</li>
<li>
<p><strong>构建生产版本</strong>：</p>
<pre><code class="hljs language-bash" lang="bash">dx build --release
</code></pre>
</li>
</ol>
<p><strong>Dioxus 0.5 的重大改进</strong>（2024）：</p>
<ul>
<li>✅ <strong>信号系统</strong>：更简单的状态管理</li>
<li>✅ <strong>资源系统</strong>：内置异步数据获取</li>
<li>✅ <strong>路由系统</strong>：完整的客户端路由</li>
<li>✅ <strong>服务端组件</strong>：支持 SSR 和流式渲染</li>
<li>✅ <strong>热重载</strong>：开发体验接近 Vite</li>
</ul>
<p><strong>性能优化技巧</strong>：</p>
<ol>
<li><strong>利用 Rust 的零成本抽象</strong>：</li>
</ol>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// 组件会在编译时优化</span>
<span class="hljs-meta">#[inline(always)]</span>
<span class="hljs-meta">#[component]</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">FastComponent</span>(cx: Scope) <span class="hljs-punctuation">-&gt;</span> Element {
    <span class="hljs-comment">// 编译器会内联这个组件</span>
}
</code></pre>
<ol start="2">
<li><strong>使用 memo 避免重渲染</strong>：</li>
</ol>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">expensive</span> = <span class="hljs-title function_ invoke__">use_memo</span>(cx, (dep1, dep2), |(d1, d2)| {
    <span class="hljs-comment">// 只在 dep1 或 dep2 变化时重新计算</span>
    <span class="hljs-title function_ invoke__">heavy_computation</span>(d1, d2)
});
</code></pre>
<ol start="3">
<li><strong>WASM 优化</strong>：</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 构建优化的 WASM</span>
dx build --release --platform web
<span class="hljs-comment"># 生成的 WASM 包通常只有几百 KB</span>
</code></pre>
<p><strong>TUI 应用示例</strong>（独特优势）：</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// 用同样的代码创建漂亮的终端 UI</span>
<span class="hljs-keyword">use</span> dioxus::prelude::*;
<span class="hljs-keyword">use</span> dioxus_tui::Config;

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    dioxus_tui::<span class="hljs-title function_ invoke__">launch_cfg</span>(
        App,
        Config::<span class="hljs-title function_ invoke__">new</span>().<span class="hljs-title function_ invoke__">with_rendering_mode</span>(RenderingMode::Ansi),
    );
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">App</span>(cx: Scope) <span class="hljs-punctuation">-&gt;</span> Element {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">count</span> = <span class="hljs-title function_ invoke__">use_state</span>(cx, || <span class="hljs-number">0</span>);

    cx.<span class="hljs-title function_ invoke__">render</span>(rsx! {
        div {
            border_width: <span class="hljs-string">"1px"</span>,
            padding: <span class="hljs-string">"2"</span>,
            h1 { <span class="hljs-string">"Terminal Counter"</span> }
            p { <span class="hljs-string">"Count: {count}"</span> }
            button {
                onclick: <span class="hljs-keyword">move</span> |_| count += <span class="hljs-number">1</span>,
                <span class="hljs-string">"Increment"</span>
            }
        }
    })
}
</code></pre>
<p><strong>常见坑</strong>：</p>
<ul>
<li>
<p><strong>生命周期标注</strong>：</p>
<ul>
<li>Rust 的生命周期可能让新手困惑</li>
<li>使用 Dioxus CLI 生成的模板可以避免大部分问题</li>
</ul>
</li>
<li>
<p><strong>异步运行时</strong>：</p>
<ul>
<li>需要理解 Rust 的 async/await</li>
<li>建议使用 <code>use_future</code> 而不是手动管理</li>
</ul>
</li>
<li>
<p><strong>跨平台样式</strong>：</p>
<ul>
<li>不同渲染后端的样式支持不同</li>
<li>Web 支持完整 CSS，桌面支持子集</li>
</ul>
</li>
</ul>
<p><strong>Rust GUI 框架选择指南</strong>：</p>













































<table><thead><tr><th>需求</th><th>推荐框架</th><th>理由</th></tr></thead><tbody><tr><td>Web + 桌面共享代码</td><td><strong>Dioxus</strong></td><td>WASM + 多后端</td></tr><tr><td>前端团队用 Rust 后端</td><td><strong>Tauri</strong></td><td>前后端分离</td></tr><tr><td>React 开发者转 Rust</td><td><strong>Dioxus</strong></td><td>语法相似</td></tr><tr><td>需要 TUI（终端界面）</td><td><strong>Dioxus</strong></td><td>独特支持</td></tr><tr><td>追求极致性能（编辑器）</td><td><strong>GPUI</strong></td><td>为 Zed 设计</td></tr><tr><td>嵌入式设备</td><td><strong>Slint</strong></td><td>轻量级</td></tr><tr><td>要 npm 生态</td><td><strong>Tauri</strong></td><td>Web 前端</td></tr></tbody></table>
<p><strong>未来展望</strong>：</p>
<ul>
<li>📱 <strong>移动端支持</strong>：Dioxus Mobile 正在开发，预计 2026 稳定</li>
<li>🎨 <strong>组件库</strong>：社区正在建设类似 shadcn/ui 的组件库</li>
<li>🔧 <strong>开发者工具</strong>：DevTools 正在完善，类似 React DevTools</li>
</ul>
<hr/>
<h3 data-id="heading-22">2.15 Slint（SixtyFPS GmbH，2020 / v1.0 2023）</h3>
<p><strong>一句话定位</strong>：嵌入式和桌面 GUI 框架，填补"Qt 太重，Flutter 太大"的空白。</p>
<p><strong>技术栈</strong>：</p>
<ul>
<li>语言：Rust/C++/JavaScript（多语言绑定）</li>
<li>UI 语法：自研 DSL（<code>.slint</code> 文件）</li>
<li>渲染：多后端（软件渲染/OpenGL/Skia/Femtovg）</li>
<li>架构：声明式 UI + 响应式属性</li>
</ul>
<p><strong>核心特点</strong>：</p>
<ol>
<li>
<p><strong>极致轻量</strong></p>
<ul>
<li>适合低端嵌入式设备（MCU、ARM Cortex-M）</li>
<li>包体可以做到 &lt; 300KB（不含资源）</li>
<li>内存占用可控（几 MB 级别）</li>
</ul>
</li>
<li>
<p><strong>多语言支持</strong></p>
<ul>
<li>Rust（一等公民）</li>
<li>C++（适合嵌入式团队）</li>
<li>JavaScript/Node.js（快速原型）</li>
<li>Python（正在开发）</li>
</ul>
</li>
<li>
<p><strong>设计师友好</strong></p>
<ul>
<li>提供可视化设计工具（Slint UI Designer）</li>
<li>支持热重载</li>
<li>类似 QML 的声明式语法</li>
</ul>
</li>
</ol>
<p><strong>与 Qt 的对比</strong>（嵌入式场景）：</p>













































<table><thead><tr><th>维度</th><th>Qt (Qt Quick)</th><th>Slint</th></tr></thead><tbody><tr><td>最小包体</td><td>~10-20MB</td><td>~300KB</td></tr><tr><td>内存占用</td><td>~20-50MB</td><td>~2-10MB</td></tr><tr><td>启动速度</td><td>慢</td><td>快</td></tr><tr><td>MCU 支持</td><td>需要 Qt for MCUs（商业版）</td><td>开源版支持</td></tr><tr><td>许可证</td><td>LGPL/GPL 或商业</td><td>GPL/商业（企业版）</td></tr><tr><td>学习曲线</td><td>中</td><td>低</td></tr><tr><td>工业案例</td><td>5/5 极多</td><td>3/5 成长中</td></tr></tbody></table>
<p><strong>适合场景</strong>：</p>
<ul>
<li><strong>嵌入式设备</strong>：智能家居、工业控制面板、车载 HMI（低端）</li>
<li><strong>资源受限环境</strong>：老旧设备、单板计算机（树莓派）</li>
<li><strong>快速启动应用</strong>：系统工具、启动界面</li>
<li><strong>多语言团队</strong>：可以用 Rust/C++/JS 中的任意一种</li>
</ul>
<p><strong>不太适合</strong>：</p>
<ul>
<li>需要复杂动效（Qt/Flutter 更强）</li>
<li>需要大量现成组件（生态还在建设）</li>
<li>Web 应用（虽然有 WASM，但不如 Dioxus）</li>
<li>移动端应用（主要是桌面+嵌入式）</li>
</ul>
<p><strong>真实案例</strong>：</p>
<ul>
<li>工业控制面板</li>
<li>智能家居设备 UI</li>
<li>医疗设备界面</li>
</ul>
<p><strong>代码示例</strong>（感受 Slint 的 DSL）：</p>
<p><strong>UI 文件</strong>（<code>.slint</code> 声明式语法）：</p>
<pre><code class="hljs language-slint" lang="slint">// counter.slint
import { Button, VerticalBox } from "std-widgets.slint";

export component Counter {
    in-out property &lt;int&gt; counter: 0;

    VerticalBox {
        Text {
            text: "点击了 \{counter} 次";
            font-size: 24px;
        }

        Button {
            text: "+1";
            clicked =&gt; {
                counter += 1;
            }
        }
    }
}
</code></pre>
<p><strong>Rust 调用</strong>：</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// main.rs</span>
slint::slint! {
    import { Counter } from <span class="hljs-string">"counter.slint"</span>;
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">ui</span> = Counter::<span class="hljs-title function_ invoke__">new</span>().<span class="hljs-title function_ invoke__">unwrap</span>();

    <span class="hljs-comment">// 可以从 Rust 代码访问和修改属性</span>
    ui.<span class="hljs-title function_ invoke__">set_counter</span>(<span class="hljs-number">0</span>);

    <span class="hljs-comment">// 监听属性变化</span>
    ui.<span class="hljs-title function_ invoke__">on_counter_changed</span>(|value| {
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Counter changed to: {}"</span>, value);
    });

    ui.<span class="hljs-title function_ invoke__">run</span>().<span class="hljs-title function_ invoke__">unwrap</span>();
}
</code></pre>
<p><strong>C++ 调用</strong>（嵌入式团队友好）：</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// main.cpp</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"counter.h"</span></span>

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">auto</span> ui = Counter::<span class="hljs-built_in">create</span>();

    <span class="hljs-comment">// C++ API 类型安全</span>
    ui-&gt;<span class="hljs-built_in">set_counter</span>(<span class="hljs-number">0</span>);

    <span class="hljs-comment">// 回调</span>
    ui-&gt;<span class="hljs-built_in">on_counter_changed</span>([](<span class="hljs-type">int</span> value) {
        std::cout &lt;&lt; <span class="hljs-string">"Counter: "</span> &lt;&lt; value &lt;&lt; std::endl;
    });

    ui-&gt;<span class="hljs-built_in">run</span>();
}
</code></pre>
<p><strong>入门步骤</strong>：</p>
<ol>
<li>
<p><strong>安装 Slint</strong>（Rust 项目）：</p>
<pre><code class="hljs language-bash" lang="bash">cargo new my-app
<span class="hljs-built_in">cd</span> my-app
cargo add slint
</code></pre>
</li>
<li>
<p><strong>创建 UI 文件</strong>：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 创建 ui/counter.slint</span>
<span class="hljs-built_in">mkdir</span> ui
</code></pre>
</li>
<li>
<p><strong>配置 build.rs</strong>（自动编译 .slint 文件）：</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// build.rs</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    slint_build::<span class="hljs-title function_ invoke__">compile</span>(<span class="hljs-string">"ui/counter.slint"</span>).<span class="hljs-title function_ invoke__">unwrap</span>();
}
</code></pre>
</li>
<li>
<p><strong>运行</strong>：</p>
<pre><code class="hljs language-bash" lang="bash">cargo run
</code></pre>
</li>
</ol>
<p><strong>可视化设计工具</strong>：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 安装 Slint UI Designer</span>
cargo install slint-viewer

<span class="hljs-comment"># 实时预览 .slint 文件</span>
slint-viewer ui/counter.slint
</code></pre>
<p><strong>嵌入式示例</strong>（软件渲染，适合无 GPU 设备）：</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> slint::platform::software_renderer::{MinimalSoftwareWindow, RepaintBufferType};

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    slint::platform::<span class="hljs-title function_ invoke__">set_platform</span>(<span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">new</span>(MyPlatform::<span class="hljs-title function_ invoke__">new</span>())).<span class="hljs-title function_ invoke__">unwrap</span>();

    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">ui</span> = Counter::<span class="hljs-title function_ invoke__">new</span>().<span class="hljs-title function_ invoke__">unwrap</span>();

    <span class="hljs-comment">// 渲染到帧缓冲区</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">window</span> = ui.<span class="hljs-title function_ invoke__">window</span>();
    window.<span class="hljs-title function_ invoke__">set_size</span>(slint::PhysicalSize::<span class="hljs-title function_ invoke__">new</span>(<span class="hljs-number">800</span>, <span class="hljs-number">480</span>));

    <span class="hljs-comment">// 自定义事件循环（适合 bare-metal 环境）</span>
    <span class="hljs-keyword">loop</span> {
        slint::platform::<span class="hljs-title function_ invoke__">update_timers_and_animations</span>();
        window.<span class="hljs-title function_ invoke__">draw_if_needed</span>(|renderer| {
            <span class="hljs-comment">// 渲染到你的帧缓冲区</span>
        });
    }
}
</code></pre>
<p><strong>常见坑</strong>：</p>
<ul>
<li><strong>DSL 学习</strong>：<code>.slint</code> 语法需要学习，但比 QML 简单</li>
<li><strong>组件库有限</strong>：标准组件够用，但不如 Qt 丰富</li>
<li><strong>文档</strong>：相比 Qt 文档较少，但正在改善</li>
</ul>
<p><strong>什么时候选 Slint 而不是 Qt？</strong></p>
<p>选 <strong>Slint</strong> 如果：</p>
<ul>
<li>✅ 嵌入式设备资源受限（RAM &lt; 50MB）</li>
<li>✅ 需要快速启动（&lt; 100ms）</li>
<li>✅ 想用 Rust 开发嵌入式 GUI</li>
<li>✅ 对许可证敏感（Qt 商业版很贵）</li>
</ul>
<p>选 <strong>Qt</strong> 如果：</p>
<ul>
<li>✅ 需要丰富的组件库</li>
<li>✅ 工业级项目，稳定性第一</li>
<li>✅ 团队已经熟悉 Qt</li>
<li>✅ 需要跨平台（包括移动端）</li>
</ul>
<hr/>
<h3 data-id="heading-23">2.16 GPUI（Zed Industries，2024）</h3>
<p><strong>一句话定位</strong>：Zed 编辑器的 UI 框架，Rust 生态的高性能 GUI 方案。</p>
<p><strong>技术栈</strong>：</p>
<ul>
<li>语言：Rust</li>
<li>渲染：GPU 加速，自绘渲染</li>
<li>架构：ECS（Entity-Component-System）风格</li>
</ul>
<p><strong>核心特点</strong>：</p>
<ul>
<li>性能极致——为 Zed 编辑器设计，追求每一帧的流畅</li>
<li>Rust 原生——类型安全，内存安全</li>
<li>现代 API——异步优先，响应式</li>
</ul>
<p><strong>适合场景</strong>：</p>
<ul>
<li>Rust 团队做桌面应用</li>
<li>对性能有极致追求</li>
<li>愿意投入时间学习</li>
</ul>
<p><strong>不太适合</strong>：</p>
<ul>
<li>不熟悉 Rust 的团队</li>
<li>需要快速出成果</li>
<li>需要成熟的组件库</li>
</ul>
<p><strong>代码示例</strong>：</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// GPUI 的 Rust 风格 UI</span>
<span class="hljs-keyword">use</span> gpui::*;

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Counter</span> {
    count: <span class="hljs-type">i32</span>,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Render</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">Counter</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">render</span>(&amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>, cx: &amp;<span class="hljs-keyword">mut</span> ViewContext&lt;<span class="hljs-keyword">Self</span>&gt;) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-keyword">impl</span> <span class="hljs-title class_">IntoElement</span> {
        <span class="hljs-title function_ invoke__">div</span>()
            .<span class="hljs-title function_ invoke__">flex</span>()
            .<span class="hljs-title function_ invoke__">flex_col</span>()
            .<span class="hljs-title function_ invoke__">items_center</span>()
            .<span class="hljs-title function_ invoke__">child</span>(<span class="hljs-built_in">format!</span>(<span class="hljs-string">"Count: {}"</span>, <span class="hljs-keyword">self</span>.count))
            .<span class="hljs-title function_ invoke__">child</span>(
                <span class="hljs-title function_ invoke__">button</span>(<span class="hljs-string">"Increment"</span>)
                    .<span class="hljs-title function_ invoke__">on_click</span>(cx.<span class="hljs-title function_ invoke__">listener</span>(|this, _, _| this.count += <span class="hljs-number">1</span>))
            )
    }
}
</code></pre>
<p><strong>入门步骤</strong>：</p>
<ol>
<li>安装 Rust：<code>curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh</code></li>
<li>创建项目：<code>cargo new my_app</code></li>
<li>添加 GPUI 依赖</li>
<li>编写 UI 代码</li>
<li>运行：<code>cargo run</code></li>
</ol>
<hr/>
<h2 data-id="heading-24">第三章：横向对比</h2>
<h3 data-id="heading-25">3.1 核心信息对照表</h3>













































































































































<table><thead><tr><th>框架</th><th>渲染方式</th><th>语言</th><th>平台覆盖</th><th>生态成熟度</th><th>一句话定位</th></tr></thead><tbody><tr><td>Flutter</td><td>自绘</td><td>Dart</td><td>移动+桌面+Web</td><td>5/5 成熟</td><td>全能选手，跨端一致性最强</td></tr><tr><td>React Native</td><td>原生映射</td><td>JS/TS</td><td>移动为主</td><td>5/5 成熟</td><td>前端团队的原生应用方案</td></tr><tr><td>NativeScript</td><td>原生映射</td><td>JS/TS+Vue/Angular</td><td>移动</td><td>3/5 成长中</td><td>Vue/Angular 写原生应用</td></tr><tr><td>Electron</td><td>WebView</td><td>JS/TS</td><td>桌面</td><td>5/5 成熟</td><td>Web 做桌面的事实标准</td></tr><tr><td>Qt Quick</td><td>自绘</td><td>C++/QML</td><td>全平台+嵌入式</td><td>5/5 成熟</td><td>工业级、嵌入式首选</td></tr><tr><td>.NET MAUI</td><td>原生映射</td><td>C#</td><td>全平台</td><td>4/5 稳定</td><td>C# 团队的官方方案</td></tr><tr><td>Uno Platform</td><td>原生/WASM</td><td>C#</td><td>全平台+Web</td><td>4/5 稳定</td><td>C# + WebAssembly</td></tr><tr><td>Tauri</td><td>系统WebView+Rust</td><td>Rust+Web</td><td>桌面+移动</td><td>4/5 稳定</td><td>轻量级 Electron 替代</td></tr><tr><td>Wails</td><td>系统WebView+Go</td><td>Go+Web</td><td>桌面</td><td>3/5 成长中</td><td>Go 技术栈做桌面</td></tr><tr><td>KMP</td><td>原生/Compose</td><td>Kotlin</td><td>移动+桌面</td><td>4/5 稳定</td><td>Android 团队扩 iOS</td></tr><tr><td>Lynx</td><td>自绘</td><td>JS/TS</td><td>移动+Web</td><td>3/5 成长中</td><td>高性能+Web语法</td></tr><tr><td>Valdi</td><td>编译到原生</td><td>TypeScript</td><td>移动</td><td>2/5 早期</td><td>TS 编译到原生</td></tr><tr><td>Electrobun</td><td>系统WebView/CEF</td><td>TypeScript</td><td>桌面</td><td>2/5 早期</td><td>轻量桌面方案</td></tr><tr><td>Dioxus</td><td>自绘/多后端</td><td>Rust</td><td>全平台+TUI</td><td>3/5 成长中</td><td>Rust 版 React</td></tr><tr><td>Slint</td><td>自绘</td><td>Rust/C++/JS</td><td>桌面+嵌入式</td><td>3/5 成长中</td><td>轻量嵌入式 GUI</td></tr><tr><td>GPUI</td><td>自绘</td><td>Rust</td><td>桌面</td><td>2/5 早期</td><td>Rust 高性能 GUI</td></tr></tbody></table>
<h3 data-id="heading-26">3.2 指标矩阵</h3>
<blockquote>
<p>说明：以下评价基于渲染原理和生态现状的一般判断，实际表现取决于具体实现。评分采用 1-5 分制，5 分最高。</p>
</blockquote>






























































































































































<table><thead><tr><th>框架</th><th>包体/启动</th><th>性能上限</th><th>原生体验</th><th>跨端一致</th><th>开发效率</th><th>生产风险</th></tr></thead><tbody><tr><td>Flutter</td><td>3 中等</td><td>5 极强</td><td>3 一般</td><td>5 极强</td><td>5 极高</td><td>低</td></tr><tr><td>React Native</td><td>3 中等</td><td>4 强</td><td>5 极强</td><td>3 一般</td><td>5 极高</td><td>低</td></tr><tr><td>NativeScript</td><td>3 中等</td><td>4 强</td><td>5 极强</td><td>3 一般</td><td>4 高</td><td>中</td></tr><tr><td>Electron</td><td>2 大/慢</td><td>3 中等</td><td>3 一般</td><td>5 极强</td><td>5 极高</td><td>低</td></tr><tr><td>Qt Quick</td><td>3 中等</td><td>5 极强</td><td>3 一般</td><td>5 极强</td><td>3 中等</td><td>低</td></tr><tr><td>.NET MAUI</td><td>3 中等</td><td>4 强</td><td>5 极强</td><td>3 一般</td><td>4 高</td><td>低</td></tr><tr><td>Uno Platform</td><td>3 中等</td><td>4 强</td><td>4 强</td><td>4 强</td><td>4 高</td><td>中</td></tr><tr><td>Tauri</td><td>5 小/快</td><td>4 强</td><td>3 一般</td><td>4 强</td><td>4 高</td><td>中</td></tr><tr><td>Wails</td><td>4 小/快</td><td>4 强</td><td>3 一般</td><td>4 强</td><td>5 极高</td><td>中</td></tr><tr><td>KMP</td><td>视UI方案</td><td>视UI方案</td><td>5 极强</td><td>3 一般</td><td>4 高</td><td>中</td></tr><tr><td>Lynx</td><td>4 小/快</td><td>5 极强</td><td>3 一般</td><td>5 极强</td><td>4 高</td><td>高</td></tr><tr><td>Valdi</td><td>4 小/快</td><td>5 极强</td><td>5 极强</td><td>3 一般</td><td>3 中等</td><td>高</td></tr><tr><td>Electrobun</td><td>4 小/快</td><td>3 中等</td><td>3 一般</td><td>4 强</td><td>4 高</td><td>高</td></tr><tr><td>Dioxus</td><td>4 小/快</td><td>5 极强</td><td>3 一般</td><td>4 强</td><td>4 高</td><td>高</td></tr><tr><td>Slint</td><td>5 小/快</td><td>4 强</td><td>3 一般</td><td>5 极强</td><td>3 中等</td><td>中</td></tr><tr><td>GPUI</td><td>4 小/快</td><td>5 极强</td><td>3 一般</td><td>3 一般</td><td>3 中等</td><td>高</td></tr></tbody></table>
<p><strong>指标说明</strong>：</p>
<ul>
<li><strong>包体/启动</strong>：应用包大小和启动速度（5=最小最快，1=最大最慢）</li>
<li><strong>性能上限</strong>：复杂动效、大数据量场景的表现潜力（5=极限性能，1=性能受限）</li>
<li><strong>原生体验</strong>：与系统控件的融合程度（5=完全原生，1=明显非原生）</li>
<li><strong>跨端一致</strong>：不同平台上 UI 的统一程度（5=完全一致，1=差异大）</li>
<li><strong>开发效率</strong>：上手速度、调试体验、工具链成熟度（5=极高，1=很低）</li>
<li><strong>生产风险</strong>：生态稳定性、长期维护的不确定性（低/中/高）</li>
</ul>
<hr/>
<h2 data-id="heading-27">第四章：场景化选型指南</h2>
<h3 data-id="heading-28">快速决策表</h3>
<p><strong>不想看详细分析？根据你的情况直接查表：</strong></p>
<h4 data-id="heading-29">按技术栈选择</h4>



























































<table><thead><tr><th>你的技术栈</th><th>首选</th><th>备选</th><th>理由</th></tr></thead><tbody><tr><td>React</td><td>React Native</td><td>Lynx</td><td>复用 React 技能</td></tr><tr><td>Vue/Angular</td><td>NativeScript</td><td>Flutter</td><td>直接用 Vue/Angular</td></tr><tr><td>Go</td><td><strong>Wails</strong></td><td>-</td><td>唯一的 Go 桌面方案</td></tr><tr><td>Rust（有前端）</td><td>Tauri</td><td>Dioxus</td><td>前后端分离</td></tr><tr><td>Rust（纯 Rust）</td><td><strong>Dioxus</strong></td><td>GPUI</td><td>React-like 语法</td></tr><tr><td>C#</td><td>.NET MAUI</td><td>Uno Platform</td><td>微软生态</td></tr><tr><td>C++</td><td>Qt</td><td>Slint</td><td>工业级/嵌入式</td></tr><tr><td>Kotlin</td><td>KMP</td><td>Flutter</td><td>Android 团队扩展</td></tr></tbody></table>
<h4 data-id="heading-30">按需求选择</h4>













































<table><thead><tr><th>你的需求</th><th>推荐框架</th><th>原因</th></tr></thead><tbody><tr><td>极致跨端一致性</td><td>Flutter, Qt</td><td>自绘渲染</td></tr><tr><td>极小包体（&lt; 5MB）</td><td>Tauri, Slint</td><td>系统 WebView/轻量</td></tr><tr><td>原生体验优先</td><td>React Native, .NET MAUI</td><td>原生控件</td></tr><tr><td>嵌入式设备</td><td>Slint, Qt</td><td>资源占用低</td></tr><tr><td>需要 WebAssembly</td><td>Uno Platform, Dioxus</td><td>浏览器运行</td></tr><tr><td>需要终端 UI（TUI）</td><td>Dioxus</td><td>独特优势</td></tr><tr><td>快速原型</td><td>Electron, Flutter</td><td>工具链成熟</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-31">场景 A：移动端为主，重动效、品牌视觉统一</h3>
<blockquote>
<p>典型产品：电商首页、社交 feed、游戏化应用</p>
</blockquote>
<p><strong>推荐</strong>：Flutter / Lynx</p>
<p><strong>理由</strong>：</p>
<ul>
<li>自绘渲染保证跨端一致性</li>
<li>动效性能有保障</li>
<li>Flutter 生态成熟，Lynx 性能更极致（但风险更高）</li>
</ul>
<p><strong>备选</strong>：Qt Quick（如果团队熟悉 C++）</p>
<hr/>
<h3 data-id="heading-32">场景 B：桌面应用（按技术栈）</h3>









































<table><thead><tr><th>团队技术栈</th><th>首选方案</th><th>优势</th><th>典型产品</th></tr></thead><tbody><tr><td><strong>纯前端团队</strong></td><td>Electron</td><td>生态最成熟，工具链完善</td><td>VS Code, Slack</td></tr><tr><td><strong>前端 + 在意包体</strong></td><td>Tauri</td><td>包体小（3MB），启动快</td><td>系统工具</td></tr><tr><td><strong>Go 后端团队</strong></td><td><strong>Wails</strong></td><td>无需学 Rust，类型安全</td><td>运维面板，数据处理</td></tr><tr><td><strong>Rust 团队</strong></td><td>Tauri</td><td>安全性高，插件生态好</td><td>开发工具</td></tr><tr><td><strong>想尝新</strong></td><td>Electrobun</td><td>Bun 运行时，TS 全栈</td><td>原型项目</td></tr></tbody></table>
<p><strong>快速决策</strong>：</p>
<ul>
<li>求稳定 → Electron</li>
<li>要轻量 → Tauri</li>
<li>用 Go → Wails</li>
<li>学 Rust → Tauri</li>
</ul>
<hr/>
<h3 data-id="heading-33">场景 C：企业内部应用，C# 团队，长期维护</h3>
<blockquote>
<p>典型产品：ERP、CRM、内部审批系统</p>
</blockquote>
<p><strong>推荐</strong>：.NET MAUI</p>
<p><strong>理由</strong>：</p>
<ul>
<li>与微软生态（Azure、Office 365）集成好</li>
<li>C# 企业级开发经验可复用</li>
<li>长期维护有保障（微软背书）</li>
</ul>
<p><strong>备选</strong>：Qt（如果需要嵌入式支持）/ Electron（如果有 Web 版需求）</p>
<hr/>
<h3 data-id="heading-34">场景 D：Android 团队扩展 iOS</h3>
<blockquote>
<p>典型产品：已有 Android 应用，想扩展到 iOS</p>
</blockquote>
<p><strong>推荐</strong>：KMP（逻辑共享 + 原生 UI）</p>
<p><strong>理由</strong>：</p>
<ul>
<li>Kotlin 语言统一，学习成本低</li>
<li>可以渐进式迁移，风险可控</li>
<li>各平台 UI 保持原生体验</li>
</ul>
<p><strong>进阶</strong>：如果想共享部分 UI → KMP + Compose Multiplatform</p>
<hr/>
<h3 data-id="heading-35">场景 E：需要深度系统集成</h3>
<blockquote>
<p>典型产品：文件管理器、系统工具、相机应用</p>
</blockquote>
<p><strong>推荐</strong>：React Native / KMP（原生 UI）</p>
<p><strong>理由</strong>：</p>
<ul>
<li>原生控件映射，系统 API 调用方便</li>
<li>无障碍支持天然继承</li>
<li>可以针对各平台做深度优化</li>
</ul>
<p><strong>备选</strong>：.NET MAUI、纯原生</p>
<hr/>
<h3 data-id="heading-36">场景 F：极度关注包体大小</h3>
<blockquote>
<p>典型产品：Lite 版应用、下沉市场、低端设备</p>
</blockquote>
<p><strong>推荐</strong>：Tauri（桌面）/ Valdi（移动）</p>
<p><strong>理由</strong>：</p>
<ul>
<li>Tauri 空项目约 3MB</li>
<li>Valdi 编译到原生，无运行时开销</li>
</ul>
<p><strong>备选</strong>：KMP + 原生 UI</p>
<hr/>
<h3 data-id="heading-37">场景 G：全平台覆盖（移动 + 桌面 + Web）</h3>
<blockquote>
<p>典型产品：跨平台协作工具、内容消费应用</p>
</blockquote>
<p><strong>推荐</strong>：Flutter</p>
<p><strong>理由</strong>：</p>
<ul>
<li>唯一真正"一套代码，全平台运行"的成熟方案</li>
<li>移动、桌面、Web 体验一致</li>
</ul>
<p><strong>备选</strong>：Qt（工业场景）、各平台分别开发</p>
<hr/>
<h3 data-id="heading-38">场景 H：Rust 技术栈做桌面应用</h3>
<blockquote>
<p>典型产品：开发工具、性能敏感型应用</p>
</blockquote>
<p><strong>推荐</strong>：</p>
<ul>
<li><strong>需要 Web 前端</strong>：Tauri</li>
<li><strong>需要 Web + 桌面共享代码</strong>：Dioxus</li>
<li><strong>纯 Rust，极致性能</strong>：GPUI</li>
</ul>
<p><strong>理由</strong>：</p>
<ul>
<li>Tauri：前后端分离，前端用熟悉的 Web 技术栈</li>
<li>Dioxus：React-like 语法，前端转 Rust 易上手，支持 WASM</li>
<li>GPUI：为代码编辑器设计，性能极致但学习曲线陡</li>
</ul>
<p><strong>选择建议</strong>：</p>
<ul>
<li>团队有前端，后端用 Rust → Tauri</li>
<li>想要纯 Rust 技术栈，喜欢 React → Dioxus</li>
<li>追求极致性能（如编辑器）→ GPUI</li>
</ul>
<hr/>
<h3 data-id="heading-39">场景 I：嵌入式设备 GUI</h3>
<blockquote>
<p>典型产品：智能家居面板、车载 HMI、工业控制、医疗设备</p>
</blockquote>
<p><strong>推荐</strong>：Slint（首选）/ Qt（工业级）</p>
<p><strong>理由</strong>：</p>
<ul>
<li>Slint：轻量（&lt; 300KB），支持软件渲染，适合低端 MCU</li>
<li>Qt：功能强大，工业案例丰富，但包体大、需商业授权</li>
</ul>
<p><strong>选择建议</strong>：</p>
<ul>
<li>资源极度受限（RAM &lt; 50MB）→ Slint</li>
<li>需要丰富组件库，工业级项目 → Qt</li>
<li>原型验证、Rust 技术栈 → Slint</li>
</ul>
<hr/>
<h3 data-id="heading-40">场景 J：Vue/Angular 团队做移动应用</h3>
<blockquote>
<p>典型产品：企业内部应用、内容展示应用</p>
</blockquote>
<p><strong>推荐</strong>：NativeScript</p>
<p><strong>理由</strong>：</p>
<ul>
<li>直接用 Vue 或 Angular 写原生应用</li>
<li>无需学 React（如果用 React Native 需要学 React）</li>
<li>直接访问原生 API，无桥接层</li>
</ul>
<p><strong>备选</strong>：Flutter（如果愿意学 Dart）</p>
<hr/>
<h3 data-id="heading-41">场景 K：C# 团队，需要 WebAssembly</h3>
<blockquote>
<p>典型产品：需要 Web 版的企业应用、渐进式 Web 应用</p>
</blockquote>
<p><strong>推荐</strong>：Uno Platform</p>
<p><strong>理由</strong>：</p>
<ul>
<li>同时支持原生平台和 WebAssembly</li>
<li>一套代码可以跑在浏览器里</li>
<li>WinUI 语法，Windows 应用迁移方便</li>
</ul>
<p><strong>备选</strong>：Blazor WebAssembly（纯 Web）+ .NET MAUI（原生）</p>
<hr/>
<h2 data-id="heading-42">第五章：选型方法论</h2>
<h3 data-id="heading-43">5.1 三步选型法</h3>
<pre><code class="hljs language-markdown" lang="markdown">Step 1: 确定渲染路线
<span class="hljs-code">    │
    ├── 需要跨端视觉完全一致 → 自绘渲染（Flutter/Lynx/Qt）
    ├── 需要原生体验优先 → 原生映射（RN/MAUI/KMP）
    └── 需要快速上线、前端技术栈 → WebView（Electron/Tauri）
</span>
Step 2: 确定平台覆盖
<span class="hljs-code">    │
    ├── 移动端为主 → Flutter/RN/Lynx/KMP
    ├── 桌面端为主 → Electron/Tauri/Qt/GPUI
    └── 全平台 → Flutter/Qt
</span>
Step 3: 匹配团队技能
<span class="hljs-code">    │
    ├── Dart → Flutter
    ├── JS/TS + React → React Native / Lynx / Dioxus（想学 Rust）
    ├── JS/TS + Vue/Angular → NativeScript
    ├── JS/TS + 任意框架 → Electron / Tauri / Wails / Electrobun
    ├── C# → .NET MAUI / Uno Platform（需要 WASM）
    ├── C++ → Qt / Slint（嵌入式）
    ├── Go → Wails
    ├── Kotlin → KMP
    └── Rust → Tauri（Web前端） / Dioxus（全栈） / GPUI（纯Rust） / Slint（嵌入式）
</span></code></pre>
<h3 data-id="heading-44">5.2 决策检查清单</h3>
<p>在最终决定前，问自己这些问题：</p>
<p><strong>基础问题</strong>：</p>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 团队对目标语言的熟悉程度如何？（Dart/JS/TS/C#/C++/Go/Kotlin/Rust）</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 是否有时间预算来学习新技术？</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 对包体大小和启动速度的要求有多高？</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 是否需要与系统功能深度集成？</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 是否需要跨端 UI 完全一致？</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 项目周期是多长？是否允许使用新兴框架？</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 团队规模如何？是否需要大量第三方库支持？</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 未来是否需要扩展到更多平台？</li>
</ul>
<p><strong>新增考虑点</strong>（针对新框架）：</p>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 是否是 Go 技术栈？考虑 Wails</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 是否需要 WebAssembly 支持？考虑 Uno Platform / Dioxus</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 是否是 Vue/Angular 技术栈？考虑 NativeScript</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 是否是嵌入式设备（RAM &lt; 50MB）？考虑 Slint</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 是否想用 Rust 写全栈（包括 UI）？考虑 Dioxus</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 是否需要终端 UI（TUI）？考虑 Dioxus</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> 是否追求极致性能（如代码编辑器）？考虑 GPUI</li>
</ul>
<hr/>
<h2 data-id="heading-45">第六章：趋势观察</h2>
<h3 data-id="heading-46">6.1 当前格局（2026 更新）</h3>
<p><strong>成熟稳定层</strong>（生产环境可放心使用）：</p>
<ul>
<li><strong>移动端</strong>：Flutter、React Native</li>
<li><strong>桌面端</strong>：Electron、Qt</li>
<li><strong>C# 生态</strong>：.NET MAUI、Uno Platform</li>
<li><strong>逻辑共享</strong>：KMP</li>
</ul>
<p><strong>快速上升层</strong>（已有成功案例，值得认真考虑）：</p>
<ul>
<li><strong>轻量桌面</strong>：Tauri、Wails</li>
<li><strong>新兴移动</strong>：Lynx（字节跳动背书）</li>
<li><strong>Rust 全栈</strong>：Dioxus（社区活跃）</li>
</ul>
<p><strong>新锐探索层</strong>（有潜力，需承担早期风险）：</p>
<ul>
<li><strong>桌面端</strong>：Electrobun、GPUI</li>
<li><strong>移动端</strong>：Valdi</li>
<li><strong>嵌入式</strong>：Slint</li>
</ul>
<h3 data-id="heading-47">6.2 趋势预判</h3>
<ol>
<li>
<p><strong>自绘渲染持续演进</strong></p>
<ul>
<li>Flutter 的 Impeller 引擎带来更好的 iOS 性能</li>
<li>Dioxus、Slint 等新框架证明自绘渲染仍有创新空间</li>
<li>GPU 加速成为标配</li>
</ul>
</li>
<li>
<p><strong>Rust 生态全面爆发</strong>（重要趋势）</p>
<ul>
<li><strong>桌面端</strong>：Tauri（轻量）、Dioxus（全栈）、GPUI（性能）、Slint（嵌入式）</li>
<li>Rust 已经形成完整的 GUI 生态矩阵</li>
<li>WebAssembly + Rust 成为 Web 高性能方案</li>
<li>预测：2026-2027 会有更多 Rust GUI 框架成熟</li>
</ul>
</li>
<li>
<p><strong>WebView 方案的"语言多样化"</strong></p>
<ul>
<li><strong>传统</strong>：Electron（Node.js）</li>
<li><strong>新势力</strong>：Tauri（Rust）、Wails（Go）、Electrobun（Bun）</li>
<li>趋势：每个后端语言都会有自己的 WebView 方案</li>
<li>Go、Rust、Bun 的学习曲线比 Node.js 低（或类型更安全）</li>
</ul>
</li>
<li>
<p><strong>逻辑共享成为共识</strong></p>
<ul>
<li>即使 UI 不共享，业务逻辑共享也成为趋势</li>
<li>KMP 模式证明了渐进式迁移的可行性</li>
<li>Dioxus 的多渲染后端也是类似思路</li>
</ul>
</li>
<li>
<p><strong>WebAssembly 的崛起</strong></p>
<ul>
<li>Uno Platform 证明了 C# + WASM 的可行性</li>
<li>Dioxus 的 WASM 性能接近原生</li>
<li>预测：更多框架会支持 WASM 作为部署目标</li>
</ul>
</li>
<li>
<p><strong>类型安全成为标配</strong></p>
<ul>
<li>Wails 的自动生成 TypeScript 类型</li>
<li>Dioxus 的 Rust 类型安全</li>
<li>Slint 的多语言类型绑定</li>
<li>趋势：前后端通信的类型不匹配会成为历史</li>
</ul>
</li>
<li>
<p><strong>前端框架语法的多样化</strong></p>
<ul>
<li>不再是"React 一家独大"</li>
<li>NativeScript 支持 Vue/Angular</li>
<li>Dioxus 带来 Rust + React-like 语法</li>
<li>趋势：每个前端生态都能找到对应的跨平台方案</li>
</ul>
</li>
<li>
<p><strong>嵌入式 GUI 的轻量化</strong></p>
<ul>
<li>Slint 证明了 Qt 不是嵌入式唯一选择</li>
<li>软件渲染 + 极致优化可以跑在 MCU 上</li>
<li>趋势：智能家居、车载等场景会有更多轻量方案</li>
</ul>
</li>
</ol>
<hr/>
<h2 data-id="heading-48">总结</h2>
<p>选框架不是选"最好的"，而是选"最适合的"。</p>
<p><strong>如果你只记住一件事</strong>，那就是：</p>
<blockquote>
<p>先想清楚你的核心诉求是什么——跨端一致性、原生体验、还是开发效率？然后在对应的技术路线里，选一个匹配团队技能的框架。</p>
</blockquote>
<p><strong>2026 关键变化总结</strong>：</p>



































<table><thead><tr><th>变化</th><th>具体表现</th><th>影响</th></tr></thead><tbody><tr><td><strong>1. 桌面方案多元化</strong></td><td>Electron/Tauri/Wails/Electrobun</td><td>每个后端语言都有选择</td></tr><tr><td><strong>2. Rust GUI 成熟</strong></td><td>Tauri/Dioxus/Slint/GPUI</td><td>覆盖全场景</td></tr><tr><td><strong>3. 前端多样化</strong></td><td>React/Vue/Angular 都有方案</td><td>不再是 React 独大</td></tr><tr><td><strong>4. WASM 普及</strong></td><td>Uno/Dioxus 支持</td><td>浏览器运行原生性能</td></tr><tr><td><strong>5. 嵌入式轻量化</strong></td><td>Slint 挑战 Qt</td><td>低端设备新选择</td></tr></tbody></table>
<p><strong>选型建议（按风险偏好）</strong>：</p>
<pre><code class="hljs language-bash" lang="bash">稳妥派（生产环境）
├─ 移动端：Flutter, React Native
├─ 桌面端：Electron, Qt
└─ C<span class="hljs-comment"># 生态：.NET MAUI, Uno Platform</span>

平衡派（值得尝试）
├─ Go 桌面：Wails
├─ Rust 全栈：Dioxus
└─ 逻辑共享：KMP

激进派（原型/小项目）
├─ Lynx, Valdi（移动端新思路）
├─ Electrobun（桌面 Bun 方案）
└─ Slint（嵌入式轻量）
</code></pre>
<p>祝选型顺利！</p>
<hr/>
<h2 data-id="heading-49">参考资源</h2>
<h3 data-id="heading-50">官方文档</h3>
<p><strong>成熟框架</strong>：</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.flutter.dev%2F" target="_blank" title="https://docs.flutter.dev/" ref="nofollow noopener noreferrer">Flutter</a> | <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.flutter.dev%2Freference%2Fsupported-platforms" target="_blank" title="https://docs.flutter.dev/reference/supported-platforms" ref="nofollow noopener noreferrer">支持的平台</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Freactnative.dev%2F" target="_blank" title="https://reactnative.dev/" ref="nofollow noopener noreferrer">React Native</a> | <a href="https://link.juejin.cn?target=https%3A%2F%2Freactnative.dev%2Fdocs%2Fthe-new-architecture%2Flanding-page" target="_blank" title="https://reactnative.dev/docs/the-new-architecture/landing-page" ref="nofollow noopener noreferrer">新架构</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.nativescript.org%2F" target="_blank" title="https://docs.nativescript.org/" ref="nofollow noopener noreferrer">NativeScript</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.electronjs.org%2F" target="_blank" title="https://www.electronjs.org/" ref="nofollow noopener noreferrer">Electron</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdoc.qt.io%2F" target="_blank" title="https://doc.qt.io/" ref="nofollow noopener noreferrer">Qt</a> | <a href="https://link.juejin.cn?target=https%3A%2F%2Fdoc.qt.io%2Fqt-6%2Fsupported-platforms.html" target="_blank" title="https://doc.qt.io/qt-6/supported-platforms.html" ref="nofollow noopener noreferrer">支持的平台</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdotnet.microsoft.com%2Fapps%2Fmaui" target="_blank" title="https://dotnet.microsoft.com/apps/maui" ref="nofollow noopener noreferrer">.NET MAUI</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.uno%2F" target="_blank" title="https://platform.uno/" ref="nofollow noopener noreferrer">Uno Platform</a> | <a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.uno%2Fdocs%2Farticles%2Fgetting-started-with-wasm.html" target="_blank" title="https://platform.uno/docs/articles/getting-started-with-wasm.html" ref="nofollow noopener noreferrer">WebAssembly</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftauri.app%2F" target="_blank" title="https://tauri.app/" ref="nofollow noopener noreferrer">Tauri</a> | <a href="https://link.juejin.cn?target=https%3A%2F%2Fv2.tauri.app%2Freference%2Fwebview-versions%2F" target="_blank" title="https://v2.tauri.app/reference/webview-versions/" ref="nofollow noopener noreferrer">WebView 版本</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fkotlinlang.org%2Fdocs%2Fmultiplatform.html" target="_blank" title="https://kotlinlang.org/docs/multiplatform.html" ref="nofollow noopener noreferrer">Kotlin Multiplatform</a></li>
</ul>
<p><strong>新兴框架</strong>：</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwails.io%2F" target="_blank" title="https://wails.io/" ref="nofollow noopener noreferrer">Wails</a> | <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fwailsapp%2Fwails" target="_blank" title="https://github.com/wailsapp/wails" ref="nofollow noopener noreferrer">GitHub</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdioxuslabs.com%2F" target="_blank" title="https://dioxuslabs.com/" ref="nofollow noopener noreferrer">Dioxus</a> | <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FDioxusLabs%2Fdioxus" target="_blank" title="https://github.com/DioxusLabs/dioxus" ref="nofollow noopener noreferrer">GitHub</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fslint.dev%2F" target="_blank" title="https://slint.dev/" ref="nofollow noopener noreferrer">Slint</a> | <a href="https://link.juejin.cn?target=https%3A%2F%2Fslint.dev%2Fdocs%2Fembedded" target="_blank" title="https://slint.dev/docs/embedded" ref="nofollow noopener noreferrer">嵌入式指南</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Flynxjs.org%2F" target="_blank" title="https://lynxjs.org/" ref="nofollow noopener noreferrer">Lynx</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSnapchat%2FValdi" target="_blank" title="https://github.com/Snapchat/Valdi" ref="nofollow noopener noreferrer">Valdi</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Felectrobun.dev%2F" target="_blank" title="https://electrobun.dev/" ref="nofollow noopener noreferrer">Electrobun</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.gpui.rs%2F" target="_blank" title="https://www.gpui.rs/" ref="nofollow noopener noreferrer">GPUI</a> | <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fzed-industries%2Fzed" target="_blank" title="https://github.com/zed-industries/zed" ref="nofollow noopener noreferrer">GitHub</a></li>
</ul>
<h3 data-id="heading-51">延伸阅读</h3>
<p><strong>对比文章</strong>：</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.flutter.dev%2Fresources%2Ffaq%23how-does-flutter-compare-to-react-native" target="_blank" title="https://docs.flutter.dev/resources/faq#how-does-flutter-compare-to-react-native" ref="nofollow noopener noreferrer">Flutter vs React Native 2026 深度对比</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftauri.app%2Fv1%2Fguides%2Fgetting-started%2Fprerequisites%2F" target="_blank" title="https://tauri.app/v1/guides/getting-started/prerequisites/" ref="nofollow noopener noreferrer">Tauri vs Electron vs Wails：该选哪个？</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.areweguiyet.com%2F" target="_blank" title="https://www.areweguiyet.com/" ref="nofollow noopener noreferrer">Rust GUI 框架全景对比</a></li>
</ul>
<p><strong>生产实践案例</strong>：</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fnetflixtechblog.com%2Fnetflix-android-and-ios-studio-apps-kotlin-multiplatform-d6d4d8d25d23" target="_blank" title="https://netflixtechblog.com/netflix-android-and-ios-studio-apps-kotlin-multiplatform-d6d4d8d25d23" ref="nofollow noopener noreferrer">KMP 生产实践：Netflix 案例</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flocalsend%2Flocalsend" target="_blank" title="https://github.com/localsend/localsend" ref="nofollow noopener noreferrer">Wails 真实案例：LocalSend</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdioxuslabs.com%2Fblog%2Frelease-050%2F" target="_blank" title="https://dioxuslabs.com/blog/release-050/" ref="nofollow noopener noreferrer">Dioxus 构建全栈应用</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.uno%2Fblog%2F" target="_blank" title="https://platform.uno/blog/" ref="nofollow noopener noreferrer">Uno Platform：跨平台开发最佳实践</a></li>
</ul>
<p><strong>技术深度解析</strong>：</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwails.io%2Fdocs%2Fguides%2Ftypescript" target="_blank" title="https://wails.io/docs/guides/typescript" ref="nofollow noopener noreferrer">Wails 的类型安全绑定原理</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdioxuslabs.com%2Fblog%2Fintroducing-dioxus%2F" target="_blank" title="https://dioxuslabs.com/blog/introducing-dioxus/" ref="nofollow noopener noreferrer">Dioxus 的多渲染后端架构</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fslint.dev%2Fblog%2Fsoftware-renderer" target="_blank" title="https://slint.dev/blog/software-renderer" ref="nofollow noopener noreferrer">Slint 的软件渲染优化</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Frustwasm.github.io%2Fbook%2F" target="_blank" title="https://rustwasm.github.io/book/" ref="nofollow noopener noreferrer">Rust WebAssembly 性能优化指南</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SwiftUI快速入门指南-Viewbuilder篇]]></title>    <link>https://juejin.cn/post/7602133286643269682</link>    <guid>https://juejin.cn/post/7602133286643269682</guid>    <pubDate>2026-02-02T12:44:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602133286643269682" data-draft-id="7602072073134637083" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SwiftUI快速入门指南-Viewbuilder篇"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-02-02T12:44:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="xiAo_Ju"/> <meta itemprop="url" content="https://juejin.cn/user/3966693681926029"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SwiftUI快速入门指南-Viewbuilder篇
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3966693681926029/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    xiAo_Ju
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T12:44:07.000Z" title="Mon Feb 02 2026 12:44:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">背景</h2>
<p>本文帮助有Swift基础的同学，快速入门SwiftUI，基于cursour整理</p>
<p>主要分为四个部分：</p>
<ul>
<li><a href="https://juejin.cn/post/7576489970760695814" target="_blank" title="https://juejin.cn/post/7576489970760695814">关键字</a></li>
<li><a href="https://juejin.cn/post/7576477434733314054" target="_blank" title="https://juejin.cn/post/7576477434733314054">Modifier</a></li>
<li>布局</li>
<li><strong>Viewbuilder</strong></li>
</ul>
<h4 data-id="heading-1">@ViewBuilder</h4>
<p><code>@ViewBuilder</code> 是一个函数构建器（result builder），让你可以在闭包里写多行视图语句，最终合成为一个 View</p>
<p>没有它，你只能返回一个视图；有了它，你可以：</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-meta">@ViewBuilder</span>
<span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
    <span class="hljs-type">Text</span>(<span class="hljs-string">"A"</span>)
    <span class="hljs-type">Text</span>(<span class="hljs-string">"B"</span>)
}
</code></pre>
<h4 data-id="heading-2">它解决了什么问题</h4>
<ul>
<li>简化条件分支：允许 if/else 直接写在 body 里</li>
</ul>

<ul>
<li>组合多个子视图：不用手动包一层 VStack 或 Group</li>
</ul>

<ul>
<li>让 DSL 更像声明式 UI</li>
</ul>
<h4 data-id="heading-3">它是怎么工作的（简化理解）</h4>
<p>@ViewBuilder 会把闭包里的多行语句编译成：</p>
<ul>
<li>1 个视图 → 直接返回</li>
</ul>

<ul>
<li>2~10 个视图 → 组合成 TupleView</li>
</ul>

<ul>
<li>超过 10 个 → 需要你自己包一层容器（比如 VStack）</li>
</ul>
<h4 data-id="heading-4">常见用法</h4>
<p>1) 在 body 中</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {
    <span class="hljs-keyword">if</span> isLogin {
        <span class="hljs-type">Text</span>(<span class="hljs-string">"已登录"</span>)
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-type">Text</span>(<span class="hljs-string">"未登录"</span>)
    }
}
</code></pre>
<p>2) 自定义组件接收视图闭包</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Card</span>&lt;<span class="hljs-title class_">Content</span>: <span class="hljs-title class_">View</span>&gt;: <span class="hljs-title class_">View</span> {
    <span class="hljs-keyword">let</span> content: <span class="hljs-type">Content</span>
    <span class="hljs-keyword">init</span>(<span class="hljs-meta">@ViewBuilder</span> <span class="hljs-params">content</span>: () -&gt; <span class="hljs-type">Content</span>) {
        <span class="hljs-keyword">self</span>.content <span class="hljs-operator">=</span> content()
    }
    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> { content }
}
</code></pre>
<h4 data-id="heading-5">常见坑</h4>
<ul>
<li>不是所有地方都有 @ViewBuilder：比如 Button 的 action 闭包就不是，它只接受一段逻辑代码</li>
</ul>

<ul>
<li>返回类型必须一致：if/else 的两边要返回同一种 View（SwiftUI 会帮你通过 AnyView 或 Group 解决，但要理解这个限制）</li>
</ul>

<ul>
<li>性能影响：AnyView 会抹掉类型信息，尽量少用</li>
</ul>
<h3 data-id="heading-6">@ViewBuilder使用时机</h3>
<h5 data-id="heading-7">应该用 @ViewBuilder</h5>
<ul>
<li>需要返回多视图：一个 API 想让调用方传入多行视图（比如自定义容器/组件）</li>
</ul>

<ul>
<li>需要在闭包里写 if/else 或 switch：让调用方写条件视图更自然</li>
</ul>

<ul>
<li>自定义 DSL：你在做类似 HStack { ... } 这种声明式结构</li>
</ul>
<p>典型场景</p>
<ul>
<li>组件初始化器参数接收视图闭包：</li>
</ul>
<pre><code class="hljs language-less" lang="less">  <span class="hljs-selector-tag">init</span>(<span class="hljs-variable">@ViewBuilder</span> <span class="hljs-attribute">content</span>: () -&gt; Content) { ... }
</code></pre>
<ul>
<li>组件内部某个函数返回 View</li>
</ul>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-meta">@ViewBuilder</span>
  <span class="hljs-keyword">func</span> <span class="hljs-title function_">header</span>() -&gt; <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> { <span class="hljs-operator">...</span> }
</code></pre>
<h5 data-id="heading-8">不该用 @ViewBuilder</h5>
<ul>
<li>闭包不是返回 View 的：比如 Button(action:)、onTapGesture 这种逻辑闭包</li>
</ul>

<ul>
<li>只需要一个 View：没必要增加编译器负担</li>
</ul>

<ul>
<li>会导致类型被抹掉：如果你因此被迫用 AnyView，要谨慎</li>
</ul>

<ul>
<li>性能敏感的热点视图：大量分支+AnyView 会增加 diff 开销</li>
</ul>
<p>典型场景</p>
<ul>
<li>事件处理闭包（逻辑，不是视图）</li>
</ul>

<ul>
<li>简单组件：var body: some View { Text("Hello") } 不需要额外标注</li>
</ul>
<h3 data-id="heading-9">快速判断口诀</h3>
<blockquote>
<p> “闭包里有多行视图或条件视图，就用；纯逻辑或单一视图，就不用。</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Kiro 与 Cursor 使用对比：AI 编程助手的深度体验]]></title>    <link>https://juejin.cn/post/7601904641070153780</link>    <guid>https://juejin.cn/post/7601904641070153780</guid>    <pubDate>2026-02-02T12:54:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601904641070153780" data-draft-id="7602073088428572687" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Kiro 与 Cursor 使用对比：AI 编程助手的深度体验"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2026-02-02T12:54:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="夕颜111"/> <meta itemprop="url" content="https://juejin.cn/user/3079049469504696"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Kiro 与 Cursor 使用对比：AI 编程助手的深度体验
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3079049469504696/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    夕颜111
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T12:54:31.000Z" title="Mon Feb 02 2026 12:54:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读9分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"/>
<h3 data-id="heading-1">1. 写在最前面</h3>
<p>最近 AI 编程工具越来越火，作为一个每天都要写代码的开发者，笔者一直在寻找能真正提升开发效率的工具。Cursor 作为市场上的明星产品，笔者已经用了好几个月，最近又接触到了 Kiro 这款新兴的 AI IDE，两者都号称能让开发效率翻倍，但实际体验下来，它们的设计理念和使用场景还是有不少差异的。</p>
<p>周末闲来无事，正好把这段时间使用两款工具的心得整理一下，希望能帮助大家选择更适合自己的 AI 编程助手。</p>
<h3 data-id="heading-2">2. 产品定位对比</h3>
<h4 data-id="heading-3">2.1 Cursor：AI-First 的代码编辑器</h4>
<p>Cursor 本质上是基于 VS Code 深度定制的编辑器，它的核心理念是"AI-First"，将 AI 能力深度集成到编辑器的每个角落。从产品定位来看，Cursor 更像是一个"会写代码的编辑器"。</p>
<p><strong>核心特点：</strong></p>
<ul>
<li>基于 VS Code，继承了完整的插件生态</li>
<li>强大的代码补全和生成能力</li>
<li>Composer 模式支持多文件编辑</li>
<li>Tab 键自动补全体验流畅</li>
</ul>
<h4 data-id="heading-4">2.2 Kiro：自主执行的 AI Agent</h4>
<p>Kiro 的定位则更加激进，它不仅仅是一个编辑器，而是一个"AI Agent IDE"。Kiro 的核心理念是让 AI 成为一个能够自主执行任务的开发伙伴，而不仅仅是代码补全工具。</p>
<p><strong>核心特点：</strong></p>
<ul>
<li>自主执行模式（Autopilot）和监督模式（Supervised）</li>
<li>Spec 驱动开发（需求 → 设计 → 任务 → 实现）</li>
<li>Agent Hooks 自动化工作流</li>
<li>MCP（Model Context Protocol）集成</li>
<li>Steering 规则系统</li>
</ul>
<h3 data-id="heading-5">3. 核心功能对比</h3>
<h4 data-id="heading-6">3.1 代码补全与生成</h4>



































<table><thead><tr><th>特性维度</th><th>Cursor</th><th>Kiro</th></tr></thead><tbody><tr><td><strong>行内补全</strong></td><td>⭐⭐⭐⭐⭐ Tab 键补全非常流畅</td><td>⭐⭐⭐ 支持但不是核心功能</td></tr><tr><td><strong>多行补全</strong></td><td>⭐⭐⭐⭐⭐ 智能预测多行代码</td><td>⭐⭐⭐ 通过 Chat 实现</td></tr><tr><td><strong>多文件编辑</strong></td><td>⭐⭐⭐⭐ Composer 模式</td><td>⭐⭐⭐⭐⭐ Autopilot 模式更强大</td></tr><tr><td><strong>上下文理解</strong></td><td>⭐⭐⭐⭐ @符号引用文件</td><td>⭐⭐⭐⭐⭐ #符号 + Codebase 索引</td></tr><tr><td><strong>代码重构</strong></td><td>⭐⭐⭐⭐ 需要手动选择代码</td><td>⭐⭐⭐⭐⭐ AI 自主定位和修改</td></tr></tbody></table>
<p><strong>Cursor 的优势：</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Cursor 的 Tab 补全体验非常流畅</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">calculateTotal</span>(<span class="hljs-params">items: Item[]</span>) {
  <span class="hljs-comment">// 按 Tab，AI 自动补全整个函数体</span>
  <span class="hljs-keyword">return</span> items.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> sum + item.<span class="hljs-property">price</span>, <span class="hljs-number">0</span>);
}
</code></pre>
<p><strong>Kiro 的优势：</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">用户：重构 src 目录下所有的 API 调用，统一使用 axios 实例

Kiro：
<span class="hljs-bullet">1.</span> 扫描 src 目录，找到 12 个文件使用了 fetch
<span class="hljs-bullet">2.</span> 创建 axios 实例配置
<span class="hljs-bullet">3.</span> 逐个文件替换 fetch 为 axios
<span class="hljs-bullet">4.</span> 更新类型定义
<span class="hljs-bullet">5.</span> 运行测试验证
</code></pre>
<h4 data-id="heading-7">3.2 自主执行能力</h4>
<p>这是 Kiro 和 Cursor 最大的区别。</p>
<p><strong>Cursor：</strong></p>
<ul>
<li>需要用户明确指定要修改的文件</li>
<li>生成代码后需要用户 Apply</li>
<li>更像是"智能助手"，需要人工引导</li>
</ul>
<p><strong>Kiro：</strong></p>
<ul>
<li>Autopilot 模式下可以自主执行任务</li>
<li>自动定位需要修改的文件</li>
<li>自动运行测试、修复错误</li>
<li>更像是"AI 开发者"，能独立完成任务</li>
</ul>
<p><strong>实际案例对比：</strong></p>
<p>任务：实现用户认证功能</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/484c9649536f4d49b3c6876437d64fc6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSV6aKcMTEx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770641673&amp;x-signature=h1WuXjD8A6wfqDY%2F0n8R9IsSsdM%3D" alt="企业微信截图_cfe60b20-1626-4549-9361-9fd8c8984780.png" loading="lazy"/></p>
<p><strong>对比说明：</strong></p>
<ul>
<li>🔴 红色节点：需要用户手动操作</li>
<li>🟢 绿色节点：自动化完成</li>
<li>Cursor：用户需要 7 次手动干预</li>
<li>Kiro：用户只需 1 次输入，其余全自动</li>
</ul>
<h3 data-id="heading-8">4. 独特功能深度解析</h3>
<h4 data-id="heading-9">4.1 Kiro 的 Spec 驱动开发</h4>
<p>Spec 是 Kiro 最有特色的功能，它将软件开发流程形式化为：</p>
<pre><code class="hljs">需求（Requirements）→ 设计（Design）→ 任务（Tasks）→ 实现（Implementation）
</code></pre>
<p><strong>实际使用体验：</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># 创建 Spec</span>
用户：创建一个用户认证功能的 spec

Kiro：
<span class="hljs-bullet">1.</span> 生成 requirements.md
<span class="hljs-bullet">   -</span> 用户故事
<span class="hljs-bullet">   -</span> 验收标准
<span class="hljs-bullet">   -</span> 非功能性需求

<span class="hljs-bullet">2.</span> 生成 design.md
<span class="hljs-bullet">   -</span> 架构设计
<span class="hljs-bullet">   -</span> API 设计
<span class="hljs-bullet">   -</span> 数据模型
<span class="hljs-bullet">   -</span> 正确性属性（Property-Based Testing）

<span class="hljs-bullet">3.</span> 生成 tasks.md
<span class="hljs-bullet">   -</span> 任务分解
<span class="hljs-bullet">   -</span> 依赖关系
<span class="hljs-bullet">   -</span> 优先级排序

<span class="hljs-bullet">4.</span> 执行任务
<span class="hljs-bullet">   -</span> 逐个完成任务
<span class="hljs-bullet">   -</span> 自动运行测试
<span class="hljs-bullet">   -</span> 更新任务状态
</code></pre>
<p><strong>Spec 的优势：</strong></p>
<ul>
<li>强制思考需求和设计，避免盲目编码</li>
<li>任务分解清晰，进度可追踪</li>
<li>支持增量开发，可以随时暂停和恢复</li>
<li>文档和代码同步更新</li>
</ul>
<p><strong>适用场景：</strong></p>
<ul>
<li>复杂功能开发</li>
<li>团队协作项目</li>
<li>需要详细文档的项目</li>
<li>长期维护的项目</li>
</ul>
<h4 data-id="heading-10">4.2 Kiro 的 Agent Hooks</h4>
<p>Hooks 是 Kiro 的自动化工作流系统，可以在特定事件发生时自动触发 AI 执行任务。</p>
<p><strong>支持的事件类型：</strong></p>
<ul>
<li><code>fileEdited</code>：文件保存时触发</li>
<li><code>fileCreated</code>：文件创建时触发</li>
<li><code>fileDeleted</code>：文件删除时触发</li>
<li><code>promptSubmit</code>：发送消息时触发</li>
<li><code>agentStop</code>：AI 执行完成时触发</li>
<li><code>userTriggered</code>：手动触发</li>
</ul>
<p><strong>实际案例：</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"自动代码检查"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"when"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"fileEdited"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"patterns"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"*.ts"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"*.tsx"</span><span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"then"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"askAgent"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"prompt"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"运行 ESLint 检查当前文件，如果有错误自动修复"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>

<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"提交前测试"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"when"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"promptSubmit"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"then"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"runCommand"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"npm test"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>Hooks 的价值：</strong></p>
<ul>
<li>自动化重复性任务</li>
<li>强制执行代码规范</li>
<li>提高代码质量</li>
<li>减少人为疏忽</li>
</ul>
<blockquote>
<p>注： 感慨一下 hook 还是好，可以少敲不少命令</p>
</blockquote>
<h4 data-id="heading-11">4.3 Kiro 的 Steering 规则</h4>
<p>Steering 是 Kiro 的上下文注入系统，可以为 AI 提供项目特定的知识和规范。</p>
<p><strong>Steering 文件位置：</strong></p>
<pre><code class="hljs language-bash" lang="bash">.kiro/steering/
  ├── coding-standards.md  <span class="hljs-comment"># 编码规范</span>
  ├── api-guidelines.md    <span class="hljs-comment"># API 设计指南</span>
  └── testing-rules.md     <span class="hljs-comment"># 测试规范</span>
</code></pre>
<p><strong>三种包含模式：</strong></p>
<ol>
<li><strong>Always included</strong>（默认）：始终包含在上下文中</li>
<li><strong>Conditional</strong>：当读取特定文件时包含</li>
<li><strong>Manual</strong>：通过 #符号手动引用</li>
</ol>
<p><strong>实际案例：</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">inclusion:</span> <span class="hljs-string">fileMatch</span>
<span class="hljs-attr">fileMatchPattern:</span> <span class="hljs-string">'**/*.test.ts'</span>
<span class="hljs-meta">---</span>
<span class="hljs-comment"># 测试规范</span>
<span class="hljs-comment">## 单元测试</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">使用</span> <span class="hljs-string">Vitest</span> <span class="hljs-string">作为测试框架</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">测试文件命名：*.test.ts</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">每个函数至少一个测试用例</span>
<span class="hljs-comment">## 属性测试</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">使用</span> <span class="hljs-string">fast-check</span> <span class="hljs-string">进行属性测试</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">测试核心业务逻辑</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">注释格式：**Validates:</span> <span class="hljs-string">Requirements</span> <span class="hljs-string">X.Y**</span>
</code></pre>
<p>当 Kiro 读取测试文件时，会自动加载这个 Steering 规则，确保生成的测试代码符合项目规范。</p>
<h4 data-id="heading-12">4.4 Cursor 的 Composer 模式</h4>
<p>Composer 是 Cursor 的多文件编辑模式，可以同时修改多个文件。</p>
<p><strong>使用体验：</strong></p>
<ol>
<li>Cmd+I 打开 Composer</li>
<li>描述需求</li>
<li>Cursor 生成多个文件的修改</li>
<li>预览所有修改</li>
<li>Accept 或 Reject</li>
</ol>
<p><strong>优势：</strong></p>
<ul>
<li>可视化预览所有修改</li>
<li>支持部分接受修改</li>
<li>修改前后对比清晰</li>
</ul>
<p><strong>局限：</strong></p>
<ul>
<li>需要用户明确指定文件范围</li>
<li>不会自动运行测试</li>
<li>不会自动修复错误</li>
</ul>
<h4 data-id="heading-13">4.5 Cursor 的 .cursorrules 文件</h4>
<p>Cursor 支持通过 <code>.cursorrules</code> 文件来定义项目规范，这个文件放在项目根目录，AI 会自动读取并遵循其中的规则。</p>
<p><strong>配置示例：</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># .cursorrules</span>

<span class="hljs-section">## 编码规范</span>
<span class="hljs-bullet">-</span> 使用 TypeScript 严格模式
<span class="hljs-bullet">-</span> 优先使用函数式编程
<span class="hljs-bullet">-</span> 禁止使用 any，使用 unknown

<span class="hljs-section">## API 设计</span>
<span class="hljs-bullet">-</span> RESTful 规范
<span class="hljs-bullet">-</span> 统一错误处理格式

<span class="hljs-section">## 测试规范</span>
<span class="hljs-bullet">-</span> 使用 Vitest
<span class="hljs-bullet">-</span> 测试覆盖率 &gt; 80%
</code></pre>
<p><strong>与 Kiro Steering 的对比：</strong></p>








































<table><thead><tr><th>功能</th><th>Cursor (.cursorrules)</th><th>Kiro (Steering)</th></tr></thead><tbody><tr><td><strong>基本规则定义</strong></td><td>✅ 支持</td><td>✅ 支持</td></tr><tr><td><strong>Always included</strong></td><td>✅ 始终包含（只有这一种模式）</td><td>✅ 支持</td></tr><tr><td><strong>Conditional inclusion</strong></td><td>❌ 不支持</td><td>✅ 支持（fileMatch）</td></tr><tr><td><strong>多文件规则</strong></td><td>❌ 只能一个文件</td><td>✅ 可以多个文件</td></tr><tr><td><strong>手动引用</strong></td><td>⚠️ 通过 @.cursorrules</td><td>✅ 通过 # 符号</td></tr><tr><td><strong>文件匹配模式</strong></td><td>❌ 不支持</td><td>✅ 支持（如 <code>**/*.test.ts</code>）</td></tr></tbody></table>
<p><strong>关键区别：</strong></p>
<p><strong>Cursor 的限制：</strong></p>
<pre><code class="hljs language-diff" lang="diff">.cursorrules (根目录)
<span class="hljs-deletion">- 所有规则都始终包含</span>
<span class="hljs-deletion">- 不能根据文件类型动态加载不同规则</span>
</code></pre>
<p><strong>Kiro 的灵活性：</strong></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-selector-class">.kiro</span>/steering/
├── coding-standards<span class="hljs-selector-class">.md</span>      (always included)
├── testing-rules<span class="hljs-selector-class">.md</span>         (fileMatch: **/*.test.ts)
└── api-guidelines<span class="hljs-selector-class">.md</span>        (fileMatch: src/api/**/*.ts)

当你编辑测试文件时，只加载 testing-rules<span class="hljs-selector-class">.md</span>
当你编辑 API 文件时，只加载 api-guidelines<span class="hljs-selector-class">.md</span>
</code></pre>
<p><strong>实际影响：</strong></p>
<p><strong>Cursor 的问题：</strong></p>
<ul>
<li>如果把所有规则都写在 <code>.cursorrules</code> 中，上下文会很大</li>
<li>不能针对不同类型的文件提供不同的规则</li>
<li>测试规则会在写业务代码时也被加载（浪费上下文）</li>
</ul>
<p><strong>Kiro 的优势：</strong></p>
<ul>
<li>可以针对不同文件类型定义不同规则</li>
<li>上下文更精准，不浪费</li>
<li>更适合大型项目和团队协作</li>
</ul>
<p><strong>使用建议：</strong></p>
<ul>
<li>对于小型项目，<code>.cursorrules</code> 足够简单实用</li>
<li>对于大型项目，Kiro 的 Steering 系统更加灵活和高效</li>
<li>如果使用 Cursor，建议只在 <code>.cursorrules</code> 中放置最核心的规范</li>
</ul>
<h3 data-id="heading-14">5. MCP（Model Context Protocol）集成</h3>
<h4 data-id="heading-15">5.1 什么是 MCP</h4>
<p>MCP 是一个开放协议，允许 AI 工具连接外部数据源和服务。Kiro 原生支持 MCP，可以轻松集成各种工具。</p>
<p><strong>配置示例：</strong></p>
<pre><code class="hljs language-bash" lang="bash">{
  <span class="hljs-string">"mcpServers"</span>: {
    <span class="hljs-string">"aws-docs"</span>: {
      <span class="hljs-string">"command"</span>: <span class="hljs-string">"uvx"</span>,
      <span class="hljs-string">"args"</span>: [<span class="hljs-string">"awslabs.aws-documentation-mcp-server@latest"</span>],
      <span class="hljs-string">"disabled"</span>: <span class="hljs-literal">false</span>
    },
    <span class="hljs-string">"github"</span>: {
      <span class="hljs-string">"command"</span>: <span class="hljs-string">"uvx"</span>,
      <span class="hljs-string">"args"</span>: [<span class="hljs-string">"mcp-server-github"</span>],
      <span class="hljs-string">"env"</span>: {
        <span class="hljs-string">"GITHUB_TOKEN"</span>: <span class="hljs-string">"<span class="hljs-variable">${GITHUB_TOKEN}</span>"</span>
      }
    }
  }
}
</code></pre>
<h4 data-id="heading-16">5.2 实际应用场景</h4>
<p><strong>场景 1：AWS 文档查询</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">用户：如何使用 AWS Lambda 部署 Node.js 应用？

Kiro：
<span class="hljs-bullet">1.</span> 通过 MCP 查询 AWS 官方文档
<span class="hljs-bullet">2.</span> 提供最新的部署步骤
<span class="hljs-bullet">3.</span> 生成示例代码
<span class="hljs-bullet">4.</span> 创建部署脚本
</code></pre>
<p><strong>场景 2：GitHub 集成</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">用户：创建一个 PR 将当前分支合并到 main

Kiro：
<span class="hljs-bullet">1.</span> 通过 MCP 连接 GitHub API
<span class="hljs-bullet">2.</span> 检查当前分支状态
<span class="hljs-bullet">3.</span> 创建 PR
<span class="hljs-bullet">4.</span> 填写 PR 描述
<span class="hljs-bullet">5.</span> 添加 Reviewers
</code></pre>
<h4 data-id="heading-17">5.3 Cursor 的集成能力</h4>
<p>Cursor 目前主要依赖：</p>
<ul>
<li>@Web 搜索网络内容</li>
<li>@Docs 索引文档</li>
<li>@Codebase 搜索代码库</li>
</ul>
<p>相比 Kiro 的 MCP，Cursor 的集成能力相对有限，但对于大多数开发场景已经足够。</p>
<h3 data-id="heading-18">6. 使用场景推荐</h3>
<h4 data-id="heading-19">6.1 场景对比表</h4>








































<table><thead><tr><th>维度</th><th>Cursor</th><th>Kiro</th></tr></thead><tbody><tr><td><strong>最佳场景</strong></td><td>日常编码、快速开发</td><td>复杂功能、系统性开发</td></tr><tr><td><strong>项目规模</strong></td><td>小型项目、个人项目</td><td>中大型项目、团队协作</td></tr><tr><td><strong>开发模式</strong></td><td>即时补全、边写边改</td><td>规划先行、自主执行</td></tr><tr><td><strong>交互方式</strong></td><td>Tab 补全、行内建议</td><td>对话驱动、任务委托</td></tr><tr><td><strong>文档需求</strong></td><td>无需文档</td><td>自动生成设计文档</td></tr><tr><td><strong>适用人群</strong></td><td>熟悉 VS Code 的开发者</td><td>需要 AI 自主完成任务的开发者</td></tr></tbody></table>
<h4 data-id="heading-20">6.2 典型使用案例对比</h4>






























<table><thead><tr><th>任务类型</th><th>Cursor 适用场景</th><th>Kiro 适用场景</th></tr></thead><tbody><tr><td><strong>函数级</strong></td><td>✅ 编写工具函数 ✅ 实现单个组件 ✅ 修复小 bug</td><td>❌ 过于简单，大材小用</td></tr><tr><td><strong>文件级</strong></td><td>✅ 重构单个文件 ✅ 添加新功能模块</td><td>✅ 批量修改多个文件 ✅ 跨文件重构</td></tr><tr><td><strong>系统级</strong></td><td>❌ 需要频繁切换文件 ❌ 难以保持上下文</td><td>✅ 完整功能开发（如认证系统） ✅ 架构级重构 ✅ API 层重构</td></tr><tr><td><strong>自动化</strong></td><td>❌ 不支持</td><td>✅ 自动化测试 ✅ 批量代码修复 ✅ 工作流自动化</td></tr></tbody></table>
<h4 data-id="heading-21">6.3 组合使用策略</h4>
<p>根据任务复杂度选择合适的工具，可以最大化开发效率：</p>






























<table><thead><tr><th>开发阶段</th><th>推荐工具</th><th>使用场景</th></tr></thead><tbody><tr><td><strong>快速编码</strong></td><td>Cursor</td><td>• 代码补全 • 小范围修改 • 代码片段生成 • 单文件重构</td></tr><tr><td><strong>功能开发</strong></td><td>Kiro</td><td>• 完整功能实现 • 多文件协同修改 • 需要设计文档 • 复杂业务逻辑</td></tr><tr><td><strong>架构重构</strong></td><td>Kiro</td><td>• 项目结构调整 • API 层重构 • 批量文件修改</td></tr><tr><td><strong>自动化任务</strong></td><td>Kiro</td><td>• 自动化测试 • 代码质量检查 • 批量修复问题</td></tr></tbody></table>
<p><strong>💡 实践建议：</strong></p>
<ul>
<li><strong>80% 的日常编码用 Cursor</strong>：享受流畅的补全体验，快速完成常规任务</li>
<li><strong>20% 的复杂任务用 Kiro</strong>：让 AI 自主完成系统性工作，节省大量时间</li>
<li><strong>两者结合</strong>：Cursor 负责"写"，Kiro 负责"做"，发挥各自优势</li>
</ul>
<h3 data-id="heading-22">7. 性能与成本对比</h3>
<h4 data-id="heading-23">7.1 响应速度</h4>






























<table><thead><tr><th>场景</th><th>Cursor</th><th>Kiro</th></tr></thead><tbody><tr><td><strong>Tab 补全</strong></td><td>⚡ 极快（&lt;100ms）</td><td>⚡ 快（~200ms）</td></tr><tr><td><strong>Chat 响应</strong></td><td>⚡ 快（1-3s）</td><td>⚡ 快（1-3s）</td></tr><tr><td><strong>多文件编辑</strong></td><td>🐢 较慢（10-30s）</td><td>🐢 较慢（视任务复杂度）</td></tr><tr><td><strong>自主执行</strong></td><td>❌ 不支持</td><td>🐢 慢（视任务复杂度）</td></tr></tbody></table>
<h4 data-id="heading-24">7.2 成本</h4>























<table><thead><tr><th>工具</th><th>免费版</th><th>付费版</th><th>其他特性</th></tr></thead><tbody><tr><td><strong>Cursor</strong></td><td>有限的 AI 请求次数</td><td>Pro 版：$20/月，无限 AI 请求</td><td>支持自定义 API Key</td></tr><tr><td><strong>Kiro</strong></td><td>-</td><td>定价策略（需要查询官网）</td><td>支持自定义模型、支持本地模型</td></tr></tbody></table>
<h3 data-id="heading-25">8. 优缺点总结</h3>




















<table><thead><tr><th>工具</th><th>优点</th><th>缺点</th></tr></thead><tbody><tr><td><strong>Cursor</strong></td><td>✅ Tab 补全体验极佳 ✅ 上手简单，学习成本低 ✅ VS Code 生态完整 ✅ Composer 模式直观 ✅ 响应速度快</td><td>❌ 需要频繁手动操作 ❌ 不支持自主执行 ❌ 缺少工作流自动化 ❌ 没有 Spec 驱动开发 ❌ 集成能力有限</td></tr><tr><td><strong>Kiro</strong></td><td>✅ 自主执行能力强 ✅ Spec 驱动开发规范 ✅ Hooks 自动化工作流 ✅ Steering 规则系统 ✅ MCP 集成能力 ✅ 上下文理解更强</td><td>❌ Tab 补全不如 Cursor 流畅 ❌ 学习曲线较陡 ❌ 自主执行可能出错 ❌ 需要更多的初始配置 ❌ 生态相对较新</td></tr></tbody></table>
<h3 data-id="heading-26">9. 学习心得</h3>
<h4 data-id="heading-27">9.1 收获</h4>
<p>通过这段时间对 Kiro 和 Cursor 的深度使用，笔者有以下收获：</p>



































<table><thead><tr><th>收获维度</th><th>核心内容</th><th>具体收获</th></tr></thead><tbody><tr><td><strong>AI 编程范式</strong></td><td>理解两种工具模式</td><td>• 助手模式（Cursor）：AI 辅助人类编码 • Agent 模式（Kiro）：AI 自主完成任务</td></tr><tr><td><strong>Spec 驱动开发</strong></td><td>掌握结构化开发流程</td><td>• 需求 → 设计 → 任务 → 实现 • 强制思考，避免盲目编码 • 文档和代码同步</td></tr><tr><td><strong>自动化工作流</strong></td><td>学会工具链集成</td><td>• Hooks 自动触发任务 • Steering 注入项目规范 • MCP 集成外部服务</td></tr><tr><td><strong>工具选择策略</strong></td><td>认识工具适配性</td><td>• 没有最好的工具，只有最适合的工具 • 根据任务复杂度选择工具 • 组合使用效果更佳</td></tr><tr><td><strong>软件工程理念</strong></td><td>提升工程思维</td><td>• Kiro 能学到更多软件工程理念 • 培养系统化思考习惯</td></tr></tbody></table>
<h3 data-id="heading-28">10. 碎碎念</h3>
<p>啦啦啦，终于把 Kiro 和 Cursor 的对比写完了，学习时光总是过得很快。</p>
<p>说实话，这两个工具都很优秀，Cursor 的流畅体验让人爱不释手，Kiro 的自主执行能力又让人眼前一亮。如果非要选一个，笔者会说：<strong>都用！</strong> 日常编码用 Cursor，复杂任务用 Kiro，这样才能发挥两者的最大价值。</p>
<blockquote>
<p>注： 成年人不做选择题</p>
</blockquote>
<ul>
<li>我会给你们两次逃课机会，一定会有什么事比上课更重要。<strong>比如楼外的蒹葭，或者今晚的月亮。</strong></li>
<li>其实我没吃过什么苦，此生有幸，受家人疼爱，朋友照顾，而我不快乐的原因多数只是自己放大了一些小挫折罢了。</li>
<li>释怀的尽头是遗忘，时间或许不是解药，但时间里一定会有解药。</li>
</ul>
<h3 data-id="heading-29">11. 参考资料</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcursor.sh%2F" target="_blank" title="https://cursor.sh/" ref="nofollow noopener noreferrer">Cursor 官网</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fkiro.ai%2F" target="_blank" title="https://kiro.ai/" ref="nofollow noopener noreferrer">Kiro 官网</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelcontextprotocol.io%2F" target="_blank" title="https://modelcontextprotocol.io/" ref="nofollow noopener noreferrer">Model Context Protocol</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fhypothesis.works%2Farticles%2Fwhat-is-property-based-testing%2F" target="_blank" title="https://hypothesis.works/articles/what-is-property-based-testing/" ref="nofollow noopener noreferrer">Property-Based Testing</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI Agent 框架探秘：拆解 OpenHands（5）--- 交互&会话]]></title>    <link>https://juejin.cn/post/7602106969698238527</link>    <guid>https://juejin.cn/post/7602106969698238527</guid>    <pubDate>2026-02-02T12:59:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602106969698238527" data-draft-id="7601144981170094130" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI Agent 框架探秘：拆解 OpenHands（5）--- 交互&amp;会话"/> <meta itemprop="keywords" content="人工智能,深度学习"/> <meta itemprop="datePublished" content="2026-02-02T12:59:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="罗西的思考"/> <meta itemprop="url" content="https://juejin.cn/user/351470467691175"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI Agent 框架探秘：拆解 OpenHands（5）--- 交互&amp;会话
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/351470467691175/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    罗西的思考
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T12:59:26.000Z" title="Mon Feb 02 2026 12:59:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读33分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">AI Agent 框架探秘：拆解 OpenHands（5）--- 交互&amp;会话</h2>
<ul>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0x00 概述</a></p>
</li>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0x01 背景</a></p>
<ul>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">1.1 会话的意义</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">1.2 会话系统的常见功能</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">1.3 Session 常见内容</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">1.4 会话生命周期</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">1.5 前文回顾</a></li>
</ul>
</li>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0x02 OpenHands 会话系统</a></p>
<ul>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">2.1 对话管理接口 ConversationManager</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">2.2 session.py（WebSession）</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">2.3 agent_session</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">2.4 用户交互(oh_user_action)逻辑</a></li>
</ul>
</li>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0xFF 参考</a></p>
</li>
</ul>
<h3 data-id="heading-1">0x00 概述</h3>
<p>有意义的多轮对话要求智能体能够理解上下文。就像人类一样，智能体需要记住对话历史：已经说过和做过什么，以保持连贯性并避免重复。</p>
<p>以下是OpenHands Applications的示例图，本篇就来看看会话和交互如何进行。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8af47a6625a04082aeae85e626165114~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg572X6KW_55qE5oCd6ICD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770641966&amp;x-signature=N1W9D9Y3tcdHEYmXvSIGFcsKnO4%3D" alt="openhands-sdk" loading="lazy"/></p>
<p>openhands-sdk</p>
<p>因为本系列借鉴的文章过多，可能在参考文献中有遗漏的文章，如果有，还请大家指出。</p>
<h3 data-id="heading-2">0x01 背景</h3>
<p>本节基于 Google ADK 来进行背景介绍。</p>
<h4 data-id="heading-3">1.1 会话的意义</h4>
<p>就像你不会每次发短信都从头开始一样，智能体也需要了解当前交互的上下文。常见的Agent系统会通过 <code>Session</code>、<code>State</code> 和 <code>Memory</code> 提供了结构化的上下文管理方式。</p>
<ol>
<li>
<p><strong><code>Session</code></strong>：当前对话线程（可以将你与智能体的不同对话实例视为独立的<strong>对话线程</strong>，它们可能会利用<strong>长期知识</strong>）</p>
<ul>
<li>表示用户与你的智能体系统之间<em>单次、持续的交互</em>。</li>
<li>包含该特定交互期间，智能体采取的消息和动作（称为 <code>Events</code>）的时间顺序序列。</li>
<li>一个 <code>Session</code> 还可以保存仅在<em>本次对话</em>期间相关的临时数据（<code>State</code>）。</li>
</ul>
</li>
<li>
<p><code>State</code>：当前对话中的数据</p>
<ul>
<li>存储在特定 <code>Session</code> 内的数据。</li>
<li>用于管理<em>仅</em>与<em>当前（单次）、活跃</em>对话线程相关的信息（例如，<em>本次对话</em>中的购物车商品，<em>本 Session</em> 中提到的用户偏好）。</li>
<li>关注如何高效地读取、写入和管理 session 专属数据。</li>
</ul>
</li>
<li>
<p><code>Memory</code>：可检索的跨 Session 信息</p>
<ul>
<li>表示可能跨越<em>多个过去 Session</em>或包含外部数据源的信息存储。</li>
<li>它作为一个知识库，智能体可以<em>检索</em>以回忆超出当前对话的信息或上下文。</li>
</ul>
</li>
</ol>
<p>因此，Agent系统一般有如下两套组件或者服务：</p>
<ul>
<li><strong><code>SessionService</code></strong>：管理不同的对话线程（<code>Session</code> 对象）负责生命周期管理：创建、检索、更新（追加 <code>Events</code>、修改 <code>State</code>）和删除单个 <code>Session</code>。</li>
<li><strong><code>MemoryService</code></strong>：管理长期知识存储（<code>Memory</code>），负责将信息（通常来自已完成的 <code>Session</code>）导入长期存储。提供基于查询检索已存储知识的方法。</li>
</ul>
<p>本篇介绍对话服务，后续另外介绍内存服务。</p>
<h4 data-id="heading-4">1.2 会话系统的常见功能</h4>
<p>用户通常不会直接创建或管理 <code>Session</code> 对象，而是通过 <strong><code>SessionService</code></strong>。该服务作为会话生命周期的中央管理者。其核心职责包括：</p>
<ul>
<li><strong>开启新对话：</strong> 当用户开始交互时，创建新的 <code>Session</code> 对象。</li>
<li><strong>恢复已有对话：</strong> 通过 ID 检索特定 <code>Session</code>，让智能体可以从上次中断处继续。</li>
<li><strong>保存进度：</strong> 将新的交互（<code>Event</code> 对象）追加到 session 历史。这也是 session <code>state</code> 更新的机制（详见 <code>State</code> 章节）。</li>
<li><strong>列出对话：</strong> 查找特定用户和应用的活跃会话线程。</li>
<li><strong>清理：</strong> 当对话结束或不再需要时，删除 <code>Session</code> 及其相关数据。</li>
</ul>
<p>选择合适的 <code>SessionService</code> 是决定智能体对话历史和临时数据如何存储与持久化的关键。</p>
<h4 data-id="heading-5">1.3 Session 常见内容</h4>
<p>一般来说，当用户开始与智能体交互时，<code>SessionService</code> 会创建一个 <code>Session</code> 对象。该对象作为<em>单个对话线程</em>相关所有内容的容器。其主要属性如下：</p>
<ol>
<li>标识信息（<code>id</code>, <code>appName</code>, <code>userId</code>）：</li>
</ol>
<p>用于唯一标记对话的核心字段，具体说明如下：</p>
<ul>
<li><code>id</code>：当前对话线程的唯一标识符，是后续检索该对话的关键依据。一个 <code>SessionService</code> 对象可管理多个 <code>Session</code>（会话）实例，此字段用于明确当前操作对应的具体会话对象。示例值："test_id_modification"。</li>
<li><code>app_name</code>：标识当前对话所属的智能体应用。示例值："id_modifier_workflow"。</li>
<li><code>userId</code>：将对话与特定用户关联的关联字段，用于用户维度的对话管理与权限控制。</li>
</ul>
<ol start="2">
<li>对话历史（<code>events</code>）：</li>
</ol>
<p>按时间顺序排列的交互序列，包含当前对话线程中发生的所有交互行为（以 <code>Event</code> 对象形式存储），涵盖用户消息、智能体响应、工具调用动作等全量交互记录。</p>
<ol start="3">
<li>会话状态（<code>state</code>）：</li>
</ol>
<p>用于存储<strong>仅与当前活跃对话相关的临时数据</strong>，相当于智能体在交互过程中的 “临时草稿本”。下一节将详细介绍 <code>state</code> 的具体使用与管理方式。</p>
<ol start="4">
<li>活动追踪（<code>lastUpdateTime</code>）：</li>
</ol>
<p>时间戳字段，记录当前对话线程中最后一次交互事件的发生时间，用于会话活跃度判断与过期管理。</p>
<h4 data-id="heading-6">1.4 会话生命周期</h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cb49627e73f54ad29126b812a0d4e139~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg572X6KW_55qE5oCd6ICD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770641966&amp;x-signature=Fk2d4r4YPDVLIA4pQ094QnKQ3oE%3D" alt="Session lifecycle" loading="lazy"/></p>
<p>Session lifecycle</p>
<p>以下是 <code>Session</code> 与 <code>SessionService</code> 在一次对话轮次中协作的简化流程：</p>
<ol>
<li><strong>开始或恢复：</strong> 你的应用程序需要使用 <code>SessionService</code> 来要么 <code>create_session</code>（用于新聊天），要么使用现有的 session id。</li>
<li><strong>提供上下文：</strong> <code>Runner</code> 从适当的服务方法获取相应的 <code>Session</code> 对象，为智能体提供对相应 Session 的 <code>state</code> 和 <code>events</code> 的访问权限。</li>
<li><strong>智能体处理：</strong> 用户用查询提示智能体。智能体分析查询以及可能的 session <code>state</code> 和 <code>events</code> 历史来确定响应。</li>
<li><strong>响应和状态更新：</strong> 智能体生成响应（并可能标记要在 <code>state</code> 中更新的数据）。<code>Runner</code> 将其打包为 <code>Event</code>。</li>
<li><strong>保存交互：</strong> <code>Runner</code> 调用 <code>sessionService.append_event(session, event)</code>，将 <code>session</code> 和新的 <code>event</code> 作为参数。服务将 <code>Event</code> 添加到历史记录中，并根据事件中的信息更新存储中的 session <code>state</code>。session 的 <code>last_update_time</code> 也会得到更新。</li>
<li><strong>准备下一次：</strong> 智能体的响应发送给用户。更新后的 <code>Session</code> 现在由 <code>SessionService</code> 存储，准备进行下一轮（这通常会在当前会话中继续对话，从步骤 1 重新开始循环）。</li>
<li><strong>结束对话：</strong> 当对话结束时，你的应用程序调用 <code>sessionService.delete_session(...)</code> 来清理存储的会话数据（如果不再需要的话）。</li>
</ol>
<p>此循环突出显示了 <code>SessionService</code> 如何通过管理每个 <code>Session</code> 对象的历史和状态，确保对话的连续性。</p>
<h4 data-id="heading-7">1.5 前文回顾</h4>
<p>我们首先回顾前文介绍的，OpenHands项目关于对话的服务器端组件。</p>
<ul>
<li><code>session.py</code> 文件定义了<code>Session</code>类，它代表与客户端的WebSocket会话。</li>
<li><code>agent_session.py</code> 文件包含<code>AgentSession</code>类，它管理会话内Agent的生命周期。</li>
<li><code>conversation_manager.py</code> 文件定义了<code>ConversationManager</code>类，它负责管理多个客户端会话。</li>
<li><code>listen.py</code> 文件是主服务器文件，它设置FastAPI应用程序并定义各种API端点。此处关键一步为与会话管理器 ConversationManager 建立连接。</li>
</ul>
<p>以上几步展示了服务器组件如何构建会话，因此我们由此而入。</p>
<h3 data-id="heading-8">0x02 OpenHands 会话系统</h3>
<p>会话是专门设计用于跟踪和管理单独对话线程的对象。会话就可以理解为AI代理的临时工作空间，就像你为特定项目准备的办公桌。它包含当前对话的所有必要工具、笔记和参考资料，一切都是即时可访问的，但也具有临时性和任务特定性。</p>
<p>具体而言，在OpenHands中：</p>
<ul>
<li><code>WebSession</code> 是一个 Web 服务器绑定的会话包装器，<strong>负责管理单个 Web 客户端连接并协调 AgentSession 生命周期</strong>。是 OpenHands 系统中连接前端用户界面和后端Agent执行的核心桥梁，负责协调整个交互流程。</li>
<li><code>AgentSession</code> 是 OpenHands 框架中 <strong>Agent运行的 “上下文容器”</strong> ，核心作用是封装Agent执行所需的所有组件（Agent、控制器、运行时、内存、事件流），统一管理它们的生命周期（初始化、启动、通信、关闭），并提供会话级的配置隔离、数据持久化和状态管理，是Agent能够独立、稳定执行任务的基础。</li>
</ul>
<h4 data-id="heading-9">2.1 对话管理接口 ConversationManager</h4>
<p>ConversationManager 类定义了对话管理的接口，适用于单机模式和集群模式。它负责处理对话的全生命周期， 包括创建、附加、分离和清理。这是OpenHands的一个扩展点，基于它构建的应用可通过服务器配置修改行为，无需改动其核心代码。应用程序可通过以下方式提供自定义实现：</p>
<ol>
<li>创建一个继承自ConversationManager的类</li>
<li>实现所有必需的抽象方法</li>
<li>将server_config.conversation_manager_class设置为该实现类的全限定名</li>
</ol>
<p>ConversationManager 定义如下。</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConversationManager</span>(<span class="hljs-title class_ inherited__">ABC</span>):
    <span class="hljs-string">"""OpenHands中对话管理的抽象基类。
    应用程序可能需要在以下场景中自定义实现：
    - 具有分布式对话状态的集群部署
    - 自定义持久化或缓存策略
    - 与外部对话管理系统集成
    - 增强的监控或日志能力
    实现类通过openhands.server.shared.py中的get_impl()方法实例化。
    """</span>

    sio: socketio.AsyncServer  <span class="hljs-comment"># Socket.IO异步服务器实例，用于实时通信</span>
    config: OpenHandsConfig    <span class="hljs-comment"># OpenHands配置对象，存储系统参数</span>
    file_store: FileStore      <span class="hljs-comment"># 文件存储实例，用于管理对话相关文件</span>
    conversation_store: ConversationStore  <span class="hljs-comment"># 对话存储实例，用于持久化对话数据</span>
</code></pre>
<h5 data-id="heading-10">2.1.1 StandaloneConversationManager</h5>
<p>StandaloneConversationManager 是ConversationManager的子类。是默认实现，适用于单服务器部署场景。</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">StandaloneConversationManager</span>(<span class="hljs-title class_ inherited__">ConversationManager</span>):
    <span class="hljs-string">"""Default implementation of ConversationManager for single-server deployments.

    See ConversationManager for extensibility details.
    """</span>

    sio: socketio.AsyncServer
    config: OpenHandsConfig
    file_store: FileStore
    server_config: ServerConfig
    <span class="hljs-comment"># Defaulting monitoring_listener for temp backward compatibility.</span>
    monitoring_listener: MonitoringListener = MonitoringListener()
    _local_agent_loops_by_sid: <span class="hljs-built_in">dict</span>[<span class="hljs-built_in">str</span>, Session] = field(default_factory=<span class="hljs-built_in">dict</span>)
    _local_connection_id_to_session_id: <span class="hljs-built_in">dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>] = field(default_factory=<span class="hljs-built_in">dict</span>)
    _active_conversations: <span class="hljs-built_in">dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">tuple</span>[ServerConversation, <span class="hljs-built_in">int</span>]] = field(
        default_factory=<span class="hljs-built_in">dict</span>
    )
    _detached_conversations: <span class="hljs-built_in">dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">tuple</span>[ServerConversation, <span class="hljs-built_in">float</span>]] = field(
        default_factory=<span class="hljs-built_in">dict</span>
    )
    _conversations_lock: asyncio.Lock = field(default_factory=asyncio.Lock)
    _cleanup_task: asyncio.Task | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>
    _conversation_store_class: <span class="hljs-built_in">type</span>[ConversationStore] | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>
    _loop: asyncio.AbstractEventLoop | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>
</code></pre>
<h5 data-id="heading-11">2.1.2 Session初始化</h5>
<p>Session初始化的流程图如下。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d14e54887e4042c28b3f8debb296516c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg572X6KW_55qE5oCd6ICD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770641966&amp;x-signature=D6HNxQ5w14ii7grDzVMYSKHyabY%3D" alt="openhands-4.1-1" loading="lazy"/></p>
<p>openhands-4.1-1</p>
<p>StandaloneConversationManager 的 join_conversation 函数如下，其调用了 maybe_start_agent_loop 初始化Agent。需要注意，此处 Session 是 WebSession。</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">from</span> openhands.server.session.session <span class="hljs-keyword">import</span> WebSession <span class="hljs-keyword">as</span> Session

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">join_conversation</span>(<span class="hljs-params">
        self,
        sid: <span class="hljs-built_in">str</span>,
        connection_id: <span class="hljs-built_in">str</span>,
        settings: Settings,
        user_id: <span class="hljs-built_in">str</span> | <span class="hljs-literal">None</span>,
    </span>) -&gt; AgentLoopInfo:
        <span class="hljs-keyword">await</span> self.sio.enter_room(connection_id, ROOM_KEY.<span class="hljs-built_in">format</span>(sid=sid))
        self._local_connection_id_to_session_id[connection_id] = sid
        <span class="hljs-comment"># 此处调用 maybe_start_agent_loop</span>
        agent_loop_info = <span class="hljs-keyword">await</span> self.maybe_start_agent_loop(sid, settings, user_id)
        <span class="hljs-keyword">return</span> agent_loop_info
</code></pre>
<p>maybe_start_agent_loop 调用了 _start_agent_loop 初始化 Session。</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConversationManager</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, config: OpenHandsConfig, sio: <span class="hljs-type">Any</span>, file_store: <span class="hljs-type">Any</span></span>):
        self.config = config  <span class="hljs-comment"># 框架全局配置</span>
        self.sio = sio  <span class="hljs-comment"># SocketIO实例（用于客户端通信）</span>
        self.file_store = file_store  <span class="hljs-comment"># 文件存储实例（用于会话数据持久化）</span>
        self._local_agent_loops_by_sid: <span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, Session] = {}  <span class="hljs-comment"># 会话ID到Session实例的映射（缓存活跃会话）</span>
        self._loop = asyncio.get_event_loop()  <span class="hljs-comment"># 事件循环实例</span>

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">maybe_start_agent_loop</span>(<span class="hljs-params">
        self,
        sid: <span class="hljs-built_in">str</span>,  <span class="hljs-comment"># 会话ID（唯一标识一个对话）</span>
        settings: Settings,  <span class="hljs-comment"># 用户/会话设置（含Agent类型、LLM配置等）</span>
        user_id: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = <span class="hljs-literal">None</span>,  <span class="hljs-comment"># 用户ID（可选，用于用户级并发控制）</span>
        initial_user_msg: <span class="hljs-type">Optional</span>[MessageAction] = <span class="hljs-literal">None</span>,  <span class="hljs-comment"># 初始用户消息（可选，会话启动时的第一条消息）</span>
        replay_json: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = <span class="hljs-literal">None</span>,  <span class="hljs-comment"># 回放JSON字符串（可选，用于会话回放场景）</span>
    </span>) -&gt; AgentLoopInfo:
        <span class="hljs-string">"""
        尝试启动Agent循环：优先复用已存在的会话，不存在则新建。
        
        核心逻辑：
        - 检查会话ID对应的会话是否已存在（缓存于_local_agent_loops_by_sid）
        - 存在则直接返回会话信息，不存在则调用_start_agent_loop新建会话
        - 返回标准化的Agent循环信息（供外部调用者使用）
        """</span>     
        <span class="hljs-comment"># 从缓存中获取会话（复用已有会话，避免重复初始化）</span>
        session = self._local_agent_loops_by_sid.get(sid)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> session:
            <span class="hljs-comment"># 会话不存在，新建Agent循环</span>
            session = <span class="hljs-keyword">await</span> self._start_agent_loop(
                sid, settings, user_id, initial_user_msg, replay_json
            )
        
        <span class="hljs-comment"># 将Session实例转换为标准化的AgentLoopInfo返回</span>
        <span class="hljs-keyword">return</span> self._agent_loop_info_from_session(session)
</code></pre>
<p>_start_agent_loop 该代码是 OpenHands 框架中 <strong>Agent循环（Agent Loop）的启动与管理核心</strong>，负责会话的创建、复用、并发控制和初始化，是连接用户请求与Agent执行的关键枢纽。其核心使命是：在遵守并发限制的前提下，为用户会话提供完整的组件初始化（LLM 注册表、统计、事件订阅），确保Agent能够顺畅启动并运行。</p>
<p>_start_agent_loop 的核心特色如下：</p>
<ol>
<li><strong>会话复用机制</strong>：通过 <code>_local_agent_loops_by_sid</code> 缓存活跃会话，避免重复初始化，提升响应速度和资源利用率（例如用户重新连接同一会话时直接复用）。</li>
<li><strong>智能并发控制</strong>：基于用户 ID 限制最大并发会话数，超限后自动关闭最早的会话，同时向客户端发送友好通知，平衡资源占用与用户体验。</li>
<li><strong>组件化初始化</strong>：整合 <code>create_registry_and_conversation_stats</code> 函数，一键完成 LLM 注册表、对话统计、配置适配三大核心组件的初始化，架构清晰且解耦。</li>
<li><strong>异步非阻塞设计</strong>：Agent初始化（<code>session.initialize_agent</code>）通过 <code>asyncio.create_task</code> 异步执行，不阻塞会话创建流程，提升系统吞吐量。</li>
<li><strong>事件驱动扩展</strong>：自动订阅会话事件流，通过回调函数响应会话更新，支持后续扩展监控、统计等功能，具备良好的可扩展性。</li>
<li><strong>容错与兼容性</strong>：处理重复订阅异常，避免报错；支持会话回放（<code>replay_json</code>）和初始消息（<code>initial_user_msg</code>），适配正常对话、回放等多种场景。</li>
</ol>
<p>_start_agent_loop 代码如下。</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">_start_agent_loop</span>(<span class="hljs-params">
        self,
        sid: <span class="hljs-built_in">str</span>,
        settings: Settings,
        user_id: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = <span class="hljs-literal">None</span>,
        initial_user_msg: <span class="hljs-type">Optional</span>[MessageAction] = <span class="hljs-literal">None</span>,
        replay_json: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = <span class="hljs-literal">None</span>,
    </span>) -&gt; Session:
        <span class="hljs-string">"""
        内部方法：实际创建并启动Agent循环，包含并发控制、会话初始化、事件订阅等核心流程。
        """</span>
        <span class="hljs-comment"># 1. 并发会话数量控制：检查用户当前活跃会话数是否超过上限</span>
        <span class="hljs-comment"># 获取用户当前运行中的所有会话ID</span>
        running_session_ids = <span class="hljs-keyword">await</span> self.get_running_agent_loops(user_id)
        <span class="hljs-comment"># 若超过最大并发数，关闭最早的会话以释放资源</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(running_session_ids) &gt;= self.config.max_concurrent_conversations:
           
            <span class="hljs-comment"># 获取用户的会话存储实例，读取所有活跃会话的元数据</span>
            conversation_store = <span class="hljs-keyword">await</span> self._get_conversation_store(user_id)
            conversations = <span class="hljs-keyword">await</span> conversation_store.get_all_metadata(running_session_ids)
            <span class="hljs-comment"># 按最后更新时间排序（最新的在前， oldest的在后）</span>
            conversations.sort(key=_last_updated_at_key, reverse=<span class="hljs-literal">True</span>)

            <span class="hljs-comment"># 循环关闭最早的会话，直到并发数符合限制</span>
            <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(conversations) &gt;= self.config.max_concurrent_conversations:
                oldest_conversation = conversations.pop()  <span class="hljs-comment"># 取出最早的会话</span>
                oldest_sid = oldest_conversation.conversation_id
               
                <span class="hljs-comment"># 向客户端发送错误通知（告知会话已关闭）</span>
                status_update = {
                    <span class="hljs-string">'status_update'</span>: <span class="hljs-literal">True</span>,
                    <span class="hljs-string">'type'</span>: <span class="hljs-string">'error'</span>,
                    <span class="hljs-string">'id'</span>: <span class="hljs-string">'AGENT_ERROR$TOO_MANY_CONVERSATIONS'</span>,
                    <span class="hljs-string">'message'</span>: <span class="hljs-string">'同时开启的会话数已达上限。若仍需使用该会话，可发送消息重新激活Agent'</span>,
                }
                <span class="hljs-comment"># 在事件循环中发送SocketIO事件（定向到该会话的房间）</span>
                <span class="hljs-keyword">await</span> run_in_loop(
                    self.sio.emit(
                        <span class="hljs-string">'oh_event'</span>,
                        status_update,
                        to=ROOM_KEY.<span class="hljs-built_in">format</span>(sid=oldest_sid),  <span class="hljs-comment"># 按会话ID定向发送</span>
                    ),
                    self._loop,
                )
                
                <span class="hljs-comment"># 关闭最早的会话（释放资源）</span>
                <span class="hljs-keyword">await</span> self.close_session(oldest_sid)

        <span class="hljs-comment"># 2. 初始化核心组件：LLM注册表、对话统计、最终配置</span>
        llm_registry, conversation_stats, final_config = (
            create_registry_and_conversation_stats(self.config, sid, user_id, settings)
        )
        
        <span class="hljs-comment"># 3. 创建Session实例（封装会话的所有状态和组件）</span>
        session = Session(
            sid=sid,
            file_store=self.file_store,  <span class="hljs-comment"># 绑定文件存储</span>
            config=final_config,  <span class="hljs-comment"># 绑定最终配置</span>
            llm_registry=llm_registry,  <span class="hljs-comment"># 绑定LLM注册表</span>
            conversation_stats=conversation_stats,  <span class="hljs-comment"># 绑定对话统计</span>
            sio=self.sio,  <span class="hljs-comment"># 绑定SocketIO实例</span>
            user_id=user_id,  <span class="hljs-comment"># 绑定用户ID</span>
        )
        
        <span class="hljs-comment"># 4. 将新会话缓存到本地（供后续复用）</span>
        self._local_agent_loops_by_sid[sid] = session
        
        <span class="hljs-comment"># 5. 异步初始化Agent（不阻塞当前流程）：加载Agent、处理初始消息、回放会话（若有）</span>
        asyncio.create_task(
            session.initialize_agent(settings, initial_user_msg, replay_json)
        )
        
        <span class="hljs-comment"># 6. 订阅会话事件流：监听会话更新事件（仅新建会话时订阅，复用会话跳过）</span>
        <span class="hljs-keyword">try</span>:
            session.agent_session.event_stream.subscribe(
                subscriber=EventStreamSubscriber.SERVER,  <span class="hljs-comment"># 订阅者类型：服务器</span>
                callback=self._create_conversation_update_callback(
                    user_id, sid, settings, llm_registry  <span class="hljs-comment"># 会话更新回调函数</span>
                ),
                callback_id=UPDATED_AT_CALLBACK_ID,  <span class="hljs-comment"># 回调ID（用于后续取消订阅）</span>
            )
        <span class="hljs-keyword">except</span> ValueError:
            <span class="hljs-comment"># 若已存在相同ID的订阅，忽略该操作（避免重复订阅）</span>

        <span class="hljs-comment"># 返回创建好的Session实例</span>
        <span class="hljs-keyword">return</span> session
</code></pre>
<h4 data-id="heading-12">2.2 session.py（WebSession）</h4>
<p>session.py 定义了 WebSession 类，它是 OpenHands 系统中管理 Web 客户端会话的核心组件。</p>
<h5 data-id="heading-13">2.2.1 WebSession 类概述</h5>
<p>WebSession 是一个 Web 服务器绑定的会话包装器，负责管理单个 Web 客户端连接并协调 AgentSession 生命周期。WebSession 的关键设计模式为：</p>
<ul>
<li>异步队列模式：使用 asyncio.Queue 管理事件发布，确保非阻塞操作</li>
<li>事件驱动架构：通过事件订阅/发布机制实现组件解耦</li>
<li>状态管理模式：跟踪会话状态和连接状态</li>
<li>错误处理机制：全面的异常捕获和错误报告</li>
</ul>
<p>WebSession 是 OpenHands 系统中连接前端用户界面和后端Agent执行的核心桥梁，负责协调整个交互流程。</p>
<h5 data-id="heading-14">2.2.2 WebSession 核心属性</h5>
<p>WebSession 核心属性为：</p>
<ul>
<li>sid：稳定的会话 ID，跨传输保持一致</li>
<li>sio：Socket.IO 服务器，用于向 Web 客户端发送事件</li>
<li>agent_session：核心Agent会话，协调运行时和 LLM</li>
<li>config：有效的 OpenHands 配置</li>
<li>llm_registry：负责 LLM 访问和重试钩子的注册表</li>
<li>file_store：会话的文件存储接口</li>
<li>user_id：可选的多租户用户标识符</li>
</ul>
<p>WebSession会订阅 EventStreamSubscriber.SERVER。</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSession</span>:
    <span class="hljs-string">"""Web server-bound session wrapper.

    This was previously named `Session`. We keep `Session` as a compatibility alias
    (see openhands.server.session.__init__) so downstream imports/tests continue to
    work. The class manages a single web client connection and orchestrates the
    AgentSession lifecycle for that conversation.
    """</span>

    sid: <span class="hljs-built_in">str</span>
    sio: socketio.AsyncServer | <span class="hljs-literal">None</span>
    last_active_ts: <span class="hljs-built_in">int</span> = <span class="hljs-number">0</span>
    is_alive: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">True</span>
    agent_session: AgentSession
    loop: asyncio.AbstractEventLoop
    config: OpenHandsConfig
    llm_registry: LLMRegistry
    file_store: FileStore
    user_id: <span class="hljs-built_in">str</span> | <span class="hljs-literal">None</span>
    logger: LoggerAdapter
</code></pre>
<h5 data-id="heading-15">2.2.3 主要功能模块</h5>
<p>WebSession 的主要功能模块为：</p>
<ul>
<li>
<p>初始化和配置管理</p>
<ul>
<li>init 方法设置会话的基本配置和组件</li>
<li>订阅 EventStream 的 SERVER 事件</li>
<li>初始化异步事件发布队列</li>
<li>Agent初始化（initialize_agent）</li>
<li>配置Agent、LLM 和运行时环境</li>
<li>处理 MCP（Model Context Protocol）配置</li>
<li>设置 condenser（压缩器）配置</li>
<li>启动 AgentSession</li>
<li>错误处理和验证</li>
</ul>
</li>
</ul>

<ul>
<li>
<p>事件处理（on_event 和 _on_event）</p>
<ul>
<li>
<p>处理来自Agent的事件</p>
<ul>
<li>过滤 NullAction 和 NullObservation</li>
<li>根据事件源决定如何处理和转发事件</li>
<li>将环境反馈作为Agent事件发送给 UI</li>
</ul>
</li>
</ul>
</li>
<li>
<p>消息分发（dispatch）</p>
<ul>
<li>处理来自用户的事件</li>
<li>验证图像支持</li>
<li>将事件添加到事件流中</li>
</ul>
</li>
<li>
<p>异步消息发送（send, _monitor_publish_queue, _send）</p>
<ul>
<li>使用队列机制异步发送消息</li>
<li>确保 WebSocket 连接稳定后再发送</li>
<li>处理连接状态和错误</li>
</ul>
</li>
<li>
<p>状态管理</p>
<ul>
<li>close 方法清理会话资源</li>
<li>queue_status_message 和 _send_status_message 处理状态更新消息</li>
</ul>
</li>
</ul>
<h5 data-id="heading-16">2.2.4 与系统其他组件的关系</h5>
<p>WebSession 与系统其他组件的关系如下：</p>
<ul>
<li>
<p>与 EventStream 集成</p>
<ul>
<li>作为 SERVER 订阅者接收事件</li>
<li>处理来自Agent和用户的事件流</li>
</ul>
</li>
<li>
<p>与 AgentSession 协作：</p>
<ul>
<li>管理 AgentSession 生命周期</li>
<li>转发用户事件到Agent</li>
<li>将Agent响应发送给客户端</li>
</ul>
</li>
<li>
<p>与 Socket.IO 集成：</p>
<ul>
<li>使用 Socket.IO 向客户端发送实时事件</li>
<li>管理 WebSocket 连接状态</li>
</ul>
</li>
</ul>
<h5 data-id="heading-17">2.2.5 初始化 AgentSession</h5>
<p>WebSession 的初始化会中完成对<code>AgentSession</code>的初始化，<code>AgentSession</code>的初始化中又做了<code>EventStream</code>的初始化，所以整个会话的<code>EventStream</code>也就是在这里创建的，这里在事件流中订阅了<code>EventStreamSubscriber.SERVER</code>，事件回调函数中将需要向前端广播的事件通过socket进行发送。</p>
<pre><code class="hljs language-ini" lang="ini">class WebSession:
    def __init__(
        self,
        sid: str,
        config: OpenHandsConfig,
        llm_registry: LLMRegistry,
        conversation_stats: ConversationStats,
        file_store: FileStore,
        sio: socketio.AsyncServer | None,
        user_id: str | <span class="hljs-attr">None</span> = None,
    ):
        <span class="hljs-attr">self.sid</span> = sid
        <span class="hljs-attr">self.sio</span> = sio
        <span class="hljs-attr">self.last_active_ts</span> = int(time.time())
        <span class="hljs-attr">self.file_store</span> = file_store
        <span class="hljs-attr">self.logger</span> = OpenHandsLoggerAdapter(extra={<span class="hljs-string">'session_id'</span>: sid})
        <span class="hljs-attr">self.llm_registry</span> = llm_registry
        <span class="hljs-attr">self.conversation_stats</span> = conversation_stats
        <span class="hljs-attr">self.agent_session</span> = AgentSession(
            sid,
            file_store,
            <span class="hljs-attr">llm_registry</span>=self.llm_registry,
            <span class="hljs-attr">conversation_stats</span>=conversation_stats,
            <span class="hljs-attr">status_callback</span>=self.queue_status_message,
            <span class="hljs-attr">user_id</span>=user_id,
        )
        self.agent_session.event_stream.subscribe(
            EventStreamSubscriber.SERVER, self.on_event, self.sid
        )
        <span class="hljs-attr">self.config</span> = config

        <span class="hljs-comment"># Lazy import to avoid ircular dependency</span>
        from openhands.experiments.experiment_manager import ExperimentManagerImpl

        <span class="hljs-attr">self.config</span> = ExperimentManagerImpl.run_config_variant_test(
            user_id, sid, self.config
        )
        <span class="hljs-attr">self.loop</span> = asyncio.get_event_loop()
        <span class="hljs-attr">self.user_id</span> = user_id

        self._publish_queue: <span class="hljs-attr">asyncio.Queue</span> = asyncio.Queue()
        self._monitor_publish_queue_task: <span class="hljs-attr">asyncio.Task</span> = self.loop.create_task(
            self._monitor_publish_queue()
        )
        self._wait_websocket_initial_complete: <span class="hljs-attr">bool</span> = <span class="hljs-literal">True</span>
</code></pre>
<p><code>agent_session.start()</code>中完成了security_analyzer、runtime、memory、controller的初始化。</p>
<h4 data-id="heading-18">2.3 agent_session</h4>
<h5 data-id="heading-19">2.3.1 AgentSession</h5>
<p><code>AgentSession</code> 是 OpenHands 框架中 <strong>Agent运行的 “上下文容器”</strong> ，核心作用是封装Agent执行所需的所有组件（Agent、控制器、运行时、内存、事件流），统一管理它们的生命周期（初始化、启动、通信、关闭），并提供会话级的配置隔离、数据持久化和状态管理，是Agent能够独立、稳定执行任务的基础。</p>
<p>AgentSession 核心特色如下：</p>
<ol>
<li><strong>全组件生命周期管理</strong>：集中初始化并关联Agent、控制器、运行时、内存、事件流等核心组件，确保组件间通信顺畅，生命周期一致（启动 / 关闭同步）。</li>
<li><strong>灵活的环境配置</strong>：支持 Git 仓库集成、自定义密钥注入、MCP 工具扩展等，适配代码开发、第三方服务调用等复杂场景，满足多样化任务需求。</li>
<li><strong>会话状态安全管控</strong>：严格校验会话状态（避免重复启动、已关闭会话启动失败），通过状态标记（<code>_starting</code>/<code>_closed</code>）确保流程安全性，减少异常。</li>
<li><strong>支持会话回放与状态恢复</strong>：提供 <code>_run_replay</code> 接口支持从 JSON 数据恢复历史会话，便于调试、任务续跑和场景复现。</li>
<li><strong>精细化日志与监控</strong>：集成带会话上下文的日志器，记录启动耗时、成功状态、状态恢复等元数据，便于问题排查和系统监控。</li>
<li><strong>安全与隔离设计</strong>：通过自定义密钥处理器（<code>UserSecrets</code>）安全管理第三方密钥，运行时环境隔离执行代码，避免敏感信息泄露和系统风险。</li>
<li><strong>状态驱动的事件机制</strong>：启动时根据是否有初始消息自动设置Agent状态（运行中 / 等待用户输入），并通过事件流同步状态，确保组件间状态一致性。</li>
</ol>
<p>AgentSession 定义如下：</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AgentSession</span>:
    <span class="hljs-string">"""
        Agent会话类：封装Agent运行的完整上下文，管理Agent、控制器、运行时、内存等核心组件的生命周期。
        属性说明：
        controller: Agent控制器实例（负责调度Agent执行流程）
        sid: 会话唯一标识
        user_id: 用户ID（可选）
        event_stream: 事件流（组件间通信核心）
        llm_registry: LLM注册表（管理LLM实例）
        file_store: 文件存储（持久化会话数据）
        runtime: 运行时环境（如沙盒，执行代码/命令）
        memory: Agent内存（存储会话历史、上下文等）
        _starting: 会话启动中标记
        _started_at: 会话启动时间戳
        _closed: 会话关闭标记
        loop: 异步事件循环
        logger: 带会话上下文的日志器
    """</span>

    sid: <span class="hljs-built_in">str</span>
    user_id: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>]
    event_stream: EventStream
    llm_registry: LLMRegistry
    file_store: FileStore
    controller: <span class="hljs-type">Optional</span>[AgentController] = <span class="hljs-literal">None</span>
    runtime: <span class="hljs-type">Optional</span>[Runtime] = <span class="hljs-literal">None</span>

    memory: <span class="hljs-type">Optional</span>[Memory] = <span class="hljs-literal">None</span>
    _starting: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span>
    _started_at: <span class="hljs-built_in">float</span> = <span class="hljs-number">0</span>
    _closed: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span>
    loop: <span class="hljs-type">Optional</span>[asyncio.AbstractEventLoop] = <span class="hljs-literal">None</span>
    logger: LoggerAdapter

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">
        self,
        sid: <span class="hljs-built_in">str</span>,
        file_store: FileStore,
        llm_registry: LLMRegistry,
        conversation_stats: ConversationStats,
        status_callback: <span class="hljs-type">Optional</span>[<span class="hljs-type">Callable</span>] = <span class="hljs-literal">None</span>,
        user_id: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = <span class="hljs-literal">None</span>,
    </span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-string">"""
        初始化AgentSession实例。

        参数：
            sid: 会话ID（唯一标识）
            file_store: 文件存储实例（用于事件流、内存数据持久化）
            llm_registry: LLM注册表实例（提供LLM资源）
            conversation_stats: 对话统计实例（记录会话相关统计数据）
            status_callback: 状态回调函数（可选，会话状态变更时触发）
            user_id: 用户ID（可选，用于用户级数据隔离）
        """</span>
        self.sid = sid
        <span class="hljs-comment"># 初始化事件流（会话内组件通信的核心枢纽）</span>
        self.event_stream = EventStream(sid, file_store, user_id)
        self.file_store = file_store
        self._status_callback = status_callback  <span class="hljs-comment"># 状态变更回调（如通知客户端）</span>
        self.user_id = user_id
        <span class="hljs-comment"># 初始化带会话上下文的日志器（便于追踪会话级日志）</span>
        self.logger = OpenHandsLoggerAdapter(
            extra={<span class="hljs-string">'session_id'</span>: sid, <span class="hljs-string">'user_id'</span>: user_id}
        )
        self.llm_registry = llm_registry  <span class="hljs-comment"># 绑定LLM注册表</span>
        self.conversation_stats = conversation_stats  <span class="hljs-comment"># 绑定对话统计实例</span>
</code></pre>
<p>AgentSession 初始化完成后向事件流中添加<code>ChangeAgentStateAction</code>事件。</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02937a361a9747e9896b6d504cf56853~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg572X6KW_55qE5oCd6ICD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770641966&amp;x-signature=dwNClnXrZWFMar3lh2s1X0waVQQ%3D" alt="openhands-4.1-2" loading="lazy"/></p>
<p>openhands-4.1-2</p>
<p>具体代码如下：</p>
<pre><code class="hljs language-ini" lang="ini">    async def start(
        self,
        runtime_name: str,  <span class="hljs-comment"># 运行时名称（如"sandbox"，指定运行环境类型）</span>
        config: OpenHandsConfig,  <span class="hljs-comment"># 框架全局配置</span>
        agent: Agent,  <span class="hljs-comment"># 已初始化的Agent实例</span>
        max_iterations: int,  <span class="hljs-comment"># Agent执行的最大迭代次数（防止无限循环）</span>
        git_provider_tokens: Optional<span class="hljs-section">[PROVIDER_TOKEN_TYPE]</span> = None,  <span class="hljs-comment"># Git提供商令牌（如GitHub令牌）</span>
        custom_secrets: Optional<span class="hljs-section">[CUSTOM_SECRETS_TYPE]</span> = None,  <span class="hljs-comment"># 自定义密钥（第三方服务访问用）</span>
        max_budget_per_task: Optional<span class="hljs-section">[float]</span> = None,  <span class="hljs-comment"># 单任务最大预算（可选）</span>
        agent_to_llm_config: Optional<span class="hljs-section">[Dict[str, LLMConfig]]</span> = None,  <span class="hljs-comment"># Agent-LLM配置映射</span>
        agent_configs: Optional<span class="hljs-section">[Dict[str, AgentConfig]]</span> = None,  <span class="hljs-comment"># 所有Agent配置字典</span>
        selected_repository: Optional<span class="hljs-section">[str]</span> = None,  <span class="hljs-comment"># 选中的Git仓库地址（可选）</span>
        selected_branch: Optional<span class="hljs-section">[str]</span> = None,  <span class="hljs-comment"># 选中的仓库分支（可选）</span>
        initial_message: Optional<span class="hljs-section">[MessageAction]</span> = None,  <span class="hljs-comment"># 初始用户消息（可选）</span>
        conversation_instructions: Optional<span class="hljs-section">[str]</span> = None,  <span class="hljs-comment"># 会话指令（自定义Agent行为）</span>
        replay_json: Optional<span class="hljs-section">[str]</span> = None,  <span class="hljs-comment"># 会话回放JSON数据（可选）</span>
    ) -&gt; None:
        """
        启动Agent会话：初始化运行时、内存、控制器，触发Agent开始执行。
        
        核心流程：
        1. 校验会话状态（避免重复启动）
        2. 创建运行时环境（如沙盒）
        3. 配置Git令牌、自定义密钥
        4. 创建Agent内存（存储上下文、会话指令等）
        5. （可选）添加MCP工具到Agent
        6. （可选）执行会话回放
        7. 创建Agent控制器（调度Agent执行）
        8. 发送初始事件（启动状态/等待用户输入）
        """
        <span class="hljs-comment"># 校验会话状态：已存在控制器或运行时 → 抛出异常（避免重复启动）</span>
        if self.controller or self.runtime:
            raise RuntimeError(
                'Session already started. You need to close this session and start a new one.'
            )

        <span class="hljs-comment"># 会话已关闭 → 日志警告并返回</span>
        if self._closed:
            self.logger.warning('Session closed before starting')
            return
        
        <span class="hljs-attr">self._starting</span> = <span class="hljs-literal">True</span>  <span class="hljs-comment"># 标记会话启动中</span>
        <span class="hljs-attr">started_at</span> = time.time()
        <span class="hljs-attr">self._started_at</span> = started_at
        <span class="hljs-attr">finished</span> = <span class="hljs-literal">False</span>  <span class="hljs-comment"># 执行完成标记（用于监控）</span>
        <span class="hljs-attr">runtime_connected</span> = <span class="hljs-literal">False</span>  <span class="hljs-comment"># 运行时连接成功标记</span>
        <span class="hljs-attr">restored_state</span> = <span class="hljs-literal">False</span>  <span class="hljs-comment"># 状态恢复标记（会话回放/恢复场景）</span>
        
        <span class="hljs-comment"># 初始化自定义密钥处理器（管理第三方服务密钥）</span>
        <span class="hljs-attr">custom_secrets_handler</span> = UserSecrets(
            <span class="hljs-attr">custom_secrets</span>=custom_secrets if custom_secrets else {}
        )

        try:
            <span class="hljs-comment"># 1. 创建运行时环境（如Docker沙盒）并连接</span>
            <span class="hljs-attr">runtime_connected</span> = await self._create_runtime(
                <span class="hljs-attr">runtime_name</span>=runtime_name,
                <span class="hljs-attr">config</span>=config,
                <span class="hljs-attr">agent</span>=agent,
                <span class="hljs-attr">git_provider_tokens</span>=git_provider_tokens,
                <span class="hljs-attr">custom_secrets</span>=custom_secrets,
                <span class="hljs-attr">selected_repository</span>=selected_repository,
                <span class="hljs-attr">selected_branch</span>=selected_branch,
            )

            <span class="hljs-comment"># 提取仓库目录名（若指定了Git仓库）</span>
            <span class="hljs-attr">repo_directory</span> = None
            if self.runtime and runtime_connected and selected_repository:
                <span class="hljs-attr">repo_directory</span> = selected_repository.split(<span class="hljs-string">'/'</span>)[-<span class="hljs-number">1</span>]  <span class="hljs-comment"># 从仓库地址提取目录名（如"openhands"）</span>

            <span class="hljs-comment"># 2. 配置Git提供商令牌（若有）</span>
            if git_provider_tokens:
                <span class="hljs-attr">provider_handler</span> = ProviderHandler(provider_tokens=git_provider_tokens)
                await provider_handler.set_event_stream_secrets(self.event_stream)  <span class="hljs-comment"># 注入令牌到事件流</span>

            <span class="hljs-comment"># 3. 配置自定义密钥（若有）</span>
            if custom_secrets:
                custom_secrets_handler.set_event_stream_secrets(self.event_stream)  <span class="hljs-comment"># 注入自定义密钥到事件流</span>

            <span class="hljs-comment"># 4. 创建Agent内存（存储会话上下文、仓库信息、会话指令等）</span>
            <span class="hljs-attr">self.memory</span> = await self._create_memory(
                <span class="hljs-attr">selected_repository</span>=selected_repository,
                <span class="hljs-attr">repo_directory</span>=repo_directory,
                <span class="hljs-attr">selected_branch</span>=selected_branch,
                <span class="hljs-attr">conversation_instructions</span>=conversation_instructions,
                <span class="hljs-attr">custom_secrets_descriptions</span>=custom_secrets_handler.get_custom_secrets_descriptions(),  <span class="hljs-comment"># 密钥描述（供Agent参考）</span>
                <span class="hljs-attr">working_dir</span>=config.workspace_mount_path_in_sandbox,  <span class="hljs-comment"># 沙盒中的工作目录路径</span>
            )

            <span class="hljs-comment"># 5. （可选）添加MCP工具到Agent（需运行时已连接且Agent启用MCP）</span>
            if self.runtime and runtime_connected and agent.config.enable_mcp:
                await add_mcp_tools_to_agent(agent, self.runtime, self.memory)

            <span class="hljs-comment"># 6. （可选）执行会话回放（从replay_json恢复历史会话）</span>
            if replay_json:
                <span class="hljs-attr">initial_message</span> = self._run_replay(
                    initial_message,
                    replay_json,
                    agent,
                    config,
                    max_iterations,
                    max_budget_per_task,
                    agent_to_llm_config,
                    agent_configs,
                )
            <span class="hljs-comment"># 7. （正常场景）创建Agent控制器（调度Agent执行流程）</span>
            else:
                self.controller, <span class="hljs-attr">restored_state</span> = self._create_controller(
                    agent,
                    config.security.confirmation_mode,  <span class="hljs-comment"># 安全确认模式（如自动确认/手动确认）</span>
                    max_iterations,
                    <span class="hljs-attr">max_budget_per_task</span>=max_budget_per_task,
                    <span class="hljs-attr">agent_to_llm_config</span>=agent_to_llm_config,
                    <span class="hljs-attr">agent_configs</span>=agent_configs,
                )

            <span class="hljs-comment"># 8. 发送初始事件（根据是否有初始消息设置Agent状态）</span>
            if not self._closed:
                if initial_message:
                    <span class="hljs-comment"># 有初始消息 → 向事件流添加用户消息，设置Agent状态为"运行中"</span>
                    self.event_stream.add_event(initial_message, EventSource.USER)
                    self.event_stream.add_event(
                        ChangeAgentStateAction(AgentState.RUNNING),
                        EventSource.ENVIRONMENT,
                    )
                else:
                    <span class="hljs-comment"># 无初始消息 → 设置Agent状态为"等待用户输入"</span>
                    self.event_stream.add_event(
                        ChangeAgentStateAction(AgentState.AWAITING_USER_INPUT),
                        EventSource.ENVIRONMENT,
                    )
            <span class="hljs-attr">finished</span> = <span class="hljs-literal">True</span>  <span class="hljs-comment"># 标记执行完成</span>

        finally:
            <span class="hljs-attr">self._starting</span> = <span class="hljs-literal">False</span>  <span class="hljs-comment"># 取消启动中标记</span>
            <span class="hljs-comment"># 计算启动结果（是否成功：执行完成且运行时连接成功）</span>
            <span class="hljs-attr">success</span> = finished and runtime_connected
            <span class="hljs-attr">duration</span> = time.time() - started_at  <span class="hljs-comment"># 计算启动耗时</span>

            <span class="hljs-comment"># 日志元数据（用于监控和分析）</span>
            <span class="hljs-comment"># 记录启动结果日志</span>
</code></pre>
<h5 data-id="heading-20">2.4.2 初始化Agent</h5>
<p>_start_agent_loop 会调用 initialize_agent 初始化 Agent。<code>session</code>初始化完成后调用<code>initialize_agent</code>进一步完成agent的其余模块初始化工作，首先创建llm和agent，然后调用<code>agent_session.start()</code>。</p>
<h6 data-id="heading-21">核心作用</h6>
<p><code>initialize_agent</code> 是 OpenHands 框架中 <strong>Agent实例的初始化核心方法</strong>，负责将用户设置、默认配置、第三方服务配置融合为最终运行配置，创建Agent实例并启动Agent会话，是连接配置与Agent运行的关键桥梁，确保Agent具备完成任务所需的所有能力（工具访问、LLM 支持、安全控制等）。</p>
<h6 data-id="heading-22">核心特色</h6>
<ol>
<li><strong>配置融合机制</strong>：用户设置优先于默认配置，支持安全、沙盒、Git、第三方服务等多维度配置的灵活覆盖，兼顾通用性与个性化需求。</li>
<li><strong>模块化压缩器设计</strong>：默认启用三阶段上下文压缩器流水线，按 “对话窗口→浏览器输出→LLM 总结” 顺序优化上下文，平衡上下文相关性与模型输入长度限制。</li>
<li><strong>完整的服务配置</strong>：自动配置 MCP 服务器（Agent与工具的通信枢纽），支持自定义 MCP 配置扩展，适配不同部署环境的工具通信需求。</li>
<li><strong>安全与隐私保护</strong>：敏感信息（如沙盒 API 密钥）通过 <code>get_secret_value()</code> 安全提取，未知错误仅返回错误类型，避免泄露敏感配置。</li>
<li><strong>丰富的扩展参数</strong>：支持 Git 仓库访问、自定义密钥、会话指令等扩展参数，适配代码开发、第三方服务集成等复杂场景。</li>
<li><strong>精细化错误处理</strong>：区分不同类型错误（微Agent验证错误、值错误、未知错误），返回针对性错误信息，便于问题排查。</li>
<li><strong>状态可视化</strong>：初始化开始时发送 <code>AgentState.LOADING</code> 状态事件，让客户端实时感知Agent启动进度，提升用户体验。</li>
</ol>
<h6 data-id="heading-23">初始化流程图</h6>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1849d13820346c391ecc0d36720a4bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg572X6KW_55qE5oCd6ICD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770641966&amp;x-signature=ENGpmDXLZUYRdyNZLvzNbqCR%2FI4%3D" alt="openhands-4.1-3" loading="lazy"/></p>
<p>openhands-4.1-3</p>
<p>initialize_agent 代码如下：</p>
<pre><code class="hljs language-ini" lang="ini">    async def initialize_agent(
        self,
        settings: Settings,  <span class="hljs-comment"># 用户/会话设置（含Agent类型、安全配置等）</span>
        initial_message: Optional<span class="hljs-section">[MessageAction]</span> = None,  <span class="hljs-comment"># 初始用户消息（可选）</span>
        replay_json: Optional<span class="hljs-section">[str]</span> = None,  <span class="hljs-comment"># 会话回放JSON（可选）</span>
    ) -&gt; None:
        """
        初始化Agent核心流程：
        1. 更新会话配置（融合用户设置与默认配置）
        2. 配置MCP服务器（用于工具通信）
        3. 初始化Agent配置（含上下文压缩器）
        4. 创建Agent实例并启动Agent会话
        """
        <span class="hljs-comment"># 1. 发送Agent状态变更事件：标记为"加载中"</span>
        self.agent_session.event_stream.add_event(
            AgentStateChangedObservation('', AgentState.LOADING),
            EventSource.ENVIRONMENT,  <span class="hljs-comment"># 事件来源：环境</span>
        )

        <span class="hljs-comment"># 2. 融合用户设置与默认配置（用户设置优先）</span>
        <span class="hljs-comment"># 确定Agent类型（用户设置优先，否则用默认）</span>
        <span class="hljs-attr">agent_cls</span> = settings.agent or self.config.default_agent
        
        <span class="hljs-comment"># 安全配置：确认模式（用户设置优先）</span>
        <span class="hljs-attr">self.config.security.confirmation_mode</span> = (
            self.config.security.confirmation_mode
            if settings.confirmation_mode is None
            else settings.confirmation_mode
        )
        
        <span class="hljs-comment"># 安全配置：安全分析器（用户设置优先）</span>
        <span class="hljs-attr">self.config.security.security_analyzer</span> = (
            self.config.security.security_analyzer
            if settings.security_analyzer is None
            else settings.security_analyzer
        )
        
        <span class="hljs-comment"># 沙盒配置：基础容器镜像（用户设置优先）</span>
        <span class="hljs-attr">self.config.sandbox.base_container_image</span> = (
            settings.sandbox_base_container_image
            or self.config.sandbox.base_container_image
        )
        
        <span class="hljs-comment"># 沙盒配置：运行时容器镜像（用户设置优先，逻辑：基础镜像或运行时镜像有一个设置则用用户值）</span>
        <span class="hljs-attr">self.config.sandbox.runtime_container_image</span> = (
            settings.sandbox_runtime_container_image
            if settings.sandbox_base_container_image
            or settings.sandbox_runtime_container_image
            else self.config.sandbox.runtime_container_image
        )

        <span class="hljs-comment"># 3. Git配置：若用户设置提供，覆盖默认值</span>
        <span class="hljs-attr">git_user_name</span> = getattr(settings, <span class="hljs-string">'git_user_name'</span>, None)
        if git_user_name is not None:
            <span class="hljs-attr">self.config.git_user_name</span> = git_user_name
        <span class="hljs-attr">git_user_email</span> = getattr(settings, <span class="hljs-string">'git_user_email'</span>, None)
        if git_user_email is not None:
            <span class="hljs-attr">self.config.git_user_email</span> = git_user_email
        
        <span class="hljs-comment"># 4. 任务配置：最大迭代次数（用户设置优先）</span>
        <span class="hljs-attr">max_iterations</span> = settings.max_iterations or self.config.max_iterations
        
        <span class="hljs-comment"># 5. 任务配置：单任务最大预算（用户设置优先，支持None值）</span>
        <span class="hljs-attr">max_budget_per_task</span> = (
            settings.max_budget_per_task
            if settings.max_budget_per_task is not None
            else self.config.max_budget_per_task
        )

        <span class="hljs-comment"># 6. 第三方服务配置：搜索API密钥、沙盒API密钥</span>
        <span class="hljs-attr">self.config.search_api_key</span> = settings.search_api_key
        if settings.sandbox_api_key:
            <span class="hljs-comment"># 提取沙盒API密钥的实际值（get_secret_value()用于安全存储的密钥）</span>
            <span class="hljs-attr">self.config.sandbox.api_key</span> = settings.sandbox_api_key.get_secret_value()

        <span class="hljs-comment"># 7. MCP服务器配置（用于Agent与工具的通信）</span>
        
        <span class="hljs-comment"># 若用户设置提供自定义MCP配置，合并到全局配置</span>
        <span class="hljs-attr">mcp_config</span> = getattr(settings, <span class="hljs-string">'mcp_config'</span>, None)
        if mcp_config is not None:
            <span class="hljs-attr">self.config.mcp</span> = self.config.mcp.merge(mcp_config)
        
        <span class="hljs-comment"># 默认添加OpenHands的MCP服务器（HTTP + STDIO类型）</span>
        openhands_mcp_server, <span class="hljs-attr">openhands_mcp_stdio_servers</span> = (
            OpenHandsMCPConfigImpl.create_default_mcp_server_config(
                self.config.mcp_host, self.config, self.user_id
            )
        )
        if openhands_mcp_server:
            self.config.mcp.shttp_servers.append(openhands_mcp_server)
            self.config.mcp.stdio_servers.extend(openhands_mcp_stdio_servers)

        <span class="hljs-comment"># 8. Agent配置初始化</span>
        <span class="hljs-comment"># 获取指定Agent类型的配置</span>
        <span class="hljs-attr">agent_config</span> = self.config.get_agent_config(agent_cls)
        <span class="hljs-comment"># 传递运行时信息到Agent配置（用于工具的运行时特定行为）</span>
        <span class="hljs-attr">agent_config.runtime</span> = self.config.runtime
        <span class="hljs-comment"># 获取Agent对应的LLM配置</span>
        <span class="hljs-attr">agent_name</span> = agent_cls if agent_cls is not None else <span class="hljs-string">'agent'</span>
        <span class="hljs-attr">llm_config</span> = self.config.get_llm_config_from_agent(agent_name)
        
        <span class="hljs-comment"># 若启用默认上下文压缩器，配置压缩器流水线</span>
        if settings.enable_default_condenser:
            """
            默认压缩器流水线包含三个阶段（顺序重要）：
            1. 对话窗口压缩器：处理显式的压缩请求
            2. 浏览器输出压缩器：限制浏览器观察结果的大小（注意力窗口=2）
            3. LLM总结压缩器：限制传递给LLM的上下文大小
            顺序设计原因：先处理浏览器输出，可减少总结成本（仅保留最新浏览器输出）
            """
            <span class="hljs-attr">max_events_for_condenser</span> = settings.condenser_max_size or <span class="hljs-number">120</span>  <span class="hljs-comment"># 压缩器最大事件数（默认120）</span>
            <span class="hljs-attr">default_condenser_config</span> = CondenserPipelineConfig(
                <span class="hljs-attr">condensers</span>=[
                    ConversationWindowCondenserConfig(),
                    BrowserOutputCondenserConfig(attention_window=<span class="hljs-number">2</span>),
                    LLMSummarizingCondenserConfig(
                        llm_config=llm_config,
                        keep_first=<span class="hljs-number">4</span>,  <span class="hljs-comment"># 保留前4个事件（不压缩）</span>
                        max_size=max_events_for_condenser,  <span class="hljs-comment"># 压缩后最大事件数</span>
                    ),
                ]
            )

            <span class="hljs-attr">agent_config.condenser</span> = default_condenser_config
        
        <span class="hljs-comment"># 9. 创建Agent实例（通过Agent工厂方法获取对应类型的Agent类）</span>
        <span class="hljs-attr">agent</span> = Agent.get_cls(agent_cls)(agent_config, self.llm_registry)

        <span class="hljs-comment"># 10. 绑定LLM重试监听器（Agent会话中LLM重试时触发通知）</span>
        <span class="hljs-attr">self.llm_registry.retry_listener</span> = self._notify_on_llm_retry

        <span class="hljs-comment"># 11. 提取ConversationInitData类型设置中的扩展参数（若适用）</span>
        <span class="hljs-attr">git_provider_tokens</span> = None  <span class="hljs-comment"># Git提供商令牌（用于代码仓库访问）</span>
        <span class="hljs-attr">selected_repository</span> = None  <span class="hljs-comment"># 选中的代码仓库</span>
        <span class="hljs-attr">selected_branch</span> = None  <span class="hljs-comment"># 选中的仓库分支</span>
        <span class="hljs-attr">custom_secrets</span> = None  <span class="hljs-comment"># 自定义密钥（用于第三方服务访问）</span>
        <span class="hljs-attr">conversation_instructions</span> = None  <span class="hljs-comment"># 会话指令（自定义Agent行为）</span>
        if isinstance(settings, ConversationInitData):
            <span class="hljs-attr">git_provider_tokens</span> = settings.git_provider_tokens
            <span class="hljs-attr">selected_repository</span> = settings.selected_repository
            <span class="hljs-attr">selected_branch</span> = settings.selected_branch
            <span class="hljs-attr">custom_secrets</span> = settings.custom_secrets
            <span class="hljs-attr">conversation_instructions</span> = settings.conversation_instructions

        <span class="hljs-comment"># 12. 启动Agent会话（核心步骤）</span>
        try:
            await self.agent_session.start(
                <span class="hljs-attr">runtime_name</span>=self.config.runtime,  <span class="hljs-comment"># 运行时名称（如沙盒类型）</span>
                <span class="hljs-attr">config</span>=self.config,  <span class="hljs-comment"># 完整配置</span>
                <span class="hljs-attr">agent</span>=agent,  <span class="hljs-comment"># Agent实例</span>
                <span class="hljs-attr">max_iterations</span>=max_iterations,  <span class="hljs-comment"># 最大迭代次数</span>
                <span class="hljs-attr">max_budget_per_task</span>=max_budget_per_task,  <span class="hljs-comment"># 单任务最大预算</span>
                <span class="hljs-attr">agent_to_llm_config</span>=self.config.get_agent_to_llm_config_map(),  <span class="hljs-comment"># Agent-LLM配置映射</span>
                <span class="hljs-attr">agent_configs</span>=self.config.get_agent_configs(),  <span class="hljs-comment"># 所有Agent配置</span>
                <span class="hljs-attr">git_provider_tokens</span>=git_provider_tokens,  <span class="hljs-comment"># Git令牌</span>
                <span class="hljs-attr">custom_secrets</span>=custom_secrets,  <span class="hljs-comment"># 自定义密钥</span>
                <span class="hljs-attr">selected_repository</span>=selected_repository,  <span class="hljs-comment"># 选中仓库</span>
                <span class="hljs-attr">selected_branch</span>=selected_branch,  <span class="hljs-comment"># 选中分支</span>
                <span class="hljs-attr">initial_message</span>=initial_message,  <span class="hljs-comment"># 初始用户消息</span>
                <span class="hljs-attr">conversation_instructions</span>=conversation_instructions,  <span class="hljs-comment"># 会话指令</span>
                <span class="hljs-attr">replay_json</span>=replay_json,  <span class="hljs-comment"># 会话回放数据</span>
            )
        except MicroagentValidationError as e:
            <span class="hljs-comment"># 微Agent验证错误：输出详细错误信息（帮助用户排查配置问题）</span>
            return
        except ValueError as e:
            <span class="hljs-comment"># 值错误：区分微Agent相关错误和普通值错误</span>
            self.logger.exception(f"创建Agent会话失败: {e}")
            <span class="hljs-attr">error_message</span> = str(e)
            return
        except Exception as e:
            <span class="hljs-comment"># 其他未知错误：仅输出错误类型（避免泄露敏感信息）</span>

            return
</code></pre>
<h4 data-id="heading-24">2.4 用户交互(oh_user_action)逻辑</h4>
<h5 data-id="heading-25">2.4.1 用户发消息</h5>
<p>当用户发消息，就是通过<code>socket</code>在 oh_user_action 函数通过<code>conversation_manager</code>向事件中心中添加一条事件。代码位于 openhands\server\listen_socket.py。</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@sio.event</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">oh_user_action</span>(<span class="hljs-params">connection_id: <span class="hljs-built_in">str</span>, data: <span class="hljs-built_in">dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]</span>) -&gt; <span class="hljs-literal">None</span>:
    <span class="hljs-keyword">await</span> conversation_manager.send_to_event_stream(connection_id, data)
</code></pre>
<p>旧API 会调用到这里。</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@sio.event</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">oh_action</span>(<span class="hljs-params">connection_id: <span class="hljs-built_in">str</span>, data: <span class="hljs-built_in">dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]</span>) -&gt; <span class="hljs-literal">None</span>:
    <span class="hljs-comment"># <span class="hljs-doctag">TODO:</span> Remove this handler once all clients are updated to use oh_user_action</span>
    <span class="hljs-comment"># Keeping for backward compatibility with in-progress sessions</span>
    <span class="hljs-keyword">await</span> conversation_manager.send_to_event_stream(connection_id, data)
</code></pre>
<h5 data-id="heading-26">2.4.2 事件添加</h5>
<p>send_to_event_stream 位于 openhands\server\conversation_manager\standalone_conversation_manager.py。最终调用到 session.dispatch 向事件流发送事件。</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">send_to_event_stream</span>(<span class="hljs-params">self, connection_id: <span class="hljs-built_in">str</span>, data: <span class="hljs-built_in">dict</span></span>):
        <span class="hljs-comment"># If there is a local session running, send to that</span>
        sid = self._local_connection_id_to_session_id.get(connection_id)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> sid:
            <span class="hljs-keyword">raise</span> RuntimeError(<span class="hljs-string">f'no_connected_session:<span class="hljs-subst">{connection_id}</span>'</span>)
        <span class="hljs-keyword">await</span> self.send_event_to_conversation(sid, data)

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">send_event_to_conversation</span>(<span class="hljs-params">self, sid: <span class="hljs-built_in">str</span>, data: <span class="hljs-built_in">dict</span></span>):
        session = self._local_agent_loops_by_sid.get(sid)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> session:
            <span class="hljs-keyword">raise</span> RuntimeError(<span class="hljs-string">f'no_conversation:<span class="hljs-subst">{sid}</span>'</span>)
        <span class="hljs-keyword">await</span> session.dispatch(data)
</code></pre>
<p>dispatch 代码如下。</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">dispatch</span>(<span class="hljs-params">self, data: <span class="hljs-built_in">dict</span></span>) -&gt; <span class="hljs-literal">None</span>:
    <span class="hljs-comment"># ...</span>
    self.agent_session.event_stream.add_event(event, EventSource.USER)
</code></pre>
<h5 data-id="heading-27">2.4.3 事件处理</h5>
<p>当一条事件被加入系统的事件流后，究竟会触发哪些模块的响应？要解答这个问题，我们首先需要梳理系统中已订阅事件流的核心模块 —— 它们就像时刻待命的接收者，各自守在专属的消息通道旁：Session 模块订阅了 SERVER 通道，Runtime 模块对应 RUNTIME 通道，Memory 模块监听着 MEMORY 通道，而 AgentController 模块则聚焦于 AGENT_CONTROLLER 通道。</p>
<p>当用户发送一条消息并进入事件流后，这条消息会以广播的形式扩散到所有订阅通道，各个模块会通过预先注册的回调函数启动相应处理流程，具体流程如下：</p>
<p>AgentController 模块会在 _on_event 函数里面处理。</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">_on_event</span>(<span class="hljs-params">self, event: Event</span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(event, <span class="hljs-string">'hidden'</span>) <span class="hljs-keyword">and</span> event.hidden:
            <span class="hljs-keyword">return</span>

        self.state_tracker.add_history(event)

        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(event, Action):
            <span class="hljs-keyword">await</span> self._handle_action(event)
        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">isinstance</span>(event, Observation):
            <span class="hljs-keyword">await</span> self._handle_observation(event)

        should_step = self.should_step(event)
        <span class="hljs-keyword">if</span> should_step:
            self.log(
                <span class="hljs-string">'debug'</span>,
                <span class="hljs-string">f'Stepping agent after event: <span class="hljs-subst">{<span class="hljs-built_in">type</span>(event).__name__}</span>'</span>,
                extra={<span class="hljs-string">'msg_type'</span>: <span class="hljs-string">'STEPPING_AGENT'</span>},
            )
            <span class="hljs-keyword">await</span> self._step_with_exception_handling()
        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">isinstance</span>(event, MessageAction) <span class="hljs-keyword">and</span> event.source == EventSource.USER:
            <span class="hljs-comment"># If we received a user message but aren't stepping, log why</span>
            self.log(
                <span class="hljs-string">'warning'</span>,
                <span class="hljs-string">f'Not stepping agent after user message. Current state: <span class="hljs-subst">{self.get_agent_state()}</span>'</span>,
                extra={<span class="hljs-string">'msg_type'</span>: <span class="hljs-string">'NOT_STEPPING_AFTER_USER_MESSAGE'</span>},
            )
</code></pre>
<p>_handle_action 会调用 _handle_message_action。</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">_handle_action</span>(<span class="hljs-params">self, action: Action</span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-string">"""Handles an Action from the agent or delegate."""</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(action, ChangeAgentStateAction):
            <span class="hljs-keyword">await</span> self.set_agent_state_to(action.agent_state)  <span class="hljs-comment"># type: ignore</span>
        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">isinstance</span>(action, MessageAction):
            <span class="hljs-keyword">await</span> self._handle_message_action(action)
        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">isinstance</span>(action, AgentDelegateAction):
            <span class="hljs-keyword">await</span> self.start_delegate(action)
            <span class="hljs-keyword">assert</span> self.delegate <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>
            <span class="hljs-comment"># Post a MessageAction with the task for the delegate</span>
            <span class="hljs-keyword">if</span> <span class="hljs-string">'task'</span> <span class="hljs-keyword">in</span> action.inputs:
                self.event_stream.add_event(
                    MessageAction(content=<span class="hljs-string">'TASK: '</span> + action.inputs[<span class="hljs-string">'task'</span>]),
                    EventSource.USER,
                )
                <span class="hljs-keyword">await</span> self.delegate.set_agent_state_to(AgentState.RUNNING)
            <span class="hljs-keyword">return</span>

        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">isinstance</span>(action, AgentFinishAction):
            self.state.outputs = action.outputs
            <span class="hljs-keyword">await</span> self.set_agent_state_to(AgentState.FINISHED)
        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">isinstance</span>(action, AgentRejectAction):
            self.state.outputs = action.outputs
            <span class="hljs-keyword">await</span> self.set_agent_state_to(AgentState.REJECTED)
</code></pre>
<p>_handle_message_action 中，AgentController 模块会生成一条 RecallAction 事件并再次推入事件流，该事件的类型会根据当前是否为用户首次输入来判定：若是首次输入则设为 RecallType.WORKSPACE_CONTEXT，反之则设为 RecallType.KNOWLEDGE；</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">_handle_message_action</span>(<span class="hljs-params">self, action: MessageAction</span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-string">"""Handles message actions from the event stream.

        Args:
            action (MessageAction): The message action to handle.
        """</span>
        <span class="hljs-keyword">if</span> action.source == EventSource.USER:
            <span class="hljs-comment"># Use info level if LOG_ALL_EVENTS is set</span>
            log_level = (
                <span class="hljs-string">'info'</span> <span class="hljs-keyword">if</span> os.getenv(<span class="hljs-string">'LOG_ALL_EVENTS'</span>) <span class="hljs-keyword">in</span> (<span class="hljs-string">'true'</span>, <span class="hljs-string">'1'</span>) <span class="hljs-keyword">else</span> <span class="hljs-string">'debug'</span>
            )
            self.log(
                log_level,
                <span class="hljs-built_in">str</span>(action),
                extra={<span class="hljs-string">'msg_type'</span>: <span class="hljs-string">'ACTION'</span>, <span class="hljs-string">'event_source'</span>: EventSource.USER},
            )

            <span class="hljs-comment"># if this is the first user message for this agent, matters for the microagent info type</span>
            first_user_message = self._first_user_message()
            is_first_user_message = (
                action.<span class="hljs-built_in">id</span> == first_user_message.<span class="hljs-built_in">id</span> <span class="hljs-keyword">if</span> first_user_message <span class="hljs-keyword">else</span> <span class="hljs-literal">False</span>
            )
            recall_type = (
                RecallType.WORKSPACE_CONTEXT
                <span class="hljs-keyword">if</span> is_first_user_message
                <span class="hljs-keyword">else</span> RecallType.KNOWLEDGE
            )

            recall_action = RecallAction(query=action.content, recall_type=recall_type)
            self._pending_action = recall_action
            <span class="hljs-comment"># this is source=USER because the user message is the trigger for the microagent retrieval</span>
            self.event_stream.add_event(recall_action, EventSource.USER)

            <span class="hljs-keyword">if</span> self.get_agent_state() != AgentState.RUNNING:
                <span class="hljs-keyword">await</span> self.set_agent_state_to(AgentState.RUNNING)

        <span class="hljs-keyword">elif</span> action.source == EventSource.AGENT:
            <span class="hljs-comment"># If the agent is waiting for a response, set the appropriate state</span>
            <span class="hljs-keyword">if</span> action.wait_for_response:
                <span class="hljs-keyword">await</span> self.set_agent_state_to(AgentState.AWAITING_USER_INPUT)
</code></pre>
<p>AgentController 模块会在 _on_event 函数里面调用 agent.step 方法，启动智能体的核心处理流程。</p>
<p>这里的 agent.step 的具体逻辑取决于配置文件中指定的智能体类型。以常见的 CodeActAgent 为例，该方法会指向 OpenHands/openhands/agenthub/codeact_agent/codeact_agent.py 中的 step 函数。最终将整理后的信息转化为符合大语言模型输入格式的 messages。</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">step</span>(<span class="hljs-params">self, state: State</span>) -&gt; <span class="hljs-string">'Action'</span>:
        <span class="hljs-string">"""Performs one step using the CodeAct Agent.

        This includes gathering info on previous steps and prompting the model to make a command to execute.

        Parameters:
        - state (State): used to get updated info

        Returns:
        - CmdRunAction(command) - bash command to run
        - IPythonRunCellAction(code) - IPython code to run
        - AgentDelegateAction(agent, inputs) - delegate action for (sub)task
        - MessageAction(content) - Message action to run (e.g. ask for clarification)
        - AgentFinishAction() - end the interaction
        - CondensationAction(...) - condense conversation history by forgetting specified events and optionally providing a summary
        - FileReadAction(path, ...) - read file content from specified path
        - FileEditAction(path, ...) - edit file using LLM-based (deprecated) or ACI-based editing
        - AgentThinkAction(thought) - log agent's thought/reasoning process
        - CondensationRequestAction() - request condensation of conversation history
        - BrowseInteractiveAction(browser_actions) - interact with browser using specified actions
        - MCPAction(name, arguments) - interact with MCP server tools
        """</span>
        <span class="hljs-comment"># Continue with pending actions if any</span>
        <span class="hljs-keyword">if</span> self.pending_actions:
            <span class="hljs-keyword">return</span> self.pending_actions.popleft()

        <span class="hljs-comment"># if we're done, go back</span>
        latest_user_message = state.get_last_user_message()
        <span class="hljs-keyword">if</span> latest_user_message <span class="hljs-keyword">and</span> latest_user_message.content.strip() == <span class="hljs-string">'/exit'</span>:
            <span class="hljs-keyword">return</span> AgentFinishAction()

        <span class="hljs-comment"># Condense the events from the state. If we get a view we'll pass those</span>
        <span class="hljs-comment"># to the conversation manager for processing, but if we get a condensation</span>
        <span class="hljs-comment"># event we'll just return that instead of an action. The controller will</span>
        <span class="hljs-comment"># immediately ask the agent to step again with the new view.</span>
        condensed_history: <span class="hljs-built_in">list</span>[Event] = []
        <span class="hljs-keyword">match</span> self.condenser.condensed_history(state):
            <span class="hljs-keyword">case</span> View(events=events):
                condensed_history = events

            <span class="hljs-keyword">case</span> Condensation(action=condensation_action):
                <span class="hljs-keyword">return</span> condensation_action

        initial_user_message = self._get_initial_user_message(state.history)
        messages = self._get_messages(condensed_history, initial_user_message)
        params: <span class="hljs-built_in">dict</span> = {
            <span class="hljs-string">'messages'</span>: messages,
        }
        params[<span class="hljs-string">'tools'</span>] = check_tools(self.tools, self.llm.config)
        params[<span class="hljs-string">'extra_body'</span>] = {
            <span class="hljs-string">'metadata'</span>: state.to_llm_metadata(
                model_name=self.llm.config.model, agent_name=self.name
            )
        }
        response = self.llm.completion(**params)
        logger.debug(<span class="hljs-string">f'Response from LLM: <span class="hljs-subst">{response}</span>'</span>)
        actions = self.response_to_actions(response)
        logger.debug(<span class="hljs-string">f'Actions after response_to_actions: <span class="hljs-subst">{actions}</span>'</span>)
        <span class="hljs-keyword">for</span> action <span class="hljs-keyword">in</span> actions:
            self.pending_actions.append(action)
        <span class="hljs-keyword">return</span> self.pending_actions.popleft()
</code></pre>
<p>当大语言模型处理完成并返回结果后，该结果会被封装成 Action 对象重新送入事件流。假设模型直接返回了 MessageAction 类型的结果，Session 模块便会捕获这条事件，并将其中的内容转发至前端界面，完成向用户的反馈展示。</p>
<h3 data-id="heading-28">0xFF 参考</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.all-hands.dev%2Fopenhands%2Fusage%2Farchitecture%2Fbackend" target="_blank" title="https://docs.all-hands.dev/openhands/usage/architecture/backend" ref="nofollow noopener noreferrer">docs.all-hands.dev/openhands/u…</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1936485868761257658" target="_blank" title="https://zhuanlan.zhihu.com/p/1936485868761257658" ref="nofollow noopener noreferrer">当AI Agent从“玩具”走向“工具”，我们该关注什么？Openhands架构解析【第二篇：Agent 相关核心概念】</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.zhihu.com%2Fpeople%2Fdreamrenderx" target="_blank" title="https://www.zhihu.com/people/dreamrenderx" ref="nofollow noopener noreferrer">克里</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1936175201323825087" target="_blank" title="https://zhuanlan.zhihu.com/p/1936175201323825087" ref="nofollow noopener noreferrer">当AI Agent从“玩具”走向“工具”，我们该关注什么？Openhands架构解析【第一篇：系列导读】</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.zhihu.com%2Fpeople%2Fdreamrenderx" target="_blank" title="https://www.zhihu.com/people/dreamrenderx" ref="nofollow noopener noreferrer">克里</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1940436682949244630" target="_blank" title="https://zhuanlan.zhihu.com/p/1940436682949244630" ref="nofollow noopener noreferrer">Coding Agent之Openhands解析(含代码)</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.zhihu.com%2Fpeople%2Fwu-long-ming-cha-56" target="_blank" title="https://www.zhihu.com/people/wu-long-ming-cha-56" ref="nofollow noopener noreferrer">Arrow</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1940824548485347192" target="_blank" title="https://zhuanlan.zhihu.com/p/1940824548485347192" ref="nofollow noopener noreferrer">OpenHands 源码解读</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.zhihu.com%2Fpeople%2Fxiao-hui-66-72" target="_blank" title="https://www.zhihu.com/people/xiao-hui-66-72" ref="nofollow noopener noreferrer">一力辉</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fadk.wiki%2F" target="_blank" title="https://adk.wiki/" ref="nofollow noopener noreferrer">adk.wiki/</a></p>
<p>本文使用 <a href="https://link.juejin.cn?target=https%3A%2F%2Fmarkdown.com.cn" target="_blank" title="https://markdown.com.cn" ref="nofollow noopener noreferrer">markdown.com.cn</a> 排版</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[阿里Qoder实测：当AI拥有了“开发者思维”，Cursor的王座还稳吗？]]></title>    <link>https://juejin.cn/post/7602072073134653467</link>    <guid>https://juejin.cn/post/7602072073134653467</guid>    <pubDate>2026-02-02T13:00:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602072073134653467" data-draft-id="7601929765533548595" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="阿里Qoder实测：当AI拥有了“开发者思维”，Cursor的王座还稳吗？"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2026-02-02T13:00:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="墨风如雪"/> <meta itemprop="url" content="https://juejin.cn/user/4064249017803927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            阿里Qoder实测：当AI拥有了“开发者思维”，Cursor的王座还稳吗？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4064249017803927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    墨风如雪
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T13:00:06.000Z" title="Mon Feb 02 2026 13:00:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在这个AI编程工具卷生卷死的2026年开春，阿里悄无声息地扔下了一枚深水炸弹。</p>
<p>就在昨天，2月1日，Qoder平台正式上线了其首个深度定制模型——<strong>Qwen-Coder-Qoder</strong>。作为一名长期关注AI代码生成领域的观察者，我第一时间扒开了这次更新的底座，试图搞清楚一件事：这仅仅是又一个套壳的聊天机器人，还是真正能撼动Cursor Composer统治地位的“新物种”？</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F02%2F640-1024x576.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/02/640-1024x576.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c8d0d64851a84e73ba233509f8920c18~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770642006&amp;x-signature=u7bvLVAnWhXZy9anHVhZnXvW7qA%3D" alt="640" loading="lazy"/></a></p>
<h3 data-id="heading-0">从“辅助”到“委托”的质变</h3>
<p>先说最直观的感受。过去我们用AI写代码，本质上是在“补全”。你写上半句，它猜下半句。但Qoder这次不仅是发布一个IDE，而是彻底贯彻了“Agent（智能体）”的概念。</p>
<p>这次上线的Qwen-Coder-Qoder模型，并不是通用的Qwen3-Coder拿来直接用，而是针对Qoder的Agent框架进行了大规模的专项特训。官方把它称为完成了“模型-智能体-产品”的闭环。</p>
<p>这意味着什么？意味着在Qoder的<strong>Quest模式</strong>下，你不再是盯着光标等待补全，而是像给同事派活一样，用自然语言描述一个复杂需求。AI会自己拆解任务、规划路径、编写代码、运行测试，甚至在Windows终端里敲命令验证。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F02%2Fagfdgsdfg-1024x1024.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/02/agfdgsdfg-1024x1024.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f4a5c06305ba4cd0b4469e8882b051ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770642006&amp;x-signature=vq%2B5JqWf0HzA03oKQ18KsSvXvcU%3D" alt="agfdgsdfg" loading="lazy"/></a></p>
<h3 data-id="heading-1">数据背后的“工程师直觉”</h3>
<p>为了验证这个“定制版”到底强在哪，我们来看几组官方披露但尚未被大肆宣传的硬核数据。</p>
<p>最让我惊讶的不是它在常规代码生成上的表现，而是它对<strong>Windows终端命令的准确率</strong>。官方宣称这一数据相比同类竞品领先了整整<strong>50%</strong>。只要在Windows环境下折腾过PowerShell和CMD配置的开发者都知道，这其实是一个巨大的痛点，很多通用模型在这里经常“幻觉”频出。能在这个细节上死磕，说明Qoder团队确实在解决真实工程里的脏活累活。</p>
<p>另一个引人注目的数据是<strong>任务解决率</strong>。在Qoder内部的真实软件工程评测集上，这个新模型的表现已经超过了目前的行业标杆Cursor Composer-1。</p>
<p>这得益于它独特的训练方式。Qoder没有单纯堆砌代码量，而是引入了一套<strong>ROLL大规模强化学习框架</strong>。他们甚至设计了一个“Rewarder-Attacker”的对抗机制，像左右互搏一样，防止模型为了骗取奖励而生成看似正确实则无效的“垃圾代码”。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F02%2Fasdfasgddr-1024x576.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/02/asdfasgddr-1024x576.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d2d0c4eb430948628092144e59310e28~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770642006&amp;x-signature=2TZGdQjux%2Fe%2BItba3iMwtW3uaVg%3D" alt="asdfasgddr" loading="lazy"/></a></p>
<h3 data-id="heading-2">像老员工一样理解项目</h3>
<p>除了硬碰硬的代码能力，Qoder最吸引我的其实是它的<strong>Repo Wiki</strong>功能。</p>
<p>大家都有过接手遗留代码库的痛苦经历吧？Qoder试图解决的就是这个问题。它不是读死书，而是能自动分析项目结构，生成一份结构化的知识库。当它开始写代码时，它拥有的是全局视野，不仅知道当前文件的逻辑，还知道如何调用十个文件夹之外的工具类。</p>
<p>这种“长期记忆”和“上下文理解”能力的提升，直接反映在了效能数据上：在真实用户测试中，工具异常率下降了61.5%，而代码留存率提升了3.85%。别小看这不到4%的提升，在百万行代码的量级下，这意味着开发者少删了几千行AI写的废话。</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F02%2Ffasdfsdf-1024x576.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/02/fasdfsdf-1024x576.webp" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dd2f4efe271b41069028d6b55967842e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770642006&amp;x-signature=IebqC3aHpdJXFVORAE4kZ8JWJkg%3D" alt="fasdfsdf" loading="lazy"/></a></p>
<h3 data-id="heading-3">试用建议</h3>
<p>目前Qoder已经覆盖了全平台，无论你喜欢独立的IDE，还是离不开JetBrains全家桶，甚至是硬核的命令行CLI党，都能找到对应的入口。</p>
<p>最关键的是，<strong>从2月1日到2月15日</strong>，官方开启了限时免费试用。虽然标准版定价是20美元/月，但在犹豫要不要掏腰包之前，我强烈建议你利用这半个月的窗口期，把手头最棘手、逻辑最复杂的那个烂尾项目丢给它试试。</p>
<p>看看当AI开始真正具备“开发者思维”时，你的编程体验会发生怎样的改变。毕竟，在2026年，我们需要的不再是一个只会打字的助手，而是一个能真正扛事的搭档。</p>
<p><strong>如果你也对最新的AI信息感兴趣或者有疑问 都可以加入我的大家庭 第一时间分享最新AI资讯、工具、教程、文档 欢迎你的加入！！！😉😉😉</strong></p>
<p>公众号：墨风如雪小站</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[anthropic-academy：提示词工程技巧]]></title>    <link>https://juejin.cn/post/7602091087922724914</link>    <guid>https://juejin.cn/post/7602091087922724914</guid>    <pubDate>2026-02-02T11:41:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602091087922724914" data-draft-id="7602070768961978394" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="anthropic-academy：提示词工程技巧"/> <meta itemprop="keywords" content="人工智能"/> <meta itemprop="datePublished" content="2026-02-02T11:41:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="mwq30123"/> <meta itemprop="url" content="https://juejin.cn/user/3403743729030686"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            anthropic-academy：提示词工程技巧
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3403743729030686/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    mwq30123
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T11:41:02.000Z" title="Mon Feb 02 2026 11:41:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读16分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">提示词工程</h2>
<p>提示词工程是指对已编写的提示进行改进，以获得更可靠、更高质量的输出。这一过程涉及迭代优化——从基础词提示开始，评估其表现，然后系统性地应用工程技术来改进它。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34fd3e2cbf4c488b9fa1d015794462cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbXdxMzAxMjM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770637262&amp;x-signature=Ty69beByi9G3UE4bILGOtWDEZag%3D" alt="img" loading="lazy"/></p>
<h3 data-id="heading-1">迭代改进过程</h3>
<p>这种方法遵循一个清晰的循环，你可以反复执行直到达到预期效果：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bef83079978d48b89148db7c9d984283~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbXdxMzAxMjM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770637262&amp;x-signature=aRxARgsXfaSqSdKwVaN5hGpDVvU%3D" alt="" loading="lazy"/>1. <strong>设定目标</strong> - 明确你希望提示词实现什么目的</p>
<ol>
<li><strong>编写初始提示词</strong> - 创建一个基本的初步尝试</li>
<li><strong>评估提示词</strong> - 根据你的标准进行测试</li>
<li><strong>应用提示词工程技术</strong> - 使用特定方法来提升性能</li>
<li><strong>重新评估</strong> - 验证你的修改是否确实改善了结果</li>
</ol>
<p>重复最后两个步骤，直到你对性能感到满意为止。每次迭代都应在评估分数上显示出可衡量的改进。</p>
<h4 data-id="heading-2">搭建你的评估流程</h4>
<p>为了演示这个过程，我们将通过一个实际案例来进行：创建一个为运动员生成单日膳食计划的提示词。该提示词需要考虑运动员的身高、体重、目标和饮食限制，然后生成一份全面的膳食计划。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c8ceab1a87c4e2aac0bdf7c6c2e705d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbXdxMzAxMjM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770637262&amp;x-signature=JuagmmyGgMkEiBFoRzYp4OleQ6E%3D" alt="" loading="lazy"/>评估设置使用 PromptEvaluator 类来处理数据集生成和模型评分。创建评估器实例时，可以通过 max_concurrent_tasks 参数控制并发数：</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">evaluator</span> = PromptEvaluator(max_concurrent_tasks=<span class="hljs-number">5</span>)
</code></pre>
<p>从较低的并发值（如 3）开始，以避免速率限制错误。如果您的 API 配额允许更快的处理速度，可以适当增加该值。</p>
<h4 data-id="heading-3">生成测试数据</h4>
<p>评估系统可以根据你的提示词要求自动生成测试用例。你需要定义提示词所需的输入：</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">dataset</span> = evaluator.generate_dataset(
    <span class="hljs-attr">task_description</span>=<span class="hljs-string">"为一名运动员编写一份紧凑、简洁的一日膳食计划"</span>,
    <span class="hljs-attr">prompt_inputs_spec</span>={
        "height": "运动员的身高（单位：厘米）",
        "weight": "运动员的体重（单位：千克）",
        "goal": "运动员的目标",
        "restrictions": "运动员的饮食限制",
    },
    <span class="hljs-attr">output_file</span>=<span class="hljs-string">"dataset.json"</span>,
    <span class="hljs-attr">num_cases</span>=<span class="hljs-number">2</span>,
)
</code></pre>
<p>在开发过程中保持较少的测试用例数量（2-3个）以加快迭代周期。最终验证时可以增加数量。</p>
<h4 data-id="heading-4">编写初始提示</h4>
<p>从一个简单、朴素的提示词开始，建立基准线。以下是一个刻意设计的基础初次尝试示例：</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-function">def <span class="hljs-title">run_prompt1</span><span class="hljs-params">(prompt_inputs)</span>:
    prompt =</span> f<span class="hljs-string">""</span><span class="hljs-string">"
    为一名运动员生成一份符合其饮食限制的一日膳食计划。

    - 身高: {prompt_inputs["</span>height<span class="hljs-string">"]} 
    - 体重: {prompt_inputs["</span>weight<span class="hljs-string">"]} 
    - 目标: {prompt_inputs["</span>goal<span class="hljs-string">"]} 
    - 饮食限制: {prompt_inputs["</span>restrictions<span class="hljs-string">"]} 

    "</span><span class="hljs-string">""</span>
    messages = []
    <span class="hljs-built_in">add_user_message</span>(messages, prompt)
    text = <span class="hljs-built_in">chat</span>(messages, max_tokens=<span class="hljs-number">4000</span>)
    <span class="hljs-built_in">print</span>(f<span class="hljs-string">""</span><span class="hljs-string">"run_prompt text: {text}"</span><span class="hljs-string">""</span>)
    <span class="hljs-keyword">return</span> text
</code></pre>
<p>这个基础提示词可能会产生较差的结果，但它为你提供了一个衡量改进效果的起点。</p>
<h4 data-id="heading-5">添加评估标准</h4>
<p>在运行评估时，你可以指定评分模型应考虑的额外标准：</p>
<pre><code class="hljs language-python" lang="python">results = evaluator.run_evaluation(
    run_prompt_function=run_prompt1,
    dataset_file=<span class="hljs-string">"dataset.json"</span>,
    extra_criteria=<span class="hljs-string">"""
    输出应包含：
    - 每日卡路里总量
    - 宏量营养素分解
    - 包含确切食物、份量和时间的餐次
    """</span>,
)
</code></pre>
<p>这有助于确保您的提示词能够根据对您用例真正重要的特定要求进行评估。</p>
<h4 data-id="heading-6">分析结果</h4>
<p>运行评估后，你将获得数值评分和详细的 HTML 报告。报告会准确展示每个测试用例的表现，包括模型对每个评分的推理过程。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fbf9c6b594514a0b9892f832f3dffe9d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbXdxMzAxMjM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770637262&amp;x-signature=7UK1u5bmXCW8HtiKFK9AkO58ack%3D" alt="截屏2026-02-02 18.55.11.png" loading="lazy"/></p>
<p>不要因为初始分数低而气馁——首次尝试得到 3.0/10 的分数是很正常的。目标是在应用工程技术的过程中看到持续的进步。</p>
<p>详细的评估报告可帮助您准确了解提示词在哪些方面存在不足，以及需要进行哪些改进。请利用这些反馈来指导您的下一次迭代。</p>
<h4 data-id="heading-7">下一步</h4>
<p>建立基线后，你就可以开始应用具体的提示工程技术了。你学习的每种技术都应该能在评估分数上带来可衡量的提升，逐步将你的基础提示转变为可靠、高性能的工具。</p>
<p>请记住，提示词工程是一个迭代的过程。关键在于每次只做一处修改，评估其影响，然后在有效的基础上继续改进。这种系统化的方法能确保你了解哪些技术对你的特定用例最有价值。</p>
<h3 data-id="heading-8">技巧一 ：清晰直接</h3>
<p>提示词的第一行是整个请求中最重要的部分。这是你为后续所有内容奠定基调的地方，写好这一行可以显著提升你的结果。</p>
<h3 data-id="heading-9">清晰直接</h3>
<p>在撰写这关键的第一行时，你需要关注两个核心原则：清晰和直接。这意味着使用简洁的语言，让 Claude 明确无误地理解你希望它做什么。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7bba392e922f4165b3a08d39184940c3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbXdxMzAxMjM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770637262&amp;x-signature=oLo41IazkK2Jg2tUeABUJBZYdo0%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-10">清晰沟通</h4>
<p>清晰意味着：</p>
<ul>
<li>使用任何人都能理解的简单语言</li>
<li>直截了当地说出你想要什么</li>
<li>以直接陈述 Claude 任务的方式开头</li>
</ul>
<p>不要写一些模糊的内容，比如"我想了解一下人们放在屋顶上利用太阳能的那些东西——好像叫太阳能板之类的"，而是直接写："写三段关于太阳能板工作原理的内容。"</p>
<h4 data-id="heading-11">直接指令</h4>
<p>"直接"侧重于你如何组织你的请求：</p>
<ul>
<li>使用指令，而非问句</li>
<li>以直接的动作动词开头，如"写出"、"创建"或"生成"</li>
</ul>
<p>与其问"我在阅读关于可再生能源的内容，地热能听起来很有趣。哪些国家在使用它？"，不如尝试："列出三个使用地热能的国家，并附上每个国家的发电量统计数据。"</p>
<h4 data-id="heading-12">付诸实践</h4>
<p>让我们看看这个技巧的实际应用。从一个简单询问"这个人应该吃什么？"的弱提示开始，我们可以应用清晰直接的方法。</p>
<p>改进后的版本变为： 为一名运动员生成一份符合其饮食限制的一日膳食计划。</p>
<p>这个修订版立即告诉 Claude：</p>
<ul>
<li>要采取什么行动（生成）</li>
<li>要创建什么（膳食计划）</li>
<li>关键约束条件（一天、针对运动员、满足饮食限制）</li>
</ul>
<h4 data-id="heading-13">结果很重要</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7738bdce74464f8aacc6a70c29a51490~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbXdxMzAxMjM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770637262&amp;x-signature=D7f7TPvFBmUTYOdQ%2BjrhhvDYRg0%3D" alt="截屏2026-02-02 19.00.24.png" loading="lazy"/></p>
<p>这个简单的改变可以对性能产生显著影响。在我们的示例中，评估分数从 2.32 跃升至 3.92——仅仅通过重构开头那一行就实现了大幅提升。</p>
<p>关键要点是，当你把 Claude 当作一个需要明确指示的得力助手，而不是需要猜测你想要什么的人时，它的表现最好。以直接的动作动词开头，明确说明任务，你会立即看到更好的结果。</p>
<h3 data-id="heading-14">技巧二 ：具体明确</h3>
<p>在使用 Claude 时，提高输出效果最有效的方法之一就是明确说明你想要什么。与其让模型自行理解，不如提供清晰的指导或步骤，引导 Claude 生成你期望的输出。</p>
<p>可以这样理解：如果你让 Claude"写一个关于某人发现自己隐藏天赋的短篇故事"，Claude 可能会朝无数个方向发展。故事可能是 200 字，也可能是 2000 字；可能只有一个角色，也可能有五个；可以聚焦于任何类型的天赋发现场景。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/205a37c6bb5041dcad56758d369099fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbXdxMzAxMjM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770637262&amp;x-signature=09n%2FXe6IWrcPsLCKmzNYhHmfe6M%3D" alt="" loading="lazy"/>通过添加具体的指导原则，你为 Claude 提供了一个更清晰的目标。这显著提升了输出的一致性和质量。</p>
<h4 data-id="heading-15">两类指南</h4>
<p>在提示词中实现具体化主要有两种方法，在专业应用中你经常会看到它们被结合使用。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc1883aed58142d09478d6785f70c017~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbXdxMzAxMjM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770637262&amp;x-signature=01yyIr9jIZOLb2Q8lrnU8Vuy5b4%3D" alt="" loading="lazy"/></p>
<p>第一类侧重于列出输出应具备的特质。这些指南帮助你控制：</p>
<ul>
<li>响应的长度</li>
<li>结构与格式</li>
<li>需包含的具体属性或元素</li>
<li>语气或风格要求</li>
</ul>
<p>例如，你可以规定故事应控制在1000字以内，包含一个能展现角色才能的明确行动，并至少设置一个配角。</p>
<p>第二种类型为 Claude 提供了具体的步骤供其遵循。当你希望 Claude 系统性地思考问题，或在得出最终答案之前考虑多个角度时，这种方法特别有用。</p>
<p>你可以让 Claude 先完成以下步骤，而不是直接开始写作：</p>
<ol>
<li>头脑风暴三种能制造戏剧张力的天赋</li>
<li>选出最有趣的一种天赋</li>
<li>Outline a pivotal scene that reveals the talent</li>
<li>Brainstorm supporting character types that could increase the impact</li>
</ol>
<h4 data-id="heading-16">现实世界的影响</h4>
<p>具体性带来的差异是显著的。在测试一个膳食计划提示词时，添加指导原则后评估分数从 3.92 提升到了 7.86——仅仅通过告诉 Claude 具体需要包含哪些元素，输出质量就提高了一倍多。</p>
<pre><code class="hljs language-markdown" lang="markdown">Guidelines:
<span class="hljs-bullet">1.</span> Include accurate daily calorie amount
<span class="hljs-bullet">2.</span> Show protein, fat, and carb amounts
<span class="hljs-bullet">3.</span> Specify when to eat each meal
<span class="hljs-bullet">4.</span> Use only foods that fit restrictions
<span class="hljs-bullet">5.</span> List all portion sizes in grams
<span class="hljs-bullet">6.</span> Keep budget-friendly if mentioned
</code></pre>
<p>以下是关于何时使用各类具体性的实用指南：</p>
<h5 data-id="heading-17">1.始终使用输出指南</h5>
<p>你应该在几乎每个提示词中都包含质量指南。它们是你获得一致、有用结果的安全网。</p>
<h5 data-id="heading-18">2.处理复杂问题时使用分步流程</h5>
<p>在处理以下情况时，请添加分步说明：</p>
<ul>
<li>复杂问题的故障排除</li>
<li>Decision-making scenarios</li>
<li>批判性思维任务</li>
<li>任何你希望 Claude 从多个角度进行思考的情况</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f56b882a37a44e2d875410b1ed0dc7ed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbXdxMzAxMjM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770637262&amp;x-signature=qxFW0ZK0G2x32RjqBMb2B%2F%2BkAM0%3D" alt="" loading="lazy"/>例如，如果你让 Claude 分析销售团队业绩下滑的原因，你需要引导它从市场指标、行业变化、个人表现、组织变动和客户反馈等多个维度进行考察，而不是让它只关注某一个潜在原因。</p>
<h4 data-id="heading-19">结合两种方法</h4>
<p>在专业提示词编写中，你经常会看到两种技术结合使用。你可能会有控制输出格式和内容的指南，同时还有确保 Claude 在回复前充分思考问题的步骤。</p>
<p>这种组合既能让你的结果保持一致性，又能确保 Claude 在得出结论时已考虑了所有重要因素。</p>
<hr/>
<h3 data-id="heading-20">技巧三 ：使用 XML 标签进行结构化</h3>
<p>当你构建包含大量内容的提示词时，Claude 有时可能难以理解哪些文本片段属于同一部分，或者不同部分各自代表什么含义。XML 标签提供了一种简单的方式来为提示词增添结构和清晰度，尤其是在你需要插入大量数据时。</p>
<h4 data-id="heading-21">结构为何重要</h4>
<p>假设有一个提示词需要分析 20 页的销售记录。如果没有清晰的边界，Claude 可能难以区分你的指令和你希望分析的实际数据。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f655fa4ce56d49c480714dd5a441c2b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbXdxMzAxMjM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770637262&amp;x-signature=IT4Hg4IeulUvSpNALguJhfX1e2U%3D" alt="" loading="lazy"/>上面的示例展示了边界不清晰如何导致 Claude 难以解析你的意图。通过使用 &lt;sales_records&gt; 和 &lt;/sales_records&gt; 等 XML 标签包裹销售记录，你可以创建清晰的分隔符，帮助 Claude 理解提示词的结构。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d41c47eeb212453abca043605a077950~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbXdxMzAxMjM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770637262&amp;x-signature=ohqrZ9czfg9CQPcXqFisI7obfIc%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-22">实际示例：代码与文档</h4>
<p>这是一个更生动的例子，说明为什么 XML 标签很重要。如果你让 Claude 使用提供的文档来调试代码，把所有内容混在一起会造成混乱：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aee8d862e14d4feba5fd800b5abc2a21~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbXdxMzAxMjM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770637262&amp;x-signature=qRmYxMnrqDOD6%2F%2B37ZPH5hrmmV4%3D" alt="" loading="lazy"/>"不太好"的版本几乎无法区分哪些是代码、哪些是文档。"更好"的版本使用 &lt;my_code&gt; 和 <code>&lt;docs&gt;</code> 标签来创建清晰的边界。</p>
<h4 data-id="heading-23">自定义标签名称</h4>
<p>你不需要使用官方的 XML 标签。创建对你的内容有意义的描述性名称即可：</p>
<ul>
<li>&lt;sales_records&gt; 比 <code>&lt;data&gt;</code> 更好</li>
<li>&lt;athlete_information&gt; 清晰地标识用户详情</li>
<li>&lt;my_code&gt; 和 <code>&lt;docs&gt;</code> 用于分隔不同类型的内容</li>
</ul>
<p>标签名称越具体、越具有描述性，Claude 就越能理解每个部分的用途。</p>
<h4 data-id="heading-24">何时使用 XML 标签</h4>
<p>XML 标签在以下情况下最为有用：</p>
<ul>
<li>包含大量上下文或数据</li>
<li>混合不同类型的内容（代码、文档、数据）</li>
<li>你希望更加清晰地界定内容边界</li>
<li>处理包含多个变量插值的复杂提示词</li>
</ul>
<p>即使对于较短的内容，XML 标签也可以作为分隔符，使您的提示词结构对 Claude 更加清晰。</p>
<h4 data-id="heading-25">实际应用</h4>
<p>在实践中，你可以这样构建提示词：</p>
<pre><code class="hljs language-diff" lang="diff">&lt;athlete_information&gt;
<span class="hljs-deletion">- Height: 6'2"</span>
<span class="hljs-deletion">- Weight: 180 lbs</span>
<span class="hljs-deletion">- Goal: Build muscle</span>
<span class="hljs-deletion">- Dietary restrictions: Vegetarian</span>
&lt;/athlete_information&gt;

Generate a meal plan based on the athlete information above.
</code></pre>
<p>这清楚地表明，身高、体重、目标和限制条件都是相关的运动员数据，在生成膳食计划时应一并考虑。</p>
<p>虽然在简单提示词中你可能看不到显著的改进，但随着提示词变得越来越复杂并包含大量多样化的内容，XML 标签的价值会越来越大。</p>
<hr/>
<h3 data-id="heading-26">技巧四 ：提供示例</h3>
<p>Claude 在分类时可能会遇到一些问题。</p>
<p>在提示词中提供示例是你将使用的最有效的提示工程技术之一。这种方法被称为"单样本"或"多样本"提示，通过向 Claude 提供输入/输出样本对来引导其响应。</p>
<h4 data-id="heading-27">示例的工作原理</h4>
<p>让我们来看一个情感分析的示例。假设你希望 Claude 判断一条推文是正面的还是负面的：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d85dc6ac79924102a943dd431f401c06~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbXdxMzAxMjM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770637262&amp;x-signature=6iuCoJBzKiJTkPbv%2B2p9ZuN9Y5g%3D" alt="" loading="lazy"/>这里的挑战在于讽刺。像"是啊，当然了，这是我自从看了《外太空九号计划》以来看过的最好的电影"这样的推文表面上看起来是正面的，但实际上是讽刺性的负面评价（《外太空九号计划》是出了名的史上最烂电影之一）。</p>
<h4 data-id="heading-28">添加示例来处理边界情况</h4>
<p>要解决这个问题，你可以添加示例来展示 Claude 如何处理棘手的情况：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5aa2399c41b64ad5afb81bf492ceadaf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbXdxMzAxMjM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770637262&amp;x-signature=CihU7naAP0VXpEPapGwBXOPhdGs%3D" alt="" loading="lazy"/>改进后的提示词包括：</p>
<ul>
<li>一个清晰的正面示例："Great game tonight!" → "Positive"</li>
<li>一个讽刺性示例："Oh yeah, I really needed a flight delay tonight! Excellent!" → "Negative"</li>
<li>解释为何应谨慎对待讽刺的背景说明</li>
</ul>
<p>注意这些示例是如何用 XML 标签包裹的，比如 &lt;sample_input&gt; 和 &lt;ideal_output&gt;。这种结构让 Claude 能够非常清楚地理解每个部分代表什么。</p>
<h4 data-id="heading-29">何时使用示例</h4>
<p>示例在以下场景中尤为实用：</p>
<ul>
<li>捕获边界情况或极端场景</li>
<li>定义复杂的输出格式（如特定的 JSON 结构）</li>
<li>展示你想要的确切风格或语气</li>
<li>演示如何处理模糊输入</li>
</ul>
<h4 data-id="heading-30">单样本与多样本</h4>
<p><strong>单样本</strong>：提供单个示例来建立模式</p>
<p><strong>多样本</strong>：提供多个示例以涵盖不同场景</p>
<p>当你需要处理各种边缘情况或想展示不同类型的有效响应时，请使用多样本提示。</p>
<h4 data-id="heading-31">从评估中寻找优质示例</h4>
<p>在运行提示词评估时，寻找得分最高的输出作为示例：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab5e65c9376f47358b994fe77352bb40~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbXdxMzAxMjM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770637262&amp;x-signature=ud0pKp3AdtfdHXk7%2FIdFrcsbkkg%3D" alt="截屏2026-02-02 19.39.42.png" loading="lazy"/>
找出评分为 10（或你可用的最高分）的回复，并将这些输入/输出对作为示例放入你的提示词中。这有助于 Claude 理解针对你的特定用例，"完美"的输出应该是什么样子。</p>
<h4 data-id="heading-32">为示例添加上下文</h4>
<p>不要只提供输入/输出对——要解释为什么这个输出是好的：</p>
<pre><code class="hljs language-csharp" lang="csharp">&lt;ideal_output&gt;
[<span class="hljs-meta">Your example output here</span>]
&lt;/ideal_output&gt;

This example <span class="hljs-keyword">is</span> well-structured, provides detailed information
<span class="hljs-keyword">on</span> food choices <span class="hljs-keyword">and</span> quantities, <span class="hljs-keyword">and</span> aligns <span class="hljs-keyword">with</span> the athlete<span class="hljs-string">'s
goals and restrictions.
</span></code></pre>
<p>这些额外的上下文帮助 Claude 理解好的回复背后的推理逻辑，而不仅仅是格式。</p>
<h4 data-id="heading-33">最佳实践</h4>
<ul>
<li>始终使用 XML 标签来清晰地组织你的示例</li>
<li>明确说明你要展示的内容："这是一个示例输入及其理想回复"</li>
<li>包含针对最常见失败情况的示例</li>
<li>解释为什么你的示例输出被认为是理想的</li>
<li>保持示例与你的具体任务相关</li>
</ul>
<p>示例尤其强大，因为它们是展示而非讲述。与其试图用文字准确描述你想要什么，不如直接演示出来。这使你的提示词更加可靠，并帮助 Claude 理解那些仅靠指令难以表达的细微要求。</p>
<pre><code class="hljs language-markdown" lang="markdown">def run<span class="hljs-emphasis">_prompt2(prompt_</span>inputs):
  prompt = f"""
  为一名运动员生成一份符合其饮食限制的一日膳食计划。

  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">athlete_information</span>&gt;</span></span> 
<span class="hljs-bullet">  -</span> 身高: {prompt<span class="hljs-emphasis">_inputs["height"]} 
  - 体重: {prompt_</span>inputs["weight"]} 
<span class="hljs-bullet">  -</span> 目标: {prompt<span class="hljs-emphasis">_inputs["goal"]} 
  - 饮食限制: {prompt_</span>inputs["restrictions"]} 
  <span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">athlete_information</span>&gt;</span></span>

  指导原则：
<span class="hljs-bullet">  1.</span> 包含准确的每日卡路里数量
<span class="hljs-bullet">  2.</span> 显示蛋白质、脂肪和碳水化合物含量
<span class="hljs-bullet">  3.</span> 指定每餐的用餐时间
<span class="hljs-bullet">  4.</span> 仅使用符合限制的食物
<span class="hljs-bullet">  5.</span> 以克为单位列出所有食物份量
<span class="hljs-bullet">  6.</span> 如果提到预算，保持经济实惠

  以下是一个示例输入和理想输出的例子：
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">sample_input</span>&gt;</span></span>
  身高: 170
  体重: 70
  目标: 保持健康并改善胆固醇水平
  限制: 高胆固醇
  <span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">sample_input</span>&gt;</span></span>
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ideal_output</span>&gt;</span></span>
  以下是为一名旨在保持健康并改善胆固醇水平的运动员制定的一日膳食计划：

<span class="hljs-bullet">  *</span>   <span class="hljs-strong">**卡路里目标：**</span> 约 2500 卡路里
<span class="hljs-bullet">  *</span>   <span class="hljs-strong">**宏量营养素分解：**</span> 蛋白质 (140g)，脂肪 (70g)，碳水化合物 (340g)

  <span class="hljs-strong">**膳食计划：**</span>

<span class="hljs-bullet">  *</span>   <span class="hljs-strong">**早餐 (7:00 AM)：**</span> 燕麦片（80g 干重）配浆果（100g）和核桃（15g）。脱脂牛奶（240g）。
<span class="hljs-bullet">      *</span>   蛋白质: 15g，脂肪: 15g，碳水化合物: 60g
<span class="hljs-bullet">  *</span>   <span class="hljs-strong">**上午加餐 (10:00 AM)：**</span> 苹果（150g）配杏仁酱（30g）。
<span class="hljs-bullet">      *</span>   蛋白质: 7g，脂肪: 18g，碳水化合物: 25g
<span class="hljs-bullet">  *</span>   <span class="hljs-strong">**午餐 (1:00 PM)：**</span> 烤鸡胸肉（120g）沙拉配混合蔬菜（150g）、黄瓜（50g）、番茄（50g）和清淡的油醋汁（30g）。全麦面包（60g）。
<span class="hljs-bullet">      *</span>   蛋白质: 40g，脂肪: 15g，碳水化合物: 70g
<span class="hljs-bullet">  *</span>   <span class="hljs-strong">**下午加餐 (4:00 PM)：**</span> 希腊酸奶（170g，脱脂）配香蕉（120g）。
<span class="hljs-bullet">      *</span>   蛋白质: 20g，脂肪: 0g，碳水化合物: 40g
<span class="hljs-bullet">  *</span>   <span class="hljs-strong">**晚餐 (7:00 PM)：**</span> 烤三文鱼（140g）配蒸西兰花（200g）和藜麦（75g 干重）。
<span class="hljs-bullet">      *</span>   蛋白质: 40g，脂肪: 20g，碳水化合物: 80g
<span class="hljs-bullet">  *</span>   <span class="hljs-strong">**晚间加餐 (9:00 PM)：**</span> 一小把杏仁（20g）。
<span class="hljs-bullet">      *</span>   蛋白质: 8g，脂肪: 12g，碳水化合物: 15g

  此膳食计划优先选择瘦肉蛋白来源、全谷物、水果和蔬菜，同时限制饱和脂肪和反式脂肪，以支持健康的胆固醇水平。
  <span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">ideal_output</span>&gt;</span></span>
  此示例膳食计划结构良好，提供了食物选择和数量的详细信息，并与运动员的目标和限制保持一致。
  """


  messages = []
  add<span class="hljs-emphasis">_user_</span>message(messages, prompt)
  # 使用更大的 max<span class="hljs-emphasis">_tokens 值，确保完整的膳食计划不会被截断
  # 对于详细的膳食计划（包含多餐、营养成分等），使用 8000 tokens
  text = chat(messages, max_</span>tokens=4000)
  print(f"""run<span class="hljs-emphasis">_prompt text: {text}""")
  return (prompt, text)
</span></code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab5e65c9376f47358b994fe77352bb40~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbXdxMzAxMjM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770637262&amp;x-signature=ud0pKp3AdtfdHXk7%2FIdFrcsbkkg%3D" alt="截屏2026-02-02 19.39.42.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hibernate（79）如何在ETL流程中使用Hibernate？]]></title>    <link>https://juejin.cn/post/7602057555453411382</link>    <guid>https://juejin.cn/post/7602057555453411382</guid>    <pubDate>2026-02-02T11:56:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602057555453411382" data-draft-id="7602106969697959999" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hibernate（79）如何在ETL流程中使用Hibernate？"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2026-02-02T11:56:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hibernate（79）如何在ETL流程中使用Hibernate？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T11:56:11.000Z" title="Mon Feb 02 2026 11:56:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在ETL（Extract, Transform, Load）流程中使用Hibernate可以帮助你从数据库中提取数据，对数据进行转换，并将数据加载到目标数据库中。以下是一个详细深入的示例，结合代码演示如何在ETL流程中使用Hibernate。</p>
<h3 data-id="heading-0">1. 设置Hibernate配置</h3>
<p>首先，创建一个Hibernate配置文件<code>hibernate.cfg.xml</code>，配置源数据库和目标数据库。</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span>?&gt;</span>
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">hibernate-configuration</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span> <span class="hljs-string">"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">hibernate-configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">session-factory</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- Source Database Configuration --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/source_db<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.username"</span>&gt;</span>source_user<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.password"</span>&gt;</span>source_password<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        
        <span class="hljs-comment">&lt;!-- Target Database Configuration --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/target_db<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.username"</span>&gt;</span>target_user<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.password"</span>&gt;</span>target_password<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.hbm2ddl.auto"</span>&gt;</span>update<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.show_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">session-factory</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">hibernate-configuration</span>&gt;</span>
</code></pre>
<h3 data-id="heading-1">2. 创建实体类</h3>
<p>创建两个实体类对应源数据库和目标数据库中的表。</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "source_table")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SourceEntity</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;
    <span class="hljs-keyword">private</span> String dataField;

    <span class="hljs-comment">// Getters and setters</span>
}

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "target_table")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TargetEntity</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;
    <span class="hljs-keyword">private</span> String transformedField;

    <span class="hljs-comment">// Getters and setters</span>
}
</code></pre>
<h3 data-id="heading-2">3. 编写ETL流程</h3>
<p>编写ETL流程来抽取、转换和加载数据。</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.Transaction;
<span class="hljs-keyword">import</span> org.hibernate.cfg.Configuration;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ETLProcess</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// Configure Hibernate</span>
        <span class="hljs-type">Configuration</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>().configure(<span class="hljs-string">"hibernate.cfg.xml"</span>);
        <span class="hljs-type">SessionFactory</span> <span class="hljs-variable">sessionFactory</span> <span class="hljs-operator">=</span> config.buildSessionFactory();

        <span class="hljs-comment">// Extract Data</span>
        <span class="hljs-type">Session</span> <span class="hljs-variable">sourceSession</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">sourceTransaction</span> <span class="hljs-operator">=</span> sourceSession.beginTransaction();
        List&lt;SourceEntity&gt; sourceData = sourceSession.createQuery(<span class="hljs-string">"FROM SourceEntity"</span>, SourceEntity.class).list();
        sourceTransaction.commit();
        sourceSession.close();

        <span class="hljs-comment">// Transform Data</span>
        List&lt;TargetEntity&gt; transformedData = transformData(sourceData);

        <span class="hljs-comment">// Load Data</span>
        <span class="hljs-type">Session</span> <span class="hljs-variable">targetSession</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">targetTransaction</span> <span class="hljs-operator">=</span> targetSession.beginTransaction();
        <span class="hljs-keyword">for</span> (TargetEntity targetEntity : transformedData) {
            targetSession.save(targetEntity);
        }
        targetTransaction.commit();
        targetSession.close();

        sessionFactory.close();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;TargetEntity&gt; <span class="hljs-title function_">transformData</span><span class="hljs-params">(List&lt;SourceEntity&gt; sourceData)</span> {
        <span class="hljs-comment">// Example transformation logic</span>
        <span class="hljs-keyword">return</span> sourceData.stream()
                .map(sourceEntity -&gt; {
                    <span class="hljs-type">TargetEntity</span> <span class="hljs-variable">targetEntity</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TargetEntity</span>();
                    targetEntity.setTransformedField(sourceEntity.getDataField().toUpperCase());
                    <span class="hljs-keyword">return</span> targetEntity;
                })
                .toList();
    }
}
</code></pre>
<h3 data-id="heading-3">4. 运行ETL流程</h3>
<p>编译并运行上面的Java代码，它将连接到源数据库，提取数据，对数据进行转换，并将转换后的数据加载到目标数据库。</p>
<h3 data-id="heading-4">例子解释</h3>
<ol>
<li><strong>Hibernate配置：</strong> 配置两个数据库连接，一个用于源数据库，另一个用于目标数据库。</li>
<li><strong>实体类：</strong> 创建对应源数据表和目标数据表的实体类。</li>
<li><strong>ETL流程：</strong>
<ul>
<li><strong>抽取（Extract）：</strong> 从源数据库中提取数据。</li>
<li><strong>转换（Transform）：</strong> 对提取的数据进行转换。</li>
<li><strong>加载（Load）：</strong> 将转换后的数据加载到目标数据库中。</li>
</ul>
</li>
</ol>
<p>这样，通过配置和代码示例，展示了如何在ETL流程中使用Hibernate。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hibernate（80） 如何在数据迁移中使用Hibernate？]]></title>    <link>https://juejin.cn/post/7602082590732910628</link>    <guid>https://juejin.cn/post/7602082590732910628</guid>    <pubDate>2026-02-02T11:57:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602082590732910628" data-draft-id="7602098592677265462" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hibernate（80） 如何在数据迁移中使用Hibernate？"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2026-02-02T11:57:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hibernate（80） 如何在数据迁移中使用Hibernate？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T11:57:16.000Z" title="Mon Feb 02 2026 11:57:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>在数据迁移过程中使用Hibernate，可以帮助你从旧数据库中提取数据，对数据进行必要的转换，并将数据插入到新数据库。以下是一个详细的示例，结合代码演示如何在数据迁移过程中使用Hibernate：</p>
<h3 data-id="heading-0">1. 设置Hibernate配置</h3>
<p>首先，创建两个Hibernate配置文件，分别用于旧数据库和新数据库的连接。</p>
<h4 data-id="heading-1"><code>hibernate_old.cfg.xml</code>（旧数据库配置文件）</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span>?&gt;</span>
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">hibernate-configuration</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span> <span class="hljs-string">"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">hibernate-configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">session-factory</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/old_db<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.username"</span>&gt;</span>old_user<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.password"</span>&gt;</span>old_password<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.hbm2ddl.auto"</span>&gt;</span>validate<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.show_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">session-factory</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">hibernate-configuration</span>&gt;</span>
</code></pre>
<h4 data-id="heading-2"><code>hibernate_new.cfg.xml</code>（新数据库配置文件）</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span>?&gt;</span>
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">hibernate-configuration</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span> <span class="hljs-string">"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">hibernate-configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">session-factory</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/new_db<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.username"</span>&gt;</span>new_user<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.password"</span>&gt;</span>new_password<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.hbm2ddl.auto"</span>&gt;</span>update<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.show_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">session-factory</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">hibernate-configuration</span>&gt;</span>
</code></pre>
<h3 data-id="heading-3">2. 创建实体类</h3>
<p>创建两个实体类对应旧数据库和新数据库中的表。</p>
<h4 data-id="heading-4"><code>OldEntity.java</code>（旧数据库实体类）</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> javax.persistence.*;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "old_table")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OldEntity</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;
    <span class="hljs-keyword">private</span> String oldField;

    <span class="hljs-comment">// Getters and setters</span>
}
</code></pre>
<h4 data-id="heading-5"><code>NewEntity.java</code>（新数据库实体类）</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> javax.persistence.*;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "new_table")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NewEntity</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;
    <span class="hljs-keyword">private</span> String newField;

    <span class="hljs-comment">// Getters and setters</span>
}
</code></pre>
<h3 data-id="heading-6">3. 编写数据迁移流程</h3>
<p>编写数据迁移流程来提取、转换和加载数据。</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.Transaction;
<span class="hljs-keyword">import</span> org.hibernate.cfg.Configuration;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataMigration</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// Configure Hibernate for old database</span>
        <span class="hljs-type">Configuration</span> <span class="hljs-variable">oldConfig</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>().configure(<span class="hljs-string">"hibernate_old.cfg.xml"</span>);
        <span class="hljs-type">SessionFactory</span> <span class="hljs-variable">oldSessionFactory</span> <span class="hljs-operator">=</span> oldConfig.buildSessionFactory();

        <span class="hljs-comment">// Configure Hibernate for new database</span>
        <span class="hljs-type">Configuration</span> <span class="hljs-variable">newConfig</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>().configure(<span class="hljs-string">"hibernate_new.cfg.xml"</span>);
        <span class="hljs-type">SessionFactory</span> <span class="hljs-variable">newSessionFactory</span> <span class="hljs-operator">=</span> newConfig.buildSessionFactory();

        <span class="hljs-comment">// Extract Data from old database</span>
        <span class="hljs-type">Session</span> <span class="hljs-variable">oldSession</span> <span class="hljs-operator">=</span> oldSessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">oldTransaction</span> <span class="hljs-operator">=</span> oldSession.beginTransaction();
        List&lt;OldEntity&gt; oldData = oldSession.createQuery(<span class="hljs-string">"FROM OldEntity"</span>, OldEntity.class).list();
        oldTransaction.commit();
        oldSession.close();

        <span class="hljs-comment">// Transform Data</span>
        List&lt;NewEntity&gt; transformedData = transformData(oldData);

        <span class="hljs-comment">// Load Data into new database</span>
        <span class="hljs-type">Session</span> <span class="hljs-variable">newSession</span> <span class="hljs-operator">=</span> newSessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">newTransaction</span> <span class="hljs-operator">=</span> newSession.beginTransaction();
        <span class="hljs-keyword">for</span> (NewEntity newEntity : transformedData) {
            newSession.save(newEntity);
        }
        newTransaction.commit();
        newSession.close();

        oldSessionFactory.close();
        newSessionFactory.close();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;NewEntity&gt; <span class="hljs-title function_">transformData</span><span class="hljs-params">(List&lt;OldEntity&gt; oldData)</span> {
        <span class="hljs-comment">// Example transformation logic</span>
        <span class="hljs-keyword">return</span> oldData.stream()
                .map(oldEntity -&gt; {
                    <span class="hljs-type">NewEntity</span> <span class="hljs-variable">newEntity</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NewEntity</span>();
                    newEntity.setNewField(oldEntity.getOldField().toUpperCase());
                    <span class="hljs-keyword">return</span> newEntity;
                })
                .toList();
    }
}
</code></pre>
<h3 data-id="heading-7">4. 运行数据迁移流程</h3>
<p>编译并运行上面的Java代码，它将连接到旧数据库，提取数据，对数据进行转换，并将转换后的数据加载到新数据库。</p>
<h3 data-id="heading-8">例子解释</h3>
<ol>
<li><strong>Hibernate配置：</strong> 配置两个Hibernate配置文件，分别用于旧数据库和新数据库的连接。</li>
<li><strong>实体类：</strong> 创建对应旧数据表和新数据表的实体类。</li>
<li><strong>数据迁移流程：</strong>
<ul>
<li><strong>抽取（Extract）：</strong> 从旧数据库中提取数据。</li>
<li><strong>转换（Transform）：</strong> 对提取的数据进行转换。</li>
<li><strong>加载（Load）：</strong> 将转换后的数据加载到新数据库中。</li>
</ul>
</li>
</ol>
<p>通过以上配置和代码示例，我们展示了如何在数据迁移过程中使用Hibernate。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[统一开发规范--Git hooks工具库——husky]]></title>    <link>https://juejin.cn/post/7602106969697304639</link>    <guid>https://juejin.cn/post/7602106969697304639</guid>    <pubDate>2026-02-02T09:52:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602106969697304639" data-draft-id="7602082590732369956" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="统一开发规范--Git hooks工具库——husky"/> <meta itemprop="keywords" content="前端"/> <meta itemprop="datePublished" content="2026-02-02T09:52:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="没有鸡汤吃不下饭"/> <meta itemprop="url" content="https://juejin.cn/user/1398234519447127"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            统一开发规范--Git hooks工具库——husky
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1398234519447127/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    没有鸡汤吃不下饭
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T09:52:39.000Z" title="Mon Feb 02 2026 09:52:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读3分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">🐾 Husky 是什么？</h2>
<p>Husky 是一个用于 管理 Git 钩子（Git hooks） 的 JavaScript 工具。它允许你在执行 Git 操作（如 commit、push 等）时自动运行自定义脚本，比如：
提交前检查代码格式（lint）
运行单元测试
阻止不符合规范的提交</p>
<p>它的目标是 提升代码质量、统一团队开发规范、防止低级错误进入仓库。</p>
<h2 data-id="heading-1">✅ 为什么在 Vue 3 项目中使用 Husky？</h2>
<p>在现代前端工程化项目（如 Vue 3 + Vite + TypeScript）中，通常会配合以下工具链：
ESLint：代码规范检查
Prettier：代码格式化
lint-staged：只对暂存文件（staged files）运行 lint
Husky：在 Git 提交阶段触发上述检查</p>
<p>通过 Husky，可以确保：
“任何提交到 Git 的代码都必须通过 lint 和测试”，避免污染主分支或远程仓库。</p>
<h2 data-id="heading-2">🛠️ 在 Vue 3 项目中如何配置 Husky？</h2>
<p>当前环境：node.js为16.20.2   pnpm为8.15.9
第一步：安装依赖</p>
<p>bash
pnpm install husky@^8.0.3 --save-dev
pnpm install lint-staged@^13.3.0 --save-dev</p>
<p>第二步：启用 Husky</p>
<p>bash
npx husky install
这会在项目根目录生成 .husky/ 文件夹。
第三步：添加钩子（例如 pre-commit）</p>
<p>bash
npx husky add .husky/pre-commit "npx lint-staged"
第四步：配置 lint-staged</p>
<p>在 package.json 中添加：</p>
<pre><code class="hljs language-js" lang="js">{
  <span class="hljs-string">"lint-staged"</span>: {
    <span class="hljs-string">"*.{js,ts,vue}"</span>: [
      <span class="hljs-string">"eslint --fix"</span>,
      <span class="hljs-string">"prettier --write"</span>
    ]
  }
}
</code></pre>
<p>这样每次 git commit 时，只会格式化和检查你本次修改的文件。
第五步（可选）：自动启用 Husky（推荐）</p>
<p>在 package.json 的 scripts 中加入：</p>
<pre><code class="hljs language-js" lang="js">{
  <span class="hljs-string">"scripts"</span>: {
    <span class="hljs-string">"prepare"</span>: <span class="hljs-string">"husky install"</span>
  }
}
</code></pre>
<p>这样其他开发者执行 npm install 后会自动启用 Husky 钩子。</p>
<h4 data-id="heading-3">💡 小贴士</h4>
<p>注意 Husky 和 lint-staged的版本
Husky v7+ 要求 Node.js ≥ 14。</p>
<h2 data-id="heading-4">husky常用的两个git钩子脚本</h2>
<h3 data-id="heading-5">一、.husky/pre-commit</h3>
<p><code>.husky/pre-commit</code> 文件是一个 Git 钩子脚本，它的主要作用是在您执行 <code>git commit</code> 命令时自动运行。具体来说：</p>
<ol>
<li>
<p><strong>自动代码检查</strong>：在每次提交代码前，自动运行代码检查工具（如 ESLint、Prettier 等）来确保代码质量。</p>
</li>
<li>
<p><strong>防止低质量问题提交</strong>：如果代码检查失败（例如有语法错误、代码风格问题等），提交会被中断，直到问题解决。</p>
</li>
<li>
<p><strong>自动化格式化</strong>：可以自动格式化代码，确保团队成员提交的代码风格一致。</p>
</li>
</ol>
<p>在您的项目中，<code>.husky/pre-commit</code> 文件包含以下内容：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/usr/bin/env sh</span>
. <span class="hljs-string">"<span class="hljs-subst">$(dirname -- <span class="hljs-string">"<span class="hljs-variable">$0</span>"</span>)</span>/_/husky.sh"</span>

npx lint-staged
</code></pre>
<p>这意味着在每次提交前，会运行 <code>lint-staged</code> 命令，它只会检查和修复那些被暂存（staged）的文件，而不是整个项目的所有文件。</p>
<p>这种机制有助于：</p>
<ul>
<li>确保只有符合代码规范的代码才能被提交</li>
<li>保持代码库的一致性</li>
<li>在早期发现问题，避免在后续流程中出现更多问题</li>
<li>自动格式化代码，减少代码审查时的风格争议</li>
</ul>
<h3 data-id="heading-6">二、.husky/commit-msg</h3>
<p><code>.husky/commit-msg</code> 是另一个 Git 钩子脚本，它的作用是在您提交代码时检查提交消息（commit message）的格式。</p>
<p>具体来说，<code>commit-msg</code> 钩子的功能包括：</p>
<ol>
<li>
<p><strong>提交信息格式验证</strong>：检查提交信息是否符合预设的格式规范，比如是否遵循 Conventional Commits 规范（如 <code>feat: 新增功能</code>、<code>fix: 修复bug</code> 等）。</p>
</li>
<li>
<p><strong>强制规范化提交</strong>：确保团队成员使用统一的提交信息格式，便于后续自动生成 CHANGELOG、计算版本号等。</p>
</li>
<li>
<p><strong>阻止不合规提交</strong>：如果提交信息不符合规范，会中断提交过程，要求修改提交信息。</p>
</li>
</ol>
<p>例如，一个典型的 <code>commit-msg</code> 钩子可能包含：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/usr/bin/env sh</span>
. <span class="hljs-string">"<span class="hljs-subst">$(dirname -- <span class="hljs-string">"<span class="hljs-variable">$0</span>"</span>)</span>/_/husky.sh"</span>

npx --no-install commitlint --edit <span class="hljs-string">"<span class="hljs-variable">$1</span>"</span>
</code></pre>
<p>这个脚本会使用 <code>commitlint</code> 工具来验证提交信息是否符合规范。常见的规范包括：</p>
<ul>
<li><code>feat: 添加新功能</code></li>
<li><code>fix: 修复 bug</code></li>
<li><code>docs: 文档更新</code></li>
<li><code>style: 代码格式调整</code></li>
<li><code>refactor: 重构代码</code></li>
<li><code>test: 添加测试</code></li>
<li><code>chore: 构建工具或辅助工具变动</code></li>
</ul>
<p>这样可以确保项目的历史提交记录清晰、有序，便于团队协作和自动化工具处理。</p>
<p>可以通过以下命令添加：</p>
<pre><code class="hljs language-bash" lang="bash">npx husky add .husky/commit-msg <span class="hljs-string">"npx --no-install commitlint --edit \$1"</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3 props穿透（attrs）重大变化：$attrs 居然包含class/style了！]]></title>    <link>https://juejin.cn/post/7601904641069596724</link>    <guid>https://juejin.cn/post/7601904641069596724</guid>    <pubDate>2026-02-02T10:00:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601904641069596724" data-draft-id="7601687408925982720" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3 props穿透（attrs）重大变化：$attrs 居然包含class/style了！"/> <meta itemprop="keywords" content="JavaScript,Vue.js,面试"/> <meta itemprop="datePublished" content="2026-02-02T10:00:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="boooooooom"/> <meta itemprop="url" content="https://juejin.cn/user/3078273283917399"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3 props穿透（attrs）重大变化：$attrs 居然包含class/style了！
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3078273283917399/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    boooooooom
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T10:00:06.000Z" title="Mon Feb 02 2026 10:00:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读2分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"🍋"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"🍓"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"🍑"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"🍉"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"🍒"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="androidstudio">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#a9b7c6;background:#282b2e}.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#6897bb}.hljs-deletion,.hljs-keyword,.hljs-selector-tag{color:#cc7832}.hljs-link,.hljs-template-variable,.hljs-variable{color:#629755}.hljs-comment,.hljs-quote{color:grey}.hljs-meta{color:#bbb529}.hljs-addition,.hljs-attribute,.hljs-string{color:#6a8759}.hljs-section,.hljs-title,.hljs-type{color:#ffc66d}.hljs-name,.hljs-selector-class,.hljs-selector-id{color:#e8bf6a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">一、前言：为什么要关注 Vue3 的 $attrs 变化？</h3>
<p>在 Vue 组件开发中，props 穿透（借助 $attrs 传递未声明的属性）是高频场景——比如封装通用按钮、输入框组件时，需要将父组件传递的额外属性（如 placeholder、disabled）透传给子组件内部的原生元素。</p>
<p>而 Vue3 对 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>t</mi><mi>t</mi><mi>r</mi><mi>s</mi><mtext>的改动堪称“颠覆性”，最核心的一点就是：</mtext><mo>∗</mo><mo>∗</mo><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mtext>和</mtext><mi>s</mi><mi>t</mi><mi>y</mi><mi>l</mi><mi>e</mi><mtext>不再被</mtext></mrow><annotation encoding="application/x-tex">attrs 的改动堪称“颠覆性”，最核心的一点就是：**class 和 style 不再被 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal">rs</span><span class="mord cjk_fallback">的改动堪称</span><span class="mord">“</span><span class="mord cjk_fallback">颠覆性</span><span class="mord">”</span><span class="mord cjk_fallback">，最核心的一点就是：</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord">∗</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">ss</span><span class="mord cjk_fallback">和</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord cjk_fallback">不再被</span></span></span></span></span>attrs 过滤，会直接包含在 $attrs 中并透传**。这和 Vue2 的行为完全相反，也是很多开发者迁移项目、编写新组件时最容易踩坑的点，掌握这个变化能少走大量弯路。</p>
<h3 data-id="heading-1">二、Vue2 vs Vue3：$attrs 核心差异对比（重点！）</h3>
<p>要理解这个变化，先明确 Vue2 中 $attrs 的行为，再对比 Vue3 的改动，差异一目了然，避免混淆。</p>
<h4 data-id="heading-2">1. Vue2 中的 $attrs 行为</h4>
<p>在 Vue2 中，$attrs 有一个明确的“过滤规则”：</p>
<ul>
<li>仅包含父组件传递给子组件、但子组件未通过 props 声明的<strong>非 class、非 style 属性</strong>；</li>
<li>class 和 style 会被单独提取，直接应用到子组件的根元素上，<strong>不会出现在 $attrs 中</strong>；</li>
<li>若想手动控制 class/style 透传，需借助 inheritAttrs: false 关闭默认透传，但即便关闭，$attrs 依然不包含 class/style。</li>
</ul>
<h4 data-id="heading-3">2. Vue3 中的 $attrs 行为（核心变化）</h4>
<p>Vue3 彻底简化了这一逻辑，同时改变了 $attrs 的包含范围：</p>
<ul>
<li><strong>核心变化</strong>：$attrs 不再过滤 class 和 style，会将父组件传递的所有未被 props 声明的属性（包括 class、style）全部包含在内；</li>
<li>默认透传行为不变：未声明的 props（含 class/style）依然会自动透传至子组件的根元素；</li>
<li>inheritAttrs: false 的作用升级：关闭默认透传后，class 和 style 也会跟随 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>t</mi><mi>t</mi><mi>r</mi><mi>s</mi><mtext>一起被“拦截”，不会再自动应用到根元素，需手动通过</mtext><mi>v</mi><mo>−</mo><mi>b</mi><mi>i</mi><mi>n</mi><mi>d</mi><mo>=</mo><mi mathvariant="normal">"</mi></mrow><annotation encoding="application/x-tex">attrs 一起被“拦截”，不会再自动应用到根元素，需手动通过 v-bind="</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"/><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal">rs</span><span class="mord cjk_fallback">一起被</span><span class="mord">“</span><span class="mord cjk_fallback">拦截</span><span class="mord">”</span><span class="mord cjk_fallback">，不会再自动应用到根元素，需手动通过</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">bin</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord">"</span></span></span></span></span>attrs" 控制透传位置。</li>
<li>Vue2 中：$attrs = { disabled: true }（class、style 被过滤，直接应用到子组件 button 上）；</li>
<li>Vue3 中：<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>t</mi><mi>t</mi><mi>r</mi><mi>s</mi><mo>=</mo><mrow><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>:</mo><mi mathvariant="normal">"</mi><mi>b</mi><mi>t</mi><mi>n</mi><mo>−</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><mi>a</mi><mi>r</mi><mi>y</mi><mi mathvariant="normal">"</mi><mo separator="true">,</mo><mi>s</mi><mi>t</mi><mi>y</mi><mi>l</mi><mi>e</mi><mo>:</mo><mrow><mi>p</mi><mi>a</mi><mi>d</mi><mi>d</mi><mi>i</mi><mi>n</mi><mi>g</mi><mo>:</mo><mi mathvariant="normal">"</mi><mn>10</mn><mi>p</mi><mi>x</mi><mi mathvariant="normal">"</mi></mrow><mo separator="true">,</mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>a</mi><mi>b</mi><mi>l</mi><mi>e</mi><mi>d</mi><mo>:</mo><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow><mtext>（</mtext><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mtext>、</mtext><mi>s</mi><mi>t</mi><mi>y</mi><mi>l</mi><mi>e</mi><mtext>被包含在</mtext></mrow><annotation encoding="application/x-tex">attrs = { class: "btn-primary", style: { padding: "10px" }, disabled: true }（class、style 被包含在 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"/><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal">rs</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">ss</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord">"</span><span class="mord mathnormal">b</span><span class="mord mathnormal">t</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">ima</span><span class="mord mathnormal" style="margin-right:0.03588em;">ry</span><span class="mord">"</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord"><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">dd</span><span class="mord mathnormal">in</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord">"10</span><span class="mord mathnormal">p</span><span class="mord mathnormal">x</span><span class="mord">"</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">ab</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span></span><span class="mord cjk_fallback">（</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">ss</span><span class="mord cjk_fallback">、</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord cjk_fallback">被包含在</span></span></span></span></span>attrs 中，同时自动透传至 button 上）。</li>
</ul>
<h4 data-id="heading-4">4. inheritAttrs: false 后的差异（关键避坑点）</h4>
<p>当子组件设置 inheritAttrs: false 后，两者的差异更明显：</p>
<ul>
<li>Vue2 中：class、style 依然会自动应用到子组件根元素（button），仅未声明的 props（disabled）被拦截在 $attrs 中；</li>
<li>Vue3 中：class、style 会和 disabled 一起被拦截在 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>t</mi><mi>t</mi><mi>r</mi><mi>s</mi><mtext>中，</mtext><mo>∗</mo><mo>∗</mo><mtext>不再自动应用到根元素</mtext><mo>∗</mo><mo>∗</mo><mtext>，需手动写</mtext><mo>&lt;</mo><mi>b</mi><mi>u</mi><mi>t</mi><mi>t</mi><mi>o</mi><mi>n</mi><mi>v</mi><mo>−</mo><mi>b</mi><mi>i</mi><mi>n</mi><mi>d</mi><mo>=</mo><mi mathvariant="normal">"</mi></mrow><annotation encoding="application/x-tex">attrs 中，**不再自动应用到根元素**，需手动写 &lt;button v-bind="</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal">a</span><span class="mord mathnormal">tt</span><span class="mord mathnormal">rs</span><span class="mord cjk_fallback">中，</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord">∗</span><span class="mord cjk_fallback">不再自动应用到根元素</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"/><span class="mord">∗</span><span class="mord cjk_fallback">，需手动写</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"/><span class="mord mathnormal">b</span><span class="mord mathnormal">u</span><span class="mord mathnormal">tt</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">bin</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord">"</span></span></span></span></span>attrs"&gt; 才能将所有属性（含 class/style）透传。</li>
</ul>
<h3 data-id="heading-5">四、常见踩坑场景及解决方案</h3>
<p>掌握变化后，重点解决实际开发中最易遇到的 2 个坑，新手直接套用即可。</p>
<h4 data-id="heading-6">坑点1：子组件根元素不需要 class/style 透传</h4>
<p>场景：父组件传递的 class/style 是给子组件内部某个非根元素用的，根元素有自己的样式，不想继承父组件的 class/style。</p>
<p>解决方案：</p>
<ol>
<li>子组件设置 inheritAttrs: false，关闭默认透传；</li>
<li>通过解构赋值，从 $attrs 中剔除 class 和 style，再将剩余属性透传给目标元素。</li>
</ol>
<pre><code class="hljs language-ts" lang="ts">&lt;!-- 子组件 <span class="hljs-title class_">Child</span>.<span class="hljs-property">vue</span>（<span class="hljs-title class_">Vue3</span>） --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"child-root"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">v-bind</span>=<span class="hljs-string">"restAttrs"</span>&gt;</span>测试按钮<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { useAttrs } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">const</span> props = <span class="hljs-title function_">defineProps</span>([<span class="hljs-string">'title'</span>])
<span class="hljs-keyword">const</span> attrs = <span class="hljs-title function_">useAttrs</span>()
<span class="hljs-comment">// 解构剔除 class 和 style，剩余属性透传给 button</span>
<span class="hljs-keyword">const</span> { <span class="hljs-attr">class</span>: _, <span class="hljs-attr">style</span>: __, ...restAttrs } = attrs
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-7">坑点2：手动透传 $attrs 导致 class/style 重复</h4>
<p>场景：未关闭 inheritAttrs，又手动写 v-bind="$attrs"，导致 class/style 被重复应用（根元素会同时拥有默认透传和手动透传的样式）。</p>
<p>解决方案：</p>
<ul>
<li>要么不手动透传，依赖默认透传行为；</li>
<li>要么设置 inheritAttrs: false，再手动透传 $attrs（按需剔除多余属性）。</li>
</ul>
<h3 data-id="heading-8">五、总结：Vue3 $attrs 变化核心要点</h3>
<p>无需死记硬背，记住 3 个核心要点，轻松应对所有场景：</p>
<ol>
<li>包含范围变化：Vue3 $attrs 包含 class/style，Vue2 不包含；</li>
<li>默认透传：两者一致，未声明的 props（含 class/style）自动透传至根元素；</li>
<li>inheritAttrs 作用：Vue3 中关闭后，class/style 会被一同拦截，需手动控制透传。</li>
</ol>
<p>Vue3 对 $attrs 的改动，本质是简化了属性透传的逻辑，让开发者能更灵活地控制属性传递，但也带来了新的踩坑点。掌握本文的差异对比和实操方案，就能轻松规避风险，高效运用 props 穿透开发 Vue3 组件～</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScript事件循环（下） - requestAnimationFrame与Web Workers]]></title>    <link>https://juejin.cn/post/7602072652606767144</link>    <guid>https://juejin.cn/post/7602072652606767144</guid>    <pubDate>2026-02-02T10:03:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602072652606767144" data-draft-id="7602072652606750760" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScript事件循环（下） - requestAnimationFrame与Web Workers"/> <meta itemprop="keywords" content="前端,JavaScript"/> <meta itemprop="datePublished" content="2026-02-02T10:03:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="wuhen_n"/> <meta itemprop="url" content="https://juejin.cn/user/4149996261738233"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScript事件循环（下） - requestAnimationFrame与Web Workers
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4149996261738233/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    wuhen_n
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T10:03:09.000Z" title="Mon Feb 02 2026 10:03:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>如何实现丝滑流畅的 60fps 动画？如何在单线程 JavaScript 中实现真正的并行计算？本篇文章将探索事件循环的高阶应用。</p>
</blockquote>
<h2 data-id="heading-0">前言：从60fps的动画说起</h2>
<p>在 JavaScript 中，常见的动画实现方式有以下三种：</p>
<h3 data-id="heading-1">使用setInterval（不推荐）</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">animateWithSetInterval</span>(<span class="hljs-params"/>) {
    <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">updateAnimation</span>();
        <span class="hljs-title function_">renderFrame</span>();
    }, <span class="hljs-number">16.67</span>); 
}
</code></pre>
<p>上述代码试图达到60fps（1000/60 ≈ 16.67ms），但定时器不精确，可能丢帧或过度绘制。</p>
<h3 data-id="heading-2">递归setTimeout</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">animateWithSetTimeout</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">loop</span>(<span class="hljs-params"/>) {
        <span class="hljs-title function_">updateAnimation</span>();
        <span class="hljs-title function_">renderFrame</span>();
        <span class="hljs-built_in">setTimeout</span>(loop, <span class="hljs-number">16.67</span>);
    }
    <span class="hljs-title function_">loop</span>();
}
</code></pre>
<p>这种方式比 setInterval 稍好，但仍可能和屏幕刷新不同步。</p>
<h3 data-id="heading-3">使用requestAnimationFrame（推荐）</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">animateWithRAF</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">loop</span>(<span class="hljs-params">timestamp</span>) {
        <span class="hljs-title function_">updateAnimation</span>(timestamp);
        <span class="hljs-title function_">renderFrame</span>();
        <span class="hljs-title function_">requestAnimationFrame</span>(loop);
    }
    <span class="hljs-title function_">requestAnimationFrame</span>(loop);
}
</code></pre>
<p>优势：自动匹配屏幕刷新率，节省资源。</p>
<h2 data-id="heading-4">requestAnimationFrame：动画的黄金标准</h2>
<h3 data-id="heading-5">什么是requestAnimationFrame？</h3>
<p><code>requestAnimationFrame</code>（简称 <code>rAF</code>） 是浏览器专门为动画和连续视觉更新提供的 API。它的核心特点是：</p>
<ul>
<li>在浏览器下一次重绘之前调用指定的回调函数，确保动画与屏幕刷新同步。</li>
</ul>
<h3 data-id="heading-6">rAF的基本用法</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">animate</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// 更新动画状态</span>
    <span class="hljs-title function_">updateAnimation</span>();
    
    <span class="hljs-comment">// 渲染当前帧</span>
    <span class="hljs-title function_">renderFrame</span>();
    
    <span class="hljs-comment">// 请求下一帧</span>
    <span class="hljs-title function_">requestAnimationFrame</span>(animate);
}

<span class="hljs-comment">// 启动动画循环</span>
<span class="hljs-title function_">requestAnimationFrame</span>(animate);
</code></pre>
<h3 data-id="heading-7">rAF的优势</h3>
<ol>
<li>自动匹配显示器刷新率（通常是60Hz）</li>
<li>页面不可见时自动暂停，节省资源</li>
<li>浏览器可以优化动画性能</li>
<li>提供精确的时间戳参数</li>
</ol>
<h3 data-id="heading-8">rAF的工作原理</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">experimentRAF</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'实验开始'</span>);
    
    <span class="hljs-comment">// 记录帧数</span>
    <span class="hljs-keyword">let</span> frameCount = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> lastTimestamp = <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">frameCallback</span>(<span class="hljs-params">timestamp</span>) {
        frameCount++;
        
        <span class="hljs-comment">// 计算帧间隔</span>
        <span class="hljs-keyword">if</span> (lastTimestamp &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">const</span> interval = timestamp - lastTimestamp;
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`第<span class="hljs-subst">${frameCount}</span>帧，间隔: <span class="hljs-subst">${interval.toFixed(<span class="hljs-number">2</span>)}</span>ms`</span>);
        }
        
        lastTimestamp = timestamp;
        
        <span class="hljs-keyword">if</span> (frameCount &lt; <span class="hljs-number">10</span>) {
            <span class="hljs-title function_">requestAnimationFrame</span>(frameCallback);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'实验结束，平均帧率:'</span>, (<span class="hljs-number">1000</span> / ((timestamp - startTime) / <span class="hljs-number">10</span>)).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">1</span>), <span class="hljs-string">'fps'</span>);
        }
    }
    
    <span class="hljs-keyword">const</span> startTime = performance.<span class="hljs-title function_">now</span>();
    <span class="hljs-title function_">requestAnimationFrame</span>(frameCallback);
}
</code></pre>
<p><code>rAf</code> 的关键点在于：<code>frameCallback()</code> 回调中的 <code>timestamp</code> 参数，这个 <code>timestamp</code> 是<code>performance.now()</code> 返回的高精度时间，也表示回调开始执行的时间。</p>
<h3 data-id="heading-9">rAF在事件循环中的位置</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'1. setTimeout - 宏任务'</span>);
    
    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'2. setTimeout中的微任务'</span>);
    });
}, <span class="hljs-number">0</span>);

<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'3. Promise - 微任务'</span>);
    
    <span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'4. Promise中注册的rAF'</span>);
    });
});

<span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'5. 直接注册的rAF'</span>);
    
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'6. rAF中注册的setTimeout'</span>);
    }, <span class="hljs-number">0</span>);
});

<span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'7. queueMicrotask - 微任务'</span>);
});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'8. 同步代码'</span>);
</code></pre>
<p>上述代码的输出顺序如下：</p>
<ul>
<li>8.同步代码</li>
<li>3.Promise - 微任务</li>
<li>7.queueMicrotask - 微任务</li>
<li>1.setTimeout - 宏任务</li>
<li>2.setTimeout中的微任务</li>
<li>5.直接注册的rAF</li>
<li>4.Promise中注册的rAF</li>
<li>6.rAF中注册的setTimeout</li>
</ul>
<p>其执行过程如下：</p>
<ol>
<li>执行宏任务 (setTimeout, 事件回调等)</li>
<li>执行微任务 (Promise, queueMicrotask等)</li>
<li>执行rAF回调 (动画更新)</li>
<li>样式计算和布局</li>
<li>绘制 (Paint)</li>
<li>合成 (Composite)</li>
<li>检查空闲，执行 requestIdleCallback 回调</li>
</ol>
<h2 data-id="heading-10">Web Workers：真正的多线程编程</h2>
<h3 data-id="heading-11">什么是Web Workers？</h3>
<p><code>Web Workers</code> 允许 JavaScript 在后台线程中运行脚本，而不会阻塞主线程。这意味着我们可以执行CPU密集型任务，而不会影响页面的响应性。</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 主线程代码</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'主线程: 开始'</span>);

<span class="hljs-comment">// 创建一个Worker</span>
<span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'worker.js'</span>);

<span class="hljs-comment">// 向Worker发送消息</span>
worker.<span class="hljs-title function_">postMessage</span>({
    <span class="hljs-attr">type</span>: <span class="hljs-string">'CALCULATE'</span>,
    <span class="hljs-attr">data</span>: { <span class="hljs-attr">numbers</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>] }
});

<span class="hljs-comment">// 接收Worker的消息</span>
worker.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> result = event.<span class="hljs-property">data</span>;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'主线程: 收到Worker结果'</span>, result);
    
    <span class="hljs-comment">// 更新UI</span>
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'result'</span>).<span class="hljs-property">textContent</span> = <span class="hljs-string">`结果: <span class="hljs-subst">${result}</span>`</span>;
};

<span class="hljs-comment">// 处理Worker错误</span>
worker.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Worker错误:'</span>, error);
};

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'主线程: 继续执行其他任务...'</span>);
</code></pre>
<h3 data-id="heading-12">Worker的限制：</h3>
<ol>
<li>无法访问DOM</li>
<li>无法使用window、document等</li>
<li>不能执行同步的XHR（可以使用fetch）</li>
<li>有同源策略限制</li>
<li>不能加载本地文件（file://协议）</li>
</ol>
<h3 data-id="heading-13">Web Workers的类型</h3>
<h4 data-id="heading-14">1. 专用Worker (Dedicated Worker)</h4>
<p>只能被创建它的脚本使用：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> dedicatedWorker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'dedicated-worker.js'</span>);
</code></pre>
<h4 data-id="heading-15">2. 共享Worker (Shared Worker)</h4>
<p>可以被多个脚本共享（同源）：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">SharedWorker</span>) {
    <span class="hljs-keyword">const</span> sharedWorker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SharedWorker</span>(<span class="hljs-string">'shared-worker.js'</span>);
    
    <span class="hljs-comment">// 通过port通信</span>
    sharedWorker.<span class="hljs-property">port</span>.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'收到共享Worker消息:'</span>, event.<span class="hljs-property">data</span>);
    };
    
    sharedWorker.<span class="hljs-property">port</span>.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">'Hello Shared Worker'</span>);
} <span class="hljs-keyword">else</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'浏览器不支持Shared Worker'</span>);
}
</code></pre>
<h4 data-id="heading-16">3. Service Worker</h4>
<p>用于离线缓存、推送通知等：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">if</span> (<span class="hljs-string">'serviceWorker'</span> <span class="hljs-keyword">in</span> navigator) {
    navigator.<span class="hljs-property">serviceWorker</span>.<span class="hljs-title function_">register</span>(<span class="hljs-string">'service-worker.js'</span>)
        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">registration</span> =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Service Worker注册成功:'</span>, registration);
        })
        .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Service Worker注册失败:'</span>, error);
        });
}
</code></pre>
<h4 data-id="heading-17">4. Audio Worklet (Chrome 66+)</h4>
<p>用于高性能音频处理：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">audioContext</span> &amp;&amp; <span class="hljs-variable language_">window</span>.<span class="hljs-property">audioContext</span>.<span class="hljs-property">audioWorklet</span>) {
    audioContext.<span class="hljs-property">audioWorklet</span>.<span class="hljs-title function_">addModule</span>(<span class="hljs-string">'audio-processor.js'</span>)
        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Audio Worklet加载成功'</span>);
        });
}
</code></pre>
<h4 data-id="heading-18">5. Paint Worklet (CSS Houdini)</h4>
<p>用于自定义CSS绘制：</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">if</span> (<span class="hljs-variable constant_">CSS</span>.<span class="hljs-property">paintWorklet</span>) {
    <span class="hljs-variable constant_">CSS</span>.<span class="hljs-property">paintWorklet</span>.<span class="hljs-title function_">addModule</span>(<span class="hljs-string">'paint-worklet.js'</span>)
        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Paint Worklet加载成功'</span>);
        });
}
</code></pre>
<h2 data-id="heading-19">requestIdleCallback：空闲期任务调度</h2>
<h3 data-id="heading-20">什么是requestIdleCallback？</h3>
<p><code>requestIdleCallback</code> （简称 <code>rIC</code> ）允许开发者在浏览器空闲时期调度任务。这对于执行低优先级或非紧急的工作非常有用，避免影响关键的用户交互和动画。</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> idleCallbackId = <span class="hljs-title function_">requestIdleCallback</span>(<span class="hljs-function">(<span class="hljs-params">deadline</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'空闲回调开始执行'</span>);
    
    <span class="hljs-comment">// deadline对象包含重要信息：</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'剩余时间:'</span>, deadline.<span class="hljs-title function_">timeRemaining</span>(), <span class="hljs-string">'ms'</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'是否超时:'</span>, deadline.<span class="hljs-property">didTimeout</span>);
    
    <span class="hljs-comment">// 在空闲时间内执行任务</span>
    <span class="hljs-keyword">while</span> (deadline.<span class="hljs-title function_">timeRemaining</span>() &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-title function_">hasMoreWork</span>()) {
        <span class="hljs-title function_">doSomeLowPriorityWork</span>();
    }
    
    <span class="hljs-comment">// 如果还有工作未完成，再次安排</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">hasMoreWork</span>()) {
        <span class="hljs-title function_">requestIdleCallback</span>(processLowPriorityWork);
    }
    
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'空闲回调结束'</span>);
}, { <span class="hljs-attr">timeout</span>: <span class="hljs-number">1000</span> }); <span class="hljs-comment">// 设置超时，确保在1秒内执行</span>

<span class="hljs-comment">// 主线程继续执行其他任务</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'主线程继续执行...'</span>);
</code></pre>
<h3 data-id="heading-21">rIC的关键特点：</h3>
<ol>
<li>只在浏览器空闲时执行</li>
<li>提供deadline对象，包含剩余时间信息</li>
<li>可以设置timeout确保执行</li>
<li>适合低优先级、可中断的任务</li>
</ol>
<h3 data-id="heading-22">rIC在事件循环中的位置</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 理解rIC的执行时机</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'=== 事件循环中各API的执行时机 ==='</span>);

<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'1. setTimeout - 宏任务'</span>);
}, <span class="hljs-number">0</span>);

<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'2. Promise - 微任务'</span>);
});

<span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'3. requestAnimationFrame - 动画帧回调'</span>);
    
    <span class="hljs-comment">// 在rAF中安排rIC</span>
    <span class="hljs-title function_">requestIdleCallback</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'5. rAF中安排的rIC - 空闲回调'</span>);
    }, { <span class="hljs-attr">timeout</span>: <span class="hljs-number">100</span> });
});

<span class="hljs-title function_">requestIdleCallback</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'4. 直接安排的rIC - 空闲回调'</span>);
    
    <span class="hljs-comment">// 在rIC中安排微任务</span>
    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'6. rIC中的Promise - 微任务'</span>);
    });
}, { <span class="hljs-attr">timeout</span>: <span class="hljs-number">100</span> });

<span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'7. queueMicrotask - 微任务'</span>);
});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'8. 同步代码'</span>);

</code></pre>
<p>上述代码的输出顺序如下：</p>
<ul>
<li>8.同步代码</li>
<li>2.Promise - 微任务</li>
<li>7.queueMicrotask - 微任务</li>
<li>1.setTimeout - 宏任务</li>
<li>3.requestAnimationFrame - 动画帧回调</li>
<li>4.直接安排的rIC - 空闲回调</li>
<li>6.rIC中的Promise - 微任务</li>
<li>5.rAF中安排的rIC - 空闲回调</li>
</ul>
<p>其执行过程如下：</p>
<ol>
<li>执行宏任务 (setTimeout, 事件回调等)</li>
<li>执行微任务 (Promise, queueMicrotask等)</li>
<li>执行rAF回调 (动画更新)</li>
<li>样式计算和布局</li>
<li>绘制 (Paint)</li>
<li>合成 (Composite)</li>
<li>检查空闲时间，如果有空闲，则执行rIC回调；否则等待下一帧。</li>
</ol>
<h2 data-id="heading-23">核心概念总结</h2>
<h3 data-id="heading-24">requestAnimationFrame (rAF)：</h3>
<ul>
<li>是什么：浏览器提供的动画API，在每次重绘前执行回调</li>
<li>为什么用：自动匹配显示器刷新率，页面不可见时暂停，节省资源</li>
<li>最佳时机：视觉更新、动画、连续状态变化</li>
<li>执行位置：在微任务之后，重绘之前</li>
</ul>
<h3 data-id="heading-25">Web Workers：</h3>
<ul>
<li>是什么：允许JavaScript在后台线程运行的技术</li>
<li>为什么用：执行CPU密集型任务而不阻塞主线程</li>
<li>限制：无法访问DOM，通过消息传递通信</li>
<li>类型：专用Worker、共享Worker、Service Worker等</li>
</ul>
<h4 data-id="heading-26">requestIdleCallback (rIC)：</h4>
<ul>
<li>是什么：在浏览器空闲时调度任务的API</li>
<li>为什么用：执行低优先级、非紧急任务</li>
<li>关键对象：deadline包含剩余时间和超时信息</li>
<li>执行位置：在一帧的最后，如果有空闲时间</li>
</ul>
<h2 data-id="heading-27">结语</h2>
<p>本文简单介绍了<code>requestAnimationFrame</code>、<code>Web Workers</code>、<code>requestIdleCallback</code> 的基本用法和对比，对于文章中错误的地方或者有任何问题，欢迎在评论区留言讨论！</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[别再用 Web 思路搞 Node 服务打包了！这可能是你“地狱级”痛苦的根源]]></title>    <link>https://juejin.cn/post/7602091087922397234</link>    <guid>https://juejin.cn/post/7602091087922397234</guid>    <pubDate>2026-02-02T10:00:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602091087922397234" data-draft-id="7602072073134047259" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="别再用 Web 思路搞 Node 服务打包了！这可能是你“地狱级”痛苦的根源"/> <meta itemprop="keywords" content="JavaScript,Node.js,前端"/> <meta itemprop="datePublished" content="2026-02-02T10:00:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="donecoding"/> <meta itemprop="url" content="https://juejin.cn/user/3192637500430093"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            别再用 Web 思路搞 Node 服务打包了！这可能是你“地狱级”痛苦的根源
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3192637500430093/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    donecoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T10:00:41.000Z" title="Mon Feb 02 2026 10:00:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>🚀 <strong>省流助手（速通结论）：</strong></p>
<ol>
<li><strong>思维脱钩</strong>：Node 服务不是 Web 组件。放弃“单文件 Bundle”执念，改走  <strong>“业务代码打包 + 生产环境安装依赖”</strong>  的工业化路径。</li>
<li><strong>物理隔离</strong>：将所有 Node 原生依赖标记为 <code>external</code>，利用 Node 原生模块查找机制对抗打包工具的“环境互操作性”误判。</li>
<li><strong>路径安全</strong>：在 ESM 环境下彻底告别 <code>__dirname</code>，坚持使用 <code>import.meta.url</code> 动态寻址，确保物理路径的绝对确定性。</li>
<li><strong>运维友好</strong>：依赖外置不仅是为了避坑，更是为了满足生产环境的 <strong>SCA 安全扫描</strong> 与 <strong>应急热修复</strong> 主权。</li>
</ol>
</blockquote>
<hr/>
<p>一、 观念降维：为什么 Web 必须 Bundle，而 Node 不需要？</p>
<p>在前端 Web 开发中，<strong>Bundle Everything</strong> 是绝对真理。因为浏览器没有文件系统，必须通过极致合并来减少 HTTP 请求并解决兼容性。</p>
<p>但在 Node.js 环境下，你的代码运行在 <strong>操作系统</strong> 之上。Node.js 有一套近乎完美的模块查找算法（<code>node_modules</code> 检索层级），这是它的根基。<strong>强行把所有依赖揉进一个单文件，本质上是在破坏 Node.js 的“物理寻址逻辑”。</strong></p>
<hr/>
<p>二、 Web 思路打包 Node 服务的“三大深坑”</p>
<p>如果你坚持用 Web 的“单文件”思路去打包 Node 服务，你一定会遇到以下灾难：</p>
<ol>
<li>原生二进制模块 (Native Addons)</li>
</ol>
<p>像图像处理（<code>sharp</code>、<code>canvas</code>）、加密或高性能日志库（<code>pino</code>），内部包含 <code>.node</code> 后缀的 C++ 二进制代码。</p>
<ul>
<li><strong>Bundle 结局</strong>：打包工具无法将二进制代码塞进 JS 文本。单文件运行时，会因无法在虚拟路径中定位物理 <code>.node</code> 文件而直接崩溃。</li>
</ul>
<ol start="2">
<li>动态路径陷阱：告别 <code>__dirname</code></li>
</ol>
<p>很多开发者在打包时纠结 <code>__dirname</code> 丢失。如果你还试图靠打包工具去模拟它，说明你的思维还没转过来。</p>
<ul>
<li><strong>Bundle 结局</strong>：一旦打包，原本深层嵌套的目录结构被拍平，模拟的 <code>__dirname</code> 往往指向错误的 <code>dist</code> 目录。</li>
<li><strong>工业级做法</strong>：在 ESM 环境下，直接使用原生 Node.js URL API 进行动态寻址：</li>
</ul>
<p>javascript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { fileURLToPath } <span class="hljs-keyword">from</span> <span class="hljs-string">'node:url'</span>;
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">'node:path'</span>;

<span class="hljs-keyword">const</span> __filename = <span class="hljs-title function_">fileURLToPath</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>);
<span class="hljs-keyword">const</span> __dirname = path.<span class="hljs-title function_">dirname</span>(__filename); <span class="hljs-comment">// 物理位置 100% 准确</span>
</code></pre>
<p>请谨慎使用此类代码。</p>
<ol start="3">
<li>Interop (互操作性) 灾难</li>
</ol>
<p>Node 的 <code>CommonJS</code> 和 <code>ESM</code> 混用机制极其复杂。</p>
<ul>
<li><strong>Bundle 结局</strong>：打包工具在转换 <code>import</code> 和 <code>require</code> 时，极易弄坏 <code>default</code> 导出。你遇到的 <code>TypeError: ct.destination is not a function</code> 往往就是因为打包工具把一个 CJS 模块错误地包裹成了代理对象。</li>
</ul>
<hr/>
<p>三、 维度升级：为什么运维（SRE）更喜欢“依赖外置”？</p>
<p>这是 Web 出身的开发者最容易忽略的视角：<strong>在线上生产环境，依赖外置是运维同学的“刚需”。</strong></p>
<ul>
<li>
<p><strong>安全审计的“黑盒” vs “透明件”</strong> ：</p>
<ul>
<li><strong>外置模式</strong>：运维通过 <strong>SCA（软件成分分析）工具</strong> 扫描 <code>lock</code> 文件即可毫秒级识别 CVE 漏洞。</li>
<li><strong>Bundle 模式</strong>：你交付的是几十万行压缩混淆后的代码。安全扫描器无法穿透混淆后的变量名，整个应用变成了不可控的安全死角。</li>
</ul>
</li>
<li>
<p><strong>应急热修复 (Hotfix)</strong> ：<br/>
如果凌晨 3 点发现某个深度依赖包有致命 Bug，<strong>外置模式</strong>允许运维直接进入容器修改 <code>node_modules</code> 里的某行代码救火。而 <strong>Bundle 模式</strong> 除了全量重新打包发布，没有任何自救手段。</p>
</li>
</ul>
<hr/>
<p>四、 工业级标准方案：从“折腾打包”转向“环境交付”</p>
<p>既然单文件打包是自寻死路，那么“正规军”的标配流程是什么？</p>
<ol>
<li>拦截模式：Vite/Rollup 仅作为“转译器”</li>
</ol>
<p>在配置中将所有 <code>dependencies</code> 标记为 <code>external</code>。Vite 只负责把你的 TS 业务代码转换成轻量的 MJS，不介入任何依赖的处理。</p>
<ol start="2">
<li>交付模式：生产环境“现场”安装</li>
</ol>
<p>利用 Docker 的分阶段构建（Multi-stage Builds），这才是真正的工业化部署：</p>
<ol>
<li><strong>准备环境</strong>：在 Docker 镜像中 <strong>COPY <code>package.json</code></strong>。</li>
<li><strong>现场安装</strong>：<strong>RUN <code>pnpm install --prod</code></strong>。这一步在目标容器（通常是 Linux）中执行，确保原生模块针对该系统完成正确的编译，彻底规避跨平台兼容性问题。</li>
<li><strong>放入业务</strong>：<strong>COPY <code>dist/</code></strong>  产物。</li>
<li><strong>启动</strong>：让 Node.js 原生的模块加载器去处理最稳健的依赖加载。</li>
</ol>
<hr/>
<p>五、 总结：造轮子是为了看清路</p>
<ul>
<li><strong>前端思维</strong>：追求产物极小、高度混淆、单兵作战（Bundle）。</li>
<li><strong>后端思维</strong>：追求 <strong>环境一致性、运行时确定性、二进制兼容性（Environment）</strong> 。</li>
</ul>
<p>放弃“单文件打包”是对开发者精神健康的极大保护。承认 Node 环境的复杂性，拥抱  <strong>“外置依赖 + 容器化安装”</strong> ，这才是从 Web 开发者向后端架构进化的必经之路。</p>
<p><strong>总结一句话：Web 项目看体积，Node 项目看环境。</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[1. 《手写系列：面试官问我 new 的原理，我直接甩出三个版本》]]></title>    <link>https://juejin.cn/post/7602057555453100086</link>    <guid>https://juejin.cn/post/7602057555453100086</guid>    <pubDate>2026-02-02T10:16:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602057555453100086" data-draft-id="7602106969697435711" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="1.  《手写系列：面试官问我 new 的原理，我直接甩出三个版本》"/> <meta itemprop="keywords" content="前端,JavaScript,面试"/> <meta itemprop="datePublished" content="2026-02-02T10:16:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="NEXT06"/> <meta itemprop="url" content="https://juejin.cn/user/1176918763246011"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            1.  《手写系列：面试官问我 new 的原理，我直接甩出三个版本》
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1176918763246011/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    NEXT06
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T10:16:48.000Z" title="Mon Feb 02 2026 10:16:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>今天我们来聊聊 JavaScript 中那个既熟悉又神秘的 new 操作符。相信很多小伙伴在面试时都经历过这样的“名场面”：面试官微微一笑，推过来那个熟悉的键盘：“来，能不能手写一个 new 的实现？”</p>
<p>这时候，如果你只是背诵了代码，稍微问深一点可能就露怯了。今天，我们就把这个“黑盒”拆开，从底层原理到完美实现，彻底搞懂它！</p>
<h2 data-id="heading-0">一、核心原理拆解：new 到底干了啥？</h2>
<p>我们在日常开发中，const person = new Person('Fog', 18) 写得飞起。但 new 背后到底发生了什么？</p>
<p>简单来说，new 就是一个**“生产车间”**。它拿着你的图纸（构造函数），给你造出一个实实在在的产品（实例对象）。</p>
<p>这个过程，标准流程只有四步（<strong>核心四步法</strong>）：</p>
<ol>
<li><strong>建空房</strong>：创建一个全新的空对象 {}。</li>
<li><strong>挂牌子</strong>：将这个空对象的原型链（<strong>proto</strong>）链接到构造函数的原型对象（prototype）上。（这步最关键，决定了你能用这一类的公共方法）。</li>
<li><strong>搞装修</strong>：将构造函数内部的 this 指向这个新对象，并执行构造函数。（给对象添加属性，如 name, age）。</li>
<li><strong>交钥匙</strong>：判断构造函数的返回值。如果构造函数自己返回了一个对象（或函数），那就以它为准；否则，默认返回我们在第一步创建的那个新对象。</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4e4e774510f34a1f939d6be9ffff69f9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTkVYVDA2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770632211&amp;x-signature=f%2FrTmjtqgL8ZpJ4wkqgbSOA3X6o%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-1">二、面试官到底在考什么？</h2>
<p>面试官让你手写 new，绝对不是为了看你默写代码。通过这寥寥几行代码，他在考察你以下四大内功：</p>
<ol>
<li><strong>原型链的理解</strong>：你知不知道实例和类是怎么关联起来的？</li>
<li><strong>this 指向机制</strong>：你懂不懂怎么用 call 或 apply 改变函数执行上下文？</li>
<li><strong>函数参数处理</strong>：面对不定参数，你会用 arguments 还是 ...args？</li>
<li><strong>边界情况处理</strong>：**这是高分点！**如果构造函数里写了 return，你的代码还能正常工作吗？</li>
</ol>
<h2 data-id="heading-2">三、手写进阶之路</h2>
<p>接下来，我们由浅入深，演示三个版本的实现。</p>
<h3 data-id="heading-3">V1.0 青铜版：ES5 经典写法</h3>
<p>这是最基础的写法，也是很多老教材里的标准答案。我们需要处理 arguments 这个“伪数组”。</p>
<p>JavaScript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name, age</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
}
<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayName</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);
}

<span class="hljs-comment">// 核心实现</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">objectFactory</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// 1. 创建一个空对象</span>
    <span class="hljs-keyword">var</span> obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();
    
    <span class="hljs-comment">// 2. 获取构造函数</span>
    <span class="hljs-comment">// arguments 是类数组，没有 shift 方法，我们借用数组原型的 shift</span>
    <span class="hljs-comment">// 这行代码有两个作用：取出第一个参数(Constructor)，同时 arguments 里剩下的就是参数了</span>
    <span class="hljs-keyword">var</span> <span class="hljs-title class_">Constructor</span> = [].<span class="hljs-property">shift</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>);
    
    <span class="hljs-comment">// 3. 链接原型：让 obj 能访问 Person.prototype 上的属性</span>
    obj.<span class="hljs-property">__proto__</span> = <span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
    
    <span class="hljs-comment">// 4. 绑定 this 并执行</span>
    <span class="hljs-comment">// 使用 apply 将 remaining arguments 传进去</span>
    <span class="hljs-keyword">var</span> result = <span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">apply</span>(obj, <span class="hljs-variable language_">arguments</span>);
    
    <span class="hljs-comment">// 5. 返回值处理</span>
    <span class="hljs-comment">// 这是一个常见的简易判断，但其实有漏洞（稍后在王者版揭晓）</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> result === <span class="hljs-string">'object'</span> &amp;&amp; result !== <span class="hljs-literal">null</span> ? result : obj;
}

<span class="hljs-comment">// 测试</span>
<span class="hljs-keyword">var</span> awei = <span class="hljs-title function_">objectFactory</span>(<span class="hljs-title class_">Person</span>, <span class="hljs-string">'阿伟'</span>, <span class="hljs-number">20</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(awei.<span class="hljs-property">name</span>); <span class="hljs-comment">// 阿伟</span>
awei.<span class="hljs-title function_">sayName</span>(); <span class="hljs-comment">// 阿伟</span>
</code></pre>
<p><strong>重点解析：</strong></p>
<ul>
<li><strong>为什么用 [].shift.call(arguments)？</strong><br/>
arguments 是一个<strong>类数组对象</strong>（有 length，有索引，但没数组方法）。通过 call，我们强行让它借用了数组的 shift 方法，切掉并拿到了第一个参数（构造函数），剩下的正好传给 apply。</li>
</ul>
<h3 data-id="heading-4">V2.0 黄金版：ES6 现代化写法</h3>
<p>时代变了，我们有了更优雅的语法糖。<strong>proto</strong> 虽然好用，但在生产环境中被视为非标准（尽管浏览器支持），性能也不如 Object.create。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/59290eb3064b48eda78106277f7618d5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTkVYVDA2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770632211&amp;x-signature=gbL0RA9ortuG5RDAesKnZZ9CqKE%3D" alt="image.png" loading="lazy"/>
JavaScript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 使用 ...args 剩余参数，告别 arguments</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">objectFactory</span>(<span class="hljs-params">Constructor, ...args</span>) {
    <span class="hljs-comment">// 1. &amp; 2. 创建对象并直接链接原型</span>
    <span class="hljs-comment">// Object.create(proto) 创建一个新对象，带着指定的原型，性能更好，更符合规范</span>
    <span class="hljs-keyword">const</span> obj = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
    
    <span class="hljs-comment">// 3. 执行构造函数</span>
    <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">apply</span>(obj, args);
    
    <span class="hljs-comment">// 4. 返回值处理 (依然沿用旧逻辑)</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> result === <span class="hljs-string">'object'</span> &amp;&amp; result !== <span class="hljs-literal">null</span> ? result : obj;
}
</code></pre>
<p><strong>重点解析：</strong></p>
<ul>
<li><strong>Object.create 的优势</strong>：它直接创建一个已经连接好原型的对象，避免了创建后再修改 <strong>proto</strong> 指针带来的性能损耗（修改原型链在 V8 引擎中是非常昂贵的操作）。</li>
</ul>
<h3 data-id="heading-5">V3.0 王者版：无懈可击的最终版</h3>
<p>注意了！如果你能写出这个版本，面试官绝对会对你刮目相看。</p>
<p>在 V1 和 V2 中，我们对返回值的判断是 typeof result === 'object'。这有一个巨大的<strong>隐形漏洞</strong>：<br/>
<strong>如果构造函数返回的是一个 function 呢？</strong></p>
<p>在 JS 原生 new 中，如果构造函数返回函数，new 表达式的结果就是那个函数。但 typeof function 是 'function' 而不是 'object'，之前的代码会错误地返回 obj 实例。</p>
<p>JavaScript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">objectFactory</span>(<span class="hljs-params">Constructor, ...args</span>) {
    <span class="hljs-comment">// 0. 参数校验 (严谨性加分项)</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Constructor</span> !== <span class="hljs-string">'function'</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">'Constructor must be a function'</span>);
    }

    <span class="hljs-comment">// 1. 创建对象，链接原型</span>
    <span class="hljs-keyword">const</span> obj = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
    
    <span class="hljs-comment">// 2. 绑定 this 执行</span>
    <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">apply</span>(obj, args);
    
    <span class="hljs-comment">// 3. 完美的返回值处理（关键修正！）</span>
    <span class="hljs-comment">// 如果 result 是对象(非null) 或者 是函数，则返回 result</span>
    <span class="hljs-comment">// 否则返回新创建的 obj</span>
    <span class="hljs-keyword">const</span> isObject = <span class="hljs-keyword">typeof</span> result === <span class="hljs-string">'object'</span> &amp;&amp; result !== <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">const</span> isFunction = <span class="hljs-keyword">typeof</span> result === <span class="hljs-string">'function'</span>;
    
    <span class="hljs-keyword">return</span> (isObject || isFunction) ? result : obj;
}

<span class="hljs-comment">// 验证特殊情况</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Factory</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'I am a function'</span>); };
}
<span class="hljs-keyword">const</span> test = <span class="hljs-title function_">objectFactory</span>(<span class="hljs-title class_">Factory</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> test); <span class="hljs-comment">// "function" —— 逻辑正确！</span>
</code></pre>
<h2 data-id="heading-6">四、总结</h2>
<p>你看，所谓的“手写源码”，其实就是对基础知识的排列组合。</p>
<ol>
<li><strong>创建</strong>：Object.create</li>
<li><strong>执行</strong>：Function.prototype.apply</li>
<li><strong>判断</strong>：类型检测与逻辑运算</li>
</ol>
<p>掌握了这三点，new 操作符对你来说就不再是黑盒。下次面试遇到，直接展示“王者版”，告诉面试官：<strong>我不止会写，我还知道为什么要这么写。</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OpenClaw深度体验：从安装到飞书插件配置]]></title>    <link>https://juejin.cn/post/7602072652605964328</link>    <guid>https://juejin.cn/post/7602072652605964328</guid>    <pubDate>2026-02-02T08:41:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602072652605964328" data-draft-id="7602072652605947944" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OpenClaw深度体验：从安装到飞书插件配置"/> <meta itemprop="keywords" content="人工智能,AIGC"/> <meta itemprop="datePublished" content="2026-02-02T08:41:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="迷人的少侠"/> <meta itemprop="url" content="https://juejin.cn/user/3246229002392461"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OpenClaw深度体验：从安装到飞书插件配置
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3246229002392461/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    迷人的少侠
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T08:41:34.000Z" title="Mon Feb 02 2026 08:41:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读7分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">云服务器部署openclaw</h2>
<h3 data-id="heading-1">openclaw介绍</h3>
<p>OpenClaw（曾用名 Clawdbot、Moltbot）是近期 AI 圈现象级的开源项目（当前已12.2w star了，还在疯涨）。 本质是一个<strong>本地优先的个人 AI 助手平台</strong>，可以部署在你的电脑或服务器上，让你通过聊天工具（如飞书、Telegram、WhatsApp）直接操控它完成各种任务。</p>
<p><strong>它为什么突然火了？</strong></p>
<ul>
<li>
<p><strong>真正 “做事” 的 AI 助手</strong></p>
<p>它不像 ChatGPT 只会聊天，而是能直接执行操作：收发邮件、管理日程、运行本地脚本、查询数据等。</p>
<p>比如你在飞书发一句 “帮我整理上周的销售数据并生成表格”，它就能直接在你的电脑上完成。</p>
</li>
<li>
<p><strong>本地部署 + 数据可控</strong></p>
<p>所有指令和数据都在你的设备上运行，聊天记录、文件、API 密钥都不会上传到第三方云端，对隐私敏感的用户非常有吸引力。</p>
</li>
<li>
<p><strong>多渠道交互体验</strong></p>
<p>支持飞书、钉钉、Telegram、WhatsApp 等几十种聊天工具作为 “遥控器”。</p>
<p>你可以在手机上发消息，让家里或云端的电脑自动干活，实现了 “随时随地远程指挥”。</p>
</li>
<li>
<p><strong>改名引发关注</strong></p>
<p>项目在一周内从 Clawdbot → Moltbot → OpenClaw 连续更名，加上 GitHub Star 数 10 天暴涨至 12 万 +，在开发者社区和社交平台引发了大量讨论。</p>
</li>
<li>
<p><strong>AI 智能体社区的出圈事件</strong></p>
<p>衍生出的 AI 智能体社交平台 Moltbook 里，AI 们自发成立了 “数字宗教”、撰写经文，让这个项目在科技圈和社交媒体彻底爆火。</p>
</li>
</ul>
<p>参考项目github地址， <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenclaw%2Fopenclaw" target="_blank" title="https://github.com/openclaw/openclaw" ref="nofollow noopener noreferrer">github.com/openclaw/op…</a></p>
<p>本文从安装openclaw，到安装飞书插件，再通过飞书控制openclaw完成简单的任务，带领大家完整简单体验一下openclaw功能。</p>
<p>话不多说，开始openclaw体验之旅。</p>
<h3 data-id="heading-2">安装openclaw</h3>
<p>环境要求：node版本 &gt;= 22</p>
<p>登录云服务器后，输入</p>
<pre><code class="hljs language-sql" lang="sql">npm install <span class="hljs-operator">-</span>g openclaw<span class="hljs-variable">@latest</span>

openclaw onboard <span class="hljs-comment">--install-daemon</span>
</code></pre>
<p>如果在安装的过程中碰到问题，请直接使用AI自行解决，基本都是依赖不存在或者node版本低的问题</p>
<p>安装完成后，输入<code>openclaw --version</code>，即可查看版本信息，就说明安装成功</p>
<pre><code class="hljs language-css" lang="css">openclaw <span class="hljs-attr">--version</span>
<span class="hljs-number">2026.1</span>.<span class="hljs-number">29</span>
</code></pre>
<h3 data-id="heading-3">启动openclaw</h3>
<pre><code class="hljs language-css" lang="css">openclaw onboard <span class="hljs-attr">--install-daemon</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d32b92233e954aeea8beaffea0904759~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=7rOIZoIfFxQ02X5DCWpVr%2BZGr3Q%3D" alt="" loading="lazy"/></p>
<p>了解项目的风险后，选择安装模式quickstart</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/41f611ddfe9849dbb3ffc44baf2fe8b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=XCdlwdP2MztFhalRG2hZmSA06MA%3D" alt="" loading="lazy"/></p>
<p>之后选择模型提供商和默认模型，这里选择的是openrouter 默认模型选择claude-haiku-4.5，便宜写先体验下 之后选择对话工具</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6399462a3415466eb3716d26e716fe88~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=ULZh72HCCsbEglhKc1ajOQVLsIg%3D" alt="" loading="lazy"/></p>
<p>先不装，用的时候再说，跳过 之后需要安装skills，也先跳过，用的时候再装</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4a94a7ec976d4045bbbaa53ba23ed763~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=zfFApZSWt%2FPV64Y40ZDm0cFL4D8%3D" alt="" loading="lazy"/></p>
<p>接下来要安装google，gemini等api key，可以跳过</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5848a543e7ac488d9eae2d75fc690e1b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=8sKC7HVwyAfMIJHS0Ee0UgSFc%2Bg%3D" alt="" loading="lazy"/></p>
<p>接下来启动hooks，可以先都勾选上</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c37d9d9d3ba243f09a6ddd295b4bc5e3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=1JZyPR%2FeTC3kpJeT5AY8xkLdqsY%3D" alt="" loading="lazy"/></p>
<p>之后，会给出一些提示信息，这里最好先保存一下，因为后边会用到 这里重要的有3条</p>
<ol>
<li>web ui地址</li>
<li>web ui(with token)地址</li>
<li>如果忘记token，可以使用openclaw dashboard --no-open获取</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c39f83e4cae41939ebceba94256c1af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=2zibzcjzFy%2FnbCuepAQmKdKzAnE%3D" alt="" loading="lazy"/></p>
<p>安装完成，服务启动成功，就可以开始使用了</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f485d797b09e4578baf35852f055708f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=xno3UjKsAZ3JEC89m9V4%2F5QZ3nA%3D" alt="" loading="lazy"/></p>
<p>打开浏览器页面，输入上一步返回的web ui(with token)地址即可在浏览器访问openclaw</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb53115bace64234861908b0b95802c1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=IROQQKT9CZlr6lxxu4zJ0z1z3%2BA%3D" alt="" loading="lazy"/></p>
<p>well done！接下来就开始体验openclaw功能</p>
<h2 data-id="heading-4">跟飞书打通</h2>
<h3 data-id="heading-5">安装飞书插件</h3>
<p>插件地址：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fm1heng%2FClawdbot-feishu" target="_blank" title="https://github.com/m1heng/Clawdbot-feishu" ref="nofollow noopener noreferrer">github.com/m1heng/Claw…</a></p>
<p>具体安装方法，可以参考插件安装步骤，下边带大家一步一步安装一下</p>
<h4 data-id="heading-6">安装插件</h4>
<pre><code class="hljs language-bash" lang="bash">openclaw plugins install @m1heng-clawd/feishu
</code></pre>
<h4 data-id="heading-7">创建应用</h4>
<p>进入<a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.feishu.cn%2F" target="_blank" title="https://open.feishu.cn/" ref="nofollow noopener noreferrer">飞书开发者后台</a>，创建应用</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b812fa2deba4ee2a6423f654bdc27d2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=JQ38qx1JgwAGRyczcLB%2Ba%2FqhtpA%3D" alt="" loading="lazy"/></p>
<p>获取应用app id和app secret</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ae8a7f9a6d54fed9884a9ded9cb5ef9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=HK17oLjFcc%2BP3iMyCsFf62%2BdmWk%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-8">设置权限</h4>
<p>需要开通如下几项权限</p>
<ol>
<li>contact:user.base:readonly 获取基本用户信息</li>
<li>im:message 发送和接收消息</li>
<li>im:message.p2p_msg:readonly 阅读机器人发送的信息（默认开启，不需要开通）</li>
<li>im:message.group_at_msg:readonly 在群组中接收 @提及 消息（默认开启，不需要开通）</li>
<li>im:message:send_as_bot 以机器人身份发送消息</li>
<li>im:resource 上传和下载图片/文件</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c51e551149454f4384c201c7f6fe09d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=B2LB5y7u2pTlprMyffQpEQOS3Vo%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-9">配置事件订阅</h4>
<p>在【事件与回调】页面配置事件订阅方式，选择长连接接收方式 此时会报错，应用未建立长连接</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9150c8f00b6943bba495d3c0f7072618~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=F994RSKdqZLjslWza%2F1EVY9qHAA%3D" alt="" loading="lazy"/></p>
<p>报错的原因：在飞书开发者后台选择了 “使用长连接接收事件”，但<strong>本地 / 服务器端没有通过飞书 SDK 启动长连接客户端</strong>，导致飞书平台检测不到有效连接。</p>
<p>所以需要在本地用sdk建立一个长连接</p>
<pre><code class="hljs language-ini" lang="ini">from lark_oapi.api.im.v1 import *
from lark_oapi.ws import Client as WsClient

<span class="hljs-comment"># 1. 创建长连接客户端（直接传入 app_id 和 app_secret）</span>
<span class="hljs-attr">ws_client</span> = WsClient(
    <span class="hljs-attr">app_id</span>=<span class="hljs-string">"cli_xxxxx"</span>,
    <span class="hljs-attr">app_secret</span>=<span class="hljs-string">"xxxxxx"</span>,
)

<span class="hljs-comment"># 2. 启动长连接</span>
ws_client.start()
</code></pre>
<p>启动后，即可在页面配置长连接接收事件，保存</p>
<p>添加活动订阅</p>
<ul>
<li>im.message.receive_v1 接收消息（必填）</li>
<li>im.message.message_read_v1 消息已读回执</li>
<li>im.chat.member.bot.added_v1 机器人已添加到群组</li>
<li>im.chat.member.bot.deleted_v1 机器人已从群组中移除</li>
</ul>
<h4 data-id="heading-10">给openclaw设置app id和app secret</h4>
<pre><code class="hljs language-arduino" lang="arduino">openclaw config set channels.feishu.appId <span class="hljs-string">"cli_xxxxx"</span>
openclaw config set channels.feishu.appSecret <span class="hljs-string">"your_app_secret"</span>
openclaw config set channels.feishu.enabled <span class="hljs-literal">true</span>
</code></pre>
<h4 data-id="heading-11">重启openclaw</h4>
<p>停止之前openclaw的服务，重新启动</p>
<p><code>openclaw onboard --install-daemon</code></p>
<p>可以看到飞书插件已安装成功</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e1fab079db254a3aa7b76115dd96689d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=TD30e%2FUXZeCv26WOmbAQoeCrN6Q%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-12">给飞书发信息</h3>
<p>在web ui里，给飞书发送条消息试一下</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/888ee0089c6b4d31aacd7e22e8e2e225~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=jKhnrbwrm8ebjQStYaH4whhHN0w%3D" alt="image-33" loading="lazy"/></p>
<p>image-33</p>
<p>它提示需要用户id和消息内容</p>
<h4 data-id="heading-13">获取用户id</h4>
<p>在飞书开放平台，找到<a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.feishu.cn%2Fdocument%2Fserver-docs%2Fim-v1%2Fmessage%2Fcreate" target="_blank" title="https://open.feishu.cn/document/server-docs/im-v1/message/create" ref="nofollow noopener noreferrer">服务端API</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/30fba1b45fcb46138528f7c29e80a458~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=%2BtCQFcwUVLhhQ0Ly0y0GwFQ508U%3D" alt="" loading="lazy"/></p>
<p>右侧调试台，选择tenant_access_token，点击获取token</p>
<p>receive_id_type选择open_id-&gt;快速复制 open_id，即可获取到open_id</p>
<h4 data-id="heading-14">给飞书发消息</h4>
<p>输入如下内容</p>
<pre><code class="hljs">给用户 ou_xxxxxx发送消息 
消息内容为：hello world,这是openclaw发送的第一条消息
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/444dc0d98a2c4652b86a668a988cb7f0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=RagkwJuqlEdGgbDg53ZtjExdoi8%3D" alt="" loading="lazy"/></p>
<p>飞书即可收到应用发来的第一条openclaw消息</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/376206ee8db14bf097471021cf40a19f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=7ThYOKEWmkASSgFLXrZy92mfHHg%3D" alt="" loading="lazy"/></p>
<p>来看看openclaw是怎么处理的</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1878e2713dff4905956021ce97efb06a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=G8BZrSzPpiMo4lM5iYkiYmVKlXk%3D" alt="" loading="lazy"/></p>
<p>收到消息处理后发送给飞书，最后还跟人一样，等着看他们怎么回复，真的像一个员工一样，完成任务，在等待你的回复，还有点不开心呢，有意思。😄</p>
<p>这样就实现了openclaw与飞书的打通，然后就可以用飞书控制openclaw处理任务了😄</p>
<h2 data-id="heading-15">用飞书给openclaw发信息完成任务</h2>
<p>在飞书里跟openclaw机器人对话，让他帮我们处理任务</p>
<h3 data-id="heading-16">让他看网页</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6d2448ce80cb44b9a9570bb12059b5b2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=AYLmcSeUb6eDDTdzrl4P1IpDnwE%3D" alt="" loading="lazy"/></p>
<p>最厉害的是他在处理的过程中，还在飞书消息上回复了一个处理中的小表情，有点可爱呢😊</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b6707e25033c4200b91e08adc51c2fd3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=E0SSz7iLKsUvCmqgwDDQMRfqjD4%3D" alt="" loading="lazy"/></p>
<p>不出所料，确实能处理我们的需求 来看看他是怎么处理的</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f73f54acc5e47128cffcb7e2717395a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=82TBlIzc05K8fv0fPs8cjqfmMpY%3D" alt="" loading="lazy"/></p>
<ol>
<li>监听并处理飞书消息</li>
<li>分析消息，调用web_fetch工具读取网页内容</li>
<li>按照要求总结概括</li>
<li>发送处理后结果到飞书</li>
</ol>
<h3 data-id="heading-17">让他创建提醒</h3>
<p>再试试看能不能让他设置一个提醒，目标是在飞书日历中设置一个日程</p>
<p>在openclaw ui中发送消息<code>给ou_xxxxx创建一个日程，提醒他明天中午12点吃午饭</code></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e750d437c394e528187dbe28a3652fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=mQ1p95HtLQ15n6Q3sE0qz9Ep44g%3D" alt="" loading="lazy"/></p>
<p>最终在飞书对话中会收到一个消息</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ae74087bb4248838e8df230567e84ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=eAg%2B5oAWxfV%2B%2FiAG5PAAVC8Aqk4%3D" alt="" loading="lazy"/></p>
<p>看整体处理逻辑，是openclaw创建了一个cron定时任务，会在明天12点发送一个飞书消息，提醒我吃饭 不是通过在飞书中创建日程的方式 推测应该是没有开通飞书创建日程的权限，所以它采用了本地创建定时任务的方式，第二天12点发送飞书消息提醒吃饭，也是完成了输入的要求。</p>
<h2 data-id="heading-18">总结</h2>
<p>本文主要完成了3个小任务</p>
<ol>
<li>在云服务器安装openclaw</li>
<li>配置openclaw飞书插件，与飞书打通</li>
<li>在飞书发送消息，控制openclaw完成任务</li>
</ol>
<p>作为初体验，本文试用了openclaw非常简单的功能，只是冰山一角，后续可以继续探索探索openclaw有没有其他有意思和实用的玩法。</p>
<h2 data-id="heading-19">写在最后</h2>
<p>看一下本文使用claude Haiku 4.5模型完成试验总共接口调用的开销。 $0.327美元，还是不错的。</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/720706cad25c45e0aff175a7d4fb8e00~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-35Lq655qE5bCR5L6g:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770626494&amp;x-signature=nI3RNCfEbPRqfcaGa4Ep4U2Pp2o%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-20">附录</h2>
<ul>
<li>openclaw github：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenclaw%2Fopenclaw" target="_blank" title="https://github.com/openclaw/openclaw" ref="nofollow noopener noreferrer">github.com/openclaw/op…</a></li>
<li>飞书插件github：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fm1heng%2FClawdbot-feishu" target="_blank" title="https://github.com/m1heng/Clawdbot-feishu" ref="nofollow noopener noreferrer">github.com/m1heng/Claw…</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[VMware+Ubuntu实战：虚拟磁盘修复与LVM分区扩容完整解决方案]]></title>    <link>https://juejin.cn/post/7602057555452788790</link>    <guid>https://juejin.cn/post/7602057555452788790</guid>    <pubDate>2026-02-02T09:24:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602057555452788790" data-draft-id="7602057555452756022" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="VMware+Ubuntu实战：虚拟磁盘修复与LVM分区扩容完整解决方案"/> <meta itemprop="keywords" content="Linux"/> <meta itemprop="datePublished" content="2026-02-02T09:24:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeoSpud"/> <meta itemprop="url" content="https://juejin.cn/user/3643116396493131"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            VMware+Ubuntu实战：虚拟磁盘修复与LVM分区扩容完整解决方案
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3643116396493131/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeoSpud
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T09:24:50.000Z" title="Mon Feb 02 2026 09:24:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读7分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">VMware+Ubuntu实战：虚拟磁盘修复与LVM分区扩容完整解决方案</h2>
<h4 data-id="heading-1">前言</h4>
<p>在使用 VMware 运行 Ubuntu 虚拟机时，常会遇到两个核心问题：一是虚拟磁盘因强制关机、宿主机崩溃导致损坏，提示「需要修复」；二是初始磁盘空间不足，通过 VMware 扩容后，Ubuntu 系统无法识别新增空间。本文结合真实操作场景，从「磁盘修复→VMware 扩容→Ubuntu LVM 分区扩容」全程拆解，提供可直接复制的命令和避坑指南，新手也能快速上手。</p>
<hr/>
<h3 data-id="heading-2">一、场景说明</h3>
<ul>
<li><strong>环境</strong>：Windows 宿主机 + VMware Workstation/Player + Ubuntu 20.04/22.04（LVM 分区格式）</li>
<li><strong>核心问题</strong>：</li>
</ul>
<ol start="0">
<li>VMware 提示「指定的虚拟磁盘需要进行修复」；</li>
<li>虚拟磁盘从 10G 扩容到 35G 后，Ubuntu 仅识别 9.8G，剩余空间未利用；</li>
<li>磁盘分区表显示<code>GPT PMBR size mismatch</code>（GPT/MBR 标识不匹配）。</li>
</ol>
<ul>
<li><strong>最终目标</strong>：修复虚拟磁盘 + 让 Ubuntu 完全识别 35G 空间，根目录可用空间≥20G。</li>
</ul>
<hr/>
<h3 data-id="heading-3">二、第一步：修复 VMware 虚拟磁盘（Windows 宿主机操作）</h3>
<p>虚拟磁盘损坏多因强制关机、文件占用冲突导致，优先用 VMware 自带工具修复，无需复杂命令。</p>
<h4 data-id="heading-4">前提准备</h4>
<ol start="0">
<li>关闭故障虚拟机，<strong>完全退出 VMware</strong>（右键任务栏 VMware 图标→退出，避免进程占用）；</li>
<li>备份虚拟机核心文件：找到虚拟机安装目录，复制<code>.vmdk</code>（磁盘文件）、<code>.vmx</code>（配置文件）到其他磁盘，防止修复失败；</li>
<li>确保宿主机剩余空间≥虚拟磁盘实际占用大小的 10%（如虚拟盘用 7.5G，留 1G 以上）。</li>
</ol>
<h4 data-id="heading-5">方法 1：VMware 图形化修复（推荐）</h4>
<ol start="0">
<li>启动 VMware，选中故障虚拟机（<strong>不要开机</strong>）；</li>
<li>点击顶部「编辑虚拟机设置」→ 左侧「硬盘」→ 右侧「实用工具」（低版本在「高级」中）；</li>
<li>先点击「检查」：VMware 自动扫描磁盘错误，等待进度条完成；</li>
<li>扫描出错误后，点击「修复」，完成后关闭设置，尝试启动虚拟机。</li>
</ol>
<blockquote>
<p>🔧 避坑：若「修复」按钮灰色，重启宿主机后再试（彻底释放文件占用）。</p>
</blockquote>
<h4 data-id="heading-6">方法 2：命令行修复（图形化失效时）</h4>
<p>若图形化工具修复失败，用 VMware 自带的<code>vmware-vdiskmanager</code>命令兜底：</p>
<ol start="0">
<li>以管理员身份打开 CMD，切换到 VMware 安装目录（默认路径）：</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># VMware Workstation</span>
​
<span class="hljs-built_in">cd</span> C:\Program Files (x86)\VMware\VMware Workstation
​
<span class="hljs-comment"># VMware Player</span>
​
<span class="hljs-built_in">cd</span> C:\Program Files\VMware\VMware Player
</code></pre>
<ol start="0">
<li>执行修复命令（替换为你的<code>.vmdk</code>路径，带空格需用双引号）：</li>
</ol>
<pre><code class="hljs language-arduino" lang="arduino">vmware-vdiskmanager -r <span class="hljs-string">"D:\VM\Ubuntu\Ubuntu.vmdk"</span> -t <span class="hljs-number">0</span> <span class="hljs-string">"D:\VM\Ubuntu\Ubuntu_fix.vmdk"</span>
</code></pre>
<ol start="0">
<li>修复完成后，打开 VMware→编辑虚拟机设置→移除原损坏硬盘→「添加」→「使用现有虚拟磁盘」→选中<code>_fix.vmdk</code>，启动虚拟机。</li>
</ol>
<hr/>
<h3 data-id="heading-7">三、第二步：VMware 扩容虚拟磁盘（Windows 宿主机操作）</h3>
<p>磁盘修复后，通过 VMware 扩展虚拟磁盘容量（以 10G 扩到 35G 为例）：</p>
<ol start="0">
<li>关闭 Ubuntu 虚拟机，打开 VMware→编辑虚拟机设置→「硬盘」→「扩展」；</li>
<li>输入扩容后的总大小（如 35G），点击「确定」（VMware 会自动扩展<code>.vmdk</code>文件）；</li>
<li>启动 Ubuntu 虚拟机，此时系统尚未识别新增空间，需后续分区扩容。</li>
</ol>
<hr/>
<h3 data-id="heading-8">四、第三步：Ubuntu LVM 分区扩容（虚拟机内操作）</h3>
<p>Ubuntu 默认采用 LVM 分区格式，VMware 扩容后需手动将新增空间分配给根目录，核心是「创建 LVM 分区→加入卷组→扩容逻辑卷」。</p>
<h4 data-id="heading-9">1. 查看磁盘状态（确认问题）</h4>
<p>先执行以下命令，了解当前磁盘使用和分区情况：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 查看磁盘挂载和使用情况</span>
​
<span class="hljs-built_in">df</span> -h
​
<span class="hljs-comment"># 查看磁盘分区详情（确认扩容后的总大小和未分配空间）</span>
​
sudo fdisk -l /dev/sda
​
<span class="hljs-comment"># 查看磁盘分区结构（确认LVM关联关系）</span>
​
lsblk /dev/sda
</code></pre>
<h5 data-id="heading-10">关键输出解读：</h5>
<ul>
<li><code>df -h</code>：根目录<code>/</code>仅 9.8G，使用率 81%（空间不足）；</li>
<li><code>fdisk -l /dev/sda</code>：磁盘总大小 35G，但最后一个分区<code>sda3</code>仅 18.2G，剩余 16.8G 未分配，且提示<code>GPT PMBR size mismatch</code>（无需单独修复，后续会自动同步）；</li>
<li><code>lsblk /dev/sda</code>：<code>sda3</code>关联 LVM 逻辑卷<code>ubuntu--vg-ubuntu--lv</code>（根目录挂载点），新增空间未被利用。</li>
</ul>
<h4 data-id="heading-11">2. 创建新 LVM 分区（占用未分配空间）</h4>
<p>使用<code>parted</code>工具创建 LVM 格式分区，适配 GPT 分区表：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 进入parted交互式工具</span>
​
sudo parted /dev/sda
</code></pre>
<p>进入后依次输入以下指令（按回车执行，无需额外输入）：</p>
<pre><code class="hljs language-csharp" lang="csharp">mkpart primary <span class="hljs-number">41940992</span>s <span class="hljs-number">100</span>%  <span class="hljs-meta"># 从sda3末尾扇区（41940991）的下一个扇区开始，占满剩余空间</span>
​
<span class="hljs-keyword">set</span> <span class="hljs-number">4</span> lvm <span class="hljs-keyword">on</span>  <span class="hljs-meta"># 标记新分区（sda4）为LVM格式</span>
​
quit  <span class="hljs-meta"># 退出parted</span>
</code></pre>
<blockquote>
<p>✅ 说明：</p>
<p><code>41940992s</code></p>
<p>需根据你的</p>
<p><code>sda3</code></p>
<p>最后扇区调整（用</p>
<p><code>fdisk -l /dev/sda</code></p>
<p>查看），确保无缝衔接未分配空间。</p>
</blockquote>
<h4 data-id="heading-12">3. 刷新分区表，识别新分区</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 刷新分区表，让系统识别sda4</span>
​
sudo partprobe /dev/sda
​
<span class="hljs-comment"># 验证新分区是否创建成功（能看到sda4即正常）</span>
​
lsblk /dev/sda
</code></pre>
<h4 data-id="heading-13">4. LVM 核心扩容命令（直接复制执行）</h4>
<p>将新分区<code>sda4</code>加入现有 LVM 卷组，扩容根目录逻辑卷：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. 将sda4创建为LVM物理卷</span>
​
sudo pvcreate /dev/sda4
​
<span class="hljs-comment"># 2. 把物理卷加入现有卷组ubuntu-vg（卷组名用vgs命令可查）</span>
​
sudo vgextend ubuntu-vg /dev/sda4
​
<span class="hljs-comment"># 3. 将根目录逻辑卷扩容到卷组最大可用空间（占满35G）</span>
​
sudo lvextend -l +100%FREE /dev/mapper/ubuntu--vg-ubuntu--lv
​
<span class="hljs-comment"># 4. 刷新文件系统，让系统立即识别扩容后的空间</span>
​
sudo resize2fs /dev/mapper/ubuntu--vg-ubuntu--lv
</code></pre>
<blockquote>
<p>🔧 避坑：若执行</p>
<p><code>resize2fs</code></p>
<p>提示</p>
<p><code>bad magic number in super-block</code></p>
<p>，说明文件系统为 XFS，替换为：</p>
<p><code>sudo xfs_growfs /dev/mapper/ubuntu--vg-ubuntu--lv</code></p>
<p>。</p>
</blockquote>
<h4 data-id="heading-14">5. 验证扩容结果（关键步骤）</h4>
<p>执行以下命令，确认扩容成功：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">df</span> -h
</code></pre>
<h5 data-id="heading-15">成功标识：</h5>
<p>根目录<code>/</code>的<code>Size</code>显示 33G 左右（35G 虚拟盘系统预留 2G），可用空间≥20G，使用率降至 25% 左右，如下：</p>
<pre><code class="hljs language-bash" lang="bash">/dev/mapper/ubuntu--vg-ubuntu--lv   33G  7.5G   24G  25% /
</code></pre>
<hr/>
<h3 data-id="heading-16">五、常见问题与避坑指南</h3>
<h4 data-id="heading-17">1. 修复磁盘时提示「文件被占用」</h4>
<ul>
<li>解决：任务管理器结束<code>vmware.exe</code>、<code>vmware-vmx.exe</code>进程，或重启宿主机。</li>
</ul>
<h4 data-id="heading-18">2. 创建分区时提示<code>Partition(s) on /dev/sda are being used</code></h4>
<ul>
<li>解决：无需担心，<code>parted</code>支持在线分区，直接按步骤执行即可，不会丢失数据。</li>
</ul>
<h4 data-id="heading-19">3. 扩容后根目录大小未变化</h4>
<ul>
<li>排查：是否漏执行<code>resize2fs</code>（刷新文件系统），或卷组名、逻辑卷路径错误（用<code>vgs</code>、<code>lvs</code>命令确认）。</li>
</ul>
<h4 data-id="heading-20">4. <code>GPT PMBR size mismatch</code>提示未消失</h4>
<ul>
<li>说明：该提示是 VMware 扩容后分区表标识不同步导致，无需单独修复，扩容完成后再次执行<code>sudo fdisk -l /dev/sda</code>，提示会自动消失。</li>
</ul>
<hr/>
<h3 data-id="heading-21">六、后续维护建议</h3>
<ol start="0">
<li>定期清理系统冗余，保持空间充裕：</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 清理apt缓存、无用软件和7天前日志</span>

sudo apt autoremove --purge -y &amp;&amp; sudo apt clean -y &amp;&amp; journalctl --vacuum-time=7d -y

<span class="hljs-comment"># 删除临时文件</span>

sudo <span class="hljs-built_in">rm</span> -rf /tmp/* /var/tmp/*
</code></pre>
<ol start="0">
<li>避免强制关闭虚拟机，优先使用 Ubuntu 内「关机」功能，防止磁盘损坏；</li>
<li>若需再次扩容，重复「VMware 扩展磁盘→创建 LVM 分区→LVM 扩容」流程即可；</li>
<li>大文件（镜像、压缩包）建议存放在<code>/home</code>目录，避免根目录快速占满。</li>
</ol>
<hr/>
<h3 data-id="heading-22">总结</h3>
<p>本文从实际场景出发，完整覆盖了「VMware 虚拟磁盘修复→磁盘扩容→Ubuntu LVM 分区扩容」的全流程，核心是利用 VMware 自带工具修复磁盘，通过 LVM 分区管理实现空间扩展。所有命令均经过实战验证，步骤清晰、避坑指南到位，适合新手和有同类需求的开发者参考。如果遇到具体报错，可根据报错信息核对步骤或留言交流～</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[别让你的 AI 像个实习生！从 Skills 到 MCP：教你如何给大模型装上‘工业级’机械臂]]></title>    <link>https://juejin.cn/post/7602100217656541226</link>    <guid>https://juejin.cn/post/7602100217656541226</guid>    <pubDate>2026-02-02T09:36:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602100217656541226" data-draft-id="7602059064522063915" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="别让你的 AI 像个实习生！从 Skills 到 MCP：教你如何给大模型装上‘工业级’机械臂"/> <meta itemprop="keywords" content="AI编程,AIGC,人工智能"/> <meta itemprop="datePublished" content="2026-02-02T09:36:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Roger_zz"/> <meta itemprop="url" content="https://juejin.cn/user/1913628905977070"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            别让你的 AI 像个实习生！从 Skills 到 MCP：教你如何给大模型装上‘工业级’机械臂
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1913628905977070/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Roger_zz
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T09:36:32.000Z" title="Mon Feb 02 2026 09:36:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">什么是 Skills？</h2>
<p><strong>—— 环境赋予的“本地超能力”</strong></p>
<p>Skills 是 Claude（以及现在的 OpenCode, Trae 等 AI 编程工具）提出或广泛采用的一种机制。它不是模型原本就有的，而是<strong>环境</strong>提供给模型的。</p>
<h3 data-id="heading-1">1. 核心定义</h3>
<p><strong>Skills 是“寄生”在宿主环境中的功能代码片段。</strong></p>
<ul>
<li><strong>提出者/推动者</strong>：Claude (Anthropic) 及其生态工具（如 Claude Engineer, OpenCode）。</li>
<li><strong>本质</strong>：它是<strong>一段本地代码</strong>（通常是 Python 或 JavaScript）。</li>
<li><strong>生存条件</strong>：必须依赖<strong>环境支持</strong>。如果 OpenCode 没打开，或者你没安装这个软件，这个 Skill 就不存在。</li>
</ul>
<h3 data-id="heading-2">2. 运行机制：OpenCode 是怎么工作的？</h3>
<p>当你在 OpenCode 里跟 AI 说话时，后台发生了这 4 步“隐形操作”：</p>
<ol>
<li>
<p><strong>检索</strong> ：</p>
<ul>
<li>OpenCode 启动时，会扫描一个固定文件夹比如 <code>/.opencode/skills/</code> 或类似路径）。</li>
<li>它会读取这里面所有的脚本，提取出它们的<strong>描述（Description）</strong> 。</li>
<li><em>注意：这时候代码还没跑，只是把“说明书”拿出来了。</em></li>
</ul>
</li>
<li>
<p><strong>注入</strong> ：</p>
<ul>
<li>当你提问时，OpenCode 会把这些“说明书”悄悄塞进 System Prompt 里。</li>
<li>告诉模型：“我手里有这些工具（Skills），你需要的时候可以叫我。”</li>
</ul>
</li>
<li>
<p><strong>决策与调用</strong> ：</p>
<ul>
<li>模型判断需要用工具，返回一个特殊的 Tag 或 JSON。</li>
<li><strong>关键点</strong>：OpenCode 拦截到这个请求，在<strong>本地环境</strong>运行那个文件夹里的代码。</li>
</ul>
</li>
<li>
<p><strong>结果反馈</strong> ：</p>
<ul>
<li>代码运行结果（比如文件读取的内容、终端报错信息）被捕获。</li>
<li>结果被转换成文本，再次塞回对话<strong>上下文</strong>中。</li>
</ul>
</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f20a8065ce214a25b78278bf56668978~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9nZXJfeno=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770630175&amp;x-signature=vI%2BSdpwuxACh9yHUz4jqc4SOmGU%3D" alt="Gemini_Generated_Image_fz9ctufz9ctufz9c.png" loading="lazy"/></p>
<h2 data-id="heading-3">什么是 MCP？</h2>
<p><strong>—— 标准化的“通用外设接口”</strong></p>
<p>MCP 是由 Anthropic 牵头推出的一套<strong>开放协议</strong>。它不再依赖于某个软件（比如 OpenCode）内部的特定文件夹或特定环境，而是建立了一种<strong>Client-Server（客户端-服务器）</strong> 的连接标准。</p>
<h3 data-id="heading-4">1. 核心定义</h3>
<p><strong>MCP 是连接 AI 模型与数据源/工具的“通用语言”。</strong></p>
<ul>
<li><strong>提出者</strong>：Anthropic（为了解决各个 AI 软件工具不通用的碎片化问题）。</li>
<li><strong>本质</strong>：它是一个<strong>独立的进程</strong>（Process），通过标准通信协议（JSON-RPC）与主程序对话。</li>
<li><strong>生存条件</strong>：MCP Server 自己就是一个小程序，OpenCode 只是去“连接”它，而不是“包含”它。</li>
</ul>
<h3 data-id="heading-5">2. 运行机制：OpenCode 是怎么连接 MCP 的？</h3>
<p>同样的，我们把场景放在 OpenCode 里。但这次，OpenCode 不再是去文件夹里找脚本，而是像<strong>拨打电话</strong>一样去连接一个服务。</p>
<p>后台的 4 步“隐形操作”如下：</p>
<ol>
<li>
<p><strong>握手与连接</strong> ：</p>
<ul>
<li>OpenCode 启动时，根据配置文件（config），启动后台的 MCP Server 进程（比如一个 SQLite 数据库服务）。</li>
<li>两者建立<strong>通信管道</strong>（通常是 <code>stdio</code> 标准输入输出）。</li>
<li><em>区别：Skills 是扫描静态文件，MCP 是启动动态进程。</em></li>
</ul>
</li>
<li>
<p><strong>能力协商</strong> ：</p>
<ul>
<li>OpenCode 发问：“你有什么本事？”（发送 <code>tools/list</code> 请求）。</li>
<li>MCP Server 回答：“我可以查询 User 表，我可以插入数据...”（返回 JSON 格式的工具列表）。</li>
<li>OpenCode 把这些能力塞给大模型。</li>
</ul>
</li>
<li>
<p><strong>远程调用</strong> ：</p>
<ul>
<li>大模型决定调用工具。</li>
<li><strong>关键点</strong>：OpenCode <strong>不执行代码</strong>，它只是个“传声筒”。它把请求打包成一个 JSON 消息，发送给 MCP Server。</li>
<li>MCP Server 在自己的进程里干活（查库、调接口），非常稳定。</li>
</ul>
</li>
<li>
<p><strong>管道回传</strong> ：</p>
<ul>
<li>MCP Server 干完活，把结果打包成 JSON 发回给 OpenCode。</li>
<li>OpenCode 再喂给大模型。</li>
</ul>
</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65544d2e93354395b90115225c1bea0d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9nZXJfeno=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770630175&amp;x-signature=2iozfWKGpO3tm9QVllZK2xrKm3U%3D" alt="Gemini_Generated_Image_8hh87v8hh87v8hh8.png" loading="lazy"/></p>
<h2 data-id="heading-6">MCP和Skills的区别</h2>
<p>从架构实现和运行时的角度来看，Skills 和 MCP 的区别主要体现在<strong>进程模型</strong>和<strong>耦合度</strong>上。</p>
<h3 data-id="heading-7">1. 运行时环境的区别</h3>
<ul>
<li>
<p><strong>Skills</strong> ：</p>
<p>Skills 本质上是<strong>宿主环境的一部分</strong>。</p>
<p>在 OpenCode 这种 IDE Agent 场景下，Skills 通常就是一段 Python 或 JS 脚本。当 Agent 决定调用 Skill 时，实际上是 OpenCode 的主进程或者其派生的子进程直接加载并执行了这段代码。</p>
<ul>
<li><strong>特点</strong>：它和宿主环境是<strong>强耦合</strong>的。环境直接持有代码，直接负责解释执行。</li>
<li><strong>局限</strong>：它的上下文完全依赖于当前 IDE 的环境配置（比如 Python 解释器路径、依赖库）。</li>
</ul>
</li>
<li>
<p><strong>MCP</strong> ：</p>
<p>MCP 采用的是标准的 <strong>C/S 架构</strong> 。</p>
<p>MCP Server 是一个完全独立的<strong>外部进程</strong>。OpenCode 仅仅是作为一个 Client，通过标准输入输出（Stdio）或者网络套接字（Socket），利用 JSON-RPC 协议跟这个外部进程通信。</p>
<ul>
<li><strong>特点</strong>：它是<strong>松耦合</strong>的。OpenCode 不关心 Server 是用 Rust 写的还是 Go 写的，只关心协议对不对。</li>
</ul>
</li>
</ul>
<h3 data-id="heading-8">2. 稳定性与故障隔离：为何涉及 DB 必须用 MCP？</h3>
<p>比如数据库操作，这正是架构选型的分水岭。</p>
<ul>
<li>
<p><strong>Skills 的风险</strong>：</p>
<p>如果你用 Skills 写一个数据库连接脚本，它是运行在 OpenCode 的关联进程里的。</p>
<p>一旦这个脚本出现内存泄漏、死循环，或者因为没有处理好连接池导致 IO 阻塞，它会直接影响宿主程序的性能，甚至导致 IDE 卡死、崩溃。这种<strong>缺乏故障隔离</strong>的设计，做做本地文件读写（IO 开销小、无状态）还行，做复杂业务就是埋雷。</p>
</li>
<li>
<p><strong>MCP 的优势</strong>：</p>
<p>MCP 实现了<strong>进程级隔离</strong> 。</p>
<p>当你连接数据库时，连接池维护、SQL 执行全部在独立的 MCP Server 进程里完成。</p>
<ul>
<li><strong>稳妥之处</strong>：即便数据库驱动崩溃了（Crash），或者查询超时导致挂起，死的只是那个 MCP Server 进程，OpenCode 依然活得好好的，只需要捕获一个 RPC Error 即可。</li>
<li><strong>状态管理</strong>：MCP Server 可以常驻后台维持数据库的长连接状态，而 Skills 这种一次性脚本很难做到这一点。</li>
</ul>
</li>
</ul>
<h3 data-id="heading-9">总结一下</h3>
<p>Skills 是<strong>插件化思维</strong>，适合轻量级、无状态、依赖宿主环境上下文的本地操作（如 <code>fs.read</code>）。</p>
<p>MCP 是<strong>微服务思维</strong>，适合重量级、有状态、需要故障隔离的复杂业务集成（如 <code>Database</code>）。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Langchain-向量数据库（VectorStore）知识总结]]></title>    <link>https://juejin.cn/post/7602072073133948955</link>    <guid>https://juejin.cn/post/7602072073133948955</guid>    <pubDate>2026-02-02T09:29:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602072073133948955" data-draft-id="7601843005007626250" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Langchain-向量数据库（VectorStore）知识总结"/> <meta itemprop="keywords" content="后端"/> <meta itemprop="datePublished" content="2026-02-02T09:29:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="心在飞扬AI"/> <meta itemprop="url" content="https://juejin.cn/user/1556564194366823"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Langchain-向量数据库（VectorStore）知识总结
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1556564194366823/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    心在飞扬AI
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T09:29:38.000Z" title="Mon Feb 02 2026 09:29:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    15
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">向量数据库（VectorStore）知识总结</h2>
<h3 data-id="heading-1">1. 带阀值的相似性搜索</h3>
<h4 data-id="heading-2">知识点</h4>
<ul>
<li><strong>FAISS向量数据库</strong>：Facebook AI Similarity Search，高效的向量相似性搜索库</li>
<li><strong>相似性得分阈值</strong>：只返回相似度超过指定阈值的结果</li>
<li><strong>similarity_search_with_relevance_scores()</strong>：返回文档及其相关性得分</li>
</ul>
<h4 data-id="heading-3">用途</h4>
<p>当需要过滤掉低相似度结果时使用，确保返回的结果与查询足够相关。</p>
<h4 data-id="heading-4">示例代码</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_community.vectorstores <span class="hljs-keyword">import</span> FAISS
<span class="hljs-keyword">from</span> langchain_core.documents <span class="hljs-keyword">import</span> Document
<span class="hljs-keyword">from</span> langchain_community.embeddings <span class="hljs-keyword">import</span> QianfanEmbeddingsEndpoint

<span class="hljs-comment"># 创建文档集合</span>
documents = [
    Document(page_content=<span class="hljs-string">"笨笨是一只很喜欢睡觉的猫咪"</span>, metadata={<span class="hljs-string">"page"</span>: <span class="hljs-number">1</span>}),
    Document(page_content=<span class="hljs-string">"我喜欢在夜晚听音乐，这让我感到放松。"</span>, metadata={<span class="hljs-string">"page"</span>: <span class="hljs-number">2</span>}),
    <span class="hljs-comment"># ... 更多文档</span>
]

<span class="hljs-comment"># 构建向量数据库</span>
db = FAISS.from_documents(documents, embedding)

<span class="hljs-comment"># 带阈值的相似性搜索（只返回相似度&gt;0.4的结果）</span>
results = db.similarity_search_with_relevance_scores(
    <span class="hljs-string">"我养了一只猫，叫笨笨"</span>,
    score_threshold=<span class="hljs-number">0.4</span>
)
</code></pre>
<hr/>
<h3 data-id="heading-5">2. as_retriever检索器</h3>
<h4 data-id="heading-6">知识点</h4>
<ul>
<li><strong>as_retriever()</strong>：将向量数据库转换为标准检索器接口</li>
<li><strong>search_type参数</strong>：
<ul>
<li><code>similarity</code>：标准相似性搜索</li>
<li><code>similarity_score_threshold</code>：带阈值的相似性搜索</li>
<li><code>mmr</code>：最大边际相关性搜索</li>
</ul>
</li>
<li><strong>search_kwargs参数</strong>：
<ul>
<li><code>k</code>：返回结果数量</li>
<li><code>score_threshold</code>：相似度阈值</li>
</ul>
</li>
<li><strong>ConfigurableField</strong>：使检索器配置可在运行时动态修改</li>
</ul>
<h4 data-id="heading-7">用途</h4>
<p>在RAG（检索增强生成）应用中，向量数据库通常需要转换为检索器才能与LLM链集成。</p>
<h4 data-id="heading-8">示例代码</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_weaviate <span class="hljs-keyword">import</span> WeaviateVectorStore
<span class="hljs-keyword">from</span> langchain_core.runnables <span class="hljs-keyword">import</span> ConfigurableField

<span class="hljs-comment"># 将向量数据库转换为检索器</span>
retriever = db.as_retriever(
    search_type=<span class="hljs-string">"similarity_score_threshold"</span>,
    search_kwargs={<span class="hljs-string">"k"</span>: <span class="hljs-number">10</span>, <span class="hljs-string">"score_threshold"</span>: <span class="hljs-number">0.5</span>},
).configurable_fields(
    search_type=ConfigurableField(<span class="hljs-built_in">id</span>=<span class="hljs-string">"db_search_type"</span>),
    search_kwargs=ConfigurableField(<span class="hljs-built_in">id</span>=<span class="hljs-string">"db_search_kwargs"</span>),
)

<span class="hljs-comment"># 使用默认配置检索</span>
documents = retriever.invoke(<span class="hljs-string">"关于配置接口的信息有哪些"</span>)

<span class="hljs-comment"># 运行时动态修改为MMR搜索</span>
mmr_results = retriever.with_config(
    configurable={
        <span class="hljs-string">"db_search_type"</span>: <span class="hljs-string">"mmr"</span>,
        <span class="hljs-string">"db_search_kwargs"</span>: {<span class="hljs-string">"k"</span>: <span class="hljs-number">4</span>}
    }
).invoke(<span class="hljs-string">"查询内容"</span>)
</code></pre>
<hr/>
<h3 data-id="heading-9">3. 最大边际相关性搜索（MMR）</h3>
<h4 data-id="heading-10">知识点</h4>
<ul>
<li><strong>最大边际相关性（MMR）</strong>：平衡结果的相关性和多样性</li>
<li><strong>max_marginal_relevance_search()</strong>：执行MMR搜索</li>
<li><strong>文档加载与分割</strong>：UnstructuredMarkdownLoader + RecursiveCharacterTextSplitter</li>
<li><strong>WeaviateVectorStore</strong>：云端向量数据库服务</li>
</ul>
<h4 data-id="heading-11">用途</h4>
<p>当需要避免返回过于相似的结果时使用，例如问答系统需要提供多样化的答案。</p>
<h4 data-id="heading-12">示例代码</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_weaviate <span class="hljs-keyword">import</span> WeaviateVectorStore
<span class="hljs-keyword">from</span> langchain_community.document_loaders <span class="hljs-keyword">import</span> UnstructuredMarkdownLoader
<span class="hljs-keyword">from</span> langchain_text_splitters <span class="hljs-keyword">import</span> RecursiveCharacterTextSplitter

<span class="hljs-comment"># 1. 加载并分割文档</span>
loader = UnstructuredMarkdownLoader(file_path)
text_splitter = RecursiveCharacterTextSplitter(
    separators=[<span class="hljs-string">"\n\n"</span>, <span class="hljs-string">"\n"</span>, <span class="hljs-string">"。|！|？"</span>, ...],
    chunk_size=<span class="hljs-number">500</span>,
    chunk_overlap=<span class="hljs-number">50</span>,
)
chunks = text_splitter.split_documents(loader.load())

<span class="hljs-comment"># 2. 存储到向量数据库</span>
db = WeaviateVectorStore(client=..., index_name=<span class="hljs-string">"DatasetDemo"</span>, ...)
db.add_documents(chunks)

<span class="hljs-comment"># 3. 执行MMR搜索（结果更多样化）</span>
search_documents = db.max_marginal_relevance_search(<span class="hljs-string">"关于应用配置的接口有哪些？"</span>)
</code></pre>
<hr/>
<h3 data-id="heading-13">4. 向量数据库检索</h3>
<h4 data-id="heading-14">知识点</h4>
<ul>
<li><strong>运行时可配置检索器</strong>：通过configurable_fields实现动态配置</li>
<li><strong>with_config()方法</strong>：在调用时修改检索器行为</li>
<li><strong>检索器集成模式</strong>：标准化的检索接口，便于与LangChain链集成</li>
</ul>
<h4 data-id="heading-15">用途</h4>
<p>需要根据不同场景动态调整检索策略的应用，例如：</p>
<ul>
<li>不同的查询使用不同的k值</li>
<li>有时用相似性搜索，有时用MMR</li>
<li>根据用户偏好调整阈值</li>
</ul>
<h4 data-id="heading-16">示例代码</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.runnables <span class="hljs-keyword">import</span> ConfigurableField

<span class="hljs-comment"># 创建可配置的检索器</span>
retriever = db.as_retriever(
    search_type=<span class="hljs-string">"similarity_score_threshold"</span>,
    search_kwargs={<span class="hljs-string">"k"</span>: <span class="hljs-number">10</span>, <span class="hljs-string">"score_threshold"</span>: <span class="hljs-number">0.5</span>},
).configurable_fields(
    search_type=ConfigurableField(<span class="hljs-built_in">id</span>=<span class="hljs-string">"db_search_type"</span>),
    search_kwargs=ConfigurableField(<span class="hljs-built_in">id</span>=<span class="hljs-string">"db_search_kwargs"</span>),
)

<span class="hljs-comment"># 场景1：高精度检索（高阈值）</span>
high_precision = retriever.with_config(
    configurable={
        <span class="hljs-string">"db_search_kwargs"</span>: {<span class="hljs-string">"k"</span>: <span class="hljs-number">5</span>, <span class="hljs-string">"score_threshold"</span>: <span class="hljs-number">0.8</span>}
    }
).invoke(<span class="hljs-string">"查询"</span>)

<span class="hljs-comment"># 场景2：多样化检索（MMR）</span>
diverse_results = retriever.with_config(
    configurable={
        <span class="hljs-string">"db_search_type"</span>: <span class="hljs-string">"mmr"</span>,
        <span class="hljs-string">"db_search_kwargs"</span>: {<span class="hljs-string">"k"</span>: <span class="hljs-number">10</span>}
    }
).invoke(<span class="hljs-string">"查询"</span>)
</code></pre>
<hr/>
<h3 data-id="heading-17">核心概念对比</h3>



































<table><thead><tr><th>特性</th><th>相似性搜索</th><th>阈值搜索</th><th>MMR搜索</th></tr></thead><tbody><tr><td>方法名</td><td><code>similarity_search</code></td><td><code>similarity_search_with_relevance_scores</code></td><td><code>max_marginal_relevance_search</code></td></tr><tr><td>关注点</td><td>最相关的前k个</td><td>相关度超过阈值的结果</td><td>相关性+多样性</td></tr><tr><td>结果数量</td><td>固定k个</td><td>变化（取决于阈值）</td><td>固定k个</td></tr><tr><td>适用场景</td><td>一般检索</td><td>高质量要求</td><td>需要多样化结果</td></tr></tbody></table>
<h3 data-id="heading-18">技术栈总结</h3>
<h4 data-id="heading-19">向量数据库</h4>
<ul>
<li><strong>FAISS</strong>：本地向量数据库，适合小规模数据和快速原型开发</li>
<li><strong>Weaviate</strong>：云端向量数据库，适合生产环境和大规模数据</li>
</ul>
<h4 data-id="heading-20">嵌入模型</h4>
<ul>
<li><strong>千帆Embeddings</strong>：百度千帆平台提供的文本嵌入服务</li>
</ul>
<h4 data-id="heading-21">文档处理</h4>
<ul>
<li><strong>UnstructuredMarkdownLoader</strong>：加载Markdown格式文档</li>
<li><strong>RecursiveCharacterTextSplitter</strong>：递归文本分割器，支持多种分隔符</li>
</ul>
<h4 data-id="heading-22">检索策略</h4>
<ol>
<li><strong>相似性搜索</strong>：基于向量相似度返回最相关的结果</li>
<li><strong>阈值搜索</strong>：过滤低相似度结果，保证质量</li>
<li><strong>MMR搜索</strong>：在相关性和多样性之间取得平衡</li>
</ol>
<h3 data-id="heading-23">实际应用场景</h3>
<h4 data-id="heading-24">RAG应用开发流程</h4>
<ol>
<li><strong>文档准备</strong>：加载文档 -&gt; 文本分割 -&gt; 向量化</li>
<li><strong>向量存储</strong>：选择合适的向量数据库（FAISS/Weaviate）</li>
<li><strong>检索器配置</strong>：转换为检索器，配置检索策略</li>
<li><strong>动态调整</strong>：根据场景需求动态调整检索参数</li>
<li><strong>结果生成</strong>：将检索结果输入LLM生成答案</li>
</ol>
<h4 data-id="heading-25">参数选择建议</h4>
<ul>
<li><strong>k值选择</strong>：一般取3-10个结果，太多会引入噪声</li>
<li><strong>阈值设置</strong>：0.5-0.8之间，根据数据质量调整</li>
<li><strong>chunk_size</strong>：300-1000字符，根据文档类型调整</li>
<li><strong>chunk_overlap</strong>：一般为chunk_size的10-20%</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[新浪财经专访凡泰极客梁启鸿：金融App的AI落地应避哪些坑？]]></title>    <link>https://juejin.cn/post/7602070768962011162</link>    <guid>https://juejin.cn/post/7602070768962011162</guid>    <pubDate>2026-02-02T10:23:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602070768962011162" data-draft-id="7601946979606511643" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="新浪财经专访凡泰极客梁启鸿：金融App的AI落地应避哪些坑？"/> <meta itemprop="keywords" content="前端,OpenAI,架构"/> <meta itemprop="datePublished" content="2026-02-02T10:23:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="FinClip"/> <meta itemprop="url" content="https://juejin.cn/user/395479918322696"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            新浪财经专访凡泰极客梁启鸿：金融App的AI落地应避哪些坑？
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/395479918322696/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    FinClip
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T10:23:16.000Z" title="Mon Feb 02 2026 10:23:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读6分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>当每一家金融机构都在谈论AI，当每一个App都想变得“更智能”，我们是否真正走在了正确的道路上？ 近日，凡泰极客创始人梁启鸿接受新浪财经专访，直指金融AI落地中最常见的实践误区。以下为专访精华，值得每一位金融科技从业者细读。</p>
<p>文 | 徐苑蕾</p>
<blockquote>
<p>随着生成式AI技术浪潮席卷金融业，银行、券商等机构纷纷加速App AI化转型。如何让新技术真正嵌入金融业务全流程，并实现合规与效率的平衡，始终是金融业探索数字化、智能化的挑战。</p>
</blockquote>
<p>近日，凡泰极客创始人梁启鸿在对话中表示，AI技术在金融机构App中的落地需摒弃互联网金融时代的割裂思维，通过渐进式改造、AI记忆能力构建与工程化中台搭建，打通从技术到业务的最后一公里。</p>
<p><strong>AI应全面赋能，不应另搞一块试验田</strong></p>
<p>面对AI热潮，部分金融机构选择独立开发AI专属App，这一做法被梁启鸿明确否定。</p>
<p>“这本质上重蹈了互联网金融时代的覆辙，当时很多机构成立独立互联网子公司，结果造成线上线下割裂、资源内耗、利益分配冲突、考核失衡等一系列问题。”梁启鸿指出，AI的价值在于泛化赋能全业务流程，而非成为孤立的试验田。</p>
<p>在他看来，金融机构探索AI的正确路径，是对存量App进行渐进式改造。</p>
<p>“通过非入侵性技术手段，在现有系统基础上嵌入AI能力，而不是推倒重来。传统聊天入口的AI不知道用户在哪个页面、正在操作什么，而应该把这些上下文信息实时传递给AI，让交互更精准。”</p>
<p><strong>AI本质上是效率工具，而不是玩具</strong></p>
<p>公开数据显示，当前国内超80%的券商App已嵌入AI功能，但多集中于智能客服、行情问答等基础场景。</p>
<p>梁启鸿分析称，2013至2017年国内互联网金融爆发期，券商实现技术跃迁，积累的数字化能力已超越多数国际同行。</p>
<p>但在当前AI浪潮中，不少机构陷入为AI而AI的误区。</p>
<p>“现在很多所谓的AI App，只是在原有产品里加个聊天入口，连原有的搜索功能都不能AI化，大多还与搜索功能并存，没有实现智能化搜索、对话式搜索，客户可能既找不到目标功能，也找不到想要的产品，目前几乎所有的金融App因此不具备销售功能，更不用说帮投资者控制风险、辅助投顾履行勤勉尽责义务了，本质上还是玩具性质。”梁启鸿表示。</p>
<p><strong>AI要长记性，不能过了就忘 甚至长期失忆</strong></p>
<p>在梁启鸿看来，金融服务的核心是“懂用户”，当前AI工具普遍缺乏记忆能力，用户每次会话都需重复信息，无法形成个性化服务，更不可能成为专属‘顾问’。</p>
<p>“App技术、大模型资源都能同质化，但对用户的深度记忆能力，将成为金融机构的核心壁垒。”梁启鸿解释道，而这就要求AI具备类人脑的记忆体系。</p>
<p>他还将AI记忆分为三类：</p>
<p>情景记忆，记录用户交互场景与时间；</p>
<p>语义记忆，存储风险偏好、投资理念等长期信息；</p>
<p>程序记忆，则约束AI行为边界。</p>
<p>梁启鸿称，通过记忆及算法，让AI能从对话中提取信息并分类存储，下次交互时自动调取匹配，实现真正“一人一面”的专属服务，让系统不再依赖于给群体打标签，而是深刻理解并适配每一位用户的独特性。</p>
<p>这种记忆能力直接转化为用户粘性。</p>
<p>“当用户习惯了AI记住他的持仓情况、市场波动时的情绪反应，甚至生活变故带来的风险偏好变化，就相当于把外脑托管给了金融机构。”梁启鸿举例，若用户提及孩子参加音乐会，AI可主动问候并结合家庭情况调整投资建议，这种陪伴式服务让用户难以切换平台。</p>
<p>“在同质化竞争中，谁先做好记忆能力，谁就能先抢占用户心智。”</p>
<p><strong>金融AI要实现智能合规，避免口无遮拦</strong></p>
<p>合规是AI技术在金融行业落地的首要原则。</p>
<p>梁启鸿坦言，AI的概率性输出特性与金融业可审计、可追溯的要求存在天然矛盾。“AI可能被用户引导说出不合规言论，一旦引发投诉，机构将面临合规风险。”</p>
<p>梁启鸿认为，金融AI要解决如何“记住”客户的一切相关信息的问题，从而在每次大模型推理的时候，把与当前用户问题关联的记忆提取出来，供模型去思考、推理。</p>
<p>这个过程中，相当于让大模型具备KYC（了解你的客户）的能力，生成符合适当性管理要求的回复，并通过合规护栏做最后的把关，确保大模型这种概率性地生成，能结合“硬编码”（决策树、规则引擎），输出具有高度一致性的内容。智能，不仅体现在模型的强大，在金融服务中，更加体现为一贯性和连续性。</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/82c8f1ea212548cdb6a2d59a2009dc42~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRmluQ2xpcA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770632599&amp;x-signature=tqhcX4Zd2Z92Fin87pQy%2BwoZNS4%3D" alt="图片" loading="lazy"/></p>
<p>梁启鸿强调，金融AI落地的关键不是技术炫酷，而是解决实际问题。</p>
<p>“很多机构以为对接大模型就完成了AI转型，却忽视了中台搭建、记忆体系构建这些工程活。只有打破技术与业务的割裂，围绕KYC与适当性管理做深做透，AI才能真正为金融业创造价值。”</p>
<p><strong>金融AI应“人在环中”，不能无人驾驶</strong></p>
<p>基于记忆能力构建，凡泰极客提出“人机协同三级模式”，对应自动驾驶的不同级别：高频低风险场景由AI全自动处理，中频中风险场景需真人投顾监督确认，低频高风险场景如家族信托规划则由真人主导，AI仅提供投资者教育支持。</p>
<p>“这种模式既扩大了投顾服务半径，让一人服务50人提升至500人，又通过合规框架保障服务质量，实现降本增效与风险控制的平衡。”</p>
<p>对于金融机构App的未来形态，梁启鸿描绘了人格化超级App的蓝图：以AI会话为入口，原有UI逐渐简化，用户意图通过AI即时生成的UI、小程序来完成，并实现human in the loop的人机协同，从而实现“导航变导购，交流中交易，会话即服务”。他认为，金融机构AI转型的差异化根本竞争点，在于“AI的记忆与合规能力”。</p>
<p>—END—</p>
<p><strong>关于FinClip Chatkit</strong></p>
<p>Chatkit是凡泰极客FinClip超级应用智能平台的一次重大能力升级，它能助力企业构建具备深度上下文感知、流式生成原生UI的超级App。</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MIT开源 首款P2P-AIBridge工具 OoderNexus 发布]]></title>    <link>https://juejin.cn/post/7602106969697534015</link>    <guid>https://juejin.cn/post/7602106969697534015</guid>    <pubDate>2026-02-02T10:23:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602106969697534015" data-draft-id="7602100217657098282" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MIT开源 首款P2P-AIBridge工具 OoderNexus 发布"/> <meta itemprop="keywords" content="人工智能"/> <meta itemprop="datePublished" content="2026-02-02T10:23:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="OneCodeCN"/> <meta itemprop="url" content="https://juejin.cn/user/1427583415622366"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MIT开源 首款P2P-AIBridge工具 OoderNexus 发布
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1427583415622366/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    OneCodeCN
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T10:23:45.000Z" title="Mon Feb 02 2026 10:23:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读1分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">前言</h2>
<p>OoderAgent V0.6.5 作为标志性版本，正式补齐了基础网络管理与Skills技能执行的核心能力，搭建起P2P AI通信的核心骨架，为后续各类AI应用落地奠定了坚实基础。但不可忽视的是，底层协议的枯燥晦涩、纯命令行的操作模式，如同两道门槛，将多数热爱AI的开发者、爱好者挡在门外，让核心能力难以被快速感知和应用——这也是Nexus基于该版本开发的核心初衷，用可视化页面打破门槛，让技术能力更易触达。</p>
<p>开源地址：</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2FooderCN%2Fooder-nexus.git" target="_blank" title="https://gitee.com/ooderCN/ooder-nexus.git" ref="nofollow noopener noreferrer">gitee.com/ooderCN/ood…</a></p>
<p><strong>这个版本包含了哪些功能：</strong></p>
<p>这个版本是一个开发者示例工程，包含了一些常见场景中的示例管理界面，用户可以使用SkillsCenter 的 AIBridge 功能将家里或者公司的路由器、NAS设备、智能家居网关等设备安装上相应的，ooderAgent 就可以使用，Nexus 开发包将，这些设备的能力实现可视化，同时将其编入到SkillFlow中，扩展AI的能力。另外这个版本还提供了，关于场景、场景组、以及能力管理等相关的基础的示例管理程序。开发者可以根据自身的业务需求构建属于自己的SuperAgent 分发程序。</p>
<p><strong>预览版截图：</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e20b874e565470484a441cc7313cb28~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770632625&amp;x-signature=atQbSFUKdfaGp5KnEfIimxd0PWI%3D" alt="图片" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c481bd7ae4504c489f035d11216766e0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770632625&amp;x-signature=ivbnQ3PdUohSsM3V5RLX4hHZCc8%3D" alt="图片" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b7f6e22f5c443b0a152eb6959927fdf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770632625&amp;x-signature=n8rBj%2BLhdqn%2FMMgWVkRWJRp5bUI%3D" alt="图片" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b17295cc80654cceb8c24ba8b5b0dd7e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770632625&amp;x-signature=PRADHkLGifTxySZOJm%2FPSP6eHB4%3D" alt="图片" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9afe2dac52214777abaf295cc7c7f475~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770632625&amp;x-signature=uf7iltguYWOI7HbJHa9NsppQKs0%3D" alt="图片" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Gemini CLI Skill 开发实战：创建一个自动生成 Git 日志的技能]]></title>    <link>https://juejin.cn/post/7602073088427950095</link>    <guid>https://juejin.cn/post/7602073088427950095</guid>    <pubDate>2026-02-02T10:01:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602073088427950095" data-draft-id="7602072652606717992" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Gemini CLI Skill 开发实战：创建一个自动生成 Git 日志的技能"/> <meta itemprop="keywords" content="Gemini,人工智能"/> <meta itemprop="datePublished" content="2026-02-02T10:01:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="想当花匠的小码农"/> <meta itemprop="url" content="https://juejin.cn/user/1625518177271482"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Gemini CLI Skill 开发实战：创建一个自动生成 Git 日志的技能
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1625518177271482/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    想当花匠的小码农
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T10:01:47.000Z" title="Mon Feb 02 2026 10:01:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读4分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>本文档记录了如何为 Gemini CLI 创建一个名为 <code>git-to-log</code> 的自定义技能。该技能可以自动从多个 Git 仓库提取提交记录，并将其整理为结构化的日报或周报内容。</p>
<h2 data-id="heading-0">1. 目标与需求</h2>
<p><strong>核心目标</strong>：
自动化提取 Git 提交记录 -&gt; 智能分类 -&gt; 生成 Markdown 日志。</p>
<p><strong>具体需求</strong>：</p>
<ol>
<li><strong>多仓库支持</strong>：能同时读取 <code>server</code>, <code>proto</code>, <code>configs</code> 等关联仓库的提交。</li>
<li><strong>灵活参数</strong>：支持指定日期范围（如“今天”、“上周”）和作者过滤。</li>
<li><strong>智能分类</strong>：根据 Commit Message 的前缀（<code>feat</code>, <code>fix</code>, <code>docs</code> 等）自动归类为“业务”、“工具”、“修复”等。</li>
<li><strong>无缝集成</strong>：通过自然语言指令（如“生成今天的日报”）触发。</li>
</ol>
<hr/>
<h2 data-id="heading-1">2. 开发环境准备</h2>
<p>确保已安装 Gemini CLI，并激活了 <code>skill-creator</code> 技能（可选，但推荐用于辅助生成）：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 激活技能创建向导</span>
activate_skill skill-creator
</code></pre>
<hr/>
<h2 data-id="heading-2">3. 初始化技能</h2>
<p>我们首先在一个临时目录或工作区中初始化技能结构。</p>
<p><strong>命令</strong>：</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 创建目录</span>
<span class="hljs-built_in">mkdir</span> -p .gemini_temp/git-to-log

<span class="hljs-comment"># 使用 skill-creator 的脚本初始化</span>
node &lt;path-to-skill-creator&gt;/scripts/init_skill.cjs git-to-log --path .gemini_temp
</code></pre>
<p><strong>生成的目录结构</strong>：</p>
<pre><code class="hljs language-perl" lang="perl">git-to-<span class="hljs-keyword">log</span>/
├── SKILL.md           <span class="hljs-comment"># 核心配置文件（元数据 + 指令）</span>
├── scripts/           <span class="hljs-comment"># 可执行脚本目录</span>
│   └── fetch_git_logs.cjs  <span class="hljs-comment"># (我们需要新建的核心脚本)</span>
├── references/        <span class="hljs-comment"># 参考文档（可选）</span>
└── assets/            <span class="hljs-comment"># 静态资源（可选）</span>
</code></pre>
<hr/>
<h2 data-id="heading-3">4. 编写核心代码</h2>
<h3 data-id="heading-4">4.1 编写日志提取脚本 (<code>scripts/fetch_git_logs.cjs</code>)</h3>
<p>这个脚本负责调用系统 <code>git</code> 命令，并返回标准化的 JSON 数据供 LLM 处理。</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { execSync } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'child_process'</span>);
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);

<span class="hljs-comment">// 解析参数</span>
<span class="hljs-keyword">const</span> args = process.<span class="hljs-property">argv</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">2</span>);
<span class="hljs-keyword">const</span> <span class="hljs-title function_">getArg</span> = (<span class="hljs-params">name</span>) =&gt; {
  <span class="hljs-keyword">const</span> index = args.<span class="hljs-title function_">indexOf</span>(name);
  <span class="hljs-keyword">return</span> index !== -<span class="hljs-number">1</span> ? args[index + <span class="hljs-number">1</span>] : <span class="hljs-literal">null</span>;
};

<span class="hljs-keyword">const</span> since = <span class="hljs-title function_">getArg</span>(<span class="hljs-string">'--since'</span>) || <span class="hljs-string">'1 day ago'</span>;
<span class="hljs-keyword">const</span> until = <span class="hljs-title function_">getArg</span>(<span class="hljs-string">'--until'</span>);
<span class="hljs-keyword">const</span> author = <span class="hljs-title function_">getArg</span>(<span class="hljs-string">'--author'</span>);
<span class="hljs-keyword">const</span> reposArg = <span class="hljs-title function_">getArg</span>(<span class="hljs-string">'--repos'</span>);
<span class="hljs-keyword">const</span> repos = reposArg ? reposArg.<span class="hljs-title function_">split</span>(<span class="hljs-string">','</span>) : [<span class="hljs-string">'.'</span>];

<span class="hljs-keyword">const</span> allLogs = [];

repos.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">repoPath</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> resolvedPath = path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), repoPath);
  
  <span class="hljs-keyword">if</span> (!fs.<span class="hljs-title function_">existsSync</span>(path.<span class="hljs-title function_">join</span>(resolvedPath, <span class="hljs-string">'.git'</span>))) {
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-keyword">const</span> repoName = path.<span class="hljs-title function_">basename</span>(resolvedPath);
  
  <span class="hljs-comment">// 构造 git log 命令</span>
  <span class="hljs-keyword">let</span> cmd = <span class="hljs-string">`git -C "<span class="hljs-subst">${resolvedPath}</span>" log --since="<span class="hljs-subst">${since}</span>" --pretty=format:"%h|%ad|%an|%s" --date=short`</span>;
  <span class="hljs-keyword">if</span> (until) cmd += <span class="hljs-string">` --until="<span class="hljs-subst">${until}</span>"`</span>;
  <span class="hljs-keyword">if</span> (author) cmd += <span class="hljs-string">` --author="<span class="hljs-subst">${author}</span>"`</span>;

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> output = <span class="hljs-title function_">execSync</span>(cmd, { <span class="hljs-attr">encoding</span>: <span class="hljs-string">'utf8'</span> });
    <span class="hljs-keyword">if</span> (!output) <span class="hljs-keyword">return</span>;

    output.<span class="hljs-title function_">split</span>(<span class="hljs-string">'\n'</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">line</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> [hash, date, commitAuthor, message] = line.<span class="hljs-title function_">split</span>(<span class="hljs-string">'|'</span>);
      allLogs.<span class="hljs-title function_">push</span>({
        <span class="hljs-attr">repo</span>: repoName,
        hash,
        date,
        <span class="hljs-attr">author</span>: commitAuthor,
        message
      });
    });
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Error fetching logs from <span class="hljs-subst">${repoName}</span>:`</span>, error.<span class="hljs-property">message</span>);
  }
});

<span class="hljs-comment">// 按时间倒序排列</span>
allLogs.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(b.<span class="hljs-property">date</span>) - <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(a.<span class="hljs-property">date</span>));

<span class="hljs-comment">// 输出 JSON</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(allLogs, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>));
</code></pre>
<h3 data-id="heading-5">4.2 配置技能定义 (<code>SKILL.md</code>)</h3>
<p>这是 Gemini 理解和使用技能的“说明书”。我们使用中文编写以提高可维护性。</p>
<pre><code class="hljs language-markdown" lang="markdown">---
name: git-to-log
<span class="hljs-section">description: 从多个 Git 仓库提取提交记录并格式化为日报或周报。当用户要求“生成日志”、“更新日报”、“汇总 Git 提交”或“创建周报总结”时使用。
---</span>

<span class="hljs-section"># Git 日志生成技能 (Git to Log)</span>

此技能用于自动化提取多个 Git 仓库的提交历史，并将其整理为结构化的 Markdown 工作日志。

<span class="hljs-section">## 工作流程</span>

<span class="hljs-bullet">1.</span>  <span class="hljs-strong">**确定参数**</span>:
<span class="hljs-bullet">    *</span>   <span class="hljs-strong">**日期范围**</span>: 解析用户指令中的时间（如“今天”、“上周”）。默认为 "1 day ago"。
<span class="hljs-bullet">    *</span>   <span class="hljs-strong">**仓库列表**</span>: 默认检查当前目录 (<span class="hljs-code">`.`</span>) 及兄弟目录（如 <span class="hljs-code">`../proto`</span>, <span class="hljs-code">`../configs`</span>）。
<span class="hljs-bullet">    *</span>   <span class="hljs-strong">**作者**</span>: 默认为当前 Git 用户，可指定过滤。

<span class="hljs-bullet">2.</span>  <span class="hljs-strong">**获取日志**</span>:
<span class="hljs-bullet">    *</span>   调用脚本: <span class="hljs-code">`node &lt;技能路径&gt;/scripts/fetch_git_logs.cjs ...`</span>

<span class="hljs-bullet">3.</span>  <span class="hljs-strong">**处理与分类**</span>:
<span class="hljs-bullet">    *</span>   <span class="hljs-strong">**过滤**</span>: 忽略 Merge commits。
<span class="hljs-bullet">    *</span>   <span class="hljs-strong">**分类**</span>:
<span class="hljs-bullet">        *</span>   <span class="hljs-code">`feat(...)`</span> -&gt; <span class="hljs-strong">**业务**</span> / <span class="hljs-strong">**工具**</span>
<span class="hljs-bullet">        *</span>   <span class="hljs-code">`fix(...)`</span> -&gt; <span class="hljs-strong">**修复**</span>
<span class="hljs-bullet">        *</span>   <span class="hljs-code">`docs(...)`</span> -&gt; <span class="hljs-strong">**文档**</span>
<span class="hljs-bullet">        *</span>   <span class="hljs-code">`chore/build/ci`</span> -&gt; <span class="hljs-strong">**部署**</span> / <span class="hljs-strong">**框架**</span>

<span class="hljs-bullet">4.</span>  <span class="hljs-strong">**执行操作**</span>:
<span class="hljs-bullet">    *</span>   <span class="hljs-strong">**展示**</span>: 直接打印结果。
<span class="hljs-bullet">    *</span>   <span class="hljs-strong">**更新文件**</span>: 读取指定日志文件（如 <span class="hljs-code">`2026-01.md`</span>），插入内容后保存。
</code></pre>
<hr/>
<h2 data-id="heading-6">5. 打包与安装</h2>
<p>为了方便分发和管理，我们需要将技能打包为 <code>.skill</code> 文件。</p>
<p><strong>步骤</strong>：</p>
<ol>
<li>
<p><strong>清理冗余文件</strong>：删除初始化时生成的 <code>example_script.cjs</code> 等。</p>
</li>
<li>
<p><strong>打包</strong>：</p>
<pre><code class="hljs language-bash" lang="bash">node &lt;path-to-skill-creator&gt;/scripts/package_skill.cjs .gemini_temp/git-to-log .gemini_temp
</code></pre>
<p>这将生成 <code>.gemini_temp/git-to-log.skill</code> 文件。</p>
</li>
<li>
<p><strong>安装到用户全局范围 (User Scope)</strong>：
推荐安装到 User Scope，这样技能在任何项目目录下都可用，且不会污染特定项目的 git 仓库。</p>
<pre><code class="hljs language-gemini" lang="gemini"/></pre>
</li>
</ol>
<p>skills install .gemini_temp/git-to-log.skill --scope user
```</p>
<ol start="4">
<li>
<p><strong>清理临时文件</strong>：
安装完成后，<code>.gemini_temp</code> 目录可以删除。</p>
</li>
<li>
<p><strong>重载技能</strong>：
在 Gemini CLI 交互界面运行：</p>
<pre><code class="hljs language-bash" lang="bash">/skills reload
</code></pre>
</li>
</ol>
<hr/>
<h2 data-id="heading-7">6. 使用 Git 管理个人技能</h2>
<p>为了防止技能丢失并方便多机同步，建议将 <code>~/.gemini/skills</code> 目录纳入 Git 管理。</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> ~/.gemini/skills
git init
<span class="hljs-built_in">echo</span> <span class="hljs-string">".DS_Store\n*.skill"</span> &gt; .gitignore
git add .
git commit -m <span class="hljs-string">"Initial commit: Add git-to-log skill"</span>

<span class="hljs-comment"># (可选) 推送到远程仓库</span>
<span class="hljs-comment"># git remote add origin git@github.com:username/my-gemini-skills.git</span>
<span class="hljs-comment"># git push -u origin main</span>
</code></pre>
<p>这样，当你需要修改技能逻辑时：</p>
<ol>
<li>直接修改 <code>~/.gemini/skills/git-to-log/SKILL.md</code>。</li>
<li>运行 <code>/skills reload</code> 测试。</li>
<li>测试通过后 <code>git commit</code> 提交代码。</li>
</ol>
<hr/>
<h2 data-id="heading-8">7. 使用效果</h2>
<p><strong>用户</strong>: "生成今天的日志"</p>
<p><strong>Gemini</strong>:</p>
<ol>
<li>自动执行 <code>fetch_git_logs.cjs</code> 获取今天 <code>server</code>, <code>proto</code>, <code>configs</code> 的提交。</li>
<li>识别到提交 <code>feat(task): Add new feature</code>，分类为“业务”。</li>
<li>生成如下 Markdown 并展示：</li>
</ol>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section">## 2026-02-02 周一</span>
<span class="hljs-bullet">-</span> 业务: Add new feature
<span class="hljs-bullet">-</span> 工具: Fix build script
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[【技术专题】Scikit-learn Python机器学习 - 聚类分析算法之DBSCAN（基于密度的噪声应用空间聚类）]]></title>    <link>https://juejin.cn/post/7601946979606478875</link>    <guid>https://juejin.cn/post/7601946979606478875</guid>    <pubDate>2026-02-02T10:16:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601946979606478875" data-draft-id="7602091087922511922" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="【技术专题】Scikit-learn Python机器学习 - 聚类分析算法之DBSCAN（基于密度的噪声应用空间聚类）"/> <meta itemprop="keywords" content="机器学习,人工智能,Python"/> <meta itemprop="datePublished" content="2026-02-02T10:16:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="小锋java1234"/> <meta itemprop="url" content="https://juejin.cn/user/4152222342709933"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            【技术专题】Scikit-learn Python机器学习 - 聚类分析算法之DBSCAN（基于密度的噪声应用空间聚类）
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4152222342709933/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    小锋java1234
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T10:16:34.000Z" title="Mon Feb 02 2026 10:16:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>大家好，我是锋哥。最近连载更新《Scikit-learn Python机器学习》技术专题。 <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b763680708504700b1f5a093b63ceaf0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6ZSLamF2YTEyMzQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770632197&amp;x-signature=6ZQieVSOYCbXksnFX8j1UMDBs48%3D" alt="image.png" loading="lazy"/> 本课程主要讲解基于Scikit-learn的Python机器学习知识，包括机器学习概述，特征工程(数据集，特征抽取，特征预处理，特征降维等)，分类算法(K-临近算法，朴素贝叶斯算法，决策树等)，回归与聚类算法(线性回归，欠拟合，逻辑回归与二分类，K-means算法)等。 同时也配套视频教程<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV11reUzEEPH%2F" title="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV11reUzEEPH%2F" target="_blank">《Scikit-learn Python机器学习 视频教程》</a></p>
<p>DBSCAN（Density-Based Spatial Clustering of Applications with Noise）是一种基于密度的聚类算法，由Martin Ester、Hans-Peter Kriegel、Jörg Sander和Xiaowei Xu于1996年提出。与K-means等基于距离的聚类方法不同，DBSCAN能够发现任意形状的簇，并且能够识别出噪声点。</p>
<h2 data-id="heading-0">DBSCAN的基本概念</h2>
<ol start="0">
<li>
<p><strong>核心点（Core Point）</strong> ：</p>
<ul>
<li>如果某个点的ε邻域内（半径为ε的区域）包含至少<code>MinPts</code>个点（包括该点本身），则该点被认为是核心点。</li>
</ul>
</li>
<li>
<p><strong>边界点（Border Point）</strong> ：</p>
<ul>
<li>边界点是指不属于核心点，但位于某个核心点的ε邻域内的点。边界点的邻域内的点数小于<code>MinPts</code>，因此不能形成核心点。</li>
</ul>
</li>
<li>
<p><strong>噪声点（Noise Point）</strong> ：</p>
<ul>
<li>如果一个点既不是核心点，也不在任何核心点的ε邻域内，它就是噪声点。噪声点不属于任何簇。</li>
</ul>
</li>
<li>
<p><strong>ε邻域（Epsilon Neighborhood）</strong> ：</p>
<ul>
<li>给定一个点<code>P</code>和一个距离阈值<code>ε</code>，ε邻域指的是距离点<code>P</code>小于或等于<code>ε</code>的所有点组成的区域。</li>
</ul>
</li>
<li>
<p><strong>MinPts（最小邻域点数）</strong> ：</p>
<ul>
<li><code>MinPts</code>是指一个点被认为是核心点所需的最小邻域点数。通常<code>MinPts</code>设置为数据维度的2倍或更大。</li>
</ul>
</li>
</ol>
<h2 data-id="heading-1">DBSCAN的工作原理</h2>
<p>DBSCAN的聚类过程是通过以下几个步骤实现的：</p>
<ol start="0">
<li>
<p><strong>选择一个未访问的点</strong>：从数据集中选择一个未被访问的点。</p>
</li>
<li>
<p>检查该点的ε邻域</p>
<p>：计算该点的ε邻域内包含的点的数量。</p>
<ul>
<li>如果邻域内的点数大于或等于<code>MinPts</code>，该点是核心点，算法开始扩展一个簇。所有位于该点的ε邻域内的点都将被加入到簇中。</li>
<li>如果邻域内的点数小于<code>MinPts</code>，则该点是噪声点，暂时标记为噪声。</li>
</ul>
</li>
<li>
<p><strong>扩展簇</strong>：对于核心点的邻域内的每个点，重复上述步骤。如果邻域内的某个点是核心点，则继续扩展簇。</p>
</li>
<li>
<p><strong>继续此过程，直到所有点都被访问过</strong>。</p>
</li>
</ol>
<h2 data-id="heading-2">DBSCAN的数学公式原理</h2>
<p>DBSCAN的公式与计算距离、邻域和密度等概念紧密相关，关键公式如下：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6374dbf5f07246a68cf82dd4f192ab80~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6ZSLamF2YTEyMzQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770632197&amp;x-signature=F9Kc0VCawGqMHgetMmcMQYzbvco%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-3">DBSCAN的优缺点</h2>
<p>优点：</p>
<ol start="0">
<li><strong>能够发现任意形状的簇</strong>：不像K-means假设簇是圆形的，DBSCAN可以处理任意形状的簇。</li>
<li><strong>自动识别噪声点</strong>：DBSCAN可以自动将噪声点标记出来，而不需要额外的操作。</li>
<li><strong>不需要预设簇的数量</strong>：与K-means不同，DBSCAN不需要用户预设簇的数量。</li>
</ol>
<p>缺点：</p>
<ol start="0">
<li><strong>对参数敏感</strong>：DBSCAN依赖于<code>ε</code>和<code>MinPts</code>的选择，尤其是<code>ε</code>的值，这可能影响聚类效果。</li>
<li><strong>无法处理密度差异大的簇</strong>：如果数据集包含不同密度的簇，DBSCAN可能会失败。</li>
<li><strong>高维数据的效果较差</strong>：在高维数据中，DBSCAN可能会因为稀疏性问题导致聚类结果不佳。</li>
</ol>
<h2 data-id="heading-4">API介绍</h2>
<p>在 <strong>sklearn</strong> 中，DBSCAN 的实现类是 <code>sklearn.cluster.DBSCAN</code> ，构造方法通常如下：</p>
<pre><code class="hljs language-ini" lang="ini">sklearn.cluster.DBSCAN(<span class="hljs-attr">eps</span>=<span class="hljs-number">0.5</span>, min_samples=<span class="hljs-number">5</span>, metric=<span class="hljs-string">'euclidean'</span>, algorithm=<span class="hljs-string">'auto'</span>, leaf_size=<span class="hljs-number">30</span>, p=None, n_jobs=None)
</code></pre>
<p>核心参数介绍：</p>
<ol start="0">
<li>
<p><strong>eps (default=0.5)</strong> <code>eps</code> 表示核心点邻域的最大半径。即，两个点的欧几里得距离如果小于 <code>eps</code>，则认为它们是邻居。这个值决定了如何定义“密集区域”。<code>eps</code> 越大，聚类结果越稀疏。</p>
</li>
<li>
<p><strong>min_samples (default=5)</strong> <code>min_samples</code> 表示一个核心点的最小邻居数。若一个点的邻域中有 <code>min_samples</code> 个及以上点，它就会被认为是核心点。通常来说，<code>min_samples</code> 应该设置为比数据维度更大的值，例如 4 或 5。</p>
</li>
<li>
<p><strong>metric (default='euclidean')</strong> 这个参数定义了计算距离的方式，<code>'euclidean'</code> 是最常用的距离度量方式。你可以选择其他距离度量，例如 <code>'manhattan'</code>、<code>'cosine'</code> 等。</p>
</li>
<li>
<p><strong>algorithm (default='auto')</strong> <code>algorithm</code> 用来指定在聚类过程中使用的算法。常见的有以下几种：</p>
<ul>
<li><code>'auto'</code>: 自动选择最合适的算法。</li>
<li><code>'ball_tree'</code>: 使用球树算法，适合高维空间。</li>
<li><code>'kd_tree'</code>: 使用k-d树算法，适合低维空间。</li>
<li><code>'brute'</code>: 进行暴力搜索，计算所有点的距离，适合小规模数据。</li>
</ul>
</li>
<li>
<p><strong>leaf_size (default=30)</strong> <code>leaf_size</code> 仅在 <code>algorithm='ball_tree'</code> 或 <code>kd_tree'</code> 时有效。它影响构建树的数据结构的大小，较小的值可能会提高精度，但计算量较大；较大的值则可能提高效率。</p>
</li>
<li>
<p><strong>p (default=None)</strong> 仅在 <code>metric='minkowski'</code> 时有效。<code>p</code> 是 Minkowski 距离的一个参数。当 <code>p=1</code> 时，表示曼哈顿距离；当 <code>p=2</code> 时，表示欧几里得距离。</p>
</li>
<li>
<p><strong>n_jobs (default=None)</strong> <code>n_jobs</code> 表示使用多少个CPU核心进行并行计算。<code>None</code> 表示不进行并行计算，<code>-1</code> 表示使用所有CPU核心。</p>
</li>
</ol>
<h2 data-id="heading-5">具体示例</h2>
<pre><code class="hljs language-ini" lang="ini">import matplotlib.pyplot as plt
from sklearn.cluster import DBSCAN
from sklearn.datasets import make_blobs
​
<span class="hljs-comment"># 设置中文字体支持</span>
plt.rcParams<span class="hljs-section">['font.sans-serif']</span> = <span class="hljs-section">['SimHei']</span>  <span class="hljs-comment"># 用来正常显示中文标签</span>
plt.rcParams<span class="hljs-section">['axes.unicode_minus']</span> = False  <span class="hljs-comment"># 用来正常显示负号</span>
<span class="hljs-comment"># 生成生成高斯分布示例数据集</span>
X, <span class="hljs-attr">_</span> = make_blobs(n_samples=<span class="hljs-number">300</span>, centers=<span class="hljs-number">4</span>, cluster_std=<span class="hljs-number">0.60</span>, random_state=<span class="hljs-number">0</span>)
​
<span class="hljs-comment"># 使用DBSCAN进行聚类</span>
<span class="hljs-attr">db</span> = DBSCAN(eps=<span class="hljs-number">0.5</span>, min_samples=<span class="hljs-number">5</span>)
<span class="hljs-attr">y_db</span> = db.fit_predict(X)
<span class="hljs-comment"># 可视化结果</span>
plt.figure(<span class="hljs-attr">figsize</span>=(<span class="hljs-number">8</span>, <span class="hljs-number">6</span>))
plt.scatter(X<span class="hljs-section">[:, 0]</span>, X<span class="hljs-section">[:, 1]</span>, <span class="hljs-attr">c</span>=y_db, cmap=<span class="hljs-string">'Paired'</span>, marker=<span class="hljs-string">'o'</span>)
plt.title('DBSCAN 聚类结果')
plt.show()
</code></pre>
<p>解释：</p>
<ul>
<li><code>make_blobs</code>函数生成了一个包含4个簇的数据集。</li>
<li><code>DBSCAN(eps=0.5, min_samples=5)</code>：设置<code>ε=0.5</code>（邻域半径）和<code>MinPts=5</code>（每个核心点的最小邻域点数）。</li>
<li><code>fit_predict(X)</code>：应用DBSCAN聚类算法，并返回每个点的聚类标签。噪声点会被标记为<code>-1</code>。</li>
<li>可视化图显示了聚类结果，簇的点会有不同的颜色，噪声点会显示为孤立点。</li>
</ul>
<p>运行截图：</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a579161385f404cb163dfad1c4ce02a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6ZSLamF2YTEyMzQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770632197&amp;x-signature=mWfUFXzflqBpxZviKuBI4np8B5A%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[从 C++ 到 Rust：bsdiff 跨平台工具的重构与优化]]></title>    <link>https://juejin.cn/post/7601687408925900800</link>    <guid>https://juejin.cn/post/7601687408925900800</guid>    <pubDate>2026-02-02T09:05:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601687408925900800" data-draft-id="7601687408925622272" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="从 C++ 到 Rust：bsdiff 跨平台工具的重构与优化"/> <meta itemprop="keywords" content="开源,全栈,前端"/> <meta itemprop="datePublished" content="2026-02-02T09:05:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Conda"/> <meta itemprop="url" content="https://juejin.cn/user/624178334793848"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="掘金"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            从 C++ 到 Rust：bsdiff 跨平台工具的重构与优化
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/624178334793848/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Conda
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-02T09:05:12.000Z" title="Mon Feb 02 2026 09:05:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    阅读5分钟
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">bsdiff-rust</h2>
<blockquote>
<p>基于 Rust + napi-rs 重构的高性能二进制差分工具，消除 Python/node-gyp 依赖痛点</p>
</blockquote>
<h3 data-id="heading-1">目录</h3>
<ul>
<li><a href="#%E9%97%AE%E9%A2%98%E8%83%8C%E6%99%AF" title="#%E9%97%AE%E9%A2%98%E8%83%8C%E6%99%AF">问题背景</a></li>
<li><a href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88" title="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">解决方案</a></li>
<li><a href="#%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B" title="#%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B">快速开始</a></li>
<li><a href="#%E6%8A%80%E6%9C%AF%E5%AE%9E%E7%8E%B0" title="#%E6%8A%80%E6%9C%AF%E5%AE%9E%E7%8E%B0">技术实现</a></li>
<li><a href="#%E5%B9%B3%E5%8F%B0%E6%94%AF%E6%8C%81" title="#%E5%B9%B3%E5%8F%B0%E6%94%AF%E6%8C%81">平台支持</a></li>
<li><a href="#%E6%80%A7%E8%83%BD%E5%9F%BA%E5%87%86" title="#%E6%80%A7%E8%83%BD%E5%9F%BA%E5%87%86">性能基准</a></li>
<li><a href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5" title="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5">最佳实践</a></li>
<li><a href="#%E6%80%BB%E7%BB%93" title="#%E6%80%BB%E7%BB%93">总结</a></li>
</ul>
<hr/>
<h3 data-id="heading-2">问题背景</h3>
<p>在使用 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fgaetandezeiraud%2Fbsdiff-node" target="_blank" title="https://github.com/gaetandezeiraud/bsdiff-node" ref="nofollow noopener noreferrer">bsdiff-node</a> 进行二进制差分时，团队遇到以下痛点：</p>

























<table><thead><tr><th>问题类型</th><th>具体表现</th></tr></thead><tbody><tr><td><strong>编译依赖</strong></td><td>依赖 Python + node-gyp，安装时频繁报错</td></tr><tr><td><strong>环境一致性</strong></td><td>要求特定 Python 版本，团队成员环境难以统一</td></tr><tr><td><strong>维护成本</strong></td><td>C/C++ 代码维护成本高，缺乏内存安全保障</td></tr><tr><td><strong>CI/CD 适配</strong></td><td>构建流水线需要额外配置编译工具链</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-3">解决方案</h3>
<p>我重构了一个版本是基于 rust + napi-rs，项目名称是 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSphinm%2Fbsdiff-rust" target="_blank" title="https://github.com/Sphinm/bsdiff-rust" ref="nofollow noopener noreferrer">bsdiff-rust</a>，对比下 bsdiff-node 将编译工作在发布阶段，用户下载只会按他的系统平台的版本按需下载，不会出现二次编译的问题，并且将原有仓库里的 C 和 C++ 代码重构成了 rust，维护起来稳定性和性能会更好。</p>
<pre><code class="hljs language-bash" lang="bash">┌─────────────────────────────────────────────────────────┐
│                    发布阶段（CI）                        │
│  ┌─────────┐    ┌─────────┐    ┌─────────┐             │
│  │ Windows │    │  macOS  │    │  Linux  │             │
│  │ x64/arm │    │ x64/arm │    │ x64/arm │             │
│  └────┬────┘    └────┬────┘    └────┬────┘             │
│       └──────────────┼──────────────┘                   │
│                      ▼                                  │
│              预编译二进制产物                            │
└─────────────────────┬───────────────────────────────────┘
                      │
                      ▼ npm install
┌─────────────────────────────────────────────────────────┐
│                    用户端                               │
│         按平台自动下载对应二进制，无需编译               │
└─────────────────────────────────────────────────────────┘
</code></pre>
<h4 data-id="heading-4">核心改进</h4>
<ul>
<li><strong>预编译发布</strong>：编译工作前置到发布阶段，用户零编译</li>
<li><strong>按需下载</strong>：根据 <code>os</code> + <code>arch</code> 自动匹配二进制文件</li>
<li><strong>Rust 重写</strong>：内存安全、高性能、可维护性强</li>
<li><strong>格式兼容</strong>：完全兼容 BSDIFF40 标准格式</li>
</ul>
<hr/>
<h3 data-id="heading-5">快速开始</h3>
<h4 data-id="heading-6">安装</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 推荐：直接下载预编译二进制，无需任何额外依赖</span>
npm install bsdiff-rust

<span class="hljs-comment"># 对比原方案（可能失败）</span>
<span class="hljs-comment"># npm install bsdiff-node  # 需要系统自带 Python + node-gyp</span>
</code></pre>
<h4 data-id="heading-7">基础用法</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { diff, patch } <span class="hljs-keyword">from</span> <span class="hljs-string">'bsdiff-rust'</span>;

<span class="hljs-comment">// 生成补丁</span>
<span class="hljs-keyword">await</span> <span class="hljs-title function_">diff</span>(<span class="hljs-string">'old.zip'</span>, <span class="hljs-string">'new.zip'</span>, <span class="hljs-string">'patch.bin'</span>);

<span class="hljs-comment">// 应用补丁</span>
<span class="hljs-keyword">await</span> <span class="hljs-title function_">patch</span>(<span class="hljs-string">'old.zip'</span>, <span class="hljs-string">'patch.bin'</span>, <span class="hljs-string">'restored.zip'</span>);
</code></pre>
<h4 data-id="heading-8">完整示例（含错误处理）</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { diff, patch } <span class="hljs-keyword">from</span> <span class="hljs-string">'bsdiff-rust'</span>;

<span class="hljs-comment">// 生成补丁</span>
(<span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">diff</span>(<span class="hljs-string">'old.zip'</span>, <span class="hljs-string">'new.zip'</span>, <span class="hljs-string">'patch.bin'</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Patch generated successfully!'</span>);
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to generate patch:'</span>, err);
  }
})();

<span class="hljs-comment">// 应用补丁</span>
(<span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">patch</span>(<span class="hljs-string">'old.zip'</span>, <span class="hljs-string">'patch.bin'</span>, <span class="hljs-string">'new_restored.zip'</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Patch applied successfully!'</span>);
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to apply patch:'</span>, err);
  }
})();
</code></pre>
<h4 data-id="heading-9">API 参考</h4>




















<table><thead><tr><th>方法</th><th>签名</th><th>描述</th></tr></thead><tbody><tr><td><code>diff</code></td><td><code>(oldPath: string, newPath: string, patchPath: string) =&gt; Promise&lt;void&gt;</code></td><td>生成差分补丁</td></tr><tr><td><code>patch</code></td><td><code>(oldPath: string, patchPath: string, newPath: string) =&gt; Promise&lt;void&gt;</code></td><td>应用补丁还原</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-10">技术实现</h3>
<h4 data-id="heading-11">1. 构建系统迁移</h4>






























<table><thead><tr><th>维度</th><th>bsdiff-node</th><th>bsdiff-rust</th></tr></thead><tbody><tr><td>绑定方案</td><td>node-gyp (C++)</td><td>napi-rs (Rust)</td></tr><tr><td>编译时机</td><td>用户安装时</td><td>发布时预编译</td></tr><tr><td>依赖项</td><td>Python, C++ 编译器</td><td>无</td></tr><tr><td>安装耗时</td><td>30s+ (含编译)</td><td>&lt; 5s</td></tr></tbody></table>
<h4 data-id="heading-12">2. 核心算法与 BSDIFF40 格式</h4>
<p><code>bsdiff</code> 的补丁格式遵循严格标准：<strong>BSDIFF40</strong>。名称来源于补丁文件前 8 字节的魔数 <code>"BSDIFF40"</code>。所有符合该格式的补丁文件在不同实现间可互通——无论是原版 <code>bsdiff</code>/<code>bspatch</code>、<code>bsdiff-node</code> 还是 <code>bsdiff-rust</code>，都能正确解析和应用。</p>
<pre><code class="hljs">┌───────────────────────────────────────────────────────┐
│                  BSDIFF 算法流程                       │
├───────────────────────────────────────────────────────┤
│  旧文件 ──┬──▶ 后缀数组构建 ──▶ 最长匹配搜索          │
│           │                          │                │
│  新文件 ──┴──────────────────────────┴──▶ 差分编码    │
│                                              │        │
│                                              ▼        │
│                                      BSDIFF40 Patch   │
└───────────────────────────────────────────────────────┘
</code></pre>
<p><strong>Rust 重构要点</strong>：</p>
<ul>
<li>后缀数组使用 <code>suffix</code> crate 优化</li>
<li>bzip2 压缩使用 <code>bzip2</code> crate</li>
<li>严格的内存安全，无 <code>unsafe</code> 代码块（除 FFI 边界）</li>
<li>完全兼容 BSDIFF40 格式头（<code>BSDIFF40</code> magic + 3×8 字节长度字段）</li>
</ul>
<h4 data-id="heading-13">3. napi-rs 集成</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-meta">#[napi]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">diff</span>(old_path: <span class="hljs-type">String</span>, new_path: <span class="hljs-type">String</span>, patch_path: <span class="hljs-type">String</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;()&gt; {
    <span class="hljs-comment">// 异步文件 I/O + 线程池计算</span>
    tokio::task::<span class="hljs-title function_ invoke__">spawn_blocking</span>(<span class="hljs-keyword">move</span> || {
        bsdiff_core::<span class="hljs-title function_ invoke__">diff</span>(&amp;old_path, &amp;new_path, &amp;patch_path)
    })
    .<span class="hljs-keyword">await</span>
    .<span class="hljs-title function_ invoke__">map_err</span>(|e| Error::<span class="hljs-title function_ invoke__">from_reason</span>(e.<span class="hljs-title function_ invoke__">to_string</span>()))?
}
</code></pre>
<h4 data-id="heading-14">4. 为什么选择 Rust</h4>
<p>Rust 在系统级性能上不输 C，同时提供内存安全保障，更适合现代工程场景。结合 napi-rs 的优势：</p>
<ul>
<li><strong>不依赖特定 Node-API 版本</strong>，跨 Node 版本兼容性好</li>
<li><strong>预编译跨平台二进制</strong>，避免用户安装时的编译痛点</li>
<li><strong>类型安全的 FFI 边界</strong>，减少运行时错误</li>
</ul>
<hr/>
<h3 data-id="heading-15">平台支持</h3>






























<table><thead><tr><th>平台</th><th>架构</th><th>状态</th></tr></thead><tbody><tr><td>Windows</td><td>x64, x86, arm64</td><td>✅</td></tr><tr><td>macOS</td><td>x64 (Intel), arm64 (Apple Silicon)</td><td>✅</td></tr><tr><td>Linux</td><td>x64, arm64, armv7</td><td>✅</td></tr><tr><td>Linux (musl)</td><td>x64, arm64</td><td>✅</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-16">性能基准</h3>
<blockquote>
<p>测试环境：MacBook Pro M1, Node.js v20, 100MB 测试文件</p>
</blockquote>



































<table><thead><tr><th>指标</th><th>bsdiff-node</th><th>bsdiff-rust</th><th>提升</th></tr></thead><tbody><tr><td>安装耗时</td><td>~35s</td><td>~3s</td><td><strong>-91%</strong></td></tr><tr><td>diff 执行</td><td>12.3s</td><td>10.1s</td><td><strong>-18%</strong></td></tr><tr><td>patch 执行</td><td>2.8s</td><td>2.2s</td><td><strong>-21%</strong></td></tr><tr><td>峰值内存</td><td>420MB</td><td>315MB</td><td><strong>-25%</strong></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-17">最佳实践</h3>
<h4 data-id="heading-18">优化 Patch 体积</h4>
<p>直接对文件夹差分效果不佳，推荐以下流程：</p>
<pre><code class="hljs language-bash" lang="bash">旧版本目录                        新版本目录
     │                                 │
     ▼                                 ▼
┌─────────────┐                 ┌─────────────┐
│  tar 打包   │  (顺序稳定)      │  tar 打包   │
└──────┬──────┘                 └──────┬──────┘
       ▼                               ▼
┌─────────────┐                 ┌─────────────┐
│ zip/gzip 压缩│  (消除元数据噪音)│ zip/gzip 压缩│
└──────┬──────┘                 └──────┬──────┘
       │                               │
       └───────────┬───────────────────┘
                   ▼
            ┌─────────────┐
            │ bsdiff diff │
            └──────┬──────┘
                   ▼
              小体积 patch
</code></pre>
<p><strong>原理</strong>：</p>
<ul>
<li><code>tar</code> 保证文件顺序一致，消除目录遍历顺序差异</li>
<li>压缩消除时间戳、权限等元数据噪音</li>
<li>让 diff 算法看到更连续的字节流，提高匹配效率</li>
</ul>
<h4 data-id="heading-19">示例代码</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { execSync } <span class="hljs-keyword">from</span> <span class="hljs-string">'child_process'</span>;
<span class="hljs-keyword">import</span> { diff, patch } <span class="hljs-keyword">from</span> <span class="hljs-string">'bsdiff-rust'</span>;

<span class="hljs-comment">// 打包 + 压缩</span>
<span class="hljs-title function_">execSync</span>(<span class="hljs-string">'tar -cf old.tar ./old_dir &amp;&amp; gzip old.tar'</span>);
<span class="hljs-title function_">execSync</span>(<span class="hljs-string">'tar -cf new.tar ./new_dir &amp;&amp; gzip new.tar'</span>);

<span class="hljs-comment">// 差分</span>
<span class="hljs-keyword">await</span> <span class="hljs-title function_">diff</span>(<span class="hljs-string">'old.tar.gz'</span>, <span class="hljs-string">'new.tar.gz'</span>, <span class="hljs-string">'update.patch'</span>);

<span class="hljs-comment">// 应用补丁</span>
<span class="hljs-keyword">await</span> <span class="hljs-title function_">patch</span>(<span class="hljs-string">'old.tar.gz'</span>, <span class="hljs-string">'update.patch'</span>, <span class="hljs-string">'restored.tar.gz'</span>);
</code></pre>
<hr/>
<h3 data-id="heading-20">总结</h3>
<p><code>bsdiff-rust</code> 的目标不是重新发明 bsdiff 算法，而是将这个经典算法<strong>工程化</strong>，让它真正能在现代 Node.js 生态中稳定使用。如果你在项目里做 <strong>客户端增量更新 / 大文件增量发布 / Node.js 跨平台 diff</strong>，<code>bsdiff-rust</code> 是一个值得尝试的解决方案。</p>
<ul>
<li>✅ 标准兼容 BSDIFF40 补丁格式</li>
<li>✅ 无需用户本地编译，提升安装体验</li>
<li>✅ Rust 高性能实现，稳定快速</li>
<li>✅ 适合客户端热更新、大文件增量发布等场景</li>
</ul>
<hr/>
<p><strong>项目地址</strong>：<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSphinm%2Fbsdiff-rust" target="_blank" title="https://github.com/Sphinm/bsdiff-rust" ref="nofollow noopener noreferrer">bsdiff-rust</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>