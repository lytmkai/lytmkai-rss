<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[Vueå®ç°å¤§å±è·å–å½“å‰æ‰€å¤„åŸå¸‚åŠå½“åœ°å¤©æ°”(çº¯å…è´¹)]]></title>    <link>https://juejin.cn/post/7603656494905475078</link>    <guid>https://juejin.cn/post/7603656494905475078</guid>    <pubDate>2026-02-08T01:49:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603656494905475078" data-draft-id="7603656494905458694" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vueå®ç°å¤§å±è·å–å½“å‰æ‰€å¤„åŸå¸‚åŠå½“åœ°å¤©æ°”(çº¯å…è´¹)"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-08T01:49:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æå‰‘ä¸€"/> <meta itemprop="url" content="https://juejin.cn/user/4147782344247918"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vueå®ç°å¤§å±è·å–å½“å‰æ‰€å¤„åŸå¸‚åŠå½“åœ°å¤©æ°”(çº¯å…è´¹)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4147782344247918/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æå‰‘ä¸€
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T01:49:04.000Z" title="Sun Feb 08 2026 01:49:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¹‹å‰åšè¿‡çš„å¤§å±é¡¹ç›®ä¸€èˆ¬æ˜¯åœ¨å†…ç½‘ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œæ‰€ä»¥ä¸€èˆ¬é¡¶éƒ¨ä¸ç‰µæ‰¯å±•ç¤ºåŸå¸‚å’Œå¤©æ°”ã€‚ä½†æ˜¯è¿™æ¬¡åšçš„æ˜¯æ”¾åœ¨å¤–ç½‘çš„ï¼Œæ‰€ä»¥ç®€å•å®ç°ä¸€ä¸‹å±•ç¤ºåŸå¸‚åç§°å’Œå½“å‰å®æ—¶å¤©æ°”ä¿¡æ¯ã€‚</p>
<h2 data-id="heading-0">è·å–å½“å‰æ‰€å¤„ä½ç½®</h2>
<p>è·å–å½“å‰å®šä½å¯ä»¥é€šè¿‡æµè§ˆå™¨åŸç”Ÿçš„<code>Geolocation API</code>è·å–ç»çº¬åº¦ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getLocation</span>(<span class="hljs-params"/>) {
	<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
		<span class="hljs-keyword">if</span> (navigator.<span class="hljs-property">geolocation</span>) {
			navigator.<span class="hljs-property">geolocation</span>.<span class="hljs-title function_">getCurrentPosition</span>(
				<span class="hljs-function">(<span class="hljs-params">position</span>) =&gt;</span> {
					<span class="hljs-keyword">const</span> lat = position.<span class="hljs-property">coords</span>.<span class="hljs-property">latitude</span>;
					<span class="hljs-keyword">const</span> lon = position.<span class="hljs-property">coords</span>.<span class="hljs-property">longitude</span>;
					<span class="hljs-title function_">resolve</span>({lat, lon});
					<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å½“å‰ä½ç½®:'</span>, lat, lon);
				},
				<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
					<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ— æ³•è·å–ä½ç½®:'</span>, error.<span class="hljs-property">message</span>);
					<span class="hljs-title function_">reject</span>(error);
				}
			);
		}
	})
}
</code></pre>
<p>éœ€è¦æ³¨æ„ï¼Œ<code>Geolocation API</code>æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥è¿™é‡Œç”¨ <code>Promise</code> è¿›è¡Œäº†ç®€å•çš„å°è£…ã€‚å¦å¤–è¿™é‡Œåªèƒ½è·å–åˆ°ç»çº¬åº¦ï¼Œæ— æ³•è·å–åˆ°æ‰€åœ¨åŸå¸‚åç§°ï¼Œéœ€è¦é€šè¿‡é€†åœ°ç†ç¼–ç çš„æ–¹å¼å®ç°ã€‚</p>
<h2 data-id="heading-1">é€†åœ°ç†ç¼–ç </h2>
<p>ç›®å‰å›½å†…ä¸»è¦æ˜¯<strong>å¾¡ä¸‰å®¶</strong>æä¾›<strong>é€†åœ°ç†ç¼–ç </strong>çš„æœåŠ¡ï¼Œä½†æ˜¯éƒ½éœ€è¦è¿›è¡Œä»˜è´¹ï¼Œä¸è¿‡å”¯ä¸€å¯ä»¥åº†å¹¸çš„æ˜¯å„å®¶éƒ½æœ‰<strong>å…è´¹é¢åº¦</strong>ã€‚</p>
<p>å¦‚æœä½ çš„å¤§å±éƒ¨ç½²åœ¨å¤–ç½‘ï¼Œå›½å¤–çš„<strong>Nominatim</strong>æ˜¯å®Œå…¨å…è´¹çš„ï¼Œå’±ä»¬è¿™è¾¹ç›®å‰æ˜¯æ— æ³•è®¿é—®çš„ã€‚å®˜ç½‘åœ°å€ä¹Ÿæ”¾ä¸€ä¸ª<a href="https://link.juejin.cn?target=https%3A%2F%2Fnominatim.openstreetmap.org" target="_blank" title="https://nominatim.openstreetmap.org" ref="nofollow noopener noreferrer">nominatim.openstreetmap.org</a>ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¥è…¾è®¯çš„é€†åœ°ç†ç¼–ç æœåŠ¡ä¸ºä¾‹å­ç®€å•å†™ä¸€ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getCityName</span>(<span class="hljs-params">lat, lon</span>) {
	<span class="hljs-keyword">const</span> sig = <span class="hljs-title class_">CryptoJs</span>.<span class="hljs-title class_">MD5</span>(<span class="hljs-string">`/ws/geocoder/v1/?key=<span class="hljs-subst">${ä½ çš„key}</span>&amp;location=<span class="hljs-subst">${lat}</span>,<span class="hljs-subst">${lon}</span><span class="hljs-subst">${ä½ çš„ç­¾å}</span>`</span>).<span class="hljs-title function_">toString</span>();
	<span class="hljs-keyword">const</span> {result} = <span class="hljs-keyword">await</span> request.<span class="hljs-title function_">get</span>(<span class="hljs-string">`/tencent/ws/geocoder/v1/?key=<span class="hljs-subst">${ä½ çš„key}</span>&amp;location=<span class="hljs-subst">${lat}</span>,<span class="hljs-subst">${lon}</span>&amp;sig=<span class="hljs-subst">${sig}</span>`</span>);
	<span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${result.address_component.city}</span>-<span class="hljs-subst">${result.address_component.district}</span>`</span>
}
</code></pre>
<p>è¿™é‡Œéœ€è¦ä»£ç†ä¸€ä¸‹ï¼Œæˆ‘è¿™é‡Œçš„ä»£ç†å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-string">'/tencent'</span>: {
    <span class="hljs-attr">target</span>: <span class="hljs-string">'https://apis.map.qq.com'</span>,
    <span class="hljs-attr">changeOrigin</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">rewrite</span>: <span class="hljs-function">(<span class="hljs-params">path</span>) =&gt;</span> path.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/^\/tencent/</span>, <span class="hljs-string">''</span>)
},
</code></pre>
<h2 data-id="heading-2">è·å–å¤©æ°”</h2>
<p>å¤©æ°”ä¿¡æ¯ç›®å‰å’±ä»¬è¿™è¾¹æœ‰å’Œé£å¤©æ°”ï¼Œæä¾›äº†ä¸€å®šçš„å…è´¹é¢åº¦ã€‚</p>
<p>ä½†æ˜¯æˆ‘åœ¨ç½‘ä¸Šæ‰¾åˆ°ä¸€ä¸ªå¤–é¢çš„ï¼Œä½†æ˜¯å’±ä»¬è¿™è¾¹èƒ½è®¿é—®åˆ°çš„<strong>Open-Meteo</strong>ï¼Œå®˜æ–¹åœ°å€ä¹Ÿæ”¾ä¸€ä¸‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fopen-meteo.com" target="_blank" title="https://open-meteo.com" ref="nofollow noopener noreferrer">open-meteo.com</a>ã€‚</p>
<p>ç‰¹ç‚¹å¦‚ä¸‹ï¼š</p>
<ul>
<li>æ— éœ€æ³¨å†Œã€æ—  API Keyã€æ— è°ƒç”¨é™åˆ¶</li>
<li>æ”¯æŒå…¨çƒç»çº¬åº¦å®æ—¶å¤©æ°” + æœªæ¥7å¤©é¢„æŠ¥</li>
<li>æ•°æ®æ¥æºï¼šæ¬§æ´²ä¸­æœŸå¤©æ°”é¢„æŠ¥ä¸­å¿ƒï¼ˆECMWFï¼‰ç­‰æƒå¨æœºæ„</li>
</ul>
<p>å”¯ä¸€ä¸å¥½çš„ä¸€ç‚¹åœ¨äºè¿”å›çš„éƒ½æ˜¯è‹±æ–‡æ•°æ®ï¼Œéœ€è¦è®¤ä¸ºçš„è½¬æˆä¸­æ–‡ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// éƒ¨åˆ†å¤©æ°”ä¸­è‹±æ–‡æ˜ å°„</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">WEATHER_CODE_MAP</span> = {
	<span class="hljs-number">0</span>: { <span class="hljs-attr">en</span>: <span class="hljs-string">'Clear sky'</span>, <span class="hljs-attr">zh</span>: <span class="hljs-string">'æ™´'</span> },
	<span class="hljs-number">1</span>: { <span class="hljs-attr">en</span>: <span class="hljs-string">'Mainly clear'</span>, <span class="hljs-attr">zh</span>: <span class="hljs-string">'æ™´è½¬å¤šäº‘'</span> },
	<span class="hljs-number">2</span>: { <span class="hljs-attr">en</span>: <span class="hljs-string">'Partly cloudy'</span>, <span class="hljs-attr">zh</span>: <span class="hljs-string">'å¤šäº‘'</span> },
	<span class="hljs-number">3</span>: { <span class="hljs-attr">en</span>: <span class="hljs-string">'Overcast'</span>, <span class="hljs-attr">zh</span>: <span class="hljs-string">'é˜´'</span> },
	<span class="hljs-number">45</span>: { <span class="hljs-attr">en</span>: <span class="hljs-string">'Fog'</span>, <span class="hljs-attr">zh</span>: <span class="hljs-string">'é›¾'</span> },
	<span class="hljs-number">48</span>: { <span class="hljs-attr">en</span>: <span class="hljs-string">'Depositing rime fog'</span>, <span class="hljs-attr">zh</span>: <span class="hljs-string">'å†»é›¾'</span> },
	<span class="hljs-number">51</span>: { <span class="hljs-attr">en</span>: <span class="hljs-string">'Drizzle: Light'</span>, <span class="hljs-attr">zh</span>: <span class="hljs-string">'å°é›¨'</span> },
	<span class="hljs-number">53</span>: { <span class="hljs-attr">en</span>: <span class="hljs-string">'Drizzle: Moderate'</span>, <span class="hljs-attr">zh</span>: <span class="hljs-string">'ä¸­é›¨'</span> },
	<span class="hljs-number">55</span>: { <span class="hljs-attr">en</span>: <span class="hljs-string">'Drizzle: Dense'</span>, <span class="hljs-attr">zh</span>: <span class="hljs-string">'å¤§é›¨'</span> },
	<span class="hljs-number">61</span>: { <span class="hljs-attr">en</span>: <span class="hljs-string">'Rain: Slight'</span>, <span class="hljs-attr">zh</span>: <span class="hljs-string">'å°é›¨'</span> },
	<span class="hljs-number">63</span>: { <span class="hljs-attr">en</span>: <span class="hljs-string">'Rain: Moderate'</span>, <span class="hljs-attr">zh</span>: <span class="hljs-string">'ä¸­é›¨'</span> },
	<span class="hljs-number">65</span>: { <span class="hljs-attr">en</span>: <span class="hljs-string">'Rain: Heavy'</span>, <span class="hljs-attr">zh</span>: <span class="hljs-string">'å¤§é›¨'</span> },
	<span class="hljs-number">71</span>: { <span class="hljs-attr">en</span>: <span class="hljs-string">'Snow fall: Slight'</span>, <span class="hljs-attr">zh</span>: <span class="hljs-string">'å°é›ª'</span> },
	<span class="hljs-number">73</span>: { <span class="hljs-attr">en</span>: <span class="hljs-string">'Snow fall: Moderate'</span>, <span class="hljs-attr">zh</span>: <span class="hljs-string">'ä¸­é›ª'</span> },
	<span class="hljs-number">75</span>: { <span class="hljs-attr">en</span>: <span class="hljs-string">'Snow fall: Heavy'</span>, <span class="hljs-attr">zh</span>: <span class="hljs-string">'å¤§é›ª'</span> },
	<span class="hljs-number">95</span>: { <span class="hljs-attr">en</span>: <span class="hljs-string">'Thunderstorm'</span>, <span class="hljs-attr">zh</span>: <span class="hljs-string">'é›·é˜µé›¨'</span> },
	<span class="hljs-number">96</span>: { <span class="hljs-attr">en</span>: <span class="hljs-string">'Thunderstorm with slight hail'</span>, <span class="hljs-attr">zh</span>: <span class="hljs-string">'é›·é˜µé›¨ä¼´å°å†°é›¹'</span> },
	<span class="hljs-number">99</span>: { <span class="hljs-attr">en</span>: <span class="hljs-string">'Thunderstorm with heavy hail'</span>, <span class="hljs-attr">zh</span>: <span class="hljs-string">'é›·é˜µé›¨ä¼´å¤§å†°é›¹'</span> }
};
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// è·å–å¤©æ°”</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getWeather</span>(<span class="hljs-params">lat, lon</span>) {
	<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> request.<span class="hljs-title function_">get</span>(<span class="hljs-string">`https://api.open-meteo.com/v1/forecast?latitude=<span class="hljs-subst">${lat}</span>&amp;longitude=<span class="hljs-subst">${lon}</span>&amp;current_weather=true`</span>);
	<span class="hljs-keyword">const</span> code = result.<span class="hljs-property">current_weather</span>.<span class="hljs-property">weathercode</span>;
	<span class="hljs-keyword">return</span> <span class="hljs-variable constant_">WEATHER_CODE_MAP</span>[code] || {<span class="hljs-attr">en</span>: <span class="hljs-string">'Unknown'</span>, <span class="hljs-attr">zh</span>: <span class="hljs-string">'æœªçŸ¥'</span>};
}
</code></pre>
<p>è¿™ä¸ªæ˜¯ä¸éœ€è¦ä»£ç†çš„ï¼Œå› ä¸º<strong>Open-Meteo</strong>æœ¬èº«æ”¯æŒ<code>CORS</code>ã€‚</p>
<h2 data-id="heading-3">æ€»ç»“</h2>
<p>è·å–ç»çº¬åº¦å’ŒåŸå¸‚ä¿¡æ¯ï¼Œä»¥åŠå¤©æ°”ä¿¡æ¯åœ¨æŠ€æœ¯ä¸Šæ²¡ä»€ä¹ˆéš¾åº¦ã€‚</p>
<p>ä¸»è¦çš„é—®é¢˜ç‚¹åœ¨äºå¾ˆå¤šä¸œè¥¿éƒ½æ˜¯ä»˜è´¹çš„ï¼Œè‡ªå·±ç©ç©è¿˜å¥½ï¼Œä½†è¦æ˜¯çœŸçš„ä¸Šçº¿æ­£å¼ç¯å¢ƒä¸€å®šè¦<strong>é˜²å¤‡</strong>è¢«åˆ«äººæ¶æ„åˆ·çˆ†ã€‚</p>
<p>ä¹‹å‰æˆ‘è¿˜è§è¿‡ä¸€ä¸ªå¤§å±ä¸Šå®æ—¶å±•ç¤ºå¤©æ°”çŠ¶å†µï¼Œå«æ˜Ÿåœ°å›¾ä¸Šå‰é¢æœ‰ä¸€å±‚è’™ç‰ˆå±•ç¤ºã€‚å¦‚æœæ˜¯ä¸‹é›¨çš„è¯æœ‰é›¨æ»´æ‰“åœ¨å±å¹•ä¸Šçš„æ„Ÿè§‰ï¼Œæ•ˆæœéå¸¸ä¸é”™ï¼Œå›å¤´å®ç°å®Œåˆ†äº«ç»™å¤§å®¶ã€‚</p>
<p>æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·<strong>æå‰‘ä¸€</strong>ï¼Œåˆ†äº«æ›´å¤šçš„å¹²è´§ï¼Œç•…èŠåœˆå†…å…«å¦ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue 3 å…¥é—¨å®Œå…¨æŒ‡å—ï¼šä»é›¶æ„å»ºä½ çš„ç¬¬ä¸€ä¸ªå“åº”å¼åº”ç”¨]]></title>    <link>https://juejin.cn/post/7603673564908552227</link>    <guid>https://juejin.cn/post/7603673564908552227</guid>    <pubDate>2026-02-08T01:51:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603673564908552227" data-draft-id="7603671627003379752" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue 3 å…¥é—¨å®Œå…¨æŒ‡å—ï¼šä»é›¶æ„å»ºä½ çš„ç¬¬ä¸€ä¸ªå“åº”å¼åº”ç”¨"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2026-02-08T01:51:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“ˆé‡Œè°¢é¡¿"/> <meta itemprop="url" content="https://juejin.cn/user/3678304397695056"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue 3 å…¥é—¨å®Œå…¨æŒ‡å—ï¼šä»é›¶æ„å»ºä½ çš„ç¬¬ä¸€ä¸ªå“åº”å¼åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3678304397695056/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“ˆé‡Œè°¢é¡¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T01:51:36.000Z" title="Sun Feb 08 2026 01:51:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>é€‚åˆäººç¾¤</strong>ï¼šæœ‰ HTML/CSS/JavaScript åŸºç¡€ï¼Œæƒ³å¿«é€Ÿä¸Šæ‰‹ Vue 3 çš„å‰ç«¯åˆå­¦è€…<br/>
<strong>å­¦ä¹ ç›®æ ‡</strong>ï¼šæŒæ¡ Vue 3 æ ¸å¿ƒæ¦‚å¿µï¼Œèƒ½ç‹¬ç«‹å¼€å‘ç®€å•äº¤äº’åº”ç”¨<br/>
<strong>æŠ€æœ¯æ ˆ</strong>ï¼šVue 3 + Composition API + Viteï¼ˆ2026 å¹´æœ€æ–°å®è·µï¼‰</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆé€‰æ‹© Vue 3ï¼Ÿ</h2>
<p>åœ¨ Reactã€Angularã€Svelte ç­‰æ¡†æ¶ä¸­ï¼ŒVue å‡­å€Ÿä»¥ä¸‹ä¼˜åŠ¿æˆä¸ºæ–°æ‰‹å‹å¥½ä¹‹é€‰ï¼š</p>

























<table><thead><tr><th>ç‰¹æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æ¸è¿›å¼æ¡†æ¶</strong></td><td>å¯ä» CDN å¼•å…¥ï¼Œä¹Ÿå¯æ„å»ºå¤§å‹ SPA</td></tr><tr><td><strong>ä¸­æ–‡æ–‡æ¡£å®Œå–„</strong></td><td>å®˜æ–¹æä¾›é«˜è´¨é‡ä¸­æ–‡æ–‡æ¡£</td></tr><tr><td><strong>Composition API</strong></td><td>é€»è¾‘å¤ç”¨æ›´çµæ´»ï¼ˆç±»ä¼¼ React Hooksï¼‰</td></tr><tr><td><strong>å¼€å‘ä½“éªŒä¼˜ç§€</strong></td><td>Vite æé€Ÿå¯åŠ¨ï¼ŒHMR çƒ­æ›´æ–°æ¯«ç§’çº§</td></tr></tbody></table>
<blockquote>
<p>ğŸ’¡ <strong>2026 å¹´ç°çŠ¶</strong>ï¼šVue 3 å·²æˆä¸»æµï¼ŒVue 2 äº 2023 å¹´åœæ­¢ç»´æŠ¤ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-1">äºŒã€ç¯å¢ƒå‡†å¤‡ï¼š30 ç§’å¯åŠ¨é¡¹ç›®</h2>
<h3 data-id="heading-2">æ–¹å¼ 1ï¼šCDN å¿«é€Ÿä½“éªŒï¼ˆæ¨èæ–°æ‰‹ï¼‰</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>My First Vue App<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- ä» CDN åŠ è½½ Vue 3 --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://unpkg.com/vue@3/dist/vue.global.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>{{ message }}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"reverseMessage"</span>&gt;</span>åè½¬æ¶ˆæ¯<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">const</span> { createApp, ref } = <span class="hljs-title class_">Vue</span>

    <span class="hljs-title function_">createApp</span>({
      <span class="hljs-title function_">setup</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> message = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'Hello Vue!'</span>)
        
        <span class="hljs-keyword">const</span> <span class="hljs-title function_">reverseMessage</span> = (<span class="hljs-params"/>) =&gt; {
          message.<span class="hljs-property">value</span> = message.<span class="hljs-property">value</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">''</span>).<span class="hljs-title function_">reverse</span>().<span class="hljs-title function_">join</span>(<span class="hljs-string">''</span>)
        }

        <span class="hljs-keyword">return</span> {
          message,
          reverseMessage
        }
      }
    }).<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>)
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<blockquote>
<p>âœ… æ‰“å¼€æµè§ˆå™¨ â†’ ç‚¹å‡»æŒ‰é’® â†’ æ–‡å­—åè½¬ï¼ä½ å·²æˆåŠŸè¿è¡Œ Vueï¼</p>
</blockquote>
<hr/>
<h3 data-id="heading-3">æ–¹å¼ 2ï¼šVite è„šæ‰‹æ¶ï¼ˆç”Ÿäº§çº§å¼€å‘ï¼‰</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># åˆ›å»ºé¡¹ç›®</span>
<span class="hljs-string">npm</span> <span class="hljs-string">create</span> <span class="hljs-string">vue@latest</span> <span class="hljs-string">my-vue-app</span>

<span class="hljs-comment"># æŒ‰æç¤ºé€‰æ‹©ï¼ˆå»ºè®®å…¨é€‰é»˜è®¤ï¼‰</span>
<span class="hljs-string">âœ”</span> <span class="hljs-attr">Project name:</span> <span class="hljs-string">â€¦</span> <span class="hljs-string">my-vue-app</span>
<span class="hljs-string">âœ”</span> <span class="hljs-string">Add</span> <span class="hljs-string">TypeScript?</span> <span class="hljs-string">â€¦</span> <span class="hljs-literal">No</span>
<span class="hljs-string">âœ”</span> <span class="hljs-string">Add</span> <span class="hljs-string">JSX</span> <span class="hljs-string">Support?</span> <span class="hljs-string">â€¦</span> <span class="hljs-literal">No</span>
<span class="hljs-string">âœ”</span> <span class="hljs-string">Add</span> <span class="hljs-string">Vue</span> <span class="hljs-string">Router?</span> <span class="hljs-string">â€¦</span> <span class="hljs-literal">No</span>
<span class="hljs-string">âœ”</span> <span class="hljs-string">Add</span> <span class="hljs-string">Pinia?</span> <span class="hljs-string">â€¦</span> <span class="hljs-literal">No</span>
<span class="hljs-string">âœ”</span> <span class="hljs-string">Add</span> <span class="hljs-string">Vitest?</span> <span class="hljs-string">â€¦</span> <span class="hljs-literal">No</span>
<span class="hljs-string">âœ”</span> <span class="hljs-string">Add</span> <span class="hljs-string">Cypress?</span> <span class="hljs-string">â€¦</span> <span class="hljs-literal">No</span>
<span class="hljs-string">âœ”</span> <span class="hljs-string">Add</span> <span class="hljs-string">ESLint?</span> <span class="hljs-string">â€¦</span> <span class="hljs-literal">Yes</span>
<span class="hljs-string">âœ”</span> <span class="hljs-string">Add</span> <span class="hljs-string">Prettier?</span> <span class="hljs-string">â€¦</span> <span class="hljs-literal">Yes</span>

<span class="hljs-comment"># è¿›å…¥ç›®å½•å¹¶å®‰è£…ä¾èµ–</span>
<span class="hljs-string">cd</span> <span class="hljs-string">my-vue-app</span>
<span class="hljs-string">npm</span> <span class="hljs-string">install</span>

<span class="hljs-comment"># å¯åŠ¨å¼€å‘æœåŠ¡å™¨</span>
<span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">dev</span>
</code></pre>
<p>è®¿é—® <code>http://localhost:5173</code>ï¼Œçœ‹åˆ° Vue å®˜æ–¹æ¬¢è¿é¡µå³æˆåŠŸï¼</p>
<hr/>
<h2 data-id="heading-4">ä¸‰ã€æ ¸å¿ƒæ¦‚å¿µç²¾è®²ï¼ˆé™„ä»£ç ç¤ºä¾‹ï¼‰</h2>
<h3 data-id="heading-5">1. å“åº”å¼æ•°æ®ï¼š<code>ref</code> ä¸ <code>reactive</code></h3>
<h4 data-id="heading-6"><code>ref</code>ï¼šç”¨äºåŸºæœ¬ç±»å‹ï¼ˆå­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”å€¼ï¼‰</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-comment">// åˆ›å»ºå“åº”å¼å¼•ç”¨</span>
<span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)

<span class="hljs-comment">// ä¿®æ”¹å€¼å¿…é¡»é€šè¿‡ .value</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">increment</span> = (<span class="hljs-params"/>) =&gt; {
  count.<span class="hljs-property">value</span>++
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è®¡æ•°: {{ count }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"increment"</span>&gt;</span>+1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<blockquote>
<p>ğŸ” <strong>å…³é”®ç‚¹</strong>ï¼šæ¨¡æ¿ä¸­è‡ªåŠ¨è§£åŒ… <code>.value</code>ï¼Œä½† JS é€»è¾‘ä¸­éœ€æ˜¾å¼ä½¿ç”¨ã€‚</p>
</blockquote>
<h4 data-id="heading-7"><code>reactive</code>ï¼šç”¨äºå¯¹è±¡/æ•°ç»„</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { reactive } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> user = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>
})

<span class="hljs-keyword">const</span> <span class="hljs-title function_">updateAge</span> = (<span class="hljs-params"/>) =&gt; {
  user.<span class="hljs-property">age</span>++ <span class="hljs-comment">// ç›´æ¥ä¿®æ”¹å±æ€§</span>
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ user.name }} - {{ user.age }}å²<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"updateAge"</span>&gt;</span>é•¿å¤§ä¸€å²<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>ä½•æ—¶ç”¨å“ªä¸ªï¼Ÿ</strong></p>
<ul>
<li>å•ä¸ªå€¼ â†’ <code>ref</code></li>
<li>å¤æ‚å¯¹è±¡ â†’ <code>reactive</code></li>
<li>ä¸ç¡®å®šï¼Ÿç»Ÿä¸€ç”¨ <code>ref</code>ï¼ˆæ›´å®‰å…¨ï¼‰</li>
</ul>
</blockquote>
<hr/>
<h3 data-id="heading-8">2. äº‹ä»¶å¤„ç†ï¼š<code>@click</code> ä¸æ–¹æ³•</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- æ–¹æ³•è°ƒç”¨ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"greet"</span>&gt;</span>æ‰“æ‹›å‘¼<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  
  <span class="hljs-comment">&lt;!-- å†…è”å¤„ç†å™¨ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"count++"</span>&gt;</span>ç›´æ¥ä¿®æ”¹<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  
  <span class="hljs-comment">&lt;!-- ä¼ é€’å‚æ•° --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"deleteItem(item.id)"</span>&gt;</span>åˆ é™¤<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  
  <span class="hljs-comment">&lt;!-- ä¿®é¥°ç¬¦ï¼šé˜»æ­¢é»˜è®¤è¡Œä¸º --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">form</span> @<span class="hljs-attr">submit.prevent</span>=<span class="hljs-string">"handleSubmit"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"input"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>æäº¤<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> <span class="hljs-title function_">greet</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-title function_">alert</span>(<span class="hljs-string">'Hello!'</span>)
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">deleteItem</span> = (<span class="hljs-params">id</span>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'åˆ é™¤ID:'</span>, id)
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSubmit</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¡¨å•æäº¤'</span>)
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<blockquote>
<p>ğŸ“Œ <strong>å¸¸ç”¨ä¿®é¥°ç¬¦</strong>ï¼š</p>
<ul>
<li><code>.prevent</code>ï¼šé˜»æ­¢é»˜è®¤è¡Œä¸ºï¼ˆå¦‚è¡¨å•æäº¤åˆ·æ–°ï¼‰</li>
<li><code>.stop</code>ï¼šé˜»æ­¢äº‹ä»¶å†’æ³¡</li>
<li><code>.once</code>ï¼šåªè§¦å‘ä¸€æ¬¡</li>
</ul>
</blockquote>
<hr/>
<h3 data-id="heading-9">3. æ¡ä»¶æ¸²æŸ“ï¼š<code>v-if</code> vs <code>v-show</code></h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- v-ifï¼šæ¡ä»¶ä¸ºå‡æ—¶å®Œå…¨ç§»é™¤ DOM --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"isLoggedIn"</span>&gt;</span>æ¬¢è¿å›æ¥ï¼<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  
  <span class="hljs-comment">&lt;!-- v-else / v-else-if --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-else-if</span>=<span class="hljs-string">"isLoading"</span>&gt;</span>åŠ è½½ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-else</span>&gt;</span>è¯·å…ˆç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  
  <span class="hljs-comment">&lt;!-- v-showï¼šå§‹ç»ˆæ¸²æŸ“ DOMï¼Œä»…åˆ‡æ¢ display --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-show</span>=<span class="hljs-string">"showModal"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modal"</span>&gt;</span>å¼¹çª—å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<blockquote>
<p>âš ï¸ <strong>æ€§èƒ½åŒºåˆ«</strong>ï¼š</p>
<ul>
<li>é¢‘ç¹åˆ‡æ¢ â†’ <code>v-show</code>ï¼ˆé¿å…é‡å¤åˆ›å»º/é”€æ¯ï¼‰</li>
<li>æ¡ä»¶å¾ˆå°‘æ”¹å˜ â†’ <code>v-if</code>ï¼ˆèŠ‚çœå†…å­˜ï¼‰</li>
</ul>
</blockquote>
<hr/>
<h3 data-id="heading-10">4. åˆ—è¡¨æ¸²æŸ“ï¼š<code>v-for</code></h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- æ¸²æŸ“æ•°ç»„ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"item in items"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"item.id"</span>&gt;</span>
      {{ item.name }}
    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
  
  <span class="hljs-comment">&lt;!-- æ¸²æŸ“å¯¹è±¡ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(value, key) in userInfo"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"key"</span>&gt;</span>
    {{ key }}: {{ value }}
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  
  <span class="hljs-comment">&lt;!-- å¸¦ç´¢å¼• --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(item, index) in list"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"item.id"</span>&gt;</span>
    {{ index + 1 }}. {{ item.title }}
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> items = [
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'è‹¹æœ'</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'é¦™è•‰'</span> }
]

<span class="hljs-keyword">const</span> userInfo = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Bob'</span>,
  <span class="hljs-attr">email</span>: <span class="hljs-string">'bob@example.com'</span>
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<blockquote>
<p>ğŸ”‘ <strong>å¿…é¡»åŠ  <code>:key</code></strong>ï¼<br/>
å¸®åŠ© Vue é«˜æ•ˆæ›´æ–°åˆ—è¡¨ï¼ˆé¿å…å¤ç”¨é”™è¯¯ï¼‰</p>
</blockquote>
<hr/>
<h3 data-id="heading-11">5. è¡¨å•ç»‘å®šï¼š<code>v-model</code></h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- æ–‡æœ¬è¾“å…¥ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"message"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¾“å…¥æ¶ˆæ¯"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å®æ—¶é¢„è§ˆ: {{ message }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  
  <span class="hljs-comment">&lt;!-- å¤šè¡Œæ–‡æœ¬ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"description"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span>
  
  <span class="hljs-comment">&lt;!-- å¤é€‰æ¡† --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"isChecked"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{{ isChecked ? 'å·²é€‰ä¸­' : 'æœªé€‰ä¸­' }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
  
  <span class="hljs-comment">&lt;!-- å•é€‰æŒ‰é’® --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"radio"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"picked"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"A"</span>&gt;</span> A
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"radio"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"picked"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"B"</span>&gt;</span> B
  
  <span class="hljs-comment">&lt;!-- ä¸‹æ‹‰é€‰æ‹© --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"selected"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">disabled</span> <span class="hljs-attr">value</span>=<span class="hljs-string">""</span>&gt;</span>è¯·é€‰æ‹©<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">option</span>&gt;</span>A<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">option</span>&gt;</span>B<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> message = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)
<span class="hljs-keyword">const</span> description = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)
<span class="hljs-keyword">const</span> isChecked = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>)
<span class="hljs-keyword">const</span> picked = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'A'</span>)
<span class="hljs-keyword">const</span> selected = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<blockquote>
<p>ğŸ’¡ <strong>ä¿®é¥°ç¬¦</strong>ï¼š</p>
<ul>
<li><code>.trim</code>ï¼šè‡ªåŠ¨å»é™¤é¦–å°¾ç©ºæ ¼ â†’ <code>v-model.trim="text"</code></li>
<li><code>.number</code>ï¼šè½¬ä¸ºæ•°å­— â†’ <code>v-model.number="age"</code></li>
<li><code>.lazy</code>ï¼šå¤±å»ç„¦ç‚¹æ—¶æ›´æ–°ï¼ˆé input æ—¶ï¼‰â†’ <code>v-model.lazy="comment"</code></li>
</ul>
</blockquote>
<hr/>
<h2 data-id="heading-12">å››ã€ç»„ä»¶åŒ–å¼€å‘ï¼šæ„å»ºå¯å¤ç”¨ UI</h2>
<h3 data-id="heading-13">1. åˆ›å»ºç»„ä»¶ï¼ˆButton.vueï¼‰</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- src/components/MyButton.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
    <span class="hljs-attr">class</span>=<span class="hljs-string">"my-button"</span>
    <span class="hljs-attr">:class</span>=<span class="hljs-string">"{ 'primary': primary }"</span>
    @<span class="hljs-attr">click</span>=<span class="hljs-string">"handleClick"</span>
  &gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span> <span class="hljs-comment">&lt;!-- æ’æ§½ï¼šæ¥æ”¶çˆ¶ç»„ä»¶å†…å®¹ --&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-title function_">defineProps</span>({
  <span class="hljs-attr">primary</span>: <span class="hljs-title class_">Boolean</span> <span class="hljs-comment">// æ¥æ”¶çˆ¶ç»„ä»¶ä¼ å…¥çš„å±æ€§</span>
})

<span class="hljs-keyword">const</span> emit = <span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">'click'</span>]) <span class="hljs-comment">// å£°æ˜è§¦å‘çš„äº‹ä»¶</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleClick</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-title function_">emit</span>(<span class="hljs-string">'click'</span>) <span class="hljs-comment">// è§¦å‘ click äº‹ä»¶</span>
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.my-button</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">8px</span> <span class="hljs-number">16px</span>;
  <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ccc</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>;
  <span class="hljs-attribute">cursor</span>: pointer;
}
<span class="hljs-selector-class">.primary</span> {
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#409eff</span>;
  <span class="hljs-attribute">color</span>: white;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<h3 data-id="heading-14">2. ä½¿ç”¨ç»„ä»¶ï¼ˆApp.vueï¼‰</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> <span class="hljs-title class_">MyButton</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/MyButton.vue'</span>
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)
<span class="hljs-keyword">const</span> <span class="hljs-title function_">increment</span> = (<span class="hljs-params"/>) =&gt; count.<span class="hljs-property">value</span>++
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è®¡æ•°: {{ count }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- ä½¿ç”¨ç»„ä»¶ï¼Œä¼ é€’ props å’Œç›‘å¬äº‹ä»¶ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">MyButton</span> 
      <span class="hljs-attr">:primary</span>=<span class="hljs-string">"true"</span> 
      @<span class="hljs-attr">click</span>=<span class="hljs-string">"increment"</span>
    &gt;</span>
      ç‚¹æˆ‘åŠ 1ï¼
    <span class="hljs-tag">&lt;/<span class="hljs-name">MyButton</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<blockquote>
<p>ğŸ§© <strong>ç»„ä»¶ä¸‰è¦ç´ </strong>ï¼š</p>
<ol>
<li><strong>Props</strong>ï¼šçˆ¶ â†’ å­ ä¼ é€’æ•°æ®</li>
<li><strong>Events</strong>ï¼šå­ â†’ çˆ¶ é€šä¿¡</li>
<li><strong>Slots</strong>ï¼šçˆ¶ç»„ä»¶å‘å­ç»„ä»¶æ’å…¥å†…å®¹</li>
</ol>
</blockquote>
<hr/>
<h2 data-id="heading-15">äº”ã€å®æˆ˜ï¼šå¾…åŠäº‹é¡¹ï¼ˆTodo Listï¼‰</h2>
<p>å°†æ‰€å­¦çŸ¥è¯†æ•´åˆä¸ºä¸€ä¸ªå®Œæ•´å°åº”ç”¨ï¼</p>
<h3 data-id="heading-16">1. é¡¹ç›®ç»“æ„</h3>
<pre><code class="hljs language-css" lang="css"><span class="hljs-attribute">src</span>/
â”œâ”€â”€ components/
â”‚   â””â”€â”€ TodoItem<span class="hljs-selector-class">.vue</span>
â””â”€â”€ App<span class="hljs-selector-class">.vue</span>
</code></pre>
<h3 data-id="heading-17">2. App.vueï¼ˆä¸»ç»„ä»¶ï¼‰</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">TodoItem</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/TodoItem.vue'</span>

<span class="hljs-keyword">const</span> newTodo = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)
<span class="hljs-keyword">const</span> todos = <span class="hljs-title function_">ref</span>([
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">'å­¦ä¹  Vue'</span>, <span class="hljs-attr">done</span>: <span class="hljs-literal">false</span> }
])

<span class="hljs-keyword">const</span> <span class="hljs-title function_">addTodo</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (newTodo.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>()) {
    todos.<span class="hljs-property">value</span>.<span class="hljs-title function_">push</span>({
      <span class="hljs-attr">id</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
      <span class="hljs-attr">text</span>: newTodo.<span class="hljs-property">value</span>,
      <span class="hljs-attr">done</span>: <span class="hljs-literal">false</span>
    })
    newTodo.<span class="hljs-property">value</span> = <span class="hljs-string">''</span>
  }
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">removeTodo</span> = (<span class="hljs-params">id</span>) =&gt; {
  todos.<span class="hljs-property">value</span> = todos.<span class="hljs-property">value</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> todo.<span class="hljs-property">id</span> !== id)
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"todo-app"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>æˆ‘çš„å¾…åŠäº‹é¡¹<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- æ·»åŠ æ–°ä»»åŠ¡ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> @<span class="hljs-attr">submit.prevent</span>=<span class="hljs-string">"addTodo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> 
        <span class="hljs-attr">v-model</span>=<span class="hljs-string">"newTodo"</span> 
        <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¾“å…¥æ–°ä»»åŠ¡..."</span>
        @<span class="hljs-attr">keyup.enter</span>=<span class="hljs-string">"addTodo"</span>
      &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>æ·»åŠ <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- ä»»åŠ¡åˆ—è¡¨ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">TodoItem</span> 
        <span class="hljs-attr">v-for</span>=<span class="hljs-string">"todo in todos"</span> 
        <span class="hljs-attr">:key</span>=<span class="hljs-string">"todo.id"</span>
        <span class="hljs-attr">:todo</span>=<span class="hljs-string">"todo"</span>
        @<span class="hljs-attr">remove</span>=<span class="hljs-string">"removeTodo(todo.id)"</span>
      /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å‰©ä½™: {{ todos.filter(t =&gt; !t.done).length }} é¡¹<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<h3 data-id="heading-18">3. TodoItem.vueï¼ˆå­ç»„ä»¶ï¼‰</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"todo-item"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> 
      <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> 
      <span class="hljs-attr">v-model</span>=<span class="hljs-string">"todo.done"</span>
    &gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"{ done: todo.done }"</span>&gt;</span>{{ todo.text }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"$emit('remove')"</span>&gt;</span>åˆ é™¤<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-title function_">defineProps</span>({
  <span class="hljs-attr">todo</span>: <span class="hljs-title class_">Object</span>
})
<span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">'remove'</span>])
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.done</span> {
  <span class="hljs-attribute">text-decoration</span>: line-through;
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#999</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<blockquote>
<p>âœ… åŠŸèƒ½åŒ…å«ï¼š</p>
<ul>
<li>æ·»åŠ ä»»åŠ¡ï¼ˆå›è½¦/æŒ‰é’®ï¼‰</li>
<li>å®Œæˆ/å–æ¶ˆä»»åŠ¡</li>
<li>åˆ é™¤ä»»åŠ¡</li>
<li>ç»Ÿè®¡å‰©ä½™æ•°é‡</li>
</ul>
</blockquote>
<hr/>
<h2 data-id="heading-19">å…­ã€è°ƒè¯•æŠ€å·§</h2>
<h3 data-id="heading-20">1. æµè§ˆå™¨ DevTools</h3>
<p>å®‰è£… <a href="https://link.juejin.cn?target=https%3A%2F%2Fdevtools.vuejs.org%2F" target="_blank" title="https://devtools.vuejs.org/" ref="nofollow noopener noreferrer">Vue Devtools</a> æ‰©å±•ï¼š</p>
<ul>
<li>æŸ¥çœ‹ç»„ä»¶æ ‘</li>
<li>å®æ—¶ä¿®æ”¹å“åº”å¼æ•°æ®</li>
<li>æ£€æŸ¥äº‹ä»¶ç›‘å¬å™¨</li>
</ul>
<h3 data-id="heading-21">2. æ§åˆ¶å°æ—¥å¿—</h3>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// åœ¨ setup() ä¸­</span>
console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'å½“å‰çŠ¶æ€:'</span>, reactiveData)
</code></pre>
<h3 data-id="heading-22">3. å¸¸è§é”™è¯¯æ’æŸ¥</h3>

























<table><thead><tr><th>é”™è¯¯ç°è±¡</th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>æ•°æ®ä¸æ›´æ–°</td><td>æ£€æŸ¥æ˜¯å¦ç”¨ <code>ref</code>/<code>reactive</code> åŒ…è£¹</td></tr><tr><td>äº‹ä»¶ä¸è§¦å‘</td><td>æ£€æŸ¥ <code>@click</code> æ˜¯å¦æ‹¼å†™æ­£ç¡®</td></tr><tr><td>ç»„ä»¶ä¸æ˜¾ç¤º</td><td>æ£€æŸ¥æ˜¯å¦æ­£ç¡® import å’Œæ³¨å†Œ</td></tr><tr><td>æ ·å¼å¤±æ•ˆ</td><td>æ£€æŸ¥ <code>&lt;style scoped&gt;</code> æ˜¯å¦å†²çª</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-23">ä¸ƒã€ä¸‹ä¸€æ­¥å­¦ä¹ è·¯çº¿</h2>
<ol>
<li><strong>è·¯ç”±ç®¡ç†</strong>ï¼šå­¦ä¹  <a href="https://link.juejin.cn?target=https%3A%2F%2Frouter.vuejs.org%2Fzh%2F" target="_blank" title="https://router.vuejs.org/zh/" ref="nofollow noopener noreferrer">Vue Router</a> å®ç°å¤šé¡µé¢è·³è½¬</li>
<li><strong>çŠ¶æ€ç®¡ç†</strong>ï¼šæŒæ¡ <a href="https://link.juejin.cn?target=https%3A%2F%2Fpinia.vuejs.org%2Fzh%2F" target="_blank" title="https://pinia.vuejs.org/zh/" ref="nofollow noopener noreferrer">Pinia</a> ç®¡ç†å…¨å±€çŠ¶æ€</li>
<li><strong>TypeScript</strong>ï¼šä¸º Vue é¡¹ç›®æ·»åŠ ç±»å‹å®‰å…¨</li>
<li><strong>æ„å»ºå·¥å…·</strong>ï¼šæ·±å…¥ç†è§£ Vite é…ç½®</li>
<li><strong>UI åº“</strong>ï¼šé›†æˆ Element Plus / Naive UI å¿«é€Ÿå¼€å‘</li>
</ol>
<hr/>
<h2 data-id="heading-24">å…«ã€æ€»ç»“ï¼šVue 3 æ ¸å¿ƒè¦ç‚¹</h2>



































<table><thead><tr><th>æ¦‚å¿µ</th><th>å…³é”®è¯­æ³•</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td><strong>å“åº”å¼</strong></td><td><code>ref()</code>, <code>reactive()</code></td><td>æ•°æ®é©±åŠ¨è§†å›¾</td></tr><tr><td><strong>æ¨¡æ¿æŒ‡ä»¤</strong></td><td><code>v-if</code>, <code>v-for</code>, <code>v-model</code></td><td>å£°æ˜å¼æ¸²æŸ“</td></tr><tr><td><strong>äº‹ä»¶å¤„ç†</strong></td><td><code>@click</code>, <code>.prevent</code></td><td>ç”¨æˆ·äº¤äº’</td></tr><tr><td><strong>ç»„ä»¶é€šä¿¡</strong></td><td><code>props</code>, <code>emit</code>, <code>slots</code></td><td>æ¨¡å—åŒ–å¼€å‘</td></tr><tr><td><strong>ç»„åˆå¼ API</strong></td><td><code>setup()</code>, <code>script setup</code></td><td>é€»è¾‘å¤ç”¨</td></tr></tbody></table>
<blockquote>
<p>ğŸ’¬ <strong>è®°ä½</strong>ï¼š<br/>
<strong>â€œVue çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šæ•°æ®å˜ï¼Œè§†å›¾è‡ªåŠ¨æ›´æ–°ã€‚â€</strong><br/>
æŒæ¡è¿™ä¸€ç‚¹ï¼Œä½ å°±å·²ç»å…¥é—¨äº†ï¼</p>
</blockquote>
<hr/>
<p><strong>èµ„æºæ¨è</strong>ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcn.vuejs.org%2F" target="_blank" title="https://cn.vuejs.org/" ref="nofollow noopener noreferrer">Vue 3 å®˜æ–¹æ–‡æ¡£ï¼ˆä¸­æ–‡ï¼‰</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.vuemastery.com%2Fcourses%2F" target="_blank" title="https://www.vuemastery.com/courses/" ref="nofollow noopener noreferrer">Vue Mastery å…è´¹è¯¾ç¨‹</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvuejs%2Fawesome-vue" target="_blank" title="https://github.com/vuejs/awesome-vue" ref="nofollow noopener noreferrer">Awesome Vue</a> ç”Ÿæ€å·¥å…·é›†</li>
</ul>
<hr/>
<blockquote>
<p><strong>ä½œè€…</strong>ï¼šå‰ç«¯å·¥ç¨‹å¸ˆ<br/>
<strong>æ›´æ–°æ—¥æœŸ</strong>ï¼š2026 å¹´ 2 æœˆ<br/>
<strong>ç‰ˆæƒå£°æ˜</strong>ï¼šæœ¬æ–‡å¯è‡ªç”±è½¬è½½ï¼Œä½†è¯·ä¿ç•™å‡ºå¤„ã€‚</p>
</blockquote>
<p>å¦‚æœä½ å¸Œæœ›æˆ‘æä¾› <strong>å®Œæ•´çš„ Todo List é¡¹ç›®ä»£ç ä»“åº“</strong> æˆ– <strong>Vue 3 + TypeScript ç‰ˆæœ¬ç¤ºä¾‹</strong>ï¼Œæ¬¢è¿ç»§ç»­æé—®ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é‡æ„å³æ—¶IMé¡¹ç›®13ï¼šä¼˜åŒ–æ¶ˆæ¯é€šè·¯ï¼ˆä¸‹ï¼‰]]></title>    <link>https://juejin.cn/post/7603644943350284294</link>    <guid>https://juejin.cn/post/7603644943350284294</guid>    <pubDate>2026-02-07T10:53:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603644943350284294" data-draft-id="7603656494904590342" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é‡æ„å³æ—¶IMé¡¹ç›®13ï¼šä¼˜åŒ–æ¶ˆæ¯é€šè·¯ï¼ˆä¸‹ï¼‰"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-07T10:53:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="QZQ54188"/> <meta itemprop="url" content="https://juejin.cn/user/666776045362473"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é‡æ„å³æ—¶IMé¡¹ç›®13ï¼šä¼˜åŒ–æ¶ˆæ¯é€šè·¯ï¼ˆä¸‹ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/666776045362473/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    QZQ54188
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T10:53:46.000Z" title="Sat Feb 07 2026 10:53:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä½¿ç”¨SessionIDæ›¿ä»£UserID</h2>
<p>å½“å‰æ¶ˆæ¯é‡‡ç”¨ç”¨æˆ·IDä½œä¸ºå‘é€å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä¼šè¯IDï¼Œè¿™å°±é€ æˆäº†åœ¨åŒä¸€ä¸ªèŠå¤©çª—å£é‡Œï¼ŒA å‘çš„æ¶ˆæ¯å’Œ B å‘çš„æ¶ˆæ¯ï¼Œä½¿ç”¨çš„æ˜¯ä¸¤å¥—å®Œå…¨ä¸ç›¸å…³çš„åºåˆ—å·ä½“ç³» ã€‚ä½ æ— æ³•ç®€å•åœ°é€šè¿‡ Seq æ’åºæ¥è¿˜åŸæ•´ä¸ªå¯¹è¯çš„å…ˆåé¡ºåºï¼ˆTimelineï¼‰ï¼Œå½“ç„¶ä¹Ÿæ˜¯å¯ä»¥è¿˜åŸå…ˆåé¡ºåºçš„ï¼Œå®¢æˆ·ç«¯æ‹‰å–ä¼šè¯çš„æœ€æ–°æ¶ˆæ¯æ—¶ï¼Œå¿…é¡»åŒæ—¶æŸ¥è¯¢å‘ç»™æˆ‘çš„å’Œæˆ‘å‘å‡ºçš„ä¸¤ä»½æ•°æ®ï¼Œå¹¶å°è¯•åœ¨æœ¬åœ°è¿›è¡Œæ—¶é—´æ’åºï¼Œè¿™æ ·é€»è¾‘éå¸¸å®¹æ˜“å‡ºé—®é¢˜ã€‚</p>
<p>å…¶å®ä¸Šé¢çš„ä½¿ç”¨UserIDä½œä¸ºå‘é€å¯¹è±¡æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªæ”¶ä»¶ç®±æ¨¡å‹ï¼Œå½“ä½ ä½¿ç”¨UserIDæ¥åˆ†é…åºåˆ—å·æ—¶ï¼Œä½ å®é™…ä¸Šå°±æ˜¯åœ¨ç»´æŠ¤æ¯ä¸ªäººçš„ç§æœ‰æ”¶ä»¶ç®±ã€‚å½“B å‘æ¶ˆæ¯ç»™A æ—¶ï¼Œç³»ç»Ÿè®¤ä¸ºæ˜¯æŠ•é€’åˆ° A çš„é‚®ç®±ï¼Œæ‰€ä»¥æ¶ˆè€—çš„æ˜¯ A çš„åºåˆ—å·ã€‚</p>
<p>å½“ä½ æŠ½è±¡å‡ºSessionIDå¹¶ä»¥æ­¤åˆ†é…åºåˆ—å·æ—¶ï¼Œå°±æ˜¯åœ¨æ„å»ºå…¬å…±çš„æ—¶é—´çº¿ï¼Œæ˜¯ä¸€ä¸ªå‘ä»¶ç®±æ¨¡å‹ã€‚æ¯ä¸ªä¼šè¯éƒ½æœ‰ä¸€ä¸ªä¸“å±çš„è®¡æ•°å™¨ã€‚æ— è®ºæ˜¯Aè¿˜æ˜¯Bå‘æ¶ˆæ¯ï¼Œå‘é€çš„æ¶ˆæ¯éƒ½å¾—åœ¨Session 1ä¸­æ’é˜Ÿè·å–IDï¼Œè¿™æ ·æ•´ä¸ªä¼šè¯å†…çš„æ¶ˆæ¯å°±æ˜¯å¤©ç„¶æœ‰åºçš„ï¼Œå®¢æˆ·ç«¯åªéœ€è¦è®°å½•ä¸€ä¸ªMaxSeqï¼Œä¸‹æ¬¡æ‹‰å–æ—¶ç›´æ¥è¯·æ±‚Seq &gt; MaxSeqçš„æ‰€æœ‰æ¶ˆæ¯å³å¯ï¼Œæ— è®ºæ˜¯è°å‘é€çš„ã€‚</p>
<p>å…¶å®ä¸Šé¢ä¸¤ç§è®¨è®ºçš„æœ¬è´¨å°±æ˜¯å¯¹äºå†™æ”¾å¤§å’Œè¯»æ”¾å¤§çš„å–èˆã€‚ä½¿ç”¨SessionIDæ¨¡å¼ä¼˜åŒ–äº†å†™æ”¾å¤§ï¼Œåœ¨UserIDè·¯ç”±æ¨¡å¼ä¸­ï¼Œå¦‚æœä½ åœ¨ä¸€ä¸ª500äººçš„ç¾¤é‡Œé¢å‘ä¸€æ¡æ¶ˆæ¯ï¼Œä½ å°±éœ€è¦æŸ¥æ‰¾ç¾¤é‡Œæ‰€æœ‰äººçš„ç”¨æˆ·IDï¼Œç„¶åå†æ’å…¥500æ¡æ¶ˆæ¯ï¼Œä½¿æ¯ä¸ªç¾¤æˆå‘˜çš„æ”¶ä»¶ç®±é‡Œé¢å„æ’ä¸€æ¡ï¼Œå†™æ”¾å¤§ä¸¥é‡ã€‚é‡‡ç”¨ä¼šè¯æ¨¡å¼çš„è¯å°±åªéœ€è¦åœ¨ä¼šè¯è¡¨ä¸­æ’å…¥ä¸€æ¡æ¶ˆæ¯å³å¯ã€‚</p>
<p>ä½†æ˜¯ä¼šè¯æ¨¡å¼é€šå¸¸å­˜åœ¨è¯»æ”¾å¤§é£é™©ï¼Œåœ¨UserIDå³æ”¶ä»¶ç®±æ¨¡å¼ä¸­ï¼Œç”¨æˆ·æ‰“å¼€Appï¼ŒæŸ¥è¯¢æ‰€æœ‰æœªè¯»æ¶ˆæ¯æ—¶ï¼Œåªéœ€è¦æŸ¥ä¸€æ¬¡è‡ªå·±çš„æ”¶ä»¶ç®±è¡¨ï¼Œè¯»å–æå¿«è€Œä¸”é€»è¾‘ç®€å•ã€‚ä½†æ˜¯åœ¨ä¼šè¯æ¨¡å¼çš„è¯ï¼Œéœ€è¦å»æ‰«ææ‰€æœ‰ç›¸å…³çš„ä¼šè¯è¡¨ï¼Œèšåˆè®¡ç®—æ¯ä¸ªä¼šè¯æ˜¯å¦æœ‰æ–°æ¶ˆæ¯ä»¥åŠæœ‰å¤šå°‘æœªè¯»ï¼Œè¿™ä¼šäº§ç”Ÿå·¨å¤§çš„è¯»æ”¾å¤§ ã€‚</p>
<p>è¿™ç§æ–¹å¼å¯ä»¥ä½¿ç”¨å†™æ‰©æ•£ç´¢å¼• + è¯»æ‰©æ•£å†…å®¹çš„æ··åˆæ¨¡å¼è§£å†³ã€‚æ¶ˆæ¯å†…å®¹è¡¨ä¸­ä½¿ç”¨SessionIDå­˜å‚¨ï¼Œæ— è®ºç¾¤èŠè§„æ¨¡å¤šå¤§ï¼ˆä¾‹å¦‚ 5000 äººå¤§ç¾¤ï¼‰ï¼Œä¸€æ¡æ¶ˆæ¯åœ¨ç‰©ç†ä¸Šåªå­˜å‚¨ä¸€ä»½ã€‚è¿™å½»åº•æ¶ˆé™¤äº†æ¶ˆæ¯ä½“å±‚é¢çš„å†™æ”¾å¤§ï¼ŒèŠ‚çœäº†æµ·é‡å­˜å‚¨ç©ºé—´ã€‚å†åŠ ä¸€ä¸ªä¼šè¯ç´¢å¼•è¡¨ï¼Œå¼•å…¥ä¸€ä¸ªè½»é‡çº§çš„ ä¼šè¯ç´¢å¼•è¡¨ ï¼ˆSession Indexï¼‰ï¼Œä½¿ç”¨ UserID (OwnerId) å»ºç«‹ç´¢å¼•ï¼Œè¿™å¼ è¡¨ä»…å­˜å‚¨å…ƒæ•°æ®ï¼Œå¦‚ ConversationID ã€ LastMsgID ã€ UnreadCount ã€ TopStatus ç­‰ï¼Œå½“ç”¨æˆ·æ‰“å¼€ App æ—¶ï¼Œåªéœ€åŸºäº UserID æŸ¥è¯¢è¿™å¼ ç´¢å¼•è¡¨ï¼Œå³å¯ O(1) å¤æ‚åº¦è·å–å®Œæ•´çš„ä¼šè¯åˆ—è¡¨å’Œæœªè¯»çŠ¶æ€ï¼Œè§£å†³äº†è¯»æ”¾å¤§é—®é¢˜ã€‚è¿™æ ·çš„è¯å…¶å®è¿˜æ˜¯æœ‰ç´¢å¼•æ›´æ–°çš„å‹åŠ›ï¼Œå‡è®¾ç¾¤èŠæœ‰500äººï¼Œå†™ä¸€æ¡Messageå­˜å…¥å…±äº«å­˜å‚¨ï¼Œä¹‹åå°±éœ€è¦æ›´æ–°500è¡Œä¼šè¯ç´¢å¼•è¡¨ï¼Œæ›´æ–° LastMsgID æŒ‡é’ˆå¹¶å¢åŠ  UnreadCountï¼Œè¿™éƒ¨åˆ†å¯ä»¥ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—å¼‚æ­¥æ›´æ–°çš„æ–¹å¼è§£å†³ã€‚</p>
<p>ä¸‹é¢æ˜¯æ”¹ä¸ºä½¿ç”¨ä¼šè¯IDæ‰€ä½œçš„å˜åŠ¨ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">getSessionID</span><span class="hljs-params">(id1, id2 <span class="hljs-type">string</span>)</span></span> <span class="hljs-type">string</span> {
	<span class="hljs-keyword">if</span> strings.HasPrefix(id2, <span class="hljs-string">"G"</span>) {
		<span class="hljs-keyword">return</span> id2
	}
	<span class="hljs-comment">// P2P: ä¿è¯ ID é¡ºåºä¸€è‡´</span>
	<span class="hljs-keyword">if</span> id1 &gt; id2 {
		id1, id2 = id2, id1
	}
	hash := md5.Sum([]<span class="hljs-type">byte</span>(fmt.Sprintf(<span class="hljs-string">"%s:%s"</span>, id1, id2)))
	<span class="hljs-keyword">return</span> hex.EncodeToString(hash[:])
}
</code></pre>
<p>é¦–å…ˆåœ¨StateServerä¸­å¢åŠ è¿™ä¸ªå‡½æ•°ï¼Œå¯¹äºå•èŠåœºæ™¯ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯å°†åŒæ–¹IDæ’åºåæ‹¼æ¥min:maxå¹¶è®¡ç®—MD5ï¼Œç¡®ä¿Aå’ŒBæ— è®ºè°å‘é€æ¶ˆæ¯ï¼Œç”Ÿæˆçš„SessionIDéƒ½æ˜¯åŒä¸€ä¸ªã€‚ç¾¤èŠçš„è¯å°±ç›´æ¥ä½¿ç”¨ç¾¤IDä½œä¸ºä¼šè¯IDå°±å¥½ã€‚</p>
<pre><code class="hljs language-go" lang="go">sessionID = getSessionID(req.Uid, msgCmd.ReceiverId)
seq, err = s.alloc.NextSeq(ctx, sessionID)
</code></pre>
<p>è¿™æ®µå˜åŠ¨å¾ˆç®€å•ï¼Œå°±æ˜¯è¦æ±‚åˆ†é…å™¨æŒ‰ç…§ä¼šè¯ä¸ºç²’åº¦å»åˆ†é…è¿ç»­çš„åºå·æµï¼Œè§£å†³äº†æ—¶é—´çº¿å‰²è£‚é—®é¢˜ï¼Œå®¢æˆ·ç«¯æ‹‰å–å†å²æ¶ˆæ¯å˜å¾—éå¸¸ç®€å•ï¼Œåªæ‹‰å–Seq &gt; LocalMaxã€‚ä¹‹åè½åº“ä¹Ÿæ˜¯æŒ‰ç…§è¿™ä¸ªåˆ†é…çš„ä¼šè¯IDå»è½å…¥æ¶ˆæ¯åº“ï¼Œé¿å…å†™æ”¾å¤§ã€‚</p>
<p>ç”±äºæˆ‘ä»¬ä½¿ç”¨äº†ä¸Šé¢æåˆ°çš„æ··åˆé€»è¾‘ï¼Œæ‰€ä»¥åœ¨è½åº“çš„æ—¶å€™æˆ‘ä»¬ä¸ä»…è¦è½åº“<code>model.Message</code>ï¼Œè¿˜éœ€è¦æ›´æ–°ä¼šè¯è¡¨ç›¸å…³ä¿¡æ¯ï¼Œä¸ç„¶æ¶ˆæ¯æ¥æ”¶æ–¹çš„ä¼šè¯ç•Œé¢å°±ä¸ä¼šæ›´æ”¹ï¼Œæç¤ºç”¨æˆ·æœ‰æœªè¯»æ¶ˆæ¯ã€‚å…·ä½“æ¥è¯´ï¼Œåœ¨ç”¨æˆ·çš„ä¼šè¯è¡¨ä¸­åŠ ä¸Šå†™å…¥ä¼šè¯çš„å½“å‰Seqå·ï¼Œä¾¿äºç”¨æˆ·è·å–æ¶ˆæ¯æ—¶å¿«é€Ÿæ ¹æ®ä¼šè¯çš„Seqå·å»æ¶ˆæ¯è¡¨ä¸­æ ¹æ®SessionIDç´¢å¼•å»æ‹‰å–æ¶ˆæ¯ã€‚ç”¨æˆ·æ‰“å¼€ Appï¼Œæœ¬åœ°å­˜çš„æœ€åä¸€æ¡æ¶ˆæ¯ Seq æ˜¯ 100ï¼Œç”¨æˆ·å…ˆæŸ¥è‡ªå·±çš„ Session è¡¨ï¼Œå‘ç°æŸä¸ªä¼šè¯çš„MaxSeqæ˜¯ 150ï¼Œè¯´æ˜æ­¤æ—¶æœ‰50æ¡æ–°æ¶ˆæ¯ã€‚å®¢æˆ·ç«¯æ­¤æ—¶å°±ä¼šå»Messageè¡¨è¯·æ±‚ï¼Œåˆ©ç”¨ç´¢å¼•å¿«é€Ÿæ‹‰å›ç¼ºå¤±çš„æ¶ˆæ¯ã€‚æ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦è½åº“Sessionè¡¨ï¼Œåœ¨è½åº“æˆåŠŸä¹‹åå¼€å¯ä¸€ä¸ªåç¨‹å»å†™Sessionè¡¨ï¼Œå½“ç„¶è¿™é‡Œä¹Ÿå¯ä»¥åŒæ­¥å†™ï¼Œå¦èµ·ä¸€ä¸ªåç¨‹å†™æ˜¯å› ä¸ºå¯èƒ½ä¸€æ¡æ¶ˆæ¯éœ€è¦æ›´æ–°å¤šä¸ªä¼šè¯è¡¨ï¼Œæ­¤æ—¶è€—æ—¶å¢åŠ ï¼ŒåŒæ­¥å†™çš„è¯å°±ä¼šå°è¯•é˜»å¡ç°è±¡ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">go</span> s.updateSessionIndex(ctx, req.Uid, msgCmd.ReceiverId, msgCmd.Content, seq)
</code></pre>
<p>ä¸‹é¢è§£é‡Šä¸€ä¸‹æ›´æ–°ä¼šè¯è¡¨çš„å‡½æ•°ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *Service)</span></span> updateSessionIndex(ctx context.Context, sendId, receiveId, content <span class="hljs-type">string</span>, seq <span class="hljs-type">int64</span>) {
    s.upsertSession(sendId, receiveId, content, <span class="hljs-number">0</span>, seq)

    <span class="hljs-keyword">if</span> strings.HasPrefix(receiveId, <span class="hljs-string">"G"</span>) {
        <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> è·å–ç¾¤æˆå‘˜åˆ—è¡¨å¹¶å¾ªç¯æ›´æ–°</span>
    } <span class="hljs-keyword">else</span> {
        s.upsertSession(receiveId, sendId, content, <span class="hljs-number">1</span>, seq)
    }
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *Service)</span></span> upsertSession(ownerId, peerId, content <span class="hljs-type">string</span>, unreadInc <span class="hljs-type">int</span>, seq <span class="hljs-type">int64</span>) {
    now := time.Now()
    err := dao.GormDB.Clauses(clause.OnConflict{
        Columns: []clause.Column{{Name: <span class="hljs-string">"uuid"</span>}},
        DoUpdates: clause.Assignments(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>{}{
            <span class="hljs-string">"last_message"</span>:    content,
            <span class="hljs-string">"last_message_at"</span>: now,
            <span class="hljs-string">"unread_count"</span>:    gorm.Expr(<span class="hljs-string">"unread_count + ?"</span>, unreadInc),
            <span class="hljs-string">"max_seq"</span>:         seq,
        }),
    }).Create(&amp;model.Session{
        Uuid:          fmt.Sprintf(<span class="hljs-string">"S%s"</span>, getSessionID(ownerId, peerId)),
        SendId:        ownerId,
        ReceiveId:     peerId,
        ReceiveName:   peerId, <span class="hljs-comment">// ç®€åŒ–</span>
        LastMessage:   content,
        LastMessageAt: sql.NullTime{Time: now, Valid: <span class="hljs-literal">true</span>},
        UnreadCount:   unreadInc,
        MaxSeq:        seq,
        CreatedAt:     now,
    }).Error

    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        log.Printf(<span class="hljs-string">"[StateServer] Failed to update session index owner=%s peer=%s: %v"</span>, ownerId, peerId, err)
    }
}
</code></pre>
<p>ç¬¬ä¸€ä¸ªå‡½æ•°æ˜¯ä¾›ä¸Šå±‚è°ƒåº¦çš„å‡½æ•°ï¼Œå†³å®šè°çš„ä¼šè¯éœ€è¦æ›´æ–°ï¼Œå…¶å®å°±æ˜¯åˆ†åˆ«æ›´æ–°å‘é€è€…çš„ä¼šè¯ï¼Œè¡¨ç¤ºå‘é€è€…ç»™æ¥æ”¶è€…å‘é€äº†ä¸€æ¡æ¶ˆæ¯ï¼Œå¹¶åœ¨å¤–å±‚ä¼šè¯ç•Œé¢å†…æ˜¾ç¤ºå‘é€çš„æœ€åä¸€æ¡æ¶ˆæ¯ï¼Œæ›´æ–°æ¥æ”¶è€…çš„ä¼šè¯å°±æ˜¯è®©ä¼šè¯è¡¨å¯¹åº”é¡¹çš„æ¶ˆæ¯æœªè¯»æ•°+1ï¼Œç„¶åæ˜¾ç¤ºæœ€åä¸€æ¡æ¶ˆæ¯ï¼Œå¦‚æœæ˜¯ç¾¤èŠï¼Œè¿™é‡Œç•™äº†ä¸ª TODO ï¼Œå®é™…é€»è¾‘åº”è¯¥æ˜¯å»æŸ¥ç¾¤æˆå‘˜è¡¨ï¼Œç„¶åå¾ªç¯è°ƒç”¨ upsertSession ç»™å‡ ç™¾ä¸ªç¾¤æˆå‘˜éƒ½æ›´æ–°ä¸€éï¼Œè¿™é‡Œæ˜¯å› ä¸ºè¿˜æ²¡é‡æ„ç¾¤èŠç›¸å…³éƒ¨åˆ†ï¼Œå› ä¸ºè¿™éƒ¨åˆ†æ¶‰åŠåˆ°è¶…å¤§ç¾¤ä¼˜åŒ–ï¼Œç•™åˆ°åé¢é‡æ„ã€‚</p>
<p><code>upsertSession</code>è´Ÿè´£æ‰§è¡Œå…·ä½“çš„æ•°æ®åº“æ“ä½œï¼Œé¦–å…ˆå°è¯•å¾€Sessionè¡¨é‡Œæ’å…¥ä¸€è¡Œæ–°æ•°æ®ï¼Œå¦‚æœAå’ŒBä»æ¥æ¯èŠè¿‡å¤©ï¼Œè¿™è¡Œå°±ä¼šæ’å…¥æˆåŠŸï¼Œåˆ›å»ºä¸€ä¸ªæ–°ä¼šè¯ã€‚å¦‚æœæ•°æ®åº“é‡Œå·²ç»æœ‰ä¸€è¡Œ uuid ç›¸åŒçš„è®°å½•ï¼Œå°±æ‰§è¡Œæ›´æ–°æ“ä½œï¼Œæ›´æ–°æœ€æ–°æ¶ˆæ¯é¢„è§ˆï¼Œæ›´æ–°äº‹ä»¶ï¼Œæ›´æ–°æœªè¯»æ¶ˆæ¯æ•°é‡ï¼Œæ›´æ–°ä¼šè¯å†…æœ€æ–°æ¶ˆæ¯Seqã€‚</p>
<h3 data-id="heading-1">æ€»ç»“</h3>
<p>ç°åœ¨æˆ‘ä»¬æ¥æ¢³ç†ä¸€ä¸‹é‡æ„é¡¹ç›®å‰åæ¶ˆæ¯å‘é€å’ŒæŸ¥è¯¢çš„é€»è¾‘å˜åŒ–ã€‚</p>
<p>ä¹‹å‰çš„æ¶ˆæ¯å‘é€é€»è¾‘æ˜¯ï¼Œå®¢æˆ·ç«¯é€šè¿‡WebSocketå‘é€æ¶ˆæ¯ï¼ŒæœåŠ¡ç«¯é€šè¿‡<code>c.Conn.ReadMessage()</code>è¯»å–æ•°æ®ï¼Œç›´æ¥å¡å…¥ä¸€ä¸ªå…¨å±€çš„Chanæˆ–è€…æ¶ˆæ¯é˜Ÿåˆ—ï¼ŒæœåŠ¡ç«¯çš„ä¸»å¾ªç¯ä»Chanæˆ–è€…æ¶ˆæ¯é˜Ÿåˆ—ä¸­å–å‡ºæ¶ˆæ¯ï¼Œç„¶åè°ƒç”¨å¦‚ä¸‹å‡½æ•°è½åº“ï¼š</p>
<pre><code class="hljs language-go" lang="go">message := model.Message{
    Uuid:       fmt.Sprintf(<span class="hljs-string">"M%s"</span>, random.GetNowAndLenRandomString(<span class="hljs-number">11</span>)),
    SessionId:  chatMessageReq.SessionId,
    Type:       chatMessageReq.Type,
    Content:    chatMessageReq.Content,
    Url:        chatMessageReq.Url,
    SendId:     chatMessageReq.SendId,
    SendName:   chatMessageReq.SendName,
    SendAvatar: chatMessageReq.SendAvatar,
    ReceiveId:  chatMessageReq.ReceiveId,
    FileSize:   chatMessageReq.FileSize,
    FileType:   chatMessageReq.FileType,
    FileName:   chatMessageReq.FileName,
    Status:     message_status_enum.Unsent,
    CreatedAt:  time.Now(),
}
</code></pre>
<p>è™½ç„¶æ’å…¥æ¶ˆæ¯æ—¶ç»™SessionIDå­—æ®µèµ‹å€¼äº†ï¼Œä½†æ˜¯è¿™ä¸ªSessionIDæ²¡æœ‰è¢«ä½¿ç”¨ï¼Œå› ä¸ºåé¢çš„æŸ¥è¯¢ä»£ç å¹¶æ²¡æœ‰ä½¿ç”¨SessionIDè¿›è¡ŒæŸ¥è¯¢ï¼Œè€Œä¸”è¿™ä¸ªSessionIDæ˜¯ç›´æ¥ä»å‰ç«¯ä¼ è¿‡æ¥çš„è¯·æ±‚å‚æ•°é‡Œå–çš„ï¼Œæ­¤æ—¶å‰ç«¯ä¼ çš„SessionIDå­˜çš„å€¼å®é™…ä¸Šè¿˜æ˜¯æ¥æ”¶è€…IDï¼Œè¿™å°±å¯¼è‡´åœ¨æ•°æ®åº“ä¸­ï¼ŒAå’ŒBçš„èŠå¤©è®°å½•ä¾ç„¶ä¸å¯ä»¥é€šè¿‡ä¼šè¯æŸ¥è¯¢ã€‚</p>
<p>æ­¤æ—¶ä¹Ÿæ²¡æœ‰Seqçš„æ¦‚å¿µï¼Œçº¯ç²¹æ˜¯æŠŠä¸€æ¡è®°å½•æ’å…¥æ•°æ®åº“ã€‚ç„¶åå°±èµ°åˆ°æ¶ˆæ¯åˆ†å‘çš„é€»è¾‘äº†ï¼Œè¿™éƒ¨åˆ†ä¹Ÿå¾ˆæš´åŠ›ï¼Œå°±æ˜¯åˆ¤æ–­<code>ReceiveID</code>æ˜¯ç”¨æˆ·IDè¿˜æ˜¯ç¾¤IDï¼Œå¦‚æœæ˜¯ç”¨æˆ·IDçš„è¯å°±ç›´æ¥æŸ¥Mapæ‰¾åˆ°å¯¹åº”çš„å®¢æˆ·ç«¯å¥æŸ„å‘é€è¿‡å»å°±å¥½äº†ï¼Œå¦‚æœæ˜¯ç¾¤èŠçš„è¯å°±è¦å…ˆä»æ•°æ®åº“ä¸­æŸ¥å‡ºç¾¤æˆå‘˜åˆ—è¡¨ï¼ŒåŒæ ·åœ¨Mapä¸­æ‰¾åˆ°æ‰€æœ‰å¯¹åº”çš„å®¢æˆ·ç«¯å¥æŸ„ï¼Œæ’é™¤è‡ªå·±ï¼Œç„¶åå‘é€å°±å¥½ã€‚</p>
<p>ä¸‹é¢æ˜¯æŸ¥è¯¢å†å²æ¶ˆæ¯çš„æµç¨‹ï¼Œä¹‹å‰æŸ¥è¯¢å•èŠæ¶ˆæ¯æ—¶ä½¿ç”¨çš„Sqlæ˜¯ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> message 
<span class="hljs-keyword">WHERE</span> (send_id <span class="hljs-operator">=</span> <span class="hljs-string">'A'</span> <span class="hljs-keyword">AND</span> receive_id <span class="hljs-operator">=</span> <span class="hljs-string">'B'</span>) 
   <span class="hljs-keyword">OR</span> (send_id <span class="hljs-operator">=</span> <span class="hljs-string">'B'</span> <span class="hljs-keyword">AND</span> receive_id <span class="hljs-operator">=</span> <span class="hljs-string">'A'</span>)  
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> created_at <span class="hljs-keyword">ASC</span>

<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> message 
<span class="hljs-keyword">WHERE</span> receive_id <span class="hljs-operator">=</span> <span class="hljs-string">'G'</span> 
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> created_at <span class="hljs-keyword">ASC</span>
</code></pre>
<p>ä¸Šé¢æ˜¯å•èŠæŸ¥è¯¢ï¼Œä¸‹é¢æ˜¯ç¾¤èŠæŸ¥è¯¢ã€‚åœ¨å•èŠæŸ¥è¯¢åœºæ™¯ä¸­ï¼Œå› ä¸ºæ²¡æœ‰ç»Ÿä¸€çš„ä¼šè¯IDï¼Œç³»ç»Ÿåªèƒ½å»æ•°æ®åº“é‡ŒæŠŠâ€œAè¯´çš„è¯â€å’Œâ€œBè¯´çš„è¯â€åˆ†åˆ«æå‡ºæ¥ï¼Œç„¶åæŒ‰æ—¶é—´æˆ³ç¡¬æ’åœ¨ä¸€èµ·ï¼Œå‡è£…å®ƒä»¬æ˜¯ä¸€ä¸ªä¼šè¯ã€‚ç”±äºåœ¨æ¶ˆæ¯è¡¨ä¸­<code>send_id</code>å’Œ<code>receive_id</code>éƒ½å»ºç«‹äº†ç´¢å¼•ï¼Œæ‰€ä»¥å…¶å®è¿˜æ˜¯ä¼šèµ°ç´¢å¼•æŸ¥è¯¢ç„¶åå†mergeåˆ°ä¸€èµ·ï¼Œä½†è¿˜æ˜¯æ•ˆç‡ä½ï¼Œå› ä¸ºäºŒçº§ç´¢å¼•éœ€è¦å›è¡¨ï¼Œè€Œä¸”Mergeçš„æ—¶å€™éœ€è¦æ’åºå»é‡ï¼Œæœ‰CPUå’Œå†…å­˜å¼€é”€ã€‚ç¾¤èŠæ¶ˆæ¯çš„æŸ¥è¯¢å°±æ›´åŠ ç®€å•ï¼Œå› ä¸ºæ‰€æœ‰å‘ç»™ç¾¤çš„æ¶ˆæ¯ï¼Œ<code>receive_id</code>éƒ½æ˜¯ç¾¤IDï¼Œæ‰€ä»¥ç›´æ¥åœ¨æ¶ˆæ¯è¡¨ä¸­æŸ¥è¿™ä¸ªå­—æ®µå°±å¯ä»¥ã€‚</p>
<p>ä¹‹å‰æ¶æ„çš„æ¶ˆæ¯å­˜å‚¨å’Œè½¬å‘ç›¸å½“ä½æ•ˆï¼ŒOR æŸ¥è¯¢è™½ç„¶èƒ½å‘½ä¸­ send_id å’Œ receive_id çš„äºŒçº§ç´¢å¼•ï¼Œä½†ä¼šå¯¼è‡´ä¸¤æ¬¡ç´¢å¼•æ‰«æ å’Œ å¤§é‡å›è¡¨ï¼Œæ•°æ®åº“å¿…é¡»å°†ä¸¤éƒ¨åˆ†ç»“æœé›†åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œæ ¹æ®created_atè¿›è¡Œæ’åºï¼Œå½“æ¶ˆæ¯é‡è¾¾åˆ°ç™¾ä¸‡çº§æ—¶ï¼Œè¿™ç§å³æ—¶è®¡ç®—çš„æ’åºå¼€é”€ä¼šè®©æ•°æ®åº“ CPU é£™å‡ï¼Œå“åº”å»¶è¿Ÿä»æ¯«ç§’çº§åŠ£åŒ–åˆ°ç§’çº§ã€‚</p>
<p>è€Œä¸”åœ¨ä¼šè¯å†…æŸ¥è¯¢ç›¸å½“æš´åŠ›ï¼Œåœ¨æŸ¥è¯¢åˆ°æ¶ˆæ¯ä¹‹åï¼Œå®Œå…¨ä¾èµ–æ—¶é—´æˆ³è¿›è¡Œæ’åºï¼Œä½†æ˜¯è¿™åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æ˜¯å¤§å¿Œï¼Œå› ä¸ºæ—¶é’Ÿåç§»æ˜¯ä¸å¯é¿å…åœ°ï¼Œæ¯å°æœåŠ¡å™¨ä¸Šçš„æ—¶é’Ÿå¯èƒ½ä¸åŒæ­¥ï¼Œè€Œä¸”å¯èƒ½ä¼šäº§ç”Ÿæ—¶é’Ÿå›æ‹¨ï¼Œè¿™æ ·çš„è¯å°±æ— æ³•é€šè¿‡æ—¶é—´å»ä½“ç°æ¶ˆæ¯çš„å› æœé¡ºåºäº†ã€‚å¹¶ä¸”ä½¿ç”¨created_atå®ç°å¢é‡åŒæ­¥å¾ˆå¤æ‚ï¼Œå¦‚æœæœåŠ¡ç«¯NTPæ ¡å‡†å¯¼è‡´æ—¶é’Ÿå›æ‹¨ï¼Œæ–°æ¶ˆæ¯çš„æ—¶é—´æˆ³å¯èƒ½æ¯”å®¢æˆ·ç«¯è®°å½•çš„è¿˜å°ï¼Œå¯¼è‡´æ°¸ä¹…æ¼æ‹‰æ¶ˆæ¯ï¼Œå³ä½¿æ—¶é—´å‡†ç¡®ï¼Œåœ¨é«˜å¹¶å‘ä¸‹åŒä¸€æ¯«ç§’å†…å¯èƒ½å­˜åœ¨å¤šæ¡æ¶ˆæ¯ï¼Œå®¢æˆ·ç«¯è‹¥ä½¿ç”¨ &gt; time æŸ¥è¯¢ä¼šæ¼æ‰åŒæ¯«ç§’çš„å…¶ä»–æ¶ˆæ¯ï¼Œè‹¥ä½¿ç”¨ &gt;= time æŸ¥è¯¢åˆ™éœ€è¦å¤„ç†å¤§é‡é‡å¤æ•°æ®ï¼Œé€»è¾‘è„†å¼±ä¸”ä¸å¯é ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œä½¿ç”¨ä¸¥æ ¼å•è°ƒé€’å¢çš„Seqï¼ˆé€»è¾‘æ—¶é’Ÿï¼‰èƒ½å½»åº•é¿å…è¿™äº›é—®é¢˜ï¼Œå®ç°ç²¾å‡†ã€é«˜æ•ˆçš„æ–­ç‚¹ç»­ä¼ ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¼˜åŒ–ä¹‹åçš„æ¶ˆæ¯æ¶æ„ï¼Œmessageè¡¨ä¸­é€šè¿‡(session_id, seq) è¿™ä¸ªè”åˆç´¢å¼•æ¥å®šä½æ•°æ®ã€‚æ­¤æ—¶å½“å®¢æˆ·ç«¯éœ€è¦æ‹‰å–æŸä¸ªä¼šè¯çš„å¢é‡æ¶ˆæ¯æ—¶ï¼ŒæœåŠ¡ç«¯æ‰§è¡Œ SQL<code>SELECT * FROM message WHERE session_id = 'S_A_B' AND seq &gt; 100 ORDER BY seq ASC</code>ï¼Œç”±äºè”åˆç´¢å¼•çš„å­˜åœ¨ï¼Œæ•°æ®åº“å¼•æ“å¯ä»¥ç›´æ¥å®šä½åˆ° (S_A_B, 100) è¿™ä¸ªç´¢å¼•èŠ‚ç‚¹ï¼Œç„¶åæ²¿ç€ B+ æ ‘å¶å­èŠ‚ç‚¹é¡ºåºå‘åè¯»å–å³å¯ã€‚è¿™ç§æ“ä½œæ˜¯çº¯ç²¹çš„é¡ºåº IO ï¼Œæ•ˆç‡è¿œé«˜äºä¹‹å‰çš„å…¨è¡¨æ‰«æ + å†…å­˜æ’åºã€‚è€Œä¸”Seqæ˜¯ä¸¥æ ¼é€’å¢çš„æ•´æ•°ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä¸å†éœ€è¦ä¾èµ–ä¸å¯é çš„ created_at æ—¶é—´æˆ³æ¥æ’åºã€‚æ— è®ºç³»ç»Ÿæ—¶é’Ÿæ˜¯å¦å›æ‹¨ï¼Œæ— è®ºå¹¶å‘æœ‰å¤šé«˜ï¼Œåªè¦ Seq æ˜¯ 101ï¼Œå®ƒå°±ä¸€å®šæ’åœ¨ 100 åé¢ï¼Œå°±å¯ä»¥åšå¼ºå› æœä¿è¯ã€‚</p>
<p>ä¸Šé¢è¯´çš„æ˜¯æ¶ˆæ¯è¡¨ï¼Œæˆ‘ä»¬è¿˜å¢åŠ äº†Sessionè¡¨ï¼Œè¿™ä¸ªè¡¨å­˜å‚¨çš„æ˜¯æ¯ä¸ªäººè‡ªå·±çš„ä¼šè¯ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´Açœ‹åˆ°ä¸€ä¸ªä¼šè¯çš„æœ€åä¸€æ¡æ¶ˆæ¯æ˜¯â€œhelloâ€ï¼Œæœªè¯»æ¶ˆæ¯æ•°æœ‰3æ¡ï¼Œå¯¹è¿™ä¸ªä¼šè¯çš„å¤‡æ³¨åæ˜¯Bï¼Œè¿™æ ·ç±»ä¼¼çš„ä¿¡æ¯ã€‚è¯¥è¡¨é‡‡ç”¨æ”¶ä»¶ç®±æ¨¡å¼è®¾è®¡ï¼Œä¸ºæ¯ä¸ªç”¨æˆ·ç»´æŠ¤ä¸€ä»½ç‹¬ç«‹çš„ä¼šè¯è§†å›¾ï¼ˆåŒ…å« OwnerID ã€ UnreadCount ã€ MaxSeq å’Œ LastMessage ï¼‰ï¼Œè¯»å–ä¼šè¯æ—¶ï¼Œç”¨æˆ·åªéœ€æŸ¥è¯¢è‡ªå·±çš„ç§æœ‰ç´¢å¼•è¡¨ï¼Œå³å¯ O(1) å¤æ‚åº¦ç¬é—´è·å–å¸¦æœ‰çº¢ç‚¹å’Œæœ€æ–°æ¶ˆæ¯é¢„è§ˆçš„å®Œæ•´åˆ—è¡¨ï¼Œå½»åº•è§£å†³äº†æ—§æ¶æ„ä¸­æ‹‰å–åˆ—è¡¨éœ€è¦å…¨è¡¨æ‰«æèšåˆçš„æ€§èƒ½ç“¶é¢ˆã€‚</p>
<p>å¼•å…¥Sessionè¡¨ä¹‹åæŸ¥è¯¢å˜å¾—é«˜æ•ˆï¼Œå®¢æˆ·ç«¯é¦–å…ˆæŸ¥è¯¢Sessionè¡¨ï¼Œç¬é—´æ¸²æŸ“å‡ºé¦–é¡µä¼šè¯åˆ—è¡¨ï¼Œå½“ç”¨æˆ·ç‚¹è¿›æŸä¸ªä¼šè¯æ—¶ï¼Œå®¢æˆ·ç«¯æºå¸¦ SessionID å’Œæœ¬åœ°è®°å½•çš„ LocalMaxSeq ï¼Œç›´æ¥å» Message è¡¨æ‰§è¡ŒèŒƒå›´æŸ¥è¯¢ï¼ˆ WHERE session_id = ? AND seq &gt; LocalMaxSeq ï¼‰ï¼Œè¿™ç§åŸºäºè”åˆç´¢å¼•çš„å•ç´¢å¼•æ‰«æ ï¼Œä¸ä»…æŸ¥è¯¢é€Ÿåº¦æå¿«ï¼Œè€Œä¸”åˆ©ç”¨ Seq çš„å•è°ƒé€’å¢ç‰¹æ€§ï¼Œå½»åº•è§£å†³äº†å¹¶å‘åœºæ™¯ä¸‹çš„æ¶ˆæ¯ä¹±åºå’Œæ—¶é’Ÿå›æ‹¨å¯¼è‡´çš„æ•°æ®ä¸¢å¤±é—®é¢˜ã€‚</p>
<h2 data-id="heading-2">ä¸‹è¡Œæ¶ˆæ¯é“¾è·¯</h2>
<p>ä¹‹å‰æˆ‘ä»¬ä»‹ç»äº†é‡‡ç”¨æ¨æ‹‰ç»“åˆçš„æ–¹å¼å®ç°ä¸‹è¡Œæ¶ˆæ¯çš„å¯é æ€§ï¼Œæˆ‘ä»¬å…ˆå®Œå–„ä¸‹è¡Œæ¶ˆæ¯çš„åè®®ï¼Œè¦åœ¨<code>MESSAGEDOWN</code>ä¿¡ä»¤ä¸­æ–°å¢ä¼šè¯IDå’ŒSeqã€‚</p>
<pre><code class="hljs language-protobuf" lang="protobuf">message MessageDown {
    string uuid = 1; // æ¶ˆæ¯å”¯ä¸€ID
    int32 type = 2; // æ¶ˆæ¯ç±»å‹ (æ–‡æœ¬/å›¾ç‰‡ç­‰)
    string content = 3; // æ¶ˆæ¯å†…å®¹
    string receiver_id = 4; // æ¥æ”¶è€…ID (ç¾¤èŠåˆ™æ˜¯ç¾¤ID)
    int64 seq = 5; // ä¼šè¯å†…åºå·
    string session_id = 6; // ä¼šè¯ID
    string sender_id = 7; // å‘é€è€…ID
}
</code></pre>
<p>æœåŠ¡ç«¯åªè´Ÿè´£æ‰¾åˆ°å¯¹åº”å®¢æˆ·ç«¯å¹¶ä¸”æ¨é€ä¸‹è¡Œæ¶ˆæ¯ï¼Œå®¢æˆ·ç«¯æ£€æŸ¥åºåˆ—å·æ˜¯å¦è¿ç»­ï¼Œå¦‚æœä¸è¿ç»­çš„è¯å°±ä¼šå‘èµ·Pullè¯·æ±‚ä¸»åŠ¨æ‹‰å–æ•°æ®ã€‚å®¢æˆ·ç«¯è¿˜éœ€è¦ç»´æŠ¤ä¸€ä¸ªMessageè¡¨å’ŒSessionè¡¨ï¼Œå…¶ä¸­Messageè¡¨å­˜å‚¨å†å²èŠå¤©æ¶ˆæ¯ï¼Œå…·ä½“çš„èŠå¤©å†…å®¹ï¼ŒSessionè¡¨å°±å­˜å‚¨ä¼šè¯çš„å…ƒæ•°æ®ï¼Œæ¯”å¦‚è¯´å®¢æˆ·ç«¯çš„local_seqï¼Œä¼šè¯å¤‡æ³¨ï¼Œæœªè¯»æ•°å’Œæœ€åä¸€æ¡æ¶ˆæ¯ã€‚</p>
<p>é¦–å…ˆæ¥çœ‹å®¢æˆ·ç«¯ä¸‹è¡Œæ¶ˆæ¯å¯é æ€§çš„ä»£ç ï¼Œå®¢æˆ·ç«¯è§£ææ¶ˆæ¯ä¿¡ä»¤ä¹‹åå‘ç°æ˜¯<code>CommandType_MESSAGEDOWN</code>å°±ä¼šè·¯ç”±åˆ°ä¸‹è¡Œæ¶ˆæ¯å¤„ç†å‡½æ•°ã€‚</p>
<pre><code class="hljs language-go" lang="go">localMsg := &amp;LocalMessage{
    UUID:       down.Uuid,
    SessionID:  down.SessionId,
    Seq:        down.Seq,
    SenderID:   down.SenderId,
    ReceiverID: down.ReceiverId,
    Content:    down.Content,
    Type:       down.Type,
}
</code></pre>
<p>é¦–å…ˆå°±æ˜¯é€šè¿‡æœåŠ¡ç«¯å‘é€çš„ä¸‹è¡Œæ¶ˆæ¯æ„é€ æœ¬åœ°æ¶ˆæ¯ï¼Œåˆ†åˆ«è½åº“å’Œè¿›è¡ŒSeqæ¯”è¾ƒï¼Œç„¶åå°±èµ°åˆ°ä¸‹é¢è¿™ä¸ªå‡½æ•°äº†ã€‚</p>
<pre><code class="hljs language-go" lang="go">cdb.SaveMessage(localMsg)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(cdb *ClientDB)</span></span> SaveMessage(msg *LocalMessage) (<span class="hljs-type">bool</span>, <span class="hljs-type">int64</span>, <span class="hljs-type">int64</span>, <span class="hljs-type">error</span>) {
	cdb.mu.Lock()
	<span class="hljs-keyword">defer</span> cdb.mu.Unlock()

	<span class="hljs-keyword">var</span> isGap <span class="hljs-type">bool</span>
	<span class="hljs-keyword">var</span> gapStart, gapEnd <span class="hljs-type">int64</span>

	err := cdb.db.Transaction(<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(tx *gorm.DB)</span></span> <span class="hljs-type">error</span> {
		<span class="hljs-keyword">var</span> sess Session
		<span class="hljs-keyword">if</span> err := tx.Where(<span class="hljs-string">"session_id = ?"</span>, msg.SessionID).First(&amp;sess).Error; err != <span class="hljs-literal">nil</span> {
			<span class="hljs-keyword">if</span> err != gorm.ErrRecordNotFound {
				<span class="hljs-keyword">return</span> err
			}
			sess.SessionID = msg.SessionID
		}

		<span class="hljs-keyword">if</span> msg.Seq &lt;= sess.LastSeq {
			<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
		}

		<span class="hljs-keyword">if</span> msg.Seq &gt; sess.LastSeq+<span class="hljs-number">1</span> {
			isGap = <span class="hljs-literal">true</span>
			gapStart = sess.LastSeq + <span class="hljs-number">1</span>
			gapEnd = msg.Seq - <span class="hljs-number">1</span>
			<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
		}

		<span class="hljs-keyword">if</span> err := tx.Clauses(clause.OnConflict{
			Columns:   []clause.Column{{Name: <span class="hljs-string">"session_id"</span>}, {Name: <span class="hljs-string">"seq"</span>}},
			DoNothing: <span class="hljs-literal">true</span>,
		}).Create(msg).Error; err != <span class="hljs-literal">nil</span> {
			<span class="hljs-keyword">return</span> err
		}

		sess.LastSeq = msg.Seq
		sess.UnreadCount++
		<span class="hljs-keyword">if</span> err := tx.Clauses(clause.OnConflict{
			Columns:   []clause.Column{{Name: <span class="hljs-string">"session_id"</span>}},
			DoUpdates: clause.AssignmentColumns([]<span class="hljs-type">string</span>{<span class="hljs-string">"last_seq"</span>, <span class="hljs-string">"max_seq"</span>, <span class="hljs-string">"unread_count"</span>, <span class="hljs-string">"updated_at"</span>}),
		}).Create(&amp;sess).Error; err != <span class="hljs-literal">nil</span> {
			<span class="hljs-keyword">return</span> err
		}

		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
	})

	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, err
	}
	<span class="hljs-keyword">return</span> isGap, gapStart, gapEnd, <span class="hljs-literal">nil</span>
}
</code></pre>
<p>é¦–å…ˆæŸ¥è¯¢å‡ºæ¶ˆæ¯æ‰€å±ä¼šè¯ï¼Œç„¶åå°±çŸ¥é“äº†ä¼šè¯çš„lastSeqï¼Œè¯¥ä¼šè¯æœ¬åœ°å·²å­˜å‚¨çš„æœ€å¤§åºå·ã€‚å¦‚æœå‘ç°<code>msg.Seq &lt;= sess.LastSeq</code>çš„è¯å°±ä»£è¡¨æ˜¯é‡å¤æ¶ˆæ¯ï¼Œå·²ç»å­˜å‚¨è¿‡äº†ã€‚å¦‚æœæ˜¯<code>msg.Seq &gt; sess.LastSeq+1</code>è¡¨ç¤ºæœ‰æ¶ˆæ¯æ¼æ´ï¼Œéœ€è¦å®¢æˆ·ç«¯å‘èµ·Pullè¯·æ±‚å»æ‹‰å–æ¶ˆæ¯ï¼Œçœ‹æ˜¯å¦æ˜¯çœŸçš„æœ‰æ¼æ´ã€‚å¦‚æœéƒ½ä¸æ˜¯çš„è¯å°±ä»£è¡¨æ­£å¥½æ˜¯å®¢æˆ·ç«¯æœŸå¾…çš„æ¶ˆæ¯åºå·ï¼Œæ­¤æ—¶ç›´æ¥è½åº“å³å¯ã€‚</p>
<p>å¦‚æœå®¢æˆ·ç«¯è°ƒç”¨è¿™ä¸ªå‡½æ•°æ—¶å‘ç°æœ‰æ¼æ´æ—¶ï¼Œå°±ä¼šä¸»åŠ¨å‘èµ·æ¶ˆæ¯è¡¥æ´è¯·æ±‚ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">if</span> isGap {
    fmt.Printf(<span class="hljs-string">"GAP DETECTED: %s missing %d-%d\n"</span>, down.SessionId, gapStart, gapEnd)

    syncCmd := &amp;protocol.SyncCommand{
        SessionId: down.SessionId,
        StartSeq:  gapStart - <span class="hljs-number">1</span>,
        EndSeq:    down.Seq,
        Limit:     <span class="hljs-number">100</span>,
    }
    syncBytes, _ := proto.Marshal(syncCmd)
    env := &amp;protocol.Command{
        Type: protocol.CommandType_SYNC,
        Data: syncBytes,
    }
    envBytes, _ := proto.Marshal(env)
    <span class="hljs-keyword">if</span> err := wsutil.WriteClientBinary(conn, envBytes); err != <span class="hljs-literal">nil</span> {
        log.Printf(<span class="hljs-string">"send sync failed: %v"</span>, err)
    } <span class="hljs-keyword">else</span> {
        log.Printf(<span class="hljs-string">"Sent SYNC request for %s: %d-%d (blocking current msg %d)"</span>, down.SessionId, gapStart, down.Seq, down.Seq)
    }
}
</code></pre>
<p>åŒæ ·ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°æ¶ˆæ¯è¡¥æ´è¯·æ±‚ä¹‹åå°±ä¼šæŒ‰ç…§å®¢æˆ·ç«¯è¦æ±‚çš„åºåˆ—å·åœ¨æ•°æ®åº“ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼Œç„¶åå°†å¾—åˆ°çš„æ¶ˆæ¯è¿›è¡Œå‘é€ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *Service)</span></span> handleSync(ctx context.Context, cmd *protocol.Command, req *pb.ReceiveMessageRequest) (*pb.ReceiveMessageResponse, <span class="hljs-type">error</span>) {
	<span class="hljs-keyword">var</span> syncCmd protocol.SyncCommand
	<span class="hljs-keyword">if</span> err := proto.Unmarshal(cmd.Data, &amp;syncCmd); err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
	}

	limit := <span class="hljs-type">int</span>(syncCmd.Limit)
	<span class="hljs-keyword">if</span> limit &lt;= <span class="hljs-number">0</span> || limit &gt; <span class="hljs-number">500</span> {
		limit = <span class="hljs-number">100</span>
	}

	msgs, err := s.store.GetMessagesBySeqRange(ctx, syncCmd.SessionId, syncCmd.StartSeq, syncCmd.EndSeq, limit)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		log.Printf(<span class="hljs-string">"[StateServer] Sync failed: %v"</span>, err)
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
	}

	log.Printf(<span class="hljs-string">"[StateServer] Sync found %d messages"</span>, <span class="hljs-built_in">len</span>(msgs))

	<span class="hljs-keyword">for</span> _, m := <span class="hljs-keyword">range</span> msgs {
		down := &amp;protocol.MessageDown{
			Uuid:       m.Uuid,
			Type:       <span class="hljs-type">int32</span>(m.Type),
			Content:    m.Content,
			ReceiverId: m.ReceiveId,
			Seq:        m.Seq,
			SessionId:  m.SessionId,
			SenderId:   m.SendId,
		}
		downBytes, _ := proto.Marshal(down)
		downCmd := &amp;protocol.Command{
			Type: protocol.CommandType_MESSAGEDOWN,
			Data: downBytes,
		}
		downPayload, _ := proto.Marshal(downCmd)

		pushAddr, _ := s.rdb.Get(ctx, fmt.Sprintf(<span class="hljs-string">"UserID:%s"</span>, req.Uid)).Result()
		<span class="hljs-keyword">if</span> pushAddr != <span class="hljs-string">""</span> {
			client, err := s.getPushClient(pushAddr)
			<span class="hljs-keyword">if</span> err == <span class="hljs-literal">nil</span> {
				client.Push(ctx, &amp;pb.PushRequest{UserId: req.Uid, Payload: downPayload})
			}
		}
	}

	respCmd := &amp;protocol.Command{
		Type: protocol.CommandType_SYNC,
		Code: <span class="hljs-number">0</span>,
	}
	respBytes, _ := proto.Marshal(respCmd)

	<span class="hljs-keyword">return</span> &amp;pb.ReceiveMessageResponse{
		ResponsePayload: respBytes,
	}, <span class="hljs-literal">nil</span>
}
</code></pre>
<p>é¦–å…ˆä»é€šç”¨çš„ <code>Command</code> ç»“æ„ä¸­æå–å‡ºå…·ä½“çš„ <code>SyncCommand</code>ã€‚è¿™é‡Œé¢åŒ…å«äº†å®¢æˆ·ç«¯æƒ³è¦çš„ <code>SessionId</code> ä»¥åŠç¼ºå¤±çš„æ¶ˆæ¯åŒºé—´ï¼ˆ<code>StartSeq</code> åˆ° <code>EndSeq</code>ï¼‰ï¼Œè¿™é‡Œè¿˜è¿›è¡Œäº†é™æµå¤„ç†ï¼Œå¼ºåˆ¶é™åˆ¶å•æ¬¡åŒæ­¥çš„æ¶ˆæ¯æ¡æ•°ï¼ˆæœ€å¤§ 500 æ¡ï¼‰ï¼Œé˜²æ­¢å®¢æˆ·ç«¯æ¶æ„è¯·æ±‚æˆ–è¶…å¤§èŒƒå›´æŸ¥è¯¢æ‹–å®æ•°æ®åº“ã€‚</p>
<p>ç„¶åå°±æ˜¯è°ƒç”¨å­˜å‚¨å±‚æ ¹æ®åºå·åŒºé—´æŠ“å–æ¶ˆæ¯ï¼Œè·å–åˆ°æ¶ˆæ¯åˆ—è¡¨ä¹‹åå°±æŠŠæŸ¥å‡ºæ¥çš„å†å²æ¶ˆæ¯pushç»™å®¢æˆ·ç«¯ï¼Œå°†å†å²æ¶ˆæ¯å°è£…è¿› <code>MESSAGEDOWN</code> ç±»å‹ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°åï¼Œä¼šå†æ¬¡è°ƒç”¨ä½ åˆšæ‰é‚£ä¸ª <code>SaveMessage</code> å‡½æ•°ï¼Œä»è€Œå¡«è¡¥æœ¬åœ°çš„ç©ºæ´ã€‚æœ€åå°±æ˜¯å‘Šè¯‰å®¢æˆ·ç«¯å¤„ç†å·²ç»å®Œæˆã€‚</p>
<p>åˆ°è¿™é‡Œå°±å·²ç»å®Œæˆäº†ä¸‹è¡Œæ¶ˆæ¯çš„å¯é æ€§ï¼Œåœ¨çº¿æ¶ˆæ¯é€šè¿‡æœåŠ¡ç«¯ç›´æ¥Pushç»™å®¢æˆ·ç«¯ï¼Œå¦‚æœå‘ç°æœ‰æ¶ˆæ¯æ¼æ´çš„è¯å®¢æˆ·ç«¯å°±å»pullæœåŠ¡ç«¯çš„æ¶ˆæ¯ï¼Œæ­¤æ—¶ä¸‹è¡Œæ¶ˆæ¯æ˜¯é TCPå’Œå®¢æˆ·ç«¯ä¸»åŠ¨æ‹‰å–å®ç°å¯é æ€§çš„ã€‚å¦‚æœTCPè¿æ¥ä¸ç¨³å®šï¼Œå³åœ¨å¼±ç½‘ç¯å¢ƒä¸‹æ—¶ï¼ŒTCPè¿æ¥æ–­å¼€ï¼Œæ­¤æ—¶ä¸‹è¡Œæ¶ˆæ¯å°±ä¸¢å¤±äº†ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥åŸºäºå®¢æˆ·ç«¯çš„Pullè¯·æ±‚å®ç°æ¶ˆæ¯å¯é æ€§ï¼Œåªéœ€è¦ä¿è¯æ¯æ¬¡å»ºç«‹è¿æ¥æˆ–è€…å®¢æˆ·ç«¯ç™»å½•çš„æ—¶å€™éƒ½ä¸»åŠ¨è¿›è¡Œä¸€æ¬¡Pullè¯·æ±‚æ‹‰å–æ•°æ®å°±å¥½äº†ï¼Œè¿™æ ·å°±ç®—é‡å»ºè¿æ¥çš„è¯ï¼Œè¿˜æ˜¯å¯ä»¥æ ¹æ®å®¢æˆ·ç«¯ç¼ºå¤±çš„æ¶ˆæ¯è¿›è¡ŒPullè¯·æ±‚æ‹‰å–æ¶ˆæ¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JDBC]]></title>    <link>https://juejin.cn/post/7603649945977978899</link>    <guid>https://juejin.cn/post/7603649945977978899</guid>    <pubDate>2026-02-07T11:29:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603649945977978899" data-draft-id="7603575399256358952" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JDBC"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-07T11:29:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="code_YuJun"/> <meta itemprop="url" content="https://juejin.cn/user/3615612462441358"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JDBC
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3615612462441358/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    code_YuJun
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T11:29:57.000Z" title="Sat Feb 07 2026 11:29:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»31åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¦‚å¿µ</h2>
<ul>
<li>JDBCï¼šJava Database Connectivityï¼Œæ„ä¸ºJavaæ•°æ®åº“è¿æ¥ã€‚</li>
<li>JDBCæ˜¯Javaæä¾›çš„ä¸€ç»„ç‹¬ç«‹äºä»»ä½•æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„APIã€‚</li>
<li>Javaæä¾›æ¥å£è§„èŒƒï¼Œç”±å„ä¸ªæ•°æ®åº“å‚å•†æä¾›æ¥å£çš„å®ç°ï¼Œå‚å•†æä¾›çš„å®ç°ç±»å°è£…æˆ jar æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¿—ç§°çš„æ•°æ®åº“é©±åŠ¨ jar åŒ…ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c4dd77acb744b4887858c9c14ba04cd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY29kZV9ZdUp1bg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068598&amp;x-signature=FVZTJmbXgH5hbrnRl2fdx69AnTA%3D" alt="image-20240221134431944.png" loading="lazy"/></li>
</ul>
<h2 data-id="heading-1">JDBCçš„æ ¸å¿ƒç»„æˆ</h2>
<ul>
<li>æ¥å£è§„èŒƒï¼š
<ul>
<li>ä¸ºäº†é¡¹ç›®ä»£ç çš„å¯ç§»æ¤æ€§ï¼Œå¯ç»´æŠ¤æ€§ï¼ŒSUNå…¬å¸ä»æœ€åˆå°±åˆ¶å®šäº†Javaç¨‹åºè¿æ¥å„ç§æ•°æ®åº“çš„ç»Ÿä¸€æ¥å£è§„èŒƒã€‚è¿™æ ·çš„è¯ï¼Œä¸ç®¡æ˜¯è¿æ¥å“ªä¸€ç§DBMSè½¯ä»¶ï¼ŒJavaä»£ç å¯ä»¥ä¿æŒä¸€è‡´æ€§ã€‚</li>
<li>æ¥å£å­˜å‚¨åœ¨java.sqlå’Œjavax.sqlåŒ…ä¸‹ã€‚</li>
</ul>
</li>
<li>å®ç°è§„èŒƒï¼š
<ul>
<li>å› ä¸ºå„ä¸ªæ•°æ®åº“å‚å•†çš„DBMSè½¯ä»¶å„æœ‰ä¸åŒï¼Œé‚£ä¹ˆå„è‡ªçš„å†…éƒ¨å¦‚ä½•é€šè¿‡SQLå®ç°å¢ã€åˆ ã€æ”¹ã€æŸ¥ç­‰æ“ä½œç®¡ç†æ•°æ®ï¼Œåªæœ‰è¿™ä¸ªæ•°æ®åº“å‚å•†è‡ªå·±æ›´æ¸…æ¥šï¼Œå› æ­¤æŠŠæ¥å£è§„èŒƒçš„å®ç°äº¤ç»™å„ä¸ªæ•°æ®åº“å‚å•†è‡ªå·±å®ç°ã€‚</li>
<li>å‚å•†å°†å®ç°å†…å®¹å’Œè¿‡ç¨‹å°è£…æˆjaræ–‡ä»¶ï¼Œæˆ‘ä»¬ç¨‹åºå‘˜åªéœ€è¦å°†jaræ–‡ä»¶å¼•å…¥åˆ°é¡¹ç›®ä¸­é›†æˆå³å¯ï¼Œå°±å¯ä»¥å¼€å‘è°ƒç”¨å®ç°è¿‡ç¨‹æ“ä½œæ•°æ®åº“äº†ã€‚</li>
</ul>
</li>
</ul>
<h2 data-id="heading-2">JDBCæ­å»ºæ­¥éª¤</h2>
<ol>
<li>å‡†å¤‡æ•°æ®åº“ã€‚</li>
<li>å®˜ç½‘ä¸‹è½½æ•°æ®åº“è¿æ¥é©±åŠ¨jaråŒ…ã€‚<a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">downloads.mysql.com/archives/c-â€¦</a></li>
<li>åˆ›å»ºJavaé¡¹ç›®ï¼Œåœ¨é¡¹ç›®ä¸‹åˆ›å»ºlibæ–‡ä»¶å¤¹ï¼Œå°†ä¸‹è½½çš„é©±åŠ¨jaråŒ…å¤åˆ¶åˆ°æ–‡ä»¶å¤¹é‡Œã€‚</li>
<li>é€‰ä¸­libæ–‡ä»¶å¤¹å³é”®-&gt;Add as Library(æ·»åŠ ä¸ºåº“)ï¼Œä¸é¡¹ç›®é›†æˆã€‚</li>
<li>ç¼–å†™ä»£ç </li>
</ol>
<h2 data-id="heading-3">ä»£ç å®ç°</h2>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> DATABASE atguigu;

use atguigu;

<span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> t_emp
(
    emp_id     <span class="hljs-type">int</span> auto_increment comment <span class="hljs-string">'å‘˜å·¥ç¼–å·'</span> <span class="hljs-keyword">primary</span> key,
    emp_name   <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>)  <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> comment <span class="hljs-string">'å‘˜å·¥å§“å'</span>,
    emp_salary <span class="hljs-keyword">double</span>(<span class="hljs-number">10</span>, <span class="hljs-number">5</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> comment <span class="hljs-string">'å‘˜å·¥è–ªèµ„'</span>,
    emp_age    <span class="hljs-type">int</span>           <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> comment <span class="hljs-string">'å‘˜å·¥å¹´é¾„'</span>
);

<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t_emp (emp_name,emp_salary,emp_age)
<span class="hljs-keyword">values</span>  (<span class="hljs-string">'andy'</span>, <span class="hljs-number">777.77</span>, <span class="hljs-number">32</span>),
        (<span class="hljs-string">'å¤§é£å“¥'</span>, <span class="hljs-number">666.66</span>, <span class="hljs-number">41</span>),
        (<span class="hljs-string">'åº·å¸ˆå‚…'</span>,<span class="hljs-number">111</span>, <span class="hljs-number">23</span>),
        (<span class="hljs-string">'Gavin'</span>,<span class="hljs-number">123</span>, <span class="hljs-number">26</span>),
        (<span class="hljs-string">'å°é±¼å„¿'</span>, <span class="hljs-number">123</span>, <span class="hljs-number">28</span>);
</code></pre>
<h3 data-id="heading-4">Javaä»£ç </h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.atguigu.base;

<span class="hljs-keyword">import</span> java.sql.*;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JdbcQuick</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> ClassNotFoundException, SQLException {
        <span class="hljs-comment">//1.æ³¨å†Œé©±åŠ¨</span>
        Class.forName(<span class="hljs-string">"com.mysql.cj.jdbc.Driver"</span>);

        <span class="hljs-comment">//2.è·å–æ•°æ®åº“è¿æ¥</span>
        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> DriverManager.getConnection(<span class="hljs-string">"jdbc:mysql://localhost:3306/atguigu"</span>, <span class="hljs-string">"root"</span>, <span class="hljs-string">"2594131385"</span>);

        <span class="hljs-comment">//3.åˆ›å»ºStatementå¯¹è±¡</span>
        <span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">preparedStatement</span> <span class="hljs-operator">=</span> connection.prepareStatement(<span class="hljs-string">"select emp_id,emp_name,emp_salary,emp_age from t_emp"</span>);

        <span class="hljs-comment">//4.ç¼–å†™SQLè¯­å¥å¹¶æ‰§è¡Œï¼Œè·å–ç»“æœé›†åˆ</span>
        <span class="hljs-type">ResultSet</span> <span class="hljs-variable">resultSet</span> <span class="hljs-operator">=</span> preparedStatement.executeQuery();

        <span class="hljs-comment">//5.å¤„ç†ç»“æœ</span>
        <span class="hljs-keyword">while</span> (resultSet.next()) {
            <span class="hljs-type">int</span> <span class="hljs-variable">empId</span> <span class="hljs-operator">=</span> resultSet.getInt(<span class="hljs-string">"emp_id"</span>);
            <span class="hljs-type">String</span> <span class="hljs-variable">empName</span> <span class="hljs-operator">=</span> resultSet.getString(<span class="hljs-string">"emp_name"</span>);
            <span class="hljs-type">String</span> <span class="hljs-variable">empSalary</span> <span class="hljs-operator">=</span> resultSet.getString(<span class="hljs-string">"emp_salary"</span>);
            <span class="hljs-type">int</span> <span class="hljs-variable">empAge</span> <span class="hljs-operator">=</span> resultSet.getInt(<span class="hljs-string">"emp_age"</span>);
            System.out.println(empId + <span class="hljs-string">"\t"</span> + empName + <span class="hljs-string">"\t"</span> + empSalary + <span class="hljs-string">"\t"</span> + empAge);
        }

        <span class="hljs-comment">//6.é‡Šæ”¾èµ„æº(å…ˆå¼€åå…³åŸåˆ™)</span>
        resultSet.close();
        preparedStatement.close();
        connection.close();
    }
}
</code></pre>
<h2 data-id="heading-5">æ ¸å¿ƒAPI</h2>
<h3 data-id="heading-6">æ³¨å†Œé©±åŠ¨</h3>
<p><code>Class.forName("com.mysql.cj.jdbc.Driver");</code></p>
<ul>
<li>å½“ä½¿ç”¨ JDBC è¿æ¥æ•°æ®åº“æ—¶ï¼Œéœ€è¦åŠ è½½æ•°æ®åº“ç‰¹å®šçš„é©±åŠ¨ç¨‹åºï¼Œä»¥ä¾¿ä¸æ•°æ®åº“è¿›è¡Œé€šä¿¡ã€‚<strong>åŠ è½½é©±åŠ¨ç¨‹åºçš„ç›®çš„æ˜¯ä¸ºäº†æ³¨å†Œé©±åŠ¨ç¨‹åº</strong>ï¼Œä½¿å¾— JDBC API èƒ½å¤Ÿè¯†åˆ«å¹¶ä¸ç‰¹å®šçš„æ•°æ®åº“è¿›è¡Œäº¤äº’ã€‚<br/>
åœ¨é©±åŠ¨åŒ…ä¸‹ï¼šcom.mysql.cj.jdbc.Driver</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.mysql.cj.jdbc;

<span class="hljs-keyword">import</span> java.sql.DriverManager;
<span class="hljs-keyword">import</span> java.sql.SQLException;

<span class="hljs-comment">// å®ç°äº† java ä¸­çš„æ¥å£</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Driver</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">NonRegisteringDriver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">java</span>.sql.Driver {
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Driver</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
    }
    <span class="hljs-keyword">static</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// æ³¨å†Œä¸€ä¸ªï¼ˆé©±åŠ¨ç±»çš„å¯¹è±¡ï¼‰</span>
            DriverManager.registerDriver(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Driver</span>());
        } <span class="hljs-keyword">catch</span> (SQLException var1) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"Can't register driver!"</span>);
        }
    }
}
</code></pre>
<h3 data-id="heading-7">Connection</h3>
<ul>
<li>Connection ç”¨äºå»ºç«‹ä¸æ•°æ®åº“çš„é€šä¿¡é€šé“ã€‚Connectionå¯¹è±¡ä¸ä¸ºç©ºï¼Œåˆ™ä»£è¡¨ä¸€æ¬¡æ•°æ®åº“è¿æ¥ã€‚</li>
<li>åœ¨å»ºç«‹è¿æ¥æ—¶ï¼Œéœ€è¦æŒ‡å®šæ•°æ®åº“URLã€ç”¨æˆ·åã€å¯†ç å‚æ•°ã€‚</li>
<li><code>Connection</code> æ¥å£è¿˜è´Ÿè´£ç®¡ç†äº‹åŠ¡ï¼Œ<code>Connection</code> æ¥å£æä¾›äº† <code>commit</code> å’Œ <code>rollback</code> æ–¹æ³•ï¼Œç”¨äºæäº¤äº‹åŠ¡å’Œå›æ»šäº‹åŠ¡ã€‚</li>
<li>å¯ä»¥åˆ›å»º <code>Statement</code> å¯¹è±¡ï¼Œç”¨äºæ‰§è¡Œ SQL è¯­å¥å¹¶ä¸æ•°æ®åº“è¿›è¡Œäº¤äº’ã€‚</li>
<li>åœ¨ä½¿ç”¨JDBCæŠ€æœ¯æ—¶ï¼Œå¿…é¡»è¦å…ˆè·å–Connectionå¯¹è±¡ï¼Œåœ¨ä½¿ç”¨å®Œæ¯•åï¼Œè¦é‡Šæ”¾èµ„æºï¼Œé¿å…èµ„æºå ç”¨æµªè´¹åŠæ³„æ¼ã€‚</li>
</ul>
<h3 data-id="heading-8">Statement</h3>
<ul>
<li><code>Statement</code> æ¥å£ç”¨äºæ‰§è¡Œ SQL è¯­å¥å¹¶ä¸æ•°æ®åº“è¿›è¡Œäº¤äº’ã€‚</li>
<li>ç»“æœå¯ä»¥æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªç»“æœã€‚
<ul>
<li>å¢åˆ æ”¹ï¼šå—å½±å“è¡Œæ•°å•ä¸ªç»“æœã€‚</li>
<li>æŸ¥è¯¢ï¼šå•è¡Œå•åˆ—ã€å¤šè¡Œå¤šåˆ—ã€å•è¡Œå¤šåˆ—ç­‰ç»“æœã€‚</li>
</ul>
</li>
<li><code>Statement</code> æ¥å£åœ¨æ‰§è¡ŒSQLè¯­å¥æ—¶ï¼Œä¼šäº§ç”Ÿ<code>SQLæ³¨å…¥æ”»å‡»é—®é¢˜</code>:
<ul>
<li>å½“ä½¿ç”¨ <code>Statement</code> æ‰§è¡ŒåŠ¨æ€æ„å»ºçš„ SQL æŸ¥è¯¢æ—¶(æœ‰æŸ¥è¯¢æ¡ä»¶)ï¼Œå¾€å¾€éœ€è¦å°†æŸ¥è¯¢æ¡ä»¶ä¸ SQL è¯­å¥æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œç›´æ¥å°†å‚æ•°å’ŒSQLè¯­å¥ä¸€å¹¶ç”Ÿæˆï¼Œè®©SQLçš„æŸ¥è¯¢æ¡ä»¶å§‹ç»ˆä¸ºtrueå¾—åˆ°ç»“æœã€‚</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-java" lang="java">System.out.println(<span class="hljs-string">"è¯·è¾“å…¥å‘˜å·¥å§“åï¼š"</span>)ï¼›
<span class="hljs-type">Scanner</span>Â <span class="hljs-variable">scanner</span>Â <span class="hljs-operator">=</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Scanner</span>(System.Â in);
<span class="hljs-type">String</span>Â <span class="hljs-variable">name</span>Â <span class="hljs-operator">=</span>Â scanner.Â nextline();
<span class="hljs-comment">// ç¼–å†™SQLè¯­å¥ï¼Œå¹¶æ‰§è¡Œï¼Œæ¥å—è¿”å›çš„ç»“æœ</span>
<span class="hljs-type">String</span>Â <span class="hljs-variable">sql</span>Â <span class="hljs-operator">=</span>Â <span class="hljs-string">"SELECTÂ emp_id,Â emp_name,Â emp_salary,Â emp_ageÂ FROMÂ t_empÂ WHEREÂ emp_nameÂ =Â '"</span>+name+<span class="hljs-string">""</span>;

<span class="hljs-type">ResultSet</span>Â <span class="hljs-variable">resultSet</span>Â <span class="hljs-operator">=</span>Â statement.executeQuery(sql);

<span class="hljs-comment">// å¤„ç†ç»“æœï¼šéå†resultSet</span>
<span class="hljs-keyword">while</span>(resultSet.next()){
    <span class="hljs-type">int</span>Â <span class="hljs-variable">empId</span>Â <span class="hljs-operator">=</span>Â resultSet.Â getInt(Â columnLabel:Â <span class="hljs-string">"emp_id"</span>);
    <span class="hljs-type">String</span>Â <span class="hljs-variable">empName</span>Â <span class="hljs-operator">=</span>Â resultSet.Â getString(Â columnLabel:Â <span class="hljs-string">"emp_name"</span>);
    <span class="hljs-type">double</span>Â <span class="hljs-variable">empSalary</span>Â <span class="hljs-operator">=</span>Â resultSet.Â getDouble(Â columnLabel:Â <span class="hljs-string">"emp_salary"</span>);
    <span class="hljs-type">int</span>Â <span class="hljs-variable">empAge</span>Â <span class="hljs-operator">=</span>Â resultSet.Â getInt(Â columnLabel:Â <span class="hljs-string">"emp_age"</span>);
    System.out.println(empId+<span class="hljs-string">"\t"</span>+empName+<span class="hljs-string">"\t"</span>+empSalary+<span class="hljs-string">"\t"</span>+empAge);
    
<span class="hljs-comment">// å½“è¾“å…¥ abc' or '1' = '1 æ—¶ï¼Œå°±ä¼šæŠŠæ‰€æœ‰å†…å®¹æŸ¥å‡ºæ¥ã€‚å› ä¸º '1' = '1'å§‹ç»ˆä¸º true</span>
</code></pre>
<h3 data-id="heading-9">PreparedStatement</h3>
<ul>
<li><code>PreparedStatement</code>æ˜¯ <code>Statement</code> æ¥å£çš„å­æ¥å£ï¼Œç”¨äºæ‰§è¡Œ<code>é¢„ç¼–è¯‘</code>çš„ SQL æŸ¥è¯¢ï¼Œä½œç”¨å¦‚ä¸‹ï¼š
<ul>
<li>é¢„ç¼–è¯‘SQLè¯­å¥ï¼šåœ¨åˆ›å»ºPreparedStatementæ—¶ï¼Œå°±ä¼šé¢„ç¼–è¯‘SQLè¯­å¥ï¼Œä¹Ÿå°±æ˜¯SQLè¯­å¥å·²ç»å›ºå®šã€‚</li>
<li>é˜²æ­¢SQLæ³¨å…¥ï¼š<code>PreparedStatement</code> æ”¯æŒå‚æ•°åŒ–æŸ¥è¯¢ï¼Œå°†æ•°æ®ä½œä¸ºå‚æ•°ä¼ é€’åˆ°SQLè¯­å¥ä¸­ï¼Œé‡‡ç”¨?å ä½ç¬¦çš„æ–¹å¼ï¼Œå°†ä¼ å…¥çš„å‚æ•°ç”¨ä¸€å¯¹å•å¼•å·åŒ…è£¹èµ·æ¥''ï¼Œæ— è®ºä¼ é€’ä»€ä¹ˆéƒ½ä½œä¸ºå€¼ã€‚æœ‰æ•ˆé˜²æ­¢ä¼ å…¥å…³é”®å­—æˆ–å€¼å¯¼è‡´SQLæ³¨å…¥é—®é¢˜ã€‚</li>
<li>æ€§èƒ½æå‡ï¼šPreparedStatementæ˜¯é¢„ç¼–è¯‘SQLè¯­å¥ï¼ŒåŒä¸€SQLè¯­å¥å¤šæ¬¡æ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥å¤ç”¨ï¼Œä¸å¿…æ¯æ¬¡é‡æ–°ç¼–è¯‘å’Œè§£æã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-10">ResultSet</h3>
<ul>
<li><code>ResultSet</code>æ˜¯ JDBC API ä¸­çš„ä¸€ä¸ªæ¥å£ï¼Œç”¨äºè¡¨ç¤ºä»æ•°æ®åº“ä¸­<code>æ‰§è¡ŒæŸ¥è¯¢è¯­å¥æ‰€è¿”å›çš„ç»“æœé›†</code>ã€‚å®ƒæä¾›äº†ä¸€ç§ç”¨äºéå†å’Œè®¿é—®æŸ¥è¯¢ç»“æœçš„æ–¹å¼ã€‚</li>
<li>éå†ç»“æœï¼šResultSetå¯ä»¥ä½¿ç”¨ <code>next()</code> æ–¹æ³•å°†æ¸¸æ ‡ç§»åŠ¨åˆ°ç»“æœé›†çš„ä¸‹ä¸€è¡Œï¼Œé€è¡Œéå†æ•°æ®åº“æŸ¥è¯¢çš„ç»“æœï¼Œè¿”å›å€¼ä¸ºbooleanç±»å‹ï¼Œtrueä»£è¡¨æœ‰ä¸‹ä¸€è¡Œç»“æœï¼Œfalseåˆ™ä»£è¡¨æ²¡æœ‰ã€‚</li>
<li>è·å–å•åˆ—ç»“æœï¼šå¯ä»¥é€šè¿‡getXxxçš„æ–¹æ³•è·å–å•åˆ—çš„æ•°æ®ï¼Œè¯¥æ–¹æ³•ä¸ºé‡è½½æ–¹æ³•ï¼Œæ”¯æŒç´¢å¼•å’Œåˆ—åè¿›è¡Œè·å–ã€‚</li>
</ul>
<h2 data-id="heading-11">åŸºäºPreparedStatementå®ç°CRUD</h2>
<h3 data-id="heading-12">æŸ¥è¯¢å•è¡Œå•åˆ—</h3>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">querySingleRowAndColumn</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">//1.æ³¨å†Œé©±åŠ¨</span>
<span class="hljs-comment">//        Class.forName("com.mysql.cj.jdbc.Driver");</span>

        <span class="hljs-comment">//2.è·å–æ•°æ®åº“è¿æ¥</span>
        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> DriverManager.getConnection(<span class="hljs-string">"jdbc:mysql://localhost:3306/atguigu"</span>, <span class="hljs-string">"root"</span>,<span class="hljs-string">"atguigu"</span>);

        <span class="hljs-comment">//3.åˆ›å»ºPreparedStatementå¯¹è±¡ï¼Œå¹¶é¢„ç¼–è¯‘SQLè¯­å¥</span>
        <span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">preparedStatement</span> <span class="hljs-operator">=</span> connection.prepareStatement(<span class="hljs-string">"select count(*) as count from t_emp"</span>);

        <span class="hljs-comment">//4.æ‰§è¡ŒSQLè¯­å¥ï¼Œè·å–ç»“æœ</span>
        <span class="hljs-type">ResultSet</span> <span class="hljs-variable">resultSet</span> <span class="hljs-operator">=</span> preparedStatement.executeQuery();

        <span class="hljs-comment">//5.å¤„ç†ç»“æœ</span>
        <span class="hljs-keyword">while</span> (resultSet.next()){
            <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> resultSet.getInt(<span class="hljs-string">"count"</span>);
            System.out.println(<span class="hljs-string">"count = "</span> + count);
        }

        <span class="hljs-comment">//6.é‡Šæ”¾èµ„æº(å…ˆå¼€åå…³åŸåˆ™)</span>
        resultSet.close();
        preparedStatement.close();
        connection.close();

    }
</code></pre>
<h3 data-id="heading-13">æŸ¥è¯¢å•è¡Œå¤šåˆ—</h3>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">querySingleRow</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">//1.æ³¨å†Œé©±åŠ¨</span>
<span class="hljs-comment">//        Class.forName("com.mysql.cj.jdbc.Driver");</span>

        <span class="hljs-comment">//2.è·å–æ•°æ®åº“è¿æ¥</span>
        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> DriverManager.getConnection(<span class="hljs-string">"jdbc:mysql://localhost:3306/atguigu"</span>,<span class="hljs-string">"root"</span>,<span class="hljs-string">"atguigu"</span>);

        <span class="hljs-comment">//3.åˆ›å»ºPreparedStatementå¯¹è±¡ï¼Œå¹¶é¢„ç¼–è¯‘SQLè¯­å¥ï¼Œä½¿ç”¨?å ä½ç¬¦</span>
        <span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">preparedStatement</span> <span class="hljs-operator">=</span> connection.prepareStatement(<span class="hljs-string">"select emp_id,emp_name,emp_salary,emp_age from t_emp where emp_id = ?"</span>);

        <span class="hljs-comment">//4.ä¸ºå ä½ç¬¦èµ‹å€¼ï¼Œç´¢å¼•ä»1å¼€å§‹ï¼Œæ‰§è¡ŒSQLè¯­å¥ï¼Œè·å–ç»“æœ</span>
        preparedStatement.setInt(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>);
        <span class="hljs-type">ResultSet</span> <span class="hljs-variable">resultSet</span> <span class="hljs-operator">=</span> preparedStatement.executeQuery();

        <span class="hljs-comment">//5.å¤„ç†ç»“æœ</span>
        <span class="hljs-keyword">while</span> (resultSet.next()){
            <span class="hljs-type">int</span> <span class="hljs-variable">empId</span> <span class="hljs-operator">=</span> resultSet.getInt(<span class="hljs-string">"emp_id"</span>);
            <span class="hljs-type">String</span> <span class="hljs-variable">empName</span> <span class="hljs-operator">=</span> resultSet.getString(<span class="hljs-string">"emp_name"</span>);
            <span class="hljs-type">String</span> <span class="hljs-variable">empSalary</span> <span class="hljs-operator">=</span> resultSet.getString(<span class="hljs-string">"emp_salary"</span>);
            <span class="hljs-type">int</span> <span class="hljs-variable">empAge</span> <span class="hljs-operator">=</span> resultSet.getInt(<span class="hljs-string">"emp_age"</span>);
            System.out.println(empId+<span class="hljs-string">"\t"</span>+empName+<span class="hljs-string">"\t"</span>+empSalary+<span class="hljs-string">"\t"</span>+empAge);
        }

        <span class="hljs-comment">//6.é‡Šæ”¾èµ„æº(å…ˆå¼€åå…³åŸåˆ™)</span>
        resultSet.close();
        preparedStatement.close();
        connection.close();

    }
</code></pre>
<h3 data-id="heading-14">æŸ¥è¯¢å¤šè¡Œå¤šåˆ—</h3>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">queryMoreRow</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">//1.æ³¨å†Œé©±åŠ¨</span>
<span class="hljs-comment">//        Class.forName("com.mysql.cj.jdbc.Driver");</span>

        <span class="hljs-comment">//2.è·å–æ•°æ®åº“è¿æ¥</span>
        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> DriverManager.getConnection(<span class="hljs-string">"jdbc:mysql://localhost:3306/atguigu"</span>,<span class="hljs-string">"root"</span>,<span class="hljs-string">"atguigu"</span>);

        <span class="hljs-comment">//3.åˆ›å»ºStatementå¯¹è±¡</span>
        <span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">preparedStatement</span> <span class="hljs-operator">=</span> connection.prepareStatement(<span class="hljs-string">"select emp_id,emp_name,emp_salary,emp_age from t_emp"</span>);

        <span class="hljs-comment">//4.ç¼–å†™SQLè¯­å¥å¹¶æ‰§è¡Œï¼Œè·å–ç»“æœ</span>
        <span class="hljs-type">ResultSet</span> <span class="hljs-variable">resultSet</span> <span class="hljs-operator">=</span> preparedStatement.executeQuery();


        <span class="hljs-comment">//5.å¤„ç†ç»“æœ</span>
        <span class="hljs-keyword">while</span> (resultSet.next()){
            <span class="hljs-type">int</span> <span class="hljs-variable">empId</span> <span class="hljs-operator">=</span> resultSet.getInt(<span class="hljs-string">"emp_id"</span>);
            <span class="hljs-type">String</span> <span class="hljs-variable">empName</span> <span class="hljs-operator">=</span> resultSet.getString(<span class="hljs-string">"emp_name"</span>);
            <span class="hljs-type">String</span> <span class="hljs-variable">empSalary</span> <span class="hljs-operator">=</span> resultSet.getString(<span class="hljs-string">"emp_salary"</span>);
            <span class="hljs-type">int</span> <span class="hljs-variable">empAge</span> <span class="hljs-operator">=</span> resultSet.getInt(<span class="hljs-string">"emp_age"</span>);
            System.out.println(empId+<span class="hljs-string">"\t"</span>+empName+<span class="hljs-string">"\t"</span>+empSalary+<span class="hljs-string">"\t"</span>+empAge);
        }

        <span class="hljs-comment">//6.é‡Šæ”¾èµ„æº(å…ˆå¼€åå…³åŸåˆ™)</span>
        resultSet.close();
        preparedStatement.close();
        connection.close();

    }
</code></pre>
<h3 data-id="heading-15">æ–°å¢</h3>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">//1.æ³¨å†Œé©±åŠ¨</span>
<span class="hljs-comment">//        Class.forName("com.mysql.cj.jdbc.Driver");</span>

        <span class="hljs-comment">//2.è·å–æ•°æ®åº“è¿æ¥</span>
        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> DriverManager.getConnection(<span class="hljs-string">"jdbc:mysql://localhost:3306/atguigu"</span>,<span class="hljs-string">"root"</span>, <span class="hljs-string">"atguigu"</span>);

        <span class="hljs-comment">//3.åˆ›å»ºStatementå¯¹è±¡</span>
        <span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">preparedStatement</span> <span class="hljs-operator">=</span> connection.prepareStatement(<span class="hljs-string">"insert into t_emp (emp_name,emp_salary,emp_age)values  (?, ?,?)"</span>);

        <span class="hljs-comment">//4.ä¸ºå ä½ç¬¦èµ‹å€¼ï¼Œç´¢å¼•ä»1å¼€å§‹ï¼Œç¼–å†™SQLè¯­å¥å¹¶æ‰§è¡Œï¼Œè·å–ç»“æœ</span>
        preparedStatement.setString(<span class="hljs-number">1</span>,<span class="hljs-string">"rose"</span>);
        preparedStatement.setDouble(<span class="hljs-number">2</span>,<span class="hljs-number">666.66</span>);
        preparedStatement.setDouble(<span class="hljs-number">3</span>,<span class="hljs-number">28</span>);
        <span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> preparedStatement.executeUpdate();

        <span class="hljs-comment">//5.å¤„ç†ç»“æœ</span>
        <span class="hljs-keyword">if</span>(result&gt;<span class="hljs-number">0</span>){
            System.out.println(<span class="hljs-string">"æ·»åŠ æˆåŠŸ"</span>);
        }<span class="hljs-keyword">else</span>{
            System.out.println(<span class="hljs-string">"æ·»åŠ å¤±è´¥"</span>);
        }

        <span class="hljs-comment">//6.é‡Šæ”¾èµ„æº(å…ˆå¼€åå…³åŸåˆ™)</span>
        preparedStatement.close();
        connection.close();

    }
</code></pre>
<h3 data-id="heading-16">ä¿®æ”¹</h3>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">//1.æ³¨å†Œé©±åŠ¨</span>
<span class="hljs-comment">//        Class.forName("com.mysql.cj.jdbc.Driver");</span>

        <span class="hljs-comment">//2.è·å–æ•°æ®åº“è¿æ¥</span>
        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> DriverManager.getConnection(<span class="hljs-string">"jdbc:mysql://localhost:3306/atguigu"</span>, <span class="hljs-string">"root"</span>, <span class="hljs-string">"atguigu"</span>);

        <span class="hljs-comment">//3.åˆ›å»ºStatementå¯¹è±¡</span>
        <span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">preparedStatement</span> <span class="hljs-operator">=</span> connection.prepareStatement(<span class="hljs-string">"update t_emp set emp_salary = ? where emp_id = ?"</span>);

        <span class="hljs-comment">//4.ä¸ºå ä½ç¬¦èµ‹å€¼ï¼Œç´¢å¼•ä»1å¼€å§‹ï¼Œç¼–å†™SQLè¯­å¥å¹¶æ‰§è¡Œï¼Œè·å–ç»“æœ</span>
        preparedStatement.setDouble(<span class="hljs-number">1</span>,<span class="hljs-number">888.88</span>);
        preparedStatement.setDouble(<span class="hljs-number">2</span>,<span class="hljs-number">8</span>);
        <span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> preparedStatement.executeUpdate();

        <span class="hljs-comment">//5.å¤„ç†ç»“æœ</span>
        <span class="hljs-keyword">if</span>(result&gt;<span class="hljs-number">0</span>){
            System.out.println(<span class="hljs-string">"ä¿®æ”¹æˆåŠŸ"</span>);
        }<span class="hljs-keyword">else</span>{
            System.out.println(<span class="hljs-string">"ä¿®æ”¹å¤±è´¥"</span>);
        }

        <span class="hljs-comment">//6.é‡Šæ”¾èµ„æº(å…ˆå¼€åå…³åŸåˆ™)</span>
        preparedStatement.close();
        connection.close();

    }
</code></pre>
<h3 data-id="heading-17">åˆ é™¤</h3>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">delete</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">//1.æ³¨å†Œé©±åŠ¨</span>
<span class="hljs-comment">//        Class.forName("com.mysql.cj.jdbc.Driver");</span>

        <span class="hljs-comment">//2.è·å–æ•°æ®åº“è¿æ¥</span>
        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> DriverManager.getConnection(<span class="hljs-string">"jdbc:mysql://localhost:3306/atguigu"</span>, <span class="hljs-string">"root"</span>, <span class="hljs-string">"atguigu"</span>);

        <span class="hljs-comment">//3.åˆ›å»ºStatementå¯¹è±¡</span>
        <span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">preparedStatement</span> <span class="hljs-operator">=</span> connection.prepareStatement(<span class="hljs-string">"delete from t_emp where emp_id = ?"</span>);

        <span class="hljs-comment">//4.ä¸ºå ä½ç¬¦èµ‹å€¼ï¼Œç´¢å¼•ä»1å¼€å§‹ï¼Œç¼–å†™SQLè¯­å¥å¹¶æ‰§è¡Œï¼Œè·å–ç»“æœ</span>
        preparedStatement.setInt(<span class="hljs-number">1</span>,<span class="hljs-number">8</span>);
        <span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> preparedStatement.executeUpdate();

        <span class="hljs-comment">//5.å¤„ç†ç»“æœ</span>
        <span class="hljs-keyword">if</span>(result&gt;<span class="hljs-number">0</span>){
            System.out.println(<span class="hljs-string">"åˆ é™¤æˆåŠŸ"</span>);
        }<span class="hljs-keyword">else</span>{
            System.out.println(<span class="hljs-string">"åˆ é™¤å¤±è´¥"</span>);
        }

        <span class="hljs-comment">//6.é‡Šæ”¾èµ„æº(å…ˆå¼€åå…³åŸåˆ™)</span>
        preparedStatement.close();
        connection.close();

    }
</code></pre>
<h3 data-id="heading-18">å…­ã€å¸¸è§é—®é¢˜</h3>
<h4 data-id="heading-19">6.1 èµ„æºçš„ç®¡ç†</h4>
<blockquote>
<p>åœ¨ä½¿ç”¨JDBCçš„ç›¸å…³èµ„æºæ—¶ï¼Œæ¯”å¦‚Connectionã€PreparedStatementã€ResultSetï¼Œä½¿ç”¨å®Œæ¯•åï¼Œè¦åŠæ—¶å…³é—­è¿™äº›èµ„æºä»¥é‡Šæ”¾æ•°æ®åº“æœåŠ¡å™¨èµ„æºå’Œé¿å…å†…å­˜æ³„æ¼æ˜¯å¾ˆé‡è¦çš„ã€‚</p>
</blockquote>
<h4 data-id="heading-20">6.2 SQLè¯­å¥é—®é¢˜</h4>
<blockquote>
<p>java.sql.SQLSyntaxErrorExceptionï¼šSQLè¯­å¥é”™è¯¯å¼‚å¸¸ï¼Œä¸€èˆ¬æœ‰å‡ ç§å¯èƒ½ï¼š</p>
<ol>
<li>SQLè¯­å¥æœ‰é”™è¯¯ï¼Œæ£€æŸ¥SQLè¯­å¥ï¼å»ºè®®SQLè¯­å¥åœ¨SQLå·¥å…·ä¸­æµ‹è¯•åå†å¤åˆ¶åˆ°Javaç¨‹åºä¸­ï¼</li>
<li>è¿æ¥æ•°æ®åº“çš„URLä¸­ï¼Œæ•°æ®åº“åç§°ç¼–å†™é”™è¯¯ï¼Œä¹Ÿä¼šæŠ¥è¯¥å¼‚å¸¸ï¼</li>
</ol>
<p><img src="%E8%BD%AC%E5%AD%98%E5%A4%B1%E8%B4%A5%EF%BC%8C%E5%BB%BA%E8%AE%AE%E7%9B%B4%E6%8E%A5%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E6%96%87%E4%BB%B6%20JDBC.assets/image-20240223143826507.png" alt="image-20240223143826507è½¬å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" loading="lazy"/></p>
</blockquote>
<h4 data-id="heading-21">6.3 SQLè¯­å¥æœªè®¾ç½®å‚æ•°é—®é¢˜</h4>
<blockquote>
<p>java.sql.SQLExceptionï¼šNo value specified for parameter 1</p>
<p>åœ¨ä½¿ç”¨é¢„ç¼–è¯‘SQLè¯­å¥æ—¶ï¼Œå¦‚æœæœ‰?å ä½ç¬¦ï¼Œè¦ä¸ºæ¯ä¸€ä¸ªå ä½ç¬¦èµ‹å€¼ï¼Œå¦åˆ™æŠ¥è¯¥é”™è¯¯ï¼</p>
<p><img src="%E8%BD%AC%E5%AD%98%E5%A4%B1%E8%B4%A5%EF%BC%8C%E5%BB%BA%E8%AE%AE%E7%9B%B4%E6%8E%A5%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E6%96%87%E4%BB%B6%20JDBC.assets/image-20240223143947558.png" alt="image-20240223143947558è½¬å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" loading="lazy"/></p>
</blockquote>
<h4 data-id="heading-22">6.4 ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯é—®é¢˜</h4>
<blockquote>
<p>è¿æ¥æ•°æ®åº“æ—¶ï¼Œå¦‚æœç”¨æˆ·åæˆ–å¯†ç è¾“å…¥é”™è¯¯ï¼Œä¹Ÿä¼šæŠ¥SQLExceptionï¼Œå®¹æ˜“æ··æ·†ï¼æ‰€ä»¥ä¸€å®šè¦çœ‹æ¸…æ¥šå¼‚å¸¸åé¢çš„åŸå› æè¿°</p>
<p><img src="%E8%BD%AC%E5%AD%98%E5%A4%B1%E8%B4%A5%EF%BC%8C%E5%BB%BA%E8%AE%AE%E7%9B%B4%E6%8E%A5%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E6%96%87%E4%BB%B6%20JDBC.assets/image-20240223144345939.png" alt="image-20240223144345939è½¬å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" loading="lazy"/></p>
</blockquote>
<h4 data-id="heading-23">6.5 é€šä¿¡å¼‚å¸¸</h4>
<blockquote>
<p>åœ¨è¿æ¥æ•°æ®åº“çš„URLä¸­ï¼Œå¦‚æœIPæˆ–ç«¯å£å†™é”™äº†ï¼Œä¼šæŠ¥å¦‚ä¸‹å¼‚å¸¸ï¼š</p>
<p>com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure</p>
<p><img alt="image-20240227234754309è½¬å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" src="" loading="lazy"/></p>
</blockquote>
<h2 data-id="heading-24">JDBCæ‰©å±•</h2>
<h4 data-id="heading-25">7.1 å®ä½“ç±»å’ŒORM</h4>
<blockquote>
<ul>
<li>åœ¨ä½¿ç”¨JDBCæ“ä½œæ•°æ®åº“æ—¶ï¼Œæˆ‘ä»¬ä¼šå‘ç°æ•°æ®éƒ½æ˜¯é›¶æ•£çš„ï¼Œæ˜æ˜åœ¨æ•°æ®åº“ä¸­æ˜¯ä¸€è¡Œå®Œæ•´çš„æ•°æ®ï¼Œåˆ°äº†Javaä¸­å˜æˆäº†ä¸€ä¸ªä¸€ä¸ªçš„å˜é‡ï¼Œä¸åˆ©äºç»´æŠ¤å’Œç®¡ç†ã€‚è€Œæˆ‘ä»¬Javaæ˜¯é¢å‘å¯¹è±¡çš„ï¼Œä¸€ä¸ªè¡¨å¯¹åº”çš„æ˜¯ä¸€ä¸ªç±»ï¼Œä¸€è¡Œæ•°æ®å°±å¯¹åº”çš„æ˜¯Javaä¸­çš„ä¸€ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªåˆ—å¯¹åº”çš„æ˜¯å¯¹è±¡çš„å±æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠŠæ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªè½½ä½“é‡Œï¼Œè¿™ä¸ªè½½ä½“å°±æ˜¯å®ä½“ç±»ï¼</li>
<li>ORMï¼ˆObject Relational Mappingï¼‰æ€æƒ³ï¼Œ<strong>å¯¹è±¡åˆ°å…³ç³»æ•°æ®åº“çš„æ˜ å°„</strong>ï¼Œä½œç”¨æ˜¯åœ¨ç¼–ç¨‹ä¸­ï¼ŒæŠŠé¢å‘å¯¹è±¡çš„æ¦‚å¿µè·Ÿæ•°æ®åº“ä¸­è¡¨çš„æ¦‚å¿µå¯¹åº”èµ·æ¥ï¼Œä»¥é¢å‘å¯¹è±¡çš„è§’åº¦æ“ä½œæ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œå³ä¸€å¼ è¡¨å¯¹åº”ä¸€ä¸ªç±»ï¼Œä¸€è¡Œæ•°æ®å¯¹åº”ä¸€ä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªåˆ—å¯¹åº”ä¸€ä¸ªå±æ€§ï¼</li>
<li>å½“ä¸‹JDBCä¸­è¿™ç§è¿‡ç¨‹æˆ‘ä»¬ç§°å…¶ä¸ºæ‰‹åŠ¨ORMã€‚åç»­æˆ‘ä»¬ä¹Ÿä¼šå­¦ä¹ ORMæ¡†æ¶ï¼Œæ¯”å¦‚MyBatisã€JPAç­‰ã€‚</li>
</ul>
</blockquote>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.atguigu.pojo;
<span class="hljs-comment">//ç±»åå’Œæ•°æ®åº“åå¯¹åº”ï¼Œä½†æ˜¯è¡¨åä¸€èˆ¬ç¼©å†™ï¼Œç±»åè¦å…¨å†™ï¼</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> {
    <span class="hljs-keyword">private</span> Integer empId;<span class="hljs-comment">//emp_id = empId æ•°æ®åº“ä¸­åˆ—åç”¨ä¸‹åˆ’çº¿åˆ†éš”ï¼Œå±æ€§åç”¨é©¼å³°ï¼</span>
    <span class="hljs-keyword">private</span> String empName;<span class="hljs-comment">//emp_name = empName</span>
    <span class="hljs-keyword">private</span> Double empSalary;<span class="hljs-comment">//emp_salary = empSalary</span>
    <span class="hljs-keyword">private</span> Integer empAge;<span class="hljs-comment">//emp_age = empAge</span>

    <span class="hljs-comment">//çœç•¥getã€setã€æ— å‚ã€æœ‰å‚ã€toStringæ–¹æ³•ã€‚</span>
}
</code></pre>
<p>å°è£…ä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">querySingleRow</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">//1.æ³¨å†Œé©±åŠ¨</span>
<span class="hljs-comment">//        Class.forName("com.mysql.cj.jdbc.Driver");</span>

        <span class="hljs-comment">//2.è·å–æ•°æ®åº“è¿æ¥</span>
        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> DriverManager.getConnection(<span class="hljs-string">"jdbc:mysql://localhost:3306/atguigu"</span>, <span class="hljs-string">"root"</span>,<span class="hljs-string">"atguigu"</span>);

        <span class="hljs-comment">//3.åˆ›å»ºPreparedStatementå¯¹è±¡ï¼Œå¹¶é¢„ç¼–è¯‘SQLè¯­å¥ï¼Œä½¿ç”¨?å ä½ç¬¦</span>
        <span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">preparedStatement</span> <span class="hljs-operator">=</span> connection.prepareStatement(<span class="hljs-string">"select emp_id,emp_name,emp_salary,emp_age from t_emp where emp_id = ?"</span>);

        <span class="hljs-comment">//4.ä¸ºå ä½ç¬¦èµ‹å€¼ï¼Œç´¢å¼•ä»1å¼€å§‹ï¼Œæ‰§è¡ŒSQLè¯­å¥ï¼Œè·å–ç»“æœ</span>
        preparedStatement.setInt(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>);
        <span class="hljs-type">ResultSet</span> <span class="hljs-variable">resultSet</span> <span class="hljs-operator">=</span> preparedStatement.executeQuery();
	      <span class="hljs-comment">//é¢„å…ˆåˆ›å»ºå®ä½“ç±»å˜é‡</span>
        <span class="hljs-type">Employee</span> <span class="hljs-variable">employee</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
        <span class="hljs-comment">//5.å¤„ç†ç»“æœ</span>
        <span class="hljs-keyword">while</span> (resultSet.next()) {
            <span class="hljs-type">int</span> <span class="hljs-variable">empId</span> <span class="hljs-operator">=</span> resultSet.getInt(<span class="hljs-string">"emp_id"</span>);
            <span class="hljs-type">String</span> <span class="hljs-variable">empName</span> <span class="hljs-operator">=</span> resultSet.getString(<span class="hljs-string">"emp_name"</span>);
            <span class="hljs-type">Double</span> <span class="hljs-variable">empSalary</span> <span class="hljs-operator">=</span> Double.valueOf(resultSet.getString(<span class="hljs-string">"emp_salary"</span>));
            <span class="hljs-type">int</span> <span class="hljs-variable">empAge</span> <span class="hljs-operator">=</span> resultSet.getInt(<span class="hljs-string">"emp_age"</span>);
          	<span class="hljs-comment">//å½“ç»“æœé›†ä¸­æœ‰æ•°æ®ï¼Œå†è¿›è¡Œå¯¹è±¡çš„åˆ›å»º</span>
            employee = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Employee</span>(empId,empName,empSalary,empAge);
        }

        System.out.println(<span class="hljs-string">"employee = "</span> + employee);

        <span class="hljs-comment">//6.é‡Šæ”¾èµ„æº(å…ˆå¼€åå…³åŸåˆ™)</span>
        resultSet.close();
        preparedStatement.close();
        connection.close();

    }
</code></pre>
<h4 data-id="heading-26">7.2 ä¸»é”®å›æ˜¾</h4>
<ul>
<li>
<p>åœ¨æ•°æ®ä¸­ï¼Œæ‰§è¡Œæ–°å¢æ“ä½œæ—¶ï¼Œä¸»é”®åˆ—ä¸ºè‡ªåŠ¨å¢é•¿ï¼Œå¯ä»¥åœ¨è¡¨ä¸­ç›´è§‚çš„çœ‹åˆ°ï¼Œä½†æ˜¯åœ¨Javaç¨‹åºä¸­ï¼Œæˆ‘ä»¬æ‰§è¡Œå®Œæ–°å¢åï¼Œåªèƒ½å¾—åˆ°å—å½±å“è¡Œæ•°ï¼Œæ— æ³•å¾—çŸ¥å½“å‰æ–°å¢æ•°æ®çš„ä¸»é”®å€¼ã€‚åœ¨Javaç¨‹åºä¸­è·å–æ•°æ®åº“ä¸­æ’å…¥æ–°æ•°æ®åçš„ä¸»é”®å€¼ï¼Œå¹¶èµ‹å€¼ç»™Javaå¯¹è±¡ï¼Œæ­¤æ“ä½œä¸ºä¸»é”®å›æ˜¾ã€‚</p>
</li>
<li>
<p>ä»£ç å®ç°ï¼š</p>
<ul>
<li>
<pre><code class="hljs language-java" lang="java">		<span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testReturnPK</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">//1.æ³¨å†Œé©±åŠ¨</span>
<span class="hljs-comment">//        Class.forName("com.mysql.cj.jdbc.Driver");</span>

        <span class="hljs-comment">//2.è·å–æ•°æ®åº“è¿æ¥</span>
        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> DriverManager.getConnection(<span class="hljs-string">"jdbc:mysql://localhost:3306/atguigu"</span>, <span class="hljs-string">"root"</span>, <span class="hljs-string">"atguigu"</span>);

        <span class="hljs-comment">//3.åˆ›å»ºpreparedStatementå¯¹è±¡ï¼Œä¼ å…¥éœ€è¦ä¸»é”®å›æ˜¾å‚æ•°Statement.RETURN_GENERATED_KEYS</span>
        <span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">preparedStatement</span> <span class="hljs-operator">=</span> connection.prepareStatement(<span class="hljs-string">"insert into t_emp (emp_name, emp_salary, emp_age)values  (?, ?,?)"</span>,Statement.RETURN_GENERATED_KEYS);

        <span class="hljs-comment">//4.ç¼–å†™SQLè¯­å¥å¹¶æ‰§è¡Œï¼Œè·å–ç»“æœ</span>
        <span class="hljs-type">Employee</span> <span class="hljs-variable">employee</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Employee</span>(<span class="hljs-literal">null</span>,<span class="hljs-string">"rose"</span>,<span class="hljs-number">666.66</span>,<span class="hljs-number">28</span>);
        preparedStatement.setString(<span class="hljs-number">1</span>,employee.getEmpName());
        preparedStatement.setDouble(<span class="hljs-number">2</span>,employee.getEmpSalary());
        preparedStatement.setDouble(<span class="hljs-number">3</span>,employee.getEmpAge());
        <span class="hljs-type">int</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> preparedStatement.executeUpdate();

        <span class="hljs-comment">//5.å¤„ç†ç»“æœ</span>
        <span class="hljs-keyword">if</span>(result&gt;<span class="hljs-number">0</span>){
            System.out.println(<span class="hljs-string">"æ·»åŠ æˆåŠŸ"</span>);
        }<span class="hljs-keyword">else</span>{
            System.out.println(<span class="hljs-string">"æ·»åŠ å¤±è´¥"</span>);
        }

        <span class="hljs-comment">//6.è·å–ç”Ÿæˆçš„ä¸»é”®åˆ—å€¼ï¼Œè¿”å›çš„æ˜¯resultSetï¼Œåœ¨ç»“æœé›†ä¸­è·å–ä¸»é”®åˆ—å€¼</span>
        <span class="hljs-type">ResultSet</span> <span class="hljs-variable">resultSet</span> <span class="hljs-operator">=</span> preparedStatement.getGeneratedKeys();
        <span class="hljs-keyword">if</span> (resultSet.next()){
            <span class="hljs-type">int</span> <span class="hljs-variable">empId</span> <span class="hljs-operator">=</span> resultSet.getInt(<span class="hljs-number">1</span>);
            employee.setEmpId(empId);
        }
		
       	System.out.println(employee.toString());
       
        <span class="hljs-comment">//7.é‡Šæ”¾èµ„æº(å…ˆå¼€åå…³åŸåˆ™)</span>
        resultSet.close();
        preparedStatement.close();
        connection.close();

    }
</code></pre>
</li>
</ul>
</li>
</ul>
<h4 data-id="heading-27">7.3 æ‰¹é‡æ“ä½œ</h4>
<ul>
<li>
<p>æ’å…¥å¤šæ¡æ•°æ®æ—¶ï¼Œä¸€æ¡ä¸€æ¡å‘é€ç»™æ•°æ®åº“æ‰§è¡Œï¼Œæ•ˆç‡ä½ä¸‹ï¼</p>
</li>
<li>
<p>é€šè¿‡æ‰¹é‡æ“ä½œï¼Œå¯ä»¥æå‡å¤šæ¬¡æ“ä½œæ•ˆç‡ï¼</p>
</li>
<li>
<p>ä»£ç å®ç°ï¼š</p>
<ul>
<li>
<pre><code class="hljs language-java" lang="java">		<span class="hljs-meta">@Test</span>
     <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testBatch</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
         <span class="hljs-comment">//1.æ³¨å†Œé©±åŠ¨</span>
<span class="hljs-comment">//        Class.forName("com.mysql.cj.jdbc.Driver");</span>

        <span class="hljs-comment">//2.è·å–è¿æ¥</span>
        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> DriverManager.getConnection(<span class="hljs-string">"jdbc:mysql:///atguigu?rewriteBatchedStatements=true"</span>, <span class="hljs-string">"root"</span>, <span class="hljs-string">"atguigu"</span>);

        <span class="hljs-comment">//3.ç¼–å†™SQLè¯­å¥</span>
        <span class="hljs-comment">/*
            æ³¨æ„ï¼š1ã€å¿…é¡»åœ¨è¿æ¥æ•°æ®åº“çš„URLåé¢è¿½åŠ ?rewriteBatchedStatements=trueï¼Œå…è®¸æ‰¹é‡æ“ä½œ
                2ã€æ–°å¢SQLå¿…é¡»ç”¨valuesã€‚ä¸”è¯­å¥æœ€åä¸è¦è¿½åŠ ;ç»“æŸ
                3ã€è°ƒç”¨addBatch()æ–¹æ³•ï¼Œå°†SQLè¯­å¥è¿›è¡Œæ‰¹é‡æ·»åŠ æ“ä½œ
                4ã€ç»Ÿä¸€æ‰§è¡Œæ‰¹é‡æ“ä½œï¼Œè°ƒç”¨executeBatch()
         */</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"insert into t_emp (emp_name,emp_salary,emp_age) values (?,?,?)"</span>;

        <span class="hljs-comment">//4.åˆ›å»ºé¢„ç¼–è¯‘çš„PreparedStatementï¼Œä¼ å…¥SQLè¯­å¥</span>
        <span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">preparedStatement</span> <span class="hljs-operator">=</span> connection.prepareStatement(sql);

        <span class="hljs-comment">//è·å–å½“å‰è¡Œä»£ç æ‰§è¡Œçš„æ—¶é—´ã€‚æ¯«ç§’å€¼</span>
        <span class="hljs-type">long</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;i&lt;<span class="hljs-number">10000</span>;i++){
            <span class="hljs-comment">//5.ä¸ºå ä½ç¬¦èµ‹å€¼</span>
            preparedStatement.setString(<span class="hljs-number">1</span>, <span class="hljs-string">"marry"</span>+i);
            preparedStatement.setDouble(<span class="hljs-number">2</span>, <span class="hljs-number">100.0</span>+i);
            preparedStatement.setInt(<span class="hljs-number">3</span>, <span class="hljs-number">20</span>+i);

            preparedStatement.addBatch();
        }

        <span class="hljs-comment">//æ‰§è¡Œæ‰¹é‡æ“ä½œ</span>
        preparedStatement.executeBatch();

        <span class="hljs-type">long</span> <span class="hljs-variable">end</span> <span class="hljs-operator">=</span> System.currentTimeMillis();

        System.out.println(<span class="hljs-string">"æ¶ˆè€—æ—¶é—´ï¼š"</span>+(end - start));

        preparedStatement.close();
        connection.close();
    }
</code></pre>
</li>
</ul>
</li>
</ul>
<h3 data-id="heading-28">å…«ã€è¿æ¥æ± </h3>
<h4 data-id="heading-29">8.1 ç°æœ‰é—®é¢˜</h4>
<blockquote>
<ul>
<li>æ¯æ¬¡æ“ä½œæ•°æ®åº“éƒ½è¦è·å–æ–°è¿æ¥ï¼Œä½¿ç”¨å®Œæ¯•åå°±closeé‡Šæ”¾ï¼Œé¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯é€ æˆèµ„æºæµªè´¹ã€‚</li>
<li>è¿æ¥çš„æ•°é‡æ— æ³•æŠŠæ§ï¼Œå¯¹æœåŠ¡å™¨æ¥è¯´å‹åŠ›å·¨å¤§ã€‚</li>
</ul>
</blockquote>
<h4 data-id="heading-30">8.2 è¿æ¥æ± </h4>
<blockquote>
<p>è¿æ¥æ± å°±æ˜¯æ•°æ®åº“è¿æ¥å¯¹è±¡çš„ç¼“å†²åŒºï¼Œé€šè¿‡é…ç½®ï¼Œç”±è¿æ¥æ± è´Ÿè´£åˆ›å»ºè¿æ¥ã€ç®¡ç†è¿æ¥ã€é‡Šæ”¾è¿æ¥ç­‰æ“ä½œã€‚</p>
<p>é¢„å…ˆåˆ›å»ºæ•°æ®åº“è¿æ¥æ”¾å…¥è¿æ¥æ± ï¼Œç”¨æˆ·åœ¨è¯·æ±‚æ—¶ï¼Œé€šè¿‡æ± ç›´æ¥è·å–è¿æ¥ï¼Œä½¿ç”¨å®Œæ¯•åï¼Œå°†è¿æ¥æ”¾å›æ± ä¸­ï¼Œé¿å…äº†é¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯ï¼ŒåŒæ—¶è§£å†³äº†åˆ›å»ºçš„æ•ˆç‡ã€‚</p>
<p>å½“æ± ä¸­æ— è¿æ¥å¯ç”¨ï¼Œä¸”æœªè¾¾åˆ°ä¸Šé™æ—¶ï¼Œè¿æ¥æ± ä¼šæ–°å»ºè¿æ¥ã€‚</p>
<p>æ± ä¸­è¿æ¥è¾¾åˆ°ä¸Šé™ï¼Œç”¨æˆ·è¯·æ±‚ä¼šç­‰å¾…ï¼Œå¯ä»¥è®¾ç½®è¶…æ—¶æ—¶é—´ã€‚</p>
</blockquote>
<h4 data-id="heading-31">8.3 å¸¸è§è¿æ¥æ± </h4>
<p>JDBC çš„æ•°æ®åº“è¿æ¥æ± ä½¿ç”¨ javax.sql.DataSourceæ¥å£è¿›è¡Œè§„èŒƒï¼Œæ‰€æœ‰çš„ç¬¬ä¸‰æ–¹è¿æ¥æ± éƒ½å®ç°æ­¤æ¥å£ï¼Œè‡ªè¡Œæ·»åŠ å…·ä½“å®ç°ï¼ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰è¿æ¥æ± è·å–è¿æ¥çš„å’Œå›æ”¶è¿æ¥æ–¹æ³•éƒ½ä¸€æ ·ï¼Œä¸åŒçš„åªæœ‰æ€§èƒ½å’Œæ‰©å±•åŠŸèƒ½!</p>
<ul>
<li>DBCP æ˜¯Apacheæä¾›çš„æ•°æ®åº“è¿æ¥æ± ï¼Œé€Ÿåº¦ç›¸å¯¹C3P0è¾ƒå¿«ï¼Œä½†è‡ªèº«å­˜åœ¨ä¸€äº›BUGã€‚</li>
<li>C3P0 æ˜¯ä¸€ä¸ªå¼€æºç»„ç»‡æä¾›çš„ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œé€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢ï¼Œç¨³å®šæ€§è¿˜å¯ä»¥ã€‚</li>
<li>Proxool æ˜¯sourceforgeä¸‹çš„ä¸€ä¸ªå¼€æºé¡¹ç›®æ•°æ®åº“è¿æ¥æ± ï¼Œæœ‰ç›‘æ§è¿æ¥æ± çŠ¶æ€çš„åŠŸèƒ½ï¼Œ ç¨³å®šæ€§è¾ƒc3p0å·®ä¸€ç‚¹</li>
<li><strong>Druid æ˜¯é˜¿é‡Œæä¾›çš„æ•°æ®åº“è¿æ¥æ± ï¼Œæ˜¯é›†DBCP ã€C3P0 ã€Proxool ä¼˜ç‚¹äºä¸€èº«çš„æ•°æ®åº“è¿æ¥æ± ï¼Œæ€§èƒ½ã€æ‰©å±•æ€§ã€æ˜“ç”¨æ€§éƒ½æ›´å¥½ï¼ŒåŠŸèƒ½ä¸°å¯Œ</strong>ã€‚</li>
<li><strong>Hikariï¼ˆã²ã‹ã‚Š[shi ga li]ï¼‰ å–è‡ªæ—¥è¯­ï¼Œæ˜¯å…‰çš„æ„æ€ï¼Œæ˜¯SpringBoot2.xä¹‹åå†…ç½®çš„ä¸€æ¬¾è¿æ¥æ± ï¼ŒåŸºäº BoneCP ï¼ˆå·²ç»æ”¾å¼ƒç»´æŠ¤ï¼Œæ¨èè¯¥è¿æ¥æ± ï¼‰åšäº†ä¸å°‘çš„æ”¹è¿›å’Œä¼˜åŒ–ï¼Œå£å·æ˜¯å¿«é€Ÿã€ç®€å•ã€å¯é ã€‚</strong></li>
</ul>











<table><thead><tr><th align="center">ä¸»æµè¿æ¥æ± çš„åŠŸèƒ½å¯¹æ¯”</th></tr></thead><tbody><tr><td align="center"><img src="%E8%BD%AC%E5%AD%98%E5%A4%B1%E8%B4%A5%EF%BC%8C%E5%BB%BA%E8%AE%AE%E7%9B%B4%E6%8E%A5%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E6%96%87%E4%BB%B6%20JDBC.assets%5Cimage-20240228090209040.png" alt="image-20240228090209040è½¬å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" loading="lazy"/></td></tr></tbody></table>











<table><thead><tr><th align="center">mockæ€§èƒ½æ•°æ®ï¼ˆå•ä½ï¼šmsï¼‰</th></tr></thead><tbody><tr><td align="center"><img src="%E8%BD%AC%E5%AD%98%E5%A4%B1%E8%B4%A5%EF%BC%8C%E5%BB%BA%E8%AE%AE%E7%9B%B4%E6%8E%A5%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E6%96%87%E4%BB%B6%20JDBC.assets%5Cimage-20240228205157212.png" alt="image-20240228205157212è½¬å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" loading="lazy"/></td></tr></tbody></table>











<table><thead><tr><th align="center">mysqlæ€§èƒ½æ•°æ® (å•ä½ï¼šms)</th></tr></thead><tbody><tr><td align="center"><img src="%E8%BD%AC%E5%AD%98%E5%A4%B1%E8%B4%A5%EF%BC%8C%E5%BB%BA%E8%AE%AE%E7%9B%B4%E6%8E%A5%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E6%96%87%E4%BB%B6%20JDBC.assets%5Cimage-20240228205242420.png" alt="image-20240228205242420è½¬å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" loading="lazy"/></td></tr></tbody></table>
<h4 data-id="heading-32">8.4 Druidè¿æ¥æ± ä½¿ç”¨</h4>
<ul>
<li>
<p>ä½¿ç”¨æ­¥éª¤ï¼š</p>
<ul>
<li>å¼•å…¥jaråŒ…ã€‚</li>
<li>ç¼–ç ã€‚</li>
</ul>
</li>
<li>
<p>ä»£ç å®ç°ï¼š</p>
<ul>
<li>
<p>ç¡¬ç¼–ç æ–¹å¼ï¼ˆäº†è§£ï¼‰ï¼š</p>
<ul>
<li>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testHardCodeDruid</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-comment">/*
            ç¡¬ç¼–ç ï¼šå°†è¿æ¥æ± çš„é…ç½®ä¿¡æ¯å’ŒJavaä»£ç è€¦åˆåœ¨ä¸€èµ·ã€‚
            1ã€åˆ›å»ºDruidDataSourceè¿æ¥æ± å¯¹è±¡ã€‚
            2ã€è®¾ç½®è¿æ¥æ± çš„é…ç½®ä¿¡æ¯ã€å¿…é¡» | éå¿…é¡»ã€‘
            3ã€é€šè¿‡è¿æ¥æ± è·å–è¿æ¥å¯¹è±¡
            4ã€å›æ”¶è¿æ¥ã€ä¸æ˜¯é‡Šæ”¾è¿æ¥ï¼Œè€Œæ˜¯å°†è¿æ¥å½’è¿˜ç»™è¿æ¥æ± ï¼Œç»™å…¶ä»–çº¿ç¨‹è¿›è¡Œå¤ç”¨ã€‘
         */</span>

        <span class="hljs-comment">//1.åˆ›å»ºDruidDataSourceè¿æ¥æ± å¯¹è±¡ã€‚</span>
        <span class="hljs-type">DruidDataSource</span> <span class="hljs-variable">druidDataSource</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DruidDataSource</span>();

        <span class="hljs-comment">//2.è®¾ç½®è¿æ¥æ± çš„é…ç½®ä¿¡æ¯ã€å¿…é¡» | éå¿…é¡»ã€‘</span>
        <span class="hljs-comment">//2.1 å¿…é¡»è®¾ç½®çš„é…ç½®</span>
        druidDataSource.setDriverClassName(<span class="hljs-string">"com.mysql.cj.jdbc.Driver"</span>);
        druidDataSource.setUrl(<span class="hljs-string">"jdbc:mysql:///atguigu"</span>);
        druidDataSource.setUsername(<span class="hljs-string">"root"</span>);
        druidDataSource.setPassword(<span class="hljs-string">"atguigu"</span>);

        <span class="hljs-comment">//2.2 éå¿…é¡»è®¾ç½®çš„é…ç½®</span>
        druidDataSource.setInitialSize(<span class="hljs-number">10</span>);
        druidDataSource.setMaxActive(<span class="hljs-number">20</span>);
        
        <span class="hljs-comment">//3.é€šè¿‡è¿æ¥æ± è·å–è¿æ¥å¯¹è±¡</span>
        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> druidDataSource.getConnection();
        System.out.println(connection);

        <span class="hljs-comment">//åŸºäºconnectionè¿›è¡ŒCRUD</span>

        <span class="hljs-comment">//4.å›æ”¶è¿æ¥</span>
        connection.close();
    }
</code></pre>
</li>
</ul>
</li>
<li>
<p>è½¯ç¼–ç æ–¹å¼ï¼ˆæ¨èï¼‰ï¼š</p>
<ul>
<li>
<p>åœ¨é¡¹ç›®ç›®å½•ä¸‹åˆ›å»ºresourcesæ–‡ä»¶å¤¹ï¼Œæ ‡è¯†è¯¥æ–‡ä»¶å¤¹ä¸ºèµ„æºç›®å½•ï¼Œåˆ›å»ºdb.propertiesé…ç½®æ–‡ä»¶ï¼Œå°†è¿æ¥ä¿¡æ¯å®šä¹‰åœ¨è¯¥æ–‡ä»¶ä¸­ã€‚</p>
<ul>
<li>
<pre><code class="hljs language-properties" lang="properties"># druidè¿æ¥æ± éœ€è¦çš„é…ç½®å‚æ•°ï¼Œkeyå›ºå®šå‘½å
driverClassName=com.mysql.cj.jdbc.Driver
url=jdbc:mysql:///atguigu
username=root
password=atguigu
initialSize=10
maxActive=20
</code></pre>
</li>
</ul>
</li>
<li>
<p>Javaä»£ç ï¼š</p>
<ul>
<li>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testResourcesDruid</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">//1.åˆ›å»ºPropertiesé›†åˆï¼Œç”¨äºå­˜å‚¨å¤–éƒ¨é…ç½®æ–‡ä»¶çš„keyå’Œvalueå€¼ã€‚</span>
        <span class="hljs-type">Properties</span> <span class="hljs-variable">properties</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();

        <span class="hljs-comment">//2.è¯»å–å¤–éƒ¨é…ç½®æ–‡ä»¶ï¼Œè·å–è¾“å…¥æµï¼ŒåŠ è½½åˆ°Propertiesé›†åˆé‡Œã€‚</span>
        <span class="hljs-type">InputStream</span> <span class="hljs-variable">inputStream</span> <span class="hljs-operator">=</span> DruidTest.class.getClassLoader().getResourceAsStream(<span class="hljs-string">"db.properties"</span>);
        properties.load(inputStream);

        <span class="hljs-comment">//3.åŸºäºPropertiesé›†åˆæ„å»ºDruidDataSourceè¿æ¥æ± </span>
        <span class="hljs-type">DataSource</span> <span class="hljs-variable">dataSource</span> <span class="hljs-operator">=</span> DruidDataSourceFactory.createDataSource(properties);

        <span class="hljs-comment">//4.é€šè¿‡è¿æ¥æ± è·å–è¿æ¥å¯¹è±¡</span>
        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> dataSource.getConnection();
        System.out.println(connection);

        <span class="hljs-comment">//5.å¼€å‘CRUD</span>

        <span class="hljs-comment">//6.å›æ”¶è¿æ¥</span>
        connection.close();
    }
</code></pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 data-id="heading-33">8.5 Druidå…¶ä»–é…ç½®ã€äº†è§£ã€‘</h4>





























































































































<table><thead><tr><th>é…ç½®</th><th><strong>ç¼ºçœ</strong></th><th><strong>è¯´æ˜</strong></th></tr></thead><tbody><tr><td>name</td><td/><td>é…ç½®è¿™ä¸ªå±æ€§çš„æ„ä¹‰åœ¨äºï¼Œå¦‚æœå­˜åœ¨å¤šä¸ªæ•°æ®æºï¼Œç›‘æ§çš„æ—¶å€™å¯ä»¥é€šè¿‡åå­—æ¥åŒºåˆ†å¼€æ¥ã€‚ å¦‚æœæ²¡æœ‰é…ç½®ï¼Œå°†ä¼šç”Ÿæˆä¸€ä¸ªåå­—ï¼Œæ ¼å¼æ˜¯ï¼šâ€DataSource-â€ + System.identityHashCode(this)</td></tr><tr><td>jdbcUrl</td><td/><td>è¿æ¥æ•°æ®åº“çš„urlï¼Œä¸åŒæ•°æ®åº“ä¸ä¸€æ ·ã€‚ä¾‹å¦‚ï¼šmysql : jdbc:mysql://10.20.153.104:3306/druid2 oracle : jdbc:oracle:thin:@10.20.149.85:1521:ocnauto</td></tr><tr><td>username</td><td/><td>è¿æ¥æ•°æ®åº“çš„ç”¨æˆ·å</td></tr><tr><td>password</td><td/><td>è¿æ¥æ•°æ®åº“çš„å¯†ç ã€‚å¦‚æœä½ ä¸å¸Œæœ›å¯†ç ç›´æ¥å†™åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ConfigFilterã€‚è¯¦ç»†çœ‹è¿™é‡Œï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Falibaba%2Fdruid%2Fwiki%2F%25E4%25BD%25BF%25E7%2594%25A8ConfigFilter" target="_blank" title="https://github.com/alibaba/druid/wiki/%E4%BD%BF%E7%94%A8ConfigFilter" ref="nofollow noopener noreferrer">github.com/alibaba/druâ€¦</a></td></tr><tr><td>driverClassName</td><td/><td>æ ¹æ®urlè‡ªåŠ¨è¯†åˆ« è¿™ä¸€é¡¹å¯é…å¯ä¸é…ï¼Œå¦‚æœä¸é…ç½®druidä¼šæ ¹æ®urlè‡ªåŠ¨è¯†åˆ«dbTypeï¼Œç„¶åé€‰æ‹©ç›¸åº”çš„driverClassName(å»ºè®®é…ç½®ä¸‹)</td></tr><tr><td>initialSize</td><td>0</td><td>åˆå§‹åŒ–æ—¶å»ºç«‹ç‰©ç†è¿æ¥çš„ä¸ªæ•°ã€‚åˆå§‹åŒ–å‘ç”Ÿåœ¨æ˜¾ç¤ºè°ƒç”¨initæ–¹æ³•ï¼Œæˆ–è€…ç¬¬ä¸€æ¬¡getConnectionæ—¶</td></tr><tr><td>maxActive</td><td>8</td><td>æœ€å¤§è¿æ¥æ± æ•°é‡</td></tr><tr><td>maxIdle</td><td>8</td><td>å·²ç»ä¸å†ä½¿ç”¨ï¼Œé…ç½®äº†ä¹Ÿæ²¡æ•ˆæœ</td></tr><tr><td>minIdle</td><td/><td>æœ€å°è¿æ¥æ± æ•°é‡</td></tr><tr><td>maxWait</td><td/><td>è·å–è¿æ¥æ—¶æœ€å¤§ç­‰å¾…æ—¶é—´ï¼Œå•ä½æ¯«ç§’ã€‚é…ç½®äº†maxWaitä¹‹åï¼Œç¼ºçœå¯ç”¨å…¬å¹³é”ï¼Œå¹¶å‘æ•ˆç‡ä¼šæœ‰æ‰€ä¸‹é™ï¼Œå¦‚æœéœ€è¦å¯ä»¥é€šè¿‡é…ç½®useUnfairLockå±æ€§ä¸ºtrueä½¿ç”¨éå…¬å¹³é”ã€‚</td></tr><tr><td>poolPreparedStatements</td><td>false</td><td>æ˜¯å¦ç¼“å­˜preparedStatementï¼Œä¹Ÿå°±æ˜¯PSCacheã€‚PSCacheå¯¹æ”¯æŒæ¸¸æ ‡çš„æ•°æ®åº“æ€§èƒ½æå‡å·¨å¤§ï¼Œæ¯”å¦‚è¯´oracleã€‚åœ¨mysqlä¸‹å»ºè®®å…³é—­ã€‚</td></tr><tr><td>maxOpenPreparedStatements</td><td>-1</td><td>è¦å¯ç”¨PSCacheï¼Œå¿…é¡»é…ç½®å¤§äº0ï¼Œå½“å¤§äº0æ—¶ï¼ŒpoolPreparedStatementsè‡ªåŠ¨è§¦å‘ä¿®æ”¹ä¸ºtrueã€‚åœ¨Druidä¸­ï¼Œä¸ä¼šå­˜åœ¨Oracleä¸‹PSCacheå ç”¨å†…å­˜è¿‡å¤šçš„é—®é¢˜ï¼Œå¯ä»¥æŠŠè¿™ä¸ªæ•°å€¼é…ç½®å¤§ä¸€äº›ï¼Œæ¯”å¦‚è¯´100</td></tr><tr><td>validationQuery</td><td/><td>ç”¨æ¥æ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆçš„sqlï¼Œè¦æ±‚æ˜¯ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ã€‚å¦‚æœvalidationQueryä¸ºnullï¼ŒtestOnBorrowã€testOnReturnã€testWhileIdleéƒ½ä¸ä¼šå…¶ä½œç”¨ã€‚</td></tr><tr><td>testOnBorrow</td><td>true</td><td>ç”³è¯·è¿æ¥æ—¶æ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼Œåšäº†è¿™ä¸ªé…ç½®ä¼šé™ä½æ€§èƒ½ã€‚</td></tr><tr><td>testOnReturn</td><td>false</td><td>å½’è¿˜è¿æ¥æ—¶æ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼Œåšäº†è¿™ä¸ªé…ç½®ä¼šé™ä½æ€§èƒ½</td></tr><tr><td>testWhileIdle</td><td>false</td><td>å»ºè®®é…ç½®ä¸ºtrueï¼Œä¸å½±å“æ€§èƒ½ï¼Œå¹¶ä¸”ä¿è¯å®‰å…¨æ€§ã€‚ç”³è¯·è¿æ¥çš„æ—¶å€™æ£€æµ‹ï¼Œå¦‚æœç©ºé—²æ—¶é—´å¤§äºtimeBetweenEvictionRunsMillisï¼Œæ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆã€‚</td></tr><tr><td>timeBetweenEvictionRunsMillis</td><td/><td>æœ‰ä¸¤ä¸ªå«ä¹‰ï¼š 1)Destroyçº¿ç¨‹ä¼šæ£€æµ‹è¿æ¥çš„é—´éš”æ—¶é—´2)testWhileIdleçš„åˆ¤æ–­ä¾æ®ï¼Œè¯¦ç»†çœ‹testWhileIdleå±æ€§çš„è¯´æ˜</td></tr><tr><td>numTestsPerEvictionRun</td><td/><td>ä¸å†ä½¿ç”¨ï¼Œä¸€ä¸ªDruidDataSourceåªæ”¯æŒä¸€ä¸ªEvictionRun</td></tr><tr><td>minEvictableIdleTimeMillis</td><td/><td/></tr><tr><td>connectionInitSqls</td><td/><td>ç‰©ç†è¿æ¥åˆå§‹åŒ–çš„æ—¶å€™æ‰§è¡Œçš„sql</td></tr><tr><td>exceptionSorter</td><td/><td>æ ¹æ®dbTypeè‡ªåŠ¨è¯†åˆ« å½“æ•°æ®åº“æŠ›å‡ºä¸€äº›ä¸å¯æ¢å¤çš„å¼‚å¸¸æ—¶ï¼ŒæŠ›å¼ƒè¿æ¥</td></tr><tr><td>filters</td><td/><td>å±æ€§ç±»å‹æ˜¯å­—ç¬¦ä¸²ï¼Œé€šè¿‡åˆ«åçš„æ–¹å¼é…ç½®æ‰©å±•æ’ä»¶ï¼Œå¸¸ç”¨çš„æ’ä»¶æœ‰ï¼š ç›‘æ§ç»Ÿè®¡ç”¨çš„filter:statæ—¥å¿—ç”¨çš„filter:log4jé˜²å¾¡sqlæ³¨å…¥çš„filter:wall</td></tr><tr><td>proxyFilters</td><td/><td>ç±»å‹æ˜¯Listï¼Œå¦‚æœåŒæ—¶é…ç½®äº†filterså’ŒproxyFiltersï¼Œæ˜¯ç»„åˆå…³ç³»ï¼Œå¹¶éæ›¿æ¢å…³ç³»</td></tr></tbody></table>
<h4 data-id="heading-34">8.6 HikariCPè¿æ¥æ± ä½¿ç”¨</h4>
<ul>
<li>
<p>ä½¿ç”¨æ­¥éª¤ï¼š</p>
<ul>
<li>
<p>å¼•å…¥jaråŒ…</p>
</li>
<li>
<p>ç¡¬ç¼–ç æ–¹å¼ï¼š</p>
<ul>
<li>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Test</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testHardCodeHikari</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
    <span class="hljs-comment">/*
     ç¡¬ç¼–ç ï¼šå°†è¿æ¥æ± çš„é…ç½®ä¿¡æ¯å’ŒJavaä»£ç è€¦åˆåœ¨ä¸€èµ·ã€‚
     1ã€åˆ›å»ºHikariDataSourceè¿æ¥æ± å¯¹è±¡
     2ã€è®¾ç½®è¿æ¥æ± çš„é…ç½®ä¿¡æ¯ã€å¿…é¡» ï½œ éå¿…é¡»ã€‘
     3ã€é€šè¿‡è¿æ¥æ± è·å–è¿æ¥å¯¹è±¡
     4ã€å›æ”¶è¿æ¥
     */</span>
    <span class="hljs-comment">//1.åˆ›å»ºHikariDataSourceè¿æ¥æ± å¯¹è±¡</span>
    <span class="hljs-type">HikariDataSource</span> <span class="hljs-variable">hikariDataSource</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HikariDataSource</span>();

    <span class="hljs-comment">//2.è®¾ç½®è¿æ¥æ± çš„é…ç½®ä¿¡æ¯ã€å¿…é¡» ï½œ éå¿…é¡»ã€‘</span>
    <span class="hljs-comment">//2.1å¿…é¡»è®¾ç½®çš„é…ç½®</span>
    hikariDataSource.setDriverClassName(<span class="hljs-string">"com.mysql.cj.jdbc.Driver"</span>);
    hikariDataSource.setJdbcUrl(<span class="hljs-string">"jdbc:mysql:///atguigu"</span>);
    hikariDataSource.setUsername(<span class="hljs-string">"root"</span>);
    hikariDataSource.setPassword(<span class="hljs-string">"atguigu"</span>);

    <span class="hljs-comment">//2.2 éå¿…é¡»è®¾ç½®çš„é…ç½®</span>
    hikariDataSource.setMinimumIdle(<span class="hljs-number">10</span>);
    hikariDataSource.setMaximumPoolSize(<span class="hljs-number">20</span>);

    <span class="hljs-comment">//3.é€šè¿‡è¿æ¥æ± è·å–è¿æ¥å¯¹è±¡</span>
    <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> hikariDataSource.getConnection();

    System.out.println(connection);

    <span class="hljs-comment">//å›æ”¶è¿æ¥</span>
    connection.close();
}
</code></pre>
</li>
</ul>
</li>
<li>
<p>è½¯ç¼–ç æ–¹å¼ï¼š</p>
<ul>
<li>
<p>åœ¨é¡¹ç›®ä¸‹åˆ›å»ºresources/hikari.propertiesé…ç½®æ–‡ä»¶</p>
<ul>
<li>
<pre><code class="hljs language-properties" lang="properties">driverClassName=com.mysql.cj.jdbc.Driver
jdbcUrl=jdbc:mysql:///atguigu
username=root
password=atguigu
minimumIdle=10
maximumPoolSize=20
</code></pre>
</li>
</ul>
</li>
<li>
<p>ç¼–å†™ä»£ç ï¼š</p>
<ul>
<li>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-meta">@Test</span>
	<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testResourcesHikari</span><span class="hljs-params">()</span><span class="hljs-keyword">throws</span> Exception{
         <span class="hljs-comment">//1.åˆ›å»ºPropertiesé›†åˆï¼Œç”¨äºå­˜å‚¨å¤–éƒ¨é…ç½®æ–‡ä»¶çš„keyå’Œvalueå€¼ã€‚</span>
        <span class="hljs-type">Properties</span> <span class="hljs-variable">properties</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();
        
        <span class="hljs-comment">//2.è¯»å–å¤–éƒ¨é…ç½®æ–‡ä»¶ï¼Œè·å–è¾“å…¥æµï¼ŒåŠ è½½åˆ°Propertiesé›†åˆé‡Œã€‚</span>
        <span class="hljs-type">InputStream</span> <span class="hljs-variable">inputStream</span> <span class="hljs-operator">=</span> HikariTest.class.getClassLoader().getResourceAsStream(<span class="hljs-string">"db.properties"</span>);
        properties.load(inputStream);
        
        <span class="hljs-comment">// 3.åˆ›å»ºHikariè¿æ¥æ± é…ç½®å¯¹è±¡ï¼Œå°†Propertiesé›†åˆä¼ è¿›å»</span>
        <span class="hljs-type">HikariConfig</span> <span class="hljs-variable">hikariConfig</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HikariConfig</span>(properties);
        
        <span class="hljs-comment">// 4. åŸºäºHikarié…ç½®å¯¹è±¡ï¼Œæ„å»ºè¿æ¥æ± </span>
        <span class="hljs-type">HikariDataSource</span> <span class="hljs-variable">hikariDataSource</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HikariDataSource</span>(hikariConfig);

        <span class="hljs-comment">// 5. è·å–è¿æ¥</span>
        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> hikariDataSource.getConnection();
        System.out.println(<span class="hljs-string">"connection = "</span> + connection);
        
        <span class="hljs-comment">//6.å›æ”¶è¿æ¥</span>
        connection.close();
    }
}
</code></pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 data-id="heading-35">8.7 HikariCPå…¶ä»–é…ç½®ã€äº†è§£ã€‘</h4>























































<table><thead><tr><th>å±æ€§</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>isAutoCommit</td><td>true</td><td>è‡ªåŠ¨æäº¤ä»æ± ä¸­è¿”å›çš„è¿æ¥</td></tr><tr><td>connectionTimeout</td><td>30000</td><td>ç­‰å¾…æ¥è‡ªæ± çš„è¿æ¥çš„æœ€å¤§æ¯«ç§’æ•°</td></tr><tr><td>maxLifetime</td><td>1800000</td><td>æ± ä¸­è¿æ¥æœ€é•¿ç”Ÿå‘½å‘¨æœŸå¦‚æœä¸ç­‰äº0ä¸”å°äº30ç§’åˆ™ä¼šè¢«é‡ç½®å›30åˆ†é’Ÿ</td></tr><tr><td>minimumIdle</td><td>10</td><td>æ± ä¸­ç»´æŠ¤çš„æœ€å°ç©ºé—²è¿æ¥æ•° minIdle&lt;0æˆ–è€…minIdle&gt;maxPoolSizeï¼Œåˆ™è¢«é‡ç½®ä¸ºmaxPoolSize</td></tr><tr><td>maximumPoolSize</td><td>10</td><td>æ± ä¸­æœ€å¤§è¿æ¥æ•°ï¼ŒåŒ…æ‹¬é—²ç½®å’Œä½¿ç”¨ä¸­çš„è¿æ¥</td></tr><tr><td>metricRegistry</td><td>null</td><td>è¿æ¥æ± çš„ç”¨æˆ·å®šä¹‰åç§°ï¼Œä¸»è¦å‡ºç°åœ¨æ—¥å¿—è®°å½•å’ŒJMXç®¡ç†æ§åˆ¶å°ä¸­ä»¥è¯†åˆ«æ± å’Œæ± é…ç½®</td></tr><tr><td>healthCheckRegistry</td><td>null</td><td>æŠ¥å‘Šå½“å‰å¥åº·ä¿¡æ¯</td></tr><tr><td>poolName</td><td>HikariPool-1</td><td>è¿æ¥æ± çš„ç”¨æˆ·å®šä¹‰åç§°ï¼Œä¸»è¦å‡ºç°åœ¨æ—¥å¿—è®°å½•å’ŒJMXç®¡ç†æ§åˆ¶å°ä¸­ä»¥è¯†åˆ«æ± å’Œæ± é…ç½®</td></tr><tr><td>idleTimeout</td><td/><td>æ˜¯å…è®¸è¿æ¥åœ¨è¿æ¥æ± ä¸­ç©ºé—²çš„æœ€é•¿æ—¶é—´</td></tr></tbody></table>
<h2 data-id="heading-36">é«˜çº§ç¯‡</h2>
<h3 data-id="heading-37">ä¹ã€JDBCä¼˜åŒ–åŠå·¥å…·ç±»å°è£…</h3>
<h4 data-id="heading-38">9.1 ç°æœ‰é—®é¢˜</h4>
<blockquote>
<p>æˆ‘ä»¬åœ¨ä½¿ç”¨JDBCçš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°éƒ¨åˆ†ä»£ç å­˜åœ¨å†—ä½™çš„é—®é¢˜ï¼š</p>
<ul>
<li>åˆ›å»ºè¿æ¥æ± ã€‚</li>
<li>è·å–è¿æ¥ã€‚</li>
<li>è¿æ¥çš„å›æ”¶ã€‚</li>
</ul>
</blockquote>
<h4 data-id="heading-39">9.2 JDBCå·¥å…·ç±»å°è£…V1.0</h4>
<ul>
<li>
<p>resources/db.propertiesé…ç½®æ–‡ä»¶ï¼š</p>
<ul>
<li>
<pre><code class="hljs language-properties" lang="properties"># druidè¿æ¥æ± éœ€è¦çš„é…ç½®å‚æ•°ï¼Œkeyå›ºå®šå‘½å
driverClassName=com.mysql.cj.jdbc.Driver
username=root
password=atguigu
url=jdbc:mysql:///atguigu
</code></pre>
</li>
</ul>
</li>
<li>
<p>å·¥å…·ç±»ä»£ç ï¼š</p>
<ul>
<li>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.alibaba.druid.pool.DruidDataSourceFactory;

<span class="hljs-keyword">import</span> javax.sql.DataSource;
<span class="hljs-keyword">import</span> java.sql.Connection;
<span class="hljs-keyword">import</span> java.sql.SQLException;
<span class="hljs-keyword">import</span> java.util.Properties;
<span class="hljs-comment">/**
*	JDBCå·¥å…·ç±»ï¼ˆV1.0ï¼‰ï¼š
*		1ã€ç»´æŠ¤ä¸€ä¸ªè¿æ¥æ± å¯¹è±¡ã€‚
*		2ã€å¯¹å¤–æä¾›åœ¨è¿æ¥æ± ä¸­è·å–è¿æ¥çš„æ–¹æ³•
*		3ã€å¯¹å¤–æä¾›å›æ”¶è¿æ¥çš„æ–¹æ³•
*	æ³¨æ„ï¼šå·¥å…·ç±»ä»…å¯¹å¤–æä¾›å…±æ€§çš„åŠŸèƒ½ä»£ç ï¼Œæ‰€ä»¥æ–¹æ³•å‡ä¸ºé™æ€æ–¹æ³•ï¼
*/</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JDBCTools</span> {
    <span class="hljs-comment">//åˆ›å»ºè¿æ¥æ± å¼•ç”¨ï¼Œå› ä¸ºè¦æä¾›ç»™å½“å‰é¡¹ç›®å…¨å±€ä½¿ç”¨ï¼Œæ‰€ä»¥åˆ›å»ºä¸ºé™æ€çš„ã€‚</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> DataSource dataSource;
    <span class="hljs-comment">//åœ¨é¡¹ç›®å¯åŠ¨æ—¶ï¼Œå³åˆ›å»ºè¿æ¥æ± å¯¹è±¡ï¼Œèµ‹å€¼ç»™dataSource</span>
    <span class="hljs-keyword">static</span>{
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Properties</span> <span class="hljs-variable">properties</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();
            <span class="hljs-type">InputStream</span> <span class="hljs-variable">inputStream</span> <span class="hljs-operator">=</span>  JDBCTools.getClass().getClassLoader().getSystemResourceAsStream(<span class="hljs-string">"db.properties"</span>);
            properties.load(inputStream);
            dataSource = DruidDataSourceFactory.createDataSource(properties);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }
	<span class="hljs-comment">//å¯¹å¤–æä¾›è·å–è¿æ¥çš„é™æ€æ–¹æ³•ï¼</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Connection <span class="hljs-title function_">getConnection</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException {
        <span class="hljs-keyword">return</span> ds.getConnection();
    }
	<span class="hljs-comment">//å¯¹å¤–æä¾›å›æ”¶è¿æ¥çš„é™æ€æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">release</span><span class="hljs-params">(Connection conn)</span> <span class="hljs-keyword">throws</span> SQLException {
        conn.close();<span class="hljs-comment">//è¿˜ç»™è¿æ¥æ± </span>
    }
}
</code></pre>
</li>
</ul>
</li>
<li>
<p>æ³¨æ„ï¼šæ­¤ç§å°è£…æ–¹å¼ï¼Œæ— æ³•ä¿è¯å•ä¸ªè¯·æ±‚è¿æ¥çš„çº¿ç¨‹ï¼Œå¤šæ¬¡æ“ä½œæ•°æ®åº“æ—¶ï¼Œè¿æ¥æ˜¯åŒä¸€ä¸ªï¼Œæ— æ³•ä¿è¯äº‹åŠ¡ï¼</p>
</li>
</ul>
<h4 data-id="heading-40">9.3 ThreadLocal</h4>
<blockquote>
<p>JDK 1.2çš„ç‰ˆæœ¬ä¸­å°±æä¾›java.lang.ThreadLocalï¼Œä¸ºè§£å†³å¤šçº¿ç¨‹ç¨‹åºçš„å¹¶å‘é—®é¢˜æä¾›äº†ä¸€ç§æ–°çš„æ€è·¯ã€‚ä½¿ç”¨è¿™ä¸ªå·¥å…·ç±»å¯ä»¥å¾ˆç®€æ´åœ°ç¼–å†™å‡ºä¼˜ç¾çš„å¤šçº¿ç¨‹ç¨‹åºã€‚é€šå¸¸ç”¨æ¥åœ¨åœ¨å¤šçº¿ç¨‹ä¸­ç®¡ç†å…±äº«æ•°æ®åº“è¿æ¥ã€Sessionç­‰ã€‚</p>
<p>ThreadLocalç”¨äºä¿å­˜æŸä¸ªçº¿ç¨‹å…±äº«å˜é‡ï¼ŒåŸå› æ˜¯åœ¨Javaä¸­ï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ä¸­éƒ½æœ‰ä¸€ä¸ªThreadLocalMap&lt;ThreadLocalï¼Œ Object&gt;ï¼Œå…¶keyå°±æ˜¯ä¸€ä¸ªThreadLocalï¼Œè€ŒObjectå³ä¸ºè¯¥çº¿ç¨‹çš„å…±äº«å˜é‡ã€‚</p>
<p>è€Œè¿™ä¸ªmapæ˜¯é€šè¿‡ThreadLocalçš„setå’Œgetæ–¹æ³•æ“ä½œçš„ã€‚å¯¹äºåŒä¸€ä¸ªstatic ThreadLocalï¼Œä¸åŒçº¿ç¨‹åªèƒ½ä»ä¸­getï¼Œsetï¼Œremoveè‡ªå·±çš„å˜é‡ï¼Œè€Œä¸ä¼šå½±å“å…¶ä»–çº¿ç¨‹çš„å˜é‡ã€‚</p>
<ul>
<li>åœ¨è¿›è¡Œå¯¹è±¡è·¨å±‚ä¼ é€’çš„æ—¶å€™ï¼Œä½¿ç”¨ThreadLocalå¯ä»¥é¿å…å¤šæ¬¡ä¼ é€’ï¼Œæ‰“ç ´å±‚æ¬¡é—´çš„çº¦æŸã€‚</li>
<li>çº¿ç¨‹é—´æ•°æ®éš”ç¦»ã€‚</li>
<li>è¿›è¡Œäº‹åŠ¡æ“ä½œï¼Œç”¨äºå­˜å‚¨çº¿ç¨‹äº‹åŠ¡ä¿¡æ¯ã€‚</li>
<li>æ•°æ®åº“è¿æ¥ï¼Œ<code>Session</code>ä¼šè¯ç®¡ç†ã€‚</li>
</ul>
<p>1ã€ThreadLocalå¯¹è±¡.get: è·å–ThreadLocalä¸­å½“å‰çº¿ç¨‹å…±äº«å˜é‡çš„å€¼ã€‚</p>
<p>2ã€ThreadLocalå¯¹è±¡.set: è®¾ç½®ThreadLocalä¸­å½“å‰çº¿ç¨‹å…±äº«å˜é‡çš„å€¼ã€‚</p>
<p>3ã€ThreadLocalå¯¹è±¡.remove: ç§»é™¤ThreadLocalä¸­å½“å‰çº¿ç¨‹å…±äº«å˜é‡çš„å€¼ã€‚</p>
</blockquote>
<p><img src="%E8%BD%AC%E5%AD%98%E5%A4%B1%E8%B4%A5%EF%BC%8C%E5%BB%BA%E8%AE%AE%E7%9B%B4%E6%8E%A5%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E6%96%87%E4%BB%B6%20JDBC.assets/image-20240223104919548.png" alt="image-20240223104919548è½¬å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" loading="lazy"/></p>
<h4 data-id="heading-41">9.4 JDBCå·¥å…·ç±»å°è£…V2.0</h4>
<blockquote>
<p>åœ¨V1.0çš„ç‰ˆæœ¬åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å°†è¿æ¥å¯¹è±¡æ”¾åœ¨æ¯ä¸ªçº¿ç¨‹çš„ThreadLocalä¸­ï¼Œä¿è¯ä»å¤´åˆ°å°¾å½“å‰çº¿ç¨‹æ“ä½œçš„æ˜¯åŒä¸€è¿æ¥å¯¹è±¡ã€‚</p>
</blockquote>
<p>ä»£ç å®ç°ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.atguigu.senior.util;

<span class="hljs-keyword">import</span> com.alibaba.druid.pool.DruidDataSourceFactory;

<span class="hljs-keyword">import</span> javax.sql.DataSource;
<span class="hljs-keyword">import</span> java.io.InputStream;
<span class="hljs-keyword">import</span> java.sql.Connection;
<span class="hljs-keyword">import</span> java.sql.SQLException;
<span class="hljs-keyword">import</span> java.util.Properties;
<span class="hljs-comment">/**
 *  JDBCå·¥å…·ç±»ï¼ˆV2.0ï¼‰ï¼š
 *      1ã€ç»´æŠ¤ä¸€ä¸ªè¿æ¥æ± å¯¹è±¡ã€ç»´æŠ¤äº†ä¸€ä¸ªçº¿ç¨‹ç»‘å®šå˜é‡çš„ThreadLocalå¯¹è±¡
 *      2ã€å¯¹å¤–æä¾›åœ¨ThreadLocalä¸­è·å–è¿æ¥çš„æ–¹æ³•
 *      3ã€å¯¹å¤–æä¾›å›æ”¶è¿æ¥çš„æ–¹æ³•ï¼Œå›æ”¶è¿‡ç¨‹ä¸­ï¼Œå°†è¦å›æ”¶çš„è¿æ¥ä»ThreadLocalä¸­ç§»é™¤ï¼
 *  æ³¨æ„ï¼šå·¥å…·ç±»ä»…å¯¹å¤–æä¾›å…±æ€§çš„åŠŸèƒ½ä»£ç ï¼Œæ‰€ä»¥æ–¹æ³•å‡ä¸ºé™æ€æ–¹æ³•ï¼
 *  æ³¨æ„ï¼šä½¿ç”¨ThreadLocalå°±æ˜¯ä¸ºäº†ä¸€ä¸ªçº¿ç¨‹åœ¨å¤šæ¬¡æ•°æ®åº“æ“ä½œè¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªè¿æ¥ï¼
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JDBCUtilV2</span> {
    <span class="hljs-comment">//åˆ›å»ºè¿æ¥æ± å¼•ç”¨ï¼Œå› ä¸ºè¦æä¾›ç»™å½“å‰é¡¹ç›®çš„å…¨å±€ä½¿ç”¨ï¼Œæ‰€ä»¥åˆ›å»ºä¸ºé™æ€çš„ã€‚</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> DataSource dataSource;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ThreadLocal&lt;Connection&gt; threadLocal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();

    <span class="hljs-comment">//åœ¨é¡¹ç›®å¯åŠ¨æ—¶ï¼Œå³åˆ›å»ºè¿æ¥æ± å¯¹è±¡ï¼Œèµ‹å€¼ç»™dataSource</span>
    <span class="hljs-keyword">static</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Properties</span> <span class="hljs-variable">properties</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();
            <span class="hljs-type">InputStream</span> <span class="hljs-variable">inputStream</span> <span class="hljs-operator">=</span> JDBCUtil.class.getClassLoader().getResourceAsStream(<span class="hljs-string">"db.properties"</span>);
            properties.load(inputStream);

            dataSource = DruidDataSourceFactory.createDataSource(properties);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);
        }
    }
    <span class="hljs-comment">//å¯¹å¤–æä¾›åœ¨è¿æ¥æ± ä¸­è·å–è¿æ¥çš„æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Connection <span class="hljs-title function_">getConnection</span><span class="hljs-params">()</span>{
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">//åœ¨ThreadLocalä¸­è·å–Connectionã€</span>
            <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> threadLocal.get();
            <span class="hljs-comment">//threadLocalé‡Œæ²¡æœ‰å­˜å‚¨Connectionï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€æ¬¡è·å–</span>
            <span class="hljs-keyword">if</span> (connection == <span class="hljs-literal">null</span>) {
                <span class="hljs-comment">//åœ¨è¿æ¥æ± ä¸­è·å–ä¸€ä¸ªè¿æ¥ï¼Œå­˜å‚¨åœ¨threadLocalé‡Œã€‚</span>
                connection = dataSource.getConnection();
                threadLocal.set(connection);
            }
            <span class="hljs-keyword">return</span> connection;

        } <span class="hljs-keyword">catch</span> (SQLException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);
        }
    }
    <span class="hljs-comment">//å¯¹å¤–æä¾›å›æ”¶è¿æ¥çš„æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">release</span><span class="hljs-params">()</span>{
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> threadLocal.get();
            <span class="hljs-keyword">if</span>(connection!=<span class="hljs-literal">null</span>){
                <span class="hljs-comment">//ä»threadLocalä¸­ç§»é™¤å½“å‰å·²ç»å­˜å‚¨çš„Connectionå¯¹è±¡</span>
                threadLocal.remove();
                <span class="hljs-comment">//å¦‚æœå¼€å¯äº†äº‹åŠ¡çš„æ‰‹åŠ¨æäº¤ï¼Œæ“ä½œå®Œæ¯•åï¼Œå½’è¿˜ç»™è¿æ¥æ± ä¹‹å‰ï¼Œè¦å°†äº‹åŠ¡çš„è‡ªåŠ¨æäº¤æ”¹ä¸ºtrue</span>
                connection.setAutoCommit(<span class="hljs-literal">true</span>);
                <span class="hljs-comment">//å°†Connectionå¯¹è±¡å½’è¿˜ç»™è¿æ¥æ± </span>
                connection.close();
            }
        } <span class="hljs-keyword">catch</span> (SQLException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);
        }
    }

}

</code></pre>
<h3 data-id="heading-42">åã€DAOå°è£…åŠBaseDAOå·¥å…·ç±»</h3>
<h4 data-id="heading-43">10.1 DAOæ¦‚å¿µ</h4>
<blockquote>
<p>DAOï¼šData Access Objectï¼Œæ•°æ®è®¿é—®å¯¹è±¡ã€‚</p>
<p>Javaæ˜¯é¢å‘å¯¹è±¡è¯­è¨€ï¼Œæ•°æ®åœ¨Javaä¸­é€šå¸¸ä»¥å¯¹è±¡çš„å½¢å¼å­˜åœ¨ã€‚ä¸€å¼ è¡¨å¯¹åº”ä¸€ä¸ªå®ä½“ç±»ï¼Œä¸€å¼ è¡¨çš„æ“ä½œå¯¹åº”ä¸€ä¸ªDAOå¯¹è±¡ï¼</p>
<p>åœ¨Javaæ“ä½œæ•°æ®åº“æ—¶ï¼Œæˆ‘ä»¬ä¼šå°†å¯¹åŒä¸€å¼ è¡¨çš„å¢åˆ æ”¹æŸ¥æ“ä½œç»Ÿä¸€ç»´æŠ¤èµ·æ¥ï¼Œç»´æŠ¤çš„è¿™ä¸ªç±»å°±æ˜¯DAOå±‚ã€‚</p>
<p>DAOå±‚åªå…³æ³¨å¯¹æ•°æ®åº“çš„æ“ä½œï¼Œä¾›ä¸šåŠ¡å±‚Serviceè°ƒç”¨ï¼Œå°†èŒè´£åˆ’åˆ†æ¸…æ¥šï¼</p>
</blockquote>
<h4 data-id="heading-44">10.1 BaseDAOæ¦‚å¿µ</h4>
<blockquote>
<p>åŸºæœ¬ä¸Šæ¯ä¸€ä¸ªæ•°æ®è¡¨éƒ½åº”è¯¥æœ‰ä¸€ä¸ªå¯¹åº”çš„DAOæ¥å£åŠå…¶å®ç°ç±»ï¼Œå‘ç°å¯¹æ‰€æœ‰è¡¨çš„æ“ä½œï¼ˆå¢ã€åˆ ã€æ”¹ã€æŸ¥ï¼‰ä»£ç é‡å¤åº¦å¾ˆé«˜ï¼Œæ‰€ä»¥å¯ä»¥æŠ½å–å…¬å…±ä»£ç ï¼Œç»™è¿™äº›DAOçš„å®ç°ç±»å¯ä»¥æŠ½å–ä¸€ä¸ªå…¬å…±çš„çˆ¶ç±»ï¼Œå¤ç”¨å¢åˆ æ”¹æŸ¥çš„åŸºæœ¬æ“ä½œï¼Œæˆ‘ä»¬ç§°ä¸ºBaseDAOã€‚</p>
</blockquote>
<h4 data-id="heading-45">10.2 BaseDAOæ­å»º</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseDAO</span> {
    <span class="hljs-comment">/*
    é€šç”¨çš„å¢ã€åˆ ã€æ”¹çš„æ–¹æ³•
    String sqlï¼šsql
    Object... argsï¼šç»™sqlä¸­çš„?è®¾ç½®çš„å€¼åˆ—è¡¨ï¼Œå¯ä»¥æ˜¯0~n
     */</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-type">int</span> <span class="hljs-title function_">update</span><span class="hljs-params">(String sql,Object... args)</span> <span class="hljs-keyword">throws</span> SQLException {
<span class="hljs-comment">//        åˆ›å»ºPreparedStatementå¯¹è±¡ï¼Œå¯¹sqlé¢„ç¼–è¯‘</span>
        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> JDBCTools.getConnection();
        <span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">ps</span> <span class="hljs-operator">=</span> connection.prepareStatement(sql);
        <span class="hljs-comment">//è®¾ç½®?å ä½ç¬¦çš„å€¼</span>
        <span class="hljs-keyword">if</span>(args != <span class="hljs-literal">null</span> &amp;&amp; args.length&gt;<span class="hljs-number">0</span>){
            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;args.length; i++) {
                ps.setObject(i+<span class="hljs-number">1</span>,args[i]);<span class="hljs-comment">//?çš„ç¼–å·ä»1å¼€å§‹ï¼Œä¸æ˜¯ä»0å¼€å§‹ï¼Œæ•°ç»„çš„ä¸‹æ ‡æ˜¯ä»0å¼€å§‹</span>
            }
        }

        <span class="hljs-comment">//æ‰§è¡Œsql</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">len</span> <span class="hljs-operator">=</span> ps.executeUpdate();
        ps.close();
        <span class="hljs-comment">//è¿™é‡Œæ£€æŸ¥ä¸‹æ˜¯å¦å¼€å¯äº‹åŠ¡ï¼Œå¼€å¯ä¸å…³é—­è¿æ¥ï¼Œä¸šåŠ¡æ–¹æ³•å…³é—­!</span>
        <span class="hljs-comment">//connection.getAutoCommit()ä¸ºfalseï¼Œä¸è¦åœ¨è¿™é‡Œå›æ”¶connectionï¼Œç”±å¼€å¯äº‹åŠ¡çš„åœ°æ–¹å›æ”¶</span>
        <span class="hljs-comment">//connection.getAutoCommit()ä¸ºtrueï¼Œæ­£å¸¸å›æ”¶è¿æ¥</span>
        <span class="hljs-comment">//æ²¡æœ‰å¼€å¯äº‹åŠ¡çš„è¯ï¼Œç›´æ¥å›æ”¶å…³é—­å³å¯!</span>
        <span class="hljs-keyword">if</span> (connection.getAutoCommit()) {
            <span class="hljs-comment">//å›æ”¶</span>
            JDBCTools.release();
        }
        <span class="hljs-keyword">return</span> len;
    }

    <span class="hljs-comment">/*
    é€šç”¨çš„æŸ¥è¯¢å¤šä¸ªJavabeanå¯¹è±¡çš„æ–¹æ³•ï¼Œä¾‹å¦‚ï¼šå¤šä¸ªå‘˜å·¥å¯¹è±¡ï¼Œå¤šä¸ªéƒ¨é—¨å¯¹è±¡ç­‰
    è¿™é‡Œçš„clazzæ¥æ”¶çš„æ˜¯Tç±»å‹çš„Classå¯¹è±¡ï¼Œ
    å¦‚æœæŸ¥è¯¢å‘˜å·¥ä¿¡æ¯ï¼Œclazzä»£è¡¨Employee.classï¼Œ
    å¦‚æœæŸ¥è¯¢éƒ¨é—¨ä¿¡æ¯ï¼Œclazzä»£è¡¨Department.classï¼Œ
    è¿”å›List&lt;T&gt; list
     */</span>
    <span class="hljs-keyword">protected</span> &lt;T&gt; ArrayList&lt;T&gt; <span class="hljs-title function_">query</span><span class="hljs-params">(Class&lt;T&gt; clazz,String sql,Object... args)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">//        åˆ›å»ºPreparedStatementå¯¹è±¡ï¼Œå¯¹sqlé¢„ç¼–è¯‘</span>
        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> JDBCTools.getConnection();
        <span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">ps</span> <span class="hljs-operator">=</span> connection.prepareStatement(sql);
        <span class="hljs-comment">//è®¾ç½®?çš„å€¼</span>
        <span class="hljs-keyword">if</span>(args != <span class="hljs-literal">null</span> &amp;&amp; args.length&gt;<span class="hljs-number">0</span>){
            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;args.length; i++) {
                ps.setObject(i+<span class="hljs-number">1</span>, args[i]);<span class="hljs-comment">//?çš„ç¼–å·ä»1å¼€å§‹ï¼Œä¸æ˜¯ä»0å¼€å§‹ï¼Œæ•°ç»„çš„ä¸‹æ ‡æ˜¯ä»0å¼€å§‹</span>
            }
        }

        ArrayList&lt;T&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-type">ResultSet</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> ps.executeQuery();

        <span class="hljs-comment">/*
        è·å–ç»“æœé›†çš„å…ƒæ•°æ®å¯¹è±¡ã€‚
        å…ƒæ•°æ®å¯¹è±¡ä¸­æœ‰è¯¥ç»“æœé›†ä¸€å…±æœ‰å‡ åˆ—ã€åˆ—åç§°æ˜¯ä»€ä¹ˆç­‰ä¿¡æ¯
         */</span>
        <span class="hljs-type">ResultSetMetaData</span> <span class="hljs-variable">metaData</span> <span class="hljs-operator">=</span> res.getMetaData();
        <span class="hljs-type">int</span> <span class="hljs-variable">columnCount</span> <span class="hljs-operator">=</span> metaData.getColumnCount();<span class="hljs-comment">//è·å–ç»“æœé›†åˆ—æ•°</span>

        <span class="hljs-comment">//éå†ç»“æœé›†ResultSetï¼ŒæŠŠæŸ¥è¯¢ç»“æœä¸­çš„ä¸€æ¡ä¸€æ¡è®°å½•ï¼Œå˜æˆä¸€ä¸ªä¸€ä¸ªT å¯¹è±¡ï¼Œæ”¾åˆ°listä¸­ã€‚</span>
        <span class="hljs-keyword">while</span>(res.next()){
            <span class="hljs-comment">//å¾ªç¯ä¸€æ¬¡ä»£è¡¨æœ‰ä¸€è¡Œï¼Œä»£è¡¨æœ‰ä¸€ä¸ªTå¯¹è±¡</span>
            <span class="hljs-type">T</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> clazz.newInstance();<span class="hljs-comment">//è¦æ±‚è¿™ä¸ªç±»å‹å¿…é¡»æœ‰å…¬å…±çš„æ— å‚æ„é€ </span>

            <span class="hljs-comment">//æŠŠè¿™æ¡è®°å½•çš„æ¯ä¸€ä¸ªå•å…ƒæ ¼çš„å€¼å–å‡ºæ¥ï¼Œè®¾ç½®åˆ°tå¯¹è±¡å¯¹åº”çš„å±æ€§ä¸­ã€‚</span>
            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>; i&lt;=columnCount; i++){
                <span class="hljs-comment">//forå¾ªç¯ä¸€æ¬¡ï¼Œä»£è¡¨å–æŸä¸€è¡Œçš„1ä¸ªå•å…ƒæ ¼çš„å€¼</span>
                <span class="hljs-type">Object</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> res.getObject(i);

                <span class="hljs-comment">//è¿™ä¸ªå€¼åº”è¯¥æ˜¯tå¯¹è±¡çš„æŸä¸ªå±æ€§å€¼</span>
                <span class="hljs-comment">//è·å–è¯¥å±æ€§å¯¹åº”çš„Fieldå¯¹è±¡</span>
                <span class="hljs-comment">//String columnName = metaData.getColumnName(i);//è·å–ç¬¬iåˆ—çš„å­—æ®µå</span>
                <span class="hljs-comment">//è¿™é‡Œå†å–åˆ«åå¯èƒ½æ²¡åŠæ³•å¯¹åº”ä¸Š</span>
                <span class="hljs-type">String</span> <span class="hljs-variable">columnName</span> <span class="hljs-operator">=</span> metaData.getColumnLabel(i);<span class="hljs-comment">//è·å–ç¬¬iåˆ—çš„å­—æ®µåæˆ–å­—æ®µçš„åˆ«å</span>
                <span class="hljs-type">Field</span> <span class="hljs-variable">field</span> <span class="hljs-operator">=</span> clazz.getDeclaredField(columnName);
                field.setAccessible(<span class="hljs-literal">true</span>);<span class="hljs-comment">//è¿™ä¹ˆåšå¯ä»¥æ“ä½œprivateçš„å±æ€§</span>

                field.set(t,value);
            }

            list.add(t);
        }

        res.close();
        ps.close();
        <span class="hljs-comment">//è¿™é‡Œæ£€æŸ¥ä¸‹æ˜¯å¦å¼€å¯äº‹åŠ¡ï¼Œå¼€å¯ä¸å…³é—­è¿æ¥ï¼Œä¸šåŠ¡æ–¹æ³•å…³é—­!</span>
        <span class="hljs-comment">//æ²¡æœ‰å¼€å¯äº‹åŠ¡çš„è¯ï¼Œç›´æ¥å›æ”¶å…³é—­å³å¯!</span>
        <span class="hljs-keyword">if</span> (connection.getAutoCommit()) {
            <span class="hljs-comment">//å›æ”¶</span>
            JDBCTools.release();
        }
        <span class="hljs-keyword">return</span> list;
    }

    <span class="hljs-keyword">protected</span> &lt;T&gt; T <span class="hljs-title function_">queryBean</span><span class="hljs-params">(Class&lt;T&gt; clazz,String sql, Object... args)</span> <span class="hljs-keyword">throws</span> Exception {
        ArrayList&lt;T&gt; list = query(clazz, sql,args);
        <span class="hljs-keyword">if</span>(list == <span class="hljs-literal">null</span> || list.size() == <span class="hljs-number">0</span>){
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        <span class="hljs-keyword">return</span> list.get(<span class="hljs-number">0</span>);
    }
}
</code></pre>
<h4 data-id="heading-46">10.3 BaseDAOçš„åº”ç”¨</h4>
<h5 data-id="heading-47">10.3.1 åˆ›å»ºå‘˜å·¥DAOæ¥å£</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.atguigu.senior.dao;

<span class="hljs-keyword">import</span> com.atguigu.senior.pojo.Employee;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * EmployeeDaoè¿™ä¸ªç±»å¯¹åº”çš„æ˜¯t_empè¿™å¼ è¡¨çš„å¢åˆ æ”¹æŸ¥çš„æ“ä½œ
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmployeeDao</span> {
    <span class="hljs-comment">/**
     * æ•°æ®åº“å¯¹åº”çš„æŸ¥è¯¢æ‰€æœ‰çš„æ“ä½œ
     * <span class="hljs-doctag">@return</span> è¡¨ä¸­æ‰€æœ‰çš„æ•°æ®
     */</span>
    List&lt;Employee&gt; <span class="hljs-title function_">selectAll</span><span class="hljs-params">()</span>;

    <span class="hljs-comment">/**
     * æ•°æ®åº“å¯¹åº”çš„æ ¹æ®empIdæŸ¥è¯¢å•ä¸ªå‘˜å·¥æ•°æ®æ“ä½œ
     * <span class="hljs-doctag">@param</span> empId ä¸»é”®åˆ—
     * <span class="hljs-doctag">@return</span> ä¸€ä¸ªå‘˜å·¥å¯¹è±¡ï¼ˆä¸€è¡Œæ•°æ®ï¼‰
     */</span>
    Employee <span class="hljs-title function_">selectByEmpId</span><span class="hljs-params">(Integer empId)</span>;

    <span class="hljs-comment">/**
     * æ•°æ®åº“å¯¹åº”çš„æ–°å¢ä¸€æ¡å‘˜å·¥æ•°æ®
     * <span class="hljs-doctag">@param</span> employee ORMæ€æƒ³ä¸­çš„ä¸€ä¸ªå‘˜å·¥å¯¹è±¡
     * <span class="hljs-doctag">@return</span> å—å½±å“çš„è¡Œæ•°
     */</span>
    <span class="hljs-type">int</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(Employee employee)</span>;

    <span class="hljs-comment">/**
     * æ•°æ®åº“å¯¹åº”çš„ä¿®æ”¹ä¸€æ¡å‘˜å·¥æ•°æ®
     * <span class="hljs-doctag">@param</span> employee ORMæ€æƒ³ä¸­çš„ä¸€ä¸ªå‘˜å·¥å¯¹è±¡
     * <span class="hljs-doctag">@return</span> å—å½±å“çš„è¡Œæ•°
     */</span>
    <span class="hljs-type">int</span> <span class="hljs-title function_">update</span><span class="hljs-params">(Employee employee)</span>;

    <span class="hljs-comment">/**
     * æ•°æ®åº“å¯¹åº”çš„æ ¹æ®empIdåˆ é™¤ä¸€æ¡å‘˜å·¥æ•°æ®
     * <span class="hljs-doctag">@param</span> empId ä¸»é”®åˆ—
     * <span class="hljs-doctag">@return</span> å—å½±å“çš„è¡Œæ•°
     */</span>
    <span class="hljs-type">int</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(Integer empId)</span>;
}

</code></pre>
<h5 data-id="heading-48">10.3.2 åˆ›å»ºå‘˜å·¥DAOæ¥å£å®ç°ç±»</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.atguigu.senior.dao.impl;

<span class="hljs-keyword">import</span> com.atguigu.senior.dao.BaseDAO;
<span class="hljs-keyword">import</span> com.atguigu.senior.dao.EmployeeDao;
<span class="hljs-keyword">import</span> com.atguigu.senior.pojo.Employee;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmployeeDaoImpl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseDAO</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">EmployeeDao</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> List&lt;Employee&gt; <span class="hljs-title function_">selectAll</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"SELECT emp_id empId,emp_name empName,emp_salary empSalary,emp_age empAge FROM t_emp"</span>;
            <span class="hljs-keyword">return</span> executeQuery(Employee.class,sql,<span class="hljs-literal">null</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);
        }
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Employee <span class="hljs-title function_">selectByEmpId</span><span class="hljs-params">(Integer empId)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"SELECT emp_id empId,emp_name empName,emp_salary empSalary,emp_age empAge FROM t_emp where emp_id = ?"</span>;
            <span class="hljs-keyword">return</span> executeQueryBean(Employee.class,sql,empId);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);
        }
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(Employee employee)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"INSERT INTO t_emp(emp_name,emp_salary,emp_age) VALUES (?,?,?)"</span>;
            <span class="hljs-keyword">return</span> executeUpdate(sql,employee.getEmpName(),employee.getEmpSalary(),employee.getEmpAge());
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);
        }
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">update</span><span class="hljs-params">(Employee employee)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"UPDATE t_emp SET emp_salary = ? WHERE emp_id = ?"</span>;
            <span class="hljs-keyword">return</span> executeUpdate(sql,employee.getEmpSalary(),employee.getEmpId());
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);
        }
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(Integer empId)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"delete from t_emp where emp_id = ?"</span>;
            <span class="hljs-keyword">return</span> executeUpdate(sql,empId);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);
        }
    }
}

</code></pre>
<h3 data-id="heading-49">åä¸€ã€äº‹åŠ¡</h3>
<h4 data-id="heading-50">11.1 äº‹åŠ¡å›é¡¾</h4>
<ul>
<li>æ•°æ®åº“äº‹åŠ¡å°±æ˜¯ä¸€ç§SQLè¯­å¥æ‰§è¡Œçš„ç¼“å­˜æœºåˆ¶ï¼Œä¸ä¼šå•æ¡æ‰§è¡Œå®Œæ¯•å°±æ›´æ–°æ•°æ®åº“æ•°æ®ï¼Œæœ€ç»ˆæ ¹æ®ç¼“å­˜å†…çš„å¤šæ¡è¯­å¥æ‰§è¡Œç»“æœç»Ÿä¸€åˆ¤å®š!   ä¸€ä¸ªäº‹åŠ¡å†…æ‰€æœ‰è¯­å¥éƒ½æˆåŠŸåŠäº‹åŠ¡æˆåŠŸï¼Œæˆ‘ä»¬å¯ä»¥è§¦å‘commitæäº¤äº‹åŠ¡æ¥ç»“æŸäº‹åŠ¡ï¼Œæ›´æ–°æ•°æ®!   ä¸€ä¸ªäº‹åŠ¡å†…ä»»æ„ä¸€æ¡è¯­å¥å¤±è´¥ï¼Œå³ä¸ºäº‹åŠ¡å¤±è´¥ï¼Œæˆ‘ä»¬å¯ä»¥è§¦å‘rollbackå›æ»šç»“æŸäº‹åŠ¡ï¼Œæ•°æ®å›åˆ°äº‹åŠ¡ä¹‹å‰çŠ¶æ€!</li>
<li>ä¸€ä¸ªä¸šåŠ¡æ¶‰åŠå¤šæ¡ä¿®æ”¹æ•°æ®åº“è¯­å¥!   ä¾‹å¦‚:
<ul>
<li>ç»å…¸çš„è½¬è´¦æ¡ˆä¾‹ï¼Œè½¬è´¦ä¸šåŠ¡(Aè´¦æˆ·å‡é’±å’ŒBè´¦æˆ·åŠ é’±ï¼Œè¦ä¸€èµ·æˆåŠŸ)</li>
<li>æ‰¹é‡åˆ é™¤(æ¶‰åŠå¤šä¸ªåˆ é™¤)</li>
<li>æ‰¹é‡æ·»åŠ (æ¶‰åŠå¤šä¸ªæ’å…¥)</li>
</ul>
</li>
<li>äº‹åŠ¡çš„ç‰¹æ€§ï¼š
<ol>
<li>åŸå­æ€§ï¼ˆAtomicityï¼‰åŸå­æ€§æ˜¯æŒ‡äº‹åŠ¡æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ï¼Œäº‹åŠ¡ä¸­çš„æ“ä½œè¦ä¹ˆéƒ½å‘ç”Ÿï¼Œ  è¦ä¹ˆéƒ½ä¸å‘ç”Ÿã€‚</li>
<li>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰äº‹åŠ¡å¿…é¡»ä½¿æ•°æ®åº“ä»ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€å˜æ¢åˆ°å¦å¤–ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ã€‚</li>
<li>éš”ç¦»æ€§ï¼ˆIsolationï¼‰äº‹åŠ¡çš„éš”ç¦»æ€§æ˜¯æŒ‡ä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œä¸èƒ½è¢«å…¶ä»–äº‹åŠ¡å¹²æ‰°ï¼Œ  å³ä¸€ä¸ªäº‹åŠ¡å†…éƒ¨çš„æ“ä½œåŠä½¿ç”¨çš„æ•°æ®å¯¹å¹¶å‘çš„å…¶ä»–äº‹åŠ¡æ˜¯éš”ç¦»çš„ï¼Œå¹¶å‘æ‰§è¡Œçš„å„ä¸ªäº‹åŠ¡ä¹‹é—´ä¸èƒ½äº’ç›¸å¹²æ‰°ã€‚</li>
<li>æŒä¹…æ€§ï¼ˆDurabilityï¼‰æŒä¹…æ€§æ˜¯æŒ‡ä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦è¢«æäº¤ï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­æ•°æ®çš„æ”¹å˜å°±æ˜¯æ°¸ä¹…æ€§çš„ï¼Œ  æ¥ä¸‹æ¥çš„å…¶ä»–æ“ä½œå’Œæ•°æ®åº“æ•…éšœä¸åº”è¯¥å¯¹å…¶æœ‰ä»»ä½•å½±å“</li>
</ol>
</li>
<li>äº‹åŠ¡çš„æäº¤æ–¹å¼ï¼š
<ul>
<li>è‡ªåŠ¨æäº¤ï¼šæ¯æ¡è¯­å¥è‡ªåŠ¨å­˜å‚¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œæ‰§è¡ŒæˆåŠŸè‡ªåŠ¨æäº¤ï¼Œæ‰§è¡Œå¤±è´¥è‡ªåŠ¨å›æ»š!</li>
<li>æ‰‹åŠ¨æäº¤:  æ‰‹åŠ¨å¼€å¯äº‹åŠ¡ï¼Œæ·»åŠ è¯­å¥ï¼Œæ‰‹åŠ¨æäº¤æˆ–è€…æ‰‹åŠ¨å›æ»šå³å¯!</li>
</ul>
</li>
</ul>
<h4 data-id="heading-51">11.2 JDBCä¸­äº‹åŠ¡å®ç°</h4>
<ul>
<li>
<p>å…³é”®ä»£ç ï¼š</p>
<ul>
<li>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">try</span>{
    connection.setAutoCommit(<span class="hljs-literal">false</span>); <span class="hljs-comment">//å…³é—­è‡ªåŠ¨æäº¤äº†</span>
    <span class="hljs-comment">//connection.setAutoCommit(false)ä¹Ÿå°±ç±»å‹äºSET autocommit = off</span>
    
    <span class="hljs-comment">//æ³¨æ„ï¼Œåªè¦å½“å‰connectionå¯¹è±¡ï¼Œè¿›è¡Œæ•°æ®åº“æ“ä½œï¼Œéƒ½ä¸ä¼šè‡ªåŠ¨æäº¤äº‹åŠ¡</span>
    <span class="hljs-comment">//æ•°æ®åº“åŠ¨ä½œ!</span>
    <span class="hljs-comment">//prepareStatement - å•ä¸€çš„æ•°æ®åº“åŠ¨ä½œ c r u d </span>
    <span class="hljs-comment">//connection - æ“ä½œäº‹åŠ¡ </span>
    
    <span class="hljs-comment">//æ‰€æœ‰æ“ä½œæ‰§è¡Œæ­£ç¡®ï¼Œæäº¤äº‹åŠ¡ï¼</span>
    connection.commit();
  }<span class="hljs-keyword">catch</span>(Execption e){
    <span class="hljs-comment">//å‡ºç°å¼‚å¸¸ï¼Œåˆ™å›æ»šäº‹åŠ¡ï¼</span>
    connection.rollback();
  }
</code></pre>
</li>
</ul>
</li>
</ul>
<h4 data-id="heading-52">11.3  JDBCäº‹åŠ¡ä»£ç å®ç°</h4>
<ul>
<li>
<p>å‡†å¤‡æ•°æ®åº“è¡¨ï¼š</p>
<ul>
<li>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- ç»§ç»­åœ¨atguiguçš„åº“ä¸­åˆ›å»ºé“¶è¡Œè¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t_bank(
   id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT COMMENT <span class="hljs-string">'è´¦å·ä¸»é”®'</span>,
   account <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">UNIQUE</span> COMMENT <span class="hljs-string">'è´¦å·'</span>,
   money  <span class="hljs-type">INT</span> UNSIGNED COMMENT <span class="hljs-string">'é‡‘é¢ï¼Œä¸èƒ½ä¸ºè´Ÿå€¼'</span>) ;
   
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_bank(account,money) <span class="hljs-keyword">VALUES</span>
  (<span class="hljs-string">'zhangsan'</span>,<span class="hljs-number">1000</span>),(<span class="hljs-string">'lisi'</span>,<span class="hljs-number">1000</span>);

</code></pre>
</li>
</ul>
</li>
<li>
<p>DAOæ¥å£ä»£ç ï¼š</p>
<ul>
<li>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">BankDao</span>{
    <span class="hljs-type">int</span> <span class="hljs-title function_">addMoney</span><span class="hljs-params">(Integer id,Integer money)</span>;

    <span class="hljs-type">int</span> <span class="hljs-title function_">subMoney</span><span class="hljs-params">(Integer id,Integer money)</span>;
}
</code></pre>
</li>
</ul>
</li>
<li>
<p>DAOå®ç°ç±»ä»£ç ï¼š</p>
<ul>
<li>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BankDaoImpl</span>  <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseDao</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">BankDao</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">addMoney</span><span class="hljs-params">(Integer id,Integer money)</span>{
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"update t_bank set money = money + ? where id = ? "</span>;
            <span class="hljs-keyword">return</span> executeUpdate(sql,money,id);
        } <span class="hljs-keyword">catch</span> (SQLException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);
        }
    }

   <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">subMoney</span><span class="hljs-params">(Integer id,Integer money)</span>{
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"update t_bank set money = money - ? where id = ? "</span>;
            <span class="hljs-keyword">return</span> executeUpdate(sql,money,id);
        } <span class="hljs-keyword">catch</span> (SQLException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);
        }
    }
}
</code></pre>
</li>
</ul>
</li>
<li>
<p>æµ‹è¯•ä»£ç ï¼š</p>
<ul>
<li>
<pre><code class="hljs language-java" lang="java"> <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testTransaction</span><span class="hljs-params">()</span>{
        <span class="hljs-type">BankDao</span> <span class="hljs-variable">bankDao</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BankDaoImpl</span>();
        Connection connection=<span class="hljs-literal">null</span>;
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">//1.è·å–è¿æ¥ï¼Œå°†è¿æ¥çš„äº‹åŠ¡æäº¤æ”¹ä¸ºæ‰‹åŠ¨æäº¤</span>
            connection = JDBCUtilV2.getConnection();
            connection.setAutoCommit(<span class="hljs-literal">false</span>);<span class="hljs-comment">//å¼€å¯äº‹åŠ¡ï¼Œå½“å‰è¿æ¥çš„è‡ªåŠ¨æäº¤å…³é—­ã€‚æ”¹ä¸ºæ‰‹åŠ¨æäº¤ï¼</span>

            <span class="hljs-comment">//2.æ“ä½œå‡é’±</span>
            bankDao.subMoney(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>);

            <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span> / <span class="hljs-number">0</span>;

            <span class="hljs-comment">//3.æ“ä½œåŠ é’±</span>
            bankDao.addMoney(<span class="hljs-number">2</span>,<span class="hljs-number">100</span>);

            <span class="hljs-comment">//4.å‰ç½®çš„å¤šæ¬¡daoæ“ä½œï¼Œæ²¡æœ‰å¼‚å¸¸ï¼Œæäº¤äº‹åŠ¡ï¼</span>
            connection.commit();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">try</span> {
                connection.rollback();
            } <span class="hljs-keyword">catch</span> (Exception ex) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(ex);
            }
        }<span class="hljs-keyword">finally</span> {
            JDBCUtilV2.release();
        }
    }
</code></pre>
</li>
</ul>
</li>
</ul>
<p><strong>æ³¨æ„ï¼š</strong></p>
<blockquote>
<p>å½“å¼€å¯äº‹åŠ¡åï¼Œåˆ‡è®°ä¸€å®šè¦æ ¹æ®ä»£ç æ‰§è¡Œç»“æœæ¥å†³å®šæ˜¯å¦æäº¤æˆ–å›æ»šï¼å¦åˆ™æ•°æ®åº“çœ‹ä¸åˆ°æ•°æ®çš„æ“ä½œç»“æœï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ­ç§˜Cookieæ“çºµï¼šæ·±å…¥è§£ææ¨¡æ‹Ÿç™»å½•ä¸ç»´æŒä¼šè¯æŠ€å·§]]></title>    <link>https://juejin.cn/post/7603643044033970212</link>    <guid>https://juejin.cn/post/7603643044033970212</guid>    <pubDate>2026-02-07T11:33:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603643044033970212" data-draft-id="7603643044033953828" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ­ç§˜Cookieæ“çºµï¼šæ·±å…¥è§£ææ¨¡æ‹Ÿç™»å½•ä¸ç»´æŒä¼šè¯æŠ€å·§"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-07T11:33:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¯±ä¹Ÿä¸ç¯±"/> <meta itemprop="url" content="https://juejin.cn/user/814056073093864"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ­ç§˜Cookieæ“çºµï¼šæ·±å…¥è§£ææ¨¡æ‹Ÿç™»å½•ä¸ç»´æŒä¼šè¯æŠ€å·§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/814056073093864/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¯±ä¹Ÿä¸ç¯±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T11:33:06.000Z" title="Sat Feb 07 2026 11:33:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨äº’è”ç½‘ä¸–ç•Œä¸­ï¼ŒCookieæ‰®æ¼”ç€è‡³å…³é‡è¦çš„è§’è‰²ï¼Œå®ƒä¸ä»…èƒ½å¤Ÿè®°å½•ç”¨æˆ·çš„æµè§ˆä¹ æƒ¯ï¼Œè¿˜èƒ½å®ç°ç½‘ç«™çš„ä¸ªæ€§åŒ–æœåŠ¡ã€‚æœ¬æ–‡å°†æ·±å…¥è§£æå¦‚ä½•é€šè¿‡Cookieæ¨¡æ‹Ÿç™»å½•å¹¶ç»´æŒç½‘ç«™ä¼šè¯çŠ¶æ€ï¼Œå¸®åŠ©è¯»è€…å…¨é¢äº†è§£è¿™ä¸€æŠ€æœ¯ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹CookieéªŒè¯çš„åŸç†ã€‚Cookieæ˜¯ä¸€ç§åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­å­˜å‚¨çš„å°å‹æ–‡æœ¬æ–‡ä»¶ï¼Œå®ƒåŒ…å«äº†ç½‘ç«™ä¸ç”¨æˆ·ä¹‹é—´çš„äº¤äº’ä¿¡æ¯ã€‚å½“ç”¨æˆ·è®¿é—®ç½‘ç«™æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå°†Cookieå‘é€åˆ°ç”¨æˆ·çš„æµè§ˆå™¨ï¼Œæµè§ˆå™¨å°†è¿™äº›ä¿¡æ¯å­˜å‚¨èµ·æ¥ã€‚å½“ç”¨æˆ·å†æ¬¡è®¿é—®åŒä¸€ç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨ä¼šå°†è¿™äº›Cookieå‘é€å›æœåŠ¡å™¨ï¼Œä»è€ŒéªŒè¯ç”¨æˆ·çš„èº«ä»½ã€‚</p>
<p>è·å–Cookieçš„æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œå…¶ä¸­æœ€å¸¸è§çš„æ˜¯ä½¿ç”¨æµè§ˆå™¨å·¥å…·ã€‚ä¾‹å¦‚ï¼ŒChromeæµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬æŸ¥çœ‹å’Œä¿®æ”¹Cookieã€‚æ­¤å¤–ï¼ŒPythonåº“å¦‚<code>requests</code>å’Œ<code>BeautifulSoup</code>ä»¥åŠè‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·Seleniumç­‰ï¼Œéƒ½èƒ½å¸®åŠ©æˆ‘ä»¬è·å–å’Œæ“ä½œCookieã€‚</p>
<p>åœ¨æ¨¡æ‹Ÿç™»å½•è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å­—å…¸ä¼ é€’çš„æ–¹å¼æ¥è®¾ç½®Cookieã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python">cookies = {
    <span class="hljs-string">'username'</span>: <span class="hljs-string">'testuser'</span>,
    <span class="hljs-string">'password'</span>: <span class="hljs-string">'testpassword'</span>
}
response = requests.get(<span class="hljs-string">'http://example.com/login'</span>, cookies=cookies)
</code></pre>
<p>é™¤äº†å­—å…¸ä¼ é€’ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨<code>CookieJar</code>æ¥ç®¡ç†Cookieã€‚<code>CookieJar</code>æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºå­˜å‚¨Cookieçš„å®¹å™¨ï¼Œå®ƒå¯ä»¥æ–¹ä¾¿åœ°æ·»åŠ ã€åˆ é™¤å’Œä¿®æ”¹Cookieã€‚</p>
<p>åœ¨ç»´æŒä¼šè¯çŠ¶æ€æ–¹é¢ï¼ŒSeleniumæ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„å·¥å…·ã€‚é€šè¿‡Seleniumï¼Œæˆ‘ä»¬å¯ä»¥æ¨¡æ‹ŸçœŸå®ç”¨æˆ·çš„æ“ä½œï¼Œå®ç°è‡ªåŠ¨ç™»å½•ã€æ•°æ®æŠ“å–ç­‰åŠŸèƒ½ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨Seleniumè¿›è¡Œæ¨¡æ‹Ÿç™»å½•çš„ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver

driver = webdriver.Chrome()
driver.get(<span class="hljs-string">'http://example.com/login'</span>)
driver.find_element_by_name(<span class="hljs-string">'username'</span>).send_keys(<span class="hljs-string">'testuser'</span>)
driver.find_element_by_name(<span class="hljs-string">'password'</span>).send_keys(<span class="hljs-string">'testpassword'</span>)
driver.find_element_by_name(<span class="hljs-string">'submit'</span>).click()
</code></pre>
<p>åœ¨å®æˆ˜æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ³¨æ„Cookieçš„è¿‡æœŸå¤„ç†ã€‚å¦‚æœCookieè¿‡æœŸäº†ï¼Œç”¨æˆ·å°†æ— æ³•ä¿æŒç™»å½•çŠ¶æ€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å®šæœŸæ£€æŸ¥Cookieçš„æœ‰æ•ˆæ€§ï¼Œå¹¶åœ¨å¿…è¦æ—¶åˆ·æ–°æˆ–é‡æ–°è·å–ã€‚</p>
<p>æœ€åï¼Œæˆ‘ä»¬å¿…é¡»å¼ºè°ƒCookieå®‰å…¨ä¿æŠ¤çš„é‡è¦æ€§ã€‚åœ¨å¤„ç†Cookieæ—¶ï¼Œè¦æ³¨æ„ä¿æŠ¤ç”¨æˆ·çš„éšç§ï¼Œé¿å…æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚åŒæ—¶ï¼Œå°Šé‡ç”¨æˆ·éšç§ï¼Œä¸è¦æœªç»æˆæƒè·å–å’Œä¿®æ”¹ç”¨æˆ·æ•°æ®ã€‚</p>
<p>æ€»ä¹‹ï¼Œé€šè¿‡æœ¬æ–‡çš„è§£æï¼Œè¯»è€…åº”è¯¥å¯¹Cookieæ“çºµæœ‰äº†æ›´æ·±å…¥çš„äº†è§£ã€‚æŒæ¡è¿™äº›æŠ€å·§ï¼Œä¸ä»…å¯ä»¥æé«˜æˆ‘ä»¬çš„ç¼–ç¨‹èƒ½åŠ›ï¼Œè¿˜èƒ½åœ¨ç½‘ç»œå®‰å…¨é¢†åŸŸå‘æŒ¥é‡è¦ä½œç”¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å†™äº† 10 å¹´ MyBatisï¼Œä¸€ç›´ä»¥ä¸ºâ€œå» XMLâ€=å†™æ³¨è§£ï¼Œç›´åˆ°çœ‹åˆ°äº†è¿™ä¸ªé¡¹ç›®]]></title>    <link>https://juejin.cn/post/7603656494904737798</link>    <guid>https://juejin.cn/post/7603656494904737798</guid>    <pubDate>2026-02-07T12:28:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603656494904737798" data-draft-id="7603656494904705030" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å†™äº† 10 å¹´ MyBatisï¼Œä¸€ç›´ä»¥ä¸ºâ€œå» XMLâ€=å†™æ³¨è§£ï¼Œç›´åˆ°çœ‹åˆ°äº†è¿™ä¸ªé¡¹ç›®"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-07T12:28:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å¸ƒå‰å²›"/> <meta itemprop="url" content="https://juejin.cn/user/1027421211203466"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å†™äº† 10 å¹´ MyBatisï¼Œä¸€ç›´ä»¥ä¸ºâ€œå» XMLâ€=å†™æ³¨è§£ï¼Œç›´åˆ°çœ‹åˆ°äº†è¿™ä¸ªé¡¹ç›®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1027421211203466/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å¸ƒå‰å²›
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T12:28:54.000Z" title="Sat Feb 07 2026 12:28:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"/>
<p>ä¸€ç›´å¯¹ MyBatis æœ‰ä¸ªåˆ»æ¿å°è±¡ï¼š<strong>Mapper æ¥å£è´Ÿè´£å£°æ˜æ–¹æ³•ï¼ŒMapper.xml è´Ÿè´£å†™ SQL</strong>ã€‚</p>
<p>æ”¹æ¡ä»¶å°±å» XML é‡Œ <code>&lt;if test=""&gt;</code>ï¼Œè°ƒå‚æ•°å°±åˆ‡æ¢ä¸åŒæ–‡ä»¶ï¼Œä»åˆšå¼€å§‹å­¦åˆ°ç°åœ¨ç”¨äº†å¾ˆä¹…ï¼Œç†Ÿæ‚‰å¾—ä¸èƒ½å†ç†Ÿæ‚‰ã€‚</p>
<p>ç›´åˆ°æœ€è¿‘çœ‹åˆ°ä¸€ä¸ªé¡¹ç›®ï¼š<strong>æˆ‘æŠŠ <code>resources/mapper</code> ç¿»äº†ä¸ªåº•æœå¤©ï¼Œæ„£æ˜¯æ²¡æ‰¾åˆ°ä¸€ä»½ XMLã€‚</strong></p>
<p>æˆ‘ç¬¬ä¸€ååº”ï¼š</p>
<blockquote>
<p>â€œè¿™é¡¹ç›®è‚¯å®šæ˜¯å…¨ç”¨ <code>@Select</code> ä¹‹ç±»çš„æ³¨è§£ç¡¬å†™ SQL äº†å§ã€‚â€</p>
</blockquote>
<p>ç»“æœæ‰“å¼€ Mapperï¼šæˆ‘äººå‚»äº†ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/95c21f8def4e4ec98f949321a5fd08ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5biD5ZCJ5bKb:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771072136&amp;x-signature=2QO8VTqMIM7e2M3y1Pym9OcNVdM%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-1">1ï¼‰å» XMLï¼š@Select</h3>
<p>å•è¡¨æŒ‰ä¸»é”®æŸ¥ï¼Œæ³¨è§£å¾ˆèˆ’æœï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@Select(<span class="hljs-params"><span class="hljs-string">"select * from tb_user where id = #{id}"</span></span>)UserDO selectById(<span class="hljs-params">Long <span class="hljs-built_in">id</span></span>);</span>
</code></pre>
<p>ä½†ä¸€æ—¦è¦åŠ¨æ€æ¡ä»¶ï¼Œå¾ˆå¤šäººä¼šå†™æˆè¿™ç§ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@Select</span>(<span class="hljs-string">""</span> +        <span class="hljs-string">"select * from tb_user "</span> +        <span class="hljs-string">""</span> +        <span class="hljs-string">"   and name like concat('%', #{name}, '%') "</span> +        <span class="hljs-string">"   and age &gt;= #{age} "</span> +        <span class="hljs-string">""</span> +        <span class="hljs-string">""</span>)List <span class="hljs-built_in">list</span>(UserQuery req);
</code></pre>
<p>è¿™ä¹ˆäº›çš„ä½“éªŒåŸºæœ¬æ˜¯ï¼š</p>
<ul>
<li>â€¢ å­—ç¬¦ä¸²æ‹¼æ¥çœ‹å¾—çœ¼ç–¼</li>
<li>â€¢ æ²¡æœ‰ SQL é«˜äº®ã€æ ¼å¼åŒ–ä¹Ÿå¾ˆéš¾å—</li>
<li>â€¢ å¤æ‚ä¸€ç‚¹ç›´æ¥ç»´æŠ¤ç¾éš¾</li>
</ul>
<p>æ‰€ä»¥ç»å¤§å¤šæ•°å›¢é˜Ÿæœ€ç»ˆéƒ½ä¼šå›åˆ° XMLâ€”â€”è‡³å°‘ XML é‡Œå†™åŠ¨æ€ SQL è¿˜èƒ½æ¥å—ã€‚</p>
<h3 data-id="heading-2">2ï¼‰å» XMLï¼š@SelectProvider</h3>
<p>è¿™ä¸ªé¡¹ç›®é‡Œ Mapper é•¿è¿™æ ·ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@SelectProvider(<span class="hljs-params"><span class="hljs-built_in">type</span> = UserSqlProvider.<span class="hljs-keyword">class</span>, method = <span class="hljs-string">"selectByCondition"</span></span>)List selectByCondition(<span class="hljs-params">UserQuery req</span>);</span>
</code></pre>
<p>æˆ‘å½“æ—¶å¿ƒé‡Œä¸€å¥è¯ï¼š</p>
<blockquote>
<p>â€œProviderï¼Ÿè¿™æ˜¯ä»€ä¹ˆä¸œä¸œï¼Ÿâ€</p>
</blockquote>
<p>ç‚¹è¿› <code>UserSqlProvider</code>ï¼Œçœ‹åˆ°çš„æ˜¯è¿™ç§ä»£ç ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">public class UserSqlProvider {  public String <span class="hljs-built_in">selectByCondition</span>(UserQuery req) {    return new <span class="hljs-built_in">SQL</span>() {{      <span class="hljs-built_in">SELECT</span>("id, name, age, status, create_time");      <span class="hljs-built_in">FROM</span>("tb_user");      if (req.getName() != null &amp;&amp; !req<span class="hljs-selector-class">.getName</span>()<span class="hljs-selector-class">.isBlank</span>()) {        <span class="hljs-built_in">WHERE</span>("name like concat('%', #{name}, '%')");      }      if (req.getMinAge() != null) {        <span class="hljs-built_in">WHERE</span>("age &gt;= #{minAge}");      }      if (req.getStatus() != null) {        <span class="hljs-built_in">WHERE</span>("status = #{status}");      }      <span class="hljs-built_in">ORDER_BY</span>("create_time desc");    }}<span class="hljs-selector-class">.toString</span>();  }}
</code></pre>
<p>å½“æ—¶æˆ‘æœ‰ç‚¹æƒŠè®¶ï¼š
<code>SQL()</code>ã€<code>SELECT()</code>ã€<code>WHERE()</code> è¿™äº›ä¸æ˜¯è‡ªå®šä¹‰å·¥å…·ç±»ï¼Œè€Œæ˜¯ <strong>MyBatis è‡ªå¸¦çš„ SQL Builder</strong>ã€‚</p>
<p>è¿™ç±»å†™æ³•çš„æœ¬è´¨æ˜¯ï¼š</p>
<ul>
<li>â€¢ <strong>XML åŠ¨æ€ SQL çš„èƒ½åŠ›ä¸å˜</strong></li>
<li>â€¢ ä½†â€œæ‹¼ SQL çš„è½½ä½“â€ä» XML å˜æˆ <strong>Java Provider æ–¹æ³•</strong></li>
<li>â€¢ æœ€ç»ˆ MyBatis ä»ç„¶æ‰§è¡Œä¸€æ®µ SQL å­—ç¬¦ä¸²ï¼ˆåªæ˜¯è¿™æ®µå­—ç¬¦ä¸²ç”± builder ç»„è£…å‡ºæ¥ï¼‰</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7fed90a36d9e4efb88705a45c1af5156~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5biD5ZCJ5bKb:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771072136&amp;x-signature=XQQcemYH66oslgOmjgw5jkaLyvQ%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-3">3ï¼‰Provider</h3>
<h4 data-id="heading-4">è§£å†³äº†ä»€ä¹ˆï¼Ÿ</h4>
<p><strong>åŠ¨æ€æ¡ä»¶ + å¯è¯»æ€§</strong>ã€‚</p>
<p>ä¸ç”¨åœ¨æ³¨è§£å­—ç¬¦ä¸²é‡Œå†™ <code>&lt;script&gt;</code>ã€ä¸ç”¨æ‰‹åŠ¨æ‹¼ <code>AND</code>ã€ä¹Ÿä¸ç”¨åœ¨ Java/XML ä¹‹é—´è·³æ¥è·³å»ã€‚</p>
<p>å†æ¯”å¦‚ï¼šåŠ¨æ€æ’åºå­—æ®µï¼ˆæ³¨æ„åšç™½åå•é˜²æ³¨å…¥ï¼‰</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-keyword">public</span> <span class="hljs-type">String</span> list(UserQuery req) {  <span class="hljs-keyword">return</span> <span class="hljs-built_in">new</span> SQL() {{    <span class="hljs-keyword">SELECT</span>(<span class="hljs-string">"*"</span>);    <span class="hljs-keyword">FROM</span>(<span class="hljs-string">"tb_user"</span>);    <span class="hljs-keyword">if</span> (req.getName() != null &amp;&amp; !req.getName().isBlank()) {      <span class="hljs-keyword">WHERE</span>(<span class="hljs-string">"name like concat('%', #{name}, '%')"</span>);    }    // æ’åºå­—æ®µåšç™½åå•ï¼Œé¿å… <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> æ³¨å…¥    <span class="hljs-keyword">if</span> (<span class="hljs-string">"create_time"</span>.<span class="hljs-keyword">equals</span>(req.getOrderBy())) {      ORDER_BY(<span class="hljs-string">"create_time desc"</span>);    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">"age"</span>.<span class="hljs-keyword">equals</span>(req.getOrderBy())) {      ORDER_BY(<span class="hljs-string">"age desc"</span>);    } <span class="hljs-keyword">else</span> {      ORDER_BY(<span class="hljs-string">"id desc"</span>);    }  }}.toString();}
</code></pre>
<h4 data-id="heading-5">æœªèƒ½è§£å†³</h4>
<p><strong>å¤æ‚ SQL çš„â€œè¡¨è¾¾åŠ›â€é—®é¢˜</strong>ã€‚</p>
<p>å­æŸ¥è¯¢ã€å¤æ‚ joinã€çª—å£å‡½æ•°ã€CTEâ€¦â€¦ä½ ç”¨ builder ä¹Ÿèƒ½å†™ï¼Œä½†å†™ç€å†™ç€å°±ä¼šå˜æˆâ€œåœ¨ Java é‡Œé€  SQL ASTâ€ï¼Œç»´æŠ¤æˆæœ¬å¯èƒ½å¹¶ä¸æ¯” XML ä½ã€‚</p>
<p>æˆ‘çš„å»ºè®®ï¼š</p>
<ul>
<li>â€¢ <strong>ä¸­ç­‰å¤æ‚åº¦åŠ¨æ€æŸ¥è¯¢</strong>ï¼šProvider å¾ˆåˆé€‚</li>
<li>â€¢ <strong>å¤æ‚æŠ¥è¡¨ / å¤šå±‚åµŒå¥—</strong>ï¼šç›´æ¥å†™åŸç”Ÿ SQLï¼ˆæ”¾ XML æˆ–ç»Ÿä¸€çš„ SQL æ–‡ä»¶ï¼‰æ›´ç›´è§‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/35e624c7bfe3424fb48d580ec328bb3b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5biD5ZCJ5bKb:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771072136&amp;x-signature=wS1QEwaf%2FfMQWVO5lj4ps%2F5XGRM%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-6">4ï¼‰Provider æœ€å®¹æ˜“è¸©çš„å‘ï¼šå‚æ•°ç»‘å®šï¼ˆ90% çš„æŠ¥é”™åœ¨è¿™ï¼‰</h3>
<h4 data-id="heading-7">4.1 å•å‚æ•°å¯¹è±¡ï¼šæœ€èˆ’æœ</h4>
<pre><code class="hljs language-scss" lang="scss">List <span class="hljs-built_in">list</span>(UserQuery req);
</code></pre>
<p>Provider é‡Œç›´æ¥ <code>#{name}</code>ã€<code>#{minAge}</code>ï¼Œå¯¹åº” <code>req</code> çš„å±æ€§åå³å¯ã€‚</p>
<h4 data-id="heading-8">4.2 å¤šå‚æ•°ä¸€å®šè¦ @Paramï¼Œä¸ç„¶ä¼šçœ‹åˆ°å¥‡æ€ªçš„å‚æ•°å</h4>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@SelectProvider</span>(type = UserSqlProvider.class, method = <span class="hljs-string">"get"</span>)UserDO <span class="hljs-built_in">get</span>(<span class="hljs-variable">@Param</span>(<span class="hljs-string">"id"</span>) Long id, <span class="hljs-variable">@Param</span>(<span class="hljs-string">"status"</span>) Integer status);
</code></pre>
<p>Provider å¯ä»¥æ”¶ <code>Map</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">get</span>(<span class="hljs-params"><span class="hljs-built_in">Map</span> p</span>) {  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">SQL</span>(<span class="hljs-params"/>) {{    <span class="hljs-title function_">SELECT</span>(<span class="hljs-string">"*"</span>);    <span class="hljs-title function_">FROM</span>(<span class="hljs-string">"tb_user"</span>);    <span class="hljs-title function_">WHERE</span>(<span class="hljs-string">"id = #{id}"</span>);    <span class="hljs-keyword">if</span> (p.<span class="hljs-title function_">get</span>(<span class="hljs-string">"status"</span>) != <span class="hljs-literal">null</span>) {      <span class="hljs-title function_">WHERE</span>(<span class="hljs-string">"status = #{status}"</span>);    }  }}.<span class="hljs-title function_">toString</span>();}
</code></pre>
<p>å¦‚æœä¸å†™ <code>@Param</code>ï¼Œå‚æ•°åå¯èƒ½å˜æˆ <code>param1/param2</code> æˆ– <code>arg0/arg1</code>ï¼Œç„¶åä½ å°±å¼€å§‹â€œæœ‰bugï¼Œæ˜æ˜ä¼ äº†å€¼æ€ä¹ˆä¸ºç©ºâ€ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e1c132a4509405cbd9588a0eb2731c3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5biD5ZCJ5bKb:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771072136&amp;x-signature=jzlidB1zO2EjQEZH%2B5XL8EGaUKw%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-9">5ï¼‰å†æ‡’ä¸€ä¸‹ï¼šMyBatis-Plus</h3>
<p>å¦‚æœä¸»è¦åœºæ™¯æ˜¯<strong>å•è¡¨ CRUD + æ¡ä»¶ç­›é€‰</strong>ï¼ŒMyBatis-Plus çš„æ€è·¯æ˜¯ï¼šå°½é‡åˆ«å†™ SQLï¼Œè®© Wrapper æ¥è¡¨è¾¾æ¡ä»¶ã€‚</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">LambdaQueryWrapper</span> <span class="hljs-selector-tag">w</span> = <span class="hljs-selector-tag">Wrappers</span><span class="hljs-selector-class">.lambdaQuery</span>();<span class="hljs-selector-tag">w</span><span class="hljs-selector-class">.like</span>(StringUtils.<span class="hljs-built_in">isNotBlank</span>(req.<span class="hljs-built_in">getName</span>()), <span class="hljs-attribute">UserDO</span>::getName, req.<span class="hljs-built_in">getName</span>()) <span class="hljs-selector-class">.ge</span>(req.<span class="hljs-built_in">getMinAge</span>() != null, <span class="hljs-attribute">UserDO</span>::getAge, req.<span class="hljs-built_in">getMinAge</span>()) <span class="hljs-selector-class">.eq</span>(req.<span class="hljs-built_in">getStatus</span>() != null, <span class="hljs-attribute">UserDO</span>::getStatus, req.<span class="hljs-built_in">getStatus</span>()); <span class="hljs-selector-tag">List</span> <span class="hljs-selector-tag">list</span> = <span class="hljs-selector-tag">userMapper</span><span class="hljs-selector-class">.selectList</span>(w);
</code></pre>
<p>è¿™å¥—ä¸œè¥¿çš„ä»·å€¼å¾ˆæ˜ç¡®ï¼š</p>
<ul>
<li>â€¢ å­—æ®µå¼•ç”¨æ˜¯æ–¹æ³•å¼•ç”¨ï¼Œæ”¹å­—æ®µ/é‡æ„æ›´å®‰å…¨</li>
<li>â€¢ å¤§é‡å•è¡¨æŸ¥è¯¢ä¸éœ€è¦å†™ SQL</li>
<li>â€¢ å›¢é˜Ÿç»Ÿä¸€é£æ ¼ä¹‹åï¼Œå¼€å‘æ•ˆç‡å¾ˆé«˜</li>
</ul>
<p>ä½†è¾¹ç•Œä¹Ÿå¾ˆæ˜ç¡®ï¼š<strong>å¤æ‚ SQL ä»ç„¶è¦å›åˆ°åŸç”Ÿ SQL</strong>ï¼ˆXML/Provider/è‡ªå®šä¹‰ mapper éƒ½è¡Œï¼‰ï¼ŒWrapper ä¸é€‚åˆç¡¬æ‰›æŠ¥è¡¨ç±»éœ€æ±‚ã€‚</p>
<h3 data-id="heading-10">6ï¼‰ç»„è£… SQLï¼šMyBatis-Flex</h3>
<p>å¦‚æœè¿ join éƒ½ä¸æƒ³å†™ SQLï¼Œæ›´å¸Œæœ›ç”¨ Java ç»“æ„æ¥è¡¨è¾¾ï¼ŒMyBatis-Flex è¿™ç±»æ¡†æ¶ä¼šæä¾›æ›´å¼ºçš„ QueryWrapper/Join èƒ½åŠ›ã€‚</p>
<p>ç®€å• join ç¡®å®å¾ˆç›´è§‚ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">QueryWrapper <span class="hljs-selector-tag">q</span> = QueryWrapper<span class="hljs-selector-class">.create</span>()    <span class="hljs-selector-class">.select</span>(ACCOUNT.ID, ACCOUNT.USER_NAME, ROLE.ROLE_NAME)    <span class="hljs-selector-class">.from</span>(ACCOUNT)    <span class="hljs-selector-class">.leftJoin</span>(ROLE)<span class="hljs-selector-class">.on</span>(ACCOUNT.ROLE_ID.eq(ROLE.ID))    <span class="hljs-selector-class">.where</span>(ACCOUNT.AGE.ge(<span class="hljs-number">18</span>)); List list = accountMapper<span class="hljs-selector-class">.selectListByQueryAs</span>(q, AccountDTO.class);
</code></pre>
<p>ä½†å½“ä½ å¼€å§‹å†™<strong>å¤šå±‚å­æŸ¥è¯¢/åµŒå¥—æ¡ä»¶</strong>æ—¶ï¼Œå¯è¯»æ€§å¾ˆå®¹æ˜“è¢«â€œå¯¹è±¡å¥—å¯¹è±¡â€æ‹‰ä½ã€‚</p>
<p>æ¯”å¦‚â€œè®¢å•é‡‘é¢ &gt; ç”¨æˆ· 1 å¹³å‡è®¢å•é‡‘é¢â€è¿™ç§ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">// å­æŸ¥è¯¢QueryWrapper <span class="hljs-keyword">sub</span> = QueryWrapper.create()    .<span class="hljs-keyword">select</span>(avg(<span class="hljs-keyword">ORDER</span>.TOTAL_PRICE))    .<span class="hljs-keyword">from</span>(<span class="hljs-keyword">ORDER</span>)    .<span class="hljs-keyword">where</span>(<span class="hljs-keyword">ORDER</span>.USER_ID.eq(<span class="hljs-number">1</span>)); // ä¸»æŸ¥è¯¢QueryWrapper main = QueryWrapper.create()    .<span class="hljs-keyword">select</span>(<span class="hljs-keyword">ORDER</span>.ALL_COLUMNS)    .<span class="hljs-keyword">from</span>(<span class="hljs-keyword">ORDER</span>)    .<span class="hljs-keyword">where</span>(<span class="hljs-keyword">ORDER</span>.TOTAL_PRICE.gt(<span class="hljs-keyword">sub</span>)); List list = orderMapper.selectListByQuery(main);
</code></pre>
<p>èƒ½å†™ã€ä¹Ÿç±»å‹æ›´å®‰å…¨ï¼Œä½†ç»´æŠ¤è€…å¾€å¾€éœ€è¦åœ¨è„‘å­é‡ŒæŠŠå®ƒâ€œè¿˜åŸæˆ SQLâ€å†ç†è§£æ„å›¾ã€‚åµŒå¥—å±‚çº§è¶Šæ·±ï¼Œè¿™ä¸ªæˆæœ¬è¶Šé«˜ã€‚</p>
<h3 data-id="heading-11">7ï¼‰åˆ°åº•æ€ä¹ˆé€‰ï¼Ÿ</h3>
<p>å‚è€ƒè½åœ°ç­–ç•¥ï¼š</p>
<ul>
<li>â€¢ <strong>å›ºå®š SQL / ç®€å•å•è¡¨</strong>ï¼š<code>@Select</code> è¶³å¤Ÿ</li>
<li>â€¢ <strong>ä¸­ç­‰åŠ¨æ€ SQLï¼ˆæ¡ä»¶å¤šã€æ‹¼æ¥å¤šï¼Œä½†é€»è¾‘æ¸…æ™°ï¼‰</strong>ï¼š<code>@SelectProvider + SQL Builder</code></li>
<li>â€¢ <strong>å•è¡¨ CRUD ä¸ºä¸»ï¼Œè¿½æ±‚å°‘å†™ SQL</strong>ï¼šMyBatis-Plus</li>
<li>â€¢ <strong>Join å¤šã€å¸Œæœ› Java åŒ–è¡¨è¾¾æ›´å¼º</strong>ï¼šMyBatis-Flexï¼ˆåµŒå¥—å¤æ‚æ—¶è¦å…‹åˆ¶ï¼‰</li>
<li>â€¢ <strong>å¤æ‚æŠ¥è¡¨ / å¤šå±‚å­æŸ¥è¯¢ / å¼ºå£°æ˜å¼</strong>ï¼šç›´æ¥åŸç”Ÿ SQLï¼ˆXML/SQL æ–‡ä»¶ï¼‰ï¼Œé€šå¸¸æœ€æ¸…æ™°</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7339ceb5ce624c2cac445f2ed7ce5d0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5biD5ZCJ5bKb:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771072136&amp;x-signature=CbCoHeP5k4ZdsYN9AYDZgCFynIU%3D" alt="" loading="lazy"/>
Provider è¿™æ¡è·¯æœ€è®©æˆ‘æ„å¤–ï¼š<strong>ä¸é ç¬¬ä¸‰æ–¹ï¼Œä¹Ÿä¸æŠŠåŠ¨æ€ SQL å†™æˆå­—ç¬¦ä¸²ç‚¼ç‹±</strong>ï¼Œä½†å®ƒä¹Ÿä¸æ˜¯ç”¨æ¥æ›¿ä»£æ‰€æœ‰ SQL çš„ã€‚æŠŠè¾¹ç•Œå®šå¥½ï¼Œç”¨èµ·æ¥ä¼šæ›´èˆ’æœã€‚</p>
<p>æ€»ä¹‹å°±æ˜¯åœ¨ä¸åŒåœºæ™¯ä¸‹é¢é€‰æ‹©åˆé€‚çš„æŠ€æœ¯å¹¶ç¡®å®šåˆç†çš„è§„èŒƒï¼Œç„¶åç»Ÿä¸€æŒ‰ç…§è§„èŒƒæ‰§è¡Œå°±å¯ä»¥å•¦ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å…³ç³»æ•°æ®åº“æ›¿æ¢ç”¨é‡‘ä»“ï¼šæ•°æ®è¿ç§»è¿‡ç¨‹ä¸­çš„å®Œæ•´æ€§ä¸ä¸€è‡´æ€§é£é™©]]></title>    <link>https://juejin.cn/post/7603649945978683411</link>    <guid>https://juejin.cn/post/7603649945978683411</guid>    <pubDate>2026-02-08T00:40:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603649945978683411" data-draft-id="7603643044034609188" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å…³ç³»æ•°æ®åº“æ›¿æ¢ç”¨é‡‘ä»“ï¼šæ•°æ®è¿ç§»è¿‡ç¨‹ä¸­çš„å®Œæ•´æ€§ä¸ä¸€è‡´æ€§é£é™©"/> <meta itemprop="keywords" content="æ•°æ®åº“"/> <meta itemprop="datePublished" content="2026-02-08T00:40:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å€”å¼ºçš„çŸ³å¤´_"/> <meta itemprop="url" content="https://juejin.cn/user/3168119757484368"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å…³ç³»æ•°æ®åº“æ›¿æ¢ç”¨é‡‘ä»“ï¼šæ•°æ®è¿ç§»è¿‡ç¨‹ä¸­çš„å®Œæ•´æ€§ä¸ä¸€è‡´æ€§é£é™©
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3168119757484368/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å€”å¼ºçš„çŸ³å¤´_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-08T00:40:36.000Z" title="Sun Feb 08 2026 00:40:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7a23ff428cdf4f26982701fb3e4994aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771116079&amp;x-signature=tzq3RZtprxkrjI0eiKSUtWZ%2Fry0%3D" alt="640.gif" loading="lazy"/></p>
<blockquote>
<p>è¿™ç¯‡ä¸æ‰“ç®—åšâ€œè¿ç§»å·¥å…·æ¸…å•â€ã€‚æˆ‘æ›´æƒ³æŠŠå®ƒå†™æˆæ›¿æ¢é¡¹ç›®é‡Œçš„å¯¹è´¦/éªŒæ”¶ç¬”è®°ï¼šå“ªäº›å‘æœ€çˆ±åœ¨åˆ‡æ¢å‰åå†’å¤´ï¼Œå“ªäº›æ£€æŸ¥åœ¨ Windows + ksql çš„ç¯å¢ƒé‡Œå°±èƒ½ç”¨å¾ˆå°çš„æˆæœ¬è·‘èµ·æ¥ã€‚ç›®æ ‡ä¹Ÿå¾ˆç›´ç™½ï¼š<strong>åˆ«åªåœç•™åœ¨â€œè¿è¿‡å»äº†â€ï¼Œè€Œæ˜¯è¦åšåˆ°â€œè¿å¾—å¯¹ã€è·‘å¾—ç¨³ã€å‡ºäº†äº‹è¿˜èƒ½å›å¾—å»â€</strong>ã€‚</p>
</blockquote>
<p>@[toc]</p>
<hr/>
<h2 data-id="heading-0">1. ä¸ºä»€ä¹ˆè¿ç§»æœ€éš¾çš„ä¸æ˜¯â€œèƒ½ä¸èƒ½å¯¼å…¥â€ï¼Œè€Œæ˜¯â€œå¯¹ä¸å¯¹å¾—ä¸Šâ€</h2>
<p>è¿ç§»è¿™äº‹å„¿ï¼Œæœ€å®¹æ˜“è®©äººæ”¾æ¾è­¦æƒ•çš„ä¸€å¥è¯å°±æ˜¯ï¼šâ€œæ•°æ®éƒ½å¯¼è¿›å»äº†ï¼ŒæŸ¥å¾—å‡ºæ¥å°±è¡Œã€‚â€<br/>
å¯ä¸€æ—¦ä¸Šçº¿ï¼Œä¸šåŠ¡çœŸæ­£æ„ŸçŸ¥çš„ä»æ¥ä¸æ˜¯â€œæœ‰æ²¡æœ‰æ•°æ®â€ï¼Œè€Œæ˜¯ä¸‹é¢è¿™ä¸¤ä»¶äº‹ï¼š</p>
<ul>
<li><strong>å®Œæ•´æ€§</strong>ï¼šè¯¥æœ‰çš„è¡Œæœ‰æ²¡æœ‰éƒ½åˆ°é½ï¼ˆä¸ä¸¢ã€ä¸ç¼ºã€ä¸ä¹±å…³è”ï¼‰ï¼›</li>
<li><strong>ä¸€è‡´æ€§</strong>ï¼šåŒä¸€æ¡ä¸šåŠ¡äº‹å®åœ¨æ–°æ—§é“¾è·¯ä¸Šæ˜¯ä¸æ˜¯åŒä¸€ä¸ªç»“æœï¼ˆé‡‘é¢ã€çŠ¶æ€ã€æ—¶é—´ã€æ–‡æœ¬éƒ½ä¸€è‡´ï¼‰ã€‚</li>
</ul>
<p>æˆ‘è§è¿‡ä¸å°‘äº‹æ•…ï¼Œæœ€åéƒ½èƒ½å½’åˆ°ä¸€å¥è¯ä¸Šï¼š<strong>è¿ç§»é“¾è·¯æŠŠâ€œæ•°æ®çš„æ ·å­â€æ¬è¿‡å»äº†ï¼Œä½†æ²¡æŠŠâ€œæ•°æ®çš„å«ä¹‰â€ä¸€èµ·æ¬è¿‡å»</strong>ã€‚ä¸€æ—¦è¯­ä¹‰æ‚„æ‚„åäº†ï¼Œå®ƒé€šå¸¸ä¸ä¼šç«‹åˆ»ç‚¸é”…ï¼Œæ›´åƒæ˜¯æ…¢æ€§ç—…ï¼šä»Šå¤©å¯¹è´¦å·®ä¸€ç‚¹ã€æ˜å¤©æŸå‡ å•çŠ¶æ€æ€ªæ€ªçš„ã€åå¤©åˆæœ‰äººåé¦ˆâ€œæ€ä¹ˆæœä¸åˆ°â€ã€‚æ’æŸ¥èµ·æ¥æœ€è€—äººã€‚</p>
<hr/>
<h2 data-id="heading-1">2. å®Œæ•´æ€§ vs ä¸€è‡´æ€§ï¼šé£é™©åœ°å›¾ï¼ˆæŒ‰â€œæ€ä¹ˆéªŒâ€æ¥åˆ†ç»„ï¼‰</h2>















































<table><thead><tr><th>é£é™©ç±»å‹</th><th>å…¸å‹è¡¨ç°</th><th>æ›´å®¹æ˜“å‡ºç°åœ¨å“ªä¸ªé˜¶æ®µ</th><th>æœ€æœ‰æ•ˆçš„éªŒè¯æ–¹å¼</th></tr></thead><tbody><tr><td>è¡Œçº§ç¼ºå¤±/é‡å¤</td><td>å°‘è¡Œã€é‡å¤è¡Œã€ä¸»é”®å†²çªåè¢«è¦†ç›–</td><td>å…¨é‡å¯¼å…¥ã€å¢é‡å›æ”¾</td><td>åˆ†æ®µè¡Œæ•°å¯¹è´¦ + ä¸»é”®é‡å¤æ‰«æ</td></tr><tr><td>å‚ç…§å…³ç³»æ–­è£‚</td><td>æ˜ç»†æ‰¾ä¸åˆ°ä¸»è¡¨ã€å¤–é”®å¯ç”¨å¤±è´¥</td><td>å¯¼å…¥åè¡¥çº¦æŸ</td><td>æ–­é“¾æ‰«æï¼ˆleft join æ‰¾å­¤å„¿ï¼‰</td></tr><tr><td>å­—ç¬¦é›†/æ’åºè§„åˆ™åå·®</td><td>æ–‡æœ¬ä¸ç­‰ã€æ¯”è¾ƒ/æ’åºç»“æœå˜åŒ–</td><td>è¯»å†™æ··ç”¨æœŸ</td><td>é•¿åº¦/å­—èŠ‚é•¿åº¦å¯¹ç…§ + å…³é”®æŸ¥è¯¢å›å½’</td></tr><tr><td>æ—¶é—´/æ—¶åŒº/ç²¾åº¦åå·®</td><td>æ—¶é—´ç›¸å·® 8 å°æ—¶ã€åŒç§’å†…é¡ºåºé”™</td><td>å¢é‡çª—å£ã€å¯¹è´¦</td><td>æ—¶åŒºåŸºçº¿æ ¡éªŒ + è¾¹ç•Œæ—¶é—´å›æ”¾</td></tr><tr><td>LOB æˆªæ–­/æŸå</td><td>æ–‡æ¡£æ‰“ä¸å¼€ã€é•¿æ–‡æœ¬å°¾éƒ¨ä¸¢</td><td>å…¨é‡å¯¼å…¥</td><td>é•¿åº¦åˆ†å¸ƒ + æŠ½æ ·å¯¼å‡ºæ–‡ä»¶æ ¡éªŒ</td></tr><tr><td>å¢é‡ checkpoint è®¾è®¡ä¸å½“</td><td>ä¸¢æ•°ã€é‡å¤ã€ä¹±åº</td><td>å¢é‡åŒæ­¥ã€åˆ‡æ¢æ—¥</td><td>å›æ”¾çª—å£ + åŒæ¡ä»¶æ–­ç‚¹ï¼ˆæ—¶é—´+ä¸»é”®ï¼‰</td></tr></tbody></table>
<p>è¿™å¼ è¡¨æƒ³è¡¨è¾¾çš„å°±ä¸€ä»¶äº‹ï¼šåˆ«æŠŠâ€œå¯¹è´¦â€å½“æˆä¸€ä¸ªåŠ¨ä½œï¼Œå®ƒæ›´åƒä¸€å¥—èƒ½é‡å¤è·‘çš„è„šæœ¬é›†åˆã€‚ä½ ä¸éœ€è¦é è®°å¿†å’Œæ„Ÿè§‰å»â€œè§‰å¾—å·®ä¸å¤šäº†â€ï¼Œè€Œæ˜¯è®©æ¯ä¸€æ­¥éƒ½æœ‰è¾“å‡ºã€æœ‰è¯æ®ã€‚ä¸‹é¢çš„å®æ“ä¹Ÿéƒ½æŒ‰â€œå¤åˆ¶åˆ° ksql å°±èƒ½è·‘â€çš„æ€è·¯æ¥å†™ã€‚</p>
<hr/>
<h2 data-id="heading-2">3. åˆ‡æ¢å‰å…ˆåšåŸºçº¿ï¼šWindows + ksql çš„ä¸‰ç±»è‡ªæ£€</h2>
<h3 data-id="heading-3">3.1 è¿æ¥ä¸ä¼šè¯åŸºçº¿</h3>
<pre><code class="hljs language-bash" lang="bash">ksql -h 127.0.0.1 -p 54321 -U system -d <span class="hljs-built_in">test</span>
</code></pre>
<p>è¿›åˆ° <code>test=#</code> ä»¥åï¼Œæˆ‘ä¼šå…ˆæŠŠâ€œä¼šè¯å£å¾„â€é’‰æ­»ï¼ˆåç»­æ‰€æœ‰å¯¹è´¦éƒ½æŒ‰åŒä¸€å£å¾„æ¥ï¼Œä¸ç„¶å®¹æ˜“å„è¯´å„è¯ï¼‰ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">CURRENT_USER</span>;
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>;
<span class="hljs-keyword">SHOW</span> server_encoding;
<span class="hljs-keyword">SHOW</span> client_encoding;
<span class="hljs-keyword">SHOW</span> lc_collate;
<span class="hljs-keyword">SHOW</span> lc_ctype;
<span class="hljs-keyword">SHOW</span> timezone;
<span class="hljs-keyword">SHOW</span> datestyle;
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fc4bfadb7b2748738d03f050d7957b63~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771116079&amp;x-signature=R0ZKYu73oJel8G7vpHIfB0eqv%2Bs%3D" alt="d7359054bbb1085d9edd89a99caacf6e.png" loading="lazy"/></p>
<p>è¿™æ®µè¾“å‡ºå»ºè®®ç›´æ¥ä¿å­˜åˆ°è¿ç§»è®°å½•é‡Œã€‚åé¢å¦‚æœå‡ºç°â€œæ€ä¹ˆçªç„¶å¯¹ä¸ä¸Šâ€çš„æƒ…å†µï¼Œåæœ‰å…«ä¹éƒ½èƒ½ä»è¿™é‡Œæ‰¾åˆ°çº¿ç´¢ï¼šæŸä¸ªç¯èŠ‚æ—¶åŒºä¸ä¸€è‡´ã€ç¼–ç ä¸ä¸€è‡´ã€æ’åºè§„åˆ™ä¸ä¸€è‡´ï¼Œé—®é¢˜å°±ä¼šå˜å¾—éå¸¸â€œç„å­¦â€ã€‚</p>
<h3 data-id="heading-4">3.2 ç»™å¯¹è´¦ç•™ä¸€ä¸ªè½ç‚¹ï¼šæ–­ç‚¹è¡¨ä¸å®¡è®¡è¡¨</h3>
<p>å¯¹è´¦æœ€æ€•çš„å°±æ˜¯â€œäººè‚‰è®°æ–­ç‚¹â€ã€‚æˆ‘ä¸€èˆ¬ä¼šåœ¨ç›®æ ‡åº“é‡Œå…ˆæ”¾ä¸€å¼ æ–­ç‚¹è¡¨ï¼šåˆ‡æ¢çª—å£ã€å¢é‡å›æ”¾ã€å‡ºé—®é¢˜é‡è·‘ï¼Œå…¨é å®ƒæŠŠæµç¨‹æ‹‰å›å¯æ§çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> mig_checkpoint (
  job_name      <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">PRIMARY</span> KEY,
  last_ts       <span class="hljs-type">TIMESTAMP</span>,
  last_pk       <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">200</span>),
  updated_at    <span class="hljs-type">TIMESTAMP</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
);
</code></pre>
<p>å¦‚æœä½ çš„ä¸»é”®æ˜¯å¤åˆé”®ä¹Ÿæ²¡å…³ç³»ï¼ŒæŠŠ <code>last_pk</code> å­˜æˆä¸€ä¸ªå¯æ¯”è¾ƒçš„æ‹¼æ¥ä¸²å°±è¡Œï¼ˆåé¢ä¼šç»™â€œæ—¶é—´ + ä¸»é”®â€çš„åŒæ¡ä»¶æ–­ç‚¹å†™æ³•ï¼‰ã€‚</p>
<h3 data-id="heading-5">3.3 æ˜ç¡®å¯¹è´¦å£å¾„ï¼šå“ªäº›è¡¨å¿…é¡»â€œå¼ºä¸€è‡´â€</h3>
<p>æˆ‘ä¼šå…ˆæŠŠè¡¨åˆ†ä¸‰ç±»ï¼Œé¿å…ä¸Šæ¥å°±æŠŠæ‰€æœ‰è¡¨æŒ‰åŒä¸€ä¸ªæ ‡å‡†â€œå‹æ­»â€ï¼Œæœ€åæŠŠç²¾åŠ›è€—åœ¨ä¸å…³é”®çš„åœ°æ–¹ï¼š</p>
<ul>
<li><strong>å¼ºä¸€è‡´è¡¨</strong>ï¼šè®¢å•ã€èµ„é‡‘ã€ä½™é¢ã€åº“å­˜è¿™ç±»è¡¨ï¼Œåˆ‡æ¢æ—¥å¿…é¡»é€è¡¨æ ¸å¯¹åˆ°è¡Œçº§ï¼›</li>
<li><strong>å¼±ä¸€è‡´è¡¨</strong>ï¼šæ—¥å¿—ã€è¡Œä¸ºã€ç»Ÿè®¡ç±»è¡¨ï¼Œå…è®¸åœ¨çª—å£å†…å»¶è¿Ÿè¡¥é½ï¼›</li>
<li><strong>å¯é‡å»ºè¡¨</strong>ï¼šç¼“å­˜ã€ç´¢å¼•ã€èšåˆä¸­é—´è¡¨ï¼Œå…è®¸é‡åˆ·é‡ç®—ã€‚</li>
</ul>
<p>å¯¹è´¦è„šæœ¬å…ˆæŠŠå¼ºä¸€è‡´è¡¨è¦†ç›–ä½ï¼Œå…ˆæŠŠæœ€å¤§çš„é£é™©å…³æ‰ï¼Œå†è°ˆæ‰©é¢ã€‚</p>
<hr/>
<h2 data-id="heading-6">4. å…¨é‡å¯¼å…¥åçš„â€œå¿…åšå››ä»¶äº‹â€ï¼šä»å¿«åˆ°æ…¢é€å±‚åŠ ç </h2>
<p>ä¸‹é¢ä»¥â€œç›®æ ‡åº“è‡ªæ£€â€ä¸ºä¸»æ¥å†™ã€‚æºç«¯å¦‚æœä¹Ÿèƒ½è·‘åŒå£å¾„ SQLï¼Œé‚£å°±æœ€çœå¿ƒï¼šä¸¤è¾¹ç›´æ¥å¯¹è¾“å‡ºï¼›å¦‚æœæºç«¯å£å¾„ä¸æ–¹ä¾¿ç»Ÿä¸€ï¼Œå°±æŠŠæºç«¯ç»“æœè½æ–‡ä»¶ï¼Œå†åšæ¯”å¯¹ã€‚</p>
<h3 data-id="heading-7">4.1 è¡Œæ•°å¯¹è´¦ï¼šå…ˆæŒ‰æ—¶é—´/åˆ†åŒºåˆ†æ®µï¼Œå†æ±‡æ€»</h3>
<p>å¯¹è´¦åˆ«ä¸€ä¸Šæ¥å°± <code>COUNT(*)</code> æ‰“åˆ°åº•ã€‚æ›´ç¨³çš„åšæ³•æ˜¯â€œåˆ†æ®µå¯¹è´¦â€ï¼šå…ˆæŠŠèŒƒå›´åˆ‡ç¢ï¼Œä¸€æ—¦ä¸ä¸€è‡´ï¼Œå®šä½å°±ä¼šéå¸¸å¿«â€”â€”ä¸ç”¨åœ¨å…¨è¡¨é‡Œç›²æ‰¾ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span>
  TO_CHAR(order_time, <span class="hljs-string">'YYYY-MM-DD'</span>) <span class="hljs-keyword">AS</span> d,
  <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> cnt
<span class="hljs-keyword">FROM</span> t_order
<span class="hljs-keyword">WHERE</span> order_time <span class="hljs-operator">&gt;=</span> TO_TIMESTAMP(<span class="hljs-string">'2026-02-01 00:00:00'</span>,<span class="hljs-string">'YYYY-MM-DD HH24:MI:SS'</span>)
  <span class="hljs-keyword">AND</span> order_time <span class="hljs-operator">&lt;</span>  TO_TIMESTAMP(<span class="hljs-string">'2026-03-01 00:00:00'</span>,<span class="hljs-string">'YYYY-MM-DD HH24:MI:SS'</span>)
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> TO_CHAR(order_time, <span class="hljs-string">'YYYY-MM-DD'</span>)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> d;
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6df81600137048b4afc657dfee6d6904~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771116079&amp;x-signature=Kij2Bo0FJz5wK%2BwaW1olKQ5UkBA%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚æœä½ æŒ‰æœˆ/æŒ‰å¤©åˆ†åŒºï¼Œè¿™æ¡ SQL çš„è¾“å‡ºå°±æ˜¯æœ€çœå¿ƒçš„â€œå®šä½å™¨â€ï¼šå“ªä¸€å¤©å¯¹ä¸ä¸Šï¼Œå…ˆæŠŠé‚£ä¸€å¤©çš„å¯¼å…¥æ—¥å¿—å’Œå¢é‡å›æ”¾ç›¯ä½ï¼Œæ•ˆç‡ä¼šé«˜å¾ˆå¤šã€‚</p>
<h3 data-id="heading-8">4.2 ä¸»é”®å®Œæ•´æ€§ï¼šç©ºå€¼ã€é‡å¤ã€å¼‚å¸¸å¢é•¿</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> pk_null_cnt <span class="hljs-keyword">FROM</span> t_order <span class="hljs-keyword">WHERE</span> order_id <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span>;

<span class="hljs-keyword">SELECT</span> order_id, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> dup_cnt
<span class="hljs-keyword">FROM</span> t_order
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> order_id
<span class="hljs-keyword">HAVING</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-operator">&gt;</span> <span class="hljs-number">1</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> dup_cnt <span class="hljs-keyword">DESC</span>;
</code></pre>
<p>ä¸»é”®é‡å¤ä¸ä¸€å®šä¼šå½“åœºæŠ¥é”™ï¼ˆå–å†³äºä½ å¯¼å…¥æ—¶æœ‰æ²¡æœ‰å…ˆå»ºçº¦æŸã€æœ‰æ²¡æœ‰åšå†²çªå¤„ç†ï¼‰ï¼Œä½†å®ƒå‡ ä¹ä¸€å®šä¼šåœ¨åé¢å˜æˆâ€œæ˜ç»†æŒ‚é”™ä¸»è¡¨â€â€œåŒä¸€è®¢å•è¢«è¦†ç›–â€çš„éšæ€§äº‹æ•…ã€‚</p>
<h3 data-id="heading-9">4.3 å‚ç…§å…³ç³»æ–­é“¾ï¼šæ‰¾â€œå­¤å„¿è¡Œâ€</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> orphan_cnt
<span class="hljs-keyword">FROM</span> t_order_item i
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> t_order o <span class="hljs-keyword">ON</span> o.order_id <span class="hljs-operator">=</span> i.order_id
<span class="hljs-keyword">WHERE</span> o.order_id <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span>;
</code></pre>
<p>å¦‚æœå¤–é”®æ˜¯åœ¨å¯¼å…¥åæ‰å¯ç”¨çš„ï¼Œè¿™ä¸€æ­¥åŸºæœ¬å¿…åšã€‚å‡ºç°æ–­é“¾é€šå¸¸å°±ä¸‰ç§å¯èƒ½ï¼šå¯¼å…¥é¡ºåºä¸å¯¹ã€å¯¼å…¥å¤±è´¥é‡è·‘æ²¡è·‘å…¨ã€æˆ–è€…å¢é‡å›æ”¾æ¼äº†ä¸»è¡¨æ•°æ®ã€‚</p>
<h3 data-id="heading-10">4.4 æ±‡æ€»ä¸€è‡´æ€§ï¼šç”¨â€œå¤šæŒ‡æ ‡â€é™ä½æ¼æ£€æ¦‚ç‡</h3>
<p>åªçœ‹ä¸€ä¸ªæŒ‡æ ‡å¾ˆå®¹æ˜“è¢«â€œæ­£å¥½æŠµæ¶ˆâ€éª—è¿‡ï¼ˆæ¯”å¦‚é‡‘é¢ä¸€å¢ä¸€å‡æ€»å’Œè¿˜ä¸å˜ï¼‰ã€‚æˆ‘æ›´å–œæ¬¢ç”¨ä¸€ä¸ªç»„åˆæ‹³ï¼šæ•°é‡ã€èŒƒå›´ã€æ—¶é—´è¾¹ç•Œã€é‡‘é¢ä¸€èµ·çœ‹ï¼Œæ¼æ£€æ¦‚ç‡ä¼šä½å¾ˆå¤šï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span>
  <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> cnt,
  <span class="hljs-built_in">MIN</span>(order_id) <span class="hljs-keyword">AS</span> min_id,
  <span class="hljs-built_in">MAX</span>(order_id) <span class="hljs-keyword">AS</span> max_id,
  <span class="hljs-built_in">MIN</span>(order_time) <span class="hljs-keyword">AS</span> min_time,
  <span class="hljs-built_in">MAX</span>(order_time) <span class="hljs-keyword">AS</span> max_time,
  <span class="hljs-built_in">SUM</span>(total_amount) <span class="hljs-keyword">AS</span> sum_amount
<span class="hljs-keyword">FROM</span> t_order
<span class="hljs-keyword">WHERE</span> order_time <span class="hljs-operator">&gt;=</span> TO_TIMESTAMP(<span class="hljs-string">'2026-02-01 00:00:00'</span>,<span class="hljs-string">'YYYY-MM-DD HH24:MI:SS'</span>)
  <span class="hljs-keyword">AND</span> order_time <span class="hljs-operator">&lt;</span>  TO_TIMESTAMP(<span class="hljs-string">'2026-03-01 00:00:00'</span>,<span class="hljs-string">'YYYY-MM-DD HH24:MI:SS'</span>);
</code></pre>
<p>å¦‚æœè¿˜æƒ³å†â€œç¡¬æ ¸â€ä¸€ç‚¹ï¼Œæˆ‘ä¼šæŠŠçª—å£å†åˆ‡æˆå¾ˆå¤šæ®µï¼ˆæ¯”å¦‚ 1000 æ®µï¼ŒæŒ‰ä¸»é”®èŒƒå›´æˆ–æ—¶é—´èŒƒå›´éƒ½è¡Œï¼‰ï¼Œé€æ®µè¾“å‡ºåˆ°æ–‡ä»¶ï¼Œå†åšä¸¤ç«¯æ¯”å¯¹ã€‚éº»çƒ¦æ˜¯éº»çƒ¦ç‚¹ï¼Œä½†ç¡®å®šæ€§å¾ˆé«˜ã€‚</p>
<hr/>
<h2 data-id="heading-11">5. å­—ç¬¦é›†ä¸æ’åºè§„åˆ™ï¼šä¸æ˜¯â€œä¹±ç æ‰ç®—é—®é¢˜â€</h2>
<p>å­—ç¬¦é›†è¿™ç±»é—®é¢˜ï¼Œæœ€å‘çš„å¾€å¾€ä¸æ˜¯â€œä¹±ç â€ï¼Œè€Œæ˜¯ä¸‹é¢è¿™ç§æ›´éšè”½çš„å·®å¼‚ï¼š</p>
<ul>
<li>åŒä¸€ä¸ªå­—ç¬¦ä¸²åœ¨ä¸¤ç«¯<strong>å­—èŠ‚é•¿åº¦ä¸åŒ</strong>ï¼ˆå°¤å…¶æ˜¯åŒ…å«è¡¨æƒ…ã€å°‘æ•°æ°‘æ—å­—ç¬¦ã€ç‰¹æ®Šç¬¦å·æ—¶ï¼‰ï¼›</li>
<li>æ¯”è¾ƒä¸æ’åºè§„åˆ™å·®å¼‚å¯¼è‡´â€œåŒæ¡ä»¶æŸ¥è¯¢ç»“æœä¸ä¸€è‡´â€ï¼ˆæ¯”å¦‚æŸäº›å¤§å°å†™/å…¨åŠè§’çš„æ¯”è¾ƒè¡Œä¸ºï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-12">5.1 å¿«é€Ÿæ’æŸ¥ï¼šå­—ç¬¦é•¿åº¦ vs å­—èŠ‚é•¿åº¦åˆ†å¸ƒ</h3>
<p>åœ¨ ksql é‡Œæ‰§è¡Œæ—¶ï¼Œåªå¤åˆ¶ç²˜è´´ SQL æœ¬ä½“å°±è¡Œï¼Œä¸è¦æŠŠ Markdown çš„ <code>sql / </code>ä¹Ÿä¸€èµ·å¸¦è¿›å»ã€‚</p>
<p>ä¸‹é¢ç”¨ç¬¬ 4 ç« å‡ºç°è¿‡çš„ <code>t_order.remark</code> åšæ¼”ç¤ºï¼›ä½ è¦æ£€æŸ¥åˆ«çš„ä¸šåŠ¡è¡¨ä¹Ÿå¾ˆç®€å•ï¼šæŠŠ <code>t_order/remark</code> æ¢æˆä½ è‡ªå·±çš„â€œæ–‡æœ¬åˆ—â€å°±è¡Œã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span>
  <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> total_cnt,
  <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> LENGTH(<span class="hljs-built_in">COALESCE</span>(remark,<span class="hljs-string">''</span>)) <span class="hljs-operator">&lt;&gt;</span> <span class="hljs-keyword">OCTET_LENGTH</span>(<span class="hljs-built_in">COALESCE</span>(remark,<span class="hljs-string">''</span>)) <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span> multibyte_cnt
<span class="hljs-keyword">FROM</span> t_order;
</code></pre>
<p>å†æŠ½å‡ ä¸ªâ€œæœ€å®¹æ˜“å‡ºäº‹â€çš„æ ·æœ¬ï¼ˆé•¿åº¦ç‰¹åˆ«å¤§ã€åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„ï¼‰å‡ºæ¥ï¼Œäººå·¥çœ‹ä¸€çœ¼ï¼Œå¿ƒé‡Œä¼šæ›´è¸å®ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> order_id, remark, LENGTH(remark) <span class="hljs-keyword">AS</span> char_len, <span class="hljs-keyword">OCTET_LENGTH</span>(remark) <span class="hljs-keyword">AS</span> byte_len
<span class="hljs-keyword">FROM</span> t_order
<span class="hljs-keyword">WHERE</span> remark <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-keyword">OCTET_LENGTH</span>(remark) <span class="hljs-keyword">DESC</span>
LIMIT <span class="hljs-number">20</span>;
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55c61199218c4fbd9beb30b5f563e25f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771116079&amp;x-signature=H5xKSYno%2B0AJ2aH%2BKc%2B%2BzaVkJaA%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚æœè¿™é‡Œå·²ç»å‡ºç°æ˜æ˜¾å·®å¼‚ï¼Œæˆ‘ä¼šä¼˜å…ˆå›å¤´æ ¸å¯¹ <code>server_encoding/client_encoding/lc_collate/lc_ctype</code>ï¼šæŠ½å–ç«¯ã€è½åœ°æ–‡ä»¶ã€å¯¼å…¥ç«¯ã€åº”ç”¨è¿æ¥ç«¯ï¼Œä»»ä½•ä¸€ä¸ªç¯èŠ‚ä¸ä¸€è‡´ï¼Œéƒ½å¯èƒ½æŠŠé—®é¢˜â€œå…»å¤§â€ã€‚</p>
<hr/>
<h2 data-id="heading-13">6. æ—¶é—´ã€æ—¶åŒºä¸ç²¾åº¦ï¼šä¸€è‡´æ€§é£é™©é‡Œæœ€éšè”½çš„ä¸€ç±»</h2>
<p>æ—¶é—´å­—æ®µçš„é£é™©æˆ‘ä¸€èˆ¬æŒ‰ä¸‰å±‚æ¥æ‹†ï¼š</p>
<ol>
<li><strong>æ—¶åŒº</strong>ï¼šåŒä¸€æ—¶åˆ»æ˜¾ç¤ºä¸åŒï¼›</li>
<li><strong>æ ¼å¼</strong>ï¼šå­—ç¬¦ä¸²è§£æå£å¾„ä¸åŒï¼›</li>
<li><strong>ç²¾åº¦</strong>ï¼šäºšç§’éƒ¨åˆ†è¢«æˆªæ–­æˆ–å››èˆäº”å…¥ï¼Œå¯¼è‡´â€œåŒç§’å†…é¡ºåºâ€æ”¹å˜ã€‚</li>
</ol>
<h3 data-id="heading-14">6.1 ç”¨ ksql å›ºå®šæ—¶åŒºå£å¾„å¹¶éªŒè¯</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SHOW</span> timezone;
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>;
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c7b6b53c72374d989f226a824e9ceed7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771116079&amp;x-signature=4rAfQqq2I2d7CM5pI6KbDGn9GFE%3D" alt="image.png" loading="lazy"/></p>
<p>åˆ‡æ¢å‰æˆ‘ä¼šæŠŠå¯¹è´¦ä¼šè¯çš„æ—¶åŒºå›ºå®šä½ï¼ˆä½ ä¹Ÿå¯ä»¥åœ¨åº”ç”¨ä¾§ç»Ÿä¸€è®¾ç½®ï¼‰ï¼Œç„¶åæ‹¿åŒä¸€æ‰¹æ ·ä¾‹æ•°æ®å»éªŒè¯â€œæ˜¾ç¤ºä¸€è‡´ã€è®¡ç®—ä¸€è‡´â€ã€‚è¿™ä¸€æ­¥çœ‹èµ·æ¥å•°å—¦ï¼Œä½†èƒ½çœæ‰åé¢ä¸€å¤§å †æ‰¯çš®ã€‚</p>
<h3 data-id="heading-15">6.2 ç²¾åº¦é£é™©çš„å®šä½æ–¹æ³•ï¼šçœ‹â€œåŒç§’å†…æ’åºâ€æ˜¯å¦ç¨³å®š</h3>
<p>åšä¸ªæç®€æµ‹è¯•å°±èƒ½çœ‹å‡ºå¾ˆå¤šé—®é¢˜ï¼šæ’å…¥åŒä¸€ç§’å†…ä¸åŒäºšç§’çš„è®°å½•ï¼Œç„¶åæŒ‰æ—¶é—´æ’åºï¼Œçœ‹é¡ºåºæ˜¯ä¸æ˜¯ä½ ä»¥ä¸ºçš„é‚£æ ·ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> t_ts_probe;
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t_ts_probe(
  id NUMBER(<span class="hljs-number">12</span>,<span class="hljs-number">0</span>) <span class="hljs-keyword">PRIMARY</span> KEY,
  ts <span class="hljs-type">TIMESTAMP</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
);

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_ts_probe <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, TO_TIMESTAMP(<span class="hljs-string">'2026-02-03 10:00:00.123456'</span>,<span class="hljs-string">'YYYY-MM-DD HH24:MI:SS.FF'</span>));
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_ts_probe <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">2</span>, TO_TIMESTAMP(<span class="hljs-string">'2026-02-03 10:00:00.123457'</span>,<span class="hljs-string">'YYYY-MM-DD HH24:MI:SS.FF'</span>));
<span class="hljs-keyword">COMMIT</span>;

<span class="hljs-keyword">SELECT</span> id, TO_CHAR(ts,<span class="hljs-string">'YYYY-MM-DD HH24:MI:SS.FF6'</span>) <span class="hljs-keyword">AS</span> ts_fmt
<span class="hljs-keyword">FROM</span> t_ts_probe
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> ts;
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1d2393d953841e79af19a390343764a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771116079&amp;x-signature=6JcIfUh6peF05g6VjdnZz4thB7Y%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚æœæºç«¯æ—¶é—´ç²¾åº¦æ›´é«˜ï¼Œè€Œç›®æ ‡ç«¯åªèƒ½è½åˆ°æ›´ä½ç²¾åº¦ï¼Œè¿ç§»é˜¶æ®µå°±å¾—æå‰æŠŠç­–ç•¥å®šä¸‹æ¥ï¼šæ˜¯æˆªæ–­è¿˜æ˜¯å››èˆäº”å…¥ï¼Ÿè¦ä¸è¦æŠŠâ€œåŸå§‹æ—¶é—´ä¸²/åŸå§‹åˆ»åº¦â€é¢å¤–è½ä¸€åˆ—ï¼Ÿä¸ç„¶åˆ°äº†å®¡è®¡ã€è¿½è´£æˆ–è€…å¤ç›˜çš„æ—¶å€™ï¼Œå¾ˆå®¹æ˜“å‡ºç°â€œè§£é‡Šä¸æ¸…çš„é¡ºåºå·®å¼‚â€ã€‚</p>
<hr/>
<h2 data-id="heading-16">7. LOBï¼ˆå¤§å¯¹è±¡ï¼‰ï¼šè¿ç§»â€œæˆåŠŸâ€ä¸ç­‰äºâ€œå¯ç”¨â€</h2>
<p>LOB çš„é—®é¢˜é€šå¸¸ä¸æ˜¯â€œæœ‰æ²¡æœ‰å€¼â€ï¼Œè€Œæ˜¯â€œå€¼æ˜¯ä¸æ˜¯è¿˜èƒ½ç”¨â€ï¼š</p>
<ul>
<li>é•¿æ–‡æœ¬å°¾éƒ¨è¢«æˆªæ–­ï¼ˆè‚‰çœ¼ä¸å®¹æ˜“å‘ç°ï¼‰ï¼›</li>
<li>äºŒè¿›åˆ¶å†…å®¹è¢«ç¼–ç è½¬æ¢ç ´åï¼ˆæ–‡ä»¶æ‰“ä¸å¼€ï¼‰ï¼›</li>
<li>å¯¼å…¥è¿‡ç¨‹ä¸­å‘ç”Ÿåˆ†æ®µä¸¢å¤±æˆ–æ‹¼æ¥é¡ºåºé”™è¯¯ã€‚</li>
</ul>
<h3 data-id="heading-17">7.1 å…ˆåšåˆ†å¸ƒæ£€æŸ¥ï¼šé•¿åº¦ã€ç©ºå€¼ã€æç«¯å€¼</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span>
  <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> total_cnt,
  <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> doc <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span> null_cnt,
  <span class="hljs-built_in">MIN</span>(LENGTH(doc)) <span class="hljs-keyword">AS</span> min_len,
  <span class="hljs-built_in">MAX</span>(LENGTH(doc)) <span class="hljs-keyword">AS</span> max_len
<span class="hljs-keyword">FROM</span> t_doc;
</code></pre>
<p>å†æŠŠâ€œæœ€é•¿çš„é‚£ä¸€æ‰¹â€æŠ½å‡ºæ¥äººå·¥éªŒæ”¶ä¸€ä¸‹ï¼ˆè¿™ä¸€æ­¥ç»å¸¸èƒ½æŠ“åˆ°æˆªæ–­é—®é¢˜ï¼‰ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> doc_id, LENGTH(doc) <span class="hljs-keyword">AS</span> len
<span class="hljs-keyword">FROM</span> t_doc
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> LENGTH(doc) <span class="hljs-keyword">DESC</span>
LIMIT <span class="hljs-number">20</span>;
</code></pre>
<h3 data-id="heading-18">7.2 æŠ½æ ·å¯¼å‡º + æ–‡ä»¶å“ˆå¸Œï¼šåœ¨ Windows ä¸Šæœ€ç›´è§‚</h3>
<p>å¯¹å…³é”®æ–‡æ¡£/åˆåŒ/é™„ä»¶è¿™ç±»æ•°æ®ï¼Œæˆ‘æ›´ç›¸ä¿¡â€œå¯¼å‡ºåˆ°æ–‡ä»¶å†æ¯”â€ã€‚æ•°æ®åº“é‡Œçœ‹ä¸€çœ¼å­—æ®µå†…å®¹ï¼Œå¾ˆå¤šæ—¶å€™å¹¶ä¸èƒ½è¯´æ˜å®ƒçœŸçš„å¯ç”¨ã€‚</p>
<p>åœ¨ ksql é‡ŒæŒ‰ä¸šåŠ¡ä¸»é”®æŠ½æ ·å¯¼å‡ºï¼š</p>
<pre><code class="hljs language-sql" lang="sql">\<span class="hljs-keyword">copy</span> (<span class="hljs-keyword">SELECT</span> doc_id, doc <span class="hljs-keyword">FROM</span> t_doc <span class="hljs-keyword">WHERE</span> doc_id <span class="hljs-keyword">IN</span> (<span class="hljs-number">1001</span>,<span class="hljs-number">1002</span>,<span class="hljs-number">1003</span>) <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> doc_id) <span class="hljs-keyword">TO</span> <span class="hljs-string">'D:\\mig_check\\doc_sample.csv'</span> <span class="hljs-keyword">WITH</span> (FORMAT csv, DELIMITER E<span class="hljs-string">'\t'</span>, HEADER <span class="hljs-literal">true</span>)
</code></pre>
<p>ç„¶ååœ¨ PowerShell é‡Œè®¡ç®—æ–‡ä»¶å“ˆå¸Œï¼ˆåŒä¸€æ‰¹æ ·æœ¬ä¸¤ç«¯å¯¼å‡ºåæ¯”å¯¹å“ˆå¸Œå³å¯ï¼‰ï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">certutil -hashfile D:\mig_check\doc_sample.csv SHA256
</code></pre>
<p>æ–‡ä»¶çº§æ ¡éªŒçš„å¥½å¤„åœ¨äºï¼šå®ƒç»•å¼€äº†â€œçœ‹ç€å·®ä¸å¤šâ€çš„ä¸»è§‚åˆ¤æ–­ï¼ŒæŠŠéªŒè¯å˜æˆä¸€æ¡èƒ½å¤ç°ã€èƒ½ç•™æ¡£çš„è¯æ®é“¾ã€‚</p>
<hr/>
<h2 data-id="heading-19">8. å¢é‡åŒæ­¥ï¼šcheckpoint è®¾è®¡ä¸å½“ä¼šä¸¢æ•°ï¼Œä¹Ÿä¼šé‡å¤</h2>
<p>å¢é‡åŒæ­¥é‡Œæœ€å¸¸è§çš„â€œå‘ä¸­å‘â€ï¼Œå°±æ˜¯åªç”¨ä¸€ä¸ªæ—¶é—´å­—æ®µå½“æ–­ç‚¹ï¼š</p>
<ul>
<li>åŒä¸€ç§’å†…å¤šè¡Œå˜æ›´ï¼Œæ–­ç‚¹æ¡ä»¶å†™æˆ <code>&gt;</code> ä¼šä¸¢è¡Œï¼Œå†™æˆ <code>&gt;=</code> ä¼šé‡å¤ï¼›</li>
<li>æ—¶é—´å­—æ®µç²¾åº¦ä¸è¶³æˆ–è¢«æˆªæ–­ï¼Œè¾¹ç•Œæ›´å®¹æ˜“é”™ï¼›</li>
<li>æ›´æ–°ä¹±åºï¼ˆå…ˆå†™åè¡¥ï¼‰å¯¼è‡´â€œæ™šåˆ°çš„æ•°æ®â€è¢«è·³è¿‡ã€‚</li>
</ul>
<h3 data-id="heading-20">8.1 æ¨èçš„æ–­ç‚¹å£å¾„ï¼šæ—¶é—´ + ä¸»é”®åŒæ¡ä»¶</h3>
<p>æ›´ç¨³çš„åšæ³•æ˜¯æŠŠæ–­ç‚¹æ‹†æˆä¸¤éƒ¨åˆ†ï¼š<code>last_ts</code> å’Œ <code>last_pk</code>ã€‚æŠ½å–æ¡ä»¶æŒ‰â€œæ—¶é—´ä¼˜å…ˆã€ä¸»é”®è¡¥é½â€çš„æ€è·¯æ¥å†™ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span>
<span class="hljs-keyword">FROM</span> t_order
<span class="hljs-keyword">WHERE</span> order_time <span class="hljs-operator">&gt;</span>  :last_ts
   <span class="hljs-keyword">OR</span> (order_time <span class="hljs-operator">=</span> :last_ts <span class="hljs-keyword">AND</span> order_id <span class="hljs-operator">&gt;</span> :last_pk)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> order_time, order_id;
</code></pre>
<p>è·‘å®Œä¸€æ‰¹ä»¥åï¼ŒæŠŠæœ€åä¸€è¡Œçš„ <code>order_time/order_id</code> å†™å› <code>mig_checkpoint</code>ï¼ˆå®é™…é¡¹ç›®é‡ŒæŠŠ <code>order_time</code> æ¢æˆä½ çš„å¢é‡æ—¶é—´å­—æ®µå³å¯ï¼‰ã€‚</p>
<h3 data-id="heading-21">8.2 å›æ”¾çª—å£ï¼šç”¨å°æˆæœ¬æ¢ç¡®å®šæ€§</h3>
<p>æˆ‘åŸºæœ¬ä¸ä¼šè®©å¢é‡æ–­ç‚¹â€œåˆšå¥½å¡è¾¹ç•Œâ€ã€‚æ›´ç¨³çš„åŠæ³•æ˜¯åšå›æ”¾çª—å£ï¼šæ¯”å¦‚æ¯æ¬¡éƒ½å›æ”¾æœ€è¿‘ 5 åˆ†é’Ÿçš„æ•°æ®ï¼Œç›®æ ‡ç«¯å†ç”¨ä¸»é”®åšå¹‚ç­‰è½åº“ï¼ˆåŒä¸»é”®æ›´æ–°è¦†ç›–æˆ–åˆå¹¶ï¼‰ã€‚<br/>
è¿™ä¹ˆåšçš„å¥½å¤„å¾ˆç›´æ¥ï¼šå°±ç®—å‡ºç°ä¹±åºæˆ–å»¶è¿Ÿå†™å…¥ï¼Œä¹Ÿèƒ½åœ¨ä¸‹ä¸€è½®è¢«å…œä½ã€‚</p>
<p>åˆ‡æ¢æ—¥å‰ï¼Œæˆ‘ä¼šä¸“é—¨åšä¸€è½®â€œè¾¹ç•Œå‹æµ‹â€ï¼Œä¸“æ‰“è¿™äº›æœ€å®¹æ˜“ç¿»è½¦çš„åœºæ™¯ï¼š</p>
<ul>
<li>è¿ç»­åˆ¶é€ åŒä¸€ç§’å†… 1000 æ¡å˜æ›´ï¼›</li>
<li>åˆ¶é€ è·¨åˆ†é’Ÿã€è·¨å°æ—¶çš„è¡¥å†™ï¼›</li>
<li>åˆ¶é€ å›æ»šå†æäº¤çš„é‡å¤å˜æ›´ï¼›</li>
<li>éªŒè¯ç›®æ ‡ç«¯æœ€ç»ˆçŠ¶æ€ä¸æºç«¯ä¸€è‡´ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-22">9. ä¸€å¼ å›¾ï¼šæˆ‘å¸¸ç”¨çš„â€œåˆ‡æ¢æ—¥å¯¹è´¦é—­ç¯â€</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7750f6cc7e445ec9b556bc1ccf9a278~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771116079&amp;x-signature=jLkwaY%2FwgbtNrWEvMnwbG65nMZg%3D" alt="811d316e38a5323be56d9b27e1c8f589.png" loading="lazy"/></p>
<p>è¿™å¥—æµç¨‹çš„é‡ç‚¹ä¸åœ¨â€œæ­¥éª¤å¤šâ€ï¼Œè€Œåœ¨äºæ¯ä¸€æ­¥éƒ½æœ‰å¯æ‰§è¡Œçš„éªŒè¯è¾“å‡ºï¼šå‡ºäº†é—®é¢˜èƒ½å®šä½ã€èƒ½é‡è·‘ï¼Œå®åœ¨ä¸è¡Œè¿˜èƒ½å›æ»šã€‚</p>
<hr/>
<h2 data-id="heading-23">10. éªŒæ”¶æ¸…å•</h2>













































<table><thead><tr><th>ç±»åˆ«</th><th>å¿…éªŒé¡¹</th><th>é€šè¿‡æ ‡å‡†ï¼ˆç¤ºä¾‹ï¼‰</th></tr></thead><tbody><tr><td>ä¼šè¯åŸºçº¿</td><td>ç¼–ç /æ’åºè§„åˆ™/æ—¶åŒº</td><td>è¿ç§»é“¾è·¯æ‰€æœ‰ç¯èŠ‚ä¸€è‡´</td></tr><tr><td>è¡Œçº§å®Œæ•´æ€§</td><td>åˆ†æ®µè¡Œæ•°å¯¹è´¦</td><td>å¼ºä¸€è‡´è¡¨ 100% å¯¹é½</td></tr><tr><td>çº¦æŸä¸€è‡´æ€§</td><td>ä¸»é”®/å”¯ä¸€/å¤–é”®</td><td>å¯ç”¨æˆåŠŸï¼Œå­¤å„¿è¡Œ=0ï¼Œé‡å¤=0</td></tr><tr><td>æ±‡æ€»ä¸€è‡´æ€§</td><td>å¤šæŒ‡æ ‡æ±‡æ€»</td><td>cnt/min/max/sum å…¨ä¸€è‡´</td></tr><tr><td>LOB å¯ç”¨æ€§</td><td>æŠ½æ ·å¯¼å‡ºæ ¡éªŒ</td><td>æ–‡ä»¶å¯æ‰“å¼€ï¼Œå“ˆå¸Œä¸€è‡´</td></tr><tr><td>å¢é‡å¯é æ€§</td><td>checkpoint + å›æ”¾çª—å£</td><td>æ— ä¸¢æ•°ï¼Œæ— é‡å¤ï¼Œæœ€ç»ˆæ€ä¸€è‡´</td></tr><tr><td>åˆ‡æ¢å¯å›æ»š</td><td>å›æ»šè·¯å¾„å¯æ¼”ç»ƒ</td><td>å›åˆ‡è„šæœ¬å¯æ‰§è¡Œã€è€—æ—¶å¯æ¥å—</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hibernateï¼ˆ91ï¼‰å¦‚ä½•åœ¨æ•°æ®åº“å›å½’æµ‹è¯•ä¸­ä½¿ç”¨Hibernateï¼Ÿ]]></title>    <link>https://juejin.cn/post/7603649945978617875</link>    <guid>https://juejin.cn/post/7603649945978617875</guid>    <pubDate>2026-02-07T23:16:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603649945978617875" data-draft-id="7603644943351316486" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hibernateï¼ˆ91ï¼‰å¦‚ä½•åœ¨æ•°æ®åº“å›å½’æµ‹è¯•ä¸­ä½¿ç”¨Hibernateï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-07T23:16:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hibernateï¼ˆ91ï¼‰å¦‚ä½•åœ¨æ•°æ®åº“å›å½’æµ‹è¯•ä¸­ä½¿ç”¨Hibernateï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T23:16:11.000Z" title="Sat Feb 07 2026 23:16:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body cache result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ•°æ®åº“å›å½’æµ‹è¯•ç”¨æ¥ç¡®ä¿å¯¹æ•°æ®åº“çš„æ›´æ”¹ä¸ä¼šç ´åç°æœ‰åŠŸèƒ½ã€‚è¿™å¯ä»¥åŒ…æ‹¬éªŒè¯æ’å…¥ã€æ›´æ–°ã€åˆ é™¤æ“ä½œä»¥åŠé«˜çº§æŸ¥è¯¢ç­‰ã€‚ä½¿ç”¨Hibernateè¿›è¡Œæ•°æ®åº“å›å½’æµ‹è¯•ï¼Œå¯ä»¥ç¡®ä¿ORMå±‚çš„æ­£ç¡®æ€§ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªè¯¦ç»†çš„ç¤ºä¾‹ï¼Œç»“åˆä»£ç è®²è§£å¦‚ä½•åœ¨æ•°æ®åº“å›å½’æµ‹è¯•ä¸­ä½¿ç”¨Hibernateï¼ŒåŒ…æ‹¬æ•°æ®åº“é…ç½®ã€ç¼–å†™å®ä½“ç±»ã€è®¾ç½®æ•°æ®è®¿é—®å¯¹è±¡ (DAO)ã€ç¼–å†™å›å½’æµ‹è¯•è„šæœ¬ã€‚</p>
<h3 data-id="heading-0">å‰ææ¡ä»¶</h3>
<ul>
<li>ä½¿ç”¨MySQLä½œä¸ºæ•°æ®åº“ã€‚</li>
<li>ä½¿ç”¨Gradleä½œä¸ºæ„å»ºå·¥å…·ã€‚</li>
<li>ä½¿ç”¨JUnitè¿›è¡Œå›å½’æµ‹è¯•ã€‚</li>
<li>ä½¿ç”¨Hibernateè¿›è¡ŒORMæ“ä½œã€‚</li>
</ul>
<h3 data-id="heading-1">1. è®¾ç½®Hibernateé…ç½®</h3>
<p>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªHibernateé…ç½®æ–‡ä»¶ <code>hibernate.cfg.xml</code>ï¼Œç”¨äºè¿æ¥æ•°æ®åº“ã€‚</p>
<h4 data-id="heading-2"><code>hibernate.cfg.xml</code></h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span>?&gt;</span>
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">hibernate-configuration</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span> <span class="hljs-string">"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">hibernate-configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">session-factory</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/regression_test_db<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.username"</span>&gt;</span>db_user<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.password"</span>&gt;</span>db_password<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.hbm2ddl.auto"</span>&gt;</span>update<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.show_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">session-factory</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">hibernate-configuration</span>&gt;</span>
</code></pre>
<h3 data-id="heading-3">2. åˆ›å»ºå®ä½“ç±»</h3>
<p>å®šä¹‰ä¸€ä¸ªç®€å•çš„å®ä½“ç±»æ¥è¡¨ç¤ºæ•°æ®åº“è¡¨ä¸­çš„æ•°æ®ã€‚</p>
<h4 data-id="heading-4"><code>User.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> javax.persistence.*;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "users")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> String email;

    <span class="hljs-comment">// Getters and setters</span>
}
</code></pre>
<h3 data-id="heading-5">3. é…ç½®Gradle</h3>
<p>åœ¨Gradleæ„å»ºè„šæœ¬ä¸­æ·»åŠ Hibernateå’ŒJUnitä¾èµ–ã€‚</p>
<h4 data-id="heading-6"><code>build.gradle</code></h4>
<pre><code class="hljs language-groovy" lang="groovy">plugins {
    id 'java'
}

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.hibernate:hibernate-core:5.6.5.Final'
    implementation 'mysql:mysql-connector-java:8.0.27'
    testImplementation 'org.junit.jupiter:junit-jupiter:5.8.2'
}

test {
    useJUnitPlatform()
}
</code></pre>
<h3 data-id="heading-7">4. ç¼–å†™æ•°æ®è®¿é—®å¯¹è±¡ï¼ˆDAOï¼‰</h3>
<p>ç¼–å†™ä¸€ä¸ªæ•°æ®è®¿é—®å¯¹è±¡ç±»ï¼Œç”¨äºæ‰§è¡Œæ•°æ®åº“æ“ä½œã€‚</p>
<h4 data-id="heading-8"><code>UserDAO.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.Transaction;
<span class="hljs-keyword">import</span> org.hibernate.cfg.Configuration;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserDAO</span> {
    <span class="hljs-keyword">private</span> SessionFactory sessionFactory;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserDAO</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Configuration</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>().configure(<span class="hljs-string">"hibernate.cfg.xml"</span>);
        sessionFactory = config.buildSessionFactory();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">saveUser</span><span class="hljs-params">(User user)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();
        session.save(user);
        transaction.commit();
        session.close();
    }

    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">getUserById</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> session.get(User.class, id);
        session.close();
        <span class="hljs-keyword">return</span> user;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateUser</span><span class="hljs-params">(User user)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();
        session.update(user);
        transaction.commit();
        session.close();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteUser</span><span class="hljs-params">(User user)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();
        session.delete(user);
        transaction.commit();
        session.close();
    }

    <span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">findAllUsers</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        List&lt;User&gt; users = session.createQuery(<span class="hljs-string">"FROM User"</span>, User.class).list();
        session.close();
        <span class="hljs-keyword">return</span> users;
    }
}
</code></pre>
<h3 data-id="heading-9">5. ç¼–å†™å›å½’æµ‹è¯•è„šæœ¬</h3>
<p>ä½¿ç”¨JUnitç¼–å†™å›å½’æµ‹è¯•è„šæœ¬ï¼ŒéªŒè¯æ’å…¥ã€æ›´æ–°ã€åˆ é™¤ç­‰æ“ä½œã€‚</p>
<h4 data-id="heading-10"><code>UserDAOTest.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.junit.jupiter.api.*;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.jupiter.api.Assertions.*;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserDAOTest</span> {
    <span class="hljs-keyword">private</span> UserDAO userDAO;

    <span class="hljs-meta">@BeforeEach</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setUp</span><span class="hljs-params">()</span> {
        userDAO = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserDAO</span>();
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testSaveAndGetUser</span><span class="hljs-params">()</span> {
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();
        user.setName(<span class="hljs-string">"John Doe"</span>);
        user.setEmail(<span class="hljs-string">"john.doe@example.com"</span>);
        userDAO.saveUser(user);

        <span class="hljs-type">User</span> <span class="hljs-variable">retrievedUser</span> <span class="hljs-operator">=</span> userDAO.getUserById(user.getId());
        assertNotNull(retrievedUser);
        assertEquals(<span class="hljs-string">"John Doe"</span>, retrievedUser.getName());
        assertEquals(<span class="hljs-string">"john.doe@example.com"</span>, retrievedUser.getEmail());
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testUpdateUser</span><span class="hljs-params">()</span> {
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();
        user.setName(<span class="hljs-string">"Jane Doe"</span>);
        user.setEmail(<span class="hljs-string">"jane.doe@example.com"</span>);
        userDAO.saveUser(user);

        user.setName(<span class="hljs-string">"Jane Smith"</span>);
        userDAO.updateUser(user);

        <span class="hljs-type">User</span> <span class="hljs-variable">updatedUser</span> <span class="hljs-operator">=</span> userDAO.getUserById(user.getId());
        assertEquals(<span class="hljs-string">"Jane Smith"</span>, updatedUser.getName());
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testDeleteUser</span><span class="hljs-params">()</span> {
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();
        user.setName(<span class="hljs-string">"Mark Doe"</span>);
        user.setEmail(<span class="hljs-string">"mark.doe@example.com"</span>);
        userDAO.saveUser(user);

        userDAO.deleteUser(user);
        <span class="hljs-type">User</span> <span class="hljs-variable">deletedUser</span> <span class="hljs-operator">=</span> userDAO.getUserById(user.getId());
        assertNull(deletedUser);
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testFindAllUsers</span><span class="hljs-params">()</span> {
        <span class="hljs-type">User</span> <span class="hljs-variable">user1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();
        user1.setName(<span class="hljs-string">"User1"</span>);
        user1.setEmail(<span class="hljs-string">"user1@example.com"</span>);
        userDAO.saveUser(user1);

        <span class="hljs-type">User</span> <span class="hljs-variable">user2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();
        user2.setName(<span class="hljs-string">"User2"</span>);
        user2.setEmail(<span class="hljs-string">"user2@example.com"</span>);
        userDAO.saveUser(user2);

        List&lt;User&gt; users = userDAO.findAllUsers();
        assertTrue(users.size() &gt;= <span class="hljs-number">2</span>);
    }
}
</code></pre>
<h3 data-id="heading-11">ä¾‹å­è§£é‡Š</h3>
<ol>
<li><strong>Hibernateé…ç½®ï¼š</strong> é…ç½®ä¸€ä¸ªHibernateé…ç½®æ–‡ä»¶ï¼Œç”¨äºè¿æ¥æ•°æ®åº“ã€‚</li>
<li><strong>å®ä½“ç±»ï¼š</strong> åˆ›å»ºä¸€ä¸ªç®€å•çš„å®ä½“ç±»æ¥è¡¨ç¤ºæ•°æ®åº“è¡¨ä¸­çš„æ•°æ®ã€‚</li>
<li><strong>Gradleé…ç½®ï¼š</strong> åœ¨Gradleæ„å»ºè„šæœ¬ä¸­æ·»åŠ Hibernateå’ŒJUnitä¾èµ–ã€‚</li>
<li><strong>æ•°æ®è®¿é—®å¯¹è±¡ï¼ˆDAOï¼‰ï¼š</strong> ç¼–å†™ä¸€ä¸ªæ•°æ®è®¿é—®å¯¹è±¡ç±»ï¼Œç”¨äºæ‰§è¡Œæ•°æ®åº“æ“ä½œã€‚åŒ…æ‹¬ä¿å­˜ã€è·å–ã€æ›´æ–°ã€åˆ é™¤å’ŒæŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·çš„æ–¹æ³•ã€‚</li>
<li><strong>å›å½’æµ‹è¯•è„šæœ¬ï¼š</strong> ä½¿ç”¨JUnitç¼–å†™å›å½’æµ‹è¯•è„šæœ¬ï¼ŒéªŒè¯å„ç§æ•°æ®åº“æ“ä½œçš„æ­£ç¡®æ€§ã€‚æµ‹è¯•è„šæœ¬åŒ…æ‹¬ï¼š
<ul>
<li>ä¿å­˜å’Œè·å–ç”¨æˆ·ï¼šéªŒè¯æ’å…¥æ“ä½œå’Œé€šè¿‡IDè·å–ç”¨æˆ·çš„æ­£ç¡®æ€§ã€‚</li>
<li>æ›´æ–°ç”¨æˆ·ï¼šéªŒè¯æ›´æ–°æ“ä½œçš„æ­£ç¡®æ€§ã€‚</li>
<li>åˆ é™¤ç”¨æˆ·ï¼šéªŒè¯åˆ é™¤æ“ä½œçš„æ­£ç¡®æ€§ã€‚</li>
<li>æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·ï¼šéªŒè¯æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·çš„æ­£ç¡®æ€§ã€‚</li>
</ul>
</li>
</ol>
<p>é€šè¿‡ä»¥ä¸Šé…ç½®å’Œä»£ç ç¤ºä¾‹ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•åœ¨æ•°æ®åº“å›å½’æµ‹è¯•ä¸­ä½¿ç”¨Hibernateã€‚è¿™åŒ…æ‹¬é…ç½®Hibernateã€å®šä¹‰å®ä½“ç±»ã€ç¼–å†™æ•°æ®è®¿é—®å¯¹è±¡ã€ç¼–å†™å›å½’æµ‹è¯•è„šæœ¬ï¼Œä»¥åŠä½¿ç”¨JUnitè¿è¡Œæµ‹è¯•ã€‚æ­¤æµç¨‹å¸®åŠ©ç¡®ä¿æ•°æ®åº“çš„æ›´æ”¹ä¸ä¼šç ´åç°æœ‰åŠŸèƒ½ï¼Œä¿è¯ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MongoDBï¼ˆ1ï¼‰ä»€ä¹ˆæ˜¯MongoDBï¼Ÿ]]></title>    <link>https://juejin.cn/post/7603643044034494500</link>    <guid>https://juejin.cn/post/7603643044034494500</guid>    <pubDate>2026-02-07T23:17:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603643044034494500" data-draft-id="7603656494905360390" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MongoDBï¼ˆ1ï¼‰ä»€ä¹ˆæ˜¯MongoDBï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-07T23:17:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MongoDBï¼ˆ1ï¼‰ä»€ä¹ˆæ˜¯MongoDBï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T23:17:25.000Z" title="Sat Feb 07 2026 23:17:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>MongoDBæ˜¯ä¸€ç§å¼€æºçš„NoSQLæ•°æ®åº“ï¼Œä½¿ç”¨æ–‡æ¡£å‹å­˜å‚¨æ•°æ®æ ¼å¼ï¼ˆç±»ä¼¼äºJSONçš„BSONæ ¼å¼ï¼‰ï¼Œä»¥è§£å†³ä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“åœ¨å¤„ç†å¤§æ•°æ®å’Œé«˜å¹¶å‘åœºæ™¯ä¸­çš„å±€é™æ€§ã€‚</p>
<h3 data-id="heading-0">MongoDBçš„ç‰¹ç‚¹</h3>
<ol>
<li><strong>æ–‡æ¡£å­˜å‚¨</strong>ï¼šä½¿ç”¨ç±»ä¼¼JSONçš„BSONæ ¼å¼å­˜å‚¨æ•°æ®ã€‚</li>
<li><strong>çµæ´»çš„æ¨¡å¼</strong>ï¼šæ— éœ€é¢„å®šä¹‰è¡¨ç»“æ„ï¼Œæ”¯æŒåŠ¨æ€æ¨¡å¼ã€‚</li>
<li><strong>é«˜å¯ç”¨æ€§</strong>ï¼šé€šè¿‡å‰¯æœ¬é›†å®ç°æ•°æ®çš„å†—ä½™å’Œè‡ªåŠ¨æ•…éšœæ¢å¤ã€‚</li>
<li><strong>æ°´å¹³æ‰©å±•</strong>ï¼šé€šè¿‡åˆ†ç‰‡æŠ€æœ¯å®ç°æ•°æ®åˆ†å¸ƒåˆ°å¤šä¸ªèŠ‚ç‚¹ã€‚</li>
<li><strong>å¼ºå¤§çš„æŸ¥è¯¢èƒ½åŠ›</strong>ï¼šæ”¯æŒä¸°å¯Œçš„æŸ¥è¯¢è¯­æ³•å’ŒèšåˆåŠŸèƒ½ã€‚</li>
</ol>
<h3 data-id="heading-1">å®‰è£…ä¸é…ç½®</h3>
<h4 data-id="heading-2">1. å®‰è£… MongoDB</h4>
<p>å¯ä»¥é€šè¿‡åŒ…ç®¡ç†å™¨æˆ–è€…ä¸‹è½½å‹ç¼©åŒ…çš„æ–¹å¼å®‰è£…MongoDBã€‚åœ¨Ubuntuä¸Šï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo apt-get update
sudo apt-get install -y mongodb
</code></pre>
<h4 data-id="heading-3">2. å¯åŠ¨å’Œåœæ­¢ MongoDB</h4>
<p>å¯åŠ¨MongoDBæœåŠ¡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo service mongodb start
</code></pre>
<p>åœæ­¢MongoDBæœåŠ¡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo service mongodb stop
</code></pre>
<h3 data-id="heading-4">åŸºæœ¬æ“ä½œç¤ºä¾‹</h3>
<h4 data-id="heading-5">1. åˆ›å»ºæ•°æ®åº“å’Œé›†åˆ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è¿æ¥ MongoDB</span>
<span class="hljs-keyword">const</span> { <span class="hljs-title class_">MongoClient</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mongodb'</span>);
<span class="hljs-keyword">const</span> url = <span class="hljs-string">'mongodb://localhost:27017'</span>;
<span class="hljs-keyword">const</span> client = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MongoClient</span>(url);

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">run</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">connect</span>();
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Connected to MongoDB"</span>);

        <span class="hljs-keyword">const</span> db = client.<span class="hljs-title function_">db</span>(<span class="hljs-string">'mydatabase'</span>); <span class="hljs-comment">// åˆ›å»ºæˆ–é€‰æ‹©æ•°æ®åº“</span>
        <span class="hljs-keyword">const</span> collection = db.<span class="hljs-title function_">collection</span>(<span class="hljs-string">'users'</span>); <span class="hljs-comment">// åˆ›å»ºæˆ–é€‰æ‹©é›†åˆ</span>

        <span class="hljs-comment">// æ’å…¥æ–‡æ¡£</span>
        <span class="hljs-keyword">const</span> insertResult = <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">insertOne</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"John Doe"</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"john.doe@example.com"</span> });
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Inserted document:'</span>, insertResult.<span class="hljs-property">ops</span>[<span class="hljs-number">0</span>]);

        <span class="hljs-comment">// æŸ¥è¯¢æ–‡æ¡£</span>
        <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">findOne</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"John Doe"</span> });
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Found document:'</span>, user);

        <span class="hljs-comment">// æ›´æ–°æ–‡æ¡£</span>
        <span class="hljs-keyword">const</span> updateResult = <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">updateOne</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"John Doe"</span> }, { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">email</span>: <span class="hljs-string">"john.doe@newdomain.com"</span> } });
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Updated document count:'</span>, updateResult.<span class="hljs-property">modifiedCount</span>);

        <span class="hljs-comment">// åˆ é™¤æ–‡æ¡£</span>
        <span class="hljs-keyword">const</span> deleteResult = <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">deleteOne</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"John Doe"</span> });
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Deleted document count:'</span>, deleteResult.<span class="hljs-property">deletedCount</span>);
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">close</span>();
    }
}

<span class="hljs-title function_">run</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">dir</span>);
</code></pre>
<h4 data-id="heading-6">2. ä½¿ç”¨ç´¢å¼•</h4>
<p>ç´¢å¼•å¯¹äºæé«˜æŸ¥è¯¢æ€§èƒ½éå¸¸é‡è¦ã€‚ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºå¦‚ä½•åˆ›å»ºç´¢å¼•ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createIndex</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> { <span class="hljs-title class_">MongoClient</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mongodb'</span>);
    <span class="hljs-keyword">const</span> url = <span class="hljs-string">'mongodb://localhost:27017'</span>;
    <span class="hljs-keyword">const</span> client = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MongoClient</span>(url);

    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">connect</span>();
        <span class="hljs-keyword">const</span> db = client.<span class="hljs-title function_">db</span>(<span class="hljs-string">'mydatabase'</span>);
        <span class="hljs-keyword">const</span> collection = db.<span class="hljs-title function_">collection</span>(<span class="hljs-string">'users'</span>);

        <span class="hljs-comment">// åˆ›å»ºç´¢å¼•</span>
        <span class="hljs-keyword">const</span> indexName = <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">createIndex</span>({ <span class="hljs-attr">email</span>: <span class="hljs-number">1</span> });
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Created index:'</span>, indexName);

        <span class="hljs-comment">// æŸ¥è¯¢ä½¿ç”¨ç´¢å¼•</span>
        <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">findOne</span>({ <span class="hljs-attr">email</span>: <span class="hljs-string">"john.doe@newdomain.com"</span> });
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Found document using index:'</span>, user);
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">close</span>();
    }
}

<span class="hljs-title function_">createIndex</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">dir</span>);
</code></pre>
<h4 data-id="heading-7">3. èšåˆæ“ä½œ</h4>
<p>èšåˆæ“ä½œç”¨äºå¤„ç†æ•°æ®å¹¶è¿”å›è®¡ç®—ç»“æœã€‚ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºå¦‚ä½•è¿›è¡Œèšåˆæ“ä½œï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">aggregationExample</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> { <span class="hljs-title class_">MongoClient</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mongodb'</span>);
    <span class="hljs-keyword">const</span> url = <span class="hljs-string">'mongodb://localhost:27017'</span>;
    <span class="hljs-keyword">const</span> client = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MongoClient</span>(url);

    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">connect</span>();
        <span class="hljs-keyword">const</span> db = client.<span class="hljs-title function_">db</span>(<span class="hljs-string">'mydatabase'</span>);
        <span class="hljs-keyword">const</span> collection = db.<span class="hljs-title function_">collection</span>(<span class="hljs-string">'orders'</span>);

        <span class="hljs-comment">// æ’å…¥å¤šä¸ªæ–‡æ¡£</span>
        <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">insertMany</span>([
            { <span class="hljs-attr">product</span>: <span class="hljs-string">"Apple"</span>, <span class="hljs-attr">quantity</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">2.5</span> },
            { <span class="hljs-attr">product</span>: <span class="hljs-string">"Banana"</span>, <span class="hljs-attr">quantity</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">1.2</span> },
            { <span class="hljs-attr">product</span>: <span class="hljs-string">"Orange"</span>, <span class="hljs-attr">quantity</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">3.0</span> }
        ]);

        <span class="hljs-comment">// ä½¿ç”¨èšåˆç®¡é“è®¡ç®—æ€»é”€å”®é¢</span>
        <span class="hljs-keyword">const</span> aggregationPipeline = [
            { <span class="hljs-attr">$group</span>: { <span class="hljs-attr">_id</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">total</span>: { <span class="hljs-attr">$sum</span>: { <span class="hljs-attr">$multiply</span>: [<span class="hljs-string">"$quantity"</span>, <span class="hljs-string">"$price"</span>] } } } }
        ];

        <span class="hljs-keyword">const</span> aggResult = <span class="hljs-keyword">await</span> collection.<span class="hljs-title function_">aggregate</span>(aggregationPipeline).<span class="hljs-title function_">toArray</span>();
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Total sales:'</span>, aggResult[<span class="hljs-number">0</span>].<span class="hljs-property">total</span>);
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">close</span>();
    }
}

<span class="hljs-title function_">aggregationExample</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">dir</span>);
</code></pre>
<h3 data-id="heading-8">é«˜çº§åŠŸèƒ½</h3>
<h4 data-id="heading-9">å‰¯æœ¬é›†</h4>
<p>å‰¯æœ¬é›†ï¼ˆReplica Setï¼‰æ˜¯MongoDBé«˜å¯ç”¨æ€§çš„å®ç°æ–¹å¼ã€‚å®ƒç”±ä¸€ä¸ªä¸»èŠ‚ç‚¹ï¼ˆPrimary Nodeï¼‰å’Œå¤šä¸ªä»èŠ‚ç‚¹ï¼ˆSecondary Nodesï¼‰ç»„æˆã€‚</p>
<p>è¦é…ç½®å‰¯æœ¬é›†ï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">replication:</span>
  <span class="hljs-attr">replSetName:</span> <span class="hljs-string">"rs0"</span>
</code></pre>
<p>ç„¶åå¯åŠ¨MongoDBå®ä¾‹å¹¶åˆå§‹åŒ–å‰¯æœ¬é›†ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">rs.<span class="hljs-title function_">initiate</span>()
</code></pre>
<h4 data-id="heading-10">åˆ†ç‰‡</h4>
<p>åˆ†ç‰‡ï¼ˆShardingï¼‰ç”¨äºå¤„ç†å¤§é‡æ•°æ®ï¼Œå°†æ•°æ®åˆ†å¸ƒåœ¨å¤šä¸ªæœåŠ¡å™¨ä¸Šã€‚ä»¥ä¸‹æ˜¯åˆ†ç‰‡çš„åŸºæœ¬æ­¥éª¤ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¯ç”¨åˆ†ç‰‡</span>
sh.<span class="hljs-title function_">enableSharding</span>(<span class="hljs-string">"mydatabase"</span>)

<span class="hljs-comment">// ä¸ºé›†åˆè®¾ç½®åˆ†ç‰‡é”®</span>
sh.<span class="hljs-title function_">shardCollection</span>(<span class="hljs-string">"mydatabase.users"</span>, { <span class="hljs-string">"_id"</span>: <span class="hljs-number">1</span> })
</code></pre>
<h3 data-id="heading-11">æ€»ç»“</h3>
<p>MongoDBæ˜¯ä¸€ç§çµæ´»ã€å¯æ‰©å±•çš„NoSQLæ•°æ®åº“ï¼Œé€‚ç”¨äºå¤„ç†å¤§è§„æ¨¡æ•°æ®å’Œé«˜å¹¶å‘åº”ç”¨ã€‚é€šè¿‡ä¸°å¯Œçš„APIå’Œå„ç§é«˜çº§ç‰¹æ€§ï¼Œå¦‚å‰¯æœ¬é›†å’Œåˆ†ç‰‡ï¼ŒMongoDBæä¾›äº†å¼ºå¤§çš„æ•°æ®å­˜å‚¨å’Œç®¡ç†èƒ½åŠ›ã€‚ä¸Šè¿°ç¤ºä¾‹å±•ç¤ºäº†MongoDBçš„åŸºæœ¬æ“ä½œã€ç´¢å¼•ä½¿ç”¨ã€èšåˆæ“ä½œä»¥åŠé«˜çº§åŠŸèƒ½çš„é…ç½®ï¼Œæ˜¯ç†è§£å’ŒæŒæ¡MongoDBçš„è‰¯å¥½èµ·ç‚¹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥Vue 3å“åº”å¼ç³»ç»Ÿï¼šä¸ºä»€ä¹ˆåµŒå¥—å¯¹è±¡ä¿®æ”¹åç•Œé¢ä¸æ›´æ–°ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7603771025855283251</link>    <guid>https://juejin.cn/post/7603771025855283251</guid>    <pubDate>2026-02-07T17:20:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603771025855283251" data-draft-id="7603651855236104201" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥Vue 3å“åº”å¼ç³»ç»Ÿï¼šä¸ºä»€ä¹ˆåµŒå¥—å¯¹è±¡ä¿®æ”¹åç•Œé¢ä¸æ›´æ–°ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Vue.js"/> <meta itemprop="datePublished" content="2026-02-07T17:20:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="iDaoæŠ€æœ¯é­”æ–¹"/> <meta itemprop="url" content="https://juejin.cn/user/166781496080782"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥Vue 3å“åº”å¼ç³»ç»Ÿï¼šä¸ºä»€ä¹ˆåµŒå¥—å¯¹è±¡ä¿®æ”¹åç•Œé¢ä¸æ›´æ–°ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/166781496080782/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    iDaoæŠ€æœ¯é­”æ–¹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T17:20:39.000Z" title="Sat Feb 07 2026 17:20:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>ä¸€å¥è¯ç®€ä»‹</strong>ï¼šVue 3ç”¨Proxyé‡æ„äº†å“åº”å¼ç³»ç»Ÿï¼Œä½†åµŒå¥—å¯¹è±¡çš„"æ·±å±‚å“åº”"èƒŒåè—ç€5ä¸ªè‡´å‘½é™·é˜±ã€‚æœ¬æ–‡ä»æºç çº§å‰–æå“åº”æ€§ä¸¢å¤±çš„æ ¹æœ¬åŸå› ï¼Œå¹¶æä¾›5ç§å®æˆ˜è§£å†³æ–¹æ¡ˆã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ğŸ“‹ ç›®å½•</h2>
<ul>
<li><a href="#1-%E8%83%8C%E6%99%AF%E4%B8%80%E4%B8%AA%E8%AE%A9%E4%BA%BA%E5%B4%A9%E6%BA%83%E7%9A%84bug" title="#1-%E8%83%8C%E6%99%AF%E4%B8%80%E4%B8%AA%E8%AE%A9%E4%BA%BA%E5%B4%A9%E6%BA%83%E7%9A%84bug">1. èƒŒæ™¯ï¼šä¸€ä¸ªè®©äººå´©æºƒçš„Bug</a></li>
<li><a href="#2-%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86proxy%E7%9A%84%E4%BB%A3%E7%90%86%E9%99%B7%E9%98%B1" title="#2-%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86proxy%E7%9A%84%E4%BB%A3%E7%90%86%E9%99%B7%E9%98%B1">2. æ ¸å¿ƒåŸç†ï¼šProxyçš„"ä»£ç†é™·é˜±"</a></li>
<li><a href="#3-5%E7%A7%8D%E5%B8%B8%E8%A7%81%E9%99%B7%E9%98%B1%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88" title="#3-5%E7%A7%8D%E5%B8%B8%E8%A7%81%E9%99%B7%E9%98%B1%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">3. 5ç§å¸¸è§é™·é˜±ä¸è§£å†³æ–¹æ¡ˆ</a></li>
<li><a href="#4-%E6%B7%B1%E6%8B%B7%E8%B4%9D%E7%9A%84%E5%9D%91%E4%BD%A0%E4%BB%A5%E4%B8%BA%E7%9A%84%E5%AE%89%E5%85%A8%E5%85%B6%E5%AE%9E%E6%98%AF%E5%99%A9%E6%A2%A6" title="#4-%E6%B7%B1%E6%8B%B7%E8%B4%9D%E7%9A%84%E5%9D%91%E4%BD%A0%E4%BB%A5%E4%B8%BA%E7%9A%84%E5%AE%89%E5%85%A8%E5%85%B6%E5%AE%9E%E6%98%AF%E5%99%A9%E6%A2%A6">4. æ·±æ‹·è´çš„å‘ï¼šä½ ä»¥ä¸ºçš„å®‰å…¨å…¶å®æ˜¯å™©æ¢¦</a></li>
<li><a href="#5-%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B%E8%A1%A8%E6%A0%BC%E5%B5%8C%E5%A5%97%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0" title="#5-%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B%E8%A1%A8%E6%A0%BC%E5%B5%8C%E5%A5%97%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0">5. å®æˆ˜æ¡ˆä¾‹ï¼šè¡¨æ ¼åµŒå¥—æ•°æ®æ›´æ–°</a></li>
<li><a href="#6-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%A4%A7%E8%A7%84%E6%A8%A1%E6%95%B0%E6%8D%AE%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5" title="#6-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%A4%A7%E8%A7%84%E6%A8%A1%E6%95%B0%E6%8D%AE%E4%B8%8B%E7%9A%84%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5">6. æ€§èƒ½ä¼˜åŒ–ï¼šå¤§è§„æ¨¡æ•°æ®ä¸‹çš„æœ€ä½³å®è·µ</a></li>
<li><a href="#7-%E6%80%BB%E7%BB%93%E4%B8%8E%E9%81%BF%E5%9D%91%E6%B8%85%E5%8D%95" title="#7-%E6%80%BB%E7%BB%93%E4%B8%8E%E9%81%BF%E5%9D%91%E6%B8%85%E5%8D%95">7. æ€»ç»“ä¸é¿å‘æ¸…å•</a></li>
</ul>
<hr/>
<h2 data-id="heading-1">1. èƒŒæ™¯ï¼šä¸€ä¸ªè®©äººå´©æºƒçš„Bug</h2>
<h3 data-id="heading-2">1.1 ç°åœºé‡ç°</h3>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
import { reactive } from 'vue'

const state = reactive({
  user: {
    name: 'å¼ ä¸‰',
    address: {
      city: 'åŒ—äº¬',
      district: 'æœé˜³åŒº'
    }
  }
})

// âŒ è¿™ä¸ªæ“ä½œä¸ä¼šè§¦å‘ç•Œé¢æ›´æ–°ï¼
const updateDistrict = () =&gt; {
  state.user.address.district = 'æµ·æ·€åŒº'
  console.log('å·²ä¿®æ”¹ä¸º:', state.user.address.district) // æ˜¾ç¤º"æµ·æ·€åŒº"
  // ä½†ç•Œé¢ä¸Šè¿˜æ˜¯æ˜¾ç¤º"æœé˜³åŒº"ï¼
}
&lt;/script&gt;

&lt;template&gt;
  &lt;div&gt;
    &lt;p&gt;å½“å‰åŒºåŸŸ: {{ state.user.address.district }}&lt;/p&gt;
    &lt;button @click="updateDistrict"&gt;ä¿®æ”¹åŒºåŸŸ&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p><strong>æ˜¯ä¸æ˜¯å¾ˆåƒä½ æ˜¨å¤©é‡åˆ°çš„Bugï¼Ÿ</strong></p>
<p>æ§åˆ¶å°æ˜¾ç¤ºæ•°æ®å·²ç»å˜äº†ï¼Œä½†ç•Œé¢çº¹ä¸ä¸åŠ¨ã€‚ä½ å¼€å§‹æ€€ç–‘äººç”Ÿï¼š</p>
<ul>
<li>"æˆ‘æ˜æ˜ç”¨äº†<code>reactive</code>ï¼Œå®ƒä¸æ˜¯æ·±å±‚çš„å—ï¼Ÿ"</li>
<li>"éš¾é“Vue 3çš„å“åº”å¼åäº†ï¼Ÿ"</li>
<li>"æ˜¯ä¸æ˜¯éœ€è¦æ‰‹åŠ¨è°ƒç”¨ä»€ä¹ˆæ–¹æ³•ï¼Ÿ"</li>
</ul>
<h3 data-id="heading-3">1.2 ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ</h3>
<p>Vue 3çš„å“åº”å¼ç³»ç»ŸåŸºäºES6çš„<code>Proxy</code>ï¼Œå®ƒç¡®å®æä¾›äº†"æ·±å±‚å“åº”"çš„èƒ½åŠ›ã€‚ä½†é—®é¢˜å‡ºåœ¨<strong>JavaScriptçš„å¯¹è±¡å¼•ç”¨æœºåˆ¶</strong>å’Œ<strong>Vueçš„ä¾èµ–æ”¶é›†æ—¶æœº</strong>ä¸Šã€‚</p>
<p>è®©æˆ‘ä»¬ä»æºç å±‚é¢ä¸€æ¢ç©¶ç«Ÿã€‚</p>
<hr/>
<h2 data-id="heading-4">2. æ ¸å¿ƒåŸç†ï¼šProxyçš„"ä»£ç†é™·é˜±"</h2>
<h3 data-id="heading-5">2.1 Vue 3å“åº”å¼ç³»ç»Ÿæ¶æ„</h3>
<pre><code class="hljs language-css" lang="css">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Vue <span class="hljs-number">3</span> å“åº”å¼ç³»ç»Ÿ                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åŸå§‹å¯¹è±¡ â”€â”€â–º Proxyä»£ç† â”€â”€â–º ä¾èµ–æ”¶é›†(track) â”€â”€â–º è§¦å‘æ›´æ–°(trigger)  â”‚
â”‚     â”‚           â”‚              â”‚               â”‚        â”‚
â”‚     â”‚           â”‚              â–¼               â–¼        â”‚
â”‚     â”‚           â”‚         WeakMapå­˜å‚¨      æ‰§è¡Œeffect    â”‚
â”‚     â”‚           â”‚     {target: {key: Set&lt;effect&gt;}}      â”‚
â”‚     â–¼           â–¼                                       â”‚
â”‚  {<span class="hljs-selector-tag">a</span>: <span class="hljs-number">1</span>}    Proxy{<span class="hljs-selector-tag">a</span>: <span class="hljs-number">1</span>}                                  â”‚
â”‚              get() â”€â”€trackâ”€â”€â”                           â”‚
â”‚              set() â”€â”€triggerâ”˜                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-6">2.2 æ ¸å¿ƒæºç è§£æ</h3>
<p>Vue 3çš„<code>reactive</code>å‡½æ•°ç®€åŒ–å®ç°ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ç®€åŒ–ç‰ˆæºç ï¼ˆåŸºäºvuejs/coreï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">reactive</span>(<span class="hljs-params">obj</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(obj, {
    <span class="hljs-title function_">get</span>(<span class="hljs-params">target, key</span>) {
      <span class="hljs-comment">// 1. æ”¶é›†ä¾èµ–ï¼šè°åœ¨ç”¨è¿™ä¸ªå±æ€§</span>
      <span class="hljs-title function_">track</span>(target, key)
      <span class="hljs-keyword">const</span> result = target[key]
      <span class="hljs-comment">// 2. é€’å½’ä»£ç†ï¼šè®©åµŒå¥—å¯¹è±¡ä¹Ÿå˜æˆå“åº”å¼</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isObject</span>(result)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">reactive</span>(result)
      }
      <span class="hljs-keyword">return</span> result
    },
    <span class="hljs-title function_">set</span>(<span class="hljs-params">target, key, value</span>) {
      <span class="hljs-keyword">const</span> oldValue = target[key]
      target[key] = value
      <span class="hljs-comment">// 3. è§¦å‘æ›´æ–°ï¼šé€šçŸ¥æ‰€æœ‰ä¾èµ–è¿™ä¸ªå±æ€§çš„effect</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-title function_">hasChanged</span>(value, oldValue)) {
        <span class="hljs-title function_">trigger</span>(target, key)
      }
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
    }
  })
}
</code></pre>
<h3 data-id="heading-7">2.3 ä¾èµ–æ”¶é›†çš„"æ‡’æƒ°æ€§"</h3>
<p><strong>å…³é”®é—®é¢˜</strong>ï¼šVueçš„ä¾èµ–æ”¶é›†æ˜¯"æŒ‰éœ€"çš„ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">user</span>: {
    <span class="hljs-attr">address</span>: {
      <span class="hljs-attr">district</span>: <span class="hljs-string">'æœé˜³åŒº'</span>
    }
  }
})

<span class="hljs-comment">// åœºæ™¯1ï¼šæ¨¡æ¿ä¸­åªè®¿é—®äº† state.user</span>
<span class="hljs-comment">// æ”¶é›†çš„ä¾èµ–ï¼šstate â”€â”€â–º user</span>
<span class="hljs-comment">// å½“ä¿®æ”¹ state.user.address.district æ—¶ï¼š</span>
<span class="hljs-comment">// - ä¿®æ”¹çš„æ˜¯ address å¯¹è±¡ï¼Œä¸æ˜¯ user å¯¹è±¡</span>
<span class="hljs-comment">// - æ²¡æœ‰è§¦å‘ user çš„ setter</span>
<span class="hljs-comment">// - ç•Œé¢ä¸æ›´æ–°ï¼</span>

<span class="hljs-comment">// åœºæ™¯2ï¼šæ¨¡æ¿ä¸­è®¿é—®äº† state.user.address.district</span>
<span class="hljs-comment">// æ”¶é›†çš„ä¾èµ–ï¼šstate â”€â”€â–º user â”€â”€â–º address â”€â”€â–º district</span>
<span class="hljs-comment">// è¿™æ—¶ä¿®æ”¹ district æ‰ä¼šè§¦å‘æ›´æ–°</span>
</code></pre>
<h3 data-id="heading-8">2.4 å†…å­˜ç»“æ„å›¾è§£</h3>
<pre><code class="hljs language-javascript" lang="javascript">åˆå§‹çŠ¶æ€ï¼ˆæœªè®¿é—®æ·±å±‚å±æ€§ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  targetMap (<span class="hljs-title class_">WeakMap</span>)                â”‚
â”‚  â”œâ”€ <span class="hljs-attr">state</span>: depsMap                  â”‚
â”‚  â”‚   â””â”€ <span class="hljs-string">"user"</span>: <span class="hljs-title class_">Set</span>[<span class="hljs-title class_">ComponentEffect</span>]â”‚
â”‚  â”‚   <span class="hljs-comment">// æ³¨æ„ï¼šæ²¡æœ‰"address"å’Œ"district"çš„ä¾èµ–ï¼  â”‚</span>
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è®¿é—®æ·±å±‚å±æ€§åï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  targetMap (<span class="hljs-title class_">WeakMap</span>)                            â”‚
â”‚  â”œâ”€ <span class="hljs-attr">state</span>: depsMap                              â”‚
â”‚  â”‚   â”œâ”€ <span class="hljs-string">"user"</span>: <span class="hljs-title class_">Set</span>[<span class="hljs-title class_">ComponentEffect</span>]            â”‚
â”‚  â”œâ”€ state.<span class="hljs-property">user</span>: depsMap (<span class="hljs-title class_">Proxy</span>)                 â”‚
â”‚  â”‚   â”œâ”€ <span class="hljs-string">"address"</span>: <span class="hljs-title class_">Set</span>[<span class="hljs-title class_">ComponentEffect</span>]         â”‚
â”‚  â”œâ”€ state.<span class="hljs-property">user</span>.<span class="hljs-property">address</span>: depsMap (<span class="hljs-title class_">Proxy</span>)         â”‚
â”‚  â”‚   â”œâ”€ <span class="hljs-string">"district"</span>: <span class="hljs-title class_">Set</span>[<span class="hljs-title class_">ComponentEffect</span>]        â”‚
â”‚  â”‚   <span class="hljs-comment">// ç°åœ¨ä¿®æ”¹ district ä¼šè§¦å‘æ›´æ–°äº†ï¼        â”‚</span>
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h2 data-id="heading-9">3. 5ç§å¸¸è§é™·é˜±ä¸è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-10">é™·é˜±1ï¼šç›´æ¥æ›¿æ¢åµŒå¥—å¯¹è±¡å±æ€§</h3>
<p><strong>âŒ é”™è¯¯ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
import { reactive } from 'vue'

const state = reactive({
  form: {
    name: '',
    items: [
      { id: 1, value: 'A' },
      { id: 2, value: 'B' }
    ]
  }
})

// ç›´æ¥ä¿®æ”¹æ•°ç»„ä¸­çš„å¯¹è±¡å±æ€§ - ä¸è§¦å‘æ›´æ–°ï¼
const updateItem = () =&gt; {
  state.form.items[0].value = 'C'  // âŒ ç•Œé¢å¯èƒ½ä¸æ›´æ–°
}
&lt;/script&gt;
</code></pre>
<p><strong>âœ… è§£å†³æ–¹æ¡ˆ1ï¼šä½¿ç”¨<code>Vue.set</code>é£æ ¼çš„èµ‹å€¼</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ–¹æ³•Aï¼šä½¿ç”¨ splice è§¦å‘æ•°ç»„æ›´æ–°</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">updateItem</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> newItems = [...state.<span class="hljs-property">form</span>.<span class="hljs-property">items</span>]
  newItems[<span class="hljs-number">0</span>] = { ...newItems[<span class="hljs-number">0</span>], <span class="hljs-attr">value</span>: <span class="hljs-string">'C'</span> }
  state.<span class="hljs-property">form</span>.<span class="hljs-property">items</span> = newItems  <span class="hljs-comment">// âœ… è§¦å‘æ›´æ–°</span>
}

<span class="hljs-comment">// æ–¹æ³•Bï¼šä½¿ç”¨ Vue æä¾›çš„å·¥å…·å‡½æ•°</span>
<span class="hljs-keyword">import</span> { set } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">updateItem</span> = (<span class="hljs-params"/>) =&gt; {
  state.<span class="hljs-property">form</span>.<span class="hljs-property">items</span>[<span class="hljs-number">0</span>].<span class="hljs-property">value</span> = <span class="hljs-string">'C'</span>
  <span class="hljs-comment">// å¼ºåˆ¶è§¦å‘æ›´æ–°</span>
  state.<span class="hljs-property">form</span>.<span class="hljs-property">items</span> = [...state.<span class="hljs-property">form</span>.<span class="hljs-property">items</span>]
}
</code></pre>
<p><strong>âœ… è§£å†³æ–¹æ¡ˆ2ï¼šä½¿ç”¨<code>ref</code>è€Œé<code>reactive</code></strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> form = <span class="hljs-title function_">ref</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">''</span>,
  <span class="hljs-attr">items</span>: [{ <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'A'</span> }]
})

<span class="hljs-keyword">const</span> <span class="hljs-title function_">updateItem</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-comment">// é€šè¿‡ .value è®¿é—®ï¼Œç¡®ä¿è§¦å‘å“åº”</span>
  form.<span class="hljs-property">value</span>.<span class="hljs-property">items</span>[<span class="hljs-number">0</span>].<span class="hljs-property">value</span> = <span class="hljs-string">'C'</span>
  <span class="hljs-comment">// éœ€è¦æ•´ä½“èµ‹å€¼æ‰ä¼šè§¦å‘</span>
  form.<span class="hljs-property">value</span>.<span class="hljs-property">items</span> = [...form.<span class="hljs-property">value</span>.<span class="hljs-property">items</span>]
}
</code></pre>
<h3 data-id="heading-11">é™·é˜±2ï¼šè§£æ„èµ‹å€¼ä¸¢å¤±å“åº”æ€§</h3>
<p><strong>âŒ é”™è¯¯ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">user</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> }
})

<span class="hljs-comment">// è§£æ„ä¼šå¤±å»å“åº”æ€§ï¼</span>
<span class="hljs-keyword">const</span> { user } = state
<span class="hljs-comment">// user åªæ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡å¼•ç”¨ï¼Œä¸å†æ˜¯ Proxy</span>

<span class="hljs-comment">// ä¿®æ”¹ user ä¸ä¼šè§¦å‘ç•Œé¢æ›´æ–°</span>
user.<span class="hljs-property">name</span> = <span class="hljs-string">'æå››'</span>  <span class="hljs-comment">// âŒ ç•Œé¢ä¸æ›´æ–°</span>
</code></pre>
<p><strong>âœ… è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ–¹æ³•1ï¼šå§‹ç»ˆé€šè¿‡åŸå§‹å¯¹è±¡è®¿é—®</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">updateName</span> = (<span class="hljs-params"/>) =&gt; {
  state.<span class="hljs-property">user</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'æå››'</span>  <span class="hljs-comment">// âœ… ä¼šè§¦å‘æ›´æ–°</span>
}

<span class="hljs-comment">// æ–¹æ³•2ï¼šä½¿ç”¨ toRefs ä¿æŒå“åº”æ€§</span>
<span class="hljs-keyword">import</span> { reactive, toRefs } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">user</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> }
})

<span class="hljs-comment">// toRefs ä¼šå°†å¯¹è±¡çš„æ¯ä¸ªå±æ€§è½¬æ¢ä¸º ref</span>
<span class="hljs-keyword">const</span> { user } = <span class="hljs-title function_">toRefs</span>(state)
<span class="hljs-comment">// ç°åœ¨ user.value æ˜¯å“åº”å¼çš„</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">updateName</span> = (<span class="hljs-params"/>) =&gt; {
  user.<span class="hljs-property">value</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'æå››'</span>  <span class="hljs-comment">// âœ… ä¼šè§¦å‘æ›´æ–°</span>
}

<span class="hljs-comment">// æ–¹æ³•3ï¼šåœ¨ setup ä¸­ç›´æ¥ä½¿ç”¨è§£æ„ï¼ˆä»…é™&lt;script setup&gt;ï¼‰</span>
&lt;script setup&gt;
<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({ <span class="hljs-attr">user</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span> } })
<span class="hljs-comment">// ç›´æ¥ä½¿ç”¨ï¼Œä¸è¦è§£æ„</span>
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-12">é™·é˜±3ï¼šæ•°ç»„ç´¢å¼•ä¿®æ”¹ä¸è§¦å‘æ›´æ–°</h3>
<p><strong>âŒ é”™è¯¯ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> list = <span class="hljs-title function_">reactive</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])

<span class="hljs-comment">// ç›´æ¥é€šè¿‡ç´¢å¼•ä¿®æ”¹</span>
list[<span class="hljs-number">0</span>] = <span class="hljs-number">100</span>  <span class="hljs-comment">// âŒ å¯èƒ½ä¸ä¼šè§¦å‘æ›´æ–°ï¼ˆåœ¨æŸäº›è¾¹ç•Œæƒ…å†µä¸‹ï¼‰</span>
</code></pre>
<p><strong>âœ… è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ–¹æ³•1ï¼šä½¿ç”¨ splice</span>
list.<span class="hljs-title function_">splice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">100</span>)  <span class="hljs-comment">// âœ… è§¦å‘æ›´æ–°</span>

<span class="hljs-comment">// æ–¹æ³•2ï¼šé‡æ–°èµ‹å€¼æ•´ä¸ªæ•°ç»„</span>
list[<span class="hljs-number">0</span>] = <span class="hljs-number">100</span>
list.<span class="hljs-property">length</span> = list.<span class="hljs-property">length</span>  <span class="hljs-comment">// å¼ºåˆ¶è§¦å‘ï¼ˆhackæ–¹å¼ï¼Œä¸æ¨èï¼‰</span>

<span class="hljs-comment">// æ–¹æ³•3ï¼šä½¿ç”¨ ref æ›¿ä»£</span>
<span class="hljs-keyword">const</span> list = <span class="hljs-title function_">ref</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])
list.<span class="hljs-property">value</span>[<span class="hljs-number">0</span>] = <span class="hljs-number">100</span>  <span class="hljs-comment">// âœ… æ€»æ˜¯è§¦å‘æ›´æ–°</span>
</code></pre>
<h3 data-id="heading-13">é™·é˜±4ï¼šObjectæ–°å¢å±æ€§ä¸å“åº”</h3>
<p><strong>âŒ é”™è¯¯ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">user</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span> }
})

<span class="hljs-comment">// æ·»åŠ æ–°å±æ€§</span>
state.<span class="hljs-property">user</span>.<span class="hljs-property">age</span> = <span class="hljs-number">25</span>  <span class="hljs-comment">// âŒ ä¸ä¼šè§¦å‘æ›´æ–°ï¼ˆå³ä½¿è®¿é—®è¿‡userï¼‰</span>
</code></pre>
<p><strong>âœ… è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ–¹æ³•1ï¼šä½¿ç”¨ Object.assign</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(state.<span class="hljs-property">user</span>, { <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> })  <span class="hljs-comment">// âœ… è§¦å‘æ›´æ–°</span>

<span class="hljs-comment">// æ–¹æ³•2ï¼šé¢„å…ˆå£°æ˜æ‰€æœ‰å¯èƒ½ç”¨åˆ°çš„å±æ€§</span>
<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">user</span>: { 
    <span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span>,
    <span class="hljs-attr">age</span>: <span class="hljs-literal">undefined</span>  <span class="hljs-comment">// é¢„å…ˆå£°æ˜</span>
  }
})
state.<span class="hljs-property">user</span>.<span class="hljs-property">age</span> = <span class="hljs-number">25</span>  <span class="hljs-comment">// âœ… ç°åœ¨ä¼šè§¦å‘æ›´æ–°</span>

<span class="hljs-comment">// æ–¹æ³•3ï¼šä½¿ç”¨ ref</span>
<span class="hljs-keyword">const</span> user = <span class="hljs-title function_">ref</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span> })
user.<span class="hljs-property">value</span> = { ...user.<span class="hljs-property">value</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> }  <span class="hljs-comment">// âœ… è§¦å‘æ›´æ–°</span>
</code></pre>
<h3 data-id="heading-14">é™·é˜±5ï¼šæ·±å±‚åµŒå¥—å¯¹è±¡çš„æ€§èƒ½é™·é˜±</h3>
<p><strong>âŒ é—®é¢˜åœºæ™¯ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> bigData = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-comment">// 1000æ¡æ•°æ®ï¼Œæ¯æ¡éƒ½æœ‰æ·±å±‚åµŒå¥—</span>
  <span class="hljs-attr">list</span>: <span class="hljs-title class_">Array</span>(<span class="hljs-number">1000</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-literal">null</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> ({
    <span class="hljs-attr">id</span>: i,
    <span class="hljs-attr">info</span>: {
      <span class="hljs-attr">detail</span>: {
        <span class="hljs-attr">deep</span>: { <span class="hljs-attr">value</span>: i }
      }
    }
  }))
})
<span class="hljs-comment">// æ¯æ¬¡è®¿é—®éƒ½ä¼šé€’å½’åˆ›å»º Proxyï¼Œæ€§èƒ½çˆ†ç‚¸ï¼</span>
</code></pre>
<p><strong>âœ… è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { shallowRef, triggerRef } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-comment">// ä½¿ç”¨ shallowRefï¼Œåªæœ‰ .value æ˜¯å“åº”å¼çš„ï¼Œå†…éƒ¨ä¸åšæ·±ä»£ç†</span>
<span class="hljs-keyword">const</span> bigData = <span class="hljs-title function_">shallowRef</span>({
  <span class="hljs-attr">list</span>: <span class="hljs-title class_">Array</span>(<span class="hljs-number">1000</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-literal">null</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> ({
    <span class="hljs-attr">id</span>: i,
    <span class="hljs-attr">info</span>: { <span class="hljs-attr">detail</span>: { <span class="hljs-attr">deep</span>: { <span class="hljs-attr">value</span>: i } } }
  }))
})

<span class="hljs-comment">// ä¿®æ”¹æ·±å±‚æ•°æ®</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">updateDeep</span> = (<span class="hljs-params"/>) =&gt; {
  bigData.<span class="hljs-property">value</span>.<span class="hljs-property">list</span>[<span class="hljs-number">0</span>].<span class="hljs-property">info</span>.<span class="hljs-property">detail</span>.<span class="hljs-property">deep</span>.<span class="hljs-property">value</span> = <span class="hljs-number">999</span>
  <span class="hljs-comment">// æ‰‹åŠ¨è§¦å‘æ›´æ–°</span>
  <span class="hljs-title function_">triggerRef</span>(bigData)  <span class="hljs-comment">// âœ… å¼ºåˆ¶åˆ·æ–°ç•Œé¢</span>
}
</code></pre>
<hr/>
<h2 data-id="heading-15">4. æ·±æ‹·è´çš„å‘ï¼šä½ ä»¥ä¸ºçš„å®‰å…¨å…¶å®æ˜¯å™©æ¢¦</h2>
<h3 data-id="heading-16">4.1 æ·±æ‹·è´ä¸ºä»€ä¹ˆä¼šç ´åå“åº”æ€§ï¼Ÿ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { reactive } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> cloneDeep <span class="hljs-keyword">from</span> <span class="hljs-string">'lodash/cloneDeep'</span>

<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">user</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-attr">items</span>: [{ <span class="hljs-attr">id</span>: <span class="hljs-number">1</span> }] }
})

<span class="hljs-comment">// âŒ è‡´å‘½é”™è¯¯ï¼šæ·±æ‹·è´åä¸¢å¤±äº†æ‰€æœ‰å“åº”æ€§ï¼</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">saveData</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> dataToSave = <span class="hljs-title function_">cloneDeep</span>(state.<span class="hljs-property">user</span>)
  <span class="hljs-comment">// dataToSave æ˜¯ä¸€ä¸ªçº¯å¯¹è±¡ï¼Œæ²¡æœ‰ä»»ä½• Proxy åŒ…è£…</span>
  <span class="hljs-comment">// å¦‚æœä½ æŠŠå®ƒèµ‹å› stateï¼Œå“åº”æ€§å°±å½»åº•æ–­äº†</span>
  state.<span class="hljs-property">user</span> = dataToSave  <span class="hljs-comment">// âŒ ç°åœ¨ state.user ä¸å†æ˜¯å“åº”å¼ä»£ç†ï¼</span>
}
</code></pre>
<h3 data-id="heading-17">4.2 æ­£ç¡®çš„æ·±æ‹·è´å§¿åŠ¿</h3>
<p><strong>åœºæ™¯1ï¼šéœ€è¦æäº¤åˆ°åç«¯çš„æ•°æ®</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { toRaw } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">saveData</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-comment">// ä½¿ç”¨ toRaw è·å–åŸå§‹å¯¹è±¡ï¼ˆä¸ä¼šé€’å½’è§£åŒ…ï¼Œæ€§èƒ½æ›´å¥½ï¼‰</span>
  <span class="hljs-keyword">const</span> rawData = <span class="hljs-title function_">toRaw</span>(state.<span class="hljs-property">user</span>)
  <span class="hljs-comment">// å‘é€ç»™åç«¯</span>
  <span class="hljs-keyword">await</span> api.<span class="hljs-title function_">saveUser</span>(rawData)
}
</code></pre>
<p><strong>åœºæ™¯2ï¼šéœ€è¦å¤åˆ¶æ•°æ®åŒæ—¶ä¿æŒå“åº”æ€§</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { reactive } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">duplicateUser</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-comment">// æ–¹æ³•1ï¼šé€ä¸ªå±æ€§å¤åˆ¶ï¼Œä¿æŒå“åº”æ€§</span>
  <span class="hljs-keyword">const</span> newUser = <span class="hljs-title function_">reactive</span>({
    <span class="hljs-attr">name</span>: state.<span class="hljs-property">user</span>.<span class="hljs-property">name</span>,
    <span class="hljs-attr">items</span>: state.<span class="hljs-property">user</span>.<span class="hljs-property">items</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ ...item }))
  })
  
  <span class="hljs-comment">// æ–¹æ³•2ï¼šä½¿ç”¨ JSON è§£æï¼ˆæ³¨æ„ï¼šä¼šä¸¢å¤±å‡½æ•°ã€Dateç­‰ç‰¹æ®Šç±»å‹ï¼‰</span>
  <span class="hljs-keyword">const</span> newUser2 = <span class="hljs-title function_">reactive</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(state.<span class="hljs-property">user</span>)))
}
</code></pre>
<p><strong>åœºæ™¯3ï¼šä½¿ç”¨ Immer è¿›è¡Œä¸å¯å˜æ›´æ–°</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { produce } <span class="hljs-keyword">from</span> <span class="hljs-string">'immer'</span>
<span class="hljs-keyword">import</span> { shallowRef } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">shallowRef</span>({
  <span class="hljs-attr">user</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-attr">items</span>: [{ <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'A'</span> }] }
})

<span class="hljs-keyword">const</span> <span class="hljs-title function_">updateItem</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-comment">// Immer ä¼šåˆ›å»ºæ–°çš„ä¸å¯å˜å¯¹è±¡</span>
  state.<span class="hljs-property">value</span> = <span class="hljs-title function_">produce</span>(state.<span class="hljs-property">value</span>, <span class="hljs-function"><span class="hljs-params">draft</span> =&gt;</span> {
    draft.<span class="hljs-property">user</span>.<span class="hljs-property">items</span>[<span class="hljs-number">0</span>].<span class="hljs-property">value</span> = <span class="hljs-string">'B'</span>
  })
  <span class="hljs-comment">// shallowRef æ£€æµ‹åˆ° .value å˜åŒ–ï¼Œè§¦å‘æ›´æ–° âœ…</span>
}
</code></pre>
<h3 data-id="heading-18">4.3 æ·±æ‹·è´ vs æµ…æ‹·è´é€ŸæŸ¥è¡¨</h3>









































<table><thead><tr><th>æ–¹æ³•</th><th>æ˜¯å¦ç ´åå“åº”æ€§</th><th>æ€§èƒ½</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><code>JSON.parse(JSON.stringify())</code></td><td>âœ… æ˜¯</td><td>ä¸­</td><td>ç®€å•å¯¹è±¡ï¼Œæ— å¾ªç¯å¼•ç”¨</td></tr><tr><td><code>lodash.cloneDeep</code></td><td>âœ… æ˜¯</td><td>ä½</td><td>å¤æ‚å¯¹è±¡ï¼Œéœ€è¦å®Œæ•´å¤åˆ¶</td></tr><tr><td><code>toRaw()</code></td><td>âŒ å¦ï¼ˆåªè¯»ï¼‰</td><td>é«˜</td><td>æäº¤æ•°æ®åˆ°åç«¯</td></tr><tr><td><code>{...obj}</code></td><td>âŒ å¦ï¼ˆæµ…æ‹·è´ï¼‰</td><td>é«˜</td><td>åªéœ€å¤åˆ¶ä¸€å±‚</td></tr><tr><td><code>structuredClone()</code></td><td>âœ… æ˜¯</td><td>ä¸­</td><td>ç°ä»£æµè§ˆå™¨ï¼Œæ”¯æŒæ›´å¤šç±»å‹</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-19">5. å®æˆ˜æ¡ˆä¾‹ï¼šè¡¨æ ¼åµŒå¥—æ•°æ®æ›´æ–°</h2>
<h3 data-id="heading-20">5.1 éœ€æ±‚æè¿°</h3>
<p>å®ç°ä¸€ä¸ªå¯ç¼–è¾‘è¡¨æ ¼ï¼Œæ”¯æŒï¼š</p>
<ol>
<li>å¤šè¡Œæ•°æ®å±•ç¤º</li>
<li>æ¯è¡Œå¯ä»¥å±•å¼€æ˜¾ç¤ºå­è¡¨æ ¼</li>
<li>å­è¡¨æ ¼æ•°æ®å¯ç¼–è¾‘</li>
<li>ç¼–è¾‘åå®æ—¶æ›´æ–°</li>
</ol>
<h3 data-id="heading-21">5.2 å®Œæ•´ä»£ç å®ç°</h3>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
import { reactive, ref, nextTick } from 'vue'

// è¡¨æ ¼æ•°æ®ç»“æ„
const tableData = reactive({
  rows: [
    {
      id: 1,
      name: 'äº§å“A',
      expanded: false,
      children: [
        { id: '1-1', sku: 'SKU001', stock: 100 },
        { id: '1-2', sku: 'SKU002', stock: 200 }
      ]
    },
    {
      id: 2,
      name: 'äº§å“B',
      expanded: false,
      children: [
        { id: '2-1', sku: 'SKU003', stock: 150 }
      ]
    }
  ]
})

// âœ… æ­£ç¡®çš„æ›´æ–°æ–¹æ³•ï¼šå±•å¼€/æ”¶èµ·
const toggleExpand = (row) =&gt; {
  // ç›´æ¥ä¿®æ”¹ä¼šè§¦å‘æ›´æ–°
  row.expanded = !row.expanded
}

// âœ… æ­£ç¡®çš„æ›´æ–°æ–¹æ³•ï¼šä¿®æ”¹åº“å­˜
const updateStock = (row, childIndex, newStock) =&gt; {
  // æ–¹æ³•1ï¼šç›´æ¥ä¿®æ”¹åµŒå¥—å±æ€§ï¼ˆå¦‚æœæ¨¡æ¿ä¸­è®¿é—®è¿‡è¿™ä¸ªè·¯å¾„ï¼‰
  row.children[childIndex].stock = newStock
  
  // æ–¹æ³•2ï¼šå¦‚æœä¸ç¡®å®šæ˜¯å¦è®¿é—®è¿‡ï¼Œå¼ºåˆ¶åˆ·æ–°
  // row.children = [...row.children]
}

// âœ… æ­£ç¡®çš„æ›´æ–°æ–¹æ³•ï¼šæ·»åŠ å­é¡¹
const addChild = (row) =&gt; {
  const newChild = {
    id: `${row.id}-${row.children.length + 1}`,
    sku: `SKU00${Date.now()}`,
    stock: 0
  }
  // ä½¿ç”¨ push ä¼šè§¦å‘æ›´æ–°
  row.children.push(newChild)
  
  // ç¡®ä¿å±•å¼€ä»¥æ˜¾ç¤ºæ–°æ·»åŠ çš„è¡Œ
  row.expanded = true
}

// âŒ é”™è¯¯ç¤ºä¾‹ï¼šç›´æ¥æ›¿æ¢æ•´ä¸ª children æ•°ç»„å¯èƒ½ä¸¢å¤±å“åº”æ€§
const wrongUpdate = (row) =&gt; {
  // å¦‚æœ row.children æ˜¯ä»å¤–éƒ¨ä¼ å…¥çš„éå“åº”å¼æ•°æ®
  row.children = row.children.map(child =&gt; ({ ...child }))  // âš ï¸ å±é™©ï¼
}

// âœ… å®‰å…¨ç¤ºä¾‹ï¼šæ‰¹é‡æ›´æ–°
const batchUpdate = async (row) =&gt; {
  // æ‰¹é‡ä¿®æ”¹å‰å…ˆå†»ç»“æ›´æ–°
  const originalChildren = JSON.parse(JSON.stringify(row.children))
  
  // ä¿®æ”¹æ•°æ®
  originalChildren.forEach(child =&gt; {
    child.stock += 10
  })
  
  // ä¸€æ¬¡æ€§èµ‹å€¼ï¼Œè§¦å‘å•æ¬¡æ›´æ–°
  row.children = originalChildren
  
  // ç­‰å¾… DOM æ›´æ–°
  await nextTick()
  console.log('æ‰¹é‡æ›´æ–°å®Œæˆ')
}
&lt;/script&gt;

&lt;template&gt;
  &lt;div class="table-container"&gt;
    &lt;table&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th&gt;å±•å¼€&lt;/th&gt;
          &lt;th&gt;ID&lt;/th&gt;
          &lt;th&gt;åç§°&lt;/th&gt;
          &lt;th&gt;æ“ä½œ&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;template v-for="row in tableData.rows" :key="row.id"&gt;
          &lt;!-- ä¸»è¡Œ --&gt;
          &lt;tr class="main-row"&gt;
            &lt;td&gt;
              &lt;button @click="toggleExpand(row)"&gt;
                {{ row.expanded ? 'â–¼' : 'â–¶' }}
              &lt;/button&gt;
            &lt;/td&gt;
            &lt;td&gt;{{ row.id }}&lt;/td&gt;
            &lt;td&gt;{{ row.name }}&lt;/td&gt;
            &lt;td&gt;
              &lt;button @click="addChild(row)"&gt;æ·»åŠ å­é¡¹&lt;/button&gt;
              &lt;button @click="batchUpdate(row)"&gt;æ‰¹é‡+10&lt;/button&gt;
            &lt;/td&gt;
          &lt;/tr&gt;
          
          &lt;!-- å­è¡¨æ ¼ --&gt;
          &lt;tr v-if="row.expanded" class="child-row"&gt;
            &lt;td colspan="4"&gt;
              &lt;table class="child-table"&gt;
                &lt;thead&gt;
                  &lt;tr&gt;
                    &lt;th&gt;SKU&lt;/th&gt;
                    &lt;th&gt;åº“å­˜&lt;/th&gt;
                  &lt;/tr&gt;
                &lt;/thead&gt;
                &lt;tbody&gt;
                  &lt;tr v-for="(child, index) in row.children" :key="child.id"&gt;
                    &lt;td&gt;{{ child.sku }}&lt;/td&gt;
                    &lt;td&gt;
                      &lt;input 
                        type="number" 
                        v-model="child.stock"
                        @change="updateStock(row, index, child.stock)"
                      /&gt;
                    &lt;/td&gt;
                  &lt;/tr&gt;
                &lt;/tbody&gt;
              &lt;/table&gt;
            &lt;/td&gt;
          &lt;/tr&gt;
        &lt;/template&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;style scoped&gt;
.table-container {
  padding: 20px;
}
table {
  width: 100%;
  border-collapse: collapse;
}
th, td {
  border: 1px solid #ddd;
  padding: 8px;
  text-align: left;
}
.main-row {
  background: #f5f5f5;
}
.child-row {
  background: #fff;
}
.child-table {
  margin: 10px;
  width: calc(100% - 20px);
}
input {
  width: 80px;
  padding: 4px;
}
&lt;/style&gt;
</code></pre>
<h3 data-id="heading-22">5.3 å…³é”®ç‚¹æ€»ç»“</h3>
<ol>
<li><strong>æ¨¡æ¿è®¿é—®è·¯å¾„å¾ˆé‡è¦</strong>ï¼šç¡®ä¿æ¨¡æ¿ä¸­è®¿é—®äº†ä½ è¦ä¿®æ”¹çš„å®Œæ•´è·¯å¾„</li>
<li><strong>æ•°ç»„æ–¹æ³•ä¼˜å…ˆä½¿ç”¨</strong>ï¼š<code>push</code>ã€<code>splice</code> ç­‰æ–¹æ³•ä¼šè§¦å‘æ›´æ–°</li>
<li><strong>æ‰¹é‡æ›´æ–°ä¼˜åŒ–</strong>ï¼šå¤šæ¬¡ä¿®æ”¹åä¸€æ¬¡æ€§èµ‹å€¼ï¼Œå‡å°‘é‡æ¸²æŸ“æ¬¡æ•°</li>
<li><strong>nextTick çš„æ—¶æœº</strong>ï¼šéœ€è¦åœ¨ DOM æ›´æ–°åæ‰§è¡Œæ“ä½œæ—¶è®°å¾—ä½¿ç”¨</li>
</ol>
<hr/>
<h2 data-id="heading-23">6. æ€§èƒ½ä¼˜åŒ–ï¼šå¤§è§„æ¨¡æ•°æ®ä¸‹çš„æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-24">6.1 è™šæ‹Ÿæ»šåŠ¨ + shallowRef</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { shallowRef, ref, computed } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-comment">// è¶…å¤§æ•°æ®åˆ—è¡¨ï¼ˆ10ä¸‡æ¡ï¼‰</span>
<span class="hljs-keyword">const</span> hugeList = <span class="hljs-title function_">shallowRef</span>([
  <span class="hljs-comment">// å‡è®¾è¿™é‡Œæœ‰10ä¸‡æ¡åµŒå¥—æ•°æ®</span>
])

<span class="hljs-comment">// åªæ˜¾ç¤ºå¯è§†åŒºåŸŸçš„æ•°æ®</span>
<span class="hljs-keyword">const</span> visibleData = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> start = scrollTop.<span class="hljs-property">value</span> <span class="hljs-comment">// å½“å‰æ»šåŠ¨ä½ç½®</span>
  <span class="hljs-keyword">const</span> end = start + visibleCount.<span class="hljs-property">value</span> <span class="hljs-comment">// å¯è§†æ•°é‡</span>
  <span class="hljs-keyword">return</span> hugeList.<span class="hljs-property">value</span>.<span class="hljs-title function_">slice</span>(start, end)
})

<span class="hljs-comment">// ä¿®æ”¹æ•°æ®æ—¶æ‰‹åŠ¨è§¦å‘</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">updateItem</span> = (<span class="hljs-params">index, newData</span>) =&gt; {
  hugeList.<span class="hljs-property">value</span>[index] = newData
  <span class="hljs-title function_">triggerRef</span>(hugeList) <span class="hljs-comment">// æ‰‹åŠ¨è§¦å‘æ›´æ–°</span>
}
</code></pre>
<h3 data-id="heading-25">6.2 åˆ†é¡µåŠ è½½ä¸å±€éƒ¨å“åº”</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { reactive, ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-comment">// åªæœ‰å½“å‰é¡µçš„æ•°æ®æ˜¯å“åº”å¼çš„</span>
  <span class="hljs-attr">currentPageData</span>: [],
  <span class="hljs-comment">// æ€»æ•°æ®åªå­˜åŸå§‹æ•°æ®ï¼Œä¸åšå“åº”å¼å¤„ç†</span>
  <span class="hljs-attr">allData</span>: []
})

<span class="hljs-comment">// åˆ‡æ¢é¡µé¢æ—¶æ›´æ–°å“åº”å¼æ•°æ®</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">changePage</span> = (<span class="hljs-params">page</span>) =&gt; {
  <span class="hljs-keyword">const</span> start = (page - <span class="hljs-number">1</span>) * pageSize
  <span class="hljs-keyword">const</span> end = start + pageSize
  <span class="hljs-comment">// åªè®©å½“å‰é¡µæ•°æ®æˆä¸ºå“åº”å¼</span>
  state.<span class="hljs-property">currentPageData</span> = state.<span class="hljs-property">allData</span>.<span class="hljs-title function_">slice</span>(start, end)
}
</code></pre>
<h3 data-id="heading-26">6.3 ä½¿ç”¨ Map/Set æ›¿ä»£å¯¹è±¡æ•°ç»„</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { reactive } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-comment">// âŒ ä½æ•ˆï¼šå¤§æ•°ç»„æŸ¥æ‰¾</span>
<span class="hljs-keyword">const</span> list = <span class="hljs-title function_">reactive</span>([
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">data</span>: {} },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">data</span>: {} },
  <span class="hljs-comment">// ... 10000æ¡</span>
])
<span class="hljs-comment">// æŸ¥æ‰¾éœ€è¦ O(n)</span>
<span class="hljs-keyword">const</span> item = list.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">i</span> =&gt;</span> i.<span class="hljs-property">id</span> === targetId)

<span class="hljs-comment">// âœ… é«˜æ•ˆï¼šä½¿ç”¨ Map</span>
<span class="hljs-keyword">const</span> dataMap = <span class="hljs-title function_">reactive</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>())
dataMap.<span class="hljs-title function_">set</span>(<span class="hljs-number">1</span>, { <span class="hljs-attr">data</span>: {} })
dataMap.<span class="hljs-title function_">set</span>(<span class="hljs-number">2</span>, { <span class="hljs-attr">data</span>: {} })
<span class="hljs-comment">// æŸ¥æ‰¾åªéœ€ O(1)</span>
<span class="hljs-keyword">const</span> item = dataMap.<span class="hljs-title function_">get</span>(targetId)
</code></pre>
<hr/>
<h2 data-id="heading-27">7. æ€»ç»“ä¸é¿å‘æ¸…å•</h2>
<h3 data-id="heading-28">7.1 æ ¸å¿ƒè¦ç‚¹å›é¡¾</h3>
<pre><code class="hljs">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Vue 3 åµŒå¥—æ•°æ®æ›´æ–°é¿å‘æŒ‡å—                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  1. è®¿é—®è·¯å¾„åŸåˆ™                                            â”‚
â”‚     â””â”€â”€ æ¨¡æ¿ä¸­å¿…é¡»è®¿é—®åˆ°ä½ è¦ä¿®æ”¹çš„æœ€æ·±å±‚å±æ€§                   â”‚
â”‚                                                             â”‚
â”‚  2. èµ‹å€¼è§¦å‘åŸåˆ™                                            â”‚
â”‚     â””â”€â”€ ç›´æ¥ä¿®æ”¹å¯¹è±¡å±æ€§å¯èƒ½ä¸è§¦å‘ï¼Œè€ƒè™‘æ•´ä½“æ›¿æ¢              â”‚
â”‚                                                             â”‚
â”‚  3. è§£æ„å±é™©                                                â”‚
â”‚     â””â”€â”€ è§£æ„ reactive å¯¹è±¡ä¼šå¤±å»å“åº”æ€§ï¼Œä½¿ç”¨ toRefs          â”‚
â”‚                                                             â”‚
â”‚  4. æ·±æ‹·è´é™·é˜±                                              â”‚
â”‚     â””â”€â”€ cloneDeep ä¼šç ´åå“åº”æ€§ï¼Œä½¿ç”¨ toRaw æˆ–æµ…æ‹·è´          â”‚
â”‚                                                             â”‚
â”‚  5. æ€§èƒ½ä¼˜åŒ–                                                â”‚
â”‚     â””â”€â”€ å¤§æ•°æ®ç”¨ shallowRef + triggerRef æ‰‹åŠ¨æ§åˆ¶            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-29">7.2 å¿«é€Ÿå†³ç­–æµç¨‹å›¾</h3>
<pre><code class="hljs language-scss" lang="scss">é‡åˆ°åµŒå¥—æ•°æ®ä¸æ›´æ–°ï¼Ÿ
    â”‚
    â”œâ”€ æ˜¯å¦åœ¨æ¨¡æ¿ä¸­è®¿é—®äº†å®Œæ•´è·¯å¾„ï¼Ÿ
    â”‚   â”œâ”€ å¦ â†’ è¡¥å……è®¿é—®è·¯å¾„ï¼š{{ obj<span class="hljs-selector-class">.level1</span><span class="hljs-selector-class">.level2</span> }}
    â”‚   â””â”€ æ˜¯ â†’ ç»§ç»­
    â”‚
    â”œâ”€ æ˜¯å¦ä½¿ç”¨äº†æ·±æ‹·è´(cloneDeep)ï¼Ÿ
    â”‚   â”œâ”€ æ˜¯ â†’ æ¢æˆ <span class="hljs-built_in">toRaw</span>() æˆ–æµ…æ‹·è´
    â”‚   â””â”€ å¦ â†’ ç»§ç»­
    â”‚
    â”œâ”€ æ˜¯å¦è§£æ„äº† reactive å¯¹è±¡ï¼Ÿ
    â”‚   â”œâ”€ æ˜¯ â†’ ä½¿ç”¨ <span class="hljs-built_in">toRefs</span>() æˆ–é¿å…è§£æ„
    â”‚   â””â”€ å¦ â†’ ç»§ç»­
    â”‚
    â”œâ”€ æ•°æ®é‡æ˜¯å¦å¾ˆå¤§(&gt;<span class="hljs-number">1000</span>æ¡)ï¼Ÿ
    â”‚   â”œâ”€ æ˜¯ â†’ ä½¿ç”¨ shallowRef + triggerRef
    â”‚   â””â”€ å¦ â†’ ç»§ç»­
    â”‚
    â””â”€ å°è¯•å¼ºåˆ¶åˆ·æ–°ï¼š
        â”œâ”€ æ•°ç»„ï¼šarr = <span class="hljs-selector-attr">[...arr]</span>
        â”œâ”€ å¯¹è±¡ï¼šobj = { ..<span class="hljs-selector-class">.obj</span> }
        â””â”€ æˆ–ä½¿ç”¨ <span class="hljs-built_in">nextTick</span>() å»¶è¿Ÿæ›´æ–°
</code></pre>
<h3 data-id="heading-30">7.3 æ¨èå·¥å…·å‡½æ•°</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// utils/reactiveHelper.js</span>

<span class="hljs-keyword">import</span> { reactive, toRaw, isProxy } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-comment">/**
 * å®‰å…¨åœ°æ›´æ–°åµŒå¥—å¯¹è±¡å±æ€§
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">safeUpdate</span>(<span class="hljs-params">obj, path, value</span>) {
  <span class="hljs-keyword">const</span> keys = path.<span class="hljs-title function_">split</span>(<span class="hljs-string">'.'</span>)
  <span class="hljs-keyword">let</span> current = obj
  
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i++) {
    current = current[keys[i]]
  }
  
  current[keys[keys.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]] = value
  
  <span class="hljs-comment">// å¦‚æœæ˜¯ reactive å¯¹è±¡ï¼Œè§¦å‘æ›´æ–°</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isProxy</span>(obj)) {
    <span class="hljs-comment">// å¼ºåˆ¶åˆ·æ–°ï¼ˆhack æ–¹å¼ï¼Œæ…ç”¨ï¼‰</span>
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(obj, obj)
  }
}

<span class="hljs-comment">/**
 * æ·±åº¦å…‹éš†ä½†ä¿æŒå“åº”æ€§ï¼ˆé€‚ç”¨äºç®€å•å¯¹è±¡ï¼‰
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">cloneReactive</span>(<span class="hljs-params">obj</span>) {
  <span class="hljs-keyword">const</span> raw = <span class="hljs-title function_">toRaw</span>(obj)
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">reactive</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(raw)))
}

<span class="hljs-comment">/**
 * æ‰¹é‡æ›´æ–°æ•°ç»„ï¼ˆå‡å°‘é‡æ¸²æŸ“ï¼‰
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">batchUpdateArray</span>(<span class="hljs-params">arr, updates</span>) {
  <span class="hljs-comment">// updates: [{ index: 0, value: newValue }, ...]</span>
  <span class="hljs-keyword">const</span> newArr = [...arr]
  updates.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">{ index, value }</span>) =&gt;</span> {
    newArr[index] = value
  })
  <span class="hljs-keyword">return</span> newArr
}
</code></pre>
<h3 data-id="heading-31">7.4 æœ€åçš„è¯</h3>
<p>Vue 3çš„å“åº”å¼ç³»ç»ŸåŸºäºProxyç¡®å®æ˜¯å·¨å¤§çš„è¿›æ­¥ï¼Œä½†å®ƒä¸æ˜¯é“¶å¼¹ã€‚ç†è§£<strong>ä¾èµ–æ”¶é›†çš„æƒ°æ€§</strong>å’Œ<strong>Proxyçš„ä»£ç†è¾¹ç•Œ</strong>ï¼Œæ˜¯é¿å…åµŒå¥—æ•°æ®æ›´æ–°é—®é¢˜çš„å…³é”®ã€‚</p>
<p>è®°ä½ï¼š<strong>å“åº”å¼ä¸æ˜¯é­”æ³•ï¼Œæ˜¯ç²¾ç¡®è¿½è¸ª</strong>ã€‚å½“ä½ æ˜ç™½Vueåœ¨ä»€ä¹ˆæ—¶æœºã€è¿½è¸ªå“ªäº›ä¾èµ–ï¼Œä½ å°±èƒ½æ¸¸åˆƒæœ‰ä½™åœ°å¤„ç†ä»»ä½•å¤æ‚çš„æ•°æ®ç»“æ„ã€‚</p>
<hr/>
<h2 data-id="heading-32">å‚è€ƒé“¾æ¥</h2>
<ol>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2Fguide%2Fextras%2Freactivity-in-depth.html" target="_blank" title="https://vuejs.org/guide/extras/reactivity-in-depth.html" ref="nofollow noopener noreferrer">Vue 3 å“åº”å¼åŸç†å®˜æ–¹æ–‡æ¡£</a> - éªŒè¯çŠ¶æ€: âœ…</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2Fapi%2Freactivity-advanced.html" target="_blank" title="https://vuejs.org/api/reactivity-advanced.html" ref="nofollow noopener noreferrer">Vue 3 Reactivity API é«˜çº§ç”¨æ³•</a> - éªŒè¯çŠ¶æ€: âœ…</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvuejs%2Fcore%2Fissues%2F1387" target="_blank" title="https://github.com/vuejs/core/issues/1387" ref="nofollow noopener noreferrer">GitHub Issue #1387 - åµŒå¥—å±æ€§æ›´æ–°é—®é¢˜</a> - éªŒè¯çŠ¶æ€: âœ…</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FJavaScript%2FReference%2FGlobal_Objects%2FProxy" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy" ref="nofollow noopener noreferrer">Proxy MDN æ–‡æ¡£</a> - éªŒè¯çŠ¶æ€: âœ…</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fimmerjs.github.io%2Fimmer%2F" target="_blank" title="https://immerjs.github.io/immer/" ref="nofollow noopener noreferrer">Immer ä¸å¯å˜æ•°æ®æ›´æ–°åº“</a> - éªŒè¯çŠ¶æ€: âœ…</li>
</ol>
<p><em>å¦‚æœæœ¬æ–‡å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµæ”¶è—ï¼ä½ åœ¨ä½¿ç”¨ Vue 3 å“åº”å¼æ—¶è¿˜é‡åˆ°è¿‡å“ªäº›å‘ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ã€‚</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Skills.lc æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä¼šåšï¼ˆç”¨ï¼‰è¿™ä¸ªç«™]]></title>    <link>https://juejin.cn/post/7603651855236038665</link>    <guid>https://juejin.cn/post/7603651855236038665</guid>    <pubDate>2026-02-07T16:04:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603651855236038665" data-draft-id="7603674653152854025" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Skills.lc æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä¼šåšï¼ˆç”¨ï¼‰è¿™ä¸ªç«™"/> <meta itemprop="keywords" content="AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-02-07T16:04:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="HBLOG"/> <meta itemprop="url" content="https://juejin.cn/user/131597124767479"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Skills.lc æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä¼šåšï¼ˆç”¨ï¼‰è¿™ä¸ªç«™
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/131597124767479/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    HBLOG
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T16:04:55.000Z" title="Sat Feb 07 2026 16:04:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æŠ˜è…¾ AI Agentã€CLI å·¥å…·å’Œå„ç§è‡ªåŠ¨åŒ–è„šæœ¬çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä¸€ç›´æœ‰ä¸€ä¸ªå¾ˆç°å®çš„é—®é¢˜ï¼š</p>
<blockquote>
<p><strong>å¥½çš„ skill / workflow åˆ°åº•è¯¥æ”¾å“ªï¼Ÿæ€ä¹ˆå¤ç”¨ï¼Ÿ</strong></p>
</blockquote>
<p>Prompt å¤ªé›¶æ•£ï¼Œæ”¾åœ¨ Notionã€Gistã€README é‡Œï¼Œæ—¶é—´ä¸€é•¿å°±æ‰¾ä¸åˆ°ï¼›<br/>
ä¸åŒé¡¹ç›®é‡Œåå¤å¤åˆ¶ç²˜è´´ï¼Œåˆå¾ˆéš¾ç»´æŠ¤ï¼›<br/>
çœ‹åˆ° GitHub ä¸Šæœ‰äººå†™äº†ä¸é”™çš„ skillï¼Œä¹Ÿä¸çŸ¥é“æ€ä¹ˆå‘ç°ã€æ€ä¹ˆç”¨ã€‚</p>
<p><strong>Skills.lc</strong> å°±æ˜¯åœ¨è¿™æ ·çš„èƒŒæ™¯ä¸‹å‡ºç°çš„ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fadmin.liuhaihua.cn%2Fwp-content%2Fuploads%2F2026%2F02%2Fimage.png" target="_blank" title="https://admin.liuhaihua.cn/wp-content/uploads/2026/02/image.png" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/89cbce868f0849f4a87039fa9068f245~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSEJMT0c=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771085098&amp;x-signature=cFVnXWqs4b%2B6y%2BQwajczioE5MBo%3D" alt="" loading="lazy"/></a></p>
<p>å®ƒæœ¬è´¨ä¸Šä¸æ˜¯â€œåˆä¸€ä¸ª AI å¹³å°â€ï¼Œè€Œæ˜¯ä¸€ä¸ª <strong>æŠ€èƒ½ç´¢å¼•ä¸åˆ†å‘ç«™ç‚¹</strong>ï¼Œä¸“é—¨ç”¨æ¥æ”¶é›†ã€æ•´ç†å’ŒåŒæ­¥å„å¤„çš„ <strong>Skill / Agent èƒ½åŠ›æè¿°</strong>ï¼Œè®©å®ƒä»¬å˜å¾—å¯æŸ¥ã€å¯ç”¨ã€å¯å¤ç”¨ã€‚</p>
<p>ğŸ‘‰ å®˜ç½‘ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fskills.lc%2F%3Futm_source%3Dchatgpt.com" target="_blank" title="https://skills.lc/?utm_source=chatgpt.com" ref="nofollow noopener noreferrer">skills.lc/</a></p>
<h2 data-id="heading-0">Skills.lc åœ¨è§£å†³ä»€ä¹ˆé—®é¢˜</h2>
<p>å¦‚æœä¸€å¥è¯æ€»ç»“ï¼š</p>
<blockquote>
<p><strong>å®ƒè®© skill åƒ npm åŒ…ã€pip åŒ…ä¸€æ ·ï¼Œè¢«ç»Ÿä¸€ç®¡ç†å’Œä½¿ç”¨ã€‚</strong></p>
</blockquote>
<p>å…·ä½“æ¥è¯´ï¼Œæœ‰å‡ ä¸ªå¾ˆå®é™…çš„ç‚¹ã€‚</p>
<h3 data-id="heading-1">1. Skill ä¸å†æ˜¯â€œæ•£è£… Promptâ€</h3>
<p>åœ¨ Skills.lc é‡Œï¼Œskill é€šå¸¸ä»¥ç»“æ„åŒ–æ–¹å¼å­˜åœ¨ï¼ˆä¾‹å¦‚ <code>SKILL.md</code>ï¼‰ï¼Œè€Œä¸æ˜¯ä¸€æ®µéšæ‰‹å†™çš„æç¤ºè¯ã€‚<br/>
è¿™æ„å‘³ç€ï¼š</p>
<ul>
<li>èƒ½çœ‹æ‡‚å®ƒ<strong>æ˜¯åšä»€ä¹ˆçš„</strong></li>
<li>èƒ½å¤ç”¨åˆ°ä¸åŒé¡¹ç›®</li>
<li>èƒ½é•¿æœŸç»´æŠ¤ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§ä½¿ç”¨</li>
</ul>
<p>ä½ å¯ä»¥æŠŠå®ƒç†è§£æˆï¼š<br/>
<strong>â€œç»™ AI ç”¨çš„è¯´æ˜ä¹¦ï¼Œè€Œä¸æ˜¯ä¸€å¥è¯æŒ‡ä»¤ã€‚â€</strong></p>
<h3 data-id="heading-2">2. æŠŠ GitHubã€ç¤¾åŒºé‡Œçš„æŠ€èƒ½ç»Ÿä¸€èµ·æ¥</h3>
<p>å¾ˆå¤š skill å…¶å®å·²ç»å­˜åœ¨äº†ï¼Œåªæ˜¯åˆ†æ•£åœ¨ï¼š</p>
<ul>
<li>GitHub ä»“åº“</li>
<li>å„ç§ demo é¡¹ç›®</li>
<li>ç§äººè„šæœ¬åº“</li>
</ul>
<p>Skills.lc åšçš„äº‹æƒ…ä¹‹ä¸€ï¼Œå°±æ˜¯<strong>å®šæœŸåŒæ­¥ã€æ‰«æå’Œç´¢å¼•è¿™äº›ä»“åº“</strong>ï¼Œåˆ¤æ–­å“ªäº›æ˜¯ skillï¼Œç„¶åç»Ÿä¸€å±•ç¤ºå‡ºæ¥ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fadmin.liuhaihua.cn%2Fwp-content%2Fuploads%2F2026%2F02%2Fimage-1.png" target="_blank" title="https://admin.liuhaihua.cn/wp-content/uploads/2026/02/image-1.png" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aff427f77c9a4406b822cc8700a10ebf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSEJMT0c=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771085098&amp;x-signature=Ayhpbpdo%2FbQ4p%2FA8rlLbw7e4DoA%3D" alt="" loading="lazy"/></a></p>
<p>ä½ ä¸éœ€è¦çŸ¥é“â€œä½œè€…æ˜¯è°ã€ä»“åº“åœ¨å“ªâ€ï¼Œ<br/>
åªéœ€è¦å…³å¿ƒï¼š<strong>è¿™ä¸ª skill èƒ½ä¸èƒ½è§£å†³ä½ çš„é—®é¢˜ã€‚</strong></p>
<h3 data-id="heading-3">3. å®‰è£…å’Œä½¿ç”¨æˆæœ¬å¾ˆä½</h3>
<p>Skills.lc å¹¶ä¸å¼ºè¿«ä½ ä½¿ç”¨æŸä¸ªç‰¹å®šå¹³å°æˆ– IDEã€‚</p>
<p>åªè¦ä½ åœ¨ç”¨ï¼š</p>
<ul>
<li>Claude / Codex / Cursor</li>
<li>å„ç§ AI CLI å·¥å…·</li>
<li>Agent æ¡†æ¶</li>
</ul>
<p>éƒ½å¯ä»¥é€šè¿‡ç®€å•çš„æ–¹å¼æŠŠ skill åŠ è¿›æ¥ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npx skills add owner/repo
</code></pre>
<p>è¿™ç‚¹å¯¹å¼€å‘è€…æ¥è¯´éå¸¸é‡è¦ï¼š<br/>
<strong>ä¸ç”¨æ¢å·¥å…·ï¼Œåªæ˜¯å¤šäº†èƒ½åŠ›ã€‚</strong></p>
<h2 data-id="heading-4">è¿™ä¸ªç«™æ›´é€‚åˆè°ï¼Ÿ</h2>
<p>å¦‚æœä½ ç¬¦åˆä¸‹é¢ä»»æ„ä¸€æ¡ï¼ŒåŸºæœ¬éƒ½èƒ½ç”¨å¾—ä¸Š Skills.lcï¼š</p>
<ul>
<li>ç»å¸¸å†™ prompt / workflowï¼Œä½†ç®¡ç†å¾ˆæ··ä¹±</li>
<li>åœ¨åš AI Agentã€è‡ªåŠ¨åŒ–è„šæœ¬ã€AI CLI å·¥å…·</li>
<li>å¸Œæœ›æŠŠè‡ªå·±çš„ skill å¼€æºå‡ºæ¥ï¼Œä½†ä¸æƒ³è‡ªå·±æ­å±•ç¤ºç«™</li>
<li>æƒ³å¿«é€Ÿæ‰¾â€œåˆ«äººå·²ç»å†™å¥½çš„è§£å†³æ–¹æ¡ˆâ€</li>
</ul>
<p>å®ƒä¸æ˜¯ç»™â€œåªèŠå¤©â€çš„ç”¨æˆ·å‡†å¤‡çš„ï¼Œ<br/>
è€Œæ˜¯åå‘ <strong>å·¥ç¨‹å‘ã€å·¥å…·å‘ã€æ•ˆç‡å‘</strong> çš„äººã€‚</p>
<h2 data-id="heading-5">Skills.lc ä¸æƒ³åšä»€ä¹ˆ</h2>
<p>è¿™é‡Œæœ‰ä¸€ç‚¹ä¹ŸæŒºé‡è¦çš„ã€‚</p>
<p>Skills.lc å¹¶ä¸æ‰“ç®—ï¼š</p>
<ul>
<li>ç»‘å®šæŸä¸€å®¶æ¨¡å‹</li>
<li>å¼ºæ¨æŸç§ Agent æ¡†æ¶</li>
<li>æŠŠ skill å˜æˆå°é—­ç”Ÿæ€</li>
</ul>
<p>å®ƒæ›´åƒæ˜¯ä¸€ä¸ª <strong>â€œç´¢å¼•å±‚ + åˆ†å‘å±‚â€</strong>ï¼Œè€Œä¸æ˜¯æ‰§è¡Œå±‚ã€‚</p>
<p>æ€ä¹ˆè·‘ã€ç”¨ä»€ä¹ˆæ¨¡å‹ã€é›†æˆåˆ°å“ªï¼Œéƒ½æ˜¯ä½ çš„è‡ªç”±ã€‚</p>
<h2 data-id="heading-6">æ€»ç»“ä¸€ä¸‹</h2>
<p>å¦‚æœä½ ç”¨ä¸€å¥åâ€œäººè¯â€çš„æ–¹å¼ç†è§£ Skills.lcï¼š</p>
<blockquote>
<p><strong>å®ƒæ˜¯ä¸€ä¸ªå¸®ä½ ç®¡ç†ã€å‘ç°å’Œå¤ç”¨ AI æŠ€èƒ½çš„åœ°æ–¹ã€‚</strong></p>
</blockquote>
<p>ä¸æ˜¯ä¸ºäº†ç‚«æŠ€æœ¯ï¼Œä¹Ÿä¸æ˜¯ä¸ºäº†é€ æ¦‚å¿µï¼Œ<br/>
è€Œæ˜¯æƒ³è§£å†³ä¸€ä¸ªå¾ˆå®é™…çš„é—®é¢˜ï¼š<br/>
<strong>å†™è¿‡çš„ skillï¼Œä¸è¦å†ä¸¢ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å±±é‡çš„é£ï¼ŒåŸå¸‚çš„çª—ï¼šä¸€ä½æ‹¾ç²ªçˆ·çˆ·ä¸æˆ‘çš„æ—¶ä»£ä¹‹é—®]]></title>    <link>https://juejin.cn/post/7603616672927547407</link>    <guid>https://juejin.cn/post/7603616672927547407</guid>    <pubDate>2026-02-07T16:08:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603616672927547407" data-draft-id="7603643385816186932" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å±±é‡çš„é£ï¼ŒåŸå¸‚çš„çª—ï¼šä¸€ä½æ‹¾ç²ªçˆ·çˆ·ä¸æˆ‘çš„æ—¶ä»£ä¹‹é—®"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-02-07T16:08:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¿®å·±xj"/> <meta itemprop="url" content="https://juejin.cn/user/2641475936724142"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å±±é‡çš„é£ï¼ŒåŸå¸‚çš„çª—ï¼šä¸€ä½æ‹¾ç²ªçˆ·çˆ·ä¸æˆ‘çš„æ—¶ä»£ä¹‹é—®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2641475936724142/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¿®å·±xj
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T16:08:12.000Z" title="Sat Feb 07 2026 16:08:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€é»‘ç™½å½±åƒä¸­çš„æ˜¨æ—¥</h2>
<p>ä»Šå¤©åœ¨æ»‘çœ‹æ‰‹æœºæ—¶ï¼Œä¸€å¼ ä¹åå¹´ä»£çš„è€ç…§ç‰‡å¿½ç„¶æ˜ å…¥çœ¼å¸˜ï¼šä¸€ä½ç©¿ç€ç²—å¸ƒè¡£è£³çš„è€äººï¼ŒèƒŒç€ä¸€åªç²ªç­ï¼Œæ­£å¼¯ç€è…°åœ¨è·¯ä¸Šæ‹¾ç²ªã€‚è¿™ä¸€å¹•åƒä¸€æŠŠæ²‰é»˜çš„é’¥åŒ™ï¼Œâ€œå’”å“’â€ä¸€å£°ï¼Œè½»è½»æ—‹å¼€äº†æˆ‘è®°å¿†çš„é—¸é—¨â€”â€”æˆ‘åˆå›åˆ°äº†ç«¥å¹´é‚£ä¸ªé»„åœŸå¡ä¸Šçš„å°æ‘åº„ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2d69df2b12284b23b0e2883fae0bef89~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771085292&amp;x-signature=1WncHBpNPOJid%2FcSS%2FqQQr5orFk%3D" alt="" loading="lazy"/></p>
<p>é‚£æ—¶ï¼Œæ‘é‡Œä¹Ÿæœ‰è¿™æ ·ä¸€ä½çˆ·çˆ·ã€‚å†œé—²æ—¶å€™ï¼Œä»–æ€»èƒŒç€ç«¹ç¯¾ç¼–çš„èƒŒç¯¼ï¼Œæ²¿ç€æ‘é“æ…¢æ…¢èµ°ï¼Œçœ‹è§é©´ç²ªã€éª¡ç²ªï¼Œä¾¿ä¿¯èº«æ‹¾èµ·ã€‚å¦‚ä»Šæƒ³æ¥ï¼Œè¿™æ ·çš„ç”»é¢åœ¨å¾ˆå¤šå¹´è½»äººçœ¼ä¸­ï¼Œææ€•å·²é™Œç”Ÿå¦‚ä¼ è¯´ã€‚åœ¨é‚£ä¸ªå¹´æœˆï¼Œæ‘é‡Œå‡ ä¹å®¶å®¶éƒ½å®ˆç€å‡ äº©ç”°åœ°ï¼Œåæœ‰å…«ä¹éƒ½å…»ç€å¤´é©´æˆ–éª¡å­ï¼ŒçŠåœ°ã€é©®è´§éƒ½é å®ƒä»¬ã€‚ç‰²å£èµ°è¿‡ï¼Œè·¯ä¸Šå¸¸ç•™ä¸‹ç²ªä¾¿ï¼Œé‚£ä½çˆ·çˆ·ä¾¿æ‹¾å›å»ï¼Œæˆ–æ˜¯ç»™åº„ç¨¼æ–½è‚¥ï¼Œæˆ–æ˜¯æ™’å¹²äº†ç•™ç€å†¬å¤©çƒ§ç‚•å–æš–ã€‚é‚£ä¸€å¼¯è…°ã€ä¸€æ‹¾å–çš„ç¬é—´ï¼Œå®Œæˆçš„ä¸ä»…æ˜¯åŠ³åŠ¨ï¼Œæ›´æ˜¯åœŸåœ°ä¸ç”Ÿå‘½ä¹‹é—´æœ€æœ´ç´ çš„å¾ªç¯ã€‚</p>
<h2 data-id="heading-1">äºŒã€å›è¡åœ¨å±±å·ä¹‹é—´çš„å£°éŸ³</h2>
<p>è®°å¿†é‡Œï¼Œä¸€åˆ°å…­æœˆéº¦ç†Ÿï¼Œå¤©è¿˜æœªäº®é€ï¼Œå±±é‡é—´ä¾¿äººå½±ç»°ç»°ã€‚äººä»¬åœ¨éº¦æµªé‡Œèµ·ä¼ï¼Œé•°åˆ€åˆ’è¿‡éº¦ç§†çš„æ²™æ²™å£°ã€æ‰æ‹…å±å‘€çš„å£°å“ã€å¶å°”å‡ å¥å®¶å¸¸çš„è°ˆç¬‘ï¼Œè®©æ•´ç‰‡å±±è°·éƒ½æ´»äº†è¿‡æ¥ã€‚ç´¯äº†ï¼Œå°±è¹²åœ¨ç”°åŸ‚ä¸Šå–å£æ°´ï¼Œæœé‚»åœ°çš„äººå–Šå‡ å¥è¯ã€‚å£°éŸ³è¡å‡ºå»ï¼Œåˆè¢«é£è½»è½»é€å›æ¥ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c014027a685d4f8d8f978efd6104926c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771085292&amp;x-signature=FmCeeFnbJmxE6jqKg%2FMLXb5sOW4%3D" alt="" loading="lazy"/></p>
<p>åæœˆæ’­ç§å°éº¦æ—¶ï¼Œæ¼«å±±éé‡åˆå“èµ·å†å–ç‰²å£çš„å‘¼å£°â€”â€”â€œé©¾ï¼â€â€œåï¼â€â€¦â€¦ç²—æœ´ã€å“äº®ï¼Œå´æ»¡æ˜¯æ³¥åœŸçš„ç”Ÿæœºã€‚é‚£æ—¶æ‘é‡Œå·²æœ‰äººå—ä¸‹æ‰“å·¥ï¼Œè¿‡å¹´å›æ¥æ—¶ç©¿ç€ç‰›ä»”è£¤ï¼Œå¼ç€å¸¦æ»¤å˜´çš„é¦™çƒŸï¼Œè¯´èµ·å¤–é¢çš„ä¸–ç•Œçœ¼é‡Œæœ‰å…‰ã€‚å¹´å°‘çš„æˆ‘å¬ç€ï¼Œå¿ƒé‡Œæš—æš—ç¾¡æ…•ï¼Œä¹Ÿæ‚„æ‚„åŸ‹ä¸‹ä¸€é¢—ç§å­ï¼šé•¿å¤§äº†ï¼Œæˆ‘ä¹Ÿè¦å»è¿œæ–¹ï¼Œå»åŸå¸‚ï¼Œé—¯ä¸€ç‰‡è‡ªå·±çš„å¤©åœ°ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ac572edb2b142ff9d1c392c1c01efe3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771085292&amp;x-signature=KqujZxrOQHdfN94p1kOPRAATUQA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">ä¸‰ã€ç°å®çš„ç¬¬ä¸€è®°è€³å…‰</h2>
<p>åæ¥æˆ‘è€ƒä¸Šå¤§å­¦ï¼Œå­¦äº†æœºæ¢°è®¾è®¡ã€‚æ¯•ä¸šåè¿›å…¥è¥¿å®ç‰¹é’¢ï¼Œæ»¡æ€€æ†§æ†¬åœ°å‡†å¤‡è¿æ¥â€œç™½é¢†äººç”Ÿâ€ã€‚ç„¶è€Œç°å®å¾ˆå¿«ç»™äº†æˆ‘æ¸…é†’çš„ä¸€è¯¾â€”â€”æƒ³è±¡ä¸­çš„ç™½è¡¬è¡«ã€ç©ºè°ƒæˆ¿ã€ç”µè„‘åŠå…¬ä¸€æ ·éƒ½æ²¡å‡ºç°ã€‚æŠ¥åˆ°ç¬¬ä¸€å¤©ï¼Œæˆ‘å°±è¢«åˆ†åˆ°ç”Ÿäº§ä¸€çº¿å·¡æ£€è®¾å¤‡ã€‚è½¦é—´é‡Œç²‰å°˜å¼¥æ¼«ï¼Œèƒ½è§åº¦å¸¸ä¸è¶³ä¸€ç±³ã€‚æˆ‘ä»¬æˆ´ç€è¢«æˆç§°ä¸ºâ€œçŒªå˜´â€çš„é˜²å°˜å£ç½©è¿›å»ï¼Œå‡ºæ¥æ—¶æµ‘èº«æ¼†é»‘ï¼Œåªå‰©çœ¼ç›è¿˜é€ç€ä¸€ç‚¹äº®å…‰ã€‚æ¯å‘¨æ¸…æ´—å·¥ä½œæœï¼Œç›†åº•éƒ½èƒ½æ²‰æ·€å‡ºåšåšä¸€å±‚é“ç²¾ç²‰ã€‚</p>
<p>åœ¨ç”Ÿäº§çº¿ä¸Šå¹²äº†å…­ä¸ªæœˆï¼Œæˆ‘é€‰æ‹©äº†ç¦»å¼€ã€‚å¿ƒé‡Œæ€»æœ‰ä¸€ä¸ªå£°éŸ³åå¤åœ°é—®ï¼šè¯»äº†è¿™ä¹ˆå¤šå¹´ä¹¦ï¼Œéš¾é“ä¸æ˜¯ä¸ºäº†èƒ½åœ¨å¹²å‡€æ˜äº®çš„åŠå…¬å®¤é‡Œï¼Œä½“é¢åœ°å·¥ä½œå—ï¼Ÿ</p>
<h2 data-id="heading-3">å››ã€èµ°è¿›â€œæ ¼å­é—´â€ï¼Œé™·å…¥æ–°å›´åŸ</h2>
<p>ç¦»å¼€é’¢å‚åï¼Œæˆ‘åœ¨æœºæ¢°è¡Œä¸šåˆè¾—è½¬äº†ä¸¤ä¸‰å¹´ï¼Œæœ€ç»ˆå†³å¿ƒè½¬è¡Œï¼ŒæŠ•èº«è½¯ä»¶å¼€å‘ã€‚æ¯”èµ·ä»å‰ï¼Œå·¥ä½œç¯å¢ƒç¡®æ˜¯å¤©å£¤ä¹‹åˆ«ï¼šæ’æ¸©çš„åŠå…¬å®¤ã€æ¸…å‡‰çš„ç©ºè°ƒã€ä¸€äººä¸€å°ç”µè„‘ï¼Œä¸€åˆ‡éƒ½ç¬¦åˆæˆ‘æ›¾ç»å¯¹â€œä½“é¢å·¥ä½œâ€çš„æƒ³è±¡ã€‚å®¶äººä¹Ÿæ¬£æ…°åœ°è¯´ï¼šâ€œè¿™ä¸‹å¥½äº†ï¼Œé£å¹ä¸ç€é›¨æ·‹ä¸ç€ï¼Œå†ä¸ç”¨å‡ºåŠ›æ°”äº†ã€‚â€</p>
<p>å¯çœŸæ­£åœ¨è¿™è¡Œæ·±è€•å‡ å¹´ï¼Œä¸€ç§æ–°çš„è¿·èŒ«å´æ‚„ç„¶æ»‹ç”Ÿã€‚é«˜å¼ºåº¦åŠ ç­ã€æŠ€æœ¯è¿­ä»£çš„ç„¦è™‘ã€å¹´é¾„æ¸é•¿çš„ç´§è¿«ã€åŸå¸‚å¿«èŠ‚å¥çš„ç”Ÿæ´»ï¼Œå±‚å±‚å å çš„å‹åŠ›å¦‚æ½®æ°´èˆ¬æ¶Œæ¥ã€‚ä¸çŸ¥ä¸è§‰é—´ï¼Œæˆ‘å¥½åƒåœ¨ç–²äºå¥”å‘½ä¸­ï¼Œå¼„ä¸¢äº†å½“å¹´é‚£ä¸ªä¸€å¿ƒâ€œè¦å»è¿œæ–¹â€çš„å°‘å¹´ï¼Œä¹Ÿæ¨¡ç³Šäº†è¿œæ–¹çœŸæ­£çš„æ¨¡æ ·ã€‚</p>
<h2 data-id="heading-4">äº”ã€æ‹¾ç²ªçˆ·çˆ·çš„â€œæ”¶è·â€ï¼Œä¸æˆ‘çš„â€œæ ‡å°ºâ€</h2>
<p>æœ‰æ—¶æ·±å¤œåŠ å®Œç­ï¼Œæˆ‘ä¼šè«åæƒ³èµ·æ‘é‡Œé‚£ä½æ‹¾ç²ªçš„çˆ·çˆ·ã€‚ä»–è¿™ä¸€ç”Ÿï¼Œæœ‰æ²¡æœ‰è¿‡â€œæ¢¦æƒ³â€è¿™ä¸ªè¯ï¼Ÿæˆ–è®¸ä»–çš„æ„¿æœ›å¾ˆå…·ä½“ï¼šä»Šå¤©å¤šæ‹¾åŠç­ç²ªï¼Œç§‹ååœŸè±†å°±èƒ½å¤šæ”¶ä¸€è¢‹ï¼›é›¨å­£æ¥å¾—åˆšå¥½ï¼Œéº¦å­èƒ½é¡ºé¡ºåˆ©åˆ©å½’ä»“ã€‚æ—¥å¤ä¸€æ—¥ï¼ŒåœŸåœ°ä¸æ¬ºäººï¼Œä»˜å‡ºå°±æœ‰å›å“ã€‚é‚£æ˜¯ä¸€ç§æ‰æ ¹åœ¨æ³¥åœŸé‡Œçš„è¸å®ï¼Œä¹Ÿæ˜¯çœ‹å¾—è§ã€æ‘¸å¾—ç€çš„â€œæ”¶è·â€ã€‚</p>
<p>è€Œæˆ‘å‘¢ï¼Ÿæ›¾ç»çš„æ¢¦æƒ³ï¼Œä¼¼ä¹å·²è¢«çç¢çš„æ—¥å­ç¨€é‡Šã€æ·¹æ²¡ï¼›å¯¹â€œæˆåŠŸâ€çš„å®šä¹‰ï¼Œä¹Ÿæ¸æ¸è¢«ç®€åŒ–æˆå‡ ä¸ªæ•°å­—å’Œæ ‡ç­¾â€”â€”æœˆè–ªå¤šå°‘ã€ä½å¤šå¤§æˆ¿å­â€¦â€¦å¯æ˜¯ï¼Œç©¶ç«Ÿå¤šå°‘é’±æ‰ç®—å¤Ÿï¼Ÿå¤šå¤§çš„æˆ¿å­æ‰èƒ½ç››æ”¾ä¸‹å®‰ç¨³ï¼Ÿè¿™äº›é—®é¢˜ï¼Œé—®æ¥é—®å»ï¼Œåªå‰©ä¸€ç‰‡æ²‰é»˜ã€‚</p>
<h2 data-id="heading-5">å…­ã€å›ä¸å»çš„ä¹¡åœŸï¼Œèµ°ä¸å‡ºçš„éƒ½å¸‚ï¼Œä¸è„±ä¸ä¸‹çš„â€œé•¿è¡«â€</h2>
<p>å¦‚ä»Šï¼Œæˆ‘ååœ¨å…­æ¥¼çš„ç©ºè°ƒæˆ¿é‡Œï¼ŒæŒ‡å°–æ•²æ‰“ç€é”®ç›˜ã€‚çª—å¤–æ˜¯åŸå¸‚çš„éœ“è™¹é—ªçƒï¼Œçª—å†…æ˜¯ä»£ç ä¸éœ€æ±‚çš„å¾ªç¯ã€‚å¶å°”ï¼Œæˆ‘ä¼šæƒ³å¿µé‚£äº›é£˜ç€éº¦é¦™çš„æ¸…æ™¨ï¼Œå›è¡åœ¨å±±è°·é—´çš„å†å–ï¼Œè¹²åœ¨ç”°åŸ‚ä¸Šè¯´ç¬‘çš„äººä»¬ã€‚ä½†æˆ‘ä¹Ÿæ¸…æ¥šåœ°çŸ¥é“ï¼Œæˆ‘å›ä¸å»äº†â€”â€”ä¸å•æ˜¯åœ°ç†ä¸Šï¼Œæ›´æ˜¯å¿ƒå¢ƒä¸ç”Ÿæ´»æ–¹å¼ä¸Šã€‚</p>
<p>æˆ–è®¸ï¼Œæ¯ä¸€ä»£äººéƒ½æœ‰å„è‡ªæ—¶ä»£çš„å¥”èµ´ä¸å›°é¡¿ã€‚æ‹¾ç²ªçˆ·çˆ·é‚£ä¸€è¾ˆçš„è¸å®åŠ³ä½œï¼Œä¸æˆ‘è¿™ä¸€ä»£åœ¨éƒ½å¸‚ä¸›æ—é‡Œçš„è¾—è½¬ç„¦è™‘ï¼Œçœ‹ä¼¼ç›¸éš”é¥è¿œï¼Œå´éƒ½åœ¨å›åº”åŒä¸€ä¸ªç”Ÿå‘½çš„æé—®ï¼šæˆ‘ä»¬ç©¶ç«Ÿåœ¨è¿½æ±‚ä»€ä¹ˆï¼Ÿæ˜¯ä¸–äººçœ¼ä¸­â€œæ›´å¥½çš„ç”Ÿæ´»â€ï¼Œè¿˜æ˜¯å†…å¿ƒæ·±å¤„â€œæ›´åƒè‡ªå·±çš„ç”Ÿæ´»â€ï¼Ÿ</p>
<p>æˆ‘è¿˜æ²¡æœ‰æ‰¾åˆ°ç¡®åˆ‡çš„ç­”æ¡ˆã€‚ä½†å†™ä¸‹è¿™äº›æ–‡å­—æ—¶ï¼Œæ—¶å…‰ä»¿ä½›æ¸©æŸ”åœ°æ…¢äº†ä¸€æ‹ã€‚çª—å¤–ä¾æ—§è½¦æµå¦‚ç»‡ã€äººå£°é¼æ²¸ï¼Œä½†è‡³å°‘åœ¨æ­¤åˆ»ï¼Œæˆ‘çš„å¿ƒé‡Œï¼Œæ‚„æ‚„é£˜è¿›äº†ä¸€ç¼•æ¥è‡ªå±±é‡çš„ã€å¸¦ç€æ³¥åœŸæ°”æ¯çš„é£ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9b26b17a1174ad8855015af411dd4d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771085292&amp;x-signature=IIWPMEFjlNIPjzeb5fGSfB6Gd9o%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SeeDream Images Generation API å¯¹æ¥è¯´æ˜]]></title>    <link>https://juejin.cn/post/7603643385816137780</link>    <guid>https://juejin.cn/post/7603643385816137780</guid>    <pubDate>2026-02-07T15:29:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603643385816137780" data-draft-id="7603616672927498255" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SeeDream Images Generation API å¯¹æ¥è¯´æ˜"/> <meta itemprop="keywords" content="API"/> <meta itemprop="datePublished" content="2026-02-07T15:29:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å´”åº†æ‰ä¸¨é™è§…"/> <meta itemprop="url" content="https://juejin.cn/user/1521379821230269"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SeeDream Images Generation API å¯¹æ¥è¯´æ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1521379821230269/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å´”åº†æ‰ä¸¨é™è§…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T15:29:25.000Z" title="Sat Feb 07 2026 15:29:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡å°†ä»‹ç»ä¸€ç§ SeeDream Images Generation API å¯¹æ¥è¯´æ˜ï¼Œå®ƒæ˜¯å¯ä»¥é€šè¿‡è¾“å…¥è‡ªå®šä¹‰å‚æ•°æ¥ç”Ÿæˆ SeeDream å®˜æ–¹çš„å›¾ç‰‡ã€‚</p>
<h2 data-id="heading-0">ç”³è¯·æµç¨‹</h2>
<p>è¦ä½¿ç”¨ APIï¼Œéœ€è¦å…ˆåˆ° <a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.acedata.cloud%2Fdocuments%2Fseedream-images" target="_blank" title="https://platform.acedata.cloud/documents/seedream-images" ref="nofollow noopener noreferrer">SeeDream Images Generation API</a> å¯¹åº”é¡µé¢ç”³è¯·å¯¹åº”çš„æœåŠ¡ï¼Œè¿›å…¥é¡µé¢ä¹‹åï¼Œç‚¹å‡»ã€ŒAcquireã€æŒ‰é’®ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/10a0e0fd8f884af9b4ad23397f09dde8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bSU5bqG5omN5Lio6Z2Z6KeF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771082964&amp;x-signature=d%2FpyDKyKk%2BoaRpLbsszXxwWD34I%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœä½ å°šæœªç™»å½•æˆ–æ³¨å†Œï¼Œä¼šè‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µé¢é‚€è¯·æ‚¨æ¥æ³¨å†Œå’Œç™»å½•ï¼Œç™»å½•æ³¨å†Œä¹‹åä¼šè‡ªåŠ¨è¿”å›å½“å‰é¡µé¢ã€‚</p>
<p>åœ¨é¦–æ¬¡ç”³è¯·æ—¶ä¼šæœ‰å…è´¹é¢åº¦èµ é€ï¼Œå¯ä»¥å…è´¹ä½¿ç”¨è¯¥ APIã€‚</p>
<h2 data-id="heading-1">åŸºæœ¬ä½¿ç”¨</h2>
<p>é¦–å…ˆå…ˆäº†è§£ä¸‹åŸºæœ¬çš„ä½¿ç”¨æ–¹å¼ï¼Œå°±æ˜¯è¾“å…¥æç¤ºè¯ <code>prompt</code>ã€ ç”Ÿæˆè¡Œä¸º <code>action</code>ã€å›¾ç‰‡å°ºå¯¸ <code>size</code>ï¼Œä¾¿å¯è·å¾—å¤„ç†åçš„ç»“æœï¼Œé¦–å…ˆéœ€è¦ç®€å•åœ°ä¼ é€’ä¸€ä¸ª <code>action</code> å­—æ®µï¼Œå®ƒçš„å€¼ä¸º <code>generate</code>ï¼Œç„¶åæˆ‘ä»¬è¿˜éœ€è¦è¾“å…¥æç¤ºè¯ï¼Œå…·ä½“çš„å†…å®¹å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa0aa47cb69a4048a6aaeff101b23731~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bSU5bqG5omN5Lio6Z2Z6KeF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771082964&amp;x-signature=CsSb9YcodUIy5UlQdIu5UbRGaO4%3D" width="500" class="m-auto" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæˆ‘ä»¬è®¾ç½®äº† Request Headersï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><code>accept</code>ï¼šæƒ³è¦æ¥æ”¶æ€æ ·æ ¼å¼çš„å“åº”ç»“æœï¼Œè¿™é‡Œå¡«å†™ä¸º <code>application/json</code>ï¼Œå³ JSON æ ¼å¼ã€‚</li>
<li><code>authorization</code>ï¼šè°ƒç”¨ API çš„å¯†é’¥ï¼Œç”³è¯·ä¹‹åå¯ä»¥ç›´æ¥ä¸‹æ‹‰é€‰æ‹©ã€‚</li>
</ul>
<p>å¦å¤–è®¾ç½®äº† Request Bodyï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><code>prompt</code>ï¼šæç¤ºè¯ã€‚</li>
<li><code>model</code>ï¼šç”Ÿæˆæ¨¡å‹ï¼Œé»˜è®¤ <code>doubao-seedream-4.0</code>ã€‚</li>
<li><code>image</code>: è¾“å…¥çš„å›¾ç‰‡ä¿¡æ¯ï¼Œæ”¯æŒ URL æˆ– Base64 ç¼–ç ã€‚å…¶ä¸­ï¼Œ<code>doubao-seedream-4.5</code>ã€<code>doubao-seedream-4.0</code> æ”¯æŒå•å›¾æˆ–å¤šå›¾è¾“å…¥,<code>doubao-seededit-3.0-i2i</code> ä»…æ”¯æŒå•å›¾è¾“å…¥,<code>doubao-seededit-3.0-t2i</code> ä¸æ”¯æŒè¯¥å‚</li>
<li><code>size</code>: æŒ‡å®šç”Ÿæˆå›¾åƒçš„å°ºå¯¸ä¿¡æ¯ï¼Œæ”¯æŒä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼Œä¸å¯æ··ç”¨ã€‚æ–¹å¼ 1 | æŒ‡å®šç”Ÿæˆå›¾åƒçš„åˆ†è¾¨ç‡ï¼Œå¹¶åœ¨promptä¸­ç”¨è‡ªç„¶è¯­è¨€æè¿°å›¾ç‰‡å®½é«˜æ¯”ã€å›¾ç‰‡å½¢çŠ¶æˆ–å›¾ç‰‡ç”¨é€”ï¼Œæœ€ç»ˆç”±æ¨¡å‹åˆ¤æ–­ç”Ÿæˆå›¾ç‰‡çš„å¤§å°ã€‚æ–¹å¼ 2 | æŒ‡å®šç”Ÿæˆå›¾åƒçš„å®½é«˜åƒç´ å€¼ï¼šé»˜è®¤å€¼ï¼š<code>2048x2048</code> æ ¹æ®æ¨¡å‹ä¸åŒé»˜è®¤å€¼ä¸åŒ</li>
<li><code>seed</code>: éšæœºæ•°ç§å­ï¼Œç”¨äºæ§åˆ¶æ¨¡å‹ç”Ÿæˆå†…å®¹çš„éšæœºæ€§ã€‚å–å€¼èŒƒå›´ä¸º [-1, 2147483647]ã€‚ä»… <code>doubao-seedream-3.0-t2i</code>ã€<code>doubao-seededit-3.0-i2i</code> æ”¯æŒè¯¥å‚æ•°</li>
<li><code>sequential_image_generation</code>: ç»„å›¾ï¼šåŸºäºæ‚¨è¾“å…¥çš„å†…å®¹ï¼Œç”Ÿæˆçš„ä¸€ç»„å†…å®¹å…³è”çš„å›¾ç‰‡ã€‚ä»… <code>doubao-seedream-4.5</code>ã€<code>doubao-seedream-4.0</code> æ”¯æŒè¯¥å‚æ•°ï¼Œ é»˜è®¤ <code>disabled</code></li>
<li><code>stream</code>: æ§åˆ¶æ˜¯å¦å¼€å¯æµå¼è¾“å‡ºæ¨¡å¼ã€‚ä»… <code>doubao-seedream-4.5</code>ã€<code>doubao-seedream-4.0</code> æ”¯æŒè¯¥å‚æ•°ï¼Œé»˜è®¤æ˜¯ <code>false</code></li>
<li><code>guidance_scale</code>: æ¨¡å‹è¾“å‡ºç»“æœä¸promptçš„ä¸€è‡´ç¨‹åº¦ï¼Œç”Ÿæˆå›¾åƒçš„è‡ªç”±åº¦ï¼Œåˆç§°ä¸ºæ–‡æœ¬æƒé‡ï¼›å€¼è¶Šå¤§ï¼Œæ¨¡å‹è‡ªç”±åº¦è¶Šå°ï¼Œä¸ç”¨æˆ·è¾“å…¥çš„æç¤ºè¯ç›¸å…³æ€§è¶Šå¼ºã€‚å–å€¼èŒƒå›´ï¼š[1, 10] ã€‚<code>doubao-seedream-3.0-t2i</code> é»˜è®¤å€¼ 2.5, <code>doubao-seededit-3.0-i2i</code>é»˜è®¤å€¼ 5.5ï¼Œ å…¶ä»–ä¸æ”¯æŒ</li>
<li><code>response_format</code>: æŒ‡å®šç”Ÿæˆå›¾åƒçš„è¿”å›æ ¼å¼ã€‚é»˜è®¤æ˜¯<code>url</code>ï¼Œä¹Ÿæ”¯æŒ<code>b64_json</code></li>
<li><code>watermark</code>: æ˜¯å¦åœ¨ç”Ÿæˆçš„å›¾ç‰‡ä¸­æ·»åŠ æ°´å°ã€‚é»˜è®¤æ˜¯ <code>true</code></li>
<li><code>callback_url</code>ï¼šéœ€è¦å›è°ƒç»“æœçš„ URLã€‚</li>
</ul>
<p>é€‰æ‹©ä¹‹åï¼Œå¯ä»¥å‘ç°å³ä¾§ä¹Ÿç”Ÿæˆäº†å¯¹åº”ä»£ç ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a443d1d538c6426db5896e6b3e8ba90a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bSU5bqG5omN5Lio6Z2Z6KeF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771082964&amp;x-signature=D0f6HVVo1kqNcvlkN40Oguh237A%3D" width="500" class="m-auto" loading="lazy"/></p>
<p>ç‚¹å‡»ã€ŒTryã€æŒ‰é’®å³å¯è¿›è¡Œæµ‹è¯•ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œè¿™é‡Œæˆ‘ä»¬å°±å¾—åˆ°äº†å¦‚ä¸‹ç»“æœï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"25027ba3-0430-4a1b-91c8-d2297f19ba73"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"8043a9e9-692f-43b0-82f7-5890f798be38"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"prompt"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"a white siamese cat"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"size"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2048x2048"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"image_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://platform.cdn.acedata.cloud/seedream/3c060029-69b1-406f-a957-fcd55ddc9386.jpg"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>è¿”å›ç»“æœä¸€å…±æœ‰å¤šä¸ªå­—æ®µï¼Œä»‹ç»å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>success</code>ï¼Œæ­¤æ—¶è§†é¢‘ç”Ÿæˆä»»åŠ¡çš„çŠ¶æ€æƒ…å†µã€‚</li>
<li><code>task_id</code>ï¼Œæ­¤æ—¶è§†é¢‘ç”Ÿæˆä»»åŠ¡ IDã€‚</li>
<li><code>trace_id</code>ï¼Œæ­¤æ—¶è§†é¢‘ç”Ÿæˆè·Ÿè¸ª IDã€‚</li>
<li><code>data</code>ï¼Œæ­¤æ—¶å›¾åƒç”Ÿæˆä»»åŠ¡çš„ç»“æœåˆ—è¡¨ã€‚
<ul>
<li><code>image_url</code>ï¼Œæ­¤æ—¶å›¾ç‰‡ç”Ÿæˆä»»åŠ¡çš„é“¾æ¥ã€‚</li>
<li><code>prompt</code>ï¼Œæç¤ºè¯ã€‚</li>
<li><code>size</code>: ç”Ÿæˆå›¾çš„åƒç´ </li>
</ul>
</li>
</ul>
<p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¾—åˆ°äº†æ»¡æ„çš„å›¾ç‰‡ä¿¡æ¯ï¼Œæˆ‘ä»¬åªéœ€è¦æ ¹æ®ç»“æœä¸­ <code>data</code> çš„å›¾ç‰‡é“¾æ¥åœ°å€è·å–ç”Ÿæˆçš„ SeeDream å›¾ç‰‡å³å¯ã€‚</p>
<p>å¦å¤–å¦‚æœæƒ³ç”Ÿæˆå¯¹åº”çš„å¯¹æ¥ä»£ç ï¼Œå¯ä»¥ç›´æ¥å¤åˆ¶ç”Ÿæˆï¼Œä¾‹å¦‚ CURL çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">curl -X POST 'https://api.acedata.cloud/seedream/images' \
-H 'accept: application/json' \
-H 'authorization: Bearer ${token}' \
-H 'content-type: application/json' \
-d '{
  "action": "generate",
  "model": "doubao-seedream-4-0-250828",
  "prompt": "a white siamese cat"
}'
</code></pre>
<h2 data-id="heading-2">ç¼–è¾‘å›¾ç‰‡ä»»åŠ¡</h2>
<p>å¦‚æœæƒ³å¯¹æŸå¼ å›¾ç‰‡è¿›è¡Œç¼–è¾‘çš„è¯ï¼Œ é¦–å…ˆå‚æ•°<code>image</code>å¿…é¡»ä¼ å…¥éœ€è¦ç¼–è¾‘çš„å›¾ç‰‡é“¾æ¥</p>
<ul>
<li>modelï¼šæ­¤æ¬¡ç¼–è¾‘å›¾ç‰‡ä»»åŠ¡æ‰€é‡‡ç”¨çš„æ¨¡å‹ï¼Œè¯¥ä»»åŠ¡ç›®å‰æ”¯æŒ <code>doubao-seedream-4.5</code>ã€<code>doubao-seedream-4.0</code> æ”¯æŒå•å›¾æˆ–å¤šå›¾è¾“å…¥ï¼Œ<code>doubao-seededit-3.0-i2i</code> ä»…æ”¯æŒå•å›¾è¾“å…¥ã€‚</li>
<li>imageï¼šä¸Šä¼ éœ€è¦ç¼–è¾‘çš„å›¾ç‰‡ï¼Œä¸€å¼ æˆ–è€…å¤šå¼ </li>
</ul>
<p>å¡«å†™æ ·ä¾‹å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/29099b62fe27483a95443e2a7a972cb0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bSU5bqG5omN5Lio6Z2Z6KeF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771082964&amp;x-signature=hUGfdv6toMbByzRgDcYNlqx14N8%3D" width="500" class="m-auto" loading="lazy"/></p>
<p>å¯¹åº”çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests

url = <span class="hljs-string">"https://api.acedata.cloud/flux/images"</span>

headers = {
    <span class="hljs-string">"accept"</span>: <span class="hljs-string">"application/json"</span>,
    <span class="hljs-string">"authorization"</span>: <span class="hljs-string">"Bearer {token}"</span>,
    <span class="hljs-string">"content-type"</span>: <span class="hljs-string">"application/json"</span>
}

payload = {
    <span class="hljs-string">"model"</span>: <span class="hljs-string">"doubao-seedream-4-0-250828"</span>,
  <span class="hljs-string">"prompt"</span>: <span class="hljs-string">"Keep the model pose and the liquid garment flowing shape unchanged. Change the clothing material from silver metal to completely transparent water (or glass). Through the liquid flow, the details of the model skin are visible. The light and shadow effect shifts from reflection to refraction."</span>,
  <span class="hljs-string">"image"</span>: [<span class="hljs-string">"https://ark-project.tos-cn-beijing.volces.com/doc_image/seedream4_5_imageToimage.png"</span>],
  <span class="hljs-string">"size"</span>: <span class="hljs-string">"2K"</span>,
  <span class="hljs-string">"watermark"</span>: <span class="hljs-literal">False</span>
}

response = requests.post(url, json=payload, headers=headers)
<span class="hljs-built_in">print</span>(response.text)
</code></pre>
<p>ç‚¹å‡»è¿è¡Œï¼Œå¯ä»¥å‘ç°ä¼šç«‹å³å¾—åˆ°ä¸€ä¸ªç»“æœï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"c9aaffa2-b8ac-40ff-8468-43e77cb9ddde"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"131a40c3-2eaf-44c9-af28-c9b408577286"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"prompt"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Keep the model pose and the liquid garment flowing shape unchanged. Change the clothing material from silver metal to completely transparent water (or glass). Through the liquid flow, the details of the model skin are visible. The light and shadow effect shifts from reflection to refraction."</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"size"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2048x2048"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"image_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://platform.cdn.acedata.cloud/seedream/3e88db7e-4771-4f6a-adbd-5ae4590c5d59.jpg"</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç”Ÿæˆçš„æ•ˆæœæ˜¯å¯¹åŸå›¾ç‰‡è¿›è¡Œç¼–è¾‘çš„æ•ˆæœï¼Œç»“æœä¸ä¸Šæ–‡ç±»ä¼¼ã€‚</p>
<h2 data-id="heading-3">å¼‚æ­¥å›è°ƒ</h2>
<p>ç”±äº SeeDream Images Generation API ç”Ÿæˆçš„æ—¶é—´ç›¸å¯¹è¾ƒé•¿ï¼Œå¤§çº¦éœ€è¦ 1-2 åˆ†é’Ÿï¼Œå¦‚æœ API é•¿æ—¶é—´æ— å“åº”ï¼ŒHTTP è¯·æ±‚ä¼šä¸€ç›´ä¿æŒè¿æ¥ï¼Œå¯¼è‡´é¢å¤–çš„ç³»ç»Ÿèµ„æºæ¶ˆè€—ï¼Œæ‰€ä»¥æœ¬ API ä¹Ÿæä¾›äº†å¼‚æ­¥å›è°ƒçš„æ”¯æŒã€‚</p>
<p>æ•´ä½“æµç¨‹æ˜¯ï¼šå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚çš„æ—¶å€™ï¼Œé¢å¤–æŒ‡å®šä¸€ä¸ª <code>callback_url</code> å­—æ®µï¼Œå®¢æˆ·ç«¯å‘èµ· API è¯·æ±‚ä¹‹åï¼ŒAPI ä¼šç«‹é©¬è¿”å›ä¸€ä¸ªç»“æœï¼ŒåŒ…å«ä¸€ä¸ª <code>task_id</code> çš„å­—æ®µä¿¡æ¯ï¼Œä»£è¡¨å½“å‰çš„ä»»åŠ¡ IDã€‚å½“ä»»åŠ¡å®Œæˆä¹‹åï¼Œç”Ÿæˆå›¾ç‰‡çš„ç»“æœä¼šé€šè¿‡ POST JSON çš„å½¢å¼å‘é€åˆ°å®¢æˆ·ç«¯æŒ‡å®šçš„ <code>callback_url</code>ï¼Œå…¶ä¸­ä¹ŸåŒ…æ‹¬äº† <code>task_id</code> å­—æ®µï¼Œè¿™æ ·ä»»åŠ¡ç»“æœå°±å¯ä»¥é€šè¿‡ ID å…³è”èµ·æ¥äº†ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡ç¤ºä¾‹æ¥äº†è§£ä¸‹å…·ä½“æ€æ ·æ“ä½œã€‚</p>
<p>ç‚¹å‡»è¿è¡Œï¼Œå¯ä»¥å‘ç°ä¼šç«‹å³å¾—åˆ°ä¸€ä¸ªç»“æœï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"c9aaffa2-b8ac-40ff-8468-43e77cb9ddde"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"task_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"c9aaffa2-b8ac-40ff-8468-43e77cb9ddde"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"131a40c3-2eaf-44c9-af28-c9b408577286"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"prompt"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Keep the model pose and the liquid garment flowing shape unchanged. Change the clothing material from silver metal to completely transparent water (or glass). Through the liquid flow, the details of the model skin are visible. The light and shadow effect shifts from reflection to refraction."</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"size"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2048x2048"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"image_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://platform.cdn.acedata.cloud/seedream/3e88db7e-4771-4f6a-adbd-5ae4590c5d59.jpg"</span>
        <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ç»“æœä¸­æœ‰ä¸€ä¸ª <code>task_id</code> å­—æ®µï¼Œå…¶ä»–çš„å­—æ®µéƒ½å’Œä¸Šæ–‡ç±»ä¼¼ï¼Œé€šè¿‡è¯¥å­—æ®µå³å¯å®ç°ä»»åŠ¡çš„å…³è”ã€‚</p>
<h2 data-id="heading-4">é”™è¯¯å¤„ç†</h2>
<p>åœ¨è°ƒç”¨ API æ—¶ï¼Œå¦‚æœé‡åˆ°é”™è¯¯ï¼ŒAPI ä¼šè¿”å›ç›¸åº”çš„é”™è¯¯ä»£ç å’Œä¿¡æ¯ã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li><code>400 token_mismatched</code>ï¼šBad request, possibly due to missing or invalid parameters.</li>
<li><code>400 api_not_implemented</code>ï¼šBad request, possibly due to missing or invalid parameters.</li>
<li><code>401 invalid_token</code>ï¼šUnauthorized, invalid or missing authorization token.</li>
<li><code>429 too_many_requests</code>ï¼šToo many requests, you have exceeded the rate limit.</li>
<li><code>500 api_error</code>ï¼šInternal server error, something went wrong on the server.</li>
</ul>
<h3 data-id="heading-5">é”™è¯¯å“åº”ç¤ºä¾‹</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"error"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"api_error"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"fetch failed"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"trace_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2cf86e86-22a4-46e1-ac2f-032c0f2a4e89"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-6">ç»“è®º</h2>
<p>é€šè¿‡æœ¬æ–‡æ¡£ï¼Œæ‚¨å·²ç»äº†è§£äº†å¦‚ä½•ä½¿ç”¨ SeeDream Images Generation API å¯é€šè¿‡è¾“å…¥æç¤ºè¯æ¥ç”Ÿæˆå›¾ç‰‡ã€‚å¸Œæœ›æœ¬æ–‡æ¡£èƒ½å¸®åŠ©æ‚¨æ›´å¥½åœ°å¯¹æ¥å’Œä½¿ç”¨è¯¥ APIã€‚å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·éšæ—¶è”ç³»æˆ‘ä»¬çš„æŠ€æœ¯æ”¯æŒå›¢é˜Ÿã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OpenClawå…¥é—¨ï¼šä»é›¶å¼€å§‹æ­å»ºä½ çš„ç§æœ‰åŒ–AIåŠ©æ‰‹]]></title>    <link>https://juejin.cn/post/7603687444051410982</link>    <guid>https://juejin.cn/post/7603687444051410982</guid>    <pubDate>2026-02-07T15:55:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603687444051410982" data-draft-id="7603651855236022281" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OpenClawå…¥é—¨ï¼šä»é›¶å¼€å§‹æ­å»ºä½ çš„ç§æœ‰åŒ–AIåŠ©æ‰‹"/> <meta itemprop="keywords" content="æ¶æ„,GitHub,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-07T15:55:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="iDaoæŠ€æœ¯é­”æ–¹"/> <meta itemprop="url" content="https://juejin.cn/user/166781496080782"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OpenClawå…¥é—¨ï¼šä»é›¶å¼€å§‹æ­å»ºä½ çš„ç§æœ‰åŒ–AIåŠ©æ‰‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/166781496080782/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    iDaoæŠ€æœ¯é­”æ–¹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T15:55:00.000Z" title="Sat Feb 07 2026 15:55:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä¸€å¥è¯ç®€ä»‹ï¼šOpenClawæ˜¯ä¸€ä¸ªå¯ä»¥åœ¨ä½ è‡ªå·±çš„è®¾å¤‡ä¸Šè¿è¡Œçš„ä¸ªäººAIåŠ©æ‰‹ï¼Œæ”¯æŒå¤šç§é€šè®¯æ¸ é“ï¼ˆWhatsAppã€Telegramã€Slackç­‰ï¼‰ï¼Œè®©ä½ æ‹¥æœ‰ä¸€ä¸ªçœŸæ­£å±äºè‡ªå·±çš„æ™ºèƒ½åŠ©æ‰‹ï¼Œæ•°æ®å®Œå…¨æŒæ§åœ¨è‡ªå·±æ‰‹ä¸­ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ğŸ“‹ ç›®å½•</h2>
<ul>
<li><a href="#openclaw%E6%98%AF%E4%BB%80%E4%B9%88" title="#openclaw%E6%98%AF%E4%BB%80%E4%B9%88">OpenClawæ˜¯ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%80%89%E6%8B%A9openclaw" title="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%80%89%E6%8B%A9openclaw">ä¸ºä»€ä¹ˆé€‰æ‹©OpenClawï¼Ÿ</a></li>
<li><a href="#%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE" title="#%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE">å®‰è£…ä¸é…ç½®</a></li>
<li><a href="#%E9%A6%96%E6%AC%A1%E8%BF%90%E8%A1%8C" title="#%E9%A6%96%E6%AC%A1%E8%BF%90%E8%A1%8C">é¦–æ¬¡è¿è¡Œï¼šOnboardingå‘å¯¼</a></li>
<li><a href="#%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8" title="#%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8">åŸºç¡€ä½¿ç”¨ï¼šå‘é€ç¬¬ä¸€æ¡æ¶ˆæ¯</a></li>
<li><a href="#%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5%E8%A7%A3%E6%9E%90" title="#%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5%E8%A7%A3%E6%9E%90">æ ¸å¿ƒæ¦‚å¿µè§£æ</a></li>
<li><a href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98" title="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98">å¸¸è§é—®é¢˜ä¸æ•…éšœæ’é™¤</a></li>
<li><a href="#%E8%BF%9B%E9%98%B6%E5%8A%9F%E8%83%BD" title="#%E8%BF%9B%E9%98%B6%E5%8A%9F%E8%83%BD">è¿›é˜¶åŠŸèƒ½æ¢ç´¢</a></li>
<li><a href="#%E6%80%BB%E7%BB%93" title="#%E6%80%BB%E7%BB%93">æ€»ç»“ä¸èµ„æº</a></li>
</ul>
<hr/>
<h2 data-id="heading-1">OpenClawæ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<h3 data-id="heading-2">é€šä¿—ç†è§£</h3>
<p>æƒ³è±¡ä½ æœ‰ä¸€ä¸ª<strong>24å°æ—¶åœ¨çº¿çš„ç§äººåŠ©ç†</strong>ï¼Œå®ƒèƒ½ï¼š</p>
<ul>
<li>ğŸ“± åœ¨ä½ å¸¸ç”¨çš„èŠå¤©è½¯ä»¶é‡Œï¼ˆå¾®ä¿¡ã€Telegramã€WhatsAppã€Slackç­‰ï¼‰å›å¤ä½ </li>
<li>ğŸ”Š ç”¨è¯­éŸ³å’Œä½ å¯¹è¯ï¼ˆæ”¯æŒElevenLabsè¯­éŸ³åˆæˆï¼‰</li>
<li>ğŸ¨ å±•ç¤ºå¯è§†åŒ–ç•Œé¢ï¼ˆLive Canvasï¼‰</li>
<li>ğŸŒ å¸®ä½ æ§åˆ¶æµè§ˆå™¨è‡ªåŠ¨æ‰§è¡Œä»»åŠ¡</li>
<li>ğŸ“¸ ä½¿ç”¨æ‰‹æœºæ‘„åƒå¤´å’Œå±å¹•å½•åˆ¶</li>
<li>â° è®¾ç½®å®šæ—¶ä»»åŠ¡å’Œæé†’</li>
</ul>
<p><strong>æœ€é‡è¦çš„æ˜¯</strong>ï¼šè¿™ä¸€åˆ‡éƒ½åœ¨ä½ è‡ªå·±çš„è®¾å¤‡ä¸Šè¿è¡Œï¼Œæ•°æ®ä¸ç»è¿‡ç¬¬ä¸‰æ–¹æœåŠ¡å™¨ï¼Œéšç§å®Œå…¨ç”±ä½ æŒæ§ã€‚</p>
<h3 data-id="heading-3">æŠ€æœ¯æ¶æ„</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph "é€šè®¯æ¸ é“"
        A[WhatsApp]
        B[Telegram]
        C[Slack]
        D[Discord]
    end
    
    subgraph "OpenClaw Gateway"
        E[æ§åˆ¶ä¸­å¿ƒ&lt;br/&gt;localhost:18789]
    end
    
    subgraph "æ ¸å¿ƒç»„ä»¶"
        F[Pi Agent&lt;br/&gt;AIå¤§è„‘]
        G[Browserå·¥å…·]
        H[Voiceè¯­éŸ³]
        I[Nodesè®¾å¤‡]
    end
    
    A --&gt; E
    B --&gt; E
    C --&gt; E
    D --&gt; E
    
    E --&gt; F
    F --&gt; G
    F --&gt; H
    F --&gt; I
</code></pre>
<hr/>
<h2 data-id="heading-4">ä¸ºä»€ä¹ˆé€‰æ‹©OpenClawï¼Ÿ</h2>
<h3 data-id="heading-5">å¯¹æ¯”å…¶ä»–AIåŠ©æ‰‹</h3>









































<table><thead><tr><th>ç‰¹æ€§</th><th>ChatGPT</th><th>Claude</th><th>OpenClaw</th></tr></thead><tbody><tr><td><strong>ç§æœ‰åŒ–éƒ¨ç½²</strong></td><td>âŒ äº‘ç«¯</td><td>âŒ äº‘ç«¯</td><td>âœ… æœ¬åœ°è¿è¡Œ</td></tr><tr><td><strong>å¤šæ¸ é“æ¥å…¥</strong></td><td>âŒ ä»…App/Web</td><td>âŒ ä»…App/Web</td><td>âœ… WhatsApp/Slack/Telegramç­‰</td></tr><tr><td><strong>è¯­éŸ³äº¤äº’</strong></td><td>âš ï¸ æœ‰é™</td><td>âš ï¸ æœ‰é™</td><td>âœ… å®Œæ•´è¯­éŸ³æ”¯æŒ</td></tr><tr><td><strong>å¯æ‰©å±•æ€§</strong></td><td>âš ï¸ æ’ä»¶ç³»ç»Ÿ</td><td>âš ï¸ æœ‰é™</td><td>âœ… Skillsç³»ç»Ÿ</td></tr><tr><td><strong>æˆæœ¬</strong></td><td>ğŸ’° è®¢é˜…åˆ¶</td><td>ğŸ’° è®¢é˜…åˆ¶</td><td>ğŸ†“ å¼€æºå…è´¹</td></tr></tbody></table>
<h3 data-id="heading-6">é€‚åˆè°ç”¨ï¼Ÿ</h3>
<p>âœ… <strong>æ¨è</strong>ï¼š</p>
<ul>
<li>éšç§æ•æ„Ÿç”¨æˆ·ï¼ˆæ•°æ®ä¸æƒ³ä¸Šäº‘ï¼‰</li>
<li>æå®¢/å¼€å‘è€…ï¼ˆå–œæ¬¢æŠ˜è…¾æœ¬åœ°éƒ¨ç½²ï¼‰</li>
<li>å¤šå¹³å°ç”¨æˆ·ï¼ˆåŒæ—¶ä½¿ç”¨å¤šä¸ªèŠå¤©å·¥å…·ï¼‰</li>
<li>éœ€è¦è‡ªåŠ¨åŒ–å·¥ä½œæµçš„ç”¨æˆ·</li>
</ul>
<p>âŒ <strong>ä¸æ¨è</strong>ï¼š</p>
<ul>
<li>å®Œå…¨ä¸æƒ³é…ç½®çš„æŠ€æœ¯å°ç™½</li>
<li>æ²¡æœ‰ç¨³å®šè¿è¡Œç¯å¢ƒçš„ç”¨æˆ·</li>
<li>åªéœ€è¦ç®€å•é—®ç­”çš„åœºæ™¯ï¼ˆç”¨ChatGPTæ›´æ–¹ä¾¿ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-7">å®‰è£…ä¸é…ç½®</h2>
<h3 data-id="heading-8">ç³»ç»Ÿè¦æ±‚</h3>
<ul>
<li><strong>æ“ä½œç³»ç»Ÿ</strong>ï¼šmacOS / Linux / Windows (WSL2)</li>
<li><strong>Node.js</strong>ï¼šâ‰¥ 22 ç‰ˆæœ¬</li>
<li><strong>åŒ…ç®¡ç†å™¨</strong>ï¼šnpm / pnpm / bun</li>
<li><strong>å†…å­˜</strong>ï¼šå»ºè®® 4GB+ï¼ˆè¿è¡Œæœ¬åœ°æ¨¡å‹éœ€è¦æ›´å¤šï¼‰</li>
</ul>
<h3 data-id="heading-9">å®‰è£…æ­¥éª¤</h3>
<h4 data-id="heading-10">æ–¹å¼1ï¼šé€šè¿‡npmå®‰è£…ï¼ˆæ¨èï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…OpenClaw CLI</span>
npm install -g openclaw@latest

<span class="hljs-comment"># æˆ–è€…ä½¿ç”¨pnpmï¼ˆæ›´å¿«ï¼‰</span>
pnpm add -g openclaw@latest
</code></pre>
<h4 data-id="heading-11">æ–¹å¼2ï¼šä»æºç å®‰è£…ï¼ˆå¼€å‘è€…ï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…‹éš†ä»“åº“</span>
git <span class="hljs-built_in">clone</span> https://github.com/openclaw/openclaw.git
<span class="hljs-built_in">cd</span> openclaw

<span class="hljs-comment"># å®‰è£…ä¾èµ–</span>
pnpm install
pnpm ui:build

<span class="hljs-comment"># æ„å»º</span>
pnpm build

<span class="hljs-comment"># è¿è¡Œå‘å¯¼</span>
pnpm openclaw onboard --install-daemon
</code></pre>
<h3 data-id="heading-12">é…ç½®AIæ¨¡å‹</h3>
<p>OpenClawæ”¯æŒå¤šä¸ªAIæä¾›å•†ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é…ç½®Anthropic Claudeï¼ˆæ¨èï¼‰</span>
openclaw auth add anthropic --oauth

<span class="hljs-comment"># é…ç½®OpenAI</span>
openclaw auth add openai --oauth

<span class="hljs-comment"># æŸ¥çœ‹å·²é…ç½®çš„æ¨¡å‹</span>
openclaw models list
</code></pre>
<p><strong>æ¨èé…ç½®</strong>ï¼šAnthropic Pro/Max + Opus 4.6ï¼ˆé•¿ä¸Šä¸‹æ–‡ã€æ›´å¥½çš„æç¤ºæ³¨å…¥é˜²æŠ¤ï¼‰</p>
<hr/>
<h2 data-id="heading-13">é¦–æ¬¡è¿è¡Œ</h2>
<h3 data-id="heading-14">å¯åŠ¨å‘å¯¼</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¿è¡Œé…ç½®å‘å¯¼ï¼ˆä¼šè‡ªåŠ¨å®‰è£…åå°æœåŠ¡ï¼‰</span>
openclaw onboard --install-daemon
</code></pre>
<p>å‘å¯¼ä¼šå¼•å¯¼ä½ å®Œæˆï¼š</p>
<ol>
<li><strong>Gatewayé…ç½®</strong> - è®¾ç½®æ§åˆ¶å¹³é¢</li>
<li><strong>å·¥ä½œç©ºé—´</strong> - é…ç½®AIåŠ©æ‰‹çš„å·¥ä½œç›®å½•</li>
<li><strong>æ¸ é“æ¥å…¥</strong> - è¿æ¥WhatsApp/Telegram/Slackç­‰</li>
<li><strong>æŠ€èƒ½å®‰è£…</strong> - æ·»åŠ é¢å¤–åŠŸèƒ½</li>
</ol>
<h3 data-id="heading-15">å¯åŠ¨GatewayæœåŠ¡</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å‰å°è¿è¡Œï¼ˆè°ƒè¯•æ¨¡å¼ï¼‰</span>
openclaw gateway --port 18789 --verbose

<span class="hljs-comment"># æ£€æŸ¥çŠ¶æ€</span>
openclaw status

<span class="hljs-comment"># è¯¦ç»†è¯Šæ–­</span>
openclaw status --all
</code></pre>
<h3 data-id="heading-16">è®¿é—®Webç•Œé¢</h3>
<p>Gatewayå¯åŠ¨åï¼Œå¯ä»¥é€šè¿‡æµè§ˆå™¨è®¿é—®ï¼š</p>
<ul>
<li>æœ¬åœ°åœ°å€ï¼š<code>http://localhost:18789</code></li>
<li>æŸ¥çœ‹Tokenï¼š<code>openclaw dashboard token</code></li>
</ul>
<hr/>
<h2 data-id="heading-17">åŸºç¡€ä½¿ç”¨</h2>
<h3 data-id="heading-18">æ–¹å¼1ï¼šå‘½ä»¤è¡Œå‘é€</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å‘é€æ¶ˆæ¯åˆ°æŒ‡å®šå·ç ï¼ˆç¤ºä¾‹ï¼‰</span>
openclaw message send \
  --to +1234567890 \
  --message <span class="hljs-string">"Hello from OpenClaw!"</span>
</code></pre>
<h3 data-id="heading-19">æ–¹å¼2ï¼šä¸AIåŠ©æ‰‹å¯¹è¯</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç›´æ¥å’ŒPi Agentå¯¹è¯</span>
openclaw agent --message <span class="hljs-string">"å¸®æˆ‘å†™ä¸€ä¸ªPythonè„šæœ¬è®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—"</span>

<span class="hljs-comment"># é«˜çº§æ¨¡å¼ï¼ˆæ˜¾ç¤ºæ€è€ƒè¿‡ç¨‹ï¼‰</span>
openclaw agent \
  --message <span class="hljs-string">"åˆ†æè¿™ä¸ªé”™è¯¯æ—¥å¿—"</span> \
  --thinking high \
  --verbose
</code></pre>
<h3 data-id="heading-20">æ–¹å¼3ï¼šé€šè¿‡èŠå¤©åº”ç”¨</h3>
<p>é…ç½®å¥½æ¸ é“åï¼Œç›´æ¥åœ¨ä½ çš„WhatsApp/Telegram/Slacké‡Œå‘é€æ¶ˆæ¯ç»™OpenClawå³å¯ã€‚</p>
<p><strong>ç¤ºä¾‹å¯¹è¯</strong>ï¼š</p>
<pre><code class="hljs language-erlang" lang="erlang">ä½ ï¼šå¸®æˆ‘æŸ¥ä¸€ä¸‹æ˜å¤©çš„å¤©æ°”
OpenClawï¼šæ­£åœ¨æŸ¥è¯¢å¤©æ°”é¢„æŠ¥...
[ä½¿ç”¨Browserå·¥å…·æ‰“å¼€å¤©æ°”ç½‘ç«™]
åŒ—äº¬æ˜å¤©å¤šäº‘ï¼Œæ°”æ¸©<span class="hljs-number">15</span>-<span class="hljs-number">22</span>â„ƒ...
</code></pre>
<hr/>
<h2 data-id="heading-21">æ ¸å¿ƒæ¦‚å¿µè§£æ</h2>
<h3 data-id="heading-22">1. Gatewayï¼ˆç½‘å…³ï¼‰</h3>
<p><strong>ç†è§£</strong>ï¼šå°±åƒè·¯ç”±å™¨çš„æ§åˆ¶ä¸­å¿ƒï¼Œæ‰€æœ‰æ¶ˆæ¯éƒ½ç»è¿‡è¿™é‡Œè½¬å‘ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Gatewayå¸¸ç”¨å‘½ä»¤</span>
openclaw gateway start      <span class="hljs-comment"># å¯åŠ¨</span>
openclaw gateway stop       <span class="hljs-comment"># åœæ­¢</span>
openclaw gateway status     <span class="hljs-comment"># æŸ¥çœ‹çŠ¶æ€</span>
openclaw gateway logs       <span class="hljs-comment"># æŸ¥çœ‹æ—¥å¿—</span>
</code></pre>
<h3 data-id="heading-23">2. Agentï¼ˆæ™ºèƒ½ä½“ï¼‰</h3>
<p><strong>ç†è§£</strong>ï¼šAIçš„å¤§è„‘ï¼Œè´Ÿè´£ç†è§£ä½ çš„æ„å›¾å¹¶æ‰§è¡Œä»»åŠ¡ã€‚</p>
<ul>
<li><strong>Pi Agent</strong>ï¼šå†…ç½®çš„é»˜è®¤åŠ©æ‰‹</li>
<li><strong>å¤šAgentè·¯ç”±</strong>ï¼šå¯ä»¥ä¸ºä¸åŒæ¸ é“é…ç½®ä¸åŒAgent</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹AgentçŠ¶æ€</span>
openclaw agents list

<span class="hljs-comment"># åˆ‡æ¢Agent</span>
openclaw agent --switch &lt;agent-name&gt;
</code></pre>
<h3 data-id="heading-24">3. Channelsï¼ˆæ¸ é“ï¼‰</h3>
<p><strong>ç†è§£</strong>ï¼šOpenClawå’Œä½ çš„èŠå¤©åº”ç”¨ä¹‹é—´çš„æ¡¥æ¢ã€‚</p>
<p>æ”¯æŒçš„æ¸ é“ï¼š</p>
<ul>
<li>ğŸ“± <strong>æ¶ˆæ¯ç±»</strong>ï¼šWhatsAppã€Telegramã€Signalã€iMessage</li>
<li>ğŸ’¼ <strong>åŠå…¬ç±»</strong>ï¼šSlackã€Discordã€Microsoft Teamsã€Google Chat</li>
<li>ğŸŒ <strong>å…¶ä»–</strong>ï¼šMatrixã€Zaloã€WebChat</li>
</ul>
<p>é…ç½®ç¤ºä¾‹ï¼ˆ<code>~/.openclaw/openclaw.json</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-json5" lang="json5">{
  "channels": {
    "telegram": {
      "enabled": true,
      "token": "YOUR_BOT_TOKEN"
    },
    "slack": {
      "enabled": true,
      "appToken": "xapp-...",
      "botToken": "xoxb-..."
    }
  }
}
</code></pre>
<h3 data-id="heading-25">4. Toolsï¼ˆå·¥å…·ï¼‰</h3>
<p><strong>ç†è§£</strong>ï¼šAgentçš„æ‰‹å’Œçœ¼ç›ï¼Œè®©å®ƒèƒ½æ‰§è¡Œå®é™…æ“ä½œã€‚</p>





























<table><thead><tr><th>å·¥å…·</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><strong>Browser</strong></td><td>æ§åˆ¶Chromeæµè§ˆå™¨è‡ªåŠ¨æ“ä½œ</td></tr><tr><td><strong>Canvas</strong></td><td>å¯è§†åŒ–å·¥ä½œç•Œé¢</td></tr><tr><td><strong>Voice</strong></td><td>è¯­éŸ³å¯¹è¯ï¼ˆElevenLabsï¼‰</td></tr><tr><td><strong>Nodes</strong></td><td>è®¾å¤‡æ§åˆ¶ï¼ˆæ‘„åƒå¤´ã€å±å¹•å½•åˆ¶ï¼‰</td></tr><tr><td><strong>Cron</strong></td><td>å®šæ—¶ä»»åŠ¡</td></tr></tbody></table>
<h3 data-id="heading-26">5. Skillsï¼ˆæŠ€èƒ½ï¼‰</h3>
<p><strong>ç†è§£</strong>ï¼šæ‰©å±•åŠŸèƒ½åŒ…ï¼Œåƒæµè§ˆå™¨æ’ä»¶ä¸€æ ·å¢å¼ºèƒ½åŠ›ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹å·²å®‰è£…æŠ€èƒ½</span>
openclaw skills list

<span class="hljs-comment"># å®‰è£…æ–°æŠ€èƒ½</span>
openclaw skills install &lt;skill-name&gt;

<span class="hljs-comment"># ä»GitHubå®‰è£…</span>
openclaw skills install github:user/repo@skill-name
</code></pre>
<hr/>
<h2 data-id="heading-27">å¸¸è§é—®é¢˜</h2>
<h3 data-id="heading-28">Q1: å®‰è£…åæ— æ³•å¯åŠ¨Gatewayï¼Ÿ</h3>
<p><strong>æ’æŸ¥æ­¥éª¤</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æ£€æŸ¥Nodeç‰ˆæœ¬</span>
node --version  <span class="hljs-comment"># éœ€è¦â‰¥22</span>

<span class="hljs-comment"># 2. æ£€æŸ¥ç«¯å£å ç”¨</span>
lsof -i :18789  <span class="hljs-comment"># macOS/Linux</span>
netstat -ano | findstr 18789  <span class="hljs-comment"># Windows</span>

<span class="hljs-comment"># 3. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—</span>
openclaw gateway --verbose

<span class="hljs-comment"># 4. è¿è¡Œè¯Šæ–­</span>
openclaw doctor
</code></pre>
<h3 data-id="heading-29">Q2: å¡åœ¨"Wake up my friend"ç•Œé¢ï¼Ÿ</h3>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼ˆéœ€è¦è®¿é—®AIæä¾›å•†APIï¼‰</li>
<li>éªŒè¯APIå¯†é’¥é…ç½®ï¼š<code>openclaw auth list</code></li>
<li>é‡å¯Gatewayï¼š<code>openclaw gateway restart</code></li>
<li>æŸ¥çœ‹æ—¥å¿—ï¼š<code>openclaw logs --follow</code></li>
</ol>
<h3 data-id="heading-30">Q3: å¦‚ä½•ä¿æŠ¤éšç§å’Œå®‰å…¨ï¼Ÿ</h3>
<p><strong>å®‰å…¨å»ºè®®</strong>ï¼š</p>
<ul>
<li>å¯ç”¨DMé…å¯¹æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰ï¼šé™Œç”Ÿäººéœ€è¦éªŒè¯ç æ‰èƒ½å¯¹è¯</li>
<li>é…ç½®å…è®¸åˆ—è¡¨ï¼š<code>allowFrom</code>å­—æ®µ</li>
<li>å®šæœŸè¿è¡Œå®‰å…¨æ£€æŸ¥ï¼š<code>openclaw doctor</code></li>
<li>ä¸è¦åœ¨é…ç½®æ–‡ä»¶ä¸­ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯</li>
</ul>
<pre><code class="hljs language-json5" lang="json5">{
  "channels": {
    "telegram": {
      "dmPolicy": "pairing",  // éœ€è¦é…å¯¹
      "allowFrom": ["@your_username"]  // åªå…è®¸ç‰¹å®šç”¨æˆ·
    }
  }
}
</code></pre>
<h3 data-id="heading-31">Q4: å¦‚ä½•è¿œç¨‹è®¿é—®Gatewayï¼Ÿ</h3>
<p><strong>æ–¹æ¡ˆ1ï¼šTailscaleï¼ˆæ¨èï¼‰</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é…ç½®Tailscale</span>
openclaw config <span class="hljs-built_in">set</span> gateway.tailscale.mode serve

<span class="hljs-comment"># æˆ–è€…å…¬å¼€è®¿é—®ï¼ˆéœ€è¦å¯†ç ï¼‰</span>
openclaw config <span class="hljs-built_in">set</span> gateway.tailscale.mode funnel
openclaw config <span class="hljs-built_in">set</span> gateway.auth.mode password
</code></pre>
<p><strong>æ–¹æ¡ˆ2ï¼šSSHéš§é“</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æœ¬åœ°è½¬å‘</span>
ssh -L 18789:localhost:18789 your-server

<span class="hljs-comment"># è¿œç¨‹è®¿é—®</span>
openclaw gateway --remote wss://your-server:18789
</code></pre>
<hr/>
<h2 data-id="heading-32">è¿›é˜¶åŠŸèƒ½</h2>
<h3 data-id="heading-33">1. æµè§ˆå™¨è‡ªåŠ¨åŒ–</h3>
<p>è®©AIå¸®ä½ è‡ªåŠ¨æ“ä½œæµè§ˆå™¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨openclawç®¡ç†çš„æµè§ˆå™¨</span>
openclaw browser open <span class="hljs-string">"https://example.com"</span>

<span class="hljs-comment"># AIä¼šè‡ªåŠ¨ï¼š</span>
<span class="hljs-comment"># - æ‰“å¼€é¡µé¢</span>
<span class="hljs-comment"># - åˆ†æå†…å®¹</span>
<span class="hljs-comment"># - æ‰§è¡Œç‚¹å‡»ã€å¡«å†™è¡¨å•ç­‰æ“ä½œ</span>
<span class="hljs-comment"># - æˆªå›¾ä¿å­˜ç»“æœ</span>
</code></pre>
<h3 data-id="heading-34">2. è¯­éŸ³äº¤äº’ï¼ˆmacOS/iOS/Androidï¼‰</h3>
<p><strong>è®¾ç½®è¯­éŸ³å”¤é†’</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯ç”¨Voice Wake</span>
openclaw voice wake --<span class="hljs-built_in">enable</span>

<span class="hljs-comment"># è¯­éŸ³å¯¹è¯</span>
openclaw talk --start
</code></pre>
<p><strong>ä½“éªŒ</strong>ï¼šå°±åƒSiriæˆ–Alexaï¼Œä½†å®Œå…¨æœ¬åœ°è¿è¡Œï¼Œéšç§æ›´å¯æ§ã€‚</p>
<h3 data-id="heading-35">3. Live Canvaså¯è§†åŒ–</h3>
<p>AIå¯ä»¥åœ¨Canvasä¸Šå®æ—¶å±•ç¤ºä¿¡æ¯ï¼š</p>
<ul>
<li>ğŸ“Š æ•°æ®å¯è§†åŒ–</li>
<li>ğŸ¨ æµç¨‹å›¾ç”Ÿæˆ</li>
<li>ğŸ“ åä½œç™½æ¿</li>
<li>ğŸ–¼ï¸ å›¾ç‰‡ç¼–è¾‘</li>
</ul>
<h3 data-id="heading-36">4. å®šæ—¶ä»»åŠ¡ï¼ˆCronï¼‰</h3>
<p>è®¾ç½®è‡ªåŠ¨åŒ–å·¥ä½œæµï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ·»åŠ å®šæ—¶ä»»åŠ¡</span>
openclaw cron add <span class="hljs-string">"0 9 * * *"</span> <span class="hljs-string">"å‘é€æ¯æ—¥æ‘˜è¦"</span>

<span class="hljs-comment"># æŸ¥çœ‹ä»»åŠ¡</span>
openclaw cron list

<span class="hljs-comment"># åˆ é™¤ä»»åŠ¡</span>
openclaw cron remove &lt;job-id&gt;
</code></pre>
<h3 data-id="heading-37">5. è‡ªå®šä¹‰Skillså¼€å‘</h3>
<p>åˆ›å»ºè‡ªå·±çš„æŠ€èƒ½æ‰©å±•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆå§‹åŒ–æŠ€èƒ½</span>
openclaw skills init my-skill

<span class="hljs-comment"># å¼€å‘æŠ€èƒ½...</span>
<span class="hljs-comment"># å‚è€ƒï¼šskills/ç›®å½•ä¸‹çš„ç¤ºä¾‹</span>

<span class="hljs-comment"># æœ¬åœ°æµ‹è¯•</span>
openclaw skills install ./my-skill
</code></pre>
<hr/>
<h2 data-id="heading-38">æ€»ç»“</h2>
<h3 data-id="heading-39">æ ¸å¿ƒä¼˜åŠ¿</h3>
<p>âœ… <strong>ç§æœ‰åŒ–</strong>ï¼šæ•°æ®å®Œå…¨æŒæ§åœ¨è‡ªå·±æ‰‹ä¸­<br/>
âœ… <strong>å¤šæ¸ é“</strong>ï¼šç»Ÿä¸€æ¥å…¥å„ç§èŠå¤©åº”ç”¨<br/>
âœ… <strong>å¯æ‰©å±•</strong>ï¼šSkillsç³»ç»Ÿæ— é™æ‰©å±•èƒ½åŠ›<br/>
âœ… <strong>å¼€æº</strong>ï¼šå…è´¹ã€é€æ˜ã€ç¤¾åŒºé©±åŠ¨</p>
<h3 data-id="heading-40">å­¦ä¹ è·¯å¾„</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">Week 1:</span> <span class="hljs-string">å®‰è£…é…ç½®</span> <span class="hljs-string">â†’</span> <span class="hljs-string">åŸºç¡€å¯¹è¯</span> <span class="hljs-string">â†’</span> <span class="hljs-string">å•æ¸ é“æ¥å…¥</span>
<span class="hljs-attr">Week 2:</span> <span class="hljs-string">å¤šæ¸ é“é…ç½®</span> <span class="hljs-string">â†’</span> <span class="hljs-string">å·¥å…·ä½¿ç”¨</span> <span class="hljs-string">â†’</span> <span class="hljs-string">è¯­éŸ³äº¤äº’</span>
<span class="hljs-attr">Week 3:</span> <span class="hljs-string">Skillså¼€å‘</span> <span class="hljs-string">â†’</span> <span class="hljs-string">è‡ªåŠ¨åŒ–å·¥ä½œæµ</span> <span class="hljs-string">â†’</span> <span class="hljs-string">è¿›é˜¶ä¼˜åŒ–</span>
<span class="hljs-attr">Week 4:</span> <span class="hljs-string">ç”Ÿäº§éƒ¨ç½²</span> <span class="hljs-string">â†’</span> <span class="hljs-string">ç›‘æ§ç»´æŠ¤</span> <span class="hljs-string">â†’</span> <span class="hljs-string">ç¤¾åŒºè´¡çŒ®</span>
</code></pre>
<h3 data-id="heading-41">å‚è€ƒé“¾æ¥</h3>
<ul>
<li>ğŸŒ <strong>å®˜ç½‘</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fopenclaw.ai" target="_blank" title="https://openclaw.ai" ref="nofollow noopener noreferrer">openclaw.ai</a> - éªŒè¯çŠ¶æ€: âœ…</li>
<li>ğŸ“š <strong>æ–‡æ¡£</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.openclaw.ai" target="_blank" title="https://docs.openclaw.ai" ref="nofollow noopener noreferrer">docs.openclaw.ai</a> - éªŒè¯çŠ¶æ€: âœ…</li>
<li>ğŸ’» <strong>GitHub</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenclaw%2Fopenclaw" target="_blank" title="https://github.com/openclaw/openclaw" ref="nofollow noopener noreferrer">github.com/openclaw/opâ€¦</a> - Stars: 173k - éªŒè¯çŠ¶æ€: âœ…</li>
<li>ğŸ’¬ <strong>Discord</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdiscord.gg%2Fclawd" target="_blank" title="https://discord.gg/clawd" ref="nofollow noopener noreferrer">discord.gg/clawd</a> - éªŒè¯çŠ¶æ€: âœ…</li>
<li>ğŸ”§ <strong>å¿«é€Ÿå¼€å§‹</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.openclaw.ai%2Fstart%2Fgetting-started" target="_blank" title="https://docs.openclaw.ai/start/getting-started" ref="nofollow noopener noreferrer">Getting Started</a> - éªŒè¯çŠ¶æ€: âœ…</li>
<li>â“ <strong>FAQ</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.openclaw.ai%2Fstart%2Ffaq" target="_blank" title="https://docs.openclaw.ai/start/faq" ref="nofollow noopener noreferrer">docs.openclaw.ai/start/faq</a> - éªŒè¯çŠ¶æ€: âœ…</li>
</ul>
<h3 data-id="heading-42">ä¸‹ä¸€æ­¥è¡ŒåŠ¨</h3>
<ol>
<li>âœ… å®Œæˆå®‰è£…å’ŒOnboardingå‘å¯¼</li>
<li>âœ… é…ç½®è‡³å°‘ä¸€ä¸ªèŠå¤©æ¸ é“ï¼ˆæ¨èTelegramæˆ–Slackï¼‰</li>
<li>âœ… å°è¯•ç¬¬ä¸€æ¡AIå¯¹è¯</li>
<li>âœ… æ¢ç´¢Browserå’ŒVoiceå·¥å…·</li>
<li>âœ… åŠ å…¥Discordç¤¾åŒºè·å–æ”¯æŒ</li>
</ol>
<hr/>
<p><strong>æœ€åæé†’</strong>ï¼šOpenClawæ˜¯ä¸€ä¸ªå¿«é€Ÿå‘å±•çš„å¼€æºé¡¹ç›®ï¼ŒåŠŸèƒ½æ›´æ–°é¢‘ç¹ã€‚å»ºè®®å®šæœŸæŸ¥çœ‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopenclaw%2Fopenclaw%2Fblob%2Fmain%2FCHANGELOG.md" target="_blank" title="https://github.com/openclaw/openclaw/blob/main/CHANGELOG.md" ref="nofollow noopener noreferrer">CHANGELOG</a>è·å–æœ€æ–°ç‰¹æ€§ï¼Œå¹¶ä¿æŒç‰ˆæœ¬æ›´æ–°ã€‚</p>
<blockquote>
<p>ğŸ’¡ <strong>å°è´´å£«</strong>ï¼šåˆšå¼€å§‹å¯èƒ½ä¼šé‡åˆ°é…ç½®é—®é¢˜ï¼Œä¸è¦ç°å¿ƒï¼ç¤¾åŒºå¾ˆæ´»è·ƒï¼ŒDiscordä¸Šæœ‰å¤§é‡çƒ­å¿ƒçš„å¼€å‘è€…æ„¿æ„å¸®åŠ©æ–°æ‰‹ã€‚è®°ä½ï¼šä¸€æ—¦é…ç½®å®Œæˆï¼Œä½ å°±æ‹¥æœ‰äº†ä¸€ä¸ªçœŸæ­£å±äºè‡ªå·±çš„AIåŠ©æ‰‹ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[16ä¸ªAIä¸¤å‘¨æ‰‹æ“ç¼–è¯‘å™¨ï¼šClaude Opus 4.6 æ­£åœ¨æ”¹å†™ä»£ç è§„åˆ™]]></title>    <link>https://juejin.cn/post/7603653885602611250</link>    <guid>https://juejin.cn/post/7603653885602611250</guid>    <pubDate>2026-02-07T14:19:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603653885602611250" data-draft-id="7603575763788218394" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="16ä¸ªAIä¸¤å‘¨æ‰‹æ“ç¼–è¯‘å™¨ï¼šClaude Opus 4.6 æ­£åœ¨æ”¹å†™ä»£ç è§„åˆ™"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2026-02-07T14:19:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¢¨é£å¦‚é›ª"/> <meta itemprop="url" content="https://juejin.cn/user/4064249017803927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            16ä¸ªAIä¸¤å‘¨æ‰‹æ“ç¼–è¯‘å™¨ï¼šClaude Opus 4.6 æ­£åœ¨æ”¹å†™ä»£ç è§„åˆ™
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4064249017803927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¢¨é£å¦‚é›ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T14:19:13.000Z" title="Sat Feb 07 2026 14:19:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ç”šè‡³ä¸éœ€è¦æˆ‘å¤šè¯´ä»€ä¹ˆï¼ŒAnthropic è¿™æ¬¡æ‰”å‡ºæ¥çš„â€œæ·±æ°´ç‚¸å¼¹â€â€”â€”Claude Opus 4.6ï¼Œå…‰æ˜¯è¿™ä¸€ä¸ªæ¡ˆä¾‹å°±è¶³ä»¥è®©æ•´ä¸ªæŠ€æœ¯åœˆç‚¸é”…ï¼š</p>
<p><strong>16ä¸ªæ™ºèƒ½ä½“ï¼Œæ²¡æœ‰ä»»ä½•äººç±»æ’æ‰‹ï¼ŒèŠ±äº†å¤§æ¦‚ä¸¤ä¸‡ç¾é‡‘ï¼Œä¸¤å‘¨æ—¶é—´ç”¨ Rust ä»é›¶å†™å‡ºäº†ä¸€ä¸ª C ç¼–è¯‘å™¨ã€‚</strong></p>
<p>è¿™ä¸æ˜¯ç§‘å¹»å°è¯´ï¼Œä¹Ÿä¸æ˜¯é‚£ç§å†™ä¸ªâ€œHello Worldâ€å°±æ•¢å¹ç‰›çš„æ¼”ç¤ºã€‚è¿™ä¸ªç¼–è¯‘å™¨ä¸ä»…èƒ½è·‘ï¼Œè¿˜æˆåŠŸç¼–è¯‘äº† Linux 6.9 å†…æ ¸ï¼Œç”šè‡³é€šè¿‡äº† GCC 99% çš„å‹åŠ›æµ‹è¯•ã€‚</p>
<p>å°±åœ¨2026å¹´2æœˆï¼ŒAnthropic å‘å¸ƒçš„è¿™æ¬¾æ–°æ——èˆ°æ¨¡å‹ï¼Œä¼¼ä¹ç»ˆäºæ…ç ´äº†é‚£å±‚çª—æˆ·çº¸â€”â€”AI ä¸å†åªæ˜¯é™ªèŠçš„æœºå™¨äººï¼Œå®ƒçœŸçš„å¼€å§‹å˜æˆèƒ½å¹²è„æ´»ç´¯æ´»çš„â€œæ•°å­—å·¥ç¨‹å¸ˆâ€äº†ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F02%2FiShot_2026-02-07_22.06.44-1024x555.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/02/iShot_2026-02-07_22.06.44-1024x555.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8151557d9b614654af13ee1c65b89cc1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771078752&amp;x-signature=PmND6Om7htrMU9bn9F72O1a8tu4%3D" alt="iShot_2026-02-07_22.06.44" loading="lazy"/></a></p>
<p>ä»Šå¤©æˆ‘ä»¬å°±æŠ›å¼€é‚£äº›æ¯ç‡¥çš„é€šç¨¿ï¼Œä»¥æ­¤ä¸ºåˆ‡å…¥ç‚¹ï¼ŒèŠèŠ Claude Opus 4.6 åˆ°åº•å¼ºåœ¨å“ªï¼Œä»¥åŠå®ƒå¯¹æˆ‘ä»¬æ„å‘³ç€ä»€ä¹ˆã€‚</p>
<h3 data-id="heading-0">ä»â€œå¯¹è¯â€åˆ°â€œå¹²æ´»â€çš„è´¨å˜</h3>
<p>ä»¥å‰æˆ‘ä»¬ç”¨ AIï¼Œå¤§éƒ½æ˜¯â€œä½ é—®æˆ‘ç­”â€ã€‚ä½† Opus 4.6 å¼•å…¥äº†ä¸€ä¸ªå«â€œAgent Teamsï¼ˆæ™ºèƒ½ä½“å›¢é˜Ÿï¼‰â€çš„æ¦‚å¿µã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ ä¸å†æ˜¯é¢å¯¹ä¸€ä¸ªå…¨çŸ¥å…¨èƒ½çš„ç¥ï¼Œè€Œæ˜¯æ‹¥æœ‰äº†ä¸€ä¸ªé¡¹ç›®ç»„ã€‚ä½ å¯ä»¥æŒ‡æ´¾ä¸€ä¸ª AI åšäº§å“ç»ç†ï¼Œä¸€ä¸ªåšæ¶æ„å¸ˆï¼Œåå‡ ä¸ªåšç å†œã€‚å®ƒä»¬ä¹‹é—´ä¼šäº’ç›¸ç”©é”…ã€äº’ç›¸ç”šè‡³è‡ªæˆ‘çº é”™ï¼ˆå½“ç„¶ï¼Œåœ¨è¿™ä¸ªæ¡ˆä¾‹é‡Œå®ƒä»¬é…åˆå¾—å¾ˆé»˜å¥‘ï¼‰ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F02%2FiShot_2026-02-07_22.08.51-1024x636.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/02/iShot_2026-02-07_22.08.51-1024x636.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/36aa1c63c0c6499c8c1a7d6a604247a6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771078752&amp;x-signature=9JZUerYZT5XwRNmZCQ5dcNaa9kA%3D" alt="iShot_2026-02-07_22.08.51" loading="lazy"/></a></p>
<p>é‚£ä¸ª C ç¼–è¯‘å™¨çš„æ¡ˆä¾‹å°±æ˜¯æœ€å¥½çš„è¯æ˜ã€‚16ä¸ªæ™ºèƒ½ä½“è¿›è¡Œäº†è¿‘2000æ¬¡ä¼šè¯ï¼Œå¤„ç†äº†æ•°ä»¥äº¿è®¡çš„ Tokenï¼Œæœ€ç»ˆäº¤ä»˜äº†10ä¸‡è¡Œä»£ç ã€‚è¿™æ ‡å¿—ç€ AI ä»è¾…åŠ©å†™ä»£ç ç‰‡æ®µï¼Œè¿›åŒ–åˆ°äº†æŒæ§å¤§å‹å·¥ç¨‹é¡¹ç›®çš„é˜¶æ®µã€‚</p>
<h3 data-id="heading-1">çœŸçš„â€œè„‘å®¹é‡â€æ‰©å®¹</h3>
<p>é…åˆè¿™ç§å·¥ç¨‹èƒ½åŠ›çš„ï¼Œæ˜¯ Opus 4.6 ç»ˆäºå¼€æ”¾æµ‹è¯•çš„ <strong>100ä¸‡ Token ä¸Šä¸‹æ–‡çª—å£</strong>ã€‚</p>
<p>å¦‚æœä½ æ˜¯å¼€å‘è€…ï¼Œä½ æ‡‚è¿™æ„å‘³ç€ä»€ä¹ˆã€‚ä»¥å‰æŠŠä»£ç å–‚ç»™ AIï¼Œå¾—å°å¿ƒç¿¼ç¿¼åœ°åˆ‡ç‰‡ï¼Œç”Ÿæ€•å®ƒâ€œå¤±å¿†â€ã€‚ç°åœ¨ï¼Ÿä½ å¯ä»¥æŠŠæ•´æœ¬æŠ€æœ¯ä¹¦ç±ã€å¤šå¹´çš„è´¢æŠ¥ï¼Œç”šè‡³æ•´ä¸ªæ ¸å¿ƒä»£ç åº“ç›´æ¥ä¸¢è¿›å»ã€‚</p>
<p>åœ¨ MRCR v2ï¼ˆå¤§æµ·æé’ˆæµ‹è¯•ï¼‰ä¸­ï¼Œå®ƒåœ¨ç™¾ä¸‡çº§ Token ä¸‹çš„å‡†ç¡®ç‡å¹²åˆ°äº† 76% å·¦å³ã€‚è™½ç„¶è¿˜æ²¡åˆ°å®Œç¾ï¼Œä½†ç›¸æ¯”ä»¥å‰çš„æ¨¡å‹ä¹Ÿæ˜¯é™ç»´æ‰“å‡»ã€‚è€Œä¸”å®ƒå¤šäº†ä¸€ä¸ªâ€œè‡ªé€‚åº”æ€è€ƒâ€çš„åŠŸèƒ½ï¼Œé‡åˆ°éš¾é¢˜å®ƒä¼šè‡ªå·±å†³å®šâ€œå¤šæƒ³ä¸€ä¼šå„¿â€ï¼ŒåŠ¨æ€è°ƒæ•´æ¨ç†æ·±åº¦ï¼Œè€Œä¸æ˜¯æ€¥ç€ç»™ä½ åå‡ºä¸€ä¸ªä¼¼æ˜¯è€Œéçš„ç­”æ¡ˆã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F02%2FiShot_2026-02-07_22.09.12-1024x577.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/02/iShot_2026-02-07_22.09.12-1024x577.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b5ececc09631457e9bbc8138619b1824~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771078752&amp;x-signature=ffB0KgRlNuqXMwWjLmbN8JnbbnI%3D" alt="iShot_2026-02-07_22.09.12" loading="lazy"/></a></p>
<h3 data-id="heading-2">åŠæ‰“ç«å“çš„ç¡¬æ•°æ®</h3>
<p>æˆ‘çŸ¥é“ä½ ä»¬å–œæ¬¢çœ‹è·‘åˆ†ã€‚åœ¨è¿™ä¸€å—ï¼ŒOpus 4.6 ç¡®å®æœ‰ç‚¹ä¸è®²æ­¦å¾·ã€‚</p>
<p>åœ¨é’ˆå¯¹é«˜ä»·å€¼çŸ¥è¯†å·¥ä½œçš„ GDPval-AA åŸºå‡†æµ‹è¯•ä¸­ï¼ŒOpus 4.6 æ‹¿åˆ°äº† 1606 åˆ†ï¼Œè€Œå®ƒçš„è€å¯¹æ‰‹ GPT-5.2 åªæœ‰ 1462 åˆ†ã€‚è¿™æ„å‘³ç€åœ¨é‡‘èã€æ³•å¾‹è¿™ç§çœŸçš„èƒ½èµšé’±çš„é¢†åŸŸï¼ŒOpus 4.6 çš„èƒœç‡é«˜è¾¾ 70%ã€‚</p>
<p>æ›´å¤¸å¼ çš„æ˜¯å®‰å…¨é¢†åŸŸã€‚Anthropic æŠŠè¿™ç©æ„å„¿æ‰”è¿›æ²™ç®±é‡Œåšæµ‹è¯•ï¼Œç»“æœå®ƒè‡ªå·±å‘ç°äº†è¶…è¿‡ 500 ä¸ªé›¶æ—¥æ¼æ´ï¼ˆZero-day exploitsï¼‰ã€‚è¿™äº›æ¼æ´å­˜åœ¨äº GhostScriptã€OpenSC è¿™äº›æˆ‘ä»¬å¸¸ç”¨çš„å¼€æºå·¥å…·é‡Œã€‚è¯´å®è¯ï¼Œè¿™èƒ½åŠ›æ—¢è®©äººå…´å¥‹ï¼Œä¹Ÿè®©äººåèƒŒå‘å‡‰ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F02%2FiShot_2026-02-07_22.09.18-1024x563.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/02/iShot_2026-02-07_22.09.18-1024x563.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/93269542fb8a4711b6c6d9bbf9b7946e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771078752&amp;x-signature=W%2BTrPQ2J%2Fmm4FMIWvbiiBfzyVbg%3D" alt="iShot_2026-02-07_22.09.18" loading="lazy"/></a></p>
<h3 data-id="heading-3">å®ƒæ˜¯ç»™è°ç”¨çš„ï¼Ÿ</h3>
<p>è¿™æ˜¾ç„¶ä¸æ˜¯ç»™æ™®é€šç”¨æˆ·æ‹¿æ¥é—²èŠçš„ç©å…·ã€‚</p>
<p>å…ˆçœ‹å®šä»·ï¼šè¾“å…¥æ¯ç™¾ä¸‡ Token 5ç¾å…ƒï¼Œè¾“å‡º25ç¾å…ƒã€‚å¦‚æœä½ çœŸçš„å¯ç”¨äº†é‚£ä¸ªè¶…é•¿çš„ 100ä¸‡ä¸Šä¸‹æ–‡ï¼Œè¶…è¿‡20ä¸‡ Token çš„éƒ¨åˆ†è¿˜è¦åŠ ä»·ï¼ˆè¾“å…¥10ç¾å…ƒ/è¾“å‡º37.5ç¾å…ƒï¼‰ã€‚</p>
<p>è¿™ä¸€åˆ€åˆ‡å¾—å¾ˆç²¾å‡†ã€‚å®ƒæ˜¯ç»™ä¼ä¸šã€ç»™ä¸“ä¸šå¼€å‘è€…ã€ç»™é‡‘èåˆ†æå¸ˆå‡†å¤‡çš„ã€‚å®ƒç”šè‡³æ·±åº¦é›†æˆäº† Excel å’Œ PowerPointï¼Œå¯ä»¥ç›´æ¥å¸®ä½ åˆ†æè´¢æŠ¥æ•°æ®ç„¶åç”»å‡ºç¬¦åˆå“ç‰Œè°ƒæ€§çš„ PPTã€‚é«˜ç››å·²ç»åœ¨ç”¨å®ƒåšåˆè§„ä¸šåŠ¡è‡ªåŠ¨åŒ–äº†ã€‚</p>
<h3 data-id="heading-4">æ€»ç»“</h3>
<p>Claude Opus 4.6 çš„å‡ºç°ï¼Œä¼ é€’äº†ä¸€ä¸ªéå¸¸æ¸…æ™°çš„ä¿¡å·ï¼š<strong>å¤§æ¨¡å‹ç«äº‰å·²ç»è¿‡äº†â€œæ‹¼å‚æ•°â€çš„è‰è½é˜¶æ®µï¼Œè¿›å…¥äº†â€œæ‹¼è½åœ°â€çš„æ·±æ°´åŒºã€‚</strong></p>
<p>å½“ OpenAI è¿˜åœ¨æ­»ç£• GPT-5.3-Codex çš„å•ç‚¹ç¼–ç¨‹èƒ½åŠ›æ—¶ï¼ŒAnthropic èµ°äº†ä¸€æ¡æ›´åƒâ€œäººç±»ç»„ç»‡â€çš„è·¯â€”â€”é€šè¿‡å¤šæ™ºèƒ½ä½“åä½œå’Œè¶…é•¿è®°å¿†ï¼Œè§£å†³å¤æ‚çš„ã€ç³»ç»Ÿæ€§çš„å·¥ç¨‹é—®é¢˜ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F02%2FiShot_2026-02-07_22.09.23-1024x612.png" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/02/iShot_2026-02-07_22.09.23-1024x612.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c7af4ef3567443c8a3d2adca2cf9c9a3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771078752&amp;x-signature=HC%2BgCBtu4LMox606gfrJdWVBN40%3D" alt="iShot_2026-02-07_22.09.23" loading="lazy"/></a></p>
<p>å¯¹äºæˆ‘ä»¬æ¥è¯´ï¼Œå¥½æ¶ˆæ¯æ˜¯æˆ‘ä»¬æ‰‹é‡Œæœ‰äº†æ›´å¼ºçš„é“²å­ï¼›åæ¶ˆæ¯æ˜¯ï¼Œè¿™æŠŠé“²å­å¯èƒ½å¾ˆå¿«å°±ä¼šè‡ªå·±æŒ–å‘äº†ã€‚é‚£ä¸ªâ€œç”±AIç¼–å†™Linuxå†…æ ¸â€çš„æœªæ¥ï¼Œæ¯”æˆ‘ä»¬æƒ³è±¡çš„æ¥å¾—éƒ½è¦å¿«ã€‚</p>
<p><strong>å¦‚æœä½ ä¹Ÿå¯¹æœ€æ–°çš„AIä¿¡æ¯æ„Ÿå…´è¶£æˆ–è€…æœ‰ç–‘é—® éƒ½å¯ä»¥åŠ å…¥æˆ‘çš„å¤§å®¶åº­ ç¬¬ä¸€æ—¶é—´åˆ†äº«æœ€æ–°AIèµ„è®¯ã€å·¥å…·ã€æ•™ç¨‹ã€æ–‡æ¡£ æ¬¢è¿ä½ çš„åŠ å…¥ï¼ï¼ï¼ğŸ˜‰ğŸ˜‰ğŸ˜‰</strong></p>
<p>å…¬ä¼—å·ï¼šå¢¨é£å¦‚é›ªå°ç«™</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€èŠ‚ç‚¹ã€‘[CustomDepthBufferèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨]]></title>    <link>https://juejin.cn/post/7603644943350808582</link>    <guid>https://juejin.cn/post/7603644943350808582</guid>    <pubDate>2026-02-07T14:49:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603644943350808582" data-draft-id="7603643044034265124" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€èŠ‚ç‚¹ã€‘[CustomDepthBufferèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨"/> <meta itemprop="keywords" content="æ¸¸æˆå¼€å‘,å›¾å½¢å­¦,Unity3D"/> <meta itemprop="datePublished" content="2026-02-07T14:49:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SmalBox"/> <meta itemprop="url" content="https://juejin.cn/user/2218166695237532"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€èŠ‚ç‚¹ã€‘[CustomDepthBufferèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2218166695237532/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SmalBox
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T14:49:34.000Z" title="Sat Feb 07 2026 14:49:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong></p>
</blockquote>
<p>åœ¨Unityçš„Shader Graphç³»ç»Ÿä¸­ï¼ŒCustom Depth Nodeï¼ˆè‡ªå®šä¹‰æ·±åº¦èŠ‚ç‚¹ï¼‰æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å·¥å…·ï¼Œä¸“é—¨ç”¨äºè®¿é—®å’Œå¤„ç†é«˜æ¸…æ¸²æŸ“ç®¡çº¿ï¼ˆHDRPï¼‰ä¸­çš„è‡ªå®šä¹‰æ·±åº¦ç¼“å†²åŒºã€‚è¿™ä¸ªèŠ‚ç‚¹ä¸ºç€è‰²å™¨å¼€å‘è€…æä¾›äº†ç²¾ç»†æ§åˆ¶æ·±åº¦ä¿¡æ¯çš„èƒ½åŠ›ï¼Œæ˜¯å®ç°é«˜çº§æ¸²æŸ“æ•ˆæœçš„åŸºçŸ³ã€‚</p>
<h2 data-id="heading-0">æ¸²æŸ“ç®¡çº¿å…¼å®¹æ€§æ·±åº¦åˆ†æ</h2>
<p>Custom Depth Nodeåœ¨ä¸åŒæ¸²æŸ“ç®¡çº¿ä¸­çš„æ”¯æŒæƒ…å†µæ˜¯å¼€å‘è€…å¿…é¡»é¦–å…ˆäº†è§£çš„å…³é”®ä¿¡æ¯ã€‚è¿™ä¸ªèŠ‚ç‚¹çš„è®¾è®¡åˆè¡·æ˜¯ä¸ºäº†æ»¡è¶³HDRPçš„é«˜çº§æ¸²æŸ“éœ€æ±‚ï¼Œå› æ­¤åœ¨å…¼å®¹æ€§ä¸Šæœ‰ç€æ˜ç¡®çš„ç•Œé™åˆ’åˆ†ã€‚</p>
<p><strong>é«˜æ¸…æ¸²æŸ“ç®¡çº¿ï¼ˆHDRPï¼‰æ”¯æŒ</strong></p>
<p>HDRPä½œä¸ºUnityçš„é«˜ç«¯æ¸²æŸ“è§£å†³æ–¹æ¡ˆï¼Œä¸“é—¨ä¸ºéœ€è¦é«˜è´¨é‡å›¾å½¢è¡¨ç°çš„é¡¹ç›®è®¾è®¡ã€‚åœ¨è¿™ä¸ªç®¡çº¿ä¸­ï¼ŒCustom Depth Nodeèƒ½å¤Ÿå®Œå…¨å‘æŒ¥å…¶åŠŸèƒ½ï¼š</p>
<ul>
<li>HDRPç»´æŠ¤äº†ä¸“é—¨çš„è‡ªå®šä¹‰æ·±åº¦ç¼“å†²åŒºï¼Œå­˜å‚¨äº†åœºæ™¯ä¸­ç‰¹å®šå¯¹è±¡çš„æ·±åº¦ä¿¡æ¯</li>
<li>æ”¯æŒå¤šé€šé“æ¸²æŸ“ï¼Œå…è®¸ä¸åŒå¯¹è±¡å†™å…¥ä¸åŒçš„æ·±åº¦ç¼“å†²åŒº</li>
<li>æä¾›äº†å®Œæ•´çš„æ·±åº¦ç¼“å†²ç®¡ç†æœºåˆ¶ï¼Œç¡®ä¿æ·±åº¦æ•°æ®çš„å‡†ç¡®æ€§å’Œä¸€è‡´æ€§</li>
<li>èƒ½å¤Ÿå¤„ç†å¤æ‚çš„åœºæ™¯å±‚æ¬¡å’Œæ¸²æŸ“ä¼˜å…ˆçº§</li>
</ul>
<p><strong>é€šç”¨æ¸²æŸ“ç®¡çº¿ï¼ˆURPï¼‰ä¸æ”¯æŒ</strong></p>
<p>URPä½œä¸ºè½»é‡çº§çš„é€šç”¨æ¸²æŸ“è§£å†³æ–¹æ¡ˆï¼Œåœ¨æ·±åº¦ç¼“å†²åŒºçš„ç®¡ç†ä¸Šé‡‡ç”¨äº†ä¸åŒçš„ç­–ç•¥ï¼š</p>
<ul>
<li>URPæ²¡æœ‰ä¸“é—¨ç»´æŠ¤ç‹¬ç«‹çš„Custom Depth Buffer</li>
<li>æ·±åº¦ä¿¡æ¯ä¸»è¦é€šè¿‡ä¸»æ·±åº¦ç¼“å†²åŒºè¿›è¡Œç®¡ç†</li>
<li>æ¸²æŸ“æ¶æ„ç›¸å¯¹ç®€åŒ–ï¼Œä¸æ”¯æŒHDRPä¸­çš„é«˜çº§æ·±åº¦ç‰¹æ€§</li>
<li>å¦‚æœéœ€è¦æ·±åº¦ä¿¡æ¯ï¼Œé€šå¸¸éœ€è¦ä½¿ç”¨Scene DepthèŠ‚ç‚¹è®¿é—®ä¸»æ·±åº¦ç¼“å†²åŒº</li>
</ul>
<p>è¿™ç§å…¼å®¹æ€§å·®å¼‚æºäºä¸¤ä¸ªæ¸²æŸ“ç®¡çº¿çš„è®¾è®¡å“²å­¦å’Œç›®æ ‡å¹³å°çš„ä¸åŒã€‚HDRPé¢å‘é«˜ç«¯å¹³å°ï¼Œè¿½æ±‚æè‡´çš„è§†è§‰æ•ˆæœï¼Œè€ŒURPåˆ™æ³¨é‡æ€§èƒ½å’Œè·¨å¹³å°å…¼å®¹æ€§ã€‚</p>
<h2 data-id="heading-1">ç«¯å£é…ç½®ä¸å‚æ•°è¯¦è§£</h2>
<p>Custom Depth Nodeçš„ç«¯å£é…ç½®å†³å®šäº†å®ƒå¦‚ä½•æ¥æ”¶è¾“å…¥æ•°æ®å’Œè¾“å‡ºå¤„ç†ç»“æœã€‚æ·±å…¥ç†è§£æ¯ä¸ªç«¯å£çš„åŠŸèƒ½å¯¹äºæ­£ç¡®ä½¿ç”¨è¯¥èŠ‚ç‚¹è‡³å…³é‡è¦ã€‚</p>
<p><strong>UVè¾“å…¥ç«¯å£</strong></p>
<p>UVè¾“å…¥ç«¯å£æ˜¯Custom Depth Nodeçš„æ ¸å¿ƒé…ç½®é¡¹ï¼Œå®ƒå†³å®šäº†æ·±åº¦é‡‡æ ·çš„ä½ç½®å’Œæ–¹å¼ï¼š</p>
<ul>
<li>æ•°æ®ç±»å‹ï¼šVector 4</li>
<li>é»˜è®¤ç»‘å®šï¼šå±å¹•ä½ç½®ï¼ˆScreen Positionï¼‰</li>
<li>åŠŸèƒ½æè¿°ï¼šè®¾ç½®æ ‡å‡†åŒ–å±å¹•åæ ‡ï¼Œç”¨äºæŒ‡å®šæ·±åº¦é‡‡æ ·çš„ä½ç½®</li>
</ul>
<p>UVç«¯å£çš„æ­£ç¡®é…ç½®éœ€è¦è€ƒè™‘å¤šä¸ªå› ç´ ï¼š</p>
<ul>
<li>å±å¹•ç©ºé—´åæ ‡ç³»ç»Ÿï¼šUnityä½¿ç”¨å·¦ä¸‹è§’ä¸º(0,0)ã€å³ä¸Šè§’ä¸º(1,1)çš„æ ‡å‡†åŒ–åæ ‡ç³»ç»Ÿ</li>
<li>åæ ‡å˜æ¢ï¼šéœ€è¦ç¡®ä¿è¾“å…¥çš„UVåæ ‡æ­£ç¡®æ˜ å°„åˆ°å±å¹•ç©ºé—´</li>
<li>å¤šæ˜¾ç¤ºå™¨æ”¯æŒï¼šåœ¨éœ€è¦å¤šæ˜¾ç¤ºå™¨æ¸²æŸ“çš„åœºæ™¯ä¸­ï¼ŒUVåæ ‡éœ€è¦ç›¸åº”è°ƒæ•´</li>
</ul>
<p>åœ¨å®é™…ä½¿ç”¨ä¸­ï¼ŒUVè¾“å…¥ç«¯å£çš„é…ç½®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">HLSL

// ç›´æ¥ä½¿ç”¨å±å¹•ä½ç½®
float4 <span class="hljs-attr">screenPos</span> = GetScreenPosition()<span class="hljs-comment">;</span>

// æ‰‹åŠ¨è®¡ç®—UVåæ ‡
float2 <span class="hljs-attr">uv</span> = float2(input.position.x / _ScreenParams.x,
                   input.position.y / _ScreenParams.y)<span class="hljs-comment">;</span>
</code></pre>
<p><strong>è¾“å‡ºç«¯å£</strong></p>
<p>è¾“å‡ºç«¯å£æä¾›äº†å¤„ç†åçš„æ·±åº¦æ•°æ®ï¼š</p>
<ul>
<li>æ•°æ®ç±»å‹ï¼šVector 4</li>
<li>ç»‘å®šå…³ç³»ï¼šæ— é¢„è®¾ç»‘å®š</li>
<li>åŠŸèƒ½æè¿°ï¼šè¾“å‡ºæ ¹æ®é€‰å®šé‡‡æ ·æ¨¡å¼å¤„ç†åçš„æ·±åº¦å€¼</li>
</ul>
<p>è¾“å‡ºæ•°æ®çš„è§£è¯»ä¾èµ–äºé€‰æ‹©çš„æ·±åº¦é‡‡æ ·æ¨¡å¼ï¼Œä¸åŒæ¨¡å¼ä¸‹çš„è¾“å‡ºå«ä¹‰å„ä¸ç›¸åŒã€‚å¼€å‘è€…éœ€è¦æ ¹æ®å…·ä½“çš„æ¸²æŸ“éœ€æ±‚é€‰æ‹©åˆé€‚çš„é‡‡æ ·æ¨¡å¼ã€‚</p>
<h2 data-id="heading-2">æ·±åº¦é‡‡æ ·æ¨¡å¼å…¨é¢è§£æ</h2>
<p>æ·±åº¦é‡‡æ ·æ¨¡å¼å†³å®šäº†Custom Depth Nodeå¦‚ä½•å¤„ç†å’Œè¾“å‡ºæ·±åº¦ä¿¡æ¯ã€‚æ¯ç§æ¨¡å¼éƒ½æœ‰å…¶ç‰¹å®šçš„åº”ç”¨åœºæ™¯å’Œæ•°å­¦ç‰¹æ€§ã€‚</p>
<p><strong>Linear01é‡‡æ ·æ¨¡å¼</strong></p>
<p>Linear01æ¨¡å¼å°†æ·±åº¦å€¼çº¿æ€§åŒ–å¹¶å½’ä¸€åŒ–åˆ°[0,1]èŒƒå›´å†…ï¼š</p>
<ul>
<li>æ•°å­¦ç‰¹æ€§ï¼šæ‰§è¡Œé€è§†é™¤æ³•ï¼Œå°†éçº¿æ€§æ·±åº¦ç¼“å†²å€¼è½¬æ¢ä¸ºçº¿æ€§å…³ç³»</li>
<li>è¾“å‡ºèŒƒå›´ï¼šä¸¥æ ¼çš„0åˆ°1ä¹‹é—´ï¼Œ0è¡¨ç¤ºè¿‘è£å‰ªé¢ï¼Œ1è¡¨ç¤ºè¿œè£å‰ªé¢</li>
<li>åº”ç”¨åœºæ™¯ï¼šé€‚åˆéœ€è¦ç›¸å¯¹æ·±åº¦ä¿¡æ¯çš„ç‰¹æ•ˆï¼Œå¦‚é›¾æ•ˆã€æ·±åº¦æ¸éšç­‰</li>
</ul>
<p>Linear01æ¨¡å¼çš„æ•°å­¦åŸç†ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-function">HLSL

<span class="hljs-type">float</span> <span class="hljs-title">Linear01Depth</span><span class="hljs-params">(<span class="hljs-type">float</span> z)</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-number">1.0</span> / (_ZBufferParams.x * z + _ZBufferParams.y);
}
</code></pre>
<p>åœ¨å®é™…åº”ç”¨ä¸­çš„ä¼˜åŠ¿ï¼š</p>
<ul>
<li>æ•°å€¼èŒƒå›´ç»Ÿä¸€ï¼Œä¾¿äºåç»­è®¡ç®—å’Œæ’å€¼</li>
<li>è§†è§‰æ•ˆæœæ›´åŠ è‡ªç„¶ï¼Œç¬¦åˆäººçœ¼å¯¹è·ç¦»çš„æ„ŸçŸ¥</li>
<li>é€‚åˆç”¨äºåŸºäºç™¾åˆ†æ¯”çš„æ·±åº¦æ··åˆæ•ˆæœ</li>
</ul>
<p><strong>Rawé‡‡æ ·æ¨¡å¼</strong></p>
<p>Rawæ¨¡å¼ç›´æ¥è¾“å‡ºæ·±åº¦ç¼“å†²åŒºä¸­çš„åŸå§‹æ•°å€¼ï¼š</p>
<ul>
<li>æ•°æ®ç‰¹æ€§ï¼šä¿æŒæ·±åº¦ç¼“å†²åŒºçš„åŸå§‹éçº¿æ€§åˆ†å¸ƒ</li>
<li>ç²¾åº¦ç‰¹ç‚¹ï¼šåœ¨è¿‘å¤„æä¾›æ›´é«˜ç²¾åº¦ï¼Œè¿œå¤„ç²¾åº¦é€æ¸é™ä½</li>
<li>åº”ç”¨åœºæ™¯ï¼šæ·±åº¦æ¯”è¾ƒã€æ·±åº¦æµ‹è¯•ã€æ¨¡æ¿é˜´å½±ç­‰éœ€è¦åŸå§‹æ·±åº¦æ•°æ®çš„åœºæ™¯</li>
</ul>
<p>Rawæ¨¡å¼çš„ç‰¹æ€§åˆ†æï¼š</p>
<ul>
<li>éçº¿æ€§åˆ†å¸ƒï¼šz' = (1/z - 1/near) / (1/far - 1/near)</li>
<li>ç²¾åº¦ä¼˜åŠ¿ï¼šåœ¨è¿‘è£å‰ªé¢é™„è¿‘æä¾›æ›´é«˜çš„æ·±åº¦ç²¾åº¦</li>
<li>æ€§èƒ½è€ƒè™‘ï¼šé¿å…é¢å¤–çš„æ•°å­¦è¿ç®—ï¼Œæ€§èƒ½å¼€é”€è¾ƒå°</li>
</ul>
<p><strong>Eyeé‡‡æ ·æ¨¡å¼</strong></p>
<p>Eyeæ¨¡å¼å°†æ·±åº¦å€¼è½¬æ¢ä¸ºè§†ç©ºé—´ä¸­çš„å®é™…è·ç¦»ï¼š</p>
<ul>
<li>å•ä½ç³»ç»Ÿï¼šä½¿ç”¨ä¸–ç•Œå•ä½ï¼ˆé€šå¸¸ä¸ºç±³ï¼‰è¡¨ç¤ºè·ç¦»</li>
<li>çº¿æ€§å…³ç³»ï¼šè¾“å‡ºå€¼ä¸å®é™…è·ç¦»å‘ˆçº¿æ€§å…³ç³»</li>
<li>åº”ç”¨åœºæ™¯ï¼šéœ€è¦çœŸå®è·ç¦»è®¡ç®—çš„ç‰©ç†æ•ˆæœï¼Œå¦‚ä½“ç§¯å…‰ã€çœŸå®é›¾æ•ˆç­‰</li>
</ul>
<p>Eyeæ¨¡å¼çš„è½¬æ¢åŸç†ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-function">HLSL

<span class="hljs-type">float</span> <span class="hljs-title">LinearEyeDepth</span><span class="hljs-params">(<span class="hljs-type">float</span> z)</span>
</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-number">1.0</span> / (_ZBufferParams.z * z + _ZBufferParams.w);
}
</code></pre>
<p>è¿™ç§æ¨¡å¼åœ¨å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨ä»·å€¼ï¼š</p>
<ul>
<li>ç‰©ç†å‡†ç¡®æ€§ï¼šæä¾›çœŸå®çš„è·ç¦»ä¿¡æ¯ï¼Œé€‚åˆåŸºäºç‰©ç†çš„æ¸²æŸ“</li>
<li>ç›´è§‚ç†è§£ï¼šè¾“å‡ºå€¼ç›´æ¥å¯¹åº”åœºæ™¯ä¸­çš„å®é™…è·ç¦»</li>
<li>å¤æ‚æ•ˆæœï¼šæ”¯æŒéœ€è¦ç²¾ç¡®è·ç¦»è®¡ç®—çš„é«˜çº§æ¸²æŸ“æ•ˆæœ</li>
</ul>
<h2 data-id="heading-3">å®é™…åº”ç”¨åœºæ™¯ä¸æ¡ˆä¾‹åˆ†æ</h2>
<p>Custom Depth Nodeåœ¨HDRPé¡¹ç›®ä¸­æœ‰å¹¿æ³›çš„åº”ç”¨åœºæ™¯ï¼Œä»¥ä¸‹æ˜¯å‡ ä¸ªå…¸å‹çš„åº”ç”¨æ¡ˆä¾‹ã€‚</p>
<p><strong>é«˜çº§æ™¯æ·±æ•ˆæœå®ç°</strong></p>
<p>ä½¿ç”¨Custom Depth Nodeå¯ä»¥å®ç°ç”µå½±çº§åˆ«çš„æ™¯æ·±æ•ˆæœï¼š</p>
<pre><code class="hljs language-scss" lang="scss">HLSL

<span class="hljs-comment">// æ™¯æ·±æ•ˆæœçš„æ ¸å¿ƒå®ç°</span>
void <span class="hljs-built_in">ApplyDepthOfField</span>(float2 uv, float focusDistance, float focalLength)
{
    <span class="hljs-attribute">float</span> depth = <span class="hljs-built_in">SampleCustomDepth</span>(uv, LINEAR_EYE);
    <span class="hljs-attribute">float</span> blurAmount = <span class="hljs-built_in">saturate</span>(abs(depth - focusDistance) / focalLength);

    <span class="hljs-comment">// åŸºäºæ·±åº¦å·®å¼‚åº”ç”¨æ¨¡ç³Š</span>
    return <span class="hljs-built_in">ApplyBlur</span>(uv, blurAmount);
}
</code></pre>
<p>å®ç°è¦ç‚¹ï¼š</p>
<ul>
<li>ä½¿ç”¨LinearEyeæ¨¡å¼è·å–çœŸå®è·ç¦»ä¿¡æ¯</li>
<li>æ ¹æ®ç„¦ç‚¹è·ç¦»è®¡ç®—æ¨¡ç³Šå¼ºåº¦</li>
<li>ç»“åˆåå¤„ç†å †æ ˆå®ç°é«˜è´¨é‡çš„æ¨¡ç³Šæ•ˆæœ</li>
</ul>
<p><strong>äº¤äº’å¼æ°´ä½“å’Œæ¶²ä½“æ•ˆæœ</strong></p>
<p>Custom Depth Nodeåœ¨æ¶²ä½“æ¸²æŸ“ä¸­å‘æŒ¥å…³é”®ä½œç”¨ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">HLSL

<span class="hljs-comment">// æ°´ä½“è¡¨é¢ä¸åœºæ™¯äº¤äº’</span>
void <span class="hljs-built_in">CalculateWaterEffects</span>(float2 uv, float waterLevel)
{
    <span class="hljs-attribute">float</span> sceneDepth = <span class="hljs-built_in">SampleCustomDepth</span>(uv, LINEAR_EYE);
    <span class="hljs-attribute">float</span> waterDepth = <span class="hljs-built_in">max</span>(<span class="hljs-number">0</span>, sceneDepth - waterLevel);

    <span class="hljs-comment">// åŸºäºæ°´æ·±è°ƒæ•´é¢œè‰²å’Œé€æ˜åº¦</span>
    float3 waterColor = <span class="hljs-built_in">Lerp</span>(_ShallowColor, _DeepColor, waterDepth / _MaxDepth);
    <span class="hljs-attribute">float</span> transparency = <span class="hljs-built_in">exp</span>(-waterDepth * _Absorption);
}
</code></pre>
<p>æŠ€æœ¯ç»†èŠ‚ï¼š</p>
<ul>
<li>ç²¾ç¡®è®¡ç®—æ°´é¢ä¸‹çš„ç‰©ä½“æ·±åº¦</li>
<li>åŸºäºæ·±åº¦è°ƒæ•´å…‰å­¦ç‰¹æ€§ï¼ˆå¸æ”¶ã€æ•£å°„ï¼‰</li>
<li>å®ç°çœŸå®çš„æ·±åº¦é¢œè‰²æ¸å˜</li>
</ul>
<p><strong>ä½“ç§¯é›¾å’Œå¤§æ°”æ•ˆæœ</strong></p>
<p>åˆ©ç”¨æ·±åº¦ä¿¡æ¯åˆ›å»ºçœŸå®çš„ä½“ç§¯æ•ˆæœï¼š</p>
<pre><code class="hljs language-scss" lang="scss">HLSL

<span class="hljs-comment">// ä½“ç§¯é›¾å¯†åº¦è®¡ç®—</span>
<span class="hljs-attribute">float</span> <span class="hljs-built_in">CalculateFogDensity</span>(float2 uv, float3 worldPos)
{
    <span class="hljs-attribute">float</span> depth = <span class="hljs-built_in">SampleCustomDepth</span>(uv, LINEAR_EYE);
    <span class="hljs-attribute">float</span> fogDensity = <span class="hljs-number">0.0</span>;

    <span class="hljs-comment">// åŸºäºè·ç¦»çš„æŒ‡æ•°é›¾</span>
    fogDensity = _FogDensity * <span class="hljs-built_in">exp</span>(-depth * _FogFalloff);

    <span class="hljs-comment">// æ·»åŠ é«˜åº¦é›¾</span>
    fogDensity += _HeightFogDensity * <span class="hljs-built_in">exp</span>(-worldPos.y * _HeightFalloff);

    return <span class="hljs-built_in">saturate</span>(fogDensity);
}
</code></pre>
<p>ä¼˜åŒ–è€ƒè™‘ï¼š</p>
<ul>
<li>ä½¿ç”¨Linear01æ¨¡å¼è¿›è¡Œå¿«é€Ÿæ·±åº¦æµ‹è¯•</li>
<li>ç»“åˆæ·±åº¦å’Œé«˜åº¦ä¿¡æ¯åˆ›å»ºå¤æ‚çš„å¤§æ°”æ•ˆæœ</li>
<li>é€šè¿‡æ·±åº¦å€¼ä¼˜åŒ–é›¾æ•ˆè®¡ç®—èŒƒå›´</li>
</ul>
<h2 data-id="heading-4">æ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ</h2>
<p>åœ¨ä½¿ç”¨Custom Depth Nodeæ—¶ï¼Œæ€§èƒ½ä¼˜åŒ–æ˜¯å¿…é¡»è€ƒè™‘çš„é‡è¦å› ç´ ã€‚</p>
<p><strong>æ·±åº¦é‡‡æ ·ä¼˜åŒ–ç­–ç•¥</strong></p>
<ul>
<li>å‡å°‘é‡‡æ ·æ¬¡æ•°ï¼šåœ¨å¯èƒ½çš„æƒ…å†µä¸‹å¤ç”¨æ·±åº¦é‡‡æ ·ç»“æœ</li>
<li>ä½¿ç”¨mipmapï¼šå¯¹äºä¸éœ€è¦é«˜ç²¾åº¦æ·±åº¦çš„æ•ˆæœï¼Œä½¿ç”¨è¾ƒä½çº§åˆ«çš„mipmap</li>
<li>æ—©æœŸæ·±åº¦æµ‹è¯•ï¼šåˆç†å®‰æ’ç€è‰²å™¨æ‰§è¡Œé¡ºåºï¼Œå°½æ—©è¿›è¡Œæ·±åº¦æµ‹è¯•</li>
</ul>
<p><strong>å†…å­˜å¸¦å®½ä¼˜åŒ–</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">HLSL

<span class="hljs-comment">// ä¼˜åŒ–çš„æ·±åº¦é‡‡æ ·æ¨¡å¼é€‰æ‹©</span>
<span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> REQUIRE_HIGH_PRECISION_DEPTH</span>
    <span class="hljs-comment">// ä½¿ç”¨è¾ƒä½ç²¾åº¦çš„é‡‡æ ·</span>
    <span class="hljs-type">float</span> depth = <span class="hljs-built_in">SampleCustomDepth</span>(uv, LINEAR01);
<span class="hljs-meta">#<span class="hljs-keyword">else</span></span>
    <span class="hljs-comment">// éœ€è¦é«˜ç²¾åº¦æ—¶ä½¿ç”¨å®Œæ•´ç²¾åº¦</span>
    <span class="hljs-type">float</span> depth = <span class="hljs-built_in">SampleCustomDepth</span>(uv, LINEAR_EYE);
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>
</code></pre>
<p><strong>å¹³å°ç‰¹å®šä¼˜åŒ–</strong></p>
<p>ä¸åŒç¡¬ä»¶å¹³å°å¯¹æ·±åº¦é‡‡æ ·çš„æ”¯æŒå­˜åœ¨å·®å¼‚ï¼š</p>
<ul>
<li>PCå’Œä¸»æœºå¹³å°ï¼šæ”¯æŒå…¨ç²¾åº¦æ·±åº¦é‡‡æ ·</li>
<li>ç§»åŠ¨å¹³å°ï¼šå¯èƒ½éœ€è¦ä½¿ç”¨åŠç²¾åº¦æˆ–ç‰¹å®šçš„ä¼˜åŒ–æ ¼å¼</li>
<li>VRå¹³å°ï¼šéœ€è¦è€ƒè™‘åŒç›®æ¸²æŸ“çš„æ·±åº¦ä¸€è‡´æ€§</li>
</ul>
<h2 data-id="heading-5">é«˜çº§æŠ€å·§ä¸ç–‘éš¾è§£ç­”</h2>
<p><strong>è‡ªå®šä¹‰æ·±åº¦ä¸è¿åŠ¨çŸ¢é‡ç»“åˆ</strong></p>
<pre><code class="hljs language-scss" lang="scss">HLSL

<span class="hljs-comment">// ç»“åˆæ·±åº¦å’Œè¿åŠ¨çŸ¢é‡å®ç°è¿åŠ¨æ¨¡ç³Š</span>
void <span class="hljs-built_in">AdvancedMotionBlur</span>(float2 uv, float2 motionVector)
{
    <span class="hljs-attribute">float</span> currentDepth = <span class="hljs-built_in">SampleCustomDepth</span>(uv, LINEAR_EYE);
    float2 prevUV = uv - motionVector;
    <span class="hljs-attribute">float</span> previousDepth = <span class="hljs-built_in">SampleCustomDepth</span>(prevUV, LINEAR_EYE);

    <span class="hljs-comment">// åŸºäºæ·±åº¦ä¸€è‡´æ€§éªŒè¯è¿åŠ¨çŸ¢é‡</span>
    <span class="hljs-built_in">if</span>(abs(currentDepth - previousDepth) &lt; _DepthTolerance)
    {
        <span class="hljs-comment">// åº”ç”¨é«˜è´¨é‡è¿åŠ¨æ¨¡ç³Š</span>
        return <span class="hljs-built_in">ApplyMotionBlur</span>(uv, motionVector);
    }
    else
    {
        <span class="hljs-comment">// å›é€€åˆ°æ™®é€šè¿åŠ¨æ¨¡ç³Š</span>
        return <span class="hljs-built_in">FallbackMotionBlur</span>(uv, motionVector);
    }
}
</code></pre>
<p><strong>æ·±åº¦ç²¾åº¦é—®é¢˜è§£å†³</strong></p>
<p>æ·±åº¦ç²¾åº¦é—®é¢˜æ˜¯æ·±åº¦æ¸²æŸ“ä¸­çš„å¸¸è§æŒ‘æˆ˜ï¼š</p>
<ul>
<li>è¿œå¹³é¢è®¾ç½®ï¼šåˆç†è®¾ç½®è¿œè£å‰ªé¢è·ç¦»ï¼Œé¿å…ç²¾åº¦æµªè´¹</li>
<li>å¯¹æ•°æ·±åº¦ç¼“å†²åŒºï¼šåœ¨éœ€è¦è¶…å¤§èŒƒå›´æ·±åº¦æ—¶è€ƒè™‘ä½¿ç”¨å¯¹æ•°æ·±åº¦</li>
<li>æ·±åº¦åç§»ï¼šå¤„ç†æ·±åº¦å†²çªå’Œz-fightingé—®é¢˜</li>
</ul>
<p><strong>å¤šç›¸æœºæ¸²æŸ“ä¸­çš„æ·±åº¦ç®¡ç†</strong></p>
<p>åœ¨å¤æ‚æ¸²æŸ“ç®¡çº¿ä¸­å¤„ç†å¤šç›¸æœºåœºæ™¯ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">HLSL

<span class="hljs-comment">// å¤šç›¸æœºæ·±åº¦åˆæˆ</span>
<span class="hljs-attribute">float</span> <span class="hljs-built_in">CompositeMultiCameraDepth</span>(float2 uv)
{
    <span class="hljs-attribute">float</span> mainCameraDepth = <span class="hljs-built_in">SampleCustomDepth</span>(uv, LINEAR_EYE);
    <span class="hljs-attribute">float</span> secondaryCameraDepth = <span class="hljs-built_in">SampleSecondaryDepth</span>(uv, LINEAR_EYE);

    <span class="hljs-comment">// åŸºäºæ¸²æŸ“ä¼˜å…ˆçº§åˆæˆæ·±åº¦</span>
    return <span class="hljs-built_in">min</span>(mainCameraDepth, secondaryCameraDepth);
}
</code></pre>
<h2 data-id="heading-6">ä¸å…¶ä»–èŠ‚ç‚¹çš„ååŒå·¥ä½œ</h2>
<p>Custom Depth Nodeå¾ˆå°‘å•ç‹¬ä½¿ç”¨ï¼Œé€šå¸¸éœ€è¦ä¸å…¶ä»–Shader GraphèŠ‚ç‚¹é…åˆã€‚</p>
<p><strong>ä¸Scene DepthèŠ‚ç‚¹çš„å¯¹æ¯”ä½¿ç”¨</strong></p>
<pre><code class="hljs language-scss" lang="scss">HLSL

<span class="hljs-comment">// åœºæ™¯æ·±åº¦ä¸è‡ªå®šä¹‰æ·±åº¦çš„æ··åˆä½¿ç”¨</span>
void <span class="hljs-built_in">HybridDepthEffects</span>(float2 uv)
{
    <span class="hljs-attribute">float</span> sceneDepth = <span class="hljs-built_in">SceneDepth</span>(uv);
    <span class="hljs-attribute">float</span> customDepth = <span class="hljs-built_in">CustomDepth</span>(uv, LINEAR_EYE);

    <span class="hljs-comment">// åŸºäºç‰¹å®šæ¡ä»¶é€‰æ‹©æ·±åº¦æº</span>
    <span class="hljs-attribute">float</span> finalDepth = customDepth &gt; <span class="hljs-number">0</span> ? customDepth : sceneDepth;

    <span class="hljs-comment">// åº”ç”¨æ·±åº¦ç›¸å…³æ•ˆæœ</span>
    <span class="hljs-built_in">ApplyDepthBasedEffects</span>(uv, finalDepth);
}
</code></pre>
<p><strong>åœ¨æ¸²æŸ“ç®¡çº¿ä¸­çš„é›†æˆ</strong></p>
<p>Custom Depth Nodeéœ€è¦æ­£ç¡®é›†æˆåˆ°HDRPæ¸²æŸ“ç®¡çº¿ä¸­ï¼š</p>
<ul>
<li>ç¡®ä¿è‡ªå®šä¹‰æ·±åº¦é€šé“æ­£ç¡®è®¾ç½®</li>
<li>é…ç½®æ·±åº¦å†™å…¥å¯¹è±¡çš„æ¸²æŸ“å±‚</li>
<li>è®¾ç½®é€‚å½“çš„æ¸²æŸ“é¡ºåºå’Œé˜Ÿåˆ—</li>
</ul>
<h2 data-id="heading-7">è°ƒè¯•ä¸å¯è§†åŒ–æŠ€å·§</h2>
<p>æ·±åº¦æ•ˆæœçš„è°ƒè¯•æ˜¯å¼€å‘è¿‡ç¨‹ä¸­çš„é‡è¦ç¯èŠ‚ã€‚</p>
<p><strong>æ·±åº¦å¯è§†åŒ–å·¥å…·</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">HLSL

<span class="hljs-comment">// æ·±åº¦å€¼å¯è§†åŒ–</span>
<span class="hljs-function">float3 <span class="hljs-title">VisualizeDepth</span><span class="hljs-params">(<span class="hljs-type">float</span> depth, <span class="hljs-type">int</span> mode)</span>
</span>{
    <span class="hljs-keyword">switch</span>(mode)
    {
        <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>: <span class="hljs-comment">// ç°åº¦å¯è§†åŒ–</span>
            <span class="hljs-keyword">return</span> depth.xxx;
        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: <span class="hljs-comment">// çƒ­åŠ›å›¾</span>
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">HeatMap</span>(depth, <span class="hljs-number">0</span>, _FarClipPlane);
        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: <span class="hljs-comment">// ç­‰é«˜çº¿</span>
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">ContourLines</span>(depth, _ContourSpacing);
        <span class="hljs-keyword">default</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">float3</span>(<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>); <span class="hljs-comment">// é”™è¯¯é¢œè‰²</span>
    }
}
</code></pre>
<p><strong>å¸¸è§é—®é¢˜è¯Šæ–­</strong></p>
<ul>
<li>æ·±åº¦æ•°æ®ä¸º0ï¼šæ£€æŸ¥è‡ªå®šä¹‰æ·±åº¦é€šé“æ˜¯å¦å¯ç”¨</li>
<li>æ·±åº¦å€¼å¼‚å¸¸ï¼šéªŒè¯UVåæ ‡å’Œé‡‡æ ·æ¨¡å¼</li>
<li>æ€§èƒ½é—®é¢˜ï¼šåˆ†ææ·±åº¦é‡‡æ ·é¢‘ç‡å’Œç²¾åº¦éœ€æ±‚</li>
</ul>
<hr/>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong>
ï¼ˆæ¬¢è¿<em>ç‚¹èµç•™è¨€</em>æ¢è®¨ï¼Œæ›´å¤šäººåŠ å…¥è¿›æ¥èƒ½æ›´åŠ å®Œå–„è¿™ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ï¼ŒğŸ™ï¼‰</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Mybatisè¿æ¥æ± å®ç°åŠæ± åŒ–æ¨¡å¼]]></title>    <link>https://juejin.cn/post/7603649945978109971</link>    <guid>https://juejin.cn/post/7603649945978109971</guid>    <pubDate>2026-02-07T13:09:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603649945978109971" data-draft-id="7603649945978044435" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Mybatisè¿æ¥æ± å®ç°åŠæ± åŒ–æ¨¡å¼"/> <meta itemprop="keywords" content="MyBatis,æºç é˜…è¯»,Java"/> <meta itemprop="datePublished" content="2026-02-07T13:09:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜ä¾ å®¢è¡Œ"/> <meta itemprop="url" content="https://juejin.cn/user/556801719828361"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Mybatisè¿æ¥æ± å®ç°åŠæ± åŒ–æ¨¡å¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/556801719828361/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜ä¾ å®¢è¡Œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T13:09:29.000Z" title="Sat Feb 07 2026 13:09:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>MyBatis ä½¿ç”¨ javax.sql.DataSource æ ‡å‡†æ¥å£ï¼Œé€šè¿‡å·¥å‚æ¨¡å¼åˆ›å»ºä¸åŒç±»å‹çš„æ•°æ®æºå®ç°ã€‚ä½¿ç”¨å¯¹è±¡æ± æ¨¡å¼å®ç°PooledDataSourceï¼Œç”¨ä»£ç†æ¨¡å¼æ”¹å˜Connection#closeæ–¹æ³•é€»è¾‘ï¼Œå®ç°èµ„æºå½’è¿˜ã€‚</p>
<p><strong>ç†è§£MyBatisä¸­è¿æ¥æ± çš„å®ç°ï¼Œå¯ä¸ºå­¦ä¹ å…¶ä»–ç»„ä»¶å¦‚Druid ã€HikariCPæ‰“å¥½åŸºç¡€ã€‚</strong></p>
<blockquote>
<p>æ³¨ï¼šæœ¬æ–‡ä¸­æºç æ¥è‡ªmybatis 3.4.xç‰ˆæœ¬ï¼Œåœ°å€<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmybatis%2Fmybatis-3.git" target="_blank" title="https://github.com/mybatis/mybatis-3.git" ref="nofollow noopener noreferrer">github.com/mybatis/mybâ€¦</a></p>
</blockquote>
<h2 data-id="heading-0">ä¸€ DataSourceFactoryæ¥å£</h2>
<p>å·¥å‚æ¨¡å¼ï¼Œå£°æ˜åˆ›å»ºDataSourceå®ä¾‹æ–¹æ³•ï¼Œæœ‰3ä¸ªå®ç°ï¼š</p>
<ul>
<li>UnpooledDataSourceFactoryï¼Œç”¨äºåˆ›å»ºUnpooledDataSource</li>
<li>PooledDataSourceFactoryï¼Œç»§æ‰¿è‡ªUnpooledDataSourceFactoryï¼Œç”¨äºåˆ›å»ºPooledDataSource</li>
<li>JndiDataSourceFactoryï¼Œç¬¬ä¸‰æ–¹ DataSource (é€šè¿‡ JNDI è·å–)</li>
</ul>
<h2 data-id="heading-1"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3791e8c6fea748dcb7b6229086cb0a5b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771074568&amp;x-signature=QryfFVmU6EL%2B3Ki5U33WJrT299w%3D" alt="" loading="lazy"/></h2>
<h2 data-id="heading-2">äºŒ 3ç§è¿æ¥æ± </h2>
<h3 data-id="heading-3">2.1 UnpooledDataSource</h3>
<p>éæ± åŒ–æ•°æ®æºï¼Œæœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ul>
<li>æ¯æ¬¡ getConnection() éƒ½åˆ›å»ºæ–°çš„æ•°æ®åº“è¿æ¥</li>
<li>é€šè¿‡ DriverManager è·å–è¿æ¥</li>
<li>é€‚ç”¨äºç®€å•åº”ç”¨æˆ–æµ‹è¯•ç¯å¢ƒ</li>
</ul>
<p>æ ¸å¿ƒå±æ€§å¦‚ä¸‹ã€‚æ¯æ¬¡è·å–è¿æ¥ï¼Œéƒ½ç›´æ¥è°ƒç”¨DriverManager.getConnectionåˆ›å»ºä¸€ä¸ªå®ä¾‹ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2dd75279564344918fb45abffb0e100c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771074568&amp;x-signature=marzoI0K0vV6WqVHDM%2BvduzDRDU%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-4">2.2 PooledDataSource</h3>
<p>æ± åŒ–æ•°æ®æºï¼Œç»´æŠ¤ä¸€ä¸ªæ± å­ï¼ˆå…¶å®å°±æ˜¯Listï¼‰ï¼Œå¤ç”¨æ•°æ®åº“è¿æ¥ï¼ŒåŸºäº UnpooledDataSource å®ç°ã€‚</p>
<p>PooledDataSourceå†…éƒ¨æŒæœ‰ UnpooledDataSource åˆ›å»ºçœŸå®è¿æ¥ï¼Œç»´æŠ¤ PoolState ç®¡ç†è¿æ¥çŠ¶æ€ï¼Œä½¿ç”¨åŠ¨æ€ä»£ç†æ‹¦æˆªConnection.close() æ–¹æ³•ï¼Œå°†è¿æ¥å½’è¿˜åˆ°æ± å­è€ŒéçœŸçš„å…³é—­ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b56137057e445609d28df2836556b82~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771074568&amp;x-signature=y7RAPqPvWsuureX2gCbCEdEbsQs%3D" alt="" loading="lazy"/>
è¿æ¥æ± é…ç½®å¦‚ä¸‹
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/89eb2a0487cb413c9d437c27aa67f601~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771074568&amp;x-signature=35dZla86Ci%2BaeRysLVOJPNI4SRo%3D" alt="" loading="lazy"/>
è¿æ¥æ± çŠ¶æ€ä¸»è¦å‚æ•°å¦‚ä¸‹ï¼Œä½¿ç”¨ä¸­è¿æ¥ã€ç©ºé—²è¿æ¥åˆ†åˆ«æ”¾åœ¨ä¸åŒçš„Listã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90b38869c5af4b548e7d70159652a2c7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771074568&amp;x-signature=2%2Bh9D8eqOrkirIByU34WuFzOn%2Bg%3D" alt="" loading="lazy"/>
ä»PooledDataSourceä¸­è·å–åˆ°çš„è¿æ¥ï¼Œå…¶å®æ˜¯ä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37973bb8a7b441de9db244cef1d35df0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771074568&amp;x-signature=X7wQs6WtLVNc3xAsf7mBaq5aDRE%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-5">PooledConnection</h4>
<p>PooledDataSourceæ± ä¸­å…¶å®æ˜¯PooledConnectionå¯¹è±¡ï¼ˆå¹¶æ²¡æœ‰å®ç°Connectionæ¥å£ï¼‰ï¼Œå®ƒæŒæœ‰Connectionå®ä¾‹ã€Connectionä»£ç†å¯¹è±¡ï¼Œå¹¶ä¸”å®ç°äº†InvocationHandleræ¥å£ï¼Œå£°æ˜äº†åŠ¨æ€ä»£ç†é€»è¾‘ï¼š</p>
<ul>
<li>ä»£ç†è¿æ¥è°ƒç”¨closeæ–¹æ³•æ—¶ï¼Œä¼šå°†è¿æ¥æ”¾å›è¿æ¥æ± ï¼›</li>
<li>ä»£ç†è¿æ¥è°ƒç”¨å…¶ä»–éObjectçš„æ–¹æ³•æ—¶ï¼Œä¼šå…ˆæ£€æŸ¥è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼›</li>
<li>è®°å½•è¿æ¥åˆ›å»ºæ—¶é—´ã€æœ€åä¸€æ¬¡ä½¿ç”¨æ—¶é—´ã€å€Ÿå‡ºæ—¶é—´ï¼Œç”¨äºè¿æ¥æœ‰æ•ˆæ€§ç®¡ç†ï¼›</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7047054c903f47508edcb29762528087~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771074568&amp;x-signature=EGYCw6qBZ6iOAYpQFexGZsnk%2BMU%3D" alt="" loading="lazy"/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84fb6ea24e5a4600b49b75e4e59004f4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771074568&amp;x-signature=AYyVC9UqU32M7khNK4nvRIXuwok%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-6">è·å–/å½’è¿˜è¿æ¥</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9cbe1d86fd2b46ec9d91d2f4771cc321~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771074568&amp;x-signature=wnXG0kYqgH7ALVCUQ4lhJYrMko4%3D" alt="" loading="lazy"/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/20a81b0d87d14d62811570bc809040ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771074568&amp;x-signature=7TE8sgV3IERRgiuJZPAJl1f%2Fepg%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-7">2.3 JndiDataSourceFactory</h3>
<p>ä» JNDI ä¸Šä¸‹æ–‡è·å–å·²é…ç½®çš„ DataSourceï¼Œé€‚ç”¨äºåº”ç”¨æœåŠ¡å™¨ç¯å¢ƒï¼ˆå¦‚ Tomcatã€WebLogicï¼‰ï¼Œä¸ç›´æ¥åˆ›å»ºè¿æ¥ï¼Œè€Œæ˜¯ä½¿ç”¨å®¹å™¨ç®¡ç†çš„æ•°æ®æºã€‚</p>
<h2 data-id="heading-8">ä¸‰ æ± åŒ–æ¨¡å¼å®ç°</h2>
<h3 data-id="heading-9">3.1 Mybatisçš„å¯å‘</h3>
<p>MyBatis çš„ PooledDataSource è™½ç„¶ç®€å•ï¼Œä½†åŒ…å«äº†æ± åŒ–æŠ€æœ¯çš„æ ¸å¿ƒæ€æƒ³ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>å¯¹è±¡å¤ç”¨è€Œéå¯¹è±¡å…±äº«</li>
</ul>
<p>æ± åŒ–ä¸æ˜¯ç®€å•åœ°å¤ç”¨å¯¹è±¡æœ¬èº«ï¼Œè€Œæ˜¯å¤ç”¨æ˜‚è´µçš„åº•å±‚èµ„æºï¼ˆçœŸå®è¿æ¥ï¼‰ï¼Œé€šè¿‡æ–°åŒ…è£…å¯¹è±¡éš”ç¦»ä½¿ç”¨çŠ¶æ€ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å½’è¿˜æ—¶åˆ›å»ºæ–°çš„åŒ…è£…å¯¹è±¡</span>
<span class="hljs-type">PooledConnection</span> <span class="hljs-variable">newConn</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PooledConnection</span>(conn.getRealConnection(), <span class="hljs-built_in">this</span>);
state.idleConnections.add(newConn);
conn.invalidate(); <span class="hljs-comment">// æ—§å¯¹è±¡å¤±æ•ˆ</span>
</code></pre>
<ul>
<li>åŠ¨æ€ä»£ç†æ‹¦æˆªèµ„æºé‡Šæ”¾</li>
</ul>
<p>é€šè¿‡ä»£ç†æ¨¡å¼é€æ˜åœ°æ”¹å˜èµ„æºé‡Šæ”¾è¡Œä¸ºï¼Œç”¨æˆ·æ— æ„ŸçŸ¥åœ°å®ç°æ± åŒ–ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// PooledConnection å®ç° InvocationHandler</span>
<span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> {
    <span class="hljs-keyword">if</span> (CLOSE.equals(methodName)) {
        <span class="hljs-comment">// å½’è¿˜è€Œéå…³é—­</span>
        dataSource.pushConnection(<span class="hljs-built_in">this</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    <span class="hljs-keyword">return</span> method.invoke(realConnection, args);
}
</code></pre>
<ul>
<li>è¶…æ—¶å¼ºåˆ¶å›æ”¶æœºåˆ¶</li>
</ul>
<p>é˜²æ­¢èµ„æºæ³„æ¼çš„æœ€åé˜²çº¿ï¼Œé¿å…å› ä½¿ç”¨æ–¹å¿˜è®°é‡Šæ”¾å¯¼è‡´æ± è€—å°½ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">if</span> (longestCheckoutTime &gt; poolMaximumCheckoutTime) {
    <span class="hljs-comment">// å¼ºåˆ¶å›æ”¶è¶…æ—¶è¿æ¥</span>
    state.activeConnections.remove(oldestActiveConnection);
    conn = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PooledConnection</span>(oldestActiveConnection.getRealConnection(), <span class="hljs-built_in">this</span>);
}
</code></pre>
<ul>
<li>çŠ¶æ€ä¸å¥åº·ç®¡ç†</li>
</ul>
<p>é™¤äº†æ£€æŸ¥èµ„æºçŠ¶æ€ï¼Œè¿˜éœ€æ£€æŸ¥æ± ä¸­çš„connectionæ˜¯å¦æ–­è¿ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">pingConnection</span><span class="hljs-params">(PooledConnection conn)</span> {
    <span class="hljs-comment">// 1. æ£€æŸ¥è¿æ¥æ˜¯å¦å…³é—­</span>
    <span class="hljs-comment">// 2. å¯é€‰ï¼šæ‰§è¡Œ ping æŸ¥è¯¢æµ‹è¯•</span>
    <span class="hljs-comment">// 3. é•¿æ—¶é—´æœªä½¿ç”¨æ‰ pingï¼Œé¿å…é¢‘ç¹æµ‹è¯•</span>
}
</code></pre>
<ul>
<li>ç›‘æ§ä¸å¯è§‚æµ‹æ€§</li>
</ul>
<p>è®¾è®¡è¯¦ç»†çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œä¾¿äºåˆ†ææ€§èƒ½ã€è°ƒä¼˜å’Œé—®é¢˜è¯Šæ–­ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> <span class="hljs-type">long</span> requestCount;                    <span class="hljs-comment">// è¯·æ±‚æ€»æ•°</span>
<span class="hljs-keyword">protected</span> <span class="hljs-type">long</span> accumulatedRequestTime;          <span class="hljs-comment">// ç´¯è®¡è¯·æ±‚æ—¶é—´</span>
<span class="hljs-keyword">protected</span> <span class="hljs-type">long</span> accumulatedCheckoutTime;         <span class="hljs-comment">// ç´¯è®¡å€Ÿå‡ºæ—¶é—´</span>
<span class="hljs-keyword">protected</span> <span class="hljs-type">long</span> badConnectionCount;              <span class="hljs-comment">// åè¿æ¥æ•°</span>
<span class="hljs-keyword">protected</span> <span class="hljs-type">long</span> hadToWaitCount;                  <span class="hljs-comment">// ç­‰å¾…æ¬¡æ•°</span>
</code></pre>
<h3 data-id="heading-10">3.2 é€šç”¨æ± åŒ–å®ç°</h3>
<p>åŸºäºä»¥ä¸Šåˆ†æï¼Œå¯ä»¥æŠ½è±¡å‡ºé€šç”¨çš„æ± åŒ–å®ç°æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericObjectPool</span>&lt;T&gt; {
    <span class="hljs-comment">// 1. åŒåˆ—è¡¨ç®¡ç†</span>
    <span class="hljs-keyword">private</span> List&lt;PooledObject&lt;T&gt;&gt; idle = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-keyword">private</span> List&lt;PooledObject&lt;T&gt;&gt; active = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    
    <span class="hljs-comment">// 2. é…ç½®å‚æ•°</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> maxTotal;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> maxIdle;
    <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> maxWaitMillis;
    
    <span class="hljs-comment">// 3. è·å–èµ„æº</span>
    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">borrow</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span> (lock) {
            <span class="hljs-comment">// ä¼˜å…ˆä»ç©ºé—²åˆ—è¡¨è·å–</span>
            <span class="hljs-comment">// å…¶æ¬¡åˆ›å»ºæ–°å¯¹è±¡</span>
            <span class="hljs-comment">// æˆ–å›æ”¶è¶…æ—¶å¯¹è±¡</span>
            <span class="hljs-comment">// æœ€åç­‰å¾…</span>
            lock.wait(maxWaitMillis);
        }
    }
    
    <span class="hljs-comment">// 4. å½’è¿˜èµ„æº</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">return</span><span class="hljs-params">(T obj)</span> {
        <span class="hljs-keyword">synchronized</span> (lock) {
            <span class="hljs-comment">// éªŒè¯æœ‰æ•ˆæ€§</span>
            <span class="hljs-comment">// é‡ç½®çŠ¶æ€</span>
            <span class="hljs-comment">// æ”¾å›ç©ºé—²åˆ—è¡¨æˆ–é”€æ¯</span>
            lock.notifyAll();
        }
    }
    
    <span class="hljs-comment">// 5. å¥åº·æ£€æŸ¥</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">validate</span><span class="hljs-params">(T obj)</span> {
    }
    
    <span class="hljs-comment">// 6. ç»Ÿè®¡ç›‘æ§</span>
    <span class="hljs-keyword">private</span> PoolStats stats;
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hibernateï¼ˆ89ï¼‰å¦‚ä½•åœ¨å‹åŠ›æµ‹è¯•ä¸­ä½¿ç”¨Hibernateï¼Ÿ]]></title>    <link>https://juejin.cn/post/7603656494904885254</link>    <guid>https://juejin.cn/post/7603656494904885254</guid>    <pubDate>2026-02-07T13:54:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603656494904885254" data-draft-id="7603649945978191891" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hibernateï¼ˆ89ï¼‰å¦‚ä½•åœ¨å‹åŠ›æµ‹è¯•ä¸­ä½¿ç”¨Hibernateï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-07T13:54:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hibernateï¼ˆ89ï¼‰å¦‚ä½•åœ¨å‹åŠ›æµ‹è¯•ä¸­ä½¿ç”¨Hibernateï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T13:54:22.000Z" title="Sat Feb 07 2026 13:54:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å‹åŠ›æµ‹è¯•æ˜¯ä¸ºäº†æµ‹è¯•ç³»ç»Ÿåœ¨è¶…å‡ºå…¶é¢„æœŸå·¥ä½œè´Ÿè½½çš„æ¡ä»¶ä¸‹çš„è¡¨ç°ï¼Œä»¥ç¡®å®šç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚å®ƒå¯ä»¥å¸®åŠ©è¯†åˆ«ç³»ç»Ÿçš„ç“¶é¢ˆå’Œå´©æºƒç‚¹ã€‚åœ¨å‹åŠ›æµ‹è¯•ä¸­ä½¿ç”¨Hibernateï¼Œå¯ä»¥æ¨¡æ‹Ÿé«˜è´Ÿè½½ä¸‹çš„æ•°æ®åº“æ“ä½œï¼Œè¯†åˆ«å’Œè§£å†³æ€§èƒ½ç“¶é¢ˆã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªè¯¦ç»†çš„ç¤ºä¾‹ï¼Œç»“åˆä»£ç è®²è§£å¦‚ä½•åœ¨å‹åŠ›æµ‹è¯•ä¸­ä½¿ç”¨Hibernateï¼ŒåŒ…æ‹¬æ•°æ®åº“é…ç½®ã€ç¼–å†™å®ä½“ç±»ã€è®¾ç½®æ•°æ®è®¿é—®å¯¹è±¡ (DAO)ã€ç¼–å†™å‹åŠ›æµ‹è¯•è„šæœ¬ä»¥åŠä½¿ç”¨å·¥å…·è¿›è¡Œå‹åŠ›æµ‹è¯•ã€‚</p>
<h3 data-id="heading-0">å‰ææ¡ä»¶</h3>
<ul>
<li>ä½¿ç”¨MySQLä½œä¸ºæ•°æ®åº“ã€‚</li>
<li>ä½¿ç”¨Gradleä½œä¸ºæ„å»ºå·¥å…·ã€‚</li>
<li>ä½¿ç”¨JUnitè¿›è¡Œå‹åŠ›æµ‹è¯•ã€‚</li>
<li>ä½¿ç”¨Hibernateè¿›è¡ŒORMæ“ä½œã€‚</li>
<li>ä½¿ç”¨Apache JMeterè¿›è¡Œå‹åŠ›æµ‹è¯•ã€‚</li>
</ul>
<h3 data-id="heading-1">1. è®¾ç½®Hibernateé…ç½®</h3>
<p>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªHibernateé…ç½®æ–‡ä»¶ <code>hibernate.cfg.xml</code>ï¼Œç”¨äºè¿æ¥æ•°æ®åº“ã€‚</p>
<h4 data-id="heading-2"><code>hibernate.cfg.xml</code></h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span>?&gt;</span>
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">hibernate-configuration</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span> <span class="hljs-string">"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">hibernate-configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">session-factory</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/stress_test_db<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.username"</span>&gt;</span>db_user<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.password"</span>&gt;</span>db_password<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.hbm2ddl.auto"</span>&gt;</span>update<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.show_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">session-factory</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">hibernate-configuration</span>&gt;</span>
</code></pre>
<h3 data-id="heading-3">2. åˆ›å»ºå®ä½“ç±»</h3>
<p>å®šä¹‰ä¸€ä¸ªç®€å•çš„å®ä½“ç±»æ¥è¡¨ç¤ºæ•°æ®åº“è¡¨ä¸­çš„æ•°æ®ã€‚</p>
<h4 data-id="heading-4"><code>User.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> javax.persistence.*;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "users")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> String email;

    <span class="hljs-comment">// Getters and setters</span>
}
</code></pre>
<h3 data-id="heading-5">3. é…ç½®Gradle</h3>
<p>åœ¨Gradleæ„å»ºè„šæœ¬ä¸­æ·»åŠ Hibernateå’ŒJUnitä¾èµ–ã€‚</p>
<h4 data-id="heading-6"><code>build.gradle</code></h4>
<pre><code class="hljs language-groovy" lang="groovy">plugins {
    id 'java'
}

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.hibernate:hibernate-core:5.6.5.Final'
    implementation 'mysql:mysql-connector-java:8.0.27'
    testImplementation 'org.junit.jupiter:junit-jupiter:5.8.2'
}

test {
    useJUnitPlatform()
}
</code></pre>
<h3 data-id="heading-7">4. ç¼–å†™æ•°æ®è®¿é—®å¯¹è±¡ï¼ˆDAOï¼‰</h3>
<p>ç¼–å†™ä¸€ä¸ªæ•°æ®è®¿é—®å¯¹è±¡ç±»ï¼Œç”¨äºæ‰§è¡Œæ•°æ®åº“æ“ä½œã€‚</p>
<h4 data-id="heading-8"><code>UserDAO.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.Transaction;
<span class="hljs-keyword">import</span> org.hibernate.cfg.Configuration;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserDAO</span> {
    <span class="hljs-keyword">private</span> SessionFactory sessionFactory;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserDAO</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Configuration</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>().configure(<span class="hljs-string">"hibernate.cfg.xml"</span>);
        sessionFactory = config.buildSessionFactory();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">saveUser</span><span class="hljs-params">(User user)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();
        session.save(user);
        transaction.commit();
        session.close();
    }

    <span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">findAllUsers</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        List&lt;User&gt; users = session.createQuery(<span class="hljs-string">"FROM User"</span>, User.class).list();
        session.close();
        <span class="hljs-keyword">return</span> users;
    }
}
</code></pre>
<h3 data-id="heading-9">5. ç¼–å†™å‹åŠ›æµ‹è¯•è„šæœ¬</h3>
<p>ä½¿ç”¨JUnitç¼–å†™å‹åŠ›æµ‹è¯•è„šæœ¬ï¼Œæ¨¡æ‹Ÿé«˜å¹¶å‘ç¯å¢ƒä¸‹çš„æ•°æ®åº“æ“ä½œã€‚</p>
<h4 data-id="heading-10"><code>UserDAOTest.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.junit.jupiter.api.*;
<span class="hljs-keyword">import</span> java.util.concurrent.*;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.jupiter.api.Assertions.*;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserDAOTest</span> {
    <span class="hljs-keyword">private</span> UserDAO userDAO;

    <span class="hljs-meta">@BeforeEach</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setUp</span><span class="hljs-params">()</span> {
        userDAO = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserDAO</span>();
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testConcurrentUserInserts</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-type">int</span> <span class="hljs-variable">numberOfThreads</span> <span class="hljs-operator">=</span> <span class="hljs-number">500</span>;
        <span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executorService</span> <span class="hljs-operator">=</span> Executors.newFixedThreadPool(numberOfThreads);
        <span class="hljs-type">CountDownLatch</span> <span class="hljs-variable">latch</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CountDownLatch</span>(numberOfThreads);

        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; numberOfThreads; i++) {
            <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> i;
            executorService.submit(() -&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();
                    user.setName(<span class="hljs-string">"User"</span> + index);
                    user.setEmail(<span class="hljs-string">"user"</span> + index + <span class="hljs-string">"@example.com"</span>);
                    userDAO.saveUser(user);
                } <span class="hljs-keyword">finally</span> {
                    latch.countDown();
                }
            });
        }

        latch.await();
        executorService.shutdown();

        <span class="hljs-comment">// Verify that all users were inserted</span>
        List&lt;User&gt; users = userDAO.findAllUsers();
        assertEquals(numberOfThreads, users.size());
    }
}
</code></pre>
<h3 data-id="heading-11">6. ä½¿ç”¨Apache JMeterè¿›è¡Œå‹åŠ›æµ‹è¯•</h3>
<p>Apache JMeteræ˜¯ä¸€ä¸ªå¼€æºçš„è´Ÿè½½å’Œæ€§èƒ½æµ‹è¯•å·¥å…·ï¼Œå¯ä»¥ç”Ÿæˆé«˜å¹¶å‘è¯·æ±‚æ¥æ¨¡æ‹Ÿå®é™…çš„ç”¨æˆ·è¡Œä¸ºã€‚</p>
<h4 data-id="heading-12">å®‰è£…Apache JMeter</h4>
<p>ä»<a href="https://link.juejin.cn?target=https%3A%2F%2Fjmeter.apache.org%2Fdownload_jmeter.cgi" target="_blank" title="https://jmeter.apache.org/download_jmeter.cgi" ref="nofollow noopener noreferrer">Apache JMeterå®˜ç½‘</a>ä¸‹è½½å¹¶å®‰è£…JMeterã€‚</p>
<h4 data-id="heading-13">åˆ›å»ºJMeteræµ‹è¯•è®¡åˆ’</h4>
<ol>
<li>æ‰“å¼€Apache JMeterã€‚</li>
<li>æ·»åŠ ä¸€ä¸ªçº¿ç¨‹ç»„ï¼Œè®¾ç½®çº¿ç¨‹æ•°ï¼ˆç”¨æˆ·æ•°ï¼‰å’Œå¾ªç¯æ¬¡æ•°ã€‚</li>
<li>æ·»åŠ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œè®¾ç½®è¯·æ±‚æ–¹æ³•ã€URLå’Œå‚æ•°ã€‚</li>
<li>æ·»åŠ ä¸€ä¸ªç›‘å¬å™¨ï¼Œå¦‚â€œèšåˆæŠ¥å‘Šâ€æˆ–â€œæŸ¥çœ‹ç»“æœæ ‘â€ã€‚</li>
</ol>
<h4 data-id="heading-14">ç¤ºä¾‹JMeteræµ‹è¯•è®¡åˆ’</h4>
<p>å‡è®¾ä½ æœ‰ä¸€ä¸ªREST APIç«¯ç‚¹æ¥ä¿å­˜ç”¨æˆ·æ•°æ®ã€‚</p>
<ol>
<li>
<p><strong>Thread Group</strong>:</p>
<ul>
<li>Number of Threads: 500 (æ¨¡æ‹Ÿ500ä¸ªå¹¶å‘ç”¨æˆ·)</li>
<li>Ramp-Up Period: 10 seconds</li>
<li>Loop Count: 1</li>
</ul>
</li>
<li>
<p><strong>HTTP Request</strong>:</p>
<ul>
<li>Method: POST</li>
<li>URL: <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A8080%2Fusers" target="_blank" title="http://localhost:8080/users" ref="nofollow noopener noreferrer">http://localhost:8080/users</a></li>
<li>Body Data:
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"John Doe"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"email"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"john.doe@example.com"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Listener</strong>:</p>
<ul>
<li>æ·»åŠ ä¸€ä¸ªâ€œæŸ¥çœ‹ç»“æœæ ‘â€ç›‘å¬å™¨æ¥æŸ¥çœ‹è¯·æ±‚å’Œå“åº”ã€‚</li>
<li>æ·»åŠ ä¸€ä¸ªâ€œèšåˆæŠ¥å‘Šâ€ç›‘å¬å™¨æ¥æ±‡æ€»æµ‹è¯•ç»“æœã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-15">7. é›†æˆåˆ°CI/CDæµç¨‹</h3>
<p>å°†å‹åŠ›æµ‹è¯•é›†æˆåˆ°CI/CDæµç¨‹ä¸­ï¼Œç¡®ä¿æ¯æ¬¡æ„å»ºéƒ½è¿›è¡Œå‹åŠ›æµ‹è¯•è¯„ä¼°ã€‚</p>
<h4 data-id="heading-16"><code>.github/workflows/stress-test.yml</code></h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">Stress</span> <span class="hljs-string">Test</span>

<span class="hljs-attr">on:</span>
  <span class="hljs-attr">push:</span>
    <span class="hljs-attr">branches:</span> [ <span class="hljs-string">main</span> ]
  <span class="hljs-attr">pull_request:</span>
    <span class="hljs-attr">branches:</span> [ <span class="hljs-string">main</span> ]

<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">build:</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>

    <span class="hljs-attr">services:</span>
      <span class="hljs-attr">mysql:</span>
        <span class="hljs-attr">image:</span> <span class="hljs-string">mysql:5.7</span>
        <span class="hljs-attr">ports:</span>
          <span class="hljs-bullet">-</span> <span class="hljs-number">3306</span><span class="hljs-string">:3306</span>
        <span class="hljs-attr">env:</span>
          <span class="hljs-attr">MYSQL_ROOT_PASSWORD:</span> <span class="hljs-string">root</span>
          <span class="hljs-attr">MYSQL_DATABASE:</span> <span class="hljs-string">stress_test_db</span>
          <span class="hljs-attr">MYSQL_USER:</span> <span class="hljs-string">db_user</span>
          <span class="hljs-attr">MYSQL_PASSWORD:</span> <span class="hljs-string">db_password</span>
        <span class="hljs-attr">options:</span> <span class="hljs-string">--health-cmd="mysqladmin</span> <span class="hljs-string">ping</span> <span class="hljs-string">--silent"</span> <span class="hljs-string">--health-interval=10s</span> <span class="hljs-string">--health-timeout=5s</span> <span class="hljs-string">--health-retries=3</span>

    <span class="hljs-attr">steps:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Checkout</span> <span class="hljs-string">code</span>
      <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span>

    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Set</span> <span class="hljs-string">up</span> <span class="hljs-string">JDK</span> <span class="hljs-number">11</span>
      <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-java@v2</span>
      <span class="hljs-attr">with:</span>
        <span class="hljs-attr">java-version:</span> <span class="hljs-string">'11'</span>

    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Grant</span> <span class="hljs-string">execute</span> <span class="hljs-string">permission</span> <span class="hljs-string">for</span> <span class="hljs-string">gradlew</span>
      <span class="hljs-attr">run:</span> <span class="hljs-string">chmod</span> <span class="hljs-string">+x</span> <span class="hljs-string">gradlew</span>

    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">stress</span> <span class="hljs-string">tests</span>
      <span class="hljs-attr">run:</span> <span class="hljs-string">./gradlew</span> <span class="hljs-string">test</span>

    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">JMeter</span> <span class="hljs-string">stress</span> <span class="hljs-string">test</span>
      <span class="hljs-attr">run:</span> <span class="hljs-string">jmeter</span> <span class="hljs-string">-n</span> <span class="hljs-string">-t</span> <span class="hljs-string">path/to/your/test-plan.jmx</span> <span class="hljs-string">-l</span> <span class="hljs-string">path/to/your/test-results.jtl</span>
</code></pre>
<h3 data-id="heading-17">ä¾‹å­è§£é‡Š</h3>
<ol>
<li><strong>Hibernateé…ç½®ï¼š</strong> é…ç½®ä¸€ä¸ªHibernateé…ç½®æ–‡ä»¶ï¼Œç”¨äºè¿æ¥æ•°æ®åº“ã€‚</li>
<li><strong>å®ä½“ç±»ï¼š</strong> åˆ›å»ºä¸€ä¸ªç®€å•çš„å®ä½“ç±»æ¥è¡¨ç¤ºæ•°æ®åº“è¡¨ä¸­çš„æ•°æ®ã€‚</li>
<li><strong>Gradleé…ç½®ï¼š</strong> åœ¨Gradleæ„å»ºè„šæœ¬ä¸­æ·»åŠ Hibernateå’ŒJUnitä¾èµ–ã€‚</li>
<li><strong>æ•°æ®è®¿é—®å¯¹è±¡ï¼ˆDAOï¼‰ï¼š</strong> ç¼–å†™ä¸€ä¸ªæ•°æ®è®¿é—®å¯¹è±¡ç±»ï¼Œç”¨äºæ‰§è¡Œæ•°æ®åº“æ“ä½œã€‚</li>
<li><strong>å‹åŠ›æµ‹è¯•è„šæœ¬ï¼š</strong> ä½¿ç”¨JUnitç¼–å†™å‹åŠ›æµ‹è¯•è„šæœ¬ï¼Œæ¨¡æ‹Ÿé«˜å¹¶å‘ç¯å¢ƒä¸‹çš„æ•°æ®åº“æ“ä½œã€‚</li>
<li><strong>ä½¿ç”¨Apache JMeterè¿›è¡Œå‹åŠ›æµ‹è¯•ï¼š</strong> åˆ›å»ºJMeteræµ‹è¯•è®¡åˆ’ï¼Œæ¨¡æ‹Ÿé«˜å¹¶å‘è¯·æ±‚æ¥æµ‹è¯•åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚</li>
<li><strong>é›†æˆåˆ°CI/CDæµç¨‹ï¼š</strong> å°†å‹åŠ›æµ‹è¯•é›†æˆåˆ°CI/CDæµç¨‹ä¸­ï¼Œç¡®ä¿æ¯æ¬¡æ„å»ºéƒ½è¿›è¡Œå‹åŠ›æµ‹è¯•è¯„ä¼°ã€‚</li>
</ol>
<p>é€šè¿‡ä»¥ä¸Šé…ç½®å’Œä»£ç ç¤ºä¾‹ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•åœ¨å‹åŠ›æµ‹è¯•ä¸­ä½¿ç”¨Hibernateã€‚è¿™åŒ…æ‹¬é…ç½®Hibernateã€å®šä¹‰å®ä½“ç±»ã€ç¼–å†™æ•°æ®è®¿é—®å¯¹è±¡ã€ç¼–å†™å‹åŠ›æµ‹è¯•è„šæœ¬ã€ä½¿ç”¨Apache JMeterè¿›è¡Œå‹åŠ›æµ‹è¯•ï¼Œä»¥åŠå°†å‹åŠ›æµ‹è¯•é›†æˆåˆ°CI/CDæµç¨‹ä¸­ã€‚æ­¤æµç¨‹å¸®åŠ©è¯†åˆ«å’Œè§£å†³åº”ç”¨ç¨‹åºåœ¨è¶…å‡ºé¢„æœŸå·¥ä½œè´Ÿè½½ä¸‹çš„æ€§èƒ½ç“¶é¢ˆï¼Œç¡®ä¿åœ¨å®é™…ä½¿ç”¨ç¯å¢ƒä¸­ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[https://editor.csdn.net/md/?articleId=139321571&spm=1011.2415.3001.9698]]></title>    <link>https://juejin.cn/post/7603644943350677510</link>    <guid>https://juejin.cn/post/7603644943350677510</guid>    <pubDate>2026-02-07T13:57:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603644943350677510" data-draft-id="7603651011978821674" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="https://editor.csdn.net/md/?articleId=139321571&amp;spm=1011.2415.3001.9698"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-07T13:57:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            https://editor.csdn.net/md/?articleId=139321571&amp;spm=1011.2415.3001.9698
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T13:57:06.000Z" title="Sat Feb 07 2026 13:57:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ•…éšœæ³¨å…¥æµ‹è¯•ç”¨æ¥æ¨¡æ‹Ÿå„ç§æ•…éšœæƒ…å½¢ï¼Œä»¥æµ‹è¯•ç³»ç»Ÿåœ¨è¿™äº›æƒ…å½¢ä¸‹çš„è¡Œä¸ºå’Œæ¢å¤èƒ½åŠ›ã€‚åœ¨ä½¿ç”¨Hibernateè¿›è¡Œæ•…éšœæ³¨å…¥æµ‹è¯•æ—¶ï¼Œå¯ä»¥æ¨¡æ‹Ÿæ•°æ®åº“è¿æ¥ä¸­æ–­ã€äº‹åŠ¡å¤±è´¥ç­‰æ•…éšœæƒ…å½¢ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€äº›å·¥å…·ï¼Œå¦‚Chaos Monkey for Spring Bootï¼Œæ¥ç®€åŒ–æ•…éšœæ³¨å…¥è¿‡ç¨‹ã€‚</p>
<h3 data-id="heading-0">å‰ææ¡ä»¶</h3>
<ul>
<li>ä½¿ç”¨MySQLä½œä¸ºæ•°æ®åº“ã€‚</li>
<li>ä½¿ç”¨Gradleä½œä¸ºæ„å»ºå·¥å…·ã€‚</li>
<li>ä½¿ç”¨JUnitè¿›è¡Œæ•…éšœæ³¨å…¥æµ‹è¯•ã€‚</li>
<li>ä½¿ç”¨Hibernateè¿›è¡ŒORMæ“ä½œã€‚</li>
<li>ä½¿ç”¨Chaos Monkey for Spring Bootè¿›è¡Œæ•…éšœæ³¨å…¥ã€‚</li>
</ul>
<h3 data-id="heading-1">1. è®¾ç½®Hibernateé…ç½®</h3>
<p>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªHibernateé…ç½®æ–‡ä»¶ <code>hibernate.cfg.xml</code>ï¼Œç”¨äºè¿æ¥æ•°æ®åº“ã€‚</p>
<h4 data-id="heading-2"><code>hibernate.cfg.xml</code></h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span>?&gt;</span>
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">hibernate-configuration</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span> <span class="hljs-string">"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">hibernate-configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">session-factory</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/fault_injection_test_db<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.username"</span>&gt;</span>db_user<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.password"</span>&gt;</span>db_password<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.hbm2ddl.auto"</span>&gt;</span>update<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.show_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">session-factory</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">hibernate-configuration</span>&gt;</span>
</code></pre>
<h3 data-id="heading-3">2. åˆ›å»ºå®ä½“ç±»</h3>
<p>å®šä¹‰ä¸€ä¸ªç®€å•çš„å®ä½“ç±»æ¥è¡¨ç¤ºæ•°æ®åº“è¡¨ä¸­çš„æ•°æ®ã€‚</p>
<h4 data-id="heading-4"><code>User.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> javax.persistence.*;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "users")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> String email;

    <span class="hljs-comment">// Getters and setters</span>
}
</code></pre>
<h3 data-id="heading-5">3. é…ç½®Gradle</h3>
<p>åœ¨Gradleæ„å»ºè„šæœ¬ä¸­æ·»åŠ Hibernateã€JUnitå’ŒChaos Monkey for Spring Bootä¾èµ–ã€‚</p>
<h4 data-id="heading-6"><code>build.gradle</code></h4>
<pre><code class="hljs language-groovy" lang="groovy">plugins {
    id 'java'
    id 'org.springframework.boot' version '2.6.2'
}

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.hibernate:hibernate-core:5.6.5.Final'
    implementation 'mysql:mysql-connector-java:8.0.27'
    implementation 'de.codecentric:chaos-monkey-spring-boot:2.4.0'
    testImplementation 'org.junit.jupiter:junit-jupiter:5.8.2'
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
}

test {
    useJUnitPlatform()
}
</code></pre>
<h3 data-id="heading-7">4. é…ç½®Chaos Monkey for Spring Boot</h3>
<p>åœ¨<code>application.properties</code>æ–‡ä»¶ä¸­é…ç½®Chaos Monkeyã€‚</p>
<h4 data-id="heading-8"><code>application.properties</code></h4>
<pre><code class="hljs language-properties" lang="properties">chaos.monkey.enabled=true
chaos.monkey.assaults.level=5
chaos.monkey.assaults.latencyActive=true
chaos.monkey.assaults.latencyRangeStart=1000
chaos.monkey.assaults.latencyRangeEnd=5000
chaos.monkey.assaults.exceptionsActive=true
chaos.monkey.assaults.exceptionChance=100
</code></pre>
<h3 data-id="heading-9">5. ç¼–å†™æ•°æ®è®¿é—®å¯¹è±¡ï¼ˆDAOï¼‰</h3>
<p>ç¼–å†™ä¸€ä¸ªæ•°æ®è®¿é—®å¯¹è±¡ç±»ï¼Œç”¨äºæ‰§è¡Œæ•°æ®åº“æ“ä½œã€‚</p>
<h4 data-id="heading-10"><code>UserDAO.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.Transaction;
<span class="hljs-keyword">import</span> org.hibernate.cfg.Configuration;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserDAO</span> {
    <span class="hljs-keyword">private</span> SessionFactory sessionFactory;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserDAO</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Configuration</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>().configure(<span class="hljs-string">"hibernate.cfg.xml"</span>);
        sessionFactory = config.buildSessionFactory();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">saveUser</span><span class="hljs-params">(User user)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();
        session.save(user);
        transaction.commit();
        session.close();
    }

    <span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">findAllUsers</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        List&lt;User&gt; users = session.createQuery(<span class="hljs-string">"FROM User"</span>, User.class).list();
        session.close();
        <span class="hljs-keyword">return</span> users;
    }
}
</code></pre>
<h3 data-id="heading-11">6. ç¼–å†™æ•…éšœæ³¨å…¥æµ‹è¯•è„šæœ¬</h3>
<p>ä½¿ç”¨JUnitç¼–å†™æ•…éšœæ³¨å…¥æµ‹è¯•è„šæœ¬ï¼Œæ¨¡æ‹Ÿå„ç§æ•…éšœæƒ…å½¢ã€‚</p>
<h4 data-id="heading-12"><code>UserDAOTest.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.junit.jupiter.api.*;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.junit.jupiter.api.Assertions.*;
<span class="hljs-keyword">import</span> java.util.concurrent.*;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserDAOTest</span> {
    <span class="hljs-keyword">private</span> UserDAO userDAO;

    <span class="hljs-meta">@BeforeEach</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setUp</span><span class="hljs-params">()</span> {
        userDAO = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserDAO</span>();
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testSaveUserWithException</span><span class="hljs-params">()</span> {
        assertThrows(RuntimeException.class, () -&gt; {
            <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();
            user.setName(<span class="hljs-string">"John Doe"</span>);
            user.setEmail(<span class="hljs-string">"john.doe@example.com"</span>);
            userDAO.saveUser(user);
        });
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testFindAllUsersWithLatency</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-type">int</span> <span class="hljs-variable">numberOfThreads</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;
        <span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executorService</span> <span class="hljs-operator">=</span> Executors.newFixedThreadPool(numberOfThreads);
        <span class="hljs-type">CountDownLatch</span> <span class="hljs-variable">latch</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CountDownLatch</span>(numberOfThreads);

        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; numberOfThreads; i++) {
            executorService.submit(() -&gt; {
                <span class="hljs-keyword">try</span> {
                    List&lt;User&gt; users = userDAO.findAllUsers();
                    assertNotNull(users);
                } <span class="hljs-keyword">finally</span> {
                    latch.countDown();
                }
            });
        }

        latch.await();
        executorService.shutdown();
    }
}
</code></pre>
<h3 data-id="heading-13">7. ä½¿ç”¨Chaos Monkeyè¿›è¡Œæ•…éšœæ³¨å…¥æµ‹è¯•</h3>
<p>Chaos Monkey for Spring Bootæä¾›äº†å¤šç§æ•…éšœæ³¨å…¥æœºåˆ¶ï¼Œå¦‚å»¶è¿Ÿæ³¨å…¥ã€å¼‚å¸¸æ³¨å…¥ç­‰ã€‚é€šè¿‡é…ç½®<code>application.properties</code>æ–‡ä»¶ï¼Œå¯ä»¥å¯ç”¨è¿™äº›æ•…éšœæ³¨å…¥æœºåˆ¶ã€‚</p>
<h4 data-id="heading-14">è¿è¡Œæµ‹è¯•</h4>
<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡Œæµ‹è¯•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">./gradlew <span class="hljs-built_in">test</span>
</code></pre>
<h3 data-id="heading-15">ä¾‹å­è§£é‡Š</h3>
<ol>
<li><strong>Hibernateé…ç½®ï¼š</strong> é…ç½®ä¸€ä¸ªHibernateé…ç½®æ–‡ä»¶ï¼Œç”¨äºè¿æ¥æ•°æ®åº“ã€‚</li>
<li><strong>å®ä½“ç±»ï¼š</strong> åˆ›å»ºä¸€ä¸ªç®€å•çš„å®ä½“ç±»æ¥è¡¨ç¤ºæ•°æ®åº“è¡¨ä¸­çš„æ•°æ®ã€‚</li>
<li><strong>Gradleé…ç½®ï¼š</strong> åœ¨Gradleæ„å»ºè„šæœ¬ä¸­æ·»åŠ Hibernateå’ŒJUnitä¾èµ–ï¼Œä»¥åŠChaos Monkey for Spring Bootã€‚</li>
<li><strong>é…ç½®Chaos Monkey for Spring Bootï¼š</strong> åœ¨<code>application.properties</code>ä¸­é…ç½®Chaos Monkeyï¼Œå¯ç”¨å»¶è¿Ÿæ³¨å…¥å’Œå¼‚å¸¸æ³¨å…¥ã€‚</li>
<li><strong>æ•°æ®è®¿é—®å¯¹è±¡ï¼ˆDAOï¼‰ï¼š</strong> ç¼–å†™ä¸€ä¸ªæ•°æ®è®¿é—®å¯¹è±¡ç±»ï¼Œç”¨äºæ‰§è¡Œæ•°æ®åº“æ“ä½œã€‚</li>
<li><strong>æ•…éšœæ³¨å…¥æµ‹è¯•è„šæœ¬ï¼š</strong> ä½¿ç”¨JUnitç¼–å†™æ•…éšœæ³¨å…¥æµ‹è¯•è„šæœ¬ï¼Œæ¨¡æ‹Ÿå„ç§æ•…éšœæƒ…å½¢ã€‚é€šè¿‡æ–­è¨€æ£€æŸ¥ç³»ç»Ÿåœ¨æ•…éšœæƒ…å½¢ä¸‹çš„è¡Œä¸ºã€‚</li>
<li><strong>è¿è¡Œæµ‹è¯•ï¼š</strong> ä½¿ç”¨Gradleå‘½ä»¤è¿è¡Œæµ‹è¯•ï¼Œå¹¶è§‚å¯Ÿæµ‹è¯•ç»“æœã€‚</li>
</ol>
<p>é€šè¿‡ä»¥ä¸Šé…ç½®å’Œä»£ç ç¤ºä¾‹ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•åœ¨æ•…éšœæ³¨å…¥æµ‹è¯•ä¸­ä½¿ç”¨Hibernateã€‚è¿™åŒ…æ‹¬é…ç½®Hibernateã€å®šä¹‰å®ä½“ç±»ã€ç¼–å†™æ•°æ®è®¿é—®å¯¹è±¡ã€é…ç½®Chaos Monkeyã€ç¼–å†™æ•…éšœæ³¨å…¥æµ‹è¯•è„šæœ¬ï¼Œä»¥åŠè¿è¡Œæµ‹è¯•ã€‚æ­¤æµç¨‹å¸®åŠ©è¯†åˆ«å’Œè§£å†³ç³»ç»Ÿåœ¨å„ç§æ•…éšœæƒ…å½¢ä¸‹çš„æ€§èƒ½ç“¶é¢ˆå’Œæ¢å¤èƒ½åŠ›ï¼Œç¡®ä¿åœ¨å®é™…ä½¿ç”¨ç¯å¢ƒä¸­ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¯å‘¨AIè®ºæ–‡é€Ÿé€’ï¼ˆ260202-260206ï¼‰]]></title>    <link>https://juejin.cn/post/7603595309233487882</link>    <guid>https://juejin.cn/post/7603595309233487882</guid>    <pubDate>2026-02-07T14:01:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603595309233487882" data-draft-id="7603653885602578482" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¯å‘¨AIè®ºæ–‡é€Ÿé€’ï¼ˆ260202-260206ï¼‰"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-02-07T14:01:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¶å­çš„æŠ€æœ¯ç¢ç¢å¿µ"/> <meta itemprop="url" content="https://juejin.cn/user/2831954919569245"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¯å‘¨AIè®ºæ–‡é€Ÿé€’ï¼ˆ260202-260206ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2831954919569245/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¶å­çš„æŠ€æœ¯ç¢ç¢å¿µ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T14:01:39.000Z" title="Sat Feb 07 2026 14:01:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»34åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ERNIE 5.0 Technical Report</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2602.04705" target="_blank" title="https://arxiv.org/abs/2602.04705" ref="nofollow noopener noreferrer">ERNIE 5.0 æŠ€æœ¯æŠ¥å‘Š</a></p>
<p>æœ¬æŠ¥å‘Šä»‹ç»äº† ERNIE 5.0ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸç”Ÿè‡ªå›å½’çš„åŸºç¡€æ¨¡å‹ï¼Œä¸“ä¸ºè·¨æ–‡æœ¬ã€å›¾åƒã€è§†é¢‘å’ŒéŸ³é¢‘çš„ç»Ÿä¸€å¤šæ¨¡æ€ç†è§£ä¸ç”Ÿæˆè€Œè®¾è®¡ã€‚æ‰€æœ‰æ¨¡æ€å‡åŸºäºä¸€ä¸ªé‡‡ç”¨æ¨¡æ€æ— å…³ä¸“å®¶è·¯ç”±çš„è¶…ç¨€ç–ä¸“å®¶æ··åˆ (Mixture-of-Experts, MoE) æ¶æ„ï¼Œåœ¨ç»Ÿä¸€çš„ä¸‹ä¸€ä»¤ç‰Œç»„é¢„æµ‹ç›®æ ‡ä¸‹ä»å¤´å¼€å§‹è®­ç»ƒã€‚ä¸ºåº”å¯¹å¤šæ ·åŒ–èµ„æºçº¦æŸä¸‹å¤§è§„æ¨¡éƒ¨ç½²çš„å®é™…æŒ‘æˆ˜ï¼ŒERNIE 5.0 é‡‡ç”¨äº†ä¸€ç§æ–°é¢–çš„å¼¹æ€§è®­ç»ƒèŒƒå¼ã€‚åœ¨å•æ¬¡é¢„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹å­¦ä¹ äº†ä¸€ç³»åˆ—å…·æœ‰ä¸åŒæ·±åº¦ã€ä¸“å®¶å®¹é‡å’Œè·¯ç”±ç¨€ç–åº¦çš„å­æ¨¡å‹ï¼Œä»è€Œèƒ½å¤Ÿåœ¨å†…å­˜æˆ–æ—¶é—´å—é™çš„åœºæ™¯ä¸­ï¼Œçµæ´»æƒè¡¡æ€§èƒ½ã€æ¨¡å‹å¤§å°ä¸æ¨ç†å»¶è¿Ÿã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ç³»ç»Ÿæ€§åœ°è§£å†³äº†å°†å¼ºåŒ–å­¦ä¹ æ‰©å±•è‡³ç»Ÿä¸€åŸºç¡€æ¨¡å‹æ‰€é¢ä¸´çš„æŒ‘æˆ˜ï¼Œä»è€Œç¡®ä¿äº†åœ¨è¶…ç¨€ç– MoE æ¶æ„åŠå¤šæ ·åŒ–å¤šæ¨¡æ€è®¾ç½®ä¸‹é«˜æ•ˆä¸”ç¨³å®šçš„åè®­ç»ƒã€‚å¤§é‡å®éªŒè¡¨æ˜ï¼ŒERNIE 5.0 åœ¨å¤šç§æ¨¡æ€ä¸Šå‡å–å¾—äº†å¼ºå¤§ä¸”å‡è¡¡çš„æ€§èƒ½ã€‚æ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œåœ¨å·²å…¬å¼€çš„æ¨¡å‹ä¸­ï¼ŒERNIE 5.0 æ˜¯é¦–ä¸ªå®ç°ç”Ÿäº§çº§éƒ¨ç½²çš„ã€æ”¯æŒå¤šæ¨¡æ€ç†è§£ä¸ç”Ÿæˆçš„ä¸‡äº¿å‚æ•°ç»Ÿä¸€è‡ªå›å½’æ¨¡å‹ã€‚ä¸ºä¿ƒè¿›åç»­ç ”ç©¶ï¼Œæˆ‘ä»¬è¯¦ç»†å¯è§†åŒ–äº†ç»Ÿä¸€æ¨¡å‹ä¸­çš„æ¨¡æ€æ— å…³ä¸“å®¶è·¯ç”±ï¼Œå¹¶å¯¹å¼¹æ€§è®­ç»ƒè¿›è¡Œäº†å…¨é¢çš„å®è¯åˆ†æï¼Œæ—¨åœ¨ä¸ºå­¦ç•Œå’Œä¸šç•Œæä¾›æ·±å…¥æ´å¯Ÿã€‚</p>
<h2 data-id="heading-1">Green-VLA: Staged Vision-Language-Action Model for Generalist Robots</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2602.00919" target="_blank" title="https://arxiv.org/abs/2602.00919" ref="nofollow noopener noreferrer">Green-VLAï¼šé¢å‘é€šç”¨æœºå™¨äººçš„åˆ†é˜¶æ®µè§†è§‰-è¯­è¨€-åŠ¨ä½œæ¨¡å‹</a></p>
<p>æˆ‘ä»¬æå‡ºäº† Green-VLAï¼Œè¿™æ˜¯ä¸€ä¸ªåˆ†é˜¶æ®µçš„è§†è§‰-è¯­è¨€-åŠ¨ä½œ (VLA) æ¡†æ¶ï¼Œæ—¨åœ¨ Green äººå½¢æœºå™¨äººä¸Šè¿›è¡Œå®é™…éƒ¨ç½²ï¼ŒåŒæ—¶ä¿æŒå¯¹ä¸åŒæœºå™¨äººå¹³å° (embodiment) çš„æ³›åŒ–èƒ½åŠ›ã€‚Green-VLA éµå¾ªä¸€ä¸ªäº”é˜¶æ®µçš„è®­ç»ƒæ–¹æ¡ˆï¼š(L0) åŸºç¡€è§†è§‰è¯­è¨€æ¨¡å‹ (VLM)ï¼Œ(L1) å¤šæ¨¡æ€å…³è” (grounding)ï¼Œ(R0) å¤šå¹³å°é¢„è®­ç»ƒï¼Œ(R1) ç‰¹å®šå¹³å°é€‚åº”ï¼Œä»¥åŠ (R2) å¼ºåŒ–å­¦ä¹  (RL) ç­–ç•¥å¯¹é½ã€‚æˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªå¯æ‰©å±•çš„æ•°æ®å¤„ç†æµæ°´çº¿ (åŒ…å« 3000 å°æ—¶çš„æ¼”ç¤ºæ•°æ®)ï¼Œå¹¶è¿›è¡Œäº†æ—¶é—´å¯¹é½å’Œè´¨é‡è¿‡æ»¤ï¼›åŒæ—¶é‡‡ç”¨äº†ä¸€ä¸ªç»Ÿä¸€çš„ã€æ„ŸçŸ¥å¹³å°ä¿¡æ¯çš„åŠ¨ä½œæ¥å£ï¼Œä½¿å¾—å•ä¸€ç­–ç•¥èƒ½å¤Ÿæ§åˆ¶äººå½¢æœºå™¨äººã€ç§»åŠ¨æœºæ¢°è‡‚å’Œå›ºå®šåŸºåº§æœºæ¢°è‡‚ã€‚åœ¨æ¨ç†é˜¶æ®µï¼Œè¯¥ VLA æ§åˆ¶å™¨é€šè¿‡é›†æˆæƒ…èŠ‚è¿›åº¦é¢„æµ‹ã€åˆ†å¸ƒå¤– (OOD) æ£€æµ‹ä»¥åŠåŸºäºè”åˆé¢„æµ‹çš„å¼•å¯¼æœºåˆ¶æ¥å¢å¼ºï¼Œä»è€Œæå‡å®‰å…¨æ€§å’Œç›®æ ‡é€‰æ‹©çš„ç²¾ç¡®æ€§ã€‚åœ¨ Simpler BRIDGE WidowX å’Œ CALVIN ABC-D ä»¿çœŸç¯å¢ƒä¸­çš„å®éªŒï¼Œä»¥åŠçœŸå®æœºå™¨äººè¯„ä¼°ç»“æœè¡¨æ˜ï¼ŒRL å¯¹é½æ˜¾è‘—æå‡äº†æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›å’Œæ€§èƒ½ï¼Œå…·ä½“ä½“ç°åœ¨æˆåŠŸç‡ã€é²æ£’æ€§å’Œé•¿ç¨‹ä»»åŠ¡æ•ˆç‡ä¸Šã€‚</p>
<h2 data-id="heading-2">Kimi K2.5: Visual Agentic Intelligence</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2602.02276" target="_blank" title="https://arxiv.org/abs/2602.02276" ref="nofollow noopener noreferrer">Kimi K2.5ï¼šè§†è§‰æ™ºèƒ½ä½“æ™ºèƒ½</a></p>
<p>æˆ‘ä»¬ä»‹ç» Kimi K2.5ï¼Œä¸€ä¸ªæ—¨åœ¨æå‡é€šç”¨æ™ºèƒ½ä½“æ™ºèƒ½ (General Agentic Intelligence) çš„å¼€æºå¤šæ¨¡æ€æ™ºèƒ½ä½“æ¨¡å‹ã€‚K2.5 å¼ºè°ƒæ–‡æœ¬ä¸è§†è§‰çš„è”åˆä¼˜åŒ–ï¼Œä½¿ä¸¤ç§æ¨¡æ€èƒ½å¤Ÿç›¸äº’å¢å¼ºã€‚è¿™åŒ…æ‹¬ä¸€ç³»åˆ—æŠ€æœ¯ï¼Œä¾‹å¦‚è”åˆæ–‡æœ¬-è§†è§‰é¢„è®­ç»ƒã€é›¶è§†è§‰ç›‘ç£å¾®è°ƒ (Zero-vision SFT) ä»¥åŠè”åˆæ–‡æœ¬-è§†è§‰å¼ºåŒ–å­¦ä¹ ã€‚åœ¨æ­¤å¤šæ¨¡æ€åŸºç¡€ä¹‹ä¸Šï¼ŒK2.5 å¼•å…¥äº†æ™ºèƒ½ä½“é›†ç¾¤ (Agent Swarm)ï¼Œè¿™æ˜¯ä¸€ä¸ªè‡ªä¸»çš„å¹¶è¡Œæ™ºèƒ½ä½“ç¼–æ’æ¡†æ¶ï¼Œèƒ½å¤ŸåŠ¨æ€åœ°å°†å¤æ‚ä»»åŠ¡åˆ†è§£ä¸ºå¼‚æ„çš„å­é—®é¢˜å¹¶è¿›è¡Œå¹¶å‘æ‰§è¡Œã€‚å¤§é‡è¯„ä¼°è¡¨æ˜ï¼ŒKimi K2.5 åœ¨ç¼–ç ã€è§†è§‰ã€æ¨ç†åŠæ™ºèƒ½ä½“ä»»åŠ¡ç­‰å¤šä¸ªé¢†åŸŸå‡å–å¾—äº†æœ€å…ˆè¿›çš„æ€§èƒ½ã€‚ç›¸æ¯”å•æ™ºèƒ½ä½“åŸºçº¿ï¼Œæ™ºèƒ½ä½“é›†ç¾¤å°†å»¶è¿Ÿæœ€é«˜é™ä½äº† <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4.5</mn></mrow><annotation encoding="application/x-tex">4.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">4.5</span></span></span></span></span> å€ã€‚æˆ‘ä»¬å‘å¸ƒäº†ç»è¿‡åè®­ç»ƒçš„ Kimi K2.5 æ¨¡å‹æ£€æŸ¥ç‚¹ï¼Œä»¥ä¿ƒè¿›æ™ºèƒ½ä½“æ™ºèƒ½çš„æœªæ¥ç ”ç©¶åŠå®é™…åº”ç”¨ã€‚</p>
<h2 data-id="heading-3">Vision-DeepResearch: Incentivizing DeepResearch Capability in Multimodal Large Language Models</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.22060" target="_blank" title="https://arxiv.org/abs/2601.22060" ref="nofollow noopener noreferrer">Vision-DeepResearchï¼šæ¿€å‘å¤šæ¨¡æ€å¤§è¯­è¨€æ¨¡å‹çš„æ·±åº¦ç ”ç©¶èƒ½åŠ›</a></p>
<p>å¤šæ¨¡æ€å¤§è¯­è¨€æ¨¡å‹ (MLLMs) å·²åœ¨å¹¿æ³›çš„è§†è§‰ä»»åŠ¡ä¸­å–å¾—æ˜¾è‘—æˆåŠŸã€‚ç„¶è€Œï¼Œå—é™äºå…¶å†…éƒ¨ä¸–ç•ŒçŸ¥è¯†å‚¨å¤‡ï¼Œå…ˆå‰ç ”ç©¶æå‡ºé€šè¿‡â€œå…ˆæ¨ç†åå·¥å…·è°ƒç”¨â€çš„ç­–ç•¥æ¥å¢å¼º MLLMsï¼Œå³å€ŸåŠ©è§†è§‰ä¸æ–‡æœ¬æœç´¢å¼•æ“ï¼Œä»è€Œåœ¨éœ€è¦å¤§é‡äº‹å®ä¿¡æ¯çš„ä»»åŠ¡ä¸Šè·å¾—æ˜¾è‘—æå‡ã€‚ç„¶è€Œï¼Œè¿™äº›æ–¹æ³•é€šå¸¸åŸºäºä¸€ç§ç®€åŒ–çš„å¤šæ¨¡æ€æœç´¢è®¾å®šï¼Œå³å‡è®¾ä»…å‡­ä¸€ä¸ªå…¨å›¾çº§æˆ–å®ä½“çº§çš„å›¾åƒæŸ¥è¯¢åŠå°‘é‡æ–‡æœ¬æŸ¥è¯¢ï¼Œä¾¿è¶³ä»¥æ£€ç´¢åˆ°å›ç­”é—®é¢˜æ‰€éœ€çš„å…³é”®è¯æ®ã€‚è¿™åœ¨è§†è§‰å™ªå£°ä¸¥é‡çš„å®é™…åœºæ™¯ä¸­å¹¶ä¸ç°å®ã€‚æ­¤å¤–ï¼Œå®ƒä»¬åœ¨æ¨ç†æ·±åº¦å’Œæœç´¢å¹¿åº¦ä¸Šä¹Ÿå¾€å¾€å—é™ï¼Œéš¾ä»¥è§£å†³é‚£äº›éœ€è¦èšåˆæ¥è‡ªå¤šæ ·è§†è§‰ä¸æ–‡æœ¬æºè¯æ®çš„å¤æ‚é—®é¢˜ã€‚åŸºäºæ­¤ï¼Œæˆ‘ä»¬æå‡ºäº† Vision-DeepResearchï¼Œå®ƒå¼•å…¥äº†ä¸€ç§æ–°çš„å¤šæ¨¡æ€æ·±åº¦ç ”ç©¶èŒƒå¼ï¼Œèƒ½å¤Ÿæ‰§è¡Œå¤šè½®æ¬¡ã€å¤šå®ä½“ã€å¤šå°ºåº¦çš„è§†è§‰ä¸æ–‡æœ¬æœç´¢ï¼Œä»è€Œåœ¨å¼ºå™ªå£°ç¯å¢ƒä¸‹ç¨³å®šã€æœ‰æ•ˆåœ°åˆ©ç”¨ç°å®ä¸–ç•Œçš„æœç´¢å¼•æ“ã€‚æˆ‘ä»¬çš„ Vision-DeepResearch æ”¯æŒæ•°åæ­¥æ¨ç†å’Œæ•°ç™¾æ¬¡æœç´¢å¼•æ“äº¤äº’ï¼Œå¹¶é€šè¿‡å†·å¯åŠ¨ç›‘ç£å’Œå¼ºåŒ–å­¦ä¹  (RL) è®­ç»ƒï¼Œå°†æ·±åº¦ç ”ç©¶èƒ½åŠ›å†…åŒ–äº MLLM ä¹‹ä¸­ï¼Œæœ€ç»ˆæ„å»ºå‡ºä¸€ä¸ªå¼ºå¤§çš„ç«¯åˆ°ç«¯å¤šæ¨¡æ€æ·±åº¦ç ”ç©¶ MLLMã€‚å…¶æ€§èƒ½å¤§å¹…è¶…è¶Šäº†ç°æœ‰çš„å¤šæ¨¡æ€æ·±åº¦ç ”ç©¶ MLLMsï¼Œä»¥åŠåŸºäº GPT-5ã€Gemini-2.5-pro å’Œ Claude-4-Sonnet ç­‰å¼ºå¤§é—­æºåŸºç¡€æ¨¡å‹æ„å»ºçš„å·¥ä½œæµã€‚ä»£ç å°†åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FOsilly%2FVision-DeepResearch" target="_blank" title="https://github.com/Osilly/Vision-DeepResearch" ref="nofollow noopener noreferrer">github.com/Osilly/Visiâ€¦</a> å‘å¸ƒã€‚</p>
<h2 data-id="heading-4">PaperBanana: Automating Academic Illustration for AI Scientists</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.23265" target="_blank" title="https://arxiv.org/abs/2601.23265" ref="nofollow noopener noreferrer">PaperBananaï¼šä¸º AI ç§‘å­¦å®¶è‡ªåŠ¨åŒ–ç”Ÿæˆå­¦æœ¯æ’å›¾</a></p>
<p>å°½ç®¡ç”±è¯­è¨€æ¨¡å‹é©±åŠ¨çš„è‡ªä¸» AI ç§‘å­¦å®¶å‘å±•è¿…é€Ÿï¼Œä½†åœ¨ç ”ç©¶æµç¨‹ä¸­ï¼Œç”Ÿæˆå¯ç›´æ¥ç”¨äºå‘è¡¨çš„æ’å›¾ä»ç„¶æ˜¯ä¸€ä¸ªåŠ³åŠ¨å¯†é›†å‹çš„ç“¶é¢ˆã€‚ä¸ºäº†å‡è½»è¿™ä¸€è´Ÿæ‹…ï¼Œæˆ‘ä»¬æå‡ºäº† PaperBananaï¼Œä¸€ä¸ªç”¨äºè‡ªåŠ¨ç”Ÿæˆè¾¾åˆ°å‘è¡¨æ ‡å‡†çš„å­¦æœ¯æ’å›¾çš„æ™ºèƒ½ä½“æ¡†æ¶ã€‚è¯¥æ¡†æ¶ä¾æ‰˜æœ€å…ˆè¿›çš„è§†è§‰è¯­è¨€æ¨¡å‹å’Œå›¾åƒç”Ÿæˆæ¨¡å‹ï¼Œé€šè¿‡ç¼–æ’å¤šä¸ªä¸“ç”¨æ™ºèƒ½ä½“æ¥æ‰§è¡Œå‚è€ƒæ–‡çŒ®æ£€ç´¢ã€å†…å®¹ä¸é£æ ¼è§„åˆ’ã€å›¾åƒæ¸²æŸ“ç­‰ä»»åŠ¡ï¼Œå¹¶åŸºäºè‡ªæˆ‘åé¦ˆè¿›è¡Œè¿­ä»£ä¼˜åŒ–ã€‚ä¸ºäº†ä¸¥æ ¼è¯„ä¼°è¯¥æ¡†æ¶ï¼Œæˆ‘ä»¬æ„å»ºäº† PaperBananaBench åŸºå‡†æµ‹è¯•é›†ï¼Œå…¶ä¸­åŒ…å« 292 ä¸ªä» NeurIPS 2025 å‡ºç‰ˆç‰©ä¸­ç²¾é€‰çš„æ–¹æ³•å›¾æµ‹è¯•ç”¨ä¾‹ï¼Œæ¶µç›–äº†ä¸åŒçš„ç ”ç©¶é¢†åŸŸå’Œæ’å›¾é£æ ¼ã€‚å…¨é¢çš„å®éªŒè¡¨æ˜ï¼ŒPaperBanana åœ¨å¿ å®åº¦ã€ç®€æ´æ€§ã€å¯è¯»æ€§å’Œç¾è§‚æ€§æ–¹é¢å‡æŒç»­ä¼˜äºä¸»æµåŸºçº¿æ–¹æ³•ã€‚æˆ‘ä»¬è¿˜å±•ç¤ºäº†è¯¥æ–¹æ³•èƒ½æœ‰æ•ˆæ‰©å±•åˆ°é«˜è´¨é‡ç»Ÿè®¡å›¾çš„ç”Ÿæˆã€‚ç»¼ä¸Šæ‰€è¿°ï¼ŒPaperBanana ä¸ºå®ç°å¯ç›´æ¥ç”¨äºå‘è¡¨çš„æ’å›¾çš„è‡ªåŠ¨åŒ–ç”Ÿæˆé“ºå¹³äº†é“è·¯ã€‚</p>
<h2 data-id="heading-5">Vision-DeepResearch Benchmark: Rethinking Visual and Textual Search for Multimodal Large Language Models</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2602.02185" target="_blank" title="https://arxiv.org/abs/2602.02185" ref="nofollow noopener noreferrer">Vision-DeepResearch åŸºå‡†æµ‹è¯•ï¼šé‡æ–°æ€è€ƒå¤šæ¨¡æ€å¤§è¯­è¨€æ¨¡å‹çš„è§†è§‰ä¸æ–‡æœ¬æœç´¢</a></p>
<p>å¤šæ¨¡æ€å¤§è¯­è¨€æ¨¡å‹ (MLLMs) æ¨åŠ¨äº†è§†è§‰é—®ç­” (VQA) çš„è¿›æ­¥ï¼Œç°å·²èƒ½å¤Ÿæ”¯æŒåˆ©ç”¨æœç´¢å¼•æ“è¿›è¡Œå¤æ‚è§†è§‰-æ–‡æœ¬äº‹å®æŸ¥æ‰¾çš„ Vision-DeepResearch ç³»ç»Ÿã€‚ç„¶è€Œï¼Œè¯„ä¼°è¿™äº›è§†è§‰ä¸æ–‡æœ¬æœç´¢èƒ½åŠ›ä»ç„¶é¢ä¸´æŒ‘æˆ˜ï¼Œç°æœ‰åŸºå‡†æµ‹è¯•å­˜åœ¨ä¸¤å¤§ä¸»è¦å±€é™ã€‚é¦–å…ˆï¼Œç°æœ‰åŸºå‡†å¹¶éä»¥è§†è§‰æœç´¢ä¸ºæ ¸å¿ƒï¼šé‚£äº›æœ¬åº”ä¾èµ–è§†è§‰æœç´¢æ‰èƒ½å¾—å‡ºçš„ç­”æ¡ˆï¼Œå¸¸å¸¸é€šè¿‡æ–‡æœ¬é—®é¢˜ä¸­çš„è·¨æ–‡æœ¬çº¿ç´¢æ³„éœ²ï¼Œæˆ–è€…å¯ä»¥åˆ©ç”¨å½“å‰ MLLMs å·²æœ‰çš„ä¸–ç•ŒçŸ¥è¯†æ¨æ–­å‡ºæ¥ã€‚å…¶æ¬¡ï¼Œè¯„ä¼°åœºæ™¯è¿‡äºç†æƒ³åŒ–ï¼šåœ¨å›¾åƒæœç´¢æ–¹é¢ï¼Œæ‰€éœ€ä¿¡æ¯å¾€å¾€å¯ä»¥é€šè¿‡ä¸å®Œæ•´å›¾åƒè¿›è¡Œè¿‘ä¹ç²¾ç¡®çš„åŒ¹é…è·å¾—ï¼›è€Œåœ¨æ–‡æœ¬æœç´¢æ–¹é¢ï¼Œé—®é¢˜åˆ™è¿‡äºç›´æ¥ï¼Œç¼ºä¹è¶³å¤Ÿçš„æŒ‘æˆ˜æ€§ã€‚ä¸ºè§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æ„å»ºäº† Vision-DeepResearch åŸºå‡†æµ‹è¯• (VDR-Bench)ï¼ŒåŒ…å« 2,000 ä¸ª VQA å®ä¾‹ã€‚æ‰€æœ‰é—®é¢˜å‡é€šè¿‡ä¸€ä¸ªç²¾å¿ƒè®¾è®¡çš„å¤šé˜¶æ®µç­›é€‰æµç¨‹å’Œä¸¥æ ¼çš„ä¸“å®¶è¯„å®¡åˆ›å»ºï¼Œæ—¨åœ¨è¯„ä¼° Vision-DeepResearch ç³»ç»Ÿåœ¨çœŸå®ä¸–ç•Œæ¡ä»¶ä¸‹çš„è¡¨ç°ã€‚æ­¤å¤–ï¼Œé’ˆå¯¹å½“å‰ MLLMs è§†è§‰æ£€ç´¢èƒ½åŠ›ä¸è¶³çš„é—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§ç®€å•çš„å¤šè½®è£å‰ªæœç´¢å·¥ä½œæµç¨‹ã€‚è¯¥ç­–ç•¥ç»è¯æ˜å¯æœ‰æ•ˆæå‡æ¨¡å‹åœ¨çœŸå®è§†è§‰æ£€ç´¢åœºæ™¯ä¸­çš„æ€§èƒ½ã€‚æ€»ä½“è€Œè¨€ï¼Œæˆ‘ä»¬çš„ç ”ç©¶ç»“æœä¸ºæœªæ¥å¤šæ¨¡æ€æ·±åº¦ç ”ç©¶ç³»ç»Ÿçš„è®¾è®¡æä¾›äº†å®ç”¨æŒ‡å¯¼ã€‚ä»£ç å°†åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FOsilly%2FVision-DeepResearch" target="_blank" title="https://github.com/Osilly/Vision-DeepResearch" ref="nofollow noopener noreferrer">github.com/Osilly/Visiâ€¦</a> å‘å¸ƒã€‚</p>
<h2 data-id="heading-6">FASA: Frequency-aware Sparse Attention</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2602.03152" target="_blank" title="https://arxiv.org/abs/2602.03152" ref="nofollow noopener noreferrer">FASA: é¢‘ç‡æ„ŸçŸ¥ç¨€ç–æ³¨æ„åŠ›</a></p>
<p>å¤§è¯­è¨€æ¨¡å‹ (LLMs) åœ¨å¤„ç†é•¿è¾“å…¥æ—¶é¢ä¸´ä¸€ä¸ªå…³é”®ç“¶é¢ˆï¼šé”®å€¼ (Key-Value, KV) ç¼“å­˜çš„å·¨å¤§å†…å­˜å ç”¨ã€‚ä¸ºäº†è§£å†³è¿™ä¸€ç“¶é¢ˆï¼ŒToken å‰ªæèŒƒå¼åˆ©ç”¨æ³¨æ„åŠ›æœºåˆ¶çš„ç¨€ç–æ€§ï¼Œæœ‰é€‰æ‹©åœ°ä¿ç•™ä¸€å°éƒ¨åˆ†å…³é”®çš„ Tokenã€‚ç„¶è€Œï¼Œç°æœ‰æ–¹æ³•å­˜åœ¨ä¸è¶³ï¼šé™æ€æ–¹æ³•å­˜åœ¨ä¸å¯é€†ä¿¡æ¯ä¸¢å¤±çš„é£é™©ï¼Œè€ŒåŠ¨æ€ç­–ç•¥æ‰€é‡‡ç”¨çš„å¯å‘å¼æ–¹æ³•ï¼Œåˆä¸è¶³ä»¥æ•æ‰ Token é‡è¦æ€§å¯¹æŸ¥è¯¢çš„ä¾èµ–æ€§ã€‚æˆ‘ä»¬æå‡ºäº† FASAï¼Œè¿™æ˜¯ä¸€ä¸ªé€šè¿‡åŠ¨æ€é¢„æµ‹ Token é‡è¦æ€§æ¥å®ç°æŸ¥è¯¢æ„ŸçŸ¥ Token æ·˜æ±°çš„æ–°æ¡†æ¶ã€‚FASA æºäºå¯¹ RoPE çš„ä¸€ä¸ªæ–°é¢–æ´å¯Ÿï¼šåœ¨é¢‘ç‡å— (Frequency-Chunk, FC) çº§åˆ«å‘ç°äº†åŠŸèƒ½æ€§çš„ç¨€ç–ç‰¹å¾ã€‚æˆ‘ä»¬çš„æ ¸å¿ƒå‘ç°æ˜¯ï¼Œä¸€å°éƒ¨åˆ†å¯è¯†åˆ«çš„â€œä¸»å¯¼â€FCsï¼Œå…¶ä¸Šä¸‹æ–‡ä¿¡æ¯å§‹ç»ˆä¸å®Œæ•´æ³¨æ„åŠ›å¤´ä¿æŒé«˜åº¦ä¸€è‡´ã€‚è¿™ä¸ºè¯†åˆ«æ˜¾è‘— Token æä¾›äº†ä¸€ä¸ªé²æ£’ä¸”æ— éœ€é¢å¤–è®¡ç®—æˆæœ¬çš„ä»£ç†æŒ‡æ ‡ã€‚åŸºäºè¿™ä¸€æ´å¯Ÿï¼ŒFASA é¦–å…ˆåˆ©ç”¨ä¸»å¯¼ FCs è¯†åˆ«å‡ºä¸€ç»„å…³é”® Tokenï¼Œç„¶åä»…åœ¨è¿™ä¸ªå‰ªæåçš„å­é›†ä¸Šæ‰§è¡Œé›†ä¸­çš„æ³¨æ„åŠ›è®¡ç®—ã€‚åœ¨ä¸€ç³»åˆ—é•¿ä¸Šä¸‹æ–‡ä»»åŠ¡ä¸­ï¼Œä»åºåˆ—å»ºæ¨¡åˆ°å¤æ‚çš„æ€ç»´é“¾ (CoT) æ¨ç†ï¼ŒFASA çš„æ€§èƒ½å§‹ç»ˆä¼˜äºæ‰€æœ‰ Token æ·˜æ±°åŸºçº¿ï¼Œå¹¶è¾¾åˆ°äº†æ¥è¿‘ Oracle çš„å‡†ç¡®åº¦ï¼Œå³ä½¿åœ¨æœ‰é™çš„ç¼“å­˜é¢„ç®—ä¸‹ä¹Ÿè¡¨ç°å‡ºæ˜¾è‘—çš„é²æ£’æ€§ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ LongBench-V1 åŸºå‡†æµ‹è¯•ä¸Šï¼Œå½“ä»…ä¿ç•™ 256 ä¸ª Token æ—¶ï¼ŒFASA è¾¾åˆ°äº†æ¥è¿‘ 100% çš„å®Œæ•´ KV ç¼“å­˜æ€§èƒ½ï¼›åœ¨ AIME24 ä¸Šï¼Œä»…ä½¿ç”¨ 18.9% çš„ç¼“å­˜å°±å®ç°äº† 2.56 å€çš„åŠ é€Ÿã€‚</p>
<h2 data-id="heading-7">CodeOCR: On the Effectiveness of Vision Language Models in Code Understanding</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2602.01785" target="_blank" title="https://arxiv.org/abs/2602.01785" ref="nofollow noopener noreferrer">CodeOCRï¼šæ¢ç©¶è§†è§‰è¯­è¨€æ¨¡å‹åœ¨ä»£ç ç†è§£ä¸­çš„æœ‰æ•ˆæ€§</a></p>
<p>å¤§è¯­è¨€æ¨¡å‹ (LLMs) åœ¨æºä»£ç ç†è§£æ–¹é¢å·²å–å¾—å·¨å¤§æˆåŠŸï¼Œä½†éšç€è½¯ä»¶ç³»ç»Ÿè§„æ¨¡çš„æ‰©å¤§ï¼Œè®¡ç®—æ•ˆç‡å·²æˆä¸ºå…³é”®ç“¶é¢ˆã€‚ç›®å‰ï¼Œè¿™äº›æ¨¡å‹ä¾èµ–äºåŸºäºæ–‡æœ¬çš„èŒƒå¼ï¼Œå°†æºä»£ç è§†ä¸ºçº¿æ€§ Token åºåˆ—ï¼Œè¿™å¯¼è‡´ä¸Šä¸‹æ–‡é•¿åº¦åŠç›¸åº”çš„è®¡ç®—æˆæœ¬çº¿æ€§å¢é•¿ã€‚å¤šæ¨¡æ€å¤§è¯­è¨€æ¨¡å‹ (MLLMs) çš„å¿«é€Ÿå‘å±•ï¼Œå¸¦æ¥äº†é€šè¿‡å°†æºä»£ç è¡¨ç¤ºä¸ºæ¸²æŸ“å›¾åƒæ¥ä¼˜åŒ–æ•ˆç‡çš„æœºä¼šã€‚ä¸éš¾ä»¥æ— æŸå‹ç¼©çš„æ–‡æœ¬ä¸åŒï¼Œå›¾åƒæ¨¡æ€å¤©ç”Ÿé€‚åˆå‹ç¼©ã€‚é€šè¿‡è°ƒæ•´åˆ†è¾¨ç‡ï¼Œå›¾åƒå¯ä»¥ä»¥è¿œä½äºåŸå§‹ Token æˆæœ¬çš„å¤§å°è¡¨ç¤ºï¼ŒåŒæ—¶ä»èƒ½è¢«å…·å¤‡è§†è§‰èƒ½åŠ›çš„æ¨¡å‹è¯†åˆ«ã€‚ä¸ºæ¢ç´¢è¯¥æ–¹æ³•çš„å¯è¡Œæ€§ï¼Œæˆ‘ä»¬é¦–æ¬¡ç³»ç»Ÿæ€§æ¢ç©¶äº† MLLMs åœ¨ä»£ç ç†è§£ä¸­çš„æœ‰æ•ˆæ€§ã€‚æˆ‘ä»¬çš„å®éªŒå‘ç°ï¼š(1) MLLMs èƒ½åœ¨æ˜¾è‘—å‡å°‘ Token çš„æƒ…å†µä¸‹æœ‰æ•ˆç†è§£ä»£ç ï¼Œå®ç°é«˜è¾¾ 8 å€çš„å‹ç¼©ç‡ï¼›(2) MLLMs èƒ½æœ‰æ•ˆåˆ©ç”¨è¯­æ³•é«˜äº®ç­‰è§†è§‰çº¿ç´¢ï¼Œåœ¨ 4 å€å‹ç¼©ä¸‹æå‡ä»£ç è¡¥å…¨æ€§èƒ½ï¼›(3) å…‹éš†æ£€æµ‹ç­‰ä»£ç ç†è§£ä»»åŠ¡å¯¹è§†è§‰å‹ç¼©è¡¨ç°å‡ºæå¼ºçš„é²æ£’æ€§ï¼Œåœ¨æŸäº›å‹ç¼©ç‡ä¸‹ï¼Œå…¶æ€§èƒ½ç”šè‡³ç•¥ä¼˜äºåŸå§‹æ–‡æœ¬è¾“å…¥ã€‚æˆ‘ä»¬çš„ç ”ç©¶ç»“æœæ—¢çªæ˜¾äº† MLLMs åœ¨ä»£ç ç†è§£ä¸­çš„æ½œåŠ›ï¼Œä¹Ÿæ­ç¤ºäº†å…¶å½“å‰å±€é™ï¼Œè¿™æŒ‡æ˜äº†å‘å›¾åƒæ¨¡æ€ä»£ç è¡¨ç¤ºè½¬å˜ï¼Œæ˜¯å®ç°æ›´é«˜æ•ˆæ¨ç†çš„ä¸€æ¡è·¯å¾„ã€‚</p>
<h2 data-id="heading-8">WideSeek-R1: Exploring Width Scaling for Broad Information Seeking via Multi-Agent Reinforcement Learning</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2602.04634" target="_blank" title="https://arxiv.org/abs/2602.04634" ref="nofollow noopener noreferrer">WideSeek-R1: é€šè¿‡å¤šæ™ºèƒ½ä½“å¼ºåŒ–å­¦ä¹ æ¢ç´¢å¹¿æ³›ä¿¡æ¯æœç´¢çš„å®½åº¦æ‰©å±•</a></p>
<p>è¿‘æœŸå¤§è¯­è¨€æ¨¡å‹ (LLMs) çš„è¿›å±•ä¸»è¦é›†ä¸­äºæ·±åº¦æ‰©å±•ï¼Œå³å•ä¸ªæ™ºèƒ½ä½“é€šè¿‡å¤šè½®æ¨ç†å’Œå·¥å…·ä½¿ç”¨æ¥è§£å†³é•¿ç¨‹é—®é¢˜ã€‚ç„¶è€Œï¼Œéšç€ä»»åŠ¡èŒƒå›´å˜å¹¿ï¼Œå…³é”®ç“¶é¢ˆä»ä¸ªä½“èƒ½åŠ›è½¬å‘äº†ååŒç»„ç»‡èƒ½åŠ›ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æ¢ç´¢äº†å®½åº¦æ‰©å±•è¿™ä¸€äº’è¡¥ç»´åº¦ï¼Œåˆ©ç”¨å¤šæ™ºèƒ½ä½“ç³»ç»Ÿæ¥è§£å†³å¹¿æ³›ä¿¡æ¯æœç´¢é—®é¢˜ã€‚ç°æœ‰çš„å¤šæ™ºèƒ½ä½“ç³»ç»Ÿé€šå¸¸ä¾èµ–äºæ‰‹åŠ¨è®¾è®¡çš„å·¥ä½œæµç¨‹å’Œè½®æµæ‰§è¡Œçš„äº¤äº’ï¼Œéš¾ä»¥å®ç°æœ‰æ•ˆçš„å·¥ä½œå¹¶è¡ŒåŒ–ã€‚ä¸ºå¼¥è¡¥è¿™ä¸€ä¸è¶³ï¼Œæˆ‘ä»¬æå‡ºäº† WideSeek-R1ï¼Œè¿™æ˜¯ä¸€ä¸ªé€šè¿‡å¤šæ™ºèƒ½ä½“å¼ºåŒ–å­¦ä¹  (MARL) è®­ç»ƒçš„ä¸»æ™ºèƒ½ä½“-å­æ™ºèƒ½ä½“æ¡†æ¶ï¼Œæ—¨åœ¨ååŒå®ç°å¯æ‰©å±•çš„ç¼–æ’ä¸å¹¶è¡Œæ‰§è¡Œã€‚é€šè¿‡åˆ©ç”¨ä¸€ä¸ªå…±äº« LLMï¼ˆå…·æœ‰éš”ç¦»çš„ä¸Šä¸‹æ–‡å’Œä¸“ç”¨å·¥å…·ï¼‰ï¼ŒWideSeek-R1 åœ¨ä¸€ä¸ªåŒ…å« 2 ä¸‡ä¸ªå¹¿æ³›ä¿¡æ¯æœç´¢ä»»åŠ¡çš„ç²¾é€‰æ•°æ®é›†ä¸Šï¼Œå¯¹ä¸»æ™ºèƒ½ä½“ä¸å¹¶è¡Œå­æ™ºèƒ½ä½“è¿›è¡Œäº†è”åˆä¼˜åŒ–ã€‚å¤§é‡å®éªŒè¡¨æ˜ï¼ŒWideSeek-R1-4B åœ¨ WideSearch åŸºå‡†æµ‹è¯•ä¸­å–å¾—äº† 40.0% çš„é¡¹ç›® F1 åˆ†æ•°ï¼Œå…¶æ€§èƒ½ä¸å•æ™ºèƒ½ä½“ DeepSeek-R1-671B ç›¸å½“ã€‚æ­¤å¤–ï¼Œéšç€å¹¶è¡Œå­æ™ºèƒ½ä½“æ•°é‡çš„å¢åŠ ï¼ŒWideSeek-R1-4B å±•ç°å‡ºæŒç»­çš„æ€§èƒ½æå‡ï¼Œè¿™å‡¸æ˜¾äº†å®½åº¦æ‰©å±•çš„æœ‰æ•ˆæ€§ã€‚</p>
<h2 data-id="heading-9">Golden Goose: A Simple Trick to Synthesize Unlimited RLVR Tasks from Unverifiable Internet Text</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.22975" target="_blank" title="https://arxiv.org/abs/2601.22975" ref="nofollow noopener noreferrer">Golden Goose: ä¸€ç§ä»ä¸å¯éªŒè¯äº’è”ç½‘æ–‡æœ¬åˆæˆæ— é™ RLVR ä»»åŠ¡çš„ç®€å•æŠ€å·§</a></p>
<p>å¯éªŒè¯å¥–åŠ±çš„å¼ºåŒ–å­¦ä¹  (Reinforcement Learning with Verifiable Rewards, RLVR) å·²æˆä¸ºè§£é”å¤§è¯­è¨€æ¨¡å‹å¤æ‚æ¨ç†èƒ½åŠ›çš„å…³é”®åŸºçŸ³ã€‚ç„¶è€Œï¼Œå¼ºåŒ–å­¦ä¹ çš„è§„æ¨¡åŒ–åº”ç”¨å—é™äºç°æœ‰å¯éªŒè¯æ•°æ®çš„åŒ®ä¹ï¼Œå¯¼è‡´æ¨¡å‹åœ¨é•¿æ—¶é—´è®­ç»ƒåæ€§èƒ½æå‡é€æ¸é¥±å’Œã€‚ä¸ºçªç ´æ­¤é™åˆ¶ï¼Œæˆ‘ä»¬æå‡ºäº† Golden Gooseï¼Œè¿™æ˜¯ä¸€ç§ç®€å•çš„æŠ€å·§ï¼Œé€šè¿‡å°†å¡«ç©ºä»»åŠ¡è½¬åŒ–ä¸ºå•é¡¹é€‰æ‹©é¢˜å½¢å¼ï¼Œèƒ½å¤Ÿä»ä¸å¯éªŒè¯çš„äº’è”ç½‘æ–‡æœ¬ä¸­åˆæˆæ— é™çš„ RLVR ä»»åŠ¡ã€‚å…·ä½“è€Œè¨€ï¼Œç»™å®šä¸€æ®µæºæ–‡æœ¬ï¼Œæˆ‘ä»¬æç¤ºä¸€ä¸ªå¤§è¯­è¨€æ¨¡å‹è¯†åˆ«å¹¶æ©ç å…¶ä¸­çš„å…³é”®æ¨ç†æ­¥éª¤ï¼Œéšåç”Ÿæˆä¸€ç»„å¤šæ ·ä¸”åˆç†çš„å¹²æ‰°é€‰é¡¹ã€‚è¿™ç§æ–¹æ³•ä½¿æˆ‘ä»¬èƒ½å¤Ÿåˆ©ç”¨é‚£äº›å¯Œå«æ¨ç†ä½†é€šå¸¸è¢«æ’é™¤åœ¨ä¼ ç»Ÿ RLVR æ•°æ®æ„å»ºä¹‹å¤–çš„ä¸å¯éªŒè¯è¯­æ–™åº“ (ä¾‹å¦‚ç§‘å­¦æ•™ç§‘ä¹¦)ï¼Œè¿›è€Œåˆæˆäº† GooseReason-0.7Mâ€”â€”ä¸€ä¸ªåŒ…å«è¶…è¿‡ 70 ä¸‡ä¸ªä»»åŠ¡çš„å¤§è§„æ¨¡ RLVR æ•°æ®é›†ï¼Œæ¶µç›–æ•°å­¦ã€ç¼–ç¨‹å’Œé€šç”¨ç§‘å­¦ç­‰å¤šä¸ªé¢†åŸŸã€‚å®éªŒç»“æœè¡¨æ˜ï¼ŒGooseReason èƒ½æœ‰æ•ˆä¿ƒä½¿åœ¨ç°æœ‰ RLVR æ•°æ®ä¸Šæ€§èƒ½é¥±å’Œçš„æ¨¡å‹æ¢å¤æ€§èƒ½æå‡ï¼Œåœ¨æŒç»­å¼ºåŒ–å­¦ä¹ ä¸‹å¸¦æ¥ç¨³å¥ä¸”æŒç»­çš„æ”¶ç›Šï¼Œå¹¶åœ¨ 15 ä¸ªä¸åŒçš„åŸºå‡†æµ‹è¯•ä¸Šï¼Œä¸º 1.5B å’Œ 4B-Instruct å‚æ•°è§„æ¨¡çš„æ¨¡å‹å–å¾—äº†æ–°çš„æœ€ä¼˜æ€§èƒ½ã€‚æœ€åï¼Œæˆ‘ä»¬å°† Golden Goose åº”ç”¨äºå®é™…åœºæ™¯ï¼Œä»åŸå§‹çš„ FineWeb ç½‘ç»œæŠ“å–æ•°æ®ä¸­ï¼Œä¸ºå…ˆå‰ä¸å­˜åœ¨ RLVR æ•°æ®çš„ç½‘ç»œå®‰å…¨é¢†åŸŸåˆæˆäº†ä»»åŠ¡ã€‚ä½¿ç”¨æ‰€å¾—æ•°æ® GooseReason-Cyber è®­ç»ƒ Qwen3-4B-Instruct æ¨¡å‹ï¼Œåœ¨ç½‘ç»œå®‰å…¨ä»»åŠ¡ä¸Šå–å¾—äº†æ–°çš„æœ€ä¼˜æ€§èƒ½ï¼Œå…¶è¡¨ç°ç”šè‡³è¶…è¶Šäº†ç»è¿‡å¤§é‡é¢†åŸŸç‰¹å®šé¢„è®­ç»ƒä¸åè®­ç»ƒçš„ 7B å‚æ•°é¢†åŸŸä¸“ç”¨æ¨¡å‹ã€‚è¿™å……åˆ†è¯æ˜äº†é€šè¿‡åˆ©ç”¨äº’è”ç½‘ä¸Šä¸°å¯Œã€å¯Œå«æ¨ç†ä½†ä¸å¯éªŒè¯çš„æ–‡æœ¬èµ„æºï¼Œèƒ½å¤Ÿæœ‰æ•ˆå®ç° RLVR æ•°æ®çš„è‡ªåŠ¨åŒ–è§„æ¨¡æ‰©å±•ã€‚</p>
<h2 data-id="heading-10">AOrchestra: Automating Sub-Agent Creation for Agentic Orchestration</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2602.03786" target="_blank" title="https://arxiv.org/abs/2602.03786" ref="nofollow noopener noreferrer">AOrchestra: ç”¨äºæ™ºèƒ½ä½“ç¼–æ’çš„è‡ªåŠ¨åŒ–å­æ™ºèƒ½ä½“åˆ›å»º</a></p>
<p>è¯­è¨€æ™ºèƒ½ä½“åœ¨ä»»åŠ¡è‡ªåŠ¨åŒ–æ–¹é¢å±•ç°å‡ºå·¨å¤§æ½œåŠ›ã€‚ä¸ºäº†åº”å¯¹æ—¥ç›Šå¤æ‚ã€å‘¨æœŸæ›´é•¿çš„ä»»åŠ¡ï¼Œå®ç°è¿™ä¸€æ½œåŠ›ï¼Œæ¨åŠ¨äº†ç”¨äºå¤šè½®ä»»åŠ¡æ±‚è§£çš„"å­æ™ºèƒ½ä½“å³å·¥å…·"èŒƒå¼çš„å…´èµ·ã€‚ç„¶è€Œï¼Œç°æœ‰è®¾è®¡ä»ç¼ºä¹å¯¹å­æ™ºèƒ½ä½“çš„åŠ¨æ€æŠ½è±¡è§†è§’ï¼Œä»è€Œé™åˆ¶äº†å…¶é€‚åº”æ€§ã€‚ä¸ºè§£å†³è¿™ä¸€æŒ‘æˆ˜ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§ç»Ÿä¸€çš„ã€ä¸æ¡†æ¶æ— å…³çš„æ™ºèƒ½ä½“æŠ½è±¡ï¼Œå®ƒå°†ä»»ä½•æ™ºèƒ½ä½“å»ºæ¨¡ä¸ºä¸€ä¸ªå…ƒç»„ï¼ˆæŒ‡ä»¤ï¼Œä¸Šä¸‹æ–‡ï¼Œå·¥å…·ï¼Œæ¨¡å‹ï¼‰ã€‚è¯¥å…ƒç»„å……å½“äº†èƒ½åŠ›çš„ç»„åˆé…æ–¹ï¼Œä½¿ç³»ç»Ÿèƒ½å¤ŸæŒ‰éœ€ä¸ºæ¯ä¸ªä»»åŠ¡ç”Ÿæˆä¸“é—¨çš„æ‰§è¡Œå™¨ã€‚åŸºäºæ­¤æŠ½è±¡ï¼Œæˆ‘ä»¬å¼•å…¥äº†æ™ºèƒ½ä½“ç³»ç»Ÿ AOrchestraã€‚åœ¨è¯¥ç³»ç»Ÿä¸­ï¼Œä¸­å¤®ç¼–æ’å™¨åœ¨æ¯ä¸€æ­¥å…·ä½“åŒ–è¯¥å…ƒç»„ï¼šå®ƒè´Ÿè´£ç­›é€‰ä¸ä»»åŠ¡ç›¸å…³çš„ä¸Šä¸‹æ–‡ã€é€‰æ‹©åˆé€‚çš„å·¥å…·å’Œæ¨¡å‹ï¼Œå¹¶é€šè¿‡åŠ¨æ€è‡ªåŠ¨åˆ›å»ºæ™ºèƒ½ä½“æ¥å§”æ‰˜æ‰§è¡Œã€‚è¿™ç§è®¾è®¡æœ‰åŠ©äºå‡å°‘äººå·¥å·¥ç¨‹æŠ•å…¥ï¼Œå¹¶ä¿æŒä¸åº•å±‚æ¡†æ¶æ— å…³ï¼Œèƒ½å¤Ÿä»¥å³æ’å³ç”¨çš„æ–¹å¼æ”¯æŒå¤šæ ·åŒ–çš„æ™ºèƒ½ä½“ä½œä¸ºä»»åŠ¡æ‰§è¡Œå™¨ã€‚åŒæ—¶ï¼Œå®ƒè¿˜å®ç°äº†å¯æ§çš„æ€§èƒ½-æˆæœ¬æƒè¡¡ï¼Œä½¿ç³»ç»Ÿèƒ½å¤Ÿè¶‹è¿‘äºå¸•ç´¯æ‰˜æœ€ä¼˜ã€‚åœ¨ä¸‰ä¸ªå…·æœ‰æŒ‘æˆ˜æ€§çš„åŸºå‡†æµ‹è¯•ï¼ˆGAIA, SWE-Bench, Terminal-Benchï¼‰ä¸­ï¼Œå½“ä¸ Gemini-3-Flash é…åˆä½¿ç”¨æ—¶ï¼ŒAOrchestra ç›¸æ¯”æœ€å¼ºåŸºçº¿å®ç°äº† 16.28% çš„ç›¸å¯¹æ€§èƒ½æå‡ã€‚ä»£ç å¯åœ¨ä»¥ä¸‹ç½‘å€è·å–ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FFoundationAgents%2FAOrchestra" target="_blank" title="https://github.com/FoundationAgents/AOrchestra" ref="nofollow noopener noreferrer">github.com/FoundationAâ€¦</a></p>
<h2 data-id="heading-11">Closing the Loop: Universal Repository Representation with RPG-Encoder</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2602.02084" target="_blank" title="https://arxiv.org/abs/2602.02084" ref="nofollow noopener noreferrer">å®ç°é—­ç¯ï¼šåŸºäº RPG-Encoder çš„é€šç”¨ä»£ç åº“è¡¨ç¤º</a></p>
<p>å½“å‰çš„ä»£ç åº“æ™ºèƒ½ä½“å› è¡¨ç¤ºç¢ç‰‡åŒ–è€Œé¢ä¸´æ¨ç†æ–­å±‚é—®é¢˜ï¼Œå› ä¸ºç°æœ‰æ–¹æ³•ä¾èµ–äºå­¤ç«‹çš„ API æ–‡æ¡£æˆ–ç¼ºä¹è¯­ä¹‰æ·±åº¦çš„ä¾èµ–å›¾ã€‚æˆ‘ä»¬å°†ä»£ç åº“çš„ç†è§£ä¸ç”Ÿæˆè§†ä¸ºä¸€ä¸ªç»Ÿä¸€å¾ªç¯å†…çš„ä¸¤ä¸ªé€†è¿‡ç¨‹ï¼šç”Ÿæˆå°†æ„å›¾å±•å¼€ä¸ºå…·ä½“å®ç°ï¼Œè€Œç†è§£åˆ™å°†å®ç°å½’çº³å›åŸå§‹æ„å›¾ã€‚ä¸ºè§£å†³æ­¤é—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº† RPG-Encoder æ¡†æ¶ï¼Œå®ƒå°†ä»“åº“è§„åˆ’å›¾ (Repository Planning Graph, RPG) ä»ä¸€ä¸ªé™æ€çš„ç”Ÿæˆè“å›¾ï¼Œæå‡ä¸ºä¸€ç§ç»Ÿä¸€ä¸”é«˜ä¿çœŸçš„ä»£ç åº“è¡¨ç¤ºå½¢å¼ã€‚RPG-Encoder é€šè¿‡ä¸‰ç§æœºåˆ¶å®ç°æ¨ç†é—­ç¯ï¼š(1) å°†åŸå§‹ä»£ç ç¼–ç ä¸º RPGï¼Œè¯¥å›¾èåˆäº†æŠ½è±¡å‡ºçš„è¯­ä¹‰ç‰¹å¾ä¸ä»£ç ä¾èµ–å…³ç³»ï¼›(2) é€æ­¥æ¼”åŒ–æ‹“æ‰‘ç»“æ„ï¼Œä½¿ç»´æŠ¤æˆæœ¬ä¸ä»£ç åº“è§„æ¨¡è§£è€¦ï¼Œå°†å¼€é”€é™ä½äº† 95.7%ï¼›(3) ä½œä¸ºä¸€ä¸ªç»Ÿä¸€æ¥å£ï¼Œæ”¯æŒç»“æ„æ„ŸçŸ¥å¯¼èˆªã€‚åœ¨è¯„ä¼°ä¸­ï¼ŒRPG-Encoder åœ¨ SWE-bench Verified ä¸Šä»¥ 93.7% çš„ Acc@5 å–å¾—äº†æœ€å…ˆè¿›çš„ä»£ç å®šä½æ€§èƒ½ï¼Œå¹¶åœ¨ SWE-bench Live Lite ä¸Šçš„å®šä½å‡†ç¡®ç‡è¶…å‡ºæœ€ä½³åŸºçº¿ 10% ä»¥ä¸Šã€‚è¿™äº›ç»“æœå‡¸æ˜¾äº†æˆ‘ä»¬çš„æ–¹æ³•åœ¨å¤æ‚ä»£ç åº“ä¸­å…·å¤‡çš„ä¼˜è¶Šç»†ç²’åº¦ç²¾åº¦ã€‚æ­¤å¤–ï¼Œå®ƒåœ¨ RepoCraft ä¸Šå®ç°äº† 98.5% çš„é‡å»ºè¦†ç›–ç‡ï¼Œè¯å®äº† RPG å…·å¤‡é«˜ä¿çœŸåæ˜ åŸå§‹ä»£ç åº“çš„èƒ½åŠ›ï¼Œä»è€Œåœ¨æ„å›¾ä¸å®ç°ä¹‹é—´å®ç°äº†é—­ç¯ã€‚</p>
<h2 data-id="heading-12">UniReason 1.0: A Unified Reasoning Framework for World Knowledge Aligned Image Generation and Editing</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2602.02437" target="_blank" title="https://arxiv.org/abs/2602.02437" ref="nofollow noopener noreferrer">UniReason 1.0ï¼šä¸€ä¸ªé¢å‘ä¸–ç•ŒçŸ¥è¯†å¯¹é½å›¾åƒç”Ÿæˆä¸ç¼–è¾‘çš„ç»Ÿä¸€æ¨ç†æ¡†æ¶</a></p>
<p>ç»Ÿä¸€çš„å¤šæ¨¡æ€æ¨¡å‹åœ¨å¤„ç†éœ€è¦æ·±åº¦æ¨ç†çš„å¤æ‚åˆæˆä»»åŠ¡æ—¶å¸¸å¸¸é¢ä¸´å›°éš¾ï¼Œå¹¶ä¸”é€šå¸¸å°†æ–‡æœ¬åˆ°å›¾åƒç”Ÿæˆå’Œå›¾åƒç¼–è¾‘è§†ä¸ºä¸¤ç§å­¤ç«‹çš„èƒ½åŠ›ï¼Œè€Œéç›¸äº’å…³è”çš„æ¨ç†æ­¥éª¤ã€‚ä¸ºè§£å†³æ­¤é—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº† UniReasonï¼Œè¿™æ˜¯ä¸€ä¸ªé€šè¿‡ä¸¤ç§äº’è¡¥çš„æ¨ç†èŒƒå¼å°†è¿™ä¸¤é¡¹ä»»åŠ¡æ•´åˆåœ¨ä¸€èµ·çš„ç»Ÿä¸€æ¡†æ¶ã€‚æˆ‘ä»¬å°†ä¸–ç•ŒçŸ¥è¯†å¢å¼ºçš„æ–‡æœ¬æ¨ç†èå…¥å›¾åƒç”Ÿæˆè¿‡ç¨‹ï¼Œä»¥æ¨æ–­éšå«çŸ¥è¯† (implicit knowledge)ï¼Œå¹¶åˆ©ç”¨ç¼–è¾‘èƒ½åŠ›è¿›è¡Œç»†ç²’åº¦çš„ã€ç±»ä¼¼ç¼–è¾‘çš„è§†è§‰ç²¾ç‚¼ï¼Œé€šè¿‡è‡ªæˆ‘åæ€è¿›ä¸€æ­¥çº æ­£è§†è§‰é”™è¯¯ã€‚è¯¥æ–¹æ³•åœ¨ä¸€ä¸ªå…±äº«æ¶æ„å†…ç»Ÿä¸€äº†ç”Ÿæˆä¸ç¼–è¾‘ï¼Œæ¨¡æ‹Ÿäº†äººç±»å…ˆè§„åˆ’åç²¾ç‚¼çš„è®¤çŸ¥è¿‡ç¨‹ã€‚ä¸ºæ”¯æŒæ­¤æ¡†æ¶ï¼Œæˆ‘ä»¬ç³»ç»Ÿæ€§åœ°æ„å»ºäº†ä¸€ä¸ªå¤§è§„æ¨¡ã€ä»¥æ¨ç†ä¸ºä¸­å¿ƒçš„æ•°æ®é›†ï¼ˆçº¦ 30 ä¸‡ä¸ªæ ·æœ¬ï¼‰ï¼Œæ¶µç›–æ–‡åŒ–å¸¸è¯†ã€ç‰©ç†å­¦ç­‰äº”ä¸ªä¸»è¦çŸ¥è¯†é¢†åŸŸç”¨äºæ–‡æœ¬æ¨ç†ï¼ŒåŒæ—¶æ„å»ºäº†ä¸€ä¸ªç”± AI æ™ºèƒ½ä½“ (AI Agent) ç”Ÿæˆçš„è¯­æ–™åº“ç”¨äºè§†è§‰ç²¾ç‚¼ã€‚å¤§é‡å®éªŒè¡¨æ˜ï¼ŒUniReason åœ¨ WISEã€KrisBench å’Œ UniREditBench ç­‰æ¨ç†å¯†é›†å‹åŸºå‡†æµ‹è¯•ä¸Šå–å¾—äº†é¢†å…ˆçš„æ€§èƒ½ï¼ŒåŒæ—¶ä¿æŒäº†ä¼˜å¼‚çš„é€šç”¨å›¾åƒåˆæˆèƒ½åŠ›ã€‚</p>
<h2 data-id="heading-13">Training Data Efficiency in Multimodal Process Reward Models</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2602.04145" target="_blank" title="https://arxiv.org/abs/2602.04145" ref="nofollow noopener noreferrer">å¤šæ¨¡æ€è¿‡ç¨‹å¥–åŠ±æ¨¡å‹ä¸­çš„è®­ç»ƒæ•°æ®æ•ˆç‡</a></p>
<p>å¤šæ¨¡æ€è¿‡ç¨‹å¥–åŠ±æ¨¡å‹ (MPRMs) æ˜¯å¤šæ¨¡æ€å¤§è¯­è¨€æ¨¡å‹ (MLLMs) ä¸­è¿›è¡Œè§†è§‰æ¨ç†æ­¥éª¤çº§ç›‘ç£çš„æ ¸å¿ƒç»„ä»¶ã€‚è®­ç»ƒ MPRMs é€šå¸¸éœ€è¦å¤§è§„æ¨¡ç»è¿‡è’™ç‰¹å¡æ´› (MC) æ–¹æ³•æ ‡æ³¨çš„æ•°æ®é›†ï¼Œè¿™ä¼šå¸¦æ¥å·¨å¤§çš„è®­ç»ƒæˆæœ¬ã€‚æœ¬æ–‡ç ”ç©¶äº† MPRM è®­ç»ƒçš„æ•°æ®æ•ˆç‡é—®é¢˜ã€‚æˆ‘ä»¬çš„åˆæ­¥å®éªŒå‘ç°ï¼Œå¯¹è®­ç»ƒæ•°æ®è¿›è¡Œéšæœºå­é‡‡æ ·æ—¶ï¼ŒMPRM è®­ç»ƒæ€§èƒ½ä¼šè¿…é€Ÿè¾¾åˆ°é¥±å’Œï¼Œè¿™è¡¨æ˜ç°æœ‰ MC æ ‡æ³¨æ•°æ®é›†ä¸­å­˜åœ¨å¤§é‡å†—ä½™ã€‚ä¸ºè§£é‡Šæ­¤ç°è±¡ï¼Œæˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ªç†è®ºæ¡†æ¶ï¼Œå¹¶æŒ‡å‡ºæœ‰æ•ˆçš„æ¢¯åº¦æ›´æ–°å–å†³äºä¸¤ä¸ªå…³é”®å› ç´ ï¼šæ­£è´Ÿæ­¥éª¤çš„æ ‡ç­¾æ„æˆä»¥åŠæ ‡ç­¾çš„å¯é æ€§ (å³æ­£æ­¥éª¤çš„å¹³å‡ MC åˆ†æ•°)ã€‚åŸºäºè¿™äº›è§è§£ï¼Œæˆ‘ä»¬æå‡ºäº†å¹³è¡¡ä¿¡æ¯åˆ†æ•° (BIS)ï¼Œè¯¥æ–¹æ³•åœ¨ rollout çº§åˆ«ç›´æ¥åˆ©ç”¨ç°æœ‰çš„ MC ä¿¡å·ï¼Œæ— éœ€é¢å¤–æˆæœ¬ï¼Œå³å¯å¯¹æ•°æ®ç‚¹çš„æ··åˆæ€§ä¸å¯é æ€§è¿›è¡Œä¼˜å…ˆçº§æ’åºã€‚åœ¨ VisualProcessBench åŸºå‡†ä¸Šï¼Œé’ˆå¯¹ä¸¤ä¸ªéª¨å¹²æ¨¡å‹ (InternVL2.5-8B å’Œ Qwen2.5-VL-7B)ï¼Œç”± BIS ç­›é€‰å‡ºçš„æ•°æ®å­é›†åœ¨ä»…ä½¿ç”¨ä¸€å°éƒ¨åˆ†æ•°æ®æ—¶ï¼Œå…¶æ€§èƒ½å§‹ç»ˆä¸ä½¿ç”¨å…¨æ•°æ®æ—¶ç›¸å½“ç”šè‡³æ›´ä¼˜ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä»…ä½¿ç”¨ 10% çš„è®­ç»ƒæ•°æ®ï¼ŒBIS å­é›†å°±èƒ½è¾¾åˆ°å…¨æ•°æ®æ€§èƒ½ï¼Œç›¸æ¯”éšæœºå­é‡‡æ ·æ–¹æ³•æ€§èƒ½ç›¸å¯¹æå‡äº† 4.1%ã€‚</p>
<h2 data-id="heading-14">CAR-bench: Evaluating the Consistency and Limit-Awareness of LLM Agents under Real-World Uncertainty</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.22027" target="_blank" title="https://arxiv.org/abs/2601.22027" ref="nofollow noopener noreferrer">CAR-bench: è¯„ä¼°ç°å®ä¸–ç•Œä¸ç¡®å®šæ€§ä¸‹å¤§è¯­è¨€æ¨¡å‹æ™ºèƒ½ä½“çš„ä¸€è‡´æ€§ä¸èƒ½åŠ›è¾¹ç•Œè®¤çŸ¥</a></p>
<p>ç°æœ‰çš„å¤§è¯­è¨€æ¨¡å‹ (LLM) æ™ºèƒ½ä½“åŸºå‡†ä¸»è¦å…³æ³¨ç†æƒ³åŒ–åœºæ™¯ä¸‹çš„ä»»åŠ¡å®Œæˆåº¦ï¼Œå´å¿½è§†äº†å…¶åœ¨é¢å‘ç”¨æˆ·çš„çœŸå®åº”ç”¨ä¸­çš„å¯é æ€§ã€‚ä¾‹å¦‚åœ¨è½¦è½½è¯­éŸ³åŠ©æ‰‹ç­‰åœºæ™¯ä¸­ï¼Œç”¨æˆ·å¸¸æå‡ºä¸å®Œæ•´æˆ–æ¨¡ç³Šçš„è¯·æ±‚ï¼Œç”±æ­¤äº§ç”Ÿçš„å†…åœ¨ä¸ç¡®å®šæ€§éœ€è¦æ™ºèƒ½ä½“é€šè¿‡å¯¹è¯ã€å·¥å…·è°ƒç”¨å’Œç­–ç•¥éµå¾ªæ¥å¦¥å–„å¤„ç†ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æå‡ºäº† CAR-benchï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºè¯„ä¼°è½¦è½½åŠ©æ‰‹é¢†åŸŸå†…å¤šè½®æ¬¡ã€ä½¿ç”¨å·¥å…·çš„ LLM æ™ºèƒ½ä½“åœ¨ä¸€è‡´æ€§ã€ä¸ç¡®å®šæ€§å¤„ç†åŠèƒ½åŠ›è®¤çŸ¥æ–¹é¢çš„åŸºå‡†ã€‚è¯¥æµ‹è¯•ç¯å¢ƒåŒ…å«ä¸€ä¸ªç”± LLM æ¨¡æ‹Ÿçš„ç”¨æˆ·ã€ç‰¹å®šé¢†åŸŸç­–ç•¥ä»¥åŠ 58 ä¸ªç›¸äº’å…³è”çš„å·¥å…·ï¼Œè¦†ç›–å¯¼èˆªã€ç”Ÿäº§åŠ›ã€å……ç”µå’Œè½¦è¾†æ§åˆ¶ç­‰åŠŸèƒ½ã€‚é™¤äº†æ ‡å‡†çš„ä»»åŠ¡å®Œæˆåº¦è¯„ä¼°ï¼ŒCAR-bench è¿˜å¼•å…¥äº†ä¸¤ç±»ä»»åŠ¡ï¼šå¹»è§‰ä»»åŠ¡ (Hallucination tasks) ï¼Œç”¨äºæµ‹è¯•æ™ºèƒ½ä½“åœ¨å·¥å…·æˆ–ä¿¡æ¯ç¼ºå¤±æ—¶å¯¹è‡ªèº«èƒ½åŠ›è¾¹ç•Œçš„è®¤çŸ¥ï¼›ä»¥åŠæ¶ˆæ­§ä»»åŠ¡ (Disambiguation tasks) ï¼Œè¦æ±‚æ™ºèƒ½ä½“é€šè¿‡æ¾„æ¸…æé—®æˆ–å†…éƒ¨ä¿¡æ¯æœé›†æ¥åŒ–è§£ä¸ç¡®å®šæ€§ã€‚åŸºçº¿æµ‹è¯•ç»“æœè¡¨æ˜ï¼Œå„ç±»ä»»åŠ¡ä¸Šå¶å°”æˆåŠŸä¸æŒç»­æˆåŠŸä¹‹é—´å­˜åœ¨å·¨å¤§å·®è·ã€‚å³ä½¿æ˜¯å‰æ²¿çš„æ¨ç†å¤§è¯­è¨€æ¨¡å‹ï¼Œä¹Ÿå› è¿‡æ—©è¡ŒåŠ¨è€Œåœ¨æ¶ˆæ­§ä»»åŠ¡ä¸Šçš„æŒç»­é€šè¿‡ç‡ä¸è¶³ 50%ï¼›åœ¨å¹»è§‰ä»»åŠ¡ä¸­ï¼Œå®ƒä»¬ä¸ºæ»¡è¶³ç”¨æˆ·è¯·æ±‚è€Œé¢‘ç¹è¿åç­–ç•¥æˆ–è™šæ„ä¿¡æ¯ã€‚è¿™äº›å‘ç°å‡¸æ˜¾äº†åœ¨ç°å®åœºæ™¯ä¸­å¼€å‘æ›´å¯é ã€æ›´å…·è‡ªçœèƒ½åŠ›çš„å¤§è¯­è¨€æ¨¡å‹æ™ºèƒ½ä½“çš„å¿…è¦æ€§ã€‚</p>
<h2 data-id="heading-15">No Global Plan in Chain-of-Thought: Uncover the Latent Planning Horizon of LLMs</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2602.02103" target="_blank" title="https://arxiv.org/abs/2602.02103" ref="nofollow noopener noreferrer">æ€ç»´é“¾ä¸­æ— å…¨å±€è§„åˆ’ï¼šæ­ç¤ºå¤§è¯­è¨€æ¨¡å‹çš„æ½œåœ¨è§„åˆ’èŒƒå›´</a></p>
<p>æœ¬ç ”ç©¶æºäºå…ˆå‰å…³äºæ€ç»´é“¾ (Chain-of-Thought, CoT) åŠ¨æ€çš„ä¸¤é¡¹äº’è¡¥è§‚å¯Ÿï¼šå¤§è¯­è¨€æ¨¡å‹ (Large Language Models, LLMs) åœ¨ CoT å¤–æ˜¾ä¹‹å‰å°±å·²å±•ç°å‡ºå¯¹åç»­æ¨ç†çš„æ½œåœ¨è§„åˆ’ï¼Œä»è€Œå‰Šå¼±äº†æ˜¾å¼ CoT çš„é‡è¦æ€§ï¼›ç„¶è€Œï¼Œå¯¹äºéœ€è¦å¤šæ­¥æ¨ç†çš„ä»»åŠ¡ï¼ŒCoT ä»ç„¶è‡³å…³é‡è¦ã€‚ä¸ºäº†æ·±å…¥ç†è§£å¤§è¯­è¨€æ¨¡å‹çš„å†…éƒ¨çŠ¶æ€ä¸å…¶å¤–æ˜¾æ¨ç†è½¨è¿¹ä¹‹é—´çš„å…³ç³»ï¼Œæˆ‘ä»¬é‡‡ç”¨æ¢æµ‹æ–¹æ³• Tele-Lensï¼Œå°†å…¶åº”ç”¨äºä¸åŒä»»åŠ¡é¢†åŸŸçš„éšè—çŠ¶æ€ï¼Œä»¥ç ”ç©¶å¤§è¯­è¨€æ¨¡å‹çš„æ½œåœ¨è§„åˆ’èƒ½åŠ›ã€‚æˆ‘ä»¬çš„å®è¯ç»“æœè¡¨æ˜ï¼Œå¤§è¯­è¨€æ¨¡å‹è¡¨ç°å‡ºä¸€ç§è¿‘è§†çš„è§„åˆ’èŒƒå›´ï¼Œä¸»è¦è¿›è¡Œå¢é‡å¼çŠ¶æ€è½¬æ¢ï¼Œè€Œéç²¾ç¡®çš„å…¨å±€è§„åˆ’ã€‚åŸºäºè¿™ä¸€ç‰¹æ€§ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªå…³äºå¢å¼º CoT ä¸ç¡®å®šæ€§ä¼°è®¡çš„å‡è®¾ï¼Œå¹¶éªŒè¯äº†ä»…ä½¿ç”¨ CoT ä½ç½®çš„ä¸€ä¸ªå°å­é›†å³å¯æœ‰æ•ˆè¡¨å¾æ•´ä¸ªæ¨ç†è·¯å¾„çš„ä¸ç¡®å®šæ€§ã€‚æˆ‘ä»¬è¿›ä¸€æ­¥å¼ºè°ƒäº†åˆ©ç”¨ CoT åŠ¨æ€ç‰¹æ€§çš„é‡è¦æ€§ï¼Œå¹¶è¯æ˜äº†è‡ªåŠ¨è¯†åˆ« CoT æ—è·¯ (bypass) å¯ä»¥åœ¨ä¸æŸå¤±æ€§èƒ½çš„æƒ…å†µä¸‹å®ç°ã€‚æˆ‘ä»¬çš„ä»£ç ã€æ•°æ®å’Œæ¨¡å‹å·²å‘å¸ƒäº <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flxucs%2Ftele-lens%25E3%2580%2582" target="_blank" title="https://github.com/lxucs/tele-lens%E3%80%82" ref="nofollow noopener noreferrer">github.com/lxucs/tele-â€¦</a></p>
<h2 data-id="heading-16">Spider-Sense: Intrinsic Risk Sensing for Efficient Agent Defense with Hierarchical Adaptive Screening</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2602.05386" target="_blank" title="https://arxiv.org/abs/2602.05386" ref="nofollow noopener noreferrer">Spider-Sense: åŸºäºåˆ†å±‚è‡ªé€‚åº”ç­›æŸ¥çš„é«˜æ•ˆæ™ºèƒ½ä½“é˜²å¾¡ä¸å†…åœ¨é£é™©æ„ŸçŸ¥</a></p>
<p>éšç€å¤§è¯­è¨€æ¨¡å‹ (LLMs) å‘å±•ä¸ºè‡ªä¸»æ™ºèƒ½ä½“ï¼Œå…¶å®é™…åº”ç”¨èŒƒå›´å·²æ˜¾è‘—æ‰©å¤§ï¼ŒåŒæ—¶ä¹Ÿå¸¦æ¥äº†æ–°çš„å®‰å…¨æŒ‘æˆ˜ã€‚å¤§å¤šæ•°ç°æœ‰çš„æ™ºèƒ½ä½“é˜²å¾¡æœºåˆ¶é‡‡ç”¨å¼ºåˆ¶æ£€æŸ¥èŒƒå¼ï¼Œå³åœ¨æ™ºèƒ½ä½“ç”Ÿå‘½å‘¨æœŸçš„é¢„å®šä¹‰é˜¶æ®µå¼ºåˆ¶è§¦å‘å®‰å…¨éªŒè¯ã€‚åœ¨æœ¬å·¥ä½œä¸­ï¼Œæˆ‘ä»¬è®¤ä¸ºæœ‰æ•ˆçš„æ™ºèƒ½ä½“å®‰å…¨åº”æ˜¯å†…åœ¨ä¸”é€‰æ‹©æ€§çš„ï¼Œè€Œéä¸æ¶æ„è§£è€¦ä¸”å¼ºåˆ¶æ€§çš„ã€‚æˆ‘ä»¬æå‡ºäº† Spider-Sense æ¡†æ¶ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäºå†…åœ¨é£é™©æ„ŸçŸ¥ (Intrinsic Risk Sensing, IRS) çš„äº‹ä»¶é©±åŠ¨é˜²å¾¡æ¡†æ¶ï¼Œå®ƒä½¿å¾—æ™ºèƒ½ä½“èƒ½å¤ŸæŒç»­ä¿æŒè­¦æˆ’çŠ¶æ€ï¼Œå¹¶ä»…åœ¨æ„ŸçŸ¥åˆ°é£é™©æ—¶æ‰è§¦å‘é˜²å¾¡ã€‚ä¸€æ—¦è§¦å‘ï¼ŒSpider-Sense ä¾¿ä¼šè°ƒç”¨ä¸€ä¸ªåœ¨æ•ˆç‡ä¸ç²¾åº¦ä¹‹é—´è¿›è¡ŒæŠ˜è¡·çš„åˆ†å±‚é˜²å¾¡æœºåˆ¶ï¼šé€šè¿‡è½»é‡çº§ç›¸ä¼¼æ€§åŒ¹é…å¤„ç†å·²çŸ¥æ¨¡å¼ï¼ŒåŒæ—¶å°†æ¨¡ç³Šæ¡ˆä¾‹äº¤ç”±æ·±åº¦å†…éƒ¨æ¨ç†å¤„ç†ï¼Œä»è€Œæ¶ˆé™¤äº†å¯¹å¤–éƒ¨æ¨¡å‹çš„ä¾èµ–ã€‚ä¸ºä¾¿äºè¿›è¡Œä¸¥æ ¼è¯„ä¼°ï¼Œæˆ‘ä»¬å¼•å…¥äº† S<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow/><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"/><span class="mord"><span/><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>Benchï¼Œè¿™æ˜¯ä¸€ä¸ªåŒ…å«ç°å®å·¥å…·æ‰§è¡Œå’Œå¤šé˜¶æ®µæ”»å‡»çš„ã€åŸºäºç”Ÿå‘½å‘¨æœŸçš„åŸºå‡†æµ‹è¯•ã€‚å¤§é‡å®éªŒè¡¨æ˜ï¼ŒSpider-Sense å®ç°äº†å…·æœ‰ç«äº‰åŠ›ä¹ƒè‡³æ›´ä¼˜çš„é˜²å¾¡æ€§èƒ½ï¼Œå–å¾—äº†æœ€ä½çš„æ”»å‡»æˆåŠŸç‡ (ASR) å’Œè¯¯æŠ¥ç‡ (FPR)ï¼Œä¸”ä»…å¸¦æ¥ 8.3% çš„è¾¹é™…å»¶è¿Ÿå¼€é”€ã€‚</p>
<h2 data-id="heading-17">MARS: Modular Agent with Reflective Search for Automated AI Research</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2602.02660" target="_blank" title="https://arxiv.org/abs/2602.02660" ref="nofollow noopener noreferrer">MARSï¼šç”¨äºè‡ªåŠ¨åŒ–AIç ”ç©¶çš„æ¨¡å—åŒ–æ™ºèƒ½ä½“ä¸åæ€æœç´¢</a></p>
<p>è‡ªåŠ¨åŒ–AIç ”ç©¶ä¸é€šç”¨è½¯ä»¶å·¥ç¨‹ä¸åŒï¼Œå…¶åŒºåˆ«åœ¨äºè¯„ä¼°ï¼ˆä¾‹å¦‚æ¨¡å‹è®­ç»ƒï¼‰çš„è®¡ç®—æˆæœ¬é«˜æ˜‚ï¼Œä¸”æ€§èƒ½å½’å› ä¸é€æ˜ã€‚å½“å‰åŸºäºå¤§è¯­è¨€æ¨¡å‹çš„æ™ºèƒ½ä½“åœ¨æ­¤é¢ä¸´æŒ‘æˆ˜ï¼Œå¸¸å¸¸ç”Ÿæˆå¿½ç•¥æ‰§è¡Œæˆæœ¬ä¸å› æœå› ç´ çš„ä¸€ä½“åŒ–è„šæœ¬ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æå‡ºäº†MARSï¼ˆæ¨¡å—åŒ–æ™ºèƒ½ä½“ä¸åæ€æœç´¢ï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸“ä¸ºè‡ªä¸»AIç ”ç©¶ä¼˜åŒ–çš„æ¡†æ¶ã€‚MARSåŸºäºä¸‰å¤§æ ¸å¿ƒæ”¯æŸ±ï¼š(1) é€šè¿‡æˆæœ¬å—é™çš„è’™ç‰¹å¡æ´›æ ‘æœç´¢ï¼ˆMCTSï¼‰è¿›è¡Œé¢„ç®—æ„ŸçŸ¥è§„åˆ’ï¼Œä»¥æ˜¾å¼å¹³è¡¡æ€§èƒ½ä¸æ‰§è¡Œå¼€é”€ï¼›(2) é‡‡ç”¨â€œè®¾è®¡-åˆ†è§£-å®ç°â€æµç¨‹çš„æ¨¡å—åŒ–æ„å»ºï¼Œç”¨ä»¥ç®¡ç†å¤æ‚çš„ç ”ç©¶ä»“åº“ï¼›(3) æ¯”è¾ƒåæ€è®°å¿†ï¼Œé€šè¿‡åˆ†æè§£å†³æ–¹æ¡ˆä¹‹é—´çš„å·®å¼‚æ¥æç‚¼é«˜ä»·å€¼æ´å¯Ÿï¼Œä»è€Œè§£å†³ä¿¡ç”¨åˆ†é…é—®é¢˜ã€‚åœ¨å¯æ¯”è®¾ç½®ä¸‹ï¼ŒMARSåœ¨MLE-BenchåŸºå‡†æµ‹è¯•ä¸­å–å¾—äº†å¼€æºæ¡†æ¶ä¸­çš„æœ€å…ˆè¿›æ€§èƒ½ï¼Œå¹¶ä¸å…¨çƒæ’è¡Œæ¦œä¸Šçš„é¡¶çº§æ–¹æ³•ä¿æŒç«äº‰åŠ›ã€‚æ­¤å¤–ï¼Œç³»ç»Ÿè¿˜è¡¨ç°å‡ºå®šæ€§çš„â€œé¡¿æ‚Ÿâ€æ—¶åˆ»ï¼šæ‰€æœ‰è¢«åˆ©ç”¨çš„ç»éªŒæ•™è®­ä¸­ï¼Œæœ‰63%æºè‡ªè·¨åˆ†æ”¯è¿ç§»ï¼Œè¿™è¯æ˜è¯¥æ™ºèƒ½ä½“èƒ½å¤Ÿæœ‰æ•ˆåœ°å°†æ´å¯Ÿæ¨å¹¿åˆ°ä¸åŒæœç´¢è·¯å¾„ã€‚</p>
<h2 data-id="heading-18">SWE-Universe: Scale Real-World Verifiable Environments to Millions</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2602.02361" target="_blank" title="https://arxiv.org/abs/2602.02361" ref="nofollow noopener noreferrer">SWE-Universeï¼šå°†çœŸå®ä¸–ç•Œå¯éªŒè¯ç¯å¢ƒæ‰©å±•è‡³ç™¾ä¸‡è§„æ¨¡</a></p>
<p>æˆ‘ä»¬æå‡ºäº† SWE-Universeï¼Œè¿™æ˜¯ä¸€ä¸ªå¯æ‰©å±•ä¸”é«˜æ•ˆçš„æ¡†æ¶ï¼Œç”¨äºåŸºäº GitHub æ‹‰å–è¯·æ±‚ (PR) è‡ªåŠ¨æ„å»ºçœŸå®ä¸–ç•Œçš„è½¯ä»¶å·¥ç¨‹ (SWE) å¯éªŒè¯ç¯å¢ƒã€‚ä¸ºäº†å…‹æœè‡ªåŠ¨æ„å»ºä¸­æ™®éå­˜åœ¨çš„æŒ‘æˆ˜ï¼Œå¦‚æ„å»ºæˆåŠŸç‡ä½ã€éªŒè¯èƒ½åŠ›å¼±ä»¥åŠæˆæœ¬è¿‡é«˜ï¼Œæˆ‘ä»¬çš„æ¡†æ¶é‡‡ç”¨äº†ä¸€ä¸ªç”±é«˜æ•ˆå®šåˆ¶è®­ç»ƒæ¨¡å‹é©±åŠ¨çš„æ„å»ºæ™ºèƒ½ä½“ã€‚è¯¥æ™ºèƒ½ä½“è¿ç”¨è¿­ä»£å¼è‡ªæˆ‘éªŒè¯ä¸å¾ªç¯å†…å¼‚å¸¸æ£€æµ‹ï¼Œä»¥ç¡®ä¿å¯é åœ°ç”Ÿæˆé«˜ä¿çœŸã€å¯éªŒè¯çš„ä»»åŠ¡ã€‚åˆ©ç”¨æ­¤æ–¹æ³•ï¼Œæˆ‘ä»¬å°†çœŸå®ä¸–ç•Œçš„å¤šè¯­è¨€ SWE ç¯å¢ƒè§„æ¨¡æ‰©å±•åˆ°äº†ç™¾ä¸‡çº§åˆ« (807,693)ã€‚æˆ‘ä»¬é€šè¿‡å¤§è§„æ¨¡æ™ºèƒ½ä½“ä¸­æœŸè®­ç»ƒå’Œå¼ºåŒ–å­¦ä¹ ï¼Œè¯æ˜äº†æˆ‘ä»¬æ„å»ºçš„ç¯å¢ƒå…·æœ‰é‡è¦ä»·å€¼ã€‚æœ€åï¼Œæˆ‘ä»¬å°†æ­¤æŠ€æœ¯åº”ç”¨äº Qwen3-Max-Thinking æ¨¡å‹ï¼Œä½¿å…¶åœ¨ SWE-Bench Verified åŸºå‡†æµ‹è¯•ä¸­å–å¾—äº† 75.3% çš„å¾—åˆ†ã€‚æˆ‘ä»¬çš„å·¥ä½œä¸ºæ¨è¿›ä¸‹ä¸€ä»£ç¼–ç æ™ºèƒ½ä½“çš„å‘å±•ï¼Œæä¾›äº†å…³é”®èµ„æºå’Œä¸€å¥—ç¨³å¥çš„æ–¹æ³•ã€‚</p>
<h2 data-id="heading-19">ASTRA: Automated Synthesis of agentic Trajectories and Reinforcement Arenas</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.21558" target="_blank" title="https://arxiv.org/abs/2601.21558" ref="nofollow noopener noreferrer">ASTRAï¼šè‡ªä¸»æ™ºèƒ½ä½“è½¨è¿¹ä¸å¼ºåŒ–ç«æŠ€åœºçš„è‡ªåŠ¨åˆæˆ</a></p>
<p>å¤§è¯­è¨€æ¨¡å‹ (LLMs) æ­£æ—¥ç›Šè¢«ç”¨ä½œå·¥å…·å¢å¼ºçš„æ™ºèƒ½ä½“ä»¥è¿›è¡Œå¤šæ­¥å†³ç­–ï¼Œç„¶è€Œï¼Œè®­ç»ƒé²æ£’çš„å·¥å…·ä½¿ç”¨æ™ºèƒ½ä½“ä»ç„¶é¢ä¸´æŒ‘æˆ˜ã€‚ç°æœ‰æ–¹æ³•é€šå¸¸ä»éœ€äººå·¥å¹²é¢„ï¼Œä¾èµ–äºä¸å¯éªŒè¯çš„æ¨¡æ‹Ÿç¯å¢ƒï¼Œä»…é‡‡ç”¨ç›‘ç£å¾®è°ƒ (SFT) æˆ–å¼ºåŒ–å­¦ä¹  (RL) ä¸­çš„ä¸€ç§ï¼Œå¹¶ä¸”åœ¨ç¨³å®šçš„é•¿è§†é‡ã€å¤šè½®å­¦ä¹ æ–¹é¢å­˜åœ¨å›°éš¾ã€‚ä¸ºåº”å¯¹è¿™äº›æŒ‘æˆ˜ï¼Œæˆ‘ä»¬æå‡ºäº† ASTRAï¼Œè¿™æ˜¯ä¸€ä¸ªå®Œå…¨è‡ªåŠ¨åŒ–çš„ç«¯åˆ°ç«¯æ¡†æ¶ï¼Œé€šè¿‡å¯æ‰©å±•çš„æ•°æ®åˆæˆå’Œå¯éªŒè¯çš„å¼ºåŒ–å­¦ä¹ æ¥è®­ç»ƒå·¥å…·å¢å¼ºçš„è¯­è¨€æ¨¡å‹æ™ºèƒ½ä½“ã€‚ASTRA é›†æˆäº†ä¸¤ä¸ªäº’è¡¥çš„ç»„ä»¶ã€‚é¦–å…ˆï¼Œä¸€ä¸ªåˆ©ç”¨å·¥å…·è°ƒç”¨å›¾é™æ€æ‹“æ‰‘çš„æµæ°´çº¿ï¼Œèƒ½å¤Ÿåˆæˆå¤šæ ·åŒ–ã€ç»“æ„ä¸Šå…·èº«çš„è½¨è¿¹ï¼Œä»è€ŒåŸ¹å…»å¹¿æ³›ä¸”å¯è¿ç§»çš„å·¥å…·ä½¿ç”¨èƒ½åŠ›ã€‚å…¶æ¬¡ï¼Œä¸€ä¸ªç¯å¢ƒåˆæˆæ¡†æ¶ï¼Œå®ƒæ•æ‰äº†äººç±»è¯­ä¹‰æ¨ç†çš„ä¸°å¯Œã€ç»„åˆå¼æ‹“æ‰‘ç»“æ„ï¼Œèƒ½å¤Ÿå°†åˆ†è§£åçš„é—®é¢˜-ç­”æ¡ˆè®°å½•è½¬æ¢ä¸ºç‹¬ç«‹çš„ã€å¯ä»£ç æ‰§è¡Œçš„ã€è§„åˆ™å¯éªŒè¯çš„ç¯å¢ƒï¼Œä»è€Œå®ç°ç¡®å®šæ€§çš„å¤šè½® RLã€‚åŸºäºæ­¤æ–¹æ³•ï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€ç§ç»Ÿä¸€çš„è®­ç»ƒæ–¹æ³•ï¼Œè¯¥æ–¹æ³•åˆ©ç”¨è½¨è¿¹çº§å¥–åŠ±å°† SFT ä¸åœ¨çº¿ RL ç›¸ç»“åˆï¼Œä»¥å¹³è¡¡ä»»åŠ¡å®Œæˆåº¦ä¸äº¤äº’æ•ˆç‡ã€‚åœ¨å¤šä¸ªæ™ºèƒ½ä½“å·¥å…·ä½¿ç”¨åŸºå‡†æµ‹è¯•ä¸Šçš„å®éªŒè¡¨æ˜ï¼ŒASTRA è®­ç»ƒçš„æ¨¡å‹åœ¨è§„æ¨¡ç›¸å½“çš„æƒ…å†µä¸‹å®ç°äº†æœ€å…ˆè¿›çš„æ€§èƒ½ï¼Œæ¥è¿‘é—­æºç³»ç»Ÿçš„æ°´å¹³ï¼ŒåŒæ—¶ä¿æŒäº†æ ¸å¿ƒæ¨ç†èƒ½åŠ›ã€‚æˆ‘ä»¬åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FLianjiaTech%2Fastra" target="_blank" title="https://github.com/LianjiaTech/astra" ref="nofollow noopener noreferrer">github.com/LianjiaTechâ€¦</a> å‘å¸ƒäº†å®Œæ•´çš„æµæ°´çº¿ã€ç¯å¢ƒå’Œè®­ç»ƒå¥½çš„æ¨¡å‹ã€‚</p>
<h2 data-id="heading-20">Quartet II: Accurate LLM Pre-Training in NVFP4 by Improved Unbiased Gradient Estimation</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.22813" target="_blank" title="https://arxiv.org/abs/2601.22813" ref="nofollow noopener noreferrer">Quartet IIï¼šé€šè¿‡æ”¹è¿›çš„æ— åæ¢¯åº¦ä¼°è®¡åœ¨ NVFP4 ä¸­å®ç°å‡†ç¡®çš„å¤§è¯­è¨€æ¨¡å‹é¢„è®­ç»ƒ</a></p>
<p>NVIDIA Blackwell GPU ç¡¬ä»¶æ”¯æŒçš„ NVFP4 ä½ç²¾åº¦æ ¼å¼ï¼Œé¦–æ¬¡ä½¿å¾—å¯¹å¤§è¯­è¨€æ¨¡å‹ç­‰å¤§è§„æ¨¡æ¨¡å‹è¿›è¡Œç«¯åˆ°ç«¯çš„å…¨é‡åŒ–é¢„è®­ç»ƒæˆä¸ºå¯èƒ½ã€‚ç„¶è€Œï¼Œç°æœ‰çš„é‡åŒ–è®­ç»ƒæ–¹æ³•ä¸ºäº†é€šè¿‡éšæœºèˆå…¥ (SR) è·å¾—æ›´å‡†ç¡®çš„æ— åé‡åŒ–æ¢¯åº¦ä¼°è®¡ï¼Œä»éœ€ç‰ºç‰²è¯¥æ ¼å¼çš„éƒ¨åˆ†è¡¨ç¤ºèƒ½åŠ›ï¼Œä»è€Œå¯¼è‡´å…¶ç²¾åº¦ç›¸è¾ƒäºæ ‡å‡†çš„ FP16 å’Œ FP8 è®­ç»ƒæœ‰æ˜æ˜¾ä¸‹é™ã€‚æœ¬æ–‡æå‡ºäº†ä¸€ç§é’ˆå¯¹å¾®ç¼©æ ¼å¼çš„æ–°å‹æ— åé‡åŒ–æ–¹æ³• MS-EDENï¼Œå…¶é‡åŒ–è¯¯å·®ä¸åˆ° SR çš„ä¸€åŠï¼Œå¹¶å€Ÿæ­¤æå‡äº† NVFP4 é‡åŒ–è®­ç»ƒçš„æŠ€æœ¯æ°´å¹³ã€‚æˆ‘ä»¬å°† MS-EDEN é›†æˆåˆ°ä¸€ä¸ªåä¸º Quartet II çš„æ–°å‹å…¨ NVFP4 çº¿æ€§å±‚é‡åŒ–æ–¹æ¡ˆä¸­ã€‚åˆ†æè¡¨æ˜ï¼ŒQuartet II åœ¨å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­çš„æ‰€æœ‰ä¸»è¦çŸ©é˜µä¹˜æ³•è¿ç®—ä¸­ï¼Œéƒ½èƒ½æŒç»­å®ç°æ›´ä¼˜çš„æ¢¯åº¦ä¼°è®¡ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬çš„æ–¹æ¡ˆä¸è¿‘æœŸä¸“ä¸º NVFP4 è®¾è®¡çš„è®­ç»ƒä¼˜åŒ–æ–¹æ³•èƒ½å¤Ÿè‰¯å¥½ååŒã€‚æˆ‘ä»¬è¿›ä¸€æ­¥åœ¨ç«¯åˆ°ç«¯çš„å¤§è¯­è¨€æ¨¡å‹è®­ç»ƒä¸ŠéªŒè¯äº† Quartet IIï¼Œæ¨¡å‹å‚æ•°è§„æ¨¡è¾¾ 1.9Bï¼Œè®­ç»ƒæ•°æ®é‡è¾¾ 38B ä¸ª Tokenã€‚æˆ‘ä»¬æä¾›äº†å¯åœ¨ NVIDIA Blackwell GPU ä¸Šè¿è¡Œçš„å†…æ ¸ï¼Œä¸ BF16 ç›¸æ¯”ï¼Œæœ€é«˜å¯å®ç° 4.2 å€çš„åŠ é€Ÿã€‚ä»£ç å¼€æºåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FIST-DASLab%2FQuartet-II" target="_blank" title="https://github.com/IST-DASLab/Quartet-II" ref="nofollow noopener noreferrer">github.com/IST-DASLab/â€¦</a> ã€‚</p>
<h2 data-id="heading-21">3D-Aware Implicit Motion Control for View-Adaptive Human Video Generation</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2602.03796" target="_blank" title="https://arxiv.org/abs/2602.03796" ref="nofollow noopener noreferrer">é¢å‘è§†è§’è‡ªé€‚åº”äººä½“è§†é¢‘ç”Ÿæˆçš„ 3D æ„ŸçŸ¥éšå¼è¿åŠ¨æ§åˆ¶</a></p>
<p>ç°æœ‰çš„è§†é¢‘ç”Ÿæˆä¸­çš„äººä½“è¿åŠ¨æ§åˆ¶æ–¹æ³•ï¼Œé€šå¸¸ä¾èµ–äº 2D å§¿æ€æˆ–æ˜¾å¼çš„ 3D å‚æ•°åŒ–æ¨¡å‹ (ä¾‹å¦‚ï¼ŒSMPL) ä½œä¸ºæ§åˆ¶ä¿¡å·ã€‚ç„¶è€Œï¼Œ2D å§¿æ€å°†è¿åŠ¨ä¸¥æ ¼ç»‘å®šåœ¨é©±åŠ¨è§†è§’ä¸Šï¼Œæ— æ³•è¿›è¡Œæ–°è§†è§’åˆæˆã€‚æ˜¾å¼ 3D æ¨¡å‹è™½ç„¶èƒ½æä¾›ç»“æ„ä¿¡æ¯ï¼Œä½†å­˜åœ¨å›ºæœ‰è¯¯å·® (ä¾‹å¦‚ï¼Œæ·±åº¦æ¨¡ç³Šå’ŒåŠ¨åŠ›å­¦ä¸å‡†ç¡®)ï¼Œå½“å°†å…¶ç”¨ä½œå¼ºçº¦æŸæ—¶ï¼Œä¼šå‹åˆ¶å¤§è§„æ¨¡è§†é¢‘ç”Ÿæˆå™¨æœ¬èº«å¼ºå¤§çš„å†…åœ¨ 3D æ„ŸçŸ¥èƒ½åŠ›ã€‚åœ¨æœ¬å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ä» 3D æ„ŸçŸ¥çš„è§’åº¦é‡æ–°å®¡è§†è¿åŠ¨æ§åˆ¶ï¼Œæå‡ºä¸€ç§éšå¼çš„ã€è§†è§’æ— å…³çš„è¿åŠ¨è¡¨ç¤ºæ–¹æ³•ã€‚è¯¥æ–¹æ³•èƒ½å¤Ÿè‡ªç„¶åœ°ä¸ç”Ÿæˆå™¨çš„ç©ºé—´å…ˆéªŒå¯¹é½ï¼Œè€Œéä¾èµ–äºå¤–éƒ¨é‡å»ºçš„çº¦æŸã€‚æˆ‘ä»¬æå‡ºäº† 3DiMoï¼Œå®ƒè”åˆè®­ç»ƒä¸€ä¸ªè¿åŠ¨ç¼–ç å™¨ä¸ä¸€ä¸ªé¢„è®­ç»ƒçš„è§†é¢‘ç”Ÿæˆå™¨ï¼Œå°†é©±åŠ¨å¸§æç‚¼æˆç´§å‡‘çš„ã€è§†è§’æ— å…³çš„è¿åŠ¨ token (Motion Token)ï¼Œå¹¶é€šè¿‡äº¤å‰æ³¨æ„åŠ›è¿›è¡Œè¯­ä¹‰æ³¨å…¥ã€‚ä¸ºäº†å¢å¼º 3D æ„ŸçŸ¥èƒ½åŠ›ï¼Œæˆ‘ä»¬é‡‡ç”¨è§†è§’ä¸°å¯Œçš„ç›‘ç£æ•°æ®è¿›è¡Œè®­ç»ƒ (å³å•è§†è§’ã€å¤šè§†è§’å’Œè¿åŠ¨ç›¸æœºè§†é¢‘)ï¼Œä»¥å¼ºåˆ¶å®ç°ä¸åŒè§†è§’é—´çš„è¿åŠ¨ä¸€è‡´æ€§ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†è¾…åŠ©å‡ ä½•ç›‘ç£ï¼Œè¯¥ç›‘ç£ä»…åœ¨æ—©æœŸåˆå§‹åŒ–é˜¶æ®µåˆ©ç”¨ SMPLï¼Œå¹¶é€æ¸é€€ç«è‡³é›¶ã€‚è¿™ä½¿å¾—æ¨¡å‹èƒ½å¤Ÿä»å¤–éƒ¨ 3D æŒ‡å¯¼ï¼Œè¿‡æ¸¡åˆ°ä»æ•°æ®åŠç”Ÿæˆå™¨å…ˆéªŒä¸­å­¦ä¹ çœŸæ­£çš„ 3D ç©ºé—´è¿åŠ¨ç†è§£ã€‚å®éªŒè¯å®ï¼Œ3DiMo èƒ½å¤Ÿé€šè¿‡çµæ´»çš„ã€æ–‡æœ¬é©±åŠ¨çš„ç›¸æœºæ§åˆ¶ï¼Œå‡†ç¡®å¤ç°é©±åŠ¨è¿åŠ¨ï¼Œåœ¨è¿åŠ¨ä¿çœŸåº¦å’Œè§†è§‰è´¨é‡æ–¹é¢å‡æ˜¾è‘—è¶…è¶Šäº†ç°æœ‰æ–¹æ³•ã€‚</p>
<h2 data-id="heading-22">daVinci-Agency: Unlocking Long-Horizon Agency Data-Efficiently</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2602.02619" target="_blank" title="https://arxiv.org/abs/2602.02619" ref="nofollow noopener noreferrer">daVinci-Agencyï¼šé«˜æ•ˆè§£é”é•¿å‘¨æœŸæ™ºèƒ½ä½“èƒ½åŠ›</a></p>
<p>å°½ç®¡å¤§è¯­è¨€æ¨¡å‹ (LLMs) åœ¨çŸ­æœŸä»»åŠ¡ä¸Šè¡¨ç°å‡ºè‰²ï¼Œä½†å°†å…¶æ‰©å±•åˆ°é•¿å‘¨æœŸçš„æ™ºèƒ½ä½“å·¥ä½œæµä»ç„¶é¢ä¸´æŒ‘æˆ˜ã€‚æ ¸å¿ƒç“¶é¢ˆåœ¨äºç¼ºä¹èƒ½å¤Ÿæ•æ‰çœŸå®é•¿ç¨‹ä¾èµ–ç»“æ„å’Œè·¨é˜¶æ®µåŠ¨æ€æ¼”åŒ–è¿‡ç¨‹çš„è®­ç»ƒæ•°æ®â€”â€”ç°æœ‰çš„åˆæˆæ–¹æ³•è¦ä¹ˆå±€é™äºå—æ¨¡å‹åˆ†å¸ƒçº¦æŸçš„å•ä¸€ä»»åŠ¡åœºæ™¯ï¼Œè¦ä¹ˆéœ€è¦é«˜æ˜‚çš„äººå·¥æ ‡æ³¨æˆæœ¬ï¼Œæ— æ³•æä¾›å¯æ‰©å±•ã€é«˜è´¨é‡çš„ç›‘ç£ã€‚æˆ‘ä»¬é€šè¿‡ä»ç°å®ä¸–ç•Œè½¯ä»¶æ¼”åŒ–çš„è§†è§’é‡æ–°æ„æƒ³æ•°æ®åˆæˆæ¥è§£å†³è¿™ä¸€é—®é¢˜ã€‚æˆ‘ä»¬çš„æ ¸å¿ƒè§è§£æ˜¯ï¼šæ‹‰å–è¯·æ±‚ (Pull Request, PR) åºåˆ—å¤©ç„¶è•´å«äº†é•¿å‘¨æœŸå­¦ä¹ æ‰€éœ€çš„ç›‘ç£ä¿¡å·ã€‚å®ƒä»¬å°†å¤æ‚ç›®æ ‡åˆ†è§£ä¸ºå¯éªŒè¯çš„æäº¤å•å…ƒï¼Œåœ¨å¤šæ¬¡è¿­ä»£é—´ä¿æŒåŠŸèƒ½ä¸€è‡´æ€§ï¼Œå¹¶é€šè¿‡é”™è¯¯ä¿®å¤å†å²ç¼–ç çœŸå®çš„ç²¾ç‚¼æ¨¡å¼ã€‚åŸºäºæ­¤ï¼Œæˆ‘ä»¬æå‡ºäº† daVinci-Agencyï¼Œå®ƒé€šè¿‡ä¸‰ä¸ªç›¸äº’å…³è”çš„æœºåˆ¶ï¼Œç³»ç»Ÿåœ°ä» PR é“¾ä¸­æŒ–æ˜ç»“æ„åŒ–ç›‘ç£ï¼š(1) é€šè¿‡æŒç»­æäº¤å®ç°æ¸è¿›å¼ä»»åŠ¡åˆ†è§£ï¼Œ(2) é€šè¿‡ç»Ÿä¸€åŠŸèƒ½ç›®æ ‡å¼ºåˆ¶æ‰§è¡Œé•¿æœŸä¸€è‡´æ€§ï¼Œä»¥åŠ (3) ä»çœŸå®çš„é”™è¯¯ä¿®å¤è½¨è¿¹ä¸­è·å–å¯éªŒè¯çš„ç²¾ç‚¼è¿‡ç¨‹ã€‚ä¸é‚£äº›ç‹¬ç«‹å¤„ç†å„æ­¥éª¤çš„åˆæˆè½¨è¿¹ä¸åŒï¼ŒdaVinci-Agency åŸºäº PR çš„ç»“æ„å›ºæœ‰åœ°ä¿ç•™äº†å¯¹äºè®­ç»ƒæŒä¹…æ€§ç›®æ ‡å¯¼å‘è¡Œä¸ºè‡³å…³é‡è¦çš„å› æœä¾èµ–å’Œè¿­ä»£ç²¾ç‚¼ï¼Œå¹¶èƒ½è‡ªç„¶åœ°ä¸é¡¹ç›®çº§ã€å®Œæ•´å‘¨æœŸçš„ä»»åŠ¡å»ºæ¨¡å¯¹é½ã€‚ç”±æ­¤äº§ç”Ÿçš„è½¨è¿¹è§„æ¨¡åºå¤§â€”â€”å¹³å‡åŒ…å« 85k ä¸ª Token å’Œ 116 æ¬¡å·¥å…·è°ƒç”¨â€”â€”ä½†æ•°æ®æ•ˆç‡å´å‡ºå¥‡åœ°é«˜ï¼šä»…ä½¿ç”¨ 239 ä¸ª daVinci-Agency æ ·æœ¬å¯¹ GLM-4.6 è¿›è¡Œå¾®è°ƒï¼Œä¾¿åœ¨å¤šä¸ªåŸºå‡†æµ‹è¯•ä¸Šå–å¾—äº†å…¨é¢çš„æ€§èƒ½æå‡ï¼Œå°¤å…¶åœ¨ Toolathlon ä¸Šå®ç°äº† 47% çš„ç›¸å¯¹å¢ç›Šã€‚é™¤äº†åŸºå‡†æµ‹è¯•æ€§èƒ½ï¼Œæˆ‘ä»¬çš„åˆ†æè¯å®...</p>
<h2 data-id="heading-23">Research on World Models Is Not Merely Injecting World Knowledge into Specific Tasks</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2602.01630" target="_blank" title="https://arxiv.org/abs/2602.01630" ref="nofollow noopener noreferrer">ä¸–ç•Œæ¨¡å‹ç ”ç©¶ä¸ä»…ä»…æ˜¯å‘ç‰¹å®šä»»åŠ¡æ³¨å…¥ä¸–ç•ŒçŸ¥è¯†</a></p>
<p>ä¸–ç•Œæ¨¡å‹å·²æˆä¸ºäººå·¥æ™ºèƒ½ç ”ç©¶çš„ä¸€ä¸ªå…³é”®å‰æ²¿ï¼Œå…¶ç›®æ ‡æ˜¯é€šè¿‡èå…¥ç‰©ç†åŠ¨åŠ›å­¦å’Œä¸–ç•ŒçŸ¥è¯†æ¥å¢å¼ºå¤§è¯­è¨€æ¨¡å‹ã€‚æ ¸å¿ƒç›®æ ‡æ˜¯ä½¿ AI æ™ºèƒ½ä½“èƒ½å¤Ÿç†è§£ã€é¢„æµ‹å¹¶ä¸å¤æ‚ç¯å¢ƒè¿›è¡Œäº¤äº’ã€‚ç„¶è€Œï¼Œå½“å‰çš„ç ”ç©¶æ ¼å±€ä»å‘ˆç¢ç‰‡åŒ–ï¼Œç°æœ‰æ–¹æ³•ä¸»è¦ä¾§é‡äºå°†ä¸–ç•ŒçŸ¥è¯†èå…¥è§†è§‰é¢„æµ‹ã€3D ä¼°è®¡æˆ–ç¬¦å·æ¥åœ°ç­‰ç‹¬ç«‹ä»»åŠ¡ï¼Œè€Œéå»ºç«‹ä¸€ä¸ªç»Ÿä¸€çš„å®šä¹‰æˆ–æ¡†æ¶ã€‚å°½ç®¡è¿™äº›é’ˆå¯¹ç‰¹å®šä»»åŠ¡çš„é›†æˆå¸¦æ¥äº†æ€§èƒ½æå‡ï¼Œä½†å®ƒä»¬é€šå¸¸ç¼ºä¹å®ç°æ•´ä½“ä¸–ç•Œç†è§£æ‰€éœ€çš„ç³»ç»Ÿæ€§è¿è´¯æ€§ã€‚æœ¬æ–‡åˆ†æäº†æ­¤ç±»ç¢ç‰‡åŒ–æ–¹æ³•çš„å±€é™æ€§ï¼Œå¹¶æå‡ºäº†ä¸€å¥—ä¸–ç•Œæ¨¡å‹çš„ç»Ÿä¸€è®¾è®¡è§„èŒƒã€‚æˆ‘ä»¬è®¤ä¸ºï¼Œä¸€ä¸ªç¨³å¥çš„ä¸–ç•Œæ¨¡å‹ä¸åº”æ˜¯å„ç§èƒ½åŠ›çš„æ¾æ•£ç»„åˆï¼Œè€Œåº”æ˜¯ä¸€ä¸ªè§„èŒƒæ€§çš„æ¡†æ¶ï¼Œèƒ½å¤Ÿæœ‰æœºæ•´åˆäº¤äº’ã€æ„ŸçŸ¥ã€ç¬¦å·æ¨ç†å’Œç©ºé—´è¡¨ç¤ºã€‚æœ¬å·¥ä½œæ—¨åœ¨æä¾›ä¸€ä¸ªç»“æ„åŒ–çš„è§†è§’ï¼Œä»¥æŒ‡å¯¼æœªæ¥ç ”ç©¶å‘å±•å‡ºæ›´é€šç”¨ã€ç¨³å¥ä¸”å…·æœ‰åŸåˆ™æ€§çš„ä¸–ç•Œæ¨¡å‹ã€‚</p>
<h2 data-id="heading-24">Length-Unbiased Sequence Policy Optimization: Revealing and Controlling Response Length Variation in RLVR</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2602.05261" target="_blank" title="https://arxiv.org/abs/2602.05261" ref="nofollow noopener noreferrer">é•¿åº¦æ— ååºåˆ—ç­–ç•¥ä¼˜åŒ–ï¼šæ­ç¤ºå’Œæ§åˆ¶ RLVR ä¸­çš„å“åº”é•¿åº¦å˜åŒ–</a></p>
<p>è¿‘æœŸï¼Œå°†å¯éªŒè¯å¥–åŠ±çš„å¼ºåŒ–å­¦ä¹  (Reinforcement Learning with Verifiable Rewards, RLVR) åº”ç”¨äºå¤§è¯­è¨€æ¨¡å‹ (LLMs) å’Œè§†è§‰è¯­è¨€æ¨¡å‹ (VLMs)ï¼Œåœ¨æå‡å¤æ‚ä»»åŠ¡æ¨ç†èƒ½åŠ›æ–¹é¢å–å¾—äº†æ˜¾è‘—æˆæ•ˆã€‚åœ¨ RLVR è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå“åº”é•¿åº¦çš„å¢åŠ å¸¸è¢«è§†ä¸ºæ¨åŠ¨æ¨ç†èƒ½åŠ›æå‡çš„å…³é”®å› ç´ ã€‚ç„¶è€Œï¼Œä¸åŒ RLVR ç®—æ³•åœ¨è®­ç»ƒæœŸé—´ï¼Œå…¶å“åº”é•¿åº¦çš„å˜åŒ–æ¨¡å¼å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚ä¸ºä»æ ¹æœ¬ä¸Šè§£é‡Šè¿™äº›å·®å¼‚ï¼Œæœ¬æ–‡å¯¹ä¸»æµ RLVR ç®—æ³•çš„æ„æˆè¦ç´ è¿›è¡Œäº†æ·±å…¥å‰–æã€‚æˆ‘ä»¬ç†è®ºåˆ†æäº†å½±å“å“åº”é•¿åº¦çš„å› ç´ ï¼Œå¹¶é€šè¿‡å¤§é‡å®éªŒéªŒè¯äº†è¯¥ç†è®ºã€‚åŸºäºè¿™äº›ç†è®ºå‘ç°ï¼Œæˆ‘ä»¬æå‡ºäº†é•¿åº¦æ— ååºåˆ—ç­–ç•¥ä¼˜åŒ– (Length-Unbiased Sequence Policy Optimization, LUSPO) ç®—æ³•ã€‚å…·ä½“è€Œè¨€ï¼Œæˆ‘ä»¬ä¿®æ­£äº†ç»„åºåˆ—ç­–ç•¥ä¼˜åŒ– (Group Sequence Policy Optimization, GSPO) ä¸­å›ºæœ‰çš„é•¿åº¦åå·®ï¼Œä½¿å…¶æŸå¤±å‡½æ•°å¯¹å“åº”é•¿åº¦æ— åï¼Œä»è€Œè§£å†³äº†å“åº”é•¿åº¦å´©æºƒé—®é¢˜ã€‚æˆ‘ä»¬åœ¨æ•°å­¦æ¨ç†åŸºå‡†æµ‹è¯•å’Œå¤šæ¨¡æ€æ¨ç†åœºæ™¯ä¸­è¿›è¡Œäº†å¹¿æ³›çš„å®éªŒï¼ŒLUSPO å‡èƒ½æŒç»­å–å¾—æ›´ä¼˜çš„æ€§èƒ½ã€‚å®è¯ç»“æœè¡¨æ˜ï¼Œä¸ GRPO å’Œ GSPO ç­‰ç°æœ‰æ–¹æ³•ç›¸æ¯”ï¼ŒLUSPO æ˜¯ä¸€ç§æ–°é¢–ä¸”å…ˆè¿›çš„ä¼˜åŒ–ç­–ç•¥ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€å¤©ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼ˆç¬¬15ç¯‡ï¼‰ï¼šMapToPoster - ç”¨ä»£ç å°†åŸå¸‚åœ°å›¾è½¬æ¢ä¸ºç²¾ç¾çš„æµ·æŠ¥è®¾è®¡]]></title>    <link>https://juejin.cn/post/7603651011978690602</link>    <guid>https://juejin.cn/post/7603651011978690602</guid>    <pubDate>2026-02-07T12:28:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603651011978690602" data-draft-id="7603649945977995283" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€å¤©ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼ˆç¬¬15ç¯‡ï¼‰ï¼šMapToPoster - ç”¨ä»£ç å°†åŸå¸‚åœ°å›¾è½¬æ¢ä¸ºç²¾ç¾çš„æµ·æŠ¥è®¾è®¡"/> <meta itemprop="keywords" content="å¼€æº,Python"/> <meta itemprop="datePublished" content="2026-02-07T12:28:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†¬å¥‡Lab"/> <meta itemprop="url" content="https://juejin.cn/user/1857501105781193"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€å¤©ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼ˆç¬¬15ç¯‡ï¼‰ï¼šMapToPoster - ç”¨ä»£ç å°†åŸå¸‚åœ°å›¾è½¬æ¢ä¸ºç²¾ç¾çš„æµ·æŠ¥è®¾è®¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1857501105781193/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†¬å¥‡Lab
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T12:28:20.000Z" title="Sat Feb 07 2026 12:28:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<blockquote>
<p>"æ¯ä¸€åº§åŸå¸‚éƒ½æœ‰ç‹¬ç‰¹çš„é“è·¯çº¹ç†ï¼Œå°±åƒæŒ‡çº¹ä¸€æ ·ç‹¬ä¸€æ— äºŒã€‚"</p>
</blockquote>
<p>è¿™æ˜¯"ä¸€å¤©ä¸€ä¸ªå¼€æºé¡¹ç›®"ç³»åˆ—çš„ç¬¬15ç¯‡æ–‡ç« ã€‚ä»Šå¤©å¸¦ä½ äº†è§£çš„é¡¹ç›®æ˜¯ <strong>MapToPoster</strong>ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Foriginalankur%2Fmaptoposter" target="_blank" title="https://github.com/originalankur/maptoposter" ref="nofollow noopener noreferrer">GitHub</a>ï¼‰ã€‚</p>
<p>ä½ æ˜¯å¦æƒ³è¿‡å°†ä½ å–œæ¬¢çš„åŸå¸‚åœ°å›¾è½¬æ¢æˆä¸€å¼ ç²¾ç¾çš„æµ·æŠ¥ï¼ŸMapToPoster è®©è¿™ä¸ªæƒ³æ³•å˜æˆäº†ç°å®ã€‚å®ƒä½¿ç”¨ OpenStreetMap çš„å¼€æºåœ°å›¾æ•°æ®ï¼Œé€šè¿‡ Python ä»£ç å°†åŸå¸‚é“è·¯ç½‘ç»œè½¬æ¢ä¸ºæç®€ä¸»ä¹‰é£æ ¼çš„ç²¾ç¾æµ·æŠ¥è®¾è®¡ã€‚æ— è®ºæ˜¯å·´é»çš„æµªæ¼«è¡—é“ã€ä¸œäº¬çš„å¯†é›†è·¯ç½‘ï¼Œè¿˜æ˜¯çº½çº¦çš„ç½‘æ ¼å¸ƒå±€ï¼Œéƒ½èƒ½è¢«è½¬æ¢æˆç‹¬ç‰¹çš„è‰ºæœ¯ä½œå“ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªé¡¹ç›®ï¼Ÿ</strong></p>
<ul>
<li>ğŸ—ºï¸ <strong>çœŸå®åœ°å›¾æ•°æ®</strong>ï¼šåŸºäº OpenStreetMapï¼Œæ•°æ®å‡†ç¡®ä¸”å…è´¹</li>
<li>ğŸ¨ <strong>17ç§ç²¾ç¾ä¸»é¢˜</strong>ï¼šä»æç®€é»‘ç™½åˆ°éœ“è™¹èµ›åšæœ‹å…‹ï¼Œæ»¡è¶³ä¸åŒå®¡ç¾</li>
<li>ğŸ <strong>çº¯Pythonå®ç°</strong>ï¼šä»£ç ç®€æ´ï¼Œæ˜“äºç†è§£å’Œå®šåˆ¶</li>
<li>ğŸ¯ <strong>æç®€ä¸»ä¹‰è®¾è®¡</strong>ï¼šä¸“æ³¨äºé“è·¯çº¹ç†ï¼Œå‘ˆç°åŸå¸‚ç‹¬ç‰¹ç¾æ„Ÿ</li>
<li>ğŸ“ <strong>çµæ´»é…ç½®</strong>ï¼šæ”¯æŒè‡ªå®šä¹‰è·ç¦»ã€åæ ‡ã€å­—ä½“ã€ä¸»é¢˜ç­‰</li>
<li>ğŸŒ <strong>å…¨çƒåŸå¸‚æ”¯æŒ</strong>ï¼šæ”¯æŒä¸–ç•Œä»»ä½•åŸå¸‚çš„é“è·¯ç½‘ç»œ</li>
</ul>
<h3 data-id="heading-1">ä½ å°†å­¦åˆ°ä»€ä¹ˆ</h3>
<ul>
<li>MapToPoster çš„æ ¸å¿ƒåŸç†å’Œæ¶æ„è®¾è®¡</li>
<li>å¦‚ä½•ä½¿ç”¨ OSMnx è·å–å’Œå¤„ç†åœ°å›¾æ•°æ®</li>
<li>17ç§ä¸»é¢˜çš„è®¾è®¡ç†å¿µå’Œä½¿ç”¨åœºæ™¯</li>
<li>å¦‚ä½•è‡ªå®šä¹‰ä¸»é¢˜å’Œæ ·å¼</li>
<li>å­—ä½“ç®¡ç†å’Œ Google Fonts é›†æˆ</li>
<li>åœ°å›¾æ¸²æŸ“çš„å±‚æ¬¡ç»“æ„å’Œä¼˜åŒ–æŠ€å·§</li>
<li>å®é™…ä½¿ç”¨ä¸­çš„æœ€ä½³å®è·µå’Œå‚æ•°è°ƒä¼˜</li>
</ul>
<h3 data-id="heading-2">å‰ç½®çŸ¥è¯†</h3>
<ul>
<li>Python åŸºç¡€è¯­æ³•å’Œå‘½ä»¤è¡Œä½¿ç”¨</li>
<li>å¯¹åœ°å›¾å’Œåœ°ç†æ•°æ®æœ‰åŸºæœ¬äº†è§£</li>
<li>äº†è§£ JSON é…ç½®æ–‡ä»¶æ ¼å¼</li>
<li>å¯¹æ•°æ®å¯è§†åŒ–æœ‰åŸºæœ¬æ¦‚å¿µï¼ˆå¯é€‰ï¼Œæœ‰åŠ©äºç†è§£æ¸²æŸ“åŸç†ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-3">é¡¹ç›®èƒŒæ™¯</h2>
<h3 data-id="heading-4">é¡¹ç›®ç®€ä»‹</h3>
<p><strong>MapToPoster</strong> æ˜¯ä¸€ä¸ª<strong>ç”¨ä»£ç å°†åŸå¸‚åœ°å›¾è½¬æ¢ä¸ºç²¾ç¾æµ·æŠ¥çš„ Python å·¥å…·</strong>ã€‚å®ƒé€šè¿‡ OpenStreetMap çš„å¼€æºåœ°å›¾æ•°æ®ï¼Œä½¿ç”¨ OSMnx åº“è·å–åŸå¸‚é“è·¯ç½‘ç»œï¼Œç„¶åé€šè¿‡ matplotlib æ¸²æŸ“æˆæç®€ä¸»ä¹‰é£æ ¼çš„æµ·æŠ¥è®¾è®¡ã€‚ä½ å¯ä»¥é€‰æ‹©ä¸åŒçš„ä¸»é¢˜ã€è°ƒæ•´è·ç¦»èŒƒå›´ã€è‡ªå®šä¹‰å­—ä½“ï¼Œç”Ÿæˆç‹¬ä¸€æ— äºŒçš„åŸå¸‚åœ°å›¾æµ·æŠ¥ã€‚</p>
<p><strong>é¡¹ç›®è§£å†³çš„æ ¸å¿ƒé—®é¢˜</strong>ï¼š</p>
<ul>
<li>ç¼ºä¹ç®€å•æ˜“ç”¨çš„åœ°å›¾æµ·æŠ¥ç”Ÿæˆå·¥å…·</li>
<li>å•†ä¸šåœ°å›¾æœåŠ¡ API æ˜‚è´µä¸”æœ‰é™åˆ¶</li>
<li>éœ€è¦å¯ç¼–ç¨‹ã€å¯å®šåˆ¶çš„åœ°å›¾å¯è§†åŒ–æ–¹æ¡ˆ</li>
<li>å¸Œæœ›å°†åŸå¸‚åœ°å›¾è½¬æ¢ä¸ºè‰ºæœ¯ä½œå“çš„éœ€æ±‚</li>
<li>éœ€è¦æ‰¹é‡ç”Ÿæˆä¸åŒåŸå¸‚ã€ä¸åŒä¸»é¢˜çš„åœ°å›¾æµ·æŠ¥</li>
</ul>
<p><strong>é¢å‘çš„ç”¨æˆ·ç¾¤ä½“</strong>ï¼š</p>
<ul>
<li>è®¾è®¡å¸ˆå’Œè‰ºæœ¯åˆ›ä½œè€…</li>
<li>åœ°ç†æ•°æ®å¯è§†åŒ–çˆ±å¥½è€…</li>
<li>Python å¼€å‘è€…</li>
<li>åŸå¸‚è§„åˆ’å’Œå»ºç­‘ä¸“ä¸šäººå£«</li>
<li>å¸Œæœ›åˆ¶ä½œä¸ªæ€§åŒ–åŸå¸‚æµ·æŠ¥çš„ç”¨æˆ·</li>
</ul>
<h3 data-id="heading-5">ä½œè€…/å›¢é˜Ÿä»‹ç»</h3>
<p><strong>ä½œè€…ï¼šoriginalankur</strong></p>
<ul>
<li><strong>èƒŒæ™¯</strong>ï¼šä¸“æ³¨äºæ•°æ®å¯è§†åŒ–å’Œè®¾è®¡å·¥å…·çš„å¼€æºè´¡çŒ®è€…</li>
<li><strong>é¡¹ç›®åˆ›å»ºæ—¶é—´</strong>ï¼š2024å¹´ï¼ˆä» GitHub æ´»åŠ¨æ¥çœ‹æ˜¯æŒç»­æ´»è·ƒçš„é¡¹ç›®ï¼‰</li>
<li><strong>ç†å¿µ</strong>ï¼šç”¨ä»£ç åˆ›é€ ç¾ï¼Œè®©åœ°å›¾æ•°æ®æˆä¸ºè‰ºæœ¯</li>
<li><strong>æŠ€æœ¯æ ˆ</strong>ï¼šPythonã€OSMnxã€matplotlibã€OpenStreetMap</li>
</ul>
<h3 data-id="heading-6">é¡¹ç›®æ•°æ®</h3>
<ul>
<li>â­ <strong>GitHub Stars</strong>: 9.8k+ï¼ˆæŒç»­å¿«é€Ÿå¢é•¿ï¼‰</li>
<li>ğŸ´ <strong>Forks</strong>: 872+</li>
<li>ğŸ“¦ <strong>ç‰ˆæœ¬</strong>: æŒç»­æ›´æ–°ä¸­ï¼ˆ50+ commitsï¼‰</li>
<li>ğŸ“„ <strong>License</strong>: MITï¼ˆå®Œå…¨å¼€æºï¼Œè‡ªç”±ä½¿ç”¨ï¼‰</li>
<li>ğŸŒ <strong>é¡¹ç›®åœ°å€</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Foriginalankur%2Fmaptoposter" target="_blank" title="https://github.com/originalankur/maptoposter" ref="nofollow noopener noreferrer">GitHub</a></li>
<li>ğŸ’¬ <strong>ç¤¾åŒº</strong>: GitHub Issues æ´»è·ƒï¼Œ9ä¸ªå¼€æ”¾ Issuesï¼Œ16ä¸ª Pull Requests</li>
<li>ğŸ‘¥ <strong>è´¡çŒ®è€…</strong>: 15ä½è´¡çŒ®è€…ï¼Œæ´»è·ƒçš„ç¤¾åŒºå‚ä¸</li>
</ul>
<p><strong>é¡¹ç›®å‘å±•å†ç¨‹</strong>ï¼š</p>
<ul>
<li>2024å¹´ï¼šé¡¹ç›®åˆ›å»ºï¼Œå®ç°æ ¸å¿ƒåŠŸèƒ½</li>
<li>2024å¹´ä¸­ï¼šæ·»åŠ å¤šç§ä¸»é¢˜æ”¯æŒ</li>
<li>2024å¹´åº•ï¼šå®Œå–„å­—ä½“ç®¡ç†å’Œ Google Fonts é›†æˆ</li>
<li>2025å¹´ï¼šä¼˜åŒ–æ¸²æŸ“æ€§èƒ½ï¼Œæ·»åŠ æ›´å¤šä¸»é¢˜</li>
<li>æŒç»­ç»´æŠ¤ï¼šé¡¹ç›®æŒç»­æ´»è·ƒï¼Œç¤¾åŒºè´¡çŒ®ä¸æ–­</li>
</ul>
<hr/>
<h2 data-id="heading-7">ä¸»è¦åŠŸèƒ½</h2>
<h3 data-id="heading-8">æ ¸å¿ƒä½œç”¨</h3>
<p>MapToPoster çš„æ ¸å¿ƒä½œç”¨æ˜¯<strong>å°†åŸå¸‚åœ°å›¾æ•°æ®è½¬æ¢ä¸ºç²¾ç¾çš„æµ·æŠ¥è®¾è®¡</strong>ï¼Œä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>åœ°å›¾æ•°æ®è·å–</strong>ï¼šé€šè¿‡ OSMnx ä» OpenStreetMap è·å–åŸå¸‚é“è·¯ç½‘ç»œæ•°æ®</li>
<li><strong>å¤šä¸»é¢˜æ¸²æŸ“</strong>ï¼šæ”¯æŒ17ç§ç²¾å¿ƒè®¾è®¡çš„ä¸»é¢˜ï¼Œä»æç®€åˆ°èµ›åšæœ‹å…‹</li>
<li><strong>çµæ´»é…ç½®</strong>ï¼šæ”¯æŒè‡ªå®šä¹‰è·ç¦»èŒƒå›´ã€ä¸­å¿ƒåæ ‡ã€å­—ä½“ã€ä¸»é¢˜ç­‰å‚æ•°</li>
<li><strong>é«˜è´¨é‡è¾“å‡º</strong>ï¼šç”Ÿæˆé«˜åˆ†è¾¨ç‡ PNG å›¾ç‰‡ï¼Œé€‚åˆæ‰“å°å’Œå±•ç¤º</li>
<li><strong>å­—ä½“ç®¡ç†</strong>ï¼šæ”¯æŒæœ¬åœ°å­—ä½“å’Œ Google Fonts è‡ªåŠ¨ä¸‹è½½</li>
<li><strong>è„šæœ¬æ£€æµ‹</strong>ï¼šè‡ªåŠ¨æ£€æµ‹æ–‡æœ¬è„šæœ¬ï¼ˆæ‹‰ä¸/éæ‹‰ä¸ï¼‰ï¼Œåº”ç”¨åˆé€‚çš„æ’ç‰ˆ</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/616dfab3283a4a2fb7717cbf37157f6e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771072100&amp;x-signature=jsiqPgj0cKilqnfyqy7Z6Lt5QOA%3D" alt="15-01-barcelona_warm_beige.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57ae9379062c42038b66968fba64ddc0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771072100&amp;x-signature=mfKK6wdI9OOoBJ7KqLsUTDMFfR8%3D" alt="15-02-dubai_midnight_blue.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/733418e08c2d4330b1f2d7618e22379a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771072100&amp;x-signature=9KxnLgCOjhiJuz3fVxCMEyX7xF4%3D" alt="15-03-san_francisco_sunset.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65356317f0f24577b5a6ff6a02b5cca1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771072100&amp;x-signature=mNnpsFZmYE72CJ4gpblK91wVhR8%3D" alt="15-04-singapore_neon_cyberpunk.png" loading="lazy"/></p>
<h3 data-id="heading-9">ä½¿ç”¨åœºæ™¯</h3>
<p>MapToPoster é€‚ç”¨äºå¤šç§åœºæ™¯ï¼š</p>
<ol>
<li>
<p><strong>ä¸ªäººæ”¶è—å’Œè£…é¥°</strong></p>
<ul>
<li>åˆ¶ä½œä½ å±…ä½è¿‡æˆ–å–œæ¬¢çš„åŸå¸‚åœ°å›¾æµ·æŠ¥</li>
<li>ä½œä¸ºæˆ¿é—´è£…é¥°æˆ–ç¤¼ç‰©é€ç»™æœ‹å‹</li>
<li>è®°å½•æ—…è¡Œè¶³è¿¹ï¼Œåˆ¶ä½œåŸå¸‚ç³»åˆ—æµ·æŠ¥</li>
</ul>
</li>
<li>
<p><strong>è®¾è®¡å’Œè‰ºæœ¯åˆ›ä½œ</strong></p>
<ul>
<li>è®¾è®¡å¸ˆè·å–åŸå¸‚åœ°å›¾ç´ æ</li>
<li>è‰ºæœ¯é¡¹ç›®ä¸­çš„åœ°å›¾å…ƒç´ </li>
<li>å“ç‰Œè®¾è®¡ä¸­çš„åœ°ç†å…ƒç´ </li>
</ul>
</li>
<li>
<p><strong>æ•™è‚²å’Œå±•ç¤º</strong></p>
<ul>
<li>åœ°ç†æ•™å­¦ä¸­çš„å¯è§†åŒ–å·¥å…·</li>
<li>åŸå¸‚è§„åˆ’å±•ç¤º</li>
<li>æ•°æ®å¯è§†åŒ–é¡¹ç›®</li>
</ul>
</li>
<li>
<p><strong>æ‰¹é‡ç”Ÿæˆ</strong></p>
<ul>
<li>ä¸ºå¤šä¸ªåŸå¸‚ç”Ÿæˆç»Ÿä¸€é£æ ¼çš„æµ·æŠ¥</li>
<li>æµ‹è¯•ä¸åŒä¸»é¢˜æ•ˆæœ</li>
<li>åˆ›å»ºåŸå¸‚å¯¹æ¯”ç³»åˆ—</li>
</ul>
</li>
</ol>
<h3 data-id="heading-10">å¿«é€Ÿå¼€å§‹</h3>
<h4 data-id="heading-11">å®‰è£…æ–¹å¼</h4>
<p>MapToPoster çš„å®‰è£…éå¸¸ç®€å•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. å…‹éš†é¡¹ç›®</span>
git <span class="hljs-built_in">clone</span> https://github.com/originalankur/maptoposter.git
<span class="hljs-built_in">cd</span> maptoposter

<span class="hljs-comment"># 2. å®‰è£…ä¾èµ–</span>
pip install -r requirements.txt

<span class="hljs-comment"># æˆ–è€…ä½¿ç”¨ pyproject.toml</span>
pip install -e .
</code></pre>
<p><strong>ä¸»è¦ä¾èµ–</strong>ï¼š</p>
<ul>
<li><code>osmnx</code>ï¼šè·å– OpenStreetMap æ•°æ®</li>
<li><code>matplotlib</code>ï¼šåœ°å›¾æ¸²æŸ“</li>
<li><code>geopy</code>ï¼šåœ°ç†ç¼–ç ï¼ˆé€šè¿‡ Nominatimï¼‰</li>
<li><code>requests</code>ï¼šGoogle Fonts API è°ƒç”¨</li>
</ul>
<h4 data-id="heading-12">æœ€ç®€å•çš„ä½¿ç”¨ç¤ºä¾‹</h4>
<p>ç”Ÿæˆä¸€å¼ å·´é»çš„æç®€é»‘ç™½é£æ ¼æµ·æŠ¥ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python create_map_poster.py -c <span class="hljs-string">"Paris"</span> -C <span class="hljs-string">"France"</span> -t noir -d 10000
</code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šï¼š</p>
<ul>
<li>æŸ¥æ‰¾å·´é»çš„åæ ‡ï¼ˆé€šè¿‡ Nominatim åœ°ç†ç¼–ç ï¼‰</li>
<li>è·å–åŠå¾„10kmèŒƒå›´å†…çš„é“è·¯ç½‘ç»œ</li>
<li>ä½¿ç”¨ <code>noir</code> ä¸»é¢˜ï¼ˆçº¯é»‘èƒŒæ™¯ï¼Œç™½è‰²é“è·¯ï¼‰</li>
<li>ç”Ÿæˆæµ·æŠ¥å¹¶ä¿å­˜åˆ° <code>posters/</code> ç›®å½•</li>
</ul>
<p><strong>è¾“å‡ºæ–‡ä»¶æ ¼å¼</strong>ï¼š<code>Paris_noir_20260208_143022.png</code></p>
<h4 data-id="heading-13">å¸¸ç”¨å‘½ä»¤ç¤ºä¾‹</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç”Ÿæˆä¸åŒä¸»é¢˜çš„æµ·æŠ¥</span>
python create_map_poster.py -c <span class="hljs-string">"Tokyo"</span> -C <span class="hljs-string">"Japan"</span> -t neon_cyberpunk -d 15000
python create_map_poster.py -c <span class="hljs-string">"London"</span> -C <span class="hljs-string">"UK"</span> -t noir -d 15000
python create_map_poster.py -c <span class="hljs-string">"New York"</span> -C <span class="hljs-string">"USA"</span> -t blueprint -d 12000

<span class="hljs-comment"># ä½¿ç”¨è‡ªå®šä¹‰åæ ‡</span>
python create_map_poster.py --city <span class="hljs-string">"Shanghai"</span> --country <span class="hljs-string">"China"</span> \
  -lat 31.2304 -long 121.4737 -t sunset -d 10000

<span class="hljs-comment"># æŸ¥çœ‹æ‰€æœ‰å¯ç”¨ä¸»é¢˜</span>
python create_map_poster.py --list-themes

<span class="hljs-comment"># ä¸ºåŒä¸€åŸå¸‚ç”Ÿæˆæ‰€æœ‰ä¸»é¢˜</span>
python create_map_poster.py -c <span class="hljs-string">"Paris"</span> -C <span class="hljs-string">"France"</span> --all-themes -d 10000
</code></pre>
<h3 data-id="heading-14">æ ¸å¿ƒç‰¹æ€§</h3>
<p>MapToPoster çš„æ ¸å¿ƒç‰¹æ€§åŒ…æ‹¬ï¼š</p>
<ol>
<li>
<p><strong>17ç§ç²¾ç¾ä¸»é¢˜</strong></p>
<ul>
<li>ä»æç®€é»‘ç™½ï¼ˆnoirï¼‰åˆ°éœ“è™¹èµ›åšæœ‹å…‹ï¼ˆneon_cyberpunkï¼‰</li>
<li>æ¯ä¸ªä¸»é¢˜éƒ½æœ‰ç‹¬ç‰¹çš„é…è‰²æ–¹æ¡ˆå’Œè®¾è®¡ç†å¿µ</li>
<li>æ”¯æŒè‡ªå®šä¹‰ä¸»é¢˜ JSON æ–‡ä»¶</li>
</ul>
</li>
<li>
<p><strong>æ™ºèƒ½é“è·¯åˆ†çº§</strong></p>
<ul>
<li>æ ¹æ® OSM çš„ highway æ ‡ç­¾è‡ªåŠ¨åˆ†çº§</li>
<li>ä¸åŒç­‰çº§é“è·¯ä½¿ç”¨ä¸åŒé¢œè‰²å’Œå®½åº¦</li>
<li>å‘ˆç°æ¸…æ™°çš„é“è·¯å±‚æ¬¡ç»“æ„</li>
</ul>
</li>
<li>
<p><strong>çµæ´»çš„è·ç¦»æ§åˆ¶</strong></p>
<ul>
<li>æ”¯æŒ 4000m åˆ° 20000m+ çš„è·ç¦»èŒƒå›´</li>
<li>æ ¹æ®åŸå¸‚è§„æ¨¡æ¨èåˆé€‚çš„è·ç¦»</li>
<li>å¹³è¡¡ç»†èŠ‚å’Œæ•´ä½“æ•ˆæœ</li>
</ul>
</li>
<li>
<p><strong>å­—ä½“ç®¡ç†</strong></p>
<ul>
<li>é»˜è®¤ä½¿ç”¨ Roboto å­—ä½“</li>
<li>æ”¯æŒ Google Fonts è‡ªåŠ¨ä¸‹è½½</li>
<li>è‡ªåŠ¨æ£€æµ‹æ–‡æœ¬è„šæœ¬ï¼Œåº”ç”¨åˆé€‚çš„æ’ç‰ˆ</li>
</ul>
</li>
<li>
<p><strong>é«˜è´¨é‡æ¸²æŸ“</strong></p>
<ul>
<li>é»˜è®¤ 300 DPIï¼Œé€‚åˆæ‰“å°</li>
<li>æ”¯æŒè‡ªå®šä¹‰ DPI è®¾ç½®</li>
<li>ä¼˜åŒ–çš„æ¸²æŸ“æ€§èƒ½</li>
</ul>
</li>
<li>
<p><strong>åœ°ç†ç¼–ç é›†æˆ</strong></p>
<ul>
<li>é€šè¿‡ Nominatim è‡ªåŠ¨æŸ¥æ‰¾åŸå¸‚åæ ‡</li>
<li>æ”¯æŒåŸå¸‚å+å›½å®¶åç»„åˆ</li>
<li>æ”¯æŒç›´æ¥æŒ‡å®šç»çº¬åº¦åæ ‡</li>
</ul>
</li>
</ol>
<h3 data-id="heading-15">é¡¹ç›®ä¼˜åŠ¿</h3>
<p>ä¸å…¶ä»–åœ°å›¾å¯è§†åŒ–å·¥å…·ç›¸æ¯”ï¼ŒMapToPoster çš„ä¼˜åŠ¿ï¼š</p>





























































<table><thead><tr><th align="left">å¯¹æ¯”é¡¹</th><th align="left">MapToPoster</th><th align="left">Google Maps API</th><th align="left">Mapbox</th><th align="left">å…¶ä»–å¼€æºå·¥å…·</th></tr></thead><tbody><tr><td align="left"><strong>æˆæœ¬</strong></td><td align="left">å®Œå…¨å…è´¹</td><td align="left">æŒ‰ä½¿ç”¨é‡æ”¶è´¹</td><td align="left">æŒ‰ä½¿ç”¨é‡æ”¶è´¹</td><td align="left">å…è´¹ä½†åŠŸèƒ½æœ‰é™</td></tr><tr><td align="left"><strong>æ•°æ®æ¥æº</strong></td><td align="left">OpenStreetMapï¼ˆå¼€æºï¼‰</td><td align="left">Google ä¸“æœ‰</td><td align="left">Mapbox ä¸“æœ‰</td><td align="left">å¤šç§æ¥æº</td></tr><tr><td align="left"><strong>å¯å®šåˆ¶æ€§</strong></td><td align="left">é«˜åº¦å¯å®šåˆ¶</td><td align="left">æœ‰é™å®šåˆ¶</td><td align="left">ä¸­ç­‰å®šåˆ¶</td><td align="left">é€šå¸¸è¾ƒä½</td></tr><tr><td align="left"><strong>ä¸»é¢˜æ”¯æŒ</strong></td><td align="left">17ç§ç²¾ç¾ä¸»é¢˜</td><td align="left">æœ‰é™æ ·å¼</td><td align="left">éœ€è¦è®¾è®¡</td><td align="left">é€šå¸¸æ— ä¸»é¢˜</td></tr><tr><td align="left"><strong>ä»£ç æ§åˆ¶</strong></td><td align="left">å®Œå…¨å¯ç¼–ç¨‹</td><td align="left">API è°ƒç”¨</td><td align="left">API è°ƒç”¨</td><td align="left">éƒ¨åˆ†å¯ç¼–ç¨‹</td></tr><tr><td align="left"><strong>è¾“å‡ºè´¨é‡</strong></td><td align="left">é«˜åˆ†è¾¨ç‡ PNG</td><td align="left">éœ€è¦å¤„ç†</td><td align="left">éœ€è¦å¤„ç†</td><td align="left">é€šå¸¸è¾ƒä½</td></tr><tr><td align="left"><strong>ç¦»çº¿ä½¿ç”¨</strong></td><td align="left">æ”¯æŒï¼ˆéœ€ç¼“å­˜ï¼‰</td><td align="left">ä¸æ”¯æŒ</td><td align="left">ä¸æ”¯æŒ</td><td align="left">éƒ¨åˆ†æ”¯æŒ</td></tr></tbody></table>
<p><strong>ä¸ºä»€ä¹ˆé€‰æ‹© MapToPosterï¼Ÿ</strong></p>
<ul>
<li>âœ… <strong>å®Œå…¨å…è´¹</strong>ï¼šåŸºäºå¼€æºæ•°æ®ï¼Œæ—  API è´¹ç”¨</li>
<li>âœ… <strong>é«˜åº¦å¯å®šåˆ¶</strong>ï¼šä»£ç å¼€æºï¼Œå¯ä¿®æ”¹ä»»ä½•ç»†èŠ‚</li>
<li>âœ… <strong>ç²¾ç¾ä¸»é¢˜</strong>ï¼š17ç§ä¸“ä¸šè®¾è®¡çš„ä¸»é¢˜ï¼Œå¼€ç®±å³ç”¨</li>
<li>âœ… <strong>ç®€å•æ˜“ç”¨</strong>ï¼šä¸€æ¡å‘½ä»¤å³å¯ç”Ÿæˆæµ·æŠ¥</li>
<li>âœ… <strong>é«˜è´¨é‡è¾“å‡º</strong>ï¼šé€‚åˆæ‰“å°å’Œå±•ç¤ºçš„é«˜åˆ†è¾¨ç‡å›¾ç‰‡</li>
<li>âœ… <strong>æ´»è·ƒç¤¾åŒº</strong>ï¼š9.8k+ Starsï¼ŒæŒç»­æ›´æ–°å’Œç»´æŠ¤</li>
</ul>
<hr/>
<h2 data-id="heading-16">é¡¹ç›®è¯¦ç»†å‰–æ</h2>
<h3 data-id="heading-17">æ¶æ„è®¾è®¡</h3>
<p>MapToPoster çš„æ•´ä½“æ¶æ„éå¸¸æ¸…æ™°ï¼Œä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ¨¡å—ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CLI Parser    â”‚â”€â”€â”€â”€â–¶â”‚  Geocoding   â”‚â”€â”€â”€â”€â–¶â”‚  Data Fetching  â”‚
â”‚   (argparse)    â”‚     â”‚  (Nominatim) â”‚     â”‚    (OSMnx)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â–¼
                        â”‚    Output    â”‚â—€â”€â”€â”€â”€â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  (PNG File)  â”‚     â”‚   Rendering     â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  (matplotlib)   â”‚
                                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>æ ¸å¿ƒæµç¨‹</strong>ï¼š</p>
<ol>
<li><strong>å‘½ä»¤è¡Œè§£æ</strong>ï¼šä½¿ç”¨ <code>argparse</code> è§£æç”¨æˆ·è¾“å…¥çš„åŸå¸‚ã€ä¸»é¢˜ã€è·ç¦»ç­‰å‚æ•°</li>
<li><strong>åœ°ç†ç¼–ç </strong>ï¼šé€šè¿‡ Nominatim API å°†åŸå¸‚åè½¬æ¢ä¸ºç»çº¬åº¦åæ ‡</li>
<li><strong>æ•°æ®è·å–</strong>ï¼šä½¿ç”¨ OSMnx ä» OpenStreetMap è·å–é“è·¯ç½‘ç»œæ•°æ®</li>
<li><strong>ä¸»é¢˜åŠ è½½</strong>ï¼šä» JSON æ–‡ä»¶åŠ è½½ä¸»é¢˜é…ç½®</li>
<li><strong>åœ°å›¾æ¸²æŸ“</strong>ï¼šä½¿ç”¨ matplotlib æŒ‰ç…§ä¸»é¢˜é…ç½®æ¸²æŸ“åœ°å›¾</li>
<li><strong>æ–‡ä»¶ä¿å­˜</strong>ï¼šå°†æ¸²æŸ“ç»“æœä¿å­˜ä¸º PNG æ–‡ä»¶</li>
</ol>
<h3 data-id="heading-18">æ ¸å¿ƒæ¨¡å—åˆ†æ</h3>
<h4 data-id="heading-19">1. åœ°ç†ç¼–ç æ¨¡å—</h4>
<p>MapToPoster ä½¿ç”¨ Nominatimï¼ˆOpenStreetMap çš„åœ°ç†ç¼–ç æœåŠ¡ï¼‰æ¥æŸ¥æ‰¾åŸå¸‚åæ ‡ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ ¸å¿ƒåŠŸèƒ½ï¼šget_coordinates()</span>
<span class="hljs-comment"># è¾“å…¥ï¼šåŸå¸‚åã€å›½å®¶å</span>
<span class="hljs-comment"># è¾“å‡ºï¼šç»çº¬åº¦åæ ‡</span>

<span class="hljs-comment"># ç¤ºä¾‹è°ƒç”¨</span>
coordinates = get_coordinates(<span class="hljs-string">"Paris"</span>, <span class="hljs-string">"France"</span>)
<span class="hljs-comment"># è¿”å›ï¼š(48.8566, 2.3522)</span>
</code></pre>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>å…è´¹ä½¿ç”¨ï¼Œæ— éœ€ API Key</li>
<li>æ”¯æŒåŸå¸‚å+å›½å®¶åç»„åˆï¼Œæé«˜å‡†ç¡®æ€§</li>
<li>æ”¯æŒç›´æ¥æŒ‡å®šç»çº¬åº¦ï¼Œè·³è¿‡åœ°ç†ç¼–ç </li>
</ul>
<h4 data-id="heading-20">2. æ•°æ®è·å–æ¨¡å—ï¼ˆOSMnxï¼‰</h4>
<p>OSMnx æ˜¯ MapToPoster çš„æ ¸å¿ƒä¾èµ–ï¼Œç”¨äºè·å– OpenStreetMap æ•°æ®ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ ¸å¿ƒåŠŸèƒ½ï¼šè·å–é“è·¯ç½‘ç»œ</span>
<span class="hljs-keyword">import</span> osmnx <span class="hljs-keyword">as</span> ox

<span class="hljs-comment"># ä»ç‚¹åæ ‡è·å–é“è·¯ç½‘ç»œ</span>
G = ox.graph_from_point(
    point=(lat, lon),
    dist=distance,  <span class="hljs-comment"># è·ç¦»ï¼ˆç±³ï¼‰</span>
    network_type=<span class="hljs-string">'drive'</span>  <span class="hljs-comment"># é“è·¯ç±»å‹</span>
)

<span class="hljs-comment"># è·å–æ°´åŸŸå’Œå…¬å›­æ•°æ®</span>
water = ox.features_from_point(
    point=(lat, lon),
    tags={<span class="hljs-string">'natural'</span>: <span class="hljs-string">'water'</span>},
    dist=distance
)
parks = ox.features_from_point(
    point=(lat, lon),
    tags={<span class="hljs-string">'leisure'</span>: <span class="hljs-string">'park'</span>},
    dist=distance
)
</code></pre>
<p><strong>æ•°æ®å±‚æ¬¡</strong>ï¼š</p>
<ul>
<li><strong>é“è·¯ç½‘ç»œ</strong>ï¼šä¸åŒç­‰çº§çš„é“è·¯ï¼ˆmotorway, primary, secondary, tertiary, residentialï¼‰</li>
<li><strong>æ°´åŸŸ</strong>ï¼šæ²³æµã€æ¹–æ³Šç­‰æ°´ä½“</li>
<li><strong>å…¬å›­</strong>ï¼šç»¿åœ°ã€å…¬å›­ç­‰åŒºåŸŸ</li>
</ul>
<h4 data-id="heading-21">3. ä¸»é¢˜ç³»ç»Ÿ</h4>
<p>MapToPoster çš„ä¸»é¢˜ç³»ç»Ÿéå¸¸çµæ´»ï¼Œæ¯ä¸ªä¸»é¢˜æ˜¯ä¸€ä¸ª JSON æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Noir"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Pure black background, white roads"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"bg"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#000000"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#FFFFFF"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"gradient_color"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#000000"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"water"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#1A1A1A"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"parks"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#0A0A0A"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_motorway"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#FFFFFF"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_primary"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#F0F0F0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_secondary"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#E0E0E0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_tertiary"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#D0D0D0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_residential"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#C0C0C0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_default"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#D0D0D0"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>ä¸»é¢˜é…ç½®é¡¹</strong>ï¼š</p>
<ul>
<li><code>bg</code>ï¼šèƒŒæ™¯è‰²</li>
<li><code>text</code>ï¼šæ–‡æœ¬é¢œè‰²</li>
<li><code>water</code>ï¼šæ°´åŸŸé¢œè‰²</li>
<li><code>parks</code>ï¼šå…¬å›­é¢œè‰²</li>
<li><code>road_*</code>ï¼šä¸åŒç­‰çº§é“è·¯çš„é¢œè‰²</li>
</ul>
<p><strong>17ç§ä¸»é¢˜æ¦‚è§ˆ</strong>ï¼š</p>































































































<table><thead><tr><th align="left">ä¸»é¢˜åç§°</th><th align="left">é£æ ¼æè¿°</th><th align="left">é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td align="left"><code>noir</code></td><td align="left">çº¯é»‘èƒŒæ™¯ï¼Œç™½è‰²é“è·¯</td><td align="left">æç®€ä¸»ä¹‰ï¼Œç°ä»£é£æ ¼</td></tr><tr><td align="left"><code>midnight_blue</code></td><td align="left">æ·±è“èƒŒæ™¯ï¼Œé‡‘è‰²é“è·¯</td><td align="left">ä¼˜é›…ï¼Œå•†åŠ¡é£æ ¼</td></tr><tr><td align="left"><code>blueprint</code></td><td align="left">å»ºç­‘è“å›¾é£æ ¼</td><td align="left">å»ºç­‘ï¼Œå·¥ç¨‹ä¸»é¢˜</td></tr><tr><td align="left"><code>neon_cyberpunk</code></td><td align="left">éœ“è™¹èµ›åšæœ‹å…‹</td><td align="left">ç§‘æŠ€ï¼Œæœªæ¥æ„Ÿ</td></tr><tr><td align="left"><code>gradient_roads</code></td><td align="left">æ¸å˜é“è·¯ç€è‰²</td><td align="left">è‰ºæœ¯ï¼Œåˆ›æ„</td></tr><tr><td align="left"><code>contrast_zones</code></td><td align="left">é«˜å¯¹æ¯”åº¦åŸå¸‚å¯†åº¦</td><td align="left">å¼ºè°ƒåŸå¸‚ç»“æ„</td></tr><tr><td align="left"><code>warm_beige</code></td><td align="left">å¤å¤æ£•è¤è‰²è°ƒ</td><td align="left">æ€€æ—§ï¼Œå¤å¤é£æ ¼</td></tr><tr><td align="left"><code>pastel_dream</code></td><td align="left">æŸ”å’Œç²‰å½©è‰²</td><td align="left">æŸ”å’Œï¼Œæ¢¦å¹»</td></tr><tr><td align="left"><code>japanese_ink</code></td><td align="left">æ—¥å¼æ°´å¢¨é£æ ¼</td><td align="left">ä¸œæ–¹ç¾å­¦</td></tr><tr><td align="left"><code>emerald</code></td><td align="left">ç¿ ç»¿è‰²è°ƒ</td><td align="left">è‡ªç„¶ï¼Œç”Ÿæ€</td></tr><tr><td align="left"><code>forest</code></td><td align="left">æ·±ç»¿å’Œé¼ å°¾è‰ç»¿</td><td align="left">è‡ªç„¶ï¼Œæ£®æ—ä¸»é¢˜</td></tr><tr><td align="left"><code>ocean</code></td><td align="left">è“è‰²å’Œé’ç»¿è‰²</td><td align="left">æ²¿æµ·åŸå¸‚</td></tr><tr><td align="left"><code>terracotta</code></td><td align="left">åœ°ä¸­æµ·æš–è‰²è°ƒ</td><td align="left">åœ°ä¸­æµ·é£æ ¼</td></tr><tr><td align="left"><code>sunset</code></td><td align="left">æš–æ©™å’Œç²‰è‰²</td><td align="left">æ¸©æš–ï¼Œæµªæ¼«</td></tr><tr><td align="left"><code>autumn</code></td><td align="left">ç§‹å¶æ©™çº¢è‰²</td><td align="left">å­£èŠ‚ä¸»é¢˜</td></tr><tr><td align="left"><code>copper_patina</code></td><td align="left">æ°§åŒ–é“œç¾å­¦</td><td align="left">å·¥ä¸šï¼Œé‡‘å±æ„Ÿ</td></tr><tr><td align="left"><code>monochrome_blue</code></td><td align="left">å•è‰²è“è‰²ç³»</td><td align="left">ç»Ÿä¸€ï¼Œç®€æ´</td></tr></tbody></table>
<h4 data-id="heading-22">4. æ¸²æŸ“ç³»ç»Ÿ</h4>
<p>MapToPoster çš„æ¸²æŸ“ç³»ç»Ÿä½¿ç”¨ matplotlibï¼ŒæŒ‰ç…§ç‰¹å®šçš„å±‚æ¬¡é¡ºåºæ¸²æŸ“ï¼š</p>
<p><strong>æ¸²æŸ“å±‚æ¬¡ï¼ˆz-orderï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">z</span>=<span class="hljs-number">11</span>  æ–‡æœ¬æ ‡ç­¾ï¼ˆåŸå¸‚åã€å›½å®¶åã€åæ ‡ï¼‰
<span class="hljs-attr">z</span>=<span class="hljs-number">10</span>  æ¸å˜é®ç½©ï¼ˆé¡¶éƒ¨å’Œåº•éƒ¨æ¸å˜æ•ˆæœï¼‰
<span class="hljs-attr">z</span>=<span class="hljs-number">3</span>   é“è·¯ç½‘ç»œï¼ˆé€šè¿‡ ox.plot_graphï¼‰
<span class="hljs-attr">z</span>=<span class="hljs-number">2</span>   å…¬å›­ï¼ˆç»¿è‰²å¤šè¾¹å½¢ï¼‰
<span class="hljs-attr">z</span>=<span class="hljs-number">1</span>   æ°´åŸŸï¼ˆè“è‰²å¤šè¾¹å½¢ï¼‰
<span class="hljs-attr">z</span>=<span class="hljs-number">0</span>   èƒŒæ™¯è‰²
</code></pre>
<p><strong>é“è·¯åˆ†çº§æ¸²æŸ“</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ ¹æ®é“è·¯ç±»å‹è®¾ç½®é¢œè‰²å’Œå®½åº¦</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_edge_colors_by_type</span>(<span class="hljs-params">edge_types, theme</span>):
    colors = []
    <span class="hljs-keyword">for</span> edge_type <span class="hljs-keyword">in</span> edge_types:
        <span class="hljs-keyword">if</span> <span class="hljs-string">'motorway'</span> <span class="hljs-keyword">in</span> edge_type:
            colors.append(theme[<span class="hljs-string">'road_motorway'</span>])
        <span class="hljs-keyword">elif</span> <span class="hljs-string">'primary'</span> <span class="hljs-keyword">in</span> edge_type <span class="hljs-keyword">or</span> <span class="hljs-string">'trunk'</span> <span class="hljs-keyword">in</span> edge_type:
            colors.append(theme[<span class="hljs-string">'road_primary'</span>])
        <span class="hljs-keyword">elif</span> <span class="hljs-string">'secondary'</span> <span class="hljs-keyword">in</span> edge_type:
            colors.append(theme[<span class="hljs-string">'road_secondary'</span>])
        <span class="hljs-keyword">elif</span> <span class="hljs-string">'tertiary'</span> <span class="hljs-keyword">in</span> edge_type:
            colors.append(theme[<span class="hljs-string">'road_tertiary'</span>])
        <span class="hljs-keyword">elif</span> <span class="hljs-string">'residential'</span> <span class="hljs-keyword">in</span> edge_type:
            colors.append(theme[<span class="hljs-string">'road_residential'</span>])
        <span class="hljs-keyword">else</span>:
            colors.append(theme[<span class="hljs-string">'road_default'</span>])
    <span class="hljs-keyword">return</span> colors
</code></pre>
<p><strong>é“è·¯å®½åº¦åˆ†çº§</strong>ï¼š</p>
<ul>
<li><code>motorway, motorway_link</code>ï¼šæœ€ç²—ï¼ˆ1.2ï¼‰ï¼Œæœ€æ·±è‰²</li>
<li><code>trunk, primary</code>ï¼šç²—ï¼ˆ1.0ï¼‰</li>
<li><code>secondary</code>ï¼šä¸­ç­‰ï¼ˆ0.8ï¼‰</li>
<li><code>tertiary</code>ï¼šç»†ï¼ˆ0.6ï¼‰</li>
<li><code>residential, living_street</code>ï¼šæœ€ç»†ï¼ˆ0.4ï¼‰ï¼Œæœ€æµ…è‰²</li>
</ul>
<h4 data-id="heading-23">5. å­—ä½“ç®¡ç†ç³»ç»Ÿ</h4>
<p>MapToPoster åŒ…å«ä¸€ä¸ªæ™ºèƒ½çš„å­—ä½“ç®¡ç†ç³»ç»Ÿï¼š</p>
<p><strong>å­—ä½“åŠ è½½é€»è¾‘</strong>ï¼š</p>
<ol>
<li>ä¼˜å…ˆä½¿ç”¨æœ¬åœ°å­—ä½“ï¼ˆ<code>fonts/</code> ç›®å½•ï¼‰</li>
<li>å¦‚æœæœ¬åœ°æ²¡æœ‰ï¼Œä» Google Fonts ä¸‹è½½</li>
<li>è‡ªåŠ¨ç¼“å­˜ä¸‹è½½çš„å­—ä½“åˆ° <code>fonts/cache/</code> ç›®å½•</li>
</ol>
<p><strong>è„šæœ¬æ£€æµ‹</strong>ï¼š</p>
<ul>
<li>è‡ªåŠ¨æ£€æµ‹æ–‡æœ¬æ˜¯å¦ä¸ºæ‹‰ä¸è„šæœ¬</li>
<li>æ‹‰ä¸è„šæœ¬ï¼šåº”ç”¨å­—æ¯é—´è·ï¼Œå‘ˆç° "P A R I S" æ•ˆæœ</li>
<li>éæ‹‰ä¸è„šæœ¬ï¼ˆä¸­æ–‡ã€æ—¥æ–‡ã€é˜¿æ‹‰ä¼¯æ–‡ç­‰ï¼‰ï¼šä½¿ç”¨è‡ªç„¶é—´è·</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_latin_script</span>(<span class="hljs-params">text</span>):
    <span class="hljs-string">"""æ£€æµ‹æ–‡æœ¬æ˜¯å¦ä¸ºæ‹‰ä¸è„šæœ¬"""</span>
    latin_chars = <span class="hljs-built_in">sum</span>(<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> text <span class="hljs-keyword">if</span> <span class="hljs-string">'\u0000'</span> &lt;= c &lt;= <span class="hljs-string">'\u024F'</span>)
    total_chars = <span class="hljs-built_in">sum</span>(<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> text <span class="hljs-keyword">if</span> c.isalpha())
    <span class="hljs-keyword">return</span> (latin_chars / total_chars) &gt; <span class="hljs-number">0.8</span> <span class="hljs-keyword">if</span> total_chars &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-literal">False</span>
</code></pre>
<h3 data-id="heading-24">å…³é”®æŠ€æœ¯å®ç°</h3>
<h4 data-id="heading-25">1. æ¸å˜é®ç½©æ•ˆæœ</h4>
<p>MapToPoster åœ¨é¡¶éƒ¨å’Œåº•éƒ¨æ·»åŠ æ¸å˜é®ç½©ï¼Œå¢å¼ºè§†è§‰æ•ˆæœï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">create_gradient_fade</span>(<span class="hljs-params">ax, position=<span class="hljs-string">'top'</span>, height=<span class="hljs-number">0.15</span></span>):
    <span class="hljs-string">"""åˆ›å»ºæ¸å˜é®ç½©"""</span>
    <span class="hljs-keyword">if</span> position == <span class="hljs-string">'top'</span>:
        y_start, y_end = <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span> - height
    <span class="hljs-keyword">else</span>:
        y_start, y_end = height, <span class="hljs-number">0.0</span>
    
    <span class="hljs-comment"># åˆ›å»ºæ¸å˜</span>
    gradient = np.linspace(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">256</span>).reshape(<span class="hljs-number">256</span>, -<span class="hljs-number">1</span>)
    gradient = np.vstack((gradient, gradient))
    
    ax.imshow(
        gradient,
        aspect=<span class="hljs-string">'auto'</span>,
        extent=[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, y_start, y_end],
        cmap=theme[<span class="hljs-string">'gradient_color'</span>],
        alpha=<span class="hljs-number">0.3</span>,
        zorder=<span class="hljs-number">10</span>
    )
</code></pre>
<h4 data-id="heading-26">2. æ–‡æœ¬å®šä½ç³»ç»Ÿ</h4>
<p>æ‰€æœ‰æ–‡æœ¬ä½¿ç”¨å½’ä¸€åŒ–åæ ‡ï¼ˆ0-1èŒƒå›´ï¼‰ï¼Œç¡®ä¿åœ¨ä¸åŒåˆ†è¾¨ç‡ä¸‹ä½ç½®ä¸€è‡´ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ–‡æœ¬ä½ç½®å®šä¹‰</span>
y_city_name = <span class="hljs-number">0.14</span>      <span class="hljs-comment"># åŸå¸‚å</span>
y_decorative_line = <span class="hljs-number">0.125</span>  <span class="hljs-comment"># è£…é¥°çº¿</span>
y_country_name = <span class="hljs-number">0.10</span>    <span class="hljs-comment"># å›½å®¶å</span>
y_coordinates = <span class="hljs-number">0.07</span>     <span class="hljs-comment"># åæ ‡</span>
y_attribution = <span class="hljs-number">0.02</span>     <span class="hljs-comment"># åº•éƒ¨æ ‡æ³¨</span>
</code></pre>
<h4 data-id="heading-27">3. æ€§èƒ½ä¼˜åŒ–æŠ€å·§</h4>
<p><strong>è·ç¦»å‚æ•°å»ºè®®</strong>ï¼š</p>
<ul>
<li>4000-6000mï¼šå°å‹/å¯†é›†åŸå¸‚ï¼ˆå¨å°¼æ–¯ã€é˜¿å§†æ–¯ç‰¹ä¸¹å¸‚ä¸­å¿ƒï¼‰</li>
<li>8000-12000mï¼šä¸­ç­‰åŸå¸‚ï¼Œèšç„¦å¸‚ä¸­å¿ƒï¼ˆå·´é»ã€å·´å¡ç½—é‚£ï¼‰</li>
<li>15000-20000mï¼šå¤§å‹éƒ½å¸‚ï¼Œå®Œæ•´åŸå¸‚è§†å›¾ï¼ˆä¸œäº¬ã€å­Ÿä¹°ï¼‰</li>
</ul>
<p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>å¤§è·ç¦»å€¼ï¼ˆ&gt;20kmï¼‰ä¼šå¯¼è‡´ä¸‹è½½æ…¢ä¸”å†…å­˜å ç”¨é«˜</li>
<li>ç¼“å­˜åæ ‡æ•°æ®ï¼Œé¿å… Nominatim é€Ÿç‡é™åˆ¶</li>
<li>ä½¿ç”¨ <code>network_type='drive'</code> è€Œä¸æ˜¯ <code>'all'</code> ä»¥åŠ å¿«æ¸²æŸ“</li>
<li>é¢„è§ˆæ—¶å¯å°† DPI ä» 300 é™è‡³ 150</li>
</ul>
<hr/>
<h2 data-id="heading-28">å®é™…ä½¿ç”¨æ¡ˆä¾‹</h2>
<h3 data-id="heading-29">æ¡ˆä¾‹1ï¼šåˆ¶ä½œæ—…è¡Œçºªå¿µæµ·æŠ¥ç³»åˆ—</h3>
<p><strong>åœºæ™¯</strong>ï¼šè®°å½•ä¸€æ¬¡æ¬§æ´²ä¹‹æ—…ï¼Œä¸ºæ¯ä¸ªè®¿é—®çš„åŸå¸‚ç”Ÿæˆæµ·æŠ¥ã€‚</p>
<p><strong>å®ç°æ­¥éª¤</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºè„šæœ¬æ‰¹é‡ç”Ÿæˆ</span>
<span class="hljs-comment">#!/bin/bash</span>
cities=(<span class="hljs-string">"Paris:France"</span> <span class="hljs-string">"London:UK"</span> <span class="hljs-string">"Rome:Italy"</span> <span class="hljs-string">"Barcelona:Spain"</span>)
theme=<span class="hljs-string">"noir"</span>

<span class="hljs-keyword">for</span> city_country <span class="hljs-keyword">in</span> <span class="hljs-string">"<span class="hljs-variable">${cities[@]}</span>"</span>; <span class="hljs-keyword">do</span>
    IFS=<span class="hljs-string">':'</span> <span class="hljs-built_in">read</span> -r city country &lt;&lt;&lt; <span class="hljs-string">"<span class="hljs-variable">$city_country</span>"</span>
    python create_map_poster.py -c <span class="hljs-string">"<span class="hljs-variable">$city</span>"</span> -C <span class="hljs-string">"<span class="hljs-variable">$country</span>"</span> -t <span class="hljs-string">"<span class="hljs-variable">$theme</span>"</span> -d 10000
<span class="hljs-keyword">done</span>
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šç”Ÿæˆç»Ÿä¸€é£æ ¼çš„åŸå¸‚ç³»åˆ—æµ·æŠ¥ï¼Œé€‚åˆåˆ¶ä½œç›¸å†Œæˆ–è£…é¥°ã€‚</p>
<h3 data-id="heading-30">æ¡ˆä¾‹2ï¼šä¸ºè®¾è®¡é¡¹ç›®åˆ›å»ºåœ°å›¾ç´ æ</h3>
<p><strong>åœºæ™¯</strong>ï¼šè®¾è®¡å¸ˆéœ€è¦ä¸ºå“ç‰Œé¡¹ç›®åˆ›å»ºåŸå¸‚åœ°å›¾å…ƒç´ ã€‚</p>
<p><strong>å®ç°æ­¥éª¤</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å°è¯•ä¸åŒä¸»é¢˜ï¼Œæ‰¾åˆ°æœ€é€‚åˆå“ç‰Œé£æ ¼çš„</span>
python create_map_poster.py -c <span class="hljs-string">"New York"</span> -C <span class="hljs-string">"USA"</span> --all-themes -d 12000

<span class="hljs-comment"># ç„¶åé€‰æ‹©æœ€åˆé€‚çš„ä¸»é¢˜ï¼Œç”Ÿæˆæœ€ç»ˆç‰ˆæœ¬</span>
python create_map_poster.py -c <span class="hljs-string">"New York"</span> -C <span class="hljs-string">"USA"</span> -t blueprint -d 12000
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šè·å¾—å¤šç§é£æ ¼é€‰æ‹©ï¼Œæ‰¾åˆ°ä¸å“ç‰Œè°ƒæ€§åŒ¹é…çš„åœ°å›¾è®¾è®¡ã€‚</p>
<h3 data-id="heading-31">æ¡ˆä¾‹3ï¼šåŸå¸‚è§„åˆ’å±•ç¤º</h3>
<p><strong>åœºæ™¯</strong>ï¼šåŸå¸‚è§„åˆ’å¸ˆéœ€è¦å±•ç¤ºä¸åŒåŒºåŸŸçš„é“è·¯ç½‘ç»œç»“æ„ã€‚</p>
<p><strong>å®ç°æ­¥éª¤</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨ç²¾ç¡®åæ ‡ï¼Œèšç„¦ç‰¹å®šåŒºåŸŸ</span>
python create_map_poster.py \
  --city <span class="hljs-string">"Shanghai"</span> \
  --country <span class="hljs-string">"China"</span> \
  -lat 31.2304 -long 121.4737 \
  -t contrast_zones \
  -d 8000

<span class="hljs-comment"># å¯¹æ¯”ä¸åŒåŒºåŸŸ</span>
python create_map_poster.py \
  --city <span class="hljs-string">"Shanghai"</span> \
  --country <span class="hljs-string">"China"</span> \
  -lat 31.2000 -long 121.5000 \
  -t contrast_zones \
  -d 8000
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šæ¸…æ™°å±•ç¤ºä¸åŒåŒºåŸŸçš„é“è·¯å¯†åº¦å’Œç»“æ„å·®å¼‚ã€‚</p>
<h3 data-id="heading-32">æ¡ˆä¾‹4ï¼šè‰ºæœ¯åˆ›ä½œé¡¹ç›®</h3>
<p><strong>åœºæ™¯</strong>ï¼šè‰ºæœ¯å®¶éœ€è¦ä¸ºå±•è§ˆåˆ›ä½œåŸå¸‚ä¸»é¢˜ä½œå“ã€‚</p>
<p><strong>å®ç°æ­¥éª¤</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç”ŸæˆåŒä¸€åŸå¸‚çš„å¤šç§ä¸»é¢˜ï¼Œç”¨äºå¯¹æ¯”å’Œé€‰æ‹©</span>
python create_map_poster.py -c <span class="hljs-string">"Tokyo"</span> -C <span class="hljs-string">"Japan"</span> --all-themes -d 15000

<span class="hljs-comment"># é€‰æ‹©æœ€ç¬¦åˆè‰ºæœ¯ç†å¿µçš„ä¸»é¢˜</span>
python create_map_poster.py -c <span class="hljs-string">"Tokyo"</span> -C <span class="hljs-string">"Japan"</span> -t japanese_ink -d 15000
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šè·å¾—å…·æœ‰è‰ºæœ¯æ„Ÿçš„åœ°å›¾è®¾è®¡ï¼Œå¯ç›´æ¥ç”¨äºè‰ºæœ¯åˆ›ä½œã€‚</p>
<hr/>
<h2 data-id="heading-33">é«˜çº§å®šåˆ¶æŠ€å·§</h2>
<h3 data-id="heading-34">1. åˆ›å»ºè‡ªå®šä¹‰ä¸»é¢˜</h3>
<p>åˆ›å»ºè‡ªå®šä¹‰ä¸»é¢˜éå¸¸ç®€å•ï¼Œåªéœ€åœ¨ <code>themes/</code> ç›®å½•ä¸‹åˆ›å»º JSON æ–‡ä»¶ï¼š</p>
<p><strong>æ­¥éª¤1ï¼šåˆ›å»ºä¸»é¢˜æ–‡ä»¶</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// themes/my_custom_theme.json</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"My Custom Theme"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"A custom theme with warm colors"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"bg"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#2C1810"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#F5E6D3"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"gradient_color"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#2C1810"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"water"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#1A4A5C"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"parks"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#3A5A3A"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_motorway"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#E8B86D"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_primary"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#D4A574"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_secondary"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#C0956A"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_tertiary"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#AD8560"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_residential"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#9A7556"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"road_default"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#AD8560"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>æ­¥éª¤2ï¼šä½¿ç”¨è‡ªå®šä¹‰ä¸»é¢˜</strong></p>
<pre><code class="hljs language-bash" lang="bash">python create_map_poster.py -c <span class="hljs-string">"Paris"</span> -C <span class="hljs-string">"France"</span> -t my_custom_theme -d 10000
</code></pre>
<p><strong>ä¸»é¢˜è®¾è®¡å»ºè®®</strong>ï¼š</p>
<ul>
<li>ä¿æŒé“è·¯é¢œè‰²å±‚æ¬¡æ¸…æ™°ï¼ˆmotorway &gt; primary &gt; secondary &gt; tertiary &gt; residentialï¼‰</li>
<li>èƒŒæ™¯è‰²ä¸é“è·¯è‰²å¯¹æ¯”åº¦è¦è¶³å¤Ÿ</li>
<li>è€ƒè™‘æ‰“å°æ•ˆæœï¼Œé¿å…è¿‡äºé²œè‰³çš„é¢œè‰²</li>
<li>å‚è€ƒç°æœ‰ä¸»é¢˜çš„é…è‰²æ–¹æ¡ˆ</li>
</ul>
<h3 data-id="heading-35">2. è°ƒæ•´æ¸²æŸ“å‚æ•°</h3>
<p>MapToPoster æ”¯æŒå¤šç§æ¸²æŸ“å‚æ•°è°ƒæ•´ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åœ¨ create_map_poster.py ä¸­å¯ä»¥è°ƒæ•´çš„å‚æ•°ï¼š</span>

<span class="hljs-comment"># DPI è®¾ç½®ï¼ˆå½±å“è¾“å‡ºåˆ†è¾¨ç‡ï¼‰</span>
dpi = <span class="hljs-number">300</span>  <span class="hljs-comment"># é»˜è®¤300ï¼Œæ‰“å°è´¨é‡</span>
dpi = <span class="hljs-number">150</span>  <span class="hljs-comment"># é¢„è§ˆè´¨é‡ï¼Œç”Ÿæˆæ›´å¿«</span>

<span class="hljs-comment"># å›¾ç‰‡å°ºå¯¸</span>
figsize = (<span class="hljs-number">12</span>, <span class="hljs-number">16</span>)  <span class="hljs-comment"># å®½é«˜æ¯”ï¼Œå¯æ ¹æ®éœ€è¦è°ƒæ•´</span>

<span class="hljs-comment"># å­—ä½“å¤§å°</span>
city_font_size = <span class="hljs-number">72</span>  <span class="hljs-comment"># åŸå¸‚åå­—ä½“</span>
country_font_size = <span class="hljs-number">36</span>  <span class="hljs-comment"># å›½å®¶åå­—ä½“</span>
coord_font_size = <span class="hljs-number">24</span>  <span class="hljs-comment"># åæ ‡å­—ä½“</span>

<span class="hljs-comment"># æ¸å˜é®ç½©é«˜åº¦</span>
gradient_height = <span class="hljs-number">0.15</span>  <span class="hljs-comment"># é¡¶éƒ¨å’Œåº•éƒ¨æ¸å˜åŒºåŸŸé«˜åº¦ï¼ˆ0-1èŒƒå›´ï¼‰</span>
</code></pre>
<h3 data-id="heading-36">3. æ‰¹é‡ç”Ÿæˆè„šæœ¬</h3>
<p>åˆ›å»ºä¸€ä¸ª Python è„šæœ¬æ¥æ‰¹é‡ç”Ÿæˆå¤šä¸ªåŸå¸‚çš„æµ·æŠ¥ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#!/usr/bin/env python3</span>
<span class="hljs-comment"># batch_generate.py</span>

<span class="hljs-keyword">import</span> subprocess
<span class="hljs-keyword">import</span> sys

cities = [
    (<span class="hljs-string">"Paris"</span>, <span class="hljs-string">"France"</span>, <span class="hljs-string">"noir"</span>, <span class="hljs-number">10000</span>),
    (<span class="hljs-string">"Tokyo"</span>, <span class="hljs-string">"Japan"</span>, <span class="hljs-string">"neon_cyberpunk"</span>, <span class="hljs-number">15000</span>),
    (<span class="hljs-string">"New York"</span>, <span class="hljs-string">"USA"</span>, <span class="hljs-string">"blueprint"</span>, <span class="hljs-number">12000</span>),
    (<span class="hljs-string">"London"</span>, <span class="hljs-string">"UK"</span>, <span class="hljs-string">"midnight_blue"</span>, <span class="hljs-number">10000</span>),
]

<span class="hljs-keyword">for</span> city, country, theme, distance <span class="hljs-keyword">in</span> cities:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Generating <span class="hljs-subst">{city}</span> with <span class="hljs-subst">{theme}</span> theme..."</span>)
    cmd = [
        <span class="hljs-string">"python"</span>, <span class="hljs-string">"create_map_poster.py"</span>,
        <span class="hljs-string">"-c"</span>, city,
        <span class="hljs-string">"-C"</span>, country,
        <span class="hljs-string">"-t"</span>, theme,
        <span class="hljs-string">"-d"</span>, <span class="hljs-built_in">str</span>(distance)
    ]
    subprocess.run(cmd)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ“ Completed <span class="hljs-subst">{city}</span>\n"</span>)
</code></pre>
<p>è¿è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python batch_generate.py
</code></pre>
<h3 data-id="heading-37">4. é›†æˆåˆ°å…¶ä»–é¡¹ç›®</h3>
<p>MapToPoster å¯ä»¥ä½œä¸º Python æ¨¡å—å¯¼å…¥ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åœ¨ä½ çš„ Python é¡¹ç›®ä¸­</span>
<span class="hljs-keyword">import</span> sys
sys.path.append(<span class="hljs-string">'/path/to/maptoposter'</span>)

<span class="hljs-keyword">from</span> create_map_poster <span class="hljs-keyword">import</span> create_poster, get_coordinates, load_theme

<span class="hljs-comment"># è·å–åæ ‡</span>
lat, lon = get_coordinates(<span class="hljs-string">"Shanghai"</span>, <span class="hljs-string">"China"</span>)

<span class="hljs-comment"># åŠ è½½ä¸»é¢˜</span>
theme = load_theme(<span class="hljs-string">"noir"</span>)

<span class="hljs-comment"># åˆ›å»ºæµ·æŠ¥</span>
create_poster(
    city=<span class="hljs-string">"Shanghai"</span>,
    country=<span class="hljs-string">"China"</span>,
    lat=lat,
    lon=lon,
    theme_name=<span class="hljs-string">"noir"</span>,
    dist=<span class="hljs-number">10000</span>
)
</code></pre>
<h3 data-id="heading-38">5. æ·»åŠ è‡ªå®šä¹‰åœ°å›¾å…ƒç´ </h3>
<p>å¦‚æœä½ æƒ³æ·»åŠ æ–°çš„åœ°å›¾å…ƒç´ ï¼ˆå¦‚é“è·¯ã€å»ºç­‘ç‰©ç­‰ï¼‰ï¼Œå¯ä»¥ä¿®æ”¹ <code>create_poster()</code> å‡½æ•°ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åœ¨ create_poster() å‡½æ•°ä¸­æ·»åŠ é“è·¯</span>
<span class="hljs-keyword">try</span>:
    railways = ox.features_from_point(
        point=(lat, lon),
        tags={<span class="hljs-string">'railway'</span>: <span class="hljs-string">'rail'</span>},
        dist=distance
    )
    <span class="hljs-keyword">if</span> railways <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> railways.empty:
        railways.plot(
            ax=ax,
            color=theme.get(<span class="hljs-string">'railway'</span>, <span class="hljs-string">'#FF0000'</span>),
            linewidth=<span class="hljs-number">0.5</span>,
            zorder=<span class="hljs-number">2.5</span>  <span class="hljs-comment"># åœ¨é“è·¯ä¸‹æ–¹ï¼Œå…¬å›­ä¸Šæ–¹</span>
        )
<span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Could not fetch railways: <span class="hljs-subst">{e}</span>"</span>)
</code></pre>
<p>è®°å¾—åœ¨ä¸»é¢˜ JSON ä¸­æ·»åŠ å¯¹åº”çš„é¢œè‰²é…ç½®ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"railway"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#FF6B6B"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h2 data-id="heading-39">å¸¸è§é—®é¢˜è§£å†³</h2>
<h3 data-id="heading-40">é—®é¢˜1ï¼šåœ°ç†ç¼–ç å¤±è´¥</h3>
<p><strong>ç—‡çŠ¶</strong>ï¼šæ— æ³•æ‰¾åˆ°åŸå¸‚åæ ‡ï¼ŒæŠ¥é”™ "Could not geocode city"ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>
<p><strong>ä½¿ç”¨æ›´å…·ä½“çš„åŸå¸‚å</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸æ¨è</span>
python create_map_poster.py -c <span class="hljs-string">"NYC"</span> -C <span class="hljs-string">"USA"</span> ...

<span class="hljs-comment"># æ¨è</span>
python create_map_poster.py -c <span class="hljs-string">"New York"</span> -C <span class="hljs-string">"USA"</span> ...
</code></pre>
</li>
<li>
<p><strong>ç›´æ¥æŒ‡å®šåæ ‡</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python create_map_poster.py \
  --city <span class="hljs-string">"Custom Location"</span> \
  --country <span class="hljs-string">"Custom"</span> \
  -lat 40.7128 -long -74.0060 \
  -t noir -d 10000
</code></pre>
</li>
<li>
<p><strong>æ£€æŸ¥ç½‘ç»œè¿æ¥</strong>ï¼šNominatim éœ€è¦ç½‘ç»œè®¿é—®ã€‚</p>
</li>
</ol>
<h3 data-id="heading-41">é—®é¢˜2ï¼šä¸‹è½½æ•°æ®å¤ªæ…¢</h3>
<p><strong>ç—‡çŠ¶</strong>ï¼šè·å–åœ°å›¾æ•°æ®éœ€è¦å¾ˆé•¿æ—¶é—´ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>
<p><strong>å‡å°è·ç¦»èŒƒå›´</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä» 20000m å‡å°åˆ° 10000m</span>
python create_map_poster.py -c <span class="hljs-string">"Tokyo"</span> -C <span class="hljs-string">"Japan"</span> -t noir -d 10000
</code></pre>
</li>
<li>
<p><strong>ä½¿ç”¨ç¼“å­˜</strong>ï¼šOSMnx ä¼šè‡ªåŠ¨ç¼“å­˜æ•°æ®ï¼Œç¬¬äºŒæ¬¡ç”Ÿæˆç›¸åŒåŒºåŸŸä¼šæ›´å¿«ã€‚</p>
</li>
<li>
<p><strong>é€‰æ‹©ç½‘ç»œç±»å‹</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åœ¨ä»£ç ä¸­ä½¿ç”¨ 'drive' è€Œä¸æ˜¯ 'all'</span>
G = ox.graph_from_point(point, dist=distance, network_type=<span class="hljs-string">'drive'</span>)
</code></pre>
</li>
</ol>
<h3 data-id="heading-42">é—®é¢˜3ï¼šç”Ÿæˆçš„æµ·æŠ¥é“è·¯å¤ªå°‘æˆ–å¤ªå¤š</h3>
<p><strong>ç—‡çŠ¶</strong>ï¼šé“è·¯å¯†åº¦ä¸åˆé€‚ï¼Œè¦ä¹ˆå¤ªç¨€ç–ï¼Œè¦ä¹ˆå¤ªå¯†é›†ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>
<p><strong>è°ƒæ•´è·ç¦»å‚æ•°</strong>ï¼š</p>
<ul>
<li>é“è·¯å¤ªå°‘ï¼šå¢å¤§è·ç¦»ï¼ˆå¦‚ä» 8000m åˆ° 12000mï¼‰</li>
<li>é“è·¯å¤ªå¤šï¼šå‡å°è·ç¦»ï¼ˆå¦‚ä» 15000m åˆ° 10000mï¼‰</li>
</ul>
</li>
<li>
<p><strong>è°ƒæ•´ä¸­å¿ƒç‚¹</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¦‚æœå¸‚ä¸­å¿ƒå¤ªå¯†é›†ï¼Œå¯ä»¥ç¨å¾®åç§»ä¸­å¿ƒç‚¹</span>
python create_map_poster.py \
  -c <span class="hljs-string">"Tokyo"</span> -C <span class="hljs-string">"Japan"</span> \
  -lat 35.6762 -long 139.6503 \
  -t noir -d 12000
</code></pre>
</li>
</ol>
<h3 data-id="heading-43">é—®é¢˜4ï¼šå­—ä½“æ˜¾ç¤ºé—®é¢˜</h3>
<p><strong>ç—‡çŠ¶</strong>ï¼šä¸­æ–‡å­—ç¬¦æˆ–ç‰¹æ®Šå­—ç¬¦æ˜¾ç¤ºä¸æ­£ç¡®ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>
<p><strong>æ£€æŸ¥å­—ä½“æ–‡ä»¶</strong>ï¼šç¡®ä¿ <code>fonts/</code> ç›®å½•åŒ…å«æ”¯æŒè¯¥å­—ç¬¦é›†çš„å­—ä½“ã€‚</p>
</li>
<li>
<p><strong>ä½¿ç”¨ Google Fonts</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># font_management.py ä¼šè‡ªåŠ¨ä» Google Fonts ä¸‹è½½å­—ä½“</span>
<span class="hljs-comment"># ç¡®ä¿ç½‘ç»œè¿æ¥æ­£å¸¸</span>
</code></pre>
</li>
<li>
<p><strong>æ‰‹åŠ¨æŒ‡å®šå­—ä½“</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åœ¨ä»£ç ä¸­æŒ‡å®šæ”¯æŒä¸­æ–‡çš„å­—ä½“</span>
font_path = <span class="hljs-string">'/path/to/chinese-font.ttf'</span>
</code></pre>
</li>
</ol>
<h3 data-id="heading-44">é—®é¢˜5ï¼šå†…å­˜ä¸è¶³</h3>
<p><strong>ç—‡çŠ¶</strong>ï¼šç”Ÿæˆå¤§å‹åŸå¸‚åœ°å›¾æ—¶å†…å­˜æº¢å‡ºã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>
<p><strong>å‡å°è·ç¦»èŒƒå›´</strong>ï¼šè¿™æ˜¯æœ€ç›´æ¥çš„æ–¹æ³•ã€‚</p>
</li>
<li>
<p><strong>é™ä½ DPI</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åœ¨ä»£ç ä¸­è®¾ç½®è¾ƒä½çš„ DPI</span>
plt.savefig(output_path, dpi=<span class="hljs-number">150</span>, bbox_inches=<span class="hljs-string">'tight'</span>)
</code></pre>
</li>
<li>
<p><strong>åˆ†æ‰¹å¤„ç†</strong>ï¼šå¯¹äºè¶…å¤§åŒºåŸŸï¼Œå¯ä»¥ç”Ÿæˆå¤šä¸ªå°åŒºåŸŸçš„æµ·æŠ¥ï¼Œç„¶åæ‹¼æ¥ã€‚</p>
</li>
</ol>
<h3 data-id="heading-45">é—®é¢˜6ï¼šä¸»é¢˜é¢œè‰²ä¸ç†æƒ³</h3>
<p><strong>ç—‡çŠ¶</strong>ï¼šç”Ÿæˆçš„æµ·æŠ¥é¢œè‰²å¯¹æ¯”åº¦ä¸å¤Ÿæˆ–ä¸ç¬¦åˆé¢„æœŸã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>
<p><strong>æ£€æŸ¥ä¸»é¢˜ JSON</strong>ï¼šç¡®ä¿é¢œè‰²å€¼æ ¼å¼æ­£ç¡®ï¼ˆ<code>#RRGGBB</code>ï¼‰ã€‚</p>
</li>
<li>
<p><strong>è°ƒæ•´é“è·¯é¢œè‰²å±‚æ¬¡</strong>ï¼šç¡®ä¿ motorway &gt; primary &gt; secondary &gt; tertiary &gt; residential çš„äº®åº¦é€’å‡ã€‚</p>
</li>
<li>
<p><strong>æµ‹è¯•ä¸åŒä¸»é¢˜</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python create_map_poster.py -c <span class="hljs-string">"Paris"</span> -C <span class="hljs-string">"France"</span> --all-themes -d 10000
</code></pre>
</li>
</ol>
<hr/>
<h2 data-id="heading-46">ä¸å…¶ä»–å·¥å…·çš„é›†æˆ</h2>
<h3 data-id="heading-47">1. ä¸å›¾åƒå¤„ç†å·¥å…·é›†æˆ</h3>
<p>ç”Ÿæˆçš„æµ·æŠ¥å¯ä»¥è¿›ä¸€æ­¥ç”¨å›¾åƒå¤„ç†å·¥å…·ä¼˜åŒ–ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨ ImageMagick è°ƒæ•´å¤§å°</span>
convert Paris_noir_*.png -resize 2000x3000 poster_resized.png

<span class="hljs-comment"># ä½¿ç”¨ ImageMagick æ·»åŠ è¾¹æ¡†</span>
convert Paris_noir_*.png -border 50x50 -bordercolor white poster_bordered.png

<span class="hljs-comment"># æ‰¹é‡å¤„ç†</span>
<span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> posters/*.png; <span class="hljs-keyword">do</span>
    convert <span class="hljs-string">"<span class="hljs-variable">$file</span>"</span> -resize 2000x3000 <span class="hljs-string">"resized_<span class="hljs-subst">$(basename $file)</span>"</span>
<span class="hljs-keyword">done</span>
</code></pre>
<h3 data-id="heading-48">2. ä¸ Web åº”ç”¨é›†æˆ</h3>
<p>å¯ä»¥å°† MapToPoster é›†æˆåˆ° Web åº”ç”¨ä¸­ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Flask ç¤ºä¾‹</span>
<span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, send_file
<span class="hljs-keyword">import</span> tempfile
<span class="hljs-keyword">import</span> os

app = Flask(__name__)

<span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">'/generate/&lt;city&gt;/&lt;country&gt;/&lt;theme&gt;'</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_poster</span>(<span class="hljs-params">city, country, theme</span>):
    <span class="hljs-comment"># ç”Ÿæˆæµ·æŠ¥</span>
    output_path = create_poster(city, country, theme_name=theme, dist=<span class="hljs-number">10000</span>)
    
    <span class="hljs-comment"># è¿”å›æ–‡ä»¶</span>
    <span class="hljs-keyword">return</span> send_file(output_path, mimetype=<span class="hljs-string">'image/png'</span>)
</code></pre>
<h3 data-id="heading-49">3. ä¸è‡ªåŠ¨åŒ–å·¥ä½œæµé›†æˆ</h3>
<p>å¯ä»¥é›†æˆåˆ° CI/CD æˆ–å…¶ä»–è‡ªåŠ¨åŒ–æµç¨‹ä¸­ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># GitHub Actions ç¤ºä¾‹</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">Generate</span> <span class="hljs-string">City</span> <span class="hljs-string">Posters</span>

<span class="hljs-attr">on:</span>
  <span class="hljs-attr">schedule:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">cron:</span> <span class="hljs-string">'0 0 * * 1'</span>  <span class="hljs-comment"># æ¯å‘¨ä¸€ç”Ÿæˆ</span>

<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">generate:</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-python@v2</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">python-version:</span> <span class="hljs-string">'3.9'</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">run:</span> <span class="hljs-string">pip</span> <span class="hljs-string">install</span> <span class="hljs-string">-r</span> <span class="hljs-string">requirements.txt</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">run:</span> <span class="hljs-string">python</span> <span class="hljs-string">create_map_poster.py</span> <span class="hljs-string">-c</span> <span class="hljs-string">"Paris"</span> <span class="hljs-string">-C</span> <span class="hljs-string">"France"</span> <span class="hljs-string">-t</span> <span class="hljs-string">noir</span> <span class="hljs-string">-d</span> <span class="hljs-number">10000</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/upload-artifact@v2</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">name:</span> <span class="hljs-string">posters</span>
          <span class="hljs-attr">path:</span> <span class="hljs-string">posters/</span>
</code></pre>
<h3 data-id="heading-50">4. ä¸æ•°æ®å¯è§†åŒ–å·¥å…·ç»“åˆ</h3>
<p>å¯ä»¥å°†ç”Ÿæˆçš„æµ·æŠ¥ä¸å…¶ä»–æ•°æ®å¯è§†åŒ–å·¥å…·ç»“åˆï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä½¿ç”¨ PIL/Pillow æ·»åŠ æ•°æ®å›¾è¡¨</span>
<span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image, ImageDraw, ImageFont

<span class="hljs-comment"># æ‰“å¼€ç”Ÿæˆçš„æµ·æŠ¥</span>
poster = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">'Paris_noir_20260208_143022.png'</span>)
draw = ImageDraw.Draw(poster)

<span class="hljs-comment"># æ·»åŠ è‡ªå®šä¹‰æ ‡æ³¨æˆ–å›¾è¡¨</span>
<span class="hljs-comment"># ... ä½ çš„è‡ªå®šä¹‰ä»£ç  ...</span>

<span class="hljs-comment"># ä¿å­˜</span>
poster.save(<span class="hljs-string">'poster_with_chart.png'</span>)
</code></pre>
<hr/>
<h2 data-id="heading-51">é¡¹ç›®åœ°å€ä¸èµ„æº</h2>
<h3 data-id="heading-52">å®˜æ–¹èµ„æº</h3>
<ul>
<li>ğŸŒŸ <strong>GitHub</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Foriginalankur%2Fmaptoposter" target="_blank" title="https://github.com/originalankur/maptoposter" ref="nofollow noopener noreferrer">github.com/originalankâ€¦</a></li>
</ul>
<hr/>
<h2 data-id="heading-53">é€‚ç”¨äººç¾¤</h2>
<p>MapToPoster é€‚åˆä»¥ä¸‹äººç¾¤ï¼š</p>
<h3 data-id="heading-54">1. è®¾è®¡å¸ˆå’Œè‰ºæœ¯åˆ›ä½œè€…</h3>
<ul>
<li>âœ… éœ€è¦åŸå¸‚åœ°å›¾ç´ æçš„è®¾è®¡å¸ˆ</li>
<li>âœ… åˆ›ä½œåŸå¸‚ä¸»é¢˜è‰ºæœ¯ä½œå“çš„è‰ºæœ¯å®¶</li>
<li>âœ… éœ€è¦æ‰¹é‡ç”Ÿæˆåœ°å›¾è®¾è®¡çš„åˆ›æ„å·¥ä½œè€…</li>
</ul>
<h3 data-id="heading-55">2. Python å¼€å‘è€…</h3>
<ul>
<li>âœ… å¯¹æ•°æ®å¯è§†åŒ–æ„Ÿå…´è¶£çš„å¼€å‘è€…</li>
<li>âœ… å¸Œæœ›å­¦ä¹ åœ°ç†æ•°æ®å¤„ç†æŠ€æœ¯çš„ç¨‹åºå‘˜</li>
<li>âœ… éœ€è¦å°†åœ°å›¾é›†æˆåˆ°é¡¹ç›®ä¸­çš„å¼€å‘è€…</li>
</ul>
<h3 data-id="heading-56">3. åœ°ç†å’ŒåŸå¸‚è§„åˆ’ä¸“ä¸šäººå£«</h3>
<ul>
<li>âœ… åŸå¸‚è§„åˆ’å¸ˆå’Œå»ºç­‘å¸ˆ</li>
<li>âœ… åœ°ç†ä¿¡æ¯ç³»ç»Ÿï¼ˆGISï¼‰å·¥ä½œè€…</li>
<li>âœ… éœ€è¦å±•ç¤ºåŸå¸‚ç»“æ„çš„ä¸“ä¸šäººå£«</li>
</ul>
<h3 data-id="heading-57">4. æ™®é€šç”¨æˆ·</h3>
<ul>
<li>âœ… å¸Œæœ›åˆ¶ä½œä¸ªæ€§åŒ–åŸå¸‚æµ·æŠ¥çš„ç”¨æˆ·</li>
<li>âœ… è®°å½•æ—…è¡Œè¶³è¿¹çš„æ—…è¡Œè€…</li>
<li>âœ… å–œæ¬¢åœ°å›¾å’Œåœ°ç†æ•°æ®çš„çˆ±å¥½è€…</li>
</ul>
<h3 data-id="heading-58">5. æ•™è‚²å·¥ä½œè€…</h3>
<ul>
<li>âœ… åœ°ç†æ•™å¸ˆéœ€è¦å¯è§†åŒ–å·¥å…·</li>
<li>âœ… æ•°æ®å¯è§†åŒ–è¯¾ç¨‹çš„æ•™å­¦</li>
<li>âœ… ç¼–ç¨‹å’Œè®¾è®¡è¯¾ç¨‹çš„é¡¹ç›®ç´ æ</li>
</ul>
<hr/>
<h2 data-id="heading-59">æ€»ç»“</h2>
<p>MapToPoster æ˜¯ä¸€ä¸ªä¼˜ç§€çš„å¼€æºé¡¹ç›®ï¼Œå®ƒå°†å¤æ‚çš„åœ°å›¾æ•°æ®å¤„ç†å’Œç²¾ç¾çš„è§†è§‰è®¾è®¡å®Œç¾ç»“åˆã€‚é€šè¿‡ç®€å•çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œä»»ä½•äººéƒ½å¯ä»¥å°†å–œæ¬¢çš„åŸå¸‚è½¬æ¢æˆç‹¬ç‰¹çš„è‰ºæœ¯ä½œå“ã€‚</p>
<p><strong>é¡¹ç›®äº®ç‚¹å›é¡¾</strong>ï¼š</p>
<ul>
<li>ğŸ¨ <strong>17ç§ç²¾ç¾ä¸»é¢˜</strong>ï¼šä»æç®€åˆ°èµ›åšæœ‹å…‹ï¼Œæ»¡è¶³å„ç§å®¡ç¾éœ€æ±‚</li>
<li>ğŸ—ºï¸ <strong>çœŸå®åœ°å›¾æ•°æ®</strong>ï¼šåŸºäº OpenStreetMapï¼Œæ•°æ®å‡†ç¡®ä¸”å…è´¹</li>
<li>ğŸ <strong>çº¯Pythonå®ç°</strong>ï¼šä»£ç æ¸…æ™°ï¼Œæ˜“äºç†è§£å’Œå®šåˆ¶</li>
<li>ğŸ¯ <strong>ç®€å•æ˜“ç”¨</strong>ï¼šä¸€æ¡å‘½ä»¤å³å¯ç”Ÿæˆæµ·æŠ¥</li>
<li>ğŸ”§ <strong>é«˜åº¦å¯å®šåˆ¶</strong>ï¼šæ”¯æŒè‡ªå®šä¹‰ä¸»é¢˜ã€å­—ä½“ã€å‚æ•°ç­‰</li>
<li>ğŸŒ <strong>å…¨çƒæ”¯æŒ</strong>ï¼šæ”¯æŒä¸–ç•Œä»»ä½•åŸå¸‚çš„é“è·¯ç½‘ç»œ</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>ä¸ªäººæ”¶è—å’Œè£…é¥°</li>
<li>è®¾è®¡å’Œè‰ºæœ¯åˆ›ä½œ</li>
<li>æ•™è‚²å’Œå±•ç¤º</li>
<li>æ‰¹é‡ç”Ÿæˆå’Œè‡ªåŠ¨åŒ–</li>
</ul>
<p><strong>æŠ€æœ¯ä»·å€¼</strong>ï¼š</p>
<ul>
<li>å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Python å¤„ç†åœ°ç†æ•°æ®</li>
<li>æä¾›äº†æ•°æ®å¯è§†åŒ–çš„ä¼˜ç§€å®è·µ</li>
<li>å±•ç¤ºäº†å¼€æºå·¥å…·çš„å¼ºå¤§å’Œçµæ´»æ€§</li>
</ul>
<p>æ— è®ºä½ æ˜¯è®¾è®¡å¸ˆã€å¼€å‘è€…ï¼Œè¿˜æ˜¯æ™®é€šç”¨æˆ·ï¼ŒMapToPoster éƒ½èƒ½å¸®åŠ©ä½ åˆ›é€ å‡ºç‹¬ç‰¹è€Œç²¾ç¾çš„åŸå¸‚åœ°å›¾æµ·æŠ¥ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œå®ƒæ˜¯ä¸€ä¸ªå®Œå…¨å¼€æºçš„é¡¹ç›®ï¼Œä½ å¯ä»¥è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†äº«ã€‚</p>
<hr/>
<p><em>æ¬¢è¿æ¥æˆ‘ä¸­çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fhome.wonlab.top" target="_blank" title="https://home.wonlab.top" ref="nofollow noopener noreferrer">ä¸ªäººä¸»é¡µ</a>æ‰¾åˆ°æ›´å¤šæœ‰ç”¨çš„çŸ¥è¯†å’Œæœ‰è¶£çš„äº§å“</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€22-26ã€‘èœ‰è£ä¸€æ—¥ã€å…¥æ¨Šç¬¼å°”]]></title>    <link>https://juejin.cn/post/7603649945977962515</link>    <guid>https://juejin.cn/post/7603649945977962515</guid>    <pubDate>2026-02-07T11:29:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603649945977962515" data-draft-id="7399986979729080354" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€22-26ã€‘èœ‰è£ä¸€æ—¥ã€å…¥æ¨Šç¬¼å°”"/> <meta itemprop="keywords" content="å…¨æ ˆ,AIç¼–ç¨‹,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-02-07T11:29:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ²ˆäºŒåˆ°ä¸è¡Œ"/> <meta itemprop="url" content="https://juejin.cn/user/1319878954855021"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€22-26ã€‘èœ‰è£ä¸€æ—¥ã€å…¥æ¨Šç¬¼å°”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1319878954855021/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ²ˆäºŒåˆ°ä¸è¡Œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T11:29:36.000Z" title="Sat Feb 07 2026 11:29:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">ä¸»é¢˜</h2>
<p>â€‚â€‚â€‚â€‚è¿™æ˜¯ä¸€æ®µä»22å¹´-26ä¹‹é—´çš„é•¿å‘¨æœŸå¤§é¾„è½¯ä»¶å¿ƒå¢ƒé•¿å‘¨æœŸå†…è€—ç‰‡æ®µ,æœŸé—´çš„è¿‡ç¨‹å‡æ˜¯å½“æ—¶çš„æŒ£æ‰,æ­¤æ—¶ä¸€åˆ‡å‡å·²å¹³æ¯,æ­¤æ—¶å†åšå›æº¯ï¼Œ<code>ä»¥æœŸåç»­è¸å®çš„åšå¥½é€€ä¸€æ­¥çš„æµ·é˜”å¤©ç©ºä¸è¿›ä¸€æ­¥çš„å¤©é«˜ä»»é¸Ÿé£æŠ‰æ‹©ã€‚</code></p>
<p>â€‚â€‚â€‚â€‚è¿™æ®µå†…å®¹ä¸€ç›´ä¸¢åœ¨è‰ç¨¿é‡Œ,è¿™æ®µä¹Ÿä¸€ç›´æ²¡æœ‰æ²¡æ›´æ–°ï¼Œæœ€åä¸€æ®µæ›´æ–°å®šæ ¼åœ¨<code>25-03-20</code>,åœ¨<code>03-01</code>~<code>04-20</code>å³æˆ‘ä½“éªŒè£¸è¾å¤§æ»¡è´¯çš„æ—¥å­,è¿™æ—¢æœ‰äº‹å‰çš„æŒ£æ‰,ä¹Ÿæœ‰è½¬è¿‡èº«æ¥çœ‹ç°åœ¨çš„å¹³é™,æœŸæœ›ç°é˜¶æ®µæ­£åœ¨ç»å†æŒ£æ‰çš„<code>é“æ±</code>,èƒ½ç¨å¾®æœ‰ç‚¹å„¿å¯å‘å’Œå…±æƒ…å§ã€‚</p>
   <hr/>
<p><strong>è´´ä¸ª24å¹´çš„åƒç°è‰ç¨¿ç®±</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8e933ca736f4ae98568796bda6ae424~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKI5LqM5Yiw5LiN6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068576&amp;x-signature=9sbO8yhziEtoKTlXtj2JQmQm6DU%3D" alt="b8158f79-867a-4990-911d-c626d4c4c8f0.png" loading="lazy"/></p>
<h2 data-id="heading-1">24 æŒ£æ‰åŠ å‰§</h2>
<p>â€‚â€‚â€‚â€‚ç©¿æ¢­ä¹‹é—´~ï¼Œè·ä¸Šæ¬¡æ›´æ–°å·²ç»4æœˆæœ‰ä½™ï¼Œæœ¬æƒ³ç€å¼€å¼€å¿ƒå¿ƒçš„æŒ£ç€å¤–å¿«,ç»™é™è–ªå›å›è¡€ã€æ²‰ä¸‹æ¥ä¸“æ³¨åšäº‹æƒ…,å¥ˆä½•è¦†å·¢ä¹‹ä¸‹ç„‰æœ‰å®Œåµï¼Œä¸å¾—ä¸åˆèº«ä¸´å…¶å¢ƒçš„é¢ä¸´ä¸Šæ¬¡å·²ç»ç»ˆç»“æ”¾å¼ƒçš„è¯é¢˜,å°±å†åˆ†äº«åˆ†äº«è¿‘æœŸçš„æ€è€ƒå§ï¼Œå› ä¸ºè·¨åº¦æ¥è¿‘äº†5ä¸ªæœˆ,ä¸­é—´ä¸åŒæ—¶é—´æ®µæœ‰äº›é›¶æ˜Ÿçš„è®°å½•ï¼Œå§‘ä¸”å„ä½è¿›æ¥äº†å°±çœ‹ä¸Šä¸€çœ‹ã€‚</p>
<h2 data-id="heading-2">24-7æœˆè·Ÿè¸ªæƒ…å†µ</h2>
   <hr/>
<p><strong>è´´ä¸ª22å¹´çš„åƒç°æ–‡</strong>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1cd5340315314fc8a4149d640e892bb8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKI5LqM5Yiw5LiN6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068576&amp;x-signature=soRiCUQR%2BdIQEn2ZaqvtT236HQU%3D" alt="image.png" loading="lazy"/></p>
<p>â€‚â€‚â€‚â€‚å…ˆä¸Šä¸ªå›¾,æ—¶é—´å°±æ˜¯è¿™ä¹ˆä¸ç»æ„ä¹‹é—´ï¼Œè®©æˆ‘åšæŒäº†å¿«æ¥è¿‘3å¹´çš„æŠ€æœ¯ç±»å’Œæ„Ÿæ‚Ÿç±»çš„åˆ†äº«ï¼Œå½“ç„¶è¿™ä¸¤å¹´çš„æ—¶é—´ä»è­¦é†’åˆ°ç¨‹åºå‘˜çš„è¡Œå½“é€æ­¥çš„èµ°å‘æ¶åŒ–ä¹ƒè‡³å†°å°,æœŸé—´æ€è€ƒå’Œæ„Ÿæ‚Ÿè›®å¤šçš„,ä¸­é—´æœ‰ä¸€æ®µæ•´ä¸ªæ˜¯è¢«äº‹æƒ…å¡«æ»¡ï¼ŒæŒç»­çš„æ˜¯åšäº‹çš„å¿ƒæ€ä¸ºä¸»,è¿™æ¬¡æœ‰ç‚¹å„¿èº«ä¸´å…¶å¢ƒï¼Œå°±å½“å‰çŠ¶æ€ç†æ€§çš„è¿›è¡Œä¸€ä¸ªæ¼”åŒ–ï¼Œç®—æ˜¯æœ‰ä¸ªå€Ÿé‰´æ„ä¹‰å§ï¼Œå…ˆè¯´ä¸€ä¸‹,å› ä¸ºè¿‘æœŸæœ‰è¿›è¡Œè¿‡æ–°å‘˜å·¥åŸ¹è®­,å› æ­¤åŒºåˆ†ä¸€ä¸‹äººç¾¤ã€‚</p>
<ul>
<li><strong>é’ˆå¯¹å°†æ¯•ä¸šæˆ–è€…å·¥ä½œä¸€æ®µä¸é•¿çš„å¹´è½»äººï¼Œç¨ä½œè¡¥å……,ç»éªŒåªå¯ä»¥å€Ÿé‰´</strong>ï¼Œæ—§çš„ç»å†å¹¶æ— æ³•ä½œä¸ºå½“å‰å„ä½æ‚²è§‚çš„ç†ç”±ï¼Œçœ‹æœªæ¥è¿œä¸å¦‚çœ‹ç°åœ¨æ¥çš„æ¸…æ¥š,å¹´è½»æ˜¯èµ„æœ¬ï¼Œä½ æœ‰æ— æ•°çš„ç²¾åŠ›å’Œæœºä¼šå¯ä»¥å°è¯•ï¼Œçœ‹å‡†äº†å°±å»å°è¯•,å°è¯•è¿‡ä¸é€‚åˆä½ çš„è·¯ï¼Œæ‰èƒ½æ‰¾åˆ°é€‚åˆä½ çš„è·¯ï¼Œä»¥ä¸‹çš„å†…å®¹ä»…ä»…ç®—ä½œèŒä¸šè·¯å¾„å‘å±•çš„ä¸€ä¸ªæ¡ˆä¾‹ï¼Œæ— æ³•ä½œä¸ºæŒ‡å¯¼ï¼Œå› ä¸ºèƒ½æŒ‡å¯¼ä½ çš„æ˜¯ä½ çš„æœªæ¥ã€‚</li>
</ul>
<p>â€‚â€‚â€‚â€‚å¹´åˆçš„æ—¶å€™å…¶å®ç»å†çš„ä¸€ç³»åˆ—äº‹æƒ…ï¼Œæ¯”å¦‚è°ƒè–ªã€è°ˆè¯ã€æƒè¡¡,ä¸€åˆ‡è¿œæ²¡æœ‰é‚£ä¹ˆé£å¹³æµªé™,æœ€ç›´æ¥çš„åŸå› åªèƒ½æ˜¯å¹´åˆçš„æ‹›è˜å¸‚åœºå†°å°é”å®š,å†…æ¨ä¸€å®šç¨‹åº¦ä¸Šä¼šæœ‰ä¸€äº›ï¼Œä½†åˆ°ä¸€å®šé˜¶æ®µä¹‹åï¼Œå„è‡ªçš„ç»å†å’Œæ“…é•¿çš„è¾¹ç•Œæ˜¯ä¼šæœ‰ä¸åŒçš„ï¼Œä¸ä¼šæœ‰é‚£ä¹ˆå¥‘åˆçš„å²—ä½ç­‰ç€ï¼Œæ¯•ç«Ÿç»å¤§éƒ¨åˆ†ç¨‹åºäººï¼Œæ˜¯è¦é¢å‘é—®é¢˜å»çš„,å› æ­¤ï¼Œå¹¶ä¸æ˜¯çº¯ç²¹çš„é»‘ç™½é—®é¢˜ï¼Œæ˜¯é»‘ç™½ç°çš„å¤¹æ‚é—®é¢˜ã€‚</p>
<p>â€‚â€‚â€‚â€‚ç´§æ¥ç€åˆæ˜¯å¤§æ‰¹é‡è¢«ç–«æƒ…å½±å“çš„è½¬æˆ˜è€ƒç ”è·¯ç»§ç»­å¾€ä¸Šçš„å»¶ç»­,æ¯•ä¸šç”Ÿçš„å†²å‡»ã€å­¦å†å†²å‡»ï¼Œå¯¼è‡´äº†å¾ˆå¤§ç¨‹åº¦çš„å½¢æˆäº†ä¹°æ–¹å¸‚åœºï¼Œåœ¨ç»æµä¸å¥½çš„å¤§ç¯å¢ƒä¸‹,å½¢æˆäº†å´©ç›˜çš„å±€é¢,å› æ­¤æ™®éçš„é™è–ªå’Œç¢¾å‹ä¹Ÿæ˜¯æ„æ–™ä¹‹ä¸­çš„äº‹æƒ…,æ®æˆ‘å°±å‘¨å›´çš„åœˆå­äº†è§£,åŸºæœ¬ä¸Š10ä¸ªäººå½“ä¸­,æœ‰è¿‘ä¹ä¸€åŠçš„äººå—åˆ°äº†å½±å“ï¼Œå½“ç„¶è¿™å…¶ä¸­å¾ˆè£å¹¸çš„åŒ…å«äº†æˆ‘åœ¨å†…ã€‚</p>
<h2 data-id="heading-3">è¿‘é˜¶æ®µå¸‚åœº</h2>
<p>â€‚â€‚â€‚â€‚å°±ä»…ä»¥ç›®å‰æˆéƒ½çš„æƒ…å†µæ¥è¯´,æœºä¼šé›¶æ˜Ÿåœ¨å†’å¤´,å¾…é‡æœ‰æƒ…å†µæœ‰ä¸‹é™ï¼Œä½†æ¯”1-5æœˆä»½æœ‰å›å‡ã€è¦æ±‚æ™®éåœ¨å‡é«˜,å³åˆ†ç«¯çš„è¾¹ç•Œæ„Ÿåœ¨æ¶ˆå¤±ï¼Œå¯èƒ½æ˜¯åŸºäºé™æœ¬ä»¥åŠä¹‹å‰åˆ†ç«¯çš„å¼Šç«¯ç­‰é—®é¢˜æ¼”åŒ–è€Œæ¥çš„ç»“æœ,å› ä¸ºç›®å‰é€‰æ‹©å—â€œé€šå‹¤è·ç¦»â€ã€â€œç¨³å®šæ€§â€ç­‰å› ç´ å½±å“ï¼Œè€Œå—ç›Šäºä¹‹å‰çš„â€œä¸‡é‡‘æ²¹â€æ€è·¯ï¼Œå²—ä½å¯é€‰æ‹©çš„èŒƒç•´æ¯”è¾ƒå¹¿ï¼Œä½†ä¹Ÿé˜¶æ®µæ€§çš„å•å¤©æœ€å¤§5ä¸ªè”ç³»è€Œå·²ï¼Œåˆé€‚æ¯”ç‡ç•¥ä½ï¼Œè€Œä¸”åˆ°å‘é¢è¯•é‚€è¯·ç¯èŠ‚å¾ˆå°‘ã€‚</p>
<h2 data-id="heading-4">ä¸€é¡¿åˆ†æ</h2>
<p>â€‚â€‚â€‚â€‚æ‰¾å·¥ä½œæœ‰æ—¶å€™æ˜¯ä¸ªç„å­¦é—®é¢˜,å¹¶éæ˜¯ä¸€åˆ†è€•è€˜ä¸€ä»½æ”¶è·,å‡†å¤‡åº”è¯¥æœ‰,å¤šç”¨å½“å‰çš„æœ€å¥½å»å°è¯•ï¼Œéš”å²¸è§‚ç«ï¼Œå¾ˆéš¾ä½œä¸ºè‡ªèº«çš„ä»·å€¼å‚è€ƒï¼Œå¦‚æœè¯´åˆé€€ç¼©å›ºå®ˆï¼Œæˆ–è€…æ”¾å¼ƒè‡ªæˆ‘æ¶ˆè€—ï¼Œå¤šå¤šå°‘å°‘æ˜¯æ¸©æ°´ç…®é’è›™çš„å¿ƒæ€ï¼Œç°åœ¨çš„æˆ‘åŸºæœ¬ä¸Šé™·å…¥äº†æ­¤é¡¹è¿·èŒ«ï¼Œè€Œä¸”æ˜¯æ— è§£çš„ï¼Œå› ä¸ºæœ€ç›´æ¥çš„åŠæ³•æ˜¯ä½ æ‰¾åˆ°æ–°çš„åˆé€‚å²—ä½ï¼Œç›´æ¥è„±ç¦»å³å¯ï¼Œä¸éœ€è¦é‚£ä¹ˆå¤šæ€è€ƒå’Œè€ƒé‡,ä½†ç°åœ¨è¿™ä¸ªè¿‡ç¨‹è¢«æ‹‰é•¿äº†å‘¨æœŸå’Œéš¾åº¦ï¼Œå› æ­¤ç…ç†¬çš„åŸå› ä¸æ˜¯å› ä¸ºæ— æ³•å†³æ–­ï¼Œè€Œæ˜¯æ— æ³•æŒæ§ã€‚</p>
<p>â€‚â€‚â€‚â€‚å…³äºå…¶ä»–é€”å¾„ï¼Œç§¯æçš„è”ç³»å‘¨è¾¹ï¼Œè¡¨è¾¾ç°çŠ¶å’Œç§¯ææŒ£æ‰çš„æ€åŠ¿ï¼Œä½†ä¸€èˆ¬ä½œç”¨ä¸ç”šå¤§ï¼Œæ­¤é¡¹æœ¬æ˜¯ä½œä¸ºé¢„å¤‡å½¹è¿›è¡Œå‡†å¤‡çš„ï¼Œé˜²æ­¢çªå‘çŠ¶å†µï¼Œè¿™é‡Œçš„çªå‘çŠ¶å†µæ˜¯æŒ‡åœ¨ç³Ÿç³•è„†å¼±çš„å¿ƒç†é˜²çº¿ä¸‹ï¼Œä¸å‡é‡çš„å·¥ä½œå’Œå‹åŠ›å¸¦æ¥çš„å†²å‡»ï¼Œä¼šå¯¼è‡´é—®é¢˜ã€‚</p>
<p>â€‚â€‚â€‚â€‚å…³äºè‡ªæˆ‘å†…è€—åŠè§¦å‘æ—¶æœºçš„è€ƒé‡ï¼Œæœ¬èº«è€ƒé‡ä¸»è¦åŸºäº3æ–¹é¢</p>
<ul>
<li>å¤§ç¯å¢ƒé—®é¢˜,ç»å†è¿‡å¹´åˆçš„é˜¶æ®µï¼Œå…¶å®å¯¹å¹´åº•çš„é˜¶æ®µä¸æ€ä¹ˆæŠ±æœ‰å¹»æƒ³ï¼Œä¸å…¶ç­‰ç€äº‹æ€è¿›ä¸€æ­¥æ¶åŒ–ï¼Œä¸å¦‚æ—©ç‚¹å‘ç”Ÿï¼Œå€’é€¼é¢å¯¹ã€‚</li>
<li>å¹´é¾„çš„é—®é¢˜ï¼Œ è¿™ä¸ªæ˜¯ä¸ªè€ç”Ÿå¸¸è°ˆçš„é—®é¢˜ï¼Œè¯´ç‚¹å„¿å…·ä½“çš„åº”å¯¹ï¼Œä¸€ä¸ªæ˜¯è¿™ä¸ªå¹´é¾„é˜¶æ®µçš„è¯‰æ±‚å·²ç»ä¸ä¼šåªè€ƒå¯Ÿè¯­è¨€éƒ¨åˆ†ï¼Œè€Œæ˜¯å¯¹ç»¼åˆèƒ½åŠ›æœ‰è¦æ±‚ï¼Œå¦å¤–ä¸€ä¸ªå°±æ˜¯é•¿ä¿æŒå­¦ä¹ çš„å¿ƒæ€ï¼Œè°¦é€Šä¸€äº›ï¼Œæ€»å½’æ˜¯åœ¨ä¸åŒçš„äº‹æƒ…ä¸Šæœ‰è¿›æ­¥ã€‚</li>
<li>å¾…é‡ä¸ç”Ÿæ´»ï¼Œå¾ˆå¤§ä¸€éƒ¨åˆ†ï¼Œå¦‚æœå¤§ç¯å¢ƒå·²ç»ä¸èƒ½å¤Ÿæä¾›å……è¶³çš„å¾…é‡æ”¯æŒï¼Œè½¬è€Œå¯¹ç¨³å®šæ€§å’Œèˆ’é€‚åº¦è¿›è¡Œç»¼åˆè€ƒé‡ï¼Œå³è€ƒè™‘æœ‰å®ä½“çš„ä¼ ç»Ÿè¡Œä¸šï¼Œæˆ–è€…æœ‰ç›¸å…³ç§¯ç´¯çš„è¡Œä¸š,å†è¾…åŠ©ä¸€äº›å‰¯ä¸šæ”¯æŒï¼Œä¹Ÿæ˜¯æ¡ä¸é”™çš„é€‰é¡¹ã€‚</li>
</ul>
<p>â€‚â€‚â€‚â€‚å¾ˆå¯èƒ½ä¼šé¢ä¸´ç¬¬å››ç§ç»“å±€ï¼Œå°±æ˜¯çŸ­æ—¶é—´å†…æ— ä»¥ä¸ºç»§ï¼Œè¿™å°±è¦è€ƒè™‘åˆ°ä¸€ä¸ªæ˜¯èµ„é‡‘å‚¨å¤‡ï¼Œä¸€ä¸ªå°±æ˜¯æå‰çš„å¿ƒç†å’Œè§£ï¼ˆå½“å‰çš„ä¸»è¦å› ç´ æ˜¯å¤§ç¯å¢ƒã€ä¸ªä½“çš„è®¡åˆ’å—å¹²æ‰°å¤ªå¤§ï¼‰ï¼Œæœªæˆ˜å…ˆè™‘è´¥ï¼Œè¿™å°±åˆæ¶‰åŠåˆ°ä¸€ä¸ªè‡ªæˆ‘å†…è€—çš„é—®é¢˜ä¸Šäº†ï¼Œæ—¢ç„¶è€ƒè™‘å’Œä¸è€ƒè™‘ï¼Œå·®åˆ«ä¸æ˜¯å¤ªå¤§ï¼Œä¸ºä»€ä¹ˆè¿˜è¦è‡ªæˆ‘æ¶ˆè€—ï¼Œæˆ‘çš„è€ƒè™‘æ˜¯ä¸è½¬å‘çš„é—®é¢˜ï¼Œè£¹èƒä¹‹ä¸‹å†³å®šå¾€å¾€ä¼´éšç€é—æ†¾ï¼Œå°½é‡å‡å°‘é—æ†¾ã€‚</p>
<h2 data-id="heading-5">ç¿»æ¶Œçš„å¿ƒæ€</h2>
<p>â€‚â€‚â€‚â€‚äº‹å®è¯æ˜ï¼Œæ—¶åˆ»å‡†å¤‡ç€ä¸ä¸€å®šèƒ½è§£å†³æœªæ¥çš„é—®é¢˜ï¼Œä½†è‡³å°‘è®©ç°åœ¨çš„æˆ‘å¦ç„¶é¢å¯¹è¿‡å»çš„è‡ªèº«ï¼Œå·²ç„¶å°½åŠ›ã€åªå‰©ä¸‹å¾€å‰çœ‹äº†.</p>
<h2 data-id="heading-6">24-08-06çš„å†…å®¹åˆ†ç•Œçº¿</h2>
<p>â€‚â€‚â€‚â€‚è¿™æ®µè¯ä½œä¸ºåˆ†å‰²ï¼Œè¿™ä¹‹å‰æ˜¯08-06ä¹‹å‰çš„å†…å®¹,è¿™ä¸­é—´å‡ºç°äº†ä¸€äº›åè½¬,å¿ƒå¢ƒä¸Šæœ‰èµ·ä¼ï¼Œä¸»è¦å¯èƒ½æ˜¯ä½ä¼°äº†ç”Ÿæ´»æˆæœ¬çš„å‹åŠ›ï¼Œå†åŠ ä¸ŠåŸºé‡‘å’Œè‚¡ç¥¨çš„èƒŒåˆºï¼Œä½†ä¿¡å¿ƒæ—¶å¥½æ—¶åçš„åœ¨ç¿»æ¶Œï¼Œä¸€æ–¹é¢æ„Ÿè§‰ç°åœ¨çš„é¢è¯•ä¸»è¦é›†ä¸­åœ¨å½¢å¼ä¸Šï¼Œä½†åˆä¸å¾—ä¸é€‚åº”è¿™ç§å½¢å¼ï¼Œç»å¤§å¤šæ•°æ—¶å€™ï¼Œè¦ä¸å°±æ˜¯ä¸åŒ¹é…çš„ä¸šåŠ¡å¾ˆéš¾åœ¨çŸ­æ—¶é—´å†…æ”¹å˜ä¸€ä¸ªäººçš„æ„è¯†å½¢æ€å’Œè®¤çŸ¥ï¼Œè¦ä¸å°±æ˜¯ä¸ªäººåŒ–çš„åé‡å¤ªæ˜æ˜¾ï¼Œä½†åªèƒ½å’±å°±ç€ç¯å¢ƒï¼Œæ²¡é“ç†è¦æ±‚ç¯å¢ƒé¡ºä»è‡ªå·±,æ‰€ä»¥æŠ±æ€¨å½’æŠ±æ€¨ã€‚</p>
<h2 data-id="heading-7">24-08-15çš„å†…å®¹åˆ†ç•Œçº¿</h2>
<p>â€‚â€‚â€‚â€‚æ­¤æ®µçš„å†…å®¹åè½¬,ä¸»è¦æ˜¯ç¬ƒå®šçš„å†é™äº‹ä»¶å¹¶æœªå‘ç”Ÿ,ä¾¥å¹¸å¿ƒç†åœ¨ä½œç¥Ÿ,ä½†å‰æœŸçš„å¿ƒç†å…³å·²ç»å……åˆ†çš„å‘æŒ¥äº†ä½œç”¨,<strong>ä½é¢„æœŸã€ç§¯æåšå¥½å½“ä¸‹ã€å¹³å’Œè§‚æœ›æœªæ¥</strong>ï¼Œä¼¼ä¹è¾¾æˆäº†æŸç§å¹³è¡¡å’Œè§£, ä¸€æ–¹é¢æ˜¯å¯¹äº’è”ç½‘é¡ºé£è½¦10å¹´çš„åº†å¹¸ï¼ŒåŒæ—¶åˆæœ‰æ‰€ç–‘è™‘ï¼Œç–‘è™‘å’Œå®¡è§†çš„æ˜¯è‡ªèº«ä¹‹å‰çš„å†³å®šæ˜¯å¦è¸é”™ï¼Œä½†ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç–‘è™‘çš„å‘ç”Ÿæœ¬èº«å·²ç»èƒ½è¯´æ˜é—®é¢˜,è¿™å°±åˆå›åˆ°äº†è‡ªæˆ‘å†…è€—ä¸Šäº†,è‡³å°‘ç°åœ¨æ¥çœ‹ï¼Œæ¯ä¸€æ­¥éƒ½åšåˆ°äº†æ…é‡å¤„ç½®ã€å› æ­¤æˆ‘å¯¹è‡ªèº«æ— å¯æŒ‡æ‘˜,å¯¹ç¯å¢ƒçš„å˜åŒ–ä¹Ÿåªæœ‰é€‚åº”å˜åŒ–ï¼Œä¸¤ä¸æ€ªç½ªï¼Œä¹Ÿå‡ä¸å¤±æœ›ï¼Œå¯èƒ½æœ‰ç§å¿ƒæ€èººå¹³ï¼Œå´ä¸å¤±æ–—å¿—çš„æ„æ€åœ¨é‡Œé¢ã€‚</p>
<h2 data-id="heading-8">24-09-07çš„å†…å®¹åˆ†ç•Œçº¿</h2>
<p>â€‚â€‚â€‚â€‚è¿™ä¸­é—´ï¼Œç®—æ˜¯é‡æ–°å®¡è§†äº†ç”Ÿæ´»å’Œå·¥ä½œçš„å¹³è¡¡ï¼Œå¦‚æœä¸€ä»½å·¥ä½œå·²ç»è®©â€œå·¥ä½œâ€å……æ–¥äº†ä½ çš„ç”Ÿæ´»ï¼Œé‚£â€œå·¥ä½œâ€çš„æ„ä¹‰åœ¨å“ªé‡Œï¼Œâ€œå·¥ä½œâ€çš„ç›®çš„ä¸æ˜¯ä¸ºäº†æ›´å¥½çš„ç”Ÿæ´»å—?å€’ä¸å¦‚æ‹†è§£å¥½æ¯”ä¾‹ã€‚</p>
<h2 data-id="heading-9">24-12-04 ç–‘ä¼¼ç»ˆå±€</h2>
<p>â€‚â€‚â€‚â€‚é‚ªé£ç»ˆç©¶å¹äº†å‡ºæ¥,è®©è¡¨æ€,è®©å‡ºå·®å»èƒŒä¹¦,è¢«æ— å˜å¤´çš„è¯·å‡ç»ˆç»“,åç»­çš„æ²¡æ€èµ·å•¥é£æµªï¼Œä½†æ‰€æœ‰ç ”å‘å½“äº‹äººçš„è¡¨æ€å‡ºæ¥äº†,<code>å¹´åéƒ½è¦æ’¤</code>ï¼ŒæœŸé—´çš„å°æ’æ›²å¤šå¦‚ç‰›æ¯›ï¼Œè¿˜è¦é¡¶ç€å‹åŠ›å’Œå¿ƒæ€å¼€å‘,ç„¶ååˆæ˜¯é¢†å¯¼å±‚åŠ¨è¡,ä¸€é¡¿æ…·æ…¨æ¿€æ˜‚å’Œå®‰æŠš,ç»ˆäºæ˜¯å¹³ç¨³çš„åˆ°äº†å¹´å…³ï¼Œè§‰å¾—æ¥å¹´å¯ä»¥è½¬ä¸ªå²—å¤§å¹²ä¸€åœºã€‚ </p><hr/><p/>
<h2 data-id="heading-10">25-03-01 å¹´å‰æ€æƒ³å‡†å¤‡ç”¨è„šåšå‡ºäº†æŠ•ç¥¨</h2>
<p>â€‚â€‚â€‚â€‚å£é£åˆå‘ç”Ÿäº†å˜åŒ–,åŠ ä¹‹å‡å‘˜çƒ‚æ‘Šå­ä¸€å †ï¼Œè¿™æœŸé—´<code>deepseek</code>çš„æ¨ªç©ºå‡ºä¸–ï¼Œè®©ä¹‹å‰ä¸€ç›´ä¿æŒè§‚æœ›æ€åº¦çš„å…¬å¸å’Œäººè ¢è ¢æ¬²åŠ¨ï¼Œä½†æœ€å…ˆåŠ¨çš„è¿˜æ˜¯å˜´å·´,ä¸€ç•ªåˆ†æå,<code>AIå‡ºæ¥åï¼Œä½ ä»¬ç¨‹åºå‘˜è‚¯å®šè‚¯å®šæœ€å…ˆè¢«æ·˜æ±°ï¼Œåƒä½ ä»¬è¿™ç§å¹´é¾„å¤§äº†ï¼Œå·åˆå·ä¸åŠ¨,ç»éªŒä¼˜åŠ¿åˆè¢«å¼±åŒ–,å­¦ä¹Ÿå­¦ä¸è¿‡ï¼Œä½ ä»¬éšä¾¿åœ¨å¤–å¤´è¯•è¯•ä½ ä»¬çš„æ–¤ä¸¤ï¼Œçœ‹çœ‹æœ‰äººç†ä½ æ²¡</code>,åœ¨æ— æ„ä¹‰çš„æ­»æ‰›å’Œæ­»çš®èµ–è„¸çš„è‹Ÿä¸”ä¹‹é—´,ç»å†äº†ä¸€é¡¿æœ€æ¶åŒ–åœºæ™¯:<strong>èŒä¸šã€èµ„é‡‘åŒäº†å´</strong>çš„æŒ£æ‰åï¼Œæˆ‘å³åœ¨æ­¤ç§ç°çŠ¶åœºæ™¯ä¸‹åšå‡ºäº†<code>è£¸è¾</code>çš„å†³å®š,å½“æ—¶å®‰æ…°è‡ªå·±è¯´æ˜¯ä¸»åŠ¨æ±‚å˜åŒ–ï¼Œç°åœ¨çœ‹æ¥ï¼Œä¸è¿‡æ˜¯<strong>å±è¯å£®èƒ†è€Œå·²</strong>,ä½†é˜´å·®é˜³é”™çš„ï¼Œç»“æœç®—æ˜¯å¥½çš„ã€‚</p>
<p>â€‚â€‚â€‚â€‚æ­¤æ—¶çš„å¿ƒæ€ä¸»è¦æ˜¯ä¸¤ä¸ªï¼š</p>
<ol>
<li>
<p>æœç»æ¥é›¶æ´»ï¼Œæ¥æ¥å›å›éƒ½æ˜¯è¾›è‹¦é’±ï¼Œå¾—æœ‰â€œæˆé•¿æ€§çš„èµ„äº§â€,å³é•¿æœŸçš„ç²¾åŠ›æŠ•å…¥èƒ½å¸¦æ¥è´¨å˜çš„â€œè½¯ä»¶â€,åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œæœ‰å‡ ä¸ªæ–¹å‘ï¼Œåç»­é™†é™†ç»­ç»­ä¹Ÿè¢«å¦äº†ã€‚</p>
</li>
<li>
<p><code>ç¦»å®¶è¿‘æ±‚è‹Ÿç¨³</code>ã€<code>å†²AIæ±‚æ–°</code>ï¼Œä¸¤ä¸ªæç«¯ä¹Ÿåšå¥½äº†è·¨çœçš„é¢„æœŸã€‚</p>
</li>
</ol>
<p>â€‚â€‚â€‚â€‚ç»“æœåŠäº†æ‰‹ç»­çš„å‘¨æœ«å°±è°ˆå¦¥äº†2å®¶,ä¸€å®¶â€œå·¥ä¸šäº’è”ç½‘â€ç®—æ˜¯ä¸šåŠ¡ç»§æ‰¿ï¼Œæ®HRè¯´æˆ‘æ˜¯å…¥å›´çš„100å¤šå·å€™é€‰è€…é‡Œé€‰å®šçš„,å¦å¤–ä¸€å®¶<code>ERP</code>è¡ç”Ÿï¼Œå’Œè€æ¿èŠäº†ä¸€ä¸‹åˆè¡¨è¾¾äº†æ„å‘,æˆ‘è¿™ä¸€æƒ³ï¼Œå¼€é—¨çº¢å‘€è¿™æ˜¯,è¯´æ˜å¸‚åœºè¿˜å¥½å‘€,æ¯•ç«Ÿæˆ‘è¿˜æ²¡ä½“éªŒå¥½<code>è£¸è¾</code>çš„å¿ƒå¢ƒå˜åŒ–,åœ¨æ­¤ç§åœºæ™¯ä¸‹ï¼Œæ‹’äº†ä¸¤å®¶çš„<code>offer</code>,å…¶ä»–è¿˜è¡Œï¼Œé€šå‹¤è·ç¦»ä¸åˆé€‚,è§‰å¾—å¯ä»¥å†²å†²<code>AI</code>ã€‚</p>
<p>â€‚â€‚â€‚â€‚æœŸé—´å°±å¼€å§‹äº†å‡è£…ä¸Šç­çš„å†ç¨‹,å®½æ¾çš„åœºæ™¯ä¸‹,èŠ‚å¥ç»´æŒçš„è¿˜ç®—å¥½,ä¸åœçš„åˆ·ç®€å†ï¼Œåšå‡†å¤‡,ä»¥åŠå’Œå¦å¤–ä¸€ä¸ªå‰å‰åŒäº‹,äº’ç›¸äº¤æµåæ§½é¢è¯•,æœŸé—´ä¸“é—¨ç ”ç©¶äº†<code>BOSS</code>çš„æœºåˆ¶,å¿ä½äº†<code>å……é’±</code>çš„è¯±æƒ‘ï¼Œç»´æŒäº†ä¸€å‘¨é•¿æœŸæœ‰é¢è¯•çš„æƒ…å†µï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå‘¨æ²¡æœ‰é¢è¯•é‚€è¯·ï¼Œå¿ƒæ€ä¸Šæœ‰äº›æ…Œ,æˆ‘åŸºæœ¬ç»´æŒäº†ä¸€å‘¨èƒ½æœ‰1-2ä¸ªofferçš„æƒ…å†µ,ä½†æ˜¯é¢è¯•å’Œæ‰“æ‹›å‘¼çš„å°‘ï¼Œä½†æˆ‘çš„å‰å‰åŒäº‹å’Œæˆ‘çš„åœºæ™¯ç›¸åï¼Œæ‰“æ‹›å‘¼é¢è¯•å¤šï¼Œä½†<code>offer</code>åå¤´éƒ½æ²¡äº†ä¸‹æ–‡,æœŸé—´åˆæ‹’äº†6~7ä¸ªä¸å’‹çœ‹å¥½çš„,å‰©ä¸‹æœ€å<code>AI</code>é‚£ä¼šå„¿å†…æ¨çš„ä¸€å®¶æ²¡äº†ä¸‹æ–‡ï¼ŒåŠ ä¹‹ç„¦è™‘å’Œæ‡ˆæ€ æƒ…ç»ªæœ‰ç‚¹å„¿è”“å»¶ï¼Œæœ€ç»ˆè¿›äº†å†³èµ›é€‰2é€‰1,ä½†ç¦»å®¶è¿‘ç¨³å®šçš„ä¼ ç»Ÿè¡Œä¸š2è½®ä¸‹æ¥ï¼Œè¿Ÿè¿Ÿæ²¡å›å¤ï¼Œå°±å…ˆå»äº†å¦å¤–ä¸€å®¶ï¼Œä¸Šäº†3å¤©å¦å¤–ä¸€å®¶ç»™äº†é€šçŸ¥,ä¸€ç•ªè¾åˆ«åï¼Œåˆ°äº†ç›®å‰è¿™å®¶ï¼Œåç»­äº‹æ€æ¯”è¾ƒç†æƒ³ï¼Œå‡åœ¨å¯æ§èŒƒå›´å†…ï¼Œä¸åšå±•å¼€ã€‚ </p><hr/><p/>
<h2 data-id="heading-11">25-05 åç»­</h2>
<p>â€‚â€‚â€‚â€‚AIçš„æµªæ½®åŠ¿ä¸å¯æŒ¡,é™†é™†ç»­ç»­çš„çœ‹åˆ°å¬åˆ°ä¸é è¿‘<code>AI</code>å°±è¦è¢«æ—¶ä»£æ·˜æ±°çš„æ„Ÿè§‰,å¥½å§ï¼Œå½“æ—¶çš„åœºæ™¯ä¸‹ï¼Œååº”åˆè¿Ÿé’äº†ï¼Œé”™è¿‡äº†ä¹°è‚¡ç¥¨ï¼Œäº¦å¦‚18å¹´é”™è¿‡çŸ­è§†é¢‘ä¸€æ ·ã€‚<code>å¾€å›çœ‹ï¼Œå°½æ˜¯æ‹æ–­å¤§è…¿,ä½†æ­¤åœºæ™¯ä¸‹çš„ç»å†çš„ä¸ªäººå†³ç­–æ‰æ˜¯æœ€å¥½çš„</code>ï¼Œè¿™ä¾¿æ˜¯æœ€å¥½çš„å½“ä¸‹,ä¹Ÿåº†å¹¸æå‰æ’•è£‚äº†ä¸ªäººç„¦è™‘,å°†è®¾æƒ³å˜æˆäº†åœºæ™¯,åœ¨åœºæ™¯ä¸‹è°ƒåº¦äº†å†³ç­–ã€‚æ­¤æ—¶ï¼Œå†æ¥è§‚æœ›ï¼Œ<code>è¿™åœºAIå¯¹ç¨‹åºå‘˜å†²å‡»çš„å¤§æˆ</code>ä¹Ÿå¼€å§‹åœ¨ä¼ æ’­ï¼Œå…¶ä¸­å¤¹æ‚ç€<code>åŠåŠå­</code>ã€<code>å¤–è¡Œ</code>çš„é€ åŠ¿ï¼Œå‘ˆç°å‡ºæ¥çš„å†°ç«ä¸¤é‡å¤©,ä¸çŸ¥é“æ¥å¹´ä¼šä¸ä¼šåˆæ˜¯ä¸€åœ°é¸¡æ¯›,<code>AIç¼–ç¨‹</code>å’Œæˆ‘çš„å·¥ä½œç»“åˆæ‰¾å¹³è¡¡æˆ‘ä¹Ÿå·®ä¸å¤šä½“éªŒå¿«ä¸¤å¹´å¤šäº†,ä¸€æ­¥æ­¥çœ‹ç€ä»<code>ç—´å‘†</code>å˜çš„æ…¢æ…¢è¶Šæ¥è¶Š<code>èªæ˜</code>ï¼Œä¸€æ–¹é¢è¦ç§‰æŒå¼€æ”¾çš„å¿ƒæ€å»é€‚åº”ï¼Œä¸€æ–¹é¢è¦é€šè¿‡é€‚åº”æ‰¾åˆ°è‡ªæˆ‘çš„è¾¹ç•Œï¼Œæ‹¥æŠ±ææƒ§ï¼Œæ‰èƒ½ç»½æ”¾æ–°ç”Ÿã€‚</p>
<h2 data-id="heading-12"><code>å¥åº·</code>ã€<code>æ·˜æ±°</code></h2>
<p>â€‚â€‚â€‚â€‚32ç¨‹åºå‘˜çŒæ­»ï¼ŒåˆæŠŠè¿™ä¸ªèŒä¸šçš„ç”Ÿå­˜ç¯å¢ƒå’Œç—›æ”¾å¤§äº†ï¼Œå‰å‡ å¹´æ˜¯<code>35</code>ã€<code>32</code>åœ¨è¿™ä¹‹åå‘¢?ç”Ÿæ´»æ¯•ç«Ÿæ˜¯è‡ªå·±çš„,<code>ä»£ç æ”¹å˜ä¸–ç•Œ</code>çš„ç†æƒ³ï¼Œéœ€è¦æ”¾ä¸€æ”¾ï¼Œè‡³å°‘æ˜¯è®©å®ƒå˜æˆè‡ªå·±çš„ï¼Œè€Œä¸æ˜¯åˆ«äººçš„,è‡³äºç”Ÿå­˜çš„å‹åŠ›,æ€»èƒ½åœ¨åœºæ™¯ä¸‹æ‰¾åˆ°é€‚å½“çš„è½ç‚¹ï¼ŒæœŸæœ›åœ¨åœºæ™¯ä¸‹çš„å„ä½,å°‘äº›å†…è€—ï¼Œå¤šäº›å¦ç„¶å’Œæ…·æ…¨ï¼Œäººç”Ÿä¸è¿‡3wå¤©,ä½“éªŒå¾ˆé‡è¦ã€‚ </p><hr/><p/>
<h2 data-id="heading-13">æœ€å</h2>
<p>â€‚â€‚â€‚â€‚æ–°ä¸€å¹´åˆæœ‰æ–°è¯„ä»·<code>æ–°åœŸæœ¨</code>ã€<code>æ–°å†œæ°‘å·¥</code>,å¯èƒ½å˜åŒ–çš„è¡Œä¸š,æ–°é™ˆä»£è°¢ä¸€ç›´éƒ½è¿™ä¹ˆå¿«å’Œé¢‘ç¹ï¼Œä½†è¿™å¹¶ä¸å¦¨ç¢ï¼Œèµ°å¥½å½“ä¸‹ï¼Œè¿‡å¥½è‡ªèº«ï¼ï¼</p>
<p><strong>å¦‚æœ<code>ç¼–ç¨‹</code>æ˜¯å…´è¶£ã€çˆ±å¥½ï¼Œä¸å¦¨å°‘ç‚¹å„¿æ¿€çƒˆï¼Œå¤šäº›é•¿æƒ…ï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI è¯­éŸ³è¯†åˆ« + æ¶¦è‰² é‡æ„è¾“å…¥ä½“éªŒ]]></title>    <link>https://juejin.cn/post/7603653885602299954</link>    <guid>https://juejin.cn/post/7603653885602299954</guid>    <pubDate>2026-02-07T11:29:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603653885602299954" data-draft-id="7603627478020538378" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI è¯­éŸ³è¯†åˆ« + æ¶¦è‰² é‡æ„è¾“å…¥ä½“éªŒ"/> <meta itemprop="keywords" content="ChatGLM (æ™ºè°±)"/> <meta itemprop="datePublished" content="2026-02-07T11:29:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å…µå¼ å¥"/> <meta itemprop="url" content="https://juejin.cn/user/1257497032405229"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI è¯­éŸ³è¯†åˆ« + æ¶¦è‰² é‡æ„è¾“å…¥ä½“éªŒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1257497032405229/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å…µå¼ å¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T11:29:42.000Z" title="Sat Feb 07 2026 11:29:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ€è¿‘å’Œ AI äº¤æµçš„è¿‡ç¨‹ä¸­ï¼Œæœ‰ç‚¹åŒå€¦çš„æ‰“å­—çš„ä½æ•ˆå’Œæ…¢é€Ÿï¼Œå°è¯•ä½¿ç”¨å„ç§ AI è¯­éŸ³è¾“å…¥ï¼Œæœ€ç»ˆæ¢ç´¢å‡ºä¸€å¥—ç›®å‰æœ€å®Œç¾çš„æ–¹æ¡ˆï¼Œé—ªç”µè¯´ + è±†åŒ…æµå¼è¯­éŸ³è¯†åˆ«æ¨¡å‹2.0 + GLM 4.7 Flash æ¶¦è‰²ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œè¿™å¥—æ–¹æ¡ˆæ˜¯å…è´¹çš„ï¼Œå¹¶ä¸”æ•ˆæœè¿˜ä¸é”™ã€‚</p>
<p>å¯ä»¥å®ç°çš„æ•ˆæœå°±æ˜¯ä½ åªç®¡è¯´ï¼Œéšä¾¿è¯´æƒ³åˆ°å“ªè¯´åˆ°å“ªï¼Œè±†åŒ…è´Ÿè´£å¸®ä½ è¯†åˆ«æˆæ–‡å­—ï¼ŒGLM è´Ÿè´£å¸®ä½ æ•´ç†æˆç»“æ„åŒ–æœ‰é€»è¾‘æœ‰æ¡ç†çš„æ•°æ®ã€‚</p>
<p>æ¥ä¸‹æ¥ä¸€ä¸ªä¸ªç»†è¯´æ€ä¹ˆé…ç½®ã€‚</p>
<h2 data-id="heading-0">é—ªç”µè¯´</h2>
<p>é¦–å…ˆæ˜¯ <a href="https://link.juejin.cn?target=https%3A%2F%2Fshandianshuo.cn%2F" target="_blank" title="https://shandianshuo.cn/" ref="nofollow noopener noreferrer">é—ªç”µè¯´ï¼ŒAIè¯­éŸ³è¾“å…¥æ³•</a>ï¼Œç”¨è¿™ä¸ªçš„æ ¸å¿ƒåŸå› æ˜¯ä¸­å›½å¼€å‘çš„ï¼Œä½“éªŒæ¯”è¾ƒå¥½ï¼Œæœ¬åœ°æ¨¡å‹ 800M å·¦å³ï¼ŒRAM å ç”¨ä¸å¤§ï¼Œè¯†åˆ«æ•ˆæœè¿˜å¯ä»¥ï¼Œè‡ªå¸¦æ ‡ç‚¹ç¬¦å·ï¼Œè¿˜å¯ä»¥å¾ˆæ–¹ä¾¿çš„åˆ‡æ¢çº¿ä¸Šå¤§æ¨¡å‹ã€‚</p>
<p>ä¹Ÿå’Œ CpsWhisperã€window è‡ªå¸¦çš„ Win+H è¯­éŸ³è¾“å…¥æ³•ï¼ŒMac çš„ superWhisper åšå¯¹æ¯”ï¼Œä»–ä»¬åˆ†åˆ«æœ‰ä»¥ä¸‹é—®é¢˜ã€‚</p>
<p>Win + H è‡ªå¸¦çš„ bug å¾ˆå¤šï¼Œæœ‰æ—¶å€™è¯´åŠå¤©ç»“æœæŠ¥ä¸ªé”™ï¼ŒæŒºè®¨åŒçš„ï¼›é€Ÿåº¦æ¯”è¾ƒæ…¢è¦ç­‰ï¼Œè®¾ç½®ç»å¸¸è‡ªåŠ¨æ¢å¤é»˜è®¤ï¼Œæ¯”å¦‚è‡ªåŠ¨æ·»åŠ æ ‡ç‚¹ç¬¦å·ã€‚</p>
<p>CpsWhisper ç”±äºæˆ‘æ˜¯ AMD 7840H çš„ CPUï¼Œæ¯”è¾ƒæŒ‘æ¨¡å‹å’Œé…ç½®ï¼Œæå¥½åä¸€çœ‹ RAM 4G+ï¼Œå¯åŠ¨è¿˜æŒºéº»çƒ¦ä¸¤ä¸ª exeï¼Œç”¨æˆ·é¡µé¢æ˜¯æ²¡æœ‰çš„å…¨é å‘½ä»¤è¡Œï¼Œè€Œä¸”æ•ˆæœä¹Ÿä¸€èˆ¬èˆ¬ï¼Œæ”¾å¼ƒäº†ã€‚</p>
<p>é¦–æ¬¡ä¸‹è½½å®Œåç”¨æœ¬åœ°å¤§æ¨¡å‹ä¼šè‡ªåŠ¨ä¸‹ä¸ª 800M å·¦å³çš„åŒ…ï¼Œå¦‚æœç”¨æœ¬åœ°æ¨¡å‹ï¼Œè¿™æ ·å°±å¤Ÿäº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3b639169eba84deea8865ab5badd1f30~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5YW15byg5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068582&amp;x-signature=KWA9SgX7JyanCywg37qAOqbLLuE%3D" alt="image.png" loading="lazy"/></p>
<p>å¦å¤–æä¸€å˜´è¿™ä¸ªè½¯ä»¶é»˜è®¤æ˜¯å¿«æ·é”®æ˜¯ Ctrl+Winï¼Œæˆ‘è§‰å¾—æŒºä¸å¥½ç”¨çš„æ¢æˆäº†å³è¾¹çš„ Altï¼Œå¯ä»¥åœ¨è®¾ç½®é‡Œé¢è°ƒã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4625293b513a46489d4f746e7ca8871b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5YW15byg5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068582&amp;x-signature=NBwEq%2BGYbm3RTStnxM60RmTgpDo%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-1">è±†åŒ…æµå¼è¯­éŸ³è¯†åˆ«æ¨¡å‹2.0</h2>
<p>å¦‚æœè§‰å¾—æœ¬åœ°çš„æ¨¡å‹è¯†åˆ«ç‡ä¸å¤Ÿï¼Œå¯ä»¥æ¢æˆçº¿ä¸Šçš„ï¼Œè¿™è¾¹çš„åˆ›å§‹äººæ¨èç”¨ è±†åŒ…æµå¼è¯­éŸ³è¯†åˆ«æ¨¡å‹2.0ã€‚æˆ‘è¯•äº†ä¸‹æ•ˆæœè¿˜å¯ä»¥ï¼Œæ–°ç”¨æˆ·æœ‰ 20 ä¸ªå°æ—¶çš„å…è´¹é¢åº¦ã€‚</p>
<h3 data-id="heading-2">è·å–è±†åŒ… Api key</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fconsole.volcengine.com%2Fspeech%2Fapp%3FAppID%3D2586725503" target="_blank" title="https://console.volcengine.com/speech/app?AppID=2586725503" ref="nofollow noopener noreferrer">è±†åŒ…è¯­éŸ³</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8e4bf011d20d49f8932e8547ffc5624f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5YW15byg5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068582&amp;x-signature=IwseOmnILa31LCEhvz0Zatu7P8w%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/20efa2c426e440a7bf40d65ca8a27f90~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5YW15byg5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068582&amp;x-signature=s68vkR8%2BLLhb0aqf9axGuen3DrI%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-3">é…ç½®åˆ°é—ªç”µè¯´é‡Œ</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6216f720874a4cadb251043580d0dfee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5YW15byg5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068582&amp;x-signature=k95Xe54rLqvYewjCqA0bwL58%2Bfg%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™é‡Œæ³¨æ„è¦ä¿è¯æœ¬åœ°ç½‘ç»œæ²¡é—®é¢˜ï¼Œæˆ‘ä¹‹å‰ç”¨ Antigravity å¼€äº† TUN æ¨¡å¼ï¼Œè¿™é‡Œè®¿é—®åŠ å¾ˆæ…¢æœ‰é—®é¢˜ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc946a2eaa534c739d2e793bcf78fb0a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5YW15byg5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068582&amp;x-signature=EVKxYdmsVHHBFaJnh2C88urWEKk%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-4">GLM 4.7 Flash æ¶¦è‰²</h2>
<p>GLM çš„ Flash æ¨¡å‹å…¶å®å…è´¹çš„ï¼Œæˆ‘æ›¾ç”¨ Antigravity çš„åä»£ Api åšæ¶¦è‰²ï¼Œä½†æ˜¯é€Ÿåº¦å¤ªæ…¢äº†ï¼Œä¸€å¥è¯éƒ½è¦ 10 sã€‚äºæ˜¯å¯»æ‰¾å›½å†…æœ‰æ²¡æœ‰å…è´¹çš„å°æ¨¡å‹å¯ä»¥å®Œæˆä»»åŠ¡ï¼Œè¿™ä¸ªä¸éœ€è¦èƒ½åŠ›å¤šå¼ºï¼Œåªè¦åšç‚¹ç®€å•çš„æ¶¦è‰²å°±å¥½äº†ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.bigmodel.cn%2Fusercenter%2Fproj-mgmt%2Fapikeys" target="_blank" title="https://open.bigmodel.cn/usercenter/proj-mgmt/apikeys" ref="nofollow noopener noreferrer">æ™ºè°±AIå¼€æ”¾å¹³å°</a></p>
<p>æ³¨å†Œä¸€ä¸ª keyã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc9432e4acc24dccaa25b7a03778971f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5YW15byg5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068582&amp;x-signature=VDRLCZKKEGKyrQ9j0bOmEwl7sn8%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨è¿™æ¨¡å‹è¾“å…¥ GLM-4.7-Flashï¼Œç„¶åæµ‹è¯•ä¸‹ä¸€èˆ¬å°±æ²¡é—®é¢˜äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d121f7f4b7347a08db8907bbdcf9f33~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5YW15byg5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068582&amp;x-signature=54jAFG%2FAo47gXXS3rF5HMmJIPDU%3D" alt="image.png" loading="lazy"/></p>
<p>å†å»æŠ€èƒ½è¿™é‡Œæ·»åŠ æç¤ºè¯ï¼Œæˆ‘çš„æ˜¯</p>
<pre><code class="hljs language-prompt" lang="prompt"># Role
ä½ æ˜¯ä¸€ä½äººå·¥æ™ºèƒ½é¢†åŸŸçš„èµ„æ·±æŠ€æœ¯ç¼–è¾‘ã€‚ä½ çš„ä»»åŠ¡æ˜¯å°†è¯†åˆ«æ··ä¹±çš„ä¸­è‹±æ··åˆè¯­éŸ³æ–‡æœ¬ï¼Œé‡å†™ä¸ºä¸€å¥ï¼ˆæˆ–ä¸€æ®µï¼‰é€»è¾‘é€šé¡ºã€æœ¯è¯­å‡†ç¡®çš„çº¯æ–‡æœ¬ã€‚

# Context &amp; Domain
åŸå§‹å†…å®¹æ¶‰åŠ AI å¼€å‘ã€å¤§æ¨¡å‹åŠç›¸å…³æŠ€æœ¯æ ˆã€‚
ä½ å¿…é¡»åŸºäºä¸Šä¸‹æ–‡ï¼Œå¯¹ä»¥ä¸‹é«˜é¢‘è¯¯å¬æœ¯è¯­è¿›è¡Œå¼ºåˆ¶ä¿®æ­£ï¼š
- AI æ¨¡å‹ç±»ï¼šOpen eye -&gt; OpenAI; Jammie/Jimmy -&gt; Gemini; Claude; LLaMA; Transformer
- å¼€å‘å·¥å…·/åè®®ç±»ï¼šCrowd code -&gt; Cloud Code; NCP/NTP -&gt; MCP (Model Context Protocol); Skills; API; SDK
- å¸¸è§åŠ¨è¯/åè¯ï¼šToken; Context Window; Agent; RAG (Retrieval-Augmented Generation)

# Critical Rules (ä¸¥æ ¼æ‰§è¡Œ)
1. **è¾“å‡ºæ ¼å¼**ï¼š
   - **ä¸¥ç¦**ä½¿ç”¨åˆ—è¡¨ã€æ ‡é¢˜ã€Markdown ç¬¦å·ï¼ˆå¦‚ #, -, 1.ï¼‰ã€‚
   - ç»“æœå¿…é¡»æ˜¯**å•è¡Œæ–‡æœ¬**æˆ–**ä¸€ä¸ªè‡ªç„¶æ®µè½**ã€‚
   - é£æ ¼è¦åƒæŠ€æœ¯æ–‡æ¡£ä¸­çš„â€œNoteâ€æˆ–â€œSummaryâ€ï¼Œå¹²ç»ƒã€ä¹¦é¢åŒ–ã€‚

2. **é€»è¾‘æ¸…æ´—**ï¼š
   - **å‰”é™¤å£è¯­**ï¼šåˆ é™¤â€œé‚£ä¸ªâ€ã€â€œé¢â€ã€â€œå°±æ˜¯â€ã€â€œä¹Ÿå°±æ˜¯â€ã€â€œè¿™ç§ä¸œè¥¿â€ã€‚
   - **æ„å›¾ä¿®æ­£**ï¼šé‡åˆ°â€œç”¨ A...ä¸å¯¹ç”¨ Bâ€çš„æƒ…å†µï¼Œç›´æ¥è¾“å‡ºâ€œä½¿ç”¨ Bâ€ã€‚

3. **æœ¯è¯­çº é”™ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰**ï¼š
   - å³ä½¿åŸæ–‡å‘éŸ³éå¸¸ç¦»è°±ï¼ˆå¦‚â€œCrowd codeâ€ï¼‰ï¼Œåªè¦ä¸Šä¸‹æ–‡æ˜¯ Google Cloud ç¯å¢ƒï¼Œå¿…é¡»ä¿®æ­£ä¸ºâ€œCloud Codeâ€ã€‚

# Few-Shot Examples (æ ¸å¿ƒå‚ç…§)

=== ç¤ºä¾‹ 1ï¼šæœ¯è¯­ä¿®æ­£ (æ¨¡å‹ä¸æœºæ„) ===
ã€åŸå§‹è¾“å…¥ã€‘ï¼š
é‚£ä¸ª Open eye çš„æ–°æ¨¡å‹å‘å¸ƒäº†ï¼Œä½†æ˜¯æˆ‘è§‰å¾—è¿™ä¸ª Jammie 1.5 çš„çª—å£æ›´å¤§ï¼Œæ›´é€‚åˆè·‘é•¿æ–‡æœ¬ã€‚
ã€è¾“å‡ºç»“æœã€‘ï¼š
OpenAI å‘å¸ƒäº†æ–°æ¨¡å‹ï¼Œä½† Gemini 1.5 å…·å¤‡æ›´å¤§çš„ä¸Šä¸‹æ–‡çª—å£ï¼Œæ›´é€‚åˆå¤„ç†é•¿æ–‡æœ¬ä»»åŠ¡ã€‚

=== ç¤ºä¾‹ 2ï¼šæœ¯è¯­ä¿®æ­£ (åè®®ä¸å·¥å…·) ===
ã€åŸå§‹è¾“å…¥ã€‘ï¼š
æˆ‘ä»¬ç°åœ¨è¦æ¥é‚£ä¸ª NCP åè®®ï¼Œç„¶ååœ¨ Crowd code é‡Œé¢é…ç½®ä¸€ä¸‹é‚£ä¸ª Skillï¼Œä¸ç„¶è¿ä¸ä¸Šã€‚
ã€è¾“å‡ºç»“æœã€‘ï¼š
éœ€è¦é€šè¿‡ MCP åè®®å¯¹æ¥ï¼Œå¹¶åœ¨ Cloud Code ä¸­é…ç½®ç›¸åº”çš„ Skills ä»¥ç¡®ä¿è¿æ¥æ­£å¸¸ã€‚

=== ç¤ºä¾‹ 3ï¼šé€»è¾‘è‡ªæˆ‘ä¿®æ­£ ===
ã€åŸå§‹è¾“å…¥ã€‘ï¼š
æŠŠè¿™ä¸ª temperature è®¾æˆ 0.7...é¢ä¸å¯¹ï¼Œè¿˜æ˜¯è®¾æˆ 0.2 å§ï¼Œæˆ‘ä»¬è¦å‡†ç¡®ä¸€ç‚¹çš„è¾“å‡ºã€‚
ã€è¾“å‡ºç»“æœã€‘ï¼š
ä¸ºäº†ä¿è¯è¾“å‡ºçš„å‡†ç¡®æ€§ï¼Œè¯·å°† temperature å‚æ•°è®¾ç½®ä¸º 0.2ã€‚

=== ç¤ºä¾‹ 4ï¼šæ··åˆåœºæ™¯ ===
ã€åŸå§‹è¾“å…¥ã€‘ï¼š
è¿™ä¸ª Agent çš„ååº”å¤ªæ…¢äº†ï¼Œå¯èƒ½æ˜¯é‚£ä¸ª rag çš„æ£€ç´¢åº“å¤ªå¤§äº†ï¼Œæˆ–è€…æ˜¯ token æ•°è¶…äº†ï¼Œä½ æŸ¥ä¸€ä¸‹é‚£ä¸ª prompt æ€ä¹ˆå†™çš„ã€‚
ã€è¾“å‡ºç»“æœã€‘ï¼š
Agent å“åº”å»¶è¿Ÿå¯èƒ½æ˜¯ç”±äº RAG æ£€ç´¢åº“è¿‡å¤§æˆ– Token è¶…é™æ‰€è‡´ï¼Œè¯·æ£€æŸ¥ Prompt ç¼–å†™é€»è¾‘ã€‚

---

# Input Data
ã€åŸå§‹å£è¯­æ–‡æœ¬ã€‘ï¼š
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e2e5137ef1eb4f18a5aa3614ab6f6bcc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5YW15byg5YGl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771068582&amp;x-signature=B84e8ZP2GmYSf7ff2gn7l48cM2A%3D" alt="image.png" loading="lazy"/></p>
<p>OK é…ç½®å®Œäº†ï¼ŒæŒ‰ä¸‹å³è¾¹ Alt å†è¯´è¯å³å¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆè¯†Agent]]></title>    <link>https://juejin.cn/post/7603653885601906738</link>    <guid>https://juejin.cn/post/7603653885601906738</guid>    <pubDate>2026-02-07T08:52:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603653885601906738" data-draft-id="7603567912593571867" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆè¯†Agent"/> <meta itemprop="keywords" content="åç«¯,AIç¼–ç¨‹,LangChain"/> <meta itemprop="datePublished" content="2026-02-07T08:52:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è›‡çš®åˆ’æ°´æ€ª"/> <meta itemprop="url" content="https://juejin.cn/user/4301752340323736"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆè¯†Agent
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4301752340323736/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è›‡çš®åˆ’æ°´æ€ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T08:52:19.000Z" title="Sat Feb 07 2026 08:52:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">AgentåŸºç¡€</h2>
<h3 data-id="heading-1">1.Agentå®šä¹‰</h3>
<p>ä»€ä¹ˆæ˜¯LLM Agentï¼ŸLLM Agentçš„æ ¸å¿ƒåœ¨äºï¼Œç”¨LLMä»£æ›¿ä¼ ç»Ÿçš„å·¥ç¨‹æµç¨‹æ§åˆ¶ï¼Œç”±å¤§æ¨¡å‹è¿›è¡Œæ€è€ƒï¼Œç¡®å®šè§£å†³ç”¨æˆ·Queryçš„æ–¹å¼ï¼Œä¾‹å¦‚ç›´æ¥è¿”å›ã€Search Databaseã€Invoke Tools APIã€æˆ–è€…ä½¿ç”¨å…¶ä»–çš„LLMã€‚ç›¸è¾ƒäºä¼ ç»Ÿçš„å·¥ç¨‹AIï¼ŒAgentå…·æœ‰æ¯”è¾ƒå¤§çš„è‡ªä¸»æƒï¼Œåœ¨è§£å†³é—®é¢˜çš„æ—¶å€™åŸºæœ¬ä¸éœ€è¦äººä¸ºå¹²é¢„ã€‚</p>
<h3 data-id="heading-2">2.LLM Agentå·¥ä½œæµç¨‹</h3>
<p>Agentçš„å·¥ä½œæµç¨‹å¯ä»¥ç®€åŒ–ä¸ºä»¥ä¸‹çš„æ­¥éª¤ï¼š</p>
<ol>
<li>ç”¨æˆ·è¾“å…¥Promptæç¤ºè¯ï¼ŒLLMæ¥æ”¶ç”¨æˆ·æ”¶åˆ°çš„Prompt</li>
<li>LLMå¯¹Promptçš„å†…å®¹è¿›è¡Œç†è§£å’Œæ€è€ƒï¼Œå¹¶æŒ‡å®šè§£å†³æ–¹æ¡ˆï¼ŒæœŸé—´ä¼šåŸºäºä¸åŒæ€ç»´æ¨¡å¼è¿›è¡ŒPlaningï¼Œä¾‹å¦‚é“¾å¼æ€ç»´(CoT)ã€ReActã€æ ‘å½¢æ€ç»´ã€å›¾å½¢æ€ç»´GoTç­‰ç­‰</li>
<li>LLMåœ¨æ€è€ƒçš„æ—¶å€™ï¼Œä¼šåŸºäºLTMå’ŒSTMå¯¹ç»“æœåšå‡ºä¿®æ­£ï¼›</li>
<li>Act:åˆ¶å®šå¥½è§£å†³æ–¹æ¡ˆä¹‹åï¼ŒLLMä¼šæŒ‰ç…§è§£å†³æ–¹æ¡ˆè°ƒç”¨å¤–éƒ¨å·¥å…·æˆ–APIæ‰§è¡Œä»»åŠ¡</li>
<li>Observation and Optimization: åŸºäºObservorè§‚æµ‹ä»»åŠ¡æ‰§è¡Œç»“æœï¼Œå¯¹æ‰§è¡Œç»“æœå­¦ä¹ å’Œä¼˜åŒ–</li>
</ol>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TB
    subgraph Input ["è¾“å…¥é˜¶æ®µ"]
        U([ğŸ‘¤ ç”¨æˆ·è¾“å…¥]) --&gt; P(["ğŸ“ Prompt æç¤ºè¯"])
    end

    subgraph Thinking ["æ€è€ƒé˜¶æ®µ"]
        P --&gt; R(["ğŸ§  LLM æ¥æ”¶ä¸ç†è§£"])
        R --&gt; PL["ğŸ’­ æ€è€ƒä¸è§„åˆ’&lt;br/&gt;CoT / ReAct / ToT / GoT"]
        PL --&gt; M["ğŸ”€ åŸºäºè®°å¿†ä¿®æ­£"]
        M --&gt;|LTM| LTM["é•¿æœŸè®°å¿† LTM"]
        M --&gt;|STM| STM["çŸ­æœŸè®°å¿† STM"]
        LTM --&gt; M
        STM --&gt; M
    end

    subgraph Execution ["æ‰§è¡Œé˜¶æ®µ"]
        M --&gt; A(["âš¡ Act æ‰§è¡ŒåŠ¨ä½œ"])
        A --&gt; T["ğŸ”§ è°ƒç”¨å¤–éƒ¨å·¥å…·/API"]
    end

    subgraph Optimization ["ä¼˜åŒ–é˜¶æ®µ"]
        T --&gt; O(["ğŸ‘ï¸ Observation è§‚æµ‹ç»“æœ"])
        O --&gt; OPT["ğŸ“ˆ å­¦ä¹ ä¸ä¼˜åŒ–"]
        OPT -.-&gt;|åé¦ˆ| PL
        OPT --&gt; RESULT(["âœ… æœ€ç»ˆè¾“å‡º"])
    end

    classDef inputStyle fill:#e1f5fe,stroke:#01579b,stroke-width:2px,color:#000
    classDef thinkingStyle fill:#f3e5f5,stroke:#4a148c,stroke-width:2px,color:#000
    classDef executionStyle fill:#fff3e0,stroke:#e65100,stroke-width:2px,color:#000
    classDef optimizationStyle fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px,color:#000
    classDef memoryStyle fill:#fff9c4,stroke:#f57f17,stroke-width:2px,color:#000

    class U,P inputStyle
    class R,PL,M thinkingStyle
    class A,T executionStyle
    class O,OPT,RESULT optimizationStyle
    class LTM,STM memoryStyle
</code></pre>
<h3 data-id="heading-3">3.Agentç»„ç»‡æ¶æ„</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
    User[User / Request]

    subgraph Agent
        Planner[Planner / Reasoning]
        Executor[Executor]
        Memory[Memory]
    end

    LLM[LLM]
    Tools[Tools / Skills]
    Memo[STM / LTM / Sense]

    User --&gt; Planner
    Planner --&gt; LLM
    LLM --&gt; Planner

    Planner --&gt; Executor
    Executor --&gt; Tools
    Tools --&gt; Executor

    Planner --&gt; Memory
    Memory --&gt; Planner
    Memory --&gt; Memo
    
    classDef agent fill:#e1f5fe,stroke:#01579b,stroke-width:2px,color:#000
    class Planner,Executor,Memory,LLM agent
</code></pre>
<p><strong>å„ä¸ªç»„ä»¶çš„åŠŸèƒ½</strong></p>
<ol>
<li><strong>Agent</strong>ï¼šAgentå®é™…ä¸Šå¹¶ä¸ç®—å¾—ä¸Šæ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œæ›´åƒæ˜¯ä¸€ä¸ªå®¹å™¨ã€‚å®ƒä¸å®ç°å…·ä½“çš„åŠŸèƒ½ï¼Œè€Œæ˜¯è´Ÿè´£æ‰€æœ‰ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œåè°ƒå„ä¸ªç»„ä»¶ã€‚</li>
<li><strong>Planner</strong>ï¼šPlanneræ˜¯æ•´ä¸ªç³»ç»Ÿçš„ä¸­æ¢å¤§è„‘ï¼Œä¸»è¦è¿›è¡Œå†³ç­–ï¼Œè´Ÿè´£å°†æ¨¡ç³Šçš„ã€æŠ½è±¡çš„Promptæ‹†è§£ä¸ºå…·ä½“çš„ã€å¯ä»¥æ‰§è¡Œçš„å­ä»»åŠ¡ã€‚Plannerçš„åŸç†æ˜¯ç»“æ„åŒ–Prompt + LLMæ¨ç†ï¼Œå…·ä½“çš„æ€ç»´æ¨¡å¼æœ‰Chain of Thought, Reflection and Act, Tree of Thought, Graph of Thought</li>
<li><strong>Executor</strong>ï¼šæ‰§è¡Œå™¨çš„ä½œç”¨æ˜¯å°† Planner è§„åˆ’çš„Actionè½¬æ¢ä¸ºçœŸå®çš„è¡Œä¸ºï¼ŒExecutorä¼šæ ¹æ®actionè°ƒç”¨toolsï¼Œæ”¶é›†è°ƒç”¨ç»“æœåfeebackç»™Plannerï¼Œç”¨äºå­¦ä¹ å’ŒçŸ«æ­£ï¼›</li>
<li><strong>Tools</strong>ï¼šä¸»è¦ç”¨äºé“¾æ¥çœŸå®çš„ä¸–ç•Œï¼Œæ‰©å±•Agentèƒ½åŠ›ï¼Œä¾‹å¦‚æœç´¢ã€æŸ¥è¯¢ã€è¯·æ±‚ã€æ–‡ä»¶æ“ä½œç­‰ç­‰ã€‚Toolæ˜¯å…·ä½“çš„ï¼Œå¯ä»¥æ‰§è¡Œçš„å‡½æ•°ï¼›</li>
<li><strong>Memory</strong>ï¼šåˆ†ä¸ºçŸ­æœŸè®°å¿†ã€é•¿æœŸè®°å¿†ç­‰ç­‰ï¼ŒçŸ­æœŸè®°å¿†æŒ‡çš„æ˜¯ç”¨æˆ·ä¸Šä¸‹æ–‡çš„å†…å®¹ï¼Œé•¿æœŸè®°å¿†å­˜å‚¨åœ¨æ•°æ®åº“ç”¨ï¼Œä»¥çŸ¥è¯†åº“çš„å½¢å¼ä¸ºPlanneræä¾›å‚è€ƒ</li>
</ol>
<h3 data-id="heading-4">4.ChatBotå’ŒAgent</h3>
<h4 data-id="heading-5">4.1 ä»€ä¹ˆæ˜¯Chatbotï¼Ÿ</h4>
<p>ä¸€å¥è¯å®šä¹‰ï¼Œ<strong>èŠå¤©æœºå™¨äººæ˜¯ä¸€ç§æ—¨åœ¨æ¨¡æ‹Ÿäººç±»å¯¹è¯çš„æ•°å­—ç³»ç»Ÿ</strong>ã€‚</p>
<p>æ—©èµ·çš„èŠå¤©æœºå™¨äººé€šå¸¸éœ€è¦äººä¸ºå®šä¹‰å¯¹è¯è§„åˆ™æˆ–è€…å†…å®¹ï¼Œå¦‚æœç”¨æˆ·ç»™å‡ºäº†è§„åˆ™ä¹‹å¤–çš„è¾“å…¥ï¼Œchatbotå¯èƒ½ä¼šæ‹’ç»æœåŠ¡æˆ–è€…æŠ›å‡ºå¼‚å¸¸ã€‚</p>
<p>2022å¹´åº•ï¼ŒOpenAIå‘å¸ƒçš„ChatGPT3.5ä¸€ç»å‘å¸ƒå°±åœ¨ä¸–ç•ŒèŒƒå›´å†…å¼•èµ·äº†ä¸€åœºäººå·¥æ™ºèƒ½çƒ­æ½®ã€‚ç”¨æˆ·äº‰ç›¸ä½“éªŒå’Œæœºå™¨äººå¯¹è¯ï¼Œç›¸è¾ƒäºä¼ ç»Ÿçš„Chatbotï¼Œç”±LLMé©±åŠ¨çš„Chatbotå…·æœ‰æ›´é«˜çš„å¯¹è¯è‡ªç”±åº¦ï¼Œå¹¶ä¸”èƒ½å¤Ÿæœ‰æ•ˆåº”å¯¹ç”¨æˆ·åˆé’»çš„é—®é¢˜ã€‚</p>
<p>ä¸è¿‡ï¼Œå’Œä¼ ç»Ÿçš„Chatbotä¸€æ ·ï¼ŒAI Chatbotçš„ä¸»è¦ä½œç”¨æ˜¯å¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œæ€è€ƒï¼Œç”Ÿæˆå“åº”ï¼Œè¿”å›ç»™ç”¨æˆ·ã€‚<strong>Chatbotä¸ä¼šæ›¿ç”¨æˆ·å®Œæˆä»»ä½•ä»»åŠ¡ã€‚</strong></p>
<h4 data-id="heading-6">4.2.Chatbot VS AI Agent</h4>













































<table><thead><tr><th>ç»´åº¦</th><th>Chatbot</th><th>Agent</th></tr></thead><tbody><tr><td>å†³ç­–æ¨¡å¼</td><td>åŸºäºæ—¢å®šè§„åˆ™è¢«åŠ¨ï¼Œéµå¾ªè„šæœ¬</td><td>æ™ºèƒ½ã€ä¸»åŠ¨ï¼Œèƒ½å¤Ÿè¿›è¡Œæ¨ç†ã€ä»»åŠ¡æ‹†è§£ç­‰ï¼Œå¹¶é‡‡å–ç‹¬ç«‹çš„è¡ŒåŠ¨</td></tr><tr><td>è¡Œä¸ºæ¨¡å¼</td><td>å›å¤ç®€å•é—®é¢˜ã€å¼•å¯¼ç”¨æˆ·å®Œæˆæµç¨‹æ­¥éª¤</td><td>æ·±å…¥äº†è§£ç”¨æˆ·æ„å›¾ï¼Œå®Œæˆå¤æ‚çš„å¤šæ­¥éª¤çš„æµç¨‹</td></tr><tr><td>å†³ç­–æƒ</td><td>å®Œå…¨ç”±ç”¨æˆ·æŒæ¡</td><td>ç”¨æˆ·/Agentï¼ˆAgentä¼šè¯·æ±‚èµ‹äºˆç›¸å…³æƒé™ï¼‰</td></tr><tr><td>åé¦ˆèƒ½åŠ›</td><td>ä¸ä¼šå›é¡¾æ‰§è¡Œç»“æœï¼Œç”±ç”¨æˆ·åˆ¤æ–­æ‰§è¡Œç»“æœçš„æ­£ç¡®æ€§</td><td>ä¸»åŠ¨è§‚å¯Ÿæ‰§è¡Œç»“æœï¼Œè‹¥å¤±è´¥åˆ™ä¼šè°ƒæ•´ç­–ç•¥é‡æ–°å°è¯•</td></tr><tr><td>ä¸Šä¸‹æ–‡èƒ½åŠ›</td><td>æ¯”è¾ƒå¼±ï¼Œä¸ä¼šå­˜å‚¨ä¸Šä¸‹æ–‡æˆ–è€…å­˜å‚¨å°‘é‡çš„ä¸Šä¸‹æ–‡ä¿¡æ¯</td><td>å¼ºï¼Œä¼šå­˜å‚¨ä¸­é—´ç»“æœå’Œç”¨æˆ·çš„ä¸Šä¸‹æ–‡</td></tr><tr><td>å¯æ§æ€§</td><td>å¼ºï¼Œè¡Œä¸ºå¯æ§ï¼Œå‡ºç°å¹»è§‰çš„é£é™©è¾ƒå°</td><td>å¼±ï¼Œæ‹¥æœ‰è¾ƒé«˜çš„è‡ªç”±åº¦ï¼Œæ¯”è¾ƒå¤§çš„å¹»è§‰é£é™©</td></tr><tr><td>å…¸å‹åœºæ™¯</td><td>å®¢æœé—®ç­”ã€çŸ¥è¯†æŸ¥è¯¢ã€å†…å®¹ç”Ÿæˆã€æ•™å­¦ç­”ç–‘</td><td>è‡ªåŠ¨åŒ–è¿ç»´ã€æ•°æ®åˆ†æä»»åŠ¡ã€ä»£ç ä¿®å¤ã€å¤šæ­¥éª¤ä¸šåŠ¡å¤„ç†</td></tr></tbody></table>
<h3 data-id="heading-7">5.Agentå†…éƒ¨å®ç°</h3>
<h4 data-id="heading-8">5.1.Agentå·¥ä½œæµç¨‹</h4>
<p>é¦–å…ˆæˆ‘ä»¬æ€è€ƒä¸€ä¸‹è¿™ä¸ªé—®é¢˜ï¼š<strong>ä¸ºä»€ä¹ˆè¦è¿›è¡ŒLoopï¼Ÿä¸èƒ½æ‰§è¡Œå®Œæ¯•ä¹‹åç›´æ¥è¿”å›ç»™ç”¨æˆ·å—ï¼Ÿ</strong></p>
<p><em>ä¸€å¥è¯æ€»ç»“ï¼šAgentéœ€è¦é€šè¿‡Loopï¼Œé€šè¿‡æ‰§è¡Œç»“æœä¿®æ­£æ‰§è¡Œç­–ç•¥ï¼Œä»è€Œè¾¾åˆ°æ»¡æ„çš„æ‰§è¡Œç»“æœã€‚</em></p>
<p>æ‰€æœ‰çš„Agentæ‰§è¡Œæµç¨‹å¯ä»¥æŠ½è±¡ä¸ºä»¥ä¸‹æµç¨‹ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
	Perception --&gt; Reasoning
	Reasoning --&gt; Action
	Action --&gt; Feedback
	Feedback --&gt; Memory[Memory Updat]
</code></pre>
<ol>
<li>**Step1:**åˆå§‹åŒ–ï¼Œè®¾ç½®ç›®æ ‡ï¼Œåˆå§‹åŒ–è®°å¿†ã€ä¸Šä¸‹æ–‡ã€æœ€å¤§æ­¥æ•°ä»¥åŠè¶…æ—¶æ—¶é—´ï¼›</li>
<li>**Step2ï¼š**Observeï¼Œè§‚å¯Ÿå½“å‰çŠ¶æ€ã€‚ä¸»è¦æ˜¯æ”¶é›†ç”¨æˆ·çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€Promptä¿¡æ¯ï¼Œå·²ç»æ‰§è¡Œçš„æ­¥éª¤ã€ä¸Šä¸€æ­¥è¿”å›çš„ç»“æœä»¥åŠå½“å‰ç¯å¢ƒçŠ¶æ€ç­‰ï¼›</li>
<li><strong>Step3ï¼šThink / Plan</strong>ã€‚æ ¹æ®å½“å‰çŠ¶æ€è¿›è¡Œæ¨ç†ï¼Œå½“å‰çŠ¶æ€æ˜¯ä»€ä¹ˆï¼Ÿç›®æ ‡ï¼Ÿä¸‹ä¸€æ­¥è°ƒç”¨ä»€ä¹ˆå·¥å…·ï¼Ÿç„¶åè¾“å‡ºç»“æ„åŒ–å†³ç­–ï¼›</li>
<li><strong>Step4ï¼šAct</strong>ã€‚æ‰§è¡Œï¼Œæ ¹æ®LLMè¾“å‡ºçš„å†³ç­–ä¿¡æ¯ï¼Œè°ƒç”¨å¯¹åº”çš„APIæˆ–è€…Toolsï¼Œå¹¶æ•è·æ‰§è¡Œç»“æœæˆ–è€…å¼‚å¸¸ï¼›</li>
<li><strong>Step5ï¼šObserve FeedBack</strong>ã€‚è§‚å¯Ÿæ‰§è¡Œç»“æœã€‚</li>
<li><strong>Step6ï¼šUpdate Memory</strong>ã€‚å°†æœ¬è½®ä¿¡æ¯å†™å…¥åˆ°STMå’ŒLTMä¸­ã€‚</li>
<li><strong>Step7ï¼šStop Decision</strong>ã€‚ç»ˆæ­¢åˆ¤æ–­ï¼Œç›®æ ‡æ˜¯å¦å®Œæˆï¼Œæ˜¯å¦è¾¾åˆ°ç»ˆæ­¢æ¡ä»¶ï¼Ÿæ˜¯å¦å‡ºç°äº†ä¸å¯æ¢å¤çš„é”™è¯¯ï¼Ÿ</li>
<li><strong>Step8ï¼šContinue Loop</strong>ã€‚å¦‚æœæ²¡æœ‰ç»ˆæ­¢å¾ªç¯ï¼Œåˆ™è¿›å…¥ä¸‹ä¸€è½®å¾ªç¯ã€‚</li>
</ol>
<h4 data-id="heading-9">5.2.ä¼ªä»£ç </h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1.åˆå§‹åŒ–</span>
init(context);

<span class="hljs-comment">// 2.ä¸»å¾ªç¯é€»è¾‘</span>
<span class="hljs-keyword">while</span> (AgentContext.state == RUNNING) {
    <span class="hljs-comment">// 2.1.è§‚æµ‹å½“å‰çŠ¶æ€</span>
    <span class="hljs-type">Observation</span> <span class="hljs-variable">curEnv</span> <span class="hljs-operator">=</span> observeEnv(context);
    
    <span class="hljs-comment">// 2.2.è°ƒç”¨LLMè¿›è¡Œåˆ†æå†³ç­–</span>
    <span class="hljs-type">LLMReasonResult</span> <span class="hljs-variable">decisions</span> <span class="hljs-operator">=</span> LLMService.reason(
   		context.goal, context.memory, curEnv);
    
    <span class="hljs-comment">// 2.3.æ ¹æ®å†³ç­–ç±»å‹å‡†å¤‡æ‰§è¡Œ</span>
    <span class="hljs-keyword">if</span> (decisions.type == FINISH) {
        <span class="hljs-comment">// a.ç›´æ¥è¿”å›ç»“æœ</span>
        context.state = DONE;
        context.result = decisions.result;
        <span class="hljs-keyword">break</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (decision.type == ACTION) {
        <span class="hljs-type">Action</span> <span class="hljs-variable">act</span> <span class="hljs-operator">=</span> decisions.getAction();
        <span class="hljs-type">ActionContext</span> <span class="hljs-variable">ac</span> <span class="hljs-operator">=</span> decisions.getInput();
        
        <span class="hljs-comment">// è°ƒç”¨æ‰§è¡Œå™¨æ‰§è¡ŒåŠ¨ä½œ</span>
        <span class="hljs-type">Executor</span> <span class="hljs-variable">exc</span> <span class="hljs-operator">=</span> Executors.builder().action(act).context(ac).build();
        <span class="hljs-type">ActionResult</span> <span class="hljs-variable">ar</span> <span class="hljs-operator">=</span> buildDefaultResult();
        <span class="hljs-keyword">try</span> {
            ar = exc.excute();
        } <span class="hljs-keyword">catch</span> (RuntimeException e) {
            <span class="hljs-comment">// print log</span>
        }
        <span class="hljs-comment">// æ›´æ–°è®°å¿†</span>
        context.updateMemory(act, ac, ar);
    }
    
    <span class="hljs-comment">// æ­¥æ•°è‡ªå¢</span>
    context.increaseStep();
    
    <span class="hljs-comment">// åˆ¤æ–­å¾ªç¯ç»“æŸæ¡ä»¶</span>
    <span class="hljs-keyword">if</span> (context.getStep() &gt;= context.maxStep) {
        context.status = FAILED;
        <span class="hljs-keyword">break</span>;
    }
}
</code></pre>
<h4 data-id="heading-10">5.3.Javaå®ç°Agent</h4>
<h5 data-id="heading-11">5.3.1.æ¨¡å‹</h5>
<pre><code class="hljs language-mermaid" lang="mermaid">classDiagram
	class AgentContext {
		+ String goal
		+ int stepCounts
		+ AgentState state
		+ getState() AgentState
		+ incrementStep() void
	}
	
</code></pre>
<h5 data-id="heading-12">5.3.2.æ¥å£è®¾è®¡</h5>
<p><strong>1.AgentæŠ½è±¡ç±»</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Agent</span>{ AgentResult <span class="hljs-title function_">run</span><span class="hljs-params">(AgentInput input)</span>; }
</code></pre>
<p><strong>2.AgentLooper å¾ªç¯ç¼–æ’å™¨</strong></p>
<p>ä¸»è¦è´Ÿè´£<code>while</code>å¾ªç¯çš„æµç¨‹ç¼–æ’ä»¥åŠ<code>context</code>çš„çŠ¶æ€æ¨è¿›ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">AgentLoop</span>{
    AgentResult <span class="hljs-title function_">execute</span><span class="hljs-params">(AgentContext cxt)</span>;
}
</code></pre>
<p><strong>3.AgentObserver è§‚å¯Ÿè€…</strong></p>
<p>ä¸»è¦è´Ÿè´£æ„å»ºä¸Šä¸‹æ–‡ï¼Œåˆ†æå½“å‰æ‰§è¡Œç¯å¢ƒã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">AgentObserver</span> {
    Observation <span class="hljs-title function_">observe</span><span class="hljs-params">(AgentContext ctx)</span>;
}
</code></pre>
<p><strong>4.AgentPlanner å†³ç­–å™¨</strong></p>
<p>è°ƒç”¨LLMå¯¹è¾“å…¥è¿›è¡Œæ€è€ƒå’Œè§„åˆ’ï¼Œå¾—å‡ºå…·ä½“çš„æ‰§è¡Œç­–ç•¥ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">AgentPlanner</span> {
    AgentDecision <span class="hljs-title function_">decideAfterReasoning</span><span class="hljs-params">(Observation obs, AgentContext ctx)</span>;
}
</code></pre>
<p><strong>5.Executor æ‰§è¡Œå™¨</strong></p>
<p>è·å–æ‰§è¡Œè®¡åˆ’ï¼ŒæŒ‰ç…§æ‰§è¡Œè®¡åˆ’æ‰§è¡Œå¯¹åº”çš„Actionã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">AgentExecutor</span> {
    ActionResult <span class="hljs-title function_">execute</span><span class="hljs-params">(Action ac, AgentState ctx)</span>;
}
</code></pre>
<p><strong>6.Tool å¤–éƒ¨èƒ½åŠ›</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Tool</span> {
    ToolResult <span class="hljs-title function_">run</span><span class="hljs-params">(Map params)</span>;
}
</code></pre>
<p><strong>7.Agent Memory è®°å¿†ç»„ä»¶</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">AgentMemory</span> {
    <span class="hljs-comment">// ä¿å­˜è®°å¿†</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">store</span><span class="hljs-params">(MemoryRecord record)</span>;
    
    <span class="hljs-comment">// è·å–è®°å¿†è®°å½•</span>
    List&lt;MemoryRecord&gt; <span class="hljs-title function_">recall</span><span class="hljs-params">(RecallRequest req)</span>;
}
</code></pre>
<h5 data-id="heading-13">5.3.3.è½åœ°å®ç°</h5>




























































<table><thead><tr><th>åŠŸèƒ½ç‚¹</th><th>å®ç°</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>LLMæ¥å…¥</td><td>GLM API</td><td>ä¾¿å®œï¼Œç¨³å®š</td></tr><tr><td>éé˜»å¡è°ƒç”¨</td><td>Spring webClient</td><td>ä¸€å®šè¦éé˜»å¡è°ƒç”¨ï¼Œç”¨æˆ·ä½“æ„Ÿå¥½</td></tr><tr><td>ç»“æ„åŒ–è¾“å‡º</td><td>Jackson</td><td/></tr><tr><td>ç”Ÿå‘½å‘¨æœŸç®¡ç†</td><td>SpringBoot</td><td>Beanç®¡ç†ã€é…ç½®ç®¡ç†</td></tr><tr><td>Agentè¿è¡ŒçŠ¶æ€æµè½¬</td><td>æœ‰é™çŠ¶æ€æœº</td><td>é˜²æ­¢å‡ºç°éæ³•çŠ¶æ€çš„æµè½¬ï¼Œæ›´åŠ å®‰å…¨</td></tr><tr><td>æç¤ºè¯æ¨¡æ¿åŠ¨æ€é…ç½®</td><td>Nacos</td><td>é…ç½®ä¸­å¿ƒï¼Œæ”¯æŒé…ç½®çƒ­æ›´æ–°å’Œé…ç½®çš„ç‰ˆæœ¬ç®¡ç†</td></tr><tr><td>Toolæ‰§è¡Œ</td><td>ç­–ç•¥æ¨¡å¼</td><td>é€šè¿‡ç­–ç•¥æ¨¡å¼è·å–Toolçš„æ‰§è¡Œå™¨</td></tr><tr><td>Toolæ³¨å†Œã€å‘ç°</td><td>SPI/Registry</td><td/></tr><tr><td>STM</td><td>Redis / Caffeine</td><td>ä½¿ç”¨ç¼“å­˜æ¥ä¿å­˜ä¸Šä¸‹æ–‡</td></tr><tr><td>LTM</td><td>DB</td><td>é•¿æ—¶è®°å¿†åº”å½“æŒä¹…åŒ–æ•°æ®åº“ä¸­</td></tr></tbody></table>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Listé›†åˆçš„å¯¹è±¡ä¼ è¾“çš„ä¸¤ç§æ–¹å¼]]></title>    <link>https://juejin.cn/post/7603643385815547956</link>    <guid>https://juejin.cn/post/7603643385815547956</guid>    <pubDate>2026-02-07T08:54:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603643385815547956" data-draft-id="7603588665567936552" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Listé›†åˆçš„å¯¹è±¡ä¼ è¾“çš„ä¸¤ç§æ–¹å¼"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2026-02-07T08:54:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä½•ä¸­åº”"/> <meta itemprop="url" content="https://juejin.cn/user/1435305504958535"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Listé›†åˆçš„å¯¹è±¡ä¼ è¾“çš„ä¸¤ç§æ–¹å¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1435305504958535/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä½•ä¸­åº”
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T08:54:04.000Z" title="Sat Feb 07 2026 08:54:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¯´æ˜ï¼šåœ¨ä¸€äº›ç‰¹å®šçš„æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦æŠŠå¯¹è±¡ä¸­çš„Listé›†åˆå±æ€§å­˜å…¥åˆ°æ•°æ®åº“ä¸­ï¼Œä¹‹åæŠŠè¯¥å­—æ®µå–å‡ºæ¥è½¬ä¸ºListé›†åˆçš„å¯¹è±¡ä½¿ç”¨ï¼ˆå¦‚ä¸‹å›¾ï¼‰</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/04738a109bf4470089581f8951c902fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771059245&amp;x-signature=FkdDLoA%2FH2ar%2BhI3fj1%2FFDLK0S8%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>è‡ªå®šä¹‰å¯¹è±¡</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> {

    <span class="hljs-comment">/**
     * ID
     */</span>
    <span class="hljs-keyword">private</span> Integer id;

    <span class="hljs-comment">/**
     * ç”¨æˆ·å
     */</span>
    <span class="hljs-keyword">private</span> String username;

    <span class="hljs-comment">/**
     * å¯†ç 
     */</span>
    <span class="hljs-keyword">private</span> String password;

    <span class="hljs-comment">/**
     * ç”µè¯
     */</span>
    <span class="hljs-keyword">private</span> String phone;

}
</code></pre>
<p>å³æŠŠè‡ªå®šä¹‰å¯¹è±¡çš„Listé›†åˆè½¬ä¸ºJsonå­—ç¬¦ä¸²ï¼Œå†è½¬å›Listé›†åˆï¼Œæœ¬æ–‡ä»‹ç»ä¸¤ç§å®ç°æ–¹å¼ï¼›</p>
<h2 data-id="heading-0">FastJsonä¾èµ–</h2>
<p>FastJsonæ˜¯é˜¿é‡Œå·´å·´æä¾›çš„å°†æ•°æ®è½¬ä¸ºJsonçš„ä¸€ç³»åˆ—æ“ä½œçš„å·¥å…·ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹çš„ä¸¤ä¸ªæ–¹æ³•å®ç°</p>
<pre><code class="hljs language-xml" lang="xml">	<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
	    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
	    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>fastjson<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
	    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.10<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-java" lang="java">        ArrayList&lt;User&gt; users = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">1</span>,<span class="hljs-string">"root"</span>,<span class="hljs-string">"123456"</span>,<span class="hljs-string">"123456789"</span>));
        users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">2</span>,<span class="hljs-string">"admin"</span>,<span class="hljs-string">"123456"</span>,<span class="hljs-string">"123456789"</span>));
        users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">3</span>,<span class="hljs-string">"guest"</span>,<span class="hljs-string">"123456"</span>,<span class="hljs-string">"123456789"</span>));

        System.out.println(<span class="hljs-string">"Listé›†åˆtoStringæ ¼å¼ = "</span> + users);

        System.out.println(<span class="hljs-string">"==========================================="</span>);

        <span class="hljs-comment">// fastjson</span>
        <span class="hljs-type">JSONArray</span> <span class="hljs-variable">jsonArray</span> <span class="hljs-operator">=</span> JSONArray.parseArray(users.toString());
        System.out.println(<span class="hljs-string">"jsonArray = "</span> + jsonArray);

        System.out.println(<span class="hljs-string">"==========================================="</span>);

        List&lt;User&gt; fastJsonList = jsonArray.toJavaList(User.class);
        System.out.println(<span class="hljs-string">"fastJsonList.get(0) = "</span> + fastJsonList.get(<span class="hljs-number">0</span>));
</code></pre>
<p>ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œéœ€è¦è¦†å†™Userå¯¹è±¡çš„toString()æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"{"</span> +
                <span class="hljs-string">"id:"</span> + id +
                <span class="hljs-string">", username:'"</span> + username + <span class="hljs-string">'\''</span> +
                <span class="hljs-string">", password:'"</span> + password + <span class="hljs-string">'\''</span> +
                <span class="hljs-string">", phone:'"</span> + phone + <span class="hljs-string">'\''</span> +
                <span class="hljs-string">'}'</span>;
    }
</code></pre>
<p>æ‰§è¡Œç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°è½¬æ¢å®Œæˆï¼›</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/98ff6b1c78a143c08379477fab98df2a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771059245&amp;x-signature=OsN07Vfz%2FmHEEV7ajbOCj5Bfb1s%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-1">Hutoolä¾èµ–</h2>
<p>Hutoolæä¾›äº†å„ä¸ªæ–¹é¢çš„å·¥å…·ï¼Œå¯ä½¿ç”¨å…¶ä¸­çš„JSONUtilå®ç°ç›®çš„ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml">	<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
	    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.hutool<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
	    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hutool-all<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
	    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.8.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-java" lang="java">        ArrayList&lt;User&gt; users = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">1</span>,<span class="hljs-string">"root"</span>,<span class="hljs-string">"123456"</span>,<span class="hljs-string">"123456789"</span>));
        users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">2</span>,<span class="hljs-string">"admin"</span>,<span class="hljs-string">"123456"</span>,<span class="hljs-string">"123456789"</span>));
        users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">3</span>,<span class="hljs-string">"guest"</span>,<span class="hljs-string">"123456"</span>,<span class="hljs-string">"123456789"</span>));

        System.out.println(<span class="hljs-string">"Listé›†åˆtoStringæ ¼å¼ = "</span> + users);

        System.out.println(<span class="hljs-string">"==========================================="</span>);

        <span class="hljs-type">String</span> <span class="hljs-variable">jsonStr</span> <span class="hljs-operator">=</span> JSONUtil.toJsonStr(users);
        System.out.println(<span class="hljs-string">"jsonStr = "</span> + jsonStr);

        System.out.println(<span class="hljs-string">"==========================================="</span>);
        List&lt;User&gt; hutoolList = JSONUtil.toList(jsonStr, User.class);
        System.out.println(<span class="hljs-string">"hutoolList.get(0) = "</span> + hutoolList.get(<span class="hljs-number">0</span>));
</code></pre>
<p>æ‰§è¡Œç»“æœ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4f52e51ade14f46810525b8a62aa382~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771059245&amp;x-signature=%2BrR%2FtNF2ynEG31tCkQDvQTv85ig%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-2">æ€»ç»“</h2>
<p>ä½¿ç”¨fastjsonã€hutoolå·¥å…·åŒ…éƒ½å¯ä»¥è¾¾åˆ°ç›®çš„ï¼Œå»ºè®®ä½¿ç”¨hutoolå·¥å…·åŒ…ï¼Œhutoolæä¾›äº†è®¸å¤šæˆ‘ä»¬ç»å¸¸ä¼šä½¿ç”¨åˆ°çš„ä¸€äº›æ“ä½œï¼Œå¦‚ç”Ÿæˆtokenã€æ•°å­—æ ¼å¼è½¬æ¢ã€å¯¹è±¡éç©ºåˆ¤æ–­ã€æ•°å­—åŠ å¯†ç­‰ç­‰ï¼ŒjsonUtilåªæ˜¯å…¶ä¸­ä¸€ä¸ªã€‚</p>
<p>è€Œä¸”å¦‚æœä½¿ç”¨fastjsonï¼Œè¿˜éœ€è¦é‡å†™å¯¹è±¡çš„toString()æ–¹æ³•ï¼Œè¾ƒä¸ºéº»çƒ¦ã€‚</p>
<h2 data-id="heading-3">é¦–æ¬¡å‘å¸ƒ</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhezhongying.blog.csdn.net%2Farticle%2Fdetails%2F132077704" target="_blank" title="https://hezhongying.blog.csdn.net/article/details/132077704" ref="nofollow noopener noreferrer">hezhongying.blog.csdn.net/article/detâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨String.valueOf()çš„å‘]]></title>    <link>https://juejin.cn/post/7603616672926892047</link>    <guid>https://juejin.cn/post/7603616672926892047</guid>    <pubDate>2026-02-07T08:55:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603616672926892047" data-draft-id="7603575399256621096" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨String.valueOf()çš„å‘"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2026-02-07T08:55:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä½•ä¸­åº”"/> <meta itemprop="url" content="https://juejin.cn/user/1435305504958535"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨String.valueOf()çš„å‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1435305504958535/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä½•ä¸­åº”
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T08:55:36.000Z" title="Sat Feb 07 2026 08:55:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¯´æ˜ï¼šè®°å½•ä¸€æ¬¡ä½¿ç”¨String.valueOf()çš„å‘ï¼Œä»¥ä¸‹æ˜¯ä¸€æ®µæœ‰é—®é¢˜çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-type">String</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> String.valueOf(listData.get(<span class="hljs-number">0</span>).get(<span class="hljs-number">0</span>).get(<span class="hljs-string">"count"</span>);
	<span class="hljs-keyword">if</span> (StringUtils.isBlank(count) || <span class="hljs-string">"0"</span>.equals(count)) {
	    result.setResult(page);
	    <span class="hljs-keyword">return</span> result;
	}
</code></pre>
<h2 data-id="heading-0">é—®é¢˜åˆ†æ</h2>
<p>å…¶ä¸­ï¼ŒlistDataæ˜¯è°ƒç”¨æ•°æ®åº“å­˜å‚¨è¿‡ç¨‹ï¼Œè¿”å›çš„æ•°æ®é›†åˆï¼Œæ˜¯List&lt;List&lt;Map&lt;String,String&gt;ç±»å‹çš„ï¼Œè¡¨ç¤ºå¤šä¸ªç»“æœé›†ï¼Œæ¯ä¸ªç»“æœé›†æœ‰å¤šæ¡æ•°æ®ï¼Œè€Œç»“æœé›†1ï¼Œé€šå¸¸è¡¨ç¤ºè®°å½•çš„æ€»æ¡æ•°ï¼Œå³countï¼›</p>
<p>è¿™æ®µä»£ç å°±æ˜¯å°†ç¬¬1ä¸ªç»“æœé›†ä¸­çš„countå­—æ®µå€¼è·å–å‡ºæ¥ï¼Œå¹¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚</p>
<p>æ­£å¸¸æƒ…å†µï¼Œè¿™æ®µä»£ç æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œåé¢ä¹Ÿå¯¹countçš„å€¼åšäº†æ ¡éªŒï¼Œå¦‚æœcountå€¼ä¸ºnullæˆ–è€…0ï¼ˆ<code>StringUtils.isBlank(count) </code>ï¼‰ï¼Œéƒ½ä¸ä¼šå¾€ä¸‹èµ°ï¼›</p>
<hr/>
<p>ç°åœ¨çš„é—®é¢˜æ˜¯ï¼Œå½“listDataä¸­ï¼Œç¬¬1ä¸ªç»“æœé›†ä¸­æ²¡æœ‰countæ—¶ï¼Œè¿™æ®µä»£ç å°±æœ‰é—®é¢˜äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ff9767aeae24414a971ef4ba45383793~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771059340&amp;x-signature=X3Ck0IFy18E4z%2FImF3Lw%2FaqSoZk%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>é—®é¢˜æ˜¯è¿™ä¸ªæ–¹æ³•ï¼Œå½“è°ƒç”¨å­˜å‚¨è¿‡ç¨‹è¿”å›çš„ç»“æœé›†ä¸­ï¼Œæ²¡æœ‰countè¿™ä¸ªç»“æœé›†ï¼ŒString.valueOf()é‡Œé¢çš„å†…å®¹æ˜¯nullï¼Œæ‰€ä»¥==String countä¼šå¾—åˆ°ä¸€ä¸ªâ€œnullâ€å­—ç¬¦ä¸²ï¼Œè€Œåœ¨ä¸‹é¢çš„ifåˆ¤æ–­ä¸­ï¼ŒStringUtils.isBlank(count)çš„è¿”å›ç»“æœä¼šæ˜¯falseï¼Œè¿™æ ·å°±è·³è¿‡äº†å¯¹countçš„ç©ºå€¼åˆ¤æ–­==ã€‚</p>
<h2 data-id="heading-1">String.valueOf()</h2>
<p>ä¸ºä»€ä¹ˆnullä¼šè¢«è½¬ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²å‘¢ï¼Ÿæˆ‘ä»¬åˆ†æä¸€ä¸‹è¿™ä¸ªæ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-comment">// æ–¹å¼ä¸€ï¼šå°†ä¸€ä¸ªå¯¹è±¡èµ‹å€¼ä¸ºnullï¼Œç„¶åè°ƒç”¨String.valueOf()æ–¹æ³•</span>
	<span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
	System.out.println(String.valueOf(str));
	
	<span class="hljs-comment">// æ–¹å¼äºŒï¼šç›´æ¥å°†nullä½œä¸ºå‚æ•°ä¼ å…¥</span>
	System.out.println(String.valueOf(<span class="hljs-literal">null</span>));
</code></pre>
<p>è¿™ä¸¤ç§æ–¹å¼ï¼Œå‰ä¸€ç§ä¼šæ‰“å°â€œnullâ€ï¼Œåä¸€ç§ä¼šæŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼›</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65ab93cc9718453ca8d812e346ce55c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771059340&amp;x-signature=20G4GXu5URb27lXsumA%2FXH7qsfg%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå£°æ˜äº†çš„å¯¹è±¡ï¼Œèµ‹å€¼ä¸ºnullï¼Œä½œä¸ºå‚æ•°ä¼ å…¥String.valueOf()ä¼šè¿”å›nullå­—ç¬¦ä¸²ã€‚æ‰€ä»¥åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œä¸èƒ½ä½¿ç”¨String.valueOf()å°†å–å‡ºçš„å€¼å†è½¬ä¸ºStringç±»å‹ã€‚ä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-type">String</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> listData.get(<span class="hljs-number">0</span>).get(<span class="hljs-number">0</span>).get(<span class="hljs-string">"count"</span>);
	<span class="hljs-keyword">if</span> (StringUtils.isBlank(count) || <span class="hljs-string">"0"</span>.equals(count)) {
	    result.setResult(page);
	    <span class="hljs-keyword">return</span> result;
	}
</code></pre>
<h2 data-id="heading-2">é¦–æ¬¡å‘å¸ƒ</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhezhongying.blog.csdn.net%2Farticle%2Fdetails%2F134301560" target="_blank" title="https://hezhongying.blog.csdn.net/article/details/134301560" ref="nofollow noopener noreferrer">hezhongying.blog.csdn.net/article/detâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨Javaä»£ç å‘é€QQã€ç½‘æ˜“ç”µå­é‚®ä»¶]]></title>    <link>https://juejin.cn/post/7603588665567969320</link>    <guid>https://juejin.cn/post/7603588665567969320</guid>    <pubDate>2026-02-07T08:58:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603588665567969320" data-draft-id="7603575399256653864" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨Javaä»£ç å‘é€QQã€ç½‘æ˜“ç”µå­é‚®ä»¶"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2026-02-07T08:58:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä½•ä¸­åº”"/> <meta itemprop="url" content="https://juejin.cn/user/1435305504958535"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨Javaä»£ç å‘é€QQã€ç½‘æ˜“ç”µå­é‚®ä»¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1435305504958535/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä½•ä¸­åº”
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T08:58:05.000Z" title="Sat Feb 07 2026 08:58:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¯´æ˜ï¼šæœ¬æ–‡ä»‹ç»å¦‚ä½•ä½¿ç”¨Javaä»£ç å‘é€é‚®ä»¶ï¼›</p>
<h2 data-id="heading-0">å®ç°</h2>
<h3 data-id="heading-1">Step1ï¼šå¼•å…¥ä¾èµ–</h3>
<p>åˆ›å»ºä¸€ä¸ªMavené¡¹ç›®ï¼Œå¼•å…¥ä¸‹é¢ä¸¤ä¸ªä¾èµ–ï¼›</p>
<pre><code class="hljs language-xml" lang="xml">        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.hutool<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hutool-all<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.8.27<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.sun.mail<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>javax.mail<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.6.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h3 data-id="heading-2">Step2ï¼šç¼–ç </h3>
<p>é¦–å…ˆï¼Œå†™ä¸€ä¸ªå·¥å…·ç±»ï¼Œè¯¥å·¥å…·ç±»æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªç”¨æ¥è·å–é‚®ä»¶å¯¹è±¡ï¼Œä¸€ä¸ªç”¨æ¥å‘é€é‚®ä»¶ï¼›</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> cn.hutool.core.util.StrUtil;
<span class="hljs-keyword">import</span> cn.hutool.extra.mail.MailAccount;
<span class="hljs-keyword">import</span> cn.hutool.extra.mail.MailUtil;

<span class="hljs-comment">/**
 * é‚®ä»¶å‘é€å·¥å…·ç±»
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmailSenderUtil</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">EmailSenderUtil</span><span class="hljs-params">()</span> {
    }

    <span class="hljs-comment">/**
     * è·å–é‚®ç®±å®¢æˆ·ç«¯
     *
     * <span class="hljs-doctag">@param</span> smtpHost      smtpæœåŠ¡å™¨åœ°å€
     * <span class="hljs-doctag">@param</span> smtpPort      smtpæœåŠ¡å™¨ç«¯å£
     * <span class="hljs-doctag">@param</span> emailUsername é‚®ç®±ç”¨æˆ·å
     * <span class="hljs-doctag">@param</span> emailPassword é‚®ç®±æˆæƒç 
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> MailAccount <span class="hljs-title function_">getMailClient</span><span class="hljs-params">(String smtpHost, <span class="hljs-type">int</span> smtpPort, String emailUsername, String emailPassword)</span> {
        <span class="hljs-type">MailAccount</span> <span class="hljs-variable">account</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MailAccount</span>();
        account.setHost(smtpHost);
        account.setPort(smtpPort);
        account.setAuth(<span class="hljs-literal">true</span>);
        account.setFrom(emailUsername);
        account.setUser(emailUsername);
        account.setPass(emailPassword);
        <span class="hljs-keyword">return</span> account;
    }

    <span class="hljs-comment">/**
     * å‘é€é‚®ä»¶
     *
     * <span class="hljs-doctag">@param</span> account é‚®ç®±å®¢æˆ·ç«¯
     * <span class="hljs-doctag">@param</span> to      æ¥æ”¶äººé‚®ç®±åœ°å€
     * <span class="hljs-doctag">@param</span> subject é‚®ä»¶ä¸»é¢˜
     * <span class="hljs-doctag">@param</span> content é‚®ä»¶å†…å®¹
     * <span class="hljs-doctag">@param</span> isHtml  æ˜¯å¦æ˜¯htmlæ ¼å¼
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendEmail</span><span class="hljs-params">(MailAccount account, String to, String subject, String content, <span class="hljs-type">boolean</span> isHtml)</span> {
        <span class="hljs-keyword">if</span> (StrUtil.isBlank(to)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"æ”¶ä»¶äººé‚®ç®±åœ°å€ä¸èƒ½ä¸ºç©º"</span>);
        }
        <span class="hljs-keyword">if</span> (StrUtil.isBlank(subject)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"é‚®ä»¶ä¸»é¢˜ä¸èƒ½ä¸ºç©º"</span>);
        }
        <span class="hljs-keyword">if</span> (StrUtil.isBlank(content)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"é‚®ä»¶å†…å®¹ä¸èƒ½ä¸ºç©º"</span>);
        }
        <span class="hljs-keyword">try</span> {
            MailUtil.send(account, to, subject, content, isHtml);
            System.out.println(<span class="hljs-string">"é‚®ä»¶å‘é€æˆåŠŸ"</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
            System.out.println(<span class="hljs-string">"é‚®ä»¶å‘é€å¤±è´¥"</span>);
        }
    }
}
</code></pre>
<h3 data-id="heading-3">Step3ï¼šè·å–æˆæƒç </h3>
<p>å‘é€äººçš„é‚®ç®±è´¦æˆ·éœ€è¦å¼€é€šSMTPæœåŠ¡ï¼Œå…è®¸é€šè¿‡å®¢æˆ·ç«¯å‘é€é‚®ä»¶ï¼Œè¿™é‡Œä»‹ç»QQé‚®ç®±ã€ç½‘æ˜“é‚®ç®±å¼€é€šSMTPæœåŠ¡å’Œè·å–æˆæƒç çš„æ­¥éª¤ã€‚</p>
<p>ï¼ˆQQé‚®ç®±ï¼ŒSMTP_HOSTæ˜¯ï¼š<code>smtp.qq.com</code>ï¼ŒPORTç”¨ï¼š<code>465æˆ–587</code>ï¼‰</p>
<p>æ–‡æ¡£å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwx.mail.qq.com%2Flist%2Freadtemplate%3Fname%3Dapp_intro.html%23%2Fagreement%2FauthorizationCode" target="_blank" title="https://wx.mail.qq.com/list/readtemplate?name=app_intro.html#/agreement/authorizationCode" ref="nofollow noopener noreferrer">wx.mail.qq.com/list/readteâ€¦</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a23b8596a1384f079d39fa5867a09071~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771059485&amp;x-signature=ZjOVb%2B0%2FViQabA0VijGQsK0dcyA%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ï¼ˆç½‘æ˜“é‚®ç®±ï¼ŒSMTP_HOSTæ˜¯ï¼š<code>smtp.163.com</code>ï¼ŒPORTç”¨ï¼š<code>25</code>ï¼‰</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fa2f688fae3544a4a3e7d39a932b8068~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771059485&amp;x-signature=zHoua0gY1TBv99XBWhgKqaC3hlw%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>è·å–æˆæƒç çš„æ–¹å¼éƒ½å·®ä¸å¤šï¼Œç”¨ç»‘å®šçš„æ‰‹æœºç»™é‚®ä»¶å®˜æ–¹å‘çŸ­ä¿¡ï¼Œç„¶åè·å–æˆæƒç </p>
<h3 data-id="heading-4">Step4ï¼šæµ‹è¯•</h3>
<p>å†™ä¸€ä¸ªmainæ–¹æ³•ï¼Œæµ‹è¯•å‘é€é‚®ä»¶</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> cn.hutool.extra.mail.MailAccount;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmailSentTest</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// é‚®ä»¶æ¥æ”¶äººï¼Œå¤šä¸ªæ¥æ”¶äººä½¿ç”¨é€—å·æˆ–è€…åˆ†å·éš”å¼€</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">to</span> <span class="hljs-operator">=</span> <span class="hljs-string">""</span>;
        <span class="hljs-comment">// é‚®ä»¶ä¸»é¢˜</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">subject</span> <span class="hljs-operator">=</span> <span class="hljs-string">"æµ‹è¯•é‚®ä»¶"</span>;
        <span class="hljs-comment">// é‚®ä»¶å†…å®¹</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> <span class="hljs-string">"è¿™æ˜¯ä¸€å°æµ‹è¯•é‚®ä»¶"</span>;

        <span class="hljs-comment">// è·å–é‚®ç®±å®¢æˆ·ç«¯</span>
        <span class="hljs-type">MailAccount</span> <span class="hljs-variable">account</span> <span class="hljs-operator">=</span> EmailSendUtil.getMailClient(<span class="hljs-string">"smtp.qq.com"</span>, <span class="hljs-number">587</span>,
                <span class="hljs-string">"å‘é€æ–¹qqè´¦å·"</span>, <span class="hljs-string">"å‘é€æ–¹æˆæƒç "</span>);

        <span class="hljs-comment">// å‘é€é‚®ä»¶</span>
        EmailSendUtil.sendEmail(account, to, subject, content, <span class="hljs-literal">false</span>);
    }
}
</code></pre>
<p>å‘é€æˆåŠŸ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7162de05eae45aa851c0f4869fedf54~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771059485&amp;x-signature=h0bwGN3Jezp8FoUQJlkAlIB2FkA%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d9fbb66f55b490cb9c16050428a2b68~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771059485&amp;x-signature=E%2FN8qqWRoeiW5MhFKUtIBLUq8L0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-5">æ€»ç»“</h2>
<p>æœ¬æ–‡ä»‹ç»äº†å¦‚ä½•ç”¨Hutoolå·¥å…·åŒ…å°è£…çš„MailUtilå‘é€é‚®ä»¶ï¼ŒåŠQQé‚®ç®±ã€ç½‘æ˜“é‚®ç®±å¦‚ä½•å¼€é€šSMTPæœåŠ¡å’Œè·å–æˆæƒç ã€‚</p>
<p>å‚è€ƒä¸‹é¢è¿™ç¯‡æ–‡ç« ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fqq_34874784%2Farticle%2Fdetails%2F136237042" target="_blank" title="https://blog.csdn.net/qq_34874784/article/details/136237042" ref="nofollow noopener noreferrer">java ç”¨163é‚®ç®±å‘é€é‚®ä»¶</a></li>
</ul>
<h2 data-id="heading-6">é¦–æ¬¡å‘å¸ƒ</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhezhongying.blog.csdn.net%2Farticle%2Fdetails%2F139130565" target="_blank" title="https://hezhongying.blog.csdn.net/article/details/139130565" ref="nofollow noopener noreferrer">hezhongying.blog.csdn.net/article/detâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å®æˆ˜è§£å¯†ï¼šæˆ‘æ˜¯å¦‚ä½•ç”¨Vue 3 + Bufferå®ç°AIâ€œæ‰“å­—æœºâ€æ•ˆæœçš„]]></title>    <link>https://juejin.cn/post/7603595309232898058</link>    <guid>https://juejin.cn/post/7603595309232898058</guid>    <pubDate>2026-02-07T08:57:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603595309232898058" data-draft-id="7603591775392874523" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å®æˆ˜è§£å¯†ï¼šæˆ‘æ˜¯å¦‚ä½•ç”¨Vue 3 + Bufferå®ç°AIâ€œæ‰“å­—æœºâ€æ•ˆæœçš„"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2026-02-07T08:57:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸ä¼šæ•²ä»£ç 1"/> <meta itemprop="url" content="https://juejin.cn/user/1927884034804425"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å®æˆ˜è§£å¯†ï¼šæˆ‘æ˜¯å¦‚ä½•ç”¨Vue 3 + Bufferå®ç°AIâ€œæ‰“å­—æœºâ€æ•ˆæœçš„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1927884034804425/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸ä¼šæ•²ä»£ç 1
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T08:57:55.000Z" title="Sat Feb 07 2026 08:57:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    11
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å®æˆ˜è§£å¯†ï¼šæˆ‘æ˜¯å¦‚ä½•ç”¨Vue 3 + Bufferå®ç°AIâ€œæ‰“å­—æœºâ€æ•ˆæœçš„</h2>
<h3 data-id="heading-1">ä»ä¸€è¡Œä»£ç åˆ°ä¸€ä¸ªå®Œæ•´AIèŠå¤©åº”ç”¨</h3>
<p>æœ€è¿‘æˆ‘åœ¨åšä¸€ä¸ªAIèŠå¤©åº”ç”¨æ—¶ï¼Œé‡åˆ°äº†ä¸€ä¸ªå…³é”®é—®é¢˜ï¼š<strong>å¦‚ä½•è®©AIçš„å›å¤åƒçœŸäººæ‰“å­—ä¸€æ ·ï¼Œä¸€ä¸ªå­—ä¸€ä¸ªå­—åœ°å‡ºç°ï¼Ÿ</strong> Â ç»è¿‡ä¸€ç•ªæ¢ç´¢ï¼Œæˆ‘å‘ç°äº†æµå¼è¾“å‡º + Bufferçš„ç»„åˆæ–¹æ¡ˆã€‚ä»Šå¤©ï¼Œæˆ‘å°±ç”¨æˆ‘çš„å®é™…ä»£ç ï¼Œå¸¦ä½ å½»åº•ææ‡‚è¿™ä¸ªæŠ€æœ¯ï¼</p>
<h3 data-id="heading-2">è¿™ä¸ªåº”ç”¨æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ</h3>
<p>æƒ³è±¡ä½ æœ‰ä¸€ä¸ª <strong>æ™ºèƒ½èŠå¤©æœºå™¨äºº</strong>ğŸ¤–ï¼š</p>
<ol>
<li>ä½ è¾“å…¥ä¸€ä¸ªé—®é¢˜ï¼ˆæ¯”å¦‚ï¼š"è®²ä¸€ä¸ªç¬‘è¯"ï¼‰</li>
<li>ç‚¹å‡»"æäº¤"æŒ‰é’®</li>
<li>æœºå™¨äººå¼€å§‹æ€è€ƒå¹¶å›å¤ä½ </li>
<li>å›å¤å¯ä»¥<strong>ä¸€ä¸ªå­—ä¸€ä¸ªå­—å‡ºç°</strong>ï¼ˆæµå¼æ¨¡å¼ï¼‰ï¼Œæˆ–è€…<strong>ä¸€ä¸‹å­å…¨éƒ¨å‡ºç°</strong></li>
</ol>
<h3 data-id="heading-3">ç¬¬ä¸€éƒ¨åˆ†ï¼šç†è§£ Vue 3 çš„åŸºç¡€</h3>
<h4 data-id="heading-4">1.1 ä»€ä¹ˆæ˜¯å“åº”å¼æ•°æ®ï¼Ÿ</h4>
<p><strong>ç”Ÿæ´»ä¾‹å­</strong>ğŸ“ºï¼š
æƒ³è±¡ä½ å®¶ç”µè§†çš„é¥æ§å™¨ï¼š</p>
<ul>
<li>æŒ‰"éŸ³é‡+" â†’ ç”µè§†éŸ³é‡å˜å¤§</li>
<li>æŒ‰"é¢‘é“+" â†’ ç”µè§†æ¢å°</li>
</ul>
<p>è¿™é‡Œçš„ <strong>å“åº”å¼</strong> å°±æ˜¯ï¼šæŒ‰é¥æ§å™¨ï¼ˆæ”¹å˜æ•°æ®ï¼‰ï¼Œç”µè§†ç«‹å³å“åº”ï¼ˆé¡µé¢æ›´æ–°ï¼‰ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ›å»ºå“åº”å¼æ•°æ®å°±åƒç»™æ•°æ®è£…ä¸Š"é¥æ§å™¨"</span>
<span class="hljs-keyword">const</span> question = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'ä½ å¥½'</span>);  <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªèƒ½"é¥æ§"çš„æ•°æ®</span>

<span class="hljs-comment">// åœ¨æ¨¡æ¿ä¸­æ˜¾ç¤º</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{{ question }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  &lt;!-- æ˜¾ç¤ºï¼šä½ å¥½ --&gt;

<span class="hljs-comment">// å¦‚æœæ”¹å˜æ•°æ®</span>
question.<span class="hljs-property">value</span> = <span class="hljs-string">'Hello'</span>;   <span class="hljs-comment">// æŒ‰ä¸‹"é¥æ§å™¨"</span>

<span class="hljs-comment">// é¡µé¢è‡ªåŠ¨å˜æˆ</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Hello<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>            &lt;!-- é¡µé¢è‡ªåŠ¨æ›´æ–°ï¼ --&gt;
</code></pre>
<h4 data-id="heading-5">1.2 <code>ref</code> æ˜¯ä»€ä¹ˆï¼Ÿ</h4>
<p><code>ref</code> å°±æ˜¯æŠŠæ™®é€šæ•°æ®åŒ…è£…æˆä¸€ä¸ªç‰¹æ®Šçš„<strong>ç›’å­</strong>ğŸ“¦ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ™®é€šæ•°æ®</span>
<span class="hljs-keyword">let</span> name = <span class="hljs-string">"å°æ˜"</span>;  
<span class="hljs-comment">// æ”¹å˜æ—¶ï¼ŒVueä¸çŸ¥é“ï¼Œé¡µé¢ä¸ä¼šæ›´æ–°</span>

<span class="hljs-comment">// å“åº”å¼æ•°æ®</span>
<span class="hljs-keyword">const</span> nameRef = <span class="hljs-title function_">ref</span>(<span class="hljs-string">"å°æ˜"</span>);
<span class="hljs-comment">// å®é™…ä¸Šå˜æˆäº†ï¼š{ value: "å°æ˜" }</span>

<span class="hljs-comment">// è®¿é—®æ—¶è¦åŠ  .value</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(nameRef.<span class="hljs-property">value</span>);  <span class="hljs-comment">// "å°æ˜"</span>

<span class="hljs-comment">// æ”¹å˜æ•°æ®</span>
nameRef.<span class="hljs-property">value</span> = <span class="hljs-string">"å°çº¢"</span>;      <span class="hljs-comment">// Vue çŸ¥é“æ•°æ®å˜äº†ï¼Œä¼šæ›´æ–°é¡µé¢</span>
</code></pre>
<h3 data-id="heading-6">ç¬¬äºŒéƒ¨åˆ†ï¼šæ¨¡æ¿è¯­æ³•</h3>
<h4 data-id="heading-7">2.1 <code>v-model</code> - åŒå‘ç»‘å®š</h4>
<p><strong>åŒå‘ç»‘å®š</strong> å°±åƒ <strong>åŒæ­¥çš„è®°äº‹æœ¬</strong>ğŸ“ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- åˆ›å»ºä¸€ä¸ªè¾“å…¥æ¡† --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"question"</span> /&gt;</span>

<span class="hljs-comment">&lt;!-- è¿™ç›¸å½“äºåšäº†ä¸¤ä»¶äº‹ï¼š
1. è¾“å…¥æ¡†æ˜¾ç¤º question çš„å€¼
2. ä½ åœ¨è¾“å…¥æ¡†æ‰“å­—æ—¶ï¼Œè‡ªåŠ¨æ›´æ–° question çš„å€¼
--&gt;</span>
</code></pre>
<p>å®é™…æ•ˆæœï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½ è¾“å…¥"ä½ å¥½"</span>
question.<span class="hljs-property">value</span> = <span class="hljs-string">"ä½ å¥½"</span>;

<span class="hljs-comment">// é¡µé¢æ˜¾ç¤º</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"ä½ å¥½"</span> /&gt;</span></span>

<span class="hljs-comment">// ä½ å†è¾“å…¥"å¤§å®¶å¥½"</span>
<span class="hljs-comment">// question.value è‡ªåŠ¨å˜æˆ "å¤§å®¶å¥½"</span>
</code></pre>
<h4 data-id="heading-8">2.2 <code>@click</code> - äº‹ä»¶ç›‘å¬</h4>
<p>å°±åƒç»™æŒ‰é’®è£…ä¸Š <strong>é—¨é“ƒ</strong>ğŸ””ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"askLLM"</span>&gt;</span>æäº¤<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

<span class="hljs-comment">&lt;!-- æ„æ€æ˜¯ï¼šç‚¹å‡»è¿™ä¸ªæŒ‰é’®æ—¶ï¼Œæ‰§è¡Œ askLLM å‡½æ•° --&gt;</span>
</code></pre>
<h3 data-id="heading-9">ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ ¸å¿ƒåŠŸèƒ½ - è°ƒç”¨ AI</h3>
<h4 data-id="heading-10">3.1 åŸºæœ¬æµç¨‹ï¼ˆåƒç‚¹å¤–å–ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">askLLM</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-comment">// 1. å‡†å¤‡é—®é¢˜ï¼ˆåƒå†™èœå•ï¼‰</span>
  <span class="hljs-keyword">if</span> (!question.<span class="hljs-property">value</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é—®é¢˜ä¸èƒ½ä¸ºç©º'</span>);
    <span class="hljs-keyword">return</span>;
  }
  
  <span class="hljs-comment">// 2. æ˜¾ç¤º"æ€è€ƒä¸­..."ï¼ˆåƒæ˜¾ç¤º"å•†å®¶æ¥å•ä¸­"ï¼‰</span>
  content.<span class="hljs-property">value</span> = <span class="hljs-string">"æ€è€ƒä¸­..."</span>;
  
  <span class="hljs-comment">// 3. å‡†å¤‡å¤–å–ä¿¡æ¯</span>
  <span class="hljs-keyword">const</span> endpoint = <span class="hljs-string">'https://api.deepseek.com/chat/completions'</span>;  <span class="hljs-comment">// å¤–å–å¹³å°åœ°å€</span>
  <span class="hljs-keyword">const</span> headers = {
    <span class="hljs-string">'Authorization'</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${ä½ çš„APIå¯†é’¥}</span>`</span>,  <span class="hljs-comment">// æ”¯ä»˜å‡­è¯</span>
    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,        <span class="hljs-comment">// è¯´è¦é€JSONæ ¼å¼</span>
  };
  
  <span class="hljs-comment">// 4. ä¸‹è®¢å•</span>
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(endpoint, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,      <span class="hljs-comment">// ç‚¹å¤–å–ç”¨POST</span>
    headers,             <span class="hljs-comment">// å‘Šè¯‰å•†å®¶ä¿¡æ¯</span>
    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({  <span class="hljs-comment">// å…·ä½“è®¢å•å†…å®¹</span>
      <span class="hljs-attr">model</span>: <span class="hljs-string">'deepseek-chat'</span>,
      <span class="hljs-attr">stream</span>: stream.<span class="hljs-property">value</span>,  <span class="hljs-comment">// è¦ä¸è¦æµå¼ï¼ˆåˆ†æ‰¹é€ï¼‰</span>
      <span class="hljs-attr">messages</span>: [{
        <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>,
        <span class="hljs-attr">content</span>: question.<span class="hljs-property">value</span>
      }]
    })
  });
  
  <span class="hljs-comment">// 5. ç­‰å¤–å–é€åˆ°å¹¶å¤„ç†</span>
  <span class="hljs-comment">// ... åé¢è¯¦ç»†è®²</span>
}
</code></pre>
<h3 data-id="heading-11">ç¬¬å››éƒ¨åˆ†ï¼šæµå¼å“åº”è¯¦ç»†è§£é‡Š</h3>
<h4 data-id="heading-12">4.1 ä»€ä¹ˆæ˜¯"æµå¼"ï¼Ÿ</h4>
<p><strong>æ¯”å–»</strong>ğŸ¬ï¼š</p>
<ul>
<li><strong>éæµå¼</strong>ï¼šç­‰ç”µå½±å…¨éƒ¨ä¸‹è½½å®Œï¼ˆ5GBï¼‰æ‰èƒ½çœ‹</li>
<li><strong>æµå¼</strong>ï¼šä¸‹è½½ä¸€ç‚¹ï¼ˆ10MBï¼‰å°±èƒ½å¼€å§‹çœ‹ï¼Œè¾¹ä¸‹è½½è¾¹çœ‹</li>
</ul>
<p>åœ¨è¿™ä¸ªåº”ç”¨ä¸­ï¼š</p>
<ul>
<li><strong>éæµå¼</strong>ï¼šç­‰AIå…¨éƒ¨ç”Ÿæˆå®Œæ–‡å­—ï¼Œä¸€æ¬¡æ€§æ˜¾ç¤º</li>
<li><strong>æµå¼</strong>ï¼šAIç”Ÿæˆä¸€ä¸ªå­—å°±æ˜¾ç¤ºä¸€ä¸ªå­—</li>
</ul>
<h4 data-id="heading-13">4.2 æµå¼å“åº”ä»£ç è¯¦è§£ï¼ˆé€æ­¥è®²è§£ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">if</span> (stream.<span class="hljs-property">value</span>) {  <span class="hljs-comment">// å¦‚æœç”¨æˆ·é€‰äº†æµå¼æ¨¡å¼</span>
  <span class="hljs-comment">// ç¬¬ä¸€æ­¥ï¼šæ¸…ç©ºä¸Šæ¬¡çš„å›ç­”</span>
  content.<span class="hljs-property">value</span> = <span class="hljs-string">""</span>;  <span class="hljs-comment">// æ¸…ç©ºæ˜¾ç¤ºåŒºåŸŸ</span>
  
  <span class="hljs-comment">// ç¬¬äºŒæ­¥ï¼šåˆ›å»º"æ°´ç®¡"å’Œ"æ°´é¾™å¤´"</span>
  <span class="hljs-keyword">const</span> reader = response.<span class="hljs-property">body</span>?.<span class="hljs-title function_">getReader</span>();  
  <span class="hljs-comment">// reader å°±åƒæ°´é¾™å¤´ï¼Œå¯ä»¥æ§åˆ¶æ°´æµ</span>
  
  <span class="hljs-keyword">const</span> decoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextDecoder</span>();
  <span class="hljs-comment">// decoder å°±åƒå‡€æ°´å™¨ï¼ŒæŠŠè„æ°´ï¼ˆäºŒè¿›åˆ¶ï¼‰å˜æˆå¹²å‡€æ°´ï¼ˆæ–‡å­—ï¼‰</span>
  
  <span class="hljs-keyword">let</span> done = <span class="hljs-literal">false</span>;  <span class="hljs-comment">// è®°å½•æ°´æ˜¯å¦æµå®Œäº†</span>
  <span class="hljs-keyword">let</span> buffer = <span class="hljs-string">''</span>;   <span class="hljs-comment">// ä¸´æ—¶æ°´æ¡¶ï¼Œè£…ä¸å®Œæ•´çš„æ°´</span>
  
  <span class="hljs-comment">// ç¬¬ä¸‰æ­¥ï¼šå¼€å§‹æ¥æ°´ï¼ˆå¾ªç¯è¯»å–ï¼‰</span>
  <span class="hljs-keyword">while</span> (!done) {  <span class="hljs-comment">// åªè¦æ°´æ²¡æµå®Œå°±ä¸€ç›´æ¥</span>
    
    <span class="hljs-comment">// æ¥ä¸€ç“¢æ°´ï¼ˆè¯»ä¸€å—æ•°æ®ï¼‰</span>
    <span class="hljs-keyword">const</span> { value, <span class="hljs-attr">done</span>: doneReading } = <span class="hljs-keyword">await</span> reader?.<span class="hljs-title function_">read</span>();
    <span class="hljs-comment">// value: æ¥åˆ°çš„æ°´ï¼ˆäºŒè¿›åˆ¶æ•°æ®ï¼‰</span>
    <span class="hljs-comment">// doneReading: è¿™ä¸€ç“¢æ¥å®Œäº†å—ï¼Ÿ</span>
    
    done = doneReading;  <span class="hljs-comment">// æ›´æ–°æ˜¯å¦æµå®Œçš„çŠ¶æ€</span>
    
    <span class="hljs-comment">// ç¬¬å››æ­¥ï¼šå¤„ç†æ¥åˆ°çš„æ°´</span>
    <span class="hljs-comment">// æŠŠè¿™æ¬¡çš„æ°´å’Œä¸Šæ¬¡æ²¡å¤„ç†å®Œçš„æ°´åˆåœ¨ä¸€èµ·</span>
    <span class="hljs-keyword">const</span> chunkValue = buffer + decoder.<span class="hljs-title function_">decode</span>(value);
    buffer = <span class="hljs-string">''</span>;  <span class="hljs-comment">// æ¸…ç©ºä¸´æ—¶æ°´æ¡¶</span>
    
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ”¶åˆ°æ•°æ®:"</span>, chunkValue);
    <span class="hljs-comment">// æ•°æ®æ ¼å¼ç±»ä¼¼ï¼š</span>
    <span class="hljs-comment">// data: {"delta": {"content": "ä½ "}}</span>
    <span class="hljs-comment">// data: {"delta": {"content": "å¥½"}}</span>
    <span class="hljs-comment">// data: [DONE]</span>
    
    <span class="hljs-comment">// ç¬¬äº”æ­¥ï¼šæŠŠä¸€å¤§å—æ°´åˆ†æˆä¸€è¡Œä¸€è¡Œ</span>
    <span class="hljs-keyword">const</span> lines = chunkValue.<span class="hljs-title function_">split</span>(<span class="hljs-string">'\n'</span>)  <span class="hljs-comment">// æŒ‰æ¢è¡Œåˆ†å‰²</span>
      .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">line</span> =&gt;</span> line.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'data: '</span>));  <span class="hljs-comment">// åªä¿ç•™ä»¥"data: "å¼€å¤´çš„è¡Œ</span>
    
    <span class="hljs-comment">// ç¬¬å…­æ­¥ï¼šå¤„ç†æ¯ä¸€è¡Œæ°´</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> line <span class="hljs-keyword">of</span> lines) {
      <span class="hljs-keyword">const</span> incoming = line.<span class="hljs-title function_">slice</span>(<span class="hljs-number">6</span>);  <span class="hljs-comment">// å»æ‰å¼€å¤´çš„"data: "</span>
      <span class="hljs-comment">// ç°åœ¨ incoming = '{"delta": {"content": "ä½ "}}'</span>
      
      <span class="hljs-comment">// å¦‚æœæ˜¯ç»“æŸæ ‡å¿—</span>
      <span class="hljs-keyword">if</span> (incoming === <span class="hljs-string">'[DONE]'</span>) {
        done = <span class="hljs-literal">true</span>;  <span class="hljs-comment">// åœæ­¢æ¥æ°´</span>
        <span class="hljs-keyword">break</span>;        <span class="hljs-comment">// è·³å‡ºå¾ªç¯</span>
      }
      
      <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// ç¬¬ä¸ƒæ­¥ï¼šè§£æJSONï¼ˆæŠŠæ°´å˜æˆèƒ½å–çš„ä¸œè¥¿ï¼‰</span>
        <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(incoming);
        <span class="hljs-comment">// data = { delta: { content: "ä½ " } }</span>
        
        <span class="hljs-keyword">const</span> delta = data.<span class="hljs-property">choices</span>[<span class="hljs-number">0</span>].<span class="hljs-property">delta</span>.<span class="hljs-property">content</span>;
        <span class="hljs-comment">// delta = "ä½ "</span>
        
        <span class="hljs-keyword">if</span> (delta) {
          <span class="hljs-comment">// ç¬¬å…«æ­¥ï¼šæ˜¾ç¤ºå‡ºæ¥</span>
          content.<span class="hljs-property">value</span> += delta;  <span class="hljs-comment">// æŠŠ"ä½ "åŠ åˆ°æ˜¾ç¤ºå†…å®¹é‡Œ</span>
          <span class="hljs-comment">// ç¬¬ä¸€æ¬¡ï¼šcontent = "ä½ "</span>
          <span class="hljs-comment">// ç¬¬äºŒæ¬¡ï¼šcontent = "ä½ å¥½"</span>
          <span class="hljs-comment">// ç¬¬ä¸‰æ¬¡ï¼šcontent = "ä½ å¥½ä¸–"</span>
          <span class="hljs-comment">// ... ç›´åˆ°å®Œæˆ</span>
        }
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-comment">// å¦‚æœJSONè§£æå¤±è´¥ï¼ˆæ¯”å¦‚æ”¶åˆ°äº†ä¸å®Œæ•´çš„JSONï¼‰</span>
        buffer += <span class="hljs-string">`data: <span class="hljs-subst">${incoming}</span>`</span>;  <span class="hljs-comment">// å­˜èµ·æ¥ç­‰ä¸‹ä¸€ç“¢æ°´</span>
      }
    }
  }
}
</code></pre>
<h4 data-id="heading-14">4.3 ä¸ºä»€ä¹ˆéœ€è¦ <code>buffer</code>ï¼Ÿ</h4>
<p><strong>æƒ…æ™¯æ¨¡æ‹Ÿ</strong>ï¼š
å‡è®¾AIè¦å›å¤"ä½ å¥½ä¸–ç•Œ"ï¼Œä½†ç½‘ç»œä¼ è¾“æ—¶å¯èƒ½è¿™æ ·ï¼š</p>
<p><strong>ç¬¬ä¸€æ¬¡æ”¶åˆ°</strong>ï¼š<code>data: {"delta": {"content": "ä½ </code>
ï¼ˆJSONä¸å®Œæ•´ï¼Œå°‘äº†å³æ‹¬å·ï¼‰</p>
<p><strong>ç¬¬äºŒæ¬¡æ”¶åˆ°</strong>ï¼š<code>å¥½ä¸–ç•Œ"}}</code></p>
<p>å¦‚æœç›´æ¥è§£æç¬¬ä¸€æ¬¡çš„æ•°æ®ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">'{"delta": {"content": "ä½ '</span>);  <span class="hljs-comment">// æŠ¥é”™ï¼JSONä¸å®Œæ•´</span>
</code></pre>
<p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦ï¼š</p>
<ol>
<li>ç¬¬ä¸€æ¬¡ï¼š<code>buffer = 'data: {"delta": {"content": "ä½ '</code></li>
<li>ç¬¬äºŒæ¬¡ï¼š<code>buffer + æ–°æ•°æ® = 'data: {"delta": {"content": "ä½ å¥½ä¸–ç•Œ"}}'</code></li>
<li>ç°åœ¨å¯ä»¥æ­£ç¡®è§£æäº†</li>
</ol>
<h3 data-id="heading-15">å®Œæ•´å·¥ä½œæµç¨‹æ¼”ç¤º</h3>
<p>è®©æˆ‘ç”¨å…·ä½“çš„æ‰§è¡Œè¿‡ç¨‹å±•ç¤ºè¿™ä¸ªç³»ç»Ÿçš„ç²¾å¦™ï¼š</p>
<p>javascript</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// ç”¨æˆ·è¾“å…¥ï¼š"ä½ å¥½"</span>
<span class="hljs-comment">// æœåŠ¡å™¨å“åº”æµå¼€å§‹...</span>

<span class="hljs-comment">// ç¬¬1æ¬¡å¾ªç¯ï¼š</span>
æ”¶åˆ°æ•°æ®: data: {<span class="hljs-string">"delta"</span>: {<span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ "</span>}}\n
åˆ†å‰²æˆè¡Œ: [<span class="hljs-symbol">'data</span>: {<span class="hljs-string">"delta"</span>: {<span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ "</span>}}']
è§£ææˆåŠŸï¼â†’ æ˜¾ç¤ºï¼š<span class="hljs-string">"ä½ "</span>

<span class="hljs-comment">// ç¬¬2æ¬¡å¾ªç¯ï¼š</span>
æ”¶åˆ°æ•°æ®: data: {<span class="hljs-string">"delta"</span>: {<span class="hljs-string">"content"</span>: <span class="hljs-string">"å¥½
åˆ†å‰²æˆè¡Œ: ['data: {"</span>delta<span class="hljs-string">": {"</span>content<span class="hljs-string">": "</span>å¥½']
JSONè§£æå¤±è´¥ï¼â†’ å­˜å…¥buffer: <span class="hljs-symbol">'data</span>: {<span class="hljs-string">"delta"</span>: {<span class="hljs-string">"content"</span>: <span class="hljs-string">"å¥½'

// ç¬¬3æ¬¡å¾ªç¯ï¼š
æ”¶åˆ°æ•°æ®: "</span>}}\n
å½“å‰æ•°æ®: buffer + æ–°æ•°æ® = <span class="hljs-symbol">'data</span>: {<span class="hljs-string">"delta"</span>: {<span class="hljs-string">"content"</span>: <span class="hljs-string">"å¥½"</span>}}'
åˆ†å‰²æˆè¡Œ: [<span class="hljs-symbol">'data</span>: {<span class="hljs-string">"delta"</span>: {<span class="hljs-string">"content"</span>: <span class="hljs-string">"å¥½"</span>}}']
è§£ææˆåŠŸï¼â†’ æ˜¾ç¤ºï¼š<span class="hljs-string">"ä½ å¥½"</span>

<span class="hljs-comment">// ç¬¬4æ¬¡å¾ªç¯ï¼š</span>
æ”¶åˆ°æ•°æ®: data: [DONE]\n
æ£€æµ‹åˆ°[DONE] â†’ ç»“æŸå¾ªç¯
</code></pre>
<h3 data-id="heading-16">ç¬¬äº”éƒ¨åˆ†ï¼šå®Œæ•´äº¤äº’æµç¨‹</h3>
<pre><code class="hljs language-erlang" lang="erlang">ä½ æ‰“å¼€é¡µé¢
    â†“
çœ‹åˆ°è¾“å…¥æ¡†ï¼š[è®²ä¸€ä¸ªç¬‘è¯]
    â†“
ç‚¹å‡»<span class="hljs-string">"æäº¤"</span>
    â†“
Vueè°ƒç”¨ askLLM() å‡½æ•°
    â†“
æ˜¾ç¤º<span class="hljs-string">"æ€è€ƒä¸­..."</span>
    â†“
å‘é€è¯·æ±‚åˆ°DeepSeek
    â†“
AIå¼€å§‹æ€è€ƒ
    â†“
ã€æµå¼æ¨¡å¼ã€‘
    â†“
æ”¶åˆ°ç¬¬ä¸€ä¸ªå­—ï¼š<span class="hljs-string">"æœ‰"</span>
    â†“
é¡µé¢æ˜¾ç¤ºï¼šæœ‰
    â†“
æ”¶åˆ°ç¬¬äºŒä¸ªå­—ï¼š<span class="hljs-string">"ä¸ª"</span>
    â†“
é¡µé¢æ˜¾ç¤ºï¼šæœ‰ä¸ª
    â†“
æ”¶åˆ°ç¬¬ä¸‰ä¸ªå­—ï¼š<span class="hljs-string">"äºº"</span>
    â†“
é¡µé¢æ˜¾ç¤ºï¼šæœ‰ä¸ªäºº
    â†“
...ï¼ˆæŒç»­ï¼‰
    â†“
æ”¶åˆ°<span class="hljs-string">"[DONE]"</span>
    â†“
æ˜¾ç¤ºå®Œæ•´ï¼šæœ‰ä¸ªäººå»é¢è¯•...
</code></pre>
<h3 data-id="heading-17">ç¬¬å…­éƒ¨åˆ†ï¼šå…³é”®æ¦‚å¿µæ€»ç»“</h3>













































<table><thead><tr><th>æ¦‚å¿µ</th><th>æ¯”å–»</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>ref()</code></td><td>é¥æ§å™¨ğŸ“±</td><td>è®©æ•°æ®å˜åŒ–æ—¶é¡µé¢è‡ªåŠ¨æ›´æ–°</td></tr><tr><td><code>v-model</code></td><td>åŒå‘é•œå­ğŸª</td><td>è¾“å…¥æ¡†å’Œæ•°æ®çš„åŒå‘åŒæ­¥</td></tr><tr><td><code>@click</code></td><td>é—¨é“ƒğŸ””</td><td>ç‚¹å‡»æ—¶æ‰§è¡Œå‡½æ•°</td></tr><tr><td><code>fetch()</code></td><td>å¤–å–å°å“¥ğŸš´</td><td>å‘é€ç½‘ç»œè¯·æ±‚</td></tr><tr><td><code>getReader()</code></td><td>æ°´é¾™å¤´ğŸš°</td><td>è¯»å–æµå¼æ•°æ®</td></tr><tr><td><code>TextDecoder()</code></td><td>ç¿»è¯‘å®˜ğŸ‘¨â€ğŸ’¼</td><td>æŠŠäºŒè¿›åˆ¶å˜æˆæ–‡å­—</td></tr><tr><td><code>JSON.parse()</code></td><td>æ‹†åŒ…è£¹ğŸ“¦</td><td>æŠŠJSONå­—ç¬¦ä¸²å˜æˆå¯¹è±¡</td></tr></tbody></table>
<h3 data-id="heading-18">ç»™åˆå­¦è€…çš„å»ºè®®</h3>
<ol>
<li><strong>å…ˆç†è§£æ•´ä½“</strong>ï¼šä¸è¦ä¸€å¼€å§‹å°±é™·å…¥ç»†èŠ‚</li>
<li><strong>åˆ†å—å­¦ä¹ </strong>ï¼š
<ul>
<li>å…ˆå­¦ä¼š Vue åŸºç¡€ï¼ˆref, v-modelï¼‰</li>
<li>å†å­¦ç½‘ç»œè¯·æ±‚ï¼ˆfetchï¼‰</li>
<li>æœ€åå­¦æµå¼å¤„ç†</li>
</ul>
</li>
<li><strong>åŠ¨æ‰‹å®è·µ</strong>ï¼šä¿®æ”¹ä»£ç çœ‹çœ‹æ•ˆæœ
<ul>
<li>æŠŠ <code>stream.value</code> æ”¹æˆ <code>false</code> çœ‹çœ‹åŒºåˆ«</li>
<li>åœ¨ <code>console.log</code> é‡Œçœ‹æ•°æ®å˜åŒ–</li>
</ul>
</li>
<li><strong>é‡åˆ°é—®é¢˜</strong>ï¼šç”¨ <code>console.log()</code> æ‰“å°æ¯ä¸€æ­¥çš„ç»“æœ</li>
</ol>
<p>è¿™ä¸ªä»£ç è™½ç„¶çœ‹èµ·æ¥å¤æ‚ï¼Œä½†æ¯ä¸ªéƒ¨åˆ†éƒ½æœ‰æ˜ç¡®çš„ä½œç”¨ã€‚å°±åƒæ­ç§¯æœ¨ä¸€æ ·ï¼Œæ¯å—ç§¯æœ¨ï¼ˆå‡½æ•°ï¼‰éƒ½æœ‰ç‰¹å®šçš„åŠŸèƒ½ï¼Œç»„åˆèµ·æ¥å°±å®ç°äº†å¼ºå¤§çš„AIèŠå¤©åŠŸèƒ½ï¼ğŸ˜Š</p>
<h2 data-id="heading-19">é™„å½•ï¼šå®Œæ•´çš„Vue 3 AIæµå¼è¾“å‡ºä»£ç </h2>
<h3 data-id="heading-20">App.vue å®Œæ•´ä»£ç </h3>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup&gt;
import { ref } from 'vue';

const question = ref('è®²ä¸€ä¸ªå…‰å¤´å¼ºå’Œä¸€ä¸ªç™½å¯Œç¾ä¹‹é—´çš„æ•…äº‹,20å­—');
const stream = ref(true);
const content = ref("");

const askLLM = async () =&gt; {
  if (!question.value) {
    console.log('question is empty');
    return;
  }
  
  content.value = "æ€è€ƒä¸­...";
  
  const endpoint = 'https://api.deepseek.com/chat/completions';
  const headers = {
    'Authorization': `Bearer ${import.meta.env.VITE_DEEPSEEK_API_KEY}`,
    'Content-Type': 'application/json',
  };
  
  const response = await fetch(endpoint, {
    method: 'POST',
    headers,
    body: JSON.stringify({
      model: 'deepseek-chat',
      stream: stream.value,
      messages: [{
        role: 'user',
        content: question.value
      }]
    })
  });
  
  if (stream.value) {
    content.value = "";
    const reader = response.body?.getReader();
    const decoder = new TextDecoder();
    let done = false;
    let buffer = '';
    
    while (!done) {
      const { value, done: doneReading } = await reader?.read();
      console.log(value, doneReading);
      done = doneReading;
      
      const chunkValue = buffer + decoder.decode(value);
      console.log(chunkValue);
      buffer = '';
      const lines = chunkValue.split('\n')
        .filter(line =&gt; line.startsWith('data: '));
      
      for (const line of lines) {
        const incoming = line.slice(6);
        if (incoming === '[DONE]') {
          done = true;
          break;
        }
        
        try {
          const data = JSON.parse(incoming);
          const delta = data.choices[0].delta.content;
          if (delta) {
            content.value += delta;
          }
        } catch (error) {
          buffer += `data: ${incoming}`;
        }
      }
    }
  } else {
    const data = await response.json();
    console.log(data);
    content.value = data.choices[0].message.content;
  }
}
&lt;/script&gt;

&lt;template&gt;
  &lt;div class="container"&gt;
    &lt;div&gt;
      &lt;label&gt;è¾“å…¥ï¼š&lt;/label&gt;
      &lt;input class="input" v-model="question"/&gt;
      &lt;button @click="askLLM"&gt;æäº¤&lt;/button&gt;
    &lt;/div&gt;
   
    &lt;div class="output"&gt;
      &lt;div&gt;
        &lt;label&gt;Streaming&lt;/label&gt;
        &lt;input type="checkbox" v-model="stream"/&gt;
        &lt;div&gt;{{content}}&lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;  
&lt;/template&gt;

&lt;style scoped&gt;
* {
  margin: 0;
  padding: 0;
}
.container {
  display: flex;
  flex-direction: column;
  align-items: start;
  justify-content: start;
  height: 100vh;
  font-size: 0.85rem;
}
.input {
  width: 200px;
}
button {
  padding: 0 10px;
  margin-left: 6px;
}
.output {
  margin-top: 10px;
  min-height: 300px;
  width: 100%;
  text-align: left;
}
&lt;/style&gt;
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥æµ…å‡ºï¼šæ‰‹å†™ new æ“ä½œç¬¦ï¼Œå½»åº•ç†è§£ JavaScript çš„å®ä¾‹åŒ–è¿‡ç¨‹]]></title>    <link>https://juejin.cn/post/7603591775392923675</link>    <guid>https://juejin.cn/post/7603591775392923675</guid>    <pubDate>2026-02-07T09:09:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603591775392923675" data-draft-id="7603595309232947210" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥æµ…å‡ºï¼šæ‰‹å†™ new æ“ä½œç¬¦ï¼Œå½»åº•ç†è§£ JavaScript çš„å®ä¾‹åŒ–è¿‡ç¨‹"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2026-02-07T09:09:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸ä¼šæ•²ä»£ç 1"/> <meta itemprop="url" content="https://juejin.cn/user/1927884034804425"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥æµ…å‡ºï¼šæ‰‹å†™ new æ“ä½œç¬¦ï¼Œå½»åº•ç†è§£ JavaScript çš„å®ä¾‹åŒ–è¿‡ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1927884034804425/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸ä¼šæ•²ä»£ç 1
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T09:09:30.000Z" title="Sat Feb 07 2026 09:09:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ·±å…¥æµ…å‡ºï¼šæ‰‹å†™ new æ“ä½œç¬¦ï¼Œå½»åº•ç†è§£ JavaScript çš„å®ä¾‹åŒ–è¿‡ç¨‹</h2>
<h3 data-id="heading-1">å¼•è¨€</h3>
<p>åœ¨ JavaScript ä¸­ï¼Œ<code>new</code> æ“ä½œç¬¦æ˜¯æˆ‘ä»¬åˆ›å»ºå¯¹è±¡å®ä¾‹æœ€å¸¸ç”¨çš„æ–¹å¼ä¹‹ä¸€ã€‚ä½†ä½ çœŸçš„äº†è§£ <code>new</code> èƒŒåå‘ç”Ÿäº†ä»€ä¹ˆå—ï¼Ÿä»Šå¤©æˆ‘ä»¬å°±æ¥æ·±å…¥æ¢è®¨ä¸€ä¸‹ <code>new</code> çš„å¥¥ç§˜ï¼Œå¹¶äº²æ‰‹å®ç°ä¸€ä¸ªè‡ªå·±çš„ <code>new</code> å‡½æ•°ã€‚</p>
<h3 data-id="heading-2">åœ¨è§£é‡Šæ‰‹å†™newå‡½æ•°çš„ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè§£é‡Šä¸€äº›çŸ¥è¯†ç‚¹æ–¹ä¾¿æˆ‘ä»¬åé¢ç†è§£æ‰‹å†™newçš„è¿‡ç¨‹</h3>
<h3 data-id="heading-3">ä¸€ã€æ„é€ å‡½æ•°è¢«å®ä¾‹åŒ–çš„å®Œæ•´è¿‡ç¨‹</h3>
<h4 data-id="heading-4">ä»€ä¹ˆæ˜¯æ„é€ å‡½æ•°ï¼Ÿ</h4>
<p>æ„é€ å‡½æ•°å…¶å®å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„å‡½æ•°ï¼Œä½†å½“æˆ‘ä»¬ä½¿ç”¨ <code>new</code> å…³é”®å­—è°ƒç”¨å®ƒæ—¶ï¼Œå®ƒå°±å˜æˆäº†ä¸€ä¸ª"æ„é€ å‡½æ•°"ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name, age</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
}

<span class="hljs-comment">// ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨</span>
<span class="hljs-title class_">Person</span>(<span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-number">18</span>);  <span class="hljs-comment">// this æŒ‡å‘å…¨å±€å¯¹è±¡ï¼ˆæµè§ˆå™¨ä¸­æ˜¯ windowï¼‰</span>

<span class="hljs-comment">// ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨</span>
<span class="hljs-keyword">const</span> person = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-number">18</span>);  <span class="hljs-comment">// this æŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡</span>
</code></pre>
<h4 data-id="heading-5">new å®ä¾‹åŒ–çš„å®Œæ•´æ­¥éª¤</h4>
<p><strong>æ¯”å–»</strong>ï¼šæƒ³è±¡ä¸€ä¸‹å·¥å‚ç”Ÿäº§äº§å“çš„è¿‡ç¨‹ï¼š</p>
<ol>
<li>å‡†å¤‡åŸææ–™ï¼ˆåˆ›å»ºç©ºå¯¹è±¡ï¼‰</li>
<li>æŒ‰ç…§è®¾è®¡å›¾çº¸åŠ å·¥ï¼ˆè°ƒç”¨æ„é€ å‡½æ•°ï¼‰</li>
<li>è´´ä¸Šå“ç‰Œæ ‡ç­¾ï¼ˆè®¾ç½®åŸå‹é“¾ï¼‰</li>
<li>å‡ºå‚æ£€éªŒï¼ˆè¿”å›å¯¹è±¡ï¼‰</li>
</ol>
<p>å…·ä½“æ¥è¯´ï¼Œ<code>new</code> æ“ä½œç¬¦æ‰§è¡Œä»¥ä¸‹4ä¸ªæ­¥éª¤ï¼š</p>
<h5 data-id="heading-6">æ­¥éª¤1ï¼šåˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> obj = {};
</code></pre>
<h5 data-id="heading-7">æ­¥éª¤2ï¼šå°†æ–°å¯¹è±¡çš„ <code>__proto__</code> æŒ‡å‘æ„é€ å‡½æ•°çš„ <code>prototype</code></h5>
<pre><code class="hljs language-javascript" lang="javascript">obj.<span class="hljs-property">__proto__</span> = <span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
</code></pre>
<h5 data-id="heading-8">æ­¥éª¤3ï¼šå°†æ„é€ å‡½æ•°çš„ <code>this</code> ç»‘å®šåˆ°è¿™ä¸ªæ–°å¯¹è±¡ï¼Œå¹¶æ‰§è¡Œæ„é€ å‡½æ•°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">apply</span>(obj, args);
</code></pre>
<h5 data-id="heading-9">æ­¥éª¤4ï¼šå¦‚æœæ„é€ å‡½æ•°è¿”å›äº†ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™è¿”å›è¯¥å¯¹è±¡ï¼›å¦åˆ™è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-comment">// å¦‚æœæ²¡æœ‰æ˜¾å¼è¿”å›ï¼Œé»˜è®¤è¿”å› this</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Person2</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">custom</span>: <span class="hljs-string">'object'</span> };  <span class="hljs-comment">// å¦‚æœè¿”å›å¯¹è±¡ï¼Œåˆ™æ›¿ä»£æ–°åˆ›å»ºçš„å¯¹è±¡</span>
}

<span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'å¼ ä¸‰'</span>);  <span class="hljs-comment">// Person {name: "å¼ ä¸‰"}</span>
<span class="hljs-keyword">const</span> p2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person2</span>(<span class="hljs-string">'æå››'</span>); <span class="hljs-comment">// {custom: "object"}</span>
</code></pre>
<h3 data-id="heading-10">äºŒã€applyã€call å’Œ bind çš„åŒºåˆ«</h3>
<p>è¿™ä¸‰ä¸ªæ–¹æ³•éƒ½ç”¨äºæ”¹å˜å‡½æ•°æ‰§è¡Œæ—¶çš„ <code>this</code> æŒ‡å‘ï¼Œä½†ä½¿ç”¨æ–¹å¼ç•¥æœ‰ä¸åŒã€‚</p>
<h4 data-id="heading-11">æ¯”å–»è¯´æ˜</h4>
<p>æƒ³è±¡ä½ æ˜¯ä¸€å®¶å…¬å¸çš„CEOï¼ˆå‡½æ•°ï¼‰ï¼Œä½ éœ€è¦ç»™å‘˜å·¥ï¼ˆå¯¹è±¡ï¼‰ä¸‹è¾¾æŒ‡ä»¤ï¼š</p>
<ul>
<li><strong>call</strong>ï¼šç›´æ¥å‘Šè¯‰æŸä¸ªå‘˜å·¥è¯¥åšä»€ä¹ˆ</li>
<li><strong>apply</strong>ï¼šå‘Šè¯‰æŸä¸ªå‘˜å·¥è¯¥åšä»€ä¹ˆï¼Œå¹¶ç»™ä»–ä¸€è¢‹èµ„æ–™ï¼ˆæ•°ç»„å‚æ•°ï¼‰</li>
<li><strong>bind</strong>ï¼šé¢„å…ˆå‘Šè¯‰å‘˜å·¥ï¼Œå°†æ¥æŸä¸ªæ—¶é—´ç‚¹éœ€è¦åšä»€ä¹ˆ</li>
</ul>
<h4 data-id="heading-12">1. call æ–¹æ³•</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">introduce</span>(<span class="hljs-params">greeting, punctuation</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${greeting}</span>, æˆ‘æ˜¯<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span><span class="hljs-subst">${punctuation}</span>`</span>);
}

<span class="hljs-keyword">const</span> person = { <span class="hljs-attr">name</span>: <span class="hljs-string">'å¼ ä¸‰'</span> };

<span class="hljs-comment">// call æ¥å—å‚æ•°åˆ—è¡¨</span>
introduce.<span class="hljs-title function_">call</span>(person, <span class="hljs-string">'ä½ å¥½'</span>, <span class="hljs-string">'ï¼'</span>);  <span class="hljs-comment">// "ä½ å¥½, æˆ‘æ˜¯å¼ ä¸‰ï¼"</span>
</code></pre>
<h4 data-id="heading-13">2. apply æ–¹æ³•</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// apply æ¥å—å‚æ•°æ•°ç»„</span>
introduce.<span class="hljs-title function_">apply</span>(person, [<span class="hljs-string">'ä½ å¥½'</span>, <span class="hljs-string">'ï¼'</span>]);  <span class="hljs-comment">// "ä½ å¥½, æˆ‘æ˜¯å¼ ä¸‰ï¼"</span>
</code></pre>
<h4 data-id="heading-14">3. bind æ–¹æ³•</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// bind è¿”å›ä¸€ä¸ªæ–°å‡½æ•°ï¼Œè€Œä¸æ˜¯ç«‹å³æ‰§è¡Œ</span>
<span class="hljs-keyword">const</span> boundIntroduce = introduce.<span class="hljs-title function_">bind</span>(person, <span class="hljs-string">'ä½ å¥½'</span>);
<span class="hljs-title function_">boundIntroduce</span>(<span class="hljs-string">'ï¼'</span>);  <span class="hljs-comment">// "ä½ å¥½, æˆ‘æ˜¯å¼ ä¸‰ï¼"</span>
</code></pre>
<h4 data-id="heading-15">æ€»ç»“å¯¹æ¯”</h4>





























<table><thead><tr><th>æ–¹æ³•</th><th>ç«‹å³æ‰§è¡Œ</th><th>å‚æ•°å½¢å¼</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td>call</td><td>æ˜¯</td><td>å‚æ•°åˆ—è¡¨</td><td>å‡½æ•°æ‰§è¡Œç»“æœ</td></tr><tr><td>apply</td><td>æ˜¯</td><td>æ•°ç»„</td><td>å‡½æ•°æ‰§è¡Œç»“æœ</td></tr><tr><td>bind</td><td>å¦</td><td>å‚æ•°åˆ—è¡¨</td><td>æ–°å‡½æ•°</td></tr></tbody></table>
<h3 data-id="heading-16">ä¸‰ã€arguments å¯¹è±¡è¯¦è§£</h3>
<h4 data-id="heading-17">ä»€ä¹ˆæ˜¯ argumentsï¼Ÿ</h4>
<p><code>arguments</code> æ˜¯å‡½æ•°å†…éƒ¨çš„ä¸€ä¸ªç‰¹æ®Šå¯¹è±¡ï¼Œå®ƒåŒ…å«äº†å‡½æ•°è°ƒç”¨æ—¶ä¼ å…¥çš„æ‰€æœ‰å‚æ•°ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">showArgs</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">arguments</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">arguments</span>[<span class="hljs-number">0</span>]);
}

<span class="hljs-title function_">showArgs</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);
<span class="hljs-comment">// è¾“å‡ºï¼š</span>
<span class="hljs-comment">// Arguments(3) [1, 2, 3]</span>
<span class="hljs-comment">// 3</span>
<span class="hljs-comment">// 1</span>
</code></pre>
<h4 data-id="heading-18">arguments çš„ç‰¹ç‚¹</h4>
<h5 data-id="heading-19">1. ç±»æ•°ç»„å¯¹è±¡ï¼ˆArray-like Objectï¼‰</h5>
<p><code>arguments</code> çœ‹èµ·æ¥åƒæ•°ç»„ï¼Œä½†ä¸æ˜¯çœŸæ­£çš„æ•°ç»„ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">checkArguments</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é•¿åº¦:'</span>, <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¯ç´¢å¼•:'</span>, <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">0</span>], <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">1</span>]);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ˜¯æ•°ç»„å—?'</span>, <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(<span class="hljs-variable language_">arguments</span>));  <span class="hljs-comment">// false</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç±»å‹:'</span>, <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>)); <span class="hljs-comment">// [object Arguments]</span>
}

<span class="hljs-title function_">checkArguments</span>(<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>);
</code></pre>
<h5 data-id="heading-20">2. ä¸èƒ½ä½¿ç”¨æ•°ç»„çš„æ–¹æ³•</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">tryArrayMethods</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// è¿™äº›ä¼šæŠ¥é”™</span>
    <span class="hljs-comment">// arguments.map(item =&gt; item * 2);  // âŒ é”™è¯¯</span>
    <span class="hljs-comment">// arguments.reduce((sum, num) =&gt; sum + num);  // âŒ é”™è¯¯</span>
    
    <span class="hljs-comment">// ä½†å¯ä»¥è¿™æ ·éå†</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">arguments</span>[i]);
    }
    
    <span class="hljs-comment">// æˆ–è€…ç”¨ for...ofï¼ˆES6+ï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> arg <span class="hljs-keyword">of</span> <span class="hljs-variable language_">arguments</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arg);
    }
}
</code></pre>
<h4 data-id="heading-21">å¦‚ä½•å°† arguments è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ï¼Ÿ</h4>
<h5 data-id="heading-22">æ–¹æ³•1ï¼šArray.from (ES6)</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">convertArguments1</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> argsArray = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">arguments</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(argsArray));  <span class="hljs-comment">// true</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(argsArray.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> x * <span class="hljs-number">2</span>));  <span class="hljs-comment">// å¯ä»¥æ­£å¸¸ä½¿ç”¨æ•°ç»„æ–¹æ³•</span>
}
</code></pre>
<h5 data-id="heading-23">æ–¹æ³•2ï¼šæ‰©å±•è¿ç®—ç¬¦ (ES6)</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">convertArguments2</span>(<span class="hljs-params">...args</span>) {  <span class="hljs-comment">// ç›´æ¥åœ¨å‚æ•°ä¸­ä½¿ç”¨</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(args));  <span class="hljs-comment">// true</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">convertArguments3</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> argsArray = [...<span class="hljs-variable language_">arguments</span>];
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(argsArray));  <span class="hljs-comment">// true</span>
}
</code></pre>
<h5 data-id="heading-24">æ–¹æ³•3ï¼šArray.prototype.slice.call (ES5)</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">convertArguments4</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> argsArray = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">slice</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(argsArray));  <span class="hljs-comment">// true</span>
}
</code></pre>
<h4 data-id="heading-25">arguments çš„æ³¨æ„äº‹é¡¹</h4>
<ol>
<li><strong>ç®­å¤´å‡½æ•°æ²¡æœ‰ arguments</strong></li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">arrowFunc</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">arguments</span>);  <span class="hljs-comment">// âŒ æŠ¥é”™ï¼šarguments is not defined</span>
};

<span class="hljs-comment">// ç®­å¤´å‡½æ•°åº”è¯¥è¿™æ ·è·å–å‚æ•°</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">arrowFunc2</span> = (<span class="hljs-params">...args</span>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(args);  <span class="hljs-comment">// âœ… æ­£ç¡®</span>
};
</code></pre>
<ol start="2">
<li><strong>arguments å’Œå‚æ•°å˜é‡è”åŠ¨</strong>ï¼ˆéä¸¥æ ¼æ¨¡å¼ï¼‰</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">linkedArguments</span>(<span class="hljs-params">a, b</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'a:'</span>, a, <span class="hljs-string">'arguments[0]:'</span>, <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">0</span>]);
    
    a = <span class="hljs-string">'changed'</span>;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¿®æ”¹å a:'</span>, a, <span class="hljs-string">'arguments[0]:'</span>, <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">0</span>]);
    
    <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">0</span>] = <span class="hljs-string">'changed again'</span>;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å†æ¬¡ä¿®æ”¹å a:'</span>, a, <span class="hljs-string">'arguments[0]:'</span>, <span class="hljs-variable language_">arguments</span>[<span class="hljs-number">0</span>]);
}

<span class="hljs-title function_">linkedArguments</span>(<span class="hljs-string">'original'</span>, <span class="hljs-number">2</span>);
<span class="hljs-comment">// è¾“å‡ºï¼š</span>
<span class="hljs-comment">// a: original arguments[0]: original</span>
<span class="hljs-comment">// ä¿®æ”¹å a: changed arguments[0]: changed</span>
<span class="hljs-comment">// å†æ¬¡ä¿®æ”¹å a: changed again arguments[0]: changed again</span>
</code></pre>
<h3 data-id="heading-26">å››ã€å¼€å§‹æ‰‹å†™å®ç° new æ“ä½œç¬¦</h3>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç»“åˆä»¥ä¸ŠçŸ¥è¯†ç‚¹ï¼Œä¸€æ­¥æ­¥å®ç°è‡ªå·±çš„ <code>new</code> å‡½æ•°ã€‚</p>
<h4 data-id="heading-27">åŸºç¡€ç‰ˆæœ¬å®ç°</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">objectFactory</span>(<span class="hljs-params">Constructor, ...args</span>) {
    <span class="hljs-comment">// 1. åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡</span>
    <span class="hljs-keyword">const</span> obj = {};
    
    <span class="hljs-comment">// 2. å°†æ–°å¯¹è±¡çš„åŸå‹æŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹</span>
    obj.<span class="hljs-property">__proto__</span> = <span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
    
    <span class="hljs-comment">// 3. å°†æ„é€ å‡½æ•°çš„ this ç»‘å®šåˆ°æ–°å¯¹è±¡ï¼Œå¹¶æ‰§è¡Œæ„é€ å‡½æ•°</span>
    <span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">apply</span>(obj, args);
    
    <span class="hljs-comment">// 4. è¿”å›æ–°å¯¹è±¡</span>
    <span class="hljs-keyword">return</span> obj;
}
</code></pre>
<h4 data-id="heading-28">å¢å¼ºç‰ˆæœ¬ï¼ˆå¤„ç†æ„é€ å‡½æ•°è¿”å›å€¼ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">objectFactory</span>(<span class="hljs-params">Constructor, ...args</span>) {
    <span class="hljs-comment">// 1. åˆ›å»ºæ–°å¯¹è±¡ï¼Œå¹¶è®¾ç½®åŸå‹é“¾</span>
    <span class="hljs-keyword">const</span> obj = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
    
    <span class="hljs-comment">// 2. æ‰§è¡Œæ„é€ å‡½æ•°ï¼Œç»‘å®š this</span>
    <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">apply</span>(obj, args);
    
    <span class="hljs-comment">// 3. åˆ¤æ–­æ„é€ å‡½æ•°è¿”å›çš„æ˜¯å¦æ˜¯å¯¹è±¡</span>
    <span class="hljs-comment">// å¦‚æœæ˜¯å¯¹è±¡åˆ™è¿”å›è¯¥å¯¹è±¡ï¼Œå¦åˆ™è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> result === <span class="hljs-string">'object'</span> &amp;&amp; result !== <span class="hljs-literal">null</span> ? result : obj;
}
</code></pre>
<h4 data-id="heading-29">å®Œæ•´å®ç°ï¼ˆå…¼å®¹ ES5ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">objectFactory</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// 1. è·å–æ„é€ å‡½æ•°ï¼ˆç¬¬ä¸€ä¸ªå‚æ•°ï¼‰</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title class_">Constructor</span> = [].<span class="hljs-property">shift</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>);
    
    <span class="hljs-comment">// 2. åˆ›å»ºç©ºå¯¹è±¡ï¼Œå¹¶ç»§æ‰¿æ„é€ å‡½æ•°çš„åŸå‹</span>
    <span class="hljs-keyword">const</span> obj = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Constructor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
    
    <span class="hljs-comment">// 3. æ‰§è¡Œæ„é€ å‡½æ•°ï¼Œå°† this æŒ‡å‘æ–°å¯¹è±¡</span>
    <span class="hljs-keyword">const</span> result = <span class="hljs-title class_">Constructor</span>.<span class="hljs-title function_">apply</span>(obj, <span class="hljs-variable language_">arguments</span>);
    
    <span class="hljs-comment">// 4. è¿”å›ç»“æœ</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> result === <span class="hljs-string">'object'</span> ? result : obj;
}
</code></pre>
<h4 data-id="heading-30">ä½¿ç”¨ç¤ºä¾‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name, age</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
}

<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayHello</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ä½ å¥½ï¼Œæˆ‘æ˜¯<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>ï¼Œä»Šå¹´<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.age}</span>å²`</span>);
};

<span class="hljs-comment">// ä½¿ç”¨åŸç”Ÿçš„ new</span>
<span class="hljs-keyword">const</span> person1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-number">18</span>);
person1.<span class="hljs-title function_">sayHello</span>();  <span class="hljs-comment">// "ä½ å¥½ï¼Œæˆ‘æ˜¯å¼ ä¸‰ï¼Œä»Šå¹´18å²"</span>

<span class="hljs-comment">// ä½¿ç”¨æˆ‘ä»¬æ‰‹å†™çš„ objectFactory</span>
<span class="hljs-keyword">const</span> person2 = <span class="hljs-title function_">objectFactory</span>(<span class="hljs-title class_">Person</span>, <span class="hljs-string">'æå››'</span>, <span class="hljs-number">20</span>);
person2.<span class="hljs-title function_">sayHello</span>();  <span class="hljs-comment">// "ä½ å¥½ï¼Œæˆ‘æ˜¯æå››ï¼Œä»Šå¹´20å²"</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person1 <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Person</span>);  <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person2 <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Person</span>);  <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person1.<span class="hljs-property">sayHello</span> === person2.<span class="hljs-property">sayHello</span>);  <span class="hljs-comment">// trueï¼ˆå…±äº«åŸå‹æ–¹æ³•ï¼‰</span>
</code></pre>
<h4 data-id="heading-31">å¤„ç†ç‰¹æ®Šæƒ…å†µ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. æ„é€ å‡½æ•°è¿”å›å¯¹è±¡çš„æƒ…å†µ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Car</span>(<span class="hljs-params">model</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">model</span> = model;
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">custom</span>: <span class="hljs-string">'special object'</span> };  <span class="hljs-comment">// è¿”å›å¯¹è±¡</span>
}

<span class="hljs-keyword">const</span> car = <span class="hljs-title function_">objectFactory</span>(<span class="hljs-title class_">Car</span>, <span class="hljs-string">'Tesla'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(car);  <span class="hljs-comment">// {custom: "special object"}ï¼Œè€Œä¸æ˜¯ Car å®ä¾‹</span>

<span class="hljs-comment">// 2. æ„é€ å‡½æ•°è¿”å›åŸºæœ¬ç±»å‹çš„æƒ…å†µ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Bike</span>(<span class="hljs-params">brand</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">brand</span> = brand;
    <span class="hljs-keyword">return</span> <span class="hljs-string">'not an object'</span>;  <span class="hljs-comment">// è¿”å›åŸºæœ¬ç±»å‹ï¼Œä¼šè¢«å¿½ç•¥</span>
}

<span class="hljs-keyword">const</span> bike = <span class="hljs-title function_">objectFactory</span>(<span class="hljs-title class_">Bike</span>, <span class="hljs-string">'Giant'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(bike);  <span class="hljs-comment">// Bike {brand: "Giant"}ï¼Œè¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡</span>
</code></pre>
<h3 data-id="heading-32">äº”ã€å®é™…åº”ç”¨åœºæ™¯</h3>
<h4 data-id="heading-33">1. åº“æˆ–æ¡†æ¶ä¸­çš„ä½¿ç”¨</h4>
<p>è®¸å¤šåº“ï¼ˆå¦‚æ—©æœŸçš„ jQueryï¼‰ä¼šä½¿ç”¨ç±»ä¼¼çš„æŠ€æœ¯æ¥åˆ›å»ºå¯¹è±¡ï¼Œé¿å…ä½¿ç”¨ <code>new</code> å…³é”®å­—ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// jQuery é£æ ¼çš„åˆå§‹åŒ–</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">$</span>(<span class="hljs-params">selector</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">jQuery</span>(selector);
}

<span class="hljs-comment">// æˆ–è€…</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">$</span>(<span class="hljs-params">selector</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">objectFactory</span>(jQuery, selector);
}
</code></pre>
<h4 data-id="heading-34">2. åˆ›å»ºå¯¹è±¡æ± </h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createObjectPool</span>(<span class="hljs-params">Constructor, count</span>) {
    <span class="hljs-keyword">const</span> pool = [];
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; count; i++) {
        pool.<span class="hljs-title function_">push</span>(<span class="hljs-title function_">objectFactory</span>(<span class="hljs-title class_">Constructor</span>));
    }
    
    <span class="hljs-keyword">return</span> pool;
}

<span class="hljs-comment">// åˆ›å»º 10 ä¸ªé»˜è®¤çš„ Person å¯¹è±¡</span>
<span class="hljs-keyword">const</span> personPool = <span class="hljs-title function_">createObjectPool</span>(<span class="hljs-title class_">Person</span>, <span class="hljs-number">10</span>);
</code></pre>
<h4 data-id="heading-35">3. å®ç°å•ä¾‹æ¨¡å¼</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">singleton</span>(<span class="hljs-params">Constructor, ...args</span>) {
    <span class="hljs-keyword">let</span> instance = <span class="hljs-literal">null</span>;
    
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">if</span> (!instance) {
            instance = <span class="hljs-title function_">objectFactory</span>(<span class="hljs-title class_">Constructor</span>, ...args);
        }
        <span class="hljs-keyword">return</span> instance;
    };
}

<span class="hljs-keyword">const</span> getSingletonPerson = <span class="hljs-title function_">singleton</span>(<span class="hljs-title class_">Person</span>, <span class="hljs-string">'å•ä¾‹'</span>, <span class="hljs-number">100</span>);
<span class="hljs-keyword">const</span> p1 = <span class="hljs-title function_">getSingletonPerson</span>();
<span class="hljs-keyword">const</span> p2 = <span class="hljs-title function_">getSingletonPerson</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p1 === p2);  <span class="hljs-comment">// true</span>
</code></pre>
<h3 data-id="heading-36">æ€»ç»“</h3>
<p>é€šè¿‡æ‰‹å†™ <code>new</code> æ“ä½œç¬¦ï¼Œæˆ‘ä»¬æ·±å…¥ç†è§£äº† JavaScript å¯¹è±¡å®ä¾‹åŒ–çš„è¿‡ç¨‹ï¼š</p>
<ol>
<li><strong>åˆ›å»ºç©ºå¯¹è±¡</strong>ï¼šå»ºç«‹å¯¹è±¡çš„"è‚‰èº«"</li>
<li><strong>è®¾ç½®åŸå‹é“¾</strong>ï¼šè¿æ¥å¯¹è±¡çš„"çµé­‚"ï¼ˆç»§æ‰¿ï¼‰</li>
<li><strong>æ‰§è¡Œæ„é€ å‡½æ•°</strong>ï¼šèµ‹äºˆå¯¹è±¡"ä¸ªæ€§"ï¼ˆå±æ€§ï¼‰</li>
<li><strong>è¿”å›å¯¹è±¡</strong>ï¼šå†³å®šæœ€ç»ˆ"å‡ºå‚"çš„æ˜¯ä»€ä¹ˆ</li>
</ol>
<p>ç†è§£è¿™äº›åº•å±‚æœºåˆ¶ï¼Œä¸ä»…å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ä½¿ç”¨ JavaScriptï¼Œè¿˜èƒ½åœ¨é¢è¯•ä¸­è„±é¢–è€Œå‡ºã€‚æ›´é‡è¦çš„æ˜¯ï¼Œè¿™ç§"çŸ¥å…¶ç„¶çŸ¥å…¶æ‰€ä»¥ç„¶"çš„å­¦ä¹ æ–¹å¼ï¼Œèƒ½å¤Ÿè®©æˆ‘ä»¬åœ¨é¢å¯¹å¤æ‚é—®é¢˜æ—¶ï¼Œæœ‰èƒ½åŠ›ä»åº•å±‚åŸç†å‡ºå‘ï¼Œæ‰¾åˆ°æœ€ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>è®°ä½ï¼Œæ¯ä¸ªçœ‹ä¼¼ç®€å•çš„ <code>new</code> èƒŒåï¼Œéƒ½éšè—ç€ JavaScript åŸå‹é“¾ã€<code>this</code> ç»‘å®šã€å‡½æ•°æ‰§è¡Œç­‰å¤šä¸ªæ ¸å¿ƒæ¦‚å¿µçš„å®Œç¾åä½œã€‚æŒæ¡äº†è¿™äº›ï¼Œä½ å°±çœŸæ­£ç†è§£äº† JavaScript é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ç²¾é«“ã€‚</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶æ‰‹å†™JavaScriptç»§æ‰¿å‡½æ•°ï¼šä¸€åœºå…³äº"å®¶æ—ä¼ æ‰¿"çš„ç¼–ç¨‹ä¹‹æ—…]]></title>    <link>https://juejin.cn/post/7603575763787743258</link>    <guid>https://juejin.cn/post/7603575763787743258</guid>    <pubDate>2026-02-07T09:20:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603575763787743258" data-draft-id="7603567912593653787" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶æ‰‹å†™JavaScriptç»§æ‰¿å‡½æ•°ï¼šä¸€åœºå…³äº&quot;å®¶æ—ä¼ æ‰¿&quot;çš„ç¼–ç¨‹ä¹‹æ—…"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2026-02-07T09:20:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸ä¼šæ•²ä»£ç 1"/> <meta itemprop="url" content="https://juejin.cn/user/1927884034804425"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶æ‰‹å†™JavaScriptç»§æ‰¿å‡½æ•°ï¼šä¸€åœºå…³äº"å®¶æ—ä¼ æ‰¿"çš„ç¼–ç¨‹ä¹‹æ—…
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1927884034804425/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸ä¼šæ•²ä»£ç 1
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T09:20:52.000Z" title="Sat Feb 07 2026 09:20:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»é›¶æ‰‹å†™JavaScriptç»§æ‰¿å‡½æ•°ï¼šä¸€åœºå…³äº"å®¶æ—ä¼ æ‰¿"çš„ç¼–ç¨‹ä¹‹æ—…</h2>
<h3 data-id="heading-1">å¼•è¨€ï¼šJavaScriptçš„"ä¸ä¼—ä¸åŒ"</h3>
<p>åœ¨JavaScriptçš„ä¸–ç•Œé‡Œï¼Œç»§æ‰¿ä¸æ˜¯ç®€å•çš„å¤åˆ¶ç²˜è´´ï¼Œè€Œæ˜¯ä¸€åœºå…³äº"åŸå‹é“¾"çš„å¥‡å¦™å†’é™©ã€‚æƒ³è±¡ä¸€ä¸‹ï¼šåˆ«çš„è¯­è¨€ç»§æ‰¿å°±åƒé¢†å…»å­©å­ï¼Œç›´æ¥ç»™ä¸€å¥—æ–°æˆ¿å­å’Œæ–°è¡£æœï¼›è€ŒJavaScriptçš„ç»§æ‰¿æ›´åƒæ˜¯å®¶æ—ä¼ æ‰¿â€”â€”å­©å­ä¸ä»…æœ‰è‡ªå·±çš„å®¶ï¼Œè¿˜èƒ½éšæ—¶å»ç¥–è¾ˆå®¶é‡Œä¸²é—¨æ‹¿ä¸œè¥¿ï¼</p>
<p>ä»Šå¤©ï¼Œå°±è®©æˆ‘ä»¬ä¸€èµ·æ­å¼€JavaScriptç»§æ‰¿çš„ç¥ç§˜é¢çº±ï¼Œäº²æ‰‹æ‰“é€ ä¸€ä¸ªå±äºè‡ªå·±çš„"å®¶æ—ä¼ æ‰¿"ç³»ç»Ÿã€‚</p>
<h3 data-id="heading-2">ä¸€ã€åŸå‹é“¾ç»§æ‰¿ï¼šç›´æˆªäº†å½“çš„"å®¶æ—ä¼ä¸š"</h3>
<p>è®©æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹JavaScriptä¸­æœ€"æœ´å®"çš„ç»§æ‰¿æ–¹å¼ã€‚</p>
<h4 data-id="heading-3">ä¸€ä¸ªåŠ¨ç‰©ç‹å›½çš„æ•…äº‹</h4>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª<code>Animal</code>ï¼ˆåŠ¨ç‰©ï¼‰å®¶æ—ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params">name, age</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;   <span class="hljs-comment">// åå­—</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;     <span class="hljs-comment">// å¹´é¾„</span>
}
<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">species</span> = <span class="hljs-string">'åŠ¨ç‰©'</span>;  <span class="hljs-comment">// æ‰€æœ‰åŠ¨ç‰©éƒ½æœ‰çš„ç‰©ç§å±æ€§</span>
</code></pre>
<p>ç°åœ¨ï¼Œ<code>Cat</code>ï¼ˆçŒ«ï¼‰å®¶æ—æƒ³è¦ç»§æ‰¿<code>Animal</code>å®¶æ—çš„ä¼˜è‰¯ä¼ ç»Ÿã€‚æœ€ç®€å•çš„åšæ³•æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<h4 data-id="heading-4">æ–¹æ³•ä¸€ï¼šç›´æ¥"è®¤ç¥–å½’å®—"</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, age, color</span>) {
    <span class="hljs-comment">// å…ˆæŠŠAnimalå®¶æ—çš„åŸºæœ¬åŠŸå­¦è¿‡æ¥</span>
    <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, name, age);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;  <span class="hljs-comment">// çŒ«ç‰¹æœ‰çš„æ¯›è‰²</span>
}

<span class="hljs-comment">// å…³é”®ä¸€æ­¥ï¼šæˆä¸ºAnimalå®¶æ—çš„"äº²ä¼ å¼Ÿå­"</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>();
<span class="hljs-comment">// ä½†åˆ«å¿˜äº†æ”¹ä¸ªåï¼Œä¸ç„¶åˆ«äººè¿˜ä»¥ä¸ºä½ æ˜¯Animal</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Cat</span>;

<span class="hljs-keyword">const</span> garfield = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'åŠ è²çŒ«'</span>, <span class="hljs-number">2</span>, <span class="hljs-string">'é»„è‰²'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(garfield.<span class="hljs-property">species</span>);  <span class="hljs-comment">// âœ… è¾“å‡ºï¼šåŠ¨ç‰©ï¼ˆæˆåŠŸç»§æ‰¿äº†ç‰©ç§ï¼ï¼‰</span>
</code></pre>
<p><strong>è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</strong></p>
<ul>
<li><code>Cat.prototype = new Animal()</code>ï¼šç›¸å½“äºCatå®¶æ—æŠŠAnimalè¯·æ¥å½“é¡¾é—®</li>
<li>ç°åœ¨æ‰€æœ‰Catéƒ½å¯ä»¥é€šè¿‡"é¡¾é—®"è®¿é—®Animalå®¶æ—çš„èµ„æº</li>
</ul>
<h4 data-id="heading-5">ä½†è¿™ç§åšæ³•æœ‰ä¸ªå¤§é—®é¢˜...</h4>
<p><strong>åœºæ™¯æƒ³è±¡</strong>ï¼šä½ æƒ³è¯·Animalå½“é¡¾é—®ï¼Œç»“æœäººå®¶æ‹–å®¶å¸¦å£ã€æŠŠå…¨éƒ¨å®¶å½“éƒ½æ¬æ¥äº†ï¼<code>new Animal()</code>åˆ›å»ºäº†ä¸€ä¸ªå®Œæ•´çš„Animalå®ä¾‹ï¼Œä½†æˆ‘ä»¬éœ€è¦çš„ä»…ä»…æ˜¯Animalçš„"çŸ¥è¯†åº“"ï¼ˆåŸå‹ï¼‰ï¼Œè€Œä¸æ˜¯å®ƒçš„å…¨éƒ¨èº«å®¶ã€‚</p>
<p><strong>ä¸‰å¤§ç—›ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>æµªè´¹å†…å­˜</strong>ï¼šAnimalå®ä¾‹å¯èƒ½å¾ˆå¤§ï¼Œä½†Catåªéœ€è¦å®ƒçš„åŸå‹</li>
<li><strong>å‚æ•°å°´å°¬</strong>ï¼š<code>new Animal()</code>æ—¶éœ€è¦å‚æ•°ï¼Œä½†ä½œä¸ºåŸå‹æ—¶ä¸çŸ¥é“ä¼ ä»€ä¹ˆ</li>
<li><strong>æ•ˆç‡ä½ä¸‹</strong>ï¼šæ¯æ¬¡ç»§æ‰¿éƒ½è¦åˆ›å»ºä¸€ä¸ªå¯èƒ½æ°¸è¿œç”¨ä¸ç€çš„å®ä¾‹</li>
</ol>
<h3 data-id="heading-6">äºŒã€èµ°æ·å¾„çš„è¯±æƒ‘ï¼šç›´æ¥"å…±äº«å®¶è°±"</h3>
<p>æœ‰äººå¯èƒ½æƒ³ï¼š"æ—¢ç„¶åªæ˜¯è¦åŸå‹ï¼Œé‚£ç›´æ¥å…±äº«ä¸å°±è¡Œäº†ï¼Ÿ"</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// çœ‹ä¼¼èªæ˜çš„å·æ‡’æ–¹æ³•</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Cat</span>;
</code></pre>
<p><strong>å±é™©ï¼è¿™æ˜¯ä¸ªé™·é˜±ï¼</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// çŒ«å®¶æ—æƒ³ç»™è‡ªå·±åŠ ä¸ªæŠ€èƒ½</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">eatFish</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æˆ‘çˆ±åƒé±¼ï¼'</span>);
};

<span class="hljs-comment">// ä½†æ„å¤–å‘ç”Ÿäº†...</span>
<span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>(<span class="hljs-string">'æ—ºè´¢'</span>, <span class="hljs-number">3</span>);
dog.<span class="hljs-title function_">eatFish</span>();  <span class="hljs-comment">// ğŸ˜± è¾“å‡ºï¼šæˆ‘çˆ±åƒé±¼ï¼ï¼ˆç‹—æ€ä¹ˆçˆ±åƒé±¼äº†ï¼Ÿï¼ï¼‰</span>
</code></pre>
<p><strong>é—®é¢˜æ‰€åœ¨</strong>ï¼š</p>
<ul>
<li><code>Cat.prototype</code>å’Œ<code>Animal.prototype</code>æŒ‡å‘<strong>åŒä¸€ä¸ªå¯¹è±¡</strong></li>
<li>ç»™Catæ·»åŠ æ–¹æ³•ï¼ŒAnimalä¹Ÿä¼š"è¢«å­¦ä¼š"</li>
<li>å°±åƒä¸¤ä¸ªéƒ¨é—¨å…±ç”¨åŒä¸€ä¸ªå°ç« ï¼Œä¸€æ–¹ä¿®æ”¹ï¼Œå¦ä¸€æ–¹é­æ®ƒ</li>
</ul>
<h3 data-id="heading-7">ä¸‰ã€ç»ˆææ–¹æ¡ˆï¼šèªæ˜çš„"ä¸­é—´äºº"ç­–ç•¥</h3>
<p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ—¢èƒ½ç»§æ‰¿çŸ¥è¯†ï¼Œåˆä¸é€ æˆæ··ä¹±çš„æ–¹æ³•ã€‚è¿™å°±æ˜¯æˆ‘ä»¬çš„"ç©ºå‡½æ•°ä¸­ä»‹"æ¨¡å¼â€”â€”ä¸€ä¸ªèªæ˜çš„"ä¼ è¯ç­’"ã€‚</p>
<h4 data-id="heading-8">æ‰‹å†™extendså‡½æ•°ï¼šæ‰“é€ å®Œç¾çš„å®¶æ—ä¼ æ‰¿</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">extend</span>(<span class="hljs-params">Parent, Child</span>) {
    <span class="hljs-comment">// 1. è¯·ä¸€ä¸ª"ä¸­é—´äºº"ï¼ˆç©ºå‡½æ•°Fï¼‰</span>
    <span class="hljs-comment">// å®ƒå°±åƒå®¶æ—é—´çš„ä¸“ä¸šç¿»è¯‘ï¼Œåªä¼ è¯ï¼Œä¸æ·»ä¹±</span>
    <span class="hljs-keyword">var</span> F = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {};
    
    <span class="hljs-comment">// 2. è®©ä¸­é—´äººå­¦ä¹ Parentçš„çŸ¥è¯†åº“</span>
    F.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
    
    <span class="hljs-comment">// 3. è®©Childæ‹œä¸­é—´äººä¸ºå¸ˆ</span>
    <span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_">F</span>();
    
    <span class="hljs-comment">// 4. ç»™Childæ­£åï¼šä½ å§“Childï¼Œä¸æ˜¯Parent</span>
    <span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Child</span>;
}
</code></pre>
<h4 data-id="heading-9">æ¥çœ‹çœ‹è¿™ä¸ªç²¾å¦™çš„ä¼ æ‰¿ç³»ç»Ÿå¦‚ä½•å·¥ä½œ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨æˆ‘ä»¬çš„extendå‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, age, color</span>) {
    <span class="hljs-comment">// ç»§æ‰¿Animalçš„"ä¸ªäººèƒ½åŠ›"</span>
    <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, [name, age]);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;  <span class="hljs-comment">// çŒ«çš„ç‹¬æœ‰ç‰¹å¾</span>
}

<span class="hljs-comment">// å¯åŠ¨ä¼ æ‰¿ä»ªå¼ï¼</span>
<span class="hljs-title function_">extend</span>(<span class="hljs-title class_">Animal</span>, <span class="hljs-title class_">Cat</span>);

<span class="hljs-comment">// çŒ«å®¶æ—å‘å±•è‡ªå·±çš„ç‰¹è‰²</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">purr</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å–µå‘œ~å‘å‡ºå‘¼å™œå£°'</span>);
};

<span class="hljs-comment">// è§è¯å¥‡è¿¹çš„æ—¶åˆ»</span>
<span class="hljs-keyword">const</span> kitty = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'å°æ©˜'</span>, <span class="hljs-number">1</span>, <span class="hljs-string">'æ©˜è‰²'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(kitty.<span class="hljs-property">species</span>);  <span class="hljs-comment">// âœ… "åŠ¨ç‰©"ï¼ˆç»§æ‰¿äº†Animalçš„ç‰©ç§ï¼‰</span>
kitty.<span class="hljs-title function_">purr</span>();               <span class="hljs-comment">// âœ… "å–µå‘œ~å‘å‡ºå‘¼å™œå£°"ï¼ˆçŒ«çš„ç‹¬æœ‰æŠ€èƒ½ï¼‰</span>

<span class="hljs-keyword">const</span> bird = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>(<span class="hljs-string">'å°é¸Ÿ'</span>, <span class="hljs-number">0.5</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(bird.<span class="hljs-property">purr</span>);     <span class="hljs-comment">// âœ… undefinedï¼ˆå®Œå…¨æ²¡å½±å“åˆ°Animalï¼ï¼‰</span>
</code></pre>
<h4 data-id="heading-10">ä¸ºä»€ä¹ˆè¿™ä¸ªæ–¹æ¡ˆå¦‚æ­¤ä¼˜é›…ï¼Ÿ</h4>
<p><strong>ä¸‰å±‚éš”ç¦»ä¿æŠ¤</strong>ï¼š</p>
<ol>
<li><strong>ç¬¬ä¸€å±‚</strong>ï¼šCatæœ‰è‡ªå·±çš„åŸå‹å¯¹è±¡</li>
<li><strong>ç¬¬äºŒå±‚</strong>ï¼šé€šè¿‡ä¸­é—´äººFè®¿é—®Animalçš„åŸå‹</li>
<li><strong>ç¬¬ä¸‰å±‚</strong>ï¼šå¯¹CatåŸå‹çš„ä¿®æ”¹å®Œå…¨ä¸å½±å“Animal</li>
</ol>
<p><strong>å†…å­˜å…³ç³»å›¾</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">kittyï¼ˆçŒ«å®ä¾‹ï¼‰
    â†“ <span class="hljs-string">"æˆ‘å¯ä»¥æ‰¾æˆ‘çš„å®¶æ—è¦ä¸œè¥¿"</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>ï¼ˆçŒ«å®¶æ—çŸ¥è¯†åº“ï¼‰
    â†“ <span class="hljs-string">"æˆ‘å­¦è‡ªä¸­é—´äººF"</span>
F.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>ï¼ˆ= <span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>ï¼‰
    â†“ <span class="hljs-string">"æˆ‘æ¥è‡ªAnimalå®¶æ—"</span>
<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>ï¼ˆåŠ¨ç‰©å®¶æ—çŸ¥è¯†åº“ï¼‰
    â†“ <span class="hljs-string">"æˆ‘æ˜¯æ‰€æœ‰å¯¹è±¡çš„èµ·ç‚¹"</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>
</code></pre>
<h3 data-id="heading-11">å››ã€å®Œæ•´å®æˆ˜ï¼šæ‰“é€ åŠ¨ç‰©ä¸–ç•Œçš„ç»§æ‰¿ä½“ç³»</h3>
<p>è®©æˆ‘ä»¬æŠŠç†è®ºå˜æˆå®æˆ˜ä»£ç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¢å¼ºç‰ˆextendï¼šæ›´æ™ºèƒ½çš„ä¼ æ‰¿ç³»ç»Ÿ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">extend</span>(<span class="hljs-params">Child, Parent</span>) {
    <span class="hljs-comment">// 1. è¯·ä¸“ä¸šä¸­é—´äººï¼ˆå¼€é”€æå°ï¼‰</span>
    <span class="hljs-keyword">var</span> F = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {};
    
    <span class="hljs-comment">// 2. ä¸­é—´äººå­¦ä¹ Parentçš„å…¨éƒ¨çŸ¥è¯†</span>
    F.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
    
    <span class="hljs-comment">// 3. Childæ‹œå¸ˆå­¦è‰º</span>
    <span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_">F</span>();
    <span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Child</span>;
    
    <span class="hljs-comment">// 4. ç»™Childä¸€ä¸ª"å®¶è°±"ï¼ˆå¯é€‰ä½†å¾ˆè´´å¿ƒï¼‰</span>
    <span class="hljs-title class_">Child</span>.<span class="hljs-property">uber</span> = <span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
    
    <span class="hljs-comment">// 5. ç°ä»£JavaScriptçš„é¢å¤–æ”¯æŒ</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Object</span>.<span class="hljs-property">setPrototypeOf</span>) {
        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">setPrototypeOf</span>(<span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>, <span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
    }
}

<span class="hljs-comment">// åŠ¨ç‰©å®¶æ—åŸºç±»</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params">name, age</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
}
<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">breathe</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'æˆ‘åœ¨å‘¼å¸æ–°é²œç©ºæ°”'</span>;
};

<span class="hljs-comment">// çŒ«å®¶æ—</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, age, color</span>) {
    <span class="hljs-comment">// å…ˆå­¦Animalçš„"ç”Ÿå­˜æŠ€èƒ½"</span>
    <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, name, age);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
}

<span class="hljs-comment">// å¯åŠ¨ä¼ æ‰¿</span>
<span class="hljs-title function_">extend</span>(<span class="hljs-title class_">Cat</span>, <span class="hljs-title class_">Animal</span>);

<span class="hljs-comment">// çŒ«å®¶æ—çš„ç‹¬é—¨ç»æŠ€</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">climbTree</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'æˆ‘èƒ½çˆ¬ä¸Šæœ€é«˜çš„æ ‘ï¼'</span>;
};

<span class="hljs-comment">// çœ‹çœ‹æˆæœ</span>
<span class="hljs-keyword">const</span> tom = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'æ±¤å§†'</span>, <span class="hljs-number">3</span>, <span class="hljs-string">'è“ç°è‰²'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(tom.<span class="hljs-title function_">breathe</span>());    <span class="hljs-comment">// âœ… "æˆ‘åœ¨å‘¼å¸æ–°é²œç©ºæ°”"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(tom.<span class="hljs-title function_">climbTree</span>());  <span class="hljs-comment">// âœ… "æˆ‘èƒ½çˆ¬ä¸Šæœ€é«˜çš„æ ‘ï¼"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(tom.<span class="hljs-property">color</span>);        <span class="hljs-comment">// âœ… "è“ç°è‰²"</span>
</code></pre>
<h3 data-id="heading-12">äº”ã€ç°ä»£JavaScriptï¼šè¯­æ³•ç³–èƒŒåçš„çœŸç›¸</h3>
<p>ES6ç»™äº†æˆ‘ä»¬æ›´ä¼˜é›…çš„å†™æ³•ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name, age</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;
    }
    
    <span class="hljs-title function_">breathe</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">'æˆ‘åœ¨å‘¼å¸æ–°é²œç©ºæ°”'</span>;
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name, age, color</span>) {
        <span class="hljs-variable language_">super</span>(name, age);  <span class="hljs-comment">// è¿™è¡Œç›¸å½“äº Animal.call(this, name, age)</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
    }
    
    <span class="hljs-title function_">climbTree</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">'æˆ‘èƒ½çˆ¬ä¸Šæœ€é«˜çš„æ ‘ï¼'</span>;
    }
}
</code></pre>
<p><strong>é‡è¦æé†’</strong>ï¼š<code>class</code>åªæ˜¯"è¯­æ³•ç³–"ï¼Œåº•å±‚ä¾ç„¶æ˜¯æˆ‘ä»¬çš„åŸå‹ç»§æ‰¿ã€‚ç†è§£åŸå‹ï¼Œæ‰èƒ½çœŸæ­£æŒæ¡JavaScriptçš„ç»§æ‰¿ç²¾é«“ã€‚</p>
<h3 data-id="heading-13">æ€»ç»“ï¼šç»§æ‰¿çš„æ™ºæ…§</h3>
<p>é€šè¿‡è¿™æ¬¡æ¢ç´¢ï¼Œæˆ‘ä»¬å­¦åˆ°äº†ï¼š</p>
<ol>
<li><strong>åŸå‹å®ä¾‹åŒ–ç»§æ‰¿</strong> â†’ ç®€å•ç²—æš´ä½†ç¬¨é‡ï¼ˆè¯·æ•´ä¸ªå®¶æ—å½“é¡¾é—®ï¼‰</li>
<li><strong>ç›´æ¥åŸå‹ç»§æ‰¿</strong> â†’ å±é™©æ·å¾„ï¼ˆå…±ç”¨å®¶è°±ï¼Œä¸€æŸä¿±æŸï¼‰</li>
<li><strong>ç©ºå‡½æ•°ä¸­ä»‹æ¨¡å¼</strong> â†’ ä¼˜é›…æ–¹æ¡ˆï¼ˆä¸“ä¸šä¸­é—´äººï¼Œéš”ç¦»åˆé«˜æ•ˆï¼‰</li>
</ol>
<p><strong>ç¼–ç¨‹å°±åƒå®¶æ—ä¼ æ‰¿</strong>ï¼š</p>
<ul>
<li>å¥½çš„ç»§æ‰¿åº”è¯¥åƒå®¶è®­ä¼ æ‰¿ï¼šåä»£å­¦ä¹ å‰è¾ˆçš„æ™ºæ…§ï¼Œä½†æœ‰è‡ªå·±çš„å‘å±•</li>
<li>åçš„ç»§æ‰¿å°±åƒè´¢äº§çº çº·ï¼šè¾¹ç•Œä¸æ¸…ï¼Œäº’ç›¸å½±å“</li>
<li>æˆ‘ä»¬çš„<code>extend</code>å‡½æ•°å°±åƒæ˜¯æ‰¾åˆ°äº†å®Œç¾çš„å®¶æ—ä¿¡æ‰˜æ–¹æ¡ˆ</li>
</ul>
<h3 data-id="heading-14">è¿›é˜¶æ€è€ƒ</h3>
<p>å¦‚æœä½ è¦ç»§ç»­ä¼˜åŒ–è¿™ä¸ª<code>extend</code>å‡½æ•°ï¼Œä½ ä¼šæ·»åŠ å“ªäº›åŠŸèƒ½ï¼Ÿ</p>
<ol>
<li><strong>å¤šé‡ç»§æ‰¿</strong>ï¼šåƒç»§æ‰¿å¤šä¸ªå®¶æ—çš„ä¼˜ç§€åŸºå› ï¼Ÿ</li>
<li><strong>æ–¹æ³•æ··å…¥</strong>ï¼šåƒé€‰æ‹©æ€§å­¦ä¹ ä¸åŒå¸ˆçˆ¶çš„ç»æ‹›ï¼Ÿ</li>
<li><strong>é™æ€æ–¹æ³•ç»§æ‰¿</strong>ï¼šè¿å®¶æ—çš„ä¼ ç»Ÿä»ªå¼ä¹Ÿä¸€èµ·ç»§æ‰¿ï¼Ÿ</li>
</ol>
<hr/>
<p><strong>åŠ¨æ‰‹æŒ‘æˆ˜</strong>ï¼šå°è¯•å®ç°ä¸€ä¸ªæ”¯æŒå¤šé‡ç»§æ‰¿çš„<code>extend</code>å‡½æ•°ï¼Œè®©ä¸€ä¸ªç±»å¯ä»¥åŒæ—¶ç»§æ‰¿å¤šä¸ªçˆ¶ç±»çš„ç‰¹æ€§ã€‚æŠŠä½ çš„ä»£ç åˆ†äº«åˆ°è¯„è®ºåŒºï¼Œçœ‹çœ‹è°çš„å®ç°æœ€ä¼˜é›…ï¼</p>
<p><strong>è®°ä½</strong>ï¼šåœ¨JavaScriptçš„ä¸–ç•Œé‡Œï¼Œç†è§£åŸå‹é“¾å°±åƒæŒæ¡å®¶æ—çš„ç§˜å¯†é€šé“ã€‚é€šè¿‡è¿™äº›é€šé“ï¼Œä½ å¯ä»¥åœ¨ä¸ç ´ååŸæœ‰ç»“æ„çš„å‰æä¸‹ï¼Œæ„å»ºå‡ºå¼ºå¤§è€Œçµæ´»çš„ä»£ç "å®¶æ—"ã€‚ç°åœ¨ï¼Œä½ ä¹Ÿæ˜¯æŒæ¡è¿™ä¸ªç§˜å¯†çš„å¼€å‘è€…äº†ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶å®ç° MCP å®¢æˆ·ç«¯ï¼šblade-code çš„ MCP é›†æˆå®æˆ˜]]></title>    <link>https://juejin.cn/post/7603616672927088655</link>    <guid>https://juejin.cn/post/7603616672927088655</guid>    <pubDate>2026-02-07T09:57:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603616672927088655" data-draft-id="7603588665568100392" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶å®ç° MCP å®¢æˆ·ç«¯ï¼šblade-code çš„ MCP é›†æˆå®æˆ˜"/> <meta itemprop="keywords" content="Java,JavaScript"/> <meta itemprop="datePublished" content="2026-02-07T09:57:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="echoVic"/> <meta itemprop="url" content="https://juejin.cn/user/729731451069998"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶å®ç° MCP å®¢æˆ·ç«¯ï¼šblade-code çš„ MCP é›†æˆå®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/729731451069998/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    echoVic
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T09:57:09.000Z" title="Sat Feb 07 2026 09:57:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡æ˜¯ blade-code æŠ€æœ¯æ·±åº¦ç³»åˆ—çš„ç¬¬ 1 ç¯‡ï¼Œæ·±å…¥å‰–æå¦‚ä½•ä»é›¶å®ç°ä¸€ä¸ªç”Ÿäº§çº§çš„ MCPï¼ˆModel Context Protocolï¼‰å®¢æˆ·ç«¯ï¼ŒåŒ…æ‹¬è¿æ¥ç®¡ç†ã€OAuth è®¤è¯ã€å¥åº·ç›‘æ§ã€å·¥å…·æ³¨å†Œç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ç›®å½•</h2>
<ul>
<li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF-mcp" title="#%E4%BB%80%E4%B9%88%E6%98%AF-mcp">ä»€ä¹ˆæ˜¯ MCPï¼Ÿ</a></li>
<li><a href="#%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1" title="#%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1">æ¶æ„è®¾è®¡</a></li>
<li><a href="#%E6%A0%B8%E5%BF%83%E5%AE%9E%E7%8E%B0" title="#%E6%A0%B8%E5%BF%83%E5%AE%9E%E7%8E%B0">æ ¸å¿ƒå®ç°</a>
<ul>
<li><a href="#1-mcpclient%E8%BF%9E%E6%8E%A5%E4%B8%8E%E9%80%9A%E4%BF%A1" title="#1-mcpclient%E8%BF%9E%E6%8E%A5%E4%B8%8E%E9%80%9A%E4%BF%A1">1. McpClientï¼šè¿æ¥ä¸é€šä¿¡</a></li>
<li><a href="#2-mcpregistry%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86" title="#2-mcpregistry%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%A1%E7%90%86">2. McpRegistryï¼šæœåŠ¡å™¨ç®¡ç†</a></li>
<li><a href="#3-oauth-%E8%AE%A4%E8%AF%81" title="#3-oauth-%E8%AE%A4%E8%AF%81">3. OAuth è®¤è¯</a></li>
<li><a href="#4-%E5%81%A5%E5%BA%B7%E7%9B%91%E6%8E%A7" title="#4-%E5%81%A5%E5%BA%B7%E7%9B%91%E6%8E%A7">4. å¥åº·ç›‘æ§</a></li>
</ul>
</li>
<li><a href="#%E5%B7%A5%E5%85%B7%E5%8A%A8%E6%80%81%E6%B3%A8%E5%86%8C" title="#%E5%B7%A5%E5%85%B7%E5%8A%A8%E6%80%81%E6%B3%A8%E5%86%8C">å·¥å…·åŠ¨æ€æ³¨å†Œ</a></li>
<li><a href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E4%B8%8E%E9%87%8D%E8%BF%9E" title="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86%E4%B8%8E%E9%87%8D%E8%BF%9E">é”™è¯¯å¤„ç†ä¸é‡è¿</a></li>
<li><a href="#%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B" title="#%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B">å®æˆ˜æ¡ˆä¾‹</a></li>
<li><a href="#%E6%80%BB%E7%BB%93" title="#%E6%80%BB%E7%BB%93">æ€»ç»“</a></li>
</ul>
<hr/>
<h2 data-id="heading-1">ä»€ä¹ˆæ˜¯ MCPï¼Ÿ</h2>
<p>MCPï¼ˆModel Context Protocolï¼‰æ˜¯ Anthropic æ¨å‡ºçš„å¼€æ”¾åè®®ï¼Œç”¨äº AI åº”ç”¨ä¸å¤–éƒ¨å·¥å…·/æ•°æ®æºçš„æ ‡å‡†åŒ–é€šä¿¡ã€‚å®ƒè§£å†³äº†ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li><strong>å·¥å…·ç¢ç‰‡åŒ–</strong>ï¼šæ¯ä¸ª AI åº”ç”¨éƒ½è¦é‡æ–°å®ç°å·¥å…·é›†æˆ</li>
<li><strong>åè®®ä¸ç»Ÿä¸€</strong>ï¼šæ²¡æœ‰æ ‡å‡†çš„å·¥å…·è°ƒç”¨æ ¼å¼</li>
<li><strong>æ‰©å±•æ€§å·®</strong>ï¼šæ·»åŠ æ–°å·¥å…·éœ€è¦ä¿®æ”¹æ ¸å¿ƒä»£ç </li>
</ul>
<p>MCP æä¾›äº†ï¼š</p>
<ul>
<li>ğŸ“¡ <strong>æ ‡å‡†ä¼ è¾“å±‚</strong>ï¼šstdioã€SSEã€HTTP</li>
<li>ğŸ”§ <strong>å·¥å…·å‘ç°æœºåˆ¶</strong>ï¼šåŠ¨æ€è·å–å¯ç”¨å·¥å…·åˆ—è¡¨</li>
<li>ğŸ” <strong>è®¤è¯æ”¯æŒ</strong>ï¼šOAuth 2.0 é›†æˆ</li>
<li>ğŸ“Š <strong>èµ„æºç®¡ç†</strong>ï¼šç»Ÿä¸€çš„èµ„æºè¯»å–æ¥å£</li>
</ul>
<hr/>
<h2 data-id="heading-2">æ¶æ„è®¾è®¡</h2>
<p>blade-code çš„ MCP é›†æˆé‡‡ç”¨ä¸‰å±‚æ¶æ„ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[Agent Runtime è°ƒç”¨å±‚] --&gt; B[McpRegistry ç®¡ç†å±‚]
    B --&gt; C[McpClient é€šä¿¡å±‚]
    
    A1[å·¥å…·è°ƒç”¨&lt;br/&gt;å‚æ•°éªŒè¯] -.-&gt; A
    B1[æœåŠ¡å™¨æ³¨å†Œ/æ³¨é”€&lt;br/&gt;å·¥å…·å†²çªå¤„ç†&lt;br/&gt;çŠ¶æ€ç›‘æ§] -.-&gt; B
    C1[è¿æ¥ç®¡ç†&lt;br/&gt;åè®®é€šä¿¡&lt;br/&gt;é”™è¯¯é‡è¯•&lt;br/&gt;OAuth è®¤è¯] -.-&gt; C
    
    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#ffe1f5
</code></pre>
<p><strong>è®¾è®¡åŸåˆ™ï¼š</strong></p>
<ol>
<li><strong>å•ä¸€èŒè´£</strong>ï¼šæ¯å±‚åªè´Ÿè´£è‡ªå·±çš„æ ¸å¿ƒåŠŸèƒ½</li>
<li><strong>äº‹ä»¶é©±åŠ¨</strong>ï¼šé€šè¿‡ EventEmitter è§£è€¦ç»„ä»¶</li>
<li><strong>å®¹é”™ä¼˜å…ˆ</strong>ï¼šç½‘ç»œé”™è¯¯è‡ªåŠ¨é‡è¯•ï¼Œæ°¸ä¹…é”™è¯¯å¿«é€Ÿå¤±è´¥</li>
<li><strong>å¯è§‚æµ‹æ€§</strong>ï¼šå®Œæ•´çš„çŠ¶æ€æœºå’Œäº‹ä»¶æ—¥å¿—</li>
</ol>
<hr/>
<h2 data-id="heading-3">æ ¸å¿ƒå®ç°</h2>
<h3 data-id="heading-4">1. McpClientï¼šè¿æ¥ä¸é€šä¿¡</h3>
<p><code>McpClient</code> æ˜¯ MCP é›†æˆçš„æ ¸å¿ƒï¼Œè´Ÿè´£ä¸å•ä¸ª MCP æœåŠ¡å™¨çš„é€šä¿¡ã€‚</p>
<h4 data-id="heading-5">1.1 ä¼ è¾“å±‚æŠ½è±¡</h4>
<p>MCP æ”¯æŒä¸‰ç§ä¼ è¾“æ–¹å¼ï¼Œblade-code é€šè¿‡å·¥å‚æ¨¡å¼ç»Ÿä¸€åˆ›å»ºï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">createTransport</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Transport</span>&gt; {
  <span class="hljs-keyword">const</span> { <span class="hljs-keyword">type</span>, command, args, env, url, headers } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>;

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span> === <span class="hljs-string">'stdio'</span>) {
    <span class="hljs-comment">// å­è¿›ç¨‹é€šä¿¡ï¼ˆæœ¬åœ°å·¥å…·ï¼‰</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StdioClientTransport</span>({
      command,
      <span class="hljs-attr">args</span>: args || [],
      <span class="hljs-attr">env</span>: { ...process.<span class="hljs-property">env</span>, ...env },
      <span class="hljs-attr">stderr</span>: <span class="hljs-string">'ignore'</span>, <span class="hljs-comment">// å¿½ç•¥å­è¿›ç¨‹çš„ stderr è¾“å‡º</span>
    });
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span> === <span class="hljs-string">'sse'</span>) {
    <span class="hljs-comment">// Server-Sent Eventsï¼ˆè¿œç¨‹æœåŠ¡ï¼‰</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SSEClientTransport</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(url), {
      <span class="hljs-attr">requestInit</span>: { headers },
    });
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">type</span> === <span class="hljs-string">'http'</span>) {
    <span class="hljs-comment">// HTTP é•¿è½®è¯¢</span>
    <span class="hljs-keyword">const</span> { <span class="hljs-title class_">StreamableHTTPClientTransport</span> } = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(
      <span class="hljs-string">'@modelcontextprotocol/sdk/client/streamableHttp.js'</span>
    );
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StreamableHTTPClientTransport</span>(<span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(url), {
      <span class="hljs-attr">requestInit</span>: { headers },
    });
  }

  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`ä¸æ”¯æŒçš„ä¼ è¾“ç±»å‹: <span class="hljs-subst">${<span class="hljs-keyword">type</span>}</span>`</span>);
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li><code>stdio</code> é€‚åˆæœ¬åœ°å·¥å…·ï¼ˆå¦‚æ–‡ä»¶ç³»ç»Ÿã€æ•°æ®åº“ï¼‰</li>
<li><code>sse</code> é€‚åˆè¿œç¨‹æœåŠ¡ï¼ˆå®æ—¶æ¨é€ï¼‰</li>
<li><code>http</code> é€‚åˆ RESTful API</li>
</ul>
<h4 data-id="heading-6">1.2 è¿æ¥ç®¡ç†ä¸é‡è¯•</h4>
<p>ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œç½‘ç»œä¸ç¨³å®šæ˜¯å¸¸æ€ã€‚blade-code å®ç°äº†æ™ºèƒ½é‡è¯•æœºåˆ¶ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">async</span> <span class="hljs-title function_">connectWithRetry</span>(maxRetries = <span class="hljs-number">3</span>, initialDelay = <span class="hljs-number">1000</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
  <span class="hljs-keyword">let</span> <span class="hljs-attr">lastError</span>: <span class="hljs-title class_">Error</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> attempt = <span class="hljs-number">1</span>; attempt &lt;= maxRetries; attempt++) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">doConnect</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">reconnectAttempts</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// é‡ç½®é‡è¿è®¡æ•°</span>
      <span class="hljs-keyword">return</span>; <span class="hljs-comment">// æˆåŠŸè¿æ¥</span>
    } <span class="hljs-keyword">catch</span> (error) {
      lastError = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">Error</span>;
      <span class="hljs-keyword">const</span> classified = <span class="hljs-title function_">classifyError</span>(error);

      <span class="hljs-comment">// å¦‚æœæ˜¯æ°¸ä¹…æ€§é”™è¯¯ï¼Œä¸é‡è¯•</span>
      <span class="hljs-keyword">if</span> (!classified.<span class="hljs-property">isRetryable</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[McpClient] æ£€æµ‹åˆ°æ°¸ä¹…æ€§é”™è¯¯ï¼Œæ”¾å¼ƒé‡è¯•:'</span>, classified.<span class="hljs-property">type</span>);
        <span class="hljs-keyword">throw</span> error;
      }

      <span class="hljs-comment">// æŒ‡æ•°é€€é¿</span>
      <span class="hljs-keyword">if</span> (attempt &lt; maxRetries) {
        <span class="hljs-keyword">const</span> delay = initialDelay * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, attempt - <span class="hljs-number">1</span>);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`[McpClient] è¿æ¥å¤±è´¥ï¼ˆ<span class="hljs-subst">${attempt}</span>/<span class="hljs-subst">${maxRetries}</span>ï¼‰ï¼Œ<span class="hljs-subst">${delay}</span>ms åé‡è¯•...`</span>);
        <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, delay));
      }
    }
  }

  <span class="hljs-keyword">throw</span> lastError || <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è¿æ¥å¤±è´¥'</span>);
}
</code></pre>
<p><strong>é”™è¯¯åˆ†ç±»ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">ErrorType</span> {
  <span class="hljs-variable constant_">NETWORK_TEMPORARY</span> = <span class="hljs-string">'network_temporary'</span>, <span class="hljs-comment">// ä¸´æ—¶ç½‘ç»œé”™è¯¯ï¼ˆå¯é‡è¯•ï¼‰</span>
  <span class="hljs-variable constant_">NETWORK_PERMANENT</span> = <span class="hljs-string">'network_permanent'</span>, <span class="hljs-comment">// æ°¸ä¹…ç½‘ç»œé”™è¯¯</span>
  <span class="hljs-variable constant_">CONFIG_ERROR</span> = <span class="hljs-string">'config_error'</span>,           <span class="hljs-comment">// é…ç½®é”™è¯¯</span>
  <span class="hljs-variable constant_">AUTH_ERROR</span> = <span class="hljs-string">'auth_error'</span>,               <span class="hljs-comment">// è®¤è¯é”™è¯¯</span>
  <span class="hljs-variable constant_">PROTOCOL_ERROR</span> = <span class="hljs-string">'protocol_error'</span>,       <span class="hljs-comment">// åè®®é”™è¯¯</span>
  <span class="hljs-variable constant_">UNKNOWN</span> = <span class="hljs-string">'unknown'</span>,                     <span class="hljs-comment">// æœªçŸ¥é”™è¯¯</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">classifyError</span>(<span class="hljs-params">error: <span class="hljs-built_in">unknown</span></span>): <span class="hljs-title class_">ClassifiedError</span> {
  <span class="hljs-keyword">const</span> msg = error.<span class="hljs-property">message</span>.<span class="hljs-title function_">toLowerCase</span>();

  <span class="hljs-comment">// æ°¸ä¹…æ€§é…ç½®é”™è¯¯ï¼ˆä¸åº”é‡è¯•ï¼‰</span>
  <span class="hljs-keyword">const</span> permanentErrors = [
    <span class="hljs-string">'command not found'</span>,
    <span class="hljs-string">'no such file'</span>,
    <span class="hljs-string">'permission denied'</span>,
    <span class="hljs-string">'invalid configuration'</span>,
  ];

  <span class="hljs-keyword">if</span> (permanentErrors.<span class="hljs-title function_">some</span>(<span class="hljs-function">(<span class="hljs-params">permanent</span>) =&gt;</span> msg.<span class="hljs-title function_">includes</span>(permanent))) {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">type</span>: <span class="hljs-title class_">ErrorType</span>.<span class="hljs-property">CONFIG_ERROR</span>, <span class="hljs-attr">isRetryable</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">originalError</span>: error };
  }

  <span class="hljs-comment">// ä¸´æ—¶ç½‘ç»œé”™è¯¯ï¼ˆå¯é‡è¯•ï¼‰</span>
  <span class="hljs-keyword">const</span> temporaryErrors = [
    <span class="hljs-string">'timeout'</span>,
    <span class="hljs-string">'connection refused'</span>,
    <span class="hljs-string">'econnreset'</span>,
    <span class="hljs-string">'etimedout'</span>,
    <span class="hljs-string">'503'</span>,
    <span class="hljs-string">'429'</span>,
  ];

  <span class="hljs-keyword">if</span> (temporaryErrors.<span class="hljs-title function_">some</span>(<span class="hljs-function">(<span class="hljs-params">temporary</span>) =&gt;</span> msg.<span class="hljs-title function_">includes</span>(temporary))) {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">type</span>: <span class="hljs-title class_">ErrorType</span>.<span class="hljs-property">NETWORK_TEMPORARY</span>, <span class="hljs-attr">isRetryable</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">originalError</span>: error };
  }

  <span class="hljs-comment">// é»˜è®¤è§†ä¸ºä¸´æ—¶é”™è¯¯ï¼ˆä¿å®ˆç­–ç•¥ï¼šå…è®¸é‡è¯•ï¼‰</span>
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">type</span>: <span class="hljs-title class_">ErrorType</span>.<span class="hljs-property">UNKNOWN</span>, <span class="hljs-attr">isRetryable</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">originalError</span>: error };
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ</strong></p>
<ul>
<li><strong>å¿«é€Ÿå¤±è´¥</strong>ï¼šé…ç½®é”™è¯¯ç«‹å³æŠ›å‡ºï¼Œé¿å…æ— æ„ä¹‰çš„é‡è¯•</li>
<li><strong>æŒ‡æ•°é€€é¿</strong>ï¼šé¿å…é›ªå´©æ•ˆåº”ï¼Œç»™æœåŠ¡å™¨æ¢å¤æ—¶é—´</li>
<li><strong>ä¿å®ˆç­–ç•¥</strong>ï¼šæœªçŸ¥é”™è¯¯é»˜è®¤å¯é‡è¯•ï¼Œæé«˜å®¹é”™æ€§</li>
</ul>
<h4 data-id="heading-7">1.3 æ„å¤–æ–­è¿å¤„ç†</h4>
<p>MCP æœåŠ¡å™¨å¯èƒ½éšæ—¶æ–­å¼€ï¼ˆè¿›ç¨‹å´©æºƒã€ç½‘ç»œä¸­æ–­ï¼‰ï¼Œblade-code é€šè¿‡ç›‘å¬ <code>onclose</code> äº‹ä»¶è‡ªåŠ¨é‡è¿ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-variable language_">this</span>.<span class="hljs-property">sdkClient</span>.<span class="hljs-property">onclose</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleUnexpectedClose</span>();
};

<span class="hljs-keyword">private</span> <span class="hljs-title function_">handleUnexpectedClose</span>(): <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isManualDisconnect</span>) {
    <span class="hljs-keyword">return</span>; <span class="hljs-comment">// æ‰‹åŠ¨æ–­å¼€ï¼Œä¸é‡è¿</span>
  }

  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> === <span class="hljs-title class_">McpConnectionStatus</span>.<span class="hljs-property">CONNECTED</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'[McpClient] æ£€æµ‹åˆ°æ„å¤–æ–­è¿ï¼Œå‡†å¤‡é‡è¿...'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setStatus</span>(<span class="hljs-title class_">McpConnectionStatus</span>.<span class="hljs-property">ERROR</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'error'</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'MCPæœåŠ¡å™¨è¿æ¥æ„å¤–å…³é—­'</span>));
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">scheduleReconnect</span>();
  }
}

<span class="hljs-keyword">private</span> <span class="hljs-title function_">scheduleReconnect</span>(): <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">reconnectAttempts</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">MAX_RECONNECT_ATTEMPTS</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[McpClient] è¾¾åˆ°æœ€å¤§é‡è¿æ¬¡æ•°ï¼Œæ”¾å¼ƒé‡è¿'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'reconnectFailed'</span>);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// æŒ‡æ•°é€€é¿ï¼š1s, 2s, 4s, 8s, 16sï¼ˆæœ€å¤§30sï¼‰</span>
  <span class="hljs-keyword">const</span> delay = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(<span class="hljs-number">1000</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">reconnectAttempts</span>), <span class="hljs-number">30000</span>);
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">reconnectAttempts</span>++;

  <span class="hljs-variable language_">this</span>.<span class="hljs-property">reconnectTimer</span> = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">doConnect</span>();
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[McpClient] é‡è¿æˆåŠŸ'</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">reconnectAttempts</span> = <span class="hljs-number">0</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'reconnected'</span>);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-keyword">const</span> classified = <span class="hljs-title function_">classifyError</span>(error);
      <span class="hljs-keyword">if</span> (classified.<span class="hljs-property">isRetryable</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">scheduleReconnect</span>(); <span class="hljs-comment">// ç»§ç»­é‡è¿</span>
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'reconnectFailed'</span>); <span class="hljs-comment">// æ°¸ä¹…å¤±è´¥</span>
      }
    }
  }, delay);
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>åŒºåˆ†æ‰‹åŠ¨æ–­å¼€å’Œæ„å¤–æ–­è¿</li>
<li>æœ€å¤šé‡è¿ 5 æ¬¡ï¼Œé¿å…æ— é™å¾ªç¯</li>
<li>é‡è¿æˆåŠŸåé‡ç½®è®¡æ•°å™¨</li>
</ul>
<hr/>
<h3 data-id="heading-8">2. McpRegistryï¼šæœåŠ¡å™¨ç®¡ç†</h3>
<p><code>McpRegistry</code> æ˜¯å•ä¾‹æ¨¡å¼çš„æ³¨å†Œä¸­å¿ƒï¼Œç®¡ç†å¤šä¸ª MCP æœåŠ¡å™¨ã€‚</p>
<h4 data-id="heading-9">2.1 æœåŠ¡å™¨æ³¨å†Œ</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">async</span> <span class="hljs-title function_">registerServer</span>(<span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">config</span>: <span class="hljs-title class_">McpServerConfig</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">servers</span>.<span class="hljs-title function_">has</span>(name)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`MCPæœåŠ¡å™¨ "<span class="hljs-subst">${name}</span>" å·²ç»æ³¨å†Œ`</span>);
  }

  <span class="hljs-keyword">const</span> client = <span class="hljs-keyword">new</span> <span class="hljs-title class_">McpClient</span>(config, name, config.<span class="hljs-property">healthCheck</span>);
  <span class="hljs-keyword">const</span> <span class="hljs-attr">serverInfo</span>: <span class="hljs-title class_">McpServerInfo</span> = {
    config,
    client,
    <span class="hljs-attr">status</span>: <span class="hljs-title class_">McpConnectionStatus</span>.<span class="hljs-property">DISCONNECTED</span>,
    <span class="hljs-attr">tools</span>: [],
  };

  <span class="hljs-comment">// è®¾ç½®å®¢æˆ·ç«¯äº‹ä»¶å¤„ç†å™¨</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupClientEventHandlers</span>(client, serverInfo, name);

  <span class="hljs-variable language_">this</span>.<span class="hljs-property">servers</span>.<span class="hljs-title function_">set</span>(name, serverInfo);
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'serverRegistered'</span>, name, serverInfo);

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">connectServer</span>(name);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`MCPæœåŠ¡å™¨ "<span class="hljs-subst">${name}</span>" è¿æ¥å¤±è´¥:`</span>, error);
  }
}
</code></pre>
<h4 data-id="heading-10">2.2 å·¥å…·å†²çªå¤„ç†</h4>
<p>å¤šä¸ª MCP æœåŠ¡å™¨å¯èƒ½æä¾›åŒåå·¥å…·ï¼Œblade-code é€šè¿‡å‰ç¼€è§£å†³å†²çªï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">async</span> <span class="hljs-title function_">getAvailableTools</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Tool</span>[]&gt; {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">tools</span>: <span class="hljs-title class_">Tool</span>[] = [];
  <span class="hljs-keyword">const</span> nameConflicts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>&gt;();

  <span class="hljs-comment">// ç¬¬ä¸€éï¼šæ£€æµ‹å†²çª</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [_serverName, serverInfo] <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">servers</span>) {
    <span class="hljs-keyword">if</span> (serverInfo.<span class="hljs-property">status</span> === <span class="hljs-title class_">McpConnectionStatus</span>.<span class="hljs-property">CONNECTED</span>) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> mcpTool <span class="hljs-keyword">of</span> serverInfo.<span class="hljs-property">tools</span>) {
        <span class="hljs-keyword">const</span> count = nameConflicts.<span class="hljs-title function_">get</span>(mcpTool.<span class="hljs-property">name</span>) || <span class="hljs-number">0</span>;
        nameConflicts.<span class="hljs-title function_">set</span>(mcpTool.<span class="hljs-property">name</span>, count + <span class="hljs-number">1</span>);
      }
    }
  }

  <span class="hljs-comment">// ç¬¬äºŒéï¼šåˆ›å»ºå·¥å…·ï¼ˆå†²çªæ—¶æ·»åŠ å‰ç¼€ï¼‰</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [serverName, serverInfo] <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">servers</span>) {
    <span class="hljs-keyword">if</span> (serverInfo.<span class="hljs-property">status</span> === <span class="hljs-title class_">McpConnectionStatus</span>.<span class="hljs-property">CONNECTED</span>) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> mcpTool <span class="hljs-keyword">of</span> serverInfo.<span class="hljs-property">tools</span>) {
        <span class="hljs-keyword">const</span> hasConflict = (nameConflicts.<span class="hljs-title function_">get</span>(mcpTool.<span class="hljs-property">name</span>) || <span class="hljs-number">0</span>) &gt; <span class="hljs-number">1</span>;
        <span class="hljs-keyword">const</span> toolName = hasConflict
          ? <span class="hljs-string">`<span class="hljs-subst">${serverName}</span>__<span class="hljs-subst">${mcpTool.name}</span>`</span>
          : mcpTool.<span class="hljs-property">name</span>;

        <span class="hljs-keyword">const</span> tool = <span class="hljs-title function_">createMcpTool</span>(serverInfo.<span class="hljs-property">client</span>, serverName, mcpTool, toolName);
        tools.<span class="hljs-title function_">push</span>(tool);
      }
    }
  }

  <span class="hljs-keyword">return</span> tools;
}
</code></pre>
<p><strong>å‘½åç­–ç•¥ï¼š</strong></p>
<ul>
<li>æ— å†²çªï¼š<code>toolName</code></li>
<li>æœ‰å†²çªï¼š<code>serverName__toolName</code></li>
</ul>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">æœåŠ¡å™¨</span> <span class="hljs-attr">A:</span> <span class="hljs-string">read_file</span>
<span class="hljs-string">æœåŠ¡å™¨</span> <span class="hljs-attr">B:</span> <span class="hljs-string">read_file</span>
<span class="hljs-string">â†’</span> <span class="hljs-string">æœ€ç»ˆå·¥å…·:</span> <span class="hljs-string">A__read_file,</span> <span class="hljs-string">B__read_file</span>
</code></pre>
<hr/>
<h3 data-id="heading-11">3. OAuth è®¤è¯</h3>
<p>MCP æ”¯æŒ OAuth 2.0 è®¤è¯ï¼Œblade-code å®ç°äº†å®Œæ•´çš„ OAuth æµç¨‹ã€‚</p>
<h4 data-id="heading-12">3.1 ä»¤ç‰Œå­˜å‚¨</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OAuthTokenStorage</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-attr">tokenFilePath</span>: <span class="hljs-built_in">string</span>;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> homeDir = os.<span class="hljs-title function_">homedir</span>();
    <span class="hljs-keyword">const</span> configDir = path.<span class="hljs-title function_">join</span>(homeDir, <span class="hljs-string">'.blade'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tokenFilePath</span> = path.<span class="hljs-title function_">join</span>(configDir, <span class="hljs-string">'mcp-oauth-tokens.json'</span>);
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">saveToken</span>(
    <span class="hljs-attr">serverName</span>: <span class="hljs-built_in">string</span>,
    <span class="hljs-attr">token</span>: <span class="hljs-title class_">OAuthToken</span>,
    clientId?: <span class="hljs-built_in">string</span>,
    tokenUrl?: <span class="hljs-built_in">string</span>
  ): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">const</span> credentials = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadAllCredentials</span>();

    <span class="hljs-keyword">const</span> <span class="hljs-attr">credential</span>: <span class="hljs-title class_">OAuthCredentials</span> = {
      serverName,
      token,
      clientId,
      tokenUrl,
      <span class="hljs-attr">updatedAt</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
    };

    credentials.<span class="hljs-title function_">set</span>(serverName, credential);
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">saveAllCredentials</span>(credentials);
  }

  <span class="hljs-title function_">isTokenExpired</span>(<span class="hljs-attr">token</span>: <span class="hljs-title class_">OAuthToken</span>): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">if</span> (!token.<span class="hljs-property">expiresAt</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// æ²¡æœ‰è¿‡æœŸæ—¶é—´ï¼Œè®¤ä¸ºä¸è¿‡æœŸ</span>
    }

    <span class="hljs-comment">// æå‰ 5 åˆ†é’Ÿè§†ä¸ºè¿‡æœŸï¼Œç•™å‡ºåˆ·æ–°æ—¶é—´</span>
    <span class="hljs-keyword">const</span> buffer = <span class="hljs-number">5</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() &gt;= token.<span class="hljs-property">expiresAt</span> - buffer;
  }
}
</code></pre>
<p><strong>å®‰å…¨æªæ–½ï¼š</strong></p>
<ul>
<li>ä»¤ç‰Œæ–‡ä»¶æƒé™è®¾ç½®ä¸º <code>0o600</code>ï¼ˆä»…æ‰€æœ‰è€…å¯è¯»å†™ï¼‰</li>
<li>æå‰ 5 åˆ†é’Ÿåˆ·æ–°ä»¤ç‰Œï¼Œé¿å…è¿‡æœŸ</li>
<li>æ”¯æŒ refresh_token è‡ªåŠ¨ç»­æœŸ</li>
</ul>
<h4 data-id="heading-13">3.2 OAuth æµç¨‹</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OAuthProvider</span> {
  <span class="hljs-keyword">private</span> tokenStorage = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OAuthTokenStorage</span>();

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">getValidToken</span>(
    <span class="hljs-attr">serverName</span>: <span class="hljs-built_in">string</span>,
    <span class="hljs-attr">oauthConfig</span>: <span class="hljs-title class_">OAuthConfig</span>
  ): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>&gt; {
    <span class="hljs-keyword">const</span> credentials = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">tokenStorage</span>.<span class="hljs-title function_">getCredentials</span>(serverName);

    <span class="hljs-keyword">if</span> (!credentials) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// æ²¡æœ‰ä»¤ç‰Œï¼Œéœ€è¦è®¤è¯</span>
    }

    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦è¿‡æœŸ</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">tokenStorage</span>.<span class="hljs-title function_">isTokenExpired</span>(credentials.<span class="hljs-property">token</span>)) {
      <span class="hljs-comment">// å°è¯•åˆ·æ–°</span>
      <span class="hljs-keyword">if</span> (credentials.<span class="hljs-property">token</span>.<span class="hljs-property">refreshToken</span>) {
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">const</span> newToken = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">refreshToken</span>(credentials, oauthConfig);
          <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">tokenStorage</span>.<span class="hljs-title function_">saveToken</span>(
            serverName,
            newToken,
            credentials.<span class="hljs-property">clientId</span>,
            credentials.<span class="hljs-property">tokenUrl</span>
          );
          <span class="hljs-keyword">return</span> newToken.<span class="hljs-property">accessToken</span>;
        } <span class="hljs-keyword">catch</span> (error) {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[OAuthProvider] åˆ·æ–°ä»¤ç‰Œå¤±è´¥:'</span>, error);
          <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// åˆ·æ–°å¤±è´¥ï¼Œéœ€è¦é‡æ–°è®¤è¯</span>
        }
      }
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// æ²¡æœ‰ refresh_tokenï¼Œéœ€è¦é‡æ–°è®¤è¯</span>
    }

    <span class="hljs-keyword">return</span> credentials.<span class="hljs-property">token</span>.<span class="hljs-property">accessToken</span>;
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">authenticate</span>(
    <span class="hljs-attr">serverName</span>: <span class="hljs-built_in">string</span>,
    <span class="hljs-attr">oauthConfig</span>: <span class="hljs-title class_">OAuthConfig</span>
  ): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">OAuthToken</span>&gt; {
    <span class="hljs-comment">// 1. ç”Ÿæˆæˆæƒ URL</span>
    <span class="hljs-keyword">const</span> authUrl = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">buildAuthUrl</span>(oauthConfig);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`è¯·è®¿é—®ä»¥ä¸‹ URL è¿›è¡Œæˆæƒ:\n<span class="hljs-subst">${authUrl}</span>`</span>);

    <span class="hljs-comment">// 2. å¯åŠ¨æœ¬åœ°å›è°ƒæœåŠ¡å™¨</span>
    <span class="hljs-keyword">const</span> code = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">startCallbackServer</span>(oauthConfig.<span class="hljs-property">redirectUri</span>);

    <span class="hljs-comment">// 3. ç”¨æˆæƒç æ¢å–ä»¤ç‰Œ</span>
    <span class="hljs-keyword">const</span> token = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">exchangeCodeForToken</span>(code, oauthConfig);

    <span class="hljs-comment">// 4. ä¿å­˜ä»¤ç‰Œ</span>
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">tokenStorage</span>.<span class="hljs-title function_">saveToken</span>(
      serverName,
      token,
      oauthConfig.<span class="hljs-property">clientId</span>,
      oauthConfig.<span class="hljs-property">tokenUrl</span>
    );

    <span class="hljs-keyword">return</span> token;
  }
}
</code></pre>
<p><strong>æµç¨‹å›¾ï¼š</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[ç”¨æˆ·è¯·æ±‚] --&gt; B{æ£€æŸ¥ä»¤ç‰Œ}
    B --&gt;|æœ‰æ•ˆ| C[è¿”å›ä»¤ç‰Œ]
    B --&gt;|æ— æ•ˆ/è¿‡æœŸ| D{æœ‰ refresh_token?}
    D --&gt;|æ˜¯| E[åˆ·æ–°ä»¤ç‰Œ]
    E --&gt; F[è¿”å›æ–°ä»¤ç‰Œ]
    D --&gt;|å¦| G[å¯åŠ¨ OAuth æµç¨‹]
    G --&gt; H[è¿”å›æ–°ä»¤ç‰Œ]
    
    style C fill:#90EE90
    style F fill:#90EE90
    style H fill:#90EE90
</code></pre>
<hr/>
<h3 data-id="heading-14">4. å¥åº·ç›‘æ§</h3>
<p>ç”Ÿäº§ç¯å¢ƒä¸­ï¼ŒMCP æœåŠ¡å™¨å¯èƒ½"åƒµæ­»"ï¼ˆè¿æ¥æ­£å¸¸ä½†ä¸å“åº”ï¼‰ã€‚blade-code å®ç°äº†ä¸»åŠ¨å¥åº·æ£€æŸ¥ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HealthMonitor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EventEmitter</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">intervalTimer</span>: <span class="hljs-title class_">NodeJS</span>.<span class="hljs-property">Timeout</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> consecutiveFailures = <span class="hljs-number">0</span>;

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">
    <span class="hljs-keyword">private</span> client: McpClient,
    <span class="hljs-keyword">private</span> config: HealthCheckConfig
  </span>) {
    <span class="hljs-variable language_">super</span>();
  }

  <span class="hljs-title function_">start</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">intervalTimer</span>) {
      <span class="hljs-keyword">return</span>; <span class="hljs-comment">// å·²ç»å¯åŠ¨</span>
    }

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">intervalTimer</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">performHealthCheck</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">consecutiveFailures</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// é‡ç½®å¤±è´¥è®¡æ•°</span>
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">consecutiveFailures</span>++;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(
          <span class="hljs-string">`[HealthMonitor] å¥åº·æ£€æŸ¥å¤±è´¥ (<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.consecutiveFailures}</span>/<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.config.maxFailures}</span>):`</span>,
          error
        );

        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">consecutiveFailures</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">maxFailures</span>) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'unhealthy'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">consecutiveFailures</span>, error);
          <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">attemptReconnect</span>();
        }
      }
    }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">intervalMs</span>);
  }

  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">performHealthCheck</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">const</span> timeout = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">timeoutMs</span> || <span class="hljs-number">5000</span>;

    <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">race</span>([
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">client</span>.<span class="hljs-title function_">listTools</span>(), <span class="hljs-comment">// è°ƒç”¨ä¸€ä¸ªè½»é‡çº§æ–¹æ³•</span>
      <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">_, reject</span>) =&gt;</span>
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'å¥åº·æ£€æŸ¥è¶…æ—¶'</span>)), timeout)
      ),
    ]);
  }

  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">attemptReconnect</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[HealthMonitor] å°è¯•é‡è¿...'</span>);
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">client</span>.<span class="hljs-title function_">disconnect</span>();
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">client</span>.<span class="hljs-title function_">connect</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">consecutiveFailures</span> = <span class="hljs-number">0</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'reconnected'</span>);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[HealthMonitor] é‡è¿å¤±è´¥:'</span>, error);
    }
  }
}
</code></pre>
<p><strong>é…ç½®ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-typescript" lang="typescript">{
  <span class="hljs-attr">enabled</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">intervalMs</span>: <span class="hljs-number">30000</span>,    <span class="hljs-comment">// æ¯ 30 ç§’æ£€æŸ¥ä¸€æ¬¡</span>
  <span class="hljs-attr">timeoutMs</span>: <span class="hljs-number">5000</span>,      <span class="hljs-comment">// è¶…æ—¶æ—¶é—´ 5 ç§’</span>
  <span class="hljs-attr">maxFailures</span>: <span class="hljs-number">3</span>        <span class="hljs-comment">// è¿ç»­å¤±è´¥ 3 æ¬¡è§¦å‘é‡è¿</span>
}
</code></pre>
<hr/>
<h2 data-id="heading-15">å·¥å…·åŠ¨æ€æ³¨å†Œ</h2>
<p>MCP å·¥å…·éœ€è¦è½¬æ¢ä¸º blade-code çš„ <code>Tool</code> æ¥å£ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createMcpTool</span>(<span class="hljs-params">
  client: McpClient,
  serverName: <span class="hljs-built_in">string</span>,
  mcpTool: McpToolDefinition,
  toolName?: <span class="hljs-built_in">string</span>
</span>): <span class="hljs-title class_">Tool</span> {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">name</span>: toolName || mcpTool.<span class="hljs-property">name</span>,
    <span class="hljs-attr">description</span>: mcpTool.<span class="hljs-property">description</span> || <span class="hljs-string">`MCPå·¥å…·: <span class="hljs-subst">${mcpTool.name}</span>`</span>,
    <span class="hljs-attr">parameters</span>: mcpTool.<span class="hljs-property">inputSchema</span> || { <span class="hljs-attr">type</span>: <span class="hljs-string">'object'</span>, <span class="hljs-attr">properties</span>: {} },
    <span class="hljs-attr">metadata</span>: {
      <span class="hljs-attr">source</span>: <span class="hljs-string">'mcp'</span>,
      serverName,
      <span class="hljs-attr">originalName</span>: mcpTool.<span class="hljs-property">name</span>,
    },

    <span class="hljs-keyword">async</span> <span class="hljs-title function_">execute</span>(<span class="hljs-attr">args</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">unknown</span>&gt;): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ToolResult</span>&gt; {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">callTool</span>(mcpTool.<span class="hljs-property">name</span>, args);

        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">output</span>: <span class="hljs-title function_">formatMcpResponse</span>(response),
          <span class="hljs-attr">metadata</span>: {
            serverName,
            <span class="hljs-attr">toolName</span>: mcpTool.<span class="hljs-property">name</span>,
          },
        };
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">error</span>: error <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Error</span> ? error.<span class="hljs-property">message</span> : <span class="hljs-title class_">String</span>(error),
          <span class="hljs-attr">metadata</span>: {
            serverName,
            <span class="hljs-attr">toolName</span>: mcpTool.<span class="hljs-property">name</span>,
          },
        };
      }
    },
  };
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>ä¿ç•™åŸå§‹å·¥å…·åï¼ˆ<code>originalName</code>ï¼‰ç”¨äºè°ƒè¯•</li>
<li>ç»Ÿä¸€é”™è¯¯å¤„ç†æ ¼å¼</li>
<li>æ”¯æŒå…ƒæ•°æ®ä¼ é€’</li>
</ul>
<hr/>
<h2 data-id="heading-16">é”™è¯¯å¤„ç†ä¸é‡è¿</h2>
<p>blade-code çš„é”™è¯¯å¤„ç†éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š</p>
<h3 data-id="heading-17">1. é”™è¯¯åˆ†ç±»</h3>
<pre><code class="hljs language-typescript" lang="typescript">ä¸´æ—¶é”™è¯¯ï¼ˆå¯é‡è¯•ï¼‰ï¼š
- ç½‘ç»œè¶…æ—¶
- è¿æ¥è¢«æ‹’ç»
- é€Ÿç‡é™åˆ¶ï¼ˆ<span class="hljs-number">429</span>ï¼‰
- æœåŠ¡ä¸å¯ç”¨ï¼ˆ<span class="hljs-number">503</span>ï¼‰

æ°¸ä¹…é”™è¯¯ï¼ˆä¸é‡è¯•ï¼‰ï¼š
- é…ç½®é”™è¯¯ï¼ˆå‘½ä»¤ä¸å­˜åœ¨ï¼‰
- è®¤è¯å¤±è´¥ï¼ˆ<span class="hljs-number">401</span>ï¼‰
- æƒé™ä¸è¶³ï¼ˆ<span class="hljs-number">403</span>ï¼‰
- åè®®é”™è¯¯ï¼ˆæ ¼å¼é”™è¯¯ï¼‰
</code></pre>
<h3 data-id="heading-18">2. é‡è¯•ç­–ç•¥</h3>
<pre><code class="hljs language-typescript" lang="typescript">æŒ‡æ•°é€€é¿ï¼š
- ç¬¬ <span class="hljs-number">1</span> æ¬¡ï¼š<span class="hljs-number">1</span> ç§’åé‡è¯•
- ç¬¬ <span class="hljs-number">2</span> æ¬¡ï¼š<span class="hljs-number">2</span> ç§’åé‡è¯•
- ç¬¬ <span class="hljs-number">3</span> æ¬¡ï¼š<span class="hljs-number">4</span> ç§’åé‡è¯•
- ç¬¬ <span class="hljs-number">4</span> æ¬¡ï¼š<span class="hljs-number">8</span> ç§’åé‡è¯•
- ç¬¬ <span class="hljs-number">5</span> æ¬¡ï¼š<span class="hljs-number">16</span> ç§’åé‡è¯•
- æœ€å¤§å»¶è¿Ÿï¼š<span class="hljs-number">30</span> ç§’
</code></pre>
<h3 data-id="heading-19">3. çŠ¶æ€æœº</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">stateDiagram-v2
    [*] --&gt; DISCONNECTED
    DISCONNECTED --&gt; CONNECTING: connect()
    CONNECTING --&gt; CONNECTED: æˆåŠŸ
    CONNECTING --&gt; ERROR: å¤±è´¥
    ERROR --&gt; CONNECTING: é‡è¯•
    CONNECTED --&gt; ERROR: æ„å¤–æ–­è¿
    CONNECTED --&gt; DISCONNECTED: disconnect()
</code></pre>
<hr/>
<h2 data-id="heading-20">å®æˆ˜æ¡ˆä¾‹</h2>
<h3 data-id="heading-21">æ¡ˆä¾‹ 1ï¼šé›†æˆæ–‡ä»¶ç³»ç»Ÿ MCP æœåŠ¡å™¨</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// é…ç½®æ–‡ä»¶</span>
{
  <span class="hljs-string">"mcpServers"</span>: {
    <span class="hljs-string">"filesystem"</span>: {
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"stdio"</span>,
      <span class="hljs-string">"command"</span>: <span class="hljs-string">"npx"</span>,
      <span class="hljs-string">"args"</span>: [<span class="hljs-string">"-y"</span>, <span class="hljs-string">"@modelcontextprotocol/server-filesystem"</span>, <span class="hljs-string">"/path/to/workspace"</span>],
      <span class="hljs-string">"env"</span>: {
        <span class="hljs-string">"NODE_ENV"</span>: <span class="hljs-string">"production"</span>
      }
    }
  }
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> registry = <span class="hljs-title class_">McpRegistry</span>.<span class="hljs-title function_">getInstance</span>();
<span class="hljs-keyword">await</span> registry.<span class="hljs-title function_">registerServer</span>(<span class="hljs-string">'filesystem'</span>, config.<span class="hljs-property">mcpServers</span>.<span class="hljs-property">filesystem</span>);

<span class="hljs-keyword">const</span> tools = <span class="hljs-keyword">await</span> registry.<span class="hljs-title function_">getAvailableTools</span>();
<span class="hljs-comment">// è¾“å‡º: [{ name: 'read_file', ... }, { name: 'write_file', ... }]</span>
</code></pre>
<h3 data-id="heading-22">æ¡ˆä¾‹ 2ï¼šé›†æˆè¿œç¨‹ APIï¼ˆå¸¦ OAuthï¼‰</h3>
<pre><code class="hljs language-typescript" lang="typescript">{
  <span class="hljs-string">"mcpServers"</span>: {
    <span class="hljs-string">"github"</span>: {
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"sse"</span>,
      <span class="hljs-string">"url"</span>: <span class="hljs-string">"https://api.github.com/mcp"</span>,
      <span class="hljs-string">"oauth"</span>: {
        <span class="hljs-string">"enabled"</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">"authUrl"</span>: <span class="hljs-string">"https://github.com/login/oauth/authorize"</span>,
        <span class="hljs-string">"tokenUrl"</span>: <span class="hljs-string">"https://github.com/login/oauth/access_token"</span>,
        <span class="hljs-string">"clientId"</span>: <span class="hljs-string">"your-client-id"</span>,
        <span class="hljs-string">"clientSecret"</span>: <span class="hljs-string">"your-client-secret"</span>,
        <span class="hljs-string">"scopes"</span>: [<span class="hljs-string">"repo"</span>, <span class="hljs-string">"user"</span>],
        <span class="hljs-string">"redirectUri"</span>: <span class="hljs-string">"http://localhost:3000/callback"</span>
      }
    }
  }
}

<span class="hljs-comment">// é¦–æ¬¡ä½¿ç”¨ä¼šè‡ªåŠ¨è§¦å‘ OAuth æµç¨‹</span>
<span class="hljs-keyword">await</span> registry.<span class="hljs-title function_">registerServer</span>(<span class="hljs-string">'github'</span>, config.<span class="hljs-property">mcpServers</span>.<span class="hljs-property">github</span>);
<span class="hljs-comment">// è¾“å‡º: è¯·è®¿é—®ä»¥ä¸‹ URL è¿›è¡Œæˆæƒ: https://github.com/login/oauth/authorize?...</span>
</code></pre>
<h3 data-id="heading-23">æ¡ˆä¾‹ 3ï¼šå¥åº·ç›‘æ§ä¸è‡ªåŠ¨æ¢å¤</h3>
<pre><code class="hljs language-typescript" lang="typescript">{
  <span class="hljs-string">"mcpServers"</span>: {
    <span class="hljs-string">"database"</span>: {
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"stdio"</span>,
      <span class="hljs-string">"command"</span>: <span class="hljs-string">"mcp-database-server"</span>,
      <span class="hljs-string">"healthCheck"</span>: {
        <span class="hljs-string">"enabled"</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">"intervalMs"</span>: <span class="hljs-number">30000</span>,
        <span class="hljs-string">"timeoutMs"</span>: <span class="hljs-number">5000</span>,
        <span class="hljs-string">"maxFailures"</span>: <span class="hljs-number">3</span>
      }
    }
  }
}

<span class="hljs-comment">// ç›‘å¬å¥åº·äº‹ä»¶</span>
registry.<span class="hljs-title function_">on</span>(<span class="hljs-string">'serverError'</span>, <span class="hljs-function">(<span class="hljs-params">name, error</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`æœåŠ¡å™¨ <span class="hljs-subst">${name}</span> å‡ºé”™:`</span>, error);
});

registry.<span class="hljs-title function_">on</span>(<span class="hljs-string">'healthMonitorReconnected'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¥åº·ç›‘æ§è§¦å‘é‡è¿æˆåŠŸ'</span>);
});
</code></pre>
<hr/>
<h2 data-id="heading-24">æ€»ç»“</h2>
<p>blade-code çš„ MCP é›†æˆå®ç°äº†ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š</p>
<h3 data-id="heading-25">å·²å®ç°</h3>
<ol>
<li><strong>å¤šä¼ è¾“å±‚æ”¯æŒ</strong>ï¼šstdioã€SSEã€HTTP</li>
<li><strong>æ™ºèƒ½é‡è¯•</strong>ï¼šé”™è¯¯åˆ†ç±» + æŒ‡æ•°é€€é¿</li>
<li><strong>è‡ªåŠ¨é‡è¿</strong>ï¼šæ„å¤–æ–­è¿è‡ªåŠ¨æ¢å¤</li>
<li><strong>OAuth è®¤è¯</strong>ï¼šå®Œæ•´çš„ OAuth 2.0 æµç¨‹</li>
<li><strong>å¥åº·ç›‘æ§</strong>ï¼šä¸»åŠ¨æ£€æµ‹åƒµæ­»è¿æ¥</li>
<li><strong>å·¥å…·å†²çªå¤„ç†</strong>ï¼šè‡ªåŠ¨æ·»åŠ å‰ç¼€</li>
<li><strong>äº‹ä»¶é©±åŠ¨</strong>ï¼šå®Œæ•´çš„çŠ¶æ€æœºå’Œäº‹ä»¶ç³»ç»Ÿ</li>
</ol>
<h3 data-id="heading-26">è®¾è®¡äº®ç‚¹</h3>
<ul>
<li><strong>å®¹é”™ä¼˜å…ˆ</strong>ï¼šç½‘ç»œé”™è¯¯ä¸ä¼šå¯¼è‡´æ•´ä¸ªç³»ç»Ÿå´©æºƒ</li>
<li><strong>å¯è§‚æµ‹æ€§</strong>ï¼šä¸°å¯Œçš„æ—¥å¿—å’Œäº‹ä»¶ï¼Œä¾¿äºè°ƒè¯•</li>
<li><strong>æ‰©å±•æ€§</strong>ï¼šæ–°å¢ MCP æœåŠ¡å™¨åªéœ€ä¿®æ”¹é…ç½®æ–‡ä»¶</li>
<li><strong>å®‰å…¨æ€§</strong>ï¼šä»¤ç‰ŒåŠ å¯†å­˜å‚¨ï¼Œæƒé™æœ€å°åŒ–</li>
</ul>
<hr/>
<p><strong>ç›¸å…³èµ„æºï¼š</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FechoVic%2Fblade-code" target="_blank" title="https://github.com/echoVic/blade-code" ref="nofollow noopener noreferrer">blade-code GitHub</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelcontextprotocol.io" target="_blank" title="https://modelcontextprotocol.io" ref="nofollow noopener noreferrer">MCP å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fechovic.com" target="_blank" title="https://echovic.com" ref="nofollow noopener noreferrer">ä½œè€…åšå®¢</a></li>
</ul>
<p><strong>è®¨è®º</strong>ï¼šæ¬¢è¿åœ¨ GitHub Issues æˆ–æˆ‘çš„åšå®¢è¯„è®ºåŒºäº¤æµï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Telephony ä¸­çš„ WakeLock ä½¿ç”¨å…¨é¢åˆ†æ]]></title>    <link>https://juejin.cn/post/7603595309233160202</link>    <guid>https://juejin.cn/post/7603595309233160202</guid>    <pubDate>2026-02-07T09:32:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603595309233160202" data-draft-id="7603627478020653066" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Telephony ä¸­çš„ WakeLock ä½¿ç”¨å…¨é¢åˆ†æ"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-02-07T09:32:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·341408199125"/> <meta itemprop="url" content="https://juejin.cn/user/570004686782272"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Telephony ä¸­çš„ WakeLock ä½¿ç”¨å…¨é¢åˆ†æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/570004686782272/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·341408199125
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T09:32:33.000Z" title="Sat Feb 07 2026 09:32:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ä¸€ã€WakeLock çš„ç±»å‹å’Œé…ç½®</h3>
<p><strong>RIL ä¸­çš„ WakeLock</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// RIL.java å®šä¹‰çš„ä¸¤ç§ç±»å‹</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">FOR_WAKELOCK</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;        <span class="hljs-comment">// RIL å‘½ä»¤æ‰§è¡Œ</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">FOR_ACK_WAKELOCK</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;    <span class="hljs-comment">// ACK åº”ç­”å‘é€</span>

<span class="hljs-comment">// åˆå§‹åŒ–é…ç½®</span>
<span class="hljs-type">PowerManager</span> <span class="hljs-variable">pm</span> <span class="hljs-operator">=</span> (PowerManager)context.getSystemService(Context.POWER_SERVICE);

<span class="hljs-comment">// FOR_WAKELOCKï¼šRIL è¯·æ±‚/å“åº”æœŸé—´æŒæœ‰</span>
mWakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, RILJ_WAKELOCK_TAG);
mWakeLock.setReferenceCounted(<span class="hljs-literal">false</span>);  <span class="hljs-comment">// ä¸æ”¯æŒåµŒå¥—è®¡æ•°</span>

<span class="hljs-comment">// FOR_ACK_WAKELOCKï¼šACK å‘é€æœŸé—´æŒæœ‰</span>
mAckWakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, RILJ_ACK_WAKELOCK_NAME);
mAckWakeLock.setReferenceCounted(<span class="hljs-literal">false</span>);

<span class="hljs-comment">// è¶…æ—¶æ—¶é—´é…ç½®</span>
mWakeLockTimeout = TelephonyProperties.wake_lock_timeout()
        .orElse(DEFAULT_WAKE_LOCK_TIMEOUT_MS);  <span class="hljs-comment">// é»˜è®¤ 25s</span>
mAckWakeLockTimeout = TelephonyProperties.wake_lock_timeout()
        .orElse(DEFAULT_ACK_WAKE_LOCK_TIMEOUT_MS);  <span class="hljs-comment">// é»˜è®¤ 200ms</span>

<span class="hljs-comment">// WakeLock è®¡æ•°å™¨</span>
<span class="hljs-type">int</span> <span class="hljs-variable">mWakeLockCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;  <span class="hljs-comment">// æ”¯æŒå¤šä¸ªå¹¶å‘è¯·æ±‚</span>
<span class="hljs-type">int</span> <span class="hljs-variable">mWlSequenceNum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;   <span class="hljs-comment">// åºåˆ—å·ç”¨äºè¶…æ—¶æ£€æŸ¥</span>
<span class="hljs-type">int</span> <span class="hljs-variable">mAckWlSequenceNum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
</code></pre>
<hr/>
<h3 data-id="heading-1">äºŒã€RIL WakeLock çš„ç”Ÿå‘½å‘¨æœŸ</h3>
<p><strong>æµç¨‹ 1ï¼šæ­£å¸¸çš„ RIL è¯·æ±‚æµç¨‹</strong></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-number">1</span>. åˆ›å»º RIL è¯·æ±‚
   â†“
RILRequest rr = <span class="hljs-built_in">obtainRequest</span>(RIL_REQUEST_SIGNAL_STRENGTH, result, workSource);
   â†“
<span class="hljs-number">2</span>. <span class="hljs-built_in">addRequest</span>() ä¸­è‡ªåŠ¨è·å– WakeLock
   â†“
<span class="hljs-built_in">acquireWakeLock</span>(rr, FOR_WAKELOCK);
   â†“
   synchronized (mWakeLock) {
       mWakeLock<span class="hljs-selector-class">.acquire</span>();              <span class="hljs-comment">// â† å®é™…è·å–</span>
       mWakeLockCount++;                 <span class="hljs-comment">// è®¡æ•°å¢åŠ </span>
       mWlSequenceNum++;                 <span class="hljs-comment">// åºåˆ—å·å¢åŠ </span>
       
       <span class="hljs-comment">// å…³é”®ï¼šè®¾ç½® WorkSource ç”¨äº BatteryStats è¿½è¸ª</span>
       String clientId = rr<span class="hljs-selector-class">.getWorkSourceClientId</span>();
       if (!mClientWakelockTracker.isClientActive(clientId)) {
           mActiveWakelockWorkSource<span class="hljs-selector-class">.add</span>(rr.mWorkSource);
           mWakeLock<span class="hljs-selector-class">.setWorkSource</span>(mActiveWakelockWorkSource);
       }
       
       <span class="hljs-comment">// å…³é”®ï¼šè®°å½•è¿½è¸ªä¿¡æ¯</span>
       mClientWakelockTracker<span class="hljs-selector-class">.startTracking</span>(rr.mClientId,
               rr.mRequest, rr.mSerial, mWakeLockCount);
       
       <span class="hljs-comment">// å…³é”®ï¼šè®¾ç½®è¶…æ—¶ä¿æŠ¤ï¼ˆ25sï¼‰</span>
       Message msg = mRilHandler<span class="hljs-selector-class">.obtainMessage</span>(EVENT_WAKE_LOCK_TIMEOUT);
       msg<span class="hljs-selector-class">.arg1</span> = mWlSequenceNum;
       mRilHandler<span class="hljs-selector-class">.sendMessageDelayed</span>(msg, mWakeLockTimeout);
   }
   â†“
<span class="hljs-number">3</span>. å‘é€è¯·æ±‚ç»™ Modem
   â†“
<span class="hljs-built_in">radioServiceInvokeHelper</span>(HAL_SERVICE_NETWORK, rr, "getSignalStrength", () -&gt; {
    networkProxy<span class="hljs-selector-class">.getSignalStrength</span>(rr.mSerial);
});
   â†“
<span class="hljs-number">4</span>. æ”¶åˆ° Modem å“åº”
   â†“
<span class="hljs-built_in">onSignalStrengthResponse</span>(RadioResponseInfo responseInfo, SignalStrength signalStrength)
   â†“
<span class="hljs-number">5</span>. <span class="hljs-built_in">decrementWakeLock</span>() é‡Šæ”¾
   â†“
<span class="hljs-built_in">decrementWakeLock</span>(rr);
   â†“
   synchronized (mWakeLock) {
       mClientWakelockTracker<span class="hljs-selector-class">.stopTracking</span>(rr.mClientId,
               rr.mRequest, rr.mSerial,
               (mWakeLockCount &gt; <span class="hljs-number">1</span>) ? mWakeLockCount - <span class="hljs-number">1</span> : <span class="hljs-number">0</span>);
       
       String clientId = rr<span class="hljs-selector-class">.getWorkSourceClientId</span>();
       if (!mClientWakelockTracker.isClientActive(clientId)) {
           <span class="hljs-comment">// è¯¥å®¢æˆ·ç«¯çš„æ‰€æœ‰è¯·æ±‚éƒ½å®Œæˆï¼Œç§»é™¤ WorkSource</span>
           mActiveWakelockWorkSource<span class="hljs-selector-class">.remove</span>(rr.mWorkSource);
           mWakeLock<span class="hljs-selector-class">.setWorkSource</span>(mActiveWakelockWorkSource);
       }
       
       if (mWakeLockCount &gt; <span class="hljs-number">1</span>) {
           mWakeLockCount--;  <span class="hljs-comment">// åªå‡è®¡æ•°ï¼Œä¸é‡Šæ”¾</span>
       } else {
           mWakeLockCount = <span class="hljs-number">0</span>;
           mWakeLock<span class="hljs-selector-class">.release</span>();  <span class="hljs-comment">// â† æœ€åä¸€ä¸ªè¯·æ±‚å®Œæˆæ—¶é‡Šæ”¾</span>
       }
   }
   â†“
<span class="hljs-number">6</span>. rr<span class="hljs-selector-class">.release</span>() æ¸…ç†è¯·æ±‚
</code></pre>
<p><strong>æµç¨‹ 2ï¼šè¶…æ—¶å¤„ç†</strong></p>
<pre><code class="hljs language-scss" lang="scss">EVENT_WAKE_LOCK_TIMEOUT è§¦å‘
   â†“
if (msg.arg1 == mWlSequenceNum &amp;&amp; clearWakeLock(FOR_WAKELOCK)) {
    if (mRadioBugDetector != null) {
        mRadioBugDetector<span class="hljs-selector-class">.processWakelockTimeout</span>();  <span class="hljs-comment">// ä¸ŠæŠ¥å¼‚å¸¸</span>
    }
    
    if (RILJ_LOGD) {
        int count = mRequestList<span class="hljs-selector-class">.size</span>();
        <span class="hljs-built_in">riljLog</span>("WAKE_LOCK_TIMEOUT mRequestList=" + count);
        for (int i = <span class="hljs-number">0</span>; i &lt; count; i++) {
            rr = mRequestList<span class="hljs-selector-class">.valueAt</span>(i);
            <span class="hljs-built_in">riljLog</span>(i + ": [" + rr.mSerial + "] "
                    + RILUtils.requestToString(rr.mRequest));
        }
    }
}
   â†“
<span class="hljs-built_in">clearWakeLock</span>(FOR_WAKELOCK)  <span class="hljs-comment">// å¼ºåˆ¶é‡Šæ”¾</span>
   â†“
synchronized (mWakeLock) {
    if (mWakeLockCount == <span class="hljs-number">0</span> &amp;&amp; !mWakeLock.isHeld()) return false;
    
    <span class="hljs-built_in">riljLog</span>("NOTE: mWakeLockCount is " + mWakeLockCount 
            + " at time of clearing");
    
    mWakeLockCount = <span class="hljs-number">0</span>;
    mWakeLock<span class="hljs-selector-class">.release</span>();  <span class="hljs-comment">// å¼ºåˆ¶é‡Šæ”¾</span>
    mClientWakelockTracker<span class="hljs-selector-class">.stopTrackingAll</span>();  <span class="hljs-comment">// æ¸…ç©ºæ‰€æœ‰è¿½è¸ª</span>
    mActiveWakelockWorkSource = new <span class="hljs-built_in">WorkSource</span>();
    return true;
}
</code></pre>
<hr/>
<h3 data-id="heading-2">ä¸‰ã€è®¡æ•°æœºåˆ¶è¯¦è§£</h3>
<p><strong>å¤šä¸ªå¹¶å‘ RIL è¯·æ±‚</strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">æ—¶åˆ» <span class="hljs-number">1</span>ï¼šRequest <span class="hljs-selector-tag">A</span>ï¼ˆgetSignalStrengthï¼‰
   mWakeLockCount = <span class="hljs-number">0</span>
   <span class="hljs-built_in">acquireWakeLock</span>(A) â†’ mWakeLock<span class="hljs-selector-class">.acquire</span>()
   mWakeLockCount = <span class="hljs-number">1</span>
   
æ—¶åˆ» <span class="hljs-number">2</span>ï¼šRequest <span class="hljs-selector-tag">B</span>ï¼ˆgetDataCallListï¼‰åˆ°è¾¾ï¼Œ<span class="hljs-selector-tag">A</span> è¿˜æœªå®Œæˆ
   <span class="hljs-built_in">acquireWakeLock</span>(B) â†’ mWakeLock å·²æŒæœ‰ï¼Œä¸å† <span class="hljs-built_in">acquire</span>()
   mWakeLockCount = <span class="hljs-number">2</span>
   
æ—¶åˆ» <span class="hljs-number">3</span>ï¼šRequest Cï¼ˆqueryNetworkSelectionModeï¼‰åˆ°è¾¾
   <span class="hljs-built_in">acquireWakeLock</span>(C)
   mWakeLockCount = <span class="hljs-number">3</span>
   
æ—¶åˆ» <span class="hljs-number">4</span>ï¼šRequest <span class="hljs-selector-tag">A</span> å®Œæˆ
   <span class="hljs-built_in">decrementWakeLock</span>(A)
   mWakeLockCount = <span class="hljs-number">3</span> - <span class="hljs-number">1</span> = <span class="hljs-number">2</span>
   <span class="hljs-comment">// ä¸è°ƒç”¨ mWakeLock.release()ï¼Œå› ä¸ºè¿˜æœ‰å…¶ä»–è¯·æ±‚</span>
   
æ—¶åˆ» <span class="hljs-number">5</span>ï¼šRequest <span class="hljs-selector-tag">B</span> å®Œæˆ
   <span class="hljs-built_in">decrementWakeLock</span>(B)
   mWakeLockCount = <span class="hljs-number">2</span> - <span class="hljs-number">1</span> = <span class="hljs-number">1</span>
   <span class="hljs-comment">// ä»ä¸é‡Šæ”¾</span>
   
æ—¶åˆ» <span class="hljs-number">6</span>ï¼šRequest C å®Œæˆ
   <span class="hljs-built_in">decrementWakeLock</span>(C)
   mWakeLockCount = <span class="hljs-number">1</span> - <span class="hljs-number">1</span> = <span class="hljs-number">0</span>
   mWakeLock<span class="hljs-selector-class">.release</span>()  <span class="hljs-comment">// â† æœ€åä¸€ä¸ªå®Œæˆæ—¶é‡Šæ”¾</span>
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>åªåœ¨æ‰€æœ‰ RIL è¯·æ±‚éƒ½å®Œæˆåæ‰é‡Šæ”¾ WakeLock</li>
<li>CPU æŒç»­æ´»è·ƒï¼Œé¿å…é¢‘ç¹å”¤é†’</li>
<li>å‡å°‘ç”µæ± æ¶ˆè€—</li>
</ul>
<hr/>
<h3 data-id="heading-3">å››ã€WorkSource å’Œ BatteryStats è¿½è¸ª</h3>
<p><strong>æ ¸å¿ƒæœºåˆ¶</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ¯ä¸ª RIL è¯·æ±‚éƒ½å…³è”ä¸€ä¸ª WorkSourceï¼ˆè¡¨ç¤ºå“ªä¸ªåº”ç”¨è§¦å‘çš„ï¼‰</span>
<span class="hljs-type">String</span> <span class="hljs-variable">clientId</span> <span class="hljs-operator">=</span> rr.getWorkSourceClientId();

<span class="hljs-comment">// å¦‚æœè¯¥å®¢æˆ·ç«¯æ˜¯ç¬¬ä¸€æ¬¡ï¼Œæ·»åŠ å…¶ WorkSource</span>
<span class="hljs-keyword">if</span> (!mClientWakelockTracker.isClientActive(clientId)) {
    mActiveWakelockWorkSource.add(rr.mWorkSource);
    mWakeLock.setWorkSource(mActiveWakelockWorkSource);
}

<span class="hljs-comment">// ç¤ºä¾‹ï¼š</span>
App A è°ƒç”¨ TelephonyManager.getSignalStrength()
   â†“ WorkSource = <span class="hljs-string">"App A"</span>
   â†“ setWorkSource(<span class="hljs-string">"App A"</span>)
   â†“ BatteryStats è®°å½•ï¼šApp A å¯¼è‡´ CPU å”¤é†’

App B è°ƒç”¨ TelephonyManager.getDataCallList()
   â†“ åŒæ—¶åˆ°è¾¾ï¼ˆApp A è¿˜æœªå®Œæˆï¼‰
   â†“ WorkSource = <span class="hljs-string">"App A, App B"</span>
   â†“ setWorkSource(<span class="hljs-string">"App A, App B"</span>)
   â†“ BatteryStats è®°å½•ï¼šApp A å’Œ App B å…±åŒå¯¼è‡´ CPU å”¤é†’
</code></pre>
<p><strong>BatteryStats æœ€ç»ˆæ˜¾ç¤º</strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">Settings â†’ Battery
  â€¢ App <span class="hljs-selector-tag">A</span>ï¼š<span class="hljs-number">5%</span> (åŒ…æ‹¬ RIL å”¤é†’æ¶ˆè€—)
  â€¢ App <span class="hljs-selector-tag">B</span>ï¼š<span class="hljs-number">3%</span> (åŒ…æ‹¬ RIL å”¤é†’æ¶ˆè€—)
  â€¢ System (Telephony)ï¼š<span class="hljs-number">2%</span>
</code></pre>
<hr/>
<h3 data-id="heading-4">äº”ã€ACK WakeLock</h3>
<p><strong>ç›®çš„</strong>ï¼šç¡®ä¿å‘ Modem å‘é€ ACK å“åº”ä¸è¢«ä¸­æ–­</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å‘é€ ACK æ—¶è·å–</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendAck</span><span class="hljs-params">(<span class="hljs-type">int</span> service)</span> {
    <span class="hljs-type">RILRequest</span> <span class="hljs-variable">rr</span> <span class="hljs-operator">=</span> RILRequest.obtain(RIL_RESPONSE_ACKNOWLEDGEMENT, <span class="hljs-literal">null</span>,
            mRILDefaultWorkSource);
    acquireWakeLock(rr, FOR_ACK_WAKELOCK);
    â†“
    <span class="hljs-keyword">synchronized</span> (mAckWakeLock) {
        mAckWakeLock.acquire();  <span class="hljs-comment">// ç‹¬ç«‹çš„ WakeLock</span>
        mAckWlSequenceNum++;
        
        <span class="hljs-comment">// è¶…æ—¶ä¿æŠ¤ï¼š200msï¼ˆæ¯” FOR_WAKELOCK çš„ 25s çŸ­å¾ˆå¤šï¼‰</span>
        <span class="hljs-type">Message</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> mRilHandler.obtainMessage(EVENT_ACK_WAKE_LOCK_TIMEOUT);
        msg.arg1 = mAckWlSequenceNum;
        mRilHandler.sendMessageDelayed(msg, mAckWakeLockTimeout);
    }
}

<span class="hljs-comment">// åŒºåˆ«ï¼š</span>
<span class="hljs-comment">// FOR_WAKELOCKï¼š</span>
<span class="hljs-comment">//   â€¢ ç­‰å¾… Modem å“åº”ï¼ˆå¯èƒ½å¾ˆé•¿ï¼‰</span>
<span class="hljs-comment">//   â€¢ æ”¯æŒè®¡æ•°</span>
<span class="hljs-comment">//   â€¢ è¶…æ—¶ 25s</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// FOR_ACK_WAKELOCKï¼š</span>
<span class="hljs-comment">//   â€¢ ä»…ç”¨äºå‘é€ ACK</span>
<span class="hljs-comment">//   â€¢ ä¸è®¡æ•°ï¼ˆæ¯æ¬¡ç‹¬ç«‹ï¼‰</span>
<span class="hljs-comment">//   â€¢ è¶…æ—¶ 200ms</span>
</code></pre>
<hr/>
<h3 data-id="heading-5">å…­ã€å…¶ä»– WakeLock ä½¿ç”¨åœºæ™¯</h3>
<p><strong>åœºæ™¯ 1ï¼šçŸ­ä¿¡å¤„ç†ï¼ˆInboundSmsHandlerï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åˆå§‹åŒ–æ—¶è·å–å¹¶æŒæœ‰</span>
<span class="hljs-type">PowerManager</span> <span class="hljs-variable">pm</span> <span class="hljs-operator">=</span> (PowerManager) mContext.getSystemService(Context.POWER_SERVICE);
mWakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, name);
mWakeLock.acquire();    <span class="hljs-comment">// åˆå§‹åŒ–æ—¶è·å–</span>
mWakeLock.setReferenceCounted(<span class="hljs-literal">true</span>);  <span class="hljs-comment">// æ”¯æŒåµŒå¥—</span>

<span class="hljs-comment">// è¿›å…¥ WaitingState æ—¶çš„è¶…æ—¶</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WaitingState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">State</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">enter</span><span class="hljs-params">()</span> {
        mWakeLock.acquire();  <span class="hljs-comment">// è‹¥æœªè·å–ï¼Œåˆ™è·å–</span>
        
        <span class="hljs-comment">// 10 åˆ†é’Ÿè¶…æ—¶ä¿æŠ¤</span>
        sendMessageDelayed(obtainMessage(EVENT_RECEIVER_TIMEOUT),
                          SMS_WAKELOCK_TIMEOUT_MS);  <span class="hljs-comment">// 600,000ms</span>
    }
}

<span class="hljs-comment">// æµç¨‹ï¼š</span>
æ”¶åˆ°çŸ­ä¿¡
   â†“ è·å– WakeLockï¼ˆæˆ–å¢åŠ è®¡æ•°ï¼‰
   â†“ è¿›å…¥ WaitingState
   â†“ å¹¿æ’­ SMS_RECEIVED intent
   â†“ åº”ç”¨å¤„ç†çŸ­ä¿¡ï¼ˆå¯èƒ½å¾ˆæ…¢ï¼‰
   â†“ åº”ç”¨è°ƒç”¨ setResultCode(RESULT_OK)
   â†“ è¿›å…¥ä¸‹ä¸€çŠ¶æ€
   â†“ é‡Šæ”¾ WakeLockï¼ˆæˆ–å‡å°‘è®¡æ•°ï¼‰
   
è¶…æ—¶ï¼ˆ<span class="hljs-number">10</span> åˆ†é’Ÿï¼‰ï¼š
   â†“ EVENT_RECEIVER_TIMEOUT è§¦å‘
   â†“ å¼ºåˆ¶é‡Šæ”¾ WakeLock
   â†“ ç»§ç»­å¤„ç†çŸ­ä¿¡ï¼Œä¸ä¼šæ°¸ä¹…é˜»å¡
</code></pre>
<p><strong>åœºæ™¯ 2ï¼šPost-Dial ç­‰å¾…ï¼ˆGsmCdmaConnectionï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ç”¨æˆ·æ‹¨å· *123# ç­‰å¾…ç»“æœ</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setPostDialState</span><span class="hljs-params">(PostDialState s)</span> {
    <span class="hljs-keyword">if</span> (s == PostDialState.STARTED || s == PostDialState.PAUSE) {
        <span class="hljs-keyword">synchronized</span> (mPartialWakeLock) {
            <span class="hljs-keyword">if</span> (mPartialWakeLock.isHeld()) {
                mHandler.removeMessages(EVENT_WAKE_LOCK_TIMEOUT);
            } <span class="hljs-keyword">else</span> {
                acquireWakeLock();  <span class="hljs-comment">// è·å–</span>
            }
            
            <span class="hljs-comment">// 3 åˆ†é’Ÿè¶…æ—¶</span>
            <span class="hljs-type">Message</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> mHandler.obtainMessage(EVENT_WAKE_LOCK_TIMEOUT);
            mHandler.sendMessageDelayed(msg, WAKE_LOCK_TIMEOUT_MILLIS);  <span class="hljs-comment">// 60,000ms</span>
        }
    } <span class="hljs-keyword">else</span> {
        mHandler.removeMessages(EVENT_WAKE_LOCK_TIMEOUT);
        releaseWakeLock();  <span class="hljs-comment">// é‡Šæ”¾</span>
    }
}

<span class="hljs-comment">// è¶…æ—¶ä¿æŠ¤ï¼šé˜²æ­¢ç”¨æˆ·æŒ‰é”™æŒ‰é’®ä½†ä¸ç»§ç»­ï¼Œå¯¼è‡´ WakeLock æ°¸ä¹…æŒæœ‰</span>
</code></pre>
<p><strong>åœºæ™¯ 3ï¼šIMS ç”µè¯ï¼ˆImsPhoneï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">PowerManager</span> <span class="hljs-variable">pm</span> <span class="hljs-operator">=</span> (PowerManager) context.getServicesSy <span class="hljs-title function_">stem</span><span class="hljs-params">(Context.POWER_SERVICE)</span>;
mWakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, LOG_TAG);
mWakeLock.setReferenceCounted(<span class="hljs-literal">false</span>);

<span class="hljs-comment">// ç”¨äº IMS ç›¸å…³æ“ä½œä¿æŒè®¾å¤‡å”¤é†’</span>
</code></pre>
<p><strong>åœºæ™¯ 4ï¼šç´§æ€¥é€šè¯ï¼ˆEmergencyStateTrackerï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">PowerManager</span> <span class="hljs-variable">pm</span> <span class="hljs-operator">=</span> context.getSystemService(PowerManager.class);
mWakeLock = (pm != <span class="hljs-literal">null</span>) ? pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,
        <span class="hljs-string">"telephony:"</span> + TAG) : <span class="hljs-literal">null</span>;

<span class="hljs-comment">// ç´§æ€¥é€šè¯æœŸé—´ç»´æŒ WakeLockï¼Œç¡®ä¿ä¸è¿›å…¥ç¡çœ </span>
</code></pre>
<p><strong>åœºæ™¯ 5ï¼šNITZ æ—¶é—´éªŒè¯</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å¿«é€Ÿè¯»å– elapsedRealtime æ—¶éœ€è¦ WakeLock</span>
<span class="hljs-type">WakeLock</span> <span class="hljs-variable">wakeLock</span> <span class="hljs-operator">=</span> powerManager.newWakeLock(
        PowerManager.PARTIAL_WAKE_LOCK, WAKELOCK_TAG);

<span class="hljs-keyword">try</span> {
    wakeLock.acquire();  <span class="hljs-comment">// è·å–</span>
    <span class="hljs-type">long</span> <span class="hljs-variable">elapsedRealtime</span> <span class="hljs-operator">=</span> deviceState.elapsedRealtimeMillis();
    <span class="hljs-comment">// ... éªŒè¯é€»è¾‘</span>
} <span class="hljs-keyword">finally</span> {
    wakeLock.release();  <span class="hljs-comment">// é‡Šæ”¾</span>
}
</code></pre>
<p><strong>åœºæ™¯ 6ï¼šSmsStorageMonitor</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">PowerManager</span> <span class="hljs-variable">pm</span> <span class="hljs-operator">=</span> (PowerManager)mContext.getSystemService(Context.POWER_SERVICE);
mWakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, <span class="hljs-string">"SmsStorageMonitor"</span>);
mWakeLock.setReferenceCounted(<span class="hljs-literal">true</span>);  <span class="hljs-comment">// æ”¯æŒåµŒå¥—è®¡æ•°</span>

<span class="hljs-comment">// å‘é€ SMS å­˜å‚¨çŠ¶æ€æŠ¥å‘Šæ—¶ä¿æŒå”¤é†’</span>
</code></pre>
<p><strong>åœºæ™¯ 7ï¼šå¤šå¡åˆ‡æ¢ï¼ˆProxyControllerï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">PowerManager</span> <span class="hljs-variable">pm</span> <span class="hljs-operator">=</span> (PowerManager) context.getSystemService(Context.POWER_SERVICE);
mWakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, LOG_TAG);
mWakeLock.setReferenceCounted(<span class="hljs-literal">false</span>);

<span class="hljs-comment">// è®¾ç½®æ— çº¿åŠŸèƒ½é…ç½®æ—¶ä¿æŒå”¤é†’</span>
</code></pre>
<p><strong>åœºæ™¯ 8ï¼šWakeLockStateMachine</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// çŠ¶æ€æœºåŸºç¡€ç±»çš„ WakeLock ç®¡ç†</span>
<span class="hljs-type">PowerManager</span> <span class="hljs-variable">pm</span> <span class="hljs-operator">=</span> (PowerManager) context.getSystemService(Context.POWER_SERVICE);
mWakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, debugTag);
mWakeLock.acquire();  <span class="hljs-comment">// åˆå§‹åŒ–æ—¶è·å–</span>

<span class="hljs-comment">// è¿›å…¥ IdleState æ—¶é‡Šæ”¾</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">releaseWakeLock</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (mWakeLock.isHeld()) {
        mWakeLock.release();
    }
}

<span class="hljs-comment">// ç”¨é€”ï¼šç”¨äºæ¥æ”¶å¹¿æ’­çš„æ¨¡å—ï¼ˆå¦‚ SMSï¼‰ï¼Œéœ€è¦ä» Idle çŠ¶æ€å¿«é€Ÿå”¤é†’</span>
</code></pre>
<hr/>
<h3 data-id="heading-6">ä¸ƒã€WakeLock çš„æ€§èƒ½å½±å“</h3>
<p><strong>CPU åŠŸè€—å¯¹æ¯”</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">CPU çŠ¶æ€         åŠŸè€—      è¯´æ˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ­£å¸¸è¿è¡Œ         1000 mW   å±å¹•äº®ã€åº”ç”¨æ´»è·ƒ
PARTIAL_WAKE_LOCK 20 mW   å±å¹•ç­ã€CPU æ´»è·ƒï¼ˆä»åœ¨å¤„ç†ï¼‰
å®Œå…¨ç¡çœ          5 mW     å±å¹•ç­ã€CPU ç¡çœ 

RIL WakeLock æŒæœ‰æ—¶é—´å…¸å‹å€¼ï¼š
  â€¢ getSignalStrengthï¼š100-500ms
  â€¢ setupDataCallï¼š500ms-5s
  â€¢ è¶…æ—¶é‡Šæ”¾ï¼š25sï¼ˆå¼‚å¸¸æƒ…å†µï¼‰

ç”µæ± æ¶ˆè€—ä¼°ç®—ï¼š
  â€¢ 1000 ä¸ª RIL è¯·æ±‚/å¤©ï¼Œå¹³å‡ <span class="hljs-attr">200ms</span> = <span class="hljs-number">200</span>s Ã— <span class="hljs-number">20</span>mW = <span class="hljs-number">4000</span>mWs = <span class="hljs-number">1.1</span>mAh
  â€¢ ç›¸å¯¹æ€»å®¹é‡ 4000mAhï¼š0.028% ç”µæ± æ¶ˆè€—
</code></pre>
<hr/>
<h3 data-id="heading-7">å…«ã€ç›‘æ§å’Œè°ƒè¯•</h3>
<p><strong>æ—¥å¿—ä¿¡æ¯</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// RIL.java ä¸­çš„æ—¥å¿—</span>
<span class="hljs-string">"WAKE_LOCK_TIMEOUT mRequestList="</span> + count
<span class="hljs-comment">// è¡¨ç¤ºæœ‰ count ä¸ª RIL è¯·æ±‚æœªå®Œæˆ</span>

<span class="hljs-string">"ACK_WAKE_LOCK_TIMEOUT"</span>
<span class="hljs-comment">// ACK å‘é€è¶…æ—¶ï¼ˆ200msï¼‰</span>

<span class="hljs-comment">// æ¯ä¸ªè¯·æ±‚çš„è¿½è¸ª</span>
mClientWakelockTracker.startTracking(rr.mClientId, rr.mRequest, rr.mSerial, mWakeLockCount);
<span class="hljs-comment">// è®°å½•ï¼šå“ªä¸ªå®¢æˆ·ç«¯ã€ä»€ä¹ˆè¯·æ±‚ã€åºåˆ—å·ã€å½“å‰è®¡æ•°</span>
</code></pre>
<p><strong>BatteryStats æŸ¥è¯¢</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">adb shell dumpsys battery unreachable
adb shell dumpsys power_profile

<span class="hljs-comment">// æŸ¥çœ‹ WakeLock æŒæœ‰æƒ…å†µ</span>
adb shell dumpsys power_manager | grep WakeLock
</code></pre>
<hr/>
<h3 data-id="heading-8">ä¹ã€æœ€ä½³å®è·µ</h3>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> å§‹ç»ˆä½¿ç”¨ PARTIAL<span class="hljs-emphasis">_WAKE_</span>LOCK
   â€¢ å±å¹•å¯å…³é—­ï¼ŒèŠ‚çœç”µæ± 
   â€¢ å¯¹ç”¨æˆ·æ— æ„ŸçŸ¥

<span class="hljs-bullet">2.</span> è®¾ç½®è¶…æ—¶ä¿æŠ¤
   â€¢ é˜²æ­¢æ­»é”å¯¼è‡´æ°¸ä¹…æŒæœ‰
   â€¢ Telephony ä¸­ç»Ÿä¸€ 25s è¶…æ—¶

<span class="hljs-bullet">3.</span> æ­£ç¡®ä½¿ç”¨ WorkSource
   â€¢ ç”¨äº BatteryStats è¿½è¸ª
   â€¢ å¸®åŠ©è¯Šæ–­é—®é¢˜åº”ç”¨

<span class="hljs-bullet">4.</span> é‡Šæ”¾å‰æ£€æŸ¥ isHeld()
   â€¢ é˜²æ­¢é‡å¤é‡Šæ”¾å¼‚å¸¸
   
<span class="hljs-bullet">5.</span> ä½¿ç”¨ synchronized ä¿æŠ¤
   â€¢ WakeLock éçº¿ç¨‹å®‰å…¨
   â€¢ æ‰€æœ‰è·å–/é‡Šæ”¾éƒ½è¦åŒæ­¥

<span class="hljs-bullet">6.</span> ç›‘æ§è®¡æ•°ä¸€è‡´æ€§
   â€¢ acquire() å’Œ release() è¦é…å¯¹
   â€¢ è®¡æ•°ä¸åŒ¹é…è¡¨ç¤ºæœ‰æ³„æ¼
</code></pre>
<hr/>
<h2 data-id="heading-9">æ€»ç»“</h2>















































<table><thead><tr><th>æ–¹é¢</th><th>RIL WakeLock</th><th>SMS WakeLock</th><th>Post-Dial WakeLock</th></tr></thead><tbody><tr><td><strong>è·å–æ—¶æœº</strong></td><td>RIL è¯·æ±‚å‘é€</td><td>SMS æ”¶åˆ°</td><td>æ‹¨å·åç­‰å¾…</td></tr><tr><td><strong>é‡Šæ”¾æ—¶æœº</strong></td><td>Modem å“åº”</td><td>å¹¿æ’­å¤„ç†å®Œæˆ</td><td>æ‹¨å·å®Œæˆæˆ–è¶…æ—¶</td></tr><tr><td><strong>è¶…æ—¶æ—¶é—´</strong></td><td>25s</td><td>10 åˆ†é’Ÿ</td><td>3 åˆ†é’Ÿ</td></tr><tr><td><strong>è®¡æ•°æ”¯æŒ</strong></td><td>æ˜¯ï¼ˆå¤šè¯·æ±‚å¹¶å‘ï¼‰</td><td>æ˜¯ï¼ˆé‡å…¥ï¼‰</td><td>å¦ï¼ˆå•ä¸ªè¿æ¥ï¼‰</td></tr><tr><td><strong>WorkSource è¿½è¸ª</strong></td><td>æ˜¯ï¼ˆç”¨äº BatteryStatsï¼‰</td><td>å¦</td><td>å¦</td></tr><tr><td><strong>å…³é”®ç”¨é€”</strong></td><td>é˜²æ­¢ Modem é€šä¿¡ä¸­æ–­</td><td>é˜²æ­¢çŸ­ä¿¡å¤„ç†ä¸­æ–­</td><td>é˜²æ­¢ç”¨æˆ·æ‹¨å·ä¸­æ–­</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥æµ…å‡ºLangChain4J]]></title>    <link>https://juejin.cn/post/7603653885601939506</link>    <guid>https://juejin.cn/post/7603653885601939506</guid>    <pubDate>2026-02-07T08:54:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603653885601939506" data-draft-id="7603653885601923122" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥æµ…å‡ºLangChain4J"/> <meta itemprop="keywords" content="LangChain,Java,LLM"/> <meta itemprop="datePublished" content="2026-02-07T08:54:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è›‡çš®åˆ’æ°´æ€ª"/> <meta itemprop="url" content="https://juejin.cn/user/4301752340323736"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥æµ…å‡ºLangChain4J
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4301752340323736/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è›‡çš®åˆ’æ°´æ€ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T08:54:13.000Z" title="Sat Feb 07 2026 08:54:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ·±å…¥æµ…å‡ºLangChain4J</h2>
<h3 data-id="heading-1">1.èµ°è¿›LangChain</h3>
<h4 data-id="heading-2">1.1.ä»€ä¹ˆæ˜¯LangChain4Jï¼Ÿ</h4>
<blockquote>
<p>The goal of LangChain4J is to simplify integrating LLMs into Java applications.</p>
<p>â€‹													-- ã€ŠLangChain4J Docã€‹</p>
</blockquote>
<p>LangChain4Jå°±åƒJavaçš„Springæ¡†æ¶ä¸€æ ·ï¼Œä¸ºLLMçš„æ¥å…¥æä¾›äº†ä¸€å¥—æ ‡å‡†çš„æ¥å…¥èƒ½åŠ›ã€‚LangChain4Jæ˜¯LangChainåœ¨Javaç”Ÿæ€ä¸‹çš„å…·ä½“å®ç°ï¼Œç”¨äºæ„å»ºåŸºäºLLMçš„åº”ç”¨å’ŒAgentç³»ç»Ÿã€‚</p>
<p>LangChain4Jä¸ºä¸åŒçš„LLMæä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„APIï¼Œå±è”½äº†åº•å±‚APIä¾›åº”å•†çš„å®ç°å’Œè°ƒç”¨å·®å¼‚ï¼Œå¼€å‘è€…å¯ä»¥ä½¿ç”¨LangChainæ— ç¼åˆ‡æ¢ä¸åŒçš„LLMã€‚</p>
<h3 data-id="heading-3">2.Architecture of LangChain4J</h3>
<p>LangChain4Jçš„æ¶æ„å¯ä»¥åˆ†ä¸ºä¸¤å±‚ï¼Œåˆ†åˆ«ä¸ºé«˜å±‚å’Œåº•å±‚ã€‚</p>
<p>é«˜å±‚AIæœåŠ¡å±è”½äº†åº•å±‚å®ç°çš„ç»†èŠ‚ï¼Œå¼€å‘è€…å¯ä»¥å®ç°ä¸€äº›ä¸šåŠ¡æœåŠ¡çš„APIå’ŒLLMè¿›è¡Œäº¤äº’ã€‚</p>
<p>ä½å±‚å…·æœ‰æ›´é«˜çš„è‡ªç”±åº¦ï¼Œä½ å¯ä»¥ä»»æ„å®šä¹‰ç»„ä»¶çš„å…·ä½“å®ç°ï¼Œæ§åˆ¶ç»„ä»¶çš„ç»„åˆæ–¹å¼ç­‰ç­‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/38410b31fa5441a19db46f414a0e5de7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6JuH55qu5YiS5rC05oCq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771059252&amp;x-signature=QeRuLmB275BYOqtv%2BQEeaGAc5H0%3D" alt="image-20260206114437130" loading="lazy"/></p>
<p>ä¸‹é¢ï¼Œå°±LangChain4Jçš„æ ¸å¿ƒç»„ä»¶ï¼Œä¸€ä¸€è¯¦ç»†ä»‹ç»ã€‚</p>
<h4 data-id="heading-4">2.1.Chat and Language Model</h4>
<p>ä¸€èˆ¬åœ°ï¼ŒLLMsçš„APIå¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼Œ</p>
<ul>
<li><code>LanguageModel</code>ï¼šè¾“å…¥è¾“å‡ºéƒ½ä¸º<code>String</code>ç±»å‹ï¼Œç°åœ¨ä½¿ç”¨çš„è¶Šæ¥è¶Šå°‘äº†</li>
<li><code>ChatModel</code>ï¼šåº”ç”¨å¹¿æ³›çš„ä¸€ç±»APIï¼Œæ¥æ”¶å¤šä¸ª<code>ChatMessage</code>ä½œä¸ºè¾“å…¥ï¼Œè¾“å‡ºä¸€ä¸ª<code>AiMessage</code>ï¼Œé™¤äº†æ–‡æœ¬ç±»å‹ä¹‹å¤–ï¼Œè¿˜æ”¯æŒå›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰å…¶ä»–æ¨¡å¼ã€‚</li>
</ul>
<p><code>ChatModel</code>æ˜¯LangChain4Jçš„ä½å±‚APIï¼Œæä¾›å¼ºå¤§çš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ã€‚</p>
<p>æ ¹æ®æ¶ˆæ¯æ¥æºè¿›è¡Œåˆ†ç±»ï¼ŒLangChain4Jæ”¯æŒä»¥ä¸‹äº”ç§æ¶ˆæ¯ç±»å‹ï¼š</p>



































<table><thead><tr><th>æ¶ˆæ¯ç±»å‹</th><th>æè¿°</th><th>ä¸»è¦æ–¹æ³•</th></tr></thead><tbody><tr><td>UserMessage</td><td>ç”¨æˆ·è¾“å…¥çš„æ¶ˆæ¯æ•°æ®</td><td>content(), name(), attributes()</td></tr><tr><td>AiMessage</td><td>AIæ ¹æ®è¾“å…¥æ•°æ®ç”Ÿæˆçš„æ¶ˆæ¯</td><td>text(), thinking(), toolExceptionRequests(), attributes()</td></tr><tr><td>ToolExecutionResultMessage</td><td>å·¥å…·æ‰§è¡Œç»“æœæ¶ˆæ¯</td><td/></tr><tr><td>SystemMessage</td><td>ç³»ç»Ÿå‘é€çš„æ¶ˆæ¯ï¼Œå¯ä»¥ç”±å¼€å‘è€…è‡ªå®šä¹‰</td><td/></tr><tr><td>CustomMessage</td><td>è‡ªå®šä¹‰æ¶ˆæ¯</td><td/></tr></tbody></table>
<h4 data-id="heading-5">2.2.Chat Memory</h4>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œå¤§æ¨¡å‹æ˜¯æ— çŠ¶æ€çš„ï¼Œæ¨¡å‹æœ¬èº«å¹¶ä¸ä¼šè®°å½•å¯¹è¯ä¸Šä¸‹æ–‡ã€‚å› æ­¤ï¼Œå¦‚æœä½ æƒ³è¦åœ¨å¯¹è¯ä¸­ä½¿ç”¨ä¸Šä¸‹æ–‡çš„å†…å®¹ï¼Œå°±å¿…é¡»ä¸»åŠ¨ç»´æŠ¤ç®¡ç†<code>ChatMessage</code>ã€‚ä½†æ˜¯æ‰‹åŠ¨ç»´æŠ¤æ¯”è¾ƒéº»çƒ¦ï¼Œè€ŒLangChain4Jæä¾›äº†<code>ChatMemory</code>ç”¨æ¥ç»´æŠ¤ç®¡ç†chatMessage.</p>
<h5 data-id="heading-6">2.2.1.History VS Memory</h5>
<p>å†å²è®°å½•å’Œè®°å¿†å¬èµ·æ¥ä¼¼ä¹æ˜¯åŒä¸€ç§ä¸œè¥¿ï¼Œä½†æ˜¯å¯¹äºLLM Agentæ¥è¯´ï¼Œhistoryå’Œmemoryå…·æœ‰ä¸¤ç§æˆªç„¶ä¸åŒçš„è¯­ä¹‰ï¼š</p>
<ul>
<li><code>history</code>ä¿ç•™äº†ç”¨æˆ·å’ŒAIçš„æ‰€æœ‰ä¼šè¯è®°å½•ï¼Œç”¨æˆ·å¯ä»¥åœ¨ç•Œé¢ä¸­çœ‹åˆ°</li>
<li><code>memory</code>è®°å½•çš„æ˜¯ä¸“é—¨å‘ˆç°ç»™å¤§æ¨¡å‹ä½¿ç”¨çš„ä¿¡æ¯ï¼Œä½¿å…¶è¡¨ç°å¾—å¥½åƒæ˜¯â€œè®°ä½äº†â€å¯¹è¯çš„å†…å®¹ï¼Œå®é™…åº•å±‚å®ç°æ˜¯æˆªç„¶ä¸åŒçš„ç®—æ³•ã€‚</li>
</ul>
<p>LangChain4Jç›®å‰åªæä¾›<strong>Memroy</strong>ï¼Œè€Œä¸æä¾›<strong>History</strong>ã€‚</p>
<p>ä¸‹é¢ä»‹ç»å…³äºMemoryçš„å‡ ç‚¹é«˜çº§ç‰¹æ€§ã€‚</p>
<h5 data-id="heading-7">2.2.2.Eviction Policy æ·˜æ±°ç­–ç•¥</h5>
<p><strong>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ·˜æ±°ç­–ç•¥ï¼Ÿ</strong></p>
<ul>
<li><strong>å­˜å‚¨ç©ºé—´å—é™</strong>ï¼šMemoryç»„ä»¶å¯ä»¥ç†è§£ä¸ºç¼“å­˜ï¼Œå½“å­˜æ”¾çš„å†…å®¹è¶…è¿‡å®¹é‡å¤§å°çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨ä¸€å®šçš„ç­–ç•¥æ·˜æ±°ä¸€äº›è®°å¿†ï¼›</li>
<li><strong>Tokenæˆæœ¬æ˜‚è´µ</strong>ï¼šæ›´å¤šçš„ä¸Šä¸‹æ–‡è®°å¿†å°±ä»£è¡¨ä½¿ç”¨æ›´å¤šçš„Tokenï¼Œè€Œtokençš„å¢åŠ ä¼šå¢åŠ æ¯æ¬¡è°ƒç”¨LLMçš„æˆæœ¬ï¼›</li>
<li><strong>æ§åˆ¶å»¶è¿Ÿ</strong>ï¼šå‘é€çš„LLMçš„tokenè¶Šå¤šï¼Œå¤„ç†ä»–ä»¬æ‰€éœ€è¦çš„æ—¶é•¿è¶Šé•¿ï¼Œåˆ™ç”¨æˆ·ç­‰å¾…è¾“å‡ºçš„æ—¶é—´è¶Šé•¿</li>
</ul>
<p>LangChain4Jç›®å‰æ”¯æŒä¸¤ç§å¼€ç®±å³ç”¨çš„è®°å¿†æ·˜æ±°ç­–ç•¥ï¼š</p>
<ol>
<li>åŸºäºæ¶ˆæ¯æ»‘åŠ¨çª—å£ï¼šä½¿ç”¨<code>MessageWindowChatMemory</code>ä½œä¸ºæ»‘åŠ¨çª—å£ï¼Œä»…ä¿ç•™æœ€è¿‘çš„Næ¡ä¿¡æ¯ï¼Œæ·˜æ±°çª—å£ä¹‹å¤–çš„æ—§æ¶ˆæ¯ï¼›</li>
<li>åŸºäºtokençš„æ»‘åŠ¨çª—å£ï¼š<code>TokenWindowChatMemory</code>åªä¿ç•™æœ€è¿‘çš„Nä¸ªtokenã€‚ä½†æ˜¯æ¶ˆæ¯æ˜¯ä¸å¯å†åˆ†çš„ï¼Œå› æ­¤å¦‚æœæ¶ˆæ¯ä¸åˆé€‚çš„è¯ï¼Œæ•´æ¡æ¶ˆæ¯ä¼šç›´æ¥è¢«ä¸¢å¼ƒã€‚</li>
</ol>
<h5 data-id="heading-8">2.2.3.Persistence æŒä¹…åŒ–</h5>
<p>é»˜è®¤æƒ…å†µä¸‹Memoryæ˜¯å­˜æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œå¦‚æœéœ€è¦ä¿ç•™æ¶ˆæ¯ï¼Œå¯ä»¥è‡ªå®šä¹‰å®ç°<code>MessageStore</code>ï¼Œå°†<code>chatMessage</code>å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">PersistentChatMemroyStore</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ChatMemoryStore</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> List&lt;ChatMessage&gt; <span class="hljs-title function_">getMessages</span><span class="hljs-params">(Object memoryId)</span> {

    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateMessages</span><span class="hljs-params">(Object memoryId, List&lt;ChatMessage&gt; messages)</span> {

    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteMessages</span><span class="hljs-params">(Object memoryId)</span> {
      <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Implement deleting all messages in the persistent store by memory ID.</span>
    }
}
</code></pre>
<h5 data-id="heading-9">2.2.4.SystemMessage</h5>
<p>SystemMessageæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ¶ˆæ¯ï¼Œå…·æœ‰å¦‚ä¸‹çš„ç‰¹æ€§ï¼š</p>
<ul>
<li>ä¸€æ—¦æ·»åŠ ï¼Œå°±ä¼šä¸€ç›´è¢«ä¿ç•™ï¼Œä¸ä¼šè¢«æ·˜æ±°ç­–ç•¥æ·˜æ±°</li>
<li>ä¸€æ¬¡åªèƒ½æŒæœ‰ä¸€ä¸ª<code>SystemMessage</code></li>
<li><code>SystemMessage</code>å…·æœ‰å”¯ä¸€æ€§ï¼Œé‡å¤çš„SystemMessageä¼šè¢«å¿½ç•¥ï¼Œå¦‚æœä¸ä¸€è‡´ï¼Œåˆ™ä¼šè¦†ç›–æ‰ä¹‹å‰çš„<code>SystemMessage</code></li>
</ul>
<h5 data-id="heading-10">2.2.5.Tool æ¶ˆæ¯é…å¯¹</h5>
<p>AIMessage ä¸­çš„ <code>ToolExecutionRequest</code> å’Œ <code>ToolExecutionResponse</code> æ€»æ˜¯æˆå¯¹å‡ºç°çš„ã€‚å¦‚æœ <code>ToolExecutionRequest</code> è¢«æ·˜æ±°äº†ï¼Œåˆ™å…¶å¯¹åº”çš„ <code>ToolExecutionResponse</code> æ¶ˆæ¯ä¹Ÿä¼šè¢«è‡ªåŠ¨æ·˜æ±°ã€‚</p>
<h4 data-id="heading-11">2.3.Tools(Function Calling)</h4>
<p>å·¥å…·(Tools)å…è®¸LLMåœ¨å¿…è¦çš„æ—¶å€™è°ƒç”¨å¼€å‘è€…å®šä¹‰çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªå¯ç”¨å·¥å…·ï¼Œå·¥å…·æ˜¯ä¸€ä¸ªæ³›ç§°ï¼Œå¯ä»¥è¡¨ç¤ºä»»ä½•ä¸œè¥¿ï¼Œä¾‹å¦‚ç½‘é¡µæœç´¢ã€å¤–éƒ¨APIã€æˆ–è€…æ‰§è¡Œç‰¹å®šçš„ä»£ç ç­‰ç­‰ã€‚</p>
<p>å®é™…ä¸ŠLLMå¹¶ä¸ä¼šå»ä¸»åŠ¨è°ƒç”¨å·¥å…·ï¼Œè€Œæ˜¯é€šè¿‡å¼€å‘äººå‘˜åœ¨ä¸šåŠ¡å±‚æ¥æ”¶LLMçš„å›å¤ï¼Œæ ¹æ®LLMçš„æ„æ„¿è¿›è¡Œå·¥å…·çš„è°ƒç”¨å¹¶å°†æ‰§è¡Œç»“æœåé¦ˆç»™LLMã€‚</p>
<p>ä¸€ä¸ªè‰¯å¥½çš„å·¥å…·åº”å½“å…·æœ‰ä»¥ä¸‹å‡ ä¸ªå±æ€§ï¼š</p>
<ol>
<li>æ¸…æ™°æ˜ç¡®çš„å·¥å…·åç§°</li>
<li>å·¥å…·çš„å…·ä½“æè¿°ï¼Œä»¥åŠåº”è¯¥ä½•æ—¶ä½¿ç”¨å·¥å…·ï¼›</li>
<li>æ¯ä¸ªå·¥å…·çš„å…·ä½“å‚æ•°ï¼›</li>
</ol>
<blockquote>
<p>å¦‚æœè¿™ä¸ªå·¥å…·å¯¹äºäººæ¥è¯´ä¸€çœ¼å°±èƒ½ç†è§£åº”è¯¥å¦‚ä½•ä½¿ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå·¥å…·å¯¹äºLLMä¹Ÿæ˜¯æ˜“äºä½¿ç”¨çš„ã€‚</p>
</blockquote>
<p>Toolsçš„å®šä¹‰å’Œä½¿ç”¨å¯ä»¥å‚è€ƒæ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.langchain4j.dev%2Ftutorials%2Ftools" target="_blank" title="https://docs.langchain4j.dev/tutorials/tools" ref="nofollow noopener noreferrer">LangChain4J Documents</a></p>
<h4 data-id="heading-12">2.4.Agent</h4>
<h3 data-id="heading-13">3.å®æˆ˜</h3>
<h4 data-id="heading-14">3.1.ChatModel</h4>
<h5 data-id="heading-15">3.1.1.åŸºæœ¬èŠå¤©</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
    <span class="hljs-comment">// 1.åˆ›å»º chatModel</span>
    <span class="hljs-type">OpenAiChatModel</span> <span class="hljs-variable">chatModel</span> <span class="hljs-operator">=</span> OpenAiChatModel.builder()
            .apiKey(System.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>))
            .baseUrl(System.getenv(<span class="hljs-string">"OPENAI_BASE_URL"</span>))
            .modelName(System.getenv(<span class="hljs-string">"OPENAI_MODEL"</span>))
            .build();

    <span class="hljs-comment">// 2.ä½¿ç”¨ chat æ–¹æ³•å‘èµ·å¯¹è¯</span>
    <span class="hljs-type">ChatResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> chatModel.chat(ChatRequest.builder()
            .messages(UserMessage.from(<span class="hljs-string">"Hello, could you introduce yourself ?"</span>))
            .build());


    <span class="hljs-comment">// 3.æ§åˆ¶å°æ‰“å°</span>
    System.out.println(response.aiMessage().text());
}
</code></pre>
<h5 data-id="heading-16">3.1.2.å¤šè½®å¯¹è¯</h5>
<p>å¤šè½®å¯¹è¯å’ŒåŸºæœ¬å¯¹è¯çš„å®ç°æ–¹å¼ç›¸åŒï¼Œåªä¸è¿‡æ„å»ºå¯¹è¯è¯·æ±‚çš„æ—¶å€™ï¼Œéœ€è¦å°†å‰æ–‡ä¼ å…¥åˆ°<code>messages</code>ä¸­ï¼ŒLLMä¼šå‚è€ƒ<code>message</code>å¾—å‡ºåˆç†çš„å“åº”ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">chatWithMultipleMessages</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// 1.æ„å»º User å’ŒAI çš„å¤šè½®å¯¹è¯</span>
    <span class="hljs-type">UserMessage</span> <span class="hljs-variable">firstUserMessage</span> <span class="hljs-operator">=</span> UserMessage.from(<span class="hljs-string">"Hello, My name is shepi, could you introduce yourself ?"</span>);
    <span class="hljs-type">AiMessage</span> <span class="hljs-variable">firstAiMessage</span> <span class="hljs-operator">=</span> CHAT_MODEL.chat(
            ChatRequest.builder()
                    .messages(firstUserMessage)
                    .build())
            .aiMessage();
    <span class="hljs-type">UserMessage</span> <span class="hljs-variable">secondUserMessage</span> <span class="hljs-operator">=</span> UserMessage.from(<span class="hljs-string">"Please tell me my name"</span>);
    <span class="hljs-type">AiMessage</span> <span class="hljs-variable">secondAiMessage</span> <span class="hljs-operator">=</span> CHAT_MODEL.chat(
            ChatRequest.builder()
                    .messages(firstUserMessage, firstAiMessage, secondUserMessage)
                    .build()).aiMessage();

    <span class="hljs-comment">// 2.æ§åˆ¶å°æ‰“å°</span>
    System.out.println(secondAiMessage.text());
}
</code></pre>
<h4 data-id="heading-17">3.2.ChatMemory</h4>
<p><code>ChatMemory</code>å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç»´æŠ¤ä¸Šä¸‹æ–‡ï¼ŒLangChain4Jæä¾›äº†ä¸¤ç§å¼€ç®±å³ç”¨çš„çª—å£èŠå¤©è®°å¿†</p>
<ul>
<li><code>MessageWindowChatMemory</code></li>
<li><code>TokenWindowChatMemory</code></li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªåŸºäºæ¶ˆæ¯æ•°é‡çš„çª—å£å¯¹è¯è®°å¿†ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {

    <span class="hljs-comment">// 1.æ–°å»º messageWindowï¼Œæ»‘åŠ¨çª—å£æœ€å¤§é•¿åº¦è®¾ç½®ä¸º 3</span>
    <span class="hljs-type">MessageWindowChatMemory</span> <span class="hljs-variable">chatWindow</span> <span class="hljs-operator">=</span> MessageWindowChatMemory.builder()
            .maxMessages(<span class="hljs-number">4</span>)
            .build();
    <span class="hljs-comment">// tryChatWithCommonMessages(chatWindow);</span>
    <span class="hljs-comment">// æµ‹è¯•ç‰¹æ®Šçš„ç³»ç»Ÿæ¶ˆæ¯ systemMessage</span>
    tryChatWithSystemMessage(chatWindow);
}

<span class="hljs-comment">/**
 * ç³»ç»Ÿæ¶ˆæ¯æ°¸è¿œä¸ä¼šè¢«é©±é€
 * <span class="hljs-doctag">@param</span> chatWindow
 */</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">tryChatWithSystemMessage</span><span class="hljs-params">(MessageWindowChatMemory chatWindow)</span> {
    <span class="hljs-comment">// åˆ›å»ºç³»ç»Ÿæ¶ˆæ¯</span>
    <span class="hljs-type">SystemMessage</span> <span class="hljs-variable">systemMessage</span> <span class="hljs-operator">=</span> SystemMessage.from(<span class="hljs-string">"The user talking with you is shepi"</span>);
    chatWindow.add(systemMessage);
    System.out.println(systemMessage.text());
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) {
        <span class="hljs-type">UserMessage</span> <span class="hljs-variable">userMessage</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">if</span> (i == <span class="hljs-number">3</span>) {
            userMessage = UserMessage.from(<span class="hljs-string">"Please tell me my name"</span>);
        } <span class="hljs-keyword">else</span> {
            userMessage = UserMessage.from(<span class="hljs-string">"let's talk about something interesting"</span>);
        }
        System.out.println(userMessage.contents());
        chatWindow.add(userMessage);
        <span class="hljs-comment">// ä½¿ç”¨ chatMemory å¯¹è¯</span>
        <span class="hljs-type">AiMessage</span> <span class="hljs-variable">aiMessage</span> <span class="hljs-operator">=</span> CHAT_MODEL.chat(ChatRequest.builder().messages(chatWindow.messages()).build()).aiMessage();
        System.out.println(aiMessage.text());
        chatWindow.add(aiMessage);
    }
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">tryChatWithCommonMessages</span><span class="hljs-params">(MessageWindowChatMemory chatWindow)</span> {
    <span class="hljs-comment">// 2.æ¨¡æ‹Ÿè¿›è¡Œå¤šè½®å¯¹è¯</span>
    <span class="hljs-comment">// ç¬¬ä¸€è½®ç»™å‡ºè‡ªå·±çš„åå­—ï¼Œç¬¬å››è½®è¯¢é—®AIæˆ‘çš„åå­—ï¼Œå…¶ä»–ä¸¤è½®éšä¾¿èŠç‚¹ä»€ä¹ˆ</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) {
        <span class="hljs-type">UserMessage</span> <span class="hljs-variable">userMessage</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">if</span> (i == <span class="hljs-number">0</span>) {
            userMessage = UserMessage.from(<span class="hljs-string">"Hello, My name is shepi, could you introduce yourself ?"</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i == <span class="hljs-number">3</span>) {
            userMessage = UserMessage.from(<span class="hljs-string">"Please tell me my name"</span>);
        } <span class="hljs-keyword">else</span> {
            userMessage = UserMessage.from(<span class="hljs-string">"let's talk about something interesting"</span>);
        }
        System.out.println(userMessage.contents());
        chatWindow.add(userMessage);
        <span class="hljs-comment">// ä½¿ç”¨ chatMemory å¯¹è¯</span>
        <span class="hljs-type">AiMessage</span> <span class="hljs-variable">aiMessage</span> <span class="hljs-operator">=</span> CHAT_MODEL.chat(ChatRequest.builder().messages(chatWindow.messages()).build()).aiMessage();
        System.out.println(aiMessage.text());
        chatWindow.add(aiMessage);
    }
}
</code></pre>
<h4 data-id="heading-18">3.3.Tools</h4>
<p>LangChainä¸­å®šä¹‰<code>Tool</code>éå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨å·¥å…·æ¥å£æ–¹æ³•ä¸Šä½¿ç”¨æ³¨è§£ <code>@Tool("Tool description")</code>å³å¯ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç®€ç­”çš„ä¾‹å­ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WeatherService</span> {
    <span class="hljs-meta">@Tool("è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”æƒ…å†µ")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getWeather</span><span class="hljs-params">(String city)</span> {
        <span class="hljs-comment">// æ¨¡æ‹Ÿå¤©æ°”æ•°æ®</span>
        <span class="hljs-keyword">return</span> MessageFormat.
                format(<span class="hljs-string">"Today's weather in {0} is sunny with a temperature of 22 degrees."</span>, city);
    }
}
</code></pre>
<h4 data-id="heading-19">3.4.AiService (Agent å°è£…)</h4>
<p><strong>AiService æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>AiService æ˜¯ LangChain4J æä¾›çš„é«˜å±‚ APIï¼Œç”¨äºå¿«é€Ÿæ„å»º Agent åº”ç”¨ã€‚å®ƒå±è”½äº†å·¥å…·è°ƒç”¨çš„åº•å±‚ç»†èŠ‚ï¼ˆå¦‚æ£€æµ‹ LLM è¿”å›çš„å‡½æ•°è°ƒç”¨è¯·æ±‚ã€æ‰§è¡Œå·¥å…·ã€å°†ç»“æœåé¦ˆç»™ LLMï¼‰ï¼Œè®©å¼€å‘è€…å¯ä»¥ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ã€‚</p>
<p><strong>AiService ä¸ Agent çš„å…³ç³»ï¼š</strong></p>
<ul>
<li>AiService æ˜¯ LangChain4J å¯¹ Agent æ¦‚å¿µçš„å…·ä½“å®ç°</li>
<li>å®ƒè‡ªåŠ¨å®Œæˆäº† Agent Loop ä¸­çš„ï¼šæ¥æ”¶è¾“å…¥ â†’ åˆ¤æ–­æ˜¯å¦éœ€è¦ Tool â†’ è°ƒç”¨ Tool â†’ è§‚å¯Ÿç»“æœ â†’ ç”Ÿæˆå“åº”</li>
<li>å¼€å‘è€…åªéœ€å®šä¹‰æ¥å£å’Œ Toolï¼ŒAiService ä¼šè‡ªåŠ¨å®Œæˆå·¥å…·è°ƒç”¨çš„ç¼–æ’</li>
</ul>
<p>å¦‚æœæƒ³è¦ä½¿ç”¨ä¸Šé¢åˆ›å»ºçš„ Toolï¼Œæˆ‘ä»¬éœ€è¦åœ¨å®šä¹‰ <code>AiService</code> æ—¶ï¼Œä¼ å…¥ Tool å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">OpenAiChatModel</span> <span class="hljs-variable">CHAT_MODEL</span> <span class="hljs-operator">=</span> OpenAiChatModel.builder()
            .apiKey(System.getenv(<span class="hljs-string">"OPENAI_API_KEY"</span>))
            .baseUrl(System.getenv(<span class="hljs-string">"OPENAI_BASE_URL"</span>))
            .modelName(System.getenv(<span class="hljs-string">"OPENAI_MODEL"</span>))
            .build();

<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {

    <span class="hljs-comment">// æ ¹æ®CHAT_MODELåˆ›å»ºä¸€ä¸ª chatService</span>
    <span class="hljs-type">ChatAssistant</span> <span class="hljs-variable">chatService</span> <span class="hljs-operator">=</span> AiServices.builder(ChatAssistant.class)
            .chatLanguageModel(CHAT_MODEL)
            .tools(<span class="hljs-keyword">new</span> <span class="hljs-title class_">WeatherService</span>())
            .chatMemory(MessageWindowChatMemory.withMaxMessages(<span class="hljs-number">10</span>))
            .build();

    <span class="hljs-comment">// é—®é¢˜</span>
    <span class="hljs-type">String</span> <span class="hljs-variable">question</span> <span class="hljs-operator">=</span> <span class="hljs-string">"ä»Šå¤©åŒ—äº¬ä»€ä¹ˆå¤©æ°”?"</span>;
    <span class="hljs-type">String</span> <span class="hljs-variable">answer</span> <span class="hljs-operator">=</span> chatService.chat(question);
    System.out.println(answer);
}
</code></pre>
<h3 data-id="heading-20">4.æµå¼å“åº” (Streaming)</h3>
<p>LangChain4J æ”¯æŒ<strong>æµå¼å“åº”</strong>ï¼Œå³ LLM åœ¨ç”Ÿæˆå†…å®¹æ—¶å®æ—¶è¿”å›æ¯ä¸ª tokenï¼Œè€Œä¸æ˜¯ç­‰å¾…å®Œæ•´å“åº”åå†è¿”å›ã€‚</p>
<h4 data-id="heading-21">ä½¿ç”¨åœºæ™¯</h4>
<ul>
<li>éœ€è¦å®æ—¶æ˜¾ç¤ºç”Ÿæˆè¿‡ç¨‹çš„åœºæ™¯ï¼ˆå¦‚ ChatGPT çš„æ‰“å­—æœºæ•ˆæœï¼‰</li>
<li>ç”Ÿæˆè¾ƒé•¿å†…å®¹æ—¶æå‡ç”¨æˆ·ä½“éªŒ</li>
<li>éœ€è¦æå‰ç»ˆæ­¢ä¸æ»¡æ„çš„è¾“å‡º</li>
</ul>
<h4 data-id="heading-22">å®ç°æ–¹å¼</h4>
<p>ä½¿ç”¨ <code>StreamingAiServices</code> ä»£æ›¿ <code>AiServices</code>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">StreamingChatAssistant</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">chat</span><span class="hljs-params">(String message, StreamingResponseHandler handler)</span>;
}

<span class="hljs-type">StreamingChatAssistant</span> <span class="hljs-variable">agent</span> <span class="hljs-operator">=</span> StreamingAiServices.builder(StreamingChatAssistant.class)
        .chatLanguageModel(model)
        .build();

agent.chat(<span class="hljs-string">"ä»‹ç»ä¸€ä¸‹ LangChain4J"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">StreamingResponseHandler</span>() {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onToken</span><span class="hljs-params">(String token)</span> {
        <span class="hljs-comment">// æ¯æ”¶åˆ°ä¸€ä¸ª token å°±è°ƒç”¨</span>
        System.out.print(token);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onComplete</span><span class="hljs-params">(String fullResponse)</span> {
        System.out.println(<span class="hljs-string">"\nå®Œæˆ!"</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onError</span><span class="hljs-params">(Throwable error)</span> {
        System.err.println(<span class="hljs-string">"é”™è¯¯: "</span> + error.getMessage());
    }
});
</code></pre>
<h4 data-id="heading-23">æµå¼ vs éæµå¼</h4>






























<table><thead><tr><th>ç‰¹æ€§</th><th>éæµå¼ (AiServices)</th><th>æµå¼ (StreamingAiServices)</th></tr></thead><tbody><tr><td>å“åº”æ–¹å¼</td><td>ç­‰å¾…å®Œæ•´å“åº”åè¿”å›</td><td>å®æ—¶è¿”å›æ¯ä¸ª token</td></tr><tr><td>ç”¨æˆ·ä½“éªŒ</td><td>æœ‰ç­‰å¾…æ„Ÿ</td><td>å®æ—¶åé¦ˆï¼Œä½“éªŒæ›´å¥½</td></tr><tr><td>å®ç°å¤æ‚åº¦</td><td>ç®€å•</td><td>ç¨å¤æ‚ï¼ˆéœ€è¦å¤„ç†å›è°ƒï¼‰</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>çŸ­æ–‡æœ¬ã€åå°ä»»åŠ¡</td><td>é•¿æ–‡æœ¬ã€äº¤äº’å¼å¯¹è¯</td></tr></tbody></table>
<p>å®Œæ•´ç¤ºä¾‹ä»£ç è§ï¼š<code>StreamingAgent.java</code></p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨SSHåœ°å€æ‹‰å–è¿œç¨‹ä»“åº“ä»£ç æŠ¥ä¸‹é¢çš„é”™è¯¯]]></title>    <link>https://juejin.cn/post/7603574149776654388</link>    <guid>https://juejin.cn/post/7603574149776654388</guid>    <pubDate>2026-02-07T09:27:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603574149776654388" data-draft-id="7603673564907864099" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨SSHåœ°å€æ‹‰å–è¿œç¨‹ä»“åº“ä»£ç æŠ¥ä¸‹é¢çš„é”™è¯¯"/> <meta itemprop="keywords" content="Git"/> <meta itemprop="datePublished" content="2026-02-07T09:27:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä½•ä¸­åº”"/> <meta itemprop="url" content="https://juejin.cn/user/1435305504958535"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨SSHåœ°å€æ‹‰å–è¿œç¨‹ä»“åº“ä»£ç æŠ¥ä¸‹é¢çš„é”™è¯¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1435305504958535/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä½•ä¸­åº”
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T09:27:45.000Z" title="Sat Feb 07 2026 09:27:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¯´æ˜ï¼šé…ç½®äº†SSHç§˜é’¥åï¼Œä½¿ç”¨SSHåœ°å€å…‹éš†ä»£ç ï¼Œä¾æ—§æ— æ³•æ‹‰å–ä»£ç ï¼Œæç¤ºä¸‹é¢è¿™ä¸ªä¿¡æ¯ã€‚
<code>Their offerï¼šssh-rsaï¼Œssh-dss fatalï¼šCould not read from remote repository.</code>
<code>Please make sure you have the correct access rights and the repository exists.</code></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c9c42c57e43a4700a3b9854bbef8bc5d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061265&amp;x-signature=EMDV%2FtPNXOkKp%2Bhz5IsaSGwCvpo%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
æç¤ºè¯´æ˜ï¼Œä»“åº“åœ°å€æ”¯æŒçš„æ˜¯ssh-rsaï¼Œssh-dssç±»å‹çš„ç§˜é’¥ï¼›</p>
<h2 data-id="heading-0">æ£€æŸ¥ç§˜é’¥ç±»å‹</h2>
<p>é¦–å…ˆï¼ŒæŸ¥çœ‹ä¸€ä¸‹æœ¬åœ°é…ç½®çš„ç§˜é’¥æ˜¯ä»€ä¹ˆç±»å‹çš„ï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1263eecea87647158f47524644a84ca1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061265&amp;x-signature=gEt6xc2H5FZ1U6JnlQiV1jry5e0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>è¿™ä¸ªå°±æ˜¯ssh-rsaç±»å‹çš„ï¼Œå¦‚æœä¸æ˜¯çš„è¯ï¼Œå¯ä»¥æ•²ä¸‹é¢çš„å‘½ä»¤ç”Ÿæˆä¸€ä¸ªè¿™æ ·çš„ç§˜é’¥å¯¹ï¼›</p>
<p><code>ssh-keygen -t rsa -b 4096 -C "your_email@163.com</code></p>
<p>æ¢æˆä½ çš„é‚®ç®±ï¼Œåœ¨gitå‘½ä»¤çª—å£é‡Œè¾“å…¥å‘½ä»¤åè¿ç»­æ•²ä¸‰ä¸‹å›è½¦å³å¯ï¼Œç„¶åå°±å¯ä»¥åœ¨.sshç›®å½•ä¸‹æ‰¾åˆ°ç”Ÿæˆçš„ç§˜é’¥å’Œå…¬é’¥ï¼›</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/765770a2375b4991981702713ba3458f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061265&amp;x-signature=h2Nzd14Hy4yzrHCD7DxCHuAIY3A%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-1">é…ç½®ä»“åº“IP</h2>
<p>å¥½äº†ï¼Œä»¥ä¸Šé…ç½®åï¼Œä½¿ç”¨SSHé“¾æ¥å…‹éš†ä»£ç æŠ¥æœ€å¼€å§‹çš„é”™è¯¯ï¼Œ==éœ€è¦æ‰¾åˆ°Gitå®‰è£…ç›®å½•ä¸‹çš„ssh_configé…ç½®ï¼Œåœ¨é…ç½®çš„æœ€æœ«å°¾åŠ ä¸Šè¿™æ®µé…ç½®==ï¼Œå…¶ä¸­==æ¨¡ç³Šçš„éƒ¨åˆ†æ˜¯è¿œç¨‹ä»“åº“çš„IPåœ°å€ï¼Œä¸åŠ ç«¯å£å·ï¼Œä¸è¦æ‰‹æ•²ï¼Œå¤åˆ¶å‰é¢çš„==ï¼›</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ecac3e51461e4515941d1a1c18959d85~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061265&amp;x-signature=pRJCCLZ%2BEVM%2F6GcJHVdSI9paBok%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>æ­¤æ—¶ï¼Œå†å»æ‹‰å–è¿œç¨‹ä»“åº“çš„ä»£ç å°±æ²¡é—®é¢˜äº†ã€‚</p>
<h2 data-id="heading-2">é¦–æ¬¡å‘å¸ƒ</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhezhongying.blog.csdn.net%2Farticle%2Fdetails%2F132912613" target="_blank" title="https://hezhongying.blog.csdn.net/article/details/132912613" ref="nofollow noopener noreferrer">hezhongying.blog.csdn.net/article/detâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Workerman + ThinkPHP 8 ç»“åˆä½¿ç”¨]]></title>    <link>https://juejin.cn/post/7603588665568116776</link>    <guid>https://juejin.cn/post/7603588665568116776</guid>    <pubDate>2026-02-07T10:12:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603588665568116776" data-draft-id="7603616672927105039" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Workerman + ThinkPHP 8 ç»“åˆä½¿ç”¨"/> <meta itemprop="keywords" content="ThinkPHP,PHP"/> <meta itemprop="datePublished" content="2026-02-07T10:12:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤©å®"/> <meta itemprop="url" content="https://juejin.cn/user/187362547083252"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Workerman + ThinkPHP 8 ç»“åˆä½¿ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/187362547083252/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤©å®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T10:12:06.000Z" title="Sat Feb 07 2026 10:12:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#5f6368;background-image:linear-gradient(90deg,rgba(240,191,213,.1) 3%,transparent 0),linear-gradient(1turn,rgba(240,191,213,.1) 3%,transparent 0);background-size:20px 20px;background-position:50%;letter-spacing:1px;word-spacing:1px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-left:50px;padding-bottom:5px;color:#5f6368}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{position:absolute;left:0;display:block;content:""}.markdown-body h1{font-size:32px;margin-bottom:5px}.markdown-body h1:before{top:0;content:"ğŸ¦„";font-size:32px}.markdown-body h2{padding-bottom:24px;border-bottom:1px solid #ececec}.markdown-body h2:before{top:0;left:8px;content:"ğŸ³";font-size:24px}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{top:-2px;left:8px;content:"ğŸ„";font-size:20px}.markdown-body h4{font-size:16px}.markdown-body h4:before{top:-2px;left:8px;content:"ğŸ¦¥";font-size:18px}.markdown-body h5{font-size:14px}.markdown-body h5:before{top:-2px;left:9px;content:"ğŸ¦©";font-size:16px}.markdown-body h6{font-size:12px;margin-top:5px}.markdown-body h6:before{top:-1px;left:10px;content:"ğŸ§";font-size:14px}.markdown-body p{line-height:1.9;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid rgba(253,121,168,.5);margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#a6accd;background:#292d3e;border-radius:8px}.markdown-body a{text-decoration:none;color:#fd79a8;border-bottom:1px solid #fd79a8;padding:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(253,121,168,.1);color:#ee69a9}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body th{color:#fd79a8}.markdown-body th,.markdown-body tr:hover{background:rgba(253,121,168,.1)}.markdown-body td{min-width:120px}.markdown-body blockquote{position:relative;color:#666;padding:23px;margin:22px 0;border-left:4px solid #ee69a9;background-color:rgba(253,121,168,.1)}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;display:block;font-size:27px;color:#fd79a8;opacity:.8}.markdown-body blockquote:before{left:10px;top:0;content:"â"}.markdown-body blockquote:after{right:10px;bottom:0;content:"â"}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body strong{position:relative;color:#fd79a8}.markdown-body strong:before{content:"Â· "}.markdown-body strong:after{content:" Â·"}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#fd79a8}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#ee69a9}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">å®‰è£…</h2>
<pre><code class="hljs language-bash" lang="bash">composer require workerman/workerman
</code></pre>
<hr/>
<h2 data-id="heading-1">åˆ›å»ºå‘½ä»¤</h2>
<pre><code class="hljs language-text" lang="text">php think make:command å‘½ä»¤æ–‡ä»¶å å‘½ä»¤å
</code></pre>
<h2 data-id="heading-2">å®ä¾‹ä¸€ï¼šç§’çº§å®šæ—¶ä»»åŠ¡</h2>
<h3 data-id="heading-3">æ–‡ä»¶ä½ç½®</h3>
<pre><code class="hljs language-text" lang="text">app/command/TimerTest.php
</code></pre>
<h3 data-id="heading-4">ä»£ç </h3>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title class_">app</span>\<span class="hljs-title class_">command</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">think</span>\<span class="hljs-title">console</span>\<span class="hljs-title">Command</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Workerman</span>\<span class="hljs-title">Worker</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Workerman</span>\<span class="hljs-title">Timer</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">app</span>\<span class="hljs-title">common</span>\<span class="hljs-title">model</span>\<span class="hljs-title">Order</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TimerTest</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Command</span>
</span>{
    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">configure</span>(<span class="hljs-params"/>)
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">setName</span>(<span class="hljs-string">'timer'</span>);
    }

    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">execute</span>(<span class="hljs-params">Input <span class="hljs-variable">$input</span>, Output <span class="hljs-variable">$output</span></span>)
    </span>{
        <span class="hljs-variable">$worker</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>();
        <span class="hljs-variable">$worker</span>-&gt;onWorkerStart = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"/>) </span>{
            <span class="hljs-comment">// æ¯ç§’ä»»åŠ¡</span>
            <span class="hljs-title class_">Timer</span>::<span class="hljs-title function_ invoke__">add</span>(<span class="hljs-number">1</span>, function() {
                <span class="hljs-variable">$count</span> = <span class="hljs-title class_">Order</span>::<span class="hljs-title function_ invoke__">where</span>(<span class="hljs-string">'status'</span>, <span class="hljs-number">0</span>)
                    -&gt;<span class="hljs-title function_ invoke__">where</span>(<span class="hljs-string">'create_time'</span>, <span class="hljs-string">'&lt;'</span>, <span class="hljs-title function_ invoke__">time</span>() - <span class="hljs-number">1800</span>)
                    -&gt;<span class="hljs-title function_ invoke__">update</span>([<span class="hljs-string">'status'</span> =&gt; -<span class="hljs-number">1</span>]);
                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$count</span>) <span class="hljs-keyword">echo</span> <span class="hljs-string">"è‡ªåŠ¨å…³é—­ <span class="hljs-subst">{$count}</span> ä¸ªè¶…æ—¶è®¢å•\n"</span>;
            });

            <span class="hljs-comment">// æ¯5ç§’ä»»åŠ¡</span>
            <span class="hljs-title class_">Timer</span>::<span class="hljs-title function_ invoke__">add</span>(<span class="hljs-number">5</span>, function() {
                <span class="hljs-keyword">echo</span> <span class="hljs-string">"5ç§’ä»»åŠ¡æ‰§è¡Œ: "</span> . <span class="hljs-title function_ invoke__">date</span>(<span class="hljs-string">'Y-m-d H:i:s'</span>) . <span class="hljs-string">"\n"</span>;
            });

            <span class="hljs-comment">// æ¯60ç§’ä»»åŠ¡</span>
            <span class="hljs-title class_">Timer</span>::<span class="hljs-title function_ invoke__">add</span>(<span class="hljs-number">60</span>, function() {
                <span class="hljs-title function_ invoke__">cache</span>(<span class="hljs-string">'visit_count'</span>, <span class="hljs-number">0</span>);
                <span class="hljs-keyword">echo</span> <span class="hljs-string">"å·²é‡ç½®è®¿é—®è®¡æ•°\n"</span>;
            });
        };

        <span class="hljs-title class_">Worker</span>::<span class="hljs-title function_ invoke__">runAll</span>();
    }
}
</code></pre>
<h3 data-id="heading-5">é…ç½® <code>config/console.php</code></h3>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">return</span> [
    <span class="hljs-string">'commands'</span> =&gt; [
        <span class="hljs-string">'timer'</span> =&gt; <span class="hljs-string">'app\command\TimerTest'</span>,
    ],
];
</code></pre>
<h3 data-id="heading-6">å¯åŠ¨</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Linux åå°è¿è¡Œ</span>
php think timer start -d

<span class="hljs-comment"># Windows å¼€å‘</span>
php think timer start
</code></pre>
<hr/>
<h2 data-id="heading-7">å®ä¾‹äºŒï¼šWebSocket å®æ—¶é€šä¿¡</h2>
<h3 data-id="heading-8">æ–‡ä»¶ä½ç½®</h3>
<pre><code class="hljs language-shell" lang="shell">app/command/WebSocket.php
</code></pre>
<h3 data-id="heading-9">ä»£ç </h3>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title class_">app</span>\<span class="hljs-title class_">command</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">think</span>\<span class="hljs-title">console</span>\<span class="hljs-title">Command</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Workerman</span>\<span class="hljs-title">Worker</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WebSocket</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Command</span>
</span>{
    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">configure</span>(<span class="hljs-params"/>)
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">setName</span>(<span class="hljs-string">'websocket'</span>);
    }

    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">execute</span>(<span class="hljs-params">Input <span class="hljs-variable">$input</span>, Output <span class="hljs-variable">$output</span></span>)
    </span>{
        <span class="hljs-variable">$ws</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'websocket://0.0.0.0:8282'</span>);
        <span class="hljs-variable">$ws</span>-&gt;count = <span class="hljs-number">4</span>;

        <span class="hljs-variable">$ws</span>-&gt;onMessage = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-variable">$connection</span>, <span class="hljs-variable">$data</span></span>) </span>{
            <span class="hljs-comment">// å¹¿æ’­æ¶ˆæ¯</span>
            <span class="hljs-keyword">foreach</span>(<span class="hljs-title class_">Worker</span>::<span class="hljs-variable">$connections</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$conn</span>) {
                <span class="hljs-variable">$conn</span>-&gt;<span class="hljs-title function_ invoke__">send</span>(<span class="hljs-variable">$data</span>);
            }
        };

        <span class="hljs-title class_">Worker</span>::<span class="hljs-title function_ invoke__">runAll</span>();
    }
}
</code></pre>
<h3 data-id="heading-10">é…ç½® <code>config/console.php</code></h3>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">return</span> [
    <span class="hljs-string">'commands'</span> =&gt; [
        <span class="hljs-string">'websocket'</span> =&gt; <span class="hljs-string">'app\command\WebSocket'</span>,
    ],
];
</code></pre>
<h3 data-id="heading-11">å¯åŠ¨</h3>
<pre><code class="hljs language-bash" lang="bash">php think websocket start -d
</code></pre>
<hr/>
<h2 data-id="heading-12">å®ä¾‹ä¸‰ï¼šTP8 æ¥å£ä¸­è§¦å‘ WebSocket æ¨é€ï¼ˆå†…éƒ¨ Text ç«¯å£ï¼‰</h2>
<h3 data-id="heading-13">è®¾è®¡æ€è·¯</h3>
<p>WebSocket æœåŠ¡è¿è¡Œåœ¨ç‹¬ç«‹è¿›ç¨‹ä¸­ï¼ŒTP8 HTTP æ¥å£æ— æ³•ç›´æ¥è°ƒç”¨ã€‚è§£å†³æ–¹æ¡ˆï¼šåœ¨åŒä¸€è¿›ç¨‹å†…å†ç›‘å¬ä¸€ä¸ªå†…éƒ¨ç«¯å£ï¼ˆ8281ï¼‰ï¼Œæ¥å£é€šè¿‡ TCP çŸ­è¿æ¥å‘é€æ¶ˆæ¯ã€‚</p>
<pre><code class="hljs language-text" lang="text">TP8 æ¥å£ â†’ TCP 8281 (Textåè®®: æ¶ˆæ¯+æ¢è¡Œç¬¦) â†’ WebSocket 8282 â†’ å®¢æˆ·ç«¯
</code></pre>
<h3 data-id="heading-14">æ–‡ä»¶ä½ç½®</h3>
<pre><code class="hljs language-text" lang="text">app/command/PushServer.php
</code></pre>
<h3 data-id="heading-15">ä»£ç </h3>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title class_">app</span>\<span class="hljs-title class_">command</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">think</span>\<span class="hljs-title">console</span>\<span class="hljs-title">Command</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Workerman</span>\<span class="hljs-title">Worker</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PushServer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Command</span>
</span>{
    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">configure</span>(<span class="hljs-params"/>)
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">setName</span>(<span class="hljs-string">'push-server'</span>);
    }

    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">execute</span>(<span class="hljs-params">Input <span class="hljs-variable">$input</span>, Output <span class="hljs-variable">$output</span></span>)
    </span>{
        <span class="hljs-comment">// WebSocket æœåŠ¡ï¼ˆå¯¹å¤–ï¼Œ8282ç«¯å£ï¼‰</span>
        <span class="hljs-variable">$ws</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'websocket://0.0.0.0:8282'</span>);
        <span class="hljs-variable">$ws</span>-&gt;count = <span class="hljs-number">4</span>;

        <span class="hljs-variable">$ws</span>-&gt;onMessage = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-variable">$connection</span>, <span class="hljs-variable">$data</span></span>) </span>{
            <span class="hljs-keyword">foreach</span>(<span class="hljs-title class_">Worker</span>::<span class="hljs-variable">$connections</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$conn</span>) {
                <span class="hljs-variable">$conn</span>-&gt;<span class="hljs-title function_ invoke__">send</span>(<span class="hljs-variable">$data</span>);
            }
        };

        <span class="hljs-comment">// å†…éƒ¨æ¨é€æœåŠ¡ï¼ˆå¯¹å†…ï¼Œ8281ç«¯å£ï¼ŒTextåè®®ï¼‰</span>
        <span class="hljs-variable">$internal</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'text://0.0.0.0:8281'</span>);

        <span class="hljs-variable">$internal</span>-&gt;onMessage = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-variable">$connection</span>, <span class="hljs-variable">$data</span></span>) </span>{
            <span class="hljs-comment">// æ”¶åˆ°å†…éƒ¨æ¨é€æ¶ˆæ¯ï¼Œå¹¿æ’­ç»™æ‰€æœ‰ WebSocket å®¢æˆ·ç«¯</span>
            <span class="hljs-keyword">foreach</span>(<span class="hljs-title class_">Worker</span>::<span class="hljs-variable">$connections</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$conn</span>) {
                <span class="hljs-variable">$conn</span>-&gt;<span class="hljs-title function_ invoke__">send</span>(<span class="hljs-variable">$data</span>);
            }

            <span class="hljs-comment">// å›åº”å®¢æˆ·ç«¯</span>
            <span class="hljs-variable">$connection</span>-&gt;<span class="hljs-title function_ invoke__">send</span>(<span class="hljs-string">"OK\n"</span>);
        };

        <span class="hljs-title class_">Worker</span>::<span class="hljs-title function_ invoke__">runAll</span>();
    }
}
</code></pre>
<h3 data-id="heading-16">é…ç½® <code>config/console.php</code></h3>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">return</span> [
    <span class="hljs-string">'commands'</span> =&gt; [
        <span class="hljs-string">'push-server'</span> =&gt; <span class="hljs-string">'app\command\PushServer'</span>,
    ],
];
</code></pre>
<h3 data-id="heading-17">TP8 æ¥å£ä¸­æ¨é€</h3>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">namespace</span> <span class="hljs-title class_">app</span>\<span class="hljs-title class_">api</span>\<span class="hljs-title class_">controller</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">think</span>\<span class="hljs-title">Controller</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">app</span>\<span class="hljs-title">common</span>\<span class="hljs-title">model</span>\<span class="hljs-title">Message</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Api</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Controller</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">send</span>(<span class="hljs-params"/>)
    </span>{
        <span class="hljs-variable">$content</span> = <span class="hljs-variable language_">$this</span>-&gt;request-&gt;<span class="hljs-title function_ invoke__">post</span>(<span class="hljs-string">'content'</span>);

        <span class="hljs-comment">// è¿æ¥åˆ°å†…éƒ¨æ¨é€ç«¯å£</span>
        <span class="hljs-variable">$socket</span> = <span class="hljs-title function_ invoke__">stream_socket_client</span>(<span class="hljs-string">'tcp://127.0.0.1:8281'</span>,<span class="hljs-variable">$errno</span>, <span class="hljs-variable">$errmsg</span>, <span class="hljs-number">3</span>);

        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$socket</span>) {
            <span class="hljs-comment">// å‘é€æ¶ˆæ¯ï¼ˆæ¢è¡Œç¬¦ç»“å°¾è¡¨ç¤ºä¸€æ¡å®Œæ•´æ¶ˆæ¯ï¼‰</span>
            <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$socket</span>, <span class="hljs-variable">$content</span> . <span class="hljs-string">"\n"</span>);

            <span class="hljs-comment">// è¯»å–å›åº”ï¼ˆå¯é€‰ï¼‰</span>
            <span class="hljs-variable">$response</span> = <span class="hljs-title function_ invoke__">fgets</span>(<span class="hljs-variable">$socket</span>);
            <span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$socket</span>);

            <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">json</span>([<span class="hljs-string">'code'</span> =&gt; <span class="hljs-number">0</span>, <span class="hljs-string">'msg'</span> =&gt; <span class="hljs-string">'å‘é€æˆåŠŸ'</span>]);
        }

        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">json</span>([<span class="hljs-string">'code'</span> =&gt; <span class="hljs-number">1</span>, <span class="hljs-string">'msg'</span> =&gt; <span class="hljs-string">'æ¨é€å¤±è´¥: '</span> . <span class="hljs-variable">$errstr</span>]);
    }
}
</code></pre>
<h3 data-id="heading-18">å¯åŠ¨</h3>
<pre><code class="hljs language-bash" lang="bash">php think push-server start -d
</code></pre>
<hr/>
<h2 data-id="heading-19">å‘½ä»¤é€ŸæŸ¥</h2>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¼€å‘</span>
php think timer start

<span class="hljs-comment"># ç”Ÿäº§</span>
php think timer start -d

<span class="hljs-comment"># åœæ­¢</span>
php think timer stop

<span class="hljs-comment"># é‡å¯</span>
php think timer restart

<span class="hljs-comment"># å¹³æ»‘é‡å¯ï¼ˆä¸æ–­è¿ï¼‰</span>
php think timer reload
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Gitæœ¬åœ°ä»“åº“å‘½ä»¤è¡¥å……]]></title>    <link>https://juejin.cn/post/7603673564907896867</link>    <guid>https://juejin.cn/post/7603673564907896867</guid>    <pubDate>2026-02-07T09:28:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603673564907896867" data-draft-id="7603574149776670772" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Gitæœ¬åœ°ä»“åº“å‘½ä»¤è¡¥å……"/> <meta itemprop="keywords" content="Git"/> <meta itemprop="datePublished" content="2026-02-07T09:28:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä½•ä¸­åº”"/> <meta itemprop="url" content="https://juejin.cn/user/1435305504958535"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Gitæœ¬åœ°ä»“åº“å‘½ä»¤è¡¥å……
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1435305504958535/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä½•ä¸­åº”
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T09:28:36.000Z" title="Sat Feb 07 2026 09:28:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¯´æ˜ï¼šä¹‹å‰å¯¹Gitæœ¬åœ°ä»“åº“çš„åŸºç¡€ä½¿ç”¨æ€»ç»“è¿‡ä¸€ç¯‡ç¬”è®°ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fqq_42108331%2Farticle%2Fdetails%2F131276233" target="_blank" title="https://blog.csdn.net/qq_42108331/article/details/131276233" ref="nofollow noopener noreferrer">Gitæœ¬åœ°ä»“åº“ä½¿ç”¨</a>ï¼Œæœ¬æ–‡å¯¹Gitçš„ä¸€äº›åŸºç¡€å‘½ä»¤è¿›è¡Œè¡¥å……ã€‚</p>
<h2 data-id="heading-0">ä¸€æ­¥æäº¤</h2>
<p>é€šå¸¸ï¼Œæˆ‘ä»¬æœ¬åœ°ä»“åº“ä½¿ç”¨Gitï¼Œæ–‡ä»¶éƒ½éœ€è¦å…ˆ addï¼Œå°†æ–‡ä»¶ä»å·¥ä½œåŒºåŠ å…¥åˆ°æš‚å­˜åŒºï¼Œç„¶åå†commitï¼Œå°†æš‚å­˜åŒºçš„æ–‡ä»¶æäº¤è‡³ç‰ˆæœ¬åº“ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c8e6f4dd11a64f909f74408a39e9ec8e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=kooMu7qqZhSaJ4Ykr6cOENw08gg%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ä½†æ˜¯å¯¹äºå·²ç»åŠ å…¥æš‚å­˜åŒºçš„æ–‡ä»¶ï¼Œåç»­å¯¹æ–‡ä»¶å†…å®¹çš„ä¿®æ”¹ã€‚å¯ä»¥è¾“å…¥ä¸‹é¢è¿™ä¸ªå‘½ä»¤ï¼Œå°†ä¸¤æ­¥åˆæˆä¸€æ­¥ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">git commit -am 'commentä¿¡æ¯'
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df52659e25fa45df84fb55e1fffd3895~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=rtQsf78lfS3T8BdVYAtcRscPwfM%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>éœ€è¦æ³¨æ„ï¼Œä»…å¯¹å·²åŠ å…¥åˆ°æš‚å­˜åŒºçš„æ–‡ä»¶æœ‰æ•ˆï¼Œå¦‚æœæ˜¯æ–°å»ºçš„æ–‡ä»¶ï¼Œä¸èƒ½ä½¿ç”¨ï¼›</p>
<h2 data-id="heading-1">æŸ¥çœ‹å·®å¼‚</h2>
<p>å½“æˆ‘ä»¬commitç‰ˆæœ¬åº“æ—¶ï¼Œå¯ä»¥è¾“å…¥ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹ä¸€ä¸‹ç‰ˆæœ¬åº“ä¸­çš„æœ€æ–°çŠ¶æ€ä¸å½“å‰å·¥ä½œåŒºçš„å·®å¼‚ï¼›</p>
<pre><code class="hljs language-java" lang="java">git diff
</code></pre>
<p>æŸ¥çœ‹å·¥ä½œåŒºå’Œæš‚å­˜åŒºçš„å·®å¼‚ï¼›</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b82b88c8c69c4f959f93d0c669d2f2cd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=iHUWPdpeYbf0IsVRpqxOpio6jmI%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>å¦å¤–ï¼Œå¯ä»¥åœ¨åé¢åŠ ä¸Š<code>HEAD</code>ï¼ŒæŸ¥çœ‹æš‚å­˜åŒºä¸ç‰ˆæœ¬åº“çš„å·®å¼‚ï¼›</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/25ba804e773843adba4d4c7094f5478f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=%2B%2B3RLV%2FX3983YRi7HkK4p95l9Fg%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-2">ä¿®æ”¹æäº¤ä¿¡æ¯</h2>
<p>æœ‰æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½æäº¤æ—¶ï¼Œå†™çš„commentä¿¡æ¯ä¸å¤ªå‡†ç¡®ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ï¼Œå¯ä»¥è¾“å…¥ä¸‹é¢çš„å‘½ä»¤æ¥ä¿®æ”¹æœ€è¿‘ä¸€æ¬¡æäº¤çš„commentä¿¡æ¯ï¼›</p>
<pre><code class="hljs language-java" lang="java">git commit --amend -m <span class="hljs-string">'ä¿®æ”¹åçš„commentä¿¡æ¯'</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb2b46350c3f4147869aa22c76251ce4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=1g1pbPNvNH0TFV3j1arlS4aP8n0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-3">æŸ¥çœ‹æ—¥å¿—</h2>
<p>å½“åˆ†æ”¯è¾ƒå¤šæ—¶ï¼Œå¯ä»¥è¾“å…¥ä¸‹é¢çš„å‘½ä»¤ï¼ŒæŸ¥çœ‹åˆ†æ”¯çš„æƒ…å†µï¼Œåœ¨å·¦ä¾§ä¼šæœ‰çº¿æ¡æ˜¾ç¤ºåˆ†æ”¯çš„ç»“æ„ï¼›</p>
<pre><code class="hljs language-powershell" lang="powershell">git log --graph
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1208751b6947461cadf1698879897ba2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=f5EPxA5%2BiTagHWKokSf6mhV2JUU%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
å¦å¤–ï¼ŒæŸ¥çœ‹æ—¥å¿—ï¼Œå¯ä»¥åœ¨åé¢åŠ ä¸Š<code>--pretty=short</code>ï¼Œè¡¨ç¤ºæŸ¥çœ‹ç®€è¦çš„æ—¥å¿—ä¿¡æ¯ï¼›</p>
<pre><code class="hljs language-powershell" lang="powershell">git log --pretty=short
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f6c7f29968a4369974c7c94149c2826~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=MGedXt1jOWHV1n5nkwVdZUsxNu0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>è¿˜å¯ä»¥åœ¨åé¢åŠ <code>-p æ–‡ä»¶å</code>æ¥æŸ¥çœ‹å…³äºæ­¤æ–‡ä»¶çš„æ—¥å¿—ä¿¡æ¯ï¼›</p>
<pre><code class="hljs language-java" lang="java">git log --pretty=<span class="hljs-type">short</span> -p æ–‡ä»¶å
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d7a0e10a1a9411eaf1dd688486c2d96~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=NfrchveIwNfQ5f06izxHs22lTEs%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-4">ä¿®æ”¹å†å²æäº¤</h2>
<p>å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªåœºæ™¯ï¼Œæˆ‘ä»¬ä¿®æ”¹äº†æ–‡ä»¶ï¼Œæäº¤åˆ°äº†ç‰ˆæœ¬åº“ã€‚ä½†æ˜¯å‘ç°é‡Œé¢æœ‰ä¸€ä¸ªå°çš„æ‹¼å†™é—®é¢˜ï¼Œæˆ‘ä»¬ä¿®æ”¹å®Œæˆåï¼Œå†æ¬¡æäº¤åˆ°ç‰ˆæœ¬åº“ï¼Œæ­¤æ—¶å¸Œæœ›ç‰ˆæœ¬åº“é‡Œé¢åªç•™ä¸‹æˆ‘æœ€æ–°çš„è¿™æ¬¡æäº¤ï¼Œå‰ä¸€æ¬¡æäº¤ä»ç‰ˆæœ¬åº“ä¸­å‰”é™¤æ‰ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/27f8933ef9ba47dba05c075aac76b6b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=WbW5t5jQdDDcTxvquYhI9SUP%2Bbc%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>æœ‰æ‹¼å†™é—®é¢˜çš„æ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬åº“ï¼›</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fc72910ceb084d1fa3e09b4e70bf564d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=tLf%2Fcw5J8j2%2BwHpq9ui4hZIZIe0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ä¹‹åï¼Œä¿®æ”¹å®Œæ–‡ä»¶é‡Œé¢çš„æ‹¼å†™é—®é¢˜åï¼Œå†æ¬¡commitï¼›</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8fdd4963eb14c2ea98fcef0c5c5ce2b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=F3pMFmb53DsF735MkFx7ED2DVKk%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6930eb1d34de48f88afbd244c3b56fee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=TT%2FLj3MUfkMKfIfwADVMTEcuG%2FA%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>å¯ä»¥è¾“å…¥ä¸‹é¢çš„å‘½ä»¤ï¼Œè¡¨ç¤ºå‹ç¼©æœ€è¿‘2æ¬¡commitè®°å½•ï¼›</p>
<pre><code class="hljs language-java" lang="java">git rebase -i HEAD~<span class="hljs-number">2</span>
</code></pre>
<p>ç„¶åä¼šå‡ºç°ä¸‹é¢çš„çª—å£ï¼Œå°†åé¢çš„ï¼Œä¿®æ”¹æœ‰æ‹¼å†™é”™è¯¯çš„è¿™æ¬¡æäº¤ï¼Œpickæ”¹ä¸ºfixupï¼›</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/44a6ef3799a94e6cb04d9e0dd9cd9282~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=5EyuueITCO%2BLrNhBIOtq14aD8eQ%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ä¿å­˜é€€å‡ºï¼ˆå’ŒVimç¼–è¾‘å™¨ä½¿ç”¨ç›¸åŒï¼‰ï¼Œå†æ¬¡æŸ¥çœ‹æ—¥å¿—ï¼Œå¯ä»¥çœ‹åˆ°è¿™å›å°±åªæœ‰ä¸€æ¬¡æäº¤å†…å®¹äº†ã€‚é€šè¿‡æŸ¥çœ‹ç‰ˆæœ¬å·å¯ä»¥å‘ç°è¿™æ¬¡æäº¤ä¸ä¹‹å‰ä¸¤æ¬¡éƒ½ä¸åŒï¼Œæ˜¯åˆå¹¶ä¹‹åçš„ç»“æœã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df4526fb99b84a20b52f3b99929d1d0d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2V5Lit5bqU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771061315&amp;x-signature=%2B7LCUifxKCBLrE6YAgm11WH%2F5zo%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>è¿™å°±è¾¾åˆ°äº†ï¼Œæˆ‘ä»¬å‰é¢æƒ³è¦çš„ç»“æœï¼›</p>
<h2 data-id="heading-5">æ€»ç»“</h2>
<p>æœ¬æ–‡å‚è€ƒã€ŠGitHubå…¥é—¨ä¸å®è·µã€‹ï¼ˆ[æ—¥]å¤§å¡šå¼˜è®°ï¼‰ç¬¬4ç«  é€šè¿‡å®é™…æ“ä½œå­¦ä¹ Git</p>
<h2 data-id="heading-6">é¦–æ¬¡å‘å¸ƒ</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhezhongying.blog.csdn.net%2Farticle%2Fdetails%2F135181552" target="_blank" title="https://hezhongying.blog.csdn.net/article/details/135181552" ref="nofollow noopener noreferrer">hezhongying.blog.csdn.net/article/detâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[githubå‘å¸ƒpagesçš„å‡ ç§çŠ¶æ€è®°å½•]]></title>    <link>https://juejin.cn/post/7603574149776834612</link>    <guid>https://juejin.cn/post/7603574149776834612</guid>    <pubDate>2026-02-07T10:15:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603574149776834612" data-draft-id="7603643385815793716" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="githubå‘å¸ƒpagesçš„å‡ ç§çŠ¶æ€è®°å½•"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-07T10:15:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="1024å°ç¥"/> <meta itemprop="url" content="https://juejin.cn/user/70007368988926"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            githubå‘å¸ƒpagesçš„å‡ ç§çŠ¶æ€è®°å½•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/70007368988926/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    1024å°ç¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T10:15:27.000Z" title="Sat Feb 07 2026 10:15:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯1024å°ç¥ï¼Œæƒ³è¿› æŠ€æœ¯ç¾¤ / ç§æ´»ç¾¤ / è‚¡ç¥¨ç¾¤ æˆ– äº¤æœ‹å‹éƒ½å¯ä»¥ç§ä¿¡æˆ‘ï¼Œå¦‚æœä½ è§‰å¾—æœ¬æ–‡æœ‰ç”¨ï¼Œä¸€é”®ä¸‰è¿ (ç‚¹èµã€è¯„è®ºã€å…³æ³¨)ï¼Œå°±æ˜¯å¯¹æˆ‘æœ€å¤§çš„æ”¯æŒ~</p><p><img alt="" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/95994c912c27489cb3d1b8a6965faf01~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp" width="1750" loading="lazy"/></p><p/>
<p>å‘å¸ƒGitHub pagesä¼šæœ‰ä¸åŒçš„å‡ ç§çŠ¶æ€ï¼Œå¯ä»¥å‚è€ƒ</p>
<p>409:è¡¨ç¤ºå·²ç»å‘å¸ƒè¿‡äº†</p>
<pre><code class="hljs language-javascript" lang="javascript">{
    <span class="hljs-string">"message"</span>: <span class="hljs-string">"GitHub Pages is already enabled."</span>,
    <span class="hljs-string">"documentation_url"</span>: <span class="hljs-string">"https://docs.github.com/rest/pages/pages#create-a-apiname-pages-site"</span>,
    <span class="hljs-string">"status"</span>: <span class="hljs-string">"409"</span>
}</code></pre>
<p>erroredï¼šè¡¨ç¤ºå‘å¸ƒå¤±è´¥</p>
<p>é€šå¸¸æ˜¯å‘å¸ƒè¿‡åçš„pagesé™æ€æ–‡ä»¶æ›´æ–°åï¼Œä¼šè‡ªåŠ¨é‡æ–°å‘å¸ƒï¼Œæ¯”å¦‚æ€»çš„æ›´æ–°æ–‡ä»¶æ˜¯3ä¸ªï¼Œä½†æ˜¯æ›´æ–°äº†1ä¸ªä¹‹åå°±ä¼šå‡ºè§¦å‘è‡ªåŠ¨æ›´æ–°ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªç´§è·Ÿç€å°±æ›´æ–°äº†ï¼Œå°±ä¼šå†æ¬¡è§¦å‘æ›´æ–°ï¼Œè¿™ä¸ªæ—¶å€™ç¬¬ä¸€ä¸ªæ›´æ–°çŠ¶æ€å°±ä¼šå˜æˆerrored</p>
<pre><code class="hljs language-javascript" lang="javascript">{
    <span class="hljs-string">"url"</span>: <span class="hljs-string">"https://api.github.com/repos/xxxxxx/xxxxxxx/pages"</span>,
    <span class="hljs-string">"status"</span>: <span class="hljs-string">"errored"</span>,
    <span class="hljs-string">"cname"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"custom_404"</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-string">"html_url"</span>: <span class="hljs-string">"https://xxxxxxx.github.io/xxxxxxx7/"</span>,
    <span class="hljs-string">"build_type"</span>: <span class="hljs-string">"legacy"</span>,
    <span class="hljs-string">"source"</span>: {
        <span class="hljs-string">"branch"</span>: <span class="hljs-string">"main"</span>,
        <span class="hljs-string">"path"</span>: <span class="hljs-string">"/docs"</span>
    },
    <span class="hljs-string">"public"</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-string">"protected_domain_state"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"pending_domain_unverified_at"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"https_enforced"</span>: <span class="hljs-literal">true</span>
}</code></pre>
<p>statusï¼šnull è¯´æ˜æ­£åœ¨å‘å¸ƒpages</p>
<pre><code class="hljs language-javascript" lang="javascript">{
    <span class="hljs-string">"url"</span>: <span class="hljs-string">"https://api.github.com/repos/1024xiaoshen/PakePlus-Android-v2.1.6/pages"</span>,
    <span class="hljs-string">"status"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"cname"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"custom_404"</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-string">"html_url"</span>: <span class="hljs-string">"https://1024xiaoshen.github.io/PakePlus-Android-v2.1.6/"</span>,
    <span class="hljs-string">"build_type"</span>: <span class="hljs-string">"legacy"</span>,
    <span class="hljs-string">"source"</span>: {
        <span class="hljs-string">"branch"</span>: <span class="hljs-string">"main"</span>,
        <span class="hljs-string">"path"</span>: <span class="hljs-string">"/docs"</span>
    },
    <span class="hljs-string">"public"</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-string">"protected_domain_state"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"pending_domain_unverified_at"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"https_enforced"</span>: <span class="hljs-literal">true</span>
}</code></pre>
<p>builtï¼šè¡¨ç¤ºå·²ç»å‘å¸ƒå¥½äº†</p>
<pre><code class="hljs language-javascript" lang="javascript">{
    <span class="hljs-string">"url"</span>: <span class="hljs-string">"https://api.github.com/repos/1024xiaoshen/PakePlus-Android-v2.1.6/pages"</span>,
    <span class="hljs-string">"status"</span>: <span class="hljs-string">"built"</span>,
    <span class="hljs-string">"cname"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"custom_404"</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-string">"html_url"</span>: <span class="hljs-string">"https://1024xiaoshen.github.io/PakePlus-Android-v2.1.6/"</span>,
    <span class="hljs-string">"build_type"</span>: <span class="hljs-string">"legacy"</span>,
    <span class="hljs-string">"source"</span>: {
        <span class="hljs-string">"branch"</span>: <span class="hljs-string">"main"</span>,
        <span class="hljs-string">"path"</span>: <span class="hljs-string">"/docs"</span>
    },
    <span class="hljs-string">"public"</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-string">"protected_domain_state"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"pending_domain_unverified_at"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"https_enforced"</span>: <span class="hljs-literal">true</span>
}</code></pre>
<p/>
å¦‚æœä½ æœ‰å¥½çš„æƒ³æ³•æˆ–éœ€æ±‚ï¼Œéƒ½å¯ä»¥ç§ä¿¡æˆ‘ï¼Œæˆ‘è¿™é‡Œæœ‰å¾ˆå¤šç¨‹åºå‘˜æœ‹å‹å–œæ¬¢ç”¨ä»£ç æ¥åˆ›é€ ä¸°å¯Œå¤šå½©çš„è®¡ç®—æœºä¸–ç•Œ</div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨github copliot chatçš„æºç å­¦ä¹ ä¹‹Chromium Compositor]]></title>    <link>https://juejin.cn/post/7603616672927170575</link>    <guid>https://juejin.cn/post/7603616672927170575</guid>    <pubDate>2026-02-07T10:24:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603616672927170575" data-draft-id="7603673564908027939" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨github copliot chatçš„æºç å­¦ä¹ ä¹‹Chromium Compositor"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-07T10:24:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å´ä»°æ™–"/> <meta itemprop="url" content="https://juejin.cn/user/277554177507927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨github copliot chatçš„æºç å­¦ä¹ ä¹‹Chromium Compositor
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/277554177507927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å´ä»°æ™–
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T10:24:06.000Z" title="Sat Feb 07 2026 10:24:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»26åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>githubæ¨å‡ºäº† copilot chatï¼Œé‡Œé¢æ¯”è¾ƒæ–¹ä¾¿çš„æ˜¯å®ƒå¯ä»¥å¾ˆå¿«é€Ÿåœ°æœç´¢å’Œè·å–å„å¼€æºé¡¹ç›®çš„ä¸Šä¸‹æ–‡ã€‚é™¤äº†å•çº¯çš„Askï¼Œå…¶å®è¿˜æœ‰æ‰§è¡Œä»»åŠ¡çš„Agentï¼ˆä¸è¿‡è¦å¼€copilot proï¼‰ï¼Œä¼¼ä¹ç›®å‰æ˜¯é™åˆ¶äº†æ¯ä¸ªæœˆ50æ¬¡requestã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1c86a01bbfe424aa6088ea888156331~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC05Luw5pmW:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771064645&amp;x-signature=W1NGZHWEmOJb0o7v8HQldlj1cI4%3D" alt="image.png" loading="lazy"/></p>
<p>å› æ­¤æˆ‘åˆ©ç”¨è¿™ä¸ªæ¥å­¦ä¹ æºç ï¼Œè®©AIå›ç­”å…³äºæºç çš„ä¸œè¥¿ã€‚ä¸‹é¢çš„å†…å®¹æ˜¯å‡ºè‡ªcopilotçš„å›ç­”ï¼ˆæˆ‘è®¤ä¸ºæ¯”è¾ƒå¥½çš„ï¼‰ï¼Œåªæ˜¯ä¸ªäººè¿›è¡Œäº†æ•´ç†ã€‚
è¿™ä¸ªåšå®¢çš„è¥å…»ä»·å€¼å¹¶ä¸é«˜ï¼Œæœ€å¤§çš„ä»·å€¼å¯èƒ½å°±æ˜¯å‘Šè¯‰ä½ æœ‰è¿™ä¸ªæ–¹ä¾¿çš„é€”å¾„å»äº†è§£å’Œå­¦ä¹ æºç ã€‚<strong>å¯ä»¥ç›´æ¥è·³åˆ°å®Œæ•´ç¤ºä¾‹</strong>ï¼Œå‰é¢å¤§æŠµåªæ˜¯ä¸€äº›é“ºå«ã€‚</p>
<h2 data-id="heading-0">Chromium é¡µé¢æ¸²æŸ“çš„æ ¸å¿ƒæ¶æ„</h2>
<h3 data-id="heading-1">1. <strong>Blink æ¸²æŸ“å¼•æ“</strong> (æ ¸å¿ƒç»„ä»¶)</h3>
<p>æ ¹æ®å®˜æ–¹æ–‡æ¡£ï¼ŒBlink æ˜¯ Chromium çš„æ¸²æŸ“å¼•æ“ï¼Œè´Ÿè´£é¡µé¢å†…å®¹çš„æœ€ç»ˆå±•ç¤ºï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section">## Blink (Rendering Engine)</span>

Blink å®ç°äº†æ‰€æœ‰åœ¨æµè§ˆå™¨æ ‡ç­¾é¡µå†…æ¸²æŸ“å†…å®¹çš„åŠŸèƒ½ï¼š

<span class="hljs-bullet">*</span> å®ç°ç½‘ç»œå¹³å°è§„èŒƒï¼ˆå¦‚HTMLæ ‡å‡†ï¼‰ï¼ŒåŒ…æ‹¬DOMã€CSSå’ŒWeb IDL
<span class="hljs-bullet">*</span> åµŒå…¥V8å¼•æ“å¹¶è¿è¡ŒJavaScript
<span class="hljs-bullet">*</span> ä»åº•å±‚ç½‘ç»œæ ˆè¯·æ±‚èµ„æº
<span class="hljs-bullet">*</span> <span class="hljs-strong">**æ„å»ºDOMæ ‘**</span>
<span class="hljs-bullet">*</span> <span class="hljs-strong">**è®¡ç®—æ ·å¼å’Œå¸ƒå±€**</span>
<span class="hljs-bullet">*</span> <span class="hljs-strong">**åµŒå…¥Chrome Compositorå¹¶ç»˜åˆ¶å›¾å½¢**</span>
</code></pre>
<h3 data-id="heading-2">2. <strong>å¤šè¿›ç¨‹æ¸²æŸ“ç®¡é“</strong></h3>
<p>Chromium é‡‡ç”¨å¤šè¿›ç¨‹æ¶æ„ï¼š</p>
<ul>
<li><strong>Browser Process (æµè§ˆå™¨è¿›ç¨‹)</strong>ï¼šç®¡ç†ç”¨æˆ·äº¤äº’ã€ç½‘ç»œè¯·æ±‚ã€æ‰“å°ç­‰</li>
<li><strong>Renderer Process (æ¸²æŸ“è¿›ç¨‹)</strong>ï¼šåœ¨æ²™ç®±ä¸­è¿è¡Œï¼Œæ‰§è¡Œ Blink å¼•æ“è¿›è¡Œé¡µé¢æ¸²æŸ“</li>
<li><strong>Compositor Process</strong>ï¼šè´Ÿè´£æœ€ç»ˆçš„å›¾å½¢åˆæˆå’Œæ˜¾ç¤º</li>
</ul>
<h3 data-id="heading-3">3. <strong>æ¸²æŸ“æµç¨‹çš„å…³é”®æ­¥éª¤</strong></h3>
<h4 data-id="heading-4">a. <strong>é¡µé¢åŠ è½½ä¸DOMæ„å»º</strong></h4>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-comment">// PrintRenderFrameHelper å¤„ç†æ¸²æŸ“ç›¸å…³çš„å·¥ä½œ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PrintRenderFrameHelper</span>
    : <span class="hljs-keyword">public</span> blink::WebPrintClient,
      <span class="hljs-keyword">public</span> content::RenderFrameObserver {
  <span class="hljs-comment">// ä¸ºæ‰“å°å‡†å¤‡é¡µé¢æ¡†æ¶</span>
  <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">OnFramePreparedForPrintPages</span><span class="hljs-params">()</span></span>;
  <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">PrintPages</span><span class="hljs-params">()</span></span>;
  <span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">RenderPagesForPrint</span><span class="hljs-params">(blink::WebLocalFrame* frame,
                           <span class="hljs-type">const</span> blink::WebNode&amp; node)</span></span>;
};
</code></pre>
<h4 data-id="heading-5">b. <strong>è®¡ç®—å¸ƒå±€ä¸æ ·å¼</strong></h4>
<p>Blink å¼•æ“åœ¨ DOM æ ‘æ„å»ºåï¼Œè®¡ç®—æ¯ä¸ªå…ƒç´ çš„æ ·å¼ï¼ˆCSSï¼‰å¹¶ç¡®å®šå…¶åœ¨é¡µé¢ä¸­çš„ä½ç½®å’Œå¤§å°ã€‚</p>
<h4 data-id="heading-6">c. <strong>ç»˜åˆ¶ï¼ˆPaintï¼‰ä¸æ …æ ¼åŒ–ï¼ˆRasterizationï¼‰</strong></h4>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-comment">// é¡µé¢å†…å®¹æ¸²æŸ“åˆ°ç”»å¸ƒ</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">RenderPageContent</span><span class="hljs-params">(blink::WebLocalFrame* frame,
                       <span class="hljs-type">uint32_t</span> page_index,
                       cc::PaintCanvas* canvas)</span> </span>{
  <span class="hljs-built_in">TRACE_EVENT1</span>(<span class="hljs-string">"print"</span>, <span class="hljs-string">"RenderPageContent"</span>, <span class="hljs-string">"page_index"</span>, page_index);
  frame-&gt;<span class="hljs-built_in">PrintPage</span>(page_index, canvas);
}
</code></pre>
<h4 data-id="heading-7">d. <strong>å›¾å½¢åˆæˆï¼ˆCompositingï¼‰</strong></h4>
<p>Chrome Compositor è´Ÿè´£åˆæˆä¸åŒçš„å›¾å±‚ï¼Œæœ€ç»ˆç”Ÿæˆå¸§ï¼ˆFrameï¼‰ã€‚</p>
<h3 data-id="heading-8">4. <strong>Compositor çš„ä½œç”¨</strong></h3>
<p>Compositor æ˜¯ Chromium çš„å›¾å½¢åˆæˆå™¨ï¼Œç”¨äºï¼š</p>
<ul>
<li>åˆæˆå¤šä¸ªæ¸²æŸ“å±‚</li>
<li>å¤„ç†å¤æ‚çš„å˜æ¢å’Œæ•ˆæœ</li>
<li>ä¼˜åŒ–æ¸²æŸ“æ€§èƒ½</li>
<li>ç®¡ç†ç¡¬ä»¶åŠ é€Ÿæ¸²æŸ“ï¼ˆGPUï¼‰</li>
</ul>
<h3 data-id="heading-9">5. <strong>æ¸²æŸ“å‘¨æœŸï¼ˆFrame Lifecycleï¼‰</strong></h3>
<p>ä¸€ä¸ªå®Œæ•´çš„æ¸²æŸ“å‘¨æœŸåŒ…æ‹¬ï¼š</p>
<pre><code class="hljs">è¾“å…¥äº‹ä»¶ â†’ DOM æ›´æ–° â†’ æ ·å¼è®¡ç®— â†’ å¸ƒå±€è®¡ç®— â†’ ç»˜åˆ¶æ“ä½œ â†’ æ …æ ¼åŒ– â†’ åˆæˆ â†’ æ˜¾ç¤º
</code></pre>
<h3 data-id="heading-10">6. <strong>ä¼˜åŒ–ç­–ç•¥</strong></h3>
<ul>
<li><strong>å¢é‡æ¸²æŸ“</strong>ï¼šåªé‡æ–°æ¸²æŸ“å—å½±å“çš„åŒºåŸŸï¼ˆDirty Regionsï¼‰</li>
<li><strong>åˆ†å±‚æ¸²æŸ“</strong>ï¼šä½¿ç”¨å¤šä¸ªæ¸²æŸ“å±‚æé«˜æ•ˆç‡</li>
<li><strong>GPU åŠ é€Ÿ</strong>ï¼šåˆ©ç”¨ç¡¬ä»¶åŠ é€ŸåŠ å¿«æ¸²æŸ“é€Ÿåº¦</li>
<li><strong>å¼‚æ­¥æ¸²æŸ“</strong>ï¼šå¤šä¸ªè¿›ç¨‹å¹¶è¡Œå¤„ç†ä¸åŒçš„æ¸²æŸ“ä»»åŠ¡</li>
</ul>
<h3 data-id="heading-11">7. <strong>æ€§èƒ½ç›‘æ§</strong></h3>
<p>Chromium å†…ç½®æ€§èƒ½ç›‘æ§ï¼š</p>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-comment">// PDF æ¸²æŸ“çš„æ€§èƒ½æµ‹é‡</span>
<span class="hljs-keyword">if</span> (!first_paint_metric_reported_ &amp;&amp; !client_-&gt;<span class="hljs-built_in">IsPrintPreview</span>()) {
  first_paint_metric_reported_ = <span class="hljs-literal">true</span>;
  base::<span class="hljs-built_in">UmaHistogramMediumTimes</span>(<span class="hljs-string">"PDF.FirstPaintTime"</span>,
                                begin_time - engine_creation_time_);
}
</code></pre>
<h3 data-id="heading-12">æ€»ç»“</h3>
<p>Chromium çš„é¡µé¢æ¸²æŸ“æ˜¯ä¸€ä¸ªå¤æ‚çš„åˆ†é˜¶æ®µè¿‡ç¨‹ï¼š</p>
<ol>
<li><strong>è§£æé˜¶æ®µ</strong>ï¼šè§£æ HTML/CSS/JavaScriptï¼Œæ„å»º DOM å’Œæ ·å¼æ ‘</li>
<li><strong>è®¡ç®—é˜¶æ®µ</strong>ï¼šè®¡ç®—å¸ƒå±€ï¼ˆLayoutï¼‰å’Œæ ·å¼ï¼ˆStyleï¼‰</li>
<li><strong>ç»˜åˆ¶é˜¶æ®µ</strong>ï¼šç”Ÿæˆç»˜åˆ¶æŒ‡ä»¤ï¼ˆPaint Commandsï¼‰</li>
<li><strong>æ …æ ¼åŒ–é˜¶æ®µ</strong>ï¼šå°†ç»˜åˆ¶æŒ‡ä»¤è½¬æ¢ä¸ºåƒç´ æ•°æ®</li>
<li><strong>åˆæˆé˜¶æ®µ</strong>ï¼šåˆæˆå¤šä¸ªå±‚å¹¶é€åˆ°æ˜¾ç¤ºè®¾å¤‡</li>
<li><strong>æ˜¾ç¤ºé˜¶æ®µ</strong>ï¼šåœ¨å±å¹•ä¸Šå±•ç¤ºæœ€ç»ˆç”»é¢</li>
</ol>
<h2 data-id="heading-13">Compositor çš„å®Œæ•´åˆ†å±‚æ¶æ„å’Œæ•°æ®æµ</h2>
<p>æ ¹æ®å®˜æ–¹æ–‡æ¡£ <code>life_of_a_frame.md</code> å’Œä»£ç åˆ†æï¼ŒCompositor åˆ†ä¸ºä»¥ä¸‹ä¸»è¦éƒ¨åˆ†ï¼š</p>
<h3 data-id="heading-14"><strong>1. BeginFrame åè°ƒå±‚ï¼ˆFrame Coordinationï¼‰</strong></h3>
<pre><code class="hljs language-css" lang="css">è¾“å…¥ï¼šæ¥è‡ª <span class="hljs-attribute">Display</span> Compositor çš„ BeginFrame ä¿¡å·
â†“
è¾“å‡ºï¼šBeginFrameArgsï¼ˆåŒ…å«æ—¶é—´æˆ³ã€å¸§å·ç­‰ï¼‰
</code></pre>
<p><strong>èŒè´£ï¼š</strong></p>
<ul>
<li>åŒæ­¥ä¸»çº¿ç¨‹å’Œåˆæˆçº¿ç¨‹çš„å¸§ç”Ÿæˆ</li>
<li>ç®¡ç†å¸§ç‡å’Œå‚ç›´åŒæ­¥</li>
<li>åˆ†å‘ BeginFrame é€šçŸ¥</li>
</ul>
<hr/>
<h3 data-id="heading-15"><strong>2. ä¸»çº¿ç¨‹é˜¶æ®µï¼ˆMain Thread Pipelineï¼‰</strong></h3>
<pre><code class="hljs language-csharp" lang="csharp">BeginFrame
    â†“
[<span class="hljs-meta">1</span>] BeginMainFrame - åˆæˆçº¿ç¨‹è¯·æ±‚ä¸»çº¿ç¨‹æ›´æ–°
    â†“
    è¾“å…¥ï¼šLayerTreeHost é…ç½®ã€ç”¨æˆ·è¾“å…¥ã€åŠ¨ç”»çŠ¶æ€
    è¾“å‡ºï¼šBeginMainFrameAndCommitState
    â†“
[<span class="hljs-meta">2</span>] Animate - ä¸»çº¿ç¨‹æ›´æ–°åŠ¨ç”»
    â†“
    è¾“å…¥ï¼šå½“å‰æ—¶é—´ã€åŠ¨ç”»çŠ¶æ€
    è¾“å‡ºï¼šæ›´æ–°åçš„å±æ€§å€¼
    â†“
[<span class="hljs-meta">3</span>] UpdateLayers - Blink æ‰§è¡Œå¸ƒå±€å’Œç»˜åˆ¶
    â†“
    è¾“å…¥ï¼šDOM æ ‘ã€æ ·å¼æ ‘
    è¾“å‡ºï¼šDisplayItemListï¼ˆç»˜åˆ¶æ“ä½œï¼‰
    â†“
[<span class="hljs-meta">4</span>] Commit - æ¨é€æ”¹å˜åˆ°åˆæˆçº¿ç¨‹
    â†“
    è¾“å…¥ï¼šLayer æ ‘ã€DisplayItemListã€å±æ€§
    è¾“å‡ºï¼šCommitStateï¼ˆåŸå­æ€§æäº¤çŠ¶æ€ï¼‰
</code></pre>
<p><strong>è¯¦ç»†æ­¥éª¤ï¼š</strong></p>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-number">1.</span> Animate Phase
   è¾“å…¥ï¼š<span class="hljs-built_in">LayerAnimationController</span> (cc/animation<span class="hljs-comment">/*)
   è¾“å‡ºï¼šå˜æ¢ã€ä¸é€æ˜åº¦ç­‰å±æ€§çš„æ–°å€¼

2. UpdateLayers Phase  
   è¾“å…¥ï¼šLayer æ ‘ï¼Œç”± Blink é€šè¿‡ LayerTreeHostClient æ¥å£è§¦å‘
   - client_-&gt;UpdateLayerTreeHost()
   - Blink æ‰§è¡Œå¸ƒå±€è®¡ç®—
   - Blink æ‰§è¡Œç»˜åˆ¶ï¼Œäº§ç”Ÿ DisplayItemList
   è¾“å‡ºï¼šæ›´æ–°åçš„ Layer æ ‘å’Œ DisplayItemList

3. Commit Phase
   - PushPropertiesTo()ï¼šæ¯ä¸ª Layer æ¨é€å±æ€§åˆ° LayerImpl
   - äº¤æ¢ Pending Treeï¼ˆå¾…å®šæ ‘ï¼‰å’Œ Active Treeï¼ˆæ´»åŠ¨æ ‘ï¼‰
   - åŒæ­¥åŠ¨ç”»çŠ¶æ€ã€æ»šåŠ¨çŠ¶æ€ç­‰
</span></code></pre>
<hr/>
<h3 data-id="heading-16"><strong>3. åˆæˆçº¿ç¨‹é˜¶æ®µï¼ˆImpl Thread Pipelineï¼‰</strong></h3>
<p>è¿™æ˜¯ Compositor çš„æ ¸å¿ƒï¼Œåˆ†ä¸ºäº”ä¸ªå…³é”®é˜¶æ®µï¼š</p>
<h4 data-id="heading-17"><strong>é˜¶æ®µ 1ï¼šCommit å®Œæˆï¼ˆFinish Commitï¼‰</strong></h4>
<pre><code class="hljs language-markdown" lang="markdown">è¾“å…¥ï¼šCommitState
<span class="hljs-bullet">    -</span> Layer æ ‘ç»“æ„å’Œå±æ€§
<span class="hljs-bullet">    -</span> DisplayItemList
<span class="hljs-bullet">    -</span> Scroll çŠ¶æ€
<span class="hljs-bullet">    -</span> åŠ¨ç”»æ•°æ®
<span class="hljs-code">    
å¤„ç†ï¼š
    - FinishCommit()ï¼šåˆæˆçº¿ç¨‹æ¥æ”¶æäº¤çš„çŠ¶æ€
    - æ›´æ–° LayerImpl æ ‘
    - æ›´æ–°å±æ€§æ ‘ï¼ˆTransform Treeã€Clip Tree ç­‰ï¼‰
    
è¾“å‡ºï¼šLayerTreeImplï¼ˆåˆæˆçº¿ç¨‹çš„æ´»åŠ¨æ ‘ï¼‰
</span></code></pre>
<h4 data-id="heading-18"><strong>é˜¶æ®µ 2ï¼šPrepare Tilesï¼ˆå‡†å¤‡ç“¦ç‰‡ï¼‰</strong></h4>
<pre><code class="hljs language-scss" lang="scss">è¾“å…¥ï¼šLayerTreeImplã€æ˜¾ç¤ºè§†å£ã€ç¼©æ”¾å› å­

å¤„ç†ï¼š
    - <span class="hljs-built_in">CalculateRasterScales</span>()ï¼šè®¡ç®—æ¯ä¸ªå±‚çš„æ …æ ¼åŒ–ç¼©æ”¾
    - <span class="hljs-built_in">PrepareTiles</span>()ï¼š
        â”œâ”€ <span class="hljs-built_in">CalculateLiveRects</span>()ï¼šè®¡ç®—å¯è§ç“¦ç‰‡èŒƒå›´
        â”œâ”€ <span class="hljs-built_in">AssignGpuMemoryToTiles</span>()ï¼šåˆ†é… GPU å†…å­˜é¢„ç®—
        â””â”€ <span class="hljs-built_in">ScheduleRasterTasks</span>()ï¼šå®‰æ’æ …æ ¼åŒ–ä»»åŠ¡é˜Ÿåˆ—
    
    - TileManager çš„èŒè´£ï¼š
        â”œâ”€ ä¼˜å…ˆçº§æ’åºï¼ˆè§†å£å†… &gt; è§†å£å¤–ï¼‰
        â”œâ”€ ç®¡ç†è½¯ä»¶å’Œ GPU æ …æ ¼åŒ–
        â”œâ”€ ç®¡ç†å›¾åƒè§£ç 
        â””â”€ ç®¡ç†è›‹ç³•å±‚ï¼ˆcake layersï¼‰

è¾“å‡ºï¼šRaster Tasksï¼ˆæ …æ ¼åŒ–ä»»åŠ¡é˜Ÿåˆ—ï¼‰
    - æ¯ä¸ªä»»åŠ¡æ˜¯ï¼š(Tile, RasterSource, Priority)
</code></pre>
<h4 data-id="heading-19"><strong>é˜¶æ®µ 3ï¼šRasterizationï¼ˆæ …æ ¼åŒ–ï¼‰</strong></h4>
<pre><code class="hljs language-markdown" lang="markdown">è¾“å…¥ï¼šRaster Tasks
<span class="hljs-bullet">    -</span> RasterSourceï¼ˆDisplayItemList çš„åŒ…è£…ï¼‰
<span class="hljs-bullet">    -</span> ç›®æ ‡ï¿½ï¿½ç‰‡å¤§å°
<span class="hljs-bullet">    -</span> ç¼©æ”¾å› å­
<span class="hljs-bullet">    -</span> æ …æ ¼åŒ–ä½ç½®

å¤„ç†è¿‡ç¨‹ï¼ˆåœ¨å·¥ä½œçº¿ç¨‹æ‰§è¡Œï¼‰ï¼š

<span class="hljs-bullet">    1.</span> PaintOpBuffer Playback
<span class="hljs-code">       è¾“å…¥ï¼šDisplayItemList ä¸­çš„ PaintOps
       å¤„ç†ï¼š
           - GetOffsetsOfOpsToRaster()ï¼šä½¿ç”¨ R-Tree æŸ¥è¯¢éœ€è¦çš„æ“ä½œ
           - åˆ›å»º SkCanvasï¼ˆCPU æˆ– GPUï¼‰
           - éå†ç›¸å…³ PaintOpsï¼Œè°ƒç”¨ Raster()
       è¾“å‡ºï¼šåƒç´ æ•°æ®æˆ– GPU å‘½ä»¤
    
    2. Software Rasterï¼ˆè½¯ä»¶æ …æ ¼åŒ–ï¼‰
       è¾“å…¥ï¼šPaintOpsï¼Œè¾“å‡ºå¤§å°
       å¤„ç†ï¼š
           - åœ¨å†…å­˜ä¸­åˆ›å»ºä½å›¾
           - ä½¿ç”¨ Skia çš„ CPU åç«¯ç»˜åˆ¶
           - ä½¿ç”¨ SIMD ä¼˜åŒ–
       è¾“å‡ºï¼šSkBitmapï¼ˆCPU å†…å­˜ä¸­çš„åƒç´ ï¼‰
    
    3. GPU Rasterï¼ˆGPU æ …æ ¼åŒ–ï¼‰
       è¾“å…¥ï¼šPaintOpsï¼ŒGPU ä¸Šä¸‹æ–‡
       å¤„ç†ï¼š
           - åºåˆ—åŒ– PaintOps
           - é€šè¿‡ RasterInterface å‘é€åˆ° GPU
           - GPU å‘½ä»¤ç¼“å†²åŒºæ‰§è¡Œç»˜åˆ¶
           - Skia çš„ GPU åç«¯ï¼ˆGaneshï¼‰å¤„ç†
       è¾“å‡ºï¼šGPU çº¹ç†èµ„æº
</span>
è¾“å‡ºï¼šRasterized Tiles
<span class="hljs-bullet">    -</span> åŒ…å«åƒç´ æ•°æ®ï¼ˆè½¯ä»¶ï¼‰æˆ– GPU çº¹ç†ï¼ˆGPUï¼‰
</code></pre>
<p><strong>å…³é”®ç±»å’Œå‡½æ•°ï¼š</strong></p>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-comment">// RasterSourceï¼šDisplayItemList çš„åŒ…è£…ï¼Œæä¾›æ …æ ¼åŒ–æ¥å£</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RasterSource</span> {
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">PlaybackToCanvas</span><span class="hljs-params">(
        SkCanvas* raster_canvas,
        <span class="hljs-type">const</span> gfx::Rect&amp; canvas_bitmap_rect,  <span class="hljs-comment">// ç›®æ ‡ä½ç½®</span>
        <span class="hljs-type">const</span> gfx::AxisTransform2d&amp; raster_transform,  <span class="hljs-comment">// ç¼©æ”¾</span>
        <span class="hljs-type">const</span> PlaybackSettings&amp; settings)</span></span>;
};

<span class="hljs-comment">// TileManagerï¼šåè°ƒæ …æ ¼åŒ–</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">TileManager</span> {
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">PrepareTiles</span><span class="hljs-params">(<span class="hljs-type">const</span> PrepareTilesParams&amp; params)</span></span>;
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">ScheduleRasterTasks</span><span class="hljs-params">()</span></span>;
};

<span class="hljs-comment">// DisplayItemListï¼šåŒ…å« PaintOps</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DisplayItemList</span> {
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Raster</span><span class="hljs-params">(SkCanvas* canvas, <span class="hljs-type">const</span> PlaybackParams&amp; params)</span></span>;
    <span class="hljs-function">std::vector&lt;<span class="hljs-type">size_t</span>&gt; <span class="hljs-title">OffsetsOfOpsToRaster</span><span class="hljs-params">(SkCanvas* canvas)</span></span>;
};
</code></pre>
<h4 data-id="heading-20"><strong>é˜¶æ®µ 4ï¼šActivationï¼ˆæ¿€æ´»ï¼‰</strong></h4>
<pre><code class="hljs language-scss" lang="scss">è¾“å…¥ï¼šPending Treeï¼ˆå¾…å®šæ ‘ï¼Œå·²æ …æ ¼åŒ–ï¼‰

å¤„ç†ï¼š
    - <span class="hljs-built_in">WaitForAllTilesToRasterize</span>()ï¼šç­‰å¾…æ‰€æœ‰å…³é”®ç“¦ç‰‡æ …æ ¼åŒ–å®Œæˆ
    - <span class="hljs-built_in">ActivatePendingTree</span>()ï¼š
        â”œâ”€ Pending Tree â†’ Active Tree
        â”œâ”€ æ›´æ–°åŠ¨ç”»çŠ¶æ€
        â”œâ”€ æ›´æ–°é¡µé¢ç¼©æ”¾
        â””â”€ æ¸…ç©ºå·²å®Œæˆçš„æ …æ ¼åŒ–é˜Ÿåˆ—
    
è¾“å‡ºï¼šActive Treeï¼ˆå·²æ¿€æ´»çš„æ ‘ï¼Œå¯ç”¨äºç»˜åˆ¶ï¼‰
</code></pre>
<h4 data-id="heading-21"><strong>é˜¶æ®µ 5ï¼šDraw Frameï¼ˆç»˜åˆ¶å¸§ï¼‰</strong></h4>
<pre><code class="hljs language-scss" lang="scss">è¾“å…¥ï¼šActive Treeã€BeginFrameArgs

å¤„ç†ï¼š
    <span class="hljs-number">1</span>. <span class="hljs-built_in">CalculateDrawProperties</span>()
       è¾“å…¥ï¼šActive Treeã€è§†å£ã€è®¾å¤‡ç¼©æ”¾å› å­
       è®¡ç®—ï¼š
           - æ¯ä¸ªå±‚çš„æœ€ç»ˆå˜æ¢çŸ©é˜µ
           - å‰ªè£åŒºåŸŸ
           - å¯è§èŒƒå›´
       è¾“ï¿½ï¿½ï¿½ï¼šDrawPropertiesï¼ˆæ¯ä¸ª LayerImpl éƒ½æœ‰ï¼‰
    
    <span class="hljs-number">2</span>. <span class="hljs-built_in">GenerateCompositorFrame</span>()
       è¾“å…¥ï¼šActive Tree with DrawProperties
       å¤„ç†ï¼š
           - éå† Layer æ ‘ï¼Œç”Ÿæˆ Quadsï¼ˆå››è¾¹å½¢ï¼‰
           - æ¯ä¸ª Quad åŒ…å«ï¼š
               â”œâ”€ çº¹ç†/èµ„æº ID
               â”œâ”€ å˜æ¢çŸ©é˜µ
               â”œâ”€ å‰ªè£åŒºåŸŸ
               â”œâ”€ ä¸é€æ˜åº¦
               â””â”€ æ··åˆæ¨¡å¼
           - ä¸ºæ¯ä¸ª Quad åˆ›å»º RenderPass
           - è®¾ç½®ç»„åˆå¸§å…ƒæ•°æ®
       è¾“å‡ºï¼šCompositorFrame
    
    <span class="hljs-number">3</span>. CompositorFrame ç»“æ„
       viz::CompositorFrame {
           vector&lt;RenderPass&gt;ï¼š
               - RenderPass<span class="hljs-selector-attr">[0]</span>ï¼šç¬¬ä¸€ä¸ªç¦»å±æ¸²æŸ“ç›®æ ‡
               - RenderPass<span class="hljs-selector-attr">[1]</span>ï¼šç¬¬äºŒä¸ªç¦»å±æ¸²æŸ“ç›®æ ‡
               - ...
               - RenderPass<span class="hljs-selector-attr">[N]</span>ï¼šæœ€åä¸€ä¸ªè¾“å‡ºåˆ°æ˜¾ç¤ºå™¨çš„æ¸²æŸ“é€šé“
           
           vector&lt;TransferableResource&gt;ï¼šå¼•ç”¨çš„ GPU çº¹ç†
           CompositorFrameMetadataï¼šå…ƒæ•°æ®
               - frame_tokenï¼šå¸§æ ‡è¯†ç¬¦
               - device_scale_factorï¼šè®¾å¤‡åƒç´ æ¯”
               - latency_infoï¼šæ€§èƒ½æŒ‡æ ‡
               - presentation_tokenï¼šå±•ç¤ºä»¤ç‰Œ
       }

è¾“å‡ºï¼šCompositorFrameï¼ˆåŒ…å«æ‰€æœ‰ç»˜åˆ¶æŒ‡ä»¤ï¼‰
</code></pre>
<hr/>
<h3 data-id="heading-22"><strong>4. Frame Sink &amp; Vizï¼ˆæ˜¾ç¤ºåˆæˆå™¨ï¼‰</strong></h3>
<pre><code class="hljs language-scss" lang="scss">è¾“å…¥ï¼šCompositorFrame

å¤„ç†ï¼š
    <span class="hljs-number">1</span>. <span class="hljs-built_in">SubmitCompositorFrame</span>()
       - éªŒè¯èµ„æºæœ‰æ•ˆæ€§
       - åŒæ­¥ä»¤ç‰Œå¤„ç†
       - å¸§ä»¤ç‰Œç”Ÿæˆ
    
    <span class="hljs-number">2</span>. Viz å¤„ç†ï¼ˆviz/service/<span class="hljs-attribute">display</span>/ï¼‰
       - <span class="hljs-built_in">AggregateSurfaces</span>()ï¼šåˆæˆå¤šä¸ª Surface
       - <span class="hljs-built_in">ApplyFilters</span>()ï¼šåº”ç”¨æ»¤é•œæ•ˆæœ
       - <span class="hljs-built_in">Rasterize</span>()ï¼šæœ€åæ …æ ¼åŒ–ï¼ˆå¦‚æœéœ€è¦ï¼‰
       - <span class="hljs-built_in">GenerateDamageRect</span>()ï¼šè®¡ç®—è„åŒºåŸŸ
    
    <span class="hljs-number">3</span>. <span class="hljs-attribute">Display</span> åˆæˆ
       - å°†å¤šä¸ªæ¥æºçš„å¸§åˆæˆåˆ°æœ€ç»ˆè¾“å‡ºè¡¨é¢
       - åº”ç”¨å˜æ¢å’Œæ•ˆæœ

è¾“å‡ºï¼šæœ€ç»ˆçš„å±å¹•æ˜¾ç¤ºå†…å®¹
</code></pre>
<hr/>
<h3 data-id="heading-23"><strong>æ•´ä½“æ•°æ®æµå›¾</strong></h3>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    <span class="hljs-selector-tag">MAIN</span> THREAD (ä¸»çº¿ç¨‹)                          â”‚
â”‚                                                                   â”‚
â”‚  Layer Tree    BeginMainFrame                                   â”‚
â”‚      â”‚         Animate                                          â”‚
â”‚      â”‚         UpdateLayers (Blink Layout &amp; Paint)              â”‚
â”‚      â”‚         â†’ DisplayItemList (PaintOps)                     â”‚
â”‚      â”‚                                                           â”‚
â”‚      â””â”€â”€â†’ Commit (PushPropertiesTo)                            â”‚
â”‚           CommitState â”€â”€â”€â”€â”€â”                                    â”‚
â”‚                            â”‚                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  ProxyImpl Bridge  â”‚
                    â”‚  (Main â†” Impl)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               COMPOSITOR THREAD (åˆæˆçº¿ç¨‹)                       â”‚
â”‚                                                                   â”‚
â”‚  <span class="hljs-number">1</span>. <span class="hljs-built_in">FinishCommit</span>()                                              â”‚
â”‚     CommitState â†’ LayerTreeImpl                                  â”‚
â”‚     æ›´æ–° LayerImpl æ ‘ã€å±æ€§æ ‘                                      â”‚
â”‚                                                                   â”‚
â”‚  <span class="hljs-number">2</span>. <span class="hljs-built_in">PrepareTiles</span>()  â—„â”€ Scheduler è°ƒåº¦                           â”‚
â”‚     â”œâ”€ è®¡ç®—æ …æ ¼åŒ–ç¼©æ”¾                                             â”‚
â”‚     â”œâ”€ åˆ†é… GPU å†…å­˜                                             â”‚
â”‚     â””â”€ ç”Ÿæˆ RasterTasks é˜Ÿåˆ—                                    â”‚
â”‚            â”‚                                                    â”‚
â”‚            â–¼ (Post to Worker Threads)                          â”‚
â”‚
â”‚  <span class="hljs-number">3</span>. Rasterization (Worker Threads)                             â”‚
â”‚     â”œâ”€ Software: DisplayItemList â†’ SkBitmap                    â”‚
â”‚     â””â”€ GPU: PaintOps â†’ GPU Textures                            â”‚
â”‚            â”‚                                                    â”‚
â”‚            â–¼                                                    â”‚
â”‚
â”‚  <span class="hljs-number">4</span>. <span class="hljs-built_in">Activation</span>()  â—„â”€ Scheduler è°ƒåº¦                            â”‚
â”‚     Pending Tree (Rasterized) â†’ Active Tree                    â”‚
â”‚                                                                   â”‚
â”‚  <span class="hljs-number">5</span>. <span class="hljs-built_in">DrawFrame</span>() / <span class="hljs-built_in">GenerateCompositorFrame</span>()                     â”‚
â”‚     â”œâ”€ <span class="hljs-built_in">CalculateDrawProperties</span>()                               â”‚
â”‚     â”œâ”€ <span class="hljs-built_in">BuildQuads</span>()                                            â”‚
â”‚     â”œâ”€ ç”Ÿæˆ RenderPass åˆ—è¡¨                                     â”‚
â”‚     â””â”€ è¾“å‡º CompositorFrame                                    â”‚
â”‚            â”‚                                                    â”‚
â”‚            â–¼                                                    â”‚
â”‚
â”‚  <span class="hljs-built_in">SubmitCompositorFrame</span>(frame)                                  â”‚
â”‚            â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  LayerTreeFrameSink â”‚
    â”‚  (GPU Channel)      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               VIZ DISPLAY COMPOSITOR (æ˜¾ç¤ºåˆæˆå™¨)              â”‚
â”‚                                                                  â”‚
â”‚  <span class="hljs-number">1</span>. <span class="hljs-built_in">MaybeSubmitCompositorFrame</span>()                               â”‚
â”‚     - éªŒè¯å¸§                                                    â”‚
â”‚     - åº”ç”¨åŒæ­¥ä»¤ç‰Œ                                               â”‚
â”‚                                                                  â”‚
â”‚  <span class="hljs-number">2</span>. <span class="hljs-built_in">AggregateSurfaces</span>()                                        â”‚
â”‚     - å¤šä¸ª Surface åˆæˆ                                         â”‚
â”‚     - Z-order æ’åº                                             â”‚
â”‚                                                                  â”‚
â”‚  <span class="hljs-number">3</span>. Display::<span class="hljs-built_in">Draw</span>()                                            â”‚
â”‚     - GPU é©±åŠ¨ç¨‹åºæŒ‡ä»¤                                          â”‚
â”‚     - åº”ç”¨æ»¤é•œå’Œæ•ˆæœ                                             â”‚
â”‚                                                                  â”‚
â”‚  <span class="hljs-number">4</span>. Swap &amp; Present                                            â”‚
â”‚     - ç¼“å†²äº¤æ¢ (Backbuffer â†’ Frontbuffer)                      â”‚
â”‚     - VSync åŒæ­¥                                               â”‚
â”‚     - æ˜¾ç¤ºå™¨æ˜¾ç¤º                                                 â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h3 data-id="heading-24"><strong>å…³é”®æ¦‚å¿µæ€»ç»“è¡¨</strong></h3>











































































<table><thead><tr><th>é˜¶æ®µ</th><th>è¾“å…¥</th><th>å¤„ç†å™¨</th><th>è¾“å‡º</th><th>æ‰§è¡Œçº¿ç¨‹</th></tr></thead><tbody><tr><td><strong>Animate</strong></td><td>AnimationState</td><td>LayerAnimationController</td><td>å±æ€§å€¼</td><td>Main</td></tr><tr><td><strong>UpdateLayers</strong></td><td>DOM æ ‘ã€æ ·å¼</td><td>Blink</td><td>DisplayItemList</td><td>Main</td></tr><tr><td><strong>Commit</strong></td><td>Layer æ ‘</td><td>LayerTreeHost</td><td>CommitState</td><td>Mainâ†’Impl</td></tr><tr><td><strong>FinishCommit</strong></td><td>CommitState</td><td>LayerTreeHostImpl</td><td>LayerTreeImpl</td><td>Impl</td></tr><tr><td><strong>PrepareTiles</strong></td><td>LayerTreeImpl</td><td>TileManager</td><td>RasterTasks</td><td>Impl</td></tr><tr><td><strong>Rasterization</strong></td><td>RasterTasks</td><td>RasterWorkerPool</td><td>GPU çº¹ç†/ä½å›¾</td><td>Worker</td></tr><tr><td><strong>Activation</strong></td><td>Pending Tree</td><td>LayerTreeHostImpl</td><td>Active Tree</td><td>Impl</td></tr><tr><td><strong>DrawFrame</strong></td><td>Active Tree</td><td>LayerTreeHostImpl</td><td>CompositorFrame</td><td>Impl</td></tr><tr><td><strong>Display</strong></td><td>CompositorFrame</td><td>DisplayCompositor</td><td>å±å¹•è¾“å‡º</td><td>Display</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-25"><strong>ProxyMain/ProxyImpl çš„è§’è‰²</strong></h3>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-built_in">ProxyMain</span> (ä¸»çº¿ç¨‹)
â”œâ”€ è´Ÿè´£ä¸ä¸»çº¿ç¨‹é€šä¿¡
â”œâ”€ æ¥æ”¶ BeginMainFrame ä¿¡å·
â”œâ”€ ç®¡ç† CommitPipelineStage
â””â”€ å›è°ƒä¸»çº¿ç¨‹ç»“æœ

<span class="hljs-built_in">ProxyImpl</span> (åˆæˆçº¿ç¨‹)
â”œâ”€ è´Ÿè´£ä¸åˆæˆçº¿ç¨‹é€šä¿¡
â”œâ”€ æ§åˆ¶ Scheduler
â”œâ”€ ç®¡ç† LayerTreeHostImpl
â””â”€ æäº¤ CompositorFrame åˆ° LayerTreeFrameSink
</code></pre>
<h2 data-id="heading-26">Compositor å®Œæ•´ç¤ºä¾‹ï¼šç»˜åˆ¶ä¸€ä¸ªè“è‰²æ­£æ–¹å½¢</h2>
<p>è®©æˆ‘ä»¬å‡è®¾è¦åœ¨ç½‘é¡µä¸Šç»˜åˆ¶ä¸€ä¸ª<strong>è“è‰²çš„ 200Ã—200 åƒç´ æ­£æ–¹å½¢ï¼Œä½ç½®åœ¨ (100, 100)</strong>ã€‚</p>
<h3 data-id="heading-27"><strong>ç¬¬1æ­¥ï¼šä¸»çº¿ç¨‹ - Blink è®°å½•ç»˜åˆ¶æ“ä½œ</strong></h3>
<p>ç”¨æˆ·åœ¨ HTML/CSS ä¸­å†™äº†ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"
  width: 200px;
  height: 200px;
  background-color: blue;
  position: absolute;
  top: 100px;
  left: 100px;
"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>Blink å¸ƒå±€å®Œæˆåï¼ŒçŸ¥é“è¦ç»˜åˆ¶ï¼š</p>
<ul>
<li>ä½ç½®ï¼š(100, 100)</li>
<li>å¤§å°ï¼š200Ã—200</li>
<li>é¢œè‰²ï¼šè“è‰² RGB(0, 0, 255)</li>
</ul>
<p>ç„¶åå®ƒåˆ›å»ºä¸€ä¸ª <strong>DisplayItemList</strong> æ¥è®°å½•è¿™ä¸ªç»˜åˆ¶æ“ä½œï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// Blink åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œ</span>
<span class="hljs-keyword">auto</span> display_list = base::<span class="hljs-built_in">MakeRefCounted</span>&lt;cc::DisplayItemList&gt;();

display_list-&gt;<span class="hljs-built_in">StartPaint</span>();

<span class="hljs-comment">// 1. ä¿å­˜å›¾å½¢çŠ¶æ€</span>
display_list-&gt;<span class="hljs-built_in">push</span>&lt;cc::SaveOp&gt;();

<span class="hljs-comment">// 2. ç»˜åˆ¶è“è‰²æ­£æ–¹å½¢</span>
cc::PaintFlags blue_flags;
blue_flags.<span class="hljs-built_in">setColor</span>(SK_ColorBLUE);  <span class="hljs-comment">// RGB(0, 0, 255)</span>
blue_flags.<span class="hljs-built_in">setStyle</span>(SkPaint::kFill_Style);

display_list-&gt;<span class="hljs-built_in">push</span>&lt;cc::DrawRectOp&gt;(
    SkRect::<span class="hljs-built_in">MakeXYWH</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">200</span>, <span class="hljs-number">200</span>),  <span class="hljs-comment">// x, y, width, height</span>
    blue_flags
);

<span class="hljs-comment">// 3. æ¢å¤å›¾å½¢çŠ¶æ€</span>
display_list-&gt;<span class="hljs-built_in">push</span>&lt;cc::RestoreOp&gt;();

display_list-&gt;<span class="hljs-built_in">EndPaintOfUnpaired</span>(gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">200</span>, <span class="hljs-number">200</span>));

<span class="hljs-comment">// å®Œæˆè®°å½•</span>
display_list-&gt;<span class="hljs-built_in">Finalize</span>();

<span class="hljs-comment">// æ­¤æ—¶ DisplayItemList å†…éƒ¨åŒ…å«ï¼š</span>
<span class="hljs-comment">// </span>
<span class="hljs-comment">// paint_op_buffer_ = [</span>
<span class="hljs-comment">//   SaveOp,</span>
<span class="hljs-comment">//   DrawRectOp(x=100, y=100, w=200, h=200, color=blue),</span>
<span class="hljs-comment">//   RestoreOp</span>
<span class="hljs-comment">// ]</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// visual_rects_ = [</span>
<span class="hljs-comment">//   {100, 100, 200, 200},  // SaveOp çš„å¯è§†èŒƒå›´</span>
<span class="hljs-comment">//   {100, 100, 200, 200},  // DrawRectOp çš„å¯è§†èŒƒå›´</span>
<span class="hljs-comment">//   {100, 100, 200, 200}   // RestoreOp çš„å¯è§†èŒƒå›´</span>
<span class="hljs-comment">// ]</span>
</code></pre>
<p><strong>è¿™ä¸ªé˜¶æ®µçš„è¾“å‡ºï¼š</strong> ä¸€ä¸ªåŒ…å«"ç»˜åˆ¶æŒ‡ä»¤"çš„å¯¹è±¡ï¼Œè¯´æ˜è¦åœ¨ (100,100) ä½ç½®ç»˜åˆ¶ä¸€ä¸ª 200Ã—200 çš„è“è‰²çŸ©å½¢ã€‚<strong>ä½†è¿™åªæ˜¯æŒ‡ä»¤ï¼Œè¿˜æ²¡æœ‰çœŸæ­£çš„åƒç´ æ•°æ®ï¼</strong></p>
<hr/>
<h3 data-id="heading-28"><strong>ç¬¬2æ­¥ï¼šæäº¤åˆ°åˆæˆçº¿ç¨‹</strong></h3>
<p>ä¸»çº¿ç¨‹æŠŠ DisplayItemList åŒ…è£…åœ¨ <strong>CommitState</strong> ä¸­ï¼Œå‘é€ç»™åˆæˆçº¿ç¨‹ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ä¸»çº¿ç¨‹åˆ›å»º CommitState</span>
<span class="hljs-keyword">auto</span> commit_state = std::<span class="hljs-built_in">make_unique</span>&lt;CommitState&gt;();

<span class="hljs-comment">// æŠŠ DisplayItemList åˆ†é…ç»™å¯¹åº”çš„ Layer</span>
<span class="hljs-comment">// (åœ¨å®é™…ä»£ç ä¸­ï¼ŒDisplayItemList è¢«å­˜å‚¨åœ¨ PictureLayerImpl ä¸­)</span>
commit_state-&gt;source_frame_number = <span class="hljs-number">120</span>;
commit_state-&gt;device_viewport_rect = gfx::<span class="hljs-built_in">Size</span>(<span class="hljs-number">1920</span>, <span class="hljs-number">1080</span>);
commit_state-&gt;device_scale_factor = <span class="hljs-number">1.0f</span>;  <span class="hljs-comment">// å‡è®¾æ™®é€šå±å¹•</span>
commit_state-&gt;background_color = SK_ColorWHITE;

<span class="hljs-comment">// æ¨é€åˆ°åˆæˆçº¿ç¨‹</span>
layer_tree_host_-&gt;<span class="hljs-built_in">WillCommit</span>(...)
<span class="hljs-comment">// ...</span>
layer_tree_host_-&gt;<span class="hljs-built_in">ActivateCommitState</span>()  <span class="hljs-comment">// åŸå­æ€§æ¨é€</span>
</code></pre>
<p><strong>è¿™ä¸ªé˜¶æ®µçš„è¾“å‡ºï¼š</strong> CommitState å¯¹è±¡ï¼ŒåŒ…å«æ‰€æœ‰éœ€è¦çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ DisplayItemListã€‚</p>
<hr/>
<h3 data-id="heading-29"><strong>ç¬¬3æ­¥ï¼šåˆæˆçº¿ç¨‹ - å‡†å¤‡æ …æ ¼åŒ–</strong></h3>
<p>åˆæˆçº¿ç¨‹æ”¶åˆ° CommitStateï¼Œå¼€å§‹å‡†å¤‡æ …æ ¼åŒ–ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// åˆæˆçº¿ç¨‹ä¸Š</span>
LayerTreeHostImpl* host_impl = ...;

<span class="hljs-comment">// 1. æ¥æ”¶ CommitStateï¼Œæ›´æ–° LayerTreeImpl</span>
host_impl-&gt;<span class="hljs-built_in">FinishCommit</span>(commit_state);

<span class="hljs-comment">// 2. å‡†å¤‡ç“¦ç‰‡ï¼ˆTilesï¼‰</span>
TileManager* tile_manager = host_impl-&gt;<span class="hljs-built_in">tile_manager</span>();
tile_manager-&gt;<span class="hljs-built_in">PrepareTiles</span>();

<span class="hljs-comment">// è¿™ä¼šä¸º PictureLayerImpl åˆ›å»º Tiles</span>
<span class="hljs-comment">// å› ä¸ºæˆ‘ä»¬çš„æ­£æ–¹å½¢åªæœ‰ 200Ã—200ï¼Œå¯èƒ½åªéœ€è¦ 1 ä¸ª Tile</span>
<span class="hljs-comment">// å‡è®¾ Tile å¤§å°æ˜¯ 256Ã—256</span>

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Tile</span> {
    gfx::Rect rect;           <span class="hljs-comment">// ç“¦ç‰‡åœ¨é¡µé¢ä¸Šçš„ä½ç½®</span>
    RasterSource* source;     <span class="hljs-comment">// æŒ‡å‘ DisplayItemList (åŒ…è£…å)</span>
    <span class="hljs-type">float</span> scale;              <span class="hljs-comment">// æ …æ ¼åŒ–ç¼©æ”¾å› å­</span>
    <span class="hljs-type">int</span> x, y;                 <span class="hljs-comment">// ç“¦ç‰‡çš„ç½‘æ ¼åæ ‡</span>
};

<span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªç“¦ç‰‡</span>
Tile tile0{
    .rect = gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">256</span>, <span class="hljs-number">256</span>),      <span class="hljs-comment">// é¡µé¢åæ ‡</span>
    .source = raster_source,                 <span class="hljs-comment">// åŒ…å«æˆ‘ä»¬çš„ DisplayItemList</span>
    .scale = <span class="hljs-number">1.0f</span>,
    .x = <span class="hljs-number">0</span>,
    .y = <span class="hljs-number">0</span>
};

<span class="hljs-comment">// TileManager ä¼šåˆ›å»ºæ …æ ¼åŒ–ä»»åŠ¡</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">RasterTask</span> {
    Tile* tile;
    RasterSource* raster_source;
    gfx::Rect target_rect;  <span class="hljs-comment">// åœ¨ç“¦ç‰‡ä¸­çš„ä½ç½®</span>
    Priority priority;
};

RasterTask task{
    .tile = &amp;tile0,
    .raster_source = raster_source,
    .target_rect = gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">256</span>, <span class="hljs-number">256</span>),
    .priority = PRIORITY_NOW  <span class="hljs-comment">// è§†å£å†…ï¼Œéœ€è¦ç«‹å³æ …æ ¼åŒ–</span>
};

<span class="hljs-comment">// æäº¤æ …æ ¼åŒ–ä»»åŠ¡ç»™å·¥ä½œçº¿ç¨‹</span>
tile_manager-&gt;<span class="hljs-built_in">ScheduleRasterTasks</span>(&amp;task);
</code></pre>
<p><strong>è¿™ä¸ªé˜¶æ®µçš„è¾“å‡ºï¼š</strong> æ …æ ¼åŒ–ä»»åŠ¡é˜Ÿåˆ—ï¼Œå‘Šè¯‰å·¥ä½œçº¿ç¨‹è¦æ …æ ¼åŒ–å“ªäº›åŒºåŸŸã€‚</p>
<hr/>
<h3 data-id="heading-30"><strong>ç¬¬4æ­¥ï¼šå·¥ä½œçº¿ç¨‹ - æ …æ ¼åŒ–ï¼ˆæœ€å…³é”®çš„éƒ¨åˆ†ï¼ï¼‰</strong></h3>
<p>è¿™æ˜¯æŠŠç»˜åˆ¶æŒ‡ä»¤è½¬æ¢æˆ<strong>å®é™…åƒç´ </strong>çš„åœ°æ–¹ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// å·¥ä½œçº¿ç¨‹ä¸Šæ‰§è¡Œæ …æ ¼åŒ–ä»»åŠ¡</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">RasterWorkerPool::RasterizeTask</span><span class="hljs-params">(<span class="hljs-type">const</span> RasterTask&amp; task)</span> </span>{
    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªç»˜åˆ¶ç›®æ ‡ï¼ˆç”»å¸ƒï¼‰</span>
    <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ª 256Ã—256 çš„ç¼“å†²åŒºï¼Œç”¨æ¥å­˜æ”¾æ …æ ¼åŒ–åçš„åƒç´ </span>
    
    <span class="hljs-comment">// æ–¹æ¡ˆ Aï¼šCPU æ …æ ¼åŒ–ï¼ˆè½¯ä»¶ï¼‰</span>
    <span class="hljs-keyword">if</span> (use_software_raster) {
        <span class="hljs-comment">// åˆ›å»º CPU å†…å­˜ä¸­çš„ä½å›¾</span>
        SkBitmap bitmap;
        bitmap.<span class="hljs-built_in">allocN32Pixels</span>(<span class="hljs-number">256</span>, <span class="hljs-number">256</span>);  <span class="hljs-comment">// 256Ã—256 çš„ 32 ä½ RGBA åƒç´ </span>
        
        <span class="hljs-comment">// åˆ›å»º Skia ï¿½ï¿½å¸ƒï¼ŒæŒ‡å‘è¿™ä¸ªä½å›¾</span>
        <span class="hljs-function">SkCanvas <span class="hljs-title">canvas</span><span class="hljs-params">(bitmap)</span></span>;
        
        <span class="hljs-comment">// ç°åœ¨æˆ‘ä»¬è¦å›æ”¾ DisplayItemList ä¸­çš„ç»˜åˆ¶æŒ‡ä»¤</span>
        RasterSource* source = task.raster_source;
        
        <span class="hljs-comment">// å…³é”®æ­¥éª¤ï¼šå›æ”¾ç»˜åˆ¶æ“ä½œï¼</span>
        source-&gt;<span class="hljs-built_in">PlaybackToCanvas</span>(
            &amp;canvas,                    <span class="hljs-comment">// ç›®æ ‡ç”»å¸ƒ</span>
            gfx::<span class="hljs-built_in">Size</span>(<span class="hljs-number">1920</span>, <span class="hljs-number">1080</span>),      <span class="hljs-comment">// å†…å®¹å¤§å°</span>
            gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">256</span>, <span class="hljs-number">256</span>),  <span class="hljs-comment">// ç“¦ç‰‡åœ¨å†…å®¹ä¸­çš„ä½ç½®</span>
            gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">256</span>, <span class="hljs-number">256</span>),  <span class="hljs-comment">// éœ€è¦æ …æ ¼åŒ–çš„åŒºåŸŸ</span>
            gfx::<span class="hljs-built_in">AxisTransform2d</span>(<span class="hljs-number">1.0f</span>), <span class="hljs-comment">// æ— ç¼©æ”¾</span>
            settings
        );
        
        <span class="hljs-comment">// ç°åœ¨ bitmap ä¸­åŒ…å«äº†æ …æ ¼åŒ–åçš„åƒç´ ï¼</span>
        <span class="hljs-comment">// å…·ä½“æ¥è¯´ï¼š</span>
        <span class="hljs-comment">// - ä½ç½® (100, 100) åˆ° (300, 300) çš„åƒç´ è¢«è®¾ä¸ºè“è‰²</span>
        <span class="hljs-comment">// - å…¶ä»–åƒç´ æ˜¯ç™½è‰²ï¼ˆèƒŒæ™¯è‰²ï¼‰</span>
        
        <span class="hljs-comment">// bitmap çš„å†…å­˜å¸ƒå±€ç¤ºæ„ï¼š</span>
        <span class="hljs-comment">// </span>
        <span class="hljs-comment">// ä½ç½® (0,0) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ (256,0)</span>
        <span class="hljs-comment">//    â”‚ FFFFFF FFFFFF FFFFFF ...</span>
        <span class="hljs-comment">//    â”‚ FFFFFF FFFFFF FFFFFF ...</span>
        <span class="hljs-comment">//    â”‚ ...</span>
        <span class="hljs-comment">//  (100,100) å¼€å§‹</span>
        <span class="hljs-comment">//    â”‚ FFFFFF FFFFFF ...</span>
        <span class="hljs-comment">//    â”‚ ...</span>
        <span class="hljs-comment">//    â”‚ FFFFFF 0000FF 0000FF 0000FF ...  â† è“è‰²åƒç´ ï¼</span>
        <span class="hljs-comment">//    â”‚ FFFFFF 0000FF 0000FF 0000FF ...</span>
        <span class="hljs-comment">//    â”‚ FFFFFF 0000FF 0000FF 0000FF ...</span>
        <span class="hljs-comment">//    â”‚ ...</span>
        <span class="hljs-comment">//  (300,300) ç»“æŸ</span>
        <span class="hljs-comment">//    â”‚ FFFFFF FFFFFF FFFFFF ...</span>
        <span class="hljs-comment">//    â†“</span>
        <span class="hljs-comment">// (256,256)</span>
        
        <span class="hljs-comment">// ä¸Šä¼ åˆ° GPU</span>
        <span class="hljs-built_in">UploadBitmapToGPU</span>(&amp;bitmap, tile);
    }
    
    <span class="hljs-comment">// æ–¹æ¡ˆ Bï¼šGPU æ …æ ¼åŒ–</span>
    <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// åˆ›å»º GPU çº¹ç†ä½œä¸ºæ¸²æŸ“ç›®æ ‡</span>
        <span class="hljs-comment">// å°ºå¯¸ï¼š256Ã—256ï¼Œæ ¼å¼ï¼šRGBA_8888</span>
        GLuint texture = gl::<span class="hljs-built_in">CreateTexture</span>(<span class="hljs-number">256</span>, <span class="hljs-number">256</span>, GL_RGBA8);
        
        <span class="hljs-comment">// ç»‘å®šä¸ºæ¸²æŸ“ç›®æ ‡</span>
        <span class="hljs-built_in">glBindFramebuffer</span>(GL_FRAMEBUFFER, fbo);
        <span class="hljs-built_in">glFramebufferTexture2D</span>(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, 
                               GL_TEXTURE_2D, texture, <span class="hljs-number">0</span>);
        
        <span class="hljs-comment">// æ¸…é™¤èƒŒæ™¯ï¼ˆç™½è‰²ï¼‰</span>
        <span class="hljs-built_in">glClearColor</span>(<span class="hljs-number">1.0f</span>, <span class="hljs-number">1.0f</span>, <span class="hljs-number">1.0f</span>, <span class="hljs-number">1.0f</span>);
        <span class="hljs-built_in">glClear</span>(GL_COLOR_BUFFER_BIT);
        
        <span class="hljs-comment">// åˆ›å»º Skia ç”»å¸ƒï¼ˆç»˜åˆ¶åˆ° GPUï¼‰</span>
        SkSurface* surface = SkSurface::<span class="hljs-built_in">MakeFromBackendTexture</span>(...);
        SkCanvas* canvas = surface-&gt;<span class="hljs-built_in">getCanvas</span>();
        
        <span class="hljs-comment">// å›æ”¾ DisplayItemList çš„ç»˜åˆ¶æ“ä½œ</span>
        <span class="hljs-comment">// è¿™æ¬¡æ˜¯å‘é€ GPU å‘½ä»¤</span>
        DisplayItemList::<span class="hljs-built_in">Raster</span>(canvas, ...);
        
        <span class="hljs-comment">// GPU æ‰§è¡ŒæŒ‡ä»¤ï¼Œåœ¨çº¹ç†ä¸­ç”»å‡ºè“è‰²æ­£æ–¹å½¢</span>
        <span class="hljs-comment">// çº¹ç†å†…å®¹ç°åœ¨æ˜¯ï¼šä½ç½® (100, 100) åˆ° (300, 300) æ˜¯è“è‰²åƒç´ </span>
    }
}
</code></pre>
<p><strong>è¿™ä¸ªé˜¶æ®µå‘ç”Ÿäº†ä»€ä¹ˆï¼š</strong></p>
<ol>
<li><strong>åˆ›å»ºä¸€ä¸ª 256Ã—256 çš„ç¼“å†²åŒº</strong>ï¼ˆå¯ä»¥æ˜¯ CPU å†…å­˜æˆ– GPU çº¹ç†ï¼‰</li>
<li><strong>æ¸…é™¤èƒŒæ™¯</strong>ä¸ºç™½è‰²</li>
<li><strong>å›æ”¾ DisplayItemList</strong> ä¸­çš„ç»˜åˆ¶æŒ‡ä»¤ï¼š
<ul>
<li>SaveOpï¼šä¿å­˜çŠ¶æ€</li>
<li>DrawRectOp(x=100, y=100, w=200, h=200, color=blue)ï¼š<strong>åœ¨åƒç´  (100,100) åˆ° (300,300) ä¹‹é—´å¡«å……è“è‰²</strong></li>
<li>RestoreOpï¼šæ¢å¤çŠ¶æ€</li>
</ul>
</li>
</ol>
<p><strong>å…·ä½“çš„åƒç´ æ•°æ®ç¤ºæ„ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">CPU å†…å­˜ï¼ˆSkBitmapï¼‰æˆ– GPU çº¹ç†çš„å†…å®¹
ï¼ˆæ¯ä¸ªæ–¹å—ä»£è¡¨ä¸€ä¸ªåƒç´ ï¼Œç”¨ 16 è¿›åˆ¶è¡¨ç¤º RGBA é¢œè‰²å€¼ï¼‰

<span class="hljs-attr">y</span>=<span class="hljs-number">0</span>    FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF ... (å…¨æ˜¯ç™½è‰²)
<span class="hljs-attr">y</span>=<span class="hljs-number">1</span>    FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF ...
...
<span class="hljs-attr">y</span>=<span class="hljs-number">99</span>   FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF ...
<span class="hljs-attr">y</span>=<span class="hljs-number">100</span>  FFFFFFFF ... FFFFFFFF <span class="hljs-number">0000</span>FFFF <span class="hljs-number">0000</span>FFFF <span class="hljs-number">0000</span>FFFF ... <span class="hljs-number">0000</span>FFFF FFFFFFFF ...
       ^                      ^ (100,100) è“è‰²å¼€å§‹      ^ (300,100) è“è‰²ç»“æŸ
<span class="hljs-attr">y</span>=<span class="hljs-number">101</span>  FFFFFFFF ... FFFFFFFF <span class="hljs-number">0000</span>FFFF <span class="hljs-number">0000</span>FFFF <span class="hljs-number">0000</span>FFFF ... <span class="hljs-number">0000</span>FFFF FFFFFFFF ...
<span class="hljs-attr">y</span>=<span class="hljs-number">102</span>  FFFFFFFF ... FFFFFFFF <span class="hljs-number">0000</span>FFFF <span class="hljs-number">0000</span>FFFF <span class="hljs-number">0000</span>FFFF ... <span class="hljs-number">0000</span>FFFF FFFFFFFF ...
...
<span class="hljs-attr">y</span>=<span class="hljs-number">299</span>  FFFFFFFF ... FFFFFFFF <span class="hljs-number">0000</span>FFFF <span class="hljs-number">0000</span>FFFF <span class="hljs-number">0000</span>FFFF ... <span class="hljs-number">0000</span>FFFF FFFFFFFF ...
<span class="hljs-attr">y</span>=<span class="hljs-number">300</span>  FFFFFFFF ... FFFFFFFF <span class="hljs-number">0000</span>FFFF <span class="hljs-number">0000</span>FFFF <span class="hljs-number">0000</span>FFFF ... <span class="hljs-number">0000</span>FFFF FFFFFFFF ...
       ^                      ^ (100,300) è“è‰²æœ€åä¸€è¡Œ  ^ (300,300) è“è‰²ç»“æŸ
<span class="hljs-attr">y</span>=<span class="hljs-number">301</span>  FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF ...
...
<span class="hljs-attr">y</span>=<span class="hljs-number">255</span>  FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF ...

å…¶ä¸­ï¼š
- <span class="hljs-attr">FFFFFFFF</span> = ç™½è‰² (RGBA: <span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>)
- <span class="hljs-attr">0000FFFF</span> = è“è‰² (RGBA: <span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>)
</code></pre>
<p><strong>è¿™ä¸ªé˜¶æ®µçš„è¾“å‡ºï¼š</strong> GPU çº¹ç†æˆ–ä½å›¾ï¼ŒåŒ…å« 256Ã—256 ä¸ªåƒç´ çš„å®é™…é¢œè‰²æ•°æ®ã€‚</p>
<hr/>
<h3 data-id="heading-31"><strong>ç¬¬5æ­¥ï¼šåˆæˆçº¿ç¨‹ - ç”Ÿæˆ CompositorFrame</strong></h3>
<p>ç°åœ¨æˆ‘ä»¬æœ‰äº†æ …æ ¼åŒ–åçš„çº¹ç†ï¼Œåˆæˆçº¿ç¨‹åˆ›å»ºæœ€ç»ˆçš„åˆæˆå¸§ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// åˆæˆçº¿ç¨‹</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">LayerTreeHostImpl::GenerateCompositorFrame</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// åˆ›å»º CompositorFrame</span>
    viz::CompositorFrame frame;
    
    <span class="hljs-comment">// è®¾ç½®å…ƒæ•°æ®</span>
    frame.metadata.frame_token = <span class="hljs-number">0x12345</span>;
    frame.metadata.device_scale_factor = <span class="hljs-number">1.0f</span>;
    frame.metadata.size_in_pixels = gfx::<span class="hljs-built_in">Size</span>(<span class="hljs-number">1920</span>, <span class="hljs-number">1080</span>);
    frame.metadata.begin_frame_ack = viz::<span class="hljs-built_in">BeginFrameAck</span>(...);
    
    <span class="hljs-comment">// åˆ›å»ºæ¸²æŸ“é€šé“</span>
    <span class="hljs-keyword">auto</span> render_pass = viz::CompositorRenderPass::<span class="hljs-built_in">Create</span>();
    render_pass-&gt;<span class="hljs-built_in">SetNew</span>(
        viz::<span class="hljs-built_in">CompositorRenderPassId</span>(<span class="hljs-number">1</span>),
        gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1920</span>, <span class="hljs-number">1080</span>),      <span class="hljs-comment">// è¾“å‡ºçŸ©å½¢ï¼ˆæ•´ä¸ªå±å¹•ï¼‰</span>
        gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">200</span>, <span class="hljs-number">200</span>),    <span class="hljs-comment">// è„åŒºåŸŸï¼ˆåªæœ‰æ­£æ–¹å½¢åŒºåŸŸéœ€è¦é‡ç»˜ï¼‰</span>
        gfx::<span class="hljs-built_in">Transform</span>()                   <span class="hljs-comment">// æ— å˜æ¢</span>
    );
    
    <span class="hljs-comment">// æ·»åŠ  Quadï¼ˆçº¹ç†å››è¾¹å½¢ï¼‰</span>
    <span class="hljs-keyword">auto</span> quad = std::<span class="hljs-built_in">make_unique</span>&lt;viz::TextureDrawQuad&gt;();
    
    <span class="hljs-comment">// ä»æ …æ ¼åŒ–ä»»åŠ¡ä¸­è·å–çº¹ç† ID</span>
    ResourceId texture_id = <span class="hljs-number">0x9999</span>;  <span class="hljs-comment">// GPU çº¹ç†çš„å¥æŸ„</span>
    
    quad-&gt;<span class="hljs-built_in">SetNew</span>(
        <span class="hljs-literal">nullptr</span>,  <span class="hljs-comment">// shared_quad_state (å…±äº«çŠ¶æ€)</span>
        gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">256</span>, <span class="hljs-number">256</span>),         <span class="hljs-comment">// Quad åœ¨å±å¹•ä¸Šçš„ä½ç½®ï¼ˆæ³¨æ„ï¼šè¿™æ˜¯ä»¥ç“¦ç‰‡çš„ (0,0) å¼€å§‹ï¼‰</span>
        gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">256</span>, <span class="hljs-number">256</span>),         <span class="hljs-comment">// å¯è§åŒºåŸŸ</span>
        <span class="hljs-literal">false</span>,                              <span class="hljs-comment">// ä¸éœ€è¦æ··åˆ</span>
        texture_id,                         <span class="hljs-comment">// çº¹ç† IDï¼ˆæŒ‡å‘æˆ‘ä»¬æ …æ ¼åŒ–çš„è“è‰²æ­£æ–¹å½¢çº¹ç†ï¼‰</span>
        <span class="hljs-literal">true</span>,                               <span class="hljs-comment">// é¢„ä¹˜ alpha</span>
        gfx::<span class="hljs-built_in">PointF</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>),                 <span class="hljs-comment">// UV å·¦ä¸Šè§’</span>
        gfx::<span class="hljs-built_in">PointF</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>),                 <span class="hljs-comment">// UV å³ä¸‹è§’</span>
        SK_ColorWHITE,                      <span class="hljs-comment">// èƒŒæ™¯è‰²</span>
        {<span class="hljs-number">1.0f</span>, <span class="hljs-number">1.0f</span>, <span class="hljs-number">1.0f</span>, <span class="hljs-number">1.0f</span>}           <span class="hljs-comment">// æ··åˆé¢œè‰²</span>
    );
    
    <span class="hljs-comment">// é‡è¦ï¼å®é™…ä½ç½®éœ€è¦ä»ç“¦ç‰‡åæ ‡è½¬æ¢</span>
    <span class="hljs-comment">// ç“¦ç‰‡ (0,0) å¯¹åº”å±å¹•ä½ç½® (0,0)</span>
    <span class="hljs-comment">// ä½†æˆ‘ä»¬çš„æ­£æ–¹å½¢åœ¨ DisplayItemList ä¸­æ˜¯ (100, 100)</span>
    <span class="hljs-comment">// æ‰€ä»¥æœ€ç»ˆ Quad çš„ rect åº”è¯¥æ˜¯ (100, 100, 200, 200)</span>
    
    <span class="hljs-comment">// æ›´æ­£ï¼š</span>
    quad-&gt;rect = gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">200</span>, <span class="hljs-number">200</span>);  <span class="hljs-comment">// æ­£ç¡®çš„å±å¹•ä½ç½®</span>
    quad-&gt;visible_rect = gfx::<span class="hljs-built_in">Rect</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">200</span>, <span class="hljs-number">200</span>);
    quad-&gt;opacity = <span class="hljs-number">1.0f</span>;
    
    render_pass-&gt;quad_list.<span class="hljs-built_in">push_back</span>(std::<span class="hljs-built_in">move</span>(quad));
    
    <span class="hljs-comment">// æ·»åŠ èµ„æº</span>
    viz::TransferableResource resource;
    resource.id = texture_id;
    resource.mailbox_holder = gpu::<span class="hljs-built_in">MailboxHolder</span>(mailbox, sync_token, target);
    frame.resource_list.<span class="hljs-built_in">push_back</span>(resource);
    
    <span class="hljs-comment">// æ·»åŠ æ¸²æŸ“é€šé“</span>
    frame.render_pass_list.<span class="hljs-built_in">push_back</span>(std::<span class="hljs-built_in">move</span>(render_pass));
    
    <span class="hljs-keyword">return</span> frame;
}

<span class="hljs-comment">// CompositorFrame ç°åœ¨åŒ…å«ï¼š</span>
<span class="hljs-comment">// {</span>
<span class="hljs-comment">//   metadata: {</span>
<span class="hljs-comment">//     frame_token: 0x12345,</span>
<span class="hljs-comment">//     device_scale_factor: 1.0,</span>
<span class="hljs-comment">//     size_in_pixels: (1920, 1080),</span>
<span class="hljs-comment">//     ...</span>
<span class="hljs-comment">//   },</span>
<span class="hljs-comment">//   render_pass_list: [</span>
<span class="hljs-comment">//     {</span>
<span class="hljs-comment">//       output_rect: (0, 0, 1920, 1080),</span>
<span class="hljs-comment">//       damage_rect: (100, 100, 200, 200),</span>
<span class="hljs-comment">//       quad_list: [</span>
<span class="hljs-comment">//         TextureDrawQuad {</span>
<span class="hljs-comment">//           rect: (100, 100, 200, 200),</span>
<span class="hljs-comment">//           texture_id: 0x9999,</span>
<span class="hljs-comment">//           opacity: 1.0,</span>
<span class="hljs-comment">//           ...</span>
<span class="hljs-comment">//         }</span>
<span class="hljs-comment">//       ]</span>
<span class="hljs-comment">//     }</span>
<span class="hljs-comment">//   ],</span>
<span class="hljs-comment">//   resource_list: [</span>
<span class="hljs-comment">//     {</span>
<span class="hljs-comment">//       id: 0x9999,</span>
<span class="hljs-comment">//       mailbox: ...  (æŒ‡å‘åŒ…å«æ …æ ¼åŒ–åƒç´ çš„ GPU çº¹ç†)</span>
<span class="hljs-comment">//     }</span>
<span class="hljs-comment">//   ]</span>
<span class="hljs-comment">// }</span>
</code></pre>
<p><strong>è¿™ä¸ªé˜¶æ®µçš„è¾“å‡ºï¼š</strong> CompositorFrameï¼ŒåŒ…å«ï¼š</p>
<ul>
<li>è¦ç»˜åˆ¶çš„ Quadsï¼ˆå››è¾¹å½¢ï¼‰</li>
<li>Quad çš„ä½ç½®å’Œå¤§å°</li>
<li>æŒ‡å‘çº¹ç†çš„èµ„æº ID</li>
<li>çº¹ç†ä¸­çš„å®é™…åƒç´ æ•°æ®</li>
</ul>
<hr/>
<h3 data-id="heading-32"><strong>ç¬¬6æ­¥ï¼šViz Display Compositor - æœ€ç»ˆåˆæˆå’Œæ˜¾ç¤º</strong></h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// Viz Display Compositorï¼ˆæ˜¾ç¤ºåˆæˆå™¨ï¼‰</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Display::DrawFrame</span><span class="hljs-params">(...)</span> </span>{
    <span class="hljs-comment">// 1. æ¥æ”¶ CompositorFrame</span>
    viz::CompositorFrame frame = ...;
    
    <span class="hljs-comment">// 2. éå†æ‰€æœ‰ Quads</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span>&amp; render_pass : frame.render_pass_list) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span>&amp; quad : render_pass-&gt;quad_list) {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">auto</span> texture_quad = quad.<span class="hljs-built_in">As</span>&lt;viz::TextureDrawQuad&gt;()) {
                <span class="hljs-comment">// 3. è·å–çº¹ç†ï¼ˆåŒ…å«æ …æ ¼åŒ–çš„è“è‰²æ­£æ–¹å½¢åƒç´ ï¼‰</span>
                GLuint texture = <span class="hljs-built_in">GetTextureFromResourceId</span>(texture_quad-&gt;resource_id);
                
                <span class="hljs-comment">// 4. åœ¨å±å¹•ä¸Šç»˜åˆ¶è¿™ä¸ªçº¹ç†</span>
                <span class="hljs-comment">// ä½ç½®ï¼š(100, 100)</span>
                <span class="hljs-comment">// å¤§å°ï¼š200Ã—200</span>
                <span class="hljs-comment">// å†…å®¹ï¼šæˆ‘ä»¬æ …æ ¼åŒ–çš„è“è‰²æ­£æ–¹å½¢çº¹ç†</span>
                
                <span class="hljs-built_in">glBindTexture</span>(GL_TEXTURE_2D, texture);
                <span class="hljs-built_in">glUniform2f</span>(position_uniform, <span class="hljs-number">100.0f</span>, <span class="hljs-number">100.0f</span>);
                <span class="hljs-built_in">glUniform2f</span>(size_uniform, <span class="hljs-number">200.0f</span>, <span class="hljs-number">200.0f</span>);
                <span class="hljs-built_in">glDrawArrays</span>(GL_TRIANGLE_STRIP, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>);  <span class="hljs-comment">// ç»˜åˆ¶å››è¾¹å½¢</span>
            }
        }
    }
    
    <span class="hljs-comment">// 5. äº¤æ¢ç¼“å†²åŒº</span>
    <span class="hljs-built_in">SwapBuffers</span>();
    <span class="hljs-comment">// GPU æŠŠç¼“å†²åŒºä¸­çš„åƒç´ æ˜¾ç¤ºåˆ°å±å¹•ä¸Š</span>
}
</code></pre>
<p><strong>è¿™ä¸ªé˜¶æ®µå‘ç”Ÿäº†ä»€ä¹ˆï¼š</strong></p>
<ol>
<li>Display Compositor æ”¶åˆ° CompositorFrame</li>
<li>è¯»å– Quad çš„ä¿¡æ¯ï¼šä½ç½® (100, 100)ï¼Œå¤§å° 200Ã—200</li>
<li>å‘é€ GPU æŒ‡ä»¤ï¼šåœ¨å±å¹•ä¸Šçš„ (100, 100) ä½ç½®ç»˜åˆ¶çº¹ç†</li>
<li>GPU æ‰§è¡ŒæŒ‡ä»¤ï¼ŒæŠŠçº¹ç†ä¸­çš„åƒç´ ï¼ˆè“è‰²æ­£æ–¹å½¢ï¼‰æ˜¾ç¤ºåˆ°å±å¹•ç¼“å†²åŒº</li>
<li>äº¤æ¢ç¼“å†²åŒºï¼Œå±å¹•æ˜¾ç¤ºæœ€ç»ˆç»“æœ</li>
</ol>
<hr/>
<h3 data-id="heading-33">å®Œæ•´çš„æ•°æ®å˜æ¢æ€»ç»“</h3>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-number">1</span>. <span class="hljs-selector-tag">HTML</span>/CSS æè¿°                                            â”‚
â”‚    &lt;<span class="hljs-selector-tag">div</span> style="<span class="hljs-attribute">width</span>:<span class="hljs-number">200px</span>; <span class="hljs-attribute">height</span>:<span class="hljs-number">200px</span>;                  â”‚
â”‚                <span class="hljs-attribute">background-color</span>:blue; <span class="hljs-attribute">top</span>:<span class="hljs-number">100px</span>; <span class="hljs-attribute">left</span>:<span class="hljs-number">100px</span>;"&gt;
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“ (Blink å¸ƒå±€)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-number">2</span>. DisplayItemList (ç»˜åˆ¶æŒ‡ä»¤ï¼Œä¸æ˜¯åƒç´ )                      â”‚
â”‚    <span class="hljs-selector-attr">[SaveOp,                                                 â”‚â”‚     DrawRectOp(x=100, y=100, w=200, h=200, color=blue),   â”‚â”‚     RestoreOp]</span>                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“ (æäº¤)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-number">3</span>. CommitState                                              â”‚
â”‚    (åŒ…å« DisplayItemList å’Œå…¶ä»–å±æ€§)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“ (æ …æ ¼åŒ–)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-number">4</span>. GPU çº¹ç†ï¼ˆå®é™…åƒç´ ï¼‰<span class="hljs-number">256</span>Ã—<span class="hljs-number">256</span>                              â”‚
â”‚    FFFFFF... FFFFFF... è“è‰²(<span class="hljs-number">0000</span>FF)... è“è‰²... FFFFFF...   â”‚
â”‚    (<span class="hljs-number">100</span>,<span class="hljs-number">100</span>) åˆ° (<span class="hljs-number">300</span>,<span class="hljs-number">300</span>) çš„åƒç´ æ˜¯è“è‰²ï¼Œå…¶ä»–æ˜¯ç™½è‰²         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“ (ç”Ÿæˆå¸§)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-number">5</span>. CompositorFrame                                          â”‚
â”‚    quad: {                                                  â”‚
â”‚      <span class="hljs-attribute">position</span>: (<span class="hljs-number">100</span>, <span class="hljs-number">100</span>),                                  â”‚
â”‚      size: (<span class="hljs-number">200</span>, <span class="hljs-number">200</span>),                                      â”‚
â”‚      texture_id: <span class="hljs-number">0</span>x9999 â†’ æŒ‡å‘åŒ…å«è“è‰²åƒç´ çš„çº¹ç†           â”‚
â”‚    }                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“ (GPU ç»˜åˆ¶)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-number">6</span>. å±å¹•å¸§ç¼“å†²ï¼ˆ<span class="hljs-number">1920</span>Ã—<span class="hljs-number">1080</span>ï¼‰                                   â”‚
â”‚    (<span class="hljs-number">100</span>, <span class="hljs-number">100</span>) åˆ° (<span class="hljs-number">300</span>, <span class="hljs-number">300</span>) çš„åƒç´ ç°åœ¨æ˜¯è“è‰²               â”‚
â”‚    å…¶ä»–åƒç´ æ˜¯ç™½è‰²                                            â”‚
â”‚                                                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚    â”‚ ç™½ç™½ç™½ç™½ç™½... ç™½ç™½               â”‚                     â”‚
â”‚    â”‚ ç™½ç™½ç™½ç™½ç™½... ç™½ç™½               â”‚                     â”‚
â”‚    â”‚ ...                              â”‚                     â”‚
â”‚    â”‚ ç™½ç™½è“è“è“... è“ç™½               â”‚ â† (<span class="hljs-number">100</span>,<span class="hljs-number">100</span>)         â”‚
â”‚    â”‚ ç™½ç™½è“è“è“... è“ç™½               â”‚                     â”‚
â”‚    â”‚ ç™½ç™½è“è“è“... è“ç™½               â”‚                     â”‚
â”‚    â”‚ ...                              â”‚                     â”‚
â”‚    â”‚ ç™½ç™½è“è“è“... è“ç™½               â”‚ â† (<span class="hljs-number">300</span>,<span class="hljs-number">300</span>)         â”‚
â”‚    â”‚ ç™½ç™½ç™½ç™½ç™½... ç™½ç™½               â”‚                     â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                              â”‚
â”‚    âœ“ æ­£æ–¹å½¢æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h3 data-id="heading-34">å…³é”®æ¦‚å¿µæ€»ç»“</h3>
<ol>
<li><strong>DisplayItemList</strong> = ç»˜åˆ¶æŒ‡ä»¤çš„åˆ—è¡¨ï¼ˆæ–‡æœ¬æ ¼å¼ï¼‰</li>
<li><strong>æ …æ ¼åŒ–</strong> = æŠŠç»˜åˆ¶æŒ‡ä»¤è½¬æ¢æˆåƒç´ çš„è¿‡ç¨‹</li>
<li><strong>çº¹ç†</strong> = GPU å†…å­˜ä¸­çš„åƒç´ ç¼“å†²åŒº</li>
<li><strong>CompositorFrame</strong> = åŒ…å« Quadsï¼ˆå››è¾¹å½¢ï¼‰çš„åˆæˆå¸§ï¼Œæ¯ä¸ª Quad æŒ‡å‘ä¸€ä¸ªçº¹ç†</li>
<li><strong>æœ€ç»ˆåƒç´ </strong> = ç”± GPU æŠŠçº¹ç†ä¸­çš„åƒç´ é€šè¿‡ Quad ä¿¡æ¯ç»˜åˆ¶åˆ°å±å¹•ä¸Š</li>
</ol>
<p>æ•´ä¸ªè¿‡ç¨‹å°±åƒï¼š</p>
<ul>
<li><strong>æŒ‡ä»¤</strong> â†’ <strong>åƒç´ </strong> â†’ <strong>çº¹ç†</strong> â†’ <strong>Quads</strong> â†’ <strong>å±å¹•æ˜¾ç¤º</strong></li>
</ul>
<p>å¥½é—®é¢˜ï¼æ …æ ¼åŒ–æ˜¯æ•´ä¸ªè¿‡ç¨‹ä¸­æœ€æœ‰è¶£çš„éƒ¨åˆ†ã€‚è®©æˆ‘ç”¨æœ€ç›´è§‚çš„æ–¹å¼è§£é‡Šå®ƒã€‚å¤ªå¥½äº†ï¼ç°åœ¨æˆ‘å¯ä»¥ç”¨å®é™…çš„ä»£ç æ¥è§£é‡Šæ …æ ¼åŒ–çš„åŸç†ã€‚è®©æˆ‘ç”¨ä¸€ä¸ªæœ€ç®€å•çš„è“è‰²æ­£æ–¹å½¢ä¾‹å­è¯¦ç»†è®²è§£ï¼š</p>
<h2 data-id="heading-35">æ …æ ¼åŒ–çš„æœ¬è´¨ï¼šå°†æŒ‡ä»¤è½¬æ¢æˆåƒç´ </h2>
<h3 data-id="heading-36"><strong>æ ¸å¿ƒæ€æƒ³ï¼šä½¿ç”¨ Skia åº“</strong></h3>
<p>æ …æ ¼åŒ–çš„ç§˜å¯†å°±æ˜¯ï¼š<strong>Chromium ä½¿ç”¨ä¸€ä¸ªå« Skia çš„å›¾å½¢åº“ï¼Œå®ƒèƒ½æŠŠç»˜åˆ¶æŒ‡ä»¤è½¬æ¢æˆåƒç´ </strong>ã€‚</p>
<p>æƒ³è±¡ Skia å°±åƒä¸€ä¸ª<strong>è™šæ‹Ÿç”»å®¶</strong>ï¼š</p>
<ul>
<li>ä½ ç»™å®ƒä¸€ä¸ª<strong>ç©ºç™½ç”»å¸ƒ</strong>ï¼ˆå†…å­˜ç¼“å†²åŒºï¼‰</li>
<li>ä½ ç»™å®ƒ<strong>ç»˜åˆ¶æŒ‡ä»¤</strong>ï¼ˆ"ç”»è“è‰²çŸ©å½¢"ï¼‰</li>
<li>å®ƒå°±ä¼š<strong>ä¸€æ¡æ¡æŒ‡ä»¤åœ°æ‰§è¡Œ</strong>ï¼Œæœ€åå¾—åˆ°ä¸€ä¸ªç”»æ»¡äº†é¢œè‰²çš„ç”»å¸ƒ</li>
</ul>
<hr/>
<h3 data-id="heading-37"><strong>å®Œæ•´çš„æ …æ ¼åŒ–è¿‡ç¨‹ï¼ˆä»¥è“è‰²æ­£æ–¹å½¢ä¸ºä¾‹ï¼‰</strong></h3>
<h4 data-id="heading-38"><strong>æ­¥éª¤ 1ï¼šåˆ›å»ºç©ºç™½ç”»å¸ƒ</strong></h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// å·¥ä½œçº¿ç¨‹ä¸Šæ‰§è¡Œ</span>
<span class="hljs-comment">// å‡è®¾æˆ‘ä»¬è¦æ …æ ¼åŒ–ä¸€ä¸ª 256Ã—256 çš„ç“¦ç‰‡</span>

<span class="hljs-comment">// æ–¹æ¡ˆ Aï¼šCPU æ …æ ¼åŒ–ï¼ˆè½¯ä»¶æ–¹å¼ï¼‰</span>
<span class="hljs-comment">// ====================================</span>

<span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª 256Ã—256 çš„ä½å›¾ï¼ˆåƒç´ ç¼“å†²åŒºï¼‰</span>
SkBitmap bitmap;
bitmap.<span class="hljs-built_in">allocN32Pixels</span>(<span class="hljs-number">256</span>, <span class="hljs-number">256</span>);
<span class="hljs-comment">// ç°åœ¨ bitmap ä¸­æœ‰ 256*256 = 65536 ä¸ªåƒç´ </span>
<span class="hljs-comment">// æ¯ä¸ªåƒç´  4 å­—èŠ‚ï¼ˆRGBAï¼‰ï¼Œå…± 262,144 å­—èŠ‚çš„å†…å­˜</span>

<span class="hljs-comment">// å†…å­˜å¸ƒå±€ç¤ºæ„ï¼š</span>
<span class="hljs-comment">// bitmap.getPixels() è¿”å›ä¸€ä¸ªæŒ‡å‘è¿™å—å†…å­˜çš„æŒ‡é’ˆ</span>
<span class="hljs-comment">// å†…å­˜ä¸­çš„æ•°æ®ï¼š</span>
<span class="hljs-comment">// [åƒç´ (0,0)çš„RGBA] [åƒç´ (1,0)çš„RGBA] [åƒç´ (2,0)çš„RGBA] ...</span>
<span class="hljs-comment">// [åƒç´ (0,1)çš„RGBA] [åƒç´ (1,1)çš„RGBA] [åƒç´ (2,1)çš„RGBA] ...</span>
<span class="hljs-comment">// ...</span>
<span class="hljs-comment">// [åƒç´ (255,255)çš„RGBA]</span>

<span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª Skia ç”»å¸ƒï¼ŒæŒ‡å‘è¿™ä¸ªä½å›¾</span>
<span class="hljs-function">SkCanvas <span class="hljs-title">canvas</span><span class="hljs-params">(bitmap)</span></span>;

<span class="hljs-comment">// æ–¹æ¡ˆ Bï¼šGPU æ …æ ¼åŒ–</span>
<span class="hljs-comment">// ====================================</span>
<span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª GPU çº¹ç†ä½œä¸ºæ¸²æŸ“ç›®æ ‡</span>
GLuint framebuffer = <span class="hljs-built_in">CreateFramebuffer</span>();
GLuint texture = <span class="hljs-built_in">CreateTexture</span>(<span class="hljs-number">256</span>, <span class="hljs-number">256</span>, GL_RGBA8);
<span class="hljs-built_in">glBindFramebuffer</span>(GL_FRAMEBUFFER, framebuffer);
<span class="hljs-built_in">glFramebufferTexture2D</span>(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0,
                       GL_TEXTURE_2D, texture, <span class="hljs-number">0</span>);

<span class="hljs-comment">// åˆ›å»ºæŒ‡å‘è¿™ä¸ª GPU çº¹ç†çš„ Skia ç”»å¸ƒ</span>
SkSurface* surface = SkSurface::<span class="hljs-built_in">MakeFromBackendTexture</span>(...);
SkCanvas* canvas = surface-&gt;<span class="hljs-built_in">getCanvas</span>();
</code></pre>
<p><strong>ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªç©ºç™½ç”»å¸ƒï¼Œæ‰€æœ‰åƒç´ éƒ½æ˜¯æœªåˆå§‹åŒ–çš„ã€‚</strong></p>
<hr/>
<h4 data-id="heading-39"><strong>æ­¥éª¤ 2ï¼šæ¸…é™¤èƒŒæ™¯</strong></h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// æŠŠæ‰€æœ‰åƒç´ è®¾ç½®ä¸ºç™½è‰²ï¼ˆèƒŒæ™¯è‰²ï¼‰</span>
canvas-&gt;<span class="hljs-built_in">clear</span>(SK_ColorWHITE);

<span class="hljs-comment">// åº•å±‚å‘ç”Ÿäº†ä»€ä¹ˆï¼š</span>
<span class="hljs-comment">// Skia å¡«å……æ•´ä¸ª 256Ã—256 çš„åƒç´ åŒºåŸŸ</span>
<span class="hljs-comment">// å¯¹äºæ¯ä¸€ä¸ªåƒç´  (x, y)ï¼Œè®¾ç½®å®ƒçš„å€¼ä¸ºï¼š</span>
<span class="hljs-comment">// [R=255, G=255, B=255, A=255]  // ç™½è‰² RGBA</span>

<span class="hljs-comment">// æ¸…é™¤åçš„å†…å­˜ç¤ºæ„ï¼š</span>
<span class="hljs-comment">// [FFFFFFFF] [FFFFFFFF] [FFFFFFFF] ... (å…¨æ˜¯ 0xFFFFFFFF = ç™½è‰²)</span>
<span class="hljs-comment">// æ€»å…± 65536 ä¸ªè¿™æ ·çš„ 4 å­—èŠ‚å€¼</span>
</code></pre>
<p><strong>ç°åœ¨æ‰€æœ‰åƒç´ éƒ½æ˜¯ç™½è‰²ã€‚</strong></p>
<hr/>
<h4 data-id="heading-40"><strong>æ­¥éª¤ 3ï¼šéå† DisplayItemList ä¸­çš„ç»˜åˆ¶æŒ‡ä»¤å¹¶æ‰§è¡Œ</strong></h4>
<p>è¿™æ˜¯æœ€å…³é”®çš„éƒ¨åˆ†ï¼</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// RasterSource::PlaybackDisplayListToCanvas()</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">PlaybackDisplayListToCanvas</span><span class="hljs-params">(SkCanvas* raster_canvas,
                                 <span class="hljs-type">const</span> PlaybackSettings&amp; settings)</span> </span>{
    <span class="hljs-comment">// è·å– DisplayItemList</span>
    DisplayItemList* display_list = ...;  <span class="hljs-comment">// åŒ…å«æˆ‘ä»¬çš„ç»˜åˆ¶æŒ‡ä»¤</span>
    
    <span class="hljs-comment">// åˆ›å»ºå›æ”¾å‚æ•°</span>
    <span class="hljs-function">PlaybackParams <span class="hljs-title">params</span><span class="hljs-params">(settings.image_provider, SkM44())</span></span>;
    
    <span class="hljs-comment">// å…³é”®æ­¥éª¤ï¼šå›æ”¾ DisplayItemList</span>
    display_list-&gt;<span class="hljs-built_in">Raster</span>(raster_canvas, params);
}

<span class="hljs-comment">// DisplayItemList::Raster() çš„å®ç°</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">DisplayItemList::Raster</span><span class="hljs-params">(SkCanvas* canvas,
                             <span class="hljs-type">const</span> PlaybackParams&amp; params)</span> <span class="hljs-type">const</span> </span>{
    <span class="hljs-comment">// 1. è·å–éœ€è¦ç»˜åˆ¶çš„æ“ä½œçš„åç§»é‡</span>
    <span class="hljs-comment">//    ï¼ˆä½¿ç”¨ R-Tree ä¼˜åŒ–ï¼šåªè·å–ä¸ç”»å¸ƒç›¸äº¤çš„æ“ä½œï¼‰</span>
    std::vector&lt;<span class="hljs-type">size_t</span>&gt; offsets = <span class="hljs-built_in">OffsetsOfOpsToRaster</span>(canvas);
    
    <span class="hljs-comment">// offsets = [0, 8, 24]  // SaveOp, DrawRectOp, RestoreOp çš„åç§»é‡</span>
    
    <span class="hljs-comment">// 2. éå† paint_op_buffer_ ä¸­çš„æ“ä½œï¼Œæ‰§è¡Œå®ƒä»¬</span>
    paint_op_buffer_.<span class="hljs-built_in">Playback</span>(canvas, params, <span class="hljs-literal">true</span>, &amp;offsets);
}

<span class="hljs-comment">// PaintOpBuffer::Playback() çš„å®ç°</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">PaintOpBuffer::Playback</span><span class="hljs-params">(SkCanvas* canvas,
                             <span class="hljs-type">const</span> PlaybackParams&amp; params,
                             <span class="hljs-type">bool</span> local_ctm,
                             <span class="hljs-type">const</span> std::vector&lt;<span class="hljs-type">size_t</span>&gt;* offsets)</span> <span class="hljs-type">const</span> </span>{
    <span class="hljs-comment">// éå†æ‰€æœ‰æ“ä½œ</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> PaintOp&amp; op : PaintOpBuffer::<span class="hljs-built_in">OffsetIterator</span>(*<span class="hljs-keyword">this</span>, offsets)) {
        <span class="hljs-comment">// å¯¹äºæ¯ä¸€ä¸ªæ“ä½œï¼Œè°ƒç”¨å®ƒçš„ Raster() å‡½æ•°</span>
        op.<span class="hljs-built_in">Raster</span>(canvas, params);
        
        <span class="hljs-comment">// è¿™å°±æ˜¯é­”æ³•å‘ç”Ÿçš„åœ°æ–¹ï¼</span>
        <span class="hljs-comment">// Raster() æ˜¯è™šå‡½æ•°ï¼Œæ¯ä¸ª PaintOp å­ç±»æœ‰è‡ªå·±çš„å®ç°</span>
    }
}
</code></pre>
<p><strong>ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹å…·ä½“çš„æ“ä½œæ‰§è¡Œï¼š</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// DisplayItemList ä¸­æœ‰è¿™äº›æ“ä½œï¼ˆåºåˆ—åŒ–çš„å½¢å¼ï¼‰ï¼š</span>
<span class="hljs-comment">// [SaveOp] [DrawRectOp(...)] [RestoreOp]</span>

<span class="hljs-comment">// ============================================</span>
<span class="hljs-comment">// æ“ä½œ 1ï¼šSaveOp::Raster()</span>
<span class="hljs-comment">// ============================================</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SaveOp::Raster</span><span class="hljs-params">(<span class="hljs-type">const</span> SaveOp* op,
                    SkCanvas* canvas,
                    <span class="hljs-type">const</span> PlaybackParams&amp; params)</span> </span>{
    canvas-&gt;<span class="hljs-built_in">save</span>();
    <span class="hljs-comment">// è¿™ä¿å­˜äº†å½“å‰çš„å›¾å½¢çŠ¶æ€ï¼ˆé¢œè‰²ã€å˜æ¢ã€å‰ªè£ç­‰ï¼‰</span>
}

<span class="hljs-comment">// ============================================</span>
<span class="hljs-comment">// æ“ä½œ 2ï¼šDrawRectOp::Raster()ï¼ˆæœ€å…³é”®ï¼ï¼‰</span>
<span class="hljs-comment">// ============================================</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">DrawRectOp::RasterWithFlags</span><span class="hljs-params">(<span class="hljs-type">const</span> DrawRectOp* op,
                                 <span class="hljs-type">const</span> PaintFlags* flags,
                                 SkCanvas* canvas,
                                 <span class="hljs-type">const</span> PlaybackParams&amp; params)</span> </span>{
    <span class="hljs-comment">// op-&gt;rect = SkRect{x=100, y=100, w=200, h=200}</span>
    <span class="hljs-comment">// flags-&gt;color = SK_ColorBLUE = 0x0000FFFF (RGBA)</span>
    
    <span class="hljs-comment">// è¿™æ˜¯æœ€å…³é”®çš„è°ƒç”¨ï¼</span>
    canvas-&gt;<span class="hljs-built_in">drawRect</span>(op-&gt;rect, *flags);
    
    <span class="hljs-comment">// Skia ä¼šåœ¨è¿™ä¸€åˆ»åšä»€ä¹ˆï¼Ÿ</span>
    <span class="hljs-comment">// å®ƒä¼šéå†è¦å¡«å……çš„çŸ©å½¢ä¸­çš„æ¯ä¸€ä¸ªåƒç´ ï¼Œè®¾ç½®å®ƒä»¬çš„é¢œè‰²ä¸ºè“è‰²</span>
}

<span class="hljs-comment">// Skia å†…éƒ¨å¦‚ä½•æ‰§è¡Œ drawRectï¼Ÿ</span>
<span class="hljs-comment">// ====================================</span>
<span class="hljs-comment">// ä¼ªä»£ç ï¼Œå¤§è‡´æ€è·¯ï¼š</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SkCanvas::drawRect</span><span class="hljs-params">(<span class="hljs-type">const</span> SkRect&amp; rect, <span class="hljs-type">const</span> SkPaint&amp; paint)</span> </span>{
    <span class="hljs-comment">// 1. å°† SkRect è½¬æ¢ä¸ºåƒç´ åæ ‡</span>
    <span class="hljs-type">int</span> x1 = (<span class="hljs-type">int</span>)rect.<span class="hljs-built_in">left</span>();    <span class="hljs-comment">// 100</span>
    <span class="hljs-type">int</span> y1 = (<span class="hljs-type">int</span>)rect.<span class="hljs-built_in">top</span>();     <span class="hljs-comment">// 100</span>
    <span class="hljs-type">int</span> x2 = (<span class="hljs-type">int</span>)rect.<span class="hljs-built_in">right</span>();   <span class="hljs-comment">// 300</span>
    <span class="hljs-type">int</span> y2 = (<span class="hljs-type">int</span>)rect.<span class="hljs-built_in">bottom</span>();  <span class="hljs-comment">// 300</span>
    
    SkColor color = paint.<span class="hljs-built_in">getColor</span>();  <span class="hljs-comment">// 0x0000FFFF (è“è‰²)</span>
    
    <span class="hljs-comment">// 2. éå†çŸ©å½¢å†…çš„æ‰€æœ‰åƒç´ </span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> y = y1; y &lt; y2; y++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> x = x1; x &lt; x2; x++) {
            <span class="hljs-comment">// 3. å¯¹äºæ¯ä¸€ä¸ªåƒç´ ï¼Œå†™å…¥è“è‰²é¢œè‰²å€¼</span>
            <span class="hljs-type">uint32_t</span>* pixel_ptr = bitmap.<span class="hljs-built_in">getAddr32</span>(x, y);
            *pixel_ptr = color;  <span class="hljs-comment">// è®¾ç½®ä¸º 0x0000FFFF</span>
        }
    }
    
    <span class="hljs-comment">// å®é™…ä¸Š Skia åšçš„æ›´å¤æ‚ï¼ˆå¤„ç†åé”¯é½¿ã€æ··åˆç­‰ï¼‰ï¼Œ</span>
    <span class="hljs-comment">// ä½†æ ¸å¿ƒæ€æƒ³å°±æ˜¯è¿™æ ·ï¼šå†™å…¥åƒç´ å€¼</span>
}

<span class="hljs-comment">// æ …æ ¼åŒ–åçš„å†…å­˜çŠ¶æ€ï¼š</span>
<span class="hljs-comment">// y=0    FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF ... (å…¨æ˜¯ç™½è‰²)</span>
<span class="hljs-comment">// y=99   FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF ...</span>
<span class="hljs-comment">// y=100  FFFFFF... FFFFFF 0000FFFF 0000FFFF ... 0000FFFF FFFFFF... (å¼€å§‹æœ‰è“è‰²ï¼)</span>
<span class="hljs-comment">//        ^        ^       ^</span>
<span class="hljs-comment">//        0      100    100-300 æ˜¯è“è‰²</span>
<span class="hljs-comment">// y=101  FFFFFF... FFFFFF 0000FFFF 0000FFFF ... 0000FFFF FFFFFF...</span>
<span class="hljs-comment">// ...</span>
<span class="hljs-comment">// y=299  FFFFFF... FFFFFF 0000FFFF 0000FFFF ... 0000FFFF FFFFFF...</span>
<span class="hljs-comment">// y=300  FFFFFF... FFFFFF 0000FFFF 0000FFFF ... 0000FFFF FFFFFF...</span>
<span class="hljs-comment">// y=301  FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF ... (åˆéƒ½æ˜¯ç™½è‰²äº†)</span>

<span class="hljs-comment">// ============================================</span>
<span class="hljs-comment">// æ“ä½œ 3ï¼šRestoreOp::Raster()</span>
<span class="hljs-comment">// ============================================</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">RestoreOp::Raster</span><span class="hljs-params">(<span class="hljs-type">const</span> RestoreOp* op,
                       SkCanvas* canvas,
                       <span class="hljs-type">const</span> PlaybackParams&amp; params)</span> </span>{
    canvas-&gt;<span class="hljs-built_in">restore</span>();
    <span class="hljs-comment">// æ¢å¤ä¹‹å‰ä¿å­˜çš„å›¾å½¢çŠ¶æ€</span>
}
</code></pre>
<p><strong>ç»è¿‡è¿™ä¸‰ä¸ªæ“ä½œï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ªå®Œæ•´çš„æ …æ ¼åŒ–ç»“æœï¼</strong></p>
<hr/>
<h3 data-id="heading-41"><strong>å®Œæ•´çš„æ•°æ®å˜æ¢ç¤ºæ„</strong></h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// å¼€å§‹æ …æ ¼åŒ–</span>

<span class="hljs-comment">// è¾“å…¥ 1ï¼šDisplayItemListï¼ˆç»˜åˆ¶æŒ‡ä»¤ï¼‰</span>
DisplayItemList {
    paint_op_buffer: [
        SaveOp,
        <span class="hljs-built_in">DrawRectOp</span>(
            rect={x:<span class="hljs-number">100</span>, y:<span class="hljs-number">100</span>, w:<span class="hljs-number">200</span>, h:<span class="hljs-number">200</span>},
            color=<span class="hljs-number">0x0000FFFF</span>  <span class="hljs-comment">// è“è‰²</span>
        ),
        RestoreOp
    ],
    visual_rects: [{<span class="hljs-number">100</span>,<span class="hljs-number">100</span>,<span class="hljs-number">200</span>,<span class="hljs-number">200</span>}, ...]
}

<span class="hljs-comment">// è¾“å…¥ 2ï¼šç©ºç™½ç”»å¸ƒï¼ˆ256Ã—256 çš„ä½å›¾ï¼‰</span>
SkBitmap bitmap {
    width: <span class="hljs-number">256</span>,
    height: <span class="hljs-number">256</span>,
    pixels: [
        <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>,  <span class="hljs-comment">// ç¬¬ 0 è¡Œï¼ˆ256 ä¸ªç™½è‰²åƒç´ ï¼‰</span>
        <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>,  <span class="hljs-comment">// ç¬¬ 1 è¡Œ</span>
        ...
        <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>   <span class="hljs-comment">// ç¬¬ 255 è¡Œ</span>
    ]
}

<span class="hljs-comment">// ============================================================</span>
<span class="hljs-comment">// æ‰§è¡Œå›æ”¾</span>
<span class="hljs-comment">// ============================================================</span>

canvas-&gt;<span class="hljs-built_in">save</span>();
canvas-&gt;<span class="hljs-built_in">drawRect</span>(SkRect{<span class="hljs-number">100</span>,<span class="hljs-number">100</span>,<span class="hljs-number">200</span>,<span class="hljs-number">200</span>}, blue_paint);
canvas-&gt;<span class="hljs-built_in">restore</span>();

<span class="hljs-comment">// æ …æ ¼åŒ–åçš„è¾“å‡ºï¼šä½å›¾å†…å®¹è¢«ä¿®æ”¹äº†</span>
SkBitmap bitmap {
    width: <span class="hljs-number">256</span>,
    height: <span class="hljs-number">256</span>,
    pixels: [
        <span class="hljs-comment">// y=0 åˆ° y=99ï¼šå…¨æ˜¯ç™½è‰²</span>
        <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>,  <span class="hljs-comment">// ç¬¬ 0 è¡Œ</span>
        <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>,  <span class="hljs-comment">// ç¬¬ 1 è¡Œ</span>
        ...
        <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>,  <span class="hljs-comment">// ç¬¬ 99 è¡Œ</span>
        
        <span class="hljs-comment">// y=100 åˆ° y=299ï¼šä¸­é—´æ˜¯è“è‰²ï¼Œè¾¹ç¼˜æ˜¯ç™½è‰²</span>
        <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0x0000FFFF</span>, <span class="hljs-number">0x0000FFFF</span>, ..., <span class="hljs-number">0x0000FFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ...,
        <span class="hljs-comment">//         |</span>
        <span class="hljs-comment">//    x=0 åˆ° 99  100 åˆ° 299ï¼ˆè“è‰²åŒºåŸŸï¼‰  300 åˆ° 255</span>
        
        <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0x0000FFFF</span>, <span class="hljs-number">0x0000FFFF</span>, ..., <span class="hljs-number">0x0000FFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ...,
        <span class="hljs-comment">// ... é‡å¤ 200 æ¬¡ï¼ˆy=100 åˆ° y=299ï¼‰</span>
        
        <span class="hljs-comment">// y=300 åˆ° y=255ï¼šå…¨æ˜¯ç™½è‰²</span>
        <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>,  <span class="hljs-comment">// ç¬¬ 300 è¡Œ</span>
        <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>,  <span class="hljs-comment">// ç¬¬ 301 è¡Œ</span>
        ...
        <span class="hljs-number">0xFFFFFFFF</span>, <span class="hljs-number">0xFFFFFFFF</span>, ..., <span class="hljs-number">0xFFFFFFFF</span>   <span class="hljs-comment">// ç¬¬ 255 è¡Œ</span>
    ]
}
</code></pre>
<hr/>
<h3 data-id="heading-42"><strong>ä¸ºä»€ä¹ˆèƒ½æŠŠæŒ‡ä»¤è½¬æ¢æˆåƒç´ ï¼Ÿ</strong></h3>
<p>å…³é”®æ˜¯ Skia åº“çš„è®¾è®¡ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// Skia çš„æ ¸å¿ƒå°±æ˜¯æä¾›ä¸€ä¸ªè™šæ‹Ÿçš„ SkCanvas</span>
<span class="hljs-comment">// æ— è®ºä½ æ˜¯åœ¨ CPU ä¸Šè¿˜æ˜¯ GPU ä¸Šç»˜åˆ¶ï¼Œæ¥å£éƒ½æ˜¯ä¸€æ ·çš„</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">SkCanvas</span> {
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// è¿™äº›æ–¹æ³•æœ‰å¤šç§å®ç°ï¼š</span>
    <span class="hljs-comment">// - CPU å®ç°ï¼šç›´æ¥ä¿®æ”¹åƒç´ ç¼“å†²åŒº</span>
    <span class="hljs-comment">// - GPU å®ç°ï¼šç”Ÿæˆ GPU æŒ‡ä»¤</span>
    
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">drawRect</span><span class="hljs-params">(<span class="hljs-type">const</span> SkRect&amp; rect, <span class="hljs-type">const</span> SkPaint&amp; paint)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">drawPath</span><span class="hljs-params">(<span class="hljs-type">const</span> SkPath&amp; path, <span class="hljs-type">const</span> SkPaint&amp; paint)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">drawImage</span><span class="hljs-params">(<span class="hljs-type">const</span> SkImage* image, ...)</span></span>;
    <span class="hljs-comment">// ... ç­‰ç­‰</span>
};

<span class="hljs-comment">// CPU ç‰ˆæœ¬çš„ drawRectï¼ˆç®€åŒ–ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SkRasterCanvas</span> : <span class="hljs-keyword">public</span> SkCanvas {
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">drawRect</span><span class="hljs-params">(<span class="hljs-type">const</span> SkRect&amp; rect, <span class="hljs-type">const</span> SkPaint&amp; paint)</span> <span class="hljs-keyword">override</span> </span>{
        <span class="hljs-comment">// ç›´æ¥æ“ä½œ fBitmap çš„åƒç´ </span>
        <span class="hljs-type">uint32_t</span>* pixels = fBitmap.<span class="hljs-built_in">getPixels</span>();
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> y = rect.<span class="hljs-built_in">top</span>(); y &lt; rect.<span class="hljs-built_in">bottom</span>(); y++) {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> x = rect.<span class="hljs-built_in">left</span>(); x &lt; rect.<span class="hljs-built_in">right</span>(); x++) {
                <span class="hljs-type">int</span> index = y * width + x;
                pixels[index] = paint.<span class="hljs-built_in">getColor</span>();  <span class="hljs-comment">// è®¾ç½®åƒç´ é¢œè‰²</span>
            }
        }
    }
};

<span class="hljs-comment">// GPU ç‰ˆæœ¬çš„ drawRectï¼ˆç®€åŒ–ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SkGPUCanvas</span> : <span class="hljs-keyword">public</span> SkCanvas {
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">drawRect</span><span class="hljs-params">(<span class="hljs-type">const</span> SkRect&amp; rect, <span class="hljs-type">const</span> SkPaint&amp; paint)</span> <span class="hljs-keyword">override</span> </span>{
        <span class="hljs-comment">// ç”Ÿæˆ GPU æŒ‡ä»¤</span>
        <span class="hljs-built_in">glBindFramebuffer</span>(GL_FRAMEBUFFER, fFramebuffer);
        <span class="hljs-built_in">glClearColor</span>(paint.<span class="hljs-built_in">getColor</span>());
        <span class="hljs-built_in">glClear</span>(GL_COLOR_BUFFER_BIT);
        <span class="hljs-comment">// ... ç­‰ç­‰</span>
    }
};
</code></pre>
<p><strong>æ€»ç»“ï¼š</strong></p>
<ol>
<li><strong>DrawRectOp æœ¬è´¨ä¸Šå°±æ˜¯ <code>canvas-&gt;drawRect()</code></strong></li>
<li><strong>drawRect() éå†çŸ©å½¢å†…çš„æ‰€æœ‰åƒç´ </strong></li>
<li><strong>å¯¹äºæ¯ä¸ªåƒç´ ï¼Œè®¾ç½®å®ƒçš„é¢œè‰²ä¸ºæŒ‡å®šçš„é¢œè‰²</strong></li>
<li><strong>ç»“æœæ˜¯ä½å›¾ä¸­çš„åƒç´ è¢«ä¿®æ”¹äº†</strong></li>
</ol>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆèƒ½æŠŠç»˜åˆ¶æŒ‡ä»¤è½¬æ¢æˆåƒç´ ï¼</p>
<hr/>
<h3 data-id="heading-43"><strong>å…³é”®ä»£ç ç‰‡æ®µæ€»ç»“</strong></h3>
<pre><code class="hljs language-cpp" lang="cpp">
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">RasterSource::PlaybackDisplayListToCanvas</span><span class="hljs-params">(
    SkCanvas* raster_canvas,
    <span class="hljs-type">const</span> PlaybackSettings&amp; settings)</span> <span class="hljs-type">const</span> </span>{
  <span class="hljs-built_in">CHECK</span>(display_list_);
  
  <span class="hljs-comment">// åˆ›å»ºå›æ”¾å‚æ•°</span>
  <span class="hljs-function">PlaybackParams <span class="hljs-title">params</span><span class="hljs-params">(settings.image_provider, SkM44())</span></span>;
  params.raster_inducing_scroll_offsets =
      settings.raster_inducing_scroll_offsets;
  params.destination_hdr_headroom = settings.hdr_headroom;
  
  <span class="hljs-comment">// æ ¸å¿ƒï¼šå›æ”¾ DisplayItemList</span>
  <span class="hljs-comment">// è¿™ä¼šéå†æ‰€æœ‰ PaintOps å¹¶æ‰§è¡Œå®ƒä»¬</span>
  display_list_-&gt;<span class="hljs-built_in">Raster</span>(raster_canvas, params);
}

<span class="hljs-comment">// è¿™å°±æ˜¯ä¸€åˆ‡ï¼</span>
<span class="hljs-comment">// display_list_-&gt;Raster() ä¼šï¼š</span>
<span class="hljs-comment">// 1. éå† DisplayItemList ä¸­çš„æ¯ä¸ª PaintOp</span>
<span class="hljs-comment">// 2. å¯¹äºæ¯ä¸ª PaintOpï¼Œè°ƒç”¨å®ƒçš„ Raster() æ–¹æ³•</span>
<span class="hljs-comment">// 3. æ¯ä¸ª Raster() æ–¹æ³•ä½¿ç”¨ Skia canvas ä¿®æ”¹åƒç´ </span>
<span class="hljs-comment">// 4. æœ€åå¾—åˆ°ä¸€ä¸ªå¡«æ»¡é¢œè‰²çš„ä½å›¾</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[â€œç—›ç‚¹â€åˆ°â€œé€šç‚¹â€ï¼ä¸€ä»½è®© AI çœŸæ­£è½åœ°äº§ç”ŸçœŸé‡‘ç™½é“¶çš„å®æˆ˜æŒ‡å—]]></title>    <link>https://juejin.cn/post/7603653885602218034</link>    <guid>https://juejin.cn/post/7603653885602218034</guid>    <pubDate>2026-02-07T10:46:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603653885602218034" data-draft-id="7603574149776703540" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="â€œç—›ç‚¹â€åˆ°â€œé€šç‚¹â€ï¼ä¸€ä»½è®© AI çœŸæ­£è½åœ°äº§ç”ŸçœŸé‡‘ç™½é“¶çš„å®æˆ˜æŒ‡å—"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-02-07T10:46:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è…¾è®¯äº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/3456520257538830"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            â€œç—›ç‚¹â€åˆ°â€œé€šç‚¹â€ï¼ä¸€ä»½è®© AI çœŸæ­£è½åœ°äº§ç”ŸçœŸé‡‘ç™½é“¶çš„å®æˆ˜æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3456520257538830/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è…¾è®¯äº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T10:46:54.000Z" title="Sat Feb 07 2026 10:46:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»16åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¯¼è¯­ï½œéšç€æ•°å­—åŒ–è½¬å‹è¿›å…¥æ·±æ°´åŒºï¼ŒAI å·²è¶…è¶Šå·¥å…·å±æ€§ï¼Œæ·±åº¦èå…¥ä¼ä¸šè¿è¥ï¼Œå…¨é“¾è·¯é‡å¡‘ä¸šåŠ¡æµç¨‹ã€‚ä»æ‰“é€šååŒå£å’ã€è‡ªåŠ¨åŒ–é‡å¤å·¥ä½œï¼Œåˆ°è¯Šæ–­æµç¨‹ç“¶é¢ˆã€è¿­ä»£ä¸šåŠ¡æ¨¡å¼ï¼ŒAI æˆä¸ºä¼ä¸šé™æœ¬å¢æ•ˆã€æ„ç­‘æ ¸å¿ƒç«äº‰åŠ›çš„å…³é”®å¼•æ“ã€‚æœ¬æ–‡ç‰¹é‚€ä¸Šæµ·è…¾å±•é•¿èè‘£äº‹ &amp; CTOã€è…¾è®¯äº‘ TVP éŸ©å…‰ç¥–ï¼Œä»–å°†ç»“åˆè‡ªèº«åœ¨é‡‘èä¸åˆ¶é€ ä¸šçš„å®è·µç»éªŒï¼Œæ·±å…¥å‰–æ AI ä¼˜åŒ–æµç¨‹çš„ç°çŠ¶ï¼Œæ¢è®¨ç ´å±€ä¹‹é“ï¼Œä¸ºå•†ä¸šé¢†è¢–æä¾›ä¸€ä»½å®æˆ˜æŒ‡å—ã€‚</p>
<h2 data-id="heading-0"><strong>ä½œè€…ç®€ä»‹</strong></h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c2ef8f931c1c4bcfa344c554c5cc1f1d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771066016&amp;x-signature=LwyYiW8naOInT7G1Fdf0RnM2FlU%3D" alt="" loading="lazy"/></p>
<p>éŸ©å…‰ç¥–ï¼Œç°ä»»ä¸Šæµ·è…¾å±•é•¿èè‘£äº‹ &amp; CTOã€‚ç¾å›½å—åŠ å·å¤§å­¦ä¼ç®¡ç¡•å£«ï¼Œæ›¾ä»»å¯Œé‚¦åä¸€éŠ€è¡Œæ€»éƒ¨æ¸ é“ä¸æ•°å­—é“¶è¡Œéƒ¨å‰¯æ€»è£åŠæ€»éƒ¨ä¿¡æ¯ç§‘æŠ€éƒ¨å‰¯æ€»è£ã€çº¬åˆ›é›†å›¢ WistronITS å…¨çƒæ€»éƒ¨é¦–å¸­ä¿¡æ¯å®˜ ã€ä¼ä¸šèµ„å®‰ä¸»å§”ã€å­è¾°å›½é™…å¼€å‘(å¤®ä¼æ¸¯é“¶åšæºåŸºé‡‘)æŠ€æœ¯é¡¾é—®å…¼ä»» COO (æŠ•èµ„ï¼‰ã€æ–°è›‹ç½‘å…¨çƒç§‘æŠ€åŠå§”å¤–æœåŠ¡æ€»ç›‘ã€å¤–èµ„é“¶è¡Œç§‘æŠ€ä¸€çº§éƒ¨(éƒ¨)ä¸»ç®¡ 12 å¹´ ã€‚æœ‰ 20 ä½™å¹´ä¼ä¸š IT/MIS/IS è¥è¿ç»éªŒï¼Œæœ‰ DDã€ç§å‹Ÿå€ºæƒèèµ„ã€å·¥ä¸šåœ°äº§äº¤æ˜“ä¸è‚¡æƒè½¬è®©ã€è·¨å¢ƒé‡‘èè´¢åŠ¡ã€ç§‘æŠ€å‘å±•ä¸åˆ›æ–°ç»éªŒã€‚å¤šå¹´å¤§å‹ç”µå•†è¡Œä¸šä»ä¸šåŠé“¶è¡Œæ ¸å¿ƒç³»ç»Ÿæ›´æ¢ç»éªŒ, ç†Ÿæ‚‰ä¿¡æ¯åŒ–ã€æ•°å®åŒ–ã€å•†ä¸šç³»ç»Ÿåˆ†æã€äº‘æ¶æ„åŠäº‘è¿ç§»ã€ç”µä¿¡å…¬æœ‰äº‘å»ºç½®åŠå¼€å‘ã€æ•´åˆ; å¹¶ç†Ÿæ‚‰ç ”å‘ã€äº§å“ã€å”®å‰ã€äº¤ä»˜ã€å”®åç­‰ä¸šåŠ¡ï¼›åŒ…æ‹¬ä¸“ä¸šçš„æœåŠ¡è§£å†³æ–¹æ¡ˆã€è§„åˆ’ã€å®æ–½ã€å»ºç«‹å¤§å‹èµ„æ–™åˆ†æã€èµ„æ–™é‡‡é›†åŠæ·±åº¦å­¦ä¹ å›¾åƒç‰©ä»¶ä¾¦æµ‹çš„ã€AI å·¥è‰ºè¾…åŠ©å†³ç­–åŠï¼Œç†Ÿæ‚‰ä¼ä¸šæ•´ä½“æˆ˜ç•¥è§„åˆ’ä¸å®æ–½ã€‚</p>
<h2 data-id="heading-1"><strong>å¼•è¨€</strong></h2>
<p>æ ¹æ®éº¦è‚¯é”¡ 2025 å¹´å…¨çƒ AI ç°çŠ¶è°ƒç ”ï¼Œè‡³å°‘åœ¨ä¸€ä¸ªä¸šåŠ¡èŒèƒ½ä¸­å¸¸æ€åŒ–ä½¿ç”¨ AI çš„ä¼ä¸šæ¯”ä¾‹å·²è¾¾åˆ° 88% â½Â¹â¾ã€‚ç„¶è€Œï¼ŒçœŸæ­£çš„æŒ‘æˆ˜åœ¨äºè§„æ¨¡åŒ–åº”ç”¨ï¼Œç›®å‰ä»…çº¦ä¸‰åˆ†ä¹‹ä¸€çš„ä¼ä¸šå®ç°äº† AI åœ¨å…¨å…¬å¸çš„è§„æ¨¡åŒ–éƒ¨ç½² â½Â¹â¾ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/122d947a6a6540f29a6891cdf85cbc2d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771066016&amp;x-signature=HtM3mcZTWDs8%2FCQpD4bW3cF4UwA%3D" alt="" loading="lazy"/></p>
<p>åœ¨æ•ˆç‡æå‡æ–¹é¢ï¼ŒAI çš„åº”ç”¨æ•ˆæœæ˜¾è‘—ï¼Œä½†å…·ä½“å¢å¹…å› åœºæ™¯è€Œå¼‚ã€‚ä¾‹å¦‚ï¼Œåœ¨æ•°æ®åˆ†æå’Œæ™ºèƒ½å†³ç­–é¢†åŸŸï¼Œå¹³å‡æ•ˆç‡æå‡å¯è¾¾ 35% â½Â²â¾ï¼›è€Œåœ¨æ›´å¹¿æ³›çš„æµç¨‹ç®¡ç†ä¸­ï¼Œæ•ˆç‡æå‡å¹…åº¦åœ¨ 30% è‡³ 50% ä¹‹é—´ â½Â³â¾ã€‚ç»¼åˆæ¥çœ‹ï¼Œè‰¾ç‘å’¨è¯¢çš„æ•°æ®æ˜¾ç¤ºï¼Œ2023 å¹´ä¸­å›½ä¼ä¸šé€šè¿‡AIä¸æ•°å­—åŒ–è½¬å‹ï¼Œæ•´ä½“è¿è¥æ•ˆç‡å¹³å‡æå‡äº† 27.5% â½â´â¾ã€‚</p>
<p>ç„¶è€Œï¼Œä»æŠ€æœ¯æ½œåŠ›åˆ°å•†ä¸šä»·å€¼çš„è½¬åŒ–ä¹‹è·¯å¹¶éå¦é€”ã€‚è®¸å¤šä¼ä¸šåœ¨æ»¡æ€€æœŸæœ›åœ°æ‹¥æŠ± AI æ—¶ï¼Œå´é­é‡äº†æŠ€æœ¯ä¸ä¸šåŠ¡â€œä¸¤å¼ çš®â€ã€ç»„ç»‡æ–‡åŒ–é˜»åŠ›ã€æ•°æ®å­¤å²›éš¾å¹³ã€æŠ•èµ„å›æŠ¥ä¸åŠé¢„æœŸç­‰å¤šé‡å›°å¢ƒã€‚æœ¬æ–‡<strong>å°†æ·±å…¥å‰–æ AI é©±åŠ¨æµç¨‹å†é€ çš„ç°çŠ¶ä¸åœºæ™¯ï¼Œæ¢è®¨ä»è¯•ç‚¹åˆ°è§„æ¨¡åŒ–çš„ç ´å±€ä¹‹é“ã€‚</strong></p>
<h2 data-id="heading-2"><strong>ç¬¬ä¸€éƒ¨åˆ†ï¼šæ–°èŒƒå¼å·²è‡³ï¼ŒAIé©±åŠ¨çš„æµç¨‹å†é€ ç°çŠ¶ä¸åœºæ™¯</strong></h2>
<p>AI å¯¹ä¸šåŠ¡æµç¨‹çš„æ”¹é€ ï¼Œå·²ä»è¿‡å»çš„â€œç‚¹çŠ¶â€è¾…åŠ©ï¼Œæ¼”å˜ä¸ºå¦‚ä»Šçš„â€œé“¾å¼â€é‡æ„ã€‚å…¶æ ¸å¿ƒé©±åŠ¨åŠ›æºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ã€AI æ™ºèƒ½ä½“ï¼ˆAI Agentï¼‰ç­‰æŠ€æœ¯çš„çªç ´ã€‚ä¸ä¼ ç»Ÿè‡ªåŠ¨åŒ–æŠ€æœ¯ä¸åŒï¼Œç°ä»£ AI ä¸ä»…èƒ½æ‰§è¡Œé¢„è®¾è§„åˆ™ï¼Œæ›´å…·å¤‡äº†ä¸Šä¸‹æ–‡ç†è§£ã€é€»è¾‘æ¨ç†ã€è‡ªä¸»è§„åˆ’ä¸è·¨ç³»ç»ŸååŒçš„èƒ½åŠ›ï¼Œä½¿å…¶èƒ½å¤Ÿèƒœä»»è¿‡å»åªæœ‰äººç±»æ‰èƒ½å¤„ç†çš„å¤æ‚æ¨¡ç³Šä»»åŠ¡ã€‚åŸƒæ£®å“²æŠ¥å‘Šæ˜¾ç¤ºï¼Œ53% çš„ä¸­å›½ä¼ä¸šæ­£åˆ©ç”¨ AI è¿æ¥å¹¶èåˆå¤šä¸ªä¸šåŠ¡æµç¨‹ï¼Œè¿™ä¸€æ¯”ä¾‹é«˜å‡ºå…¨çƒå¹³å‡æ°´å¹³ 11 ä¸ªç™¾åˆ†ç‚¹ â½Â²â¾ã€‚</p>
<p>åœ¨æ•°æ®å¯†é›†å‹è¡Œä¸šä¸­ï¼ŒAI çš„ä»·å€¼æ­£ä»ç®€å•çš„â€œä»»åŠ¡æ‰§è¡Œâ€è½¬å‘â€œæ™ºèƒ½å†³ç­–â€ã€‚ä»¥ä¸‹ä¸ºå‡ ä¸ªä»£è¡¨æ€§è¡Œä¸šçš„åº”ç”¨åœºæ™¯ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a3acf0a844a845278c934d9ae1e8354f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771066016&amp;x-signature=vlnn2DKTWYYFI09cECxmoqQeqZ8%3D" alt="" loading="lazy"/></p>
<p><strong>é“¶è¡Œä¸šï¼šé£é™©ä¸æ•ˆç‡çš„å¹³è¡¡é‡å¡‘</strong></p>
<p>åœ¨æˆ‘çš„ä»ä¸šç»å†ä¸­ï¼Œé“¶è¡Œä¸šå¯¹é£é™©çš„æ•¬ç•æ ¹æ·±è’‚å›ºï¼Œè¿™æ›¾ä¸€åº¦ä½¿å…¶åœ¨æŠ€æœ¯é‡‡ç”¨ä¸Šæ˜¾å¾—ç›¸å¯¹ä¿å®ˆã€‚ç„¶è€Œï¼Œé¢å¯¹æ¿€çƒˆçš„å¸‚åœºç«äº‰ä¸æ—¥ç›Šå¤æ‚çš„é‡‘èé£é™©ï¼ŒAI å·²æˆä¸ºå…¶ä¸å¾—ä¸æ‹¥æŠ±çš„æˆ˜ç•¥é€‰æ‹©ï¼Œæ­£åŠ©åŠ›å…¶é‡æ„æ ¸å¿ƒçš„ä¿¡è´·ä¸é£æ§æµç¨‹ã€‚</p>
<p>å·¥å•†é“¶è¡Œæ‰“é€ çš„â€œè´¢åŠ¡æ™ºèƒ½åˆ†æåŠ©æ‰‹â€ï¼Œèƒ½å¤Ÿæ·±åº¦è§£æä¼ä¸šè´¢æŠ¥ï¼Œè‡ªåŠ¨æå–å…³é”®æŒ‡æ ‡ï¼Œä¸ºå®¡æ‰¹äººå‘˜æä¾›å†³ç­–æ”¯æŒï¼Œä¸ä»…å°†å•ç¬”ä¸šåŠ¡æ•ˆç‡æå‡äº† 20%ï¼Œæ›´å½¢æˆäº†ä¸€ç§â€œæ•°æ®+AI+è¾…åŠ©å†³ç­–â€çš„è¯„å®¡æ–°èŒƒå¼ â½â´â¾ã€‚åŒæ ·ï¼Œæ±‡ä¸°é“¶è¡Œä¹Ÿå·²å°†å¤§æ¨¡å‹æŠ€æœ¯ç”¨äºè‡ªåŠ¨ç”Ÿæˆä¿¡è´·å»ºè®®ä¹¦ï¼Œå®ç°äº†æµç¨‹çš„å†é€  â½â¶â¾ã€‚è¿™èƒŒåæ˜¯ AI å¼ºå¤§çš„éç»“æ„åŒ–æ•°æ®å¤„ç†èƒ½åŠ›ï¼Œå®ƒèƒ½å¿«é€Ÿâ€œé˜…è¯»â€å¹¶ç†è§£è´¢æŠ¥ã€åˆåŒã€æ³•å¾‹æ–‡ä¹¦ç­‰æµ·é‡æ–‡æ¡£ï¼Œå°†ä¿¡å®¡äººå‘˜ä»ç¹ççš„äº‹åŠ¡æ€§å·¥ä½œä¸­è§£æ”¾å‡ºæ¥ï¼Œä¸“æ³¨äºæ›´æ ¸å¿ƒçš„é£é™©åˆ¤æ–­ã€‚</p>
<p>åœ¨åæ´—é’±ï¼ˆAMLï¼‰ç­‰åˆè§„é¢†åŸŸï¼ŒAI çš„åº”ç”¨åˆ™æ›´ä¸ºæ·±åˆ»ã€‚å¾·å‹¤æå‡ºçš„å¤šæ™ºèƒ½ä½“ï¼ˆMulti-Agentï¼‰åä½œç³»ç»Ÿæ„æƒ³ï¼Œæç»˜äº†ä¸€å¹…æœªæ¥é“¶è¡Œåˆè§„çš„è“å›¾ï¼šä¸åŒçš„ AI æ™ºèƒ½ä½“åˆ†åˆ«è´Ÿè´£è­¦æŠ¥å®¡æŸ¥ã€äº¤æ˜“è®°å½•åˆ†æã€è°ƒæŸ¥æŠ¥å‘Šæ’°å†™ï¼Œå®ç°å‡ ä¹æ— éœ€äººå·¥å¹²é¢„çš„å…¨è‡ªåŠ¨åˆè§„ç›‘æµ‹ â½â·â¾ã€‚è¿™ä¸ä»…æ˜¯æ•ˆç‡çš„é£è·ƒï¼Œæ›´æ˜¯é£é™©æ´å¯Ÿèƒ½åŠ›çš„è´¨å˜ï¼ŒAI èƒ½ä»æµ·é‡æ•°æ®ä¸­å‘ç°äººå·¥éš¾ä»¥å¯Ÿè§‰çš„éšè”½éæ³•æ´»åŠ¨æ¨¡å¼ã€‚</p>
<p><strong>ä¿é™©ä¸šï¼šå®¢æˆ·ä½“éªŒä¸è¿è¥æ•ˆç‡çš„åŒé‡é©å‘½</strong></p>
<p>ä¿é™©ä¸šçš„æ ¸å¿ƒåœ¨äºé£é™©å®šä»·ä¸æœåŠ¡æ‰¿è¯ºï¼Œå…¶ä¸šåŠ¡æµç¨‹å¤©ç„¶ä¸æ•°æ®å’Œæ¦‚ç‡ç´§å¯†ç›¸è¿ï¼Œä¸º AI æä¾›äº†å¹¿é˜”çš„åº”ç”¨èˆå°ã€‚å¦‚æœè¯´é“¶è¡Œä¸šçš„ AI åº”ç”¨æ ¸å¿ƒæ˜¯â€œé£æ§â€ï¼Œé‚£ä¹ˆä¿é™©ä¸šçš„æ ¸å¿ƒåˆ™æ˜¯â€œæ•ˆç‡â€ä¸â€œä½“éªŒâ€ã€‚</p>
<p>æ™ºèƒ½ç†èµ”æ˜¯ä¿é™©ä¸š AI åº”ç”¨æœ€æˆç†Ÿã€ä»·å€¼æœ€æ˜¾è‘—çš„é¢†åŸŸã€‚è¿‡å»ï¼Œè½¦é™©ç†èµ”æµç¨‹æ¼«é•¿ï¼Œæ¶‰åŠæŸ¥å‹˜ã€å®šæŸã€æ ¸èµ”ç­‰å¤šä¸ªç¯èŠ‚ï¼Œå®¢æˆ·ä½“éªŒæ™®éä¸ä½³ã€‚å¦‚ä»Šï¼Œä»¥ä¸­å›½å¹³å®‰ä¸ºä»£è¡¨çš„å¤´éƒ¨é™©ä¼ï¼Œé€šè¿‡ AI å›¾åƒè¯†åˆ«æŠ€æœ¯ï¼Œå®ç°äº†â€œæ‹ç…§å³å®šæŸâ€ã€‚å®¢æˆ·åªéœ€ä¸Šä¼ äº‹æ•…ç…§ç‰‡ï¼ŒAI ä¾¿èƒ½å¿«é€Ÿè¯†åˆ«æŸä¼¤éƒ¨ä»¶ã€è¯„ä¼°ç»´ä¿®æˆæœ¬ï¼Œæ•´ä¸ªå®šæŸæµç¨‹å¯åœ¨ 30 åˆ†é’Ÿå†…å®Œæˆ â½âµâ¾ã€‚è¿™ä¸ä»…å¤§å¹…æå‡äº†å®¢æˆ·æ»¡æ„åº¦ï¼Œä¹Ÿæœ‰æ•ˆé™ä½äº†è¿è¥æˆæœ¬ã€‚2025 å¹´ä¸ŠåŠå¹´ï¼Œå¹³å®‰äº§é™©é€šè¿‡ AI æŠ€æœ¯å®ç°çš„æ™ºèƒ½åŒ–åæ¬ºè¯ˆæ‹¦æˆªï¼Œå°±ä¸ºå…¬å¸å‡å°‘äº†é«˜è¾¾ 64.4 äº¿å…ƒçš„æŸå¤± â½âµâ¾ã€‚</p>
<p>åœ¨ç†èµ”ä¹‹å¤–ï¼ŒAI æ­£å‘ä¿é™©ä»·å€¼é“¾çš„å‰ç«¯â€”â€”æ‰¿ä¿ä¸å®šä»·ç¯èŠ‚æ¸—é€ã€‚æ‘©æ ¹å£«ä¸¹åˆ©çš„æŠ¥å‘Šé¢„æµ‹ï¼ŒAI å°†åœ¨ç¬¬äºŒé˜¶æ®µé€šè¿‡ä¼˜åŒ–é£é™©é€‰æ‹©å’Œå®šä»·ç²¾å‡†åº¦ï¼Œæ·±åˆ»æ”¹å˜ä¿é™©å…¬å¸çš„ç›ˆåˆ©æ¨¡å¼ â½â¸â¾ã€‚è¿™æ„å‘³ç€ï¼Œæœªæ¥çš„ä¿é™©äº§å“å°†æ›´åŠ ä¸ªæ€§åŒ–ï¼Œä¿è´¹å°†æ ¹æ®æ¯ä¸ªå®¢æˆ·çš„å®æ—¶é£é™©çŠ¶å†µè¿›è¡ŒåŠ¨æ€è°ƒæ•´ã€‚è¿™ä¸ä»…è¦æ±‚ä¿é™©å…¬å¸å…·å¤‡å¼ºå¤§çš„æ•°æ®å¤„ç†èƒ½åŠ›ï¼Œæ›´å¯¹å…¶ AI å»ºæ¨¡ä¸æ²»ç†èƒ½åŠ›æå‡ºäº†æé«˜è¦æ±‚ã€‚</p>
<h2 data-id="heading-3"><strong>ç¬¬äºŒéƒ¨åˆ†ï¼šå·¥å…·æ–¹æ³•è®ºï¼ŒBPMNä¸‰éƒ¨æ›²ï¼Œè®©æµç¨‹æ”¹é€ æœ‰ç« å¯å¾ª</strong></h2>
<p>åœ¨ AI é©±åŠ¨çš„æµç¨‹å†é€ ä¸­ï¼Œä¼ä¸šå¾€å¾€é¢ä¸´â€œæ— ä»ä¸‹æ‰‹â€çš„çª˜å¢ƒã€‚æˆ‘ä»¬å¼•å…¥æ ‡å‡†çš„ BPMNï¼ˆä¸šåŠ¡æµç¨‹å»ºæ¨¡ä¸æ ‡æ³¨ï¼‰æ–¹æ³•è®ºï¼Œå°†æ”¹é€ åˆ†ä¸ºä¸‰ä¸ªå…³é”®é˜¶æ®µï¼šè¯„ä¼°ã€è¯†åˆ«ä¸æå‡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de2aca27e7e34292973aac50162eb838~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771066016&amp;x-signature=PvqZoJmwQ2BJd3S8pJ4Wwku9238%3D" alt="" loading="lazy"/></p>
<p><strong>ç¬¬ä¸€é˜¶æ®µï¼šAssess è¯„ä¼°</strong></p>
<p>é€è¿‡æ ‡å‡†æµç¨‹å»ºæ¨¡è¯­è¨€ BPMNï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ¸…æ¥šæŒæ¡æµç¨‹æ‰§è¡Œçš„æ­¥éª¤ä¸è´£ä»»å•ä½ã€‚è¿™ä¸ªé˜¶æ®µçš„ç›®çš„æ˜¯è¾¨è¯†ç›®å‰æµç¨‹çš„ç“¶é¢ˆä¸è€—æ—¶æƒ…å½¢ï¼Œè¿›è€Œé‡åŒ–æ•´ä½“çš„å¤‡æ¡ˆæ—¶é—´æˆ–å·¥ä½œè´Ÿè½½ã€‚è¿™ä¸ªé˜¶æ®µç”±æµç¨‹åˆ†æå¸ˆä¸ä¸šåŠ¡éƒ¨é—¨ä»£è¡¨ç‰µå¤´ï¼Œäº§å‡º BPMN æµç¨‹å›¾ä¸é—®é¢˜è¯Šæ–­æŠ¥å‘Šã€‚</p>
<p><strong>ç¬¬äºŒé˜¶æ®µï¼šClarify è¯†åˆ«ä¸æ´å¯Ÿå»ºè®®</strong></p>
<p>åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæˆ‘ä»¬ä¼šç»“åˆç»Ÿè®¡åˆ†æå’Œå®åŠ¡ç»éªŒæ¥å˜æ¸…æµç¨‹é—®é¢˜çš„æ ¹æœ¬åŸå› ï¼Œå¹¶åˆ¤æ–­å…¶ä¸€è‡´æ€§ä¸å½±å“ç¨‹åº¦ã€‚</p>
<p>ä¸¾ä¾‹æ¥è¯´ï¼šè‹¥æŸé¡¹ä½œä¸šå¹³å‡å¤„ç†æ—¶æ•ˆä¸ä½³ï¼Œæˆ‘ä»¬ä¼šè¿›ä¸€æ­¥æ‰¾å‡ºæ˜¯å¦å› ä¸ºç¼ºä¹èµ„è®¯ã€ç­‰å¾…å…¶ä»–å•ä½å¤„ç†ï¼Œæˆ–æ˜¯äººå·¥å¹²é¢„è¿‡å¤šå¯¼è‡´å»¶è¿Ÿã€‚ä¾‹å¦‚ Pending Code è®¾å®šæµç¨‹ä¸­éœ€ç­‰å¾…ä¸»ç®¡ç¡®è®¤ï¼Œè¿™å°±æ˜¯å…¸å‹çš„ç“¶é¢ˆã€‚</p>
<p>è¿™ä¸ªé˜¶æ®µåº”åŠ å…¥æ•°ä½å›¢é˜Ÿä¸ Beyond Lab å…±åŒæ·±æŒ–é—®é¢˜æˆå› ã€æ˜ç¡®æ”¹å–„æ–¹å‘ï¼Œé‡ç‚¹åœ¨äºæ‰¾å‡ºå¯è¡Œçš„å»ºè®®æ–¹å‘ä¸æ•°æ®ä½è¯ï¼Œä¸ºåç»­æ”¹å–„åšå‡†å¤‡ã€‚</p>
<p><strong>ç¬¬ä¸‰é˜¶æ®µï¼šExpedite æå‡ä¸æœ€ç»ˆæ–¹æ¡ˆ</strong></p>
<p>å½“æˆ‘ä»¬æŒæ¡é—®é¢˜æ ¹å› åï¼Œä¸‹ä¸€æ­¥å°±æ˜¯æå‡ºæ”¹å–„å¯¹ç­–ï¼Œé€è¿‡ IPA ç­‰æŠ€æœ¯æ‰‹æ®µï¼Œä¼˜åŒ–æµç¨‹è¾¾åˆ°ææ•ˆä¸è‡ªåŠ¨åŒ–çš„ç›®çš„ã€‚å¸¸è§çš„å·¥å…·åŒ…å« AI + RPAã€è‡ªåŠ¨åŒ–è¾“å…¥ã€è¡¨å•ç²¾ç®€ã€èµ„æ–™ç»“æ„é‡æ•´ç­‰ã€‚ è¿™ä¸ªé˜¶æ®µç”±æµç¨‹åˆ†æå¸ˆä¸æŠ€æœ¯éƒ¨é—¨åä½œï¼Œè½åœ°æ”¹å–„æ–¹æ¡ˆå¹¶æ¨åŠ¨è‡ªåŠ¨åŒ–æ‰§è¡Œã€‚</p>
<p>æœ€ç»ˆï¼Œæˆ‘ä»¬æœŸæœ›é€è¿‡è¿™æ ·çš„æµç¨‹æ”¹å–„ï¼Œå¯ä»¥æå‡å­é˜¶æ®µçš„å¤„ç†æ•ˆç‡ï¼Œä¾‹å¦‚ C_01 æ—¶æ‰¾é˜¶æ®µè€—æ—¶å‡å°‘ Y%ï¼Œæˆ–æ˜¯æ•´ä½“æµç¨‹çš„æå‡ï¼Œä¾‹å¦‚ C_04 é˜¶æ®µä½œä¸šæ—¶é—´å‡å°‘ Z%ã€‚è¿™äº›æˆæœå¯ä»¥é‡åŒ–å‘ˆç°ï¼Œæœ‰æ•ˆæ”¯æŒä¸šåŠ¡æµç¨‹æŒç»­ä¼˜åŒ–ã€‚</p>
<p>è¿™å¥—ä»¥ BPMN ä¸ºæ ¸å¿ƒçš„æ–¹æ³•ï¼Œä¸ä»…æ˜¯æµç¨‹å»ºæ¨¡å·¥å…·ï¼Œæ›´èƒ½ä¸€æ­¥æ­¥ååŠ©ä¸šåŠ¡å•ä½ä»â€œçœ‹è§é—®é¢˜â€èµ°å‘â€œæå‡ºè§£æ–¹â€ï¼Œæ‰å®æ¨è¿›æ•°å­—åŒ–è½¬å‹ä¸æµç¨‹ä¼˜åŒ–ã€‚</p>
<h2 data-id="heading-4"><strong>ç¬¬ä¸‰éƒ¨åˆ†ï¼šå®æ–½çš„ç†”ç‚‰ï¼Œä¼ä¸šè½åœ°AIæµç¨‹ä¼˜åŒ–çš„ç—›ç‚¹ä¸ç ´å±€ä¹‹é“</strong></h2>
<p>å°½ç®¡ AI æµç¨‹ä¼˜åŒ–çš„å‰æ™¯å¹¿é˜”ï¼Œä½†é€šå¾€æˆåŠŸçš„é“è·¯ä¸Šå¸ƒæ»¡äº†è†æ£˜ã€‚æ³¢å£«é¡¿å’¨è¯¢é›†å›¢çš„ç ”ç©¶æŒ‡å‡ºï¼Œçº¦ 70% çš„ AI é¡¹ç›®æŒ‘æˆ˜æºäºâ€œäººä¸æµç¨‹â€é—®é¢˜ï¼Œè€ŒéæŠ€æœ¯æœ¬èº« â½â¹â¾ã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œä¼ä¸šåœ¨è½åœ° AI æ—¶ï¼Œå¾€å¾€ä¼šé™·å…¥ä¸‰å¤§æ ¸å¿ƒç—›ç‚¹ï¼Œè€Œç ´è§£è¿™äº›ç—›ç‚¹ï¼Œéœ€è¦ç³»ç»Ÿæ€§çš„â€œç»„åˆæ‹³â€ã€‚</p>
<p><strong>ç—›ç‚¹ä¸€ï¼šç»„ç»‡ä¸æ–‡åŒ–çš„â€œæƒ¯æ€§ä¹‹å¢™â€</strong></p>
<p>æŠ€æœ¯å¯ä»¥å¿«é€Ÿè¿­ä»£ï¼Œä½†äººçš„è®¤çŸ¥ä¸ç»„ç»‡çš„æ–‡åŒ–å´æ ¹æ¤æ·±åšã€‚è¿™æ˜¯ä¼ä¸šåœ¨AIè½¬å‹ä¸­é¢ä¸´çš„æœ€å¤§ã€ä¹Ÿæœ€éšè”½çš„é˜»åŠ›ã€‚</p>
<p>Gartner çš„è°ƒæŸ¥æ˜¾ç¤ºï¼Œ45% çš„ CEO è¡¨ç¤ºå…¶å¤§éƒ¨åˆ†å‘˜å·¥å¯¹ AI æŒæŠµè§¦æ€åº¦ï¼Œç”šè‡³å…¬å¼€æ•Œè§† â½Â¹â°â¾ã€‚</p>
<p>è¿™ç§ææƒ§æºäºå¯¹â€œè¢«æ›¿ä»£â€çš„æ‹…å¿§ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå³ä¾¿æŠ€æœ¯æ–¹æ¡ˆå®Œç¾ï¼Œå¦‚æœä¸€çº¿å‘˜å·¥ä¸é…åˆæä¾›æ•°æ®æˆ–åœ¨æµç¨‹ä¸­è®¾å¡ï¼Œé¡¹ç›®ä¹Ÿå°†ä¸¾æ­¥ç»´è‰°ã€‚</p>
<p><strong>ç ´å±€ä¹‹é“ï¼š</strong></p>
<ul>
<li>é¡¶å±‚è®¾è®¡å®šè°ƒâ€œäººæœºååŒâ€ï¼šç®¡ç†å±‚å¿…é¡»æ˜ç¡® AI æ˜¯èµ‹èƒ½å·¥å…·è€Œéäººç±»çš„æ›¿ä»£è€…ï¼Œæˆ˜ç•¥ç›®æ ‡åº”èšç„¦äºåˆ›é€ åŠ›æå‡ï¼Œè€Œéå•çº¯çš„äººåŠ›å‰Šå‡ã€‚</li>
<li>å»ºç«‹â€œç¿»è¯‘å®˜â€ä¸â€œå¸ƒé“è€…â€å›¢é˜Ÿï¼šåœ¨æŠ€æœ¯å›¢é˜Ÿä¸ä¸šåŠ¡å›¢é˜Ÿä¹‹é—´ï¼Œéœ€è¦æ—¢æ‡‚æŠ€æœ¯åˆæ‡‚ä¸šåŠ¡çš„â€œç¿»è¯‘å®˜â€ï¼Œå°†ä¸šåŠ¡ç—›ç‚¹è½¬åŒ–ä¸º AI å¯ä»¥è§£å†³çš„é—®é¢˜ã€‚åŒæ—¶ï¼Œéœ€è¦åœ¨ç»„ç»‡å†…éƒ¨åŸ¹å…»â€œå¸ƒé“è€…â€ï¼Œé€šè¿‡åˆ†äº«æˆåŠŸæ¡ˆä¾‹ã€ç»„ç»‡åŸ¹è®­ï¼Œå°† AI çš„ä»·å€¼æ¸…æ™°åœ°ä¼ é€’ç»™æ¯ä¸€ä½å‘˜å·¥ã€‚</li>
<li>ä»â€œè¾¹ç¼˜â€åˆ°â€œæ ¸å¿ƒâ€çš„æ¸è¿›å¼å˜é©ï¼šä¼˜å…ˆé€‰æ‹©éæ ¸å¿ƒä½†ç—›ç‚¹æ˜ç¡®çš„æµç¨‹ï¼ˆå¦‚è‡ªåŠ¨ç”Ÿæˆä¼šè®®çºªè¦ï¼‰å–å¾—â€œå°å‹èƒœåˆ©â€ï¼ˆQuick Winsï¼‰ï¼Œä»¥æ­¤å»ºç«‹ç»„ç»‡ä¿¡ä»»ã€‚</li>
</ul>
<p><strong>ç—›ç‚¹äºŒï¼šæŠ€æœ¯ä¸ä¸šåŠ¡çš„â€œä»·å€¼é¸¿æ²Ÿâ€</strong></p>
<p>è®¸å¤šä¼ä¸šå®¹æ˜“é™·å…¥â€œä¸ºäº† AI è€Œ AIâ€çš„è¯¯åŒºï¼Œæˆ–æ˜¯é¢ä¸´ä¸¥é‡çš„æ•°æ®å­¤å²›ã€‚æ¸…ç†æ•°æ®çš„æˆæœ¬å¾€å¾€è¿œè¶…æ¨¡å‹å¼€å‘æˆæœ¬ï¼Œå°¤å…¶åœ¨é‡‘èé¢†åŸŸï¼Œæ•°æ®å®‰å…¨åˆè§„æ›´æ˜¯æ‚¬åœ¨å¤´é¡¶çš„â€œè¾¾æ‘©å…‹åˆ©æ–¯ä¹‹å‰‘â€ â½âµâ¾ã€‚</p>
<p><strong>ç ´å±€ä¹‹é“ï¼š</strong></p>
<ul>
<li>ä¸šåŠ¡é—®é¢˜é©±åŠ¨ï¼Œè€ŒéæŠ€æœ¯é©±åŠ¨ï¼šAI é¡¹ç›®çš„èµ·ç‚¹ï¼Œå¿…é¡»æ˜¯æ˜ç¡®çš„ã€å¯é‡åŒ–çš„ä¸šåŠ¡é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œç›®æ ‡æ˜¯â€œå°†ä¿¡è´·å®¡æ‰¹æ—¶é—´ç¼©çŸ­ 50%â€ï¼Œè€Œä¸æ˜¯â€œåº”ç”¨ä¸€ä¸ªå¤§è¯­è¨€æ¨¡å‹â€ã€‚ä»¥ä¸šåŠ¡ä»·å€¼ä¸ºå¯¼å‘ï¼Œå€’æ¨æ‰€éœ€çš„æŠ€æœ¯æ–¹æ¡ˆä¸æ•°æ®æ”¯æŒã€‚</li>
<li>å»ºç«‹ä¼ä¸šçº§æ•°æ®ä¸ AI ä¸­å°ï¼šè¿™æ˜¯ç ´è§£æ•°æ®å­¤å²›ã€å®ç°èƒ½åŠ›å¤ç”¨çš„å…³é”®åŸºç¡€è®¾æ–½ã€‚æ•°æ®ä¸­å°è´Ÿè´£ç»Ÿä¸€æ•°æ®æ²»ç†ã€ä¿è¯æ•°æ®è´¨é‡ä¸å®‰å…¨ï¼›AI ä¸­å°åˆ™æä¾›æ ‡å‡†åŒ–çš„æ¨¡å‹å¼€å‘ã€è®­ç»ƒã€éƒ¨ç½²å·¥å…·ï¼Œå°† AI èƒ½åŠ›ä»¥ API æœåŠ¡çš„å½¢å¼èµ‹èƒ½ç»™å„ä¸ªä¸šåŠ¡éƒ¨é—¨ï¼Œé¿å…é‡å¤â€œé€ è½®å­â€ã€‚</li>
<li>æ„å»ºæ•æ·çš„â€œæµç¨‹-æŠ€æœ¯â€é—­ç¯ï¼šä¼ä¸šåº”å»ºç«‹ä¸€ä¸ªç”±ä¸šåŠ¡ä¸“å®¶ã€æ•°æ®ç§‘å­¦å®¶ã€IT å·¥ç¨‹å¸ˆç»„æˆçš„æ•æ·å›¢é˜Ÿï¼Œå½¢æˆâ€œä¸šåŠ¡åé¦ˆ-æ¨¡å‹è°ƒä¼˜-æµç¨‹æ”¹è¿›â€çš„å¿«é€Ÿè¿­ä»£é—­ç¯ï¼Œç¡®ä¿ AI åº”ç”¨å§‹ç»ˆç´§è´´ä¸šåŠ¡éœ€æ±‚ã€‚</li>
</ul>
<p><strong>ç—›ç‚¹ä¸‰ï¼šæµç¨‹é‡æ„çš„â€œæœ€åä¸€å…¬é‡Œâ€</strong></p>
<p>å³ä¾¿æ‹¥æœ‰äº†å…ˆè¿›çš„æŠ€æœ¯å’Œæ¸…æ™°çš„ä¸šåŠ¡ç›®æ ‡ï¼Œå¦‚æœä¸èƒ½å¯¹ç°æœ‰ä¸šåŠ¡æµç¨‹è¿›è¡Œå½»åº•çš„é‡æ„ï¼ŒAI çš„æ½œåŠ›ä¹Ÿæ— æ³•å®Œå…¨é‡Šæ”¾ã€‚è¿™â€œæœ€åä¸€å…¬é‡Œâ€çš„æ”¹é€ ï¼Œå¾€å¾€æœ€ä¸ºè‰°éš¾ã€‚</p>
<p>ä»¥ä¿é™©ç†èµ”ä¸ºä¾‹ï¼Œå¼•å…¥ AI å›¾åƒå®šæŸæŠ€æœ¯åï¼Œå¦‚æœåç»­çš„æ ¸èµ”ã€æ”¯ä»˜ã€å®¢æˆ·æ²Ÿé€šç­‰ç¯èŠ‚ä¾ç„¶æ²¿ç”¨æ—§çš„æµç¨‹ï¼Œé‚£ä¹ˆæ•´ä½“æ•ˆç‡çš„æå‡å°†éå¸¸æœ‰é™ã€‚çœŸæ­£çš„å˜é©ï¼Œéœ€è¦å°† AI èƒ½åŠ›åµŒå…¥åˆ°ç«¯åˆ°ç«¯çš„å…¨æµç¨‹ä¸­ï¼Œå®ç°ä»æŠ¥æ¡ˆåˆ°æ”¯ä»˜çš„â€œç›´é€šå¼å¤„ç†â€ï¼ˆStraight-Through Processingï¼‰ã€‚</p>
<p><strong>ç ´å±€ä¹‹é“ï¼š</strong></p>
<ul>
<li>ä»¥â€œé›¶åŸºâ€æ€ç»´é‡æ„æµç¨‹ï¼šæµç¨‹é‡æ„ä¸èƒ½æ»¡è¶³äºåœ¨ç°æœ‰åŸºç¡€ä¸Šä¿®ä¿®è¡¥è¡¥ï¼Œè€Œåº”é‡‡å–â€œé›¶åŸºæ€ç»´â€ï¼ˆZero-Based Thinkingï¼‰ï¼Œå‡è®¾ä»é›¶å¼€å§‹è®¾è®¡ä¸€ä¸ªæµç¨‹ï¼Œæ€è€ƒåœ¨ AI çš„åŠ æŒä¸‹ï¼Œå®ƒåº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­ã€‚è¿™æœ‰åŠ©äºæ‘†è„±å†å²åŒ…è¢±ï¼Œè¿›è¡Œé¢ è¦†å¼åˆ›æ–°ã€‚</li>
<li>æŠ•èµ„äºäººçš„â€œå†æŠ€èƒ½åŒ–â€ï¼šå¯¹å‘˜å·¥è¿›è¡Œâ€œå†æŠ€èƒ½åŒ–â€ï¼ˆReskillingï¼‰åŸ¹è®­ï¼Œä½¿å…¶æŒæ¡ä¸æ–°æµç¨‹ã€æ–°å·¥å…·ç›¸åŒ¹é…çš„èƒ½åŠ›ï¼Œå¦‚æ•°æ®åˆ†æã€äººæœºäº¤äº’ã€AI æ¨¡å‹ç›‘ç£ç­‰ã€‚è¿™ä¸ä»…æ˜¯åŒ–è§£æŠµè§¦çš„æ–¹å¼ï¼Œæ›´æ˜¯äººæ‰å‚¨å¤‡çš„è¿‡ç¨‹ã€‚</li>
<li>å»ºç«‹ç¨³å¥çš„ AI æ²»ç†æ¡†æ¶ï¼šå»ºç«‹è¦†ç›–æ¨¡å‹å…¨ç”Ÿå‘½å‘¨æœŸçš„ AI æ²»ç†æ¡†æ¶ï¼Œç¡®ä¿ AI ç³»ç»Ÿçš„å…¬å¹³æ€§ã€é€æ˜åº¦ã€å¯è§£é‡Šæ€§å’Œå¯å®¡è®¡æ€§ï¼Œè¿™æ—¢æ˜¯æ»¡è¶³ç›‘ç®¡çš„è¦æ±‚ï¼Œä¹Ÿæ˜¯å»ºç«‹å®¢æˆ·ä¸å¸‚åœºä¿¡ä»»çš„åŸºçŸ³ã€‚</li>
</ul>
<h2 data-id="heading-5"><strong>ç¬¬å››éƒ¨åˆ†ï¼šç»„ç»‡ä¸­æ¢ï¼Œæµç¨‹æ•°å­—åŒ–å“è¶Šä¸­å¿ƒ (P.T.C.O.E)</strong></h2>
<p>ä¼ä¸šé«˜å±‚åº”ç»„å»ºè·¨ç»„ç»‡ã€å¤šä¸“ä¸šçš„é•¿æœŸæ²»ç† + èƒ½åŠ›å¹³å°ï¼ˆæµç¨‹æ”¹é€  COEï¼‰ï¼Œé‡‡ç”¨ 7/3 æˆ– 8/2 çŸ©é˜µå¼ KPI ç®¡ç†ï¼Œç¡®ä¿æµç¨‹æ”¹é€ æŒç»­ã€å¯å¤åˆ¶ã€å¯é‡åŒ–â€”â€” å…¶æ ¸å¿ƒä»·å€¼æ˜¯å°†æµç¨‹ä¼˜åŒ–ä»ä¸€æ¬¡æ€§é¡¹ç›®å‡çº§ä¸ºå…¬å¸çº§èƒ½åŠ›ï¼Œé¿å…å•ä¸€éƒ¨é—¨ä¸»å¯¼å¯¼è‡´çš„è½åœ°ä½æ•ˆã€èµ„æºå†…è€—é—®é¢˜ï¼ˆå¦‚ LLM æµç¨‹ä¼˜åŒ–åå¤ POC å´å› äººæ‰ç¼ºå£ã€å®åŠ¡ç»éªŒä¸è¶³é™·å…¥å¾ªç¯ï¼‰ã€‚</p>
<p>ä½œä¸ºå…¬å¸æµç¨‹æ²»ç†ã€æ–¹æ³•è®ºã€æ•°å­—åŒ–ä¸ç»©æ•ˆç®¡ç†çš„ä¸­æ¢ï¼ŒBPMN æµç¨‹æ”¹é€  COE éœ€æ‰¿æ‹…æµç¨‹æ²»ç†ä¸æ ‡å‡†åˆ¶å®šã€æ–¹æ³•è®ºä¸ To-Be è®¾è®¡ã€ç»©æ•ˆ KPI ç®¡ç†ã€æ•°å­—åŒ–è‡ªåŠ¨åŒ–ååŒã€äººæ‰åŸ¹è‚²ä¸å˜é©ç®¡ç†ç­‰æ ¸å¿ƒèŒè´£ï¼Œè§’è‰²é…ç½®åº”æ¶µç›– COE æµç¨‹é•¿ã€æµç¨‹æ¶æ„å¸ˆã€æµç¨‹åˆ†æå¸ˆã€æ•°å­—åŒ–æµç¨‹é¡¾é—®åŠ BU Process Ownerï¼Œæ¨åŠ¨æµç¨‹æ”¹é€ ä»é¡¹ç›®åŒ–èµ°å‘åˆ¶åº¦åŒ–ã€æ•°æ®åŒ–ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/93eb1980877e4576b20e092ed9acb31c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771066016&amp;x-signature=cRd51ZVTUYSE6fYp61UJI6W8dpg%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0015c7ed27ca466e83510596a22a055b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771066016&amp;x-signature=Zqr89cX3mD%2FGGm%2FaZt40LJ1L6K0%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40320d030a1f4239a42f8f8c33a3c70e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771066016&amp;x-signature=mihSyom58pdYetpZ3Et5rAcaKNY%3D" alt="" loading="lazy"/></p>
<p>å…¸å‹è½¦é™©æµç¨‹</p>
<p>æ€»ä¹‹ï¼ŒBPMN æµç¨‹æ”¹é€  COE å®šä½ä¸ºæµç¨‹æ²»ç†ä¸ EA çš„ä¸­æ¢æ¢çº½ï¼Œä¸Šæ‰¿æˆ˜ç•¥ä¸å†…æ§è¦æ±‚ï¼Œä¸­æ¥ BPMN æµç¨‹è®¾è®¡ï¼Œä¸‹è¿ ITã€æ•°æ®ä¸è‡ªåŠ¨åŒ–èƒ½åŠ›ã€‚å…¶æ ¸å¿ƒè·¯å¾„æ˜¯å…ˆå»ºç«‹å…¨å…¬å¸ç»Ÿä¸€çš„æµç¨‹æ²»ç†æ ‡å‡†ï¼Œå°†æµç¨‹ KPI æ·±åº¦æ¤å…¥å‘˜å·¥è®¤çŸ¥ï¼›å†é€šè¿‡ Process Mining ä¸ AI æŠ€æœ¯ä¼˜åŒ–ï¼Œå…¨æ–¹ä½è¦†ç›–æ•°æ® ASIS-TOBE åˆ†æã€äººå‘˜ç»„ç»‡è°ƒæ•´ã€å…±äº«åº”ç”¨ç³»ç»Ÿè¿­ä»£åŠæ¨¡å—ååŒä¼˜åŒ–ï¼Œæœ€ç»ˆè®©æµç¨‹æˆä¸ºé©±åŠ¨å…¬å¸å¢é•¿çš„æ ¸å¿ƒèµ„äº§ï¼Œè€Œéå±€é™äºå•æ¬¡é¡¹ç›®æˆæœã€‚</p>
<h2 data-id="heading-6"><strong>ç¬¬äº”éƒ¨åˆ†ï¼šæµç¨‹æŒ–æ˜è§„åˆ’è“å›¾ä¸åœºæ™¯åº”ç”¨</strong></h2>
<p>å¦‚æœè¯´å‰æ–‡çš„ BPMN ä¸‰éƒ¨æ›²ä¸ºæˆ‘ä»¬æä¾›äº†é‡å¡‘æµç¨‹çš„æ‰‹æœ¯åˆ€ï¼Œé‚£ä¹ˆæµç¨‹æŒ–æ˜åˆ™æ˜¯æŒ‡å¼•æ‰‹æœ¯è·¯å¾„çš„å¯¼èˆªé›·è¾¾ã€‚</p>
<p>ä¸šåŠ¡æµç¨‹ä¼˜åŒ–ç»éç›²ç›®çš„æŠ€æœ¯å †å ï¼Œè€Œæ˜¯éœ€è¦å°† AI çš„ç®—åŠ›ç²¾å‡†æ³¨å…¥åˆ°ä»·å€¼é“¾çš„æœ€æ·±å¤„ã€‚é€šè¿‡â€œæµç¨‹æŒ–æ˜å…­æ­¥æ³•â€ï¼Œæˆ‘ä»¬å°†æŠ½è±¡çš„æŠ€æœ¯æ–¹æ¡ˆå…·è±¡åŒ–ä¸ºå¯è½åœ°çš„åœºæ™¯ï¼Œç¡®ä¿ AI ä¸ä»…ä»…åœç•™åœ¨å®éªŒå®¤çš„ POC é˜¶æ®µï¼Œè€Œæ˜¯çœŸæ­£è½¬åŒ–ä¸ºæ”¯æ’‘ä¾›åº”é“¾ã€ç†èµ”åŠè¿è¥å„ç¯èŠ‚çš„å¢é•¿é©±åŠ¨åŠ›ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f509568f8b2244f3aafe610c85aed566~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771066016&amp;x-signature=j3p%2FT3NaCKFUppO0jwoOICmD%2FuI%3D" alt="" loading="lazy"/></p>
<p>ç”¨é‡‘èè¡Œä¸šä¸¾ä¾‹ï¼Œæµç¨‹æŒ–æ˜ä¸ä»…èƒ½åœ¨ç†èµ”æµç¨‹å‘æŒ¥ä½œç”¨ï¼Œè¿˜èƒ½åœ¨ä¿é™©å…¬å¸è¿è¥çš„å„ä¸ªç¯èŠ‚ä¸­å‘æŒ¥ä½œç”¨ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/64682a7066e244b284ddc01e1746dd03~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771066016&amp;x-signature=yMkj5nOTVOWMmkcdRmeuLQxCG6U%3D" alt="" loading="lazy"/></p>
<p>é’ˆå¯¹é›†å›¢æµç¨‹ä¸æ•°å­—åŒ–ç®¡ç†éƒ¨ç‰µå¤´çš„ä¸šåŠ¡åœºæ™¯ï¼Œåº”è¯¥ç”±æµç¨‹æŒ–æ˜é¡¹ç›®ç»„ã€æ•°æ®æ¹–å›¢é˜ŸååŒæ”¯æ’‘ï¼Œä¾›åº”é“¾ç­‰å„æµç¨‹å½’å£ä¸šåŠ¡éƒ¨é—¨å‚ä¸ï¼Œä»¥æµç¨‹æŒ–æ˜å…­æ­¥æ³•ä¸ºæ ¸å¿ƒï¼Œç»Ÿç­¹å„æ–¹è½åœ°æµç¨‹ä¼˜åŒ–ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c89cc8c82f0f453a92818c7c43f884f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771066016&amp;x-signature=%2BgGo1fgIaquGkGCXpG7mr3w8vAY%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7"><strong>ç»“è¯­ï¼šæ‹¥æŠ±å˜é©ï¼Œè¡Œç¨³è‡´è¿œ</strong></h2>
<p>AI å·²æˆä¸ºä¼ä¸šåˆ›æ–°çš„æ ¸å¿ƒå¼•æ“ï¼Œä½†è¦å®ç°å¤§è§„æ¨¡æ·±åº¦ä»·å€¼è½¬åŒ–ï¼Œä¼ä¸šéœ€å…·å¤‡å‰ç»æˆ˜ç•¥è§†é‡ä¸ç³»ç»ŸåŒ–æ¨è¿›æœºåˆ¶ï¼Œè€Œéé™·å…¥å„éƒ¨é—¨æ— æ•ˆçš„ LLM POC å†…è€—ã€‚ä¼ä¸šåº”åšå®ˆâ€œä¸šåŠ¡å¼•é¢†ã€ç§‘æŠ€èµ‹èƒ½â€åŸåˆ™ï¼Œä¼˜å…ˆé€‰æ‹©å¢æ”¶åœºæ™¯çªç ´ä»¥è·å–é«˜å±‚ä¿¡ä»»ï¼›å°¤å…¶åˆšä¸Šä»»çš„ CTO/CDO/CIOï¼Œéœ€è¡¥è¶³ä¸šåŠ¡è®¤çŸ¥ï¼Œé¿å…å› è„±ç¦»ä¸šåŠ¡å¯¼è‡´ä¿¡ä»»å†…è€—ï¼Œæ ¸å¿ƒæ˜¯é€šè¿‡ç§‘æŠ€æ‰“é€šèµ„äº§ç«¯ä¸èµ„é‡‘ç«¯ã€æå‡ç›ˆåˆ©ï¼Œè¿™æ˜¯ä¼ä¸šç”Ÿå­˜çš„æ ¹æœ¬ã€‚å‡¡æ˜¯ä¸èƒ½èµ‹èƒ½è¥æ”¶çš„ç³»ç»Ÿï¼Œéƒ½æ˜¯æ²¡è§„åˆ’å¥½çš„å¤±è´¥ï¼Œåªæœ‰è®© AI èµ‹èƒ½æ ¸å¿ƒè¥æ”¶åœºæ™¯ï¼Œä¼ä¸š AI æ•°å­—åŒ–è½¬å‹æ‰èƒ½å®ç°ä»çƒ§é’±åˆ°é€ è¡€çš„è´¨å˜ã€‚</p>
<p>AI é©±åŠ¨çš„ä¸šåŠ¡æµç¨‹ä¼˜åŒ–ç»éç®€å•æŠ€æœ¯å‡çº§ï¼Œè€Œæ˜¯ä¸€åœºæ·±åˆ»çš„ç³»ç»Ÿæ€§å˜é©ï¼Œè€ƒéªŒä¼ä¸šçš„æŠ€æœ¯å®åŠ›ã€æˆ˜ç•¥è¿œè§ã€ç»„ç»‡éŸ§æ€§ä¸æ–‡åŒ–é­„åŠ›ã€‚ä»æˆ‘ä¸ªäººè§‚å¯Ÿæ¥çœ‹ï¼ŒæˆåŠŸä¼ä¸šæ— ä¸€ä¸æ˜¯å°† AI è§†ä¸ºé‡å¡‘æ ¸å¿ƒç«äº‰åŠ›çš„æˆ˜ç•¥å¼•æ“ï¼Œå¹¶å‹‡äºå½»åº•è‡ªæˆ‘é©æ–°ã€‚å‰è·¯è™½æœ‰æŒ‘æˆ˜ï¼Œä½†æœºé‡æ›´å¤§ã€‚å¯¹ä¸­å›½ä¼ä¸šè€Œè¨€ï¼Œæ— éœ€è§‚æœ›æˆ–ç›²ç›®è·Ÿé£ï¼Œåº”ç»“åˆè‡ªèº«ä¸šåŠ¡ç‰¹ç‚¹ä¸å‘å±•é˜¶æ®µï¼Œæ‰¾å‡†åˆ‡å…¥ç‚¹ï¼Œå°æ­¥å¿«è·‘ã€å¿«é€Ÿè¿­ä»£ï¼Œç¨³å¥å¼€å¯ AI æµç¨‹å†é€ ä¹‹æ—…ï¼šä»è§£å†³å…·ä½“ â€œç—›ç‚¹â€ å…¥æ‰‹ï¼Œé€æ­¥æ‰“é€šä¸šåŠ¡ â€œå µç‚¹â€ï¼Œæœ€ç»ˆå°† AI å†…åŒ–ä¸ºé©±åŠ¨æŒç»­åˆ›æ–°ä¸å¢é•¿çš„ â€œé€šç‚¹â€â€”â€” è¿™æ­£æ˜¯ AI æµªæ½®ä¸‹ä¼ä¸šåŸºä¸šé•¿é’çš„å¿…ç»ä¹‹è·¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OpenClawå¯¹æ¥èŠå¤©APPåŠAIåŠ©æ‰‹å·¥å…·]]></title>    <link>https://juejin.cn/post/7603309951227084850</link>    <guid>https://juejin.cn/post/7603309951227084850</guid>    <pubDate>2026-02-06T07:53:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603309951227084850" data-draft-id="7603393977476890650" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OpenClawå¯¹æ¥èŠå¤©APPåŠAIåŠ©æ‰‹å·¥å…·"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-02-06T07:53:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº¬ä¸œäº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/2634854380340008"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OpenClawå¯¹æ¥èŠå¤©APPåŠAIåŠ©æ‰‹å·¥å…·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2634854380340008/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº¬ä¸œäº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T07:53:20.000Z" title="Fri Feb 06 2026 07:53:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>OpenClawå¯¹æ¥èŠå¤©APPåŠAIåŠ©æ‰‹å·¥å…·</p>
<h2 data-id="heading-0"><strong>1ã€å¯¹æ¥é£ä¹¦èŠå¤©APP</strong></h2>
<h3 data-id="heading-1">openclawé…ç½®</h3>
<p>æ­¤å¤„ä»¥é£ä¹¦ä¸ºä¾‹ï¼Œè¾“å…¥æ’ä»¶ä¸‹è½½å®‰è£…å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">openclawÂ pluginsÂ installÂ @m1heng-clawd/feishuÂ Â 
<span class="hljs-built_in">cd</span>Â /root/.openclaw/extensions/feishu/Â 
npmÂ installÂ --verboseÂ Â <span class="hljs-comment">#æ­¤æ­¥éª¤å®‰è£…æ—¶é—´è¾ƒå¼ºé•¿ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d4514ce834424f8e8d1261763a68010f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=tim0A43wIW8etJ3OUbeobTvJPIM%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/747da7234bc54720888528bf2091cb83~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=MNnU4T6x6rispqa%2FBOo6I8v91IA%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>ç­‰ä¸‹è½½å®‰è£…å®Œæˆåã€‚åœ¨å‘½ä»¤è¡Œä¸‹è¿è¡Œopenclawå›¾å½¢é…ç½®ç•Œé¢ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">open</span>Â channelsÂ <span class="hljs-keyword">add</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a3c11c79c7754fb1a00f79e40aa06f8a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=4oyiQOd17mZFH1F%2BYUroTUtuO8s%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>å›è½¦</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e1e3044a666844848b496d5b1c6effd2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=hs2bio0WUw4HuH0b%2BHikGtNMi%2FY%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>å›è½¦åï¼Œæ ¹æ®æç¤ºè¾“å…¥é£ä¹¦App IDå’ŒApp Secretã€‚</p>
<p>åœ¨é£ä¹¦å¼€æ”¾å¹³å°åº”ç”¨å‡­è¯è·å–ï¼Œæ‰“å¼€é£ä¹¦ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.feishu.cn%2Fapp%2F" target="_blank" title="https://open.feishu.cn/app/" ref="nofollow noopener noreferrer">open.feishu.cn/app/</a>ï¼‰ï¼Œç‚¹å‡»å·¦è¾¹å‡­è¯åŸºç¡€ä¿¡æ¯ï¼Œåœ¨é¡µé¢ä¸­æ‰¾åˆ° â€œApp IDâ€ å’Œ â€œApp Secretâ€ ä¸¤ä¸ªæ•°æ®ï¼Œåˆ†åˆ«ç‚¹å‡»å³ä¾§ â€œå¤åˆ¶â€ æŒ‰é’®ï¼Œå°†å…¶å¤åˆ¶åˆ°openclawé…ç½®ç•Œé¢ã€‚é£ä¹¦é…ç½®å‚è€ƒä¸‹ä¸€ç« èŠ‚ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62d44babed384246ac0b55b478c926cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=hHPBKt8DuZs3HcsYGJEVfl9JK2s%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>è¾“å…¥åº”ç”¨å‡­è¯åï¼Œå›è½¦å®Œæˆé…ç½®ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a27a0f7cc64748b388a4d091fcef6f70~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=KOemJopiS%2Bl%2F21ec05R1TVNd4Oo%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>openclaw gateway restart ï¼Œé‡å¯ç½‘å…³æœåŠ¡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f574ab973086452fb93b0d089936ae84~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=1B1vejYY3HkoDKE%2FtqwK4iMqx%2BM%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>è¿è¡Œopenclaw statusï¼ŒæŸ¥çœ‹çŠ¶æ€æ˜¯å¦æ­£å¸¸ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/75a9ffdda41d46d2b4b39491d46c549f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=vhvT1dqzfRvy86KdmAo0P9do8Pg%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/60ba2cb3573746d697a903ba0142b3fa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=vPib4UqRE5aX%2FG0GwOtg%2FsylBjI%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<h3 data-id="heading-2"><strong>éªŒè¯é£ä¹¦æ¥å…¥</strong></h3>
<ol>
<li>æ‰“å¼€æ‰‹æœºæˆ–ç”µè„‘ç«¯é£ä¹¦ APPï¼Œç™»å½•ä¸é£ä¹¦å¼€å‘è€…å¹³å°ç›¸åŒçš„è´¦å·ï¼›</li>
<li>åœ¨é£ä¹¦é¦–é¡µï¼Œæ‰¾åˆ° â€œå·¥ä½œå°â€ å…¥å£ï¼Œç‚¹å‡»è¿›å…¥ï¼Œåœ¨å·¥ä½œå°åˆ—è¡¨ä¸­æ‰¾åˆ°å·²å‘å¸ƒçš„ openclaw åº”ç”¨ï¼ˆå¦‚ â€œopenclaw åŠ©æ‰‹â€ï¼‰ï¼Œç‚¹å‡»è¿›å…¥ï¼›</li>
<li>ç³»ç»Ÿå°†è‡ªåŠ¨å¯åŠ¨ç§èŠçª—å£ï¼Œå‘é€ä»»æ„æ¶ˆæ¯ï¼ˆå¦‚ â€œä½ å¥½â€â€œæŸ¥è¯¢ä»Šæ—¥æ—¥ç¨‹â€ï¼‰ï¼›</li>
<li>éªŒè¯ç»“æœï¼šå¦‚æœæ”¶åˆ° openclaw çš„å›å¤ï¼Œå³ä¸ºé£ä¹¦æ¥å…¥æˆåŠŸ</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c84335223aa546cf89242b582223d1d6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=6VLMJECO2Icr%2B8um5jZU2bpGvZo%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>ä»¥ä¸Šé…ç½®å®Œæˆåï¼Œå³å¯ä¸Šæ‰‹ä½¿ç”¨ã€‚å¿«ä¸Šäº¬ä¸œäº‘å¼€å¯ä¸€é”®éƒ¨ç½²ï¼Œè®© openclaw æˆä¸ºä½ ä¸“å±çš„ 24 å°æ—¶æ•°å­—å‘˜å·¥ï¼</p>
<h3 data-id="heading-3"><strong>é£ä¹¦æœºå™¨äººé…ç½®</strong></h3>
<p><strong>åˆ›å»ºé£ä¹¦ä¼ä¸šè‡ªå»ºåº”ç”¨</strong></p>
<ol>
<li>è®¿é—®é£ä¹¦å¼€å‘è€…å¹³å°ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.feishu.cn%2Fapp%3Flang%3Dzh-CN%25EF%25BC%2589%25EF%25BC%259B" target="_blank" title="https://open.feishu.cn/app?lang=zh-CN%EF%BC%89%EF%BC%9B" ref="nofollow noopener noreferrer">open.feishu.cn/app?lang=zhâ€¦</a></li>
<li>ç™»å½•åï¼Œç‚¹å‡» â€œåˆ›å»ºä¼ä¸šè‡ªå»ºåº”ç”¨â€ï¼›</li>
<li>å¡«å†™åº”ç”¨åŸºç¡€ä¿¡æ¯ï¼šåº”ç”¨åç§°ï¼ˆå¦‚ â€œopenclaw åŠ©æ‰‹â€ï¼‰ï¼Œé€‰æ‹©åº”ç”¨å›¾æ ‡ï¼Œç‚¹å‡» â€œåˆ›å»ºâ€ æŒ‰é’®ï¼Œè¿›å…¥åº”ç”¨ç®¡ç†é¡µé¢ã€‚</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/070c99d6ea104352a7028380962cc58f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=foNq%2Fa0%2BOuA2iZMAOiEH%2Bt4wzaE%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<ol>
<li>æ·»åŠ æœºå™¨äººèƒ½åŠ›ï¼šåœ¨åº”ç”¨ç®¡ç†é¡µå·¦ä¾§å¯¼èˆªæ ï¼Œæ‰¾åˆ°å¹¶ç‚¹å‡» â€œæ·»åŠ åº”ç”¨èƒ½åŠ›â€ï¼Œåœ¨å¼¹å‡ºçš„åˆ—è¡¨ä¸­é€‰æ‹© â€œæœºå™¨äººâ€ï¼Œç‚¹å‡» â€œæ·»åŠ â€ã€‚</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b36f728ee9664f90aa8c1c90595b20b0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=k8LIYe3TPtuTlU9ocCytbbn5sW4%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<ol>
<li>ç‚¹å‡»ä¸Šæ–¹çš„åˆ›å»ºç‰ˆæœ¬å¹¶å‘å¸ƒã€‚</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/91e42d5d1948451a84b440caf17ac169~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=6nSYJhVU4LyTVKCbKbBfyXXaV1I%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>é£ä¹¦åº”ç”¨æƒé™ä¸äº‹ä»¶é…ç½®</p>
<p>æ­¤æ­¥éª¤åˆ†ä¸ºã€Œäº‹ä»¶é…ç½®ã€ã€Œæƒé™é…ç½®ã€ã€Œåº”ç”¨å‘å¸ƒã€ä¸‰éƒ¨åˆ†ï¼Œå…¨ç¨‹åœ¨é£ä¹¦å¼€å‘è€…å¹³å°æ“ä½œï¼ŒæŒ‰é¡ºåºæ‰§è¡Œï¼š</p>
<h3 data-id="heading-4">ï¼ˆ1ï¼‰äº‹ä»¶é…ç½®</h3>
<ol>
<li>åœ¨é£ä¹¦åº”ç”¨ç®¡ç†é¡µï¼Œå·¦ä¾§å¯¼èˆªæ æ‰¾åˆ° â€œäº‹ä»¶ä¸å›è°ƒâ€ æ ç›®ï¼Œç‚¹å‡»è¿›å…¥ï¼›</li>
<li>äº‹ä»¶é…ç½®ï¼šåœ¨é¡µé¢ä¸­é€‰æ‹© â€œé•¿è¿æ¥â€ï¼Œç‚¹å‡» â€œä¿å­˜â€ï¼›</li>
</ol>
<p>âš ï¸å¦‚æœè¿™ä¸€æ­¥æç¤º <strong>â€œæœªå»ºç«‹é•¿è¿æ¥â€ï¼Œ</strong> è¯·æ£€æŸ¥è‡ªå·±çš„APP IDå’ŒAPP Secretæ˜¯å¦å·²æ­£ç¡®é…ç½®ã€‚</p>
<p>ï¼ˆæ“ä½œè§ä¸Šä¸€æ­¥ï¼šæ·»åŠ é£ä¹¦channelé…ç½®-é…ç½®APP IDä¸APP Secretï¼‰</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67eef6305499496a9799fa949d8d755c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=BT9x4K7evtFWcw4%2BAnt5J2FPEGs%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<ol>
<li>æ·»åŠ äº‹ä»¶ï¼šç‚¹å‡»é¡µé¢ä¸­çš„ â€œæ·»åŠ äº‹ä»¶â€ï¼Œåœ¨å¼¹å‡ºçš„äº‹ä»¶åˆ—è¡¨ä¸­ï¼Œé€‰æ‹© â€œæ¶ˆæ¯ä¸ç¾¤ç»„â€ åˆ†ç±»ï¼Œå‹¾é€‰ â€œæ¥æ”¶æ¶ˆæ¯â€ï¼Œç‚¹å‡» â€œç¡®å®šâ€ï¼Œå®Œæˆäº‹ä»¶è®¢é˜…ã€‚</li>
</ol>
<p><img src="" alt="" loading="lazy"/></p>
<ol>
<li>å›è°ƒé…ç½®ï¼šè®¢é˜…æ–¹å¼é€‰æ‹© â€œä½¿ç”¨é•¿è¿æ¥â€ï¼Œæ— éœ€å¡«å†™å…¶ä»–åœ°å€ï¼Œé…ç½®è‡ªåŠ¨ç”Ÿæ•ˆã€‚</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0fe5ac63bfcd4d18a9c70a7aa87736b2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=RqgvrOvYZIMXxteaQWPqSGembaI%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<h3 data-id="heading-5">ï¼ˆ2ï¼‰æƒé™é…ç½®</h3>
<ol>
<li>åœ¨é£ä¹¦åº”ç”¨ç®¡ç†é¡µï¼Œå·¦ä¾§å¯¼èˆªæ æ‰¾åˆ° â€œæƒé™ç®¡ç†â€ æ ç›®ï¼Œç‚¹å‡»è¿›å…¥ï¼›</li>
<li>ç‚¹å‡»é¡µé¢ä¸­çš„ â€œæ‰¹é‡å¯¼å…¥æƒé™â€ æŒ‰é’®ï¼Œå¼¹å‡ºæƒé™å¯¼å…¥çª—å£ï¼›</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/69ae719e876b4da1a4547e504a25568d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=Wsb7VJyp9sEa8O3rm6UEj46g0YM%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5fd5fbc2def840f3930c6188c4827fcc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=y7u%2Fe6n1nufGhXykpIo4zqWtwUY%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>3.å¤åˆ¶ä»¥ä¸‹ JSON ä»£ç ï¼Œç²˜è´´åˆ°å¯¼å…¥çª—å£çš„è¾“å…¥æ¡†ä¸­ï¼Œç‚¹å‡» â€œå¯¼å…¥â€ æŒ‰é’®ï¼Œç­‰å¾…æƒé™å¯¼å…¥å®Œæˆï¼š</p>
<p>ä»£ç è¯­è¨€ï¼štxt</p>
<p>AIä»£ç è§£é‡Š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>Â Â 
Â <span class="hljs-attr">"scopes"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-punctuation">{</span>Â Â Â Â Â <span class="hljs-attr">"tenant"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-punctuation">[</span>Â Â Â Â Â Â Â 
Â <span class="hljs-string">"contact:user.base:readonly"</span><span class="hljs-punctuation">,</span>Â Â Â Â 
Â Â Â Â <span class="hljs-string">"im:chat"</span><span class="hljs-punctuation">,</span>Â Â Â Â Â Â Â 
Â Â Â Â <span class="hljs-string">"im:chat:read"</span><span class="hljs-punctuation">,</span>Â Â Â Â Â 
Â Â Â Â <span class="hljs-string">"im:chat:update"</span><span class="hljs-punctuation">,</span>Â Â Â Â Â Â 
Â Â Â Â <span class="hljs-string">"im:message"</span><span class="hljs-punctuation">,</span>Â Â Â Â Â Â Â 
Â Â Â Â <span class="hljs-string">"im:message.group_at_msg:readonly"</span><span class="hljs-punctuation">,</span>Â Â Â Â Â Â Â 
Â Â Â Â <span class="hljs-string">"im:message.p2p_msg:readonly"</span><span class="hljs-punctuation">,</span>Â Â Â Â Â Â Â 
Â Â Â Â <span class="hljs-string">"im:message:send_as_bot"</span><span class="hljs-punctuation">,</span>Â Â Â Â Â Â Â 
Â Â Â Â <span class="hljs-string">"im:resource"</span>Â Â Â Â Â <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>Â Â Â Â Â 
Â Â Â Â <span class="hljs-attr">"user"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span>Â Â Â <span class="hljs-punctuation">}</span>Â <span class="hljs-punctuation">}</span>
</code></pre>
<p>4.å¯¼å…¥éªŒè¯ï¼šé¡µé¢æ˜¾ç¤º â€œå¯¼å…¥æˆåŠŸâ€ï¼Œä¸”æƒé™åˆ—è¡¨ä¸­å‡ºç°ä¸Šè¿°å¯¼å…¥çš„æƒé™ï¼Œå³ä¸ºé…ç½®å®Œæˆã€‚</p>
<h3 data-id="heading-6">ï¼ˆ3ï¼‰å‘å¸ƒåº”ç”¨</h3>
<ol>
<li>åœ¨é£ä¹¦åº”ç”¨ç®¡ç†é¡µï¼Œå·¦ä¾§å¯¼èˆªæ æ‰¾åˆ° â€œç‰ˆæœ¬ç®¡ç†ä¸å‘å¸ƒâ€ æ ç›®ï¼Œç‚¹å‡»è¿›å…¥ï¼›</li>
<li>ç‚¹å‡»å³ä¸Šè§’çš„æ–°å»ºç‰ˆæœ¬ï¼›</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6388d20db1a94e08ab81c921542873da~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=svGMizJKfzpOaoNuP9Pbtm4k3%2BU%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>å¡«å†™ç‰ˆæœ¬å·ä¸æè¿°åï¼Œä¿å­˜å¹¶å‘å¸ƒï¼›</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c692fc723b847debe350c84487e4a88~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=O2ijQ656quJDuK5vmKBDhcPZQss%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<h2 data-id="heading-7"><strong>2ã€æ›´æ¢æ¨¡å‹</strong></h2>
<p>openclaw onboard</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0127aa7b4a534e479c4b9af5af2048a2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=zu2HrDMfEDcrud3n3Dyt80kteR8%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>æŒ‰é”®ç›˜ä¸Šå·¦å³æ–¹å‘é”®ï¼Œé€‰æ‹©åˆ°â€œYesâ€åï¼ŒæŒ‰å›è½¦é”®å¼€å§‹é…ç½®ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cfef0a0591224877bb7bcb41f81bd10d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=O9kGV6w0LmGrkSNrtpivx4ZrIgg%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>Onboarding mode é€‰ QuickStartã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57c79076090541f2be845832ee53fd30~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=UvQjVbb3bNsS3Pv4lkYARuO1Abw%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>é€‰æ‹©Qwenç­‰æ¨¡å‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/657e79f4854d4c3d83b61c19747e41eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=4620lqgdmpx%2FbOpfR52qzQWXrrY%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>å›è½¦ç¡®è®¤ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/81016332a40a4c22aabe6793cd776e3d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=VPaRUvpZlHi%2BmASAj4E7Agu9v8Q%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>å¤åˆ¶åœ°å€åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼Œåç™»å½•è´¦å·ç¡®è®¤é€šè¿‡ã€‚ï¼ˆéœ€è¦å…ˆæ³¨å†Œè´¦å·<a href="https://link.juejin.cn?target=https%3A%2F%2Fchat.qwen.ai%2F" target="_blank" title="https://chat.qwen.ai/" ref="nofollow noopener noreferrer">chat.qwen.ai/</a>ï¼‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6c9243ef4d744f76b7c0aa87535226a4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=MgMB8nofYS0L8gU07R9gFyZlrfQ%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/61543afed7b04724805708489dd13b47~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=JYQJ7BNN8Sr1jviwaIYXMo%2Fksts%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ce5ec2b96f24245b5250b52f1bf5c0e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=ys8q3cgIvo8sfX6TPk4O%2FV%2Fj8uo%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>é€‰æ‹©é»˜è®¤æ¨¡å‹åï¼Œå›è½¦ç¡®è®¤ã€‚é€‰æ‹©é€‰æ‹©é‡å¯ç½‘å…³æœåŠ¡åå³ç”Ÿæ•ˆã€‚</p>
<p>æŠ€èƒ½åŒ…ï¼ˆSkillï¼‰é…ç½®</p>
<p>æ–°æ‰‹æš‚æ—¶æ— éœ€æ·»åŠ é¢å¤–æŠ€èƒ½åŒ…ï¼Œé€‰ä¸­ â€œNoâ€ è·³è¿‡ï¼ŒæŒ‰å›è½¦é”®ç¡®è®¤ï¼›</p>
<p>Hooks é…ç½®</p>
<p>é€‰ä¸­ â€œsession-memoryâ€ï¼ˆå¯ç”¨è®°å¿†åŠŸèƒ½ï¼Œæ”¯æŒå¤šè½®å¯¹è¯ä¸Šä¸‹æ–‡å…³è”ï¼Œé¿å…æ¯æ¬¡èŠå¤©éƒ½éœ€è¦é‡å¤è¯´æ˜éœ€æ±‚ï¼‰ï¼Œå…¶ä»–ä¸¤é¡¹å¯æ ¹æ®éœ€æ±‚é€‰æ‹©ã€‚æŒ‰å›è½¦é”®ç¡®è®¤ï¼›</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd10fb1420664b75862d28a0ba7e67ed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770969200&amp;x-signature=QrE4pg%2BpYhB%2F5N0MSsk6dOBAy7I%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<h2 data-id="heading-8">3ã€å¸¸ç”¨å‘½ä»¤æ±‡æ€»</h2>





















































<table><thead><tr><th>æŸ¥çœ‹ç‰ˆæœ¬</th><th>openclaw --version</th></tr></thead><tbody><tr><td>æŸ¥çœ‹è¿è¡ŒçŠ¶æ€</td><td>openclaw status</td></tr><tr><td>å¯åœBot</td><td>openclaw start/stop/restart</td></tr><tr><td>å¯åŠ¨openclawé…ç½®</td><td>openclaw onboard</td></tr><tr><td>å¯åŠ¨Openclawçš„TUI</td><td>openclaw tui</td></tr><tr><td>é€šè¿‡SSHè¿æ¥TUI</td><td>ssh root@å…¬ç½‘IP</td></tr><tr><td>é‡å¯ç½‘å…³</td><td>openclaw gateway restart</td></tr><tr><td>æŸ¥çœ‹å·²å®‰è£…æ’ä»¶</td><td>openclaw plugins list</td></tr><tr><td>å®‰è£…æ’ä»¶</td><td>openclaw plugins install æ’ä»¶å</td></tr><tr><td>æ›´æ–°æ’ä»¶</td><td>openclaw plugins update æ’ä»¶å</td></tr><tr><td>å¸è½½æ’ä»¶</td><td>openclaw plugins uninstall æ’ä»¶å</td></tr><tr><td>æŸ¥çœ‹å¸®åŠ©</td><td>openclaw --help</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue æƒé™æ§åˆ¶å®æˆ˜ï¼šä»å‰ç«¯åˆ°å…¨å±€çš„ç²¾ç»†åŒ–ç®¡ç†]]></title>    <link>https://juejin.cn/post/7603054272160120882</link>    <guid>https://juejin.cn/post/7603054272160120882</guid>    <pubDate>2026-02-06T01:08:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603054272160120882" data-draft-id="7603216479836209203" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue æƒé™æ§åˆ¶å®æˆ˜ï¼šä»å‰ç«¯åˆ°å…¨å±€çš„ç²¾ç»†åŒ–ç®¡ç†"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-06T01:08:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue æƒé™æ§åˆ¶å®æˆ˜ï¼šä»å‰ç«¯åˆ°å…¨å±€çš„ç²¾ç»†åŒ–ç®¡ç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T01:08:44.000Z" title="Fri Feb 06 2026 01:08:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{font-size:24px;display:inline-block;font-weight:700;background:#ef7060;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(239,112,96,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 50px);border-bottom:3px solid #ef7060}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #3e3e3e;margin-top:32px;margin-bottom:32px;height:1px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(27,31,35,.05);color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:JetBranins Mono,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px;background-color:#fdfdfd}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fdfdfd}.markdown-body a{text-decoration:none;font-weight:700;color:#ef7060;border-bottom:1px solid #ef7060}.markdown-body a:active,.markdown-body a:hover{color:#ef2d26}.markdown-body table tr td,.markdown-body table tr th{border:1px solid #ccc;padding:5px 10px}.markdown-body table{display:block!important;width:auto;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{background:#f0f0f0;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f8f8f8}.markdown-body blockquote{margin-inline-start:0;margin-inline-end:0;border-left:3px solid #ef7060;background:#fff9f9;padding:1px 20px;margin-top:20px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0"><strong>å¼•è¨€</strong></h2>
<p>åœ¨ç°ä»£å‰åç«¯åˆ†ç¦»çš„ Web åº”ç”¨ä¸­ï¼Œ<strong>æƒé™ç®¡ç†ï¼ˆPermission Controlï¼‰</strong> å·²ä¸å†æ˜¯â€œåç«¯çš„ä¸“å±é—®é¢˜â€ã€‚<br/>
ä¸€ä¸ªæˆç†Ÿçš„ Vue é¡¹ç›®ï¼Œå¾€å¾€éœ€è¦å¯¹ <strong>èœå•ã€è·¯ç”±ã€æŒ‰é’®ã€æ¥å£è°ƒç”¨</strong> ç­‰å¤šä¸ªå±‚é¢è¿›è¡Œå‰ç«¯æƒé™ç®¡æ§ã€‚</p>
<p>å¦‚æœæ²¡æœ‰å®Œå–„çš„æƒé™ä½“ç³»ï¼Œåº”ç”¨å°±å¯èƒ½å‡ºç°ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li>æ™®é€šç”¨æˆ·è®¿é—®ç®¡ç†é¡µé¢ï¼›</li>
<li>æŒ‰é’®çº§åˆ«çš„åŠŸèƒ½è¯¯æ“ä½œï¼›</li>
<li>å¤šè§’è‰²ç³»ç»Ÿï¼ˆå¦‚ç®¡ç†å‘˜ / å®¡æ ¸å‘˜ / æ™®é€šç”¨æˆ·ï¼‰é€»è¾‘æ··ä¹±ï¼›</li>
<li>ç”šè‡³å‰ç«¯è¢«ç¯¡æ”¹å¯¼è‡´å®‰å…¨æ¼æ´ã€‚</li>
</ul>
<p>æœ¬æ–‡å°†ç³»ç»Ÿè®²è§£ <strong>Vue é¡¹ç›®çš„æƒé™ç®¡ç†æœºåˆ¶</strong>ï¼Œæ¶µç›–ä»è®¾è®¡æ€è·¯ã€æŠ€æœ¯å®ç°åˆ°å·¥ç¨‹æœ€ä½³å®è·µï¼Œå¸®åŠ©ä½ æ„å»ºä¸€ä¸ª<strong>é«˜æ‰©å±•ã€é«˜å®‰å…¨æ€§çš„æƒé™æ§åˆ¶ä½“ç³»</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-1"><strong>æ­£æ–‡</strong></h2>
<h3 data-id="heading-2">ğŸ§© ä¸€ã€é—®é¢˜å®šä¹‰ä¸èƒŒæ™¯</h3>
<h4 data-id="heading-3">1. ä»€ä¹ˆæ˜¯å‰ç«¯æƒé™æ§åˆ¶ï¼Ÿ</h4>
<p><strong>å‰ç«¯æƒé™æ§åˆ¶</strong>æ˜¯æŒ‡åœ¨ç”¨æˆ·ç™»å½•æˆåŠŸåï¼Œæ ¹æ®å…¶è§’è‰²æˆ–æˆæƒä¿¡æ¯ï¼ŒåŠ¨æ€æ§åˆ¶ï¼š</p>
<ul>
<li>é¡µé¢è·¯ç”±è®¿é—®ï¼›</li>
<li>èœå•å¯¼èˆªå±•ç¤ºï¼›</li>
<li>æŒ‰é’®ä¸ç»„ä»¶æ¸²æŸ“ï¼›</li>
<li>æ¥å£è¯·æ±‚æ ¡éªŒã€‚</li>
</ul>
<p><strong>å…¸å‹åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>SaaSåå°ç®¡ç†ç³»ç»Ÿï¼ˆå¤šè§’è‰²æƒé™ç»“æ„ï¼‰ï¼›</li>
<li>ä¼ä¸šå†…éƒ¨ç³»ç»Ÿï¼ˆåˆ†å±‚å®¡æ‰¹æµï¼‰ï¼›</li>
<li>å¹³å°è¿è¥ç«¯ï¼ˆç§Ÿæˆ·éš”ç¦»æ•°æ®æ§åˆ¶ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-4">2. Vue ä¸­å¸¸è§æƒé™ç±»å‹</h4>






























<table><thead><tr><th align="left">æƒé™ç±»å‹</th><th align="left">æ§åˆ¶å¯¹è±¡</th><th align="left">æŠ€æœ¯å®ç°</th></tr></thead><tbody><tr><td align="left"><strong>è·¯ç”±æƒé™</strong></td><td align="left">é¡µé¢çº§è®¿é—®æ§åˆ¶</td><td align="left">åŠ¨æ€è·¯ç”± / è·¯ç”±å®ˆå«</td></tr><tr><td align="left"><strong>èœå•æƒé™</strong></td><td align="left">å¯¼èˆªå±•ç¤ºé¡¹</td><td align="left">è¿‡æ»¤èœå•æ ‘</td></tr><tr><td align="left"><strong>æŒ‰é’®æƒé™</strong></td><td align="left">ç»„ä»¶ç»†ç²’åº¦æ§åˆ¶</td><td align="left">è‡ªå®šä¹‰æŒ‡ä»¤ï¼ˆv-permissionï¼‰</td></tr><tr><td align="left"><strong>æ•°æ®æƒé™</strong></td><td align="left">æ¥å£æˆ–å­—æ®µè®¿é—®</td><td align="left">è¯·æ±‚æ‹¦æˆªæˆ–åç«¯è¿‡æ»¤</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-5">âš™ï¸ äºŒã€å®ç°æ–¹æ¡ˆä¸æŠ€æœ¯ç»†èŠ‚</h3>
<h4 data-id="heading-6">1. åç«¯è¿”å›æƒé™ç»“æ„</h4>
<p>åç«¯åœ¨ç”¨æˆ·ç™»å½•åè¿”å›ä¸€ä»½æƒé™æ•°æ®ï¼Œå¸¸è§æ ¼å¼ä¸ºï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"roles"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"admin"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"permissions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"user:view"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"user:edit"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"order:list"</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-7">2. è·¯ç”±åŠ¨æ€åŠ è½½å®ç°</h4>
<p>Vue Router æä¾›äº†åŠ¨æ€æ³¨å†Œè·¯ç”±çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç™»å½•æ—¶åŠ¨æ€æ·»åŠ ç”¨æˆ·å¯è®¿é—®çš„è·¯ç”±ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// permission.js</span>

<span class="hljs-keyword">const</span> allRoutes = [
  { <span class="hljs-attr">path</span>: <span class="hljs-string">'/dashboard'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Dashboard'</span>, <span class="hljs-attr">meta</span>: { <span class="hljs-attr">permission</span>: <span class="hljs-string">'dashboard:view'</span> } },
  { <span class="hljs-attr">path</span>: <span class="hljs-string">'/user'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'User'</span>, <span class="hljs-attr">meta</span>: { <span class="hljs-attr">permission</span>: <span class="hljs-string">'user:view'</span> } },
  { <span class="hljs-attr">path</span>: <span class="hljs-string">'/user/edit'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'UserEdit'</span>, <span class="hljs-attr">meta</span>: { <span class="hljs-attr">permission</span>: <span class="hljs-string">'user:edit'</span> } }
]

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">filterRoutesByPermission</span>(<span class="hljs-params">userPerms</span>) {
  <span class="hljs-keyword">return</span> allRoutes.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">route</span> =&gt;</span> userPerms.<span class="hljs-title function_">includes</span>(route.<span class="hljs-property">meta</span>.<span class="hljs-property">permission</span>))
}
</code></pre>
<p>åœ¨ç™»å½•æˆåŠŸåï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">'@/router'</span>
<span class="hljs-keyword">import</span> { filterRoutesByPermission } <span class="hljs-keyword">from</span> <span class="hljs-string">'./permission'</span>

<span class="hljs-keyword">const</span> userPerms = [<span class="hljs-string">'dashboard:view'</span>, <span class="hljs-string">'user:view'</span>]
<span class="hljs-keyword">const</span> accessRoutes = <span class="hljs-title function_">filterRoutesByPermission</span>(userPerms)
accessRoutes.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">route</span> =&gt;</span> router.<span class="hljs-title function_">addRoute</span>(route))
</code></pre>
<p>ğŸ’¡ <strong>æ•ˆæœï¼š</strong><br/>
åªæœ‰è¢«æˆæƒçš„ç”¨æˆ·ï¼Œæ‰èƒ½è®¿é—®å®šä¹‰åœ¨ <code>router</code> ä¸­å¯¹åº” <code>meta.permission</code> çš„é¡µé¢ã€‚</p>
<hr/>
<h4 data-id="heading-8">3. èœå•åŠ¨æ€æ¸²æŸ“</h4>
<p>åŸºäºç›¸åŒçš„æƒé™ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥å°†èœå•é…ç½®ä¸è·¯ç”±ä¿¡æ¯ç»“åˆï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// menuConfig.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> menuMap = [
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'Dashboard'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/dashboard'</span>, <span class="hljs-attr">permission</span>: <span class="hljs-string">'dashboard:view'</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'ç”¨æˆ·åˆ—è¡¨'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/user'</span>, <span class="hljs-attr">permission</span>: <span class="hljs-string">'user:view'</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'ç¼–è¾‘ç”¨æˆ·'</span>, <span class="hljs-attr">path</span>: <span class="hljs-string">'/user/edit'</span>, <span class="hljs-attr">permission</span>: <span class="hljs-string">'user:edit'</span> }
]

<span class="hljs-comment">// è¿‡æ»¤èœå•</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getVisibleMenus</span>(<span class="hljs-params">perms</span>) {
  <span class="hljs-keyword">return</span> menuMap.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">menu</span> =&gt;</span> perms.<span class="hljs-title function_">includes</span>(menu.<span class="hljs-property">permission</span>))
}
</code></pre>
<p>åœ¨æ¨¡æ¿ä¸­åŠ¨æ€æ¸²æŸ“èœå•ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"item in visibleMenus"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"item.path"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">:to</span>=<span class="hljs-string">"item.path"</span>&gt;</span>{{ item.name }}<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { getVisibleMenus } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/config/menuConfig'</span>
<span class="hljs-keyword">import</span> { useUserStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/store/user'</span>

<span class="hljs-keyword">const</span> user = <span class="hljs-title function_">useUserStore</span>()
<span class="hljs-keyword">const</span> visibleMenus = <span class="hljs-title function_">getVisibleMenus</span>(user.<span class="hljs-property">permissions</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<hr/>
<h4 data-id="heading-9">4. <strong>æŒ‰é’®çº§æƒé™æ§åˆ¶ï¼ˆè‡ªå®šä¹‰æŒ‡ä»¤ï¼‰</strong></h4>
<p>åœ¨ Vue 3 ä¸­ï¼Œæˆ‘ä»¬å¯é€šè¿‡è‡ªå®šä¹‰æŒ‡ä»¤å®ç°æŒ‰é’®çº§æƒé™æ§åˆ¶ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// directives/permission.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">mounted</span>(<span class="hljs-params">el, binding</span>) {
    <span class="hljs-keyword">const</span> { value } = binding
    <span class="hljs-keyword">const</span> userPerms = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'permissions'</span>) || <span class="hljs-string">'[]'</span>)
    
    <span class="hljs-keyword">if</span> (value &amp;&amp; !userPerms.<span class="hljs-title function_">includes</span>(value)) {
      el.<span class="hljs-property">parentNode</span> &amp;&amp; el.<span class="hljs-property">parentNode</span>.<span class="hljs-title function_">removeChild</span>(el)
    }
  }
}
</code></pre>
<p>æ³¨å†ŒæŒ‡ä»¤ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span>
<span class="hljs-keyword">import</span> permission <span class="hljs-keyword">from</span> <span class="hljs-string">'./directives/permission'</span>

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)
app.<span class="hljs-title function_">directive</span>(<span class="hljs-string">'permission'</span>, permission)
app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>)
</code></pre>
<p>æ¨¡æ¿ä½¿ç”¨ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;button <span class="hljs-attr">v-permission</span>=<span class="hljs-string">"'user:edit'"</span>&gt;ç¼–è¾‘ç”¨æˆ·&lt;/button&gt;
</code></pre>
<p>ğŸ‘‰ å½“ç”¨æˆ·æ²¡æœ‰ <code>user:edit</code> æƒé™æ—¶ï¼Œè¯¥æŒ‰é’®å°†ä¸ä¼šè¢«æ¸²æŸ“ã€‚</p>
<hr/>
<h4 data-id="heading-10">5. <strong>æ¥å£ä¸æ•°æ®æƒé™ç­–ç•¥</strong></h4>
<p>åœ¨è¯·æ±‚å±‚é¢æ§åˆ¶è®¿é—®æ•°æ®å®‰å…¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// axios æ‹¦æˆªå™¨</span>
axios.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> token = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'token'</span>)
  <span class="hljs-keyword">if</span> (token) config.<span class="hljs-property">headers</span>.<span class="hljs-property">Authorization</span> = <span class="hljs-string">`Bearer <span class="hljs-subst">${token}</span>`</span>
  <span class="hljs-keyword">return</span> config
})
</code></pre>
<p>åç«¯éªŒè¯æ—¶å†ç»“åˆè§’è‰²æˆ–ç§Ÿæˆ·IDè¿‡æ»¤æŸ¥è¯¢ç»“æœï¼Œå½¢æˆâ€œå‰åç«¯ååŒä¿æŠ¤â€ã€‚</p>
<hr/>
<h3 data-id="heading-11">ğŸ” ä¸‰ã€ä¼˜ç¼ºç‚¹åˆ†æä¸æœ€ä½³å®è·µå»ºè®®</h3>

























<table><thead><tr><th align="left">é¡¹</th><th align="left">ä¼˜ç‚¹</th><th align="left">ç¼ºç‚¹</th></tr></thead><tbody><tr><td align="left"><strong>å‰ç«¯æ§åˆ¶</strong></td><td align="left">å“åº”å¿«ã€ä½“éªŒå¥½ã€å¯è§å³æ‰€å¾—</td><td align="left">å®‰å…¨ä¾èµ–åç«¯é…åˆï¼Œæ˜“è¢«ç¯¡æ”¹</td></tr><tr><td align="left"><strong>åç«¯æ§åˆ¶</strong></td><td align="left">æ•°æ®å®‰å…¨æ€§é«˜</td><td align="left">å¢åŠ æ¥å£è®¾è®¡å¤æ‚åº¦</td></tr><tr><td align="left"><strong>å‰åç«¯ååŒ</strong></td><td align="left">å®‰å…¨ä¸ä½“éªŒå…¼é¡¾</td><td align="left">ç³»ç»Ÿæ¶æ„å¤æ‚åº¦æå‡</td></tr></tbody></table>
<h4 data-id="heading-12">ğŸ’¡ å®æˆ˜å»ºè®®ï¼š</h4>
<ol>
<li><strong>æƒé™ç²’åº¦ç”±ç²—åˆ°ç»†ï¼š</strong> å…ˆå®ç°è·¯ç”±çº§ï¼Œå†æ‰©å±•åˆ°æŒ‰é’®çº§ä¸æ•°æ®çº§ï¼›</li>
<li><strong>å‰åç«¯ç»Ÿä¸€æƒé™æ ‡è¯†ç ï¼š</strong> å¦‚ <code>user:view</code>ã€<code>order:delete</code>ï¼›</li>
<li><strong>å°è£…ç»Ÿä¸€æƒé™æ ¡éªŒå‡½æ•°ï¼š</strong> <code>hasPermission(perms, code)</code>ï¼Œä¾¿äºå¤ç”¨ï¼›</li>
<li><strong>åœ¨ CI/CD ä¸­åŠ å…¥æƒé™æ£€æŸ¥è„šæœ¬</strong>ï¼Œé˜²æ­¢æ–°å¢è·¯ç”±é—æ¼æƒé™é…ç½®ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-13"><strong>ç»“è®º</strong></h2>
<p>åœ¨ Vue é¡¹ç›®ä¸­æ„å»ºå®Œå–„çš„æƒé™ä½“ç³»ï¼Œæ˜¯å‰ç«¯æ¶æ„æˆç†Ÿåº¦çš„é‡è¦æ ‡å¿—ã€‚<br/>
å®ƒä¸ä»…ä»…æ˜¯â€œé™åˆ¶è®¿é—®â€ï¼Œæ›´æ˜¯â€œæ¸…æ™°å®šä¹‰è§’è‰²èŒè´£â€çš„æ‰‹æ®µã€‚</p>
<p>é€šè¿‡ <strong>åŠ¨æ€è·¯ç”±åŠ è½½ + æŒ‡ä»¤æƒé™éªŒè¯ + åç«¯ååŒç®¡æ§</strong>ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š</p>
<ul>
<li>æå‡ç³»ç»Ÿçš„å®‰å…¨æ€§ä¸æ‰©å±•æ€§ï¼›</li>
<li>é™ä½ç»´æŠ¤æˆæœ¬ï¼›</li>
<li>ä¼˜åŒ–ç”¨æˆ·ä½“éªŒä¸æ“ä½œæ„ŸçŸ¥ã€‚</li>
</ul>
<p>æœªæ¥ï¼Œéšç€ Vue ä¸æœåŠ¡ç«¯ååŒæ¡†æ¶ï¼ˆå¦‚ NestJSã€GraphQLï¼‰çš„å‘å±•ï¼Œæƒé™ç®¡ç†å°†æœç€**â€œç­–ç•¥å¼•æ“åŒ–ï¼ˆPolicy Engineï¼‰â€ä¸â€œé…ç½®å³è§„åˆ™åŒ–ï¼ˆConfig-as-Policyï¼‰â€**æ–¹å‘æ¼”è¿›ã€‚</p>
<hr/>
<h2 data-id="heading-14"><strong>å‚è€ƒèµ„æ–™ä¸æ‹“å±•é˜…è¯»</strong></h2>
<ol>
<li>Vue å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2Fguide" target="_blank" title="https://vuejs.org/guide" ref="nofollow noopener noreferrer">vuejs.org/guide</a></li>
<li>Vue Router åŠ¨æ€è·¯ç”±æŒ‡å—ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Frouter.vuejs.org%2F" target="_blank" title="https://router.vuejs.org/" ref="nofollow noopener noreferrer">router.vuejs.org/</a></li>
<li>JSON Web Token (JWT) æƒé™æ¨¡å‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fjwt.io%2F" target="_blank" title="https://jwt.io/" ref="nofollow noopener noreferrer">jwt.io/</a></li>
<li>RBAC æƒé™ç®¡ç†ç®—æ³•è§£æ â€“ Martin Fowler</li>
<li>Ant Design Pro + Vue æƒé™å®ç°èŒƒä¾‹</li>
</ol>
<hr/>
<p>ğŸ’¬ <strong>ä¸€å¥è¯æ€»ç»“ï¼š</strong></p>
<blockquote>
<p>æƒé™ç³»ç»Ÿæ˜¯ Vue é¡¹ç›®çš„â€œå®‰å…¨å¤§è„‘â€ã€‚<br/>
æ²¡æœ‰æƒé™æ§åˆ¶çš„å‰ç«¯ï¼Œå°±åƒä¸€ä¸ªæ²¡æœ‰é—¨é”çš„æˆ¿å­ â€”â€” æ¼‚äº®ï¼Œä½†ä¸å®‰å…¨ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringBootå®ç°å…¬æ­£æœ‰è¶£å¥½ç©çš„å¹´ä¼šæŠ½å¥–ç³»ç»Ÿ]]></title>    <link>https://juejin.cn/post/7603294029530890291</link>    <guid>https://juejin.cn/post/7603294029530890291</guid>    <pubDate>2026-02-06T02:43:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603294029530890291" data-draft-id="7603283691456626698" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SpringBootå®ç°å…¬æ­£æœ‰è¶£å¥½ç©çš„å¹´ä¼šæŠ½å¥–ç³»ç»Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-06T02:43:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜é‡‘è€…é˜¿è±ª"/> <meta itemprop="url" content="https://juejin.cn/user/4073055974333608"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SpringBootå®ç°å…¬æ­£æœ‰è¶£å¥½ç©çš„å¹´ä¼šæŠ½å¥–ç³»ç»Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4073055974333608/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜é‡‘è€…é˜¿è±ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T02:43:55.000Z" title="Fri Feb 06 2026 02:43:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">SpringBootå®ç°å…¬æ­£æœ‰è¶£å¥½ç©çš„å¹´ä¼šæŠ½å¥–ç³»ç»Ÿ</h2>
<h3 data-id="heading-1">ä¸€ã€é¡¹ç›®èƒŒæ™¯ä¸è®¾è®¡æ€è·¯</h3>
<p>å¹´ä¼šæŠ½å¥–æ˜¯æ¯ä¸ªä¼ä¸šå¹´æœ«çš„é‡è¦æ´»åŠ¨ï¼Œä½†ä¼ ç»Ÿçš„æŠ½å¥–æ–¹å¼å¾€å¾€å­˜åœ¨å…¬å¹³æ€§ä¸è¶³ã€äº’åŠ¨æ€§å·®çš„é—®é¢˜ã€‚æœ¬æ–‡å°†åŸºäºSpringBootæ¡†æ¶ï¼Œè®¾è®¡å¹¶å®ç°ä¸€ä¸ªå…¬æ­£ã€æœ‰è¶£ã€å¥½ç©çš„å¹´ä¼šæŠ½å¥–ç³»ç»Ÿï¼Œç¡®ä¿æŠ½å¥–è¿‡ç¨‹çš„é€æ˜æ€§å’Œéšæœºæ€§ï¼ŒåŒæ—¶å¢åŠ å¤šç§äº’åŠ¨åŠŸèƒ½ã€‚</p>
<h4 data-id="heading-2">ç³»ç»Ÿæ ¸å¿ƒè®¾è®¡åŸåˆ™ï¼š</h4>
<ol>
<li><strong>å…¬æ­£æ€§</strong>ï¼šä½¿ç”¨åŠ å¯†éšæœºç®—æ³•ï¼Œç¡®ä¿ç»“æœä¸å¯é¢„æµ‹</li>
<li><strong>è¶£å‘³æ€§</strong>ï¼šå¤šç§æŠ½å¥–æ¨¡å¼ï¼ŒåŠ¨ç”»æ•ˆæœï¼Œå®æ—¶äº’åŠ¨</li>
<li><strong>å¯é æ€§</strong>ï¼šé«˜å¹¶å‘æ”¯æŒï¼Œæ•°æ®æŒä¹…åŒ–ï¼Œæ“ä½œæ—¥å¿—</li>
<li><strong>æ˜“ç”¨æ€§</strong>ï¼šç®€æ´çš„Webç•Œé¢ï¼Œæ˜“äºéƒ¨ç½²å’Œç®¡ç†</li>
</ol>
<h3 data-id="heading-3">äºŒã€æŠ€æœ¯æ ˆé€‰å‹</h3>
<ul>
<li><strong>åç«¯æ¡†æ¶</strong>ï¼šSpringBoot 2.7.x</li>
<li><strong>å‰ç«¯æŠ€æœ¯</strong>ï¼šThymeleaf + Bootstrap 5 + jQuery</li>
<li><strong>æ•°æ®åº“</strong>ï¼šMySQL 8.0 + Redis 7.0</li>
<li><strong>å®æ—¶é€šä¿¡</strong>ï¼šWebSocket</li>
<li><strong>å®‰å…¨æ¡†æ¶</strong>ï¼šSpring Security</li>
<li><strong>æ„å»ºå·¥å…·</strong>ï¼šMaven 3.8+</li>
</ul>
<h3 data-id="heading-4">ä¸‰ã€é¡¹ç›®ç»“æ„è®¾è®¡</h3>
<pre><code class="hljs language-bash" lang="bash">lottery-system/
â”œâ”€â”€ src/main/java/com/lottery/
â”‚   â”œâ”€â”€ config/          <span class="hljs-comment"># é…ç½®ç±»</span>
â”‚   â”œâ”€â”€ controller/      <span class="hljs-comment"># æ§åˆ¶å™¨å±‚</span>
â”‚   â”œâ”€â”€ service/         <span class="hljs-comment"># ä¸šåŠ¡é€»è¾‘å±‚</span>
â”‚   â”œâ”€â”€ repository/      <span class="hljs-comment"># æ•°æ®è®¿é—®å±‚</span>
â”‚   â”œâ”€â”€ model/          <span class="hljs-comment"># å®ä½“ç±»</span>
â”‚   â”œâ”€â”€ utils/          <span class="hljs-comment"># å·¥å…·ç±»</span>
â”‚   â”œâ”€â”€ aspect/         <span class="hljs-comment"># AOPåˆ‡é¢</span>
â”‚   â””â”€â”€ security/       <span class="hljs-comment"># å®‰å…¨é…ç½®</span>
â”œâ”€â”€ src/main/resources/
â”‚   â”œâ”€â”€ static/         <span class="hljs-comment"># é™æ€èµ„æº</span>
â”‚   â””â”€â”€ templates/      <span class="hljs-comment"># æ¨¡æ¿æ–‡ä»¶</span>
â””â”€â”€ pom.xml
</code></pre>
<h3 data-id="heading-5">å››ã€æ•°æ®åº“è®¾è®¡</h3>
<h4 data-id="heading-6">4.1 æ ¸å¿ƒè¡¨ç»“æ„</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- å‘˜å·¥è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> employee (
    id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,
    employee_id <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">UNIQUE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    department <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>),
    avatar_url <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">500</span>),
    is_attended <span class="hljs-type">BOOLEAN</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-literal">false</span>,
    created_time DATETIME <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>
);

<span class="hljs-comment">-- å¥–å“è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> prize (
    id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,
    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    level <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'å¥–å“ç­‰çº§ï¼š1-ç‰¹ç­‰å¥–ï¼Œ2-ä¸€ç­‰å¥–ï¼Œ3-äºŒç­‰å¥–...'</span>,
    total_count <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    remain_count <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    image_url <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">500</span>),
    description TEXT,
    created_time DATETIME <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>
);

<span class="hljs-comment">-- ä¸­å¥–è®°å½•è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> winning_record (
    id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,
    employee_id <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    prize_id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    draw_time DATETIME <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>,
    draw_method <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>) COMMENT <span class="hljs-string">'æŠ½å¥–æ–¹å¼'</span>,
    <span class="hljs-keyword">FOREIGN</span> KEY (employee_id) <span class="hljs-keyword">REFERENCES</span> employee(employee_id),
    <span class="hljs-keyword">FOREIGN</span> KEY (prize_id) <span class="hljs-keyword">REFERENCES</span> prize(id)
);

<span class="hljs-comment">-- æŠ½å¥–æ´»åŠ¨è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> lottery_event (
    id <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREMENT,
    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    start_time DATETIME,
    end_time DATETIME,
    status <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'NOT_STARTED'</span>,
    settings JSON COMMENT <span class="hljs-string">'æ´»åŠ¨é…ç½®'</span>
);
</code></pre>
<h3 data-id="heading-7">äº”ã€æ ¸å¿ƒåŠŸèƒ½å®ç°</h3>
<h4 data-id="heading-8">5.1 é¡¹ç›®ä¾èµ–é…ç½®</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- pom.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- Spring Boot Starter --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-websocket<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- æ•°æ®åº“ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- å·¥å…·ç±» --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.commons<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-lang3<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.12.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.google.guava<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>guava<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>31.1-jre<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- JSONå¤„ç† --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jackson-databind<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h4 data-id="heading-9">5.2 å‘˜å·¥å®ä½“ç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "employee")</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@NoArgsConstructor</span>
<span class="hljs-meta">@AllArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;
    
    <span class="hljs-meta">@Column(name = "employee_id", unique = true, nullable = false)</span>
    <span class="hljs-keyword">private</span> String employeeId;
    
    <span class="hljs-meta">@Column(nullable = false)</span>
    <span class="hljs-keyword">private</span> String name;
    
    <span class="hljs-keyword">private</span> String department;
    <span class="hljs-keyword">private</span> String avatarUrl;
    
    <span class="hljs-meta">@Column(name = "is_attended")</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">Boolean</span> <span class="hljs-variable">isAttended</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
    
    <span class="hljs-meta">@CreationTimestamp</span>
    <span class="hljs-meta">@Column(name = "created_time", updatable = false)</span>
    <span class="hljs-keyword">private</span> LocalDateTime createdTime;
    
    <span class="hljs-meta">@Transient</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">Boolean</span> <span class="hljs-variable">isWinner</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<h4 data-id="heading-10">5.3 æŠ½å¥–æœåŠ¡æ ¸å¿ƒå®ç°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LotteryService</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> EmployeeRepository employeeRepository;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> PrizeRepository prizeRepository;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> WinningRecordRepository winningRecordRepository;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> StringRedisTemplate redisTemplate;
    
    <span class="hljs-comment">/**
     * æ ¸å¿ƒæŠ½å¥–ç®—æ³• - ä½¿ç”¨åŠ å¯†å®‰å…¨çš„éšæœºæ•°
     */</span>
    <span class="hljs-keyword">public</span> LotteryResult <span class="hljs-title function_">drawPrize</span><span class="hljs-params">(Long prizeId, String drawMethod)</span> {
        <span class="hljs-type">Prize</span> <span class="hljs-variable">prize</span> <span class="hljs-operator">=</span> prizeRepository.findById(prizeId)
            .orElseThrow(() -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"å¥–å“ä¸å­˜åœ¨"</span>));
            
        <span class="hljs-keyword">if</span> (prize.getRemainCount() &lt;= <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"è¯¥å¥–å“å·²æŠ½å®Œ"</span>);
        }
        
        <span class="hljs-comment">// è·å–æ‰€æœ‰æœªä¸­å¥–çš„å‚ä¼šå‘˜å·¥</span>
        List&lt;Employee&gt; candidates = employeeRepository.findByIsAttendedTrueAndIsWinnerFalse();
        <span class="hljs-keyword">if</span> (candidates.isEmpty()) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„æŠ½å¥–äººå‘˜"</span>);
        }
        
        <span class="hljs-comment">// ä½¿ç”¨SecureRandomç¡®ä¿éšæœºæ€§</span>
        <span class="hljs-type">SecureRandom</span> <span class="hljs-variable">secureRandom</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecureRandom</span>();
        <span class="hljs-type">byte</span>[] randomBytes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">32</span>];
        secureRandom.nextBytes(randomBytes);
        
        <span class="hljs-comment">// åŸºäºå“ˆå¸Œå€¼é€‰æ‹©ä¸­å¥–è€…</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> Math.abs(Arrays.hashCode(randomBytes)) % candidates.size();
        <span class="hljs-type">Employee</span> <span class="hljs-variable">winner</span> <span class="hljs-operator">=</span> candidates.get(index);
        
        <span class="hljs-comment">// ä¿å­˜ä¸­å¥–è®°å½•</span>
        <span class="hljs-type">WinningRecord</span> <span class="hljs-variable">record</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WinningRecord</span>();
        record.setEmployeeId(winner.getEmployeeId());
        record.setPrizeId(prizeId);
        record.setDrawMethod(drawMethod);
        record.setDrawTime(LocalDateTime.now());
        winningRecordRepository.save(record);
        
        <span class="hljs-comment">// æ›´æ–°å¥–å“å‰©ä½™æ•°é‡</span>
        prize.setRemainCount(prize.getRemainCount() - <span class="hljs-number">1</span>);
        prizeRepository.save(prize);
        
        <span class="hljs-comment">// æ ‡è®°å‘˜å·¥ä¸ºä¸­å¥–çŠ¶æ€ï¼ˆå®é™…ä¸­å¯èƒ½éœ€è¦æ›´å¤æ‚çš„é€»è¾‘ï¼‰</span>
        markEmployeeAsWinner(winner.getId());
        
        <span class="hljs-comment">// å‘é€WebSocketé€šçŸ¥</span>
        sendWinningNotification(winner, prize);
        
        <span class="hljs-keyword">return</span> LotteryResult.builder()
                .winner(winner)
                .prize(prize)
                .drawTime(LocalDateTime.now())
                .drawId(record.getId())
                .build();
    }
    
    <span class="hljs-comment">/**
     * æ‰¹é‡å¯¼å…¥å‘˜å·¥
     */</span>
    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">importEmployees</span><span class="hljs-params">(MultipartFile file)</span> {
        <span class="hljs-keyword">try</span> {
            List&lt;Employee&gt; employees = parseEmployeeFile(file);
            employeeRepository.saveAll(employees);
            log.info(<span class="hljs-string">"æˆåŠŸå¯¼å…¥{}åå‘˜å·¥"</span>, employees.size());
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"å¯¼å…¥å‘˜å·¥å¤±è´¥"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"å¯¼å…¥å¤±è´¥: "</span> + e.getMessage());
        }
    }
    
    <span class="hljs-comment">/**
     * å¤šç§æŠ½å¥–æ¨¡å¼
     */</span>
    <span class="hljs-keyword">public</span> LotteryResult <span class="hljs-title function_">drawWithMode</span><span class="hljs-params">(Prize prize, DrawMode mode)</span> {
        <span class="hljs-keyword">switch</span> (mode) {
            <span class="hljs-keyword">case</span> RANDOM:
                <span class="hljs-keyword">return</span> randomDraw(prize);
            <span class="hljs-keyword">case</span> LUCKY_NUMBER:
                <span class="hljs-keyword">return</span> luckyNumberDraw(prize);
            <span class="hljs-keyword">case</span> ROULETTE:
                <span class="hljs-keyword">return</span> rouletteDraw(prize);
            <span class="hljs-keyword">case</span> GRID:
                <span class="hljs-keyword">return</span> gridDraw(prize);
            <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">return</span> randomDraw(prize);
        }
    }
    
    <span class="hljs-comment">/**
     * è½®ç›˜æŠ½å¥–ç®—æ³•
     */</span>
    <span class="hljs-keyword">private</span> LotteryResult <span class="hljs-title function_">rouletteDraw</span><span class="hljs-params">(Prize prize)</span> {
        List&lt;Employee&gt; candidates = getValidCandidates();
        
        <span class="hljs-comment">// ä¸ºæ¯ä¸ªå€™é€‰äººåˆ†é…æƒé‡ï¼ˆè¿™é‡Œç®€å•æŒ‰éƒ¨é—¨åˆ†é…ä¸åŒæƒé‡ï¼‰</span>
        Map&lt;Employee, Double&gt; weights = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        <span class="hljs-keyword">for</span> (Employee emp : candidates) {
            <span class="hljs-type">double</span> <span class="hljs-variable">weight</span> <span class="hljs-operator">=</span> getDepartmentWeight(emp.getDepartment());
            weights.put(emp, weight);
        }
        
        <span class="hljs-comment">// è½®ç›˜é€‰æ‹©</span>
        <span class="hljs-type">Employee</span> <span class="hljs-variable">winner</span> <span class="hljs-operator">=</span> rouletteSelect(weights);
        <span class="hljs-keyword">return</span> createLotteryResult(winner, prize, <span class="hljs-string">"ROULETTE"</span>);
    }
    
    <span class="hljs-keyword">private</span> Employee <span class="hljs-title function_">rouletteSelect</span><span class="hljs-params">(Map&lt;Employee, Double&gt; weights)</span> {
        <span class="hljs-type">double</span> <span class="hljs-variable">totalWeight</span> <span class="hljs-operator">=</span> weights.values().stream().mapToDouble(Double::doubleValue).sum();
        <span class="hljs-type">double</span> <span class="hljs-variable">random</span> <span class="hljs-operator">=</span> Math.random() * totalWeight;
        
        <span class="hljs-type">double</span> <span class="hljs-variable">cumulativeWeight</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.0</span>;
        <span class="hljs-keyword">for</span> (Map.Entry&lt;Employee, Double&gt; entry : weights.entrySet()) {
            cumulativeWeight += entry.getValue();
            <span class="hljs-keyword">if</span> (random &lt;= cumulativeWeight) {
                <span class="hljs-keyword">return</span> entry.getKey();
            }
        }
        
        <span class="hljs-keyword">return</span> weights.keySet().iterator().next();
    }
}
</code></pre>
<h4 data-id="heading-11">5.4 WebSocketå®æ—¶é€šä¿¡</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@EnableWebSocket</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebSocketConfigurer</span> {
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerWebSocketHandlers</span><span class="hljs-params">(WebSocketHandlerRegistry registry)</span> {
        registry.addHandler(lotteryWebSocketHandler(), <span class="hljs-string">"/ws/lottery"</span>)
                .setAllowedOrigins(<span class="hljs-string">"*"</span>)
                .withSockJS();
    }
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> WebSocketHandler <span class="hljs-title function_">lotteryWebSocketHandler</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LotteryWebSocketHandler</span>();
    }
}

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LotteryWebSocketHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">TextWebSocketHandler</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Map&lt;String, WebSocketSession&gt; sessions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterConnectionEstablished</span><span class="hljs-params">(WebSocketSession session)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">sessionId</span> <span class="hljs-operator">=</span> session.getId();
        sessions.put(sessionId, session);
        
        <span class="hljs-comment">// å‘é€æ¬¢è¿æ¶ˆæ¯</span>
        sendMessage(session, <span class="hljs-string">"æ¬¢è¿åŠ å…¥å¹´ä¼šæŠ½å¥–ï¼"</span>);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleTextMessage</span><span class="hljs-params">(WebSocketSession session, TextMessage message)</span> {
        <span class="hljs-comment">// å¤„ç†å®¢æˆ·ç«¯æ¶ˆæ¯</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> message.getPayload();
        <span class="hljs-comment">// å¤„ç†ä¸šåŠ¡é€»è¾‘...</span>
    }
    
    <span class="hljs-comment">/**
     * å¹¿æ’­ä¸­å¥–æ¶ˆæ¯
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">broadcastWinningMessage</span><span class="hljs-params">(Employee winner, Prize prize)</span> {
        Map&lt;String, Object&gt; message = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        message.put(<span class="hljs-string">"type"</span>, <span class="hljs-string">"WINNING_NOTIFICATION"</span>);
        message.put(<span class="hljs-string">"winner"</span>, winner.getName());
        message.put(<span class="hljs-string">"prize"</span>, prize.getName());
        message.put(<span class="hljs-string">"department"</span>, winner.getDepartment());
        message.put(<span class="hljs-string">"time"</span>, LocalDateTime.now().format(DateTimeFormatter.ISO_LOCAL_TIME));
        
        <span class="hljs-type">String</span> <span class="hljs-variable">jsonMessage</span> <span class="hljs-operator">=</span> JSON.toJSONString(message);
        
        sessions.values().forEach(session -&gt; {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">if</span> (session.isOpen()) {
                    session.sendMessage(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TextMessage</span>(jsonMessage));
                }
            } <span class="hljs-keyword">catch</span> (IOException e) {
                log.error(<span class="hljs-string">"å‘é€WebSocketæ¶ˆæ¯å¤±è´¥"</span>, e);
            }
        });
    }
}
</code></pre>
<h4 data-id="heading-12">5.5 æŠ½å¥–æ§åˆ¶å™¨</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Controller</span>
<span class="hljs-meta">@RequestMapping("/lottery")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LotteryController</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> LotteryService lotteryService;
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> LotteryWebSocketHandler webSocketHandler;
    
    <span class="hljs-comment">/**
     * æŠ½å¥–é¡µé¢
     */</span>
    <span class="hljs-meta">@GetMapping("/draw")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">drawPage</span><span class="hljs-params">(Model model)</span> {
        List&lt;Prize&gt; availablePrizes = lotteryService.getAvailablePrizes();
        List&lt;Employee&gt; attendees = lotteryService.getAttendees();
        
        model.addAttribute(<span class="hljs-string">"prizes"</span>, availablePrizes);
        model.addAttribute(<span class="hljs-string">"attendees"</span>, attendees);
        model.addAttribute(<span class="hljs-string">"totalAttendees"</span>, attendees.size());
        
        <span class="hljs-keyword">return</span> <span class="hljs-string">"lottery/draw"</span>;
    }
    
    <span class="hljs-comment">/**
     * æ‰§è¡ŒæŠ½å¥–
     */</span>
    <span class="hljs-meta">@PostMapping("/execute")</span>
    <span class="hljs-meta">@ResponseBody</span>
    <span class="hljs-keyword">public</span> ApiResponse&lt;LotteryResult&gt; <span class="hljs-title function_">executeDraw</span><span class="hljs-params">(
            <span class="hljs-meta">@RequestParam</span> Long prizeId,
            <span class="hljs-meta">@RequestParam(defaultValue = "RANDOM")</span> String mode)</span> {
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">LotteryResult</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> lotteryService.drawWithMode(prizeId, mode);
            
            <span class="hljs-comment">// å‘é€å®æ—¶é€šçŸ¥</span>
            webSocketHandler.broadcastWinningMessage(
                result.getWinner(), 
                result.getPrize()
            );
            
            <span class="hljs-keyword">return</span> ApiResponse.success(result);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">return</span> ApiResponse.error(e.getMessage());
        }
    }
    
    <span class="hljs-comment">/**
     * å¤§å±å¹•æ˜¾ç¤º
     */</span>
    <span class="hljs-meta">@GetMapping("/screen")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">bigScreen</span><span class="hljs-params">(Model model)</span> {
        List&lt;WinningRecord&gt; recentWinners = lotteryService.getRecentWinners(<span class="hljs-number">10</span>);
        model.addAttribute(<span class="hljs-string">"winners"</span>, recentWinners);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"lottery/screen"</span>;
    }
    
    <span class="hljs-comment">/**
     * æ•°æ®ç»Ÿè®¡
     */</span>
    <span class="hljs-meta">@GetMapping("/statistics")</span>
    <span class="hljs-meta">@ResponseBody</span>
    <span class="hljs-keyword">public</span> ApiResponse&lt;Statistics&gt; <span class="hljs-title function_">getStatistics</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Statistics</span> <span class="hljs-variable">stats</span> <span class="hljs-operator">=</span> lotteryService.getLotteryStatistics();
        <span class="hljs-keyword">return</span> ApiResponse.success(stats);
    }
}
</code></pre>
<h4 data-id="heading-13">5.6 å‰ç«¯æŠ½å¥–é¡µé¢å®ç°</h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">"http://www.thymeleaf.org"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>å¹´ä¼šæŠ½å¥–ç³»ç»Ÿ<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- Bootstrap CSS --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.1.3/css/bootstrap.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://cdn.bootcdn.net/ajax/libs/font-awesome/6.0.0/css/all.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-class">.lottery-container</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">135deg</span>, <span class="hljs-number">#667eea</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#764ba2</span> <span class="hljs-number">100%</span>);
            <span class="hljs-attribute">min-height</span>: <span class="hljs-number">100vh</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
        }
        
        <span class="hljs-selector-class">.prize-card</span> {
            <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;
            <span class="hljs-attribute">cursor</span>: pointer;
        }
        
        <span class="hljs-selector-class">.prize-card</span><span class="hljs-selector-pseudo">:hover</span> {
            <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">5px</span>);
            <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">10px</span> <span class="hljs-number">20px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.2</span>);
        }
        
        <span class="hljs-selector-class">.lottery-wheel</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">500px</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">500px</span>;
            <span class="hljs-attribute">position</span>: relative;
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;
        }
        
        <span class="hljs-selector-class">.wheel-canvas</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
        }
        
        <span class="hljs-selector-class">.winner-display</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">255</span>,<span class="hljs-number">0.9</span>);
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">15px</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">animation</span>: slideIn <span class="hljs-number">0.5s</span> ease;
        }
        
        <span class="hljs-keyword">@keyframes</span> slideIn {
            <span class="hljs-selector-tag">from</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">50px</span>); <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>; }
            <span class="hljs-selector-tag">to</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">0</span>); <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>; }
        }
        
        <span class="hljs-selector-class">.confetti</span> {
            <span class="hljs-attribute">position</span>: fixed;
            <span class="hljs-attribute">width</span>: <span class="hljs-number">15px</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">15px</span>;
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#f00</span>;
            <span class="hljs-attribute">top</span>: -<span class="hljs-number">10px</span>;
            <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
        }
        
        <span class="hljs-keyword">@keyframes</span> confetti-fall {
            <span class="hljs-number">0%</span> { <span class="hljs-attribute">top</span>: -<span class="hljs-number">10px</span>; <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>; }
            <span class="hljs-number">100%</span> { <span class="hljs-attribute">top</span>: <span class="hljs-number">100vh</span>; <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>; }
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"lottery-container"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- æ ‡é¢˜åŒºåŸŸ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-center text-white mb-5"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"display-3 fw-bold"</span>&gt;</span>ğŸ‰ å¹´ä¼šå¹¸è¿å¤§æŠ½å¥– ğŸ‰<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"lead"</span>&gt;</span>æ¢¦æƒ³æˆçœŸï¼Œå¹¸è¿é™ä¸´<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            
            <span class="hljs-comment">&lt;!-- æŠ½å¥–ä¸»åŒºåŸŸ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"row"</span>&gt;</span>
                <span class="hljs-comment">&lt;!-- å·¦ä¾§ï¼šå¥–å“é€‰æ‹© --&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-md-4"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-header bg-primary text-white"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">h5</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mb-0"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-gift"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> å¥–å“åˆ—è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-body"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"prizeList"</span>&gt;</span>
                            <span class="hljs-comment">&lt;!-- å¥–å“åˆ—è¡¨åŠ¨æ€åŠ è½½ --&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    
                    <span class="hljs-comment">&lt;!-- æŠ½å¥–æ§åˆ¶ --&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card mt-3"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-body"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mb-3"</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-label"</span>&gt;</span>æŠ½å¥–æ¨¡å¼<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-select"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"drawMode"</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"RANDOM"</span>&gt;</span>éšæœºæŠ½å¥–<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"ROULETTE"</span>&gt;</span>å¹¸è¿è½®ç›˜<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"GRID"</span>&gt;</span>ä¹å®«æ ¼æŠ½å¥–<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"LUCKY_NUMBER"</span>&gt;</span>å¹¸è¿æ•°å­—<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
                                <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-danger btn-lg w-100"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"drawButton"</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-play"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> å¼€å§‹æŠ½å¥–
                            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                
                <span class="hljs-comment">&lt;!-- ä¸­é—´ï¼šæŠ½å¥–åŠ¨ç”» --&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-md-4"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"lottery-wheel"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"wheelCanvas"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"wheel-canvas"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-center mt-3"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"winner-display"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"winnerDisplay"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display:none;"</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">h4</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-success"</span>&gt;</span>ğŸŠ æ­å–œä¸­å¥–ï¼ ğŸŠ<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"winnerName"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fw-bold"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è·å¾—ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"prizeName"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-primary"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                
                <span class="hljs-comment">&lt;!-- å³ä¾§ï¼šä¸­å¥–åå• --&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-md-4"</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-header bg-success text-white"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">h5</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mb-0"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"fas fa-trophy"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span> ä¸­å¥–åå•<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-body"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"winnerList"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"list-group"</span>&gt;</span>
                                <span class="hljs-comment">&lt;!-- ä¸­å¥–åå•åŠ¨æ€åŠ è½½ --&gt;</span>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    
                    <span class="hljs-comment">&lt;!-- ç»Ÿè®¡æ•°æ® --&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card mt-3"</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-body"</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">h6</span>&gt;</span>æŠ½å¥–ç»Ÿè®¡<span class="hljs-tag">&lt;/<span class="hljs-name">h6</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"row text-center"</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-6"</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"display-6"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"totalAttendees"</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">small</span>&gt;</span>å‚ä¼šäººæ•°<span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span>
                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-6"</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"display-6"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"totalWinners"</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                                    <span class="hljs-tag">&lt;<span class="hljs-name">small</span>&gt;</span>å·²ä¸­å¥–äººæ•°<span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span>
                                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- WebSocketè¿æ¥ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcdn.net/ajax/libs/sockjs-client/1.6.1/sockjs.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcdn.net/ajax/libs/stomp.js/2.3.3/stomp.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcdn.net/ajax/libs/bootstrap/5.1.3/js/bootstrap.bundle.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">class</span> <span class="hljs-title class_">LotterySystem</span> {
            <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">stompClient</span> = <span class="hljs-literal">null</span>;
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentPrizeId</span> = <span class="hljs-literal">null</span>;
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span> = <span class="hljs-literal">false</span>;
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();
            }
            
            <span class="hljs-title function_">init</span>(<span class="hljs-params"/>) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadPrizes</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadWinners</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadStatistics</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">connectWebSocket</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">bindEvents</span>();
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initWheel</span>();
            }
            
            <span class="hljs-title function_">connectWebSocket</span>(<span class="hljs-params"/>) {
                <span class="hljs-keyword">const</span> socket = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SockJS</span>(<span class="hljs-string">'/ws/lottery'</span>);
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">stompClient</span> = <span class="hljs-title class_">Stomp</span>.<span class="hljs-title function_">over</span>(socket);
                
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">stompClient</span>.<span class="hljs-title function_">connect</span>({}, <span class="hljs-function">(<span class="hljs-params">frame</span>) =&gt;</span> {
                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Connected: '</span> + frame);
                    
                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stompClient</span>.<span class="hljs-title function_">subscribe</span>(<span class="hljs-string">'/topic/winners'</span>, <span class="hljs-function">(<span class="hljs-params">message</span>) =&gt;</span> {
                        <span class="hljs-keyword">const</span> notification = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(message.<span class="hljs-property">body</span>);
                        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showWinningNotification</span>(notification);
                        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadWinners</span>();
                        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadStatistics</span>();
                    });
                });
            }
            
            <span class="hljs-title function_">loadPrizes</span>(<span class="hljs-params"/>) {
                $.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/lottery/prizes'</span>, <span class="hljs-function">(<span class="hljs-params">prizes</span>) =&gt;</span> {
                    <span class="hljs-keyword">const</span> container = $(<span class="hljs-string">'#prizeList'</span>);
                    container.<span class="hljs-title function_">empty</span>();
                    
                    prizes.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">prize</span> =&gt;</span> {
                        <span class="hljs-keyword">const</span> card = <span class="hljs-string">`
                            &lt;div class="card prize-card mb-2" data-prize-id="<span class="hljs-subst">${prize.id}</span>"&gt;
                                &lt;div class="card-body"&gt;
                                    &lt;h6 class="card-title"&gt;<span class="hljs-subst">${prize.name}</span>&lt;/h6&gt;
                                    &lt;p class="card-text text-muted small"&gt;å‰©ä½™: <span class="hljs-subst">${prize.remainCount}</span>/<span class="hljs-subst">${prize.totalCount}</span>&lt;/p&gt;
                                &lt;/div&gt;
                            &lt;/div&gt;
                        `</span>;
                        container.<span class="hljs-title function_">append</span>(card);
                    });
                    
                    <span class="hljs-comment">// ç»‘å®šé€‰æ‹©äº‹ä»¶</span>
                    $(<span class="hljs-string">'.prize-card'</span>).<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
                        $(<span class="hljs-string">'.prize-card'</span>).<span class="hljs-title function_">removeClass</span>(<span class="hljs-string">'border-primary'</span>);
                        $(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">addClass</span>(<span class="hljs-string">'border-primary border-3'</span>);
                        <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentPrizeId</span> = $(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">data</span>(<span class="hljs-string">'prize-id'</span>);
                    });
                });
            }
            
            <span class="hljs-title function_">loadWinners</span>(<span class="hljs-params"/>) {
                $.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/lottery/recent-winners'</span>, <span class="hljs-function">(<span class="hljs-params">winners</span>) =&gt;</span> {
                    <span class="hljs-keyword">const</span> container = $(<span class="hljs-string">'#winnerList'</span>);
                    container.<span class="hljs-title function_">empty</span>();
                    
                    winners.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">record</span> =&gt;</span> {
                        <span class="hljs-keyword">const</span> item = <span class="hljs-string">`
                            &lt;div class="list-group-item"&gt;
                                &lt;div class="d-flex w-100 justify-content-between"&gt;
                                    &lt;h6 class="mb-1"&gt;<span class="hljs-subst">${record.employeeName}</span>&lt;/h6&gt;
                                    &lt;small&gt;<span class="hljs-subst">${record.department}</span>&lt;/small&gt;
                                &lt;/div&gt;
                                &lt;p class="mb-1"&gt;<span class="hljs-subst">${record.prizeName}</span>&lt;/p&gt;
                                &lt;small class="text-muted"&gt;<span class="hljs-subst">${record.drawTime}</span>&lt;/small&gt;
                            &lt;/div&gt;
                        `</span>;
                        container.<span class="hljs-title function_">prepend</span>(item);
                    });
                });
            }
            
            <span class="hljs-title function_">loadStatistics</span>(<span class="hljs-params"/>) {
                $.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/lottery/statistics'</span>, <span class="hljs-function">(<span class="hljs-params">stats</span>) =&gt;</span> {
                    $(<span class="hljs-string">'#totalAttendees'</span>).<span class="hljs-title function_">text</span>(stats.<span class="hljs-property">totalAttendees</span>);
                    $(<span class="hljs-string">'#totalWinners'</span>).<span class="hljs-title function_">text</span>(stats.<span class="hljs-property">totalWinners</span>);
                });
            }
            
            <span class="hljs-title function_">bindEvents</span>(<span class="hljs-params"/>) {
                $(<span class="hljs-string">'#drawButton'</span>).<span class="hljs-title function_">click</span>(<span class="hljs-function">() =&gt;</span> {
                    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentPrizeId</span>) {
                        <span class="hljs-title function_">alert</span>(<span class="hljs-string">'è¯·å…ˆé€‰æ‹©å¥–å“ï¼'</span>);
                        <span class="hljs-keyword">return</span>;
                    }
                    
                    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span>) {
                        <span class="hljs-title function_">alert</span>(<span class="hljs-string">'æ­£åœ¨æŠ½å¥–ä¸­ï¼Œè¯·ç¨å€™...'</span>);
                        <span class="hljs-keyword">return</span>;
                    }
                    
                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span> = <span class="hljs-literal">true</span>;
                    $(<span class="hljs-string">'#drawButton'</span>).<span class="hljs-title function_">prop</span>(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">true</span>).<span class="hljs-title function_">html</span>(<span class="hljs-string">'&lt;i class="fas fa-spinner fa-spin"&gt;&lt;/i&gt; æŠ½å¥–ä¸­...'</span>);
                    
                    <span class="hljs-keyword">const</span> drawMode = $(<span class="hljs-string">'#drawMode'</span>).<span class="hljs-title function_">val</span>();
                    
                    <span class="hljs-comment">// å¼€å§‹æŠ½å¥–åŠ¨ç”»</span>
                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">startWheelAnimation</span>();
                    
                    <span class="hljs-comment">// å‘é€æŠ½å¥–è¯·æ±‚</span>
                    $.<span class="hljs-title function_">ajax</span>({
                        <span class="hljs-attr">url</span>: <span class="hljs-string">'/lottery/execute'</span>,
                        <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
                        <span class="hljs-attr">data</span>: {
                            <span class="hljs-attr">prizeId</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentPrizeId</span>,
                            <span class="hljs-attr">mode</span>: drawMode
                        },
                        <span class="hljs-attr">success</span>: <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
                            <span class="hljs-keyword">if</span> (response.<span class="hljs-property">success</span>) {
                                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
                                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showWinner</span>(response.<span class="hljs-property">data</span>);
                                    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createConfetti</span>();
                                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span> = <span class="hljs-literal">false</span>;
                                    $(<span class="hljs-string">'#drawButton'</span>).<span class="hljs-title function_">prop</span>(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">false</span>).<span class="hljs-title function_">html</span>(<span class="hljs-string">'&lt;i class="fas fa-play"&gt;&lt;/i&gt; å¼€å§‹æŠ½å¥–'</span>);
                                }, <span class="hljs-number">3000</span>);
                            } <span class="hljs-keyword">else</span> {
                                <span class="hljs-title function_">alert</span>(response.<span class="hljs-property">message</span>);
                                <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span> = <span class="hljs-literal">false</span>;
                                $(<span class="hljs-string">'#drawButton'</span>).<span class="hljs-title function_">prop</span>(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">false</span>).<span class="hljs-title function_">html</span>(<span class="hljs-string">'&lt;i class="fas fa-play"&gt;&lt;/i&gt; å¼€å§‹æŠ½å¥–'</span>);
                            }
                        },
                        <span class="hljs-attr">error</span>: <span class="hljs-function">() =&gt;</span> {
                            <span class="hljs-title function_">alert</span>(<span class="hljs-string">'æŠ½å¥–å¤±è´¥ï¼Œè¯·é‡è¯•ï¼'</span>);
                            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span> = <span class="hljs-literal">false</span>;
                            $(<span class="hljs-string">'#drawButton'</span>).<span class="hljs-title function_">prop</span>(<span class="hljs-string">'disabled'</span>, <span class="hljs-literal">false</span>).<span class="hljs-title function_">html</span>(<span class="hljs-string">'&lt;i class="fas fa-play"&gt;&lt;/i&gt; å¼€å§‹æŠ½å¥–'</span>);
                        }
                    });
                });
            }
            
            <span class="hljs-title function_">startWheelAnimation</span>(<span class="hljs-params"/>) {
                <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'wheelCanvas'</span>);
                <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'2d'</span>);
                <span class="hljs-keyword">const</span> centerX = canvas.<span class="hljs-property">width</span> / <span class="hljs-number">2</span>;
                <span class="hljs-keyword">const</span> centerY = canvas.<span class="hljs-property">height</span> / <span class="hljs-number">2</span>;
                <span class="hljs-keyword">const</span> radius = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(centerX, centerY) - <span class="hljs-number">10</span>;
                
                <span class="hljs-keyword">let</span> rotation = <span class="hljs-number">0</span>;
                
                <span class="hljs-keyword">const</span> <span class="hljs-title function_">animate</span> = (<span class="hljs-params"/>) =&gt; {
                    ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>);
                    
                    <span class="hljs-comment">// ç»˜åˆ¶è½¬ç›˜</span>
                    rotation += <span class="hljs-number">0.1</span>;
                    
                    <span class="hljs-comment">// ç»˜åˆ¶æ‰‡å½¢</span>
                    <span class="hljs-keyword">const</span> segments = <span class="hljs-number">12</span>;
                    <span class="hljs-keyword">const</span> segmentAngle = (<span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>) / segments;
                    
                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; segments; i++) {
                        <span class="hljs-keyword">const</span> startAngle = segmentAngle * i + rotation;
                        <span class="hljs-keyword">const</span> endAngle = segmentAngle * (i + <span class="hljs-number">1</span>) + rotation;
                        
                        ctx.<span class="hljs-title function_">beginPath</span>();
                        ctx.<span class="hljs-title function_">moveTo</span>(centerX, centerY);
                        ctx.<span class="hljs-title function_">arc</span>(centerX, centerY, radius, startAngle, endAngle);
                        ctx.<span class="hljs-title function_">closePath</span>();
                        
                        <span class="hljs-comment">// äº¤æ›¿é¢œè‰²</span>
                        ctx.<span class="hljs-property">fillStyle</span> = i % <span class="hljs-number">2</span> === <span class="hljs-number">0</span> ? <span class="hljs-string">'#FF6B6B'</span> : <span class="hljs-string">'#4ECDC4'</span>;
                        ctx.<span class="hljs-title function_">fill</span>();
                        
                        <span class="hljs-comment">// ç»˜åˆ¶æ–‡å­—</span>
                        ctx.<span class="hljs-title function_">save</span>();
                        ctx.<span class="hljs-title function_">translate</span>(centerX, centerY);
                        ctx.<span class="hljs-title function_">rotate</span>(startAngle + segmentAngle / <span class="hljs-number">2</span>);
                        ctx.<span class="hljs-property">textAlign</span> = <span class="hljs-string">'right'</span>;
                        ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">'white'</span>;
                        ctx.<span class="hljs-property">font</span> = <span class="hljs-string">'bold 14px Arial'</span>;
                        ctx.<span class="hljs-title function_">fillText</span>(<span class="hljs-string">'å¹¸è¿'</span>, radius - <span class="hljs-number">20</span>, <span class="hljs-number">10</span>);
                        ctx.<span class="hljs-title function_">restore</span>();
                    }
                    
                    <span class="hljs-comment">// ç»˜åˆ¶æŒ‡é’ˆ</span>
                    ctx.<span class="hljs-title function_">beginPath</span>();
                    ctx.<span class="hljs-title function_">moveTo</span>(centerX, centerY - <span class="hljs-number">20</span>);
                    ctx.<span class="hljs-title function_">lineTo</span>(centerX, centerY - radius + <span class="hljs-number">20</span>);
                    ctx.<span class="hljs-title function_">lineTo</span>(centerX + <span class="hljs-number">10</span>, centerY - radius);
                    ctx.<span class="hljs-title function_">lineTo</span>(centerX - <span class="hljs-number">10</span>, centerY - radius);
                    ctx.<span class="hljs-title function_">closePath</span>();
                    ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">'#FFD93D'</span>;
                    ctx.<span class="hljs-title function_">fill</span>();
                    
                    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isDrawing</span>) {
                        <span class="hljs-title function_">requestAnimationFrame</span>(animate);
                    }
                };
                
                canvas.<span class="hljs-property">width</span> = <span class="hljs-number">500</span>;
                canvas.<span class="hljs-property">height</span> = <span class="hljs-number">500</span>;
                <span class="hljs-title function_">animate</span>();
            }
            
            <span class="hljs-title function_">showWinner</span>(<span class="hljs-params">result</span>) {
                $(<span class="hljs-string">'#winnerName'</span>).<span class="hljs-title function_">text</span>(result.<span class="hljs-property">winner</span>.<span class="hljs-property">name</span>);
                $(<span class="hljs-string">'#prizeName'</span>).<span class="hljs-title function_">text</span>(result.<span class="hljs-property">prize</span>.<span class="hljs-property">name</span>);
                $(<span class="hljs-string">'#winnerDisplay'</span>).<span class="hljs-title function_">fadeIn</span>();
                
                <span class="hljs-comment">// æ’­æ”¾éŸ³æ•ˆ</span>
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">playSound</span>(<span class="hljs-string">'winning'</span>);
            }
            
            <span class="hljs-title function_">showWinningNotification</span>(<span class="hljs-params">notification</span>) {
                <span class="hljs-comment">// æ˜¾ç¤ºå®æ—¶é€šçŸ¥</span>
                <span class="hljs-keyword">const</span> notificationHtml = <span class="hljs-string">`
                    &lt;div class="toast show" role="alert"&gt;
                        &lt;div class="toast-header bg-success text-white"&gt;
                            &lt;strong class="me-auto"&gt;ğŸ‰ æ­å–œä¸­å¥–ï¼&lt;/strong&gt;
                            &lt;small&gt;åˆšåˆš&lt;/small&gt;
                        &lt;/div&gt;
                        &lt;div class="toast-body"&gt;
                            &lt;strong&gt;<span class="hljs-subst">${notification.winner}</span>&lt;/strong&gt; è·å¾— &lt;strong&gt;<span class="hljs-subst">${notification.prize}</span>&lt;/strong&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                `</span>;
                
                $(<span class="hljs-string">'.toast-container'</span>).<span class="hljs-title function_">remove</span>();
                $(<span class="hljs-string">'body'</span>).<span class="hljs-title function_">append</span>(<span class="hljs-string">`&lt;div class="toast-container position-fixed top-0 end-0 p-3"&gt;<span class="hljs-subst">${notificationHtml}</span>&lt;/div&gt;`</span>);
                
                <span class="hljs-comment">// 5ç§’åè‡ªåŠ¨ç§»é™¤</span>
                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
                    $(<span class="hljs-string">'.toast-container'</span>).<span class="hljs-title function_">remove</span>();
                }, <span class="hljs-number">5000</span>);
            }
            
            <span class="hljs-title function_">createConfetti</span>(<span class="hljs-params"/>) {
                <span class="hljs-keyword">const</span> colors = [<span class="hljs-string">'#FF6B6B'</span>, <span class="hljs-string">'#4ECDC4'</span>, <span class="hljs-string">'#FFD93D'</span>, <span class="hljs-string">'#6BCF7F'</span>];
                
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {
                    <span class="hljs-keyword">const</span> confetti = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
                    confetti.<span class="hljs-property">className</span> = <span class="hljs-string">'confetti'</span>;
                    confetti.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">100</span> + <span class="hljs-string">'vw'</span>;
                    confetti.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundColor</span> = colors[<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * colors.<span class="hljs-property">length</span>)];
                    confetti.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">10</span> + <span class="hljs-number">5</span> + <span class="hljs-string">'px'</span>;
                    confetti.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">10</span> + <span class="hljs-number">5</span> + <span class="hljs-string">'px'</span>;
                    confetti.<span class="hljs-property">style</span>.<span class="hljs-property">animation</span> = <span class="hljs-string">`confetti-fall <span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">3</span> + <span class="hljs-number">2</span>}</span>s linear forwards`</span>;
                    confetti.<span class="hljs-property">style</span>.<span class="hljs-property">animationDelay</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">1</span> + <span class="hljs-string">'s'</span>;
                    
                    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(confetti);
                    
                    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
                        confetti.<span class="hljs-title function_">remove</span>();
                    }, <span class="hljs-number">5000</span>);
                }
            }
            
            <span class="hljs-title function_">playSound</span>(<span class="hljs-params">type</span>) {
                <span class="hljs-keyword">const</span> audio = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Audio</span>();
                <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'winning'</span>) {
                    audio.<span class="hljs-property">src</span> = <span class="hljs-string">'/sound/winning.mp3'</span>;
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type === <span class="hljs-string">'draw'</span>) {
                    audio.<span class="hljs-property">src</span> = <span class="hljs-string">'/sound/draw.mp3'</span>;
                }
                audio.<span class="hljs-title function_">play</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'éŸ³é¢‘æ’­æ”¾å¤±è´¥:'</span>, e));
            }
            
            <span class="hljs-title function_">initWheel</span>(<span class="hljs-params"/>) {
                <span class="hljs-comment">// åˆå§‹åŒ–æŠ½å¥–è½¬ç›˜</span>
                <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'wheelCanvas'</span>);
                <span class="hljs-keyword">if</span> (canvas.<span class="hljs-property">getContext</span>) {
                    <span class="hljs-comment">// å·²ç»åœ¨ä¸Šé¢çš„startWheelAnimationä¸­åˆå§‹åŒ–äº†</span>
                }
            }
        }
        
        <span class="hljs-comment">// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–</span>
        $(<span class="hljs-variable language_">document</span>).<span class="hljs-title function_">ready</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">window</span>.<span class="hljs-property">lotterySystem</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LotterySystem</span>();
        });
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h3 data-id="heading-14">å…­ã€ç³»ç»Ÿç‰¹è‰²åŠŸèƒ½</h3>
<h4 data-id="heading-15">6.1 å¤šç§æŠ½å¥–æ¨¡å¼</h4>
<ol>
<li><strong>éšæœºæŠ½å¥–</strong>ï¼šå®Œå…¨éšæœºï¼Œç¡®ä¿å…¬å¹³</li>
<li><strong>å¹¸è¿è½®ç›˜</strong>ï¼šè§†è§‰å†²å‡»åŠ›å¼ºï¼Œå¢åŠ è¶£å‘³æ€§</li>
<li><strong>ä¹å®«æ ¼æŠ½å¥–</strong>ï¼šäº’åŠ¨æ€§å¼ºï¼Œé€‚åˆå°å›¢é˜Ÿ</li>
<li><strong>å¹¸è¿æ•°å­—</strong>ï¼šä¸å‘˜å·¥å·¥å·å…³è”ï¼Œå¢åŠ å‚ä¸æ„Ÿ</li>
</ol>
<h4 data-id="heading-16">6.2 å®æ—¶äº’åŠ¨åŠŸèƒ½</h4>
<ul>
<li><strong>WebSocketå®æ—¶é€šçŸ¥</strong>ï¼šä¸­å¥–ç»“æœå®æ—¶æ¨é€åˆ°æ‰€æœ‰å®¢æˆ·ç«¯</li>
<li><strong>å¤§å±å¹•æ˜¾ç¤º</strong>ï¼šä¸“é—¨ä¸ºä¸­å¥–å±•ç¤ºè®¾è®¡çš„å…¨å±ç•Œé¢</li>
<li><strong>å¼¹å¹•äº’åŠ¨</strong>ï¼šå‘˜å·¥å¯ä»¥å‘é€ç¥ç¦å¼¹å¹•</li>
<li><strong>å€’è®¡æ—¶åŠŸèƒ½</strong>ï¼šå¢åŠ ç´§å¼ æ°›å›´</li>
</ul>
<h4 data-id="heading-17">6.3 é˜²ä½œå¼Šæœºåˆ¶</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LotterySecurityService</span> {
    
    <span class="hljs-comment">/**
     * éªŒè¯æŠ½å¥–è¯·æ±‚çš„åˆæ³•æ€§
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">validateDrawRequest</span><span class="hljs-params">(String sessionId, Long prizeId)</span> {
        <span class="hljs-comment">// é˜²æ­¢é¢‘ç¹è¯·æ±‚</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> <span class="hljs-string">"draw:limit:"</span> + sessionId;
        <span class="hljs-type">Long</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> redisTemplate.opsForValue().increment(key, <span class="hljs-number">1</span>);
        
        <span class="hljs-keyword">if</span> (count == <span class="hljs-number">1</span>) {
            redisTemplate.expire(key, <span class="hljs-number">10</span>, TimeUnit.SECONDS);
        }
        
        <span class="hljs-keyword">return</span> count &lt;= <span class="hljs-number">3</span>; <span class="hljs-comment">// 10ç§’å†…æœ€å¤šè¯·æ±‚3æ¬¡</span>
    }
    
    <span class="hljs-comment">/**
     * éªŒè¯å‘˜å·¥èµ„æ ¼
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">validateEmployeeEligibility</span><span class="hljs-params">(String employeeId)</span> {
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦å·²ç­¾åˆ°</span>
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦å·²ä¸­å¥–ï¼ˆé™åˆ¶æ¯äººæœ€å¤šä¸­å¥–æ¬¡æ•°ï¼‰</span>
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ç¬¦åˆç‰¹å®šå¥–å“è¦æ±‚</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-comment">/**
     * ç”ŸæˆæŠ½å¥–è¿‡ç¨‹å®¡è®¡æ—¥å¿—
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">auditDrawProcess</span><span class="hljs-params">(LotteryResult result, String operator)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">auditLog</span> <span class="hljs-operator">=</span> String.format(
            <span class="hljs-string">"æŠ½å¥–å®¡è®¡ - æ“ä½œäºº:%s, å¥–å“:%s, ä¸­å¥–äºº:%s, æ—¶é—´:%s, éšæœºç§å­:%s"</span>,
            operator,
            result.getPrize().getName(),
            result.getWinner().getName(),
            LocalDateTime.now(),
            generateRandomSeed()
        );
        
        log.info(auditLog);
        saveToBlockchain(auditLog); <span class="hljs-comment">// å¯é€‰ï¼šä¿å­˜åˆ°åŒºå—é“¾ç¡®ä¿ä¸å¯ç¯¡æ”¹</span>
    }
}
</code></pre>
<h4 data-id="heading-18">6.4 æ•°æ®ç»Ÿè®¡ä¸åˆ†æ</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StatisticsService</span> {
    
    <span class="hljs-keyword">public</span> LotteryStatistics <span class="hljs-title function_">getStatistics</span><span class="hljs-params">()</span> {
        <span class="hljs-type">LotteryStatistics</span> <span class="hljs-variable">stats</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LotteryStatistics</span>();
        
        <span class="hljs-comment">// åŸºç¡€ç»Ÿè®¡</span>
        stats.setTotalAttendees(employeeRepository.countByIsAttendedTrue());
        stats.setTotalWinners(winningRecordRepository.count());
        stats.setTotalPrizes(prizeRepository.count());
        
        <span class="hljs-comment">// éƒ¨é—¨ä¸­å¥–åˆ†å¸ƒ</span>
        Map&lt;String, Long&gt; deptDistribution = winningRecordRepository
            .getDepartmentDistribution();
        stats.setDepartmentDistribution(deptDistribution);
        
        <span class="hljs-comment">// æ—¶é—´æ®µåˆ†æ</span>
        List&lt;HourlyDraw&gt; hourlyDraws = winningRecordRepository
            .getHourlyDrawCount();
        stats.setHourlyDraws(hourlyDraws);
        
        <span class="hljs-comment">// å¥–å“çƒ­åº¦</span>
        List&lt;PrizePopularity&gt; prizePopularity = winningRecordRepository
            .getPrizePopularity();
        stats.setPrizePopularity(prizePopularity);
        
        <span class="hljs-keyword">return</span> stats;
    }
    
    <span class="hljs-comment">/**
     * ç”ŸæˆæŠ½å¥–æŠ¥å‘Š
     */</span>
    <span class="hljs-keyword">public</span> Report <span class="hljs-title function_">generateReport</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Report</span> <span class="hljs-variable">report</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Report</span>();
        
        <span class="hljs-comment">// æ€»ä½“æƒ…å†µ</span>
        report.setSummary(getSummary());
        
        <span class="hljs-comment">// è¯¦ç»†æ•°æ®</span>
        report.setDetails(getDetailedData());
        
        <span class="hljs-comment">// å›¾è¡¨æ•°æ®</span>
        report.setCharts(getChartData());
        
        <span class="hljs-comment">// åˆ†æç»“è®º</span>
        report.setAnalysis(getAnalysis());
        
        <span class="hljs-keyword">return</span> report;
    }
}
</code></pre>
<h3 data-id="heading-19">ä¸ƒã€éƒ¨ç½²ä¸é…ç½®</h3>
<h4 data-id="heading-20">7.1 åº”ç”¨é…ç½®</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># application.yml</span>
<span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span>
  
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">datasource:</span>
    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://localhost:3306/lottery_db?useSSL=false&amp;serverTimezone=UTC</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">lottery_admin</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">lottery_password</span>
    <span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">com.mysql.cj.jdbc.Driver</span>
    
  <span class="hljs-attr">jpa:</span>
    <span class="hljs-attr">hibernate:</span>
      <span class="hljs-attr">ddl-auto:</span> <span class="hljs-string">update</span>
    <span class="hljs-attr">show-sql:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">properties:</span>
      <span class="hljs-attr">hibernate:</span>
        <span class="hljs-attr">format_sql:</span> <span class="hljs-literal">true</span>
        
  <span class="hljs-attr">redis:</span>
    <span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">6379</span>
    <span class="hljs-attr">password:</span> 
    <span class="hljs-attr">timeout:</span> <span class="hljs-string">5000ms</span>
    
  <span class="hljs-attr">thymeleaf:</span>
    <span class="hljs-attr">cache:</span> <span class="hljs-literal">false</span>
    <span class="hljs-attr">mode:</span> <span class="hljs-string">HTML</span>
    <span class="hljs-attr">encoding:</span> <span class="hljs-string">UTF-8</span>
    
<span class="hljs-attr">lottery:</span>
  <span class="hljs-attr">security:</span>
    <span class="hljs-attr">admin-username:</span> <span class="hljs-string">admin</span>
    <span class="hljs-attr">admin-password:</span> <span class="hljs-string">${ADMIN_PASSWORD:admin123}</span>
    <span class="hljs-attr">jwt-secret:</span> <span class="hljs-string">${JWT_SECRET:lottery-secret-key}</span>
    
  <span class="hljs-attr">draw:</span>
    <span class="hljs-attr">max-attempts-per-minute:</span> <span class="hljs-number">10</span>
    <span class="hljs-attr">cooldown-seconds:</span> <span class="hljs-number">5</span>
    
  <span class="hljs-attr">ui:</span>
    <span class="hljs-attr">title:</span> <span class="hljs-string">å¹´ä¼šå¹¸è¿å¤§æŠ½å¥–</span>
    <span class="hljs-attr">theme:</span> <span class="hljs-string">gradient-blue</span>
    <span class="hljs-attr">animation-enabled:</span> <span class="hljs-literal">true</span>
</code></pre>
<h4 data-id="heading-21">7.2 Dockeréƒ¨ç½²</h4>
<pre><code class="hljs language-dockerfile" lang="dockerfile"># Dockerfile
FROM openjdk:11-jre-slim

WORKDIR /app

COPY target/lottery-system-1.0.0.jar app.jar

RUN mkdir -p /app/logs /app/uploads

ENV TZ=Asia/Shanghai
ENV JAVA_OPTS="-Xmx512m -Xms256m"

EXPOSE 8080

ENTRYPOINT ["sh", "-c", "java $JAVA_OPTS -jar app.jar"]
</code></pre>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># docker-compose.yml</span>
<span class="hljs-attr">version:</span> <span class="hljs-string">'3.8'</span>

<span class="hljs-attr">services:</span>
  <span class="hljs-attr">mysql:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">mysql:8.0</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">MYSQL_ROOT_PASSWORD:</span> <span class="hljs-string">root_password</span>
      <span class="hljs-attr">MYSQL_DATABASE:</span> <span class="hljs-string">lottery_db</span>
      <span class="hljs-attr">MYSQL_USER:</span> <span class="hljs-string">lottery_admin</span>
      <span class="hljs-attr">MYSQL_PASSWORD:</span> <span class="hljs-string">lottery_password</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"3306:3306"</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">mysql_data:/var/lib/mysql</span>
      
  <span class="hljs-attr">redis:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">redis:7-alpine</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"6379:6379"</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">redis_data:/data</span>
      
  <span class="hljs-attr">lottery-app:</span>
    <span class="hljs-attr">build:</span> <span class="hljs-string">.</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"8080:8080"</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">SPRING_DATASOURCE_URL:</span> <span class="hljs-string">jdbc:mysql://mysql:3306/lottery_db</span>
      <span class="hljs-attr">SPRING_REDIS_HOST:</span> <span class="hljs-string">redis</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">mysql</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">redis</span>
      
<span class="hljs-attr">volumes:</span>
  <span class="hljs-attr">mysql_data:</span>
  <span class="hljs-attr">redis_data:</span>
</code></pre>
<h3 data-id="heading-22">å…«ã€ç³»ç»Ÿä¼˜åŒ–ä¸æ‰©å±•</h3>
<h4 data-id="heading-23">8.1 æ€§èƒ½ä¼˜åŒ–</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LotteryOptimizationService</span> {
    
    <span class="hljs-comment">/**
     * ä½¿ç”¨Redisç¼“å­˜çƒ­é—¨æ•°æ®
     */</span>
    <span class="hljs-meta">@Cacheable(value = "prizes", key = "'available'")</span>
    <span class="hljs-keyword">public</span> List&lt;Prize&gt; <span class="hljs-title function_">getAvailablePrizes</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> prizeRepository.findByRemainCountGreaterThan(<span class="hljs-number">0</span>);
    }
    
    <span class="hljs-comment">/**
     * æ‰¹é‡å¤„ç†ä¼˜åŒ–
     */</span>
    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">batchProcessWinners</span><span class="hljs-params">(List&lt;Long&gt; winnerIds, Long prizeId)</span> {
        <span class="hljs-comment">// ä½¿ç”¨æ‰¹é‡æ’å…¥æé«˜æ€§èƒ½</span>
        List&lt;WinningRecord&gt; records = winnerIds.stream()
            .map(employeeId -&gt; {
                <span class="hljs-type">WinningRecord</span> <span class="hljs-variable">record</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WinningRecord</span>();
                record.setEmployeeId(employeeId.toString());
                record.setPrizeId(prizeId);
                <span class="hljs-keyword">return</span> record;
            })
            .collect(Collectors.toList());
            
        winningRecordRepository.saveAll(records);
    }
    
    <span class="hljs-comment">/**
     * å¼‚æ­¥å¤„ç†éæ ¸å¿ƒä¸šåŠ¡
     */</span>
    <span class="hljs-meta">@Async</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">asyncSendNotification</span><span class="hljs-params">(WinningRecord record)</span> {
        <span class="hljs-comment">// å‘é€é‚®ä»¶é€šçŸ¥</span>
        emailService.sendWinningEmail(record);
        
        <span class="hljs-comment">// å‘é€çŸ­ä¿¡é€šçŸ¥</span>
        smsService.sendWinningSMS(record);
        
        <span class="hljs-comment">// è®°å½•æ—¥å¿—</span>
        auditService.logWinningEvent(record);
    }
}
</code></pre>
<h4 data-id="heading-24">8.2 æ‰©å±•åŠŸèƒ½</h4>
<ol>
<li><strong>å¾®ä¿¡å°ç¨‹åºæ¥å…¥</strong>ï¼šå‘˜å·¥æ‰«ç å‚ä¸</li>
<li><strong>äººè„¸è¯†åˆ«ç­¾åˆ°</strong>ï¼šé˜²æ­¢ä»£ç­¾</li>
<li><strong>è™šæ‹Ÿç¤¼ç‰©ç³»ç»Ÿ</strong>ï¼šå‘˜å·¥äº’é€ç¥ç¦</li>
<li><strong>æŠ½å¥–ç­–ç•¥å¼•æ“</strong>ï¼šå¯é…ç½®çš„æŠ½å¥–è§„åˆ™</li>
<li><strong>å¤šä¼šåœºæ”¯æŒ</strong>ï¼šåˆ†å¸ƒå¼æŠ½å¥–åŒæ­¥</li>
</ol>
<h3 data-id="heading-25">ä¹ã€æµ‹è¯•ä¸éªŒè¯</h3>
<h4 data-id="heading-26">9.1 å•å…ƒæµ‹è¯•</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@SpringBootTest</span>
<span class="hljs-meta">@AutoConfigureMockMvc</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LotteryServiceTest</span> {
    
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> MockMvc mockMvc;
    
    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testRandomDraw</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æµ‹è¯•éšæœºæŠ½å¥–çš„å…¬å¹³æ€§</span>
        Map&lt;Long, Integer&gt; winCount = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        <span class="hljs-type">int</span> <span class="hljs-variable">totalTests</span> <span class="hljs-operator">=</span> <span class="hljs-number">10000</span>;
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; totalTests; i++) {
            <span class="hljs-type">LotteryResult</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> lotteryService.drawPrize(<span class="hljs-number">1L</span>, <span class="hljs-string">"RANDOM"</span>);
            <span class="hljs-type">Long</span> <span class="hljs-variable">winnerId</span> <span class="hljs-operator">=</span> result.getWinner().getId();
            winCount.put(winnerId, winCount.getOrDefault(winnerId, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);
        }
        
        <span class="hljs-comment">// éªŒè¯åˆ†å¸ƒæ˜¯å¦å‡åŒ€</span>
        <span class="hljs-type">double</span> <span class="hljs-variable">expectedFrequency</span> <span class="hljs-operator">=</span> totalTests / <span class="hljs-number">100.0</span>; <span class="hljs-comment">// å‡è®¾æœ‰100ä¸ªå€™é€‰äºº</span>
        <span class="hljs-type">double</span> <span class="hljs-variable">chiSquare</span> <span class="hljs-operator">=</span> calculateChiSquare(winCount, expectedFrequency);
        
        assertTrue(chiSquare &lt; <span class="hljs-number">15.0</span>, <span class="hljs-string">"æŠ½å¥–åˆ†å¸ƒä¸å‡åŒ€"</span>);
    }
    
    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testConcurrentDraw</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-comment">// æµ‹è¯•å¹¶å‘æŠ½å¥–</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">threadCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;
        <span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newFixedThreadPool(threadCount);
        <span class="hljs-type">CountDownLatch</span> <span class="hljs-variable">latch</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CountDownLatch</span>(threadCount);
        
        List&lt;Future&lt;LotteryResult&gt;&gt; futures = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; threadCount; i++) {
            Future&lt;LotteryResult&gt; future = executor.submit(() -&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">return</span> lotteryService.drawPrize(<span class="hljs-number">1L</span>, <span class="hljs-string">"RANDOM"</span>);
                } <span class="hljs-keyword">finally</span> {
                    latch.countDown();
                }
            });
            futures.add(future);
        }
        
        latch.await(<span class="hljs-number">10</span>, TimeUnit.SECONDS);
        
        <span class="hljs-comment">// éªŒè¯æ²¡æœ‰é‡å¤ä¸­å¥–</span>
        Set&lt;Long&gt; winnerIds = futures.stream()
            .map(f -&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">return</span> f.get().getWinner().getId();
                } <span class="hljs-keyword">catch</span> (Exception e) {
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
                }
            })
            .filter(Objects::nonNull)
            .collect(Collectors.toSet());
            
        assertEquals(threadCount, winnerIds.size(), <span class="hljs-string">"å­˜åœ¨é‡å¤ä¸­å¥–æƒ…å†µ"</span>);
    }
}
</code></pre>
<h3 data-id="heading-27">åã€æ€»ç»“</h3>
<p>æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨SpringBoot + Javaæ„å»ºä¸€ä¸ªå…¬æ­£ã€æœ‰è¶£ã€å¥½ç©çš„å¹´ä¼šæŠ½å¥–ç³»ç»Ÿã€‚ç³»ç»Ÿå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ol>
<li><strong>å…¬æ­£æ€§ä¿éšœ</strong>ï¼šä½¿ç”¨åŠ å¯†å®‰å…¨çš„éšæœºæ•°ç”Ÿæˆç®—æ³•ï¼Œæ‰€æœ‰æ“ä½œéƒ½æœ‰å®¡è®¡æ—¥å¿—</li>
<li><strong>è¶£å‘³æ€§ä½“éªŒ</strong>ï¼šå¤šç§æŠ½å¥–æ¨¡å¼ï¼Œç‚«é…·çš„åŠ¨ç”»æ•ˆæœï¼Œå®æ—¶äº’åŠ¨åŠŸèƒ½</li>
<li><strong>é«˜å¯é æ€§</strong>ï¼šæ”¯æŒé«˜å¹¶å‘ï¼Œæ•°æ®æŒä¹…åŒ–ï¼Œå®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶</li>
<li><strong>æ˜“äºæ‰©å±•</strong>ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œæ–¹ä¾¿æ·»åŠ æ–°åŠŸèƒ½å’ŒæŠ½å¥–æ¨¡å¼</li>
<li><strong>éƒ¨ç½²ç®€å•</strong>ï¼šæ”¯æŒDockerå®¹å™¨åŒ–éƒ¨ç½²ï¼Œä¸€é”®å¯åŠ¨</li>
</ol>
<p>ç³»ç»Ÿä¸ä»…æ»¡è¶³äº†åŸºæœ¬çš„æŠ½å¥–éœ€æ±‚ï¼Œè¿˜é€šè¿‡WebSocketå®æ—¶é€šä¿¡ã€å¤šç§æŠ½å¥–æ¨¡å¼ã€æ•°æ®ç»Ÿè®¡åˆ†æç­‰åŠŸèƒ½ï¼Œå¤§å¤§æå‡äº†å¹´ä¼šçš„äº’åŠ¨æ€§å’Œè¶£å‘³æ€§ã€‚ä¼ä¸šå¯ä»¥æ ¹æ®è‡ªèº«éœ€æ±‚ï¼Œè¿›ä¸€æ­¥æ‰©å±•åŠŸèƒ½ï¼Œå¦‚é›†æˆä¼ä¸šå¾®ä¿¡ã€æ·»åŠ æ›´å¤šäº’åŠ¨æ¸¸æˆç­‰ï¼Œæ‰“é€ ç‹¬ä¸€æ— äºŒçš„å¹´ä¼šæŠ½å¥–ä½“éªŒã€‚</p>
<p>é€šè¿‡æœ¬ç³»ç»Ÿçš„å®æ–½ï¼Œä¼ä¸šå¯ä»¥ç¡®ä¿æŠ½å¥–æ´»åŠ¨çš„å…¬å¹³å…¬æ­£ï¼ŒåŒæ—¶æå‡å‘˜å·¥çš„å‚ä¸æ„Ÿå’Œæ»¡æ„åº¦ï¼Œä¸ºå¹´ä¼šå¢æ·»æ›´å¤šæ¬¢ä¹å’ŒæƒŠå–œã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[APISIX ç½‘å…³å¦‚ä½•å®ç°éªŒç­¾]]></title>    <link>https://juejin.cn/post/7603267434502340623</link>    <guid>https://juejin.cn/post/7603267434502340623</guid>    <pubDate>2026-02-06T02:53:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603267434502340623" data-draft-id="7603238967291379764" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="APISIX ç½‘å…³å¦‚ä½•å®ç°éªŒç­¾"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-02-06T02:53:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æµ·å°”æ™ºæ…§å®¶æŠ€æœ¯å¹³å°"/> <meta itemprop="url" content="https://juejin.cn/user/3848721122725016"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            APISIX ç½‘å…³å¦‚ä½•å®ç°éªŒç­¾
            <!----> <!----></h1> <div class="container team-follow" data-v-d326b38e="" data-v-61fb5e44=""><div class="left" data-v-d326b38e=""><a href="/team/7156434854350389283/posts" data-v-d326b38e=""><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a4176c1a2e0b4e1b986f105126840cc9~tplv-k3u1fbpfcp-watermark.image?" class="icon" data-v-d326b38e=""/></a> <div class="content" data-v-d326b38e=""><div style="display: flex" data-v-d326b38e=""><a href="/team/7156434854350389283/posts" data-v-d326b38e=""><p class="title-line" data-v-d326b38e=""><span title="ä¸‰ç¿¼é¸Ÿæ•°å­—åŒ–æŠ€æœ¯å›¢é˜Ÿ" class="title" data-v-d326b38e="">ä¸‰ç¿¼é¸Ÿæ•°å­—åŒ–æŠ€æœ¯å›¢é˜Ÿ</span> <img src="//lf-web-assets.juejin.cn/obj/juejin-web/xitu_juejin_web/255e400027b783cbad76dc41527e7695.svg" alt="team icon" class="team-icon" data-v-d326b38e=""/></p></a></div> <div class="meta-box team" data-v-d326b38e="" data-v-61fb5e44=""><time datetime="2026-02-06T02:53:19.000Z" title="Fri Feb 06 2026 02:53:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-d326b38e="" data-v-61fb5e44="">
                2026-02-06
              </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-d326b38e="" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-d326b38e="" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-d326b38e="" data-v-61fb5e44=""/></svg> <span class="views-count" style="display:none;" data-v-d326b38e="" data-v-61fb5e44="">
                0
              </span> <span class="read-time" data-v-d326b38e="" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-d326b38e="" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-d326b38e="" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-d326b38e="" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-d326b38e="" data-v-61fb5e44=""/></svg>
                é˜…è¯»10åˆ†é’Ÿ
              </span> <!----> <!----></div></div></div> <button class="jj-follow-button follow-btn" style="display:none;" data-v-b60b2868="" data-v-d326b38e=""><span data-v-b60b2868="" data-v-d326b38e=""><i class="byte-icon byte-icon--plus" data-v-d326b38e=""><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 48 48"><path fill="none" d="M0 0h48v48H0z"/><path d="M24.7 4c.4 0 .6 0 .8.1.2.1.3.2.4.4.1.2.1.3.1.8V22h16.7c.4 0 .6 0 .8.1.2.1.3.2.4.4.1.2.1.3.1.8v1.4c0 .4 0 .6-.1.8-.1.2-.2.3-.4.4-.2.1-.3.1-.8.1H26v16.7c0 .4 0 .6-.1.8-.1.2-.2.3-.4.4-.2.1-.3.1-.8.1h-1.4c-.4 0-.6 0-.8-.1-.2-.1-.3-.2-.4-.4-.1-.2-.1-.3-.1-.8V26H5.3c-.4 0-.6 0-.8-.1-.2-.1-.3-.2-.4-.4-.1-.2-.1-.3-.1-.8v-1.4c0-.4 0-.6.1-.8.1-.2.2-.3.4-.4.2-.1.3-.1.8-.1H22V5.3c0-.4 0-.6.1-.8.1-.2.2-.3.4-.4.2-.1.3-.1.8-.1h1.4z"/></svg></i>
        å…³æ³¨
      </span></button></div> <div class="team-user block-hidden" data-v-61fb5e44=""><div class="avatar jj-avatar avatar" data-v-03256cc6="" data-v-61fb5e44=""><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="avatar" class="lazy avatar-img" data-v-5244ef91="" data-v-03256cc6=""/> </div> <!----> <span class="position ellipsis" data-v-61fb5e44="">
              @æµ·å°”ä¼˜å®¶æ™ºèƒ½ç§‘æŠ€ï¼ˆåŒ—äº¬ï¼‰æœ‰é™å…¬å¸
            </span></div> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ APISIXï¼ˆäº‘åŸç”Ÿ API ç½‘å…³ï¼‰ä¸­å®ç°<strong>æ¥å£éªŒç­¾é€»è¾‘</strong>ï¼Œæ ¸å¿ƒæ˜¯é€šè¿‡å…¶<strong>æ’ä»¶æœºåˆ¶</strong>å®Œæˆ â€”â€” åˆ©ç”¨ APISIX å†…ç½®çš„éªŒç­¾ç›¸å…³æ’ä»¶ï¼ˆå¦‚<code>hmac-auth</code>ã€<code>jwt-auth</code>ï¼‰æˆ–è‡ªå®šä¹‰ Lua æ’ä»¶ï¼Œæ‹¦æˆªè¯·æ±‚å¹¶æ‰§è¡Œç­¾åéªŒè¯æµç¨‹ï¼Œç¡®ä¿è¯·æ±‚æ¥æºåˆæ³•ã€æ•°æ®æœªè¢«ç¯¡æ”¹ã€‚</p>
<h2 data-id="heading-0">1. APISIX éªŒç­¾çš„æ ¸å¿ƒåŸç†</h2>
<p>APISIX çš„è¯·æ±‚å¤„ç†æµç¨‹ä¸ºï¼š<code>è¯·æ±‚è¿›å…¥ â†’ æ’ä»¶æ‰§è¡Œï¼ˆé¡ºåºå¯é…ç½®ï¼‰ â†’ è½¬å‘è‡³ä¸Šæ¸¸æœåŠ¡</code>ã€‚éªŒç­¾é€»è¾‘æœ¬è´¨æ˜¯åœ¨<strong>æ’ä»¶æ‰§è¡Œé˜¶æ®µ</strong>ï¼Œé€šè¿‡ä»¥ä¸‹æ­¥éª¤å®ç°ï¼š</p>
<ol>
<li><strong>æå–</strong> <strong>ç­¾å</strong> <strong>ç›¸å…³å‚æ•°</strong>ï¼šä»è¯·æ±‚å¤´ï¼ˆå¦‚<code>X-Signature</code>ã€<code>Authorization</code>ï¼‰ã€è¯·æ±‚å‚æ•°æˆ– Body ä¸­ï¼Œæå–ç­¾åå€¼ã€æ—¶é—´æˆ³ã€éšæœºä¸²ã€AccessKey ç­‰éªŒç­¾å¿…éœ€ä¿¡æ¯ã€‚</li>
<li><strong>ç”Ÿæˆå¾…éªŒç­¾ä¸²</strong>ï¼šæŒ‰ç…§ä¸šåŠ¡çº¦å®šçš„è§„åˆ™ï¼ˆå¦‚ â€œå‚æ•°æŒ‰ ASCII æ’åº + æ‹¼æ¥æ—¶é—´æˆ³ + å¯†é’¥â€ï¼‰ï¼Œé‡ç»„è¯·æ±‚ä¸­çš„å…³é”®æ•°æ®ï¼ˆå¦‚è¯·æ±‚å‚æ•°ã€Bodyã€æ—¶é—´æˆ³ï¼‰ï¼Œç”Ÿæˆ â€œå¾…éªŒç­¾å­—ç¬¦ä¸²â€ã€‚</li>
<li><strong>æ‰§è¡Œ</strong> <strong>ç­¾å</strong> <strong>éªŒè¯</strong>ï¼šä½¿ç”¨ä¸å®¢æˆ·ç«¯çº¦å®šçš„ç®—æ³•ï¼ˆå¦‚ HMAC-SHA256ã€RSAï¼‰ï¼Œç»“åˆé¢„è®¾çš„å¯†é’¥ï¼ˆæˆ–å…¬é’¥ï¼‰å¯¹ â€œå¾…éªŒç­¾ä¸²â€ è¿›è¡Œç­¾åï¼Œå¯¹æ¯”ç”Ÿæˆçš„ç­¾åä¸è¯·æ±‚ä¸­æå–çš„ç­¾åæ˜¯å¦ä¸€è‡´ã€‚</li>
<li><strong>æ‹¦æˆªæˆ–æ”¾è¡Œ</strong>ï¼šéªŒè¯é€šè¿‡åˆ™ç»§ç»­è½¬å‘è¯·æ±‚è‡³ä¸Šæ¸¸ï¼›éªŒè¯å¤±è´¥ï¼ˆå¦‚ç­¾åä¸åŒ¹é…ã€æ—¶é—´æˆ³è¿‡æœŸï¼‰åˆ™ç›´æ¥è¿”å› 401/403 é”™è¯¯ï¼Œæ‹¦æˆªè¯·æ±‚ã€‚</li>
</ol>
<h2 data-id="heading-1">2. APISIX å®ç°éªŒç­¾çš„ 3 ç§å¸¸è§æ–¹å¼</h2>
<p>æ ¹æ®ä¸šåŠ¡åœºæ™¯ï¼ˆå¦‚æ˜¯å¦éœ€è¦è‡ªå®šä¹‰éªŒç­¾è§„åˆ™ã€ç­¾åç®—æ³•ç±»å‹ï¼‰ï¼ŒAPISIX æä¾›äº† â€œå†…ç½®æ’ä»¶â€â€œè‡ªå®šä¹‰ Lua æ’ä»¶â€â€œé›†æˆå¤–éƒ¨æœåŠ¡â€ ä¸‰ç§å®ç°æ–¹å¼ï¼Œä»¥ä¸‹è¯¦ç»†è¯´æ˜ï¼š</p>
<h3 data-id="heading-2">æ–¹å¼ 1ï¼šä½¿ç”¨ APISIX å†…ç½®éªŒç­¾æ’ä»¶ï¼ˆæ¨èï¼Œæ— éœ€ç¼–ç ï¼‰</h3>
<p>APISIX æä¾›äº†å¤šä¸ªæˆç†Ÿçš„å†…ç½®æ’ä»¶ï¼Œè¦†ç›–ä¸»æµéªŒç­¾åœºæ™¯ï¼ˆå¦‚ HMAC å¯¹ç§°åŠ å¯†ã€JWT ä»¤ç‰Œã€Basic Authï¼‰ï¼Œæ— éœ€ç¼–å†™ä»£ç ï¼Œä»…éœ€é€šè¿‡é…ç½®å³å¯å¯ç”¨ã€‚</p>
<h4 data-id="heading-3">1.1 HMAC å¯¹ç§°åŠ å¯†éªŒç­¾ï¼ˆ<code>hmac-auth</code>æ’ä»¶ï¼‰</h4>
<p>é€‚ç”¨äº<strong>å®¢æˆ·ç«¯ä¸</strong> <strong>ç½‘å…³</strong> <strong>å…±äº«</strong> <strong>å¯†é’¥</strong>çš„åœºæ™¯ï¼ˆå¦‚å†…éƒ¨æœåŠ¡é—´è°ƒç”¨ï¼‰ï¼ŒåŸºäº HMAC ç®—æ³•ï¼ˆå¦‚ HMAC-SHA256ï¼‰éªŒè¯ç­¾åï¼Œæ”¯æŒé˜²é‡æ”¾ï¼ˆé€šè¿‡æ—¶é—´æˆ³ + nonceï¼‰ã€‚</p>
<p>æ ¸å¿ƒé…ç½®æ­¥éª¤ï¼š</p>
<p><strong>ï¼ˆ1ï¼‰åˆ›å»º Consumerï¼ˆæ¶ˆè´¹è€…ï¼Œå³å®¢æˆ·ç«¯èº«ä»½ï¼‰</strong> ä¸ºæ¯ä¸ªå®¢æˆ·ç«¯é…ç½®å”¯ä¸€çš„<code>access_key</code>ï¼ˆæ ‡è¯†å®¢æˆ·ç«¯ï¼‰å’Œ<code>secret_key</code>ï¼ˆå¯¹ç§°å¯†é’¥ï¼Œéœ€å®¢æˆ·ç«¯ä¸ç½‘å…³ä¸€è‡´ï¼‰ï¼Œå¹¶ç»‘å®š<code>hmac-auth</code>æ’ä»¶ã€‚ç¤ºä¾‹ï¼ˆé€šè¿‡ APISIX Admin API é…ç½®ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºConsumerå¹¶å¯ç”¨hmac-authæ’ä»¶curl http://apisix-admin:9180/apisix/admin/consumers -X PUT -d '</span>
{
  <span class="hljs-string">"username"</span>: <span class="hljs-string">"client_001"</span>,  <span class="hljs-comment"># Consumeråç§°ï¼ˆè‡ªå®šä¹‰ï¼‰</span>
  <span class="hljs-string">"plugins"</span>: {
    <span class="hljs-string">"hmac-auth"</span>: {
      <span class="hljs-string">"access_key"</span>: <span class="hljs-string">"AK123456"</span>,  <span class="hljs-comment"># å®¢æˆ·ç«¯å”¯ä¸€æ ‡è¯†ï¼ˆå®¢æˆ·ç«¯éœ€æºå¸¦ï¼‰</span>
      <span class="hljs-string">"secret_key"</span>: <span class="hljs-string">"SKabcdef123456"</span>,  <span class="hljs-comment"># å¯¹ç§°å¯†é’¥ï¼ˆå®¢æˆ·ç«¯ä¸ç½‘å…³å…±äº«ï¼Œéœ€ä¿å¯†ï¼‰</span>
      <span class="hljs-string">"sign_header"</span>: <span class="hljs-string">"X-HMAC-Signature"</span>,  <span class="hljs-comment"># è¯·æ±‚å¤´ä¸­ç­¾åçš„å­—æ®µå</span>
      <span class="hljs-string">"clock_skew"</span>: 300,  <span class="hljs-comment"># å…è®¸çš„æ—¶é—´æˆ³åå·®ï¼ˆç§’ï¼Œé˜²é‡æ”¾ï¼‰</span>
      <span class="hljs-string">"nonce_header"</span>: <span class="hljs-string">"X-HMAC-Nonce"</span>,  <span class="hljs-comment"># è¯·æ±‚å¤´ä¸­éšæœºä¸²çš„å­—æ®µå</span>
      <span class="hljs-string">"timestamp_header"</span>: <span class="hljs-string">"X-HMAC-Timestamp"</span>  <span class="hljs-comment"># è¯·æ±‚å¤´ä¸­æ—¶é—´æˆ³çš„å­—æ®µå</span>
    }
  }
}<span class="hljs-string">'
</span></code></pre>
<p><strong>ï¼ˆ2ï¼‰ä¸º Route/</strong> <strong>Service</strong> <strong>ç»‘å®š</strong> <strong><code>hmac-auth</code></strong> <strong>æ’ä»¶</strong>å°†æ’ä»¶åº”ç”¨åˆ°éœ€è¦éªŒç­¾çš„è·¯ç”±ï¼ˆRouteï¼‰æˆ–æœåŠ¡ï¼ˆServiceï¼‰ï¼Œç¡®ä¿è¯¥è·¯ç”±çš„æ‰€æœ‰è¯·æ±‚éƒ½å¿…é¡»é€šè¿‡ HMAC éªŒç­¾ã€‚ç¤ºä¾‹ï¼ˆä¸º Route é…ç½®ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸ºRoute 1ç»‘å®šhmac-authæ’ä»¶curl http://apisix-admin:9180/apisix/admin/routes/1 -X PUT -d '</span>
{
  <span class="hljs-string">"uri"</span>: <span class="hljs-string">"/api/v1/order/*"</span>,  <span class="hljs-comment"># éœ€éªŒç­¾çš„æ¥å£è·¯å¾„</span>
  <span class="hljs-string">"upstream"</span>: {
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"roundrobin"</span>,
    <span class="hljs-string">"nodes"</span>: {<span class="hljs-string">"192.168.1.100:8080"</span>: 1}  <span class="hljs-comment"># ä¸Šæ¸¸æœåŠ¡åœ°å€</span>
  },
  <span class="hljs-string">"plugins"</span>: {
    <span class="hljs-string">"hmac-auth"</span>: {}  <span class="hljs-comment"># å¯ç”¨æ’ä»¶ï¼ˆæ— éœ€é¢å¤–é…ç½®ï¼Œå¤ç”¨Consumerçš„æ’ä»¶å‚æ•°ï¼‰</span>
  }
}<span class="hljs-string">'
</span></code></pre>
<p><strong>ï¼ˆ3ï¼‰å®¢æˆ·ç«¯è¯·æ±‚ç¤ºä¾‹</strong></p>
<p>Â Â å®¢æˆ·ç«¯éœ€æŒ‰ä»¥ä¸‹è§„åˆ™ç”Ÿæˆç­¾åå¹¶æºå¸¦è¯·æ±‚å¤´ï¼š</p>
<ul>
<li>ç”Ÿæˆ<code>nonce</code>ï¼ˆéšæœºä¸²ï¼Œå¦‚<code>abc123</code>ï¼‰ã€<code>timestamp</code>ï¼ˆå½“å‰æ—¶é—´æˆ³ï¼Œå¦‚<code>1690000000</code>ï¼‰ï¼›</li>
<li>å¾…éªŒç­¾ä¸²è§„åˆ™ï¼š<code>method + uri + timestamp + nonce + body</code>ï¼ˆå…·ä½“è§„åˆ™å¯é€šè¿‡æ’ä»¶å‚æ•°<code>sign_params</code>è‡ªå®šä¹‰ï¼‰ï¼›</li>
<li>ä½¿ç”¨<code>secret_key</code>å¯¹ â€œå¾…éªŒç­¾ä¸²â€ è¿›è¡Œ HMAC-SHA256 åŠ å¯†ï¼Œå¾—åˆ°ç­¾åå€¼ï¼›</li>
<li>è¯·æ±‚å¤´æºå¸¦ï¼š<code>X-HMAC-AccessKey: AK123456</code>ã€<code>X-HMAC-Timestamp: 1690000000</code>ã€<code>X-HMAC-Nonce: abc123</code>ã€<code>X-HMAC-Signature: ç­¾åå€¼</code>ã€‚</li>
</ul>
<h4 data-id="heading-4">1.2 JWT ä»¤ç‰ŒéªŒç­¾ï¼ˆ<code>jwt-auth</code>æ’ä»¶ï¼‰</h4>
<p>é€‚ç”¨äº<strong>åˆ†å¸ƒå¼</strong> <strong>ç³»ç»Ÿã€ç”¨æˆ·è®¤è¯</strong>åœºæ™¯ï¼Œå®¢æˆ·ç«¯å…ˆé€šè¿‡ç™»å½•æ¥å£è·å– JWT ä»¤ç‰Œï¼Œåç»­è¯·æ±‚æºå¸¦ä»¤ç‰Œï¼Œç½‘å…³é€šè¿‡å…¬é’¥éªŒè¯ä»¤ç‰Œæœ‰æ•ˆæ€§ï¼ˆæ”¯æŒå¯¹ç§° / éå¯¹ç§°åŠ å¯†ï¼‰ã€‚</p>
<p>æ ¸å¿ƒé…ç½®æ­¥éª¤ï¼š</p>
<p><strong>ï¼ˆ1ï¼‰åˆ›å»º Consumer å¹¶é…ç½®</strong> <strong>JWT</strong> <strong>å‚æ•°</strong>ç¤ºä¾‹ï¼ˆå¯¹ç§°åŠ å¯†ï¼Œä½¿ç”¨<code>secret</code>éªŒè¯ï¼›éå¯¹ç§°åŠ å¯†éœ€é…ç½®<code>public_key</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">curl http:<span class="hljs-comment">//apisix-admin:9180/apisix/admin/consumers -X PUT -d '</span>
{
  <span class="hljs-string">"username"</span>: <span class="hljs-string">"user_001"</span>,
  <span class="hljs-string">"plugins"</span>: {
    <span class="hljs-string">"jwt-auth"</span>: {
      <span class="hljs-string">"secret"</span>: <span class="hljs-string">"jwt_secret_123"</span>,  <span class="hljs-meta"># å¯¹ç§°å¯†é’¥ï¼ˆéå¯¹ç§°åŠ å¯†ç”¨public_keyæ›¿ä»£ï¼‰</span>
      <span class="hljs-string">"algorithm"</span>: <span class="hljs-string">"HS256"</span>,  <span class="hljs-meta"># ç®—æ³•ï¼ˆHS256=å¯¹ç§°ï¼ŒRS256=éå¯¹ç§°ï¼‰</span>
      <span class="hljs-string">"exp"</span>: <span class="hljs-number">3600</span>,  <span class="hljs-meta"># ä»¤ç‰Œè¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰</span>
      <span class="hljs-string">"token_header"</span>: <span class="hljs-string">"Authorization"</span>,  <span class="hljs-meta"># æºå¸¦ä»¤ç‰Œçš„è¯·æ±‚å¤´ï¼ˆå¦‚Bearer Tokenï¼‰</span>
      <span class="hljs-string">"token_prefix"</span>: <span class="hljs-string">"Bearer "</span>  <span class="hljs-meta"># ä»¤ç‰Œå‰ç¼€ï¼ˆå¦‚"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."ï¼‰</span>
    }
  }
}<span class="hljs-string">'
</span></code></pre>
<p><strong>ï¼ˆ2ï¼‰ä¸º Route ç»‘å®š</strong> <strong><code>jwt-auth</code></strong> <strong>æ’ä»¶</strong>ç¡®ä¿è¯·æ±‚éœ€æºå¸¦æœ‰æ•ˆ JWT ä»¤ç‰Œæ‰èƒ½è®¿é—®ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">curl http://apisix-admin:<span class="hljs-number">9180</span>/apisix/admin/routes/<span class="hljs-number">2</span> -X PUT -d <span class="hljs-comment">'</span>
{
  <span class="hljs-string">"uri"</span>: <span class="hljs-string">"/api/v1/user/*"</span>,
  <span class="hljs-string">"upstream"</span>: {<span class="hljs-string">"nodes"</span>: {<span class="hljs-string">"192.168.1.101:8080"</span>: <span class="hljs-number">1</span>}},
  <span class="hljs-string">"plugins"</span>: {<span class="hljs-string">"jwt-auth"</span>: {}}
}<span class="hljs-comment">'</span>
</code></pre>
<p><strong>ï¼ˆ3ï¼‰å®¢æˆ·ç«¯è¯·æ±‚ç¤ºä¾‹</strong></p>
<ul>
<li>ç™»å½•è·å– JWT ä»¤ç‰Œï¼šå®¢æˆ·ç«¯é€šè¿‡ç™»å½•æ¥å£ï¼ˆå¦‚<code>/login</code>ï¼‰æäº¤è´¦å·å¯†ç ï¼Œä¸Šæ¸¸æœåŠ¡ç”Ÿæˆ JWT ä»¤ç‰Œï¼ˆä½¿ç”¨<code>secret</code>ç­¾åï¼‰è¿”å›ç»™å®¢æˆ·ç«¯ï¼›</li>
<li>åç»­è¯·æ±‚æºå¸¦ä»¤ç‰Œï¼šè¯·æ±‚å¤´æ·»åŠ <code>Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...</code>ï¼ŒAPISIX éªŒè¯ä»¤ç‰Œç­¾ååŠè¿‡æœŸæ—¶é—´ã€‚</li>
</ul>
<h3 data-id="heading-5">æ–¹å¼ 2ï¼šè‡ªå®šä¹‰ Lua æ’ä»¶ï¼ˆé€‚åˆå¤æ‚è‡ªå®šä¹‰éªŒç­¾è§„åˆ™ï¼‰</h3>
<p>è‹¥å†…ç½®æ’ä»¶æ— æ³•æ»¡è¶³ä¸šåŠ¡éœ€æ±‚ï¼ˆå¦‚ç‰¹æ®Šç­¾åç®—æ³•ã€å¤æ‚éªŒç­¾é€»è¾‘ï¼‰ï¼Œå¯åŸºäº APISIX çš„<strong>Lua æ’ä»¶å¼€å‘æ¡†æ¶</strong>ç¼–å†™è‡ªå®šä¹‰éªŒç­¾æ’ä»¶ï¼Œå®Œå…¨æ§åˆ¶éªŒç­¾æµç¨‹ã€‚</p>
<p>æ ¸å¿ƒå¼€å‘æ­¥éª¤ï¼š</p>
<p><strong>ï¼ˆ1ï¼‰åˆ›å»ºæ’ä»¶ç›®å½•ä¸æ–‡ä»¶</strong>APISIX æ’ä»¶é»˜è®¤å­˜æ”¾åœ¨<code>/usr/local/apisix/plugins/</code>ç›®å½•ï¼Œæ–°å»ºè‡ªå®šä¹‰æ’ä»¶æ–‡ä»¶ï¼ˆå¦‚<code>custom-sign.lua</code>ï¼‰ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰ç¼–å†™æ’ä»¶æ ¸å¿ƒé€»è¾‘</strong>æ’ä»¶éœ€å®ç°<code>rewrite</code>ï¼ˆè¯·æ±‚è½¬å‘å‰æ‰§è¡Œï¼‰æˆ–<code>access</code>ï¼ˆæƒé™æ ¡éªŒé˜¶æ®µï¼‰æ–¹æ³•ï¼Œåœ¨æ–¹æ³•ä¸­ç¼–å†™éªŒç­¾é€»è¾‘ã€‚ç¤ºä¾‹ï¼ˆè‡ªå®šä¹‰ HMAC éªŒç­¾æ’ä»¶æ ¸å¿ƒä»£ç ï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">local <span class="hljs-attr">core</span> = require(<span class="hljs-string">"apisix.core"</span>)local hmac = require(<span class="hljs-string">"resty.hmac"</span>)-- æ’ä»¶Schemaï¼ˆå®šä¹‰é…ç½®å‚æ•°ï¼Œå¦‚secret_keyã€sign_headerï¼‰local schema = {
  <span class="hljs-attr">type</span> = <span class="hljs-string">"object"</span>,
  <span class="hljs-attr">properties</span> = {
    <span class="hljs-attr">secret_key</span> = {type = <span class="hljs-string">"string"</span>},  -- å¯¹ç§°å¯†é’¥
    <span class="hljs-attr">sign_header</span> = {type = <span class="hljs-string">"string"</span>, default = <span class="hljs-string">"X-Custom-Sign"</span>},  -- ç­¾åè¯·æ±‚å¤´
    <span class="hljs-attr">timestamp_header</span> = {type = <span class="hljs-string">"string"</span>, default = <span class="hljs-string">"X-Custom-Timestamp"</span>}  -- æ—¶é—´æˆ³è¯·æ±‚å¤´},
  <span class="hljs-attr">required</span> = {<span class="hljs-string">"secret_key"</span>}}-- æ’ä»¶ä¸»é€»è¾‘ï¼ˆaccessé˜¶æ®µæ‰§è¡Œï¼‰local function access(conf, ctx)-- <span class="hljs-number">1</span>. æå–è¯·æ±‚ä¸­çš„éªŒç­¾å‚æ•°local req_sign = core.request.header(ctx, conf.sign_header)local req_timestamp = core.request.header(ctx, conf.timestamp_header)local req_method = core.request.get_method(ctx)local req_uri = ctx.var.uri
  local <span class="hljs-attr">req_body</span> = core.request.get_body(ctx)  -- éœ€å¼€å¯bodyè¯»å–ï¼ˆåœ¨APISIXé…ç½®ä¸­è®¾ç½®ï¼‰-- <span class="hljs-number">2</span>. æ ¡éªŒå¿…è¦å‚æ•°æ˜¯å¦å­˜åœ¨if not req_sign or not req_timestamp thenreturn <span class="hljs-number">401</span>, {message = <span class="hljs-string">"missing sign or timestamp"</span>}end-- <span class="hljs-number">3</span>. æ ¡éªŒæ—¶é—´æˆ³ï¼ˆé˜²é‡æ”¾ï¼Œå…è®¸<span class="hljs-number">5</span>åˆ†é’Ÿåå·®ï¼‰local current_ts = ngx.time()if math.abs(current_ts - tonumber(req_timestamp)) &gt; <span class="hljs-number">300</span> thenreturn <span class="hljs-number">401</span>, {message = <span class="hljs-string">"timestamp expired"</span>}end-- <span class="hljs-number">4</span>. ç”Ÿæˆå¾…éªŒç­¾ä¸²ï¼ˆæŒ‰ä¸šåŠ¡è§„åˆ™æ‹¼æ¥ï¼‰local sign_str = string.format(<span class="hljs-string">"%s%s%s%s"</span>, req_method, req_uri, req_timestamp, req_body or <span class="hljs-string">""</span>)-- <span class="hljs-number">5</span>. è®¡ç®—HMACç­¾åå¹¶å¯¹æ¯”local hmac_obj = hmac:new(conf.secret_key, hmac.ALGOS.SHA256)local computed_sign = hmac_obj:final(sign_str, <span class="hljs-literal">true</span>)  -- <span class="hljs-literal">true</span>è¡¨ç¤ºè¿”å›hexæ ¼å¼if computed_sign ~= req_sign thenreturn <span class="hljs-number">403</span>, {message = <span class="hljs-string">"invalid signature"</span>}end-- <span class="hljs-number">6</span>. éªŒç­¾é€šè¿‡ï¼Œç»§ç»­è½¬å‘è¯·æ±‚returnend-- æ³¨å†Œæ’ä»¶return {
  <span class="hljs-attr">version</span> = <span class="hljs-number">0.1</span>,
  <span class="hljs-attr">priority</span> = <span class="hljs-number">2000</span>,  -- æ’ä»¶æ‰§è¡Œä¼˜å…ˆçº§ï¼ˆæ•°å€¼è¶Šå¤§è¶Šå…ˆæ‰§è¡Œï¼‰
  <span class="hljs-attr">name</span> = <span class="hljs-string">"custom-sign"</span>,  -- æ’ä»¶åç§°
  <span class="hljs-attr">schema</span> = schema,
  <span class="hljs-attr">access</span> = access  -- ç»‘å®šaccessé˜¶æ®µæ‰§è¡Œ}
</code></pre>
<p><strong>ï¼ˆ3ï¼‰å¯ç”¨è‡ªå®šä¹‰æ’ä»¶</strong></p>
<ul>
<li>åœ¨ APISIX é…ç½®æ–‡ä»¶ï¼ˆ<code>config.yaml</code>ï¼‰ä¸­æ·»åŠ æ’ä»¶åˆ°<code>plugins</code>åˆ—è¡¨ï¼Œç¡®ä¿ APISIX åŠ è½½æ’ä»¶ï¼š</li>
</ul>
<pre><code class="hljs language-markdown" lang="markdown">plugins:
<span class="hljs-bullet">  -</span> custom-sign  # æ·»åŠ è‡ªå®šä¹‰æ’ä»¶åç§°
<span class="hljs-bullet">  -</span> hmac-auth
<span class="hljs-bullet">  -</span> jwt-auth
</code></pre>
<ul>
<li>é‡å¯ APISIXï¼š<code>apisix restart</code>ï¼›</li>
<li>ä¸º Consumer å’Œ Route ç»‘å®š<code>custom-sign</code>æ’ä»¶ï¼ˆåŒå†…ç½®æ’ä»¶é…ç½®æ–¹å¼ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-6">æ–¹å¼ 3ï¼šé›†æˆå¤–éƒ¨éªŒç­¾æœåŠ¡ï¼ˆé€‚åˆéªŒç­¾é€»è¾‘ç‹¬ç«‹éƒ¨ç½²ï¼‰</h3>
<p>è‹¥éªŒç­¾é€»è¾‘å¤æ‚ï¼ˆå¦‚ä¾èµ–æ•°æ®åº“æŸ¥è¯¢å¯†é’¥ã€å¤šç³»ç»Ÿå…±äº«éªŒç­¾æœåŠ¡ï¼‰ï¼Œå¯é€šè¿‡ APISIX çš„<code>ext-plugin</code>ï¼ˆå¤–éƒ¨æ’ä»¶ï¼‰æˆ–<code>http-logger</code>+<code>request-validator</code>ï¼Œå°†éªŒç­¾è¯·æ±‚è½¬å‘åˆ°å¤–éƒ¨æœåŠ¡ï¼ˆå¦‚ Java/Python ç¼–å†™çš„éªŒç­¾æœåŠ¡ï¼‰ï¼Œç”±å¤–éƒ¨æœåŠ¡è¿”å›éªŒç­¾ç»“æœï¼ŒAPISIX æ ¹æ®ç»“æœå†³å®šæ˜¯å¦æ”¾è¡Œã€‚</p>
<p>æ ¸å¿ƒå®ç°æ€è·¯ï¼š</p>
<p><strong>ï¼ˆ1ï¼‰éƒ¨ç½²å¤–éƒ¨éªŒç­¾æœåŠ¡</strong></p>
<p>å¼€å‘ä¸€ä¸ªéªŒç­¾ APIï¼ˆå¦‚<code>http://sign-service:8080/verify</code>ï¼‰ï¼Œæ¥æ”¶ APISIX è½¬å‘çš„è¯·æ±‚å‚æ•°ï¼ˆå¦‚è¯·æ±‚å¤´ã€Bodyã€è·¯å¾„ï¼‰ï¼Œæ‰§è¡ŒéªŒç­¾é€»è¾‘ï¼Œè¿”å›<code>{"success": true/false, "message": "..."}</code>ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰APISIX é…ç½®è½¬å‘ä¸ç»“æœåˆ¤æ–­</strong>ä½¿ç”¨<code>ext-plugin</code>çš„<code>pre-req</code>ï¼ˆè¯·æ±‚å‰è°ƒç”¨å¤–éƒ¨æœåŠ¡ï¼‰åŠŸèƒ½ï¼Œæˆ–é€šè¿‡<code>proxy-rewrite</code>å°†è¯·æ±‚è½¬å‘åˆ°éªŒç­¾æœåŠ¡ï¼Œå†é€šè¿‡<code>response-rewrite</code>åˆ¤æ–­ç»“æœï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-comment"># ç¤ºä¾‹ï¼šä¸ºRouteé…ç½®å¤–éƒ¨éªŒç­¾æœåŠ¡curl http://apisix-admin:9180/apisix/admin/routes/3 -X PUT -d '</span>
{
  <span class="hljs-string">"uri"</span>: <span class="hljs-string">"/api/v1/pay/*"</span>,
  <span class="hljs-string">"plugins"</span>: {
    <span class="hljs-string">"ext-plugin-pre-req"</span>: {
      <span class="hljs-string">"conf"</span>: [
        {
          <span class="hljs-string">"name"</span>: <span class="hljs-string">"ext-plugin-http"</span>,  <span class="hljs-comment"># è°ƒç”¨å¤–éƒ¨HTTPæœåŠ¡çš„æ’ä»¶</span>
          <span class="hljs-string">"value"</span>: '{<span class="hljs-string">"uri"</span>:<span class="hljs-string">"http://sign-service:8080/verify"</span>,<span class="hljs-string">"method"</span>:<span class="hljs-string">"POST"</span>,<span class="hljs-string">"timeout"</span>:500}'
        }
      ]
    }
  },
  <span class="hljs-string">"upstream"</span>: {<span class="hljs-string">"nodes"</span>: {<span class="hljs-string">"192.168.1.102:8080"</span>: 1}}
}'
</code></pre>
<p>å¤–éƒ¨éªŒç­¾æœåŠ¡è¿”å›<code>success: false</code>æ—¶ï¼ŒAPISIX ç›´æ¥æ‹¦æˆªè¯·æ±‚å¹¶è¿”å›é”™è¯¯ã€‚</p>
<h2 data-id="heading-7">3. éªŒç­¾é…ç½®çš„æœ€ä½³å®è·µ</h2>
<ol>
<li>
<p><strong>å¯†é’¥ç®¡ç†</strong></p>
<ol>
<li>å¯¹ç§°å¯†é’¥ï¼ˆå¦‚<code>hmac-auth</code>çš„<code>secret_key</code>ï¼‰éœ€é€šè¿‡ APISIX çš„<strong>é…ç½®ä¸­å¿ƒ</strong>ï¼ˆå¦‚ etcdã€Nacosï¼‰ç®¡ç†ï¼Œé¿å…ç¡¬ç¼–ç ï¼›</li>
<li>éå¯¹ç§°åŠ å¯†ï¼ˆå¦‚ JWT RS256ï¼‰éœ€å®šæœŸè½®æ¢å…¬é’¥ / ç§é’¥ï¼Œç¡®ä¿å¯†é’¥å®‰å…¨ã€‚</li>
</ol>
</li>
<li>
<p><strong>é˜²é‡æ”¾æ”»å‡»</strong></p>
<ol>
<li>å¿…é¡»åŠ å…¥ â€œæ—¶é—´æˆ³ + nonceâ€ æœºåˆ¶ï¼ˆå¦‚<code>hmac-auth</code>çš„<code>clock_skew</code>å’Œ<code>nonce_header</code>ï¼‰ï¼Œé˜²æ­¢æ”»å‡»è€…å¤ç”¨æ—§ç­¾åï¼›</li>
<li>å¯é€šè¿‡ APISIX çš„<code>redis</code>æ’ä»¶ç¼“å­˜å·²ä½¿ç”¨çš„<code>nonce</code>ï¼Œé¿å…é‡å¤ä½¿ç”¨ã€‚</li>
</ol>
</li>
<li>
<p><strong>æ€§èƒ½ä¼˜åŒ–</strong></p>
<ol>
<li>è‡ªå®šä¹‰æ’ä»¶ä¸­é¿å…é¢‘ç¹ IO æ“ä½œï¼ˆå¦‚æ•°æ®åº“æŸ¥è¯¢ï¼‰ï¼Œå¯å°†å¯†é’¥ç¼“å­˜åˆ° APISIX æœ¬åœ°ï¼ˆå¦‚<code>core.lrucache</code>ï¼‰ï¼›</li>
<li>å¯¹äºå¤§ Body è¯·æ±‚ï¼ŒéªŒç­¾æ—¶å¯ä»…å¯¹ Body çš„å“ˆå¸Œå€¼ï¼ˆå¦‚ MD5ï¼‰è¿›è¡Œç­¾åï¼Œå‡å°‘æ•°æ®å¤„ç†é‡ã€‚</li>
</ol>
</li>
<li>
<p><strong>æ—¥å¿—ä¸ç›‘æ§</strong></p>
<ol>
<li>å¯ç”¨ APISIX çš„<code>error-log-logger</code>å’Œ<code>access-logger</code>ï¼Œè®°å½•éªŒç­¾å¤±è´¥æ—¥å¿—ï¼ˆå¦‚ç­¾åä¸åŒ¹é…ã€æ—¶é—´æˆ³è¿‡æœŸï¼‰ï¼›</li>
<li>é€šè¿‡ APISIX çš„ç›‘æ§æ’ä»¶ï¼ˆå¦‚<code>prometheus</code>ï¼‰ç»Ÿè®¡éªŒç­¾æˆåŠŸç‡ï¼ŒåŠæ—¶å‘ç°å¼‚å¸¸è¯·æ±‚ã€‚</li>
</ol>
</li>
</ol>
<h2 data-id="heading-8">4. å¸¸è§é—®é¢˜æ’æŸ¥</h2>
<ol>
<li>
<p><strong>éªŒç­¾å¤±è´¥ä½†å®¢æˆ·ç«¯ç¡®è®¤</strong> <strong>ç­¾å</strong> <strong>æ­£ç¡®</strong></p>
<ol>
<li>æ£€æŸ¥ â€œå¾…éªŒç­¾ä¸²â€ çš„æ‹¼æ¥è§„åˆ™æ˜¯å¦ä¸å®¢æˆ·ç«¯ä¸€è‡´ï¼ˆå¦‚å‚æ•°æ’åºã€æ˜¯å¦åŒ…å« Bodyã€å¤§å°å†™æ•æ„Ÿï¼‰ï¼›</li>
<li>ç¡®è®¤ APISIX æ˜¯å¦æ­£ç¡®è¯»å–è¯·æ±‚ Bodyï¼ˆéœ€åœ¨<code>config.yaml</code>ä¸­è®¾ç½®<code>proxy_body_temp_path</code>ï¼Œå¹¶ç¡®ä¿æ’ä»¶å¯ç”¨ Body è¯»å–ï¼‰ã€‚</li>
</ol>
</li>
<li>
<p><strong>JWT ä»¤ç‰ŒéªŒè¯å¤±è´¥</strong></p>
<ol>
<li>æ£€æŸ¥<code>algorithm</code>æ˜¯å¦åŒ¹é…ï¼ˆå¦‚å®¢æˆ·ç«¯ç”¨ HS256ï¼Œç½‘å…³é…ç½® RS256ï¼‰ï¼›</li>
<li>ç¡®è®¤ä»¤ç‰Œæœªè¿‡æœŸï¼ˆ<code>exp</code>å­—æ®µï¼‰ï¼Œä¸”<code>secret</code>/<code>public_key</code>ä¸å®¢æˆ·ç«¯ç­¾åæ—¶ä½¿ç”¨çš„å¯†é’¥ä¸€è‡´ã€‚</li>
</ol>
</li>
<li>
<p><strong>è‡ªå®šä¹‰æ’ä»¶ä¸ç”Ÿæ•ˆ</strong></p>
<ol>
<li>æ£€æŸ¥æ’ä»¶æ˜¯å¦æ·»åŠ åˆ° APISIX çš„<code>plugins</code>åˆ—è¡¨ä¸­ï¼›</li>
<li>é€šè¿‡ APISIX æ—¥å¿—ï¼ˆ<code>/usr/local/apisix/logs/error.log</code>ï¼‰æŸ¥çœ‹æ’ä»¶æ‰§è¡ŒæŠ¥é”™ä¿¡æ¯ã€‚</li>
</ol>
</li>
</ol>
<h2 data-id="heading-9">5.å›¢é˜Ÿä»‹ç»</h2>
<p>ã€Œ<strong>æ™ºæ…§å®¶æŠ€æœ¯å¹³å°-åº”ç”¨è½¯ä»¶æ¡†æ¶å¼€å‘</strong>ã€ä¸»è¦è´Ÿè´£è®¾è®¡å·¥å…·çš„ç ”å‘ï¼ŒåŒ…æ‹¬è¥é”€è®¾è®¡å·¥å…·ã€å®¶ç”µVRè®¾è®¡å’Œå±•ç¤ºã€æ°´ç”µæš–é€šå‰ç½®è®¾è®¡èƒ½åŠ›ï¼Œç ”å‘å¹¶æ²‰æ·€ç´ æåº“ï¼Œæ„å»ºå®¶å±…å®¶è£…ç´ æåº“ï¼Œé›†æˆæˆ·å‹åº“ã€å…¨å“ç±»äº§å“åº“ã€è®¾è®¡æ–¹æ¡ˆåº“ã€ç”Ÿäº§å·¥è‰ºæ¨¡å‹ï¼Œæ‰“é€ åŸºäºæˆ·å‹å’Œé£æ ¼çš„AIè®¾è®¡èƒ½åŠ›ï¼Œå¿«é€Ÿç”Ÿæˆç®—é‡å’ŒæŠ¥ä»·ï¼›åŒæ—¶ç ”å‘äº†é—¨åº—è®¾è®¡å¸ˆä¸­å¿ƒå’Œé¡¹ç›®ä¸­å¿ƒï¼ŒåŒ…æ‹¬è®¾è®¡å¸ˆç®¡ç†èƒ½åŠ›å’Œé¡¹ç›®ç»ç†ç®¡ç†èƒ½åŠ›ã€‚å®ç°äº†åœºæ™¯å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ŒåŒæ—¶ä¸ºæ°´ï¼Œç©ºæ°”ï¼Œå¨æˆ¿ç­‰äº§ä¸šæä¾›å•†æœºç®¡ç†å·¥å…·ï¼Œä»è€Œå®ç°äº†ä»¥åœºæ™¯è´¯ç©¿çš„Bç«¯Cç«¯å…¨æµç¨‹ç³»ç»Ÿã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringBoot å¯åŠ¨æµç¨‹æºç åˆ†æ ~ å®ƒå…¶å®ä¸å¤æ‚]]></title>    <link>https://juejin.cn/post/7603574149776621620</link>    <guid>https://juejin.cn/post/7603574149776621620</guid>    <pubDate>2026-02-07T09:17:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603574149776621620" data-draft-id="7596998306380644402" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SpringBoot å¯åŠ¨æµç¨‹æºç åˆ†æ ~ å®ƒå…¶å®ä¸å¤æ‚"/> <meta itemprop="keywords" content="Spring Boot,Spring,åç«¯"/> <meta itemprop="datePublished" content="2026-02-07T09:17:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æš®è‰²å¦–å¨†ä¸¶"/> <meta itemprop="url" content="https://juejin.cn/user/4292946760307655"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SpringBoot å¯åŠ¨æµç¨‹æºç åˆ†æ ~ å®ƒå…¶å®ä¸å¤æ‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4292946760307655/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æš®è‰²å¦–å¨†ä¸¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-07T09:17:57.000Z" title="Sat Feb 07 2026 09:17:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»18åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>æœ¬ç¯‡æ–‡ç« ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯ <code>SpringBoot 3.4.1</code>ã€‚å®é™…ä¸Šåœ¨ç†Ÿæ‚‰ <code>SpringBoot</code> ä¹‹åï¼Œæˆ‘ä»¬ä¼šå‘ç°å®ƒå¹¶ä¸èƒ½ç®—æ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œæ›´å‡†ç¡®çš„è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ª <code>Spring</code> é¡¹ç›®çš„å¿«é€Ÿé›†æˆè„šæ‰‹æ¶ã€‚æå‰é…ç½®äº†ä¸€ç³»åˆ—å¯ä»¥å’Œ <code>Spring</code> æ•´åˆçš„ç¬¬ä¸‰æ–¹ç»„ä»¶ã€‚å®ƒåŸºäº <code>Spring</code> æ¡†æ¶åšäº†ä¸€ç³»åˆ—çš„æ‰©å±•ã€‚</p>
<p>æ‰€ä»¥å¦‚æœå·²ç»ç†Ÿæ‚‰ <code>Spring</code> æ ¸å¿ƒç»„ä»¶æºç çš„è¯ï¼Œå­¦ä¹  <code>SpringBoot</code> å°†ä¼šéå¸¸éå¸¸ç®€å•ï¼å¦‚æœå®Œå…¨æ²¡æœ‰ <code>Spring</code> çš„æºç ç»éªŒï¼Œç›´æ¥çœ‹ <code>SpringBoot</code> æºç  ï¼Œå¯èƒ½ä¼šå¾ˆåƒåŠ›ï¼Œå› ä¸ºæ¶‰åŠåˆ°å¤ªå¤š <code>Spring</code> çš„çŸ¥è¯†ï¼Œä¼šæ— æ³•ç†è§£ã€‚åŒ…æ‹¬ä½†ä¸é™äº <code>åç½®å¤„ç†å™¨ã€IOC å®¹å™¨ã€Spring äº‹ä»¶ã€èµ„æºåŠ è½½å™¨</code> ç­‰ï¼Œä¸è¿‡é—®é¢˜å€’ä¹Ÿä¸æ˜¯å¤ªå¤§ï¼Œåªè¦æ—¶é—´è¶³å¤Ÿï¼Œåªè¦çœ‹çš„æ¬¡æ•°å¤Ÿå¤šï¼Œç»ˆç©¶éƒ½èƒ½å¤ŸæŒæ¡ã€‚</p>
<h2 data-id="heading-1">SpringBoot &amp; Spring æ¶æ„å›¾ç¤ºæ¦‚è§ˆ</h2>
<p>è¿™é‡Œæˆ‘ä»¥ <code>SpringBoot</code> æºç å…¥å£ä¸ºèµ·ç‚¹ï¼Œç”»äº†ä¸€ä¸ªç›¸å…³çš„æµç¨‹å›¾ï¼ŒåŒ…å«äº† <code>SpringBootã€Spring äº‹åŠ¡ã€Spring AOPã€Spring äº‹ä»¶ã€BeanFactoryPostProcessorã€BeanPostProcessor</code> ç­‰æ‰€æœ‰ <code>Spring</code> çŸ¥è¯†ï¼Œä»¥åŠç›¸å…³æ¨¡å—ä¹‹é—´çš„äº¤äº’è”ç³»ï¼Œåç»­ä¹Ÿä¼šæŒç»­æ›´æ–°æ­¤å›¾ï¼ˆå› ä¸ºæˆ‘è‡ªå·±è¿˜æ²¡æœ‰å­¦å®Œï¼‰ï¼Œæˆ‘è¯•äº†ä¸‹ä½œè€…ä¾§è¿™è¾¹æ›´æ–°åï¼Œåˆ†äº«çš„åä½œé“¾æ¥ä¹Ÿä¼šå®æ—¶å˜æ›´ï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰å¸®åŠ©</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.processon.com%2Fv%2F696465e679c29354e9e50f69" target="_blank" title="https://www.processon.com/v/696465e679c29354e9e50f69" ref="nofollow noopener noreferrer">SpringBoot &amp; Spring æ¶æ„å›¾ æŒç»­æ›´æ–°</a> å¯¹äºå³å°†éœ€è¦é¢è¯•çš„åŒå­¦åº”è¯¥ä¼šæ¯”è¾ƒæœ‰å¸®åŠ©ï¼</p>
<h2 data-id="heading-2">æºç è¯¯åŒº</h2>
<p>æˆ‘ä»¬å­¦ä¹ æºç ç»ä¸æ˜¯ä¸ºäº†ä¸€å¼€å§‹å°±æŠ±ç€ææ‡‚æ¯ä¸€è¡Œä»£ç çš„ç›®çš„ã€‚è€Œæ˜¯å…ˆçœ‹ä¸»è„‰ç»œï¼Œè¿™ä¸ªæµç¨‹å¤§æ¦‚å¹²äº†å“ªå‡ ä»¶å¤§äº‹å„¿ï¼Œ</p>
<div align="center">
  <img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a37fbc73f71e42af986645a3e97eaadd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060676&amp;x-signature=e4Ekr75yfCaV1B0DPy%2BkSPxzID4%3D" alt="å›¾ç‰‡æè¿°" width="50%" loading="lazy"/>
</div>
<p>å°±åƒè¿™æ£µæ ‘ä¸€æ ·ï¼Œå…ˆæ‘¸æ¸…æ¥šä¸»æ ‘å¹²ï¼Œç„¶åå†ç»“åˆæˆ‘ä»¬å·¥ä½œä¸­çš„ä½¿ç”¨ç»éªŒï¼Œæ‰¾åˆ°ä¸€ä¸ªæ¡ˆä¾‹ï¼Œ<code>debug</code> çœ‹å®ƒå±äºå“ªä¸ªåˆ†æ”¯æµç¨‹ï¼Œå†å»ç»†çœ‹åˆ†æ”¯æµç¨‹ï¼Œ</p>
<p>åº”è¯¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤</p>
<ul>
<li>äº†è§£ä¸€ä¸ªæ¡†æ¶çš„ä¸»æµç¨‹</li>
<li>äº†è§£æŸä¸ªåˆ†æ”¯æµç¨‹</li>
<li>åœ¨è¿™ä¸ªåˆ†æ”¯æµç¨‹ä¸­å¯ä»¥è‡ªå®šä¹‰æ‰©å±•</li>
<li>æ£æ‘©ä½œè€…è¿™æ ·å®ç°çš„å¥½å¤„ï¼Œæœ‰æ²¡æœ‰æ›¿ä»£æ–¹å¼</li>
</ul>
<h2 data-id="heading-3">ä¸»æµç¨‹å›¾</h2>
<p>æˆ‘ä»¬é˜…è¯» <code>SpringApplication#run()</code> æ–¹æ³•å¯ä»¥å‘ç°å®ƒçš„å¤–å±‚ä»£ç å¾ˆç®€å•ã€‚æœ‰ä»¥ä¸‹å‡ ä¸ªå¤§æµç¨‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4ce3789f0834e65a08e5ac3117d5b8c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060676&amp;x-signature=T0%2FFr5UdBGx65k%2BAsJHmCo4NTHs%3D" alt="7d99e86f-2ac1-44c4-8b63-a70b0bce3778.png" loading="lazy"/></p>
<p>å½“ç„¶ï¼Œè¿™äº›å¤§æµç¨‹é‡Œé¢è¿˜æœ‰å¾ˆå¤šåˆ†æ”¯ã€‚ä¸‹é¢çš„ç« èŠ‚ï¼Œæˆ‘ä»¬ä¸€ä¸€è¯´æ˜è¿™äº›é˜¶æ®µã€‚</p>
<h2 data-id="heading-4">åˆ›å»º BootStrapContext</h2>
<h3 data-id="heading-5">ä»‹ç»</h3>
<p>å¯ä»¥æŸ¥çœ‹è¿™ä¸ªç±»çš„æ³¨é‡Šæˆ–è€… <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.spring.io%2Fspring-boot%2Fapi%2Fjava%2Forg%2Fspringframework%2Fboot%2Fbootstrap%2FBootstrapContext.html" target="_blank" title="https://docs.spring.io/spring-boot/api/java/org/springframework/boot/bootstrap/BootstrapContext.html" ref="nofollow noopener noreferrer">å®˜ç½‘ä»‹ç»</a> ï¼Œè¯´å®ƒæ˜¯ä¸€ä¸ªæ—©äº <code>Spring</code> ä¸Šä¸‹æ–‡ <code>ApplicationContext</code> åˆ›å»ºå‰åˆ›å»ºçš„ä¸´æ—¶å®¹å™¨ï¼Œå«åš <strong>å¼•å¯¼ä¸Šä¸‹æ–‡</strong>ï¼Œ<strong>å®ƒçš„å¯ç”¨æ—¶æœºæ˜¯ä» SpringBoot é¡¹ç›®å¯åŠ¨å¼€å§‹åˆ° Spring å®¹å™¨ ApplicationContext åˆ›å»ºä¹‹åï¼Œå‡†å¤‡å¥½ä¹‹å‰</strong></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹ä¸‹æºç ï¼Œç»“åˆæ³¨é‡Šæ¥çœ‹ï¼Œç¡®å®ç±»ä¼¼äºä¸€ä¸ª <code>Spring</code> å®¹å™¨ä¸Šä¸‹æ–‡ <code>ApplicationContext</code>ï¼Œ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * A simple bootstrap context that is available during startup and {<span class="hljs-doctag">@link</span> Environment}
 * post-processing up to the point that the {<span class="hljs-doctag">@link</span> ApplicationContext} is prepared.
 * &lt;p&gt;
 * Provides lazy access to singletons that may be expensive to create, or need to be
 * shared before the {<span class="hljs-doctag">@link</span> ApplicationContext} is available.
 *
 * <span class="hljs-doctag">@author</span> Phillip Webb
 * <span class="hljs-doctag">@since</span> 2.4.0
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">BootstrapContext</span> {
    &lt;T&gt; T <span class="hljs-title function_">get</span><span class="hljs-params">(Class&lt;T&gt; type)</span> <span class="hljs-keyword">throws</span> IllegalStateException;
    &lt;T&gt; T <span class="hljs-title function_">getOrElse</span><span class="hljs-params">(Class&lt;T&gt; type, T other)</span>;
    &lt;T&gt; T <span class="hljs-title function_">getOrElseSupply</span><span class="hljs-params">(Class&lt;T&gt; type, Supplier&lt;T&gt; other)</span>;
    &lt;T, X <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Throwable</span>&gt; T <span class="hljs-title function_">getOrElseThrow</span><span class="hljs-params">(Class&lt;T&gt; type, Supplier&lt;? extends X&gt; exceptionSupplier)</span> <span class="hljs-keyword">throws</span> X;
    &lt;T&gt; <span class="hljs-type">boolean</span> <span class="hljs-title function_">isRegistered</span><span class="hljs-params">(Class&lt;T&gt; type)</span>;
}
</code></pre>
<p>å¯ä»¥ä»è¿™ä¸ªå®¹å™¨ä¸­è·å–å¯¹è±¡ï¼Œå½“ç„¶æˆ‘ä»¬è¦æå‰é€šè¿‡æ³¨å†Œå™¨ <code>BootStrapResitry</code> å‘å…¶ä¸­æ³¨å†Œå¯¹è±¡ï¼Œå°±åƒ <code>BeanDefinitionRegistry</code> ä¸€æ ·</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">BootstrapRegistry</span> {
    &lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">register</span><span class="hljs-params">(Class&lt;T&gt; type, InstanceSupplier&lt;T&gt; instanceSupplier)</span>;
    &lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerIfAbsent</span><span class="hljs-params">(Class&lt;T&gt; type, InstanceSupplier&lt;T&gt; instanceSupplier)</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">addCloseListener</span><span class="hljs-params">(ApplicationListener&lt;BootstrapContextClosedEvent&gt; listener)</span>;
}
</code></pre>
<p>å®ƒçš„åˆ›å»ºå¾ˆç®€å•ï¼Œå°±æ˜¯ <code>new</code> äº†ä¸€ä¸ªå®ä¾‹</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> DefaultBootstrapContext <span class="hljs-title function_">createBootstrapContext</span><span class="hljs-params">()</span> {
    <span class="hljs-type">DefaultBootstrapContext</span> <span class="hljs-variable">bootstrapContext</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultBootstrapContext</span>();
    <span class="hljs-built_in">this</span>.bootstrapRegistryInitializers.forEach((initializer) -&gt; initializer.initialize(bootstrapContext));
    <span class="hljs-keyword">return</span> bootstrapContext;
}
</code></pre>
<p>ä» <code>createBootstrapContext()</code> çš„ç¬¬äºŒè¡Œä»£ç æˆ‘ä»¬å‘ç°ï¼Œåˆ›å»ºå®Œ <code>DefaultBootstrapContext</code> ä¹‹åä¼šè°ƒç”¨ä¸€ä¸ªåˆå§‹åŒ–å™¨åˆ—è¡¨ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å®ç° <code>BootstrapRegistryInitializer</code> åˆ›å»ºè‡ªå®šä¹‰åˆå§‹åŒ–å™¨ã€‚æ¯”å¦‚ï¼Œåœ¨ <code>SpringBoot</code> å¯åŠ¨åï¼Œ<code>Spring</code> å®¹å™¨åˆ›å»ºå‰ï¼Œå‘ <code>BootStrapContext</code> é‡Œé¢å­˜æ”¾ä¸€äº›è‡ªå®šä¹‰çš„å¯¹è±¡ã€‚</p>
<p><strong>å¼•å¯¼ä¸Šä¸‹æ–‡</strong> åˆ›å»ºæˆåŠŸåä¼šé€šè¿‡ <code>EventPublishingRunListenerï¼ˆä¸‹ä¸€æ®µä¼šä»‹ç»ï¼‰</code> å‘å¸ƒä¸€ä¸ª <code>ApplicationStartingEvent</code> äº‹ä»¶</p>
<h3 data-id="heading-6">ä½¿ç”¨åœºæ™¯</h3>
<blockquote>
<p><strong>ç›®å‰è¿˜æ²¡å‘ç°æœ‰ä»€ä¹ˆå®é™…ä½¿ç”¨åœºæ™¯ï¼Œè¯„è®ºåŒºçŸ¥é“çš„å¯ä»¥åˆ†äº«ä¸€ä¸‹......</strong></p>
</blockquote>
<h3 data-id="heading-7">ä½¿ç”¨æ–¹å¼</h3>
<ul>
<li>ä½¿ç”¨ <code>SpringApplication</code> æ·»åŠ </li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">SpringApplicationBuilder</span> <span class="hljs-variable">builder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SpringApplicationBuilder</span>(SpringAiDemoApplication.class);
<span class="hljs-type">SpringApplication</span> <span class="hljs-variable">application</span> <span class="hljs-operator">=</span> builder.application();
application.addBootstrapRegistryInitializer(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyBootstrapRegistryInitializer</span>());
application.run(args);
</code></pre>
<ul>
<li>é…ç½® <code>spring.factories</code></li>
</ul>
<p>åœ¨ <code>resources</code> æ–‡ä»¶å¤¹ä¸‹æ–°å»º <code>META-INF/spring.factories</code> ï¼Œç„¶åæ–‡ä»¶é…ç½®å¦‚ä¸‹</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">org.springframework.boot.BootstrapRegistryInitializer</span>=\
com.syc.springaidemo.config.MyBootstrapRegistryInitializer
</code></pre>
<p>é¡¹ç›®å¯åŠ¨å°±ä¼šæ‰§è¡Œ <code>MyBootstrapRegistryInitializer.initialize</code> ã€‚å…·ä½“åŸç†ä¸‹ä¸€ç« èŠ‚ä¼šè§£é‡Š</p>
<h2 data-id="heading-8">è·å– SpringApplicationRunListeners</h2>
<p><code>SpringApplicationRunListeners</code> æ˜¯ <code>SpringBoot</code> è¿è¡Œæµç¨‹é˜¶æ®µçš„ç›‘å¬å™¨é›†åˆåŒ…è£…ç±»</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringApplicationRunListeners</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;SpringApplicationRunListener&gt; listeners;
    <span class="hljs-comment">//...</span>
}
</code></pre>
<blockquote>
<p>ä½¿ç”¨é›†åˆåŒ…è£…ç±»æ˜¯ä¸ºäº†æ‰©å±•ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥é¢å¤–è‡ªå®šä¹‰å¤šä¸ª <code>SpringApplicationRunListener</code> åœ¨ <code>SpringBoot</code> å¯åŠ¨çš„ä¸åŒé˜¶æ®µæ¥åšæˆ‘ä»¬è‡ªå®šä¹‰çš„é€»è¾‘</p>
</blockquote>
<p>åŸå§‹ç±»/æ¥å£æ˜¯ <code>SpringApplicationRunListener</code>ã€‚å½“ <code>SpringBoot</code> æµç¨‹å¯åŠ¨è¿›è¡Œåˆ°ä¸åŒçš„é˜¶æ®µï¼Œéƒ½ä¼šè°ƒç”¨å¯¹åº”çš„é˜¶æ®µæ–¹æ³•ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">SpringApplicationRunListener</span> {

    <span class="hljs-comment">/**
     * SpringBoot å¯åŠ¨ åˆ›å»º BootstrapContext ä¹‹åç«‹å³è°ƒç”¨
     */</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">starting</span><span class="hljs-params">(ConfigurableBootstrapContext bootstrapContext)</span> {}
 
    <span class="hljs-comment">/**
     * SpringBoot ç¯å¢ƒå‡†å¤‡å¥½ä¹‹åç«‹å³è°ƒç”¨
     */</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">environmentPrepared</span><span class="hljs-params">(ConfigurableBootstrapContext bootstrapContext,
          ConfigurableEnvironment environment)</span> {}
    
    <span class="hljs-comment">/**
     * SpringBoot ä¸Šä¸‹æ–‡å‡†å¤‡å¥½ä¹‹åç«‹å³è°ƒç”¨
     */</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">contextPrepared</span><span class="hljs-params">(ConfigurableApplicationContext context)</span> {}

    <span class="hljs-comment">/**
     * SpringBoot ä¸Šä¸‹æ–‡è¢«åŠ è½½åç«‹å³è°ƒç”¨
     */</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">contextLoaded</span><span class="hljs-params">(ConfigurableApplicationContext context)</span> {}

    <span class="hljs-comment">/**
     * Spring ä¸Šä¸‹æ–‡è¢«åˆ·æ–°åç«‹å³è°ƒç”¨
     */</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">started</span><span class="hljs-params">(ConfigurableApplicationContext context, Duration timeTaken)</span> {}

    <span class="hljs-comment">/**
     * Runner è°ƒç”¨å®Œåç«‹å³è°ƒç”¨
     */</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">ready</span><span class="hljs-params">(ConfigurableApplicationContext context, Duration timeTaken)</span> {}

    <span class="hljs-comment">/**
     * å‘ç”Ÿå¼‚å¸¸ç«‹å³è°ƒç”¨
     */</span>
    <span class="hljs-keyword">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">failed</span><span class="hljs-params">(ConfigurableApplicationContext context, Throwable exception)</span> {}

}
</code></pre>
<p>å¯ä»¥å‚è€ƒå®˜ç½‘ä»‹ç» <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.spring.io%2Fspring-boot%2Freference%2Ffeatures%2Fspring-application.html" target="_blank" title="https://docs.spring.io/spring-boot/reference/features/spring-application.html" ref="nofollow noopener noreferrer">Application Events and Listeners
</a></p>
<p>å…¶é»˜è®¤å®ç°ç±»æ˜¯ç³»ç»Ÿå†…ç½®çš„ <code>EventPublishingRunListener</code> ã€‚æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹å®ƒçš„æºç ï¼Œå‘ç°åœ¨è¿™äº›é˜¶æ®µ <code>SpringBoot</code> å‘å‡ºäº†å¯¹åº”çš„äº‹ä»¶</p>
<ul>
<li>
<p><code>ApplicationStartingEvent</code></p>
</li>
<li>
<p><code>ApplicationEnvironmentPreparedEvent</code></p>
</li>
<li>
<p><code>ApplicationContextInitializedEvent</code></p>
</li>
<li>
<p><code>ApplicationPreparedEvent</code></p>
</li>
<li>
<p><code>ApplicationStartedEvent</code></p>
</li>
<li>
<p><code>ApplicationReadyEvent</code></p>
</li>
<li>
<p><code>ApplicationFailedEvent</code></p>
</li>
</ul>
<p>ç„¶åæœ‰å†…ç½®çš„ç›‘å¬å™¨ä¼šç›‘å¬ï¼Œåšä¸€äº›å¯¹åº”çš„é€»è¾‘å¤„ç†</p>
<h3 data-id="heading-9">SpringBoot å†…ç½®çš„äº‹ä»¶ç›‘å¬å™¨</h3>
<p>æ­£å¦‚ä¸Šé¢ä»‹ç»çš„ä¸€æ ·,æœ‰ä¸€ä¸ªç›‘å¬å™¨é›†åˆå»ç›‘å¬ <code>SpringBoot</code> å¯åŠ¨æµç¨‹ä¸åŒé˜¶æ®µå‘å¸ƒçš„äº‹ä»¶,æˆ‘ä»¬ç»§ç»­è§‚å¯Ÿ <code>spring.factories</code> æ–‡ä»¶ï¼Œå‘ç°äº†ä¸‹é¢ä¸€ç³»åˆ—çš„ç›‘å¬å™¨ï¼Œæ³¨æ„çœ‹å®ƒä»¬çš„åŒ…åï¼Œæ˜¯å±äº <code>SpringBoot</code> çš„</p>
<pre><code class="hljs language-factories" lang="factories"># Application Listeners
org.springframework.context.ApplicationListener=\
org.springframework.boot.ClearCachesApplicationListener,\
org.springframework.boot.builder.ParentContextCloserApplicationListener,\
org.springframework.boot.context.FileEncodingApplicationListener,\
org.springframework.boot.context.config.AnsiOutputApplicationListener,\
org.springframework.boot.context.logging.LoggingApplicationListener,\
org.springframework.boot.env.EnvironmentPostProcessorApplicationListener
</code></pre>
<p>æ¯”å¦‚ä¸€ä¸ªå¾ˆé‡è¦çš„é˜¶æ®µå°±æ˜¯ç¯å¢ƒåˆ›å»ºå¹¶ä¸”å‡†å¤‡å¥½ï¼Œæ­¤æ—¶ä¼šè°ƒç”¨ <code>SpringApplicationRunListener.environmentPrepared()</code> å‘å¸ƒ <code>ApplicationEnvironmentPreparedEvent</code> äº‹ä»¶ã€‚<code>EnvironmentPostProcessorApplicationListener</code> ä¼šå¯¹æ­¤äº‹ä»¶ç›‘å¬ï¼Œå¯¹ <code>Environment</code> åšä¸€äº›å¤„ç†ã€‚ä¸‹ä¸€éƒ¨åˆ†ç¯å¢ƒç« èŠ‚ä¼šè¯¦ç»†ä»‹ç»å®ƒåˆ°åº•å¹²äº†ä»€ä¹ˆ</p>
<p>é‚£ä¹ˆæˆ‘ä»¬çš„æ‰©å±•ç‚¹å°±æ¥äº†ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªç›‘å¬å™¨ç±» <code>MyTestListener</code>ï¼Œç„¶åè‡ªå·±åœ¨é¡¹ç›®ç±»è·¯å¾„ä¸‹ä¹Ÿåˆ›å»ºä¸€ä¸ª <code>META-INF/spring.factories</code> æ–‡ä»¶ï¼ŒæŒ‰ç…§å’Œå®ƒä¸€æ ·çš„è§„åˆ™é…ç½®ï¼Œè¿™æ ·æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ç›‘å¬å™¨ä¹Ÿä¼šç”Ÿæ•ˆ</p>
<h2 data-id="heading-10">spring.factories ä»‹ç»</h2>
<p>ä¸€ä¸ªå€¼å¾—æ€è€ƒçš„é—®é¢˜æ˜¯ <code>EventPublishingRunListener</code> æ˜¯æ€æ ·åœ¨ <code>SpringBoot</code> æµç¨‹ä¸­å‘æŒ¥ä½œç”¨çš„ï¼ŸåŒ…æ‹¬æˆ‘ä»¬ä¸Šé¢é…ç½®è‡ªå®šä¹‰ <code>MyBootstrapRegistryInitializer</code> ã€‚ ä¸ºä»€ä¹ˆé…ç½®åœ¨ <code>spring.factories</code> å°±èƒ½ç”Ÿæ•ˆï¼Ÿæˆ‘ä»¬æ²¡æœ‰æ˜¾ç¤ºçš„ä½¿ç”¨ <code>@Beanã€@Configuration</code> å»æ ‡æ³¨å®ƒä½œä¸ºä¸€ä¸ª <code>Spring Bean</code>ï¼Œæ›´ä½•å†µæ­¤æ—¶ <code>SpringBoot</code> è¿ç¯å¢ƒéƒ½è¿˜æ²¡æœ‰åˆ›å»ºï¼Œæ›´åˆ«è¯´ <code>Spring</code> å®¹å™¨äº†ï¼Œæ‰€ä»¥å³ä½¿ç”¨äº† <code>@Bean ã€@Configuration</code> æ­¤æ—¶ä¹Ÿä¸ä¼šç”Ÿæ•ˆã€‚</p>
<p>è·Ÿè¸ªæºç æˆ‘ä»¬ä¼šå‘ç° <code>getRunListeners</code> å†…éƒ¨è°ƒç”¨äº†è¿™æ ·ä¸€ä¸ªæ–¹æ³•</p>
<pre><code class="hljs language-java" lang="java">SpringFactoriesLoader.forDefaultResourceLocation(getClassLoader()).load(type, argumentResolver)
</code></pre>
<p>ç»§ç»­è¿½è¸ªæˆ‘ä»¬ä¼šå‘ç°å®ƒè¯»å–äº†ä¸€ä¸ªå›ºå®šä½ç½®çš„æ–‡ä»¶ <code>FACTORIES_RESOURCE_LOCATION = META-INF/spring.factories</code>ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/135f664f07fe4452aeb3b251c92f705e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060676&amp;x-signature=4SlT1zAzr2ATFpgzCXHDhpQaTPg%3D" alt="ä¼ä¸šå¾®ä¿¡æˆªå›¾_46aab477-c7af-435c-8624-b59431fca8b7.png" loading="lazy"/></p>
<p>è¿™éƒ¨åˆ†å…¶å®æ˜¯ <code>Spring</code> çš„å†…å®¹ï¼Œ<code>SpringFactoriesLoader</code> å°±æ˜¯è¯»å–ç±»è·¯å¾„ä¸‹æ‰€æœ‰ <code>META-INF/spring.factories</code> çš„é…ç½®ï¼Œå®ƒå¹¶ä¸ä¼šè¢«æ³¨å†Œä¸ºä¸€ä¸ª <code>Bean</code> æ”¾å…¥ <code>Spring å®¹å™¨</code>ã€‚è€Œæ˜¯ä¸ºäº†è§£å†³åœ¨ <code>Spring å®¹å™¨</code> å¯åŠ¨å‰ï¼Œç”¨æˆ·æƒ³è¦é¢å¤–æ‰§è¡Œä¸€äº›è‡ªå®šä¹‰çš„é€»è¾‘ã€‚æ‰€ä»¥ <code>Spring</code> æä¾›äº†è¿™æ ·çš„ä¸€ä¸ªå…¥å£ï¼Œç³»ç»Ÿå†…éƒ¨ä¼šä½¿ç”¨ <code>SpringFactoriesLoader</code> è¯»å–æ”¾åˆ°ç±»è·¯å¾„ä¸‹ <code>spring.factories</code> æ–‡ä»¶é‡Œé¢çš„é…ç½®ç±»ï¼Œæ¥å®ç°åœ¨ <code>Spring</code> å®¹å™¨å‡†å¤‡å¥½ä¹‹å‰çš„ä¸€äº›éœ€è¦æ‰©å±•çš„åŠŸèƒ½ ã€‚</p>
<p><code>BootstrapRegistryInitializer</code> å’Œ <code>SpringApplicationRunListeners</code> éƒ½æ˜¯è¿™ä¸ªåŸç†ï¼Œæºç ä¸­å»æ‰§è¡Œè¿™äº›å¯æ‰©å±•ç»„ä»¶çš„æ—¶å€™ï¼Œéƒ½æ˜¯ä½¿ç”¨ <code>SpringFactoriesLoader</code> ä»é…ç½®æ–‡ä»¶é¢å¤–è¯»å–ï¼Œå…è®¸æˆ‘ä»¬è‡ªå·±æ‰©å±•ã€‚</p>
<h2 data-id="heading-11">spring.factories åŒçº§çš„å…¶ä»–æ–‡ä»¶</h2>
<p>ç›¸æ¯”äº <code>spring.factories</code>ï¼Œ<code>spring-boot-autoconfigure</code> ä¸‹æœ‰ä¸€äº›å…¶ä»–æ–‡ä»¶ä¹Ÿæœ‰ä¸åŒçš„ä½œç”¨</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/09c405fd1cc44a3d877b073564140f3b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060676&amp;x-signature=nsOts9NreI%2BPUTv37syVy8FdPVs%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-12">additional-spring-configuration-metadata.json</h3>
<p>è¿™ä¸ªæ–‡ä»¶çš„ä½œç”¨æ˜¯ä¸ºäº†è®©æˆ‘ä»¬åœ¨ <code>application.yml</code> é‡Œé¢é…ç½®çš„å±æ€§å¯ä»¥è¢«å®šä½åˆ°ï¼Œå‡å¦‚æˆ‘ä»¬è¦åœ¨é…ç½®æ–‡ä»¶é‡Œé¢é…ç½®ä¸€äº›é <code>@ConfigurationPropeties</code> ç»‘å®šçš„å±æ€§ï¼Œé‚£ä¹ˆåœ¨é…ç½®æ–‡ä»¶é‡Œé¢å°±ä¼šæœ‰å‘Šè­¦ï¼Œè€Œä¸”ç‚¹å‡»é…ç½®æ— æ³•å®šä½ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b2a5d11758340c4b64ad119396dab11~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060676&amp;x-signature=E1TOYVPP%2BxaYpr6IFeJN4J3Uz7U%3D" alt="image.png" loading="lazy"/></p>
<p>ä½†æ˜¯æˆ‘ä»¬åœ¨ <code>META-INF</code> æ–‡ä»¶å¤¹ä¸‹æ–°å»º <code>additional-spring-configuration-metadata.json</code> æ–‡ä»¶ï¼Œé…ç½®ä¸‹é¢è¿™æ®µå†…å®¹</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"aliyun.filePath"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"java.lang.String"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ç¬¬ä¸‰æ–¹æœåŠ¡çš„ API æ–‡ä»¶è·¯å¾„"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>ç„¶åå†å»çœ‹ <code>application.yml</code> é…ç½®æ–‡ä»¶å°±æ²¡æœ‰è¿™ä¸ªå‘Šè­¦äº†ï¼Œå¹¶ä¸”ç‚¹å‡»å·¦é”®ä¹Ÿèƒ½è·³è½¬åˆ°æˆ‘ä»¬å®šä¹‰çš„ <code>json</code> æ–‡ä»¶å†…</p>
<h3 data-id="heading-13">spring-autoconfigure-metadata.properties</h3>
<p>è¿™ä¸ªæ–‡ä»¶æ˜¯æ¯”è¾ƒæœ‰å®é™…æ„ä¹‰çš„ï¼Œç‚¹è¿›å»æˆ‘ä»¬ä¼šå‘ç°è¿™é‡Œé¢é…ç½®äº† <code>SpringBoot</code> æ‰€æœ‰æ”¯æŒçš„ç¬¬ä¸‰æ–¹ç»„ä»¶çš„è‡ªåŠ¨é…ç½®ç±»ã€‚æˆ‘ä»¬ä»¥ <code>Redis</code> ä¸ºä¾‹</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bcd12be433b748b0b25b748bf51eb15e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060676&amp;x-signature=CVCIz90%2FlJFOjEZp%2FTNmxabc8Gs%3D" alt="image.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸€ä¸ªæ¡ä»¶é…ç½®ï¼Œè¿™ä¸ªæ–‡ä»¶çš„ä½œç”¨å°±æ˜¯åœ¨ <code>SpringBoot</code> å¯åŠ¨çš„æ—¶å€™æ ¹æ®ç›®å‰çš„å®é™…çŠ¶æ€åˆ¤å®šä¸€ä¸ªè‡ªåŠ¨é…ç½®ç±»æ˜¯å¦éœ€è¦è¢« <code>JVM</code> åŠ è½½ï¼Œå¦‚æœä¸éœ€è¦å°±è·³è¿‡å»ã€‚æ¯”å¦‚æˆ‘ä»¬ç°åœ¨è¿™ä¸ªåº”ç”¨æ²¡æœ‰å¼•å…¥ <code>redis</code> ï¼Œæ ¹æœ¬ç”¨ä¸ç€ï¼Œé‚£ <code>SpringBoot</code> è¿˜å»è®© <code>JVM</code> åŠ è½½ <code>RedisAutoConfiguration</code> è¿™ä¸ªç±»ï¼Œæ˜¯ä¸æ˜¯å°±æ˜¯æµªè´¹èµ„æºï¼Ÿ</p>
<p>åœ¨è·å–æ‰€æœ‰è‡ªåŠ¨é…ç½®ç±»çš„è¿‡ç¨‹ä¸­ä¼šè¯»å–è¿™ä¸ªæ–‡ä»¶ï¼Œç„¶åè¿‡æ»¤æ‰å½“å‰ä¸éœ€è¦åŠ è½½çš„è‡ªåŠ¨é…ç½®ç±»ï¼Œåªè¿”å›å®é™…éœ€è¦åŠ è½½çš„</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//org.springframework.boot.autoconfigure.AutoConfigurationImportSelector#getAutoConfigurationEntry</span>
<span class="hljs-keyword">protected</span> AutoConfigurationEntry <span class="hljs-title function_">getAutoConfigurationEntry</span><span class="hljs-params">(AnnotationMetadata annotationMetadata)</span> {
    <span class="hljs-keyword">if</span> (!isEnabled(annotationMetadata)) {
       <span class="hljs-keyword">return</span> EMPTY_ENTRY;
    }
    <span class="hljs-type">AnnotationAttributes</span> <span class="hljs-variable">attributes</span> <span class="hljs-operator">=</span> getAttributes(annotationMetadata);
    <span class="hljs-comment">//æ‰«æ imports æ–‡ä»¶ï¼ˆåé¢çš„ç« èŠ‚ä¼šè¯¦ç»†ä»‹ç»ï¼‰</span>
    List&lt;String&gt; configurations = getCandidateConfigurations(annotationMetadata, attributes);
    configurations = removeDuplicates(configurations);
    Set&lt;String&gt; exclusions = getExclusions(annotationMetadata, attributes);
    checkExcludedClasses(configurations, exclusions);
    configurations.removeAll(exclusions);
    <span class="hljs-comment">//è¯»å– spring-autoconfigure-metadata.properties è¿‡æ»¤å½“å‰ä¸éœ€è¦åŠ è½½çš„è‡ªåŠ¨é…ç½®ç±»</span>
    configurations = getConfigurationClassFilter().filter(configurations);
    fireAutoConfigurationImportEvents(configurations, exclusions);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AutoConfigurationEntry</span>(configurations, exclusions);
}
</code></pre>
<h3 data-id="heading-14">spring-configuration-metadata.json</h3>
<p>è¿™ä¸ªæ–‡ä»¶é‡Œé¢é…ç½®äº†æ‰€æœ‰ <code>SpringBoot</code> è‡ªåŠ¨é…ç½®ç»„ä»¶çš„å±æ€§å­—æ®µï¼Œä»…ä»…æ˜¯ä¸€ä¸ªæç¤ºæ–‡æ¡£ï¼Œä¾‹å¦‚å…¶ä¸­å¯¹äº <code>AOP</code> çš„é…ç½®</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"spring.aop.proxy-target-class"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"java.lang.Boolean"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Whether subclass-based (CGLIB) proxies are to be created (true), as opposed to standard Java interface-based proxies (false)."</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"defaultValue"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å°±æ˜¯å‘Šè¯‰æˆ‘ä»¬å¼€å‘è€…è¿™ä¸ªå­—æ®µé»˜è®¤å€¼æ˜¯ <code>true</code>ï¼Œè¿™ä¸ªå­—æ®µçš„ä½œç”¨æ˜¯ <code>description</code> çš„å†…å®¹ã€‚</p>
<h2 data-id="heading-15">åˆ›å»ºå’Œå‡†å¤‡ç¯å¢ƒ Environment</h2>
<p>åˆ›å»ºä¸€ä¸ª <code>SpringBoot Web</code> ç¯å¢ƒä¸‹çš„ç‰¹å®šç¯å¢ƒå¯¹è±¡ <code>ApplicationServletEnvironment</code>ã€‚å…¶ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„æˆå‘˜å˜é‡</p>
<ul>
<li>èµ„æºåˆ—è¡¨ ï¼š å­˜å‚¨å½“å‰ç¯å¢ƒä¸­æœ‰å“ªäº›èµ„æº</li>
<li>èµ„æºè§£æå™¨ ï¼š ä»å½“å‰ç¯å¢ƒä¸­è·å–èµ„æºæ—¶æä¾›è§£ææ–¹å¼</li>
</ul>
<p>è¿™é‡Œ <code>debug</code> å»æŸ¥çœ‹åˆ›å»º <code>Environment</code> çš„è°ƒç”¨é“¾ä¼šæœ‰ä¸€ç‚¹å¤æ‚ï¼Œå› ä¸ºèµ°äº†ä¸€ç³»åˆ—çš„çˆ¶ç±»æ„é€ æ–¹æ³•ã€‚é¡ºåºå¦‚ä¸‹</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">new</span> <span class="hljs-title class_">ApplicationServletEnvironment</span>()  
â†“
<span class="hljs-keyword">new</span> <span class="hljs-title class_">StandardServletEnvironment</span>()
â†“
<span class="hljs-keyword">new</span> <span class="hljs-title class_">StandardEnvironment</span>()
â†“
<span class="hljs-keyword">new</span> <span class="hljs-title class_">AbstractEnvironment</span>() 
â†“
<span class="hljs-keyword">new</span> <span class="hljs-title class_">AbstractEnvironment</span>(MutablePropertySources propertySources)

</code></pre>
<p><code>AbstractEnvironment</code> çš„æ„é€ æ–¹æ³•ä¸­ä¼šç»™èµ„æºåˆ—è¡¨ä¸­æ·»åŠ ä¸€äº›åˆå§‹èµ„æºã€åˆ›å»ºå±æ€§èµ„æºè§£æå™¨</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> <span class="hljs-title function_">AbstractEnvironment</span><span class="hljs-params">(MutablePropertySources propertySources)</span> {
    <span class="hljs-built_in">this</span>.propertySources = propertySources;
    <span class="hljs-built_in">this</span>.propertyResolver = createPropertyResolver(propertySources);
    customizePropertySources(propertySources);
}
</code></pre>
<h3 data-id="heading-16">å±æ€§èµ„æºåˆ—è¡¨</h3>
<p>ç¯å¢ƒåˆ›å»ºä¹‹åä¼šåˆå§‹åŒ–ä¸€ä¸ªå±æ€§èµ„æºåˆ—è¡¨åŒ…å«ä»¥ä¸‹ä¸¤ä¸ªå†…å®¹ï¼Œçœç•¥ <code>StubPropertySource</code> è¿™æ˜¯ä¸€ä¸ªå ä½çš„æŠ½è±¡èµ„æºç±»ï¼Œåç»­ä¼šè¢«æ›¿æ¢ä¸ºå®é™…èµ„æº</p>
<ul>
<li><code>PropertiesPropertySource</code> ä» <code>System.getProperties()</code> è·å– <code>JVM</code> çº§åˆ«çš„ç³»ç»Ÿå±æ€§</li>
<li><code>SystemEnvironmentPropertySource</code> ä» <code>System.getEnv()</code> è·å–æ“ä½œç³»ç»Ÿçº§åˆ«çš„ç¯å¢ƒå˜é‡</li>
</ul>
<p>å®Œå…¨å¯åŠ¨ä¹‹åï¼Œç¯å¢ƒä¸­æœ‰ä»¥ä¸‹èµ„æº</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0822c919862d441786513ce9ee4ff29c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060676&amp;x-signature=i3lDG7tZoKJ5NN531GOBulfDBW8%3D" alt="ä¼ä¸šå¾®ä¿¡æˆªå›¾_aaa8bfaf-2cb9-4ff7-90ca-381db115627d.png" loading="lazy"/></p>
<p>æ ¹æ®è¿™ä¸ª <code>debug</code> é¢æ¿æˆ‘ä»¬å‡ ä¹å…¨éƒ¨èƒ½çŒœå‡ºä»–ä»¬çš„èµ„æºç±»å‹ã€‚</p>
<h3 data-id="heading-17">å±æ€§èµ„æºè§£æå™¨</h3>
<p>ä¸ºä»€ä¹ˆéœ€è¦èµ„æºè§£æå™¨ï¼Ÿæ¯”å¦‚æœ‰æ—¶å€™æˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„æ˜¯ <code>${spring.cloud.client.ip-address}</code> è¿™ç§æ ¼å¼ï¼Œèµ„æºè§£æå™¨å°±å¯ä»¥è§£æè¿™ç§æ ¼å¼çš„é…ç½®ï¼Œæ‰¾åˆ°æ­£ç¡®çš„å€¼ã€‚åˆæˆ–è€…æˆ‘ä»¬ä»ç¯å¢ƒé‡Œé¢è·å–èµ„æºçš„æ—¶å€™è·å–çš„ä¸æ˜¯ <code>String</code> ç±»å‹ï¼Œéœ€è¦æ™ºèƒ½è½¬æ¢æˆå®ä½“å¯¹è±¡æˆ–è€…å…¶ä»–ç±»å‹ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//org.springframework.core.env.AbstractEnvironment#getProperty()</span>

<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> &lt;T&gt; T <span class="hljs-title function_">getProperty</span><span class="hljs-params">(String key, Class&lt;T&gt; targetType, T defaultValue)</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.propertyResolver.getProperty(key, targetType, defaultValue);
}
</code></pre>
<p>å±æ€§è§£æå™¨ <code>this.propertyResolver</code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//ConfigurationPropertySourcesPropertyResolver#getProperty() è¿™ä¸ªåå­—çœŸæ˜¯é•¿ï¼</span>

<span class="hljs-keyword">private</span> &lt;T&gt; T <span class="hljs-title function_">getProperty</span><span class="hljs-params">(String key, Class&lt;T&gt; targetValueType, <span class="hljs-type">boolean</span> resolveNestedPlaceholders)</span> {
    <span class="hljs-type">Object</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> findPropertyValue(key);<span class="hljs-comment">//éå†èµ„æºåˆ—è¡¨</span>
    <span class="hljs-keyword">if</span> (value == <span class="hljs-literal">null</span>) {
       <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    <span class="hljs-keyword">if</span> (resolveNestedPlaceholders &amp;&amp; value <span class="hljs-keyword">instanceof</span> String string) {
       value = resolveNestedPlaceholders(string);<span class="hljs-comment">//è§£æå ä½ç¬¦ {}ã€[]ã€()</span>
    }
    <span class="hljs-keyword">try</span> {
       <span class="hljs-keyword">return</span> convertValueIfNecessary(value, targetValueType);ã€<span class="hljs-comment">//ç±»å‹è½¬æ¢</span>
    }
    <span class="hljs-keyword">catch</span> (ConversionFailedException ex) {
       <span class="hljs-type">Exception</span> <span class="hljs-variable">wrappedCause</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvalidConfigurationPropertyValueException</span>(key, value,
             <span class="hljs-string">"Failed to convert to type "</span> + ex.getTargetType(), ex.getCause());
       <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConversionFailedException</span>(ex.getSourceType(), ex.getTargetType(), ex.getValue(), wrappedCause);
    }
}
</code></pre>
<p>è§£æå ä½ç¬¦çš„åŸç†å°±æ˜¯ä»å·²ç»å­˜åœ¨çš„å±æ€§èµ„æºåˆ—è¡¨ä¸­ï¼Œå»æŸ¥è¯¢å ä½ç¬¦é‡Œç»™å®šçš„ <code>key</code> ã€‚æ¯”å¦‚ï¼Œå‡å¦‚æˆ‘ä»¬é…ç½®ä¸€ä¸ª
<code>special-key:${spring.cloud.client.ip-address:192.168.1.1}</code> ã€‚é‚£ <code>special-key</code> æœ€ç»ˆçš„å€¼æ€ä¹ˆæ¥å‘¢ï¼Œå…ˆå»å½“å‰ç¯å¢ƒ <code>Environment</code> çš„æ‰€æœ‰å±æ€§èµ„æºåˆ—è¡¨ä¸­æŸ¥è¯¢å­—æ®µåæ˜¯ <code>spring.cloud.client.ip-address</code> çš„å˜é‡çš„å€¼ï¼Œå¦‚æœæ‰¾åˆ°äº†ï¼Œå°±å–è¿™ä¸ªå€¼ï¼Œæ‰¾ä¸åˆ°å°±å–å†’å·åé¢çš„ä½œä¸ºé»˜è®¤å€¼ã€‚</p>
<h3 data-id="heading-18">ç±»å‹è½¬æ¢æœåŠ¡ ApplicationConversionService</h3>
<p>ç”¨äºç±»å‹è½¬æ¢ã€‚æœ€å…¸å‹çš„ç”¨æ³•å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨ <code>@ConfigurationProperties</code> æ¥æ˜ å°„é…ç½®æ–‡ä»¶å’Œé…ç½®å¯¹è±¡ç»‘å®š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@ConfigurationProperties(prefix = "syc")</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestBindProperty</span> {
    <span class="hljs-keyword">private</span> Duration expireTime;
}
</code></pre>
<p>é…ç½®æ–‡ä»¶é…ç½®</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">syc:</span>
  <span class="hljs-attr">expireTime:</span> <span class="hljs-string">7d</span>
</code></pre>
<p>å°±èƒ½æ­£ç¡®æ˜ å°„åˆ° <code>TestBindProperty Bean</code> å¯¹è±¡ä¸­ï¼Œèµ‹å€¼ç»™ <code>Duration</code> ç±»å‹çš„å­—æ®µï¼Œå®ƒçš„è½¬æ¢æ˜¯é€šè¿‡ <code>ApplicationConversionService</code> å†…éƒ¨çš„è½¬æ¢å™¨å®ç°çš„ï¼Œ<code>org.springframework.core.convert.support</code> åŒ…ä¸‹å®šä¹‰äº†å„ç§ç±»å‹è½¬æ¢å™¨ï¼Œè€Œ <code>SpringBoot</code> åŒ…ä¸‹åˆé¢å¤–æ‰©å±•äº†ä¸€äº›è½¬æ¢å™¨ï¼Œä¾‹å¦‚ <code>org.springframework.boot.convert.StringToDurationConverter</code>ã€‚</p>
<blockquote>
<p><code>SpringMVC</code> ä¸­ï¼Œæˆ‘ä»¬ <code>@Contoller</code> æ ‡æ³¨çš„æ§åˆ¶å™¨ä¸­ï¼Œä»å®¢æˆ·ç«¯ä¼ é€’çš„å‚æ•°ä¹Ÿèƒ½è‡ªåŠ¨è½¬æ¢æˆå¯¹è±¡æˆ–è€…ï¼Œ<code>String</code> è½¬ <code>Longã€Integer</code>ï¼ŒåŸç†æ˜¯é€šè¿‡å„ç§å‚æ•°è§£æå™¨ <code>HandlerMethodArgumentResolver</code>ï¼Œè€Œå‚æ•°è§£æå™¨å†…éƒ¨ä¹Ÿæ˜¯é€šè¿‡ç±»å‹è½¬æ¢æœåŠ¡ï¼Œè¿›è€Œé€šè¿‡å„ç§ <code>Converter</code> æ¥å®ç°çš„ã€‚</p>
</blockquote>
<h3 data-id="heading-19">ç¯å¢ƒåç½®å¤„ç†å™¨</h3>
<p>ç¯å¢ƒåç½®å¤„ç†å™¨ <code>EnvironmentPostProcessor</code>ï¼Œé€šè¿‡ç›‘å¬ç¯å¢ƒå‡†å¤‡å¥½äº‹ä»¶ï¼Œåœ¨è¿™é‡Œä¼šæ‰§è¡Œä¸€äº›åç½®å¤„ç†å™¨ï¼Œå¾€å½“å‰ <code>Environment</code> é‡Œé¢æ·»åŠ æ›´å¤šçš„å±æ€§èµ„æºï¼Œæ¯”å¦‚è§£ææˆ‘ä»¬çš„é…ç½®æ–‡ä»¶ <code>application.yml</code>ï¼Œæ­¤æ—¶å¤šäº†ä¸€ä¸ªé…ç½®æ–‡ä»¶èµ„æºã€‚æ¯”å¦‚å‘ç¯å¢ƒä¸­æ·»åŠ éšæœºæ•°èµ„æºï¼Œä¾¿äºæˆ‘ä»¬åœ¨ <code>application.yml</code> é…ç½®æ–‡ä»¶ä¸­éœ€è¦ç»™æŸä¸ªå€¼é…ç½®éšæœºæ•°ã€‚å…·ä½“å¯ä»¥æŸ¥çœ‹ <code>spring.factories</code> æ–‡ä»¶</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># Environment Post Processors</span>
<span class="hljs-attr">org.springframework.boot.env.EnvironmentPostProcessor</span>=\
org.springframework.boot.cloud.CloudFoundryVcapEnvironmentPostProcessor,\
org.springframework.boot.context.config.ConfigDataEnvironmentPostProcessor,\
org.springframework.boot.env.RandomValuePropertySourceEnvironmentPostProcessor,\
org.springframework.boot.env.SpringApplicationJsonEnvironmentPostProcessor,\
org.springframework.boot.env.SystemEnvironmentPropertySourceEnvironmentPostProcessor,\
org.springframework.boot.reactor.ReactorEnvironmentPostProcessor
</code></pre>
<p>é€šè¿‡è¿™äº›åç½®å¤„ç†å™¨çš„åå­—æˆ‘ä»¬å¤§è‡´èƒ½çŒœåˆ°ä½œç”¨ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ <code>debug</code> è°ƒè¯•æºç ã€‚ä¾‹å¦‚ <code>ConfigDataEnvironmentPostProcessor</code> å°±æ˜¯è¯»å– <code>application.yml</code> é…ç½®å†…å®¹çš„ç¯å¢ƒåç½®å¤„ç†å™¨</p>
<h2 data-id="heading-20">æ‰“å° Banner</h2>
<p>åœ¨æ§åˆ¶å°æˆ–è€…æ—¥å¿—æ–‡ä»¶é‡Œé¢æ‰“å°ä¸€ä¸ªæ¨ªå¹…ã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown">  .   <span class="hljs-strong">____</span>          _            __ _ _
 /\\ / <span class="hljs-strong">__<span class="hljs-emphasis">_'_</span> __</span> _ <span class="hljs-emphasis">_(_</span>)_ __  __ _ \ \ \ \
( ( )\<span class="hljs-strong">___ | '_ | '<span class="hljs-emphasis">_| | '_</span> \/ <span class="hljs-emphasis">_` | \ \ \ \
 \\/  _</span>__</span>)| |<span class="hljs-emphasis">_)| | | | | || (_</span>| |  ) ) ) )
  '  |<span class="hljs-strong">____</span>| .<span class="hljs-strong">__|<span class="hljs-emphasis">_| |_</span>|<span class="hljs-emphasis">_| |_</span>\__</span>, | / / / /
 =========|<span class="hljs-emphasis">_|==============|<span class="hljs-strong">___/=/_/_/_/

 :: Spring Boot ::                (v3.4.1)
</span></span></code></pre>
<p>é€»è¾‘å¾ˆç®€å•ï¼Œè§‚å¯Ÿæºç ï¼Œ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> Banner <span class="hljs-title function_">getTextBanner</span><span class="hljs-params">(Environment environment)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">location</span> <span class="hljs-operator">=</span> environment.getProperty(BANNER_LOCATION_PROPERTY, DEFAULT_BANNER_LOCATION);
    <span class="hljs-type">Resource</span> <span class="hljs-variable">resource</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.resourceLoader.getResource(location);
    <span class="hljs-keyword">if</span> (resource.exists()){...}
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
</code></pre>
<p>å¦‚æœè¿™ä¸ªä½ç½® <code>DEFAULT_BANNER_LOCATION = banner.txt</code> å­˜åœ¨æŒ‡å®šæ–‡ä»¶ï¼Œå°±æ‰“å°è¿™ä¸ªæ–‡ä»¶é‡Œé¢çš„å†…å®¹ï¼Œå¦‚æœæ²¡æœ‰å°±ç”¨ç³»ç»Ÿå†…ç½®çš„ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„æ–‡æœ¬å›¾æ¡ˆã€‚è§‚å¯Ÿåˆ° <code>location</code> æ˜¯ä»ç¯å¢ƒå˜é‡é‡Œé¢è·å–çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <code>application.yml</code> ä¸­é…ç½® <code>spring.banner.location</code> æ¥ä»»æ„æŒ‡å®š <code>banner</code> æ–‡ä»¶çš„èµ„æºä½ç½®ã€‚</p>
<h2 data-id="heading-21">åˆ›å»ºå’Œå‡†å¤‡ Spring ä¸Šä¸‹æ–‡</h2>
<p>ç¯å¢ƒå‡†å¤‡å¥½ä¹‹åå°±å¼€å§‹åˆ›å»º <code>Spring</code> ä¸Šä¸‹æ–‡ <code>ApplicationContext</code> äº†ã€‚è¿™é‡Œåœ¨ <code>Web</code> ç¯å¢ƒä¸­åˆ›å»ºçš„æ˜¯<code>AnnotationConfigServletWebServerApplicationContext</code>ï¼Œå®ƒæ˜¯ <code>SpringBoot</code> æ‰©å±•çš„ä¸€ä¸ª <code>ApplicationContext</code> çš„å®ç°ç±»ã€‚</p>
<h3 data-id="heading-22">æ³¨å†Œ BeanFactoryBostProcessorã€BeanBostProcessor</h3>
<p>ä¸Šä¸‹æ–‡çš„æ„é€ æ–¹æ³•ä¸­ä¼šå®ä¾‹åŒ– <code>AnnotatedBeanDefinitionReader</code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">AnnotationConfigServletWebServerApplicationContext</span><span class="hljs-params">()</span> {
    <span class="hljs-built_in">this</span>.reader = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AnnotatedBeanDefinitionReader</span>(<span class="hljs-built_in">this</span>);
    <span class="hljs-built_in">this</span>.scanner = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassPathBeanDefinitionScanner</span>(<span class="hljs-built_in">this</span>);
}
</code></pre>
<p>è€Œ <code>AnnotatedBeanDefinitionReader</code> çš„æ„é€ æ–¹æ³•ä¸­ä¼šæ³¨å†Œä¸€äº›å†…ç½®çš„æ³¨è§£åç½®å¤„ç†å™¨</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">AnnotatedBeanDefinitionReader</span><span class="hljs-params">(BeanDefinitionRegistry registry, Environment environment)</span> {
    <span class="hljs-comment">//...</span>
    AnnotationConfigUtils.registerAnnotationConfigProcessors(<span class="hljs-built_in">this</span>.registry);
}
</code></pre>
<p>è¿™äº›å¤„ç†å™¨ä¼šåœ¨ <code>Spring</code> å®¹å™¨åˆ·æ–°è¿‡ç¨‹ä¸­è°ƒç”¨ï¼Œé€šè¿‡åç§°æˆ‘ä»¬åŸºæœ¬ä¸Šèƒ½çŒœåˆ°å®ƒçš„ä½œç”¨ï¼Œè¿™éƒ¨åˆ†å±äº <code>Spring</code> çš„å†…å®¹ï¼Œåé¢ <code>Spring</code> æºç æ–‡ç« ä¼šè¯¦ç»†ä»‹ç»ã€‚</p>
<pre><code class="hljs language-java" lang="java">ConfigurationClassPostProcessor  å¤„ç†æ‰€æœ‰é…ç½®æ³¨è§£ <span class="hljs-meta">@Componentscan</span>ã€<span class="hljs-meta">@Import</span>ã€<span class="hljs-meta">@Bean</span>ã€<span class="hljs-meta">@Component</span> ç­‰
AutowiredAnnotationBeanPostProcessor  å¤„ç† <span class="hljs-meta">@Autowired</span>
CommonAnnotationBeanPostProcessor     å¤„ç† <span class="hljs-meta">@PostConstruct</span>ã€<span class="hljs-meta">@Resource</span> ç­‰
PersistenceAnnotationBeanPostProcessor(å¦‚æœç”¨äº† JPA)
EventListenerMethodProcessor    å¤„ç† <span class="hljs-meta">@EventListener</span>
DefaultEventListenerFactory
</code></pre>
<p>åˆ›å»ºå®Œæ¯•åä¼šæ‰§è¡Œä¸€ä¸ªå‡†å¤‡æ–¹æ³• <code>org.springframework.boot.SpringApplication#prepareContext</code>ï¼Œå°±æ˜¯ç»™ <code>AnnotationConfigServletWebServerApplicationContext</code> çš„æˆå‘˜å˜é‡åšä¸€äº›åˆå§‹åŒ–èµ‹å€¼ã€‚</p>
<ul>
<li>è®¾ç½® <code>environment </code></li>
<li>æ‰§è¡Œ <code>ApplicationContextInitializer</code></li>
<li>å‘å¸ƒä¸Šä¸‹æ–‡ å‡†å¤‡ã€åŠ è½½äº‹ä»¶</li>
<li>ç­‰ç­‰</li>
</ul>
<h3 data-id="heading-23">æ‰§è¡Œ ApplicationContextInitializer</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@FunctionalInterface</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ApplicationContextInitializer</span>&lt;C <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ConfigurableApplicationContext</span>&gt; {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">initialize</span><span class="hljs-params">(C applicationContext)</span>;
}
</code></pre>
<p>è¿™ä¸ªåˆå§‹åŒ–å™¨è¢«è°ƒç”¨çš„æ—¶æœºæ˜¯ <code>Spring</code> ä¸Šä¸‹æ–‡è¢«åˆ·æ–°ä¹‹å‰ï¼Œå¯¹å®¹å™¨ä¸Šä¸‹æ–‡è¿›è¡Œä¸€äº›å¤„ç†æ“ä½œï¼Œæ¯”å¦‚ï¼Œæ·»åŠ  <code>BeanFactoryPostProcessorã€BeanPostProcessor</code> ç­‰ç­‰ã€‚æˆ‘ä»¬ä»¥ <code>SpringBoot</code> å†…ç½®çš„ä¸€ä¸ªåˆå§‹åŒ–å™¨ <code>SharedMetadataReaderFactoryContextInitializer</code> ä¸ºä¾‹ã€‚</p>
<p>åœ¨è¿™ä¸ªåˆå§‹åŒ–å™¨çš„å›è°ƒæ–¹æ³• <code>initialize()</code> ä¸­ï¼Œå‘ <code>ApplicationContext</code> ä¸­æ·»åŠ äº†ä¸€ä¸ª <code>BeanFactoryPostProcessor</code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initialize</span><span class="hljs-params">(ConfigurableApplicationContext applicationContext)</span> {
    <span class="hljs-comment">//...</span>
    <span class="hljs-type">BeanFactoryPostProcessor</span> <span class="hljs-variable">postProcessor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CachingMetadataReaderFactoryPostProcessor</span>(applicationContext);
    applicationContext.addBeanFactoryPostProcessor(postProcessor);
}
</code></pre>
<p>è¿™ä¸ªåç½®å¤„ç†å™¨çš„ä½œç”¨æ˜¯å‘ <code>Spring</code> å®¹å™¨æ³¨å†Œä¸€ä¸ª <code>MetadataReaderFactory</code> çš„ <code>BeanDefinition</code>ã€‚å®ƒæ˜¯ä¸€ä¸ªç±»èµ„æºåŠ è½½çš„ç¼“å­˜ï¼Œ<code>Spring</code> å®¹å™¨å¯åŠ¨å’Œåˆ·æ–°è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šæœ‰å¤šä¸ªåœ°æ–¹éœ€è¦æ ¹æ® <code>className</code> åŠ è½½ç±»è·¯å¾„ä¸‹çš„èµ„æºï¼Œä¸ºäº†æé«˜æ•´ä½“æ€§èƒ½ï¼Œå·²åŠ è½½çš„èµ„æºå°†ä¼šè¢«ç¼“å­˜ã€‚å…·ä½“å®ç°ç±»æ˜¯ <code>ConcurrentReferenceCachingMetadataReaderFactory</code></p>
<h2 data-id="heading-24">åˆ·æ–° Spring å®¹å™¨</h2>
<p>è¿™éƒ¨åˆ†æ˜¯ <code>Spring</code> æµç¨‹çš„æ ¸å¿ƒæ–¹æ³•ã€‚</p>
<ul>
<li>è°ƒç”¨ <code>BeanFactoryBostProcessor</code></li>
<li>æ³¨å†Œ <code>BeanPostProcessor</code></li>
<li>æå‰æ³¨å†Œä¸€äº›ç³»ç»Ÿå†…ç½®å•ä¾‹ <code>Bean</code></li>
<li>åˆ›å»º <code>Web</code> æœåŠ¡å™¨</li>
<li>å®ä¾‹åŒ–æ‰€æœ‰éå»¶è¿ŸåŠ è½½çš„å•ä¾‹ <code>Bean</code></li>
<li>è°ƒç”¨ <code>BeanPostProcessor</code></li>
<li>è°ƒç”¨ <code>LifecycleProcessor</code></li>
</ul>
<p>è¿™é‡Œå±äº <code>Spring</code> å†…å®¹ï¼Œä¸è¿‡å¤šä»‹ç»ï¼Œæ¯ä¸€æ­¥é‡Œé¢éƒ½æœ‰ä¸€ç³»åˆ—å¤æ‚çš„é€»è¾‘ï¼Œè¿™é‡Œåªæä¸¤ä¸ªé‡ç‚¹ <code>SpringBoot è‡ªåŠ¨é…ç½®çš„æ ¸å¿ƒ</code> å’Œ <code>å†…åµŒ Web æœåŠ¡å™¨</code></p>
<h3 data-id="heading-25">SpringBoot è‡ªåŠ¨é…ç½®çš„æ ¸å¿ƒ</h3>
<p>è¿™æ˜¯ <code>SpringBoot</code> çš„é«˜é¢‘é¢è¯•é¢˜ï¼Œå¾ˆå¤šäººä¼šå›ç­”è¯´å› ä¸ºæœ‰å¾ˆå¤šå®šåˆ¶å¥½çš„ <code>starter</code>ï¼Œä¹Ÿæœ‰å›ç­”è¯´ <code>@EnableAutoConfiguration</code> å¯ç”¨çš„æ‰€æœ‰è‡ªåŠ¨é…ç½®ï¼Œå…¶å®å¹¶æ²¡æœ‰è¯´åˆ°æ ¸å¿ƒç‚¹ä¸Šã€‚å…¶æ ¸å¿ƒåŸç†å°±æ˜¯ <code>@SpringBootApplication</code> å†…éƒ¨çš„ç»„åˆæ³¨è§£ <code>@Import(AutoConfigurationImportSelector.class)</code>ã€‚</p>
<p>è¿™éœ€è¦ç”¨åˆ° <code>Spring</code> çš„é…ç½®ç±»è§£æåŸç†ï¼Œä¸Šä¸€æ®µåˆ›å»ºä¸Šä¸‹æ–‡ <code>ApplicationContext</code> çš„æ—¶å€™ï¼Œæ³¨å†Œäº†ä¸€ä¸ª <code>BeanFactoryPostProcessor â†’ ConfigurationClassPostProcessor</code> ã€‚åœ¨æ‰§è¡Œå…¶ä¸­ä¸€ä¸ªåç½®å¤„ç†æ–¹æ³• <code>postProcessBeanDefinitionRegistry()</code> æ—¶ï¼Œä¼šæ ¹æ® <code>SpringBoot</code> æä¾›çš„ä¸»ç±»ä¸ºèµ·ç‚¹ï¼Œå¾ªç¯é€’å½’çš„è§£æå„ç§é…ç½®æ³¨è§£ã€‚</p>
<ul>
<li><code>@ComponentScan</code></li>
<li><code>@Componentã€@Service @Configuration</code> ç­‰</li>
<li><code>@Import</code></li>
</ul>
<p>è¿™ä¸ª <code>@Import</code> æ³¨è§£è§£æå°±æ˜¯é‡ç‚¹ã€‚å¦‚æœå‘ç°å€¼æ˜¯ä¸€ä¸ª <code>ImportSelector</code> ç±»å‹ï¼Œè§£æçš„æ—¶å€™ä¼šæ‰§è¡Œ
<code>selectImports</code> æ–¹æ³•è·å–éœ€è¦å¯¼å…¥çš„é…ç½®ç±»ï¼Œ<code>AutoConfigurationImportSelector</code> æ˜¯ä¸€ä¸ªå»¶è¿Ÿå¯¼å…¥å™¨ï¼Œè·å–å¯¼å…¥ç±»çš„æ–¹å¼æ˜¯æ‰§è¡Œå†…éƒ¨ <code>Group</code> çš„ä¸¤ä¸ªæ–¹æ³•</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Group</span> {

    <span class="hljs-comment">/**
     * è·å–å¯¼å…¥ç±»é€»è¾‘
     */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">process</span><span class="hljs-params">(AnnotationMetadata metadata, DeferredImportSelector selector)</span>;

    <span class="hljs-comment">/**
     * è¿”å›å¯¼å…¥ç±»åˆ—è¡¨
     */</span>
    Iterable&lt;Entry&gt; <span class="hljs-title function_">selectImports</span><span class="hljs-params">()</span>;
</code></pre>
<p>æˆ‘ä»¬ä¸€è·¯å®šä½ä¸‹å»çœ‹çœ‹å¯¼å…¥çš„é…ç½®ç±»åˆ—è¡¨åˆ°åº•æ˜¯æ€ä¹ˆæ¥çš„ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ImportCandidates <span class="hljs-title function_">load</span><span class="hljs-params">(Class&lt;?&gt; annotation, ClassLoader classLoader)</span> {
    Assert.notNull(annotation, <span class="hljs-string">"'annotation' must not be null"</span>);
    <span class="hljs-type">ClassLoader</span> <span class="hljs-variable">classLoaderToUse</span> <span class="hljs-operator">=</span> decideClassloader(classLoader);
    <span class="hljs-type">String</span> <span class="hljs-variable">location</span> <span class="hljs-operator">=</span> String.format(LOCATION, annotation.getName());
    Enumeration&lt;URL&gt; urls = findUrlsInClasspath(classLoaderToUse, location);
    List&lt;String&gt; importCandidates = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-keyword">while</span> (urls.hasMoreElements()) {
       <span class="hljs-type">URL</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> urls.nextElement();
       importCandidates.addAll(readCandidateConfigurations(url));
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImportCandidates</span>(importCandidates);
}
</code></pre>
<p><code>LOCATION = "META-INF/spring/%s.imports"</code> æˆ‘ä»¬å‘ç°å®ƒåŠ è½½äº†è¿™ä¸ªè·¯å¾„ä¸‹çš„æ–‡ä»¶ï¼Œ<code>%s</code> æ˜¯å ä½ç¬¦ï¼Œç„¶åæˆ‘ä»¬å»è§‚å¯Ÿ <code>mybatisplusã€redisTemplate</code> ç­‰ç»„ä»¶çš„ <code>starter</code> ä¾èµ–åº“å°±ä¼šæ˜ç™½äº†</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e8e1106f48d14b7ba076dad1e2f99337~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pqu6Imy5aaW5aiG5Li2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1771060676&amp;x-signature=jhDNaRdvIAnuhqsb937OJyF24j8%3D" alt="df5d8555-167d-4dcd-890c-684d4f4e7062.png" loading="lazy"/></p>
<p>è¿™ä¸ªé…ç½®æ–‡ä»¶é‡Œé¢é…ç½®çš„ç±»ä¸Šéƒ½ä½¿ç”¨äº† <code>@Configuration</code> ã€‚<code>Spring</code> å…ˆæŠŠ <code>META-INF/spring/%s.imports</code> æ–‡ä»¶é‡Œé¢çš„ç±»åŠ è½½ä¸ºé…ç½®ç±»ï¼Œç„¶åå†é€’å½’è§£æè¿™äº›é…ç½®ç±»å†…éƒ¨çš„é…ç½®æ³¨è§£ <code>@Importã€@ComponentScanã€@Bean</code> ç­‰ç­‰</p>
<blockquote>
<p>å…³äº Spring é€’å½’è§£æé…ç½®ç±»çš„é€»è¾‘åç»­ Spring ç³»åˆ—æ–‡ç« ä¼šè¯¦ç»†è¯´æ˜</p>
</blockquote>
<h3 data-id="heading-26">å†…åµŒ Web æœåŠ¡å™¨</h3>
<p>è¿™ä¹Ÿæ˜¯ä¸€ä¸ªæ›¾ç»é«˜é¢‘é¢è¯•é¢˜ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¼ ç»Ÿçš„æ–¹å¼è¦å•ç‹¬èµ·ä¸€ä¸ª <code>Tomcat</code> æœåŠ¡ï¼Œè€Œ <code>SpringBoot</code> é€šè¿‡ä¸€ä¸ª <code>main</code> æ–¹æ³•å°±èƒ½æä¾› <code>Web</code> æœåŠ¡ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯å†…éƒ¨åˆ›å»ºäº†ä¸€ä¸ª <code>Web</code> æœåŠ¡å™¨ï¼Œæˆ‘ä»¬è‡ªå·±å®šä¹‰ä¸€ä¸ª <code>main</code> æ–¹æ³•ï¼Œå¦‚æœå†…éƒ¨åˆ›å»ºäº† <code>Web</code> æœåŠ¡å™¨ï¼Œé‚£æˆ‘ä»¬è¿™ä¸ªç¨‹åºä¹Ÿå¯ä»¥æä¾› <code>Web</code> æœåŠ¡ã€‚</p>
<p><code>SpringBoot3</code> æä¾›äº†ä¸‰ç§æ”¯æŒçš„ <code>Web</code> æœåŠ¡å™¨</p>
<ul>
<li><code>Tomcat</code></li>
<li><code>Undertow</code></li>
<li><code>Jetty</code></li>
</ul>
<p>é»˜è®¤æ˜¯ä½¿ç”¨ <code>Tomcat</code>ï¼Œå¯ä»¥æŸ¥çœ‹è‡ªåŠ¨é…ç½®ç±»</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration(proxyBeanMethods = false)</span>
<span class="hljs-meta">@ConditionalOnClass({ Servlet.class, Tomcat.class, UpgradeProtocol.class })</span>
<span class="hljs-meta">@ConditionalOnMissingBean(value = ServletWebServerFactory.class, search = SearchStrategy.CURRENT)</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmbeddedTomcat</span> {

    <span class="hljs-meta">@Bean</span>
    TomcatServletWebServerFactory <span class="hljs-title function_">tomcatServletWebServerFactory</span><span class="hljs-params">(
          ObjectProvider&lt;TomcatConnectorCustomizer&gt; connectorCustomizers,
          ObjectProvider&lt;TomcatContextCustomizer&gt; contextCustomizers,
          ObjectProvider&lt;TomcatProtocolHandlerCustomizer&lt;?&gt;&gt; protocolHandlerCustomizers)</span> {
       <span class="hljs-type">TomcatServletWebServerFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TomcatServletWebServerFactory</span>();
       factory.getTomcatConnectorCustomizers().addAll(connectorCustomizers.orderedStream().toList());
       factory.getTomcatContextCustomizers().addAll(contextCustomizers.orderedStream().toList());
       factory.getTomcatProtocolHandlerCustomizers().addAll(protocolHandlerCustomizers.orderedStream().toList());
       <span class="hljs-keyword">return</span> factory;
    }

}
</code></pre>
<p>åˆ›å»º <code>Web</code> æœåŠ¡å™¨çš„ä»£ç åœ¨ <code>org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext#onRefresh</code> æ–¹æ³•ä¸­</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onRefresh</span><span class="hljs-params">()</span> {
    <span class="hljs-built_in">super</span>.onRefresh();
    <span class="hljs-keyword">try</span> {
       createWebServer();
    }
    <span class="hljs-keyword">catch</span> (Throwable ex) {
       <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApplicationContextException</span>(<span class="hljs-string">"Unable to start web server"</span>, ex);
    }
}
</code></pre>
<p>è¿™é‡Œæ‰§è¡Œå®Œæ¯•ä¹‹åè¿˜ä¸èƒ½å¯¹å¤–æä¾›æœåŠ¡ï¼Œè¿˜éœ€è¦è°ƒç”¨ <code>org.springframework.boot.web.server.WebServer#start</code>ï¼Œè¿™ä¸€æ­¥è°ƒç”¨æ˜¯åœ¨åˆ·æ–° <code>Spring</code> å®¹å™¨çš„æœ€åä¸€æ­¥ï¼Œæ‰§è¡Œ <code>Lifecycle#start</code>ã€‚åç»­ <code>Spring</code> ç³»åˆ—ä¼šè¯¦ç»†è¯´æ˜ã€‚</p>
<h2 data-id="heading-27">è°ƒç”¨ Runner</h2>
<p><code>SpringBoot</code> æä¾›äº†ä¸€ä¸ª <code>Runner</code> æ¥å£ï¼Œè®©æˆ‘ä»¬å¯ä»¥åœ¨é¡¹ç›®å®Œå…¨å¯åŠ¨åï¼Œä¹Ÿå°±æ˜¯ <code>Spring</code> å®¹å™¨å·²ç»åˆ·æ–°å®Œæˆï¼Œä¸‡äº‹å°±ç»ªä¹‹ååšä¸€äº›äº‹æƒ…ã€‚å®ƒæœ‰ä¸¤ä¸ªå­æ¥å£</p>
<ul>
<li><code>CommandLineRunner</code></li>
<li><code>ApplicationRunner</code></li>
</ul>
<p>ä¸¤è€…åŠŸèƒ½å¾ˆåƒï¼Œéƒ½æ˜¯åº”ç”¨å¯¹å¤–æä¾›æµé‡ä¹‹å‰ï¼ˆç†è®ºä¸Šï¼‰åšä¸€äº›äº‹æƒ…ã€‚åŒºåˆ«ç‚¹æ˜¯æ–¹æ³•å…¥å‚ä¸åŒ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestRunner</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ApplicationRunner</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">(ApplicationArguments args)</span> <span class="hljs-keyword">throws</span> Exception {
        System.out.println(args);
    }
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestRunner2</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">CommandLineRunner</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">(String... args)</span> <span class="hljs-keyword">throws</span> Exception {
        System.out.println(<span class="hljs-string">"TestRunner2 running..."</span>);
    }
}
</code></pre>
<p><code>ApplicationRunner</code> çš„å…¥å‚æ˜¯è¢« <code>SpringBoot</code> å¤„ç†è¿‡çš„ï¼Œæä¾›äº†ä¸€äº› <code>API</code> æ¥åˆ†åˆ«è·å–é€‰é¡¹å‚æ•°å’Œéé€‰é¡¹å‚æ•°ã€‚</p>
<blockquote>
<p>å…³äºé€‰é¡¹å‚æ•°å’Œéé€‰é¡¹å‚æ•°å¯ä»¥å‚è€ƒè¿™ä¸ªç±» <code>org.springframework.core.env.SimpleCommandLineArgsParser</code> çš„æ³¨é‡Šï¼Œè§„èŒƒå†™çš„å¾ˆæ¸…æ¥š</p>
</blockquote>
<h3 data-id="heading-28">AvailabilityChangeEvent</h3>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>Runner</code> è°ƒç”¨å®Œæ¯•ä¹‹åä¼šæ‰§è¡Œ <code>EventPublishingRunListener#ready</code> ï¼Œåœ¨æ­¤ä¹‹å‰å®¹å™¨åˆ·æ–°å®Œæ¯•è¿˜ä¼šè°ƒç”¨ <code>EventPublishingRunListener#started</code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">started</span><span class="hljs-params">(ConfigurableApplicationContext context, Duration timeTaken)</span> {
    context.publishEvent(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ApplicationStartedEvent</span>(<span class="hljs-built_in">this</span>.application, <span class="hljs-built_in">this</span>.args, context, timeTaken));
    AvailabilityChangeEvent.publish(context, LivenessState.CORRECT);
}

<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">ready</span><span class="hljs-params">(ConfigurableApplicationContext context, Duration timeTaken)</span> {
    context.publishEvent(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ApplicationReadyEvent</span>(<span class="hljs-built_in">this</span>.application, <span class="hljs-built_in">this</span>.args, context, timeTaken));
    AvailabilityChangeEvent.publish(context, ReadinessState.ACCEPTING_TRAFFIC);
}
</code></pre>
<p>å…ˆå‘å¸ƒäº†ä¸€ä¸ª <code>ready</code> äº‹ä»¶ï¼Œç„¶åä¸‹ä¸€æ­¥æˆ‘ä»¬ç‚¹å‡»è¿›å»å‘ç°åˆå‘å¸ƒäº†ä¸€ä¸ªäº‹ä»¶ï¼Œæ‰¾åˆ°å¯¹åº”çš„ç›‘å¬å™¨
<code>org.springframework.boot.availability.ApplicationAvailabilityBean</code> ï¼Œ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onApplicationEvent</span><span class="hljs-params">(AvailabilityChangeEvent&lt;?&gt; event)</span> {
    Class&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AvailabilityState</span>&gt; type = getStateType(event.getState());
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.logger.isDebugEnabled()) {
       <span class="hljs-built_in">this</span>.logger.debug(getLogMessage(type, event));
    }
    <span class="hljs-built_in">this</span>.events.put(type, event);
}
</code></pre>
<p>å…¶ç›‘å¬æ–¹æ³•å¾ˆç®€å•ï¼Œå°±æ˜¯å‘ä¸€ä¸ª <code>Map</code> ä¸­è®¾ç½®äº†å­˜æ´»æ ‡è®°å’Œå°±ç»ªæ ‡è®°ã€‚æˆ‘ä»¬æŸ¥çœ‹å°±ç»ªæ ‡è®° <code>org.springframework.boot.availability.ReadinessState</code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">ReadinessState</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AvailabilityState</span> {

    <span class="hljs-comment">/**
     * The application is ready to receive traffic.
     */</span>
    ACCEPTING_TRAFFIC,

    <span class="hljs-comment">/**
     * The application is not willing to receive traffic.
     */</span>
    REFUSING_TRAFFIC

}
</code></pre>
<p><code>ACCEPTING_TRAFFIC</code> çš„æ³¨é‡Šæ˜¯åº”ç”¨ç¨‹åºå‡†å¤‡æ¥å—æµé‡ï¼Œç¬¬ä¸€æ¬¡çœ‹åˆ°çš„æ—¶å€™æˆ‘è¿˜ä»¥ä¸º <code>SpringBoot</code> å†…éƒ¨ç”¨äº†ä»€ä¹ˆç¥ç§˜æœºåˆ¶ï¼Œæ§åˆ¶äº†å¿…é¡»æ‰§è¡Œå®Œæ¯• <code>Runner</code> æ¥å£åæ‰ä¼šè®©å†…åµŒçš„ <code>Tomcat</code> å¯¹å¤–æä¾› <code>web</code> æœåŠ¡ã€‚è€Œæˆ‘æµ‹è¯•ä¹‹åå‘ç°å¹¶ä¸æ˜¯</p>
<p><strong>è°ƒç”¨å®Œ <code>org.springframework.boot.web.embedded.tomcat.TomcatWebServer#start</code> æ–¹æ³•æ—¶å€™ï¼Œç¨‹åºå°±å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡äº†ã€‚</strong></p>
<p>åæ¥æŸ¥äº†å®˜ç½‘ä¹‹åå‘ç°ï¼Œè¿™ä¸ªæ ‡è®°æ˜¯ç»™ç±»ä¼¼ <code>K8S</code> è¿™ç§è¿ç»´å·¥å…·ç”¨çš„ã€‚å®ƒæ¨èæˆ‘ä»¬åœ¨å°±ç»ªæ ‡è®°ä¸º <code>ACCEPTING_TRAFFIC</code> ä¹‹åï¼Œå†å¯¹å¤–æä¾›æœåŠ¡ï¼Œå¤„ç†æµé‡ã€‚</p>
<h2 data-id="heading-29">å†è°ˆ SpringBoot</h2>
<p>ç°åœ¨æˆ‘ä»¬å†å›å¤´æ€è€ƒï¼Œ<code>SpringBoot</code> æ‰€æœ‰çš„åŠŸèƒ½éƒ½æ˜¯åŸºäº <code>Spring</code> æ ¸å¿ƒåŸç†è¿›è¡Œæ‰©å±•</p>
<ul>
<li>è‡ªåŠ¨é…ç½® <code>XxxAutoConfiguration</code> åŸºäº <code>Spring</code> çš„ <code>@Import</code> æ³¨è§£</li>
<li><code>ConditionalOnMissingBean</code> ç­‰ä¸€ç³»åˆ—æ¡ä»¶æ³¨è§£ï¼ŒåŸºäº <code>Spring</code> çš„ <code>@Conditional</code></li>
<li><code>@ConfigurationProperties</code> é…ç½®å±æ€§ç»‘å®šï¼ŒåŸºäº <code>Spring</code> çš„ç±»å‹è½¬æ¢å™¨ <code>org.springframework.core.convert.converter.Converter</code></li>
<li>å†…åµŒ <code>Web</code> å®¹å™¨ï¼ŒåŸºäºé‡å†™ <code>AbstractApplicationContext.onRefresh()</code></li>
<li>ç­‰ç­‰</li>
</ul>
<p>æ‰€ä»¥æˆ‘ä»¬æ‰ä¼šè¯´ï¼Œå®ƒä¸èƒ½ç®—æ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œè€Œæ˜¯ä¸€ä¸ª <code>Spring</code> é¡¹ç›®çš„å¿«é€Ÿé›†æˆè„šæ‰‹æ¶</p>
<h2 data-id="heading-30">ç»“è¯­</h2>
<p>ç”±äºç¯‡å¹…é—®é¢˜ï¼Œå¾ˆå¤šä¸œè¥¿æ²¡æ³•ç»†èŠ‚çš„å»å±•å¼€è¯´ï¼Œæ¯•ç«Ÿ <code>Spring</code> ç›¸å…³çŸ¥è¯†å¤ªå¤šäº†ï¼Œè€Œä¸”ç¯ç¯ç›¸æ‰£ï¼Œè¿™é‡Œåšä¸»ä¹Ÿæ˜¯åœ¨å‡†å¤‡é¢è¯•æ‰€ä»¥æœ€è¿‘ä¼šæŠŠ <code>Spring</code> ç³»åˆ—çš„æ–‡ç« å…¨éƒ¨å†™å®Œï¼ŒåŒ…æ‹¬ä½†ä¸é™äº</p>
<ul>
<li><strong>BeanFactoryPostProcessor</strong></li>
<li><strong>BeanPostProcessor</strong></li>
<li><strong>Bean çš„ç”Ÿå‘½å‘¨æœŸ</strong></li>
<li><strong>Spring AOP åŸç†</strong></li>
<li><strong>Spring äº‹åŠ¡åŸç†</strong></li>
<li><strong>ç­‰ç­‰</strong></li>
</ul>
<h3 data-id="heading-31">å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè®°å¾—ç‚¹èµåŠ å…³æ³¨ï¼ä½ çš„æ”¯æŒå°±æ˜¯æˆ‘ç»§ç»­åˆ›ä½œçš„åŠ¨åŠ›ï¼</h3></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Requestsåº“å…¥é—¨æŒ‡å—]]></title>    <link>https://juejin.cn/post/7603282168137842707</link>    <guid>https://juejin.cn/post/7603282168137842707</guid>    <pubDate>2026-02-06T05:15:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603282168137842707" data-draft-id="7603352061505650694" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Requestsåº“å…¥é—¨æŒ‡å—"/> <meta itemprop="keywords" content="åç«¯,Python"/> <meta itemprop="datePublished" content="2026-02-06T05:15:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å°å¼ è¯´æ•…äº‹"/> <meta itemprop="url" content="https://juejin.cn/user/741501567509111"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Requestsåº“å…¥é—¨æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/741501567509111/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å°å¼ è¯´æ•…äº‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T05:15:00.000Z" title="Fri Feb 06 2026 05:15:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. åº“çš„æ¦‚è§ˆä¸æ ¸å¿ƒä»·å€¼</h2>
<p>æƒ³è±¡ä¸€ä¸‹,åœ¨ç½‘ç»œä¸–ç•Œä¸­,å¦‚æœä½ æƒ³ä¸å„ç§ç½‘ç«™å’ŒæœåŠ¡è¿›è¡Œé€šä¿¡,å°±åƒæ˜¯ç”¨ä¼ ç»Ÿçš„ä¿¡ä»¶å¾€æ¥ã€‚ä½ éœ€è¦æ‰‹åŠ¨æ‰“åŒ…æ•°æ®ã€ç¼–å†™åœ°å€ã€å¤„ç†å›å¤ç¼–ç ,è¿™äº›ç¹ççš„ç»†èŠ‚ä¼šè®©ç®€å•çš„ä»»åŠ¡å˜å¾—å¤æ‚ã€‚<code>requests</code>åº“æ­£æ˜¯ä¸ºè§£å†³è¿™äº›é—®é¢˜è€Œç”Ÿçš„å·¥å…·ã€‚</p>
<p>Requestsæ˜¯Pythonä¸­æœ€æµè¡Œçš„HTTPå®¢æˆ·ç«¯åº“,å®ƒçš„è®¾è®¡å“²å­¦æ˜¯"ä¸ºäººç±»è®¾è®¡"ã€‚å®ƒå°†å¤æ‚çš„HTTPåè®®ç»†èŠ‚å°è£…åœ¨ç®€æ´çš„APIä¹‹ä¸‹,è®©å¼€å‘è€…èƒ½å¤Ÿç”¨æœ€å°‘çš„ä»£ç å®Œæˆç½‘ç»œè¯·æ±‚ã€‚ä¸Pythonæ ‡å‡†åº“ä¸­çš„<code>urllib</code>ç›¸æ¯”,Requestsçš„ä½¿ç”¨ä½“éªŒæå‡äº†90%ä»¥ä¸Šâ€”â€”ä½ ä¸å†éœ€è¦æ‰‹åŠ¨å¤„ç†URLç¼–ç ã€è¡¨å•æ•°æ®åºåˆ—åŒ–ã€è¿æ¥æ± ç®¡ç†ç­‰åº•å±‚ç»†èŠ‚ã€‚</p>
<p>Requestsåœ¨Pythonç”Ÿæ€ç³»ç»Ÿä¸­å æ®ç€ä¸å¯æˆ–ç¼ºçš„åœ°ä½ã€‚æ®PyPIå®˜æ–¹ç»Ÿè®¡,å®ƒçš„ä¸‹è½½é‡æ¯æœˆè¶…è¿‡10äº¿æ¬¡,è¶…è¿‡50ä¸‡ä¸ªå¼€æºé¡¹ç›®ä¾èµ–å®ƒã€‚æ— è®ºæ˜¯è°ƒç”¨REST APIã€æ„å»ºç½‘ç»œçˆ¬è™«ã€è‡ªåŠ¨åŒ–æµ‹è¯•,è¿˜æ˜¯å¼€å‘å¾®æœåŠ¡å®¢æˆ·ç«¯,Requestséƒ½æ˜¯é¦–é€‰å·¥å…·ã€‚å®ƒæ”¯æŒHTTP/1.1çš„æ‰€æœ‰ç‰¹æ€§,åŒ…æ‹¬è¿æ¥æ± ç®¡ç†ã€CookieæŒä¹…åŒ–ã€SSLéªŒè¯ã€è‡ªåŠ¨å†…å®¹è§£ç ç­‰,è®©HTTPè¯·æ±‚å˜å¾—å‰æ‰€æœªæœ‰çš„ç®€å•ã€‚</p>
<h2 data-id="heading-1">2. ç¯å¢ƒæ­å»ºä¸"Hello, World"</h2>
<h3 data-id="heading-2">å®‰è£…è¯´æ˜</h3>
<p>Requestsä¸æ˜¯Pythonæ ‡å‡†åº“çš„ä¸€éƒ¨åˆ†,éœ€è¦é€šè¿‡åŒ…ç®¡ç†å™¨å®‰è£…:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨pipå®‰è£…(æ¨è)</span>
pip install requests

<span class="hljs-comment"># ä½¿ç”¨condaå®‰è£…</span>
conda install requests

<span class="hljs-comment"># ä½¿ç”¨Pythonæ¨¡å—æ–¹å¼å®‰è£…</span>
python -m pip install requests
</code></pre>
<p>Requestså®˜æ–¹æ”¯æŒPython 3.9+ç‰ˆæœ¬,åŒæ—¶ä¹Ÿå…¼å®¹PyPyè§£é‡Šå™¨ã€‚å¦‚æœåœ¨å®‰è£…è¿‡ç¨‹ä¸­é‡åˆ°æƒé™é—®é¢˜,å¯ä»¥å°è¯•ä½¿ç”¨<code>--user</code>å‚æ•°æˆ–åˆ›å»ºè™šæ‹Ÿç¯å¢ƒã€‚</p>
<h3 data-id="heading-3">æœ€ç®€ç¤ºä¾‹</h3>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„"Hello, World"ç¤ºä¾‹,å±•ç¤ºå¦‚ä½•å‘é€GETè¯·æ±‚å¹¶è·å–å“åº”:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests

<span class="hljs-comment"># å‘é€GETè¯·æ±‚åˆ°GitHub API</span>
response = requests.get(<span class="hljs-string">'https://api.github.com/events'</span>)

<span class="hljs-comment"># æ‰“å°å“åº”çŠ¶æ€ç </span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"çŠ¶æ€ç : <span class="hljs-subst">{response.status_code}</span>"</span>)

<span class="hljs-comment"># æ‰“å°å“åº”å†…å®¹çš„å‰100ä¸ªå­—ç¬¦</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å“åº”å†…å®¹: <span class="hljs-subst">{response.text[:<span class="hljs-number">100</span>]}</span>"</span>)
</code></pre>
<h3 data-id="heading-4">é€è¡Œè§£é‡Š</h3>
<ol>
<li><code>import requests</code> - å¯¼å…¥Requestsåº“,ä½¿å…¶åŠŸèƒ½åœ¨å½“å‰è„šæœ¬ä¸­å¯ç”¨ã€‚</li>
<li><code>response = requests.get('https://api.github.com/events')</code> - è°ƒç”¨<code>get()</code>æ–¹æ³•å‘GitHub APIå‘é€GETè¯·æ±‚,è¿”å›çš„<code>Response</code>å¯¹è±¡åŒ…å«äº†æœåŠ¡å™¨çš„å…¨éƒ¨å“åº”ä¿¡æ¯ã€‚</li>
<li><code>print(f"çŠ¶æ€ç : {response.status_code}")</code> - è®¿é—®<code>Response</code>å¯¹è±¡çš„<code>status_code</code>å±æ€§,è·å–HTTPçŠ¶æ€ç (200è¡¨ç¤ºæˆåŠŸ)ã€‚</li>
<li><code>print(f"å“åº”å†…å®¹: {response.text[:100]}")</code> - é€šè¿‡<code>text</code>å±æ€§è·å–å“åº”çš„æ–‡æœ¬å†…å®¹,å¹¶åˆ‡ç‰‡æ˜¾ç¤ºå‰100ä¸ªå­—ç¬¦ã€‚</li>
</ol>
<h3 data-id="heading-5">è¿è¡Œç»“æœ</h3>
<p>ç¨‹åºè¿è¡Œåä¼šè¾“å‡ºç±»ä¼¼ä»¥ä¸‹å†…å®¹:</p>
<pre><code class="hljs language-json" lang="json">çŠ¶æ€ç <span class="hljs-punctuation">:</span> <span class="hljs-number">200</span>
å“åº”å†…å®¹<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"25698765432"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"PushEvent"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"actor"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span><span class="hljs-number">12345678</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"login"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"userna
</span></code></pre>
<p>è¿™ä¸ªç®€å•çš„ä¾‹å­å±•ç¤ºäº†Requestsçš„æ ¸å¿ƒä¼˜åŠ¿:ç”¨ä¸‰è¡Œä»£ç å°±å®Œæˆäº†ä¸€æ¬¡å®Œæ•´çš„HTTPè¯·æ±‚,è‡ªåŠ¨å¤„ç†äº†è¿æ¥å»ºç«‹ã€æ•°æ®ä¼ è¾“ã€å“åº”è§£ç ç­‰æ‰€æœ‰ç»†èŠ‚ã€‚</p>
<h2 data-id="heading-6">3. æ ¸å¿ƒæ¦‚å¿µè§£æ</h2>
<p>Requestsåº“å›´ç»•å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µæ„å»º,ç†è§£è¿™äº›æ¦‚å¿µæœ‰åŠ©äºä½ æ›´çµæ´»åœ°ä½¿ç”¨å®ƒã€‚</p>
<h3 data-id="heading-7">3.1 è¯·æ±‚æ–¹æ³•(Request Methods)</h3>
<p>HTTPåè®®å®šä¹‰äº†å¤šç§è¯·æ±‚æ–¹æ³•,Requestsä¸ºæ¯ç§æ–¹æ³•éƒ½æä¾›äº†å¯¹åº”çš„å‡½æ•°:</p>
<ul>
<li><code>requests.get()</code> - è·å–èµ„æº</li>
<li><code>requests.post()</code> - æäº¤æ•°æ®</li>
<li><code>requests.put()</code> - æ›´æ–°èµ„æº(å®Œæ•´æ›¿æ¢)</li>
<li><code>requests.patch()</code> - æ›´æ–°èµ„æº(éƒ¨åˆ†ä¿®æ”¹)</li>
<li><code>requests.delete()</code> - åˆ é™¤èµ„æº</li>
<li><code>requests.head()</code> - è·å–å“åº”å¤´</li>
<li><code>requests.options()</code> - è·å–æœåŠ¡å™¨æ”¯æŒçš„æ–¹æ³•</li>
</ul>
<h3 data-id="heading-8">3.2 å“åº”å¯¹è±¡(Response Object)</h3>
<p>æ¯æ¬¡è¯·æ±‚å,Requestséƒ½ä¼šè¿”å›ä¸€ä¸ª<code>Response</code>å¯¹è±¡,å®ƒåŒ…å«äº†æœåŠ¡å™¨çš„å®Œæ•´å“åº”ä¿¡æ¯:</p>
<ul>
<li><code>response.status_code</code> - HTTPçŠ¶æ€ç </li>
<li><code>response.text</code> - å“åº”çš„æ–‡æœ¬å†…å®¹(è‡ªåŠ¨è§£ç )</li>
<li><code>response.content</code> - å“åº”çš„å­—èŠ‚å†…å®¹(åŸå§‹äºŒè¿›åˆ¶)</li>
<li><code>response.json()</code> - å°†JSONå“åº”è§£æä¸ºPythonå­—å…¸</li>
<li><code>response.headers</code> - å“åº”å¤´ä¿¡æ¯(å­—å…¸å½¢å¼)</li>
<li><code>response.cookies</code> - æœåŠ¡å™¨è®¾ç½®çš„Cookie</li>
</ul>
<h3 data-id="heading-9">3.3 ä¼šè¯å¯¹è±¡(Session Object)</h3>
<p><code>Session</code>å¯¹è±¡å…è®¸ä½ åœ¨å¤šä¸ªè¯·æ±‚ä¹‹é—´ä¿æŒæŸäº›å‚æ•°(å¦‚Cookiesã€è®¤è¯ä¿¡æ¯),å¹¶å¤ç”¨TCPè¿æ¥,æ˜¾è‘—æé«˜æ€§èƒ½:</p>
<pre><code class="hljs language-python" lang="python">session = requests.Session()
session.headers.update({<span class="hljs-string">'User-Agent'</span>: <span class="hljs-string">'My App'</span>})

<span class="hljs-comment"># ç¬¬ä¸€ä¸ªè¯·æ±‚ä¼šä¿å­˜Cookies</span>
response1 = session.get(<span class="hljs-string">'https://httpbin.org/cookies/set/sessionid/123'</span>)

<span class="hljs-comment"># ç¬¬äºŒä¸ªè¯·æ±‚ä¼šè‡ªåŠ¨æºå¸¦ä¹‹å‰ä¿å­˜çš„Cookies</span>
response2 = session.get(<span class="hljs-string">'https://httpbin.org/cookies'</span>)
</code></pre>
<h3 data-id="heading-10">æ¦‚å¿µå…³ç³»å›¾</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[requestsåº“] --&gt; B[è¯·æ±‚æ–¹æ³•]
    A --&gt; C[å“åº”å¯¹è±¡]
    A --&gt; D[ä¼šè¯å¯¹è±¡]
    
    B --&gt; B1[get/post/put/deleteç­‰]
    B --&gt; B2[å‚æ•°ä¼ é€’: params/data/json]
    
    C --&gt; C1[status_code - çŠ¶æ€ç ]
    C --&gt; C2[text/content/json - å“åº”å†…å®¹]
    C --&gt; C3[headers/cookies - å…ƒä¿¡æ¯]
    
    D --&gt; D1[ä¿æŒCookieå’Œè®¤è¯ä¿¡æ¯]
    D --&gt; D2[å¤ç”¨TCPè¿æ¥]
    D --&gt; D3[æé«˜è¯·æ±‚æ€§èƒ½]
    
    B1 --&gt; C
    B2 --&gt; C
    D --&gt; B
</code></pre>
<p>è¿™ä¸ªå›¾è¡¨å±•ç¤ºäº†Requestsåº“çš„æ ¸å¿ƒæ¦‚å¿µåŠå…¶å…³ç³»:è¯·æ±‚æ–¹æ³•ç”¨äºå‘é€è¯·æ±‚,å“åº”å¯¹è±¡ç”¨äºæ¥æ”¶å’Œå¤„ç†æœåŠ¡å™¨çš„å›åº”,è€Œä¼šè¯å¯¹è±¡åˆ™åœ¨å¤šä¸ªè¯·æ±‚ä¹‹é—´æä¾›çŠ¶æ€ä¿æŒå’Œè¿æ¥å¤ç”¨ã€‚</p>
<h2 data-id="heading-11">4. å®æˆ˜æ¼”ç»ƒ:è§£å†³ä¸€ä¸ªå…¸å‹é—®é¢˜</h2>
<h3 data-id="heading-12">éœ€æ±‚åˆ†æ</h3>
<p>å‡è®¾æˆ‘ä»¬éœ€è¦å¼€å‘ä¸€ä¸ªå¤©æ°”æŸ¥è¯¢åº”ç”¨,èƒ½å¤Ÿè·å–æŒ‡å®šåŸå¸‚çš„å½“å‰å¤©æ°”ä¿¡æ¯ã€‚æˆ‘ä»¬å°†ä½¿ç”¨å…è´¹çš„å¤©æ°”API,é€šè¿‡å‘é€HTTPè¯·æ±‚æ¥è·å–æ•°æ®,å¹¶è§£æè¿”å›çš„JSONå“åº”ã€‚</p>
<h3 data-id="heading-13">æ–¹æ¡ˆè®¾è®¡</h3>
<p>è¿™ä¸ªé¡¹ç›®å°†å±•ç¤ºRequestsåº“çš„å‡ ä¸ªæ ¸å¿ƒåŠŸèƒ½:</p>
<ol>
<li>ä½¿ç”¨<code>requests.get()</code>å‘é€å¸¦å‚æ•°çš„GETè¯·æ±‚</li>
<li>é€šè¿‡<code>params</code>å‚æ•°ä¼ é€’æŸ¥è¯¢å‚æ•°(åŸå¸‚åç§°)</li>
<li>ä½¿ç”¨<code>response.json()</code>è§£æJSONå“åº”</li>
<li>å®ç°é”™è¯¯å¤„ç†å’Œå¼‚å¸¸æ•è·</li>
<li>å±•ç¤ºå“åº”æ•°æ®çš„æå–å’Œæ ¼å¼åŒ–</li>
</ol>
<h3 data-id="heading-14">ä»£ç å®ç°</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">from</span> requests.exceptions <span class="hljs-keyword">import</span> RequestException

<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_weather</span>(<span class="hljs-params">city</span>):
    <span class="hljs-string">"""
    è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯
    
    Args:
        city (str): åŸå¸‚åç§°,ä¾‹å¦‚"Beijing"æˆ–"Shanghai"
    
    Returns:
        dict: åŒ…å«å¤©æ°”ä¿¡æ¯çš„å­—å…¸,å¤±è´¥æ—¶è¿”å›None
    """</span>
    <span class="hljs-comment"># ä½¿ç”¨å…è´¹çš„å¤©æ°”API(ç¤ºä¾‹ä½¿ç”¨httpbin.orgæ¨¡æ‹Ÿ)</span>
    base_url = <span class="hljs-string">"https://httpbin.org/get"</span>
    params = {
        <span class="hljs-string">'city'</span>: city,
        <span class="hljs-string">'units'</span>: <span class="hljs-string">'metric'</span>
    }
    
    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># å‘é€GETè¯·æ±‚,è®¾ç½®è¶…æ—¶æ—¶é—´ä¸º5ç§’</span>
        response = requests.get(base_url, params=params, timeout=<span class="hljs-number">5</span>)
        
        <span class="hljs-comment"># æ£€æŸ¥å“åº”çŠ¶æ€ç ,å¦‚æœä¸æ˜¯2xxåˆ™æŠ›å‡ºå¼‚å¸¸</span>
        response.raise_for_status()
        
        <span class="hljs-comment"># è§£æJSONå“åº”</span>
        data = response.json()
        
        <span class="hljs-comment"># æå–å¤©æ°”ä¿¡æ¯(è¿™é‡Œæ¨¡æ‹ŸçœŸå®APIçš„æ•°æ®ç»“æ„)</span>
        weather_info = {
            <span class="hljs-string">'city'</span>: data.get(<span class="hljs-string">'args'</span>, {}).get(<span class="hljs-string">'city'</span>, city),
            <span class="hljs-string">'temperature'</span>: <span class="hljs-number">25</span>,  <span class="hljs-comment"># æ¨¡æ‹Ÿæ•°æ®</span>
            <span class="hljs-string">'condition'</span>: <span class="hljs-string">'æ™´æœ—'</span>,
            <span class="hljs-string">'humidity'</span>: <span class="hljs-number">45</span>,
            <span class="hljs-string">'wind_speed'</span>: <span class="hljs-number">3.2</span>
        }
        
        <span class="hljs-keyword">return</span> weather_info
        
    <span class="hljs-keyword">except</span> requests.exceptions.Timeout:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"é”™è¯¯: è¯·æ±‚è¶…æ—¶,æ— æ³•è·å–<span class="hljs-subst">{city}</span>çš„å¤©æ°”ä¿¡æ¯"</span>)
    <span class="hljs-keyword">except</span> requests.exceptions.HTTPError <span class="hljs-keyword">as</span> err:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"HTTPé”™è¯¯: <span class="hljs-subst">{err.response.status_code}</span>"</span>)
    <span class="hljs-keyword">except</span> requests.exceptions.RequestException <span class="hljs-keyword">as</span> err:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è¯·æ±‚å‡ºé”™: <span class="hljs-subst">{err}</span>"</span>)
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    <span class="hljs-string">"""ä¸»å‡½æ•°:è·å–å¹¶æ˜¾ç¤ºå¤šä¸ªåŸå¸‚çš„å¤©æ°”"""</span>
    cities = [<span class="hljs-string">'Beijing'</span>, <span class="hljs-string">'Shanghai'</span>, <span class="hljs-string">'Guangzhou'</span>]
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"=== å¤©æ°”æŸ¥è¯¢ç³»ç»Ÿ ===\n"</span>)
    
    <span class="hljs-keyword">for</span> city <span class="hljs-keyword">in</span> cities:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ­£åœ¨æŸ¥è¯¢ <span class="hljs-subst">{city}</span> çš„å¤©æ°”..."</span>)
        weather = get_weather(city)
        
        <span class="hljs-keyword">if</span> weather:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\n<span class="hljs-subst">{weather[<span class="hljs-string">'city'</span>]}</span> å¤©æ°”ä¿¡æ¯:"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  æ¸©åº¦: <span class="hljs-subst">{weather[<span class="hljs-string">'temperature'</span>]}</span>Â°C"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  å¤©æ°”: <span class="hljs-subst">{weather[<span class="hljs-string">'condition'</span>]}</span>"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  æ¹¿åº¦: <span class="hljs-subst">{weather[<span class="hljs-string">'humidity'</span>]}</span>%"</span>)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  é£é€Ÿ: <span class="hljs-subst">{weather[<span class="hljs-string">'wind_speed'</span>]}</span> m/s"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"-"</span> * <span class="hljs-number">40</span>)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    main()
</code></pre>
<h3 data-id="heading-15">è¿è¡Œè¯´æ˜</h3>
<ol>
<li>ç¡®ä¿å·²å®‰è£…Requestsåº“: <code>pip install requests</code></li>
<li>å°†ä»£ç ä¿å­˜ä¸º<code>weather_app.py</code></li>
<li>è¿è¡Œç¨‹åº: <code>python weather_app.py</code></li>
</ol>
<p>ç¨‹åºä¼šä¾æ¬¡æŸ¥è¯¢ä¸‰ä¸ªåŸå¸‚çš„å¤©æ°”ä¿¡æ¯,å¹¶æ ¼å¼åŒ–è¾“å‡ºç»“æœã€‚è™½ç„¶ç¤ºä¾‹ä½¿ç”¨äº†httpbin.orgæ¨¡æ‹Ÿæ•°æ®,ä½†ä»£ç ç»“æ„å¯ä»¥ç›´æ¥é€‚é…çœŸå®çš„å¤©æ°”API(å¦‚OpenWeatherMapã€å’Œé£å¤©æ°”ç­‰),åªéœ€ä¿®æ”¹<code>base_url</code>å’Œæ•°æ®æå–é€»è¾‘å³å¯ã€‚</p>
<h3 data-id="heading-16">å…³é”®ç‚¹è§£æ</h3>
<ul>
<li><strong>å‚æ•°ä¼ é€’</strong>: ä½¿ç”¨<code>params</code>å­—å…¸ä¼ é€’æŸ¥è¯¢å‚æ•°,Requestsä¼šè‡ªåŠ¨è¿›è¡ŒURLç¼–ç </li>
<li><strong>è¶…æ—¶è®¾ç½®</strong>: <code>timeout=5</code>å‚æ•°é˜²æ­¢è¯·æ±‚æ— é™æœŸç­‰å¾…</li>
<li><strong>é”™è¯¯å¤„ç†</strong>: ä½¿ç”¨<code>raise_for_status()</code>è‡ªåŠ¨æ£€æŸ¥çŠ¶æ€ç ,å¹¶æ•è·å„ç±»å¼‚å¸¸</li>
<li><strong>JSONè§£æ</strong>: <code>response.json()</code>å°†JSONå“åº”ç›´æ¥è½¬æ¢ä¸ºPythonå­—å…¸</li>
<li><strong>æ¨¡å—åŒ–è®¾è®¡</strong>: å°†æ ¸å¿ƒåŠŸèƒ½å°è£…ä¸ºå‡½æ•°,ä¾¿äºå¤ç”¨å’Œæµ‹è¯•</li>
</ul>
<h2 data-id="heading-17">5. æœ€ä½³å®è·µä¸å¸¸è§é™·é˜±</h2>
<h3 data-id="heading-18">å¸¸è§é”™è¯¯åŠè§„é¿æ–¹æ³•</h3>
<h4 data-id="heading-19">é”™è¯¯1:ä¸æ£€æŸ¥çŠ¶æ€ç </h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># âŒ é”™è¯¯åšæ³•</span>
response = requests.get(<span class="hljs-string">'https://api.example.com/data'</span>)
data = response.json()  <span class="hljs-comment"># å¦‚æœçŠ¶æ€ç ä¸æ˜¯200,è¿™é‡Œå¯èƒ½æŠ›å‡ºå¼‚å¸¸</span>

<span class="hljs-comment"># âœ… æ­£ç¡®åšæ³•</span>
response = requests.get(<span class="hljs-string">'https://api.example.com/data'</span>)
response.raise_for_status()  <span class="hljs-comment"># æ£€æŸ¥çŠ¶æ€ç ,é2xxæ—¶æŠ›å‡ºHTTPError</span>
data = response.json()
</code></pre>
<h4 data-id="heading-20">é”™è¯¯2:ä¸è®¾ç½®è¶…æ—¶æ—¶é—´</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># âŒ é”™è¯¯åšæ³•</span>
response = requests.get(<span class="hljs-string">'https://api.example.com/data'</span>)
<span class="hljs-comment"># å¦‚æœç½‘ç»œæ•…éšœæˆ–æœåŠ¡å™¨æ— å“åº”,ç¨‹åºä¼šæ— é™æœŸç­‰å¾…</span>

<span class="hljs-comment"># âœ… æ­£ç¡®åšæ³•</span>
response = requests.get(<span class="hljs-string">'https://api.example.com/data'</span>, timeout=<span class="hljs-number">10</span>)
<span class="hljs-comment"># 10ç§’åè¶…æ—¶,æŠ›å‡ºTimeoutå¼‚å¸¸</span>
</code></pre>
<h4 data-id="heading-21">é”™è¯¯3:åœ¨å¾ªç¯ä¸­é‡å¤åˆ›å»ºä¼šè¯</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># âŒ é”™è¯¯åšæ³•</span>
<span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> url_list:
    response = requests.get(url)  <span class="hljs-comment"># æ¯æ¬¡éƒ½å»ºç«‹æ–°è¿æ¥,æ•ˆç‡ä½ä¸‹</span>

<span class="hljs-comment"># âœ… æ­£ç¡®åšæ³•</span>
<span class="hljs-keyword">with</span> requests.Session() <span class="hljs-keyword">as</span> session:
    <span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> url_list:
        response = session.get(url)  <span class="hljs-comment"># å¤ç”¨è¿æ¥,æ€§èƒ½æ›´é«˜</span>
</code></pre>
<h3 data-id="heading-22">æœ€ä½³å®è·µå»ºè®®</h3>
<ol>
<li>
<p><strong>å§‹ç»ˆä½¿ç”¨ä¼šè¯(Session)</strong>: å¯¹äºå‘åŒä¸€åŸŸåå‘é€å¤šä¸ªè¯·æ±‚çš„åœºæ™¯,ä½¿ç”¨Sessionå¯ä»¥å¤ç”¨TCPè¿æ¥,å‡å°‘æ¡æ‰‹å¼€é”€,æé«˜æ€§èƒ½ã€‚</p>
</li>
<li>
<p><strong>åˆç†è®¾ç½®è¶…æ—¶</strong>: å»ºè®®ä¸ºæ‰€æœ‰è¯·æ±‚è®¾ç½®è¶…æ—¶å‚æ•°,å¯ä»¥ä½¿ç”¨å…ƒç»„åˆ†åˆ«è®¾ç½®è¿æ¥è¶…æ—¶å’Œè¯»å–è¶…æ—¶,ä¾‹å¦‚<code>timeout=(3, 10)</code>ã€‚</p>
</li>
<li>
<p><strong>å¤„ç†JSONè§£æå¼‚å¸¸</strong>: å¹¶éæ‰€æœ‰APIå“åº”éƒ½æ˜¯æœ‰æ•ˆçš„JSON,ä½¿ç”¨<code>response.json()</code>æ—¶åº”è¯¥æ•è·<code>JSONDecodeError</code>:</p>
</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> json

<span class="hljs-keyword">try</span>:
    data = response.json()
<span class="hljs-keyword">except</span> json.JSONDecodeError:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"å“åº”ä¸æ˜¯æœ‰æ•ˆçš„JSONæ ¼å¼"</span>)
    data = <span class="hljs-literal">None</span>
</code></pre>
<ol start="4">
<li><strong>ä½¿ç”¨User-Agentæ ‡è¯†</strong>: æŸäº›ç½‘ç«™ä¼šæ£€æŸ¥è¯·æ±‚å¤´ä¸­çš„User-Agent,å»ºè®®è®¾ç½®ä¸€ä¸ªåˆç†çš„æ ‡è¯†:</li>
</ol>
<pre><code class="hljs language-python" lang="python">headers = {
    <span class="hljs-string">'User-Agent'</span>: <span class="hljs-string">'MyWeatherApp/1.0 (https://myapp.com)'</span>
}
response = requests.get(url, headers=headers)
</code></pre>
<ol start="5">
<li><strong>HTTPSè¯ä¹¦éªŒè¯</strong>: ç”Ÿäº§ç¯å¢ƒä¸­åº”è¯¥éªŒè¯SSLè¯ä¹¦,ä»…åœ¨æµ‹è¯•ç¯å¢ƒæˆ–ç‰¹å®šåœºæ™¯ä¸‹ç¦ç”¨:</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç”Ÿäº§ç¯å¢ƒ:éªŒè¯è¯ä¹¦(é»˜è®¤è¡Œä¸º)</span>
response = requests.get(<span class="hljs-string">'https://example.com'</span>)

<span class="hljs-comment"># æµ‹è¯•ç¯å¢ƒ:ç¦ç”¨è¯ä¹¦éªŒè¯</span>
response = requests.get(<span class="hljs-string">'https://example.com'</span>, verify=<span class="hljs-literal">False</span>)
</code></pre>
<ol start="6">
<li><strong>ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†æ•æ„Ÿä¿¡æ¯</strong>: APIå¯†é’¥ã€ä»¤ç‰Œç­‰æ•æ„Ÿä¿¡æ¯åº”è¯¥å­˜å‚¨åœ¨ç¯å¢ƒå˜é‡ä¸­,è€Œä¸æ˜¯ç¡¬ç¼–ç åœ¨ä»£ç é‡Œ:</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> os

api_key = os.environ.get(<span class="hljs-string">'MY_API_KEY'</span>)
headers = {<span class="hljs-string">'Authorization'</span>: <span class="hljs-string">f'Bearer <span class="hljs-subst">{api_key}</span>'</span>}
</code></pre>
<h3 data-id="heading-23">æ³¨æ„äº‹é¡¹</h3>
<ul>
<li>Requestsé»˜è®¤ä½¿ç”¨è¿æ¥æ± ,ä¼šè‡ªåŠ¨å¤„ç†Keep-Alive,æ— éœ€æ‰‹åŠ¨ç®¡ç†è¿æ¥</li>
<li>ä¸‹è½½å¤§æ–‡ä»¶æ—¶,ä½¿ç”¨<code>stream=True</code>å‚æ•°é€æ­¥è¯»å–,é¿å…å†…å­˜æº¢å‡º</li>
<li>å¤„ç†é‡å®šå‘æ—¶,å¯ä»¥é€šè¿‡<code>allow_redirects=False</code>ç¦ç”¨è‡ªåŠ¨é‡å®šå‘</li>
<li>å¯¹äºéœ€è¦è®¤è¯çš„API,ä¼˜å…ˆä½¿ç”¨Sessionå¯¹è±¡çš„<code>auth</code>å‚æ•°æˆ–<code>headers</code>å‚æ•°,è€Œä¸æ˜¯åœ¨æ¯ä¸ªè¯·æ±‚ä¸­é‡å¤è®¾ç½®</li>
</ul>
<h2 data-id="heading-24">6. è¿›é˜¶æŒ‡å¼•</h2>
<h3 data-id="heading-25">é«˜çº§åŠŸèƒ½</h3>
<p>Requestsæä¾›äº†è®¸å¤šé«˜çº§åŠŸèƒ½,å¯ä»¥åº”å¯¹å¤æ‚çš„HTTPäº¤äº’åœºæ™¯:</p>
<ul>
<li><strong>è®¤è¯å¤„ç†</strong>: æ”¯æŒBasicè®¤è¯ã€Digestè®¤è¯ã€OAuthç­‰å¤šç§è®¤è¯æ–¹å¼</li>
<li><strong>ä»£ç†é…ç½®</strong>: é€šè¿‡<code>proxies</code>å‚æ•°é…ç½®HTTP/SOCKSä»£ç†</li>
<li><strong>æµå¼ä¸Šä¼ /ä¸‹è½½</strong>: å¤„ç†å¤§æ–‡ä»¶ä¼ è¾“æ—¶é¿å…å†…å­˜é—®é¢˜</li>
<li><strong>äº‹ä»¶é’©å­</strong>: åœ¨è¯·æ±‚çš„ä¸åŒé˜¶æ®µæ³¨å†Œå›è°ƒå‡½æ•°</li>
<li><strong>è‡ªå®šä¹‰é€‚é…å™¨</strong>: å®ç°è‡ªå®šä¹‰çš„ä¼ è¾“åè®®æˆ–è¿æ¥é€»è¾‘</li>
</ul>
<h3 data-id="heading-26">ç”Ÿæ€æ‰©å±•</h3>
<p>Requestsçš„ç”Ÿæ€ä¸°å¯Œ,æœ‰è®¸å¤šæ‰©å±•åº“å¯ä»¥å¢å¼ºå…¶åŠŸèƒ½:</p>
<ul>
<li><code>requests-oauthlib</code>: OAuthè®¤è¯æ”¯æŒ</li>
<li><code>requests-cache</code>: å“åº”ç¼“å­˜,å‡å°‘é‡å¤è¯·æ±‚</li>
<li><code>requests-toolbelt</code>: å®ç”¨å·¥å…·é›†åˆ,å¦‚Multipartä¸Šä¼ ã€æµå¼è¯·æ±‚ç­‰</li>
<li><code>grequests</code>: åŸºäºgeventçš„å¼‚æ­¥è¯·æ±‚</li>
<li><code>requests-threads</code>: å¤šçº¿ç¨‹è¯·æ±‚æ”¯æŒ</li>
</ul>
<h3 data-id="heading-27">å­¦ä¹ è·¯å¾„</h3>
<p>å¦‚æœä½ æƒ³æ·±å…¥å­¦ä¹ Requests,å»ºè®®æŒ‰ä»¥ä¸‹è·¯å¾„è¿›è¡Œ:</p>
<ol>
<li><strong>æŒæ¡åŸºç¡€API</strong>: ç†Ÿæ‚‰æ‰€æœ‰è¯·æ±‚æ–¹æ³•å’ŒResponseå¯¹è±¡çš„å±æ€§</li>
<li><strong>ç†è§£HTTPåè®®</strong>: å­¦ä¹ HTTP/1.1è§„èŒƒ,ç†è§£çŠ¶æ€ç ã€è¯·æ±‚å¤´ã€å“åº”å¤´çš„å«ä¹‰</li>
<li><strong>æ¢ç´¢é«˜çº§ç‰¹æ€§</strong>: ç ”ç©¶Sessionå¯¹è±¡ã€è¿æ¥æ± ã€SSLéªŒè¯ç­‰é«˜çº§åŠŸèƒ½</li>
<li><strong>é˜…è¯»æºä»£ç </strong>: Requestsçš„ä»£ç ç»“æ„æ¸…æ™°,é˜…è¯»æºç æœ‰åŠ©äºç†è§£å…¶å®ç°åŸç†</li>
<li><strong>å®è·µé¡¹ç›®</strong>: å¼€å‘ä¸€ä¸ªå®Œæ•´çš„çˆ¬è™«æˆ–APIå®¢æˆ·ç«¯é¡¹ç›®</li>
</ol>
<h3 data-id="heading-28">å­¦ä¹ èµ„æº</h3>
<ul>
<li><strong>å®˜æ–¹æ–‡æ¡£</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.python-requests.org" target="_blank" title="https://docs.python-requests.org" ref="nofollow noopener noreferrer">docs.python-requests.org</a> (æœ€æƒå¨ã€æœ€å®Œæ•´çš„èµ„æº)</li>
<li><strong>GitHubä»“åº“</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fpsf%2Frequests" target="_blank" title="https://github.com/psf/requests" ref="nofollow noopener noreferrer">github.com/psf/requestâ€¦</a> (æºç ã€Issueã€è®¨è®º)</li>
<li><strong>Stack Overflow</strong>: æœç´¢æ ‡ç­¾[python-requests]æ‰¾åˆ°å¸¸è§é—®é¢˜çš„è§£ç­”</li>
<li><strong>ç¤¾åŒºåšå®¢</strong>: è®¸å¤šå¼€å‘è€…åˆ†äº«äº†Requestsçš„å®æˆ˜ç»éªŒå’ŒæŠ€å·§</li>
</ul>
<p>Requestsåº“çš„è®¾è®¡ç†å¿µæ˜¯"ç®€å•å³ç¾",ä½†å®ƒçš„èƒŒåæ˜¯HTTPåè®®çš„å¤æ‚æ€§å’Œç½‘ç»œç¼–ç¨‹çš„æŒ‘æˆ˜ã€‚æŒæ¡äº†Requests,ä½ å°±æŒæ¡äº†ä¸ç½‘ç»œä¸–ç•Œæ²Ÿé€šçš„åŸºæœ¬æŠ€èƒ½ã€‚ç»§ç»­æ¢ç´¢,ä½ ä¼šå‘ç°HTTPè¯·æ±‚çš„ä¸–ç•Œè¿œæ¯”ä½ æƒ³è±¡çš„æ›´åŠ ä¸°å¯Œå’Œæœ‰è¶£ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Elasticsearch 9.X Javaå®¢æˆ·ç«¯APIå®æˆ˜æŒ‡å—ï¼ˆå…¥é—¨æ•™å­¦ç‰ˆï¼‰]]></title>    <link>https://juejin.cn/post/7603263490342862857</link>    <guid>https://juejin.cn/post/7603263490342862857</guid>    <pubDate>2026-02-06T06:36:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603263490342862857" data-draft-id="7603393977476235290" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Elasticsearch 9.X Javaå®¢æˆ·ç«¯APIå®æˆ˜æŒ‡å—ï¼ˆå…¥é—¨æ•™å­¦ç‰ˆï¼‰"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-06T06:36:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¥å¥‡å°æ±¤åœ†"/> <meta itemprop="url" content="https://juejin.cn/user/1151943919285431"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Elasticsearch 9.X Javaå®¢æˆ·ç«¯APIå®æˆ˜æŒ‡å—ï¼ˆå…¥é—¨æ•™å­¦ç‰ˆï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1151943919285431/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¥å¥‡å°æ±¤åœ†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T06:36:28.000Z" title="Fri Feb 06 2026 06:36:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»20åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨ç°ä»£æœç´¢ä¸æ•°æ®åˆ†æåœºæ™¯ä¸­ï¼ŒElasticsearchï¼ˆä»¥ä¸‹ç®€ç§°ESï¼‰æ—©å·²æˆä¸ºæ ¸å¿ƒç»„ä»¶ï¼Œå¹¿æ³›åº”ç”¨äºæ—¥å¿—åˆ†æã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269982258%26content_type%3DArticle%26match_order%3D1%26q%3D%25E5%2585%25A8%25E6%2596%2587%25E6%25A3%2580%25E7%25B4%25A2%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269982258&amp;content_type=Article&amp;match_order=1&amp;q=%E5%85%A8%E6%96%87%E6%A3%80%E7%B4%A2&amp;zhida_source=entity" ref="nofollow noopener noreferrer">å…¨æ–‡æ£€ç´¢</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269982258%26content_type%3DArticle%26match_order%3D1%26q%3D%25E6%2595%25B0%25E6%258D%25AE%25E5%258F%25AF%25E8%25A7%2586%25E5%258C%2596%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269982258&amp;content_type=Article&amp;match_order=1&amp;q=%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96&amp;zhida_source=entity" ref="nofollow noopener noreferrer">æ•°æ®å¯è§†åŒ–</a>ç­‰é¢†åŸŸã€‚éšç€ES 9.Xç‰ˆæœ¬çš„æ­£å¼å‘å¸ƒï¼Œå…¶å®˜æ–¹Javaå®¢æˆ·ç«¯APIè¿æ¥äº†é‡å¤§æ›´æ–°â€”â€”<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269982258%26content_type%3DArticle%26match_order%3D1%26q%3DRestHighLevelClient%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269982258&amp;content_type=Article&amp;match_order=1&amp;q=RestHighLevelClient&amp;zhida_source=entity" ref="nofollow noopener noreferrer">RestHighLevelClient</a>è¢«å½»åº•åºŸå¼ƒ</strong>ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯å…¨æ–°çš„<code>elasticsearch-java</code>å®¢æˆ·ç«¯ã€‚</p>
<p>å¯¹äºä¹ æƒ¯äº†ä½ç‰ˆæœ¬ESä¸æ—§å®¢æˆ·ç«¯çš„å¼€å‘è€…è€Œè¨€ï¼Œè¿™æ¬¡æ›´æ–°æ— ç–‘å¢åŠ äº†ä¸Šæ‰‹æˆæœ¬ã€‚å®˜æ–¹æ–°å®¢æˆ·ç«¯é‡‡ç”¨äº†æ›´ç®€æ´çš„Fluent DSLè¯­æ³•ï¼Œæ›´è½»é‡çš„ä¾èµ–è®¾è®¡ï¼Œä¸”èƒ½ä¸ESæœåŠ¡ç«¯APIå®æ—¶åŒæ­¥æ¼”è¿›ï¼Œä»æ ¹æœ¬ä¸Šè§£å†³äº†æ—§å®¢æˆ·ç«¯ä¾èµ–è€¦åˆé‡ã€è¯·æ±‚æ„å»ºè‡ƒè‚¿ã€ä¸RESTæ–‡æ¡£è„±èŠ‚çš„ç—›ç‚¹ã€‚</p>
<p>æœ¬æ–‡ä¸“ä¸ºES 9.Xæ–°æ‰‹æ‰“é€ ï¼Œæ‘’å¼ƒå¤æ‚ç†è®ºï¼Œèšç„¦å®é™…å¼€å‘åœºæ™¯ï¼Œè¯¦ç»†è®²è§£æ–°Javaå®¢æˆ·ç«¯çš„åŸºç¡€ä¾èµ–é…ç½®ä¸æ ¸å¿ƒAPIä½¿ç”¨ï¼ˆå«æ–‡æ¡£CRUDã€æ£€ç´¢ã€èšåˆã€åˆ†é¡µæ’åºï¼‰ï¼Œæ‰€æœ‰ä»£ç å‡å¯ç›´æ¥å¤åˆ¶è¿è¡Œï¼ŒåŠ©åŠ›å¼€å‘è€…å¿«é€Ÿä¸Šæ‰‹æ–°å®¢æˆ·ç«¯ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ç¯å¢ƒå‡†å¤‡ä¸<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269982258%26content_type%3DArticle%26match_order%3D2%26q%3D%25E4%25BE%259D%25E8%25B5%2596%25E9%2585%258D%25E7%25BD%25AE%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269982258&amp;content_type=Article&amp;match_order=2&amp;q=%E4%BE%9D%E8%B5%96%E9%85%8D%E7%BD%AE&amp;zhida_source=entity" ref="nofollow noopener noreferrer">ä¾èµ–é…ç½®</a></h2>
<p>ä½¿ç”¨ES 9.X Javaå®¢æˆ·ç«¯å‰ï¼Œéœ€ç¡®ä¿æœ¬åœ°/æœåŠ¡å™¨å·²éƒ¨ç½²ES 9.Xç‰ˆæœ¬ï¼ˆå®¢æˆ·ç«¯ç‰ˆæœ¬éœ€ä¸æœåŠ¡ç«¯ç‰ˆæœ¬ä¸¥æ ¼ä¸€è‡´ï¼Œé¿å…ç‰ˆæœ¬å†²çªå¼•å‘å¼‚å¸¸ï¼‰ï¼Œæœ¬æ–‡ä»¥<code>9.1.0</code>ç‰ˆæœ¬ä¸ºä¾‹è¿›è¡Œæ¼”ç¤ºã€‚</p>
<h3 data-id="heading-2">1.1 Mavenä¾èµ–ï¼ˆæ›´æ¨èï¼‰</h3>
<p>åœ¨é¡¹ç›®<code>pom.xml</code>ä¸­å¼•å…¥ä»¥ä¸‹ä¾èµ–ï¼Œæ ¸å¿ƒä¾èµ–ä¸º<code>elasticsearch-java</code>ï¼Œé¢å¤–å¼•å…¥<code>lombok</code>ç®€åŒ–å®ä½“ç±»å¼€å‘ï¼ˆå¯é€‰ï¼Œè‹¥ä¸ä½¿ç”¨å¯æ‰‹åŠ¨å®ç°getter/setterï¼‰ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- ES 9.X Javaå®¢æˆ·ç«¯æ ¸å¿ƒä¾èµ– --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>co.elastic.clients<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>elasticsearch-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>9.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

<span class="hljs-comment">&lt;!-- Lombokä¾èµ–ï¼ˆç®€åŒ–å®ä½“ç±»ï¼Œå¯é€‰ï¼‰ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.18.24<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

<span class="hljs-comment">&lt;!-- å¯é€‰ï¼šJacksonä¾èµ–ï¼ˆè‹¥JSONåºåˆ—åŒ–å¼‚å¸¸å¯æ·»åŠ ï¼‰ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jackson-databind<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.15.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h3 data-id="heading-3">1.2 Gradleä¾èµ–</h3>
<p>è‹¥é¡¹ç›®ä½¿ç”¨Gradleæ„å»ºï¼Œæ·»åŠ ä»¥ä¸‹ä¾èµ–è‡³<code>build.gradle</code>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// ES 9.X Javaå®¢æˆ·ç«¯æ ¸å¿ƒä¾èµ–</span>
implementation <span class="hljs-string">'co.elastic.clients:elasticsearch-java:9.1.0'</span>
<span class="hljs-comment">// Lombokä¾èµ–ï¼ˆå¯é€‰ï¼‰</span>
compileOnly <span class="hljs-string">'org.projectlombok:lombok:1.18.24'</span>
annotationProcessor <span class="hljs-string">'org.projectlombok:lombok:1.18.24'</span>
<span class="hljs-comment">// å¯é€‰ï¼šJacksonä¾èµ–</span>
implementation <span class="hljs-string">'com.fasterxml.jackson.core:jackson-databind:2.15.2'</span>
</code></pre>
<h3 data-id="heading-4">1.3 ä¾èµ–æ³¨æ„äº‹é¡¹</h3>
<ul>
<li>æ ¸å¿ƒä¾èµ–<code>elasticsearch-java</code>ç‰ˆæœ¬å¿…é¡»ä¸ESæœåŠ¡ç«¯ç‰ˆæœ¬ä¸€è‡´ï¼ˆå¦‚ESæœåŠ¡ç«¯ä¸º9.1.0ï¼Œå®¢æˆ·ç«¯ä¹Ÿéœ€ä¸º9.1.0ï¼‰ï¼Œå¦åˆ™ä¼šå‡ºç°ç‰ˆæœ¬å…¼å®¹å¼‚å¸¸ï¼ˆå¦‚<code>NoSuchMethodError</code>ã€æœªçŸ¥å‚æ•°å¼‚å¸¸ï¼‰ã€‚</li>
<li>æ— éœ€é¢å¤–å¼•å…¥ESæœåŠ¡ç«¯æ ¸å¿ƒåŒ…ï¼Œæ–°å®¢æˆ·ç«¯å·²å½»åº•è§£è€¦æ—§å®¢æˆ·ç«¯çš„å¼ºä¾èµ–é—®é¢˜ï¼Œä½“ç§¯æ›´è½»é‡ã€‚</li>
<li>å¤šæ¨¡å—é¡¹ç›®ä¸­ï¼Œéœ€ç¡®ä¿æ‰€æœ‰å­æ¨¡å—çš„ESå®¢æˆ·ç«¯ç‰ˆæœ¬ç»Ÿä¸€ï¼Œé¿å…å‡ºç°å¤šä¸ªå®¢æˆ·ç«¯å®ä¾‹å†²çªçš„æƒ…å†µã€‚</li>
</ul>
<h2 data-id="heading-5">äºŒã€æ ¸å¿ƒAPIå®æˆ˜ï¼ˆåŸºç¡€å¿…å­¦ï¼‰</h2>
<p>æœ¬æ–‡ä»¥ã€Œå•†å“ï¼ˆProductï¼‰ã€ä¸ºç¤ºä¾‹å®ä½“ï¼Œæ¨¡æ‹Ÿå®é™…ä¸šåŠ¡åœºæ™¯ï¼Œè®²è§£æ–°å®¢æˆ·ç«¯çš„å„é¡¹åŸºç¡€æ“ä½œã€‚æ‰€æœ‰ä»£ç å‡åŒ…å«å®Œæ•´æ³¨é‡Šï¼Œæ–°æ‰‹å¯ç›´æ¥å¤åˆ¶åˆ°é¡¹ç›®ä¸­æµ‹è¯•ï¼ˆéœ€æ›¿æ¢ESæœåŠ¡ç«¯åœ°å€ã€è´¦å·å¯†ç ï¼‰ã€‚</p>
<h3 data-id="heading-6">2.1 å®šä¹‰ç¤ºä¾‹å®ä½“ç±»</h3>
<p>åˆ›å»ºå•†å“å®ä½“ç±»<code>Product</code>ï¼Œå¯¹åº”ESä¸­çš„<code>products</code>ç´¢å¼•ï¼Œå­—æ®µå«ä¹‰ï¼š<code>sku</code>ï¼ˆå•†å“å”¯ä¸€æ ‡è¯†ï¼‰ã€<code>name</code>ï¼ˆå•†å“åç§°ï¼‰ã€<code>price</code>ï¼ˆå•†å“ä»·æ ¼ï¼‰ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> lombok.<span class="hljs-property">AllArgsConstructor</span>;
<span class="hljs-keyword">import</span> lombok.<span class="hljs-property">Data</span>;
<span class="hljs-keyword">import</span> lombok.<span class="hljs-property">NoArgsConstructor</span>;

<span class="hljs-comment">/**
 * å•†å“å®ä½“ç±»ï¼ˆå¯¹åº”ESçš„productsç´¢å¼•ï¼‰
 * æ³¨ï¼š<span class="hljs-doctag">@Data</span>æ³¨è§£ç­‰ä»·äº<span class="hljs-doctag">@Getter</span>+<span class="hljs-doctag">@Setter</span>+<span class="hljs-doctag">@ToString</span>+<span class="hljs-doctag">@EqualsAndHashCode</span>+<span class="hljs-doctag">@RequiredArgsConstructor</span>
 * è‹¥ä¸ä½¿ç”¨Lombokï¼Œéœ€æ‰‹åŠ¨å®ç°getter/setteræ–¹æ³•
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@AllArgsConstructor</span>  <span class="hljs-comment">// å…¨å‚æ„é€ æ–¹æ³•</span>
<span class="hljs-meta">@NoArgsConstructor</span>   <span class="hljs-comment">// æ— å‚æ„é€ æ–¹æ³•ï¼ˆJSONååºåˆ—åŒ–å¿…é¡»ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Product</span> {
    <span class="hljs-comment">// å•†å“å”¯ä¸€æ ‡è¯†ï¼ˆå¯¹åº”ESæ–‡æ¡£idï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> sku;
    <span class="hljs-comment">// å•†å“åç§°ï¼ˆå¯ç”¨äºå…¨æ–‡æ£€ç´¢ã€ç²¾ç¡®æ£€ç´¢ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> name;
    <span class="hljs-comment">// å•†å“ä»·æ ¼ï¼ˆå¯ç”¨äºèŒƒå›´æŸ¥è¯¢ã€èšåˆç»Ÿè®¡ï¼‰</span>
    <span class="hljs-keyword">private</span> double price;
}
</code></pre>
<h3 data-id="heading-7">2.2 åˆ›å»ºESå®¢æˆ·ç«¯ï¼ˆæ ¸å¿ƒæ­¥éª¤ï¼‰</h3>
<p>ES 9.X Javaå®¢æˆ·ç«¯é€šè¿‡<code>ElasticsearchClient</code>ç±»å®ç°ä¸æœåŠ¡ç«¯çš„è¿æ¥ï¼Œæ”¯æŒé…ç½®æœåŠ¡ç«¯åœ°å€ã€è´¦å·å¯†ç ã€è¶…æ—¶æ—¶é—´ç­‰å‚æ•°ã€‚å®¢æˆ·ç«¯ä¸ºé‡é‡çº§å¯¹è±¡ï¼Œå»ºè®®å…¨å±€å•ä¾‹åˆ›å»ºï¼Œé¿å…é¢‘ç¹åˆ›å»º/é”€æ¯å¯¼è‡´èµ„æºæ³„éœ²ã€‚</p>
<p><strong>2.2.1 åŸºç¡€åˆ›å»ºï¼ˆç®€æ´ç‰ˆï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.ElasticsearchClient;
<span class="hljs-keyword">import</span> co.elastic.clients.json.jackson.JacksonJsonpMapper;
<span class="hljs-keyword">import</span> co.elastic.clients.transport.rest_client.RestClientTransport;
<span class="hljs-keyword">import</span> org.elasticsearch.client.RestClient;

<span class="hljs-keyword">import</span> java.net.URI;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EsClientUtil</span> {
    <span class="hljs-comment">// å•ä¾‹å®¢æˆ·ç«¯å®ä¾‹</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ElasticsearchClient esClient;

    <span class="hljs-comment">// åˆå§‹åŒ–å®¢æˆ·ç«¯ï¼ˆé™æ€ä»£ç å—ï¼Œé¡¹ç›®å¯åŠ¨æ—¶æ‰§è¡Œä¸€æ¬¡ï¼‰</span>
    <span class="hljs-keyword">static</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 1. é…ç½®ESæœåŠ¡ç«¯åœ°å€ï¼ˆå•æœºï¼šå•ä¸ªURIï¼›é›†ç¾¤ï¼šå¤šä¸ªURIç”¨é€—å·åˆ†éš”ï¼‰</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">serverUrl</span> <span class="hljs-operator">=</span> <span class="hljs-string">"http://127.0.0.1:9200"</span>; <span class="hljs-comment">// æ›¿æ¢ä¸ºä½ çš„ESæœåŠ¡ç«¯åœ°å€</span>
            <span class="hljs-comment">// 2. åˆ›å»ºRestClientï¼ˆåº•å±‚HTTPè¿æ¥ï¼‰</span>
            <span class="hljs-type">RestClient</span> <span class="hljs-variable">restClient</span> <span class="hljs-operator">=</span> RestClient.builder(URI.create(serverUrl))
                    <span class="hljs-comment">// é…ç½®è´¦å·å¯†ç ï¼ˆè‹¥ESæœªå¼€å¯æƒé™éªŒè¯ï¼Œå¯çœç•¥æ­¤æ­¥éª¤ï¼‰</span>
                    .setBasicAuth(<span class="hljs-string">"elastic"</span>, <span class="hljs-string">"123456"</span>) <span class="hljs-comment">// æ›¿æ¢ä¸ºä½ çš„ESè´¦å·å¯†ç </span>
                    .build();

            <span class="hljs-comment">// 3. åˆ›å»ºä¼ è¾“å±‚ï¼ˆæŒ‡å®šJSONåºåˆ—åŒ–æ–¹å¼ï¼ŒJacksonä¸ºé»˜è®¤æ¨èï¼‰</span>
            <span class="hljs-type">RestClientTransport</span> <span class="hljs-variable">transport</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RestClientTransport</span>(
                    restClient, <span class="hljs-keyword">new</span> <span class="hljs-title class_">JacksonJsonpMapper</span>()
            );

            <span class="hljs-comment">// 4. åˆ›å»ºæœ€ç»ˆçš„ESå®¢æˆ·ç«¯</span>
            esClient = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ElasticsearchClient</span>(transport);
            System.out.println(<span class="hljs-string">"ES 9.Xå®¢æˆ·ç«¯åˆå§‹åŒ–æˆåŠŸï¼"</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"ESå®¢æˆ·ç«¯åˆå§‹åŒ–å¤±è´¥ï¼Œè¯·æ£€æŸ¥æœåŠ¡ç«¯åœ°å€å’Œè´¦å·å¯†ç "</span>);
        }
    }

    <span class="hljs-comment">// è·å–å®¢æˆ·ç«¯å®ä¾‹ï¼ˆå¯¹å¤–æä¾›ç»Ÿä¸€è®¿é—®å…¥å£ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ElasticsearchClient <span class="hljs-title function_">getEsClient</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> esClient;
    }

    <span class="hljs-comment">// å…³é—­å®¢æˆ·ç«¯ï¼ˆé¡¹ç›®åœæ­¢æ—¶è°ƒç”¨ï¼Œé‡Šæ”¾èµ„æºï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">closeClient</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (esClient != <span class="hljs-literal">null</span>) {
                <span class="hljs-comment">// å…³é—­ä¼ è¾“å±‚å’ŒRestClient</span>
                esClient._transport().close();
                esClient._transport().restClient().close();
                System.out.println(<span class="hljs-string">"ESå®¢æˆ·ç«¯å·²å…³é—­"</span>);
            }
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }
}

<span class="hljs-comment">// ä½¿ç”¨æ–¹å¼ï¼ˆä»»ä½•åœ°æ–¹ç›´æ¥è°ƒç”¨ï¼‰</span>
<span class="hljs-comment">// ElasticsearchClient client = EsClientUtil.getEsClient();</span>
</code></pre>
<p><strong>2.2.2 è¿›é˜¶é…ç½®ï¼ˆè¶…æ—¶ã€é›†ç¾¤ï¼‰</strong></p>
<p>è‹¥éœ€é…ç½®è¿æ¥è¶…æ—¶ã€è¯»å–è¶…æ—¶ï¼Œæˆ–è¿æ¥ESé›†ç¾¤ï¼Œå¯ä¿®æ”¹å®¢æˆ·ç«¯åˆå§‹åŒ–é€»è¾‘ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// é›†ç¾¤é…ç½®+è¶…æ—¶é…ç½®ï¼ˆæ›¿æ¢ä¸Šé¢çš„é™æ€ä»£ç å—ï¼‰</span>
<span class="hljs-keyword">static</span> {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// é›†ç¾¤åœ°å€ï¼ˆå¤šä¸ªèŠ‚ç‚¹ç”¨é€—å·åˆ†éš”ï¼‰</span>
        String[] serverUrls = {<span class="hljs-string">"http://127.0.0.1:9200"</span>, <span class="hljs-string">"http://127.0.0.1:9201"</span>, <span class="hljs-string">"http://127.0.0.1:9202"</span>};
        <span class="hljs-comment">// æ„å»ºRestClientBuilder</span>
        RestClient.<span class="hljs-type">Builder</span> <span class="hljs-variable">restClientBuilder</span> <span class="hljs-operator">=</span> RestClient.builder(
                Arrays.stream(serverUrls).map(URI::create).toArray(URI[]::<span class="hljs-keyword">new</span>)
        );

        <span class="hljs-comment">// é…ç½®è´¦å·å¯†ç </span>
        restClientBuilder.setBasicAuth(<span class="hljs-string">"elastic"</span>, <span class="hljs-string">"123456"</span>);

        <span class="hljs-comment">// é…ç½®è¶…æ—¶æ—¶é—´ï¼ˆå¯é€‰ï¼Œæ ¹æ®ä¸šåŠ¡è°ƒæ•´ï¼‰</span>
        restClientBuilder.setRequestConfigCallback(requestConfigBuilder -&gt; 
                requestConfigBuilder
                        .setConnectTimeout(<span class="hljs-number">5000</span>)  <span class="hljs-comment">// è¿æ¥è¶…æ—¶ï¼š5ç§’</span>
                        .setSocketTimeout(<span class="hljs-number">10000</span>) <span class="hljs-comment">// è¯»å–è¶…æ—¶ï¼š10ç§’</span>
        );

        <span class="hljs-comment">// åç»­æ­¥éª¤ï¼ˆä¼ è¾“å±‚ã€å®¢æˆ·ç«¯åˆ›å»ºï¼‰ä¸åŸºç¡€ç‰ˆä¸€è‡´</span>
        <span class="hljs-type">RestClient</span> <span class="hljs-variable">restClient</span> <span class="hljs-operator">=</span> restClientBuilder.build();
        <span class="hljs-type">RestClientTransport</span> <span class="hljs-variable">transport</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RestClientTransport</span>(restClient, <span class="hljs-keyword">new</span> <span class="hljs-title class_">JacksonJsonpMapper</span>());
        esClient = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ElasticsearchClient</span>(transport);
        System.out.println(<span class="hljs-string">"ESé›†ç¾¤å®¢æˆ·ç«¯åˆå§‹åŒ–æˆåŠŸï¼"</span>);
    } <span class="hljs-keyword">catch</span> (Exception e) {
        e.printStackTrace();
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"ESå®¢æˆ·ç«¯åˆå§‹åŒ–å¤±è´¥"</span>);
    }
}
</code></pre>
<h3 data-id="heading-8">2.3 æ–‡æ¡£æ“ä½œï¼ˆCRUDæ ¸å¿ƒï¼‰</h3>
<p>ESæ–‡æ¡£æ“ä½œæ˜¯åŸºç¡€ï¼Œæ–°å®¢æˆ·ç«¯æä¾›ä¸¤ç§è¯·æ±‚æ„å»ºæ–¹å¼ï¼š<strong>Fluent DSL</strong>ï¼ˆç®€æ´ä¼˜é›…ï¼Œæ¨èï¼‰å’Œ<strong>Builderæ¨¡å¼</strong>ï¼ˆçµæ´»ï¼Œé€‚åˆå¤æ‚åœºæ™¯ï¼‰ï¼Œä»¥ä¸‹åˆ†åˆ«æ¼”ç¤ºã€‚</p>
<p><strong>2.3.1 æ’å…¥æ–‡æ¡£ï¼ˆå•æ¡ï¼‰</strong></p>
<p>æ’å…¥æ–‡æ¡£å³å‘ESç´¢å¼•ä¸­æ·»åŠ ä¸€æ¡æ•°æ®ï¼Œå¯æŒ‡å®šæ–‡æ¡£idï¼ˆæ¨èç”¨ä¸šåŠ¡å”¯ä¸€æ ‡è¯†ï¼Œå¦‚å•†å“skuï¼‰ï¼Œä¹Ÿå¯è®©ESè‡ªåŠ¨ç”Ÿæˆidã€‚</p>
<p><strong>æ–¹å¼1ï¼šFluent DSLï¼ˆæ¨èï¼‰</strong></p>
<pre><code class="hljs language-csharp" lang="csharp">import co.elastic.clients.elasticsearch.core.IndexRequest;
import co.elastic.clients.elasticsearch.core.IndexResponse;

<span class="hljs-comment">/**
 * å•æ¡æ’å…¥æ–‡æ¡£ï¼ˆFluent DSLæ–¹å¼ï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">EsDocumentInsert</span> {
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 1. è·å–ESå®¢æˆ·ç«¯</span>
            ElasticsearchClient client = EsClientUtil.getEsClient();

            <span class="hljs-comment">// 2. æ„å»ºå•†å“æ•°æ®ï¼ˆæ¨¡æ‹Ÿä¸šåŠ¡æ•°æ®ï¼‰</span>
            Product product = <span class="hljs-keyword">new</span> Product(<span class="hljs-string">"sku001"</span>, <span class="hljs-string">"è‹¹æœ14 Pro"</span>, <span class="hljs-number">7999.0</span>);

            <span class="hljs-comment">// 3. æ„å»ºæ’å…¥è¯·æ±‚ï¼ˆFluent DSLè¯­æ³•ï¼Œé“¾å¼è°ƒç”¨ï¼‰</span>
            IndexRequest&lt;Product&gt; request = IndexRequest.of(i -&gt; i
                    .index(<span class="hljs-string">"products"</span>)          <span class="hljs-comment">// æŒ‡å®šç´¢å¼•åç§°ï¼ˆè‹¥ç´¢å¼•ä¸å­˜åœ¨ï¼ŒESä¼šè‡ªåŠ¨åˆ›å»ºï¼Œå»ºè®®æå‰åˆ›å»ºï¼‰</span>
                    .id(product.getSku())       <span class="hljs-comment">// æŒ‡å®šæ–‡æ¡£idï¼ˆä¸å•†å“skuä¸€è‡´ï¼Œä¾¿äºåç»­æŸ¥è¯¢å’Œä¿®æ”¹ï¼‰</span>
                    .document(product)          <span class="hljs-comment">// ä¼ å…¥è¦æ’å…¥çš„å®ä½“å¯¹è±¡ï¼ˆè‡ªåŠ¨åºåˆ—åŒ–ä¸ºJSONï¼‰</span>
                    .refresh(<span class="hljs-literal">true</span>)              <span class="hljs-comment">// æ’å…¥åç«‹å³åˆ·æ–°ç´¢å¼•ï¼ˆä¾¿äºç«‹å³æŸ¥è¯¢åˆ°ï¼Œç”Ÿäº§ç¯å¢ƒå¯æ ¹æ®æ€§èƒ½è°ƒæ•´ï¼‰</span>
            );

            <span class="hljs-comment">// 4. æ‰§è¡Œæ’å…¥æ“ä½œï¼Œè·å–å“åº”ç»“æœ</span>
            IndexResponse response = client.index(request);

            <span class="hljs-comment">// 5. è§£æå“åº”ç»“æœ</span>
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"æ–‡æ¡£æ’å…¥æˆåŠŸï¼"</span>);
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"ç´¢å¼•åç§°ï¼š"</span> + response.index());
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"æ–‡æ¡£idï¼š"</span> + response.id());
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"æ’å…¥çŠ¶æ€ï¼š"</span> + response.result()); <span class="hljs-comment">// createdï¼ˆæ–°å¢ï¼‰/ updatedï¼ˆè¦†ç›–ï¼‰</span>

        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"æ–‡æ¡£æ’å…¥å¤±è´¥ï¼š"</span> + e.getMessage());
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">// é¡¹ç›®åœæ­¢æ—¶å…³é—­å®¢æˆ·ç«¯ï¼ˆå®é™…å¼€å‘ä¸­å¯åœ¨Springé”€æ¯æ–¹æ³•ä¸­è°ƒç”¨ï¼‰</span>
            <span class="hljs-comment">// EsClientUtil.closeClient();</span>
        }
    }
}
</code></pre>
<p><strong>æ–¹å¼2ï¼šBuilderæ¨¡å¼</strong></p>
<p>Builderæ¨¡å¼æ›´çµæ´»ï¼Œå¯åŠ¨æ€è®¾ç½®è¯·æ±‚å‚æ•°ï¼ˆå¦‚æ¡ä»¶åˆ¤æ–­åè®¾ç½®refreshã€timeoutç­‰ï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.IndexRequest;

<span class="hljs-comment">/**
 * å•æ¡æ’å…¥æ–‡æ¡£ï¼ˆBuilderæ¨¡å¼ï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EsDocumentInsertByBuilder</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">ElasticsearchClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> EsClientUtil.getEsClient();

            <span class="hljs-comment">// 1. æ„å»ºå•†å“æ•°æ®</span>
            <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>(<span class="hljs-string">"sku002"</span>, <span class="hljs-string">"åä¸ºMate 60"</span>, <span class="hljs-number">6999.0</span>);

            <span class="hljs-comment">// 2. æ„å»ºæ’å…¥è¯·æ±‚Builder</span>
            IndexRequest.Builder&lt;Product&gt; requestBuilder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IndexRequest</span>.Builder&lt;Product&gt;();
            requestBuilder.index(<span class="hljs-string">"products"</span>);          <span class="hljs-comment">// æŒ‡å®šç´¢å¼•</span>
            requestBuilder.id(product.getSku());       <span class="hljs-comment">// æŒ‡å®šæ–‡æ¡£id</span>
            requestBuilder.document(product);          <span class="hljs-comment">// ä¼ å…¥å®ä½“å¯¹è±¡</span>
            requestBuilder.refresh(<span class="hljs-literal">true</span>);              <span class="hljs-comment">// ç«‹å³åˆ·æ–°</span>

            <span class="hljs-comment">// 3. æ„å»ºè¯·æ±‚å¹¶æ‰§è¡Œ</span>
            <span class="hljs-type">IndexResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> client.index(requestBuilder.build());

            <span class="hljs-comment">// 4. è§£æå“åº”</span>
            System.out.println(<span class="hljs-string">"Builderæ¨¡å¼æ’å…¥æˆåŠŸï¼Œæ–‡æ¡£idï¼š"</span> + response.id());

        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<p><strong>2.3.2 æ‰¹é‡æ’å…¥æ–‡æ¡£</strong></p>
<p>å½“éœ€è¦æ’å…¥å¤šæ¡æ–‡æ¡£æ—¶ï¼ˆå¦‚æ•°æ®å¯¼å…¥ï¼‰ï¼Œä½¿ç”¨æ‰¹é‡æ’å…¥å¯å¤§å¹…æå‡æ•ˆç‡ï¼Œé¿å…å•æ¡æ’å…¥é¢‘ç¹è¯·æ±‚ESæœåŠ¡ç«¯ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.BulkRequest;
<span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.BulkResponse;
<span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.bulk.BulkOperation;

<span class="hljs-keyword">import</span> java.util.ArrayList;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * æ‰¹é‡æ’å…¥æ–‡æ¡£ï¼ˆæ¨èç”¨äºå¤šæ¡æ•°æ®å¯¼å…¥åœºæ™¯ï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EsDocumentBulkInsert</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">ElasticsearchClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> EsClientUtil.getEsClient();

            <span class="hljs-comment">// 1. æ¨¡æ‹Ÿæ‰¹é‡å•†å“æ•°æ®ï¼ˆå®é™…å¼€å‘ä¸­å¯ä»æ•°æ®åº“ã€æ–‡ä»¶ä¸­è¯»å–ï¼‰</span>
            List&lt;Product&gt; productList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
            productList.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>(<span class="hljs-string">"sku003"</span>, <span class="hljs-string">"å°ç±³14"</span>, <span class="hljs-number">4999.0</span>));
            productList.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>(<span class="hljs-string">"sku004"</span>, <span class="hljs-string">"OPPO Find X7"</span>, <span class="hljs-number">5999.0</span>));
            productList.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>(<span class="hljs-string">"sku005"</span>, <span class="hljs-string">"vivo X100"</span>, <span class="hljs-number">5499.0</span>));

            <span class="hljs-comment">// 2. æ„å»ºæ‰¹é‡è¯·æ±‚Builder</span>
            BulkRequest.<span class="hljs-type">Builder</span> <span class="hljs-variable">bulkBuilder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BulkRequest</span>.Builder();

            <span class="hljs-comment">// 3. éå†å•†å“åˆ—è¡¨ï¼Œæ·»åŠ æ‰¹é‡æ“ä½œï¼ˆæ¯æ¡æ•°æ®å¯¹åº”ä¸€ä¸ªindexæ“ä½œï¼‰</span>
            <span class="hljs-keyword">for</span> (Product product : productList) {
                bulkBuilder.operations(op -&gt; op
                        .index(idx -&gt; idx          <span class="hljs-comment">// æ¯æ¡æ“ä½œéƒ½æ˜¯æ’å…¥æ“ä½œ</span>
                                .index(<span class="hljs-string">"products"</span>)  <span class="hljs-comment">// æŒ‡å®šç´¢å¼•</span>
                                .id(product.getSku()) <span class="hljs-comment">// æŒ‡å®šæ–‡æ¡£id</span>
                                .document(product)  <span class="hljs-comment">// ä¼ å…¥å•†å“æ•°æ®</span>
                        )
                );
            }

            <span class="hljs-comment">// 4. æ‰§è¡Œæ‰¹é‡æ’å…¥ï¼Œè·å–å“åº”</span>
            <span class="hljs-type">BulkResponse</span> <span class="hljs-variable">bulkResponse</span> <span class="hljs-operator">=</span> client.bulk(bulkBuilder.build());

            <span class="hljs-comment">// 5. è§£ææ‰¹é‡å“åº”ç»“æœï¼ˆæ‰¹é‡æ“ä½œå¯èƒ½éƒ¨åˆ†æˆåŠŸã€éƒ¨åˆ†å¤±è´¥ï¼Œéœ€æ ¡éªŒï¼‰</span>
            <span class="hljs-keyword">if</span> (bulkResponse.errors()) {
                System.out.println(<span class="hljs-string">"æ‰¹é‡æ’å…¥å­˜åœ¨å¤±è´¥é¡¹ï¼Œè¯¦æƒ…å¦‚ä¸‹ï¼š"</span>);
                bulkResponse.items().forEach(item -&gt; {
                    <span class="hljs-keyword">if</span> (item.error() != <span class="hljs-literal">null</span>) {
                        System.out.println(<span class="hljs-string">"æ–‡æ¡£idï¼š"</span> + item.id() + <span class="hljs-string">"ï¼Œæ’å…¥å¤±è´¥ï¼š"</span> + item.error().reason());
                    }
                });
            } <span class="hljs-keyword">else</span> {
                System.out.println(<span class="hljs-string">"æ‰¹é‡æ’å…¥å…¨éƒ¨æˆåŠŸï¼"</span>);
                System.out.println(<span class="hljs-string">"æ’å…¥æ€»æ•°ï¼š"</span> + productList.size());
            }

        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
            System.out.println(<span class="hljs-string">"æ‰¹é‡æ’å…¥å¤±è´¥ï¼š"</span> + e.getMessage());
        }
    }
}
</code></pre>
<p><strong>2.3.3 è¡¥å……ï¼šåˆ›å»ºç´¢å¼•ï¼ˆæ¨èæå‰åˆ›å»ºï¼‰</strong></p>
<p>è™½ç„¶ESä¼šè‡ªåŠ¨åˆ›å»ºä¸å­˜åœ¨çš„ç´¢å¼•ï¼Œä½†è‡ªåŠ¨åˆ›å»ºçš„ç´¢å¼•å­—æ®µç±»å‹å¯èƒ½ä¸ç¬¦åˆé¢„æœŸï¼ˆå¦‚priceå¯èƒ½è¢«è¯†åˆ«ä¸ºtextç±»å‹ï¼Œæ— æ³•è¿›è¡ŒèŒƒå›´æŸ¥è¯¢ï¼‰ï¼Œå»ºè®®æå‰æ‰‹åŠ¨åˆ›å»ºç´¢å¼•ï¼ŒæŒ‡å®šå­—æ®µç±»å‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.indices.CreateIndexRequest;
<span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.indices.CreateIndexResponse;

<span class="hljs-comment">/**
 * æ‰‹åŠ¨åˆ›å»ºproductsç´¢å¼•ï¼ˆæŒ‡å®šå­—æ®µç±»å‹ï¼Œæ¨èæå‰åˆ›å»ºï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EsIndexCreate</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">ElasticsearchClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> EsClientUtil.getEsClient();

            <span class="hljs-comment">// æ„å»ºåˆ›å»ºç´¢å¼•è¯·æ±‚ï¼ŒæŒ‡å®šå­—æ®µæ˜ å°„ï¼ˆmappingï¼‰</span>
            <span class="hljs-type">CreateIndexRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> CreateIndexRequest.of(c -&gt; c
                    .index(<span class="hljs-string">"products"</span>)          <span class="hljs-comment">// ç´¢å¼•åç§°</span>
                    .mappings(m -&gt; m            <span class="hljs-comment">// å­—æ®µæ˜ å°„é…ç½®</span>
                            .properties(<span class="hljs-string">"sku"</span>, p -&gt; p.keyword())  <span class="hljs-comment">// skuï¼škeywordç±»å‹ï¼ˆç²¾ç¡®åŒ¹é…ï¼Œä¸åˆ†è¯ï¼‰</span>
                            .properties(<span class="hljs-string">"name"</span>, p -&gt; p.text())     <span class="hljs-comment">// nameï¼štextç±»å‹ï¼ˆæ”¯æŒå…¨æ–‡æ£€ç´¢ï¼Œåˆ†è¯ï¼‰</span>
                            .properties(<span class="hljs-string">"price"</span>, p -&gt; p.double_()) <span class="hljs-comment">// priceï¼šdoubleç±»å‹ï¼ˆæ”¯æŒæ•°å€¼è¿ç®—ã€èŒƒå›´æŸ¥è¯¢ï¼‰</span>
                    )
            );

            <span class="hljs-comment">// æ‰§è¡Œåˆ›å»ºæ“ä½œ</span>
            <span class="hljs-type">CreateIndexResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> client.indices().create(request);

            <span class="hljs-keyword">if</span> (response.acknowledged()) {
                System.out.println(<span class="hljs-string">"productsç´¢å¼•åˆ›å»ºæˆåŠŸï¼"</span>);
            } <span class="hljs-keyword">else</span> {
                System.out.println(<span class="hljs-string">"productsç´¢å¼•åˆ›å»ºå¤±è´¥ï¼"</span>);
            }

        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-comment">// è‹¥ç´¢å¼•å·²å­˜åœ¨ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¯å¿½ç•¥æˆ–æ•è·å¤„ç†</span>
            <span class="hljs-keyword">if</span> (e.getMessage().contains(<span class="hljs-string">"resource_already_exists_exception"</span>)) {
                System.out.println(<span class="hljs-string">"productsç´¢å¼•å·²å­˜åœ¨ï¼Œæ— éœ€é‡å¤åˆ›å»ºï¼"</span>);
            } <span class="hljs-keyword">else</span> {
                e.printStackTrace();
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-9">2.4 æ£€ç´¢æ“ä½œï¼ˆæ ¸å¿ƒé‡ç‚¹ï¼‰</h3>
<p>ESçš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºæ£€ç´¢ï¼Œæ–°å®¢æˆ·ç«¯æ”¯æŒå…¨æ–‡æ£€ç´¢ã€ç²¾ç¡®æ£€ç´¢ã€ç»„åˆæ£€ç´¢ç­‰å¸¸è§åœºæ™¯ï¼Œä»¥ä¸‹ç»“åˆå•†å“åœºæ™¯è¯¦ç»†æ¼”ç¤ºï¼Œæ‰€æœ‰ç¤ºä¾‹å‡åŸºäº<code>products</code>ç´¢å¼•å’Œæ‰¹é‡æ’å…¥çš„æ•°æ®ã€‚</p>
<p><strong>2.4.1 å…¨æ–‡æ£€ç´¢ï¼ˆmatchAll/matchï¼‰</strong></p>
<p>å…¨æ–‡æ£€ç´¢é€‚ç”¨äºæ¨¡ç³ŠæŸ¥è¯¢åœºæ™¯ï¼ˆå¦‚æ ¹æ®å•†å“åç§°æœç´¢ï¼‰ï¼ŒESä¼šå¯¹æŸ¥è¯¢å…³é”®è¯è¿›è¡Œåˆ†è¯ï¼ŒåŒ¹é…æ‰€æœ‰åŒ…å«åˆ†è¯ç»“æœçš„æ–‡æ¡£ã€‚</p>
<p><strong>åœºæ™¯1ï¼šæŸ¥è¯¢æ‰€æœ‰æ–‡æ¡£ï¼ˆmatchAllï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.SearchRequest;
<span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.SearchResponse;
<span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.search.Hit;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * å…¨æ–‡æ£€ç´¢ - æŸ¥è¯¢æ‰€æœ‰æ–‡æ¡£ï¼ˆmatchAllï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EsSearchMatchAll</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">ElasticsearchClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> EsClientUtil.getEsClient();

            <span class="hljs-comment">// 1. æ„å»ºæŸ¥è¯¢è¯·æ±‚ï¼ˆæŸ¥è¯¢productsç´¢å¼•ä¸‹æ‰€æœ‰æ–‡æ¡£ï¼‰</span>
            <span class="hljs-type">SearchRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> SearchRequest.of(s -&gt; s
                    .index(<span class="hljs-string">"products"</span>)          <span class="hljs-comment">// æŒ‡å®šç´¢å¼•</span>
                    .query(q -&gt; q.matchAll(m -&gt; m)) <span class="hljs-comment">// å…¨æ–‡æ£€ç´¢ - åŒ¹é…æ‰€æœ‰æ–‡æ¡£</span>
            );

            <span class="hljs-comment">// 2. æ‰§è¡ŒæŸ¥è¯¢ï¼Œè·å–å“åº”</span>
            SearchResponse&lt;Product&gt; response = client.search(request, Product.class);

            <span class="hljs-comment">// 3. è§£æå“åº”ç»“æœï¼ˆè·å–å‘½ä¸­çš„æ–‡æ¡£åˆ—è¡¨ï¼‰</span>
            List&lt;Hit&lt;Product&gt;&gt; hits = response.hits().hits();
            System.out.println(<span class="hljs-string">"æŸ¥è¯¢åˆ°çš„æ–‡æ¡£æ€»æ•°ï¼š"</span> + response.hits().total().value());
            System.out.println(<span class="hljs-string">"æŸ¥è¯¢ç»“æœè¯¦æƒ…ï¼š"</span>);

            <span class="hljs-comment">// éå†æ–‡æ¡£åˆ—è¡¨ï¼Œè·å–å•†å“ä¿¡æ¯</span>
            <span class="hljs-keyword">for</span> (Hit&lt;Product&gt; hit : hits) {
                <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> hit.source(); <span class="hljs-comment">// ååºåˆ—åŒ–ä¸ºProductå®ä½“</span>
                System.out.println(<span class="hljs-string">"æ–‡æ¡£idï¼š"</span> + hit.id() + <span class="hljs-string">"ï¼Œå•†å“ä¿¡æ¯ï¼š"</span> + product);
            }

        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<p><strong>åœºæ™¯2ï¼šæ ¹æ®å…³é”®è¯æ¨¡ç³ŠæŸ¥è¯¢ï¼ˆmatchï¼‰</strong></p>
<p>æ ¹æ®å•†å“åç§°æ¨¡ç³ŠæŸ¥è¯¢ï¼ˆå¦‚æœç´¢â€œ14â€ï¼Œä¼šåŒ¹é…â€œè‹¹æœ14 Proâ€ã€â€œå°ç±³14â€ï¼‰ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">/**
 * å…¨æ–‡æ£€ç´¢ - å…³é”®è¯æ¨¡ç³ŠæŸ¥è¯¢ï¼ˆmatchï¼‰
 */</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">EsSearchMatch</span> {
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">static</span> <span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">main</span>(String[] args) {
        <span class="hljs-selector-tag">try</span> {
            <span class="hljs-selector-tag">ElasticsearchClient</span> <span class="hljs-selector-tag">client</span> = <span class="hljs-selector-tag">EsClientUtil</span><span class="hljs-selector-class">.getEsClient</span>();

            <span class="hljs-comment">// 1. æ„å»ºæŸ¥è¯¢è¯·æ±‚ï¼ˆæ ¹æ®å•†å“åç§°æ¨¡ç³ŠæŸ¥è¯¢ï¼Œå…³é”®è¯ï¼š14ï¼‰</span>
            <span class="hljs-selector-tag">SearchRequest</span> <span class="hljs-selector-tag">request</span> = <span class="hljs-selector-tag">SearchRequest</span><span class="hljs-selector-class">.of</span>(s -&gt; s
                    .<span class="hljs-built_in">index</span>(<span class="hljs-string">"products"</span>)
                    .<span class="hljs-built_in">query</span>(q -&gt; q
                            .<span class="hljs-built_in">match</span>(m -&gt; m
                                    .<span class="hljs-built_in">field</span>(<span class="hljs-string">"name"</span>)     <span class="hljs-comment">// æ£€ç´¢çš„å­—æ®µï¼ˆå•†å“åç§°ï¼‰</span>
                                    .<span class="hljs-built_in">query</span>(<span class="hljs-string">"14"</span>)       <span class="hljs-comment">// æ£€ç´¢å…³é”®è¯</span>
                                    .<span class="hljs-built_in">fuzziness</span>(<span class="hljs-string">"AUTO"</span>) <span class="hljs-comment">// æ¨¡ç³ŠåŒ¹é…ï¼ˆå…è®¸è½»å¾®æ‹¼å†™é”™è¯¯ï¼Œå¦‚14å†™æˆ15ï¼Œå¯æ ¹æ®éœ€æ±‚å…³é—­ï¼‰</span>
                            )
                    )
            );

            <span class="hljs-comment">// 2. æ‰§è¡ŒæŸ¥è¯¢</span>
            <span class="hljs-selector-tag">SearchResponse</span>&lt;<span class="hljs-selector-tag">Product</span>&gt; <span class="hljs-selector-tag">response</span> = <span class="hljs-selector-tag">client</span><span class="hljs-selector-class">.search</span>(request, Product.class);

            <span class="hljs-comment">// 3. è§£æç»“æœ</span>
            <span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">Hit</span>&lt;<span class="hljs-selector-tag">Product</span>&gt;&gt; <span class="hljs-selector-tag">hits</span> = <span class="hljs-selector-tag">response</span><span class="hljs-selector-class">.hits</span>()<span class="hljs-selector-class">.hits</span>();
            <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"åŒ¹é…åˆ°çš„å•†å“æ•°é‡ï¼š"</span> + hits.<span class="hljs-built_in">size</span>());
            <span class="hljs-selector-tag">hits</span><span class="hljs-selector-class">.forEach</span>(hit -&gt; {
                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"å•†å“ï¼š"</span> + hit.<span class="hljs-built_in">source</span>().<span class="hljs-built_in">getName</span>() + <span class="hljs-string">"ï¼Œä»·æ ¼ï¼š"</span> + hit.<span class="hljs-built_in">source</span>().<span class="hljs-built_in">getPrice</span>());
            });

        } <span class="hljs-selector-tag">catch</span> (Exception e) {
            <span class="hljs-selector-tag">e</span><span class="hljs-selector-class">.printStackTrace</span>();
        }
    }
}
</code></pre>
<p><strong>2.4.2 ç²¾ç¡®æ£€ç´¢ï¼ˆterm/rangeï¼‰</strong></p>
<p>ç²¾ç¡®æ£€ç´¢é€‚ç”¨äºæ— éœ€åˆ†è¯ã€ç²¾å‡†åŒ¹é…çš„åœºæ™¯ï¼Œå¸¸è§ä¸¤ç§ç±»å‹ï¼š<code>term</code>ï¼ˆè¯æ¡ç²¾ç¡®åŒ¹é…ï¼‰å’Œ<code>range</code>ï¼ˆèŒƒå›´åŒ¹é…ï¼‰ã€‚</p>
<p><strong>åœºæ™¯1ï¼štermç²¾ç¡®åŒ¹é…ï¼ˆkeywordå­—æ®µæ¨èï¼‰</strong></p>
<p>é€‚ç”¨äºåŒ¹é…å›ºå®šè¯æ¡ï¼ˆå¦‚æ ¹æ®skuæŸ¥è¯¢å•†å“ã€æ ¹æ®å•†å“åç§°ç²¾ç¡®åŒ¹é…ï¼‰ï¼Œæ³¨æ„ï¼štextç±»å‹å­—æ®µä½¿ç”¨termæŸ¥è¯¢å¯èƒ½æ— æ³•åŒ¹é…ï¼ˆå› textä¼šåˆ†è¯ï¼‰ï¼Œæ¨èç”¨äºkeywordå­—æ®µã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">/**
 * ç²¾ç¡®æ£€ç´¢ - termè¯æ¡åŒ¹é…ï¼ˆé€‚ç”¨äºkeywordå­—æ®µï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">EsSearchTerm</span> {
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>)</span> {
        <span class="hljs-keyword">try</span> {
            ElasticsearchClient client = EsClientUtil.getEsClient();

            <span class="hljs-comment">// 1. æ„å»ºæŸ¥è¯¢è¯·æ±‚ï¼ˆæ ¹æ®skuç²¾ç¡®æŸ¥è¯¢å•†å“ï¼Œskuä¸ºkeywordå­—æ®µï¼‰</span>
            SearchRequest request = SearchRequest.of(s -&gt; s
                    .index(<span class="hljs-string">"products"</span>)
                    .query(q -&gt; q
                            .term(t -&gt; t
                                    .field(<span class="hljs-string">"sku"</span>)      <span class="hljs-comment">// æ£€ç´¢å­—æ®µï¼ˆskuï¼Œkeywordç±»å‹ï¼‰</span>
                                    .<span class="hljs-keyword">value</span>(<span class="hljs-string">"sku001"</span>)   <span class="hljs-comment">// ç²¾ç¡®åŒ¹é…çš„å€¼</span>
                            )
                    )
            );

            <span class="hljs-comment">// 2. æ‰§è¡ŒæŸ¥è¯¢</span>
            SearchResponse&lt;Product&gt; response = client.search(request, Product.<span class="hljs-keyword">class</span>);

            <span class="hljs-comment">// 3. è§£æç»“æœ</span>
            List&lt;Hit&lt;Product&gt;&gt; hits = response.hits().hits();
            <span class="hljs-keyword">if</span> (hits.isEmpty()) {
                System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"æœªæŸ¥è¯¢åˆ°å¯¹åº”å•†å“ï¼"</span>);
            } <span class="hljs-keyword">else</span> {
                Product product = hits.<span class="hljs-keyword">get</span>(<span class="hljs-number">0</span>).source();
                System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"ç²¾ç¡®æŸ¥è¯¢åˆ°çš„å•†å“ï¼š"</span> + product);
            }

        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<p><strong>åœºæ™¯2ï¼šrangeèŒƒå›´æŸ¥è¯¢ï¼ˆæ•°å€¼å­—æ®µæ¨èï¼‰</strong></p>
<p>é€‚ç”¨äºæ•°å€¼ã€æ—¥æœŸç­‰å­—æ®µçš„èŒƒå›´åŒ¹é…ï¼ˆå¦‚æŸ¥è¯¢ä»·æ ¼åœ¨5000-8000ä¹‹é—´çš„å•†å“ï¼‰ï¼ŒES 9.Xä¸­æ•°å€¼ç±»å‹çš„rangeæŸ¥è¯¢éœ€ä½¿ç”¨<code>number</code>å‡½æ•°ï¼Œé¿å…è¸©å‘ï¼</p>
<pre><code class="hljs language-ini" lang="ini">import co.elastic.clients.elasticsearch.core.search.RangeQuery<span class="hljs-comment">;</span>

/**
 * ç²¾ç¡®æ£€ç´¢ - rangeèŒƒå›´æŸ¥è¯¢ï¼ˆé€‚ç”¨äºæ•°å€¼ã€æ—¥æœŸå­—æ®µï¼‰
 */
public class EsSearchRange {
    public static void main(String<span class="hljs-section">[]</span> args) {
        try {
            ElasticsearchClient <span class="hljs-attr">client</span> = EsClientUtil.getEsClient()<span class="hljs-comment">;</span>

            // 1. æ„å»ºrangeæŸ¥è¯¢æ¡ä»¶ï¼ˆä»·æ ¼èŒƒå›´ï¼š5000 â‰¤ price â‰¤ 8000ï¼‰
            RangeQuery <span class="hljs-attr">rangeQuery</span> = RangeQuery.of(r -&gt; r
                    .number(n -&gt; n            // å¿…é¡»ä½¿ç”¨numberå‡½æ•°ï¼ˆæ•°å€¼ç±»å‹ä¸“ç”¨ï¼‰ï¼Œä¸å¯ç›´æ¥ç”¨field
                            .field("price")  // æ£€ç´¢å­—æ®µï¼ˆpriceï¼Œdoubleç±»å‹ï¼‰
                            .gte(5000.0)     // å¤§äºç­‰äºï¼ˆ<span class="hljs-attr">gte</span> = greater than or equalï¼‰
                            .lte(8000.0)     // å°äºç­‰äºï¼ˆ<span class="hljs-attr">lte</span> = less than or equalï¼‰
                            // å¯é€‰ï¼šgtï¼ˆå¤§äºï¼‰ã€ltï¼ˆå°äºï¼‰
                    )
            )<span class="hljs-comment">;</span>

            // 2. æ„å»ºæŸ¥è¯¢è¯·æ±‚ï¼Œä¼ å…¥rangeæŸ¥è¯¢æ¡ä»¶
            SearchRequest <span class="hljs-attr">request</span> = SearchRequest.of(s -&gt; s
                    .index("products")
                    .query(q -&gt; q.range(rangeQuery)) // æ‰§è¡ŒrangeæŸ¥è¯¢
            )<span class="hljs-comment">;</span>

            // 3. æ‰§è¡ŒæŸ¥è¯¢å¹¶è§£æç»“æœ
            SearchResponse&lt;Product&gt; <span class="hljs-attr">response</span> = client.search(request, Product.class)<span class="hljs-comment">;</span>
            List&lt;Hit&lt;Product&gt;&gt; <span class="hljs-attr">hits</span> = response.hits().hits()<span class="hljs-comment">;</span>
            System.out.println("ä»·æ ¼åœ¨5000-8000ä¹‹é—´çš„å•†å“æ•°é‡ï¼š" + hits.size())<span class="hljs-comment">;</span>
            hits.forEach(hit -&gt; {
                Product <span class="hljs-attr">product</span> = hit.source()<span class="hljs-comment">;</span>
                System.out.println("å•†å“åç§°ï¼š" + product.getName() + "ï¼Œä»·æ ¼ï¼š" + product.getPrice())<span class="hljs-comment">;</span>
            })<span class="hljs-comment">;</span>

        } catch (Exception e) {
            e.printStackTrace()<span class="hljs-comment">;</span>
        }
    }
}
</code></pre>
<p><strong>2.4.3 ç»„åˆæ£€ç´¢ï¼ˆBool Queryï¼‰</strong></p>
<p>å®é™…ä¸šåŠ¡ä¸­ï¼Œæ£€ç´¢æ¡ä»¶å¾€å¾€æ˜¯å¤šä¸ªæ¡ä»¶çš„ç»„åˆï¼ˆå¦‚â€œå•†å“åç§°åŒ…å«14â€ä¸”â€œä»·æ ¼åœ¨5000ä»¥ä¸Šâ€ä¸”â€œæ’é™¤sku001â€ï¼‰ï¼Œæ­¤æ—¶éœ€ä½¿ç”¨<code>Bool Query</code>ç»„åˆå¤šä¸ªæŸ¥è¯¢æ¡ä»¶ã€‚</p>
<p>Bool Queryæ ¸å¿ƒå­å¥ï¼ˆå¿…æ‡‚ï¼‰ï¼š</p>
<ul>
<li><code>must</code>ï¼šå¿…é¡»æ»¡è¶³è¯¥æ¡ä»¶ï¼ˆå‚ä¸è¯„åˆ†ï¼Œå½±å“æŸ¥è¯¢ç»“æœæ’åºï¼‰</li>
<li><code>mustNot</code>ï¼šå¿…é¡»ä¸æ»¡è¶³è¯¥æ¡ä»¶ï¼ˆä¸å‚ä¸è¯„åˆ†ï¼‰</li>
<li><code>filter</code>ï¼šå¿…é¡»æ»¡è¶³è¯¥æ¡ä»¶ï¼ˆä¸å‚ä¸è¯„åˆ†ï¼Œå¯ç¼“å­˜ï¼Œæå‡æŸ¥è¯¢æ€§èƒ½ï¼‰</li>
<li><code>should</code>ï¼šå¯é€‰æ»¡è¶³è¯¥æ¡ä»¶ï¼ˆæ»¡è¶³ä¼šå¢åŠ è¯„åˆ†ï¼Œä¸æ»¡è¶³ä¸å½±å“ï¼‰</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.search.BoolQuery;
<span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.search.MatchQuery;
<span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.search.Query;
<span class="hljs-keyword">import</span> co.elastic.clients.elasticsearch.core.search.TermQuery;

<span class="hljs-comment">/**
 * ç»„åˆæ£€ç´¢ - Bool Queryï¼ˆå¤šæ¡ä»¶ç»„åˆæŸ¥è¯¢ï¼Œå®é™…ä¸šåŠ¡é«˜é¢‘ä½¿ç”¨ï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EsSearchBool</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">ElasticsearchClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> EsClientUtil.getEsClient();

            <span class="hljs-comment">// 1. æ„å»ºå­æŸ¥è¯¢æ¡ä»¶</span>
            <span class="hljs-comment">// å­æŸ¥è¯¢1ï¼šå•†å“åç§°åŒ…å«"14"ï¼ˆmustï¼Œå¿…é¡»æ»¡è¶³ï¼Œå‚ä¸è¯„åˆ†ï¼‰</span>
            <span class="hljs-type">Query</span> <span class="hljs-variable">nameQuery</span> <span class="hljs-operator">=</span> MatchQuery.of(m -&gt; m
                    .field(<span class="hljs-string">"name"</span>)
                    .query(<span class="hljs-string">"14"</span>)
            )._toQuery(); <span class="hljs-comment">// è½¬æ¢ä¸ºé€šç”¨Queryç±»å‹</span>

            <span class="hljs-comment">// å­æŸ¥è¯¢2ï¼šä»·æ ¼å¤§äº5000ï¼ˆfilterï¼Œå¿…é¡»æ»¡è¶³ï¼Œä¸å‚ä¸è¯„åˆ†ï¼Œæå‡æ€§èƒ½ï¼‰</span>
            <span class="hljs-type">RangeQuery</span> <span class="hljs-variable">priceRangeQuery</span> <span class="hljs-operator">=</span> RangeQuery.of(r -&gt; r
                    .number(n -&gt; n
                            .field(<span class="hljs-string">"price"</span>)
                            .gt(<span class="hljs-number">5000.0</span>) <span class="hljs-comment">// å¤§äº5000ï¼ˆgt = greater thanï¼‰</span>
                    )
            );
            <span class="hljs-type">Query</span> <span class="hljs-variable">priceFilterQuery</span> <span class="hljs-operator">=</span> priceRangeQuery._toQuery();

            <span class="hljs-comment">// å­æŸ¥è¯¢3ï¼šæ’é™¤sku001ï¼ˆmustNotï¼Œå¿…é¡»ä¸æ»¡è¶³ï¼‰</span>
            <span class="hljs-type">Query</span> <span class="hljs-variable">excludeSkuQuery</span> <span class="hljs-operator">=</span> TermQuery.of(t -&gt; t
                    .field(<span class="hljs-string">"sku"</span>)
                    .value(<span class="hljs-string">"sku001"</span>)
            )._toQuery();

            <span class="hljs-comment">// 2. ç»„åˆBool Queryï¼ˆå°†å¤šä¸ªå­æŸ¥è¯¢ç»„åˆèµ·æ¥ï¼‰</span>
            <span class="hljs-type">BoolQuery</span> <span class="hljs-variable">boolQuery</span> <span class="hljs-operator">=</span> BoolQuery.of(b -&gt; b
                    .must(nameQuery)           <span class="hljs-comment">// å¿…é¡»æ»¡è¶³ï¼šåç§°åŒ…å«14</span>
                    .filter(priceFilterQuery)  <span class="hljs-comment">// å¿…é¡»æ»¡è¶³ï¼šä»·æ ¼&gt;5000ï¼ˆè¿‡æ»¤ï¼Œä¸è¯„åˆ†ï¼‰</span>
                    .mustNot(excludeSkuQuery)  <span class="hljs-comment">// å¿…é¡»ä¸æ»¡è¶³ï¼šsku != sku001</span>
            );

            <span class="hljs-comment">// 3. æ„å»ºæŸ¥è¯¢è¯·æ±‚ï¼Œæ‰§è¡ŒBoolæŸ¥è¯¢</span>
            <span class="hljs-type">SearchRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> SearchRequest.of(s -&gt; s
                    .index(<span class="hljs-string">"products"</span>)
                    .query(q -&gt; q.bool(boolQuery)) <span class="hljs-comment">// ä¼ å…¥ç»„åˆå¥½çš„BoolæŸ¥è¯¢</span>
            );

            <span class="hljs-comment">// 4. æ‰§è¡ŒæŸ¥è¯¢å¹¶è§£æç»“æœ</span>
            SearchResponse&lt;Product&gt; response = client.search(request, Product.class);
            List&lt;Hit&lt;Product&gt;&gt; hits = response.hits().hits();
            System.out.println(<span class="hljs-string">"ç»„åˆæŸ¥è¯¢åŒ¹é…åˆ°çš„å•†å“æ•°é‡ï¼š"</span> + hits.size());
            hits.forEach(hit -&gt; {
                <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> hit.source();
                System.out.println(<span class="hljs-string">"å•†å“ï¼š"</span> + product.getName() + <span class="hljs-string">"ï¼Œskuï¼š"</span> + product.getSku() + <span class="hljs-string">"ï¼Œä»·æ ¼ï¼š"</span> + product.getPrice());
            });

        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<h3 data-id="heading-10">2.5 åˆ†é¡µä¸æ’åº</h3>
<p>å®é™…å¼€å‘ä¸­ï¼Œæ£€ç´¢ç»“æœå¾€å¾€éœ€è¦åˆ†é¡µï¼ˆå¦‚å‰ç«¯åˆ—è¡¨åˆ†é¡µï¼‰å’Œæ’åºï¼ˆå¦‚æŒ‰ä»·æ ¼å‡åº/é™åºï¼‰ï¼ŒES 9.Xå®¢æˆ·ç«¯æ”¯æŒçµæ´»çš„åˆ†é¡µæ’åºé…ç½®ï¼Œä»¥ä¸‹ç»“åˆå•†å“åœºæ™¯æ¼”ç¤ºã€‚</p>
<p><strong>2.5.1 åŸºç¡€åˆ†é¡µæ’åºï¼ˆfrom+sizeï¼‰</strong></p>
<p>é€‚ç”¨äºæµ…åˆ†é¡µåœºæ™¯ï¼ˆæ•°æ®é‡è¾ƒå°ï¼Œåˆ†é¡µæ·±åº¦è¾ƒæµ…ï¼‰ï¼Œæ ¸å¿ƒå‚æ•°ï¼š</p>
<ul>
<li><code>from</code>ï¼šèµ·å§‹åç§»é‡ï¼ˆä»ç¬¬å‡ æ¡æ•°æ®å¼€å§‹æŸ¥è¯¢ï¼Œé»˜è®¤0ï¼‰</li>
<li><code>size</code>ï¼šæ¯é¡µæ˜¾ç¤ºæ¡æ•°</li>
<li><code>sort</code>ï¼šæ’åºé…ç½®ï¼ˆæŒ‡å®šæ’åºå­—æ®µå’Œæ’åºæ–¹å‘ï¼‰</li>
</ul>
<p>æ³¨æ„ï¼šfrom+sizeæ–¹å¼åœ¨æ·±åº¦åˆ†é¡µï¼ˆå¦‚from=10000ï¼Œsize=10ï¼‰æ—¶ä¼šå­˜åœ¨ä¸¥é‡æ€§èƒ½ç“¶é¢ˆï¼Œå› ä¸ºESéœ€è¦ä»æ¯ä¸ªåˆ†ç‰‡è¯»å–10010æ¡æ•°æ®ï¼Œå†èšåˆæ’åºåæˆªå–ç»“æœï¼Œå¤§æ•°æ®é‡åœºæ™¯å»ºè®®ä½¿ç”¨Search Afteræˆ–Scroll APIã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp">import co.elastic.clients.elasticsearch.core.search.SortOrder;

<span class="hljs-comment">/**
 * åˆ†é¡µä¸æ’åºï¼ˆåŸºç¡€from+sizeæ–¹å¼ï¼Œé€‚ç”¨äºæµ…åˆ†é¡µï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">EsSearchPageSort</span> {
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>)</span> {
        <span class="hljs-keyword">try</span> {
            ElasticsearchClient client = EsClientUtil.getEsClient();

            <span class="hljs-comment">// 1. æ¨¡æ‹Ÿå‰ç«¯åˆ†é¡µå‚æ•°ï¼ˆå®é™…å¼€å‘ä¸­ä»å‰ç«¯æ¥æ”¶ï¼‰</span>
            <span class="hljs-built_in">int</span> currentPage = <span class="hljs-number">1</span>;       <span class="hljs-comment">// å½“å‰é¡µç ï¼ˆå‰ç«¯é»˜è®¤ä»1å¼€å§‹ï¼ŒESä»0å¼€å§‹ï¼‰</span>
            <span class="hljs-built_in">int</span> pageSize = <span class="hljs-number">2</span>;          <span class="hljs-comment">// æ¯é¡µæ˜¾ç¤ºæ¡æ•°</span>
            String sortField = <span class="hljs-string">"price"</span>;<span class="hljs-comment">// æ’åºå­—æ®µï¼ˆå•†å“ä»·æ ¼ï¼‰</span>
            String sortOrder = <span class="hljs-string">"desc"</span>; <span class="hljs-comment">// æ’åºæ–¹å‘ï¼ˆdescï¼šé™åºï¼›ascï¼šå‡åºï¼‰</span>

            <span class="hljs-comment">// 2. è®¡ç®—èµ·å§‹åç§»é‡ï¼ˆfrom = (å½“å‰é¡µç -1) * æ¯é¡µæ¡æ•°ï¼‰</span>
            <span class="hljs-built_in">int</span> <span class="hljs-keyword">from</span> = (currentPage - <span class="hljs-number">1</span>) * pageSize;

            <span class="hljs-comment">// 3. æ„å»ºæŸ¥è¯¢è¯·æ±‚ï¼ˆåˆ†é¡µ+æ’åº+æ¡ä»¶æŸ¥è¯¢ï¼‰</span>
            SearchRequest request = SearchRequest.of(s -&gt; s
                    .index(<span class="hljs-string">"products"</span>)
                    .<span class="hljs-keyword">from</span>(<span class="hljs-keyword">from</span>)                <span class="hljs-comment">// èµ·å§‹åç§»é‡</span>
                    .size(pageSize)            <span class="hljs-comment">// æ¯é¡µæ¡æ•°</span>
                    .sort(so -&gt; so             <span class="hljs-comment">// æ’åºé…ç½®</span>
                            .field(f -&gt; f
                                    .field(sortField)  <span class="hljs-comment">// æ’åºå­—æ®µ</span>
                                    <span class="hljs-comment">// æ’åºæ–¹å‘ï¼šæ ¹æ®å‰ç«¯å‚æ•°åŠ¨æ€è®¾ç½®</span>
                                    .order(<span class="hljs-string">"desc"</span>.<span class="hljs-keyword">equals</span>(sortOrder) ? SortOrder.Desc : SortOrder.Asc)
                            )
                    )
                    .query(q -&gt; q              <span class="hljs-comment">// å¯é€‰ï¼šæ·»åŠ æŸ¥è¯¢æ¡ä»¶ï¼ˆå¦‚ä»·æ ¼&gt;5000ï¼‰</span>
                            .range(r -&gt; r
                                    .number(n -&gt; n
                                            .field(<span class="hljs-string">"price"</span>)
                                            .gt(<span class="hljs-number">5000.0</span>)
                                    )
                            )
                    )
            );

            <span class="hljs-comment">// 4. æ‰§è¡ŒæŸ¥è¯¢å¹¶è§£æç»“æœ</span>
            SearchResponse&lt;Product&gt; response = client.search(request, Product.<span class="hljs-keyword">class</span>);
            List&lt;Hit&lt;Product&gt;&gt; hits = response.hits().hits();

            <span class="hljs-comment">// è§£æåˆ†é¡µç›¸å…³ä¿¡æ¯</span>
            <span class="hljs-built_in">long</span> total = response.hits().total().<span class="hljs-keyword">value</span>(); <span class="hljs-comment">// æ€»æ¡æ•°</span>
            <span class="hljs-built_in">long</span> totalPage = (total + pageSize - <span class="hljs-number">1</span>) / pageSize; <span class="hljs-comment">// æ€»é¡µæ•°</span>

            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"åˆ†é¡µæŸ¥è¯¢ç»“æœï¼š"</span>);
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"æ€»æ¡æ•°ï¼š"</span> + total + <span class="hljs-string">"ï¼Œæ€»é¡µæ•°ï¼š"</span> + totalPage + <span class="hljs-string">"ï¼Œå½“å‰é¡µç ï¼š"</span> + currentPage);
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å½“å‰é¡µå•†å“ï¼š"</span>);
            hits.forEach(hit -&gt; {
                Product product = hit.source();
                System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å•†å“ï¼š"</span> + product.getName() + <span class="hljs-string">"ï¼Œä»·æ ¼ï¼š"</span> + product.getPrice());
            });

        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<p><strong>2.5.2 è¡¥å……ï¼šæ·±åº¦åˆ†é¡µè§£å†³æ–¹æ¡ˆ</strong></p>
<p>é’ˆå¯¹å¤§æ•°æ®é‡æ·±åº¦åˆ†é¡µåœºæ™¯ï¼Œæ¨èä½¿ç”¨ä»¥ä¸‹ä¸¤ç§æ–¹æ¡ˆï¼Œé¿å…from+sizeçš„æ€§èƒ½ç“¶é¢ˆï¼š</p>
<ol>
<li><strong>Search Afterï¼ˆæ¨èå®æ—¶æ·±åº¦åˆ†é¡µï¼‰</strong> ï¼šåŸºäºä¸Šä¸€é¡µæœ€åä¸€æ¡æ•°æ®çš„æ’åºå€¼ä½œä¸ºâ€œé”šç‚¹â€ï¼Œé¿å…è®¡ç®—åç§»é‡ï¼Œæ”¯æŒå®æ—¶æŸ¥è¯¢ï¼Œé€‚åˆå‰ç«¯åˆ—è¡¨åˆ†é¡µï¼ˆå¦‚APPå•†å“åˆ—è¡¨ç¿»é¡µï¼‰ã€‚</li>
<li><strong>Scroll APIï¼ˆé€‚åˆæ‰¹é‡å¯¼å‡º/æ‰¹å¤„ç†ï¼‰</strong> ï¼šåˆ›å»ºæŸ¥è¯¢å¿«ç…§ï¼Œé€šè¿‡æ¸¸æ ‡æ‰¹é‡è·å–ç»“æœï¼Œä¸æ”¯æŒ<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269982258%26content_type%3DArticle%26match_order%3D1%26q%3D%25E5%25AE%259E%25E6%2597%25B6%25E6%2595%25B0%25E6%258D%25AE%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269982258&amp;content_type=Article&amp;match_order=1&amp;q=%E5%AE%9E%E6%97%B6%E6%95%B0%E6%8D%AE&amp;zhida_source=entity" ref="nofollow noopener noreferrer">å®æ—¶æ•°æ®</a>ï¼ˆå¿«ç…§åˆ›å»ºåçš„æ•°æ®å˜æ›´ä¸ä¼šä½“ç°ï¼‰ï¼Œé€‚åˆå…¨é‡æ•°æ®å¯¼å‡ºã€ETLæµç¨‹ç­‰ç¦»çº¿åœºæ™¯ã€‚</li>
</ol>
<h3 data-id="heading-11">2.6 èšåˆæ“ä½œï¼ˆç»Ÿè®¡åˆ†æï¼‰</h3>
<p>èšåˆæ“ä½œé€‚ç”¨äº<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269982258%26content_type%3DArticle%26match_order%3D1%26q%3D%25E6%2595%25B0%25E6%258D%25AE%25E7%25BB%259F%25E8%25AE%25A1%25E5%2588%2586%25E6%259E%2590%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269982258&amp;content_type=Article&amp;match_order=1&amp;q=%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1%E5%88%86%E6%9E%90&amp;zhida_source=entity" ref="nofollow noopener noreferrer">æ•°æ®ç»Ÿè®¡åˆ†æ</a>åœºæ™¯ï¼ˆå¦‚å•†å“ä»·æ ¼å¹³å‡å€¼ã€ä¸åŒç±»åˆ«çš„å•†å“æ•°é‡ç»Ÿè®¡ï¼‰ï¼ŒES 9.Xå®¢æˆ·ç«¯æ”¯æŒåŸºç¡€èšåˆå’Œå¤šçº§åµŒå¥—èšåˆï¼Œä»¥ä¸‹ç»“åˆç¤ºä¾‹æ¼”ç¤ºã€‚</p>
<p><strong>2.6.1 åŸºç¡€èšåˆï¼ˆstats/termsï¼‰</strong></p>
<p>å¸¸è§åŸºç¡€èšåˆç±»å‹ï¼š</p>
<ul>
<li><code>stats</code>ï¼šç»Ÿè®¡èšåˆï¼ˆè®¡ç®—å­—æ®µçš„å¹³å‡å€¼ã€æœ€å¤§å€¼ã€æœ€å°å€¼ã€æ€»å’Œã€è®¡æ•°ï¼‰</li>
<li><code>terms</code>ï¼šåˆ†ç»„èšåˆï¼ˆæ ¹æ®å­—æ®µåˆ†ç»„ï¼Œç»Ÿè®¡æ¯ç»„çš„æ–‡æ¡£æ•°é‡ï¼‰</li>
</ul>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.Aggregate</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.StatsAggregate</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.StringTermsAggregate</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.StringTermsBucket</span>;

<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">java</span><span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.Map</span>;

<span class="hljs-comment">/**
 * åŸºç¡€èšåˆæ“ä½œï¼ˆstatsç»Ÿè®¡èšåˆ + termsåˆ†ç»„èšåˆï¼‰
 */</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">EsAggregationBasic</span> {
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">static</span> <span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">main</span>(String[] args) {
        <span class="hljs-selector-tag">try</span> {
            <span class="hljs-selector-tag">ElasticsearchClient</span> <span class="hljs-selector-tag">client</span> = <span class="hljs-selector-tag">EsClientUtil</span><span class="hljs-selector-class">.getEsClient</span>();

            <span class="hljs-comment">// 1. æ„å»ºåŸºç¡€æŸ¥è¯¢æ¡ä»¶ï¼ˆå¯é€‰ï¼šè¿‡æ»¤éœ€è¦ç»Ÿè®¡çš„æ•°æ®ï¼‰</span>
            <span class="hljs-selector-tag">RangeQuery</span> <span class="hljs-selector-tag">rangeQuery</span> = <span class="hljs-selector-tag">RangeQuery</span><span class="hljs-selector-class">.of</span>(r -&gt; r
                    .<span class="hljs-built_in">number</span>(n -&gt; n
                            .<span class="hljs-built_in">field</span>(<span class="hljs-string">"price"</span>)
                            .<span class="hljs-built_in">gte</span>(<span class="hljs-number">5000.0</span>)
                            .<span class="hljs-built_in">lte</span>(<span class="hljs-number">10000.0</span>)
                    )
            );

            <span class="hljs-comment">// 2. æ„å»ºæŸ¥è¯¢è¯·æ±‚ï¼Œæ·»åŠ èšåˆæ“ä½œ</span>
            <span class="hljs-selector-tag">SearchRequest</span> <span class="hljs-selector-tag">request</span> = <span class="hljs-selector-tag">SearchRequest</span><span class="hljs-selector-class">.of</span>(s -&gt; s
                    .<span class="hljs-built_in">index</span>(<span class="hljs-string">"products"</span>)
                    .<span class="hljs-built_in">query</span>(q -&gt; q.<span class="hljs-built_in">range</span>(rangeQuery)) <span class="hljs-comment">// åŸºç¡€è¿‡æ»¤æ¡ä»¶ï¼ˆä»·æ ¼5000-10000ï¼‰</span>
                    .<span class="hljs-built_in">from</span>(<span class="hljs-number">0</span>).<span class="hljs-built_in">size</span>(<span class="hljs-number">10</span>)               <span class="hljs-comment">// åˆ†é¡µï¼šåªæŸ¥è¯¢å‰10æ¡æ–‡æ¡£ï¼ˆèšåˆç»“æœä¸å—å½±å“ï¼‰</span>
                    <span class="hljs-comment">// èšåˆ1ï¼šä»·æ ¼ç»Ÿè®¡ï¼ˆstatsï¼‰ï¼Œèšåˆåç§°ï¼šprice_stats</span>
                    .<span class="hljs-built_in">aggregations</span>(<span class="hljs-string">"price_stats"</span>, a -&gt; a
                            .<span class="hljs-built_in">stats</span>(st -&gt; st.<span class="hljs-built_in">field</span>(<span class="hljs-string">"price"</span>))
                    )
                    <span class="hljs-comment">// èšåˆ2ï¼šæŒ‰å•†å“ç±»åˆ«åˆ†ç»„ï¼ˆtermsï¼‰ï¼Œèšåˆåç§°ï¼šcategory_termsï¼ˆæ­¤å¤„å‡è®¾å­˜åœ¨categoryå­—æ®µï¼‰</span>
                    .<span class="hljs-built_in">aggregations</span>(<span class="hljs-string">"category_terms"</span>, a -&gt; a
                            .<span class="hljs-built_in">terms</span>(t -&gt; t
                                    .<span class="hljs-built_in">field</span>(<span class="hljs-string">"category.keyword"</span>) <span class="hljs-comment">// categoryå­—æ®µéœ€ä¸ºkeywordç±»å‹ï¼ˆåˆ†ç»„èšåˆæ¨èï¼‰</span>
                                    .<span class="hljs-built_in">size</span>(<span class="hljs-number">10</span>)                  <span class="hljs-comment">// åªæ˜¾ç¤ºå‰10ä¸ªåˆ†ç»„</span>
                            )
                    )
            );

            <span class="hljs-comment">// 3. æ‰§è¡ŒæŸ¥è¯¢ï¼Œè·å–å“åº”</span>
            <span class="hljs-selector-tag">SearchResponse</span>&lt;<span class="hljs-selector-tag">Product</span>&gt; <span class="hljs-selector-tag">response</span> = <span class="hljs-selector-tag">client</span><span class="hljs-selector-class">.search</span>(request, Product.class);

            <span class="hljs-comment">// 4. è§£æèšåˆç»“æœï¼ˆæ ¸å¿ƒæ­¥éª¤ï¼‰</span>
            <span class="hljs-selector-tag">if</span> (response.<span class="hljs-built_in">aggregations</span>() != null) {
                <span class="hljs-selector-tag">Map</span>&lt;<span class="hljs-selector-tag">String</span>, <span class="hljs-selector-tag">Aggregate</span>&gt; <span class="hljs-selector-tag">aggregations</span> = <span class="hljs-selector-tag">response</span><span class="hljs-selector-class">.aggregations</span>();

                <span class="hljs-comment">// 4.1 è§£æä»·æ ¼ç»Ÿè®¡èšåˆï¼ˆstatsï¼‰</span>
                <span class="hljs-selector-tag">StatsAggregate</span> <span class="hljs-selector-tag">priceStats</span> = <span class="hljs-selector-tag">aggregations</span><span class="hljs-selector-class">.get</span>(<span class="hljs-string">"price_stats"</span>)<span class="hljs-selector-class">.stats</span>();
                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"å•†å“ä»·æ ¼ç»Ÿè®¡ï¼ˆ5000-10000å…ƒï¼‰ï¼š"</span>);
                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"å¹³å‡ä»·æ ¼ï¼š"</span> + String.<span class="hljs-built_in">format</span>(<span class="hljs-string">"%.2f"</span>, priceStats.<span class="hljs-built_in">avg</span>()));
                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"æœ€é«˜ä»·æ ¼ï¼š"</span> + priceStats.<span class="hljs-built_in">max</span>());
                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"æœ€ä½ä»·æ ¼ï¼š"</span> + priceStats.<span class="hljs-built_in">min</span>());
                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"ä»·æ ¼æ€»å’Œï¼š"</span> + priceStats.<span class="hljs-built_in">sum</span>());
                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"ç»Ÿè®¡å•†å“æ•°é‡ï¼š"</span> + priceStats.<span class="hljs-built_in">count</span>());

                <span class="hljs-comment">// 4.2 è§£æç±»åˆ«åˆ†ç»„èšåˆï¼ˆtermsï¼‰</span>
                <span class="hljs-selector-tag">StringTermsAggregate</span> <span class="hljs-selector-tag">categoryTerms</span> = <span class="hljs-selector-tag">aggregations</span><span class="hljs-selector-class">.get</span>(<span class="hljs-string">"category_terms"</span>)<span class="hljs-selector-class">.sterms</span>();
                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"\nå•†å“ç±»åˆ«åˆ†ç»„ç»Ÿè®¡ï¼š"</span>);
                <span class="hljs-selector-tag">for</span> (StringTermsBucket <span class="hljs-attribute">bucket </span>: categoryTerms.<span class="hljs-built_in">buckets</span>().<span class="hljs-built_in">array</span>()) {
                    <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">category</span> = <span class="hljs-selector-tag">bucket</span><span class="hljs-selector-class">.key</span>(); <span class="hljs-comment">// åˆ†ç»„åç§°ï¼ˆç±»åˆ«ï¼‰</span>
                    <span class="hljs-selector-tag">long</span> <span class="hljs-selector-tag">count</span> = <span class="hljs-selector-tag">bucket</span><span class="hljs-selector-class">.docCount</span>(); <span class="hljs-comment">// è¯¥ç±»åˆ«çš„å•†å“æ•°é‡</span>
                    <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"ç±»åˆ«ï¼š"</span> + category + <span class="hljs-string">"ï¼Œå•†å“æ•°é‡ï¼š"</span> + count);
                }
            }

            <span class="hljs-comment">// 5. è§£ææ–‡æ¡£ç»“æœï¼ˆå¯é€‰ï¼‰</span>
            <span class="hljs-selector-tag">response</span><span class="hljs-selector-class">.hits</span>()<span class="hljs-selector-class">.hits</span>()<span class="hljs-selector-class">.forEach</span>(hit -&gt; {
                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"\næ–‡æ¡£è¯¦æƒ…ï¼š"</span> + hit.<span class="hljs-built_in">source</span>());
            });

        } <span class="hljs-selector-tag">catch</span> (Exception e) {
            <span class="hljs-selector-tag">e</span><span class="hljs-selector-class">.printStackTrace</span>();
        }
    }
}
</code></pre>
<p><strong>2.6.2 å¤šçº§åµŒå¥—èšåˆï¼ˆterms+range+avg/sumï¼‰</strong></p>
<p>å¤šçº§åµŒå¥—èšåˆé€‚ç”¨äºå¤æ‚ç»Ÿè®¡åœºæ™¯ï¼ˆå¦‚â€œæŒ‰å•†å“ç±»åˆ«åˆ†ç»„ â†’ æ¯ç»„å†…æŒ‰ä»·æ ¼åŒºé—´åˆ†ç»„ â†’ ç»Ÿè®¡æ¯ä¸ªä»·æ ¼åŒºé—´çš„å¹³å‡è¯„åˆ†å’Œé”€å”®æ€»é‡â€ï¼‰ï¼Œä»¥ä¸‹ä¿®å¤åŸå§‹ä»£ç bugï¼Œæ¼”ç¤ºå®Œæ•´åµŒå¥—èšåˆã€‚</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.AvgAggregate</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.RangeAggregate</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.RangeBucket</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.StringTermsAggregate</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.StringTermsBucket</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.TopHitsAggregate</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.SearchHit</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.json</span><span class="hljs-selector-class">.JsonData</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">co</span><span class="hljs-selector-class">.elastic</span><span class="hljs-selector-class">.clients</span><span class="hljs-selector-class">.elasticsearch</span><span class="hljs-selector-class">.core</span><span class="hljs-selector-class">.search</span><span class="hljs-selector-class">.SortOrder</span>;

<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">java</span><span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.Map</span>;

<span class="hljs-comment">/**
 * å¤šçº§åµŒå¥—èšåˆï¼ˆtermsåˆ†ç»„ â†’ rangeåˆ†ç»„ â†’ avg/sumç»Ÿè®¡ï¼‰
 */</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">EsAggregationNested</span> {
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">static</span> <span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">main</span>(String[] args) {
        <span class="hljs-selector-tag">try</span> {
            <span class="hljs-selector-tag">ElasticsearchClient</span> <span class="hljs-selector-tag">client</span> = <span class="hljs-selector-tag">EsClientUtil</span><span class="hljs-selector-class">.getEsClient</span>();

            <span class="hljs-comment">// 1. æ„å»ºåŸºç¡€è¿‡æ»¤æ¡ä»¶ï¼ˆè°ƒæ•´ä»·æ ¼èŒƒå›´ï¼Œè¦†ç›–åç»­æ‰€æœ‰åŒºé—´ï¼Œé¿å…ç»Ÿè®¡ä¸åˆ°æ•°æ®ï¼‰</span>
            <span class="hljs-selector-tag">RangeQuery</span> <span class="hljs-selector-tag">rangeQuery</span> = <span class="hljs-selector-tag">RangeQuery</span><span class="hljs-selector-class">.of</span>(r -&gt; r
                    .<span class="hljs-built_in">number</span>(n -&gt; n
                            .<span class="hljs-built_in">field</span>(<span class="hljs-string">"price"</span>)
                            .<span class="hljs-built_in">gte</span>(<span class="hljs-number">0.0</span>)       <span class="hljs-comment">// è¦†ç›–ä½ä»·åŒºé—´</span>
                            .<span class="hljs-built_in">lte</span>(<span class="hljs-number">200.0</span>)     <span class="hljs-comment">// è¦†ç›–é«˜ä»·åŒºé—´</span>
                    )
            );

            <span class="hljs-comment">// 2. æ„å»ºå¤šçº§åµŒå¥—èšåˆæŸ¥è¯¢è¯·æ±‚</span>
            <span class="hljs-selector-tag">SearchRequest</span> <span class="hljs-selector-tag">request</span> = <span class="hljs-selector-tag">SearchRequest</span><span class="hljs-selector-class">.of</span>(s -&gt; s
                    .<span class="hljs-built_in">index</span>(<span class="hljs-string">"products"</span>)
                    .<span class="hljs-built_in">query</span>(q -&gt; q.<span class="hljs-built_in">range</span>(rangeQuery))  <span class="hljs-comment">// åŸºç¡€è¿‡æ»¤æ¡ä»¶ï¼Œç­›é€‰æœ‰æ•ˆå•†å“</span>
                    .<span class="hljs-built_in">size</span>(<span class="hljs-number">0</span>)                          <span class="hljs-comment">// ä¸è¿”å›å…·ä½“æ–‡æ¡£ï¼Œåªå…³æ³¨èšåˆç»“æœï¼ˆæå‡æŸ¥è¯¢æ€§èƒ½ï¼‰</span>
                    <span class="hljs-comment">// ç¬¬ä¸€çº§èšåˆï¼šæŒ‰å•†å“ç±»åˆ«åˆ†ç»„ï¼ˆtermsï¼‰ï¼Œèšåˆåç§°ï¼šcategory_analysis</span>
                    .<span class="hljs-built_in">aggregations</span>(<span class="hljs-string">"category_analysis"</span>, a -&gt; a
                            .<span class="hljs-built_in">terms</span>(t -&gt; t
                                    .<span class="hljs-built_in">field</span>(<span class="hljs-string">"category.keyword"</span>) <span class="hljs-comment">// æŒ‰ç±»åˆ«åˆ†ç»„ï¼ˆkeywordç±»å‹ï¼Œç¡®ä¿åˆ†ç»„ç²¾å‡†ï¼‰</span>
                                    .<span class="hljs-built_in">size</span>(<span class="hljs-number">10</span>)                  <span class="hljs-comment">// æ˜¾ç¤ºå‰10ä¸ªç±»åˆ«ï¼Œå¯æ ¹æ®éœ€æ±‚è°ƒæ•´</span>
                            )
                            <span class="hljs-comment">// ç¬¬äºŒçº§èšåˆ1ï¼šæŒ‰ä»·æ ¼åŒºé—´åˆ†ç»„ï¼ˆrangeï¼‰ï¼Œèšåˆåç§°ï¼šprice_ranges</span>
                            .<span class="hljs-built_in">aggregations</span>(<span class="hljs-string">"price_ranges"</span>, a2 -&gt; a2
                                    .<span class="hljs-built_in">range</span>(r -&gt; r
                                            .<span class="hljs-built_in">field</span>(<span class="hljs-string">"price"</span>)  <span class="hljs-comment">// ä»·æ ¼åŒºé—´åˆ†ç»„å­—æ®µï¼ˆæ•°å€¼ç±»å‹ï¼‰</span>
                                            .<span class="hljs-built_in">ranges</span>(         <span class="hljs-comment">// å®šä¹‰3ä¸ªä»·æ ¼åŒºé—´ï¼Œæ¸…æ™°åŒºåˆ†ä½/ä¸­/é«˜ä»·</span>
                                                    range -&gt; range.<span class="hljs-built_in">key</span>(<span class="hljs-string">"low"</span>).<span class="hljs-built_in">from</span>(<span class="hljs-number">0.0</span>).<span class="hljs-built_in">to</span>(<span class="hljs-number">50.0</span>),      <span class="hljs-comment">// 0-50å…ƒï¼ˆä½ä»·ï¼‰</span>
                                                    range -&gt; range.<span class="hljs-built_in">key</span>(<span class="hljs-string">"medium"</span>).<span class="hljs-built_in">from</span>(<span class="hljs-number">50.0</span>).<span class="hljs-built_in">to</span>(<span class="hljs-number">100.0</span>),  <span class="hljs-comment">// 50-100å…ƒï¼ˆä¸­ä»·ï¼‰</span>
                                                    range -&gt; range.<span class="hljs-built_in">key</span>(<span class="hljs-string">"high"</span>).<span class="hljs-built_in">from</span>(<span class="hljs-number">100.0</span>).<span class="hljs-built_in">to</span>(<span class="hljs-number">200.0</span>)  <span class="hljs-comment">// 100-200å…ƒï¼ˆé«˜ä»·ï¼‰</span>
                                            )
                                    )
                                    <span class="hljs-comment">// ç¬¬ä¸‰çº§èšåˆ1ï¼šæ¯ä¸ªä»·æ ¼åŒºé—´çš„å¹³å‡è¯„åˆ†ï¼ˆavgï¼‰</span>
                                    .<span class="hljs-built_in">aggregations</span>(<span class="hljs-string">"avg_rating"</span>, a3 -&gt; a3
                                            .<span class="hljs-built_in">avg</span>(avg -&gt; avg.<span class="hljs-built_in">field</span>(<span class="hljs-string">"rating"</span>)) <span class="hljs-comment">// å‡è®¾å­˜åœ¨ratingï¼ˆå•†å“è¯„åˆ†ï¼‰å­—æ®µ</span>
                                    )
                                    <span class="hljs-comment">// ç¬¬ä¸‰çº§èšåˆ2ï¼šæ¯ä¸ªä»·æ ¼åŒºé—´çš„é”€å”®æ€»é‡ï¼ˆsumï¼‰</span>
                                    .<span class="hljs-built_in">aggregations</span>(<span class="hljs-string">"total_sales"</span>, a3 -&gt; a3
                                            .<span class="hljs-built_in">sum</span>(sum -&gt; sum.<span class="hljs-built_in">field</span>(<span class="hljs-string">"sales"</span>)) <span class="hljs-comment">// å‡è®¾å­˜åœ¨salesï¼ˆå•†å“é”€é‡ï¼‰å­—æ®µ</span>
                                    )
                            )
                            <span class="hljs-comment">// ç¬¬äºŒçº§èšåˆ2ï¼šæ¯ä¸ªç±»åˆ«ä¸‹çš„çƒ­é—¨å•†å“ï¼ˆtopHitsï¼‰ï¼Œå–é”€é‡å‰3</span>
                            .<span class="hljs-built_in">aggregations</span>(<span class="hljs-string">"top_products"</span>, a2 -&gt; a2
                                    .<span class="hljs-built_in">topHits</span>(th -&gt; th
                                            .<span class="hljs-built_in">size</span>(<span class="hljs-number">3</span>) <span class="hljs-comment">// æ¯ä¸ªç±»åˆ«æ˜¾ç¤ºå‰3ä¸ªçƒ­é—¨å•†å“</span>
                                            .<span class="hljs-built_in">sort</span>(so -&gt; so
                                                    .<span class="hljs-built_in">field</span>(f -&gt; f
                                                            .<span class="hljs-built_in">field</span>(<span class="hljs-string">"sales"</span>) <span class="hljs-comment">// æŒ‰é”€é‡é™åºæ’åºï¼Œç­›é€‰çƒ­é—¨</span>
                                                            .<span class="hljs-built_in">order</span>(SortOrder.Desc)
                                                    )
                                            )
                                    )
                            )
                    )
            );

            <span class="hljs-comment">// 3. æ‰§è¡ŒæŸ¥è¯¢ï¼Œè·å–å“åº”ç»“æœ</span>
            <span class="hljs-selector-tag">SearchResponse</span>&lt;<span class="hljs-selector-tag">Product</span>&gt; <span class="hljs-selector-tag">response</span> = <span class="hljs-selector-tag">client</span><span class="hljs-selector-class">.search</span>(request, Product.class);

            <span class="hljs-comment">// 4. è§£æå¤šçº§åµŒå¥—èšåˆç»“æœï¼ˆä¿®å¤åŸå§‹bugï¼Œå®Œå–„è·¯å¾„è·å–å’Œéç©ºæ ¡éªŒï¼‰</span>
            <span class="hljs-selector-tag">if</span> (response.<span class="hljs-built_in">aggregations</span>() != null) {
                <span class="hljs-selector-tag">Map</span>&lt;<span class="hljs-selector-tag">String</span>, <span class="hljs-selector-tag">Aggregate</span>&gt; <span class="hljs-selector-tag">rootAggregations</span> = <span class="hljs-selector-tag">response</span><span class="hljs-selector-class">.aggregations</span>();

                <span class="hljs-comment">// 4.1 è·å–ç¬¬ä¸€çº§èšåˆï¼šæŒ‰å•†å“ç±»åˆ«åˆ†ç»„ï¼ˆtermsèšåˆï¼‰ï¼Œéç©ºæ ¡éªŒé¿å…ç©ºæŒ‡é’ˆ</span>
                <span class="hljs-selector-tag">if</span> (rootAggregations.<span class="hljs-built_in">containsKey</span>(<span class="hljs-string">"category_analysis"</span>)) {
                    <span class="hljs-selector-tag">StringTermsAggregate</span> <span class="hljs-selector-tag">categoryAgg</span> = <span class="hljs-selector-tag">rootAggregations</span><span class="hljs-selector-class">.get</span>(<span class="hljs-string">"category_analysis"</span>)<span class="hljs-selector-class">.sterms</span>();

                    <span class="hljs-comment">// 4.2 éå†æ¯ä¸ªç±»åˆ«æ¡¶ï¼ˆç¬¬ä¸€çº§èšåˆç»“æœï¼‰</span>
                    <span class="hljs-selector-tag">for</span> (StringTermsBucket <span class="hljs-attribute">categoryBucket </span>: categoryAgg.<span class="hljs-built_in">buckets</span>().<span class="hljs-built_in">array</span>()) {
                        <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">category</span> = <span class="hljs-selector-tag">categoryBucket</span><span class="hljs-selector-class">.key</span>(); <span class="hljs-comment">// å•†å“ç±»åˆ«åç§°</span>
                        <span class="hljs-selector-tag">long</span> <span class="hljs-selector-tag">categoryDocCount</span> = <span class="hljs-selector-tag">categoryBucket</span><span class="hljs-selector-class">.docCount</span>(); <span class="hljs-comment">// è¯¥ç±»åˆ«çš„å•†å“æ€»æ•°</span>
                        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"=== å•†å“ç±»åˆ«ï¼š"</span> + category + <span class="hljs-string">"ï¼ˆå•†å“æ€»æ•°ï¼š"</span> + categoryDocCount + <span class="hljs-string">"ï¼‰==="</span>);

                        <span class="hljs-comment">// 4.3 è·å–ç¬¬äºŒçº§èšåˆï¼šè¯¥ç±»åˆ«ä¸‹çš„ä»·æ ¼åŒºé—´åˆ†ç»„ï¼ˆrangeèšåˆï¼‰</span>
                        <span class="hljs-selector-tag">Map</span>&lt;<span class="hljs-selector-tag">String</span>, <span class="hljs-selector-tag">Aggregate</span>&gt; <span class="hljs-selector-tag">categoryAggregations</span> = <span class="hljs-selector-tag">categoryBucket</span><span class="hljs-selector-class">.aggregations</span>();
                        <span class="hljs-selector-tag">if</span> (categoryAggregations.<span class="hljs-built_in">containsKey</span>(<span class="hljs-string">"price_ranges"</span>)) {
                            <span class="hljs-selector-tag">RangeAggregate</span> <span class="hljs-selector-tag">priceRangeAgg</span> = <span class="hljs-selector-tag">categoryAggregations</span><span class="hljs-selector-class">.get</span>(<span class="hljs-string">"price_ranges"</span>)<span class="hljs-selector-class">.range</span>();

                            <span class="hljs-comment">// 4.4 éå†æ¯ä¸ªä»·æ ¼åŒºé—´æ¡¶ï¼ˆç¬¬äºŒçº§èšåˆç»“æœï¼‰</span>
                            <span class="hljs-selector-tag">for</span> (RangeBucket <span class="hljs-attribute">priceBucket </span>: priceRangeAgg.<span class="hljs-built_in">buckets</span>().<span class="hljs-built_in">array</span>()) {
                                <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">priceRange</span> = <span class="hljs-selector-tag">priceBucket</span><span class="hljs-selector-class">.key</span>(); <span class="hljs-comment">// ä»·æ ¼åŒºé—´æ ‡è¯†ï¼ˆlow/medium/highï¼‰</span>
                                <span class="hljs-selector-tag">long</span> <span class="hljs-selector-tag">priceDocCount</span> = <span class="hljs-selector-tag">priceBucket</span><span class="hljs-selector-class">.docCount</span>(); <span class="hljs-comment">// è¯¥ä»·æ ¼åŒºé—´çš„å•†å“æ•°é‡</span>
                                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"  ä»·æ ¼åŒºé—´ï¼š"</span> + priceRange + <span class="hljs-string">"ï¼ˆå•†å“æ•°é‡ï¼š"</span> + priceDocCount + <span class="hljs-string">"ï¼‰"</span>);

                                <span class="hljs-comment">// 4.5 è·å–ç¬¬ä¸‰çº§èšåˆ1ï¼šè¯¥ä»·æ ¼åŒºé—´çš„å¹³å‡è¯„åˆ†ï¼ˆavgèšåˆï¼‰</span>
                                <span class="hljs-selector-tag">Map</span>&lt;<span class="hljs-selector-tag">String</span>, <span class="hljs-selector-tag">Aggregate</span>&gt; <span class="hljs-selector-tag">priceAggregations</span> = <span class="hljs-selector-tag">priceBucket</span><span class="hljs-selector-class">.aggregations</span>();
                                <span class="hljs-selector-tag">if</span> (priceAggregations.<span class="hljs-built_in">containsKey</span>(<span class="hljs-string">"avg_rating"</span>)) {
                                    <span class="hljs-selector-tag">Aggregate</span> <span class="hljs-selector-tag">avgRatingAgg</span> = <span class="hljs-selector-tag">priceAggregations</span><span class="hljs-selector-class">.get</span>(<span class="hljs-string">"avg_rating"</span>);
                                    <span class="hljs-selector-tag">if</span> (avgRatingAgg != null &amp;&amp; avgRatingAgg.<span class="hljs-built_in">isAvg</span>()) {
                                        <span class="hljs-selector-tag">AvgAggregate</span> <span class="hljs-selector-tag">avgRating</span> = <span class="hljs-selector-tag">avgRatingAgg</span><span class="hljs-selector-class">.avg</span>();
                                        <span class="hljs-comment">// å®‰å…¨æ ¡éªŒï¼Œé¿å…nullå€¼å¼‚å¸¸ï¼Œä¿ç•™2ä½å°æ•°ï¼Œæå‡å¯è¯»æ€§</span>
                                        <span class="hljs-selector-tag">double</span> <span class="hljs-selector-tag">avg</span> = <span class="hljs-selector-tag">avgRating</span><span class="hljs-selector-class">.value</span>() != <span class="hljs-selector-tag">null</span> ? <span class="hljs-selector-tag">avgRating</span><span class="hljs-selector-class">.value</span>() : <span class="hljs-number">0.0</span>;
                                        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"    å¹³å‡è¯„åˆ†ï¼š"</span> + String.<span class="hljs-built_in">format</span>(<span class="hljs-string">"%.2f"</span>, avg));
                                    }
                                }

                                <span class="hljs-comment">// 4.6 è·å–ç¬¬ä¸‰çº§èšåˆ2ï¼šè¯¥ä»·æ ¼åŒºé—´çš„é”€å”®æ€»é‡ï¼ˆsumèšåˆï¼‰</span>
                                <span class="hljs-selector-tag">if</span> (priceAggregations.<span class="hljs-built_in">containsKey</span>(<span class="hljs-string">"total_sales"</span>)) {
                                    <span class="hljs-selector-tag">Aggregate</span> <span class="hljs-selector-tag">totalSalesAgg</span> = <span class="hljs-selector-tag">priceAggregations</span><span class="hljs-selector-class">.get</span>(<span class="hljs-string">"total_sales"</span>);
                                    <span class="hljs-selector-tag">if</span> (totalSalesAgg != null &amp;&amp; totalSalesAgg.<span class="hljs-built_in">isSum</span>()) {
                                        <span class="hljs-comment">// è§£æsumèšåˆç»“æœï¼Œå…¼å®¹æ•°å€¼ç±»å‹</span>
                                        <span class="hljs-selector-tag">JsonData</span> <span class="hljs-selector-tag">salesData</span> = <span class="hljs-selector-tag">totalSalesAgg</span><span class="hljs-selector-class">.sum</span>()<span class="hljs-selector-class">.value</span>();
                                        <span class="hljs-selector-tag">long</span> <span class="hljs-selector-tag">totalSales</span> = <span class="hljs-selector-tag">salesData</span> != <span class="hljs-selector-tag">null</span> ? <span class="hljs-selector-tag">salesData</span><span class="hljs-selector-class">.toLong</span>() : <span class="hljs-number">0</span>;
                                        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"    é”€å”®æ€»é‡ï¼š"</span> + totalSales);
                                    }
                                }
                            }
                        }

                        <span class="hljs-comment">// 4.7 è·å–ç¬¬äºŒçº§èšåˆ2ï¼šè¯¥ç±»åˆ«ä¸‹çš„çƒ­é—¨å•†å“ï¼ˆtopHitsèšåˆï¼‰</span>
                        <span class="hljs-selector-tag">if</span> (categoryAggregations.<span class="hljs-built_in">containsKey</span>(<span class="hljs-string">"top_products"</span>)) {
                            <span class="hljs-selector-tag">Aggregate</span> <span class="hljs-selector-tag">topProductsAgg</span> = <span class="hljs-selector-tag">categoryAggregations</span><span class="hljs-selector-class">.get</span>(<span class="hljs-string">"top_products"</span>);
                            <span class="hljs-selector-tag">if</span> (topProductsAgg != null &amp;&amp; topProductsAgg.<span class="hljs-built_in">isTopHits</span>()) {
                                <span class="hljs-selector-tag">TopHitsAggregate</span> <span class="hljs-selector-tag">topHits</span> = <span class="hljs-selector-tag">topProductsAgg</span><span class="hljs-selector-class">.topHits</span>();
                                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"  è¯¥ç±»åˆ«çƒ­é—¨å•†å“ï¼ˆé”€é‡å‰3ï¼‰ï¼š"</span>);
                                <span class="hljs-comment">// éå†çƒ­é—¨å•†å“ï¼Œååºåˆ—åŒ–ä¸ºProductå®ä½“</span>
                                <span class="hljs-selector-tag">for</span> (SearchHit&lt;Product&gt; <span class="hljs-attribute">hit </span>: topHits.<span class="hljs-built_in">hits</span>().<span class="hljs-built_in">hits</span>()) {
                                    <span class="hljs-selector-tag">Product</span> <span class="hljs-selector-tag">product</span> = <span class="hljs-selector-tag">hit</span><span class="hljs-selector-class">.source</span>();
                                    <span class="hljs-selector-tag">if</span> (product != null) {
                                        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"    - å•†å“ï¼š"</span> + product.<span class="hljs-built_in">getName</span>() + <span class="hljs-string">"ï¼Œä»·æ ¼ï¼š"</span> + product.<span class="hljs-built_in">getPrice</span>() + <span class="hljs-string">"ï¼Œé”€é‡ï¼š"</span> + hit.<span class="hljs-built_in">fields</span>().<span class="hljs-built_in">get</span>(<span class="hljs-string">"sales"</span>).<span class="hljs-built_in">value</span>());
                                    }
                                }
                            }
                        }
                        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(); <span class="hljs-comment">// æ¢è¡Œï¼ŒåŒºåˆ†ä¸åŒç±»åˆ«ï¼Œæå‡å¯è¯»æ€§</span>
                    }
                } <span class="hljs-selector-tag">else</span> {
                    <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"æœªæŸ¥è¯¢åˆ°å•†å“ç±»åˆ«èšåˆæ•°æ®ï¼Œè¯·æ£€æŸ¥categoryå­—æ®µæ˜¯å¦å­˜åœ¨ä¸”ä¸ºkeywordç±»å‹"</span>);
                }
            } <span class="hljs-selector-tag">else</span> {
                <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"æœªæŸ¥è¯¢åˆ°ä»»ä½•èšåˆç»“æœï¼Œè¯·æ£€æŸ¥ç´¢å¼•æ•°æ®æˆ–æŸ¥è¯¢æ¡ä»¶"</span>);
            }

        } <span class="hljs-selector-tag">catch</span> (Exception e) {
            <span class="hljs-selector-tag">e</span><span class="hljs-selector-class">.printStackTrace</span>();
            <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"å¤šçº§åµŒå¥—èšåˆæŸ¥è¯¢å¤±è´¥ï¼š"</span> + e.<span class="hljs-built_in">getMessage</span>());
        } <span class="hljs-selector-tag">finally</span> {
            <span class="hljs-comment">// é¡¹ç›®åœæ­¢æ—¶å…³é—­å®¢æˆ·ç«¯ï¼ˆå®é™…å¼€å‘ä¸­å¯åœ¨Springé”€æ¯æ–¹æ³•ã€Tomcatå…³é—­é’©å­ä¸­è°ƒç”¨ï¼‰</span>
            <span class="hljs-comment">// EsClientUtil.closeClient();</span>
        }
    }
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - çŠ¶æ€æ•°æ®è®¾è®¡ [8 - 2]ï¼šå‰ç«¯æ¡†æ¶çš„â€œç»†ç²’åº¦å“åº”å¼â€åŸç†]]></title>    <link>https://juejin.cn/post/7603263490341535753</link>    <guid>https://juejin.cn/post/7603263490341535753</guid>    <pubDate>2026-02-06T01:26:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603263490341535753" data-draft-id="7603216479836274739" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - çŠ¶æ€æ•°æ®è®¾è®¡ [8 - 2]ï¼šå‰ç«¯æ¡†æ¶çš„â€œç»†ç²’åº¦å“åº”å¼â€åŸç†"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-06T01:26:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯ç‹å£®å£®"/> <meta itemprop="url" content="https://juejin.cn/user/4473272506789485"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - çŠ¶æ€æ•°æ®è®¾è®¡ [8 - 2]ï¼šå‰ç«¯æ¡†æ¶çš„â€œç»†ç²’åº¦å“åº”å¼â€åŸç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4473272506789485/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯ç‹å£®å£®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T01:26:12.000Z" title="Fri Feb 06 2026 01:26:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><blockquote>
<p><strong>å†™åœ¨å‰é¢</strong></p>
<p><strong>React çš„ç—›ï¼š</strong> åœ¨ React ä¸­ï¼Œä¸€ä¸ª State å˜äº†ï¼Œç»„ä»¶å°±ä¼šé‡æ–°æ‰§è¡Œï¼ˆRe-renderï¼‰ã€‚ä¸ºäº†æ€§èƒ½ï¼Œæˆ‘ä»¬ä¸å¾—ä¸æå‡º Fiber æ¶æ„ï¼Œæå‡ºæ—¶é—´åˆ‡ç‰‡ï¼Œæå‡º <code>useMemo</code>ã€‚è¿™å°±å¥½æ¯”ï¼šä¸ºäº†èƒ½åœ¨å¹²è‰å †é‡Œæ‰¾åˆ°ä¸€æ ¹é’ˆï¼ŒReact å‘æ˜äº†ä¸€å°è¶…çº§é«˜ç§‘æŠ€çš„â€œå¹²è‰å †ç¿»æ‰¾æœºâ€ã€‚</p>
<p><strong>Signal çš„è§£ï¼š</strong> ç»†ç²’åº¦å“åº”å¼ï¼ˆSignalï¼‰çš„æ€è·¯æ˜¯ï¼šåœ¨æ‰”é’ˆè¿›å»çš„æ—¶å€™ï¼Œå°±ç»™é’ˆç³»ä¸Šä¸€æ ¹ç»³å­ã€‚è¦æ‰¾é’ˆçš„æ—¶å€™ï¼Œæ‹‰ç»³å­å°±è¡Œäº†ã€‚</p>
<p>æœ¬ç¯‡æˆ‘ä»¬å°†æ·±å…¥å†…æ ¸ï¼Œæ‰‹å†™ä¸€ä¸ªè¿·ä½  Signal ç³»ç»Ÿï¼Œçœ‹æ¸…å®ƒçš„æœ¬è´¨ã€‚</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a64a10d9a9ee4d519310f44fbbe360f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv546L5aOu5aOu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770945971&amp;x-signature=4nRcz5vcrElDAbL%2FHZPBBvC7afs%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ å®è§‚å¯¹å†³ï¼šVDOM vs. Fine-Grained (ç»†ç²’åº¦)</h2>
<p>è¦ç†è§£ Signalï¼Œé¦–å…ˆè¦ç†è§£å®ƒæƒ³é©è°çš„å‘½ã€‚</p>
<h3 data-id="heading-1">1.1 VDOM çš„â€œåœ°æ¯¯å¼æœç´¢â€</h3>
<p>React çš„æ›´æ–°æ¨¡å‹æ˜¯ <strong>Snapshotï¼ˆå¿«ç…§ï¼‰</strong> å¼çš„ã€‚</p>
<ul>
<li><strong>æµç¨‹ï¼š</strong> æ•°æ®å˜äº† -&gt; è¿è¡Œæ•´ä¸ªç»„ä»¶å‡½æ•° -&gt; ç”Ÿæˆæ–°çš„ VDOM æ ‘ -&gt; å¯¹æ¯”æ–°æ—§æ ‘ (Diff) -&gt; æ‰¾å‡ºå·®å¼‚ -&gt; æ›´æ–° DOMã€‚</li>
<li><strong>å¤æ‚åº¦ï¼š</strong> è·Ÿç»„ä»¶æ ‘çš„å¤§å°æˆæ­£æ¯”ã€‚</li>
<li><strong>é—®é¢˜ï¼š</strong> å“ªæ€•åªæ”¹äº†ä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹ï¼Œæ•´ä¸ªç»„ä»¶ï¼ˆç”šè‡³å­ç»„ä»¶ï¼‰çš„é€»è¾‘éƒ½è¦é‡è·‘ä¸€éã€‚</li>
</ul>
<h3 data-id="heading-2">1.2 Signal çš„â€œç‚¹å¯¹ç‚¹ç‹™å‡»â€</h3>
<p>SolidJS æˆ– Vue çš„æ›´æ–°æ¨¡å‹æ˜¯ <strong>Dependency Graphï¼ˆä¾èµ–å›¾ï¼‰</strong> å¼çš„ã€‚</p>
<ul>
<li><strong>æµç¨‹ï¼š</strong> æ•°æ®å˜äº† -&gt; <strong>ç›´æ¥å®šä½</strong>åˆ°ç»‘å®šäº†è¯¥æ•°æ®çš„ DOM èŠ‚ç‚¹ -&gt; æ›´æ–° DOMã€‚</li>
<li><strong>å¤æ‚åº¦ï¼š</strong> è·ŸåŠ¨æ€èŠ‚ç‚¹çš„æ•°é‡æˆæ­£æ¯”ï¼ˆé€šå¸¸æ˜¯ O(1)ï¼‰ã€‚</li>
<li><strong>æ ¸å¿ƒï¼š</strong> ç»„ä»¶å‡½æ•°åªåœ¨åˆå§‹åŒ–æ—¶è¿è¡Œä¸€æ¬¡ï¼ä¹‹åå†ä¹Ÿä¸ä¼šè¿è¡Œäº†ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-3">äºŒã€ è§£å‰– Signalï¼šå‘å¸ƒè®¢é˜…çš„è¿›åŒ–ä½“</h2>
<p>Signal å¹¶ä¸ç¥ç§˜ï¼Œå®ƒæœ¬è´¨ä¸Šå°±æ˜¯ <strong>â€œä¿å­˜å€¼çš„å®¹å™¨â€ + â€œè‡ªåŠ¨ä¾èµ–è¿½è¸ªâ€</strong> ã€‚ å®ƒç”±ä¸¤ä¸ªæ ¸å¿ƒåŠ¨ä½œç»„æˆï¼š<strong>Track (è¿½è¸ª/è¯»)</strong> å’Œ <strong>Trigger (è§¦å‘/å†™)</strong> ã€‚</p>
<h3 data-id="heading-4">2.1 æ ¸å¿ƒ API æ¨¡æ‹Ÿ</h3>
<p>ä»¥ SolidJS/React é£æ ¼ä¸ºä¾‹ï¼Œæˆ‘ä»¬é€ ä¸€ä¸ª Signalï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// è¿™æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨æ¥è®°å½•â€œå½“å‰è°åœ¨æŸ¥æˆ‘ä¸ï¼Ÿâ€
let <span class="hljs-attr">activeEffect</span> = null<span class="hljs-comment">;</span>

function createSignal(initialValue) {
  let <span class="hljs-attr">value</span> = initialValue<span class="hljs-comment">;</span>
  const <span class="hljs-attr">subscribers</span> = new Set()<span class="hljs-comment">; // è®¢é˜…è€…åå•</span>

  // Getter (è¯»)
  const <span class="hljs-attr">read</span> = () =&gt; {
    if (activeEffect) {
      // 1. ä¾èµ–æ”¶é›† (Track)ï¼šå¦‚æœæœ‰äººåœ¨å…³æ³¨æˆ‘ï¼ŒæŠŠä»–è®°ä¸‹æ¥
      subscribers.add(activeEffect)<span class="hljs-comment">;</span>
    }
    return value<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>

  // Setter (å†™)
  const <span class="hljs-attr">write</span> = (newValue) =&gt; {
    <span class="hljs-attr">value</span> = newValue<span class="hljs-comment">;</span>
    // 2. æ´¾å‘æ›´æ–° (Trigger)ï¼šé€šçŸ¥åå•é‡Œæ‰€æœ‰äººå¹²æ´»
    subscribers.forEach(<span class="hljs-attr">fn</span> =&gt; fn())<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>

  return <span class="hljs-section">[read, write]</span><span class="hljs-comment">;</span>
}
</code></pre>
<h3 data-id="heading-5">2.2 é­”æ³•çš„ç²˜åˆå‰‚ï¼šEffect</h3>
<p>å…‰æœ‰ Signal æ²¡ç”¨ï¼Œå¾—æœ‰äººâ€œè¯»â€å®ƒï¼Œè®¢é˜…å…³ç³»æ‰èƒ½å»ºç«‹ã€‚è¿™å°±éœ€è¦ <code>createEffect</code>ï¼ˆåœ¨ Vue é‡Œå« <code>watchEffect</code>ï¼‰ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createEffect</span>(<span class="hljs-params">fn</span>) </span>{
  <span class="hljs-comment">// æŠŠè‡ªå·±æ ‡è®°ä¸ºâ€œæ­£åœ¨æ‰§è¡Œçš„å‰¯ä½œç”¨â€</span>
  activeEffect = <span class="hljs-function"><span class="hljs-keyword">fn</span></span>;
  
  <span class="hljs-comment">// æ‰§è¡Œä¸€æ¬¡å‡½æ•°ã€‚</span>
  <span class="hljs-comment">// æ³¨æ„ï¼šå‡½æ•°å†…éƒ¨ä¼šè¯»å– Signalï¼Œä»è€Œè§¦å‘ Signal çš„ Getterï¼Œ</span>
  <span class="hljs-comment">// è¿›è€ŒæŠŠè¿™ä¸ª fn æ·»åŠ åˆ° subscribers é‡Œã€‚</span>
  <span class="hljs-function"><span class="hljs-keyword">fn</span>(<span class="hljs-params"/>)</span>;
  
  <span class="hljs-comment">// æ‰§è¡Œå®Œå¤åŸ</span>
  activeEffect = <span class="hljs-literal">null</span>;
}
</code></pre>
<h3 data-id="heading-6">2.3 è·‘èµ·æ¥çœ‹çœ‹</h3>
<pre><code class="hljs language-scss" lang="scss">const <span class="hljs-selector-attr">[count, setCount]</span> = <span class="hljs-built_in">createSignal</span>(<span class="hljs-number">0</span>);

<span class="hljs-built_in">createEffect</span>(() =&gt; {
  console<span class="hljs-selector-class">.log</span>("æ•°å­—å˜äº†ï¼š", count()); 
});
<span class="hljs-comment">// è¾“å‡º: æ•°å­—å˜äº†ï¼š0 (åˆå§‹åŒ–æ‰§è¡Œ)</span>

<span class="hljs-built_in">setCount</span>(<span class="hljs-number">1</span>);
<span class="hljs-comment">// è¾“å‡º: æ•°å­—å˜äº†ï¼š1 (è‡ªåŠ¨è§¦å‘ï¼)</span>
</code></pre>
<p>è¿™å°±æ˜¯<strong>ç»†ç²’åº¦å“åº”å¼</strong>çš„æœ€ç®€å†…æ ¸ã€‚æ²¡æœ‰ä»»ä½• VDOMï¼Œæ²¡æœ‰ Diffï¼Œåªæœ‰ç²¾å‡†çš„å‡½æ•°è°ƒç”¨é“¾ã€‚</p>
<hr/>
<h2 data-id="heading-7">ä¸‰ã€ è¿›é˜¶ï¼š computed ä¸ä¾èµ–å›¾çš„è‡ªåŠ¨æ„å»º</h2>
<p>Signal ç³»ç»Ÿæœ€å¼ºå¤§çš„åœ°æ–¹åœ¨äºå®ƒèƒ½<strong>è‡ªåŠ¨æ„å»ºä¾èµ–å›¾</strong>ã€‚ åœ¨æ¶æ„è®¾è®¡ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä½¿ç”¨ <code>computed</code> (æ´¾ç”ŸçŠ¶æ€)ã€‚</p>
<p><code>computed</code> æ—¢æ˜¯ <strong>æ¶ˆè´¹è€…</strong>ï¼ˆå®ƒä¾èµ–åˆ«çš„ Signalï¼‰ï¼Œåˆæ˜¯ <strong>ç”Ÿäº§è€…</strong>ï¼ˆåˆ«çš„ Effect ä¾èµ–å®ƒï¼‰ã€‚</p>
<h3 data-id="heading-8">3.1 æ‡’è®¡ç®—ä¸ç¼“å­˜ (Memoization)</h3>
<p>ç»†ç²’åº¦æ¡†æ¶ä¸­çš„ <code>computed</code> é€šå¸¸æ˜¯æƒ°æ€§çš„ï¼ˆLazyï¼‰ã€‚</p>
<ul>
<li>åªæœ‰å½“æœ‰äººè¯»å®ƒæ—¶ï¼Œå®ƒæ‰è®¡ç®—ã€‚</li>
<li>å¦‚æœå®ƒä¾èµ–çš„ Signal æ²¡å˜ï¼Œå®ƒç›´æ¥è¿”å›ç¼“å­˜ã€‚</li>
</ul>
<h3 data-id="heading-9">3.2 åŠ¨æ€ä¾èµ–æ”¶é›†</h3>
<p>è¿™æ˜¯ React <code>useMemo</code> æ°¸è¿œåšä¸åˆ°çš„ã€‚ React çš„ä¾èµ–æ•°ç»„ <code>[a, b]</code> æ˜¯æ‰‹åŠ¨å£°æ˜çš„ï¼ˆé™æ€ï¼‰ã€‚è€Œ Signal çš„ä¾èµ–æ˜¯<strong>è¿è¡Œæ—¶åŠ¨æ€æ”¶é›†</strong>çš„ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">const <span class="hljs-selector-attr">[show, setShow]</span> = <span class="hljs-built_in">createSignal</span>(true);
const <span class="hljs-selector-attr">[name, setName]</span> = <span class="hljs-built_in">createSignal</span>("Gemini");
const <span class="hljs-selector-attr">[age, setAge]</span> = <span class="hljs-built_in">createSignal</span>(<span class="hljs-number">18</span>);

<span class="hljs-built_in">createEffect</span>(() =&gt; {
  <span class="hljs-comment">// åŠ¨æ€ä¾èµ–ï¼</span>
  if (show()) {
    console<span class="hljs-selector-class">.log</span>(name()); <span class="hljs-comment">// æ­¤æ—¶ä¾èµ–æ˜¯ [show, name]</span>
  } else {
    console<span class="hljs-selector-class">.log</span>(age());  <span class="hljs-comment">// æ­¤æ—¶ä¾èµ–å˜æˆ [show, age]</span>
  }
});
</code></pre>
<p><strong>æ¶æ„æ„ä¹‰ï¼š</strong> è¿™ç§æœºåˆ¶ä¿è¯äº†<strong>æœ€å°åŒ–è®¡ç®—</strong>ã€‚å½“ <code>show</code> ä¸º false æ—¶ï¼Œæ”¹å˜ <code>name</code> æ ¹æœ¬ä¸ä¼šè§¦å‘è¿™ä¸ª Effectï¼Œå› ä¸ºç³»ç»ŸçŸ¥é“è¿™ä¸€åˆ» <code>name</code> ä¸é‡è¦ã€‚</p>
<hr/>
<h2 data-id="heading-10">å››ã€ ä¸ºä»€ä¹ˆ React è¿˜åœ¨åšæŒï¼Ÿ</h2>
<p>æ—¢ç„¶ Signal è¿™ä¹ˆå¥½ï¼Œæ€§èƒ½è¿™ä¹ˆé«˜ï¼Œä¸ºä»€ä¹ˆ React ä¸æŠŠ <code>useState</code> æ¢æˆ Signalï¼Ÿ è¿™æ¶‰åŠåˆ°åº•å±‚å“²å­¦çš„å†²çªã€‚</p>
<h3 data-id="heading-11">4.1 UI = f(state) vs. UI = Bind(state)</h3>
<ul>
<li><strong>React å“²å­¦ï¼š</strong> UI æ˜¯æ•°æ®çš„<strong>æŠ•å½±ï¼ˆSnapshotï¼‰</strong> ã€‚æ¯æ¬¡æ¸²æŸ“éƒ½æ˜¯ä¸¢å¼ƒæ—§ä¸–ç•Œï¼Œé‡å»ºæ–°ä¸–ç•Œã€‚è¿™ç¬¦åˆå‡½æ•°å¼ç¼–ç¨‹çš„ç›´è§‰ï¼Œå¿ƒæ™ºæ¨¡å‹æœ€ç®€å•ã€‚</li>
<li><strong>Signal å“²å­¦ï¼š</strong> UI æ˜¯æ•°æ®çš„<strong>ç»‘å®šï¼ˆBindingï¼‰</strong> ã€‚åˆå§‹æ¸²æŸ“åï¼Œç»„ä»¶å°±æ¶ˆå¤±äº†ï¼Œå‰©ä¸‹çš„åªæœ‰æ•°æ®å’Œ DOM ä¹‹é—´çš„è¿çº¿ã€‚</li>
</ul>
<h3 data-id="heading-12">4.2 ä»£æ•°æ•ˆåº” (Algebraic Effects)</h3>
<p>React å›¢é˜Ÿè®¤ä¸ºï¼Œæ‰‹åŠ¨å¤„ç† <code>.value</code> æˆ–è€… <code>[get, set]</code> æ˜¯å¯¹å¼€å‘è€…å¿ƒæ™ºçš„è´Ÿæ‹…ã€‚ä»–ä»¬è¿½æ±‚çš„æ˜¯ <strong>"It just works"</strong> ã€‚ React æ­£åœ¨æçš„ <strong>React Compiler (React Forget)</strong> ï¼Œå…¶å®æ˜¯ä¸€æ¡æ®Šé€”åŒå½’çš„è·¯ï¼š</p>
<ul>
<li><strong>Signal:</strong> åœ¨<strong>è¿è¡Œæ—¶</strong>é€šè¿‡ Proxy æ”¶é›†ä¾èµ–ï¼Œå®ç°ç»†ç²’åº¦æ›´æ–°ã€‚</li>
<li><strong>React Compiler:</strong> åœ¨<strong>ç¼–è¯‘æ—¶</strong>åˆ†æä»£ç ï¼Œè‡ªåŠ¨æ’å…¥ memoizationï¼Œæ¨¡æ‹Ÿç»†ç²’åº¦æ›´æ–°çš„æ•ˆæœã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-13">äº”ã€ æ€»ç»“ï¼šæ¶æ„å¸ˆçš„é€‰æ‹©</h2>
<p>ç†è§£äº†åŸç†ï¼Œæˆ‘ä»¬åœ¨æ¶æ„è®¾è®¡ä¸­å°±èƒ½æ˜ç™½ï¼š</p>
<ol>
<li>
<p><strong>Vue 3 / Solid:</strong> é€‚åˆ<strong>é«˜æ€§èƒ½ä»ªè¡¨ç›˜ã€å³æ—¶é€šè®¯ã€å³æ—¶ç¼–è¾‘</strong>ç±»åº”ç”¨ã€‚å› ä¸ºå®ƒä»¬å¯¹ CPU çš„åˆ©ç”¨ç‡æé«˜ï¼Œæ²¡æœ‰ VDOM çš„ Overheadã€‚</p>
</li>
<li>
<p><strong>React:</strong> é€‚åˆ<strong>å¤§å‹ä¸šåŠ¡ç³»ç»Ÿã€ç”Ÿæ€ä¾èµ–é‡</strong>çš„åº”ç”¨ã€‚è™½ç„¶æœ‰ä¸€äº›æ€§èƒ½æŸè€—ï¼Œä½†å…¶ç¼–ç¨‹æ¨¡å‹çš„ä¸€è‡´æ€§ï¼ˆPure Renderï¼‰èƒ½é™ä½é€»è¾‘å¤æ‚åº¦ã€‚</p>
</li>
<li>
<p><strong>è¶‹åŠ¿:</strong> è¶Šæ¥è¶Šå¤šçš„çŠ¶æ€ç®¡ç†åº“ï¼ˆMobX, Valtio, Preact Signalsï¼‰å…è®¸ä½ åœ¨ React ä¸­ä½¿ç”¨ Signalã€‚</p>
<ul>
<li><strong>æ¶æ„æ¨¡å¼ï¼š</strong> ä½¿ç”¨ Signal ç®¡ç†é¢‘ç¹å˜åŒ–çš„<strong>å±€éƒ¨çŠ¶æ€</strong>ï¼ˆé¿å… React é¡¶å±‚é‡æ¸²æŸ“ï¼‰ï¼Œä½¿ç”¨ React Context ç®¡ç†ä½é¢‘çš„<strong>å…¨å±€çŠ¶æ€</strong>ã€‚</li>
</ul>
</li>
</ol>
<blockquote>
<p><strong>Next Step:</strong> æˆ‘ä»¬ææ‡‚äº†å‰ç«¯â€œæ€ä¹ˆå­˜æ•°æ®â€ï¼ˆRedux/Atomicï¼‰å’Œâ€œæ€ä¹ˆæ›´æ–°æ•°æ®â€ï¼ˆSignalï¼‰ã€‚ ä½†è¿˜æœ‰ä¸€ä¸ªæœ€å¤§çš„éº»çƒ¦æ²¡è§£å†³ï¼š<strong>API æ•°æ®</strong>ã€‚ æˆ‘ä»¬ä»¥å‰æ€»æ˜¯æŠŠåç«¯è¿”å›çš„ JSON ä¹Ÿå¡è¿› Redux é‡Œï¼Œå¯¼è‡´ Redux å˜å¾—è‡ƒè‚¿ä¸å ªã€‚è¿™çœŸçš„æ˜¯å¯¹çš„å—ï¼Ÿ ä¸‹ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†é€šè¿‡ <strong>React Query (TanStack Query)</strong> æ¥ä¸€åœºæ¶æ„å¤§æ‰«é™¤ã€‚ è¯·çœ‹**ã€Šç¬¬ä¸‰ç¯‡ï¼šåˆ†æ²»â€”â€”æŠŠ API èµ¶å‡º Reduxï¼šæœåŠ¡ç«¯çŠ¶æ€ (Server State) ä¸å®¢æˆ·ç«¯çŠ¶æ€çš„æ¶æ„åˆ†ç¦»ã€‹**ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Kafkaç”Ÿäº§è€…è¯¦è§£ï¼šæ¶ˆæ¯å‘é€æœºåˆ¶ä¸æœ€ä½³å®è·µ]]></title>    <link>https://juejin.cn/post/7603221478474170410</link>    <guid>https://juejin.cn/post/7603221478474170410</guid>    <pubDate>2026-02-06T01:03:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603221478474170410" data-draft-id="7492846604564201487" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Kafkaç”Ÿäº§è€…è¯¦è§£ï¼šæ¶ˆæ¯å‘é€æœºåˆ¶ä¸æœ€ä½³å®è·µ"/> <meta itemprop="keywords" content="Kafka,æ¶ˆæ¯é˜Ÿåˆ—,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2026-02-06T01:03:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Goé«˜å¹¶å‘æ¶æ„_ç‹å·¥"/> <meta itemprop="url" content="https://juejin.cn/user/446863555701561"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Kafkaç”Ÿäº§è€…è¯¦è§£ï¼šæ¶ˆæ¯å‘é€æœºåˆ¶ä¸æœ€ä½³å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/446863555701561/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Goé«˜å¹¶å‘æ¶æ„_ç‹å·¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T01:03:30.000Z" title="Fri Feb 06 2026 01:03:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    23
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»22åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. å¼•è¨€</h2>
<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæ¶ˆæ¯é˜Ÿåˆ—å°±åƒä¸€åº§åº§æ¡¥æ¢ï¼Œè¿æ¥ç€æ•°æ®çš„ç”Ÿäº§ä¸æ¶ˆè´¹ã€‚è€ŒApache Kafkaï¼Œä½œä¸ºé«˜ååã€ä½å»¶è¿Ÿçš„åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—çš„ç¿˜æ¥šï¼Œå…¶ç”Ÿäº§è€…ï¼ˆProducerï¼‰æ— ç–‘æ˜¯è¿™åº§æ¡¥æ¢çš„èµ·ç‚¹ã€‚æ— è®ºæ˜¯å®æ—¶æ—¥å¿—æ”¶é›†ã€è®¢å•æµå¤„ç†ï¼Œè¿˜æ˜¯è·¨ç³»ç»Ÿçš„æ•°æ®åŒæ­¥ï¼Œç”Ÿäº§è€…éƒ½æ‰®æ¼”ç€å°†ä¸šåŠ¡æ•°æ®å¯é ã€é«˜æ•ˆé€è¾¾Kafkaé›†ç¾¤çš„å…³é”®è§’è‰²ã€‚ç„¶è€Œï¼Œç”Ÿäº§è€…çœ‹ä¼¼ç®€å•ï¼Œå®åˆ™æš—è—ç„æœºï¼šæ¶ˆæ¯ä¸¢å¤±ã€æ€§èƒ½ç“¶é¢ˆã€å‚æ•°é…ç½®çš„â€œè¿·é›¾â€ï¼Œå¸¸å¸¸è®©å¼€å‘è€…å¤´ç–¼ä¸å·²ã€‚</p>
<p><strong>è¿™ç¯‡æ–‡ç« çš„ç›®æ ‡</strong>ï¼Œå°±æ˜¯å¸¦ä½ æ·±å…¥Kafkaç”Ÿäº§è€…çš„â€œå‘åŠ¨æœºèˆ±â€ï¼Œæ‹†è§£å®ƒçš„æ ¸å¿ƒæœºåˆ¶ï¼Œåˆ†äº«åŸºäºçœŸå®é¡¹ç›®ç»éªŒçš„ä¼˜åŒ–æŠ€å·§å’Œæœ€ä½³å®è·µã€‚æ— è®ºä½ æ˜¯å¸Œæœ›æå‡æ¶ˆæ¯å‘é€çš„å¯é æ€§ï¼Œè¿˜æ˜¯æƒ³çªç ´æ€§èƒ½ç“¶é¢ˆï¼Œè¿™é‡Œéƒ½æœ‰ä½ éœ€è¦çš„å¹²è´§ã€‚æˆ‘ä»¬å°†ä»ç”Ÿäº§è€…çš„åŸºæœ¬å·¥ä½œæµç¨‹å…¥æ‰‹ï¼Œé€æ­¥å‰–ææ¶ˆæ¯å‘é€æ¨¡å¼ã€å¯é æ€§ä¿éšœã€æ€§èƒ½è°ƒä¼˜ç­‰æ ¸å¿ƒå†…å®¹ï¼Œå¹¶ç»“åˆå®é™…æ¡ˆä¾‹ï¼Œè®©ä½ å¯¹ç”Ÿäº§è€…çš„é…ç½®å’Œä½¿ç”¨èƒ¸æœ‰æˆç«¹ã€‚</p>
<p><strong>å¸¸è§ç—›ç‚¹</strong>ï¼Œä½ æ˜¯å¦ä¹Ÿé‡åˆ°è¿‡ï¼Ÿæ¯”å¦‚ï¼Œæ¶ˆæ¯è«åä¸¢å¤±ï¼ŒæŸ¥æ—¥å¿—å´æ— ä»ä¸‹æ‰‹ï¼›æˆ–è€…å‘é€å»¶è¿Ÿè¿‡é«˜ï¼Œååé‡å´ä¸Šä¸å»ï¼›åˆæˆ–è€…é¢å¯¹ä¸€å †å‚æ•°ï¼ˆå¦‚<code>acks</code>ã€<code>linger.ms</code>ï¼‰ï¼Œå®Œå…¨ä¸çŸ¥é“å¦‚ä½•ä¸‹æ‰‹ã€‚è¿™äº›é—®é¢˜ï¼Œå½’æ ¹ç»“åº•ï¼Œéƒ½ä¸å¯¹ç”Ÿäº§è€…æœºåˆ¶çš„ç†è§£æ·±åº¦æœ‰å…³ã€‚<strong>é€‚ç”¨åœºæ™¯</strong>ä¸Šï¼ŒKafkaç”Ÿäº§è€…å¹¿æ³›ç”¨äºéœ€è¦é«˜å¯é ã€é«˜æ€§èƒ½æ¶ˆæ¯å‘é€çš„ä¸šåŠ¡ï¼Œæ¯”å¦‚æ—¥å¿—æ”¶é›†ã€å®æ—¶æ•°æ®æµå¤„ç†ã€äº‹ä»¶é©±åŠ¨æ¶æ„ç­‰ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä»ç”Ÿäº§è€…çš„æ ¸å¿ƒæœºåˆ¶å¼€å§‹ï¼Œé€æ­¥æ­å¼€å®ƒçš„ç¥ç§˜é¢çº±ã€‚å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬ä¸€èµ·è·³è¿›Kafkaçš„ä¸–ç•Œï¼</p>
<hr/>
<h2 data-id="heading-1">2. Kafkaç”Ÿäº§è€…æ ¸å¿ƒæœºåˆ¶è§£æ</h2>
<p>Kafkaç”Ÿäº§è€…æ˜¯æ¶ˆæ¯æµçš„èµ·ç‚¹ï¼Œä½†å®ƒçš„è¿ä½œè¿œä¸æ­¢â€œå‘é€æ¶ˆæ¯â€é‚£ä¹ˆç®€å•ã€‚å°±åƒä¸€ä½é«˜æ•ˆçš„å¿«é€’å‘˜ï¼Œç”Ÿäº§è€…éœ€è¦æ„é€ åŒ…è£¹ï¼ˆæ¶ˆæ¯ï¼‰ã€é€‰æ‹©æ´¾é€è·¯çº¿ï¼ˆåˆ†åŒºï¼‰ã€æ‰“åŒ…æ‰¹é‡å¯„å‡ºï¼ˆç¼“å†²åŒºç®¡ç†ï¼‰ï¼Œæœ€åç¡®ä¿åŒ…è£¹å®‰å…¨é€è¾¾ï¼ˆBrokeräº¤äº’ï¼‰ã€‚æœ¬èŠ‚å°†è¯¦ç»†æ‹†è§£ç”Ÿäº§è€…çš„æ ¸å¿ƒæœºåˆ¶ï¼ŒåŒ…æ‹¬å·¥ä½œæµç¨‹ã€å‘é€æ¨¡å¼ã€åˆ†åŒºåˆ†é…å’Œç¼“å†²åŒºç®¡ç†ï¼Œå¸¦ä½ çœ‹æ¸…å®ƒçš„æ¯ä¸€ä¸ªâ€œé½¿è½®â€ã€‚</p>
<h3 data-id="heading-2">2.1 ç”Ÿäº§è€…åŸºæœ¬å·¥ä½œæµç¨‹</h3>
<p>ç”Ÿäº§è€…çš„å·¥ä½œæµç¨‹å¯ä»¥æ¯”å–»ä¸ºä¸€æ¡æµæ°´çº¿ï¼šä»æ¶ˆæ¯çš„æ„é€ åˆ°æœ€ç»ˆé€è¾¾Brokerï¼Œæ¯ä¸ªæ­¥éª¤éƒ½ç¯ç¯ç›¸æ‰£ã€‚ä»¥ä¸‹æ˜¯ç”Ÿäº§è€…å‘é€æ¶ˆæ¯çš„æ ¸å¿ƒæ­¥éª¤ï¼š</p>
<ol>
<li><strong>æ¶ˆæ¯æ„é€ </strong>ï¼šç”¨æˆ·é€šè¿‡APIåˆ›å»ºæ¶ˆæ¯ï¼ŒæŒ‡å®šTopicã€Keyï¼ˆå¯é€‰ï¼‰å’ŒValueã€‚</li>
<li><strong>åºåˆ—åŒ–</strong>ï¼šå°†æ¶ˆæ¯çš„Keyå’ŒValueåºåˆ—åŒ–ä¸ºå­—èŠ‚æ•°ç»„ï¼Œæ–¹ä¾¿ç½‘ç»œä¼ è¾“ã€‚</li>
<li><strong>åˆ†åŒºåˆ†é…</strong>ï¼šæ ¹æ®Keyæˆ–è‡ªå®šä¹‰åˆ†åŒºå™¨ï¼Œå†³å®šæ¶ˆæ¯å‘å¾€å“ªä¸ªåˆ†åŒºã€‚</li>
<li><strong>ç¼“å†²åŒºç®¡ç†</strong>ï¼šæ¶ˆæ¯æš‚å­˜åˆ°å†…å­˜ç¼“å†²åŒºï¼Œç­‰å¾…æ‰¹é‡å‘é€ã€‚</li>
<li><strong>æ‰¹é‡å‘é€</strong>ï¼šç¼“å†²åŒºç§¯ç´¯åˆ°ä¸€å®šé‡æˆ–æ—¶é—´åï¼Œæ‰¹é‡å‘é€åˆ°Brokerã€‚</li>
<li><strong>Brokeräº¤äº’</strong>ï¼šä¸Brokeré€šä¿¡ï¼Œè·å–å‘é€ç»“æœï¼ˆå¦‚æˆåŠŸæˆ–å¤±è´¥ï¼‰ã€‚</li>
</ol>
<p><strong>å›¾ç¤ºï¼šç”Ÿäº§è€…å‘é€æµç¨‹</strong></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[ç”¨æˆ·æ¶ˆæ¯]</span> â†’ <span class="hljs-selector-attr">[åºåˆ—åŒ–]</span> â†’ <span class="hljs-selector-attr">[åˆ†åŒºå™¨]</span> â†’ <span class="hljs-selector-attr">[ç¼“å†²åŒº]</span> â†’ <span class="hljs-selector-attr">[æ‰¹é‡å‘é€]</span> â†’ <span class="hljs-selector-attr">[Broker]</span>
</code></pre>
<p><em>ï¼ˆå»ºè®®æ’å…¥æµç¨‹å›¾ï¼Œå±•ç¤ºæ¶ˆæ¯ä»æ„é€ åˆ°é€è¾¾çš„å®Œæ•´è·¯å¾„ï¼ŒåŒ…å«åºåˆ—åŒ–ã€åˆ†åŒºå™¨ã€ç¼“å†²åŒºç­‰å…³é”®èŠ‚ç‚¹ï¼‰</em></p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªåŸºç¡€çš„ç”Ÿäº§è€…ä»£ç ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•é…ç½®å’Œå‘é€æ¶ˆæ¯ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.apache.kafka.clients.producer.KafkaProducer;
<span class="hljs-keyword">import</span> org.apache.kafka.clients.producer.ProducerRecord;
<span class="hljs-keyword">import</span> org.apache.kafka.clients.producer.ProducerConfig;
<span class="hljs-keyword">import</span> java.util.Properties;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BasicProducer</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// é…ç½®ç”Ÿäº§è€…å±æ€§</span>
        <span class="hljs-type">Properties</span> <span class="hljs-variable">props</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();
        props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, <span class="hljs-string">"localhost:9092"</span>);
        props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, <span class="hljs-string">"org.apache.kafka.common.serialization.StringSerializer"</span>);
        props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, <span class="hljs-string">"org.apache.kafka.common.serialization.StringSerializer"</span>);

        <span class="hljs-comment">// åˆ›å»ºç”Ÿäº§è€…å®ä¾‹</span>
        <span class="hljs-keyword">try</span> (KafkaProducer&lt;String, String&gt; producer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">KafkaProducer</span>&lt;&gt;(props)) {
            <span class="hljs-comment">// æ„é€ æ¶ˆæ¯</span>
            ProducerRecord&lt;String, String&gt; record = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProducerRecord</span>&lt;&gt;(<span class="hljs-string">"my-topic"</span>, <span class="hljs-string">"key1"</span>, <span class="hljs-string">"Hello, Kafka!"</span>);
            <span class="hljs-comment">// å‘é€æ¶ˆæ¯</span>
            producer.send(record);
            System.out.println(<span class="hljs-string">"Message sent successfully!"</span>);
        }
    }
}
</code></pre>
<p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>BOOTSTRAP_SERVERS_CONFIG</code>ï¼šæŒ‡å®šKafkaé›†ç¾¤çš„Brokeråœ°å€ã€‚</li>
<li><code>KEY_SERIALIZER_CLASS_CONFIG</code>å’Œ<code>VALUE_SERIALIZER_CLASS_CONFIG</code>ï¼šå®šä¹‰Keyå’ŒValueçš„åºåˆ—åŒ–æ–¹å¼ã€‚</li>
<li><code>ProducerRecord</code>ï¼šå°è£…Topicã€Keyå’ŒValueï¼Œæ„æˆä¸€æ¡æ¶ˆæ¯ã€‚</li>
<li><code>send()</code>ï¼šå¼‚æ­¥å‘é€æ¶ˆæ¯ï¼Œé»˜è®¤ä¸ç­‰å¾…Brokerå“åº”ã€‚</li>
</ul>
<p>è¿™ä¸ªç®€å•çš„ä¾‹å­å±•ç¤ºäº†ç”Ÿäº§è€…çš„åŸºç¡€ç”¨æ³•ï¼Œä½†å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è€ƒè™‘å‘é€æ¨¡å¼ã€å¯é æ€§ç­‰å› ç´ ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ç”Ÿäº§è€…çš„ä¸åŒå‘é€æ¨¡å¼ã€‚</p>
<h3 data-id="heading-3">2.2 æ¶ˆæ¯å‘é€æ¨¡å¼</h3>
<p>Kafkaç”Ÿäº§è€…æ”¯æŒä¸‰ç§å‘é€æ¨¡å¼ï¼š<strong>åŒæ­¥å‘é€</strong>ã€<strong>å¼‚æ­¥å‘é€</strong>å’Œ<strong>ç«åŠ›å…¨å¼€æ¨¡å¼ï¼ˆfire-and-forgetï¼‰</strong>ã€‚æ¯ç§æ¨¡å¼éƒ½æœ‰å…¶é€‚ç”¨åœºæ™¯å’Œæƒè¡¡ã€‚</p>
<ul>
<li><strong>åŒæ­¥å‘é€</strong>ï¼šè°ƒç”¨<code>send()</code>åï¼Œé€šè¿‡<code>get()</code>æ–¹æ³•é˜»å¡ç­‰å¾…Brokerçš„å“åº”ã€‚é€‚åˆå¯¹å¯é æ€§è¦æ±‚é«˜çš„åœºæ™¯ï¼Œä½†ä¼šå¢åŠ å»¶è¿Ÿã€‚</li>
<li><strong>å¼‚æ­¥å‘é€</strong>ï¼šè°ƒç”¨<code>send()</code>åç«‹å³è¿”å›ï¼Œé€šè¿‡å›è°ƒå‡½æ•°å¤„ç†ç»“æœã€‚é€‚åˆé«˜åååœºæ™¯ï¼Œä½†éœ€è¦å¦¥å–„å¤„ç†å›è°ƒä¸­çš„å¼‚å¸¸ã€‚</li>
<li><strong>ç«åŠ›å…¨å¼€æ¨¡å¼</strong>ï¼šè°ƒç”¨<code>send()</code>åä¸å…³å¿ƒç»“æœï¼Œè¿½æ±‚æè‡´æ€§èƒ½ï¼Œä½†å¯èƒ½å¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ï¼Œé€‚åˆå¯¹å¯é æ€§è¦æ±‚ä½çš„åœºæ™¯ï¼ˆå¦‚éƒ¨åˆ†æ—¥å¿—æ”¶é›†ï¼‰ã€‚</li>
</ul>
<p><strong>å¯¹æ¯”è¡¨æ ¼ï¼šå‘é€æ¨¡å¼ä¼˜åŠ£</strong></p>

































<table><thead><tr><th>æ¨¡å¼</th><th>å¯é æ€§</th><th>å»¶è¿Ÿ</th><th>ååé‡</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>åŒæ­¥å‘é€</td><td>é«˜</td><td>é«˜</td><td>ä½</td><td>é‡‘èäº¤æ˜“ã€è®¢å•å¤„ç†</td></tr><tr><td>å¼‚æ­¥å‘é€</td><td>ä¸­-é«˜</td><td>ä½</td><td>é«˜</td><td>å®æ—¶æ—¥å¿—ã€äº‹ä»¶æµ</td></tr><tr><td>ç«åŠ›å…¨å¼€æ¨¡å¼</td><td>ä½</td><td>æœ€ä½</td><td>æœ€é«˜</td><td>éå…³é”®æ—¥å¿—ã€ç›‘æ§æ•°æ®</td></tr></tbody></table>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå¼‚æ­¥å‘é€çš„ç¤ºä¾‹ï¼Œå¸¦å›è°ƒå¤„ç†ï¼š</p>
<pre><code class="hljs language-java" lang="java">producer.send(record, (metadata, exception) -&gt; {
    <span class="hljs-keyword">if</span> (exception == <span class="hljs-literal">null</span>) {
        <span class="hljs-comment">// æˆåŠŸå‘é€</span>
        System.out.printf(<span class="hljs-string">"Sent to topic %s, partition %d, offset %d%n"</span>,
                metadata.topic(), metadata.partition(), metadata.offset());
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// å‘é€å¤±è´¥ï¼Œè®°å½•å¼‚å¸¸</span>
        exception.printStackTrace();
    }
});
</code></pre>
<p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p>
<ul>
<li>å›è°ƒå‡½æ•°æ¥æ”¶<code>metadata</code>ï¼ˆåŒ…å«Topicã€åˆ†åŒºã€åç§»é‡ç­‰ä¿¡æ¯ï¼‰å’Œ<code>exception</code>ï¼ˆå¼‚å¸¸ä¿¡æ¯ï¼‰ã€‚</li>
<li>å¼‚æ­¥å‘é€ä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œé€‚åˆé«˜å¹¶å‘åœºæ™¯ï¼Œä½†éœ€è¦ç¡®ä¿å›è°ƒé€»è¾‘å¥å£®ã€‚</li>
</ul>
<p><strong>è¿‡æ¸¡</strong>ï¼šå‘é€æ¨¡å¼çš„é€‰æ‹©ä¸ºç”Ÿäº§è€…æä¾›äº†çµæ´»æ€§ï¼Œä½†æ¶ˆæ¯æœ€ç»ˆè½åœ¨å“ªä¸ªåˆ†åŒºï¼Œè¿˜å¾—é åˆ†åŒºæœºåˆ¶æ¥å†³å®šã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹åˆ†åŒºä¸é”®åˆ†é…çš„å¥¥ç§˜ã€‚</p>
<h3 data-id="heading-4">2.3 åˆ†åŒºä¸é”®åˆ†é…æœºåˆ¶</h3>
<p>Kafkaçš„Topicç”±å¤šä¸ªåˆ†åŒºï¼ˆPartitionï¼‰ç»„æˆï¼Œåˆ†åŒºå†³å®šäº†æ¶ˆæ¯çš„å­˜å‚¨ä½ç½®å’Œæ¶ˆè´¹é¡ºåºã€‚ç”Ÿäº§è€…é€šè¿‡åˆ†åŒºå™¨ï¼ˆPartitionerï¼‰å†³å®šæ¶ˆæ¯å‘å¾€å“ªä¸ªåˆ†åŒºï¼Œä¸»è¦æœ‰ä»¥ä¸‹ç­–ç•¥ï¼š</p>
<ul>
<li><strong>é»˜è®¤åˆ†åŒºç­–ç•¥</strong>ï¼š
<ul>
<li>å¦‚æœæŒ‡å®šäº†Keyï¼Œé€šè¿‡Keyçš„å“ˆå¸Œå€¼ï¼ˆ<code>murmur2</code>ç®—æ³•ï¼‰æ˜ å°„åˆ°åˆ†åŒºï¼Œç¡®ä¿ç›¸åŒKeyçš„æ¶ˆæ¯è½å…¥åŒä¸€åˆ†åŒºï¼Œé€‚åˆéœ€è¦é¡ºåºæ¶ˆè´¹çš„åœºæ™¯ã€‚</li>
<li>å¦‚æœæœªæŒ‡å®šKeyï¼Œé‡‡ç”¨è½®è¯¢ï¼ˆround-robinï¼‰æ–¹å¼åˆ†é…ï¼Œå‡åŒ€åˆ†å¸ƒæ¶ˆæ¯åˆ°å„åˆ†åŒºï¼Œé€‚åˆæœ€å¤§åŒ–ååé‡ã€‚</li>
</ul>
</li>
<li><strong>è‡ªå®šä¹‰åˆ†åŒºå™¨</strong>ï¼šå®ç°<code>Partitioner</code>æ¥å£ï¼Œæ ¹æ®ä¸šåŠ¡é€»è¾‘åˆ†é…åˆ†åŒºã€‚ä¾‹å¦‚ï¼ŒæŒ‰ç”¨æˆ·IDåˆ†åŒºï¼Œç¡®ä¿åŒä¸€ç”¨æˆ·æ¶ˆæ¯é›†ä¸­å¤„ç†ã€‚</li>
</ul>
<p><strong>å›¾ç¤ºï¼šåˆ†åŒºåˆ†é…é€»è¾‘</strong></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[æ¶ˆæ¯]</span> â†’ <span class="hljs-selector-attr">[æœ‰Key?]</span>
    â†“ æ˜¯        â†“ å¦
 <span class="hljs-selector-attr">[å“ˆå¸Œåˆ†åŒº]</span>   <span class="hljs-selector-attr">[è½®è¯¢åˆ†é…]</span>
    â†“            â†“
 <span class="hljs-selector-attr">[åˆ†åŒº0/1/2...]</span> <span class="hljs-selector-attr">[åˆ†åŒº0/1/2...]</span>
</code></pre>
<p><em>ï¼ˆå»ºè®®æ’å…¥å›¾è¡¨ï¼Œå±•ç¤ºæ¶ˆæ¯é€šè¿‡Keyå“ˆå¸Œæˆ–è½®è¯¢åˆ†é…åˆ°åˆ†åŒºçš„é€»è¾‘ï¼Œæ ‡æ³¨åˆ†åŒºå™¨è§’è‰²ï¼‰</em></p>
<p><strong>å®é™…æ¡ˆä¾‹</strong>ï¼šåœ¨ä¸€ä¸ªç”µå•†ç³»ç»Ÿä¸­ï¼Œè®¢å•æ¶ˆæ¯éœ€è¦æŒ‰ç”¨æˆ·IDé¡ºåºå¤„ç†ã€‚æˆ‘ä»¬é€šè¿‡è®¾ç½®Keyä¸ºç”¨æˆ·IDï¼Œç¡®ä¿åŒä¸€ç”¨æˆ·çš„æ‰€æœ‰è®¢å•æ¶ˆæ¯è½å…¥åŒä¸€åˆ†åŒºï¼Œä»è€Œä¿è¯æ¶ˆè´¹æ—¶çš„é¡ºåºæ€§ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å®ç°ä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java">ProducerRecord&lt;String, String&gt; record = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProducerRecord</span>&lt;&gt;(<span class="hljs-string">"orders"</span>, userId, orderJson);
producer.send(record);
</code></pre>
<p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>userId</code>ä½œä¸ºKeyï¼Œç¡®ä¿åŒä¸€ç”¨æˆ·çš„è®¢å•æ¶ˆæ¯å§‹ç»ˆå‘å¾€åŒä¸€åˆ†åŒºã€‚</li>
<li>æ¶ˆè´¹ç«¯å¯é€šè¿‡å•ä¸€æ¶ˆè´¹è€…çº¿ç¨‹å¤„ç†è¯¥åˆ†åŒºï¼Œä¿è¯æ¶ˆæ¯é¡ºåºã€‚</li>
</ul>
<p><strong>è¸©å‘ç»éªŒ</strong>ï¼šæ›¾ç»åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œæœªè®¾ç½®Keyå¯¼è‡´è®¢å•æ¶ˆæ¯ä¹±åºï¼Œæ¶ˆè´¹è€…å¤„ç†é€»è¾‘å‡ºç°æ··ä¹±ã€‚è§£å†³æ–¹æ³•æ˜¯æ˜ç¡®Keyç­–ç•¥ï¼Œå¹¶åœ¨æ¶ˆè´¹ç«¯éªŒè¯é¡ºåºæ€§ã€‚</p>
<p><strong>è¿‡æ¸¡</strong>ï¼šåˆ†åŒºåˆ†é…å†³å®šäº†æ¶ˆæ¯çš„â€œå½’å®¿â€ï¼Œä½†åœ¨é€å¾€Brokerä¹‹å‰ï¼Œæ¶ˆæ¯è¿˜ä¼šåœ¨ç¼“å†²åŒºâ€œä¼‘æ¯â€ç‰‡åˆ»ã€‚ç¼“å†²åŒºç®¡ç†ç›´æ¥å½±å“æ€§èƒ½ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ·±å…¥æ¢è®¨ã€‚</p>
<h3 data-id="heading-5">2.4 ç”Ÿäº§è€…ç¼“å†²åŒºä¸æ‰¹å¤„ç†</h3>
<p>ç”Ÿäº§è€…ä¸ä¼šç«‹å³å°†æ¶ˆæ¯å‘é€åˆ°Brokerï¼Œè€Œæ˜¯å…ˆå­˜å…¥å†…å­˜ç¼“å†²åŒºï¼ˆ<code>buffer.memory</code>ï¼Œé»˜è®¤32MBï¼‰ï¼Œç­‰å¾…æ‰¹é‡å‘é€ã€‚æ‰¹é‡å‘é€æ˜¯Kafkaé«˜ååçš„ç§˜å¯†æ­¦å™¨ï¼Œä½†ä¹Ÿéœ€è¦åˆç†é…ç½®ä»¥ä¸‹å‚æ•°ï¼š</p>
<ul>
<li><strong><code>buffer.memory</code></strong>ï¼šç¼“å†²åŒºæ€»å¤§å°ï¼Œè¿‡å°å¯èƒ½å¯¼è‡´ç¼“å†²åŒºæº¢å‡ºï¼ˆ<code>BufferExhaustedException</code>ï¼‰ã€‚</li>
<li><strong><code>batch.size</code></strong>ï¼šæ¯ä¸ªåˆ†åŒºçš„æ‰¹æ¬¡å¤§å°ï¼ˆé»˜è®¤16KBï¼‰ï¼Œå†³å®šä¸€æ¬¡å‘é€å¤šå°‘æ¶ˆæ¯ã€‚</li>
<li><strong><code>linger.ms</code></strong>ï¼šæ‰¹æ¬¡ç­‰å¾…æ—¶é—´ï¼ˆé»˜è®¤0msï¼‰ï¼Œå³ä½¿æ‰¹æ¬¡æœªæ»¡ï¼Œç­‰å¾…æ—¶é—´åˆ°ä¹Ÿä¼šå‘é€ã€‚</li>
</ul>
<p><strong>è¡¨æ ¼ï¼šç¼“å†²åŒºå‚æ•°å½±å“</strong></p>





























<table><thead><tr><th>å‚æ•°</th><th>é»˜è®¤å€¼</th><th>ä½œç”¨</th><th>ä¼˜åŒ–å»ºè®®</th></tr></thead><tbody><tr><td>buffer.memory</td><td>32MB</td><td>ç¼“å†²åŒºæ€»å¤§å°</td><td>è§†å†…å­˜è°ƒæ•´ï¼Œå»ºè®®64-128MB</td></tr><tr><td>batch.size</td><td>16KB</td><td>å•æ‰¹æ¬¡å¤§å°</td><td>é«˜åååœºæ™¯å¯è°ƒè‡³128KB</td></tr><tr><td>linger.ms</td><td>0ms</td><td>æ‰¹æ¬¡ç­‰å¾…æ—¶é—´</td><td>ä½å»¶è¿Ÿåœºæ™¯è®¾0ï¼Œé«˜ååè®¾5-10ms</td></tr></tbody></table>
<p><strong>å®é™…æ¡ˆä¾‹</strong>ï¼šåœ¨ä¸€ä¸ªæ—¥å¿—æ”¶é›†ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å°†<code>batch.size</code>ä»16KBè°ƒæ•´åˆ°128KBï¼Œå¹¶è®¾ç½®<code>linger.ms=5</code>ï¼Œååé‡æå‡äº†30%ï¼Œä½†å»¶è¿Ÿç•¥å¢ï¼Œé€‚åˆéå®æ—¶åœºæ™¯ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¼˜åŒ–ç¼“å†²åŒºçš„é…ç½®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">props.put(ProducerConfig.BUFFER_MEMORY_CONFIG, <span class="hljs-number">67108864</span>); <span class="hljs-comment">// 64MB</span>
props.put(ProducerConfig.BATCH_SIZE_CONFIG, <span class="hljs-number">131072</span>); <span class="hljs-comment">// 128KB</span>
props.put(ProducerConfig.LINGER_MS_CONFIG, <span class="hljs-number">5</span>); <span class="hljs-comment">// 5ms</span>
</code></pre>
<p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p>
<ul>
<li>å¢å¤§<code>batch.size</code>é€‚åˆé«˜åååœºæ™¯ï¼Œä½†ä¼šå¢åŠ å†…å­˜å ç”¨ã€‚</li>
<li>è®¾ç½®<code>linger.ms=5</code>è®©æ‰¹æ¬¡ç¨å¾®â€œç­‰ç­‰â€ï¼Œæå‡æ‰¹æ¬¡åˆ©ç”¨ç‡ã€‚</li>
</ul>
<p><strong>è¸©å‘ç»éªŒ</strong>ï¼šæŸé¡¹ç›®å› <code>buffer.memory</code>è¿‡å°ï¼Œé¢‘ç¹æŠ›å‡º<code>BufferExhaustedException</code>ï¼Œå¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ã€‚è§£å†³æ–¹æ³•æ˜¯å¢åŠ å†…å­˜å¹¶ç›‘æ§ç¼“å†²åŒºä½¿ç”¨ç‡ï¼ˆé€šè¿‡JMXæŒ‡æ ‡<code>buffer-total-bytes</code>ï¼‰ã€‚</p>
<p><strong>è¿‡æ¸¡</strong>ï¼šç”Ÿäº§è€…çš„æ ¸å¿ƒæœºåˆ¶ä¸ºæˆ‘ä»¬æ‰“ä¸‹äº†åšå®åŸºç¡€ï¼Œä½†å¦‚ä½•ç¡®ä¿æ¶ˆæ¯ä¸ä¸¢ã€ä¸é‡ï¼Ÿæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¢è®¨å¯é æ€§å’Œä¸€è‡´æ€§ä¿éšœã€‚</p>
<hr/>
<h2 data-id="heading-6">3. ç”Ÿäº§è€…å¯é æ€§ä¸ä¸€è‡´æ€§ä¿éšœ</h2>
<p>Kafkaç”Ÿäº§è€…çš„çµæ´»æ€§ä¸ä»…ä½“ç°åœ¨æ€§èƒ½ä¸Šï¼Œæ›´ä½“ç°åœ¨å®ƒå¯¹æ¶ˆæ¯å¯é æ€§å’Œä¸€è‡´æ€§çš„ä¿éšœèƒ½åŠ›ã€‚æ— è®ºæ˜¯é‡‘èç³»ç»Ÿä¸­çš„æ”¯ä»˜æ¶ˆæ¯ï¼Œè¿˜æ˜¯æ—¥å¿—ç³»ç»Ÿä¸­çš„å…³é”®äº‹ä»¶ï¼Œç”Ÿäº§è€…éƒ½éœ€è¦ç¡®ä¿æ¶ˆæ¯â€œä¸ä¸¢ä¸é‡â€ã€‚æœ¬èŠ‚å°†èšç„¦æ¶ˆæ¯ç¡®è®¤æœºåˆ¶ã€é‡è¯•ä¸å¹‚ç­‰æ€§ï¼Œä»¥åŠäº‹åŠ¡ç”Ÿäº§è€…ï¼Œå¸®ä½ æ„å»ºä¸€ä¸ªâ€œç¨³å¦‚ç£çŸ³â€çš„æ¶ˆæ¯å‘é€æµç¨‹ã€‚</p>
<h3 data-id="heading-7">3.1 æ¶ˆæ¯ç¡®è®¤æœºåˆ¶ï¼ˆAcksï¼‰</h3>
<p>Kafkaç”Ÿäº§è€…é€šè¿‡<code>acks</code>å‚æ•°æ§åˆ¶Brokerå¯¹æ¶ˆæ¯çš„ç¡®è®¤æ–¹å¼ï¼Œç›´æ¥å½±å“å¯é æ€§å’Œæ€§èƒ½ã€‚ä»¥ä¸‹æ˜¯ä¸‰ç§é…ç½®çš„å¯¹æ¯”ï¼š</p>
<ul>
<li><strong><code>acks=0</code></strong>ï¼šç”Ÿäº§è€…å‘é€æ¶ˆæ¯åä¸ç­‰å¾…Brokerç¡®è®¤ï¼Œè¿½æ±‚æè‡´æ€§èƒ½ï¼Œä½†å¯èƒ½å› ç½‘ç»œé—®é¢˜å¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ã€‚</li>
<li><strong><code>acks=1</code></strong>ï¼šç”Ÿäº§è€…ç­‰å¾…Leaderå‰¯æœ¬ç¡®è®¤å†™å…¥ï¼Œå¹³è¡¡æ€§èƒ½ä¸å¯é æ€§ï¼Œä½†è‹¥Leaderå®•æœºï¼Œå¯èƒ½ä¸¢å¤±æœªåŒæ­¥çš„æ¶ˆæ¯ã€‚</li>
<li><strong><code>acks=all</code></strong>ï¼šç”Ÿäº§è€…ç­‰å¾…æ‰€æœ‰ISRï¼ˆIn-Sync Replicasï¼‰å‰¯æœ¬ç¡®è®¤ï¼Œæœ€é«˜å¯é æ€§ï¼Œä½†å»¶è¿Ÿç¨é«˜ã€‚</li>
</ul>
<p><strong>è¡¨æ ¼ï¼šAcksé…ç½®å¯¹æ¯”</strong></p>

































<table><thead><tr><th>é…ç½®</th><th>å¯é æ€§</th><th>å»¶è¿Ÿ</th><th>ååé‡</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>acks=0</td><td>ä½</td><td>æœ€ä½</td><td>æœ€é«˜</td><td>éå…³é”®æ—¥å¿—ã€ç›‘æ§æ•°æ®</td></tr><tr><td>acks=1</td><td>ä¸­</td><td>ä¸­</td><td>é«˜</td><td>æ™®é€šä¸šåŠ¡æ¶ˆæ¯</td></tr><tr><td>acks=all</td><td>é«˜</td><td>é«˜</td><td>ä¸­</td><td>é‡‘èäº¤æ˜“ã€å…³é”®äº‹ä»¶</td></tr></tbody></table>
<p><strong>å…³é”®ç‚¹</strong>ï¼š<code>acks=all</code>ç»“åˆ<code>min.insync.replicas</code>ï¼ˆBrokerç«¯å‚æ•°ï¼Œå»ºè®®è®¾ä¸º2æˆ–3ï¼‰å¯ç¡®ä¿æ¶ˆæ¯è‡³å°‘å†™å…¥å¤šä¸ªå‰¯æœ¬ï¼Œè¿›ä¸€æ­¥æå‡å¯é æ€§ã€‚</p>
<p><strong>å®é™…æ¡ˆä¾‹</strong>ï¼šåœ¨ä¸€ä¸ªé‡‘èæ”¯ä»˜ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬é…ç½®<code>acks=all</code>å¹¶è®¾ç½®<code>min.insync.replicas=2</code>ï¼Œç¡®ä¿æ”¯ä»˜æ¶ˆæ¯å³ä½¿åœ¨Leaderå®•æœºåä»èƒ½è¢«å…¶ä»–å‰¯æœ¬ä¿å­˜ï¼Œé¿å…äº†èµ„é‡‘è®°å½•ä¸¢å¤±çš„é£é™©ã€‚</p>
<p>ä»¥ä¸‹æ˜¯é…ç½®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">props.put(ProducerConfig.ACKS_CONFIG, <span class="hljs-string">"all"</span>);
</code></pre>
<p><strong>è¸©å‘ç»éªŒ</strong>ï¼šæŸé¡¹ç›®åˆæœŸä½¿ç”¨<code>acks=0</code>è¿½æ±‚æ€§èƒ½ï¼Œç»“æœå› ç½‘ç»œæŠ–åŠ¨ä¸¢å¤±éƒ¨åˆ†æ—¥å¿—æ•°æ®ã€‚ä¿®å¤æ–¹æ¡ˆæ˜¯æ”¹ä¸º<code>acks=1</code>ï¼Œå¹¶é€šè¿‡æ¶ˆè´¹è€…ç«¯éªŒè¯æ¶ˆæ¯å®Œæ•´æ€§ã€‚</p>
<p><strong>è¿‡æ¸¡</strong>ï¼šç¡®è®¤æœºåˆ¶ä¿è¯äº†æ¶ˆæ¯é€è¾¾ï¼Œä½†ç½‘ç»œæˆ–Brokerå¼‚å¸¸å¯èƒ½å¯¼è‡´å‘é€å¤±è´¥ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹å¦‚ä½•é€šè¿‡é‡è¯•å’Œå¹‚ç­‰æ€§åº”å¯¹è¿™äº›é—®é¢˜ã€‚</p>
<h3 data-id="heading-8">3.2 é‡è¯•æœºåˆ¶ä¸å¹‚ç­‰æ€§</h3>
<p>ç”Ÿäº§è€…æ”¯æŒè‡ªåŠ¨é‡è¯•ï¼Œå¤„ç†ä¸´æ—¶æ€§å¤±è´¥ï¼ˆå¦‚ç½‘ç»œæŠ–åŠ¨æˆ–Leaderåˆ‡æ¢ï¼‰ã€‚å…³é”®å‚æ•°åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong><code>retries</code></strong>ï¼šé‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤<code>Integer.MAX_VALUE</code>ï¼ˆKafka 2.0+ï¼‰ï¼Œä½†éœ€åˆç†è®¾ç½®ä»¥é¿å…æ— é™é‡è¯•ã€‚</li>
<li><strong><code>retry.backoff.ms</code></strong>ï¼šé‡è¯•é—´éš”ï¼Œé»˜è®¤100msï¼Œé˜²æ­¢é¢‘ç¹é‡è¯•å†²å‡»Brokerã€‚</li>
</ul>
<p>ç„¶è€Œï¼Œé‡è¯•å¯èƒ½å¯¼è‡´æ¶ˆæ¯é‡å¤å‘é€ï¼Œå°¤å…¶åœ¨å¼‚æ­¥å‘é€ä¸­ã€‚<strong>å¹‚ç­‰ç”Ÿäº§è€…</strong>é€šè¿‡<code>enable.idempotence=true</code>è§£å†³æ­¤é—®é¢˜ï¼Œç¡®ä¿æ¶ˆæ¯â€œæœ€å¤šå‘é€ä¸€æ¬¡â€ï¼ˆat-least-onceå˜ä¸ºexactly-onceï¼‰ã€‚</p>
<p><strong>å›¾ç¤ºï¼šå¹‚ç­‰ç”Ÿäº§è€…å·¥ä½œåŸç†</strong></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[ç”Ÿäº§è€…]</span> â†’ <span class="hljs-selector-attr">[åˆ†é…PID+åºåˆ—å·]</span> â†’ <span class="hljs-selector-attr">[BrokeréªŒè¯åºåˆ—å·]</span> â†’ <span class="hljs-selector-attr">[å»é‡å†™å…¥]</span>
</code></pre>
<p><em>ï¼ˆå»ºè®®æ’å…¥ç¤ºæ„å›¾ï¼Œå±•ç¤ºç”Ÿäº§è€…ä¸ºæ¶ˆæ¯åˆ†é…PIDå’Œåºåˆ—å·ï¼ŒBrokeréªŒè¯å»é‡çš„è¿‡ç¨‹ï¼‰</em></p>
<p><strong>å®é™…æ¡ˆä¾‹</strong>ï¼šåœ¨ä¸€ä¸ªåº“å­˜ç³»ç»Ÿä¸­ï¼Œé‡è¯•å¯¼è‡´é‡å¤æ‰£å‡åº“å­˜ã€‚æˆ‘ä»¬å¯ç”¨å¹‚ç­‰ç”Ÿäº§è€…ï¼Œé¿å…äº†é‡å¤æ¶ˆæ¯çš„å‰¯ä½œç”¨ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å¹‚ç­‰ç”Ÿäº§è€…çš„é…ç½®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">props.put(ProducerConfig.ENABLE_IDEMPOTENCE_CONFIG, <span class="hljs-literal">true</span>);
props.put(ProducerConfig.RETRIES_CONFIG, <span class="hljs-number">5</span>); <span class="hljs-comment">// åˆç†é™åˆ¶é‡è¯•æ¬¡æ•°</span>
props.put(ProducerConfig.ACKS_CONFIG, <span class="hljs-string">"all"</span>); <span class="hljs-comment">// å¹‚ç­‰æ€§è¦æ±‚acks=all</span>
</code></pre>
<p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>enable.idempotence=true</code>ä¸ºæ¯æ¡æ¶ˆæ¯åˆ†é…å”¯ä¸€æ ‡è¯†ï¼ˆPID+åºåˆ—å·ï¼‰ï¼ŒBrokeræ ¹æ®æ ‡è¯†å»é‡ã€‚</li>
<li>é™åˆ¶<code>retries</code>é¿å…æ— é™é‡è¯•ï¼Œå‡å°‘èµ„æºæµªè´¹ã€‚</li>
</ul>
<p><strong>è¸©å‘ç»éªŒ</strong>ï¼šæŸé¡¹ç›®å› æœªè®¾ç½®<code>enable.idempotence</code>ï¼Œé‡è¯•å¯¼è‡´æ¶ˆæ¯é‡å¤ï¼Œæ¶ˆè´¹è€…ç«¯éœ€é¢å¤–å®ç°å»é‡é€»è¾‘ã€‚å¯ç”¨å¹‚ç­‰åï¼Œé—®é¢˜è¿åˆƒè€Œè§£ã€‚</p>
<p><strong>è¿‡æ¸¡</strong>ï¼šå¹‚ç­‰æ€§è§£å†³äº†å•Topicçš„é‡å¤é—®é¢˜ï¼Œä½†å¦‚æœæ¶‰åŠè·¨Topicæˆ–å¤–éƒ¨ç³»ç»Ÿä¸€è‡´æ€§ï¼Œæˆ‘ä»¬éœ€è¦æ›´å¼ºå¤§çš„å·¥å…·â€”â€”äº‹åŠ¡ç”Ÿäº§è€…ã€‚</p>
<h3 data-id="heading-9">3.3 äº‹åŠ¡ç”Ÿäº§è€…</h3>
<p>äº‹åŠ¡ç”Ÿäº§è€…é€šè¿‡<code>transactional.id</code>å®ç°exactly-onceè¯­ä¹‰ï¼Œç¡®ä¿æ¶ˆæ¯å‘é€å’Œå¤–éƒ¨æ“ä½œï¼ˆå¦‚æ•°æ®åº“æ›´æ–°ï¼‰åŸå­æ€§ã€‚å…¸å‹åœºæ™¯åŒ…æ‹¬ï¼š</p>
<ul>
<li>è·¨Topicæ¶ˆæ¯ä¸€è‡´æ€§ï¼šå¤šä¸ªTopicçš„æ¶ˆæ¯è¦ä¹ˆå…¨æˆåŠŸï¼Œè¦ä¹ˆå…¨å¤±è´¥ã€‚</li>
<li>ä¸å¤–éƒ¨ç³»ç»ŸåŒæ­¥ï¼šå¦‚æ•°æ®åº“æ›´æ–°ä¸Kafkaæ¶ˆæ¯ä¿æŒä¸€è‡´ã€‚</li>
</ul>
<p><strong>å…³é”®ç‚¹</strong>ï¼šäº‹åŠ¡ç”Ÿäº§è€…éœ€åˆå§‹åŒ–äº‹åŠ¡å¹¶æ˜¾å¼æäº¤æˆ–å›æ»šï¼Œé…ç½®å¤æ‚ä½†å¯é æ€§æé«˜.</p>
<p>ä»¥ä¸‹æ˜¯äº‹åŠ¡ç”Ÿäº§è€…çš„ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java">props.put(ProducerConfig.TRANSACTIONAL_ID_CONFIG, <span class="hljs-string">"tx-producer-1"</span>);
KafkaProducer&lt;String, String&gt; producer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">KafkaProducer</span>&lt;&gt;(props);

<span class="hljs-comment">// åˆå§‹åŒ–äº‹åŠ¡</span>
producer.initTransactions();

<span class="hljs-keyword">try</span> {
    producer.beginTransaction();
    <span class="hljs-comment">// å‘é€å¤šæ¡æ¶ˆæ¯</span>
    producer.send(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ProducerRecord</span>&lt;&gt;(<span class="hljs-string">"topic1"</span>, <span class="hljs-string">"key"</span>, <span class="hljs-string">"value1"</span>));
    producer.send(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ProducerRecord</span>&lt;&gt;(<span class="hljs-string">"topic2"</span>, <span class="hljs-string">"key"</span>, <span class="hljs-string">"value2"</span>));
    <span class="hljs-comment">// æäº¤äº‹åŠ¡</span>
    producer.commitTransaction();
} <span class="hljs-keyword">catch</span> (Exception e) {
    <span class="hljs-comment">// å›æ»šäº‹åŠ¡</span>
    producer.abortTransaction();
    e.printStackTrace();
}
</code></pre>
<p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>transactional.id</code>ç¡®ä¿äº‹åŠ¡å”¯ä¸€æ€§ï¼ŒBrokeræ ¹æ®IDç®¡ç†äº‹åŠ¡çŠ¶æ€ã€‚</li>
<li><code>initTransactions()</code>åˆå§‹åŒ–äº‹åŠ¡ç¯å¢ƒï¼Œå¿…é¡»åœ¨é¦–æ¬¡ä½¿ç”¨æ—¶è°ƒç”¨ã€‚</li>
<li>å¼‚å¸¸æ—¶è°ƒç”¨<code>abortTransaction()</code>å›æ»šï¼Œé¿å…éƒ¨åˆ†æäº¤ã€‚</li>
</ul>
<p><strong>å®é™…æ¡ˆä¾‹</strong>ï¼šåœ¨è®¢å•ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº‹åŠ¡ç”Ÿäº§è€…ç¡®ä¿è®¢å•æ¶ˆæ¯å’Œåº“å­˜æ‰£å‡æ¶ˆæ¯åŒæ—¶å†™å…¥ä¸¤ä¸ªTopicï¼Œé¿å…äº†æ•°æ®ä¸ä¸€è‡´ã€‚</p>
<p><strong>è¿‡æ¸¡</strong>ï¼šé€šè¿‡ç¡®è®¤æœºåˆ¶ã€å¹‚ç­‰æ€§å’Œäº‹åŠ¡ï¼Œç”Ÿäº§è€…çš„å¯é æ€§å·²å›ºè‹¥é‡‘æ±¤ã€‚ä½†åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œæ€§èƒ½ä¼˜åŒ–åŒæ ·é‡è¦ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¢è®¨å¦‚ä½•è®©ç”Ÿäº§è€…è·‘å¾—æ›´å¿«ã€‚</p>
<hr/>
<h2 data-id="heading-10">4. æ€§èƒ½ä¼˜åŒ–ä¸å‚æ•°è°ƒä¼˜</h2>
<p>Kafkaç”Ÿäº§è€…å°±åƒä¸€è¾†è·‘è½¦ï¼Œæ€§èƒ½æ½œåŠ›å·¨å¤§ï¼Œä½†éœ€è¦ç²¾å¿ƒè°ƒæ ¡æ‰èƒ½å‘æŒ¥æè‡´é€Ÿåº¦ã€‚æœ¬èŠ‚å°†èšç„¦å…³é”®å‚æ•°è°ƒä¼˜ã€æ‰¹é‡å‘é€ä¼˜åŒ–å’Œå¤šçº¿ç¨‹ç®¡ç†ï¼Œåˆ†äº«å¦‚ä½•åœ¨å®é™…é¡¹ç›®ä¸­æå‡ååé‡å¹¶æ§åˆ¶å»¶è¿Ÿã€‚</p>
<h3 data-id="heading-11">4.1 å…³é”®å‚æ•°è°ƒä¼˜</h3>
<p>ä»¥ä¸‹æ˜¯å‡ ä¸ªå¯¹æ€§èƒ½å½±å“è¾ƒå¤§çš„å‚æ•°ï¼š</p>
<ul>
<li><strong><code>compression.type</code></strong>ï¼šæ”¯æŒ<code>gzip</code>ã€<code>snappy</code>ã€<code>lz4</code>å’Œ<code>zstd</code>ï¼Œå‹ç¼©å¯æ˜¾è‘—å‡å°‘ç½‘ç»œä¼ è¾“é‡ã€‚</li>
<li><strong><code>max.in.flight.requests.per.connection</code></strong>ï¼šæ§åˆ¶æ¯ä¸ªè¿æ¥çš„æœªå®Œæˆè¯·æ±‚æ•°ï¼Œé»˜è®¤5ï¼Œè°ƒé«˜å¯æå‡ååï¼Œä½†å¯èƒ½å¢åŠ ä¹±åºé£é™©ã€‚</li>
<li><strong><code>delivery.timeout.ms</code></strong>ï¼šæ¶ˆæ¯å‘é€çš„æ€»è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤120ç§’ï¼Œéœ€æ ¹æ®ä¸šåŠ¡å»¶è¿Ÿè¦æ±‚è°ƒæ•´ã€‚</li>
</ul>
<p><strong>è¡¨æ ¼ï¼šå‹ç¼©ç±»å‹å¯¹æ¯”</strong></p>








































<table><thead><tr><th>ç±»å‹</th><th>å‹ç¼©æ¯”</th><th>é€Ÿåº¦</th><th>CPUå ç”¨</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>gzip</td><td>é«˜</td><td>æ…¢</td><td>é«˜</td><td>å¸¦å®½å—é™ã€é«˜åå</td></tr><tr><td>snappy</td><td>ä¸­</td><td>å¿«</td><td>ä¸­</td><td>å¹³è¡¡æ€§èƒ½ä¸å‹ç¼©</td></tr><tr><td>lz4</td><td>ä¸­</td><td>å¾ˆå¿«</td><td>ä½</td><td>é«˜æ€§èƒ½ã€ä½å»¶è¿Ÿ</td></tr><tr><td>zstd</td><td>å¾ˆé«˜</td><td>ä¸­</td><td>ä¸­</td><td>æ–°åœºæ™¯ï¼Œéœ€æµ‹è¯•å…¼å®¹æ€§</td></tr></tbody></table>
<p><strong>å®é™…æ¡ˆä¾‹</strong>ï¼šåœ¨ä¸€ä¸ªæ—¥å¿—ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å°†<code>compression.type</code>ä»<code>none</code>æ”¹ä¸º<code>snappy</code>ï¼Œç½‘ç»œæµé‡å‡å°‘40%ï¼Œååé‡æå‡20%ã€‚</p>
<p>ä»¥ä¸‹æ˜¯é«˜ååé…ç½®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">props.put(ProducerConfig.COMPRESSION_TYPE_CONFIG, <span class="hljs-string">"snappy"</span>);
props.put(ProducerConfig.MAX_IN_FLIGHT_REQUESTS_PER_CONNECTION, <span class="hljs-number">5</span>);
props.put(ProducerConfig.DELIVERY_TIMEOUT_MS_CONFIG, <span class="hljs-number">60000</span>); <span class="hljs-comment">// 60ç§’</span>
</code></pre>
<p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>snappy</code>å‹ç¼©é€‚åˆå¤§å¤šæ•°åœºæ™¯ï¼Œå¹³è¡¡æ€§èƒ½å’Œå‹ç¼©æ¯”ã€‚</li>
<li>è°ƒé«˜<code>max.in.flight.requests</code>éœ€ç¡®ä¿å¹‚ç­‰æ€§å¼€å¯ï¼Œé¿å…ä¹±åºã€‚</li>
</ul>
<h3 data-id="heading-12">4.2 æ‰¹é‡å‘é€ä¼˜åŒ–</h3>
<p>æ‰¹é‡å‘é€æ˜¯Kafkaé«˜ååçš„æ ¸å¿ƒï¼Œä½†<code>batch.size</code>å’Œ<code>linger.ms</code>çš„é…ç½®éœ€æƒè¡¡ååé‡ä¸å»¶è¿Ÿï¼š</p>
<ul>
<li><strong><code>batch.size</code></strong>ï¼šè¿‡å°å¯¼è‡´æ‰¹æ¬¡é¢‘ç¹å‘é€ï¼Œé™ä½ååï¼›è¿‡å¤§å¢åŠ å†…å­˜å‹åŠ›ã€‚</li>
<li><strong><code>linger.ms</code></strong>ï¼šé€‚å½“å»¶è¿Ÿï¼ˆå¦‚5-10msï¼‰å¯ç§¯ç´¯æ›´å¤šæ¶ˆæ¯ï¼Œä½†å»¶è¿Ÿæ•æ„Ÿåœºæ™¯éœ€è®¾ä¸º0ã€‚</li>
</ul>
<p><strong>å®é™…æ¡ˆä¾‹</strong>ï¼šåœ¨ä¸€ä¸ªå®æ—¶ç›‘æ§ç³»ç»Ÿä¸­ï¼Œåˆå§‹<code>linger.ms=50</code>å¯¼è‡´å»¶è¿Ÿè¿‡é«˜ã€‚æˆ‘ä»¬è°ƒæ•´ä¸º<code>linger.ms=2</code>ï¼Œå»¶è¿Ÿé™è‡³10msä»¥å†…ï¼Œååé‡ä»…ç•¥æœ‰ä¸‹é™ã€‚</p>
<p><strong>è¸©å‘ç»éªŒ</strong>ï¼šæŸé¡¹ç›®å› <code>batch.size</code>è®¾ä¸º1MBï¼Œå†…å­˜å ç”¨æ¿€å¢ï¼Œè§¦å‘GCé—®é¢˜ã€‚ä¼˜åŒ–åè®¾ä¸º128KBï¼Œæ€§èƒ½ç¨³å®šã€‚</p>
<h3 data-id="heading-13">4.3 å¤šçº¿ç¨‹ä¸ç”Ÿäº§è€…å®ä¾‹ç®¡ç†</h3>
<p>Kafkaç”Ÿäº§è€…æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå•ä¸ªå®ä¾‹å¯ç”±å¤šçº¿ç¨‹å…±äº«ã€‚ä½†åœ¨è¶…é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå¤šç”Ÿäº§è€…å®ä¾‹å¯èƒ½æ›´ä¼˜ã€‚</p>
<p><strong>å¯¹æ¯”ï¼šå•ç”Ÿäº§è€… vs å¤šç”Ÿäº§è€…</strong></p>




















<table><thead><tr><th>æ–¹å¼</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td>å•ç”Ÿäº§è€…</td><td>èµ„æºå ç”¨ä½ï¼Œç®¡ç†ç®€å•</td><td>å¯èƒ½æˆä¸ºæ€§èƒ½ç“¶é¢ˆ</td></tr><tr><td>å¤šç”Ÿäº§è€…</td><td>é«˜å¹¶å‘ä¸‹ååé‡æ›´é«˜</td><td>ç®¡ç†å¤æ‚ï¼Œå†…å­˜å ç”¨å¢åŠ </td></tr></tbody></table>
<p><strong>æœ€ä½³å®è·µ</strong>ï¼šä¸­å°å‹åº”ç”¨ä½¿ç”¨å•ç”Ÿäº§è€…+å¤šçº¿ç¨‹ï¼›è¶…é«˜åååœºæ™¯ï¼ˆå¦‚æ¯ç§’ç™¾ä¸‡æ¶ˆæ¯ï¼‰å¯åˆ›å»ºå¤šä¸ªç”Ÿäº§è€…å®ä¾‹ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å¤šçº¿ç¨‹ç”Ÿäº§è€…ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MultiThreadProducer</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Properties</span> <span class="hljs-variable">props</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();
        props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, <span class="hljs-string">"localhost:9092"</span>);
        props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, <span class="hljs-string">"org.apache.kafka.common.serialization.StringSerializer"</span>);
        props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, <span class="hljs-string">"org.apache.kafka.common.serialization.StringSerializer"</span>);

        KafkaProducer&lt;String, String&gt; producer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">KafkaProducer</span>&lt;&gt;(props);

        <span class="hljs-comment">// å¯åŠ¨å¤šä¸ªçº¿ç¨‹å…±äº«ç”Ÿäº§è€…</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
                <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
                    ProducerRecord&lt;String, String&gt; record = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProducerRecord</span>&lt;&gt;(<span class="hljs-string">"my-topic"</span>, <span class="hljs-string">"key"</span>, <span class="hljs-string">"value"</span>);
                    producer.send(record);
                }
            }).start();
        }
    }
}
</code></pre>
<p><strong>ä»£ç è¯´æ˜</strong>ï¼š</p>
<ul>
<li>å•ä¸ª<code>KafkaProducer</code>å®ä¾‹è¢«å¤šä¸ªçº¿ç¨‹å…±äº«ï¼Œå†…éƒ¨é˜Ÿåˆ—ç¡®ä¿çº¿ç¨‹å®‰å…¨ã€‚</li>
<li>é¿å…ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ›å»ºç‹¬ç«‹ç”Ÿäº§è€…ï¼Œå‡å°‘èµ„æºæµªè´¹ã€‚</li>
</ul>
<p><strong>è¿‡æ¸¡</strong>ï¼šæ€§èƒ½ä¼˜åŒ–è®©ç”Ÿäº§è€…è·‘å¾—æ›´å¿«ï¼Œä½†å®é™…é¡¹ç›®ä¸­ï¼Œé…ç½®ä¸å½“æˆ–å¼‚å¸¸å¤„ç†ä¸åˆ°ä½å¯èƒ½å¯¼è‡´â€œç¿»è½¦â€ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ†äº«æœ€ä½³å®è·µå’Œè¸©å‘ç»éªŒã€‚</p>
<hr/>
<h2 data-id="heading-14">5. æœ€ä½³å®è·µä¸è¸©å‘ç»éªŒ</h2>
<p>Kafkaç”Ÿäº§è€…çš„å¼ºå¤§ä¹‹å¤„åœ¨äºå®ƒçš„çµæ´»æ€§ï¼Œä½†çµæ´»æ€§ä¹Ÿå¸¦æ¥äº†å¤æ‚æ€§ã€‚åŸºäº10å¹´åˆ†å¸ƒå¼ç³»ç»Ÿç»éªŒï¼Œæœ¬èŠ‚æ€»ç»“äº†ç”Ÿäº§ç¯å¢ƒçš„æ¨èå®è·µï¼Œå¹¶åˆ†äº«å¸¸è§è¸©å‘åŠè§£å†³æ–¹æ¡ˆï¼Œå¸®åŠ©ä½ å°‘èµ°å¼¯è·¯ã€‚</p>
<h3 data-id="heading-15">5.1 æœ€ä½³å®è·µ</h3>
<ul>
<li><strong>é…ç½®è§„èŒƒåŒ–</strong>ï¼šç”Ÿäº§ç¯å¢ƒæ¨èä»¥ä¸‹é…ç½®ï¼š
<ul>
<li><code>acks=all</code>ï¼Œç¡®ä¿é«˜å¯é æ€§ã€‚</li>
<li><code>enable.idempotence=true</code>ï¼Œé˜²æ­¢é‡å¤å‘é€ã€‚</li>
<li><code>compression.type=snappy</code>ï¼Œå¹³è¡¡æ€§èƒ½ä¸å‹ç¼©ã€‚</li>
<li><code>linger.ms=5</code>ï¼Œæå‡æ‰¹æ¬¡æ•ˆç‡ã€‚</li>
</ul>
</li>
<li><strong>ç›‘æ§ä¸å‘Šè­¦</strong>ï¼šé€šè¿‡JMXç›‘æ§å…³é”®æŒ‡æ ‡ï¼Œå¦‚<code>buffer-full</code>ï¼ˆç¼“å†²åŒºæº¢å‡ºï¼‰ã€<code>record-error-rate</code>ï¼ˆé”™è¯¯ç‡ï¼‰ã€‚å»ºè®®é›†æˆPrometheus+Grafanaï¼Œè®¾ç½®å‘Šè­¦é˜ˆå€¼ã€‚</li>
<li><strong>åˆ†åŒºè§„åˆ’</strong>ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚è®¾ç½®åˆ†åŒºæ•°ï¼Œå»ºè®®åˆ†åŒºæ•°ä¸ºBrokeræ•°çš„2-3å€ï¼Œç¡®ä¿è´Ÿè½½å‡è¡¡ã€‚</li>
<li><strong>ä¼˜é›…å…³é—­</strong>ï¼šè°ƒç”¨<code>producer.close()</code>ç­‰å¾…ç¼“å†²åŒºæ¶ˆæ¯å‘é€å®Œæˆï¼Œé¿å…å…³é—­æ—¶ä¸¢å¤±æ¶ˆæ¯ã€‚</li>
</ul>
<p><strong>å®é™…æ¡ˆä¾‹</strong>ï¼šåœ¨ä¸€ä¸ªç”µå•†åº“å­˜ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬é€šè¿‡è§„åˆ’åˆ†åŒºæ•°ï¼ˆBrokeræ•°Ã—2ï¼‰å’Œç›‘æ§<code>record-queue-time-avg</code>æŒ‡æ ‡ï¼Œä¼˜åŒ–äº†åº“å­˜æ¶ˆæ¯çš„å¤„ç†æ•ˆç‡ï¼Œå»¶è¿Ÿä»50msé™è‡³20msã€‚</p>
<h3 data-id="heading-16">5.2 å¸¸è§è¸©å‘ä¸è§£å†³æ–¹æ¡ˆ</h3>
<ul>
<li><strong>æ¶ˆæ¯ä¸¢å¤±</strong>ï¼š
<ul>
<li><strong>åŸå› </strong>ï¼š<code>acks=0</code>æˆ–ç¼“å†²åŒºæº¢å‡ºï¼ˆ<code>buffer.memory</code>ä¸è¶³ï¼‰ã€‚</li>
<li><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šè®¾<code>acks=all</code>ï¼Œå¢å¤§<code>buffer.memory</code>è‡³64MBï¼Œç›‘æ§<code>buffer-exhausted-rate</code>ã€‚</li>
<li><strong>æ¡ˆä¾‹</strong>ï¼šæŸæ—¥å¿—ç³»ç»Ÿå› <code>acks=0</code>ä¸¢å¤±å…³é”®äº‹ä»¶ï¼Œæ”¹ä¸º<code>acks=1</code>å¹¶éªŒè¯æ¶ˆè´¹è€…ç«¯å®Œæ•´æ€§ã€‚</li>
</ul>
</li>
<li><strong>æ€§èƒ½ç“¶é¢ˆ</strong>ï¼š
<ul>
<li><strong>åŸå› </strong>ï¼š<code>linger.ms</code>è¿‡é«˜ï¼ˆå¦‚100msï¼‰å¯¼è‡´å»¶è¿Ÿå¢åŠ ã€‚</li>
<li><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šè°ƒä½è‡³5-10msï¼Œç»“åˆ<code>batch.size=128KB</code>ã€‚</li>
<li><strong>æ¡ˆä¾‹</strong>ï¼šä¿®å¤æŸé¡¹ç›®å› <code>linger.ms=200</code>å¯¼è‡´çš„å»¶è¿Ÿé—®é¢˜ï¼Œååé‡æå‡50%ã€‚</li>
</ul>
</li>
<li><strong>åºåˆ—izationé—®é¢˜</strong>ï¼š
<ul>
<li><strong>åŸå› </strong>ï¼šè‡ªå®šä¹‰åºåˆ—åŒ–å™¨ä¸æ¶ˆè´¹è€…ä¸å…¼å®¹ï¼Œå¯¼è‡´ååºåˆ—åŒ–å¤±è´¥ã€‚</li>
<li><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šä½¿ç”¨æ ‡å‡†åºåˆ—åŒ–å™¨ï¼ˆå¦‚JSONã€Avroï¼‰ï¼Œå¹¶è®°å½•Schemaã€‚</li>
</ul>
</li>
<li><strong>Brokerå¼‚å¸¸</strong>ï¼š
<ul>
<li><strong>åŸå› </strong>ï¼šLeaderåˆ‡æ¢æˆ–ç½‘ç»œæŠ–åŠ¨å¯¼è‡´å‘é€å¤±è´¥ã€‚</li>
<li><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šé…ç½®<code>retries=5</code>å’Œ<code>retry.backoff.ms=200</code>ï¼Œå¯ç”¨å¹‚ç­‰æ€§ã€‚</li>
</ul>
</li>
</ul>
<p><strong>å®é™…æ¡ˆä¾‹</strong>ï¼šæŸé¡¹ç›®å› é‡è¯•æ¬¡æ•°è®¾ä¸º0ï¼ŒBrokerçŸ­æš‚æŠ–åŠ¨å³å¯¼è‡´æ¶ˆæ¯å †ç§¯ã€‚æˆ‘ä»¬è°ƒæ•´<code>retries=5</code>å¹¶ç›‘æ§<code>request-latency-avg</code>ï¼Œé—®é¢˜è§£å†³ã€‚</p>
<p><strong>è¿‡æ¸¡</strong>ï¼šé€šè¿‡æœ€ä½³å®è·µå’Œè¸©å‘ç»éªŒï¼Œæˆ‘ä»¬èƒ½æ›´å¥½åœ°é©¾é©­ç”Ÿäº§è€…ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹ç”Ÿäº§è€…åœ¨çœŸå®é¡¹ç›®ä¸­çš„è¡¨ç°ã€‚</p>
<hr/>
<h2 data-id="heading-17">6. å®é™…é¡¹ç›®åº”ç”¨åœºæ™¯</h2>
<p>Kafkaç”Ÿäº§è€…çš„å¼ºå¤§ä¹‹å¤„åœ¨äºå®ƒçš„æ™®é€‚æ€§ï¼Œæ— è®ºæ˜¯æ—¥å¿—æ”¶é›†ã€è®¢å•å¤„ç†ï¼Œè¿˜æ˜¯æ•°æ®åŒæ­¥ï¼Œéƒ½èƒ½æ¸¸åˆƒæœ‰ä½™ã€‚æœ¬èŠ‚é€šè¿‡ä¸‰ä¸ªå…¸å‹åœºæ™¯ï¼Œå±•ç¤ºç”Ÿäº§è€…çš„é…ç½®ä¸å®ç°ã€‚</p>
<h3 data-id="heading-18">6.1 åœºæ™¯ä¸€ï¼šå®æ—¶æ—¥å¿—æ”¶é›†</h3>
<p><strong>éœ€æ±‚</strong>ï¼šæ”¶é›†æœåŠ¡æ—¥å¿—ï¼Œéœ€é«˜ååã€ä½å»¶è¿Ÿï¼Œæ”¯æŒç™¾ä¸‡çº§æ¶ˆæ¯/ç§’ã€‚</p>
<p><strong>å®ç°</strong>ï¼š</p>
<ul>
<li>é…ç½®é«˜ååå‚æ•°ï¼š<code>compression.type=snappy</code>ã€<code>batch.size=128KB</code>ã€<code>linger.ms=5</code>ã€‚</li>
<li>ä½¿ç”¨å¼‚æ­¥å‘é€ï¼Œå‡å°‘é˜»å¡ã€‚</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼ˆSpring Kafkaï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> KafkaTemplate&lt;String, String&gt; kafkaTemplate;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendLog</span><span class="hljs-params">(String log)</span> {
    kafkaTemplate.send(<span class="hljs-string">"logs"</span>, log)
        .addCallback(
            result -&gt; System.out.println(<span class="hljs-string">"Log sent: "</span> + result.getRecordMetadata().offset()),
            ex -&gt; ex.printStackTrace()
        );
}
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šååé‡è¾¾50ä¸‡æ¡/ç§’ï¼Œå»¶è¿Ÿæ§åˆ¶åœ¨20msä»¥å†…ã€‚</p>
<h3 data-id="heading-19">6.2 åœºæ™¯äºŒï¼šè®¢å•æµå¤„ç†</h3>
<p><strong>éœ€æ±‚</strong>ï¼šç¡®ä¿è®¢å•æ¶ˆæ¯æŒ‰ç”¨æˆ·é¡ºåºå¤„ç†ï¼Œé«˜å¯é æ€§ã€‚</p>
<p><strong>å®ç°</strong>ï¼š</p>
<ul>
<li>è®¾ç½®Keyä¸ºç”¨æˆ·IDï¼Œä¿è¯åˆ†åŒºé¡ºåºã€‚</li>
<li>å¯ç”¨å¹‚ç­‰ç”Ÿäº§è€…ï¼Œé˜²æ­¢é‡å¤æ‰£å‡åº“å­˜ã€‚</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java">props.put(ProducerConfig.ENABLE_IDEMPOTENCE_CONFIG, <span class="hljs-literal">true</span>);
ProducerRecord&lt;String, String&gt; record = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProducerRecord</span>&lt;&gt;(<span class="hljs-string">"orders"</span>, userId, orderJson);
producer.send(record);
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šè®¢å•æ¶ˆæ¯ä¸¥æ ¼é¡ºåºï¼Œåº“å­˜æ‰£å‡æ— é‡å¤ã€‚</p>
<h3 data-id="heading-20">6.3 åœºæ™¯ä¸‰ï¼šè·¨ç³»ç»Ÿæ•°æ®åŒæ­¥</h3>
<p><strong>éœ€æ±‚</strong>ï¼šMySQLæ•°æ®åº“å˜æ›´åŒæ­¥åˆ°Kafkaï¼Œä¿è¯ä¸€è‡´æ€§ã€‚</p>
<p><strong>å®ç°</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨äº‹åŠ¡ç”Ÿäº§è€…ï¼Œç¡®ä¿æ•°æ®åº“æ›´æ–°ä¸æ¶ˆæ¯å‘é€åŸå­æ€§ã€‚</li>
<li>ç»“åˆDebeziumæ•è·Binlogï¼Œå‘é€åˆ°Kafkaã€‚</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java">producer.initTransactions();
<span class="hljs-keyword">try</span> {
    producer.beginTransaction();
    producer.send(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ProducerRecord</span>&lt;&gt;(<span class="hljs-string">"db-changes"</span>, <span class="hljs-string">"key"</span>, binlogJson));
    <span class="hljs-comment">// æ•°æ®åº“æ›´æ–°</span>
    producer.commitTransaction();
} <span class="hljs-keyword">catch</span> (Exception e) {
    producer.abortTransaction();
}
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šæ•°æ®åº“ä¸Kafkaæ•°æ®é›¶ä¸ä¸€è‡´ã€‚</p>
<p><strong>è¿‡æ¸¡</strong>ï¼šé€šè¿‡è¿™äº›åœºæ™¯ï¼Œæˆ‘ä»¬çœ‹åˆ°ç”Ÿäº§è€…çš„çµæ´»æ€§ä¸å¼ºå¤§åŠŸèƒ½ã€‚æœ€åï¼Œè®©æˆ‘ä»¬æ€»ç»“ç»éªŒå¹¶å±•æœ›æœªæ¥ã€‚</p>
<hr/>
<h2 data-id="heading-21">7. æ€»ç»“ä¸å±•æœ›</h2>
<p>Kafkaç”Ÿäº§è€…æ˜¯æ¶ˆæ¯æµçš„èµ·ç‚¹ï¼Œå…¶çµæ´»çš„å‘é€æ¨¡å¼ã€å¯é çš„ä¿éšœæœºåˆ¶å’Œå¼ºå¤§çš„æ€§èƒ½ä¼˜åŒ–èƒ½åŠ›ï¼Œè®©å®ƒæˆä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¾—åŠ›åŠ©æ‰‹ã€‚é€šè¿‡æœ¬æ–‡ï¼Œæˆ‘ä»¬æ·±å…¥å‰–æäº†ç”Ÿäº§è€…çš„æ ¸å¿ƒæœºåˆ¶ï¼Œä»åŸºæœ¬æµç¨‹åˆ°å¯é æ€§ä¿éšœï¼Œå†åˆ°æ€§èƒ½è°ƒä¼˜ï¼Œæ¯ä¸€æ­¥éƒ½é…ä»¥ä»£ç å’Œæ¡ˆä¾‹ï¼Œç¡®ä¿ä½ èƒ½å°†ç†è®ºè½¬åŒ–ä¸ºå®è·µã€‚</p>
<p><strong>å…³é”®æ”¶è·</strong>ï¼š</p>
<ul>
<li><strong>æœºåˆ¶ç†è§£</strong>ï¼šæ¶ˆæ¯å‘é€ã€åˆ†åŒºåˆ†é…ã€ç¼“å†²åŒºç®¡ç†çš„æ¯ä¸€æ­¥éƒ½å½±å“æ€§èƒ½ä¸å¯é æ€§ã€‚</li>
<li><strong>ä¼˜åŒ–æŠ€å·§</strong>ï¼šé€šè¿‡å‚æ•°è°ƒä¼˜ï¼ˆå¦‚<code>batch.size</code>ã€<code>compression.type</code>ï¼‰å’Œæ‰¹é‡å‘é€ï¼Œå¯å¤§å¹…æå‡ååé‡ã€‚</li>
<li><strong>æœ€ä½³å®è·µ</strong>ï¼šè§„èŒƒåŒ–é…ç½®ã€ç›‘æ§å‘Šè­¦å’Œä¼˜é›…å…³é—­æ˜¯ç”Ÿäº§ç¯å¢ƒå¿…å¤‡ã€‚</li>
</ul>
<p><strong>æœªæ¥å±•æœ›</strong>ï¼šéšç€Kafkaçš„æ¼”è¿›ï¼ˆå¦‚KRaftæ¨¡å¼å–ä»£ZooKeeperï¼‰ï¼Œç”Ÿäº§è€…å¯èƒ½è¿æ¥æ›´é«˜æ•ˆçš„å…ƒæ•°æ®ç®¡ç†å’Œæ›´ä½çš„å»¶è¿Ÿã€‚æ–°ç‰ˆæœ¬çš„å‹ç¼©ç®—æ³•ï¼ˆå¦‚zstdï¼‰å’ŒåŠ¨æ€é…ç½®æ”¯æŒï¼Œä¹Ÿå€¼å¾—å…³æ³¨ã€‚</p>
<p><strong>é¼“åŠ±è¡ŒåŠ¨</strong>ï¼šåˆ«è®©è¿™äº›çŸ¥è¯†åœç•™åœ¨çº¸é¢ï¼å»ºè®®ä½ ç»“åˆé¡¹ç›®å®è·µï¼Œå°è¯•è°ƒæ•´ç”Ÿäº§è€…é…ç½®ï¼ŒéªŒè¯ååé‡å’Œå»¶è¿Ÿçš„å˜åŒ–ï¼Œå¹¶åœ¨å›¢é˜Ÿä¸­åˆ†äº«ç»éªŒã€‚Kafkaçš„ä¸–ç•Œå¾ˆå¤§ï¼Œæ¢ç´¢æ°¸æ— æ­¢å¢ƒï¼</p>
<hr/>
<h2 data-id="heading-22">8. é™„å½•</h2>
<p>Kafkaç”Ÿäº§è€…çš„å­¦ä¹ å’Œå®è·µä¹‹æ—…ï¼Œå°±åƒæ”€ç™»ä¸€åº§æŠ€æœ¯é«˜å³°ï¼Œæ—¢éœ€è¦æ‰å®çš„ç†è®ºï¼Œä¹Ÿç¦»ä¸å¼€è¶æ‰‹çš„å·¥å…·å’Œç»éªŒåˆ†äº«ã€‚æœ¬èŠ‚ä¸ºä½ æ•´ç†äº†ä¸€äº›å®ç”¨èµ„æºå’Œå¸¸è§é—®é¢˜è§£ç­”ï¼ŒåŠ©ä½ æ›´é¡ºç•…åœ°é©¾é©­Kafkaç”Ÿäº§è€…ã€‚</p>
<h3 data-id="heading-23">8.1 å‚è€ƒèµ„æ–™</h3>
<ul>
<li><strong>å®˜æ–¹æ–‡æ¡£</strong>ï¼šApache Kafkaå®˜ç½‘ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fkafka.apache.org%2Fdocumentation%2F%25EF%25BC%2589%25E6%2598%25AF%25E7%2594%259F%25E4%25BA%25A7%25E8%2580%2585%25E9%2585%258D%25E7%25BD%25AE%25E5%2592%258C%25E6%259C%25BA%25E5%2588%25B6%25E7%259A%2584%25E6%259D%2583%25E5%25A8%2581%25E6%258C%2587%25E5%258D%2597%25EF%25BC%258C%25E5%25B0%25A4%25E5%2585%25B6%25E6%2598%25AFProducer" target="_blank" title="https://kafka.apache.org/documentation/%EF%BC%89%E6%98%AF%E7%94%9F%E4%BA%A7%E8%80%85%E9%85%8D%E7%BD%AE%E5%92%8C%E6%9C%BA%E5%88%B6%E7%9A%84%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%EF%BC%8C%E5%B0%A4%E5%85%B6%E6%98%AFProducer" ref="nofollow noopener noreferrer">kafka.apache.org/documentatiâ€¦</a> APIéƒ¨åˆ†ã€‚</li>
<li><strong>æ¨èä¹¦ç±</strong>ï¼šã€ŠKafka: The Definitive Guideã€‹ï¼ˆConfluentå›¢é˜Ÿè‘—ï¼‰ï¼Œæ·±å…¥å‰–æKafkaå†…éƒ¨åŸç†ï¼Œé€‚åˆè¿›é˜¶å­¦ä¹ ã€‚</li>
<li><strong>ç¤¾åŒºèµ„æº</strong>ï¼šConfluentåšå®¢ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.confluent.io%2Fblog%2F%25EF%25BC%2589%25E5%2592%258CStack" target="_blank" title="https://www.confluent.io/blog/%EF%BC%89%E5%92%8CStack" ref="nofollow noopener noreferrer">www.confluent.io/blog/ï¼‰å’ŒStacâ€¦</a> Overflowçš„Kafkaæ ‡ç­¾ï¼Œæä¾›äº†å¤§é‡å®æˆ˜æ¡ˆä¾‹å’Œé—®é¢˜è§£ç­”ã€‚</li>
</ul>
<p><strong>ä¸ªäººå¿ƒå¾—</strong>ï¼šæˆ‘æ›¾é€šè¿‡åå¤æŸ¥é˜…å®˜æ–¹æ–‡æ¡£å’ŒConfluentåšå®¢ï¼Œè§£å†³äº†ä¸€ä¸ªå› <code>max.in.flight.requests</code>é…ç½®ä¸å½“å¯¼è‡´çš„ä¹±åºé—®é¢˜ï¼Œå¼ºçƒˆå»ºè®®å¤šçœ‹æºç å’Œç¤¾åŒºè®¨è®ºã€‚</p>
<h3 data-id="heading-24">8.2 å·¥å…·æ¨è</h3>
<ul>
<li><strong>Kafka Manager</strong>ï¼šYahooå¼€æºçš„é›†ç¾¤ç®¡ç†å·¥å…·ï¼Œé€‚åˆç›‘æ§Topicã€åˆ†åŒºå’Œç”Ÿäº§è€…çŠ¶æ€ã€‚</li>
<li><strong>Confluent Control Center</strong>ï¼šå•†ä¸šåŒ–å·¥å…·ï¼Œæä¾›ç”Ÿäº§è€…æ€§èƒ½æŒ‡æ ‡çš„å¯è§†åŒ–åˆ†æï¼Œé€‚åˆå¤§å‹é¡¹ç›®ã€‚</li>
<li><strong>Kafka Tool</strong>ï¼šè½»é‡çº§GUIå·¥å…·ï¼Œä¾¿äºæŸ¥çœ‹æ¶ˆæ¯å†…å®¹å’Œè°ƒè¯•ç”Ÿäº§è€…ã€‚</li>
</ul>
<p><strong>å®è·µç»éªŒ</strong>ï¼šåœ¨ä¸€ä¸ªæ—¥å¿—é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ç”¨Kafka Managerç›‘æ§<code>record-queue-time</code>ï¼Œå¿«é€Ÿå®šä½äº†ç¼“å†²åŒºç“¶é¢ˆï¼ŒèŠ‚çœäº†å¤§é‡æ’æŸ¥æ—¶é—´ã€‚</p>
<h3 data-id="heading-25">8.3 Q&amp;Aï¼šå¸¸è§é—®é¢˜è§£ç­”</h3>
<ul>
<li><strong>Qï¼šå¦‚ä½•é€‰æ‹©å‹ç¼©ç®—æ³•ï¼Ÿ</strong>
<ul>
<li><strong>A</strong>ï¼š<code>snappy</code>é€‚åˆå¤§å¤šæ•°åœºæ™¯ï¼Œå¹³è¡¡æ€§èƒ½ä¸å‹ç¼©æ¯”ï¼›<code>gzip</code>é€‚åˆå¸¦å®½å—é™ç¯å¢ƒï¼›<code>zstd</code>åœ¨é«˜åååœºæ™¯è¡¨ç°ä¼˜å¼‚ï¼Œä½†éœ€æµ‹è¯•å…¼å®¹æ€§ã€‚</li>
</ul>
</li>
<li><strong>Qï¼šç”Ÿäº§è€…å…³é—­æ—¶ä¼šä¸¢å¤±æ¶ˆæ¯å—ï¼Ÿ</strong>
<ul>
<li><strong>A</strong>ï¼šè°ƒç”¨<code>producer.close(timeout)</code>ï¼Œç¡®ä¿ç¼“å†²åŒºæ¶ˆæ¯å‘é€å®Œæˆã€‚æ¨èè®¾ç½®åˆç†è¶…æ—¶ï¼ˆå¦‚10ç§’ï¼‰ã€‚</li>
</ul>
</li>
<li><strong>Qï¼šå¦‚ä½•åˆ¤æ–­åˆ†åŒºæ•°æ˜¯å¦åˆç†ï¼Ÿ</strong>
<ul>
<li><strong>A</strong>ï¼šåˆ†åŒºæ•°å»ºè®®ä¸ºBrokeræ•°çš„2-3å€ï¼Œç»“åˆä¸šåŠ¡å¹¶å‘éœ€æ±‚æµ‹è¯•ï¼Œè§‚å¯Ÿæ¶ˆè´¹è€…å»¶è¿Ÿå’ŒBrokerè´Ÿè½½ã€‚</li>
</ul>
</li>
</ul>
<p><strong>ç›¸å…³æŠ€æœ¯ç”Ÿæ€</strong>ï¼šKafkaç”Ÿäº§è€…å¸¸ä¸Spring Kafkaã€Confluent Schema Registryï¼ˆåºåˆ—åŒ–ç®¡ç†ï¼‰ã€Debeziumï¼ˆCDCåŒæ­¥ï¼‰ç­‰ç”Ÿæ€å·¥å…·é…åˆä½¿ç”¨ã€‚æŒæ¡è¿™äº›å·¥å…·ï¼Œèƒ½è®©ä½ çš„æ¶ˆæ¯æµæ›´é«˜æ•ˆã€‚</p>
<p><strong>æœªæ¥è¶‹åŠ¿</strong>ï¼šKafkaçš„KRaftæ¨¡å¼æ­£åœ¨å–ä»£ZooKeeperï¼Œæœªæ¥ç”Ÿäº§è€…å¯èƒ½å—ç›Šäºæ›´å¿«çš„å…ƒæ•°æ®åŒæ­¥å’Œæ›´ä½çš„å»¶è¿Ÿã€‚æ­¤å¤–ï¼Œç¤¾åŒºå¯¹exactly-onceè¯­ä¹‰çš„ä¼˜åŒ–ï¼ˆå¦‚äº‹åŠ¡æ€§èƒ½æå‡ï¼‰å€¼å¾—æœŸå¾…ã€‚</p>
<hr/>
<h2 data-id="heading-26">æ–‡ç« æ”¶å°¾</h2>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†å¯¹Kafkaç”Ÿäº§è€…çš„å…¨é¢å‰–æï¼Œä»æ ¸å¿ƒæœºåˆ¶åˆ°æ€§èƒ½ä¼˜åŒ–ï¼Œå†åˆ°æœ€ä½³å®è·µå’ŒçœŸå®æ¡ˆä¾‹ï¼Œæ¯ä¸€æ­¥éƒ½åŠ›æ±‚è®©ä½ ä¸ä»…â€œçŸ¥å…¶ç„¶â€ï¼Œè¿˜èƒ½â€œçŸ¥å…¶æ‰€ä»¥ç„¶â€ã€‚å¸Œæœ›è¿™äº›å†…å®¹èƒ½æˆä¸ºä½ é¡¹ç›®ä¸­çš„â€œé”¦å›Šå¦™è®¡â€ï¼Œå¸®åŠ©ä½ åº”å¯¹æ¶ˆæ¯å‘é€çš„å„ç§æŒ‘æˆ˜ã€‚</p>
<p><strong>ä¸ªäººå¿ƒå¾—</strong>ï¼šä½œä¸ºä¸€åä»ä¸š10å¹´çš„å·¥ç¨‹å¸ˆï¼Œæˆ‘å‘ç°Kafkaç”Ÿäº§è€…çš„é­…åŠ›åœ¨äºå®ƒçš„å¹³è¡¡æ€§â€”â€”æ—¢èƒ½æ»¡è¶³é«˜ååéœ€æ±‚ï¼Œåˆèƒ½ä¿éšœä¸¥æ ¼çš„å¯é æ€§ã€‚æ¯æ¬¡ä¼˜åŒ–ç”Ÿäº§è€…é…ç½®ï¼Œéƒ½åƒåœ¨è°ƒè¯•ä¸€è¾†èµ›è½¦ï¼Œæ‰¾åˆ°æ€§èƒ½ä¸ç¨³å®šçš„æœ€ä½³å¥‘åˆç‚¹ï¼Œæˆå°±æ„Ÿæ»¡æ»¡ã€‚</p>
<p><strong>è¡ŒåŠ¨å·å¬</strong>ï¼šç°åœ¨ï¼Œè½®åˆ°ä½ äº†ï¼ä¸å¦¨æ‰“å¼€ä½ çš„Kafkaé¡¹ç›®ï¼Œè¯•è¯•è°ƒæ•´<code>linger.ms</code>æˆ–å¯ç”¨å¹‚ç­‰æ€§ï¼Œçœ‹çœ‹ååé‡å’Œå»¶è¿Ÿæœ‰ä½•å˜åŒ–ã€‚å¦‚æœæœ‰æ–°çš„å‘ç°ï¼Œæ¬¢è¿åœ¨ç¤¾åŒºåˆ†äº«ï¼Œæˆ‘ä»¬ä¸€èµ·æˆé•¿ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€ŠTanStack Start æ·±å…¥è§£æï¼šSingle Flight Mutations æœºåˆ¶ï¼ˆç¬¬äºŒç¯‡ï¼‰ã€‹]]></title>    <link>https://juejin.cn/post/7603352117638856713</link>    <guid>https://juejin.cn/post/7603352117638856713</guid>    <pubDate>2026-02-06T07:34:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603352117638856713" data-draft-id="7603352117638791177" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€ŠTanStack Start æ·±å…¥è§£æï¼šSingle Flight Mutations æœºåˆ¶ï¼ˆç¬¬äºŒç¯‡ï¼‰ã€‹"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•,JavaScript"/> <meta itemprop="datePublished" content="2026-02-06T07:34:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜é‡‘å®‰ä¸œå°¼"/> <meta itemprop="url" content="https://juejin.cn/user/1521379823340792"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€ŠTanStack Start æ·±å…¥è§£æï¼šSingle Flight Mutations æœºåˆ¶ï¼ˆç¬¬äºŒç¯‡ï¼‰ã€‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1521379823340792/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜é‡‘å®‰ä¸œå°¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-06T07:34:19.000Z" title="Fri Feb 06 2026 07:34:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-06
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åŸæ–‡ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ffrontendmasters.com%2Fblog%2Fsingle-flight-mutations-in-tanstack-start-part-2%2F" target="_blank" title="https://frontendmasters.com/blog/single-flight-mutations-in-tanstack-start-part-2/" ref="nofollow noopener noreferrer">Single Flight Mutations in TanStack Start: Part 2</a></p>
<p>ä½œè€…ï¼šAdam Rackis</p>
<p>æ—¥æœŸï¼š2026å¹´1æœˆ28æ—¥</p>
<p>ç¿»è¯‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTUARAN" target="_blank" title="https://github.com/TUARAN" ref="nofollow noopener noreferrer">TUARAN</a></p>
<p>æ¬¢è¿å…³æ³¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTUARAN%2Ffrontend-weekly-digest-cn" target="_blank" title="https://github.com/TUARAN/frontend-weekly-digest-cn" ref="nofollow noopener noreferrer">å‰ç«¯å‘¨åˆŠ</a>ï¼Œæ¯å‘¨æ›´æ–°å›½å¤–è®ºå›çš„å‰ç«¯çƒ­é—¨æ–‡ç« ï¼Œç´§è·Ÿæ—¶äº‹ï¼ŒæŒæ¡å‰ç«¯æŠ€æœ¯åŠ¨æ€ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">TL;DR</h2>
<p>è¿™ç¯‡æ–‡ç« å»¶ç»­ Part 1 çš„æ€è·¯ï¼šæŠŠä¸€æ¬¡ mutation æ‰€éœ€çš„ UI æ›´æ–°æ•°æ®ï¼Œåœ¨åŒä¸€æ¬¡ç½‘ç»œå¾€è¿”é‡Œä¸€èµ·å¸¦å›æ¥ï¼ˆé¿å… mutation åå†é¢å¤–å‘è¯·æ±‚ refetchï¼‰ã€‚</p>
<p>Part 2 çš„é‡ç‚¹æ˜¯æŠŠâ€œè¦ refetch å“ªäº›æŸ¥è¯¢â€æŠ½æˆå¯å¤ç”¨çš„ middlewareï¼šè°ƒç”¨ server function æ—¶ä¼ å…¥ react-query çš„ <code>QueryKey[]</code>ï¼Œmiddleware ä¼šåœ¨å®¢æˆ·ç«¯ä» Query Cache æ‰¾åˆ°æ¯ä¸ª query å¯¹åº”çš„ <code>serverFn</code> å’Œå‚æ•°ï¼ŒæŠŠè¿™äº›ä¿¡æ¯é€šè¿‡ <code>sendContext</code> é€åˆ°æœåŠ¡ç«¯ç»Ÿä¸€æ‰§è¡Œï¼Œç„¶åæŠŠç»“æœå›ä¼ ç»™å®¢æˆ·ç«¯å¹¶ç”¨ <code>setQueryData</code> å†™å›ç¼“å­˜ã€‚</p>
<hr/>
<p>åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Ffrontendmasters.com%2Fblog%2Fsingle-flight-mutations-in-tanstack-start-part-1%2F" target="_blank" title="https://frontendmasters.com/blog/single-flight-mutations-in-tanstack-start-part-1/" ref="nofollow noopener noreferrer">Part 1</a> é‡Œï¼Œæˆ‘ä»¬èŠè¿‡ single flight mutationsï¼šå®ƒè®©ä½ åœ¨æ›´æ–°æ•°æ®æ—¶ï¼ŒåŒæ—¶æŠŠ UI éœ€è¦çš„æ‰€æœ‰ç›¸å…³â€œå·²æ›´æ–°æ•°æ®â€é‡æ–°è·å–å›æ¥ï¼Œå¹¶ä¸”æ•´ä¸ªè¿‡ç¨‹åªéœ€è¦ä¸€æ¬¡è·¨ç½‘ç»œçš„å¾€è¿”ã€‚</p>
<p>æˆ‘ä»¬å½“æ—¶åšäº†ä¸ªå¾ˆæœ´ç´ çš„å®ç°ï¼šåœ¨â€œæ›´æ–°æ•°æ®â€çš„ server function é‡Œç›´æ¥æŠŠéœ€è¦çš„ä¸œè¥¿ refetch ä¸€éã€‚å®ƒç¡®å®èƒ½ç”¨ï¼Œä½†å¯æ‰©å±•æ€§å’Œçµæ´»æ€§éƒ½ä¸€èˆ¬ï¼ˆè€¦åˆä¹Ÿåé‡ï¼‰ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« æˆ‘ä»¬ä¼šå®ç°åŒæ ·çš„æ•ˆæœï¼Œä½†æ–¹å¼æ›´é€šç”¨ï¼šå®šä¹‰ä¸€ä¸ªâ€œrefetch middlewareâ€ï¼ŒæŠŠå®ƒæŒ‚åˆ°ä»»æ„ server function ä¸Šã€‚è¿™ä¸ª middleware å…è®¸æˆ‘ä»¬é€šè¿‡ react-query çš„ key æŒ‡å®šè¦ refetch çš„æ•°æ®ï¼Œå‰©ä¸‹çš„äº‹æƒ…å®ƒä¼šè‡ªåŠ¨å®Œæˆã€‚</p>
<p>æˆ‘ä»¬ä¼šå…ˆåšä¸€ä¸ªæœ€ç®€å•ç‰ˆæœ¬ï¼Œç„¶åä¸æ–­åŠ èƒ½åŠ›ã€åŠ çµæ´»æ€§ã€‚åˆ°æœ€åä¼šç¨å¾®å¤æ‚ä¸€äº›ï¼Œä½†è¯·åˆ«è¯¯ä¼šï¼šä½ ä¸éœ€è¦æŠŠæ–‡ä¸­è®²çš„å…¨éƒ¨éƒ½ç”¨ä¸Šã€‚äº‹å®ä¸Šï¼Œå¯¹ç»å¤§å¤šæ•°åº”ç”¨æ¥è¯´ï¼Œsingle flight mutations å¯èƒ½å®Œå…¨æ— å…³ç´§è¦ã€‚æ›´åˆ«è¢«â€œé«˜çº§åšæ³•â€è¿·æƒ‘äº†ï¼šå¯¹å¾ˆå¤šå°åº”ç”¨è€Œè¨€ï¼Œç›´æ¥åœ¨ server function é‡Œ refetch ä¸€ç‚¹æ•°æ®å¯èƒ½å°±è¶³å¤Ÿäº†ã€‚</p>
<p>ä¸è¿‡ï¼Œè·Ÿç€åšä¸€éï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸€äº›å¾ˆé…·çš„ TanStackï¼ˆç”šè‡³ TypeScriptï¼‰ç‰¹æ€§ã€‚å³ä¾¿ä½ æ°¸è¿œä¸ç”¨ single flight mutationsï¼Œè¿™äº›å†…å®¹ä¹Ÿå¾ˆå¯èƒ½åœ¨åˆ«çš„åœºæ™¯æ´¾ä¸Šç”¨åœºã€‚</p>
<h2 data-id="heading-1">æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ª Middleware</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Ftanstack.com%2Fquery%2Flatest" target="_blank" title="https://tanstack.com/query/latest" ref="nofollow noopener noreferrer">TanStack Query</a>ï¼ˆæˆ‘ä»¬æœ‰æ—¶ä¹Ÿä¼šç§°å®ƒä¸º react-queryï¼Œè¿™æ˜¯å®ƒçš„åŒ…åï¼‰å·²ç»æœ‰ä¸€å¥—éå¸¸å¥½ç”¨çš„å±‚çº§ key ç³»ç»Ÿã€‚å¦‚æœæˆ‘ä»¬çš„ middleware èƒ½ç›´æ¥æ¥æ”¶â€œè¦ refetch çš„ query keysâ€ï¼Œç„¶åå°±â€¦â€¦è‡ªåŠ¨æå®šï¼Œé‚£è¯¥å¤šå¥½ï¼Ÿ</p>
<p>é—®é¢˜åœ¨äºï¼šmiddleware è¦æ€ä¹ˆçŸ¥é“â€œæ€ä¹ˆ refetchâ€å‘¢ï¼Ÿç¬¬ä¸€çœ¼çœ‹ç¡®å®æœ‰ç‚¹éš¾ã€‚æˆ‘ä»¬çš„ queriesï¼ˆåˆ»æ„ä¿æŒç®€å•ï¼‰æœ¬è´¨ä¸Šéƒ½æ˜¯å¯¹ server functions çš„è°ƒç”¨ã€‚ä½†æˆ‘ä»¬æ²¡æ³•æŠŠä¸€ä¸ªæ™®é€šå‡½æ•°å¼•ç”¨ä¼ åˆ°æœåŠ¡ç«¯ï¼›å‡½æ•°ä¸å¯åºåˆ—åŒ–ï¼Œè¿™å¾ˆåˆç†ã€‚ä½ èƒ½æŠŠå­—ç¬¦ä¸²/æ•°å­—/å¸ƒå°”å€¼åºåˆ—åŒ–æˆ JSON åœ¨çº¿ä¸Šä¼ è¾“ï¼Œä½†ä¸€ä¸ªå‡½æ•°å¯èƒ½å¸¦çŠ¶æ€ã€é—­åŒ…ã€ä¸Šä¸‹æ–‡â€¦â€¦ä¼ è¿‡å»æ ¹æœ¬è¯´ä¸æ¸…ã€‚</p>
<p>é™¤éâ€”â€”å®ƒæ˜¯ TanStack Start çš„ server functionã€‚</p>
<p>è¿™ä¸ªé¡¹ç›®èƒŒåçš„å·¥ç¨‹å¸ˆä»¬ä¸ºåºåˆ—åŒ–å¼•æ“åšäº†å®šåˆ¶ï¼Œä½¿å…¶æ”¯æŒ server functionsã€‚ä¹Ÿå°±æ˜¯è¯´ï¼šä½ å¯ä»¥ä»å®¢æˆ·ç«¯æŠŠä¸€ä¸ª server function â€œå‘åˆ°â€æœåŠ¡ç«¯ï¼Œå®ƒèƒ½æ­£å¸¸å·¥ä½œã€‚åº•å±‚åŸç†æ˜¯ï¼šserver functions æœ‰ä¸€ä¸ªå†…éƒ¨ IDã€‚TanStack ä¼šæ•æ‰åˆ°å®ƒã€å‘é€ IDï¼Œç„¶ååœ¨å¦ä¸€ç«¯æŠŠ ID ååºåˆ—åŒ–æˆå¯¹åº”çš„ server functionã€‚</p>
<p>ä¸ºäº†è®©äº‹æƒ…æ›´ç®€å•ï¼Œæˆ‘ä»¬ä¸å¦¨æŠŠ server functionï¼ˆä»¥åŠå®ƒéœ€è¦çš„å‚æ•°ï¼‰ç›´æ¥æ”¾åˆ°æˆ‘ä»¬å·²ç»å®šä¹‰å¥½çš„ query options ä¸Šã€‚è¿™æ · middleware åªè¦æ‹¿åˆ° query keysï¼Œå°±èƒ½ä» TanStack Query çš„ cache é‡Œæ‰¾åˆ°å¯¹åº”çš„ query optionsï¼Œæ‹¿åˆ°â€œå¦‚ä½• refetchâ€çš„ä¿¡æ¯ï¼Œç„¶åæŠŠæ•´ä¸ªæµç¨‹ä¸²èµ·æ¥ã€‚</p>
<h2 data-id="heading-2">å¼€å§‹å§</h2>
<p>é¦–å…ˆå¼•å…¥ä¸€äº›å¥½ç”¨çš„ä¸œè¥¿ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { createMiddleware, getRouterInstance } <span class="hljs-keyword">from</span> <span class="hljs-string">"@tanstack/react-start"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">QueryClient</span>, <span class="hljs-title class_">QueryKey</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@tanstack/react-query"</span>;
</code></pre>
<p>æ¥ç€æ›´æ–°æˆ‘ä»¬çš„ epics åˆ—è¡¨æŸ¥è¯¢ï¼ˆä¸»è¦çš„ epics åˆ—è¡¨ï¼‰çš„ query optionsï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">epicsQueryOptions</span> = (<span class="hljs-params">page: <span class="hljs-built_in">number</span></span>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">queryOptions</span>({
    <span class="hljs-attr">queryKey</span>: [<span class="hljs-string">"epics"</span>, <span class="hljs-string">"list"</span>, page],
    <span class="hljs-attr">queryFn</span>: <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getEpicsList</span>({ <span class="hljs-attr">data</span>: page });
      <span class="hljs-keyword">return</span> result;
    },
    <span class="hljs-attr">staleTime</span>: <span class="hljs-number">1000</span> * <span class="hljs-number">60</span> * <span class="hljs-number">5</span>,
    <span class="hljs-attr">gcTime</span>: <span class="hljs-number">1000</span> * <span class="hljs-number">60</span> * <span class="hljs-number">5</span>,
    <span class="hljs-attr">meta</span>: {
      <span class="hljs-attr">__revalidate</span>: {
        <span class="hljs-attr">serverFn</span>: getEpicsList,
        <span class="hljs-attr">arg</span>: page,
      },
    },
  });
};
</code></pre>
<p>æ³¨æ„è¿™ä¸ªæ–°å¢çš„ <code>meta</code> åŒºå—ã€‚å®ƒå…è®¸æˆ‘ä»¬å¾€ query ä¸Šå¡ä»»ä½•æˆ‘ä»¬éœ€è¦çš„å…ƒæ•°æ®ã€‚è¿™é‡Œæˆ‘ä»¬æ”¾äº† <code>getEpicsList</code> è¿™ä¸ª server function çš„å¼•ç”¨ä»¥åŠå®ƒéœ€è¦çš„å‚æ•°ã€‚è¿™æ ·å†™ç¡®å®ä¼šæœ‰â€œé‡å¤â€ï¼ˆ<code>queryFn</code> å†™äº†ä¸€æ¬¡è°ƒç”¨æ–¹å¼ï¼Œ<code>meta</code> åˆå†™äº†ä¸€æ¬¡ï¼‰ï¼Œå¦‚æœä½ è§‰å¾—åˆ«æ‰­ï¼Œå…ˆåˆ«æ€¥ï¼Œåé¢ä¼šå¤„ç†ã€‚summary æŸ¥è¯¢ï¼ˆç”¨äºç»Ÿè®¡æ•°é‡ï¼‰æˆ‘ä»¬ä¹Ÿä¼šåŒæ ·æ›´æ–°ï¼Œä¸è¿‡è¿™é‡Œæ²¡è´´ä»£ç ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠ middleware ä¸€ç‚¹ç‚¹æ‹¼å‡ºæ¥ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// the server function and args are all `any`, for now, </span>
<span class="hljs-comment">// to keep things simple we'll see how to type them in a bit</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">RevalidationPayload</span> = {
  <span class="hljs-attr">refetch</span>: {
    <span class="hljs-attr">key</span>: <span class="hljs-title class_">QueryKey</span>;
    <span class="hljs-attr">fn</span>: <span class="hljs-built_in">any</span>;
    <span class="hljs-attr">arg</span>: <span class="hljs-built_in">any</span>;
  }[];
};

<span class="hljs-keyword">type</span> <span class="hljs-title class_">RefetchMiddlewareConfig</span> = {
  <span class="hljs-attr">refetch</span>: <span class="hljs-title class_">QueryKey</span>[];
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> refetchMiddleware = <span class="hljs-title function_">createMiddleware</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">"function"</span> })
  .<span class="hljs-title function_">inputValidator</span>(<span class="hljs-function">(<span class="hljs-params">config?: RefetchMiddlewareConfig</span>) =&gt;</span> config)
  .<span class="hljs-title function_">client</span>(<span class="hljs-keyword">async</span> ({ next, data }) =&gt; {
    <span class="hljs-keyword">const</span> { refetch = [] } = data ?? {};
</code></pre>
<p>æˆ‘ä»¬ä¸º middleware å®šä¹‰äº†ä¸€ä¸ªè¾“å…¥ã€‚è¿™ä¸ªè¾“å…¥ä¼šè‡ªåŠ¨ä¸â€œæŒ‚è½½è¯¥ middleware çš„ server function çš„è¾“å…¥â€åˆå¹¶ã€‚</p>
<p>æˆ‘ä»¬æŠŠè¾“å…¥å†™æˆå¯é€‰çš„ï¼ˆ<code>config?</code>ï¼‰ï¼Œå› ä¸ºå®Œå…¨å¯èƒ½å‡ºç°è¿™ç§æƒ…å†µï¼šä½ åªæƒ³è°ƒç”¨ server functionï¼Œä½†å¹¶ä¸æƒ³ refetch ä»»ä½•ä¸œè¥¿ã€‚</p>
<p>ç„¶åå¼€å§‹å†™ <code>.client</code> å›è°ƒï¼ˆåœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼‰ï¼šå…ˆæ‹¿åˆ°è¦ refetch çš„ keysï¼š</p>
<p><code>const { refetch = [] } = data ?? {};</code></p>
<p>æ¥ç€æˆ‘ä»¬æ‹¿åˆ° <code>queryClient</code> å’Œå®ƒçš„ cacheï¼Œå¹¶åˆ›å»ºä¸€ä¸ª payloadï¼Œä¹‹åä¼šé€šè¿‡ <code>sendContext</code> å‘åˆ° <code>.server</code> å›è°ƒï¼Œè®©å®ƒæ‰§è¡ŒçœŸæ­£çš„ refetchã€‚</p>
<p>å¦‚æœä½ å¯¹ TanStack middleware ä¸ç†Ÿï¼Œæˆ‘ä¹‹å‰å†™çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Ffrontendmasters.com%2Fblog%2Fintroducing-tanstack-start-middleware%2F" target="_blank" title="https://frontendmasters.com/blog/introducing-tanstack-start-middleware/" ref="nofollow noopener noreferrer">middleware æ–‡ç« </a> å¯èƒ½ä¼šæ›´é€‚åˆä½œä¸ºå…¥é—¨ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> router = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getRouterInstance</span>();
<span class="hljs-keyword">const</span> <span class="hljs-attr">queryClient</span>: <span class="hljs-title class_">QueryClient</span> = router.<span class="hljs-property">options</span>.<span class="hljs-property">context</span>.<span class="hljs-property">queryClient</span>;
<span class="hljs-keyword">const</span> cache = queryClient.<span class="hljs-title function_">getQueryCache</span>();

<span class="hljs-keyword">const</span> <span class="hljs-attr">revalidate</span>: <span class="hljs-title class_">RevalidationPayload</span> = {
  <span class="hljs-attr">refetch</span>: [],
};
</code></pre>
<p>æˆ‘ä»¬çš„ <code>queryClient</code> å·²ç»æŒ‚åœ¨ TanStack router çš„ context ä¸Šï¼Œæ‰€ä»¥åªè¦æ‹¿åˆ° router å†å–å‡ºæ¥å³å¯ã€‚</p>
<p>è¿˜è®°å¾—æˆ‘ä»¬æŠŠ <code>__revalidate</code> å¡åˆ° query options çš„ <code>meta</code> é‡Œå—ï¼Ÿç°åœ¨æˆ‘ä»¬é’ˆå¯¹æ¯ä¸ª key å» cache é‡Œæ‰¾å¯¹åº” queryï¼Œå¹¶æŠŠ <code>serverFn/arg</code> æŠ½å‡ºæ¥ç»„è£…æˆè¦å‘ç»™æœåŠ¡ç«¯çš„ payloadã€‚</p>
<pre><code class="hljs language-ts" lang="ts">refetch.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">key: QueryKey</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> entry = cache.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">queryKey</span>: key, <span class="hljs-attr">exact</span>: <span class="hljs-literal">true</span> });
  <span class="hljs-keyword">if</span> (!entry) <span class="hljs-keyword">return</span>;

  <span class="hljs-keyword">const</span> <span class="hljs-attr">revalidatePayload</span>: <span class="hljs-built_in">any</span> = entry?.<span class="hljs-property">meta</span>?.<span class="hljs-property">__revalidate</span> ?? <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">if</span> (revalidatePayload) {
    revalidate.<span class="hljs-property">refetch</span>.<span class="hljs-title function_">push</span>({
      key,
      <span class="hljs-attr">fn</span>: revalidatePayload.<span class="hljs-property">serverFn</span>,
      <span class="hljs-attr">arg</span>: revalidatePayload.<span class="hljs-property">arg</span>,
    });
  }
});
</code></pre>
<p><code>if (!entry) return;</code> æ˜¯ä¸ºäº†é˜²æ­¢è¯·æ±‚é‡ŒåŒ…å«äº†â€œå½“å‰ç¼“å­˜é‡Œæ ¹æœ¬ä¸å­˜åœ¨â€çš„ queryï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå¯èƒ½ä»æœªåœ¨ UI é‡Œè¢«è¯·æ±‚è¿‡ï¼‰ã€‚è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬æ‹¿ä¸åˆ° <code>serverFn</code>ï¼Œä¹Ÿå°±æ— æ³• refetchã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥æŠŠ middleware è¾“å…¥æ‰©å±•å¾—æ›´ä¸°å¯Œï¼šæ¯”å¦‚å¯¹é‚£äº›â€œæ— è®ºæ˜¯å¦åœ¨ç¼“å­˜é‡Œéƒ½å¿…é¡»æ‰§è¡Œâ€çš„ refetchï¼Œç›´æ¥æŠŠ <code>serverFn + arg</code> ä¸€èµ·ä¼ ä¸Šå»ã€‚æ¯”å¦‚ä½ æ‰“ç®— mutation å redirectï¼Œå¹¶å¸Œæœ›æ–°é¡µé¢çš„æ•°æ®èƒ½é¢„å–ã€‚æœ¬æ–‡ä¸å®ç°è¿™ä¸ªå˜ä½“ï¼Œä½†å®ƒåªæ˜¯åŒä¸€ä¸»é¢˜çš„å¦ä¸€ç§ç»„åˆã€‚</p>
<p>æ¥ç€æˆ‘ä»¬è°ƒç”¨ <code>next</code>ï¼Œè§¦å‘çœŸæ­£çš„ server functionï¼ˆä»¥åŠå…¶å®ƒ middlewareï¼‰ã€‚é€šè¿‡ <code>sendContext</code> æˆ‘ä»¬æŠŠ <code>revalidate</code> å‘åˆ°æœåŠ¡ç«¯ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>({
  <span class="hljs-attr">sendContext</span>: {
    revalidate,
  },
});
</code></pre>
<p><code>result</code> æ˜¯ server function è°ƒç”¨çš„è¿”å›å€¼ã€‚å®ƒçš„ <code>context</code> ä¸Šä¼šæœ‰ä¸€ä¸ª <code>payloads</code> æ•°ç»„ï¼ˆç”±ä¸‹æ–¹ <code>.server</code> å›è°ƒè¿”å›ï¼‰ï¼Œå…¶ä¸­æ¯ä¸€é¡¹éƒ½åŒ…å« <code>key</code>ï¼ˆquery keyï¼‰å’Œ <code>result</code>ï¼ˆå¯¹åº”æ•°æ®ï¼‰ã€‚æˆ‘ä»¬éå†å¹¶å†™å› query cacheã€‚</p>
<p>æˆ‘ä»¬ç¨åä¼šä¿®å¤è¿™é‡Œç”¨ <code>// @ts-expect-error</code> é®æ‰çš„ TS é”™è¯¯ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// @ts-expect-error</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> result.<span class="hljs-property">context</span>?.<span class="hljs-property">payloads</span> ?? []) {
  queryClient.<span class="hljs-title function_">setQueryData</span>(entry.<span class="hljs-property">key</span>, entry.<span class="hljs-property">result</span>);
}

<span class="hljs-keyword">return</span> result;
</code></pre>
<h2 data-id="heading-3">æœåŠ¡ç«¯å›è°ƒ</h2>
<p>æœåŠ¡ç«¯å›è°ƒå®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">.<span class="hljs-title function_">server</span>(<span class="hljs-keyword">async</span> ({ next, context }) =&gt; {
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>({
    <span class="hljs-attr">sendContext</span>: {
      <span class="hljs-attr">payloads</span>: [] <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>[]
    }
  });

  <span class="hljs-keyword">const</span> allPayloads = context.<span class="hljs-property">revalidate</span>.<span class="hljs-property">refetch</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">refetchPayload</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">key</span>: refetchPayload.<span class="hljs-property">key</span>,
      <span class="hljs-attr">result</span>: refetchPayload.<span class="hljs-title function_">fn</span>({ <span class="hljs-attr">data</span>: refetchPayload.<span class="hljs-property">arg</span> })
    };
  });

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> refetchPayload <span class="hljs-keyword">of</span> allPayloads) {
    result.<span class="hljs-property">sendContext</span>.<span class="hljs-property">payloads</span>.<span class="hljs-title function_">push</span>({
      <span class="hljs-attr">key</span>: refetchPayload.<span class="hljs-property">key</span>,
      <span class="hljs-attr">result</span>: <span class="hljs-keyword">await</span> refetchPayload.<span class="hljs-property">result</span>
    });
  }

  <span class="hljs-keyword">return</span> result;
});
</code></pre>
<p>æˆ‘ä»¬ä¼šç«‹åˆ»è°ƒç”¨ <code>next()</code>ï¼Œå®ƒä¼šæ‰§è¡Œè¿™ä¸ª middleware æ‰€æŒ‚è½½çš„ server functionã€‚æˆ‘ä»¬åœ¨ <code>sendContext</code> é‡Œä¼ å…¥ä¸€ä¸ª <code>payloads</code> æ•°ç»„ï¼šè¿™ä¸ªæ•°ç»„å†³å®šäº†â€œæœåŠ¡ç«¯æœ€ç»ˆä¼šå‘å›ç»™å®¢æˆ·ç«¯å›è°ƒçš„æ•°æ®ç»“æ„â€ï¼ˆä¹Ÿå°±æ˜¯ <code>.client</code> é‡Œå¾ªç¯çš„é‚£ä»½ <code>payloads</code>ï¼‰ã€‚</p>
<p>ç„¶åæˆ‘ä»¬éå†å®¢æˆ·ç«¯é€šè¿‡ <code>sendContext</code> ä¼ ä¸Šæ¥çš„ <code>revalidate</code> payloadï¼Œå¹¶ä» <code>context</code> ä¸Šè¯»å‡ºæ¥ï¼ˆæ˜¯çš„ï¼š<em>send</em> contextï¼Œå‘ä¸Šæ¥å†ä» context è¯»å‡ºæ¥ï¼‰ã€‚æ¥ç€è°ƒç”¨æ‰€æœ‰ server functionsï¼Œå¹¶æŠŠç»“æœ push åˆ° <code>payloads</code> æ•°ç»„é‡Œã€‚</p>
<p>æŠŠå‰åæ‹¼èµ·æ¥ï¼Œè¿™å°±æ˜¯å®Œæ•´ middlewareï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> refetchMiddleware = <span class="hljs-title function_">createMiddleware</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">"function"</span> })
  .<span class="hljs-title function_">inputValidator</span>(<span class="hljs-function">(<span class="hljs-params">config?: RefetchMiddlewareConfig</span>) =&gt;</span> config)
  .<span class="hljs-title function_">client</span>(<span class="hljs-keyword">async</span> ({ next, data }) =&gt; {
    <span class="hljs-keyword">const</span> { refetch = [] } = data ?? {};

    <span class="hljs-keyword">const</span> router = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getRouterInstance</span>();
    <span class="hljs-keyword">const</span> <span class="hljs-attr">queryClient</span>: <span class="hljs-title class_">QueryClient</span> = router.<span class="hljs-property">options</span>.<span class="hljs-property">context</span>.<span class="hljs-property">queryClient</span>;
    <span class="hljs-keyword">const</span> cache = queryClient.<span class="hljs-title function_">getQueryCache</span>();

    <span class="hljs-keyword">const</span> <span class="hljs-attr">revalidate</span>: <span class="hljs-title class_">RevalidationPayload</span> = {
      <span class="hljs-attr">refetch</span>: [],
    };

    refetch.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">key: QueryKey</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> entry = cache.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">queryKey</span>: key, <span class="hljs-attr">exact</span>: <span class="hljs-literal">true</span> });
      <span class="hljs-keyword">if</span> (!entry) <span class="hljs-keyword">return</span>;

      <span class="hljs-keyword">const</span> <span class="hljs-attr">revalidatePayload</span>: <span class="hljs-built_in">any</span> = entry?.<span class="hljs-property">meta</span>?.<span class="hljs-property">__revalidate</span> ?? <span class="hljs-literal">null</span>;

      <span class="hljs-keyword">if</span> (revalidatePayload) {
        revalidate.<span class="hljs-property">refetch</span>.<span class="hljs-title function_">push</span>({
          key,
          <span class="hljs-attr">fn</span>: revalidatePayload.<span class="hljs-property">serverFn</span>,
          <span class="hljs-attr">arg</span>: revalidatePayload.<span class="hljs-property">arg</span>,
        });
      }
    });

    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>({
      <span class="hljs-attr">sendContext</span>: {
        revalidate,
      },
    });

    <span class="hljs-comment">// @ts-expect-error</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> result.<span class="hljs-property">context</span>?.<span class="hljs-property">payloads</span> ?? []) {
      queryClient.<span class="hljs-title function_">setQueryData</span>(entry.<span class="hljs-property">key</span>, entry.<span class="hljs-property">result</span>);
    }

    <span class="hljs-keyword">return</span> result;
  })
  .<span class="hljs-title function_">server</span>(<span class="hljs-keyword">async</span> ({ next, context }) =&gt; {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>({
      <span class="hljs-attr">sendContext</span>: {
        <span class="hljs-attr">payloads</span>: [] <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>[],
      },
    });

    <span class="hljs-keyword">const</span> allPayloads = context.<span class="hljs-property">revalidate</span>.<span class="hljs-property">refetch</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">refetchPayload</span> =&gt;</span> {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">key</span>: refetchPayload.<span class="hljs-property">key</span>,
        <span class="hljs-attr">result</span>: refetchPayload.<span class="hljs-title function_">fn</span>({ <span class="hljs-attr">data</span>: refetchPayload.<span class="hljs-property">arg</span> }),
      };
    });

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> refetchPayload <span class="hljs-keyword">of</span> allPayloads) {
      result.<span class="hljs-property">sendContext</span>.<span class="hljs-property">payloads</span>.<span class="hljs-title function_">push</span>({
        <span class="hljs-attr">key</span>: refetchPayload.<span class="hljs-property">key</span>,
        <span class="hljs-attr">result</span>: <span class="hljs-keyword">await</span> refetchPayload.<span class="hljs-property">result</span>,
      });
    }

    <span class="hljs-keyword">return</span> result;
  });
</code></pre>
<h2 data-id="heading-4">ä¿®å¤ TypeScript æŠ¥é”™</h2>
<p>ä¸ºä»€ä¹ˆä¸‹é¢è¿™ä¸€è¡Œæ˜¯æ— æ•ˆçš„ï¼Ÿ</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// @ts-expect-error</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> result.<span class="hljs-property">context</span>?.<span class="hljs-property">payloads</span> ?? []) {
</code></pre>
<p>è¿™æ®µä»£ç è¿è¡Œåœ¨ <code>.client</code> å›è°ƒé‡Œï¼Œå¹¶ä¸”æ˜¯åœ¨æˆ‘ä»¬è°ƒç”¨ <code>next()</code> ä¹‹åè¿è¡Œçš„ã€‚æœ¬è´¨ä¸Šï¼Œæˆ‘ä»¬æ˜¯åœ¨æœåŠ¡ç«¯è¯»å–â€œå‘é€å›å®¢æˆ·ç«¯çš„æ•°æ®â€ï¼ˆé€šè¿‡ <code>sendContext</code> ä¼ å›æ¥çš„ payloadï¼‰ã€‚è¿™æ®µä»£ç åœ¨è¿è¡Œæ—¶ç¡®å®èƒ½å·¥ä½œï¼Œé‚£ä¸ºä»€ä¹ˆç±»å‹å¯¹ä¸ä¸Šï¼Ÿ</p>
<p>æˆ‘åœ¨ä¸Šé¢æåˆ°çš„ middleware æ–‡ç« é‡Œè§£é‡Šè¿‡ï¼šæœåŠ¡ç«¯å›è°ƒèƒ½â€œçœ‹è§â€å®¢æˆ·ç«¯å‘ç»™å®ƒçš„å†…å®¹ï¼Œä½†åè¿‡æ¥ä¸æˆç«‹ã€‚è¿™ç§ä¿¡æ¯å¤©ç”Ÿå°±ä¸æ˜¯åŒå‘å¯è§çš„ï¼›ç±»å‹æ¨æ–­ä¹Ÿæ²¡æ³•å€’ç€è·‘ã€‚</p>
<p>è§£å†³æ–¹å¼å¾ˆç®€å•ï¼šæŠŠ middleware æ‹†æˆä¸¤æ®µï¼Œè®©åä¸€æ®µ middleware ä¾èµ–å‰ä¸€æ®µã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> prelimRefetchMiddleware = <span class="hljs-title function_">createMiddleware</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">"function"</span> })
  .<span class="hljs-title function_">inputValidator</span>(<span class="hljs-function">(<span class="hljs-params">config?: RefetchMiddlewareConfig</span>) =&gt;</span> config)
  .<span class="hljs-title function_">client</span>(<span class="hljs-keyword">async</span> ({ next, data }) =&gt; {
    <span class="hljs-keyword">const</span> { refetch = [] } = data ?? {};

    <span class="hljs-keyword">const</span> router = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getRouterInstance</span>();
    <span class="hljs-keyword">const</span> <span class="hljs-attr">queryClient</span>: <span class="hljs-title class_">QueryClient</span> = router.<span class="hljs-property">options</span>.<span class="hljs-property">context</span>.<span class="hljs-property">queryClient</span>;

    <span class="hljs-comment">// same</span>
    <span class="hljs-comment">// as</span>
    <span class="hljs-comment">// before</span>

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>({
      <span class="hljs-attr">sendContext</span>: {
        revalidate,
      },
    });

    <span class="hljs-comment">// those last few lines are removed</span>
  })
  .<span class="hljs-title function_">server</span>(<span class="hljs-keyword">async</span> ({ next, context }) =&gt; {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>({
      <span class="hljs-attr">sendContext</span>: {
        <span class="hljs-attr">payloads</span>: [] <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>[],
      },
    });

    <span class="hljs-comment">// exactly the same as before</span>

    <span class="hljs-keyword">return</span> result;
  });

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> refetchMiddleware = <span class="hljs-title function_">createMiddleware</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">"function"</span> })
  .<span class="hljs-title function_">middleware</span>([prelimRefetchMiddleware]) <span class="hljs-comment">// &lt;-------- connect them!</span>
  .<span class="hljs-title function_">client</span>(<span class="hljs-keyword">async</span> ({ next }) =&gt; {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();

    <span class="hljs-keyword">const</span> router = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getRouterInstance</span>();
    <span class="hljs-keyword">const</span> <span class="hljs-attr">queryClient</span>: <span class="hljs-title class_">QueryClient</span> = router.<span class="hljs-property">options</span>.<span class="hljs-property">context</span>.<span class="hljs-property">queryClient</span>;

    <span class="hljs-comment">// and here's those last few lines we removed from above</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> result.<span class="hljs-property">context</span>?.<span class="hljs-property">payloads</span> ?? []) {
      queryClient.<span class="hljs-title function_">setQueryData</span>(entry.<span class="hljs-property">key</span>, entry.<span class="hljs-property">result</span>);
    }

    <span class="hljs-keyword">return</span> result;
  });
</code></pre>
<p>æ•´ä½“é€»è¾‘ä¸å˜ï¼Œåªæ˜¯æŠŠ <code>.client</code> å›è°ƒé‡Œ <code>next()</code> ä¹‹åé‚£éƒ¨åˆ†ç§»åˆ°äº†å•ç‹¬çš„ middleware é‡Œã€‚å…¶ä½™éƒ¨åˆ†ç•™åœ¨å¦ä¸€ä¸ª middleware ä¸­ï¼Œå¹¶ä½œä¸ºè¾“å…¥ä¼ ç»™æ–°çš„è¿™ä¸ª middlewareã€‚è¿™æ ·å½“æˆ‘ä»¬åœ¨ <code>refetchMiddleware</code> é‡Œè°ƒç”¨ <code>next</code> æ—¶ï¼ŒTypeScript å°±èƒ½çœ‹åˆ°â€œä»æœåŠ¡ç«¯å‘ä¸‹æ¥çš„ context æ•°æ®â€ï¼Œå› ä¸ºè¿™äº›æ•°æ®æ˜¯åœ¨ <code>prelimRefetchMiddleware</code> é‡Œå‘é€çš„ï¼Œè€Œå®ƒåˆæ˜¯æœ¬ middleware çš„è¾“å…¥ï¼Œå› æ­¤ TS å¯ä»¥å®Œæ•´çœ‹æ¸…ç±»å‹æµåŠ¨ã€‚</p>
<h2 data-id="heading-5">æ¥èµ·æ¥</h2>
<p>ç°åœ¨æˆ‘ä»¬å›åˆ°â€œæ›´æ–° epicâ€çš„ server functionï¼šæŠŠä¹‹å‰çš„æ‰‹åŠ¨ refetch ç§»é™¤ï¼Œæ”¹ä¸ºä½¿ç”¨ refetch middlewareã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> updateEpic = <span class="hljs-title function_">createServerFn</span>({ <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span> })
  .<span class="hljs-title function_">middleware</span>([refetchMiddleware])
  .<span class="hljs-title function_">inputValidator</span>(<span class="hljs-function">(<span class="hljs-params">obj: { id: <span class="hljs-built_in">number</span>; name: <span class="hljs-built_in">string</span> }</span>) =&gt;</span> obj)
  .<span class="hljs-title function_">handler</span>(<span class="hljs-keyword">async</span> ({ data }) =&gt; {
    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">1000</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>()));
    <span class="hljs-keyword">await</span> db.<span class="hljs-title function_">update</span>(epicsTable).<span class="hljs-title function_">set</span>({ <span class="hljs-attr">name</span>: data.<span class="hljs-property">name</span> }).<span class="hljs-title function_">where</span>(<span class="hljs-title function_">eq</span>(epicsTable.<span class="hljs-property">id</span>, data.<span class="hljs-property">id</span>));
  });
</code></pre>
<p>åœ¨ React ç»„ä»¶ä¸­é€šè¿‡ <code>useServerFn</code> æ¥è°ƒç”¨å®ƒï¼›è¿™ä¸ª hook ä¼šè‡ªåŠ¨å¤„ç†é”™è¯¯ã€é‡å®šå‘ç­‰ã€‚</p>
<p><code>const runSave = useServerFn(updateEpic);</code></p>
<p>è¿˜è®°å¾—æˆ‘è¯´è¿‡ï¼šmiddleware çš„è¾“å…¥ä¼šè‡ªåŠ¨ä¸åº•å±‚ server function çš„è¾“å…¥åˆå¹¶å—ï¼Ÿå½“æˆ‘ä»¬è°ƒç”¨è¿™ä¸ª server function æ—¶å°±èƒ½çœ‹åˆ°ï¼š</p>
<p><img alt="å›¾ 1ï¼šä¸€ä¸ª handleSaveFinal å‡½æ•°çš„ä»£ç ç‰‡æ®µï¼Œä¿å­˜è¾“å…¥å€¼å¹¶è°ƒç”¨ runSaveï¼Œå‚æ•°å¯¹è±¡åŒ…å« id å’Œ nameã€‚è½¬å­˜å¤±è´¥ï¼Œå»ºè®®ç›´æ¥ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶" src="" loading="lazy"/></p>
<p>ï¼ˆ<code>unknown[]</code> å¯¹ react-query çš„ query key æ¥è¯´å°±æ˜¯æ­£ç¡®ç±»å‹ï¼‰</p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥è¿™æ ·è°ƒç”¨å®ƒï¼Œå¹¶æŒ‡å®šè¦ refetch çš„æŸ¥è¯¢ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">await</span> <span class="hljs-title function_">runSave</span>({
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">id</span>: epic.<span class="hljs-property">id</span>,
    <span class="hljs-attr">name</span>: newValue,
    <span class="hljs-attr">refetch</span>: [
      [<span class="hljs-string">"epics"</span>, <span class="hljs-string">"list"</span>, <span class="hljs-number">1</span>],
      [<span class="hljs-string">"epics"</span>, <span class="hljs-string">"list"</span>, <span class="hljs-string">"summary"</span>],
    ],
  },
});
</code></pre>
<p>è¿è¡Œåï¼Œä¸€åˆ‡æ­£å¸¸ï¼šepics åˆ—è¡¨å’Œ summary éƒ½ä¼šåœ¨æ²¡æœ‰ä»»ä½•æ–°ç½‘ç»œè¯·æ±‚çš„æƒ…å†µä¸‹æ›´æ–°ã€‚æµ‹è¯• single flight mutations æ—¶ï¼Œä½ å…¶å®ä¸æ˜¯åœ¨æ‰¾â€œå‘ç”Ÿäº†ä»€ä¹ˆâ€ï¼Œè€Œæ˜¯åœ¨æ‰¾â€œä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿâ€â€”â€”ä¹Ÿå°±æ˜¯ Network é¢æ¿é‡Œç¼ºå°‘é‚£äº›æœ¬è¯¥å‡ºç°çš„é¢å¤–è¯·æ±‚ã€‚</p>
<h2 data-id="heading-6">å†æ”¹è¿›</h2>
<p>react-query çš„ query keys æ˜¯å±‚çº§ç»“æ„çš„ï¼Œä½ å¯èƒ½å¾ˆç†Ÿæ‚‰è¿™ç§å†™æ³•ï¼š</p>
<p><code>queryClient.invalidateQueries({ queryKey: ["epics", "list"] });</code></p>
<p>å®ƒä¼š refetch ä»»ä½• key ä»¥ <code>["epics", "list"]</code> å¼€å¤´çš„ queriesã€‚æˆ‘ä»¬çš„ middleware èƒ½ä¸èƒ½ä¹Ÿæ”¯æŒè¿™ç§â€œkey å‰ç¼€â€å‘¢ï¼Ÿä¹Ÿå°±æ˜¯åªä¼ ä¸€ä¸ª key prefixï¼Œè®©å®ƒæ‰¾å‡ºæ‰€æœ‰åŒ¹é…é¡¹å¹¶ refetchã€‚</p>
<p>å¯ä»¥ï¼Œå¼€å¹²ã€‚</p>
<p>åŒ¹é… key ä¼šç¨å¤æ‚ä¸€ç‚¹ï¼šæ¯ä¸ªä¼ å…¥çš„ key å¯èƒ½æ˜¯ prefixï¼Œä¼šåŒ¹é…å¤šæ¡ cache entryï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨ <code>flatMap</code> æ¥æ‰¾å‡ºæ‰€æœ‰åŒ¹é…é¡¹ï¼Œå†åˆ©ç”¨ <code>cache.findAll</code>ï¼ˆå¾ˆå¥½ç”¨ï¼‰ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> allQueriesFound = refetch.<span class="hljs-title function_">flatMap</span>(
  <span class="hljs-function"><span class="hljs-params">k</span> =&gt;</span> cache.<span class="hljs-title function_">findAll</span>({ <span class="hljs-attr">queryKey</span>: k, <span class="hljs-attr">exact</span>: <span class="hljs-literal">false</span> })
);
</code></pre>
<p>ç„¶åå¾ªç¯å¹¶åšå’Œä¹‹å‰ä¸€æ ·çš„äº‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> allQueriesFound = refetch.<span class="hljs-title function_">flatMap</span>(
  <span class="hljs-function"><span class="hljs-params">k</span> =&gt;</span> cache.<span class="hljs-title function_">findAll</span>({ <span class="hljs-attr">queryKey</span>: k, <span class="hljs-attr">exact</span>: <span class="hljs-literal">false</span> })
);

allQueriesFound.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">entry</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">revalidatePayload</span>: <span class="hljs-built_in">any</span> = entry?.<span class="hljs-property">meta</span>?.<span class="hljs-property">__revalidate</span> ?? <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">if</span> (revalidatePayload) {
    revalidate.<span class="hljs-property">refetch</span>.<span class="hljs-title function_">push</span>({
      <span class="hljs-attr">key</span>: entry.<span class="hljs-property">queryKey</span>,
      <span class="hljs-attr">fn</span>: revalidatePayload.<span class="hljs-property">serverFn</span>,
      <span class="hljs-attr">arg</span>: revalidatePayload.<span class="hljs-property">arg</span>,
    });
  }
});
</code></pre>
<p>è¿™å°±èƒ½ç”¨äº†ã€‚</p>
<h2 data-id="heading-7">æ›´è¿›ä¸€æ­¥</h2>
<p>ä¸è¿‡æˆ‘ä»¬çš„æ–¹æ¡ˆä»ç„¶ä¸ç†æƒ³ã€‚å‡è®¾ç”¨æˆ·åœ¨ epics é¡µé¢ç¿»é¡µï¼šåˆ°ç¬¬ 2 é¡µã€åˆ°ç¬¬ 3 é¡µã€å†å›åˆ°ç¬¬ 1 é¡µã€‚æˆ‘ä»¬çš„é€»è¾‘ä¼šæ‰¾åˆ°ç¬¬ 1 é¡µå’Œ summary queryï¼Œä½†ä¹Ÿä¼šæŠŠç¬¬ 2ã€3 é¡µä¸€å¹¶æ‰¾åˆ°ï¼ˆå› ä¸ºå®ƒä»¬ç°åœ¨ä¹Ÿåœ¨ cache é‡Œï¼‰ã€‚ç„¶è€Œç¬¬ 2ã€3 é¡µå¹¶ä¸æ´»è·ƒï¼Œä¹Ÿä¸åœ¨å±å¹•ä¸Šå±•ç¤ºï¼Œæˆ‘ä»¬ä¸åº”è¯¥ refetch å®ƒä»¬ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥åª refetch active queriesï¼šåªè¦ç»™ <code>findAll</code> åŠ ä¸Š <code>type</code> å‚æ•°å³å¯ã€‚</p>
<p><code>cache.findAll({ queryKey: key, exact: false, type: "active" });</code></p>
<p>äºæ˜¯ä»£ç å°±å˜æˆè¿™æ ·ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> allQueriesFound = refetch.<span class="hljs-title function_">flatMap</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> cache.<span class="hljs-title function_">findAll</span>({ <span class="hljs-attr">queryKey</span>: key, <span class="hljs-attr">exact</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">"active"</span> }));

allQueriesFound.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">entry</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">revalidatePayload</span>: <span class="hljs-built_in">any</span> = entry?.<span class="hljs-property">meta</span>?.<span class="hljs-property">__revalidate</span> ?? <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">if</span> (revalidatePayload) {
    revalidate.<span class="hljs-property">refetch</span>.<span class="hljs-title function_">push</span>({
      <span class="hljs-attr">key</span>: entry.<span class="hljs-property">queryKey</span>,
      <span class="hljs-attr">fn</span>: revalidatePayload.<span class="hljs-property">serverFn</span>,
      <span class="hljs-attr">arg</span>: revalidatePayload.<span class="hljs-property">arg</span>,
    });
  }
});
</code></pre>
<h2 data-id="heading-8">æ›´æ›´è¿›ä¸€æ­¥</h2>
<p>è¿™æ ·å°±èƒ½å·¥ä½œäº†ã€‚ä½†ä½ ä»”ç»†æƒ³æƒ³ï¼Œé‚£äº› inactive çš„ queries å…¶å®åº”è¯¥è¢« invalidatedã€‚æˆ‘ä»¬ä¸å¸Œæœ›ç«‹åˆ» refetch å®ƒä»¬ï¼ˆæµªè´¹èµ„æºï¼Œè€Œä¸”ç”¨æˆ·æ²¡åœ¨çœ‹ï¼‰ï¼Œä½†å¦‚æœç”¨æˆ·åˆç¿»å›é‚£äº›é¡µé¢ï¼Œæˆ‘ä»¬å¸Œæœ›è§¦å‘ä¸€æ¬¡é‡æ–°è·å–ã€‚TanStack Query é€šè¿‡ <code>invalidateQueries</code> å¾ˆå®¹æ˜“åšåˆ°ã€‚</p>
<p>æˆ‘ä»¬æŠŠè¿™æ®µåŠ åˆ°â€œè¢«ä¾èµ–çš„é‚£ä¸ª middlewareâ€çš„ client å›è°ƒé‡Œï¼š</p>
<pre><code class="hljs language-ts" lang="ts">data?.<span class="hljs-property">refetch</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> {
  queryClient.<span class="hljs-title function_">invalidateQueries</span>({ <span class="hljs-attr">queryKey</span>: key, <span class="hljs-attr">exact</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">"inactive"</span>, <span class="hljs-attr">refetchType</span>: <span class="hljs-string">"none"</span> });
});
</code></pre>
<p>éå†ä¼ å…¥çš„ query keysï¼ŒæŠŠæ‰€æœ‰åŒ¹é…çš„ inactive queries æ ‡è®°ä¸ºæ— æ•ˆï¼Œä½†ä¸ç«‹åˆ» refetchï¼ˆ<code>refetchType: "none"</code>ï¼‰ã€‚</p>
<p>ä¸‹é¢æ˜¯æ›´æ–°åçš„å®Œæ•´ middlewareï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> prelimRefetchMiddleware = <span class="hljs-title function_">createMiddleware</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">"function"</span> })
  .<span class="hljs-title function_">inputValidator</span>(<span class="hljs-function">(<span class="hljs-params">config?: RefetchMiddlewareConfig</span>) =&gt;</span> config)
  .<span class="hljs-title function_">client</span>(<span class="hljs-keyword">async</span> ({ next, data }) =&gt; {
    <span class="hljs-keyword">const</span> { refetch = [] } = data ?? {};

    <span class="hljs-keyword">const</span> router = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getRouterInstance</span>();
    <span class="hljs-keyword">const</span> <span class="hljs-attr">queryClient</span>: <span class="hljs-title class_">QueryClient</span> = router.<span class="hljs-property">options</span>.<span class="hljs-property">context</span>.<span class="hljs-property">queryClient</span>;
    <span class="hljs-keyword">const</span> cache = queryClient.<span class="hljs-title function_">getQueryCache</span>();

    <span class="hljs-keyword">const</span> <span class="hljs-attr">revalidate</span>: <span class="hljs-title class_">RevalidationPayload</span> = {
      <span class="hljs-attr">refetch</span>: [],
    };

    <span class="hljs-keyword">const</span> allQueriesFound = refetch.<span class="hljs-title function_">flatMap</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> cache.<span class="hljs-title function_">findAll</span>({ <span class="hljs-attr">queryKey</span>: key, <span class="hljs-attr">exact</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">"active"</span> }));

    allQueriesFound.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">entry</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> <span class="hljs-attr">revalidatePayload</span>: <span class="hljs-built_in">any</span> = entry?.<span class="hljs-property">meta</span>?.<span class="hljs-property">__revalidate</span> ?? <span class="hljs-literal">null</span>;

      <span class="hljs-keyword">if</span> (revalidatePayload) {
        revalidate.<span class="hljs-property">refetch</span>.<span class="hljs-title function_">push</span>({
          <span class="hljs-attr">key</span>: entry.<span class="hljs-property">queryKey</span>,
          <span class="hljs-attr">fn</span>: revalidatePayload.<span class="hljs-property">serverFn</span>,
          <span class="hljs-attr">arg</span>: revalidatePayload.<span class="hljs-property">arg</span>,
        });
      }
    });

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>({
      <span class="hljs-attr">sendContext</span>: {
        revalidate,
      },
    });
  })
  .<span class="hljs-title function_">server</span>(<span class="hljs-keyword">async</span> ({ next, context }) =&gt; {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>({
      <span class="hljs-attr">sendContext</span>: {
        <span class="hljs-attr">payloads</span>: [] <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>[],
      },
    });

    <span class="hljs-keyword">const</span> allPayloads = context.<span class="hljs-property">revalidate</span>.<span class="hljs-property">refetch</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">refetchPayload</span> =&gt;</span> {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">key</span>: refetchPayload.<span class="hljs-property">key</span>,
        <span class="hljs-attr">result</span>: refetchPayload.<span class="hljs-title function_">fn</span>({ <span class="hljs-attr">data</span>: refetchPayload.<span class="hljs-property">arg</span> }),
      };
    });

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> refetchPayload <span class="hljs-keyword">of</span> allPayloads) {
      result.<span class="hljs-property">sendContext</span>.<span class="hljs-property">payloads</span>.<span class="hljs-title function_">push</span>({
        <span class="hljs-attr">key</span>: refetchPayload.<span class="hljs-property">key</span>,
        <span class="hljs-attr">result</span>: <span class="hljs-keyword">await</span> refetchPayload.<span class="hljs-property">result</span>,
      });
    }

    <span class="hljs-keyword">return</span> result;
  });

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> refetchMiddleware = <span class="hljs-title function_">createMiddleware</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">"function"</span> })
  .<span class="hljs-title function_">middleware</span>([prelimRefetchMiddleware])
  .<span class="hljs-title function_">client</span>(<span class="hljs-keyword">async</span> ({ data, next }) =&gt; {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();

    <span class="hljs-keyword">const</span> router = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getRouterInstance</span>();
    <span class="hljs-keyword">const</span> <span class="hljs-attr">queryClient</span>: <span class="hljs-title class_">QueryClient</span> = router.<span class="hljs-property">options</span>.<span class="hljs-property">context</span>.<span class="hljs-property">queryClient</span>;

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> result.<span class="hljs-property">context</span>?.<span class="hljs-property">payloads</span> ?? []) {
      queryClient.<span class="hljs-title function_">setQueryData</span>(entry.<span class="hljs-property">key</span>, entry.<span class="hljs-property">result</span>, { <span class="hljs-attr">updatedAt</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() });
    }

    data?.<span class="hljs-property">refetch</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> {
      queryClient.<span class="hljs-title function_">invalidateQueries</span>({ <span class="hljs-attr">queryKey</span>: key, <span class="hljs-attr">exact</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">"inactive"</span>, <span class="hljs-attr">refetchType</span>: <span class="hljs-string">"none"</span> });
    });

    <span class="hljs-keyword">return</span> result;
  });
</code></pre>
<p>æˆ‘ä»¬å‘Šè¯‰ TanStack Queryï¼šæŠŠåŒ¹é… key çš„ inactive queries ç½®ä¸º invalidï¼ˆä½†ä¸ refetchï¼‰ã€‚</p>
<p>è¿™ä¸ªæ–¹æ¡ˆéå¸¸å¥½ç”¨ï¼šå¦‚æœä½ æµè§ˆåˆ°ç¬¬ 2ã€3 é¡µï¼Œç„¶åå›åˆ°ç¬¬ 1 é¡µï¼Œå†ç¼–è¾‘ä¸€ä¸ª todoï¼Œä½ ä¼šçœ‹åˆ°ç¬¬ 1 é¡µåˆ—è¡¨å’Œ summary ç«‹åˆ»æ›´æ–°ã€‚ä¹‹åå¦‚æœä½ å†ç¿»å›ç¬¬ 2ã€3 é¡µï¼Œä½ ä¼šçœ‹åˆ°ç½‘ç»œè¯·æ±‚è§¦å‘ï¼Œä»è€Œæ‹¿åˆ°æ–°æ•°æ®ã€‚</p>
<h2 data-id="heading-9">é”¦ä¸Šæ·»èŠ±</h2>
<p>è¿˜è®°å¾—æˆ‘ä»¬æŠŠ server function å’Œå‚æ•°å¡è¿› query options æ—¶çš„å†™æ³•å—ï¼Ÿ</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">epicsQueryOptions</span> = (<span class="hljs-params">page: <span class="hljs-built_in">number</span></span>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">queryOptions</span>({
    <span class="hljs-attr">queryKey</span>: [<span class="hljs-string">"epics"</span>, <span class="hljs-string">"list"</span>, page],
    <span class="hljs-attr">queryFn</span>: <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getEpicsList</span>({ <span class="hljs-attr">data</span>: page });
      <span class="hljs-keyword">return</span> result;
    },
    <span class="hljs-attr">staleTime</span>: <span class="hljs-number">1000</span> * <span class="hljs-number">60</span> * <span class="hljs-number">5</span>,
    <span class="hljs-attr">gcTime</span>: <span class="hljs-number">1000</span> * <span class="hljs-number">60</span> * <span class="hljs-number">5</span>,
    <span class="hljs-attr">meta</span>: {
      <span class="hljs-attr">__revalidate</span>: {
        <span class="hljs-attr">serverFn</span>: getEpicsList,
        <span class="hljs-attr">arg</span>: page,
      },
    },
  });
};
</code></pre>
<p>æˆ‘ä¹‹å‰æè¿‡ï¼šåœ¨ <code>meta</code> å’Œ <code>queryFn</code> é‡Œé‡å¤å†™ serverFn/arg æœ‰ç‚¹â€œè„â€ã€‚æˆ‘ä»¬æ¥ä¿®ä¸€ä¸‹ã€‚</p>
<p>å…ˆä»æœ€ç®€å•çš„ helper å¼€å§‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">refetchedQueryOptions</span>(<span class="hljs-params">queryKey: QueryKey, serverFn: <span class="hljs-built_in">any</span>, arg?: <span class="hljs-built_in">any</span></span>) {
  <span class="hljs-keyword">const</span> queryKeyToUse = [...queryKey];
  <span class="hljs-keyword">if</span> (arg != <span class="hljs-literal">null</span>) {
    queryKeyToUse.<span class="hljs-title function_">push</span>(arg);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">queryOptions</span>({
    <span class="hljs-attr">queryKey</span>: queryKeyToUse,
    <span class="hljs-attr">queryFn</span>: <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">serverFn</span>({ <span class="hljs-attr">data</span>: arg });
    },
    <span class="hljs-attr">meta</span>: {
      <span class="hljs-attr">__revalidate</span>: {
        serverFn,
        arg,
      },
    },
  });
}
</code></pre>
<p>è¿™ä¸ª helper ä¼šæ¥æ”¶ query keyã€server function å’Œå‚æ•°ï¼Œç„¶åè¿”å› query optionsï¼š</p>
<ul>
<li>æ‹¼å¥½çš„ <code>queryKey</code>ï¼ˆå¿…è¦æ—¶æŠŠ arg è¿½åŠ è¿›å»ï¼‰</li>
<li><code>queryFn</code>ï¼ˆç›´æ¥è°ƒç”¨ server functionï¼‰</li>
<li><code>meta.__revalidate</code>ï¼ˆåŒæ ·è®°å½• server function å’Œå‚æ•°ï¼‰</li>
</ul>
<p>äºæ˜¯ epics åˆ—è¡¨ query å°±å¯ä»¥å†™æˆï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">epicsQueryOptions</span> = (<span class="hljs-params">page: <span class="hljs-built_in">number</span></span>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">queryOptions</span>({
    ...<span class="hljs-title function_">refetchedQueryOptions</span>([<span class="hljs-string">"epics"</span>, <span class="hljs-string">"list"</span>], getEpicsList, page),
    <span class="hljs-attr">staleTime</span>: <span class="hljs-number">1000</span> * <span class="hljs-number">60</span> * <span class="hljs-number">5</span>,
    <span class="hljs-attr">gcTime</span>: <span class="hljs-number">1000</span> * <span class="hljs-number">60</span> * <span class="hljs-number">5</span>,
  });
};
</code></pre>
<p>å®ƒèƒ½å·¥ä½œï¼Œä½†ç±»å‹ä¸å¥½ï¼šåˆ°å¤„éƒ½æ˜¯ <code>any</code>ï¼Œæ„å‘³ç€ä¼ ç»™ server function çš„å‚æ•°ä¸åšç±»å‹æ£€æŸ¥ï¼›æ›´ç³Ÿçš„æ˜¯ï¼Œ<code>queryFn</code> çš„è¿”å›å€¼ä¹Ÿä¸ä¼šè¢«æ£€æŸ¥ï¼Œäºæ˜¯ä½ çš„ queryï¼ˆæ¯”å¦‚è¿™ä¸ª epics åˆ—è¡¨ï¼‰ä¼šå˜æˆè¿”å› <code>any</code>ã€‚</p>
<p>æˆ‘ä»¬æ¥åŠ ç‚¹ç±»å‹ã€‚</p>
<p>server functions æœ¬è´¨ä¸Šæ˜¯å‡½æ•°ï¼šæ¥æ”¶ä¸€ä¸ªå¯¹è±¡å‚æ•°ï¼›å¦‚æœ server function å®šä¹‰äº†è¾“å…¥ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡ä¼šåŒ…å«ä¸€ä¸ª <code>data</code> å±æ€§ï¼Œé‡Œé¢å°±æ˜¯è¾“å…¥ã€‚è¯´ä¸€å †å¤§ç™½è¯ä¸å¦‚çœ‹è°ƒç”¨ä¾‹å­ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">runSaveSimple</span>({
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">id</span>: epic.<span class="hljs-property">id</span>,
    <span class="hljs-attr">name</span>: newValue,
  },
});
</code></pre>
<p>ç¬¬äºŒç‰ˆ helper å¯ä»¥è¿™æ ·å†™ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> refetchedQueryOptions&lt;T <span class="hljs-keyword">extends</span> (<span class="hljs-attr">arg</span>: { <span class="hljs-attr">data</span>: <span class="hljs-built_in">any</span> }) =&gt; <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">any</span>&gt;&gt;(
  <span class="hljs-attr">queryKey</span>: <span class="hljs-title class_">QueryKey</span>,
  <span class="hljs-attr">serverFn</span>: T,
  <span class="hljs-attr">arg</span>: <span class="hljs-title class_">Parameters</span>&lt;T&gt;[<span class="hljs-number">0</span>][<span class="hljs-string">"data"</span>],
) {
  <span class="hljs-keyword">const</span> queryKeyToUse = [...queryKey];
  <span class="hljs-keyword">if</span> (arg != <span class="hljs-literal">null</span>) {
    queryKeyToUse.<span class="hljs-title function_">push</span>(arg);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">queryOptions</span>({
    <span class="hljs-attr">queryKey</span>: queryKeyToUse,
    <span class="hljs-attr">queryFn</span>: <span class="hljs-keyword">async</span> (): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Awaited</span>&lt;<span class="hljs-title class_">ReturnType</span>&lt;T&gt;&gt;&gt; =&gt; {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">serverFn</span>({ <span class="hljs-attr">data</span>: arg });
    },
    <span class="hljs-attr">meta</span>: {
      <span class="hljs-attr">__revalidate</span>: {
        serverFn,
        arg,
      },
    },
  });
}
</code></pre>
<p>æˆ‘ä»¬æŠŠ server function çº¦æŸä¸ºä¸€ä¸ª async å‡½æ•°ï¼Œä¸”å®ƒçš„å‚æ•°å¯¹è±¡ä¸Šæœ‰ <code>data</code>ï¼›ç„¶åç”¨å®ƒæ¥é™æ€æ¨æ–­ <code>arg</code> çš„ç±»å‹ã€‚è¿™å·²ç»ä¸é”™äº†ï¼Œä½†å½“ä½ æŠŠå®ƒç”¨åœ¨â€œæ²¡æœ‰å‚æ•°â€çš„ server function ä¸Šæ—¶ä¼šæŠ¥é”™ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">...<span class="hljs-title function_">refetchedQueryOptions</span>([<span class="hljs-string">"epics"</span>, <span class="hljs-string">"list"</span>, <span class="hljs-string">"summary"</span>], getEpicsSummary)
<span class="hljs-comment">// Expected 3 arguments, but got 2.</span>
</code></pre>
<p>ä½ ä¼  <code>undefined</code> å¯ä»¥è§£å†³ï¼ŒåŠŸèƒ½ä¹Ÿæ­£å¸¸ï¼š</p>
<p><code>...refetchedQueryOptions(["epics", "list", "summary"], getEpicsSummary, undefined),</code></p>
<p>å¦‚æœä½ æ˜¯ä¸ªæ­£å¸¸äººï¼Œä½ å¤§æ¦‚ä¼šè§‰å¾—è¿™å·²ç»å¾ˆå¥½äº†ï¼Œè€Œä¸”ç¡®å®å¦‚æ­¤ã€‚ä½†å¦‚æœä½ åƒæˆ‘ä¸€æ ·æœ‰ç‚¹â€œæ€ªâ€ï¼Œä½ å¯èƒ½ä¼šæƒ³èƒ½ä¸èƒ½åšåˆ°æ›´å®Œç¾ï¼š</p>
<ul>
<li>å½“ server function æœ‰å‚æ•°æ—¶ï¼šå¿…é¡»ä¼ å…¥ä¸”ç±»å‹è¦æ­£ç¡®</li>
<li>å½“ server function æ²¡å‚æ•°æ—¶ï¼šå…è®¸çœç•¥ arg</li>
</ul>
<p>TypeScript æœ‰ä¸€ä¸ªç‰¹æ€§æ­£å¥½é€‚åˆï¼š<strong>å‡½æ•°é‡è½½ï¼ˆoverloaded functionsï¼‰</strong>ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« å·²ç»å¤Ÿé•¿äº†ï¼Œæ‰€ä»¥æˆ‘ç›´æ¥è´´ä»£ç ï¼Œè§£è¯»ç•™ä½œè¯»è€…ç»ƒä¹ ï¼ˆä»¥åŠå¯èƒ½çš„æœªæ¥æ–‡ç« ï¼‰ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">QueryKey</span>, queryOptions } <span class="hljs-keyword">from</span> <span class="hljs-string">"@tanstack/react-query"</span>;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">AnyAsyncFn</span> = <span class="hljs-function">(<span class="hljs-params">...args: <span class="hljs-built_in">any</span>[]</span>) =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">any</span>&gt;;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">ServerFnArgs</span>&lt;<span class="hljs-title class_">TFn</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AnyAsyncFn</span>&gt; = <span class="hljs-title class_">Parameters</span>&lt;<span class="hljs-title class_">TFn</span>&gt;[<span class="hljs-number">0</span>] <span class="hljs-keyword">extends</span> infer <span class="hljs-title class_">TRootArgs</span>
  ? <span class="hljs-title class_">TRootArgs</span> <span class="hljs-keyword">extends</span> { <span class="hljs-attr">data</span>: infer <span class="hljs-title class_">TResult</span> }
    ? <span class="hljs-title class_">TResult</span>
    : <span class="hljs-literal">undefined</span>
  : <span class="hljs-built_in">never</span>;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">ServerFnHasArgs</span>&lt;<span class="hljs-title class_">TFn</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AnyAsyncFn</span>&gt; = <span class="hljs-title class_">ServerFnArgs</span>&lt;<span class="hljs-title class_">TFn</span>&gt; <span class="hljs-keyword">extends</span> infer U ? (U <span class="hljs-keyword">extends</span> <span class="hljs-literal">undefined</span> ? <span class="hljs-literal">false</span> : <span class="hljs-literal">true</span>) : <span class="hljs-literal">false</span>;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">ServerFnWithArgs</span>&lt;<span class="hljs-title class_">TFn</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AnyAsyncFn</span>&gt; = <span class="hljs-title class_">ServerFnHasArgs</span>&lt;<span class="hljs-title class_">TFn</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-literal">true</span> ? <span class="hljs-title class_">TFn</span> : <span class="hljs-built_in">never</span>;
<span class="hljs-keyword">type</span> <span class="hljs-title class_">ServerFnWithoutArgs</span>&lt;<span class="hljs-title class_">TFn</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AnyAsyncFn</span>&gt; = <span class="hljs-title class_">ServerFnHasArgs</span>&lt;<span class="hljs-title class_">TFn</span>&gt; <span class="hljs-keyword">extends</span> <span class="hljs-literal">false</span> ? <span class="hljs-title class_">TFn</span> : <span class="hljs-built_in">never</span>;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">RefetchQueryOptions</span>&lt;T&gt; = {
  <span class="hljs-attr">queryKey</span>: <span class="hljs-title class_">QueryKey</span>;
  queryFn?: <span class="hljs-function">(<span class="hljs-params">_: <span class="hljs-built_in">any</span></span>) =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;T&gt;;
  meta?: <span class="hljs-built_in">any</span>;
};

<span class="hljs-keyword">type</span> <span class="hljs-title class_">ValidateServerFunction</span>&lt;<span class="hljs-title class_">Provided</span>, <span class="hljs-title class_">Expected</span>&gt; = <span class="hljs-title class_">Provided</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Expected</span> ? <span class="hljs-title class_">Provided</span> : <span class="hljs-string">"This server function requires an argument!"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> refetchedQueryOptions&lt;<span class="hljs-title class_">TFn</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AnyAsyncFn</span>&gt;(
  <span class="hljs-attr">queryKey</span>: <span class="hljs-title class_">QueryKey</span>,
  <span class="hljs-attr">serverFn</span>: <span class="hljs-title class_">ServerFnWithArgs</span>&lt;<span class="hljs-title class_">TFn</span>&gt;,
  <span class="hljs-attr">arg</span>: <span class="hljs-title class_">Parameters</span>&lt;<span class="hljs-title class_">TFn</span>&gt;[<span class="hljs-number">0</span>][<span class="hljs-string">"data"</span>],
): <span class="hljs-title class_">RefetchQueryOptions</span>&lt;<span class="hljs-title class_">Awaited</span>&lt;<span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-title class_">TFn</span>&gt;&gt;&gt;;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> refetchedQueryOptions&lt;<span class="hljs-title class_">TFn</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AnyAsyncFn</span>&gt;(
  <span class="hljs-attr">queryKey</span>: <span class="hljs-title class_">QueryKey</span>,
  <span class="hljs-attr">serverFn</span>: <span class="hljs-title class_">ValidateServerFunction</span>&lt;<span class="hljs-title class_">TFn</span>, <span class="hljs-title class_">ServerFnWithoutArgs</span>&lt;<span class="hljs-title class_">TFn</span>&gt;&gt;,
): <span class="hljs-title class_">RefetchQueryOptions</span>&lt;<span class="hljs-title class_">Awaited</span>&lt;<span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-title class_">TFn</span>&gt;&gt;&gt;;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> refetchedQueryOptions&lt;<span class="hljs-title class_">TFn</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AnyAsyncFn</span>&gt;(
  <span class="hljs-attr">queryKey</span>: <span class="hljs-title class_">QueryKey</span>,
  <span class="hljs-attr">serverFn</span>: <span class="hljs-title class_">ServerFnWithoutArgs</span>&lt;<span class="hljs-title class_">TFn</span>&gt; | <span class="hljs-title class_">ServerFnWithArgs</span>&lt;<span class="hljs-title class_">TFn</span>&gt;,
  arg?: <span class="hljs-title class_">Parameters</span>&lt;<span class="hljs-title class_">TFn</span>&gt;[<span class="hljs-number">0</span>][<span class="hljs-string">"data"</span>],
): <span class="hljs-title class_">RefetchQueryOptions</span>&lt;<span class="hljs-title class_">Awaited</span>&lt;<span class="hljs-title class_">ReturnType</span>&lt;<span class="hljs-title class_">TFn</span>&gt;&gt;&gt; {
  <span class="hljs-keyword">const</span> queryKeyToUse = [...queryKey];
  <span class="hljs-keyword">if</span> (arg != <span class="hljs-literal">null</span>) {
    queryKeyToUse.<span class="hljs-title function_">push</span>(arg);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">queryOptions</span>({
    <span class="hljs-attr">queryKey</span>: queryKeyToUse,
    <span class="hljs-attr">queryFn</span>: <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">serverFn</span>({ <span class="hljs-attr">data</span>: arg });
    },
    <span class="hljs-attr">meta</span>: {
      <span class="hljs-attr">__revalidate</span>: {
        serverFn,
        arg,
      },
    },
  });
}
</code></pre>
<p>æœ‰äº†å®ƒä¹‹åï¼Œå½“ server function éœ€è¦å‚æ•°æ—¶ï¼Œä½ å¯ä»¥è¿™æ ·è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">epicsQueryOptions</span> = (<span class="hljs-params">page: <span class="hljs-built_in">number</span></span>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">queryOptions</span>({
    ...<span class="hljs-title function_">refetchedQueryOptions</span>([<span class="hljs-string">"epics"</span>, <span class="hljs-string">"list"</span>], getEpicsList, page),
    <span class="hljs-attr">staleTime</span>: <span class="hljs-number">1000</span> * <span class="hljs-number">60</span> * <span class="hljs-number">5</span>,
    <span class="hljs-attr">gcTime</span>: <span class="hljs-number">1000</span> * <span class="hljs-number">60</span> * <span class="hljs-number">5</span>,
  });
};
</code></pre>
<p>å‚æ•°ç±»å‹ä¼šè¢«æ­£ç¡®æ£€æŸ¥ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">...<span class="hljs-title function_">refetchedQueryOptions</span>([<span class="hljs-string">"epics"</span>, <span class="hljs-string">"list"</span>], getEpicsList, <span class="hljs-string">""</span>)
<span class="hljs-comment">// Argument of type 'string' is not assignable to parameter of type 'number'.</span>
</code></pre>
<p>å¦‚æœä½ å¿˜äº†ä¼ å‚æ•°ï¼Œå®ƒä¹Ÿä¼šæŠ¥é”™ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">...<span class="hljs-title function_">refetchedQueryOptions</span>([<span class="hljs-string">"epics"</span>, <span class="hljs-string">"list"</span>], getEpicsList)
<span class="hljs-comment">// Argument of type 'RequiredFetcher&lt;undefined, (page: number) =&gt; number, Promise&lt;{ id: number; name: string; }[]&gt;&gt;' is not assignable to parameter of type '"This server function requires an argument!"'.</span>
</code></pre>
<p>æœ€åè¿™ä¸ªæŠ¥é”™ä¿¡æ¯ä¸ç®—ç‰¹åˆ«ç›´è§‚ï¼Œä½†å¦‚æœä½ æŠŠä»£ç è¯»åˆ°æœ€åï¼Œä¼šå‘ç°å®ƒå·²ç»åœ¨å°½åŠ›æç¤ºä½ å“ªé‡Œé”™äº†ï¼Œé çš„å°±æ˜¯è¿™ä¸ªå°å·¥å…·ç±»å‹ï¼š</p>
<p><code>type ValidateServerFunction&lt;Provided, Expected&gt; = Provided extends Expected ? Provided : "This server function requires an argument!";</code></p>
<p>è€Œå¯¹äºâ€œæ²¡æœ‰å‚æ•°â€çš„ server functionï¼Œå®ƒä¹Ÿèƒ½æ­£å¸¸å·¥ä½œã€‚å®Œæ•´è§£é‡Šç•™ç»™æœªæ¥æ–‡ç« ã€‚</p>
<h2 data-id="heading-10">æ€»ç»“</h2>
<p>single flight mutations æ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„ä¼˜åŒ–å·¥å…·ï¼šå½“ä½ åšä¸€æ¬¡ mutation åï¼ŒUI éœ€è¦çš„æ›´æ–°æ•°æ®ä¸å¿…å†é¢å¤–å‘è¯·æ±‚è·å–ï¼Œè€Œæ˜¯å¯ä»¥åœ¨åŒä¸€æ¬¡å¾€è¿”é‡Œé¡ºä¾¿å¸¦å›æ¥ã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« æŠŠå„ä¸ªæ‹¼å›¾éƒ½è®²æ¸…æ¥šäº†ï¼šå¦‚ä½•ç”¨ middleware æ”¶é›†è¦ refetch çš„æŸ¥è¯¢ã€å¦‚ä½•å€ŸåŠ© TanStack Start çš„ server function åºåˆ—åŒ–èƒ½åŠ›æŠŠâ€œè¦æ‰§è¡Œçš„ refetchâ€å‘é€åˆ°æœåŠ¡ç«¯ã€ä»¥åŠå¦‚ä½•åœ¨å®¢æˆ·ç«¯ç”¨ <code>setQueryData</code> æŠŠæ•°æ®å†™å›ç¼“å­˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>