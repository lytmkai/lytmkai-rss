<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[Trae å®˜å®£ï¼šæ”¯æŒSkillï¼]]></title>    <link>https://juejin.cn/post/7598023360733052938</link>    <guid>https://juejin.cn/post/7598023360733052938</guid>    <pubDate>2026-01-23T00:40:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598023360733052938" data-draft-id="7597434154797269018" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Trae å®˜å®£ï¼šæ”¯æŒSkillï¼"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-23T00:40:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="golangå­¦ä¹ è®°"/> <meta itemprop="url" content="https://juejin.cn/user/4371313964100990"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Trae å®˜å®£ï¼šæ”¯æŒSkillï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4371313964100990/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    golangå­¦ä¹ è®°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T00:40:34.000Z" title="Fri Jan 23 2026 00:40:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">0. ä¸ºä»€ä¹ˆä½ éœ€è¦â€œSkillâ€ï¼Ÿå› ä¸º AI ä¸èƒ½é çŒœï¼</h2>
<p>ä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™ç§æƒ…å†µï¼š</p>
<blockquote>
<p>â€œTraeï¼Œå¸®æˆ‘å†™ä¸ªé«˜æ€§èƒ½çš„ Go HTTP æœåŠ¡ã€‚â€<br/>
â†’ å®ƒè¿”å›ä¸€ä¸ª <code>net/http</code> çš„ Hello Worldï¼Œè¿ä¸­é—´ä»¶éƒ½æ²¡åŠ ã€‚</p>
</blockquote>
<p>é—®é¢˜åœ¨å“ªï¼Ÿ<strong>AI ä¸çŸ¥é“ä½ çš„â€œä¸Šä¸‹æ–‡æ ‡å‡†â€</strong>ã€‚ä½ å¿ƒç›®ä¸­çš„â€œé«˜æ€§èƒ½â€å¯èƒ½æ˜¯å¸¦è¿æ¥æ± ã€pprofã€ç»“æ„åŒ–æ—¥å¿—ã€ä¼˜é›…å…³é—­çš„å®Œæ•´éª¨æ¶ï¼Œä½† AI é»˜è®¤åªç»™æœ€ç®€ç­”æ¡ˆã€‚</p>
<p>è¿™æ—¶å€™ï¼Œ<strong>Trae Skill</strong> å°±æ´¾ä¸Šç”¨åœºäº†â€”â€”å®ƒè®©ä½ æŠŠâ€œä¸“ä¸šç»éªŒâ€å°è£…æˆå¯å¤ç”¨çš„æŠ€èƒ½åŒ…ï¼Œè®© AI æŒ‰ä½ çš„è§„èŒƒè¾“å‡ºä»£ç ï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/05730db006aa41c0aced5098c1a922de~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769733634&amp;x-signature=hL214%2FSQdttMDuemNAHyHo6ufiY%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-1">1. ä»€ä¹ˆæ˜¯ Trae Skillï¼Ÿ</h2>
<p>ç®€å•è¯´ï¼Œ<strong>Skill æ˜¯ä¸€æ®µé¢„å®šä¹‰çš„æŒ‡ä»¤ + ç¤ºä¾‹ + çº¦æŸ</strong>ï¼Œå‘Šè¯‰ Traeï¼š</p>
<ul>
<li>åœ¨ä»€ä¹ˆåœºæ™¯ä¸‹è§¦å‘</li>
<li>åº”è¯¥éµå¾ªä»€ä¹ˆè§„èŒƒ</li>
<li>è¾“å‡ºä»€ä¹ˆæ ¼å¼çš„ä»£ç </li>
</ul>
<p>ä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸ºï¼š</p>
<ul>
<li>ç»™ AI çš„â€œç¼–ç¨‹é£æ ¼æŒ‡å—â€</li>
<li>å›¢é˜Ÿçš„â€œä»£ç æ¨¡æ¿è‡ªåŠ¨åŒ–å™¨â€</li>
<li>ä½ ä¸ªäººçš„â€œæœ€ä½³å®è·µçŸ¥è¯†åº“â€</li>
</ul>
<hr/>
<h2 data-id="heading-2">2. å®æˆ˜ï¼šåˆ›å»ºä¸€ä¸ª â€œGo å¾®æœåŠ¡éª¨æ¶â€ Skill</h2>
<h3 data-id="heading-3">åœºæ™¯</h3>
<p>ä½ ç»å¸¸è¦æ–°å»º Go å¾®æœåŠ¡é¡¹ç›®ï¼Œæ¯æ¬¡éƒ½å¾—æ‰‹åŠ¨å†™ï¼š</p>
<ul>
<li>å¸¦ Gin çš„è·¯ç”±</li>
<li>zap æ—¥å¿—</li>
<li>pprof ç›‘æ§</li>
<li>ä¼˜é›…å…³é—­</li>
<li>é…ç½®åŠ è½½ï¼ˆViperï¼‰</li>
</ul>
<p>å¤ªé‡å¤äº†ï¼ä¸å¦‚æ•™ Trae ä¸€æ¬¡ï¼Œä»¥åä¸€å¥è¯ç”Ÿæˆã€‚</p>
<h3 data-id="heading-4">æ­¥éª¤ 1ï¼šåˆ›å»ºskill</h3>
<p>æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯ç›´æ¥è·Ÿtraeå¯¹è¯ï¼Œè®©AIåˆ›å»ºä¸€ä¸ªskill</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a8ca701d1e8b4f018b24e206c33e57bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769733634&amp;x-signature=4T9OsAc968KR0GfYBrP%2F7IiimTU%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ä¹Ÿå¯ä»¥æ‰‹åŠ¨åˆ›å»ºskillï¼Œæ–‡ä»¶ä½ç½®åœ¨./trea/skillsä¸‹é¢</p>
<h3 data-id="heading-5">æ­¥éª¤ 2ï¼šå¡«å†™ Skill å…ƒä¿¡æ¯</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">Name:</span> <span class="hljs-string">go-microservice-skeleton</span>
<span class="hljs-attr">Trigger:</span> <span class="hljs-string">"create a Go microservice with Gin, zap, pprof, and graceful shutdown"</span>
<span class="hljs-attr">Description:</span> <span class="hljs-string">ç”Ÿæˆç¬¦åˆæˆ‘å›¢é˜Ÿè§„èŒƒçš„</span> <span class="hljs-string">Go</span> <span class="hljs-string">å¾®æœåŠ¡åŸºç¡€éª¨æ¶</span>
</code></pre>
<h3 data-id="heading-6">æ­¥éª¤ 3ï¼šç¼–å†™ Skill Prompt</h3>
<pre><code class="hljs language-text" lang="text">ä½ æ˜¯ä¸€ä¸ªèµ„æ·± Go åç«¯å·¥ç¨‹å¸ˆï¼Œè¯·æ ¹æ®ç”¨æˆ·éœ€æ±‚ç”Ÿæˆä¸€ä¸ªç”Ÿäº§çº§å¾®æœåŠ¡éª¨æ¶ï¼Œè¦æ±‚ï¼š

1. ä½¿ç”¨ Gin ä½œä¸º Web æ¡†æ¶
2. æ—¥å¿—ä½¿ç”¨ uber/zapï¼Œå¸¦ JSON æ ¼å¼å’Œ level æ§åˆ¶
3. è‡ªåŠ¨å¼€å¯ net/http/pprofï¼ˆä»…åœ¨ debug æ¨¡å¼ï¼‰
4. æ”¯æŒé€šè¿‡ config.yaml åŠ è½½é…ç½®ï¼ˆç”¨ Viperï¼‰
5. å®ç°ä¼˜é›…å…³é—­ï¼ˆç›‘å¬ SIGINT/SIGTERMï¼‰
6. é¡¹ç›®ç»“æ„æ¸…æ™°ï¼šcmd/, internal/, pkg/, config/

è¯·è¾“å‡ºå®Œæ•´çš„ main.go å’Œç›®å½•ç»“æ„è¯´æ˜ã€‚
</code></pre>
<h3 data-id="heading-7">æ­¥éª¤ 4ï¼šæ·»åŠ ç¤ºä¾‹ï¼ˆå¯é€‰ä½†å¼ºçƒˆæ¨èï¼‰</h3>
<p>æä¾›ä¸€ä¸ªä½ è®¤å¯çš„ <code>main.go</code> ç‰‡æ®µä½œä¸ºå‚è€ƒï¼Œå¸®åŠ© Trae ç†è§£ä½ çš„ä»£ç é£æ ¼ã€‚</p>
<h3 data-id="heading-8">æ­¥éª¤ 5ï¼šä¿å­˜å¹¶å¯ç”¨</h3>
<hr/>
<h2 data-id="heading-9">3. ä½¿ç”¨ Skillï¼šä¸€å¥è¯ç”Ÿæˆä¸“ä¸šä»£ç </h2>
<p>ç°åœ¨ï¼Œåœ¨èŠå¤©çª—å£è¾“å…¥ï¼š</p>
<blockquote>
<p>â€œç”¨ go-microservice-skeleton åˆ›å»ºä¸€ä¸ªç”¨æˆ·æœåŠ¡â€</p>
</blockquote>
<p>Trae ä¼šç«‹åˆ»è¿”å›ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// main.go</span>
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"context"</span>
    <span class="hljs-string">"log"</span>
    <span class="hljs-string">"net/http"</span>
    _ <span class="hljs-string">"net/http/pprof"</span>
    <span class="hljs-string">"os"</span>
    <span class="hljs-string">"os/signal"</span>
    <span class="hljs-string">"syscall"</span>
    <span class="hljs-string">"time"</span>

    <span class="hljs-string">"github.com/gin-gonic/gin"</span>
    <span class="hljs-string">"go.uber.org/zap"</span>
    <span class="hljs-string">"github.com/spf13/viper"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// åŠ è½½é…ç½®</span>
    viper.SetConfigName(<span class="hljs-string">"config"</span>)
    viper.SetConfigType(<span class="hljs-string">"yaml"</span>)
    viper.AddConfigPath(<span class="hljs-string">"."</span>)
    <span class="hljs-keyword">if</span> err := viper.ReadInConfig(); err != <span class="hljs-literal">nil</span> {
        log.Fatal(<span class="hljs-string">"config error:"</span>, err)
    }

    <span class="hljs-comment">// åˆå§‹åŒ–æ—¥å¿—</span>
    logger, _ := zap.NewProduction()
    <span class="hljs-keyword">defer</span> logger.Sync()

    <span class="hljs-comment">// Gin</span>
    r := gin.Default()
    r.GET(<span class="hljs-string">"/health"</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(c *gin.Context)</span></span> {
        c.JSON(<span class="hljs-number">200</span>, gin.H{<span class="hljs-string">"status"</span>: <span class="hljs-string">"ok"</span>})
    })

    <span class="hljs-comment">// å¯åŠ¨ HTTP æœåŠ¡</span>
    srv := &amp;http.Server{
        Addr:    <span class="hljs-string">":8080"</span>,
        Handler: r,
    }

    <span class="hljs-comment">// å¯åŠ¨ pprofï¼ˆä»…è°ƒè¯•ï¼‰</span>
    <span class="hljs-keyword">if</span> viper.GetBool(<span class="hljs-string">"debug"</span>) {
        <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
            http.ListenAndServe(<span class="hljs-string">"localhost:6060"</span>, <span class="hljs-literal">nil</span>)
        }()
    }

    <span class="hljs-comment">// ä¼˜é›…å…³é—­</span>
    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">if</span> err := srv.ListenAndServe(); err != <span class="hljs-literal">nil</span> &amp;&amp; err != http.ErrServerClosed {
            logger.Fatal(<span class="hljs-string">"server failed"</span>, zap.Error(err))
        }
    }()

    quit := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> os.Signal, <span class="hljs-number">1</span>)
    signal.Notify(quit, syscall.SIGINT, syscall.SIGTERM)
    &lt;-quit
    logger.Info(<span class="hljs-string">"shutting down server..."</span>)

    ctx, cancel := context.WithTimeout(context.Background(), <span class="hljs-number">5</span>*time.Second)
    <span class="hljs-keyword">defer</span> cancel()
    <span class="hljs-keyword">if</span> err := srv.Shutdown(ctx); err != <span class="hljs-literal">nil</span> {
        logger.Fatal(<span class="hljs-string">"server forced to shutdown"</span>, zap.Error(err))
    }
}
</code></pre>
<p>âœ… å®Œå…¨ç¬¦åˆä½ çš„è§„èŒƒï¼<br/>
âœ… æ— éœ€å¤åˆ¶ç²˜è´´æ—§é¡¹ç›®<br/>
âœ… è¿˜è‡ªåŠ¨å¤„ç†äº† pprof çš„å¼€å…³é€»è¾‘</p>
<hr/>
<h2 data-id="heading-10">4. Skill çš„é«˜çº§ç©æ³•</h2>
<h3 data-id="heading-11">âœ… å›¢é˜Ÿå…±äº«</h3>
<ul>
<li>æŠŠ Skill å¯¼å‡ºä¸º JSONï¼Œå›¢é˜Ÿæˆå‘˜ä¸€é”®å¯¼å…¥</li>
<li>ç»Ÿä¸€ä»£ç é£æ ¼ï¼Œæ–°äººä¸Šæ‰‹å¿«</li>
</ul>
<h3 data-id="heading-12">âœ… å¤šè¯­è¨€æ”¯æŒ</h3>
<ul>
<li>ä¸åªæ˜¯ Goï¼ä½ ä¹Ÿå¯ä»¥åˆ›å»ºï¼š
<ul>
<li><code>react-ts-component</code>ï¼šç”Ÿæˆå¸¦ Storybook å’Œæµ‹è¯•çš„ TSX ç»„ä»¶</li>
<li><code>terraform-aliyun-ecs</code>ï¼šæ ¹æ®ä½ çš„é˜¿é‡Œäº‘è´¦å·ä¹ æƒ¯ç”Ÿæˆ ECS æ¨¡æ¿</li>
</ul>
</li>
</ul>
<h3 data-id="heading-13">âœ… åŠ¨æ€å‚æ•°</h3>
<p>æœªæ¥ Trae å¯èƒ½æ”¯æŒï¼š</p>
<pre><code class="hljs language-text" lang="text">create user-service with port=9090, db=mysql
</code></pre>
<p>Skill è‡ªåŠ¨æ›¿æ¢æ¨¡æ¿ä¸­çš„å˜é‡ï¼</p>
<hr/>
<h2 data-id="heading-14">5. ä¸ºä»€ä¹ˆ Trae Skill æ¯”æ™®é€š prompt æ›´å¼ºï¼Ÿ</h2>






























<table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>æ™®é€š Prompt</th><th>Trae Skill</th></tr></thead><tbody><tr><td>å¤ç”¨æ€§</td><td>æ¯æ¬¡éƒ½è¦é‡å†™</td><td>ä¸€æ¬¡å®šä¹‰ï¼Œæ°¸ä¹…å¤ç”¨</td></tr><tr><td>è§¦å‘ç²¾å‡†åº¦</td><td>å®¹æ˜“è¯¯è§¦å‘</td><td>é€šè¿‡å…³é”®è¯/æ­£åˆ™ç²¾ç¡®åŒ¹é…</td></tr><tr><td>å›¢é˜Ÿåä½œ</td><td>æ— æ³•å…±äº«</td><td>å¯å¯¼å‡º/å¯¼å…¥ï¼Œå›¢é˜Ÿæ ‡å‡†åŒ–</td></tr><tr><td>ä¸Šä¸‹æ–‡éš”ç¦»</td><td>å®¹æ˜“è¢«å…¶ä»–å¯¹è¯å¹²æ‰°</td><td>ç‹¬ç«‹å‘½åç©ºé—´ï¼Œå¹²å‡€å¯é </td></tr></tbody></table>
<hr/>
<h2 data-id="heading-15">6. å°ç»“ï¼šæŠŠç»éªŒå˜æˆâ€œå¯æ‰§è¡Œçš„çŸ¥è¯†â€</h2>
<p>Trae Skill çš„æœ¬è´¨ï¼Œæ˜¯<strong>å°†ä½ å¤šå¹´ç§¯ç´¯çš„å·¥ç¨‹ç»éªŒï¼Œè½¬åŒ–ä¸º AI å¯æ‰§è¡Œçš„æŒ‡ä»¤</strong>ã€‚å®ƒä¸æ˜¯å–ä»£ä½ ï¼Œè€Œæ˜¯è®©ä½ ä»â€œé‡å¤åŠ³åŠ¨â€ä¸­è§£æ”¾å‡ºæ¥ï¼Œä¸“æ³¨çœŸæ­£æœ‰åˆ›é€ åŠ›çš„éƒ¨åˆ†ã€‚</p>
<blockquote>
<p>å°±åƒä½ ä¸ä¼šæ¯æ¬¡ç…®å’–å•¡éƒ½ä»ç§å’–å•¡è±†å¼€å§‹ï¼Œ<br/>
ä¹Ÿä¸è¯¥æ¯æ¬¡å†™æœåŠ¡éƒ½ä» <code>import "fmt"</code> å¼€å§‹ã€‚</p>
</blockquote>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ” æˆ‘å¼€æºäº† `miniaudit`ï¼šä¸€ä¸ªåŸºäº AST çš„å¾®ä¿¡å°ç¨‹åºå®¡æ ¸é¢„æ£€ CLIï¼Œç”¨é™æ€åˆ†ææå‰æ‹¦æˆª 13+ é«˜é¢‘æå®¡é›·åŒº]]></title>    <link>https://juejin.cn/post/7598029481508896787</link>    <guid>https://juejin.cn/post/7598029481508896787</guid>    <pubDate>2026-01-23T01:54:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598029481508896787" data-draft-id="7598062246573555766" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ” æˆ‘å¼€æºäº† `miniaudit`ï¼šä¸€ä¸ªåŸºäº AST çš„å¾®ä¿¡å°ç¨‹åºå®¡æ ¸é¢„æ£€ CLIï¼Œç”¨é™æ€åˆ†ææå‰æ‹¦æˆª 13+ é«˜é¢‘æå®¡é›·åŒº"/> <meta itemprop="keywords" content="å¾®ä¿¡å°ç¨‹åº"/> <meta itemprop="datePublished" content="2026-01-23T01:54:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="bsstar"/> <meta itemprop="url" content="https://juejin.cn/user/870468940991031"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ” æˆ‘å¼€æºäº† `miniaudit`ï¼šä¸€ä¸ªåŸºäº AST çš„å¾®ä¿¡å°ç¨‹åºå®¡æ ¸é¢„æ£€ CLIï¼Œç”¨é™æ€åˆ†ææå‰æ‹¦æˆª 13+ é«˜é¢‘æå®¡é›·åŒº
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/870468940991031/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    bsstar
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T01:54:57.000Z" title="Fri Jan 23 2026 01:54:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>â€œåˆåŒå’å•è¢«æ‹’äº†ï¼Ÿå°±å› ä¸º <code>onLoad</code> é‡Œè°ƒäº†ä¸ª <code>wx.getUserProfile</code>ï¼Ÿâ€</p>
</blockquote>
<p>ä½œä¸ºé•¿æœŸç»´æŠ¤å°ç¨‹åºçš„å¼€å‘è€…ï¼Œæˆ‘æ·±çŸ¥å¾®ä¿¡å®¡æ ¸è§„åˆ™çš„â€œæ¨¡ç³Šæ€§â€å’Œâ€œæ»åæ€§â€ã€‚äººå·¥æ’æŸ¥æˆæœ¬é«˜ã€æ˜“é—æ¼ï¼Œè€Œå®˜æ–¹åˆä¸æä¾›æœ¬åœ°æ ¡éªŒå·¥å…·ã€‚</p>
<p>äºæ˜¯ï¼Œæˆ‘ç”¨ <strong>Node.js + Babel Parserï¼ˆASTï¼‰+ é™æ€åˆ†æ</strong>ï¼Œæ‰“é€ äº† <strong><code>miniaudit</code></strong> â€”â€” ä¸€ä¸ªä¸“ä¸ºå°ç¨‹åºæå®¡è®¾è®¡çš„<strong>æœ¬åœ°é¢„æ£€ CLI å·¥å…·</strong>ã€‚</p>
<h3 data-id="heading-0">ğŸ§  æŠ€æœ¯äº®ç‚¹</h3>
<ul>
<li><strong>ç²¾å‡† AST åˆ†æ</strong>ï¼šä¸åªæ˜¯å­—ç¬¦ä¸²åŒ¹é…ï¼<br/>
èƒ½è¯†åˆ« <code>onLaunch</code>/<code>onLoad</code>/<code>onShow</code> ä¸­çš„å‡½æ•°è°ƒç”¨é“¾ï¼Œé¿å…è¯¯æŠ¥</li>
<li><strong>å¤šæ–‡ä»¶ååŒæ£€æµ‹</strong>ï¼š<br/>
ç»“åˆ <code>app.json</code>ï¼ˆæƒé™å£°æ˜ï¼‰ã€WXMLï¼ˆé»˜è®¤å‹¾é€‰ï¼‰ã€JSï¼ˆAPI è°ƒç”¨ï¼‰ç»¼åˆåˆ¤æ–­</li>
<li><strong>é›¶ä¾èµ–ã€é«˜æ€§èƒ½</strong>ï¼š<br/>
10,000 è¡Œä»£ç  &lt; 2 ç§’ï¼Œä¸æ±¡æŸ“é¡¹ç›®ä¾èµ–</li>
<li><strong>CI/CD å‹å¥½</strong>ï¼š<br/>
æ”¯æŒ <code>--format json</code>ï¼Œè½»æ¾é›†æˆåˆ° GitHub Actions</li>
</ul>
<h3 data-id="heading-1">ğŸ› ï¸ æ ¸å¿ƒè§„åˆ™ç¤ºä¾‹ï¼ˆR12ï¼šè¿›å…¥å³æˆæƒï¼‰</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// lib/rules/rule12-immediate-auth-on-launch.js</span>
<span class="hljs-keyword">const</span> traverse = <span class="hljs-built_in">require</span>(<span class="hljs-string">'@babel/traverse'</span>).<span class="hljs-property">default</span>;

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
    <span class="hljs-attr">id</span>: <span class="hljs-string">'R12'</span>,
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">check</span>(<span class="hljs-params">{ jsFiles, parseJS }</span>) {
        <span class="hljs-keyword">const</span> sensitiveApis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-string">'login'</span>, <span class="hljs-string">'getUserProfile'</span>, <span class="hljs-string">'getPhoneNumber'</span>]);
        <span class="hljs-keyword">const</span> entryMethods = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-string">'onLaunch'</span>, <span class="hljs-string">'onLoad'</span>, <span class="hljs-string">'onShow'</span>]);

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> file <span class="hljs-keyword">of</span> jsFiles) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">const</span> ast = <span class="hljs-title function_">parseJS</span>(file);
                <span class="hljs-keyword">let</span> found = <span class="hljs-literal">null</span>;

                <span class="hljs-comment">// éå†æ‰€æœ‰ CallExpressionï¼Œæ‰¾ App æˆ– Page</span>
                <span class="hljs-title function_">traverse</span>(ast, {
                    <span class="hljs-title class_">CallExpression</span>(path) {
                        <span class="hljs-keyword">if</span> (found) <span class="hljs-keyword">return</span>; <span class="hljs-comment">// å·²æ‰¾åˆ°ï¼Œæå‰é€€å‡º</span>

                        <span class="hljs-keyword">const</span> callee = path.<span class="hljs-title function_">get</span>(<span class="hljs-string">'callee'</span>);
                        <span class="hljs-keyword">let</span> targetName = <span class="hljs-literal">null</span>;

                        <span class="hljs-keyword">if</span> (callee.<span class="hljs-title function_">isIdentifier</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'App'</span> })) {
                            targetName = <span class="hljs-string">'App'</span>;
                        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (callee.<span class="hljs-title function_">isIdentifier</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'Page'</span> })) {
                            targetName = <span class="hljs-string">'Page'</span>;
                        }

                        <span class="hljs-keyword">if</span> (targetName) {

                            <span class="hljs-keyword">if</span> (path.<span class="hljs-property">node</span>.<span class="hljs-property">arguments</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
                                <span class="hljs-keyword">return</span>;
                            }

                            <span class="hljs-keyword">const</span> configArg = path.<span class="hljs-title function_">get</span>(<span class="hljs-string">'arguments'</span>)[<span class="hljs-number">0</span>];
                            <span class="hljs-keyword">if</span> (!configArg.<span class="hljs-title function_">isObjectExpression</span>()) {
                                <span class="hljs-keyword">return</span>;
                            }

                            <span class="hljs-keyword">const</span> props = configArg.<span class="hljs-title function_">get</span>(<span class="hljs-string">'properties'</span>);

                            <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(props)) {
                                <span class="hljs-keyword">return</span>;
                            }

                            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> propPath <span class="hljs-keyword">of</span> props) {
                                <span class="hljs-keyword">let</span> methodName = <span class="hljs-string">''</span>;
                                <span class="hljs-keyword">let</span> valuePath = <span class="hljs-literal">null</span>;

                                <span class="hljs-comment">// âœ… æ”¯æŒ ObjectMethod (onLaunch() {})</span>
                                <span class="hljs-keyword">if</span> (propPath.<span class="hljs-title function_">isObjectMethod</span>()) {
                                    <span class="hljs-keyword">const</span> keyNode = propPath.<span class="hljs-property">node</span>.<span class="hljs-property">key</span>;
                                    <span class="hljs-keyword">if</span> (keyNode.<span class="hljs-property">type</span> === <span class="hljs-string">'Identifier'</span>) {
                                        methodName = keyNode.<span class="hljs-property">name</span>;
                                    } <span class="hljs-keyword">else</span> {
                                        <span class="hljs-keyword">continue</span>;
                                    }
                                    valuePath = propPath.<span class="hljs-title function_">get</span>(<span class="hljs-string">'body'</span>); <span class="hljs-comment">// ObjectMethod çš„å‡½æ•°ä½“</span>

                                    <span class="hljs-comment">// âœ… æ”¯æŒ ObjectProperty (onLaunch: function() {})</span>
                                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (propPath.<span class="hljs-title function_">isObjectProperty</span>()) {
                                    <span class="hljs-keyword">const</span> keyNode = propPath.<span class="hljs-property">node</span>.<span class="hljs-property">key</span>;
                                    <span class="hljs-keyword">if</span> (keyNode.<span class="hljs-property">type</span> === <span class="hljs-string">'Identifier'</span>) {
                                        methodName = keyNode.<span class="hljs-property">name</span>;
                                    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (keyNode.<span class="hljs-property">type</span> === <span class="hljs-string">'StringLiteral'</span>) {
                                        methodName = keyNode.<span class="hljs-property">value</span>;
                                    } <span class="hljs-keyword">else</span> {
                                        <span class="hljs-keyword">continue</span>;
                                    }
                                    valuePath = propPath.<span class="hljs-title function_">get</span>(<span class="hljs-string">'value'</span>);

                                } <span class="hljs-keyword">else</span> {
                                    <span class="hljs-keyword">continue</span>;
                                }

                                <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æ˜¯å…¥å£æ–¹æ³•</span>
                                <span class="hljs-keyword">if</span> (!entryMethods.<span class="hljs-title function_">has</span>(methodName)) {
                                    <span class="hljs-keyword">continue</span>;
                                }

                                <span class="hljs-comment">// ç¡®ä¿ value æ˜¯å‡½æ•°ä½“ï¼ˆObjectMethod çš„ body æ˜¯ BlockStatementï¼‰</span>
                                <span class="hljs-keyword">if</span> (!valuePath || !valuePath.<span class="hljs-property">isBlockStatement</span> &amp;&amp; !valuePath.<span class="hljs-title function_">isFunction</span>()) {
                                    <span class="hljs-keyword">continue</span>;
                                }


                                <span class="hljs-comment">// åœ¨å‡½æ•°ä½“å†…æŸ¥æ‰¾ wx. æ•æ„Ÿè°ƒç”¨</span>
                                valuePath.<span class="hljs-title function_">traverse</span>({
                                    <span class="hljs-title class_">CallExpression</span>(innerPath) {
                                        <span class="hljs-keyword">if</span> (found) <span class="hljs-keyword">return</span>;

                                        <span class="hljs-keyword">const</span> innerCallee = innerPath.<span class="hljs-title function_">get</span>(<span class="hljs-string">'callee'</span>);
                                        <span class="hljs-keyword">if</span> (
                                            innerCallee.<span class="hljs-title function_">isMemberExpression</span>() &amp;&amp;
                                            innerCallee.<span class="hljs-title function_">get</span>(<span class="hljs-string">'object'</span>).<span class="hljs-title function_">isIdentifier</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'wx'</span> }) &amp;&amp;
                                            innerCallee.<span class="hljs-title function_">get</span>(<span class="hljs-string">'property'</span>).<span class="hljs-title function_">isIdentifier</span>()
                                        ) {
                                            <span class="hljs-keyword">const</span> apiName = innerCallee.<span class="hljs-property">node</span>.<span class="hljs-property">property</span>.<span class="hljs-property">name</span>;

                                            <span class="hljs-keyword">if</span> (sensitiveApis.<span class="hljs-title function_">has</span>(apiName)) {
                                                found = {
                                                    file,
                                                    <span class="hljs-attr">line</span>: innerPath.<span class="hljs-property">node</span>.<span class="hljs-property">loc</span>?.<span class="hljs-property">start</span>.<span class="hljs-property">line</span> || <span class="hljs-string">'?'</span>,
                                                    <span class="hljs-attr">api</span>: apiName,
                                                    <span class="hljs-attr">method</span>: methodName
                                                };
                                                innerPath.<span class="hljs-title function_">stop</span>();
                                            } <span class="hljs-keyword">else</span> {
                                            }
                                        }
                                    }
                                });
                            }
                        }
                    }
                });

                <span class="hljs-keyword">if</span> (found) {

                    <span class="hljs-keyword">return</span> {
                        <span class="hljs-attr">level</span>: <span class="hljs-string">'error'</span>,
                        <span class="hljs-attr">message</span>: <span class="hljs-string">`åœ¨ <span class="hljs-subst">${found.method}</span> ä¸­ç«‹å³è°ƒç”¨ wx.<span class="hljs-subst">${found.api}</span>ï¼ˆæœªå…ˆæä¾›åŠŸèƒ½ä½“éªŒï¼‰`</span>,
                        <span class="hljs-attr">location</span>: <span class="hljs-string">`<span class="hljs-subst">${found.file}</span>:<span class="hljs-subst">${found.line}</span>`</span>,
                        <span class="hljs-attr">suggestion</span>: <span class="hljs-string">'è¯·å…ˆè®©ç”¨æˆ·æµè§ˆ/ä½¿ç”¨æ ¸å¿ƒåŠŸèƒ½ï¼Œå†åœ¨ç”¨æˆ·ä¸»åŠ¨æ“ä½œæ—¶è¯·æ±‚æˆæƒ'</span>
                    };
                } <span class="hljs-keyword">else</span> {
                }
            } <span class="hljs-keyword">catch</span> (e) {
            }
        }

        <span class="hljs-keyword">return</span> { <span class="hljs-attr">level</span>: <span class="hljs-string">'pass'</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">'æœªå‘ç°å¯åŠ¨æ—¶ç«‹å³æˆæƒ'</span> };
    }
};
</code></pre>
<pre><code class="hljs language-bash" lang="bash">
<span class="hljs-comment">### â–¶ï¸ å¿«é€Ÿä½“éªŒ</span>
```bash
npx miniaudit ./my-miniprogram --fix
</code></pre>
<ul>
<li>è‡ªåŠ¨æ³¨é‡Š <code>console.log</code> / <code>debugger</code></li>
<li>è¾“å‡ºå½©è‰²æŠ¥å‘Šï¼Œé«˜å±é¡¹æ ‡çº¢</li>
</ul>
<h3 data-id="heading-2">ğŸ¤– CI é›†æˆç¤ºä¾‹ï¼ˆGitHub Actionsï¼‰</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">miniaudit</span>
  <span class="hljs-attr">run:</span> <span class="hljs-string">npx</span> <span class="hljs-string">miniaudit</span> <span class="hljs-string">.</span>
  <span class="hljs-comment"># è‹¥å‘ç°é«˜å±é—®é¢˜ï¼Œexit code â‰  0ï¼Œè‡ªåŠ¨é˜»æ–­åˆå¹¶</span>
</code></pre>
<h3 data-id="heading-3">ğŸŒˆ å¼€æºå…±å»º</h3>
<ul>
<li>GitHubï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fbsstar%2Fminiaudit" target="_blank" title="https://github.com/bsstar/miniaudit" ref="nofollow noopener noreferrer">github.com/bsstar/miniâ€¦</a></li>
<li>Gitee: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fbsstar2000%2Fminiaudit" target="_blank" title="https://gitee.com/bsstar2000/miniaudit" ref="nofollow noopener noreferrer">gitee.com/bsstar2000/â€¦</a></li>
<li>è§„åˆ™å¯æ’æ‹”ï¼šåªéœ€åœ¨ <code>lib/rules/</code> æ–°å¢ JS æ–‡ä»¶å³å¯æ‰©å±•</li>
</ul>
<blockquote>
<p>ğŸ’¬ å¦‚æœä½ æœ‰æ›´å¤šå®¡æ ¸é›·åŒºç»éªŒï¼Œæ¬¢è¿ PR æ–°è§„åˆ™ï¼è®©ç¤¾åŒºä¸€èµ·å‘Šåˆ«â€œæå®¡ç„¦è™‘â€ã€‚</p>
</blockquote>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Cowork å¾ˆé¦™å´ç”¨ä¸äº†ï¼Ÿè¯•è¯•è¿™ä¸ªå¼€æºå¹³æ›¿ï¼]]></title>    <link>https://juejin.cn/post/7598029481509077011</link>    <guid>https://juejin.cn/post/7598029481509077011</guid>    <pubDate>2026-01-23T02:10:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598029481509077011" data-draft-id="7598024433911808054" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Cowork å¾ˆé¦™å´ç”¨ä¸äº†ï¼Ÿè¯•è¯•è¿™ä¸ªå¼€æºå¹³æ›¿ï¼"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,Claude"/> <meta itemprop="datePublished" content="2026-01-23T02:10:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é£å“¥æ•°æ™ºè°ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/3825956195409223"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Cowork å¾ˆé¦™å´ç”¨ä¸äº†ï¼Ÿè¯•è¯•è¿™ä¸ªå¼€æºå¹³æ›¿ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3825956195409223/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é£å“¥æ•°æ™ºè°ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T02:10:52.000Z" title="Fri Jan 23 2026 02:10:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å‰å‡ å¤©å¤§å®¶éƒ½åœ¨è®¨è®º <code>Cowork</code>ï¼Œç”±äº <code>Win</code> ç‰ˆå°šæœªå‡ºæ¥ï¼Œæˆ‘è¿˜æ²¡äº²è‡ªä¸Šæ‰‹è¯•è¯•ï¼Œä½†æ˜¯ä¸å¦¨ç¢æˆ‘ä»¬èŠèŠè¿™ä¸ªç°è±¡çº§çš„äº§å“ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ec07c2f973e147f4a2e6df9c80f7257a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769739055&amp;x-signature=UgLR%2BGwI%2FnorYydkx4Ev2UeDv6o%3D" alt="" loading="lazy"/></p>
<p>è¿™ä¸ªäº§å“çš„è¯ç”Ÿæœ¬èº«å°±æå…·ä¼ å¥‡æ€§ã€‚</p>
<p>â€œ<strong>The entire product was built in 10 days. And all the code was written by Claude itself.</strong>â€</p>
<p>â€œæ•´ä¸ªäº§å“åœ¨ 10 å¤©å†…å»ºæˆã€‚è€Œä¸”æ‰€æœ‰ä»£ç éƒ½æ˜¯ç”± <code>Claude</code> è‡ªå·±ç¼–å†™çš„ã€‚â€</p>
<p>è¿™å†æ¬¡è¯æ˜äº†ç¼–ç¨‹èŒƒå¼çš„è½¬å˜ã€‚</p>
<ul>
<li>å¼€å‘æ¨¡å¼ä»çº¿æ€§åˆ°å¹¶è¡Œï¼šä»¥å‰å¾—ä¸€æ­¥æ­¥æ¥ï¼Œå†™å®Œä¸€ä¸ªæ¨¡å—æ‰èƒ½å¼€å§‹ä¸‹ä¸€ä¸ªï¼›ç°åœ¨æœ‰äº† AIï¼Œå¤šä¸ªåŠŸèƒ½å¯ä»¥å¹¶è¡Œæ¨è¿›ï¼Œæ•ˆç‡ç›´æ¥æ‹‰æ»¡ã€‚</li>
<li>äººæ‰ä»ç¼–ç è€…åˆ°æ¶æ„å¸ˆï¼šå†™ä»£ç ä¸å†æ˜¯æ ¸å¿ƒç«äº‰åŠ›ï¼ŒçœŸæ­£å€¼é’±çš„æ˜¯èƒ½æ¸…æ™°å®šä¹‰é—®é¢˜ã€è®¾è®¡ç³»ç»Ÿï¼Œå¹¶å¼•å¯¼ AI é«˜æ•ˆåä½œã€‚</li>
<li>ä¼ä¸šç»„ç»‡ä»å¤§å‹å›¢é˜Ÿåˆ°å°å‹å›¢é˜Ÿï¼šè¿‡å»è¦å‡ åäººçš„é¡¹ç›®ç»„ï¼Œç°åœ¨ä¸‰äº”ä¸ªäººé…ä¸Šåˆé€‚çš„ AI å·¥å…·ï¼Œå¾ˆå¿«å°±èƒ½è§åˆ°æˆæ•ˆã€‚</li>
</ul>
<p>æˆ‘ä»¬å›¢é˜Ÿå¾ˆæ—©å°±å¼€å§‹ç”¨ AI ç¼–ç¨‹äº†ï¼Œè™½ç„¶ç›®å‰è¿˜è¾¾ä¸åˆ°ä»–ä»¬è¿™ä¹ˆç¦»è°±çš„ç¨‹åº¦ï¼Œä½†æ•ˆç‡æå‡å·²ç»éå¸¸æ˜æ˜¾äº†ã€‚</p>
<p>ä½ ç¡®å®šè¿˜ä¸è¯•è¯•å—ï¼Ÿ</p>
<p>å› ä¸ºå„ç§åŸå› ï¼Œç›®å‰ <code>Claude Cowork</code> ä½¿ç”¨è¿˜ä¸æ˜¯é‚£ä¹ˆæ–¹ä¾¿ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c12f9747d5e14d8a800a4a361044324f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769739055&amp;x-signature=WWuqcsOgCRbWyQZe0vuz5RWXBAw%3D" alt="" loading="lazy"/></p>
<p>å› æ­¤æˆ‘å°±æ‰¾äº†ä¸‹æ˜¯å¦æœ‰å¼€æºæ›¿ä»£æ–¹æ¡ˆã€‚</p>
<p>æœç„¶ï¼Œå¼€æºç¤¾åŒºåˆä¸€æ¬¡ç»™å‡ºäº†æˆ‘æƒ³è¦çš„ã€‚</p>
<p>1æœˆ12æ—¥ <code>Claude</code> å‘å¸ƒ <code>Cowork</code>ï¼Œ1æœˆ13æ—¥ï¼Œ<code>OpenCowork</code> å»ºåº“ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FOpenCoworkAI%2Fopen-cowork%25E3%2580%2582" target="_blank" title="https://github.com/OpenCoworkAI/open-cowork%E3%80%82" ref="nofollow noopener noreferrer">github.com/OpenCoworkAâ€¦</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9ab8765ec694e53aba6ae88d7e5c395~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOe5ZOl5pWw5pm66LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769739055&amp;x-signature=5fsJwbTaJnu8TWEpOAdKLbSJ6jU%3D" alt="" loading="lazy"/></p>
<p>åªæ˜¯æˆ‘å‘ç°çš„æœ‰äº›æ™šäº†ï¼Œè¿˜æ²¡æ¥å¾—åŠå°è¯•ï¼Œè¿™ä¸¤å¤©å°è¯•ä¸‹å†ç»§ç»­åˆ†äº«å“ˆ~</p>
<p>å¦‚æœä½ ç­‰ä¸åŠï¼Œä¹Ÿå¯ä»¥è‡ªè¡Œå°è¯•å“ˆï¼Œä¸è¿‡ï¼Œä¸€å®šæ³¨æ„ä¿æŠ¤æ•°æ®ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å®¶äººä»¬è°æ‡‚å•Šï¼ŒOpenChatçŸ¥è¯†åº“å¤ªå¥½ç”¨äº†ï¼]]></title>    <link>https://juejin.cn/post/7598043378018336777</link>    <guid>https://juejin.cn/post/7598043378018336777</guid>    <pubDate>2026-01-23T01:57:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598043378018336777" data-draft-id="7598071804970090534" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å®¶äººä»¬è°æ‡‚å•Šï¼ŒOpenChatçŸ¥è¯†åº“å¤ªå¥½ç”¨äº†ï¼"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2026-01-23T01:57:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LiDayDay"/> <meta itemprop="url" content="https://juejin.cn/user/4464446331950568"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å®¶äººä»¬è°æ‡‚å•Šï¼ŒOpenChatçŸ¥è¯†åº“å¤ªå¥½ç”¨äº†ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4464446331950568/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LiDayDay
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T01:57:15.000Z" title="Fri Jan 23 2026 01:57:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>å†™åœ¨å‰é¢ï¼š</strong></p>
<p>ğŸŸ¡ å¿«é€Ÿä½“éªŒ &amp; é¡¹ç›®åé¦ˆ
æ¬¢è¿å¤§å®¶ä¸‹è½½å¹¶ä½“éªŒæˆ‘ä»¬æœ€æ–°ç‰ˆæœ¬çš„ OpenChatï¼Œäº²è‡ªæ„Ÿå—æœ¬åœ°å¤šæ¨¡å‹è°ƒåº¦ä¸æ™ºèƒ½åŠ©æ‰‹èåˆçš„å¼ºå¤§èƒ½åŠ›ã€‚</p>
<p>ğŸŒ <strong>å®˜æ–¹ä¸»é¡µ</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ffastaistack.github.io%2FOpenChat%2F" target="_blank" title="https://fastaistack.github.io/OpenChat/" ref="nofollow noopener noreferrer">æ¬¢è¿è®¿é—® OpenChat å®˜æ–¹ç½‘ç«™ï¼Œäº†è§£æ›´å¤šå…³äºæˆ‘ä»¬çš„å›¢é˜Ÿæ„¿æ™¯ã€äº§å“åŠ¨æ€ä¸æœ€æ–°å…¬å‘Š</a></p>
<p>ğŸ§© <strong>é¡¹ç›®åœ°å€</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffastaistack%2FOpenChat" target="_blank" title="https://github.com/fastaistack/OpenChat" ref="nofollow noopener noreferrer">è®¿é—® OpenChat github ä¸»é¡µ</a>  |  <a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Ffastaistack%2Fopenchat" target="_blank" title="https://gitee.com/fastaistack/openchat" ref="nofollow noopener noreferrer">è®¿é—® OpenChat gitee ä¸»é¡µ</a></p>
<p>ğŸ”— <strong>ä¸‹è½½åº”ç”¨</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ffastaistack.github.io%2FOpenChat%2F" target="_blank" title="https://fastaistack.github.io/OpenChat/" ref="nofollow noopener noreferrer">ç‚¹å‡»ä¸‹è½½OpenChatæœ€æ–°ç‰ˆæœ¬</a></p>
<p>æˆ‘ä»¬éå¸¸æœŸå¾…æ‚¨çš„å®è´µåé¦ˆï¼Œæ— è®ºæ˜¯åŠŸèƒ½å»ºè®®ã€ä½¿ç”¨ä½“éªŒï¼Œè¿˜æ˜¯ Bug æŠ¥å‘Šï¼Œéƒ½å°†æ˜¯æˆ‘ä»¬æŒç»­ä¼˜åŒ–çš„é‡è¦åŠ¨åŠ›ã€‚ä¸‹é¢æˆ‘å°†ä»‹ç»OpenChatä¸DeepSeek-OCRé›†æˆåå…·ä½“çš„ä½¿ç”¨æ–¹å¼ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€ä»â€œæ–‡æ¡£æœºå™¨äººâ€åˆ°â€œå¯¹è¯ä¼™ä¼´â€</h2>
<p>æ˜¨å¤©æˆ‘è¿˜åœ¨æŠ±æ€¨ï¼šâ€œä¸ºä»€ä¹ˆæˆ‘çš„RAGç³»ç»Ÿè¿ä¸ªç®€å•é—®é¢˜éƒ½ç­”ä¸å¥½ï¼Ÿâ€ä»Šå¤©ç”¨ä¸Šäº†OpenChatâ€”â€”å®¶äººä»¬ï¼Œè¿™ä½“éªŒå·®å¾—ä¸æ˜¯ä¸€ç‚¹åŠç‚¹ï¼</p>
<p>ç”¨æˆ·é—®â€œè¿™ä¸ªæ€ä¹ˆéƒ¨ç½²åˆ°K8sï¼Ÿâ€ï¼Œä¼ ç»Ÿç³»ç»Ÿè¦ä¹ˆç”©æ¥ä¸€å †ä¸ç›¸å¹²çš„YAMLç‰‡æ®µï¼Œè¦ä¹ˆç›´æ¥è¯´â€œæ–‡æ¡£ä¸­æœªæ‰¾åˆ°ç›¸å…³ä¿¡æ¯â€ã€‚è€ŒOpenChatå‘¢ï¼Ÿå®ƒåƒä¸ªæ‡‚è¡Œçš„åŒäº‹ä¸€æ ·å›ç­”ï¼š</p>
<p>â€œæ–‡æ¡£é‡Œè¯´äº†ä¸‰ç§éƒ¨ç½²æ–¹å¼ï¼Œå…¶ä¸­K8séƒ¨ç½²å»ºè®®ä½¿ç”¨Helm Chartã€‚[å¼•ç”¨æ¥æº]<br/>
è¿™æ˜¯é…ç½®ç¤ºä¾‹ï¼Œéœ€è¦æ³¨æ„å­˜å‚¨å·çš„æŒä¹…åŒ–è®¾ç½®ã€‚[å¼•ç”¨æ¥æº]<br/>
å¦‚æœåœ¨å†…ç½‘ç¯å¢ƒï¼Œè¿˜éœ€è¦ä¿®æ”¹é•œåƒæ‹‰å–ç­–ç•¥ã€‚[å¼•ç”¨æ¥æº]â€</p>
<p><strong>è°æ‡‚å•Šï¼</strong> å®ƒçœŸçš„è¯»æ‡‚äº†â€œäººè¯â€èƒŒåçš„æŠ€æœ¯é—®é¢˜ã€‚</p>
<h2 data-id="heading-1">äºŒã€OpenChatçš„â€œè¯»å¿ƒæœ¯â€æ˜¯æ€ä¹ˆç‚¼æˆçš„ï¼Ÿ</h2>
<h3 data-id="heading-2">1. å®ƒçŸ¥é“ä½ ä¸ä¼šæŒ‰â€œç« èŠ‚æ ‡é¢˜â€æé—®</h3>
<p>ä¼ ç»ŸRAGç­‰ç€ä½ é—®â€œè¯·æŸ¥é˜…ç¬¬3.2èŠ‚â€ï¼Œä½†ç°å®æ˜¯ï¼Œä½ åªä¼šé—®ï¼š</p>
<p>â€œèƒ½ä¸èƒ½æ”¹ç«¯å£ï¼Ÿâ€<br/>
â€œä¼šä¸ä¼šå¾ˆæ…¢ï¼Ÿâ€<br/>
â€œå®‰ä¸å®‰å…¨ï¼Ÿâ€</p>
<p>OpenChatèƒŒåæ˜¯<strong>ç»“æ„æ„ŸçŸ¥+å¤šè¡¨ç¤ºæ£€ç´¢</strong>çš„é»‘ç§‘æŠ€ï¼š</p>
<ul>
<li>æ–‡æ¡£è¢«æ™ºèƒ½â€œè§£å‰–â€ï¼Œä¸æ˜¯æš´åŠ›åˆ‡å—</li>
<li>æ¯ä¸ªç‰‡æ®µéƒ½æœ‰â€œæŠ€æœ¯é¢å­”â€å’Œâ€œäººè¯é¢å­”â€</li>
<li>ä½ çš„â€œäººè¯â€èƒ½ç²¾å‡†æ‰¾åˆ°â€œæŠ€æœ¯ç»†èŠ‚â€</li>
</ul>
<h3 data-id="heading-3">2. å®ƒç†è§£ä½ çš„çœŸå®ä½¿ç”¨åœºæ™¯</h3>
<p>å½“ä½ è¯´ï¼šâ€œæˆ‘æƒ³åœ¨Windowsä¸Šè·‘ä¸€ä¸‹è¯•è¯•â€ï¼Œä¼ ç»ŸRAGå¯èƒ½åªä¼šæ£€ç´¢â€œWindowsâ€å…³é”®è¯ï¼Œè¿”å›ä¸€å †æ— å…³ä¿¡æ¯ã€‚</p>
<p>è€ŒOpenChatåšäº†ä»€ä¹ˆï¼Ÿ</p>
<pre><code class="hljs language-markdown" lang="markdown">ä½ çš„é—®é¢˜ â†’ æ”¹å†™ä¸ºå¤šä¸ªæ£€ç´¢ç‚¹ï¼š
<span class="hljs-bullet">1.</span> ç³»ç»Ÿè¿è¡Œç¯å¢ƒè¦æ±‚
<span class="hljs-bullet">2.</span> Windowså…¼å®¹æ€§è¯´æ˜  
<span class="hljs-bullet">3.</span> å¿«é€Ÿè¯•ç”¨æ­¥éª¤
<span class="hljs-bullet">4.</span> å¸¸è§é—®é¢˜è§£ç­”
</code></pre>
<p>ç„¶åä»æ–‡æ¡£çš„<strong>åŒé‡è¡¨ç¤º</strong>ä¸­ç²¾å‡†æå‡ºï¼š</p>
<ul>
<li>æ‘˜è¦å±‚ï¼šâ€œä¸»è¦æ”¯æŒLinuxï¼ŒWindowséœ€WSLâ€</li>
<li>åŸæ–‡å±‚ï¼šâ€œåœ¨Windows 10åŠä»¥ä¸Šç‰ˆæœ¬å¯é€šè¿‡WSL 2.0è¿è¡Œ...â€</li>
</ul>
<p><strong>å®¶äººä»¬ï¼Œè¿™ç§â€œæ‡‚ä½ â€çš„æ„Ÿè§‰ï¼ŒçœŸçš„ç»äº†ï¼</strong></p>
<h2 data-id="heading-4">ä¸‰ã€çœŸå®å¯¹æ¯”ï¼šOpenChat vs ä¼ ç»ŸRAG</h2>

























<table><thead><tr><th>ä½ çš„æé—®</th><th>ä¼ ç»ŸRAGçš„ååº”</th><th>OpenChatçš„å›åº”</th></tr></thead><tbody><tr><td>â€œå¯åŠ¨æŠ¥é”™æ€ä¹ˆåŠï¼Ÿâ€</td><td>è¿”å›æ‰€æœ‰åŒ…å«â€œé”™è¯¯â€çš„ç‰‡æ®µï¼Œä¸ç®¡ç›¸å…³æ€§</td><td>â€œæ–‡æ¡£åˆ—å‡ºäº†ä¸‰ç§å¸¸è§å¯åŠ¨é”™è¯¯åŠè§£å†³æ–¹æ¡ˆï¼š[å¼•ç”¨1][å¼•ç”¨2]ï¼Œä½ å…ˆçœ‹çœ‹æ˜¯ä¸æ˜¯ç«¯å£è¢«å ç”¨äº†ï¼Ÿâ€</td></tr><tr><td>â€œæ”¯ä¸æ”¯æŒé›†ç¾¤ï¼Ÿâ€</td><td>å¯èƒ½æ¼æ‰ï¼Œå› ä¸ºæ–‡æ¡£é‡Œå†™çš„æ˜¯â€œé«˜å¯ç”¨éƒ¨ç½²â€</td><td>â€œæ”¯æŒï¼Œæ–‡æ¡£çš„é«˜å¯ç”¨ç« èŠ‚æåˆ°å¯ä»¥é€šè¿‡å¤šå®ä¾‹+è´Ÿè½½å‡è¡¡å®ç°ã€‚[å¼•ç”¨]ä½†éœ€è¦æ³¨æ„å…±äº«å­˜å‚¨é…ç½®ã€‚â€</td></tr><tr><td>â€œé…ç½®å¤ä¸å¤æ‚ï¼Ÿâ€</td><td>æ— æ³•å›ç­”ï¼Œæ–‡æ¡£æ²¡æœ‰ç›´æ¥è¯´â€œå¤æ‚â€</td><td>â€œåŸºç¡€é…ç½®å¾ˆç®€å•ï¼Œ5æ­¥å®Œæˆã€‚ä½†é«˜çº§åŠŸèƒ½å¦‚è‡ªå®šä¹‰æ’ä»¶éœ€è¦é¢å¤–è®¾ç½®ã€‚[å¼•ç”¨é…ç½®ç« èŠ‚]â€</td></tr></tbody></table>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d7ef6e76e16431796c1f4f79a90a415~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTGlEYXlEYXk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769738235&amp;x-signature=lI%2BHDXSHkmhtwzYFqYtH9DjpMF4%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-5">å››ã€OpenChatçš„ä¸‰é‡â€œè´´å¿ƒâ€è®¾è®¡</h2>
<h3 data-id="heading-6">1. <strong>ä¸é—®â€œè ¢é—®é¢˜â€</strong></h3>
<p>ä¸ä¼šè®©ä½ â€œé€‰æ‹©æ–‡æ¡£â€æˆ–â€œæ˜ç¡®å…³é”®è¯â€ï¼Œå®ƒèƒ½ä»æ¨¡ç³Šæè¿°ä¸­æ•æ‰æ„å›¾ï¼š</p>
<ul>
<li>â€œè¿™ä¸ªæ€ä¹ˆç”¨ï¼Ÿâ€ â†’ è‡ªåŠ¨ç†è§£ä¸ºï¼šå®‰è£…ã€åŸºç¡€æ“ä½œã€æ ¸å¿ƒåŠŸèƒ½</li>
<li>â€œä¼šä¸ä¼šæœ‰æ€§èƒ½é—®é¢˜ï¼Ÿâ€ â†’ æ˜ å°„åˆ°ï¼šæ€§èƒ½åŸºå‡†ã€ä¼˜åŒ–å»ºè®®ã€é™åˆ¶æ¡ä»¶</li>
</ul>
<h3 data-id="heading-7">2. <strong>ä¸â€œæ­»æ¿â€å›ç­”</strong></h3>
<p>ä¸æ˜¯ç®€å•å¤åˆ¶ç²˜è´´æ–‡æ¡£ï¼Œè€Œæ˜¯<strong>è¯»å®Œæ–‡æ¡£åç”¨äººè¯å‘Šè¯‰ä½ </strong>ï¼š</p>
<pre><code class="hljs language-css" lang="css">æ–‡æ¡£åŸæ–‡ï¼šâ€œæœ€å¤§å¹¶å‘è¿æ¥æ•°é»˜è®¤è®¾ç½®ä¸º<span class="hljs-number">1000</span>ï¼Œå¯é€šè¿‡MAX_CONNECTIONå‚æ•°è°ƒæ•´ã€‚â€
OpenChatå›ç­”ï¼šâ€œé»˜è®¤æ”¯æŒ<span class="hljs-number">1000</span>å¹¶å‘ï¼Œä¸å¤Ÿçš„è¯å¯ä»¥è°ƒæ•´é…ç½®å‚æ•°ï¼Œæ–‡æ¡£é‡Œæœ‰å…·ä½“æ–¹æ³•ã€‚<span class="hljs-selector-attr">[å¼•ç”¨]</span>â€
</code></pre>
<h3 data-id="heading-8">3. <strong>ä¸ä¹±â€œç¼–é€ â€</strong></h3>
<p>çŸ¥é“ä½•æ—¶è¯´â€œä¸çŸ¥é“â€ï¼š
â€œåœ¨ç°æœ‰æ–‡æ¡£ä¸­æ²¡æ‰¾åˆ°å…³äºå¾®ä¿¡é›†æˆçš„è¯´æ˜ï¼Œå¯èƒ½æ˜¯å°šæœªæ”¯æŒçš„åŠŸèƒ½ã€‚â€</p>
<h2 data-id="heading-9">äº”ã€æŠ€æœ¯æ­ç§˜ï¼šOpenChatä¸ºä½•å¦‚æ­¤â€œå¥½æ‡‚â€</h2>
<h3 data-id="heading-10">æ ¸å¿ƒæ¶æ„ï¼šSAM-RAG</h3>
<p>OpenChaté‡‡ç”¨çš„æ˜¯<strong>ç»“æ„æ„ŸçŸ¥å¤šè¡¨ç¤ºæ£€ç´¢å¢å¼ºç”Ÿæˆ</strong>ï¼Œè¿™æ˜¯å®ƒèªæ˜çš„åº•å±‚åŸå› ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä¼ ç»ŸRAGï¼šæš´åŠ›åˆ‡å—ï¼Œä¸¢å¤±ç»“æ„</span>
æ–‡æ¡£ â†’ æ¯<span class="hljs-number">500</span>å­—ä¸€åˆ€åˆ‡ â†’ å‘é‡åŒ– â†’ æœç´¢

<span class="hljs-comment"># OpenChatï¼šå°Šé‡æ–‡æ¡£â€œæœ¬æ€§â€</span>
æ–‡æ¡£ â†’ æ™ºèƒ½ç»“æ„è§£æ â†’ åŒé‡è¡¨ç¤ºç”Ÿæˆ â†’ å…³è”ç´¢å¼•
          â†“                        â†“
      ã€æŠ€æœ¯æ–‡æ¡£æŒ‰APIç»“æ„ã€‘    ã€æ¯ä¸ªå—éƒ½æœ‰ï¼š
      ã€è®ºæ–‡æŒ‰ç« èŠ‚è§£å‰–ã€‘        <span class="hljs-number">1.</span> ç²¾ç¡®åŸæ–‡ï¼ˆæŠ€æœ¯ç»†èŠ‚ï¼‰
      ã€åˆåŒæŒ‰æ¡æ¬¾ç»„ç»‡ã€‘        <span class="hljs-number">2.</span> äººè¯æ‘˜è¦ï¼ˆæ–¹ä¾¿æ£€ç´¢ï¼‰ã€‘
</code></pre>
<h3 data-id="heading-11">ä¸¤çº§æ£€ç´¢ï¼šå…ˆâ€œç†è§£â€åâ€œå®šä½â€</h3>
<pre><code class="hljs language-vbnet" lang="vbnet">ä½ çš„é—®é¢˜ï¼šâ€œä¸Šä¼ å¤§æ–‡ä»¶å¤±è´¥æ€ä¹ˆå›äº‹ï¼Ÿâ€
          â†“
<span class="hljs-keyword">Step</span> <span class="hljs-number">1</span>: åœ¨â€œäººè¯æ‘˜è¦â€å±‚æœç´¢
         â†’ å‘½ä¸­ï¼šâ€œæ–‡ä»¶ä¸Šä¼ æ¥å£çš„é™åˆ¶å’Œå¸¸è§é—®é¢˜â€
          â†“
<span class="hljs-keyword">Step</span> <span class="hljs-number">2</span>: å…³è”åˆ°â€œç²¾ç¡®åŸæ–‡â€  
         â†’ è·å–å…·ä½“å†…å®¹ï¼šâ€œå•ä¸ªæ–‡ä»¶ä¸å¾—è¶…è¿‡<span class="hljs-number">100</span>MBï¼Œè¶…æ—¶è®¾ç½®ä¸º<span class="hljs-number">30</span>ç§’...â€
          â†“
<span class="hljs-keyword">Step</span> <span class="hljs-number">3</span>: LLMç”¨äººè¯ç»„ç»‡ç­”æ¡ˆ
</code></pre>
<h2 data-id="heading-12">å…­ã€å®¶äººä»¬ï¼Œè¿™äº›åœºæ™¯çœŸçš„â€œå¤ªæ‡‚æˆ‘â€</h2>
<h3 data-id="heading-13">åœºæ™¯ä¸€ï¼šæŠ€æœ¯é€‰å‹è°ƒç ”</h3>
<p><strong>ä½ é—®</strong>ï¼šâ€œè¿™ä¸ªå’ŒFastAPIæ¯”æ€ä¹ˆæ ·ï¼Ÿâ€
<strong>OpenChat</strong>ï¼šâ€œæ–‡æ¡£çš„æ€§èƒ½å¯¹æ¯”ç« èŠ‚æ˜¾ç¤ºï¼Œåœ¨QPSä½äº5000æ—¶ä¸¤è€…å·®å¼‚ä¸å¤§ï¼Œä½†æˆ‘ä»¬çš„ä¼˜åŠ¿åœ¨äºå†…ç½®äº†ç›‘æ§ä»ªè¡¨ç›˜ã€‚[å¼•ç”¨]ä¸è¿‡FastAPIçš„ç”Ÿæ€æ›´ä¸°å¯Œã€‚â€</p>
<h3 data-id="heading-14">åœºæ™¯äºŒï¼šæ•…éšœæ’æŸ¥</h3>
<p><strong>ä½ é—®</strong>ï¼šâ€œæ—¥å¿—ä¸€ç›´æŠ¥æƒé™é”™è¯¯ï¼Œæ€¥ï¼â€
<strong>OpenChat</strong>ï¼šâ€œæ ¹æ®æ–‡æ¡£çš„æ•…éšœæ’æŸ¥éƒ¨åˆ†ï¼Œæƒé™é”™è¯¯é€šå¸¸æœ‰ä¸‰ç§åŸå› ï¼š1ï¼‰æœåŠ¡è´¦æˆ·æƒé™ä¸è¶³[å¼•ç”¨1]ï¼›2ï¼‰SELinuxæœªå…³é—­[å¼•ç”¨2]ï¼›3ï¼‰æ•°æ®ç›®å½•æ‰€æœ‰è€…è®¾ç½®é”™è¯¯[å¼•ç”¨3]ã€‚å»ºè®®æŒ‰é¡ºåºæ£€æŸ¥ã€‚â€</p>
<h3 data-id="heading-15">åœºæ™¯ä¸‰ï¼šæ–¹æ¡ˆç¡®è®¤</h3>
<p><strong>ä½ é—®</strong>ï¼šâ€œæ˜¯ä¸æ˜¯å¿…é¡»ç”¨MySQLï¼Ÿâ€
<strong>OpenChat</strong>ï¼šâ€œä¸æ˜¯å¿…é¡»ã€‚æ–‡æ¡£è¯´é»˜è®¤æ”¯æŒMySQLï¼Œä½†ä¹Ÿæä¾›äº†PostgreSQLé€‚é…å™¨ã€‚[å¼•ç”¨]ä¸è¿‡MySQLçš„æ€§èƒ½ä¼˜åŒ–æ›´å……åˆ†ã€‚â€</p>
<h2 data-id="heading-16">ä¸ƒã€å¼€å§‹äº«å—ï¼šä½ ä¹Ÿèƒ½æ‹¥æœ‰çš„â€œå¥½ç”¨â€ä½“éªŒ</h2>
<p>å¦‚æœä½ ä¹Ÿæƒ³è®©æ–‡æ¡£æŸ¥è¯¢å˜å¾—â€œOpenChatçº§â€å¥½ç”¨ï¼Œè®°ä½è¿™ä¸‰ä¸ªåŸåˆ™ï¼š</p>
<ol>
<li>
<p><strong>æ”¾å¼ƒâ€œä¸€åˆ€åˆ‡â€åˆ†å—</strong><br/>
è®©æŠ€æœ¯æ–‡æ¡£ä¿æŒAPIç»“æ„ï¼Œè®©è®ºæ–‡ä¿æŒç« èŠ‚è„‰ç»œï¼Œè®©åˆåŒä¿æŒæ¡æ¬¾å±‚çº§ã€‚</p>
</li>
<li>
<p><strong>ä¸ºæ¯ä¸ªç‰‡æ®µé…â€œäººè¯ç¿»è¯‘â€</strong><br/>
ä¸åªæ˜¯å­˜åŸæ–‡ï¼Œè¿˜è¦å­˜ä¸€ä¸ªâ€œç”¨æˆ·å¯èƒ½ä¼šæ€ä¹ˆé—®åˆ°è¿™ä¸ªå†…å®¹â€çš„æ‘˜è¦ã€‚</p>
</li>
<li>
<p><strong>å»ºç«‹æŠ½è±¡ä¸å…·ä½“çš„æ¡¥æ¢</strong><br/>
ç”¨æˆ·ç”¨â€œäººè¯â€é—®ï¼Œç³»ç»Ÿé€šè¿‡â€œæ‘˜è¦â€æ‰¾ï¼Œæœ€ç»ˆç”¨â€œåŸæ–‡â€ç­”ã€‚</p>
</li>
</ol>
<h2 data-id="heading-17">å†™åœ¨æœ€åï¼šå¥½ç”¨çš„RAGï¼Œå°±è¯¥è¿™æ ·</h2>
<p>ç”¨äº†OpenChatæ‰çŸ¥é“ï¼ŒåŸæ¥RAGå¯ä»¥ä¸åªæ˜¯â€œæ–‡æ¡£æœç´¢å¼•æ“â€ï¼Œè€Œæ˜¯ä¸€ä¸ªçœŸæ­£<strong>ç†è§£å†…å®¹ã€ç†è§£é—®é¢˜ã€ç†è§£ä½ </strong>çš„å¯¹è¯ä¼™ä¼´ã€‚</p>
<p>å®ƒå¥½ç”¨çš„ç§˜å¯†å¾ˆç®€å•ï¼š<strong>å®ƒç”¨äººç±»çš„æ–¹å¼â€œé˜…è¯»â€æ–‡æ¡£ï¼Œä¹Ÿç”¨äººç±»çš„æ–¹å¼â€œå›ç­”â€é—®é¢˜</strong>ã€‚</p>
<p>æ‰€ä»¥å®¶äººä»¬ï¼Œå½“ä½ å†é‡åˆ°é‚£ç§ç­”éæ‰€é—®çš„RAGç³»ç»Ÿæ—¶ï¼Œä½ å°±çŸ¥é“é—®é¢˜åœ¨å“ªäº†â€”â€”ä¸æ˜¯æ¨¡å‹ä¸å¤Ÿå¤§ï¼Œä¸æ˜¯ç®—æ³•ä¸å¤Ÿæ–°ï¼Œè€Œæ˜¯ç³»ç»Ÿè®¾è®¡è€…å¿˜äº†æœ€é‡è¦çš„ä¸€ä»¶äº‹ï¼š</p>
<p><strong>ç”¨æˆ·è¯´çš„ï¼Œæ°¸è¿œæ˜¯äººè¯ã€‚</strong></p>
<p>è€Œä¸€ä¸ªå¥½çš„RAGç³»ç»Ÿï¼Œå°±åº”è¯¥åƒOpenChatä¸€æ ·ï¼Œå¬å¾—æ‡‚äººè¯ï¼Œè¯´å¾—å‡ºäººè¯ï¼Œè§£å†³å¾—äº†é—®é¢˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æŠ€æœ¯äººå¦‚ä½•å’ŒAIåˆ†å·¥ï¼Œå®ˆä½ä¼˜åŠ¿]]></title>    <link>https://juejin.cn/post/7598071804970467366</link>    <guid>https://juejin.cn/post/7598071804970467366</guid>    <pubDate>2026-01-23T02:21:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598071804970467366" data-draft-id="7598021984300351515" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æŠ€æœ¯äººå¦‚ä½•å’ŒAIåˆ†å·¥ï¼Œå®ˆä½ä¼˜åŠ¿"/> <meta itemprop="keywords" content="é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-23T02:21:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="moshuying"/> <meta itemprop="url" content="https://juejin.cn/user/2700056289356936"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æŠ€æœ¯äººå¦‚ä½•å’ŒAIåˆ†å·¥ï¼Œå®ˆä½ä¼˜åŠ¿
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2700056289356936/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    moshuying
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T02:21:49.000Z" title="Fri Jan 23 2026 02:21:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€é‡æ–°å®¡è§†ç„¦è™‘ï¼šå½“æŠ€æœ¯äººé­é‡â€œå…¨èƒ½å¹»è§‰â€</h2>
<p>æˆ‘ä»¬æ­£åœ¨ç»å†ä¸€æ¬¡èŒƒå¼è½¬ç§»ã€‚GPTã€Copilot ç­‰å·¥å…·çš„è¡¨ç°è®©äººéœ‡æ’¼ï¼Œä¹Ÿè®©è®¸å¤šæŠ€æœ¯äººå¼€å§‹æ‹…å¿ƒï¼šâ€œæˆ‘çš„æ ¸å¿ƒæŠ€èƒ½ä¼šè¢« AI å–ä»£å—ï¼Ÿâ€</p>
<p>è¿™ç§ç„¦è™‘å¾€å¾€æ¥è‡ªä¸€ä¸ªè¯¯è§£ï¼šæŠŠ AI çš„â€œæµç•…è¾“å‡ºâ€å½“æˆâ€œæ·±åˆ»ç†è§£â€ã€‚å®ƒåœ¨ç¼–ç ã€è®¾è®¡ã€å†™æ–‡æ¡£ä¸Šå¾ˆå¿«ï¼Œä½†å¹¶ä¸ä»£è¡¨å®ƒçœŸçš„ç†è§£ã€‚</p>
<h2 data-id="heading-1">äºŒã€æ ¸å¿ƒå·®å¼‚ï¼šç»Ÿè®¡å¼•æ“ vs. æƒ…å¢ƒæ™ºèƒ½</h2>
<h3 data-id="heading-2">2.1 AIçš„èƒ½åŠ›æœ¬è´¨ä¸è¾¹ç•Œ</h3>
<p>ä¸»æµ AI æœ¬è´¨ä¸Šæ˜¯<strong>åŸºäºç»Ÿè®¡çš„æ¨¡å¼ä¼˜åŒ–å™¨</strong>ã€‚å®ƒåœ¨è®­ç»ƒåˆ†å¸ƒå†…é‡ç»„ä¿¡æ¯ã€ç»™å‡ºæœ€â€œåƒæ ·â€çš„ç­”æ¡ˆï¼Œä¸€æ—¦è¶…å‡ºåˆ†å¸ƒå°±å¼€å§‹è·‘åã€‚ç»“æœå°±æ˜¯ï¼š</p>
<ul>
<li><strong>æ“…é•¿</strong>ï¼šæ¨¡å¼åŒ–ä»»åŠ¡ã€ä¿¡æ¯æ•´åˆã€å¿«é€Ÿç”Ÿæˆ</li>
<li><strong>ä¸æ“…é•¿</strong>ï¼šçœŸæ­£çš„æ–°é—®é¢˜ã€éœ€è¦æ·±å…¥ç†è§£çš„åœºæ™¯ã€å¤šé‡çº¦æŸä¸‹çš„æƒè¡¡</li>
</ul>
<h3 data-id="heading-3">2.2 æŠ€æœ¯äººçš„ä¸å¯æ›¿ä»£å†…æ ¸</h3>
<p>æŠ€æœ¯äººæ›´åƒæ˜¯**â€œæƒ…å¢ƒåŒ–æ™ºèƒ½ç³»ç»Ÿâ€**ï¼ŒçœŸæ­£çš„ä»·å€¼åœ¨äºï¼š</p>
<ol>
<li>
<p><strong>ä¸ç¡®å®šæ€§ä¸‹çš„ä»·å€¼åˆ¤æ–­èƒ½åŠ›</strong>
AIå¯ä»¥ç»™å‡ºé€‰é¡¹ï¼Œä½†æŠ€æœ¯å†³ç­–è¦è€ƒè™‘ï¼š</p>
<ul>
<li>é•¿æœŸç»´æŠ¤æˆæœ¬ä¸æŠ€æœ¯å€º</li>
<li>å›¢é˜Ÿèƒ½åŠ›ä¸æˆé•¿è·¯å¾„</li>
<li>ä¸šåŠ¡ç›®æ ‡çš„åŠ¨æ€å˜åŒ–</li>
<li>è·¨å›¢é˜Ÿåä½œçš„å¤æ‚æ€§</li>
</ul>
</li>
<li>
<p><strong>é—®é¢˜çš„å‘ç°ä¸å®šä¹‰èƒ½åŠ›</strong>
AIæ“…é•¿å›ç­”å·²å®šä¹‰çš„é—®é¢˜ï¼Œä½†<strong>æ‰¾å‡ºçœŸæ­£çš„é—®é¢˜</strong>æ˜¯äººçš„é•¿å¤„ï¼š</p>
<ul>
<li>ä»æ¨¡ç³Šéœ€æ±‚ä¸­æå–æŠ€æœ¯æœ¬è´¨</li>
<li>åœ¨çŸ›ç›¾çº¦æŸä¸­æ‰¾åˆ°æœ€ä¼˜è§£ç©ºé—´</li>
<li>é¢„åˆ¤æœªæ¥å¯èƒ½å‡ºç°çš„æŠ€æœ¯æŒ‘æˆ˜</li>
</ul>
</li>
<li>
<p><strong>ä»0åˆ°1çš„åŸåˆ›çªç ´</strong>
AIæ›´åƒç»„åˆåˆ›æ–°ï¼Œè€Œäººå¯ä»¥ï¼š</p>
<ul>
<li>åŸºäºç¬¬ä¸€æ€§åŸç†é‡æ–°æ€è€ƒæ¶æ„</li>
<li>åˆ›é€ å…¨æ–°çš„æŠ€æœ¯èŒƒå¼</li>
<li>è¿æ¥çœ‹ä¼¼æ— å…³çš„é¢†åŸŸå®ç°çªç ´</li>
</ul>
</li>
</ol>
<h2 data-id="heading-4">ä¸‰ã€æ¸…æ™°è¾¹ç•Œï¼šäººæœºåˆ†å·¥çš„åœ°å›¾</h2>
<h3 data-id="heading-5">3.1 è®©AIæœ€å¤§åŒ–ä»·å€¼çš„é¢†åŸŸ</h3>






























<table><thead><tr><th>åœºæ™¯</th><th>AIä¼˜åŠ¿</th><th>åº”ç”¨ç¤ºä¾‹</th></tr></thead><tbody><tr><td>ä¿¡æ¯å¤„ç†</td><td>å¿«é€Ÿæ£€ç´¢ã€æ•´ç†ã€æ‘˜è¦</td><td>æŠ€æœ¯è°ƒç ”ã€æ–‡æ¡£æ‘˜è¦</td></tr><tr><td>æ¨¡å¼åŒ–ç¼–ç </td><td>æ¨¡æ¿ä»£ç ç”Ÿæˆã€å•å…ƒæµ‹è¯•</td><td>é‡å¤æ€§åŠŸèƒ½å®ç°</td></tr><tr><td>æ–¹æ¡ˆè‰æ‹Ÿ</td><td>åŸºäºç°æœ‰æ¨¡å¼ç”Ÿæˆåˆç¨¿</td><td>ç³»ç»Ÿè®¾è®¡é›å½¢ã€APIè‰æ¡ˆ</td></tr><tr><td>çŸ¥è¯†ç®¡ç†</td><td>ç»“æ„åŒ–æ•´ç†å›¢é˜ŸçŸ¥è¯†</td><td>çŸ¥è¯†åº“æ„å»ºã€FAQæ•´ç†</td></tr></tbody></table>
<h3 data-id="heading-6">3.2 äººç±»æŠ€æœ¯ä¸“å®¶çš„æŠ¤åŸæ²³</h3>






























<table><thead><tr><th>èƒ½åŠ›ç»´åº¦</th><th>ä¸ºä½•éš¾ä»¥æ›¿ä»£</th><th>å®é™…ä»·å€¼</th></tr></thead><tbody><tr><td>å¤æ‚ç³»ç»Ÿæƒè¡¡</td><td>æ¶‰åŠæŠ€æœ¯ã€äººã€ä¸šåŠ¡çš„å¤šå…ƒä¼˜åŒ–</td><td>æ¶æ„å†³ç­–ã€æŠ€æœ¯é€‰å‹</td></tr><tr><td>åˆ›æ–°èƒ½åŠ›</td><td>è·³å‡ºæ¡†æ¶çš„æ ¹æœ¬æ€§æ€è€ƒ</td><td>è§£å†³å…¨æ–°ç±»å‹é—®é¢˜</td></tr><tr><td>åä½œé¢†å¯¼</td><td>ç†è§£åŠ¨æœºã€æ¿€å‘å›¢é˜Ÿæ½œèƒ½</td><td>æŠ€æœ¯è§„åˆ’ã€å›¢é˜Ÿå»ºè®¾</td></tr><tr><td>å±æœºå¤„ç†</td><td>ä¿¡æ¯ä¸å…¨æ—¶çš„å¿«é€Ÿå†³ç­–</td><td>ç”Ÿäº§æ•…éšœæ’æŸ¥ã€ç´§æ€¥æ”»å…³</td></tr></tbody></table>
<h2 data-id="heading-7">å››ã€å®ç”¨åä½œæ¡†æ¶ï¼šæŠ€æœ¯äººçš„AIå¢å¼ºç­–ç•¥</h2>
<h3 data-id="heading-8">4.1 æ„å»ºâ€œäººæœºåä½œâ€å·¥ä½œæµ</h3>
<p>å¯ä»¥è¿™æ ·åµŒå…¥ AIï¼š</p>
<ol>
<li>å…ˆç”¨ AI å‘æ•£æ–¹æ¡ˆï¼Œæ”¶é›†å¯èƒ½æ–¹å‘</li>
<li>äººæ ¹æ®ä¸Šä¸‹æ–‡ï¼ˆå›¢é˜Ÿã€å¯ç»´æŠ¤æ€§ã€ä¸šåŠ¡ä¼˜å…ˆçº§ï¼‰æ”¶æ•›å†³ç­–</li>
<li>å†è®© AI ç»†åŒ–æ–¹æ¡ˆå’Œå®ç°ç»†èŠ‚</li>
<li>æœ€åç”±äººåšå…³é”®éªŒè¯å’Œå–èˆ</li>
</ol>
<h3 data-id="heading-9">4.2 æ‰¹åˆ¤æ€§ä½¿ç”¨AIè¾“å‡º</h3>
<p>å»ºç«‹ç®€å•çš„è¯„ä¼°æ¡†æ¶ï¼š</p>
<ul>
<li><strong>é«˜å¯ä¿¡åº¦åœºæ™¯</strong>ï¼šæ¶‰åŠç¡®å®šäº‹å®ã€å·²æœ‰æ¨¡å¼çš„ä»»åŠ¡</li>
<li><strong>éœ€éªŒè¯åœºæ™¯</strong>ï¼šæ¶‰åŠåˆ›æ–°ã€é¢„æµ‹ã€ä»·å€¼åˆ¤æ–­çš„è¾“å‡º</li>
<li><strong>å§‹ç»ˆè¿½é—®</strong>ï¼šâ€œè¿™ä¸ªå»ºè®®çš„éšå«å‡è®¾æ˜¯ä»€ä¹ˆï¼Ÿâ€â€œåœ¨æˆ‘å½“å‰çš„æƒ…å¢ƒä¸‹é€‚ç”¨å—ï¼Ÿâ€</li>
</ul>
<h3 data-id="heading-10">4.3 æ—¥å¸¸å·¥ä½œä¸­çš„å…·ä½“å®è·µ</h3>
<ul>
<li><strong>ä»£ç å¼€å‘</strong>ï¼šè®©AIå†™æ ·æ¿ä»£ç ï¼Œä½ ä¸“æ³¨æ ¸å¿ƒé€»è¾‘å’Œæ¶æ„è®¾è®¡</li>
<li><strong>æŠ€æœ¯è¯„å®¡</strong>ï¼šå…ˆç”¨AIè¿›è¡Œåˆæ­¥ä»£ç å®¡æŸ¥ï¼Œä½ é‡ç‚¹å…³æ³¨ä¸šåŠ¡é€»è¾‘å’Œè®¾è®¡å†³ç­–</li>
<li><strong>çŸ¥è¯†æ²‰æ·€</strong>ï¼šAIè¾…åŠ©æ•´ç†æ–‡æ¡£ï¼Œä½ æç‚¼æ ¸å¿ƒæ´å¯Ÿå’Œç»éªŒæ•™è®­</li>
<li><strong>é—®é¢˜æ’æŸ¥</strong>ï¼šAIæä¾›å¯èƒ½çš„æ’æŸ¥æ–¹å‘ï¼Œä½ åŸºäºç³»ç»Ÿç†è§£åšå‡ºæœ€ç»ˆåˆ¤æ–­</li>
</ul>
<h2 data-id="heading-11">äº”ã€æ–°å®šä½ï¼šä»â€œæŠ€æœ¯ä¸“å®¶â€åˆ°â€œäººæœºååŒè®¾è®¡å¸ˆâ€</h2>
<h3 data-id="heading-12">5.1 è§’è‰²è¿›åŒ–è·¯å¾„</h3>
<p>ä¼ ç»Ÿè§’è‰²ï¼šæŠ€æœ¯æ·±åº¦ä¸“å®¶<br/>
å½“å‰é˜¶æ®µï¼šAI å¢å¼ºå‹æŠ€æœ¯ä¸“å®¶<br/>
æœªæ¥å®šä½ï¼šäººæœºååŒè®¾è®¡å¸ˆ<br/>
â€”â€” è¯„ä¼° AI èƒ½åŠ›è¾¹ç•Œ<br/>
â€”â€” å®šä¹‰å¤æ‚é—®é¢˜<br/>
â€”â€” æ­å»ºäººæœºå·¥ä½œæµ<br/>
â€”â€” åšä»·å€¼å–èˆä¸å†³ç­–</p>
<h3 data-id="heading-13">5.2 æ ¸å¿ƒèƒ½åŠ›æŠ•èµ„æ–¹å‘</h3>
<ol>
<li><strong>æå‡AIç´ å…»</strong>ï¼šç†è§£AIèƒ½åŠ›è¾¹ç•Œï¼ŒæŒæ¡é«˜æ•ˆæç¤ºæŠ€å·§</li>
<li><strong>å¼ºåŒ–ç³»ç»Ÿæ€ç»´</strong>ï¼šä»â€œå†™ä»£ç â€åˆ°â€œè®¾è®¡ç³»ç»Ÿä¸å·¥ä½œæµâ€</li>
<li><strong>åŸ¹å…»åˆ¤æ–­åŠ›</strong>ï¼šåœ¨ä¸å®Œç¾ä¿¡æ¯ä¸‹åšæŠ€æœ¯å†³ç­–çš„èƒ½åŠ›</li>
<li><strong>å¢å¼ºåä½œèƒ½åŠ›</strong>ï¼šè·¨äººã€è·¨ç³»ç»Ÿã€è·¨AIçš„åä½œè®¾è®¡èƒ½åŠ›</li>
</ol>
<h2 data-id="heading-14">å…­ã€ç»“è¯­ï¼šä¸“æ³¨ä¸å¯¹ç§°ä¼˜åŠ¿</h2>
<p>çœŸæ­£çš„æœºé‡åœ¨äºè¯†åˆ«å¹¶å¼ºåŒ–æˆ‘ä»¬çš„<strong>ä¸å¯¹ç§°ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>AIå¤„ç†å·²çŸ¥ï¼Œæˆ‘ä»¬æ¢ç´¢æœªçŸ¥</li>
<li>AIä¼˜åŒ–æ•ˆç‡ï¼Œæˆ‘ä»¬å®šä¹‰ä»·å€¼</li>
<li>AIæ‰§è¡Œæ¨¡å¼ï¼Œæˆ‘ä»¬åˆ›é€ æ„ä¹‰</li>
</ul>
<p>ä¸å¿…å’Œ AI æ¯”æ‹¼ç¼–ç é€Ÿåº¦ï¼Œæ›´åº”è¯¥æŠŠç²¾åŠ›æ”¾åœ¨ AI éš¾ä»¥è§¦åŠçš„éƒ¨åˆ†ï¼šå¤æ‚æƒ…å¢ƒä¸‹çš„æŠ€æœ¯åˆ¤æ–­ã€å›¢é˜Ÿæˆé•¿ã€ä¸šåŠ¡ä¸æŠ€æœ¯äº¤æ±‡å¤„çš„åˆ›æ–°ã€‚</p>
<p>ä¼˜ç§€çš„æŠ€æœ¯äººä¸ä¼šè¢« AI æ›¿ä»£ï¼Œä½†ä¼šå’Œä¸ä¼šç”¨ AI çš„äººæ‹‰å¼€å·®è·ã€‚ç°åœ¨ä¸æ˜¯æ›¿ä»£çš„æ—¶ä»£ï¼Œè€Œæ˜¯<strong>å¢å¼º</strong>çš„æ—¶ä»£â€”â€”å–„ç”¨ AIã€æŠŠæ¡è¾¹ç•Œçš„äººï¼Œå½±å“åŠ›ä¼šæ›´å¤§ã€‚</p>
<p><strong>çœŸæ­£éœ€è¦æ‹…å¿ƒçš„ä¸æ˜¯ AI å¤ªå¼ºï¼Œè€Œæ˜¯æˆ‘ä»¬å®šä¹‰é—®é¢˜ã€åˆ¤æ–­ä»·å€¼ã€åˆ›é€ çªç ´çš„èƒ½åŠ›æ˜¯å¦è¶³å¤Ÿå¼ºã€‚</strong></p>
<hr/>
<p><em>ä¿æŒæ€è€ƒçš„æ·±åº¦ï¼Œå–„ç”¨å·¥å…·çš„åŠ›é‡ï¼Œåœ¨æŠ€æœ¯å˜é©çš„æ—¶ä»£ä¸­æ‰¾åˆ°è‡ªå·±çš„æ ¸å¿ƒåæ ‡ã€‚</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é“¾å¼è°ƒç”¨ï¼šè®©ä»£ç åƒè¯´è¯ä¸€æ ·è‡ªç„¶]]></title>    <link>https://juejin.cn/post/7598029481509158931</link>    <guid>https://juejin.cn/post/7598029481509158931</guid>    <pubDate>2026-01-23T02:23:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598029481509158931" data-draft-id="7598029481508995091" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é“¾å¼è°ƒç”¨ï¼šè®©ä»£ç åƒè¯´è¯ä¸€æ ·è‡ªç„¶"/> <meta itemprop="keywords" content="åç«¯,Java,è®¾è®¡æ¨¡å¼"/> <meta itemprop="datePublished" content="2026-01-23T02:23:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‹æ¸¡è‹‡"/> <meta itemprop="url" content="https://juejin.cn/user/729731453429159"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é“¾å¼è°ƒç”¨ï¼šè®©ä»£ç åƒè¯´è¯ä¸€æ ·è‡ªç„¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/729731453429159/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‹æ¸¡è‹‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T02:23:47.000Z" title="Fri Jan 23 2026 02:23:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body .octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}.markdown-body .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown-body .anchor:focus{outline:none}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1:hover .anchor .octicon-link:before,.markdown-body h2:hover .anchor .octicon-link:before,.markdown-body h3:hover .anchor .octicon-link:before,.markdown-body h4:hover .anchor .octicon-link:before,.markdown-body h5:hover .anchor .octicon-link:before,.markdown-body h6:hover .anchor .octicon-link:before{width:16px;height:16px;content:" ";display:inline-block;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' aria-hidden='true'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E")}.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body details{display:block}.markdown-body summary{display:list-item}.markdown-body a{background-color:initial}.markdown-body a:active,.markdown-body a:hover{outline-width:0}.markdown-body strong{font-weight:inherit;font-weight:bolder}.markdown-body h1{margin:.67em 0}.markdown-body img{border-style:none}.markdown-body code,.markdown-body kbd,.markdown-body pre{font-family:monospace,monospace;font-size:1em}.markdown-body hr{box-sizing:initial;overflow:visible}.markdown-body input{font:inherit;margin:0;overflow:visible}.markdown-body [type=checkbox]{box-sizing:border-box;padding:0}.markdown-body *{box-sizing:border-box}.markdown-body input{font-family:inherit;font-size:inherit;line-height:inherit}.markdown-body a{color:#0366d6;text-decoration:none}.markdown-body a:hover{text-decoration:underline}.markdown-body strong{font-weight:600}.markdown-body hr{height:0;margin:15px 0;overflow:hidden;background:transparent;border-bottom:1px solid #dfe2e5}.markdown-body hr:after,.markdown-body hr:before{display:table;content:""}.markdown-body hr:after{clear:both}.markdown-body table{border-spacing:0;border-collapse:collapse}.markdown-body td,.markdown-body th{padding:0}.markdown-body details summary{cursor:pointer}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:0;margin-bottom:0}.markdown-body h1{font-size:32px}.markdown-body h1,.markdown-body h2{font-weight:600}.markdown-body h2{font-size:24px}.markdown-body h3{font-size:20px}.markdown-body h3,.markdown-body h4{font-weight:600}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:14px}.markdown-body h5,.markdown-body h6{font-weight:600}.markdown-body h6{font-size:12px}.markdown-body p{margin-top:0;margin-bottom:10px}.markdown-body blockquote{margin:0}.markdown-body ol,.markdown-body ul{padding-left:0;margin-top:0;margin-bottom:0}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body dd{margin-left:0}.markdown-body code,.markdown-body pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px}.markdown-body pre{margin-top:0;margin-bottom:0}.markdown-body input::-webkit-inner-spin-button,.markdown-body input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none;appearance:none}.markdown-body :checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}.markdown-body .border{border:1px solid #e1e4e8!important}.markdown-body .border-0{border:0!important}.markdown-body .border-bottom{border-bottom:1px solid #e1e4e8!important}.markdown-body .rounded-1{border-radius:3px!important}.markdown-body .bg-white{background-color:#fff!important}.markdown-body .bg-gray-light{background-color:#fafbfc!important}.markdown-body .text-gray-light{color:#6a737d!important}.markdown-body .pl-3,.markdown-body .px-3{padding-left:16px!important}.markdown-body .px-3{padding-right:16px!important}.markdown-body .f6{font-size:12px!important}.markdown-body .lh-condensed{line-height:1.25!important}.markdown-body .text-bold{font-weight:600!important}.markdown-body .pl-c{color:#6a737d}.markdown-body .pl-c1,.markdown-body .pl-s .pl-v{color:#005cc5}.markdown-body .pl-e,.markdown-body .pl-en{color:#6f42c1}.markdown-body .pl-s .pl-s1,.markdown-body .pl-smi{color:#24292e}.markdown-body .pl-ent{color:#22863a}.markdown-body .pl-k{color:#d73a49}.markdown-body .pl-pds,.markdown-body .pl-s,.markdown-body .pl-s .pl-pse .pl-s1,.markdown-body .pl-sr,.markdown-body .pl-sr .pl-cce,.markdown-body .pl-sr .pl-sra,.markdown-body .pl-sr .pl-sre{color:#032f62}.markdown-body .pl-smw,.markdown-body .pl-v{color:#e36209}.markdown-body .pl-bu{color:#b31d28}.markdown-body .pl-ii{color:#fafbfc;background-color:#b31d28}.markdown-body .pl-c2{color:#fafbfc;background-color:#d73a49}.markdown-body .pl-c2:before{content:"^M"}.markdown-body .pl-sr .pl-cce{font-weight:700;color:#22863a}.markdown-body .pl-ml{color:#735c0f}.markdown-body .pl-mh,.markdown-body .pl-mh .pl-en,.markdown-body .pl-ms{font-weight:700;color:#005cc5}.markdown-body .pl-mi{font-style:italic;color:#24292e}.markdown-body .pl-mb{font-weight:700;color:#24292e}.markdown-body .pl-md{color:#b31d28;background-color:#ffeef0}.markdown-body .pl-mi1{color:#22863a;background-color:#f0fff4}.markdown-body .pl-mc{color:#e36209;background-color:#ffebda}.markdown-body .pl-mi2{color:#f6f8fa;background-color:#005cc5}.markdown-body .pl-mdr{font-weight:700;color:#6f42c1}.markdown-body .pl-ba{color:#586069}.markdown-body .pl-sg{color:#959da5}.markdown-body .pl-corl{text-decoration:underline;color:#032f62}.markdown-body .mb-0{margin-bottom:0!important}.markdown-body .my-2{margin-bottom:8px!important;margin-top:8px!important}.markdown-body .pl-0{padding-left:0!important}.markdown-body .py-0{padding-top:0!important;padding-bottom:0!important}.markdown-body .pl-1{padding-left:4px!important}.markdown-body .pl-2{padding-left:8px!important}.markdown-body .py-2{padding-top:8px!important;padding-bottom:8px!important}.markdown-body .pl-3{padding-left:16px!important}.markdown-body .pl-4{padding-left:24px!important}.markdown-body .pl-5{padding-left:32px!important}.markdown-body .pl-6{padding-left:40px!important}.markdown-body .pl-7{padding-left:48px!important}.markdown-body .pl-8{padding-left:64px!important}.markdown-body .pl-9{padding-left:80px!important}.markdown-body .pl-10{padding-left:96px!important}.markdown-body .pl-11{padding-left:112px!important}.markdown-body .pl-12{padding-left:128px!important}.markdown-body hr{border-bottom-color:#eee}.markdown-body kbd{display:inline-block;padding:3px 5px;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body&gt;:first-child{margin-top:0!important}.markdown-body&gt;:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body blockquote,.markdown-body details,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e1e4e8;border:0}.markdown-body blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eaecef}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#6a737d}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li{word-wrap:break-all}.markdown-body li&gt;p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto}.markdown-body table th{font-weight:600}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #dfe2e5}.markdown-body table tr{background-color:#fff;border-top:1px solid #c6cbd1}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}.markdown-body img{max-width:100%;box-sizing:initial;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body code{padding:.2em .4em;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body pre{word-wrap:normal}.markdown-body pre&gt;code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}.markdown-body pre code{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:initial;border:0}.markdown-body .commit-tease-sha{display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%;color:#444d56}.markdown-body .full-commit .btn-outline:not(:disabled):hover{color:#005cc5;border-color:#005cc5}.markdown-body .blob-wrapper{overflow-x:auto;overflow-y:hidden}.markdown-body .blob-wrapper-embedded{max-height:240px;overflow-y:auto}.markdown-body .blob-num{width:1%;min-width:50px;padding-right:10px;padding-left:10px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;line-height:20px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;vertical-align:top;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-body .blob-num:hover{color:rgba(27,31,35,.6)}.markdown-body .blob-num:before{content:attr(data-line-number)}.markdown-body .blob-code{position:relative;padding-right:10px;padding-left:10px;line-height:20px;vertical-align:top}.markdown-body .blob-code-inner{overflow:visible;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;color:#24292e;word-wrap:normal;white-space:pre}.markdown-body .pl-token.active,.markdown-body .pl-token:hover{cursor:pointer;background:#ffea7f}.markdown-body .tab-size[data-tab-size="1"]{-moz-tab-size:1;tab-size:1}.markdown-body .tab-size[data-tab-size="2"]{-moz-tab-size:2;tab-size:2}.markdown-body .tab-size[data-tab-size="3"]{-moz-tab-size:3;tab-size:3}.markdown-body .tab-size[data-tab-size="4"]{-moz-tab-size:4;tab-size:4}.markdown-body .tab-size[data-tab-size="5"]{-moz-tab-size:5;tab-size:5}.markdown-body .tab-size[data-tab-size="6"]{-moz-tab-size:6;tab-size:6}.markdown-body .tab-size[data-tab-size="7"]{-moz-tab-size:7;tab-size:7}.markdown-body .tab-size[data-tab-size="8"]{-moz-tab-size:8;tab-size:8}.markdown-body .tab-size[data-tab-size="9"]{-moz-tab-size:9;tab-size:9}.markdown-body .tab-size[data-tab-size="10"]{-moz-tab-size:10;tab-size:10}.markdown-body .tab-size[data-tab-size="11"]{-moz-tab-size:11;tab-size:11}.markdown-body .tab-size[data-tab-size="12"]{-moz-tab-size:12;tab-size:12}.markdown-body .task-list-item{list-style-type:none}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}</style><style data-highlight="" data-highlight-key="github">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é›¶ã€ä» StringUtils åˆ° StringButler çš„è®¾è®¡æ¼”è¿›</h2>
<blockquote>
<p><strong>StringButler</strong> æ˜¯æˆ‘ä¹‹å‰åœ¨é¡¹ç›®ä¸Šä¸€ç›´ç”¨çš„ä¸€ä¸ªå°å·¥å…·ï¼Œä»Šå¤©å†³å®šå°†å®ƒæ”¾åˆ°GitHubä¸Šï¼Œç”¨å®ƒåšå¼•å­ï¼Œå’Œå¤§å®¶ä¸€èµ·æ¢è®¨å¦‚ä½•å†™å¥½ä»£ç ï¼Œåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fiweidujiang%2Fstring-butler" target="_blank" title="https://github.com/iweidujiang/string-butler" ref="nofollow noopener noreferrer">github.com/iweidujiangâ€¦</a></p>
</blockquote>
<p>è¿˜åœ¨ç”¨<code>str.trim().toLowerCase().replace()</code>è¿™æ ·ç¬¨æ‹™çš„é“¾å¼è°ƒç”¨å—ï¼Ÿç­‰ç­‰ï¼Œè¿™å…¶å®å·²ç»å¾ˆä¸é”™äº†ï¼</p>
<p>ä½†ä»Šå¤©æˆ‘è¦å‘Šè¯‰ä½ ï¼ŒçœŸæ­£çš„é“¾å¼è°ƒç”¨åº”è¯¥æ˜¯æ€æ ·çš„ä¼˜é›…å­˜åœ¨ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ä»ä¸€ä¸ª"æ™®é€š"çš„éœ€æ±‚è¯´èµ·</h2>
<p>ä¸Šå‘¨ï¼Œæˆ‘çš„åŒäº‹å°æ˜ï¼ˆåˆæ¥â€œæ— ä¸­ç”Ÿæ˜â€ï¼‰ æ¥åˆ°äº†ä¸€ä¸ªéœ€æ±‚ï¼š"ç”¨æˆ·è¾“å…¥çš„é‚®ç®±éœ€è¦æ¸…ç†ã€éªŒè¯ï¼Œå¹¶ç»™å‡ºå‹å¥½çš„é”™è¯¯æç¤º"ã€‚ä»–æ˜¯è¿™æ ·å†™çš„ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> String <span class="hljs-title function_">processUserEmail</span><span class="hljs-params">(String rawEmail)</span> {
    <span class="hljs-comment">// ç¬¬ä¸€ç‰ˆï¼šç»å…¸çš„"é˜²å¾¡æ€§ç¼–ç¨‹"</span>
    <span class="hljs-keyword">if</span> (rawEmail == <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"default@email.com"</span>;
    }
    
    <span class="hljs-type">String</span> <span class="hljs-variable">trimmed</span> <span class="hljs-operator">=</span> rawEmail.trim();
    <span class="hljs-keyword">if</span> (trimmed.isEmpty()) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"default@email.com"</span>;
    }
    
    <span class="hljs-type">String</span> <span class="hljs-variable">lowercased</span> <span class="hljs-operator">=</span> trimmed.toLowerCase();
    <span class="hljs-keyword">if</span> (!lowercased.contains(<span class="hljs-string">"@"</span>)) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"é‚®ç®±æ ¼å¼é”™è¯¯"</span>);
    }
    
    <span class="hljs-comment">// è¿˜è¦æ£€æŸ¥åŸŸå...</span>
    <span class="hljs-comment">// è¿˜è¦æ£€æŸ¥é•¿åº¦...</span>
    <span class="hljs-comment">// è¿˜è¦...</span>
    
    <span class="hljs-keyword">return</span> lowercased;
}
</code></pre>
<p>å†™å®Œè¿™æ®µä»£ç åï¼Œå°æ˜çœ‹ç€æ»¡å±çš„<code>if</code>å’Œä¸´æ—¶å˜é‡ï¼Œé™·å…¥äº†æ²‰æ€ï¼š"è¿™ä»£ç æ€ä¹ˆè¯»èµ·æ¥åƒåœ¨æ‹†è§£ç‚¸å¼¹ï¼Œæ¯ä¸€æ­¥éƒ½è¦å°å¿ƒç¿¼ç¿¼ï¼Ÿ"</p>
<h2 data-id="heading-2">äºŒã€ä¼ ç»Ÿçš„"æ”¹è‰¯"ï¼šé™æ€å·¥å…·ç±»</h2>
<p>å°æ˜æƒ³èµ·äº†<strong>Apache Commons Lang</strong>çš„<code>StringUtils</code>ï¼Œäºæ˜¯ä»–æ”¹æˆäº†è¿™æ ·ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> String <span class="hljs-title function_">processUserEmail</span><span class="hljs-params">(String rawEmail)</span> {
    <span class="hljs-comment">// ç¬¬äºŒç‰ˆï¼šä½¿ç”¨å·¥å…·ç±»</span>
    <span class="hljs-keyword">if</span> (StringUtils.isBlank(rawEmail)) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"default@email.com"</span>;
    }
    
    <span class="hljs-type">String</span> <span class="hljs-variable">processed</span> <span class="hljs-operator">=</span> rawEmail.trim().toLowerCase();
    
    <span class="hljs-keyword">if</span> (!StringUtils.contains(processed, <span class="hljs-string">"@"</span>)) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"é‚®ç®±æ ¼å¼é”™è¯¯"</span>);
    }
    
    <span class="hljs-comment">// çœ‹èµ·æ¥å¥½ä¸€ç‚¹ï¼Œä½†è¿˜æ˜¯...</span>
    <span class="hljs-keyword">return</span> processed;
}
</code></pre>
<p><strong>é—®é¢˜æ¥äº†</strong>ï¼šä»£ç è™½ç„¶å˜çŸ­äº†ï¼Œä½†é€»è¾‘çš„"æµç•…æ€§"ä¾ç„¶è¢«<code>if</code>è¯­å¥åˆ‡å¾—æ”¯ç¦»ç ´ç¢ã€‚æ¯çœ‹ä¸€è¡Œï¼Œæˆ‘éƒ½è¦åœä¸‹æ¥æ€è€ƒï¼š"å“¦ï¼Œè¿™é‡Œåœ¨æ£€æŸ¥ç©ºç™½ï¼›å“¦ï¼Œè¿™é‡Œåœ¨éªŒè¯æ ¼å¼..."</p>
<h2 data-id="heading-3">ä¸‰ã€StringButlerçš„ä¼˜é›…ç™»åœº</h2>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹StringButlerå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> String <span class="hljs-title function_">processUserEmail</span><span class="hljs-params">(String rawEmail)</span> {
    <span class="hljs-comment">// ç¬¬ä¸‰ç‰ˆï¼šä½¿ç”¨StringButler</span>
    <span class="hljs-keyword">return</span> StringButler.of(rawEmail)
        .transform()
            .trim()
            .toLowerCase()
        .transform()
        .validate()
            .notBlank(<span class="hljs-string">"é‚®ç®±ä¸èƒ½ä¸ºç©º"</span>)
            .email(<span class="hljs-string">"è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€"</span>)
            .lengthBetween(<span class="hljs-number">5</span>, <span class="hljs-number">100</span>, <span class="hljs-string">"é‚®ç®±é•¿åº¦åº”åœ¨5-100ä¹‹é—´"</span>)
        .validate()
        .getValueOr(<span class="hljs-string">"default@email.com"</span>);
}
</code></pre>
<p><strong>å“‡ï¼</strong> è¿™æ®µä»£ç è¯»èµ·æ¥å°±åƒåœ¨æè¿°ä¸šåŠ¡é€»è¾‘ï¼š</p>
<ol>
<li>"ç»™æˆ‘è¿™ä¸ªåŸå§‹é‚®ç®±"</li>
<li>"å…ˆè½¬æ¢ä¸€ä¸‹ï¼šå»æ‰ç©ºæ ¼ï¼Œè½¬æˆå°å†™"</li>
<li>"ç„¶åéªŒè¯ï¼šä¸èƒ½ä¸ºç©ºã€é‚®ç®±æ ¼å¼ã€é•¿åº¦è¦åˆé€‚"</li>
<li>"æœ€åç»™æˆ‘ç»“æœï¼Œä¸è¡Œå°±ç»™é»˜è®¤å€¼"</li>
</ol>
<h2 data-id="heading-4">å››ã€é“¾å¼è°ƒç”¨çš„è®¾è®¡ç§˜å¯†</h2>
<h3 data-id="heading-5">4.1 ä»€ä¹ˆæ˜¯çœŸæ­£çš„Fluent Interfaceï¼Ÿ</h3>
<p>å¾ˆå¤šäººè¯¯ä»¥ä¸º"è¿”å›this"å°±æ˜¯é“¾å¼è°ƒç”¨ã€‚å…¶å®ä¸ç„¶ï¼ŒçœŸæ­£çš„Fluent Interfaceï¼ˆæµç•…æ¥å£ï¼‰éœ€è¦æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶ï¼š</p>
<ol>
<li>æ¯ä¸€æ­¥éƒ½è¿”å›ä¸€ä¸ªå¯ä»¥ç»§ç»­æ“ä½œçš„ä¸Šä¸‹æ–‡</li>
<li>æ”¯æŒå¤šç§ç±»å‹çš„é“¾å¼æ“ä½œ</li>
<li>é“¾çš„ç»ˆç‚¹æ˜ç¡®</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¼ªä»£ç ç¤ºä¾‹ï¼šStringButlerçš„æ ¸å¿ƒè®¾è®¡</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StringButler</span> {
    <span class="hljs-comment">// 1. æ¯ä¸€æ­¥éƒ½è¿”å›ä¸€ä¸ªå¯ä»¥ç»§ç»­æ“ä½œçš„ä¸Šä¸‹æ–‡</span>
    <span class="hljs-keyword">public</span> StringButler <span class="hljs-title function_">trim</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">this</span>.value = <span class="hljs-built_in">this</span>.value.trim();
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>; <span class="hljs-comment">// å…³é”®ï¼šè¿”å›è‡ªèº«ï¼Œä½†ä¸ä»…ä»…æ˜¯è¿”å›this</span>
    }
    
    <span class="hljs-comment">// 2. æ”¯æŒå¤šç§ç±»å‹çš„é“¾å¼æ“ä½œ</span>
    <span class="hljs-keyword">public</span> ValidationChain <span class="hljs-title function_">validate</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ValidationChain</span>(<span class="hljs-built_in">this</span>); <span class="hljs-comment">// åˆ‡æ¢åˆ°éªŒè¯é“¾</span>
    }
    
    <span class="hljs-keyword">public</span> TransformationChain <span class="hljs-title function_">transform</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformationChain</span>(<span class="hljs-built_in">this</span>); <span class="hljs-comment">// åˆ‡æ¢åˆ°è½¬æ¢é“¾</span>
    }
    
    <span class="hljs-comment">// 3. é“¾çš„ç»ˆç‚¹æ˜ç¡®</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getValue</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.value; <span class="hljs-comment">// ç»ˆç»“æ“ä½œï¼Œè¿”å›æœ€ç»ˆç»“æœ</span>
    }
}
</code></pre>
<h3 data-id="heading-6">4.2 StringButlerçš„é“¾å¼æ¶æ„</h3>
<p>è®©æˆ‘ç”¨ä¸€å¼ å›¾å±•ç¤ºStringButlerçš„é“¾å¼è®¾è®¡ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/452fe2dfd6b14951bb82fb49416787f3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5rih6IuH:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769739826&amp;x-signature=zYcNABE%2Fvn00tHGKGRWm9TMtXRY%3D" alt="é“¾å¼è°ƒç”¨" loading="lazy"/></p>
<p><strong>è®¾è®¡äº®ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>ä¸Šä¸‹æ–‡ä¿æŒ</strong>ï¼šæ¯ä¸€æ­¥æ“ä½œéƒ½åœ¨åŒä¸€ä¸ª"ä¸Šä¸‹æ–‡"ä¸­è¿›è¡Œ</li>
<li><strong>é“¾å¼åˆ‡æ¢</strong>ï¼šå¯ä»¥åœ¨ä¸åŒç±»å‹é“¾ï¼ˆè½¬æ¢é“¾ã€éªŒè¯é“¾ï¼‰é—´æ— ç¼åˆ‡æ¢</li>
<li><strong>ç»ˆç»“æ˜ç¡®</strong>ï¼šé“¾çš„ç»ˆç‚¹æ¸…æ™°ï¼Œä¸ä¼šæ— é™å»¶ä¼¸</li>
</ol>
<h3 data-id="heading-7">4.3 å¯¹æ¯”ä¼ ç»Ÿé“¾å¼è°ƒç”¨</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¼ ç»Ÿé“¾å¼ï¼ˆJavaå†…ç½®ï¼‰</span>
<span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-string">"  HELLO  "</span>
    .trim()          <span class="hljs-comment">// String â†’ String</span>
    .toLowerCase()   <span class="hljs-comment">// String â†’ String</span>
    .replace(<span class="hljs-string">"L"</span>, <span class="hljs-string">"X"</span>); <span class="hljs-comment">// String â†’ String</span>

<span class="hljs-comment">// StringButleré“¾å¼</span>
<span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> StringButler.of(<span class="hljs-string">"  HELLO  "</span>)
    .transform()      <span class="hljs-comment">// åˆ‡æ¢åˆ°è½¬æ¢é“¾</span>
        .trim()       <span class="hljs-comment">// StringButler â†’ StringButler</span>
        .toLowerCase() 
        .replace(<span class="hljs-string">"L"</span>, <span class="hljs-string">"X"</span>)
    .transform()      <span class="hljs-comment">// è¿”å›StringButler</span>
    .getValue();      <span class="hljs-comment">// ç»ˆç»“æ“ä½œ</span>
</code></pre>
<p><strong>å…³é”®åŒºåˆ«</strong>ï¼šä¼ ç»Ÿé“¾å¼æ¯ä¸€æ­¥éƒ½è¿”å›<code>String</code>ï¼Œä½ åªèƒ½è¿›è¡Œ<code>String</code>ç±»å®šä¹‰çš„æ“ä½œã€‚è€ŒStringButlerè¿”å›çš„æ˜¯<code>StringButler</code>æˆ–é“¾å¯¹è±¡ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥è¿›è¡Œ<strong>é¢†åŸŸç‰¹å®š</strong>çš„æ“ä½œï¼ˆå¦‚éªŒè¯ã€æ©ç ç­‰ï¼‰ã€‚</p>
<h2 data-id="heading-8">äº”ã€å®ç°ç»†èŠ‚ï¼šå¦‚ä½•è®¾è®¡ä¸€ä¸ªå¥½çš„é“¾å¼API</h2>
<h3 data-id="heading-9">5.1 åˆç†çš„é“¾é•¿åº¦æ§åˆ¶</h3>
<p>å¥½çš„é“¾å¼APIåº”è¯¥æœ‰è‡ªç„¶çš„"æ®µè½æ„Ÿ"ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åä¾‹ï¼šé“¾å¤ªé•¿ï¼Œéš¾ä»¥é˜…è¯»</span>
StringButler.of(str).trim().toLowerCase().replace(<span class="hljs-string">"a"</span>,<span class="hljs-string">"b"</span>).mask().truncate(<span class="hljs-number">10</span>).validate().email().notBlank().getValue();

<span class="hljs-comment">// æ­£ä¾‹ï¼šåˆç†çš„æ®µè½åˆ’åˆ†</span>
StringButler.of(str)
    .transform()
        .trim()
        .toLowerCase()
        .replace(<span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>)
        .mask()
        .truncate(<span class="hljs-number">10</span>)
    .transform()
    .validate()
        .email()
        .notBlank()
    .validate()
    .getValue();
</code></pre>
<h3 data-id="heading-10">5.2 æä¾›é€ƒç”Ÿèˆ±å£</h3>
<p>ä¸æ˜¯æ‰€æœ‰æ“ä½œéƒ½é€‚åˆé“¾å¼ï¼Œéœ€è¦æä¾›"é€ƒç”Ÿèˆ±å£"ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// é€ƒç”Ÿèˆ±å£1ï¼šè·å–ä¸­é—´ç»“æœ</span>
<span class="hljs-type">StringButler</span> <span class="hljs-variable">butler</span> <span class="hljs-operator">=</span> StringButler.of(<span class="hljs-string">"test"</span>);
<span class="hljs-type">String</span> <span class="hljs-variable">intermediate</span> <span class="hljs-operator">=</span> butler.trim().getValue(); <span class="hljs-comment">// å¯ä»¥åœ¨é“¾ä¸­é—´è·å–å€¼</span>

<span class="hljs-comment">// é€ƒç”Ÿèˆ±å£2ï¼šä¼ ç»Ÿæ–¹æ³•å…¼å®¹</span>
<span class="hljs-keyword">if</span> (StringButler.of(str).validate().email().validate().isValid()) {
    <span class="hljs-comment">// ä¼ ç»Ÿifè¯­å¥</span>
}

<span class="hljs-comment">// é€ƒç”Ÿèˆ±å£3ï¼šä¸ç°æœ‰ä»£ç é›†æˆ</span>
Optional&lt;String&gt; result = StringButler.of(str)
    .transform()
        .trim()
    .transform()
    .getValueOptional(); <span class="hljs-comment">// è¿”å›Optionalï¼Œæ–¹ä¾¿ä¸ç°ä»£Javaä»£ç é›†æˆ</span>
</code></pre>
<h2 data-id="heading-11">å…­ã€æ€§èƒ½å®æµ‹ï¼šé“¾å¼è°ƒç”¨çš„çœŸå®ä»£ä»·</h2>
<p>æˆ‘çŸ¥é“ä½ åœ¨æƒ³ä»€ä¹ˆï¼š"è¿™ä¹ˆå¤šé“¾å¼è°ƒç”¨ï¼Œæ€§èƒ½ä¼šä¸ä¼šå¾ˆå·®ï¼Ÿ"</p>
<p>è¿™é‡Œå…ˆæå‰é€æ¼ä¸€ä¸‹ï¼Œæ€§èƒ½å’Œè€å‰è¾ˆä»¬æ¯”ï¼Œç¡®å®æ¯”ä¸è¿‡...ï¼Œä½†ï¼Œæ€§èƒ½ä¸æ˜¯StringButlerçš„ç›®çš„ï¼ˆç¡®ä¿¡ï¼Œå“ˆå“ˆï¼‰</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6931c925de7f4c97b2d219dda2c85a32~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5rih6IuH:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769739826&amp;x-signature=rKuIDQXRqLCSFcUD%2BEaiKkIc11U%3D" alt="" loading="lazy"/></p>
<p>è¨€å½’æ­£ä¼ ï¼Œæˆ‘ç¼–å†™äº†å®Œæ•´çš„æ€§èƒ½æµ‹è¯•ä»£ç ï¼Œä½¿ç”¨JMHï¼ˆJava Microbenchmark Harnessï¼‰è¿›è¡Œç§‘å­¦æµ‹é‡ï¼š</p>
<h3 data-id="heading-12">6.1 æ€§èƒ½æµ‹è¯•ç¯å¢ƒ</h3>
<ul>
<li><strong>ç¡¬ä»¶</strong>ï¼šWindows 11ï¼Œ64GBå†…å­˜</li>
<li><strong>JDK</strong>ï¼šJDK 1.8.0_421, Java HotSpot(TM) 64-Bit Server VM, 25.421-b09</li>
<li><strong>æµ‹è¯•æ¡†æ¶</strong>ï¼šJMH 1.37</li>
<li><strong>æµ‹è¯•æ¨¡å¼</strong>ï¼šå¹³å‡æ—¶é—´æ¨¡å¼ï¼ˆå•æ¬¡æ“ä½œè€—æ—¶ï¼‰</li>
</ul>
<h3 data-id="heading-13">6.2 å®Œæ•´çš„æ€§èƒ½æµ‹è¯•ä»£ç </h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> io.github.iweidujiang.stringbutler.benchmark;

<span class="hljs-keyword">import</span> io.github.iweidujiang.stringbutler.core.StringButler;
<span class="hljs-keyword">import</span> org.openjdk.jmh.annotations.*;
<span class="hljs-keyword">import</span> org.openjdk.jmh.infra.Blackhole;

<span class="hljs-keyword">import</span> java.util.concurrent.TimeUnit;

<span class="hljs-meta">@BenchmarkMode(Mode.AverageTime)</span>
<span class="hljs-meta">@OutputTimeUnit(TimeUnit.NANOSECONDS)</span>
<span class="hljs-meta">@State(Scope.Thread)</span>
<span class="hljs-meta">@Warmup(iterations = 3, time = 1)</span>
<span class="hljs-meta">@Measurement(iterations = 5, time = 1)</span>
<span class="hljs-meta">@Fork(2)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StringButlerBenchmark</span> {
    
    <span class="hljs-comment">// æµ‹è¯•æ•°æ®ï¼šæ¨¡æ‹ŸçœŸå®åœºæ™¯ä¸­çš„å­—ç¬¦ä¸²</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">TEST_STRING</span> <span class="hljs-operator">=</span> <span class="hljs-string">"  Hello World! This is a test string.  "</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String[] TEST_STRINGS = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[<span class="hljs-number">1_000_000</span>];
    
    <span class="hljs-meta">@Setup</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setup</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å‡†å¤‡100ä¸‡ä¸ªæµ‹è¯•å­—ç¬¦ä¸²</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; TEST_STRINGS.length; i++) {
            TEST_STRINGS[i] = TEST_STRING + <span class="hljs-string">" #"</span> + i;
        }
    }
    
    <span class="hljs-comment">// åŸºå‡†æµ‹è¯•1ï¼šä¼ ç»Ÿæ–¹å¼ï¼ˆJavaåŸç”Ÿé“¾å¼ï¼‰</span>
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testTraditionalChain</span><span class="hljs-params">(Blackhole bh)</span> {
        <span class="hljs-keyword">for</span> (String str : TEST_STRINGS) {
            <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> str
                    .trim()
                    .toLowerCase()
                    .replace(<span class="hljs-string">"world"</span>, <span class="hljs-string">"java"</span>)
                    .replace(<span class="hljs-string">"test"</span>, <span class="hljs-string">"benchmark"</span>)
                    .substring(<span class="hljs-number">0</span>, Math.min(<span class="hljs-number">20</span>, str.length()));
            bh.consume(result);
        }
    }

    <span class="hljs-comment">// åŸºå‡†æµ‹è¯•2ï¼šStringButleræ–¹å¼ï¼ˆåŸºæœ¬é“¾å¼ï¼‰</span>
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testStringButlerBasic</span><span class="hljs-params">(Blackhole bh)</span> {
        <span class="hljs-keyword">for</span> (String str : TEST_STRINGS) {
            <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> StringButler.of(str)
                    .transform()
                    .trim()
                    .toLowerCase()
                    .replace(<span class="hljs-string">"world"</span>, <span class="hljs-string">"java"</span>)
                    .replace(<span class="hljs-string">"test"</span>, <span class="hljs-string">"benchmark"</span>)
                    .truncate(<span class="hljs-number">20</span>)  <span class="hljs-comment">// ä½¿ç”¨truncateæ›¿ä»£substring</span>
                    .transform()
                    .getValue();
            bh.consume(result);
        }
    }

    <span class="hljs-comment">// åŸºå‡†æµ‹è¯•3ï¼šStringButleræ–¹å¼ï¼ˆå¸¦éªŒè¯çš„å®Œæ•´é“¾å¼ï¼‰</span>
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testStringButlerFull</span><span class="hljs-params">(Blackhole bh)</span> {
        <span class="hljs-keyword">for</span> (String str : TEST_STRINGS) {
            <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> StringButler.of(str)
                    .transform()
                    .trim()
                    .toLowerCase()
                    .replace(<span class="hljs-string">"world"</span>, <span class="hljs-string">"java"</span>)
                    .transform()
                    .validate()
                    .notBlank()
                    .lengthBetween(<span class="hljs-number">5</span>, <span class="hljs-number">1000</span>)
                    .matches(<span class="hljs-string">".*java.*"</span>)
                    .validate()
                    .getValueOr(<span class="hljs-string">"default"</span>);
            bh.consume(result);
        }
    }

    <span class="hljs-comment">// åŸºå‡†æµ‹è¯•4ï¼šApache Commons Langæ–¹å¼ï¼ˆå¯¹æ¯”ï¼‰</span>
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testApacheCommons</span><span class="hljs-params">(Blackhole bh)</span> {
        <span class="hljs-keyword">for</span> (String str : TEST_STRINGS) {
            <span class="hljs-type">String</span> <span class="hljs-variable">trimmed</span> <span class="hljs-operator">=</span> org.apache.commons.lang3.StringUtils.trim(str);
            <span class="hljs-type">String</span> <span class="hljs-variable">lower</span> <span class="hljs-operator">=</span> org.apache.commons.lang3.StringUtils.lowerCase(trimmed);
            <span class="hljs-type">String</span> <span class="hljs-variable">replaced1</span> <span class="hljs-operator">=</span> org.apache.commons.lang3.StringUtils.replace(lower, <span class="hljs-string">"world"</span>, <span class="hljs-string">"java"</span>);
            <span class="hljs-type">String</span> <span class="hljs-variable">replaced2</span> <span class="hljs-operator">=</span> org.apache.commons.lang3.StringUtils.replace(replaced1, <span class="hljs-string">"test"</span>, <span class="hljs-string">"benchmark"</span>);
            <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> org.apache.commons.lang3.StringUtils.substring(replaced2, <span class="hljs-number">0</span>, <span class="hljs-number">20</span>);
            bh.consume(result);
        }
    }

    <span class="hljs-comment">// åŸºå‡†æµ‹è¯•5ï¼šä¼ ç»Ÿif-elseæ–¹å¼ï¼ˆä½œä¸ºå¯¹æ¯”ï¼‰</span>
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testTraditionalIfElse</span><span class="hljs-params">(Blackhole bh)</span> {
        <span class="hljs-keyword">for</span> (String str : TEST_STRINGS) {
            String result;
            <span class="hljs-keyword">if</span> (str == <span class="hljs-literal">null</span>) {
                result = <span class="hljs-string">"default"</span>;
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-type">String</span> <span class="hljs-variable">trimmed</span> <span class="hljs-operator">=</span> str.trim();
                <span class="hljs-keyword">if</span> (trimmed.isEmpty()) {
                    result = <span class="hljs-string">"default"</span>;
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-type">String</span> <span class="hljs-variable">lower</span> <span class="hljs-operator">=</span> trimmed.toLowerCase();
                    <span class="hljs-type">String</span> <span class="hljs-variable">replaced1</span> <span class="hljs-operator">=</span> lower.replace(<span class="hljs-string">"world"</span>, <span class="hljs-string">"java"</span>);
                    <span class="hljs-type">String</span> <span class="hljs-variable">replaced2</span> <span class="hljs-operator">=</span> replaced1.replace(<span class="hljs-string">"test"</span>, <span class="hljs-string">"benchmark"</span>);
                    <span class="hljs-keyword">if</span> (replaced2.length() &gt; <span class="hljs-number">20</span>) {
                        result = replaced2.substring(<span class="hljs-number">0</span>, <span class="hljs-number">20</span>);
                    } <span class="hljs-keyword">else</span> {
                        result = replaced2;
                    }
                }
            }
            bh.consume(result);
        }
    }

    <span class="hljs-comment">// åŸºå‡†æµ‹è¯•6ï¼šStringButlerå¤æ‚æ“ä½œï¼ˆå¤šç§trimç­–ç•¥ã€æ©ç ç­‰ï¼‰</span>
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testStringButlerComplex</span><span class="hljs-params">(Blackhole bh)</span> {
        <span class="hljs-keyword">for</span> (String str : TEST_STRINGS) {
            <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> StringButler.of(str)
                    .transform()
                    .trim(TrimStrategy.SMART)  <span class="hljs-comment">// æ™ºèƒ½trim</span>
                    .toLowerCase()
                    .replace(<span class="hljs-string">"world"</span>, <span class="hljs-string">"java"</span>)
                    .mask()  <span class="hljs-comment">// é»˜è®¤æ©ç ï¼šæ˜¾ç¤ºå‰3å4</span>
                    .truncate(<span class="hljs-number">25</span>, <span class="hljs-string">"..."</span>, <span class="hljs-literal">true</span>)  <span class="hljs-comment">// æ™ºèƒ½æˆªæ–­</span>
                    .transform()
                    .validate()
                    .notBlank(<span class="hljs-string">"å­—ç¬¦ä¸²ä¸èƒ½ä¸ºç©º"</span>)
                    .lengthBetween(<span class="hljs-number">10</span>, <span class="hljs-number">100</span>, <span class="hljs-string">"é•¿åº¦åº”åœ¨10-100ä¹‹é—´"</span>)
                    .validate()
                    .getValueOr(<span class="hljs-string">"å¤„ç†å¤±è´¥"</span>);
            bh.consume(result);
        }
    }
}
</code></pre>
<h3 data-id="heading-14">6.3 è¿è¡Œæµ‹è¯•å¹¶è·å–ç»“æœ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. ç¼–è¯‘é¡¹ç›®</span>
mvn clean compile

<span class="hljs-comment"># 2. è¿è¡ŒJMHåŸºå‡†æµ‹è¯•</span>
mvn <span class="hljs-built_in">exec</span>:<span class="hljs-built_in">exec</span>
</code></pre>
<h3 data-id="heading-15">6.4 å®é™…æµ‹è¯•ç»“æœ</h3>
<p>ä»¥ä¸‹æ˜¯çœŸå®è¿è¡Œæµ‹è¯•åçš„ç»“æœï¼ˆ100ä¸‡æ¬¡æ“ä½œï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">Benchmark                                      Mode  Cnt           Score           Error  Units
StringButlerBenchmark.testApacheCommons        avgt   10   239955526.000 Â±   8771487.166  ns/op
StringButlerBenchmark.testStringButlerBasic    avgt   10   560111555.000 Â±  18134999.271  ns/op
StringButlerBenchmark.testStringButlerComplex  avgt   10  1011401090.000 Â±  32499845.510  ns/op
StringButlerBenchmark.testStringButlerFull     avgt   10  1548874040.000 Â± 102341329.144  ns/op
StringButlerBenchmark.testTraditionalChain     avgt   10   526397960.000 Â±  23974313.776  ns/op
StringButlerBenchmark.testTraditionalIfElse    avgt   10   501893983.333 Â±   7017351.512  ns/op
</code></pre>
<h3 data-id="heading-16">6.5 ç»“æœåˆ†æä¸è§£è¯»</h3>
<p>è®©æˆ‘ä»¬æŠŠæ•°æ®è½¬æ¢æˆæ›´ç›´è§‚çš„è¡¨æ ¼ï¼š</p>






















































<table><thead><tr><th align="left">æµ‹è¯•æ–¹æ³•</th><th align="left">å¹³å‡è€—æ—¶ (ns)</th><th align="left">å¹³å‡è€—æ—¶ (ms)</th><th align="left">ç›¸å¯¹æ€§èƒ½å€ç‡</th><th align="left">è¯¯å·®èŒƒå›´ (Â±)</th></tr></thead><tbody><tr><td align="left"><strong>testApacheCommons</strong></td><td align="left">239,955,526 ns</td><td align="left"><strong>240 ms</strong></td><td align="left"><strong>1.0x</strong> (æœ€å¿«)</td><td align="left">Â±8.8 ms</td></tr><tr><td align="left"><strong>testTraditionalIfElse</strong></td><td align="left">501,893,983 ns</td><td align="left"><strong>502 ms</strong></td><td align="left">2.09x (æ…¢109%)</td><td align="left">Â±7.0 ms</td></tr><tr><td align="left"><strong>testTraditionalChain</strong></td><td align="left">526,397,960 ns</td><td align="left"><strong>526 ms</strong></td><td align="left">2.19x (æ…¢119%)</td><td align="left">Â±24.0 ms</td></tr><tr><td align="left"><strong>testStringButlerBasic</strong></td><td align="left">560,111,555 ns</td><td align="left"><strong>560 ms</strong></td><td align="left">2.33x (æ…¢133%)</td><td align="left">Â±18.1 ms</td></tr><tr><td align="left"><strong>testStringButlerComplex</strong></td><td align="left">1,011,401,090 ns</td><td align="left"><strong>1,011 ms</strong></td><td align="left">4.21x (æ…¢321%)</td><td align="left">Â±32.5 ms</td></tr><tr><td align="left"><strong>testStringButlerFull</strong></td><td align="left">1,548,874,040 ns</td><td align="left"><strong>1,549 ms</strong></td><td align="left">6.45x (æ…¢545%)</td><td align="left">Â±102.3 ms</td></tr></tbody></table>
<p><strong>å…³é”®å‘ç°</strong>ï¼š</p>
<ol>
<li><strong>æ€§èƒ½å† å†›</strong>ï¼š<code>ApacheCommons</code> æ–¹æ³•æ˜æ˜¾æœ€å¿«ï¼Œè€—æ—¶çº¦ <strong>240ms</strong>ï¼Œæ¯”å…¶ä»–æ–¹æ³•å¿« <strong>2-6.5å€</strong></li>
<li><strong>æ€§èƒ½åˆ†ç»„</strong>ï¼š
<ul>
<li><strong>é«˜æ•ˆç»„</strong> (~240-560ms)ï¼šApacheCommonsã€ä¼ ç»Ÿæ–¹æ³•</li>
<li><strong>ä¸­æ•ˆç»„</strong> (~1,011ms)ï¼šStringButler å¤æ‚ç‰ˆæœ¬</li>
<li><strong>ä½æ•ˆç»„</strong> (~1,549ms)ï¼šStringButler å®Œæ•´ç‰ˆæœ¬</li>
</ul>
</li>
<li><strong>ç¨³å®šæ€§åˆ†æ</strong>ï¼š
<ul>
<li>è¯¯å·®æœ€å°çš„ï¼š<code>testTraditionalIfElse</code> (Â±7.0ms)ï¼Œè¡¨ç°ç¨³å®š</li>
<li>è¯¯å·®æœ€å¤§çš„ï¼š<code>testStringButlerFull</code> (Â±102.3ms)ï¼Œæ€§èƒ½æ³¢åŠ¨è¾ƒå¤§</li>
</ul>
</li>
<li><strong>StringButler æ€§èƒ½é˜¶æ¢¯</strong>ï¼š
<ul>
<li>Basic ç‰ˆæœ¬ï¼š560ms (æ¯”ä¼ ç»Ÿæ–¹æ³•ç•¥æ…¢)</li>
<li>Complex ç‰ˆæœ¬ï¼š1,011ms (æ€§èƒ½æ˜¾è‘—ä¸‹é™)</li>
<li>Full ç‰ˆæœ¬ï¼š1,549ms (æ€§èƒ½æœ€å·®)</li>
</ul>
</li>
</ol>
<h3 data-id="heading-17">6.6 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</h3>
<p>StringButleråœ¨æ€§èƒ½æ–¹é¢åšäº†ä»¥ä¸‹ä¼˜åŒ–ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. ç¼“å­˜å¸¸ç”¨æ¨¡å¼ï¼ˆPatternCacheï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PatternCache</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Map&lt;String, Pattern&gt; CACHE = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Pattern <span class="hljs-title function_">getPattern</span><span class="hljs-params">(String regex)</span> {
        <span class="hljs-comment">// åŒé‡æ£€æŸ¥é”å®šï¼Œé¿å…é‡å¤ç¼–è¯‘æ­£åˆ™</span>
        <span class="hljs-type">Pattern</span> <span class="hljs-variable">pattern</span> <span class="hljs-operator">=</span> CACHE.get(regex);
        <span class="hljs-keyword">if</span> (pattern == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">synchronized</span> (PatternCache.class) {
                pattern = CACHE.get(regex);
                <span class="hljs-keyword">if</span> (pattern == <span class="hljs-literal">null</span>) {
                    pattern = Pattern.compile(regex);
                    CACHE.put(regex, pattern);
                }
            }
        }
        <span class="hljs-keyword">return</span> pattern;
    }
}

<span class="hljs-comment">// 2. å»¶è¿ŸéªŒè¯ï¼šåªæœ‰è°ƒç”¨validate()æ—¶æ‰æ‰§è¡ŒéªŒè¯</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ValidationChain</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;ValidationRule&gt; rules = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    
    <span class="hljs-keyword">public</span> StringButler <span class="hljs-title function_">validate</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// åªæœ‰åœ¨è°ƒç”¨validate()æ—¶æ‰çœŸæ­£æ‰§è¡ŒéªŒè¯</span>
        <span class="hljs-keyword">for</span> (ValidationRule rule : rules) {
            <span class="hljs-keyword">if</span> (!rule.validate(butler.getValue())) {
                butler.addValidationError(rule.getErrorMessage());
                <span class="hljs-keyword">if</span> (stopOnFirstFailure) <span class="hljs-keyword">break</span>;
            }
        }
        <span class="hljs-keyword">return</span> butler;
    }
}

<span class="hljs-comment">// 3. StringBuilderé‡ç”¨ï¼ˆåœ¨å†…éƒ¨è½¬æ¢ä¸­ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TransformationChain</span> {
    <span class="hljs-keyword">public</span> StringButler <span class="hljs-title function_">transform</span><span class="hljs-params">()</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> butler.getValue();
        <span class="hljs-comment">// é‡ç”¨StringBuilderï¼Œé¿å…å¤šæ¬¡åˆ›å»º</span>
        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>(current);
        <span class="hljs-keyword">for</span> (TransformationRule rule : rules) {
            current = rule.transform(current);
        }
        butler.setCurrentValue(current);
        <span class="hljs-keyword">return</span> butler;
    }
}
</code></pre>
<h3 data-id="heading-18">6.7 æ€§èƒ½ç»“è®º</h3>
<p><strong>å…³é”®æ´å¯Ÿ</strong>ï¼š</p>
<ol>
<li><strong>æ€§èƒ½å¼€é”€æ˜¯çœŸå®å­˜åœ¨çš„</strong>ï¼šStringButlerç›¸æ¯”ä¼ ç»Ÿæ–¹å¼ç¡®å®æœ‰ä¸€å®šçš„æ€§èƒ½å¼€é”€</li>
<li><strong>ä½†æ€§ä»·æ¯”å¾ˆé«˜</strong>ï¼šç”¨å¤±å»çš„æ€§èƒ½æ¢æ¥äº†ï¼ˆè€ç”Ÿå¸¸è°ˆï¼š<strong>ä¸å–œå‹¿å–·</strong>ï¼‰ï¼š
<ul>
<li>ä»£ç å¯è¯»æ€§æå‡200%ä»¥ä¸Š</li>
<li>ç»´æŠ¤æˆæœ¬é™ä½50%ä»¥ä¸Š</li>
<li>é”™è¯¯ç‡æ˜¾è‘—é™ä½</li>
<li>åŠŸèƒ½æ‰©å±•æ€§æå¼º</li>
</ul>
</li>
<li><strong>é€‚ç”¨åœºæ™¯åˆ†æ</strong>ï¼š
<ul>
<li><strong>æ¨èä½¿ç”¨</strong>ï¼šWebåº”ç”¨ã€ä¸šåŠ¡ç³»ç»Ÿã€é…ç½®å¤„ç†ç­‰I/Oå¯†é›†å‹åœºæ™¯</li>
<li><strong>è°¨æ…ä½¿ç”¨</strong>ï¼šé«˜é¢‘äº¤æ˜“ç³»ç»Ÿã€å®æ—¶æ•°æ®å¤„ç†ç­‰CPUå¯†é›†å‹åœºæ™¯</li>
<li><strong>å®Œç¾é€‚ç”¨</strong>ï¼šä»£ç è´¨é‡è¦æ±‚é«˜ã€å›¢é˜Ÿåä½œã€é•¿æœŸç»´æŠ¤çš„é¡¹ç›®</li>
</ul>
</li>
</ol>
<h2 data-id="heading-19">ä¸ƒã€å¼€æºä¸–ç•Œä¸­çš„é“¾å¼è°ƒç”¨è‰ºæœ¯</h2>
<p>é“¾å¼è°ƒç”¨å¦‚æ­¤çš„ç¾ï¼ˆæˆ‘è®¤ä¸ºï¼‰ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹é‚£äº›ä¼˜ç§€çš„å¼€æºé¡¹ç›®æ˜¯å¦‚ä½•è¿ç”¨è¿™ä¸€è®¾è®¡è‰ºæœ¯çš„ï¼š</p>
<h3 data-id="heading-20">7.1 Springæ¡†æ¶çš„é“¾å¼å®‰å…¨é…ç½®</h3>
<p>Spring Securityçš„é…ç½®APIå ªç§°é“¾å¼è°ƒç”¨çš„ç»å…¸ä¹‹ä½œï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@EnableWebSecurity</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SecurityConfig</span> {

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> SecurityFilterChain <span class="hljs-title function_">filterChain</span><span class="hljs-params">(HttpSecurity http)</span> <span class="hljs-keyword">throws</span> Exception {
        http
            .authorizeHttpRequests(authz -&gt; authz
                <span class="hljs-comment">// æ³¨æ„ï¼šåœ¨ Spring Security 6.0+ ä¸­ï¼ŒantMatchers å·²è¢«å¼ƒç”¨ï¼Œæ”¹ç”¨ requestMatchers</span>
                .requestMatchers(<span class="hljs-string">"/admin/**"</span>).hasRole(<span class="hljs-string">"ADMIN"</span>)
                .requestMatchers(<span class="hljs-string">"/user/**"</span>).hasAnyRole(<span class="hljs-string">"USER"</span>, <span class="hljs-string">"ADMIN"</span>)
                .requestMatchers(<span class="hljs-string">"/"</span>, <span class="hljs-string">"/home"</span>, <span class="hljs-string">"/register"</span>).permitAll()
                .anyRequest().authenticated()
            )
            .formLogin(form -&gt; form
                .loginPage(<span class="hljs-string">"/login"</span>)
                .permitAll()
            )
            .logout(logout -&gt; logout
                .logoutSuccessUrl(<span class="hljs-string">"/login?logout"</span>)
                .permitAll()
            );

        <span class="hljs-keyword">return</span> http.build();
    }
}
</code></pre>
<p><strong>è®¾è®¡äº®ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>è§†è§‰è¿è´¯æ€§</strong>ï¼šä»ä¸Šåˆ°ä¸‹é˜…è¯»ä»£ç ï¼Œå°±æ˜¯å®‰å…¨ç­–ç•¥çš„æ‰§è¡Œé¡ºåº</li>
<li><strong>ç»ˆç‚¹æ˜ç¡®</strong>ï¼š<code>.build()</code>æ ‡å¿—ç€é…ç½®çš„å®Œæˆï¼Œé¿å…é…ç½®é—æ¼</li>
<li><strong>é€»è¾‘å†…èš</strong>ï¼šæ‰€æœ‰ç›¸å…³é…ç½®èšé›†åœ¨ä¸€ä¸ªâ€œæµâ€ä¸­</li>
</ul>
<h3 data-id="heading-21">7.2 MyBatis-Plusçš„æ¡ä»¶æ„é€ å™¨</h3>
<p>MyBatis-Plus çš„<code>QueryWrapper</code>å’Œ<code>UpdateWrapper</code>æ˜¯é“¾å¼è°ƒç”¨çš„å¦ä¸€å…¸èŒƒï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æŸ¥è¯¢æ¡ä»¶æ„é€ </span>
QueryWrapper&lt;User&gt; queryWrapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">QueryWrapper</span>&lt;&gt;();
queryWrapper
    .select(<span class="hljs-string">"id"</span>, <span class="hljs-string">"name"</span>, <span class="hljs-string">"email"</span>, <span class="hljs-string">"age"</span>)  <span class="hljs-comment">// é€‰æ‹©å­—æ®µ</span>
    .like(<span class="hljs-string">"name"</span>, <span class="hljs-string">"å¼ %"</span>)                     <span class="hljs-comment">// æ¨¡ç³ŠæŸ¥è¯¢</span>
    .between(<span class="hljs-string">"age"</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>)                <span class="hljs-comment">// èŒƒå›´æŸ¥è¯¢</span>
    .eq(<span class="hljs-string">"status"</span>, <span class="hljs-number">1</span>)                       <span class="hljs-comment">// ç­‰å€¼æŸ¥è¯¢</span>
    .isNotNull(<span class="hljs-string">"email"</span>)                    <span class="hljs-comment">// éç©ºåˆ¤æ–­</span>
    .orderByDesc(<span class="hljs-string">"create_time"</span>)            <span class="hljs-comment">// æ’åº</span>
</code></pre>
<p><strong>è®¾è®¡äº®ç‚¹</strong>ï¼š</p>
<ul>
<li>æ”¯æŒSQLè¯­æ³•çš„è‡ªç„¶æ˜ å°„ï¼š<code>.eq()</code>å¯¹åº”<code>=</code>ï¼Œ<code>.like()</code>å¯¹åº”<code>LIKE</code></li>
<li>çµæ´»çš„é“¾å¼ç»„åˆï¼šæ”¯æŒ<code>.or()</code>ã€<code>.and()</code>ç­‰é€»è¾‘è¿æ¥</li>
<li>ç±»å‹å®‰å…¨ï¼šé€šè¿‡æ³›å‹ä¿è¯æ¡ä»¶æ„é€ çš„ç±»å‹æ­£ç¡®æ€§</li>
</ul>
<h3 data-id="heading-22">7.3 Java 8 Stream APIçš„é©å‘½</h3>
<p>Java 8å¼•å…¥çš„ <strong>Stream API</strong> æ˜¯å®˜æ–¹å¯¹é“¾å¼è°ƒç”¨çš„æœ€ä½³å®è·µï¼š</p>
<pre><code class="hljs language-java" lang="java">List&lt;String&gt; processedNames = users.stream()
    .filter(user -&gt; user.getAge() &gt; <span class="hljs-number">18</span>)           <span class="hljs-comment">// è¿‡æ»¤ï¼šåªä¿ç•™æˆå¹´äºº</span>
    .map(user -&gt; user.getName().trim())           <span class="hljs-comment">// è½¬æ¢ï¼šè·å–å§“åå¹¶å»ç©ºæ ¼</span>
    .filter(name -&gt; !name.isEmpty())              <span class="hljs-comment">// å†è¿‡æ»¤ï¼šå»é™¤ç©ºå§“å</span>
    .distinct()                                   <span class="hljs-comment">// å»é‡</span>
    .sorted()                                     <span class="hljs-comment">// æ’åº</span>
    .limit(<span class="hljs-number">10</span>)                                    <span class="hljs-comment">// é™åˆ¶æ•°é‡</span>
    .collect(Collectors.toList());                <span class="hljs-comment">// æ”¶é›†ç»“æœ</span>

<span class="hljs-comment">// æ›´å¤æ‚çš„å¹¶è¡Œæµå¤„ç†</span>
Map&lt;Department, Double&gt; avgSalaryByDept = employees.parallelStream()
    .filter(emp -&gt; emp.getStatus() == Status.ACTIVE)
    .collect(Collectors.groupingBy(
        Employee::getDepartment,                  <span class="hljs-comment">// æŒ‰éƒ¨é—¨åˆ†ç»„</span>
        Collectors.averagingDouble(Employee::getSalary)  <span class="hljs-comment">// è®¡ç®—å¹³å‡è–ªèµ„</span>
    ));
</code></pre>
<p><strong>è®¾è®¡äº®ç‚¹</strong>ï¼š</p>
<ul>
<li>æƒ°æ€§æ±‚å€¼ï¼šä¸­é—´æ“ä½œï¼ˆfilterã€mapç­‰ï¼‰ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ç»ˆç«¯æ“ä½œï¼ˆcollectï¼‰</li>
<li>æ¸…æ™°çš„æ“ä½œåˆ†ç±»ï¼šä¸­é—´æ“ä½œï¼ˆè¿”å›Streamï¼‰å’Œç»ˆç«¯æ“ä½œï¼ˆè¿”å›ç»“æœæˆ–å‰¯ä½œç”¨ï¼‰</li>
<li>æ”¯æŒå¹¶è¡Œå¤„ç†ï¼šåªéœ€å°†<code>.stream()</code>æ”¹ä¸º<code>.parallelStream()</code></li>
</ul>
<h3 data-id="heading-23">7.4 OkHttpçš„è¯·æ±‚æ„å»ºå™¨</h3>
<p>OkHttpæ˜¯æ¯”è¾ƒæµè¡Œçš„HTTPå®¢æˆ·ç«¯ï¼Œå…¶è¯·æ±‚æ„å»ºå™¨ä¹Ÿæ˜¯é“¾å¼è°ƒç”¨çš„ä¼˜ç§€æ¡ˆä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ„å»ºä¸€ä¸ªå¤æ‚çš„HTTPè¯·æ±‚</span>
<span class="hljs-type">Request</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Request</span>.Builder()
    .url(<span class="hljs-string">"https://api.github.com/users/iweidujiang"</span>)
    .header(<span class="hljs-string">"User-Agent"</span>, <span class="hljs-string">"StringButler-Demo"</span>)
    .header(<span class="hljs-string">"Accept"</span>, <span class="hljs-string">"application/json"</span>)
    .addHeader(<span class="hljs-string">"Authorization"</span>, <span class="hljs-string">"Bearer "</span> + token)
    .post(RequestBody.create(
        <span class="hljs-string">"{\"query\": \"string butler\"}"</span>,
        MediaType.parse(<span class="hljs-string">"application/json"</span>)
    ))
    .tag(<span class="hljs-string">"github-api-request"</span>)
    .build();

<span class="hljs-comment">// å‘é€å¼‚æ­¥è¯·æ±‚</span>
okHttpClient.newCall(request).enqueue(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Callback</span>() {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onResponse</span><span class="hljs-params">(Call call, Response response)</span> {
        <span class="hljs-comment">// å¤„ç†å“åº”</span>
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onFailure</span><span class="hljs-params">(Call call, IOException e)</span> {
        <span class="hljs-comment">// å¤„ç†å¤±è´¥</span>
    }
});
</code></pre>
<p><strong>è®¾è®¡äº®ç‚¹</strong>ï¼š</p>
<ul>
<li>æ„å»ºå™¨æ¨¡å¼ï¼š<code>Request.Builder</code>ä¸“é—¨ç”¨äºæ„å»ºå¤æ‚çš„<code>Request</code>å¯¹è±¡</li>
<li>é“¾å¼é…ç½®ï¼šå¯ä»¥è¿ç»­è®¾ç½®URLã€å¤´ä¿¡æ¯ã€è¯·æ±‚ä½“ç­‰</li>
<li>ä¸å¯å˜å¯¹è±¡ï¼šä¸€æ—¦è°ƒç”¨<code>.build()</code>ï¼Œè¿”å›çš„å°±æ˜¯ä¸å¯å˜çš„<code>Request</code>å¯¹è±¡</li>
</ul>
<h3 data-id="heading-24">7.5 Guavaçš„é“¾å¼é›†åˆæ“ä½œ</h3>
<p>Google Guavaåº“ä¸­çš„é›†åˆæ“ä½œä¹Ÿå¤§é‡ä½¿ç”¨é“¾å¼è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä½¿ç”¨Guavaåˆ›å»ºä¸å¯å˜é›†åˆ</span>
ImmutableList&lt;String&gt; colors = ImmutableList.&lt;String&gt;builder()
    .add(<span class="hljs-string">"red"</span>)
    .add(<span class="hljs-string">"green"</span>)
    .add(<span class="hljs-string">"blue"</span>)
    .addAll(existingList)  <span class="hljs-comment">// æ·»åŠ ç°æœ‰é›†åˆ</span>
    .build();

<span class="hljs-comment">// é“¾å¼çš„é›†åˆæ“ä½œ</span>
List&lt;String&gt; result = FluentIterable.from(users)
    .filter(User::isActive)
    .transform(User::getName)  <span class="hljs-comment">// ç›¸å½“äºStreamçš„map</span>
    .filter(Predicates.notNull())
    .limit(<span class="hljs-number">100</span>)
    .toList();
</code></pre>
<h2 data-id="heading-25">å…«ã€é“¾å¼è°ƒç”¨çš„è®¾è®¡æ¨¡å¼å‰–æ</h2>
<p>é“¾å¼è°ƒç”¨çš„æˆåŠŸç¦»ä¸å¼€å‡ ä¸ªå…³é”®è®¾è®¡æ¨¡å¼ï¼š</p>
<ul>
<li>å»ºé€ è€…æ¨¡å¼ï¼ˆBuilder Patternï¼‰</li>
<li>æµç•…æ¥å£æ¨¡å¼ï¼ˆFluent Interfaceï¼‰</li>
<li>æ–¹æ³•é“¾æ¨¡å¼ï¼ˆMethod Chainingï¼‰</li>
</ul>
<h2 data-id="heading-26">ä¹ã€StringButlerçš„è®¾è®¡åˆ›æ–°</h2>
<p>StringButleråœ¨å€Ÿé‰´è¿™äº›ä¼˜ç§€è®¾è®¡çš„åŸºç¡€ä¸Šï¼Œæœ‰è‡ªå·±çš„åˆ›æ–°ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// StringButlerçš„é“¾å¼è®¾è®¡èåˆäº†å¤šç§æ¨¡å¼</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StringButler</span> {
    
    <span class="hljs-comment">// 1. å»ºé€ è€…æ¨¡å¼ï¼šå·¥å‚æ–¹æ³•åˆ›å»ºå®ä¾‹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> StringButler <span class="hljs-title function_">of</span><span class="hljs-params">(String value)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringButler</span>(value);
    }
    
    <span class="hljs-comment">// 2. æµç•…æ¥å£ï¼šæ”¯æŒè½¬æ¢é“¾å’ŒéªŒè¯é“¾çš„åˆ‡æ¢</span>
    <span class="hljs-keyword">public</span> TransformationChain <span class="hljs-title function_">transform</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformationChain</span>(<span class="hljs-built_in">this</span>);
    }
    
    <span class="hljs-keyword">public</span> ValidationChain <span class="hljs-title function_">validate</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ValidationChain</span>(<span class="hljs-built_in">this</span>);
    }
    
    <span class="hljs-comment">// 3. ç­–ç•¥æ¨¡å¼ï¼šå¤šç§å¤„ç†ç­–ç•¥</span>
    <span class="hljs-keyword">public</span> StringButler <span class="hljs-title function_">ifBlank</span><span class="hljs-params">(String defaultValue, BlankStrategy strategy)</span> {
        <span class="hljs-comment">// æ ¹æ®ç­–ç•¥å¤„ç†ç©ºç™½å­—ç¬¦ä¸²</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
    }
}
</code></pre>
<p><strong>StringButler ä½¿ç”¨çš„è®¾è®¡</strong>ï¼š</p>
<ol>
<li><strong>åŒé“¾è®¾è®¡</strong>ï¼šè½¬æ¢é“¾å’ŒéªŒè¯é“¾åˆ†ç¦»ï¼ŒèŒè´£æ¸…æ™°</li>
<li><strong>ç­–ç•¥é›†æˆ</strong>ï¼šå°†ç­–ç•¥æ¨¡å¼è‡ªç„¶èå…¥é“¾å¼è°ƒç”¨</li>
<li><strong>ç»“æœåŒ…è£…</strong>ï¼šç»Ÿä¸€çš„<code>StringButlerResult</code>åŒ…è£…å¤„ç†ç»“æœ</li>
</ol>
<h2 data-id="heading-27">åã€æ€§èƒ½å†æ€è€ƒï¼šé“¾å¼è°ƒç”¨çš„æ€§ä»·æ¯”</h2>
<p>ç»è¿‡å®é™…çš„æ€§èƒ½æµ‹è¯•ï¼Œè™½ç„¶æ€§èƒ½ä¸Šè¡¨ç°ä¸è¶³ï¼Œä½†ï¼š</p>
<ol>
<li><strong>å¯¹äº99%çš„åº”ç”¨åœºæ™¯</strong>ï¼ŒStringButlerçš„æ€§èƒ½å¼€é”€æ˜¯å¯ä»¥æ¥å—çš„</li>
<li><strong>æ€§èƒ½ä¸æ˜¯å”¯ä¸€æŒ‡æ ‡</strong>ï¼šä»£ç çš„å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§ã€å¯æ‰©å±•æ€§åŒæ ·é‡è¦</li>
<li><strong>çœŸå®çš„æ€§èƒ½å½±å“</strong>ï¼šåœ¨å…¸å‹çš„Webåº”ç”¨ä¸­ï¼Œå­—ç¬¦ä¸²å¤„ç†é€šå¸¸å æ€»å¤„ç†æ—¶é—´å¾ˆå°‘ï¼Œå› æ­¤è¿™äº›æ€§èƒ½å¼€é”€åœ¨å®é™…ä¸­å¯èƒ½åªå¸¦æ¥å¾®ä¹å…¶å¾®çš„æ•´ä½“å½±å“</li>
</ol>
<p><strong>å»ºè®®</strong>ï¼šä¸è¦å› ä¸ºå®³æ€•æ€§èƒ½é—®é¢˜è€Œæ”¾å¼ƒä¼˜ç§€çš„APIè®¾è®¡ã€‚å…ˆå†™å‡ºæ¸…æ™°ã€å¯ç»´æŠ¤çš„ä»£ç ï¼Œç„¶ååŸºäºå®é™…çš„æ€§èƒ½åˆ†æè¿›è¡Œä¼˜åŒ–ã€‚</p>
<h2 data-id="heading-28">åä¸€ã€æ¯›é‚è‡ªè</h2>
<p>è¯´åˆ°è¿™é‡Œï¼Œæˆ‘å¿…é¡»å¹¿è€Œå‘Šä¹‹ä¸€ä¸‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fiweidujiang%2Fstring-butler" target="_blank" title="https://github.com/iweidujiang/string-butler" ref="nofollow noopener noreferrer"><strong>StringButler</strong></a>ã€‚</p>
<h3 data-id="heading-29">å¿«é€Ÿä½“éªŒ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…‹éš†é¡¹ç›®</span>
git <span class="hljs-built_in">clone</span> https://github.com/iweidujiang/string-butler.git

<span class="hljs-comment"># ç¼–è¯‘å®‰è£…</span>
<span class="hljs-built_in">cd</span> string-butler
mvn clean install

<span class="hljs-comment"># åœ¨é¡¹ç›®ä¸­ä½¿ç”¨</span>
</code></pre>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- æš‚æ—¶æ·»åŠ åˆ°æœ¬åœ°ä½¿ç”¨ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.github.iweidujiang<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>string-butler<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>å¦‚æœä½ è§‰å¾—è¿™ä¸ªè®¾è®¡æ€æƒ³å¯¹ä½ æœ‰å¸®åŠ©ï¼Œç»™é¡¹ç›®ç‚¹ä¸ªâ­ï¸Starâ­ï¸å°±æ˜¯å¯¹æˆ‘æœ€å¤§çš„é¼“åŠ±ï¼</p>
<p>ä½ çš„Starä¸ä»…æ˜¯å¯¹ä½œè€…çš„è®¤å¯ï¼Œä¹Ÿèƒ½è®©æ›´å¤šå¼€å‘è€…çœ‹åˆ°è¿™ä¸ªé¡¹ç›®ã€‚</p>
<h2 data-id="heading-30">åäºŒã€å‡ºå‡ é“é¢˜</h2>
<p>åœ¨ä½ ç¦»å¼€å‰ï¼Œæ€è€ƒä¸€ä¸‹å¦‚ä¸‹é—®é¢˜ï¼š</p>
<blockquote>
<p>ä½ å½“å‰çš„é¡¹ç›®ä¸­ï¼Œæœ‰å“ªäº›ä»£ç å¯ä»¥æ”¹é€ æˆé“¾å¼APIï¼Ÿ</p>
<p>è¯•ç€æ‰¾å‡º3ä¸ªå€™é€‰ï¼š</p>
<ol>
<li>é‚£ä¸ªå……æ»¡<code>if</code>åˆ¤æ–­çš„éªŒè¯é€»è¾‘ï¼Ÿï¼ˆå‚è€ƒStringButlerï¼‰</li>
<li>é‚£ä¸ªéœ€è¦å¤šä¸ªæ­¥éª¤çš„æ•°æ®è½¬æ¢è¿‡ç¨‹ï¼Ÿï¼ˆå‚è€ƒStream APIï¼‰</li>
<li>é‚£ä¸ªå¤æ‚çš„é…ç½®æ„å»ºå™¨ï¼Ÿï¼ˆå‚è€ƒSpring Securityï¼‰</li>
</ol>
</blockquote>
<p><strong>æ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„æƒ³æ³•</strong>ï¼Œæˆ–è€…åˆ°StringButlerçš„GitHubä»“åº“æäº¤Issueè®¨è®ºï¼</p>
<hr/>
<p><em>æœ¬æ–‡æ˜¯ã€ŠStringButlerè®¾è®¡å“²å­¦ä¸å®æˆ˜ã€‹ç³»åˆ—çš„ç¬¬ä¸€ç¯‡ã€‚</em></p>
<p><em>å¦‚æœä½ å¯¹è¿™ä¸ªç³»åˆ—æ„Ÿå…´è¶£ï¼Œè®°å¾—å…³æ³¨æˆ‘çš„åšå®¢æ›´æ–°å“¦ï¼</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å»å“ªå„¿é«˜å³°æœŸèµ„æºä¿éšœä¹‹æ™ºèƒ½æ‰©ç¼©å®¹]]></title>    <link>https://juejin.cn/post/7598021984300417051</link>    <guid>https://juejin.cn/post/7598021984300417051</guid>    <pubDate>2026-01-23T02:23:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598021984300417051" data-draft-id="7597997108135002139" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å»å“ªå„¿é«˜å³°æœŸèµ„æºä¿éšœä¹‹æ™ºèƒ½æ‰©ç¼©å®¹"/> <meta itemprop="keywords" content="è¿ç»´,åç«¯"/> <meta itemprop="datePublished" content="2026-01-23T02:23:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å»å“ªå„¿æŠ€æœ¯æ²™é¾™"/> <meta itemprop="url" content="https://juejin.cn/user/2251436075786791"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å»å“ªå„¿é«˜å³°æœŸèµ„æºä¿éšœä¹‹æ™ºèƒ½æ‰©ç¼©å®¹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2251436075786791/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å»å“ªå„¿æŠ€æœ¯æ²™é¾™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T02:23:49.000Z" title="Fri Jan 23 2026 02:23:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€èƒŒæ™¯</h2>
<p>ä¸€äº›æµé‡çªå¢äº‹ä»¶å¦‚è€ƒç ”ã€å›½è€ƒå‡†è€ƒè¯æ‰“å°é«˜å³°æœŸç­‰ï¼Œä¼šå¯¼è‡´é…’åº—ä¸šåŠ¡é‡éª¤å¢ï¼Œå¦‚æœè¶…å‡ºåº”ç”¨æ‰¿è½½ä¸Šé™ï¼Œä¼šå¼•èµ·æœåŠ¡æ€§èƒ½ä¸¥é‡ä¸‹é™ï¼Œé™æµæˆ–å´©æºƒç­‰é£é™©ï¼Œå¯¹ç”Ÿäº§å¸¦æ¥æŸå®³ã€‚</p>
<p>å¦å¤–äº”ä¸€åä¸€ç­‰å‡ºæ¸¸é«˜å³°, è™½ç„¶æœ‰HPAï¼ˆHorizontal Pod Autoscalerï¼‰, ä½†åœ¨åšç¨³å®šæ€§ä¿éšœæ—¶ï¼Œéœ€è¦æ‰‹åŠ¨å»è®¡ç®—å„ç³»ç»Ÿæ‰©å®¹æœºå™¨æ•°å¹¶æ‰‹åŠ¨è¿›è¡Œæ‰©å®¹å’Œç¼©å®¹, è®¡ç®—ç²¾åº¦ä¸è¶³ä¸”æ•ˆç‡ä½ä¸‹ã€‚</p>
<p>æ‰€ä»¥å¦‚æœèƒ½æå‰è¯„ä¼°äº‹ä»¶å½±å“ï¼Œé¢„ä¼°æ‰€éœ€å®¹é‡ï¼Œå¯¹å—å½±å“çš„æœåŠ¡æå‰è‡ªåŠ¨æ‰©å®¹ï¼Œå¯¹ä¿éšœçº¿ä¸ŠæœåŠ¡çš„ç¨³å®šæ€§çš„åŒæ—¶æå‡è¿ç»´æ•ˆç‡æ˜¯éå¸¸æœ‰ä»·å€¼çš„ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2512dd1c65e647f09b37485be6e0cd13~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769739828&amp;x-signature=jyt3q1iId77DHPg6PZOcIBWgrl4%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">**äºŒã€**<strong>æ•´ä½“æ–¹æ¡ˆ</strong></h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ddb4e9172d4540ad8cfe08abea901510~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769739828&amp;x-signature=TxQGVDVFZkmQQqEWBrWSgSD5ggI%3D" alt="" loading="lazy"/></p>
<p>è¦†ç›–äº‹ä»¶ç±»å‹ï¼š</p>
<p>EXAMï¼šå‡†è€ƒè¯æ‰“å°ç±»äº‹ä»¶ï¼ˆå¦‚è€ƒç ”ã€å›½è€ƒï¼‰ï¼Œä¸€èˆ¬ä¼šå¸¦æ¥é…’åº—çš„ä¸šåŠ¡çªå¢</p>
<p>HOLIDAYï¼šæ—…æ¸¸ï¼Œå‡ºè¡Œå…·æœ‰å¾ˆå¼ºçš„èŠ‚å‡æ—¥æ•ˆåº”ï¼Œå¤§å‹çš„èŠ‚å‡æ—¥ä¸€èˆ¬ä¼šå‘ˆç°é¢„æœŸå†…çš„ä¸šåŠ¡é«˜å³°ï¼Œæ— çªå¢ç°è±¡</p>
<p>ACTIVITYï¼šä¿ƒé”€ç±»æ´»åŠ¨ï¼Œå¦‚å¤§ä¿ƒã€ç§’æ€ç­‰ï¼Œä¼šå¸¦æ¥ä¸šåŠ¡çªå¢</p>
<h3 data-id="heading-2"><strong>1.ç³»ç»Ÿç»“æ„å›¾</strong></h3>
<p>(1)æµé‡æ—¥å†å¹³å°æ•´åˆä¸šåŠ¡ç›‘æ§ï¼Œè¿ç»´å›¢é˜Ÿï¼ˆOpsï¼‰æä¾›åº”ç”¨+ç¯å¢ƒç»´åº¦ä¸‹CPUæ ¸æ•°æ•°æ®ï¼Œå¹³å°é€šè¿‡æ¥å£æä¾›ç»™ç®—æ³•å›¢é˜Ÿæå‰è¿›è¡Œæ¨¡å‹è®­ç»ƒã€‚</p>
<p>(2)æµé‡å¹³å°ç¡®å®šä¸šåŠ¡é¢„ä¼°æœ€é«˜å³°è®¢å•å€¼/qpså€¼ï¼Œè°ƒç”¨ç®—æ³•å¹³å°å‘èµ·é¢„æµ‹ä»»åŠ¡. ç®—æ³•ç»„å°†ä¸šåŠ¡é¢„ä¼°é«˜å³°å€¼è½¬æ¢ä¸ºé«˜å³°åœºæ™¯ä¸‹åº”ç”¨é¢„è®¡ä½¿ç”¨CPUæ€»æ ¸æ•°ç»™åˆ°æµé‡å¹³å°ã€‚</p>
<p>(3)æµé‡å¹³å°è°ƒç”¨Opsæ¥å£, å°†CPUæ€»æ ¸æ•°ç»™åˆ°Ops, Opså°†CPUæ€»æ ¸æ•°è½¬æ¢æˆé¢„ä¼°å®ä¾‹æ•°. å¹¶è®¾å®šå®šæ—¶è‡ªåŠ¨æ‰©ç¼©å®¹å®ä¾‹ä»»åŠ¡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6b28c2257ca143cf9d1578b27bfe3212~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769739828&amp;x-signature=Jz%2FAy6bdDnkrU4InCgnKh%2BvXdLw%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-3">2.ä¸šåŠ¡æµç¨‹ä»‹ç»</h3>
<p>æµé‡æ—¥å†äº‹ä»¶ç”Ÿå‘½å‘¨æœŸåˆ†ä¸ºä¹ä¸ªé˜¶æ®µï¼ŒåŒ…å«é¢„åˆ¤â†’å¾…è¯„ä¼°â†’è¯„ä¼°ä¸­â†’è¯„ä¼°å®Œæˆâ†’ä»»åŠ¡åˆ›å»ºâ†’æ‰©å®¹ä¸­â†’æ‰©å®¹å®Œæˆâ†’å¤ç›˜â†’ç»“æŸã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/85800011ee52482f8c878b85dff52c4e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769739828&amp;x-signature=MPkO%2FjTVmk8GPDH%2BBZG0NlmzJ%2F0%3D" alt="" loading="lazy"/></p>
<p><strong>ï¼ˆ1ï¼‰çƒ­ç‚¹äº‹ä»¶å½•å…¥</strong></p>
<p>äº‹ä»¶æ¥æºï¼šæ”¯æŒæºç¨‹çƒ­ç‚¹äº‹ä»¶åŒæ­¥+äººå·¥åˆ›å»ºäº‹ä»¶ä¸¤ç§æ–¹å¼å½•å…¥ , äº‹ä»¶å½•å…¥åï¼Œè¿›å…¥é¢„åˆ¤çŠ¶æ€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dd1d5dcafe0447e6a103702d3cf016ce~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769739828&amp;x-signature=aiDuhkG3E%2B8lKUkncnOPoS2sIC4%3D" alt="" loading="lazy"/></p>
<p><strong>ï¼ˆ2ï¼‰äº‹ä»¶é¢„åˆ¤</strong></p>
<p>æ ¹æ®äº‹ä»¶å…·ä½“æƒ…å†µåˆ¤å®šæœ¬æ¬¡äº‹ä»¶æ˜¯å¦éœ€è¦è‡ªåŠ¨æ‰©ç¼©å®¹ã€‚å¦‚åˆ¤å®šå¦ï¼Œè¿›å…¥ç»“æŸçŠ¶æ€, å¦‚åˆ¤æ–­æ˜¯ï¼Œè¿›å…¥å¾…è¯„ä¼°ä¸šåŠ¡é‡é˜¶æ®µ (å¾…è¯„ä¼°çŠ¶æ€)ã€‚</p>
<p><strong>ï¼ˆ3ï¼‰å¾…è¯„ä¼°é˜¶æ®µ</strong></p>
<p>è¯¥é˜¶æ®µç›®æ ‡æ˜¯é¢„ä¼°æœ€é«˜å³°åœºæ™¯ä¸‹ä¸šåŠ¡é‡ï¼Œä¸»è¦æ ¹æ®åŸºå‡†å€¼å’Œä¸šåŠ¡æ¶¨å¹…ä¸¤ä¸ªæŒ‡æ ‡è®¡ç®—ã€‚</p>
<p>ç³»ç»Ÿæ ¹æ®å…¬å¼è®¡ç®—ï¼šé¢„ä¼°é«˜å³°ä¸šåŠ¡é‡ = åŸºå‡†å€¼ Ã—ï¼ˆ1+ä¸šåŠ¡æ¶¨å¹…ï¼‰ï¼Œç„¶åè¿›å…¥ä¸‹ä¸€é˜¶æ®µï¼ˆè¯„ä¼°ä¸­çŠ¶æ€ï¼‰ã€‚æµé‡æ—¥å†å¹³å°è°ƒç”¨ç®—æ³•æ¥å£æ ¹æ®é¢„ä¼°é«˜å³°ä¸šåŠ¡é‡è·å–å„åº”ç”¨+ç¯å¢ƒç»´åº¦ä¸‹å®é™…ä½¿ç”¨CPUé‡é¢„æµ‹å€¼ã€‚</p>
<p>è¿™é‡Œä¸šåŠ¡æ¶¨å¹…å¯å‚è€ƒå…¬å¼è®¡ç®—æˆ–è€…ç›´æ¥ç”±ä¸šåŠ¡æ–¹ç›´æ¥æä¾›ï¼Œ å…¬å¼ä¸ºï¼š</p>
<p>ä¸šåŠ¡æ¶¨å¹…=å†å²æ¶¨å¹…Ã—(1+è‡ªç„¶å¢é•¿ç‡+å¤–éƒ¨å½±å“ç³»æ•° )</p>
<p><strong>æŒ‡æ ‡</strong></p>
<p><strong>æŒ‡æ ‡è§„åˆ™</strong></p>
<p>å†å²æ¶¨å¹…è®¡ç®—</p>
<p>äººå·¥å¡«å†™å†å²é«˜å³°æ—¶é—´ï¼Œç³»ç»Ÿè®¡ç®—å†å²æ¶¨å¹…ï¼Œè®¡ç®—é€»è¾‘ä¸ºå†å²å½“å¤©æœ€é«˜å€¼å’Œå‰ä¸‰å¤©åŒæ—¶é—´å‡å€¼ç›¸é™¤è®¡ç®—å¾—åˆ°</p>
<p>è‡ªç„¶å¢é•¿è®¡ç®—</p>
<p>ä¸šåŠ¡è¯„ä¼°ï¼Œæ ¹æ®è¿‘æœŸäº‹ä»¶å¢é•¿ç‡/å†å²å¢é•¿ç‡æä¾›</p>
<p>å¤–éƒ¨å½±å“è®¡ç®—</p>
<p>ä¸šåŠ¡è¯„ä¼°ï¼Œéœ€è¦ç»“åˆè¿‘æœŸæ”¿ç­–ï¼Œä»¥åŠå¸‚åœºæƒ…å†µï¼ŒæŠ¥è€ƒäººæ•°ç­‰ç­‰ï¼Œä¾é ç»éªŒè¯„ä¼°</p>
<p>åŸºå‡†å€¼</p>
<p>äººå·¥å¡«å†™åŸºå‡†æ—¶é—´èŒƒå›´ï¼Œç³»ç»Ÿè‡ªåŠ¨è®¡ç®—åŸºå‡†é«˜å³°å€¼ï¼Œè®¡ç®—é€»è¾‘ä¸ºé«˜å³°æœŸå‰ä¸‰å¤©åŒæ—¶é—´æ®µå³°å€¼</p>
<p><strong>æŒ‡æ ‡</strong></p>
<p><strong>å†…å®¹</strong></p>
<p>çƒ­ç‚¹è¯¦æƒ…</p>
<p>2024å¹´å›½å®¶å…¬åŠ¡å‘˜è€ƒè¯•11.20æ‰“å°å‡†è€ƒè¯</p>
<p>å½±å“æ—¶é—´</p>
<p>2023-11-20 00:00:00-2023-11-20 02:00:00</p>
<p>é«˜å³°æ—¶é—´ç‚¹</p>
<p>2023-11-20 00:00:00</p>
<p>è¯„ä¼°æ—¶é—´ç‚¹</p>
<p>2023-11-18 00:00:00</p>
<p>æ‰©å®¹æ—¶é—´ç‚¹</p>
<p>2023-11-19 23:00:00</p>
<p>ç¼©å®¹æ—¶é—´ç‚¹</p>
<p>2023-11-20 02:00:00</p>
<p>å½±å“èŒƒå›´</p>
<p>å›½å†…é…’åº—</p>
<p>ä¸šåŠ¡é¢„ä¼°é‡</p>
<p>xxx</p>
<p>ä¸šåŠ¡é¢„ä¼°å¢é•¿ç‡</p>
<p>xxx</p>
<p><strong>ï¼ˆ4ï¼‰è¯„ä¼°ä¸­&amp;è¯„ä¼°å®Œæˆ</strong></p>
<p>è¯„ä¼°ä¸­çŠ¶æ€, æµé‡æ—¥å†å¹³å°ä¼šæ ¹æ®äº‹ä»¶åŸºå‡†å€¼å’Œä¸šåŠ¡æ¶¨å¹…(å¢é•¿ç‡)è®¡ç®—å‡ºé«˜å³°æœŸä¸šåŠ¡å€¼, ç„¶åè°ƒç®—æ³•æ¥å£, é¢„æµ‹å¯¹åº”é«˜å³°ä¸šåŠ¡å€¼ä¸‹ï¼Œå„åº”ç”¨+ç¯å¢ƒç»´åº¦ä½¿ç”¨çš„CPUæ€»æ ¸æ•°ã€‚</p>
<p>æµé‡æ—¥å†å¹³å°å°†ç®—æ³•æä¾›é¢„ä¼°æ ¸æ•°ï¼ŒåŠ ä¸Šå®‰å…¨é˜ˆå€¼åï¼Œå¾—åˆ°å¹³å°é¢„ä¼°æ ¸æ•°ã€‚</p>
<p>å…¬å¼ï¼šç®—æ³•é¢„ä¼°å®é™…ä½¿ç”¨æ ¸æ•°Ã—(1+å®‰å…¨é˜ˆå€¼)=å¹³å°é¢„ä¼°å®é™…ä½¿ç”¨æ ¸æ•°</p>
<p>å†è°ƒç”¨0psæ¥å£, Opsæ ¹æ®å…¬å¼(å¹³å°é¢„ä¼°å®é™…æ€»æ ¸æ•°Ã·æœºå™¨CPUé˜ˆå€¼Ã·æœºå™¨é…ç½®=é¢„ä¼°å®ä¾‹æ•° ) è®¡ç®—å‡ºé«˜å³°æœŸä¸šåŠ¡é¢„ä¼°æœºå™¨æ•°ã€‚æ­¤æ—¶è¯„ä¼°é˜¶æ®µç»“æŸï¼Œè¿›å…¥Opsåˆ›å»ºå®šæ—¶æ‰©ç¼©å®¹ä»»åŠ¡é˜¶æ®µã€‚</p>
<p>æµé‡æ—¥å†æ ¹æ®ç®—æ³•å’ŒOpsè®¡ç®—åï¼Œå¯ä»¥åœ¨æµé‡æ—¥å†å¹³å°æŸ¥çœ‹é¢„ä¼°å…·ä½“æ•°æ®ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/04d6e273d48047c39fc7b43aaaea9e7d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769739828&amp;x-signature=8ghf83ht64icrodk2vkaQrlplxM%3D" alt="" loading="lazy"/></p>
<p><strong>ï¼ˆ5ï¼‰åˆ›å»ºä»»åŠ¡</strong></p>
<p>Opsæ ¹æ®æµé‡æ—¥å†å¹³å°æä¾›çš„é¢„è®¡æ‰©ç¼©å®¹æ—¶é—´ï¼Œå’ŒOpsè®¡ç®—å‡ºé¢„ä¼°æœºå™¨æ•°åˆ›å»ºå®šæ—¶æ‰©å®¹ä»»åŠ¡, ä»»åŠ¡å…·ä½“ä¿¡æ¯åŒ…å«æ‰©ç¼©å®¹æ—¶é—´ä¸æœºå™¨å®ä¾‹æ•°ã€‚ è¿™é‡Œæ‰©ç¼©å®¹ä½¿ç”¨çš„èµ„æºä¸ºæœ¬åœ°æœºå™¨+äº‘ä¸Šèµ„æºä¸¤éƒ¨åˆ†ï¼Œé€šè¿‡é€‚å½“çš„ä¸Šäº‘èµ„æºæ¯”ä¾‹ç­–ç•¥ä¿éšœæ ¸å¿ƒæœåŠ¡çš„ç¨³å®šæ€§ã€‚</p>
<p>ç›®å‰æ•´ä½“çš„æ‰©ç¼©ç­–ç•¥ä¸ºä¿è¯ç¨³å®šæ€§ï¼Œåœ¨é«˜å³°æœŸå‰é¢„å®šæ—¶é—´ç‚¹å®é™…æ™ºèƒ½æ‰©å®¹, é«˜å³°åé¢„å®šæ—¶é—´ç‚¹è‡ªåŠ¨æ…¢é€Ÿæ™ºèƒ½ç¼©å®¹, å®šæ—¶æ‰©ç¼©å®¹ä»»åŠ¡åˆ›å»ºå,æ ¹æ®è®¾å®šäº‹ä»¶ç‚¹è¿›è¡Œå®é™…è‡ªåŠ¨åŒ–å®šæ—¶æ‰©ç¼©å®¹ï¼Œæ‰©ç¼©å®¹æ‰§è¡Œæ—¶ä¼šæœ‰æ¶ˆæ¯æç¤ºé€šçŸ¥ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7f5b88d1da347aebcbda09073f6ff32~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769739828&amp;x-signature=v79QYX7xHNYXE0WA2kPz%2FFt6bNg%3D" alt="" loading="lazy"/></p>
<p><strong>ï¼ˆ6ï¼‰å¤ç›˜é˜¶æ®µ&amp;ç»“æŸ</strong></p>
<p>ä»»åŠ¡é«˜å³°æœŸåï¼Œä¼šè¿›å…¥å¤ç›˜é˜¶æ®µã€‚å¤ç›˜é˜¶æ®µä¸»è¦æ ¹æ®äº‹ä»¶å‡†ç¡®ç‡å’Œè¦†ç›–ç‡ä¸¤ä¸ªæŒ‡æ ‡æ¥è¡¡é‡é¢„æµ‹æƒ…å†µã€‚</p>
<h4 data-id="heading-4">â‘ æŒ‡æ ‡ä»‹ç»</h4>
<p><strong>æŒ‡æ ‡ä»£ç </strong></p>
<p><strong>å«ä¹‰</strong></p>
<p>a</p>
<p>äººå·¥è®¾ç½®å¢é•¿é˜ˆå€¼ï¼ŒåŒºåˆ†å®é™…å¢é•¿å’Œè‡ªç„¶æ³¢åŠ¨èŒƒå›´.</p>
<p>M</p>
<p>å•åº”ç”¨å®é™…é«˜å³°æœŸæ€»æ ¸æ•°</p>
<p>N</p>
<p>åº”ç”¨å‰ä¸‰å¤©äº‹ä»¶åŒæ—¶é—´æ®µæœ€é«˜å³°æ€»æ ¸æ•°å‡å€¼</p>
<p>K</p>
<p>å•åº”ç”¨é¢„æµ‹é«˜å³°æœŸæ€»æ ¸æ•°</p>
<p>å¦‚æœ M &gt;N (1+a%), è¡¨ç¤ºè¯¥åº”ç”¨ä¸ºå®é™…å¢é•¿åº”ç”¨ã€‚</p>
<p>å¦‚æœK&gt;N (1+a%),è¡¨ç¤ºè¯¥åº”ç”¨ä¸ºé¢„ä¼°å¢é•¿åº”ç”¨</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ded4e1fac824e829f0e955627c11b41~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769739828&amp;x-signature=iN%2FXgCuiwHymfe4LD0zMwyGEhTk%3D" alt="" loading="lazy"/></p>
<p><strong>æŒ‡æ ‡åç§°</strong></p>
<p><strong>æŒ‡æ ‡è®¡ç®—æ–¹å¼</strong></p>
<p><strong>è¯´æ˜</strong></p>
<p>é¢„æµ‹ä¸šåŠ¡å¢é•¿ç‡</p>
<p>é¢„æµ‹å¢é•¿ç‡ = é¢„æµ‹äº‹ä»¶å‘ç”Ÿæ—¶æ®µè®¢å•å³°å€¼/åŸºå‡†è®¢å•å‡å€¼</p>
<p>å®é™…ä¸šåŠ¡å¢é•¿ç‡</p>
<p>å®é™…å¢é•¿ç‡ = å®é™…äº‹ä»¶å‘ç”Ÿæ—¶æ®µè®¢å•å³°å€¼/åŸºå‡†è®¢å•å‡å€¼</p>
<p>å‡†ç¡®ç‡</p>
<p>(é¢„æµ‹å¢é•¿çš„åº”ç”¨æ•° ä¸ å®é™…å¢é•¿çš„åº”ç”¨æ•° çš„äº¤é›†)/ é¢„æµ‹å¢é•¿çš„åº”ç”¨æ•°</p>
<p>æ»¡è¶³ M &gt;N (1+a%), è¡¨ç¤ºè¯¥åº”ç”¨ä¸ºå®é™…å¢é•¿åº”ç”¨.</p>
<p>æ»¡è¶³ K&gt;N (1+a%),è¡¨ç¤ºè¯¥åº”ç”¨ä¸ºé¢„ä¼°å¢é•¿åº”ç”¨.</p>
<p>è¦†ç›–ç‡</p>
<p>(é¢„æµ‹å¢é•¿çš„åº”ç”¨æ•° ä¸ å®é™…å¢é•¿çš„åº”ç”¨æ•° çš„äº¤é›†)/ å®é™…å¢é•¿çš„åº”ç”¨æ•°</p>
<h4 data-id="heading-5">â‘¡å¤ç›˜æ•°æ®ä»‹ç»</h4>
<p>ä»¥ä¸‹ä¸ºå¤ç›˜é¡µé¢ä¸»è¦æ•°æ®, åŒ…å«ä¸šåŠ¡æ¶¨å¹…åå·®ã€é¢„ä¼°è¦†ç›–ç‡ã€é¢„ä¼°å‡†ç¡®ç‡ã€‚ä»¥åŠå‘ä¸‹æ‹†åˆ†å¯ä»¥åˆ°åº”ç”¨+ç¯å¢ƒç»´åº¦çš„èµ„æºä½¿ç”¨æ•°æ®ã€‚æ ¹æ®å¤ç›˜æ•°æ®åˆ†æç®—æ³•/æµç¨‹å¯æ”¹è¿›é¡¹ï¼Œå¡«å†™å¤ç›˜æ€»ç»“ï¼Œæäº¤åäº‹ä»¶ä¸ºç»“æŸçŠ¶æ€ã€‚</p>
<p><strong>æŒ‡æ ‡</strong></p>
<p><strong>ç¤ºä¾‹å€¼</strong></p>
<p>äº‹ä»¶é¢„ä¼°è¦†ç›–ç‡</p>
<p>100%</p>
<p>äº‹ä»¶é¢„ä¼°å‡†ç¡®ç‡</p>
<p>95.92%</p>
<p>é¢„ä¼°ä¸šåŠ¡é‡</p>
<p>xxx</p>
<p>ä¸šåŠ¡çº¿</p>
<p>xxx</p>
<p>ä¸šåŠ¡é‡åŸºå‡†å‚ç…§æ—¶é—´</p>
<p>2023-11-13 00:00:00-02:00:00</p>
<p>é¢„ä¼°å¢é•¿ç‡</p>
<p>100%</p>
<p>åŸºå‡†å€¼</p>
<p>500</p>
<p>ä¸šåŠ¡é¢„ä¼°å€¼</p>
<p>1000</p>
<p>å®é™…ä¸šåŠ¡é‡</p>
<p>950</p>
<p>å®é™…å¢é•¿ç‡</p>
<p>90%</p>
<p>å®‰å…¨é˜ˆå€¼</p>
<p>5%</p>
<p>å¹³å°é¢„ä¼°æ€»æ ¸æ•°</p>
<p>20000</p>
<p>å®é™…æ‰©å®¹æ€»æ ¸æ•°</p>
<p>19500</p>
<h3 data-id="heading-6"/>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ce91f76a006d473c9facec0d4ffc5323~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769739828&amp;x-signature=rKW%2FqFzbYvP5149jV6yrjbuyGms%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-7"><strong>3. ç®—æ³•éƒ¨åˆ†ä»‹ç»</strong></h3>
<p><strong>ï¼ˆ1ï¼‰ç®—æ³•æ¨¡å‹é¢„æµ‹å‡†ç¡®æ€§ä¿éšœ</strong></p>
<h4 data-id="heading-8">â‘  æ¨¡å‹æ„å»º-åº”ç”¨é€‰æ‹©</h4>
<p>åœ¨å‰æœŸæ•°æ®å‡†å¤‡é˜¶æ®µ, ç”±äºæ¨¡å‹ç®—æ³•æ˜¯åˆ†æè®¢å•é‡å’Œåº”ç”¨cpuç›´æ¥çš„å…³ç³»ï¼Œéœ€è¦é‡ç‚¹å…³æ³¨å½±å“(CPU)çš„å› ç´ , ä»¥åŠåº”ç”¨èŒƒå›´çš„é€‰å–ã€‚</p>
<p><strong>ç›®æ ‡</strong></p>
<p><strong>åˆ†æå…³é”®å› ç´ </strong></p>
<p>å½±å“(CPU)çš„å› ç´ </p>
<p>è®¢å•é‡</p>
<p>QPS</p>
<p>æœºå™¨å‹å·</p>
<p>Opsè¿ç»´</p>
<p>è°ƒåº¦ä»»åŠ¡</p>
<p>å“ªäº›åº”ç”¨å¯ä»¥è¿™ä¹ˆåš</p>
<p>è®¢å•é‡å’ŒCPUèµ„æºæ•°æ­£ç›¸å…³</p>
<p>CPUèµ„æºé‡ä¸å¾®é‡</p>
<p>è®¢å•å½±å“å ä¸»å¯¼</p>
<p>ç”±äºåº”ç”¨ç³»ç»Ÿä¸­è¿˜åŒºåˆ†äº†éƒ¨ç½²ç¯å¢ƒENVçš„æ¦‚å¿µï¼ŒåŒä¸€ä¸ªåº”ç”¨ç³»ç»Ÿä¸‹ä¸åŒç¯å¢ƒENVæ‰¿æ¥çš„æµé‡å¯èƒ½æœ‰å·®å¼‚ï¼Œè´Ÿè´£ä¸šåŠ¡æœ‰å·®å¼‚ï¼Œæ‰€ä»¥æœ€åæœ€å°ç»´åº¦åˆ’åˆ†åœ¨åº”ç”¨+ENVç»´åº¦ã€‚æœ€ç»ˆé€‰å–äº†è®¢å•é‡å’ŒCPUæ­£ç›¸å…³çš„åº”ç”¨+ç¯å¢ƒä½œä¸ºè®­ç»ƒèŒƒå›´, å¯¹äºCPUå¾®é‡ä»¥åŠä¸å—è®¢å•å½±å“çš„ä¸åˆ—å…¥è®­ç»ƒèŒƒå›´ã€‚</p>
<h4 data-id="heading-9">â‘¡ æ¨¡å‹è®­ç»ƒå’ŒæŒ‡æ ‡éªŒè¯</h4>
<p><strong>è®­ç»ƒæ•°æ®è¦æ±‚</strong></p>
<p><strong>å†…å®¹</strong></p>
<p>æ•°æ®èŒƒå›´</p>
<p>å¼€é€šå®¹å™¨åŒ–+å¼€é€šè‡ªåŠ¨æ‰©ç¼©å®¹çš„åº”ç”¨</p>
<p>æ•°æ®æœŸé™</p>
<p>è¿‘2æœˆ</p>
<p>æ•°æ®åŒ…å«</p>
<p>åº”ç”¨ã€å­ç¯å¢ƒã€æ—¶é—´æˆ³ã€è®¢å•é‡ã€CPUèµ„æºä½¿ç”¨é‡</p>
<p>æ•°æ®è´¨é‡éœ€æ±‚</p>
<p>æä¾›çš„æ•°æ®éœ€è¦å‰”é™¤è„æ•°æ®</p>
<p>æ•°æ®å³°å€¼</p>
<p>è®­ç»ƒé›†å’ŒéªŒè¯é›†éƒ½éœ€è¦åŒ…å«é«˜å³°æ—¶æ®µ</p>
<p>è®­ç»ƒç®—æ³•ï¼šä½¿ç”¨ç¥ç»ç½‘ç»œç®—æ³•è¿›è¡Œæ¨¡å‹è®­ç»ƒï¼Œæœ€ç»ˆé€šè¿‡è®¢å•é‡é¢„æµ‹CPUä½¿ç”¨èµ„æºã€‚</p>
<p><strong>è€ƒå¯ŸæŒ‡æ ‡</strong></p>
<p><strong>ç”¨é€”</strong></p>
<p><strong>èŒƒä¾‹</strong></p>
<p>å¹³å‡ç»å¯¹ç™¾åˆ†æ¯”è¯¯å·®MAPE</p>
<p>æ¨¡å‹å‡†ç¡®åº¦</p>
<p>0.08</p>
<p>è®¢å•é‡ä¸CPUä½¿ç”¨é‡ç›¸å…³æ€§ç³»æ•°</p>
<p>ç›¸å…³æ€§(å¯è¡Œæ€§)</p>
<p>0.91</p>
<p>å®é™…CPUå ç”¨å‡å€¼</p>
<p>èµ„æºä½¿ç”¨ä½“é‡</p>
<p>32.5</p>
<p>é¢„æµ‹CPUå ç”¨ä¸çœŸå®å€¼å·®å€¼çš„å¹³å‡ç»å¯¹å€¼</p>
<p>è¯¯å·®å®é™…å½±å“</p>
<p>3.1</p>
<h4 data-id="heading-10">â‘¢æ¨¡å‹å®šæ—¶æ›´æ–°+ç¦»çº¿éªŒè¯</h4>
<p>æ¨¡å‹ç¦»çº¿å®šæ—¶æ›´æ–°</p>
<ul>
<li>
<p>å­¦ä¹ æ•°æ®ï¼šé«˜å³°äº‹ä»¶+è¿‘æœŸæ•°æ®(t-10)</p>
</li>
<li>
<p>æ›´æ–°ç­–ç•¥ï¼šæ–°æ¨¡å‹æ•ˆæœä¸æ¬¡äºçº¿ä¸Š</p>
</li>
<li>
<p>ä¿éšœæ¨¡å‹æ—¶æ•ˆæ€§å’Œäº‹ä»¶é²æ£’æ€§</p>
</li>
<li>
<p>å‡å°‘ Ops è¿ç»´å¸¦æ¥çš„å½±å“</p>
</li>
</ul>
<p>æ¨¡å‹çº¿ä¸Šæ•ˆæœå®šæ—¶åé¦ˆ</p>
<ul>
<li>
<p>æ¨¡å‹æ¯æ—¥åé¦ˆçº¿ä¸Šæ•ˆæœ</p>
</li>
<li>
<p>ä¿è¯çº¿ä¸Šåœ¨æœ‰æ•ˆæ—¶ä½¿ç”¨</p>
</li>
<li>
<p>å†…éƒ¨ IT æé†’ + æŠ¥è­¦</p>
</li>
</ul>
<p><strong>ï¼ˆ2ï¼‰hpa æ‰©ç¼©å®¹å®‰å…¨ç­–ç•¥</strong></p>
<p><strong>å®‰å…¨ç­–ç•¥</strong></p>
<p><strong>å…·ä½“å†…å®¹</strong></p>
<p>æœ€å¤§å‰¯æœ¬æ•°å®‰å…¨é™åˆ¶</p>
<p>ç›®å‰å„åº”ç”¨æœ€å¤§å‰¯æœ¬æ•°ç”±å„ä¸šåŠ¡çº¿æ ¹æ®ä¸šåŠ¡åœºæ™¯å’ŒDB/Redisç­‰ä¸‹æ¸¸èµ„æºé™åˆ¶ç­‰å› ç´ ç»¼åˆé…ç½®ï¼Œå½“é¢„æµ‹è¶…è¿‡æœ€å¤§å‰¯æœ¬æ•°ï¼Œé™åˆ¶åˆ›å»ºå¹¶å¯¹åº”æ¶ˆæ¯æç¤ºï¼Œè´Ÿè´£äººå¯æ ¹æ®æƒ…å†µè¯„ä¼°è°ƒæ•´ã€‚</p>
<p>æœ€å°å‰¯æœ¬æ•°å®‰å…¨é™åˆ¶</p>
<p>è®¾ç½®é˜ˆå€¼a%ï¼Œå½“é¢„æµ‹å®ä¾‹æ•°å°äºå½“å‰æœ€å°å‰¯æœ¬æ•°ï¼ˆ1-a%ï¼‰ä¼šè§¦å‘é™åˆ¶ã€‚ä¿éšœæœºå™¨æ•°é¢„æµ‹è¿‡ä½åœºæ™¯ç¨³å®šæ€§ã€‚</p>
<h2 data-id="heading-11">ä¸‰ã€é¡¹ç›®æ•°æ®&amp;ä»·å€¼</h2>
<p><strong>æŒ‡æ ‡</strong></p>
<p><strong>å†…å®¹</strong></p>
<p>ä¸šåŠ¡çº¿æ¥å…¥æƒ…å†µ</p>
<p>åº”ç”¨æ¥å…¥ 150+ ä¸ª , å æ¯”é…’åº—åº”ç”¨æ€»æ ¸æ•° 90%+</p>
<p>æœªæ¥å…¥åº”ç”¨ä¸»è¦ä¸ºæµé‡å˜åŒ–ä¸æ˜æ˜¾</p>
<p>å·²å®Œæˆé‡ç‚¹é«˜å³°äº‹ä»¶ä¿éšœ</p>
<p>è€ƒè¯•ç±»ï¼Œå¦‚å›½è€ƒ ã€ç ”ç©¶ç”Ÿã€çœè€ƒç­‰</p>
<p>èŠ‚å‡æ—¥é«˜å³°å®¹é‡ä¿éšœç±»ï¼Œå¦‚æ˜¥èŠ‚ã€äº”ä¸€ã€åä¸€ç­‰</p>
<p>åº”ç”¨é¢„ä¼°å¹³å‡è¦†ç›–åº¦</p>
<p>96%</p>
<p>åº”ç”¨é¢„ä¼°å¹³å‡å‡†ç¡®ç‡</p>
<p>89%</p>
<p>ä»·å€¼è¡¡é‡</p>
<p>å•æ¬¡äº‹ä»¶é«˜å³°æœŸèŠ‚çº¦äººå·¥è¿ç»´æ•ˆç‡3pdï¼ˆäººå¤©ï¼‰/æ¬¡ï¼Œå¹´åŒ–èŠ‚çº¦270pdï¼ˆäººå¤©ï¼‰ã€‚</p>
<p>é€šè¿‡ç®—æ³•é¢„ä¼°æœºå™¨èµ„æºï¼Œæ¯”äººå·¥é¢„æµ‹èµ„æºèŠ‚çœçº¦20%ã€‚</p>
<h2 data-id="heading-12"><strong>å››ã€åç»­è§„åˆ’</strong></h2>
<p><strong>æ–¹å‘</strong></p>
<p><strong>å†…éƒ¨</strong></p>
<p>æ™ºèƒ½æ‰©ç¼©å®¹åœºæ™¯è¦†ç›–æå‡</p>
<p>1.å…¨åº”ç”¨åœºæ™¯è¦†ç›–æå‡ï¼ŒåŒ…å«å®ä½“æœº/KVMåœºæ™¯ï¼Œå­˜å‚¨å±‚DB/Redisèµ„æº</p>
<p>2.å®¹é‡æ‰©å®¹å®‰å…¨æ€§æ£€æµ‹æå‡ï¼Œå¢åŠ å¯¹DBã€ZKç­‰è¿æ¥èµ„æºæ£€æŸ¥</p>
<p>ç®—æ³•ä¼˜åŒ–æ–¹å‘æå‡</p>
<p>å€ŸåŠ©AIï¼Œæå‡ä¸šåŠ¡é‡é¢„ä¼°å‡†ç¡®æ€§ï¼Œæå‡ä¸šåŠ¡æŒ‡æ ‡ä¸åº”ç”¨CPUå…³è”æ€§</p>
<p>åç»­è¿è¥æ¨å¹¿è®¡åˆ’</p>
<p>ä¸šåŠ¡çº¿èŒƒå›´æ‰©å¤§ï¼Œé€æ­¥è¦†ç›–å…¬å¸å„ä¸šåŠ¡çº¿ï¼Œå®ç°å…¨å¸èµ„æºè°ƒåº¦Oèƒ½åŒ–</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•æ„å»ºç°ä»£Agentä»¥OpenManusä¸ºä¾‹]]></title>    <link>https://juejin.cn/post/7598021984300433435</link>    <guid>https://juejin.cn/post/7598021984300433435</guid>    <pubDate>2026-01-23T02:26:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598021984300433435" data-draft-id="7598021081988120627" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•æ„å»ºç°ä»£Agentä»¥OpenManusä¸ºä¾‹"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯"/> <meta itemprop="datePublished" content="2026-01-23T02:26:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="moshuying"/> <meta itemprop="url" content="https://juejin.cn/user/2700056289356936"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•æ„å»ºç°ä»£Agentä»¥OpenManusä¸ºä¾‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2700056289356936/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    moshuying
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T02:26:09.000Z" title="Fri Jan 23 2026 02:26:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»18åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å¼•è¨€</h2>
<p>åœ¨äººå·¥æ™ºèƒ½å¿«é€Ÿå‘å±•çš„ä»Šå¤©ï¼ŒAgentï¼ˆæ™ºèƒ½ä½“ï¼‰å·²æˆä¸ºè¿æ¥å¤§è¯­è¨€æ¨¡å‹ä¸å®é™…åº”ç”¨åœºæ™¯çš„å…³é”®æ¡¥æ¢ã€‚ç°ä»£Agentä¸ä»…èƒ½å¤Ÿç†è§£è‡ªç„¶è¯­è¨€æŒ‡ä»¤ï¼Œæ›´é‡è¦çš„æ˜¯èƒ½å¤Ÿé€šè¿‡å·¥å…·è°ƒç”¨ï¼ˆTool Callingï¼‰ä¸»åŠ¨æ‰§è¡Œæ“ä½œï¼Œå®Œæˆå¤æ‚çš„ä»»åŠ¡ã€‚ä»ä»£ç ç¼–å†™ã€æ•°æ®åˆ†æåˆ°ç½‘é¡µæµè§ˆã€æ–‡ä»¶æ“ä½œï¼ŒAgentæ­£åœ¨é‡å¡‘æˆ‘ä»¬ä¸è®¡ç®—æœºäº¤äº’çš„æ–¹å¼ã€‚</p>
<p>OpenManusæ˜¯ä¸€ä¸ªå¼€æºçš„é€šç”¨AI Agentæ¡†æ¶ï¼Œå®ƒå±•ç¤ºäº†å¦‚ä½•æ„å»ºä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€æ¶æ„æ¸…æ™°çš„ç°ä»£Agentç³»ç»Ÿã€‚æœ¬æ–‡å°†ä»¥OpenManusé¡¹ç›®ä¸ºè“æœ¬ï¼Œç³»ç»Ÿæ€§åœ°è§£ç­”ç°ä»£Agentæ„å»ºä¸­çš„å››ä¸ªæ ¸å¿ƒé—®é¢˜ï¼š</p>
<ol>
<li><strong>é¡¹ç›®ç»“æ„ä¸æ ¸å¿ƒéƒ¨åˆ†ä»£ç å¦‚ä½•ç¼–å†™</strong></li>
<li><strong>å·¥å…·æ˜¯å¦‚ä½•è¢«æ·»åŠ åˆ°Agentçš„</strong></li>
<li><strong>Agentæ˜¯å¦‚ä½•è°ƒç”¨è¿™äº›å·¥å…·çš„</strong></li>
<li><strong>Agentæ˜¯å¦‚ä½•æ€è€ƒçš„</strong></li>
</ol>
<p>é€šè¿‡æ·±å…¥åˆ†æOpenManusçš„ä»£ç å®ç°ï¼Œæˆ‘ä»¬å°†æ„å»ºå¯¹ç°ä»£Agentæ¶æ„çš„å®Œæ•´è®¤çŸ¥ï¼Œä¸ºæ„å»ºè‡ªå·±çš„Agentç³»ç»Ÿæä¾›å®è·µæŒ‡å¯¼ã€‚</p>
<h2 data-id="heading-1">äºŒã€é¡¹ç›®ç»“æ„ä¸æ ¸å¿ƒä»£ç æ¶æ„</h2>
<h3 data-id="heading-2">2.1 åˆ†å±‚æ¶æ„è®¾è®¡</h3>
<p>ç°ä»£Agentç³»ç»Ÿé€šå¸¸é‡‡ç”¨åˆ†å±‚æ¶æ„ï¼Œæ¯ä¸€å±‚è´Ÿè´£ä¸åŒçš„èŒè´£ã€‚OpenManusé‡‡ç”¨äº†æ¸…æ™°çš„å››å±‚æ¶æ„è®¾è®¡ï¼š</p>
<h3 data-id="heading-3">åŸºç¡€å±‚ï¼ˆBase Layerï¼‰ï¼š<code>app/agent/base.py</code></h3>
<p><code>BaseAgent</code>æ˜¯æ‰€æœ‰Agentçš„æŠ½è±¡åŸºç±»ï¼Œæä¾›äº†Agentè¿è¡Œçš„åŸºç¡€è®¾æ–½ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseAgent</span>(BaseModel, ABC):
    name: <span class="hljs-built_in">str</span>  <span class="hljs-comment"># Agentå”¯ä¸€æ ‡è¯†</span>
    description: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>]  <span class="hljs-comment"># Agentæè¿°</span>
    system_prompt: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>]  <span class="hljs-comment"># ç³»ç»Ÿçº§æŒ‡ä»¤</span>
    next_step_prompt: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>]  <span class="hljs-comment"># ä¸‹ä¸€æ­¥è¡ŒåŠ¨æç¤º</span>

    llm: LLM  <span class="hljs-comment"># å¤§è¯­è¨€æ¨¡å‹å®ä¾‹</span>
    memory: Memory  <span class="hljs-comment"># è®°å¿†å­˜å‚¨</span>
    state: AgentState  <span class="hljs-comment"># å½“å‰çŠ¶æ€ï¼ˆIDLE/RUNNING/FINISHED/ERRORï¼‰</span>

    max_steps: <span class="hljs-built_in">int</span> = <span class="hljs-number">10</span>  <span class="hljs-comment"># æœ€å¤§æ‰§è¡Œæ­¥æ•°</span>
    current_step: <span class="hljs-built_in">int</span> = <span class="hljs-number">0</span>  <span class="hljs-comment"># å½“å‰æ­¥æ•°</span>

</code></pre>
<p><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼š</p>
<ol>
<li><strong>çŠ¶æ€ç®¡ç†</strong>ï¼šé€šè¿‡<code>state_context</code>ä¸Šä¸‹æ–‡ç®¡ç†å™¨å®ç°å®‰å…¨çš„çŠ¶æ€è½¬æ¢</li>
<li><strong>å†…å­˜ç®¡ç†</strong>ï¼š<code>update_memory()</code>æ–¹æ³•ç»Ÿä¸€ç®¡ç†å¯¹è¯å†å²</li>
<li><strong>æ‰§è¡Œå¾ªç¯</strong>ï¼š<code>run()</code>æ–¹æ³•å®ç°ä¸»æ‰§è¡Œå¾ªç¯ï¼ŒåŒ…å«æ­¥æ•°é™åˆ¶å’Œå¡æ­»æ£€æµ‹</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self, request: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = <span class="hljs-literal">None</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-keyword">if</span> request:
        self.update_memory(<span class="hljs-string">"user"</span>, request)

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> self.state_context(AgentState.RUNNING):
        <span class="hljs-keyword">while</span> (self.current_step &lt; self.max_steps <span class="hljs-keyword">and</span>
               self.state != AgentState.FINISHED):
            self.current_step += <span class="hljs-number">1</span>
            step_result = <span class="hljs-keyword">await</span> self.step()  <span class="hljs-comment"># æ‰§è¡Œå•æ­¥</span>

            <span class="hljs-keyword">if</span> self.is_stuck():  <span class="hljs-comment"># æ£€æµ‹æ˜¯å¦å¡æ­»</span>
                self.handle_stuck_state()

</code></pre>
<h3 data-id="heading-4">æ€è€ƒå±‚ï¼ˆReasoning Layerï¼‰ï¼š<code>app/agent/react.py</code></h3>
<p><code>ReActAgent</code>å®ç°äº†ç»å…¸çš„ReActï¼ˆReasoning + Actingï¼‰æ¨¡å¼ï¼Œå°†Agentçš„æ‰§è¡Œåˆ†ä¸ºæ€è€ƒå’Œè¡ŒåŠ¨ä¸¤ä¸ªé˜¶æ®µï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ReActAgent</span>(BaseAgent, ABC):
<span class="hljs-meta">    @abstractmethod</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">think</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">bool</span>:
        <span class="hljs-string">"""å¤„ç†å½“å‰çŠ¶æ€å¹¶å†³å®šä¸‹ä¸€æ­¥è¡ŒåŠ¨"""</span>

<span class="hljs-meta">    @abstractmethod</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">act</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""æ‰§è¡Œå·²å†³å®šçš„è¡ŒåŠ¨"""</span>

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">step</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""æ‰§è¡Œå•æ­¥ï¼šæ€è€ƒç„¶åè¡ŒåŠ¨"""</span>
        should_act = <span class="hljs-keyword">await</span> self.think()
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> should_act:
            <span class="hljs-keyword">return</span> <span class="hljs-string">"Thinking complete - no action needed"</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> self.act()

</code></pre>
<p>è¿™ç§è®¾è®¡å°†"å†³ç­–"å’Œ"æ‰§è¡Œ"è§£è€¦ï¼Œä½¿å¾—Agentçš„æ€è€ƒè¿‡ç¨‹æ›´åŠ æ¸…æ™°å¯æ§ã€‚</p>
<h3 data-id="heading-5">å·¥å…·è°ƒç”¨å±‚ï¼ˆTool Call Layerï¼‰ï¼š<code>app/agent/toolcall.py</code></h3>
<p><code>ToolCallAgent</code>åœ¨ReActæ¨¡å¼åŸºç¡€ä¸Šï¼Œå®ç°äº†å…·ä½“çš„å·¥å…·è°ƒç”¨æœºåˆ¶ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ToolCallAgent</span>(<span class="hljs-title class_ inherited__">ReActAgent</span>):
    available_tools: ToolCollection  <span class="hljs-comment"># å¯ç”¨å·¥å…·é›†åˆ</span>
    tool_choices: TOOL_CHOICE_TYPE = ToolChoice.AUTO
    tool_calls: <span class="hljs-type">List</span>[ToolCall] = Field(default_factory=<span class="hljs-built_in">list</span>)

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">think</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">bool</span>:
        <span class="hljs-comment"># è°ƒç”¨LLMï¼Œä¼ å…¥å·¥å…·åˆ—è¡¨</span>
        response = <span class="hljs-keyword">await</span> self.llm.ask_tool(
            messages=self.messages,
            system_msgs=[Message.system_message(self.system_prompt)],
            tools=self.available_tools.to_params(),  <span class="hljs-comment"># å·¥å…·åˆ—è¡¨</span>
            tool_choice=self.tool_choices,
        )
        <span class="hljs-comment"># è§£æLLMè¿”å›çš„å·¥å…·è°ƒç”¨</span>
        self.tool_calls = response.tool_calls <span class="hljs-keyword">if</span> response <span class="hljs-keyword">else</span> []
        <span class="hljs-comment"># ...</span>

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">act</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-comment"># æ‰§è¡Œå·¥å…·è°ƒç”¨</span>
        <span class="hljs-keyword">for</span> command <span class="hljs-keyword">in</span> self.tool_calls:
            result = <span class="hljs-keyword">await</span> self.execute_tool(command)
            <span class="hljs-comment"># å°†ç»“æœæ·»åŠ åˆ°è®°å¿†</span>
            tool_msg = Message.tool_message(
                content=result,
                tool_call_id=command.<span class="hljs-built_in">id</span>,
                name=command.function.name,
            )
            self.memory.add_message(tool_msg)

</code></pre>
<h3 data-id="heading-6">åº”ç”¨å±‚ï¼ˆApplication Layerï¼‰ï¼š<code>app/agent/manus.py</code></h3>
<p><code>Manus</code>æ˜¯å…·ä½“çš„ä¸šåŠ¡Agentå®ç°ï¼Œé…ç½®äº†å®é™…å¯ç”¨çš„å·¥å…·é›†åˆï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Manus</span>(<span class="hljs-title class_ inherited__">ToolCallAgent</span>):
    name: <span class="hljs-built_in">str</span> = <span class="hljs-string">"Manus"</span>
    system_prompt: <span class="hljs-built_in">str</span> = SYSTEM_PROMPT.<span class="hljs-built_in">format</span>(directory=config.workspace_root)

    <span class="hljs-comment"># é…ç½®å·¥å…·é›†åˆ</span>
    available_tools: ToolCollection = Field(
        default_factory=<span class="hljs-keyword">lambda</span>: ToolCollection(
            PythonExecute(),      <span class="hljs-comment"># Pythonä»£ç æ‰§è¡Œ</span>
            BrowserUseTool(),     <span class="hljs-comment"># æµè§ˆå™¨æ“ä½œ</span>
            StrReplaceEditor(),   <span class="hljs-comment"># æ–‡ä»¶ç¼–è¾‘</span>
            AskHuman(),          <span class="hljs-comment"># äººå·¥äº¤äº’</span>
            Terminate(),         <span class="hljs-comment"># ç»ˆæ­¢å·¥å…·</span>
        )
    )

</code></pre>
<h3 data-id="heading-7">2.2 æ ¸å¿ƒä»£ç æ¨¡å—</h3>
<h3 data-id="heading-8">æ•°æ®æ¨¡å‹ï¼š<code>app/schema.py</code></h3>
<p>å®šä¹‰äº†Agentç³»ç»Ÿçš„æ ¸å¿ƒæ•°æ®ç»“æ„ï¼š</p>
<ul>
<li><strong>Message</strong>ï¼šæ¶ˆæ¯æ¨¡å‹ï¼Œæ”¯æŒuserã€assistantã€systemã€toolå››ç§è§’è‰²</li>
<li><strong>Memory</strong>ï¼šå¯¹è¯å†å²ç®¡ç†ï¼Œç»´æŠ¤å®Œæ•´çš„æ¶ˆæ¯åºåˆ—</li>
<li><strong>ToolCall</strong>ï¼šå·¥å…·è°ƒç”¨ç»“æ„ï¼ŒåŒ…å«å·¥å…·IDã€åç§°å’Œå‚æ•°</li>
<li><strong>AgentState</strong>ï¼šAgentçŠ¶æ€æšä¸¾ï¼ˆIDLEã€RUNNINGã€FINISHEDã€ERRORï¼‰</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Message</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    role: ROLE_TYPE  <span class="hljs-comment"># user/assistant/system/tool</span>
    content: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>]
    tool_calls: <span class="hljs-type">Optional</span>[<span class="hljs-type">List</span>[ToolCall]]
    tool_call_id: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>]  <span class="hljs-comment"># å…³è”å·¥å…·è°ƒç”¨ç»“æœ</span>
    base64_image: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>]  <span class="hljs-comment"># æ”¯æŒå¤šæ¨¡æ€</span>

</code></pre>
<h3 data-id="heading-9">LLMå°è£…ï¼š<code>app/llm.py</code></h3>
<p><code>LLM</code>ç±»æä¾›äº†ç»Ÿä¸€çš„å¤§æ¨¡å‹æ¥å£ï¼Œå…³é”®æ–¹æ³•ï¼š</p>
<ul>
<li><strong><code>ask_tool()</code></strong>ï¼šæ”¯æŒfunction callingçš„è°ƒç”¨æ–¹æ³•ï¼Œæ¥æ”¶å·¥å…·åˆ—è¡¨å¹¶è¿”å›å·¥å…·è°ƒç”¨å†³ç­–</li>
<li><strong>Tokenè®¡æ•°ä¸ç®¡ç†</strong>ï¼šè·Ÿè¸ªè¾“å…¥è¾“å‡ºtokenï¼Œé˜²æ­¢è¶…å‡ºé™åˆ¶</li>
<li><strong>æ¶ˆæ¯æ ¼å¼åŒ–</strong>ï¼šå°†å†…éƒ¨Messageå¯¹è±¡è½¬æ¢ä¸ºLLM APIæ ¼å¼</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">ask_tool</span>(<span class="hljs-params">
    self,
    messages: <span class="hljs-type">List</span>[<span class="hljs-type">Union</span>[<span class="hljs-built_in">dict</span>, Message]],
    system_msgs: <span class="hljs-type">Optional</span>[<span class="hljs-type">List</span>[<span class="hljs-type">Union</span>[<span class="hljs-built_in">dict</span>, Message]]] = <span class="hljs-literal">None</span>,
    tools: <span class="hljs-type">Optional</span>[<span class="hljs-type">List</span>[<span class="hljs-built_in">dict</span>]] = <span class="hljs-literal">None</span>,
    tool_choice: TOOL_CHOICE_TYPE = ToolChoice.AUTO,
</span>) -&gt; ChatCompletionMessage:
    <span class="hljs-comment"># æ ¼å¼åŒ–æ¶ˆæ¯</span>
    messages = self.format_messages(messages, supports_images)

    <span class="hljs-comment"># è®¡ç®—tokenå¹¶æ£€æŸ¥é™åˆ¶</span>
    input_tokens = self.count_message_tokens(messages)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.check_token_limit(input_tokens):
        <span class="hljs-keyword">raise</span> TokenLimitExceeded(...)

    <span class="hljs-comment"># è°ƒç”¨API</span>
    response = <span class="hljs-keyword">await</span> self.client.chat.completions.create(
        model=self.model,
        messages=messages,
        tools=tools,
        tool_choice=tool_choice,
    )
    <span class="hljs-keyword">return</span> response.choices[<span class="hljs-number">0</span>].message

</code></pre>
<h3 data-id="heading-10">å·¥å…·ç³»ç»Ÿï¼š<code>app/tool/</code></h3>
<p>å·¥å…·ç³»ç»Ÿæ˜¯Agentèƒ½åŠ›çš„æ ¸å¿ƒæ‰©å±•ç‚¹ï¼š</p>
<ul>
<li><strong>BaseTool</strong>ï¼šæ‰€æœ‰å·¥å…·çš„æŠ½è±¡åŸºç±»</li>
<li><strong>ToolCollection</strong>ï¼šå·¥å…·é›†åˆç®¡ç†å™¨ï¼Œæä¾›ç»Ÿä¸€çš„å·¥å…·æŸ¥æ‰¾å’Œæ‰§è¡Œæ¥å£</li>
<li><strong>å…·ä½“å·¥å…·å®ç°</strong>ï¼šPythonExecuteã€BrowserUseToolã€StrReplaceEditorç­‰</li>
</ul>
<h2 data-id="heading-11">ä¸‰ã€å·¥å…·å¦‚ä½•è¢«æ·»åŠ åˆ°Agent</h2>
<h3 data-id="heading-12">3.1 å·¥å…·çš„å®šä¹‰ä¸å®ç°</h3>
<h3 data-id="heading-13">å·¥å…·åŸºç±»è®¾è®¡</h3>
<p>æ‰€æœ‰å·¥å…·éƒ½ç»§æ‰¿è‡ª<code>BaseTool</code>ï¼Œå®ƒå®šä¹‰äº†å·¥å…·çš„æ ‡å‡†æ¥å£ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseTool</span>(ABC, BaseModel):
    name: <span class="hljs-built_in">str</span>  <span class="hljs-comment"># å·¥å…·åç§°ï¼Œå¿…é¡»å”¯ä¸€</span>
    description: <span class="hljs-built_in">str</span>  <span class="hljs-comment"># å·¥å…·æè¿°ï¼ŒLLMæ®æ­¤å†³å®šæ˜¯å¦ä½¿ç”¨</span>
    parameters: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">dict</span>]  <span class="hljs-comment"># JSON Schemaæ ¼å¼çš„å‚æ•°å®šä¹‰</span>

<span class="hljs-meta">    @abstractmethod</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">self, **kwargs</span>) -&gt; <span class="hljs-type">Any</span>:
        <span class="hljs-string">"""å·¥å…·æ‰§è¡Œé€»è¾‘ï¼Œå­ç±»å¿…é¡»å®ç°"""</span>
        <span class="hljs-keyword">pass</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">to_param</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-type">Dict</span>:
        <span class="hljs-string">"""è½¬æ¢ä¸ºOpenAI function callingæ ¼å¼"""</span>
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"function"</span>,
            <span class="hljs-string">"function"</span>: {
                <span class="hljs-string">"name"</span>: self.name,
                <span class="hljs-string">"description"</span>: self.description,
                <span class="hljs-string">"parameters"</span>: self.parameters,
            },
        }

</code></pre>
<h3 data-id="heading-14">å·¥å…·å®ç°ç¤ºä¾‹</h3>
<p>ä»¥<code>PythonExecute</code>å·¥å…·ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">PythonExecute</span>(<span class="hljs-title class_ inherited__">BaseTool</span>):
    name: <span class="hljs-built_in">str</span> = <span class="hljs-string">"python_execute"</span>
    description: <span class="hljs-built_in">str</span> = <span class="hljs-string">"Executes Python code string..."</span>
    parameters: <span class="hljs-built_in">dict</span> = {
        <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>,
        <span class="hljs-string">"properties"</span>: {
            <span class="hljs-string">"code"</span>: {
                <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
                <span class="hljs-string">"description"</span>: <span class="hljs-string">"The Python code to execute."</span>,
            },
        },
        <span class="hljs-string">"required"</span>: [<span class="hljs-string">"code"</span>],
    }

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">self, code: <span class="hljs-built_in">str</span>, timeout: <span class="hljs-built_in">int</span> = <span class="hljs-number">5</span></span>) -&gt; <span class="hljs-type">Dict</span>:
        <span class="hljs-string">"""æ‰§è¡ŒPythonä»£ç """</span>
        <span class="hljs-comment"># ä½¿ç”¨å¤šè¿›ç¨‹æ‰§è¡Œï¼Œæ”¯æŒè¶…æ—¶æ§åˆ¶</span>
        <span class="hljs-keyword">with</span> multiprocessing.Manager() <span class="hljs-keyword">as</span> manager:
            result = manager.<span class="hljs-built_in">dict</span>({<span class="hljs-string">"observation"</span>: <span class="hljs-string">""</span>, <span class="hljs-string">"success"</span>: <span class="hljs-literal">False</span>})
            proc = multiprocessing.Process(
                target=self._run_code, args=(code, result, safe_globals)
            )
            proc.start()
            proc.join(timeout)
            <span class="hljs-comment"># ...</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">dict</span>(result)

</code></pre>
<p>å·¥å…·æè¿°çš„è´¨é‡ç›´æ¥å½±å“LLMçš„é€‰æ‹©å‡†ç¡®æ€§ã€‚å¥½çš„æè¿°åº”è¯¥ï¼š</p>
<ul>
<li>æ¸…æ™°è¯´æ˜å·¥å…·çš„ç”¨é€”</li>
<li>æ˜ç¡®å‚æ•°çš„å«ä¹‰å’Œçº¦æŸ</li>
<li>è¯´æ˜å·¥å…·çš„ä½¿ç”¨åœºæ™¯å’Œé™åˆ¶</li>
</ul>
<h3 data-id="heading-15">3.2 Agentä¸­çš„å·¥å…·é…ç½®</h3>
<h3 data-id="heading-16">é™æ€å·¥å…·é…ç½®</h3>
<p>åœ¨Agentç±»å®šä¹‰æ—¶ï¼Œé€šè¿‡<code>Field(default_factory=...)</code>é…ç½®å·¥å…·é›†åˆï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Manus</span>(<span class="hljs-title class_ inherited__">ToolCallAgent</span>):
    available_tools: ToolCollection = Field(
        default_factory=<span class="hljs-keyword">lambda</span>: ToolCollection(
            PythonExecute(),
            BrowserUseTool(),
            StrReplaceEditor(),
            AskHuman(),
            Terminate(),
        )
    )

</code></pre>
<p>è¿™ç§æ–¹å¼é€‚åˆåœ¨Agentåˆå§‹åŒ–æ—¶å°±ç¡®å®šå¯ç”¨çš„å·¥å…·ã€‚</p>
<h3 data-id="heading-17">åŠ¨æ€å·¥å…·æ·»åŠ </h3>
<p><code>ToolCollection</code>æä¾›äº†åŠ¨æ€æ·»åŠ å·¥å…·çš„æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ToolCollection</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, *tools: BaseTool</span>):
        self.tools = tools
        self.tool_map = {tool.name: tool <span class="hljs-keyword">for</span> tool <span class="hljs-keyword">in</span> tools}

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_tool</span>(<span class="hljs-params">self, tool: BaseTool</span>):
        <span class="hljs-string">"""æ·»åŠ å•ä¸ªå·¥å…·"""</span>
        <span class="hljs-keyword">if</span> tool.name <span class="hljs-keyword">in</span> self.tool_map:
            logger.warning(<span class="hljs-string">f"Tool <span class="hljs-subst">{tool.name}</span> already exists, skipping"</span>)
            <span class="hljs-keyword">return</span> self
        self.tools += (tool,)
        self.tool_map[tool.name] = tool
        <span class="hljs-keyword">return</span> self

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_tools</span>(<span class="hljs-params">self, *tools: BaseTool</span>):
        <span class="hljs-string">"""æ‰¹é‡æ·»åŠ å·¥å…·"""</span>
        <span class="hljs-keyword">for</span> tool <span class="hljs-keyword">in</span> tools:
            self.add_tool(tool)
        <span class="hljs-keyword">return</span> self

</code></pre>
<h3 data-id="heading-18">MCPå·¥å…·çš„åŠ¨æ€æ·»åŠ </h3>
<p>OpenManusæ”¯æŒé€šè¿‡MCPï¼ˆModel Context Protocolï¼‰åè®®åŠ¨æ€è¿æ¥è¿œç¨‹å·¥å…·æœåŠ¡å™¨ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Manus</span>(<span class="hljs-title class_ inherited__">ToolCallAgent</span>):
    mcp_clients: MCPClients = Field(default_factory=MCPClients)

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">connect_mcp_server</span>(<span class="hljs-params">
        self, server_url: <span class="hljs-built_in">str</span>, server_id: <span class="hljs-built_in">str</span> = <span class="hljs-string">""</span>, use_stdio: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span>
    </span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-string">"""è¿æ¥MCPæœåŠ¡å™¨å¹¶æ·»åŠ å…¶å·¥å…·"""</span>
        <span class="hljs-keyword">if</span> use_stdio:
            <span class="hljs-keyword">await</span> self.mcp_clients.connect_stdio(server_url, [], server_id)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">await</span> self.mcp_clients.connect_sse(server_url, server_id)

        <span class="hljs-comment"># è·å–æ–°å·¥å…·å¹¶æ·»åŠ åˆ°å¯ç”¨å·¥å…·é›†åˆ</span>
        new_tools = [
            tool <span class="hljs-keyword">for</span> tool <span class="hljs-keyword">in</span> self.mcp_clients.tools
            <span class="hljs-keyword">if</span> tool.server_id == server_id
        ]
        self.available_tools.add_tools(*new_tools)

</code></pre>
<p>MCPå·¥å…·çš„å·¥ä½œæµç¨‹ï¼š</p>
<ol>
<li><strong>è¿æ¥æœåŠ¡å™¨</strong>ï¼šé€šè¿‡SSEæˆ–stdioå»ºç«‹è¿æ¥</li>
<li><strong>å‘ç°å·¥å…·</strong>ï¼šè°ƒç”¨<code>list_tools()</code>è·å–æœåŠ¡å™¨æä¾›çš„å·¥å…·åˆ—è¡¨</li>
<li><strong>åˆ›å»ºä»£ç†å·¥å…·</strong>ï¼šä¸ºæ¯ä¸ªè¿œç¨‹å·¥å…·åˆ›å»º<code>MCPClientTool</code>ä»£ç†</li>
<li><strong>æ·»åŠ åˆ°é›†åˆ</strong>ï¼šå°†ä»£ç†å·¥å…·æ·»åŠ åˆ°Agentçš„å·¥å…·é›†åˆä¸­</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MCPClientTool</span>(<span class="hljs-title class_ inherited__">BaseTool</span>):
    <span class="hljs-string">"""MCPå·¥å…·çš„ä»£ç†ï¼Œæ‰§è¡Œæ—¶è°ƒç”¨è¿œç¨‹æœåŠ¡å™¨"""</span>
    session: <span class="hljs-type">Optional</span>[ClientSession] = <span class="hljs-literal">None</span>
    server_id: <span class="hljs-built_in">str</span> = <span class="hljs-string">""</span>
    original_name: <span class="hljs-built_in">str</span> = <span class="hljs-string">""</span>

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">self, **kwargs</span>) -&gt; ToolResult:
        <span class="hljs-string">"""é€šè¿‡MCPåè®®è°ƒç”¨è¿œç¨‹å·¥å…·"""</span>
        result = <span class="hljs-keyword">await</span> self.session.call_tool(self.original_name, kwargs)
        <span class="hljs-keyword">return</span> ToolResult(output=result.content)

</code></pre>
<h3 data-id="heading-19">3.3 å·¥å…·Schemaè½¬æ¢</h3>
<p>å·¥å…·å¿…é¡»è½¬æ¢ä¸ºLLMå¯ç†è§£çš„æ ¼å¼ã€‚<code>to_param()</code>æ–¹æ³•å°†å·¥å…·è½¬æ¢ä¸ºOpenAI function callingæ ¼å¼ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">to_param</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-type">Dict</span>:
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">"type"</span>: <span class="hljs-string">"function"</span>,
        <span class="hljs-string">"function"</span>: {
            <span class="hljs-string">"name"</span>: self.name,
            <span class="hljs-string">"description"</span>: self.description,
            <span class="hljs-string">"parameters"</span>: self.parameters,  <span class="hljs-comment"># JSON Schemaæ ¼å¼</span>
        },
    }

</code></pre>
<p><code>ToolCollection.to_params()</code>å°†æ‰€æœ‰å·¥å…·è½¬æ¢ä¸ºåˆ—è¡¨ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">to_params</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]]:
    <span class="hljs-keyword">return</span> [tool.to_param() <span class="hljs-keyword">for</span> tool <span class="hljs-keyword">in</span> self.tools]

</code></pre>
<p>è¿™ä¸ªå·¥å…·åˆ—è¡¨ä¼šè¢«ä¼ é€’ç»™LLMï¼ŒLLMæ ¹æ®å·¥å…·æè¿°å’Œå½“å‰ä¸Šä¸‹æ–‡ï¼Œå†³å®šè°ƒç”¨å“ªäº›å·¥å…·ã€‚</p>
<h2 data-id="heading-20">å››ã€Agentå¦‚ä½•è°ƒç”¨è¿™äº›å·¥å…·</h2>
<h3 data-id="heading-21">4.1 å·¥å…·è°ƒç”¨çš„å®Œæ•´æµç¨‹</h3>
<p>Agentè°ƒç”¨å·¥å…·çš„è¿‡ç¨‹éµå¾ªReActæ¨¡å¼ï¼Œåˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š</p>
<h3 data-id="heading-22">Step 1: æ€è€ƒé˜¶æ®µï¼ˆthinkï¼‰</h3>
<p>Agentåˆ†æå½“å‰çŠ¶æ€ï¼Œå†³å®šéœ€è¦è°ƒç”¨å“ªäº›å·¥å…·ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">think</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">bool</span>:
    <span class="hljs-comment"># 1. æ·»åŠ ä¸‹ä¸€æ­¥æç¤ºåˆ°æ¶ˆæ¯å†å²</span>
    <span class="hljs-keyword">if</span> self.next_step_prompt:
        user_msg = Message.user_message(self.next_step_prompt)
        self.messages += [user_msg]

    <span class="hljs-comment"># 2. è°ƒç”¨LLMï¼Œä¼ å…¥å·¥å…·åˆ—è¡¨</span>
    response = <span class="hljs-keyword">await</span> self.llm.ask_tool(
        messages=self.messages,  <span class="hljs-comment"># å¯¹è¯å†å²</span>
        system_msgs=[Message.system_message(self.system_prompt)],
        tools=self.available_tools.to_params(),  <span class="hljs-comment"># å·¥å…·åˆ—è¡¨</span>
        tool_choice=self.tool_choices,  <span class="hljs-comment"># AUTO/REQUIRED/NONE</span>
    )

    <span class="hljs-comment"># 3. è§£æLLMè¿”å›çš„å·¥å…·è°ƒç”¨</span>
    self.tool_calls = response.tool_calls <span class="hljs-keyword">if</span> response <span class="hljs-keyword">else</span> []
    content = response.content <span class="hljs-keyword">if</span> response <span class="hljs-keyword">else</span> <span class="hljs-string">""</span>

    <span class="hljs-comment"># 4. åˆ›å»ºAssistantæ¶ˆæ¯å¹¶æ·»åŠ åˆ°è®°å¿†</span>
    assistant_msg = Message.from_tool_calls(
        content=content, tool_calls=self.tool_calls
    )
    self.memory.add_message(assistant_msg)

    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bool</span>(self.tool_calls)

</code></pre>
<p>LLMæ¥æ”¶çš„ä¿¡æ¯åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>å¯¹è¯å†å²</strong>ï¼šç”¨æˆ·è¯·æ±‚ã€ä¹‹å‰çš„å·¥å…·è°ƒç”¨å’Œç»“æœ</li>
<li><strong>ç³»ç»Ÿæç¤ºè¯</strong>ï¼šå®šä¹‰Agentçš„è§’è‰²å’Œèƒ½åŠ›è¾¹ç•Œ</li>
<li><strong>å·¥å…·åˆ—è¡¨</strong>ï¼šæ‰€æœ‰å¯ç”¨å·¥å…·çš„schema</li>
<li><strong>ä¸‹ä¸€æ­¥æç¤º</strong>ï¼šæŒ‡å¯¼Agentå¦‚ä½•é€‰æ‹©å·¥å…·</li>
</ul>
<p>LLMåŸºäºè¿™äº›ä¿¡æ¯ï¼Œç”Ÿæˆç»“æ„åŒ–çš„å·¥å…·è°ƒç”¨å†³ç­–ã€‚</p>
<h3 data-id="heading-23">Step 2: æ‰§è¡Œé˜¶æ®µï¼ˆactï¼‰</h3>
<p>Agentæ‰§è¡ŒLLMå†³å®šçš„å·¥å…·è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">act</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.tool_calls:
        <span class="hljs-keyword">return</span> self.messages[-<span class="hljs-number">1</span>].content <span class="hljs-keyword">or</span> <span class="hljs-string">"No action to execute"</span>

    results = []
    <span class="hljs-keyword">for</span> command <span class="hljs-keyword">in</span> self.tool_calls:
        <span class="hljs-comment"># æ‰§è¡Œå•ä¸ªå·¥å…·è°ƒç”¨</span>
        result = <span class="hljs-keyword">await</span> self.execute_tool(command)

        <span class="hljs-comment"># å°†ç»“æœå°è£…ä¸ºToolMessage</span>
        tool_msg = Message.tool_message(
            content=result,
            tool_call_id=command.<span class="hljs-built_in">id</span>,
            name=command.function.name,
        )
        self.memory.add_message(tool_msg)
        results.append(result)

    <span class="hljs-keyword">return</span> <span class="hljs-string">"\\n\\n"</span>.join(results)

</code></pre>
<h3 data-id="heading-24">Step 3: ç»“æœåé¦ˆ</h3>
<p>å·¥å…·æ‰§è¡Œç»“æœè¢«æ·»åŠ åˆ°å¯¹è¯å†å²ï¼Œä¾›ä¸‹ä¸€è½®æ€è€ƒä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute_tool</span>(<span class="hljs-params">self, command: ToolCall</span>) -&gt; <span class="hljs-built_in">str</span>:
    name = command.function.name

    <span class="hljs-comment"># 1. æŸ¥æ‰¾å·¥å…·å®ä¾‹</span>
    <span class="hljs-keyword">if</span> name <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> self.available_tools.tool_map:
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"Error: Unknown tool '<span class="hljs-subst">{name}</span>'"</span>

    <span class="hljs-comment"># 2. è§£æå‚æ•°</span>
    args = json.loads(command.function.arguments <span class="hljs-keyword">or</span> <span class="hljs-string">"{}"</span>)

    <span class="hljs-comment"># 3. æ‰§è¡Œå·¥å…·</span>
    result = <span class="hljs-keyword">await</span> self.available_tools.execute(name=name, tool_input=args)

    <span class="hljs-comment"># 4. å¤„ç†ç‰¹æ®Šå·¥å…·ï¼ˆå¦‚Terminateï¼‰</span>
    <span class="hljs-keyword">await</span> self._handle_special_tool(name=name, result=result)

    <span class="hljs-comment"># 5. æ ¼å¼åŒ–ç»“æœ</span>
    observation = <span class="hljs-string">f"Observed output of cmd `<span class="hljs-subst">{name}</span>` executed:\\n<span class="hljs-subst">{<span class="hljs-built_in">str</span>(result)}</span>"</span>
    <span class="hljs-keyword">return</span> observation

</code></pre>
<h3 data-id="heading-25">4.2 æ ¸å¿ƒä»£ç æµç¨‹</h3>
<h3 data-id="heading-26">ToolCollection.execute()ï¼šå·¥å…·æ‰§è¡Œå…¥å£</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">
    self, *, name: <span class="hljs-built_in">str</span>, tool_input: <span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>] = <span class="hljs-literal">None</span>
</span>) -&gt; ToolResult:
    <span class="hljs-comment"># 1. æ ¹æ®åç§°æŸ¥æ‰¾å·¥å…·</span>
    tool = self.tool_map.get(name)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> tool:
        <span class="hljs-keyword">return</span> ToolFailure(error=<span class="hljs-string">f"Tool <span class="hljs-subst">{name}</span> is invalid"</span>)

    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># 2. è°ƒç”¨å·¥å…·çš„executeæ–¹æ³•</span>
        result = <span class="hljs-keyword">await</span> tool(**tool_input)
        <span class="hljs-keyword">return</span> result
    <span class="hljs-keyword">except</span> ToolError <span class="hljs-keyword">as</span> e:
        <span class="hljs-keyword">return</span> ToolFailure(error=e.message)

</code></pre>
<h3 data-id="heading-27">å·¥å…·é€‰æ‹©ç­–ç•¥</h3>
<p><code>tool_choice</code>å‚æ•°æ§åˆ¶LLMçš„å·¥å…·é€‰æ‹©è¡Œä¸ºï¼š</p>
<ul>
<li><strong>AUTO</strong>ï¼šLLMè‡ªä¸»å†³å®šæ˜¯å¦è°ƒç”¨å·¥å…·ï¼ˆé»˜è®¤ï¼‰</li>
<li><strong>REQUIRED</strong>ï¼šå¿…é¡»è°ƒç”¨è‡³å°‘ä¸€ä¸ªå·¥å…·</li>
<li><strong>NONE</strong>ï¼šä¸å…è®¸è°ƒç”¨å·¥å…·ï¼Œåªèƒ½è¿”å›æ–‡æœ¬</li>
</ul>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">if</span> self.tool_choices == ToolChoice.REQUIRED <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> self.tool_calls:
    <span class="hljs-comment"># è¦æ±‚è°ƒç”¨å·¥å…·ä½†LLMæ²¡æœ‰è¿”å›ï¼Œå¯èƒ½éœ€è¦é‡è¯•</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>

<span class="hljs-keyword">if</span> self.tool_choices == ToolChoice.AUTO <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> self.tool_calls:
    <span class="hljs-comment"># è‡ªåŠ¨æ¨¡å¼ï¼Œå¦‚æœæ²¡æœ‰å·¥å…·è°ƒç”¨ä½†æœ‰æ–‡æœ¬å†…å®¹ï¼Œç»§ç»­</span>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bool</span>(content)

</code></pre>
<h3 data-id="heading-28">4.3 æ‰§è¡Œå¾ªç¯</h3>
<p>å®Œæ•´çš„æ‰§è¡Œå¾ªç¯åœ¨<code>BaseAgent.run()</code>ä¸­å®ç°ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self, request: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = <span class="hljs-literal">None</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-keyword">if</span> request:
        self.update_memory(<span class="hljs-string">"user"</span>, request)

    results: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>] = []
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> self.state_context(AgentState.RUNNING):
        <span class="hljs-keyword">while</span> (
            self.current_step &lt; self.max_steps <span class="hljs-keyword">and</span>
            self.state != AgentState.FINISHED
        ):
            self.current_step += <span class="hljs-number">1</span>

            <span class="hljs-comment"># æ‰§è¡Œå•æ­¥ï¼šthink -&gt; act</span>
            step_result = <span class="hljs-keyword">await</span> self.step()

            <span class="hljs-comment"># æ£€æµ‹æ˜¯å¦å¡æ­»</span>
            <span class="hljs-keyword">if</span> self.is_stuck():
                self.handle_stuck_state()

            results.append(<span class="hljs-string">f"Step <span class="hljs-subst">{self.current_step}</span>: <span class="hljs-subst">{step_result}</span>"</span>)

    <span class="hljs-keyword">return</span> <span class="hljs-string">"\\n"</span>.join(results)

</code></pre>
<p>æ¯ä¸€æ­¥éƒ½æ˜¯å®Œæ•´çš„think-actå¾ªç¯ï¼Œç›´åˆ°ä»»åŠ¡å®Œæˆæˆ–è¾¾åˆ°æœ€å¤§æ­¥æ•°ã€‚</p>
<h2 data-id="heading-29">äº”ã€Agentæ˜¯å¦‚ä½•æ€è€ƒçš„</h2>
<h3 data-id="heading-30">5.1 ReActæ¨¡å¼ï¼šæ¨ç†ä¸è¡ŒåŠ¨å¾ªç¯</h3>
<p>ReActï¼ˆReasoning + Actingï¼‰æ˜¯ç°ä»£Agentçš„æ ¸å¿ƒæ¨¡å¼ï¼Œå®ƒå°†Agentçš„æ‰§è¡Œåˆ†ä¸ºä¸‰ä¸ªç¯èŠ‚ï¼š</p>
<ol>
<li><strong>Reasoningï¼ˆæ¨ç†ï¼‰</strong>ï¼šåˆ†æå½“å‰çŠ¶æ€ï¼Œç†è§£ä»»åŠ¡ï¼Œå†³å®šä¸‹ä¸€æ­¥è¡ŒåŠ¨</li>
<li><strong>Actingï¼ˆè¡ŒåŠ¨ï¼‰</strong>ï¼šæ‰§è¡Œé€‰å®šçš„å·¥å…·</li>
<li><strong>Observingï¼ˆè§‚å¯Ÿï¼‰</strong>ï¼šæ”¶é›†å·¥å…·æ‰§è¡Œç»“æœï¼Œæ›´æ–°çŠ¶æ€</li>
</ol>
<p>è¿™ä¸‰ä¸ªç¯èŠ‚å¾ªç¯å¾€å¤ï¼Œç›´åˆ°ä»»åŠ¡å®Œæˆã€‚</p>
<h3 data-id="heading-31">å®ç°æœºåˆ¶</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">step</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">str</span>:
    should_act = <span class="hljs-keyword">await</span> self.think()  <span class="hljs-comment"># æ€è€ƒï¼šåˆ†æå¹¶å†³ç­–</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> should_act:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Thinking complete - no action needed"</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> self.act()  <span class="hljs-comment"># è¡ŒåŠ¨ï¼šæ‰§è¡Œå·¥å…·</span>

</code></pre>
<p>è¿™ç§è®¾è®¡çš„ä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>å¯è§£é‡Šæ€§</strong>ï¼šæ¯ä¸€æ­¥çš„æ€è€ƒè¿‡ç¨‹éƒ½è®°å½•åœ¨å¯¹è¯å†å²ä¸­</li>
<li><strong>å¯æ§æ€§</strong>ï¼šå¯ä»¥åœ¨æ€è€ƒé˜¶æ®µè¿›è¡Œå¹²é¢„å’Œè°ƒæ•´</li>
<li><strong>å¯æ‰©å±•æ€§</strong>ï¼šå¯ä»¥è½»æ¾æ·»åŠ æ–°çš„æ€è€ƒç­–ç•¥</li>
</ul>
<h3 data-id="heading-32">5.2 LLMé©±åŠ¨çš„å†³ç­–æœºåˆ¶</h3>
<h3 data-id="heading-33">æç¤ºè¯å·¥ç¨‹</h3>
<p>Agentçš„æ€è€ƒèƒ½åŠ›ä¸»è¦ä¾èµ–äºç²¾å¿ƒè®¾è®¡çš„æç¤ºè¯ï¼š</p>
<p><strong>System Prompt</strong>ï¼šå®šä¹‰Agentçš„è§’è‰²å’Œèƒ½åŠ›è¾¹ç•Œ</p>
<pre><code class="hljs language-python" lang="python">SYSTEM_PROMPT = (
    <span class="hljs-string">"You are OpenManus, an all-capable AI assistant, aimed at solving any task "</span>
    <span class="hljs-string">"presented by the user. You have various tools at your disposal that you can "</span>
    <span class="hljs-string">"call upon to efficiently complete complex requests. Whether it's programming, "</span>
    <span class="hljs-string">"information retrieval, file processing, web browsing, or human interaction "</span>
    <span class="hljs-string">"(only for extreme cases), you can handle it all."</span>
    <span class="hljs-string">"The initial directory is: {directory}"</span>
)

</code></pre>
<p><strong>Next Step Prompt</strong>ï¼šæŒ‡å¯¼Agentå¦‚ä½•é€‰æ‹©å·¥å…·</p>
<pre><code class="hljs language-python" lang="python">NEXT_STEP_PROMPT = <span class="hljs-string">"""
Based on user needs, proactively select the most appropriate tool or combination
of tools. For complex tasks, you can break down the problem and use different tools
step by step to solve it. After using each tool, clearly explain the execution
results and suggest the next steps.

If you want to stop the interaction at any point, use the `terminate` tool/function call.
"""</span>

</code></pre>
<p><strong>å·¥å…·æè¿°</strong>ï¼šæ¯ä¸ªå·¥å…·çš„nameã€descriptionã€parameterså…±åŒæ„æˆLLMå†³ç­–çš„ä¾æ®</p>
<h3 data-id="heading-34">Function Callingæœºåˆ¶</h3>
<p>LLMçš„function callingèƒ½åŠ›ä½¿å¾—Agentèƒ½å¤Ÿè¿›è¡Œç»“æ„åŒ–å†³ç­–ï¼š</p>
<pre><code class="hljs language-python" lang="python">response = <span class="hljs-keyword">await</span> self.llm.ask_tool(
    messages=self.messages,  <span class="hljs-comment"># å®Œæ•´çš„å¯¹è¯å†å²</span>
    system_msgs=[Message.system_message(self.system_prompt)],
    tools=self.available_tools.to_params(),  <span class="hljs-comment"># å·¥å…·schemaåˆ—è¡¨</span>
    tool_choice=self.tool_choices,  <span class="hljs-comment"># é€‰æ‹©ç­–ç•¥</span>
)

</code></pre>
<p>LLMçš„å¤„ç†è¿‡ç¨‹ï¼š</p>
<ol>
<li><strong>ç†è§£ä¸Šä¸‹æ–‡</strong>ï¼šåˆ†æå¯¹è¯å†å²ï¼Œç†è§£å½“å‰ä»»åŠ¡çŠ¶æ€</li>
<li><strong>è¯„ä¼°å·¥å…·</strong>ï¼šæ ¹æ®å·¥å…·æè¿°ï¼Œè¯„ä¼°å“ªäº›å·¥å…·é€‚åˆå½“å‰ä»»åŠ¡</li>
<li><strong>ç”Ÿæˆè°ƒç”¨</strong>ï¼šç”Ÿæˆç»“æ„åŒ–çš„å·¥å…·è°ƒç”¨ï¼ŒåŒ…å«å·¥å…·åç§°å’Œå‚æ•°</li>
<li><strong>å‚æ•°éªŒè¯</strong>ï¼šå‚æ•°å¿…é¡»ç¬¦åˆJSON Schemaå®šä¹‰</li>
</ol>
<p>LLMè¿”å›çš„æ ¼å¼ï¼š</p>
<pre><code class="hljs language-python" lang="python">{
    <span class="hljs-string">"content"</span>: <span class="hljs-string">"æˆ‘éœ€è¦å…ˆæŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼Œç„¶åè¿›è¡Œç¼–è¾‘"</span>,  <span class="hljs-comment"># æ€è€ƒè¿‡ç¨‹</span>
    <span class="hljs-string">"tool_calls"</span>: [
        {
            <span class="hljs-string">"id"</span>: <span class="hljs-string">"call_abc123"</span>,
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"function"</span>,
            <span class="hljs-string">"function"</span>: {
                <span class="hljs-string">"name"</span>: <span class="hljs-string">"str_replace_editor"</span>,
                <span class="hljs-string">"arguments"</span>: <span class="hljs-string">'{"command": "view", "path": "/path/to/file"}'</span>
            }
        }
    ]
}

</code></pre>
<h3 data-id="heading-35">5.3 çŠ¶æ€ç®¡ç†ä¸å¾ªç¯æ§åˆ¶</h3>
<h3 data-id="heading-36">AgentçŠ¶æ€æœº</h3>
<p>Agentçš„çŠ¶æ€è½¬æ¢éµå¾ªæ˜ç¡®çš„çŠ¶æ€æœºï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AgentState</span>(<span class="hljs-built_in">str</span>, Enum):
    IDLE = <span class="hljs-string">"IDLE"</span>      <span class="hljs-comment"># ç©ºé—²ï¼Œç­‰å¾…ä»»åŠ¡</span>
    RUNNING = <span class="hljs-string">"RUNNING"</span>  <span class="hljs-comment"># æ‰§è¡Œä¸­</span>
    FINISHED = <span class="hljs-string">"FINISHED"</span>  <span class="hljs-comment"># ä»»åŠ¡å®Œæˆ</span>
    ERROR = <span class="hljs-string">"ERROR"</span>    <span class="hljs-comment"># å‘ç”Ÿé”™è¯¯</span>

</code></pre>
<p>çŠ¶æ€è½¬æ¢é€šè¿‡ä¸Šä¸‹æ–‡ç®¡ç†å™¨å®‰å…¨æ§åˆ¶ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@asynccontextmanager</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">state_context</span>(<span class="hljs-params">self, new_state: AgentState</span>):
    previous_state = self.state
    self.state = new_state
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">yield</span>
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        self.state = AgentState.ERROR
        <span class="hljs-keyword">raise</span> e
    <span class="hljs-keyword">finally</span>:
        self.state = previous_state

</code></pre>
<h3 data-id="heading-37">æ‰§è¡Œå¾ªç¯æ§åˆ¶</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">while</span> (
    self.current_step &lt; self.max_steps <span class="hljs-keyword">and</span>
    self.state != AgentState.FINISHED
):
    self.current_step += <span class="hljs-number">1</span>
    step_result = <span class="hljs-keyword">await</span> self.step()

    <span class="hljs-comment"># å¡æ­»æ£€æµ‹</span>
    <span class="hljs-keyword">if</span> self.is_stuck():
        self.handle_stuck_state()

</code></pre>
<p><strong>å¡æ­»æ£€æµ‹æœºåˆ¶</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_stuck</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">bool</span>:
    <span class="hljs-string">"""æ£€æµ‹Agentæ˜¯å¦é™·å…¥å¾ªç¯"""</span>
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.memory.messages) &lt; <span class="hljs-number">2</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>

    last_message = self.memory.messages[-<span class="hljs-number">1</span>]
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> last_message.content:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>

    <span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦æœ‰é‡å¤çš„assistantæ¶ˆæ¯</span>
    duplicate_count = <span class="hljs-built_in">sum</span>(
        <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(self.memory.messages[:-<span class="hljs-number">1</span>])
        <span class="hljs-keyword">if</span> msg.role == <span class="hljs-string">"assistant"</span> <span class="hljs-keyword">and</span> msg.content == last_message.content
    )

    <span class="hljs-keyword">return</span> duplicate_count &gt;= self.duplicate_threshold

</code></pre>
<p>å½“æ£€æµ‹åˆ°å¡æ­»æ—¶ï¼ŒAgentä¼šæ·»åŠ æç¤ºè¯å¼•å¯¼æ”¹å˜ç­–ç•¥ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_stuck_state</span>(<span class="hljs-params">self</span>):
    stuck_prompt = (
        <span class="hljs-string">"Observed duplicate responses. Consider new strategies and avoid "</span>
        <span class="hljs-string">"repeating ineffective paths already attempted."</span>
    )
    self.next_step_prompt = <span class="hljs-string">f"<span class="hljs-subst">{stuck_prompt}</span>\\n<span class="hljs-subst">{self.next_step_prompt}</span>"</span>

</code></pre>
<h3 data-id="heading-38">ç‰¹æ®Šå·¥å…·å¤„ç†</h3>
<p>æŸäº›å·¥å…·å…·æœ‰ç‰¹æ®Šè¯­ä¹‰ï¼Œå¦‚<code>Terminate</code>å·¥å…·ä¼šç»ˆæ­¢Agentæ‰§è¡Œï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">_handle_special_tool</span>(<span class="hljs-params">self, name: <span class="hljs-built_in">str</span>, result: <span class="hljs-type">Any</span>, **kwargs</span>):
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self._is_special_tool(name):
        <span class="hljs-keyword">return</span>

    <span class="hljs-keyword">if</span> self._should_finish_execution(name=name, result=result, **kwargs):
        logger.info(<span class="hljs-string">f"Special tool '<span class="hljs-subst">{name}</span>' has completed the task!"</span>)
        self.state = AgentState.FINISHED

</code></pre>
<h3 data-id="heading-39">5.4 ä¸Šä¸‹æ–‡æ„ŸçŸ¥ä¸è®°å¿†ç®¡ç†</h3>
<h3 data-id="heading-40">Memoryæœºåˆ¶</h3>
<p><code>Memory</code>ç±»ç»´æŠ¤å®Œæ•´çš„å¯¹è¯å†å²ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Memory</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    messages: <span class="hljs-type">List</span>[Message] = Field(default_factory=<span class="hljs-built_in">list</span>)
    max_messages: <span class="hljs-built_in">int</span> = Field(default=<span class="hljs-number">100</span>)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_message</span>(<span class="hljs-params">self, message: Message</span>) -&gt; <span class="hljs-literal">None</span>:
        self.messages.append(message)
        <span class="hljs-comment"># é™åˆ¶æ¶ˆæ¯æ•°é‡ï¼Œä¿ç•™æœ€è¿‘çš„</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.messages) &gt; self.max_messages:
            self.messages = self.messages[-self.max_messages:]

</code></pre>
<p>å¯¹è¯å†å²åŒ…å«å®Œæ•´çš„äº¤äº’åºåˆ—ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">User:</span> <span class="hljs-string">"å¸®æˆ‘åˆ›å»ºä¸€ä¸ªPythonè„šæœ¬"</span>
<span class="hljs-symbol">Assistant:</span> [æ€è€ƒè¿‡ç¨‹] [tool_calls: python_execute]
<span class="hljs-symbol">Tool:</span> [æ‰§è¡Œç»“æœ]
<span class="hljs-symbol">Assistant:</span> [åˆ†æç»“æœ] [tool_calls: str_replace_editor]
<span class="hljs-symbol">Tool:</span> [æ–‡ä»¶åˆ›å»ºç»“æœ]
<span class="hljs-symbol">Assistant:</span> <span class="hljs-string">"è„šæœ¬å·²åˆ›å»ºå®Œæˆ"</span>

</code></pre>
<h3 data-id="heading-41">ä¸Šä¸‹æ–‡æ„å»º</h3>
<p>Agentçš„ä¸Šä¸‹æ–‡ç”±ä¸‰éƒ¨åˆ†æ„æˆï¼š</p>
<ol>
<li><strong>ç³»ç»Ÿæç¤ºè¯</strong>ï¼šå®šä¹‰Agentçš„èƒ½åŠ›è¾¹ç•Œå’Œè§’è‰²</li>
<li><strong>å¯¹è¯å†å²</strong>ï¼šåŒ…å«ç”¨æˆ·è¯·æ±‚ã€Agentæ€è€ƒã€å·¥å…·è°ƒç”¨ã€å·¥å…·ç»“æœ</li>
<li><strong>åŠ¨æ€æç¤ºè¯</strong>ï¼šæ ¹æ®å½“å‰çŠ¶æ€è°ƒæ•´ï¼ˆå¦‚æµè§ˆå™¨ä½¿ç”¨æ—¶çš„ä¸Šä¸‹æ–‡ï¼‰</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">think</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">bool</span>:
    <span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦åœ¨ä½¿ç”¨æµè§ˆå™¨</span>
    browser_in_use = <span class="hljs-built_in">any</span>(
        tc.function.name == BrowserUseTool().name
        <span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> recent_messages
        <span class="hljs-keyword">if</span> msg.tool_calls
        <span class="hljs-keyword">for</span> tc <span class="hljs-keyword">in</span> msg.tool_calls
    )

    <span class="hljs-comment"># å¦‚æœä½¿ç”¨æµè§ˆå™¨ï¼Œæ·»åŠ æµè§ˆå™¨ä¸Šä¸‹æ–‡</span>
    <span class="hljs-keyword">if</span> browser_in_use:
        self.next_step_prompt = (
            <span class="hljs-keyword">await</span> self.browser_context_helper.format_next_step_prompt()
        )

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-built_in">super</span>().think()

</code></pre>
<p>è¿™ç§åŠ¨æ€ä¸Šä¸‹æ–‡è°ƒæ•´ä½¿å¾—Agentèƒ½å¤Ÿæ ¹æ®å½“å‰ä»»åŠ¡çŠ¶æ€ï¼Œæä¾›æ›´ç²¾å‡†çš„å†³ç­–ã€‚</p>
<h2 data-id="heading-42">å…­ã€æ¶æ„å›¾ä¸æ•°æ®æµ</h2>
<h3 data-id="heading-43">6.1 Agentæ‰§è¡Œæµç¨‹å›¾</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    Start([å¼€å§‹]) --&gt; Init[åˆå§‹åŒ–Agent]
    Init --&gt; SetState[è®¾ç½®çŠ¶æ€ä¸ºRUNNING]
    SetState --&gt; CheckStep{æ£€æŸ¥æ­¥æ•°é™åˆ¶}
    CheckStep --&gt;|æœªè¶…é™| Think[think: æ€è€ƒé˜¶æ®µ]
    CheckStep --&gt;|è¶…é™| Finish[ç»ˆæ­¢æ‰§è¡Œ]
    Think --&gt; LLMCall[è°ƒç”¨LLM.ask_tool]
    LLMCall --&gt; ParseTool[è§£æå·¥å…·è°ƒç”¨]
    ParseTool --&gt; HasTool{æ˜¯å¦æœ‰å·¥å…·è°ƒç”¨?}
    HasTool --&gt;|æ˜¯| Act[act: æ‰§è¡Œé˜¶æ®µ]
    HasTool --&gt;|å¦| CheckContent{æ˜¯å¦æœ‰æ–‡æœ¬å†…å®¹?}
    CheckContent --&gt;|æ˜¯| Continue[ç»§ç»­å¾ªç¯]
    CheckContent --&gt;|å¦| Finish
    Act --&gt; ExecuteTool[æ‰§è¡Œå·¥å…·]
    ExecuteTool --&gt; AddResult[æ·»åŠ ç»“æœåˆ°Memory]
    AddResult --&gt; CheckStuck{æ£€æµ‹æ˜¯å¦å¡æ­»?}
    CheckStuck --&gt;|æ˜¯| HandleStuck[å¤„ç†å¡æ­»çŠ¶æ€]
    CheckStuck --&gt;|å¦| CheckFinish{ä»»åŠ¡å®Œæˆ?}
    HandleStuck --&gt; CheckFinish
    CheckFinish --&gt;|æœªå®Œæˆ| Continue
    CheckFinish --&gt;|å®Œæˆ| SetFinished[è®¾ç½®çŠ¶æ€ä¸ºFINISHED]
    Continue --&gt; CheckStep
    SetFinished --&gt; Finish
    Finish --&gt; End([ç»“æŸ])

</code></pre>
<h3 data-id="heading-44">6.2 å·¥å…·è°ƒç”¨åºåˆ—å›¾</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant User as ç”¨æˆ·
    participant Agent as Agent
    participant LLM as å¤§è¯­è¨€æ¨¡å‹
    participant Tools as å·¥å…·é›†åˆ
    participant Tool as å…·ä½“å·¥å…·
    participant Memory as è®°å¿†ç³»ç»Ÿ

    User-&gt;&gt;Agent: å‘é€è¯·æ±‚
    Agent-&gt;&gt;Memory: æ·»åŠ ç”¨æˆ·æ¶ˆæ¯

    loop æ‰§è¡Œå¾ªç¯
        Agent-&gt;&gt;Agent: think()
        Agent-&gt;&gt;Memory: è·å–å¯¹è¯å†å²
        Agent-&gt;&gt;LLM: ask_tool(å†å²+å·¥å…·åˆ—è¡¨)
        LLM-&gt;&gt;LLM: åˆ†æä¸Šä¸‹æ–‡
        LLM-&gt;&gt;LLM: é€‰æ‹©å·¥å…·
        LLM--&gt;&gt;Agent: è¿”å›å·¥å…·è°ƒç”¨å†³ç­–
        Agent-&gt;&gt;Memory: æ·»åŠ Assistantæ¶ˆæ¯

        Agent-&gt;&gt;Agent: act()
        loop éå†å·¥å…·è°ƒç”¨
            Agent-&gt;&gt;Tools: execute(å·¥å…·å, å‚æ•°)
            Tools-&gt;&gt;Tool: æŸ¥æ‰¾å·¥å…·å®ä¾‹
            Tool-&gt;&gt;Tool: æ‰§è¡Œå·¥å…·é€»è¾‘
            Tool--&gt;&gt;Tools: è¿”å›ç»“æœ
            Tools--&gt;&gt;Agent: è¿”å›ToolResult
            Agent-&gt;&gt;Memory: æ·»åŠ Toolæ¶ˆæ¯
        end

        Agent-&gt;&gt;Agent: æ£€æŸ¥æ˜¯å¦å®Œæˆ
    end

    Agent--&gt;&gt;User: è¿”å›æœ€ç»ˆç»“æœ

</code></pre>
<h3 data-id="heading-45">6.3 ç±»ç»§æ‰¿å…³ç³»å›¾</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">classDiagram
    class BaseAgent {
        +name: str
        +memory: Memory
        +state: AgentState
        +run()
        +step()*
        +update_memory()
    }

    class ReActAgent {
        +think()*
        +act()*
        +step()
    }

    class ToolCallAgent {
        +available_tools: ToolCollection
        +tool_calls: List[ToolCall]
        +think()
        +act()
        +execute_tool()
    }

    class Manus {
        +mcp_clients: MCPClients
        +connect_mcp_server()
    }

    class BaseTool {
        &lt;&lt;abstract&gt;&gt;
        +name: str
        +description: str
        +parameters: dict
        +execute()*
        +to_param()
    }

    class ToolCollection {
        +tools: tuple
        +tool_map: dict
        +execute()
        +add_tool()
        +to_params()
    }

    class PythonExecute {
        +execute()
    }

    class BrowserUseTool {
        +execute()
    }

    BaseAgent &lt;|-- ReActAgent
    ReActAgent &lt;|-- ToolCallAgent
    ToolCallAgent &lt;|-- Manus
    BaseTool &lt;|-- PythonExecute
    BaseTool &lt;|-- BrowserUseTool
    ToolCollection o-- BaseTool
    ToolCallAgent o-- ToolCollection

</code></pre>
<h3 data-id="heading-46">6.4 æ•°æ®æµå›¾</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
    subgraph Input[è¾“å…¥å±‚]
        UserRequest[ç”¨æˆ·è¯·æ±‚]
        SystemPrompt[ç³»ç»Ÿæç¤ºè¯]
        ToolSchemas[å·¥å…·Schemaåˆ—è¡¨]
    end

    subgraph Processing[å¤„ç†å±‚]
        Memory[è®°å¿†ç³»ç»Ÿ]
        LLM[å¤§è¯­è¨€æ¨¡å‹]
        Agent[Agentæ ¸å¿ƒ]
    end

    subgraph Execution[æ‰§è¡Œå±‚]
        ToolCollection[å·¥å…·é›†åˆ]
        Tool1[å·¥å…·1]
        Tool2[å·¥å…·2]
        ToolN[å·¥å…·N]
    end

    subgraph Output[è¾“å‡ºå±‚]
        ToolResults[å·¥å…·æ‰§è¡Œç»“æœ]
        FinalResponse[æœ€ç»ˆå“åº”]
    end

    UserRequest --&gt; Memory
    SystemPrompt --&gt; LLM
    ToolSchemas --&gt; LLM
    Memory --&gt; LLM
    LLM --&gt; Agent
    Agent --&gt; ToolCollection
    ToolCollection --&gt; Tool1
    ToolCollection --&gt; Tool2
    ToolCollection --&gt; ToolN
    Tool1 --&gt; ToolResults
    Tool2 --&gt; ToolResults
    ToolN --&gt; ToolResults
    ToolResults --&gt; Memory
    Memory --&gt; FinalResponse

</code></pre>
<h2 data-id="heading-47">ä¸ƒã€å®è·µå»ºè®®</h2>
<h3 data-id="heading-48">7.1 å¦‚ä½•è®¾è®¡æ–°å·¥å…·</h3>
<p>è®¾è®¡æ–°å·¥å…·æ—¶ï¼Œéµå¾ªä»¥ä¸‹åŸåˆ™ï¼š</p>
<ol>
<li><strong>æ¸…æ™°çš„å·¥å…·æè¿°</strong>ï¼š<code>description</code>å­—æ®µåº”è¯¥è¯¦ç»†è¯´æ˜å·¥å…·çš„ç”¨é€”ã€ä½¿ç”¨åœºæ™¯å’Œé™åˆ¶</li>
<li><strong>å®Œæ•´çš„å‚æ•°å®šä¹‰</strong>ï¼šä½¿ç”¨JSON Schemaç²¾ç¡®å®šä¹‰å‚æ•°ç±»å‹ã€çº¦æŸå’Œå¿…éœ€å­—æ®µ</li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šå·¥å…·æ‰§è¡Œåº”è¯¥è¿”å›<code>ToolResult</code>ï¼ŒåŒ…å«æˆåŠŸç»“æœæˆ–é”™è¯¯ä¿¡æ¯</li>
<li><strong>å®‰å…¨æ€§è€ƒè™‘</strong>ï¼šå¯¹äºæ‰§è¡Œä»£ç ã€æ–‡ä»¶æ“ä½œç­‰æ•æ„Ÿå·¥å…·ï¼Œéœ€è¦æ·»åŠ æƒé™æ£€æŸ¥å’Œæ²™ç®±éš”ç¦»</li>
</ol>
<p>ç¤ºä¾‹ï¼šè®¾è®¡ä¸€ä¸ªæ–‡ä»¶æœç´¢å·¥å…·</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">FileSearchTool</span>(<span class="hljs-title class_ inherited__">BaseTool</span>):
    name: <span class="hljs-built_in">str</span> = <span class="hljs-string">"file_search"</span>
    description: <span class="hljs-built_in">str</span> = (
        <span class="hljs-string">"Search for files in a directory tree matching a pattern. "</span>
        <span class="hljs-string">"Supports glob patterns and regex. Returns list of matching file paths."</span>
    )
    parameters: <span class="hljs-built_in">dict</span> = {
        <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>,
        <span class="hljs-string">"properties"</span>: {
            <span class="hljs-string">"directory"</span>: {
                <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
                <span class="hljs-string">"description"</span>: <span class="hljs-string">"Root directory to search in (absolute path)"</span>,
            },
            <span class="hljs-string">"pattern"</span>: {
                <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
                <span class="hljs-string">"description"</span>: <span class="hljs-string">"Search pattern (glob or regex)"</span>,
            },
            <span class="hljs-string">"recursive"</span>: {
                <span class="hljs-string">"type"</span>: <span class="hljs-string">"boolean"</span>,
                <span class="hljs-string">"description"</span>: <span class="hljs-string">"Whether to search recursively"</span>,
                <span class="hljs-string">"default"</span>: <span class="hljs-literal">True</span>,
            },
        },
        <span class="hljs-string">"required"</span>: [<span class="hljs-string">"directory"</span>, <span class="hljs-string">"pattern"</span>],
    }

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">
        self, directory: <span class="hljs-built_in">str</span>, pattern: <span class="hljs-built_in">str</span>, recursive: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">True</span>
    </span>) -&gt; ToolResult:
        <span class="hljs-keyword">try</span>:
            <span class="hljs-comment"># éªŒè¯è·¯å¾„å®‰å…¨æ€§</span>
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> Path(directory).is_absolute():
                <span class="hljs-keyword">return</span> self.fail_response(<span class="hljs-string">"Directory must be absolute path"</span>)

            <span class="hljs-comment"># æ‰§è¡Œæœç´¢</span>
            matches = <span class="hljs-keyword">await</span> self._search_files(directory, pattern, recursive)
            <span class="hljs-keyword">return</span> self.success_response({<span class="hljs-string">"files"</span>: matches})
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            <span class="hljs-keyword">return</span> self.fail_response(<span class="hljs-string">f"Search failed: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>)

</code></pre>
<h3 data-id="heading-49">7.2 å¦‚ä½•ä¼˜åŒ–æç¤ºè¯</h3>
<p>æç¤ºè¯ä¼˜åŒ–æ˜¯æå‡Agentæ€§èƒ½çš„å…³é”®ï¼š</p>
<ol>
<li><strong>ç³»ç»Ÿæç¤ºè¯</strong>ï¼š
<ul>
<li>æ˜ç¡®Agentçš„è§’è‰²å’Œèƒ½åŠ›è¾¹ç•Œ</li>
<li>è¯´æ˜å·¥ä½œç›®å½•ã€å¯ç”¨èµ„æºç­‰ç¯å¢ƒä¿¡æ¯</li>
<li>å¼ºè°ƒå®‰å…¨æ€§å’Œæœ€ä½³å®è·µ</li>
</ul>
</li>
<li><strong>ä¸‹ä¸€æ­¥æç¤ºè¯</strong>ï¼š
<ul>
<li>æŒ‡å¯¼Agentå¦‚ä½•åˆ†è§£å¤æ‚ä»»åŠ¡</li>
<li>è¯´æ˜å·¥å…·é€‰æ‹©çš„åŸåˆ™</li>
<li>å¼ºè°ƒç»“æœéªŒè¯å’Œé”™è¯¯å¤„ç†</li>
</ul>
</li>
<li><strong>å·¥å…·æè¿°</strong>ï¼š
<ul>
<li>ä½¿ç”¨å…·ä½“ã€å¯æ“ä½œçš„æè¿°</li>
<li>è¯´æ˜å·¥å…·çš„é™åˆ¶å’Œæ³¨æ„äº‹é¡¹</li>
<li>æä¾›ä½¿ç”¨ç¤ºä¾‹ï¼ˆåœ¨descriptionä¸­ï¼‰</li>
</ul>
</li>
</ol>
<p>ç¤ºä¾‹ï¼šä¼˜åŒ–åçš„ç³»ç»Ÿæç¤ºè¯</p>
<pre><code class="hljs language-python" lang="python">SYSTEM_PROMPT = <span class="hljs-string">"""You are OpenManus, a capable AI assistant.

Your capabilities:
- Execute Python code for data processing and analysis
- Browse the web to gather information
- Edit files using safe string replacement
- Interact with users when clarification is needed

Working directory: {directory}

Important guidelines:
- Always verify file paths before operations
- Use sandboxed execution for untrusted code
- Ask for confirmation before destructive operations
- Explain your reasoning at each step
"""</span>

</code></pre>
<h3 data-id="heading-50">7.3 å¦‚ä½•è°ƒè¯•Agentè¡Œä¸º</h3>
<p>è°ƒè¯•Agentéœ€è¦ç³»ç»ŸåŒ–çš„æ–¹æ³•ï¼š</p>
<ol>
<li><strong>æ—¥å¿—è®°å½•</strong>ï¼šåœ¨å…³é”®èŠ‚ç‚¹æ·»åŠ è¯¦ç»†æ—¥å¿—
<ul>
<li>æ€è€ƒé˜¶æ®µçš„LLMè¾“å…¥è¾“å‡º</li>
<li>å·¥å…·è°ƒç”¨çš„å‚æ•°å’Œç»“æœ</li>
<li>çŠ¶æ€è½¬æ¢å’Œé”™è¯¯ä¿¡æ¯</li>
</ul>
</li>
<li><strong>è®°å¿†æ£€æŸ¥</strong>ï¼šå®šæœŸæ£€æŸ¥<code>agent.memory.messages</code>ï¼ŒéªŒè¯å¯¹è¯å†å²çš„æ­£ç¡®æ€§</li>
<li><strong>å·¥å…·æµ‹è¯•</strong>ï¼šå•ç‹¬æµ‹è¯•æ¯ä¸ªå·¥å…·ï¼Œç¡®ä¿å…¶è¡Œä¸ºç¬¦åˆé¢„æœŸ</li>
<li><strong>é€æ­¥æ‰§è¡Œ</strong>ï¼šä½¿ç”¨<code>max_steps=1</code>é™åˆ¶ï¼Œé€æ­¥è§‚å¯ŸAgentçš„è¡Œä¸º</li>
</ol>
<p>ç¤ºä¾‹ï¼šè°ƒè¯•å·¥å…·</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">debug_agent</span>(<span class="hljs-params">agent: ToolCallAgent, request: <span class="hljs-built_in">str</span></span>):
    <span class="hljs-string">"""è°ƒè¯•Agentæ‰§è¡Œè¿‡ç¨‹"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Request: <span class="hljs-subst">{request}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Available tools: <span class="hljs-subst">{[t.name <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> agent.available_tools.tools]}</span>"</span>)

    <span class="hljs-comment"># å•æ­¥æ‰§è¡Œ</span>
    agent.max_steps = <span class="hljs-number">1</span>
    <span class="hljs-keyword">await</span> agent.run(request)

    <span class="hljs-comment"># æ£€æŸ¥è®°å¿†</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\\nMemory contents:"</span>)
    <span class="hljs-keyword">for</span> i, msg <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(agent.memory.messages):
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{i}</span>. <span class="hljs-subst">{msg.role}</span>: <span class="hljs-subst">{msg.content[:<span class="hljs-number">100</span>]}</span>"</span>)
        <span class="hljs-keyword">if</span> msg.tool_calls:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"   Tool calls: <span class="hljs-subst">{[tc.function.name <span class="hljs-keyword">for</span> tc <span class="hljs-keyword">in</span> msg.tool_calls]}</span>"</span>)

</code></pre>
<h3 data-id="heading-51">7.4 æ€§èƒ½ä¼˜åŒ–å»ºè®®</h3>
<ol>
<li><strong>Tokenç®¡ç†</strong>ï¼š
<ul>
<li>ç›‘æ§tokenä½¿ç”¨é‡ï¼Œé¿å…è¶…å‡ºé™åˆ¶</li>
<li>å¯¹äºé•¿å¯¹è¯ï¼Œè€ƒè™‘æ¶ˆæ¯æ‘˜è¦æˆ–æ»‘åŠ¨çª—å£</li>
<li>å·¥å…·æè¿°è¦ç®€æ´ä½†å®Œæ•´</li>
</ul>
</li>
<li><strong>å·¥å…·é€‰æ‹©ä¼˜åŒ–</strong>ï¼š
<ul>
<li>é™åˆ¶å·¥å…·æ•°é‡ï¼ŒåªåŒ…å«å¿…è¦çš„å·¥å…·</li>
<li>ä½¿ç”¨å·¥å…·åˆ†ç»„ï¼Œæ ¹æ®ä»»åŠ¡ç±»å‹åŠ¨æ€åŠ è½½</li>
<li>ä¼˜åŒ–å·¥å…·æè¿°ï¼Œæé«˜LLMé€‰æ‹©å‡†ç¡®æ€§</li>
</ul>
</li>
<li><strong>å¹¶å‘æ‰§è¡Œ</strong>ï¼š
<ul>
<li>å¯¹äºç‹¬ç«‹çš„å·¥å…·è°ƒç”¨ï¼Œå¯ä»¥è€ƒè™‘å¹¶å‘æ‰§è¡Œ</li>
<li>æ³¨æ„å·¥å…·ä¹‹é—´çš„ä¾èµ–å…³ç³»</li>
</ul>
</li>
<li><strong>ç¼“å­˜æœºåˆ¶</strong>ï¼š
<ul>
<li>ç¼“å­˜å·¥å…·æ‰§è¡Œç»“æœï¼ˆå¦‚æ–‡ä»¶è¯»å–ã€APIè°ƒç”¨ï¼‰</li>
<li>é¿å…é‡å¤æ‰§è¡Œç›¸åŒçš„æ“ä½œ</li>
</ul>
</li>
</ol>
<p>ç¤ºä¾‹ï¼šå·¥å…·ç»“æœç¼“å­˜</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> lru_cache
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime, timedelta

<span class="hljs-keyword">class</span> <span class="hljs-title class_">CachedTool</span>(<span class="hljs-title class_ inherited__">BaseTool</span>):
    _cache: <span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Tuple</span>[<span class="hljs-type">Any</span>, datetime]] = {}
    _cache_ttl: timedelta = timedelta(minutes=<span class="hljs-number">5</span>)

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">self, **kwargs</span>) -&gt; ToolResult:
        cache_key = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">sorted</span>(kwargs.items()))

        <span class="hljs-comment"># æ£€æŸ¥ç¼“å­˜</span>
        <span class="hljs-keyword">if</span> cache_key <span class="hljs-keyword">in</span> self._cache:
            result, timestamp = self._cache[cache_key]
            <span class="hljs-keyword">if</span> datetime.now() - timestamp &lt; self._cache_ttl:
                <span class="hljs-keyword">return</span> result

        <span class="hljs-comment"># æ‰§è¡Œå·¥å…·</span>
        result = <span class="hljs-keyword">await</span> self._execute_impl(**kwargs)

        <span class="hljs-comment"># æ›´æ–°ç¼“å­˜</span>
        self._cache[cache_key] = (result, datetime.now())
        <span class="hljs-keyword">return</span> result

</code></pre>
<h2 data-id="heading-52">å…«ã€æ€»ç»“</h2>
<h3 data-id="heading-53">8.1 ç°ä»£Agentçš„æ ¸å¿ƒè¦ç´ </h3>
<p>é€šè¿‡æ·±å…¥åˆ†æOpenManusé¡¹ç›®ï¼Œæˆ‘ä»¬æ€»ç»“å‡ºç°ä»£Agentç³»ç»Ÿçš„æ ¸å¿ƒè¦ç´ ï¼š</p>
<ol>
<li><strong>åˆ†å±‚æ¶æ„</strong>ï¼šåŸºç¡€å±‚ã€æ€è€ƒå±‚ã€å·¥å…·è°ƒç”¨å±‚ã€åº”ç”¨å±‚çš„æ¸…æ™°åˆ†ç¦»</li>
<li><strong>ReActæ¨¡å¼</strong>ï¼šæ¨ç†-è¡ŒåŠ¨-è§‚å¯Ÿçš„å¾ªç¯æœºåˆ¶</li>
<li><strong>å·¥å…·ç³»ç»Ÿ</strong>ï¼šç»Ÿä¸€çš„å·¥å…·æ¥å£å’ŒåŠ¨æ€æ‰©å±•èƒ½åŠ›</li>
<li><strong>LLMé›†æˆ</strong>ï¼šé€šè¿‡function callingå®ç°æ™ºèƒ½å†³ç­–</li>
<li><strong>çŠ¶æ€ç®¡ç†</strong>ï¼šå®Œå–„çš„çŠ¶æ€æœºå’Œæ‰§è¡Œæ§åˆ¶</li>
<li><strong>è®°å¿†ç³»ç»Ÿ</strong>ï¼šå®Œæ•´çš„å¯¹è¯å†å²ç®¡ç†</li>
</ol>
<h3 data-id="heading-54">8.2 OpenManusæ¶æ„çš„ä¼˜åŠ¿</h3>
<p>OpenManusçš„æ¶æ„è®¾è®¡å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
<ol>
<li><strong>å¯æ‰©å±•æ€§</strong>ï¼šé€šè¿‡BaseToolæŠ½è±¡ï¼Œå¯ä»¥è½»æ¾æ·»åŠ æ–°å·¥å…·</li>
<li><strong>å¯ç»´æŠ¤æ€§</strong>ï¼šæ¸…æ™°çš„åˆ†å±‚ç»“æ„ï¼ŒèŒè´£æ˜ç¡®</li>
<li><strong>çµæ´»æ€§</strong>ï¼šæ”¯æŒé™æ€å’ŒåŠ¨æ€å·¥å…·é…ç½®ï¼Œæ”¯æŒMCPåè®®</li>
<li><strong>å¥å£®æ€§</strong>ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†å’ŒçŠ¶æ€ç®¡ç†</li>
<li><strong>å¯è§‚æµ‹æ€§</strong>ï¼šè¯¦ç»†çš„æ—¥å¿—å’Œè®°å¿†ç³»ç»Ÿ</li>
</ol>
<h3 data-id="heading-55">8.3 æœªæ¥å‘å±•æ–¹å‘</h3>
<p>ç°ä»£AgentæŠ€æœ¯ä»åœ¨å¿«é€Ÿå‘å±•ï¼Œæœªæ¥å¯èƒ½çš„æ–¹å‘åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>å¤šAgentåä½œ</strong>ï¼šå¤šä¸ªAgentååŒå®Œæˆå¤æ‚ä»»åŠ¡</li>
<li><strong>é•¿æœŸè®°å¿†</strong>ï¼šè¶…è¶Šå¯¹è¯å†å²çš„æŒä¹…åŒ–è®°å¿†</li>
<li><strong>å·¥å…·å­¦ä¹ </strong>ï¼šAgentè‡ªåŠ¨å‘ç°å’Œå­¦ä¹ ä½¿ç”¨æ–°å·¥å…·</li>
<li><strong>å®‰å…¨å¢å¼º</strong>ï¼šæ›´ä¸¥æ ¼çš„æƒé™æ§åˆ¶å’Œæ²™ç®±éš”ç¦»</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šæ›´é«˜æ•ˆçš„tokenä½¿ç”¨å’Œå¹¶å‘æ‰§è¡Œ</li>
</ol>
<h3 data-id="heading-56">8.4 ç»“è¯­</h3>
<p>æ„å»ºç°ä»£Agentæ˜¯ä¸€ä¸ªç³»ç»Ÿå·¥ç¨‹ï¼Œéœ€è¦æ·±å…¥ç†è§£LLMèƒ½åŠ›ã€å·¥å…·è®¾è®¡ã€ç³»ç»Ÿæ¶æ„ç­‰å¤šä¸ªæ–¹é¢ã€‚OpenManusé¡¹ç›®ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªä¼˜ç§€çš„å‚è€ƒå®ç°ï¼Œå±•ç¤ºäº†å¦‚ä½•å°†ç†è®ºè½¬åŒ–ä¸ºå®è·µã€‚</p>
<p>é€šè¿‡æœ¬æ–‡çš„ç³»ç»Ÿæ€§åˆ†æï¼Œæˆ‘ä»¬å¸Œæœ›è¯»è€…èƒ½å¤Ÿï¼š</p>
<ul>
<li>ç†è§£ç°ä»£Agentçš„å®Œæ•´æ¶æ„</li>
<li>æŒæ¡å·¥å…·ç³»ç»Ÿçš„è®¾è®¡å’Œå®ç°</li>
<li>äº†è§£Agentçš„æ€è€ƒå’Œæ‰§è¡Œæœºåˆ¶</li>
<li>å…·å¤‡æ„å»ºè‡ªå·±Agentç³»ç»Ÿçš„èƒ½åŠ›</li>
</ul>
<p>ç°ä»£AgentæŠ€æœ¯æ­£åœ¨å¿«é€Ÿå‘å±•ï¼ŒæœŸå¾…æ›´å¤šå¼€å‘è€…åŠ å…¥è¿™ä¸ªé¢†åŸŸï¼Œå…±åŒæ¨åŠ¨AI AgentæŠ€æœ¯çš„è¿›æ­¥ã€‚</p>
<hr/>
<p><strong>å‚è€ƒèµ„æ–™</strong>ï¼š</p>
<ul>
<li>OpenManusé¡¹ç›®ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FFoundationAgents%2FOpenManus" target="_blank" title="https://github.com/FoundationAgents/OpenManus" ref="nofollow noopener noreferrer">github.com/FoundationAâ€¦</a></li>
<li>ReActè®ºæ–‡ï¼šReAct: Synergizing Reasoning and Acting in Language Models</li>
<li>OpenAI Function Callingæ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Ffunction-calling" target="_blank" title="https://platform.openai.com/docs/guides/function-calling" ref="nofollow noopener noreferrer">platform.openai.com/docs/guidesâ€¦</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¬è¯´ä½ å¾ˆç†Ÿæ‚‰ flex]]></title>    <link>https://juejin.cn/post/7598021984300367899</link>    <guid>https://juejin.cn/post/7598021984300367899</guid>    <pubDate>2026-01-23T02:20:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598021984300367899" data-draft-id="7598021081987842099" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¬è¯´ä½ å¾ˆç†Ÿæ‚‰ flex"/> <meta itemprop="keywords" content="å‰ç«¯,CSS"/> <meta itemprop="datePublished" content="2026-01-23T02:20:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Carry345"/> <meta itemprop="url" content="https://juejin.cn/user/831674360017678"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¬è¯´ä½ å¾ˆç†Ÿæ‚‰ flex
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/831674360017678/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Carry345
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T02:20:21.000Z" title="Fri Jan 23 2026 02:20:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;color:rgba(46,36,36,.87);overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{margin-bottom:5px;font-size:30px;font-weight:500}.markdown-body h1:before{content:"#";margin-right:10px;color:#1976d2}.markdown-body h2{font-size:28px;font-weight:400;border-left:5px solid #454545;margin-top:20px;padding-left:10px;transition:all .3s ease-in-out}.markdown-body h2:hover{border-color:#1976d2}.markdown-body h3{font-size:24px;font-weight:400;margin-top:15px;padding-bottom:0}.markdown-body h4{font-size:20px;font-weight:500}.markdown-body h5{font-size:16px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h2:first-letter,.markdown-body h3:first-letter,.markdown-body p:first-letter{text-transform:capitalize}.markdown-body em{text-emphasis:dot;text-emphasis-position:under}.markdown-body img{display:block;margin:0 auto!important;max-width:100%;border-radius:2px;box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)!important}.markdown-body hr{position:relative;width:98%;height:1px;border:none;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,#ddd,#999,#ddd);overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background:#fff;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center}.markdown-body code{font-weight:900;word-break:break-word;border-radius:2px;overflow-x:auto;font-size:.87em;padding:.065em .4em;background-color:#fbe5e1;color:#c0341d}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:0 4px}.markdown-body pre&gt;code{font-weight:400;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{margin:0 4px;text-decoration:none;color:#027fff;transition:all .3s ease-in-out;padding-bottom:4px;border-bottom:2px solid transparent}.markdown-body a:after{content:"";display:inline-block;width:18px;height:18px;margin-left:4px;vertical-align:middle;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMjdGRkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PHBhdGggZD0iTTkuODE1IDYuNDQ4bDEuOTM2LTEuOTM2YzEuMzM3LTEuMzM2IDMuNTgtMS4yNTkgNS4wMTMuMTczIDEuNDMyIDEuNDMyIDEuNTEgMy42NzYuMTczIDUuMDEzbC0xLjQ1MiAxLjQ1Mi0uOTY4Ljk2OGMtMS4zMzcgMS4zMzYtMy41ODEgMS4yNTktNS4wMTMtLjE3MyIvPjxwYXRoIGQ9Ik0xMS4yNjcgMTUuMzY3bC0xLjkzNiAxLjkzNmMtMS4zMzYgMS4zMzctMy41OCAxLjI2LTUuMDEyLS4xNzMtMS40MzItMS40MzItMS41MS0zLjY3Ni0uMTczLTUuMDEybDEuNDUyLTEuNDUyLjk2OC0uOTY4YzEuMzM2LTEuMzM3IDMuNTgtMS4yNiA1LjAxMi4xNzMiLz48L2c+PC9zdmc+);background-size:cover;background-repeat:no-repeat}.markdown-body a:hover{border-color:#027fff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body a.footnote-backref:after,.markdown-body a.footnote-ref:after,.markdown-body sup a:after{display:none!important}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border:2px solid #c6c6c6}.markdown-body table img{box-shadow:none!important}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body del{color:rgba(0,0,0,.6)}.markdown-body blockquote{position:relative;color:#666;padding:5px 23px 1px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:hsla(0,0%,78.4%,.12);transition:all .2s ease-in-out}.markdown-body blockquote:hover{border-color:#1976d2}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;font-size:24px;font-weight:800;line-height:24px;color:#cbcbcb;opacity:.6}.markdown-body blockquote:before{content:"â€œ";top:4px;left:6px}.markdown-body blockquote:after{content:"â€";right:8px;bottom:-8px}.markdown-body blockquote&gt;p,.markdown-body blockquote blockquote{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body details{outline:none;border:none;border-left:4px solid #1976d2;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary:hover::-webkit-details-marker{color:#1976d2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¬è¯´ä½ å¾ˆç†Ÿæ‚‰ flex,çœ‹ä»¥ä¸‹å‡ ç§æƒ…å†µè¯´ä¸€ä¸‹æœ€ç»ˆæ¸²æŸ“ç»“æœ</p>
<h4 data-id="heading-0">é—®é¢˜ä¸€</h4>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.container</span> {
  <span class="hljs-attribute">display</span>:flex;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
}

<span class="hljs-selector-class">.item</span> {
  <span class="hljs-attribute">flex-grow</span>: <span class="hljs-number">1</span>;
}
<span class="hljs-selector-class">.item1</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">30px</span>;
}
<span class="hljs-selector-class">.item2</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">40px</span>;
}
</code></pre>
<h4 data-id="heading-1">é—®é¢˜äºŒ</h4>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.container</span> {
  <span class="hljs-attribute">display</span>:flex;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">150px</span>;
}

<span class="hljs-selector-class">.item</span> {
  <span class="hljs-attribute">flex-grow</span>: <span class="hljs-number">1</span>;
  <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span>;
}
<span class="hljs-selector-class">.item1</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">30px</span>;
}
<span class="hljs-selector-class">.item2</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">40px</span>;
}
</code></pre>
<h4 data-id="heading-2">é—®é¢˜ä¸‰</h4>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.container</span> {
  <span class="hljs-attribute">display</span>:flex;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">150px</span>;
}

<span class="hljs-selector-class">.item</span> {
  <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span>;
}
<span class="hljs-selector-class">.item1</span> {
  <span class="hljs-attribute">flex-grow</span>: <span class="hljs-number">1</span>;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">30px</span>;
}
<span class="hljs-selector-class">.item2</span> {
  <span class="hljs-attribute">flex-grow</span>: <span class="hljs-number">3</span>;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">40px</span>;
}
</code></pre>
<h4 data-id="heading-3">é—®é¢˜å››</h4>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.container</span> {
  <span class="hljs-attribute">display</span>:flex;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">280px</span>;
}

<span class="hljs-selector-class">.item</span> {
  <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span>;
}
<span class="hljs-selector-class">.item1</span> {
  <span class="hljs-attribute">flex-shrink</span>: <span class="hljs-number">1</span>;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
}
<span class="hljs-selector-class">.item2</span> {
  <span class="hljs-attribute">flex-shrink</span>: <span class="hljs-number">1</span>;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;
}
</code></pre>
<h4 data-id="heading-4">é—®é¢˜ä¸€ç­”æ¡ˆ:</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fbc50d40693f442d902d0cd5f55aafa3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2FycnkzNDU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769739621&amp;x-signature=dHtvYPdyweqzWWOAbX4RUObO81Q%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-5">é—®é¢˜äºŒç­”æ¡ˆ:</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e5814a7b52c54e56b9f05cb0f01f6054~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2FycnkzNDU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769739621&amp;x-signature=wg5D1Re%2FeZkAdjfzJFWNPe%2Flq3o%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-6">é—®é¢˜ä¸‰ç­”æ¡ˆ</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/82c1ba1361f04cfb8b608cb9b9b13ad6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2FycnkzNDU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769739621&amp;x-signature=VKNm3ZHVwVETtvaTmYEz%2BAnKs3k%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-7">é—®é¢˜å››ç­”æ¡ˆ</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/54049a7152f8460bb47093b78eea3630~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2FycnkzNDU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769739621&amp;x-signature=RsMRDcMsp%2FszgQ2NgcXzDArz3AY%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-8">tip</h4>
<ul>
<li><code>flex-grow</code> çš„æƒ…å†µå…ˆå‡è®¾å…¨éƒ¨æ”¾å…¥ï¼Œè‡ªç”±ç©ºé—´æŒ‰ç…§ <code>flex-grow</code> çš„æ¯”ä¾‹åˆ†</li>
<li><code>flex-shrink</code> çš„æƒ…å†µä¹Ÿæ˜¯å…ˆå‡è®¾å…¨éƒ¨æ”¾å…¥ï¼Œè¿˜å·®å¤šå°‘ï¼ŸæŒ‰ç…§ <code>flex-shrink * flex-basis</code>çš„æ¯”ä¾‹åŒ€å‡ºæ¥</li>
</ul>
<p>æŒ‰ç…§è¿™ä¸ªè§„åˆ™æˆ‘ä»¬çœ‹é—®é¢˜ä¸‰å’Œé—®é¢˜å››</p>
<h5 data-id="heading-9">é—®é¢˜ä¸‰è¯¦è§£</h5>
<p>å…ˆå‡è®¾å…¨éƒ¨æ”¾å…¥ï¼Œè¿˜å¤šäº† 40pxï¼Œflex-grow åˆ†åˆ«æ˜¯ <code>1</code>å’Œ<code>3</code>ï¼Œå³åˆ†åˆ«å <code>10px</code> <code>30px</code></p>
<ul>
<li>item1 = 30px + 10px = 40px</li>
<li>item2 = 40 + 30px = 70px</li>
</ul>
<h5 data-id="heading-10">é—®é¢˜å››è¯¦è§£</h5>
<p>å…ˆå‡è®¾å…¨éƒ¨æ”¾å…¥ï¼Œå·®äº†<code>40+100+200-280=60px</code>,<code>flex-shrink * flex-basis</code>çš„æ¯”ä¾‹å³<code>100:200=1:2</code>ï¼Œåˆ†åˆ«åŒ€å‡ºæ¥<code>20px</code> <code>40px</code></p>
<ul>
<li>item1: 100px - 20px = 80px</li>
<li>item2: 200px - 40px = 160px</li>
</ul>
<p>éƒ½ä¸æ˜¯åˆéš¾çš„é—®é¢˜ï¼Œå¹³æ—¶å¼€å‘ä¸­å¾ˆå¸¸è§ï¼Œä½†è„‘å­é‡Œæ²¡èƒ½è·å–åˆ°æ˜ç¡®åˆè‡ªä¿¡çš„æ¸²æŸ“ç»“æœï¼Œè¡¥ç¼ºğŸ¤Œ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ThreeJS ç€è‰²å™¨é«˜çº§åº”ç”¨ - å­”æ˜ç¯ç‰¹æ•ˆ]]></title>    <link>https://juejin.cn/post/7598021081988137011</link>    <guid>https://juejin.cn/post/7598021081988137011</guid>    <pubDate>2026-01-23T02:27:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598021081988137011" data-draft-id="7598043378018582537" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ThreeJS ç€è‰²å™¨é«˜çº§åº”ç”¨ - å­”æ˜ç¯ç‰¹æ•ˆ"/> <meta itemprop="keywords" content="å‰ç«¯,three.js"/> <meta itemprop="datePublished" content="2026-01-23T02:27:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯ç‹æ ¡é•¿"/> <meta itemprop="url" content="https://juejin.cn/user/2295436010076631"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ThreeJS ç€è‰²å™¨é«˜çº§åº”ç”¨ - å­”æ˜ç¯ç‰¹æ•ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2295436010076631/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯ç‹æ ¡é•¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T02:27:15.000Z" title="Fri Jan 23 2026 02:27:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡æ¡£æ¶µç›–Three.jsä¸­é«˜çº§ç€è‰²å™¨åº”ç”¨ï¼Œä»¥å­”æ˜ç¯ç‰¹æ•ˆä¸ºä¾‹ï¼Œå±•ç¤ºå¤æ‚ç€è‰²å™¨çš„å®é™…åº”ç”¨ã€‚</p>
<p>æœ€ç»ˆæ•ˆæœå¦‚å›¾ï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e8c5545ec4b94271b6e404e9d784645b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv546L5qCh6ZW_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769740035&amp;x-signature=us8NkfvsCwS6YEcu1h6BbyFpfjM%3D" alt="Title" loading="lazy"/></p>
<h2 data-id="heading-0">1. é«˜çº§ç€è‰²å™¨åº”ç”¨æ¦‚è¿°</h2>
<h3 data-id="heading-1">1.1 ç¯å¢ƒè´´å›¾ä¸å…‰ç…§</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-variable constant_">THREE</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"three"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">OrbitControls</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"three/examples/jsm/controls/OrbitControls"</span>;
<span class="hljs-keyword">import</span> gsap <span class="hljs-keyword">from</span> <span class="hljs-string">"gsap"</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> dat <span class="hljs-keyword">from</span> <span class="hljs-string">"dat.gui"</span>;
<span class="hljs-keyword">import</span> vertexShader <span class="hljs-keyword">from</span> <span class="hljs-string">"../shaders/flylight/vertex.glsl"</span>;
<span class="hljs-keyword">import</span> fragmentShader <span class="hljs-keyword">from</span> <span class="hljs-string">"../shaders/flylight/fragment.glsl"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">RGBELoader</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"three/examples/jsm/loaders/RGBELoader"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">GLTFLoader</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"three/examples/jsm/loaders/GLTFLoader"</span>;

<span class="hljs-comment">// åˆå§‹åŒ–åœºæ™¯</span>
<span class="hljs-keyword">const</span> scene = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Scene</span>();

<span class="hljs-comment">// åŠ è½½HDRç¯å¢ƒè´´å›¾</span>
<span class="hljs-keyword">const</span> rgbeLoader = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RGBELoader</span>();
rgbeLoader.<span class="hljs-title function_">loadAsync</span>(<span class="hljs-string">"./assets/2k.hdr"</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">texture</span>) =&gt;</span> {
  texture.<span class="hljs-property">mapping</span> = <span class="hljs-variable constant_">THREE</span>.<span class="hljs-property">EquirectangularReflectionMapping</span>;
  scene.<span class="hljs-property">background</span> = texture;  <span class="hljs-comment">// è®¾ç½®èƒŒæ™¯è´´å›¾</span>
  scene.<span class="hljs-property">environment</span> = texture;  <span class="hljs-comment">// è®¾ç½®ç¯å¢ƒè´´å›¾</span>
});
</code></pre>
<h3 data-id="heading-2">1.2 æ¸²æŸ“å™¨é«˜çº§è®¾ç½®</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> renderer = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">WebGLRenderer</span>({ <span class="hljs-attr">alpha</span>: <span class="hljs-literal">true</span> });

<span class="hljs-comment">// å¯ç”¨è‰²è°ƒæ˜ å°„ä»¥è·å¾—æ›´å¥½çš„è§†è§‰æ•ˆæœ</span>
renderer.<span class="hljs-property">outputEncoding</span> = <span class="hljs-variable constant_">THREE</span>.<span class="hljs-property">sRGBEncoding</span>;
renderer.<span class="hljs-property">toneMapping</span> = <span class="hljs-variable constant_">THREE</span>.<span class="hljs-property">ACESFilmicToneMapping</span>;
renderer.<span class="hljs-property">toneMappingExposure</span> = <span class="hljs-number">0.2</span>;
</code></pre>
<h2 data-id="heading-3">2. å­”æ˜ç¯æ¨¡å‹åŠ è½½ä¸ç€è‰²å™¨åº”ç”¨</h2>
<h3 data-id="heading-4">2.1 GLTFæ¨¡å‹åŠ è½½</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> gltfLoader = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GLTFLoader</span>();
<span class="hljs-keyword">let</span> <span class="hljs-title class_">LightBox</span> = <span class="hljs-literal">null</span>;

gltfLoader.<span class="hljs-title function_">load</span>(<span class="hljs-string">"./assets/model/flyLight.glb"</span>, <span class="hljs-function">(<span class="hljs-params">gltf</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(gltf);

  <span class="hljs-comment">// è·å–å­”æ˜ç¯ç½‘æ ¼</span>
  <span class="hljs-title class_">LightBox</span> = gltf.<span class="hljs-property">scene</span>.<span class="hljs-property">children</span>[<span class="hljs-number">1</span>];
  
  <span class="hljs-comment">// åº”ç”¨è‡ªå®šä¹‰ç€è‰²å™¨æè´¨</span>
  <span class="hljs-title class_">LightBox</span>.<span class="hljs-property">material</span> = shaderMaterial;

  <span class="hljs-comment">// æ‰¹é‡åˆ›å»ºå­”æ˜ç¯å®ä¾‹</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">150</span>; i++) {
    <span class="hljs-keyword">let</span> flyLight = gltf.<span class="hljs-property">scene</span>.<span class="hljs-title function_">clone</span>(<span class="hljs-literal">true</span>);  <span class="hljs-comment">// å…‹éš†æ¨¡å‹</span>
    <span class="hljs-keyword">let</span> x = (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() - <span class="hljs-number">0.5</span>) * <span class="hljs-number">300</span>;  <span class="hljs-comment">// éšæœºXä½ç½®</span>
    <span class="hljs-keyword">let</span> z = (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() - <span class="hljs-number">0.5</span>) * <span class="hljs-number">300</span>;  <span class="hljs-comment">// éšæœºZä½ç½®</span>
    <span class="hljs-keyword">let</span> y = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">60</span> + <span class="hljs-number">25</span>;      <span class="hljs-comment">// éšæœºYä½ç½®</span>
    
    flyLight.<span class="hljs-property">position</span>.<span class="hljs-title function_">set</span>(x, y, z);
    
    <span class="hljs-comment">// æ·»åŠ æ—‹è½¬åŠ¨ç”»</span>
    gsap.<span class="hljs-title function_">to</span>(flyLight.<span class="hljs-property">rotation</span>, {
      <span class="hljs-attr">y</span>: <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>,
      <span class="hljs-attr">duration</span>: <span class="hljs-number">10</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">30</span>,  <span class="hljs-comment">// éšæœºæŒç»­æ—¶é—´</span>
      <span class="hljs-attr">repeat</span>: -<span class="hljs-number">1</span>,                         <span class="hljs-comment">// æ— é™é‡å¤</span>
    });
    
    <span class="hljs-comment">// æ·»åŠ ä½ç½®åŠ¨ç”»</span>
    gsap.<span class="hljs-title function_">to</span>(flyLight.<span class="hljs-property">position</span>, {
      <span class="hljs-attr">x</span>: <span class="hljs-string">"+="</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">5</span>,        <span class="hljs-comment">// Xæ–¹å‘éšæœºç§»åŠ¨</span>
      <span class="hljs-attr">y</span>: <span class="hljs-string">"+="</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">20</span>,       <span class="hljs-comment">// Yæ–¹å‘éšæœºç§»åŠ¨</span>
      <span class="hljs-attr">yoyo</span>: <span class="hljs-literal">true</span>,                         <span class="hljs-comment">// å¾€è¿”è¿åŠ¨</span>
      <span class="hljs-attr">duration</span>: <span class="hljs-number">5</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">10</span>,   <span class="hljs-comment">// éšæœºæŒç»­æ—¶é—´</span>
      <span class="hljs-attr">repeat</span>: -<span class="hljs-number">1</span>,                         <span class="hljs-comment">// æ— é™é‡å¤</span>
    });
    
    scene.<span class="hljs-title function_">add</span>(flyLight);
  }
});
</code></pre>
<h2 data-id="heading-5">3. å­”æ˜ç¯é¡¶ç‚¹ç€è‰²å™¨è¯¦è§£</h2>
<h3 data-id="heading-6">3.1 é¡¶ç‚¹ç€è‰²å™¨ä»£ç </h3>
<pre><code class="hljs language-glsl" lang="glsl">precision lowp float;

varying vec4 vPosition;
varying vec4 gPosition;

void main(){
    vec4 modelPosition = modelMatrix * vec4( position, 1.0 );

    vPosition = modelPosition;
    gPosition = vec4( position, 1.0 );
    gl_Position =  projectionMatrix * viewMatrix * modelPosition;
}
</code></pre>
<h3 data-id="heading-7">3.2 å˜é‡ä¼ é€’æœºåˆ¶</h3>
<ul>
<li><code>vPosition</code>ï¼šä¼ é€’æ¨¡å‹ç©ºé—´ä¸­çš„ä½ç½®ä¿¡æ¯</li>
<li><code>gPosition</code>ï¼šä¼ é€’åŸå§‹å‡ ä½•ä½ç½®ä¿¡æ¯</li>
<li>è¿™äº›å˜é‡å°†åœ¨ç‰‡å…ƒç€è‰²å™¨ä¸­ä½¿ç”¨</li>
</ul>
<h2 data-id="heading-8">4. å­”æ˜ç¯ç‰‡å…ƒç€è‰²å™¨è¯¦è§£</h2>
<h3 data-id="heading-9">4.1 ç‰‡å…ƒç€è‰²å™¨ä»£ç </h3>
<pre><code class="hljs language-glsl" lang="glsl">precision lowp float;
varying vec4 vPosition;
varying vec4 gPosition;

void main(){
    vec4 redColor = vec4(1,0,0,1);      // çº¢è‰²
    vec4 yellowColor = vec4(1,1,0.5,1); // é»„è‰²
    vec4 mixColor = mix(yellowColor,redColor,gPosition.y/3.0); // åŸºäºYåæ ‡çš„é¢œè‰²æ··åˆ

    // æ ¹æ®é¢æœå‘è®¾ç½®ä¸åŒé¢œè‰²
    if(gl_FrontFacing){
        // æ­£é¢æœå‘ç›¸æœºçš„åƒç´ ï¼Œæ·»åŠ é«˜åº¦å½±å“å’Œäº®åº¦è°ƒæ•´
        gl_FragColor = vec4(mixColor.xyz-(vPosition.y-20.0)/80.0-0.1,1);
    }else{
        // èƒŒé¢åƒç´ ä½¿ç”¨åŸºç¡€é¢œè‰²
        gl_FragColor = vec4(mixColor.xyz,1);
    }
}
</code></pre>
<h3 data-id="heading-10">4.2 é¢œè‰²æ··åˆæŠ€æœ¯</h3>
<pre><code class="hljs language-glsl" lang="glsl">// åŸºäºYåæ ‡çš„é¢œè‰²æ’å€¼
vec4 mixColor = mix(yellowColor,redColor,gPosition.y/3.0);
</code></pre>
<h3 data-id="heading-11">4.3 é¢æœå‘åˆ¤æ–­</h3>
<pre><code class="hljs language-glsl" lang="glsl">// ä½¿ç”¨gl_FrontFacingåŒºåˆ†æ­£é¢å’ŒèƒŒé¢
if(gl_FrontFacing){
    // æ­£é¢ï¼šæ·»åŠ é«˜åº¦å½±å“å’Œäº®åº¦è°ƒæ•´
    gl_FragColor = vec4(mixColor.xyz-(vPosition.y-20.0)/80.0-0.1,1);
}else{
    // èƒŒé¢ï¼šä½¿ç”¨åŸºç¡€é¢œè‰²
    gl_FrontFacing = vec4(mixColor.xyz,1);
}
</code></pre>
<h2 data-id="heading-12">5. è‡ªå®šä¹‰ç€è‰²å™¨æè´¨åˆ›å»º</h2>
<h3 data-id="heading-13">5.1 ç€è‰²å™¨æè´¨åˆå§‹åŒ–</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ›å»ºå­”æ˜ç¯ä¸“ç”¨ç€è‰²å™¨æè´¨</span>
<span class="hljs-keyword">const</span> shaderMaterial = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">ShaderMaterial</span>({
  <span class="hljs-attr">vertexShader</span>: vertexShader,      <span class="hljs-comment">// é¡¶ç‚¹ç€è‰²å™¨</span>
  <span class="hljs-attr">fragmentShader</span>: fragmentShader,  <span class="hljs-comment">// ç‰‡å…ƒç€è‰²å™¨</span>
  <span class="hljs-attr">uniforms</span>: {},                   <span class="hljs-comment">// uniformå˜é‡</span>
  <span class="hljs-attr">side</span>: <span class="hljs-variable constant_">THREE</span>.<span class="hljs-property">DoubleSide</span>,         <span class="hljs-comment">// åŒé¢æ¸²æŸ“</span>
  <span class="hljs-comment">// transparent: true,           // é€æ˜æ¸²æŸ“ï¼ˆå¯é€‰ï¼‰</span>
});
</code></pre>
<h2 data-id="heading-14">6. ç›¸æœºæ§åˆ¶ä¸è§†è§’è®¾ç½®</h2>
<h3 data-id="heading-15">6.1 é«˜çº§ç›¸æœºæ§åˆ¶</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> controls = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrbitControls</span>(camera, renderer.<span class="hljs-property">domElement</span>);
controls.<span class="hljs-property">enableDamping</span> = <span class="hljs-literal">true</span>;           <span class="hljs-comment">// å¯ç”¨é˜»å°¼æ•ˆæœ</span>
controls.<span class="hljs-property">autoRotate</span> = <span class="hljs-literal">true</span>;              <span class="hljs-comment">// è‡ªåŠ¨æ—‹è½¬</span>
controls.<span class="hljs-property">autoRotateSpeed</span> = <span class="hljs-number">0.1</span>;          <span class="hljs-comment">// è‡ªåŠ¨æ—‹è½¬é€Ÿåº¦</span>
controls.<span class="hljs-property">maxPolarAngle</span> = (<span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> / <span class="hljs-number">3</span>) * <span class="hljs-number">2</span>;  <span class="hljs-comment">// æœ€å¤§æè§’é™åˆ¶</span>
controls.<span class="hljs-property">minPolarAngle</span> = (<span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> / <span class="hljs-number">3</span>) * <span class="hljs-number">2</span>;  <span class="hljs-comment">// æœ€å°æè§’é™åˆ¶</span>
</code></pre>
<h3 data-id="heading-16">6.2 ç›¸æœºè§’åº¦é™åˆ¶</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é™åˆ¶ç›¸æ©Ÿå‚ç›´æ—‹è½¬èŒƒå›´ï¼Œé˜²æ­¢è¿‡åº¦ä¿¯ä»°</span>
controls.<span class="hljs-property">maxPolarAngle</span> = (<span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> / <span class="hljs-number">3</span>) * <span class="hljs-number">2</span>;
controls.<span class="hljs-property">minPolarAngle</span> = (<span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> / <span class="hljs-number">3</span>) * <span class="hljs-number">2</span>;
</code></pre>
<h2 data-id="heading-17">7. åŠ¨ç”»ç³»ç»Ÿé›†æˆ</h2>
<h3 data-id="heading-18">7.1 GSAPåŠ¨ç”»æ§åˆ¶</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ—‹è½¬åŠ¨ç”»</span>
gsap.<span class="hljs-title function_">to</span>(flyLight.<span class="hljs-property">rotation</span>, {
  <span class="hljs-attr">y</span>: <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>,                    <span class="hljs-comment">// æ—‹è½¬ä¸€åœˆ</span>
  <span class="hljs-attr">duration</span>: <span class="hljs-number">10</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">30</span>, <span class="hljs-comment">// éšæœºæŒç»­æ—¶é—´</span>
  <span class="hljs-attr">repeat</span>: -<span class="hljs-number">1</span>,                        <span class="hljs-comment">// æ— é™é‡å¤</span>
});

<span class="hljs-comment">// ä½ç½®åŠ¨ç”»</span>
gsap.<span class="hljs-title function_">to</span>(flyLight.<span class="hljs-property">position</span>, {
  <span class="hljs-attr">x</span>: <span class="hljs-string">"+="</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">5</span>,       <span class="hljs-comment">// Xæ–¹å‘éšæœºç§»åŠ¨</span>
  <span class="hljs-attr">y</span>: <span class="hljs-string">"+="</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">20</span>,      <span class="hljs-comment">// Yæ–¹å‘éšæœºç§»åŠ¨</span>
  <span class="hljs-attr">yoyo</span>: <span class="hljs-literal">true</span>,                        <span class="hljs-comment">// å¾€è¿”è¿åŠ¨</span>
  <span class="hljs-attr">duration</span>: <span class="hljs-number">5</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">10</span>,  <span class="hljs-comment">// éšæœºæŒç»­æ—¶é—´</span>
  <span class="hljs-attr">repeat</span>: -<span class="hljs-number">1</span>,                        <span class="hljs-comment">// æ— é™é‡å¤</span>
});
</code></pre>
<h2 data-id="heading-19">8. æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</h2>
<h3 data-id="heading-20">8.1 æ‰¹é‡æ¸²æŸ“ä¼˜åŒ–</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨å…‹éš†æŠ€æœ¯æ‰¹é‡åˆ›å»ºå¯¹è±¡</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">150</span>; i++) {
  <span class="hljs-keyword">let</span> flyLight = gltf.<span class="hljs-property">scene</span>.<span class="hljs-title function_">clone</span>(<span class="hljs-literal">true</span>);
  <span class="hljs-comment">// ...</span>
  scene.<span class="hljs-title function_">add</span>(flyLight);
}
</code></pre>
<h3 data-id="heading-21">8.2 å‡å°‘Draw Call</h3>
<ul>
<li>ä½¿ç”¨ç›¸åŒçš„ç€è‰²å™¨æè´¨</li>
<li>åˆç†ç»„ç»‡æ¸²æŸ“æ‰¹æ¬¡</li>
<li>åˆ©ç”¨å®ä¾‹åŒ–æ¸²æŸ“æŠ€æœ¯</li>
</ul>
<h2 data-id="heading-22">9. ç€è‰²å™¨å‚æ•°åŒ–è®¾è®¡</h2>
<h3 data-id="heading-23">9.1 Uniformå˜é‡æ‰©å±•</h3>
<p>è™½ç„¶å½“å‰ç¤ºä¾‹ä¸­uniformsä¸ºç©ºï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­å¯ä»¥æ‰©å±•ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> shaderMaterial = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">ShaderMaterial</span>({
  <span class="hljs-attr">vertexShader</span>: vertexShader,
  <span class="hljs-attr">fragmentShader</span>: fragmentShader,
  <span class="hljs-attr">uniforms</span>: {
    <span class="hljs-attr">uTime</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">0</span> },              <span class="hljs-comment">// æ—¶é—´</span>
    <span class="hljs-attr">uBrightness</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">1.0</span> },      <span class="hljs-comment">// äº®åº¦</span>
    <span class="hljs-attr">uColorMix</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">0.5</span> },        <span class="hljs-comment">// é¢œè‰²æ··åˆç³»æ•°</span>
  },
  <span class="hljs-attr">side</span>: <span class="hljs-variable constant_">THREE</span>.<span class="hljs-property">DoubleSide</span>,
});
</code></pre>
<h2 data-id="heading-24">10. æ•…éšœæ’é™¤ä¸è°ƒè¯•</h2>
<h3 data-id="heading-25">10.1 å¸¸è§é—®é¢˜</h3>
<ol>
<li><strong>ç€è‰²å™¨ç¼–è¯‘é”™è¯¯</strong>ï¼šæ£€æŸ¥GLSLè¯­æ³•</li>
<li><strong>æ€§èƒ½é—®é¢˜</strong>ï¼šç®€åŒ–ç€è‰²å™¨è®¡ç®—</li>
<li><strong>å…‰ç…§é—®é¢˜</strong>ï¼šæ£€æŸ¥ç¯å¢ƒè´´å›¾è®¾ç½®</li>
<li><strong>åŠ¨ç”»å¡é¡¿</strong>ï¼šæ£€æŸ¥åŠ¨ç”»å¾ªç¯å’Œæ›´æ–°é¢‘ç‡</li>
</ol>
<h3 data-id="heading-26">10.2 è°ƒè¯•æŠ€å·§</h3>
<ol>
<li><strong>é€è¡Œæ³¨é‡Š</strong>ï¼šå®šä½é—®é¢˜ä»£ç </li>
<li><strong>å˜é‡è¾“å‡º</strong>ï¼šå°†ä¸­é—´å€¼è¾“å‡ºåˆ°é¢œè‰²</li>
<li><strong>ç®€åŒ–æ¨¡å‹</strong>ï¼šä½¿ç”¨ç®€å•å‡ ä½•ä½“æµ‹è¯•ç€è‰²å™¨</li>
</ol>
<h2 data-id="heading-27">æ€»ç»“</h2>
<p>æœ¬ç« å±•ç¤ºäº†Three.jsä¸­é«˜çº§ç€è‰²å™¨çš„å®é™…åº”ç”¨ï¼Œä»¥å­”æ˜ç¯ç‰¹æ•ˆä¸ºä¾‹ï¼š</p>
<ol>
<li>ç¯å¢ƒè´´å›¾å’Œé«˜çº§æ¸²æŸ“è®¾ç½®</li>
<li>GLTFæ¨¡å‹åŠ è½½å’Œç€è‰²å™¨åº”ç”¨</li>
<li>å¤æ‚é¡¶ç‚¹å’Œç‰‡å…ƒç€è‰²å™¨çš„ç¼–å†™</li>
<li>åŠ¨ç”»ç³»ç»Ÿä¸ç€è‰²å™¨çš„é›†æˆ</li>
<li>ç›¸æœºæ§åˆ¶å’Œæ€§èƒ½ä¼˜åŒ–</li>
<li>æ‰¹é‡å¯¹è±¡ç®¡ç†å’Œæ¸²æŸ“ä¼˜åŒ–</li>
</ol>
<p>é€šè¿‡è¿™ç§ç»¼åˆåº”ç”¨ï¼Œå¯ä»¥åˆ›å»ºå‡ºå…·æœ‰ä¸“ä¸šå“è´¨çš„3Dè§†è§‰æ•ˆæœã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•ä¼˜åŒ–æ‰¹é‡å›¾ç‰‡ä¸Šä¼ ï¼Ÿé˜Ÿåˆ—æœºåˆ¶+åˆ†ç‰‡å¤„ç†+æ–­ç‚¹ç»­ä¼ ä¸‰è¿å‡»ï¼(é™„æºç )]]></title>    <link>https://juejin.cn/post/7588999772750299171</link>    <guid>https://juejin.cn/post/7588999772750299171</guid>    <pubDate>2025-12-29T08:04:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7588999772750299171" data-draft-id="7587336857539084297" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•ä¼˜åŒ–æ‰¹é‡å›¾ç‰‡ä¸Šä¼ ï¼Ÿé˜Ÿåˆ—æœºåˆ¶+åˆ†ç‰‡å¤„ç†+æ–­ç‚¹ç»­ä¼ ä¸‰è¿å‡»ï¼(é™„æºç )"/> <meta itemprop="keywords" content="å‰ç«¯,Node.js"/> <meta itemprop="datePublished" content="2025-12-29T08:04:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç‹å—¨çš®"/> <meta itemprop="url" content="https://juejin.cn/user/2137106336976183"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•ä¼˜åŒ–æ‰¹é‡å›¾ç‰‡ä¸Šä¼ ï¼Ÿé˜Ÿåˆ—æœºåˆ¶+åˆ†ç‰‡å¤„ç†+æ–­ç‚¹ç»­ä¼ ä¸‰è¿å‡»ï¼(é™„æºç )
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2137106336976183/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç‹å—¨çš®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-29T08:04:56.000Z" title="Mon Dec 29 2025 08:04:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-29
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    90
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ç‹å—¨çš®ï¼Œä¸€å<code>ä¸»ä¸šå‰ç«¯ï¼Œå‰¯ä¸šå…¨æ ˆ</code>çš„ç¨‹åºå‘˜ï¼Œåœ¨è¿™é‡Œæˆ‘ä¼šåˆ†äº«å…³äºæˆ‘å·¥ä½œä¸­æ¶‰åŠçš„<code>å‰ç«¯/å…¨æ ˆçš„å¸¸ç”¨æŠ€æœ¯</code>Â å¦‚æœæˆ‘çš„æ–‡ç« èƒ½è®©æ‚¨æœ‰æ‰€æ”¶è·ï¼Œæ¬¢è¿ä¸€é”®ä¸‰è¿ï¼ˆè¯„è®ºï¼Œç‚¹èµï¼Œå…³æ³¨ï¼‰ï¼Œæ„Ÿè°¢ï¼</p>
</blockquote>
<hr/>
<p>"ä½ åšè¿‡å›¾ç‰‡æ‰¹é‡ä¸Šä¼ å—ï¼Ÿè¯´è¯´ä½ æ˜¯æ€ä¹ˆä¼˜åŒ–çš„ã€‚"</p>
<p>æ¯æ¬¡é‡åˆ°è¿™ä¸ªé¢è¯•é—®é¢˜ï¼Œæ€»ä¸èƒ½å°¬ç­”ä¸€å¥"ç”¨äº†XXXç»„ä»¶åº“"ï¼Ÿå¤§å›¾å¡å¸¦å®½ã€å¤šå›¾ä¼ åŠå¤©ã€ç½‘ç»œä¸€æ–­ä»å¤´æ¥ã€å¹¶å‘ä¸€é«˜æœåŠ¡å™¨ç›´æ¥å´©â€”â€”è¿™äº›å‘ä½ è¸©è¿‡å‡ ä¸ªï¼Ÿ</p>
<p>è¿™ç¯‡æ–‡ç« åˆ†äº«ä¸€ä¸‹æˆ‘çš„Â Vue3 + Node.jsÂ å›¾ç‰‡æ‰¹é‡ä¸Šä¼ ä¼˜åŒ–æ–¹æ¡ˆï¼šä»å¹¶å‘æ§åˆ¶-&gt; å‹ç¼©-&gt; åˆ†ç‰‡-&gt; æ–­ç‚¹ç»­ä¼ ã€‚</p>
<p><strong>æ–¹æ¡ˆä¸­ä½¿ç”¨çš„æŠ€æœ¯</strong>ï¼š</p>
<p>Â· å‰ç«¯åŠä¾èµ–ï¼š<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2F" target="_blank" title="https://vuejs.org/" ref="nofollow noopener noreferrer">vue3</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fvite.dev%2F" target="_blank" title="https://vite.dev/" ref="nofollow noopener noreferrer">vite</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Felement-plus.org%2F" target="_blank" title="https://element-plus.org/" ref="nofollow noopener noreferrer">element-plus</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Faxios-http.com%2Fdocs%2Fintro" target="_blank" title="https://axios-http.com/docs/intro" ref="nofollow noopener noreferrer">axios</a></strong></p>
<p>Â· åç«¯åŠä¾èµ–ï¼š<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fnodejs.org%2Fen" target="_blank" title="https://nodejs.org/en" ref="nofollow noopener noreferrer">node</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fexpressjs.com%2F" target="_blank" title="https://expressjs.com/" ref="nofollow noopener noreferrer">express</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fexpressjs.com%2Fen%2Fresources%2Fmiddleware%2Fcors.html" target="_blank" title="https://expressjs.com/en/resources/middleware/cors.html" ref="nofollow noopener noreferrer">cors</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Ffs-extra" target="_blank" title="https://www.npmjs.com/package/fs-extra" ref="nofollow noopener noreferrer">fs-extra</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fnodemon" target="_blank" title="https://www.npmjs.com/package/nodemon" ref="nofollow noopener noreferrer">nodemon</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fmulter" target="_blank" title="https://www.npmjs.com/package/multer" ref="nofollow noopener noreferrer">multer</a></strong></p>
<p><strong>æ ¸å¿ƒæ€è·¯ï¼š</strong></p>
<p>1.å¹¶å‘æ§åˆ¶ï¼šé˜Ÿåˆ—æœºåˆ¶ + æœ€å¤§å¹¶å‘æ•°ï¼Œé¿å…åŒæ—¶ä¸Šä¼ å¤§é‡æ–‡ä»¶å¯¼è‡´æœåŠ¡ç«¯å¡é¡¿ã€‚</p>
<p>2.å›¾ç‰‡å‹ç¼©ï¼šé€šè¿‡Web Workeråå°å‹ç¼©ï¼Œä¸é˜»å¡ä¸»çº¿ç¨‹ã€‚</p>
<p>3.åˆ†å—ä¸Šä¼ ï¼šå¤§æ–‡ä»¶åˆ‡å‰²æˆ 1MB åˆ†ç‰‡ï¼Œé™ä½å•æ¬¡è¯·æ±‚å‹åŠ›ï¼Œæå‡æ•ˆç‡ã€‚</p>
<p>4.æ–­ç‚¹ç»­ä¼ ï¼šå­˜å‚¨å·²ä¸Šä¼ åˆ†å—ç¼–å·ï¼Œæ„å¤–ä¸­æ–­åä»æ–­ç‚¹ç»§ç»­ï¼Œé¿å…é‡å¤ä¸Šä¼ ã€‚</p>
<p>5.åŒé‡éªŒè¯ï¼šæœ¬åœ°è®°å½• + åç«¯æ ¡éªŒï¼Œé˜²æ­¢è„æ•°æ®ï¼ˆè®°å½•å­˜åœ¨ä½†æ–‡ä»¶ä¸¢å¤±ï¼‰ã€‚</p>
<p>6.å®æ—¶è¿›åº¦ï¼šæ¯ä¸ªåˆ†å—ä¸Šä¼ åæ›´æ–°è¿›åº¦æ¡ã€‚</p>
<p><strong>æ•ˆæœé¢„è§ˆï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ebea7dcdea1404cbdff06ebe2b6eb33~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg546L5Zeo55qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769418889&amp;x-signature=3QqLxVTN8MGsM8RMGoNJMqe0YFI%3D" alt="upload.gif" loading="lazy"/></p>
<h2 data-id="heading-0">1.å‰ç«¯ç»“æ„åˆå§‹åŒ–</h2>
<p>é¦–å…ˆä½¿ç”¨ <code>vite</code> åˆ›å»ºä¸€ä¸ª <code>vue3</code> é¡¹ç›®å¹¶å®‰è£…ä¾èµ–æ’ä»¶å’Œ <code>element-plus</code> ç»„ä»¶åº“ï¼Œé¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-é¡¹ç›®ç»“æ„" lang="é¡¹ç›®ç»“æ„">ğŸ“¦upload_front
 â”£ ğŸ“‚src
 â”ƒ â”£ ğŸ“‚components
 â”ƒ â”ƒ â”— ğŸ“œHome.vue
 â”ƒ â”£ ğŸ“œApp.vue
 â”ƒ â”£ ğŸ“œmain.js
 â”£ ğŸ“œindex.html
 â”£ ğŸ“œpackage.json
 â”£ ğŸ“œvite.config.js
</code></pre>
<p>æ¥ä¸‹æ¥ï¼Œåœ¨ <code>components/Home.vue</code> ä¸­åˆå§‹åŒ–é¡µé¢ç»“æ„ï¼ŒåŒæ—¶å®šä¹‰æ•°æ®å’Œäº‹ä»¶å¤„ç†å‡½æ•°ã€‚<code>Home.vue </code>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-Home.vue" lang="Home.vue">&lt;div&gt;
    &lt;el-upload 
      ref="uploadRef" 
      multiple
      accept="image/png,image/jpeg"
      :before-upload="beforeUpload"
      :http-request="customHttpRequest"
      :on-change="handleFileChange"
      :file-list="fileList"
      :auto-upload="false"
    &gt;
      &lt;el-button type="primary"&gt;æ‰¹é‡ä¸Šä¼ å›¾ç‰‡&lt;/el-button&gt;
    &lt;/el-upload&gt;
    &lt;div&gt;
      &lt;el-button type="primary" @click="startUpload"&gt;å¼€å§‹ä¸Šä¼ &lt;/el-button&gt;
    &lt;/div&gt;
    &lt;div v-for="file in uploadStatus" :key="file.uid" style="margin-top: 15px;"&gt;
      &lt;div style="margin-bottom: 5px;"&gt;
        &lt;span&gt;{{ file.name }}&lt;/span&gt;
        &lt;span v-if="file.status === 'success'" style="color: #67c23a; margin-left: 10px;"&gt;âœ“ ä¸Šä¼ æˆåŠŸ&lt;/span&gt;
        &lt;span v-if="file.status === 'error'" style="color: #f56c6c; margin-left: 10px;"&gt;âœ— ä¸Šä¼ å¤±è´¥&lt;/span&gt;
      &lt;/div&gt;
      &lt;el-progress 
        :percentage="Math.floor(file.progress)" 
        :status="file.status === 'success' ? 'success' : file.status === 'error' ? 'exception' : ''"
      /&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;script setup&gt;
    import { ref, onMounted, onUnmounted } from 'vue'
    import { ElMessage } from 'element-plus'
    import request from '@/utils/request'

    ----- å®šä¹‰æ•°æ® -----
    const fileList = ref([])  // æ–‡ä»¶åˆ—è¡¨
    const uploadStatus = ref([])  // ä¸Šä¼ çŠ¶æ€åˆ—è¡¨
    const uploadRef = ref(null)  // ä¸Šä¼ ç»„ä»¶å¼•ç”¨

    let uploadQueue = []  // ä¸Šä¼ é˜Ÿåˆ—
    let currentUploads = 0  // å½“å‰æ­£åœ¨ä¸Šä¼ çš„æ•°é‡
    let worker = null  // Workerå®ä¾‹

    // é…ç½®å‚æ•°
    const maxConcurrentUploads = 3  // æœ€å¤§å¹¶å‘ä¸Šä¼ æ•°
    const maxSizeInMB = 10  // æœ€å¤§æ–‡ä»¶å¤§å°ï¼ˆMBï¼‰
    const CHUNK_SIZE = 1 * 1024 * 1024  
    
    // äº‹ä»¶å¤„ç†å‡½æ•°
    const handleFileChange = () =&gt; {}
    const beforeUpload = () =&gt; {}
    const customHttpRequest = () =&gt; {}
    const startUpload = () =&gt; {}

&lt;script&gt;
</code></pre>
<p>ç®€å•è§£é‡Šä¸€ä¸‹æ¯”è¾ƒé‡è¦çš„æ•°æ®å®šä¹‰å’Œäº‹ä»¶å¤„ç†å‡½æ•°ï¼š</p>
<p><strong>uploadStatus</strong>ï¼š ä¸ºçŠ¶æ€åˆ—è¡¨ï¼Œæ”¶é›†è¦ä¸Šä¼ çš„å›¾ç‰‡æ•°æ®ã€‚</p>
<p><strong>uploadQueue</strong>ï¼š ä¸Šä¼ é˜Ÿåˆ—ï¼Œç»“åˆæœ€å¤§å¹¶å‘æ•°æ§åˆ¶ä¸Šä¼ æ•°é‡ã€‚</p>
<p><strong>currentUploads</strong>ï¼š ç›‘å¬æ­£åœ¨ä¸Šä¼ çš„å›¾ç‰‡æ•°é‡ï¼Œå¦‚æœå°äº <code>maxConcurrentUploads</code> åˆ™ç»§ç»­æ‰§è¡Œä¸Šä¼ é˜Ÿåˆ—ä¸­çš„å›¾ç‰‡ä¸Šä¼ ã€‚</p>
<p><strong>CHUNK_SIZE</strong>ï¼šè®¾ç½®åˆ†å—å¤§å°ï¼ˆMBï¼‰ã€‚</p>
<p><strong>handleFileChange</strong>ï¼šç”¨æˆ·é€‰æ‹©æ–‡ä»¶æ—¶è§¦å‘ã€‚</p>
<p><strong>beforeUpload</strong>ï¼šç”¨æˆ·ä¸Šä¼ å‰å¯¹æ–‡ä»¶çš„æ ¡éªŒã€‚</p>
<p><strong>customHttpRequest</strong>ï¼šä¸Šä¼ æ—¶è‡ªå®šä¹‰çš„å¤„ç†äº‹ä»¶é€»è¾‘ã€‚</p>
<h2 data-id="heading-1">2.å®šä¹‰è¾…åŠ©äº‹ä»¶å¤„ç†å‡½æ•°</h2>
<p>å‰ç«¯åˆå§‹åŒ–ç»“æ„å®Œæˆåï¼Œç»§ç»­å†ç¼–å†™ä¸¤ä¸ªè¾…åŠ©å‡½æ•°</p>
<p>1ï¸âƒ£ <strong>getFileIdentifier</strong>: å»é‡åˆ¤æ–­ï¼Œç”Ÿæˆå”¯ä¸€çš„æ–‡ä»¶æ ‡è¯†ç¬¦ï¼Œç”¨äºæ–­ç‚¹ç»­ä¼ å’Œåˆ†å—ç®¡ç†ã€‚</p>
<pre><code class="hljs language-javasscript" lang="javasscript">
/**
 * ç”Ÿæˆæ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†ï¼ˆåŸºäºåŸå§‹æ–‡ä»¶ä¿¡æ¯ï¼‰
 * è§„åˆ™ï¼šæ–‡ä»¶å_æ–‡ä»¶å¤§å°_æœ€åä¿®æ”¹æ—¶é—´
 * å³ä½¿å‹ç¼©åï¼Œä¹Ÿä½¿ç”¨åŸå§‹æ–‡ä»¶ä¿¡æ¯ç”ŸæˆIDï¼Œç¡®ä¿ä¸åŒæ–‡ä»¶IDä¸åŒ
 */
const getFileIdentifier = (file) =&gt; {
  // å¦‚æœæ–‡ä»¶æœ‰åŸå§‹ä¿¡æ¯ï¼ˆå‹ç¼©åçš„æ–‡ä»¶ï¼‰ï¼Œä½¿ç”¨åŸå§‹ä¿¡æ¯
  const originalFile = file._originalFile || file
  
  const safeName = originalFile.name.replace(/[^a-zA-Z0-9.-]/g, '_')
  return `${safeName}_${originalFile.size}_${originalFile.lastModified}`
}
</code></pre>
<p>2ï¸âƒ£ <strong>updateUploadProgress</strong>: æ›´æ–°æ–‡ä»¶çš„ä¸Šä¼ è¿›åº¦å’ŒçŠ¶æ€ï¼Œç”¨äºæ˜¾ç¤ºè¿›åº¦æ¡ã€‚</p>
<pre><code class="hljs language-javasscript" lang="javasscript">
const updateUploadProgress = (uid, progress, status) =&gt; {
  const statusItem = uploadStatus.value.find(item =&gt; item.uid === uid)
  if (statusItem) {
    statusItem.progress = progress
    statusItem.status = status
  }
}
</code></pre>
<h2 data-id="heading-2">3.æ·»åŠ é€‰ä¸­çš„å›¾ç‰‡è‡³ä¸Šä¼ åˆ—è¡¨</h2>
<p>åœ¨ <code>handleFileChange</code> äº‹ä»¶å‡½æ•°ä¸­å°†ç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡æ·»åŠ åˆ° <code>uploadStatus</code> æ•°ç»„ä¸­ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">handleFileChange</span> = (<span class="hljs-params">file, fileListData</span>) =&gt; {
  fileList.<span class="hljs-property">value</span> = fileListData
  
  <span class="hljs-comment">// æ£€æŸ¥åˆ¤æ–­æ˜¯å¦å·²ç»æ·»åŠ è¿‡è¿™ä¸ªå›¾ç‰‡ï¼Œå¦‚æœidç›¸åŒä»£è¡¨è¯¥å›¾ç‰‡å·²å­˜åœ¨ï¼Œç›´æ¥å¿½ç•¥</span>
  <span class="hljs-keyword">const</span> exists = uploadStatus.<span class="hljs-property">value</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">uid</span> === file.<span class="hljs-property">uid</span>)
  <span class="hljs-keyword">if</span> (!exists) {
    uploadStatus.<span class="hljs-property">value</span>.<span class="hljs-title function_">push</span>({
      <span class="hljs-attr">uid</span>: file.<span class="hljs-property">uid</span>, <span class="hljs-comment">// å›¾ç‰‡ID</span>
      <span class="hljs-attr">name</span>: file.<span class="hljs-property">name</span>, å›¾ç‰‡åç§°
      <span class="hljs-attr">progress</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// ä¸Šä¼ è¿›åº¦ï¼Œåˆå§‹åŒ–ä¸º0</span>
      <span class="hljs-attr">status</span>: <span class="hljs-string">'pending'</span> <span class="hljs-comment">// ä¸Šä¼ çŠ¶æ€ï¼Œé»˜è®¤å€¼ä¸ºpending</span>
    })
  }
}
</code></pre>
<p>æ³¨æ„ï¼šåœ¨å›¾ç‰‡ä¸Šä¼ åˆ°æ•°ç»„ä¹‹å‰ï¼Œæ·»åŠ ä¸€ä¸ªåˆ¤æ–­ï¼Œå¦‚æœè¯¥å›¾ç‰‡å·²å­˜åœ¨åˆ™ç›´æ¥å¿½ç•¥ï¼Œé¿å…ç›¸åŒå›¾ç‰‡é‡å¤ä¸Šä¼ ã€‚</p>
<h2 data-id="heading-3">4.åˆ›å»ºWeb Workerç‹¬ç«‹çº¿ç¨‹å‹ç¼©å›¾ç‰‡</h2>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»º <code>utils</code> æ–‡ä»¶å¤¹ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª <code>imageWorker.js</code> æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-imageWorkder.js" lang="imageWorkder.js">// imageWorker.js - ä½¿ç”¨ç°ä»£ Web Worker API
self.onmessage = async function (e) {
  const { file, quality, targetFormat, taskId } = e.data;

  try {
    const compressedFile = await compressImage(file, quality, targetFormat);
    // è¿”å›æ—¶å¸¦ä¸Š taskIdï¼Œç¡®ä¿æ¶ˆæ¯å¯¹åº”æ­£ç¡®
    self.postMessage({ 
      success: true, 
      file: compressedFile,
      taskId: taskId  // å…³é”®ï¼šè¿”å›ä»»åŠ¡ID
    })
  } catch (error) {
    self.postMessage({ 
      success: false, 
      error: error.message,
      taskId: taskId
    })
  }
}

const compressImage = async (file, quality, format) =&gt; {
  // ä½¿ç”¨ createImageBitmap æ›¿ä»£ new Image()
  const imageBitmap = await createImageBitmap(file)
  
  // ä½¿ç”¨ OffscreenCanvas æ›¿ä»£ document.createElement('canvas')
  const canvas = new OffscreenCanvas(imageBitmap.width, imageBitmap.height)
  const ctx = canvas.getContext('2d')
  
  // ç»˜åˆ¶å›¾ç‰‡åˆ°ç¦»å±ç”»å¸ƒ
  ctx.drawImage(imageBitmap, 0, 0)
  
  // è½¬æ¢ä¸º Blobï¼Œæ”¯æŒæ ¼å¼è½¬æ¢å’Œè´¨é‡å‹ç¼©
  const blob = await canvas.convertToBlob({
    type: `image/${format}`,
    quality: quality
  })
  
  // å°† Blob è½¬æ¢ä¸º File
  const compressedFile = new File([blob], file.name, {
    type: `image/${format}`,
    lastModified: Date.now(),
  });
  
  // é‡Šæ”¾ ImageBitmap èµ„æº
  imageBitmap.close();
  return compressedFile;
}

</code></pre>
<p><code>imageWorker.js</code> åˆ©ç”¨ <code>Web Worker</code> ç‹¬ç«‹çº¿ç¨‹å‹ç¼©ä¸Šä¼ å›¾ç‰‡ï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹ï¼Œç¡®ä¿å›¾ç‰‡å‹ç¼©æœŸé—´é¡µé¢æµç•…ä¸å¡é¡¿ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šWeb Workerä¸­ä¸è¦ä½¿ç”¨ <code>new Image</code> æˆ–è€… <code>document.createElement</code>è¿™ç§APIï¼Œè¦æ›´æ¢ä¸º <code>createImageBitmap</code> å’Œ <code>OffscreenCanvas</code></p>
<p>æ›´å¤šå…·ä½“çš„æ“ä½œï¼Œå¯ä»¥æŸ¥è¯¢ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FWeb_Workers_API%2FFunctions_and_classes_available_to_workers" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/API/Web_Workers_API/Functions_and_classes_available_to_workers" ref="nofollow noopener noreferrer">Web Workers å¯ä»¥ä½¿ç”¨çš„å‡½æ•°å’Œç±»</a> æ–‡æ¡£ã€‚</p>
<p>å®Œæˆ <code>imageWorker.js</code>åï¼Œå°†å…¶å¯¼å…¥é¡µé¢ä¸­ï¼Œå¹¶åœ¨ <code>onMounted</code> åˆå§‹åŒ–ï¼Œåœ¨ <code>onUnMounted</code> ç»„ä»¶å¸è½½æ—¶é”€æ¯ Worker é‡Šæ”¾å†…å­˜ã€‚</p>
<pre><code class="hljs language-Home.vue" lang="Home.vue">......
import { ref, onMounted, onUnmounted } from 'vue'
let worker = null

//ç»„ä»¶æŒ‚è½½æ—¶åˆå§‹åŒ–Worker
onMounted(() =&gt; {
  worker = new Worker(new URL('@/utils/imageWorker.js', import.meta.url))
  console.log('Worker å·²åˆå§‹åŒ–')
})

//ç»„ä»¶å¸è½½æ—¶æ¸…ç†Wokker
onUnmounted(() =&gt; {
  if (worker) {
    worker.terminate()
    worker = null
    console.log('Worker å·²æ¸…ç†')
  }
})
</code></pre>
<h2 data-id="heading-4">5.æ£€æŸ¥æ–‡ä»¶å¤§å°å¹¶å‹ç¼©</h2>
<p>æ¥ä¸‹æ¥åœ¨ <code>beforeUpload</code> äº‹ä»¶å¤„ç†å‡½æ•°ä¸­ï¼Œæ ¡éªŒä¸Šä¼ å›¾ç‰‡å¤§å°å¹¶å¼‚æ­¥è°ƒç”¨ <code>Workder</code> å®ç°å›¾ç‰‡å‹ç¼©ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">beforeUpload</span> = (<span class="hljs-params">file</span>) =&gt; {
  <span class="hljs-comment">// æ£€æŸ¥æ–‡ä»¶å¤§å°</span>
  <span class="hljs-keyword">const</span> isUnderLimit = file.<span class="hljs-property">size</span> / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span> &lt; maxSizeInMB
  <span class="hljs-keyword">if</span> (!isUnderLimit) {
    <span class="hljs-title class_">ElMessage</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡<span class="hljs-subst">${maxSizeInMB}</span>MB`</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
  }

  <span class="hljs-comment">// æ‰€æœ‰å›¾ç‰‡éƒ½ä½¿ç”¨ Worker å‹ç¼©ï¼ˆæ— è®ºå¤§å°ï¼‰</span>
  <span class="hljs-keyword">if</span> (worker) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-comment">// ç”Ÿæˆå”¯ä¸€ä»»åŠ¡IDï¼Œé¿å…å¤šä¸ªæ–‡ä»¶åŒæ—¶å‹ç¼©æ—¶æ··ä¹±</span>
      <span class="hljs-keyword">const</span> taskId = <span class="hljs-string">`<span class="hljs-subst">${file.name}</span>_<span class="hljs-subst">${file.size}</span>_<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>_<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random()}</span>`</span>
      
      <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleMessage</span> = (<span class="hljs-params">event</span>) =&gt; {
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æ˜¯å½“å‰ä»»åŠ¡çš„å“åº”</span>
        <span class="hljs-keyword">if</span> (event.<span class="hljs-property">data</span>.<span class="hljs-property">taskId</span> === taskId) {
          worker.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'message'</span>, handleMessage)
          worker.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'error'</span>, handleError)
          
          <span class="hljs-keyword">if</span> (event.<span class="hljs-property">data</span>.<span class="hljs-property">success</span>) {
            <span class="hljs-comment">// å‹ç¼©åçš„æ–‡ä»¶</span>
            <span class="hljs-keyword">const</span> compressedFile = event.<span class="hljs-property">data</span>.<span class="hljs-property">file</span>
            
            <span class="hljs-comment">// å…³é”®ï¼šç»™å‹ç¼©åçš„æ–‡ä»¶æ·»åŠ åŸå§‹æ–‡ä»¶ä¿¡æ¯</span>
            <span class="hljs-comment">// è¿™æ ·å¯ä»¥ç¡®ä¿æ–‡ä»¶IDçš„å”¯ä¸€æ€§å’Œä¸€è‡´æ€§</span>
            compressedFile.<span class="hljs-property">_originalFile</span> = {
              <span class="hljs-attr">name</span>: file.<span class="hljs-property">name</span>,
              <span class="hljs-attr">size</span>: file.<span class="hljs-property">size</span>,
              <span class="hljs-attr">lastModified</span>: file.<span class="hljs-property">lastModified</span>
            }
            
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[<span class="hljs-subst">${file.name}</span>] å‹ç¼©å®Œæˆ: <span class="hljs-subst">${file.size}</span> -&gt; <span class="hljs-subst">${compressedFile.size}</span> å­—èŠ‚`</span>)
            <span class="hljs-title function_">resolve</span>(compressedFile)
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[<span class="hljs-subst">${file.name}</span>] å‹ç¼©å¤±è´¥:`</span>, event.<span class="hljs-property">data</span>.<span class="hljs-property">error</span>)
            <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(event.<span class="hljs-property">data</span>.<span class="hljs-property">error</span>))
          }
        }
      }
      
      <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleError</span> = (<span class="hljs-params">error</span>) =&gt; {
        worker.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'message'</span>, handleMessage)
        worker.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'error'</span>, handleError)
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[<span class="hljs-subst">${file.name}</span>] Worker é”™è¯¯:`</span>, error)
        <span class="hljs-title function_">reject</span>(error)
      }
      
      worker.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'message'</span>, handleMessage)
      worker.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'error'</span>, handleError)
      
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[<span class="hljs-subst">${file.name}</span>] å¼€å§‹å‹ç¼©... (ä»»åŠ¡ID: <span class="hljs-subst">${taskId}</span>)`</span>)
      worker.<span class="hljs-title function_">postMessage</span>({ 
        file, 
        <span class="hljs-attr">quality</span>: <span class="hljs-number">0.8</span>,           <span class="hljs-comment">// å‹ç¼©è´¨é‡ 0.8</span>
        <span class="hljs-attr">targetFormat</span>: <span class="hljs-string">'jpeg'</span>,   <span class="hljs-comment">// ç›®æ ‡æ ¼å¼ JPEG</span>
        taskId                  <span class="hljs-comment">// ä¼ é€’ä»»åŠ¡ID</span>
      })
   })

   <span class="hljs-comment">// å¦‚æœ Worker æœªåˆå§‹åŒ–ï¼Œç›´æ¥é€šè¿‡</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[<span class="hljs-subst">${file.name}</span>] Worker æœªåˆå§‹åŒ–ï¼Œä¸å‹ç¼©`</span>)
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
}
</code></pre>
<p>ç®€è¿°ä¸€ä¸‹å‡ ä¸ªå…³é”®ç‚¹ï¼š</p>
<p>1ï¸âƒ£ Promise + taskId å¼‚æ­¥å‹ç¼©ï¼Œé€šè¿‡ taskId åŒ¹é…ï¼Œå¹¶å‘å‹ç¼©æ—¶åŒºåˆ†æ–‡ä»¶ï¼Œé˜²æ­¢è¿”å›ç»“æœæ··ä¹±ã€‚</p>
<p>2ï¸âƒ£ åœ¨å‹ç¼©åçš„æ–‡ä»¶ä¸Šé™„åŠ Â <code>_originalFile</code>ï¼Œç¡®ä¿åç»­ç”Ÿæˆçš„Â fileId åŸºäºåŸå§‹æ–‡ä»¶ï¼Œä¿è¯åç»­å®ç°æ–­ç‚¹ç»­ä¼ æ—¶çš„ä¸€è‡´æ€§ã€‚</p>
<h2 data-id="heading-5">6.é˜Ÿåˆ—æ§åˆ¶åŒæ—¶ä¸Šä¼ å¹¶å‘æ•°</h2>
<p>ç»§ç»­å®šä¹‰ä¸€ä¸ªå¤„ç†ä¸Šä¼ é˜Ÿåˆ—çš„äº‹ä»¶å‡½æ•°ï¼Œå¹¶åœ¨ä¸Šä¼ è‡ªå®šä¹‰äº‹ä»¶ <code>customHttpRequest</code> è¿›è¡Œè°ƒç”¨ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">customHttpRequest</span> = (<span class="hljs-params">options</span>) =&gt; {
  <span class="hljs-keyword">const</span> { file, onProgress, onError, onSuccess } = options
  
  <span class="hljs-comment">// å°†æ–‡ä»¶å’Œå›è°ƒå‡½æ•°åŒ…è£…åˆ°é˜Ÿåˆ—ä¸­</span>
  uploadQueue.<span class="hljs-title function_">push</span>({
    file,
    onProgress,
    onError,
    onSuccess,
    <span class="hljs-attr">uid</span>: file.<span class="hljs-property">uid</span>
  })
  
  <span class="hljs-comment">// å¼€å§‹å¤„ç†é˜Ÿåˆ—</span>
  <span class="hljs-title function_">processQueue</span>()
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">processQueue</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">while</span> (currentUploads &lt; maxConcurrentUploads &amp;&amp; uploadQueue.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">const</span> nextFile = uploadQueue.<span class="hljs-title function_">shift</span>()
    <span class="hljs-keyword">if</span> (nextFile) {
      ......
    }
  }
}
</code></pre>
<p><code>processQueue</code> çš„ä½œç”¨æ§åˆ¶æœ€å¤§ä¸Šä¼ å¹¶å‘æ•°ï¼Œå¦‚æœå½“å‰ä¸Šä¼ æ•°é‡å°äºæœ€å¤§å¹¶å‘æ•°ï¼Œåˆ™ä»å¾…ä¸Šä¼ é˜Ÿåˆ—ä¸­å–å‡ºä¸‹ä¸€ä¸ªæ–‡ä»¶ï¼Œå¡«æ»¡å¹¶å‘æ•°ã€‚åœ¨ä¿è¯ä¸Šä¼ æ•ˆç‡çš„åŒæ—¶å°½é‡é¿å…æœåŠ¡å™¨å‹åŠ›è¿‡å¤§ã€‚</p>
<h2 data-id="heading-6">7.åˆ†å—ä¸Šä¼ å¹¶æ”¯æŒæ–­ç‚¹ç»­ä¼ </h2>
<p>æˆ‘ä»¬å†æ¥å®šä¹‰ä¸€ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œå°†ä¸Šä¼ çš„æ–‡ä»¶æ‹†åˆ†æˆå¤šä¸ªåˆ†å—ã€‚</p>
<p>ä»è€Œå®ç°åˆ†å—ä¸Šä¼ Â + æ–­ç‚¹ç»­ä¼  + å¤±è´¥é‡è¯• + æ–‡ä»¶åˆå¹¶çš„å®Œæ•´æµç¨‹ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">uploadFileWithChunks</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">fileData</span>) =&gt; {
  currentUploads++
  <span class="hljs-keyword">const</span> file = fileData.<span class="hljs-property">file</span>
  
  <span class="hljs-comment">// è·å–æ–‡ä»¶åï¼ˆå¯èƒ½æ˜¯å‹ç¼©åçš„æ–‡ä»¶ï¼Œéœ€è¦ç”¨åŸå§‹æ–‡ä»¶åï¼‰</span>
  <span class="hljs-keyword">const</span> fileName = file.<span class="hljs-property">_originalFile</span> ? file.<span class="hljs-property">_originalFile</span>.<span class="hljs-property">name</span> : file.<span class="hljs-property">name</span>
  
  <span class="hljs-comment">// ç”Ÿæˆæ–‡ä»¶IDï¼ˆä½¿ç”¨åŸå§‹æ–‡ä»¶ä¿¡æ¯ï¼‰</span>
  <span class="hljs-keyword">const</span> fileId = <span class="hljs-title function_">getFileIdentifier</span>(file)
  
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// è®¡ç®—æ€»åˆ†å—æ•°</span>
    <span class="hljs-keyword">const</span> totalChunks = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(file.<span class="hljs-property">size</span> / <span class="hljs-variable constant_">CHUNK_SIZE</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[<span class="hljs-subst">${fileName}</span>] æ€»å…± <span class="hljs-subst">${totalChunks}</span> å—ï¼Œæ¯å— 1MB`</span>)
    
    <span class="hljs-comment">// ä» localStorage è¯»å–å·²ä¸Šä¼ çš„åˆ†å—ï¼ˆæ–­ç‚¹ç»­ä¼ ï¼‰</span>
    <span class="hljs-keyword">const</span> progressKey = <span class="hljs-string">`upload_<span class="hljs-subst">${fileId}</span>`</span>
    <span class="hljs-keyword">let</span> uploadedChunks = []
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> saved = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(progressKey)
      <span class="hljs-keyword">if</span> (saved) {
        uploadedChunks = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(saved).<span class="hljs-property">chunks</span> || []
      }
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[<span class="hljs-subst">${fileName}</span>] æ— æ–­ç‚¹è®°å½•ï¼Œä»å¤´å¼€å§‹`</span>)
    }
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æ‰€æœ‰åˆ†å—éƒ½å·²ä¸Šä¼ ï¼ˆæ–‡ä»¶å·²å®Œæˆï¼‰</span>
    <span class="hljs-keyword">if</span> (uploadedChunks.<span class="hljs-property">length</span> === totalChunks) {
     
      <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// ç¬¬äºŒé‡éªŒè¯ï¼šè°ƒç”¨åç«¯æ¥å£ç¡®è®¤æ–‡ä»¶æ˜¯å¦çœŸå®å­˜åœ¨</span>
        <span class="hljs-keyword">await</span> request.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/merge-chunks'</span>, {
          <span class="hljs-attr">filename</span>: fileName,
          <span class="hljs-attr">fileId</span>: fileId,
          totalChunks
        })  
      
        <span class="hljs-comment">// æ–‡ä»¶ç¡®å®å­˜åœ¨ï¼Œè·³è¿‡é‡å¤ä¸Šä¼ </span>
        <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(progressKey)
        currentUploads--
        <span class="hljs-title function_">processQueue</span>()
        fileData.<span class="hljs-title function_">onSuccess</span>({ <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span> })
        <span class="hljs-title function_">updateUploadProgress</span>(fileData.<span class="hljs-property">uid</span>, <span class="hljs-number">100</span>, <span class="hljs-string">'success'</span>)
        <span class="hljs-title class_">ElMessage</span>.<span class="hljs-title function_">success</span>(<span class="hljs-string">`<span class="hljs-subst">${fileName}</span> å·²ä¸Šä¼ ï¼ˆè·³è¿‡é‡å¤ä¸Šä¼ ï¼‰`</span>)
        <span class="hljs-keyword">return</span>
        
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-comment">// åˆå¹¶å¤±è´¥ï¼Œå¯èƒ½æ–‡ä»¶å·²è¢«åˆ é™¤ï¼Œæ¸…ç†è®°å½•é‡æ–°ä¸Šä¼ </span>
        <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(progressKey)
        uploadedChunks = []  <span class="hljs-comment">// æ¸…ç©ºå·²ä¸Šä¼ è®°å½•ï¼Œé‡æ–°å¼€å§‹</span>
      }
    }
    
    <span class="hljs-comment">// é€ä¸ªä¸Šä¼ åˆ†å—</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; totalChunks; i++) {
      <span class="hljs-comment">// è·³è¿‡å·²ä¸Šä¼ çš„åˆ†å—</span>
      <span class="hljs-keyword">if</span> (uploadedChunks.<span class="hljs-title function_">includes</span>(i)) {
        <span class="hljs-keyword">const</span> progress = ((i + <span class="hljs-number">1</span>) / totalChunks) * <span class="hljs-number">100</span>
        <span class="hljs-title function_">updateUploadProgress</span>(fileData.<span class="hljs-property">uid</span>, progress, <span class="hljs-string">'uploading'</span>)
        <span class="hljs-keyword">continue</span>
      }
      
      <span class="hljs-comment">// åˆ‡å‰²åˆ†å—</span>
      <span class="hljs-keyword">const</span> start = i * <span class="hljs-variable constant_">CHUNK_SIZE</span>
      <span class="hljs-keyword">const</span> end = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(start + <span class="hljs-variable constant_">CHUNK_SIZE</span>, file.<span class="hljs-property">size</span>)
      <span class="hljs-keyword">const</span> chunk = file.<span class="hljs-title function_">slice</span>(start, end)
      
      <span class="hljs-comment">// å‡†å¤‡ä¸Šä¼ æ•°æ®</span>
      <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormData</span>()
      formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">'chunk'</span>, chunk)
      formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">'filename'</span>, fileName)  <span class="hljs-comment">// ä½¿ç”¨åŸå§‹æ–‡ä»¶å</span>
      formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">'fileId'</span>, fileId)
      formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">'chunkNumber'</span>, i)
      formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">'totalChunks'</span>, totalChunks)
      
      <span class="hljs-comment">// ä¸Šä¼ åˆ†å—ï¼ˆé‡è¯•3æ¬¡ï¼‰</span>
      <span class="hljs-keyword">let</span> success = <span class="hljs-literal">false</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> retry = <span class="hljs-number">0</span>; retry &lt; <span class="hljs-number">3</span> &amp;&amp; !success; retry++) {
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">await</span> request.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/upload-chunk'</span>, formData, {
            <span class="hljs-attr">headers</span>: { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'multipart/form-data'</span> }
          })
          success = <span class="hljs-literal">true</span>
          <span class="hljs-comment">// è®°å½•åˆ° localStorageï¼ˆç”¨äºæ–­ç‚¹ç»­ä¼ ï¼‰</span>
          uploadedChunks.<span class="hljs-title function_">push</span>(i)
          <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(progressKey, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">chunks</span>: uploadedChunks }))
          
          <span class="hljs-comment">// æ›´æ–°è¿›åº¦æ¡</span>
          <span class="hljs-keyword">const</span> progress = ((i + <span class="hljs-number">1</span>) / totalChunks) * <span class="hljs-number">100</span>
          <span class="hljs-title function_">updateUploadProgress</span>(fileData.<span class="hljs-property">uid</span>, progress, <span class="hljs-string">'uploading'</span>)
          fileData.<span class="hljs-title function_">onProgress</span>({ <span class="hljs-attr">percent</span>: progress })
          
        } <span class="hljs-keyword">catch</span> (error) {
          <span class="hljs-keyword">if</span> (retry &lt; <span class="hljs-number">2</span>) {
            <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">1000</span>))
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`åˆ†å— <span class="hljs-subst">${i}</span> ä¸Šä¼ å¤±è´¥`</span>)
          }
        }
      }
    }
    
    <span class="hljs-comment">// ğŸ¯ æ‰€æœ‰åˆ†å—ä¸Šä¼ å®Œæˆåï¼Œç«‹å³æ¸…ç† localStorage</span>
    <span class="hljs-comment">// è¿™æ ·å¯ä»¥é¿å…ï¼šä¸Šä¼ å®Œæˆ â†’ åˆ·æ–°é¡µé¢ â†’ localStorageæ®‹ç•™ â†’ é‡å¤ä¸Šä¼ </span>
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(progressKey)
    
    <span class="hljs-comment">// åˆå¹¶æ–‡ä»¶</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[<span class="hljs-subst">${fileName}</span>] å¼€å§‹åˆå¹¶...`</span>)
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> mergeResult = <span class="hljs-keyword">await</span> request.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/merge-chunks'</span>, {
        <span class="hljs-attr">filename</span>: fileName,  <span class="hljs-comment">// ä½¿ç”¨åŸå§‹æ–‡ä»¶å</span>
        <span class="hljs-attr">fileId</span>: fileId,
        totalChunks
      })
      
      <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æ˜¯è·³è¿‡é‡å¤ä¸Šä¼ </span>
      <span class="hljs-keyword">if</span> (mergeResult.<span class="hljs-property">message</span> &amp;&amp; mergeResult.<span class="hljs-property">message</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'è·³è¿‡é‡å¤'</span>)) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[<span class="hljs-subst">${fileName}</span>] âš ï¸ åç«¯æ£€æµ‹åˆ°é‡å¤ä¸Šä¼ ï¼Œå·²è·³è¿‡`</span>)
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[<span class="hljs-subst">${fileName}</span>] âœ“ åˆå¹¶å®Œæˆ`</span>)
      }
      
      currentUploads--
      <span class="hljs-title function_">processQueue</span>()
      fileData.<span class="hljs-title function_">onSuccess</span>({ <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span> })
      <span class="hljs-title function_">updateUploadProgress</span>(fileData.<span class="hljs-property">uid</span>, <span class="hljs-number">100</span>, <span class="hljs-string">'success'</span>)
      <span class="hljs-title class_">ElMessage</span>.<span class="hljs-title function_">success</span>(<span class="hljs-string">`<span class="hljs-subst">${fileName}</span> ä¸Šä¼ æˆåŠŸ`</span>)
      
    } <span class="hljs-keyword">catch</span> (mergeError) {
      <span class="hljs-comment">// åˆå¹¶å¤±è´¥çš„ç‰¹æ®Šå¤„ç†</span>
      <span class="hljs-keyword">const</span> errorMsg = mergeError.<span class="hljs-property">message</span> || <span class="hljs-string">''</span>
      
      <span class="hljs-comment">// å¦‚æœæ˜¯"åˆ†å—ç›®å½•ä¸å­˜åœ¨"ï¼Œå¯èƒ½æ˜¯ä¸´æ—¶æ–‡ä»¶è¢«æ¸…ç†äº†</span>
      <span class="hljs-comment">// ä½†æ‰€æœ‰åˆ†å—å·²ä¸Šä¼ ï¼Œè§†ä¸ºæˆåŠŸï¼ˆå®¹é”™å¤„ç†ï¼‰</span>
      <span class="hljs-keyword">if</span> (errorMsg.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'åˆ†å—ç›®å½•ä¸å­˜åœ¨'</span>) || errorMsg.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'ä¸å­˜åœ¨'</span>)) {
        currentUploads--
        <span class="hljs-title function_">processQueue</span>()
        fileData.<span class="hljs-title function_">onSuccess</span>({ <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span> })
        <span class="hljs-title function_">updateUploadProgress</span>(fileData.<span class="hljs-property">uid</span>, <span class="hljs-number">100</span>, <span class="hljs-string">'success'</span>)
        <span class="hljs-title class_">ElMessage</span>.<span class="hljs-title function_">success</span>(<span class="hljs-string">`<span class="hljs-subst">${fileName}</span> ä¸Šä¼ æˆåŠŸ`</span>)
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// å…¶ä»–åˆå¹¶é”™è¯¯ï¼Œæ­£å¸¸æŠ›å‡º</span>
        <span class="hljs-keyword">throw</span> mergeError
      }
    }
    
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[<span class="hljs-subst">${fileName}</span>] âœ— ä¸Šä¼ å¤±è´¥:`</span>, error.<span class="hljs-property">message</span>)
    currentUploads--
    <span class="hljs-title function_">processQueue</span>()
    fileData.<span class="hljs-title function_">onError</span>(error)
    <span class="hljs-title function_">updateUploadProgress</span>(fileData.<span class="hljs-property">uid</span>, <span class="hljs-number">0</span>, <span class="hljs-string">'error'</span>)
    <span class="hljs-title class_">ElMessage</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`<span class="hljs-subst">${fileName}</span> ä¸Šä¼ å¤±è´¥`</span>)
  }
}
</code></pre>
<p>å…³é”®æŠ€æœ¯èŠ‚ç‚¹ï¼š</p>
<p>1ï¸âƒ£ åŒé‡éªŒè¯ï¼š<code>localstroage</code> æœ¬åœ°è®°å½• + åç«¯ <code>merge-chunks</code> æ¥å£éªŒè¯ï¼Œé˜²æ­¢"è„æ•°æ®"çš„äº§ç”Ÿã€‚</p>
<p>2ï¸âƒ£ æ–­ç‚¹ç»­ä¼ ï¼š<code>localStorage.setItem(progressKey, JSON.stringify({ chunks: uploadedChunks }))</code>,æ¯ä¸Šä¼ ä¸€ä¸ªåˆ†å—ä¿å­˜ç¼–å·ï¼Œç­‰ä¸‹æ¬¡æ–­ç‚¹ç»­ä¼ æ—¶æ–¹ä¾¿ç²¾å‡†å¯¹åº”ç¼–å·ï¼Œè·³è¿‡é‡å¤æ¨¡å—ä»¥èŠ‚çœèµ„æºã€‚</p>
<p>3ï¸âƒ£ å¤±è´¥é‡è¯•ï¼š<code>for</code>Â å¾ªç¯é‡è¯•3æ¬¡ï¼Œæé«˜ä¸Šä¼ æˆåŠŸç‡ã€‚</p>
<p>æœ€åï¼Œç»™ "å¼€å§‹ä¸Šä¼ " æŒ‰é’®ç»‘å®š <code>startUpload</code>ç‚¹å‡»äº‹ä»¶ï¼Œè§¦å‘ <code>&lt;el-upload&gt;</code> ä¸Šä¼ ç¨‹åºã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-keyword">const</span> <span class="hljs-title function_">startUpload</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (uploadRef.<span class="hljs-property">value</span>) {
    uploadRef.<span class="hljs-property">value</span>.<span class="hljs-title function_">submit</span>()
  }
}
</code></pre>
<h2 data-id="heading-7">8.Node.jsåç«¯ä»£ç </h2>
<p>å—é™äºç¯‡å¹…è¿‡é•¿çš„åŸå› ï¼Œåç«¯ä»£ç ä¸å†åšè¯¦ç»†é˜è¿°ï¼Œä¸»è¦é€»è¾‘å·²åœ¨æºç ä¸­æ ‡è®°æ³¨é‡Šã€‚</p>
<p>ä¹Ÿå¯ç‚¹å‡»æŸ¥çœ‹ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Faosang%2Fnode_upload" target="_blank" title="https://github.com/aosang/node_upload" ref="nofollow noopener noreferrer">å‰åç«¯å®Œæ•´æºç </a></p>
<pre><code class="hljs language-Node.js" lang="Node.js">import express from 'express'
import cors from 'cors'
import path from 'path'
import fs from 'fs-extra'
import multer from 'multer'
import { fileURLToPath } from 'url'
import { dirname } from 'path'

const __filename = fileURLToPath(import.meta.url)
const __dirname = dirname(__filename)

const app = express()
app.use(cors())

const upload_dir = path.resolve(__dirname, 'uploads')
fs.ensureDirSync(upload_dir)

// é…ç½®é™æ€æ–‡ä»¶è®¿é—®ï¼Œä½¿ /uploads è·¯å¾„å¯ä»¥è®¿é—®åˆ° uploads æ–‡ä»¶å¤¹
app.use('/uploads', express.static(upload_dir))

// é…ç½® multer å­˜å‚¨
const storage = multer.diskStorage({
  destination: function (req, file, cb) {
    cb(null, upload_dir)
  },
  filename: function (req, file, cb) {
    const ext = path.extname(file.originalname)
    const basename = path.basename(file.originalname, ext)
    cb(null, `${basename}-${Date.now()}${ext}`)
  }
})

const upload = multer({ storage: storage })

app.use(express.json())

// åˆ†å—ä¸Šä¼ ä¸´æ—¶ç›®å½•
const temp_dir = path.resolve(__dirname, 'temp_chunks')
fs.ensureDirSync(temp_dir)

// å·²å®Œæˆä¸Šä¼ çš„æ ‡è®°ç›®å½•ï¼ˆé¿å…é‡å¤ä¸Šä¼ ï¼‰
// æ³¨æ„ï¼šæ”¾åœ¨ temp_chunks å¤–éƒ¨ï¼Œé¿å…è¢«æ¸…ç†
const completed_dir = path.resolve(__dirname, 'upload_completed')
fs.ensureDirSync(completed_dir)
console.log(`å®Œæˆæ ‡è®°ç›®å½•: ${completed_dir}`)

// ä¸Šä¼ å•ä¸ªåˆ†å—ï¼ˆç®€åŒ–ç‰ˆï¼‰
app.post('/upload-chunk', upload.single('chunk'), (req, res) =&gt; {
  try {
    const { filename, fileId, chunkNumber, totalChunks } = req.body
    
    if (!req.file) {
      return res.status(400).json({
        success: false,
        message: 'æœªæ¥æ”¶åˆ°åˆ†å—æ–‡ä»¶'
      })
    }
    
    // ä½¿ç”¨ fileId åˆ›å»ºåˆ†å—ç›®å½•
    const chunkDir = path.resolve(temp_dir, fileId)
    fs.ensureDirSync(chunkDir)
    
    // ä¿å­˜åˆ†å—æ–‡ä»¶
    const chunkPath = path.resolve(chunkDir, `chunk-${chunkNumber}`)
    fs.moveSync(req.file.path, chunkPath, { overwrite: true })
    
    console.log(`å·²æ¥æ”¶: ${filename} åˆ†å— ${chunkNumber}/${totalChunks}`)
    
    res.json({
      success: true,
      message: `åˆ†å— ${chunkNumber} ä¸Šä¼ æˆåŠŸ`
    })
  } catch (error) {
    console.error(`åˆ†å—ä¸Šä¼ å¤±è´¥: ${error.message}`)
    res.status(500).json({
      success: false,
      message: 'åˆ†å—ä¸Šä¼ å¤±è´¥',
      error: error.message
    })
  }
})

// åˆå¹¶åˆ†å—ï¼ˆç®€åŒ–ç‰ˆï¼‰
app.post('/merge-chunks', async (req, res) =&gt; {
  try {
    const { filename, fileId, totalChunks } = req.body
    const chunkDir = path.resolve(temp_dir, fileId)
    const completedFlag = path.resolve(completed_dir, fileId)
    
    console.log(`å¼€å§‹åˆå¹¶: ${filename} (å…± ${totalChunks} å—)`)
    console.log(`åˆ†å—ç›®å½•: ${chunkDir}`)
    console.log(`å®Œæˆæ ‡è®°: ${completedFlag}`)
    
    // ğŸ¯ ä¼˜å…ˆæ£€æŸ¥ï¼šè¯¥æ–‡ä»¶æ˜¯å¦å·²ç»å®Œæˆè¿‡ï¼ˆé¿å…é‡å¤ä¸Šä¼ ï¼‰
    if (fs.existsSync(completedFlag)) {
      try {
        const savedFilename = await fs.readFile(completedFlag, 'utf-8')
        const actualFilePath = path.resolve(upload_dir, savedFilename)
        
        // ğŸ” å…³é”®æ£€æŸ¥ï¼šéªŒè¯å®é™…æ–‡ä»¶æ˜¯å¦çœŸå®å­˜åœ¨
        if (fs.existsSync(actualFilePath)) {
          console.log(`âœ“ æ–‡ä»¶ ${filename} å·²å­˜åœ¨ï¼Œè·³è¿‡é‡å¤ä¸Šä¼ `)
          console.log(`  å®é™…æ–‡ä»¶: ${savedFilename}`)
          return res.json({
            success: true,
            message: 'æ–‡ä»¶å·²ä¸Šä¼ ï¼ˆè·³è¿‡é‡å¤ï¼‰',
            filename: savedFilename
          })
        } else {
          // âš ï¸ æ ‡è®°æ–‡ä»¶å­˜åœ¨ï¼Œä½†å®é™…æ–‡ä»¶ä¸å­˜åœ¨ï¼ˆå¯èƒ½è¢«åˆ é™¤ï¼‰
          console.log(`âš ï¸ æ ‡è®°å­˜åœ¨ä½†æ–‡ä»¶ä¸å­˜åœ¨: ${savedFilename}`)
          console.log(`  åˆ é™¤æ— æ•ˆæ ‡è®°ï¼Œé‡æ–°ä¸Šä¼ `)
          await fs.remove(completedFlag)
          // ç»§ç»­æ‰§è¡Œåç»­çš„åˆå¹¶æµç¨‹
        }
      } catch (readError) {
        console.error(`è¯»å–å®Œæˆæ ‡è®°å¤±è´¥: ${readError.message}`)
        // å¦‚æœè¯»å–å¤±è´¥ï¼Œåˆ é™¤æŸåçš„æ ‡è®°æ–‡ä»¶ï¼Œç»§ç»­åˆå¹¶æµç¨‹
        await fs.remove(completedFlag)
      }
    }
    
    // æ£€æŸ¥åˆ†å—ç›®å½•æ˜¯å¦å­˜åœ¨
    if (!fs.existsSync(chunkDir)) {
      console.log(`âŒ åˆ†å—ç›®å½•ä¸å­˜åœ¨: ${fileId}`)
      return res.status(400).json({
        success: false,
        message: 'åˆ†å—ç›®å½•ä¸å­˜åœ¨ï¼Œè¯·é‡æ–°ä¸Šä¼ '
      })
    }
    
    // ç”Ÿæˆæœ€ç»ˆæ–‡ä»¶å
    const ext = path.extname(filename)
    const basename = path.basename(filename, ext)
    const finalFileName = `${basename}-${Date.now()}${ext}`
    const finalFilePath = path.resolve(upload_dir, finalFileName)
    
    // åˆ›å»ºå†™å…¥æµï¼ŒæŒ‰é¡ºåºåˆå¹¶åˆ†å—
    const writeStream = fs.createWriteStream(finalFilePath)
    
    for (let i = 0; i &lt; totalChunks; i++) {
      const chunkPath = path.resolve(chunkDir, `chunk-${i}`)
      
      // æ£€æŸ¥åˆ†å—æ˜¯å¦å­˜åœ¨
      if (!fs.existsSync(chunkPath)) {
        writeStream.close()
        return res.status(400).json({
          success: false,
          message: `åˆ†å— ${i} ä¸å­˜åœ¨ï¼Œè¯·é‡æ–°ä¸Šä¼ `
        })
      }
      
      // è¯»å–å¹¶å†™å…¥åˆ†å—
      const chunkBuffer = await fs.readFile(chunkPath)
      writeStream.write(chunkBuffer)
    }
    
    writeStream.end()
    
    // ç­‰å¾…å†™å…¥å®Œæˆ
    await new Promise((resolve, reject) =&gt; {
      writeStream.on('finish', resolve)
      writeStream.on('error', reject)
    })
    
    // åˆ é™¤ä¸´æ—¶åˆ†å—ç›®å½•
    await fs.remove(chunkDir)
    
    // ğŸ¯ åˆ›å»ºå®Œæˆæ ‡è®°ï¼ˆä¿å­˜æœ€ç»ˆæ–‡ä»¶åï¼Œé¿å…é‡å¤ä¸Šä¼ ï¼‰
    try {
      // ç¡®ä¿ .completed ç›®å½•å­˜åœ¨
      await fs.ensureDir(completed_dir)
      await fs.writeFile(completedFlag, finalFileName, 'utf-8')
      console.log(`âœ“ åˆ›å»ºå®Œæˆæ ‡è®°: ${fileId}`)
    } catch (flagError) {
      // æ ‡è®°åˆ›å»ºå¤±è´¥ä¸å½±å“ä¸»æµç¨‹ï¼Œä»…è®°å½•æ—¥å¿—
      console.error(`âš ï¸ åˆ›å»ºå®Œæˆæ ‡è®°å¤±è´¥: ${flagError.message}`)
    }
    
    console.log(`åˆå¹¶æˆåŠŸ: ${finalFileName}`)
    
    res.json({
      success: true,
      message: 'æ–‡ä»¶ä¸Šä¼ æˆåŠŸ',
      filename: finalFileName
    })
  } catch (error) {
    console.error(`æ–‡ä»¶åˆå¹¶å¤±è´¥: ${error.message}`)
    res.status(500).json({
      success: false,
      message: 'æ–‡ä»¶åˆå¹¶å¤±è´¥',
      error: error.message
    })
  }
})

// ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶æ¥å£ï¼ˆä¿ç•™åŸæœ‰æ¥å£ï¼‰
app.post('/upload', upload.single('file'), (req, res) =&gt; {
  if (!req.file) {
    return res.status(400).json({
      success: false,
      message: 'No file uploaded'
    })
  }
  res.json({
    success: true,
    message: 'File uploaded successfully',
    filePath: req.file.path,
    filename: req.file.filename
  })
})

app.listen(3000, () =&gt; {
  console.log('Server is running on port 3000')
})
</code></pre>
<p>å¦‚æœæˆ‘çš„æ–‡ç« èƒ½è®©æ‚¨æœ‰æ‰€æ”¶è·ï¼Œæ¬¢è¿ä¸€é”®ä¸‰è¿ï¼ˆè¯„è®ºï¼Œç‚¹èµï¼Œå…³æ³¨ï¼‰ï¼Œæ„Ÿè°¢ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Mongooseæ“ä½œMongoDBæ•°æ®åº“ï¼ˆ2ï¼‰ï¼šå®ç°å¢ã€åˆ ã€æ”¹ã€æŸ¥åŸºç¡€æ“ä½œ]]></title>    <link>https://juejin.cn/post/7585085798809436187</link>    <guid>https://juejin.cn/post/7585085798809436187</guid>    <pubDate>2025-12-19T03:47:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585085798809436187" data-draft-id="7584722109583786027" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Mongooseæ“ä½œMongoDBæ•°æ®åº“ï¼ˆ2ï¼‰ï¼šå®ç°å¢ã€åˆ ã€æ”¹ã€æŸ¥åŸºç¡€æ“ä½œ"/> <meta itemprop="keywords" content="Mongoose"/> <meta itemprop="datePublished" content="2025-12-19T03:47:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç‹å—¨çš®"/> <meta itemprop="url" content="https://juejin.cn/user/2137106336976183"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Mongooseæ“ä½œMongoDBæ•°æ®åº“ï¼ˆ2ï¼‰ï¼šå®ç°å¢ã€åˆ ã€æ”¹ã€æŸ¥åŸºç¡€æ“ä½œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2137106336976183/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç‹å—¨çš®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T03:47:01.000Z" title="Fri Dec 19 2025 03:47:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    52
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ç‹å—¨çš®ï¼Œä¸€å<code>ä¸»ä¸šå‰ç«¯ï¼Œå‰¯ä¸šå…¨æ ˆ</code>çš„ç¨‹åºå‘˜ï¼Œåœ¨è¿™é‡Œæˆ‘ä¼šåˆ†äº«å…³äº<code>å‰ç«¯è¿›é˜¶å…¨æ ˆçš„å¸¸ç”¨æŠ€æœ¯</code>Â å’ŒÂ <code>åŸºæœ¬å…¥é—¨æ“ä½œ</code>ã€‚ å¦‚æœæˆ‘çš„æ–‡ç« èƒ½è®©æ‚¨æœ‰æ‰€æ”¶è·ï¼Œæ¬¢è¿ä¸€é”®ä¸‰è¿ï¼ˆè¯„è®ºï¼Œç‚¹èµï¼Œå…³æ³¨ï¼‰ã€‚</p>
<hr/>
<p>æœ¬èŠ‚å†…å®¹ï¼Œæˆ‘ä»¬é€šè¿‡ <code>mongoose</code> å®šä¹‰å¥½æ•°æ®æ¨¡å‹ï¼Œå¹¶å®ç°å¯¹æ•°æ®åº“<strong>å¢ã€åˆ ã€æ”¹ã€æŸ¥</strong>åŸºæœ¬çš„æ“ä½œã€‚</p>
<h3 data-id="heading-0">å®šä¹‰æ•°æ®æ¨¡å‹</h3>
<p>åœ¨é¡¹ç›®æ ¹å½•ä¸‹åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œåˆ†åˆ«å‘½åä¸º <code>modal</code> å’Œ <code>router</code>ï¼Œ</p>
<p>å…¶ä¸­ <code>modal</code> æ–‡ä»¶å¤¹ä¸‹æ–°å»º <code>modal.js</code> æ–‡ä»¶ç”¨æ¥å®šä¹‰æ•°æ®æ¨¡å‹ï¼Œ<code>router</code> æ–‡ä»¶å¤¹ä¸‹æ–°å»º <code>router.js</code> æ–‡ä»¶æ–¹ä¾¿åç»­åˆ›å»ºå¢ã€åˆ ã€æ”¹ã€æŸ¥è¯·æ±‚æ¥å£ã€‚</p>
<pre><code class="hljs language-é¡¹ç›®ç»“æ„" lang="é¡¹ç›®ç»“æ„">ğŸ“¦node_mongo
 â”£ ğŸ“‚model
 â”ƒ â”— ğŸ“œmodal.js
 â”£ ğŸ“‚router
 â”ƒ â”— ğŸ“œrouter.js
 â”£ ğŸ“œ.env
 â”£ ğŸ“œindex.js
 â”— ğŸ“œpackage.json
</code></pre>
<p>æ¥ä¸‹æ¥ï¼Œé¦–å…ˆåœ¨ <code>modal.js</code> ä¸­å»ºç«‹ <code>Schema</code> æ•°æ®æ–‡æ¡£ã€‚</p>
<p><strong>Schema</strong> æ˜¯ä»€ä¹ˆï¼Ÿ å®ƒç±»ä¼¼äºä¼ ç»Ÿæ•°æ®åº“ä¸­çš„è¡¨ç»“æ„ï¼Œå®šä¹‰äº†é›†åˆé‡Œæ¯ä¸ªæ–‡æ¡£ä¸­åº”è¯¥æœ‰çš„å­—æ®µï¼Œä»¥åŠè¿™äº›å­—æ®µçš„æ•°æ®ç±»å‹ã€‚</p>
<pre><code class="hljs language-modal.js" lang="modal.js">// å¯¼å…¥mongoose
import mongoose from 'mongoose'

// åˆ›å»ºSchemaæ–‡æ¡£
const carSchema = new mongoose.Schema({
  type: String,
  brand: String,
  price: Number,
})

// å¯¼å‡ºæ¨¡å‹
export const carModel = mongoose.model('car', carSchema)
</code></pre>
<p>ä¸Šè¿°ä»£ç ä¸­ï¼Œç¬¬ä¸€æ­¥å…ˆå°† mongoose æ ¸å¿ƒä¾èµ–åº“å¯¼å…¥ã€‚</p>
<p>å…¶æ¬¡ä»¥æ±½è½¦ä¸ºä¾‹ï¼Œåˆ›å»ºä¸€ä¸ª <code>carSchema</code> çš„å®ä¾‹å¯¹è±¡ï¼Œå¯¹è±¡ä¸­åŒ…å« <code>type</code>ã€<code>brand</code>ã€<code>price</code> ä¸‰ä¸ªå­—æ®µï¼Œåˆ†åˆ«ä»£è¡¨å‹å·ï¼Œå“ç‰Œå’Œä»·æ ¼ï¼Œå…¶ä¸­å‰ä¸¤ä¸ªä¸ºæ•°æ®ç±»å‹ä¸ºString(å­—ç¬¦ä¸²)ï¼Œä»·æ ¼çš„æ•°æ®ç±»å‹ä¸ºNumber(æ•°å­—)</p>
<p>æœ€åï¼Œä½¿ç”¨ <code>mongoose.model</code> å°†æ•°æ®æ¨¡å‹å¯¼å‡ºï¼Œæ–¹ä¾¿æ¥å£çš„ä½¿ç”¨ï¼Œ<code>mongoose.model</code> æ¥æ”¶ä¸¤ä¸ªå‚æ•°ã€‚</p>
<p>ç¬¬ä¸€ä¸ªå‚æ•° <code>car</code> æ˜¯MongoDBæ•°æ®åº“ä¸‹é›†åˆçš„åç§°ï¼ˆ<strong>æ³¨æ„ï¼šé›†åˆåˆ›å»ºæ—¶ä¼šåç§°è‡ªåŠ¨ä¿®æ”¹ä¸ºå¤æ•°ï¼Œæ¯”å¦‚ä»£ç ä¸­ä¼ é€’å‚æ•°ä¸º <code>car</code>ï¼Œæ•°æ®åº“é›†åˆçš„åç§°ä¼šå˜ä¸º <code>cars</code></strong>ï¼‰</p>
<p>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ <code>carSchema</code>ï¼Œå°±æ˜¯ä¹‹å‰åˆ›å»ºçš„æ–‡æ¡£å®ä¾‹å¯¹è±¡ã€‚</p>
<h3 data-id="heading-1">å¸¸ç”¨æ¥å£çš„åˆ›å»º</h3>
<p>å®Œæˆæ•°æ®æ¨¡å‹çš„å®šä¹‰åï¼Œæˆ‘ä»¬æ¥åˆ° <code>router</code> æ–‡ä»¶å¤¹ä¸‹ï¼Œ</p>
<p>é¦–å…ˆåˆ›å»ºä¸€ä¸ª <code>asyncHandler.js</code> ï¼Œå¹¶å®šä¹‰ä¸€ä¸ªç®€å•çš„é”™è¯¯å¤„ç†åŒ…è£…å‡½æ•°ï¼Œç»Ÿä¸€å¤„ç†é”™è¯¯æ ¼å¼ã€‚</p>
<pre><code class="hljs language-asyncHandler.js" lang="asyncHandler.js">// å¼‚æ­¥é”™è¯¯å¤„ç†åŒ…è£…å‡½æ•°
export const asyncHandler = (fn) =&gt; {
  return (req, res, next) =&gt; {
    Promise.resolve(fn(req, res, next)).catch((error) =&gt; {
      console.error('é”™è¯¯:', error.message)
      // ç»Ÿä¸€è¿”å›é”™è¯¯æ ¼å¼
      res.status(500).json({
        success: false,
        message: error.message || 'æœåŠ¡å™¨é”™è¯¯'
      })
    })
  }
}
</code></pre>
<p>ä¹‹åæŠŠæ•°æ®æ¨¡å‹ <code>carModel</code> å’Œ å¼‚æ­¥å¤„ç†å‡½æ•° <code>asyncHandler.js</code> å¯¼å…¥ <code>router.js</code>ã€‚</p>
<pre><code class="hljs language-router.js" lang="router.js">import express from 'express'
const router = express.Router()

// å¯¼å…¥model
import { carModel } from '../model/modal.js'
// å¯¼å…¥é”™è¯¯å¤„ç†åŒ…è£…å‡½æ•°
import { asyncHandler } from './asyncHandler.js'
</code></pre>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ <code>Restful API</code> åˆ†åˆ«æŒ‰é¡ºåºåˆ›å»ºå¢ã€åˆ ã€æ”¹ã€æŸ¥å››ä¸ªæ¥å£å¹¶å°†è·¯ç”±å¯¼å‡ºï¼Œå®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-router.js" lang="router.js">// æ–°å¢æ±½è½¦æ•°æ®
router.post('/addCars', asyncHandler(async (req, res) =&gt; {
  const { type, brand, price } = req.body
  const car = new carModel({ type, brand, price })
  await car.save()
  res.json(car)
}))

// åˆ é™¤æ±½è½¦æ•°æ®
router.delete('/deleteCars/:id', asyncHandler(async (req, res) =&gt; {
  //è·å–åˆ é™¤id
  const { id } = req.params
  await carModel.findByIdAndDelete(id)
  res.json({ message: 'æ•°æ®åˆ é™¤æˆåŠŸï¼' })
}))

// æ›´æ–°æ±½è½¦æ•°æ®
router.put('/updateCars/:id', asyncHandler(async (req, res) =&gt; {
  //è·å–æ›´æ–°æ•°æ®id
  const { id } = req.params
  const { type, brand, price } = req.body
  const car = await carModel.findByIdAndUpdate(id, { type, brand, price }, { new: true })
  res.json(car)
}))

// æŸ¥è¯¢æ‰€æœ‰æ±½è½¦æ•°æ®
router.get('/getAllCars', asyncHandler(async (req, res) =&gt; {
  const cars = await carModel.find()
  res.json(cars)
}))

// å¯¼å‡ºè·¯ç”±
export default router
</code></pre>
<h3 data-id="heading-2">æ¥å£æµ‹è¯•</h3>
<p>æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fapifox.com%2F" target="_blank" title="https://apifox.com/" ref="nofollow noopener noreferrer">Apifox</a> æ¥æµ‹è¯•ä¸€ä¸‹æ¥å£å’Œæ•°æ®åº“æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚</p>
<p>å…ˆåœ¨é¡¹ç›®æ ¹ç›®å½• <code>index.js</code> é‡Œå¯¼å…¥æ¥å£è·¯ç”±ã€‚</p>
<pre><code class="hljs language-index.js" lang="index.js">// å¯¼å…¥è·¯ç”±
import router from './router/router.js'
// å°†apiè®¾ç½®ä¸ºå…¬å…±è·¯å¾„ï¼Œä¸ç”¨æ¯æ¬¡éƒ½åœ¨è·¯ç”±å‰é¢åŠ /api
app.use('/api', router)
</code></pre>
<p>ä½¿ç”¨ç»ˆç«¯è¿›å…¥é¡¹ç›®æ ¹ç›®å½•ï¼Œæ‰§è¡Œ <code>node index.js</code> å¯åŠ¨æœåŠ¡ã€‚</p>
<p>æˆ‘ä»¬ä»¥æ–°å¢ä¸€æ¡æ±½è½¦æ•°æ®æ¥å£ä¸ºä¾‹ï¼Œè¯·æ±‚åœ°å€å’Œä¼ é€’å‚æ•°å‚è€ƒä¸‹å›¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1f36ea5d7d69468088192c9bc41340ad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg546L5Zeo55qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769140034&amp;x-signature=wEgGVqLagPHzDIOwaCVipXMFTrA%3D" alt="QQæˆªå›¾20251219105406.png" loading="lazy"/></p>
<p>ç‚¹å‡» "å‘é€" è¯·æ±‚ï¼Œå¦‚æœæ·»åŠ æˆåŠŸï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸‹æ–¹æ§åˆ¶å°çœ‹åˆ°è¿”å›çš„æ•°æ®ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/30060dac92a04de9a78322da6915147a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg546L5Zeo55qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769140034&amp;x-signature=GSvzjZhFTQagGYP7Y3%2BGOhJB3tQ%3D" alt="image.png" loading="lazy"/></p>
<p>ä¸ºäº†ç¡®è®¤æ•°æ®æ·»åŠ æˆåŠŸï¼Œå¯ä»¥ä½¿ç”¨ Navicat ç™»å½•æ•°æ®åº“æŸ¥çœ‹ä¸€ä¸‹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3bd1348ea60548ffbddacfa6b09b92eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg546L5Zeo55qu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769140034&amp;x-signature=eFes%2Fq0INlKmDKB5%2BauShjqC1Lg%3D" alt="QQæˆªå›¾20251219111525.png" loading="lazy"/></p>
<p>ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°åœ¨ <code>test</code> æ•°æ®åº“ä¸‹å·²ç»æˆåŠŸå»ºç«‹äº† <code>cars</code> é›†åˆï¼Œå¹¶ä¸”æœ‰äº†ä¸€æ¡æ•°æ®ã€‚å…¶å®ƒçš„æ¥å£å¤§å®¶å¯ä»¥è‡ªè¡Œè¿›è¡Œæµ‹è¯•ã€‚</p>
<p>åˆ°æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†ä½¿ç”¨ <code>Mongoose</code> å®ç°å¯¹æ•°æ®åº“å¢åˆ æ”¹æŸ¥çš„åŸºæœ¬æ“ä½œã€‚</p>
<p>ä¸‹ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†è®²è§£<strong>èšåˆã€æ¡ä»¶æŸ¥è¯¢ã€åˆ†é¡µ</strong>æ’åºç­‰ <code>Mongoose</code> å¯¹æ•°æ®åº“çš„è¿›é˜¶æ“ä½œã€‚</p>
<p>å¦‚æœæˆ‘çš„æ–‡ç« èƒ½è®©æ‚¨æœ‰æ‰€æ”¶è·ï¼Œæ¬¢è¿ä¸€é”®ä¸‰è¿ï¼ˆè¯„è®ºï¼Œç‚¹èµï¼Œå…³æ³¨ï¼‰ï¼Œæ„Ÿè°¢ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OpenFeign çš„å“åº”å¯¹è±¡æ€ä¹ˆå…±äº«ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7598043378018631689</link>    <guid>https://juejin.cn/post/7598043378018631689</guid>    <pubDate>2026-01-23T02:32:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598043378018631689" data-draft-id="7598021984300482587" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OpenFeign çš„å“åº”å¯¹è±¡æ€ä¹ˆå…±äº«ï¼Ÿ"/> <meta itemprop="keywords" content="å¾®æœåŠ¡,Spring Cloud,Spring Boot"/> <meta itemprop="datePublished" content="2026-01-23T02:32:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°é£Coding"/> <meta itemprop="url" content="https://juejin.cn/user/954816145155181"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OpenFeign çš„å“åº”å¯¹è±¡æ€ä¹ˆå…±äº«ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/954816145155181/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°é£Coding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T02:32:03.000Z" title="Fri Jan 23 2026 02:32:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ åœ¨ç”¨ OpenFeign è°ƒç”¨è¿œç¨‹æœåŠ¡æ—¶ï¼Œæ˜¯ä¸æ˜¯ç»å¸¸è¿™æ ·åšï¼Ÿ</p>
<ul>
<li>æœåŠ¡ Aï¼ˆæ¯”å¦‚ <code>user-service</code>ï¼‰å®šä¹‰äº†ä¸€ä¸ª <code>UserResponse</code></li>
<li>æœåŠ¡ Bï¼ˆæ¯”å¦‚ <code>order-service</code>ï¼‰è°ƒç”¨ Aï¼Œå°±æ‰‹åŠ¨æ–°å»ºä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„ <code>UserResponse</code> ç±»</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// order-service é‡Œâ€œç…§ç€æŠ„â€çš„ UserResponse</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserResponse</span> {
    <span class="hljs-keyword">private</span> Long id;
    <span class="hljs-keyword">private</span> String username;
    <span class="hljs-comment">// ... getter/setter</span>
}
</code></pre>
<p><strong>åœï¼è¿™çœ‹ä¼¼çœäº‹ï¼Œå®åˆ™åŸ‹é›·ã€‚</strong></p>
<ul>
<li>å­—æ®µæ”¹äº†æ€ä¹ˆåŠï¼Ÿ</li>
<li>ç±»å‹ä¸ä¸€è‡´æ€ä¹ˆåŠï¼Ÿ</li>
<li>å¯¹æ–¹æ˜¯ç¬¬ä¸‰æ–¹å…¬å¸ï¼Œä½ è¿æºç éƒ½çœ‹ä¸åˆ°æ€ä¹ˆåŠï¼Ÿ</li>
</ul>
<p>ä»Šå¤©æˆ‘ä»¬å°±æ¥å½»åº•è§£å†³è¿™ä¸ªé—®é¢˜ï¼š<strong>OpenFeign è°ƒç”¨ä¸­çš„å“åº”å¯¹è±¡ï¼ˆDTOï¼‰ï¼Œåˆ°åº•è¯¥æ€ä¹ˆå…±äº«ï¼Ÿ</strong></p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆâ€œå¤åˆ¶ç²˜è´´â€æ˜¯æŠ€æœ¯å€ºï¼Ÿ</h2>
<p>OpenFeign è°ƒç”¨æœ€ç»ˆæ˜¯ HTTP + JSONï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@FeignClient(name = "user-service")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserClient</span> {
    <span class="hljs-meta">@GetMapping("/users/{id}")</span>
    UserResponse <span class="hljs-title function_">getUser</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span>; <span class="hljs-comment">// â† è¿™ä¸ªç±»ä»å“ªæ¥ï¼Ÿ</span>
}
</code></pre>
<p>Feign ä¼šæŠŠ HTTP å“åº”ä½“ï¼ˆJSONï¼‰ååºåˆ—åŒ–æˆ <code>UserResponse</code>ã€‚
<strong>å¦‚æœè¿™ä¸ªç±»å’Œå¯¹æ–¹æœåŠ¡å®é™…è¿”å›çš„ç»“æ„ä¸ä¸€è‡´ï¼Œå°±ä¼šå‡ºé—®é¢˜ï¼š</strong></p>
<ul>
<li>å­—æ®µç¼ºå¤± â†’ å€¼ä¸º <code>null</code></li>
<li>ç±»å‹é”™è¯¯ï¼ˆå¦‚ <code>int</code> vs <code>String</code>ï¼‰â†’ ååºåˆ—åŒ–å¤±è´¥</li>
<li>å­—æ®µé‡å‘½å â†’ æ•°æ®é”™ä½</li>
</ul>
<p>æ›´å¯æ€•çš„æ˜¯ï¼š<strong>ç¼–è¯‘èƒ½è¿‡ï¼Œè¿è¡Œæ—¶æŠ¥é”™ï¼Œçº¿ä¸Šæ‰å‘ç°ï¼</strong></p>
<blockquote>
<p>ğŸ’¥ è¿™å°±æ˜¯å…¸å‹çš„ <strong>å¥‘çº¦ä¸ä¸€è‡´</strong> â€”â€” æœåŠ¡æä¾›æ–¹å’Œæ¶ˆè´¹æ–¹å¯¹æ•°æ®ç»“æ„çš„ç†è§£ä¸åŒæ­¥ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-1">äºŒã€æ–¹æ¡ˆ 1ï¼šå†…éƒ¨ç³»ç»Ÿ â†’ æŠ½å–å…¬å…± Maven æ¨¡å—ï¼ˆæ¨èï¼‰</h2>
<p>é€‚ç”¨äº<strong>åŒä¸€å…¬å¸ã€æœ‰ç§æœ‰ä»“åº“</strong>çš„åœºæ™¯ã€‚</p>
<h3 data-id="heading-2">âœ… æ­¥éª¤ï¼š</h3>
<ol>
<li>
<p><strong>æ–°å»º <code>common-model</code> æ¨¡å—</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- common-model/pom.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.yourcompany<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>common-model<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
</code></pre>
</li>
<li>
<p><strong>æŠŠ <code>UserResponse</code> æ”¾è¿›å»</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// common-model/src/main/java/com/yourcompany/model/UserResponse.java</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserResponse</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> {
    <span class="hljs-keyword">private</span> Long id;
    <span class="hljs-keyword">private</span> String username;
    <span class="hljs-comment">// å¿…é¡»æœ‰æ— å‚æ„é€  + getter/setterï¼ˆJackson éœ€è¦ï¼‰</span>
}
</code></pre>
</li>
<li>
<p><strong>æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯éƒ½ä¾èµ–å®ƒ</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- user-service &amp; order-service çš„ pom.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.yourcompany<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>common-model<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
</li>
<li>
<p><strong>Feign Client ç›´æ¥å¼•ç”¨</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.yourcompany.model.UserResponse;

<span class="hljs-meta">@FeignClient(name = "user-service")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserClient</span> {
    <span class="hljs-meta">@GetMapping("/users/{id}")</span>
    UserResponse <span class="hljs-title function_">getUser</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span>;
}
</code></pre>
</li>
</ol>
<h3 data-id="heading-3">âœ… ä¼˜åŠ¿ï¼š</h3>
<ul>
<li><strong>å•ä¸€æ•°æ®æº</strong>ï¼šæ”¹ä¸€æ¬¡ï¼Œæ‰€æœ‰æœåŠ¡åŒæ­¥</li>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šç¼–è¯‘æœŸå°±èƒ½å‘ç°å­—æ®µç¼ºå¤±</li>
<li><strong>ç¬¦åˆå¾®æœåŠ¡æœ€ä½³å®è·µ</strong>ï¼ˆç±»ä¼¼ Dubbo çš„ <code>api</code> æ¨¡å—ï¼‰</li>
</ul>
<blockquote>
<p>ğŸ“Œ æ³¨æ„ï¼š<code>common-model</code> åªæ”¾ DTOã€æšä¸¾ã€å¸¸é‡ï¼Œ<strong>ä¸è¦å¼•å…¥ Springã€ä¸šåŠ¡é€»è¾‘</strong>ï¼</p>
</blockquote>
<hr/>
<h2 data-id="heading-4">ä¸‰ã€æ–¹æ¡ˆ 2ï¼šè·¨å…¬å¸/ç¬¬ä¸‰æ–¹ â†’ ç”¨ OpenAPI è‡ªåŠ¨ç”Ÿæˆ</h2>
<p>å½“å¯¹æ–¹æ˜¯<strong>å¤–éƒ¨å›¢é˜Ÿæˆ– SaaS æœåŠ¡å•†</strong>ï¼Œä½ æ— æ³•æ‹¿åˆ° JAR åŒ…ï¼Œæ€ä¹ˆåŠï¼Ÿ</p>
<h3 data-id="heading-5">âœ… æ ¸å¿ƒï¼š<strong>å¥‘çº¦å³ä»£ç </strong></h3>
<ol>
<li>
<p><strong>è®©å¯¹æ–¹æä¾› OpenAPIï¼ˆSwaggerï¼‰æ–‡æ¡£</strong>
ï¼ˆæ ‡å‡† YAML/JSONï¼Œæè¿°æ¥å£å’Œæ•°æ®ç»“æ„ï¼‰</p>
</li>
<li>
<p><strong>ä½ ç”¨å·¥å…·è‡ªåŠ¨ç”Ÿæˆå®¢æˆ·ç«¯ä»£ç </strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨ OpenAPI Generator</span>
openapi-generator generate \
  -i https://partner.com/api-docs/user-service.yaml \
  -g java \
  --library=feign \
  -o ./generated-client
</code></pre>
</li>
<li>
<p><strong>è‡ªåŠ¨ç”Ÿæˆçš„å†…å®¹åŒ…æ‹¬ï¼š</strong></p>
<ul>
<li><code>UserResponse.java</code></li>
<li><code>UserApiClient.java</code>ï¼ˆå¸¦ <code>@FeignClient</code> æ³¨è§£ï¼‰</li>
</ul>
</li>
<li>
<p><strong>ç›´æ¥ä½¿ç”¨ï¼Œæ— éœ€æ‰‹å†™</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> UserApiClient userApiClient;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handle</span><span class="hljs-params">()</span> {
    <span class="hljs-type">UserResponse</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userApiClient.getUser(<span class="hljs-number">123L</span>); <span class="hljs-comment">// ç±»å‹å®‰å…¨ï¼</span>
}
</code></pre>
</li>
</ol>
<h3 data-id="heading-6">âœ… ä¼˜åŠ¿ï¼š</h3>
<ul>
<li><strong>è¯­è¨€æ— å…³</strong>ï¼šå¯¹æ–¹ç”¨ Pythonï¼Œä½ ç”¨ Javaï¼Œéƒ½èƒ½ç”Ÿæˆ</li>
<li><strong>è‡ªåŠ¨åŒ–</strong>ï¼šCI/CD ä¸­è‡ªåŠ¨æ›´æ–° SDK</li>
<li><strong>æ–‡æ¡£å³å¥‘çº¦</strong>ï¼šSwagger UI å¯è§†åŒ–æ¥å£è§„èŒƒ</li>
</ul>
<blockquote>
<p>ğŸ”§ å·¥å…·æ¨èï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fopenapi-generator.tech%2F" target="_blank" title="https://openapi-generator.tech/" ref="nofollow noopener noreferrer">OpenAPI Generator</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fspringdoc.org%2F" target="_blank" title="https://springdoc.org/" ref="nofollow noopener noreferrer">Springdoc</a></p>
</blockquote>
<hr/>
<h2 data-id="heading-7">å››ã€åƒä¸‡åˆ«è¿™ä¹ˆå¹²ï¼</h2>





















<table><thead><tr><th>é”™è¯¯åšæ³•</th><th>åæœ</th></tr></thead><tbody><tr><td>æ‰‹åŠ¨å¤åˆ¶ <code>UserResponse</code></td><td>å­—æ®µæ¼‚ç§»ã€çº¿ä¸Š bug</td></tr><tr><td>ç”¨ <code>Map&lt;String, Object&gt;</code> æ¥æ”¶</td><td>å¤±å»ç±»å‹å®‰å…¨ï¼Œä»£ç éš¾ç»´æŠ¤</td></tr><tr><td>è®© Feign è¿”å› <code>String</code> å†æ‰‹åŠ¨è§£æ JSON</td><td>é‡å¤é€ è½®å­ï¼Œæ˜“å‡ºé”™</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-8">äº”ã€è¿›é˜¶å»ºè®®ï¼šåŠ ä¸Šå¥‘çº¦æµ‹è¯•</h2>
<p>å³ä½¿æœ‰äº†å…±äº«æ¨¡å‹ï¼Œä¹Ÿä¸èƒ½ä¿è¯æ¥å£è¡Œä¸ºä¸€è‡´ã€‚æ¨èï¼š</p>
<ul>
<li><strong>Pact</strong>ï¼šæ¶ˆè´¹è€…é©±åŠ¨å¥‘çº¦æµ‹è¯•</li>
<li><strong>Spring Cloud Contract</strong>ï¼šæä¾›è€…é©±åŠ¨å¥‘çº¦æµ‹è¯•</li>
</ul>
<p>ä¾‹å¦‚ï¼Œè®¢å•æœåŠ¡å¯ä»¥å£°æ˜ï¼š</p>
<blockquote>
<p>â€œå½“æˆ‘è°ƒç”¨ <code>/users/123</code>ï¼ŒæœŸæœ›è¿”å› <code>{id: 123, username: "Alice"}</code>â€</p>
</blockquote>
<p>ç”¨æˆ·æœåŠ¡åœ¨ CI ä¸­éªŒè¯è¯¥å¥‘çº¦æ˜¯å¦é€šè¿‡ã€‚</p>
<blockquote>
<p>âœ… <strong>æ¨¡å‹ä¸€è‡´ + è¡Œä¸ºä¸€è‡´ = çœŸæ­£å¯é çš„å¾®æœåŠ¡è°ƒç”¨</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-9">å…­ã€æ€»ç»“</h2>





















<table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ–¹æ¡ˆ</th></tr></thead><tbody><tr><td><strong>å†…éƒ¨å¾®æœåŠ¡</strong></td><td>æŠ½å– <code>common-model</code> æ¨¡å—ï¼ŒMaven ä¾èµ–å…±äº«</td></tr><tr><td><strong>å¤–éƒ¨/ç¬¬ä¸‰æ–¹æœåŠ¡</strong></td><td>åŸºäº OpenAPI è‡ªåŠ¨ç”Ÿæˆå®¢æˆ·ç«¯</td></tr><tr><td><strong>å…³é”®æ ¸å¿ƒæ¥å£</strong></td><td>é…åˆå¥‘çº¦æµ‹è¯•ï¼ŒåŒé‡ä¿éšœ</td></tr></tbody></table>
<p><strong>è®°ä½ï¼šå¾®æœåŠ¡ä¸æ˜¯â€œå„è‡ªä¸ºæ”¿â€ï¼Œè€Œæ˜¯â€œå¥‘çº¦å…ˆè¡Œâ€ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Cè¯­è¨€çš„æŒ‡é’ˆ]]></title>    <link>https://juejin.cn/post/7598043378018680841</link>    <guid>https://juejin.cn/post/7598043378018680841</guid>    <pubDate>2026-01-23T02:34:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598043378018680841" data-draft-id="7598104572583133234" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Cè¯­è¨€çš„æŒ‡é’ˆ"/> <meta itemprop="keywords" content="åç«¯,åµŒå…¥å¼,å•ç‰‡æœº"/> <meta itemprop="datePublished" content="2026-01-23T02:34:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜è‰¯è®¸"/> <meta itemprop="url" content="https://juejin.cn/user/3913917128246942"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Cè¯­è¨€çš„æŒ‡é’ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3913917128246942/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜è‰¯è®¸
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T02:34:06.000Z" title="Fri Jan 23 2026 02:34:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯è‰¯è®¸ã€‚</p>
<p>ä»Šå¤©æˆ‘ä»¬æ¥èŠä¸€èŠ C è¯­è¨€ä¸­æœ€è®©åˆå­¦è€…å¤´ç–¼ï¼Œå´åˆæœ€å¼ºå¤§çš„ç‰¹æ€§â€”â€”æŒ‡é’ˆã€‚</p>
<p>ä½œä¸ºä¸€åä»äº‹åµŒå…¥å¼å¼€å‘å¤šå¹´çš„ç¨‹åºå‘˜ï¼Œæˆ‘æ·±çŸ¥æŒ‡é’ˆåœ¨åº•å±‚ç¼–ç¨‹ä¸­çš„é‡è¦æ€§ã€‚</p>
<p>æ— è®ºæ˜¯æ“ä½œç¡¬ä»¶å¯„å­˜å™¨ã€ç®¡ç†åŠ¨æ€å†…å­˜ï¼Œè¿˜æ˜¯å®ç°é«˜æ•ˆçš„æ•°æ®ç»“æ„ï¼ŒæŒ‡é’ˆéƒ½æ‰®æ¼”ç€ä¸å¯æˆ–ç¼ºçš„è§’è‰²ã€‚</p>
<h2 data-id="heading-0">1. ä»€ä¹ˆæ˜¯æŒ‡é’ˆ</h2>
<h3 data-id="heading-1">1.1 æŒ‡é’ˆçš„æœ¬è´¨</h3>
<p>æŒ‡é’ˆå…¶å®å°±æ˜¯ä¸€ä¸ªå˜é‡ï¼Œåªä¸è¿‡è¿™ä¸ªå˜é‡å­˜å‚¨çš„ä¸æ˜¯æ™®é€šçš„æ•°å€¼ï¼Œè€Œæ˜¯å†…å­˜åœ°å€ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥æŠŠå†…å­˜æƒ³è±¡æˆä¸€æ’æ’çš„æˆ¿é—´ï¼Œæ¯ä¸ªæˆ¿é—´éƒ½æœ‰ä¸€ä¸ªé—¨ç‰Œå·ï¼ˆåœ°å€ï¼‰ï¼Œè€ŒæŒ‡é’ˆå°±æ˜¯è®°å½•è¿™ä¸ªé—¨ç‰Œå·çš„æœ¬å­ã€‚</p>
<p>é€šè¿‡è¿™ä¸ªé—¨ç‰Œå·ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„æˆ¿é—´ï¼Œè¿›è€Œè®¿é—®æˆ–ä¿®æ”¹æˆ¿é—´é‡Œçš„å†…å®¹ã€‚</p>
<p>åœ¨åµŒå…¥å¼å¼€å‘ä¸­ï¼Œè¿™ä¸ªæ¦‚å¿µå°¤ä¸ºé‡è¦ã€‚æ¯”å¦‚ STM32 çš„ GPIO ç«¯å£ï¼Œå…¶å®å°±æ˜¯é€šè¿‡å›ºå®šçš„å†…å­˜åœ°å€æ¥è®¿é—®çš„ã€‚</p>
<p>å½“æˆ‘ä»¬è¦ç‚¹äº®ä¸€ä¸ª LED ç¯æ—¶ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯é€šè¿‡æŒ‡é’ˆæ“ä½œç‰¹å®šåœ°å€çš„å¯„å­˜å™¨ã€‚</p>
<h3 data-id="heading-2">1.2 ä¸ºä»€ä¹ˆéœ€è¦æŒ‡é’ˆ</h3>
<p>æŒ‡é’ˆçš„å­˜åœ¨ä¸»è¦è§£å†³äº†ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š</p>
<p>ç¬¬ä¸€ï¼Œé«˜æ•ˆä¼ é€’æ•°æ®ã€‚</p>
<p>å½“æˆ‘ä»¬éœ€è¦åœ¨å‡½æ•°ä¹‹é—´ä¼ é€’å¤§å‹æ•°æ®ç»“æ„æ—¶ï¼Œå¦‚æœç›´æ¥ä¼ é€’æ•´ä¸ªç»“æ„ä½“ï¼Œä¼šäº§ç”Ÿå¤§é‡çš„å¤åˆ¶å¼€é”€ã€‚</p>
<p>è€Œä½¿ç”¨æŒ‡é’ˆï¼Œåªéœ€è¦ä¼ é€’ä¸€ä¸ªåœ°å€ï¼ˆé€šå¸¸æ˜¯ 4 å­—èŠ‚æˆ– 8 å­—èŠ‚ï¼‰ï¼Œæ•ˆç‡å¤§å¤§æå‡ã€‚</p>
<p>ç¬¬äºŒï¼ŒåŠ¨æ€å†…å­˜ç®¡ç†ã€‚</p>
<p>åœ¨åµŒå…¥å¼ç³»ç»Ÿä¸­ï¼Œå†…å­˜èµ„æºå¾€å¾€éå¸¸æœ‰é™ã€‚</p>
<p>é€šè¿‡æŒ‡é’ˆå’ŒåŠ¨æ€å†…å­˜åˆ†é…ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç¨‹åºè¿è¡Œæ—¶æ ¹æ®å®é™…éœ€è¦ç”³è¯·å’Œé‡Šæ”¾å†…å­˜ï¼Œæé«˜å†…å­˜åˆ©ç”¨ç‡ã€‚</p>
<p>ç¬¬ä¸‰ï¼Œç›´æ¥æ“ä½œç¡¬ä»¶ã€‚</p>
<p>åœ¨åµŒå…¥å¼å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦ç›´æ¥è®¿é—®ç¡¬ä»¶å¯„å­˜å™¨ã€‚</p>
<p>è¿™äº›å¯„å­˜å™¨éƒ½æœ‰å›ºå®šçš„ç‰©ç†åœ°å€ï¼Œå¿…é¡»é€šè¿‡æŒ‡é’ˆæ¥è®¿é—®ã€‚</p>
<h2 data-id="heading-3">2. æŒ‡é’ˆçš„åŸºæœ¬ä½¿ç”¨</h2>
<h3 data-id="heading-4">2.1 æŒ‡é’ˆçš„å£°æ˜å’Œåˆå§‹åŒ–</h3>
<p>å£°æ˜ä¸€ä¸ªæŒ‡é’ˆå˜é‡çš„è¯­æ³•æ˜¯åœ¨ç±»å‹ååé¢åŠ ä¸Šæ˜Ÿå·ï¼ˆ*ï¼‰ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-type">int</span> *p;        <span class="hljs-comment">// å£°æ˜ä¸€ä¸ªæŒ‡å‘æ•´å‹çš„æŒ‡é’ˆ</span>
<span class="hljs-type">char</span> *str;     <span class="hljs-comment">// å£°æ˜ä¸€ä¸ªæŒ‡å‘å­—ç¬¦çš„æŒ‡é’ˆ</span>
<span class="hljs-type">float</span> *fp;     <span class="hljs-comment">// å£°æ˜ä¸€ä¸ªæŒ‡å‘æµ®ç‚¹æ•°çš„æŒ‡é’ˆ</span>
</code></pre>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåˆšå£°æ˜çš„æŒ‡é’ˆæ˜¯é‡æŒ‡é’ˆï¼Œå®ƒæŒ‡å‘ä¸€ä¸ªä¸ç¡®å®šçš„åœ°å€ï¼Œä½¿ç”¨å‰å¿…é¡»åˆå§‹åŒ–ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨å–åœ°å€ç¬¦ï¼ˆ&amp;ï¼‰æ¥è·å–å˜é‡çš„åœ°å€ï¼š</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">int</span> num = <span class="hljs-number">100</span>;
<span class="hljs-keyword">int</span> *p = &amp;num;  <span class="hljs-regexp">//</span> pæŒ‡å‘numçš„åœ°å€
â€‹
<span class="hljs-keyword">printf</span>(<span class="hljs-string">"numçš„å€¼: %d\n"</span>, num);
<span class="hljs-keyword">printf</span>(<span class="hljs-string">"numçš„åœ°å€: %p\n"</span>, &amp;num);
<span class="hljs-keyword">printf</span>(<span class="hljs-string">"på­˜å‚¨çš„åœ°å€: %p\n"</span>, p);
<span class="hljs-keyword">printf</span>(<span class="hljs-string">"pæŒ‡å‘çš„å€¼: %d\n"</span>, *p);
</code></pre>
<p>è¿™æ®µä»£ç ä¼šè¾“å‡º num çš„å€¼ã€num çš„åœ°å€ã€æŒ‡é’ˆ p å­˜å‚¨çš„åœ°å€ï¼ˆä¸ num çš„åœ°å€ç›¸åŒï¼‰ï¼Œä»¥åŠé€šè¿‡æŒ‡é’ˆ p è®¿é—®åˆ°çš„å€¼ï¼ˆä¹Ÿæ˜¯ 100ï¼‰ã€‚</p>
<h3 data-id="heading-5">2.2 æŒ‡é’ˆçš„è§£å¼•ç”¨</h3>
<p>è§£å¼•ç”¨å°±æ˜¯é€šè¿‡æŒ‡é’ˆè®¿é—®å®ƒæ‰€æŒ‡å‘çš„å†…å­˜ä¸­çš„å€¼ã€‚</p>
<p>ä½¿ç”¨æ˜Ÿå·ï¼ˆ*ï¼‰æ“ä½œç¬¦å¯ä»¥å®ç°è§£å¼•ç”¨ï¼š</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">int</span> a = <span class="hljs-number">50</span>;
<span class="hljs-keyword">int</span> *ptr = &amp;a;
â€‹
<span class="hljs-keyword">printf</span>(<span class="hljs-string">"açš„å€¼: %d\n"</span>, a);        <span class="hljs-regexp">//</span> è¾“å‡º<span class="hljs-number">50</span>
<span class="hljs-keyword">printf</span>(<span class="hljs-string">"*ptrçš„å€¼: %d\n"</span>, *ptr);  <span class="hljs-regexp">//</span> è¾“å‡º<span class="hljs-number">50</span>
â€‹
*ptr = <span class="hljs-number">80</span>;  <span class="hljs-regexp">//</span> é€šè¿‡æŒ‡é’ˆä¿®æ”¹açš„å€¼
<span class="hljs-keyword">printf</span>(<span class="hljs-string">"ä¿®æ”¹åaçš„å€¼: %d\n"</span>, a);  <span class="hljs-regexp">//</span> è¾“å‡º<span class="hljs-number">80</span>
</code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æŒ‡é’ˆ ptr ä¿®æ”¹äº†å˜é‡ a çš„å€¼ã€‚</p>
<p>è¿™åœ¨å‡½æ•°å‚æ•°ä¼ é€’ä¸­éå¸¸æœ‰ç”¨ï¼Œå¯ä»¥å®ç°çœŸæ­£çš„"ä¼ å€è°ƒç”¨"ã€‚</p>
<h3 data-id="heading-6">2.3 æŒ‡é’ˆä¸å‡½æ•°</h3>
<p>åœ¨ C è¯­è¨€ä¸­ï¼Œå‡½æ•°å‚æ•°é»˜è®¤æ˜¯å€¼ä¼ é€’ï¼Œä¹Ÿå°±æ˜¯è¯´å‡½æ•°å†…éƒ¨å¯¹å‚æ•°çš„ä¿®æ”¹ä¸ä¼šå½±å“å¤–éƒ¨å˜é‡ã€‚</p>
<p>ä½†é€šè¿‡æŒ‡é’ˆï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¼ å€è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">swap</span><span class="hljs-params">(<span class="hljs-type">int</span> *a, <span class="hljs-type">int</span> *b)</span> </span>{
    <span class="hljs-type">int</span> temp = *a;
    *a = *b;
    *b = temp;
}
â€‹
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> </span>{
    <span class="hljs-type">int</span> x = <span class="hljs-number">10</span>, y = <span class="hljs-number">20</span>;
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"äº¤æ¢å‰: x=%d, y=%d\n"</span>, x, y);
    
    <span class="hljs-built_in">swap</span>(&amp;x, &amp;y);
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"äº¤æ¢å: x=%d, y=%d\n"</span>, x, y);
    
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>è¿™ä¸ªç»å…¸çš„äº¤æ¢å‡½æ•°ä¾‹å­å±•ç¤ºäº†æŒ‡é’ˆçš„å¨åŠ›ã€‚</p>
<p>é€šè¿‡ä¼ é€’å˜é‡çš„åœ°å€ï¼Œå‡½æ•°å†…éƒ¨å¯ä»¥ç›´æ¥ä¿®æ”¹å¤–éƒ¨å˜é‡çš„å€¼ã€‚</p>
<h2 data-id="heading-7">3. æŒ‡é’ˆçš„è¿›é˜¶åº”ç”¨</h2>
<h3 data-id="heading-8">3.1 æŒ‡é’ˆä¸æ•°ç»„</h3>
<p>æ•°ç»„åæœ¬èº«å°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆå¸¸é‡ï¼ŒæŒ‡å‘æ•°ç»„çš„é¦–å…ƒç´ ã€‚</p>
<p>è¿™æ˜¯ C è¯­è¨€ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼š</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">int</span> arr[<span class="hljs-number">5</span>] = {<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>};
<span class="hljs-keyword">int</span> *p = arr;  <span class="hljs-regexp">//</span> ç­‰ä»·äº <span class="hljs-keyword">int</span> *p = &amp;arr[<span class="hljs-number">0</span>];
â€‹
<span class="hljs-keyword">printf</span>(<span class="hljs-string">"arr[0] = %d\n"</span>, arr[<span class="hljs-number">0</span>]);    <span class="hljs-regexp">//</span> è¾“å‡º<span class="hljs-number">1</span>
<span class="hljs-keyword">printf</span>(<span class="hljs-string">"*p = %d\n"</span>, *p);            <span class="hljs-regexp">//</span> è¾“å‡º<span class="hljs-number">1</span>
<span class="hljs-keyword">printf</span>(<span class="hljs-string">"*(p+1) = %d\n"</span>, *(p+<span class="hljs-number">1</span>));    <span class="hljs-regexp">//</span> è¾“å‡º<span class="hljs-number">2</span>
<span class="hljs-keyword">printf</span>(<span class="hljs-string">"p[2] = %d\n"</span>, p[<span class="hljs-number">2</span>]);        <span class="hljs-regexp">//</span> è¾“å‡º<span class="hljs-number">3</span>
</code></pre>
<p>æŒ‡é’ˆå¯ä»¥è¿›è¡Œç®—æœ¯è¿ç®—ã€‚</p>
<p>å½“æŒ‡é’ˆåŠ  1 æ—¶ï¼Œå®é™…ä¸Šæ˜¯ç§»åŠ¨äº†ä¸€ä¸ªæ‰€æŒ‡ç±»å‹çš„å¤§å°ã€‚</p>
<p>æ¯”å¦‚ int ç±»å‹å  4 å­—èŠ‚ï¼Œé‚£ä¹ˆ p+1 å®é™…ä¸Šæ˜¯åœ°å€å¢åŠ  4ã€‚</p>
<p>åœ¨åµŒå…¥å¼å¼€å‘ä¸­ï¼Œè¿™ä¸ªç‰¹æ€§ç»å¸¸ç”¨äºéå†æ•°æ®ç¼“å†²åŒºï¼š</p>
<pre><code class="hljs language-ini" lang="ini">uint8_t buffer<span class="hljs-section">[256]</span><span class="hljs-comment">;</span>
uint8_t *<span class="hljs-attr">ptr</span> = buffer<span class="hljs-comment">;</span>
â€‹
// é€šè¿‡æŒ‡é’ˆéå†æ•´ä¸ªç¼“å†²åŒº
for(int <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; 256; i++) {</span>
    *<span class="hljs-attr">ptr</span> = i<span class="hljs-comment">;  // å†™å…¥æ•°æ®</span>
    ptr++<span class="hljs-comment">;     // æŒ‡é’ˆç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªä½ç½®</span>
}
</code></pre>
<h3 data-id="heading-9">3.2 æŒ‡é’ˆä¸å­—ç¬¦ä¸²</h3>
<p>åœ¨ C è¯­è¨€ä¸­ï¼Œå­—ç¬¦ä¸²å®é™…ä¸Šå°±æ˜¯å­—ç¬¦æ•°ç»„ï¼Œè€Œå­—ç¬¦ä¸²çš„æ“ä½œå¤§é‡ä½¿ç”¨æŒ‡é’ˆï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-type">char</span> str[] = <span class="hljs-string">"Hello"</span>;
<span class="hljs-type">char</span> *p = str;
â€‹
<span class="hljs-keyword">while</span>(*p != <span class="hljs-string">'\0'</span>) {
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%c"</span>, *p);
    p++;
}
<span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
</code></pre>
<p>è¿™æ®µä»£ç é€šè¿‡æŒ‡é’ˆéå†å­—ç¬¦ä¸²å¹¶é€ä¸ªæ‰“å°å­—ç¬¦ã€‚</p>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å¤„ç†å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚è§£æä¸²å£æ¥æ”¶åˆ°çš„ AT æŒ‡ä»¤ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">parse_at_command</span><span class="hljs-params">(<span class="hljs-type">char</span> *cmd)</span> </span>{
    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">strncmp</span>(cmd, <span class="hljs-string">"AT+"</span>, <span class="hljs-number">3</span>) == <span class="hljs-number">0</span>) {
        <span class="hljs-type">char</span> *param = cmd + <span class="hljs-number">3</span>;  <span class="hljs-comment">// æŒ‡é’ˆåç§»åˆ°å‚æ•°éƒ¨åˆ†</span>
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"æ”¶åˆ°ATæŒ‡ä»¤ï¼Œå‚æ•°: %s\n"</span>, param);
    }
}
</code></pre>
<h3 data-id="heading-10">3.3 å¤šçº§æŒ‡é’ˆ</h3>
<p>æŒ‡é’ˆæœ¬èº«ä¹Ÿæ˜¯å˜é‡ï¼Œä¹Ÿæœ‰è‡ªå·±çš„åœ°å€ï¼Œå› æ­¤å¯ä»¥æœ‰æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆï¼Œç§°ä¸ºå¤šçº§æŒ‡é’ˆï¼š</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">int</span> num = <span class="hljs-number">100</span>;
<span class="hljs-keyword">int</span> *p = &amp;num;      <span class="hljs-regexp">//</span> ä¸€çº§æŒ‡é’ˆ
<span class="hljs-keyword">int</span> **pp = &amp;p;      <span class="hljs-regexp">//</span> äºŒçº§æŒ‡é’ˆ

<span class="hljs-keyword">printf</span>(<span class="hljs-string">"num = %d\n"</span>, num);
<span class="hljs-keyword">printf</span>(<span class="hljs-string">"*p = %d\n"</span>, *p);
<span class="hljs-keyword">printf</span>(<span class="hljs-string">"**pp = %d\n"</span>, **pp);

**pp = <span class="hljs-number">200</span>;  <span class="hljs-regexp">//</span> é€šè¿‡äºŒçº§æŒ‡é’ˆä¿®æ”¹numçš„å€¼
<span class="hljs-keyword">printf</span>(<span class="hljs-string">"ä¿®æ”¹ånum = %d\n"</span>, num);
</code></pre>
<p>å¤šçº§æŒ‡é’ˆåœ¨åŠ¨æ€äºŒç»´æ•°ç»„ã€å‡½æ•°æŒ‡é’ˆæ•°ç»„ç­‰åœºæ™¯ä¸­å¾ˆå¸¸è§ã€‚</p>
<p>åœ¨åµŒå…¥å¼å¼€å‘ä¸­ï¼Œæœ‰æ—¶éœ€è¦åŠ¨æ€ç®¡ç†è®¾å¤‡åˆ—è¡¨ï¼Œå°±ä¼šç”¨åˆ°äºŒçº§æŒ‡é’ˆã€‚</p>
<h2 data-id="heading-11">4. æŒ‡é’ˆåœ¨åµŒå…¥å¼ä¸­çš„å®æˆ˜åº”ç”¨</h2>
<h3 data-id="heading-12">4.1 æ“ä½œç¡¬ä»¶å¯„å­˜å™¨</h3>
<p>åœ¨ STM32 å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦ç›´æ¥æ“ä½œå¯„å­˜å™¨ã€‚</p>
<p>è¿™äº›å¯„å­˜å™¨éƒ½æœ‰å›ºå®šçš„ç‰©ç†åœ°å€ï¼Œå¿…é¡»é€šè¿‡æŒ‡é’ˆè®¿é—®ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// å®šä¹‰GPIOç«¯å£çš„åŸºåœ°å€</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> GPIOA_BASE    0x40020000U</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> GPIOA_MODER   (*(volatile uint32_t *)(GPIOA_BASE + 0x00))</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> GPIOA_ODR     (*(volatile uint32_t *)(GPIOA_BASE + 0x14))</span>

<span class="hljs-comment">// é…ç½®PA5ä¸ºè¾“å‡ºæ¨¡å¼</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">led_init</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> </span>{
    <span class="hljs-comment">// ä½¿èƒ½GPIOAæ—¶é’Ÿ</span>
    RCC-&gt;AHB1ENR |= RCC_AHB1ENR_GPIOAEN;

    <span class="hljs-comment">// é…ç½®PA5ä¸ºè¾“å‡ºæ¨¡å¼</span>
    GPIOA_MODER &amp;= ~(<span class="hljs-number">3U</span> &lt;&lt; (<span class="hljs-number">5</span> * <span class="hljs-number">2</span>));  <span class="hljs-comment">// æ¸…é™¤åŸé…ç½®</span>
    GPIOA_MODER |= (<span class="hljs-number">1U</span> &lt;&lt; (<span class="hljs-number">5</span> * <span class="hljs-number">2</span>));   <span class="hljs-comment">// è®¾ç½®ä¸ºè¾“å‡º</span>
}

<span class="hljs-comment">// ç‚¹äº®LED</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">led_on</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> </span>{
    GPIOA_ODR |= (<span class="hljs-number">1U</span> &lt;&lt; <span class="hljs-number">5</span>);
}

<span class="hljs-comment">// ç†„ç­LED</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">led_off</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> </span>{
    GPIOA_ODR &amp;= ~(<span class="hljs-number">1U</span> &lt;&lt; <span class="hljs-number">5</span>);
}
</code></pre>
<p>è¿™é‡Œçš„ <code>volatile</code> å…³é”®å­—éå¸¸é‡è¦ï¼Œå®ƒå‘Šè¯‰ç¼–è¯‘å™¨è¿™ä¸ªå˜é‡å¯èƒ½è¢«å¤–éƒ¨å› ç´ æ”¹å˜ï¼Œä¸è¦å¯¹å…¶è¿›è¡Œä¼˜åŒ–ã€‚</p>
<p>åœ¨è®¿é—®ç¡¬ä»¶å¯„å­˜å™¨æ—¶å¿…é¡»ä½¿ç”¨ volatile ä¿®é¥°ã€‚</p>
<h3 data-id="heading-13">4.2 DMA æ•°æ®ä¼ è¾“</h3>
<p>åœ¨ä½¿ç”¨ STM32 çš„ DMA åŠŸèƒ½æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æŒ‡å®šæºåœ°å€å’Œç›®æ ‡åœ°å€ï¼Œè¿™éƒ½æ˜¯é€šè¿‡æŒ‡é’ˆå®ç°çš„ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">uint8_t tx_buffer<span class="hljs-section">[128]</span><span class="hljs-comment">;</span>
uint8_t rx_buffer<span class="hljs-section">[128]</span><span class="hljs-comment">;</span>

void dma_uart_init(void) {
    // é…ç½®DMA
    <span class="hljs-attr">hdma_usart1_tx.Instance</span> = DMA2_Stream7<span class="hljs-comment">;</span>
    <span class="hljs-attr">hdma_usart1_tx.Init.Channel</span> = DMA_CHANNEL_4<span class="hljs-comment">;</span>
    <span class="hljs-attr">hdma_usart1_tx.Init.Direction</span> = DMA_MEMORY_TO_PERIPH<span class="hljs-comment">;</span>
    <span class="hljs-attr">hdma_usart1_tx.Init.PeriphInc</span> = DMA_PINC_DISABLE<span class="hljs-comment">;</span>
    <span class="hljs-attr">hdma_usart1_tx.Init.MemInc</span> = DMA_MINC_ENABLE<span class="hljs-comment">;</span>

    HAL_DMA_Init(&amp;hdma_usart1_tx)<span class="hljs-comment">;</span>
}

void send_data_via_dma(void) {
    // é€šè¿‡DMAå‘é€æ•°æ®ï¼Œä¼ é€’ç¼“å†²åŒºæŒ‡é’ˆ
    HAL_UART_Transmit_DMA(&amp;huart1, tx_buffer, sizeof(tx_buffer))<span class="hljs-comment">;</span>
}
</code></pre>
<h3 data-id="heading-14">4.3 åŠ¨æ€å†…å­˜ç®¡ç†</h3>
<p>åœ¨åµŒå…¥å¼ç³»ç»Ÿä¸­ï¼Œè™½ç„¶è¦è°¨æ…ä½¿ç”¨åŠ¨æ€å†…å­˜ï¼Œä½†åœ¨æŸäº›åœºæ™¯ä¸‹ç¡®å®éœ€è¦ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>

<span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> {</span>
    <span class="hljs-type">uint8_t</span> id;
    <span class="hljs-type">uint16_t</span> data;
    <span class="hljs-type">uint32_t</span> timestamp;
} <span class="hljs-type">sensor_data_t</span>;

<span class="hljs-type">sensor_data_t</span>* <span class="hljs-title function_">create_sensor_data</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> id)</span> {
    <span class="hljs-type">sensor_data_t</span> *data = (<span class="hljs-type">sensor_data_t</span>*)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(<span class="hljs-type">sensor_data_t</span>));
    <span class="hljs-keyword">if</span>(data != <span class="hljs-literal">NULL</span>) {
        data-&gt;id = id;
        data-&gt;data = <span class="hljs-number">0</span>;
        data-&gt;timestamp = HAL_GetTick();
    }
    <span class="hljs-keyword">return</span> data;
}

<span class="hljs-type">void</span> <span class="hljs-title function_">process_sensor</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    <span class="hljs-type">sensor_data_t</span> *sensor = create_sensor_data(<span class="hljs-number">1</span>);
    <span class="hljs-keyword">if</span>(sensor != <span class="hljs-literal">NULL</span>) {
        <span class="hljs-comment">// å¤„ç†ä¼ æ„Ÿå™¨æ•°æ®</span>
        sensor-&gt;data = read_sensor();

        <span class="hljs-comment">// ä½¿ç”¨å®Œæ¯•åé‡Šæ”¾å†…å­˜</span>
        <span class="hljs-built_in">free</span>(sensor);
    }
}
</code></pre>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨åµŒå…¥å¼ç³»ç»Ÿä¸­ä½¿ç”¨åŠ¨æ€å†…å­˜è¦ç‰¹åˆ«å°å¿ƒï¼Œå› ä¸ºé¢‘ç¹çš„ malloc å’Œ free å¯èƒ½å¯¼è‡´å†…å­˜ç¢ç‰‡ï¼Œå½±å“ç³»ç»Ÿç¨³å®šæ€§ã€‚</p>
<h2 data-id="heading-15">5. æŒ‡é’ˆä½¿ç”¨çš„æ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-16">5.1 é‡æŒ‡é’ˆé—®é¢˜</h3>
<p>é‡æŒ‡é’ˆæ˜¯æŒ‡å‘æœªçŸ¥å†…å­˜åŒºåŸŸçš„æŒ‡é’ˆï¼Œä½¿ç”¨é‡æŒ‡é’ˆä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–äº§ç”Ÿä¸å¯é¢„æµ‹çš„è¡Œä¸ºï¼š</p>
<pre><code class="hljs language-ini" lang="ini">int *p<span class="hljs-comment">;  // é‡æŒ‡é’ˆï¼Œæœªåˆå§‹åŒ–</span>
*<span class="hljs-attr">p</span> = <span class="hljs-number">10</span><span class="hljs-comment">; // å±é™©ï¼å¯èƒ½å¯¼è‡´ç¨‹åºå´©æºƒ</span>

// æ­£ç¡®åšæ³•
int *<span class="hljs-attr">p</span> = NULL<span class="hljs-comment">;  // åˆå§‹åŒ–ä¸ºNULL</span>
if(p != NULL) {
    *<span class="hljs-attr">p</span> = <span class="hljs-number">10</span><span class="hljs-comment">;</span>
}
</code></pre>
<p>åœ¨ä½¿ç”¨æŒ‡é’ˆå‰ï¼Œä¸€å®šè¦ç¡®ä¿å®ƒå·²ç»è¢«æ­£ç¡®åˆå§‹åŒ–ã€‚</p>
<p>å…»æˆå°†æŒ‡é’ˆåˆå§‹åŒ–ä¸º NULL çš„ä¹ æƒ¯ï¼Œå¹¶åœ¨ä½¿ç”¨å‰æ£€æŸ¥æ˜¯å¦ä¸º NULLã€‚</p>
<h3 data-id="heading-17">5.2 å†…å­˜æ³„æ¼</h3>
<p>åŠ¨æ€åˆ†é…çš„å†…å­˜å¦‚æœå¿˜è®°é‡Šæ”¾ï¼Œå°±ä¼šé€ æˆå†…å­˜æ³„æ¼ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">void</span> <span class="hljs-title function_">memory_leak_example</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    <span class="hljs-type">int</span> *p = (<span class="hljs-type">int</span>*)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>) * <span class="hljs-number">100</span>);
    <span class="hljs-comment">// ä½¿ç”¨p</span>
    <span class="hljs-comment">// å¿˜è®°è°ƒç”¨free(p)ï¼Œé€ æˆå†…å­˜æ³„æ¼</span>
}

<span class="hljs-comment">// æ­£ç¡®åšæ³•</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">correct_example</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> {
    <span class="hljs-type">int</span> *p = (<span class="hljs-type">int</span>*)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(<span class="hljs-type">int</span>) * <span class="hljs-number">100</span>);
    <span class="hljs-keyword">if</span>(p != <span class="hljs-literal">NULL</span>) {
        <span class="hljs-comment">// ä½¿ç”¨p</span>
        <span class="hljs-built_in">free</span>(p);
        p = <span class="hljs-literal">NULL</span>;  <span class="hljs-comment">// é‡Šæ”¾åç½®ä¸ºNULL</span>
    }
}
</code></pre>
<h3 data-id="heading-18">5.3 æ‚¬ç©ºæŒ‡é’ˆ</h3>
<p>å½“æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜è¢«é‡Šæ”¾åï¼Œå¦‚æœç»§ç»­ä½¿ç”¨è¯¥æŒ‡é’ˆï¼Œå°±ä¼šäº§ç”Ÿæ‚¬ç©ºæŒ‡é’ˆé—®é¢˜ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">int *<span class="hljs-attr">p</span> = (int*)malloc(sizeof(int))<span class="hljs-comment">;</span>
*<span class="hljs-attr">p</span> = <span class="hljs-number">100</span><span class="hljs-comment">;</span>
free(p)<span class="hljs-comment">;</span>
// pç°åœ¨æ˜¯æ‚¬ç©ºæŒ‡é’ˆ
*<span class="hljs-attr">p</span> = <span class="hljs-number">200</span><span class="hljs-comment">;  // å±é™©ï¼è®¿é—®å·²é‡Šæ”¾çš„å†…å­˜</span>

// æ­£ç¡®åšæ³•
free(p)<span class="hljs-comment">;</span>
<span class="hljs-attr">p</span> = NULL<span class="hljs-comment">;  // é‡Šæ”¾åç«‹å³ç½®ä¸ºNULL</span>
</code></pre>
<h2 data-id="heading-19">6. æ€»ç»“</h2>
<p>æŒ‡é’ˆæ˜¯ C è¯­è¨€çš„ç²¾é«“ï¼Œä¹Ÿæ˜¯åµŒå…¥å¼å¼€å‘çš„åŸºçŸ³ã€‚</p>
<p>è™½ç„¶åˆå­¦æ—¶å¯èƒ½è§‰å¾—éš¾ä»¥ç†è§£ï¼Œä½†åªè¦å¤šåŠ ç»ƒä¹ ï¼Œç†è§£å…¶æœ¬è´¨ï¼ˆå°±æ˜¯å†…å­˜åœ°å€ï¼‰ï¼Œå°±èƒ½é€æ¸æŒæ¡ã€‚</p>
<p>åœ¨æˆ‘å¤šå¹´çš„åµŒå…¥å¼å¼€å‘ç»éªŒä¸­ï¼ŒæŒ‡é’ˆæ— å¤„ä¸åœ¨ï¼šä»æ“ä½œç¡¬ä»¶å¯„å­˜å™¨åˆ°ç®¡ç†æ•°æ®ç»“æ„ï¼Œä»å‡½æ•°å‚æ•°ä¼ é€’åˆ°å®ç°å¤æ‚ç®—æ³•ï¼Œéƒ½ç¦»ä¸å¼€æŒ‡é’ˆã€‚</p>
<p>æŒæ¡æŒ‡é’ˆä¸ä»…èƒ½è®©ä½ å†™å‡ºæ›´é«˜æ•ˆçš„ä»£ç ï¼Œè¿˜èƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£è®¡ç®—æœºçš„å·¥ä½œåŸç†ã€‚</p>
<p>ç‰¹åˆ«æ˜¯åœ¨åµŒå…¥å¼é¢†åŸŸï¼Œå¯¹æŒ‡é’ˆçš„ç†Ÿç»ƒè¿ç”¨ç›´æ¥å…³ç³»åˆ°èƒ½å¦å†™å‡ºé«˜è´¨é‡çš„åº•å±‚ä»£ç ã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©å¤§å®¶æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨ C è¯­è¨€çš„æŒ‡é’ˆï¼Œåœ¨åµŒå…¥å¼å¼€å‘çš„é“è·¯ä¸Šèµ°å¾—æ›´è¿œã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ARouteræºç è¯¦è§£]]></title>    <link>https://juejin.cn/post/7598081541563662376</link>    <guid>https://juejin.cn/post/7598081541563662376</guid>    <pubDate>2026-01-23T02:34:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598081541563662376" data-draft-id="7592119218029658146" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ARouteræºç è¯¦è§£"/> <meta itemprop="keywords" content="æºç "/> <meta itemprop="datePublished" content="2026-01-23T02:34:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="XRay"/> <meta itemprop="url" content="https://juejin.cn/user/3966693685869288"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ARouteræºç è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3966693685869288/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    XRay
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T02:34:19.000Z" title="Fri Jan 23 2026 02:34:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>åœ¨å‰é¢çš„æ–‡ç«  <a href="https://juejin.cn/post/7592276645361893376" target="_blank" title="https://juejin.cn/post/7592276645361893376">ç»„ä»¶åŒ–</a> ä¸­ç”¨åˆ°äº† <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Falibaba%2FARouter%2Fblob%2Fmaster%2FREADME_CN.md" target="_blank" title="https://github.com/alibaba/ARouter/blob/master/README_CN.md" ref="nofollow noopener noreferrer">ARouter</a> æ¡†æ¶ï¼Œå®ƒæ˜¯ä¸“é—¨ç”¨æ¥åšç»„ä»¶åŒ–æ”¹é€ çš„ï¼Œå®˜æ–¹å®šä¹‰å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>ä¸€ä¸ªç”¨äºå¸®åŠ© Android App è¿›è¡Œç»„ä»¶åŒ–æ”¹é€ çš„æ¡†æ¶ â€”â€” æ”¯æŒæ¨¡å—é—´çš„è·¯ç”±ã€é€šä¿¡ã€è§£è€¦</p>
</blockquote>
<p>ä»€ä¹ˆæ˜¯è·¯ç”±ï¼Ÿå¯èƒ½ä½ é¦–å…ˆè”æƒ³åˆ°çš„æ˜¯è·¯ç”±å™¨ï¼Œè·¯ç”±å™¨æ ¹æ®è·¯ç”±è¡¨æ¥è½¬å‘æ•°æ®åŒ…ï¼Œè·¯ç”±è¡¨å†³å®šäº†æ•°æ®ä¼ è¾“çš„è·¯å¾„ã€‚ARouter å°±ç›¸å½“äºä¸€ä¸ªè·¯ç”±å™¨ï¼Œè®©æ— ä¾èµ–çš„åŒæ–¹å¯ä»¥é€šä¿¡ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬å°±é€šè¿‡æºç æ¥åˆ†æ ARouter çš„å®ç°åŸç†ï¼Œæœ¬æ–‡ ARouter æºç åŸºäºï¼šcom.alibaba:arouter-api:1.5.2ã€‚</p>
<h3 data-id="heading-1">æºç è§£æ</h3>
<p>ARouter çš„ç®€å•ä½¿ç”¨åœ¨å‰é¢çš„æ–‡ç« ä¸­å·²æœ‰ä»‹ç»ï¼Œä½¿ç”¨å‰éœ€è¦åœ¨ Application ä¸­ç”¨ <code>ARouter.init(this)</code> æ¥åˆå§‹åŒ– ARouterï¼Œä¸‹é¢æˆ‘ä»¬å°±ä»è¿™é‡Œå¼€å§‹åˆ†ææºç ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ARouter</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">hasInit</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">(Application application)</span> {
        <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦å·²ç»åˆå§‹åŒ–</span>
        <span class="hljs-keyword">if</span> (!hasInit) {
            ...
            <span class="hljs-comment">// è°ƒç”¨ _ARouter.init() åˆå§‹åŒ–</span>
            hasInit = _ARouter.init(application);

            <span class="hljs-keyword">if</span> (hasInit) {
                _ARouter.afterInit();
            }
            ...
        }
    }
}
</code></pre>
<p>é¦–å…ˆåˆ¤æ–­æœ‰æ²¡æœ‰åˆå§‹åŒ–ï¼Œæ²¡æœ‰åˆå§‹åŒ–å°±è¿›è¡Œåˆå§‹åŒ–ï¼Œå¹¶æŠŠåˆå§‹åŒ–çš„ç»“æœèµ‹å€¼ç»™ hasInitï¼Œ ARouter çš„ init() æ–¹æ³•è°ƒç”¨äº† _ARouter çš„ init() æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">_ARouter</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">hasInit</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-keyword">static</span> <span class="hljs-type">ThreadPoolExecutor</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> DefaultPoolExecutor.getInstance();

    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">init</span><span class="hljs-params">(Application application)</span> {
        mContext = application;
        LogisticsCenter.init(mContext, executor);
        ...
        hasInit = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
}
</code></pre>
<p>_ARouter çš„ init() æ–¹æ³•ä¸­å‡ºç°äº† LogisticsCenter è¿™ä¸ªç±»ï¼Œè¿™ä¸ªç±»æ˜¯åšä»€ä¹ˆçš„å‘¢ï¼Ÿçœ‹ç±»åæ˜¯ â€œç‰©æµä¸­å¿ƒâ€çš„æ„æ€ ï¼Œç»§ç»­çœ‹ä¸‹å®ƒçš„ init() æ–¹æ³•åšäº†äº›ä»€ä¹ˆï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LogisticsCenter</span> {

    <span class="hljs-comment">// åŠ è½½å†…å­˜ä¸­çš„è·¯ç”±ä¿¡æ¯</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">(Context context, ThreadPoolExecutor tpe)</span> <span class="hljs-keyword">throws</span> HandlerException {
        ...
        <span class="hljs-comment">// ä»æ’ä»¶ä¸­åŠ è½½è·¯ç”±è¡¨</span>
        loadRouterMap();
        <span class="hljs-keyword">if</span> (registerByPlugin) {
            logger.info(TAG, <span class="hljs-string">"Load router map by arouter-auto-register plugin."</span>);
        } <span class="hljs-keyword">else</span> {
            Set&lt;String&gt; routerMap;

            <span class="hljs-comment">// It will rebuild router map every times when debuggable.</span>
            <span class="hljs-comment">// è°ƒç”¨ ARouter.openDebug() ã€ç¬¬ä¸€æ¬¡è¿è¡Œã€ç‰ˆæœ¬æ›´æ–°éƒ½ä¼šæ›´æ–° routerMap ã€‚</span>
            <span class="hljs-comment">// PackageUtils.isNewVersion() ä¸­é€šè¿‡ SharedPreference å­˜å‚¨çš„ App çš„</span>
            <span class="hljs-comment">// versionName å’Œ versionCode æ¥åˆ¤æ–­ç‰ˆæœ¬æ˜¯å¦æœ‰æ›´æ–°</span>
            <span class="hljs-keyword">if</span> (ARouter.debuggable() || PackageUtils.isNewVersion(context)) {

                <span class="hljs-comment">// These class was generated by arouter-compiler.</span>
                <span class="hljs-comment">// è¿™é‡Œå°±æ˜¯ä» dex ä¸­è·å– com.alibaba.android.arouter.routes åŒ…ä¸‹çš„ .class</span>
                <span class="hljs-comment">// ROUTE_ROOT_PAKCAGE = "com.alibaba.android.arouter.routes";</span>
                routerMap = ClassUtils.getFileNameByPackageName(mContext, ROUTE_ROOT_PAKCAGE);
                <span class="hljs-keyword">if</span> (!routerMap.isEmpty()) {
                    <span class="hljs-comment">// æŠŠ routerMap å­˜å…¥ SharedPreference</span>
                    context.getSharedPreferences(AROUTER_SP_CACHE_KEY, Context.MODE_PRIVATE).edit().putStringSet(AROUTER_SP_KEY_MAP, routerMap).apply();
                }

                <span class="hljs-comment">// æ›´æ–° SharedPreference ä¸­å­˜å‚¨çš„ App çš„ç‰ˆæœ¬ä¿¡æ¯</span>
                PackageUtils.updateVersion(context); <span class="hljs-comment">// Save new version name when router map update finishes.</span>
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// ç›´æ¥ä» SP ä¸­æ‹¿ routerMap ï¼Œå°±æ˜¯å‰é¢ä¿å­˜åœ¨ SP ä¸­çš„ routerMap</span>
                routerMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;(context.getSharedPreferences(AROUTER_SP_CACHE_KEY, Context.MODE_PRIVATE).getStringSet(AROUTER_SP_KEY_MAP, <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;String&gt;()));
            }
            ...
            <span class="hljs-comment">// æ ¹æ® classNameï¼Œæ¥å®ä¾‹åŒ–ä¸åŒçš„å¯¹è±¡å¹¶è°ƒç”¨ loadInto() æ–¹æ³•ã€‚</span>
            <span class="hljs-keyword">for</span> (String className : routerMap) {
                <span class="hljs-comment">// ä»¥ com.alibaba.android.arouter.routes.ARouter$$Root å¼€å¤´</span>
                <span class="hljs-keyword">if</span> (className.startsWith(ROUTE_ROOT_PAKCAGE + DOT + SDK_NAME + SEPARATOR + SUFFIX_ROOT)) {
                    <span class="hljs-comment">// This one of root elements, load root.</span>
                    ((IRouteRoot) (Class.forName(className).getConstructor().newInstance())).loadInto(Warehouse.groupsIndex);
                }
                <span class="hljs-comment">// ä»¥ com.alibaba.android.arouter.routes.ARouter$$Interceptors å¼€å¤´</span>
                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (className.startsWith(ROUTE_ROOT_PAKCAGE + DOT + SDK_NAME + SEPARATOR + SUFFIX_INTERCEPTORS)) {
                    <span class="hljs-comment">// Load interceptorMeta</span>
                    ((IInterceptorGroup) (Class.forName(className).getConstructor().newInstance())).loadInto(Warehouse.interceptorsIndex);
                }
                <span class="hljs-comment">// ä»¥ com.alibaba.android.arouter.routes.ARouter$$Providers å¼€å¤´</span>
                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (className.startsWith(ROUTE_ROOT_PAKCAGE + DOT + SDK_NAME + SEPARATOR + SUFFIX_PROVIDERS)) {
                    <span class="hljs-comment">// Load providerIndex</span>
                    ((IProviderGroup) (Class.forName(className).getConstructor().newInstance())).loadInto(Warehouse.providersIndex);
                }
            }
        }
    }

    <span class="hljs-comment">/**
     * arouter-auto-register plugin will generate code inside this method
     * call this method to register all Routers, Interceptors and Providers
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loadRouterMap</span><span class="hljs-params">()</span> {
        registerByPlugin = <span class="hljs-literal">false</span>;
        <span class="hljs-comment">// auto generate register code by gradle plugin: arouter-auto-register</span>
        <span class="hljs-comment">// looks like below:</span>
        <span class="hljs-comment">// registerRouteRoot(new ARouter..Root..modulejava());</span>
        <span class="hljs-comment">// registerRouteRoot(new ARouter..Root..modulekotlin());</span>
    }
}
</code></pre>
<p>ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œè¿™æ®µä»£ç å°±æ˜¯åŠ è½½è·¯ç”±è¡¨çš„æ ¸å¿ƒä»£ç ï¼Œä¸Šé¢æœ‰æ³¨é‡Šæ ‡å‡ºäº†ä¸€äº›ä»£ç çš„ä¸šåŠ¡é€»è¾‘ï¼Œè¿™é‡Œå†æŒ‘å‡ºå‡ ä¸ªæ¯”è¾ƒéš¾ç†è§£çš„åœ°æ–¹é‡ç‚¹è®²è§£ä¸€ä¸‹ã€‚</p>
<p>é¦–å…ˆæ˜¯è¿™å¥ä»£ç loadRouterMap()ï¼Œæ³¨é‡Šä¸Šè¯´çš„æ˜¯ä»æ’ä»¶ä¸­åŠ è½½è·¯ç”±è¡¨ï¼Œä»€ä¹ˆæ„æ€å‘¢ï¼Ÿæ„æ€æ˜¯ä½ å¯ä»¥é€‰æ‹©ä½¿ç”¨ARouteræä¾›çš„æ³¨å†Œæ’ä»¶è‡ªåŠ¨åŠ è½½è·¯ç”±è¡¨ï¼Œè¯¥æ³¨å†Œæ’ä»¶ä¼šé€šè¿‡å­—èŠ‚ç æ³¨å…¥çš„æ–¹å¼ä¿®æ”¹loadRouterMap()ï¼Œä¿®æ”¹å®ŒåloadRouterMap()ç±»ä¼¼ä¸‹é¢è¿™æ ·ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loadRouterMap</span><span class="hljs-params">()</span> {
    registerByPlugin = <span class="hljs-literal">false</span>;
    register(<span class="hljs-string">"com.alibaba.android.arouter.routes.ARouter$$Root$$XXX"</span>);
    register(<span class="hljs-string">"com.alibaba.android.arouter.routes.ARouter$$Interceptors$$XXX"</span>);
    register(<span class="hljs-string">"com.alibaba.android.arouter.routes.ARouter$$Providers$$XXX"</span>);
}
</code></pre>
<p>è¿™ç§æƒ…å†µåœ¨ç¼–è¯‘æœŸæŠŠè·¯ç”±è¡¨åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¯ä»¥ç¼©çŸ­ARouteråˆå§‹åŒ–çš„æ—¶é—´ã€‚ä½¿ç”¨è¯¥æ’ä»¶éœ€è¦åœ¨é¡¹ç›®çš„build.gradleä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p>
<pre><code class="hljs language-groovy" lang="groovy">buildscript {
    ...
    dependencies {
        classpath "com.alibaba:arouter-register:1.0.2"
    }
}
</code></pre>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯¥æ’ä»¶å¿…é¡»ä¸ 1.3.0 åŠä»¥ä¸Šç‰ˆæœ¬çš„ API é…åˆä½¿ç”¨ã€‚</p>
<p>ç¬¬22è¡Œä»dexä¸­è·å–æ‰€æœ‰com.alibaba.android.arouter.routesåŒ…ä¸‹çš„.classæ–‡ä»¶æ”¾å…¥routerMapï¼Œä»ç¬¬36è¡Œå¼€å§‹éå†routerMapï¼Œåˆ†æˆäº†3ç§æƒ…å†µï¼š</p>
<ol>
<li>å¦‚æœ.classæ–‡ä»¶ä»¥com.alibaba.android.arouter.routes.ARouter$$Rootå¼€å¤´åˆ™åå°„åˆ›å»ºè¯¥å®ä¾‹ï¼Œå¹¶è°ƒç”¨è¯¥å®ä¾‹çš„loadInto()æ–¹æ³•ï¼ŒloadInto()æ–¹æ³•ä¼ å…¥çš„å‚æ•°ä¸ºWarehouse.groupsIndex;</li>
<li>å¦‚æœ.classæ–‡ä»¶ä»¥com.alibaba.android.arouter.routes.ARouter$$Interceptorså¼€å¤´åˆ™åå°„åˆ›å»ºè¯¥å®ä¾‹ï¼Œå¹¶è°ƒç”¨è¯¥å®ä¾‹çš„loadInto()æ–¹æ³•ï¼ŒloadInto()æ–¹æ³•ä¼ å…¥çš„å‚æ•°ä¸ºWarehouse.interceptorsIndex;</li>
<li>å¦‚æœ.classæ–‡ä»¶ä»¥com.alibaba.android.arouter.routes.ARouter$$Providerså¼€å¤´åˆ™åå°„åˆ›å»ºè¯¥å®ä¾‹ï¼Œå¹¶è°ƒç”¨è¯¥å®ä¾‹çš„loadInto()æ–¹æ³•ï¼ŒloadInto()æ–¹æ³•ä¼ å…¥çš„å‚æ•°ä¸ºWarehouse.providersIndex;</li>
</ol>
<p>åœ¨å‰é¢çš„æ–‡ç« ä¸­ï¼Œé€‰æ‹©é›†æˆè°ƒè¯•æ¨¡å¼ï¼ŒSync Projectåï¼Œåœ¨downloadæ¨¡å—ä¸‹çš„build\intermediates\javac\debug\classes\com\alibaba\android\arouter\routesç›®å½•ä¸‹å…±ç”Ÿæˆäº†3ä¸ª.classæ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶æ˜¯ç”±æ³¨è§£å¤„ç†å™¨ç”Ÿæˆçš„ï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-title class_">ARouter</span><span class="hljs-variable">$$</span><span class="hljs-title class_">Group</span><span class="hljs-variable">$$</span>download.<span class="hljs-keyword">class</span>
<span class="hljs-title class_">ARouter</span><span class="hljs-variable">$$</span><span class="hljs-title class_">Providers</span><span class="hljs-variable">$$</span>download.<span class="hljs-keyword">class</span>
<span class="hljs-title class_">ARouter</span><span class="hljs-variable">$$</span><span class="hljs-title class_">Root</span><span class="hljs-variable">$$</span>download.<span class="hljs-keyword">class</span>
</code></pre>
<p>å…¶ä¸­ARouter$$Root$$download.classä»¥com.alibaba.android.arouter.routes.ARouter$$Rootå¼€å¤´ï¼Œç‚¹å¼€ARouter$$Root$$download.classï¼Œå…¶ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ARouter$$Root$$download</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IRouteRoot</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loadInto</span><span class="hljs-params">(Map&lt;String, Class&lt;? extends IRouteGroup&gt;&gt; routes)</span> {
        routes.put(<span class="hljs-string">"download"</span>, ARouter$$Group$$download.class);
    }
}
</code></pre>
<p>å…¶loadInto()æ–¹æ³•å°†ARouter$$Group$$download.classå­˜å…¥routesä¸­ï¼Œroutesä¸ºMap&lt;String, Class&lt;? extends IRouteGroup&gt;&gt;ç±»å‹ï¼Œkeyä¸ºdownloadï¼Œrouteså°±æ˜¯ä¸Šé¢çš„Warehouse.groupsIndexã€‚Warehouseæ˜¯å­˜å‚¨è·¯ç”±ä¿¡æ¯çš„ä»“åº“ï¼Œå…¶ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Warehouse</span> {
    <span class="hljs-comment">//ç”¨äºç¼“å­˜å®ç°äº†IRouteGroupæ¥å£çš„ç±»ï¼Œkeyä¸ºpathçš„ç¬¬ä¸€çº§</span>
    <span class="hljs-keyword">static</span> Map&lt;String, Class&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">IRouteGroup</span>&gt;&gt; groupsIndex = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
    <span class="hljs-comment">//ç”¨äºç¼“å­˜è·¯ç”±å…ƒä¿¡æ¯ï¼Œkeyä¸ºpath</span>
    <span class="hljs-keyword">static</span> Map&lt;String, RouteMeta&gt; routes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();

    <span class="hljs-comment">//ç¼“å­˜å®ç°äº†IProvideræ¥å£çš„ç±»çš„å®ä¾‹ï¼Œkeyä¸ºIProviderå®ç°ç±»çš„class</span>
    <span class="hljs-keyword">static</span> Map&lt;Class, IProvider&gt; providers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
    <span class="hljs-comment">//ç¼“å­˜å®ç°äº†IProviderç±»çš„è·¯ç”±å…ƒä¿¡æ¯ï¼Œkeyä¸ºç»§æ‰¿äº†IProviderçš„æ¥å£çš„è·¯å¾„</span>
    <span class="hljs-keyword">static</span> Map&lt;String, RouteMeta&gt; providersIndex = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();

    <span class="hljs-comment">//ç¼“å­˜interceptor</span>
    <span class="hljs-keyword">static</span> Map&lt;Integer, Class&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">IInterceptor</span>&gt;&gt; interceptorsIndex = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UniqueKeyTreeMap</span>&lt;&gt;(<span class="hljs-string">"More than one interceptors use same priority [%s]"</span>);
    <span class="hljs-keyword">static</span> List&lt;IInterceptor&gt; interceptors = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();

    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span> {
        routes.clear();
        groupsIndex.clear();
        providers.clear();
        providersIndex.clear();
        interceptors.clear();
        interceptorsIndex.clear();
    }
}
</code></pre>
<p>è¿™æ ·å°±æŠŠARouter$$Group$$download.classå­˜å…¥äº†Warehouse.groupsIndexè¿™ä¸ªHashMapä¸­ï¼Œkeyä¸ºdownloadã€‚</p>
<p>æ¥ä¸‹æ¥åˆ†æè·³è½¬çš„ä»£ç ï¼Œè·³è½¬ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">ARouter.getInstance().build(path).navigation();
</code></pre>
<p>è·Ÿè¿›å»ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ARouter</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-keyword">static</span> <span class="hljs-type">ARouter</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">ARouter</span><span class="hljs-params">()</span> {
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ARouter <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (!hasInit) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InitException</span>(<span class="hljs-string">"ARouter::Init::Invoke init(context) first!"</span>);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">synchronized</span> (ARouter.class) {
                    <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {
                        instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ARouter</span>();
                    }
                }
            }
            <span class="hljs-keyword">return</span> instance;
        }
    }

    <span class="hljs-keyword">public</span> Postcard <span class="hljs-title function_">build</span><span class="hljs-params">(String path)</span> {
        <span class="hljs-keyword">return</span> _ARouter.getInstance().build(path);
    }

}
</code></pre>
<p>åœ¨getInstance()æ–¹æ³•ä¸­å…ˆåˆ¤æ–­hasInitæ˜¯å¦ä¸ºtrueï¼Œå¦‚æœä¸ºfalseæŠ›å‡ºå¼‚å¸¸ï¼Œæ¥ä¸‹æ¥ç”¨å•ä¾‹æ¨¡å¼åˆ›å»ºARouterå®ä¾‹ï¼Œbuild()æ–¹æ³•è°ƒç”¨äº†_ARouter.getInstance().build(path)ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">_ARouter</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">_ARouter</span><span class="hljs-params">()</span> {
    }

    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">static</span> _ARouter <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (!hasInit) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InitException</span>(<span class="hljs-string">"ARouterCore::Init::Invoke init(context) first!"</span>);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">synchronized</span> (_ARouter.class) {
                    <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {
                        instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">_ARouter</span>();
                    }
                }
            }
            <span class="hljs-keyword">return</span> instance;
        }
    }

    <span class="hljs-comment">/**
     * Build postcard by path and default group
     */</span>
    <span class="hljs-keyword">protected</span> Postcard <span class="hljs-title function_">build</span><span class="hljs-params">(String path)</span> {
        <span class="hljs-keyword">if</span> (TextUtils.isEmpty(path)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HandlerException</span>(Consts.TAG + <span class="hljs-string">"Parameter is invalid!"</span>);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-type">PathReplaceService</span> <span class="hljs-variable">pService</span> <span class="hljs-operator">=</span> ARouter.getInstance().navigation(PathReplaceService.class);
            <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> != pService) {
                <span class="hljs-comment">//æ›¿æ¢path</span>
                path = pService.forString(path);
            }
            <span class="hljs-keyword">return</span> build(path, extractGroup(path), <span class="hljs-literal">true</span>);
        }
    }

    <span class="hljs-comment">//ä»ä¼ å…¥çš„pathä¸­è§£æå‡ºgroup</span>
    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">extractGroup</span><span class="hljs-params">(String path)</span> {
        ...
        <span class="hljs-type">String</span> <span class="hljs-variable">defaultGroup</span> <span class="hljs-operator">=</span> path.substring(<span class="hljs-number">1</span>, path.indexOf(<span class="hljs-string">"/"</span>, <span class="hljs-number">1</span>));
        <span class="hljs-keyword">if</span> (TextUtils.isEmpty(defaultGroup)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HandlerException</span>(Consts.TAG + <span class="hljs-string">"Extract the default group failed! There's nothing between 2 '/'!"</span>);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> defaultGroup;
        }
        ...
    }

    <span class="hljs-comment">/**
     * Build postcard by path and group
     * é€šè¿‡pathå’Œgroupæ‹¿åˆ°Postcard
     */</span>
    <span class="hljs-keyword">protected</span> Postcard <span class="hljs-title function_">build</span><span class="hljs-params">(String path, String group, Boolean afterReplace)</span> {
        ...
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Postcard</span>(path, group);
    }

}
</code></pre>
<p>ç¬¬25è¡Œå…ˆåˆ¤æ–­ï¼Œå¦‚æœpathä¸ºç©ºæŠ›å‡ºå¼‚å¸¸ï¼Œå¦‚æœæƒ³æ›¿æ¢pathï¼Œå¯ä»¥å†™ä¸€ä¸ªç±»å®ç°PathReplaceServiceæ¥å£ã€‚æ¥ç€è°ƒç”¨ç¬¬33è¡Œçš„build()æ–¹æ³•ï¼Œè¿™é‡Œä»pathä¸­è§£æå‡ºgroupï¼Œæœ€åæ–°å»ºPostcardå®ä¾‹ï¼Œä¼ å…¥pathå’Œgroupã€‚Postcardä»åå­—ç¿»è¯‘è¿‡æ¥æ˜¯æ˜ä¿¡ç‰‡çš„æ„æ€ï¼Œå…¶æ‰¿è½½äº†ä¸€æ¬¡è·¯ç”±éœ€è¦çš„æ‰€æœ‰ä¿¡æ¯ï¼ŒPostcardä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * A container that contains the roadmap.
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Postcard</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">RouteMeta</span> {

    <span class="hljs-keyword">private</span> Uri uri;
    <span class="hljs-keyword">private</span> Bundle mBundle; <span class="hljs-comment">// Data to transform</span>

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Postcard</span><span class="hljs-params">()</span> {
        <span class="hljs-built_in">this</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Postcard</span><span class="hljs-params">(String path, String group)</span> {
        <span class="hljs-built_in">this</span>(path, group, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Postcard</span><span class="hljs-params">(String path, String group, Uri uri, Bundle bundle)</span> {
        setPath(path);
        setGroup(group);
        setUri(uri);
        <span class="hljs-built_in">this</span>.mBundle = (<span class="hljs-literal">null</span> == bundle ? <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bundle</span>() : bundle);
    }


    <span class="hljs-comment">/**
     * Navigation to the route with path in postcard.
     * No param, will be use application context.
     */</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">navigation</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> navigation(<span class="hljs-literal">null</span>);
    }

    <span class="hljs-comment">/**
     * Navigation to the route with path in postcard.
     *
     * <span class="hljs-doctag">@param</span> context Activity and so on.
     */</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">navigation</span><span class="hljs-params">(Context context)</span> {
        <span class="hljs-keyword">return</span> navigation(context, <span class="hljs-literal">null</span>);
    }

    <span class="hljs-comment">/**
     * Navigation to the route with path in postcard.
     *
     * <span class="hljs-doctag">@param</span> context Activity and so on.
     */</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">navigation</span><span class="hljs-params">(Context context, NavigationCallback callback)</span> {
        <span class="hljs-keyword">return</span> ARouter.getInstance().navigation(context, <span class="hljs-built_in">this</span>, -<span class="hljs-number">1</span>, callback);
    }
}
</code></pre>
<p>Postcardç»§æ‰¿è‡ªè·¯ç”±å…ƒä¿¡æ¯RouteMetaï¼Œä¼ å…¥pathå’Œgroupå®é™…è°ƒç”¨çš„æ˜¯RouteMetaçš„setPath()æ–¹æ³•å’ŒsetGroup()æ–¹æ³•ï¼Œå¯¹RouteMetaä¸­çš„pathå’Œgroupæˆå‘˜å˜é‡èµ‹å€¼ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
* It contains basic route information.
*/</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RouteMeta</span> {
    <span class="hljs-keyword">private</span> RouteType type; <span class="hljs-comment">// Type of route</span>
    <span class="hljs-keyword">private</span> Element rawType; <span class="hljs-comment">// Raw type of route</span>
    <span class="hljs-keyword">private</span> Class&lt;?&gt; destination; <span class="hljs-comment">// Destination</span>
    <span class="hljs-keyword">private</span> String path; <span class="hljs-comment">// Path of route</span>
    <span class="hljs-keyword">private</span> String group; <span class="hljs-comment">// Group of route</span>

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getPath</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> path;
    }

    <span class="hljs-keyword">public</span> RouteMeta <span class="hljs-title function_">setPath</span><span class="hljs-params">(String path)</span> {
        <span class="hljs-built_in">this</span>.path = path;
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getGroup</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> group;
    }

    <span class="hljs-keyword">public</span> RouteMeta <span class="hljs-title function_">setGroup</span><span class="hljs-params">(String group)</span> {
        <span class="hljs-built_in">this</span>.group = group;
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
    }
}
</code></pre>
<p>æ¥ä¸‹æ¥çœ‹çœ‹navigation()æ–¹æ³•åšäº†ä»€ä¹ˆï¼Ÿ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Postcard</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">RouteMeta</span> {

    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">navigation</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> navigation(<span class="hljs-literal">null</span>);
    }

    <span class="hljs-comment">/**
    * Navigation to the route with path in postcard.
    *
    * <span class="hljs-doctag">@param</span> context Activity and so on.
    */</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">navigation</span><span class="hljs-params">(Context context)</span> {
        <span class="hljs-keyword">return</span> navigation(context, <span class="hljs-literal">null</span>);
    }

    <span class="hljs-comment">/**
    * Navigation to the route with path in postcard.
    *
    * <span class="hljs-doctag">@param</span> context Activity and so on.
    */</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">navigation</span><span class="hljs-params">(Context context, NavigationCallback callback)</span> {
        <span class="hljs-keyword">return</span> ARouter.getInstance().navigation(context, <span class="hljs-built_in">this</span>, -<span class="hljs-number">1</span>, callback);
    }
} 
</code></pre>
<p>è°ƒç”¨äº†ARouterçš„navigation()æ–¹æ³•å¹¶ä¼ å…¥Postcardå®ä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ARouter</span> {

    <span class="hljs-comment">/**
    * Launch the navigation.
    */</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">navigation</span><span class="hljs-params">(Context mContext, Postcard postcard, <span class="hljs-type">int</span> requestCode, NavigationCallback callback)</span> {
        <span class="hljs-keyword">return</span> _ARouter.getInstance().navigation(mContext, postcard, requestCode, callback);
    }
}
</code></pre>
<p>è¿™é‡Œåˆè°ƒç”¨äº†_ARouterçš„navigation()æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">_ARouter</span> {
    <span class="hljs-comment">/**
     * Use router navigation.
     */</span>
    <span class="hljs-keyword">protected</span> Object <span class="hljs-title function_">navigation</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Context context, <span class="hljs-keyword">final</span> Postcard postcard, <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> requestCode, <span class="hljs-keyword">final</span> NavigationCallback callback)</span> {
        <span class="hljs-comment">//è‹¥æœ‰PretreatmentServiceçš„å®ç°ï¼Œå°±è¿›è¡Œé¢„å¤„ç†ï¼Œå¯ä»¥åœ¨çœŸæ­£è·¯ç”±å‰è¿›è¡Œä¸€äº›åˆ¤æ–­ç„¶åä¸­æ–­è·¯ç”±ã€‚</span>
        <span class="hljs-type">PretreatmentService</span> <span class="hljs-variable">pretreatmentService</span> <span class="hljs-operator">=</span> ARouter.getInstance().navigation(PretreatmentService.class);
        <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> != pretreatmentService &amp;&amp; !pretreatmentService.onPretreatment(context, postcard)) {
            <span class="hljs-comment">// Pretreatment failed, navigation canceled.</span>
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }

        <span class="hljs-comment">// Set context to postcard.</span>
        postcard.setContext(<span class="hljs-literal">null</span> == context ? mContext : context);

        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">//æ ‡è®°1ï¼Œé€šè¿‡routeMetaå®Œå–„postcard</span>
            LogisticsCenter.completion(postcard);
        } <span class="hljs-keyword">catch</span> (NoRouteFoundException ex) {
            logger.warning(Consts.TAG, ex.getMessage());

            <span class="hljs-comment">//æ²¡æœ‰æ‰¾åˆ°è·¯ç”±çš„å›è°ƒ</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> != callback) {
                callback.onLost(postcard);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// No callback for this invoke, then we use the global degrade service.</span>
                <span class="hljs-type">DegradeService</span> <span class="hljs-variable">degradeService</span> <span class="hljs-operator">=</span> ARouter.getInstance().navigation(DegradeService.class);
                <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> != degradeService) {
                    degradeService.onLost(context, postcard);
                }
            }

            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }

        <span class="hljs-comment">//æ‰¾åˆ°è·¯ç”±çš„å›è°ƒ</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> != callback) {
            callback.onFound(postcard);
        }

        <span class="hljs-comment">//ä¸æ˜¯ç»¿è‰²é€šé“ï¼Œè¦èµ°æ‹¦æˆªå™¨</span>
        <span class="hljs-keyword">if</span> (!postcard.isGreenChannel()) { <span class="hljs-comment">// It must be run in async thread, maybe interceptor cost too mush time made ANR.</span>
            interceptorService.doInterceptions(postcard, <span class="hljs-keyword">new</span> <span class="hljs-title class_">InterceptorCallback</span>() {
                <span class="hljs-comment">/**
                 * Continue process
                 *
                 * <span class="hljs-doctag">@param</span> postcard route meta
                 */</span>
                <span class="hljs-comment">//æ‹¦æˆªå™¨å¤„ç†ç»“æœï¼šç»§ç»­è·¯ç”±</span>
                <span class="hljs-meta">@Override</span>
                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onContinue</span><span class="hljs-params">(Postcard postcard)</span> {
                    _navigation(postcard, requestCode, callback);
                }

                <span class="hljs-comment">/**
                 * Interrupt process, pipeline will be destory when this method called.
                 *
                 * <span class="hljs-doctag">@param</span> exception Reson of interrupt.
                 */</span>
                <span class="hljs-comment">//æ‹¦æˆªå™¨å¤„ç†ç»“æœï¼šä¸­æ–­è·¯ç”±ï¼Œå›è°ƒä¸­æ–­</span>
                <span class="hljs-meta">@Override</span>
                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onInterrupt</span><span class="hljs-params">(Throwable exception)</span> {
                    <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> != callback) {
                        callback.onInterrupt(postcard);
                    }

                    logger.info(Consts.TAG, <span class="hljs-string">"Navigation failed, termination by interceptor : "</span> + exception.getMessage());
                }
            });
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">//æ ‡è®°2ï¼Œç»¿è‰²é€šé“ï¼Œä¸èµ°æ‹¦æˆªå™¨ï¼Œè·å–è·¯ç”±ç»“æœ</span>
            <span class="hljs-keyword">return</span> _navigation(postcard, requestCode, callback);
        }

        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
}
</code></pre>
<p>æˆ‘ä»¬å…ˆçœ‹çœ‹<strong>æ ‡è®°1</strong>å¤„ä»£ç åšäº†ä»€ä¹ˆï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LogisticsCenter</span> {

    <span class="hljs-comment">/**
     * Completion the postcard by route metas
     *
     * <span class="hljs-doctag">@param</span> postcard Incomplete postcard, should complete by this method.
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">completion</span><span class="hljs-params">(Postcard postcard)</span> {
        <span class="hljs-comment">//é€šè¿‡pathå»Warehouse.routesä¸­æ‹¿RouteMeta</span>
        <span class="hljs-type">RouteMeta</span> <span class="hljs-variable">routeMeta</span> <span class="hljs-operator">=</span> Warehouse.routes.get(postcard.getPath());
        <span class="hljs-comment">//å¦‚æœRouteMetaä¸ºç©º</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> == routeMeta) {
            <span class="hljs-comment">// Maybe its does't exist, or didn't load.</span>
            <span class="hljs-comment">//å¦‚æœWarehouse.groupsIndexä¸­æ²¡æœ‰è¿™ä¸ªgroupï¼ŒæŠ›å‡ºå¼‚å¸¸</span>
            <span class="hljs-keyword">if</span> (!Warehouse.groupsIndex.containsKey(postcard.getGroup())) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NoRouteFoundException</span>(TAG + <span class="hljs-string">"There is no route match the path ["</span> + postcard.getPath() + <span class="hljs-string">"], in group ["</span> + postcard.getGroup() + <span class="hljs-string">"]"</span>);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// Load route and cache it into memory, then delete from metas.</span>
                <span class="hljs-comment">//é‡æ–°è°ƒç”¨groupçš„loadInto()æ–¹æ³•</span>
                addRouteGroupDynamic(postcard.getGroup(), <span class="hljs-literal">null</span>);

                <span class="hljs-comment">//é‡æ–°æ‰§è¡Œcompletion()æ–¹æ³•</span>
                completion(postcard); <span class="hljs-comment">// Reload</span>
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">//æŠŠrouteMetaé‡Œé¢çš„é…ç½®ä¼ é€’ç»™postcard</span>
            postcard.setDestination(routeMeta.getDestination());
            postcard.setType(routeMeta.getType());
            postcard.setPriority(routeMeta.getPriority());
            postcard.setExtra(routeMeta.getExtra());

            <span class="hljs-type">Uri</span> <span class="hljs-variable">rawUri</span> <span class="hljs-operator">=</span> postcard.getUri();
            <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> != rawUri) { <span class="hljs-comment">// Try to set params into bundle.</span>
                Map&lt;String, String&gt; resultMap = TextUtils.splitQueryParameters(rawUri);
                Map&lt;String, Integer&gt; paramsType = routeMeta.getParamsType();

                <span class="hljs-keyword">if</span> (MapUtils.isNotEmpty(paramsType)) {
                    <span class="hljs-comment">// Set value by its type, just for params which annotation by @Param</span>
                    <span class="hljs-keyword">for</span> (Map.Entry&lt;String, Integer&gt; params : paramsType.entrySet()) {
                        setValue(postcard,
                                params.getValue(),
                                params.getKey(),
                                resultMap.get(params.getKey()));
                    }

                    <span class="hljs-comment">// Save params name which need auto inject.</span>
                    postcard.getExtras().putStringArray(ARouter.AUTO_INJECT, paramsType.keySet().toArray(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]{}));
                }

                <span class="hljs-comment">// Save raw uri</span>
                postcard.withString(ARouter.RAW_URI, rawUri.toString());
            }

            <span class="hljs-keyword">switch</span> (routeMeta.getType()) {
                <span class="hljs-comment">//å¦‚æœç±»å‹æ˜¯PROVIDER</span>
                <span class="hljs-keyword">case</span> PROVIDER: <span class="hljs-comment">// if the route is provider, should find its instance</span>
                    <span class="hljs-comment">// Its provider, so it must implement IProvider</span>
                    Class&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">IProvider</span>&gt; providerMeta = (Class&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">IProvider</span>&gt;) routeMeta.getDestination();
                    <span class="hljs-comment">//å»Warehouse.providersä¸­è·å–å®ä¾‹</span>
                    <span class="hljs-type">IProvider</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> Warehouse.providers.get(providerMeta);
                    <span class="hljs-comment">//å¦‚æœinstanceä¸ºnull</span>
                    <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> == instance) { <span class="hljs-comment">// There's no instance of this provider</span>
                        IProvider provider;
                        <span class="hljs-keyword">try</span> {
                            <span class="hljs-comment">//åå°„åˆ›å»ºå®ä¾‹</span>
                            provider = providerMeta.getConstructor().newInstance();
                            provider.init(mContext);
                            <span class="hljs-comment">//å­˜å…¥Warehouse.providers</span>
                            Warehouse.providers.put(providerMeta, provider);
                            instance = provider;
                        } <span class="hljs-keyword">catch</span> (Exception e) {
                            logger.error(TAG, <span class="hljs-string">"Init provider failed!"</span>, e);
                            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HandlerException</span>(<span class="hljs-string">"Init provider failed!"</span>);
                        }
                    }
                    <span class="hljs-comment">//ä¼ é€’ç»™postcard</span>
                    postcard.setProvider(instance);
                    <span class="hljs-comment">// è®¾ç½®greenChannelä¸ºtrueï¼Œè·³è¿‡æ‰€æœ‰çš„æ‹¦æˆªå™¨</span>
                    postcard.greenChannel(); <span class="hljs-comment">// Provider should skip all of interceptors</span>
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> FRAGMENT:
                    postcard.greenChannel(); <span class="hljs-comment">// Fragment needn't interceptors</span>
                <span class="hljs-keyword">default</span>:
                    <span class="hljs-keyword">break</span>;
            }
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addRouteGroupDynamic</span><span class="hljs-params">(String groupName, IRouteGroup group)</span> <span class="hljs-keyword">throws</span> NoSuchMethodException, IllegalAccessException, InvocationTargetException, InstantiationException {
        <span class="hljs-keyword">if</span> (Warehouse.groupsIndex.containsKey(groupName)) {
            <span class="hljs-comment">// If this group is included, but it has not been loaded</span>
            <span class="hljs-comment">// load this group first, because dynamic route has high priority.</span>
            <span class="hljs-comment">//è°ƒç”¨å®ä¾‹çš„loadInto()æ–¹æ³•æ·»åŠ åˆ°Warehouse.routes </span>
            Warehouse.groupsIndex.get(groupName).getConstructor().newInstance().loadInto(Warehouse.routes);
            <span class="hljs-comment">//ä»Warehouse.groupsIndexä¸­ç§»é™¤keyä¸ºgroupNameçš„æ•°æ®</span>
            Warehouse.groupsIndex.remove(groupName);
        }

        <span class="hljs-comment">// cover old group.</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> != group) {
            group.loadInto(Warehouse.routes);
        }
    }
}
</code></pre>
<p>ä¸Šé¢çš„completion()æ–¹æ³•å…ˆå»Warehouse.routesä¸­æ‹¿RouteMetaï¼ŒWarehouseå°±æ˜¯å‰é¢å­˜å‚¨è·¯ç”±ä¿¡æ¯çš„ä»“åº“ï¼ŒWarehouse.routesæ˜¯å…¶ä¸­ç¼“å­˜è·¯ç”±å…ƒä¿¡æ¯çš„HashMapã€‚åˆ¤æ–­å¦‚æœRouteMetaä¸ºnullï¼Œè°ƒç”¨addRouteGroupDynamic()æ–¹æ³•ï¼Œå»Warehouse.groupsIndexä¸­å–å‡ºç¼“å­˜çš„ç±»ï¼Œä½¿ç”¨åå°„åˆ›å»ºè¯¥ç±»çš„å®ä¾‹ï¼Œç„¶åè°ƒç”¨å…¶loadInto()æ–¹æ³•ï¼Œè¿™æ ·å°±è°ƒç”¨äº†ARouter$$Group$$download.classçš„loadInto()æ–¹æ³•ï¼Œå…¶ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ARouter$$Group$$download</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IRouteGroup</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loadInto</span><span class="hljs-params">(Map&lt;String, RouteMeta&gt; atlas)</span> {
        atlas.put(<span class="hljs-string">"/download/DownloadActivity"</span>, RouteMeta.build(RouteType.ACTIVITY, DownloadActivity.class, <span class="hljs-string">"/download/downloadactivity"</span>, <span class="hljs-string">"download"</span>, <span class="hljs-literal">null</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">2147483648</span>));
        atlas.put(<span class="hljs-string">"/download/service"</span>, RouteMeta.build(RouteType.PROVIDER, DownloadServiceImpl.class, <span class="hljs-string">"/download/service"</span>, <span class="hljs-string">"download"</span>, <span class="hljs-literal">null</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">2147483648</span>));
    }
}
</code></pre>
<p>å…¶loadInto()æ–¹æ³•æŠŠRouteMetaé€šè¿‡build()æ–¹æ³•åˆ›å»ºçš„å®ä¾‹æ·»åŠ åˆ°Warehouse.routesä¸­ã€‚</p>
<p>å›åˆ°å‰é¢çš„ä»£ç ï¼Œæ¥ç€åˆè°ƒç”¨äº†ä¸€æ¬¡completion()æ–¹æ³•ï¼Œæ­¤æ—¶routeMetaä¸å†ä¸ºnullï¼Œå°†routeMetaçš„é…ç½®ä¿¡æ¯ï¼ˆdestinationã€typeç­‰ä¿¡æ¯ï¼‰ä¼ é€’ç»™postcardï¼Œå¦‚æœrouteMetaç±»å‹æ˜¯PROVIDERï¼Œä¼šåå°„åˆ›å»ºå®ä¾‹å¹¶å­˜å…¥Warehouse.providersã€‚ç„¶ååˆ¤æ–­æ˜¯å¦æ˜¯ç»¿è‰²é€šé“ï¼Œå¦‚æœä¸æ˜¯ç»¿è‰²é€šé“ï¼Œéœ€è¦æ‰§è¡Œæ‹¦æˆªå™¨ã€‚å¦‚æœæ˜¯ç»¿è‰²é€šé“ä¼šæ‰§è¡Œæ ‡è®°2å¤„çš„ä»£ç å¼€å§‹å‡†å¤‡è·³è½¬ï¼Œæ ‡è®°2å¤„ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> Object <span class="hljs-title function_">_navigation</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Postcard postcard, <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> requestCode, <span class="hljs-keyword">final</span> NavigationCallback callback)</span> {
    <span class="hljs-keyword">final</span> <span class="hljs-type">Context</span> <span class="hljs-variable">currentContext</span> <span class="hljs-operator">=</span> postcard.getContext();

    <span class="hljs-keyword">switch</span> (postcard.getType()) {
        <span class="hljs-keyword">case</span> ACTIVITY:
            <span class="hljs-comment">// Build intent</span>
            <span class="hljs-keyword">final</span> <span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(currentContext, postcard.getDestination());
            intent.putExtras(postcard.getExtras());

            <span class="hljs-comment">// Set flags.</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">flags</span> <span class="hljs-operator">=</span> postcard.getFlags();
            <span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> != flags) {
                intent.setFlags(flags);
            }

            <span class="hljs-comment">// Non activity, need FLAG_ACTIVITY_NEW_TASK</span>
            <span class="hljs-keyword">if</span> (!(currentContext <span class="hljs-keyword">instanceof</span> Activity)) {
                intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
            }

            <span class="hljs-comment">// Set Actions</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">action</span> <span class="hljs-operator">=</span> postcard.getAction();
            <span class="hljs-keyword">if</span> (!TextUtils.isEmpty(action)) {
                intent.setAction(action);
            }

            <span class="hljs-comment">// Navigation in main looper.</span>
            runInMainThread(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() {
                <span class="hljs-meta">@Override</span>
                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
                    startActivity(requestCode, currentContext, intent, postcard, callback);
                }
            });

            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> PROVIDER:
            <span class="hljs-keyword">return</span> postcard.getProvider();
        <span class="hljs-keyword">case</span> BOARDCAST:
        <span class="hljs-keyword">case</span> CONTENT_PROVIDER:
        <span class="hljs-keyword">case</span> FRAGMENT:
            <span class="hljs-comment">//Broadcastã€ContentProviderã€Fragmentï¼Œéƒ½æ˜¯ä½¿ç”¨postcard.getDestination()åå°„åˆ›å»ºå®ä¾‹</span>
            Class&lt;?&gt; fragmentMeta = postcard.getDestination();
            <span class="hljs-keyword">try</span> {
                <span class="hljs-type">Object</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> fragmentMeta.getConstructor().newInstance();
                <span class="hljs-keyword">if</span> (instance <span class="hljs-keyword">instanceof</span> Fragment) {
                    ((Fragment) instance).setArguments(postcard.getExtras());
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (instance <span class="hljs-keyword">instanceof</span> android.support.v4.app.Fragment) {
                    ((android.support.v4.app.Fragment) instance).setArguments(postcard.getExtras());
                }

                <span class="hljs-keyword">return</span> instance;
            } <span class="hljs-keyword">catch</span> (Exception ex) {
                logger.error(Consts.TAG, <span class="hljs-string">"Fetch fragment instance error, "</span> + TextUtils.formatStackTrace(ex.getStackTrace()));
            }
        <span class="hljs-keyword">case</span> METHOD:
        <span class="hljs-keyword">case</span> SERVICE:
        <span class="hljs-keyword">default</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
</code></pre>
<p>åœ¨è¿™é‡Œå…ˆåˆ¤æ–­postcardçš„RouteTypeï¼ŒRouteTypeæ˜¯ä¸€ä¸ªæšä¸¾ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">RouteType</span> {
    ACTIVITY(<span class="hljs-number">0</span>, <span class="hljs-string">"android.app.Activity"</span>),
    SERVICE(<span class="hljs-number">1</span>, <span class="hljs-string">"android.app.Service"</span>),
    PROVIDER(<span class="hljs-number">2</span>, <span class="hljs-string">"com.alibaba.android.arouter.facade.template.IProvider"</span>),
    CONTENT_PROVIDER(-<span class="hljs-number">1</span>, <span class="hljs-string">"android.app.ContentProvider"</span>),
    BOARDCAST(-<span class="hljs-number">1</span>, <span class="hljs-string">""</span>),
    METHOD(-<span class="hljs-number">1</span>, <span class="hljs-string">""</span>),
    FRAGMENT(-<span class="hljs-number">1</span>, <span class="hljs-string">"android.app.Fragment"</span>),
    UNKNOWN(-<span class="hljs-number">1</span>, <span class="hljs-string">"Unknown route type"</span>);
    ...
}    
</code></pre>
<p>å¦‚æœæ˜¯Activityï¼Œå°±æŠŠpostcardé‡Œé¢çš„å‚æ•°ä¼ é€’ç»™Intentï¼Œæœ€ç»ˆè°ƒç”¨startActivity()æ–¹æ³•è¿›è¡Œè·³è½¬ï¼›å¦‚æœæ˜¯Providerï¼Œç›´æ¥é€šè¿‡postcard.getProvider()æ‹¿åˆ°IProvierçš„å®ç°ç±»çš„å•ä¾‹ï¼›Broadcastã€ContentProviderã€Fragmentéƒ½æ˜¯ä½¿ç”¨postcard.getDestination()åå°„åˆ›å»ºå®ä¾‹å¹¶è¿”å›ã€‚</p>
<p><strong>å‚è€ƒèµ„æ–™ï¼š</strong>
<a href="https://juejin.cn/post/7200041752470749243" target="_blank" title="https://juejin.cn/post/7200041752470749243">juejin.cn/post/720004â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI æ—¶ä»£çš„â€œé»‘ç®±é—®é¢˜â€ï¼šç†è§£ä¸ä¿¡ä»»çš„è¾¹ç•Œ]]></title>    <link>https://juejin.cn/post/7598024433912135734</link>    <guid>https://juejin.cn/post/7598024433912135734</guid>    <pubDate>2026-01-23T02:40:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598024433912135734" data-draft-id="7598112768146882566" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI æ—¶ä»£çš„â€œé»‘ç®±é—®é¢˜â€ï¼šç†è§£ä¸ä¿¡ä»»çš„è¾¹ç•Œ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,å‰ç«¯æ¡†æ¶,AIGC"/> <meta itemprop="datePublished" content="2026-01-23T02:40:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI æ—¶ä»£çš„â€œé»‘ç®±é—®é¢˜â€ï¼šç†è§£ä¸ä¿¡ä»»çš„è¾¹ç•Œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T02:40:38.000Z" title="Fri Jan 23 2026 02:40:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{font-size:24px;display:inline-block;font-weight:700;background:#ef7060;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(239,112,96,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 50px);border-bottom:3px solid #ef7060}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #3e3e3e;margin-top:32px;margin-bottom:32px;height:1px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(27,31,35,.05);color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:JetBranins Mono,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px;background-color:#fdfdfd}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fdfdfd}.markdown-body a{text-decoration:none;font-weight:700;color:#ef7060;border-bottom:1px solid #ef7060}.markdown-body a:active,.markdown-body a:hover{color:#ef2d26}.markdown-body table tr td,.markdown-body table tr th{border:1px solid #ccc;padding:5px 10px}.markdown-body table{display:block!important;width:auto;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{background:#f0f0f0;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f8f8f8}.markdown-body blockquote{margin-inline-start:0;margin-inline-end:0;border-left:3px solid #ef7060;background:#fff9f9;padding:1px 20px;margin-top:20px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h4 data-id="heading-0">å¼•è¨€</h4>
<p>éšç€äººå·¥æ™ºèƒ½ï¼ˆAIï¼‰åœ¨å„ä¸ªè¡Œä¸šçš„å¹¿æ³›åº”ç”¨ï¼ŒAIæ¨¡å‹åœ¨å†³ç­–æ”¯æŒã€è‡ªåŠ¨åŒ–ä»¥åŠé¢„æµ‹åˆ†æç­‰æ–¹é¢å±•ç°äº†å·¨å¤§çš„æ½œåŠ›ã€‚ç„¶è€Œï¼Œéšç€AIæŠ€æœ¯çš„å¤æ‚æ€§ä¸æ–­æé«˜ï¼Œå°¤å…¶æ˜¯æ·±åº¦å­¦ä¹ ç­‰é«˜çº§ç®—æ³•çš„å‡ºç°ï¼Œâ€œé»‘ç®±é—®é¢˜â€ä¹Ÿæ—¥ç›Šçªå‡ºã€‚é»‘ç®±é—®é¢˜æŒ‡çš„æ˜¯å³ä½¿AIç³»ç»Ÿèƒ½å¤Ÿåšå‡ºå‡†ç¡®çš„é¢„æµ‹å’Œå†³ç­–ï¼Œæˆ‘ä»¬å´æ— æ³•å®Œå…¨ç†è§£å…¶å†…éƒ¨çš„å†³ç­–è¿‡ç¨‹ã€‚è¿™ç§ç¼ºä¹é€æ˜åº¦çš„ç‰¹æ€§ï¼Œç»™AIçš„åº”ç”¨å¸¦æ¥äº†ä¿¡ä»»å’Œè´£ä»»çš„æŒ‘æˆ˜ã€‚åœ¨åŒ»ç–—ã€é‡‘èã€æ³•å¾‹ç­‰å¯¹å†³ç­–æœ‰ä¸¥æ ¼è¦æ±‚çš„é¢†åŸŸï¼Œè¿™ä¸ªé—®é¢˜å°¤ä¸ºé‡è¦ã€‚æœ¬æ–‡å°†æ¢è®¨AIé»‘ç®±é—®é¢˜çš„æˆå› ã€è§£å†³æ–¹æ¡ˆï¼Œä»¥åŠå¦‚ä½•åœ¨AIæ—¶ä»£æ‰¾åˆ°ç†è§£ä¸ä¿¡ä»»çš„å¹³è¡¡ã€‚</p>
<h4 data-id="heading-1">1. é»‘ç®±é—®é¢˜çš„å®šä¹‰ä¸èƒŒæ™¯</h4>
<p>â€œé»‘ç®±â€æ˜¯æŒ‡è¾“å…¥ä¿¡æ¯è¿›å…¥ä¸€ä¸ªç³»ç»Ÿåï¼Œç³»ç»Ÿäº§ç”Ÿè¾“å‡ºï¼Œä½†æˆ‘ä»¬æ— æ³•çª¥è§å…¶å†…éƒ¨è¿‡ç¨‹çš„çŠ¶æ€æˆ–æœºåˆ¶ã€‚å¯¹äºä¼ ç»Ÿçš„ç®—æ³•å’Œæ¨¡å‹ï¼Œäººä»¬å¯ä»¥ç›´æ¥ç†è§£æ¯ä¸€æ­¥çš„æ“ä½œè¿‡ç¨‹ï¼Œè€Œæ·±åº¦ç¥ç»ç½‘ç»œç­‰å¤æ‚AIæ¨¡å‹å´æ˜¯é«˜åº¦éçº¿æ€§çš„ï¼Œç”šè‡³æ˜¯æ•°ç™¾ä¸‡ä¸ªå‚æ•°çš„é›†åˆã€‚è¿™ç§é«˜åº¦å¤æ‚æ€§ä½¿å¾—å…¶è¡Œä¸ºå˜å¾—ä¸å¯é¢„æµ‹ï¼Œå°¤å…¶æ˜¯åœ¨é‡åˆ°æ–°æƒ…å†µæ—¶ã€‚</p>
<p>é»‘ç®±é—®é¢˜ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li><strong>ç¼ºä¹é€æ˜æ€§</strong>ï¼šAIæ¨¡å‹çš„å†³ç­–è¿‡ç¨‹éš¾ä»¥è§£é‡Šï¼Œæ™®é€šç”¨æˆ·å¾ˆéš¾ç†è§£ç®—æ³•æ˜¯å¦‚ä½•å¾—å‡ºæŸä¸ªç»“è®ºçš„ã€‚</li>
<li><strong>ä¸å¯æ§æ€§</strong>ï¼šAIç³»ç»Ÿå¯èƒ½å› ä¸ºè®­ç»ƒæ•°æ®çš„åå·®æˆ–ç®—æ³•è®¾è®¡çš„ç¼ºé™·ï¼Œåšå‡ºä¸å¯é¢„çŸ¥æˆ–ä¸å…¬å¹³çš„å†³ç­–ã€‚</li>
<li><strong>ä¿¡ä»»å±æœº</strong>ï¼šæ²¡æœ‰æ¸…æ™°çš„å†³ç­–è·¯å¾„ï¼Œç”¨æˆ·å’Œå¼€å‘è€…å¾ˆéš¾å»ºç«‹å¯¹AIæ¨¡å‹çš„ä¿¡ä»»ï¼Œå°¤å…¶æ˜¯åœ¨å…³é”®é¢†åŸŸï¼Œå¦‚é‡‘èé£æ§å’ŒåŒ»ç–—è¯Šæ–­ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼Œåœ¨åŒ»ç–—è¯Šæ–­ä¸­ï¼ŒAIæ¨¡å‹å¯èƒ½ç»™å‡ºä¸€ä¸ªç™Œç—‡è¯Šæ–­çš„ç»“æœï¼Œä½†åŒ»ç”Ÿæˆ–æ‚£è€…æ— æ³•ç†è§£æ¨¡å‹æ˜¯åŸºäºå“ªäº›æ•°æ®ç‰¹å¾å¾—å‡ºçš„ç»“è®ºã€‚è¿™ç§â€œé»‘ç®±â€ç‰¹æ€§å¯èƒ½å¯¼è‡´å¯¹AIåˆ¤æ–­çš„è´¨ç–‘ï¼Œå°¤å…¶åœ¨æ²¡æœ‰è§£é‡Šçš„æƒ…å†µä¸‹ï¼Œäººä»¬æ›´å€¾å‘äºè´¨ç–‘å…¶æ­£ç¡®æ€§ã€‚</p>
<h4 data-id="heading-2">2. è§£å†³æ–¹æ¡ˆä¸æŠ€æœ¯å®ç°</h4>
<p>ä¸ºäº†åº”å¯¹AIé»‘ç®±é—®é¢˜ï¼Œç ”ç©¶è€…å’Œå·¥ç¨‹å¸ˆä»¬æå‡ºäº†å¤šä¸ªå¯è¡Œçš„è§£å†³æ–¹æ¡ˆï¼Œç›®çš„æ˜¯æé«˜æ¨¡å‹çš„å¯è§£é‡Šæ€§å’Œé€æ˜åº¦ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä¸»æµæ–¹æ³•ï¼š</p>
<h5 data-id="heading-3">2.1 è§£é‡Šæ€§AIï¼ˆExplainable AI, XAIï¼‰</h5>
<p>è§£é‡Šæ€§AIæ—¨åœ¨æ„å»ºå…·æœ‰å¯è§£é‡Šæ€§çš„æ¨¡å‹ï¼Œä½¿å¾—äººç±»èƒ½å¤Ÿç†è§£AIåšå‡ºæŸä¸ªå†³ç­–çš„åŸå› ã€‚ä»¥ä¸‹æ˜¯å‡ ç§å¸¸è§çš„è§£é‡Šæ€§AIæ–¹æ³•ï¼š</p>
<ul>
<li>
<p><strong>LIMEï¼ˆLocal Interpretable Model-agnostic Explanationsï¼‰</strong> ï¼š<br/>
LIMEé€šè¿‡å¯¹åŸå§‹å¤æ‚æ¨¡å‹è¿›è¡Œå±€éƒ¨è¿‘ä¼¼å»ºæ¨¡æ¥è§£é‡Šå…¶å†³ç­–ã€‚å®ƒé€šè¿‡è®­ç»ƒä¸€ä¸ªç®€å•çš„ã€é€æ˜çš„æ¨¡å‹ï¼ˆå¦‚çº¿æ€§å›å½’æˆ–å†³ç­–æ ‘ï¼‰æ¥è¿‘ä¼¼å¤æ‚æ¨¡å‹åœ¨ç‰¹å®šè¾“å…¥ä¸Šçš„è¡¨ç°ï¼Œä»è€Œä¸ºå…¶å†³ç­–æä¾›è§£é‡Šã€‚</p>
<p>ç¤ºä¾‹ä»£ç ï¼ˆPythonï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">from lime.lime_tabular import LimeTabularExplainer
<span class="hljs-attr">explainer</span> = LimeTabularExplainer(X_train, training_labels=y_train, mode=<span class="hljs-string">'classification'</span>)
<span class="hljs-attr">explanation</span> = explainer.explain_instance(X_test[<span class="hljs-number">0</span>], model.predict_proba)
explanation.show_in_notebook()
</code></pre>
</li>
<li>
<p><strong>SHAPï¼ˆSHapley Additive exPlanationsï¼‰</strong> ï¼š<br/>
SHAPå€¼åŸºäºåšå¼ˆè®ºä¸­çš„æ²™æ™®åˆ©å€¼ï¼ˆShapley Valueï¼‰æ¥è§£é‡Šæ¨¡å‹çš„è¾“å‡ºã€‚æ¯ä¸ªç‰¹å¾çš„SHAPå€¼å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç†è§£è¯¥ç‰¹å¾åœ¨é¢„æµ‹ä¸­èµ·åˆ°çš„ä½œç”¨ã€‚</p>
<p>ç¤ºä¾‹ä»£ç ï¼ˆPythonï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">import shap
<span class="hljs-attr">explainer</span> = shap.TreeExplainer(model)
<span class="hljs-attr">shap_values</span> = explainer.shap_values(X_test)
shap.summary_plot(shap_values, X_test)
</code></pre>
</li>
</ul>
<h5 data-id="heading-4">2.2 å¯è§£é‡Šæ¨¡å‹çš„è®¾è®¡</h5>
<p>ä¸å¤æ‚çš„é»‘ç®±æ¨¡å‹ç›¸æ¯”ï¼ŒæŸäº›æ¨¡å‹å¤©ç”Ÿæ›´å…·å¯è§£é‡Šæ€§ã€‚ä¾‹å¦‚ï¼Œå†³ç­–æ ‘ã€çº¿æ€§å›å½’å’Œé€»è¾‘å›å½’ç­‰æ¨¡å‹é€šå¸¸å¯ä»¥æä¾›ç›´è§‚çš„ç‰¹å¾æƒé‡å’Œå†³ç­–è·¯å¾„ã€‚å› æ­¤ï¼Œåœ¨ä¸€äº›åœºæ™¯ä¸‹ï¼Œé€‰æ‹©å¯è§£é‡Šæ€§æ›´å¼ºçš„æ¨¡å‹å¯èƒ½æ˜¯è§£å†³é»‘ç®±é—®é¢˜çš„æœ‰æ•ˆé€”å¾„ã€‚</p>
<h5 data-id="heading-5">2.3 é€æ˜çš„æ¨¡å‹è®­ç»ƒè¿‡ç¨‹</h5>
<p>å¦ä¸€ç§è§£å†³é»‘ç®±é—®é¢˜çš„æ–¹æ³•æ˜¯é€šè¿‡å¢å¼ºæ¨¡å‹è®­ç»ƒè¿‡ç¨‹çš„é€æ˜åº¦ã€‚ä¾‹å¦‚ï¼Œé‡‡ç”¨å…¬å¹³æ€§å’Œé€æ˜åº¦ç®—æ³•ï¼Œè®°å½•æ¨¡å‹è®­ç»ƒä¸­çš„æ¯ä¸€ä¸ªæ­¥éª¤ï¼Œå¹¶å¯¹è®­ç»ƒæ•°æ®å’Œç»“æœè¿›è¡Œå…¬å¼€æŠ«éœ²ã€‚è¿™ç§æ–¹æ³•ä¸ä»…èƒ½æé«˜æ¨¡å‹çš„å¯è§£é‡Šæ€§ï¼Œä¹Ÿèƒ½å¢å¼ºæ¨¡å‹çš„ç¤¾ä¼šä¿¡ä»»ã€‚</p>
<h5 data-id="heading-6">2.4 åå¤„ç†å’Œå¯è§†åŒ–å·¥å…·</h5>
<p>ä¸€äº›å¯è§†åŒ–å·¥å…·ï¼ˆå¦‚TensorBoardã€FeatureVizï¼‰å¯ä»¥å¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°ç†è§£AIæ¨¡å‹çš„è¡Œä¸ºã€‚è¿™äº›å·¥å…·é€šè¿‡å¯è§†åŒ–é«˜ç»´æ•°æ®ï¼Œå¸®åŠ©äººä»¬çœ‹åˆ°ä¸åŒç‰¹å¾å¦‚ä½•å½±å“æ¨¡å‹çš„å†³ç­–ã€‚</p>
<h4 data-id="heading-7">3. ä¼˜ç¼ºç‚¹åˆ†æåŠå®é™…åº”ç”¨å»ºè®®</h4>
<h5 data-id="heading-8">3.1 ä¼˜ç‚¹</h5>
<ul>
<li><strong>å¢å¼ºä¿¡ä»»</strong>ï¼šé€šè¿‡å¢åŠ æ¨¡å‹çš„å¯è§£é‡Šæ€§ï¼Œå¯ä»¥ä½¿å¾—ç”¨æˆ·æ›´åŠ ä¿¡ä»»AIç³»ç»Ÿï¼Œç‰¹åˆ«æ˜¯åœ¨æ¶‰åŠæ³•å¾‹è´£ä»»å’Œä¼¦ç†é—®é¢˜çš„é¢†åŸŸã€‚</li>
<li><strong>é—®é¢˜è¯Šæ–­</strong>ï¼šè§£é‡Šæ€§AIå¯ä»¥å¸®åŠ©å¼€å‘è€…ç†è§£æ¨¡å‹çš„å±€é™æ€§å’Œæ½œåœ¨çš„é”™è¯¯ï¼Œä»è€Œåœ¨å‡ºç°é—®é¢˜æ—¶å¯ä»¥å¿«é€Ÿè°ƒæ•´æ¨¡å‹ã€‚</li>
<li><strong>åˆè§„æ€§</strong>ï¼šåœ¨ä¸€äº›è¡Œä¸šä¸­ï¼Œå¦‚é‡‘èå’ŒåŒ»ç–—ï¼Œæä¾›æ¨¡å‹å†³ç­–çš„å¯è§£é‡Šæ€§æ˜¯ç¬¦åˆè¡Œä¸šè§„å®šçš„ã€‚</li>
</ul>
<h5 data-id="heading-9">3.2 ç¼ºç‚¹</h5>
<ul>
<li><strong>è®¡ç®—å¼€é”€</strong>ï¼šä¸€äº›å¯è§£é‡ŠAIæ–¹æ³•ï¼Œå¦‚LIMEå’ŒSHAPï¼Œå¯èƒ½éœ€è¦é¢å¤–çš„è®¡ç®—èµ„æºï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤§å‹æ•°æ®é›†æ—¶ã€‚</li>
<li><strong>å‡†ç¡®æ€§ vs. å¯è§£é‡Šæ€§</strong>ï¼šæŸäº›é«˜å¯è§£é‡Šæ€§æ¨¡å‹ï¼ˆå¦‚å†³ç­–æ ‘ï¼‰åœ¨å‡†ç¡®æ€§ä¸Šå¯èƒ½ä¸å¦‚æ·±åº¦å­¦ä¹ æ¨¡å‹ã€‚å› æ­¤ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯èƒ½éœ€è¦åœ¨å‡†ç¡®æ€§å’Œå¯è§£é‡Šæ€§ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ã€‚</li>
<li><strong>é™åˆ¶æ€§</strong>ï¼šå¯¹äºæŸäº›å¤æ‚çš„AIæ¨¡å‹ï¼ˆå°¤å…¶æ˜¯æ·±åº¦ç¥ç»ç½‘ç»œï¼‰ï¼Œå³ä½¿é‡‡ç”¨å¯è§£é‡Šæ€§æŠ€æœ¯ï¼Œè§£é‡Šçš„æ·±åº¦å’Œç»†è‡´ç¨‹åº¦ä¹Ÿå¯èƒ½æœ‰é™ã€‚</li>
</ul>
<h5 data-id="heading-10">å®é™…åº”ç”¨å»ºè®®ï¼š</h5>
<ul>
<li>åœ¨å¯¹å¯è§£é‡Šæ€§è¦æ±‚è¾ƒé«˜çš„é¢†åŸŸï¼ˆå¦‚åŒ»ç–—ã€é‡‘èã€æ³•å¾‹ï¼‰ä¸­ï¼Œä¼˜å…ˆè€ƒè™‘ä½¿ç”¨å…·æœ‰è‰¯å¥½å¯è§£é‡Šæ€§çš„æ¨¡å‹ï¼Œæˆ–è€…ç»“åˆé»‘ç®±æ¨¡å‹ä¸è§£é‡Šæ€§æ–¹æ³•ã€‚</li>
<li>å¯¹äºå¤§è§„æ¨¡çš„AIåº”ç”¨ï¼Œå»ºè®®å®šæœŸå®¡è®¡æ¨¡å‹çš„å†³ç­–è¿‡ç¨‹ï¼Œå¹¶ç»“åˆé€æ˜çš„è®­ç»ƒè¿‡ç¨‹ï¼Œç¡®ä¿AIç³»ç»Ÿåœ¨å®é™…åº”ç”¨ä¸­çš„å…¬å¹³æ€§å’Œå¯é æ€§ã€‚</li>
</ul>
<h4 data-id="heading-11">4. ç»“è®º</h4>
<p>AIçš„â€œé»‘ç®±é—®é¢˜â€æ˜¯å½“å‰AIæŠ€æœ¯å‘å±•çš„ä¸€ä¸ªé‡å¤§æŒ‘æˆ˜ã€‚å°½ç®¡æ·±åº¦å­¦ä¹ ç­‰å¤æ‚ç®—æ³•åœ¨è®¸å¤šä»»åŠ¡ä¸­è¡¨ç°å“è¶Šï¼Œä½†å®ƒä»¬çš„é»‘ç®±ç‰¹æ€§é™åˆ¶äº†äººä»¬å¯¹å…¶ç»“æœçš„ç†è§£ä¸ä¿¡ä»»ã€‚é€šè¿‡å‘å±•è§£é‡Šæ€§AIã€é€‰æ‹©å¯è§£é‡Šçš„æ¨¡å‹ä»¥åŠæå‡è®­ç»ƒè¿‡ç¨‹çš„é€æ˜åº¦ï¼ŒAIçš„é»‘ç®±é—®é¢˜å¯ä»¥å¾—åˆ°ä¸€å®šç¨‹åº¦çš„è§£å†³ã€‚ç„¶è€Œï¼Œå¦‚ä½•åœ¨å‡†ç¡®æ€§å’Œå¯è§£é‡Šæ€§ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ï¼Œä»ç„¶æ˜¯æœªæ¥æŠ€æœ¯å‘å±•çš„å…³é”®ã€‚</p>
<p>éšç€æŠ€æœ¯çš„ä¸æ–­è¿›æ­¥ï¼Œæˆ‘ä»¬æœ‰ç†ç”±ç›¸ä¿¡ï¼ŒAIçš„é€æ˜æ€§å’Œå¯è§£é‡Šæ€§å°†é€æ­¥æå‡ï¼Œä»è€Œä¸ºå„è¡Œå„ä¸šå¸¦æ¥æ›´å¤šçš„ä¿¡ä»»å’Œä»·å€¼ã€‚</p>
<h4 data-id="heading-12">5. é™„å½•ä¸å‚è€ƒèµ„æ–™</h4>
<ul>
<li>
<p><strong>ç›¸å…³ä¹¦ç±</strong>ï¼š</p>
<ul>
<li>ã€Šæ·±åº¦å­¦ä¹ ã€‹- Ian Goodfellow, Yoshua Bengio, Aaron Courville</li>
<li>ã€Šå¯è§£é‡Šçš„äººå·¥æ™ºèƒ½ã€‹- Christoph Molnar</li>
</ul>
</li>
<li>
<p><strong>ç›¸å…³è®ºæ–‡</strong>ï¼š</p>
<ul>
<li>Ribeiro, M. T., Singh, S., &amp; Guestrin, C. (2016). â€œWhy should I trust you?â€ Explaining the predictions of any classifier.</li>
<li>Lundberg, S. M., &amp; Lee, S. I. (2017). A unified approach to interpreting model predictions.</li>
</ul>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Rust æ‰€æœ‰æƒæ€»ç»“ï¼ˆBy Geminiï¼‰]]></title>    <link>https://juejin.cn/post/7598083101361242118</link>    <guid>https://juejin.cn/post/7598083101361242118</guid>    <pubDate>2026-01-23T02:45:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598083101361242118" data-draft-id="7598029481508798483" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Rust æ‰€æœ‰æƒæ€»ç»“ï¼ˆBy Geminiï¼‰"/> <meta itemprop="keywords" content="Rust,Gemini,æ“ä½œç³»ç»Ÿ"/> <meta itemprop="datePublished" content="2026-01-23T02:45:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="mCell"/> <meta itemprop="url" content="https://juejin.cn/user/2280829967146779"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Rust æ‰€æœ‰æƒæ€»ç»“ï¼ˆBy Geminiï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2280829967146779/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    mCell
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T02:45:59.000Z" title="Fri Jan 23 2026 02:45:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ‰€æœ‰æƒï¼ˆOwnershipï¼‰æ˜¯ Rust çš„æ ¸å¿ƒçµé­‚ã€‚è¦ç†è§£å®ƒï¼Œæœ€å…³é”®çš„æ˜¯åˆ†æ¸…<strong>æ•°æ®æ˜¯å­˜åœ¨â€œæ ˆï¼ˆStackï¼‰â€ä¸Šè¿˜æ˜¯â€œå †ï¼ˆHeapï¼‰â€ä¸Š</strong>ã€‚</p>
<p>è¿™æ˜¯å¯¹æ‰€æœ‰æƒç³»ç»ŸåŠå…¶è¡Œä¸ºå·®å¼‚çš„æ·±åº¦æ€»ç»“ï¼š</p>
<hr/>
<h2 data-id="heading-0">1. æ‰€æœ‰æƒçš„ä¸‰å¤§åŸºæœ¬è§„åˆ™</h2>
<ol>
<li>Rust ä¸­çš„æ¯ä¸€ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ªè¢«ç§°ä¸ºå…¶ <strong>æ‰€æœ‰è€…ï¼ˆownerï¼‰</strong> çš„å˜é‡ã€‚</li>
<li>åŒä¸€æ—¶é—´ï¼Œå€¼æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ‰€æœ‰è€…ã€‚</li>
<li>å½“æ‰€æœ‰è€…ï¼ˆå˜é‡ï¼‰ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œè¿™ä¸ªå€¼å°†è¢«ç«‹å³é”€æ¯ï¼ˆDropï¼‰ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-1">2. è¡Œä¸ºå·®å¼‚ï¼šåŸºç¡€ç±»å‹ vs. å¼•ç”¨/å¤æ‚ç±»å‹</h2>
<p>åœ¨å¤„ç†èµ‹å€¼ï¼ˆ<code>let y = x</code>ï¼‰æˆ–å‡½æ•°ä¼ å‚æ—¶ï¼Œä¸åŒç±»å‹çš„è¡¨ç°å®Œå…¨ä¸åŒï¼š</p>
<h3 data-id="heading-2">A. åŸºç¡€ç±»å‹ï¼šCopy è¯­ä¹‰ï¼ˆæ ˆï¼‰</h3>
<ul>
<li>
<p><strong>æ¶‰åŠç±»å‹ï¼š</strong> <code>i32</code>, <code>f64</code>, <code>bool</code>, <code>char</code> ä»¥åŠåªåŒ…å«è¿™äº›ç±»å‹çš„ <code>tuple</code>ã€‚</p>
</li>
<li>
<p><strong>è¡Œä¸ºï¼š</strong> å®ƒä»¬çš„å¤§å°åœ¨ç¼–è¯‘æœŸå·²çŸ¥ï¼Œç›´æ¥å­˜å‚¨åœ¨<strong>æ ˆ</strong>ä¸Šã€‚èµ‹å€¼æ—¶ä¼šæ‰§è¡Œ<strong>æ·±æ‹·è´</strong>ã€‚</p>
</li>
<li>
<p><strong>ç»“æœï¼š</strong> æ—§å˜é‡ä¾ç„¶æœ‰æ•ˆã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">x</span> = <span class="hljs-number">5</span>;
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">y</span> = x; <span class="hljs-comment">// å¤åˆ¶äº†ä¸€ä»½ 5</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, x); <span class="hljs-comment">// ä»ç„¶å¯ç”¨ï¼Œæ²¡é—®é¢˜</span>
</code></pre>
</li>
</ul>
<h3 data-id="heading-3">B. å¤æ‚ç±»å‹ï¼šMove è¯­ä¹‰ï¼ˆå †ï¼‰</h3>
<ul>
<li>
<p><strong>æ¶‰åŠç±»å‹ï¼š</strong> <code>String</code>, <code>Vec&lt;T&gt;</code>, <code>Box&lt;T&gt;</code> ä»¥åŠè‡ªå®šä¹‰ç»“æ„ä½“ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼‰ã€‚</p>
</li>
<li>
<p><strong>è¡Œä¸ºï¼š</strong> æ•°æ®å­˜åœ¨<strong>å †</strong>ä¸Šï¼Œå˜é‡æœ¬èº«åªæ˜¯ä¸€ä¸ªæŒ‡å‘å †å†…å­˜çš„â€œæŒ‡é’ˆ/å…ƒæ•°æ®â€ï¼ˆå­˜åœ¨æ ˆä¸Šï¼‰ã€‚èµ‹å€¼æ—¶æ‰§è¡Œ<strong>ç§»åŠ¨ï¼ˆMoveï¼‰</strong> ã€‚</p>
</li>
<li>
<p><strong>ç»“æœï¼š</strong> æ—§å˜é‡<strong>ç«‹å³å¤±æ•ˆ</strong>ï¼Œé˜²æ­¢åŒé‡é‡Šæ”¾ï¼ˆDouble Freeï¼‰å†…å­˜ã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s1</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"hello"</span>);
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s2</span> = s1; <span class="hljs-comment">// æ‰€æœ‰æƒè½¬ç§»ç»™äº† s2</span>
<span class="hljs-comment">// println!("{}", s1); // æŠ¥é”™ï¼s1 å·²ç»å˜æˆäº†â€œç©ºå£³â€</span>
</code></pre>
</li>
</ul>
<hr/>
<h2 data-id="heading-4">3. å€Ÿç”¨ï¼ˆBorrowingï¼‰ï¼šå¼•ç”¨çš„è¡Œä¸º</h2>
<p>ä¸ºäº†é¿å…é¢‘ç¹è½¬ç§»æ‰€æœ‰æƒï¼ŒRust å¼•å…¥äº†å¼•ç”¨ï¼ˆ<code>&amp;</code>ï¼‰ã€‚å€Ÿç”¨ä¸è·å–æ‰€æœ‰æƒï¼Œåªæ˜¯â€œç§Ÿç”¨â€æ•°æ®ã€‚</p>
<h3 data-id="heading-5">ä¸å¯å˜å¼•ç”¨ <code>&amp;T</code>ï¼ˆå…±äº«å€Ÿç”¨ï¼‰</h3>
<ul>
<li><strong>è¡Œä¸ºï¼š</strong> åƒåªè¯»æ¨¡å¼ã€‚</li>
<li><strong>çº¦æŸï¼š</strong> åŒä¸€æ—¶é—´å¯ä»¥æœ‰<strong>æ— æ•°ä¸ª</strong>ä¸å¯å˜å¼•ç”¨ã€‚</li>
<li><strong>åº•å±‚ï¼š</strong> åªæ˜¯ä¸€ä¸ªæŒ‡å‘åŸå§‹æ•°æ®çš„æŒ‡é’ˆã€‚</li>
</ul>
<h3 data-id="heading-6">å¯å˜å¼•ç”¨ <code>&amp;mut T</code>ï¼ˆç‹¬å å€Ÿç”¨ï¼‰</h3>
<ul>
<li><strong>è¡Œä¸ºï¼š</strong> åƒå†™æ¨¡å¼ã€‚</li>
<li><strong>çº¦æŸï¼š</strong> åŒä¸€æ—¶é—´åªèƒ½æœ‰<strong>ä¸€ä¸ª</strong>å¯å˜å¼•ç”¨ï¼Œä¸”æ­¤æ—¶ä¸èƒ½æœ‰ä»»ä½•ä¸å¯å˜å¼•ç”¨ã€‚</li>
<li><strong>ç›®çš„ï¼š</strong> å½»åº•æœç»<strong>æ•°æ®ç«äº‰ï¼ˆData Raceï¼‰</strong> ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-7">4. æ€»ç»“å¯¹æ¯”è¡¨</h2>









































<table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>åŸºç¡€ç±»å‹ (Copy)</strong></th><th><strong>å¤æ‚ç±»å‹ (Move)</strong></th><th><strong>å¼•ç”¨ (Borrowing)</strong></th></tr></thead><tbody><tr><td><strong>å†…å­˜ä½ç½®</strong></td><td>æ ˆ (Stack)</td><td>å † (Heap)</td><td>æŒ‡å‘æ ˆæˆ–å †çš„æŒ‡é’ˆ</td></tr><tr><td><strong>èµ‹å€¼æ“ä½œ</strong></td><td>å¤åˆ¶å€¼</td><td>è½¬ç§»æ‰€æœ‰æƒ</td><td>ä¼ é€’æŒ‡é’ˆ</td></tr><tr><td><strong>æ—§å˜é‡æ˜¯å¦å¯ç”¨</strong></td><td>æ˜¯</td><td>å¦</td><td>æ˜¯ï¼ˆä½†åœ¨å€Ÿç”¨æœŸé—´å—é™ï¼‰</td></tr><tr><td><strong>æ€§èƒ½å¼€é”€</strong></td><td>æå°</td><td>æå°ï¼ˆä»…å¤åˆ¶å…ƒæ•°æ®ï¼‰</td><td>æå°</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>ç®€å•æ•°å€¼è®¡ç®—</td><td>å¤§è§„æ¨¡æ•°æ®ç®¡ç†</td><td>ä¸´æ—¶è®¿é—®/å‡½æ•°ä¼ å‚</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-8">5. è¿›é˜¶æ ¸å¿ƒï¼šåˆ‡ç‰‡ï¼ˆSliceï¼‰</h2>
<p>åˆ‡ç‰‡ï¼ˆå¦‚ <code>&amp;str</code> æˆ– <code>&amp;[i32]</code>ï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¼•ç”¨ã€‚å®ƒä¸æ‹¥æœ‰æ‰€æœ‰æƒï¼Œä½†å®ƒä¸ä»…åŒ…å«æŒ‡é’ˆï¼Œè¿˜åŒ…å«ä¸€ä¸ª<strong>é•¿åº¦</strong>ã€‚å®ƒæ˜¯å¯¹é›†åˆä¸­ä¸€æ®µè¿ç»­å†…å­˜çš„â€œè§‚å¯Ÿçª—å£â€ã€‚</p>
<blockquote>
<p><strong>ä¸€å¥è¯æ€»ç»“ï¼š</strong></p>
<p>åŸºç¡€ç±»å‹é â€œå¤å°â€ï¼Œå¤æ‚ç±»å‹é â€œæ¥åŠ›æ£’â€ï¼Œè€Œå¼•ç”¨åˆ™æ˜¯â€œçœ‹ä¸€çœ¼â€æˆ–â€œä¿®ä¸€ä¸‹â€ã€‚</p>
</blockquote>
<p><strong>çœ‹å®Œè¿™ä¸ªæ€»ç»“ï¼Œä½ è§‰å¾—ç»ƒä¹  2ï¼ˆå…³äº <code>ref1</code> å’Œ <code>ref3</code> å†²çªé‚£é“é¢˜ï¼‰çš„ç­”æ¡ˆæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¸…åå¼€æºï¼è¿™ä¸ª GitHub é¡¹ç›®é‡æ–°å®šä¹‰ç«¯ä¾§ Agent æ™ºèƒ½ä½“ ã€‚]]></title>    <link>https://juejin.cn/post/7598099064443273279</link>    <guid>https://juejin.cn/post/7598099064443273279</guid>    <pubDate>2026-01-23T02:46:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598099064443273279" data-draft-id="7598021313871265798" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¸…åå¼€æºï¼è¿™ä¸ª GitHub é¡¹ç›®é‡æ–°å®šä¹‰ç«¯ä¾§ Agent æ™ºèƒ½ä½“ ã€‚"/> <meta itemprop="keywords" content="GitHub"/> <meta itemprop="datePublished" content="2026-01-23T02:46:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é€›é€›GitHub"/> <meta itemprop="url" content="https://juejin.cn/user/1442202996186093"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¸…åå¼€æºï¼è¿™ä¸ª GitHub é¡¹ç›®é‡æ–°å®šä¹‰ç«¯ä¾§ Agent æ™ºèƒ½ä½“ ã€‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1442202996186093/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é€›é€›GitHub
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T02:46:12.000Z" title="Fri Jan 23 2026 02:46:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ¸…åå¤§å­¦ã€<strong>ä¸­å›½äººæ°‘å¤§å­¦</strong>ã€<strong>é¢å£æ™ºèƒ½</strong>ä¸Â <strong>OpenBMB å¼€æºç¤¾åŒº</strong>è”åˆå¼€æºäº†ä¸€ä¸ªæ™ºèƒ½ä½“ï¼Œå«åš AgentCPMï¼Œå®ƒé‡æ–°å®šä¹‰äº†ç«¯ä¾§æ™ºèƒ½ä½“å¤©èŠ±æ¿ã€‚</p>
<p>AgentCPM æœ€äº®çœ¼çš„æ˜¯ä»¥å°åšå¤§ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/46286cc603024e398eed271107808bab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769741171&amp;x-signature=0Y7E4B4F%2BVELdKy1tc3SgouS4fY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä»…Â <strong>4B å‚æ•°</strong>çš„æ¨¡å‹ï¼Œåœ¨å¤æ‚çš„é•¿ç¨‹æ·±åº¦æ¢ç´¢ä»»åŠ¡ä¸Šï¼Œå®ç°äº†è¶…è¶ŠåŒå°ºå¯¸ SOTAã€ç”šè‡³æ¯”è‚© 30B çº§å’Œéƒ¨åˆ†é—­æºå¤§æ¨¡å‹çš„æ€§èƒ½ã€‚</p>
<p>å¼€æºåè·å¾—å¹¿æ³›çš„å…³æ³¨ï¼Œç›®å‰å·²ç»ç™»ä¸Š HuggingFace çš„çƒ­æ¦œäº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/01ae5ce80f9a47849718a1415f91bef1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769741171&amp;x-signature=11%2BfSMfJngTbzxQZ20jWnwzfMT4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>01</p>
<p><strong>å¼€æºé¡¹ç›®ç®€ä»‹</strong></p>
<p><strong>AgentCPM-Explore</strong>Â æ˜¯è¿™ä¸ªå¼€æºé¡¹ç›®çš„æ ¸å¿ƒæ¨¡å‹ï¼Œä¸“æ³¨äºè§£å†³é•¿å‘¨æœŸã€å¤šæ­¥äº¤äº’çš„å¤æ‚ä»»åŠ¡ã€‚</p>
<p>å®ƒæ˜¯åŸºäº Qwen3-4B-thinking-2507 è¿›è¡Œæ·±åº¦åè®­ç»ƒã€‚æ˜¯é¦–ä¸ªå…·å¤‡ GAIAã€Xbenchã€Browsercomp ç­‰ 8 ä¸ªé«˜éš¾åº¦æ™ºèƒ½ä½“ä»»åŠ¡å¤„ç†èƒ½åŠ›çš„ 4B ç«¯ä¾§æ¨¡å‹ã€‚</p>
<p>åœ¨å¤šä¸ªæ¦œå•ä¸Šè¶…è¶Šäº† 8B çº§ SOTA æ¨¡å‹ï¼Œç”šè‡³åœ¨ Xbench-DeepResearch ä¸Šè¡¨ç°ä¼˜äº OpenAI-o3 å’Œ Claude-3.5-Sonnetã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5d4d23d09e3544ca8d4d362baf0d1b71~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769741171&amp;x-signature=1PWgr3Wujadn2JYgwixcjw3BgJw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç‰›çš„æ˜¯ï¼Œå®ƒæ”¯æŒæœ€é«˜è¶…è¿‡Â <strong>100 è½®</strong>çš„ä¸é‡å¤ä¸”ç¨³å®šçš„ç¯å¢ƒäº¤äº’ï¼Œèƒ½å¤ŸæŒç»­æ·±åº¦æ¢ç´¢ç›´è‡³ä»»åŠ¡å®Œæˆã€‚</p>
<p>åœ¨å…è®¸é‡å¤å°è¯•çš„æƒ…å†µä¸‹ï¼Œèƒ½å¤Ÿè§£å†³ GAIA æ–‡æœ¬ä»»åŠ¡ä¸­ 95% ä»¥ä¸Šçš„é¢˜ç›®ã€‚</p>
<p>è€Œä¸”ï¼Œå®ƒä¸åƒå…¶å®ƒçš„å°æ¨¡å‹æ­»è®°ç¡¬èƒŒã€‚</p>
<p>è€Œæ˜¯å…·å¤‡è´¨ç–‘å·¥å…·ã€è¿½æ±‚åŸå§‹æ•°æ®ã€çµæ´»è°ƒæ•´ç­–ç•¥åŠæ‰§ç€å¯»æ‰¾ä¿¡æºç­‰ç‰¹å¾çš„ç±»äººæ€è€ƒé€»è¾‘ã€‚</p>
<p>èƒ½å¤Ÿåƒç»éªŒä¸°å¯Œçš„äººç±»ç ”ç©¶å‘˜ä¸€æ ·ï¼Œé€šè¿‡ä¸»åŠ¨æ ¸æŸ¥ã€å¤šæºéªŒè¯å’Œæˆ˜æœ¯å˜é€šé«˜æ•ˆè§£å†³å¤æ‚éš¾é¢˜ã€‚</p>
<p>AgentCPM ä¸ä»…å¼€æºäº†æ¨¡å‹æƒé‡ï¼Œè¿˜å¼€æºäº†ä» Base æ¨¡å‹è¿›åŒ–åˆ° SOTA æ¨¡å‹çš„å…¨å¥—åŸºç¡€è®¾æ–½ï¼Œæ”¯æŒå¼€å‘è€…å¤ç°ã€äºŒå¼€å’Œç§æœ‰åŒ–éƒ¨ç½²ã€‚</p>
<p>æ¯”å¦‚ AgentDock å·¥å…·æ²™ç›’ç»Ÿä¸€ç®¡ç†è°ƒåº¦å¹³å°ï¼ŒAgentRL æ˜¯æç®€é«˜æ•ˆçš„å¼‚æ­¥å¼ºåŒ–å­¦ä¹ æ¡†æ¶ï¼Œè¿˜æœ‰ AgentToLeaP æ™ºèƒ½ä½“èƒ½åŠ›ä¸€é”®å¼è¯„æµ‹å¹³å°ã€‚</p>
<p>02</p>
<p><strong>å¦‚ä½•ä½¿ç”¨</strong></p>
<p>éƒ¨ç½²å®‰è£… AgentCPM-Explore ä¸»è¦åˆ†ä¸ºä¸¤ä¸ªæ ¸å¿ƒéƒ¨åˆ†ï¼Œå…ˆéƒ¨ç½²å·¥å…·æ²™ç›’ç¯å¢ƒ Â AgentDock) ï¼Œç„¶åæ˜¯é…ç½®å¹¶è¿è¡Œæ™ºèƒ½ä½“æ¨¡å‹ AgentCPM-Exploreã€‚</p>
<p>â‘  å…‹éš†é¡¹ç›®ä»£ç </p>
<pre><code class="hljs language-bash" lang="bash">gitÂ <span class="hljs-built_in">clone</span>Â https://github.com/OpenBMB/AgentCPM.gitcdÂ AgentCPM/AgentCPM-Explore
</code></pre>
<p>â‘¡ éƒ¨ç½²å·¥å…·æ²™ç›’ç¯å¢ƒ Â AgentDock</p>
<p>è¿™æ˜¯å…³é”®ä¸€æ­¥ï¼Œå®ƒä¸ºæ™ºèƒ½ä½“æä¾›äº†ç»Ÿä¸€çš„å·¥å…·è°ƒç”¨æœåŠ¡ã€‚</p>
<p>1.Â è¿›å…¥ AgentDock ç›®å½•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span>Â AgentDock
</code></pre>
<p>2.Â ä¸€é”®å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼š</p>
<p>ä½¿ç”¨ docker-compose å‘½ä»¤å¯åŠ¨ç®¡ç†é¢æ¿ã€æ•°æ®åº“å’Œå·¥å…·èŠ‚ç‚¹ã€‚</p>
<pre><code class="hljs">dockerÂ compose up -d
</code></pre>
<p>æ­¤å‘½ä»¤ä¼šåœ¨åå°å¯åŠ¨æ‰€æœ‰å¿…è¦çš„æœåŠ¡ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ docker ps å‘½ä»¤æ£€æŸ¥æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚</p>
<p>3.Â éªŒè¯éƒ¨ç½²ï¼š</p>
<p>å·¥å…·æ²™ç›’é»˜è®¤è¿è¡Œåœ¨ <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A8000%25E3%2580%2582" target="_blank" title="http://localhost:8000%E3%80%82" ref="nofollow noopener noreferrer">http://localhost:8000ã€‚</a></p>
<p>æ‚¨å¯ä»¥é€šè¿‡è®¿é—® <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A8000%2Fhealth" target="_blank" title="http://localhost:8000/health" ref="nofollow noopener noreferrer">http://localhost:8000/health</a> æ¥æ£€æŸ¥æœåŠ¡æ˜¯å¦å¥åº·ã€‚å¦‚æœè¿”å› JSON æ ¼å¼çš„å¥åº·çŠ¶æ€ä¿¡æ¯ï¼Œåˆ™è¯´æ˜éƒ¨ç½²æˆåŠŸã€‚</p>
<p>â‘¢ é…ç½®å¹¶è¿è¡Œæ™ºèƒ½ä½“æ¨¡å‹ AgentCPM-Explore</p>
<p>æ–‡æ¡£æ¨èåœ¨é¢„ç½®çš„ Docker è¯„æµ‹ç¯å¢ƒä¸­è¿›è¡Œæ“ä½œï¼Œä»¥é¿å…ç¯å¢ƒä¾èµ–é—®é¢˜ã€‚</p>
<p>1.Â æ‹‰å–å¹¶è¿›å…¥é¢„ç½®ç¯å¢ƒï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"># ç¡®ä¿å½“å‰åœ¨ <span class="hljs-title class_">AgentCPM</span>-<span class="hljs-title class_">Explore</span> é¡¹ç›®æ ¹ç›®å½•# æ‹‰å–é¢„ç½®çš„ <span class="hljs-title class_">Docker</span> é•œåƒdocker pull yuyangfu/agenttoleap-<span class="hljs-attr">eval</span>:v1<span class="hljs-number">.0</span># å¯åŠ¨ä¸€ä¸ªå®¹å™¨ï¼Œå¹¶å°†å½“å‰ç›®å½•æ˜ å°„åˆ°å®¹å™¨å†…docker run -dit --name agenttoleap --gpus all --network host -v $(pwd):<span class="hljs-regexp">/workspace yuyangfu/</span>agenttoleap-<span class="hljs-attr">eval</span>:v1<span class="hljs-number">.0</span># è¿›å…¥å®¹å™¨dockerÂ execÂ -it agenttoleap /bin/bash# åœ¨å®¹å™¨å†…è¿›å…¥é¡¹ç›®å·¥ä½œç›®å½•cdÂ /workspace
</code></pre>
<p>2.Â é…ç½®è¿è¡Œå‚æ•°ï¼š</p>
<p>ç¼–è¾‘é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ quickstart.py æ–‡ä»¶ï¼Œæ‰¾åˆ° [USER CONFIGURATION] éƒ¨åˆ†ï¼Œæ ¹æ®ä½ çš„éœ€æ±‚é…ç½®ä¸€ä¸‹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40f89203790341f5ad367a386f3a76a6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769741171&amp;x-signature=caBdI6AIW1bdddG1PxNvR%2FFVCGc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>3.Â è¿è¡Œæ™ºèƒ½ä½“ä»»åŠ¡ï¼š</p>
<p>å®Œæˆé…ç½®åï¼Œè¿è¡Œ QuickStart è„šæœ¬ã€‚</p>
<pre><code class="hljs">pythonÂ quickstart.py
</code></pre>
<p>è„šæœ¬ä¼šè‡ªåŠ¨æ‰§è¡Œæ‚¨å®šä¹‰çš„ä»»åŠ¡ï¼Œå±•ç¤ºæ™ºèƒ½ä½“çš„å®Œæ•´äº¤äº’è¿‡ç¨‹ï¼Œæ¯”å¦‚æ€è€ƒã€å·¥å…·è°ƒç”¨ã€ç»“æœç”Ÿæˆã€‚</p>
<p>â‘£ æŸ¥çœ‹è¿è¡Œç»“æœ</p>
<p>ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œç»“æœä¼šä¿å­˜åœ¨ outputs/quickstart_results/ ç›®å½•ä¸‹ã€‚</p>
<p>æ‚¨å¯ä»¥æŸ¥çœ‹å…¶ä¸­çš„ dialog.json æ–‡ä»¶ï¼Œå®ƒè®°å½•äº†å®Œæ•´çš„ä»»åŠ¡æ‰§è¡Œè½¨è¿¹ï¼ŒåŒ…æ‹¬æ™ºèƒ½ä½“çš„æ€è€ƒé“¾ã€æ¯æ¬¡å·¥å…·è°ƒç”¨çš„è¯·æ±‚ä¸å“åº”ä»¥åŠæœ€ç»ˆç­”æ¡ˆã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤šå¹³å°æ¶æ„äº¤äº’è®¾è®¡ä¸æ–¹æ¡ˆï¼šç§»åŠ¨ã€PCã€Padçš„æ— ç¼å“åº”å¼é›†æˆ]]></title>    <link>https://juejin.cn/post/7598099064443404351</link>    <guid>https://juejin.cn/post/7598099064443404351</guid>    <pubDate>2026-01-23T02:52:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598099064443404351" data-draft-id="7598112768147013638" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤šå¹³å°æ¶æ„äº¤äº’è®¾è®¡ä¸æ–¹æ¡ˆï¼šç§»åŠ¨ã€PCã€Padçš„æ— ç¼å“åº”å¼é›†æˆ"/> <meta itemprop="keywords" content="å‰ç«¯,æ¶æ„,å“åº”å¼è®¾è®¡"/> <meta itemprop="datePublished" content="2026-01-23T02:52:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤šå¹³å°æ¶æ„äº¤äº’è®¾è®¡ä¸æ–¹æ¡ˆï¼šç§»åŠ¨ã€PCã€Padçš„æ— ç¼å“åº”å¼é›†æˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T02:52:57.000Z" title="Fri Jan 23 2026 02:52:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{font-size:24px;display:inline-block;font-weight:700;background:#ef7060;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(239,112,96,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 50px);border-bottom:3px solid #ef7060}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #3e3e3e;margin-top:32px;margin-bottom:32px;height:1px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(27,31,35,.05);color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:JetBranins Mono,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px;background-color:#fdfdfd}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fdfdfd}.markdown-body a{text-decoration:none;font-weight:700;color:#ef7060;border-bottom:1px solid #ef7060}.markdown-body a:active,.markdown-body a:hover{color:#ef2d26}.markdown-body table tr td,.markdown-body table tr th{border:1px solid #ccc;padding:5px 10px}.markdown-body table{display:block!important;width:auto;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{background:#f0f0f0;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f8f8f8}.markdown-body blockquote{margin-inline-start:0;margin-inline-end:0;border-left:3px solid #ef7060;background:#fff9f9;padding:1px 20px;margin-top:20px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h4 data-id="heading-0">å¼•è¨€</h4>
<p>åœ¨å½“ä»Šå¤šè®¾å¤‡ã€è·¨å¹³å°çš„æ•°å­—ä¸–ç•Œä¸­ï¼Œç”¨æˆ·æœŸæœ›èƒ½å¤Ÿåœ¨ä¸åŒçš„è®¾å¤‡ä¸Šæµç•…æ— ç¼åœ°ä½“éªŒåº”ç”¨ã€‚æ— è®ºæ˜¯ç§»åŠ¨ç«¯ã€PCç«¯è¿˜æ˜¯Padç«¯ï¼Œæ¯ä¸ªå¹³å°çš„ç•Œé¢å’Œäº¤äº’è®¾è®¡éƒ½å­˜åœ¨ä¸åŒçš„ç‰¹ç‚¹å’Œéœ€æ±‚ã€‚å› æ­¤ï¼Œå¦‚ä½•è®¾è®¡ä¸€ä¸ªèƒ½åœ¨å¤šä¸ªå¹³å°é—´è‡ªé€‚åº”å¹¶æä¾›ä¸€è‡´ä½“éªŒçš„æ¶æ„ï¼Œæˆä¸ºäº†æŠ€æœ¯å¼€å‘è€…é¢ä¸´çš„ä¸€ä¸ªé‡è¦æŒ‘æˆ˜ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨å¦‚ä½•åœ¨å¤šä¸ªå¹³å°ï¼ˆç§»åŠ¨ã€PCã€Padï¼‰ä¹‹é—´è¿›è¡Œæ¶æ„äº¤äº’è®¾è®¡ï¼Œä¿è¯å“åº”å¼è®¾è®¡çš„æ— ç¼é›†æˆï¼Œå¹¶æå‡ºè§£å†³æ–¹æ¡ˆï¼Œå¸®åŠ©å¼€å‘è€…æ„å»ºè·¨å¹³å°çš„ä¸€è‡´ä½“éªŒã€‚</p>
<h4 data-id="heading-1">1. é—®é¢˜å®šä¹‰ä¸èƒŒæ™¯</h4>
<p>éšç€ç§»åŠ¨äº’è”ç½‘çš„å¿«é€Ÿå‘å±•ï¼Œåº”ç”¨çš„ä½¿ç”¨åœºæ™¯å·²ç»ä¸ä»…ä»…å±€é™äºå•ä¸€è®¾å¤‡ï¼Œç”¨æˆ·è¶Šæ¥è¶Šå¤šåœ°åœ¨ä¸åŒè®¾å¤‡é—´åˆ‡æ¢ã€‚ä¾‹å¦‚ï¼ŒåŒä¸€ä¸ªç”¨æˆ·å¯èƒ½åœ¨å‡ºé—¨æ—¶ä½¿ç”¨æ‰‹æœºæµè§ˆç½‘é¡µï¼Œå›åˆ°åŠå…¬å®¤ååˆ™ä½¿ç”¨PCç«¯å®Œæˆæ›´å¤æ‚çš„æ“ä½œï¼Œç”šè‡³åœ¨å¹³æ¿ä¸Šè¿›è¡Œæ›´ä¾¿æ·çš„å¨±ä¹æˆ–æ–‡æ¡£å¤„ç†ã€‚è¿™ç§è®¾å¤‡é—´çš„é¢‘ç¹åˆ‡æ¢è¦æ±‚å¼€å‘è€…æä¾›ä¸€ä¸ªæ— ç¼ä¸”ä¸€è‡´çš„ç”¨æˆ·ä½“éªŒã€‚</p>
<p><strong>ä¸»è¦é—®é¢˜åŒ…æ‹¬</strong>ï¼š</p>
<ul>
<li><strong>å¹³å°é—´ä¸€è‡´æ€§</strong>ï¼šä¸åŒè®¾å¤‡çš„å±å¹•å°ºå¯¸ã€è¾“å…¥æ–¹å¼ï¼ˆè§¦æ‘¸ã€é¼ æ ‡ã€é”®ç›˜ï¼‰ã€ç¡¬ä»¶èƒ½åŠ›ç­‰å·®å¼‚ä½¿å¾—è·¨å¹³å°è®¾è®¡æˆä¸ºä¸€é¡¹å¤æ‚ä»»åŠ¡ã€‚</li>
<li><strong>å“åº”å¼è®¾è®¡</strong>ï¼šå¦‚ä½•åœ¨ä¸åŒå±å¹•å°ºå¯¸ä¸‹ï¼ŒåŠ¨æ€è°ƒæ•´å¸ƒå±€å’ŒåŠŸèƒ½ï¼Œç¡®ä¿ç•Œé¢å…ƒç´ å§‹ç»ˆæ˜“äºæ“ä½œä¸”å¯è®¿é—®ã€‚</li>
<li><strong>æ¶æ„é€‚é…</strong>ï¼šå¤šå¹³å°æ¶æ„è¦æ±‚å¯¹ä¸åŒå¹³å°çš„äº¤äº’è®¾è®¡è¿›è¡Œé€‚é…å’Œä¼˜åŒ–ï¼Œé¿å…é‡å¤å¼€å‘å’Œèµ„æºæµªè´¹ã€‚</li>
<li><strong>æ€§èƒ½å’ŒåŠ è½½é€Ÿåº¦</strong>ï¼šè·¨å¹³å°åº”ç”¨éœ€è¦ä¿è¯é«˜æ•ˆçš„æ€§èƒ½ï¼Œæ— è®ºæ˜¯åœ¨é«˜æ€§èƒ½PCç«¯è¿˜æ˜¯èµ„æºæœ‰é™çš„ç§»åŠ¨ç«¯ï¼Œéƒ½èƒ½æä¾›æµç•…çš„ä½“éªŒã€‚</li>
</ul>
<p>å› æ­¤ï¼Œå¦‚ä½•è®¾è®¡ä¸€ä¸ªèƒ½å¤Ÿæ”¯æŒå¤šä¸ªå¹³å°ï¼Œå¹¶åœ¨ä¸åŒå¹³å°é—´å®ç°æ— ç¼åˆ‡æ¢çš„ç³»ç»Ÿæ¶æ„å’Œäº¤äº’è®¾è®¡ï¼Œæˆä¸ºäº†æŠ€æœ¯å›¢é˜Ÿéœ€è¦é‡ç‚¹è€ƒè™‘çš„é—®é¢˜ã€‚</p>
<h4 data-id="heading-2">2. è§£å†³æ–¹æ¡ˆä¸æŠ€æœ¯å®ç°</h4>
<p>ä¸ºäº†å®ç°ç§»åŠ¨ã€PCã€Padä¹‹é—´çš„æ— ç¼å“åº”å¼é›†æˆï¼Œå¼€å‘è€…éœ€è¦é‡‡ç”¨é€‚åº”æ€§è®¾è®¡ã€å“åº”å¼å¸ƒå±€å’Œç»Ÿä¸€çš„å¼€å‘æ¶æ„ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å…·ä½“çš„è§£å†³æ–¹æ¡ˆä¸æŠ€æœ¯å®ç°æ–¹æ³•ï¼š</p>
<h5 data-id="heading-3">2.1 å“åº”å¼è®¾è®¡ï¼ˆResponsive Designï¼‰</h5>
<p>å“åº”å¼è®¾è®¡çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡CSSåª’ä½“æŸ¥è¯¢ï¼ˆMedia Queryï¼‰å’Œçµæ´»å¸ƒå±€ï¼ŒåŠ¨æ€é€‚é…ä¸åŒå±å¹•å°ºå¯¸çš„è®¾å¤‡ã€‚å¸¸ç”¨çš„æŠ€æœ¯åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>CSS Gridå’ŒFlexbox</strong>ï¼šè¿™ä¸¤ç§CSSå¸ƒå±€æ–¹å¼å¯ä»¥å¸®åŠ©åˆ›å»ºçµæ´»çš„ç½‘æ ¼å¸ƒå±€ï¼Œä½¿å¾—ç•Œé¢å…ƒç´ å¯ä»¥æ ¹æ®å±å¹•å®½åº¦è‡ªåŠ¨è°ƒæ•´ã€‚</li>
<li><strong>åª’ä½“æŸ¥è¯¢ï¼ˆMedia Queriesï¼‰</strong> ï¼šæ ¹æ®ä¸åŒçš„è®¾å¤‡ç‰¹æ€§ï¼ˆå¦‚å±å¹•å®½åº¦ã€åˆ†è¾¨ç‡ã€æ–¹å‘ç­‰ï¼‰ï¼ŒåŠ¨æ€è°ƒæ•´é¡µé¢æ ·å¼ã€‚</li>
</ul>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* é’ˆå¯¹å¤§å±PCç«¯ */</span>
<span class="hljs-keyword">@media</span> (<span class="hljs-attribute">min-width</span>: <span class="hljs-number">1024px</span>) {
  <span class="hljs-selector-class">.container</span> {
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">flex-direction</span>: row;
  }
}

<span class="hljs-comment">/* é’ˆå¯¹å¹³æ¿å’Œç§»åŠ¨è®¾å¤‡ */</span>
<span class="hljs-keyword">@media</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">1024px</span>) {
  <span class="hljs-selector-class">.container</span> {
    <span class="hljs-attribute">display</span>: block;
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  }
}
</code></pre>
<h5 data-id="heading-4">2.2 ç»„ä»¶åŒ–ä¸è·¨å¹³å°æ¡†æ¶</h5>
<p>ä¸ºäº†åœ¨ä¸åŒå¹³å°ä¸Šå®ç°ç»Ÿä¸€çš„ç”¨æˆ·ä½“éªŒï¼Œé‡‡ç”¨ç»„ä»¶åŒ–è®¾è®¡å’Œè·¨å¹³å°å¼€å‘æ¡†æ¶è‡³å…³é‡è¦ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›æµè¡Œçš„è·¨å¹³å°æŠ€æœ¯ï¼š</p>
<ul>
<li><strong>React Native</strong>ï¼šé€‚ç”¨äºæ„å»ºç§»åŠ¨ç«¯å’ŒPCç«¯åº”ç”¨ï¼Œèƒ½å¤Ÿå…±äº«å¤§éƒ¨åˆ†ä»£ç ã€‚</li>
<li><strong>Flutter</strong>ï¼šGoogleæ¨å‡ºçš„è·¨å¹³å°å¼€å‘æ¡†æ¶ï¼Œæ”¯æŒiOSã€Androidã€Webä»¥åŠæ¡Œé¢ç«¯çš„åº”ç”¨å¼€å‘ï¼Œæä¾›é«˜åº¦ä¸€è‡´çš„ç”¨æˆ·ä½“éªŒã€‚</li>
<li><strong>Electron</strong>ï¼šç”¨äºæ„å»ºè·¨å¹³å°æ¡Œé¢åº”ç”¨ï¼Œæ”¯æŒWindowsã€macOSå’ŒLinuxã€‚</li>
</ul>
<p>è¿™äº›æ¡†æ¶é€šè¿‡ç»„ä»¶åŒ–å¼€å‘ï¼Œå¯ä»¥å‡å°‘ä¸åŒå¹³å°ä¹‹é—´çš„é‡å¤ä»£ç ï¼Œä½¿å¾—ç»´æŠ¤å’Œå¼€å‘å˜å¾—æ›´åŠ é«˜æ•ˆã€‚</p>
<h5 data-id="heading-5">2.3 è®¾è®¡é€‚é…ä¸å¹³å°å·®å¼‚åŒ–</h5>
<p>å°½ç®¡å“åº”å¼è®¾è®¡å’Œç»„ä»¶åŒ–å¼€å‘èƒ½å¸®åŠ©æˆ‘ä»¬åœ¨ä¸åŒå¹³å°ä¸Šå®ç°ä¸€è‡´æ€§ï¼Œä½†å¹³å°å·®å¼‚ä¾ç„¶ä¸å¯å¿½è§†ã€‚ä¸åŒå¹³å°çš„äº¤äº’æ–¹å¼ï¼ˆå¦‚è§¦æ‘¸å±å’Œé¼ æ ‡è¾“å…¥ï¼‰å’Œæ€§èƒ½éœ€æ±‚ä¸åŒï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸ªå¹³å°çš„ç‰¹æ€§è¿›è¡Œé€‚é…ï¼š</p>
<ul>
<li><strong>ç§»åŠ¨ç«¯</strong>ï¼šè§¦æ‘¸å±æ“ä½œé¢‘ç¹ï¼Œéœ€è¦å…³æ³¨æŒ‰é’®çš„å¤§å°ã€é—´è·ä»¥åŠæ‰‹åŠ¿æ“ä½œçš„æ”¯æŒã€‚</li>
<li><strong>PCç«¯</strong>ï¼šéœ€è¦è€ƒè™‘é¼ æ ‡æ“ä½œã€é”®ç›˜å¿«æ·é”®ã€çª—å£å¤§å°ç­‰ï¼Œç•Œé¢ä¸Šå¯ä»¥å®¹çº³æ›´å¤šçš„å†…å®¹ã€‚</li>
<li><strong>Padç«¯</strong>ï¼šå¹³æ¿è®¾å¤‡å¾€å¾€ä»‹äºæ‰‹æœºå’ŒPCä¹‹é—´ï¼Œéœ€è¦æ›´åŠ çµæ´»çš„å¸ƒå±€ï¼Œé€‚åº”ä¸åŒçš„ä½¿ç”¨åœºæ™¯ï¼ˆä¾‹å¦‚æ¨ªå±æˆ–ç«–å±ï¼‰ã€‚</li>
</ul>
<p>ä¸ºæ­¤ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒå¹³å°çš„ç‰¹å®šAPIæ¥è¿›ä¸€æ­¥ä¼˜åŒ–äº¤äº’ä½“éªŒã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li>åœ¨<strong>ç§»åŠ¨ç«¯</strong>ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨Touchäº‹ä»¶ä¼˜åŒ–è§¦æ‘¸æ“ä½œï¼›</li>
<li>åœ¨<strong>PCç«¯</strong>ï¼Œå¯ä»¥é€šè¿‡å“åº”é¼ æ ‡å’Œé”®ç›˜äº‹ä»¶æ¥å¢å¼ºäº¤äº’ã€‚</li>
</ul>
<h5 data-id="heading-6">2.4 ç»Ÿä¸€çš„åç«¯æ¶æ„ä¸æ•°æ®åŒæ­¥</h5>
<p>ä¸ºäº†ç¡®ä¿åœ¨ä¸åŒå¹³å°ä¹‹é—´æ— ç¼åˆ‡æ¢ï¼Œç»Ÿä¸€çš„åç«¯æ¶æ„å’Œæ•°æ®åŒæ­¥è‡³å…³é‡è¦ã€‚å¼€å‘è€…å¯ä»¥é€‰æ‹©RESTful APIæˆ–GraphQLä½œä¸ºå‰åç«¯é€šä¿¡çš„æ ‡å‡†åè®®ï¼Œç¡®ä¿æ•°æ®èƒ½å¤Ÿåœ¨ä¸åŒè®¾å¤‡é—´å®æ—¶åŒæ­¥ã€‚</p>
<ul>
<li><strong>RESTful API</strong>ï¼šæ ‡å‡†çš„HTTPæ¥å£ï¼Œé€‚ç”¨äºå¤§å¤šæ•°åº”ç”¨åœºæ™¯ï¼Œç®€å•æ˜“ç”¨ã€‚</li>
<li><strong>GraphQL</strong>ï¼šä¸€ç§çµæ´»çš„æŸ¥è¯¢è¯­è¨€ï¼Œå¯ä»¥æ ¹æ®å®¢æˆ·ç«¯çš„éœ€è¦ç²¾ç¡®è·å–æ•°æ®ï¼Œé¿å…ä¸å¿…è¦çš„æ•°æ®åŠ è½½ã€‚</li>
</ul>
<p>æ•°æ®åŒæ­¥æ–¹æ¡ˆå¯ä»¥åˆ©ç”¨WebSocketæˆ–è€…Firebaseç­‰å®æ—¶æ•°æ®åŒæ­¥å·¥å…·ï¼Œå®ç°ä¸åŒå¹³å°çš„æ•°æ®å®æ—¶æ›´æ–°ã€‚</p>
<h4 data-id="heading-7">3. ä¼˜ç¼ºç‚¹åˆ†æä¸å®é™…åº”ç”¨å»ºè®®</h4>
<h5 data-id="heading-8">3.1 ä¼˜ç‚¹</h5>
<ul>
<li><strong>ä¸€è‡´æ€§ä½“éªŒ</strong>ï¼šé€šè¿‡å“åº”å¼è®¾è®¡å’Œè·¨å¹³å°æ¡†æ¶ï¼Œå¯ä»¥å®ç°ä¸åŒå¹³å°ä¸Šç”¨æˆ·ç•Œé¢çš„ç»Ÿä¸€æ€§ï¼Œä½¿å¾—ç”¨æˆ·æ— è®ºåœ¨ä½•ç§è®¾å¤‡ä¸Šä½¿ç”¨åº”ç”¨ï¼Œä½“éªŒéƒ½ååˆ†æµç•…ã€‚</li>
<li><strong>å¼€å‘æ•ˆç‡</strong>ï¼šç»„ä»¶åŒ–è®¾è®¡å’Œè·¨å¹³å°æ¡†æ¶å‡å°‘äº†é‡å¤å¼€å‘ï¼Œæé«˜äº†å¼€å‘æ•ˆç‡ï¼Œå°¤å…¶æ˜¯åœ¨å¤šå¹³å°å¹¶è¡Œå¼€å‘æ—¶ã€‚</li>
<li><strong>ç»´æŠ¤ç®€åŒ–</strong>ï¼šç»Ÿä¸€çš„åç«¯æ¶æ„å’Œæ•°æ®åŒæ­¥æœºåˆ¶ï¼Œä½¿å¾—å¤šå¹³å°åº”ç”¨çš„ç»´æŠ¤å˜å¾—æ›´åŠ ç®€æ´å’Œé«˜æ•ˆã€‚</li>
</ul>
<h5 data-id="heading-9">3.2 ç¼ºç‚¹</h5>
<ul>
<li><strong>æ€§èƒ½é—®é¢˜</strong>ï¼šæŸäº›è·¨å¹³å°æ¡†æ¶ï¼ˆå¦‚React Nativeæˆ–Flutterï¼‰åœ¨æŸäº›å¹³å°ä¸Šå¯èƒ½ä¼šé¢ä¸´æ€§èƒ½ç“¶é¢ˆï¼Œå°¤å…¶æ˜¯åœ¨å›¾å½¢å¯†é›†å‹åº”ç”¨ä¸­ï¼ˆå¦‚æ¸¸æˆã€3Dæ¸²æŸ“ç­‰ï¼‰ã€‚</li>
<li><strong>å¹³å°å·®å¼‚</strong>ï¼šå°½ç®¡å“åº”å¼è®¾è®¡å’Œè·¨å¹³å°æ¡†æ¶èƒ½å¤Ÿå¤„ç†å¤§éƒ¨åˆ†æƒ…å†µï¼Œä½†æŸäº›å¹³å°å·®å¼‚ä»éœ€ç‰¹åˆ«å…³æ³¨ï¼Œä¾‹å¦‚ç§»åŠ¨ç«¯çš„è§¦æ‘¸è¾“å…¥ä¸PCç«¯çš„é¼ æ ‡è¾“å…¥ä¹‹é—´çš„å·®å¼‚ã€‚</li>
</ul>
<h5 data-id="heading-10">å®é™…åº”ç”¨å»ºè®®ï¼š</h5>
<ul>
<li>åœ¨å¼€å‘åº”ç”¨æ—¶ï¼Œåº”æ ¹æ®ç›®æ ‡å¹³å°çš„ç‰¹ç‚¹æ¥é€‰æ‹©åˆé€‚çš„æ¡†æ¶å’ŒæŠ€æœ¯ã€‚ä¾‹å¦‚ï¼Œå¯¹äºéœ€è¦æé«˜æ€§èƒ½çš„æ¡Œé¢åº”ç”¨ï¼Œä½¿ç”¨Electronå¯èƒ½ä¼šé¢ä¸´æ€§èƒ½é—®é¢˜ï¼Œå¯ä»¥è€ƒè™‘ä¸“é—¨é’ˆå¯¹PCå¹³å°å¼€å‘çš„æŠ€æœ¯æ ˆã€‚</li>
<li>åœ¨ç§»åŠ¨ç«¯å’ŒPCç«¯çš„è®¾è®¡ä¸Šï¼Œåº”é€šè¿‡ç”¨æˆ·æµ‹è¯•æ¥ç¡®å®šæœ€ä½³çš„å¸ƒå±€å’Œäº¤äº’æ–¹å¼ï¼Œä»¥ç¡®ä¿ç”¨æˆ·åœ¨ä¸åŒè®¾å¤‡ä¸Šçš„æ“ä½œä½“éªŒå§‹ç»ˆæµç•…ã€‚</li>
</ul>
<h4 data-id="heading-11">4. ç»“è®º</h4>
<p>åœ¨å¤šå¹³å°æ¶æ„çš„äº¤äº’è®¾è®¡ä¸­ï¼Œå®ç°æ— ç¼å“åº”å¼é›†æˆå¯¹äºæå‡ç”¨æˆ·ä½“éªŒè‡³å…³é‡è¦ã€‚é€šè¿‡é‡‡ç”¨å“åº”å¼è®¾è®¡ã€è·¨å¹³å°å¼€å‘æ¡†æ¶ã€ç»„ä»¶åŒ–å¼€å‘ä»¥åŠç»Ÿä¸€çš„åç«¯æ¶æ„ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåœ¨å¤šä¸ªå¹³å°ä¹‹é—´å®ç°ä¸€è‡´çš„åŠŸèƒ½å’Œä½“éªŒã€‚ç„¶è€Œï¼Œå¦‚ä½•åœ¨æ€§èƒ½å’Œè·¨å¹³å°ä¸€è‡´æ€§ä¹‹é—´å–å¾—å¹³è¡¡ï¼Œä»ç„¶æ˜¯å¼€å‘è€…é¢ä¸´çš„æŒ‘æˆ˜ã€‚éšç€æŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œæœªæ¥å¯èƒ½ä¼šå‡ºç°æ›´å¤šçš„è§£å†³æ–¹æ¡ˆï¼Œä½¿å¾—å¤šå¹³å°å¼€å‘å˜å¾—æ›´åŠ é«˜æ•ˆå’Œå¯é ã€‚</p>
<h4 data-id="heading-12">5. é™„å½•ä¸å‚è€ƒèµ„æ–™</h4>
<ul>
<li>
<p><strong>ç›¸å…³ä¹¦ç±</strong>ï¼š</p>
<ul>
<li>ã€Šå“åº”å¼Webè®¾è®¡ï¼šHTML5å’ŒCSS3å®æˆ˜ã€‹ - Ben Frain</li>
<li>ã€Šæ·±å…¥æµ…å‡ºReactå’ŒReduxã€‹ - èµµä¹¾</li>
</ul>
</li>
<li>
<p><strong>ç›¸å…³æŠ€æœ¯æ ˆ</strong>ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Freactnative.dev%2F" target="_blank" title="https://reactnative.dev/" ref="nofollow noopener noreferrer">React Native</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fflutter.dev%2F" target="_blank" title="https://flutter.dev/" ref="nofollow noopener noreferrer">Flutter</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.electronjs.org%2F" target="_blank" title="https://www.electronjs.org/" ref="nofollow noopener noreferrer">Electron</a></li>
</ul>
</li>
<li>
<p><strong>åœ¨çº¿å·¥å…·</strong>ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcss-tricks.com%2Fsnippets%2Fcss%2Fcomplete-guide-grid%2F" target="_blank" title="https://css-tricks.com/snippets/css/complete-guide-grid/" ref="nofollow noopener noreferrer">CSS Grid</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fflexboxfroggy.com%2F" target="_blank" title="https://flexboxfroggy.com/" ref="nofollow noopener noreferrer">Flexbox Froggy</a> (å¸®åŠ©å­¦ä¹ Flexboxçš„äº¤äº’å¼æ¸¸æˆ)</li>
</ul>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Antigravity é…ç½®æ–‡ä»¶ skills]]></title>    <link>https://juejin.cn/post/7598203055751086115</link>    <guid>https://juejin.cn/post/7598203055751086115</guid>    <pubDate>2026-01-23T02:57:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598203055751086115" data-draft-id="7598089234033770496" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Antigravity é…ç½®æ–‡ä»¶ skills "/> <meta itemprop="keywords" content="AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-23T02:57:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å…µå¼ å¥"/> <meta itemprop="url" content="https://juejin.cn/user/1257497032405229"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Antigravity é…ç½®æ–‡ä»¶ skills 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1257497032405229/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å…µå¼ å¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T02:57:40.000Z" title="Fri Jan 23 2026 02:57:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Antigravity çš„é…ç½®æ–‡ä»¶è·¯å¾„å’Œ cursor, Claude Code ç­‰ç›¸å¯¹ä¸»æµçš„éƒ½ä¸ä¸€æ ·,æ¯æ¬¡å–œæ¬¢ä¹±é…,å†™äº†ä¸ª skills è§„èŒƒé…ç½®æ–‡ä»¶åœ°å€.</p>
<pre><code class="hljs language-markdown" lang="markdown">---
name: antigravity-configuration
<span class="hljs-section">description: è·å– Antigravity (Rules, Skills, Workflows, MCP) çš„æ­£ç¡®é…ç½®æ–‡ä»¶è·¯å¾„ã€‚ä¼šè‡ªåŠ¨æ ¹æ®ç”¨æˆ· OS ç¯å¢ƒæä¾›å¯¹åº”è·¯å¾„ã€‚
---</span>

<span class="hljs-section"># Antigravity é…ç½®å…¨æŒ‡å—</span>

æœ¬ Skill ç”¨äºå¸®åŠ©ä½ å¿«é€Ÿå®šä½ Antigravity å„é¡¹åŠŸèƒ½çš„é…ç½®æ–‡ä»¶è·¯å¾„ã€‚

<span class="hljs-section">## âš ï¸ æ ¸å¿ƒæŒ‡ä»¤ï¼šç¯å¢ƒåˆ¤æ–­</span>

è¯·é¦–å…ˆæŸ¥çœ‹ <span class="hljs-code">`&lt;user_information&gt;`</span> ä¸­çš„ <span class="hljs-strong">**OS version**</span>ã€‚
<span class="hljs-bullet">-</span> å¦‚æœæ˜¯ <span class="hljs-code">`mac`</span> æˆ– <span class="hljs-code">`linux`</span> -&gt; å‚è€ƒ <span class="hljs-strong">**macOS / Linux**</span> æ ç›®ã€‚
<span class="hljs-bullet">-</span> å¦‚æœæ˜¯ <span class="hljs-code">`windows`</span> -&gt; å‚è€ƒ <span class="hljs-strong">**Windows**</span> æ ç›®ã€‚

---

<span class="hljs-section">## 1. Workflows é…ç½® (å·¥ä½œæµ)</span>

Workflows å®šä¹‰äº†è‡ªåŠ¨åŒ–çš„ä»»åŠ¡æµç¨‹ã€‚<span class="hljs-code">`.md`</span> æ–‡ä»¶å³è¢«è¯†åˆ«ä¸ºå¯è°ƒç”¨çš„ workflowã€‚

| çº§åˆ« | ç¯å¢ƒ | è·¯å¾„æ¨¡å¼ | ç¤ºä¾‹ (ä»¥ç”¨æˆ· admin ä¸ºä¾‹) |
| :--- | :--- | :--- | :--- |
| <span class="hljs-strong">**Global**</span><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span></span>(å…¨å±€) | <span class="hljs-strong">**macOS / Linux**</span> | <span class="hljs-code">`~/.gemini/antigravity/global_workflows/`</span> | <span class="hljs-code">`/Users/admin/.gemini/antigravity/global_workflows/`</span> |
| | <span class="hljs-strong">**Windows**</span> | <span class="hljs-code">`%USERPROFILE%\.gemini\antigravity\global_workflows\`</span> | <span class="hljs-code">`C:\Users\Admin\.gemini\antigravity\global_workflows\`</span> |
| <span class="hljs-strong">**Workspace**</span><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span></span>(å·¥ä½œåŒº) | <span class="hljs-strong">**All**</span> | <span class="hljs-code">`&lt;workspace-root&gt;/.agent/workflows/`</span> | <span class="hljs-code">`/Users/admin/PycharmProjects/pf-backend/.agent/workflows/`</span> |

---

<span class="hljs-section">## 2. Skills é…ç½® (æŠ€èƒ½)</span>

Skills æ˜¯æ‰©å±• Agent èƒ½åŠ›çš„å·¥å…·åŒ…ã€‚æ¯ä¸ª skill æ–‡ä»¶å¤¹å†…å¿…é¡»åŒ…å« <span class="hljs-code">`SKILL.md`</span>ã€‚

| çº§åˆ« | ç¯å¢ƒ | è·¯å¾„æ¨¡å¼ | ç¤ºä¾‹ |
| :--- | :--- | :--- | :--- |
| <span class="hljs-strong">**Global**</span><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span></span>(å…¨å±€) | <span class="hljs-strong">**macOS / Linux**</span> | <span class="hljs-code">`~/.gemini/antigravity/global_skills/&lt;skill_name&gt;/`</span> | <span class="hljs-code">`/Users/admin/.gemini/antigravity/global_skills/mysql_ops/`</span> |
| | <span class="hljs-strong">**Windows**</span> | <span class="hljs-code">`%USERPROFILE%\.gemini\antigravity\global_skills\&lt;skill_name&gt;\`</span> | <span class="hljs-code">`C:\Users\Admin\.gemini\antigravity\global_skills\mysql_ops\`</span> |
| <span class="hljs-strong">**Workspace**</span><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span></span>(å·¥ä½œåŒº) | <span class="hljs-strong">**All**</span> | <span class="hljs-code">`&lt;workspace-root&gt;/.agent/skills/&lt;skill_name&gt;/`</span> | <span class="hljs-code">`/Users/admin/PycharmProjects/pf-backend/.agent/skills/mysql_ops/`</span> |

---

<span class="hljs-section">## 3. Rules é…ç½® (è§„åˆ™)</span>

Rules å®šä¹‰äº† Agent çš„è¡Œä¸ºå‡†åˆ™ã€‚

| çº§åˆ« | ç¯å¢ƒ | è·¯å¾„æ¨¡å¼ | ç¤ºä¾‹ |
| :--- | :--- | :--- | :--- |
| <span class="hljs-strong">**Global**</span><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span></span>(å…¨å±€) | <span class="hljs-strong">**macOS / Linux**</span> | <span class="hljs-code">`~/.gemini/GEMINI.md`</span> | <span class="hljs-code">`/Users/admin/.gemini/GEMINI.md`</span> |
| | <span class="hljs-strong">**Windows**</span> | <span class="hljs-code">`%USERPROFILE%\.gemini\GEMINI.md`</span> | <span class="hljs-code">`C:\Users\Admin\.gemini\GEMINI.md`</span> |
| <span class="hljs-strong">**Workspace**</span><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span></span>(å·¥ä½œåŒº) | <span class="hljs-strong">**All**</span> | <span class="hljs-code">`&lt;workspace-root&gt;/.agent/rules/`</span> | <span class="hljs-code">`/Users/admin/PycharmProjects/pf-backend/.agent/rules/`</span>|

---

<span class="hljs-section">## 4. MCP é…ç½® (Model Context Protocol)</span>

MCP æœåŠ¡å™¨é…ç½®<span class="hljs-strong">**ä»…æ”¯æŒå…¨å±€é…ç½®**</span>ï¼Œæ²¡æœ‰é¡¹ç›®çº§åˆ«çš„é…ç½®ã€‚

| ç¯å¢ƒ | é…ç½®æ–‡ä»¶è·¯å¾„ |
| :--- | :--- |
| <span class="hljs-strong">**macOS / Linux**</span> | <span class="hljs-code">`~/.gemini/antigravity/mcp_config.json`</span> |
| <span class="hljs-strong">**Windows**</span> | <span class="hljs-code">`%USERPROFILE%\.gemini\antigravity\mcp_config.json`</span> |

</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[YOLO ç›®æ ‡æ£€æµ‹ API è°ƒç”¨ç¤ºä¾‹ä»£ç å‘å¸ƒï¼ˆPython/Javaï¼‰]]></title>    <link>https://juejin.cn/post/7597989474992554022</link>    <guid>https://juejin.cn/post/7597989474992554022</guid>    <pubDate>2026-01-22T13:51:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597989474992554022" data-draft-id="7597989474992521254" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="YOLO ç›®æ ‡æ£€æµ‹ API è°ƒç”¨ç¤ºä¾‹ä»£ç å‘å¸ƒï¼ˆPython/Javaï¼‰"/> <meta itemprop="keywords" content="åç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-22T13:51:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å¨å“¥"/> <meta itemprop="url" content="https://juejin.cn/user/3411107130652176"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            YOLO ç›®æ ‡æ£€æµ‹ API è°ƒç”¨ç¤ºä¾‹ä»£ç å‘å¸ƒï¼ˆPython/Javaï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3411107130652176/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å¨å“¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-22T13:51:18.000Z" title="Thu Jan 22 2026 13:51:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æ—¥å¸¸çš„è®¡ç®—æœºè§†è§‰å¼€å‘å·¥ä½œä¸­ï¼Œç»å¸¸é‡åˆ°ä¸šåŠ¡ä¾§åŒå­¦çš„è¯‰æ±‚ï¼šâ€œåªæƒ³å¿«é€Ÿç”¨ YOLO åšç›®æ ‡æ£€æµ‹ï¼Œä¸æƒ³æœ¬åœ°æ­ç¯å¢ƒã€é…ä¾èµ–ã€åŠ è½½æ¨¡å‹ï¼Œæœ‰æ²¡æœ‰æ›´è½»é‡åŒ–çš„æ–¹å¼ï¼Ÿâ€ã€‚ç¡®å®ï¼Œå¯¹äºéç®—æ³•å²—ä½çš„å¼€å‘äººå‘˜æ¥è¯´ï¼Œæœ¬åœ°éƒ¨ç½² YOLO çš„ç¯å¢ƒæˆæœ¬ã€æ¨¡å‹åŠ è½½æˆæœ¬è¿‡é«˜ï¼Œè€Œ API è°ƒç”¨æ˜¯å°†ç›®æ ‡æ£€æµ‹èƒ½åŠ›å¿«é€Ÿé›†æˆåˆ°ä¸šåŠ¡ç³»ç»Ÿçš„æœ€ä¼˜è§£ â€”â€” åªéœ€å…³æ³¨è¯·æ±‚ / å“åº”é€»è¾‘ï¼Œæ— éœ€å…³å¿ƒåº•å±‚çš„æ¨¡å‹æ¨ç†ç»†èŠ‚ã€‚</p>
<p>æœ¬æ–‡åŸºäº YOLOv8ï¼ˆç¤¾åŒºç”Ÿæ€æœ€å®Œå–„ã€æ˜“å°è£… API çš„ç‰ˆæœ¬ï¼‰ï¼Œå…ˆæ­å»ºè½»é‡ä¸”é«˜æ€§èƒ½çš„ YOLO æ£€æµ‹ API æœåŠ¡ï¼Œå†æä¾›å¯ç›´æ¥è¿è¡Œçš„ Python/Java è°ƒç”¨ç¤ºä¾‹ï¼Œè¦†ç›–å•å¼ å›¾ç‰‡æ£€æµ‹ã€æ‰¹é‡æ£€æµ‹ã€å¼‚å¸¸å¤„ç†ç­‰æ ¸å¿ƒåœºæ™¯ã€‚æ‰€æœ‰ä»£ç å‡ç»è¿‡ç”Ÿäº§ç¯å¢ƒç®€åŒ–éªŒè¯ï¼Œæ— å†—ä½™é€»è¾‘ï¼Œå¯ç›´æ¥å¤åˆ¶å¤ç”¨ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€å‰ç½®å‡†å¤‡ï¼šæ­å»º YOLOv8 API æœåŠ¡ï¼ˆFastAPI ç‰ˆï¼‰</h2>
<p>è¦å®ç° API è°ƒç”¨ï¼Œé¦–å…ˆéœ€è¦ä¸€ä¸ªå¯æä¾›æ£€æµ‹èƒ½åŠ›çš„æœåŠ¡ç«¯ã€‚è¿™é‡Œé€‰æ‹© FastAPIï¼ˆè½»é‡ã€é«˜æ€§èƒ½ã€è‡ªå¸¦æ¥å£æ–‡æ¡£ï¼‰ä½œä¸ºæœåŠ¡æ¡†æ¶ï¼Œæ˜¯æ–°æ‰‹å’Œç”Ÿäº§ç¯å¢ƒçš„åŒé‡ä¼˜é€‰ã€‚</p>
<h3 data-id="heading-1">1.1 æœåŠ¡ç«¯ç¯å¢ƒå®‰è£…</h3>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…FastAPIå’ŒæœåŠ¡è¿è¡Œä¾èµ–</span>
pip install fastapi uvicorn
<span class="hljs-comment"># å®‰è£…YOLOv8æ ¸å¿ƒåº“ï¼ˆå°è£…äº†å®Œæ•´çš„æ£€æµ‹é€»è¾‘ï¼‰</span>
pip install ultralytics
<span class="hljs-comment"># å®‰è£…å›¾ç‰‡å¤„ç†ä¾èµ–</span>
pip install pillow python-multipart
</code></pre>
<h3 data-id="heading-2">1.2 ç¼–å†™ API æœåŠ¡ä»£ç ï¼ˆyolo_api_server.pyï¼‰</h3>
<p>python</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI, UploadFile, File, HTTPException
<span class="hljs-keyword">from</span> fastapi.responses <span class="hljs-keyword">import</span> JSONResponse
<span class="hljs-keyword">from</span> ultralytics <span class="hljs-keyword">import</span> YOLO
<span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image
<span class="hljs-keyword">import</span> io
<span class="hljs-keyword">import</span> os

<span class="hljs-comment"># åˆå§‹åŒ–FastAPIåº”ç”¨</span>
app = FastAPI(title=<span class="hljs-string">"YOLOv8ç›®æ ‡æ£€æµ‹API"</span>, version=<span class="hljs-string">"1.0"</span>)

<span class="hljs-comment"># åŠ è½½YOLOv8é¢„è®­ç»ƒæ¨¡å‹ï¼ˆæŒ‰éœ€é€‰æ‹©ï¼šn=è½»é‡ s=å¹³è¡¡ m=é«˜ç²¾åº¦ï¼Œæ–°æ‰‹ä¼˜å…ˆé€‰sï¼‰</span>
<span class="hljs-comment"># æ¨¡å‹ä¼šè‡ªåŠ¨ä¸‹è½½ï¼Œè‹¥ç½‘ç»œé—®é¢˜å¯æ‰‹åŠ¨ä»https://github.com/ultralytics/assetsä¸‹è½½</span>
model = YOLO(<span class="hljs-string">"yolov8s.pt"</span>)

<span class="hljs-comment"># å•å¼ å›¾ç‰‡æ£€æµ‹æ¥å£ï¼ˆæ ¸å¿ƒæ¥å£ï¼‰</span>
<span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/detect/single"</span>, summary=<span class="hljs-string">"å•å¼ å›¾ç‰‡ç›®æ ‡æ£€æµ‹"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">detect_single</span>(<span class="hljs-params">file: UploadFile = File(<span class="hljs-params">...</span>)</span>):
    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># 1. æ ¡éªŒæ–‡ä»¶ç±»å‹ï¼ˆé¿å…éå›¾ç‰‡æ–‡ä»¶ä¸Šä¼ ï¼‰</span>
        allowed_ext = {<span class="hljs-string">"jpg"</span>, <span class="hljs-string">"jpeg"</span>, <span class="hljs-string">"png"</span>, <span class="hljs-string">"bmp"</span>}
        file_ext = file.filename.split(<span class="hljs-string">"."</span>)[-<span class="hljs-number">1</span>].lower()
        <span class="hljs-keyword">if</span> file_ext <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> allowed_ext:
            <span class="hljs-keyword">raise</span> HTTPException(status_code=<span class="hljs-number">400</span>, detail=<span class="hljs-string">"ä»…æ”¯æŒjpg/jpeg/png/bmpæ ¼å¼å›¾ç‰‡"</span>)
        
        <span class="hljs-comment"># 2. è¯»å–å¹¶è§£æå›¾ç‰‡</span>
        img_content = <span class="hljs-keyword">await</span> file.read()
        img = Image.<span class="hljs-built_in">open</span>(io.BytesIO(img_content)).convert(<span class="hljs-string">"RGB"</span>)  <span class="hljs-comment"># ç»Ÿä¸€è½¬ä¸ºRGBæ ¼å¼</span>
        
        <span class="hljs-comment"># 3. æ‰§è¡Œç›®æ ‡æ£€æµ‹</span>
        results = model(img)
        
        <span class="hljs-comment"># 4. è§£ææ£€æµ‹ç»“æœï¼ˆé€‚é…ä¸šåŠ¡ä¾§æ˜“è¯»æ ¼å¼ï¼‰</span>
        detect_res = []
        <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> results:
            boxes = r.boxes  <span class="hljs-comment"># æ£€æµ‹æ¡†ä¿¡æ¯</span>
            <span class="hljs-keyword">for</span> box <span class="hljs-keyword">in</span> boxes:
                <span class="hljs-comment"># æå–ç›®æ ‡æ¡†åæ ‡ã€ç½®ä¿¡åº¦ã€ç±»åˆ«</span>
                x1, y1, x2, y2 = [<span class="hljs-built_in">round</span>(v, <span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> box.xyxy[<span class="hljs-number">0</span>].tolist()]
                conf = <span class="hljs-built_in">round</span>(box.conf[<span class="hljs-number">0</span>].item(), <span class="hljs-number">4</span>)  <span class="hljs-comment"># ç½®ä¿¡åº¦ä¿ç•™4ä½å°æ•°</span>
                cls_id = <span class="hljs-built_in">int</span>(box.cls[<span class="hljs-number">0</span>].item())
                cls_name = model.names[cls_id]  <span class="hljs-comment"># ç±»åˆ«åç§°ï¼ˆå¦‚personã€carï¼‰</span>
                
                detect_res.append({
                    <span class="hljs-string">"class_name"</span>: cls_name,
                    <span class="hljs-string">"confidence"</span>: conf,
                    <span class="hljs-string">"bbox"</span>: [x1, y1, x2, y2]  <span class="hljs-comment"># ç›®æ ‡æ¡†å·¦ä¸Šè§’/å³ä¸‹è§’åæ ‡</span>
                })
        
        <span class="hljs-comment"># 5. è¿”å›æ ‡å‡†åŒ–å“åº”</span>
        <span class="hljs-keyword">return</span> JSONResponse(content={
            <span class="hljs-string">"code"</span>: <span class="hljs-number">200</span>,
            <span class="hljs-string">"msg"</span>: <span class="hljs-string">"æ£€æµ‹æˆåŠŸ"</span>,
            <span class="hljs-string">"data"</span>: detect_res
        })
    
    <span class="hljs-keyword">except</span> HTTPException <span class="hljs-keyword">as</span> e:
        <span class="hljs-comment"># å·²çŸ¥å¼‚å¸¸ï¼ˆå¦‚æ–‡ä»¶ç±»å‹é”™è¯¯ï¼‰</span>
        <span class="hljs-keyword">raise</span> e
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-comment"># æœªçŸ¥å¼‚å¸¸ï¼ˆå¦‚å›¾ç‰‡æŸåã€æ¨¡å‹æ¨ç†å¤±è´¥ï¼‰</span>
        <span class="hljs-keyword">raise</span> HTTPException(status_code=<span class="hljs-number">500</span>, detail=<span class="hljs-string">f"æ£€æµ‹å¤±è´¥ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>)

<span class="hljs-comment"># æ‰¹é‡å›¾ç‰‡æ£€æµ‹æ¥å£ï¼ˆæ‰©å±•æ¥å£ï¼‰</span>
<span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/detect/batch"</span>, summary=<span class="hljs-string">"æ‰¹é‡å›¾ç‰‡ç›®æ ‡æ£€æµ‹"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">detect_batch</span>(<span class="hljs-params">files: <span class="hljs-built_in">list</span>[UploadFile] = File(<span class="hljs-params">...</span>)</span>):
    <span class="hljs-keyword">try</span>:
        batch_res = []
        <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> files:
            <span class="hljs-comment"># å•æ–‡ä»¶å¤„ç†é€»è¾‘ï¼ˆå¤ç”¨å•å¼ æ£€æµ‹çš„æ ¡éªŒ/è§£æé€»è¾‘ï¼‰</span>
            file_res = {<span class="hljs-string">"filename"</span>: file.filename}
            <span class="hljs-keyword">try</span>:
                allowed_ext = {<span class="hljs-string">"jpg"</span>, <span class="hljs-string">"jpeg"</span>, <span class="hljs-string">"png"</span>, <span class="hljs-string">"bmp"</span>}
                file_ext = file.filename.split(<span class="hljs-string">"."</span>)[-<span class="hljs-number">1</span>].lower()
                <span class="hljs-keyword">if</span> file_ext <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> allowed_ext:
                    file_res.update({<span class="hljs-string">"code"</span>: <span class="hljs-number">400</span>, <span class="hljs-string">"msg"</span>: <span class="hljs-string">"æ–‡ä»¶æ ¼å¼ä¸æ”¯æŒ"</span>, <span class="hljs-string">"data"</span>: <span class="hljs-literal">None</span>})
                    batch_res.append(file_res)
                    <span class="hljs-keyword">continue</span>
                
                img_content = <span class="hljs-keyword">await</span> file.read()
                img = Image.<span class="hljs-built_in">open</span>(io.BytesIO(img_content)).convert(<span class="hljs-string">"RGB"</span>)
                results = model(img)
                
                detect_res = []
                <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> results:
                    boxes = r.boxes
                    <span class="hljs-keyword">for</span> box <span class="hljs-keyword">in</span> boxes:
                        x1, y1, x2, y2 = [<span class="hljs-built_in">round</span>(v, <span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> box.xyxy[<span class="hljs-number">0</span>].tolist()]
                        conf = <span class="hljs-built_in">round</span>(box.conf[<span class="hljs-number">0</span>].item(), <span class="hljs-number">4</span>)
                        cls_id = <span class="hljs-built_in">int</span>(box.cls[<span class="hljs-number">0</span>].item())
                        cls_name = model.names[cls_id]
                        detect_res.append({
                            <span class="hljs-string">"class_name"</span>: cls_name,
                            <span class="hljs-string">"confidence"</span>: conf,
                            <span class="hljs-string">"bbox"</span>: [x1, y1, x2, y2]
                        })
                
                file_res.update({<span class="hljs-string">"code"</span>: <span class="hljs-number">200</span>, <span class="hljs-string">"msg"</span>: <span class="hljs-string">"æ£€æµ‹æˆåŠŸ"</span>, <span class="hljs-string">"data"</span>: detect_res})
            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
                file_res.update({<span class="hljs-string">"code"</span>: <span class="hljs-number">500</span>, <span class="hljs-string">"msg"</span>: <span class="hljs-string">f"æ£€æµ‹å¤±è´¥ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>, <span class="hljs-string">"data"</span>: <span class="hljs-literal">None</span>})
            <span class="hljs-keyword">finally</span>:
                batch_res.append(file_res)
        
        <span class="hljs-keyword">return</span> JSONResponse(content={
            <span class="hljs-string">"code"</span>: <span class="hljs-number">200</span>,
            <span class="hljs-string">"msg"</span>: <span class="hljs-string">"æ‰¹é‡æ£€æµ‹å®Œæˆ"</span>,
            <span class="hljs-string">"data"</span>: batch_res
        })
    
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-keyword">raise</span> HTTPException(status_code=<span class="hljs-number">500</span>, detail=<span class="hljs-string">f"æ‰¹é‡æ£€æµ‹å¤±è´¥ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>)

<span class="hljs-comment"># å¯åŠ¨æœåŠ¡ï¼ˆæœ¬åœ°æµ‹è¯•ç”¨ï¼‰</span>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-keyword">import</span> uvicorn
    <span class="hljs-comment"># host=0.0.0.0 å…è®¸å±€åŸŸç½‘è®¿é—®ï¼Œport=8000 å¯è‡ªå®šä¹‰ï¼ˆé¿å…ç«¯å£å†²çªï¼‰</span>
    uvicorn.run(app, host=<span class="hljs-string">"0.0.0.0"</span>, port=<span class="hljs-number">8000</span>)
</code></pre>
<h3 data-id="heading-3">1.3 å¯åŠ¨ API æœåŠ¡</h3>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs">python yolo_api_server.py
</code></pre>
<p>å¯åŠ¨æˆåŠŸåï¼Œè®¿é—® <code>http://localhost:8000/docs</code> å¯æŸ¥çœ‹è‡ªåŠ¨ç”Ÿæˆçš„ Swagger æ¥å£æ–‡æ¡£ï¼Œæ”¯æŒåœ¨çº¿ä¸Šä¼ å›¾ç‰‡è°ƒè¯•ï¼Œæ–°æ‰‹å‹å¥½åº¦æ‹‰æ»¡ã€‚</p>
<h2 data-id="heading-4">äºŒã€Python ç‰ˆ API è°ƒç”¨ç¤ºä¾‹</h2>
<p>Python è°ƒç”¨é€‰æ‹©æœ€ä¸»æµçš„<code>requests</code>åº“ï¼Œè¦†ç›–å•å¼  / æ‰¹é‡æ£€æµ‹åœºæ™¯ï¼ŒåŒ…å«å®Œæ•´çš„å¼‚å¸¸å¤„ç†å’Œè¶…æ—¶æ§åˆ¶ï¼Œå¯ç›´æ¥åµŒå…¥ä¸šåŠ¡ä»£ç ã€‚</p>
<h3 data-id="heading-5">2.1 å®‰è£…è°ƒç”¨ä¾èµ–</h3>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs">pip install requests
</code></pre>
<h3 data-id="heading-6">2.2 Python è°ƒç”¨ä»£ç ï¼ˆyolo_api_client.pyï¼‰</h3>
<p>python</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Dict</span>

<span class="hljs-comment"># APIåŸºç¡€é…ç½®ï¼ˆæ ¹æ®å®é™…éƒ¨ç½²åœ°å€ä¿®æ”¹ï¼‰</span>
API_BASE_URL = <span class="hljs-string">"http://localhost:8000"</span>
TIMEOUT = <span class="hljs-number">30</span>  <span class="hljs-comment"># è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ï¼Œé¿å…é•¿æ—¶é—´é˜»å¡</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">detect_single_image</span>(<span class="hljs-params">image_path: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-type">Dict</span>:
    <span class="hljs-string">"""
    è°ƒç”¨å•å¼ å›¾ç‰‡æ£€æµ‹æ¥å£
    :param image_path: æœ¬åœ°å›¾ç‰‡ç»å¯¹/ç›¸å¯¹è·¯å¾„
    :return: æ ‡å‡†åŒ–æ£€æµ‹ç»“æœï¼ˆå­—å…¸æ ¼å¼ï¼‰
    """</span>
    <span class="hljs-comment"># å‰ç½®æ ¡éªŒï¼šæ–‡ä»¶æ˜¯å¦å­˜åœ¨</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(image_path):
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"code"</span>: <span class="hljs-number">404</span>, <span class="hljs-string">"msg"</span>: <span class="hljs-string">f"å›¾ç‰‡æ–‡ä»¶ä¸å­˜åœ¨ï¼š<span class="hljs-subst">{image_path}</span>"</span>, <span class="hljs-string">"data"</span>: <span class="hljs-literal">None</span>}
    
    <span class="hljs-comment"># æ„é€ è¯·æ±‚</span>
    url = <span class="hljs-string">f"<span class="hljs-subst">{API_BASE_URL}</span>/detect/single"</span>
    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># ä»¥äºŒè¿›åˆ¶æ–¹å¼è¯»å–å›¾ç‰‡</span>
        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(image_path, <span class="hljs-string">"rb"</span>) <span class="hljs-keyword">as</span> f:
            files = {<span class="hljs-string">"file"</span>: (os.path.basename(image_path), f)}
            <span class="hljs-comment"># å‘é€POSTè¯·æ±‚</span>
            response = requests.post(url, files=files, timeout=TIMEOUT)
        
        <span class="hljs-comment"># è§£æå“åº”</span>
        <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:
            <span class="hljs-keyword">return</span> response.json()
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> {<span class="hljs-string">"code"</span>: response.status_code, <span class="hljs-string">"msg"</span>: <span class="hljs-string">f"æ¥å£è¿”å›é”™è¯¯ï¼š<span class="hljs-subst">{response.text}</span>"</span>, <span class="hljs-string">"data"</span>: <span class="hljs-literal">None</span>}
    
    <span class="hljs-comment"># å¼‚å¸¸æ•è·ï¼ˆè¦†ç›–90%çš„è°ƒç”¨é—®é¢˜ï¼‰</span>
    <span class="hljs-keyword">except</span> requests.exceptions.Timeout:
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"code"</span>: <span class="hljs-number">408</span>, <span class="hljs-string">"msg"</span>: <span class="hljs-string">"è¯·æ±‚è¶…æ—¶ï¼ˆæœåŠ¡ç«¯å“åº”è¿‡æ…¢æˆ–ç½‘ç»œä¸ç¨³å®šï¼‰"</span>, <span class="hljs-string">"data"</span>: <span class="hljs-literal">None</span>}
    <span class="hljs-keyword">except</span> requests.exceptions.ConnectionError:
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"code"</span>: <span class="hljs-number">503</span>, <span class="hljs-string">"msg"</span>: <span class="hljs-string">"è¿æ¥å¤±è´¥ï¼ˆæ£€æŸ¥APIæœåŠ¡æ˜¯å¦å¯åŠ¨ã€ç«¯å£æ˜¯å¦æ­£ç¡®ï¼‰"</span>, <span class="hljs-string">"data"</span>: <span class="hljs-literal">None</span>}
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"code"</span>: <span class="hljs-number">500</span>, <span class="hljs-string">"msg"</span>: <span class="hljs-string">f"è°ƒç”¨å¼‚å¸¸ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>, <span class="hljs-string">"data"</span>: <span class="hljs-literal">None</span>}

<span class="hljs-keyword">def</span> <span class="hljs-title function_">detect_batch_images</span>(<span class="hljs-params">image_paths: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]</span>) -&gt; <span class="hljs-type">Dict</span>:
    <span class="hljs-string">"""
    è°ƒç”¨æ‰¹é‡å›¾ç‰‡æ£€æµ‹æ¥å£
    :param image_paths: å›¾ç‰‡è·¯å¾„åˆ—è¡¨
    :return: æ‰¹é‡æ£€æµ‹ç»“æœï¼ˆå­—å…¸æ ¼å¼ï¼‰
    """</span>
    <span class="hljs-comment"># è¿‡æ»¤æ— æ•ˆæ–‡ä»¶ï¼Œé¿å…æ‰¹é‡è¯·æ±‚æ•´ä½“å¤±è´¥</span>
    valid_files = []
    <span class="hljs-keyword">for</span> path <span class="hljs-keyword">in</span> image_paths:
        <span class="hljs-keyword">if</span> os.path.exists(path):
            <span class="hljs-comment"># æ„é€ æ‰¹é‡ä¸Šä¼ çš„æ–‡ä»¶å…ƒç»„ï¼ˆkeyå›ºå®šä¸ºfilesï¼Œä¸æœåŠ¡ç«¯å¯¹åº”ï¼‰</span>
            valid_files.append((<span class="hljs-string">"files"</span>, (os.path.basename(path), <span class="hljs-built_in">open</span>(path, <span class="hljs-string">"rb"</span>))))
        <span class="hljs-keyword">else</span>:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è­¦å‘Šï¼šè·³è¿‡ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼š<span class="hljs-subst">{path}</span>"</span>)
    
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> valid_files:
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"code"</span>: <span class="hljs-number">400</span>, <span class="hljs-string">"msg"</span>: <span class="hljs-string">"æ— æœ‰æ•ˆå›¾ç‰‡æ–‡ä»¶"</span>, <span class="hljs-string">"data"</span>: <span class="hljs-literal">None</span>}
    
    <span class="hljs-comment"># æ„é€ è¯·æ±‚</span>
    url = <span class="hljs-string">f"<span class="hljs-subst">{API_BASE_URL}</span>/detect/batch"</span>
    <span class="hljs-keyword">try</span>:
        response = requests.post(url, files=valid_files, timeout=TIMEOUT)
        
        <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:
            <span class="hljs-keyword">return</span> response.json()
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> {<span class="hljs-string">"code"</span>: response.status_code, <span class="hljs-string">"msg"</span>: <span class="hljs-string">f"æ¥å£è¿”å›é”™è¯¯ï¼š<span class="hljs-subst">{response.text}</span>"</span>, <span class="hljs-string">"data"</span>: <span class="hljs-literal">None</span>}
    
    <span class="hljs-keyword">except</span> requests.exceptions.Timeout:
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"code"</span>: <span class="hljs-number">408</span>, <span class="hljs-string">"msg"</span>: <span class="hljs-string">"æ‰¹é‡è¯·æ±‚è¶…æ—¶"</span>, <span class="hljs-string">"data"</span>: <span class="hljs-literal">None</span>}
    <span class="hljs-keyword">except</span> requests.exceptions.ConnectionError:
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"code"</span>: <span class="hljs-number">503</span>, <span class="hljs-string">"msg"</span>: <span class="hljs-string">"è¿æ¥å¤±è´¥ï¼ˆæ£€æŸ¥APIæœåŠ¡çŠ¶æ€ï¼‰"</span>, <span class="hljs-string">"data"</span>: <span class="hljs-literal">None</span>}
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"code"</span>: <span class="hljs-number">500</span>, <span class="hljs-string">"msg"</span>: <span class="hljs-string">f"æ‰¹é‡è°ƒç”¨å¼‚å¸¸ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>, <span class="hljs-string">"data"</span>: <span class="hljs-literal">None</span>}
    <span class="hljs-keyword">finally</span>:
        <span class="hljs-comment"># å…³é”®ï¼šå…³é—­æ‰€æœ‰æ‰“å¼€çš„æ–‡ä»¶å¥æŸ„ï¼Œé¿å…èµ„æºæ³„éœ²</span>
        <span class="hljs-keyword">for</span> _, (_, f) <span class="hljs-keyword">in</span> valid_files:
            f.close()

<span class="hljs-comment"># æµ‹è¯•ç¤ºä¾‹ï¼ˆæ›¿æ¢ä¸ºè‡ªå·±çš„å›¾ç‰‡è·¯å¾„ï¼‰</span>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-comment"># 1. å•å¼ å›¾ç‰‡æ£€æµ‹æµ‹è¯•</span>
    single_img_path = <span class="hljs-string">"test_car.jpg"</span>  <span class="hljs-comment"># æœ¬åœ°å›¾ç‰‡è·¯å¾„</span>
    single_result = detect_single_image(single_img_path)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"=== å•å¼ å›¾ç‰‡æ£€æµ‹ç»“æœ ==="</span>)
    <span class="hljs-built_in">print</span>(single_result)
    
    <span class="hljs-comment"># 2. æ‰¹é‡å›¾ç‰‡æ£€æµ‹æµ‹è¯•</span>
    batch_img_paths = [<span class="hljs-string">"test_person.jpg"</span>, <span class="hljs-string">"test_dog.png"</span>, <span class="hljs-string">"invalid_img.jpg"</span>]  <span class="hljs-comment"># åŒ…å«æ— æ•ˆæ–‡ä»¶ç¤ºä¾‹</span>
    batch_result = detect_batch_images(batch_img_paths)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n=== æ‰¹é‡å›¾ç‰‡æ£€æµ‹ç»“æœ ==="</span>)
    <span class="hljs-built_in">print</span>(batch_result)
</code></pre>
<h2 data-id="heading-7">ä¸‰ã€Java ç‰ˆ API è°ƒç”¨ç¤ºä¾‹</h2>
<p>Java è°ƒç”¨é€‰æ‹©å·¥ä¸šçº§çš„<code>OkHttp</code>å®¢æˆ·ç«¯ï¼ˆæ€§èƒ½ä¼˜ã€ç¨³å®šæ€§å¼ºï¼‰ï¼Œæ­é… FastJSON2 è§£æå“åº”ï¼Œé€‚é… Java åç«¯å¼€å‘åœºæ™¯ã€‚</p>
<h3 data-id="heading-8">3.1 Maven ä¾èµ–é…ç½®ï¼ˆpom.xmlï¼‰</h3>
<p>xml</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- OkHttpæ ¸å¿ƒä¾èµ–ï¼ˆHTTPå®¢æˆ·ç«¯ï¼‰ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.squareup.okhttp3<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>okhttp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.12.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- FastJSON2ï¼ˆJSONè§£æï¼Œè½»é‡é«˜æ•ˆï¼‰ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>fastjson2<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.45<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- æ—¥å¿—ä¾èµ–ï¼ˆå¯é€‰ï¼Œæ–¹ä¾¿è°ƒè¯•ï¼‰ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.9<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-simple<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.9<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h3 data-id="heading-9">3.2 Java è°ƒç”¨ä»£ç ï¼ˆYoloApiClient.javaï¼‰</h3>
<p>java</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.alibaba.fastjson2.JSON;
<span class="hljs-keyword">import</span> com.alibaba.fastjson2.JSONObject;
<span class="hljs-keyword">import</span> okhttp3.*;

<span class="hljs-keyword">import</span> java.io.File;
<span class="hljs-keyword">import</span> java.io.IOException;
<span class="hljs-keyword">import</span> java.util.concurrent.TimeUnit;

<span class="hljs-comment">/**
 * YOLOv8ç›®æ ‡æ£€æµ‹API Javaå®¢æˆ·ç«¯
 * é€‚é…ç”Ÿäº§ç¯å¢ƒè°ƒç”¨è§„èŒƒï¼šå•ä¾‹å®¢æˆ·ç«¯ã€è¶…æ—¶æ§åˆ¶ã€å¼‚å¸¸åˆ†ç±»å¤„ç†
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">YoloApiClient</span> {
    <span class="hljs-comment">// APIåŸºç¡€é…ç½®ï¼ˆæ ¹æ®å®é™…éƒ¨ç½²ä¿®æ”¹ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">API_BASE_URL</span> <span class="hljs-operator">=</span> <span class="hljs-string">"http://localhost:8000"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">TIMEOUT_SECONDS</span> <span class="hljs-operator">=</span> <span class="hljs-number">30</span>;
    <span class="hljs-comment">// å•ä¾‹OkHttpClientï¼ˆé¿å…é‡å¤åˆ›å»ºè¿æ¥æ± ï¼Œæå‡æ€§èƒ½ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> OkHttpClient OK_HTTP_CLIENT;

    <span class="hljs-comment">// é™æ€åˆå§‹åŒ–å®¢æˆ·ç«¯ï¼ˆé…ç½®è¶…æ—¶ã€è¿æ¥æ± ï¼‰</span>
    <span class="hljs-keyword">static</span> {
        OK_HTTP_CLIENT = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OkHttpClient</span>.Builder()
                .connectTimeout(TIMEOUT_SECONDS, TimeUnit.SECONDS)  <span class="hljs-comment">// è¿æ¥è¶…æ—¶</span>
                .readTimeout(TIMEOUT_SECONDS, TimeUnit.SECONDS)     <span class="hljs-comment">// è¯»å–è¶…æ—¶</span>
                .writeTimeout(TIMEOUT_SECONDS, TimeUnit.SECONDS)    <span class="hljs-comment">// å†™å…¥è¶…æ—¶</span>
                .retryOnConnectionFailure(<span class="hljs-literal">true</span>)                     <span class="hljs-comment">// è¿æ¥å¤±è´¥è‡ªåŠ¨é‡è¯•</span>
                .build();
    }

    <span class="hljs-comment">/**
     * è°ƒç”¨å•å¼ å›¾ç‰‡æ£€æµ‹æ¥å£
     * <span class="hljs-doctag">@param</span> imagePath æœ¬åœ°å›¾ç‰‡ç»å¯¹è·¯å¾„
     * <span class="hljs-doctag">@return</span> æ ‡å‡†åŒ–æ£€æµ‹ç»“æœï¼ˆJSONå­—ç¬¦ä¸²ï¼‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">detectSingleImage</span><span class="hljs-params">(String imagePath)</span> {
        <span class="hljs-comment">// 1. æ ¡éªŒæ–‡ä»¶æ˜¯å¦å­˜åœ¨</span>
        <span class="hljs-type">File</span> <span class="hljs-variable">imageFile</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(imagePath);
        <span class="hljs-keyword">if</span> (!imageFile.exists()) {
            <span class="hljs-type">JSONObject</span> <span class="hljs-variable">errorObj</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JSONObject</span>();
            errorObj.put(<span class="hljs-string">"code"</span>, <span class="hljs-number">404</span>);
            errorObj.put(<span class="hljs-string">"msg"</span>, <span class="hljs-string">"å›¾ç‰‡æ–‡ä»¶ä¸å­˜åœ¨ï¼š"</span> + imagePath);
            errorObj.put(<span class="hljs-string">"data"</span>, <span class="hljs-literal">null</span>);
            <span class="hljs-keyword">return</span> errorObj.toJSONString();
        }

        <span class="hljs-comment">// 2. æ ¡éªŒæ–‡ä»¶æ ¼å¼ï¼ˆé¿å…æ— æ•ˆè¯·æ±‚ï¼‰</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">fileName</span> <span class="hljs-operator">=</span> imageFile.getName();
        <span class="hljs-keyword">if</span> (!fileName.contains(<span class="hljs-string">"."</span>)) {
            <span class="hljs-type">JSONObject</span> <span class="hljs-variable">errorObj</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JSONObject</span>();
            errorObj.put(<span class="hljs-string">"code"</span>, <span class="hljs-number">400</span>);
            errorObj.put(<span class="hljs-string">"msg"</span>, <span class="hljs-string">"æ–‡ä»¶æ— åç¼€ï¼Œæ— æ³•è¯†åˆ«æ ¼å¼"</span>);
            errorObj.put(<span class="hljs-string">"data"</span>, <span class="hljs-literal">null</span>);
            <span class="hljs-keyword">return</span> errorObj.toJSONString();
        }
        <span class="hljs-type">String</span> <span class="hljs-variable">fileExt</span> <span class="hljs-operator">=</span> fileName.substring(fileName.lastIndexOf(<span class="hljs-string">"."</span>) + <span class="hljs-number">1</span>).toLowerCase();
        <span class="hljs-keyword">if</span> (!<span class="hljs-string">"jpg"</span>.equals(fileExt) &amp;&amp; !<span class="hljs-string">"jpeg"</span>.equals(fileExt) &amp;&amp; !<span class="hljs-string">"png"</span>.equals(fileExt) &amp;&amp; !<span class="hljs-string">"bmp"</span>.equals(fileExt)) {
            <span class="hljs-type">JSONObject</span> <span class="hljs-variable">errorObj</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JSONObject</span>();
            errorObj.put(<span class="hljs-string">"code"</span>, <span class="hljs-number">400</span>);
            errorObj.put(<span class="hljs-string">"msg"</span>, <span class="hljs-string">"ä»…æ”¯æŒjpg/jpeg/png/bmpæ ¼å¼å›¾ç‰‡"</span>);
            errorObj.put(<span class="hljs-string">"data"</span>, <span class="hljs-literal">null</span>);
            <span class="hljs-keyword">return</span> errorObj.toJSONString();
        }

        <span class="hljs-comment">// 3. æ„é€ multipart/form-dataè¯·æ±‚ä½“ï¼ˆä¸æœåŠ¡ç«¯æ¥å£å‚æ•°å¯¹åº”ï¼‰</span>
        <span class="hljs-type">RequestBody</span> <span class="hljs-variable">requestBody</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MultipartBody</span>.Builder()
                .setType(MultipartBody.FORM)
                .addFormDataPart(
                        <span class="hljs-string">"file"</span>,  <span class="hljs-comment">// å‚æ•°åï¼Œå¿…é¡»ä¸æœåŠ¡ç«¯çš„UploadFileå‚æ•°åä¸€è‡´</span>
                        fileName,
                        RequestBody.create(MediaType.parse(<span class="hljs-string">"image/"</span> + fileExt), imageFile)
                )
                .build();

        <span class="hljs-comment">// 4. æ„é€ è¯·æ±‚</span>
        <span class="hljs-type">Request</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Request</span>.Builder()
                .url(API_BASE_URL + <span class="hljs-string">"/detect/single"</span>)
                .post(requestBody)
                .build();

        <span class="hljs-comment">// 5. å‘é€è¯·æ±‚å¹¶å¤„ç†å“åº”</span>
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Response</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> OK_HTTP_CLIENT.newCall(request).execute()) {
            <span class="hljs-comment">// å¤„ç†é200å“åº”</span>
            <span class="hljs-keyword">if</span> (!response.isSuccessful()) {
                <span class="hljs-type">JSONObject</span> <span class="hljs-variable">errorObj</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JSONObject</span>();
                errorObj.put(<span class="hljs-string">"code"</span>, response.code());
                errorObj.put(<span class="hljs-string">"msg"</span>, <span class="hljs-string">"æ¥å£è°ƒç”¨å¤±è´¥ï¼š"</span> + response.message());
                errorObj.put(<span class="hljs-string">"data"</span>, <span class="hljs-literal">null</span>);
                <span class="hljs-keyword">return</span> errorObj.toJSONString();
            }
            <span class="hljs-comment">// è§£ææˆåŠŸå“åº”</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">responseBody</span> <span class="hljs-operator">=</span> response.body().string();
            <span class="hljs-keyword">return</span> responseBody;
        } <span class="hljs-keyword">catch</span> (IOException e) {
            <span class="hljs-comment">// åˆ†ç±»å¤„ç†å¼‚å¸¸ï¼Œæ–¹ä¾¿ä¸šåŠ¡ä¾§æ’æŸ¥</span>
            <span class="hljs-type">JSONObject</span> <span class="hljs-variable">errorObj</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JSONObject</span>();
            <span class="hljs-keyword">if</span> (e.getMessage().contains(<span class="hljs-string">"timeout"</span>)) {
                errorObj.put(<span class="hljs-string">"code"</span>, <span class="hljs-number">408</span>);
                errorObj.put(<span class="hljs-string">"msg"</span>, <span class="hljs-string">"è¯·æ±‚è¶…æ—¶ï¼ˆæœåŠ¡ç«¯æœªåŠæ—¶å“åº”ï¼‰"</span>);
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e.getMessage().contains(<span class="hljs-string">"Connection refused"</span>)) {
                errorObj.put(<span class="hljs-string">"code"</span>, <span class="hljs-number">503</span>);
                errorObj.put(<span class="hljs-string">"msg"</span>, <span class="hljs-string">"è¿æ¥è¢«æ‹’ç»ï¼ˆæ£€æŸ¥APIæœåŠ¡æ˜¯å¦å¯åŠ¨ï¼‰"</span>);
            } <span class="hljs-keyword">else</span> {
                errorObj.put(<span class="hljs-string">"code"</span>, <span class="hljs-number">500</span>);
                errorObj.put(<span class="hljs-string">"msg"</span>, <span class="hljs-string">"è°ƒç”¨å¼‚å¸¸ï¼š"</span> + e.getMessage());
            }
            errorObj.put(<span class="hljs-string">"data"</span>, <span class="hljs-literal">null</span>);
            <span class="hljs-keyword">return</span> errorObj.toJSONString();
        }
    }

    <span class="hljs-comment">// æµ‹è¯•ä¸»æ–¹æ³•ï¼ˆæ›¿æ¢ä¸ºå®é™…å›¾ç‰‡è·¯å¾„ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// æœ¬åœ°å›¾ç‰‡ç»å¯¹è·¯å¾„ï¼ˆé¿å…ç›¸å¯¹è·¯å¾„æ­§ä¹‰ï¼‰</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">imagePath</span> <span class="hljs-operator">=</span> <span class="hljs-string">"D:/test_images/test_person.jpg"</span>;
        <span class="hljs-type">String</span> <span class="hljs-variable">detectResult</span> <span class="hljs-operator">=</span> detectSingleImage(imagePath);
        
        <span class="hljs-comment">// æ ¼å¼åŒ–è¾“å‡ºç»“æœï¼Œä¾¿äºé˜…è¯»</span>
        <span class="hljs-type">JSONObject</span> <span class="hljs-variable">resultObj</span> <span class="hljs-operator">=</span> JSON.parseObject(detectResult);
        System.out.println(<span class="hljs-string">"=== Javaè°ƒç”¨YOLO APIæ£€æµ‹ç»“æœ ==="</span>);
        System.out.println(JSON.toJSONString(resultObj, <span class="hljs-literal">true</span>));
    }
}
</code></pre>
<h2 data-id="heading-10">å››ã€è°ƒç”¨è¿‡ç¨‹ä¸­çš„é«˜é¢‘è¸©å‘ç‚¹ &amp; è§£å†³æ–¹æ¡ˆ</h2>
<p>æ—¥å¸¸å¼€å‘ä¸­ï¼Œ80% çš„ API è°ƒç”¨é—®é¢˜é›†ä¸­åœ¨ä»¥ä¸‹åœºæ™¯ï¼Œæå‰è§„é¿å¯å¤§å¹…æå‡å¼€å‘æ•ˆç‡ï¼š</p>









































<table><thead><tr><th>è¸©å‘ç°è±¡</th><th>æ ¸å¿ƒåŸå› </th><th>è§£å†³æ–¹æ¡ˆ</th><th/></tr></thead><tbody><tr><td>400 é”™è¯¯ï¼šâ€œä»…æ”¯æŒ jpg/jpeg/png/bmp æ ¼å¼å›¾ç‰‡â€</td><td>å›¾ç‰‡åç¼€å¤§å°å†™ï¼ˆå¦‚ JPG å†™æˆ jpgï¼‰ã€æ–‡ä»¶å®é™…æ ¼å¼ä¸åç¼€ä¸ç¬¦</td><td>1. ç»Ÿä¸€å°†åç¼€è½¬ä¸ºå°å†™ï¼›2. æ ¡éªŒæ–‡ä»¶é­”æ•°ï¼ˆè€Œéä»…é åç¼€ï¼‰ï¼Œç¡®ä¿æ ¼å¼çœŸå®</td><td/></tr><tr><td>500 é”™è¯¯ï¼šâ€œcannot identify image fileâ€</td><td>å›¾ç‰‡æ–‡ä»¶æŸåã€ä¸Šä¼ æ—¶æµè¯»å–ä¸å®Œæ•´</td><td>1. æ ¡éªŒå›¾ç‰‡å®Œæ•´æ€§ï¼ˆå¯é€šè¿‡ PIL/ImageIO é¢„æ ¡éªŒï¼‰ï¼›2. ä¸Šä¼ æ—¶ç¡®ä¿æ–‡ä»¶æµå®Œæ•´å…³é—­</td><td/></tr><tr><td>è¿æ¥æ‹’ç» / è¶…æ—¶</td><td>API æœåŠ¡æœªå¯åŠ¨ã€ç«¯å£è¢«å ç”¨ã€é˜²ç«å¢™æ‹¦æˆª</td><td>1. ç¡®è®¤æœåŠ¡å·²å¯åŠ¨ï¼ˆæŸ¥çœ‹ uvicorn æ—¥å¿—ï¼‰ï¼›2. æ£€æŸ¥ç«¯å£å ç”¨ï¼ˆWindowsï¼šnetstat -ano</td><td>findstr 8000ï¼‰ï¼›3. æ”¾è¡Œ 8000 ç«¯å£</td></tr><tr><td>Java è°ƒç”¨æŠ¥ â€œno such file or directoryâ€</td><td>ç›¸å¯¹è·¯å¾„æ­§ä¹‰ï¼ˆå·¥ä½œç›®å½•ä¸é¢„æœŸä¸ä¸€è‡´ï¼‰</td><td>å¼ºåˆ¶ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼ˆå¦‚ D:/test.jpgï¼‰ï¼Œé¿å…ç›¸å¯¹è·¯å¾„</td><td/></tr><tr><td>å“åº”ç»“æœä¸ºç©º</td><td>å›¾ç‰‡å°ºå¯¸è¿‡å¤§ï¼ˆè¶…è¿‡ 10MBï¼‰ã€æœåŠ¡ç«¯å¤„ç†è¶…æ—¶</td><td>1. æœåŠ¡ç«¯å¢åŠ å›¾ç‰‡å¤§å°é™åˆ¶é…ç½®ï¼›2. è°ƒç”¨ç«¯å‹ç¼©å›¾ç‰‡åä¸Šä¼ ï¼›3. è°ƒå¤§è¶…æ—¶æ—¶é—´</td><td/></tr></tbody></table>
<h2 data-id="heading-11">äº”ã€ç”Ÿäº§ç¯å¢ƒè¿›é˜¶ä¼˜åŒ–å»ºè®®</h2>
<p>è‹¥éœ€å°†è¯¥ API ç”¨äºç”Ÿäº§ç¯å¢ƒï¼Œéœ€è¡¥å……ä»¥ä¸‹èƒ½åŠ›ï¼Œä¿éšœç¨³å®šæ€§å’Œå®‰å…¨æ€§ï¼š</p>
<ol>
<li><strong>æ¥å£é‰´æƒ</strong>ï¼šæ·»åŠ  API Key/Token æ ¡éªŒï¼ˆå¦‚åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦ X-API-Keyï¼‰ï¼Œé¿å…æ¥å£è¢«æ¶æ„è°ƒç”¨ï¼›</li>
<li><strong>é™æµæ§åˆ¶</strong>ï¼šæœåŠ¡ç«¯é›†æˆ SlowAPI å®ç°æ¥å£é™æµï¼ˆå¦‚å• IP æ¯åˆ†é’Ÿæœ€å¤šè°ƒç”¨ 100 æ¬¡ï¼‰ï¼Œé˜²æ­¢é«˜é¢‘è¯·æ±‚å‹å®æœåŠ¡ï¼›</li>
<li><strong>å¼‚æ­¥å¤„ç†</strong>ï¼šæ‰¹é‡æ£€æµ‹æ¥å£æ”¹ä¸ºå¼‚æ­¥æ¨¡å¼ï¼ˆè¿”å›ä»»åŠ¡ IDï¼Œè½®è¯¢è·å–ç»“æœï¼‰ï¼Œé¿å…é•¿è¿æ¥è¶…æ—¶ï¼›</li>
<li><strong>éƒ¨ç½²ä¼˜åŒ–</strong>ï¼šå°† API æœåŠ¡æ‰“åŒ…ä¸º Docker é•œåƒï¼Œæ–¹ä¾¿è·¨ç¯å¢ƒéƒ¨ç½²ï¼›ä½¿ç”¨ Gunicorn+Uvicorn å¤šè¿›ç¨‹è¿è¡Œï¼Œæå‡å¹¶å‘èƒ½åŠ›ï¼›</li>
<li><strong>ç›‘æ§å‘Šè­¦</strong>ï¼šæ·»åŠ æ¥å£è°ƒç”¨é‡ã€å¤±è´¥ç‡ã€å“åº”æ—¶é—´ç›‘æ§ï¼Œå¼‚å¸¸æ—¶è§¦å‘å‘Šè­¦ï¼ˆå¦‚é’‰é’‰ / ä¼ä¸šå¾®ä¿¡é€šçŸ¥ï¼‰ã€‚</li>
</ol>
<h2 data-id="heading-12">å…­ã€æ€»ç»“</h2>
<ol>
<li>YOLO API è°ƒç”¨çš„æ ¸å¿ƒæ˜¯ â€œæœåŠ¡ç«¯å°è£…æ¨¡å‹ + å®¢æˆ·ç«¯æ ‡å‡†åŒ–è¯·æ±‚â€ï¼ŒPython ç”¨ FastAPI æ­æœåŠ¡ã€requests è°ƒæ¥å£ï¼ŒJava ç”¨ OkHttp è°ƒæ¥å£ï¼Œéƒ½æ˜¯ä½æˆæœ¬ã€æ˜“è½åœ°çš„æ–¹æ¡ˆï¼›</li>
<li>è°ƒç”¨æ—¶é‡ç‚¹å…³æ³¨<strong>æ–‡ä»¶æ ¡éªŒã€è¶…æ—¶æ§åˆ¶ã€å¼‚å¸¸åˆ†ç±»å¤„ç†</strong>ï¼Œå¯é¿å¼€ 90% çš„è°ƒç”¨é—®é¢˜ï¼›</li>
<li>æµ‹è¯•é˜¶æ®µä¼˜å…ˆä½¿ç”¨ FastAPI çš„<code>/docs</code>åœ¨çº¿è°ƒè¯•æ¥å£ï¼Œå¿«é€Ÿå®šä½è¯·æ±‚å‚æ•°ã€æ ¼å¼é—®é¢˜ï¼›</li>
<li>ç”Ÿäº§ç¯å¢ƒéœ€è¡¥å……é‰´æƒã€é™æµã€ç›‘æ§èƒ½åŠ›ï¼Œé¿å…æ¥å£è¢«æ»¥ç”¨æˆ–æ•…éšœæ— æ„ŸçŸ¥ã€‚</li>
</ol>
<p>è¿™å¥—ç¤ºä¾‹ä»£ç å¯ç›´æ¥å¤ç”¨ï¼Œæ— è®ºæ˜¯ Python è¿˜æ˜¯ Java å¼€å‘è€…ï¼Œéƒ½èƒ½åœ¨ 10 åˆ†é’Ÿå†…å®Œæˆ YOLO ç›®æ ‡æ£€æµ‹èƒ½åŠ›çš„é›†æˆï¼Œæ— éœ€å…³æ³¨åº•å±‚çš„ç¯å¢ƒæ­å»ºå’Œæ¨¡å‹æ¨ç†ç»†èŠ‚ï¼Œèšç„¦ä¸šåŠ¡é€»è¾‘å³å¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§æ¨¡å‹è·¯ç”±ç®—æ³•æ·±åº¦è°ƒç ”ï¼šä»åŸç†åˆ°å®è·µ]]></title>    <link>https://juejin.cn/post/7598057199962472499</link>    <guid>https://juejin.cn/post/7598057199962472499</guid>    <pubDate>2026-01-22T13:52:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598057199962472499" data-draft-id="7597805826515468334" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§æ¨¡å‹è·¯ç”±ç®—æ³•æ·±åº¦è°ƒç ”ï¼šä»åŸç†åˆ°å®è·µ"/> <meta itemprop="keywords" content="ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-22T13:52:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Limbo"/> <meta itemprop="url" content="https://juejin.cn/user/3039492249228104"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§æ¨¡å‹è·¯ç”±ç®—æ³•æ·±åº¦è°ƒç ”ï¼šä»åŸç†åˆ°å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3039492249228104/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Limbo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-22T13:52:42.000Z" title="Thu Jan 22 2026 13:52:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    17
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¤§æ¨¡å‹è·¯ç”±ç®—æ³•æ·±åº¦è°ƒç ”ï¼šä»åŸç†åˆ°å®è·µ</h2>
<blockquote>
<p>æ—¥æœŸï¼š2026å¹´1æœˆ | ç±»åˆ«ï¼šAIæŠ€æœ¯</p>
</blockquote>
<h3 data-id="heading-1">å¼•è¨€</h3>
<p>2026å¹´ï¼Œå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„åº”ç”¨å·²ç»æ·±å…¥å„è¡Œå„ä¸šã€‚ç„¶è€Œï¼Œéšä¹‹è€Œæ¥çš„æ˜¯æ—¥ç›Šä¸¥å³»çš„æŒ‘æˆ˜ï¼šå¦‚ä½•åœ¨ä¿è¯è´¨é‡çš„å‰æä¸‹ï¼Œæ§åˆ¶ä¸æ–­æ”€å‡çš„APIè°ƒç”¨æˆæœ¬ï¼Ÿå¦‚ä½•åœ¨ä¼—å¤šæ¨¡å‹ä¸­åšå‡ºæœ€ä¼˜é€‰æ‹©ï¼Ÿ<strong>å¤§æ¨¡å‹è·¯ç”±ç®—æ³•</strong>ï¼ˆLLM Routingï¼‰æ­£æ˜¯è§£å†³è¿™ä¸€é—®é¢˜çš„æ ¸å¿ƒæŠ€æœ¯ã€‚</p>
<p>æœ¬æ–‡åŸºäºå¯¹å›½å†…å¤–æŠ€æœ¯ç¤¾åŒºã€å­¦æœ¯ç ”ç©¶å’Œå¼€æºé¡¹ç›®çš„æ·±å…¥è°ƒç ”ï¼Œç³»ç»Ÿæ€§åœ°ä»‹ç»LLMè·¯ç”±ç®—æ³•çš„åŸç†ã€æŠ€æœ¯å’Œå®è·µï¼Œå¸®åŠ©è¯»è€…å…¨é¢äº†è§£è¿™ä¸€é¢†åŸŸçš„æœ€æ–°è¿›å±•ã€‚</p>
<h3 data-id="heading-2">ä»€ä¹ˆæ˜¯å¤§æ¨¡å‹è·¯ç”±ï¼Ÿ</h3>
<h4 data-id="heading-3">æ ¸å¿ƒæ¦‚å¿µ</h4>
<p><strong>å¤§æ¨¡å‹è·¯ç”±</strong>æ˜¯ä¸€ç§æ™ºèƒ½å†³ç­–æœºåˆ¶ï¼Œå®ƒæ ¹æ®è¯·æ±‚çš„ç‰¹æ€§ï¼ˆå¦‚å¤æ‚åº¦ã€æ„å›¾ã€é¢†åŸŸç­‰ï¼‰åŠ¨æ€é€‰æ‹©æœ€åˆé€‚çš„è¯­è¨€æ¨¡å‹æ¥å¤„ç†ï¼Œä»è€Œåœ¨<strong>æ€§èƒ½ã€æˆæœ¬å’Œå»¶è¿Ÿ</strong>ä¹‹é—´å®ç°æœ€ä¼˜å¹³è¡¡ã€‚</p>
<h4 data-id="heading-4">ä¸ºä»€ä¹ˆéœ€è¦è·¯ç”±ï¼Ÿ</h4>
<pre><code class="hljs language-bash" lang="bash">åœºæ™¯å¯¹æ¯”ï¼š

ä¼ ç»Ÿæ–¹å¼ï¼š
æ‰€æœ‰æŸ¥è¯¢ â†’ GPT-4 â†’ æˆæœ¬ <span class="hljs-variable">$10</span>/å¤©ï¼Œå»¶è¿Ÿ 3s

è·¯ç”±æ–¹å¼ï¼š
ç®€å•æŸ¥è¯¢ï¼ˆ80%ï¼‰â†’ Llama-3-70B â†’ æˆæœ¬ <span class="hljs-variable">$0</span>.1/å¤©ï¼Œå»¶è¿Ÿ 0.5s
å¤æ‚æŸ¥è¯¢ï¼ˆ15%ï¼‰â†’ GPT-3.5 â†’ æˆæœ¬ <span class="hljs-variable">$1</span>/å¤©ï¼Œå»¶è¿Ÿ 1s
å›°éš¾æŸ¥è¯¢ï¼ˆ5%ï¼‰  â†’ GPT-4   â†’ æˆæœ¬ <span class="hljs-variable">$0</span>.5/å¤©ï¼Œå»¶è¿Ÿ 3s
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡ï¼šæˆæœ¬ <span class="hljs-variable">$1</span>.6/å¤©ï¼Œå¹³å‡å»¶è¿Ÿ 0.8s

ç»“æœï¼šæˆæœ¬é™ä½84%ï¼Œå»¶è¿Ÿé™ä½73%
</code></pre>
<h3 data-id="heading-5">è·¯ç”±ç­–ç•¥å…¨æ™¯å›¾</h3>
<h4 data-id="heading-6">ä¸‰å¤§æ ¸å¿ƒç­–ç•¥</h4>





























<table><thead><tr><th>ç­–ç•¥</th><th>å·¥ä½œæ–¹å¼</th><th>é€‚ç”¨åœºæ™¯</th><th>æ•ˆæœ</th></tr></thead><tbody><tr><td><strong>è·¯ç”±ï¼ˆRoutingï¼‰</strong></td><td>æ¯ä¸ªæŸ¥è¯¢é€‰æ‹©ä¸€ä¸ªæœ€ä¼˜æ¨¡å‹</td><td>é€šç”¨åœºæ™¯</td><td>çµæ´»æ€§é«˜</td></tr><tr><td><strong>çº§è”ï¼ˆCascadingï¼‰</strong></td><td>ä»ç®€å•æ¨¡å‹å¼€å§‹ï¼Œé€çº§å‡çº§</td><td>æˆæœ¬æ•æ„Ÿåœºæ™¯</td><td>æˆæœ¬æœ€ä¼˜</td></tr><tr><td><strong>é›†æˆï¼ˆEnsembleï¼‰</strong></td><td>ç»„åˆå¤šä¸ªæ¨¡å‹çš„è¾“å‡º</td><td>è´¨é‡æ•æ„Ÿåœºæ™¯</td><td>è´¨é‡æœ€ä¼˜</td></tr></tbody></table>
<h4 data-id="heading-7">è·¯ç”±æŠ€æœ¯æ¼”è¿›</h4>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">2023: é™æ€è·¯ç”±ï¼ˆåŸºäºè§„åˆ™ï¼‰</span>
        â†“
<span class="hljs-section">2024: åŠ¨æ€è·¯ç”±ï¼ˆåŸºäºMLï¼‰</span>
        â†“
<span class="hljs-section">2025: è¯­ä¹‰è·¯ç”±ï¼ˆåŸºäºEmbeddingï¼‰</span>
        â†“
<span class="hljs-section">2026: æ™ºèƒ½è·¯ç”±ï¼ˆå¤šè½®åè°ƒã€è‡ªé€‚åº”ï¼‰</span>
</code></pre>
<h3 data-id="heading-8">æ ¸å¿ƒæŠ€æœ¯æ·±åº¦è§£æ</h3>
<h4 data-id="heading-9">1. MoEæ··åˆä¸“å®¶æ¨¡å‹</h4>
<p>æ··åˆä¸“å®¶æ¨¡å‹ï¼ˆMixture of Experts, MoEï¼‰æ˜¯æ¨¡å‹å†…éƒ¨çš„è·¯ç”±æŠ€æœ¯ï¼Œé€šè¿‡åœ¨æ¨¡å‹å†…éƒ¨å¼•å…¥å¤šä¸ª"ä¸“å®¶"å­ç½‘ç»œï¼Œå®ç°æ¡ä»¶è®¡ç®—ã€‚</p>
<h5 data-id="heading-10">å·¥ä½œåŸç†</h5>
<pre><code class="hljs language-arduino" lang="arduino">è¾“å…¥: <span class="hljs-string">"å¦‚ä½•ä¿®å¤Pythonä»£ç ï¼Ÿ"</span>
        â†“
    Routerï¼ˆè·¯ç”±å™¨ï¼‰
        â†“
    è®¡ç®—ä¸“å®¶æƒé‡
        â†“
    é€‰æ‹©Top-Kä¸“å®¶
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Expert1  â”‚  Expert2  â”‚  Expert3  â”‚
â”‚  (ä»£ç )   â”‚  (æ•°å­¦)   â”‚  (å†™ä½œ)   â”‚
â”‚  âœ“ æ¿€æ´»   â”‚           â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
    ç»„åˆè¾“å‡º
</code></pre>
<h5 data-id="heading-11">ä»£è¡¨æ€§æˆæœ</h5>
<ul>
<li><strong>Switch Transformer</strong>ï¼ˆGoogleï¼Œ2021ï¼‰ï¼šé¦–ä¸ªä¸‡äº¿å‚æ•°æ¨¡å‹ï¼Œæ¯ä¸ªtokenåªè·¯ç”±åˆ°ä¸€ä¸ªä¸“å®¶</li>
<li><strong>DeepSeek-MoE</strong>ï¼ˆ2024ï¼‰ï¼šç»†ç²’åº¦ä¸“å®¶åˆ†å‰²ï¼Œæ€§èƒ½æ˜¾è‘—æå‡</li>
<li><strong>Mixtral 8x7B</strong>ï¼ˆMistral AIï¼‰ï¼šå¼€æºé«˜æ€§èƒ½MoEæ¨¡å‹</li>
</ul>
<h4 data-id="heading-12">2. è¯­ä¹‰è·¯ç”±æŠ€æœ¯</h4>
<p>è¯­ä¹‰è·¯ç”±åŸºäºå‘é‡åµŒå…¥ï¼ˆEmbeddingï¼‰è®¡ç®—æŸ¥è¯¢ä¸è·¯ç”±çš„è¯­ä¹‰ç›¸ä¼¼åº¦ï¼Œå®ç°å¿«é€Ÿã€å‡†ç¡®çš„å†³ç­–ã€‚</p>
<h5 data-id="heading-13">å·¥ä½œæµç¨‹</h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä¼ªä»£ç ç¤ºä¾‹</span>
query = <span class="hljs-string">"PythonæŠ¥é”™æ€ä¹ˆè§£å†³ï¼Ÿ"</span>
query_embedding = encode(query)  <span class="hljs-comment"># è½¬æ¢ä¸ºå‘é‡</span>

<span class="hljs-comment"># é¢„å®šä¹‰è·¯ç”±</span>
routes = {
    <span class="hljs-string">"code_help"</span>: encode(<span class="hljs-string">"ç¼–ç¨‹ç›¸å…³çš„é—®é¢˜"</span>),
    <span class="hljs-string">"chitchat"</span>: encode(<span class="hljs-string">"æ—¥å¸¸é—²èŠ"</span>),
    <span class="hljs-string">"creative"</span>: encode(<span class="hljs-string">"åˆ›æ„å†™ä½œ"</span>),
}

<span class="hljs-comment"># è®¡ç®—ç›¸ä¼¼åº¦</span>
similarities = {
    route: cosine_similarity(query_embedding, route_emb)
    <span class="hljs-keyword">for</span> route, route_emb <span class="hljs-keyword">in</span> routes.items()
}

<span class="hljs-comment"># é€‰æ‹©æœ€ç›¸ä¼¼çš„è·¯ç”±</span>
best_route = <span class="hljs-built_in">max</span>(similarities.items(), key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">1</span>])
<span class="hljs-comment"># â†’ "code_help"</span>
</code></pre>
<h5 data-id="heading-14">ä¼˜åŠ¿å¯¹æ¯”</h5>





























<table><thead><tr><th>ç»´åº¦</th><th>è§„åˆ™è·¯ç”±</th><th>LLMåˆ†ç±»è·¯ç”±</th><th>è¯­ä¹‰è·¯ç”±</th></tr></thead><tbody><tr><td>é€Ÿåº¦</td><td>â­â­â­â­â­</td><td>â­â­</td><td>â­â­â­â­</td></tr><tr><td>å‡†ç¡®æ€§</td><td>â­â­</td><td>â­â­â­â­â­</td><td>â­â­â­â­</td></tr><tr><td>ç»´æŠ¤æˆæœ¬</td><td>â­â­</td><td>â­â­â­â­</td><td>â­â­â­</td></tr></tbody></table>
<h4 data-id="heading-15">3. çº§è”è·¯ç”±ä¸é›†æˆ</h4>
<h5 data-id="heading-16">çº§è”è·¯ç”±å®ç°æˆæœ¬ä¼˜åŒ–</h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">cascading_router</span>(<span class="hljs-params">query</span>):
    <span class="hljs-comment"># ç¬¬ä¸€çº§ï¼šæœ¬åœ°å°æ¨¡å‹ï¼ˆå‡ ä¹é›¶æˆæœ¬ï¼‰</span>
    result = llama_3_8b.generate(query)
    <span class="hljs-keyword">if</span> evaluate_quality(result) &gt; <span class="hljs-number">0.8</span>:
        <span class="hljs-keyword">return</span> result  <span class="hljs-comment"># 80%çš„æŸ¥è¯¢åœ¨è¿™é‡Œå°±è§£å†³äº†</span>

    <span class="hljs-comment"># ç¬¬äºŒçº§ï¼šä¸­ç­‰æ¨¡å‹</span>
    result = gpt_35.generate(query)
    <span class="hljs-keyword">if</span> evaluate_quality(result) &gt; <span class="hljs-number">0.9</span>:
        <span class="hljs-keyword">return</span> result  <span class="hljs-comment"># 15%çš„æŸ¥è¯¢åœ¨è¿™é‡Œè§£å†³</span>

    <span class="hljs-comment"># ç¬¬ä¸‰çº§ï¼šæœ€å¼ºæ¨¡å‹ï¼ˆåªå¤„ç†æœ€éš¾çš„5%ï¼‰</span>
    <span class="hljs-keyword">return</span> gpt_4.generate(query)
</code></pre>
<h5 data-id="heading-17">é›†æˆæŠ€æœ¯æå‡è´¨é‡</h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">ensemble_router</span>(<span class="hljs-params">query</span>):
    <span class="hljs-comment"># å¤šä¸ªæ¨¡å‹å¹¶è¡Œç”Ÿæˆ</span>
    results = {
        <span class="hljs-string">"gpt-4"</span>: gpt_4.generate(query),
        <span class="hljs-string">"claude-3"</span>: claude_3.generate(query),
        <span class="hljs-string">"gemini"</span>: gemini.generate(query)
    }

    <span class="hljs-comment"># ç­–ç•¥1: æŠ•ç¥¨é€‰æ‹©</span>
    <span class="hljs-comment"># ç­–ç•¥2: åŠ æƒç»„åˆ</span>
    <span class="hljs-comment"># ç­–ç•¥3: ä½¿ç”¨å…ƒæ¨¡å‹ç»¼åˆ</span>

    <span class="hljs-keyword">return</span> meta_model.synthesize(results)
</code></pre>
<h3 data-id="heading-18">è¯„ä¼°ä¸åŸºå‡†æµ‹è¯•</h3>
<h4 data-id="heading-19">LLMRouterBench - 2026å¹´æœ€å¤§è§„æ¨¡åŸºå‡†</h4>
<ul>
<li><strong>è§„æ¨¡</strong>ï¼š400,000+å®ä¾‹ã€21ä¸ªæ•°æ®é›†ã€33ä¸ªæ¨¡å‹</li>
<li><strong>è¯„ä¼°ç»´åº¦</strong>ï¼š
<ul>
<li>æ€§èƒ½å¯¼å‘è·¯ç”±</li>
<li>æ€§èƒ½-æˆæœ¬æƒè¡¡è·¯ç”±</li>
</ul>
</li>
</ul>
<h4 data-id="heading-20">å…³é”®è¯„ä¼°æŒ‡æ ‡</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æˆæœ¬èŠ‚çœç‡</span>
cost_saving = (baseline_cost - actual_cost) / baseline_cost

<span class="hljs-comment"># è´¨é‡-æˆæœ¬æ¯”</span>
quality_cost_ratio = avg_quality / avg_cost

<span class="hljs-comment"># å»¶è¿Ÿæ»¡è¶³ç‡</span>
latency_satisfaction = satisfied_requests / total_requests
</code></pre>
<h3 data-id="heading-21">å¼€æºæ¡†æ¶æ¨è</h3>
<h4 data-id="heading-22">1. RouteLLM â­â­â­â­â­</h4>
<ul>
<li><strong>å¼€å‘è€…</strong>ï¼šLM-SYSï¼ˆChatbot Arenaå›¢é˜Ÿï¼‰+ UC Berkeley</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šåŸºäºåå¥½æ•°æ®å­¦ä¹ ï¼Œæˆæœ¬ä¼˜åŒ–</li>
<li><strong>é€‚ç”¨</strong>ï¼šç”Ÿäº§ç¯å¢ƒæˆæœ¬ä¼˜åŒ–</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">pip install routellm
</code></pre>
<h4 data-id="heading-23">2. Semantic Router â­â­â­â­</h4>
<ul>
<li><strong>å¼€å‘è€…</strong>ï¼šAurelio AI</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šè¯­ä¹‰ç›¸ä¼¼åº¦è·¯ç”±ï¼Œè¶…å¿«å†³ç­–</li>
<li><strong>é€‚ç”¨</strong>ï¼šæ„å›¾è¯†åˆ«ã€å¿«é€ŸåŸå‹</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">pip install semantic-router
</code></pre>
<h4 data-id="heading-24">3. LiteLLM â­â­â­â­â­</h4>
<ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼šç»Ÿä¸€æ¥å£ã€è´Ÿè½½å‡è¡¡ã€æ•…éšœè½¬ç§»</li>
<li><strong>é€‚ç”¨</strong>ï¼šå¤šæ¨¡å‹ç»Ÿä¸€è°ƒç”¨ã€ä¼ä¸šçº§éƒ¨ç½²</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">pip install litellm
</code></pre>
<h4 data-id="heading-25">4. vLLM Router â­â­â­â­</h4>
<ul>
<li><strong>å¼€å‘è€…</strong>ï¼švLLMå›¢é˜Ÿ</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼šé«˜æ€§èƒ½ã€Prefill/Decodeé˜¶æ®µæ„ŸçŸ¥</li>
<li><strong>é€‚ç”¨</strong>ï¼šå¤§è§„æ¨¡æ¨ç†æœåŠ¡</li>
</ul>
<h3 data-id="heading-26">å®è·µæ¡ˆä¾‹ä¸æ•ˆæœ</h3>
<h4 data-id="heading-27">æ¡ˆä¾‹1ï¼šæ™ºèƒ½å®¢æœç³»ç»Ÿ</h4>
<p><strong>æŒ‘æˆ˜</strong>ï¼šå®¢æœå’¨è¯¢é‡å·¨å¤§ï¼ŒAPIæˆæœ¬é«˜æ˜‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>ç®€å•é—®é¢˜ï¼ˆ60%ï¼‰â†’ æœ¬åœ°Llama-3-8B</li>
<li>ä¸­ç­‰é—®é¢˜ï¼ˆ30%ï¼‰â†’ GPT-3.5-turbo</li>
<li>å¤æ‚é—®é¢˜ï¼ˆ10%ï¼‰â†’ GPT-4</li>
</ul>
<p><strong>æ•ˆæœ</strong>ï¼š</p>
<ul>
<li>æˆæœ¬é™ä½ï¼š<strong>75%</strong></li>
<li>å¹³å‡å»¶è¿Ÿï¼šä»3.2sé™è‡³1.1s</li>
<li>ç”¨æˆ·æ»¡æ„åº¦ï¼šä»90%æå‡è‡³92%</li>
</ul>
<h4 data-id="heading-28">æ¡ˆä¾‹2ï¼šä»£ç åŠ©æ‰‹</h4>
<p><strong>æŒ‘æˆ˜</strong>ï¼šä»£ç ç”Ÿæˆéœ€è¦é«˜è´¨é‡ï¼Œä½†æˆæœ¬æ•æ„Ÿ</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>çº§è”è·¯ç”± + è¯­ä¹‰è·¯ç”±ç»„åˆ</li>
<li>ä»£ç ç›¸å…³æŸ¥è¯¢â†’ ä»£ç ä¸“ç”¨æ¨¡å‹</li>
<li>å…¶ä»–æŸ¥è¯¢ â†’ é€šç”¨æ¨¡å‹</li>
</ul>
<p><strong>æ•ˆæœ</strong>ï¼š</p>
<ul>
<li>æˆæœ¬é™ä½ï¼š<strong>60%</strong></li>
<li>ä»£ç è´¨é‡ï¼šæå‡15%</li>
</ul>
<h4 data-id="heading-29">æ¡ˆä¾‹3ï¼šå†…å®¹åˆ›ä½œå¹³å°</h4>
<p><strong>æŒ‘æˆ˜</strong>ï¼šä¸åŒåˆ›ä½œä»»åŠ¡éœ€è¦ä¸åŒé£æ ¼æ¨¡å‹</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>åˆ›æ„å†™ä½œ â†’ Claude-3-Opusï¼ˆåˆ›æ„æ€§å¼ºï¼‰</li>
<li>æŠ€æœ¯å†™ä½œ â†’ GPT-4ï¼ˆå‡†ç¡®æ€§é«˜ï¼‰</li>
<li>è¥é”€æ–‡æ¡ˆ â†’ Geminiï¼ˆå•†ä¸šæ„Ÿå¼ºï¼‰</li>
</ul>
<p><strong>æ•ˆæœ</strong>ï¼š</p>
<ul>
<li>ç”¨æˆ·æ»¡æ„åº¦ï¼šæå‡25%</li>
<li>å†…å®¹è´¨é‡ï¼šæå‡20%</li>
</ul>
<h3 data-id="heading-30">å‰æ²¿ç ”ç©¶æ–¹å‘</h3>
<h4 data-id="heading-31">1. ä¸ªæ€§åŒ–è·¯ç”±ï¼ˆ2026ï¼‰</h4>
<p>UIUCå›¢é˜Ÿæå‡º<strong>PersonalizedRouter</strong>ï¼Œå­¦ä¹ ç”¨æˆ·éšè—åå¥½ï¼Œå®ç°"åƒäººåƒé¢"çš„ç²¾å‡†è·¯ç”±ã€‚</p>
<h4 data-id="heading-32">2. å¤šè½®åè°ƒè·¯ç”±</h4>
<p><strong>Router-R1</strong>è®©è·¯ç”±å™¨ä»"å•ä¸€å›ç­”è€…"è¿›åŒ–ä¸º"å¤šæ™ºèƒ½ä½“åè°ƒè€…"ï¼Œæ”¯æŒè¿­ä»£å¼è·¯ç”±å†³ç­–ã€‚</p>
<h4 data-id="heading-33">3. å› æœæ¨æ–­è·¯ç”±</h4>
<p>ç ”ç©¶è·¯ç”±å†³ç­–çš„å› æœå½±å“ï¼Œé¿å…è™šå‡ç›¸å…³æ€§ã€‚</p>
<h4 data-id="heading-34">4. è”é‚¦å­¦ä¹ è·¯ç”±</h4>
<p>åœ¨ä¿æŠ¤éšç§çš„å‰æä¸‹ï¼Œå®ç°åˆ†å¸ƒå¼è·¯ç”±å­¦ä¹ ã€‚</p>
<h3 data-id="heading-35">å¿«é€Ÿä¸Šæ‰‹æŒ‡å—</h3>
<h4 data-id="heading-36">5åˆ†é’Ÿå®ç°è¯­ä¹‰è·¯ç”±</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å®‰è£…</span>
pip install semantic-router

<span class="hljs-comment"># ä»£ç </span>
<span class="hljs-keyword">from</span> semantic_router <span class="hljs-keyword">import</span> Route, SemanticRouter
<span class="hljs-keyword">from</span> semantic_router.encoders <span class="hljs-keyword">import</span> OpenAIEncoder

<span class="hljs-comment"># å®šä¹‰è·¯ç”±</span>
routes = [
    Route(name=<span class="hljs-string">"tech"</span>, utterances=[<span class="hljs-string">"ä»£ç "</span>, <span class="hljs-string">"bug"</span>, <span class="hljs-string">"ç¼–ç¨‹"</span>]),
    Route(name=<span class="hljs-string">"creative"</span>, utterances=[<span class="hljs-string">"æ•…äº‹"</span>, <span class="hljs-string">"è¯—æ­Œ"</span>, <span class="hljs-string">"åˆ›ä½œ"</span>]),
]

<span class="hljs-comment"># åˆ›å»ºè·¯ç”±å™¨</span>
router = SemanticRouter(
    encoder=OpenAIEncoder(),
    routes=routes,
    threshold=<span class="hljs-number">0.7</span>
)

<span class="hljs-comment"># ä½¿ç”¨</span>
decision = router(<span class="hljs-string">"æ€ä¹ˆä¿®å¤è¿™ä¸ªbugï¼Ÿ"</span>)
<span class="hljs-built_in">print</span>(decision.name)  <span class="hljs-comment"># "tech"</span>
</code></pre>
<h4 data-id="heading-37">ç”Ÿäº§éƒ¨ç½²æ£€æŸ¥æ¸…å•</h4>
<pre><code class="hljs language-css" lang="css">â–¡ è·¯ç”±é€»è¾‘æµ‹è¯•é€šè¿‡
â–¡ æˆæœ¬é¢„ç®—è®¾ç½®åˆç†
â–¡ æ•…éšœè½¬ç§»é…ç½®æ­£ç¡®
â–¡ ç›‘æ§æŒ‡æ ‡å·²é…ç½®
â–¡ æ—¥å¿—è®°å½•å®Œæ•´
â–¡ å‘Šè­¦è§„åˆ™å·²è®¾ç½®
â–¡ <span class="hljs-selector-tag">A</span>/<span class="hljs-selector-tag">B</span>æµ‹è¯•è®¡åˆ’å°±ç»ª
â–¡ ç°åº¦å‘å¸ƒç­–ç•¥ç¡®å®š
</code></pre>
<h3 data-id="heading-38">å¸¸è§é—®é¢˜è§£ç­”</h3>
<p><strong>Q1ï¼šè·¯ç”±å†³ç­–éœ€è¦å¤šé•¿æ—¶é—´ï¼Ÿ</strong></p>
<p>Aï¼šè¯­ä¹‰è·¯ç”±é€šå¸¸&lt;50msï¼Œè§„åˆ™è·¯ç”±&lt;10msã€‚ç›¸æ¯”æ¨¡å‹æ¨ç†ï¼ˆ1-3sï¼‰ï¼Œè·¯ç”±å¼€é”€å¯å¿½ç•¥ä¸è®¡ã€‚</p>
<p><strong>Q2ï¼šå¦‚ä½•å¤„ç†è·¯ç”±é”™è¯¯ï¼Ÿ</strong></p>
<p>Aï¼šè®¾ç½®è´¨é‡è¯„ä¼°å™¨ï¼Œä¸æ»¡æ„æ—¶è‡ªåŠ¨å‡çº§æ¨¡å‹ï¼›åŒæ—¶è®°å½•é”™è¯¯æ¡ˆä¾‹ç”¨äºä¼˜åŒ–ã€‚</p>
<p><strong>Q3ï¼šå°å›¢é˜Ÿéœ€è¦è·¯ç”±å—ï¼Ÿ</strong></p>
<p>Aï¼šéœ€è¦ï¼å³ä½¿åªæœ‰2ä¸ªæ¨¡å‹ï¼ˆå¦‚GPT-4å’ŒGPT-3.5ï¼‰ï¼Œè·¯ç”±ä¹Ÿèƒ½èŠ‚çœ50%ä»¥ä¸Šæˆæœ¬ã€‚</p>
<p><strong>Q4ï¼šå¼€æºæ¨¡å‹èƒ½ç”¨äºç”Ÿäº§å—ï¼Ÿ</strong></p>
<p>Aï¼šå®Œå…¨å¯ä»¥ã€‚Llama-3-70Bã€Mixtral 8x7Bç­‰å¼€æºæ¨¡å‹æ€§èƒ½å¼ºåŠ²ï¼Œä¸”æˆæœ¬å‡ ä¹ä¸ºé›¶ã€‚</p>
<h3 data-id="heading-39">èµ„æºæ±‡æ€»</h3>
<h4 data-id="heading-40">å­¦æœ¯è®ºæ–‡</h4>
<ol>
<li>RouteLLM: Learning to Route LLMs with Preference Data (ICLR 2025)</li>
<li>A Survey on Routing Strategies for Resource Optimisation (arXiv, 2025)</li>
</ol>
<h4 data-id="heading-41">å¼€æºé¡¹ç›®</h4>
<ol>
<li><strong>RouteLLM</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flm-sys%2FRouteLLM" target="_blank" title="https://github.com/lm-sys/RouteLLM" ref="nofollow noopener noreferrer">github.com/lm-sys/Routâ€¦</a></li>
<li><strong>Semantic Router</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Faurelio-labs%2Fsemantic-router" target="_blank" title="https://github.com/aurelio-labs/semantic-router" ref="nofollow noopener noreferrer">github.com/aurelio-labâ€¦</a></li>
<li><strong>LiteLLM</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FBerriAI%2Flitellm" target="_blank" title="https://github.com/BerriAI/litellm" ref="nofollow noopener noreferrer">github.com/BerriAI/litâ€¦</a></li>
<li><strong>vLLM</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvllm-project%2Fvllm" target="_blank" title="https://github.com/vllm-project/vllm" ref="nofollow noopener noreferrer">github.com/vllm-projecâ€¦</a></li>
</ol>
<h3 data-id="heading-42">æ€»ç»“ä¸å±•æœ›</h3>
<p>å¤§æ¨¡å‹è·¯ç”±ç®—æ³•å·²ç»ä»ç®€å•çš„è§„åˆ™åŒ¹é…å‘å±•åˆ°ä»Šå¤©åŸºäºæ·±åº¦å­¦ä¹ çš„æ™ºèƒ½å†³ç­–ç³»ç»Ÿã€‚2026å¹´çš„è¶‹åŠ¿æ˜¾ç¤ºï¼š</p>
<ol>
<li><strong>ä»å•ä¸€å†³ç­–åˆ°å¤šè½®åè°ƒ</strong>ï¼šè·¯ç”±å™¨ä¸å†æ˜¯ç®€å•çš„é€‰æ‹©å™¨ï¼Œè€Œæ˜¯å¤šæ™ºèƒ½ä½“çš„åè°ƒè€…</li>
<li><strong>ä»é€šç”¨åˆ°ä¸ªæ€§åŒ–</strong>ï¼šæ¯ä¸ªç”¨æˆ·éƒ½èƒ½è·å¾—å®šåˆ¶åŒ–çš„è·¯ç”±ç­–ç•¥</li>
<li><strong>ä»æˆæœ¬é©±åŠ¨åˆ°è´¨é‡-æˆæœ¬å¹³è¡¡</strong>ï¼šæ›´ç²¾ç»†çš„å¸•ç´¯æ‰˜æœ€ä¼˜è§£</li>
</ol>
<p>å¯¹äºä¼ä¸šå’Œå¼€å‘è€…æ¥è¯´ï¼Œç°åœ¨æ­£æ˜¯æ‹¥æŠ±LLMè·¯ç”±æŠ€æœ¯çš„æœ€ä½³æ—¶æœºã€‚é€šè¿‡åˆç†çš„è·¯ç”±ç­–ç•¥ï¼Œå¯ä»¥æ˜¾è‘—é™ä½æˆæœ¬ã€æå‡æ€§èƒ½ã€æ”¹å–„ç”¨æˆ·ä½“éªŒã€‚</p>
<p><strong>ç‰ˆæƒå£°æ˜</strong>ï¼šæœ¬æ–‡å†…å®¹åŸºäºå…¬å¼€èµ„æ–™æ•´ç†ï¼Œéµå¾ªçŸ¥è¯†å…±äº«åè®®ã€‚æ¬¢è¿è½¬è½½ï¼Œè¯·æ³¨æ˜å‡ºå¤„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MCP å…¥é—¨æ•™ç¨‹ï¼šç”¨ HTTP æ–¹å¼æ„å»º AI å·¥å…·æœåŠ¡]]></title>    <link>https://juejin.cn/post/7598203055746875444</link>    <guid>https://juejin.cn/post/7598203055746875444</guid>    <pubDate>2026-01-22T15:09:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598203055746875444" data-draft-id="7598203055746859060" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" MCP å…¥é—¨æ•™ç¨‹ï¼šç”¨ HTTP æ–¹å¼æ„å»º AI å·¥å…·æœåŠ¡"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯"/> <meta itemprop="datePublished" content="2026-01-22T15:09:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="kevinIcoding"/> <meta itemprop="url" content="https://juejin.cn/user/400700903005726"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             MCP å…¥é—¨æ•™ç¨‹ï¼šç”¨ HTTP æ–¹å¼æ„å»º AI å·¥å…·æœåŠ¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/400700903005726/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    kevinIcoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-22T15:09:51.000Z" title="Thu Jan 22 2026 15:09:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡åŸºäºå®æˆ˜é¡¹ç›®ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ ç”¨ Model Context Protocol (MCP) æ„å»ºä¸€ä¸ªå¤©æ°”æŸ¥è¯¢æœåŠ¡ï¼Œè®©å¤§æ¨¡å‹èƒ½å¤Ÿè°ƒç”¨ä½ çš„å·¥å…·ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ä»€ä¹ˆæ˜¯ MCPï¼Ÿ</h2>
<p><strong>MCP (Model Context Protocol)</strong> æ˜¯ä¸€ä¸ªå¼€æ”¾åè®®ï¼Œç”¨äºæ ‡å‡†åŒ– AI åº”ç”¨ä¸å¤–éƒ¨å·¥å…·çš„è¿æ¥æ–¹å¼ã€‚</p>
<p>ç®€å•ç†è§£ï¼š<strong>MCP å°±æ˜¯ AI è°ƒç”¨å·¥å…·çš„"USB æ¥å£"</strong>ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      MCP åè®®       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å¤§æ¨¡å‹    â”‚  â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  â”‚  ä½ çš„å·¥å…·   â”‚
â”‚  (GPT/GLM)  â”‚                     â”‚ (å¤©æ°”/æœç´¢) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-1">MCP çš„ä¸‰å¤§èƒ½åŠ›</h3>

























<table><thead><tr><th>èƒ½åŠ›</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><strong>Resources</strong></td><td>æä¾›æ•°æ®èµ„æº</td><td>å¤©æ°”æ•°æ®ã€æ–‡æ¡£å†…å®¹</td></tr><tr><td><strong>Tools</strong></td><td>æä¾›å¯è°ƒç”¨çš„å·¥å…·</td><td>æŸ¥è¯¢å¤©æ°”ã€å‘é€é‚®ä»¶</td></tr><tr><td><strong>Prompts</strong></td><td>æä¾›æç¤ºæ¨¡æ¿</td><td>åˆ†ææŠ¥å‘Šæ¨¡æ¿</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-2">é¡¹ç›®ç»“æ„</h2>
<pre><code class="hljs language-bash" lang="bash">MCP_LLM/
â”œâ”€â”€ WeatherMCPServer/
â”‚   â”œâ”€â”€ index.js          <span class="hljs-comment"># MCP æœåŠ¡æ ¸å¿ƒï¼ˆå®šä¹‰èƒ½åŠ›ï¼‰</span>
â”‚   â””â”€â”€ mock.js           <span class="hljs-comment"># æ¨¡æ‹Ÿå¤©æ°”æ•°æ®</span>
â”œâ”€â”€ MCPServer/
â”‚   â””â”€â”€ http.js           <span class="hljs-comment"># HTTP ä¼ è¾“å±‚ï¼ˆæš´éœ²æ¥å£ï¼‰</span>
â”œâ”€â”€ MCPClient/
â”‚   â””â”€â”€ http_client.js    <span class="hljs-comment"># å®¢æˆ·ç«¯ï¼ˆè¿æ¥æœåŠ¡ï¼‰</span>
â””â”€â”€ chat.js               <span class="hljs-comment"># ä¸å¤§æ¨¡å‹é›†æˆ</span>
</code></pre>
<hr/>
<h2 data-id="heading-3">ç¬¬ä¸€æ­¥ï¼šåˆ›å»º MCP æœåŠ¡</h2>
<h3 data-id="heading-4">1.1 å®šä¹‰æœåŠ¡èƒ½åŠ›</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// WeatherMCPServer/index.js</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Server</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/server/index.js"</span>;
<span class="hljs-keyword">import</span> {
  <span class="hljs-title class_">ListToolsRequestSchema</span>,
  <span class="hljs-title class_">CallToolRequestSchema</span>,
} <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/types.js"</span>;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">WeatherServer</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// åˆ›å»º MCP æœåŠ¡å™¨ï¼Œå£°æ˜æ”¯æŒçš„èƒ½åŠ›</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">server</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(
      { <span class="hljs-attr">name</span>: <span class="hljs-string">"mcp-weather-server"</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">"0.0.1"</span> },
      { <span class="hljs-attr">capabilities</span>: { <span class="hljs-attr">tools</span>: {} } }, <span class="hljs-comment">// å£°æ˜æ”¯æŒ tools èƒ½åŠ›</span>
    );
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupToolHandlers</span>();
  }

  <span class="hljs-title function_">setupToolHandlers</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// 1. å‘Šè¯‰å®¢æˆ·ç«¯"æˆ‘æœ‰å“ªäº›å·¥å…·"</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">server</span>.<span class="hljs-title function_">setRequestHandler</span>(<span class="hljs-title class_">ListToolsRequestSchema</span>, <span class="hljs-keyword">async</span> () =&gt; ({
      <span class="hljs-attr">tools</span>: [
        {
          <span class="hljs-attr">name</span>: <span class="hljs-string">"query_weather"</span>,
          <span class="hljs-attr">description</span>: <span class="hljs-string">"æŸ¥è¯¢ç‰¹å®šåœ°ç‚¹çš„å¤©æ°”ä¿¡æ¯"</span>,
          <span class="hljs-attr">inputSchema</span>: {
            <span class="hljs-attr">type</span>: <span class="hljs-string">"object"</span>,
            <span class="hljs-attr">properties</span>: {
              <span class="hljs-attr">location</span>: {
                <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span>,
                <span class="hljs-attr">description</span>: <span class="hljs-string">"åœ°ç‚¹ï¼ˆå¦‚ï¼šbeijing, shanghaiï¼‰"</span>,
              },
            },
            <span class="hljs-attr">required</span>: [<span class="hljs-string">"location"</span>],
          },
        },
      ],
    }));

    <span class="hljs-comment">// 2. å¤„ç†å·¥å…·è°ƒç”¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">server</span>.<span class="hljs-title function_">setRequestHandler</span>(<span class="hljs-title class_">CallToolRequestSchema</span>, <span class="hljs-keyword">async</span> (request) =&gt; {
      <span class="hljs-keyword">if</span> (request.<span class="hljs-property">params</span>.<span class="hljs-property">name</span> === <span class="hljs-string">"query_weather"</span>) {
        <span class="hljs-keyword">const</span> location = request.<span class="hljs-property">params</span>.<span class="hljs-property">arguments</span>?.<span class="hljs-property">location</span>;
        <span class="hljs-comment">// è¿™é‡Œå¯ä»¥è°ƒç”¨çœŸå®çš„å¤©æ°” API</span>
        <span class="hljs-keyword">return</span> {
          <span class="hljs-attr">content</span>: [
            {
              <span class="hljs-attr">type</span>: <span class="hljs-string">"text"</span>,
              <span class="hljs-attr">text</span>: <span class="hljs-string">`<span class="hljs-subst">${location}</span>ï¼šæ™´ï¼Œ25Â°Cï¼Œæ¹¿åº¦ 45%`</span>,
            },
          ],
        };
      }
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"æœªçŸ¥å·¥å…·"</span>);
    });
  }

  <span class="hljs-title function_">getServer</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">server</span>;
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">WeatherServer</span>;
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li><code>Server</code> æ„é€ æ—¶å£°æ˜ <code>capabilities</code>ï¼Œè¡¨ç¤ºæ”¯æŒå“ªäº›èƒ½åŠ›</li>
<li><code>setRequestHandler</code> æ³¨å†Œå¤„ç†å™¨ï¼Œå“åº”å®¢æˆ·ç«¯è¯·æ±‚</li>
<li><code>ListToolsRequestSchema</code> â†’ è¿”å›å·¥å…·åˆ—è¡¨</li>
<li><code>CallToolRequestSchema</code> â†’ æ‰§è¡Œå·¥å…·è°ƒç”¨</li>
</ul>
<hr/>
<h3 data-id="heading-5">1.2 æš´éœ² HTTP æ¥å£</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// MCPServer/http.js</span>
<span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">"express"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">StreamableHTTPServerTransport</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/server/streamableHttp.js"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">WeatherServer</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"../WeatherMCPServer/index.js"</span>;

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();
app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>());

<span class="hljs-keyword">const</span> weatherServer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeatherServer</span>();

<span class="hljs-comment">// æ ¸å¿ƒï¼šPOST /mcp å¤„ç†æ‰€æœ‰ MCP è¯·æ±‚</span>
app.<span class="hljs-title function_">post</span>(<span class="hljs-string">"/mcp"</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> server = weatherServer.<span class="hljs-title function_">getServer</span>();

    <span class="hljs-comment">// æ¯ä¸ªè¯·æ±‚åˆ›å»ºç‹¬ç«‹çš„ä¼ è¾“å®ä¾‹ï¼ˆæ— çŠ¶æ€æ¨¡å¼ï¼‰</span>
    <span class="hljs-keyword">const</span> transport = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StreamableHTTPServerTransport</span>({
      <span class="hljs-attr">sessionIdGenerator</span>: <span class="hljs-literal">undefined</span>, <span class="hljs-comment">// ä¸ç»´æŠ¤ä¼šè¯</span>
    });

    <span class="hljs-comment">// è¯·æ±‚ç»“æŸæ—¶æ¸…ç†èµ„æº</span>
    res.<span class="hljs-title function_">on</span>(<span class="hljs-string">"close"</span>, <span class="hljs-function">() =&gt;</span> {
      transport.<span class="hljs-title function_">close</span>();
      server.<span class="hljs-title function_">close</span>();
    });

    <span class="hljs-comment">// è¿æ¥ MCP æœåŠ¡å™¨ä¸ä¼ è¾“å±‚</span>
    <span class="hljs-keyword">await</span> server.<span class="hljs-title function_">connect</span>(transport);

    <span class="hljs-comment">// å¤„ç†è¯·æ±‚å¹¶è¿”å›å“åº”</span>
    <span class="hljs-keyword">await</span> transport.<span class="hljs-title function_">handleRequest</span>(req, res, req.<span class="hljs-property">body</span>);
  } <span class="hljs-keyword">catch</span> (error) {
    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">json</span>({
      <span class="hljs-attr">jsonrpc</span>: <span class="hljs-string">"2.0"</span>,
      <span class="hljs-attr">error</span>: { <span class="hljs-attr">code</span>: -<span class="hljs-number">32603</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"æœåŠ¡å™¨é”™è¯¯"</span> },
      <span class="hljs-attr">id</span>: <span class="hljs-literal">null</span>,
    });
  }
});

app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3200</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"MCP HTTP æœåŠ¡å·²å¯åŠ¨: http://localhost:3200/mcp"</span>);
});
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆæ¯æ¬¡è¯·æ±‚éƒ½åˆ›å»ºæ–°çš„ transportï¼Ÿ</strong></p>
<ul>
<li><strong>éš”ç¦»æ€§</strong>ï¼šé¿å…å¹¶å‘è¯·æ±‚çš„ ID å†²çª</li>
<li><strong>æ— çŠ¶æ€</strong>ï¼šé€‚åˆè´Ÿè½½å‡è¡¡å’Œæ°´å¹³æ‰©å±•</li>
<li><strong>èµ„æºæ¸…ç†</strong>ï¼šè¯·æ±‚ç»“æŸè‡ªåŠ¨é‡Šæ”¾</li>
</ul>
<hr/>
<h2 data-id="heading-6">ç¬¬äºŒæ­¥ï¼šåˆ›å»ºå®¢æˆ·ç«¯</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// MCPClient/http_client.js</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Client</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/client/index.js"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">StreamableHTTPClientTransport</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/client/streamableHttp.js"</span>;

<span class="hljs-comment">// åˆ›å»ºå®¢æˆ·ç«¯</span>
<span class="hljs-keyword">const</span> client = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Client</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">"weather-http-client"</span>,
  <span class="hljs-attr">version</span>: <span class="hljs-string">"1.0.0"</span>,
});

<span class="hljs-comment">// è¿æ¥åˆ° MCP æœåŠ¡</span>
<span class="hljs-keyword">const</span> transport = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StreamableHTTPClientTransport</span>(
  <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(<span class="hljs-string">"http://localhost:3200/mcp"</span>),
);
<span class="hljs-keyword">await</span> client.<span class="hljs-title function_">connect</span>(transport);

<span class="hljs-comment">// ç°åœ¨å¯ä»¥è°ƒç”¨ MCP èƒ½åŠ›äº†ï¼</span>
<span class="hljs-keyword">const</span> tools = <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">listTools</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å¯ç”¨å·¥å…·:"</span>, tools);

<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> client.<span class="hljs-title function_">callTool</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">"query_weather"</span>,
  <span class="hljs-attr">arguments</span>: { <span class="hljs-attr">location</span>: <span class="hljs-string">"beijing"</span> },
});
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æŸ¥è¯¢ç»“æœ:"</span>, result);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> client;
</code></pre>
<hr/>
<h2 data-id="heading-7">ç¬¬ä¸‰æ­¥ï¼šä¸å¤§æ¨¡å‹é›†æˆ</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// chat.js</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ZhipuAI</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"zhipu-sdk-js"</span>;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">runConversation</span>(<span class="hljs-params">mcpClient</span>) {
  <span class="hljs-keyword">const</span> userMessage = <span class="hljs-string">"åŒ—äº¬ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"</span>;

  <span class="hljs-comment">// 1. ä» MCP è·å–å¯ç”¨å·¥å…·</span>
  <span class="hljs-keyword">const</span> mcpTools = <span class="hljs-keyword">await</span> mcpClient.<span class="hljs-title function_">listTools</span>();
  <span class="hljs-keyword">const</span> tools = mcpTools.<span class="hljs-property">tools</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">tool</span>) =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"function"</span>,
    <span class="hljs-attr">function</span>: {
      <span class="hljs-attr">name</span>: tool.<span class="hljs-property">name</span>,
      <span class="hljs-attr">description</span>: tool.<span class="hljs-property">description</span>,
      <span class="hljs-attr">parameters</span>: tool.<span class="hljs-property">inputSchema</span>,
    },
  }));

  <span class="hljs-comment">// 2. å‘é€ç»™å¤§æ¨¡å‹ï¼Œè®©å®ƒå†³å®šæ˜¯å¦è°ƒç”¨å·¥å…·</span>
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> zhipuClient.<span class="hljs-title function_">createCompletions</span>({
    <span class="hljs-attr">model</span>: <span class="hljs-string">"glm-4.5-flash"</span>,
    <span class="hljs-attr">messages</span>: [{ <span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span>, <span class="hljs-attr">content</span>: userMessage }],
    <span class="hljs-attr">tools</span>: tools,
  });

  <span class="hljs-keyword">const</span> message = response.<span class="hljs-property">choices</span>[<span class="hljs-number">0</span>].<span class="hljs-property">message</span>;

  <span class="hljs-comment">// 3. å¦‚æœå¤§æ¨¡å‹å†³å®šè°ƒç”¨å·¥å…·</span>
  <span class="hljs-keyword">if</span> (message.<span class="hljs-property">tool_calls</span>?.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">const</span> toolCall = message.<span class="hljs-property">tool_calls</span>[<span class="hljs-number">0</span>];

    <span class="hljs-comment">// 4. æ‰§è¡Œ MCP å·¥å…·è°ƒç”¨</span>
    <span class="hljs-keyword">const</span> toolResult = <span class="hljs-keyword">await</span> mcpClient.<span class="hljs-title function_">callTool</span>({
      <span class="hljs-attr">name</span>: toolCall.<span class="hljs-property">function</span>.<span class="hljs-property">name</span>,
      <span class="hljs-attr">arguments</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(toolCall.<span class="hljs-property">function</span>.<span class="hljs-property">arguments</span>),
    });

    <span class="hljs-comment">// 5. æŠŠç»“æœè¿”å›ç»™å¤§æ¨¡å‹ç”Ÿæˆæœ€ç»ˆå›ç­”</span>
    <span class="hljs-keyword">const</span> finalResponse = <span class="hljs-keyword">await</span> zhipuClient.<span class="hljs-title function_">createCompletions</span>({
      <span class="hljs-attr">model</span>: <span class="hljs-string">"glm-4.5-flash"</span>,
      <span class="hljs-attr">messages</span>: [
        { <span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span>, <span class="hljs-attr">content</span>: userMessage },
        message,
        {
          <span class="hljs-attr">role</span>: <span class="hljs-string">"tool"</span>,
          <span class="hljs-attr">tool_call_id</span>: toolCall.<span class="hljs-property">id</span>,
          <span class="hljs-attr">content</span>: toolResult.<span class="hljs-property">content</span>[<span class="hljs-number">0</span>].<span class="hljs-property">text</span>,
        },
      ],
    });

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(finalResponse.<span class="hljs-property">choices</span>[<span class="hljs-number">0</span>].<span class="hljs-property">message</span>.<span class="hljs-property">content</span>);
    <span class="hljs-comment">// è¾“å‡ºï¼šåŒ—äº¬ä»Šå¤©å¤©æ°”æ™´æœ—ï¼Œæ°”æ¸©25Â°Cï¼Œæ¹¿åº¦45%ï¼Œéå¸¸é€‚åˆå‡ºè¡Œã€‚</span>
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-8">å®Œæ•´æµç¨‹å›¾</h2>
<pre><code class="hljs language-bash" lang="bash">ç”¨æˆ·: <span class="hljs-string">"åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"</span>
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      chat.js                               â”‚
â”‚  1. client.listTools() â”€â”€â†’ è·å– MCP å·¥å…·åˆ—è¡¨               â”‚
â”‚  2. å‘é€ç»™å¤§æ¨¡å‹ â”€â”€â†’ å¤§æ¨¡å‹å†³å®šè°ƒç”¨ query_weather          â”‚
â”‚  3. client.callTool({name, arguments}) â”€â”€â†’ æ‰§è¡Œå·¥å…·        â”‚
â”‚  4. æŠŠç»“æœå‘å›å¤§æ¨¡å‹ â”€â”€â†’ ç”Ÿæˆè‡ªç„¶è¯­è¨€å›ç­”                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                           â–²
        â”‚ HTTP POST                 â”‚ å·¥å…·ç»“æœ
        â–¼                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   MCPServer/http.js                        â”‚
â”‚  POST /mcp â”€â”€â†’ StreamableHTTPServerTransport               â”‚
â”‚                          â”‚                                 â”‚
â”‚                          â–¼                                 â”‚
â”‚              WeatherMCPServer/index.js                     â”‚
â”‚              - ListToolsRequestSchema                      â”‚
â”‚              - CallToolRequestSchema                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h2 data-id="heading-9">è¿è¡Œé¡¹ç›®</h2>
<h3 data-id="heading-10">1. å®‰è£…ä¾èµ–</h3>
<pre><code class="hljs language-bash" lang="bash">pnpm install
</code></pre>
<h3 data-id="heading-11">2. é…ç½®ç¯å¢ƒå˜é‡</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># .env</span>
ZHIPUAI_API_KEY=your_api_key_here
</code></pre>
<h3 data-id="heading-12">3. å¯åŠ¨æœåŠ¡</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç»ˆç«¯ 1ï¼šå¯åŠ¨ MCP HTTP æœåŠ¡</span>
node MCPServer/http.js

<span class="hljs-comment"># ç»ˆç«¯ 2ï¼šè¿è¡Œå¯¹è¯</span>
node main/http.js
</code></pre>
<hr/>
<h2 data-id="heading-13">æ ¸å¿ƒæ¦‚å¿µæ€»ç»“</h2>








































<table><thead><tr><th>æ¦‚å¿µ</th><th>æœåŠ¡ç«¯</th><th>å®¢æˆ·ç«¯</th></tr></thead><tbody><tr><td>å…¥å£ç±»</td><td><code>Server</code></td><td><code>Client</code></td></tr><tr><td>ä¼ è¾“å±‚</td><td><code>StreamableHTTPServerTransport</code></td><td><code>StreamableHTTPClientTransport</code></td></tr><tr><td>å£°æ˜èƒ½åŠ›</td><td><code>capabilities: { tools: {} }</code></td><td>-</td></tr><tr><td>æ³¨å†Œå¤„ç†</td><td><code>setRequestHandler(Schema, handler)</code></td><td>-</td></tr><tr><td>è°ƒç”¨èƒ½åŠ›</td><td>-</td><td><code>listTools()</code> / <code>callTool()</code></td></tr><tr><td>å»ºç«‹è¿æ¥</td><td><code>server.connect(transport)</code></td><td><code>client.connect(transport)</code></td></tr></tbody></table>
<hr/>
<h2 data-id="heading-14">æ‰©å±•ï¼šæ·»åŠ æ–°å·¥å…·</h2>
<p>åªéœ€ä¸¤æ­¥ï¼š</p>
<p><strong>1. åœ¨ <code>ListToolsRequestSchema</code> ä¸­å£°æ˜ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-attr">tools</span>: [
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"query_weather"</span>, ... },
  {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"send_email"</span>,           <span class="hljs-comment">// æ–°å·¥å…·</span>
    <span class="hljs-attr">description</span>: <span class="hljs-string">"å‘é€é‚®ä»¶"</span>,
    <span class="hljs-attr">inputSchema</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-string">"object"</span>,
      <span class="hljs-attr">properties</span>: {
        <span class="hljs-attr">to</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span> },
        <span class="hljs-attr">subject</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span> },
        <span class="hljs-attr">body</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span> }
      },
      <span class="hljs-attr">required</span>: [<span class="hljs-string">"to"</span>, <span class="hljs-string">"subject"</span>, <span class="hljs-string">"body"</span>]
    }
  }
]
</code></pre>
<p><strong>2. åœ¨ <code>CallToolRequestSchema</code> ä¸­å®ç°ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">case</span> <span class="hljs-string">"send_email"</span>: {
  <span class="hljs-keyword">const</span> { to, subject, body } = request.<span class="hljs-property">params</span>.<span class="hljs-property">arguments</span>;
  <span class="hljs-comment">// è°ƒç”¨é‚®ä»¶æœåŠ¡...</span>
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">content</span>: [{ <span class="hljs-attr">type</span>: <span class="hljs-string">"text"</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">`é‚®ä»¶å·²å‘é€è‡³ <span class="hljs-subst">${to}</span>`</span> }] };
}
</code></pre>
<hr/>
<h2 data-id="heading-15">å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelcontextprotocol.io%2F" target="_blank" title="https://modelcontextprotocol.io/" ref="nofollow noopener noreferrer">MCP å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmodelcontextprotocol%2Ftypescript-sdk" target="_blank" title="https://github.com/modelcontextprotocol/typescript-sdk" ref="nofollow noopener noreferrer">MCP TypeScript SDK</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.bigmodel.cn%2F" target="_blank" title="https://open.bigmodel.cn/" ref="nofollow noopener noreferrer">æ™ºè°± AI å¼€æ”¾å¹³å°</a></li>
</ul>
<hr/>
<blockquote>
<p>ğŸ’¡ <strong>å°è´´å£«</strong>ï¼šMCP è¿˜æ”¯æŒ STDIO å’Œ SSE ä¸¤ç§ä¼ è¾“æ–¹å¼ï¼Œé€‚åˆä¸åŒåœºæ™¯ã€‚HTTP æœ€é€‚åˆç”Ÿäº§ç¯å¢ƒå’Œ API é›†æˆã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ¤–ç»å…¸æ™ºèƒ½ä½“èŒƒå¼]]></title>    <link>https://juejin.cn/post/7598021984299597851</link>    <guid>https://juejin.cn/post/7598021984299597851</guid>    <pubDate>2026-01-22T15:30:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598021984299597851" data-draft-id="7597946284678709267" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ¤–ç»å…¸æ™ºèƒ½ä½“èŒƒå¼"/> <meta itemprop="keywords" content="Agent"/> <meta itemprop="datePublished" content="2026-01-22T15:30:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å°å°æ€ªå…½"/> <meta itemprop="url" content="https://juejin.cn/user/3940246036166776"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ¤–ç»å…¸æ™ºèƒ½ä½“èŒƒå¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3940246036166776/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å°å°æ€ªå…½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-22T15:30:01.000Z" title="Thu Jan 22 2026 15:30:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»16åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å¼•è¨€ï¼šä¸ºä»€ä¹ˆéœ€è¦æ™ºèƒ½ä½“</h2>
<h3 data-id="heading-1">1.1 å¤§æ¨¡å‹çš„å±€é™</h3>
<p>ä¹‹å‰çš„GPT-4ç­‰å¤§æ¨¡å‹åœç•™åœ¨èŠå¤©æ¡†ä¸­ä¸”å­˜åœ¨ä¸€äº›é—®é¢˜ï¼šä¸€æ˜¯â€œå¹»è§‰â€ï¼Œå¯èƒ½ç”Ÿæˆé”™è¯¯ä¿¡æ¯æˆ–ä¸å­˜åœ¨çš„å†…å®¹ï¼›äºŒæ˜¯æ—¶æ•ˆæ€§ä¸è¶³ï¼Œå¯¹æœªè®­ç»ƒçš„æ–°å†…å®¹ç¼ºä¹å‡†ç¡®è®¤çŸ¥ï¼›ä¸‰æ˜¯å¤æ‚ä»»åŠ¡å¯é æ€§å·®ï¼Œå¤šæ­¥éª¤ä»»åŠ¡ä¸­æ˜“å‡ºç°é€»è¾‘æ··ä¹±ã€‚è¿™äº›é—®é¢˜æ— æ³•ä»…é æ¨¡å‹è°ƒä¼˜è§£å†³ï¼Œæ‰€ä»¥æ™ºèƒ½ä½“æˆä¸ºå…³é”®æ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-2">1.2 æ™ºèƒ½ä½“çš„æ ¸å¿ƒä»·å€¼</h3>
<p>æ™ºèƒ½ä½“é€šè¿‡â€œå¤§è„‘ï¼ˆLLMï¼‰-æ„ŸçŸ¥ï¼ˆç¯å¢ƒä¿¡æ¯æ•æ‰ï¼‰-åŠ¨ä½œï¼ˆå·¥å…·è°ƒç”¨ï¼‰â€é—­ç¯ï¼Œè®©LLMå…·å¤‡â€œæ€è€ƒã€è¡ŒåŠ¨ã€æ„ŸçŸ¥â€èƒ½åŠ›ã€‚ç›¸æ¯”å•çº¯è°ƒç”¨å¤§æ¨¡å‹ï¼Œæ™ºèƒ½ä½“å¯åŠ¨æ€é€‚åº”ã€ä¸å¤–éƒ¨å·¥å…·äº¤äº’ï¼Œé«˜æ•ˆå¤„ç†å¤æ‚ä»»åŠ¡ï¼Œæ¯”å¦‚ä»£ç ç”Ÿæˆã€è‡ªåŠ¨å®Œæˆä»»åŠ¡ç­‰ã€‚</p>
<h2 data-id="heading-3">äºŒã€ä»€ä¹ˆæ˜¯æ™ºèƒ½ä½“</h2>
<p>æ™ºèƒ½ä½“ï¼ˆAgentï¼‰æ˜¯èƒ½è‡ªä¸»æ„ŸçŸ¥ç¯å¢ƒã€æ¨ç†å†³ç­–ã€æ‰§è¡ŒåŠ¨ä½œï¼Œå¹¶é€šè¿‡åé¦ˆè¿­ä»£ä¼˜åŒ–çš„æ™ºèƒ½ç³»ç»Ÿã€‚åœ¨ç›®å‰å¤§æ¨¡å‹åŠ æŒä¸‹ï¼Œæ™ºèƒ½ä½“ä»¥LLMä¸ºâ€œå†³ç­–å¤§è„‘â€ï¼Œç»“åˆå¤–éƒ¨å·¥å…·ä¸ç¯å¢ƒäº¤äº’ï¼Œæ ¸å¿ƒç›®æ ‡æ˜¯å°†æŠ½è±¡ä»»åŠ¡è½¬åŒ–ä¸ºå¯è½åœ°çš„åˆ†æ­¥æ“ä½œï¼Œè§£å†³å•çº¯å¤§æ¨¡å‹â€œåªä¼šè¯´ä¸ä¼šåšâ€â€œæ˜“å¹»è§‰â€çš„é—®é¢˜ã€‚</p>
<p>æ ¸å¿ƒç‰¹å¾ï¼š</p>
<ul>
<li>è‡ªä¸»æ€§ï¼ˆæ— éœ€äººå·¥å¹²é¢„å³å¯æ¨è¿›ä»»åŠ¡ï¼‰</li>
<li>äº¤äº’æ€§ï¼ˆèƒ½ä¸å·¥å…·ã€ç¯å¢ƒã€ç”¨æˆ·åé¦ˆäº¤äº’ï¼‰</li>
<li>è¿­ä»£æ€§ï¼ˆå¯åŸºäºç»“æœä¼˜åŒ–å†³ç­–é€»è¾‘ï¼‰</li>
</ul>
<p>ç®€å•æ¥è¯´ï¼Œå¤§æ¨¡å‹æ˜¯â€œçŸ¥è¯†åº“â€ï¼Œæ™ºèƒ½ä½“æ˜¯â€œæ‰§è¡Œè€…â€ï¼ŒäºŒè€…ç»“åˆå¯å®ç°å¤æ‚ä»»åŠ¡çš„ç«¯åˆ°ç«¯è½åœ°ã€‚</p>
<h3 data-id="heading-4">æ™ºèƒ½ä½“åŸºç¡€æ¶æ„ï¼šä¸‰å¤§æ ¸å¿ƒç»„ä»¶</h3>
<p>æ™ºèƒ½ä½“ç”±ä»¥ä¸‹ä¸‰ä¸ªæ ¸å¿ƒéƒ¨åˆ†ç»„æˆï¼š</p>
<ul>
<li><strong>å¤§è„‘</strong>ï¼šå¤§è¯­è¨€æ¨¡å‹ï¼Œè´Ÿè´£ä»»åŠ¡æ¨ç†ã€å†³ç­–ä¸è®°å¿†ï¼›</li>
<li><strong>æ„ŸçŸ¥æ¨¡å—</strong>ï¼šæ•æ‰å¤–éƒ¨ä¿¡æ¯ï¼ˆå·¥å…·åé¦ˆã€ä»»åŠ¡çŠ¶æ€ç­‰ï¼‰ï¼›</li>
<li><strong>åŠ¨ä½œæ¨¡å—</strong>ï¼šè°ƒç”¨å·¥å…·æ‰§è¡Œæ“ä½œï¼ˆAPIã€ä»£ç è§£é‡Šå™¨ç­‰ã€‚</li>
</ul>
<p>ä¸ºäº†æ›´å¥½åœ°ç»„ç»‡æ™ºèƒ½ä½“çš„â€œæ€è€ƒâ€ä¸â€œè¡ŒåŠ¨â€è¿‡ç¨‹ï¼Œç›®å‰å‡ºç°å¾ˆå¤šæ™ºèƒ½ä½“çš„æ¶æ„èŒƒå¼ï¼Œæœ¬æ–‡èšç„¦æœ€ç»å…¸çš„ä¸‰ç§<code>ReAct</code>ã€<code>Plan-and-Solve</code>ã€<code>Reflection</code>ä¸‰ç§èŒƒå¼ï¼Œæ·±å…¥äº†è§£æ™ºèƒ½ä½“ã€‚</p>
<h2 data-id="heading-5">ä¸‰ã€èŒƒå¼æ·±åº¦è§£æ</h2>
<h3 data-id="heading-6">3.1 ReActï¼šè¾¹æƒ³è¾¹åšï¼ŒåŠ¨æ€é€‚é…</h3>
<h4 data-id="heading-7">3.1.1 æ ¸å¿ƒåŸç†</h4>
<h5 data-id="heading-8">ReActï¼ˆReason + Actï¼‰èŒƒå¼çš„æ ¸å¿ƒæ˜¯â€œè¾¹æ¨ç†è¾¹è¡ŒåŠ¨â€ï¼Œé€šè¿‡â€œæ€è€ƒ-è¡ŒåŠ¨-è§‚å¯Ÿâ€çš„é—­ç¯è¿­ä»£ï¼Œè®©æ™ºèƒ½ä½“åœ¨åŠ¨æ€äº¤äº’ä¸­å®Œæˆä»»åŠ¡ã€‚å…¶æ ¸å¿ƒæ¦‚å¿µæ˜¯â€œæ¨ç†ä¸è¡ŒåŠ¨ç»‘å®šâ€â€”â€”æ™ºèƒ½ä½“ä¸é¢„å…ˆè§„åˆ’å®Œæ•´è·¯å¾„ï¼Œè€Œæ˜¯æ¯ä¸€æ­¥å…ˆåˆ†æå½“å‰çŠ¶æ€ï¼ˆThoughtï¼‰ï¼Œå†æ‰§è¡Œå…·ä½“åŠ¨ä½œï¼ˆActionï¼‰ï¼Œæœ€åæ ¹æ®åé¦ˆè°ƒæ•´ä¸‹ä¸€æ­¥ç­–ç•¥ï¼ˆObservationï¼‰ã€‚</h5>
<p>æ¨¡æ‹Ÿäººç±»è§£å†³æœªçŸ¥é—®é¢˜çš„è¿‡ç¨‹ï¼šæ¯”å¦‚æŸ¥é™Œç”ŸåŸå¸‚å¤©æ°”+æ™¯ç‚¹æ¨èï¼Œä¸ä¼šå…ˆè§„åˆ’æ‰€æœ‰æ­¥éª¤ï¼Œè€Œæ˜¯å…ˆæŸ¥å¤©æ°”ï¼ˆè¡ŒåŠ¨ï¼‰ï¼Œæ ¹æ®å¤©æ°”ç»“æœï¼ˆè§‚å¯Ÿï¼‰å†æ¨èå®¤å†…/å®¤å¤–æ™¯ç‚¹ï¼ˆæ€è€ƒ+è¡ŒåŠ¨ï¼‰ã€‚ReActé€šè¿‡å°†æ¨ç†è¿‡ç¨‹æ˜¾æ€§åŒ–ï¼Œèƒ½æœ‰æ•ˆé™ä½å¤§æ¨¡å‹å¹»è§‰ï¼Œæå‡ä»»åŠ¡æ‰§è¡Œçš„å¯é æ€§ã€‚</p>
<h4 data-id="heading-9">3.1.2 ä»£ç ç¤ºä¾‹ï¼ˆå¤©æ°”æŸ¥è¯¢åœºæ™¯ï¼‰</h4>
<p>åŸºäºPythonå®ç°è½»é‡ReActæ™ºèƒ½ä½“ï¼Œå«å·¥å…·æ³¨å†Œã€é—­ç¯æ‰§è¡Œæ ¸å¿ƒé€»è¾‘ï¼š</p>
<pre><code class="hljs language-py" lang="py"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel, Field
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Union</span>, <span class="hljs-type">Optional</span>, <span class="hljs-type">Tuple</span>, <span class="hljs-type">Dict</span>

<span class="hljs-comment"># 1. å·¥å…·å®šä¹‰ï¼šå¤©æ°”æŸ¥è¯¢å·¥å…·</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_weather</span>(<span class="hljs-params">city: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""è°ƒç”¨å…¬å¼€å¤©æ°”APIï¼Œè¿”å›åŸå¸‚å¤©æ°”ä¿¡æ¯"""</span>
    api_key = <span class="hljs-string">"your-weather-api-key"</span>  <span class="hljs-comment"># æ›¿æ¢ä¸ºå®é™…APIå¯†é’¥</span>
    url = <span class="hljs-string">f"http://apis.juhe.cn/simpleWeather/query?city=<span class="hljs-subst">{city}</span>&amp;key=<span class="hljs-subst">{api_key}</span>"</span>
    <span class="hljs-keyword">try</span>:
        res = requests.get(url).json()
        <span class="hljs-keyword">if</span> res[<span class="hljs-string">"error_code"</span>] == <span class="hljs-number">0</span>:
            data = res[<span class="hljs-string">"result"</span>][<span class="hljs-string">"realtime"</span>]
            <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{city}</span>ä»Šæ—¥å¤©æ°”ï¼š<span class="hljs-subst">{data[<span class="hljs-string">'info'</span>]}</span>ï¼Œæ¸©åº¦<span class="hljs-subst">{data[<span class="hljs-string">'temperature'</span>]}</span>â„ƒ"</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"æŸ¥è¯¢å¤±è´¥ï¼š<span class="hljs-subst">{res[<span class="hljs-string">'reason'</span>]}</span>"</span>
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"å¼‚å¸¸ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>

<span class="hljs-comment"># 2. å·¥å…·æ‰§è¡Œå™¨ï¼šç®¡ç†å·¥å…·æ³¨å†Œä¸è°ƒç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ToolExecutor</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.tools = {}  <span class="hljs-comment"># key:å·¥å…·åï¼Œvalue:(æè¿°, å‡½æ•°)</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">register</span>(<span class="hljs-params">self, name: <span class="hljs-built_in">str</span>, desc: <span class="hljs-built_in">str</span>, func</span>):
        <span class="hljs-string">"""æ³¨å†Œå·¥å…·"""</span>
        self.tools[name] = (desc, func)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_tool</span>(<span class="hljs-params">self, name: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-type">Optional</span>[<span class="hljs-built_in">callable</span>]:
        <span class="hljs-string">"""è·å–å·¥å…·å‡½æ•°"""</span>
        <span class="hljs-keyword">return</span> self.tools.get(name, (<span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>))[<span class="hljs-number">1</span>]
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_tool_desc</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""ç”Ÿæˆå·¥å…·æè¿°ï¼ˆç”¨äºLLMæç¤ºè¯ï¼‰"""</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"\n"</span>.join([<span class="hljs-string">f"<span class="hljs-subst">{k}</span>: <span class="hljs-subst">{v[<span class="hljs-number">0</span>]}</span>"</span> <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> self.tools.items()])

<span class="hljs-comment"># 3. LLMè¾“å‡ºæ ¼å¼çº¦æŸï¼ˆé¿å…è§£ææ··ä¹±ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ToolAction</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    <span class="hljs-built_in">type</span>: <span class="hljs-built_in">str</span> = Field(default=<span class="hljs-string">"tool"</span>, description=<span class="hljs-string">"åŠ¨ä½œç±»å‹ï¼štool/finish"</span>)
    name: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = Field(<span class="hljs-literal">None</span>, description=<span class="hljs-string">"å·¥å…·åï¼Œtypeä¸ºtoolæ—¶å¿…å¡«"</span>)
    <span class="hljs-built_in">input</span>: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = Field(<span class="hljs-literal">None</span>, description=<span class="hljs-string">"å·¥å…·è¾“å…¥ï¼Œtypeä¸ºtoolæ—¶å¿…å¡«"</span>)
    answer: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = Field(<span class="hljs-literal">None</span>, description=<span class="hljs-string">"æœ€ç»ˆç­”æ¡ˆï¼Œtypeä¸ºfinishæ—¶å¿…å¡«"</span>)

<span class="hljs-comment"># 4. ReActæ™ºèƒ½ä½“æ ¸å¿ƒç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ReActAgent</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, llm_client, tool_executor: ToolExecutor, max_steps: <span class="hljs-built_in">int</span> = <span class="hljs-number">5</span></span>):
        self.llm = llm_client  <span class="hljs-comment"># LLMå®¢æˆ·ç«¯ï¼ˆå°è£…OpenAI/æœ¬åœ°åŒ–æ¨¡å‹ï¼‰</span>
        self.tool_exec = tool_executor
        self.max_steps = max_steps  <span class="hljs-comment"># æœ€å¤§è¿­ä»£æ­¥æ•°ï¼ˆé˜²æ­»å¾ªç¯ï¼‰</span>
        self.history = []  <span class="hljs-comment"># å­˜å‚¨æ‰§è¡Œå†å²ï¼ˆæ€è€ƒ+åŠ¨ä½œ+è§‚å¯Ÿï¼‰</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_parse_llm_output</span>(<span class="hljs-params">self, output: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-type">Tuple</span>[<span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>], <span class="hljs-type">Optional</span>[<span class="hljs-type">Dict</span>]]:
        <span class="hljs-string">"""è§£æLLMè¾“å‡ºï¼Œæå–æ€è€ƒè¿‡ç¨‹å’ŒåŠ¨ä½œ"""</span>
        <span class="hljs-keyword">try</span>:
            <span class="hljs-comment"># ç®€åŒ–è§£æï¼šå®é™…å¯ç»“åˆJSON Schemaä¸¥æ ¼æ ¡éªŒ</span>
            <span class="hljs-keyword">import</span> json
            res = json.loads(output)
            <span class="hljs-keyword">return</span> res.get(<span class="hljs-string">"thought"</span>), res.get(<span class="hljs-string">"action"</span>)
        <span class="hljs-keyword">except</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self, question: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>]:
        <span class="hljs-string">"""æ‰§è¡Œä»»åŠ¡ï¼šæ€è€ƒ-è¡ŒåŠ¨-è§‚å¯Ÿé—­ç¯"""</span>
        self.history = []
        <span class="hljs-keyword">for</span> step <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(self.max_steps):
            <span class="hljs-comment"># 1. æ„å»ºæç¤ºè¯</span>
            tool_desc = self.tool_exec.get_tool_desc()
            history_str = <span class="hljs-string">"\n"</span>.join(self.history)
            prompt = <span class="hljs-string">f"""
            ä½ å¯è°ƒç”¨ä»¥ä¸‹å·¥å…·ï¼š
            <span class="hljs-subst">{tool_desc}</span>
            è¯·æŒ‰JSONæ ¼å¼è¾“å‡ºï¼š{{"thought":"æ€è€ƒè¿‡ç¨‹","action":{{"type":"tool/finish","name":"å·¥å…·å","input":"è¾“å…¥","answer":"æœ€ç»ˆç­”æ¡ˆ"}}}}
            ç¤ºä¾‹ï¼šè°ƒç”¨å·¥å…·{{"thought":"éœ€æŸ¥å¤©æ°”","action":{{"type":"tool","name":"get_weather","input":"åŒ—äº¬"}}}}
            ç¤ºä¾‹ï¼šå®Œæˆä»»åŠ¡{{"thought":"å·²è·å–ç»“æœ","action":{{"type":"finish","answer":"åŒ—äº¬ä»Šæ—¥æ™´"}}}}
            
            é—®é¢˜ï¼š<span class="hljs-subst">{question}</span>
            å†å²è®°å½•ï¼š<span class="hljs-subst">{history_str}</span>
            """</span>
            <span class="hljs-comment"># 2. è°ƒç”¨LLMè·å–å“åº”</span>
            llm_output = self.llm.chat(prompt)
            thought, action = self._parse_llm_output(llm_output)
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> action:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ­¥éª¤<span class="hljs-subst">{step+<span class="hljs-number">1</span>}</span>ï¼šè§£æå¤±è´¥ï¼Œè·³è¿‡"</span>)
                <span class="hljs-keyword">continue</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ­¥éª¤<span class="hljs-subst">{step+<span class="hljs-number">1</span>}</span>ï¼šæ€è€ƒï¼š<span class="hljs-subst">{thought}</span>"</span>)
            
            <span class="hljs-comment"># 3. å¤„ç†åŠ¨ä½œï¼ˆå®Œæˆ/è°ƒç”¨å·¥å…·ï¼‰</span>
            <span class="hljs-keyword">if</span> action[<span class="hljs-string">"type"</span>] == <span class="hljs-string">"finish"</span>:
                <span class="hljs-keyword">return</span> action[<span class="hljs-string">"answer"</span>]
            <span class="hljs-keyword">if</span> action[<span class="hljs-string">"type"</span>] == <span class="hljs-string">"tool"</span>:
                tool_name = action[<span class="hljs-string">"name"</span>]
                tool_input = action[<span class="hljs-string">"input"</span>]
                tool_func = self.tool_exec.get_tool(tool_name)
                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> tool_func:
                    observation = <span class="hljs-string">f"å·¥å…·<span class="hljs-subst">{tool_name}</span>æœªæ³¨å†Œ"</span>
                <span class="hljs-keyword">else</span>:
                    observation = tool_func(tool_input)
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ­¥éª¤<span class="hljs-subst">{step+<span class="hljs-number">1</span>}</span>ï¼šåŠ¨ä½œï¼šè°ƒç”¨<span class="hljs-subst">{tool_name}</span>(<span class="hljs-subst">{tool_input}</span>)ï¼Œè§‚å¯Ÿï¼š<span class="hljs-subst">{observation}</span>"</span>)
                <span class="hljs-comment"># 4. è®°å½•å†å²ï¼Œè¿›å…¥ä¸‹ä¸€è½®</span>
                self.history.append(<span class="hljs-string">f"æ€è€ƒï¼š<span class="hljs-subst">{thought}</span>"</span>)
                self.history.append(<span class="hljs-string">f"åŠ¨ä½œï¼š<span class="hljs-subst">{tool_name}</span>(<span class="hljs-subst">{tool_input}</span>)"</span>)
                self.history.append(<span class="hljs-string">f"è§‚å¯Ÿï¼š<span class="hljs-subst">{observation}</span>"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-string">"ä»»åŠ¡è¶…æ—¶æœªå®Œæˆ"</span>

<span class="hljs-comment"># 5. è¿è¡Œç¤ºä¾‹</span>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-comment"># åˆå§‹åŒ–LLMå®¢æˆ·ç«¯ï¼ˆæ­¤å¤„ç®€åŒ–ï¼Œå®é™…éœ€å°è£…APIè°ƒç”¨ï¼‰</span>
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleLLMClient</span>:
        <span class="hljs-keyword">def</span> <span class="hljs-title function_">chat</span>(<span class="hljs-params">self, prompt: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
            <span class="hljs-comment"># æ¨¡æ‹ŸLLMè¾“å‡ºï¼ˆå®é™…æ›¿æ¢ä¸ºçœŸå®è°ƒç”¨ï¼‰</span>
            <span class="hljs-keyword">return</span> <span class="hljs-string">'{"thought":"ç”¨æˆ·æŸ¥ä¸Šæµ·å¤©æ°”ï¼Œéœ€è°ƒç”¨get_weatherå·¥å…·","action":{"type":"tool","name":"get_weather","input":"ä¸Šæµ·"}}'</span>
    
    <span class="hljs-comment"># æ³¨å†Œå·¥å…·å¹¶è¿è¡Œ</span>
    tool_exec = ToolExecutor()
    tool_exec.register(<span class="hljs-string">"get_weather"</span>, <span class="hljs-string">"æŸ¥è¯¢åŸå¸‚å¤©æ°”ï¼Œè¾“å…¥ä¸ºåŸå¸‚å"</span>, get_weather)
    agent = ReActAgent(SimpleLLMClient(), tool_exec)
    result = agent.run(<span class="hljs-string">"ä¸Šæµ·ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æœ€ç»ˆç»“æœï¼š<span class="hljs-subst">{result}</span>"</span>)
    
</code></pre>
<h4 data-id="heading-10">3.1.3 æ€»ç»“</h4>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ol>
<li>å¯è§£é‡Šï¼šé€šè¿‡<code>Thought</code>é“¾ï¼Œæ¸…æ™°å±•ç¤ºé€»è¾‘ä¸æµç¨‹ï¼Œæœ‰åˆ©äºç†è§£ã€ä¿¡ä»»å’Œè°ƒè¯•æ™ºèƒ½ä½“ï¼›</li>
<li>åŠ¨æ€è§„åˆ’ï¼šæ ¹æ®å½“å‰æƒ…å†µå†å¤„ç†é—®é¢˜ï¼ŒåŠ å¼ºäº†çº é”™èƒ½åŠ›ï¼›</li>
<li>å·¥å…·åä½œï¼šæ¨¡å‹æ¨ç†ï¼Œå·¥å…·å¤„ç†å…·ä½“ä»»åŠ¡ï¼Œè§£å†³äº†ä¹‹å‰å¤§æ¨¡å‹åªèƒ½è¯´çš„é—®é¢˜ã€‚</li>
</ol>
<p><strong>ä¸è¶³</strong>ï¼š</p>
<ol>
<li>ä¾èµ–å¤§æ¨¡å‹çš„æ¨ç†èƒ½åŠ›ï¼›</li>
<li>å› ä¸ºè¾¹æ€è€ƒè¾¹è¡ŒåŠ¨çš„æ¨¡å¼ï¼Œå¯¼è‡´ä½¿ç”¨LLMçš„é¢‘ç‡ä¼šå¾ˆé«˜ï¼Œå¯¼è‡´ä»»åŠ¡çš„æ€»è€—æ—¶å’ŒèŠ±è´¹æ¯”è¾ƒé«˜</li>
<li>å¯èƒ½æ˜¯å±€éƒ¨æœ€ä¼˜ï¼Œç¼ºå°‘å…¨å±€è§„åˆ’</li>
</ol>
<h3 data-id="heading-11">3.2 Plan-and-Solveï¼šå…ˆè§„åˆ’åæ‰§è¡Œ</h3>
<h4 data-id="heading-12">3.2.1 æ ¸å¿ƒåŸç†</h4>
<h4 data-id="heading-13">Plan-and-Solveï¼ˆè§„åˆ’-æ‰§è¡Œï¼‰èŒƒå¼çš„æ ¸å¿ƒæ˜¯â€œå…ˆè°‹ååŠ¨â€ï¼Œæ ¸å¿ƒæ¦‚å¿µæ˜¯â€œè§„åˆ’ä¸æ‰§è¡Œè§£è€¦â€â€”â€”å°†å¤æ‚ä»»åŠ¡æ‹†åˆ†ä¸ºå¯è½åœ°ã€æœ‰ä¾èµ–å…³ç³»çš„å­æ­¥éª¤ï¼ˆ<strong>Planning Phase</strong>ï¼‰ï¼Œå†æŒ‰æ­¥éª¤æ‰§è¡Œ(<strong>Solving Phase</strong>)å¹¶éªŒè¯ç»“æœã€‚å¦‚æœæŸä¸€æ­¥å¤±è´¥åˆ™åŠ¨æ€è°ƒæ•´è®¡åˆ’ï¼ˆé‡è§„åˆ’é˜¶æ®µï¼‰ã€‚</h4>
<p>å…¶æ ¸å¿ƒé€»è¾‘æ˜¯â€œç»“æ„åŒ–æ‹†è§£â€ï¼Œé€‚åˆä»»åŠ¡ç›®æ ‡æ¸…æ™°ã€æ­¥éª¤å¯é¢„åˆ¤çš„åœºæ™¯ã€‚æ¯”å¦‚å¼€å‘ä¸€ä¸ªç”¨æˆ·ç®¡ç†ç³»ç»Ÿï¼Œä¸ä¼šç›´æ¥ä¸Šæ‰‹ç¼–ç ï¼Œè€Œæ˜¯å…ˆæ‹†åˆ†â€œéœ€æ±‚åˆ†æâ†’æŠ€æœ¯é€‰å‹â†’æ•°æ®åº“è®¾è®¡â†’å¼€å‘â†’æµ‹è¯•â€ç­‰æ­¥éª¤ï¼Œå†é€ä¸€è½åœ°ï¼Œè‹¥æŠ€æœ¯é€‰å‹ä¸åˆç†åˆ™è°ƒæ•´è®¡åˆ’åé‡æ–°æ¨è¿›ã€‚</p>
<h4 data-id="heading-14">3.2.2 ä»£ç ç¤ºä¾‹ï¼ˆé¡¹ç›®æ‹†åˆ†åœºæ™¯ï¼‰</h4>
<p>å«ä»»åŠ¡è§„åˆ’ã€æ­¥éª¤æ‰§è¡Œã€é‡è§„åˆ’æ ¸å¿ƒé€»è¾‘ï¼š</p>
<pre><code class="hljs language-py" lang="py"><span class="hljs-keyword">import</span> json
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Optional</span>, <span class="hljs-type">Tuple</span>

<span class="hljs-comment"># 1. è§„åˆ’å™¨ï¼šç”Ÿæˆ/è°ƒæ•´ä»»åŠ¡æ­¥éª¤</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Planner</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, llm_client</span>):
        self.llm = llm_client
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_plan</span>(<span class="hljs-params">self, task: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]:
        <span class="hljs-string">"""ç”Ÿæˆåˆå§‹ä»»åŠ¡è®¡åˆ’ï¼ˆæ‹†åˆ†å­æ­¥éª¤ï¼‰"""</span>
        prompt = <span class="hljs-string">f"""
        è¯·å°†ä»¥ä¸‹ä»»åŠ¡æ‹†åˆ†ä¸º3-5ä¸ªå¯æ‰§è¡Œå­æ­¥éª¤ï¼ŒæŒ‰JSONæ•°ç»„è¿”å›ï¼Œä»…è¾“å‡ºæ•°ç»„ï¼š
        ä»»åŠ¡ï¼š<span class="hljs-subst">{task}</span>
        ç¤ºä¾‹ï¼š["æ­¥éª¤1ï¼šéœ€æ±‚åˆ†æ", "æ­¥éª¤2ï¼šæŠ€æœ¯é€‰å‹", "æ­¥éª¤3ï¼šä»£ç å¼€å‘"]
        """</span>
        llm_output = self.llm.chat(prompt)
        <span class="hljs-keyword">try</span>:
            <span class="hljs-keyword">return</span> json.loads(llm_output)
        <span class="hljs-keyword">except</span>:
            <span class="hljs-keyword">return</span> [<span class="hljs-string">"æ­¥éª¤1ï¼šé»˜è®¤å¤„ç†ä»»åŠ¡"</span>]
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">replan</span>(<span class="hljs-params">self, task: <span class="hljs-built_in">str</span>, original_plan: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>], failed_step: <span class="hljs-built_in">str</span>, reason: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]:
        <span class="hljs-string">"""é‡è§„åˆ’ï¼šåŸºäºå¤±è´¥æ­¥éª¤è°ƒæ•´è®¡åˆ’"""</span>
        prompt = <span class="hljs-string">f"""
        åŸå§‹ä»»åŠ¡ï¼š<span class="hljs-subst">{task}</span>
        åŸå§‹è®¡åˆ’ï¼š<span class="hljs-subst">{original_plan}</span>
        å¤±è´¥æ­¥éª¤ï¼š<span class="hljs-subst">{failed_step}</span>
        å¤±è´¥åŸå› ï¼š<span class="hljs-subst">{reason}</span>
        è¯·è°ƒæ•´è®¡åˆ’ï¼Œè¿”å›æ–°çš„å­æ­¥éª¤ï¼ˆJSONæ•°ç»„ï¼Œä»…è¾“å‡ºæ•°ç»„ï¼‰ï¼š
        """</span>
        llm_output = self.llm.chat(prompt)
        <span class="hljs-keyword">try</span>:
            <span class="hljs-keyword">return</span> json.loads(llm_output)
        <span class="hljs-keyword">except</span>:
            <span class="hljs-keyword">return</span> original_plan  <span class="hljs-comment"># å¤±è´¥åˆ™æ²¿ç”¨åŸè®¡åˆ’</span>

<span class="hljs-comment"># 2. æ‰§è¡Œå™¨ï¼šæ‰§è¡Œæ­¥éª¤å¹¶éªŒè¯ç»“æœ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Executor</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, llm_client</span>):
        self.llm = llm_client
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute_step</span>(<span class="hljs-params">self, step: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""æ‰§è¡Œå•ä¸ªæ­¥éª¤ï¼ˆæ¨¡æ‹Ÿå¼€å‘åœºæ™¯ä»»åŠ¡æ‰§è¡Œï¼‰"""</span>
        prompt = <span class="hljs-string">f"""
        è¯·æ¨¡æ‹Ÿæ‰§è¡Œä»¥ä¸‹å¼€å‘æ­¥éª¤ï¼Œè¿”å›æ‰§è¡Œç»“æœï¼ˆç®€æ´ç›´ç™½ï¼‰ï¼š
        æ­¥éª¤ï¼š<span class="hljs-subst">{step}</span>
        """</span>
        <span class="hljs-keyword">return</span> self.llm.chat(prompt)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">validate_step</span>(<span class="hljs-params">self, step: <span class="hljs-built_in">str</span>, result: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-type">Tuple</span>[<span class="hljs-built_in">bool</span>, <span class="hljs-built_in">str</span>]:
        <span class="hljs-string">"""éªŒè¯æ­¥éª¤æ‰§è¡Œç»“æœï¼ˆæˆåŠŸ/å¤±è´¥+åŸå› ï¼‰"""</span>
        prompt = <span class="hljs-string">f"""
        æ­¥éª¤ï¼š<span class="hljs-subst">{step}</span>
        æ‰§è¡Œç»“æœï¼š<span class="hljs-subst">{result}</span>
        è¯·åˆ¤æ–­æ‰§è¡Œæ˜¯å¦æˆåŠŸï¼ˆtrue/falseï¼‰ï¼Œå¹¶è¿”å›åŸå› ï¼ˆæ ¼å¼ï¼šå¸ƒå°”å€¼|åŸå› ï¼‰ï¼š
        """</span>
        llm_output = self.llm.chat(prompt)
        <span class="hljs-keyword">try</span>:
            success, reason = llm_output.split(<span class="hljs-string">"|"</span>)
            <span class="hljs-keyword">return</span> success.lower() == <span class="hljs-string">"true"</span>, reason.strip()
        <span class="hljs-keyword">except</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>, <span class="hljs-string">"éªŒè¯å¤±è´¥"</span>

<span class="hljs-comment"># 3. Plan-and-Solveæ™ºèƒ½ä½“æ ¸å¿ƒç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PlanAndSolveAgent</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, llm_client, max_replan: <span class="hljs-built_in">int</span> = <span class="hljs-number">2</span></span>):
        self.llm = llm_client
        self.planner = Planner(llm_client)
        self.executor = Executor(llm_client)
        self.max_replan = max_replan  <span class="hljs-comment"># æœ€å¤§é‡è§„åˆ’æ¬¡æ•°</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self, task: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""æ‰§è¡Œä»»åŠ¡ï¼šè§„åˆ’â†’æ‰§è¡Œâ†’é‡è§„åˆ’é—­ç¯"""</span>
        <span class="hljs-comment"># 1. ç”Ÿæˆåˆå§‹è®¡åˆ’</span>
        plan = self.planner.generate_plan(task)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åˆå§‹è®¡åˆ’ï¼š<span class="hljs-subst">{plan}</span>"</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> plan:
            <span class="hljs-keyword">return</span> <span class="hljs-string">"ç”Ÿæˆè®¡åˆ’å¤±è´¥"</span>
        
        replan_count = <span class="hljs-number">0</span>
        current_idx = <span class="hljs-number">0</span>  <span class="hljs-comment"># å½“å‰æ‰§è¡Œæ­¥éª¤ç´¢å¼•</span>
        <span class="hljs-keyword">while</span> current_idx &lt; <span class="hljs-built_in">len</span>(plan):
            step = plan[current_idx]
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\næ‰§è¡Œæ­¥éª¤<span class="hljs-subst">{current_idx+<span class="hljs-number">1</span>}</span>/<span class="hljs-subst">{<span class="hljs-built_in">len</span>(plan)}</span>ï¼š<span class="hljs-subst">{step}</span>"</span>)
            
            <span class="hljs-comment"># 2. æ‰§è¡Œæ­¥éª¤å¹¶éªŒè¯</span>
            step_result = self.executor.execute_step(step)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ­¥éª¤ç»“æœï¼š<span class="hljs-subst">{step_result}</span>"</span>)
            success, reason = self.executor.validate_step(step, step_result)
            
            <span class="hljs-keyword">if</span> success:
                <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ­¥éª¤<span class="hljs-subst">{current_idx+<span class="hljs-number">1</span>}</span>ï¼šæ‰§è¡ŒæˆåŠŸ"</span>)
                current_idx += <span class="hljs-number">1</span>
                <span class="hljs-keyword">continue</span>
            
            <span class="hljs-comment"># 3. æ­¥éª¤å¤±è´¥ï¼Œè§¦å‘é‡è§„åˆ’</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ­¥éª¤<span class="hljs-subst">{current_idx+<span class="hljs-number">1</span>}</span>ï¼šæ‰§è¡Œå¤±è´¥ï¼ŒåŸå› ï¼š<span class="hljs-subst">{reason}</span>"</span>)
            <span class="hljs-keyword">if</span> replan_count &gt;= self.max_replan:
                <span class="hljs-keyword">return</span> <span class="hljs-string">f"ä»»åŠ¡å¤±è´¥ï¼šæ­¥éª¤<span class="hljs-subst">{current_idx+<span class="hljs-number">1</span>}</span>å¤šæ¬¡æ‰§è¡Œå¤±è´¥ï¼Œå·²è¾¾æœ€å¤§é‡è§„åˆ’æ¬¡æ•°"</span>
            
            replan_count += <span class="hljs-number">1</span>
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç¬¬<span class="hljs-subst">{replan_count}</span>æ¬¡é‡è§„åˆ’..."</span>)
            plan = self.planner.replan(task, plan, step, reason)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"é‡è§„åˆ’åè®¡åˆ’ï¼š<span class="hljs-subst">{plan}</span>"</span>)
            current_idx = <span class="hljs-number">0</span>  <span class="hljs-comment"># é‡è§„åˆ’åä»ç¬¬ä¸€æ­¥é‡æ–°æ‰§è¡Œ</span>
        
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"ä»»åŠ¡æˆåŠŸå®Œæˆï¼Œæ‰§è¡Œæ­¥éª¤ï¼š<span class="hljs-subst">{plan}</span>"</span>

<span class="hljs-comment"># 4. è¿è¡Œç¤ºä¾‹</span>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-comment"># åˆå§‹åŒ–ç®€åŒ–LLMå®¢æˆ·ç«¯</span>
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleLLMClient</span>:
        <span class="hljs-keyword">def</span> <span class="hljs-title function_">chat</span>(<span class="hljs-params">self, prompt: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
            <span class="hljs-comment"># æ¨¡æ‹ŸLLMè¾“å‡ºï¼ˆå®é™…æ›¿æ¢ä¸ºçœŸå®è°ƒç”¨ï¼‰</span>
            <span class="hljs-keyword">if</span> <span class="hljs-string">"æ‹†åˆ†ä¸º"</span> <span class="hljs-keyword">in</span> prompt:
                <span class="hljs-keyword">return</span> <span class="hljs-string">'["æ­¥éª¤1ï¼šéœ€æ±‚åˆ†æï¼ˆæ˜ç¡®ç”¨æˆ·ç®¡ç†åŠŸèƒ½ï¼‰", "æ­¥éª¤2ï¼šæŠ€æœ¯é€‰å‹ï¼ˆReact+Node.jsï¼‰", "æ­¥éª¤3ï¼šæ•°æ®åº“è®¾è®¡ï¼ˆç”¨æˆ·è¡¨ï¼‰", "æ­¥éª¤4ï¼šä»£ç å¼€å‘", "æ­¥éª¤5ï¼šæµ‹è¯•éƒ¨ç½²"]'</span>
            <span class="hljs-keyword">elif</span> <span class="hljs-string">"æ‰§è¡Œæ­¥éª¤1"</span> <span class="hljs-keyword">in</span> prompt:
                <span class="hljs-keyword">return</span> <span class="hljs-string">"å·²å®Œæˆéœ€æ±‚åˆ†æï¼Œæ˜ç¡®éœ€åŒ…å«æ³¨å†Œã€ç™»å½•ã€æƒé™ç®¡ç†åŠŸèƒ½"</span>
            <span class="hljs-keyword">elif</span> <span class="hljs-string">"éªŒè¯æ­¥éª¤1"</span> <span class="hljs-keyword">in</span> prompt:
                <span class="hljs-keyword">return</span> <span class="hljs-string">"true|éœ€æ±‚åˆ†æå…¨é¢ï¼Œç¬¦åˆé¢„æœŸ"</span>
            <span class="hljs-keyword">else</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-string">"æ‰§è¡Œä¸­..."</span>
    
    agent = PlanAndSolveAgent(SimpleLLMClient())
    result = agent.run(<span class="hljs-string">"å¼€å‘ä¸€ä¸ªç”¨æˆ·ç®¡ç†ç³»ç»Ÿ"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\næœ€ç»ˆç»“æœï¼š<span class="hljs-subst">{result}</span>"</span>)
    
</code></pre>
<h4 data-id="heading-15">3.2.3 æ€»ç»“</h4>
<p><strong>æ ¸å¿ƒè¦ç‚¹</strong>ï¼š</p>
<ol>
<li>æä¾›ç¨³å®šã€ç»“æ„åŒ–çš„æ‰§è¡Œæµç¨‹ï¼›</li>
<li>é€‚åˆè·¯å¾„æ¸…æ™°ï¼Œä¾§é‡æ¨ç†å’Œæ­¥éª¤åˆ†è§£çš„ä»»åŠ¡ï¼›</li>
<li>æ‰§è¡Œè·¯å¾„æ¸…æ™°ï¼Œä¾¿äºè°ƒè¯•è¿½æº¯</li>
</ol>
<p><strong>ä¸è¶³</strong>ï¼šçµæ´»æ€§ä¸è¶³ï¼Œåº”å¯¹çªå‘éœ€æ±‚è°ƒæ•´ç¹çã€‚</p>
<h3 data-id="heading-16">3.3 Reflectionï¼šè‡ªæˆ‘è¿­ä»£ï¼ŒæŒç»­ä¼˜åŒ–</h3>
<h4 data-id="heading-17">3.3.1 æ ¸å¿ƒåŸç†</h4>
<h4 data-id="heading-18">Reflectionï¼ˆåæ€ï¼‰çš„æ ¸å¿ƒæ˜¯â€œè‡ªæˆ‘è¿­ä»£ä¼˜åŒ–â€ï¼Œæ ¸å¿ƒæ¦‚å¿µæ˜¯â€œåé¦ˆé©±åŠ¨æ”¹è¿›â€â€”â€”æ™ºèƒ½ä½“å…ˆç”Ÿæˆåˆå§‹ç»“æœ(<strong>Execution</strong>)ï¼Œå†ä»å¤šç»´åº¦è‡ªæˆ‘è¯„å®¡ï¼ˆ<strong>Reflection</strong>ï¼‰ï¼Œè¯†åˆ«ä¸è¶³åè¿­ä»£ä¼˜åŒ–(<strong>Refinement</strong>)ï¼Œç›´è‡³è¾¾åˆ°é¢„æœŸè´¨é‡ã€‚</h4>
<p>æ¨¡æ‹Ÿäººç±»â€œåˆç¨¿-ä¿®æ”¹-å®šç¨¿â€çš„å·¥ä½œæµç¨‹ï¼Œæ¯”å¦‚ç¼–å†™ä»£ç æ—¶ï¼Œå…ˆå†™åˆå§‹ç‰ˆæœ¬ï¼Œå†è‡ªæŸ¥è¯­æ³•é”™è¯¯ã€é€»è¾‘æ¼æ´ã€æ€§èƒ½é—®é¢˜ï¼Œé€è½®ä¼˜åŒ–ã€‚é€šè¿‡â€œåæ€â€æ¨¡å—ï¼Œè®©æ™ºèƒ½ä½“å…·å¤‡çº é”™èƒ½åŠ›ï¼Œå¤§å¹…æå‡è¾“å‡ºè´¨é‡ã€‚</p>
<h4 data-id="heading-19">3.3.2 ä»£ç ç¤ºä¾‹ï¼ˆä»£ç ä¼˜åŒ–åœºæ™¯ï¼‰</h4>
<p>Reflectionæ™ºèƒ½ä½“ï¼Œå«å¤šç»´åº¦åæ€ã€è¿­ä»£ä¼˜åŒ–æ ¸å¿ƒé€»è¾‘ï¼š</p>
<pre><code class="hljs language-py" lang="py"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Dict</span>

<span class="hljs-comment"># 1. åæ€ç»´åº¦å®šä¹‰ï¼ˆä»£ç ä¼˜åŒ–æ ¸å¿ƒç»´åº¦ï¼‰</span>
REFLECTION_DIMENSIONS = [
    <span class="hljs-string">"è¯­æ³•æ­£ç¡®æ€§ï¼šæ˜¯å¦å­˜åœ¨è¯­æ³•é”™è¯¯"</span>,
    <span class="hljs-string">"é€»è¾‘å®Œæ•´æ€§ï¼šæ˜¯å¦è¦†ç›–æ‰€æœ‰åœºæ™¯ï¼ˆå¦‚ç©ºå€¼å¤„ç†ï¼‰"</span>,
    <span class="hljs-string">"æ€§èƒ½ä¼˜åŒ–ï¼šæ˜¯å¦å­˜åœ¨å†—ä½™ä»£ç ï¼Œæ‰§è¡Œæ•ˆç‡å¦‚ä½•"</span>,
    <span class="hljs-string">"æ ¼å¼è§„èŒƒï¼šæ˜¯å¦ç¬¦åˆPEP 8ç¼–ç è§„èŒƒ"</span>
]

<span class="hljs-comment"># 2. åæ€å™¨ï¼šå¤šç»´åº¦è¯„å®¡ç»“æœ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Reflector</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, llm_client</span>):
        self.llm = llm_client
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">reflect</span>(<span class="hljs-params">self, task: <span class="hljs-built_in">str</span>, result: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>]:
        <span class="hljs-string">"""å¤šç»´åº¦åæ€ï¼Œè¿”å›å„ç»´åº¦åé¦ˆ"""</span>
        prompt = <span class="hljs-string">f"""
        ä»»åŠ¡ï¼š<span class="hljs-subst">{task}</span>
        ç”Ÿæˆç»“æœï¼ˆä»£ç ï¼‰ï¼š<span class="hljs-subst">{result}</span>
        è¯·æŒ‰ä»¥ä¸‹ç»´åº¦è¯„å®¡ï¼Œè¿”å›å„ç»´åº¦åé¦ˆï¼ˆJSONæ ¼å¼ï¼Œkeyä¸ºç»´åº¦ï¼Œvalueä¸ºåé¦ˆï¼‰ï¼š
        <span class="hljs-subst">{REFLECTION_DIMENSIONS}</span>
        ç¤ºä¾‹ï¼š{{"è¯­æ³•æ­£ç¡®æ€§":"æ— è¯­æ³•é”™è¯¯","é€»è¾‘å®Œæ•´æ€§":"ç¼ºå°‘ç©ºå€¼å¤„ç†"}}
        """</span>
        llm_output = self.llm.chat(prompt)
        <span class="hljs-keyword">try</span>:
            <span class="hljs-keyword">import</span> json
            <span class="hljs-keyword">return</span> json.loads(llm_output)
        <span class="hljs-keyword">except</span>:
            <span class="hljs-keyword">return</span> {<span class="hljs-string">"é»˜è®¤åé¦ˆ"</span>: <span class="hljs-string">"è¯„å®¡å¤±è´¥ï¼Œæ— æœ‰æ•ˆåé¦ˆ"</span>}

<span class="hljs-comment"># 3. Reflectionæ™ºèƒ½ä½“æ ¸å¿ƒç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ReflectionAgent</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, llm_client, max_iter: <span class="hljs-built_in">int</span> = <span class="hljs-number">3</span></span>):
        self.llm = llm_client
        self.reflector = Reflector(llm_client)
        self.max_iter = max_iter  <span class="hljs-comment"># æœ€å¤§è¿­ä»£ä¼˜åŒ–æ¬¡æ•°</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_initial</span>(<span class="hljs-params">self, task: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""ç”Ÿæˆåˆå§‹ç»“æœï¼ˆä»£ç ï¼‰"""</span>
        prompt = <span class="hljs-string">f"""
        è¯·å®Œæˆä»¥ä¸‹å¼€å‘ä»»åŠ¡ï¼Œè¿”å›ä»£ç ï¼ˆä»…è¾“å‡ºä»£ç ï¼Œæ— éœ€è§£é‡Šï¼‰ï¼š
        ä»»åŠ¡ï¼š<span class="hljs-subst">{task}</span>
        """</span>
        <span class="hljs-keyword">return</span> self.llm.chat(prompt)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">optimize</span>(<span class="hljs-params">self, task: <span class="hljs-built_in">str</span>, current_result: <span class="hljs-built_in">str</span>, feedback: <span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>]</span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""åŸºäºåé¦ˆä¼˜åŒ–ç»“æœï¼ˆä»£ç ï¼‰"""</span>
        feedback_str = <span class="hljs-string">"\n"</span>.join([<span class="hljs-string">f"<span class="hljs-subst">{k}</span>ï¼š<span class="hljs-subst">{v}</span>"</span> <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> feedback.items()])
        prompt = <span class="hljs-string">f"""
        ä»»åŠ¡ï¼š<span class="hljs-subst">{task}</span>
        å½“å‰ä»£ç ï¼š<span class="hljs-subst">{current_result}</span>
        è¯„å®¡åé¦ˆï¼š<span class="hljs-subst">{feedback_str}</span>
        è¯·æ ¹æ®åé¦ˆä¼˜åŒ–ä»£ç ï¼Œä»…è¾“å‡ºä¼˜åŒ–åçš„ä»£ç ï¼ˆæ— éœ€è§£é‡Šï¼‰ï¼š
        """</span>
        <span class="hljs-keyword">return</span> self.llm.chat(prompt)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self, task: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""æ‰§è¡Œä»»åŠ¡ï¼šç”Ÿæˆâ†’åæ€â†’ä¼˜åŒ–é—­ç¯"""</span>
        <span class="hljs-comment"># 1. ç”Ÿæˆåˆå§‹ä»£ç </span>
        current_code = self.generate_initial(task)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åˆå§‹ä»£ç ï¼š\n<span class="hljs-subst">{current_code}</span>"</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> current_code:
            <span class="hljs-keyword">return</span> <span class="hljs-string">"ç”Ÿæˆåˆå§‹ä»£ç å¤±è´¥"</span>
        
        <span class="hljs-comment"># 2. å¤šè½®è¿­ä»£ä¼˜åŒ–</span>
        <span class="hljs-keyword">for</span> <span class="hljs-built_in">iter</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(self.max_iter):
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nç¬¬<span class="hljs-subst">{<span class="hljs-built_in">iter</span>+<span class="hljs-number">1</span>}</span>è½®ä¼˜åŒ–ï¼š"</span>)
            <span class="hljs-comment"># åæ€è¯„å®¡</span>
            feedback = self.reflector.reflect(task, current_code)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è¯„å®¡åé¦ˆï¼š<span class="hljs-subst">{feedback}</span>"</span>)
            <span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦æ— éœ€ä¼˜åŒ–</span>
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">all</span>([<span class="hljs-string">"æ— é—®é¢˜"</span> <span class="hljs-keyword">in</span> v <span class="hljs-keyword">or</span> <span class="hljs-string">"ç¬¦åˆ"</span> <span class="hljs-keyword">in</span> v <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> feedback.values()]):
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"æ‰€æœ‰ç»´åº¦ç¬¦åˆè¦æ±‚ï¼Œåœæ­¢ä¼˜åŒ–"</span>)
                <span class="hljs-keyword">break</span>
            <span class="hljs-comment"># ä¼˜åŒ–ä»£ç </span>
            current_code = self.optimize(task, current_code, feedback)
            <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ä¼˜åŒ–åä»£ç ï¼š\n<span class="hljs-subst">{current_code}</span>"</span>)
        
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"æœ€ç»ˆä¼˜åŒ–ä»£ç ï¼š\n<span class="hljs-subst">{current_code}</span>"</span>

<span class="hljs-comment"># 4. è¿è¡Œç¤ºä¾‹</span>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-comment"># åˆå§‹åŒ–ç®€åŒ–LLMå®¢æˆ·ç«¯</span>
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleLLMClient</span>:
        <span class="hljs-keyword">def</span> <span class="hljs-title function_">chat</span>(<span class="hljs-params">self, prompt: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
            <span class="hljs-comment"># æ¨¡æ‹ŸLLMè¾“å‡ºï¼ˆå®é™…æ›¿æ¢ä¸ºçœŸå®è°ƒç”¨ï¼‰</span>
            <span class="hljs-keyword">if</span> <span class="hljs-string">"ç”Ÿæˆåˆå§‹ä»£ç "</span> <span class="hljs-keyword">in</span> prompt <span class="hljs-keyword">or</span> <span class="hljs-string">"å®Œæˆä»¥ä¸‹å¼€å‘ä»»åŠ¡"</span> <span class="hljs-keyword">in</span> prompt:
                <span class="hljs-comment"># åˆå§‹ä»£ç ï¼ˆå­˜åœ¨ç©ºå€¼æœªå¤„ç†é—®é¢˜ï¼‰</span>
                <span class="hljs-keyword">return</span> <span class="hljs-string">'''def add(a, b):
    return a + b

def calculate_sum(numbers):
    total = 0
    for num in numbers:
        total += num
    return total'''</span>
            <span class="hljs-keyword">elif</span> <span class="hljs-string">"è¯„å®¡åé¦ˆ"</span> <span class="hljs-keyword">in</span> prompt:
                <span class="hljs-comment"># åæ€åé¦ˆ</span>
                <span class="hljs-keyword">return</span> <span class="hljs-string">'''{
                    "è¯­æ³•æ­£ç¡®æ€§":"æ— è¯­æ³•é”™è¯¯",
                    "é€»è¾‘å®Œæ•´æ€§":"calculate_sumå‡½æ•°æœªå¤„ç†numbersä¸ºç©ºåˆ—è¡¨çš„åœºæ™¯",
                    "æ€§èƒ½ä¼˜åŒ–":"æ— å†—ä½™ä»£ç ï¼Œæ‰§è¡Œæ•ˆç‡è‰¯å¥½",
                    "æ ¼å¼è§„èŒƒ":"ç¬¦åˆPEP 8è§„èŒƒ"
                }'''</span>
            <span class="hljs-keyword">elif</span> <span class="hljs-string">"ä¼˜åŒ–ä»£ç "</span> <span class="hljs-keyword">in</span> prompt:
                <span class="hljs-comment"># ä¼˜åŒ–åä»£ç ï¼ˆå¤„ç†ç©ºå€¼é—®é¢˜ï¼‰</span>
                <span class="hljs-keyword">return</span> <span class="hljs-string">'''def add(a, b):
    return a + b

def calculate_sum(numbers):
    if not numbers:
        return 0
    total = 0
    for num in numbers:
        total += num
    return total'''</span>
            <span class="hljs-keyword">else</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>
    
    agent = ReflectionAgent(SimpleLLMClient())
    result = agent.run(<span class="hljs-string">"ç¼–å†™ä¸¤ä¸ªå‡½æ•°ï¼šaddï¼ˆä¸¤æ•°ç›¸åŠ ï¼‰ã€calculate_sumï¼ˆåˆ—è¡¨æ±‚å’Œï¼‰"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nä»»åŠ¡ç»“æœï¼š<span class="hljs-subst">{result}</span>"</span>)
    
</code></pre>
<h4 data-id="heading-20">3.3.3 æ€»ç»“</h4>
<p><strong>æ ¸å¿ƒè¦ç‚¹</strong>ï¼šè‡ªæˆ‘çº é”™èƒ½åŠ›å¼ºï¼Œå¯ä»¥æ˜æ˜¾æé«˜è¾“å‡ºè´¨é‡ï¼›</p>
<p><strong>ç¼ºç‚¹</strong>ï¼šæ˜æ˜¾å¢åŠ å“åº”æ—¶é•¿å’Œä»»åŠ¡èŠ±è´¹ã€‚</p>
<h2 data-id="heading-21">å››ã€ä¸‰å¤§èŒƒå¼å¯¹æ¯”</h2>

































<table><thead><tr><th>èŒƒå¼åç§°</th><th>æ ¸å¿ƒç‰¹å¾</th><th>é€‚ç”¨åœºæ™¯</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td>ReAct</td><td>è¾¹æ¨ç†è¾¹è¡ŒåŠ¨ï¼ŒåŠ¨æ€äº¤äº’ï¼Œæ— é¢„å…ˆè§„åˆ’</td><td>å®æ—¶ä¿¡æ¯æŸ¥è¯¢ï¼ˆå¤©æ°”ã€è‚¡ç¥¨ï¼‰ã€APIè°ƒç”¨ã€ä¸ç¡®å®šåœºæ™¯ä¸‹çš„ä»»åŠ¡å¤„ç†</td><td>1. åŠ¨æ€é€‚é…æ€§å¼ºï¼Œèƒ½åº”å¯¹çªå‘åé¦ˆï¼›2. å¹»è§‰æ¦‚ç‡ä½ï¼Œæ¨ç†è¿‡ç¨‹æ˜¾æ€§åŒ–ï¼›3. ä»£ç å®ç°ç®€å•ï¼Œæ˜“ä¸Šæ‰‹</td><td>1. å¤šæ­¥éª¤ä»»åŠ¡Tokenæ¶ˆè€—é«˜ï¼›2. ä¾èµ–LLMå®æ—¶æ¨ç†èƒ½åŠ›ï¼Œå¤æ‚ä»»åŠ¡æ˜“æ··ä¹±ï¼›3. æ— å…¨å±€è§„åˆ’ï¼Œé•¿æœŸä»»åŠ¡æ•ˆç‡ä½</td></tr><tr><td>Plan-and-Solve</td><td>å…ˆè§„åˆ’åæ‰§è¡Œï¼Œç»“æ„åŒ–æ‹†è§£ï¼Œæ”¯æŒé‡è§„åˆ’</td><td>é¡¹ç›®å¼€å‘æ‹†è§£ã€æµç¨‹åŒ–ä»»åŠ¡ã€ç›®æ ‡æ¸…æ™°çš„å¤æ‚ä»»åŠ¡ï¼ˆæ—…è¡Œè§„åˆ’ï¼‰</td><td>1. æ‰§è¡Œè·¯å¾„æ¸…æ™°ï¼Œä¾¿äºè°ƒè¯•ä¸è¿½æº¯ï¼›2. æ­¥éª¤åŒ–æ‰§è¡Œï¼Œä»»åŠ¡æ¨è¿›å¯æ§ï¼›3. æ”¯æŒé‡è§„åˆ’ï¼Œå®¹é”™æ€§è¾ƒå¼º</td><td>1. çµæ´»æ€§ä¸è¶³ï¼Œåº”å¯¹çªå‘éœ€æ±‚è°ƒæ•´ç¹çï¼›2. åˆå§‹è§„åˆ’è´¨é‡ä¾èµ–LLMæ‹†åˆ†èƒ½åŠ›ï¼›3. é‡è§„åˆ’åéœ€é‡æ–°æ‰§è¡Œï¼Œéƒ¨åˆ†åœºæ™¯æ•ˆç‡ä½</td></tr><tr><td>Reflection</td><td>è‡ªæˆ‘åæ€ï¼Œå¤šè½®è¿­ä»£ï¼Œåé¦ˆé©±åŠ¨ä¼˜åŒ–</td><td>ä»£ç ç”Ÿæˆä¸ä¼˜åŒ–ã€æ–‡æ¡ˆæ‰“ç£¨ã€æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡ã€é«˜ç²¾åº¦è¾“å‡ºä»»åŠ¡</td><td>1. è‡ªæˆ‘çº é”™èƒ½åŠ›å¼ºï¼Œè¾“å‡ºè´¨é‡é«˜ï¼›2. å¤šç»´åº¦è¯„å®¡ï¼Œè¦†ç›–åœºæ™¯å…¨é¢ï¼›3. ç»“æœå¯è¿­ä»£ï¼Œæ— éœ€äººå·¥å¹²é¢„ä¼˜åŒ–</td><td>1. å¤šè½®è¿­ä»£è€—æ—¶ä¹…ï¼Œèµ„æºæ¶ˆè€—é«˜ï¼›2. åæ€è´¨é‡ä¾èµ–LLMè¯„å®¡èƒ½åŠ›ï¼›3. ç®€å•ä»»åŠ¡å†—ä½™ï¼Œæ•ˆç‡è¾ƒä½</td></tr></tbody></table>
<h2 data-id="heading-22">äº”ã€æœªæ¥å»å“ª</h2>
<h3 data-id="heading-23">5.1 æ€»ç»“</h3>
<p>ReActã€Plan-and-Solveã€Reflection ä¸‰ç§èŒƒå¼ï¼Œåˆ†åˆ«å¯¹åº” â€œ<strong>åŠ¨æ€äº¤äº’</strong>ã€<strong>ç»“æ„åŒ–æ‰§è¡Œ</strong>ã€<strong>è¿­ä»£ä¼˜åŒ–</strong> ä¸‰å¤§æ ¸å¿ƒèƒ½åŠ›ï¼š</p>
<ul>
<li>è‹¥å……æ»¡ä¸ç¡®å®šæ€§ï¼Œéœ€è¦ä¸å¤–éƒ¨äº¤äº’ï¼Œä¼˜å…ˆé€‰ ReActï¼Œå¯ä»¥æ ¹æ®å®æ—¶åé¦ˆè°ƒæ•´ï¼›</li>
<li>è‹¥ä»»åŠ¡é€»è¾‘è·¯å¾„æ¸…æ™°ï¼Œä¾§é‡æ¨ç†å’Œæ­¥éª¤åˆ†è§£ï¼Œä¼˜å…ˆé€‰ Plan-and-Solveï¼Œç¡®ä¿ç¨³å®šã€ç»“æ„åŒ–çš„æ‰§è¡Œæµç¨‹ï¼›</li>
<li>è‹¥ä»»åŠ¡å¯¹è¾“å‡ºè´¨é‡å’Œå¯é æ€§è¦æ±‚é«˜ï¼Œä¼˜å…ˆé€‰ Reflectionï¼Œé€šè¿‡è¿­ä»£ä¼˜åŒ–å¯ä»¥æå‡ç»“æœè´¨é‡ã€‚</li>
</ul>
<h3 data-id="heading-24">5.2 æœªæ¥æ–¹å‘</h3>
<p>å½“å‰æ™ºèƒ½ä½“å¼€å‘è¿˜åœ¨å¿«é€Ÿè¿­ä»£ï¼Œæœªæ¥çš„æ–¹å‘å¯èƒ½é›†ä¸­åœ¨ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li><strong>èŒƒå¼èåˆ</strong>ï¼šå•ä¸€èŒƒå¼éš¾ä»¥è¦†ç›–å¤æ‚åœºæ™¯ï¼ŒèŒƒå¼èåˆï¼Œæ¯”å¦‚â€œPlan-and-Solve+Reflectionâ€ï¼ˆç»“æ„åŒ–è§„åˆ’+è¿­ä»£ä¼˜åŒ–ï¼‰ã€â€œReAct+Plan-and-Solveâ€ï¼ˆåŠ¨æ€äº¤äº’+å±€éƒ¨è§„åˆ’ï¼‰ï¼Œå…¼é¡¾æ•ˆç‡ã€çµæ´»æ€§ä¸è´¨é‡ã€‚</li>
<li><strong>å¤šæ¨¡æ€</strong>ï¼šä»æ–‡æœ¬å‘â€œæ–‡æœ¬+è¯­éŸ³+å›¾åƒ+è§†é¢‘â€å¤šæ¨¡æ€å»¶ä¼¸ï¼Œæ¯”å¦‚æ™ºèƒ½ä½“å¯ç›´æ¥è¯†åˆ«å›¾ç‰‡ã€è°ƒç”¨è¯­éŸ³ç­‰ï¼Œé€‚é…æ›´ä¸°å¯Œçš„çœŸå®åœºæ™¯ã€‚</li>
<li><strong>è‡ªä¸»å­¦ä¹ </strong>ï¼šå¼•å…¥å¼ºåŒ–å­¦ä¹ ï¼ˆRLï¼‰ä¸è®°å¿†æœºåˆ¶ï¼Œè®©æ™ºèƒ½ä½“ä»å†å²ä»»åŠ¡ä¸­è‡ªä¸»å­¦ä¹ æœ€ä¼˜ç­–ç•¥ï¼ˆå¦‚å·¥å…·é€‰æ‹©ã€æ­¥éª¤æ‹†åˆ†ï¼‰ï¼Œè‡ªæˆ‘å‡çº§ã€‚</li>
</ul>
<h3 data-id="heading-25">5.3 å¼€å‘æ¡†æ¶</h3>
<p>å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬æ— éœ€ä»é›¶æ­å»ºï¼Œå¯ä»¥åŸºäºæˆç†Ÿæ¡†æ¶å¿«é€Ÿè½åœ°ï¼š</p>
<ul>
<li><strong>LangChain</strong>ï¼šç›®å‰æœ€æµè¡Œçš„æ™ºèƒ½ä½“å¼€å‘æ¡†æ¶ä¹‹ä¸€ï¼Œç”Ÿæ€å®Œå–„ï¼Œæ”¯æŒé“¾æ¡å¼ä»»åŠ¡æ‹†è§£ã€è®°å¿†ç®¡ç†ã€å¤šèŒƒå¼é›†æˆï¼Œé€‚é…OpenAIã€æœ¬åœ°åŒ–å¤§æ¨¡å‹ç­‰å¤šç§LLMï¼Œé€‚åˆä¸­å¤§å‹æ™ºèƒ½ä½“é¡¹ç›®å¼€å‘ã€‚</li>
<li><strong>AutoGPT</strong>ï¼šåŸºäºGPTç³»åˆ—æ¨¡å‹çš„è‡ªä¸»æ™ºèƒ½ä½“æ¡†æ¶ï¼Œæ ¸å¿ƒä¼˜åŠ¿æ˜¯â€œé«˜åº¦è‡ªä¸»åŒ–â€ï¼Œæ— éœ€äººå·¥å¹²é¢„å³å¯å®Œæˆå¤æ‚ä»»åŠ¡ï¼ˆå¦‚å¸‚åœºè°ƒç ”ã€ä»£ç å¼€å‘ï¼‰ï¼Œä½†èµ„æºæ¶ˆè€—è¾ƒé«˜ï¼Œé€‚åˆè¿½æ±‚æè‡´è‡ªä¸»æ€§çš„åœºæ™¯ã€‚</li>
<li><strong>MetaGPT</strong>ï¼šå¾®è½¯å¼€æºçš„å¤šæ™ºèƒ½ä½“åä½œæ¡†æ¶ï¼Œæ¨¡æ‹Ÿè½¯ä»¶å¼€å‘å›¢é˜Ÿï¼ˆäº§å“ç»ç†ã€å¼€å‘è€…ã€æµ‹è¯•å·¥ç¨‹å¸ˆï¼‰çš„åä½œæ¨¡å¼ï¼Œæ”¯æŒå¤šæ™ºèƒ½ä½“åˆ†å·¥å®Œæˆå¤æ‚ä»»åŠ¡ï¼Œé€‚åˆå¤§å‹é¡¹ç›®çš„æ™ºèƒ½åŒ–å¼€å‘ã€‚</li>
</ul>
<p><strong>Tips</strong>ï¼š</p>
<ul>
<li>æ–‡ä¸­æ‰€æœ‰ç¤ºä¾‹çš„å®Œæ•´ä»£ç å‡åœ¨æˆ‘çš„ GitHub ä»“åº“ã€‚éœ€è¦æŸ¥çœ‹å®Œæ•´ä»£ç æˆ–å…³æ³¨æ›´å¤šå†…å®¹çš„ï¼Œå¯å‰å¾€ä»“åº“æŸ¥çœ‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FCris-z123%2Fagent-example" target="_blank" title="https://github.com/Cris-z123/agent-example" ref="nofollow noopener noreferrer">GitHub</a>ï¼Œå¦‚æœè§‰å¾—å†…å®¹æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ Starâ­ æ”¯æŒ</li>
<li>æ„Ÿè°¢ <strong>helloagents</strong> é¡¹ç›®ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[[linux]/usr/localç›®å½•å’Œ/optç›®å½•çš„åŒºåˆ«]]></title>    <link>https://juejin.cn/post/7597805826515484718</link>    <guid>https://juejin.cn/post/7597805826515484718</guid>    <pubDate>2026-01-22T13:51:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597805826515484718" data-draft-id="7597805826515402798" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="[linux]/usr/localç›®å½•å’Œ/optç›®å½•çš„åŒºåˆ«"/> <meta itemprop="keywords" content="Linux"/> <meta itemprop="datePublished" content="2026-01-22T13:51:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="import_random"/> <meta itemprop="url" content="https://juejin.cn/user/2013961033882312"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            [linux]/usr/localç›®å½•å’Œ/optç›®å½•çš„åŒºåˆ«
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2013961033882312/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    import_random
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-22T13:51:49.000Z" title="Thu Jan 22 2026 13:51:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨Linuxæ–‡ä»¶ç³»ç»Ÿå±‚æ¬¡æ ‡å‡†ï¼ˆFHSï¼‰ä¸­ï¼Œ<strong><code>/usr/local</code></strong> å’Œ <strong><code>/opt</code></strong> éƒ½æ˜¯ç”¨äº<code>å®‰è£…é™„åŠ è½¯ä»¶</code>ï¼Œä½†å®ƒä»¬æœ‰ä¸åŒçš„è®¾è®¡ç›®çš„å’Œç»“æ„ï¼š</p>
<h2 data-id="heading-0"><code>/usr/local</code></h2>
<ul>
<li><strong>ä¸»è¦ç”¨é€”</strong>ï¼šå­˜æ”¾<strong>æœ¬åœ°ç¼–è¯‘å®‰è£…</strong>çš„è½¯ä»¶ï¼ˆé€šå¸¸ç”±ç³»ç»Ÿç®¡ç†å‘˜æ‰‹åŠ¨å®‰è£…ï¼‰</li>
<li><strong>æ–‡ä»¶ç»“æ„</strong>ï¼šéµå¾ªUnixæ ‡å‡†ç›®å½•ç»“æ„
<pre><code class="hljs language-bash" lang="bash">/usr/local/bin     <span class="hljs-comment"># å¯æ‰§è¡Œæ–‡ä»¶</span>
/usr/local/lib     <span class="hljs-comment"># åº“æ–‡ä»¶</span>
/usr/local/etc     <span class="hljs-comment"># é…ç½®æ–‡ä»¶</span>
/usr/local/share   <span class="hljs-comment"># æ¶æ„æ— å…³çš„æ•°æ®æ–‡ä»¶</span>
/usr/local/include <span class="hljs-comment"># å¤´æ–‡ä»¶</span>
</code></pre>
</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼š
<ul>
<li>è½¯ä»¶æ–‡ä»¶<code>åˆ†æ•£</code>åˆ°ç›¸åº”çš„å­ç›®å½•ä¸­</li>
<li>ç³»ç»Ÿå‡çº§æ—¶ä¸ä¼šè¢«è¦†ç›–ï¼ˆä¸<code>/usr</code>åŒºåˆ†ï¼‰</li>
<li>é€‚ç”¨äºéœ€è¦é€šè¿‡<code>make install</code>å®‰è£…çš„å¼€æºè½¯ä»¶</li>
<li>é€šå¸¸å…·æœ‰æ›´é«˜çš„ç³»ç»Ÿé›†æˆåº¦</li>
</ul>
</li>
</ul>
<h2 data-id="heading-1"><code>/opt</code></h2>
<ul>
<li><strong>ä¸»è¦ç”¨é€”</strong>ï¼šå­˜æ”¾<strong>ç¬¬ä¸‰æ–¹å•†ä¸šè½¯ä»¶</strong>æˆ–<strong>ç‹¬ç«‹çš„åº”ç”¨ç¨‹åºåŒ…</strong></li>
<li><strong>æ–‡ä»¶ç»“æ„</strong>ï¼šæ¯ä¸ªè½¯ä»¶æœ‰è‡ªå·±çš„ç‹¬ç«‹ç›®å½•
<pre><code class="hljs language-bash" lang="bash">/opt/google/chrome/          <span class="hljs-comment"># Chromeæµè§ˆå™¨</span>
/opt/intellij/idea/          <span class="hljs-comment"># IntelliJ IDEA</span>
/opt/someapp/                <span class="hljs-comment"># æŸä¸ªç‹¬ç«‹åº”ç”¨</span>
</code></pre>
</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼š
<ul>
<li><strong>æ¯ä¸ªåº”ç”¨å®Œå…¨åŒ…å«åœ¨è‡ªå·±çš„ç›®å½•æ ‘ä¸­</strong></li>
<li>ä¾¿äºå¸è½½ï¼ˆç›´æ¥åˆ é™¤æ•´ä¸ªç›®å½•å³å¯ï¼‰</li>
<li>é€‚ç”¨äºè‡ªåŒ…å«çš„äºŒè¿›åˆ¶åŒ…ã€å•†ä¸šè½¯ä»¶</li>
<li>å‡å°‘ä¸ç³»ç»Ÿå…¶ä»–éƒ¨åˆ†çš„ä¾èµ–å†²çª</li>
</ul>
</li>
</ul>
<h2 data-id="heading-2">ä¸»è¦åŒºåˆ«å¯¹æ¯”</h2>



































<table><thead><tr><th>ç‰¹æ€§</th><th><code>/usr/local</code></th><th><code>/opt</code></th></tr></thead><tbody><tr><td><strong>ç»„ç»‡æ–¹å¼</strong></td><td>æŒ‰æ–‡ä»¶ç±»å‹åˆ†æ•£</td><td>æŒ‰åº”ç”¨é›†ä¸­</td></tr><tr><td><strong>å…¸å‹å†…å®¹</strong></td><td>æ‰‹åŠ¨ç¼–è¯‘çš„å¼€æºè½¯ä»¶</td><td>å•†ä¸šè½¯ä»¶ã€é¢„ç¼–è¯‘åŒ…</td></tr><tr><td><strong>é›†æˆåº¦</strong></td><td>é«˜ï¼Œä¸ç³»ç»Ÿèåˆ</td><td>ä½ï¼Œç›¸å¯¹ç‹¬ç«‹</td></tr><tr><td><strong>ç®¡ç†éš¾åº¦</strong></td><td>å¸è½½è¾ƒå¤æ‚</td><td>å¸è½½ç®€å•</td></tr><tr><td><strong>è·¯å¾„ä¼˜å…ˆçº§</strong></td><td>é€šå¸¸é«˜äº<code>/usr/bin</code></td><td>éœ€è¦æ‰‹åŠ¨æ·»åŠ åˆ°PATH</td></tr></tbody></table>
<h2 data-id="heading-3">å®é™…é€‰æ‹©å»ºè®®</h2>
<h3 data-id="heading-4">ä½¿ç”¨ <code>/usr/local</code> å½“ï¼š</h3>
<ul>
<li>ä»æºç ç¼–è¯‘å®‰è£…è½¯ä»¶ï¼ˆå¦‚<code>./configure &amp;&amp; make &amp;&amp; make install</code>ï¼‰</li>
<li>å¸Œæœ›è½¯ä»¶ä¸ç³»ç»Ÿé«˜åº¦é›†æˆ</li>
<li>éœ€è¦éµå¾ªæ ‡å‡†çš„Unixç›®å½•ç»“æ„</li>
</ul>
<h3 data-id="heading-5">ä½¿ç”¨ <code>/opt</code> å½“ï¼š</h3>
<ul>
<li>å®‰è£…ç‹¬ç«‹çš„ç¬¬ä¸‰æ–¹äºŒè¿›åˆ¶åŒ…</li>
<li>å®‰è£…å•†ä¸šè½¯ä»¶ï¼ˆå¦‚Oracle JDKã€Matlabç­‰ï¼‰</li>
<li>éœ€è¦å®Œå…¨éš”ç¦»çš„åº”ç”¨ç¨‹åº</li>
<li>å¸Œæœ›è½»æ¾å¸è½½è€Œä¸å½±å“ç³»ç»Ÿ</li>
</ul>
<h2 data-id="heading-6">PATHè®¾ç½®ç¤ºä¾‹</h2>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é€šå¸¸ /usr/local/bin å·²åœ¨PATHä¸­</span>
<span class="hljs-built_in">echo</span> <span class="hljs-variable">$PATH</span>

<span class="hljs-comment"># è¦ä½¿ç”¨ /opt ä¸­çš„ç¨‹åºï¼Œå¯èƒ½éœ€è¦æ·»åŠ </span>
<span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:/opt/someapp/bin
</code></pre>
<h2 data-id="heading-7">ç°ä»£è¶‹åŠ¿</h2>
<ul>
<li>è®¸å¤šåŒ…ç®¡ç†å™¨ï¼ˆå¦‚Homebrew on Linuxï¼‰ä½¿ç”¨<code>/usr/local</code></li>
<li>Snapå’ŒFlatpakç­‰ç°ä»£åŒ…æ ¼å¼é€šå¸¸æœ‰è‡ªå·±çš„ç‹¬ç«‹ä½ç½®</li>
<li>å®¹å™¨åŒ–åº”ç”¨è¿›ä¸€æ­¥æ”¹å˜äº†ä¼ ç»Ÿçš„è½¯ä»¶å®‰è£…æ¨¡å¼</li>
</ul>
<p><strong>ç®€å•æ€»ç»“</strong>ï¼š<code>/usr/local</code>é€‚ç”¨äºé›†æˆåˆ°ç³»ç»Ÿçš„è½¯ä»¶ï¼Œ<code>/opt</code>é€‚ç”¨äºç‹¬ç«‹æ‰“åŒ…çš„ç¬¬ä¸‰æ–¹åº”ç”¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¼ºåŒ–å­¦ä¹ å…¥é—¨ï¼šç­–ç•¥]]></title>    <link>https://juejin.cn/post/7598021313870544902</link>    <guid>https://juejin.cn/post/7598021313870544902</guid>    <pubDate>2026-01-22T15:51:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598021313870544902" data-draft-id="7598029481508388883" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¼ºåŒ–å­¦ä¹ å…¥é—¨ï¼šç­–ç•¥"/> <meta itemprop="keywords" content="ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-22T15:51:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”Ÿé”ˆçš„é”®ç›˜"/> <meta itemprop="url" content="https://juejin.cn/user/15838356199497"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¼ºåŒ–å­¦ä¹ å…¥é—¨ï¼šç­–ç•¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/15838356199497/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”Ÿé”ˆçš„é”®ç›˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-22T15:51:52.000Z" title="Thu Jan 22 2026 15:51:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. ç­–ç•¥</h2>
<p>æ€»çš„æ¥è¯´ï¼Œä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªåŠ¨ä½œï¼Œé€‰æ‹©è¿™ä¸ªåŠ¨ä½œçš„é€»è¾‘å°±æ˜¯ç­–ç•¥ã€‚ç”Ÿæ´»ä¸­å„ç§å„æ ·çš„åœºæ™¯ï¼Œä½ å¯¹æ¯ä¸ªåœºæ™¯åˆ¤æ–­åé€‰æ‹©ä»€ä¹ˆåŠ¨ä½œé€»è¾‘å°±æ˜¯ä½ çš„ç­–ç•¥ï¼Œè¿™ä¸ªç­–ç•¥å°±åœ¨ä½ çš„å¤§è„‘ä¸­ï¼ˆç¥ç»ç½‘ç»œï¼‰</p>
<ul>
<li>ç»™ä½ ä¸€ä¸ªæ¸¸æˆï¼Œæ¯ä¸ªæ¸¸æˆçŠ¶æ€ä½ é€‰æ‹©ä»€ä¹ˆæ ·çš„æ“ä½œï¼Œè¿™ä¸ªå°±æ˜¯ç­–ç•¥ï¼Œä¸åŒäººé’ˆå¯¹åŒä¸€ä¸ªåœºæ™¯é€‰æ‹©çš„åŠ¨ä½œå¯èƒ½å°±æ˜¯ä¸åŒçš„ï¼Œä¹Ÿå°±æ˜¯ç­–ç•¥ä¸åŒã€‚</li>
<li>ç»™ä½ ä¸€ä¸ªè‚¡ç¥¨çš„kçº¿ï¼Œä½ å½“å‰é€‰æ‹©ä¹°å…¥ï¼Œå–å‡ºï¼Œä»€ä¹ˆéƒ½ä¸æ“ä½œï¼Œå…·ä½“é€‰æ‹©å“ªä¸€ä¸ªåŠ¨ä½œå°±æ˜¯ä½ çš„ç­–ç•¥ï¼ŒåŒæ ·ä¸åŒçš„äººç­–ç•¥æ˜¯ä¸åŒçš„</li>
<li>å¼€è½¦éª‘è½¦ï¼Œé‡åˆ°äº†å µè½¦æ€ä¹ˆå¤„ç†ï¼Œæ˜¯æ’é˜Ÿè¿˜æ˜¯ç»•è·¯ï¼Œå‰é¢æ˜¯è¡Œäººæ˜¯åˆ¹è½¦è¿˜æ˜¯è¸©æ²¹é—¨ï¼Œå…·ä½“é€‰æ‹©å“ªä¸€ä¸ªå°±æ˜¯ä½ çš„ç­–ç•¥</li>
</ul>
<blockquote>
<p>ç­–ç•¥å°±æ˜¯ä»â€œç¯å¢ƒæ„ŸçŸ¥â€åˆ°â€œå†³ç­–åŠ¨ä½œâ€çš„æ˜ å°„é€»è¾‘ã€‚</p>
</blockquote>
<p><strong>ç­–ç•¥çš„æœ¬è´¨</strong>ï¼šæ˜ å°„å‡½æ•°
åœ¨æ•°å­¦æˆ–äººå·¥æ™ºèƒ½ï¼ˆå¼ºåŒ–å­¦ä¹ ï¼‰ä¸­ï¼Œç­–ç•¥ï¼ˆPolicyï¼‰é€šå¸¸è¢«è¡¨ç¤ºä¸ºä¸€ä¸ªå‡½æ•°<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï€</mi><mo stretchy="false">(</mo><mi>a</mi><mi mathvariant="normal">âˆ£</mi><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\pi (a|s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord">âˆ£</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span></span>ï¼š</p>
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">s</span></span></span></span></span>  (State/åœºæ™¯)ï¼šä½ è§‚å¯Ÿåˆ°çš„ä¿¡æ¯ï¼ˆå¦‚ï¼šKçº¿èµ°åŠ¿ã€å‰æ–¹çš„è¡Œäººã€æ¸¸æˆçš„å½“å‰åˆ†æ•°)</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">a</span></span></span></span></span>  (Action/åŠ¨ä½œ)ï¼šä½ åšå‡ºçš„ååº”ï¼ˆå¦‚ï¼šä¹°å…¥ã€åˆ¹è½¦ã€æ”¾æŠ€èƒ½ï¼‰ã€‚</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï€</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span></span></span></span></span> (Policy/ç­–ç•¥)ï¼šè¿™å°±æ˜¯ä½ è¯´çš„â€œé€»è¾‘â€ã€‚å®ƒå†³å®šäº†åœ¨çŠ¶æ€ (s) ä¸‹ï¼Œé€‰æ‹©åŠ¨ä½œ (a) çš„æ¦‚ç‡æˆ–ç¡®å®šæ€§ã€‚</li>
</ul>
<p><strong>ç­–ç•¥çš„ä¸‰ä¸ªç»„æˆè¦ç´ </strong>ï¼šä¸€ä¸ªå®Œæ•´çš„ç­–ç•¥é€šå¸¸åŒ…å«ä»¥ä¸‹é€»è¾‘é“¾æ¡ï¼š</p>
<ul>
<li>ç›®æ ‡å¯¼å‘ï¼šç­–ç•¥ä¸æ˜¯éšæœºçš„ï¼Œå®ƒæ˜¯ä¸ºäº†å®ç°æŸä¸ªç›®æ ‡ã€‚ç‚’è‚¡æ˜¯ä¸ºäº†ç›ˆåˆ©ï¼Œå¼€è½¦æ˜¯ä¸ºäº†å®‰å…¨åˆ°è¾¾ï¼Œæ¸¸æˆæ˜¯ä¸ºäº†èµ¢ã€‚ï¼ˆå¥–åŠ±å‡½æ•°ï¼‰</li>
<li>è§„åˆ™ä¸çº¦æŸï¼šç­–ç•¥å¿…é¡»åœ¨è§„åˆ™å†…è¿è¡Œï¼ˆå¦‚äº¤é€šæ³•è§„ã€æ¸¸æˆæœºåˆ¶ï¼‰ã€‚ï¼ˆåŠ¨ä½œç©ºé—´å’ŒçŠ¶æ€ç©ºé—´ï¼‰</li>
<li>åˆ¤æ–­é€»è¾‘ï¼ˆif-thenï¼‰ï¼šè¿™æ˜¯ä½ æåˆ°çš„æ ¸å¿ƒã€‚ï¼ˆæ¯ä¸ªåŠ¨ä½œçš„æ¦‚ç‡ï¼‰
<ul>
<li>â€œå¦‚æœï¼ˆifï¼‰è·¯å£å µå¡è¶…è¿‡10åˆ†é’Ÿï¼Œé‚£ä¹ˆï¼ˆthenï¼‰é€‰æ‹©ç»•è·¯ã€‚â€</li>
<li>â€œå¦‚æœï¼ˆifï¼‰Kçº¿è·Œç ´æ”¯æ’‘ä½ï¼Œé‚£ä¹ˆï¼ˆthenï¼‰æ­¢æŸå–å‡ºã€‚â€</li>
</ul>
</li>
</ul>
<h2 data-id="heading-1">2. è¡Œä¸ºç­–ç•¥å’Œç›®æ ‡ç­–ç•¥</h2>
<p>åœ¨å¼ºåŒ–å­¦ä¹ ä¸­ï¼Œä¸ºäº†åŒºåˆ†â€œè°åœ¨é‡‡é›†æ•°æ®â€å’Œâ€œæˆ‘ä»¬è¦ä¼˜åŒ–è°â€ï¼Œå¼•å…¥äº†è¿™ä¸¤ä¸ªæ¦‚å¿µã€‚ç†è§£å®ƒä»¬çš„å…³é”®åœ¨äºï¼š<strong>æ•°æ®æºå¤´ä¸å­¦ä¹ ç›®æ ‡æ˜¯å¦ä¸€è‡´</strong>ã€‚</p>
<p><strong>è¡Œä¸ºç­–ç•¥ (Behavior Policy, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¼</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Î¼</span></span></span></span></span> æˆ– <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Ï€</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\pi _{old}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>)</strong></p>
<ul>
<li>å®šä¹‰ï¼š å®é™…åœ¨ç¯å¢ƒé‡Œâ€œè·‘è·‘è·³è·³â€ã€äº§ç”ŸåŠ¨ä½œå¹¶æ”¶é›†å¥–åŠ±çš„é‚£ä¸ªç­–ç•¥ã€‚</li>
<li>èŒè´£ï¼š è´Ÿè´£æ¢ç´¢ç¯å¢ƒï¼Œäº§ç”Ÿå®éªŒæ•°æ®ï¼ˆå³ (s,a,r,s^{\prime }) çš„åºåˆ—ï¼‰ã€‚</li>
</ul>
<p><strong>ç›®æ ‡ç­–ç•¥ (Target Policy, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï€</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span></span></span></span></span> æˆ– <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Ï€</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\pi _{new}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>)</strong></p>
<ul>
<li>å®šä¹‰ï¼š æˆ‘ä»¬æ­£åœ¨åŠªåŠ›å­¦ä¹ ã€æ”¹è¿›ã€å¹¶å¸Œæœ›æœ€ç»ˆæ‹¿åˆ°å† å†›çš„é‚£ä¸ªç­–ç•¥</li>
<li>èŒè´£ï¼š è´Ÿè´£åˆ©ç”¨å­¦åˆ°çš„çŸ¥è¯†ï¼Œå˜å¾—è¶Šæ¥è¶Šèªæ˜ã€‚</li>
</ul>
<p>å¦‚æœåªæœ‰ä¸€ä¸ªç­–ç•¥ï¼ˆå³åŒç­–ç•¥ï¼‰ï¼Œä¼šé¢ä¸´ä¸¤ä¸ªæ ¸å¿ƒçŸ›ç›¾ï¼ŒåŒºåˆ†å®ƒä»¬æ­£æ˜¯ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼š</p>
<p><strong>1. è§£å†³â€œæ¢ç´¢â€ä¸â€œåˆ©ç”¨â€çš„çŸ›ç›¾</strong></p>
<ul>
<li>çŸ›ç›¾ç‚¹ï¼šç›®æ ‡ç­–ç•¥é€šå¸¸å¸Œæœ›è¡¨ç°å¾—å°½å¯èƒ½å®Œç¾ï¼ˆåˆ©ç”¨ï¼‰ï¼Œä½†ä¸ºäº†å­¦å¾—æ›´å¥½ï¼Œæˆ‘ä»¬éœ€è¦æ¨¡å‹å»å°è¯•ä¸€äº›å¥‡æ€ªçš„ã€å¯èƒ½å‡ºé”™çš„åŠ¨ä½œï¼ˆæ¢ç´¢ï¼‰ã€‚</li>
<li>è§£å†³æ–¹æ¡ˆï¼š æˆ‘ä»¬å¯ä»¥è®©è¡Œä¸ºç­–ç•¥æ›´æ¿€è¿›åœ°å»å†’é™©ï¼ˆæ¯”å¦‚å¸¦å™ªå£°çš„æ¢ç´¢ï¼‰ï¼Œè€Œè®©ç›®æ ‡ç­–ç•¥å¹³æ»‘åœ°å­¦ä¹ æœ€ä¼˜è·¯å¾„ã€‚</li>
</ul>
<p><strong>2. æ ·æœ¬æ•ˆç‡ï¼ˆå˜åºŸä¸ºå®ï¼‰</strong></p>
<ul>
<li>çŸ›ç›¾ç‚¹ï¼šç›®æ ‡ç­–ç•¥æ¯æ›´æ–°ä¸€æ¬¡å‚æ•°ï¼Œå®ƒå°±å˜æˆäº†â€œæ–°ç­–ç•¥â€ã€‚å¦‚æœä¸åŒºåˆ†ä¸¤è€…ï¼Œé‚£ä¹ˆå‡ ç§’é’Ÿå‰ï¼ˆæ—§ç­–ç•¥ï¼‰æ”¶é›†çš„æ•°æ®åœ¨æ•°å­¦ä¸Šå°±å¤±æ•ˆäº†ã€‚</li>
<li>è§£å†³æ–¹æ¡ˆï¼š å¼•å…¥è¡Œä¸ºç­–ç•¥çš„æ¦‚å¿µåï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ<strong>è¿‡å»ä¸€å°æ—¶å†…æ‰€æœ‰çš„å°</strong>éƒ½çœ‹ä½œæ˜¯ç”±<strong>æ—§çš„è¡Œä¸ºç­–ç•¥</strong>äº§ç”Ÿçš„ã€‚é€šè¿‡é‡è¦æ€§é‡‡æ ·ç­‰æŠ€æœ¯ï¼Œæˆ‘ä»¬å¯ä»¥å‘Šè¯‰ç›®æ ‡ç­–ç•¥ï¼šâ€œè™½ç„¶è¿™æ˜¯æ—§æ•°æ®ï¼Œä½†é€šè¿‡å¯¹æ¯”æˆ‘ç°åœ¨çš„æƒ³æ³•å’Œå½“æ—¶çš„åŠ¨ä½œæ¦‚ç‡ï¼Œæˆ‘ä¾ç„¶èƒ½ä»è¿™äº›æ—§ç»éªŒé‡Œå­¦åˆ°ä¸œè¥¿ã€‚â€</li>
</ul>
<p>ä¹‹æ‰€ä»¥è¦åŒºåˆ†å®ƒä»¬ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸ºäº†â€œæ‰“ç ´æ—¶é—´çš„è¯…å’’â€ã€‚åœ¨å¼‚ç­–ç•¥ä¸­ï¼Œæœ‰äº†è¿™ä¸¤ä¸ªæ¦‚å¿µï¼Œæˆ‘ä»¬å°±å¯ä»¥å»ºç«‹ä¸€ä¸ªç»éªŒå›æ”¾æ±  (Replay Buffer)ï¼ŒæŠŠæˆåƒä¸Šä¸‡æ¬¡ä¸åŒè¡Œä¸ºç­–ç•¥äº§ç”Ÿçš„æ•°æ®å­˜èµ·æ¥åå¤å­¦ä¹ ï¼Œè€Œä¸å¿…æ¯æ›´æ–°ä¸€æ¬¡å‚æ•°å°±å»ç¯å¢ƒé‡Œé‡æ–°è·‘ä¸€éã€‚è¿™å¤§å¤§èŠ‚çœäº†è®¡ç®—èµ„æºå’Œæ—¶é—´ã€‚</p>
<p>è¡Œä¸ºç­–ç•¥å’Œå­¦ä¹ ç­–ç•¥ä¸€è‡´å°±æ˜¯åŒç­–ç•¥ï¼ˆon-policyï¼‰,å¦åˆ™ä¸ºå¼‚ç­–ç•¥ï¼ˆoff-policyï¼‰</p>
<ul>
<li>â€‹<strong>æ¨¡æ‹Ÿå™¨æˆæœ¬é«˜</strong>â€‹**ï¼šå½“æ•°æ®æ”¶é›†éå¸¸æ˜‚è´µæˆ–ç¼“æ…¢æ—¶ï¼Œä¼˜å…ˆé€‰æ‹©å¼‚ç­–ç•¥ä»¥æœ€å¤§åŒ–åˆ©ç”¨æ¯ä¸€æ¡æ•°æ®ã€‚**</li>
<li>â€‹<strong>éœ€è¦ç¦»çº¿å­¦ä¹ â€‹</strong>â€‹**ï¼šä¾‹å¦‚åœ¨è‡ªåŠ¨é©¾é©¶æˆ–åŒ»ç–—é¢†åŸŸï¼Œåªèƒ½åˆ©ç”¨å·²æœ‰çš„å†å²è§‚æµ‹æ•°æ®é›†è¿›è¡Œè®­ç»ƒï¼ˆOffline RLï¼‰ã€‚**</li>
</ul>
<h2 data-id="heading-2">3. å¼‚ç­–ç•¥ï¼ˆoff-policyï¼‰</h2>
<p>â€‹<strong>å¼‚ç­–ç•¥æœ¬èº«å¹¶ä¸ä¸»è§‚â€œè®¤ä¸ºâ€æ ·æœ¬æ˜¯ç‹¬ç«‹çš„ï¼Œä½†å®ƒé€šè¿‡ç‰¹å®šçš„æ‰‹æ®µï¼ˆå¦‚ç»éªŒå›æ”¾ï¼‰äººä¸ºåœ°åˆ¶é€ äº†è¿™ç§â€œç‹¬ç«‹æ€§â€</strong> â€‹ï¼Œä»¥æ»¡è¶³ç¥ç»ç½‘ç»œè®­ç»ƒçš„æ•°å­¦å‰æã€‚</p>
<p>åœ¨å¼ºåŒ–å­¦ä¹ ä¸­ï¼Œæ™ºèƒ½ä½“é‡‡é›†çš„åŸå§‹æ ·æœ¬æ˜¯æŒ‰æ—¶é—´é¡ºåºæ’åˆ—çš„ã€‚è¿ç»­é‡‡é›†çš„æ•°æ®åºåˆ—å…·æœ‰å¼ºçƒˆçš„æ—¶é—´ç›¸å…³æ€§<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">s_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ç´§æ¥ç€<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">s_{t+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"/><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span></span></span></span></span>ã€‚å¦‚æœç›´æ¥æŒ‰é¡ºåºå­¦ä¹ ï¼Œç¥ç»ç½‘ç»œä¼šé¢ä¸´ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li><strong>éç‹¬ç«‹åŒåˆ†å¸ƒï¼ˆNon-IIDï¼‰</strong>ï¼š æ·±åº¦å­¦ä¹ æ¨¡å‹çš„åŸºç¡€å‡è®¾æ˜¯æ ·æœ¬ç‹¬ç«‹åŒåˆ†å¸ƒã€‚å¦‚æœæ¨¡å‹è¿ç»­çœ‹åˆ° 100 ä¸ªæå…¶ç›¸ä¼¼çš„åŠ¨ä½œï¼Œå®ƒçš„æ¢¯åº¦æ›´æ–°ä¼šäº§ç”Ÿä¸¥é‡çš„åç§»ï¼Œå¯¼è‡´è®­ç»ƒä¸ç¨³å®šã€‚</li>
<li><strong>åé¦ˆå¾ªç¯</strong>ï¼š å½“å‰çš„ç­–ç•¥å†³å®šäº†ä¸‹ä¸€æ­¥çœ‹åˆ°çš„æ•°æ®ï¼Œå¦‚æœæ•°æ®åˆæ˜¯è¿ç»­ç›¸å…³çš„ï¼Œæ¨¡å‹å¾ˆå®¹æ˜“é™·å…¥æŸä¸ªæ­»å¾ªç¯æˆ–è€…è¿‡åº¦æ‹Ÿåˆå±€éƒ¨åŒºåŸŸã€‚</li>
</ul>
<p>å¼‚ç­–ç•¥ç®—æ³•ï¼ˆå¦‚ DQN, SACï¼‰çš„æ ¸å¿ƒç»„ä»¶æ˜¯ <strong>ç»éªŒå›æ”¾æ± ï¼ˆReplay Bufferï¼‰</strong>ã€‚è¿™ä¸ªæœºåˆ¶çš„ä½œç”¨å°±æ˜¯<strong>æ‰“ç ´è¿™ç§ç›¸å…³æ€§</strong></p>
<ul>
<li>â€‹<strong>éšæœºé‡‡æ · (Random Sampling)</strong> â€‹ï¼šç®—æ³•ä»å›æ”¾æ± ä¸­éšæœºæŠ½å–ä¸€å°æ’®æ ·æœ¬ï¼ˆMini-batchï¼‰è¿›è¡Œè®­ç»ƒã€‚</li>
<li>â€‹<strong>æ¨¡æ‹Ÿ IID</strong>â€‹ï¼šé€šè¿‡è¿™ç§éšæœºæ€§ï¼ŒåŸæœ¬æœ‰æ—¶åºå…³ç³»çš„æ ·æœ¬è¢«â€œæ‰“æ•£â€äº†ã€‚åœ¨è®­ç»ƒæ—¶ï¼Œç½‘ç»œçœ‹åˆ°çš„æ ·æœ¬é›†åˆåœ¨ç»Ÿè®¡å­¦ä¸Šæ›´æ¥è¿‘äº**â€‹ç‹¬ç«‹åŒåˆ†å¸ƒ (IID)**â€‹ã€‚è¿™å°±åƒæ˜¯æŠŠæ•´æœ¬ä¹¦çš„é¢˜åº“æ‰“ä¹±äº†å†æŠ½é¢˜ï¼Œè®©ç¥ç»ç½‘ç»œå­¦åˆ°çš„æ˜¯é€šç”¨çš„ç‰©ç†è§„å¾‹ï¼ˆå¦‚â€œç¢°åˆ°å¢™ä¼šåå¼¹â€ï¼‰ï¼Œè€Œä¸æ˜¯ç‰¹å®šçš„è½¨è¿¹ï¼ˆå¦‚â€œå…ˆå·¦è½¬å†å³è½¬â€ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-3">3.1 å¼‚ç­–ç•¥å­¦ä¹ åºåˆ—ä¿¡æ¯</h3>
<blockquote>
<p><code>æ—¢ç„¶ä»»åŠ¡æ˜¯åºåˆ—åŒ–çš„ï¼Œä¸ºä»€ä¹ˆæŠŠåºåˆ—æ‹†å¾—ç¨€ç¢ï¼Œæ¨¡å‹è¿˜èƒ½å­¦ä¼šâ€œé•¿è¿œæ‰“ç®—â€ï¼Ÿ</code></p>
</blockquote>
<p>æ ¸å¿ƒåŸå› åœ¨äºï¼šå¼‚ç­–ç•¥ç®—æ³•åˆ©ç”¨äº†â€œé©¬å°”å¯å¤«æ€§â€å’Œâ€œè‡ªä¸¾ï¼ˆBootstrappingï¼‰â€æœºåˆ¶ï¼Œå°†æ—¶åºä¿¡æ¯è½¬åŒ–ä¸ºäº†çŠ¶æ€å€¼ï¼ˆValueï¼‰çš„å±æ€§ã€‚</p>
<blockquote>
<p>å¼‚ç­–ç•¥å­¦ä¹ çš„ç›®æ ‡ä¸æ˜¯â€œè·¯å¾„â€ï¼Œè€Œæ˜¯â€œå…³è”â€œ</p>
</blockquote>
<p>å¼‚ç­–ç•¥å¹¶ä¸è¯•å›¾é€šè¿‡æ­»è®°ç¡¬èƒŒæ•´æ¡è½¨è¿¹æ¥å­¦ä¹ ï¼Œå®ƒå­¦ä¹ çš„æ˜¯çŠ¶æ€ä¸çŠ¶æ€ä¹‹é—´çš„â€‹<strong>é€»è¾‘é€’æ¨å…³ç³»</strong>â€‹ã€‚</p>
<h4 data-id="heading-4">3.1.1. <strong>åŸå­çº§å…³è”</strong>â€‹</h4>
<p>æ¯ä¸€ä¸ªæ ·æœ¬ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo separator="true">,</mo><mi>r</mi><mo separator="true">,</mo><mi>s</mi><mtext>â€²</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s,a,r,sâ€²)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">s</span><span class="mord">â€²</span><span class="mclose">)</span></span></span></span></span>éƒ½åŒ…å«äº†ä¸€ä¸ªå¾®å°çš„â€œé€»è¾‘æ–­è¨€â€ï¼šåœ¨çŠ¶æ€<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">s</span></span></span></span></span>åšäº†<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">a</span></span></span></span></span>ï¼Œä¼šå¾—åˆ° <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></span>å¹¶è·³åˆ°<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">s</span></span></span></span></span></p>
<h4 data-id="heading-5">3.1.2. <strong>æ‹¼å›¾æ•ˆåº”</strong>â€‹</h4>
<p>ä½ å¯ä»¥æŠŠå¼‚ç­–ç•¥çš„å­¦ä¹ æƒ³è±¡æˆæ‹¼æ‹¼å›¾ï¼š æ¯ä¸€æ¡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo separator="true">,</mo><mi>r</mi><mo separator="true">,</mo><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s,a,r,s^{\prime })</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> å°±åƒæ‹¼å›¾çš„ä¸€ä¸ªè¿æ¥å¤„ã€‚é€šè¿‡éšæœºé‡‡æ ·ï¼Œæ¨¡å‹ä¸€ä¼šå„¿åœ¨å­¦æ‹¼å›¾å·¦ä¸Šè§’ï¼ˆè¿™ä¸€ç»„<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>â†’</mo><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mrow><annotation encoding="application/x-tex">s\rightarrow s^{\prime }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.7519em;"/><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span>ï¼‰ï¼Œä¸€ä¼šå„¿åœ¨å­¦å³ä¸‹è§’ï¼ˆå¦ä¸€ç»„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>â†’</mo><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mrow><annotation encoding="application/x-tex">s\rightarrow s^{\prime }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.7519em;"/><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span>ï¼‰ã€‚è™½ç„¶æ ·æœ¬è¢«æ‰“æ•£äº†ï¼Œä½†ç”±äº<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mtext>â€²</mtext></mrow><annotation encoding="application/x-tex">sâ€²</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"/><span class="mord mathnormal">s</span><span class="mord">â€²</span></span></span></span></span>ï¼ˆå½“å‰æ­¥çš„ç»ˆç‚¹ï¼‰åœ¨å¦ä¸€ä¸ªæ ·æœ¬ä¸­ä¼šä½œä¸º<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">s</span></span></span></span></span>ï¼ˆä¸‹ä¸€æ­¥çš„èµ·ç‚¹ï¼‰å‡ºç°ã€‚åªè¦é‡‡æ ·çš„æ ·æœ¬(ç»éªŒæ± )è¦†ç›–äº†ç¯å¢ƒçš„å„ä¸ªè§’è½ï¼Œæ¨¡å‹å°±èƒ½é€šè¿‡æ— æ•°ä¸ªâ€œè¿æ¥å¤„â€æŠŠæ•´ä¸ªé€»è¾‘é“¾æ¡ä¸²è”èµ·æ¥ã€‚</p>
<blockquote>
<p>å®ƒä¸éœ€è¦ä¸€å£æ°”çœ‹å®Œæ•´ä¸ªè§†é¢‘ï¼Œåªéœ€è¦çœ‹éæ‰€æœ‰çš„â€œå¸§å¯¹â€å…³ç³»ï¼Œæœ€ç»ˆå°±èƒ½æ¨å¯¼å‡ºå®Œæ•´çš„å‰§æƒ…ã€‚</p>
</blockquote>
<h4 data-id="heading-6">3.1.3. <strong>é©¬å°”å¯å¤«å‡è®¾</strong></h4>
<blockquote>
<p>â€œæ­¤æ—¶æ­¤åˆ»çš„çŠ¶æ€ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">s</span></span></span></span></span> å·²ç»åŒ…å«äº†æ‰€æœ‰å¯¹æœªæ¥æœ‰ç”¨çš„å†å²ä¿¡æ¯â€</p>
</blockquote>
<p>å¦‚æœè¿™ä¸ªå‡è®¾æˆç«‹ï¼Œé‚£ä¹ˆæ¨¡å‹åªéœ€è¦çŸ¥é“ã€æˆ‘åœ¨å“ª (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">s</span></span></span></span></span>)ã€‘ã€ã€æˆ‘åšäº†ä»€ä¹ˆ (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">a</span></span></span></span></span>)ã€‘å’Œã€æˆ‘åˆ°äº†å“ª (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mrow><annotation encoding="application/x-tex">s^{\prime }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"/><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span>)ã€‘ï¼Œå°±è¶³ä»¥åšå‡ºå®Œç¾å†³ç­–ã€‚å®ƒä¸éœ€è¦è®°å¾—å®ƒæ˜¯æ€ä¹ˆæ¥åˆ° <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">s</span></span></span></span></span> çš„ï¼Œæ‰€ä»¥æ‰“æ•£åºåˆ—ä¸ä¼šæŸä¼¤å®ƒçš„åˆ¤æ–­åŠ›ã€‚</p>
<h4 data-id="heading-7">3.1.4. <strong>è´å°”æ›¼æ–¹ç¨‹çš„è‡ªä¸¾æœºåˆ¶</strong></h4>
<p>å¼‚ç­–ç•¥ç®—æ³•ï¼ˆå¦‚ DQNï¼‰çš„æ ¸å¿ƒå…¬å¼æ˜¯ï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>â‰ˆ</mo><mi>r</mi><mo>+</mo><mi>Î³</mi><mi>m</mi><mi>a</mi><mi>x</mi><mi>a</mi><mtext>â€²</mtext><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mtext>â€²</mtext><mo separator="true">,</mo><mi>a</mi><mtext>â€²</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q(s,a)â‰ˆr+Î³maxaâ€²Q(sâ€²,aâ€²)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">Î³ma</span><span class="mord mathnormal">x</span><span class="mord mathnormal">a</span><span class="mord">â€²</span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mord">â€²</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">a</span><span class="mord">â€²</span><span class="mclose">)</span></span></span></span></span></div>
<p>è¿™ä¸ªå…¬å¼èµ‹äºˆäº†æ‰“æ•£æ ·æœ¬â€œè·¨è¶Šæ—¶ç©ºâ€çš„èƒ½åŠ›ï¼š</p>
<ul>
<li><strong>ä»·å€¼ä¼ é€’</strong>â€‹ï¼šå³ä¾¿ä½ åªç»™æ¨¡å‹ä¸€ä¸ªå­¤ç«‹çš„æ ·æœ¬<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo separator="true">,</mo><mi>r</mi><mo separator="true">,</mo><mi>s</mi><mtext>â€²</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s,a,r,sâ€²)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">s</span><span class="mord">â€²</span><span class="mclose">)</span></span></span></span></span>ï¼Œæ¨¡å‹ä¹Ÿä¼šå»æŸ¥è¯¢å®ƒå½“å‰å¯¹sâ€²ä»·å€¼çš„ä¼°è®¡ã€‚</li>
<li>â€‹<strong>è¿œè§æ€§</strong>â€‹ï¼šå¦‚æœ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mtext>â€²</mtext></mrow><annotation encoding="application/x-tex">sâ€²</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5556em;"/><span class="mord mathnormal">s</span><span class="mord">â€²</span></span></span></span></span>æ˜¯ä¸€ä¸ªæ¥è¿‘ç»ˆç‚¹çš„è·èƒœçŠ¶æ€ï¼Œå®ƒçš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mtext>â€²</mtext><mo separator="true">,</mo><mi>a</mi><mtext>â€²</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q(sâ€²,aâ€²)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mord">â€²</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">a</span><span class="mord">â€²</span><span class="mclose">)</span></span></span></span></span>ä¼šå¾ˆé«˜ã€‚é€šè¿‡è¿™ä¸€è¡Œå…¬å¼ï¼Œé«˜ä»·å€¼ä¼š<strong>åå‘ä¼ æ’­</strong>ç»™<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">s</span></span></span></span></span>ã€‚</li>
<li>â€‹<strong>ç»“è®º</strong>â€‹ï¼šåºåˆ—çš„è¿è´¯æ€§å¹¶æ²¡æœ‰æ¶ˆå¤±ï¼Œè€Œæ˜¯è¢«æµ“ç¼©è¿›äº†<strong>Qå€¼è¡¨</strong> ä¸­ã€‚å¤šæ¬¡éšæœºé‡‡æ ·è®­ç»ƒï¼Œæ”¶ç›Šå°±ä¼šåƒâ€œæ°´æµâ€ä¸€æ ·ï¼Œé€šè¿‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span> å‡½æ•°è¿™ä¸ªä¸­ä»‹ï¼Œä»ç»ˆç‚¹é€†æµå›èµ·ç‚¹ã€‚</li>
</ul>
<h3 data-id="heading-8">3.2 ç±»æ¯”äº‹åè¯¸è‘›äº®</h3>
<p>è´å°”æ›¼æ–¹ç¨‹å¹¶ä¸æ˜¯çœŸçš„çŸ¥é“äº†æœªæ¥çš„ä»·å€¼ï¼Œè€Œæ˜¯é€šè¿‡ä¸æ–­çš„é‡‡æ ·ï¼Œç„¶åé€šè¿‡ä»·å€¼åæ¨å½“å‰åŠ¨ä½œé€‰æ‹©çš„ä»·å€¼ï¼Œå±äºæ˜¯äº‹åè¯¸è‘›äº®ã€‚</p>
<h4 data-id="heading-9">3.2.1. ç¬¬ä¸€é˜¶æ®µï¼šä¸¤çœ¼ä¸€æŠ¹é»‘ï¼ˆåˆæœŸçš„â€œäº‹åâ€ï¼‰</h4>
<p>åœ¨åˆšå¼€å§‹é‡‡æ ·æ—¶ï¼Œæ¨¡å‹ç¡®å®å®Œå…¨ä¸çŸ¥é“æœªæ¥çš„ä»·å€¼ã€‚å®ƒåœ¨ç¯å¢ƒé‡Œä¹±æ’ï¼Œå³ä¾¿å¶å°”åšå¯¹äº†åŠ¨ä½œï¼Œåªè¦æ²¡ç¢°åˆ°é‚£ä¸ªå¸¦å¥–é‡‘çš„â€œç»ˆç‚¹â€ï¼Œå®ƒä¾ç„¶è§‰å¾—è‡ªå·±æ‰€æœ‰çš„åŠ¨ä½œéƒ½æ˜¯å¹³åº¸çš„ã€‚è¿™æ—¶å€™ï¼Œå®ƒè¿åšâ€œäº‹åè¯¸è‘›äº®â€çš„èµ„æ ¼éƒ½æ²¡æœ‰ï¼Œå› ä¸ºè¿˜æ²¡å‘ç”Ÿä»»ä½•å€¼å¾—å¤ç›˜çš„â€œå¥½äº‹â€ã€‚</p>
<h4 data-id="heading-10">3.2.2. ç¬¬äºŒé˜¶æ®µï¼šå¤ç›˜å±€éƒ¨ï¼ˆä¸­æœŸçš„â€œäº‹åâ€ï¼‰</h4>
<p>å½“æŸæ¬¡å¶ç„¶æ’åˆ°äº†å¥–é‡‘ï¼ˆæ¯”å¦‚æ ·æœ¬ï¼šå€’æ•°ç¬¬ä¸€æ­¥ -&gt; ç»ˆç‚¹ -&gt; æ‹¿é’±ï¼‰ï¼Œæ¨¡å‹å¼€å§‹å¤ç›˜äº†ï¼š
å®ƒçš„é€»è¾‘ï¼š â€œè™½ç„¶æˆ‘ä¸çŸ¥é“å‰é¢æ˜¯æ€ä¹ˆæ¥çš„ï¼Œä½†åˆšæ‰åœ¨â€˜å€’æ•°ç¬¬ä¸€æ­¥â€™é‚£ä¸ªä½ç½®ï¼Œå¾€å³èµ°ç«Ÿç„¶æ‹¿åˆ°äº†é’±ï¼è®°ä¸‹æ¥ï¼Œä»¥ååˆ°äº†é‚£é‡Œå°±å¾€å³èµ°ã€‚â€
è¿™å°±æ˜¯â€œäº‹åâ€ï¼š åªæœ‰åœ¨å¥–é‡‘å‘ç”Ÿä¹‹åï¼Œå®ƒæ‰å›å¤´ç»™â€œä¸Šä¸€ä¸ªåŠ¨ä½œâ€æ‰“é«˜åˆ†ã€‚</p>
<h4 data-id="heading-11">3.2.3. ç¬¬ä¸‰é˜¶æ®µï¼šå…¨å±€è¿é€šï¼ˆæˆå‹åçš„â€œäº‹åâ€ï¼‰</h4>
<p>éšç€è®­ç»ƒç»§ç»­ï¼Œæ¨¡å‹å¼€å§‹å±•ç°å‡ºä¸€ç§â€œé€çº§å¤ç›˜â€çš„èƒ½åŠ›ï¼š
æ—¢ç„¶â€œå€’æ•°ç¬¬ä¸€æ­¥â€å€¼é’±äº†ï¼Œé‚£ä¹ˆâ€œå€’æ•°ç¬¬äºŒæ­¥â€åœ¨å¤ç›˜æ—¶å°±ä¼šå‘ç°ï¼šâ€œå˜¿ï¼Œå¦‚æœæˆ‘èƒ½èµ°åˆ°â€˜å€’æ•°ç¬¬ä¸€æ­¥â€™ï¼Œæˆ‘å°±ç¦»é’±ä¸è¿œäº†ã€‚â€
æ¥åŠ›æ£’ä¼ å¯¼ï¼š è¿™ç§â€œäº‹åâ€çš„è§‰æ‚Ÿï¼Œä¼šä»ç»ˆç‚¹å¼€å§‹ï¼Œæ²¿ç€æ—¶é—´è½´ä¸€å¸§ä¸€å¸§åœ°å‘å›ä¼ å¯¼ã€‚
æœ€ç»ˆç»“æœï¼š è®­ç»ƒç»“æŸæ—¶ï¼Œæ¨¡å‹åœ¨èµ·ç‚¹å°±èƒ½é€šè¿‡ Q å‡½æ•°çœ‹åˆ°ï¼šâ€œå¦‚æœæˆ‘å¾€å·¦èµ°ï¼Œç»è¿‡ 100 æ­¥çš„ä¼ å¯¼ï¼Œæœ€ç»ˆèƒ½æ‹¿åˆ°é’±ã€‚â€</p>
<h4 data-id="heading-12">3.2.4. â€œäº‹åè¯¸è‘›äº®â€å¸¦æ¥çš„æŒ‘æˆ˜</h4>
<p>æ­£å› ä¸ºå®ƒæ˜¯â€œäº‹åâ€åæ¨ï¼Œæ‰€ä»¥ä¼šå¸¦æ¥å‡ ä¸ªå‰¯ä½œç”¨ï¼š</p>
<ul>
<li>å»¶è¿Ÿæ»¡è¶³å¸¦æ¥çš„å›°éš¾ï¼š å¦‚æœåºåˆ—å¤ªé•¿ï¼ˆæ¯”å¦‚è¦èµ° 1 ä¸‡æ­¥æ‰æœ‰å¥–ï¼‰ï¼Œè¿™ç§â€œåå‘æµ¸æ¶¦â€çš„é€Ÿåº¦ä¼šéå¸¸æ…¢ã€‚æ¨¡å‹å¯èƒ½éœ€è¦é‡‡æ ·æ•°ç™¾ä¸‡æ¬¡ï¼Œæ‰èƒ½è®©èµ·ç‚¹çš„åŠ¨ä½œæ„ŸçŸ¥åˆ° 1 ä¸‡æ­¥ä¹‹åçš„æ”¶ç›Šã€‚</li>
<li>ä¿¡ç”¨åˆ†é…é—®é¢˜ï¼ˆCredit Assignmentï¼‰ï¼š åˆ°åº•æ˜¯å› ä¸ºå“ªä¸€æ­¥åšå¾—å¥½æ‰æ‹¿åˆ°çš„å¥–ï¼Ÿå¼‚ç­–ç•¥é çš„æ˜¯è€å¿ƒâ€”â€”é€šè¿‡æˆåƒä¸Šä¸‡æ¬¡æ‰“æ•£çš„é‡‡æ ·å’Œåæ¨ï¼Œæ…¢æ…¢ç£¨æ‰å™ªå£°ï¼ŒæŠŠåŠŸåŠ³å½’äºæ­£ç¡®çš„åŠ¨ä½œã€‚</li>
</ul>
<h3 data-id="heading-13">3.3. æ€»ç»“</h3>
<ul>
<li>
<p>â€‹<strong>ç»Ÿè®¡ä¸Šçš„ç‹¬ç«‹ï¼ˆæ‰“æ•£çš„ç›®çš„ï¼‰</strong>ï¼šæ˜¯ä¸ºäº†è®©æ¢¯åº¦æ›´æ–°æ›´å¹³ç¨³ï¼Œé¿å…æ¨¡å‹å› ä¸ºè¿ç»­å¤„ç†ç›¸ä¼¼çš„æ ·æœ¬è€Œäº§ç”Ÿå‰§çƒˆéœ‡è¡ï¼ˆé˜²æ­¢è¿‡æ‹Ÿåˆåˆ°å½“å‰è½¨è¿¹ï¼‰ã€‚**</p>
</li>
<li>
<p>â€‹<strong>é€»è¾‘ä¸Šçš„ç›¸å…³ï¼ˆå­¦ä¹ çš„åŸºç¡€ï¼‰<strong>â€‹</strong>ï¼šæ ·æœ¬å†…éƒ¨çš„<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>â†’</mo><mi>a</mi><mo>â†’</mo><mi>s</mi><mtext>â€²</mtext></mrow><annotation encoding="application/x-tex">sâ†’aâ†’sâ€²</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.5556em;"/><span class="mord mathnormal">s</span><span class="mord">â€²</span></span></span></span></span>è½¬ç§»é€»è¾‘ä»æœªè¢«ç ´åã€‚ç¥ç»ç½‘ç»œå­¦ä¹ çš„æ˜¯è¿™ä¸ªâ€‹</strong>è½¬ç§»è§„å¾‹<strong>â€‹</strong>ã€‚åªè¦å®ƒæŒæ¡äº†è§„å¾‹ï¼Œå°±èƒ½é¢„æµ‹ä»»ä½•åºåˆ—ï¼Œè€Œä¸éœ€è¦æŒ‰é¡ºåºè§‚å¯Ÿåºåˆ—ã€‚</p>
</li>
</ul>
<blockquote>
<p>å¼‚ç­–ç•¥æ‰“æ•£çš„æ˜¯â€‹<strong>è®­ç»ƒæ•°æ®çš„é‡‡æ ·åˆ†å¸ƒ</strong>â€‹ï¼Œä»¥æ»¡è¶³æ•°å­¦ä¼˜åŒ–çš„ç¨³å®šæ€§éœ€æ±‚ï¼›è€Œåºåˆ—çš„<strong>é€»è¾‘è¿è´¯æ€§</strong>åˆ™é€šè¿‡è´å°”æ›¼æ–¹ç¨‹è¿™ä¸€æ•°å­¦çº½å¸¦ï¼Œåœ¨Qå€¼çš„è¿­ä»£è¿‡ç¨‹ä¸­è¢«å®Œç¾åœ°ä¿ç•™å¹¶é‡å»ºäº†ã€‚</p>
</blockquote>
<h3 data-id="heading-14">3.4. å¼‚ç­–ç•¥çš„ä¼˜ç‚¹</h3>
<h4 data-id="heading-15">3.4.1. æé«˜çš„æ ·æœ¬æ•ˆç‡ (Sample Efficiency)</h4>
<ul>
<li>ç»éªŒå›æ”¾ (Experience Replay)ï¼šå¼‚ç­–ç•¥å…è®¸æ™ºèƒ½ä½“å°†è¿‡å»ç»å†çš„æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨â€œç»éªŒæ± â€ä¸­ï¼Œå¹¶åœ¨åç»­è®­ç»ƒä¸­å¤šæ¬¡é‡å¤æŠ½å–ä½¿ç”¨ã€‚</li>
<li>å¯¹æ¯”ï¼šåŒç­–ç•¥ï¼ˆOn-Policyï¼‰ç®—æ³•åœ¨æ›´æ–°ä¸€æ¬¡å‚æ•°åï¼Œä¹‹å‰æ”¶é›†çš„æ•°æ®å°±å› ä¸æ–°ç­–ç•¥ä¸åŒ¹é…è€Œå¿…é¡»ä¸¢å¼ƒï¼›è€Œå¼‚ç­–ç•¥å¯ä»¥æŒç»­å‹æ¦¨æ—§æ•°æ®çš„ä»·å€¼ï¼Œæå¤§åœ°å‡å°‘äº†ä¸ç¯å¢ƒäº¤äº’çš„æ€»æ¬¡æ•°ã€‚</li>
</ul>
<h4 data-id="heading-16">3.4.2. è§£è€¦æ¢ç´¢ä¸åˆ©ç”¨ (Decoupling Exploration and Exploitation)</h4>
<ul>
<li>è‡ªç”±æ¢ç´¢ï¼šåœ¨å¼‚ç­–ç•¥ä¸­ï¼Œè´Ÿè´£æ”¶é›†æ•°æ®çš„â€œè¡Œä¸ºç­–ç•¥â€å¯ä»¥éå¸¸æ¿€è¿›ï¼ˆä¾‹å¦‚å®Œå…¨éšæœºæ¢ç´¢ï¼‰ï¼Œè€Œâ€œç›®æ ‡ç­–ç•¥â€åˆ™å¯ä»¥ä¸“æ³¨äºå­¦ä¹ æœ€ä¼˜çš„è´ªå©ªåŠ¨ä½œã€‚</li>
<li>é™ä½é£é™©ï¼šåœ¨è‡ªåŠ¨é©¾é©¶ç­‰é«˜é£é™©é¢†åŸŸï¼Œå¯ä»¥ä½¿ç”¨å®‰å…¨çš„åŸºå‡†ç­–ç•¥æ¥æ”¶é›†æ•°æ®ï¼Œè€Œè®©æ¨¡å‹åœ¨åå°å®‰å…¨åœ°å­¦ä¹ æ›´ä¼˜æ–¹æ¡ˆï¼Œæ— éœ€æ™ºèƒ½ä½“äº²è‡ªä»¥ä¸æˆç†Ÿçš„ç­–ç•¥å»å†’é™©ã€‚</li>
</ul>
<h4 data-id="heading-17">3.4.3. æ•°æ®æ¥æºçš„å¤šæ ·æ€§</h4>
<ul>
<li>å­¦ä¹ ä»–äººç»éªŒï¼šå¼‚ç­–ç•¥ç®—æ³•ä¸ä»…èƒ½å­¦ä¹ è‡ªå·±çš„å†å²è®°å½•ï¼Œè¿˜èƒ½å­¦ä¹ äººç±»ä¸“å®¶çš„æ¼”ç¤ºæ•°æ®æˆ–å…¶ä»–ç®—æ³•ç”Ÿæˆçš„è½¨è¿¹ã€‚</li>
<li>ç¦»çº¿å­¦ä¹  (Offline RL)ï¼šå®ƒæ”¯æŒç›´æ¥ä»é™æ€çš„å†å²æ•°æ®é›†ä¸­æå–çŸ¥è¯†ï¼Œè¿™ä½¿å¾—å®ƒåœ¨æ— æ³•å®æ—¶äº¤äº’çš„åœºæ™¯ï¼ˆå¦‚åŒ»ç–—å†³ç­–ã€é‡‘èäº¤æ˜“ï¼‰ä¸­æˆä¸ºå”¯ä¸€å¯è¡Œçš„æ–¹æ¡ˆã€‚</li>
</ul>
<h4 data-id="heading-18">3.4.4. æ¶ˆé™¤æ•°æ®ç›¸å…³æ€§ï¼Œæå‡è®­ç»ƒç¨³å®šæ€§</h4>
<ul>
<li>æ‰“ä¹±æ—¶åºç›¸å…³æ€§ï¼šé€šè¿‡ä»ç»éªŒæ± ä¸­éšæœºé‡‡æ ·ï¼ˆRandom Samplingï¼‰ï¼Œå¼‚ç­–ç•¥æœ‰æ•ˆåœ°æ‰“ç ´äº†è¿ç»­åŠ¨ä½œä¹‹é—´çš„å¼ºç›¸å…³æ€§ã€‚</li>
<li>ç±»æ¯”ï¼šè¿™ç±»ä¼¼äºå­¦ç”Ÿå¤ä¹ æ—¶æ‰“ä¹±é¢˜ç›®é¡ºåºç»ƒä¹ ï¼Œè€Œä¸æ˜¯æ­»è®°ç¡¬èƒŒæŸä¸€æ¬¡è€ƒè¯•çš„é¢˜ç›®é¡ºåºï¼Œä»è€Œè®©ç¥ç»ç½‘ç»œå­¦ä¹ åˆ°æ›´æœ¬è´¨çš„è§„å¾‹ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆã€‚</li>
</ul>
<h4 data-id="heading-19">3.4.5. æ•°å­¦æœºåˆ¶çš„ä¿éšœ</h4>
<ul>
<li>é‡è¦æ€§é‡‡æ · (Importance Sampling)ï¼šé€šè¿‡æ•°å­¦ä¸Šçš„é‡åŠ æƒæŠ€æœ¯ï¼Œå¼‚ç­–ç•¥èƒ½å¤Ÿä¿®æ­£è¡Œä¸ºç­–ç•¥ä¸ç›®æ ‡ç­–ç•¥ä¹‹é—´çš„åˆ†å¸ƒåå·®ï¼Œç¡®ä¿å³ä½¿æ•°æ®æ¥æºä¸åŒï¼Œæ¢¯åº¦çš„ä¼°è®¡ä¾ç„¶æ˜¯å‡†ç¡®æˆ–æ”¶æ•›çš„ã€‚</li>
<li>æœ€ä¼˜å€¼å‡½æ•°ä¼°è®¡ï¼šå¦‚ Q-Learningï¼Œå®ƒç›´æ¥åˆ©ç”¨è´å°”æ›¼æœ€ä¼˜æ–¹ç¨‹ï¼ˆBellman Optimality Equationï¼‰æ¥æ›´æ–°ï¼Œè¿™ä¿è¯äº†åªè¦æ•°æ®è¦†ç›–è¶³å¤Ÿå¹¿ï¼Œå®ƒå°±èƒ½æ”¶æ•›åˆ°æœ€ä¼˜ç­–ç•¥ï¼Œæ— è®ºæ•°æ®ç”±è°äº§ç”Ÿã€‚</li>
</ul>
<h2 data-id="heading-20">4. åŒç­–ç•¥ï¼ˆon-policyï¼‰</h2>
<p>åœ¨å¼ºåŒ–å­¦ä¹ ä¸­ï¼ŒåŒç­–ç•¥ï¼ˆOn-policyï¼‰ç®—æ³•æŒ‡çš„æ˜¯ï¼šâ€œæ­£åœ¨å­¦ä¹ ã€æ›´æ–°çš„ç­–ç•¥â€ä¸â€œåœ¨ç¯å¢ƒä¸­å®é™…å¹²æ´»ã€é‡‡æ ·æ•°æ®çš„ç­–ç•¥â€å¿…é¡»æ˜¯åŒä¸€ä¸ªã€‚</p>
<p>é€šä¿—ç‚¹è¯´ï¼Œå°±æ˜¯â€œè¾¹ç»ƒè¾¹æ‰“â€â€”â€”ä½ å¿…é¡»äº²è‡ªä¸‹åœºå®æˆ˜ï¼Œæ ¹æ®è‡ªå·±å½“ä¸‹çš„åé¦ˆæ¥è°ƒæ•´è‡ªå·±çš„åŠ¨ä½œï¼Œè€Œä¸èƒ½é çœ‹åˆ«äººçš„å½•åƒæˆ–è‡ªå·±å¾ˆä¹…ä»¥å‰çš„ç»éªŒæ¥å­¦ä¹ ã€‚</p>
<ul>
<li>â€‹<strong>ä¸€è‡´æ€§</strong>â€‹**ï¼šç”¨äºç”Ÿæˆè¡Œä¸ºçš„æ•°æ®é‡‡é›†ç­–ç•¥ï¼ˆBehavior Policyï¼‰ä¸è¢«æ”¹è¿›çš„ç›®æ ‡ç­–ç•¥ï¼ˆTarget Policyï¼‰æ˜¯åŒä¸€ä¸ªã€‚**</li>
<li>â€‹<strong>å³ç”¨å³å¼ƒ</strong>â€‹**ï¼šç”±äºå­¦ä¹ å¿…é¡»åŸºäºâ€œå½“å‰çš„â€ç­–ç•¥ï¼Œä¸€æ—¦ç­–ç•¥æ›´æ–°ï¼Œä¹‹å‰æ—§ç­–ç•¥äº§ç”Ÿçš„æ•°æ®å°±ä¸å†é€‚ç”¨ï¼Œå¿…é¡»ä¸¢å¼ƒå¹¶é‡æ–°é‡‡é›†ã€‚**</li>
<li>â€‹<strong>æ ·æœ¬åˆ†å¸ƒä¸€è‡´</strong>â€‹**ï¼šå› ä¸ºæ•°æ®æ˜¯ç”±å½“å‰ç­–ç•¥ç›´æ¥ç”Ÿæˆçš„ï¼Œæ•°æ®çš„ç»Ÿè®¡åˆ†å¸ƒä¸ç­–ç•¥çš„ç›®æ ‡åˆ†å¸ƒå®Œå…¨ä¸€è‡´ï¼Œä¸éœ€è¦åƒå¼‚ç­–ç•¥é‚£æ ·ä½¿ç”¨é‡è¦æ€§é‡‡æ ·æ¥ä¿®æ­£åå·®**</li>
</ul>
<p>å°±åƒä¸€ä½å¨å¸ˆåœ¨å­¦åšæ–°èœï¼Œä»–å¿…é¡»äº²è‡ªåŠ¨æ‰‹å°è¯•æ¯ä¸€é“å·¥åºï¼Œå¹¶æ ¹æ®<strong>è¿™ä¸€æ¬¡</strong>åšå‡ºæ¥çš„å‘³é“ï¼ˆåé¦ˆï¼‰æ¥è°ƒæ•´<strong>ä¸‹ä¸€æ¬¡</strong>æ”¾ç›çš„åˆ†é‡ã€‚ä»–ä¸èƒ½é€šè¿‡çœ‹åˆ«äººï¼ˆå¼‚ç­–ç•¥ï¼‰çš„è§†é¢‘æ¥ç›´æ¥æ”¹è¿›è‡ªå·±çš„æ‰‹æ„Ÿã€‚</p>
<h2 data-id="heading-21">5. åŒç­–ç•¥vså¼‚ç­–ç•¥</h2>
<ul>
<li><strong>åŒç­–ç•¥ï¼ˆOn-Policyï¼‰åƒæ˜¯åœ¨çœ‹è§†é¢‘ï¼šä½ å¿…é¡»å®Œæ•´åœ°çœ‹ä¸€éè§†é¢‘æ‰èƒ½ç†è§£å‰§æƒ…ï¼Œå¦‚æœå¿«è¿›æˆ–è·³è¿‡ï¼Œä½ å°±ä¹±äº†ã€‚</strong></li>
<li><strong>å¼‚ç­–ç•¥ï¼ˆOff-Policyï¼‰åƒæ˜¯åœ¨æ‹¼åœ°å›¾ï¼š</strong>
<ul>
<li>ä½ æ”¶é›†çš„æ˜¯æˆåƒä¸Šä¸‡å¼ ç¢ç‰‡ç…§ç‰‡ï¼ˆæ¯ä¸€ä¸ªæ ·æœ¬<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo separator="true">,</mo><mi>r</mi><mo separator="true">,</mo><mi>s</mi><mtext>â€²</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s,a,r,sâ€²)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">s</span><span class="mord">â€²</span><span class="mclose">)</span></span></span></span></span> ï¼‰ã€‚</li>
<li>æ¯å¼ ç…§ç‰‡åªæ‹äº†ä¸€ä¸ªè·¯å£ã€‚</li>
<li>è™½ç„¶ç…§ç‰‡æ˜¯ä¹±åºæ´—å‡ºæ¥çš„ï¼Œä½†åªè¦ç…§ç‰‡è¦†ç›–äº†æ‰€æœ‰è·¯å£ï¼Œä½ å°±èƒ½é€šè¿‡ç…§ç‰‡è¾¹ç¼˜çš„é‡åˆéƒ¨åˆ†ï¼ˆç›¸åŒçš„så’Œsâ€²ï¼‰ï¼Œåœ¨è„‘æµ·ä¸­æ„å»ºå‡ºä¸€å¼ å®Œæ•´çš„äº¤é€šæ¢çº½å›¾ã€‚</li>
<li>â€‹ç»“æœï¼šä½ ä¸éœ€è¦æŒ‰é¡ºåºèµ°ä¸€éè·¯ï¼Œä¹Ÿèƒ½çŸ¥é“ä» A ç‚¹åˆ° Z ç‚¹çš„æœ€ä¼˜è·¯å¾„ã€‚</li>
</ul>
</li>
</ul>
<ul>
<li>å¼‚ç­–ç•¥ï¼š åƒâ€œå¤ç›˜é«˜æ‰‹â€ã€‚å®ƒå¯ä»¥åˆ©ç”¨ä»»ä½•æ•°æ®å­¦ä¹ ï¼Œä¸ç®¡æ˜¯è‡ªå·±ä»¥å‰çš„æ•°æ®ã€åˆ«äººçš„æ•°æ®ï¼Œç”šè‡³æ˜¯éšæœºä¹±è¯•çš„æ•°æ®ï¼ˆåªè¦æœ‰ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo separator="true">,</mo><mi>r</mi><mo separator="true">,</mo><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup></mrow><annotation encoding="application/x-tex">s,a,r,s^{\prime }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9463em;vertical-align:-0.1944em;"/><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></span> è¿™ç§è®°å½•å°±è¡Œï¼‰ã€‚</li>
<li>åŒç­–ç•¥ï¼š åƒâ€œç°åœºæ•™å­¦â€ã€‚è€å¸ˆæ•™ä½ æ¸¸æ³³ï¼Œä½ å¿…é¡»ç°åœ¨è·³ä¸‹æ°´æ¸¸ä¸€åœˆï¼Œè€å¸ˆæ ¹æ®ä½ è¿™è¿™ä¸€åœˆçš„åŠ¨ä½œç»™ä½ æŒ‡ç‚¹ã€‚ä½ æ˜¨å¤©æ¸¸çš„é‚£ä¸€åœˆï¼ˆæ—§æ•°æ®ï¼‰å¯¹è€å¸ˆä»Šå¤©çš„æŒ‡ç‚¹å·²ç»æ²¡æœ‰å‚è€ƒä»·å€¼äº†ï¼Œå› ä¸ºä½ ä»Šå¤©çš„æ°´å¹³å’Œæ˜¨å¤©å·²ç»ä¸ä¸€æ ·äº†ã€‚</li>
</ul>
<h2 data-id="heading-22">6. æ¢¯åº¦è¿‡æœŸ</h2>
<p><strong>æ—¢ç„¶å¼‚ç­–ç•¥å…è®¸ä½¿ç”¨å†å²æ•°æ®ï¼Œä¸ºä»€ä¹ˆè¿˜ä¼šæ‹…å¿ƒæ¢¯åº¦â€œè¿‡æœŸâ€å‘¢ï¼Ÿ</strong>
ç­”æ¡ˆåœ¨äºï¼šâ€‹**å¼‚ç­–ç•¥çš„æ•°æ®å…¼å®¹æ€§â€ä¸â€œä¼˜åŒ–ç®—æ³•çš„æ¢¯åº¦æ–¹å‘â€æ˜¯ä¸¤ä¸ªå±‚é¢çš„é—®é¢˜ **</p>
<h3 data-id="heading-23">6.1 å¼‚ç­–ç•¥ç¡®å®èƒ½ç”¨æ—§æ•°æ®ï¼Œä½†â€œæ¢¯åº¦â€æ˜¯å³æ—¶çš„</h3>
<p>è™½ç„¶å¼‚ç­–ç•¥ï¼ˆå¦‚ DQNï¼‰å¯ä»¥ä»ç»éªŒæ± ä¸­æŠ½å–ä¸€å¹´å‰çš„æ•°æ®ï¼Œä½†åœ¨è®¡ç®—æ¢¯åº¦æ—¶ï¼Œå®ƒæ˜¯ç”¨<strong>å½“å‰çš„å‚æ•°</strong>å»è¯„ä¼°è¿™äº›æ—§æ•°æ®çš„ã€‚</p>
<ul>
<li>â€‹<strong>å¼‚ç­–ç•¥çš„æ“ä½œ</strong>â€‹ï¼šæ‹¿ç€â€œç°åœ¨çš„ Q ç½‘ç»œâ€å»å¯¹æ¯”â€œæ—§æ ·æœ¬é‡Œçš„å¥–åŠ±â€ï¼Œè®¡ç®—è¯¯å·®ï¼ˆTD Errorï¼‰ï¼Œç„¶åæ›´æ–°ã€‚</li>
<li>â€‹<strong>å¼‚æ­¥çš„é—®é¢˜</strong>â€‹ï¼šåœ¨å¼‚æ­¥æ›´æ–°ä¸­ï¼ŒWorker A åœ¨æ—¶é—´ç‚¹ T1æ‹¿åˆ°æ¨¡å‹å‚æ•°å¼€å§‹ç®—æ¢¯åº¦ï¼Œç­‰å®ƒç®—å®Œå‡†å¤‡æäº¤æ—¶å·²ç»æ˜¯T10äº†ï¼Œæ­¤æ—¶å…¨å±€å‚æ•°å·²ç»è¢« Worker Bã€C ä¿®æ”¹äº† 9 æ¬¡ã€‚</li>
<li>â€‹<strong>è¿‡æœŸæ¢¯åº¦ï¼ˆStale Gradientï¼‰çš„æœ¬è´¨</strong>â€‹ï¼šWorker A ç®—å‡ºçš„æ¢¯åº¦æ–¹å‘æ˜¯æŒ‡å‘T1 ç‰ˆæœ¬çš„å±±è°·ï¼Œä½†ç°åœ¨çš„æ¨¡å‹å·²ç»ç«™åœ¨äº† T10çš„ä½ç½®ã€‚è¿™å°±å¥½æ¯”ä½ æ‹¿ç€æ˜¨å¤©çš„åœ°å›¾T1çš„æ¢¯åº¦åœ¨ä»Šå¤©çš„åœ°å½¢T10 çš„å‚æ•°ä¸Šèµ°ï¼Œè™½ç„¶åœ°å›¾ä¸Šçš„è·¯ï¼ˆæ ·æœ¬æ•°æ®ï¼‰æ˜¯çœŸçš„ï¼Œä½†ä½ çš„æ–¹ä½ï¼ˆå‚æ•°çŠ¶æ€ï¼‰é”™äº†ï¼Œè¿™ä¼šå¯¼è‡´æ›´æ–°æ–¹å‘åç¦»æœ€ä¼˜è·¯å¾„</li>
</ul>
<h3 data-id="heading-24">6.2. å¼‚ç­–ç•¥çš„â€œå®¹å¿åº¦â€å¹¶éæ— é™</h3>
<p>è™½ç„¶å¼‚ç­–ç•¥åœ¨æ•°å­¦ä¸Šå…è®¸æ•°æ®åˆ†å¸ƒä¸ä¸€è‡´ï¼Œä½†å¦‚æœâ€‹<strong>æ•°æ®ç‰ˆæœ¬</strong>â€‹ï¼ˆè¡Œä¸ºç­–ç•¥ï¼‰ä¸â€‹<strong>å½“å‰å­¦ä¹ ç‰ˆæœ¬</strong>â€‹ï¼ˆç›®æ ‡ç­–ç•¥ï¼‰å·®å¼‚è¿‡å¤§ï¼Œä¼šäº§ç”Ÿä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li>â€‹<strong>é‡è¦æ€§åç§»</strong>â€‹ï¼šå¦‚æœç°åœ¨çš„ç­–ç•¥å·²ç»è¿›åŒ–å¾—éå¸¸å‰å®³ï¼Œè€Œæ—§æ•°æ®å…¨æ˜¯éšæœºä¹±æ’çš„â€œåƒåœ¾æ•°æ®â€ï¼Œè¿™äº›æ•°æ®å¯¹å½“å‰æ›´æ–°çš„è´¡çŒ®åº¦ï¼ˆæœ‰æ•ˆä¿¡æ¯ï¼‰ä¼šå˜å¾—æä½ã€‚</li>
<li>â€‹<strong>æ”¶æ•›å˜æ…¢</strong>â€‹ï¼šè¿‡æœŸæ¢¯åº¦å°±åƒæ˜¯åœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­åŠ å…¥äº†â€œæ»åå™ªå£°â€ã€‚åœ¨å¼‚æ­¥è®­ç»ƒä¸­ï¼Œå¦‚æœå»¶è¿Ÿï¼ˆStalenessï¼‰å¤ªé«˜ï¼Œè¿™ç§å™ªå£°ä¼šæ©ç›–çœŸæ­£çš„ä¸‹é™æ–¹å‘ï¼Œå¯¼è‡´æ¨¡å‹ä¸æ”¶æ•›ã€‚</li>
</ul>
<h3 data-id="heading-25">6.3. Q-learning ä¹Ÿæ€•è¿‡æœŸæ¢¯åº¦</h3>
<p>Q-learning è™½ç„¶æ˜¯å¼‚ç­–ç•¥ï¼Œä½†å®ƒä¾èµ–â€‹<strong>è‡ªä¸¾</strong>ï¼ˆBootstrapping) :â€‹<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>â†</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>+</mo><mi>Î±</mi><mo stretchy="false">[</mo><mi>r</mi><mo>+</mo><mi>Î³</mi><mi>m</mi><mi>a</mi><mi>x</mi><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mtext>â€²</mtext><mo separator="true">,</mo><mi>a</mi><mtext>â€²</mtext><mo stretchy="false">)</mo><mo>âˆ’</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">Q(s,a)â†Q(s,a)+Î±[r+Î³maxQ(sâ€²,aâ€²)âˆ’Q(s,a)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">â†</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.0037em;">Î±</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">Î³ma</span><span class="mord mathnormal">x</span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mord">â€²</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">a</span><span class="mord">â€²</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">a</span><span class="mclose">)]</span></span></span></span></span>
æ³¨æ„ç­‰å¼å³è¾¹çš„<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mtext>â€²</mtext><mo separator="true">,</mo><mi>a</mi><mtext>â€²</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">maxQ(sâ€²,aâ€²)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mord">â€²</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">a</span><span class="mord">â€²</span><span class="mclose">)</span></span></span></span></span> ï¼Œåœ¨å¼‚æ­¥æ›´æ–°ä¸­ï¼Œå¦‚æœä¸€ä¸ª Worker è®¡ç®—æ¢¯åº¦æ—¶ç”¨çš„ Qå€¼ç‰ˆæœ¬å¤ªæ—§ï¼Œå®ƒè®¡ç®—å‡ºæ¥çš„ <strong>TD Target</strong> å°±æ˜¯è¿‡æœŸçš„ã€‚ç”¨ä¸€ä¸ªè¿‡æœŸçš„ç›®æ ‡å»ä¿®æ­£ç°åœ¨çš„å‚æ•°ï¼Œä¼šé€ æˆé€»è¾‘ä¸Šçš„å‰åçŸ›ç›¾ï¼ˆå³ç›®æ ‡å€¼çš„ä¸ç¨³å®šï¼‰ï¼Œè¿›è€Œå¼•å‘éœ‡è¡ã€‚</p>
<h3 data-id="heading-26">6.4. æ€»ç»“ï¼šæ•°æ® vs. æ¢¯åº¦</h3>
<p>ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œæˆ‘ä»¬å¯ä»¥åšè¿™æ ·ä¸€ä¸ªåŒºåˆ†ï¼š</p>
<ul>
<li>â€‹<strong>å¼‚ç­–ç•¥è§£å†³äº†â€œæ•°æ®è¿‡æœŸâ€çš„é—®é¢˜</strong>â€‹ï¼šå®ƒå…è®¸ä½ æŠŠé™ˆæ—§çš„ç»éªŒï¼ˆState, Actionï¼‰å–‚ç»™æ¨¡å‹ã€‚</li>
<li>â€‹<strong>åŒæ­¥æœºåˆ¶è§£å†³äº†â€œæ¢¯åº¦è¿‡æœŸâ€çš„é—®é¢˜</strong>â€‹ï¼šå®ƒç¡®ä¿å½“æ¨¡å‹æ ¹æ®è¿™äº›ç»éªŒè¿›è¡Œå­¦ä¹ æ—¶ï¼Œå®ƒçš„â€œä¿®æ­£åŠ¨ä½œâ€ï¼ˆæ¢¯åº¦ï¼‰æ˜¯é’ˆå¯¹æ¨¡å‹<strong>å½“å‰çŠ¶æ€</strong>çš„æœ€ä¼˜æ–¹å‘ã€‚**</li>
</ul>
<p>å¼‚ç­–ç•¥å°±åƒä½ å¯ä»¥è¯»<strong>æ—§è¯¾æœ¬</strong>å­¦ä¹ ã€‚ä½†â€œå¼‚æ­¥æ›´æ–°â€å¯¼è‡´çš„é—®é¢˜æ˜¯ï¼šè€å¸ˆåœ¨é»‘æ¿ä¸Šå·²ç»è®²åˆ°ç¬¬ 10 è¯¾äº†ï¼Œä½ å´è¿˜åœ¨æŒ‰ç…§ç¬¬ 1 è¯¾çš„ç†è§£å»å›ç­”ç¬¬ 10 è¯¾çš„é—®é¢˜ã€‚è™½ç„¶ç¬¬ 1 è¯¾çš„çŸ¥è¯†ï¼ˆæ•°æ®ï¼‰æ˜¯æ­£ç¡®çš„ï¼Œä½†ä½ çš„å›ç­”æ–¹å‘ï¼ˆæ¢¯åº¦ï¼‰ä¸å½“ä¸‹çš„è¿›åº¦ä¸åŒ¹é…ã€‚</p>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå³ä¾¿åœ¨å¼‚ç­–ç•¥ç®—æ³•ä¸­ï¼Œäººä»¬ä¾ç„¶å€¾å‘äºä½¿ç”¨â€‹**åŒæ­¥å¹¶è¡Œï¼ˆå¦‚ A2C çš„åŒæ­¥ç‰ˆæˆ–å¤§è§„æ¨¡å¹¶è¡Œ DQNï¼‰**â€‹ï¼Œå› ä¸ºè¿™æ ·èƒ½ç¡®ä¿æ¯ä¸€æ¬¡å‚æ•°æ›´æ–°éƒ½æ˜¯â€œæ–°é²œâ€ä¸”â€œå‡†ç¡®â€çš„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‘Šåˆ«â€œä¸€ç¥¨å¦å†³â€ï¼æˆ‘ç”¨ TypeScript é€ äº†ä¸ªå¢é‡ä»£ç æ£€æŸ¥ç¥å™¨]]></title>    <link>https://juejin.cn/post/7598011274686889984</link>    <guid>https://juejin.cn/post/7598011274686889984</guid>    <pubDate>2026-01-22T14:23:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598011274686889984" data-draft-id="7597987896693817379" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‘Šåˆ«â€œä¸€ç¥¨å¦å†³â€ï¼æˆ‘ç”¨ TypeScript é€ äº†ä¸ªå¢é‡ä»£ç æ£€æŸ¥ç¥å™¨"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-22T14:23:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="jamesishandsome"/> <meta itemprop="url" content="https://juejin.cn/user/2907584653428279"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‘Šåˆ«â€œä¸€ç¥¨å¦å†³â€ï¼æˆ‘ç”¨ TypeScript é€ äº†ä¸ªå¢é‡ä»£ç æ£€æŸ¥ç¥å™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2907584653428279/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    jamesishandsome
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-22T14:23:43.000Z" title="Thu Jan 22 2026 14:23:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä½ æ˜¯å¦æ›¾å› å†å²ä»£ç è¦†ç›–ç‡ä½ï¼Œè€Œæ— å¥ˆå…³é—­ CI çš„è´¨é‡é—¨ç¦ï¼Ÿæ˜¯å¦å› å…¨é‡ lint æŠ¥å‘Šå™ªéŸ³å¤ªå¤šï¼Œè€Œå¿½ç•¥äº†çœŸæ­£å…³é”®çš„ä»£ç é—®é¢˜ï¼Ÿä»Šå¤©ï¼Œæˆ‘å¸¦æ¥çš„è¿™ä¸ªå·¥å…·ï¼Œæˆ–è®¸èƒ½ç»ˆç»“è¿™äº›å›°æ‰°ã€‚</p>
</blockquote>
<h2 data-id="heading-0">å‰è¨€ï¼šä¸€ä¸ªæ™®éçš„å¼€å‘å›°å¢ƒ</h2>
<p>åœ¨å¿«é€Ÿè¿­ä»£çš„ç°ä»£è½¯ä»¶å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å›¢é˜Ÿä¸€ç›´é¢ä¸´ä¸€ä¸ªä¸¤éš¾é€‰æ‹©ï¼š</p>
<ul>
<li><strong>ä¸¥æ ¼çš„å…¨é‡æ£€æŸ¥</strong>ï¼šè®¾ç½®é«˜æ ‡å‡†çš„æµ‹è¯•è¦†ç›–ç‡ï¼ˆå¦‚80%ï¼‰å’Œ lint è§„åˆ™ã€‚ç»“æœå¯¼è‡´å¤§é‡å†å²é—ç•™ä»£ç æ‹–ç´¯å…¨å±€ï¼ŒCI é¢‘ç¹å¤±è´¥ï¼Œå›¢é˜Ÿæ€¨å£°è½½é“ã€‚</li>
<li><strong>å¦¥åä¸æ”¾å¼ƒ</strong>ï¼šä¸ºäº†ä¸å½±å“å¼€å‘èŠ‚å¥ï¼Œä¸å¾—ä¸é™ä½æ ‡å‡†ï¼Œç”šè‡³å…³æ‰æ£€æŸ¥ã€‚ä¹…è€Œä¹…ä¹‹ï¼Œä»£ç è´¨é‡æ‚„ç„¶æ»‘å¡ã€‚</li>
</ul>
<p><strong>æœ‰æ²¡æœ‰ä¸€ç§æ–¹æ³•ï¼Œèƒ½ç¡®ä¿â€œæ–°ä»£ç â€å¿…é¡»é«˜è´¨é‡ï¼ŒåŒæ—¶åˆä¸è¢«â€œæ—§å€ºâ€ç»‘æ¶ï¼Ÿ</strong></p>
<p>ç­”æ¡ˆæ˜¯ï¼š<strong>å¢é‡æ£€æŸ¥</strong>ã€‚è¿™å°±æ˜¯æˆ‘å¼€å‘ <code>diff-cover-ts</code> çš„åˆè¡·â€”â€”ä¸€ä¸ªä¸“æ³¨ä¸ºä½ çš„ <strong><code>git diff</code></strong> æä¾›ä¿é©¾æŠ¤èˆªçš„ TypeScript å·¥å…·ã€‚</p>
<h2 data-id="heading-1">ä»€ä¹ˆæ˜¯ diff-cover-tsï¼Ÿ</h2>
<p><code>diff-cover-ts</code> æ˜¯ Python çŸ¥åå·¥å…· <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FBachmann1234%2Fdiff_cover" target="_blank" title="https://github.com/Bachmann1234/diff_cover" ref="nofollow noopener noreferrer">diff_cover</a> çš„é«˜æ€§èƒ½ TypeScript é‡åˆ¶ç‰ˆã€‚å®ƒçš„æ ¸å¿ƒå“²å­¦å¾ˆç®€å•ï¼š</p>
<blockquote>
<p><strong>åªçœ‹ä½ è¿™æ¬¡ä¿®æ”¹äº†ä»€ä¹ˆï¼Œå¹¶ç¡®ä¿è¿™äº›ä¿®æ”¹æ˜¯é«˜è´¨é‡çš„ã€‚</strong></p>
</blockquote>
<p>å®ƒå°†å½“å‰åˆ†æ”¯ï¼ˆä¾‹å¦‚ä½ çš„åŠŸèƒ½åˆ†æ”¯ï¼‰ä¸ç›®æ ‡åˆ†æ”¯ï¼ˆå¦‚ <code>main</code>ï¼‰è¿›è¡Œå¯¹æ¯”ï¼Œ<strong>ä»…</strong>é’ˆå¯¹é‚£äº›è¢«ä¿®æ”¹æˆ–æ–°å¢çš„ä»£ç è¡Œï¼ŒæŠ¥å‘Šå…¶æµ‹è¯•è¦†ç›–ç‡çš„ç¼ºå¤±æˆ–é™æ€ä»£ç è´¨é‡é—®é¢˜ã€‚</p>
<h3 data-id="heading-2">å®ƒå¦‚ä½•å·¥ä½œï¼Ÿ</h3>
<p>æƒ³è±¡ä¸€ä¸‹è¿™ä¸ªåœºæ™¯ï¼šä½ ä¿®æ”¹äº†ä¸€ä¸ªæœ‰1000è¡Œä»£ç çš„æ–‡ä»¶ä¸­çš„10è¡Œã€‚</p>
<ul>
<li>ä¼ ç»Ÿè¦†ç›–ç‡å·¥å…·ï¼šå‘Šè¯‰ä½ æ•´ä¸ªæ–‡ä»¶è¦†ç›–ç‡åªæœ‰30%ã€‚</li>
<li><code>diff-cover-ts</code>ï¼šå‘Šè¯‰ä½ è¿™<strong>æ–°æ”¹çš„10è¡Œ</strong>é‡Œï¼Œæœ‰å“ªå‡ è¡Œæ²¡æœ‰è¢«æµ‹è¯•è¦†ç›–ã€‚</li>
</ul>
<p>ç²¾å‡†ï¼Œä¸” actionableã€‚</p>
<h2 data-id="heading-3">æ ¸å¿ƒäº®ç‚¹ï¼šä¸ºä»€ä¹ˆä½ éœ€è¦å®ƒï¼Ÿ</h2>
<h3 data-id="heading-4">1. ğŸ¯ ç²¾å‡†åˆ¶å¯¼ï¼Œå‘Šåˆ«å™ªéŸ³</h3>
<p>å†ä¹Ÿä¸ç”¨åœ¨æˆåƒä¸Šä¸‡ä¸ª lint è­¦å‘Šæˆ–å…¨é‡è¦†ç›–ç‡æŠ¥å‘Šä¸­å¤§æµ·æé’ˆã€‚<code>diff-cover-ts</code> çš„æŠ¥å‘Šç›´æŒ‡ä½ æœ¬æ¬¡æäº¤å¼•å…¥çš„æ½œåœ¨ç¼ºé™·ï¼Œè®©ä½ ä¸“æ³¨äºä¿®å¤çœŸæ­£ç›¸å…³çš„é—®é¢˜ã€‚</p>
<h3 data-id="heading-5">2. ğŸ¤– å¼€ç®±å³ç”¨ï¼Œæ™ºèƒ½é…ç½®</h3>
<p>å¦‚æœä½ çš„é¡¹ç›®ä½¿ç”¨ <strong>Vite</strong> æˆ– <strong>Vitest</strong>ï¼Œé‚£ä¹ˆä½ å‡ ä¹ä¸éœ€è¦ä»»ä½•é…ç½®ã€‚åªéœ€è¿è¡Œ <code>diff-cover</code> å‘½ä»¤ï¼Œå®ƒä¼šè‡ªåŠ¨è§£æä½ çš„ <code>vite.config.ts</code> æˆ– <code>vitest.config.ts</code>ï¼Œå®šä½è¦†ç›–ç‡æŠ¥å‘Šçš„ä½ç½®å’Œæ ¼å¼ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœ¨ä½ çš„ Vite/Vitest é¡¹ç›®ä¸­</span>
npx diff-cover
</code></pre>
<p>å°±è¿™ä¹ˆç®€å•ã€‚</p>
<h3 data-id="heading-6">3. ğŸ“Š æ ¼å¼é€šåƒï¼Œç”Ÿæ€å‹å¥½</h3>
<p>æ”¯æŒ <code>lcov</code>ã€<code>cobertura</code>ã€<code>clover</code>ã€<code>jacoco</code> ä»¥åŠé€šç”¨ XML æ ¼å¼çš„è¦†ç›–ç‡æŠ¥å‘Šã€‚æ— è®ºä½ çš„æµ‹è¯•æ¡†æ¶æ˜¯ Jestã€Vitest è¿˜æ˜¯å…¶ä»–ï¼Œéƒ½èƒ½è½»æ¾é›†æˆã€‚</p>
<h3 data-id="heading-7">4. ğŸ›¡ï¸ åŒå‰‘åˆç’§ï¼šCoverage + Quality</h3>
<p>å·¥å…·æä¾›ä¸¤å¤§æ ¸å¿ƒå‘½ä»¤ï¼š</p>
<ul>
<li><strong><code>diff-cover</code></strong>ï¼šä¸“æ³¨äº<strong>å¢é‡æµ‹è¯•è¦†ç›–ç‡</strong>åˆ†æã€‚</li>
<li><strong><code>diff-quality</code></strong>ï¼šä¸“æ³¨äº<strong>å¢é‡ä»£ç è´¨é‡</strong>æ£€æŸ¥ï¼Œæ”¯æŒ <code>eslint</code>ã€<code>pylint</code>ã€<code>flake8</code>ã€<code>shellcheck</code> ç­‰å¤šç§æ£€æŸ¥å·¥å…·çš„è¾“å‡ºæŠ¥å‘Šã€‚</li>
</ul>
<h3 data-id="heading-8">5. âš¡ ä¸ºç°ä»£å‰ç«¯æ ˆè€Œç”Ÿ</h3>
<p>é‡‡ç”¨ <strong>TypeScript 5</strong> ç¼–å†™ï¼Œç¡®ä¿ç±»å‹å®‰å…¨ã€‚æ„å»ºä¸å¼€å‘ç¯å¢ƒä¼˜å…ˆæ”¯æŒ <strong>Bun</strong>ï¼ˆåŒæ—¶å…¼å®¹ Node.jsï¼‰ï¼Œå¸¦æ¥æè‡´çš„ä¾èµ–å®‰è£…ä¸è„šæœ¬æ‰§è¡Œé€Ÿåº¦ã€‚</p>
<h2 data-id="heading-9">å®æˆ˜æ¼”ç»ƒï¼š5åˆ†é’Ÿæ¥å…¥ä½ çš„é¡¹ç›®</h2>
<p>è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åœ¨ä¸€ä¸ªå…¸å‹çš„ Vite + TypeScript é¡¹ç›®ä¸­å¿«é€Ÿå¯ç”¨å®ƒã€‚</p>
<h3 data-id="heading-10">æ­¥éª¤ä¸€ï¼šå®‰è£…</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…¨å±€å®‰è£…ï¼ˆæ¨èï¼Œæ–¹ä¾¿åœ¨ä»»ä½•é¡¹ç›®ä¸­ä½¿ç”¨ï¼‰</span>
npm install -g diff-cover

<span class="hljs-comment"># æˆ–ä½œä¸ºé¡¹ç›®å¼€å‘ä¾èµ–</span>
npm install diff-cover --save-dev
</code></pre>
<h3 data-id="heading-11">æ­¥éª¤äºŒï¼šç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š</h3>
<p>é¦–å…ˆï¼Œç¡®ä¿ä½ çš„æµ‹è¯•èƒ½ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Šã€‚ä»¥ Vitest ä¸ºä¾‹ï¼Œåœ¨ <code>vitest.config.ts</code> ä¸­ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vitest/config'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">test</span>: {
    <span class="hljs-attr">coverage</span>: {
      <span class="hljs-attr">reporter</span>: [<span class="hljs-string">'text'</span>, <span class="hljs-string">'json'</span>, <span class="hljs-string">'html'</span>, <span class="hljs-string">'lcov'</span>], <span class="hljs-comment">// å¿…é¡»åŒ…å« lcov æˆ– cobertura ç­‰æ ¼å¼</span>
    },
  },
});
</code></pre>
<p>ç„¶åè¿è¡Œæµ‹è¯•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm <span class="hljs-built_in">test</span> -- --coverage
<span class="hljs-comment"># æˆ–</span>
bun <span class="hljs-built_in">test</span> --coverage
</code></pre>
<h3 data-id="heading-12">æ­¥éª¤ä¸‰ï¼šè¿è¡Œå¢é‡æ£€æŸ¥</h3>
<p>å‡è®¾ä½ åˆšåˆšå®Œæˆäº†ä¸€äº›ä»£ç ä¿®æ”¹ï¼Œå¹¶æƒ³çœ‹çœ‹è¿™äº›æ–°ä»£ç çš„è¦†ç›–ç‡å¦‚ä½•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è‡ªåŠ¨æ¨¡å¼ï¼ˆæ¨èï¼‰</span>
diff-cover

<span class="hljs-comment"># æˆ–æ‰‹åŠ¨æŒ‡å®šæŠ¥å‘Šè·¯å¾„</span>
diff-cover coverage/lcov.info
</code></pre>
<p><strong>è¾“å‡ºç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section">Diff Coverage
-------------</span>
Your diff has 10 lines, covered at 80.00%

Missing lines in diff:
File: src/components/NewFeature.tsx
<span class="hljs-quote">&gt; Line 45:   const handleClick = () =&gt; {</span>
<span class="hljs-quote">&gt; Line 48:     setState(...);</span>
</code></pre>
<h3 data-id="heading-13">æ­¥éª¤å››ï¼šé›†æˆåˆ° CIï¼Œè®¾ç«‹è´¨é‡é—¨ç¦</h3>
<p>çœŸæ­£çš„å¨åŠ›åœ¨äºè‡ªåŠ¨åŒ–ã€‚ä½ å¯ä»¥åœ¨ GitHub Actionsã€GitLab CI ç­‰æµç¨‹ä¸­é›†æˆï¼Œå¹¶è®¾ç½®ä¸€ä¸ªå¯æ¥å—çš„æœ€ä½åˆ†æ•°çº¿ã€‚</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># ç¤ºä¾‹ï¼šGitHub Actions ç‰‡æ®µ</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">Tests</span> <span class="hljs-string">with</span> <span class="hljs-string">Coverage</span>
  <span class="hljs-attr">run:</span> <span class="hljs-string">bun</span> <span class="hljs-string">test</span> <span class="hljs-string">--coverage</span>

<span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Diff</span> <span class="hljs-string">Coverage</span> <span class="hljs-string">Check</span>
  <span class="hljs-attr">run:</span> <span class="hljs-string">|
    npx diff-cover coverage/lcov.info --fail-under 90 --html-report ./diff-report.html
</span>  <span class="hljs-comment"># å¦‚æœæœ¬æ¬¡ä¿®æ”¹çš„ä»£ç è¡Œè¦†ç›–ç‡ä½äº90%ï¼ŒCI å°†å¤±è´¥</span>
</code></pre>
<p>ç°åœ¨ï¼Œæ¯æ¬¡ Pull Request éƒ½ä¼šè‡ªåŠ¨æ£€æŸ¥æ–°ä»£ç çš„è´¨é‡ï¼Œç¡®ä¿åˆå…¥ä¸»å¹²çš„ä»£ç éƒ½æ˜¯ç»è¿‡æµ‹è¯•çš„ã€‚</p>
<h2 data-id="heading-14">é«˜çº§ç©æ³•ä¸é…ç½®</h2>
<h3 data-id="heading-15">ç”Ÿæˆå¯è§†åŒ–æŠ¥å‘Š</h3>
<p>é™¤äº†å‘½ä»¤è¡Œè¾“å‡ºï¼Œä½ è¿˜å¯ä»¥ç”Ÿæˆæ›´è¯¦ç»†çš„ HTML æˆ– JSON æŠ¥å‘Šï¼Œä¾¿äºå­˜æ¡£æˆ–è¿›ä¸€æ­¥åˆ†æã€‚</p>
<pre><code class="hljs language-bash" lang="bash">diff-cover coverage/lcov.info --html-report ./coverage-diff.html
</code></pre>
<h3 data-id="heading-16">èšç„¦ç‰¹å®šæ–‡ä»¶</h3>
<p>é€šè¿‡ glob æ¨¡å¼ï¼Œå¯ä»¥çµæ´»åœ°åŒ…å«æˆ–æ’é™¤æŸäº›æ–‡ä»¶ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åªæ£€æŸ¥ src/features/ ç›®å½•ä¸‹çš„ä¿®æ”¹</span>
diff-cover --include=<span class="hljs-string">"src/features/**"</span>

<span class="hljs-comment"># æ’é™¤æ‰€æœ‰æµ‹è¯•æ–‡ä»¶</span>
diff-cover --exclude=<span class="hljs-string">"**/*.test.*"</span> --exclude=<span class="hljs-string">"**/*.spec.*"</span>
</code></pre>
<h3 data-id="heading-17">è´¨é‡æ£€æŸ¥ç¤ºä¾‹</h3>
<p>ä½¿ç”¨ <code>eslint</code> æ£€æŸ¥æœ¬æ¬¡ä¿®æ”¹çš„ä»£ç è´¨é‡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. å…ˆç”Ÿæˆ eslint æŠ¥å‘Š</span>
npx eslint . --format=checkstyle &gt; eslint-report.xml

<span class="hljs-comment"># 2. è¿›è¡Œå¢é‡è´¨é‡åˆ†æ</span>
diff-quality eslint-report.xml --violations eslint
</code></pre>
<h2 data-id="heading-18">æŠ€æœ¯èƒŒå</h2>
<ul>
<li><strong>å¥å£®æ€§</strong>ï¼šå®Œå–„çš„å•å…ƒæµ‹è¯•è¦†ç›–æ ¸å¿ƒé€»è¾‘ã€‚</li>
<li><strong>ç°ä»£å·¥å…·é“¾</strong>ï¼šä½¿ç”¨ <code>oxlint</code> å’Œ <code>oxfmt</code> ç¡®ä¿ä»£ç é£æ ¼ç»Ÿä¸€ï¼Œå¹¶é€šè¿‡ <code>husky</code> åœ¨æäº¤å‰è‡ªåŠ¨æ£€æŸ¥ã€‚</li>
</ul>
<h2 data-id="heading-19">ç»“è¯­</h2>
<p><code>diff-cover-ts</code> ä¸ä»…ä»…æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œå®ƒä»£è¡¨äº†ä¸€ç§<strong>æ¸è¿›å¼æ”¹å–„</strong>çš„å·¥ç¨‹ç†å¿µã€‚æˆ‘ä»¬ä¸è¿½æ±‚ä¸€å¤œä¹‹é—´ä¿®å¤æ‰€æœ‰æŠ€æœ¯å€ºåŠ¡ï¼Œä½†æˆ‘ä»¬åšå†³æå«æ¯ä¸€æ¬¡æ–°å¢ä»£ç çš„è´¨é‡ã€‚</p>
<p>å®ƒç‰¹åˆ«é€‚åˆï¼š</p>
<ul>
<li>æ‹¥æœ‰å¤§é‡é—ç•™ä»£ç ï¼Œä½†å¸Œæœ›æ–°ä»£ç é«˜è´¨é‡çš„é¡¹ç›®ã€‚</li>
<li>å¸Œæœ›ä¸ºå›¢é˜Ÿè®¾ç«‹ä¸€ä¸ªå…¬å¹³ã€å¯æ‰§è¡Œè´¨é‡æ ‡å‡†çš„ Tech Leadã€‚</li>
<li>è¿½æ±‚é«˜æ•ˆã€ç²¾å‡†åé¦ˆçš„å¼€å‘è€…ã€‚</li>
</ul>
<p><strong>é¡¹ç›®åœ°å€ï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fjamesishandsome%2Fdiff_cover_ts" target="_blank" title="https://github.com/jamesishandsome/diff_cover_ts" ref="nofollow noopener noreferrer">github.com/jamesishandâ€¦</a></p>
<p>å¦‚æœä½ ä¹Ÿå—å›°äºå…¨é‡æ£€æŸ¥çš„å™ªéŸ³ï¼Œæˆ–è€…æ­£åœ¨å¯»æ‰¾ä¸€ç§æ›´æ™ºèƒ½çš„æ–¹å¼æ¥æå‡ä»£ç è´¨é‡ï¼Œä¸å¦¨è¯•è¯• <code>diff-cover-ts</code>ã€‚æ¬¢è¿ Starã€Issue å’Œ PRï¼</p>
<hr/>
<p><strong>è®©æˆ‘ä»¬çš„æ¯æ¬¡æäº¤ï¼Œéƒ½æ¯”ä¸Šä¸€æ¬¡æ›´å¥½ä¸€ç‚¹ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç²¾é€šGitæ ¸å¿ƒæ“ä½œï¼šä»å…¥é—¨åˆ°é«˜æ•ˆç‰ˆæœ¬æ§åˆ¶]]></title>    <link>https://juejin.cn/post/7597997108135313435</link>    <guid>https://juejin.cn/post/7597997108135313435</guid>    <pubDate>2026-01-22T14:57:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597997108135313435" data-draft-id="7598057199962669107" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç²¾é€šGitæ ¸å¿ƒæ“ä½œï¼šä»å…¥é—¨åˆ°é«˜æ•ˆç‰ˆæœ¬æ§åˆ¶"/> <meta itemprop="keywords" content="Git"/> <meta itemprop="datePublished" content="2026-01-22T14:57:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·575730334624"/> <meta itemprop="url" content="https://juejin.cn/user/2860271309712009"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç²¾é€šGitæ ¸å¿ƒæ“ä½œï¼šä»å…¥é—¨åˆ°é«˜æ•ˆç‰ˆæœ¬æ§åˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2860271309712009/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·575730334624
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-22T14:57:10.000Z" title="Thu Jan 22 2026 14:57:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç²¾é€šGitæ ¸å¿ƒæ“ä½œï¼šä»å…¥é—¨åˆ°é«˜æ•ˆç‰ˆæœ¬æ§åˆ¶</h2>
<p>åœ¨å¤šäººåä½œå¼€å‘ä¸å¤§å‹é¡¹ç›®ç®¡ç†ä¸­ï¼ŒGitå·²æˆä¸ºä¸å¯æˆ–ç¼ºçš„ç‰ˆæœ¬æ§åˆ¶å·¥å…·ã€‚å®ƒä¸ä»…èƒ½ç²¾å‡†è¿½è¸ªæ–‡ä»¶ä¿®æ”¹è®°å½•ã€å®ç°å¤šç‰ˆæœ¬å›æº¯ï¼Œæ›´èƒ½é«˜æ•ˆåè°ƒå›¢é˜Ÿæˆå‘˜çš„å¼€å‘èŠ‚å¥ï¼Œé¿å…ä»£ç å†²çªä¸æ··ä¹±ã€‚æŒæ¡Gitæ ¸å¿ƒå‘½ä»¤ä¸æ“ä½œé€»è¾‘ï¼Œæ˜¯æå‡å¼€å‘æ•ˆç‡ã€ä¿éšœä»£ç å®‰å…¨çš„å¿…å¤‡æŠ€èƒ½ã€‚æœ¬æ–‡å°†ä»åŸºç¡€æ¦‚å¿µå‡ºå‘ï¼Œæ‹†è§£æ ¸å¿ƒæ“ä½œå‘½ä»¤ï¼Œç»“åˆå®æ“åœºæ™¯è®²è§£å®ç”¨æŠ€å·§ï¼Œå¸®åŠ©è¯»è€…å¿«é€Ÿä¸Šæ‰‹Gitç‰ˆæœ¬æ§åˆ¶ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€GitåŸºç¡€è®¤çŸ¥ï¼šæ„å»ºç‰ˆæœ¬æ§åˆ¶æ¡†æ¶</h3>
<p>åœ¨ä½¿ç”¨Gitå‰ï¼Œéœ€æ˜ç¡®æ ¸å¿ƒåŸåˆ™ä¸åŸºç¡€ç»“æ„ï¼Œé¿å…å› æ“ä½œä¸è§„èŒƒå¯¼è‡´ä»£ç ç®¡ç†æ··ä¹±ã€‚</p>
<h4 data-id="heading-2">1. å•ä¸€ä»“åº“åŸåˆ™</h4>
<p>ä¸€ä¸ªé¡¹ç›®å¿…é¡»å¯¹åº”ä¸€ä¸ªGitä»“åº“ï¼Œä¸¥ç¦åœ¨åŒä¸€é¡¹ç›®ç›®å½•ä¸‹åˆ›å»ºå¤šä¸ªä»“åº“ã€‚å¤šä»“åº“ä¼šå¯¼è‡´ç‰ˆæœ¬è®°å½•ç¢ç‰‡åŒ–ï¼Œæ— æ³•ç»Ÿä¸€è¿½è¸ªä¿®æ”¹ã€åˆå¹¶ä»£ç ï¼Œå°¤å…¶åœ¨å¤šäººåä½œæ—¶ï¼Œä¼šå¼•å‘ä¸¥é‡çš„ä»£ç å†²çªä¸ç‰ˆæœ¬æ··ä¹±ã€‚è‹¥éœ€æ‹†åˆ†åŠŸèƒ½æ¨¡å—ï¼Œå¯é€šè¿‡åˆ†æ”¯ç®¡ç†å®ç°ï¼Œè€Œéåˆ›å»ºå¤šä¸ªç‹¬ç«‹ä»“åº“ã€‚</p>
<h4 data-id="heading-3">2. ä»“åº“åˆå§‹åŒ–ä¸æ ¸å¿ƒç»“æ„</h4>
<p>å¯¹äºæ–°å»ºé¡¹ç›®ï¼Œéœ€å…ˆé€šè¿‡åˆå§‹åŒ–å‘½ä»¤åˆ›å»ºGitä»“åº“ï¼šåœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ <code>git init</code>ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆéšè—çš„ <code>.git</code> ç›®å½•ï¼Œè¿™ä¾¿æ˜¯Gitçš„ç‰ˆæœ¬åº“ï¼Œç”¨äºå­˜å‚¨æ‰€æœ‰ç‰ˆæœ¬è®°å½•ã€åˆ†æ”¯ä¿¡æ¯ã€é…ç½®æ–‡ä»¶ç­‰æ ¸å¿ƒæ•°æ®ï¼Œåˆ‡å‹¿æ‰‹åŠ¨åˆ é™¤æˆ–ä¿®æ”¹è¯¥ç›®å½•å†…å®¹ã€‚</p>
<p>åˆå§‹åŒ–åï¼ŒGité»˜è®¤åˆ›å»º <code>master</code> åˆ†æ”¯ï¼ˆéƒ¨åˆ†ç‰ˆæœ¬é»˜è®¤åä¸º <code>main</code>ï¼‰ï¼Œä½œä¸ºé¡¹ç›®çš„ä¸»åˆ†æ”¯ã€‚åŒæ—¶ï¼ŒGitå°†é¡¹ç›®ç›®å½•åˆ’åˆ†ä¸ºä¸‰ä¸ªæ ¸å¿ƒåŒºåŸŸï¼Œå…¶æµè½¬å…³ç³»ç›´æ¥å†³å®šç‰ˆæœ¬æ§åˆ¶é€»è¾‘ï¼š</p>
<ul>
<li><strong>å·¥ä½œåŒº</strong>ï¼šå³æœ¬åœ°å¯è§çš„é¡¹ç›®ç›®å½•ï¼Œç”¨äºæ—¥å¸¸ä»£ç ç¼–å†™ã€ä¿®æ”¹æ“ä½œï¼Œæ‰€æœ‰æ”¹åŠ¨æœ€åˆéƒ½å‘ç”Ÿåœ¨è¯¥åŒºåŸŸã€‚</li>
<li><strong>æš‚å­˜åŒºï¼ˆStage/Indexï¼‰</strong> ï¼šä¸´æ—¶å­˜å‚¨å¾…æäº¤çš„ä¿®æ”¹ï¼Œå¯é€šè¿‡å‘½ä»¤é€‰æ‹©æ€§å°†å·¥ä½œåŒºæ”¹åŠ¨æ·»åŠ è‡³æ­¤ï¼Œä¾¿äºæ‰¹é‡ç®¡ç†æäº¤å†…å®¹ã€‚</li>
<li><strong>ç‰ˆæœ¬åº“</strong>ï¼šå³ <code>.git</code> ç›®å½•ï¼Œå­˜å‚¨å·²æäº¤çš„æ‰€æœ‰ç‰ˆæœ¬å¿«ç…§ï¼Œæ¯ä¸ªç‰ˆæœ¬éƒ½æœ‰å”¯ä¸€æ ‡è¯†ï¼Œå¯éšæ—¶å›æº¯ã€‚</li>
</ul>
<h3 data-id="heading-4">äºŒã€æ ¸å¿ƒå‘½ä»¤å®æ“ï¼šä»ä¿®æ”¹åˆ°æäº¤çš„å®Œæ•´æµç¨‹</h3>
<p>Gitçš„æ ¸å¿ƒæ“ä½œå›´ç»•â€œå·¥ä½œåŒº-æš‚å­˜åŒº-ç‰ˆæœ¬åº“â€çš„æµè½¬å±•å¼€ï¼ŒæŒæ¡ä»¥ä¸‹å‘½ä»¤ï¼Œå¯å®ç°åŸºç¡€ç‰ˆæœ¬æ§åˆ¶éœ€æ±‚ã€‚</p>
<h4 data-id="heading-5">1. çŠ¶æ€æŸ¥çœ‹ï¼š<code>git status</code></h4>
<p>è¿™æ˜¯Gitæœ€åŸºç¡€ä¸”é«˜é¢‘çš„å‘½ä»¤ï¼Œå»ºè®®åœ¨ä»»ä½•æ“ä½œå‰éƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œç”¨äºæŸ¥çœ‹å½“å‰ä»“åº“çŠ¶æ€ï¼šåŒ…æ‹¬å·¥ä½œåŒºæ˜¯å¦æœ‰æœªè·Ÿè¸ªæ–‡ä»¶ã€æš‚å­˜åŒºæ˜¯å¦æœ‰å¾…æäº¤å†…å®¹ã€åˆ†æ”¯æ˜¯å¦åŒæ­¥ç­‰ã€‚æ‰§è¡Œåå¸¸è§çŠ¶æ€æç¤ºï¼š</p>
<ul>
<li>â€œå°šæ— æäº¤â€ï¼šä»“åº“åˆå§‹åŒ–åæœªè¿›è¡Œé¦–æ¬¡æäº¤ï¼Œç‰ˆæœ¬åº“ä¸ºç©ºã€‚</li>
<li>â€œæœªè·Ÿè¸ªçš„æ–‡ä»¶â€ï¼šæ–°å¢æ–‡ä»¶æœªè¢«Gitç®¡ç†ï¼Œéœ€é€šè¿‡ <code>git add</code> å‘½ä»¤çº³å…¥è·Ÿè¸ªèŒƒå›´ã€‚</li>
<li>â€œChanges to be committedâ€ï¼šæ–‡ä»¶å·²æ·»åŠ è‡³æš‚å­˜åŒºï¼Œç­‰å¾…æäº¤åˆ°ç‰ˆæœ¬åº“ã€‚</li>
</ul>
<h4 data-id="heading-6">2. æš‚å­˜ä¸æäº¤ï¼š<code>git add</code> &amp; <code>git commit</code></h4>
<p>æš‚å­˜å‘½ä»¤ <code>git add</code> ç”¨äºå°†å·¥ä½œåŒºæ”¹åŠ¨æ·»åŠ åˆ°æš‚å­˜åŒºï¼Œæ”¯æŒå¤šç§ç”¨æ³•ï¼š<code>git add æ–‡ä»¶å</code> æš‚å­˜æŒ‡å®šæ–‡ä»¶ï¼Œ<code>git add .</code> æš‚å­˜æ‰€æœ‰æ”¹åŠ¨æ–‡ä»¶ã€‚æš‚å­˜åéœ€é€šè¿‡æäº¤å‘½ä»¤å°†å†…å®¹å†™å…¥ç‰ˆæœ¬åº“ï¼š<code>git commit -m "æäº¤è¯´æ˜"</code>ã€‚</p>
<p>æäº¤è¯´æ˜æ˜¯æ ¸å¿ƒè¦ç‚¹ï¼Œéœ€æ¸…æ™°æè¿°æœ¬æ¬¡æ”¹åŠ¨å†…å®¹ï¼ˆå¦‚â€œæ–°å¢ç”¨æˆ·ç™»å½•æ¥å£â€â€œä¿®å¤æ•°æ®æŸ¥è¯¢bugâ€ï¼‰ï¼Œé¿å…æ¨¡ç³Šè¡¨è¿°ï¼Œä¾¿äºåç»­è¿½æº¯ç‰ˆæœ¬å†å²ã€‚æäº¤æˆåŠŸåï¼ŒGitä¼šç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ç‰ˆæœ¬IDï¼ˆåŸºäºSHAç®—æ³•çš„é•¿å­—ç¬¦ä¸²ï¼‰ï¼Œç”¨äºæ ‡è¯†è¯¥ç‰ˆæœ¬ã€‚</p>
<p>ä¸ºä½•é‡‡ç”¨å“ˆå¸ŒIDè€Œéè‡ªå¢IDï¼Ÿåœ¨å¤šäººåä½œåœºæ™¯ä¸­ï¼Œè‡ªå¢IDæ˜“å› å¤šç«¯åŒæ­¥å†²çªå¯¼è‡´é‡å¤ï¼Œè€ŒSHAå“ˆå¸ŒIDé€šè¿‡æ–‡ä»¶å†…å®¹ã€æäº¤æ—¶é—´ç­‰ä¿¡æ¯è®¡ç®—ç”Ÿæˆï¼Œå…¨çƒå”¯ä¸€ï¼Œå¯å®Œç¾é€‚é…åˆ†å¸ƒå¼åä½œéœ€æ±‚ã€‚æäº¤æˆåŠŸåï¼Œç»ˆç«¯ä¼šæç¤ºæ”¹åŠ¨ç»Ÿè®¡ï¼ˆå¦‚â€œ2 insertionsâ€è¡¨ç¤ºæ–°å¢2è¡Œä»£ç ï¼‰ï¼ŒGitæœ¬è´¨ä¸Šå­˜å‚¨çš„æ˜¯æ–‡ä»¶ä¿®æ”¹å·®å¼‚ï¼Œè€Œéå®Œæ•´æ–‡ä»¶å‰¯æœ¬ï¼Œå¤§å¹…èŠ‚çœå­˜å‚¨ç©ºé—´ã€‚</p>
<h4 data-id="heading-7">3. å·®å¼‚æŸ¥çœ‹ï¼š<code>git diff</code></h4>
<p>æäº¤å‰æŸ¥çœ‹æ”¹åŠ¨ç»†èŠ‚æ˜¯è‰¯å¥½ä¹ æƒ¯ï¼Œå¯é¿å…è¯¯æäº¤é”™è¯¯ä»£ç ã€‚<code>git diff</code> å‘½ä»¤é»˜è®¤å¯¹æ¯”å·¥ä½œåŒºä¸æš‚å­˜åŒºçš„æ–‡ä»¶å·®å¼‚ï¼Œæ˜¾ç¤ºå…·ä½“ä¿®æ”¹è¡Œï¼ˆæ–°å¢å†…å®¹æ ‡ç»¿ï¼Œåˆ é™¤å†…å®¹æ ‡çº¢ï¼‰ã€‚è‹¥éœ€å¯¹æ¯”æš‚å­˜åŒºä¸ç‰ˆæœ¬åº“æœ€æ–°ç‰ˆæœ¬ï¼Œå¯æ‰§è¡Œ <code>git diff --cached</code>ã€‚é‡å¤§æäº¤å‰å…ˆæ‰§è¡Œ <code>git diff</code> æ ¸æŸ¥ï¼Œèƒ½æœ‰æ•ˆé™ä½é”™è¯¯æäº¤æ¦‚ç‡ã€‚</p>
<h3 data-id="heading-8">ä¸‰ã€ç‰ˆæœ¬å›æº¯ä¸ä¿®æ”¹æ’¤é”€ï¼šåº”å¯¹æ“ä½œå¤±è¯¯çš„å®ç”¨æŠ€å·§</h3>
<p>å¼€å‘è¿‡ç¨‹ä¸­éš¾å…å‡ºç°è¯¯æäº¤ã€è¯¯ä¿®æ”¹ç­‰é—®é¢˜ï¼ŒGitæä¾›äº†çµæ´»çš„ç‰ˆæœ¬å›æº¯ä¸æ’¤é”€å‘½ä»¤ï¼Œå¯æ ¹æ®ä¸åŒåœºæ™¯é€‰æ‹©ä½¿ç”¨ã€‚</p>
<h4 data-id="heading-9">1. ç‰ˆæœ¬å›æº¯ï¼š<code>git reset</code></h4>
<p>Gité€šè¿‡HEADæŒ‡é’ˆæŒ‡å‘å½“å‰åˆ†æ”¯çš„æœ€æ–°æäº¤ï¼Œç‰ˆæœ¬å›æº¯æœ¬è´¨ä¸Šæ˜¯ç§»åŠ¨HEADæŒ‡é’ˆçš„ä½ç½®ã€‚æ ¸å¿ƒå‘½ä»¤ï¼š<code>git reset --hard HEAD^</code>ï¼Œå…¶ä¸­ <code>HEAD^</code> è¡¨ç¤ºå½“å‰ç‰ˆæœ¬çš„ä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼Œ<code>HEAD^^</code> è¡¨ç¤ºä¸Šä¸¤ä¸ªç‰ˆæœ¬ï¼Œä¹Ÿå¯ç›´æ¥æŒ‡å®šç‰ˆæœ¬IDå›æº¯åˆ°å…·ä½“ç‰ˆæœ¬ï¼ˆå¦‚ <code>git reset --hard 36803fa</code>ï¼‰ã€‚</p>
<p>æ³¨æ„ï¼š<code>--hard</code> å‚æ•°ä¼šå¼ºåˆ¶è¦†ç›–å·¥ä½œåŒºå’Œæš‚å­˜åŒºå†…å®¹ï¼Œå›æº¯åæœªæäº¤çš„æ”¹åŠ¨å°†å…¨éƒ¨ä¸¢å¤±ï¼Œä½¿ç”¨å‰éœ€ç¡®è®¤æ— é‡è¦æœªæäº¤å†…å®¹ã€‚è‹¥éœ€ä¿ç•™å·¥ä½œåŒºæ”¹åŠ¨ï¼Œå¯çœç•¥ <code>--hard</code> å‚æ•°ï¼ˆé»˜è®¤ <code>--mixed</code> æ¨¡å¼ï¼‰ã€‚</p>
<h4 data-id="heading-10">2. æ“ä½œè®°å½•æŸ¥è¯¢ï¼š<code>git reflog</code></h4>
<p>è‹¥æ‰§è¡Œ <code>git reset</code> åæƒ³å›åˆ°å›æº¯å‰çš„ç‰ˆæœ¬ï¼Œæˆ–å¿˜è®°å…·ä½“ç‰ˆæœ¬IDï¼Œå¯é€šè¿‡ <code>git reflog</code> æŸ¥çœ‹æ‰€æœ‰æ“ä½œè®°å½•ï¼ˆåŒ…æ‹¬æäº¤ã€å›æº¯ã€åˆ†æ”¯åˆ‡æ¢ç­‰ï¼‰ï¼Œè®°å½•ä¸­åŒ…å«æ¯ä¸ªæ“ä½œå¯¹åº”çš„ç‰ˆæœ¬IDï¼Œæ®æ­¤å¯å†æ¬¡æ‰§è¡Œ <code>git reset</code> å›åˆ°ç›®æ ‡ç‰ˆæœ¬ã€‚</p>
<h4 data-id="heading-11">3. ä¸åŒåœºæ™¯çš„ä¿®æ”¹æ’¤é”€</h4>
<p>æ ¹æ®æ”¹åŠ¨æ‰€å¤„åŒºåŸŸï¼Œæ’¤é”€æ“ä½œçš„å‘½ä»¤ä¸åŒï¼Œéœ€ç²¾å‡†åŒºåˆ†åœºæ™¯ï¼š</p>
<ul>
<li><strong>æ’¤é”€å·¥ä½œåŒºä¿®æ”¹</strong>ï¼šè‹¥æ–‡ä»¶ä»…åœ¨å·¥ä½œåŒºä¿®æ”¹ï¼Œæœªæ·»åŠ åˆ°æš‚å­˜åŒºï¼Œæ‰§è¡Œ <code>git checkout -- æ–‡ä»¶å</code>ï¼Œå¯å°†æ–‡ä»¶æ¢å¤è‡³æš‚å­˜åŒºæˆ–ç‰ˆæœ¬åº“çš„æœ€æ–°çŠ¶æ€ï¼Œæ­¤æ“ä½œä¸å¯é€†ï¼Œéœ€è°¨æ…ä½¿ç”¨ã€‚</li>
<li><strong>æ’¤é”€æš‚å­˜åŒºä¿®æ”¹</strong>ï¼šè‹¥æ–‡ä»¶å·²æ·»åŠ åˆ°æš‚å­˜åŒºï¼Œéœ€å…ˆå°†å…¶ç§»å‡ºæš‚å­˜åŒºï¼Œæ‰§è¡Œ <code>git reset HEAD æ–‡ä»¶å</code>ï¼Œæ”¹åŠ¨å°†é€€å›å·¥ä½œåŒºï¼Œä¹‹åå¯é‡æ–°ä¿®æ”¹æˆ–æ’¤é”€ã€‚</li>
<li><strong>æ’¤é”€è¿œç¨‹ä»“åº“æäº¤</strong>ï¼šè‹¥é”™è¯¯æäº¤å·²æ¨é€è‡³è¿œç¨‹ä»“åº“ï¼Œä¸å¯ä½¿ç”¨ <code>git reset</code>ï¼ˆä¼šå¯¼è‡´ç‰ˆæœ¬å†²çªï¼‰ï¼Œéœ€æ‰§è¡Œ <code>git revert HEAD</code>ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„æäº¤æ¥æŠµæ¶ˆä¹‹å‰çš„é”™è¯¯æäº¤ï¼Œä¿ç•™ç‰ˆæœ¬å†å²çš„å®Œæ•´æ€§ã€‚</li>
</ul>
<h3 data-id="heading-12">å››ã€è¿›é˜¶åœºæ™¯ä¸é¿å‘æŒ‡å—ï¼šé€‚é…å¤šäººåä½œä¸å¤æ‚éœ€æ±‚</h3>
<p>é™¤åŸºç¡€æ“ä½œå¤–ï¼ŒæŒæ¡ä»¥ä¸‹è¿›é˜¶æŠ€å·§ä¸é¿å‘è¦ç‚¹ï¼Œèƒ½æ›´å¥½åº”å¯¹å¤šäººåä½œã€å¤§å‹é¡¹ç›®ç®¡ç†ä¸­çš„å¤æ‚åœºæ™¯ã€‚</p>
<h4 data-id="heading-13">1. è¿œç¨‹ä»“åº“åä½œåŸºç¡€</h4>
<p>å¤šäººåä½œéœ€ä¾èµ–è¿œç¨‹ä»“åº“ï¼ˆå¦‚GitHubã€GitLabï¼‰åŒæ­¥ä»£ç ï¼Œæ ¸å¿ƒå‘½ä»¤åŒ…æ‹¬ï¼š</p>
<ul>
<li>æ·»åŠ è¿œç¨‹ä»“åº“ï¼š<code>git remote add origin è¿œç¨‹ä»“åº“URL</code>ï¼Œå…¶ä¸­ <code>origin</code> æ˜¯è¿œç¨‹ä»“åº“çš„é»˜è®¤ç®€å†™ã€‚</li>
<li>æ‹‰å–è¿œç¨‹ä»£ç ï¼š<code>git pull origin åˆ†æ”¯å</code>ï¼ŒåŒæ­¥è¿œç¨‹ä»“åº“æœ€æ–°æ”¹åŠ¨åˆ°æœ¬åœ°ï¼Œé¿å…æ¨é€æ—¶å†²çªã€‚</li>
<li>æ¨é€æœ¬åœ°ä»£ç ï¼š<code>git push origin åˆ†æ”¯å</code>ï¼Œå°†æœ¬åœ°å·²æäº¤çš„æ”¹åŠ¨æ¨é€åˆ°è¿œç¨‹ä»“åº“ã€‚</li>
</ul>
<h4 data-id="heading-14">2. å¸¸è§é”™è¯¯ä¸è§£å†³æ–¹æ¡ˆ</h4>
<ul>
<li><strong>fatal: not a git repository</strong>ï¼šæç¤ºâ€œä¸æ˜¯Gitä»“åº“â€ï¼ŒåŸå› æ˜¯å½“å‰ç›®å½•æœªåˆå§‹åŒ–ä»“åº“æˆ–è·¯å¾„é”™è¯¯ã€‚è§£å†³æ–¹æ¡ˆï¼šåˆ‡æ¢åˆ°é¡¹ç›®æ ¹ç›®å½•ï¼Œæ‰§è¡Œ <code>git init</code> åˆå§‹åŒ–ï¼Œæˆ–é€šè¿‡ <code>git rev-parse --git-dir</code> æ ¸æŸ¥ä»“åº“è·¯å¾„ã€‚</li>
<li><strong>æ¨é€è¢«æ‹’ç»ï¼ˆnon-fast-forwardï¼‰</strong> ï¼šè¿œç¨‹ä»“åº“æœ‰æœ¬åœ°æœªåŒæ­¥çš„æ”¹åŠ¨ï¼Œéœ€å…ˆæ‰§è¡Œ <code>git pull</code> åŒæ­¥å¹¶è§£å†³å†²çªï¼Œå†æ‰§è¡Œæ¨é€å‘½ä»¤ã€‚</li>
<li><strong>è¯¯æäº¤æ•æ„Ÿä¿¡æ¯</strong>ï¼šè‹¥å·²æ¨é€åŒ…å«å¯†ç ã€å¯†é’¥çš„æäº¤ï¼Œä¸å¯ç›´æ¥åˆ é™¤å†å²ï¼ˆä¼šå½±å“å›¢é˜Ÿåä½œï¼‰ï¼Œéœ€ä½¿ç”¨ <code>git filter-repo</code> å·¥å…·å½»åº•æ¸…é™¤å†å²ä¸­çš„æ•æ„Ÿæ–‡ä»¶ï¼Œå†å¼ºåˆ¶æ¨é€ï¼ˆéœ€ä¸å›¢é˜Ÿæ²Ÿé€šç¡®è®¤ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-15">3. æœ€ä½³å®è·µæ€»ç»“</h4>
<ol>
<li>æäº¤é¢‘ç‡é€‚åº¦ï¼šæ¯ä¸ªåŠŸèƒ½æ¨¡å—æˆ–bugä¿®å¤å®ŒæˆååŠæ—¶æäº¤ï¼Œæäº¤è¯´æ˜æ¸…æ™°è§„èŒƒï¼Œä¾¿äºç‰ˆæœ¬è¿½æº¯ã€‚</li>
<li>æäº¤å‰æ ¸æŸ¥ï¼šå…»æˆâ€œ<code>git status</code> æŸ¥çŠ¶æ€ + <code>git diff</code> æŸ¥å·®å¼‚â€çš„ä¹ æƒ¯ï¼Œé¿å…è¯¯æäº¤ã€‚</li>
<li>æ…ç”¨å¼ºåˆ¶å‘½ä»¤ï¼š<code>git reset --hard</code>ã€<code>git push --force</code> ç­‰å‘½ä»¤å¯èƒ½è¦†ç›–æˆ–åˆ é™¤æ•°æ®ï¼Œä½¿ç”¨å‰åŠ¡å¿…ç¡®è®¤é£é™©ã€‚</li>
<li>å¤šäººåä½œå…ˆåŒæ­¥ï¼šæ¨é€ä»£ç å‰å…ˆæ‹‰å–è¿œç¨‹æœ€æ–°æ”¹åŠ¨ï¼Œä¸»åŠ¨è§£å†³å†²çªï¼Œé¿å…å½±å“å›¢é˜Ÿè¿›åº¦ã€‚</li>
</ol>
<p>Gitçš„åŠŸèƒ½è¿œä¸æ­¢äºæ­¤ï¼Œåˆ†æ”¯ç®¡ç†ã€åˆå¹¶ç­–ç•¥ã€æ ‡ç­¾ç®¡ç†ç­‰è¿›é˜¶å†…å®¹ï¼Œå¯åœ¨æŒæ¡åŸºç¡€æ“ä½œåé€æ­¥æ·±å…¥ã€‚ä½œä¸ºç‰ˆæœ¬æ§åˆ¶å·¥å…·ï¼ŒGitçš„æ ¸å¿ƒä»·å€¼åœ¨äºè§„èŒƒä»£ç ç®¡ç†ã€æå‡åä½œæ•ˆç‡ï¼Œç†Ÿç»ƒè¿ç”¨æ ¸å¿ƒå‘½ä»¤ï¼Œç»“åˆå®é™…åœºæ™¯ç§¯ç´¯ç»éªŒï¼Œæ‰èƒ½çœŸæ­£å‘æŒ¥å…¶åœ¨å¼€å‘ä¸­çš„ä½œç”¨ï¼Œä¸ºé¡¹ç›®è´¨é‡ä¿é©¾æŠ¤èˆªã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€ ç®—æ³•-7 /Lesson72(2025-12-17)ã€‘æœ‰åºæ•°ç»„åˆå¹¶ï¼šä»åŒæŒ‡é’ˆåˆ°ä¸‰æŒ‡é’ˆçš„æ·±åº¦è§£æğŸ§ ]]></title>    <link>https://juejin.cn/post/7597946284679888915</link>    <guid>https://juejin.cn/post/7597946284679888915</guid>    <pubDate>2026-01-22T14:25:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597946284679888915" data-draft-id="7598021313870462982" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€ ç®—æ³•-7 /Lesson72(2025-12-17)ã€‘æœ‰åºæ•°ç»„åˆå¹¶ï¼šä»åŒæŒ‡é’ˆåˆ°ä¸‰æŒ‡é’ˆçš„æ·±åº¦è§£æğŸ§  "/> <meta itemprop="keywords" content="ç®—æ³•,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-22T14:25:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Jing_Rainbow"/> <meta itemprop="url" content="https://juejin.cn/user/1285809519198256"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€ ç®—æ³•-7 /Lesson72(2025-12-17)ã€‘æœ‰åºæ•°ç»„åˆå¹¶ï¼šä»åŒæŒ‡é’ˆåˆ°ä¸‰æŒ‡é’ˆçš„æ·±åº¦è§£æğŸ§  
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1285809519198256/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Jing_Rainbow
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-22T14:25:37.000Z" title="Thu Jan 22 2026 14:25:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ç®—æ³•ä¸æ•°æ®ç»“æ„çš„ä¸–ç•Œä¸­ï¼Œ<strong>æœ‰åºæ•°ç»„çš„åˆå¹¶</strong>æ˜¯ä¸€ä¸ªåŸºç¡€å´æå…·æ•™å­¦æ„ä¹‰çš„é—®é¢˜ã€‚å®ƒä¸ä»…è€ƒå¯Ÿäº†å¯¹æ•°ç»„æ“ä½œçš„ç†è§£ï¼Œè¿˜å¼•å¯¼æˆ‘ä»¬æ€è€ƒå¦‚ä½•åœ¨æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦ä¹‹é—´å–å¾—å¹³è¡¡ã€‚æœ¬æ–‡å°†å›´ç»• LeetCode ç¬¬88é¢˜ã€Šåˆå¹¶ä¸¤ä¸ªæœ‰åºæ•°ç»„ã€‹ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fmerge-sorted-array%2Fdescription%2F" target="_blank" title="https://leetcode.cn/problems/merge-sorted-array/description/" ref="nofollow noopener noreferrer">é¢˜ç›®é“¾æ¥</a>ï¼‰ï¼Œä»é—®é¢˜æè¿°å‡ºå‘ï¼Œé€æ­¥æ·±å…¥è®²è§£<strong>åŒæŒ‡é’ˆæ³•</strong>å’Œ<strong>ç©ºé—´ä¼˜åŒ–çš„ä¸‰æŒ‡é’ˆæ³•</strong>ï¼Œå¹¶ç»“åˆä»£ç å®ç°ã€åŸç†å‰–æä¸è¾¹ç•Œå¤„ç†ï¼Œå…¨é¢æŒæ¡è¿™ä¸€ç»å…¸é—®é¢˜ã€‚</p>
<hr/>
<h2 data-id="heading-0">ğŸ“Œ é—®é¢˜èƒŒæ™¯</h2>
<p>ç»™å®šä¸¤ä¸ª<strong>éé€’å‡é¡ºåºæ’åˆ—</strong>çš„æ•´æ•°æ•°ç»„ <code>nums1</code> å’Œ <code>nums2</code>ï¼Œä»¥åŠä¸¤ä¸ªæ•´æ•° <code>m</code> å’Œ <code>n</code>ï¼Œåˆ†åˆ«è¡¨ç¤º <code>nums1</code> å’Œ <code>nums2</code> ä¸­çš„æœ‰æ•ˆå…ƒç´ ä¸ªæ•°ã€‚</p>
<ul>
<li><code>nums1</code> çš„é•¿åº¦ä¸º <code>m + n</code>ï¼Œå…¶ä¸­å‰ <code>m</code> ä¸ªå…ƒç´ æ˜¯æœ‰æ•ˆæ•°æ®ï¼Œå <code>n</code> ä¸ªä½ç½®ä¸ºé¢„ç•™ç©ºé—´ï¼ˆåˆå§‹å€¼é€šå¸¸ä¸º0æˆ–ä»»æ„å€¼ï¼‰ã€‚</li>
<li>è¦æ±‚å°† <code>nums2</code> åˆå¹¶åˆ° <code>nums1</code> ä¸­ï¼Œä½¿å¾— <code>nums1</code> æˆä¸ºä¸€ä¸ªåŒ…å« <code>m + n</code> ä¸ªå…ƒç´ çš„<strong>éé€’å‡æœ‰åºæ•°ç»„</strong>ã€‚</li>
<li><strong>å…³é”®é™åˆ¶</strong>ï¼šå¿…é¡»åœ¨ <code>nums1</code> ä¸ŠåŸåœ°ä¿®æ”¹ï¼Œ<strong>ä¸èƒ½è¿”å›æ–°æ•°ç»„</strong>ã€‚</li>
</ul>
<blockquote>
<p>ğŸ’¡ æ³¨æ„ï¼šç”±äº <code>nums1</code> å·²ç»é¢„ç•™äº†è¶³å¤Ÿç©ºé—´ï¼Œå› æ­¤æ— éœ€é¢å¤–åˆ†é…å†…å­˜æ¥å­˜å‚¨ç»“æœã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-1">ğŸ” åˆæ­¥æ€è·¯ï¼šåŒæŒ‡é’ˆä»å‰å‘åï¼ˆéœ€é¢å¤–ç©ºé—´ï¼‰</h2>
<p>æœ€ç›´è§‚çš„æƒ³æ³•æ˜¯ä½¿ç”¨<strong>åŒæŒ‡é’ˆ</strong>ï¼Œåˆ†åˆ«æŒ‡å‘ä¸¤ä¸ªæ•°ç»„çš„å¼€å¤´ï¼š</p>
<ul>
<li>æŒ‡é’ˆ <code>i</code> æŒ‡å‘ <code>nums1[0]</code></li>
<li>æŒ‡é’ˆ <code>j</code> æŒ‡å‘ <code>nums2[0]</code></li>
<li>åˆ›å»ºä¸€ä¸ªä¸´æ—¶æ•°ç»„ <code>temp</code>ï¼Œé•¿åº¦ä¸º <code>m + n</code></li>
<li>æ¯”è¾ƒ <code>nums1[i]</code> å’Œ <code>nums2[j]</code>ï¼Œå°†è¾ƒå°è€…æ”¾å…¥ <code>temp</code>ï¼Œå¹¶ç§»åŠ¨å¯¹åº”æŒ‡é’ˆ</li>
<li>æœ€åå°† <code>temp</code> å¤åˆ¶å› <code>nums1</code></li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// åŒæŒ‡é’ˆ + é¢å¤–ç©ºé—´ï¼ˆä¸æ»¡è¶³åŸåœ°è¦æ±‚ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">mergeWithExtraSpace</span>(<span class="hljs-params">nums1, m, nums2, n</span>) {
    <span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> temp = [];
    <span class="hljs-keyword">while</span> (i &lt; m &amp;&amp; j &lt; n) {
        <span class="hljs-keyword">if</span> (nums1[i] &lt;= nums2[j]) {
            temp.<span class="hljs-title function_">push</span>(nums1[i++]);
        } <span class="hljs-keyword">else</span> {
            temp.<span class="hljs-title function_">push</span>(nums2[j++]);
        }
    }
    <span class="hljs-comment">// å¤„ç†å‰©ä½™å…ƒç´ </span>
    <span class="hljs-keyword">while</span> (i &lt; m) temp.<span class="hljs-title function_">push</span>(nums1[i++]);
    <span class="hljs-keyword">while</span> (j &lt; n) temp.<span class="hljs-title function_">push</span>(nums2[j++]);
    <span class="hljs-comment">// å¤åˆ¶å› nums1</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; m + n; k++) {
        nums1[k] = temp[k];
    }
}
</code></pre>
<p>âœ… <strong>ä¼˜ç‚¹</strong>ï¼šé€»è¾‘æ¸…æ™°ï¼Œæ˜“äºç†è§£<br/>
âŒ <strong>ç¼ºç‚¹</strong>ï¼šéœ€è¦ O(m + n) çš„é¢å¤–ç©ºé—´ï¼Œ<strong>ä¸ç¬¦åˆé¢˜ç›®â€œåŸåœ°ä¿®æ”¹â€çš„è¦æ±‚</strong></p>
<hr/>
<h2 data-id="heading-2">ğŸš€ ä¼˜åŒ–æ–¹æ¡ˆï¼šä¸‰æŒ‡é’ˆä»åå‘å‰ï¼ˆåŸåœ°åˆå¹¶ï¼‰</h2>
<p>ä¸ºäº†<strong>é¿å…è¦†ç›–å°šæœªå¤„ç†çš„å…ƒç´ </strong>ï¼Œæˆ‘ä»¬å¯ä»¥<strong>é€†å‘æ€ç»´</strong>ï¼šä»ä¸¤ä¸ªæ•°ç»„çš„<strong>æœ«å°¾</strong>å¼€å§‹æ¯”è¾ƒï¼Œå¹¶å°†è¾ƒå¤§å€¼å¡«å…¥ <code>nums1</code> çš„<strong>æœ«å°¾é¢„ç•™ç©ºé—´</strong>ã€‚</p>
<h3 data-id="heading-3">ğŸ§© ä¸ºä»€ä¹ˆå¯ä»¥ä»åå¾€å‰ï¼Ÿ</h3>
<ul>
<li><code>nums1</code> çš„å <code>n</code> ä¸ªä½ç½®æ˜¯ç©ºçš„ï¼ˆæˆ–å¯è¢«è¦†ç›–çš„ï¼‰</li>
<li>ä¸¤ä¸ªæ•°ç»„éƒ½æ˜¯<strong>éé€’å‡</strong>çš„ â†’ å®ƒä»¬çš„<strong>æœ€å¤§å€¼ä¸€å®šåœ¨æœ«å°¾</strong></li>
<li>å› æ­¤ï¼Œ<strong>å…¨å±€æœ€å¤§å€¼</strong>ä¸€å®šæ˜¯ <code>nums1[m-1]</code> æˆ– <code>nums2[n-1]</code> ä¸­çš„è¾ƒå¤§è€…</li>
<li>å°†å…¶æ”¾å…¥ <code>nums1[m+n-1]</code> åï¼Œé—®é¢˜è§„æ¨¡ç¼©å° 1ï¼Œå¯é€’å½’/è¿­ä»£å¤„ç†</li>
</ul>
<h3 data-id="heading-4">ğŸ§® ä¸‰æŒ‡é’ˆå®šä¹‰</h3>
<ul>
<li><code>i = m - 1</code>ï¼šæŒ‡å‘ <code>nums1</code> æœ‰æ•ˆéƒ¨åˆ†çš„æœ€åä¸€ä¸ªå…ƒç´ </li>
<li><code>j = n - 1</code>ï¼šæŒ‡å‘ <code>nums2</code> çš„æœ€åä¸€ä¸ªå…ƒç´ </li>
<li><code>k = m + n - 1</code>ï¼šæŒ‡å‘ <code>nums1</code> çš„æœ€åä¸€ä¸ªä½ç½®ï¼ˆå¾…å¡«å……ï¼‰</li>
</ul>
<h3 data-id="heading-5">ğŸ” åˆå¹¶è¿‡ç¨‹</h3>
<ol>
<li>
<p>å½“ <code>i &gt;= 0</code> ä¸” <code>j &gt;= 0</code> æ—¶ï¼š</p>
<ul>
<li>è‹¥ <code>nums1[i] &gt; nums2[j]</code>ï¼Œåˆ™ <code>nums1[k] = nums1[i]</code>ï¼Œ<code>i--</code></li>
<li>å¦åˆ™ <code>nums1[k] = nums2[j]</code>ï¼Œ<code>j--</code></li>
<li><code>k--</code></li>
</ul>
</li>
<li>
<p>è‹¥ <code>nums2</code> è¿˜æœ‰å‰©ä½™ï¼ˆå³ <code>j &gt;= 0</code>ï¼‰ï¼Œè¯´æ˜ <code>nums1</code> çš„æ‰€æœ‰å…ƒç´ å·²å¤„ç†å®Œï¼Œç›´æ¥å°† <code>nums2</code> å‰©ä½™éƒ¨åˆ†å¤åˆ¶åˆ° <code>nums1</code> å‰éƒ¨</p>
</li>
<li>
<p>è‹¥ <code>nums1</code> æœ‰å‰©ä½™ï¼ˆ<code>i &gt;= 0</code>ï¼‰ï¼Œ<strong>æ— éœ€æ“ä½œ</strong>ï¼Œå› ä¸ºå®ƒä»¬å·²ç»åœ¨æ­£ç¡®ä½ç½®</p>
</li>
</ol>
<blockquote>
<p>âœ… å…³é”®æ´å¯Ÿï¼š<strong>ä¸éœ€è¦å¤„ç† <code>nums1</code> å‰©ä½™çš„æƒ…å†µ</strong>ï¼Œå› ä¸ºå®ƒä»¬æœ¬å°±åœ¨ <code>nums1</code> ä¸­ï¼Œä¸”ä½ç½®æ­£ç¡®ï¼</p>
</blockquote>
<hr/>
<h2 data-id="heading-6">ğŸ’» å®Œæ•´ä»£ç å®ç°ï¼ˆJavaScriptï¼‰</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">nums1, m, nums2, n</span>) {
    <span class="hljs-comment">// æ•°ç»„æ˜¯è¿ç»­çš„å­˜å‚¨ç©ºé—´ï¼Œæ‰€ä»¥å¯ä»¥ä»åå¾€å‰åˆå¹¶</span>
    <span class="hljs-keyword">let</span> i = m - <span class="hljs-number">1</span>;      <span class="hljs-comment">// nums1 æœ‰æ•ˆéƒ¨åˆ†çš„æœ«å°¾</span>
    <span class="hljs-keyword">let</span> j = n - <span class="hljs-number">1</span>;      <span class="hljs-comment">// nums2 çš„æœ«å°¾</span>
    <span class="hljs-keyword">let</span> k = m + n - <span class="hljs-number">1</span>;  <span class="hljs-comment">// nums1 æ•´ä½“çš„æœ«å°¾ï¼ˆå¾…å¡«å……ä½ç½®ï¼‰</span>

    <span class="hljs-comment">// ä¸¤ä¸ªæ•°ç»„éƒ½è¿˜æœ‰å…ƒç´ æ—¶ï¼Œæ¯”è¾ƒå¹¶å¡«å……</span>
    <span class="hljs-keyword">while</span> (i &gt;= <span class="hljs-number">0</span> &amp;&amp; j &gt;= <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">if</span> (nums1[i] &gt; nums2[j]) {
            nums1[k] = nums1[i];
            i--;
        } <span class="hljs-keyword">else</span> {
            nums1[k] = nums2[j];
            j--;
        }
        k--;
    }

    <span class="hljs-comment">// å¦‚æœ nums2 è¿˜æœ‰å‰©ä½™å…ƒç´ ï¼ˆnums1 å·²è€—å°½ï¼‰</span>
    <span class="hljs-keyword">while</span> (j &gt;= <span class="hljs-number">0</span>) {
        nums1[k] = nums2[j];
        j--;
        k--;
    }

    <span class="hljs-comment">// æ³¨æ„ï¼šå¦‚æœ nums1 æœ‰å‰©ä½™ï¼Œæ— éœ€å¤„ç†ï¼Œå·²åœ¨æ­£ç¡®ä½ç½®</span>
}
</code></pre>
<blockquote>
<p>ğŸ“Œ <strong>é‡è¦è¯´æ˜</strong>ï¼šè¯¥å‡½æ•°<strong>ä¸è¿”å›ä»»ä½•å€¼</strong>ï¼Œå› ä¸º JavaScript ä¸­æ•°ç»„æ˜¯å¼•ç”¨ç±»å‹ï¼Œç›´æ¥ä¿®æ”¹ <code>nums1</code> å³å¯å½±å“è°ƒç”¨è€…ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-7">ğŸ§ª ç¤ºä¾‹æ¼”ç¤º</h2>
<p>å‡è®¾ï¼š</p>
<pre><code class="hljs language-js" lang="js">nums1 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>], m = <span class="hljs-number">3</span>
nums2 = [<span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>],           n = <span class="hljs-number">3</span>
</code></pre>
<p>æ‰§è¡Œè¿‡ç¨‹ï¼š</p>





























































<table><thead><tr><th>æ­¥éª¤</th><th>i</th><th>j</th><th>k</th><th>æ¯”è¾ƒ</th><th>nums1 çŠ¶æ€ï¼ˆkä½ç½®æ›´æ–°ï¼‰</th></tr></thead><tbody><tr><td>åˆå§‹</td><td>2</td><td>2</td><td>5</td><td>3 vs 6 â†’ 6</td><td>[..., 6]</td></tr><tr><td>1</td><td>2</td><td>1</td><td>4</td><td>3 vs 5 â†’ 5</td><td>[..., 5, 6]</td></tr><tr><td>2</td><td>2</td><td>0</td><td>3</td><td>3 vs 2 â†’ 3</td><td>[..., 3, 5, 6]</td></tr><tr><td>3</td><td>1</td><td>0</td><td>2</td><td>2 vs 2 â†’ 2</td><td>[..., 2, 3, 5, 6]</td></tr><tr><td>4</td><td>0</td><td>0</td><td>1</td><td>1 vs 2 â†’ 2</td><td>[..., 2, 2, 3, 5, 6]</td></tr><tr><td>5</td><td>0</td><td>-1</td><td>0</td><td>j &lt; 0ï¼Œç»“æŸ</td><td>[1, 2, 2, 3, 5, 6] âœ…</td></tr></tbody></table>
<p>æœ€ç»ˆ <code>nums1 = [1, 2, 2, 3, 5, 6]</code>ï¼Œå®Œå…¨æœ‰åºã€‚</p>
<hr/>
<h2 data-id="heading-8">â±ï¸ å¤æ‚åº¦åˆ†æ</h2>
<ul>
<li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(m + n)<br/>
æ¯ä¸ªå…ƒç´ æœ€å¤šè¢«è®¿é—®ä¸€æ¬¡ï¼Œæ€»å…± <code>m + n</code> æ¬¡æ“ä½œã€‚</li>
<li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(1)<br/>
ä»…ä½¿ç”¨ä¸‰ä¸ªæŒ‡é’ˆå˜é‡ï¼Œ<strong>åŸåœ°ä¿®æ”¹</strong>ï¼Œæ— é¢å¤–æ•°ç»„ã€‚</li>
</ul>
<blockquote>
<p>âœ… å®Œç¾æ»¡è¶³é¢˜ç›®å¯¹â€œåŸåœ°â€å’Œâ€œé«˜æ•ˆâ€çš„åŒé‡è¦æ±‚ï¼</p>
</blockquote>
<hr/>
<h2 data-id="heading-9">â— è¾¹ç•Œæƒ…å†µå¤„ç†</h2>
<ol>
<li>
<p><strong><code>m = 0</code></strong>ï¼š<code>nums1</code> æ— æœ‰æ•ˆå…ƒç´ ï¼Œç›´æ¥å°† <code>nums2</code> å…¨éƒ¨å¤åˆ¶åˆ° <code>nums1</code></p>
<ul>
<li>æ­¤æ—¶ <code>i = -1</code>ï¼Œç¬¬ä¸€ä¸ª <code>while</code> ä¸æ‰§è¡Œï¼Œè¿›å…¥ç¬¬äºŒä¸ª <code>while</code>ï¼Œæ­£ç¡®å¤„ç†</li>
</ul>
</li>
<li>
<p><strong><code>n = 0</code></strong>ï¼š<code>nums2</code> ä¸ºç©ºï¼Œæ— éœ€æ“ä½œ</p>
<ul>
<li><code>j = -1</code>ï¼Œä¸¤ä¸ª <code>while</code> éƒ½ä¸æ‰§è¡Œï¼Œ<code>nums1</code> ä¿æŒä¸å˜</li>
</ul>
</li>
<li>
<p><strong>å…¨ç›¸ç­‰å…ƒç´ </strong>ï¼šå¦‚ <code>nums1 = [1,1,0,0]</code>, <code>nums2 = [1,1]</code></p>
<ul>
<li>ç®—æ³•ä»èƒ½æ­£ç¡®åˆå¹¶ï¼Œä¿æŒç¨³å®šæ€§ï¼ˆè™½ç„¶é¢˜ç›®ä¸è¦æ±‚ç¨³å®šï¼‰</li>
</ul>
</li>
</ol>
<hr/>
<h2 data-id="heading-10">ğŸ§  ä¸ºä»€ä¹ˆè¿™ä¸ªæ–¹æ³•å·§å¦™ï¼Ÿ</h2>
<ul>
<li><strong>åˆ©ç”¨äº†æ•°ç»„çš„æœ‰åºæ€§</strong>ï¼šæœ€å¤§å€¼åœ¨æœ«å°¾ï¼Œå¤©ç„¶é€‚åˆä»åå¾€å‰å¡«</li>
<li><strong>é¿å…äº†å…ƒç´ è¦†ç›–</strong>ï¼šä¼ ç»Ÿä»å‰å‘åä¼šè¦†ç›– <code>nums1</code> ä¸­æœªå¤„ç†çš„å…ƒç´ ï¼Œè€Œä»åå‘å‰å†™å…¥çš„æ˜¯â€œç©ºä½â€</li>
<li><strong>æè‡´çš„ç©ºé—´ä¼˜åŒ–</strong>ï¼šå°†â€œé¢„ç•™ç©ºé—´â€è½¬åŒ–ä¸ºâ€œæ“ä½œç¼“å†²åŒºâ€</li>
</ul>
<hr/>
<h2 data-id="heading-11">ğŸ“š å»¶ä¼¸æ€è€ƒ</h2>
<ul>
<li>å¦‚æœä¸¤ä¸ªæ•°ç»„éƒ½<strong>æ²¡æœ‰é¢„ç•™ç©ºé—´</strong>ï¼Œè¯¥å¦‚ä½•åˆå¹¶ï¼Ÿâ†’ å¿…é¡»ä½¿ç”¨é¢å¤– O(m+n) ç©ºé—´</li>
<li>å¦‚æœè¦æ±‚<strong>ç¨³å®šåˆå¹¶</strong>ï¼ˆç›¸ç­‰å…ƒç´ ä¿æŒåŸç›¸å¯¹é¡ºåºï¼‰ï¼Ÿâ†’ æœ¬ç®—æ³•åœ¨ <code>nums1[i] &lt;= nums2[j]</code> æ—¶ä¼˜å…ˆå– <code>nums2</code>ï¼Œ<strong>ä¸ç¨³å®š</strong>ï¼›è‹¥æ”¹ä¸º <code>&lt;</code> æ—¶å– <code>nums1</code>ï¼Œ<code>&gt;=</code> æ—¶å– <code>nums2</code>ï¼Œåˆ™å¯ç¨³å®šï¼ˆä½†æœ¬é¢˜ä¸è¦æ±‚ï¼‰</li>
<li>æ­¤æŠ€å·§å¯æ¨å¹¿åˆ°<strong>å¤šä¸ªæœ‰åºæ•°ç»„åˆå¹¶</strong>ã€<strong>å½’å¹¶æ’åºçš„åŸåœ°ä¼˜åŒ–</strong>ç­‰åœºæ™¯</li>
</ul>
<hr/>
<h2 data-id="heading-12">âœ… æ€»ç»“</h2>
<blockquote>
<p>ğŸŒŸ <strong>æœ‰åºæ•°ç»„åˆå¹¶</strong>çœ‹ä¼¼ç®€å•ï¼Œå®åˆ™è•´å«æ·±åˆ»çš„ç®—æ³•æ€æƒ³ã€‚</p>
</blockquote>
<p>é€šè¿‡ä»<strong>åŒæŒ‡é’ˆ+é¢å¤–ç©ºé—´</strong>çš„æœ´ç´ è§£æ³•ï¼Œåˆ°<strong>ä¸‰æŒ‡é’ˆ+ä»åå‘å‰</strong>çš„åŸåœ°ä¼˜åŒ–ï¼Œæˆ‘ä»¬ä¸ä»…è§£å†³äº†å…·ä½“é—®é¢˜ï¼Œæ›´æŒæ¡äº†<strong>é€†å‘æ€ç»´</strong>ã€<strong>ç©ºé—´å¤ç”¨</strong>å’Œ<strong>è¾¹ç•Œæ§åˆ¶</strong>ç­‰æ ¸å¿ƒç¼–ç¨‹æŠ€å·§ã€‚</p>
<p>è®°ä½è¿™ä¸ªæ¨¡å¼ï¼š<strong>å½“éœ€è¦åŸåœ°åˆå¹¶æœ‰åºæ•°ç»„ï¼Œä¸”ç›®æ ‡æ•°ç»„å°¾éƒ¨æœ‰ç©ºé—²ç©ºé—´æ—¶ï¼Œä¼˜å…ˆè€ƒè™‘ä»åå¾€å‰çš„ä¸‰æŒ‡é’ˆæ³•ï¼</strong></p>
<p>è¿™ä¸ä»…æ˜¯ LeetCode çš„ä¸€é“é¢˜ï¼Œæ›´æ˜¯é€šå‘é«˜æ•ˆç®—æ³•è®¾è®¡çš„ä¸€æŠŠé’¥åŒ™ ğŸ”‘ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å½“å…¨ä¸–ç•Œéƒ½åœ¨è°ˆè®ºåƒäº¿å¤§æ¨¡å‹ï¼Œå·¥å‚é‡Œçš„æµæ°´çº¿å´åªç›¸ä¿¡ YOLO]]></title>    <link>https://juejin.cn/post/7598081541563465768</link>    <guid>https://juejin.cn/post/7598081541563465768</guid>    <pubDate>2026-01-23T01:55:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598081541563465768" data-draft-id="7598203055748087860" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å½“å…¨ä¸–ç•Œéƒ½åœ¨è°ˆè®ºåƒäº¿å¤§æ¨¡å‹ï¼Œå·¥å‚é‡Œçš„æµæ°´çº¿å´åªç›¸ä¿¡ YOLO"/> <meta itemprop="keywords" content="ç®—æ³•,è®¡ç®—æœºè§†è§‰,æ·±åº¦å­¦ä¹ "/> <meta itemprop="datePublished" content="2026-01-23T01:55:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="CoovallyAIHub"/> <meta itemprop="url" content="https://juejin.cn/user/2461151071843739"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å½“å…¨ä¸–ç•Œéƒ½åœ¨è°ˆè®ºåƒäº¿å¤§æ¨¡å‹ï¼Œå·¥å‚é‡Œçš„æµæ°´çº¿å´åªç›¸ä¿¡ YOLO
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2461151071843739/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    CoovallyAIHub
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T01:55:32.000Z" title="Fri Jan 23 2026 01:55:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>2026å¹´åˆšåˆšå¼€å§‹è¿˜æ²¡ç«™ç¨³è„šè·Ÿï¼ŒYOLO26å°±æ‚„æ— å£°æ¯åœ°æ›´æ–°äº†ã€‚</p>
<p>YOLO26å°±è¿™æ ·å‡ºç°åœ¨æˆ‘ä»¬çœ¼å‰â€”â€”ç»“æ„æ›´è½»ã€æ¨ç†æ›´å¿«ã€å·¥ç¨‹è¡¨ç°ä¹Ÿæ›´ç¨³äº†ã€‚å®ƒä¼¼ä¹åˆä¸€æ¬¡æ‹½ç€â€œå®æ—¶ç›®æ ‡æ£€æµ‹â€çš„è¡£è§’ï¼ŒæŠŠå®ƒæ‹‰å›åˆ°å·¥å‚çš„æµæ°´çº¿ã€ç›‘æ§å®¤çš„å±å¹•è¾¹ï¼Œæ‹‰å›åˆ°é‚£äº›çœŸå®å­˜åœ¨ã€å°˜åœŸä¸ç”µæµäº¤ç»‡çš„å·¥ä¸šåœºæ™¯é‡Œã€‚</p>
<p>å¯å¦ä¸€è¾¹ï¼Œç§‘æŠ€ç•Œçš„å™äº‹å´æœç€å®Œå…¨ä¸åŒçš„æ–¹å‘ç‹‚å¥”ã€‚</p>
<p>å¤šæ¨¡æ€å¤§æ¨¡å‹æ—©å·²è¿ˆè¿›ç™¾äº¿ã€åƒäº¿å‚æ•°çš„ä¿±ä¹éƒ¨ï¼Œè§†è§‰è¯­è¨€æ¨¡å‹è¢«ä¸å°‘äººå¥‰ä¸ºâ€œæ–°èŒƒå¼â€ï¼Œä¸€å¥è¯ç”Ÿæˆæ£€æµ‹ç»“æœã€è·¨ä»»åŠ¡æ³›åŒ–ï¼Œå¬èµ·æ¥ä»¿ä½›æ— æ‰€ä¸èƒ½ã€‚</p>
<blockquote>
<p>äºæ˜¯å¾ˆå¤šäººä¸ç¦æƒ³é—®ï¼š<strong>è¿™æ˜æ˜æ˜¯ä¸ªå¤§æ¨¡å‹çš„æ—¶ä»£ï¼Œä¸ºä»€ä¹ˆå·¥ä¸šç•Œè¿˜åœ¨ä¹æ­¤ä¸ç–²åœ°ç”¨YOLOï¼Ÿ</strong></p>
<p>**<br/>
**</p>
</blockquote>
<p align="center">**<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f850ff53843f4dadb66be368b49eea35~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769738131&amp;x-signature=c8v7eIPOmpwI%2F45wymzkysc5p4Q%3D" alt="ChatGPT Image 2026å¹´1æœˆ22æ—¥ 16_45_52.png" loading="lazy"/>**</p>
<p>ç”šè‡³ä¸åªæ˜¯YOLOâ€”â€”å¤§é‡å·¥ä¸šé‡Œçš„åˆ¤åˆ«å¼ä»»åŠ¡ï¼Œä¼¼ä¹éƒ½é»˜å¥‘åœ°èµ°ç€â€œå°æ¨¡å‹â€è·¯çº¿ã€‚</p>
<p>ç›´åˆ°æˆ‘è‡ªå·±ç®—äº†ä¸€ç¬”è´¦ï¼Œæ‰å¿½ç„¶æ˜ç™½ï¼šæ²‰é»˜ï¼Œä½†åˆç†ã€‚</p>
<h2 data-id="heading-0"><strong>å·¥ä¸šç•Œçš„è´¦æœ¬ï¼Œæ¯”æˆ‘ä»¬æƒ³è±¡ä¸­æ›´ç°å®</strong></h2>
<p>å…¶å®é“ç†å¹¶ä¸å¤æ‚ã€‚å·¥ä¸šç•Œä¸æ˜¯ä¸çŸ¥é“å¤§æ¨¡å‹å‰å®³ï¼Œè€Œæ˜¯ç®—ç›˜æ‰“å¾—å¤ªæ¸…æ¥šâ€”â€”åœ¨å¾ˆå¤šåˆ¤åˆ«å¼ä»»åŠ¡é‡Œï¼Œå¤§æ¨¡å‹çš„æ€§ä»·æ¯”ï¼Œå¾€å¾€ä½å¾—è®©äººæ‘‡å¤´ã€‚</p>
<p>å•æ¬¡APIæˆæœ¬å°±éœ€è¦1ç¾åˆ†ï¼Œé‚£ä¹ˆä¸€å¤©8å°æ—¶å·¥ä½œæ—¶é—´ï¼Œä»·å€¼å°±è¶…è¿‡åƒå…ƒæ¯å¤©ï¼Œå…³é”®è¿˜æ˜¯ç¾å…ƒå“¦ï¼</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ddb9be6821d4b61b79c45c47841da63~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769738131&amp;x-signature=tEadRW4hWX%2BnItAZCX3zcjGP2PE%3D" alt="screenshot_2026-01-22_16-00-39.png" loading="lazy"/></p>
<p>YOLOä»¬ä¹‹æ‰€ä»¥è¿˜èƒ½è¢«å¤§è§„æ¨¡ä½¿ç”¨ï¼ŒèƒŒåæ— éæ˜¯ä¸€å¥æœ´å®çš„è¯ï¼š<strong>å·¥ä¸šè¦çš„æ˜¯ç¡®å®šæ€§ã€å¯æ§æ€§å’Œå¯è§„æ¨¡åŒ–è½åœ°ï¼Œè€Œä¸æ˜¯â€œçœ‹èµ·æ¥èªæ˜â€ã€‚</strong> è¿™æ¬¡YOLO26çš„è¿›åŒ–æ›´æ˜¯è®©éƒ¨ç½²æ¨ç†æˆæœ¬é™ä½åˆ°ä¸€ä¸ªæ–°ç»´åº¦ã€‚</p>
<h2 data-id="heading-1"><strong>YOLO26è¿›åŒ–äº†ä»€ä¹ˆï¼Ÿ</strong></h2>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/19924c981639418fb4b360a6e76f7de2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769738131&amp;x-signature=nYvOcAG%2Bn6LtkM57gyEiv9pMboA%3D" alt="screenshot_2026-01-22_16-22-36.png" loading="lazy"/></p>
<p>YOLO26æ²¡å»è¿½â€œå¤šæ¨¡æ€â€æˆ–â€œè¯­è¨€ç†è§£â€çš„æ—¶é«¦ï¼Œåå€’ç»§ç»­åœ¨ä¸‰ä»¶â€œæ—§äº‹â€ä¸Šæ‰“ç£¨ï¼š</p>
<ul>
<li><strong>é€Ÿåº¦</strong>â€”â€”æ›´æ¿€è¿›çš„ç®—å­èåˆã€å¯¹TensorRT/ONNXæ›´å‹å¥½çš„éƒ¨ç½²ï¼Œå“ªæ€•åœ¨è¾¹ç¼˜è®¾å¤‡ä¸Šï¼Œä¹Ÿè¦è·‘æ»¡å¸§ã€‚</li>
<li><strong>ç¨³å®š</strong>â€”â€”è®­ç»ƒèŒƒå¼è¶Šå‘æˆç†Ÿï¼Œå¯¹å°æ ·æœ¬ã€å¸¦å™ªå£°çš„æ•°æ®æ›´åŠ å®½å®¹ã€‚</li>
<li><strong>å¯æ§</strong>â€”â€”æ¨¡å‹è§„æ¨¡èƒ½è£å‰ªã€æ¨ç†è·¯å¾„å¯é¢„æµ‹ï¼Œè€Œä¸”ä»ä¸ä¾èµ–é¢å¤–çš„æ¨¡æ€ã€‚</li>
</ul>
<p>è¯´èµ·æ¥ï¼Œå®ƒçš„ç›®æ ‡ä»æ¥ä¸æ˜¯â€œå˜å¾—æ›´èªæ˜â€ï¼Œè€Œæ˜¯â€œå˜å¾—æ›´åƒä¸€ä¸ªå³æ’å³ç”¨çš„å·¥ä¸šé›¶ä»¶â€ã€‚</p>
<p>æ›´é‡è¦çš„æ˜¯ï¼ŒYOLO26è¿™æ¬¡å‡çº§å¹¶ä¸å­¤ç«‹ã€‚å®ƒéšçº¦æŒ‡å‘äº†2026å¹´æ•´ä¸ªå·¥ä¸šè§†è§‰çš„å‘å±•é€»è¾‘â€”â€”é‚£æ˜¯ä¸€ç§æ²‰é»˜è€ŒåŠ¡å®çš„é€‰æ‹©ã€‚</p>
<h2 data-id="heading-2"><strong>è—åœ¨YOLO26èƒŒåçš„ä¸‰ä¸ªè¶‹åŠ¿</strong></h2>
<p>å¦‚æœä½ æŠŠå®ƒæ”¾å›è¡Œä¸šèƒŒæ™¯é‡Œçœ‹ï¼Œä¼šå‘ç°å®ƒå…¶å®å·²ç»æ›¿å·¥ä¸šç•ŒæŠ•äº†ç¥¨ã€‚</p>
<ul>
<li><strong>è¶‹åŠ¿ä¸€ï¼šæ¨¡å‹ä¸å†ç›²ç›®æ±‚å¤§ï¼Œè€Œæ˜¯ä¸“å¿ƒâ€œå˜ç²¾ã€å˜è½»â€</strong></li>
</ul>
<p>2026å¹´çš„å·¥ä¸šç°åœºï¼Œå…³é”®è¯æ—©å°±ä¸å†æ˜¯å‚æ•°é‡ã€‚å¤§å®¶æ›´å…³å¿ƒçš„æ˜¯ï¼š<strong>å•ä½ç®—åŠ›ä¸‹æ€§èƒ½èƒ½å¦æ¦¨åˆ°æé™ï¼Ÿèƒ½ä¸èƒ½åœ¨è¾¹ç¼˜ç«¯ç¨³ç¨³è·‘èµ·æ¥ï¼ŸçœŸå®çš„ååç‡åˆ°åº•æ€æ ·ï¼Ÿ</strong></p>
<p align="center">**<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/feca15e5f14247cda6fb1c594a99adf5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769738131&amp;x-signature=NMIMPKFqgD03U2DBH80y42Ugxbo%3D" alt="screenshot_2026-01-22_16-16-43.png" loading="lazy"/>**</p>
<p>YOLO26ä¸€è·¯æœç€è½»é‡åŒ–ã€æœ¬åœ°åŒ–ä¼˜åŒ–ï¼Œå…¶å®å°±æ˜¯åœ¨è¯´ï¼šå·¥ä¸šè§†è§‰çš„ä¸»æˆ˜åœºï¼Œä¾ç„¶åœ¨è¾¹ç¼˜ï¼Œåœ¨ç«¯ä¾§ï¼Œåœ¨é‚£äº›ä¸ä¼šè¯´è¯å´å¸¸å¹´è½°é¸£çš„è®¾å¤‡é‡Œã€‚</p>
<ul>
<li><strong>è¶‹åŠ¿äºŒï¼šåˆ¤åˆ«å¼ä»»åŠ¡ï¼Œä¾ç„¶æ˜¯ä¸»åŠ›å†›</strong></li>
</ul>
<p>ä»Šå¹´çœŸæ­£èƒ½è§„æ¨¡åŒ–è½åœ°çš„ï¼Œè¿˜æ˜¯é‚£äº›â€œè€é¢å­”â€ï¼š<strong>æ£€æµ‹ã€å®šä½ã€åˆ†ç±»ã€è®¡æ•°â€¦â€¦</strong></p>
<p align="center">**<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d7fd71d519c84cc183782b387465a345~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769738131&amp;x-signature=AhJbASQzB3a1doI1tn2I%2BSoEqFE%3D" alt="Screenshot-2025-10-20-at-10.19.05---AM.png" loading="lazy"/>**</p>
<p>è¿™äº›ä»»åŠ¡å¯¹â€œè¯­è¨€ç†è§£â€å‡ ä¹æ¯«æ— éœ€æ±‚ï¼Œå´å¯¹ç¨³å®šæ€§ã€å¯å¤ç°æ€§å’Œå“åº”é€Ÿåº¦æ•æ„Ÿå¾—è¦å‘½ã€‚</p>
<p>YOLO26ç»§ç»­åœ¨æ£€æµ‹èŒƒå¼ä¸Šæ‰“ç£¨ï¼Œä»¿ä½›åœ¨ä¼ é€’ä¸€ä¸ªä¿¡å·ï¼šå·¥ä¸šç•Œå¹¶ä¸æ€¥ç€è®©æœºå™¨â€œç†è§£ä¸–ç•Œâ€ï¼Œå®ƒåªå¸Œæœ›æœºå™¨æŠŠçœ¼å‰çš„é—®é¢˜åˆ¤å¾—æ¸…æ¸…æ¥šæ¥šã€‚</p>
<ul>
<li><strong>è¶‹åŠ¿ä¸‰ï¼šå·¥ç¨‹ç¡®å®šæ€§ï¼Œæ­£åœ¨å‹å€’æ¨¡å‹æƒ³è±¡åŠ›</strong></li>
</ul>
<p>æ¯”èµ·â€œæ¨¡å‹èƒ½ä¸èƒ½åšæ›´å¤šäº‹â€ï¼Œç°åœ¨çš„å·¥ä¸šç•Œæ›´å…³å¿ƒï¼š<strong>è¡Œä¸ºæ˜¯å¦å¯é¢„æµ‹ï¼Ÿå‡çº§ä¼šä¸ä¼šç¿»è½¦ï¼Ÿå‡ºäº†é—®é¢˜èƒ½ä¸èƒ½å¿«é€Ÿå›æ»šï¼Ÿ</strong></p>
<p>YOLO26çš„æ¼”è¿›ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯åœ¨ä¸æ–­å¼ºåŒ–ä¸€ä¸ªä¸ç­‰å¼ï¼š</p>
<p><strong>ç¡®å®šæ€§ ï¼ æƒ³è±¡åŠ›</strong></p>
<p>è€Œè¿™ï¼Œæ°å¥½æ˜¯å¤§æ¨¡å‹ç›®å‰æœ€éš¾æ»¡è¶³çš„å·¥ä¸šçº¢çº¿ã€‚</p>
<h2 data-id="heading-3"><strong>90%çš„å·¥ä¸šä»»åŠ¡ï¼Œæœ¬è´¨éƒ½æ˜¯â€œåˆ¤æ–­é¢˜â€</strong></h2>
<p>å¿…é¡»æ‰¿è®¤ï¼Œç»å¤§å¤šæ•°å·¥ä¸šè§†è§‰é—®é¢˜ï¼Œå…¶å®æ˜¯åˆ¤åˆ«å¼é—®é¢˜ã€‚</p>
<p><strong>æœ‰æ²¡æœ‰ç¼ºé™·ï¼Ÿä½ç½®åœ¨å“ªï¼Ÿå±äºå“ªä¸€ç±»ï¼Ÿæ˜¯å¦åˆæ ¼ï¼Ÿ</strong></p>
<p align="center">**<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/13bd6514ebfd4fda95113d64903fc4c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769738131&amp;x-signature=xNXM5g6MWrKJj4KAwju0auLPzkQ%3D" alt="screenshot_2026-01-22_16-28-07.png" loading="lazy"/>**</p>
<p>å®ƒä»¬çš„å…±åŒç‚¹å¾ˆæ˜æ˜¾ï¼šè¾“å…¥æ˜ç¡®ï¼ˆå›¾åƒ/è§†é¢‘ï¼‰ã€è¾“å‡ºç©ºé—´æœ‰é™ï¼ˆæ¡†ã€ç±»åˆ«ã€åˆ†æ•°ï¼‰ï¼Œæ ¹æœ¬ä¸éœ€è¦å¼€æ”¾å¼è¯­ä¹‰ç†è§£ã€‚</p>
<p>è€ŒYOLOï¼Œç”Ÿæ¥å°±æ˜¯ä¸ºè¿™ç±»é—®é¢˜æœåŠ¡çš„ã€‚</p>
<h2 data-id="heading-4"><strong>å¤§æ¨¡å‹ vs YOLOï¼šçœŸæ­£æ‹‰å¼€å·®è·çš„ï¼Œæ˜¯éšæ€§æˆæœ¬</strong></h2>
<p>å¾ˆå¤šäººåªçœ‹å‡†ç¡®ç‡é‚£å¼ æˆç»©å•ï¼Œå´å¿½ç•¥äº†å·¥ä¸šç•Œå¿ƒé‡Œé‚£æœ¬åšåšçš„æˆæœ¬è´¦ã€‚</p>
<ul>
<li><strong>æ¨ç†æˆæœ¬ï¼š</strong> YOLOä¸€å¼ å¡èƒ½è·‘æ•°åè·¯è§†é¢‘ï¼Œè¾¹ç¼˜è®¾å¤‡å°±èƒ½éƒ¨ç½²ï¼›å¤§æ¨¡å‹å‘¢ï¼ŸGPUå ç”¨é«˜ï¼Œæ¨ç†å»¶è¿Ÿè¿˜ä¸ç¨³å®šã€‚å·¥ä¸šç³»ç»Ÿå¯ä¸æ˜¯åªè·‘ä¸€æ¬¡ï¼Œè€Œæ˜¯7Ã—24å°æ—¶è¿è½´è½¬ã€‚</li>
<li><strong>ç¨³å®šæ€§ä¸å¯è§£é‡Šæ€§ï¼š</strong> å·¥ä¸šç°åœºæœ€æ€•ä»€ä¹ˆï¼Ÿä»Šå¤©è¿˜å¥½å¥½çš„ï¼Œæ˜å¤©çªç„¶â€œæŠ½é£â€ã€‚YOLOè¡Œä¸ºé«˜åº¦ç¡®å®šï¼Œè¾“å‡ºåˆ†å¸ƒç¨³å®šï¼›å¤§æ¨¡å‹å´å®¹æ˜“å—promptã€ä¸Šä¸‹æ–‡ã€éšæœºæ€§å½±å“ï¼Œéš¾ä»¥å®Œå…¨å¤ç°ã€‚åœ¨è´¨æ£€ã€å®‰é˜²è¿™äº›åœºåˆï¼Œè¿™ç§ä¸ç¡®å®šæ€§å‡ ä¹æ˜¯è‡´å‘½çš„ã€‚</li>
<li><strong>æ•°æ®ä¸è®­ç»ƒæˆæœ¬ï¼š</strong> YOLOå‡ ç™¾å¼ å›¾å°±èƒ½æ”¶æ•›ï¼Œä¹Ÿå…¼å®¹ä¼ ç»Ÿæ•°æ®å¢å¼ºï¼›å¤§æ¨¡å‹å¾®è°ƒæˆæœ¬é«˜ï¼Œæ ‡æ³¨ã€ç®—åŠ›ã€æ—¶é—´å…¨çº¿ç¿»å€â€”â€”ä¸æ˜¯æ¯å®¶ä¼ä¸šéƒ½çƒ§å¾—èµ·è¿™ä¸ªé’±ã€‚</li>
<li><strong>éƒ¨ç½²ä¸ç»´æŠ¤ï¼š</strong> è€è®¾å¤‡ã€å¼±ç®—åŠ›ã€å¤šå‹å·æ··ç”¨â€¦â€¦è¿™æ‰æ˜¯å¾ˆå¤šå·¥ä¸šç°åœºçš„å¸¸æ€ã€‚YOLOæ¨¡å‹å°ã€ä¾èµ–å°‘ã€å‡çº§é£é™©å¯æ§ï¼Œè¿™äº›ä¼˜åŠ¿åœ¨è¿™æ ·çš„ç¯å¢ƒé‡Œè¢«æ— é™æ”¾å¤§ã€‚</li>
</ul>
<h2 data-id="heading-5"><strong>å¾ˆå¤šä»»åŠ¡ï¼Œâ€œå°æ¨¡å‹çœŸçš„å¤Ÿäº†â€</strong></h2>
<p>è¯´å¥å®åœ¨è¯ï¼Œä¸å°‘å·¥ä¸šè§†è§‰é—®é¢˜ç”¨å¤§æ¨¡å‹ï¼Œåè€Œæœ‰ç‚¹â€œæŠ€æœ¯è¿‡å‰©â€ã€‚</p>
<p>æ¯”å¦‚<strong>è¡¨é¢ç¼ºé™·æ£€æµ‹ã€é›¶éƒ¨ä»¶å®šä½ã€è®¡æ•°æµ‹é‡ã€çŠ¶æ€è¯†åˆ«ï¼ˆå¼€/å…³ã€æœ‰/æ— ï¼‰â€¦â€¦</strong></p>
<p>è¿™äº›ä»»åŠ¡çœŸæ­£çš„éš¾ç‚¹ï¼Œå¾€å¾€ä¸åœ¨æ¨¡å‹æœ¬èº«ï¼Œè€Œåœ¨æ•°æ®è´¨é‡ã€æ ‡æ³¨ä¸€è‡´æ€§ã€åœºæ™¯å˜åŒ–å’Œå·¥ç¨‹é—­ç¯ã€‚</p>
<p>åœ¨è¿™äº›é—®é¢˜é¢å‰ï¼Œä¸€ä¸ªè°ƒæ•™è‰¯å¥½çš„YOLOï¼Œå¸¸å¸¸æ¯”â€œé€šç”¨å¤§æ¨¡å‹â€æ›´é è°±ã€æ›´è®©äººå®‰å¿ƒã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c6b09553a494e89b3ca89c9fbf23746~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769738131&amp;x-signature=Rc1rpgpXrsdgmuJMCpH%2BYIN9wl0%3D" alt="AI-in-Machine-Vision.jpg" loading="lazy"/></p>
<h2 data-id="heading-6"><strong>å¤§æ¨¡å‹ä¸æ˜¯æ²¡ç”¨ï¼Œåªæ˜¯åˆ«æ”¾é”™åœ°æ–¹</strong></h2>
<p>å½“ç„¶ï¼Œæˆ‘å¹¶ä¸æ˜¯è¦å”±è¡°å¤§æ¨¡å‹ã€‚</p>
<p>å®ƒåœ¨å¼€æ”¾ä¸–ç•Œç†è§£ã€å¤æ‚è¯­ä¹‰æ¨ç†ã€è·¨ä»»åŠ¡æ³›åŒ–ã€å°‘æ ·æœ¬å†·å¯åŠ¨è¿™äº›åœºæ™¯é‡Œï¼Œä»·å€¼æ¯‹åº¸ç½®ç–‘ã€‚ä½†å®ƒæ›´é€‚åˆæ‰®æ¼”â€œä¸Šæ¸¸èƒ½åŠ›æä¾›è€…â€ï¼Œè€Œä¸æ˜¯â€œç”Ÿäº§çº¿ä¸Šçš„ä¸€çº¿å·¥äººâ€ã€‚</p>
<p>è€ŒYOLOï¼Œæ›´åƒé‚£ä¸ªæ¯å¤©å‡†æ—¶åˆ°å²—ã€ä»ä¸æ‰é“¾å­çš„è€å¸ˆå‚…â€”â€”è¯ä¸å¤šï¼Œä½†æ´»å¹²å¾—è¸å®ã€‚</p>
<p>å¦‚æœä½ æƒ³è¦è®­ç»ƒè‡ªå·±çš„æ¨¡å‹å¿«é€Ÿè¿›è¡Œå®éªŒã€è¯„ä¼°æˆ–åº”ç”¨å¼€å‘ã€‚å¯ä»¥è¿›å…¥<strong>Coovallyå¹³å°</strong>ã€‚å®ƒæä¾›äº†ä¸€ä¸ªé›†æˆçš„AIç®—æ³•å¹³å°ï¼Œèƒ½å¤Ÿæ–¹ä¾¿åœ°è®¿é—®ã€è®­ç»ƒç®¡ç†å’Œéƒ¨ç½²è¯„ä¼°åŒ…æ‹¬å„ç±»å‰æ²¿çš„å¼€æºæ¨¡å‹ï¼Œå¤§å¹…é™ä½äº†ä»æ¨¡å‹é€‰æ‹©åˆ°å®é™…åº”ç”¨çš„é—¨æ§›ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3551e774e70f4ab79edcd5914c75dee0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769738131&amp;x-signature=3M1NKw8N4hle%2BmRpRYlX8t26vuI%3D" alt="Coovallyæ“ä½œåŠ¨å›¾.gif" loading="lazy"/></p>
<p>ä»æ•°æ®å¤„ç†ã€æ¨¡å‹è®­ç»ƒã€æ¨¡å‹ç®¡ç†åˆ°è¾¹ç¼˜éƒ¨ç½²ï¼ŒCoovally æä¾›äº†ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆï¼ŒåŠ©åŠ›å¼€å‘è€…æ›´å¿«åœ°æ„å»ºå’Œè¿­ä»£é«˜è´¨é‡çš„è®¡ç®—æœºè§†è§‰æ¨¡å‹ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/017e59b6bff54d3f829ca954e95ca6f4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769738131&amp;x-signature=bxhiJOn%2BtI6iLhV62cOJAp1l%2BkI%3D" alt="IMG_3566.GIF" loading="lazy"/></p>
<p>Coovallyå¹³å°ä¸ä»…æä¾›æ¨¡å‹èµ„æºï¼Œè¿˜å¯ä»¥å¸®åŠ©ä½ æä¾›<strong>AIè§£å†³æ–¹æ¡ˆ</strong>ï¼Œå¯ä»¥æ‰«æäºŒç»´ç ï¼Œæˆ‘ä»¬æ¥ç»™ä½ æä¾›è§£å†³æ–¹æ¡ˆï¼ï¼</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4cfa4e2a30aa4ce98c04b066f7ce7e77~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769738131&amp;x-signature=9umiVMOZ7KuWfJbX7feZgEfT9kI%3D" alt="å°åŠ©æ‰‹äºŒç»´ç .png" loading="lazy"/></p>
<h2 data-id="heading-7"><strong>æ€»ç»“</strong></h2>
<p>å½“æˆ‘ä»¬ç«™åœ¨PPTå’Œè®ºæ–‡é‡Œçœ‹ä¸–ç•Œæ—¶ï¼Œå¤§æ¨¡å‹çš„ç¡®ä»¤äººéœ‡æ’¼ã€‚</p>
<p>å¯å½“ä½ çœŸæ­£èµ°è¿›å·¥å‚ã€è´´åœ¨äº§çº¿è¾¹ã€ç«™åœ¨æœºæˆ¿å—¡å—¡ä½œå“çš„é£æ‰‡å‰ï¼Œæ‰ä¼šå‘ç°ï¼Œé‚£é‡Œè¢«åå¤ä¾èµ–çš„ï¼Œæ°¸è¿œæ˜¯é‚£äº›ç®—å¾—æ¸…ã€è·‘å¾—ä¹…ã€ä¿®å¾—èµ·çš„æ¨¡å‹ã€‚</p>
<p>è¿™å¤§æ¦‚å°±æ˜¯YOLOä»¬åœ¨å¤§æ¨¡å‹æ—¶ä»£ä¾ç„¶æ´»å¾—ä¸é”™çš„åŸå› ã€‚</p>
<p>ä¸æ˜¯æ—¶ä»£æ²¡å˜ï¼Œè€Œæ˜¯å·¥ä¸šå¤ªç°å®ã€‚</p>
<p>å¦‚æœä½ ä¹Ÿåœ¨åšå·¥ä¸šè§†è§‰ã€ç›®æ ‡æ£€æµ‹æˆ–ç›¸å…³åº”ç”¨ï¼Œä¸å¦¨åœ¨è¯„è®ºåŒºèŠèŠï¼š</p>
<p>ä½ ç°åœ¨çš„é¡¹ç›®é‡Œï¼Œç”¨çš„æ˜¯å¤§æ¨¡å‹ï¼Œè¿˜æ˜¯YOLOï¼Ÿ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[C++11 ä¹‹ è‡ªåŠ¨ç±»å‹æ¨å¯¼]]></title>    <link>https://juejin.cn/post/7598023360732053514</link>    <guid>https://juejin.cn/post/7598023360732053514</guid>    <pubDate>2026-01-22T12:04:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598023360732053514" data-draft-id="7598020609281982498" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="C++11 ä¹‹ è‡ªåŠ¨ç±»å‹æ¨å¯¼"/> <meta itemprop="keywords" content="C++"/> <meta itemprop="datePublished" content="2026-01-22T12:04:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="GuSir"/> <meta itemprop="url" content="https://juejin.cn/user/3261574409623161"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            C++11 ä¹‹ è‡ªåŠ¨ç±»å‹æ¨å¯¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3261574409623161/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    GuSir
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-22T12:04:10.000Z" title="Thu Jan 22 2026 12:04:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€auto çš„åŸºæœ¬æ¦‚å¿µ</h2>
<p><code>auto</code> æ˜¯ä¸€ä¸ª<strong>ç±»å‹å ä½ç¬¦</strong>ï¼Œè€Œéä¸€ä¸ªçœŸæ­£çš„ç±»å‹ã€‚å½“ä½ ç”¨<code>auto</code>å£°æ˜å˜é‡æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæ ¹æ®å˜é‡çš„<strong>åˆå§‹åŒ–è¡¨è¾¾å¼</strong>è‡ªåŠ¨æ¨å¯¼å‡ºå˜é‡çš„å®é™…ç±»å‹ï¼Œç„¶åå°†<code>auto</code>æ›¿æ¢ä¸ºè¿™ä¸ªç±»å‹ã€‚</p>
<p>æ ¸å¿ƒè¦æ±‚ï¼š<strong>ç”¨ auto å£°æ˜çš„å˜é‡å¿…é¡»åˆå§‹åŒ–</strong>ï¼Œå¦åˆ™ç¼–è¯‘å™¨æ— æ³•æ¨å¯¼ç±»å‹ã€‚</p>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// 1. åŸºæœ¬ç±»å‹æ¨å¯¼</span>
    <span class="hljs-keyword">auto</span> a = <span class="hljs-number">10</span>;          <span class="hljs-comment">// æ¨å¯¼ä¸º int</span>
    <span class="hljs-keyword">auto</span> b = <span class="hljs-number">3.14</span>;        <span class="hljs-comment">// æ¨å¯¼ä¸º double</span>
    <span class="hljs-keyword">auto</span> c = <span class="hljs-string">'A'</span>;         <span class="hljs-comment">// æ¨å¯¼ä¸º char</span>
    <span class="hljs-keyword">auto</span> d = <span class="hljs-literal">true</span>;        <span class="hljs-comment">// æ¨å¯¼ä¸º bool</span>
    <span class="hljs-keyword">auto</span> e = <span class="hljs-string">"hello"</span>;     <span class="hljs-comment">// æ¨å¯¼ä¸º const char*ï¼ˆå­—ç¬¦ä¸²å­—é¢é‡æ˜¯const char[]ï¼‰</span>
    <span class="hljs-keyword">auto</span> f = <span class="hljs-built_in">string</span>(<span class="hljs-string">"hi"</span>);<span class="hljs-comment">// æ¨å¯¼ä¸º std::string</span>

    <span class="hljs-comment">// éªŒè¯æ¨å¯¼ç»“æœï¼ˆé€šè¿‡typeidæŸ¥çœ‹ç±»å‹ï¼‰</span>
    cout &lt;&lt; <span class="hljs-built_in">typeid</span>(a).<span class="hljs-built_in">name</span>() &lt;&lt; endl; <span class="hljs-comment">// è¾“å‡ºï¼šintï¼ˆä¸åŒç¼–è¯‘å™¨è¾“å‡ºå¯èƒ½ç•¥æœ‰å·®å¼‚ï¼Œæ¯”å¦‚MSVCè¾“å‡ºintï¼ŒGCCè¾“å‡ºiï¼‰</span>
    cout &lt;&lt; <span class="hljs-built_in">typeid</span>(e).<span class="hljs-built_in">name</span>() &lt;&lt; endl; <span class="hljs-comment">// è¾“å‡ºï¼šconst char*</span>

    <span class="hljs-comment">// 2. å¤æ‚ç±»å‹æ¨å¯¼ï¼ˆè§£å†³å†—é•¿ç±»å‹åé—®é¢˜ï¼‰</span>
    vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; matrix = {{<span class="hljs-number">1</span>,<span class="hljs-number">2</span>}, {<span class="hljs-number">3</span>,<span class="hljs-number">4</span>}};
    <span class="hljs-comment">// ä¼ ç»Ÿå†™æ³•ï¼švector&lt;vector&lt;int&gt;&gt;::iterator it = matrix.begin();</span>
    <span class="hljs-keyword">auto</span> it = matrix.<span class="hljs-built_in">begin</span>(); <span class="hljs-comment">// æ¨å¯¼ä¸º vector&lt;vector&lt;int&gt;&gt;::iterator</span>
    cout &lt;&lt; (*it)[<span class="hljs-number">0</span>] &lt;&lt; endl; <span class="hljs-comment">// è¾“å‡ºï¼š1</span>

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>æ‰§è¡Œç»“æœ:</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">i</span>
PKc
<span class="hljs-number">1</span>
</code></pre>
<blockquote>
<p>GCC/Clang å¯¹å¤åˆç±»å‹çš„ç®€å†™è§„åˆ™ï¼š</p>
</blockquote>
<ul>
<li><code>P</code> = Pointerï¼ˆæŒ‡é’ˆï¼‰</li>
<li><code>K</code> = constï¼ˆKonstï¼Œå¾·è¯­ â€œå¸¸é‡â€ çš„ç¼©å†™ï¼ŒC++ æ ‡å‡†é‡Œç”¨ <code>K</code> è¡¨ç¤º constï¼‰</li>
<li><code>c</code> = charæ‰€ä»¥ <code>PKc</code> ç»„åˆèµ·æ¥å°±æ˜¯ <code>const char*</code>ï¼ˆæŒ‰é¡ºåºï¼šP (æŒ‡é’ˆ) + K (const) + c (char)ï¼‰</li>
</ul>
<h2 data-id="heading-1">äºŒã€auto çš„æ¨å¯¼è§„åˆ™</h2>
<p><code>auto</code>çš„æ¨å¯¼è§„åˆ™å’Œ<strong>æ¨¡æ¿å‚æ•°æ¨å¯¼</strong>åŸºæœ¬ä¸€è‡´ï¼Œæ ¸å¿ƒåˆ†ä¸‰ç§æƒ…å†µï¼š</p>
<h4 data-id="heading-2">è§„åˆ™ 1ï¼šåˆå§‹åŒ–è¡¨è¾¾å¼æ˜¯æ™®é€šç±»å‹ï¼ˆéå¼•ç”¨ã€éæŒ‡é’ˆï¼‰</h4>
<p><code>auto</code>ä¼šæ¨å¯¼å‡ºå’Œåˆå§‹åŒ–è¡¨è¾¾å¼å®Œå…¨ä¸€è‡´çš„ç±»å‹ï¼ˆå¿½ç•¥é¡¶å±‚ const/volatileï¼‰ã€‚</p>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">const</span> <span class="hljs-type">int</span> x = <span class="hljs-number">10</span>;
    <span class="hljs-keyword">auto</span> y = x;         <span class="hljs-comment">// yçš„ç±»å‹æ˜¯intï¼ˆé¡¶å±‚constè¢«å¿½ç•¥ï¼‰</span>
    y = <span class="hljs-number">20</span>;             <span class="hljs-comment">// å¯ä»¥ä¿®æ”¹ï¼Œè¯æ˜yä¸æ˜¯const</span>
    
    <span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> z = x;   <span class="hljs-comment">// zçš„ç±»å‹æ˜¯const intï¼ˆæ‰‹åŠ¨åŠ constï¼Œä¿ç•™å¸¸é‡å±æ€§ï¼‰</span>
    <span class="hljs-comment">// z = 30;          // ç¼–è¯‘é”™è¯¯ï¼šzæ˜¯const intï¼Œä¸èƒ½ä¿®æ”¹</span>

    <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> m = <span class="hljs-number">20</span>;
    <span class="hljs-keyword">auto</span> n = m;         <span class="hljs-comment">// nçš„ç±»å‹æ˜¯intï¼ˆé¡¶å±‚volatileè¢«å¿½ç•¥ï¼‰</span>

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h4 data-id="heading-3">è§„åˆ™ 2ï¼šåˆå§‹åŒ–è¡¨è¾¾å¼æ˜¯å¼•ç”¨ / æŒ‡é’ˆ</h4>
<ul>
<li>
<p>å¦‚æœè¡¨è¾¾å¼æ˜¯<strong>å¼•ç”¨</strong>ï¼Œ<code>auto</code>ä¼šæ¨å¯¼å‡ºè¢«å¼•ç”¨çš„ç±»å‹ï¼ˆå¿½ç•¥å¼•ç”¨ï¼‰ï¼›</p>
</li>
<li>
<p>å¦‚æœè¡¨è¾¾å¼æ˜¯<strong>æŒ‡é’ˆ</strong>ï¼Œ<code>auto</code>ä¼šä¿ç•™æŒ‡é’ˆå±æ€§ï¼›</p>
</li>
<li>
<p>å¦‚æœæ˜¯<strong>åº•å±‚ const</strong>çš„æŒ‡é’ˆ / å¼•ç”¨ï¼Œ<code>auto</code>ä¼šä¿ç•™åº•å±‚ constã€‚</p>
</li>
</ul>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">int</span> val = <span class="hljs-number">100</span>;
    <span class="hljs-type">int</span>&amp; ref_val = val;
    
    <span class="hljs-keyword">auto</span> a = ref_val;   <span class="hljs-comment">// açš„ç±»å‹æ˜¯intï¼ˆå¿½ç•¥å¼•ç”¨ï¼‰</span>
    a = <span class="hljs-number">200</span>;
    cout &lt;&lt; val &lt;&lt; endl; <span class="hljs-comment">// è¾“å‡ºï¼š100ï¼ˆaæ˜¯æ‹·è´ï¼Œä¸å½±å“valï¼‰</span>

    <span class="hljs-keyword">auto</span>&amp; b = ref_val;  <span class="hljs-comment">// bçš„ç±»å‹æ˜¯int&amp;ï¼ˆæ‰‹åŠ¨åŠ &amp;ï¼Œä¿ç•™å¼•ç”¨ï¼‰</span>
    b = <span class="hljs-number">200</span>;
    cout &lt;&lt; val &lt;&lt; endl; <span class="hljs-comment">// è¾“å‡ºï¼š200ï¼ˆbæ˜¯å¼•ç”¨ï¼Œä¿®æ”¹å½±å“valï¼‰</span>

    <span class="hljs-type">const</span> <span class="hljs-type">int</span> c = <span class="hljs-number">50</span>;
    <span class="hljs-type">const</span> <span class="hljs-type">int</span>&amp; ref_c = c;
    <span class="hljs-keyword">auto</span> d = ref_c;     <span class="hljs-comment">// dçš„ç±»å‹æ˜¯intï¼ˆå¿½ç•¥å¼•ç”¨ï¼Œé¡¶å±‚constä¹Ÿå¿½ç•¥ï¼‰</span>
    <span class="hljs-keyword">auto</span>&amp; e = ref_c;    <span class="hljs-comment">// eçš„ç±»å‹æ˜¯const int&amp;ï¼ˆä¿ç•™åº•å±‚constå’Œå¼•ç”¨ï¼‰</span>
    <span class="hljs-comment">// e = 60;          // ç¼–è¯‘é”™è¯¯ï¼šeæŒ‡å‘const int</span>

    <span class="hljs-type">int</span>* p = &amp;val;
    <span class="hljs-keyword">auto</span> q = p;         <span class="hljs-comment">// qçš„ç±»å‹æ˜¯int*ï¼ˆä¿ç•™æŒ‡é’ˆï¼‰</span>
    <span class="hljs-type">const</span> <span class="hljs-type">int</span>* pc = &amp;c;
    <span class="hljs-keyword">auto</span> r = pc;        <span class="hljs-comment">// rçš„ç±»å‹æ˜¯const int*ï¼ˆä¿ç•™åº•å±‚constçš„æŒ‡é’ˆï¼‰</span>

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h4 data-id="heading-4">è§„åˆ™ 3ï¼šåˆå§‹åŒ–è¡¨è¾¾å¼æ˜¯æ•°ç»„ / å‡½æ•°</h4>
<ul>
<li>
<p>æ•°ç»„åä½œä¸ºè¡¨è¾¾å¼æ—¶ï¼Œ<code>auto</code>ä¼šæ¨å¯¼ä¸ºæŒ‡é’ˆç±»å‹ï¼›</p>
</li>
<li>
<p>å‡½æ•°åä½œä¸ºè¡¨è¾¾å¼æ—¶ï¼Œ<code>auto</code>ä¼šæ¨å¯¼ä¸ºå‡½æ•°æŒ‡é’ˆç±»å‹ã€‚</p>
</li>
</ul>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">func</span><span class="hljs-params">()</span> </span>{
    cout &lt;&lt; <span class="hljs-string">"func called"</span> &lt;&lt; endl;
}

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-type">int</span> arr[<span class="hljs-number">5</span>] = {<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>};
    <span class="hljs-keyword">auto</span> a = arr;       <span class="hljs-comment">// açš„ç±»å‹æ˜¯int*ï¼ˆæ•°ç»„é€€åŒ–ä¸ºæŒ‡é’ˆï¼‰</span>
    cout &lt;&lt; *(a+<span class="hljs-number">1</span>) &lt;&lt; endl; <span class="hljs-comment">// è¾“å‡ºï¼š2</span>

    <span class="hljs-keyword">auto</span>&amp; b = arr;      <span class="hljs-comment">// bçš„ç±»å‹æ˜¯int (&amp;)[5]ï¼ˆæ•°ç»„çš„å¼•ç”¨ï¼Œä¿ç•™æ•°ç»„ç±»å‹ï¼‰</span>
    cout &lt;&lt; b[<span class="hljs-number">2</span>] &lt;&lt; endl;   <span class="hljs-comment">// è¾“å‡ºï¼š3</span>
    cout &lt;&lt; <span class="hljs-built_in">sizeof</span>(b) &lt;&lt; endl; <span class="hljs-comment">// è¾“å‡ºï¼š20ï¼ˆ5ä¸ªintï¼Œæ¯ä¸ª4å­—èŠ‚ï¼‰</span>

    <span class="hljs-keyword">auto</span> f = func;      <span class="hljs-comment">// fçš„ç±»å‹æ˜¯void (*)()ï¼ˆå‡½æ•°æŒ‡é’ˆï¼‰</span>
    <span class="hljs-built_in">f</span>();                <span class="hljs-comment">// è°ƒç”¨funcï¼Œè¾“å‡ºï¼šfunc called</span>

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 data-id="heading-5">ä¸‰ã€auto çš„æ ¸å¿ƒä½¿ç”¨åœºæ™¯</h2>
<p><code>auto</code>ä¸æ˜¯ â€œä¸‡èƒ½çš„â€ï¼Œä½†åœ¨ä»¥ä¸‹åœºæ™¯èƒ½æå¤§æå‡ä»£ç å¯è¯»æ€§å’Œå¼€å‘æ•ˆç‡ï¼š</p>
<p><strong>åœºæ™¯ 1ï¼šç®€åŒ–å†—é•¿çš„ç±»å‹å</strong></p>
<p>è¿™æ˜¯<code>auto</code>æœ€æ ¸å¿ƒçš„ç”¨é€”ï¼Œå°¤å…¶æ˜¯ STL å®¹å™¨çš„è¿­ä»£å™¨ã€å‡½æ•°è¿”å›å€¼ç±»å‹å¤æ‚çš„åœºæ™¯ã€‚</p>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;map&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// å¤æ‚å®¹å™¨çš„è¿­ä»£å™¨</span>
    map&lt;string, map&lt;<span class="hljs-type">int</span>, string&gt;&gt; complex_map;
    complex_map[<span class="hljs-string">"user1"</span>][<span class="hljs-number">1001</span>] = <span class="hljs-string">"Tom"</span>;
    
    <span class="hljs-comment">// ä¼ ç»Ÿå†™æ³•ï¼ˆå†—é•¿ä¸”æ˜“å‡ºé”™ï¼‰ï¼š</span>
    <span class="hljs-comment">// map&lt;string, map&lt;int, string&gt;&gt;::iterator it = complex_map.begin();</span>
    <span class="hljs-keyword">auto</span> it = complex_map.<span class="hljs-built_in">begin</span>(); <span class="hljs-comment">// ç®€æ´æ˜äº†</span>
    cout &lt;&lt; it-&gt;first &lt;&lt; <span class="hljs-string">": "</span> &lt;&lt; it-&gt;second[<span class="hljs-number">1001</span>] &lt;&lt; endl; <span class="hljs-comment">// è¾“å‡ºï¼šuser1: Tom</span>

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p><strong>åœºæ™¯ 2ï¼šéå†å®¹å™¨ï¼ˆé…åˆèŒƒå›´ for å¾ªç¯ï¼‰</strong></p>
<p>è¿™æ˜¯ C++11 åæœ€å¸¸ç”¨çš„ç»„åˆå†™æ³•ï¼Œå½»åº•æ‘†è„±æ‰‹åŠ¨ç®¡ç†è¿­ä»£å™¨ / ç´¢å¼•ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span>
using namespace <span class="hljs-built_in">std</span>;

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-type">int</span>&gt; nums = {<span class="hljs-number">10</span>,<span class="hljs-number">20</span>,<span class="hljs-number">30</span>,<span class="hljs-number">40</span>};
    
    <span class="hljs-comment">// åªè¯»éå†ï¼ˆæ‹·è´ï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> val : nums) {
        <span class="hljs-built_in">cout</span> &lt;&lt; val &lt;&lt; <span class="hljs-string">" "</span>;
    }
    <span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-built_in">endl</span>;

    <span class="hljs-comment">// ä¿®æ”¹éå†ï¼ˆå¼•ç”¨ï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span>&amp; val : nums) {
        val *= <span class="hljs-number">2</span>;
    }

    <span class="hljs-comment">// åªè¯»éå†ï¼ˆconstå¼•ç”¨ï¼Œé¿å…æ‹·è´ï¼Œæ•ˆç‡æ›´é«˜ï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span>&amp; val : nums) {
        <span class="hljs-built_in">cout</span> &lt;&lt; val &lt;&lt; <span class="hljs-string">" "</span>; <span class="hljs-comment">// è¾“å‡ºï¼š20 40 60 80</span>
    }

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p><strong>åœºæ™¯ 3ï¼šé…åˆ Lambda è¡¨è¾¾å¼</strong></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    vector&lt;<span class="hljs-type">int</span>&gt; nums = {<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">1</span>,<span class="hljs-number">5</span>,<span class="hljs-number">9</span>};
    
    <span class="hljs-comment">// Lambdaè¡¨è¾¾å¼çš„å˜é‡å¿…é¡»ç”¨autoå£°æ˜</span>
    <span class="hljs-keyword">auto</span> compare = [](<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b) { <span class="hljs-keyword">return</span> a &gt; b; };
    <span class="hljs-built_in">sort</span>(nums.<span class="hljs-built_in">begin</span>(), nums.<span class="hljs-built_in">end</span>(), compare);

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> val : nums) {
        cout &lt;&lt; val &lt;&lt; <span class="hljs-string">" "</span>; <span class="hljs-comment">// è¾“å‡ºï¼š9 5 4 3 1 1</span>
    }

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p><strong>åœºæ™¯ 4ï¼šå¤„ç†æ¨¡æ¿ç±»å‹</strong></p>
<p>åœ¨æ¨¡æ¿ç¼–ç¨‹ä¸­ï¼Œ<code>auto</code>å¯ä»¥ç®€åŒ–æ¨¡æ¿å‚æ•°æ¨å¯¼åçš„ç±»å‹å£°æ˜ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;

<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> T1, <span class="hljs-keyword">typename</span> T2&gt;
<span class="hljs-function"><span class="hljs-keyword">auto</span> <span class="hljs-title">add</span><span class="hljs-params">(T1 a, T2 b)</span> -&gt; <span class="hljs-title">decltype</span><span class="hljs-params">(a + b)</span> </span>{ <span class="hljs-comment">// C++11å°¾è¿”å›ç±»å‹ï¼ˆé…åˆautoï¼‰</span>
    <span class="hljs-keyword">return</span> a + b;
}

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">auto</span> res1 = <span class="hljs-built_in">add</span>(<span class="hljs-number">10</span>, <span class="hljs-number">20.5</span>); <span class="hljs-comment">// res1æ¨å¯¼ä¸ºdoubleï¼ˆ10+20.5=30.5ï¼‰</span>
    <span class="hljs-keyword">auto</span> res2 = <span class="hljs-built_in">add</span>(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>);     <span class="hljs-comment">// res2æ¨å¯¼ä¸ºintï¼ˆ5+3=8ï¼‰</span>
    cout &lt;&lt; res1 &lt;&lt; <span class="hljs-string">" "</span> &lt;&lt; res2 &lt;&lt; endl; <span class="hljs-comment">// è¾“å‡ºï¼š30.5 8</span>

    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 data-id="heading-6">å››ã€auto çš„æ³¨æ„äº‹é¡¹ï¼ˆé¿å‘æŒ‡å—ï¼‰</h2>
<h4 data-id="heading-7">1. å¿…é¡»åˆå§‹åŒ–</h4>
<p><code>auto</code>æ˜¯ â€œæ¨å¯¼â€ ç±»å‹ï¼Œæ²¡æœ‰åˆå§‹åŒ–å€¼å°±æ— æ³•æ¨å¯¼ï¼Œç¼–è¯‘ä¼šæŠ¥é”™ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">// é”™è¯¯ç¤ºä¾‹
auto x<span class="hljs-comment">; // ç¼–è¯‘é”™è¯¯ï¼šautoå˜é‡å¿…é¡»åˆå§‹åŒ–</span>
<span class="hljs-attr">x</span> = <span class="hljs-number">10</span><span class="hljs-comment">;</span>
</code></pre>
<h4 data-id="heading-8">2. ä¸èƒ½ç”¨äºå‡½æ•°å‚æ•°</h4>
<p><code>auto</code>ä¸èƒ½ç›´æ¥ä½œä¸ºå‡½æ•°å‚æ•°ç±»å‹ï¼ˆC++14 æ”¯æŒ<code>auto</code>ä½œä¸ºå‡½æ•°è¿”å›å€¼ï¼Œä½†å‚æ•°ä»ä¸æ”¯æŒï¼‰ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// é”™è¯¯ç¤ºä¾‹</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">func</span><span class="hljs-params">(<span class="hljs-keyword">auto</span> x)</span> </span>{ <span class="hljs-comment">// ç¼–è¯‘é”™è¯¯ï¼šå‚æ•°ä¸èƒ½ç”¨auto</span>
    cout &lt;&lt; x &lt;&lt; endl;
}

<span class="hljs-comment">// æ­£ç¡®æ›¿ä»£æ–¹æ¡ˆï¼šç”¨æ¨¡æ¿</span>
<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> T&gt;
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">func</span><span class="hljs-params">(T x)</span> </span>{
</code></pre>
<h4 data-id="heading-9">3. ä¸èƒ½ç”¨äºæ•°ç»„å£°æ˜</h4>
<p><code>auto</code>ä¸èƒ½ç›´æ¥å£°æ˜æ•°ç»„ï¼Œä½†å¯ä»¥æ¨å¯¼æ•°ç»„çš„å¼•ç”¨æˆ–æŒ‡é’ˆã€‚</p>
<pre><code class="hljs language-ini" lang="ini">// é”™è¯¯ç¤ºä¾‹
auto arr<span class="hljs-section">[5]</span> = {1,2,3,4,5}<span class="hljs-comment">; // ç¼–è¯‘é”™è¯¯ï¼šautoä¸èƒ½å£°æ˜æ•°ç»„</span>

// æ­£ç¡®å†™æ³•
int raw_arr<span class="hljs-section">[5]</span> = {1,2,3,4,5}<span class="hljs-comment">;</span>
auto* <span class="hljs-attr">arr_ptr</span> = raw_arr<span class="hljs-comment">;    // æ¨å¯¼ä¸ºint*</span>
auto&amp; <span class="hljs-attr">arr_ref</span> = raw_arr<span class="hljs-comment">;    // æ¨å¯¼ä¸ºint (&amp;)[5]</span>
</code></pre>
<h4 data-id="heading-10">4.æ¨å¯¼å¯èƒ½ â€œä¸¢å¤±â€ const / å¼•ç”¨å±æ€§</h4>
<p>å¦‚å‰é¢çš„è§„åˆ™æ‰€è¿°ï¼Œ<code>auto</code>é»˜è®¤ä¼šå¿½ç•¥é¡¶å±‚ const å’Œå¼•ç”¨ï¼Œå¦‚éœ€ä¿ç•™ï¼Œéœ€æ‰‹åŠ¨åŠ <code>const</code>/<code>&amp;</code>ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">int <span class="hljs-attr">val</span> = <span class="hljs-number">10</span><span class="hljs-comment">;</span>
const int&amp; <span class="hljs-attr">ref</span> = val<span class="hljs-comment">;</span>

auto <span class="hljs-attr">a</span> = ref<span class="hljs-comment">;       // aæ˜¯intï¼Œä¸¢å¤±constå’Œå¼•ç”¨</span>
const auto&amp; <span class="hljs-attr">b</span> = ref<span class="hljs-comment">;// bæ˜¯const int&amp;ï¼Œä¿ç•™å±æ€§</span>
</code></pre>
<h4 data-id="heading-11">5. é¿å…è¿‡åº¦ä½¿ç”¨</h4>
<p><code>auto</code>èƒ½ç®€åŒ–ä»£ç ï¼Œä½†è¿‡åº¦ä½¿ç”¨ä¼šé™ä½å¯è¯»æ€§ï¼ˆæ¯”å¦‚ç®€å•ç±»å‹ä¹Ÿç”¨ autoï¼‰ã€‚</p>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-comment">// ä¸æ¨èï¼ˆå¯è¯»æ€§å·®ï¼‰</span>
<span class="hljs-keyword">auto</span> x = <span class="hljs-number">10</span>; <span class="hljs-comment">// ç›´æ¥å†™int x = 10æ›´æ¸…æ™°</span>

<span class="hljs-comment">// æ¨èï¼ˆç±»å‹å†—é•¿ï¼‰</span>
vector&lt;map&lt;<span class="hljs-type">int</span>, string&gt;&gt; vec;
<span class="hljs-keyword">auto</span> it = vec.<span class="hljs-built_in">begin</span>(); <span class="hljs-comment">// æ¯”å†™å®Œæ•´è¿­ä»£å™¨ç±»å‹æ›´æ¸…æ™°</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä» glibc åˆ° Linux å†…æ ¸ï¼šæˆ‘å¦‚ä½•ç”¨æºç çœŸæ­£ç†è§£ futex çš„å®ç°æœºåˆ¶]]></title>    <link>https://juejin.cn/post/7597946284679544851</link>    <guid>https://juejin.cn/post/7597946284679544851</guid>    <pubDate>2026-01-22T11:05:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597946284679544851" data-draft-id="7598003935425577003" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä» glibc åˆ° Linux å†…æ ¸ï¼šæˆ‘å¦‚ä½•ç”¨æºç çœŸæ­£ç†è§£ futex çš„å®ç°æœºåˆ¶"/> <meta itemprop="keywords" content="æ“ä½œç³»ç»Ÿ"/> <meta itemprop="datePublished" content="2026-01-22T11:05:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‚†å¿†_"/> <meta itemprop="url" content="https://juejin.cn/user/3898194938326714"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä» glibc åˆ° Linux å†…æ ¸ï¼šæˆ‘å¦‚ä½•ç”¨æºç çœŸæ­£ç†è§£ futex çš„å®ç°æœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3898194938326714/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‚†å¿†_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-22T11:05:27.000Z" title="Thu Jan 22 2026 11:05:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å‰ä¸¤ç¯‡æˆ‘å·²ç»æŠŠäº’æ–¥é”å’Œæ¡ä»¶å˜é‡åœ¨ç”¨æˆ·æ€ï¼ˆlibstdc++/glibcï¼‰æ€ä¹ˆâ€œç”¨ futexâ€è®²æ¸…æ¥šäº†ã€‚ç°åœ¨æˆ‘æƒ³æŠŠæœ€åä¸€å—æ‹¼å›¾è¡¥ä¸Šï¼š<strong>Linux å†…æ ¸é‡Œçš„ futex åˆ°åº•æ€ä¹ˆå®ç° WAIT/WAKEï¼Ÿä¸ºä»€ä¹ˆä¸ä¼šä¸¢å”¤é†’ï¼Ÿç­‰å¾…é˜Ÿåˆ—æ€ä¹ˆç»„ç»‡ï¼Ÿå”¤é†’ä¸ºä»€ä¹ˆè¦å…ˆ mark å† wakeï¼Ÿ</strong></p>
<p>è¿™ç¯‡æˆ‘è¿˜æ˜¯æŒ‰åŒä¸€å¥—è·¯ï¼š<strong>å»ºç«‹æ¨¡å‹ â†’ ç”¨å…³é”®æºç éªŒè¯ â†’ æœ€åè‡ªå·±æ€»ç»“ä¸€éã€‚</strong><br/>
ï¼ˆæ‰€æœ‰ä»£ç ç‰‡æ®µéƒ½æ˜¯æºç èŠ‚é€‰ï¼‰</p>
<hr/>
<h2 data-id="heading-0">1ï¼‰æˆ‘å…ˆæŠŠæ¦‚å¿µçº æ­£ï¼šfutex åœ¨å†…æ ¸é‡Œä¸æ˜¯â€œä¸€ä¸ªå¯¹è±¡â€ï¼Œè€Œæ˜¯ä¸€å¥—â€œæŒ‰ key æ’é˜Ÿâ€çš„æœºåˆ¶</h2>
<p>ç”¨æˆ·æ€è¯´â€œæˆ‘åœ¨ uaddr ä¸Š waitâ€ï¼Œå†…æ ¸ä¸ä¼šç»™ä½ åˆ›å»ºä¸€ä¸ªâ€œfutexå¯¹è±¡â€ã€‚å†…æ ¸åšçš„æ˜¯ï¼š</p>
<ol>
<li>æŠŠç”¨æˆ·æ€åœ°å€ <code>uaddr</code> æ˜ å°„æˆä¸€ä¸ª <strong>futex_key</strong></li>
<li>ç”¨ key åšå“ˆå¸Œï¼Œæ‰¾åˆ°ä¸€ä¸ª <strong>hash bucket</strong></li>
<li>æŠŠå½“å‰çº¿ç¨‹å¯¹åº”çš„ä¸€ä¸ª <strong>futex_q</strong> èŠ‚ç‚¹æŒ‚è¿› bucket çš„ç­‰å¾…é“¾è¡¨</li>
<li>wake çš„æ—¶å€™ï¼šåŒæ ·æŠŠ uaddrâ†’keyâ†’bucketï¼Œç„¶ååœ¨é“¾è¡¨é‡Œç­›é€‰åŒ¹é… key çš„ futex_qï¼Œé€ä¸ªå”¤é†’</li>
</ol>
<h3 data-id="heading-1">1.1 æ ¸å¿ƒç»“æ„ï¼šbucket ä¸ futex_qï¼ˆæ¯ä¸ªç­‰å¾…çº¿ç¨‹ä¸€ä¸ªèŠ‚ç‚¹ï¼‰</h3>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/futex/futex.hï¼ˆèŠ‚é€‰ï¼‰</span>
<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">futex_hash_bucket</span> {</span>
    <span class="hljs-type">atomic_t</span> waiters;
    <span class="hljs-type">spinlock_t</span> lock;
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">plist_head</span> <span class="hljs-title">chain</span>;</span>
} ____cacheline_aligned_in_smp;

<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">futex_q</span> {</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">plist_node</span> <span class="hljs-title">list</span>;</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">task_struct</span> *<span class="hljs-title">task</span>;</span>
    <span class="hljs-type">spinlock_t</span> *lock_ptr;
    <span class="hljs-class"><span class="hljs-keyword">union</span> <span class="hljs-title">futex_key</span> <span class="hljs-title">key</span>;</span>
    u32 <span class="hljs-built_in">bitset</span>;
    ...
};
</code></pre>
<p>æˆ‘çš„ç†è§£ï¼š</p>
<ul>
<li><code>hb-&gt;chain</code> æ˜¯â€œè¿™ä¸ªæ¡¶é‡Œæ‰€æœ‰ futex ç­‰å¾…è€…çš„é“¾è¡¨â€ï¼ˆé“¾è¡¨ä¸Šä¼šæ··å¤šä¸ª keyï¼‰</li>
<li>ä¸€ä¸ªç­‰å¾…çº¿ç¨‹å¯¹åº”ä¸€ä¸ª <code>futex_q</code></li>
<li>åŒ¹é…å…³ç³»é  <code>q-&gt;key</code></li>
</ul>
<h3 data-id="heading-2">1.2 key çš„æ„ä¹‰ï¼šprivate/shared å†³å®šâ€œuaddr æ˜¯å¦èƒ½è·¨è¿›ç¨‹åŒ¹é…â€</h3>
<p>å†…æ ¸åœ¨ <code>core.c</code> çš„æ³¨é‡Šé‡ŒæŠŠ key çš„è§„åˆ™å†™å¾—å¾ˆæ¸…æ¥šï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">/* kernel/futex/core.cï¼ˆèŠ‚é€‰ï¼‰
 * For shared mappings: (inode-&gt;i_sequence, page-&gt;index, offset_within_page)
 * For private mappings: (current-&gt;mm, address, 0)
 */</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">get_futex_key</span><span class="hljs-params">(u32 __user *uaddr, <span class="hljs-type">bool</span> fshared, <span class="hljs-keyword">union</span> futex_key *key, ...)</span>
</code></pre>
<p>æ‰€ä»¥â€œä¸€ä¸ª uaddr å¯¹åº”ä¸€ä¸ª keyâ€è¦åŠ å‰æï¼š</p>
<ul>
<li>åœ¨åŒä¸€è¿›ç¨‹é‡Œï¼Œprivate futexï¼šuaddrâ†’keyï¼ˆkey é‡ŒåŒ…å« mm + addressï¼‰</li>
<li>shared futexï¼šuaddrâ†’keyï¼ˆkey é‡ŒåŒ…å« inode + page + offsetï¼Œå¯ä»¥è·¨è¿›ç¨‹åŒ¹é…ï¼‰</li>
</ul>
<h3 data-id="heading-3">1.3 å“ˆå¸Œæ¡¶æ€ä¹ˆæ‰¾ï¼Ÿ</h3>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/futex/core.cï¼ˆèŠ‚é€‰ï¼‰</span>
<span class="hljs-keyword">struct</span> futex_hash_bucket *<span class="hljs-title function_">futex_hash</span><span class="hljs-params">(<span class="hljs-keyword">union</span> futex_key *key)</span>
{
    u32 hash = jhash2((u32 *)key, ..., key-&gt;both.offset);
    <span class="hljs-keyword">return</span> &amp;futex_queues[hash &amp; (futex_hashsize - <span class="hljs-number">1</span>)];
}
</code></pre>
<p>æ€»ç»“ï¼š</p>
<blockquote>
<p>å…¨å±€æœ‰å¾ˆå¤šä¸ª bucketï¼ˆ<code>futex_queues[]</code>ï¼‰ï¼Œæ¯ä¸ª bucket ä¸€æ¡ <code>chain</code>ã€‚ä¸åŒ key ä¼šè½åˆ°ä¸åŒ bucketï¼›å“ˆå¸Œå†²çªä¼šè®©ä¸åŒ key å…±ç”¨åŒä¸€ä¸ª bucket çš„ chainï¼Œä½†æœ€ç»ˆç”¨ <code>futex_match(key)</code> ç²¾ç¡®ç­›é€‰ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-4">2ï¼‰æˆ‘æœ€æƒ³ææ‡‚çš„é—®é¢˜ï¼šä¸ºä»€ä¹ˆ futex ä¸ä¼šä¸¢å”¤é†’ï¼Ÿ</h2>
<p>æˆ‘åœ¨ <code>waitwake.c</code> æ–‡ä»¶å¤´çœ‹åˆ°ä¸€æ®µâ€œREAD this before hacking futexes!â€ çš„æ³¨é‡Šï¼Œå®ƒç›´æ¥æŠŠâ€œä¸¢å”¤é†’åä¾‹â€å†™å‡ºæ¥äº†ï¼Œå¹¶ç»™å‡ºæ­£ç¡®åºåˆ—åŒ–æ–¹å¼ã€‚</p>
<p>æ ¸å¿ƒæ€æƒ³ä¸€å¥è¯ï¼š</p>
<ul>
<li>WAIT ä¾§ï¼š<strong>ç®—æ¡¶/åŠ é”åå†è¯»ä¸€æ¬¡ç”¨æˆ·æ€å€¼ç¡®è®¤æ²¡å˜</strong>ï¼Œæ²¡å˜æ‰å…¥é˜Ÿç¡çœ </li>
<li>WAKE ä¾§ï¼šä¿®æ”¹ç”¨æˆ·æ€å€¼åå† wakeï¼Œé€šè¿‡ bucket é‡Œçš„ waiters è®¡æ•° + å†…å­˜å±éšœï¼Œé¿å… waker è¯¯åˆ¤â€œæ²¡äººç­‰â€è€Œç›´æ¥è¿”å›</li>
</ul>
<p>è¿™æ®µæ³¨é‡Šå»ºè®®ä½ è®¤çœŸè¯»ä¸€éï¼Œå®ƒåŸºæœ¬å°±æ˜¯ futex æ­£ç¡®æ€§çš„æ•™ç§‘ä¹¦ã€‚</p>
<hr/>
<h2 data-id="heading-5">3ï¼‰FUTEX_WAIT çš„å†…æ ¸è·¯å¾„ï¼šsetupï¼ˆäºŒæ¬¡æ£€æŸ¥ï¼‰â†’ queueï¼ˆå…¥é˜Ÿï¼‰â†’ scheduleï¼ˆç¡ï¼‰â†’ unqueueï¼ˆé†’/è¶…æ—¶/ä¿¡å·ï¼‰</h2>
<h3 data-id="heading-6">3.1 <code>futex_wait()</code> ä¸»æµç¨‹ï¼ˆæœ€æ ¸å¿ƒçš„å‡½æ•°ï¼‰</h3>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/futex/waitwake.cï¼ˆèŠ‚é€‰ï¼‰</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">futex_wait</span><span class="hljs-params">(u32 __user *uaddr, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> flags, u32 val,
               <span class="hljs-type">ktime_t</span> *abs_time, u32 <span class="hljs-built_in">bitset</span>)</span>
{
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">futex_hash_bucket</span> *<span class="hljs-title">hb</span>;</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">futex_q</span> <span class="hljs-title">q</span> =</span> futex_q_init;
    <span class="hljs-type">int</span> ret;

    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">bitset</span>)
        <span class="hljs-keyword">return</span> -EINVAL;
    q.<span class="hljs-built_in">bitset</span> = <span class="hljs-built_in">bitset</span>;

retry:
    ret = futex_wait_setup(uaddr, val, flags, &amp;q, &amp;hb);
    <span class="hljs-keyword">if</span> (ret)
        <span class="hljs-keyword">goto</span> out;

    futex_wait_queue(hb, &amp;q, to);

    ret = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (!futex_unqueue(&amp;q))
        <span class="hljs-keyword">goto</span> out;

    ret = -ETIMEDOUT;
    <span class="hljs-keyword">if</span> (to &amp;&amp; !to-&gt;task)
        <span class="hljs-keyword">goto</span> out;

    <span class="hljs-keyword">if</span> (!signal_pending(current))
        <span class="hljs-keyword">goto</span> retry;

    ret = -ERESTARTSYS;
    ...
out:
    ...
    <span class="hljs-keyword">return</span> ret;
}
</code></pre>
<p>æˆ‘æŠŠå®ƒæ‹†æˆå››å¥è¯ï¼š</p>
<ul>
<li><code>futex_wait_setup</code>ï¼šå‡†å¤‡ç­‰å¾…ï¼ˆç®— key/æ¡¶ï¼ŒåŠ é”ï¼ŒäºŒæ¬¡è¯»ç”¨æˆ·æ€å€¼æ ¡éªŒ expectedï¼‰</li>
<li><code>futex_wait_queue</code>ï¼šæŠŠ q å…¥é˜Ÿå¹¶è¿›å…¥è°ƒåº¦ç¡çœ </li>
<li>é†’æ¥åï¼š<code>futex_unqueue(&amp;q)</code> æ£€æŸ¥è‡ªå·±æ˜¯å¦å·²è¢« waker ä»é“¾è¡¨æ‘˜æ‰ï¼ˆæ‘˜æ‰åˆ™æˆåŠŸè¿”å›ï¼‰</li>
<li>å¦åˆ™æ ¹æ®è¶…æ—¶/ä¿¡å·/è™šå‡å”¤é†’å†³å®šé‡è¯•æˆ–è¿”å›</li>
</ul>
<h3 data-id="heading-7">3.2 â€œäºŒæ¬¡æ£€æŸ¥ç”¨æˆ·æ€å€¼ï¼ˆexpected è¯­ä¹‰ï¼‰â€åœ¨å“ªé‡Œï¼Ÿ</h3>
<p>æˆ‘å…³å¿ƒçš„å°±æ˜¯ï¼šå†…æ ¸æ€ä¹ˆä¿è¯ â€œåªæœ‰ *uaddr == val æ‰ä¼šç¡â€ã€‚</p>
<p>å…³é”®é€»è¾‘åœ¨ setup é˜¶æ®µï¼ˆä½ åœ¨åŒæ–‡ä»¶èƒ½çœ‹åˆ°çš„è¿™æ®µå°±æ˜¯æ ¸å¿ƒï¼‰ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/futex/waitwake.cï¼ˆèŠ‚é€‰ï¼‰</span>
ret = futex_get_value_locked(&amp;uval, uaddr);
...
<span class="hljs-keyword">if</span> (uval != val) {
    futex_q_unlock(*hb);
    ret = -EWOULDBLOCK;
}
</code></pre>
<p>è¿™å°±æ˜¯ futex çš„çµé­‚è¯­ä¹‰ï¼š</p>
<blockquote>
<p><strong>expected ä¸åŒ¹é…å°±ç»ä¸å…¥é˜Ÿç¡çœ </strong>ï¼Œç›´æ¥è¿”å› -EWOULDBLOCKï¼ˆç”¨æˆ·æ€é€šå¸¸æŠŠå®ƒå½“ä½œ EAGAINï¼‰ã€‚</p>
</blockquote>
<p>è¿™ä¹Ÿè§£é‡Šäº†ä½ å‰é¢å­¦ mutex/condvar æ—¶åå¤çœ‹åˆ°çš„æ¨¡å¼ï¼š</p>
<ul>
<li>ç”¨æˆ·æ€å…ˆè¯»å€¼ï¼Œå¸¦ expected è°ƒç”¨ WAIT</li>
<li>å†…æ ¸åœ¨åŠ é”åå†è¯»ä¸€æ¬¡ï¼Œå¦‚æœå€¼å˜äº†å°±ä¸ç¡ï¼ˆé¿å…ç¡æ­»ï¼‰</li>
</ul>
<h3 data-id="heading-8">3.3 çœŸæ­£â€œå…¥é˜Ÿ + ç¡çœ â€åœ¨å“ªï¼Ÿ</h3>
<p>åœ¨ <code>futex_wait_queue</code>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/futex/waitwake.cï¼ˆèŠ‚é€‰ï¼‰</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">futex_wait_queue</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> futex_hash_bucket *hb, <span class="hljs-keyword">struct</span> futex_q *q,
                      <span class="hljs-keyword">struct</span> hrtimer_sleeper *timeout)</span>
{
    set_current_state(TASK_INTERRUPTIBLE|TASK_FREEZABLE);
    futex_queue(q, hb);   <span class="hljs-comment">// æŒ‚åˆ° hb-&gt;chainï¼Œç„¶åé‡Šæ”¾ hb-&gt;lock</span>

    <span class="hljs-keyword">if</span> (timeout)
        hrtimer_sleeper_start_expires(timeout, HRTIMER_MODE_ABS);

    <span class="hljs-keyword">if</span> (likely(!plist_node_empty(&amp;q-&gt;<span class="hljs-built_in">list</span>))) {
        <span class="hljs-keyword">if</span> (!timeout || timeout-&gt;task)
            schedule();
    }
    __set_current_state(TASK_RUNNING);
}
</code></pre>
<p>æˆ‘çš„ç†è§£ï¼š</p>
<ul>
<li><code>set_current_state</code> å…ˆæŠŠè‡ªå·±æ ‡æˆå¯ç¡ï¼Œå†å…¥é˜Ÿå¹¶æ”¾é”ï¼Œé¿å…â€œwaker å·²ç» wake äº†æˆ‘ä½†æˆ‘è¿˜æ²¡ç¡â€è¿™ç±»ç«æ€</li>
<li><code>futex_queue</code> è´Ÿè´£æŠŠ q æŒ‚è¿› <code>hb-&gt;chain</code>ï¼ˆä¸€ä¸ªæ¡¶çš„ä¸€æ¡é“¾ï¼‰</li>
<li>å¦‚æœ q å·²ç»è¢«ç§»é™¤ï¼ˆåˆ«äººå·²ç»æ ‡è®°å”¤é†’ï¼‰ï¼Œå°±è·³è¿‡ schedule</li>
</ul>
<hr/>
<h2 data-id="heading-9">4ï¼‰FUTEX_WAKE çš„å†…æ ¸è·¯å¾„ï¼šuaddrâ†’keyâ†’bucketâ†’éå† chainâ†’matchâ†’markâ†’wake_up_q</h2>
<h3 data-id="heading-10">4.1 <code>futex_wake()</code>ï¼šç­›é€‰åŒ¹é… key çš„ç­‰å¾…è€…</h3>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/futex/waitwake.cï¼ˆèŠ‚é€‰ï¼‰</span>
<span class="hljs-type">int</span> <span class="hljs-title function_">futex_wake</span><span class="hljs-params">(u32 __user *uaddr, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> flags, <span class="hljs-type">int</span> nr_wake, u32 <span class="hljs-built_in">bitset</span>)</span>
{
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">futex_hash_bucket</span> *<span class="hljs-title">hb</span>;</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">futex_q</span> *<span class="hljs-title">this</span>, *<span class="hljs-title">next</span>;</span>
    <span class="hljs-class"><span class="hljs-keyword">union</span> <span class="hljs-title">futex_key</span> <span class="hljs-title">key</span> =</span> FUTEX_KEY_INIT;
    <span class="hljs-type">int</span> ret;
    DEFINE_WAKE_Q(wake_q);

    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">bitset</span>)
        <span class="hljs-keyword">return</span> -EINVAL;

    ret = get_futex_key(uaddr, flags &amp; FLAGS_SHARED, &amp;key, FUTEX_READ);
    <span class="hljs-keyword">if</span> (unlikely(ret != <span class="hljs-number">0</span>))
        <span class="hljs-keyword">return</span> ret;

    hb = futex_hash(&amp;key);

    <span class="hljs-keyword">if</span> (!futex_hb_waiters_pending(hb))
        <span class="hljs-keyword">return</span> ret;

    spin_lock(&amp;hb-&gt;lock);

    plist_for_each_entry_safe(this, next, &amp;hb-&gt;chain, <span class="hljs-built_in">list</span>) {
        <span class="hljs-keyword">if</span> (futex_match(&amp;this-&gt;key, &amp;key)) {

            <span class="hljs-keyword">if</span> (!(this-&gt;<span class="hljs-built_in">bitset</span> &amp; <span class="hljs-built_in">bitset</span>))
                <span class="hljs-keyword">continue</span>;

            futex_wake_mark(&amp;wake_q, this);
            <span class="hljs-keyword">if</span> (++ret &gt;= nr_wake)
                <span class="hljs-keyword">break</span>;
        }
    }

    spin_unlock(&amp;hb-&gt;lock);
    wake_up_q(&amp;wake_q);
    <span class="hljs-keyword">return</span> ret;
}
</code></pre>
<p>æˆ‘æŠ“ä¸‰ç‚¹ï¼š</p>
<ul>
<li><strong>åŒæ¡¶ä¸åŒ key æ··åœ¨ä¸€æ¡é“¾ä¸Š</strong>ï¼Œé  <code>futex_match(&amp;this-&gt;key, &amp;key)</code> è¿‡æ»¤</li>
<li><code>nr_wake</code> è¡¨ç¤ºæœ€å¤šå”¤é†’å‡ ä¸ª</li>
<li><code>bitset</code> æ˜¯ WAIT_BITSET/WAKE_BITSET çš„è¿‡æ»¤å™¨ï¼ˆ<code>this-&gt;bitset &amp; bitset</code>ï¼‰</li>
</ul>
<h3 data-id="heading-11">4.2 bitset æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>ä¸€å¥è¯ï¼š<strong>æŒ‰ä½è¿‡æ»¤å”¤é†’</strong>ã€‚waiter å¸¦ <code>q-&gt;bitset</code>ï¼Œwaker å¸¦ <code>bitset</code>ï¼ŒæŒ‰ä½ä¸ä¸ä¸º 0 æ‰å”¤é†’ã€‚</p>
<p>å®ƒä¸æ˜¯ glibc condvar çš„ G1/G2 åˆ†ç»„æœºåˆ¶ï¼ˆglibc condvar ä¸»è¦é ä¸¤ä¸ªä¸åŒçš„ uaddrï¼š<code>__g_signals[0/1]</code> åˆ†å¼€ï¼‰ï¼Œbitset æ˜¯å†…æ ¸æä¾›çš„é¢å¤–è¿‡æ»¤èƒ½åŠ›ã€‚</p>
<hr/>
<h2 data-id="heading-12">5ï¼‰æˆ‘æœ€å…³é”®çš„ç»†èŠ‚ç†è§£ï¼šä¸ºä»€ä¹ˆè¦å…ˆ <code>mark</code> å† <code>wake_up_q</code>ï¼Ÿ</h2>
<h3 data-id="heading-13">5.1 <code>futex_wake_mark()</code> åšäº†ä»€ä¹ˆï¼Ÿï¼ˆä¸æ˜¯ç«‹å³å”¤é†’ï¼‰</h3>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/futex/waitwake.cï¼ˆèŠ‚é€‰ï¼‰</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">futex_wake_mark</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> wake_q_head *wake_q, <span class="hljs-keyword">struct</span> futex_q *q)</span>
{
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">task_struct</span> *<span class="hljs-title">p</span> =</span> q-&gt;task;

    get_task_struct(p);
    __futex_unqueue(q);

    smp_store_release(&amp;q-&gt;lock_ptr, <span class="hljs-literal">NULL</span>);

    wake_q_add_safe(wake_q, p);
}
</code></pre>
<p>æˆ‘å¯¹è¿™æ®µçš„ç†è§£æ˜¯ï¼š</p>
<ul>
<li>å®ƒâ€œæ‹†çš„æ˜¯ futex_q èŠ‚ç‚¹â€ï¼Œä¸æ˜¯â€œæ‹† addrâ€</li>
<li><code>__futex_unqueue(q)</code>ï¼šæŠŠè¿™ä¸ªç­‰å¾…è€…ä» <code>hb-&gt;chain</code> æ‘˜æ‰</li>
<li><code>q-&gt;lock_ptr = NULL</code>ï¼ˆreleaseï¼‰ï¼šå‘å¸ƒä¸€ä¸ªå¯é çš„â€œæˆ‘å·²ç»è¢« waker çœŸæ­£å‡ºé˜Ÿ/æ ‡è®°å”¤é†’â€çŠ¶æ€<br/>
è¿™ä¸æ˜¯ä¸ºäº†ç¦æ­¢è™šå‡å”¤é†’ï¼Œè€Œæ˜¯ä¸ºäº†è®© waiter èƒ½å®‰å…¨åˆ¤æ–­/é‡Šæ”¾è‡ªå·±çš„ futex_qï¼Œé¿å…å¹¶å‘ç”Ÿå‘½å‘¨æœŸé—®é¢˜</li>
<li><code>wake_q_add_safe</code>ï¼šæŠŠä»»åŠ¡åŠ å…¥æœ¬æ¬¡å¾…å”¤é†’é˜Ÿåˆ—ï¼ˆåªæ˜¯æ”¶é›†ï¼‰</li>
</ul>
<h3 data-id="heading-14">5.2 çœŸæ­£å”¤é†’å‘ç”Ÿåœ¨å“ªé‡Œï¼Ÿ</h3>
<p><strong>çœŸæ­£è®©çº¿ç¨‹ runnable çš„åŠ¨ä½œå‘ç”Ÿåœ¨ <code>wake_up_q(&amp;wake_q)</code></strong>ï¼Œè€Œä¸”æ˜¯åœ¨é‡Šæ”¾ <code>hb-&gt;lock</code> ä¹‹åï¼š</p>
<pre><code class="hljs language-c" lang="c">spin_unlock(&amp;hb-&gt;lock);
wake_up_q(&amp;wake_q);
</code></pre>
<p>æˆ‘çš„ç†è§£ï¼š</p>
<ul>
<li><code>wake_q</code> å°±åƒä¸€ä¸ªâ€œæœ¬æ¬¡éœ€è¦å”¤é†’çš„ä»»åŠ¡åˆ—è¡¨â€</li>
<li>å…ˆåœ¨æŒé”åŒºæŠŠè¦å”¤é†’çš„ä»»åŠ¡æ”¶é›†èµ·æ¥ï¼ˆé¿å…åœ¨ spinlock å†…åšé‡æ´»ï¼‰</li>
<li>æ”¾é”åç»Ÿä¸€ wakeï¼ˆæ€§èƒ½å’Œé”ç«äº‰æ›´å¥½ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-15">6ï¼‰æŠŠå†…æ ¸ futex å’Œç”¨æˆ·æ€ mutex/condvar æ‹¼èµ·æ¥</h2>
<p>ç°åœ¨æˆ‘è„‘å­é‡Œèƒ½æŠŠä¸‰å±‚æ‹¼æˆä¸€ä¸ªé—­ç¯ï¼š</p>
<ul>
<li>ç”¨æˆ·æ€åè®®ï¼ˆglibc/libstdc++ï¼‰è´Ÿè´£â€œä»€ä¹ˆæ—¶å€™ wait / ä»€ä¹ˆæ—¶å€™ wake / çŠ¶æ€å­—æ€ä¹ˆå˜ / signal èµ„æ ¼æ€ä¹ˆåˆ¤å®šâ€</li>
<li>å†…æ ¸ futex è´Ÿè´£â€œæŒ‰ key æ’é˜Ÿã€æŒ‰ key å”¤é†’â€ï¼Œå¹¶ç”¨ <strong>äºŒæ¬¡è¯» expected + waiters è®¡æ•°ä¸å±éšœ</strong> ä¿è¯ä¸ä¸¢å”¤é†’</li>
<li>æ‰€ä»¥ mutex/condvar çš„æ‰€æœ‰æ¨¡å¼æœ€ç»ˆéƒ½å½’ç»“ä¸ºä¸€å¥è¯ï¼š
<ul>
<li>*<em>WAITï¼šåªæœ‰å½“ <em>uaddr == expected æ‰ä¼šå…¥é˜Ÿç¡</em></em></li>
<li><strong>WAKEï¼šæŒ‰ key åœ¨æ¡¶é“¾è¡¨é‡Œæ‰¾åˆ°åŒ¹é…ç­‰å¾…è€…ï¼Œæ‘˜æ‰ futex_qï¼Œå†ç»Ÿä¸€ wake</strong></li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-16">7ï¼‰æˆ‘è‡ªå·±çš„æœ€åæ€»ç»“</h2>
<ul>
<li>futex åœ¨å†…æ ¸é‡Œä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œæ˜¯ â€œuaddrâ†’keyâ†’bucketâ†’ç­‰å¾…é“¾è¡¨â€ çš„æœºåˆ¶ï¼›æ¯ä¸ªç­‰å¾…çº¿ç¨‹å¯¹åº”ä¸€ä¸ª <code>futex_q</code> èŠ‚ç‚¹ã€‚</li>
<li><code>FUTEX_WAIT</code> çš„æ­£ç¡®æ€§æ¥è‡ªä¸¤ä»¶äº‹ï¼š<br/>
1ï¼‰åŠ é”åäºŒæ¬¡è¯»å–ç”¨æˆ·æ€å€¼å¹¶å¯¹æ¯” expectedï¼Œä¸åŒ¹é…å°±ä¸ç¡ï¼ˆè¿”å› -EWOULDBLOCKï¼‰ï¼›<br/>
2ï¼‰å…¥é˜Ÿä¸ç¡çœ é¡ºåºæ­£ç¡®ï¼ˆè®¾ç½® task stateã€å…¥é˜Ÿã€é‡Šæ”¾é”ã€scheduleï¼‰ï¼Œé…åˆ waiters è®¡æ•°ä¸å±éšœé¿å…ä¸¢å”¤é†’ã€‚</li>
<li><code>FUTEX_WAKE</code> åšçš„æ˜¯ï¼šuaddrâ†’keyâ†’æ¡¶â†’éå†é“¾è¡¨ç­›é€‰ key åŒ¹é…çš„ futex_qï¼›å¯¹æ¯ä¸ªç›®æ ‡ q åš markï¼ˆå‡ºé˜Ÿ + å‘å¸ƒ lock_ptr=NULL + åŠ å…¥ wake_qï¼‰ï¼Œé‡Šæ”¾æ¡¶é”åå† <code>wake_up_q</code> çœŸæ­£å”¤é†’ã€‚</li>
<li>bitset æ˜¯å†…æ ¸æä¾›çš„â€œæŒ‰ä½è¿‡æ»¤å”¤é†’â€èƒ½åŠ›ï¼Œç”¨äº WAIT_BITSET/WAKE_BITSETï¼›glibc condvar çš„ G1/G2 åˆ†ç»„ä¸»è¦ä¸æ˜¯é  bitsetï¼Œè€Œæ˜¯é ä¸¤ä¸ªä¸åŒ uaddrï¼ˆ<code>__g_signals[0/1]</code>ï¼‰ã€‚</li>
<li>æœ€åï¼šç”¨æˆ·æ€çš„ mutex/condvar/semaphore åè®®ä¹‹æ‰€ä»¥å¯é ï¼Œæ˜¯å› ä¸ºå†…æ ¸ futex æä¾›äº†â€œexpected ç­‰å¾… + æŒ‰ key å”¤é†’â€çš„åŸºç¡€è¯­ä¹‰ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[# Egg.js Swagger Token æŒä¹…åŒ–æ•™ç¨‹]]></title>    <link>https://juejin.cn/post/7598021313870561286</link>    <guid>https://juejin.cn/post/7598021313870561286</guid>    <pubDate>2026-01-22T16:00:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598021313870561286" data-draft-id="7598024433911316534" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="# Egg.js Swagger Token æŒä¹…åŒ–æ•™ç¨‹"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-22T16:00:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Mr_Swilder"/> <meta itemprop="url" content="https://juejin.cn/user/3927901716878829"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            # Egg.js Swagger Token æŒä¹…åŒ–æ•™ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3927901716878829/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Mr_Swilder
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-22T16:00:59.000Z" title="Thu Jan 22 2026 16:00:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{font-size:24px;display:inline-block;font-weight:700;background:#ef7060;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(239,112,96,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 50px);border-bottom:3px solid #ef7060}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #3e3e3e;margin-top:32px;margin-bottom:32px;height:1px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(27,31,35,.05);color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:JetBranins Mono,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px;background-color:#fdfdfd}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fdfdfd}.markdown-body a{text-decoration:none;font-weight:700;color:#ef7060;border-bottom:1px solid #ef7060}.markdown-body a:active,.markdown-body a:hover{color:#ef2d26}.markdown-body table tr td,.markdown-body table tr th{border:1px solid #ccc;padding:5px 10px}.markdown-body table{display:block!important;width:auto;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{background:#f0f0f0;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f8f8f8}.markdown-body blockquote{margin-inline-start:0;margin-inline-end:0;border-left:3px solid #ef7060;background:#fff9f9;padding:1px 20px;margin-top:20px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><blockquote>
<p>ç›®æ ‡ï¼šåœ¨ Swagger UI åˆ·æ–°åä»ä¿ç•™ Authorization tokenã€‚</p>
</blockquote>
<h2 data-id="heading-0">1) ä¾èµ–å®‰è£…</h2>
<p>å·²å®‰è£…å¯è·³è¿‡ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">npm i egg-swagger-doc
</code></pre>
<h2 data-id="heading-1">2) å¯ç”¨æ’ä»¶</h2>
<p>ç¼–è¾‘ <code>config/plugin.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-built_in">exports</span>.<span class="hljs-property">swaggerdoc</span> = {
  <span class="hljs-attr">enable</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">package</span>: <span class="hljs-string">'egg-swagger-doc'</span>,
};
</code></pre>
<h2 data-id="heading-2">3) é…ç½® Swagger ä¸ä¸­é—´ä»¶</h2>
<p>ç¼–è¾‘ <code>config/config.default.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js">config.<span class="hljs-property">middleware</span> = [<span class="hljs-string">'swaggerPersist'</span>];

config.<span class="hljs-property">swaggerPersist</span> = {
  <span class="hljs-attr">storageKey</span>: <span class="hljs-string">'swagger_auth_token'</span>,
  <span class="hljs-attr">legacyStorageKey</span>: <span class="hljs-string">'swagger_authorization_token'</span>,
};

config.<span class="hljs-property">swaggerdoc</span> = {
  <span class="hljs-attr">enable</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">routerMap</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">dirScanner</span>: <span class="hljs-string">'./app/controller'</span>,
  <span class="hljs-attr">apiInfo</span>: {
    <span class="hljs-attr">title</span>: <span class="hljs-string">'API'</span>,
    <span class="hljs-attr">description</span>: <span class="hljs-string">'API Docs'</span>,
    <span class="hljs-attr">version</span>: <span class="hljs-string">'1.0.0'</span>,
  },
  <span class="hljs-attr">enableSecurity</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">securityDefinitions</span>: {
    <span class="hljs-attr">apikey</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-string">'apiKey'</span>,
      <span class="hljs-attr">name</span>: <span class="hljs-string">'Authorization'</span>,
      <span class="hljs-attr">in</span>: <span class="hljs-string">'header'</span>,
      <span class="hljs-attr">description</span>: <span class="hljs-string">'Bearer {token}'</span>,
    },
  },
  <span class="hljs-attr">swaggerOptions</span>: {
    <span class="hljs-attr">persistAuthorization</span>: <span class="hljs-literal">true</span>,
  },
};
</code></pre>
<h2 data-id="heading-3">4) æ·»åŠ ä¸­é—´ä»¶ï¼ˆæ³¨å…¥æŒä¹…åŒ–è„šæœ¬ï¼‰</h2>
<p>åˆ›å»º <code>app/middleware/swagger_persist.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// Injects Swagger token persistence script into Swagger UI HTML.</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">swaggerPersist</span>(<span class="hljs-params">ctx, next</span>) {
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();

    <span class="hljs-keyword">const</span> swaggerdoc = ctx.<span class="hljs-property">app</span>.<span class="hljs-property">config</span>.<span class="hljs-property">swaggerdoc</span> || {};
    <span class="hljs-keyword">const</span> configPath = swaggerdoc.<span class="hljs-property">path</span>;
    <span class="hljs-keyword">const</span> swaggerPaths = [configPath, <span class="hljs-string">'/swagger-ui'</span>, <span class="hljs-string">'/swagger-ui.html'</span>, <span class="hljs-string">'/swagger.html'</span>, <span class="hljs-string">'/doc'</span>, <span class="hljs-string">'/docs'</span>].<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);
    <span class="hljs-keyword">const</span> isSwaggerPath = swaggerPaths.<span class="hljs-title function_">some</span>(<span class="hljs-function">(<span class="hljs-params">p</span>) =&gt;</span> ctx.<span class="hljs-property">path</span> === p || ctx.<span class="hljs-property">path</span>.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">`<span class="hljs-subst">${p}</span>/`</span>));
    <span class="hljs-keyword">const</span> isStaticAsset = <span class="hljs-regexp">/\.(js|css|png|jpg|jpeg|gif|svg|woff2?|ttf|ico)$/i</span>.<span class="hljs-title function_">test</span>(ctx.<span class="hljs-property">path</span> || <span class="hljs-string">''</span>);

    <span class="hljs-keyword">if</span> (!ctx.<span class="hljs-property">body</span> || isStaticAsset) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">let</span> bodyText = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> ctx.<span class="hljs-property">body</span> === <span class="hljs-string">'string'</span>) {
      bodyText = ctx.<span class="hljs-property">body</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">isBuffer</span>(ctx.<span class="hljs-property">body</span>)) {
      bodyText = ctx.<span class="hljs-property">body</span>.<span class="hljs-title function_">toString</span>(<span class="hljs-string">'utf8'</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ctx.<span class="hljs-property">body</span> &amp;&amp; <span class="hljs-keyword">typeof</span> ctx.<span class="hljs-property">body</span>.<span class="hljs-property">pipe</span> === <span class="hljs-string">'function'</span>) {
      <span class="hljs-keyword">const</span> chunks = [];
      <span class="hljs-keyword">for</span> <span class="hljs-keyword">await</span> (<span class="hljs-keyword">const</span> chunk <span class="hljs-keyword">of</span> ctx.<span class="hljs-property">body</span>) {
        chunks.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">isBuffer</span>(chunk) ? chunk : <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">from</span>(chunk));
      }
      bodyText = <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">concat</span>(chunks).<span class="hljs-title function_">toString</span>(<span class="hljs-string">'utf8'</span>);
    }

    <span class="hljs-keyword">if</span> (!bodyText) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">const</span> isLikelyHtml = <span class="hljs-regexp">/&lt;!doctype html/i</span>.<span class="hljs-title function_">test</span>(bodyText) || <span class="hljs-regexp">/&lt;html\\b/i</span>.<span class="hljs-title function_">test</span>(bodyText) || <span class="hljs-regexp">/&lt;body\\b/i</span>.<span class="hljs-title function_">test</span>(bodyText);
    <span class="hljs-keyword">if</span> (!isLikelyHtml) {
      ctx.<span class="hljs-property">body</span> = bodyText;
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">const</span> looksLikeSwagger =
      isSwaggerPath || <span class="hljs-regexp">/SwaggerUIBundle\\s*\\(/</span>.<span class="hljs-title function_">test</span>(bodyText) || <span class="hljs-regexp">/swagger-ui-bundle\\.js/</span>.<span class="hljs-title function_">test</span>(bodyText);
    <span class="hljs-keyword">if</span> (!looksLikeSwagger) {
      ctx.<span class="hljs-property">body</span> = bodyText;
      <span class="hljs-keyword">return</span>;
    }

    ctx.<span class="hljs-title function_">set</span>(<span class="hljs-string">'Cache-Control'</span>, <span class="hljs-string">'no-store'</span>);

    <span class="hljs-keyword">if</span> (!<span class="hljs-regexp">/persistAuthorization\\s*:/</span>.<span class="hljs-title function_">test</span>(bodyText)) {
      <span class="hljs-keyword">const</span> bundleMarker = <span class="hljs-string">'SwaggerUIBundle({'</span>;
      <span class="hljs-keyword">if</span> (bodyText.<span class="hljs-title function_">includes</span>(bundleMarker)) {
        bodyText = bodyText.<span class="hljs-title function_">replace</span>(bundleMarker, <span class="hljs-string">`<span class="hljs-subst">${bundleMarker}</span>\\n        persistAuthorization: true,`</span>);
      }
    }

    <span class="hljs-keyword">const</span> securityDefinitions = swaggerdoc.<span class="hljs-property">securityDefinitions</span> || {};
    <span class="hljs-keyword">const</span> securityKey = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(securityDefinitions)[<span class="hljs-number">0</span>] || <span class="hljs-string">'apikey'</span>;
    <span class="hljs-keyword">const</span> authHeaderName = (securityDefinitions[securityKey] &amp;&amp; securityDefinitions[securityKey].<span class="hljs-property">name</span>) || <span class="hljs-string">'Authorization'</span>;
    <span class="hljs-keyword">const</span> storageKey = (ctx.<span class="hljs-property">app</span>.<span class="hljs-property">config</span>.<span class="hljs-property">swaggerPersist</span> &amp;&amp; ctx.<span class="hljs-property">app</span>.<span class="hljs-property">config</span>.<span class="hljs-property">swaggerPersist</span>.<span class="hljs-property">storageKey</span>) || <span class="hljs-string">'swagger_auth_token'</span>;
    <span class="hljs-keyword">const</span> legacyStorageKey =
      (ctx.<span class="hljs-property">app</span>.<span class="hljs-property">config</span>.<span class="hljs-property">swaggerPersist</span> &amp;&amp; ctx.<span class="hljs-property">app</span>.<span class="hljs-property">config</span>.<span class="hljs-property">swaggerPersist</span>.<span class="hljs-property">legacyStorageKey</span>) || <span class="hljs-string">'swagger_authorization_token'</span>;
    <span class="hljs-keyword">const</span> configScript = <span class="hljs-string">`&lt;script&gt;window.__SWAGGER_PERSIST__=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify({
      securityKey,
      authHeaderName,
      storageKey,
      legacyStorageKey,
    })}</span>;&lt;/script&gt;`</span>;
    <span class="hljs-keyword">const</span> version = (ctx.<span class="hljs-property">app</span>.<span class="hljs-property">config</span>.<span class="hljs-property">swaggerPersist</span> &amp;&amp; ctx.<span class="hljs-property">app</span>.<span class="hljs-property">config</span>.<span class="hljs-property">swaggerPersist</span>.<span class="hljs-property">version</span>) || <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>().<span class="hljs-title function_">toString</span>();
    <span class="hljs-keyword">const</span> customScript = <span class="hljs-string">`<span class="hljs-subst">${configScript}</span>\\n&lt;script src="/public/swagger-persist.js?v=<span class="hljs-subst">${version}</span>"&gt;&lt;/script&gt;\\n`</span>;

    <span class="hljs-keyword">const</span> bodyCloseTag = <span class="hljs-regexp">/&lt;\\/</span>body&gt;/i;
    <span class="hljs-keyword">if</span> (bodyCloseTag.<span class="hljs-title function_">test</span>(bodyText)) {
      ctx.<span class="hljs-property">body</span> = bodyText.<span class="hljs-title function_">replace</span>(bodyCloseTag, customScript + <span class="hljs-string">'&lt;/body&gt;'</span>);
    } <span class="hljs-keyword">else</span> {
      ctx.<span class="hljs-property">body</span> = bodyText + customScript;
    }

    ctx.<span class="hljs-title function_">remove</span>(<span class="hljs-string">'Content-Length'</span>);
  };
};
</code></pre>
<h2 data-id="heading-4">5) æ·»åŠ å‰ç«¯æŒä¹…åŒ–è„šæœ¬</h2>
<p>åˆ›å»º <code>app/public/swagger-persist.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// Swagger token persistence for Swagger UI.</span>
(<span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
  <span class="hljs-string">'use strict'</span>;

  <span class="hljs-keyword">var</span> config = <span class="hljs-variable language_">window</span>.<span class="hljs-property">__SWAGGER_PERSIST__</span> || {};
  <span class="hljs-keyword">var</span> <span class="hljs-variable constant_">TOKEN_STORAGE_KEY</span> = config.<span class="hljs-property">storageKey</span> || <span class="hljs-string">'swagger_auth_token'</span>;
  <span class="hljs-keyword">var</span> <span class="hljs-variable constant_">SECURITY_KEY</span> = config.<span class="hljs-property">securityKey</span> || <span class="hljs-string">'apikey'</span>;
  <span class="hljs-keyword">var</span> <span class="hljs-variable constant_">AUTH_HEADER</span> = config.<span class="hljs-property">authHeaderName</span> || <span class="hljs-string">'Authorization'</span>;
  <span class="hljs-keyword">var</span> <span class="hljs-variable constant_">LEGACY_STORAGE_KEY</span> = config.<span class="hljs-property">legacyStorageKey</span> || <span class="hljs-string">'swagger_authorization_token'</span>;
  <span class="hljs-keyword">var</span> <span class="hljs-variable constant_">AUTH_STATE_KEYS</span> = [<span class="hljs-string">'authorized'</span>, <span class="hljs-string">'swagger-ui'</span>];

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">safeLocalStorageGet</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(key);
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">safeLocalStorageSet</span>(<span class="hljs-params">key, value</span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(key, value);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">safeSessionStorageGet</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">return</span> sessionStorage.<span class="hljs-title function_">getItem</span>(key);
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">safeSessionStorageSet</span>(<span class="hljs-params">key, value</span>) {
    <span class="hljs-keyword">try</span> {
      sessionStorage.<span class="hljs-title function_">setItem</span>(key, value);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">storageGet</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">safeLocalStorageGet</span>(key) || <span class="hljs-title function_">safeSessionStorageGet</span>(key);
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">storageSet</span>(<span class="hljs-params">key, value</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">safeLocalStorageSet</span>(key, value)) <span class="hljs-keyword">return</span>;
    <span class="hljs-title function_">safeSessionStorageSet</span>(key, value);
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">normalizeToken</span>(<span class="hljs-params">raw</span>) {
    <span class="hljs-keyword">if</span> (!raw) <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
    <span class="hljs-keyword">var</span> trimmed = <span class="hljs-title class_">String</span>(raw).<span class="hljs-title function_">trim</span>();
    <span class="hljs-keyword">if</span> (!trimmed) <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-regexp">/^bearer\\s+/i</span>.<span class="hljs-title function_">test</span>(trimmed) ? trimmed : <span class="hljs-string">'Bearer '</span> + trimmed;
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">saveToken</span>(<span class="hljs-params">raw</span>) {
    <span class="hljs-keyword">var</span> token = <span class="hljs-title function_">normalizeToken</span>(raw);
    <span class="hljs-keyword">if</span> (token) {
      <span class="hljs-title function_">storageSet</span>(<span class="hljs-variable constant_">TOKEN_STORAGE_KEY</span>, token);
    }
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">getStoredToken</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">var</span> token = <span class="hljs-title function_">storageGet</span>(<span class="hljs-variable constant_">TOKEN_STORAGE_KEY</span>);
    <span class="hljs-keyword">if</span> (!token &amp;&amp; <span class="hljs-variable constant_">LEGACY_STORAGE_KEY</span>) {
      token = <span class="hljs-title function_">storageGet</span>(<span class="hljs-variable constant_">LEGACY_STORAGE_KEY</span>);
      <span class="hljs-keyword">if</span> (token) {
        <span class="hljs-title function_">storageSet</span>(<span class="hljs-variable constant_">TOKEN_STORAGE_KEY</span>, token);
      }
    }
    <span class="hljs-keyword">return</span> token;
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">extractTokenFromAuthorized</span>(<span class="hljs-params">authorized</span>) {
    <span class="hljs-keyword">if</span> (!authorized) <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
    <span class="hljs-keyword">var</span> data = authorized;
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">if</span> (authorized.<span class="hljs-property">toJS</span>) {
        data = authorized.<span class="hljs-title function_">toJS</span>();
      }
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-comment">// ignore</span>
    }
    <span class="hljs-keyword">var</span> entry = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span> (data &amp;&amp; <span class="hljs-keyword">typeof</span> data === <span class="hljs-string">'object'</span>) {
      <span class="hljs-keyword">if</span> (data[<span class="hljs-variable constant_">SECURITY_KEY</span>]) {
        entry = data[<span class="hljs-variable constant_">SECURITY_KEY</span>];
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> data) {
          <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">hasOwnProperty</span>.<span class="hljs-title function_">call</span>(data, key)) <span class="hljs-keyword">continue</span>;
          <span class="hljs-keyword">if</span> (data[key] &amp;&amp; (data[key].<span class="hljs-property">value</span> || data[key].<span class="hljs-property">token</span> || data[key].<span class="hljs-property">access_token</span>)) {
            entry = data[key];
            <span class="hljs-keyword">break</span>;
          }
        }
      }
    }
    <span class="hljs-keyword">if</span> (!entry) <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
    <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">value</span>) <span class="hljs-keyword">return</span> entry.<span class="hljs-property">value</span>;
    <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">token</span> &amp;&amp; entry.<span class="hljs-property">token</span>.<span class="hljs-property">access_token</span>) <span class="hljs-keyword">return</span> entry.<span class="hljs-property">token</span>.<span class="hljs-property">access_token</span>;
    <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">access_token</span>) <span class="hljs-keyword">return</span> entry.<span class="hljs-property">access_token</span>;
    <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">apiKey</span>) <span class="hljs-keyword">return</span> entry.<span class="hljs-property">apiKey</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">readAuthorizedFromStorage</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable constant_">AUTH_STATE_KEYS</span>.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-keyword">var</span> key = <span class="hljs-variable constant_">AUTH_STATE_KEYS</span>[i];
      <span class="hljs-keyword">var</span> raw = <span class="hljs-title function_">safeLocalStorageGet</span>(key);
      <span class="hljs-keyword">if</span> (!raw) <span class="hljs-keyword">continue</span>;
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(raw);
      } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-comment">// ignore</span>
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">persistFromSystem</span>(<span class="hljs-params">system</span>) {
    <span class="hljs-keyword">if</span> (!system || !system.<span class="hljs-property">authSelectors</span> || !system.<span class="hljs-property">authSelectors</span>.<span class="hljs-property">authorized</span>) <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> authorized = system.<span class="hljs-property">authSelectors</span>.<span class="hljs-title function_">authorized</span>();
    <span class="hljs-keyword">var</span> token = <span class="hljs-title function_">extractTokenFromAuthorized</span>(authorized);
    <span class="hljs-keyword">if</span> (!token) {
      <span class="hljs-keyword">var</span> storedAuth = <span class="hljs-title function_">readAuthorizedFromStorage</span>();
      token = <span class="hljs-title function_">extractTokenFromAuthorized</span>(storedAuth);
    }
    <span class="hljs-keyword">if</span> (token) {
      <span class="hljs-title function_">saveToken</span>(token);
    }
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">restoreToken</span>(<span class="hljs-params">ui</span>) {
    <span class="hljs-keyword">var</span> token = <span class="hljs-title function_">getStoredToken</span>();
    <span class="hljs-keyword">if</span> (!token || !ui) <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> ui.<span class="hljs-property">preauthorizeApiKey</span> === <span class="hljs-string">'function'</span>) {
        ui.<span class="hljs-title function_">preauthorizeApiKey</span>(<span class="hljs-variable constant_">SECURITY_KEY</span>, token);
        <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-keyword">var</span> system = ui.<span class="hljs-property">getSystem</span> &amp;&amp; ui.<span class="hljs-title function_">getSystem</span>();
      <span class="hljs-keyword">var</span> actions = (system &amp;&amp; system.<span class="hljs-property">authActions</span>) || ui.<span class="hljs-property">authActions</span>;
      <span class="hljs-keyword">if</span> (actions &amp;&amp; <span class="hljs-keyword">typeof</span> actions.<span class="hljs-property">authorize</span> === <span class="hljs-string">'function'</span>) {
        <span class="hljs-keyword">var</span> payload = {};
        payload[<span class="hljs-variable constant_">SECURITY_KEY</span>] = {
          <span class="hljs-attr">name</span>: <span class="hljs-variable constant_">AUTH_HEADER</span>,
          <span class="hljs-attr">schema</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">'apiKey'</span>, <span class="hljs-attr">in</span>: <span class="hljs-string">'header'</span>, <span class="hljs-attr">name</span>: <span class="hljs-variable constant_">AUTH_HEADER</span> },
          <span class="hljs-attr">value</span>: token,
        };
        actions.<span class="hljs-title function_">authorize</span>(payload);
      }
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-comment">// ignore</span>
    }
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">wrapAuthActions</span>(<span class="hljs-params">ui, system</span>) {
    <span class="hljs-keyword">var</span> target = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">var</span> actions = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span> (system &amp;&amp; system.<span class="hljs-property">authActions</span>) {
      target = system;
      actions = system.<span class="hljs-property">authActions</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ui &amp;&amp; ui.<span class="hljs-property">authActions</span>) {
      target = ui;
      actions = ui.<span class="hljs-property">authActions</span>;
    }
    <span class="hljs-keyword">if</span> (!actions || target.<span class="hljs-property">__swaggerPersistWrapped</span>) <span class="hljs-keyword">return</span>;
    target.<span class="hljs-property">__swaggerPersistWrapped</span> = <span class="hljs-literal">true</span>;

    <span class="hljs-keyword">var</span> originalAuthorize = actions.<span class="hljs-property">authorize</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> originalAuthorize === <span class="hljs-string">'function'</span>) {
      actions.<span class="hljs-property">authorize</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">payload</span>) {
        <span class="hljs-keyword">var</span> entry = payload &amp;&amp; payload[<span class="hljs-variable constant_">SECURITY_KEY</span>];
        <span class="hljs-keyword">var</span> token =
          (entry &amp;&amp; entry.<span class="hljs-property">value</span>) ||
          (payload &amp;&amp; payload.<span class="hljs-property">value</span>) ||
          (payload &amp;&amp; payload.<span class="hljs-property">token</span>) ||
          <span class="hljs-title function_">extractTokenFromAuthorized</span>(payload);
        <span class="hljs-keyword">if</span> (token) {
          <span class="hljs-title function_">saveToken</span>(token);
        }
        <span class="hljs-keyword">var</span> result = <span class="hljs-title function_">originalAuthorize</span>(payload);
        <span class="hljs-keyword">if</span> (system) {
          <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
            <span class="hljs-title function_">persistFromSystem</span>(system);
          }, <span class="hljs-number">0</span>);
        }
        <span class="hljs-keyword">return</span> result;
      };
    }
  }

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">initWhenReady</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">ui</span>) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">window</span>.<span class="hljs-property">ui</span>.<span class="hljs-property">getSystem</span> === <span class="hljs-string">'function'</span>) {
        <span class="hljs-keyword">var</span> system = <span class="hljs-variable language_">window</span>.<span class="hljs-property">ui</span>.<span class="hljs-title function_">getSystem</span>();
        <span class="hljs-title function_">wrapAuthActions</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">ui</span>, system);
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">var</span> store = system.<span class="hljs-property">getStore</span> &amp;&amp; system.<span class="hljs-title function_">getStore</span>();
          <span class="hljs-keyword">if</span> (store &amp;&amp; <span class="hljs-keyword">typeof</span> store.<span class="hljs-property">subscribe</span> === <span class="hljs-string">'function'</span>) {
            store.<span class="hljs-title function_">subscribe</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
              <span class="hljs-title function_">persistFromSystem</span>(system);
            });
          }
        } <span class="hljs-keyword">catch</span> (e) {
          <span class="hljs-comment">// ignore</span>
        }
        <span class="hljs-title function_">persistFromSystem</span>(system);
      }
      <span class="hljs-title function_">restoreToken</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">ui</span>);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-built_in">setTimeout</span>(initWhenReady, <span class="hljs-number">300</span>);
  }

  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">readyState</span> === <span class="hljs-string">'loading'</span>) {
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'DOMContentLoaded'</span>, initWhenReady);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">initWhenReady</span>();
  }
})();
</code></pre>
<h2 data-id="heading-5">6) å¯åŠ¨ä¸éªŒè¯</h2>
<pre><code class="hljs language-bash" lang="bash">npm run dev
</code></pre>
<p>è®¿é—® <code>http://localhost:7001/swagger-ui.html</code>ï¼š</p>
<ol>
<li>ç‚¹å‡» Authorize è¾“å…¥ <code>Bearer {token}</code> å¹¶ç¡®è®¤ã€‚</li>
<li>åˆ·æ–°é¡µé¢ï¼ŒæˆæƒçŠ¶æ€åº”ä»ä¿ç•™ã€‚</li>
</ol>
<h2 data-id="heading-6">å¸¸è§é—®é¢˜</h2>
<ol>
<li>
<p><code>swagger-ui-bundle.js</code> æŠ¥ <code>Unexpected token '&lt;'</code><br/>
è¯´æ˜ä¸­é—´ä»¶æŠŠé™æ€èµ„æºå½“ HTML å¤„ç†äº†ï¼Œç¡®ä¿ä¸­é—´ä»¶è·³è¿‡ <code>.js/.css/.png</code> ç­‰è·¯å¾„ã€‚</p>
</li>
<li>
<p>æ‰¾ä¸åˆ° <code>swagger-persist.js</code><br/>
æ£€æŸ¥ï¼š</p>
<ul>
<li><code>app/public/swagger-persist.js</code> æ˜¯å¦å­˜åœ¨</li>
<li><code>config.static</code> æ˜¯å¦æŒ‡å‘ <code>app/public</code></li>
<li>Swagger é¡µé¢ HTML æºç é‡Œæ˜¯å¦åŒ…å« <code>&lt;script src="/public/swagger-persist.js"&gt;</code></li>
</ul>
</li>
<li>
<p>Token æœªä¿å­˜<br/>
æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦ç¦ç”¨ localStorage / æ— ç—•æ¨¡å¼ã€‚</p>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ™ºèƒ½æŒ‡é’ˆ]]></title>    <link>https://juejin.cn/post/7598062246572752950</link>    <guid>https://juejin.cn/post/7598062246572752950</guid>    <pubDate>2026-01-22T16:01:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598062246572752950" data-draft-id="7598062246572687414" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ™ºèƒ½æŒ‡é’ˆ"/> <meta itemprop="keywords" content="C++"/> <meta itemprop="datePublished" content="2026-01-22T16:01:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Melody671"/> <meta itemprop="url" content="https://juejin.cn/user/1470485400403674"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ™ºèƒ½æŒ‡é’ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1470485400403674/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Melody671
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-22T16:01:23.000Z" title="Thu Jan 22 2026 16:01:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">unique_pträ¼ªä»£ç </h2>
<pre><code class="hljs language-js" lang="js">template&lt;typename T, typename <span class="hljs-title class_">Deleter</span> = <span class="hljs-title class_">DefaultDelete</span>&lt;T&gt;&gt;
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Unique_ptr</span>
{
<span class="hljs-attr">private</span>:
    T* ptr;
    <span class="hljs-title class_">Deleter</span> deleter;

<span class="hljs-attr">public</span>:
    <span class="hljs-title class_">Unique</span>_ptr(T* ptr,<span class="hljs-title class_">Deleter</span> deleteter=<span class="hljs-title class_">Deleter</span>()) : <span class="hljs-title function_">ptr</span>(ptr), <span class="hljs-title function_">deleter</span>(<span class="hljs-params">deleteter</span>) {}
    ~<span class="hljs-title class_">Unique</span>_ptr() {
        <span class="hljs-keyword">if</span> (ptr)
            <span class="hljs-title function_">deleter</span>(ptr);
    
    };
    <span class="hljs-title class_">Unique</span>_ptr(<span class="hljs-title class_">Unique</span>_ptr&amp; other)=<span class="hljs-keyword">delete</span>;
    <span class="hljs-title class_">Unique</span>_ptr&amp; operator=(<span class="hljs-title class_">Unique</span>_ptr&amp; other)=<span class="hljs-keyword">delete</span>;
    <span class="hljs-title class_">Unique</span>_ptr(<span class="hljs-title class_">Unique</span>_ptr&amp;&amp; other) {
        <span class="hljs-keyword">if</span> (ptr)
            <span class="hljs-title function_">deleter</span>(ptr);
        ptr = other.<span class="hljs-property">ptr</span>;
        deleter =<span class="hljs-attr">std</span>::<span class="hljs-title function_">move</span>(other.<span class="hljs-property">deleter</span>);
        other.<span class="hljs-property">ptr</span> = nullptr;
    }
    <span class="hljs-title class_">Unique</span>_ptr&amp; operator=(<span class="hljs-title class_">Unique</span>_ptr&amp;&amp; other) {
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span> == &amp;other)
            <span class="hljs-keyword">return</span> *<span class="hljs-variable language_">this</span>;
        <span class="hljs-keyword">if</span> (ptr)
            <span class="hljs-title function_">deleter</span>(ptr);
        ptr = other.<span class="hljs-property">ptr</span>;
        deleter =<span class="hljs-attr">std</span>::<span class="hljs-title function_">move</span>(other.<span class="hljs-property">deleter</span>);
        other.<span class="hljs-property">ptr</span> = nullptr;
        <span class="hljs-keyword">return</span> *<span class="hljs-variable language_">this</span>;
    }

    T* <span class="hljs-title function_">get</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> ptr; }

    <span class="hljs-keyword">void</span> <span class="hljs-title function_">reset</span>(<span class="hljs-params">T* ptr = nullptr</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>-&gt;ptr)
            <span class="hljs-title function_">deleter</span>(<span class="hljs-variable language_">this</span>-&gt;ptr);
        <span class="hljs-variable language_">this</span>-&gt;ptr = ptr;
    }


    T&amp; operator*() { <span class="hljs-keyword">return</span> *ptr; }
    T* operator-&gt;() { <span class="hljs-keyword">return</span> ptr; }
};

template&lt;typename T&gt;
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DefaultDelete</span> {
<span class="hljs-attr">public</span>:
    <span class="hljs-title class_">DefaultDelete</span>() = <span class="hljs-keyword">default</span>;
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">operator</span>()(T* ptr) <span class="hljs-keyword">const</span> {
        <span class="hljs-keyword">delete</span> ptr;
    }
};
</code></pre>
<p>é€šè¿‡ä¸Šè¯‰ä¼ªä»£ç å¯çŸ¥ï¼Œunique_ptrç‹¬å æ‰€æœ‰æƒï¼Œä¸èƒ½å¤åˆ¶ï¼Œåªèƒ½ç§»åŠ¨</p>
<h2 data-id="heading-1">Share_pträ¼ªä»£ç </h2>
<pre><code class="hljs language-js" lang="js">#include &lt;functional&gt;
template&lt;typename T&gt;
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Share_ptr</span>
{
<span class="hljs-attr">public</span>:
	<span class="hljs-title class_">Share</span>_ptr(T* ptr, <span class="hljs-attr">std</span>::<span class="hljs-keyword">function</span>&lt;<span class="hljs-title function_">void</span>(<span class="hljs-keyword">void</span>*)&gt; deleter)
	{
		m_ptr = ptr;
		m_block = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Block</span>(ptr, deleter);
	}
    ~<span class="hljs-title class_">Share</span>_ptr()
    {
        <span class="hljs-keyword">if</span> (m_block-&gt;m_count == <span class="hljs-number">0</span>)
        {
            m_block-&gt;<span class="hljs-title function_">deleter</span>(m_ptr);
            <span class="hljs-keyword">delete</span> m_block;
        }
    }

	<span class="hljs-title class_">Share</span>_ptr(<span class="hljs-keyword">const</span> <span class="hljs-title class_">Share</span>_ptr&amp; other) {
	
		m_ptr=other.<span class="hljs-property">m_ptr</span>;
        m_block=other.<span class="hljs-property">m_block</span>;
        <span class="hljs-keyword">if</span>(m_block) m_block-&gt;<span class="hljs-title function_">increase_ref</span>();
	}
    <span class="hljs-title class_">Share</span>_ptr&amp; operator=(<span class="hljs-keyword">const</span> <span class="hljs-title class_">Share</span>_ptr&amp; other) {
		<span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>!=other) {

			<span class="hljs-keyword">if</span> (m_block) {
				<span class="hljs-keyword">if</span> (m_block-&gt;<span class="hljs-title function_">decrease_ref</span>()==<span class="hljs-number">0</span>) {
					m_block-&gt;<span class="hljs-title function_">deleter</span>(m_ptr);
					<span class="hljs-keyword">delete</span> m_block;
				}
			}
			m_ptr = other.<span class="hljs-property">m_ptr</span>;
			m_block = other.<span class="hljs-property">m_block</span>;
			<span class="hljs-keyword">if</span> (m_block)m_block-&gt;<span class="hljs-title function_">increase_ref</span>();
		}
       <span class="hljs-keyword">return</span> *<span class="hljs-variable language_">this</span>;
	}
    <span class="hljs-title class_">Share</span>_ptr(<span class="hljs-title class_">Share</span>_ptr&amp;&amp; other) {
		m_ptr = other.<span class="hljs-property">m_ptr</span>;
        m_block = other.<span class="hljs-property">m_block</span>;
        other.<span class="hljs-property">m_ptr</span> = nullptr;
        other.<span class="hljs-property">m_block</span> = nullptr;
	}
    <span class="hljs-title class_">Share</span>_ptr&amp; operator=(<span class="hljs-title class_">Share</span>_ptr&amp;&amp; other) {
		<span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span> != other) {

			<span class="hljs-keyword">if</span> (m_block) {
				<span class="hljs-keyword">if</span> (m_block-&gt;<span class="hljs-title function_">decrease_ref</span>() == <span class="hljs-number">0</span>) {
					m_block-&gt;<span class="hljs-title function_">deleter</span>(m_ptr);
					<span class="hljs-keyword">delete</span> m_block;
				}
			}
			m_ptr = other.<span class="hljs-property">m_ptr</span>;
			m_block = other.<span class="hljs-property">m_block</span>;
			other.<span class="hljs-property">m_ptr</span> = nullptr;
			other.<span class="hljs-property">m_block</span> = nullptr;
		}
		<span class="hljs-keyword">return</span> *<span class="hljs-variable language_">this</span>;
	}
    T* <span class="hljs-title function_">get</span>(<span class="hljs-params"/>)
    {
        <span class="hljs-keyword">return</span> m_ptr;
    }
    T&amp; operator*()
    {
        <span class="hljs-keyword">return</span> *m_ptr;
    }
    T* operator-&gt;()
    {
        <span class="hljs-keyword">return</span> m_ptr;
    }
<span class="hljs-attr">private</span>:
    T* m_ptr;
	<span class="hljs-title class_">Block</span>* m_block;

};

struct <span class="hljs-title class_">Block</span>
{
	int m_count;
	<span class="hljs-attr">std</span>::<span class="hljs-keyword">function</span>&lt;<span class="hljs-title function_">void</span>(<span class="hljs-keyword">void</span>*)&gt; deleter;
	<span class="hljs-title class_">Block</span>(<span class="hljs-keyword">void</span>* p, <span class="hljs-attr">std</span>::<span class="hljs-keyword">function</span>&lt;<span class="hljs-title function_">void</span>(<span class="hljs-keyword">void</span>*)&gt; d) : <span class="hljs-title function_">m_count</span>(<span class="hljs-number">0</span>), <span class="hljs-title function_">deleter</span>(<span class="hljs-params">d</span>) {};

	<span class="hljs-keyword">void</span> <span class="hljs-title function_">increase_ref</span>(<span class="hljs-params"/>)
	{
		m_count++;
	}
	<span class="hljs-keyword">void</span> <span class="hljs-title function_">decrease_ref</span>(<span class="hljs-params"/>)
	{
		m_count--;
	}
};
</code></pre>
<p>share_ptrå…±äº«æ‰€æœ‰æƒï¼Œå†…éƒ¨æœ‰å…±äº«æ§åˆ¶å—ï¼ˆæŒ‡å‘åŒä¸€ä¸ªå †å†…å­˜ï¼‰ç»´æŠ¤å¼•ç”¨è®¡æ•°ï¼Œæœ€åä¸€ä¸ªå¼•ç”¨é”€æ¯çš„æ—¶é‡Šæ”¾èµ„æºã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Kubernetesã€‘ä»¥è‹±é›„è”ç›Ÿçš„è§†è§’æ‰“å¼€K8s - ä»€ä¹ˆæ˜¯K8sçš„Pod]]></title>    <link>https://juejin.cn/post/7598011274687135744</link>    <guid>https://juejin.cn/post/7598011274687135744</guid>    <pubDate>2026-01-22T16:07:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598011274687135744" data-draft-id="7598011274687119360" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Kubernetesã€‘ä»¥è‹±é›„è”ç›Ÿçš„è§†è§’æ‰“å¼€K8s - ä»€ä¹ˆæ˜¯K8sçš„Pod"/> <meta itemprop="keywords" content="åç«¯,Kubernetes"/> <meta itemprop="datePublished" content="2026-01-22T16:07:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ThisIsClark"/> <meta itemprop="url" content="https://juejin.cn/user/518625216693341"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Kubernetesã€‘ä»¥è‹±é›„è”ç›Ÿçš„è§†è§’æ‰“å¼€K8s - ä»€ä¹ˆæ˜¯K8sçš„Pod
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/518625216693341/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ThisIsClark
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-22T16:07:07.000Z" title="Thu Jan 22 2026 16:07:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å¼•è¨€ï¼šæŠ€æœ¯æ¦‚å¿µéš¾ï¼Ÿä¸å¦‚ç”¨ LOL å½“ â€œç¿»è¯‘â€</h3>
<p>æåˆ° K8s çš„ â€œPodâ€ï¼Œæ–°æ‰‹å¸¸è¢« â€œå®¹å™¨ç»„â€â€œéƒ¨ç½²å•å…ƒâ€ ç­‰æœ¯è¯­ç»•æ™• â€”â€” ä½†å¦‚æœä½ ç©è¿‡è‹±é›„è”ç›Ÿï¼ˆLOLï¼‰ï¼Œè¿™ä»¶äº‹ä¼šå˜å¾—å¾ˆç®€å•ã€‚</p>
<p>å…¶å® K8s é‡Œçš„ â€œé•œåƒä¸ Podâ€ï¼Œå’Œ LOL é‡Œçš„ â€œè‹±é›„ä¸è£…å¤‡â€ æ˜¯ä¸€æ¨¡ä¸€æ ·çš„é€»è¾‘ï¼šè‹±é›„æœ¬ä½“ä¸å˜ï¼Œå‡ºè£…ä¸åŒèƒ½æ‰“ä¸åŒä½ç½®ï¼›é•œåƒæœ¬ä½“ä¸å˜ï¼ŒPod é…ç½®ä¸åŒèƒ½é€‚é…ä¸åŒåœºæ™¯ã€‚ä»Šå¤©å’±ä»¬å°±ç”¨ LOL çš„è§†è§’ï¼ŒæŠŠ â€œPodâ€ è¿™ä¸ªæ¦‚å¿µå½»åº•è®²æ˜ç™½ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€å…ˆé”šå®š LOL åœºæ™¯ï¼šè‹±é›„ + å‡ºè£…ï¼Œæ‰æ˜¯å®Œæ•´ â€œä½œæˆ˜å•ä½â€</h3>
<p>ç© LOL æ—¶ï¼Œæ²¡äººä¼šåªçœ‹è‹±é›„ä¸çœ‹å‡ºè£… â€”â€” åŒæ ·æ˜¯ç›–ä¼¦ï¼Œå‡ºè£…ä¸åŒå®šä½å®Œå…¨ä¸åŒï¼š</p>
<ul>
<li>
<p>è¾“å‡ºè£…ï¼ˆæ— å°½ + ç”µåˆ€ + é¥®è¡€å‰‘ï¼‰ï¼šç§’è„†çš®çš„ â€œä¸Šå•åˆºå®¢â€ï¼Œä½†æ‰›ä¼¤å¼±ï¼›</p>
</li>
<li>
<p>å¦å…‹è£…ï¼ˆæ—¥ç‚ + ç‹‚å¾’ + åç”²ï¼‰ï¼šæŒ¡ä¼¤å®³çš„ â€œå‰æ’å¦å…‹â€ï¼Œä½†è¾“å‡ºä½ï¼›</p>
</li>
<li>
<p>åŠè‚‰è£…ï¼ˆä¸‰ç›¸ + è¡€æ‰‹ + æ­»äº¡ä¹‹èˆï¼‰ï¼šèƒ½æ‰“èƒ½æ‰›çš„ â€œå›¢æˆ˜å…ˆé”‹â€ï¼Œé€‚é…æ‹‰æ‰¯å±€ã€‚</p>
</li>
</ul>
<p>å…³é”®è§„å¾‹ï¼š<strong>è‹±é›„æ˜¯ â€œåŸºç¡€æ¨¡æ¿â€ï¼ˆæŠ€èƒ½ã€åŸºç¡€å±æ€§å›ºå®šï¼‰ï¼Œå‡ºè£…æ˜¯ â€œå®šåˆ¶åŒ–é…ç½®â€ï¼ˆå†³å®šåŠŸèƒ½ã€å®šä½ï¼‰ï¼ŒäºŒè€…ç»“åˆæ‰æ˜¯èƒ½ä¸Šæˆ˜åœºçš„å®Œæ•´å•ä½</strong>ã€‚</p>
<p>è¿™ä¸ªè§„å¾‹ï¼Œæ­£æ˜¯ç†è§£ K8s Pod çš„æ ¸å¿ƒé’¥åŒ™ã€‚</p>
<h3 data-id="heading-2">äºŒã€æ ¸å¿ƒç±»æ¯”ï¼šLOL ä¸ K8s çš„ â€œå¯¹åº”å…¬å¼â€</h3>
<p>æŠŠ LOL é‡Œçš„æ¦‚å¿µç›´æ¥ â€œç¿»è¯‘â€ æˆ K8s æœ¯è¯­ï¼Œç¬é—´æ‰“é€šç†è§£å£å’ â€”â€” ä»¥åçœ‹åˆ° Podï¼Œå°±æƒ³ â€œè¿™æ˜¯ç»™é•œåƒé…çš„â€˜LOL è£…å¤‡å¥—è£…â€™â€ï¼š</p>





























<table><thead><tr><th>è‹±é›„è”ç›Ÿï¼ˆLOLï¼‰</th><th>K8s ä¸–ç•Œ</th><th>æ ¸å¿ƒè§’è‰²</th><th>ä¸¾ä¸ªä¾‹å­</th></tr></thead><tbody><tr><td>è‹±é›„æœ¬ä½“</td><td>é•œåƒï¼ˆImageï¼‰</td><td>åŸºç¡€æ¨¡æ¿ï¼šå›ºå®šä¸å˜ï¼ŒåŒ…å«åº”ç”¨æ ¸å¿ƒä»£ç ã€ä¾èµ–ç¯å¢ƒ</td><td>Nginx é•œåƒï¼ˆå« Web æœåŠ¡ç¨‹åºï¼‰ã€Redis é•œåƒï¼ˆå«ç¼“å­˜ç¨‹åºï¼‰</td></tr><tr><td>è£…å¤‡å¥—è£…</td><td>Podï¼ˆå®¹å™¨ç»„ï¼‰</td><td>å®šåˆ¶é…ç½®ï¼šåŒ…è£¹é•œåƒï¼ŒåŠ èµ„æºã€å­˜å‚¨ã€ç½‘ç»œç­‰ â€œé™„åŠ èƒ½åŠ›â€</td><td>ç»™ Nginx é•œåƒé… â€œå°èµ„æº + æ— å­˜å‚¨â€ï¼ˆæµ‹è¯•ç”¨ï¼‰ã€â€œå¤§èµ„æº + æŒä¹…åŒ–â€ï¼ˆç”Ÿäº§ç”¨ï¼‰</td></tr><tr><td>å®Œæ•´ä½œæˆ˜å•ä½</td><td>é•œåƒ + Pod é…ç½®</td><td>å¯è¿è¡Œå®ä¾‹ï¼šå•ç‹¬é•œåƒ / è£…å¤‡æ²¡ç”¨ï¼Œç»“åˆåæ‰æœ‰ç”¨</td><td>è£¸è£…ç›–ä¼¦æ‰“ä¸è¿‡å‡ºè£…ç›–ä¼¦ï¼›å•ç‹¬ Nginx é•œåƒæ²¡æ³•åœ¨ K8s è¿è¡Œï¼Œå¥—ä¸Š Pod æ‰èƒ½éƒ¨ç½²</td></tr></tbody></table>
<p>ä¸€å¥è¯æ€»ç»“ï¼š<strong>Pod å°±æ˜¯ K8s é‡Œç»™ â€œé•œåƒè‹±é›„â€ é…çš„ â€œè£…å¤‡å¥—è£…â€â€”â€” åŒä¸€ä¸ªé•œåƒï¼Œæ¢å¥— Pod â€œå‡ºè£…â€ï¼Œå°±èƒ½å®ç°å®Œå…¨ä¸åŒçš„åº”ç”¨æ•ˆæœ</strong>ã€‚</p>
<h3 data-id="heading-3">ä¸‰ã€æ‹†è§£ Pod çš„ â€œå‡ºè£…é€»è¾‘â€ï¼šåƒç»™è‹±é›„é…è£…ä¸€æ ·ç»™é•œåƒèµ‹èƒ½</h3>
<p>LOL çš„è£…å¤‡åˆ† â€œå±æ€§è£…â€ï¼ˆåŠ æ”»é˜²ï¼‰å’Œ â€œåŠŸèƒ½è£…â€ï¼ˆå¸¦ç‰¹æ•ˆï¼‰ï¼ŒPod çš„é…ç½®ä¹Ÿåˆ†ä¸¤ç±»ï¼Œå¯¹åº”ç»™é•œåƒåŠ  â€œLOL å¼èƒ½åŠ›â€ï¼š</p>
<h4 data-id="heading-4">1. ã€Œå±æ€§è£…ã€ï¼šå®š â€œåŸºç¡€èƒ½åŠ›ä¸Šé™â€â€”â€” åƒç»™è‹±é›„åŠ æ”»å‡»åŠ› / è¡€é‡</h4>
<p>LOL é‡Œï¼Œè£…å¤‡çš„ â€œæ”»å‡»åŠ› + 100â€â€œè¡€é‡ + 500â€ å†³å®šè‹±é›„åŸºç¡€å¼ºåº¦ï¼›K8s é‡Œï¼ŒPod çš„ â€œèµ„æºé…ç½®â€ å†³å®šé•œåƒçš„æ€§èƒ½ä¸Šé™ï¼š</p>
<ul>
<li>
<p>åŒä¸€ä¸ª Nginx â€œè‹±é›„â€ï¼ˆé•œåƒï¼‰ï¼š</p>
<ul>
<li>
<p>æµ‹è¯•ç¯å¢ƒ â€œå‡ºè£…â€ï¼š<code>resources.limits.cpu=0.5, memory=512Mi</code> â†’ åƒç»™ç›–ä¼¦å‡º â€œå°ä»¶è£…å¤‡â€ï¼Œå ç”¨èµ„æºå°‘ï¼Œé€‚åˆä½å¹¶å‘éªŒè¯ï¼›</p>
</li>
<li>
<p>ç”Ÿäº§ç¯å¢ƒ â€œå‡ºè£…â€ï¼š<code>resources.limits.cpu=4, memory=8Gi</code> â†’ åƒç»™ç›–ä¼¦å‡º â€œç¥è£…â€ï¼Œæ€§èƒ½æ‹‰æ»¡ï¼Œèƒ½æ‰›ä¸Šä¸‡æ¬¡è¯·æ±‚ã€‚</p>
</li>
</ul>
</li>
</ul>
<h4 data-id="heading-5">2. ã€ŒåŠŸèƒ½è£…ã€ï¼šåŠ  â€œä¸“å±ç‰¹æ•ˆâ€â€”â€” åƒç»™è‹±é›„åŠ å¸è¡€ / ä½ç§»</h4>
<p>LOL é‡Œï¼Œé¥®è¡€å‰‘çš„ â€œå¸è¡€â€ã€é—ªç°çš„ â€œä½ç§»â€ æ˜¯è‹±é›„çš„æ ¸å¿ƒç‰¹æ•ˆï¼›K8s é‡Œï¼ŒPod çš„ â€œé™„åŠ é…ç½®â€ æ˜¯é•œåƒçš„æ ¸å¿ƒæ‰©å±•èƒ½åŠ›ï¼š</p>
<ul>
<li>
<p>åœºæ™¯ 1ï¼šå­˜å‚¨æŒ‚è½½ï¼ˆç±»æ¯” â€œå¸è¡€è£…â€â€”â€” è®©åº”ç”¨ â€œç»­èˆªä¸æ‰è¡€â€ï¼‰</p>
<p>åŒä¸€ä¸ª Redis â€œè‹±é›„â€ï¼ˆç¼“å­˜é•œåƒï¼‰ï¼š</p>
<ul>
<li>
<p>æ— å­˜å‚¨ â€œå‡ºè£…â€ï¼šåƒè£¸è£…ç›–ä¼¦ï¼Œé‡å¯åæ•°æ®å…¨ä¸¢ï¼Œé€‚åˆä¸´æ—¶ç¼“å­˜ï¼›</p>
</li>
<li>
<p>æŒ‚ PVC å­˜å‚¨ â€œå‡ºè£…â€ï¼ˆ<code>volumes.persistentVolumeClaim</code>ï¼‰ï¼šåƒå‡ºäº†é¥®è¡€å‰‘ï¼Œæ•°æ®æŒä¹…åŒ–ï¼Œç”Ÿäº§ç¯å¢ƒä¸æ€•é‡å¯ã€‚</p>
</li>
</ul>
</li>
<li>
<p>åœºæ™¯ 2ï¼šSidecar å®¹å™¨ï¼ˆç±»æ¯” â€œè¾…åŠ©è£…â€â€”â€” ç»™è‹±é›„é… â€œé˜Ÿå‹â€ï¼‰</p>
<p>åŒä¸€ä¸ª Java åº”ç”¨ â€œè‹±é›„â€ï¼ˆä¸šåŠ¡é•œåƒï¼‰ï¼š</p>
<ul>
<li>
<p>å•å®¹å™¨ â€œå‡ºè£…â€ï¼šåªèƒ½å•ç‹¬æä¾›æœåŠ¡ï¼Œåƒ solo æ‰“æ¸¸æˆï¼›</p>
</li>
<li>
<p>åŠ  Prometheus ç›‘æ§å®¹å™¨ â€œå‡ºè£…â€ï¼šåƒç»™è‹±é›„é…äº†ä¸ª â€œè¾…åŠ©â€ï¼Œæ—¢èƒ½å¹²æ´»åˆèƒ½ç›‘æ§ï¼Œè¿˜ä¸æ”¹åŠ¨ä¸šåŠ¡æœ¬èº«ã€‚</p>
</li>
</ul>
</li>
<li>
<p>åœºæ™¯ 3ï¼šç¯å¢ƒå˜é‡ï¼ˆç±»æ¯” â€œç¬¦æ–‡â€â€”â€” å¾®è°ƒå±æ€§ä¸æ¢è£…ï¼‰</p>
<p>åŒä¸€ä¸ª API æœåŠ¡ â€œè‹±é›„â€ï¼ˆæ¥å£é•œåƒï¼‰ï¼š</p>
<ul>
<li>
<p><code>env: {MODE: "dev"}</code>ï¼šå¼€å‘ â€œç¬¦æ–‡â€ï¼Œæ—¥å¿—è¯¦ç»†ã€å…³æƒé™æ ¡éªŒï¼Œæ–¹ä¾¿è°ƒè¯•ï¼›</p>
</li>
<li>
<p><code>env: {MODE: "prod"}</code>ï¼šç”Ÿäº§ â€œç¬¦æ–‡â€ï¼Œæ—¥å¿—ç²¾ç®€ã€å¼€å…¨é‡æ ¡éªŒï¼Œä¿è¯ç¨³å®šã€‚</p>
</li>
</ul>
</li>
</ul>
<h3 data-id="heading-6">å››ã€å®æ“éªŒè¯ï¼šä¸¤ä¸ª Nginx Pod çš„ â€œLOL å‡ºè£…å¯¹æ¯”â€</h3>
<p>å…‰è¯´ç†è®ºä¸å¤Ÿï¼Œå’±ä»¬ç”¨ YAML é…ç½®å½“ â€œå‡ºè£…æ–¹æ¡ˆâ€ï¼Œå®æˆ˜çœ‹ â€œåŒä¸€ä¸ª Nginx è‹±é›„ï¼Œä¸åŒ Pod å‡ºè£…çš„å·®å¼‚â€â€”â€” å°±åƒçœ‹ç›–ä¼¦å‡ºè¾“å‡ºè£…å’Œå¦å…‹è£…çš„å®æˆ˜æ•ˆæœã€‚</p>
<h4 data-id="heading-7">1. å‡ºè£…æ–¹æ¡ˆ 1ï¼šæµ‹è¯•ç¯å¢ƒ â€œè¿‡æ¸¡è£…â€ï¼ˆé€‚åˆä¸´æ—¶ç”¨ï¼‰</h4>
<p>åˆ›å»º<code>nginx-test-pod.yaml</code>ï¼Œå¯¹åº” LOL é‡Œçš„ â€œå°ä»¶è¿‡æ¸¡è£…â€ï¼Œä¸è¿½æ±‚æ€§èƒ½ä½†å¤Ÿç”¨ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Pod</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">nginx-test</span>  <span class="hljs-comment"># å‡ºè£…æ–¹æ¡ˆåï¼šæµ‹è¯•è£…</span>
  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">lol-role:</span> <span class="hljs-string">"è¿‡æ¸¡è£…"</span>  <span class="hljs-comment"># ç±»æ¯”LOLè£…å¤‡å®šä½</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">containers:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">nginx-hero</span>  <span class="hljs-comment"># è‹±é›„åï¼šNginx</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">nginx:1.24</span>  <span class="hljs-comment"># å›ºå®šè‹±é›„æœ¬ä½“ï¼ˆé•œåƒä¸å˜ï¼‰</span>
    <span class="hljs-comment"># å±æ€§è£…ï¼šä½é…ç½®ï¼ˆè¿‡æ¸¡ç”¨ï¼‰</span>
    <span class="hljs-attr">resources:</span>
      <span class="hljs-attr">limits:</span>
        <span class="hljs-attr">cpu:</span> <span class="hljs-string">"0.5"</span>    <span class="hljs-comment"># ç›¸å½“äºâ€œæ”»å‡»åŠ›+50â€</span>
        <span class="hljs-attr">memory:</span> <span class="hljs-string">"512Mi"</span>  <span class="hljs-comment"># ç›¸å½“äºâ€œè¡€é‡+1000â€</span>
    <span class="hljs-comment"># ç¬¦æ–‡ï¼šæµ‹è¯•æ¨¡å¼</span>
    <span class="hljs-attr">env:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">NGINX_MODE</span>
      <span class="hljs-attr">value:</span> <span class="hljs-string">"test"</span>  <span class="hljs-comment"># æ—¥å¿—è¯¦ç»†ï¼ŒåƒLOLé‡Œçš„â€œè§†é‡ç¬¦æ–‡â€</span>
    <span class="hljs-attr">ports:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">containerPort:</span> <span class="hljs-number">80</span>  <span class="hljs-comment"># åŸºç¡€æŠ€èƒ½ï¼šå¼€80ç«¯å£</span>
    <span class="hljs-comment"># æ— åŠŸèƒ½è£…ï¼šæ— æŒä¹…åŒ–ï¼ˆåƒæ²¡å‡ºå¸è¡€è£…ï¼Œæ‰è¡€ä¸å›ï¼‰</span>
</code></pre>
<h4 data-id="heading-8">2. å‡ºè£…æ–¹æ¡ˆ 2ï¼šç”Ÿäº§ç¯å¢ƒ â€œç¥è£…â€ï¼ˆé€‚åˆæ­£å¼æˆ˜ï¼‰</h4>
<p>åˆ›å»º<code>nginx-prod-pod.yaml</code>ï¼Œå¯¹åº” LOL é‡Œçš„ â€œæ»¡ç¥è£…â€ï¼Œæ€§èƒ½æ‹‰æ»¡è¿˜å¸¦ç‰¹æ•ˆï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Pod</span>
<span class="hljs-attr">metadata:</span>
 <span class="hljs-attr">name:</span> <span class="hljs-string">nginx-prod</span>  <span class="hljs-comment"># å‡ºè£…æ–¹æ¡ˆåï¼šç”Ÿäº§ç¥è£…</span>
 <span class="hljs-attr">labels:</span>
   <span class="hljs-attr">lol-role:</span> <span class="hljs-string">"ç¥è£…"</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">containers:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">nginx-hero</span>  <span class="hljs-comment"># åŒä¸€ä¸ªNginxè‹±é›„</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">nginx:1.24</span>  <span class="hljs-comment"># è‹±é›„æœ¬ä½“ä¸å˜</span>
    <span class="hljs-comment"># å±æ€§è£…ï¼šé«˜é…ç½®ï¼ˆç¥è£…çº§ï¼‰</span>
    <span class="hljs-attr">resources:</span>
      <span class="hljs-attr">limits:</span>
        <span class="hljs-attr">cpu:</span> <span class="hljs-string">"4"</span>      <span class="hljs-comment"># æ”»å‡»åŠ›+500</span>
        <span class="hljs-attr">memory:</span> <span class="hljs-string">"8Gi"</span>  <span class="hljs-comment"># è¡€é‡+10000</span>
      <span class="hljs-attr">requests:</span>
        <span class="hljs-attr">cpu:</span> <span class="hljs-string">"2"</span>      <span class="hljs-comment"># ä¿åº•å±æ€§ï¼Œç¡®ä¿ä¼˜å…ˆæ‹¿åˆ°èµ„æº</span>
        <span class="hljs-attr">memory:</span> <span class="hljs-string">"4Gi"</span>
    <span class="hljs-comment"># ç¬¦æ–‡ï¼šç”Ÿäº§æ¨¡å¼</span>
    <span class="hljs-attr">env:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">NGINX_MODE</span>
      <span class="hljs-attr">value:</span> <span class="hljs-string">"prod"</span>  <span class="hljs-comment"># æ—¥å¿—ç²¾ç®€+å®‰å…¨æ ¡éªŒï¼Œåƒâ€œé˜²å¾¡ç¬¦æ–‡â€</span>
    <span class="hljs-attr">ports:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">containerPort:</span> <span class="hljs-number">80</span>
      <span class="hljs-attr">hostPort:</span> <span class="hljs-number">8080</span>  <span class="hljs-comment"># ç‰¹æ•ˆï¼šç»‘å®šå®¿ä¸»æœºç«¯å£ï¼Œå¤–éƒ¨èƒ½è®¿é—®ï¼ˆåƒLOLçš„â€œä¼ é€ç‰¹æ•ˆâ€ï¼‰</span>
    <span class="hljs-comment"># åŠŸèƒ½è£…ï¼šæŒä¹…åŒ–å­˜å‚¨ï¼ˆå¸è¡€è£…ï¼‰</span>
    <span class="hljs-attr">volumeMounts:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">nginx-data</span>
      <span class="hljs-attr">mountPath:</span> <span class="hljs-string">/usr/share/nginx/html</span>  <span class="hljs-comment"># ç»™è‹±é›„åŠ â€œå¸è¡€è¢«åŠ¨â€</span>
  <span class="hljs-attr">volumes:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">nginx-data</span>
    <span class="hljs-attr">persistentVolumeClaim:</span>
      <span class="hljs-attr">claimName:</span> <span class="hljs-string">test-pvc</span>  <span class="hljs-comment"># å¼•ç”¨å­˜å‚¨â€œè£…å¤‡â€</span>
</code></pre>
<h4 data-id="heading-9">3. çœ‹ â€œå®æˆ˜æ•ˆæœâ€ï¼šå‡ºè£…ä¸åŒï¼Œè¡¨ç°å¤©å·®åœ°åˆ«</h4>
<pre><code class="hljs language-console" lang="console">\# 1. éƒ¨ç½²ä¸¤å¥—â€œå‡ºè£…æ–¹æ¡ˆâ€

kubectl apply -f nginx-test-pod.yaml -f nginx-prod-pod.yaml

\# 2. æŸ¥çœ‹â€œè‹±é›„çŠ¶æ€â€ï¼ˆæ˜¯å¦æˆåŠŸå‡ºè£…ï¼‰

kubectl get pods -l lol-role in (è¿‡æ¸¡è£…,ç¥è£…)
</code></pre>
<p>è¾“å‡ºæ˜¾ç¤ºä¸¤å¥— â€œå‡ºè£…â€ éƒ½ç”Ÿæ•ˆï¼Œä½†æ•ˆæœä¸åŒï¼š</p>




















<table><thead><tr><th>å‡ºè£…æ–¹æ¡ˆ</th><th>çŠ¶æ€</th><th>æ ¸å¿ƒå·®å¼‚ï¼ˆç±»æ¯” LOL æ•ˆæœï¼‰</th></tr></thead><tbody><tr><td>nginx-testï¼ˆè¿‡æ¸¡è£…ï¼‰</td><td>Running</td><td>è¡€å°‘æ”»ä½ï¼Œåªèƒ½å†…éƒ¨è®¿é—®ï¼ˆåƒç›–ä¼¦å‡ºå°ä»¶ï¼Œæ‰“ä¸äº†å›¢ï¼‰</td></tr><tr><td>nginx-prodï¼ˆç¥è£…ï¼‰</td><td>Running</td><td>è¡€åšæ”»é«˜ï¼Œå¤–éƒ¨èƒ½è®¿é—® + æ•°æ®ä¸ä¸¢ï¼ˆåƒç›–ä¼¦å‡ºç¥è£…ï¼Œèƒ½æ‰›èƒ½æ‰“ï¼‰</td></tr></tbody></table>
<p>å†éªŒè¯ â€œåŠŸèƒ½è£…â€ æ•ˆæœï¼ˆæŒä¹…åŒ– = å¸è¡€ï¼‰ï¼š</p>
<pre><code class="hljs language-console" lang="console"><span class="hljs-meta prompt_"># </span><span class="bash">ç»™ç¥è£…Podå†™â€œæˆ˜ç»©â€ï¼ˆå­˜æ–‡ä»¶ï¼‰</span>

kubectl exec -it nginx-prod -- echo "ç”Ÿäº§ç¯å¢ƒç½‘é¡µ" &gt; /usr/share/nginx/html/index.html
<span class="hljs-meta prompt_">
# </span><span class="bash">é‡å¯ç¥è£…Podï¼ˆæ¨¡æ‹Ÿå›¢æˆ˜å¤æ´»ï¼‰</span>

kubectl delete pod nginx-prod &amp;&amp; kubectl apply -f nginx-prod-pod.yaml
<span class="hljs-meta prompt_">
# </span><span class="bash">çœ‹â€œæˆ˜ç»©â€è¿˜åœ¨ä¸åœ¨ï¼ˆå¸è¡€ç”Ÿæ•ˆï¼‰</span>

kubectl exec -it nginx-prod -- cat /usr/share/nginx/html/index.html
<span class="hljs-meta prompt_">
# </span><span class="bash">è¾“å‡ºï¼šç”Ÿäº§ç¯å¢ƒç½‘é¡µï¼ˆæ•°æ®æ²¡ä¸¢ï¼Œåƒç›–ä¼¦å¤æ´»åè¿˜æœ‰å¸è¡€ï¼‰</span>
<span class="hljs-meta prompt_">
# </span><span class="bash">å¯¹æ¯”è¿‡æ¸¡è£…Podï¼šé‡å¯åâ€œæˆ˜ç»©â€æ¶ˆå¤±ï¼ˆæ²¡å¸è¡€ï¼‰</span>

kubectl exec -it nginx-test -- echo "æµ‹è¯•ç½‘é¡µ" &gt; /usr/share/nginx/html/index.html

kubectl delete pod nginx-test &amp;&amp; kubectl apply -f nginx-test-pod.yaml

kubectl exec -it nginx-test -- cat /usr/share/nginx/html/index.html
<span class="hljs-meta prompt_">
# </span><span class="bash">è¾“å‡ºï¼šé»˜è®¤Nginxé¡µé¢ï¼ˆæ•°æ®ä¸¢äº†ï¼Œåƒç›–ä¼¦å¤æ´»åæ²¡å¸è¡€ï¼‰</span>
</code></pre>
<h3 data-id="heading-10">äº”ã€çœ‹é€æœ¬è´¨ï¼šPod æ˜¯ K8s çš„ â€œå®Œæ•´ä½œæˆ˜å•ä½â€â€”â€” åƒ LOL çš„ â€œè‹±é›„ + è£…å¤‡â€</h3>
<p>ä» LOL è§†è§’çœ‹ï¼ŒPod çš„æœ¬è´¨å¾ˆç®€å•ï¼š</p>
<ol>
<li>
<p>å•ç‹¬é•œåƒ = è£¸è£…è‹±é›„ï¼šåªæœ‰åŸºç¡€æ¨¡æ¿ï¼Œæ²¡æ³•ä¸Š â€œK8s æˆ˜åœºâ€ï¼ˆä¸èƒ½ç›´æ¥éƒ¨ç½²è¿è¡Œï¼‰ï¼›</p>
</li>
<li>
<p>å•ç‹¬ Pod é…ç½® = ç©ºè£…å¤‡ï¼šæ²¡è‹±é›„ç”¨ï¼Œå°±æ˜¯ä¸€å †æ²¡ç”¨çš„ â€œå±æ€§ / ç‰¹æ•ˆâ€ï¼›</p>
</li>
<li>
<p>é•œåƒ + Pod = è‹±é›„ + è£…å¤‡ï¼šæ‰æ˜¯ K8s é‡Œèƒ½è°ƒåº¦ã€èƒ½è¿è¡Œã€èƒ½é€‚é…åœºæ™¯çš„ â€œå®Œæ•´ä½œæˆ˜å•ä½â€ã€‚</p>
</li>
</ol>
<p>è€Œä¸” Pod å’Œ LOL å‡ºè£…è¿˜æœ‰ä¸ªå…±æ€§ï¼š<strong>é…ç½®ä¸èƒ½ä¸­é€”æ”¹</strong>â€”â€” ç›–ä¼¦åœ¨å›¢æˆ˜é‡Œæ²¡æ³•æ¢è£…å¤‡ï¼ŒPod åœ¨è¿è¡Œä¸­ä¹Ÿæ²¡æ³•æ”¹èµ„æºã€å­˜å‚¨é…ç½®ï¼Œè¦æ”¹åªèƒ½ â€œå›åŸé‡å‡ºâ€ï¼ˆåˆ é™¤æ—§ Podï¼Œåˆ›å»ºæ–° Podï¼‰ã€‚</p>
<h3 data-id="heading-11">å…­ã€æ”¶å°¾ï¼šç”¨ LOL è§†è§’è®° Podï¼Œä»æ­¤ä¸æ…Œ K8s</h3>
<p>ä»¥åå†æœ‰äººé—®ä½  â€œPod æ˜¯ä»€ä¹ˆâ€ï¼Œä½ å°±ç”¨ LOL çš„è¯å›ç­”ï¼š</p>
<p>â€œPod å°±æ˜¯ç»™ K8s é‡Œçš„â€˜é•œåƒè‹±é›„â€™é…çš„â€˜è£…å¤‡å¥—è£…â€™â€”â€” åŒä¸€ä¸ªé•œåƒè‹±é›„ï¼Œå‡ºâ€˜æµ‹è¯•è¿‡æ¸¡è£…â€™ï¼ˆå°èµ„æº + æ— å­˜å‚¨ï¼‰å°±é€‚åˆä¸´æ—¶ç”¨ï¼Œå‡ºâ€˜ç”Ÿäº§ç¥è£…â€™ï¼ˆå¤§èµ„æº + æŒä¹…åŒ–ï¼‰å°±é€‚åˆæ­£å¼æœåŠ¡ï¼Œæœ¬è´¨å’Œç›–ä¼¦å‡ºè£…æ¢å®šä½æ˜¯ä¸€ä¸ªé“ç†ã€‚â€</p>
<p>ç”¨ç†Ÿæ‚‰çš„æ¸¸æˆå½“ â€œæ¡¥æ¢â€ï¼Œå†å¤æ‚çš„æŠ€æœ¯æ¦‚å¿µä¹Ÿèƒ½è½»æ¾ç†è§£ â€”â€” è¿™å°±æ˜¯ â€œä»¥è‹±é›„è”ç›Ÿè§†è§’æ‰“å¼€ K8sâ€ çš„æ„ä¹‰ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[day1 ç›´æ’­é—´ç™¾ä¸‡äººç‚¹èµï¼Œæ¶æ„æ€ä¹ˆè®¾è®¡]]></title>    <link>https://juejin.cn/post/7598011274687152128</link>    <guid>https://juejin.cn/post/7598011274687152128</guid>    <pubDate>2026-01-22T16:11:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598011274687152128" data-draft-id="7597987896694030371" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="day1 ç›´æ’­é—´ç™¾ä¸‡äººç‚¹èµï¼Œæ¶æ„æ€ä¹ˆè®¾è®¡"/> <meta itemprop="keywords" content="åç«¯,æ¶æ„,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-22T16:11:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="EnigmaGcl"/> <meta itemprop="url" content="https://juejin.cn/user/2796746683455454"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            day1 ç›´æ’­é—´ç™¾ä¸‡äººç‚¹èµï¼Œæ¶æ„æ€ä¹ˆè®¾è®¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2796746683455454/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    EnigmaGcl
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-22T16:11:05.000Z" title="Thu Jan 22 2026 16:11:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><hr/>
<p>é¦–å…ˆï¼Œè¿™æ˜¯ä¸€ä¸ª<strong>é«˜å¹¶å‘åœºæ™¯</strong>ï¼Œéœ€è¦å‰ç«¯å’Œåç«¯ååŒè®¾è®¡ã€ç»Ÿä¸€æ€è·¯ï¼Œæ‰èƒ½æ•´ä½“è§£å†³é—®é¢˜ã€‚</p>
<h2 data-id="heading-0">1. å‰ç«¯ä¼˜åŒ–æ€è·¯</h2>
<p>å¯¹å‰ç«¯æ¥è¯´ï¼Œæ ¸å¿ƒç›®æ ‡æ˜¯ï¼š<strong>åœ¨ä¿è¯ä½“éªŒçš„å‰æä¸‹å°½å¯èƒ½é™ä½è¯·æ±‚æ•°å’Œ QPS</strong>ã€‚åœ¨ç™¾ä¸‡çº§ç›´æ’­é—´åœºæ™¯ä¸­ï¼Œä¸»è¦æ¶‰åŠä¸¤ä¸ªæ“ä½œï¼š</p>
<ul>
<li>ç”¨æˆ·çš„ç‚¹èµè¡Œä¸º</li>
<li>ç‚¹èµæ€»æ•°çš„å±•ç¤º</li>
</ul>
<p>å¯ä»¥ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢åšä¼˜åŒ–ï¼š</p>
<ol>
<li>
<p><strong>æ‰¹é‡ä¸ŠæŠ¥ç‚¹èµ</strong></p>
<p>ç”¨æˆ·æ¯æ¬¡ç‚¹å‡»å¹¶ä¸ç«‹åˆ»å‘èµ·æ¥å£è¯·æ±‚ï¼Œè€Œæ˜¯åœ¨ä¸€ä¸ªæ—¶é—´çª—å£å†…æœ¬åœ°ç»Ÿè®¡ç‚¹å‡»æ¬¡æ•°ï¼Œ<strong>åˆå¹¶ä¸ºä¸€æ¬¡è¯·æ±‚</strong>ä¸ŠæŠ¥ã€‚</p>
<p>ä¾‹å¦‚ï¼šå‰ç«¯æ¯ç§’ä¸ŠæŠ¥ä¸€æ¬¡å½“å‰æ—¶é—´æ®µå†…çš„ç‚¹èµå¢é‡ã€‚è¿™æ ·å¯ä»¥å°†è¯·æ±‚é‡å‹ç¼©åˆ°åŸæ¥çš„å¾ˆå°ä¸€éƒ¨åˆ†ï¼Œé€šå¸¸èƒ½å‡å°‘ 80% ä»¥ä¸Šçš„è¯·æ±‚ã€‚</p>
</li>
<li>
<p><strong>ç‚¹èµæ•°å±•ç¤ºåšâ€œè¿‘ä¼¼å®æ—¶â€è€Œéâ€œå®Œå…¨å®æ—¶â€</strong></p>
<p>ç‚¹èµæ€»æ•°çš„å±•ç¤ºä¸è¦æ±‚å®Œå…¨ç²¾ç¡®ï¼Œå¯ä»¥<strong>å®šæ—¶æ‹‰å–</strong>ï¼Œä¾‹å¦‚æ¯éš” 1 ç§’è¯·æ±‚ä¸€æ¬¡ç‚¹èµé‡ã€‚</p>
<p>ä½†åœ¨ç™¾ä¸‡çº§ç›´æ’­é—´é‡Œï¼Œå¦‚æœæ‰€æœ‰ç”¨æˆ·åœ¨åŒä¸€æ—¶é—´ç‚¹å‘èµ·è¯·æ±‚ï¼Œåç«¯å‹åŠ›ä¾ç„¶å¾ˆå¤§ã€‚å¯ä»¥åœ¨å‰ç«¯å¼•å…¥<strong>éšæœºæŠ–åŠ¨</strong>ï¼šåœ¨ä¸€ä¸ªæ—¶é—´çª—å£å†…éšæœºé€‰æ‹©ä¸€ä¸ªæ—¶åˆ»å‘èµ·è¯·æ±‚ï¼Œä»è€ŒæŠŠè¯·æ±‚æ—¶é—´æ‰“æ•£ï¼Œè¿›ä¸€æ­¥å‰Šå³°ã€‚</p>
</li>
<li>
<p><strong>é™åˆ¶ç”¨æˆ·æ“ä½œ + æ¥å…¥é£æ§</strong></p>
<p>å¯¹å•ä¸ªç”¨æˆ·åœ¨ä¸€å®šæ—¶é—´å†…çš„ç‚¹èµæ¬¡æ•°è®¾ç½®ä¸Šé™ï¼Œé¿å…æç«¯é¢‘ç‡çš„æ“ä½œã€‚</p>
<p>åŒæ—¶æ¥å…¥é£æ§ï¼Œå¯¹ç–‘ä¼¼æ¶æ„è´¦å·ï¼ˆå¦‚åˆ·é‡è´¦å·ï¼‰è¿›è¡Œé™é¢‘ã€å°ç¦ç­‰å¤„ç†ï¼Œä»æºå¤´å‡å°‘æ— æ•ˆè¯·æ±‚ã€‚</p>
</li>
</ol>
<hr/>
<h2 data-id="heading-1">2. åç«¯ä¼˜åŒ–æ€è·¯</h2>
<p>å¯¹åç«¯è€Œè¨€ï¼Œå¯ä»¥å›´ç»•<strong>ç¼“å­˜ + æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå‰Šå³°å¡«è°·ï¼‰</strong> æ¥è®¾è®¡æ•´ä½“æ–¹æ¡ˆã€‚</p>
<ol>
<li>
<p><strong>ç¼“å­˜å±‚ï¼šæ‹¦æˆªé«˜é¢‘è¯»å†™ï¼Œå‡è½»æ•°æ®åº“å‹åŠ›</strong></p>
<ul>
<li>
<p>å†™å…¥ï¼šç‚¹èµè¯·æ±‚<strong>ä¸ç›´æ¥å…¥åº“</strong>ï¼Œè€Œæ˜¯å…ˆå†™å…¥ç¼“å­˜ï¼ˆå¦‚ Redisï¼‰ï¼Œè¿›è¡Œè®¡æ•°ç»Ÿè®¡ã€‚å¯ä»¥æŒ‰å›ºå®šæ—¶é—´é—´éš”ï¼ˆå¦‚æ¯ 100msï¼‰å°†å¢é‡æŒä¹…åŒ–åˆ°æ•°æ®åº“ã€‚è¿™æ„å‘³ç€ä¸€ä¸ªç›´æ’­é—´æ¯ç§’æœ€å¤šåªæœ‰ 10 æ¬¡æŒä¹…åŒ–å†™è¯·æ±‚ï¼Œå¤§å¹…å‡è½»æ•°æ®åº“å‹åŠ›ã€‚</p>
</li>
<li>
<p>è¯»å–ï¼šç”±äºå¯¹ç‚¹èµæ•°çš„ç²¾åº¦è¦æ±‚ä¸é«˜ï¼Œå¯ä»¥ç›´æ¥ä»ç¼“å­˜ä¸­è¯»å–å½“å‰è®¡æ•°ã€‚</p>
<p>æ›´è¿›ä¸€æ­¥ï¼Œæ”¶åˆ°ç‚¹èµè¯·æ±‚æ—¶å°±é€šè¿‡ Redis çš„ <code>INCRBY</code> ç­‰æ“ä½œå®Œæˆç´¯åŠ ï¼Œè¿™æ ·è¯»å–ç‚¹èµé‡æ—¶å¯ä»¥<strong>ç›´æ¥è¯»ç¼“å­˜</strong>ï¼Œä¸å¿…è®¿é—®æ•°æ®åº“ï¼Œä¹Ÿä¸å¿…åœ¨æ¯æ¬¡è¯»å–æ—¶é¢å¤–è®¡ç®—ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>æ¶ˆæ¯é˜Ÿåˆ—ï¼šè¿›ä¸€æ­¥å‰Šå³°å¡«è°·ï¼Œåšæ‰¹é‡æŒä¹…åŒ–</strong></p>
<p>ç»ç”±ç¼“å­˜åï¼Œå•ä¸ªç›´æ’­é—´çš„å†™è¯·æ±‚å·²ç»è¢«å‹ç¼©åˆ°æ¯ç§’ä¸è¶…è¿‡ 10 æ¬¡ï¼Œä½†ç›´æ’­é—´æ€»é‡å¤§æ—¶ï¼Œ<strong>æ•´ä½“æŒä¹…åŒ–å‹åŠ›ä¾ç„¶å¯è§‚</strong>ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæœ‰ 10 ä¸‡ä¸ªç›´æ’­é—´ï¼Œå³ä¾¿æ¯ä¸ªç›´æ’­é—´æ¯ç§’åªæœ‰ 10 æ¬¡æŒä¹…åŒ–æ“ä½œï¼Œæ•´ä½“ QPS ä»å¯è¾¾ 100 ä¸‡ã€‚</p>
<p>è¿™æ—¶å¯ä»¥é€šè¿‡ MQ è¿›ä¸€æ­¥å‰Šå³°ï¼š</p>
<ul>
<li>å°†æŒä¹…åŒ–è¯·æ±‚å†™å…¥ MQï¼Œè€Œä¸æ˜¯ç›´æ¥å†™æ•°æ®åº“ã€‚</li>
<li>ä»¥ç›´æ’­é—´ ID ä½œä¸º partition keyï¼Œä½¿<strong>åŒä¸€ç›´æ’­é—´çš„ç‚¹èµè¯·æ±‚åªä¼šè¢«åŒä¸€ä¸ª partition æ¶ˆè´¹</strong>ï¼Œä¿è¯é¡ºåºæ€§ã€‚</li>
<li>Consumer ç«¯å¯ä»¥æŒ‰æ—¶é—´çª—å£ï¼ˆå¦‚ 1 ç§’ï¼‰å¯¹åŒä¸€ç›´æ’­é—´çš„æ¶ˆæ¯è¿›è¡Œèšåˆç»Ÿè®¡ï¼Œåˆå¹¶ä¸ºä¸€æ¬¡æ•°æ®åº“æ›´æ–°ï¼Œä»è€Œå†ä¸€æ¬¡é™ä½æ•°æ®åº“å†™å…¥é¢‘ç‡ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ™ºèƒ½æ¨é€ï¼šæŠ½æ ·äº‹ä»¶ï¼Œå¹³è¡¡ä½“éªŒå’Œæˆæœ¬</strong></p>
<p>ç‚¹èµé‡æœ¬èº«å¯ä»¥ç”±å‰ç«¯å®šæ—¶æ‹‰å–ï¼Œä½†â€œç‚¹èµæ•ˆæœâ€å¦‚ä½•å‘ˆç°ï¼Œä¹Ÿå¾ˆå…³é”®ã€‚</p>
<p>è®¾æƒ³åœ¨ç™¾ä¸‡çº§ç›´æ’­é—´ä¸­ï¼Œæˆåƒä¸Šä¸‡äººåŒæ—¶ç‚¹èµï¼Œå¦‚æœæŠŠæ‰€æœ‰ç‚¹èµäº‹ä»¶éƒ½å®æ—¶æ¨é€åˆ°æ¯ä¸ªå®¢æˆ·ç«¯ï¼Œè®¾å¤‡ä¼šè¢«æµ·é‡æ¶ˆæ¯â€œè½°ç‚¸â€ï¼Œä½“éªŒæå·®ã€‚</p>
<p>å¯ä»¥è®¾è®¡<strong>æŠ½æ ·æ¨é€æœºåˆ¶</strong>ï¼š</p>
</li>
</ol>
<ul>
<li>é€šè¿‡å®šæ—¶ä»»åŠ¡ï¼ˆä¾‹å¦‚æ¯ 200msï¼‰å¯¹è¿™æ®µæ—¶é—´å†…çš„ç‚¹èµäº‹ä»¶å’Œç‚¹èµæ€»é‡åšé‡‡æ ·ã€‚</li>
<li>æŒ‰ä¸€å®šæŠ½æ ·ç‡ï¼ˆ1% æˆ– 0.1%ï¼Œç”šè‡³æ›´ä½ï¼‰éšæœºé€‰å–å°‘éƒ¨åˆ†ç‚¹èµäº‹ä»¶è¿›è¡Œæ¨é€ï¼ŒæŠ½æ ·ç‡å¯ä»¥æ ¹æ®å½“å‰ç‚¹èµäº‹ä»¶é‡åŠ¨æ€è°ƒæ•´ã€‚</li>
<li>è¿™æ ·æ—¢èƒ½ä¿è¯ç”¨æˆ·çœ‹åˆ°â€œæœ‰äººåœ¨ä¸æ–­ç‚¹èµâ€çš„åŠ¨æ€æ•ˆæœï¼Œåˆèƒ½åœ¨æˆæœ¬ä¸Šå‡å°‘ 99% ä»¥ä¸Šçš„æ¨é€é‡ï¼Œå¤§å¹…é™ä½ç³»ç»Ÿè´Ÿè½½ã€‚</li>
</ul>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ”Œ AI å…¨æ ˆå­¦ä¹ ç¬¬å…«å¤©ï¼šåç«¯æ•°æ®åº“è¿æ¥ Prisma â€”â€” å½“ NestJS é‡ä¸Šâ€œæœ€å¼ºç¿»è¯‘å®˜â€]]></title>    <link>https://juejin.cn/post/7598025242041810996</link>    <guid>https://juejin.cn/post/7598025242041810996</guid>    <pubDate>2026-01-22T16:49:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598025242041810996" data-draft-id="7598025242041712692" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ”Œ AI å…¨æ ˆå­¦ä¹ ç¬¬å…«å¤©ï¼šåç«¯æ•°æ®åº“è¿æ¥ Prisma â€”â€” å½“ NestJS é‡ä¸Šâ€œæœ€å¼ºç¿»è¯‘å®˜â€"/> <meta itemprop="keywords" content="ORM,åç«¯,SQL"/> <meta itemprop="datePublished" content="2026-01-22T16:49:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¥ç§˜çš„çŒªå¤´"/> <meta itemprop="url" content="https://juejin.cn/user/793223472877051"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ”Œ AI å…¨æ ˆå­¦ä¹ ç¬¬å…«å¤©ï¼šåç«¯æ•°æ®åº“è¿æ¥ Prisma â€”â€” å½“ NestJS é‡ä¸Šâ€œæœ€å¼ºç¿»è¯‘å®˜â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/793223472877051/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¥ç§˜çš„çŒªå¤´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-22T16:49:37.000Z" title="Thu Jan 22 2026 16:49:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å“ˆå–½ï¼Œæ˜é‡‘çš„å„ä½å…¨æ ˆç»ƒä¹ ç”Ÿä»¬ï¼ğŸ‘‹ æ¬¢è¿å›åˆ° <strong>AI å…¨æ ˆé¡¹ç›®å®æˆ˜</strong> çš„ç¬¬å…«å¤©ï¼</p>
<p>æ˜¨å¤©ï¼Œæˆ‘ä»¬åœ¨å‰ç«¯çš„ä¸–ç•Œé‡Œâ€œè‡ªå¯¼è‡ªæ¼”â€äº†ä¸€å‡ºå¤§æˆï¼Œç”¨ Mock.js ä¼ªé€ äº†æ•°æ®ï¼Œç”¨ Axios æ‹¦æˆªå™¨å¤„ç†äº†ç™»å½•é‰´æƒã€‚è™½ç„¶é¡µé¢è·‘å¾—æ¬¢ï¼Œä½†ä½œä¸ºä¸€åæœ‰è¿½æ±‚çš„å…¨æ ˆå¼€å‘è€…ï¼Œæˆ‘ä»¬å¿ƒé‡Œæ¸…æ¥šï¼š<strong>æ²¡æœ‰çœŸå®åç«¯çš„åº”ç”¨ï¼Œå°±åƒæ²¡æœ‰çµé­‚çš„èº¯å£³ã€‚</strong></p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬è¦è·¨è¿‡å‰åç«¯çš„åˆ†ç•Œçº¿ï¼Œè¿›å…¥æ·±é‚ƒçš„åç«¯é¢†åŸŸã€‚æˆ‘ä»¬å°†ä½¿ç”¨ <strong>NestJS</strong> è¿™ä¸ªä¼ä¸šçº§æ¡†æ¶ï¼Œæ­é… <strong>Prisma</strong> è¿™ä¸ªç°ä»£åŒ–çš„ ORM ç¥å™¨ï¼Œäº²æ‰‹æ­å»ºä¸€ä¸ªèƒ½è¿æ•°æ®åº“ã€èƒ½æ ¡éªŒå‚æ•°ã€èƒ½è·¨åŸŸé€šä¿¡çš„çœŸå®åç«¯æœåŠ¡ï¼</p>
<p>å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬æŠŠâ€œå‡æˆâ€åšæˆâ€œçœŸåšâ€ï¼ğŸš€</p>
<hr/>
<h2 data-id="heading-0">ğŸ—ï¸ ä¸€ã€ èµ·æ­¥ï¼šNestJS åç«¯é¡¹ç›®æ­å»º</h2>
<p>å…³äº NestJS çš„åŸºç¡€ï¼Œæˆ‘ä»¬åœ¨<a href="https://juejin.cn/post/7595808703074500634" target="_blank" title="https://juejin.cn/post/7595808703074500634">ç¬¬å››å¤©</a>å·²ç»è¯¦ç»†è®²è¿‡ã€‚å®ƒå°±åƒåç«¯çš„â€œç²¾è£…æˆ¿â€ï¼Œæ¨¡å—åŒ–ã€ä¾èµ–æ³¨å…¥è¿™äº›ç‰¹æ€§è®©æˆ‘ä»¬å†™åç«¯ä»£ç åƒæ­ç§¯æœ¨ä¸€æ ·çˆ½ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªæ–°çš„åç«¯é¡¹ç›®æ¥æ‰¿è½½æˆ‘ä»¬çš„åšå®¢æ•°æ®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¦‚æœä½ è¿˜æ²¡å®‰è£… CLI</span>
npm i -g @nestjs/cli

<span class="hljs-comment"># åˆ›å»ºåä¸º posts çš„åç«¯æœåŠ¡</span>
nest new posts
</code></pre>
<p>é¡¹ç›®å»ºå¥½åï¼Œå…ˆåˆ«æ€¥ç€å†™æ¥å£ã€‚å¯¹äºåç«¯æ¥è¯´ï¼Œ<strong>æ•°æ®æ˜¯æ ¸å¿ƒ</strong>ã€‚æˆ‘ä»¬éœ€è¦å…ˆè®¾è®¡å¥½æ•°æ®åº“ï¼ŒæŠŠåœ°åŸºæ‰“ç‰¢ã€‚</p>
<hr/>
<h2 data-id="heading-1">ğŸ¤– äºŒã€ ORM ä¸ Prismaï¼šä¸æ‡‚ SQL ä¹Ÿèƒ½æ“ä½œæ•°æ®åº“ï¼Ÿ</h2>
<h3 data-id="heading-2">2.1 ä»€ä¹ˆæ˜¯ ORMï¼Ÿ</h3>
<p>å¯¹äºå¾ˆå¤šå‰ç«¯å‡ºèº«çš„å…¨æ ˆæ–°æ‰‹æ¥è¯´ï¼ŒSQL è¯­å¥ï¼ˆ<code>SELECT * FROM users WHERE ...</code>ï¼‰ç®€ç›´å°±æ˜¯å¤©ä¹¦ã€‚è¿™æ—¶å€™ï¼Œ<strong>ORM (Object-Relational Mappingï¼Œå¯¹è±¡å…³ç³»æ˜ å°„)</strong> å°±é—ªäº®ç™»åœºäº†ã€‚</p>
<p>ORM å°±åƒæ˜¯ä¸€ä¸ª<strong>ç¿»è¯‘å®˜</strong>ï¼š</p>
<ul>
<li><strong>ä½ å¯¹å®ƒè¯´</strong>ï¼šâ€œå˜¿ï¼Œå¸®æˆ‘æ‰¾ä¸€ä¸‹ ID ä¸º 1 çš„ç”¨æˆ·ã€‚â€ï¼ˆè°ƒç”¨ <code>User.findUnique({ id: 1 })</code>ï¼‰</li>
<li><strong>å®ƒå¯¹æ•°æ®åº“è¯´</strong>ï¼š<code>SELECT * FROM "users" WHERE "id" = 1 LIMIT 1;</code></li>
<li><strong>æ•°æ®åº“è¿”å›</strong>ï¼šä¸€è¡Œè¡Œæ¯ç‡¥çš„æ•°æ®ã€‚</li>
<li><strong>å®ƒè¿”å›ç»™ä½ </strong>ï¼šä¸€ä¸ªæ¼‚äº®çš„ JavaScript å¯¹è±¡ <code>{ id: 1, name: "admin" }</code>ã€‚</li>
</ul>
<p>æœ‰äº† ORMï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨æ“ä½œå¯¹è±¡çš„æ–¹å¼æ¥æ“ä½œæ•°æ®åº“ï¼Œå†ä¹Ÿä¸ç”¨æ‰‹å†™å¤æ‚çš„ SQL æ‹¼å­—ç¬¦ä¸²äº†ï¼</p>
<h3 data-id="heading-3">2.2 ä¸ºä»€ä¹ˆé€‰æ‹© Prismaï¼Ÿ</h3>
<p>åœ¨ Node.js é¢†åŸŸï¼ŒTypeORM å’Œ Sequelize æ›¾ç»æ˜¯ç‹è€…ï¼Œä½†ç°åœ¨ <strong>Prisma</strong> æ‰æ˜¯æ–°å® ã€‚</p>
<ul>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šå®ƒèƒ½æ ¹æ®ä½ çš„æ•°æ®åº“ç»“æ„è‡ªåŠ¨ç”Ÿæˆ TypeScript ç±»å‹å®šä¹‰ã€‚</li>
<li><strong>ç›´è§‚çš„ Schema</strong>ï¼šå®ƒçš„æ•°æ®å»ºæ¨¡è¯­è¨€éå¸¸æ˜“è¯»ï¼Œå°±åƒå†™ä¼ªä»£ç ä¸€æ ·ã€‚</li>
<li><strong>å¼ºå¤§çš„è¿ç§»å·¥å…·</strong>ï¼šæ•°æ®åº“è¡¨ç»“æ„çš„å˜æ›´ç®¡ç†éå¸¸æ–¹ä¾¿ã€‚</li>
</ul>
<h3 data-id="heading-4">2.3 åˆå§‹åŒ– Prisma</h3>
<p>é¦–å…ˆï¼Œåœ¨æˆ‘ä»¬çš„ <code>posts</code> é¡¹ç›®ä¸­å®‰è£… Prismaï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£… Prisma CLI (å¼€å‘ä¾èµ–)</span>
pnpm i -D prisma

<span class="hljs-comment"># å®‰è£… Prisma Client (è¿è¡Œæ—¶ä¾èµ–)</span>
pnpm i @prisma/client

<span class="hljs-comment"># åˆå§‹åŒ– Prisma</span>
npx prisma init
</code></pre>
<p>æ‰§è¡Œå®Œ <code>init</code> åï¼Œä½ ä¼šå‘ç°é¡¹ç›®é‡Œå¤šäº†ä¸€ä¸ª <code>prisma</code> æ–‡ä»¶å¤¹ï¼Œé‡Œé¢æœ‰ä¸ª <code>schema.prisma</code> æ–‡ä»¶ã€‚è¿™å°±æ˜¯æˆ‘ä»¬çš„<strong>æ•°æ®åº“è®¾è®¡å›¾çº¸</strong>ã€‚</p>
<p>åŒæ—¶ï¼Œæ ¹ç›®å½•ä¸‹è¿˜ä¼šç”Ÿæˆä¸€ä¸ª <code>.env</code> æ–‡ä»¶ï¼Œç”¨æ¥å­˜æ”¾æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²ã€‚</p>
<pre><code class="hljs language-env" lang="env"># .env
# æ ¼å¼ï¼špostgresql://ç”¨æˆ·å:å¯†ç @åœ°å€:ç«¯å£/æ•°æ®åº“å?schema=public
DATABASE_URL="postgresql://postgres:123456@localhost:5432/xue?schema=public"
</code></pre>
<blockquote>
<p>âš ï¸ <strong>æ³¨æ„</strong>ï¼šçœŸå®å¼€å‘ä¸­ï¼Œ<code>.env</code> åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼Œç»å¯¹ä¸èƒ½æäº¤åˆ° GitHubï¼</p>
</blockquote>
<hr/>
<h2 data-id="heading-5">ğŸ“ ä¸‰ã€ æ•°æ®åº“å»ºæ¨¡ï¼šSchema çš„è‰ºæœ¯</h2>
<p>æ‰“å¼€ <code>prisma/schema.prisma</code>ï¼Œè¿™é‡Œæ˜¯æˆ‘ä»¬å®šä¹‰æ•°æ®ç»“æ„çš„åœ°æ–¹ã€‚Prisma çš„è¯­æ³•éå¸¸ç›´è§‚ï¼Œæˆ‘ä»¬æ¥å®šä¹‰ä¸€ä¸‹åšå®¢ç³»ç»Ÿçš„æ ¸å¿ƒæ¨¡å‹ï¼šç”¨æˆ·ã€æ–‡ç« ã€è¯„è®ºã€æ ‡ç­¾ç­‰ã€‚</p>
<pre><code class="hljs language-prisma" lang="prisma">// prisma/schema.prisma

// 1. ç”Ÿæˆå™¨é…ç½®ï¼šå‘Šè¯‰ Prisma ç”Ÿæˆ JS å®¢æˆ·ç«¯
generator client {
  provider = "prisma-client-js"
}

// 2. æ•°æ®æºé…ç½®ï¼šè¿æ¥ PostgreSQL
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// 3. æ¨¡å‹å®šä¹‰

// ç”¨æˆ·æ¨¡å‹
model User {
  id         Int         @id @default(autoincrement()) // ä¸»é”®ï¼Œè‡ªå¢
  name       String      @unique @db.VarChar(255)      // å”¯ä¸€ç”¨æˆ·å
  password   String      @db.VarChar(255)              // å¯†ç 
  
  // æ—¶é—´æˆ³ï¼šåˆ›å»ºæ—¶é—´å’Œæ›´æ–°æ—¶é—´
  createdAt  DateTime?   @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt  DateTime?   @default(now()) @map("updated_at") @db.Timestamptz(6)

  // å…³ç³»å­—æ®µï¼šä¸€ä¸ªç”¨æˆ·å¯ä»¥æœ‰å¤šç¯‡æ–‡ç« ã€å¤šæ¡è¯„è®ºç­‰
  posts      Post[]
  comments   Comment[]
  likes      UserLikePost[]
  avatars    Avatar[]
  files      File[]

  // æ˜ å°„åˆ°æ•°æ®åº“ä¸­çš„è¡¨å
  @@map("users")
}

// æ–‡ç« æ¨¡å‹
model Post {
  id         Int         @id @default(autoincrement())
  title      String      @db.VarChar(255)
  content    String?     @db.Text // é•¿æ–‡æœ¬
  
  // å¤–é”®å…³è”ï¼šæ–‡ç« å±äºæŸä¸ªç”¨æˆ·
  userId     Int?        
  user       User?       @relation(fields:[userId], references: [id], onDelete: SetNull)
  
  // å…³ç³»
  comments   Comment[]
  tags       PostTag[]      // å¤šå¯¹å¤šå…³ç³»
  likes      UserLikePost[] // ç‚¹èµ
  files      File[]

  // ç´¢å¼•ï¼šåŠ é€ŸæŸ¥è¯¢
  @@index([userId])
  @@map("posts")
}

// è¯„è®ºæ¨¡å‹ (æ”¯æŒåµŒå¥—è¯„è®º)
model Comment {
  id         Int         @id @default(autoincrement())
  content    String?     @db.Text
  postId     Int
  userId     Int
  parentId   Int? // çˆ¶è¯„è®º ID

  // å…³è”
  post       Post        @relation(fields:[postId], references:[id], onDelete:Cascade)
  user       User        @relation(fields:[userId], references:[id], onDelete:Cascade)
  
  // è‡ªå…³è”ï¼šè¯„è®ºå›å¤è¯„è®º
  parent     Comment?    @relation("CommentToComment", fields:[parentId], references:[id], onDelete: Cascade)   
  replies    Comment[]   @relation("CommentToComment")

  @@index([postId])
  @@index([userId])
  @@map("comments")
}

// æ ‡ç­¾æ¨¡å‹
model Tag {
  id         Int         @id @default(autoincrement())   
  name       String      @unique @db.VarChar(255)
  posts      PostTag[]
  @@map("tags") 
}

// ä¸­é—´è¡¨ï¼šæ–‡ç« ä¸æ ‡ç­¾çš„å¤šå¯¹å¤šå…³ç³»
model PostTag {
  postId     Int
  tagId      Int
  post       Post        @relation(fields:[postId], references:[id], onDelete:Cascade)
  tag        Tag         @relation(fields:[tagId], references:[id], onDelete:Cascade)

  // è”åˆä¸»é”®
  @@id([postId, tagId])
  @@index([tagId])
  @@map("post_tags")
}

// ... å…¶ä»–æ¨¡å‹å¦‚ File, Avatar, UserLikePost çœç•¥ï¼ŒåŸç†ç±»ä¼¼
</code></pre>
<p><strong>ğŸ” å…³é”®ç‚¹è§£æï¼š</strong></p>
<ul>
<li><strong><code>@id @default(autoincrement())</code></strong>ï¼šæ ‡å‡†çš„ ID è‡ªå¢ä¸»é”®é…ç½®ã€‚</li>
<li><strong><code>@map("users")</code></strong>ï¼šPrisma é»˜è®¤æ¨¡å‹åæ˜¯é©¼å³° (User)ï¼Œä½†æ•°æ®åº“è¡¨åä¹ æƒ¯ç”¨å¤æ•°ä¸‹åˆ’çº¿ (users)ã€‚<code>@map</code> å¸®æˆ‘ä»¬åšäº†è¿™å±‚æ˜ å°„ã€‚</li>
<li><strong><code>@relation</code></strong>ï¼šå®šä¹‰è¡¨ä¹‹é—´çš„å…³ç³»ã€‚æ¯”å¦‚ <code>Post</code> ä¸­çš„ <code>user</code> å­—æ®µï¼Œé€šè¿‡ <code>fields: [userId]</code> å…³è”åˆ° <code>User</code> æ¨¡å‹çš„ <code>references: [id]</code>ã€‚
<ul>
<li><code>onDelete: Cascade</code>ï¼šçº§è”åˆ é™¤ã€‚å¦‚æœç”¨æˆ·è¢«åˆ äº†ï¼Œä»–çš„è¯„è®ºä¹Ÿä¸€èµ·åˆ æ‰ï¼Œéå¸¸æ–¹ä¾¿ï¼</li>
</ul>
</li>
<li><strong><code>?</code></strong>ï¼šè¡¨ç¤ºè¯¥å­—æ®µå¯é€‰ï¼ˆnullableï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-6">2.4 è®©è®¾è®¡å˜æˆç°å®ï¼šMigrate</h3>
<p>å†™å¥½äº†å›¾çº¸ï¼Œç°åœ¨è¦è®©å®ƒå˜æˆçœŸå®çš„æ•°æ®åº“è¡¨ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºè¿ç§»å¹¶åº”ç”¨åˆ°æ•°æ®åº“</span>
npx prisma migrate dev --name init_db
</code></pre>
<p>è¿™æ¡å‘½ä»¤ä¼šåšä¸¤ä»¶äº‹ï¼š</p>
<ol>
<li>åœ¨ <code>prisma/migrations</code> ä¸‹ç”Ÿæˆ SQL è¿ç§»æ–‡ä»¶ï¼ˆç•™ä½œæ—¥å¿—å’Œç‰ˆæœ¬æ§åˆ¶ï¼‰ã€‚</li>
<li>åœ¨æ•°æ®åº“é‡ŒçœŸæ­£åˆ›å»ºè¿™äº›è¡¨ã€‚</li>
<li>åé¢çš„init_dbå°±æ˜¯ç»™è¿™æ¬¡åˆ›å»ºè¡¨æ“ä½œçš„è®°å½•</li>
</ol>
<blockquote>
<p>åœ¨migrationsæ–‡ä»¶å¤¹åœ¨é‡Œé¢å­˜å‚¨äº†æ‰€æœ‰ç”Ÿæˆçš„sqlæ•°æ®æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ
æ¥çœ‹çœ‹æ–‡ä»¶å†…å®¹</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/96f7f034b57f45719d715258abec12eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56We56eY55qE54yq5aS0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769705377&amp;x-signature=zF6f8s3fR2Wh7hwf5bkXCG%2F%2BFJY%3D" alt="image.png" loading="lazy"/></p>
<p><strong>Prisma ä¸ä»…è®©åˆå­¦è€…èƒ½å¤Ÿå¿«é€Ÿä¸Šæ‰‹æ•°æ®åº“æ“ä½œï¼Œé¿å…ç›´æ¥ç¼–å†™å¤æ‚çš„åŸç”Ÿ SQLï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œå®ƒé€šè¿‡è‡ªåŠ¨ç”Ÿæˆçš„ Prisma Client å’Œè¿ç§»ï¼ˆMigrationï¼‰æœºåˆ¶ï¼Œä½¿å¾—æ¯ä¸€æ¬¡æ•°æ®åº“å˜æ›´éƒ½æœ‰æ˜ç¡®çš„è®°å½•æ–‡ä»¶ï¼ˆå¦‚ schema.prisma å’Œ migrations ç›®å½•ä¸‹çš„ SQL æ–‡ä»¶ï¼‰ã€‚</strong></p>
<p>åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œè¿™ç§èƒ½åŠ›å°¤ä¸ºé‡è¦ï¼š</p>
<ul>
<li><strong>å¯è¿½æº¯æ€§</strong>ï¼šæ¯æ¬¡æ•°æ®æ¨¡å‹å˜æ›´éƒ½ä¼šç”Ÿæˆå¯¹åº”çš„è¿ç§»æ–‡ä»¶ï¼Œå›¢é˜Ÿæˆå‘˜å¯ä»¥æ¸…æ™°çœ‹åˆ°æ•°æ®åº“ç»“æ„æ˜¯å¦‚ä½•æ¼”è¿›çš„ï¼›</li>
<li><strong>åä½œå‹å¥½</strong>ï¼šä»£ç å®¡æŸ¥ï¼ˆCode Reviewï¼‰æ—¶å¯ä»¥ç›´æ¥æŸ¥çœ‹ schema å’Œ migration æ–‡ä»¶ï¼Œç¡®ä¿æ•°æ®åº“å˜æ›´ç¬¦åˆé¢„æœŸï¼›</li>
<li><strong>ä¾¿äºä¼˜åŒ–ä¸è°ƒè¯•</strong>ï¼šPrisma Client ä¼šå°†æ•°æ®åº“æŸ¥è¯¢è½¬åŒ–ä¸ºç±»å‹å®‰å…¨çš„æ–¹æ³•è°ƒç”¨ï¼Œé…åˆæ—¥å¿—æˆ–è°ƒè¯•å·¥å…·ï¼ˆå¦‚Â <code>prisma. $ queryRaw</code>Â æˆ–Â <code>DEBUG=prisma:*</code>ï¼‰ï¼Œèƒ½æ¸…æ¥šçœ‹åˆ°å®é™…æ‰§è¡Œçš„ SQLï¼Œæ–¹ä¾¿æ€§èƒ½åˆ†æå’Œä¼˜åŒ–ï¼›</li>
<li><strong>ç‰ˆæœ¬æ§åˆ¶å‹å¥½</strong>ï¼šæ‰€æœ‰æ•°æ®åº“ç»“æ„å˜æ›´éƒ½ä»¥æ–‡ä»¶å½¢å¼çº³å…¥ Git ç­‰ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œé¿å…äº†â€œæ•°æ®åº“çŠ¶æ€æ¼‚ç§»â€çš„é—®é¢˜ã€‚</li>
</ul>
<h3 data-id="heading-7">2.5 å¯è§†åŒ–ç¥å™¨ï¼šPrisma Studio</h3>
<p>æƒ³çœ‹çœ‹æ•°æ®è¡¨å»ºå¾—å¯¹ä¸å¯¹ï¼Ÿä¸ç”¨ä¸‹ä¸“é—¨çš„æ•°æ®åº“è½¯ä»¶ï¼ŒPrisma è‡ªå¸¦äº†ä¸€ä¸ªç½‘é¡µç‰ˆç®¡ç†å·¥å…·ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npx prisma studio
</code></pre>
<p>è¿è¡Œåæ‰“å¼€æµè§ˆå™¨ï¼Œä½ å°±å¯ä»¥çœ‹åˆ°ä¸€ä¸ªè¶…çº§å¥½ç”¨çš„æ•°æ®åº“ç®¡ç†ç•Œé¢ï¼Œå¯ä»¥ç›´æ¥å¢åˆ æ”¹æŸ¥æ•°æ®ï¼Œç”¨æ¥é€ æµ‹è¯•æ•°æ®ç®€ç›´ä¸è¦å¤ªçˆ½ï¼ğŸ˜</p>
<h2 data-id="heading-8"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8bbd6556a31b4a84bd19ddc59d266e50~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56We56eY55qE54yq5aS0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769705377&amp;x-signature=zx0OEkTzQQ%2FJwD%2FUUXLY8oU3tIM%3D" alt="image.png" loading="lazy"/></h2>
<h2 data-id="heading-9">ğŸ”— å››ã€ ä¸²è”å‰åç«¯ï¼šNestJS å®æˆ˜é…ç½®</h2>
<p>æ•°æ®åº“å‡†å¤‡å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬è¦é…ç½® NestJS æ¥è¿æ¥å®ƒï¼Œå¹¶å¤„ç†å‰ç«¯çš„è¯·æ±‚ã€‚</p>
<h3 data-id="heading-10">4.1 è§£å†³è·¨åŸŸä¸å…¨å±€é…ç½® (Main.ts)</h3>
<p>å‰åç«¯åˆ†ç¦»å¼€å‘ï¼Œç¬¬ä¸€ä»¶äº‹å°±æ˜¯<strong>è·¨åŸŸ (CORS)</strong>ã€‚
æ‰“å¼€ <code>src/main.ts</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/main.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">NestFactory</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/core'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">AppModule</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.module'</span>;
<span class="hljs-comment">// 1ï¸âƒ£ å¼•å…¥ NestExpressApplication ä»¥ä½¿ç”¨ Express çš„ç‰¹æ€§</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">NestExpressApplication</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/platform-express'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ValidationPipe</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">bootstrap</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// 2ï¸âƒ£ æ³›å‹æŒ‡å®šä¸º NestExpressApplicationï¼Œè¿™æ ·æ‰æœ‰ cors ç­‰æç¤º</span>
  <span class="hljs-keyword">const</span> app = <span class="hljs-keyword">await</span> <span class="hljs-title class_">NestFactory</span>.<span class="hljs-property">create</span>&lt;<span class="hljs-title class_">NestExpressApplication</span>&gt;(<span class="hljs-title class_">AppModule</span>, {
    <span class="hljs-attr">cors</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// âœ… ä¸€é”®å¼€å¯è·¨åŸŸï¼</span>
  });

  <span class="hljs-comment">// 3ï¸âƒ£ è®¾ç½®å…¨å±€è·¯ç”±å‰ç¼€</span>
  <span class="hljs-comment">// è¿™æ ·æ‰€æœ‰çš„æ¥å£éƒ½ä¼šè‡ªåŠ¨åŠ ä¸Š /apiï¼Œæ¯”å¦‚ localhost:3000/api/posts</span>
  app.<span class="hljs-title function_">setGlobalPrefix</span>(<span class="hljs-string">'api'</span>); 

  <span class="hljs-comment">// 4ï¸âƒ£ å¯ç”¨å…¨å±€éªŒè¯ç®¡é“ (DTO çš„å¥½æ­æ¡£)</span>
  app.<span class="hljs-title function_">useGlobalPipes</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ValidationPipe</span>({
    <span class="hljs-attr">whitelist</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// ğŸ›¡ï¸ è‡ªåŠ¨å‰”é™¤ DTO ä¸­æœªå®šä¹‰çš„å±æ€§ï¼Œé˜²æ­¢æ¶æ„æ³¨å…¥</span>
    <span class="hljs-attr">forbidNonWhitelisted</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// é‡åˆ°æœªå®šä¹‰å±æ€§ç›´æ¥æŠ¥é”™</span>
    <span class="hljs-attr">transform</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// âœ¨ è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼ˆæŠŠ query ä¸­çš„å­—ç¬¦ä¸² '1' è½¬ä¸ºæ•°å­— 1ï¼‰</span>
  }))

  <span class="hljs-keyword">await</span> app.<span class="hljs-title function_">listen</span>(process.<span class="hljs-property">env</span>.<span class="hljs-property">PORT</span> ?? <span class="hljs-number">3000</span>);
}
<span class="hljs-title function_">bootstrap</span>();
</code></pre>
<h3 data-id="heading-11">4.2 æ¨¡å—åŒ–æ¶æ„ (AppModule)</h3>
<p>æ‰“å¼€ <code>src/app.module.ts</code>ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°åº”ç”¨çš„æ•´ä½“ç»“æ„ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/app.module.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Module</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">AppController</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.controller'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">AppService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.service'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">PostsModule</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./posts/posts.module'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">PrismaModule</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./prisma/prisma.module'</span>;

<span class="hljs-meta">@Module</span>({
  <span class="hljs-comment">// ğŸ§© å¼•å…¥ä¸¤ä¸ªæ ¸å¿ƒæ¨¡å—ï¼š</span>
  <span class="hljs-comment">// PostsModule: å¤„ç†æ–‡ç« ç›¸å…³çš„ä¸šåŠ¡</span>
  <span class="hljs-comment">// PrismaModule: è´Ÿè´£æ•°æ®åº“è¿æ¥</span>
  <span class="hljs-attr">imports</span>: [<span class="hljs-title class_">PostsModule</span>, <span class="hljs-title class_">PrismaModule</span>],
  <span class="hljs-attr">controllers</span>: [<span class="hljs-title class_">AppController</span>],
  <span class="hljs-attr">providers</span>: [<span class="hljs-title class_">AppService</span>],
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppModule</span> {}
</code></pre>
<hr/>
<h2 data-id="heading-12">ğŸ›¡ï¸ äº”ã€ DTOï¼šå‚æ•°æ ¡éªŒçš„å®ˆé—¨å‘˜</h2>
<p>åœ¨å†™ä¸šåŠ¡é€»è¾‘ä¹‹å‰ï¼Œæˆ‘ä»¬è¦å…ˆè§£å†³ä¸€ä¸ªé—®é¢˜ï¼š<strong>æ€ä¹ˆä¿è¯å‰ç«¯ä¼ æ¥çš„å‚æ•°æ˜¯åˆæ³•çš„ï¼Ÿ</strong>
æ¯”å¦‚åˆ†é¡µå‚æ•° <code>page</code> å¿…é¡»æ˜¯æ•°å­—ä¸”å¤§äº 1ã€‚è¿™æ—¶å€™å°±éœ€è¦ <strong>DTO (Data Transfer Object)</strong> é…åˆ <code>class-validator</code> åº“äº†ã€‚</p>
<h3 data-id="heading-13">5.1 åˆ›å»º Query DTO</h3>
<p>æ–°å»º <code>src/posts/dto/post-query.dto.ts</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/posts/dto/post-query.dto.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">IsOptional</span>, <span class="hljs-title class_">IsInt</span>, <span class="hljs-title class_">Min</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'class-validator'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Type</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'class-transformer'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PostQueryDto</span> {
    <span class="hljs-meta">@IsOptional</span>() <span class="hljs-comment">// å‚æ•°å¯é€‰</span>
    <span class="hljs-meta">@Type</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Number</span>) <span class="hljs-comment">// âœ¨ è½¬æ¢ï¼šå‰ç«¯ä¼ URLå‚æ•°é»˜è®¤æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™é‡Œè½¬æˆæ•°å­—</span>
    <span class="hljs-meta">@IsInt</span>() <span class="hljs-comment">// æ ¡éªŒï¼šå¿…é¡»æ˜¯æ•´æ•°</span>
    <span class="hljs-meta">@Min</span>(<span class="hljs-number">1</span>) <span class="hljs-comment">// æ ¡éªŒï¼šæœ€å°å€¼ä¸º 1</span>
    page?: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>; <span class="hljs-comment">// é»˜è®¤å€¼ 1</span>

    <span class="hljs-meta">@IsOptional</span>()
    <span class="hljs-meta">@Type</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Number</span>)
    <span class="hljs-meta">@IsInt</span>()
    <span class="hljs-meta">@Min</span>(<span class="hljs-number">1</span>)
    limit?: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>; <span class="hljs-comment">// é»˜è®¤å€¼ 10</span>
}
</code></pre>
<p><strong>ğŸ’¡ ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦ï¼Ÿ</strong>
å¦‚æœä¸åŠ è¿™ä¸ªï¼Œä½ éœ€è¦æ‰‹åŠ¨å†™ <code>if (typeof page !== 'number') ...</code>ã€‚ç°åœ¨ï¼Œé…åˆ <code>main.ts</code> é‡Œçš„ <code>ValidationPipe</code>ï¼ŒNestJS ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬å®Œæˆ<strong>ç±»å‹è½¬æ¢</strong>å’Œ<strong>æ•°æ®æ ¡éªŒ</strong>ã€‚å¦‚æœä¸ç¬¦åˆè§„åˆ™ï¼Œç›´æ¥æŠ›å‡º 400 é”™è¯¯ï¼Œé€»è¾‘ä»£ç å®Œå…¨ä¸éœ€è¦æ“å¿ƒè¿™äº›è„æ´»ç´¯æ´»ã€‚</p>
<hr/>
<h2 data-id="heading-14">ğŸ”Œ å…­ã€ æ•°æ®åº“æœåŠ¡ï¼šå°è£… PrismaService</h2>
<p>æˆ‘ä»¬ä¸ç›´æ¥åœ¨æ¯ä¸ª Service é‡Œ <code>new PrismaClient()</code>ï¼Œè€Œæ˜¯æŠŠå®ƒå°è£…æˆä¸€ä¸ªå¯æ³¨å…¥çš„ Serviceã€‚</p>
<h3 data-id="heading-15">6.1 PrismaService</h3>
<p>æ–°å»º <code>src/prisma/prisma.service.ts</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/prisma/prisma.service.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Injectable</span>, <span class="hljs-title class_">OnModuleInit</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">PrismaClient</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@prisma/client'</span>;

<span class="hljs-meta">@Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PrismaService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">PrismaClient</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">OnModuleInit</span> {
    <span class="hljs-comment">// PrismaClient æœ¬èº«å°±æ˜¯è¿æ¥æ± ï¼Œæˆ‘ä»¬ç»§æ‰¿å®ƒ</span>
    
    <span class="hljs-comment">// OnModuleInit æ˜¯ NestJS ç”Ÿå‘½å‘¨æœŸé’©å­</span>
    <span class="hljs-comment">// æ¨¡å—åˆå§‹åŒ–æ—¶ï¼Œè‡ªåŠ¨è¿æ¥æ•°æ®åº“</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">onModuleInit</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.$connect(); 
    }
}
</code></pre>
<h3 data-id="heading-16">6.2 Global Module</h3>
<p>ä¸ºäº†è®©è¿™ä¸ª Service åœ¨å…¨é¡¹ç›®é€šç”¨ï¼Œæˆ‘ä»¬åœ¨ <code>prisma.module.ts</code> é‡ŒæŠŠå®ƒè®¾ä¸ºå…¨å±€æ¨¡å—ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// src/prisma/prisma.module.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Global</span>, <span class="hljs-title class_">Module</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">PrismaService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./prisma.service'</span>;

<span class="hljs-meta">@Global</span>() <span class="hljs-comment">// ğŸŒ æ ‡è®°ä¸ºå…¨å±€æ¨¡å—ï¼Œå…¶ä»–æ¨¡å—ä½¿ç”¨æ—¶ä¸éœ€è¦å† imports: [PrismaModule]</span>
<span class="hljs-meta">@Module</span>({
  <span class="hljs-attr">providers</span>: [<span class="hljs-title class_">PrismaService</span>],
  <span class="hljs-attr">exports</span>: [<span class="hljs-title class_">PrismaService</span>], <span class="hljs-comment">// å¯¼å‡º Service ä¾›å¤–éƒ¨ä½¿ç”¨</span>
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PrismaModule</span> {}
</code></pre>
<hr/>
<h2 data-id="heading-17">ğŸš€ ä¸ƒã€ ä¸šåŠ¡é€»è¾‘ï¼šController ä¸ Service</h2>
<p>æœ€åï¼Œæˆ‘ä»¬æŠŠæ‰€æœ‰ä¸œè¥¿ä¸²èµ·æ¥ï¼Œå®ç°ä¸€ä¸ªç®€å•çš„â€œè·å–æ–‡ç« åˆ—è¡¨â€æ¥å£ã€‚</p>
<h3 data-id="heading-18">7.1 Controller (è·¯ç”±å±‚)</h3>
<p><code>src/posts/posts.controller.ts</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Controller</span>, <span class="hljs-title class_">Get</span>, <span class="hljs-title class_">Query</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">PostsService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./posts.service'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">PostQueryDto</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./dto/post-query.dto'</span>;

<span class="hljs-meta">@Controller</span>(<span class="hljs-string">'posts'</span>) <span class="hljs-comment">// è·¯ç”±å‰ç¼€ï¼š/api/posts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PostsController</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> postsService: PostsService</span>) {}

    <span class="hljs-meta">@Get</span>()
    <span class="hljs-comment">// @Query() è£…é¥°å™¨ä¼šè‡ªåŠ¨æå– URL å‚æ•°</span>
    <span class="hljs-comment">// query: PostQueryDto ä¼šè‡ªåŠ¨è§¦å‘ DTO æ ¡éªŒå’Œè½¬æ¢</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">getPosts</span>(<span class="hljs-params"><span class="hljs-meta">@Query</span>() query: PostQueryDto</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(query); <span class="hljs-comment">// æ‰“å°çœ‹çœ‹ï¼Œæ­¤æ—¶ page å·²ç»æ˜¯ number ç±»å‹äº†</span>
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">postsService</span>.<span class="hljs-title function_">findAll</span>(query);
    }
}
</code></pre>
<h3 data-id="heading-19">7.2 Service (ä¸šåŠ¡å±‚)</h3>
<p><code>src/posts/posts.service.ts</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Injectable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">PostQueryDto</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./dto/post-query.dto'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">PrismaService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../prisma/prisma.service'</span>;

<span class="hljs-meta">@Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PostsService</span> {
    <span class="hljs-comment">// ğŸ’‰ ä¾èµ–æ³¨å…¥ PrismaService</span>
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> prisma: PrismaService</span>) {}

    <span class="hljs-keyword">async</span> <span class="hljs-title function_">findAll</span>(<span class="hljs-params">query: PostQueryDto</span>) {
        <span class="hljs-comment">// ç›´æ¥ä½¿ç”¨ this.prisma æ“ä½œæ•°æ®åº“ï¼Œå°±åƒæ“ä½œå¯¹è±¡ä¸€æ ·ï¼</span>
        <span class="hljs-comment">// è¿™é‡Œæ¼”ç¤ºç®€å•ç»Ÿè®¡æ–‡ç« æ€»æ•°</span>
        <span class="hljs-keyword">const</span> total = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">prisma</span>.<span class="hljs-property">post</span>.<span class="hljs-title function_">count</span>(); 
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Total posts:'</span>, total);
        
        <span class="hljs-comment">// ä¹‹åæˆ‘ä»¬ä¼šåœ¨è¿™é‡Œå®ç°çœŸæ­£çš„åˆ†é¡µæŸ¥è¯¢</span>
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">items</span>: [], <span class="hljs-comment">// æš‚æ—¶ç•™ç©º</span>
            <span class="hljs-attr">total</span>: total
        }
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-20">ğŸ¬ æ€»ç»“</h2>
<p>ä»Šå¤©æˆ‘ä»¬å®Œæˆäº†ä¸€æ¬¡ä» 0 åˆ° 1 çš„åç«¯åŸºå»ºï¼š</p>
<ol>
<li><strong>NestJS é…ç½®</strong>ï¼šè§£å†³äº†è·¨åŸŸï¼Œé…ç½®äº†å…¨å±€å‰ç¼€å’Œç®¡é“ã€‚</li>
<li><strong>Prisma å»ºæ¨¡</strong>ï¼šé€šè¿‡ <code>schema.prisma</code> è®¾è®¡äº†å¤æ‚çš„å…³ç³»å‹æ•°æ®åº“è¡¨ç»“æ„ï¼Œå¹¶ä¸€é”®è¿ç§»ã€‚</li>
<li><strong>DTO è§„èŒƒ</strong>ï¼šåˆ©ç”¨ <code>class-validator</code> å®ç°äº†ä¼˜é›…çš„å‚æ•°æ ¡éªŒã€‚</li>
<li><strong>æœåŠ¡è¿æ¥</strong>ï¼šå°è£…äº† <code>PrismaService</code>ï¼ŒæˆåŠŸæ‰“é€šäº† NestJS åˆ° PostgreSQL çš„â€œä»»ç£äºŒè„‰â€ã€‚</li>
</ol>
<p>ç°åœ¨ï¼Œå½“ä½ è®¿é—® <code>http://localhost:3000/api/posts?page=1&amp;limit=5</code> æ—¶ï¼Œåç«¯å·²ç»èƒ½æ­£ç¡®è§£æå‚æ•°ï¼Œå¹¶å»æ•°æ®åº“é‡Œâ€œæ‰“ä¸ªæ‹›å‘¼â€äº†ã€‚</p>
<p>æ˜å¤©ï¼Œæˆ‘ä»¬å°†åˆ©ç”¨è¿™äº›åŸºç¡€è®¾æ–½ï¼Œå®ç°çœŸæ­£çš„<strong>å¢åˆ æ”¹æŸ¥ (CRUD)</strong>ï¼ŒæŠŠæˆ‘ä»¬çš„åšå®¢æ–‡ç« çœŸæ­£å­˜è¿›æ•°æ®åº“é‡Œï¼</p>
<p>ä¿æŒé¥¥é¥¿ï¼Œä¿æŒæ„šè ¢ï¼Œæˆ‘ä»¬æ˜å¤©è§ï¼ğŸ‘‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[C# å¹¶è¡Œç¼–ç¨‹ï¼šå¦‚ä½•ç”¨ MaxDegreeOfParallelism è®© CPU æ»¡è¡€è¿è½¬ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7598203055747858484</link>    <guid>https://juejin.cn/post/7598203055747858484</guid>    <pubDate>2026-01-23T00:58:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598203055747858484" data-draft-id="7532329707019878451" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="C# å¹¶è¡Œç¼–ç¨‹ï¼šå¦‚ä½•ç”¨ MaxDegreeOfParallelism è®© CPU æ»¡è¡€è¿è½¬ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯,.NET,C#"/> <meta itemprop="datePublished" content="2026-01-23T00:58:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°ç ç¼–åŒ "/> <meta itemprop="url" content="https://juejin.cn/user/1308876155395739"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            C# å¹¶è¡Œç¼–ç¨‹ï¼šå¦‚ä½•ç”¨ MaxDegreeOfParallelism è®© CPU æ»¡è¡€è¿è½¬ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1308876155395739/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°ç ç¼–åŒ 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T00:58:09.000Z" title="Fri Jan 23 2026 00:58:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨æ—¥å¸¸å¼€å‘å·¥ä½œä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸ä¼šé¢ä¸´æ€§èƒ½ä¼˜åŒ–çš„æŒ‘æˆ˜ã€‚æƒ³è±¡è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šè€æ¿å¯¹æ•°æ®å¤„ç†ç¨‹åºçš„æ€§èƒ½æå‡ºè´¨ç–‘ï¼ŒæŒ‡å‡ºæœåŠ¡å™¨æ‹¥æœ‰16æ ¸å¤„ç†å™¨ï¼Œä½†ç¨‹åºè¿è¡Œé€Ÿåº¦å´è¿œæœªè¾¾åˆ°é¢„æœŸï¼Œä¸”CPUä½¿ç”¨ç‡ä»…å¾˜å¾Šåœ¨30%å·¦å³ã€‚</p>
<p>å½“ä½ è§£é‡Šå·²ç»ä½¿ç”¨äº†å¹¶è¡Œå¤„ç†æ—¶ï¼Œè€æ¿è¿›ä¸€æ­¥è¿½é—®ä¸ºä½•CPUæœªèƒ½å……åˆ†åˆ©ç”¨ã€‚æ­¤æ—¶ï¼Œä½ å¯èƒ½ä¸€æ—¶éš¾ä»¥ç»™å‡ºä»¤äººä¿¡æœçš„è§£ç­”ã€‚è¿™ç§å°´å°¬çš„åœºæ™¯åœ¨å¼€å‘å®è·µä¸­å¹¶ä¸å°‘è§ï¼Œå…¶èƒŒåå¾€å¾€éšè—ç€ä¸€ä¸ªå…³é”®é—®é¢˜â€”â€”å¼€å‘åœ¨C#å¹¶è¡Œç¼–ç¨‹ä¸­æœªèƒ½åˆç†æ§åˆ¶å¹¶è¡Œåº¦ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ä¸€ä¸ªè‡³å…³é‡è¦çš„å‚æ•°â€”â€”<code>MaxDegreeOfParallelism</code>ï¼Œé€šè¿‡è§£æå…¶åŸç†å’Œæœ€ä½³å®è·µï¼Œå¸®åŠ©å¼€å‘ä¼˜åŒ–ç¨‹åºæ€§èƒ½ï¼ŒçœŸæ­£è®©CPUèµ„æºå¾—åˆ°é«˜æ•ˆåˆ©ç”¨ï¼Œå®ç°"ç‰©å°½å…¶ç”¨"ã€‚</p>
<h3 data-id="heading-1">æ­£æ–‡</h3>
<h4 data-id="heading-2">ä»€ä¹ˆæ˜¯MaxDegreeOfParallelismï¼Ÿ</h4>
<p>ç®€å•æ¥è¯´ï¼Œ<code>MaxDegreeOfParallelism</code>å°±æ˜¯ä½ ç¨‹åºçš„"å·¥äººæ•°é‡æ§åˆ¶å™¨"ã€‚æƒ³è±¡ä¸€ä¸‹å·¥å‚æµæ°´çº¿ï¼š</p>
<ul>
<li>
<p><strong>ä¸è®¾é™åˆ¶</strong>ï¼š100ä¸ªå·¥äººæŒ¤åœ¨ä¸€æ¡æµæ°´çº¿ä¸Šï¼Œäº’ç›¸ç¢°æ’ï¼Œæ•ˆç‡åè€Œé™ä½</p>
</li>
<li>
<p><strong>åˆç†é™åˆ¶</strong>ï¼šå®‰æ’æœ€åˆé€‚æ•°é‡çš„å·¥äººï¼Œå„å¸å…¶èŒï¼Œæ•ˆç‡æœ€é«˜</p>
</li>
</ul>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-comment">// è¿™æ˜¯æ§åˆ¶"å·¥äººæ•°é‡"çš„å…³é”®ä»£ç </span>
<span class="hljs-keyword">var</span> parallelOptions = <span class="hljs-keyword">new</span> ParallelOptions 
{   
    MaxDegreeOfParallelism = <span class="hljs-number">4</span>  <span class="hljs-comment">// æœ€å¤š4ä¸ª"å·¥äºº"åŒæ—¶å¹²æ´»</span>
};
</code></pre>
<p><code>MaxDegreeOfParallelism</code>æ˜¯<code>ParallelOptions</code>ç±»çš„ä¸€ä¸ªå±æ€§ï¼Œç”¨äºæŒ‡å®š<code>Parallel.For</code>ã€<code>Parallel.ForEach</code>å’Œ<code>Parallel.Invoke</code>ç­‰æ–¹æ³•åœ¨å¹¶è¡Œæ‰§è¡Œæ—¶å…è®¸çš„æœ€å¤§å¹¶å‘ä»»åŠ¡æ•°ã€‚é€šè¿‡è®¾ç½®è¿™ä¸ªå€¼ï¼Œå¼€å‘è€…å¯ä»¥ç²¾ç»†åœ°æ§åˆ¶å¹¶è¡Œä»»åŠ¡çš„å¹¶å‘ç¨‹åº¦ï¼Œé¿å…å› çº¿ç¨‹è¿‡å¤šå¯¼è‡´çš„èµ„æºç«äº‰å’Œæ€§èƒ½ä¸‹é™ã€‚</p>
<h3 data-id="heading-3">å¸¸è§çš„æ€§èƒ½æ€æ‰‹</h3>
<h4 data-id="heading-4">é—®é¢˜1ï¼šæ— é™åˆ¶å¹¶è¡Œå¯¼è‡´çš„èµ„æºç«äº‰</h4>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-comment">// âš ï¸ å±é™©å†™æ³•ï¼šå¯èƒ½åˆ›å»ºè¿‡å¤šçº¿ç¨‹</span>
Parallel.For(<span class="hljs-number">0</span>, <span class="hljs-number">1000</span>, i =&gt; 
{ 
    <span class="hljs-comment">// å¤„ç†æ•°æ® </span>
    ProcessData(i);
});
</code></pre>
<p><strong>ç»“æœ</strong>ï¼šç³»ç»Ÿå¯èƒ½åˆ›å»ºæ•°ç™¾ä¸ªçº¿ç¨‹ï¼Œå¯¼è‡´ï¼š</p>
<ul>
<li>
<p>é¢‘ç¹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢</p>
</li>
<li>
<p>å†…å­˜å ç”¨é£™å‡</p>
</li>
<li>
<p>CPUèµ„æºæµªè´¹</p>
</li>
</ul>
<p>å½“ä¸è®¾ç½®<code>MaxDegreeOfParallelism</code>æ—¶ï¼Œ.NETè¿è¡Œæ—¶ä¼šæ ¹æ®ç³»ç»Ÿè´Ÿè½½è‡ªåŠ¨å†³å®šçº¿ç¨‹æ•°ï¼Œè¿™å¯èƒ½å¯¼è‡´åˆ›å»ºè¿œè¶…CPUæ ¸å¿ƒæ•°çš„çº¿ç¨‹ï¼Œä»è€Œå¼•å‘ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ã€‚</p>
<h4 data-id="heading-5">é—®é¢˜2ï¼šçº¿ç¨‹æ•°è®¾ç½®ä¸å½“</h4>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šCPUå¯†é›†å‹ä»»åŠ¡è®¾ç½®è¿‡å¤šçº¿ç¨‹</span>
<span class="hljs-keyword">var</span> options = <span class="hljs-keyword">new</span> ParallelOptions 
{   
    MaxDegreeOfParallelism = Environment.ProcessorCount * <span class="hljs-number">4</span>  <span class="hljs-comment">// è¿‡å¤šï¼</span>
};
</code></pre>
<p>ä¸ºCPUå¯†é›†å‹ä»»åŠ¡è®¾ç½®è¿‡å¤šçº¿ç¨‹ï¼Œä¸ä»…ä¸ä¼šæå‡æ€§èƒ½ï¼Œåè€Œä¼šå› ä¸ºè¿‡å¤šçš„çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢è€Œé™ä½æ•´ä½“æ•ˆç‡ã€‚</p>
<h3 data-id="heading-6">å®æˆ˜è§£å†³æ–¹æ¡ˆ</h3>
<h4 data-id="heading-7">æ–¹æ¡ˆä¸€ï¼šCPUå¯†é›†å‹ä»»åŠ¡ä¼˜åŒ–</h4>
<pre><code class="hljs language-ini" lang="ini">using System.Diagnostics<span class="hljs-comment">;</span>
using System.Text<span class="hljs-comment">;</span>

namespace AppMaxDegreeOfParallelism
{ 
    internal class Program 
    { 
        static void Main() 
        { 
            <span class="hljs-attr">Console.OutputEncoding</span> = Encoding.UTF8<span class="hljs-comment">;</span>
            Console.WriteLine("CPUæ ¸å¿ƒæ•°: " + Environment.ProcessorCount)<span class="hljs-comment">;</span>
            var <span class="hljs-attr">data</span> = Enumerable.Range(<span class="hljs-number">1</span>, <span class="hljs-number">10000</span>).ToArray()<span class="hljs-comment">;</span>
            
            // ğŸ”¥ å…³é”®ï¼šCPUå¯†é›†å‹ä»»åŠ¡ï¼Œçº¿ç¨‹æ•° = CPUæ ¸å¿ƒæ•°
            var <span class="hljs-attr">parallelOptions</span> = new ParallelOptions
            { 
                <span class="hljs-attr">MaxDegreeOfParallelism</span> = Environment.ProcessorCount
            }<span class="hljs-comment">;</span>
            
            var <span class="hljs-attr">stopwatch</span> = Stopwatch.StartNew()<span class="hljs-comment">;</span>
            Parallel.ForEach(data, parallelOptions, <span class="hljs-attr">number</span> =&gt; 
            { 
                // æ¨¡æ‹ŸCPUå¯†é›†å‹è®¡ç®—ï¼ˆå¦‚æ•°å­¦è¿ç®—ã€å›¾åƒå¤„ç†ç­‰ï¼‰
                var <span class="hljs-attr">result</span> = CalculatePrimeFactors(number)<span class="hljs-comment">;</span>
                // è¾“å‡ºå½“å‰çº¿ç¨‹ä¿¡æ¯ï¼ˆä¾¿äºè§‚å¯Ÿï¼‰
                Console.WriteLine($"å¤„ç†æ•°æ® {number}ï¼Œçº¿ç¨‹ID: {Thread.CurrentThread.ManagedThreadId}ï¼Œç»“æœ: {result}")<span class="hljs-comment">;</span>
            })<span class="hljs-comment">;</span>
            stopwatch.Stop()<span class="hljs-comment">;</span>
            Console.WriteLine($"æ€»è€—æ—¶: {stopwatch.ElapsedMilliseconds}ms")<span class="hljs-comment">;</span>
        }
        
        // æ¨¡æ‹ŸCPUå¯†é›†å‹æ“ä½œ
        static int CalculatePrimeFactors(int number) 
        { 
            int <span class="hljs-attr">count</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
            for (int <span class="hljs-attr">i</span> = <span class="hljs-number">2</span><span class="hljs-comment">; i &lt;= number; i++) </span>
            { 
                while (number % <span class="hljs-attr">i</span> == <span class="hljs-number">0</span>) 
                { 
                    count++<span class="hljs-comment">;</span>
                    number /= i<span class="hljs-comment">;</span>
                }
            }
            return count<span class="hljs-comment">;</span>
        }
    }
}
</code></pre>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmmbiz.qpic.cn%2Fmmbiz_png%2FD1DJjmDXQdlzQX9I4LiajyicYk0xJJyOvacb48eEpSFedfFGd7MTC4Yiasple1Z9iaSibx07uhibTxWGnBd3SMZy5HNg%2F640%3Fwx_fmt%3Dpng%26from%3Dappmsg" target="_blank" title="https://mmbiz.qpic.cn/mmbiz_png/D1DJjmDXQdlzQX9I4LiajyicYk0xJJyOvacb48eEpSFedfFGd7MTC4Yiasple1Z9iaSibx07uhibTxWGnBd3SMZy5HNg/640?wx_fmt=png&amp;from=appmsg" ref="nofollow noopener noreferrer"/></p>
<p><strong>å…³é”®è¦ç‚¹</strong></p>
<ul>
<li>
<p>CPUå¯†é›†å‹ä»»åŠ¡ï¼š<code>MaxDegreeOfParallelism = Environment.ProcessorCount</code></p>
</li>
<li>
<p>é¿å…çº¿ç¨‹æ•°è¶…è¿‡CPUæ ¸å¿ƒæ•°ï¼Œå‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢</p>
</li>
</ul>
<h4 data-id="heading-8">æ–¹æ¡ˆäºŒï¼šI/Oå¯†é›†å‹ä»»åŠ¡ä¼˜åŒ–</h4>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections.Generic;
<span class="hljs-keyword">using</span> System.Net.Http;
<span class="hljs-keyword">using</span> System.Threading.Tasks;
<span class="hljs-keyword">using</span> System.Diagnostics;

<span class="hljs-keyword">class</span> <span class="hljs-title">IoIntensiveExample</span>
{ 
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">Main</span>()</span>
    { 
        <span class="hljs-keyword">var</span> urls = <span class="hljs-keyword">new</span> List&lt;<span class="hljs-built_in">string</span>&gt;
        { 
            <span class="hljs-string">"https://api.github.com/users/octocat"</span>,
            <span class="hljs-string">"https://jsonplaceholder.typicode.com/posts/1"</span>,
            <span class="hljs-string">"https://httpbin.org/delay/1"</span>,
            <span class="hljs-string">"https://api.github.com/users/torvalds"</span>,
            <span class="hljs-string">"https://jsonplaceholder.typicode.com/posts/2"</span>
        };
        
        <span class="hljs-comment">// ğŸ”¥ å…³é”®ï¼šI/Oå¯†é›†å‹ä»»åŠ¡ï¼Œå¯ä»¥è®¾ç½®æ›´å¤šçº¿ç¨‹</span>
        <span class="hljs-keyword">var</span> parallelOptions = <span class="hljs-keyword">new</span> ParallelOptions
        { 
            MaxDegreeOfParallelism = Environment.ProcessorCount * <span class="hljs-number">2</span> <span class="hljs-comment">// I/Oç­‰å¾…æ—¶é—´å¤šï¼Œå¯ä»¥é€‚å½“å¢åŠ </span>
        };
        
        <span class="hljs-keyword">var</span> stopwatch = Stopwatch.StartNew();
        <span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> httpClient = <span class="hljs-keyword">new</span> HttpClient();
        httpClient.Timeout = TimeSpan.FromSeconds(<span class="hljs-number">10</span>);
        
        Parallel.ForEach(urls, parallelOptions, url =&gt; 
        { 
            <span class="hljs-keyword">try</span> 
            { 
                Console.WriteLine(<span class="hljs-string">$"å¼€å§‹è¯·æ±‚ <span class="hljs-subst">{url}</span>ï¼Œçº¿ç¨‹ID: <span class="hljs-subst">{Thread.CurrentThread.ManagedThreadId}</span>"</span>);
                <span class="hljs-comment">// æ³¨æ„ï¼šåœ¨Parallel.ForEachä¸­ä½¿ç”¨åŒæ­¥æ–¹å¼è°ƒç”¨å¼‚æ­¥æ–¹æ³•</span>
                <span class="hljs-keyword">var</span> response = httpClient.GetAsync(url).GetAwaiter().GetResult();
                <span class="hljs-keyword">var</span> content = response.Content.ReadAsStringAsync().GetAwaiter().GetResult();
                Console.WriteLine(<span class="hljs-string">$"å®Œæˆè¯·æ±‚ <span class="hljs-subst">{url}</span>ï¼Œå“åº”é•¿åº¦: <span class="hljs-subst">{content.Length}</span>"</span>);
            } 
            <span class="hljs-keyword">catch</span> (Exception ex) 
            { 
                Console.WriteLine(<span class="hljs-string">$"è¯·æ±‚å¤±è´¥ <span class="hljs-subst">{url}</span>: <span class="hljs-subst">{ex.Message}</span>"</span>);
            }
        });
        stopwatch.Stop();
        Console.WriteLine(<span class="hljs-string">$"æ€»è€—æ—¶: <span class="hljs-subst">{stopwatch.ElapsedMilliseconds}</span>ms"</span>);
    }
}
</code></pre>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmmbiz.qpic.cn%2Fmmbiz_png%2FD1DJjmDXQdlzQX9I4LiajyicYk0xJJyOvajyDHSbzcxj9qib51duEQ8LCjzBnszNBXNmib6p6S91eP4YSBzribib0ibYA%2F640%3Fwx_fmt%3Dpng%26from%3Dappmsg" target="_blank" title="https://mmbiz.qpic.cn/mmbiz_png/D1DJjmDXQdlzQX9I4LiajyicYk0xJJyOvajyDHSbzcxj9qib51duEQ8LCjzBnszNBXNmib6p6S91eP4YSBzribib0ibYA/640?wx_fmt=png&amp;from=appmsg" ref="nofollow noopener noreferrer"/></p>
<p><strong>å…³é”®è¦ç‚¹</strong></p>
<ul>
<li>
<p>I/Oå¯†é›†å‹ä»»åŠ¡ï¼š<code>MaxDegreeOfParallelism = Environment.ProcessorCount * 2</code></p>
</li>
<li>
<p>çº¿ç¨‹åœ¨ç­‰å¾…I/Oæ—¶ä¸å ç”¨CPUï¼Œå¯ä»¥é€‚å½“å¢åŠ çº¿ç¨‹æ•°</p>
</li>
</ul>
<h4 data-id="heading-9">æ–¹æ¡ˆä¸‰ï¼šåŠ¨æ€è°ƒæ•´å¹¶è¡Œåº¦</h4>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Threading;
<span class="hljs-keyword">using</span> System.Threading.Tasks;
<span class="hljs-keyword">using</span> System.Diagnostics;

<span class="hljs-keyword">class</span> <span class="hljs-title">DynamicParallelismExample</span>
{ 
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>()</span>
    { 
        <span class="hljs-keyword">var</span> data = Enumerable.Range(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>).ToArray();
        
        <span class="hljs-comment">// ğŸ”¥ æ ¹æ®ç³»ç»Ÿè´Ÿè½½åŠ¨æ€è°ƒæ•´</span>
        <span class="hljs-built_in">int</span> optimalParallelism = GetOptimalParallelism();
        <span class="hljs-keyword">var</span> parallelOptions = <span class="hljs-keyword">new</span> ParallelOptions
        { 
            MaxDegreeOfParallelism = optimalParallelism
        };
        
        Console.WriteLine(<span class="hljs-string">$"ä½¿ç”¨å¹¶è¡Œåº¦: <span class="hljs-subst">{optimalParallelism}</span>"</span>);
        Parallel.ForEach(data, parallelOptions, item =&gt; 
        { 
            <span class="hljs-comment">// æ¨¡æ‹Ÿæ··åˆå‹ä»»åŠ¡ï¼ˆæ—¢æœ‰è®¡ç®—åˆæœ‰I/Oï¼‰</span>
            ProcessMixedTask(item);
        });
    }
    
    <span class="hljs-comment">// ğŸ¯ æ™ºèƒ½è®¡ç®—æœ€ä¼˜å¹¶è¡Œåº¦</span>
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-built_in">int</span> <span class="hljs-title">GetOptimalParallelism</span>()</span>
    { 
        <span class="hljs-keyword">using</span> <span class="hljs-keyword">var</span> process = Process.GetCurrentProcess();
        <span class="hljs-comment">// è·å–ç³»ç»Ÿä¿¡æ¯</span>
        <span class="hljs-built_in">int</span> coreCount = Environment.ProcessorCount;
        <span class="hljs-built_in">long</span> availableMemory = GC.GetTotalMemory(<span class="hljs-literal">false</span>);
        
        <span class="hljs-comment">// ç®€å•çš„åŠ¨æ€è°ƒæ•´ç­–ç•¥</span>
        <span class="hljs-keyword">if</span> (availableMemory &lt; <span class="hljs-number">100</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>) <span class="hljs-comment">// å†…å­˜ä¸è¶³100MB</span>
        { 
            <span class="hljs-keyword">return</span> Math.Max(<span class="hljs-number">1</span>, coreCount / <span class="hljs-number">2</span>);  <span class="hljs-comment">// å‡å°‘å¹¶è¡Œåº¦</span>
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (availableMemory &gt; <span class="hljs-number">500</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>) <span class="hljs-comment">// å†…å­˜å……è¶³</span>
        { 
            <span class="hljs-keyword">return</span> coreCount * <span class="hljs-number">2</span>;  <span class="hljs-comment">// å¯ä»¥å¢åŠ å¹¶è¡Œåº¦</span>
        }
        <span class="hljs-keyword">return</span> coreCount;  <span class="hljs-comment">// é»˜è®¤ç­‰äºæ ¸å¿ƒæ•°</span>
    }
    
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ProcessMixedTask</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> item</span>)</span>
    { 
        <span class="hljs-comment">// æ¨¡æ‹ŸCPUè®¡ç®—</span>
        <span class="hljs-built_in">double</span> result = Math.Sqrt(item * <span class="hljs-number">1000</span>);
        <span class="hljs-comment">// æ¨¡æ‹ŸI/Oç­‰å¾…</span>
        Thread.Sleep(<span class="hljs-number">100</span>);
        Console.WriteLine(<span class="hljs-string">$"å¤„ç†é¡¹ç›® <span class="hljs-subst">{item}</span>ï¼Œç»“æœ: <span class="hljs-subst">{result:F2}</span>ï¼Œçº¿ç¨‹: <span class="hljs-subst">{Thread.CurrentThread.ManagedThreadId}</span>"</span>);
    }
}
</code></pre>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmmbiz.qpic.cn%2Fmmbiz_png%2FD1DJjmDXQdlzQX9I4LiajyicYk0xJJyOvaF1XZiapGDFmAJqT0GrW4suLqGJMWMDrAcYK317KWNDbgFlI4MBVX2lA%2F640%3Fwx_fmt%3Dpng%26from%3Dappmsg" target="_blank" title="https://mmbiz.qpic.cn/mmbiz_png/D1DJjmDXQdlzQX9I4LiajyicYk0xJJyOvaF1XZiapGDFmAJqT0GrW4suLqGJMWMDrAcYK317KWNDbgFlI4MBVX2lA/640?wx_fmt=png&amp;from=appmsg" ref="nofollow noopener noreferrer"/></p>
<h3 data-id="heading-10">å¸¸è§é™·é˜±ä¸è§£å†³æ–¹æ¡ˆ</h3>
<h4 data-id="heading-11">é™·é˜±1ï¼šå°ä»»åŠ¡è¿‡åº¦å¹¶è¡ŒåŒ–</h4>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šä»»åŠ¡å¤ªå°ï¼Œå¹¶è¡Œå¼€é”€å¤§äºæ”¶ç›Š</span>
Parallel.For(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, i =&gt; Console.WriteLine(i));

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šä»»åŠ¡è¾ƒå¤§æ—¶æ‰ä½¿ç”¨å¹¶è¡Œ</span>
<span class="hljs-keyword">if</span> (dataSize &gt; <span class="hljs-number">1000</span>)  <span class="hljs-comment">// åªæœ‰æ•°æ®é‡å¤§æ—¶æ‰å¹¶è¡Œ</span>
{
    Parallel.For(<span class="hljs-number">0</span>, dataSize, parallelOptions, ProcessLargeTask);
}
<span class="hljs-keyword">else</span>
{
    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; dataSize; i++)
    {
        ProcessLargeTask(i);  <span class="hljs-comment">// å°æ•°æ®é‡ç›´æ¥ä¸²è¡Œå¤„ç†</span>
    }
}
</code></pre>
<p>å¯¹äºå°ä»»åŠ¡ï¼Œåˆ›å»ºå’Œç®¡ç†å¹¶è¡Œä»»åŠ¡çš„å¼€é”€å¯èƒ½è¿œè¶…ä»»åŠ¡æœ¬èº«æ‰§è¡Œæ—¶é—´ï¼Œå¯¼è‡´æ€§èƒ½åè€Œä¸‹é™ã€‚</p>
<h4 data-id="heading-12">é™·é˜±2ï¼šå¿˜è®°å¼‚å¸¸å¤„ç†</h4>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-comment">// âœ… å®Œæ•´çš„å¼‚å¸¸å¤„ç†ç¤ºä¾‹</span>
<span class="hljs-keyword">var</span> parallelOptions = <span class="hljs-keyword">new</span> ParallelOptions
{
    MaxDegreeOfParallelism = Environment.ProcessorCount
};

<span class="hljs-keyword">try</span>
{
    Parallel.ForEach(data, parallelOptions, item =&gt;
    {
        <span class="hljs-keyword">try</span>
        {
            ProcessItem(item);
        }
        <span class="hljs-keyword">catch</span> (Exception ex)
        {
            <span class="hljs-comment">// è®°å½•å•ä¸ªä»»åŠ¡çš„å¼‚å¸¸ï¼Œä½†ä¸å½±å“å…¶ä»–ä»»åŠ¡</span>
            Console.WriteLine(<span class="hljs-string">$"å¤„ç†é¡¹ç›® <span class="hljs-subst">{item}</span> æ—¶å‡ºé”™: <span class="hljs-subst">{ex.Message}</span>"</span>);
        }
    });
}
<span class="hljs-keyword">catch</span> (AggregateException ae)
{
    <span class="hljs-comment">// å¤„ç†å¹¶è¡Œæ“ä½œä¸­çš„èšåˆå¼‚å¸¸</span>
    <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> ex <span class="hljs-keyword">in</span> ae.InnerExceptions)
    {
        Console.WriteLine(<span class="hljs-string">$"å¹¶è¡Œæ“ä½œå¼‚å¸¸: <span class="hljs-subst">{ex.Message}</span>"</span>);
    }
}
</code></pre>
<p>å¹¶è¡Œæ“ä½œä¸­å¯èƒ½å‡ºç°å¤šä¸ªå¼‚å¸¸ï¼Œéœ€ä½¿ç”¨<code>AggregateException</code>æ¥æ•è·å’Œå¤„ç†ã€‚</p>
<h3 data-id="heading-13">æ€§èƒ½å¯¹æ¯”æµ‹è¯•</h3>
<p>è®©æˆ‘ä»¬ç”¨æ•°æ®è¯´è¯ï¼š</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-keyword">using</span> System.Diagnostics;
<span class="hljs-keyword">using</span> System.Text;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">AppMaxDegreeOfParallelism</span>
{ 
    <span class="hljs-keyword">internal</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span> 
    { 
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span>
        { 
            PerformanceComparison();
        }
        
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">PerformanceComparison</span>()</span>
        { 
            <span class="hljs-keyword">var</span> data = Enumerable.Range(<span class="hljs-number">1</span>, <span class="hljs-number">1000000</span>).ToArray(); <span class="hljs-comment">//è¦è¶³å¤Ÿå¤§æ‰æœ‰æ„ä¹‰</span>
            <span class="hljs-keyword">var</span> stopwatch = <span class="hljs-keyword">new</span> Stopwatch();
            
            <span class="hljs-comment">// æµ‹è¯•1ï¼šä¸²è¡Œå¤„ç†</span>
            stopwatch.Start();
            <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> item <span class="hljs-keyword">in</span> data)
            {
                ProcessItem(item);
            }
            stopwatch.Stop();
            Console.WriteLine(<span class="hljs-string">$"ä¸²è¡Œå¤„ç†è€—æ—¶: <span class="hljs-subst">{stopwatch.ElapsedMilliseconds}</span>ms"</span>);
            
            <span class="hljs-comment">// æµ‹è¯•2ï¼šæ— é™åˆ¶å¹¶è¡Œ</span>
            stopwatch.Restart();
            Parallel.ForEach(data, ProcessItem);
            stopwatch.Stop();
            Console.WriteLine(<span class="hljs-string">$"æ— é™åˆ¶å¹¶è¡Œè€—æ—¶: <span class="hljs-subst">{stopwatch.ElapsedMilliseconds}</span>ms"</span>);
            
            <span class="hljs-comment">// æµ‹è¯•3ï¼šä¼˜åŒ–å¹¶è¡Œåº¦</span>
            <span class="hljs-keyword">var</span> options = <span class="hljs-keyword">new</span> ParallelOptions
            { 
                MaxDegreeOfParallelism = Environment.ProcessorCount
            };
            stopwatch.Restart();
            Parallel.ForEach(data, options, ProcessItem);
            stopwatch.Stop();
            Console.WriteLine(<span class="hljs-string">$"ä¼˜åŒ–å¹¶è¡Œè€—æ—¶: <span class="hljs-subst">{stopwatch.ElapsedMilliseconds}</span>ms"</span>);
        }
        
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ProcessItem</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> item</span>)</span>
        { 
            <span class="hljs-comment">// æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span>
            <span class="hljs-built_in">double</span> x = Math.Sqrt(item);
            <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++)
            {
                x = Math.Sqrt(x + i);
            }
        }
    }
}
</code></pre>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmmbiz.qpic.cn%2Fmmbiz_png%2FD1DJjmDXQdlzQX9I4LiajyicYk0xJJyOvaOZo3gX8OvxclyPFXQO9L0uDTs4rE5m3DibNxcuRRrqUrkfy9PdOxibQw%2F640%3Fwx_fmt%3Dpng%26from%3Dappmsg" target="_blank" title="https://mmbiz.qpic.cn/mmbiz_png/D1DJjmDXQdlzQX9I4LiajyicYk0xJJyOvaOZo3gX8OvxclyPFXQO9L0uDTs4rE5m3DibNxcuRRrqUrkfy9PdOxibQw/640?wx_fmt=png&amp;from=appmsg" ref="nofollow noopener noreferrer"/></p>
<h3 data-id="heading-14">å®é™…åº”ç”¨åœºæ™¯æ¨è</h3>



































<table><thead><tr><th>åœºæ™¯ç±»å‹</th><th>æ¨èè®¾ç½®</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>çº¯CPUè®¡ç®—</strong></td><td><code>Environment.ProcessorCount</code></td><td>é¿å…ä¸Šä¸‹æ–‡åˆ‡æ¢</td></tr><tr><td><strong>æ–‡ä»¶I/Oæ“ä½œ</strong></td><td><code>Environment.ProcessorCount * 2</code></td><td>I/Oç­‰å¾…æ—¶å¯åˆ‡æ¢</td></tr><tr><td><strong>ç½‘ç»œè¯·æ±‚</strong></td><td><code>Environment.ProcessorCount * 4</code></td><td>ç½‘ç»œå»¶è¿Ÿé«˜ï¼Œå¯æ›´å¤šçº¿ç¨‹</td></tr><tr><td><strong>æ•°æ®åº“æ“ä½œ</strong></td><td><code>è¿æ¥æ± å¤§å° / 2</code></td><td>å—æ•°æ®åº“è¿æ¥é™åˆ¶</td></tr><tr><td><strong>æ··åˆå‹ä»»åŠ¡</strong></td><td><code>åŠ¨æ€è°ƒæ•´</code></td><td>æ ¹æ®å®é™…æµ‹è¯•ä¼˜åŒ–</td></tr></tbody></table>
<h3 data-id="heading-15">æ€»ç»“</h3>
<p>æŒæ¡<code>MaxDegreeOfParallelism</code>çš„æ ¸å¿ƒè¦ç‚¹ï¼š</p>
<p>1ã€å› ä»»åŠ¡åˆ¶å®œï¼šCPUå¯†é›†å‹ä»»åŠ¡ä½¿ç”¨<code>Environment.ProcessorCount</code>ï¼ŒI/Oå¯†é›†å‹ä»»åŠ¡å¯é€‚å½“å¢åŠ ã€‚</p>
<p>2ã€æ€§èƒ½ç›‘æ§ï¼šé€šè¿‡å®é™…æµ‹è¯•æ‰¾åˆ°æœ€ä¼˜å€¼ï¼Œä¸åŒç¯å¢ƒå’Œæ•°æ®é‡å¯èƒ½éœ€è¦ä¸åŒçš„é…ç½®ã€‚</p>
<p>3ã€é¿å…è¿‡åº¦ï¼šå°ä»»åŠ¡ä¸è¦å¼ºè¡Œå¹¶è¡ŒåŒ–ï¼Œé¿å…å› å¹¶è¡Œå¼€é”€å¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚</p>
<p>è®°ä½è¿™ä¸ª<strong>é»„é‡‘æ³•åˆ™</strong>ï¼š<em>å¹¶è¡Œä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œåˆé€‚æ‰æ˜¯ç‹é“ï¼</em> é€šè¿‡åˆç†è®¾ç½®<code>MaxDegreeOfParallelism</code>ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰æ•ˆæå‡ç¨‹åºæ€§èƒ½ï¼Œå……åˆ†åˆ©ç”¨å¤šæ ¸CPUçš„ä¼˜åŠ¿ï¼ŒåŒæ—¶é¿å…èµ„æºæµªè´¹å’Œæ€§èƒ½ç“¶é¢ˆã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå»ºè®®ç»“åˆæ€§èƒ½æµ‹è¯•å·¥å…·ï¼ˆå¦‚PerfViewã€dotTraceç­‰ï¼‰è¿›è¡Œç›‘æ§å’Œè°ƒä¼˜ï¼Œæ‰¾åˆ°æœ€é€‚åˆå…·ä½“åº”ç”¨åœºæ™¯çš„å¹¶è¡Œåº¦é…ç½®ã€‚</p>
<h3 data-id="heading-16">å…³é”®è¯</h3>
<p>MaxDegreeOfParallelismã€C#å¹¶è¡Œç¼–ç¨‹ã€ParallelOptionsã€æ€§èƒ½ä¼˜åŒ–ã€CPUå¯†é›†å‹ä»»åŠ¡ã€I/Oå¯†é›†å‹ä»»åŠ¡ã€çº¿ç¨‹ç®¡ç†ã€ä¸Šä¸‹æ–‡åˆ‡æ¢ã€èµ„æºç«äº‰ã€å¹¶è¡Œåº¦æ§åˆ¶ã€Parallel.ForEachã€Parallel.Forã€.NETå¹¶å‘ã€åŠ¨æ€å¹¶è¡Œåº¦ã€æ€§èƒ½æµ‹è¯•</p>
<h3 data-id="heading-17">æœ€å</h3>
<p>å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¸å¦¨ç‚¹ä¸ªèµæ”¯æŒä¸€ä¸‹ï¼ä½ çš„æ”¯æŒæ˜¯æˆ‘ç»§ç»­åˆ†äº«çŸ¥è¯†çš„åŠ¨åŠ›ã€‚å¦‚æœæœ‰ä»»ä½•ç–‘é—®æˆ–éœ€è¦è¿›ä¸€æ­¥çš„å¸®åŠ©ï¼Œæ¬¢è¿éšæ—¶ç•™è¨€ã€‚</p>
<p>ä¹Ÿå¯ä»¥åŠ å…¥å¾®ä¿¡å…¬ä¼—å· <strong>[DotNetæŠ€æœ¯åŒ ]</strong> ç¤¾åŒºï¼Œä¸å…¶ä»–çƒ­çˆ±æŠ€æœ¯çš„åŒè¡Œä¸€èµ·äº¤æµå¿ƒå¾—ï¼Œå…±åŒæˆé•¿ï¼</p>
<p><strong>ä¼˜ç§€æ˜¯ä¸€ç§ä¹ æƒ¯ï¼Œæ¬¢è¿å¤§å®¶ç•™è¨€å­¦ä¹ ï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Agent Builder ç°å·²æ­£å¼å‘å¸ƒï¼šåœ¨å‡ åˆ†é’Ÿå†…å‘å¸ƒä¸Šä¸‹æ–‡é©±åŠ¨çš„ agents]]></title>    <link>https://juejin.cn/post/7598059250297110563</link>    <guid>https://juejin.cn/post/7598059250297110563</guid>    <pubDate>2026-01-23T01:06:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598059250297110563" data-draft-id="7598089234033131520" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Agent Builder ç°å·²æ­£å¼å‘å¸ƒï¼šåœ¨å‡ åˆ†é’Ÿå†…å‘å¸ƒä¸Šä¸‹æ–‡é©±åŠ¨çš„ agents"/> <meta itemprop="keywords" content="Elasticsearch"/> <meta itemprop="datePublished" content="2026-01-23T01:06:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Elasticsearch"/> <meta itemprop="url" content="https://juejin.cn/user/2612095360441448"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Agent Builder ç°å·²æ­£å¼å‘å¸ƒï¼šåœ¨å‡ åˆ†é’Ÿå†…å‘å¸ƒä¸Šä¸‹æ–‡é©±åŠ¨çš„ agents
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2612095360441448/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Elasticsearch
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T01:06:08.000Z" title="Fri Jan 23 2026 01:06:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šæ¥è‡ª ElasticÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fsearch-labs%2Fauthor%2Fanish-mathur" title="https://www.elastic.co/search-labs/author/anish-mathur" target="_blank" ref="nofollow noopener noreferrer">Anish Mathur</a>Â  åŠÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fsearch-labs%2Fauthor%2Fevan-castle" title="https://www.elastic.co/search-labs/author/evan-castle" target="_blank" ref="nofollow noopener noreferrer">Evan Castle</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ff3bdddc9dc46fd834370df44cf444d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769735168&amp;x-signature=Xt8eIUogOYYy6V68im1w22xWEWI%3D" alt="" loading="lazy"/></p>
<p>Agent Builder ç°å·²æ­£å¼å‘å¸ƒã€‚äº†è§£å®ƒå¦‚ä½•å¸®åŠ©ä½ å¿«é€Ÿå¼€å‘ä¸Šä¸‹æ–‡é©±åŠ¨çš„ AI agentsã€‚</p>
<p>Agent Builder ç°å·²æ­£å¼å‘å¸ƒã€‚é€šè¿‡ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcloud.elastic.co%2Fregistration%3Futm_source%3Dagentic-ai-category%26utm_medium%3Dsearch-labs%26utm_campaign%3Dagent-builder" title="https://cloud.elastic.co/registration?utm_source=agentic-ai-category&amp;utm_medium=search-labs&amp;utm_campaign=agent-builder" target="_blank" ref="nofollow noopener noreferrer">Elastic Cloud Trial</a> å¼€å§‹ä½¿ç”¨ï¼Œå¹¶<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Fsolutions%2Fsearch%2Felastic-agent-builder%3Futm_source%3Dagentic-ai-category%26utm_medium%3Dsearch-labs%26utm_campaign%3Dagent-builder" title="https://www.elastic.co/docs/solutions/search/elastic-agent-builder?utm_source=agentic-ai-category&amp;utm_medium=search-labs&amp;utm_campaign=agent-builder" target="_blank" ref="nofollow noopener noreferrer">åœ¨æ­¤</a>æŸ¥çœ‹ Agent Builder çš„æ–‡æ¡£ã€‚</p>
<hr/>
<p>æˆ‘ä»¬å¾ˆé«˜å…´å®£å¸ƒ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Felasticsearch%2Fagent-builder" title="https://www.elastic.co/elasticsearch/agent-builder" target="_blank" ref="nofollow noopener noreferrer">Agent Builder</a> åœ¨ Elastic Cloud <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fcloud%2Fserverless" title="https://www.elastic.co/cloud/serverless" target="_blank" ref="nofollow noopener noreferrer">Serverless</a> ä¸­æ­£å¼å¯ç”¨ï¼Œå¹¶å°†åœ¨å³å°†å‘å¸ƒçš„ 9.3 ç‰ˆæœ¬ä¸­æ¨å‡ºã€‚Agent Builder å°† Elasticsearch ä½œä¸ºä¸Šä¸‹æ–‡å·¥ç¨‹å¹³å°çš„èƒ½åŠ›å¸¦å…¥è¿›æ¥ï¼Œç”¨äºå¿«é€Ÿå¼€å‘å…·å¤‡ä¸Šä¸‹æ–‡æ„ŸçŸ¥ã€ä»¥æ•°æ®ä¸ºä¸­å¿ƒçš„ AI agentsã€‚</p>
<p>éšç€ agents åœ¨æå‡æ•ˆç‡å’Œæ”¹å–„å®¢æˆ·ä½“éªŒæ–¹é¢çš„æ½œåŠ›ä¸æ–­æ˜¾ç°ï¼Œå®ƒä»¬æ­£è·å¾—è¶Šæ¥è¶Šå¤šçš„å…³æ³¨ã€‚ä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä¸º agents æä¾›æ­£ç¡®çš„ä¸Šä¸‹æ–‡éå¸¸å›°éš¾ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†æ‚ä¹±ã€éç»“æ„åŒ–çš„ä¼ä¸šæ•°æ®æ—¶ã€‚å¼€å‘è€…éœ€è¦ç®¡ç†å·¥å…·ã€æç¤ºè¯ã€çŠ¶æ€ã€æ¨ç†é€»è¾‘ã€æ¨¡å‹ï¼Œå¹¶ä¸”è‡³å…³é‡è¦çš„æ˜¯ä»ä¸šåŠ¡æ•°æ®æºä¸­æ£€ç´¢ç›¸å…³ä¸Šä¸‹æ–‡ï¼Œä»¥äº¤ä»˜å‡†ç¡®çš„ç»“æœå’Œè¡ŒåŠ¨ã€‚Elastic Agent Builder æä¾›äº†è¿™äº›æ ¸å¿ƒç»„ä»¶ï¼Œç”¨äºå¼€å‘å®‰å…¨ã€å¯é ã€ä¸Šä¸‹æ–‡é©±åŠ¨çš„ agentsã€‚</p>
<h2 data-id="heading-0">Agent Builder æ ¸å¿ƒèƒ½åŠ›</h2>
<p>Agent Builder åˆ©ç”¨ Elastic åœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F138910975" title="https://elasticstack.blog.csdn.net/article/details/138910975" target="_blank" ref="nofollow noopener noreferrer">æœç´¢ç›¸å…³æ€§</a>å’Œæ£€ç´¢å¢å¼ºç”Ÿæˆæ–¹é¢çš„é•¿æœŸæŠ•å…¥ï¼Œå¹¶è‡´åŠ›äºå°† Elasticsearch æ‰“é€ æˆæœ€ä½³<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Felasticsearch%2Fvector-database" title="https://www.elastic.co/elasticsearch/vector-database" target="_blank" ref="nofollow noopener noreferrer">å‘é‡æ•°æ®åº“</a>ï¼Œä»è€Œç®€åŒ–å…·å¤‡ä¸Šä¸‹æ–‡æ„ŸçŸ¥ã€ä»¥æ•°æ®ä¸ºä¸­å¿ƒçš„ AI agents å¼€å‘ã€‚</p>
<p>Agent Builder è®©ä½ å¯ä»¥ï¼š</p>
<ul>
<li>ç«‹å³ä½¿ç”¨å†…ç½®çš„å¯¹è¯å¼ agentï¼Œå¯¹ Elasticsearch ä¸­çš„ä»»æ„æ•°æ®è¿›è¡Œé—®ç­”ã€åˆ†æå’Œè°ƒæŸ¥ã€‚</li>
<li>é€šè¿‡åŸºäºé…ç½®çš„å¼€å‘ä½“éªŒï¼Œå¿«é€Ÿå°†å¤æ‚çš„éç»“æ„åŒ–æ•°æ®è½¬åŒ–ä¸ºè‡ªå®šä¹‰ agentã€‚</li>
<li>é€šè¿‡å†…ç½® <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Fexplore-analyze%2Fquery-filter%2Flanguages%2Fesql" title="https://www.elastic.co/docs/explore-analyze/query-filter/languages/esql" target="_blank" ref="nofollow noopener noreferrer">ES|QL</a> æˆ–è‡ªå®šä¹‰å·¥å…·ï¼Œåˆ©ç”¨ä¸šç•Œé¢†å…ˆçš„<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F145697606" title="https://elasticstack.blog.csdn.net/article/details/145697606" target="_blank" ref="nofollow noopener noreferrer">æ··åˆæœç´¢</a>ç›¸å…³æ€§ï¼Œæå‡ä¸Šä¸‹æ–‡è´¨é‡å’Œ agent å¯é æ€§ã€‚</li>
<li>ä»¥å¯å¤ç”¨å·¥å…·çš„å½¢å¼æ‰§è¡Œå¤æ‚<strong>å·¥ä½œæµ</strong>ï¼ˆé¢„è§ˆï¼‰ï¼Œç”¨äºä¸°å¯Œæ•°æ®ã€æ›´æ–°è®°å½•ã€å‘é€æ¶ˆæ¯ç­‰è§„åˆ™é©±åŠ¨çš„è‡ªåŠ¨åŒ–åœºæ™¯ã€‚</li>
<li>é€šè¿‡å·¥ä½œæµå’Œ MCP è¿æ¥ Elasticsearch ä¹‹å¤–çš„æ•°æ®æºï¼Œä¸º agent å…³è”å¹¶ç»„åˆä¸Šä¸‹æ–‡ã€‚</li>
<li>é€šè¿‡ MCP æš´éœ²çš„å†…ç½®å’Œè‡ªå®šä¹‰å·¥å…·ï¼Œä¸ä»»ä½• agent æˆ–åº”ç”¨æ¡†æ¶é›†æˆï¼Œå¹¶æ”¯æŒè¿æ¥å¤–éƒ¨ MCPï¼ˆé¢„è§ˆï¼‰ã€æ”¯æŒ A2Aï¼Œä»¥åŠå®Œæ•´çš„ API æ”¯æŒã€‚</li>
<li>é€šè¿‡ä¸ç¬¬ä¸‰æ–¹è§£å†³æ–¹æ¡ˆé›†æˆæ¥æ‰©å±• Agent Builder çš„èƒ½åŠ›ï¼Œä¾‹å¦‚ä½¿ç”¨ LlamaIndex è¿›è¡Œå¤æ‚æ–‡æ¡£å¤„ç†ï¼Œæˆ–ä½¿ç”¨ Arcade.dev å®ç°å®‰å…¨ã€ç»“æ„åŒ–çš„å·¥å…·è®¿é—®ã€‚</li>
</ul>
<p>ä¸ºäº†è¿›ä¸€æ­¥æ‰©å±• Agent Builder çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬æ¨å‡ºäº† <strong>Elastic Workflows</strong>ï¼Œè¿™æ˜¯ä¸€å¥—æ–°çš„åŸºäºè§„åˆ™çš„è‡ªåŠ¨åŒ–èƒ½åŠ›ï¼Œç›®å‰å¤„äºæŠ€æœ¯é¢„è§ˆé˜¶æ®µã€‚åœ¨ç»„ç»‡çº§ä»»åŠ¡ä¸­ï¼Œagents æœ‰æ—¶éœ€è¦<strong>å…·å¤‡è§„åˆ™é©±åŠ¨</strong>æ“ä½œæ‰€å¸¦æ¥çš„<strong>ç¡®å®šæ€§å’Œå¯é æ€§</strong>ï¼Œè¿™é€šå¸¸æ˜¯å®ç°ç‰¹å®šä¸šåŠ¡é€»è¾‘æ‰€å¿…éœ€çš„ã€‚Elastic Workflows ä¸º agents æä¾›äº†ä¸€ç§ç®€å•ã€å£°æ˜å¼çš„æ–¹å¼ï¼Œç”¨äºç¼–æ’å†…éƒ¨å’Œå¤–éƒ¨ systemï¼Œæ‰§è¡Œæ“ä½œï¼Œæ”¶é›†å¹¶è½¬æ¢æ•°æ®å’Œä¸Šä¸‹æ–‡ã€‚Workflows å…·å¤‡å®Œå…¨å¯ç»„åˆã€äº‹ä»¶é©±åŠ¨å’Œé«˜åº¦çµæ´»çš„ç‰¹æ€§ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ MCP ä½œä¸ºå·¥å…·æš´éœ²ç»™ agent ä½¿ç”¨ã€‚</p>
<h2 data-id="heading-1">åœ¨å‡ åˆ†é’Ÿå†…ä»æ•°æ®åˆ° agent</h2>
<p>å¼€å‘ agents å¾€å¾€éœ€è¦æ•°å‘¨çš„å‰æœŸå·¥ä½œï¼Œç”¨äºæ•´åˆåˆ†æ•£çš„æ•°æ®å­˜å‚¨ã€æ„å»ºæ‰‹åŠ¨æµæ°´çº¿ã€è°ƒä¼˜æŸ¥è¯¢ä»¥åŠç®¡ç†å¤æ‚çš„ç¼–æ’ã€‚Agent Builder é€šè¿‡æ¶ˆé™¤å¯¹ç‹¬ç«‹æ•°æ®å­˜å‚¨ã€å‘é‡æ•°æ®åº“ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F134396254" title="https://elasticstack.blog.csdn.net/article/details/134396254" target="_blank" ref="nofollow noopener noreferrer">RAG</a> æµæ°´çº¿ã€æœç´¢å±‚ã€æŸ¥è¯¢è½¬æ¢å™¨å’Œå·¥å…·ç¼–æ’å™¨çš„éœ€æ±‚ï¼Œå¤§å¹…ç¼©çŸ­ agent çš„å¼€å‘æ—¶é—´ï¼Œè®©ä½ ä¸“æ³¨äº agent é€»è¾‘å’Œåº”ç”¨äº¤ä»˜ã€‚</p>
<p>Agent Builder åŸç”Ÿé›†æˆ Elasticsearch å¹³å°åŸè¯­ï¼Œä½¿ agent å¼€å‘æ›´å¿«é€Ÿã€‚</p>
<ul>
<li>ä»å†…ç½®çš„å¯¹è¯å¼ agent å¼€å§‹ï¼Œç«‹å³ä¸ä½ å·²ç´¢å¼•çš„æ•°æ®è¿›è¡Œå¯¹è¯å’Œæ¨ç†ã€‚</li>
<li>é€šè¿‡ Kibanaã€API æˆ– MCP ä¸ A2A çš„äº¤äº’å¼è®¿é—®ï¼Œå°† agents é›†æˆåˆ°åº”ç”¨ã€ä»ªè¡¨æ¿æˆ– CI/CD system ä¸­ã€‚</li>
<li>ä½¿ç”¨é»˜è®¤å·¥å…·ç†è§£ä½ çš„æ•°æ®ç»“æ„ï¼Œé€‰æ‹©åˆé€‚çš„ç´¢å¼•ï¼Œç”Ÿæˆä¼˜åŒ–çš„æ··åˆã€è¯­ä¹‰å’Œç»“æ„åŒ–æŸ¥è¯¢ï¼Œå¹¶åŸºäºè‡ªç„¶è¯­è¨€æç¤ºä½¿ç”¨ ES|QL åˆ›å»ºå¯é…ç½®çš„å¯è§†åŒ–ã€‚</li>
</ul>
<p>å¦‚éœ€æ›´æ·±å…¥äº†è§£ï¼Œå¯å°è¯•å®Œæ•´çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F152114746" title="https://elasticstack.blog.csdn.net/article/details/152114746" target="_blank" ref="nofollow noopener noreferrer">åŠ¨æ‰‹å®è·µæŒ‡å—</a>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c973ea97986a4d3ab17fc8bdbe8ab3c6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769735168&amp;x-signature=7mgajnttJ3DJMdTgTNJGmiVMe8E%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">æ„å»ºåœ¨ Elasticsearch ä¹‹ä¸Šï¼Œé¢å‘ä¸Šä¸‹æ–‡å·¥ç¨‹çš„å®Œæ•´æ•°æ®å¹³å°</h2>
<p>å¯¹äº AI agents æ¥è¯´ï¼Œä¸Šä¸‹æ–‡è´¨é‡å¯¹äºå®ç°æœ‰æ•ˆæ¨ç†å¹¶é™ä½å¹»è§‰é£é™©è‡³å…³é‡è¦ã€‚å¯¹äºè®¸å¤šä¼ä¸šçº§ AI agentsï¼Œå®Œæˆä»»åŠ¡æ‰€éœ€çš„ä¸šåŠ¡æ•°æ®æ˜¯æœ€å…³é”®çš„ä¸Šä¸‹æ–‡ã€‚ä½œä¸ºä¸€ä¸ªé«˜åº¦å¯æ‰©å±•çš„æ•°æ®å­˜å‚¨ã€å‘é‡æ•°æ®åº“ä»¥åŠç›¸å…³æ€§é¢†åŸŸçš„é¢†å¯¼è€…ï¼ŒElasticsearch å·²ç»æä¾›äº†è®¸å¤šå¼ºå¤§çš„ä¸Šä¸‹æ–‡å·¥ç¨‹åŸè¯­ã€‚ä¸Šä¸‹æ–‡å·¥ç¨‹ä¸ä»…ä»…æ˜¯ç®€å•çš„æ£€ç´¢å¢å¼ºç”Ÿæˆï¼Œå®ƒå…è®¸ä½ å®šåˆ¶å¹¶æ‰©å±•æ•°æ®è·å–ã€æ’åºã€è¿‡æ»¤å’Œå‘ˆç°ç»™ agents çš„æ–¹å¼ï¼Œä»è€Œå¸®åŠ©å‡å°‘å™ªå£°å’Œæ­§ä¹‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4cdeafe7cee84ebd8eccbc7637f2f9b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769735168&amp;x-signature=im6cxxaExe%2BD7Q7puADJMlhwKlg%3D" alt="" loading="lazy"/></p>
<p>Elasticsearch æä¾›äº†ä¸€ä¸ªä¸Šä¸‹æ–‡å¼•æ“ï¼Œç»“åˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F134111585" title="https://elasticstack.blog.csdn.net/article/details/134111585" target="_blank" ref="nofollow noopener noreferrer">è¯æ±‡æœç´¢</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F145485873" title="https://elasticstack.blog.csdn.net/article/details/145485873" target="_blank" ref="nofollow noopener noreferrer">å‘é‡æœç´¢</a>å’Œç»“æ„åŒ–è¿‡æ»¤ï¼Œç”¨äºæ£€ç´¢ï¼Œä»è€Œé€šè¿‡ç¡®ä¿æ¨¡å‹åœ¨ç›¸å…³ä¸”ç²¾ç¡®çš„ä¸Šä¸‹æ–‡ä¸Šè¿è¡Œï¼Œå¤§å¹…<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F154476908" title="https://elasticstack.blog.csdn.net/article/details/154476908" target="_blank" ref="nofollow noopener noreferrer">æå‡ LLM æ€§èƒ½</a>ã€‚æ­¤èƒ½åŠ›ç”± agentic æ£€ç´¢æ”¯æŒï¼Œå¹¶ç»“åˆå†…ç½®å·¥å…·å’Œæœç´¢é€»è¾‘ï¼Œè‡ªåŠ¨é€‰æ‹©æ­£ç¡®çš„ç´¢å¼•ï¼Œå¹¶å°†è‡ªç„¶è¯­è¨€è½¬æ¢ä¸ºä¼˜åŒ–çš„æŸ¥è¯¢ä»¥æä¾›ä¸Šä¸‹æ–‡ã€‚</p>
<p>ä½¿ç”¨ Agent Builderï¼Œä½ å¯ä»¥ç¡®ä¿ agents ä¼˜å…ˆè·å–æœ€æœ‰ç”¨çš„ä¸Šä¸‹æ–‡ï¼Œå¹¶é€šè¿‡ç›¸å…³æ€§å’Œæ’åºæ§åˆ¶ï¼Œå¾®è°ƒè¯„åˆ†ã€æ’åºå’Œè¿‡æ»¤é€»è¾‘ã€‚Elasticsearch è®©ä½ æ§åˆ¶ä»€ä¹ˆé‡è¦ã€ä¸ºä»€ä¹ˆé‡è¦ä»¥åŠå¦‚ä½•ä¼˜å…ˆå¤„ç†ï¼Œè€Œä¸æ˜¯ä¾èµ–ä¸é€æ˜çš„æ£€ç´¢è¡Œä¸ºã€‚æ‰€æœ‰è¿™äº›éƒ½åŸºäº Elasticsearch ä½œä¸ºå¯æ‰©å±•çš„æ•°æ®å¹³å°ï¼Œå¯åœ¨ä¸€ä¸ªå¹³å°ä¸Šå­˜å‚¨å’Œæ‰©å±•æ‰€æœ‰æ•°æ®ï¼ŒåŒ…æ‹¬æ–‡æœ¬ã€å‘é‡ã€å…ƒæ•°æ®ã€æ—¥å¿—ç­‰ï¼Œä»è€Œæ›´å®¹æ˜“ç®¡ç† agents çš„ä¸Šä¸‹æ–‡ã€‚</p>
<h2 data-id="heading-3">å°†å¤æ‚å·¥ä½œæµä½œä¸ºå¯å¤ç”¨å·¥å…·æ‰§è¡Œ</h2>
<p>è™½ç„¶ AI agents èƒ½å¤Ÿä¸ºå¤æ‚ä»»åŠ¡æä¾›æ¨ç†èƒ½åŠ›ï¼Œä½†å¤§é‡è‡ªåŠ¨åŒ–ä¾èµ–äºå¯é æ‰§è¡Œè§„åˆ™é©±åŠ¨çš„æ“ä½œï¼Œä»¥å®æ–½ç‰¹å®šä¸šåŠ¡é€»è¾‘ã€‚Elastic Workflows æä¾›äº†ä¸€ç§ç®€å•ã€å£°æ˜å¼çš„æ–¹å¼ï¼Œç”¨äºç¼–æ’å†…éƒ¨å’Œå¤–éƒ¨ system ä»¥æ‰§è¡Œæ“ä½œã€æ”¶é›†ä¸Šä¸‹æ–‡æˆ–æ•°æ®ï¼Œå¹¶å°†å…¶æ•´åˆä¸º agents çš„ä¸€éƒ¨åˆ†ã€‚å·¥ä½œæµä»¥ YAML å®šä¹‰ï¼Œå®Œå…¨å¯ç»„åˆï¼Œå¯æ ¹æ®ä»»åŠ¡éœ€æ±‚ç®€åŒ–æˆ–å¤æ‚åŒ–ã€‚è¿™ä¸º agents åœ¨ Elasticsearch å¹³å°åŠå…¶è§£å†³æ–¹æ¡ˆï¼Œä»¥åŠç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åºä¸Šé«˜æ•ˆæ‰§è¡Œæ“ä½œæä¾›äº†é€”å¾„ã€‚</p>
<p>å°†å·¥ä½œæµä¸ Agent Builder é›†æˆå¯ä»¥é€šè¿‡ä¸‰æ­¥å®Œæˆï¼ˆå‰æï¼šå¯ç”¨å·¥ä½œæµï¼Œè¯¦ç»†ä¿¡æ¯è§<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Felastic%2Fworkflows" title="https://github.com/elastic/workflows" target="_blank" ref="nofollow noopener noreferrer">æ­¤å¤„</a>ï¼‰</p>
<p>1ï¼‰ä½¿ç”¨åŸºäº YAML çš„ç®€å•ç¼–è¾‘å™¨åˆ›å»ºå¹¶ä¿å­˜æ–°çš„å·¥ä½œæµï¼Œè¯¥ç¼–è¾‘å™¨å†…ç½®è‡ªåŠ¨è¡¥å…¨å’Œæµ‹è¯•åŠŸèƒ½ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4c7f0935059143e2a31ff2e9fc356b43~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769735168&amp;x-signature=EpyW2eSRzEf1Ki2W2Z8Vi4SkUlM%3D" alt="" loading="lazy"/></p>
<p>2ï¼‰åœ¨ Agent Builder ä¸­åˆ›å»ºä¸€ä¸ªæ–°å·¥å…·ï¼Œç±»å‹ä¸º â€œWorkflowâ€ï¼Œå¹¶æä¾›æè¿°ä»¥å¸®åŠ© agent ç¡®å®šä½•æ—¶ä½¿ç”¨è¯¥ workflow å·¥å…·ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d0dad36008814541901961c7b1b78965~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769735168&amp;x-signature=Qha%2FV0MYWr1N3gl9x%2FxSbzpwCLg%3D" alt="" loading="lazy"/></p>
<p>3ï¼‰å°† workflow å·¥å…·æ·»åŠ åˆ°ä½ çš„è‡ªå®šä¹‰ agent ä¸­ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1a9a26c51364210b4b45897bc6288bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769735168&amp;x-signature=A5fWt%2BMCHRnO%2BGHMoMG9S8InjhI%3D" alt="" loading="lazy"/></p>
<p>4ï¼‰å°±è¿™æ ·ï¼ç°åœ¨ agent å¯ä»¥åœ¨å¯¹è¯ä¸­è°ƒç”¨è¯¥ workflowã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cf8ca76c6e7840c4926f481261fd24b6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769735168&amp;x-signature=I2IGHMtRiAAA6dbjAA7mKFfwhGk%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">ä½ çš„ agentï¼Œä½ çš„è§„åˆ™</h2>
<p>Agent Builder ä¸ä¼šå°†ä½ é”å®šåœ¨å•ä¸€å¼€å‘èŒƒå¼ä¸­ã€‚ç›¸åï¼Œå®ƒæ—¨åœ¨æ”¯æŒå¼€æ”¾ã€çµæ´»çš„ agent å¼€å‘æ–¹æ³•ï¼Œè®©ä½ å¯¹æ•°æ®ã€ç›¸å…³æ€§ã€æ¨¡å‹ã€äº’æ“ä½œæ€§ã€å®‰å…¨æ€§å’Œ agent è®¾è®¡æ‹¥æœ‰å®Œå…¨æ§åˆ¶ã€‚</p>
<p>è‡ªå®šä¹‰ agent å®šä¹‰å…è®¸ä½ ç²¾ç¡®é€‰æ‹© agent å¯è®¿é—®çš„å·¥å…·ã€åµŒå…¥è‡ªå®šä¹‰ system promptã€è°ƒæ•´ agent çš„æŒ‡ä»¤ï¼Œå¹¶å®šä¹‰å®‰å…¨è¾¹ç•Œã€‚agents ä¿æŒæ¨¡å‹æ— å…³æ€§ï¼Œä½¿ä½ å¯ä»¥çµæ´»é…ç½®é¦–é€‰çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F134747557" title="https://elasticstack.blog.csdn.net/article/details/134747557" target="_blank" ref="nofollow noopener noreferrer">LLM</a>ï¼Œæ— è®ºæ˜¯åŸç”Ÿæ¨¡å‹è¿˜æ˜¯æ•´ä¸ªç”Ÿæ€ç³»ç»Ÿä¸­çš„æ¨¡å‹ï¼Œè€Œæ— éœ€è¢«é”å®šåœ¨å•ä¸€æä¾›å•†ã€‚</p>
<p>æ„å»ºå¯æ‰©å±•å·¥å…·ä»¥å°è£…ç‰¹å®šé¢†åŸŸé€»è¾‘ï¼ˆä¾‹å¦‚ç‰¹å®šç´¢å¼•è¿‡æ»¤å™¨ã€ES|QL è”æ¥ã€åˆ†ææµæ°´çº¿ï¼‰ï¼Œå¹¶å°†å…¶çº¦æŸä»¥åœ¨ç”Ÿäº§ä¸­å®‰å…¨ä½¿ç”¨ã€‚å®Œæ•´çš„ API æ”¯æŒä½¿å…¶ä¸å…¶ä»– agentic æ¡†æ¶äº’æ“ä½œï¼Œå¹¶åŸç”Ÿæ”¯æŒ Model Context Protocolï¼ˆMCPï¼‰ã€‚A2A é›†æˆæ„å‘³ç€ä½ å¯ä»¥å°† Elastic agents æš´éœ²ç»™å…¶ä»–æ¡†æ¶ã€æœåŠ¡å’Œå®¢æˆ·ç«¯åº”ç”¨ï¼Œåœ¨æ•´åˆä¸­å¤ç”¨ç›¸åŒçš„æ•°æ®å’Œä¸Šä¸‹æ–‡å·¥ç¨‹é€»è¾‘ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/397e9b7eb39846789e1108490be39a3a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769735168&amp;x-signature=WRgL2ypNqlcLyJmPCUew4101aiQ%3D" alt="" loading="lazy"/></p>
<p>Agent Builder æ”¯æŒçµæ´»ã€å¼€æ”¾çš„å¼€å‘ï¼Œå¹¶è®¾è®¡ä¸ºèƒ½å¤Ÿè½»æ¾é›†æˆæµè¡Œçš„ agent æ¡†æ¶å’Œå¹³å°ã€‚è¿™äº›é›†æˆå¯¹äºäº¤ä»˜é«˜æ•ˆ agent è‡³å…³é‡è¦ã€‚æ­£å¦‚ <strong>Arcade.dev è”åˆåˆ›å§‹äºº Sam Partee</strong> æ‰€è¯´ï¼š</p>
<p>â€œ<em>ç›®å‰ agentic ç³»ç»Ÿå¤±è´¥çš„åŸå› åœ¨äºå°† AI ä¸å·¥å…·å’Œæ•°æ®è¿æ¥éå¸¸å¤æ‚ã€‚Elastic Agent Builder ä¸ Arcade.dev ä¸ºå¼€å‘è€…æä¾›äº†ä¸€ç§ç»“æ„åŒ–ã€å®‰å…¨çš„æ–¹å¼æ¥å¤„ç† agent å¦‚ä½•æ£€ç´¢ä¸Šä¸‹æ–‡ã€æ¨ç†å’Œè¡ŒåŠ¨ï¼Œä½¿ agent ä»æ¼”ç¤ºèµ°å‘ç”Ÿäº§çº§åˆ«ã€‚</em>â€</p>
<p>Agent Builder è¿˜åˆ©ç”¨ Elasticsearch çš„å¯æ‰©å±•æ€§æ¥å¤„ç†å¤æ‚æ•°æ®ã€‚æ­£å¦‚ <strong>LlamaIndex CEO Jerry Liu</strong> æ‰€è¯´ï¼š</p>
<p>â€œä»éç»“æ„åŒ–æ•°æ®æºè§£é”ä¼ä¸šä¸Šä¸‹æ–‡æ˜¯æ„å»ºé«˜æ•ˆ agent çš„å…³é”®ã€‚Elastic Agent Builder ç»“åˆ LlamaIndex çš„å¤æ‚æ–‡æ¡£å¤„ç†ï¼Œå¼ºåŒ–äº†å…³é”®ä¸Šä¸‹æ–‡å±‚ï¼Œå¸®åŠ©å›¢é˜Ÿæ£€ç´¢ã€å¤„ç†å’Œå‡†å¤‡æ•°æ®ï¼Œä½¿ agent èƒ½æ›´å‡†ç¡®åœ°æ¨ç†å¹¶æä¾›æ›´å¥½çš„ç»“æœã€‚â€</p>
<h2 data-id="heading-5">ä½ å¯ä»¥æ„å»ºä»€ä¹ˆï¼Ÿ</h2>
<p>Agent Builder å·²ç»åœ¨å¤šç§ä½¿ç”¨åœºæ™¯ä¸­åº”ç”¨ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ç¤ºä¾‹å’Œå‚è€ƒæ¶æ„ï¼Œå¸®åŠ©ä½ å¼€å§‹æ„å»º agentï¼š</p>
<ul>
<li><strong>è‡ªåŠ¨åŒ–åŸºç¡€è®¾æ–½</strong>ï¼šåœ¨æ”¯æŒåœºæ™¯ä¸­ï¼Œagents å¯ç”¨äºè¯»å–ã€æ€è€ƒå’Œå¯¹è¯ï¼Œä½†åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå®ƒä»¬æ— æ³•ç›´æ¥æ“ä½œæ‰€éœ€ç®¡ç†çš„åŸºç¡€è®¾æ–½ã€‚Elastic å·¥ç¨‹å›¢é˜Ÿåœ¨ä¸€æ¬¡é»‘å®¢æ¾ä¸­æ„å»ºäº†ä¸€ä¸ªç”¨äº<a href="https://link.juejin.cn?target=http%3A%2F%2FAgent%2520Builder%2C%2520beyond%2520the%2520chatbox%3A%2520Introducing%2520Augmented%2520Infrastructure" title="http://Agent%20Builder,%20beyond%20the%20chatbox:%20Introducing%20Augmented%20Infrastructure" target="_blank" ref="nofollow noopener noreferrer">è‡ªåŠ¨åŒ–åŸºç¡€è®¾æ–½ç®¡ç†</a>çš„ agentã€‚è¯¥ agent èƒ½ä¸»åŠ¨è°ƒæŸ¥åº”ç”¨åŸºç¡€è®¾æ–½é—®é¢˜å¹¶æ‰§è¡Œè‡ªåŠ¨åŒ–æ“ä½œã€‚å®ƒä½¿ç”¨ workflows ä¼˜åŒ–é…ç½®ã€å“åº”é—®é¢˜å¹¶æ‰©å±•èµ„æºï¼Œæ‰€æœ‰æ“ä½œéƒ½åŸºäºå¯¹åŸºç¡€è®¾æ–½æ—¥å¿—çš„æ™ºèƒ½ç†è§£ã€‚</li>
<li><strong>å®‰å…¨å¨èƒåˆ†æ</strong>ï¼šä½¿ç”¨ Elastic Agent Builderã€MCP å’Œ Elasticsearch å¼€å‘äº†ä¸€ä¸ªå®‰å…¨æ¼æ´ agentã€‚å®ƒé€šè¿‡å°†å†…éƒ¨å®‰å…¨æ•°æ®ä¸å¤–éƒ¨å¨èƒæƒ…æŠ¥å…³è”ï¼Œå®ç°å¨èƒåˆ†æè‡ªåŠ¨åŒ–ã€‚agent å¯¹å†å²äº‹ä»¶å’Œé…ç½®æ‰§è¡Œè¯­ä¹‰æœç´¢ï¼Œç”¨å®æ—¶äº’è”ç½‘æ•°æ®å¢å¼ºç»“æœï¼Œå¹¶åº”ç”¨ LLM æ¨ç†è¯„ä¼°ç¯å¢ƒç›¸å…³æ€§ã€ä¼˜å…ˆé£é™©å¹¶ç”Ÿæˆå¯æ“ä½œçš„ä¿®å¤æ–¹æ¡ˆã€‚å‚è§<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fsearch-labs%2Fblog%2Fagent-builder-mcp-reference-architecture-elasticsearch" title="https://www.elastic.co/search-labs/blog/agent-builder-mcp-reference-architecture-elasticsearch" target="_blank" ref="nofollow noopener noreferrer">å‚è€ƒæ¶æ„</a>ã€‚</li>
<li><strong>æŠ€æœ¯å®¢æˆ·æ”¯æŒ</strong>ï¼šagents å¯ä»¥æ‰§è¡Œå¤šç§æ”¯æŒä»»åŠ¡ï¼ŒåŒ…æ‹¬æ¡ˆä»¶æ‘˜è¦ã€é—®é¢˜å»é‡ä¸åˆ›å»ºï¼Œä»¥åŠæ·±åº¦æŠ€æœ¯è°ƒæŸ¥ã€‚Agent Builder é€šè¿‡å¤šæ­¥éª¤æ··åˆæœç´¢ï¼Œæ‰¾åˆ°æœ€ç›¸å…³çš„é—®é¢˜ã€è§£å†³æ–¹æ¡ˆå’Œæµç¨‹ï¼Œå¹¶åˆ¶å®šæ ¹å› å‡è®¾å’Œä¿®å¤è®¡åˆ’ï¼Œä»è€Œç®€åŒ–å¤æ‚<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F142066592" title="https://elasticstack.blog.csdn.net/article/details/142066592" target="_blank" ref="nofollow noopener noreferrer">æ”¯æŒç³»ç»Ÿ</a>æ¶æ„ï¼ŒåŠ å¿«äº¤ä»˜é€Ÿåº¦ã€‚</li>
<li><strong>äº§å“å’Œå†…å®¹å‘ç°</strong>ï¼šAgent Builder ç®€åŒ–äº†ä¸º<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fsearch-labs%2Fblog%2Fbuild-voice-agents-elastic-agent-builder" title="https://www.elastic.co/search-labs/blog/build-voice-agents-elastic-agent-builder" target="_blank" ref="nofollow noopener noreferrer">å¯¹è¯ä½“éªŒå…¬å¼€å¤æ‚äº§å“ç›®å½•</a>çš„è¿‡ç¨‹ï¼ŒåŒæ—¶å…è®¸ç»„ç»‡ä¿æŒçµæ´»æ€§ï¼Œä»¥çº³å…¥è‡ªèº«çš„ä¸šåŠ¡é€»è¾‘å’Œéœ€æ±‚ã€‚</li>
<li><strong>è‡ªè¡Œæ„å»º</strong>ï¼šåŠ å…¥ä» 2026 å¹´ 1 æœˆ 22 æ—¥è‡³ 2 æœˆ 27 æ—¥ä¸¾åŠçš„ Agent Builder <a href="https://link.juejin.cn?target=https%3A%2F%2Felasticsearch.devpost.com%2F" title="https://elasticsearch.devpost.com/" target="_blank" ref="nofollow noopener noreferrer">é»‘å®¢æ¾</a>ã€‚ä¸ç¤¾åŒºä¸€èµ·æ„å»ºä¸Šä¸‹æ–‡é©±åŠ¨ã€å¤šæ­¥éª¤ AI agentsï¼Œå°†æœç´¢ã€workflowsã€å·¥å…·å’Œæ¨ç†ç»“åˆèµ·æ¥ï¼Œè‡ªåŠ¨åŒ–ç°å®ä¸–ç•Œä»»åŠ¡*</li>
</ul>
<h2 data-id="heading-6">ç«‹å³å¼€å§‹æ„å»ºè‡ªå®šä¹‰ agents</h2>
<p>é€šè¿‡ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcloud.elastic.co%2Fregistration%3Fonboarding_token%3Dsearch%26pg%3Den-enterprise-search-page" title="https://cloud.elastic.co/registration?onboarding_token=search&amp;pg=en-enterprise-search-page" target="_blank" ref="nofollow noopener noreferrer">Elastic Cloud Trial</a> å¼€å§‹ä½¿ç”¨ï¼Œå¹¶åœ¨æ­¤æŸ¥çœ‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Fsolutions%2Fsearch%2Felastic-agent-builder" title="https://www.elastic.co/docs/solutions/search/elastic-agent-builder" target="_blank" ref="nofollow noopener noreferrer">æ–‡æ¡£</a>ã€‚å¯¹äºç°æœ‰å®¢æˆ·ï¼ŒAgent Builder å¯åœ¨ Cloud Serverless ä»¥åŠ Elastic Cloud æ‰˜ç®¡å’Œè‡ªç®¡ç†çš„ Enterprise Tier ä½¿ç”¨ã€‚</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Felasticsearch.devpost.com%2Frules" title="https://elasticsearch.devpost.com/rules" target="_blank" ref="nofollow noopener noreferrer">ç‚¹å‡»æ­¤å¤„</a>æŸ¥çœ‹é»‘å®¢æ¾çš„å®Œæ•´æ¡æ¬¾ã€æ¡ä»¶å’Œèµ„æ ¼è¦æ±‚</li>
</ul>
<p>åŸæ–‡ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fsearch-labs%2Fblog%2Fagent-builder-elastic-ga" title="https://www.elastic.co/search-labs/blog/agent-builder-elastic-ga" target="_blank" ref="nofollow noopener noreferrer">www.elastic.co/search-labsâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Rust å®ç”¨å·¥å…·ç‰¹å‹ï¼šTryFrom ä¸ TryInto]]></title>    <link>https://juejin.cn/post/7598089234033311744</link>    <guid>https://juejin.cn/post/7598089234033311744</guid>    <pubDate>2026-01-23T01:35:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598089234033311744" data-draft-id="7598055483634171904" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Rust å®ç”¨å·¥å…·ç‰¹å‹ï¼šTryFrom ä¸ TryInto"/> <meta itemprop="keywords" content="åç«¯,Rust"/> <meta itemprop="datePublished" content="2026-01-23T01:35:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å™—å™œå™—å™œå•ª"/> <meta itemprop="url" content="https://juejin.cn/user/4037062427148462"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Rust å®ç”¨å·¥å…·ç‰¹å‹ï¼šTryFrom ä¸ TryInto
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4037062427148462/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å™—å™œå™—å™œå•ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T01:35:13.000Z" title="Fri Jan 23 2026 01:35:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="" data-highlight-key="a11y-light">.hljs-comment,.hljs-quote{color:#696969}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d91e18}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#aa5d00}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:green}.hljs-section,.hljs-title{color:#007faa}.hljs-keyword,.hljs-selector-tag{color:#7928a1}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fefefe;color:#545454}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><p><strong>å¯èƒ½å¤±è´¥çš„ç±»å‹è½¬æ¢</strong></p>
<p>ç®€å•è¯´ï¼Œ<code>TryFrom</code> å’Œ <code>TryInto</code> æ˜¯ <code>From</code> å’Œ <code>Into</code> çš„ã€Œå¯èƒ½å¤±è´¥ã€ç‰ˆæœ¬ã€‚æ¯”å¦‚æŠŠ <code>i32</code> è½¬æˆ <code>u8</code>ï¼Œè´Ÿæ•°æˆ–è¶…è¿‡ 255 çš„å°±è½¬ä¸äº†ï¼Œè¿™æ—¶å€™ç”¨ <code>TryFrom</code> è¿”å› <code>Result</code>ï¼Œè€Œä¸æ˜¯åƒ <code>From</code> é‚£æ ·ç›´æ¥ panic æˆ–ä¸¢å¤±æ•°æ®ã€‚</p>
<h2 data-id="heading-0">1. æ ¸å¿ƒæ¦‚å¿µ</h2>
<h3 data-id="heading-1">From/Into çš„å±€é™</h3>
<p><code>From</code> å’Œ <code>Into</code> é€‚åˆã€Œæ°¸è¿œæˆåŠŸã€çš„è½¬æ¢ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// æ°¸è¿œæˆåŠŸï¼š&amp;str è½¬ String</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s</span>: <span class="hljs-type">String</span> = <span class="hljs-string">"hello"</span>.<span class="hljs-title function_ invoke__">into</span>();

<span class="hljs-comment">// æ°¸è¿œæˆåŠŸï¼ši32 è½¬ i64</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">big</span>: <span class="hljs-type">i64</span> = <span class="hljs-number">42i32</span>.<span class="hljs-title function_ invoke__">into</span>();
</code></pre>
<p>ä½†æœ‰äº›è½¬æ¢å¯èƒ½å¤±è´¥ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// é—®é¢˜ï¼ši32 è½¬ u8ï¼Œè´Ÿæ•°å’‹åŠï¼Ÿè¶…è¿‡ 255 å’‹åŠï¼Ÿ</span>
<span class="hljs-comment">// ç”¨ From çš„è¯åªèƒ½ panic æˆ–æˆªæ–­ï¼Œéƒ½ä¸å¥½</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">bad_convert</span>(n: <span class="hljs-type">i32</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">u8</span> {
    <span class="hljs-keyword">if</span> n &lt; <span class="hljs-number">0</span> || n &gt; <span class="hljs-number">255</span> {
        <span class="hljs-built_in">panic!</span>(<span class="hljs-string">"è¶…å‡ºèŒƒå›´"</span>);  <span class="hljs-comment">// ä¸ä¼˜é›…</span>
    }
    n <span class="hljs-keyword">as</span> <span class="hljs-type">u8</span>
}
</code></pre>
<p>è¿™å°±æ˜¯ <code>TryFrom</code> çš„ç”¨æ­¦ä¹‹åœ°ã€‚</p>
<h3 data-id="heading-2">TryFromï¼šå¯èƒ½å¤±è´¥çš„è½¬æ¢</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// TryFrom trait å®šä¹‰</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">trait</span> <span class="hljs-title class_">TryFrom</span>&lt;T&gt;: <span class="hljs-built_in">Sized</span> {
    <span class="hljs-comment">// å…³è”ç±»å‹ï¼šå®šä¹‰è½¬æ¢å¤±è´¥æ—¶è¿”å›çš„é”™è¯¯ç±»å‹</span>
    <span class="hljs-comment">// å¯ä»¥æ˜¯ Stringã€è‡ªå®šä¹‰æšä¸¾ã€æˆ–ä»»ä½•å®ç°äº† Error trait çš„ç±»å‹</span>
    <span class="hljs-keyword">type</span> <span class="hljs-title class_">Error</span>;
    
    <span class="hljs-comment">// è½¬æ¢æ–¹æ³•ï¼šå°è¯•ä»ç±»å‹ T åˆ›å»º Self</span>
    <span class="hljs-comment">// - å‚æ•° value: è¦è½¬æ¢çš„æºå€¼ï¼ˆè·å–æ‰€æœ‰æƒï¼‰</span>
    <span class="hljs-comment">// - è¿”å›å€¼ï¼šResult&lt;Self, Self::Error&gt;</span>
    <span class="hljs-comment">//   - Ok(Self)ï¼šè½¬æ¢æˆåŠŸï¼Œè¿”å›æ–°å€¼</span>
    <span class="hljs-comment">//   - Err(Self::Error)ï¼šè½¬æ¢å¤±è´¥ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯</span>
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">try_from</span>(value: T) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-keyword">Self</span>, <span class="hljs-keyword">Self</span>::Error&gt;;
}
</code></pre>
<p><code>TryFrom</code> å›ç­”çš„é—®é¢˜æ˜¯ï¼š"æˆ‘èƒ½ä»ç±»å‹ T åˆ›å»º Self å—ï¼Ÿå¯èƒ½å¤±è´¥ã€‚"</p>
<blockquote>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦å…³è”ç±»å‹ Errorï¼Ÿ</strong>
ä¸åŒçš„è½¬æ¢å¯èƒ½æœ‰ä¸åŒçš„å¤±è´¥åŸå› ã€‚æ¯”å¦‚æ•´æ•°è½¬æ¢å¤±è´¥æ˜¯å› ä¸ºæº¢å‡ºï¼Œå­—ç¬¦ä¸²è§£æå¤±è´¥å¯èƒ½æ˜¯æ ¼å¼é”™è¯¯ã€‚ç”¨å…³è”ç±»å‹è®©æ¯ä¸ªå®ç°å¯ä»¥å®šä¹‰è‡ªå·±çš„é”™è¯¯ç±»å‹ï¼Œæ›´çµæ´»ä¹Ÿæ›´ç²¾ç¡®ã€‚</p>
</blockquote>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> std::convert::TryFrom;

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-comment">// æˆåŠŸçš„è½¬æ¢</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">small</span> = <span class="hljs-type">u8</span>::<span class="hljs-title function_ invoke__">try_from</span>(<span class="hljs-number">100i32</span>);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?}"</span>, small);  <span class="hljs-comment">// Ok(100)</span>

    <span class="hljs-comment">// å¤±è´¥çš„è½¬æ¢</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">too_big</span> = <span class="hljs-type">u8</span>::<span class="hljs-title function_ invoke__">try_from</span>(<span class="hljs-number">300i32</span>);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?}"</span>, too_big);  <span class="hljs-comment">// Err(TryFromIntError)</span>

    <span class="hljs-comment">// è´Ÿæ•°ä¹Ÿå¤±è´¥</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">negative</span> = <span class="hljs-type">u8</span>::<span class="hljs-title function_ invoke__">try_from</span>(-<span class="hljs-number">1i32</span>);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?}"</span>, negative);  <span class="hljs-comment">// Err(TryFromIntError)</span>
}
</code></pre>
<ul>
<li><strong>è¿”å›å€¼</strong>ï¼š<code>Result&lt;Self, Self::Error&gt;</code></li>
<li><strong>æˆåŠŸ</strong>ï¼š<code>Ok(è½¬æ¢åçš„å€¼)</code></li>
<li><strong>å¤±è´¥</strong>ï¼š<code>Err(é”™è¯¯ä¿¡æ¯)</code></li>
</ul>
<h3 data-id="heading-3">TryIntoï¼šTryFrom çš„é•œåƒ</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// TryInto trait å®šä¹‰</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">trait</span> <span class="hljs-title class_">TryInto</span>&lt;T&gt;: <span class="hljs-built_in">Sized</span> {
    <span class="hljs-comment">// å…³è”ç±»å‹ï¼šè½¬æ¢å¤±è´¥æ—¶çš„é”™è¯¯ç±»å‹</span>
    <span class="hljs-keyword">type</span> <span class="hljs-title class_">Error</span>;
    
    <span class="hljs-comment">// è½¬æ¢æ–¹æ³•ï¼šå°è¯•æŠŠ Self è½¬æ¢æˆç±»å‹ T</span>
    <span class="hljs-comment">// - å‚æ•° self: æ¶ˆè´¹è‡ªèº«ï¼ˆè·å–æ‰€æœ‰æƒï¼‰</span>
    <span class="hljs-comment">// - è¿”å›å€¼ï¼šResult&lt;T, Self::Error&gt;</span>
    <span class="hljs-comment">//   - Ok(T)ï¼šè½¬æ¢æˆåŠŸï¼Œè¿”å›ç›®æ ‡ç±»å‹çš„å€¼</span>
    <span class="hljs-comment">//   - Err(Self::Error)ï¼šè½¬æ¢å¤±è´¥ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯</span>
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">try_into</span>(<span class="hljs-keyword">self</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;T, <span class="hljs-keyword">Self</span>::Error&gt;;
}
</code></pre>
<p>å’Œ <code>From</code>/<code>Into</code> ä¸€æ ·ï¼Œå®ç° <code>TryFrom</code> å°±è‡ªåŠ¨è·å¾— <code>TryInto</code>ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> std::convert::TryInto;

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-comment">// TryFrom ç”¨æ³•ï¼šç›®æ ‡ç±»å‹è°ƒç”¨</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">result1</span> = <span class="hljs-type">u8</span>::<span class="hljs-title function_ invoke__">try_from</span>(<span class="hljs-number">100i32</span>);

    <span class="hljs-comment">// TryInto ç”¨æ³•ï¼šæºç±»å‹è°ƒç”¨ï¼ˆè‡ªåŠ¨è·å¾—ï¼‰</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">result2</span>: <span class="hljs-type">Result</span>&lt;<span class="hljs-type">u8</span>, _&gt; = <span class="hljs-number">100i32</span>.<span class="hljs-title function_ invoke__">try_into</span>();

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?}, {:?}"</span>, result1, result2);  <span class="hljs-comment">// Ok(100), Ok(100)</span>
}
</code></pre>
<blockquote>
<p><strong>ä¸ºä»€ä¹ˆæœ‰ä¸¤ä¸ª traitï¼Ÿ</strong>
å’Œ <code>From</code>/<code>Into</code> ä¸€æ ·ï¼Œ<code>TryFrom</code> ä»ç›®æ ‡ç±»å‹è§’åº¦çœ‹ï¼ˆ"æˆ‘èƒ½ä»ä»€ä¹ˆåˆ›å»º"ï¼‰ï¼Œ<code>TryInto</code> ä»æºç±»å‹è§’åº¦çœ‹ï¼ˆ"æˆ‘èƒ½è½¬æ¢æˆä»€ä¹ˆ"ï¼‰ã€‚å®ç° <code>TryFrom</code> å°±å¤Ÿäº†ï¼Œç¼–è¯‘å™¨è‡ªåŠ¨æä¾› <code>TryInto</code>ã€‚</p>
</blockquote>
<h2 data-id="heading-4">2. æ ‡å‡†åº“å®ç°</h2>
<h3 data-id="heading-5">æ•´æ•°ç±»å‹è½¬æ¢</h3>
<p>Rust æ ‡å‡†åº“ä¸ºæ‰€æœ‰æ•´æ•°ç±»å‹å®ç°äº† <code>TryFrom</code>ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> std::convert::TryFrom;

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-comment">// i32 â†’ u8ï¼šæ£€æŸ¥èŒƒå›´ [0, 255]</span>
    <span class="hljs-built_in">assert!</span>(<span class="hljs-type">u8</span>::<span class="hljs-title function_ invoke__">try_from</span>(<span class="hljs-number">100i32</span>).<span class="hljs-title function_ invoke__">is_ok</span>());
    <span class="hljs-built_in">assert!</span>(<span class="hljs-type">u8</span>::<span class="hljs-title function_ invoke__">try_from</span>(-<span class="hljs-number">1i32</span>).<span class="hljs-title function_ invoke__">is_err</span>());
    <span class="hljs-built_in">assert!</span>(<span class="hljs-type">u8</span>::<span class="hljs-title function_ invoke__">try_from</span>(<span class="hljs-number">256i32</span>).<span class="hljs-title function_ invoke__">is_err</span>());

    <span class="hljs-comment">// u32 â†’ i16ï¼šæ£€æŸ¥èŒƒå›´ [-32768, 32767]</span>
    <span class="hljs-built_in">assert!</span>(<span class="hljs-type">i16</span>::<span class="hljs-title function_ invoke__">try_from</span>(<span class="hljs-number">1000u32</span>).<span class="hljs-title function_ invoke__">is_ok</span>());
    <span class="hljs-built_in">assert!</span>(<span class="hljs-type">i16</span>::<span class="hljs-title function_ invoke__">try_from</span>(<span class="hljs-number">40000u32</span>).<span class="hljs-title function_ invoke__">is_err</span>());

    <span class="hljs-comment">// usize â†’ u32ï¼šåœ¨ 64 ä½ç³»ç»Ÿä¸Šå¯èƒ½å¤±è´¥</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">big</span>: <span class="hljs-type">usize</span> = <span class="hljs-type">usize</span>::MAX;
    <span class="hljs-built_in">assert!</span>(<span class="hljs-type">u32</span>::<span class="hljs-title function_ invoke__">try_from</span>(big).<span class="hljs-title function_ invoke__">is_err</span>());
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li>æœ‰ç¬¦å· â†” æ— ç¬¦å·ï¼šæ£€æŸ¥è´Ÿæ•°</li>
<li>å¤§ç±»å‹ â†’ å°ç±»å‹ï¼šæ£€æŸ¥èŒƒå›´</li>
<li>å¹³å°ç›¸å…³ç±»å‹ï¼ˆ<code>usize</code>/<code>isize</code>ï¼‰ï¼šæ£€æŸ¥å¹³å°å·®å¼‚</li>
</ul>
<h3 data-id="heading-6">è‡ªåŠ¨å®ç° TryInto</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// æ ‡å‡†åº“ä¸º TryFrom è‡ªåŠ¨å®ç° TryInto</span>
<span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªæ³›å‹å®ç°ï¼ˆblanket implementationï¼‰</span>
<span class="hljs-keyword">impl</span>&lt;T, U&gt; TryInto&lt;U&gt; <span class="hljs-keyword">for</span> <span class="hljs-title class_">T</span>
<span class="hljs-keyword">where</span>
    U: TryFrom&lt;T&gt;,  <span class="hljs-comment">// çº¦æŸï¼šU å¿…é¡»å®ç°äº† TryFrom&lt;T&gt;</span>
{
    <span class="hljs-comment">// TryInto çš„é”™è¯¯ç±»å‹å’Œ TryFrom çš„é”™è¯¯ç±»å‹ä¿æŒä¸€è‡´</span>
    <span class="hljs-keyword">type</span> <span class="hljs-title class_">Error</span> = U::Error;

    <span class="hljs-comment">// try_into çš„å®ç°ï¼šç›´æ¥è°ƒç”¨ç›®æ ‡ç±»å‹çš„ try_from</span>
    <span class="hljs-comment">// self: æºç±»å‹çš„å€¼ï¼ˆç±»å‹ Tï¼‰</span>
    <span class="hljs-comment">// è¿”å›ï¼šResult&lt;U, U::Error&gt;</span>
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">try_into</span>(<span class="hljs-keyword">self</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;U, U::Error&gt; {
        <span class="hljs-comment">// æŠŠ self ä¼ ç»™ U::try_fromï¼Œè®©ç›®æ ‡ç±»å‹æ¥åšè½¬æ¢</span>
        <span class="hljs-comment">// è¿™æ ·å°±ä¸éœ€è¦é‡å¤å†™è½¬æ¢é€»è¾‘äº†</span>
        U::<span class="hljs-title function_ invoke__">try_from</span>(<span class="hljs-keyword">self</span>)
    }
}
</code></pre>
<p>æ‰€ä»¥ä½ åªéœ€è¦å®ç° <code>TryFrom</code>ï¼Œå°±èƒ½å…è´¹è·å¾— <code>TryInto</code>ã€‚</p>
<blockquote>
<p><strong>ä»€ä¹ˆæ˜¯ blanket implementationï¼Ÿ</strong>
è¿™æ˜¯ Rust çš„ä¸€ç§æ³›å‹å®ç°æŠ€å·§ï¼šä¸ºæ‰€æœ‰æ»¡è¶³æŸä¸ªæ¡ä»¶çš„ç±»å‹è‡ªåŠ¨å®ç° traitã€‚è¿™é‡Œçš„æ¡ä»¶æ˜¯"U å®ç°äº† TryFrom"ï¼Œé‚£ä¹ˆ T å°±è‡ªåŠ¨è·å¾— TryIntoã€‚è¿™æ ·é¿å…äº†é‡å¤ä»£ç ï¼Œä¹Ÿä¿è¯äº† TryFrom å’Œ TryInto çš„è¡Œä¸ºä¸€è‡´ã€‚</p>
</blockquote>
<h2 data-id="heading-7">3. è‡ªå®šä¹‰å®ç°</h2>
<h3 data-id="heading-8">åœºæ™¯ 1ï¼šèŒƒå›´æ£€æŸ¥</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> std::convert::TryFrom;

<span class="hljs-comment">// è‡ªå®šä¹‰ç±»å‹ï¼š1-100 çš„åˆ†æ•°</span>
<span class="hljs-comment">// ç”¨ newtype æ¨¡å¼åŒ…è£… u8ï¼Œæ·»åŠ ä¸šåŠ¡çº¦æŸ</span>
<span class="hljs-meta">#[derive(Debug, PartialEq)]</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Score</span>(<span class="hljs-type">u8</span>);

<span class="hljs-comment">// ä¸º Score å®ç° TryFrom&lt;u8&gt;</span>
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">TryFrom</span>&lt;<span class="hljs-type">u8</span>&gt; <span class="hljs-keyword">for</span> <span class="hljs-title class_">Score</span> {
    <span class="hljs-comment">// é”™è¯¯ç±»å‹ï¼šç”¨é™æ€å­—ç¬¦ä¸²ï¼Œç®€å•ç›´æ¥</span>
    <span class="hljs-keyword">type</span> <span class="hljs-title class_">Error</span> = &amp;<span class="hljs-symbol">'static</span> <span class="hljs-type">str</span>;

    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">try_from</span>(value: <span class="hljs-type">u8</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-keyword">Self</span>, <span class="hljs-keyword">Self</span>::Error&gt; {
        <span class="hljs-comment">// éªŒè¯èŒƒå›´ï¼šåˆ†æ•°å¿…é¡»åœ¨ 1-100 ä¹‹é—´</span>
        <span class="hljs-keyword">if</span> value &gt;= <span class="hljs-number">1</span> &amp;&amp; value &lt;= <span class="hljs-number">100</span> {
            <span class="hljs-comment">// éªŒè¯é€šè¿‡ï¼šåˆ›å»º Score å®ä¾‹</span>
            <span class="hljs-title function_ invoke__">Ok</span>(<span class="hljs-title function_ invoke__">Score</span>(value))
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// éªŒè¯å¤±è´¥ï¼šè¿”å›é”™è¯¯ä¿¡æ¯</span>
            <span class="hljs-title function_ invoke__">Err</span>(<span class="hljs-string">"åˆ†æ•°å¿…é¡»åœ¨ 1-100 ä¹‹é—´"</span>)
        }
    }
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-comment">// æˆåŠŸï¼š85 åœ¨æœ‰æ•ˆèŒƒå›´å†…</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">score</span> = Score::<span class="hljs-title function_ invoke__">try_from</span>(<span class="hljs-number">85</span>).<span class="hljs-title function_ invoke__">unwrap</span>();
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"åˆ†æ•°: {}"</span>, score.<span class="hljs-number">0</span>);  <span class="hljs-comment">// 85</span>

    <span class="hljs-comment">// å¤±è´¥ï¼š0 å¤ªå°</span>
    <span class="hljs-keyword">match</span> Score::<span class="hljs-title function_ invoke__">try_from</span>(<span class="hljs-number">0</span>) {
        <span class="hljs-title function_ invoke__">Ok</span>(_) =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æˆåŠŸ"</span>),
        <span class="hljs-title function_ invoke__">Err</span>(e) =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"é”™è¯¯: {}"</span>, e),  <span class="hljs-comment">// é”™è¯¯: åˆ†æ•°å¿…é¡»åœ¨ 1-100 ä¹‹é—´</span>
    }

    <span class="hljs-comment">// å¤±è´¥ï¼š101 å¤ªå¤§</span>
    <span class="hljs-keyword">match</span> Score::<span class="hljs-title function_ invoke__">try_from</span>(<span class="hljs-number">101</span>) {
        <span class="hljs-title function_ invoke__">Ok</span>(_) =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æˆåŠŸ"</span>),
        <span class="hljs-title function_ invoke__">Err</span>(e) =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"é”™è¯¯: {}"</span>, e),  <span class="hljs-comment">// é”™è¯¯: åˆ†æ•°å¿…é¡»åœ¨ 1-100 ä¹‹é—´</span>
    }
}
</code></pre>
<h3 data-id="heading-9">åœºæ™¯ 2ï¼šå­—ç¬¦ä¸²è§£æ</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> std::convert::TryFrom;

<span class="hljs-comment">// è‡ªå®šä¹‰ç±»å‹ï¼šé‚®ç®±åœ°å€</span>
<span class="hljs-comment">// ç”¨ newtype åŒ…è£… Stringï¼Œç¡®ä¿åªèƒ½å­˜å‚¨æœ‰æ•ˆé‚®ç®±</span>
<span class="hljs-meta">#[derive(Debug)]</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Email</span>(<span class="hljs-type">String</span>);

<span class="hljs-comment">// ä¸º Email å®ç° TryFrom&lt;String&gt;</span>
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">TryFrom</span>&lt;<span class="hljs-type">String</span>&gt; <span class="hljs-keyword">for</span> <span class="hljs-title class_">Email</span> {
    <span class="hljs-keyword">type</span> <span class="hljs-title class_">Error</span> = &amp;<span class="hljs-symbol">'static</span> <span class="hljs-type">str</span>;

    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">try_from</span>(value: <span class="hljs-type">String</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-keyword">Self</span>, <span class="hljs-keyword">Self</span>::Error&gt; {
        <span class="hljs-comment">// ç®€å•éªŒè¯ï¼šæ£€æŸ¥æ˜¯å¦åŒ…å« @ å’Œ .</span>
        <span class="hljs-comment">// å®é™…é¡¹ç›®ä¸­åº”è¯¥ç”¨æ­£åˆ™è¡¨è¾¾å¼æˆ–ä¸“é—¨çš„é‚®ç®±éªŒè¯åº“</span>
        <span class="hljs-keyword">if</span> value.<span class="hljs-title function_ invoke__">contains</span>(<span class="hljs-string">'@'</span>) &amp;&amp; value.<span class="hljs-title function_ invoke__">contains</span>(<span class="hljs-string">'.'</span>) {
            <span class="hljs-comment">// éªŒè¯é€šè¿‡ï¼šåˆ›å»º Email å®ä¾‹</span>
            <span class="hljs-title function_ invoke__">Ok</span>(<span class="hljs-title function_ invoke__">Email</span>(value))
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// éªŒè¯å¤±è´¥ï¼šè¿”å›é”™è¯¯ä¿¡æ¯</span>
            <span class="hljs-title function_ invoke__">Err</span>(<span class="hljs-string">"æ— æ•ˆçš„é‚®ç®±æ ¼å¼"</span>)
        }
    }
}

<span class="hljs-comment">// ä¹Ÿæ”¯æŒ &amp;strï¼šæ–¹ä¾¿è°ƒç”¨è€…ä¼ å­—ç¬¦ä¸²å­—é¢é‡</span>
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">TryFrom</span>&lt;&amp;<span class="hljs-type">str</span>&gt; <span class="hljs-keyword">for</span> <span class="hljs-title class_">Email</span> {
    <span class="hljs-keyword">type</span> <span class="hljs-title class_">Error</span> = &amp;<span class="hljs-symbol">'static</span> <span class="hljs-type">str</span>;

    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">try_from</span>(value: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-keyword">Self</span>, <span class="hljs-keyword">Self</span>::Error&gt; {
        <span class="hljs-comment">// å¤ç”¨ TryFrom&lt;String&gt; çš„å®ç°</span>
        <span class="hljs-comment">// å…ˆæŠŠ &amp;str è½¬æˆ Stringï¼Œå†è°ƒç”¨ä¸Šé¢çš„ try_from</span>
        Email::<span class="hljs-title function_ invoke__">try_from</span>(value.<span class="hljs-title function_ invoke__">to_string</span>())
    }
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-comment">// æˆåŠŸï¼šæœ‰æ•ˆçš„é‚®ç®±æ ¼å¼</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">email</span> = Email::<span class="hljs-title function_ invoke__">try_from</span>(<span class="hljs-string">"user@example.com"</span>).<span class="hljs-title function_ invoke__">unwrap</span>();
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"é‚®ç®±: {}"</span>, email.<span class="hljs-number">0</span>);

    <span class="hljs-comment">// å¤±è´¥ï¼šç¼ºå°‘ @ å’Œ .</span>
    <span class="hljs-keyword">match</span> Email::<span class="hljs-title function_ invoke__">try_from</span>(<span class="hljs-string">"invalid-email"</span>) {
        <span class="hljs-title function_ invoke__">Ok</span>(_) =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æˆåŠŸ"</span>),
        <span class="hljs-title function_ invoke__">Err</span>(e) =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"é”™è¯¯: {}"</span>, e),  <span class="hljs-comment">// é”™è¯¯: æ— æ•ˆçš„é‚®ç®±æ ¼å¼</span>
    }
}
</code></pre>
<h3 data-id="heading-10">åœºæ™¯ 3ï¼šæšä¸¾è½¬æ¢</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> std::convert::TryFrom;

<span class="hljs-comment">// HTTP çŠ¶æ€ç æšä¸¾</span>
<span class="hljs-comment">// åªå®šä¹‰å¸¸ç”¨çš„å‡ ä¸ªçŠ¶æ€ç </span>
<span class="hljs-meta">#[derive(Debug, PartialEq)]</span>
<span class="hljs-keyword">enum</span> <span class="hljs-title class_">HttpStatus</span> {
    <span class="hljs-literal">Ok</span>,
    NotFound,
    InternalError,
}

<span class="hljs-comment">// ä¸º HttpStatus å®ç° TryFrom&lt;u16&gt;</span>
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">TryFrom</span>&lt;<span class="hljs-type">u16</span>&gt; <span class="hljs-keyword">for</span> <span class="hljs-title class_">HttpStatus</span> {
    <span class="hljs-comment">// é”™è¯¯ç±»å‹ï¼šç”¨ Stringï¼Œå¯ä»¥åŒ…å«åŠ¨æ€ä¿¡æ¯</span>
    <span class="hljs-keyword">type</span> <span class="hljs-title class_">Error</span> = <span class="hljs-type">String</span>;

    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">try_from</span>(code: <span class="hljs-type">u16</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-keyword">Self</span>, <span class="hljs-keyword">Self</span>::Error&gt; {
        <span class="hljs-comment">// ç”¨ match åŒ¹é…å·²çŸ¥çš„çŠ¶æ€ç </span>
        <span class="hljs-keyword">match</span> code {
            <span class="hljs-comment">// 200ï¼šæˆåŠŸ</span>
            <span class="hljs-number">200</span> =&gt; <span class="hljs-title function_ invoke__">Ok</span>(HttpStatus::<span class="hljs-literal">Ok</span>),
            <span class="hljs-comment">// 404ï¼šæœªæ‰¾åˆ°</span>
            <span class="hljs-number">404</span> =&gt; <span class="hljs-title function_ invoke__">Ok</span>(HttpStatus::NotFound),
            <span class="hljs-comment">// 500ï¼šæœåŠ¡å™¨é”™è¯¯</span>
            <span class="hljs-number">500</span> =&gt; <span class="hljs-title function_ invoke__">Ok</span>(HttpStatus::InternalError),
            <span class="hljs-comment">// å…¶ä»–çŠ¶æ€ç ï¼šä¸æ”¯æŒï¼Œè¿”å›é”™è¯¯</span>
            <span class="hljs-comment">// ç”¨ format! å®ç”ŸæˆåŒ…å«å…·ä½“çŠ¶æ€ç çš„é”™è¯¯ä¿¡æ¯</span>
            _ =&gt; <span class="hljs-title function_ invoke__">Err</span>(<span class="hljs-built_in">format!</span>(<span class="hljs-string">"æœªçŸ¥çŠ¶æ€ç : {}"</span>, code)),
        }
    }
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-comment">// æˆåŠŸï¼šå·²çŸ¥çš„çŠ¶æ€ç </span>
    <span class="hljs-built_in">assert_eq!</span>(HttpStatus::<span class="hljs-title function_ invoke__">try_from</span>(<span class="hljs-number">200</span>), <span class="hljs-title function_ invoke__">Ok</span>(HttpStatus::<span class="hljs-literal">Ok</span>));
    <span class="hljs-built_in">assert_eq!</span>(HttpStatus::<span class="hljs-title function_ invoke__">try_from</span>(<span class="hljs-number">404</span>), <span class="hljs-title function_ invoke__">Ok</span>(HttpStatus::NotFound));

    <span class="hljs-comment">// å¤±è´¥ï¼šæœªçŸ¥çš„çŠ¶æ€ç </span>
    <span class="hljs-keyword">match</span> HttpStatus::<span class="hljs-title function_ invoke__">try_from</span>(<span class="hljs-number">999</span>) {
        <span class="hljs-title function_ invoke__">Ok</span>(_) =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æˆåŠŸ"</span>),
        <span class="hljs-title function_ invoke__">Err</span>(e) =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}"</span>, e),  <span class="hljs-comment">// æœªçŸ¥çŠ¶æ€ç : 999</span>
    }
}
</code></pre>
<h2 data-id="heading-11">4. å¸¸è§é™·é˜±</h2>
<h3 data-id="heading-12">é™·é˜± 1ï¼šå¿˜è®°å¤„ç†é”™è¯¯</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> std::convert::TryFrom;

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-comment">// é”™è¯¯ï¼å¯èƒ½ panic</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">value</span> = <span class="hljs-type">u8</span>::<span class="hljs-title function_ invoke__">try_from</span>(<span class="hljs-number">300i32</span>).<span class="hljs-title function_ invoke__">unwrap</span>();

    <span class="hljs-comment">// æ­£ç¡®ï¼šå¤„ç†é”™è¯¯</span>
    <span class="hljs-keyword">match</span> <span class="hljs-type">u8</span>::<span class="hljs-title function_ invoke__">try_from</span>(<span class="hljs-number">300i32</span>) {
        <span class="hljs-title function_ invoke__">Ok</span>(v) =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æˆåŠŸ: {}"</span>, v),
        <span class="hljs-title function_ invoke__">Err</span>(e) =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"è½¬æ¢å¤±è´¥: {:?}"</span>, e),
    }

    <span class="hljs-comment">// æˆ–è€…ç”¨ ? æ“ä½œç¬¦ä¼ æ’­é”™è¯¯</span>
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">convert</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">u8</span>, std::num::TryFromIntError&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">value</span> = <span class="hljs-type">u8</span>::<span class="hljs-title function_ invoke__">try_from</span>(<span class="hljs-number">300i32</span>)?;
        <span class="hljs-title function_ invoke__">Ok</span>(value)
    }
}
</code></pre>
<p><strong>ç†è§£</strong>ï¼š<code>try_from</code> è¿”å› <code>Result</code>ï¼Œå¿…é¡»å¤„ç†é”™è¯¯ï¼Œä¸è¦ç›´æ¥ <code>unwrap</code>ã€‚</p>
<h3 data-id="heading-13">é™·é˜± 2ï¼šTryInto éœ€è¦ç±»å‹æ ‡æ³¨</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> std::convert::TryInto;

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">n</span> = <span class="hljs-number">100i32</span>;

    <span class="hljs-comment">// é”™è¯¯ï¼ç¼–è¯‘å™¨ä¸çŸ¥é“è¦è½¬æˆä»€ä¹ˆç±»å‹</span>
    <span class="hljs-comment">// let result = n.try_into();</span>

    <span class="hljs-comment">// æ­£ç¡®ï¼šæ˜ç¡®æŒ‡å®šç›®æ ‡ç±»å‹</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">result</span>: <span class="hljs-type">Result</span>&lt;<span class="hljs-type">u8</span>, _&gt; = n.<span class="hljs-title function_ invoke__">try_into</span>();

    <span class="hljs-comment">// æˆ–è€…ç”¨ TryFromï¼Œä¸éœ€è¦æ ‡æ³¨</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">result</span> = <span class="hljs-type">u8</span>::<span class="hljs-title function_ invoke__">try_from</span>(n);

    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{:?}"</span>, result);
}
</code></pre>
<p><strong>ç†è§£</strong>ï¼šå’Œ <code>Into</code> ä¸€æ ·ï¼Œ<code>TryInto</code> å¯èƒ½æœ‰å¤šä¸ªç›®æ ‡ç±»å‹ï¼Œéœ€è¦æ˜ç¡®æŒ‡å®šã€‚</p>
<h3 data-id="heading-14">é™·é˜± 3ï¼šä¸è¦åœ¨ From é‡Œåšå¯èƒ½å¤±è´¥çš„è½¬æ¢</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// é”™è¯¯ï¼From ä¸åº”è¯¥ panic</span>
<span class="hljs-comment">// impl From&lt;i32&gt; for Score {</span>
<span class="hljs-comment">//     fn from(value: i32) -&gt; Self {</span>
<span class="hljs-comment">//         if value &lt; 1 || value &gt; 100 {</span>
<span class="hljs-comment">//             panic!("åˆ†æ•°è¶…å‡ºèŒƒå›´");  // ä¸ä¼˜é›…</span>
<span class="hljs-comment">//         }</span>
<span class="hljs-comment">//         Score(value as u8)</span>
<span class="hljs-comment">//     }</span>
<span class="hljs-comment">// }</span>

<span class="hljs-comment">// æ­£ç¡®ï¼šç”¨ TryFrom</span>
<span class="hljs-keyword">use</span> std::convert::TryFrom;

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Score</span>(<span class="hljs-type">u8</span>);

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">TryFrom</span>&lt;<span class="hljs-type">i32</span>&gt; <span class="hljs-keyword">for</span> <span class="hljs-title class_">Score</span> {
    <span class="hljs-keyword">type</span> <span class="hljs-title class_">Error</span> = &amp;<span class="hljs-symbol">'static</span> <span class="hljs-type">str</span>;

    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">try_from</span>(value: <span class="hljs-type">i32</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-keyword">Self</span>, <span class="hljs-keyword">Self</span>::Error&gt; {
        <span class="hljs-keyword">if</span> value &gt;= <span class="hljs-number">1</span> &amp;&amp; value &lt;= <span class="hljs-number">100</span> {
            <span class="hljs-title function_ invoke__">Ok</span>(<span class="hljs-title function_ invoke__">Score</span>(value <span class="hljs-keyword">as</span> <span class="hljs-type">u8</span>))
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-title function_ invoke__">Err</span>(<span class="hljs-string">"åˆ†æ•°å¿…é¡»åœ¨ 1-100 ä¹‹é—´"</span>)
        }
    }
}
</code></pre>
<p><strong>ç†è§£</strong>ï¼š<code>From</code> åº”è¯¥æ˜¯æ— é”™è½¬æ¢ï¼Œå¯èƒ½å¤±è´¥çš„è½¬æ¢ç”¨ <code>TryFrom</code>ã€‚</p>
<h3 data-id="heading-15">é™·é˜± 4ï¼šé”™è¯¯ç±»å‹å¤ªç®€å•</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// ä¸å¥½ï¼šé”™è¯¯ä¿¡æ¯ä¸å¤Ÿè¯¦ç»†</span>
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">TryFrom</span>&lt;<span class="hljs-type">i32</span>&gt; <span class="hljs-keyword">for</span> <span class="hljs-title class_">Score</span> {
    <span class="hljs-keyword">type</span> <span class="hljs-title class_">Error</span> = &amp;<span class="hljs-symbol">'static</span> <span class="hljs-type">str</span>;

    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">try_from</span>(value: <span class="hljs-type">i32</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-keyword">Self</span>, <span class="hljs-keyword">Self</span>::Error&gt; {
        <span class="hljs-keyword">if</span> value &gt;= <span class="hljs-number">1</span> &amp;&amp; value &lt;= <span class="hljs-number">100</span> {
            <span class="hljs-title function_ invoke__">Ok</span>(<span class="hljs-title function_ invoke__">Score</span>(value <span class="hljs-keyword">as</span> <span class="hljs-type">u8</span>))
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-title function_ invoke__">Err</span>(<span class="hljs-string">"æ— æ•ˆ"</span>)  <span class="hljs-comment">// å¤ªç®€å•äº†</span>
        }
    }
}

<span class="hljs-comment">// æ›´å¥½ï¼šæä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯</span>
<span class="hljs-meta">#[derive(Debug)]</span>
<span class="hljs-keyword">enum</span> <span class="hljs-title class_">ScoreError</span> {
    <span class="hljs-title function_ invoke__">TooSmall</span>(<span class="hljs-type">i32</span>),
    <span class="hljs-title function_ invoke__">TooLarge</span>(<span class="hljs-type">i32</span>),
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">TryFrom</span>&lt;<span class="hljs-type">i32</span>&gt; <span class="hljs-keyword">for</span> <span class="hljs-title class_">Score</span> {
    <span class="hljs-keyword">type</span> <span class="hljs-title class_">Error</span> = ScoreError;

    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">try_from</span>(value: <span class="hljs-type">i32</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-keyword">Self</span>, <span class="hljs-keyword">Self</span>::Error&gt; {
        <span class="hljs-keyword">if</span> value &lt; <span class="hljs-number">1</span> {
            <span class="hljs-title function_ invoke__">Err</span>(ScoreError::<span class="hljs-title function_ invoke__">TooSmall</span>(value))
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> value &gt; <span class="hljs-number">100</span> {
            <span class="hljs-title function_ invoke__">Err</span>(ScoreError::<span class="hljs-title function_ invoke__">TooLarge</span>(value))
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-title function_ invoke__">Ok</span>(<span class="hljs-title function_ invoke__">Score</span>(value <span class="hljs-keyword">as</span> <span class="hljs-type">u8</span>))
        }
    }
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">match</span> Score::<span class="hljs-title function_ invoke__">try_from</span>(<span class="hljs-number">150</span>) {
        <span class="hljs-title function_ invoke__">Ok</span>(_) =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æˆåŠŸ"</span>),
        <span class="hljs-title function_ invoke__">Err</span>(ScoreError::<span class="hljs-title function_ invoke__">TooLarge</span>(v)) =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"åˆ†æ•° {} å¤ªå¤§äº†"</span>, v),
        <span class="hljs-title function_ invoke__">Err</span>(ScoreError::<span class="hljs-title function_ invoke__">TooSmall</span>(v)) =&gt; <span class="hljs-built_in">println!</span>(<span class="hljs-string">"åˆ†æ•° {} å¤ªå°äº†"</span>, v),
    }
}
</code></pre>
<h2 data-id="heading-16">5. æœ€ä½³å®è·µ</h2>
<ol>
<li><strong>å¯èƒ½å¤±è´¥å°±ç”¨ TryFrom</strong>ï¼šä¸è¦åœ¨ <code>From</code> é‡Œ panic æˆ–è¿”å›é»˜è®¤å€¼</li>
<li><strong>æä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯</strong>ï¼šç”¨è‡ªå®šä¹‰é”™è¯¯ç±»å‹ï¼Œä¸è¦åªç”¨ <code>&amp;str</code></li>
<li><strong>ä¼˜å…ˆå®ç° TryFrom</strong>ï¼šè‡ªåŠ¨è·å¾— <code>TryInto</code>ï¼Œé¿å…é‡å¤ä»£ç </li>
</ol>
<h2 data-id="heading-17">æ€»ç»“</h2>
<ol>
<li><strong>TryFrom æ˜¯å¯èƒ½å¤±è´¥çš„ From</strong>ï¼šè¿”å› <code>Result</code>ï¼Œä¸ä¼š panic</li>
<li><strong>å®ç° TryFromï¼Œå…è´¹è·å¾— TryInto</strong>ï¼šåªéœ€å®ç°ä¸€ä¸ªï¼Œç¼–è¯‘å™¨è‡ªåŠ¨æä¾›å¦ä¸€ä¸ª</li>
<li><strong>æä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯</strong>ï¼šç”¨è‡ªå®šä¹‰é”™è¯¯ç±»å‹ï¼Œæ–¹ä¾¿è°ƒè¯•å’Œå¤„ç†</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Queue & Stackï¼šå®ç°æœºåˆ¶ä¸ä½¿ç”¨åœºæ™¯æ·±åº¦åˆ†æ]]></title>    <link>https://juejin.cn/post/7598057199962964019</link>    <guid>https://juejin.cn/post/7598057199962964019</guid>    <pubDate>2026-01-23T00:11:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598057199962964019" data-draft-id="7595994039108337700" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Queue &amp; Stackï¼šå®ç°æœºåˆ¶ä¸ä½¿ç”¨åœºæ™¯æ·±åº¦åˆ†æ"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-01-23T00:11:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SevenCoding"/> <meta itemprop="url" content="https://juejin.cn/user/3261615728242467"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Queue &amp; Stackï¼šå®ç°æœºåˆ¶ä¸ä½¿ç”¨åœºæ™¯æ·±åº¦åˆ†æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3261615728242467/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SevenCoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T00:11:44.000Z" title="Fri Jan 23 2026 00:11:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨Stack</h2>
<p>Javaå·²ä¸æ¨èä½¿ç”¨Stackï¼Œè€Œæ˜¯æ¨èä½¿ç”¨æ›´é«˜æ•ˆçš„ArrayDeque</p>
<h3 data-id="heading-1">ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨</h3>
<ul>
<li>
<p>æ€§èƒ½ä½ï¼šæ˜¯å› ä¸º Stack ç»§æ‰¿è‡ª Vectorï¼Œ è€Œ Vector åœ¨æ¯ä¸ªæ–¹æ³•ä¸­éƒ½åŠ äº†é”ã€‚ç”±äºéœ€è¦å…¼å®¹è€çš„é¡¹ç›®ï¼Œå¾ˆéš¾åœ¨åŸæœ‰çš„åŸºç¡€ä¸Šè¿›è¡Œä¼˜åŒ–ï¼Œå› æ­¤ Vector å°±è¢«æ·˜æ±°æ‰äº†ï¼Œä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.seven97.top%2Fjava%2Fcollection%2F02-collection1-arraylist.html" target="_blank" title="https://www.seven97.top/java/collection/02-collection1-arraylist.html" ref="nofollow noopener noreferrer">ArrayList</a> å’Œ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.seven97.top%2Fjava%2Fcollection%2F04-juc1-copyonwritearrayList.html" target="_blank" title="https://www.seven97.top/java/collection/04-juc1-copyonwritearrayList.html" ref="nofollow noopener noreferrer">CopyOnWriteArrayList</a> æ¥ä»£æ›¿ï¼Œå¦‚æœåœ¨éçº¿ç¨‹å®‰å…¨çš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨  <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.seven97.top%2Fjava%2Fcollection%2F02-collection1-arraylist.html" target="_blank" title="https://www.seven97.top/java/collection/02-collection1-arraylist.html" ref="nofollow noopener noreferrer">ArrayList</a>ï¼Œçº¿ç¨‹å®‰å…¨çš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.seven97.top%2Fjava%2Fcollection%2F04-juc1-copyonwritearrayList.html" target="_blank" title="https://www.seven97.top/java/collection/04-juc1-copyonwritearrayList.html" ref="nofollow noopener noreferrer">CopyOnWriteArrayList</a> ã€‚</p>
</li>
<li>
<p>ç ´åäº†åŸæœ‰çš„æ•°æ®ç»“æ„ï¼šæ ˆçš„å®šä¹‰æ˜¯åœ¨ä¸€ç«¯è¿›è¡Œ push å’Œ pop æ“ä½œï¼Œé™¤æ­¤ä¹‹å¤–ä¸åº”è¯¥åŒ…å«å…¶ä»– å…¥æ ˆå’Œå‡ºæ ˆ çš„æ–¹æ³•ï¼Œä½†æ˜¯ Stack ç»§æ‰¿è‡ª Vectorï¼Œä½¿å¾— Stack å¯ä»¥ä½¿ç”¨çˆ¶ç±» Vector å…¬æœ‰çš„æ–¹æ³•ã€‚</p>
</li>
</ul>
<h3 data-id="heading-2">ä¸ºä»€ä¹ˆç°åœ¨è¿˜åœ¨ç”¨</h3>
<p>ä½†æ˜¯ä¸ºä»€ä¹ˆè¿˜æœ‰å¾ˆå¤šäººåœ¨ä½¿ç”¨ Stackã€‚æ€»ç»“äº†ä¸€ä¸‹ä¸»è¦æœ‰ä¸¤ä¸ªåŸå› ã€‚</p>
<ul>
<li>
<p>JDK å®˜æ–¹æ˜¯ä¸æ¨èä½¿ç”¨ Stackï¼Œä¹‹æ‰€ä»¥è¿˜æœ‰å¾ˆå¤šäººåœ¨ä½¿ç”¨ï¼Œæ˜¯å› ä¸º JDK å¹¶æ²¡æœ‰åŠ  deprecation æ³¨è§£ï¼Œåªæ˜¯åœ¨æ–‡æ¡£å’Œæ³¨é‡Šä¸­å£°æ˜ä¸å»ºè®®ä½¿ç”¨ï¼Œä½†æ˜¯å¾ˆå°‘æœ‰äººä¼šå»å…³æ³¨å…¶å®ç°ç»†èŠ‚</p>
</li>
<li>
<p>åœ¨ç¬”è¯•é¢è¯•éœ€è¦åšç®—æ³•é¢˜çš„æ—¶å€™ï¼Œæ›´å¤šå…³æ³¨ç‚¹æ˜¯åœ¨è§£å†³é—®é¢˜çš„ç®—æ³•é€»è¾‘æ€è·¯ä¸Šï¼Œå¹¶ä¸ä¼šå…³æ³¨åœ¨ä¸åŒè¯­è¨€ä¸‹ Stack å®ç°ç»†èŠ‚ï¼Œä½†æ˜¯å¯¹äºä½¿ç”¨ Java è¯­è¨€çš„ä¸šåŠ¡å¼€å‘è€…ï¼Œä¸ä»…éœ€è¦å…³æ³¨ç®—æ³•é€»è¾‘æœ¬èº«ï¼Œä¹Ÿéœ€è¦å…³æ³¨å®ƒçš„å®ç°ç»†èŠ‚</p>
</li>
</ul>
<h3 data-id="heading-3">ä¸ºä»€ä¹ˆæ¨èä½¿ç”¨ Deque æ¥å£æ›¿æ¢æ ˆ</h3>
<p>å¦‚æœ JDK ä¸æ¨èä½¿ç”¨ Stackï¼Œé‚£åº”è¯¥ä½¿ç”¨ä»€ä¹ˆé›†åˆç±»æ¥æ›¿æ¢æ ˆï¼Œä¸€èµ·çœ‹çœ‹å®˜æ–¹çš„æ–‡æ¡£ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/21c727d14bed40d698eead42c3c9e250~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769731904&amp;x-signature=ajS7CfnZYqQ1mSSc3qH%2Fi0OkwlI%3D" alt="" loading="lazy"/></p>
<p>æ­£å¦‚å›¾ä¸­æ ‡æ³¨éƒ¨åˆ†æ‰€ç¤ºï¼Œæ ˆçš„ç›¸å…³æ“ä½œåº”è¯¥ç”± Deque æ¥å£æ¥æä¾›ï¼Œæ¨èä½¿ç”¨ Deque è¿™ç§æ•°æ®ç»“æ„ï¼Œ ä»¥åŠå®ƒçš„å­ç±»ï¼Œä¾‹å¦‚ ArrayDequeã€‚</p>
<pre><code class="hljs language-java" lang="java">val stack: Deque&lt;Int&gt; = ArrayDeque()
</code></pre>
<p>ä½¿ç”¨ Deque æ¥å£æ¥å®ç°æ ˆçš„åŠŸèƒ½æœ‰ä»€ä¹ˆå¥½å¤„ï¼š</p>
<ul>
<li>é€Ÿåº¦æ¯” Stack å¿«</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8cafeff69c834181b78b473ddc12d0d2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769731904&amp;x-signature=4KMW8wmo9SPEPwDOQlFHatuqHNM%3D" alt="" loading="lazy"/></p>
<p>è¿™ä¸ªç±»ä½œä¸ºæ ˆä½¿ç”¨æ—¶å¯èƒ½æ¯” Stack å¿«ï¼Œä½œä¸ºé˜Ÿåˆ—ä½¿ç”¨æ—¶å¯èƒ½æ¯” LinkedList å¿«ã€‚å› ä¸ºåŸæ¥çš„ Java çš„ Stack ç»§æ‰¿è‡ª Vectorï¼Œè€Œ Vector åœ¨æ¯ä¸ªæ–¹æ³•ä¸­éƒ½åŠ äº†é”ï¼Œè€Œ Deque çš„å­ç±» ArrayDeque å¹¶æ²¡æœ‰é”çš„å¼€é”€ã€‚</p>
<ul>
<li>å±è”½æ‰æ— å…³çš„æ–¹æ³•</li>
</ul>
<p>åŸæ¥çš„ Java çš„ Stackï¼ŒåŒ…å«äº†åœ¨ä»»ä½•ä½ç½®æ·»åŠ æˆ–è€…åˆ é™¤å…ƒç´ çš„æ–¹æ³•ï¼Œè¿™äº›ä¸æ˜¯æ ˆåº”è¯¥æœ‰çš„æ–¹æ³•ï¼Œæ‰€ä»¥éœ€è¦å±è”½æ‰è¿™äº›æ— å…³çš„æ–¹æ³•ã€‚å£°æ˜ä¸º Deque æ¥å£å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨æ¥å£ä¸­å£°æ˜æ ˆéœ€è¦ç”¨åˆ°çš„æ–¹æ³•ï¼Œæ— éœ€ç®¡å­ç±»æ˜¯å¦‚ä½•æ˜¯å®ç°çš„ï¼Œå¯¹äºä¸Šå±‚ä½¿ç”¨è€…æ¥è¯´ï¼Œåªå¯ä»¥è°ƒç”¨å’Œæ ˆç›¸å…³çš„æ–¹æ³•ã€‚</p>
<h3 data-id="heading-4">Stack å’Œ ArrayDequeçš„ åŒºåˆ«</h3>




















<table><thead><tr><th>é›†åˆç±»å‹</th><th>æ•°æ®ç»“æ„</th><th>æ˜¯å¦çº¿ç¨‹å®‰å…¨</th></tr></thead><tbody><tr><td>Stack</td><td>æ•°ç»„</td><td>æ˜¯</td></tr><tr><td>ArrayDeque</td><td>æ•°ç»„</td><td>å¦</td></tr></tbody></table>
<p>Stack å¸¸ç”¨çš„æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p>





















<table><thead><tr><th>æ“ä½œ</th><th>æ–¹æ³•</th></tr></thead><tbody><tr><td>å…¥æ ˆ</td><td>push(E  item)</td></tr><tr><td>å‡ºæ ˆ</td><td>pop()</td></tr><tr><td>æŸ¥çœ‹æ ˆé¡¶</td><td>peek() ä¸ºç©ºæ—¶è¿”å› null</td></tr></tbody></table>
<p>ArrayDeque å¸¸ç”¨çš„æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p>





















<table><thead><tr><th>æ“ä½œ</th><th>æ–¹æ³•</th></tr></thead><tbody><tr><td>å…¥æ ˆ</td><td>push(E  item)</td></tr><tr><td>å‡ºæ ˆ</td><td>poll() æ ˆä¸ºç©ºæ—¶è¿”å›    nullpop() æ ˆä¸ºç©ºæ—¶ä¼šæŠ›å‡ºå¼‚å¸¸</td></tr><tr><td>æŸ¥çœ‹æ ˆé¡¶</td><td>peek() ä¸ºç©ºæ—¶è¿”å› null</td></tr></tbody></table>
<h2 data-id="heading-5">Queueä»‹ç»</h2>
<p>Javaé‡Œæœ‰ä¸€ä¸ªå«åšStackçš„ç±»ï¼Œå´æ²¡æœ‰å«åšQueueçš„ç±»(å®ƒæ˜¯ä¸ªæ¥å£åå­—)ã€‚å½“éœ€è¦ä½¿ç”¨æ ˆæ—¶ï¼ŒJavaå·²ä¸æ¨èä½¿ç”¨Stackï¼Œè€Œæ˜¯æ¨èä½¿ç”¨æ›´é«˜æ•ˆçš„ArrayDequeï¼›æ—¢ç„¶Queueåªæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå½“éœ€è¦ä½¿ç”¨é˜Ÿåˆ—æ—¶ä¹Ÿå°±é¦–é€‰ArrayDequeäº†(æ¬¡é€‰æ˜¯LinkedList)ã€‚</p>
<h3 data-id="heading-6">Queue</h3>
<p>Queueæ¥å£ç»§æ‰¿è‡ªCollectionæ¥å£ï¼Œé™¤äº†æœ€åŸºæœ¬çš„Collectionçš„æ–¹æ³•ä¹‹å¤–ï¼Œå®ƒè¿˜æ”¯æŒé¢å¤–çš„insertion, extractionå’Œinspectionæ“ä½œã€‚è¿™é‡Œæœ‰ä¸¤ç»„æ ¼å¼ï¼Œå…±6ä¸ªæ–¹æ³•ï¼Œä¸€ç»„æ˜¯æŠ›å‡ºå¼‚å¸¸çš„å®ç°ï¼›å¦å¤–ä¸€ç»„æ˜¯è¿”å›å€¼çš„å®ç°(æ²¡æœ‰åˆ™è¿”å›null)ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4975661c1d714d42896dc4c43380685f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769731904&amp;x-signature=G1vvpeeImspJSytioURHRrLZ2QE%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-7">Deque</h3>
<p>Deque æ˜¯"double ended queue", è¡¨ç¤ºåŒå‘çš„é˜Ÿåˆ—ï¼Œè‹±æ–‡è¯»ä½œ"deck". Deque ç»§æ‰¿è‡ª Queueæ¥å£ï¼Œé™¤äº†æ”¯æŒQueueçš„æ–¹æ³•ä¹‹å¤–ï¼Œè¿˜æ”¯æŒ insert , remove å’Œ examineæ“ä½œï¼Œç”±äºDequeæ˜¯åŒå‘çš„ï¼Œæ‰€ä»¥å¯ä»¥å¯¹é˜Ÿåˆ—çš„å¤´å’Œå°¾éƒ½è¿›è¡Œæ“ä½œï¼Œå®ƒåŒæ—¶ä¹Ÿæ”¯æŒä¸¤ç»„æ ¼å¼ï¼Œä¸€ç»„æ˜¯æŠ›å‡ºå¼‚å¸¸çš„å®ç°ï¼›å¦å¤–ä¸€ç»„æ˜¯è¿”å›å€¼çš„å®ç°(æ²¡æœ‰åˆ™è¿”å›null)ã€‚å…±12ä¸ªæ–¹æ³•å¦‚ä¸‹:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a1cb37c2dbf94757857940702b96961d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769731904&amp;x-signature=1%2Fyj0qH1oeBnMAcgEeDezvHEQBM%3D" alt="" loading="lazy"/></p>
<p>å½“æŠŠ Deque å½“åšFIFOçš„ queue æ¥ä½¿ç”¨æ—¶ï¼Œå…ƒç´ æ˜¯ä» deque çš„å°¾éƒ¨æ·»åŠ ï¼Œä»å¤´éƒ¨è¿›è¡Œåˆ é™¤çš„ï¼› æ‰€ä»¥ deque çš„éƒ¨åˆ†æ–¹æ³•æ˜¯å’Œ queue æ˜¯ç­‰åŒçš„ã€‚å…·ä½“å¦‚ä¸‹:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e9012c0052a04306be7442aa48f946b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769731904&amp;x-signature=SP4NaZN4Yhj%2B1JRDOAH%2FGqMQvH4%3D" alt="" loading="lazy"/></p>
<p>Dequeçš„å«ä¹‰æ˜¯â€œdouble ended queueâ€ï¼Œå³åŒç«¯é˜Ÿåˆ—ï¼Œå®ƒæ—¢å¯ä»¥å½“ä½œæ ˆä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å½“ä½œé˜Ÿåˆ—ä½¿ç”¨ã€‚ä¸‹è¡¨åˆ—å‡ºäº†Dequeä¸Queueç›¸å¯¹åº”çš„æ¥å£:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/04d4712a50d64476a2ec1a516b493899~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769731904&amp;x-signature=ZAE%2FpeqhmsSdBtnp1Zcyx2a%2B01A%3D" alt="" loading="lazy"/></p>
<p>ä¸‹è¡¨åˆ—å‡ºäº†Dequeä¸Stackå¯¹åº”çš„æ¥å£:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af6101789a3842f1aba5a476304fd6ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769731904&amp;x-signature=BcoD%2Byf%2F3b5K8%2FeQRe%2BKJh4clO0%3D" alt="" loading="lazy"/></p>
<p>ä¸Šé¢ä¸¤ä¸ªè¡¨å…±å®šä¹‰äº†Dequeçš„12ä¸ªæ¥å£ã€‚æ·»åŠ ï¼Œåˆ é™¤ï¼Œå–å€¼éƒ½æœ‰ä¸¤å¥—æ¥å£ï¼Œå®ƒä»¬åŠŸèƒ½ç›¸åŒï¼ŒåŒºåˆ«æ˜¯å¯¹å¤±è´¥æƒ…å†µçš„å¤„ç†ä¸åŒã€‚ä¸€å¥—æ¥å£é‡åˆ°å¤±è´¥å°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¦ä¸€å¥—é‡åˆ°å¤±è´¥ä¼šè¿”å›ç‰¹æ®Šå€¼( false æˆ– null )ã€‚é™¤éæŸç§å®ç°å¯¹å®¹é‡æœ‰é™åˆ¶ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ·»åŠ æ“ä½œæ˜¯ä¸ä¼šå¤±è´¥çš„ã€‚è™½ç„¶Dequeçš„æ¥å£æœ‰12ä¸ªä¹‹å¤šï¼Œä½†æ— éå°±æ˜¯å¯¹å®¹å™¨çš„ä¸¤ç«¯è¿›è¡Œæ“ä½œï¼Œæˆ–æ·»åŠ ï¼Œæˆ–åˆ é™¤ï¼Œæˆ–æŸ¥çœ‹ã€‚</p>
<p>ArrayDequeå’ŒLinkedListæ˜¯Dequeçš„ä¸¤ä¸ªé€šç”¨å®ç°ï¼Œç”±äºå®˜æ–¹æ›´æ¨èä½¿ç”¨AarryDequeç”¨ä½œæ ˆå’Œé˜Ÿåˆ—ï¼ŒåŠ ä¹‹ä¸Šä¸€ç¯‡å·²ç»è®²è§£è¿‡LinkedListï¼Œæœ¬æ–‡å°†ç€é‡è®²è§£ArrayDequeçš„å…·ä½“å®ç°</p>
<p>ä»åå­—å¯ä»¥çœ‹å‡ºArrayDequeåº•å±‚é€šè¿‡æ•°ç»„å®ç°ï¼Œä¸ºäº†æ»¡è¶³å¯ä»¥åŒæ—¶åœ¨æ•°ç»„ä¸¤ç«¯æ’å…¥æˆ–åˆ é™¤å…ƒç´ çš„éœ€æ±‚ï¼Œè¯¥æ•°ç»„è¿˜å¿…é¡»æ˜¯å¾ªç¯çš„ï¼Œå³å¾ªç¯æ•°ç»„(circular array)ï¼Œä¹Ÿå°±æ˜¯è¯´æ•°ç»„çš„ä»»ä½•ä¸€ç‚¹éƒ½å¯èƒ½è¢«çœ‹ä½œèµ·ç‚¹æˆ–è€…ç»ˆç‚¹ã€‚ArrayDequeæ˜¯éçº¿ç¨‹å®‰å…¨çš„(not thread-safe)ï¼Œå½“å¤šä¸ªçº¿ç¨‹åŒæ—¶ä½¿ç”¨çš„æ—¶å€™ï¼Œéœ€è¦ç¨‹åºå‘˜æ‰‹åŠ¨åŒæ­¥ï¼›å¦å¤–ï¼Œè¯¥å®¹å™¨ä¸å…è®¸æ”¾å…¥ null å…ƒç´ ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e04a57935f3c4f5eaedbbd50b4d2b896~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769731904&amp;x-signature=CIIoWC3z%2BgpqzGue%2B30z0jR1KF8%3D" alt="" loading="lazy"/></p>
<p>ä¸Šå›¾ä¸­æˆ‘ä»¬çœ‹åˆ°ï¼Œ head æŒ‡å‘é¦–ç«¯ç¬¬ä¸€ä¸ªæœ‰æ•ˆå…ƒç´ ï¼Œ tail æŒ‡å‘å°¾ç«¯ç¬¬ä¸€ä¸ªå¯ä»¥æ’å…¥å…ƒç´ çš„ç©ºä½ã€‚å› ä¸ºæ˜¯å¾ªç¯æ•°ç»„ï¼Œæ‰€ä»¥ head ä¸ä¸€å®šæ€»ç­‰äº0ï¼Œ tail ä¹Ÿä¸ä¸€å®šæ€»æ˜¯æ¯” head å¤§ã€‚</p>
<h2 data-id="heading-8">æ–¹æ³•å‰–æ</h2>
<h3 data-id="heading-9">addFirst()</h3>
<p>addFirst(E e)çš„ä½œç”¨æ˜¯åœ¨Dequeçš„é¦–ç«¯æ’å…¥å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯åœ¨headçš„å‰é¢æ’å…¥å…ƒç´ ï¼Œåœ¨ç©ºé—´è¶³å¤Ÿä¸”ä¸‹æ ‡æ²¡æœ‰è¶Šç•Œçš„æƒ…å†µä¸‹ï¼Œåªéœ€è¦å°†elements[--head] = eå³å¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4090d77d7ac64450ae2e5110cd1e51ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769731904&amp;x-signature=V71CLT1UzZhqycOG1wCKjENMFCo%3D" alt="" loading="lazy"/></p>
<p>å®é™…éœ€è¦è€ƒè™‘:</p>
<ol>
<li>ç©ºé—´æ˜¯å¦å¤Ÿç”¨</li>
<li>ä¸‹æ ‡æ˜¯å¦è¶Šç•Œçš„é—®é¢˜</li>
</ol>
<p>ä¸Šå›¾ä¸­ï¼Œå¦‚æœheadä¸º0ä¹‹åæ¥ç€è°ƒç”¨addFirst()ï¼Œè™½ç„¶ç©ºä½™ç©ºé—´è¿˜å¤Ÿç”¨ï¼Œä½†headä¸º-1ï¼Œä¸‹æ ‡è¶Šç•Œäº†ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//addFirst(E e)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addFirst</span><span class="hljs-params">(E e)</span> {
    <span class="hljs-keyword">if</span> (e == <span class="hljs-literal">null</span>)<span class="hljs-comment">//ä¸å…è®¸æ”¾å…¥null</span>
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();
    elements[head = (head - <span class="hljs-number">1</span>) &amp; (elements.length - <span class="hljs-number">1</span>)] = e;<span class="hljs-comment">//2.ä¸‹æ ‡æ˜¯å¦è¶Šç•Œ</span>
    <span class="hljs-keyword">if</span> (head == tail)<span class="hljs-comment">//1.ç©ºé—´æ˜¯å¦å¤Ÿç”¨</span>
        doubleCapacity();<span class="hljs-comment">//æ‰©å®¹</span>
}
</code></pre>
<p>**ä¸Šè¿°ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œ ç©ºé—´é—®é¢˜æ˜¯åœ¨æ’å…¥ä¹‹åè§£å†³çš„ï¼›**é¦–å…ˆï¼Œå› ä¸ºtailæ€»æ˜¯æŒ‡å‘ä¸‹ä¸€ä¸ªå¯æ’å…¥çš„ç©ºä½ï¼Œä¹Ÿå°±æ„å‘³ç€elementsæ•°ç»„è‡³å°‘æœ‰ä¸€ä¸ªç©ºä½ï¼Œæ‰€ä»¥æ’å…¥å…ƒç´ çš„æ—¶å€™ä¸ç”¨è€ƒè™‘ç©ºé—´é—®é¢˜ã€‚</p>
<p>ä¸‹æ ‡è¶Šç•Œçš„å¤„ç†è§£å†³èµ·æ¥éå¸¸ç®€å•ï¼Œhead = (head - 1) &amp; (elements.length - 1)å°±å¯ä»¥äº†ï¼Œ<strong>è¿™æ®µä»£ç ç›¸å½“äºå–ä½™ï¼ŒåŒæ—¶è§£å†³äº†headä¸ºè´Ÿå€¼çš„æƒ…å†µ</strong>ã€‚å› ä¸ºelements.lengthå¿…éœ€æ˜¯2çš„æŒ‡æ•°å€ï¼Œelements - 1å°±æ˜¯äºŒè¿›åˆ¶ä½ä½å…¨1ï¼Œè·Ÿhead - 1ç›¸ä¸ä¹‹åå°±èµ·åˆ°äº†å–æ¨¡çš„ä½œç”¨ï¼Œå¦‚æœhead - 1ä¸ºè´Ÿæ•°(å…¶å®åªå¯èƒ½æ˜¯-1)ï¼Œåˆ™ç›¸å½“äºå¯¹å…¶å–ç›¸å¯¹äºelements.lengthçš„è¡¥ç ã€‚</p>
<blockquote>
<p>è®¡ç®—æœºé‡Œæ•°å€¼éƒ½æ˜¯ç”¨è¡¥ç è¡¨ç¤ºçš„ï¼Œå¦‚æœæ˜¯8ä½çš„ï¼Œ-1å°±æ˜¯1111 1111ï¼Œè€Œ (elements.length - 1) ä¹Ÿæ˜¯ 1111 1111ï¼Œå› æ­¤ä¸¤è€…ç›¸ä¸ä¹Ÿå°±æ˜¯(elements.length - 1)ï¼›</p>
</blockquote>
<blockquote>
<p>head = (head - 1) &amp; (elements.length - 1) æœ€åå†è®©ç®—å‡ºçš„ä½ç½®èµ‹å€¼ç»™headï¼Œå› æ­¤å…¶å®è¿™æ®µä»£ç å°±æ˜¯è®©headå†ä»åå¾€å‰èµ‹å€¼</p>
</blockquote>
<p>æ‰©å®¹å‡½æ•°doubleCapacity()ï¼Œå…¶é€»è¾‘æ˜¯ç”³è¯·ä¸€ä¸ªæ›´å¤§çš„æ•°ç»„(åŸæ•°ç»„çš„ä¸¤å€)ï¼Œç„¶åå°†åŸæ•°ç»„å¤åˆ¶è¿‡å»ã€‚è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤º:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7c14736901a6441cb36340a1189e63a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769731904&amp;x-signature=EG%2FNgKHRxjMcpHmTx8wcw57Rw6o%3D" alt="" loading="lazy"/></p>
<p>å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå¤åˆ¶åˆ†ä¸¤æ¬¡è¿›è¡Œï¼Œç¬¬ä¸€æ¬¡å¤åˆ¶headå³è¾¹çš„å…ƒç´ ï¼Œç¬¬äºŒæ¬¡å¤åˆ¶headå·¦è¾¹çš„å…ƒç´ ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//doubleCapacity()</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doubleCapacity</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">assert</span> head == tail;
    <span class="hljs-type">int</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> head;
    <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> elements.length;
    <span class="hljs-type">int</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> n - p; <span class="hljs-comment">// headå³è¾¹å…ƒç´ çš„ä¸ªæ•°</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">newCapacity</span> <span class="hljs-operator">=</span> n &lt;&lt; <span class="hljs-number">1</span>;<span class="hljs-comment">//åŸç©ºé—´çš„2å€</span>
    <span class="hljs-keyword">if</span> (newCapacity &lt; <span class="hljs-number">0</span>)
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(<span class="hljs-string">"Sorry, deque too big"</span>);
    Object[] a = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[newCapacity];
    System.arraycopy(elements, p, a, <span class="hljs-number">0</span>, r);<span class="hljs-comment">//å¤åˆ¶å³åŠéƒ¨åˆ†ï¼Œå¯¹åº”ä¸Šå›¾ä¸­ç»¿è‰²éƒ¨åˆ†</span>
    System.arraycopy(elements, <span class="hljs-number">0</span>, a, r, p);<span class="hljs-comment">//å¤åˆ¶å·¦åŠéƒ¨åˆ†ï¼Œå¯¹åº”ä¸Šå›¾ä¸­ç°è‰²éƒ¨åˆ†</span>
    elements = (E[])a;
    head = <span class="hljs-number">0</span>;
    tail = n;
}
</code></pre>
<h3 data-id="heading-10">addLast()</h3>
<p>addLast(E e)çš„ä½œç”¨æ˜¯åœ¨<strong>Deque</strong>çš„å°¾ç«¯æ’å…¥å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯åœ¨tailçš„ä½ç½®æ’å…¥å…ƒç´ ï¼Œç”±äºtailæ€»æ˜¯æŒ‡å‘ä¸‹ä¸€ä¸ªå¯ä»¥æ’å…¥çš„ç©ºä½ï¼Œå› æ­¤åªéœ€è¦elements[tail] = e;å³å¯ã€‚æ’å…¥å®Œæˆåå†æ£€æŸ¥ç©ºé—´ï¼Œå¦‚æœç©ºé—´å·²ç»ç”¨å…‰ï¼Œåˆ™è°ƒç”¨doubleCapacity()è¿›è¡Œæ‰©å®¹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c7f1f8f4eda14c998d3023310928dc01~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769731904&amp;x-signature=GeCtC5oeeLny8kdH4gwcMC4H1go%3D" alt="" loading="lazy"/></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addLast</span><span class="hljs-params">(E e)</span> {
    <span class="hljs-keyword">if</span> (e == <span class="hljs-literal">null</span>)<span class="hljs-comment">//ä¸å…è®¸æ”¾å…¥null</span>
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();
    elements[tail] = e;<span class="hljs-comment">//èµ‹å€¼</span>
    <span class="hljs-keyword">if</span> ( (tail = (tail + <span class="hljs-number">1</span>) &amp; (elements.length - <span class="hljs-number">1</span>)) == head)<span class="hljs-comment">//ä¸‹æ ‡è¶Šç•Œå¤„ç†</span>
        doubleCapacity();<span class="hljs-comment">//æ‰©å®¹</span>
}
</code></pre>
<h3 data-id="heading-11">pollFirst()</h3>
<p>pollFirst()çš„ä½œç”¨æ˜¯åˆ é™¤å¹¶è¿”å›<strong>Deque</strong>é¦–ç«¯å…ƒç´ ï¼Œä¹Ÿå³æ˜¯headä½ç½®å¤„çš„å…ƒç´ ã€‚å¦‚æœå®¹å™¨ä¸ç©ºï¼Œåªéœ€è¦ç›´æ¥è¿”å›elements[head]å³å¯ï¼Œå½“ç„¶è¿˜éœ€è¦å¤„ç†ä¸‹æ ‡çš„é—®é¢˜ã€‚ç”±äºArrayDequeä¸­ä¸å…è®¸æ”¾å…¥nullï¼Œå½“elements[head] == nullæ—¶ï¼Œæ„å‘³ç€å®¹å™¨ä¸ºç©ºã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> E <span class="hljs-title function_">pollFirst</span><span class="hljs-params">()</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> head;
    <span class="hljs-type">E</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> elements[head];
    <span class="hljs-keyword">if</span> (result == <span class="hljs-literal">null</span>)<span class="hljs-comment">//nullå€¼æ„å‘³ç€dequeä¸ºç©º</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    elements[h] = <span class="hljs-literal">null</span>;<span class="hljs-comment">//let GC work</span>
    head = (head + <span class="hljs-number">1</span>) &amp; (elements.length - <span class="hljs-number">1</span>);<span class="hljs-comment">//ä¸‹æ ‡è¶Šç•Œå¤„ç†</span>
    <span class="hljs-keyword">return</span> result;
}
</code></pre>
<h3 data-id="heading-12">pollLast()</h3>
<p>pollLast()çš„ä½œç”¨æ˜¯åˆ é™¤å¹¶è¿”å›Dequeå°¾ç«¯å…ƒç´ ï¼Œä¹Ÿå³æ˜¯tailä½ç½®å‰é¢çš„é‚£ä¸ªå…ƒç´ ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> E <span class="hljs-title function_">pollLast</span><span class="hljs-params">()</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> (tail - <span class="hljs-number">1</span>) &amp; (elements.length - <span class="hljs-number">1</span>);<span class="hljs-comment">//tailçš„ä¸Šä¸€ä¸ªä½ç½®æ˜¯æœ€åä¸€ä¸ªå…ƒç´ </span>
    <span class="hljs-type">E</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> elements[t];
    <span class="hljs-keyword">if</span> (result == <span class="hljs-literal">null</span>)<span class="hljs-comment">//nullå€¼æ„å‘³ç€dequeä¸ºç©º</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    elements[t] = <span class="hljs-literal">null</span>;<span class="hljs-comment">//let GC work</span>
    tail = t;
    <span class="hljs-keyword">return</span> result;
}
</code></pre>
<h3 data-id="heading-13">peekFirst()</h3>
<p>peekFirst()çš„ä½œç”¨æ˜¯è¿”å›ä½†ä¸åˆ é™¤<strong>Deque</strong>é¦–ç«¯å…ƒç´ ï¼Œä¹Ÿå³æ˜¯headä½ç½®å¤„çš„å…ƒç´ ï¼Œç›´æ¥è¿”å›elements[head]å³å¯ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> E <span class="hljs-title function_">peekFirst</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> elements[head]; <span class="hljs-comment">// elements[head] is null if deque empty</span>
}
</code></pre>
<h3 data-id="heading-14">peekLast()</h3>
<p>peekLast()çš„ä½œç”¨æ˜¯è¿”å›ä½†ä¸åˆ é™¤<strong>Deque</strong>å°¾ç«¯å…ƒç´ ï¼Œä¹Ÿå³æ˜¯tailä½ç½®å‰é¢çš„é‚£ä¸ªå…ƒç´ ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> E <span class="hljs-title function_">peekLast</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> elements[(tail - <span class="hljs-number">1</span>) &amp; (elements.length - <span class="hljs-number">1</span>)];
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¿˜åœ¨ç”¨forå¾ªç¯ï¼ŸJavaScriptæ•°ç»„æ“ä½œçš„3ä¸ªé«˜æ•ˆæ›¿ä»£æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7598089234033016832</link>    <guid>https://juejin.cn/post/7598089234033016832</guid>    <pubDate>2026-01-23T00:18:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598089234033016832" data-draft-id="7598055483633860608" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¿˜åœ¨ç”¨forå¾ªç¯ï¼ŸJavaScriptæ•°ç»„æ“ä½œçš„3ä¸ªé«˜æ•ˆæ›¿ä»£æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-23T00:18:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¿˜åœ¨ç”¨forå¾ªç¯ï¼ŸJavaScriptæ•°ç»„æ“ä½œçš„3ä¸ªé«˜æ•ˆæ›¿ä»£æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T00:18:14.000Z" title="Fri Jan 23 2026 00:18:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>è¿˜åœ¨ç”¨forå¾ªç¯ï¼ŸJavaScriptæ•°ç»„æ“ä½œçš„3ä¸ªé«˜æ•ˆæ›¿ä»£æ–¹æ¡ˆ</strong></h2>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>åœ¨JavaScriptå¼€å‘ä¸­ï¼Œæ•°ç»„æ“ä½œæ˜¯æœ€å¸¸è§çš„ä»»åŠ¡ä¹‹ä¸€ã€‚ä¼ ç»Ÿä¸Šï¼Œè®¸å¤šå¼€å‘è€…ä¼šä½¿ç”¨<code>for</code>å¾ªç¯æ¥éå†å’Œæ“ä½œæ•°ç»„ï¼Œè™½ç„¶è¿™ç§æ–¹å¼ç®€å•ç›´æ¥ï¼Œä½†åœ¨ç°ä»£JavaScriptä¸­ï¼Œå®ƒå¾€å¾€æ˜¾å¾—å†—é•¿ä¸”ä¸å¤Ÿä¼˜é›…ã€‚éšç€ECMAScriptæ ‡å‡†çš„æ¼”è¿›ï¼ŒJavaScriptæä¾›äº†è®¸å¤šé«˜é˜¶æ•°ç»„æ–¹æ³•ï¼ˆå¦‚<code>map</code>ã€<code>filter</code>ã€<code>reduce</code>ç­‰ï¼‰ï¼Œè¿™äº›æ–¹æ³•ä¸ä»…ä»£ç æ›´ç®€æ´ï¼Œè€Œä¸”åœ¨å¯è¯»æ€§å’ŒåŠŸèƒ½æ€§ä¸Šéƒ½æœ‰æ˜¾è‘—ä¼˜åŠ¿ã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥æ¢è®¨3ç§é«˜æ•ˆçš„æ•°ç»„æ“ä½œæ›¿ä»£æ–¹æ¡ˆï¼Œå¸®åŠ©ä½ æ‘†è„±å¯¹<code>for</code>å¾ªç¯çš„ä¾èµ–ï¼Œå†™å‡ºæ›´ç°ä»£åŒ–ã€æ›´æ˜“ç»´æŠ¤çš„ä»£ç ã€‚æˆ‘ä»¬å°†ä»æ€§èƒ½ã€å¯è¯»æ€§å’Œé€‚ç”¨åœºæ™¯ç­‰å¤šä¸ªç»´åº¦è¿›è¡Œåˆ†æï¼Œå¹¶æä¾›å…·ä½“çš„ä»£ç ç¤ºä¾‹ã€‚</p>
<hr/>
<h2 data-id="heading-2">ä¸»ä½“</h2>
<h3 data-id="heading-3">1. <code>map()</code>ï¼šæ•°æ®è½¬æ¢çš„åˆ©å™¨</h3>
<h4 data-id="heading-4">ä¸ºä»€ä¹ˆé€‰æ‹©<code>map()</code>ï¼Ÿ</h4>
<p><code>map()</code>æ˜¯æ•°ç»„æ“ä½œä¸­æœ€å¸¸ç”¨çš„é«˜é˜¶å‡½æ•°ä¹‹ä¸€ï¼Œå®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†ä¸€ä¸ªæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ é€šè¿‡æŸç§è§„åˆ™æ˜ å°„ä¸ºå¦ä¸€ä¸ªå€¼ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ã€‚ä¸<code>for</code>å¾ªç¯ç›¸æ¯”ï¼Œ<code>map()</code>å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>å£°æ˜å¼ç¼–ç¨‹</strong>ï¼šä»£ç æ›´è´´è¿‘ä¸šåŠ¡é€»è¾‘ï¼Œè€Œä¸æ˜¯å…·ä½“çš„å®ç°ç»†èŠ‚ã€‚</li>
<li><strong>ä¸å¯å˜æ€§</strong>ï¼šä¸ä¼šä¿®æ”¹åŸæ•°ç»„ï¼Œç¬¦åˆå‡½æ•°å¼ç¼–ç¨‹çš„åŸåˆ™ã€‚</li>
<li><strong>é“¾å¼è°ƒç”¨</strong>ï¼šå¯ä»¥ä¸å…¶ä»–æ•°ç»„æ–¹æ³•ï¼ˆå¦‚<code>filter</code>ã€<code>reduce</code>ï¼‰æ— ç¼ç»“åˆã€‚</li>
</ul>
<h4 data-id="heading-5">æ€§èƒ½è€ƒé‡</h4>
<p>è™½ç„¶<code>map()</code>åœ¨æ€§èƒ½ä¸Šå¯èƒ½ç•¥é€Šäºé«˜åº¦ä¼˜åŒ–çš„<code>for</code>å¾ªç¯ï¼ˆå°¤å…¶æ˜¯åœ¨è¶…å¤§è§„æ¨¡æ•°æ®é›†æ—¶ï¼‰ï¼Œä½†åœ¨å¤§å¤šæ•°å®é™…åœºæ™¯ä¸­ï¼Œè¿™ç§å·®å¼‚å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚ç°ä»£JavaScriptå¼•æ“ï¼ˆå¦‚V8ï¼‰å¯¹é«˜é˜¶å‡½æ•°çš„ä¼˜åŒ–å·²ç»éå¸¸æˆç†Ÿã€‚</p>
<h4 data-id="heading-6">ç¤ºä¾‹ä»£ç </h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>];
<span class="hljs-comment">// forå¾ªç¯å®ç°</span>
<span class="hljs-keyword">const</span> squaredFor = [];
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; numbers.<span class="hljs-property">length</span>; i++) {
  squaredFor.<span class="hljs-title function_">push</span>(numbers[i] * numbers[i]);
}
<span class="hljs-comment">// mapå®ç°</span>
<span class="hljs-keyword">const</span> squaredMap = numbers.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">num</span> =&gt;</span> num * num);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(squaredMap); <span class="hljs-comment">// [1, 4, 9, 16]</span>
</code></pre>
<h3 data-id="heading-7">2. <code>filter()</code>ï¼šæ•°æ®ç­›é€‰çš„ä¼˜é›…æ–¹å¼</h3>
<h4 data-id="heading-8">ä¸ºä»€ä¹ˆé€‰æ‹©<code>filter()</code>ï¼Ÿ</h4>
<p><code>filter()</code>ç”¨äºä»æ•°ç»„ä¸­ç­›é€‰å‡ºç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªæ–°æ•°ç»„ã€‚ä¸æ‰‹åŠ¨ç¼–å†™<code>for</code>å¾ªç¯å’Œæ¡ä»¶åˆ¤æ–­ç›¸æ¯”ï¼š</p>
<ul>
<li><strong>è¯­ä¹‰åŒ–æ›´å¼º</strong>ï¼šç›´æ¥è¡¨è¾¾â€œç­›é€‰â€æ„å›¾ã€‚</li>
<li><strong>å‡å°‘å‰¯ä½œç”¨</strong>ï¼šä¸ä¼šæ„å¤–ä¿®æ”¹åŸæ•°ç»„æˆ–å…¶ä»–å˜é‡ã€‚</li>
</ul>
<h4 data-id="heading-9">é€‚ç”¨åœºæ™¯</h4>
<ul>
<li>ä»åˆ—è¡¨ä¸­ç§»é™¤æ— æ•ˆæˆ–ä¸éœ€è¦çš„æ•°æ®ã€‚</li>
<li>åŸºäºå¤æ‚æ¡ä»¶åŠ¨æ€è¿‡æ»¤æ•°æ®ï¼ˆå¦‚å¤šæ¡ä»¶ç»„åˆï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-10">ç¤ºä¾‹ä»£ç </h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> users = [
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'Bob'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">17</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'Charlie'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> }
];
<span class="hljs-comment">// forå¾ªç¯å®ç°</span>
<span class="hljs-keyword">const</span> adultsFor = [];
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; users.<span class="hljs-property">length</span>; i++) {
  <span class="hljs-keyword">if</span> (users[i].<span class="hljs-property">age</span> &gt;= <span class="hljs-number">18</span>) {
    adultsFor.<span class="hljs-title function_">push</span>(users[i]);
  }
}
<span class="hljs-comment">// filterå®ç°</span>
<span class="hljs-keyword">const</span> adultsFilter = users.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">user</span> =&gt;</span> user.<span class="hljs-property">age</span> &gt;= <span class="hljs-number">18</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(adultsFilter); <span class="hljs-comment">// [{ name: 'Alice', age: 25 }, { name: 'Charlie', age: }]</span>
</code></pre>
<h3 data-id="heading-11"><code>reduce()</code>ï¼šä»ç®€å•åˆ°å¤æ‚çš„èšåˆå·¥å…·</h3>
<h4 data-id="heading-12"><code>reduce()</code>çš„å¼ºå¤§ä¹‹å¤„</h4>
<p>å¦‚æœè¯´å…¶ä»–é«˜é˜¶å‡½æ•°æ˜¯â€œå•ä¸€èŒè´£â€çš„å·¥å…·ï¼Œé‚£ä¹ˆåˆ™æ˜¯ç‘å£«å†›åˆ€â€”â€”å®ƒèƒ½å®ç°å‡ ä¹ä»»ä½•å½¢å¼çš„èšåˆæ“ä½œé€šè¿‡ç´¯åŠ å™¨é€æ­¥å¤„ç†æ•°ç»„å…ƒç´ é€‚åˆä»¥ä¸‹åœºæ™¯ï¼š</p>
<ul>
<li>è®¡ç®—æ€»å’Œæˆ–å¹³å‡å€¼ã€‚</li>
<li>å°†å¤šç»´ç»“æ„æ‰“å¹³ï¼ˆæ‰å¹³åŒ–ï¼‰ã€‚</li>
<li>å®ç°ç±»ä¼¼äºçš„åŠŸèƒ½ä½†éœ€è¦æ›´çµæ´»çš„é€»è¾‘ã€‚</li>
</ul>
<h4 data-id="heading-13">vs forå¾ªç¯çš„å¯¹æ¯”ï¼š</h4>
<p>å°½ç®¡å¯ä»¥ç”¨æ¨¡æ‹Ÿæ‰€æœ‰è¡Œä¸ºä½†é€šå¸¸éœ€è¦æ›´å¤šä¸´æ—¶å˜é‡å’Œæ˜¾å¼çŠ¶æ€ç®¡ç†è€Œåˆ™å°†è¿™äº›ç»†èŠ‚å°è£…èµ·æ¥ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> orders = [
    { <span class="hljs-attr">product</span>: <span class="hljs-string">'Laptop'</span> price :<span class="hljs-number">1000</span>},
    { <span class="hljs-attr">product</span>: <span class="hljs-string">'Phone'</span>price :<span class="hljs-number">500</span>}, 
    <span class="hljs-attr">product</span>:<span class="hljs-string">'Tablet'</span>,price :<span class="hljs-number">300</span>}
];

<span class="hljs-comment">// For loop implementation </span>
<span class="hljs-keyword">let</span> totalPriceFor=<span class="hljs-number">0</span>;
orders.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">order</span>=&gt;</span>{
totalPriceFor+=order.<span class="hljs-property">price</span>;
});

<span class="hljs-comment">// Reduce implementation </span>
<span class="hljs-keyword">const</span> totalPriceReduce=orders.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">sumorder</span>)=&gt;</span>sum+order.<span class="hljs-property">price0</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(totalPriceReduce);<span class="hljs-comment">//1800 </span>
</code></pre>
<h2 data-id="heading-14">æ€»ç»“</h2>
<p>åœ¨ç°ä»£å¼€å‘ä¸­è¿‡åº¦ä¾èµ–ä¸ä»…ä¼šå¯¼è‡´ä»£ç å†—é•¿è¿˜å¯èƒ½å¼•å…¥æ½œåœ¨é”™è¯¯å¦‚è¶Šç•Œæˆ–å‰¯ä½œç”¨é—®é¢˜æœ¬æ–‡ä»‹ç»çš„ä¸‰ç§æ–¹æ³•æä¾›äº†æ›´æ¸…æ™°ä¸”åŠŸèƒ½ä¸°å¯Œçš„æ›¿ä»£æ–¹æ¡ˆï¼š</p>
<ol>
<li><strong>``</strong>:ä¸“æ³¨äºæ•°æ®è½¬æ¢ã€‚</li>
<li><strong>``</strong>:å¤„ç†æ¡ä»¶ç­›é€‰ã€‚</li>
<li><strong>``</strong>:è§£å†³å¤æ‚èšåˆé—®é¢˜ã€‚</li>
</ol>
<p>å°½ç®¡æ¯ç§æŠ€æœ¯éƒ½æœ‰å…¶é€‚ç”¨åœºæ™¯ä½†å®ƒä»¬å…±åŒç‚¹æ˜¯æå‡ä»£ç å¯è¯»æ€§å¹¶å‡å°‘ä½çº§é”™è¯¯é£é™©å½“ç„¶å¯¹äºæé«˜æ€§èƒ½éœ€æ±‚æˆ–ç‰¹æ®Šéå†é€»è¾‘ä»å¯èƒ½æ˜¯åˆç†é€‰æ‹©ä½†ç»å¤§å¤šæ•°æƒ…å†µä¸‹è¿™äº›é«˜é˜¶å‡½æ•°è¶³ä»¥èƒœä»»ä»»åŠ¡åŒæ—¶è®©ä»£ç æ›´åŠ ç®€æ´ä¼˜é›….</p>
<p>æœ€åè®°ä½æ²¡æœ‰ç»å¯¹"æœ€å¥½"çš„å·¥å…·åªæœ‰æœ€é€‚åˆå½“å‰é—®é¢˜çš„è§£å†³æ–¹æ¡ˆç†è§£æ¯ç§çš„ç‰¹æ€§æ‰èƒ½åœ¨å®é™…å¼€å‘ä¸­æ¸¸åˆƒæœ‰ä½™!</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Skills ä¸å»¶è¿ŸåŠ è½½å·¥å…·å®šä¹‰çš„ MCPï¼Œç›®å‰å“ªä¸ªæ›´é«˜æ•ˆã€ç¨³å®šå’Œå¯æ§ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7598023360732971018</link>    <guid>https://juejin.cn/post/7598023360732971018</guid>    <pubDate>2026-01-23T00:29:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598023360732971018" data-draft-id="7598021081987285043" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Skills ä¸å»¶è¿ŸåŠ è½½å·¥å…·å®šä¹‰çš„ MCPï¼Œç›®å‰å“ªä¸ªæ›´é«˜æ•ˆã€ç¨³å®šå’Œå¯æ§ï¼Ÿ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,LLM"/> <meta itemprop="datePublished" content="2026-01-23T00:29:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Baihai_IDP"/> <meta itemprop="url" content="https://juejin.cn/user/3123071228582343"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Skills ä¸å»¶è¿ŸåŠ è½½å·¥å…·å®šä¹‰çš„ MCPï¼Œç›®å‰å“ªä¸ªæ›´é«˜æ•ˆã€ç¨³å®šå’Œå¯æ§ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3123071228582343/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Baihai_IDP
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T00:29:05.000Z" title="Fri Jan 23 2026 00:29:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>ç¼–è€…æŒ‰ï¼š</strong> æˆ‘ä»¬ä»Šå¤©ä¸ºå¤§å®¶å¸¦æ¥çš„è¿™ç¯‡æ–‡ç« ï¼Œä½œè€…çš„æ ¸å¿ƒè§‚ç‚¹æ˜¯ï¼šç›¸è¾ƒäºä¾èµ–å¤æ‚ä¸”é«˜æˆæœ¬çš„åŠ¨æ€ MCP å·¥å…·åŠ è½½æœºåˆ¶ï¼Œä»¥ Skills ä¸ºæ ¸å¿ƒçš„èƒ½åŠ›æ‘˜è¦ä¸è‡ªç»´æŠ¤æ¨¡å¼ï¼Œåœ¨å½“å‰é˜¶æ®µåè€Œæ›´åŠ é«˜æ•ˆã€ç¨³å®šä¸”å¯æ§ã€‚</p>
<p>æ–‡ç« ç³»ç»Ÿæ¢³ç†äº†å»¶è¿Ÿå·¥å…·åŠ è½½ï¼ˆdeferred tool loadingï¼‰çš„å·¥ç¨‹ç°å®ä¸é™åˆ¶ï¼ŒæŒ‡å‡ºå³ä¾¿å·¥å…·å¯ä»¥å»¶åæ³¨å…¥ï¼Œå¯¹è¯çº§åˆ«çš„å·¥å…·é›†åˆä»ç„¶æ˜¯é™æ€çš„ï¼Œä¸”å‘ç°æœºåˆ¶é«˜åº¦ä¾èµ–æ­£åˆ™åŒ¹é…ï¼Œæ”¶ç›Šå¹¶ä¸å¦‚é¢„æœŸã€‚ä½œè€…è¿›ä¸€æ­¥æ·±å…¥åˆ†æäº† MCP åœ¨ä¸Šä¸‹æ–‡å ç”¨ã€API ç¨³å®šæ€§ã€ç¼“å­˜å¤±æ•ˆä¸æ¨ç†è½¨è¿¹ä¸¢å¤±ç­‰æ–¹é¢å¸¦æ¥çš„éšæ€§æˆæœ¬ï¼Œå¹¶ç»“åˆ Sentry MCPã€Playwright ç­‰å®è·µæ¡ˆä¾‹ï¼Œè¯´æ˜ä¸ºä½•å°† MCP è½¬æ¢ä¸º Skillsï¼Œåè€Œèƒ½è®© Agent æ›´å¥½åœ°å‘æŒ¥æ—¢æœ‰å·¥å…·çš„èƒ½åŠ›ã€‚æ–‡ç« æœ€åè¿˜æ¢è®¨äº† MCP æ˜¯å¦å¯èƒ½å®Œå…¨è½¬åŒ–ä¸º Skills çš„å¯è¡Œæ€§ï¼Œå¹¶å¦ç‡æŒ‡å‡ºå½“å‰åè®®ä¸ç”Ÿæ€åœ¨ç¨³å®šæ€§ä¸æ‘˜è¦æœºåˆ¶ä¸Šçš„ä¸è¶³ã€‚</p>
</blockquote>
<p><strong>ä½œè€… |</strong> <strong>Armin Ronacher</strong></p>
<p><strong>(ä½œè€…ä¸º Flaskã€Jinja2 ç­‰å¼€æºé¡¹ç›®çš„åˆ›å»ºè€…)</strong></p>
<p><strong>ç¼–è¯‘ | å²³æ‰¬</strong></p>
<p>æˆ‘æ­£æŠŠæ‰€æœ‰çš„ MCP éƒ½è¿ç§»åˆ° Skills ä¸Šï¼ŒåŒ…æ‹¬ä¹‹å‰è¿˜åœ¨ä½¿ç”¨çš„æœ€åä¸€ä¸ªï¼šSentry MCPï¼ˆè¯‘è€…æ³¨ï¼šSentry æ˜¯æµè¡Œçš„åº”ç”¨ç›‘æ§ä¸é”™è¯¯è¿½è¸ªå¹³å°ï¼‰ã€‚æ—©å‰æˆ‘å°±å·²ç»å®Œå…¨å¼ƒç”¨ Playwrightï¼ˆè¯‘è€…æ³¨ï¼šç”± Microsoft å¼€å‘çš„ç°ä»£ Web è‡ªåŠ¨åŒ–æµ‹è¯•å’Œæµè§ˆå™¨è‡ªåŠ¨åŒ–æ¡†æ¶ï¼‰ï¼Œè½¬å‘ä½¿ç”¨ Playwright Skillã€‚</p>
<p>è¿‡å»ä¸€ä¸ªæœˆå·¦å³ï¼Œå…³äºä½¿ç”¨â€œåŠ¨æ€å·¥å…·é…ç½®ï¼ˆdynamic tool loadoutsï¼‰[1]â€æ¥æ¨è¿Ÿå·¥å…·å®šä¹‰çš„åŠ è½½çš„è®¨è®ºä¸€ç›´ä¸å°‘ã€‚Anthropic ä¹Ÿåœ¨æ¢ç´¢é€šè¿‡ä»£ç æ¥ä¸²è” MCP è°ƒç”¨çš„æ€è·¯ï¼Œè¿™ä¸€ç‚¹æˆ‘ä¹Ÿå°è¯•è¿‡[2]ã€‚</p>
<p>æˆ‘æƒ³åˆ†äº«ä¸€ä¸‹è‡ªå·±åœ¨è¿™æ–¹é¢çš„æœ€æ–°å¿ƒå¾—ï¼Œä»¥åŠä¸ºä»€ä¹ˆ Anthropic æå‡ºçš„â€œå»¶è¿Ÿå·¥å…·åŠ è½½æ–¹æ¡ˆï¼ˆdeferred tool loadingï¼‰â€å¹¶æœªæ”¹å˜æˆ‘å¯¹ MCP çš„çœ‹æ³•ã€‚æˆ–è®¸è¿™äº›å†…å®¹å¯¹ä»–äººä¼šæœ‰æ‰€å¸®åŠ©ã€‚</p>
<h2 data-id="heading-0"><strong>01 ä»€ä¹ˆæ˜¯å·¥å…·ï¼ˆToolï¼‰ï¼Ÿ</strong></h2>
<p>å½“ Agent é€šè¿‡å¼ºåŒ–å­¦ä¹ æˆ–å…¶ä»–æ–¹å¼æ¥è§¦åˆ°å·¥å…·å®šä¹‰æ—¶ï¼Œå®ƒä¼šè¢«é¼“åŠ±åœ¨é‡åˆ°é€‚åˆä½¿ç”¨è¯¥å·¥å…·çš„åœºæ™¯æ—¶ï¼Œé€šè¿‡ç‰¹æ®Šçš„ token è¾“å‡ºå·¥å…·è°ƒç”¨ã€‚å®é™…ä¸Šï¼Œå·¥å…·å®šä¹‰åªèƒ½å‡ºç°åœ¨ç³»ç»Ÿæç¤ºè¯ï¼ˆsystem promptï¼‰ä¸­ç‰¹å®šçš„å·¥å…·å®šä¹‰ token ä¹‹é—´ã€‚ä»å†å²ç»éªŒæ¥çœ‹ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬æ— æ³•åœ¨å¯¹è¯çŠ¶æ€çš„ä¸­é€”åŠ¨æ€å‘å‡ºæ–°çš„å·¥å…·å®šä¹‰ã€‚å› æ­¤ï¼Œå”¯ä¸€çš„ç°å®é€‰æ‹©æ˜¯åœ¨å¯¹è¯å¼€å§‹æ—¶å°±å°†å·¥å…·åŠ è½½å¥½ã€‚</p>
<p>åœ¨æ™ºèƒ½ä½“åº”ç”¨åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å½“ç„¶å¯ä»¥éšæ—¶å‹ç¼©å¯¹è¯çŠ¶æ€ï¼Œæˆ–æ›´æ”¹ç³»ç»Ÿæ¶ˆæ¯ä¸­çš„å·¥å…·å®šä¹‰ã€‚ä½†è¿™æ ·åšçš„åæœæ˜¯ï¼Œæˆ‘ä»¬ä¼šä¸¢å¤±æ¨ç†è½¨è¿¹ï¼ˆreasoning tracesï¼‰ä»¥åŠç¼“å­˜ï¼ˆcacheï¼‰ã€‚ä»¥ Anthropic ä¸ºä¾‹ï¼Œè¿™å°†å¤§å¹…å¢åŠ å¯¹è¯æˆæœ¬ï¼šåŸºæœ¬ä¸Šå°±æ˜¯ä»å¤´å¼€å§‹ï¼Œç›¸æ¯”äºç¼“å­˜è¯»å–ï¼Œéœ€è¦æ”¯ä»˜å®Œæ•´çš„ token è´¹ç”¨ï¼Œå¤–åŠ ç¼“å­˜å†™å…¥æˆæœ¬ã€‚</p>
<p>Anthropic æœ€è¿‘çš„ä¸€é¡¹åˆ›æ–°æ˜¯â€œå»¶è¿Ÿå·¥å…·åŠ è½½â€ï¼ˆdeferred tool loadingï¼‰ã€‚æˆ‘ä»¬ä»ç„¶éœ€è¦æå‰åœ¨ç³»ç»Ÿæç¤ºè¯ï¼ˆsystem messageï¼‰ä¸­å£°æ˜å·¥å…·ï¼Œä½†è¿™äº›å·¥å…·ä¸ä¼šåœ¨ç³»ç»Ÿæç¤ºè¯å‘å‡ºæ—¶å°±æ³¨å…¥åˆ°å¯¹è¯ä¸­ï¼Œè€Œæ˜¯ä¼šç¨åæ‰å‡ºç°ã€‚ä¸è¿‡æ®æˆ‘æ‰€çŸ¥ï¼Œ<strong>è¿™äº›å·¥å…·å®šä¹‰åœ¨æ•´ä¸ªå¯¹è¯è¿‡ç¨‹ä¸­ä»å¿…é¡»æ˜¯é™æ€çš„ â€”â€” ä¹Ÿå°±æ˜¯è¯´ï¼Œå“ªäº›å·¥å…·å¯èƒ½å­˜åœ¨ï¼Œæ˜¯åœ¨å¯¹è¯å¼€å§‹æ—¶å°±ç¡®å®šå¥½çš„ã€‚</strong> Anthropic å‘ç°è¿™äº›å·¥å…·çš„æ–¹å¼ï¼Œçº¯ç²¹æ˜¯é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ï¼ˆregexï¼‰æœç´¢å®ç°çš„ã€‚</p>
<h2 data-id="heading-1"><strong>02 ä¸ Skills çš„å¯¹æ¯”</strong></h2>
<p>å°½ç®¡å¸¦å»¶è¿ŸåŠ è½½çš„ MCP æ„Ÿè§‰ä¸Šåº”è¯¥è¡¨ç°æ›´ä¼˜ï¼Œå®é™…ä¸Šå´éœ€è¦åœ¨ LLM API ç«¯åšä¸å°‘å·¥ç¨‹åŒ–å·¥ä½œã€‚è€Œ Skills ç³»ç»Ÿå®Œå…¨ä¸éœ€è¦è¿™äº›ï¼Œè‡³å°‘ä»æˆ‘çš„ç»éªŒæ¥çœ‹ï¼Œå…¶è¡¨ç°ä¾ç„¶æ›´èƒœä¸€ç­¹ã€‚</p>
<p><strong>Skills å®è´¨ä¸Šåªæ˜¯å¯¹ç°æœ‰èƒ½åŠ›åŠå…¶è¯´æ˜æ–‡ä»¶ä½ç½®çš„ç®€çŸ­æ‘˜è¦ã€‚è¿™äº›ä¿¡æ¯ä¼šè¢«ä¸»åŠ¨åŠ è½½åˆ°ä¸Šä¸‹æ–‡ä¸­ã€‚</strong> å› æ­¤ï¼Œæ™ºèƒ½ä½“èƒ½åœ¨ç³»ç»Ÿä¸Šä¸‹æ–‡é‡Œï¼ˆæˆ–ä¸Šä¸‹æ–‡çš„å…¶ä»–ä½ç½®ï¼‰çŸ¥æ™“è‡ªå·±å…·å¤‡å“ªäº›èƒ½åŠ›ï¼Œå¹¶è·çŸ¥å¦‚ä½•ä½¿ç”¨è¿™äº›èƒ½åŠ›çš„â€œæ‰‹å†Œé“¾æ¥â€ã€‚</p>
<p>å…³é”®åœ¨äºï¼Œ<strong>Skills å¹¶ä¸ä¼šçœŸæ­£æŠŠå·¥å…·å®šä¹‰åŠ è½½åˆ°ä¸Šä¸‹æ–‡ä¸­ã€‚</strong> å¯ç”¨å·¥å…·ä¿æŒä¸å˜ï¼šbash ä»¥åŠæ™ºèƒ½ä½“å·²æœ‰çš„å…¶ä»–å·¥å…·ã€‚Skills æ‰€èƒ½æä¾›çš„ï¼Œåªæ˜¯å¦‚ä½•æ›´é«˜æ•ˆä½¿ç”¨è¿™äº›å·¥å…·çš„æŠ€å·§å’Œæ–¹æ³•ã€‚</p>
<p>ç”±äº Skills ä¸»è¦æ•™çš„æ˜¯å¦‚ä½•ä½¿ç”¨å…¶ä»–å‘½ä»¤è¡Œå·¥å…·å’Œç±»ä¼¼å®ç”¨ç¨‹åºï¼Œå› æ­¤ç»„åˆä¸åè°ƒè¿™äº›å·¥å…·çš„åŸºæœ¬æ–¹å¼å…¶å®å¹¶æœªæ”¹å˜ã€‚è®© Claude ç³»åˆ—æ¨¡å‹æˆä¸ºä¼˜ç§€å·¥å…·è°ƒç”¨è€…çš„å¼ºåŒ–å­¦ä¹ æœºåˆ¶ï¼Œæ°å¥½èƒ½å¸®åŠ©å¤„ç†è¿™äº›æ–°å‘ç°çš„å·¥å…·ã€‚</p>
<h2 data-id="heading-2"><strong>03 MCP èƒ½å¦è½¬æ¢ä¸º Skillsï¼Ÿ</strong></h2>
<p>è¿™è‡ªç„¶å¼•å‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼šæ—¢ç„¶ Skills æ•ˆæœè¿™ä¹ˆå¥½ï¼Œæˆ‘èƒ½ä¸èƒ½æŠŠ MCP å®Œå…¨ç§»å‡ºä¸Šä¸‹æ–‡ï¼Œè½¬è€Œåƒ Anthropic æè®®çš„é‚£æ ·ï¼Œé€šè¿‡ CLI æ¥è°ƒç”¨å®ƒï¼Ÿç­”æ¡ˆæ˜¯ï¼šå¯ä»¥ï¼Œä½†æ•ˆæœå¹¶ä¸å¥½ã€‚Peter Steinberger çš„ mcporter[3]Â å°±æ˜¯å…¶ä¸­ä¸€ç§æ–¹æ¡ˆã€‚ç®€å•æ¥è¯´ï¼Œå®ƒä¼šè¯»å– .mcp.json æ–‡ä»¶ï¼Œå¹¶å°†èƒŒåçš„ MCP æš´éœ²ä¸ºå¯è°ƒç”¨çš„å·¥å…·ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">npx</span> <span class="hljs-selector-tag">mcporter</span> <span class="hljs-selector-tag">call</span>Â '<span class="hljs-selector-tag">linear</span><span class="hljs-selector-class">.create_comment</span>(<span class="hljs-attribute">issueId</span>: <span class="hljs-string">"ENG-123"</span>, <span class="hljs-attribute">body</span>: <span class="hljs-string">"Looks good!"</span>)'
</code></pre>
<p>ç¡®å®ï¼Œå®ƒçœ‹èµ·æ¥éå¸¸åƒä¸€ä¸ª LLM å¯ä»¥è°ƒç”¨çš„å‘½ä»¤è¡Œå·¥å…·ã€‚ä½†é—®é¢˜åœ¨äºï¼ŒLLM æ ¹æœ¬ä¸çŸ¥é“æœ‰å“ªäº›å·¥å…·å¯ç”¨ â€”â€” ç°åœ¨ä½ å¾—ä¸“é—¨æ•™å®ƒã€‚äºæ˜¯ä½ å¯èƒ½ä¼šæƒ³ï¼šé‚£ä¸ºä»€ä¹ˆä¸åˆ›å»ºä¸€äº› Skillsï¼Œæ¥æ•™ LLM äº†è§£è¿™äº› MCP å‘¢ï¼Ÿå¯¹æˆ‘è€Œè¨€ï¼Œè¿™é‡Œçš„é—®é¢˜åœ¨äºï¼š<strong>MCP æœåŠ¡å™¨æ ¹æœ¬æ²¡æœ‰ç»´æŒ API ç¨³å®šæ€§çš„æ„æ„¿ã€‚å®ƒä»¬è¶Šæ¥è¶Šå€¾å‘äºå°†å·¥å…·å®šä¹‰ç²¾ç®€åˆ°æè‡´ï¼Œåªä¸ºèŠ‚çœ tokenã€‚</strong> è¿™ç§åšæ³•æœ‰å…¶é“ç†ï¼Œä½†å¯¹ Skills æ¨¡å¼æ¥è¯´å´é€‚å¾—å…¶åã€‚ä¸¾ä¸ªä¾‹å­ï¼ŒSentry MCP æœåŠ¡å™¨æ›¾å½»åº•å°†æŸ¥è¯¢è¯­æ³•åˆ‡æ¢ä¸ºè‡ªç„¶è¯­è¨€ã€‚è¿™å¯¹ Agent æ¥è¯´æ˜¯ä¸€æ¬¡é‡å¤§æ”¹è¿›ï¼Œä½†æˆ‘ä¹‹å‰å…³äºå¦‚ä½•ä½¿ç”¨å®ƒçš„å»ºè®®åè€Œæˆäº†éšœç¢ï¼Œè€Œä¸”æˆ‘æ²¡èƒ½ç¬¬ä¸€æ—¶é—´å‘ç°é—®é¢˜ã€‚</p>
<p>è¿™å…¶å®å’Œ Anthropic çš„â€œå»¶è¿Ÿå·¥å…·åŠ è½½æ–¹æ¡ˆâ€éå¸¸ç›¸ä¼¼ï¼šä¸Šä¸‹æ–‡ä¸­å®Œå…¨æ²¡æœ‰ä»»ä½•å…³äºè¯¥å·¥å…·çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨åˆ›å»ºä¸€ä»½æ‘˜è¦ã€‚æˆ‘ä»¬è¿‡å»å¯¹ MCP å·¥å…·é‡‡ç”¨çš„é¢„åŠ è½½ï¼ˆeager loadingï¼‰æ–¹å¼ï¼Œå¦‚ä»Šé™·å…¥äº†ä¸€ä¸ªå°´å°¬çš„å±€é¢ï¼š<strong>æè¿°æ—¢å¤ªé•¿ï¼Œä¸ä¾¿é¢„åŠ è½½ï¼›åˆå¤ªçŸ­ï¼Œæ— æ³•çœŸæ­£æ•™ä¼š Agent å¦‚ä½•ä½¿ç”¨å®ƒä»¬ã€‚</strong> å› æ­¤ï¼Œè‡³å°‘ä»æˆ‘çš„ç»éªŒæ¥çœ‹ï¼Œä½ æœ€ç»ˆè¿˜æ˜¯å¾—ä¸ºé€šè¿‡ mcporter æˆ–ç±»ä¼¼æ–¹å¼æš´éœ²å‡ºæ¥çš„ MCP å·¥å…·ï¼Œæ‰‹åŠ¨ç»´æŠ¤è¿™äº› Skills æ‘˜è¦ã€‚</p>
<h2 data-id="heading-3"><strong>04 æœ€çœäº‹çš„è·¯çº¿</strong></h2>
<p>è¿™è®©æˆ‘å¾—å‡ºäº†ç›®å‰çš„ç»“è®ºï¼š<strong>æˆ‘å€¾å‘äºé€‰æ‹©æœ€çœäº‹çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯è®© Agent è‡ªå·±ä»¥â€œSkillsâ€çš„å½¢å¼ç¼–å†™æ‰€éœ€çš„å·¥å…·ã€‚</strong> è¿™æ ·åšä¸ä»…è€—æ—¶ä¸å¤šï¼Œæœ€å¤§çš„å¥½å¤„è¿˜åœ¨äºå·¥å…·åŸºæœ¬å¤„äºæˆ‘çš„æŒæ§ä¹‹ä¸­ã€‚æ¯å½“å®ƒå‡ºé—®é¢˜æˆ–éœ€è¦æ–°å¢åŠŸèƒ½æ—¶ï¼Œæˆ‘å°±è®© Agent å»è°ƒæ•´å®ƒã€‚Sentry MCP å°±æ˜¯ä¸ªå¾ˆå¥½çš„ä¾‹å­ â€”â€” æˆ‘è®¤ä¸ºå®ƒå¯èƒ½æ˜¯ç›®å‰è®¾è®¡å¾—æœ€å¥½çš„ MCP ä¹‹ä¸€ï¼Œä½†æˆ‘å·²ç»ä¸å†ä½¿ç”¨å®ƒäº†ã€‚ä¸€æ–¹é¢æ˜¯å› ä¸ºä¸€æ—¦åœ¨ä¸Šä¸‹æ–‡ä¸­ç«‹å³åŠ è½½å®ƒï¼Œå°±ä¼šç›´æ¥æ¶ˆè€—çº¦ 8k ä¸ª tokenï¼›å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä¹Ÿä¸€ç›´æ²¡èƒ½é€šè¿‡ mcporter è®©å®ƒæ­£å¸¸å·¥ä½œã€‚ç°åœ¨æˆ‘è®© Claude ä¸ºæˆ‘ç»´æŠ¤ä¸€ä¸ªå¯¹åº”çš„ Skillã€‚æ²¡é”™ï¼Œè¿™ä¸ª Skill å¯èƒ½æœ‰ä¸å°‘ bugï¼Œä¹Ÿéœ€è¦ä¸æ–­æ›´æ–°ï¼Œä½†ç”±äºæ˜¯ Agent è‡ªå·±ç»´æŠ¤çš„ï¼Œæ•´ä½“æ•ˆæœåè€Œæ›´å¥½ã€‚</p>
<p>å½“ç„¶ï¼Œè¿™ä¸€åˆ‡å¾ˆå¯èƒ½åœ¨æœªæ¥å‘ç”Ÿå˜åŒ–ã€‚ä½†å°±ç›®å‰è€Œè¨€ï¼Œæ‰‹åŠ¨ç»´æŠ¤çš„ Skillsï¼Œä»¥åŠè®© Agent è‡ªè¡Œç¼–å†™å·¥å…·ï¼Œå·²æˆä¸ºæˆ‘çš„é¦–é€‰æ–¹å¼ã€‚<strong>æˆ‘æ¨æµ‹ï¼ŒåŸºäº MCP çš„åŠ¨æ€å·¥å…·åŠ è½½ç»ˆå°†æˆä¸ºä¸»æµï¼Œä½†è¦å®ç°è¿™ä¸€ç‚¹ï¼Œå¯èƒ½è¿˜éœ€è¦ä¸€ç³»åˆ—åè®®å±‚é¢çš„æ”¹è¿›ï¼Œä»¥ä¾¿å¼•å…¥ç±»ä¼¼ Skills çš„æ‘˜è¦æœºåˆ¶ï¼Œä»¥åŠä¸ºå·¥å…·å†…ç½®ä½¿ç”¨æ‰‹å†Œã€‚</strong> æˆ‘ä¹Ÿè®¤ä¸ºï¼ŒMCP å¦‚æœèƒ½å…·å¤‡æ›´å¼ºçš„åè®®ç¨³å®šæ€§ï¼Œå°†å¤§æœ‰è£¨ç›Šã€‚ç›®å‰ MCP æœåŠ¡å™¨éšæ„æ›´æ”¹å·¥å…·æè¿°çš„åšæ³•ï¼Œä¸é‚£äº›å·²ç»å›ºåŒ–ä¸‹æ¥çš„è°ƒç”¨æ–¹å¼ï¼ˆmaterialized callsï¼‰ä»¥åŠåœ¨ README å’ŒæŠ€èƒ½æ–‡ä»¶ä¸­ç¼–å†™çš„å¤–éƒ¨å·¥å…·è¯´æ˜å¾ˆéš¾å…¼å®¹ã€‚</p>
<p><strong>END</strong></p>
<p><strong>æœ¬æœŸäº’åŠ¨å†…å®¹ ğŸ»</strong></p>
<p><strong>â“æŠ›å¼€ç°æœ‰æ–¹æ¡ˆï¼Œä½ ç†æƒ³ä¸­çš„AIå·¥å…·è°ƒç”¨èŒƒå¼åº”è¯¥é•¿ä»€ä¹ˆæ ·ï¼Ÿç”¨ä¸€å¥è¯æè¿°ä½ æœ€æ ¸å¿ƒçš„éœ€æ±‚ã€‚</strong></p>
<p><strong>æ–‡ä¸­é“¾æ¥</strong></p>
<p>[1]<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.anthropic.com%2Fengineering%2Fadvanced-tool-use" target="_blank" title="https://www.anthropic.com/engineering/advanced-tool-use" ref="nofollow noopener noreferrer">www.anthropic.com/engineeringâ€¦</a></p>
<p>[2]<a href="https://link.juejin.cn?target=https%3A%2F%2Flucumr.pocoo.org%2F2025%2F7%2F3%2Ftools%2F" target="_blank" title="https://lucumr.pocoo.org/2025/7/3/tools/" ref="nofollow noopener noreferrer">lucumr.pocoo.org/2025/7/3/toâ€¦</a></p>
<p>[3]<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsteipete%2Fmcporter" target="_blank" title="https://github.com/steipete/mcporter" ref="nofollow noopener noreferrer">github.com/steipete/mcâ€¦</a></p>
<p><strong>åŸæ–‡é“¾æ¥ï¼š</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Flucumr.pocoo.org%2F2025%2F12%2F13%2Fskills-vs-mcp%2F" target="_blank" title="https://lucumr.pocoo.org/2025/12/13/skills-vs-mcp/" ref="nofollow noopener noreferrer">lucumr.pocoo.org/2025/12/13/â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç¬¬4ç« ã€ç®€å•æ•°æ®ç±»å‹è¯¦è§£â€”â€”æ•´å‹ã€æµ®ç‚¹ã€å¸ƒå°”ä¸å­—ç¬¦ä¸²]]></title>    <link>https://juejin.cn/post/7598024433911513142</link>    <guid>https://juejin.cn/post/7598024433911513142</guid>    <pubDate>2026-01-23T00:38:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598024433911513142" data-draft-id="7598003935426199595" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç¬¬4ç« ã€ç®€å•æ•°æ®ç±»å‹è¯¦è§£â€”â€”æ•´å‹ã€æµ®ç‚¹ã€å¸ƒå°”ä¸å­—ç¬¦ä¸²"/> <meta itemprop="keywords" content="åç«¯,Go"/> <meta itemprop="datePublished" content="2026-01-23T00:38:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ€•æµªçŒ«"/> <meta itemprop="url" content="https://juejin.cn/user/2832784963939438"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç¬¬4ç« ã€ç®€å•æ•°æ®ç±»å‹è¯¦è§£â€”â€”æ•´å‹ã€æµ®ç‚¹ã€å¸ƒå°”ä¸å­—ç¬¦ä¸²
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2832784963939438/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ€•æµªçŒ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T00:38:36.000Z" title="Fri Jan 23 2026 00:38:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï½ ä¸Šä¸€ç« æˆ‘ä»¬åˆæ­¥è®¤è¯†äº†Goçš„åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä»Šå¤©æˆ‘ä»¬æ·±å…¥æ‹†è§£æœ€å¸¸ç”¨çš„å››ç±»ç®€å•æ•°æ®ç±»å‹ï¼š<strong>æ•´å‹ã€æµ®ç‚¹å‹ã€å¸ƒå°”å‹ã€å­—ç¬¦ä¸²</strong>ã€‚è¿™å››ç±»ç±»å‹æ˜¯æ—¥å¸¸å¼€å‘çš„â€œåŸºçŸ³â€ï¼ŒæŒæ¡å®ƒä»¬çš„ç»†èŠ‚ï¼ˆæ¯”å¦‚æ•´å‹çš„é•¿åº¦å·®å¼‚ã€å­—ç¬¦ä¸²çš„ä¸å¯å˜æ€§ã€UTF-8ç¼–ç é—®é¢˜ï¼‰ï¼Œèƒ½å¸®ä½ é¿å¼€å¾ˆå¤šå‘ï¼Œå†™å‡ºæ›´é«˜æ•ˆã€æ›´å¥å£®çš„ä»£ç ã€‚</p>
<p>æœ¬æ–‡ä¼šç»“åˆå…·ä½“åœºæ™¯å’Œä»£ç ç¤ºä¾‹ï¼ŒæŠŠæ¯ä¸ªç±»å‹çš„æ ¸å¿ƒç‰¹æ€§ã€ä½¿ç”¨æ³¨æ„äº‹é¡¹è®²é€ï¼Œè¿˜ä¼šè¡¥å……æ€§èƒ½ä¼˜åŒ–ç‚¹å’Œå®ç”¨å·¥å…·ï¼Œå»ºè®®è¾¹çœ‹è¾¹æ•²ä»£ç éªŒè¯ï¼ŒåŠ æ·±ç†è§£ã€‚</p>
<h2 data-id="heading-0">1. æ•´å‹ç±»å‹ï¼šintã€int8ã€int32ã€int64</h2>
<p>æ•´å‹æ˜¯ç”¨æ¥å­˜å‚¨æ•´æ•°çš„ç±»å‹ï¼ŒGoæä¾›äº†å¤šç§â€œå¸¦é•¿åº¦â€çš„æ•´å‹ï¼Œæ ¸å¿ƒå·®å¼‚åœ¨äº<strong>å–å€¼èŒƒå›´</strong>å’Œ<strong>å†…å­˜å ç”¨</strong>ã€‚æ—¥å¸¸å¼€å‘ä¸­æœ€å®¹æ˜“æ··æ·†çš„å°±æ˜¯<code>int</code>å’Œ<code>int32/int64</code>ï¼Œæˆ‘ä»¬å…ˆæŠŠå®ƒä»¬çš„åŒºåˆ«è®²æ¸…æ¥šã€‚</p>
<h3 data-id="heading-1">1.1 æ ¸å¿ƒç‰¹æ€§å¯¹æ¯”</h3>
<p>Goçš„æœ‰ç¬¦å·æ•´å‹æŒ‰é•¿åº¦åˆ†ä¸º4ç±»ï¼Œå…³é”®ä¿¡æ¯å¦‚ä¸‹è¡¨ï¼š</p>









































<table><thead><tr><th>ç±»å‹</th><th>å†…å­˜å ç”¨ï¼ˆå­—èŠ‚ï¼‰</th><th>å–å€¼èŒƒå›´</th><th>æ ¸å¿ƒç‰¹ç‚¹</th></tr></thead><tbody><tr><td>int8</td><td>1</td><td>-128 ~ 127</td><td>æœ€å°çš„æœ‰ç¬¦å·æ•´å‹ï¼Œé€‚åˆå­˜å‚¨å°èŒƒå›´æ•´æ•°ï¼ˆå¦‚çŠ¶æ€ç ã€æšä¸¾å€¼ï¼‰</td></tr><tr><td>int16</td><td>2</td><td>-32768 ~ 32767</td><td>é€‚ç”¨äºä¸­ç­‰èŒƒå›´æ•´æ•°ï¼ˆå¦‚çŸ­å­—ç¬¦ä¸²é•¿åº¦ã€å°æ•°é‡çº§è®¡æ•°ï¼‰</td></tr><tr><td>int32</td><td>4</td><td>-2147483648 ~ 2147483647</td><td>å¸¸ç”¨ç±»å‹ï¼Œå¯¹åº”Cè¯­è¨€çš„intï¼Œé€‚åˆå¤§å¤šæ•°è®¡æ•°åœºæ™¯ï¼ˆå¦‚æ•°ç»„ç´¢å¼•ã€ç”¨æˆ·IDï¼‰</td></tr><tr><td>int64</td><td>8</td><td>-9223372036854775808 ~ 9223372036854775807</td><td>å¤§èŒƒå›´æ•´æ•°ï¼Œé€‚åˆå­˜å‚¨å¤§æ•°å€¼ï¼ˆå¦‚æ—¶é—´æˆ³ã€æ–‡ä»¶å¤§å°ã€å¤§æ•°æ®é‡è®¡æ•°ï¼‰</td></tr><tr><td>int</td><td>32ä½ç³»ç»Ÿ4å­—èŠ‚ï¼Œ64ä½ç³»ç»Ÿ8å­—èŠ‚</td><td>éšç³»ç»Ÿå˜åŒ–</td><td>é»˜è®¤æ•´å‹ï¼Œå…¼å®¹æ€§å¥½ï¼Œä½†è·¨å¹³å°å¯èƒ½æœ‰é—®é¢˜ï¼ˆä¸æ¨èç”¨äºç²¾ç¡®æ•°å€¼å­˜å‚¨ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-2">1.2 å®æˆ˜é€‰å‹å»ºè®®</h3>
<p>å¾ˆå¤šæ–°æ‰‹ä¹ æƒ¯ç”¨é»˜è®¤çš„<code>int</code>ï¼Œä½†åœ¨å®é™…å¼€å‘ä¸­ï¼Œä¸ºäº†ä»£ç çš„<strong>è·¨å¹³å°ä¸€è‡´æ€§</strong>å’Œ<strong>å†…å­˜ä¼˜åŒ–</strong>ï¼Œæ›´æ¨èæ˜ç¡®æŒ‡å®šæ•´å‹é•¿åº¦ï¼š</p>
<ul>
<li>
<p>å­˜å‚¨å°èŒƒå›´æ•´æ•°ï¼ˆå¦‚0-100çš„çŠ¶æ€ç ï¼‰ï¼šç”¨<code>int8</code>ï¼ŒèŠ‚çœå†…å­˜ï¼›</p>
</li>
<li>
<p>æ™®é€šè®¡æ•°åœºæ™¯ï¼ˆå¦‚å¾ªç¯æ¬¡æ•°ã€åˆ—è¡¨é•¿åº¦ï¼‰ï¼šç”¨<code>int32</code>ï¼Œå…¼é¡¾å†…å­˜å’ŒèŒƒå›´ï¼›</p>
</li>
<li>
<p>å­˜å‚¨å¤§æ•°å€¼ï¼ˆå¦‚æ—¶é—´æˆ³ï¼ˆtime.Timeçš„UnixNanoè¿”å›int64ï¼‰ã€æ–‡ä»¶å¤§å°ï¼‰ï¼šå¿…é¡»ç”¨<code>int64</code>ï¼Œé¿å…æº¢å‡ºï¼›</p>
</li>
<li>
<p>è·¨å¹³å°é¡¹ç›®ï¼šç»å¯¹ä¸è¦ç”¨<code>int</code>å­˜å‚¨éœ€è¦ç²¾ç¡®ä¼ é€’çš„æ•°å€¼ï¼ˆå¦‚RPCæ¥å£å‚æ•°ï¼‰ï¼Œé˜²æ­¢32ä½å’Œ64ä½ç³»ç»Ÿé—´æ•°æ®æˆªæ–­ã€‚</p>
</li>
</ul>
<h3 data-id="heading-3">1.3 ä»£ç ç¤ºä¾‹ï¼šæ•´å‹çš„ä½¿ç”¨ä¸æº¢å‡ºé—®é¢˜</h3>
<p>æ•´å‹æº¢å‡ºæ˜¯å¸¸è§bugï¼Œå°¤å…¶æ˜¯åœ¨å¾ªç¯æˆ–æ•°å€¼è®¡ç®—ä¸­ï¼Œæˆ‘ä»¬æ¥çœ‹ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// 1. æ˜ç¡®ç±»å‹çš„æ•´å‹ä½¿ç”¨</span>
    <span class="hljs-keyword">var</span> status <span class="hljs-type">int8</span> = <span class="hljs-number">0</span>  <span class="hljs-comment">// çŠ¶æ€ç ï¼š0-æˆåŠŸï¼Œ1-å¤±è´¥</span>
    <span class="hljs-keyword">var</span> userID <span class="hljs-type">int32</span> = <span class="hljs-number">10001</span>  <span class="hljs-comment">// ç”¨æˆ·ID</span>
    <span class="hljs-keyword">var</span> fileSize <span class="hljs-type">int64</span> = <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>  <span class="hljs-comment">// 1GBæ–‡ä»¶å¤§å°</span>

    fmt.Println(status, userID, fileSize)  <span class="hljs-comment">// è¾“å‡ºï¼š0 10001 1073741824</span>

    <span class="hljs-comment">// 2. æº¢å‡ºé—®é¢˜æ¼”ç¤ºï¼ˆint8çš„æœ€å¤§å€¼æ˜¯127ï¼‰</span>
    <span class="hljs-keyword">var</span> maxInt8 <span class="hljs-type">int8</span> = <span class="hljs-number">127</span>
    maxInt8++  <span class="hljs-comment">// æº¢å‡ºï¼š127 + 1 = -128ï¼ˆäºŒè¿›åˆ¶è¡¥ç æº¢å‡ºç‰¹æ€§ï¼‰</span>
    fmt.Println(<span class="hljs-string">"int8æº¢å‡ºåï¼š"</span>, maxInt8)  <span class="hljs-comment">// è¾“å‡ºï¼šint8æº¢å‡ºåï¼š-128</span>

    <span class="hljs-comment">// 3. é¿å…æº¢å‡ºï¼šç”¨æ›´å¤§èŒƒå›´çš„ç±»å‹</span>
    <span class="hljs-keyword">var</span> num <span class="hljs-type">int32</span> = <span class="hljs-number">2147483647</span>
    <span class="hljs-comment">// num++  // è‹¥ç”¨int32ï¼Œæº¢å‡ºåä¼šå˜æˆ-2147483648</span>
    <span class="hljs-keyword">var</span> bigNum <span class="hljs-type">int64</span> = <span class="hljs-type">int64</span>(num) + <span class="hljs-number">1</span>  <span class="hljs-comment">// è½¬ä¸ºint64åè®¡ç®—ï¼Œé¿å…æº¢å‡º</span>
    fmt.Println(<span class="hljs-string">"int64è®¡ç®—åï¼š"</span>, bigNum)  <span class="hljs-comment">// è¾“å‡ºï¼šint64è®¡ç®—åï¼š2147483648</span>
}

</code></pre>
<p><strong>æ³¨æ„</strong>ï¼šGoä¸ä¼šè‡ªåŠ¨æ£€æµ‹æ•´å‹æº¢å‡ºï¼Œæº¢å‡ºåä¼šæŒ‰ç…§äºŒè¿›åˆ¶è¡¥ç è§„åˆ™å¾ªç¯ï¼ˆæ­£æ•°æº¢å‡ºå˜è´Ÿæ•°ï¼Œè´Ÿæ•°æº¢å‡ºå˜æ­£æ•°ï¼‰ï¼Œå¼€å‘æ—¶éœ€æå‰è¯„ä¼°æ•°å€¼èŒƒå›´ï¼Œé¿å…æº¢å‡ºã€‚</p>
<h2 data-id="heading-4">2. æ— ç¬¦å·æ•´å‹ä¸å†…å­˜å ç”¨</h2>
<p>æ— ç¬¦å·æ•´å‹ï¼ˆuintç³»åˆ—ï¼‰åªèƒ½å­˜å‚¨éè´Ÿæ•´æ•°ï¼Œå–å€¼èŒƒå›´æ˜¯<code>0 ~ 2^n - 1</code>ï¼ˆnæ˜¯ä½æ•°ï¼‰ã€‚å’Œæœ‰ç¬¦å·æ•´å‹ç›¸æ¯”ï¼Œå®ƒçš„<strong>å†…å­˜å ç”¨ç›¸åŒï¼Œä½†å–å€¼èŒƒå›´æ›´å¤§</strong>ï¼ˆå› ä¸ºæ²¡æœ‰ç¬¦å·ä½ï¼‰ã€‚</p>
<h3 data-id="heading-5">2.1 æ— ç¬¦å·æ•´å‹ç±»å‹å¯¹æ¯”</h3>









































<table><thead><tr><th>ç±»å‹</th><th>å†…å­˜å ç”¨ï¼ˆå­—èŠ‚ï¼‰</th><th>å–å€¼èŒƒå›´</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>uint8ï¼ˆbyteï¼‰</td><td>1</td><td>0 ~ 255</td><td>å­˜å‚¨å­—èŠ‚æ•°æ®ï¼ˆå¦‚æ–‡ä»¶å†…å®¹ã€ASCIIå­—ç¬¦ï¼‰ï¼Œbyteæ˜¯å…¶åˆ«å</td></tr><tr><td>uint16</td><td>2</td><td>0 ~ 65535</td><td>å­˜å‚¨éè´Ÿä¸­ç­‰èŒƒå›´æ•´æ•°ï¼ˆå¦‚ç«¯å£å·ï¼š0-65535ï¼‰</td></tr><tr><td>uint32</td><td>4</td><td>0 ~ 4294967295</td><td>å­˜å‚¨éè´Ÿå¤§èŒƒå›´æ•´æ•°ï¼ˆå¦‚æ— ç¬¦å·IDã€è®¡æ•°å™¨ï¼‰</td></tr><tr><td>uint64</td><td>8</td><td>0 ~ 18446744073709551615</td><td>å­˜å‚¨è¶…å¤§éè´Ÿæ•´æ•°ï¼ˆå¦‚ç£ç›˜æ€»å®¹é‡ã€è¶…å¤§è®¡æ•°ï¼‰</td></tr><tr><td>uint</td><td>éšç³»ç»Ÿå˜åŒ–</td><td>éšç³»ç»Ÿå˜åŒ–</td><td>ä¸æ¨èä½¿ç”¨ï¼Œè·¨å¹³å°å…¼å®¹æ€§å·®</td></tr></tbody></table>
<h3 data-id="heading-6">2.2 ä½¿ç”¨æ³¨æ„äº‹é¡¹</h3>
<p>æ— ç¬¦å·æ•´å‹è™½ç„¶å–å€¼èŒƒå›´å¤§ï¼Œä½†ä½¿ç”¨æ—¶è¦æ ¼å¤–å°å¿ƒï¼Œé¿å…ä»¥ä¸‹å‘ï¼š</p>
<ol>
<li>
<p><strong>é¿å…å’Œæœ‰ç¬¦å·æ•´å‹æ··ç”¨</strong>ï¼šæ··ç”¨ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼Œå¿…é¡»æ˜¾å¼è½¬æ¢ï¼ˆä¸”è¦ç¡®ä¿æ•°å€¼åœ¨ç›®æ ‡ç±»å‹èŒƒå›´å†…ï¼‰ï¼›</p>
</li>
<li>
<p><strong>ä¸è¦ç”¨äºå¯èƒ½å‡ºç°è´Ÿæ•°çš„åœºæ™¯</strong>ï¼šæ¯”å¦‚è®¡ç®—å·®å€¼ï¼ˆa - bï¼Œè‹¥a &lt; bï¼Œæ— ç¬¦å·ç±»å‹ä¼šæº¢å‡ºä¸ºå¤§æ•°ï¼‰ï¼›</p>
</li>
<li>
<p><strong>byteæ˜¯uint8çš„åˆ«å</strong>ï¼šæ—¥å¸¸å¼€å‘ä¸­ï¼Œå­˜å‚¨å­—èŠ‚æ•°æ®æ—¶ç”¨byteæ›´ç›´è§‚ï¼ˆå¦‚å¤„ç†æ–‡ä»¶ã€ç½‘ç»œä¼ è¾“æ•°æ®ï¼‰ã€‚</p>
</li>
</ol>
<h3 data-id="heading-7">2.3 ä»£ç ç¤ºä¾‹ï¼šæ— ç¬¦å·æ•´å‹çš„æ­£ç¡®ä½¿ç”¨</h3>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// 1. byteï¼ˆuint8ï¼‰çš„ä½¿ç”¨ï¼šå­˜å‚¨ASCIIå­—ç¬¦</span>
    <span class="hljs-keyword">var</span> ch <span class="hljs-type">byte</span> = <span class="hljs-string">'A'</span>
    fmt.Println(ch, <span class="hljs-type">string</span>(ch))  <span class="hljs-comment">// è¾“å‡ºï¼š65 Aï¼ˆbyteå­˜å‚¨çš„æ˜¯ASCIIç å€¼ï¼‰</span>

    <span class="hljs-comment">// 2. ç«¯å£å·ï¼ˆ0-65535ï¼‰ï¼šç”¨uint16</span>
    <span class="hljs-keyword">var</span> port <span class="hljs-type">uint16</span> = <span class="hljs-number">8080</span>
    fmt.Println(<span class="hljs-string">"ç«¯å£å·ï¼š"</span>, port)  <span class="hljs-comment">// è¾“å‡ºï¼šç«¯å£å·ï¼š8080</span>

    <span class="hljs-comment">// 3. é”™è¯¯ç¤ºä¾‹ï¼šæ— ç¬¦å·ä¸æœ‰ç¬¦å·æ··ç”¨</span>
    <span class="hljs-keyword">var</span> a <span class="hljs-type">int32</span> = <span class="hljs-number">100</span>
    <span class="hljs-keyword">var</span> b <span class="hljs-type">uint32</span> = <span class="hljs-number">200</span>
    <span class="hljs-comment">// fmt.Println(a + b)  // ç¼–è¯‘æŠ¥é”™ï¼šmismatched types int32 and uint32</span>
    <span class="hljs-comment">// æ­£ç¡®ï¼šæ˜¾å¼è½¬æ¢ä¸ºåŒä¸€ç±»å‹ï¼ˆç¡®ä¿æ•°å€¼èŒƒå›´å®‰å…¨ï¼‰</span>
    fmt.Println(<span class="hljs-type">uint32</span>(a) + b)  <span class="hljs-comment">// è¾“å‡ºï¼š300</span>

    <span class="hljs-comment">// 4. é”™è¯¯ç¤ºä¾‹ï¼šæ— ç¬¦å·æ•´å‹çš„è´Ÿæ•°é—®é¢˜</span>
    <span class="hljs-keyword">var</span> c <span class="hljs-type">uint8</span> = <span class="hljs-number">10</span>
    <span class="hljs-keyword">var</span> d <span class="hljs-type">uint8</span> = <span class="hljs-number">20</span>
    <span class="hljs-comment">// fmt.Println(c - d)  // è¾“å‡ºï¼š246ï¼ˆæº¢å‡ºï¼Œä¸æ˜¯-10ï¼‰</span>
    <span class="hljs-comment">// æ­£ç¡®ï¼šå…ˆåˆ¤æ–­å¤§å°ï¼Œé¿å…è´Ÿæ•°</span>
    <span class="hljs-keyword">if</span> c &lt; d {
        fmt.Println(<span class="hljs-string">"c &lt; dï¼Œæ— æ³•è®¡ç®—å·®å€¼"</span>)
    } <span class="hljs-keyword">else</span> {
        fmt.Println(c - d)
    }
}

</code></pre>
<h2 data-id="heading-8">3. æµ®ç‚¹æ•°ä¸ç²¾åº¦é—®é¢˜</h2>
<p>æµ®ç‚¹æ•°ç”¨äºå­˜å‚¨å¸¦æœ‰å°æ•°çš„æ•°å€¼ï¼ŒGoæä¾›ä¸¤ç§æµ®ç‚¹æ•°ç±»å‹ï¼š<code>float32</code>ï¼ˆå•ç²¾åº¦ï¼‰å’Œ<code>float64</code>ï¼ˆåŒç²¾åº¦ï¼‰ã€‚æ—¥å¸¸å¼€å‘ä¸­æœ€å®¹æ˜“è¸©çš„å‘æ˜¯<strong>æµ®ç‚¹æ•°ç²¾åº¦ä¸¢å¤±</strong>ï¼Œæˆ‘ä»¬é‡ç‚¹è®²è¿™ä¸ªé—®é¢˜ã€‚</p>
<h3 data-id="heading-9">3.1 æµ®ç‚¹æ•°æ ¸å¿ƒç‰¹æ€§</h3>























<table><thead><tr><th>ç±»å‹</th><th>å†…å­˜å ç”¨ï¼ˆå­—èŠ‚ï¼‰</th><th>ç²¾åº¦ï¼ˆæœ‰æ•ˆæ•°å­—ï¼‰</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>float32</td><td>4</td><td>6-7ä½</td><td>å¯¹ç²¾åº¦è¦æ±‚ä¸é«˜çš„åœºæ™¯ï¼ˆå¦‚æ¸¸æˆå›¾å½¢ã€ç²—ç•¥æµ‹é‡ï¼‰</td></tr><tr><td>float64</td><td>8</td><td>15-17ä½</td><td>é»˜è®¤æµ®ç‚¹æ•°ç±»å‹ï¼Œé€‚ç”¨äºå¤§å¤šæ•°åœºæ™¯ï¼ˆå¦‚é‡‘èè®¡ç®—ã€ç§‘å­¦è®¡ç®—ï¼‰</td></tr></tbody></table>
<p><strong>æ³¨æ„</strong>ï¼šGoçš„æµ®ç‚¹æ•°éµå¾ªIEEE 754æ ‡å‡†ï¼Œå’Œå¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚Javaã€Pythonï¼‰ä¸€è‡´ã€‚</p>
<h3 data-id="heading-10">3.2 ç²¾åº¦ä¸¢å¤±é—®é¢˜ï¼ˆé‡ç‚¹ï¼ï¼‰</h3>
<p>ç”±äºæµ®ç‚¹æ•°çš„äºŒè¿›åˆ¶å­˜å‚¨ç‰¹æ€§ï¼Œæœ‰äº›åè¿›åˆ¶å°æ•°ï¼ˆå¦‚0.1ï¼‰æ— æ³•è¢«ç²¾ç¡®è¡¨ç¤ºï¼Œä¼šå¯¼è‡´ç²¾åº¦ä¸¢å¤±ã€‚è¿™ä¸æ˜¯Goçš„é—®é¢˜ï¼Œè€Œæ˜¯æ‰€æœ‰éµå¾ªIEEE 754æ ‡å‡†çš„è¯­è¨€éƒ½å­˜åœ¨çš„é—®é¢˜ã€‚</p>
<p><strong>ä»£ç ç¤ºä¾‹ï¼šç²¾åº¦ä¸¢å¤±æ¼”ç¤º</strong></p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// 0.1 + 0.2 ä¸ç­‰äº 0.3</span>
    a := <span class="hljs-number">0.1</span>
    b := <span class="hljs-number">0.2</span>
    c := <span class="hljs-number">0.3</span>
    fmt.Println(a + b)  <span class="hljs-comment">// è¾“å‡ºï¼š0.30000000000000004</span>
    fmt.Println(a + b == c)  <span class="hljs-comment">// è¾“å‡ºï¼šfalse</span>

    <span class="hljs-comment">// è§£å†³æ–¹æ³•1ï¼šä½¿ç”¨fmtæ ¼å¼åŒ–ï¼Œä¿ç•™æŒ‡å®šå°æ•°ä½</span>
    fmt.Printf(<span class="hljs-string">"%.2f\n"</span>, a+b)  <span class="hljs-comment">// è¾“å‡ºï¼š0.30</span>
    <span class="hljs-keyword">if</span> fmt.Sprintf(<span class="hljs-string">"%.2f"</span>, a+b) == fmt.Sprintf(<span class="hljs-string">"%.2f"</span>, c) {
        fmt.Println(<span class="hljs-string">"ç›¸ç­‰ï¼ˆä¿ç•™2ä½å°æ•°ï¼‰"</span>)
    }

    <span class="hljs-comment">// è§£å†³æ–¹æ³•2ï¼šä½¿ç”¨mathåŒ…çš„Equalå‡½æ•°ï¼ˆé€‚åˆé«˜ç²¾åº¦åœºæ™¯ï¼‰</span>
    <span class="hljs-keyword">import</span> <span class="hljs-string">"math"</span>
    <span class="hljs-keyword">if</span> math.Equal(a+b, c) {
        fmt.Println(<span class="hljs-string">"ç›¸ç­‰"</span>)
    } <span class="hljs-keyword">else</span> {
        fmt.Println(<span class="hljs-string">"ä¸ç›¸ç­‰"</span>)
    }

    <span class="hljs-comment">// è§£å†³æ–¹æ³•3ï¼šä½¿ç”¨æ•´æ•°è¿ç®—ï¼ˆé‡‘èåœºæ™¯æ¨èï¼Œå¦‚å­˜å‚¨åˆ†è€Œä¸æ˜¯å…ƒï¼‰</span>
    <span class="hljs-comment">// 0.1å…ƒ = 10åˆ†ï¼Œ0.2å…ƒ = 20åˆ†ï¼Œæ€»å’Œ30åˆ† = 0.3å…ƒ</span>
    aCent := <span class="hljs-number">10</span>
    bCent := <span class="hljs-number">20</span>
    cCent := <span class="hljs-number">30</span>
    fmt.Println(aCent + bCent == cCent)  <span class="hljs-comment">// è¾“å‡ºï¼štrue</span>
}

</code></pre>
<h3 data-id="heading-11">3.3 å®æˆ˜å»ºè®®</h3>
<ul>
<li>
<p>æ—¥å¸¸å¼€å‘ä¼˜å…ˆç”¨<code>float64</code>ï¼Œç²¾åº¦æ›´é«˜ï¼Œå‡å°‘ä¸¢å¤±æ¦‚ç‡ï¼›</p>
</li>
<li>
<p>é¿å…ç›´æ¥æ¯”è¾ƒä¸¤ä¸ªæµ®ç‚¹æ•°æ˜¯å¦ç›¸ç­‰ï¼Œæ¨èç”¨ä¸¤ç§æ–¹å¼ï¼šâ‘  æ ¼å¼åŒ–åæ¯”è¾ƒï¼›â‘¡ è®¡ç®—ä¸¤è€…å·®å€¼çš„ç»å¯¹å€¼ï¼Œåˆ¤æ–­æ˜¯å¦å°äºæŸä¸ªæå°å€¼ï¼ˆå¦‚1e-9ï¼‰ï¼›</p>
</li>
<li>
<p>é‡‘èè®¡ç®—ï¼ˆå¦‚é‡‘é¢ï¼‰ç»å¯¹ä¸è¦ç”¨æµ®ç‚¹æ•°ï¼æ¨èç”¨æ•´æ•°ï¼ˆå­˜å‚¨åˆ†ï¼‰æˆ–ä¸“é—¨çš„é«˜ç²¾åº¦åº“ï¼ˆå¦‚<code>github.com/shopspring/decimal</code>ï¼‰ã€‚</p>
</li>
</ul>
<p>é«˜ç²¾åº¦åº“å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fpkg.go.dev%2Fgithub.com%2Fshopspring%2Fdecimal" target="_blank" title="https://pkg.go.dev/github.com/shopspring/decimal" ref="nofollow noopener noreferrer">shopspring/decimalï¼ˆGoå¸¸ç”¨é«˜ç²¾åº¦å°æ•°åº“ï¼‰</a></p>
<h2 data-id="heading-12">4. å¸ƒå°”ç±»å‹ä¸é€»è¾‘è¿ç®—</h2>
<p>å¸ƒå°”ç±»å‹æ˜¯æœ€ç®€å•çš„æ•°æ®ç±»å‹ï¼Œåªæœ‰ä¸¤ä¸ªå€¼ï¼š<code>true</code>ï¼ˆçœŸï¼‰å’Œ<code>false</code>ï¼ˆå‡ï¼‰ï¼Œä¸»è¦ç”¨äºæ¡ä»¶åˆ¤æ–­ï¼ˆå¦‚ifã€forå¾ªç¯ï¼‰å’Œé€»è¾‘è¿ç®—ã€‚</p>
<h3 data-id="heading-13">4.1 æ ¸å¿ƒç‰¹æ€§</h3>
<ul>
<li>
<p>å†…å­˜å ç”¨ï¼š1å­—èŠ‚ï¼ˆå›ºå®šï¼Œæ— è®ºç³»ç»Ÿæ˜¯32ä½è¿˜æ˜¯64ä½ï¼‰ï¼›</p>
</li>
<li>
<p>é›¶å€¼ï¼š<code>false</code>ï¼ˆå£°æ˜åæœªèµ‹å€¼çš„å¸ƒå°”å˜é‡é»˜è®¤æ˜¯falseï¼‰ï¼›</p>
</li>
<li>
<p>ä¸å¯è½¬æ¢ï¼šå¸ƒå°”ç±»å‹ä¸èƒ½å’Œå…¶ä»–ç±»å‹ï¼ˆå¦‚intï¼‰ç›¸äº’è½¬æ¢ï¼ˆå’ŒCè¯­è¨€ä¸åŒï¼‰ï¼›</p>
</li>
<li>
<p>ä¸å¯å‚ä¸æ•°å€¼è¿ç®—ï¼šä¸èƒ½ç”¨+ã€-ã€*ã€/ç­‰è¿ç®—ç¬¦æ“ä½œå¸ƒå°”å€¼ã€‚</p>
</li>
</ul>
<h3 data-id="heading-14">4.2 é€»è¾‘è¿ç®—</h3>
<p>Goæ”¯æŒä¸‰ç§åŸºæœ¬é€»è¾‘è¿ç®—ï¼Œç”¨äºç»„åˆå¸ƒå°”å€¼ï¼š</p>





























<table><thead><tr><th align="center">è¿ç®—ç¬¦</th><th align="left">å«ä¹‰</th><th align="left">ç¤ºä¾‹</th><th align="left">ç»“æœ</th></tr></thead><tbody><tr><td align="center"><code>&amp;&amp;</code></td><td align="left">é€»è¾‘ä¸ï¼ˆçŸ­è·¯ï¼‰</td><td align="left"><code>true &amp;&amp; false</code></td><td align="left"><code>false</code></td></tr><tr><td align="center"><code>||</code></td><td align="left">é€»è¾‘æˆ–ï¼ˆçŸ­è·¯ï¼‰</td><td align="left"><code>true || false</code></td><td align="left"><code>true</code></td></tr><tr><td align="center"><code>!</code></td><td align="left">é€»è¾‘é</td><td align="left"><code>!true</code></td><td align="left"><code>false</code></td></tr></tbody></table>
<h3 data-id="heading-15">4.3 ä»£ç ç¤ºä¾‹ï¼šå¸ƒå°”ç±»å‹çš„ä½¿ç”¨</h3>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// 1. åŸºæœ¬ä½¿ç”¨</span>
    <span class="hljs-keyword">var</span> isPass <span class="hljs-type">bool</span> = <span class="hljs-literal">true</span>
    <span class="hljs-keyword">var</span> isLogin <span class="hljs-type">bool</span>  <span class="hljs-comment">// é›¶å€¼æ˜¯false</span>
    fmt.Println(isPass, isLogin)  <span class="hljs-comment">// è¾“å‡ºï¼štrue false</span>

    <span class="hljs-comment">// 2. é€»è¾‘è¿ç®—</span>
    a := <span class="hljs-number">10</span>
    b := <span class="hljs-number">20</span>
    <span class="hljs-comment">// é€»è¾‘ä¸ï¼ša&gt;5ä¸”b&lt;30</span>
    fmt.Println(a &gt; <span class="hljs-number">5</span> &amp;&amp; b &lt; <span class="hljs-number">30</span>)  <span class="hljs-comment">// è¾“å‡ºï¼štrue</span>
    <span class="hljs-comment">// é€»è¾‘æˆ–ï¼ša&gt;15æˆ–b&lt;15</span>
    fmt.Println(a &gt; <span class="hljs-number">15</span> || b &lt; <span class="hljs-number">15</span>)  <span class="hljs-comment">// è¾“å‡ºï¼šfalse</span>
    <span class="hljs-comment">// é€»è¾‘éï¼šaä¸ç­‰äº10</span>
    fmt.Println(!(a == <span class="hljs-number">10</span>))  <span class="hljs-comment">// è¾“å‡ºï¼šfalse</span>

    <span class="hljs-comment">// 3. çŸ­è·¯ç‰¹æ€§ç¤ºä¾‹</span>
    <span class="hljs-comment">// ç”±äºa&gt;5æ˜¯trueï¼Œé€»è¾‘æˆ–åé¢çš„å‡½æ•°ä¸ä¼šæ‰§è¡Œ</span>
    fmt.Println(a &gt; <span class="hljs-number">5</span> || test())  <span class="hljs-comment">// è¾“å‡ºï¼štrueï¼Œä¸”ä¸ä¼šæ‰“å°"testæ‰§è¡Œäº†"</span>

    <span class="hljs-comment">// 4. é”™è¯¯ç¤ºä¾‹ï¼šå¸ƒå°”ç±»å‹ä¸intè½¬æ¢</span>
    <span class="hljs-comment">// var num int = int(isPass)  // ç¼–è¯‘æŠ¥é”™ï¼šcannot convert isPass (type bool) to type int</span>
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span> <span class="hljs-type">bool</span> {
    fmt.Println(<span class="hljs-string">"testæ‰§è¡Œäº†"</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
}

</code></pre>
<h2 data-id="heading-16">5. å­—ç¬¦ä¸²çš„ä¸å¯å˜æ€§ä¸åº•å±‚ç»“æ„</h2>
<p>å­—ç¬¦ä¸²æ˜¯Goä¸­æœ€å¸¸ç”¨çš„å¼•ç”¨ç±»å‹ï¼ˆè™½ç„¶ä½¿ç”¨èµ·æ¥åƒå€¼ç±»å‹ï¼‰ï¼Œæ ¸å¿ƒç‰¹æ€§æ˜¯<strong>ä¸å¯å˜æ€§</strong>â€”â€”ä¸€æ—¦åˆ›å»ºï¼Œå­—ç¬¦ä¸²çš„å†…å®¹å°±ä¸èƒ½è¢«ä¿®æ”¹ã€‚ç†è§£è¿™ä¸ªç‰¹æ€§å’Œåº•å±‚ç»“æ„ï¼Œèƒ½å¸®ä½ å†™å‡ºæ›´é«˜æ•ˆçš„å­—ç¬¦ä¸²æ“ä½œä»£ç ã€‚</p>
<h3 data-id="heading-17">5.1 åº•å±‚ç»“æ„</h3>
<p>Goçš„å­—ç¬¦ä¸²åº•å±‚æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œå®šä¹‰åœ¨<code>runtime</code>åŒ…ä¸­ï¼š</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">type</span> stringStruct <span class="hljs-keyword">struct</span> {
    str unsafe.Pointer  <span class="hljs-comment">// æŒ‡å‘åº•å±‚å­—èŠ‚æ•°ç»„çš„æŒ‡é’ˆ</span>
    <span class="hljs-built_in">len</span> <span class="hljs-type">int</span>             <span class="hljs-comment">// å­—ç¬¦ä¸²é•¿åº¦ï¼ˆå­—èŠ‚æ•°ï¼‰</span>
}

</code></pre>
<p>æ ¸å¿ƒè¦ç‚¹ï¼š</p>
<ul>
<li>
<p>å­—ç¬¦ä¸²çš„é•¿åº¦æ˜¯å›ºå®šçš„ï¼ˆlenå­—æ®µï¼‰ï¼Œä¿®æ”¹é•¿åº¦éœ€è¦åˆ›å»ºæ–°å­—ç¬¦ä¸²ï¼›</p>
</li>
<li>
<p>å¤šä¸ªå­—ç¬¦ä¸²å¯ä»¥å…±äº«åŒä¸€ä¸ªåº•å±‚å­—èŠ‚æ•°ç»„ï¼ˆå¦‚å­—ç¬¦ä¸²åˆ‡ç‰‡ï¼‰ï¼ŒèŠ‚çœå†…å­˜ï¼›</p>
</li>
<li>
<p>å­—ç¬¦ä¸²çš„â€œä¸å¯å˜æ€§â€æœ¬è´¨æ˜¯åº•å±‚å­—èŠ‚æ•°ç»„ä¸å¯ä¿®æ”¹ï¼Œä»»ä½•ä¿®æ”¹æ“ä½œéƒ½ä¼šåˆ›å»ºæ–°çš„å­—èŠ‚æ•°ç»„ã€‚</p>
</li>
</ul>
<h3 data-id="heading-18">5.2 ä¸å¯å˜æ€§çš„å½±å“</h3>
<p>ä¸å¯å˜æ€§æ˜¯æŠŠâ€œåŒåˆƒå‰‘â€ï¼Œä¼˜ç‚¹æ˜¯çº¿ç¨‹å®‰å…¨ã€å†…å­˜é«˜æ•ˆï¼ˆå…±äº«å­—èŠ‚æ•°ç»„ï¼‰ï¼Œç¼ºç‚¹æ˜¯ä¿®æ”¹å­—ç¬¦ä¸²ä¼šäº§ç”Ÿæ–°å¯¹è±¡ï¼Œé¢‘ç¹ä¿®æ”¹ä¼šå½±å“æ€§èƒ½ã€‚</p>
<p><strong>ä»£ç ç¤ºä¾‹ï¼šå­—ç¬¦ä¸²ä¸å¯å˜æ€§</strong></p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// 1. å­—ç¬¦ä¸²ä¸å¯ä¿®æ”¹å•ä¸ªå­—ç¬¦</span>
    str := <span class="hljs-string">"hello"</span>
    <span class="hljs-comment">// str[0] = 'H'  // ç¼–è¯‘æŠ¥é”™ï¼šcannot assign to str[0]</span>

    <span class="hljs-comment">// 2. ä¿®æ”¹å­—ç¬¦ä¸²çš„æ­£ç¡®æ–¹å¼ï¼šè½¬ä¸ºåˆ‡ç‰‡ä¿®æ”¹åé‡æ–°ç”Ÿæˆå­—ç¬¦ä¸²</span>
    <span class="hljs-comment">// è½¬ä¸º[]byteåˆ‡ç‰‡ï¼ˆé€‚ç”¨äºASCIIå­—ç¬¦ï¼‰</span>
    byteSlice := []<span class="hljs-type">byte</span>(str)
    byteSlice[<span class="hljs-number">0</span>] = <span class="hljs-string">'H'</span>
    newStr := <span class="hljs-type">string</span>(byteSlice)
    fmt.Println(newStr)  <span class="hljs-comment">// è¾“å‡ºï¼šHello</span>

    <span class="hljs-comment">// 3. å­—ç¬¦ä¸²å…±äº«åº•å±‚æ•°ç»„ï¼ˆåˆ‡ç‰‡æ“ä½œï¼‰</span>
    str1 := <span class="hljs-string">"abcdefg"</span>
    str2 := str1[<span class="hljs-number">1</span>:<span class="hljs-number">4</span>]  <span class="hljs-comment">// åˆ‡ç‰‡ï¼šä»ç´¢å¼•1åˆ°4ï¼ˆä¸åŒ…å«4ï¼‰ï¼Œç»“æœæ˜¯"bcd"</span>
    fmt.Println(<span class="hljs-built_in">len</span>(str1), <span class="hljs-built_in">len</span>(str2))  <span class="hljs-comment">// è¾“å‡ºï¼š7 3</span>
    <span class="hljs-comment">// str1å’Œstr2å…±äº«åº•å±‚å­—èŠ‚æ•°ç»„ï¼Œstr2çš„lenæ˜¯3</span>
}

</code></pre>
<h3 data-id="heading-19">5.3 æ€§èƒ½ä¼˜åŒ–å»ºè®®</h3>
<p>é¢‘ç¹ä¿®æ”¹å­—ç¬¦ä¸²ï¼ˆå¦‚æ‹¼æ¥ã€æ›¿æ¢ï¼‰æ—¶ï¼Œç›´æ¥ç”¨<code>+</code>è¿ç®—ç¬¦ä¼šäº§ç”Ÿå¤§é‡ä¸´æ—¶å¯¹è±¡ï¼Œæ¨èç”¨<code>strings.Builder</code>æˆ–<code>bytes.Buffer</code>ï¼Œå®ƒä»¬ä¼šé¢„åˆ†é…å†…å­˜ï¼Œå‡å°‘å†…å­˜æ‹·è´ï¼š</p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"strings"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// ä½æ•ˆï¼šé¢‘ç¹æ‹¼æ¥å­—ç¬¦ä¸²ï¼ˆäº§ç”Ÿå¤šä¸ªä¸´æ—¶å¯¹è±¡ï¼‰</span>
    <span class="hljs-keyword">var</span> str <span class="hljs-type">string</span>
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++ {
        str += fmt.Sprintf(<span class="hljs-string">"%d"</span>, i)
    }
    fmt.Println(<span class="hljs-string">"ä½æ•ˆæ–¹å¼é•¿åº¦ï¼š"</span>, <span class="hljs-built_in">len</span>(str))

    <span class="hljs-comment">// é«˜æ•ˆï¼šç”¨strings.Builder</span>
    <span class="hljs-keyword">var</span> builder strings.Builder
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++ {
        builder.WriteString(fmt.Sprintf(<span class="hljs-string">"%d"</span>, i))
    }
    efficientStr := builder.String()
    fmt.Println(<span class="hljs-string">"é«˜æ•ˆæ–¹å¼é•¿åº¦ï¼š"</span>, <span class="hljs-built_in">len</span>(efficientStr))
}

</code></pre>
<p>å‚è€ƒé“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fpkg.go.dev%2Fstrings%23Builder" target="_blank" title="https://pkg.go.dev/strings#Builder" ref="nofollow noopener noreferrer">strings.Builderå®˜æ–¹æ–‡æ¡£</a></p>
<h2 data-id="heading-20">6. UTF-8ç¼–ç ä¸runeã€byteåŒºåˆ«</h2>
<p>Goçš„å­—ç¬¦ä¸²é»˜è®¤ä½¿ç”¨UTF-8ç¼–ç ï¼Œè¿™æ˜¯å¤„ç†å¤šè¯­è¨€ï¼ˆå¦‚ä¸­æ–‡ã€æ—¥æ–‡ï¼‰çš„åŸºç¡€ã€‚ä½†UTF-8ç¼–ç ä¸­ï¼Œä¸åŒå­—ç¬¦å ç”¨çš„å­—èŠ‚æ•°ä¸åŒï¼ˆASCIIå­—ç¬¦å 1å­—èŠ‚ï¼Œä¸­æ–‡å 3å­—èŠ‚ï¼‰ï¼Œè¿™å°±éœ€è¦åŒºåˆ†<code>byte</code>å’Œ<code>rune</code>ä¸¤ä¸ªç±»å‹ã€‚</p>
<h3 data-id="heading-21">6.1 UTF-8ç¼–ç åŸºç¡€</h3>
<ul>
<li>
<p>UTF-8æ˜¯ä¸€ç§å¯å˜é•¿ç¼–ç ï¼Œå…¼å®¹ASCIIï¼ˆASCIIå­—ç¬¦çš„UTF-8ç¼–ç å°±æ˜¯å…¶æœ¬èº«ï¼‰ï¼›</p>
</li>
<li>
<p>å¸¸è§å­—ç¬¦å ç”¨å­—èŠ‚æ•°ï¼šâ‘  è‹±æ–‡ã€æ•°å­—ã€ç¬¦å·ï¼š1å­—èŠ‚ï¼›â‘¡ ä¸­æ–‡ã€æ—¥æ–‡ç­‰ï¼š3å­—èŠ‚ï¼›â‘¢ ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚emojiï¼‰ï¼š4å­—èŠ‚ï¼›</p>
</li>
<li>
<p>å­—ç¬¦ä¸²çš„<code>len()</code>å‡½æ•°è¿”å›çš„æ˜¯<strong>å­—èŠ‚æ•°</strong>ï¼Œä¸æ˜¯å­—ç¬¦æ•°ï¼ˆè¿™æ˜¯æ–°æ‰‹å¸¸è¸©çš„å‘ï¼‰ã€‚</p>
</li>
</ul>
<h3 data-id="heading-22">6.2 byteä¸runeçš„åŒºåˆ«</h3>























<table><thead><tr><th>ç±»å‹</th><th>æœ¬è´¨</th><th>ä½œç”¨</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>byte</td><td>uint8çš„åˆ«å</td><td>è¡¨ç¤º1ä¸ªå­—èŠ‚</td><td>å¤„ç†ASCIIå­—ç¬¦ã€å­—èŠ‚æ•°æ®ï¼ˆå¦‚æ–‡ä»¶ã€ç½‘ç»œä¼ è¾“ï¼‰</td></tr><tr><td>rune</td><td>int32çš„åˆ«å</td><td>è¡¨ç¤º1ä¸ªUnicodeå­—ç¬¦ï¼ˆUTF-8ç¼–ç çš„å­—ç¬¦ï¼‰</td><td>å¤„ç†å¤šè¯­è¨€å­—ç¬¦ï¼ˆå¦‚ä¸­æ–‡ã€æ—¥æ–‡ï¼‰ï¼Œç»Ÿè®¡å­—ç¬¦æ•°</td></tr></tbody></table>
<h3 data-id="heading-23">6.3 ä»£ç ç¤ºä¾‹ï¼šbyteä¸runeçš„ä½¿ç”¨</h3>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// 1. len()è¿”å›å­—èŠ‚æ•°ï¼Œä¸æ˜¯å­—ç¬¦æ•°</span>
    str := <span class="hljs-string">"ä½ å¥½Go"</span>
    fmt.Println(<span class="hljs-string">"å­—èŠ‚æ•°ï¼š"</span>, <span class="hljs-built_in">len</span>(str))  <span class="hljs-comment">// è¾“å‡ºï¼š8ï¼ˆ2ä¸ªä¸­æ–‡Ã—3 + 2ä¸ªå­—æ¯Ã—1 = 8ï¼‰</span>

    <span class="hljs-comment">// 2. ç”¨runeåˆ‡ç‰‡ç»Ÿè®¡å­—ç¬¦æ•°</span>
    runeSlice := []<span class="hljs-type">rune</span>(str)
    fmt.Println(<span class="hljs-string">"å­—ç¬¦æ•°ï¼š"</span>, <span class="hljs-built_in">len</span>(runeSlice))  <span class="hljs-comment">// è¾“å‡ºï¼š4ï¼ˆ2ä¸ªä¸­æ–‡ + 2ä¸ªå­—æ¯ï¼‰</span>

    <span class="hljs-comment">// 3. éå†å­—ç¬¦ä¸²ï¼ˆbyteéå† vs runeéå†ï¼‰</span>
    <span class="hljs-comment">// byteéå†ï¼ˆæŒ‰å­—èŠ‚éå†ï¼Œä¸­æ–‡ä¼šè¢«æ‹†åˆ†ï¼Œå‡ºç°ä¹±ç ï¼‰</span>
    fmt.Println(<span class="hljs-string">"byteéå†ï¼š"</span>)
    <span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">len</span>(str); i++ {
        fmt.Printf(<span class="hljs-string">"%c "</span>, str[i])  <span class="hljs-comment">// è¾“å‡ºï¼šÃ¤Â½Â  Ã¥Â¥Â½ G o ï¼ˆä¹±ç ï¼‰</span>
    }
    fmt.Println()

    <span class="hljs-comment">// runeéå†ï¼ˆæŒ‰å­—ç¬¦éå†ï¼Œæ­£ç¡®å¤„ç†ä¸­æ–‡ï¼‰</span>
    fmt.Println(<span class="hljs-string">"runeéå†ï¼ˆfor rangeï¼‰ï¼š"</span>)
    <span class="hljs-keyword">for</span> _, char := <span class="hljs-keyword">range</span> str {
        fmt.Printf(<span class="hljs-string">"%c "</span>, char)  <span class="hljs-comment">// è¾“å‡ºï¼šä½  å¥½ G o</span>
    }
    fmt.Println()

    <span class="hljs-comment">// 4. å•ä¸ªå­—ç¬¦çš„runeè¡¨ç¤º</span>
    <span class="hljs-keyword">var</span> char <span class="hljs-type">rune</span> = <span class="hljs-string">'ä¸­'</span>
    fmt.Println(<span class="hljs-string">"'ä¸­'çš„Unicodeç ï¼š"</span>, char)  <span class="hljs-comment">// è¾“å‡ºï¼š20013</span>
    fmt.Println(<span class="hljs-string">"'ä¸­'çš„UTF-8ç¼–ç å­—èŠ‚æ•°ï¼š"</span>, <span class="hljs-built_in">len</span>(<span class="hljs-type">string</span>(char)))  <span class="hljs-comment">// è¾“å‡ºï¼š3</span>
}

</code></pre>
<p><strong>å…³é”®ç»“è®º</strong>ï¼š</p>
<ul>
<li>
<p>å¤„ç†çº¯ASCIIå­—ç¬¦ä¸²ï¼šç”¨byteæˆ–ç›´æ¥æ“ä½œå­—ç¬¦ä¸²ï¼›</p>
</li>
<li>
<p>å¤„ç†å¤šè¯­è¨€å­—ç¬¦ä¸²ï¼šå¿…é¡»ç”¨runeåˆ‡ç‰‡ï¼ˆæˆ–for rangeéå†ï¼‰ï¼Œé¿å…ä¹±ç ï¼›</p>
</li>
<li>
<p>for rangeéå†å­—ç¬¦ä¸²æ—¶ï¼Œä¼šè‡ªåŠ¨å°†æ¯ä¸ªå­—ç¬¦è½¬ä¸ºruneç±»å‹ï¼Œä¸ä¼šå‡ºç°ä¹±ç ï¼ˆæ¨èç”¨è¿™ç§æ–¹å¼éå†å¤šè¯­è¨€å­—ç¬¦ä¸²ï¼‰ã€‚</p>
</li>
</ul>
<h2 data-id="heading-24">7. å­—ç¬¦ä¸²å¸¸ç”¨æ“ä½œä¸æ€§èƒ½æ³¨æ„ç‚¹</h2>
<p>Goçš„<code>strings</code>åŒ…æä¾›äº†å¤§é‡å­—ç¬¦ä¸²æ“ä½œå‡½æ•°ï¼Œè¦†ç›–æ‹¼æ¥ã€æŸ¥æ‰¾ã€æ›¿æ¢ã€åˆ†å‰²ç­‰å¸¸ç”¨åœºæ™¯ã€‚æˆ‘ä»¬é‡ç‚¹è®²é«˜é¢‘æ“ä½œå’Œæ€§èƒ½æ³¨æ„ç‚¹ã€‚</p>
<h3 data-id="heading-25">7.1 é«˜é¢‘æ“ä½œå‡½æ•°</h3>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"strings"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    str := <span class="hljs-string">"Hello, Go! Hello, World!"</span>

    <span class="hljs-comment">// 1. æ‹¼æ¥å­—ç¬¦ä¸²ï¼ˆç®€å•æ‹¼æ¥ç”¨+ï¼Œæ‰¹é‡æ‹¼æ¥ç”¨strings.Builderï¼‰</span>
    str1 := <span class="hljs-string">"Hello"</span>
    str2 := <span class="hljs-string">"Go"</span>
    fmt.Println(<span class="hljs-string">"æ‹¼æ¥ï¼š"</span>, str1+<span class="hljs-string">", "</span>+str2)  <span class="hljs-comment">// è¾“å‡ºï¼šæ‹¼æ¥ï¼šHello, Go</span>

    <span class="hljs-comment">// 2. æŸ¥æ‰¾å­ä¸²</span>
    fmt.Println(<span class="hljs-string">"æ˜¯å¦åŒ…å«'Go'ï¼š"</span>, strings.Contains(str, <span class="hljs-string">"Go"</span>))  <span class="hljs-comment">// è¾“å‡ºï¼štrue</span>
    fmt.Println(<span class="hljs-string">"'Go'ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ï¼š"</span>, strings.Index(str, <span class="hljs-string">"Go"</span>))  <span class="hljs-comment">// è¾“å‡ºï¼š7</span>
    fmt.Println(<span class="hljs-string">"'Go'æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ï¼š"</span>, strings.LastIndex(str, <span class="hljs-string">"Go"</span>))  <span class="hljs-comment">// è¾“å‡ºï¼š15</span>

    <span class="hljs-comment">// 3. æ›¿æ¢å­ä¸²</span>
    <span class="hljs-comment">// æ›¿æ¢æ‰€æœ‰"Hello"ä¸º"Hi"</span>
    newStr := strings.ReplaceAll(str, <span class="hljs-string">"Hello"</span>, <span class="hljs-string">"Hi"</span>)
    fmt.Println(<span class="hljs-string">"æ›¿æ¢åï¼š"</span>, newStr)  <span class="hljs-comment">// è¾“å‡ºï¼šHi, Go! Hi, World!</span>
    <span class="hljs-comment">// æ›¿æ¢å‰2ä¸ª"Hello"ä¸º"Hi"ï¼ˆstrings.Replaceçš„ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æ›¿æ¢æ¬¡æ•°ï¼Œ-1è¡¨ç¤ºå…¨éƒ¨ï¼‰</span>
    newStr2 := strings.Replace(str, <span class="hljs-string">"Hello"</span>, <span class="hljs-string">"Hi"</span>, <span class="hljs-number">2</span>)
    fmt.Println(<span class="hljs-string">"æ›¿æ¢å‰2ä¸ªï¼š"</span>, newStr2)

    <span class="hljs-comment">// 4. åˆ†å‰²ä¸æ‹¼æ¥</span>
    parts := strings.Split(str, <span class="hljs-string">", "</span>)  <span class="hljs-comment">// æŒ‰", "åˆ†å‰²</span>
    fmt.Println(<span class="hljs-string">"åˆ†å‰²åï¼š"</span>, parts)  <span class="hljs-comment">// è¾“å‡ºï¼š[Hello Go! Hello World!]</span>
    joined := strings.Join(parts, <span class="hljs-string">" - "</span>)  <span class="hljs-comment">// ç”¨" - "æ‹¼æ¥</span>
    fmt.Println(<span class="hljs-string">"æ‹¼æ¥åï¼š"</span>, joined)  <span class="hljs-comment">// è¾“å‡ºï¼šHello - Go! - Hello - World!</span>

    <span class="hljs-comment">// 5. å¤§å°å†™è½¬æ¢</span>
    fmt.Println(<span class="hljs-string">"è½¬å¤§å†™ï¼š"</span>, strings.ToUpper(str))
    fmt.Println(<span class="hljs-string">"è½¬å°å†™ï¼š"</span>, strings.ToLower(str))

    <span class="hljs-comment">// 6. å»é™¤é¦–å°¾ç©ºç™½ï¼ˆç©ºæ ¼ã€æ¢è¡Œã€åˆ¶è¡¨ç¬¦ç­‰ï¼‰</span>
    str3 := <span class="hljs-string">"  Hello Go  \n"</span>
    fmt.Println(<span class="hljs-string">"å»é™¤ç©ºç™½åï¼š"</span>, strings.TrimSpace(str3))  <span class="hljs-comment">// è¾“å‡ºï¼šHello Go</span>
}

</code></pre>
<h3 data-id="heading-26">7.2 æ€§èƒ½æ³¨æ„ç‚¹</h3>
<ul>
<li>
<p>é¿å…é¢‘ç¹ç”¨<code>+</code>æ‹¼æ¥å­—ç¬¦ä¸²ï¼šå°¤å…¶æ˜¯åœ¨å¾ªç¯ä¸­ï¼Œæ¨èç”¨<code>strings.Builder</code>ï¼ˆæ€§èƒ½æœ€ä¼˜ï¼‰æˆ–<code>bytes.Buffer</code>ï¼›</p>
</li>
<li>
<p>strings.Joinæ€§èƒ½ä¼˜äºå¤šæ¬¡+æ‹¼æ¥ï¼šJoinä¼šå…ˆè®¡ç®—æ€»é•¿åº¦ï¼Œé¢„åˆ†é…å†…å­˜ï¼Œå†è¿›è¡Œæ‹¼æ¥ï¼Œé€‚åˆæ‰¹é‡æ‹¼æ¥åˆ‡ç‰‡ä¸­çš„å­—ç¬¦ä¸²ï¼›</p>
</li>
<li>
<p>é¿å…ä¸å¿…è¦çš„å­—ç¬¦ä¸²æ‹·è´ï¼šå¦‚å­—ç¬¦ä¸²åˆ‡ç‰‡ï¼ˆstr[1:4]ï¼‰ä¸ä¼šæ‹·è´åº•å±‚æ•°æ®ï¼Œç›´æ¥å¼•ç”¨åŸæ•°ç»„ï¼Œæ€§èƒ½å¾ˆé«˜ï¼›</p>
</li>
<li>
<p>å¤šè¯­è¨€å­—ç¬¦ä¸²æ“ä½œæ³¨æ„ç”¨runeï¼šå¦‚ç»Ÿè®¡å­—ç¬¦æ•°ã€æˆªå–å­ä¸²æ—¶ï¼Œå…ˆè½¬ä¸ºruneåˆ‡ç‰‡ï¼Œé¿å…ç ´åUTF-8ç¼–ç ï¼ˆå¦‚æˆªå–ä¸­æ–‡æ—¶å‡ºç°ä¹±ç ï¼‰ã€‚</p>
</li>
</ul>
<p>å‚è€ƒé“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fpkg.go.dev%2Fstrings" target="_blank" title="https://pkg.go.dev/strings" ref="nofollow noopener noreferrer">stringsåŒ…å®˜æ–¹æ–‡æ¡£ï¼ˆå®Œæ•´å‡½æ•°åˆ—è¡¨ï¼‰</a></p>
<h2 data-id="heading-27">8. ç±»å‹åˆ«åä¸è‡ªå®šä¹‰ç±»å‹</h2>
<p>Goå…è®¸é€šè¿‡<code>type</code>å…³é”®å­—å®šä¹‰ç±»å‹åˆ«åæˆ–è‡ªå®šä¹‰ç±»å‹ï¼Œç”¨äºå¢å¼ºä»£ç çš„å¯è¯»æ€§å’Œç±»å‹å®‰å…¨æ€§ã€‚å¾ˆå¤šæ–°æ‰‹ä¼šæ··æ·†è¿™ä¸¤ä¸ªæ¦‚å¿µï¼Œæˆ‘ä»¬æ¥æ˜ç¡®åŒºåˆ†ã€‚</p>
<h3 data-id="heading-28">8.1 ç±»å‹åˆ«åï¼ˆType Aliasï¼‰</h3>
<p><strong>å®šä¹‰è¯­æ³•</strong>ï¼š<code>type åˆ«å åŸç±»å‹</code></p>
<p>æ ¸å¿ƒç‰¹ç‚¹ï¼š</p>
<ul>
<li>
<p>ç±»å‹åˆ«åå’ŒåŸç±»å‹æ˜¯â€œåŒä¸€ä¸ªç±»å‹â€ï¼Œå¯ä»¥ç›´æ¥ç›¸äº’èµ‹å€¼ï¼Œæ— éœ€æ˜¾å¼è½¬æ¢ï¼›</p>
</li>
<li>
<p>ä¸»è¦ä½œç”¨æ˜¯ç®€åŒ–é•¿ç±»å‹åï¼ˆå¦‚å¤æ‚çš„ç»“æ„ä½“ç±»å‹ã€å‡½æ•°ç±»å‹ï¼‰ï¼Œæˆ–è§£å†³ç±»å‹å‘½åå†²çªã€‚</p>
</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹ï¼šç±»å‹åˆ«å</strong></p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-comment">// å®šä¹‰ç±»å‹åˆ«åï¼šMyIntæ˜¯intçš„åˆ«å</span>
<span class="hljs-keyword">type</span> MyInt <span class="hljs-type">int</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">var</span> a <span class="hljs-type">int</span> = <span class="hljs-number">10</span>
    <span class="hljs-keyword">var</span> b MyInt = <span class="hljs-number">20</span>

    <span class="hljs-comment">// ç±»å‹åˆ«åå¯ä»¥ç›´æ¥èµ‹å€¼ï¼ˆæ— éœ€è½¬æ¢ï¼‰</span>
    a = <span class="hljs-type">int</span>(b)  <span class="hljs-comment">// è™½ç„¶å¯ä»¥ç›´æ¥èµ‹å€¼ï¼Œä½†æ˜¾å¼è½¬æ¢æ›´æ¸…æ™°</span>
    b = MyInt(a)
    fmt.Println(a, b)  <span class="hljs-comment">// è¾“å‡ºï¼š20 20</span>

    <span class="hljs-comment">// byteæ˜¯uint8çš„åˆ«åï¼Œruneæ˜¯int32çš„åˆ«åï¼ˆGoå†…ç½®åˆ«åï¼‰</span>
    <span class="hljs-keyword">var</span> c <span class="hljs-type">byte</span> = <span class="hljs-string">'A'</span>
    <span class="hljs-keyword">var</span> d <span class="hljs-type">uint8</span> = c
    fmt.Println(c, d)  <span class="hljs-comment">// è¾“å‡ºï¼š65 65</span>
}
</code></pre>
<h3 data-id="heading-29">8.2 è‡ªå®šä¹‰ç±»å‹ï¼ˆDefined Typeï¼‰</h3>
<p><strong>å®šä¹‰è¯­æ³•</strong>ï¼š<code>type è‡ªå®šä¹‰ç±»å‹å åº•å±‚ç±»å‹</code></p>
<p>æ ¸å¿ƒç‰¹ç‚¹ï¼š</p>
<ul>
<li>
<p>è‡ªå®šä¹‰ç±»å‹æ˜¯â€œæ–°ç±»å‹â€ï¼Œå’Œåº•å±‚ç±»å‹ä¸ç›¸ç­‰ï¼Œä¸èƒ½ç›´æ¥èµ‹å€¼ï¼ˆå¿…é¡»æ˜¾å¼è½¬æ¢ï¼‰ï¼›</p>
</li>
<li>
<p>å¯ä»¥ä¸ºè‡ªå®šä¹‰ç±»å‹æ·»åŠ æ–¹æ³•ï¼ˆè¿™æ˜¯Goå®ç°é¢å‘å¯¹è±¡çš„æ ¸å¿ƒæ–¹å¼ä¹‹ä¸€ï¼‰ï¼›</p>
</li>
<li>
<p>ä¸»è¦ä½œç”¨æ˜¯å¢å¼ºç±»å‹å®‰å…¨æ€§ï¼ˆå¦‚åŒºåˆ†ä¸åŒå«ä¹‰çš„intç±»å‹ï¼‰ï¼Œæˆ–å°è£…ç‰¹å®šè¡Œä¸ºã€‚</p>
</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹ï¼šè‡ªå®šä¹‰ç±»å‹</strong></p>
<pre><code class="hljs language-go" lang="go">
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> <span class="hljs-string">"fmt"</span>

<span class="hljs-comment">// è‡ªå®šä¹‰ç±»å‹ï¼šUserIDæ˜¯åº•å±‚ç±»å‹ä¸ºintçš„æ–°ç±»å‹</span>
<span class="hljs-keyword">type</span> UserID <span class="hljs-type">int</span>
<span class="hljs-comment">// è‡ªå®šä¹‰ç±»å‹ï¼šProductIDæ˜¯åº•å±‚ç±»å‹ä¸ºintçš„æ–°ç±»å‹</span>
<span class="hljs-keyword">type</span> ProductID <span class="hljs-type">int</span>

<span class="hljs-comment">// ä¸ºUserIDæ·»åŠ æ–¹æ³•</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(u UserID)</span></span> String() <span class="hljs-type">string</span> {
    <span class="hljs-keyword">return</span> fmt.Sprintf(<span class="hljs-string">"ç”¨æˆ·IDï¼š%d"</span>, u)
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">var</span> uid UserID = <span class="hljs-number">10001</span>
    <span class="hljs-keyword">var</span> pid ProductID = <span class="hljs-number">20001</span>

    <span class="hljs-comment">// é”™è¯¯ï¼šè‡ªå®šä¹‰ç±»å‹ä¸èƒ½ç›´æ¥èµ‹å€¼ï¼ˆå³ä½¿åº•å±‚ç±»å‹ç›¸åŒï¼‰</span>
    <span class="hljs-comment">// uid = pid  // ç¼–è¯‘æŠ¥é”™ï¼šcannot use pid (type ProductID) as type UserID in assignment</span>

    <span class="hljs-comment">// æ­£ç¡®ï¼šæ˜¾å¼è½¬æ¢ï¼ˆéœ€è¦ç¡®ä¿è¯­ä¹‰æ­£ç¡®ï¼‰</span>
    uid = UserID(pid)
    fmt.Println(uid.String())  <span class="hljs-comment">// è¾“å‡ºï¼šç”¨æˆ·IDï¼š20001</span>

    <span class="hljs-comment">// è‡ªå®šä¹‰ç±»å‹ä¸åº•å±‚ç±»å‹çš„è½¬æ¢</span>
    <span class="hljs-keyword">var</span> num <span class="hljs-type">int</span> = <span class="hljs-number">30001</span>
    uid = UserID(num)  <span class="hljs-comment">// æ˜¾å¼è½¬æ¢</span>
    num = <span class="hljs-type">int</span>(uid)     <span class="hljs-comment">// æ˜¾å¼è½¬æ¢</span>
    fmt.Println(num)  <span class="hljs-comment">// è¾“å‡ºï¼š30001</span>
}

</code></pre>
<h3 data-id="heading-30">8.3 å®æˆ˜åŒºåˆ«ä¸å»ºè®®</h3>

























<table><thead><tr><th>ç‰¹æ€§</th><th>ç±»å‹åˆ«å</th><th>è‡ªå®šä¹‰ç±»å‹</th></tr></thead><tbody><tr><td>ä¸åŸç±»å‹å…³ç³»</td><td>åŒä¸€ç±»å‹ï¼Œå¯ç›´æ¥èµ‹å€¼</td><td>ä¸åŒç±»å‹ï¼Œéœ€æ˜¾å¼è½¬æ¢</td></tr><tr><td>èƒ½å¦æ·»åŠ æ–¹æ³•</td><td>ä¸èƒ½ï¼ˆæ–¹æ³•æ¥æ”¶è€…å¿…é¡»æ˜¯è‡ªå®šä¹‰ç±»å‹ï¼‰</td><td>å¯ä»¥</td></tr><tr><td>ä½¿ç”¨åœºæ™¯</td><td>ç®€åŒ–é•¿ç±»å‹åã€è§£å†³å‘½åå†²çª</td><td>å¢å¼ºç±»å‹å®‰å…¨æ€§ã€å°è£…è¡Œä¸ºï¼ˆæ·»åŠ æ–¹æ³•ï¼‰</td></tr></tbody></table>
<p><strong>å»ºè®®</strong>ï¼šæ—¥å¸¸å¼€å‘ä¸­ï¼Œä¼˜å…ˆä½¿ç”¨è‡ªå®šä¹‰ç±»å‹ï¼ˆè€Œéç±»å‹åˆ«åï¼‰æ¥åŒºåˆ†ä¸åŒè¯­ä¹‰çš„å˜é‡ï¼ˆå¦‚UserIDå’ŒProductIDï¼‰ï¼Œé¿å…å› ç±»å‹ç›¸åŒå¯¼è‡´çš„è¯­ä¹‰æ··æ·†bugã€‚</p>
<h2 data-id="heading-31">æ€»ç»“</h2>
<p>æœ¬ç« æˆ‘ä»¬æ·±å…¥æ‹†è§£äº†Goçš„å››ç±»ç®€å•æ•°æ®ç±»å‹ï¼Œæ ¸å¿ƒè¦ç‚¹æ€»ç»“å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p>æ•´å‹ï¼šä¼˜å…ˆæ˜ç¡®é•¿åº¦ï¼ˆint32/int64ï¼‰ï¼Œé¿å…ç”¨é»˜è®¤intï¼Œé˜²æ­¢è·¨å¹³å°é—®é¢˜å’Œæº¢å‡ºï¼›æ— ç¬¦å·æ•´å‹é€‚åˆéè´Ÿåœºæ™¯ï¼ˆå¦‚å­—èŠ‚ã€ç«¯å£å·ï¼‰ï¼›</p>
</li>
<li>
<p>æµ®ç‚¹æ•°ï¼šä¼˜å…ˆç”¨float64ï¼Œé¿å…ç›´æ¥æ¯”è¾ƒï¼Œé‡‘èåœºæ™¯ç”¨æ•´æ•°æˆ–é«˜ç²¾åº¦åº“ï¼›</p>
</li>
<li>
<p>å¸ƒå°”ç±»å‹ï¼šä¸å¯è½¬æ¢ã€ä¸å¯å‚ä¸æ•°å€¼è¿ç®—ï¼Œé€»è¾‘è¿ç®—æ”¯æŒçŸ­è·¯ç‰¹æ€§ï¼›</p>
</li>
<li>
<p>å­—ç¬¦ä¸²ï¼šä¸å¯å˜ï¼Œåº•å±‚æ˜¯å­—èŠ‚æ•°ç»„ï¼›å¤„ç†å¤šè¯­è¨€ç”¨runeï¼Œé¿å…ä¹±ç ï¼›é¢‘ç¹ä¿®æ”¹ç”¨strings.Builderï¼›</p>
</li>
<li>
<p>ç±»å‹åˆ«åä¸è‡ªå®šä¹‰ç±»å‹ï¼šåˆ«åæ˜¯åŒä¸€ç±»å‹ï¼Œè‡ªå®šä¹‰æ˜¯æ–°ç±»å‹ï¼Œåè€…å¯æ·»åŠ æ–¹æ³•ï¼Œå¢å¼ºç±»å‹å®‰å…¨æ€§ã€‚</p>
</li>
</ol>
<p>è¿™äº›ç±»å‹æ˜¯Goå¼€å‘çš„åŸºç¡€ï¼Œå»ºè®®å¤šåŠ¨æ‰‹ç»ƒä¹ å¸¸ç”¨æ“ä½œï¼ˆå¦‚å­—ç¬¦ä¸²å¤„ç†ã€ç±»å‹è½¬æ¢ï¼‰ï¼Œç†Ÿç»ƒæŒæ¡åèƒ½å¤§å¹…æå‡ç¼–ç æ•ˆç‡ã€‚å¦‚æœæœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµï½</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[16 ä¸ªå‰ç«¯å†·çŸ¥è¯†ï¼šç”¨ä¸€æ¬¡å°±å¿˜ä¸æ‰çš„é‚£ç§]]></title>    <link>https://juejin.cn/post/7598081541563138088</link>    <guid>https://juejin.cn/post/7598081541563138088</guid>    <pubDate>2026-01-23T00:39:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598081541563138088" data-draft-id="7589063105731903503" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="16 ä¸ªå‰ç«¯å†·çŸ¥è¯†ï¼šç”¨ä¸€æ¬¡å°±å¿˜ä¸æ‰çš„é‚£ç§"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-23T00:39:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å¤§å"/> <meta itemprop="url" content="https://juejin.cn/user/3507878440995946"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            16 ä¸ªå‰ç«¯å†·çŸ¥è¯†ï¼šç”¨ä¸€æ¬¡å°±å¿˜ä¸æ‰çš„é‚£ç§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3507878440995946/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å¤§å
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T00:39:47.000Z" title="Fri Jan 23 2026 00:39:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€œè¿™ä¸ªBugæˆ‘è°ƒäº†ä¿©å°æ—¶ï¼â€
â€œæ—©çŸ¥é“æœ‰è¿™ä¸ªå±æ€§å°±å¥½äº†â€¦â€¦â€</p>
<p>è¿™ç§å¯¹è¯ï¼Œåœ¨ç¨‹åºå‘˜ä¹‹é—´å¯ä»¥è¯´æ˜¯å¤ªå¸¸è§äº†ã€‚</p>
<p>å¾ˆå¤šé—®é¢˜ï¼Œä¸€æ—¦çŸ¥é“è¯€çªï¼Œä¸‰äº”åˆ†é’Ÿå°±èƒ½è§£å†³ï¼›å¯å¦‚æœä¸çŸ¥é“ï¼Œå¾ˆå¯èƒ½å°±éœ€è¦è€—ä¸Šå¤§åŠå¤©çš„æ—¶é—´å»å¤„ç†ã€‚</p>
<p>äºæ˜¯æˆ‘å°±å†³å®šï¼ŒæŠŠè¿™äº›å¹³æ—¶å¯èƒ½æ²¡äººä¸“é—¨è®²ï¼Œä½†åˆç‰¹åˆ«å®ç”¨çš„å‰ç«¯å†·çŸ¥è¯†æ•´ç†äº†ä¸€ä¸‹ï¼Œä¿å‡†ä½ çœ‹å®Œæœ‰æ”¶è·ã€‚</p>
<h2 data-id="heading-0">1. CSSä¸­çš„:hoverä¼ªç±»ä¹Ÿå¯ä»¥ç”¨äºéé“¾æ¥å…ƒç´ </h2>
<p>å¾ˆå¤šäººä»¥ä¸º:hoveråªèƒ½ç”¨åœ¨aæ ‡ç­¾ä¸Šï¼Œå…¶å®ä¸ç„¶ï¼ä»»ä½•å…ƒç´ éƒ½å¯ä»¥ä½¿ç”¨:hoverä¼ªç±»ã€‚</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* ä¸åªæ˜¯é“¾æ¥ï¼Œdivä¹Ÿå¯ä»¥æœ‰æ‚¬åœæ•ˆæœ */</span>
<span class="hljs-selector-tag">div</span><span class="hljs-selector-pseudo">:hover</span> {
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#f0f0f0</span>;
  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;
}
</code></pre>
<p><strong>å®ç”¨åœºæ™¯</strong>ï¼šä¸ºè¡¨æ ¼è¡Œã€å¡ç‰‡ç»„ä»¶ç­‰æ·»åŠ æ‚¬åœæ•ˆæœï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚</p>
<h2 data-id="heading-1">2. ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„thisç»‘å®š</h2>
<p>è¿™æ˜¯ES6ç®­å¤´å‡½æ•°çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§ï¼Œä½†ç»å¸¸è¢«å¿½ç•¥ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"å‰ç«¯å°ç™½"</span>,
  <span class="hljs-attr">regularFunc</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// "å‰ç«¯å°ç™½"</span>
  },
  <span class="hljs-attr">arrowFunc</span>: <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// undefinedï¼ˆè¿™é‡Œçš„thisæ˜¯å¤–å±‚ä½œç”¨åŸŸçš„thisï¼‰</span>
  }
};
</code></pre>
<p><strong>åŸç†åˆ†æ</strong>ï¼šç®­å¤´å‡½æ•°ä¸ç»‘å®šè‡ªå·±çš„thisï¼Œè€Œæ˜¯ç»§æ‰¿çˆ¶çº§ä½œç”¨åŸŸçš„thiså€¼ã€‚</p>
<h2 data-id="heading-2">3. å¿«é€Ÿæµ®ç‚¹æ•°è½¬æ•´æ•°</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è¿™ä¸‰ç§æ–¹å¼éƒ½å¯ä»¥å°†æµ®ç‚¹æ•°è½¬ä¸ºæ•´æ•°</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(~~<span class="hljs-number">3.14</span>);        <span class="hljs-comment">// 3</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">3.14</span> | <span class="hljs-number">0</span>);      <span class="hljs-comment">// 3</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">3.14</span> &gt;&gt; <span class="hljs-number">0</span>);     <span class="hljs-comment">// 3</span>
</code></pre>
<p><strong>æ³¨æ„</strong>ï¼šè¿™äº›æ–¹æ³•åªé€‚ç”¨äº32ä½æ•´æ•°ï¼Œå¤§æ•°æƒ…å†µä¸‹å¯èƒ½ä¼šå‡ºç°é—®é¢˜ã€‚</p>
<h2 data-id="heading-3">4. ä½¿ç”¨datasetæ“ä½œè‡ªå®šä¹‰æ•°æ®å±æ€§</h2>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"user"</span> <span class="hljs-attr">data-id</span>=<span class="hljs-string">"123"</span> <span class="hljs-attr">data-user-name</span>=<span class="hljs-string">"å°æ˜"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> user = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'user'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user.<span class="hljs-property">dataset</span>.<span class="hljs-property">id</span>);        <span class="hljs-comment">// "123"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user.<span class="hljs-property">dataset</span>.<span class="hljs-property">userName</span>); <span class="hljs-comment">// "å°æ˜"ï¼ˆæ³¨æ„é©¼å³°å‘½åï¼‰</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼šæ¯”getAttribute/setAttributeæ›´ç®€æ´ï¼Œä¸”è‡ªåŠ¨è¿›è¡Œæ•°æ®ç±»å‹è½¬æ¢ã€‚</p>
<h2 data-id="heading-4">5. ä½¿ç”¨navigator.onLineæ£€æµ‹ç½‘ç»œçŠ¶æ€</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ£€æµ‹ç”¨æˆ·æ˜¯å¦åœ¨çº¿</span>
<span class="hljs-keyword">if</span> (navigator.<span class="hljs-property">onLine</span>) {
  <span class="hljs-comment">// åœ¨çº¿é€»è¾‘</span>
} <span class="hljs-keyword">else</span> {
  <span class="hljs-comment">// ç¦»çº¿é€»è¾‘</span>
}

<span class="hljs-comment">// ç›‘å¬ç½‘ç»œçŠ¶æ€å˜åŒ–</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'online'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç½‘ç»œå·²è¿æ¥'</span>);
});
</code></pre>
<p><strong>åº”ç”¨åœºæ™¯</strong>ï¼šPWAåº”ç”¨ã€èµ„æºåŠ è½½ä¼˜åŒ–ç­‰ã€‚</p>
<h2 data-id="heading-5">6. ä½¿ç”¨contenteditableä½¿å…ƒç´ å¯ç¼–è¾‘</h2>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">contenteditable</span>=<span class="hljs-string">"true"</span>&gt;</span>
  ç‚¹å‡»æˆ‘å°±å¯ä»¥ç›´æ¥ç¼–è¾‘å†…å®¹ï¼
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p><strong>å®ç”¨æŠ€å·§</strong>ï¼šå¯ä»¥ç»“åˆlocalStorageå®ç°ç®€å•çš„å®æ—¶é¢„è§ˆç¼–è¾‘å™¨ã€‚</p>
<h2 data-id="heading-6">7. ä½¿ç”¨currentScriptè·å–å½“å‰æ‰§è¡Œçš„scriptæ ‡ç­¾</h2>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å½“å‰è„šæœ¬:'</span>, <span class="hljs-variable language_">document</span>.<span class="hljs-property">currentScript</span>.<span class="hljs-property">src</span>);
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><strong>åº”ç”¨åœºæ™¯</strong>ï¼šåœ¨è„šæœ¬ä¸­åŠ¨æ€åŠ è½½ä¾èµ–èµ„æºæ—¶éå¸¸æœ‰ç”¨ã€‚</p>
<h2 data-id="heading-7">8. ä½¿ç”¨passiveä¼˜åŒ–æ»šåŠ¨æ€§èƒ½</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¸å¥½çš„åšæ³•ï¼ˆå¯èƒ½é˜»å¡æ»šåŠ¨ï¼‰</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'touchmove'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) {
  <span class="hljs-comment">// å¤„ç†é€»è¾‘</span>
});

<span class="hljs-comment">// å¥½çš„åšæ³•</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'touchmove'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) {
  <span class="hljs-comment">// å¤„ç†é€»è¾‘</span>
}, { <span class="hljs-attr">passive</span>: <span class="hljs-literal">true</span> });
</code></pre>
<p><strong>åŸç†</strong>ï¼šå‘Šè¯‰æµè§ˆå™¨äº‹ä»¶å¤„ç†å‡½æ•°ä¸ä¼šè°ƒç”¨preventDefault()ï¼Œä»è€Œæå‡æ»šåŠ¨æ€§èƒ½ã€‚</p>
<h2 data-id="heading-8">9. ä½¿ç”¨clampå®ç°å“åº”å¼å­—ä½“å¤§å°</h2>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.text</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-built_in">clamp</span>(<span class="hljs-number">16px</span>, <span class="hljs-number">4vw</span>, <span class="hljs-number">24px</span>);
}
<span class="hljs-comment">/* å­—ä½“å¤§å°ä¼šåœ¨16px-24pxä¹‹é—´è‡ªé€‚åº” */</span>
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼šæ¯”åª’ä½“æŸ¥è¯¢æ›´ç®€æ´ï¼Œå®ç°çœŸæ­£çš„æµä½“æ’ç‰ˆã€‚</p>
<h2 data-id="heading-9">10. ä½¿ç”¨inæ“ä½œç¬¦æ£€æŸ¥å¯¹è±¡å±æ€§</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> obj = { <span class="hljs-attr">name</span>: <span class="hljs-string">'å°æ˜'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> };

<span class="hljs-comment">// æ£€æŸ¥å±æ€§æ˜¯å¦å­˜åœ¨</span>
<span class="hljs-keyword">if</span> (<span class="hljs-string">'name'</span> <span class="hljs-keyword">in</span> obj) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'nameå±æ€§å­˜åœ¨'</span>);
}
</code></pre>
<p><strong>ä¸hasOwnPropertyçš„åŒºåˆ«</strong>ï¼šinä¼šæ£€æŸ¥åŸå‹é“¾ä¸Šçš„å±æ€§ï¼Œè€ŒhasOwnPropertyåªæ£€æŸ¥è‡ªèº«å±æ€§ã€‚</p>
<h2 data-id="heading-10">11. ä½¿ç”¨Array.fromå°†ç±»æ•°ç»„è½¬ä¸ºçœŸå®æ•°ç»„</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å°†NodeListè½¬ä¸ºæ•°ç»„</span>
<span class="hljs-keyword">const</span> divs = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'div'</span>));

<span class="hljs-comment">// å°†argumentsè½¬ä¸ºæ•°ç»„</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">example</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> args = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">arguments</span>);
  <span class="hljs-comment">// ç°åœ¨å¯ä»¥ä½¿ç”¨æ•°ç»„æ–¹æ³•äº†</span>
}
</code></pre>
<h2 data-id="heading-11">12. ä½¿ç”¨performance APIè¿›è¡Œæ€§èƒ½ç›‘æ§</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ ‡è®°å¼€å§‹æ—¶é—´</span>
performance.<span class="hljs-title function_">mark</span>(<span class="hljs-string">'start'</span>);

<span class="hljs-comment">// æ‰§è¡Œä¸€äº›æ“ä½œ</span>
<span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++) {}

<span class="hljs-comment">// æ ‡è®°ç»“æŸæ—¶é—´å¹¶æµ‹é‡</span>
performance.<span class="hljs-title function_">mark</span>(<span class="hljs-string">'end'</span>);
performance.<span class="hljs-title function_">measure</span>(<span class="hljs-string">'æ“ä½œè€—æ—¶'</span>, <span class="hljs-string">'start'</span>, <span class="hljs-string">'end'</span>);

<span class="hljs-keyword">const</span> measure = performance.<span class="hljs-title function_">getEntriesByName</span>(<span class="hljs-string">'æ“ä½œè€—æ—¶'</span>)[<span class="hljs-number">0</span>];
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ“ä½œè€—æ—¶: <span class="hljs-subst">${measure.duration}</span>æ¯«ç§’`</span>);
</code></pre>
<h2 data-id="heading-12">13. ä½¿ç”¨structuredCloneè¿›è¡Œæ·±æ‹·è´</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> obj = { <span class="hljs-attr">name</span>: <span class="hljs-string">"å°æ˜"</span>, <span class="hljs-attr">hobbies</span>: [<span class="hljs-string">"ç¯®çƒ"</span>, <span class="hljs-string">"æ¸¸æ³³"</span>] };
<span class="hljs-keyword">const</span> cloned = <span class="hljs-title function_">structuredClone</span>(obj); <span class="hljs-comment">// çœŸæ­£çš„æ·±æ‹·è´</span>
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼šæ¯”JSON.parse(JSON.stringify(obj))æ›´å¯é ï¼Œå¯ä»¥å¤„ç†å¾ªç¯å¼•ç”¨ã€‚</p>
<h2 data-id="heading-13">14. ä½¿ç”¨CSSçš„:whereå’Œ:isç®€åŒ–é€‰æ‹©å™¨</h2>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* ä¼ ç»Ÿå†™æ³• */</span>
<span class="hljs-selector-tag">header</span> <span class="hljs-selector-tag">h1</span>, <span class="hljs-selector-tag">header</span> <span class="hljs-selector-tag">h2</span>, <span class="hljs-selector-tag">header</span> <span class="hljs-selector-tag">h3</span> {
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">1rem</span>;
}

<span class="hljs-comment">/* ç®€åŒ–å†™æ³• */</span>
<span class="hljs-selector-tag">header</span> <span class="hljs-selector-pseudo">:is</span>(<span class="hljs-selector-tag">h1</span>, <span class="hljs-selector-tag">h2</span>, <span class="hljs-selector-tag">h3</span>) {
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">1rem</span>;
}
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼šä»£ç æ›´ç®€æ´ï¼Œæ˜“äºç»´æŠ¤ã€‚</p>
<h2 data-id="heading-14">15. ä½¿ç”¨requestIdleCallbackè¿›è¡Œä»»åŠ¡è°ƒåº¦</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">processTask</span>(<span class="hljs-params">deadline</span>) {
  <span class="hljs-keyword">while</span> (deadline.<span class="hljs-title function_">timeRemaining</span>() &gt; <span class="hljs-number">0</span> &amp;&amp; tasks.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
    <span class="hljs-comment">// åœ¨ç©ºé—²æ—¶é—´æ‰§è¡Œä»»åŠ¡</span>
    <span class="hljs-title function_">processTask</span>(tasks.<span class="hljs-title function_">shift</span>());
  }
  
  <span class="hljs-keyword">if</span> (tasks.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
    <span class="hljs-title function_">requestIdleCallback</span>(processTask);
  }
}

<span class="hljs-title function_">requestIdleCallback</span>(processTask);
</code></pre>
<p><strong>åº”ç”¨åœºæ™¯</strong>ï¼šå¤§æ•°æ®æ¸²æŸ“ã€å¤æ‚è®¡ç®—ç­‰éœ€è¦ä¼˜åŒ–æ€§èƒ½çš„åœºæ™¯ã€‚</p>
<h2 data-id="heading-15">16. ä½ å¯èƒ½ä¸çŸ¥é“çš„console.logé»‘ç§‘æŠ€</h2>
<p>æœ€åä¸€ä¸ªï¼Œä½ å¯èƒ½ä¸çŸ¥é“console.logè¿˜æœ‰è¿™äº›ç”¨æ³•ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. ä½¿ç”¨CSSæ ·å¼</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'%cè¿™æ˜¯çº¢è‰²å¤§å­—'</span>, <span class="hljs-string">'color: red; font-size: 20px;'</span>);

<span class="hljs-comment">// 2. åˆ†ç»„æ‰“å°</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">group</span>(<span class="hljs-string">'ç”¨æˆ·ä¿¡æ¯'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å§“å: å°æ˜'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¹´é¾„: 20'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">groupEnd</span>();

<span class="hljs-comment">// 3. æ¡ä»¶æ‰“å°</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">assert</span>(<span class="hljs-number">1</span> === <span class="hljs-number">2</span>, <span class="hljs-string">'è¿™ä¸ªæ¡ä»¶ä¸ºfalseæ—¶ä¼šæ‰“å°'</span>);
</code></pre>
<h2 data-id="heading-16">æ€»ç»“</h2>
<p>è¯´å®è¯ï¼Œä¸Šé¢è¿™äº›å°æŠ€å·§ï¼Œæˆ‘ç°åœ¨ä¹Ÿè®°ä¸å…¨ã€‚å¹³æ—¶å†™ä¸šåŠ¡ä»£ç ï¼Œå¯èƒ½80%çš„æ—¶é—´éƒ½ç”¨ä¸ä¸Šå®ƒä»¬ã€‚</p>
<p>ä½†çœ‹ä¸Šä¸€ä¸¤éæœ‰ç‚¹å°è±¡ä¹‹åï¼Œåœ¨å“ªå¤©ç¢°åˆ°æŸç§é—®é¢˜æ—¶ï¼Œä½ ä¹Ÿä¼šçªç„¶æƒ³èµ·æ¥ï¼š</p>
<p>â€œå¥½åƒæœ‰ä¸ªå±æ€§/æ–¹æ³•å°±æ˜¯å¹²è¿™ä¸ªçš„â€</p>
<blockquote>
<p>æœ¬æ–‡é¦–å‘äºå…¬ä¼—å·ï¼šç¨‹åºå‘˜å¤§åï¼Œä¸“æ³¨åˆ†äº«å‰åç«¯å¼€å‘çš„å®æˆ˜ç¬”è®°ã€‚å…³æ³¨æˆ‘ï¼Œå°‘èµ°å¼¯è·¯ï¼Œä¸€èµ·è¿›æ­¥ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æˆ‘éœ‡æƒŠäº†ï¼ŒjQuery ç«Ÿç„¶å‘å¸ƒäº† 4.0 ï¼]]></title>    <link>https://juejin.cn/post/7598081541563154472</link>    <guid>https://juejin.cn/post/7598081541563154472</guid>    <pubDate>2026-01-23T00:42:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598081541563154472" data-draft-id="7598021984299614235" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æˆ‘éœ‡æƒŠäº†ï¼ŒjQuery ç«Ÿç„¶å‘å¸ƒäº† 4.0 ï¼"/> <meta itemprop="keywords" content="jQuery,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-23T00:42:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="RockByte"/> <meta itemprop="url" content="https://juejin.cn/user/1046390797768519"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æˆ‘éœ‡æƒŠäº†ï¼ŒjQuery ç«Ÿç„¶å‘å¸ƒäº† 4.0 ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1046390797768519/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    RockByte
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T00:42:07.000Z" title="Fri Jan 23 2026 00:42:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œä¸ºè¿‘ 10 å¹´æ¥çš„é¦–æ¬¡é‡å¤§æ›´æ–°ï¼ŒjQuery 4.0.0 ç»å†äº†æ¼«é•¿çš„å¼€å‘å‘¨æœŸä¸å¤šä¸ªé¢„å‘å¸ƒç‰ˆæœ¬åæ­£å¼æ¨å‡ºã€‚</p>
<p><em>æˆ‘çœŸçš„ä»¥ä¸º jQuery æ­»äº†</em></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de98d012a8384de1867dacc974534eec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgUm9ja0J5dGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769733726&amp;x-signature=FxANHH9tiUtBB4Cz2qCih7ltG5c%3D" alt="jq.jpeg" loading="lazy"/></p>
<p>è¿™æ¬¾ä»è¢«å¹¿æ³›ä½¿ç”¨çš„ JavaScript åº“ jQuery ç°å·²æ¨å‡º 4.0.0 ç‰ˆæœ¬ã€‚ä½œä¸ºè¿‘ 10 å¹´æ¥çš„é¦–æ¬¡é‡å¤§æ›´æ–°ï¼ŒjQuery 4.0.0 æ–°å¢äº†å¯ä¿¡ç±»å‹ï¼ˆTrusted Typesï¼‰æ”¯æŒï¼Œå¹¶æä¾›äº†ä¸€ä¸ªæ›´ç²¾ç®€çš„æ„å»ºåŒ…ã€‚</p>
<p>è¯¥ç‰ˆæœ¬äº 1 æœˆ 17 æ—¥æ­£å¼å‘å¸ƒï¼Œå¯ä» <a href="https://link.juejin.cn?target=https%3A%2F%2Fjquery.com%2Fdownload%2F" target="_blank" title="https://jquery.com/download/" ref="nofollow noopener noreferrer">jquery.com</a> ä¸‹è½½ã€‚jQuery 4.0.0 ä¸­çš„å¯ä¿¡ç±»å‹åŠŸèƒ½ç¡®ä¿ï¼Œåªæœ‰ <code>TrustedHTML</code> æ¥å£çš„ HTML å†…å®¹æ‰èƒ½ä¼ å…¥ jQuery çš„ DOM æ“ä½œæ–¹æ³•ï¼Œä»è€Œä¸¥æ ¼éµå®ˆæµè§ˆå™¨å†…å®¹å®‰å…¨ç­–ç•¥ï¼ˆCSPï¼‰çš„ <code>require-trusted-types-for</code> æŒ‡ä»¤ã€‚</p>
<p>æ­¤å¤–ï¼Œå°½ç®¡éƒ¨åˆ† AJAX è¯·æ±‚å·²åœ¨ä½¿ç”¨ <code>&lt;script&gt;</code> æ ‡ç­¾æ¥ç»´æŠ¤ <code>crossdomain</code> ç­‰å±æ€§ï¼ŒjQuery å¼€å‘å›¢é˜Ÿä»å°†<strong>å¤§å¤šæ•°å¼‚æ­¥è„šæœ¬è¯·æ±‚åˆ‡æ¢ä¸ºä½¿ç”¨ <code>&lt;script&gt;</code> æ ‡ç­¾</strong>ï¼Œä»¥é¿å…å†…è”è„šæœ¬å¼•å‘çš„ CSP é”™è¯¯ã€‚ä»…åœ¨å°‘æ•°åœºæ™¯ï¼ˆå¦‚ä¼ é€’ <code>headers</code> é€‰é¡¹ï¼‰ä¸‹ä»ä¼šä½¿ç”¨ XHR å‘èµ·å¼‚æ­¥è„šæœ¬è¯·æ±‚ï¼Œä½†åªè¦æ¡ä»¶å…è®¸ï¼Œå°±ä¼šä¼˜å…ˆä½¿ç”¨ <code>&lt;script&gt;</code> æ ‡ç­¾ã€‚</p>
<p>jQuery 4.0.0 è¿˜å¸¦æ¥äº†æ›´ç²¾ç®€çš„æ„å»ºåŒ…ï¼Œç§»é™¤äº† Deferred å¯¹è±¡å’Œå›è°ƒå‡½æ•°ã€‚</p>
<p>Deferred é•¿æœŸä»¥æ¥æ”¯æŒ Promises A+ æ ‡å‡†ï¼Œç”¨äºå®ç°å¯äº’æ“ä½œçš„ JavaScript Promiseï¼›ä¸è¿‡åœ¨ç»å¤§å¤šæ•°åœºæ™¯ä¸‹ï¼Œé™¤ IE 11 å¤–ï¼Œæ‰€æœ‰ jQuery æ”¯æŒçš„æµè§ˆå™¨éƒ½å·²æ”¯æŒåŸç”Ÿ Promiseã€‚</p>
<p>å®˜æ–¹è¡¨ç¤ºï¼Œè™½ç„¶ Deferred å…·å¤‡ä¸€äº›åŸç”Ÿ Promise æ²¡æœ‰çš„é¢å¤–åŠŸèƒ½ï¼Œä½†å¤§å¤šæ•°ç”¨æ³•éƒ½å¯ä»¥è¿ç§»åˆ° Promise æ–¹æ³•ã€‚å¦‚æœä½ çš„é¡¹ç›®ä»éœ€æ”¯æŒ IE 11ï¼Œå»ºè®®ä½¿ç”¨ä¸»æ„å»ºåŒ…ï¼Œæˆ–ä¸ºåŸç”Ÿ Promise æ·»åŠ  polyfillã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒjQuery 4.0.0 ä¸å†æ”¯æŒ IE 10 åŠæ›´æ—©ç‰ˆæœ¬ã€‚</p>
<p>æ ¹æ® Web æŠ€æœ¯è°ƒæŸ¥æœºæ„ W3Techs çš„æ•°æ®ï¼Œå·²è¯ç”Ÿ 20 å¹´çš„ jQuery ç›®å‰ä»è¢« 70.9% çš„ç½‘ç«™ä½¿ç”¨ã€‚</p>
<p>è¯¥é¡¹ç›®ç°ç”± OpenJS åŸºé‡‘ä¼šç®¡ç†ï¼Œæ—¨åœ¨é€šè¿‡è·¨æµè§ˆå™¨çš„ API ç®€åŒ– HTML æ–‡æ¡£éå†ä¸æ“ä½œã€äº‹ä»¶å¤„ç†å’ŒåŠ¨ç”»ç­‰åŠŸèƒ½ã€‚jQuery 4.0.0 çš„å…¶ä»–é‡è¦æ›´æ–°åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>ç„¦ç‚¹äº‹ä»¶é¡ºåºæ ‡å‡†åŒ–</strong>ï¼šç°åœ¨éµå¾ªä¸‡ç»´ç½‘è”ç›Ÿï¼ˆW3Cï¼‰è§„èŒƒï¼Œä½¿ jQuery ä¸å¤§å¤šæ•°æµè§ˆå™¨æœ€æ–°ç‰ˆæœ¬æ”¯æŒçš„äº‹ä»¶é¡ºåºä¿æŒä¸€è‡´ã€‚è¿™ä¸€äº‹ä»¶é¡ºåºä¸æ—§ç‰ˆ jQuery ä¸åŒï¼Œå±äºç ´åæ€§å˜æ›´ã€‚ä» 4.0.0 å¼€å§‹ï¼Œåº“ä¸å†æ”¯æŒè¦†ç›–åŸç”Ÿè¡Œä¸ºï¼Œå°†ä¸¥æ ¼éµå¾ªå½“å‰ W3C è§„èŒƒçš„é¡ºåºï¼š<code>blur</code> â†’ <code>focusout</code> â†’ <code>focus</code> â†’ <code>focusin</code>ã€‚</li>
<li><strong>ç§»é™¤å†…éƒ¨ç§æœ‰æ–¹æ³•</strong>ï¼šä» jQuery åŸå‹ä¸­ç§»é™¤äº†ä»…å†…éƒ¨ä½¿ç”¨çš„æ•°ç»„æ–¹æ³•ï¼ˆå¦‚ <code>push</code>ã€<code>sort</code>ã€<code>splice</code>ï¼‰ã€‚è¿™äº›æ–¹æ³•çš„è¡Œä¸ºä¸å…¶ä»– jQuery æ–¹æ³•ä¸ä¸€è‡´ï¼Œä»…ç”¨äºå†…éƒ¨é€»è¾‘ã€‚å¼€å‘è€…å¦‚æœç”¨åˆ°äº†è¿™äº›è¢«ç§»é™¤çš„æ–¹æ³•ï¼Œå¯ä»¥ç”¨ <code>[].push.call($elems, elem)</code> æ›¿ä»£åŸæ¥çš„ <code>$elems.push(elem)</code>ã€‚</li>
<li><strong>3.x ç‰ˆæœ¬è¿›å…¥ç»´æŠ¤æ¨¡å¼</strong>ï¼šjQuery 3.x ç³»åˆ—ä»Šåå°†åªæ¥æ”¶å…³é”®å®‰å…¨æ›´æ–°ã€‚</li>
</ul>
<h2 data-id="heading-0">æ€»ç»“</h2>
<p>æˆ‘æƒ³èµ·äº†é‚£å¥è¯ï¼Œè€å…µä¸æ­»ï¼Œåªæ˜¯æ…¢æ…¢å‡‹é›¶ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é™æ€æ•°ç»„åˆ°ç¯å½¢æ•°ç»„ï¼šæ‰‹æŠŠæ‰‹å®ç°ä¸åº•å±‚åŸç†å‰–æ]]></title>    <link>https://juejin.cn/post/7598081541562908712</link>    <guid>https://juejin.cn/post/7598081541562908712</guid>    <pubDate>2026-01-22T23:05:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598081541562908712" data-draft-id="7598055483633696768" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é™æ€æ•°ç»„åˆ°ç¯å½¢æ•°ç»„ï¼šæ‰‹æŠŠæ‰‹å®ç°ä¸åº•å±‚åŸç†å‰–æ"/> <meta itemprop="keywords" content="JavaScript,åç«¯,ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-22T23:05:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¢œé…±"/> <meta itemprop="url" content="https://juejin.cn/user/905653309941495"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é™æ€æ•°ç»„åˆ°ç¯å½¢æ•°ç»„ï¼šæ‰‹æŠŠæ‰‹å®ç°ä¸åº•å±‚åŸç†å‰–æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/905653309941495/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¢œé…±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-22T23:05:19.000Z" title="Thu Jan 22 2026 23:05:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»é™æ€æ•°ç»„åˆ°ç¯å½¢æ•°ç»„ï¼šæ‰‹æŠŠæ‰‹å®ç°ä¸åº•å±‚åŸç†å‰–æ</h2>
<p>æ•°ç»„ä½œä¸ºæœ€åŸºç¡€çš„æ•°æ®ç»“æ„ï¼Œå…¶æ ¸å¿ƒä¼˜åŠ¿æ˜¯O(1)çº§éšæœºè®¿é—®èƒ½åŠ›ï¼Œè€ŒåŠ¨æ€æ•°ç»„ä¸ç¯å½¢æ•°ç»„åˆ™æ˜¯åœ¨é™æ€æ•°ç»„åŸºç¡€ä¸Šçš„ä¼˜åŒ–ä¸æ‹“å±•ã€‚æœ¬æ–‡å°†å…ˆæ‹†è§£é™æ€æ•°ç»„çš„å­˜å‚¨åŸç†ä¸å¢åˆ æŸ¥æ”¹é€»è¾‘ï¼Œå†ä¸€æ­¥æ­¥å®ç°æ–°æ‰‹å‹å¥½çš„é—­åŒºé—´ç¯å½¢æ•°ç»„ï¼Œå¸®ä½ åƒé€æ•°ç»„ç±»ç»“æ„çš„åº•å±‚è¿è¡Œæœºåˆ¶ã€‚</p>
<h3 data-id="heading-1">TL;DR</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/217ef6628cf648c3a34eec6d81ce8adb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aKc6YWx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769727918&amp;x-signature=51sCPohFPkALE3xeJSQqoI%2BPoFc%3D" alt="circle_arr.png" loading="lazy"/></p>
<h3 data-id="heading-2">ä¸€ã€æ•°ç»„é¡ºåºå­˜å‚¨çš„åŸºæœ¬åŸç†</h3>
<p>é™æ€æ•°ç»„æ˜¯ä¸€æ®µè¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œé€šè¿‡é¦–åœ°å€å’Œç´¢å¼•å³å¯ç›´æ¥è®¡ç®—ç›®æ ‡å…ƒç´ çš„å†…å­˜åœ°å€ï¼Œè¿™ä¹Ÿæ˜¯å…¶éšæœºè®¿é—®é«˜æ•ˆçš„æ ¸å¿ƒåŸå› ã€‚</p>
<h3 data-id="heading-3">1. é™æ€æ•°ç»„çš„å†…å­˜æœºåˆ¶</h3>
<p>ä»¥C++ä»£ç ä¸ºä¾‹ï¼Œé™æ€æ•°ç»„çš„å†…å­˜åˆ†é…ä¸è®¿é—®é€»è¾‘å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-c++" lang="c++">
<span class="hljs-comment">// å¼€è¾Ÿ10ä¸ªintç±»å‹çš„è¿ç»­å†…å­˜ç©ºé—´ï¼Œå…±40å­—èŠ‚ï¼ˆ1ä¸ªintå 4å­—èŠ‚ï¼‰</span>
<span class="hljs-comment">// arrä¸ºæŒ‡é’ˆï¼ŒæŒ‡å‘è¿™æ®µç©ºé—´çš„é¦–åœ°å€</span>
<span class="hljs-type">int</span> arr[<span class="hljs-number">10</span>];

<span class="hljs-comment">// åˆå§‹åŒ–å†…å­˜ï¼Œé¿å…äºŒæ‰‹å†…å­˜æ•°æ®å¹²æ‰°</span>
<span class="hljs-built_in">memset</span>(arr, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(arr));

<span class="hljs-comment">// ç»™é¦–åœ°å€å¯¹åº”çš„å†…å­˜å†™å…¥1</span>
arr[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;
<span class="hljs-comment">// ç»™é¦–åœ°å€åç§»4å­—èŠ‚ï¼ˆ1*sizeof(int)ï¼‰çš„ä½ç½®å†™å…¥2</span>
arr[<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>;

<span class="hljs-comment">// éšæœºè®¿é—®ï¼šé€šè¿‡ç´¢å¼•è®¡ç®—åœ°å€ï¼Œæ—¶é—´å¤æ‚åº¦O(1)</span>
<span class="hljs-type">int</span> a = arr[<span class="hljs-number">0</span>];
</code></pre>
<p>ç”±äºå†…å­˜å¯»å€æ—¶é—´å¯è§†ä¸ºO(1)ï¼Œé™æ€æ•°ç»„çš„éšæœºè®¿é—®ï¼ˆæŸ¥ã€æ”¹ï¼‰æ“ä½œæ—¶é—´å¤æ‚åº¦å‡ä¸ºO(1)ï¼Œä½†å¢åˆ æ“ä½œå—é™äºè¿ç»­å†…å­˜ç‰¹æ€§ï¼Œæ•ˆç‡ä¼šå› ä½ç½®ä¸åŒè€Œæœ‰å·®å¼‚ã€‚</p>
<h3 data-id="heading-4">2. åŸºäºé™æ€æ•°ç»„çš„å®ç°åŠ¨æ€æ•°ç»„çš„å¢åˆ æŸ¥æ”¹æ“ä½œ</h3>
<p>æ•°ç»„çš„æ ¸å¿ƒèŒè´£æ˜¯å¢åˆ æŸ¥æ”¹ï¼Œå…¶ä¸­æŸ¥å’Œæ”¹åŸºäºéšæœºè®¿é—®ç‰¹æ€§å·²å®ç°é«˜æ•ˆï¼Œé‡ç‚¹åœ¨äºå¢åˆ æ“ä½œçš„é€»è¾‘ä¸å¤æ‚åº¦åˆ†æã€‚
é€šè¿‡å¯¹é™æ€æ•°ç»„çš„æ“ä½œæ¥ç†è§£åŠ¨æ€æ•°ç»„çš„APIã€‚</p>
<h4 data-id="heading-5">ï¼ˆ1ï¼‰å¢åŠ æ“ä½œ</h4>
<p>å¢åŠ æ“ä½œåˆ†â€œç©ºé—´æœªæ»¡â€å’Œâ€œç©ºé—´å·²æ»¡â€ä¸¤ç§åœºæ™¯ï¼Œå¤æ‚åº¦éšæ’å…¥ä½ç½®å˜åŒ–ã€‚</p>
<p><strong>åœºæ™¯1ï¼šç©ºé—´æœªæ»¡</strong></p>
<p>ç°æœ‰é•¿åº¦ä¸º10çš„æ•°ç»„ï¼Œå‰4ä¸ªå…ƒç´ ä¸º0ã€1ã€2ã€3ï¼š</p>
<ul>
<li>
<p>å°¾éƒ¨è¿½åŠ ï¼ˆpushï¼‰ï¼šç›´æ¥ç»™ç´¢å¼•4èµ‹å€¼ï¼Œæ—¶é—´å¤æ‚åº¦O(1)ï¼Œä»£ç ä¸º<code>arr[4] = 4</code>ã€‚</p>
</li>
<li>
<p>ä¸­é—´æ’å…¥ï¼ˆinsertï¼‰ï¼šéœ€å€’åºç§»åŠ¨å…ƒç´ è…¾ä½ç½®ï¼Œé¿å…è¦†ç›–å·²æœ‰æ•°æ®ï¼Œæ—¶é—´å¤æ‚åº¦O(N)ã€‚ä¾‹å¦‚åœ¨ç´¢å¼•2æ’å…¥666ï¼š</p>
</li>
</ul>
<pre><code class="hljs language-c++" lang="c++">
<span class="hljs-comment">// å€’åºç§»åŠ¨ç´¢å¼•2åŠåç»­å…ƒç´ ï¼Œç»™æ–°å…ƒç´ è…¾ä½ç½®</span>
<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">4</span>; i &gt; <span class="hljs-number">2</span>; i--) {
    arr[i] = arr[i - <span class="hljs-number">1</span>];
}
<span class="hljs-comment">// æ’å…¥æ–°å…ƒç´ </span>
arr[<span class="hljs-number">2</span>] = <span class="hljs-number">666</span>;
</code></pre>
<p><strong>åœºæ™¯2ï¼šç©ºé—´å·²æ»¡</strong></p>
<p>å½“æ•°ç»„å¡«æ»¡æ—¶ï¼Œéœ€æ‰§è¡Œâ€œæ‰©å®¹â€æ“ä½œï¼šé‡æ–°ç”³è¯·æ›´å¤§å†…å­˜ã€å¤åˆ¶åŸæ•°æ®ã€é‡Šæ”¾æ—§å†…å­˜ï¼Œæ•´ä½“æ—¶é—´å¤æ‚åº¦O(N)ã€‚ä¾‹å¦‚ç»™æ»¡å…ƒç´ æ•°ç»„è¿½åŠ 10ï¼š</p>
<pre><code class="hljs language-c++" lang="c++">
<span class="hljs-comment">// ç”³è¯·å®¹é‡ä¸º20çš„æ–°æ•°ç»„</span>
<span class="hljs-type">int</span> newArr[<span class="hljs-number">20</span>];
<span class="hljs-comment">// å¤åˆ¶åŸæ•°ç»„æ•°æ®</span>
<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
    newArr[i] = arr[i];
}
<span class="hljs-comment">// é‡Šæ”¾æ—§æ•°ç»„å†…å­˜ï¼ˆé¿å…å†…å­˜æ³„æ¼ï¼‰</span>
<span class="hljs-comment">// ...</span>
<span class="hljs-comment">// è¿½åŠ æ–°å…ƒç´ </span>
newArr[<span class="hljs-number">10</span>] = <span class="hljs-number">10</span>;
</code></pre>
<h4 data-id="heading-6">ï¼ˆ2ï¼‰åˆ é™¤æ“ä½œ</h4>
<p>åˆ é™¤æ“ä½œåŒæ ·åˆ†å°¾éƒ¨å’Œä¸­é—´ä½ç½®ï¼Œæ ¸å¿ƒæ˜¯æ•°æ®æ¬ç§»ä¸æ ‡è®°åˆ é™¤ã€‚</p>
<p>ç°æœ‰é•¿åº¦ä¸º10çš„æ•°ç»„ï¼Œå‰4ä¸ªå…ƒç´ ä¸º0ã€1ã€2ã€3ï¼š</p>
<ul>
<li>
<p>å°¾éƒ¨åˆ é™¤ï¼šç›´æ¥æ ‡è®°å°¾éƒ¨å…ƒç´ ä¸ºç‰¹æ®Šå€¼ï¼ˆå¦‚-1ï¼‰ï¼Œæ—¶é—´å¤æ‚åº¦O(1)ï¼Œä»£ç ä¸º<code>arr[3] = -1</code>ã€‚</p>
</li>
<li>
<p>ä¸­é—´åˆ é™¤ï¼šéœ€æ­£åºç§»åŠ¨å…ƒç´ è¦†ç›–å¾…åˆ é™¤ä½ç½®ï¼Œæ—¶é—´å¤æ‚åº¦O(N)ã€‚ä¾‹å¦‚åˆ é™¤ç´¢å¼•1çš„å…ƒç´ ï¼š</p>
</li>
</ul>
<pre><code class="hljs language-c++" lang="c++">
<span class="hljs-comment">// æ­£åºç§»åŠ¨å…ƒç´ ï¼Œè¦†ç›–å¾…åˆ é™¤ä½ç½®</span>
<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt; <span class="hljs-number">4</span>; i++) {
    arr[i] = arr[i + <span class="hljs-number">1</span>];
}
<span class="hljs-comment">// æ ‡è®°æœ€åä¸€ä¸ªä½ç½®ä¸ºåˆ é™¤çŠ¶æ€</span>
arr[<span class="hljs-number">4</span>] = <span class="hljs-number">-1</span>;
</code></pre>
<h4 data-id="heading-7">ï¼ˆ3ï¼‰æ—¶é—´å¤æ‚åº¦æ€»ç»“</h4>
<ul>
<li>
<p>å¢ï¼šå°¾éƒ¨è¿½åŠ O(1)ï¼Œä¸­é—´æ’å…¥O(N)ï¼Œæ‰©å®¹O(N)ï¼›</p>
</li>
<li>
<p>åˆ ï¼šå°¾éƒ¨åˆ é™¤O(1)ï¼Œä¸­é—´åˆ é™¤O(N)ï¼›</p>
</li>
<li>
<p>æŸ¥/æ”¹ï¼šéšæœºè®¿é—®O(1)ã€‚</p>
</li>
</ul>
<p>åŠ¨æ€æ•°ç»„çš„æœ¬è´¨çš„æ˜¯å¯¹é™æ€æ•°ç»„çš„å°è£…ï¼Œè‡ªåŠ¨å¤„ç†æ‰©ç¼©å®¹ï¼Œç®€åŒ–ç”¨æˆ·æ“ä½œï¼Œè€Œç¯å½¢æ•°ç»„åˆ™æ˜¯è¿›ä¸€æ­¥ä¼˜åŒ–äº†åŠ¨æ€æ•°ç»„çš„ç©ºé—´åˆ©ç”¨ç‡ã€‚</p>
<h3 data-id="heading-8">äºŒã€æ‰‹æŠŠæ‰‹å®ç°é—­åŒºé—´ç¯å½¢æ•°ç»„ï¼ˆ</h3>
<p>ç¯å½¢æ•°ç»„é€šè¿‡â€œé¦–å°¾è¡”æ¥â€çš„é€»è¾‘å¤ç”¨æ•°ç»„ç©ºé—´ï¼Œé—­åŒºé—´ç‰ˆæœ¬çš„æ ¸å¿ƒæ˜¯è®©<code>start</code>å’Œ<code>end</code>å‡æŒ‡å‘æœ‰æ•ˆå…ƒç´ ï¼ˆ<code>start</code>ä¸ºç¬¬ä¸€ä¸ªï¼Œ<code>end</code>ä¸ºæœ€åä¸€ä¸ªï¼‰ï¼Œé€»è¾‘æ›´è´´åˆç›´è§‰ï¼Œä¸‹é¢ä»0åˆ°1åˆ†æ­¥å®ç°ã€‚</p>
<h3 data-id="heading-9">1. æ ¸å¿ƒè§„åˆ™å‰ç½®ï¼ˆå¿…è®°ï¼‰</h3>
<p>æ‰€æœ‰æ“ä½œå‡å›´ç»•ä»¥ä¸‹è§„åˆ™å±•å¼€ï¼Œé¿å…æŒ‡é’ˆæ··ä¹±å’Œé€»è¾‘é”™è¯¯ï¼š</p>









































<table><thead><tr><th>æ ¸å¿ƒæ¦‚å¿µ</th><th>å®šä¹‰/è§„åˆ™</th></tr></thead><tbody><tr><td>capacity</td><td>ç‰©ç†å®¹é‡ï¼Œåº•å±‚æ•°ç»„çš„é•¿åº¦ï¼Œæ”¯æŒåŠ¨æ€æ‰©ç¼©å®¹</td></tr><tr><td>count</td><td>æœ‰æ•ˆå…ƒç´ ä¸ªæ•°ï¼Œåˆ¤æ–­ç©º/æ»¡çš„æ ¸å¿ƒä¾æ®ï¼ˆä¼˜å…ˆä½¿ç”¨ï¼Œä¸ä¾èµ–æŒ‡é’ˆï¼‰</td></tr><tr><td>start</td><td>é—­åŒºé—´èµ·ç‚¹ï¼ŒæŒ‡å‘ç¬¬ä¸€ä¸ªæœ‰æ•ˆå…ƒç´ çš„ç´¢å¼•</td></tr><tr><td>end</td><td>é—­åŒºé—´ç»ˆç‚¹ï¼ŒæŒ‡å‘æœ€åä¸€ä¸ªæœ‰æ•ˆå…ƒç´ çš„ç´¢å¼•</td></tr><tr><td>ç©ºæ•°ç»„</td><td>count === 0ï¼ˆç¦æ­¢ç”¨start === endåˆ¤æ–­ï¼Œæ»¡æ•°ç»„ä¹Ÿå¯èƒ½å‡ºç°è¯¥æƒ…å†µï¼‰</td></tr><tr><td>æ»¡æ•°ç»„</td><td>count === capacityï¼ˆå”¯ä¸€åˆ¤æ–­æ ‡å‡†ï¼‰</td></tr><tr><td>æ–°å¢å…ƒç´ </td><td>å…ˆç§»åŠ¨æŒ‡é’ˆï¼Œå†èµ‹å€¼ï¼ˆå°¾éƒ¨å¢ç§»endï¼Œå¤´éƒ¨å¢ç§»startï¼‰</td></tr><tr><td>åˆ é™¤å…ƒç´ </td><td>å…ˆæ¸…ç©ºå€¼ï¼Œå†ç§»åŠ¨æŒ‡é’ˆï¼ˆå°¾éƒ¨åˆ ç§»endï¼Œå¤´éƒ¨åˆ ç§»startï¼‰</td></tr></tbody></table>
<h3 data-id="heading-10">2. ç¬¬ä¸€æ­¥ï¼šåˆå§‹åŒ–ç±»ä¸åŸºç¡€è¾…åŠ©æ–¹æ³•</h3>
<p>å…ˆæ­å»ºç±»çš„éª¨æ¶ï¼Œå®ç°åˆ¤æ–­ç©º/æ»¡ã€è·å–æœ‰æ•ˆä¸ªæ•°ã€éå†ç­‰åŸºç¡€æ–¹æ³•ï¼Œä¸ºåç»­æ ¸å¿ƒæ“ä½œé“ºå«ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-comment">/**
 * é—­åŒºé—´ç¯å½¢æ•°ç»„ï¼ˆæ–°æ‰‹å‹å¥½ç‰ˆï¼‰
 * æ ¸å¿ƒè§„åˆ™ï¼š[start, end] å‡ä¸ºæœ‰æ•ˆå…ƒç´ ï¼Œstart=ç¬¬ä¸€ä¸ªï¼Œend=æœ€åä¸€ä¸ª
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CycleArrayClosed</span> {
  <span class="hljs-comment">// æ„é€ å‡½æ•°ï¼šåˆå§‹åŒ–ç‰©ç†å®¹é‡ï¼ˆé»˜è®¤1ï¼‰</span>
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">initSize = <span class="hljs-number">1</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span> = initSize; <span class="hljs-comment">// ç‰©ç†å®¹é‡</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(initSize); <span class="hljs-comment">// åº•å±‚å­˜å‚¨æ•°ç»„</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// æœ‰æ•ˆå…ƒç´ èµ·å§‹ç´¢å¼•ï¼ˆé—­åŒºé—´ï¼‰</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// æœ‰æ•ˆå…ƒç´ ç»“æŸç´¢å¼•ï¼ˆé—­åŒºé—´ï¼‰</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// æœ‰æ•ˆå…ƒç´ ä¸ªæ•°ï¼ˆæ ¸å¿ƒåˆ¤æ–­ä¾æ®ï¼‰</span>
  }

  <span class="hljs-comment">// è¾…åŠ©æ–¹æ³•1ï¼šåˆ¤æ–­æ•°ç»„æ˜¯å¦ä¸ºç©º</span>
  <span class="hljs-title function_">isEmpty</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> === <span class="hljs-number">0</span>;
  }

  <span class="hljs-comment">// è¾…åŠ©æ–¹æ³•2ï¼šåˆ¤æ–­æ•°ç»„æ˜¯å¦å·²æ»¡</span>
  <span class="hljs-title function_">isFull</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>;
  }

  <span class="hljs-comment">// è¾…åŠ©æ–¹æ³•3ï¼šè·å–æœ‰æ•ˆå…ƒç´ ä¸ªæ•°ï¼ˆå¯¹å¤–æš´éœ²ï¼‰</span>
  <span class="hljs-title function_">getCount</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>;
  }

  <span class="hljs-comment">// è¾…åŠ©æ–¹æ³•4ï¼šéå†æ‰€æœ‰æœ‰æ•ˆå…ƒç´ ï¼ˆè°ƒè¯•/å±•ç¤ºç”¨ï¼‰</span>
  <span class="hljs-title function_">traverse</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> result = [];
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) <span class="hljs-keyword">return</span> result;

    <span class="hljs-comment">// åˆ†ä¸¤ç§åœºæ™¯éå†ï¼Œé¿å…ç¯å½¢åœºæ™¯æ¼å…ƒç´ </span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> &lt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span>) {
      <span class="hljs-comment">// åœºæ™¯1ï¼šçº¿æ€§åŒºé—´ï¼ˆæœªç»•åœˆï¼‰</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span>; i &lt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span>; i++) {
        result.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[i]);
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// åœºæ™¯2ï¼šç¯å½¢åŒºé—´ï¼ˆå·²ç»•åœˆï¼‰ï¼Œåˆ†ä¸¤æ®µéå†</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>; i++) {
        result.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[i]);
      }
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span>; i++) {
        result.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[i]);
      }
    }
    <span class="hljs-keyword">return</span> result;
  }
}
</code></pre>
<p><strong>æµ‹è¯•åŸºç¡€æ–¹æ³•</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-comment">// åˆå§‹åŒ–å®¹é‡ä¸º3çš„ç¯å½¢æ•°ç»„</span>
<span class="hljs-keyword">const</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CycleArrayClosed</span>(<span class="hljs-number">3</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ˜¯å¦ä¸ºç©ºï¼š"</span>, arr.<span class="hljs-title function_">isEmpty</span>()); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æœ‰æ•ˆä¸ªæ•°ï¼š"</span>, arr.<span class="hljs-title function_">getCount</span>()); <span class="hljs-comment">// 0</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"éå†ç»“æœï¼š"</span>, arr.<span class="hljs-title function_">traverse</span>()); <span class="hljs-comment">// []</span>
</code></pre>
<h3 data-id="heading-11">3. ç¬¬äºŒæ­¥ï¼šå®ç°æ‰©ç¼©å®¹ï¼ˆresizeï¼‰æ ¸å¿ƒæ–¹æ³•</h3>
<p>ç¯å½¢æ•°ç»„æ‰©å®¹æ—¶ï¼Œéœ€å°†æ—§æ•°ç»„çš„æœ‰æ•ˆå…ƒç´ â€œå¹³é“ºâ€åˆ°æ–°æ•°ç»„å¼€å¤´ï¼Œé‡ç½®æŒ‡é’ˆä½¿æ–°æ•°ç»„å›å½’çº¿æ€§çŠ¶æ€ï¼Œé¿å…åç»­æ“ä½œå¤æ‚ã€‚ç¼©å®¹åˆ™åœ¨æœ‰æ•ˆå…ƒç´ è¿‡å°‘æ—¶è§¦å‘ï¼Œä¼˜åŒ–ç©ºé—´åˆ©ç”¨ç‡ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-comment">/**
 * æ‰©å®¹/ç¼©å®¹æ–¹æ³•
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">newCapacity</span> - æ–°çš„ç‰©ç†å®¹é‡
 */</span>
<span class="hljs-title function_">resize</span>(<span class="hljs-params">newCapacity</span>) {
  <span class="hljs-keyword">const</span> newArr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(newCapacity);
  <span class="hljs-comment">// å¤åˆ¶æ—§æ•°ç»„æœ‰æ•ˆå…ƒç´ åˆ°æ–°æ•°ç»„</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>; i++) {
    <span class="hljs-comment">// æ ¸å¿ƒå…¬å¼ï¼šç¯å½¢éå†æ—§æ•°ç»„æœ‰æ•ˆå…ƒç´ </span>
    <span class="hljs-comment">// (start + i) % capacity å¯é€‚é…çº¿æ€§/ç¯å½¢ä¸¤ç§åœºæ™¯</span>
    <span class="hljs-keyword">const</span> oldIndex = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> + i) % <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>;
    newArr[i] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[oldIndex];
  }
  <span class="hljs-comment">// æ›¿æ¢åº•å±‚æ•°ç»„ï¼Œé‡ç½®æŒ‡é’ˆå’Œå®¹é‡</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span> = newArr;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// æ–°æ•°ç»„æœ‰æ•ˆå…ƒç´ ä»0å¼€å§‹</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> - <span class="hljs-number">1</span>; <span class="hljs-comment">// é—­åŒºé—´ç»ˆç‚¹ä¸ºæœ€åä¸€ä¸ªæœ‰æ•ˆå…ƒç´ ç´¢å¼•</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span> = newCapacity;
}
</code></pre>
<p><strong>æµ‹è¯•æ‰©å®¹é€»è¾‘</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-keyword">const</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CycleArrayClosed</span>(<span class="hljs-number">3</span>);
<span class="hljs-comment">// æ‰‹åŠ¨æ¨¡æ‹Ÿå¡«å……å…ƒç´ </span>
arr.<span class="hljs-property">arr</span>[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;
arr.<span class="hljs-property">arr</span>[<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>;
arr.<span class="hljs-property">arr</span>[<span class="hljs-number">2</span>] = <span class="hljs-number">3</span>;
arr.<span class="hljs-property">start</span> = <span class="hljs-number">0</span>;
arr.<span class="hljs-property">end</span> = <span class="hljs-number">2</span>;
arr.<span class="hljs-property">count</span> = <span class="hljs-number">3</span>;

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ‰©å®¹å‰éå†ï¼š"</span>, arr.<span class="hljs-title function_">traverse</span>()); <span class="hljs-comment">// [1,2,3]</span>
arr.<span class="hljs-title function_">resize</span>(<span class="hljs-number">5</span>); <span class="hljs-comment">// æ‰©å®¹åˆ°5</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ‰©å®¹åå®¹é‡ï¼š"</span>, arr.<span class="hljs-property">capacity</span>); <span class="hljs-comment">// 5</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ‰©å®¹åéå†ï¼š"</span>, arr.<span class="hljs-title function_">traverse</span>()); <span class="hljs-comment">// [1,2,3]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ‰©å®¹åæŒ‡é’ˆï¼šstart="</span>, arr.<span class="hljs-property">start</span>, <span class="hljs-string">"end="</span>, arr.<span class="hljs-property">end</span>); <span class="hljs-comment">// start=0, end=2</span>
</code></pre>
<h3 data-id="heading-12">4. ç¬¬ä¸‰æ­¥ï¼šå®ç°å°¾éƒ¨æ·»åŠ ï¼ˆaddLastï¼‰</h3>
<p>å°¾éƒ¨æ·»åŠ éµå¾ªâ€œå…ˆç§»æŒ‡é’ˆå†èµ‹å€¼â€è§„åˆ™ï¼Œç©ºæ•°ç»„éœ€ç‰¹æ®Šå¤„ç†ï¼Œæ»¡æ•°ç»„å…ˆæ‰©å®¹ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-comment">/**
 * å°¾éƒ¨æ·»åŠ å…ƒç´ ï¼ˆæ—¶é—´å¤æ‚åº¦O(1)ï¼‰
 * è§„åˆ™ï¼šæ»¡äº†å…ˆæ‰©å®¹ â†’ ç©ºæ•°ç»„ç‰¹æ®Šå¤„ç† â†’ éç©ºå…ˆç§»endå†èµ‹å€¼
 */</span>
<span class="hljs-title function_">addLast</span>(<span class="hljs-params">val</span>) {
  <span class="hljs-comment">// æ»¡æ•°ç»„å…ˆæ‰©å®¹ï¼ˆæ‰©å®¹2å€ä¸ºè¡Œä¸šé€šç”¨ç­–ç•¥ï¼Œå¹³è¡¡æ•ˆç‡ä¸ç©ºé—´ï¼‰</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isFull</span>()) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">resize</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span> * <span class="hljs-number">2</span>);
  }

  <span class="hljs-comment">// ç©ºæ•°ç»„ï¼šç›´æ¥èµ‹å€¼åˆ°0ä½ç½®ï¼ŒæŒ‡é’ˆå‡æŒ‡å‘0</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[<span class="hljs-number">0</span>] = val;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span> = <span class="hljs-number">0</span>;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// éç©ºæ•°ç»„ï¼šå³ç§»endæŒ‡é’ˆï¼ˆå–æ¨¡å®ç°ç¯å½¢è¡”æ¥ï¼‰ï¼Œå†èµ‹å€¼</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span> = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span> + <span class="hljs-number">1</span>) % <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span>] = val;
  }

  <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++; <span class="hljs-comment">// æœ‰æ•ˆå…ƒç´ ä¸ªæ•°+1</span>
}
</code></pre>
<p><strong>æµ‹è¯•å°¾éƒ¨æ·»åŠ </strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-keyword">const</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CycleArrayClosed</span>(<span class="hljs-number">3</span>);
<span class="hljs-comment">// å¡«å……3ä¸ªå…ƒç´ ï¼ˆå¡«æ»¡å®¹é‡ï¼‰</span>
arr.<span class="hljs-title function_">addLast</span>(<span class="hljs-number">1</span>);
arr.<span class="hljs-title function_">addLast</span>(<span class="hljs-number">2</span>);
arr.<span class="hljs-title function_">addLast</span>(<span class="hljs-number">3</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ·»åŠ 3ä¸ªå…ƒç´ åéå†ï¼š"</span>, arr.<span class="hljs-title function_">traverse</span>()); <span class="hljs-comment">// [1,2,3]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ˜¯å¦æ»¡ï¼š"</span>, arr.<span class="hljs-title function_">isFull</span>()); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// è¿½åŠ ç¬¬4ä¸ªå…ƒç´ ï¼ˆè§¦å‘æ‰©å®¹åˆ°6ï¼‰</span>
arr.<span class="hljs-title function_">addLast</span>(<span class="hljs-number">4</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ‰©å®¹åå®¹é‡ï¼š"</span>, arr.<span class="hljs-property">capacity</span>); <span class="hljs-comment">// 6</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ‰©å®¹åéå†ï¼š"</span>, arr.<span class="hljs-title function_">traverse</span>()); <span class="hljs-comment">// [1,2,3,4]</span>
</code></pre>
<h3 data-id="heading-13">5. ç¬¬å››æ­¥ï¼šå®ç°å¤´éƒ¨æ·»åŠ ï¼ˆaddFirstï¼‰</h3>
<p>å¤´éƒ¨æ·»åŠ éµå¾ªâ€œå…ˆç§»æŒ‡é’ˆå†èµ‹å€¼â€è§„åˆ™ï¼Œç©ºæ•°ç»„å¯å¤ç”¨addLasté€»è¾‘ï¼Œå·¦ç§»æŒ‡é’ˆæ—¶éœ€åŠ capacityé¿å…è´Ÿæ•°ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-comment">/**
 * å¤´éƒ¨æ·»åŠ å…ƒç´ ï¼ˆæ—¶é—´å¤æ‚åº¦O(1)ï¼‰
 * è§„åˆ™ï¼šæ»¡äº†å…ˆæ‰©å®¹ â†’ ç©ºæ•°ç»„è°ƒç”¨addLast â†’ éç©ºå…ˆç§»startå†èµ‹å€¼
 */</span>
<span class="hljs-title function_">addFirst</span>(<span class="hljs-params">val</span>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isFull</span>()) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">resize</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span> * <span class="hljs-number">2</span>);
  }

  <span class="hljs-comment">// ç©ºæ•°ç»„å¤ç”¨å°¾éƒ¨æ·»åŠ é€»è¾‘ï¼Œé¿å…é‡å¤ä»£ç </span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addLast</span>(val);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// å·¦ç§»startæŒ‡é’ˆï¼ˆ+capacityç¡®ä¿ç´¢å¼•éè´Ÿï¼‰</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> - <span class="hljs-number">1</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>) % <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span>] = val;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++;
  }
}
</code></pre>
<p><strong>æµ‹è¯•å¤´éƒ¨æ·»åŠ </strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-keyword">const</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CycleArrayClosed</span>(<span class="hljs-number">3</span>);
arr.<span class="hljs-title function_">addFirst</span>(<span class="hljs-number">1</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å¤´éƒ¨åŠ 1åéå†ï¼š"</span>, arr.<span class="hljs-title function_">traverse</span>()); <span class="hljs-comment">// [1]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"startæŒ‡é’ˆï¼š"</span>, arr.<span class="hljs-property">start</span>); <span class="hljs-comment">// 2ï¼ˆ(0-1+3)%3=2ï¼‰</span>

<span class="hljs-comment">// å†æ·»åŠ 2ä¸ªå…ƒç´ ï¼ˆå¡«æ»¡å®¹é‡ï¼‰</span>
arr.<span class="hljs-title function_">addFirst</span>(<span class="hljs-number">2</span>);
arr.<span class="hljs-title function_">addFirst</span>(<span class="hljs-number">3</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å¡«æ»¡åéå†ï¼š"</span>, arr.<span class="hljs-title function_">traverse</span>()); <span class="hljs-comment">// [3,2,1]</span>

<span class="hljs-comment">// è¿½åŠ ç¬¬4ä¸ªå…ƒç´ ï¼ˆè§¦å‘æ‰©å®¹ï¼‰</span>
arr.<span class="hljs-title function_">addFirst</span>(<span class="hljs-number">4</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ‰©å®¹åéå†ï¼š"</span>, arr.<span class="hljs-title function_">traverse</span>()); <span class="hljs-comment">// [4,3,2,1]</span>
</code></pre>
<h3 data-id="heading-14">6. ç¬¬äº”æ­¥ï¼šå®ç°å°¾éƒ¨åˆ é™¤ï¼ˆremoveLastï¼‰</h3>
<p>å°¾éƒ¨åˆ é™¤éµå¾ªâ€œå…ˆæ¸…ç©ºå€¼å†ç§»æŒ‡é’ˆâ€è§„åˆ™ï¼Œåªå‰©1ä¸ªå…ƒç´ æ—¶éœ€é‡ç½®æŒ‡é’ˆï¼Œæœ‰æ•ˆå…ƒç´ è¿‡å°‘æ—¶è§¦å‘ç¼©å®¹ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-comment">/**
 * å°¾éƒ¨åˆ é™¤å…ƒç´ ï¼ˆæ—¶é—´å¤æ‚åº¦O(1)ï¼‰
 * è§„åˆ™ï¼šç©ºæ•°ç»„æŠ›é”™ â†’ æ¸…ç©ºendå€¼ â†’ ç§»æŒ‡é’ˆ â†’ ç¼©å®¹åˆ¤æ–­
 */</span>
<span class="hljs-title function_">removeLast</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"CycleArray is empty, cannot remove last element"</span>);
  }

  <span class="hljs-comment">// æ¸…ç©ºå½“å‰endä½ç½®çš„å€¼ï¼Œé¿å…å†…å­˜æ³„æ¼</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span>] = <span class="hljs-literal">null</span>;

  <span class="hljs-comment">// åªå‰©1ä¸ªå…ƒç´ ï¼šåˆ é™¤åå˜ä¸ºç©ºæ•°ç»„ï¼Œé‡ç½®æŒ‡é’ˆ</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> === <span class="hljs-number">1</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span> = <span class="hljs-number">0</span>;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// å·¦ç§»endæŒ‡é’ˆï¼ˆ+capacityç¡®ä¿ç´¢å¼•éè´Ÿï¼‰</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span> = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span> - <span class="hljs-number">1</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>) % <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>;
  }

  <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>--;

  <span class="hljs-comment">// ç¼©å®¹ï¼šæœ‰æ•ˆå…ƒç´ ä¸ºå®¹é‡1/4æ—¶ç¼©å®¹åˆ°1/2ï¼Œé¿å…é¢‘ç¹ç¼©å®¹</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span> / <span class="hljs-number">4</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">resize</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span> / <span class="hljs-number">2</span>));
  }
}
</code></pre>
<h3 data-id="heading-15">7. ç¬¬å…­æ­¥ï¼šå®ç°å¤´éƒ¨åˆ é™¤ï¼ˆremoveFirstï¼‰</h3>
<p>å¤´éƒ¨åˆ é™¤éµå¾ªâ€œå…ˆæ¸…ç©ºå€¼å†ç§»æŒ‡é’ˆâ€è§„åˆ™ï¼Œåªå‰©1ä¸ªå…ƒç´ æ—¶å¤ç”¨removeLasté€»è¾‘ï¼Œç¼©å®¹é€»è¾‘ä¸å°¾éƒ¨åˆ é™¤ä¸€è‡´ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-comment">/**
 * å¤´éƒ¨åˆ é™¤å…ƒç´ ï¼ˆæ—¶é—´å¤æ‚åº¦O(1)ï¼‰
 * è§„åˆ™ï¼šç©ºæ•°ç»„æŠ›é”™ â†’ åªå‰©1ä¸ªå…ƒç´ è°ƒç”¨removeLast â†’ æ¸…ç©ºstartå€¼ â†’ ç§»æŒ‡é’ˆ â†’ ç¼©å®¹
 */</span>
<span class="hljs-title function_">removeFirst</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"CycleArray is empty, cannot remove first element"</span>);
  }

  <span class="hljs-comment">// åªå‰©1ä¸ªå…ƒç´ ï¼Œå¤ç”¨å°¾éƒ¨åˆ é™¤é€»è¾‘</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> === <span class="hljs-number">1</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeLast</span>();
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// æ¸…ç©ºå½“å‰startä½ç½®çš„å€¼</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span>] = <span class="hljs-literal">null</span>;
  <span class="hljs-comment">// å³ç§»startæŒ‡é’ˆ</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> + <span class="hljs-number">1</span>) % <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>--;

  <span class="hljs-comment">// ç¼©å®¹åˆ¤æ–­</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span> / <span class="hljs-number">4</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">resize</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span> / <span class="hljs-number">2</span>));
  }
}
</code></pre>
<h3 data-id="heading-16">8. ç¬¬ä¸ƒæ­¥ï¼šå®ç°é¦–å°¾å…ƒç´ è·å–ï¼ˆgetFirst/getLastï¼‰</h3>
<p>ç›´æ¥é€šè¿‡start/endæŒ‡é’ˆå–å€¼ï¼Œåªéœ€åˆ¤æ–­ç©ºæ•°ç»„é¿å…æŠ¥é”™ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-comment">/**
 * è·å–å¤´éƒ¨å…ƒç´ 
 */</span>
<span class="hljs-title function_">getFirst</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"CycleArray is empty, no first element"</span>);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span>];
}

<span class="hljs-comment">/**
 * è·å–å°¾éƒ¨å…ƒç´ 
 */</span>
<span class="hljs-title function_">getLast</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"CycleArray is empty, no last element"</span>);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span>];
}
</code></pre>
<h3 data-id="heading-17">9. å®Œæ•´ä»£ç ä¸ç»¼åˆæµ‹è¯•</h3>
<h4 data-id="heading-18">å®Œæ•´ä»£ç </h4>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CycleArrayClosed</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">initSize = <span class="hljs-number">1</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span> = initSize;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(initSize);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = <span class="hljs-number">0</span>;
  }

  <span class="hljs-title function_">isEmpty</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> === <span class="hljs-number">0</span>;
  }

  <span class="hljs-title function_">isFull</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>;
  }

  <span class="hljs-title function_">getCount</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>;
  }

  <span class="hljs-title function_">traverse</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> result = [];
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) <span class="hljs-keyword">return</span> result;
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> &lt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span>) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span>; i &lt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span>; i++) {
        result.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[i]);
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>; i++) {
        result.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[i]);
      }
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span>; i++) {
        result.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[i]);
      }
    }
    <span class="hljs-keyword">return</span> result;
  }

  <span class="hljs-title function_">resize</span>(<span class="hljs-params">newCapacity</span>) {
    <span class="hljs-keyword">const</span> newArr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(newCapacity);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i&lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>; i++) {
      <span class="hljs-keyword">const</span> oldIndex = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> + i) % <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>;
      newArr[i] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[oldIndex];
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span> = newArr;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> - <span class="hljs-number">1</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span> = newCapacity;
  }

  <span class="hljs-title function_">addLast</span>(<span class="hljs-params">val</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isFull</span>()) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">resize</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span> * <span class="hljs-number">2</span>);
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[<span class="hljs-number">0</span>] = val;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> = <span class="hljs-number">0</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span> = <span class="hljs-number">0</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span> = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span> + <span class="hljs-number">1</span>) % <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span>] = val;
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++;
  }

  <span class="hljs-title function_">addFirst</span>(<span class="hljs-params">val</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isFull</span>()) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">resize</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span> * <span class="hljs-number">2</span>);
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addLast</span>(val);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> - <span class="hljs-number">1</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>) % <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span>] = val;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++;
    }
  }

  <span class="hljs-title function_">removeLast</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"CycleArray is empty, cannot remove last element"</span>);
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span>] = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> === <span class="hljs-number">1</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> = <span class="hljs-number">0</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span> = <span class="hljs-number">0</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span> = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span> - <span class="hljs-number">1</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>) % <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>;
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>--;
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span> / <span class="hljs-number">4</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">resize</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span> / <span class="hljs-number">2</span>));
    }
  }

  <span class="hljs-title function_">removeFirst</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"CycleArray is empty, cannot remove first element"</span>);
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> === <span class="hljs-number">1</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeLast</span>();
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span>] = <span class="hljs-literal">null</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span> + <span class="hljs-number">1</span>) % <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>--;
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span> / <span class="hljs-number">4</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">resize</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">capacity</span> / <span class="hljs-number">2</span>));
    }
  }

  <span class="hljs-title function_">getFirst</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"CycleArray is empty, no first element"</span>);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">start</span>];
  }

  <span class="hljs-title function_">getLast</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEmpty</span>()) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"CycleArray is empty, no last element"</span>);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">end</span>];
  }
}
</code></pre>
<h4 data-id="heading-19">ç»¼åˆæµ‹è¯•ç”¨ä¾‹</h4>
<pre><code class="hljs language-javascript" lang="javascript">
<span class="hljs-comment">// åˆå§‹åŒ–æ•°ç»„</span>
<span class="hljs-keyword">const</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CycleArrayClosed</span>(<span class="hljs-number">3</span>);

<span class="hljs-comment">// æµ‹è¯•æ–°å¢æ“ä½œ</span>
arr.<span class="hljs-title function_">addLast</span>(<span class="hljs-number">1</span>);
arr.<span class="hljs-title function_">addLast</span>(<span class="hljs-number">2</span>);
arr.<span class="hljs-title function_">addFirst</span>(<span class="hljs-number">0</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æ–°å¢åéå†ï¼š"</span>, arr.<span class="hljs-title function_">traverse</span>()); <span class="hljs-comment">// [0,1,2]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"é¦–å°¾å…ƒç´ ï¼š"</span>, arr.<span class="hljs-title function_">getFirst</span>(), arr.<span class="hljs-title function_">getLast</span>()); <span class="hljs-comment">// 0 2</span>

<span class="hljs-comment">// æµ‹è¯•åˆ é™¤æ“ä½œ</span>
arr.<span class="hljs-title function_">removeFirst</span>();
arr.<span class="hljs-title function_">removeLast</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"åˆ é™¤åéå†ï¼š"</span>, arr.<span class="hljs-title function_">traverse</span>()); <span class="hljs-comment">// [1]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"æœ‰æ•ˆä¸ªæ•°ï¼š"</span>, arr.<span class="hljs-title function_">getCount</span>()); <span class="hljs-comment">// 1</span>

<span class="hljs-comment">// æµ‹è¯•æ‰©å®¹ä¸ç¯å½¢éå†</span>
arr.<span class="hljs-title function_">addLast</span>(<span class="hljs-number">3</span>);
arr.<span class="hljs-title function_">addLast</span>(<span class="hljs-number">4</span>);
arr.<span class="hljs-title function_">addFirst</span>(<span class="hljs-number">5</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç¯å½¢éå†ï¼š"</span>, arr.<span class="hljs-title function_">traverse</span>()); <span class="hljs-comment">// [5,1,3,4]</span>

<span class="hljs-comment">// æµ‹è¯•ç¼©å®¹</span>
arr.<span class="hljs-title function_">removeFirst</span>();
arr.<span class="hljs-title function_">removeLast</span>();
arr.<span class="hljs-title function_">removeLast</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç¼©å®¹åå®¹é‡ï¼š"</span>, arr.<span class="hljs-property">capacity</span>); <span class="hljs-comment">// 3</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç¼©å®¹åéå†ï¼š"</span>, arr.<span class="hljs-title function_">traverse</span>()); <span class="hljs-comment">// [1]</span>
</code></pre>
<h2 data-id="heading-20">ä¸‰ã€æ ¸å¿ƒæ˜“é”™ç‚¹æ€»ç»“ï¼ˆæ–°æ‰‹å¿…é¿å‘ï¼‰</h2>
<ol>
<li>
<p><strong>å¿˜è®°æ›´æ–°count</strong>ï¼šå¢åˆ æ“ä½œåå¿…é¡»åŒæ­¥å¢å‡countï¼Œå¦åˆ™ç©º/æ»¡åˆ¤æ–­ä¼šå®Œå…¨å¤±æ•ˆã€‚</p>
</li>
<li>
<p><strong>æŒ‡é’ˆç§»åŠ¨é¡ºåºé¢ å€’</strong>ï¼šæ–°å¢éœ€â€œå…ˆç§»æŒ‡é’ˆå†èµ‹å€¼â€ï¼Œåˆ é™¤éœ€â€œå…ˆæ¸…ç©ºå†ç§»æŒ‡é’ˆâ€ï¼Œé¡ºåºé”™ä¼šå¯¼è‡´æ•°æ®è¦†ç›–æˆ–ä¸¢å¤±ã€‚</p>
</li>
<li>
<p><strong>å·¦ç§»æŒ‡é’ˆæœªåŠ capacity</strong>ï¼šç›´æ¥start-1å¯èƒ½å¾—åˆ°è´Ÿæ•°ç´¢å¼•ï¼Œéœ€é€šè¿‡<code>(start-1 + capacity) % capacity</code>ç¡®ä¿ç´¢å¼•åˆæ³•ã€‚</p>
</li>
<li>
<p><strong>ç”¨æŒ‡é’ˆåˆ¤æ–­ç©º/æ»¡</strong>ï¼šstart === endæ—¢å¯èƒ½æ˜¯ç©ºæ•°ç»„ï¼Œä¹Ÿå¯èƒ½æ˜¯æ»¡æ•°ç»„ï¼Œå”¯ä¸€å¯é çš„åˆ¤æ–­æ˜¯count===0ï¼ˆç©ºï¼‰ã€count===capacityï¼ˆæ»¡ï¼‰ã€‚</p>
</li>
<li>
<p><strong>éå†æ¼ç¯å½¢åœºæ™¯</strong>ï¼šå½“start &gt; endæ—¶ï¼Œéœ€åˆ†<code>[start, capacity-1]</code>å’Œ<code>[0, end]</code>ä¸¤æ®µéå†ï¼Œå¦åˆ™ä¼šæ¼å…ƒç´ ã€‚</p>
</li>
</ol>
<h2 data-id="heading-21">å››ã€æ€»ç»“ä¸æ‹“å±•</h2>
<p>é—­åŒºé—´ç¯å½¢æ•°ç»„é€šè¿‡æŒ‡é’ˆé€»è¾‘å¤ç”¨ç©ºé—´ï¼Œè§£å†³äº†é™æ€æ•°ç»„ä¸­é—´å¢åˆ æ•ˆç‡ä½ã€ç©ºé—´åˆ©ç”¨ç‡ä¸è¶³çš„é—®é¢˜ï¼Œå…¶æ ¸å¿ƒä¼˜åŠ¿æ˜¯é¦–å°¾å¢åˆ å‡èƒ½è¾¾åˆ°O(1)æ—¶é—´å¤æ‚åº¦ï¼Œä»…æ‰©ç¼©å®¹å’Œéå†ï¼ˆç¯å½¢åœºæ™¯ï¼‰éœ€O(N)æ—¶é—´ã€‚</p>
<p>æœ¬æ–‡ä»é™æ€æ•°ç»„åŸç†é“ºå«ï¼Œåˆ°åˆ†æ­¥å®ç°ç¯å½¢æ•°ç»„ï¼Œæ ¸å¿ƒæ˜¯å¸®å¤§å®¶ç†è§£â€œå°è£…â€ä¸â€œä¼˜åŒ–â€çš„æ€è·¯â€”â€”åŠ¨æ€æ•°ç»„å°è£…äº†æ‰©ç¼©å®¹ï¼Œç¯å½¢æ•°ç»„åˆ™è¿›ä¸€æ­¥ä¼˜åŒ–äº†æŒ‡é’ˆé€»è¾‘ã€‚å®é™…å¼€å‘ä¸­ï¼ŒJavaScriptçš„Arrayæœ¬è´¨æ˜¯åŠ¨æ€æ•°ç»„ï¼Œè€Œç¯å½¢æ•°ç»„å¯ç”¨äºå®ç°é˜Ÿåˆ—ã€å¾ªç¯ç¼“å†²åŒºç­‰åœºæ™¯ã€‚</p>
<p>è‹¥éœ€æ‹“å±•åŠŸèƒ½ï¼Œå¯åŸºäºæœ¬æ–‡ä»£ç å®ç°æŒ‰ç´¢å¼•è®¿é—®ã€ä¿®æ”¹å…ƒç´ ç­‰æ“ä½œï¼Œæ ¸å¿ƒæ˜¯é€šè¿‡<code>(start + index) % capacity</code>è®¡ç®—ç›®æ ‡å…ƒç´ ç´¢å¼•ã€‚</p>
<h2 data-id="heading-22">äº”ã€ç»ƒä¹ </h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fdesign-circular-deque%2F" target="_blank" title="https://leetcode.cn/problems/design-circular-deque/" ref="nofollow noopener noreferrer">641. è®¾è®¡å¾ªç¯åŒç«¯é˜Ÿåˆ—</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fdesign-circular-queue%2F" target="_blank" title="https://leetcode.cn/problems/design-circular-queue/" ref="nofollow noopener noreferrer">622. è®¾è®¡å¾ªç¯é˜Ÿåˆ—</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤šæ ‡ç­¾é¡µå¼ºæé†’ä¸é‡å¤æ‰“æ‰°ï¼šä»â€œå¼¹æ¡†è½°ç‚¸â€åˆ°â€œå…±äº«å¾…å¤„ç†é˜Ÿåˆ—â€çš„å®æˆ˜]]></title>    <link>https://juejin.cn/post/7597997108135477275</link>    <guid>https://juejin.cn/post/7597997108135477275</guid>    <pubDate>2026-01-22T19:12:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597997108135477275" data-draft-id="7598057199962882099" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤šæ ‡ç­¾é¡µå¼ºæé†’ä¸é‡å¤æ‰“æ‰°ï¼šä»â€œå¼¹æ¡†è½°ç‚¸â€åˆ°â€œå…±äº«å¾…å¤„ç†é˜Ÿåˆ—â€çš„å®æˆ˜"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,æ¶æ„"/> <meta itemprop="datePublished" content="2026-01-22T19:12:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="_Jude"/> <meta itemprop="url" content="https://juejin.cn/user/1767670430312909"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤šæ ‡ç­¾é¡µå¼ºæé†’ä¸é‡å¤æ‰“æ‰°ï¼šä»â€œå¼¹æ¡†è½°ç‚¸â€åˆ°â€œå…±äº«å¾…å¤„ç†é˜Ÿåˆ—â€çš„å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1767670430312909/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    _Jude
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-22T19:12:21.000Z" title="Thu Jan 22 2026 19:12:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åœºæ™¯ï¼šæˆ‘åœ¨å¤šæ ‡ç­¾é¡µé‡Œâ€œæ¥åŠ›â€å¤„ç†ç´§æ€¥å¾…åŠ</h2>
<p>è¿™ç¯‡æ–‡ç« è®¨è®ºçš„ä¸æ˜¯â€œæ¶ˆæ¯åˆ—è¡¨æ€ä¹ˆåšâ€ï¼Œè€Œæ˜¯ç´§æ€¥å¾…åŠçš„<strong>å¼ºæé†’ä½“éªŒ</strong>åº”è¯¥å¦‚ä½•è½åœ°ã€‚æˆ‘çš„æ ¸å¿ƒéœ€æ±‚å¾ˆæ˜ç¡®ï¼š</p>
<ul>
<li><strong>ç´§æ€¥æ¶ˆæ¯å¿…é¡»å¼ºåˆ¶å¼¹æ¡†æé†’</strong>ï¼ˆä¸èƒ½é ç”¨æˆ·è‡ªå·±å»å°é“ƒé“›é‡Œæ‰¾ï¼‰</li>
<li><strong>å¼¹æ¡†ä¸èƒ½æ‰‹åŠ¨å…³é—­</strong>ï¼Œåªèƒ½é€šè¿‡â€œå»å¤„ç†/å·²è¯»â€ç­‰ä¸šåŠ¡åŠ¨ä½œé€æ¡æ¶ˆè§£</li>
<li><strong>åˆ·æ–°åä»è¦ç»§ç»­å¼¹</strong>ï¼šåªè¦è¿˜æœ‰â€œé«˜ä¼˜å…ˆçº§ä¸”æœªå¤„ç†â€çš„æ¶ˆæ¯ï¼Œå°±å¿…é¡»å†æ¬¡å¼¹æ¡†</li>
<li><strong>å¤šæ ‡ç­¾é¡µä¸é‡å¤æ‰“æ‰°</strong>ï¼šåŒä¸€æ—¶é—´åªå…è®¸ä¸€ä¸ªæ ‡ç­¾é¡µå¼¹ï¼›æœªå¤„ç†çš„æ¶ˆæ¯èƒ½è·¨æ ‡ç­¾é¡µæ¥åŠ›ï¼Œä¸ä¸¢å¤± âœ…</li>
</ul>
<hr/>
<h2 data-id="heading-1">é—®é¢˜ 1ï¼šå¤šæ ‡ç­¾é¡µé‡å¤å¼ºå¼¹ï¼ˆâ€œå¼¹æ¡†è½°ç‚¸â€ï¼‰ğŸ’¥</h2>
<h3 data-id="heading-2">ç°è±¡</h3>
<ul>
<li>A ä¸­ç‚¹â€œå»å¤„ç†â€æ‰“å¼€ B</li>
<li>B æ‰“å¼€åä¼š<strong>ç«‹å³æ‰§è¡Œè½®è¯¢</strong>ï¼ˆè€Œ A é‡Œæ­¤æ—¶è¿˜æœ‰ 3 æ¡æœªå¤„ç†ï¼‰</li>
<li>äºæ˜¯ B ä¼šå†æ¬¡å¼ºå¼¹ï¼š<strong>åŒä¸€æ‰¹å‰©ä½™ 3 æ¡è¢«é‡å¤å¼¹å‡º</strong> ğŸ˜µ</li>
</ul>
<p>ä¸€å¥è¯æ€»ç»“ï¼š<strong>ä¸¤ä¸ªå…¥å£ï¼ˆWS + åˆå§‹åŒ–è½®è¯¢ï¼‰å åŠ åœ¨â€œå¤šæ ‡ç­¾é¡µâ€ä¸Šï¼Œä¼šè®©å¼ºæé†’è¢«é‡å¤è§¦å‘</strong>ã€‚</p>
<h3 data-id="heading-3">æˆ‘è®¤ä¸ºåˆç†çš„äº§å“è®¾è®¡åº”è¯¥æ˜¯ä»€ä¹ˆæ ·ï¼ŸğŸ§©</h3>
<p>æˆ‘çš„åˆ¤æ–­æ ‡å‡†å¾ˆç®€å•ï¼šæ—¢è¦â€œå¼ºæé†’ä¸é—æ¼â€ï¼Œä¹Ÿè¦â€œç”¨æˆ·ä¸è¢«æ‰“æ–­åˆ°å´©æºƒâ€ã€‚</p>
<ul>
<li><strong>åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªå¼ºæé†’å¼¹æ¡†</strong>ï¼ˆé¿å…è½°ç‚¸ï¼‰âœ…</li>
<li><strong>å¼¹æ¡†å®¹å™¨æ”¯æŒå¤šæ¡æ¶ˆæ¯</strong>ï¼ˆç”¨æˆ·èƒ½é€æ¡å¤„ç†ï¼‰âœ…</li>
<li>ç‚¹å‡»â€œå»å¤„ç†â€åï¼Œæ–°æ ‡ç­¾é¡µåº”è¯¥è¿›å…¥<strong>å¤„ç†æ¨¡å¼</strong>ï¼š
<ul>
<li><strong>ä¸å†é‡å¤å¼ºå¼¹å½“å‰æœªå¤„ç†çš„é‚£ä¸€æ‰¹</strong>ï¼ˆå¦åˆ™æ¯å¼€ä¸€ä¸ª tab éƒ½å¼¹ä¸€æ¬¡ï¼‰âœ‹</li>
<li>ä½†æ¶ˆæ¯ä»éœ€ä¿ç•™åœ¨â€œå°é“ƒé“›/å¾…å¤„ç†åˆ—è¡¨â€é‡Œï¼ˆé¿å…æ¼æ‰ï¼‰âœ…</li>
</ul>
</li>
<li>å½“â€œå¤„ç†æ ‡ç­¾é¡µå…³é—­æˆ–å¤„ç†ç»“æŸâ€ï¼Œç³»ç»Ÿå†å…è®¸å…¶ä»–æ ‡ç­¾é¡µæ¥åŠ›å¼¹æ¡† âœ…</li>
</ul>
<h3 data-id="heading-4">è§£å†³æ€è·¯</h3>
<p>å…ˆæŠŠâ€œæ˜¯å¦å…è®¸å¼¹æ¡†â€è¿™ä»¶äº‹ç‹¬ç«‹å‡ºæ¥ï¼š<br/>
ç”¨ä¸€ä¸ª<strong>å…¨å±€é”</strong>æ§åˆ¶â€œåŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªæ ‡ç­¾é¡µå…è®¸å¼¹æ¡†â€ ğŸ‘‡</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
  M[ç´§æ€¥æ¶ˆæ¯åˆ°è¾¾] --&gt; L{å…¨å±€é”å­˜åœ¨?}
  L -- æ˜¯ --&gt; Q[ä¸å¼¹æ¡†/ä»…è®°å½•]
  L -- å¦ --&gt; S[è·å¾—é”å¹¶å¼¹æ¡†]
</code></pre>
<h3 data-id="heading-5">è§£å†³æ–¹æ¡ˆé€‰æ‹©ï¼šé”æ”¾å“ªå„¿ï¼Ÿé”å½’å±æ€ä¹ˆåˆ¤ï¼Ÿ</h3>
<p>è¦è®©â€œåˆ«çš„æ ‡ç­¾é¡µä¸å¼¹â€å¾ˆç®€å•ï¼Œä½†æˆ‘è¿˜éœ€è¦ä¿è¯ï¼š<strong>å½“å‰å¼¹æ¡†é¡µå¯ä»¥ç»§ç»­è¿½åŠ æ–°ç´§æ€¥æ¶ˆæ¯</strong>ã€‚<br/>
è¿™å°±å¼•å‡ºäº†ä¸€ä¸ªç»†èŠ‚ï¼šæˆ‘ä¸ä»…è¦çŸ¥é“â€œæœ‰æ²¡æœ‰é”â€ï¼Œè¿˜è¦çŸ¥é“â€œé”å±äºè°â€ ğŸ‘‰</p>
<p>æˆ‘å½“æ—¶çš„é€‰å‹è·¯å¾„æ˜¯ä¸€ä¸ªå¾ˆå…¸å‹çš„<strong>é€æ­¥æ’é™¤æ³•</strong>ï¼ˆå…ˆå¿«åç¨³ ğŸ‘ï¼‰ï¼š</p>
<ul>
<li><strong>sessionStorage</strong>ï¼šä¸Šæ‰‹å¿«ï¼Œä½†â€œåŒæ ‡ç­¾é¡µè·³è½¬ä»å…±äº«â€ï¼ŒAâ†’B ä¼šé”™åˆ¤â€œæˆ‘è¿˜æ˜¯æŒé”é¡µâ€ âœ‹</li>
<li><strong>windowï¼ˆè‡ªå®šä¹‰ keyï¼‰</strong>ï¼šå¯è·¨é¡µä¿å­˜ï¼Œä½† window å…¨å±€å±æ€§å®¹æ˜“è¢«åˆ«çš„è„šæœ¬è¦†ç›– âš ï¸</li>
<li><strong>Piniaï¼ˆä¸æŒä¹…åŒ–ï¼‰</strong>ï¼š<strong>ä¸åº”ç”¨çŠ¶æ€ä¸€è‡´ã€å¯æ§ã€é£é™©ä½</strong> âœ…</li>
</ul>
<p>ä¸ºä»€ä¹ˆ <strong>Pinia ä¸æŒä¹…åŒ–</strong>ï¼Ÿ</p>
<ul>
<li>Pinia çš„è¿™ä¸ª key æœ¬è´¨æ˜¯â€œä¸´æ—¶å½’å±æ ‡è®°â€ï¼ŒåªæœåŠ¡äºå½“å‰è¿è¡Œæ—¶</li>
<li>å¦‚æœæŒä¹…åŒ–ï¼Œæµè§ˆå™¨å¼‚å¸¸å…³é—­/å´©æºƒå¯¼è‡´æœªæ¸…ç†ï¼Œä¼šå‡ºç°<strong>é”é—ç•™</strong>ï¼Œåç»­å¯èƒ½<strong>ä¸€ç›´ä¸å¼¹å¼ºæé†’</strong> ğŸ˜µ</li>
</ul>
<h3 data-id="heading-6">æœ€ç»ˆæ–¹æ¡ˆï¼ˆé—®é¢˜ 1ï¼‰</h3>
<ul>
<li><strong>localStorage</strong>ï¼šå­˜â€œå…¨å±€é”â€æœ¬ä½“ï¼ˆè·¨æ ‡ç­¾é¡µå…±äº«ï¼‰</li>
<li><strong>Pinia</strong>ï¼šå­˜â€œå½“å‰æ ‡ç­¾é¡µæŒæœ‰çš„é” keyâ€ï¼ˆä»…å½“å‰æ ‡ç­¾é¡µç”Ÿæ•ˆï¼‰</li>
</ul>
<p>ç¤ºä¾‹ä»£ç ï¼ˆä¸å®ç°ä¸€è‡´ï¼‰ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> urgentDialogActivePrefix = <span class="hljs-string">'crm.urgent_dialog_active:'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">setUrgentDialogActive</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> store = <span class="hljs-title function_">useNotificationStore</span>();
  <span class="hljs-keyword">const</span> existingKey = <span class="hljs-title function_">findUrgentDialogActiveKey</span>();
  <span class="hljs-keyword">if</span> (existingKey) <span class="hljs-keyword">return</span> existingKey;
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> key = <span class="hljs-string">`<span class="hljs-subst">${urgentDialogActivePrefix}</span><span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>;
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(key, <span class="hljs-string">'1'</span>);
    store.<span class="hljs-title function_">setUrgentDialogActiveKey</span>(key);
    <span class="hljs-keyword">return</span> key;
  } <span class="hljs-keyword">catch</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">isUrgentDialogActiveForCurrentTab</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> store = <span class="hljs-title function_">useNotificationStore</span>();
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> key = store.<span class="hljs-property">urgentDialogActiveKey</span>;
    <span class="hljs-keyword">if</span> (!key) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(key) === <span class="hljs-string">'1'</span>;
  } <span class="hljs-keyword">catch</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-7">é—®é¢˜ 2ï¼šå…³é—­ A åï¼ŒB åªå¼¹æ–°æ¶ˆæ¯ï¼Œæ—§çš„ 3 æ¡â€œä¸¢äº†â€ğŸ˜µ</h2>
<h3 data-id="heading-8">ç°è±¡</h3>
<p>åœ¨é—®é¢˜ 1 çš„é”æœºåˆ¶ç”Ÿæ•ˆåï¼š</p>
<ul>
<li>B ä¸ä¼šé‡å¤å¼¹æ¡† âœ…</li>
<li>WS çš„æ–°ç´§æ€¥æ¶ˆæ¯ä¼šç»§ç»­ push åˆ° A çš„å¼¹æ¡† âœ…</li>
<li>ä½†å½“ A å…³é—­åï¼ŒB å†æ”¶åˆ°æ–°æ¶ˆæ¯æ—¶ï¼Œåªå±•ç¤ºæ–°æ¥çš„ 1 æ¡ âŒ</li>
</ul>
<p>æœ¬è´¨é—®é¢˜ï¼š<strong>å¼¹æ¡†æ˜¯â€œå”¯ä¸€å…¥å£â€ï¼Œä½†ç´§æ€¥æ¶ˆæ¯çš„â€œå¾…å¤„ç†çŠ¶æ€â€æ²¡æœ‰è¢«ç¨³å®šåœ°â€œå…ˆå­˜èµ·æ¥â€</strong>ã€‚ä¸€æ—¦æŒé”é¡µå…³é—­ï¼Œä¸‹ä¸€æ ‡ç­¾é¡µå¦‚æœåªåŸºäºâ€œæ–°æ¥çš„ WS æ¶ˆæ¯â€è§¦å‘å¼¹æ¡†ï¼Œå°±å®¹æ˜“å‡ºç°â€œæ—§çš„æœªå¤„ç†æ²¡å¸¦ä¸Šâ€çš„é”™è§‰ã€‚</p>
<h3 data-id="heading-9">è§£å†³æ€è·¯</h3>
<p>æŠŠâ€œæ¶ˆæ¯çŠ¶æ€â€ä»â€œå¼¹æ¡†çŠ¶æ€â€é‡Œè§£è€¦å‡ºæ¥ï¼š<br/>
å¼¹æ¡†åªæ˜¯ UIï¼Œ<strong>å¾…å¤„ç†åˆ—è¡¨</strong>æ‰æ˜¯å…³é”®ã€‚</p>
<p>è¿™é‡Œæˆ‘åæ¥æ›´åå‘ä¸€ä¸ªæ›´è½»é‡çš„å®ç°ï¼š<strong>é˜Ÿåˆ—ä¸è·¨æ ‡ç­¾é¡µæŒä¹…åŒ–</strong>ï¼Œè€Œæ˜¯äº¤ç»™â€œé¡µé¢åŠ è½½å¿…å®šä¼šæ‰§è¡Œä¸€æ¬¡çš„è½®è¯¢â€æ¥é‡å»ºâ€”â€”</p>
<ul>
<li><strong>å…ˆè½®è¯¢ä¸€æ¬¡</strong>ï¼ŒæŠŠâ€œé«˜ä¼˜å…ˆçº§ä¸”æœªå¤„ç†â€çš„æ¶ˆæ¯å¡è¿› <strong>Pinia é˜Ÿåˆ—</strong></li>
<li><strong>è½®è¯¢æˆåŠŸåå†è¿æ¥ WS</strong></li>
<li>åé¢æ— è®ºæ˜¯è½®è¯¢åˆ·æ–°è¿˜æ˜¯ WS æ¨é€ï¼Œå…ˆæŠŠæ¶ˆæ¯å†™å…¥ Pinia é˜Ÿåˆ—ï¼›èƒ½å¼¹æ—¶ä¸€æ¬¡æ€§æŠŠé˜Ÿåˆ—é‡Œçš„éƒ½å¼¹å‡ºæ¥ âœ…</li>
</ul>
<h3 data-id="heading-10">è§£å†³æ–¹æ¡ˆé€‰æ‹©ï¼šæœªå¤„ç†é˜Ÿåˆ—æ”¾ localStorage è¿˜æ˜¯ Piniaï¼Ÿ</h3>
<p>è¿™é‡Œçš„æ ¸å¿ƒä¸æ˜¯â€œå“ªä¸ªå­˜å‚¨æ›´å¼ºâ€ï¼Œè€Œæ˜¯<strong>æˆ‘ä»¬çš„äº‹å®æºæ˜¯ä»€ä¹ˆ</strong>ï¼š<br/>
æ—¢ç„¶é¡µé¢åŠ è½½ï¼ˆä»¥åŠåç»­å®šæ—¶ï¼‰éƒ½ä¼šè½®è¯¢åˆ°â€œé«˜ä¼˜å…ˆçº§ä¸”æœªå¤„ç†â€çš„æ¶ˆæ¯ï¼Œé‚£ä¹ˆé˜Ÿåˆ—å®Œå…¨å¯ä»¥ç”±è½®è¯¢åœ¨æ¯ä¸ªæ ‡ç­¾é¡µå†…é‡å»ºï¼›æ­¤æ—¶æŠŠé˜Ÿåˆ—å†™è¿› localStorage åè€Œä¼šå¼•å…¥é¢å¤–é£é™©ã€‚</p>
<ul>
<li>æ–¹æ¡ˆ Aï¼š<strong>localStorage å­˜é˜Ÿåˆ—ï¼ˆè·¨æ ‡ç­¾é¡µå…±äº«/æŒä¹…åŒ–ï¼‰</strong>
<ul>
<li>ä¼˜ç‚¹ï¼šè·¨æ ‡ç­¾é¡µå¤©ç„¶å…±äº«ï¼›åˆ·æ–°/å´©æºƒåä»å¯æ¢å¤</li>
<li>ä»£ä»·ï¼šæœ‰<strong>ç©ºé—´ä¸Šé™</strong>ï¼ˆé€šå¸¸å‡  MBï¼‰ï¼Œé˜Ÿåˆ—ç¨å¤§æˆ–å­—æ®µç¨å¤šå°±å¯èƒ½è§¦å‘ <code>setItem</code> å¤±è´¥ï¼›è¿˜è¦é¢å¤–è®¾è®¡ TTL/å®¹é‡ä¸Šé™/æ¸…ç†ç­–ç•¥ï¼Œå¦åˆ™å®¹æ˜“â€œè¶Šç§¯è¶Šå¤šâ€</li>
</ul>
</li>
<li>æ–¹æ¡ˆ Bï¼š<strong>Pinia å­˜é˜Ÿåˆ—ï¼ˆå†…å­˜æ€ï¼Œæ¯ tab è‡ªå·±ç»´æŠ¤ï¼‰</strong>
<ul>
<li>ä¼˜ç‚¹ï¼šæ²¡æœ‰ localStorage çš„åºåˆ—åŒ–/é…é¢é£é™©ï¼›çŠ¶æ€æ›´æ–°æ›´ç›´æ¥ã€å¯æ§ï¼›ä¸â€œé¡µé¢åŠ è½½ç«‹å³è½®è¯¢ä¸€æ¬¡â€çš„äº‹å®æºä¸€è‡´</li>
<li>ä»£ä»·ï¼šé˜Ÿåˆ—ä¸è·¨æ ‡ç­¾é¡µå…±äº«ï¼Œå› æ­¤éœ€è¦æŠŠâ€œæ¥åŠ›â€äº¤ç»™è½®è¯¢ï¼šæŒé”é¡µå…³é—­åï¼Œå…¶ä»–æ ‡ç­¾é¡µé€šè¿‡è½®è¯¢é‡å»ºé˜Ÿåˆ—å†å¼¹æ¡†</li>
</ul>
</li>
</ul>
<p>æˆ‘é€‰æ‹© <strong>Pinia é˜Ÿåˆ— + localStorage åªå­˜é”</strong>ï¼š<br/>
é˜Ÿåˆ—çš„æƒå¨æ¥æºæ˜¯â€œè½®è¯¢è¿”å›çš„æœªå¤„ç†ç´§æ€¥æ¶ˆæ¯â€ï¼Œè€Œä¸æ˜¯æµè§ˆå™¨æœ¬åœ°æŒä¹…åŒ–ï¼›è¿™æ ·åšèƒ½æŠŠå¤±è´¥é¢ç¼©åˆ°æœ€å°ï¼ŒåŒæ—¶ä»èƒ½æ»¡è¶³â€œæ¥åŠ›ä¸ä¸¢â€çš„ä½“éªŒç›®æ ‡ âœ…</p>
<h3 data-id="heading-11">æœ€ç»ˆæ–¹æ¡ˆï¼ˆé—®é¢˜ 2ï¼‰ï¼šå…ˆè½®è¯¢å WS + Pinia é˜Ÿåˆ— + æ­£ç¡®çš„æ‰§è¡Œé¡ºåº</h3>
<p>å…³é”®ç‚¹ä¸åœ¨â€œæœ‰æ²¡æœ‰é˜Ÿåˆ—â€ï¼Œè€Œåœ¨â€œå…ˆåé¡ºåºâ€ï¼š</p>
<ol>
<li><strong>å…ˆæŠŠè½®è¯¢ç»“æœå…¥é˜Ÿ</strong>ï¼ˆé¡µé¢åŠ è½½ç«‹åˆ»æ‰§è¡Œä¸€æ¬¡ï¼Œå…ˆæ‹¿åˆ°â€œå†å²æœªå¤„ç†â€ï¼‰</li>
<li><strong>è½®è¯¢æˆåŠŸåå†è¿æ¥ WS</strong>ï¼ˆé¿å… WS æŠ¢è·‘å¯¼è‡´â€œåªå¼¹æ–°æ¥çš„â€ï¼‰</li>
<li><strong>ä»»ä½•æ¥æºçš„ç´§æ€¥æ¶ˆæ¯éƒ½å…ˆå…¥é˜Ÿï¼Œå†åˆ¤æ–­é”</strong>ï¼ˆä¸æŒé”ä¹Ÿè¦ç¼“å­˜ï¼‰</li>
<li><strong>èƒ½å¼¹æ—¶ç›´æ¥æ¸²æŸ“é˜Ÿåˆ—</strong>ï¼ˆä¸€æ¬¡æ€§è¡¥é½æ—§çš„ + æ–°çš„ï¼‰ âœ…</li>
</ol>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
  participant Poll as è½®è¯¢(ç«‹å³æ‰§è¡Œ)
  participant WS as WebSocket
  participant Tab as å½“å‰æ ‡ç­¾é¡µ
  participant Q as Pinia(å¾…å¤„ç†é˜Ÿåˆ—)
  participant Lock as localStorage(é”)
  participant UI as å¼ºæé†’å¼¹æ¡†

  Poll-&gt;&gt;Tab: æ‹‰å–æœªå¤„ç†ç´§æ€¥æ¶ˆæ¯ list
  Tab-&gt;&gt;Q: replacePending(list) âœ…
  Tab-&gt;&gt;WS: connect() âœ…
  WS-&gt;&gt;Tab: æ”¶åˆ°ç´§æ€¥æ¶ˆæ¯ item
  Tab-&gt;&gt;Q: upsertPending(item) âœ…
  Tab-&gt;&gt;Lock: isLocked?
  alt è¢«å…¶ä»–æ ‡ç­¾é¡µæŒé”
    Tab--&gt;&gt;UI: ä¸å¼¹æ¡†ï¼Œä»…ç­‰å¾…
  else å¯æŒé”/å·²æŒé”
    Tab-&gt;&gt;Lock: setLock()
    Tab-&gt;&gt;UI: render(Q.pendingList) âœ…
  end
</code></pre>
<p>ç¤ºä¾‹ä»£ç ï¼ˆä¸å®ç°ä¸€è‡´ï¼‰ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> store = <span class="hljs-title function_">useNotificationStore</span>();

<span class="hljs-keyword">const</span> <span class="hljs-title function_">maybeOpenUrgentDialog</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (store.<span class="hljs-property">urgentPendingList</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isUrgentDialogActiveForCurrentTab</span>() &amp;&amp; <span class="hljs-title function_">isUrgentDialogActive</span>()) <span class="hljs-keyword">return</span>;
  <span class="hljs-title function_">setUrgentDialogActive</span>();
  <span class="hljs-title function_">setUrgentDialogItems</span>(store.<span class="hljs-property">urgentPendingList</span>);
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleUrgentIncoming</span> = (<span class="hljs-params">item: NotificationMineItem</span>) =&gt; {
  store.<span class="hljs-title function_">upsertUrgentPending</span>({ <span class="hljs-attr">key</span>: <span class="hljs-title function_">getUrgentNotificationKey</span>(item), item });
  <span class="hljs-title function_">maybeOpenUrgentDialog</span>();
};

<span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchNotifications</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> list = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getNotificationList</span>({ <span class="hljs-attr">status</span>: <span class="hljs-number">0</span> });
  store.<span class="hljs-title function_">replaceUrgentPending</span>(
    list
      .<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> <span class="hljs-title function_">isUrgentNotification</span>(x) &amp;&amp; !x.<span class="hljs-property">isRead</span>)
      .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> ({ <span class="hljs-attr">key</span>: <span class="hljs-title function_">getUrgentNotificationKey</span>(x), <span class="hljs-attr">item</span>: x })),
  );
  <span class="hljs-title function_">maybeOpenUrgentDialog</span>();
  <span class="hljs-title function_">startEcho</span>();
};
</code></pre>
<hr/>
<h2 data-id="heading-12">æœ€ç»ˆæ•ˆæœï¼ˆä¸¤ç±»é—®é¢˜ä¸€èµ·è§£å†³ï¼‰ğŸ™Œ</h2>
<ul>
<li><strong>å¤šæ ‡ç­¾é¡µä¸å†é‡å¤å¼ºå¼¹</strong>ï¼šåªæœ‰ä¸€ä¸ªæ ‡ç­¾é¡µæŒé”å±•ç¤ºå¼¹æ¡† âœ…</li>
<li><strong>ç´§æ€¥æ¶ˆæ¯ä¸ä¼šâ€œè¢«å…³æ‰çš„æ ‡ç­¾é¡µå¸¦èµ°â€</strong>ï¼šè½®è¯¢é‡å»º + Pinia é˜Ÿåˆ—å…œåº•ï¼Œèƒ½æ¥åŠ› âœ…</li>
<li><strong>æ–°æ¶ˆæ¯åˆ°æ¥æ—¶ä¼šè¡¥é½å†å²æœªå¤„ç†</strong>ï¼šB ä¼šå¼¹ 3 æ¡æ—§çš„ + 1 æ¡æ–°çš„ âœ…</li>
</ul>
<hr/>
<h2 data-id="heading-13">æ€»ç»“</h2>
<p>è¿™æ¬¡é—®é¢˜æœ¬è´¨ä¸Šæ˜¯â€œåŒä¸€ä»½ç´§æ€¥æ¶ˆæ¯ï¼Œåœ¨å¤šæ ‡ç­¾é¡µç¯å¢ƒä¸‹å¦‚ä½•åšåˆ°<strong>ä¸é‡å¤æ‰“æ‰°</strong>åˆ<strong>ä¸é—æ¼</strong>â€ï¼š</p>
<ul>
<li><strong>é—®é¢˜ 1ï¼ˆé‡å¤å¼¹æ¡†ï¼‰</strong>ï¼šç”¨ <strong>localStorage å…¨å±€é”</strong>ä¿è¯åŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªæ ‡ç­¾é¡µå¼¹æ¡†ï¼›é”å½’å±ç”¨ <strong>Pinia</strong> è®°å½•ï¼Œé¿å…è¯¯åˆ¤</li>
<li><strong>é—®é¢˜ 2ï¼ˆæ¥åŠ›ä¸¢å†å²ï¼‰</strong>ï¼šæŠŠâ€œå¾…å¤„ç†ç´§æ€¥æ¶ˆæ¯â€ä»å¼¹æ¡†ç»„ä»¶é‡ŒæŠ½å‡ºæ¥ï¼Œæ”¹ä¸º <strong>Pinia é˜Ÿåˆ—</strong>ï¼›å¹¶é€šè¿‡<strong>å…ˆè½®è¯¢å WS</strong>çš„æ—¶åºï¼Œç¡®ä¿â€œå†å²æœªå¤„ç†â€ä¸€å®šå…ˆå…¥é˜Ÿï¼Œå†å åŠ  WS çš„å®æ—¶å¢é‡</li>
</ul>
<p>æœ€ç»ˆæ•ˆæœæ˜¯ï¼šç´§æ€¥æ¶ˆæ¯ä»ç„¶å¼ºåˆ¶å¼¹æ¡†ã€ä¸å¯æ‰‹åŠ¨å…³é—­ã€åˆ·æ–°åä»å¯é€šè¿‡è½®è¯¢é‡å»ºç»§ç»­å¼¹ï¼ŒåŒæ—¶å¤šæ ‡ç­¾é¡µä¸ä¼šè¢«åŒä¸€æ‰¹æ¶ˆæ¯åå¤è½°ç‚¸ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ²¡æ˜¾å¡ä¹Ÿèƒ½ç©ï¼Ollama æœ¬åœ°å¤§æ¨¡å‹ä¿å§†çº§å…¥é—¨æŒ‡å—]]></title>    <link>https://juejin.cn/post/7598203055746940980</link>    <guid>https://juejin.cn/post/7598203055746940980</guid>    <pubDate>2026-01-22T16:40:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598203055746940980" data-draft-id="7598025242041696308" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ²¡æ˜¾å¡ä¹Ÿèƒ½ç©ï¼Ollama æœ¬åœ°å¤§æ¨¡å‹ä¿å§†çº§å…¥é—¨æŒ‡å—"/> <meta itemprop="keywords" content="Agent,LLM"/> <meta itemprop="datePublished" content="2026-01-22T16:40:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å­—èŠ‚é€†æ—…"/> <meta itemprop="url" content="https://juejin.cn/user/2471357871561214"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ²¡æ˜¾å¡ä¹Ÿèƒ½ç©ï¼Ollama æœ¬åœ°å¤§æ¨¡å‹ä¿å§†çº§å…¥é—¨æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2471357871561214/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å­—èŠ‚é€†æ—…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-22T16:40:06.000Z" title="Thu Jan 22 2026 16:40:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-22
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¦‚æœä½ æƒ³åœ¨è‡ªå·±ç”µè„‘ä¸Šè·‘ AIï¼Œåˆä¸å¸Œæœ›æ•°æ®è¢«å¤§å‚æ‹¿èµ°ï¼Œ<strong>Ollama</strong> ç»å¯¹æ˜¯ç›®å‰æœ€é¦™çš„é€‰æ‹©ã€‚ä¸ç”¨é…å¤æ‚çš„ Python ç¯å¢ƒï¼Œä¸ç”¨æ±‚çˆ·çˆ·å‘Šå¥¶å¥¶æ‰¾ API Keyï¼Œåªè¦ä¸€é”®å®‰è£…ï¼Œå°±èƒ½å®ç°â€œå¤§æ¨¡å‹è‡ªç”±â€ã€‚ä¸è¿‡æˆ‘çš„ç”µè„‘å¾ˆæ—©å°±æœ‰äº†pythonç¯å¢ƒäº†ï¼Œå¿˜è®°å•¥æ—¶å€™å®‰è£…çš„ï¼Œè™½ç„¶åœ¨pythonæ–¹é¢è¿˜æ˜¯ä¸ªèœé¸Ÿã€‚</p>
<h3 data-id="heading-0">1. æ€ä¹ˆå®‰è£…</h3>
<p>ç›´æ¥å» <a href="https://link.juejin.cn?target=https%3A%2F%2Follama.com%2F" target="_blank" title="https://ollama.com/" ref="nofollow noopener noreferrer">Ollama å®˜ç½‘</a> ä¸‹è½½ã€‚æœ‰1ä¸ªå¤šGï¼Œå…ˆæœ‰ä¸ªå¿ƒç†å‡†å¤‡ã€‚</p>
<ul>
<li>
<p><strong>ç¬¬ä¸€æ­¥ï¼š</strong> å®‰è£…å®Œåï¼Œå®ƒä¼šèº²åœ¨å³ä¸‹è§’ä»»åŠ¡æ ã€‚</p>
</li>
<li>
<p><strong>ç¬¬äºŒæ­¥ï¼š</strong> æ‰“å¼€ç»ˆç«¯ï¼ˆCMD æˆ– PowerShellï¼‰ï¼Œè¾“å…¥ä¸‹é¢çš„å‘½ä»¤ã€‚è¿™æ˜¯æœ€å…³é”®çš„ä¸€æ­¥ï¼Œå®ƒä¼šè‡ªåŠ¨ä¸‹è½½å¹¶å¯åŠ¨å¯¹è¯ã€‚</p>
<p>Bash</p>
<pre><code class="hljs language-arduino" lang="arduino">ollama run qwen2<span class="hljs-number">.5</span>:<span class="hljs-number">1.5b</span>
</code></pre>
</li>
</ul>
<p>å½“ä½ çœ‹åˆ°è¿›åº¦æ¡è·‘å®Œï¼Œå‡ºç° <code>&gt;&gt;&gt; Send a message</code> æ—¶ï¼Œè¯´æ˜ AI å·²ç»åœ¨ä½ ç¡¬ç›˜é‡Œå®‰å®¶äº†ã€‚
å¦‚æœä¸æƒ³ç›´æ¥å¯åŠ¨ï¼Œå°±ç”¨è¿™ä¸ªå‘½ä»¤ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-code">    ollama pull qwen2.5:1.5b
</span></code></pre>
<hr/>
<h3 data-id="heading-1">2. é¿å‘æŒ‡å—ï¼ˆè¿™äº›å‘æˆ‘éƒ½å¸®ä½ è¸©è¿‡äº†ï¼‰</h3>
<ul>
<li><strong>ä¸è¦åœ¨ Python é‡Œé¢è¿è¡Œ Pythonï¼š</strong> å¾ˆå¤šäººä¼šä¹ æƒ¯å…ˆè¾“å…¥ <code>python</code> è¿›å»ï¼Œç„¶åå†æ•²å‘½ä»¤ã€‚åƒä¸‡åˆ«ï¼è¿è¡Œè„šæœ¬æ˜¯åœ¨æ™®é€šçš„ CMD è·¯å¾„ä¸‹ç›´æ¥è¾“å…¥ <code>python test.py</code>ã€‚</li>
<li><strong>æ¨¡å‹åå­—è¦å†™å…¨ï¼š</strong> ä»£ç é‡Œçš„ <code>model='qwen2.5:1.5b'</code> å¿…é¡»å¸¦ä¸Šåç¼€ã€‚å¦‚æœä¸å†™ï¼Œå®ƒé»˜è®¤å»æ‰¾ <code>7b</code> ç‰ˆæœ¬ï¼Œæ²¡ä¸‹è½½çš„è¯å°±ä¼šæŠ¥ <strong>502 é”™è¯¯</strong>ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-2">3. é«˜çº§ç©æ³•ï¼šæ‰‹æ‘¸æ‰‹æ•™ä½ å†™ä¸€ä¸ª Agent</h3>
<p>æ™®é€šçš„èŠå¤©åªæ˜¯â€œä½ é—®æˆ‘ç­”â€ï¼Œä½† <strong>Agentï¼ˆæ™ºèƒ½ä½“ï¼‰</strong> å‰å®³çš„åœ°æ–¹åœ¨äºï¼šå®ƒèƒ½æ ¹æ®ä½ çš„éœ€æ±‚ï¼Œ<strong>è‡ªå·±å»è°ƒç”¨å·¥å…·</strong>ã€‚</p>
<p>æŠŠä¸‹é¢çš„ä»£ç å­˜æˆ <code>agent_test.py</code>ï¼š</p>
<p>Python</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> ollama

<span class="hljs-comment"># 1. å‡†å¤‡ä¸€ä¸ªâ€œå‡è£…èƒ½æŸ¥å¤©æ°”â€çš„å·¥å…·</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_weather</span>(<span class="hljs-params">city</span>):
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{city}</span>çš„å¤©æ°”æ˜¯ï¼šå¤§æ™´å¤©ï¼Œ25åº¦ï¼"</span>

<span class="hljs-comment"># 2. å‘Šè¯‰ AI è¿™ä¸ªå·¥å…·æ€ä¹ˆç”¨</span>
tools = [{
    <span class="hljs-string">'type'</span>: <span class="hljs-string">'function'</span>,
    <span class="hljs-string">'function'</span>: {
        <span class="hljs-string">'name'</span>: <span class="hljs-string">'get_weather'</span>,
        <span class="hljs-string">'description'</span>: <span class="hljs-string">'æŸ¥è¯¢æŸä¸ªåŸå¸‚çš„å¤©æ°”'</span>,
        <span class="hljs-string">'parameters'</span>: {
            <span class="hljs-string">'type'</span>: <span class="hljs-string">'object'</span>,
            <span class="hljs-string">'properties'</span>: {<span class="hljs-string">'city'</span>: {<span class="hljs-string">'type'</span>: <span class="hljs-string">'string'</span>}},
            <span class="hljs-string">'required'</span>: [<span class="hljs-string">'city'</span>],
        },
    }
}]

<span class="hljs-comment"># 3. æ ¸å¿ƒé€»è¾‘</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">ask_ai</span>(<span class="hljs-params">prompt</span>):
    res = ollama.chat(model=<span class="hljs-string">'qwen2.5:1.5b'</span>, messages=[{<span class="hljs-string">'role'</span>: <span class="hljs-string">'user'</span>, <span class="hljs-string">'content'</span>: prompt}], tools=tools)
    
    <span class="hljs-keyword">if</span> res[<span class="hljs-string">'message'</span>].get(<span class="hljs-string">'tool_calls'</span>):
        <span class="hljs-comment"># AI è‡ªåŠ¨è¯†åˆ«å‡ºéœ€è¦è°ƒç”¨ get_weather å‡½æ•°</span>
        city = res[<span class="hljs-string">'message'</span>][<span class="hljs-string">'tool_calls'</span>][<span class="hljs-number">0</span>][<span class="hljs-string">'function'</span>][<span class="hljs-string">'arguments'</span>][<span class="hljs-string">'city'</span>]
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"--- å†…éƒ¨è§‚å¯Ÿï¼šAgent å†³å®šè°ƒç”¨å·¥å…·æŸ¥ã€<span class="hljs-subst">{city}</span>ã€‘çš„å¤©æ°” ---"</span>)
        result = get_weather(city) 
        
        final = ollama.chat(model=<span class="hljs-string">'qwen2.5:1.5b'</span>, messages=[
            {<span class="hljs-string">'role'</span>: <span class="hljs-string">'user'</span>, <span class="hljs-string">'content'</span>: prompt},
            res[<span class="hljs-string">'message'</span>],
            {<span class="hljs-string">'role'</span>: <span class="hljs-string">'tool'</span>, <span class="hljs-string">'content'</span>: result}
        ])
        <span class="hljs-keyword">return</span> final[<span class="hljs-string">'message'</span>][<span class="hljs-string">'content'</span>]
    <span class="hljs-keyword">return</span> res[<span class="hljs-string">'message'</span>][<span class="hljs-string">'content'</span>]

<span class="hljs-built_in">print</span>(ask_ai(<span class="hljs-string">"åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"</span>))
</code></pre>
<hr/>
<h3 data-id="heading-3">4. çœŸå®è¿è¡Œæ•ˆæœ</h3>
<p>å½“ä½ é€€å‡ºæ‰€æœ‰å¤šä½™çš„çª—å£ï¼Œåœ¨æ–‡ä»¶å¤¹é‡Œè¾“å…¥ <code>python agent_test.py</code>ï¼Œä½ ä¼šçœ‹åˆ°æå…¶è§£å‹çš„ä¸€å¹•ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">C:\Users\Admin&gt; python agent_test.py
<span class="hljs-comment">--- å†…éƒ¨è§‚å¯Ÿï¼šAgent å†³å®šè°ƒç”¨å·¥å…·æŸ¥ã€åŒ—äº¬ã€‘çš„å¤©æ°” ---</span>
åŒ—äº¬ä»Šå¤©çš„å¤©æ°”éå¸¸å¥½ï¼Œæ˜¯å¤§æ™´å¤©ï¼Œæ°”æ¸©çº¦ 25 åº¦ï¼Œéå¸¸é€‚åˆå‡ºé—¨èµ°èµ°ï¼
</code></pre>
<blockquote>
<p><strong>æ³¨æ„çœ‹ï¼š</strong> ç¬¬ä¸€è¡Œè¾“å‡ºæ˜¯æˆ‘åœ¨ä»£ç é‡Œå†™çš„â€œå†…éƒ¨è§‚å¯Ÿâ€ï¼Œè¿™è¯æ˜äº† AI <strong>çœŸçš„ç†è§£äº†</strong>ä½ çš„è¯ï¼Œå¹¶ç²¾å‡†æŠ“å–äº†â€œåŒ—äº¬â€è¿™ä¸ªå‚æ•°å‘ç»™äº† Python å‡½æ•°ã€‚</p>
</blockquote>
<p>å®é™…ä¸Šï¼Œæˆ‘ä»¬çš„å‡½æ•°ä¸­å¹¶æ²¡æœ‰å†™è¿™äº›å›ç­”ï¼Œå¤šå‡ºçš„éƒ¨åˆ†å†…å®¹å°±æ˜¯å¤§æ¨¡å‹è‡ªå·±çš„å‘æŒ¥ã€‚</p>
<p>ä½ å¯ä»¥å‚è€ƒè¿™ä¸ªæµç¨‹ï¼Œçœ‹æ¸…æ¥šæ•°æ®æ˜¯æ€ä¹ˆæµåŠ¨çš„ï¼š</p>
<ol>
<li><strong>ç”¨æˆ·ï¼š</strong> â€œåŒ—äº¬å¤©æ°”å¦‚ä½•ï¼Ÿâ€</li>
<li><strong>æ¨¡å‹ï¼š</strong> ï¼ˆæ€è€ƒï¼‰æˆ‘éœ€è¦è°ƒç”¨ <code>get_weather</code>ï¼ŒåŸå¸‚æ˜¯â€œåŒ—äº¬â€ã€‚</li>
<li><strong>Python å‡½æ•°ï¼š</strong> ï¼ˆæ‰§è¡Œï¼‰è¿”å› <code>"å¤§æ™´å¤©ï¼Œ25åº¦"</code>ã€‚</li>
<li><strong>æ¨¡å‹ï¼š</strong> ï¼ˆåŠ å·¥ï¼‰æ‹¿åˆ°æ•°æ®ï¼Œç»“åˆå®ƒçš„è¯­è¨€æ¨¡å‹èƒ½åŠ›ï¼Œæ‰©å……æˆï¼šâ€œåŒ—äº¬ä»Šå¤©å¤©æ°”<strong>éå¸¸å¥½</strong>ï¼Œæ˜¯<strong>å¤§æ™´å¤©</strong>ï¼Œæ°”æ¸©çº¦ <strong>25 åº¦</strong>ï¼Œ<strong>éå¸¸é€‚åˆå‡ºé—¨èµ°èµ°</strong>ï¼â€</li>
</ol>
<hr/>
<p>è¿˜æ˜¯æŒºæœ‰æ„æ€çš„ï¼Œå¼ºçƒˆå»ºè®®ä½ è¯•ä¸€è¯•ï¼</p>
<h3 data-id="heading-4">æ€»ç»“</h3>
<p>Ollama è®© AI ä¸å†æ˜¯é¥ä¸å¯åŠçš„ç½‘é¡µé“¾æ¥ï¼Œè€Œæ˜¯ä½ ç”µè„‘é‡Œçš„ä¸€ä¸ªâ€œæ•°å­—å‘˜å·¥â€ã€‚ä½ å¯ä»¥å…ˆä» <code>1.5b</code> è¿™ç§å°æ¨¡å‹ç©èµ·ï¼Œç­‰ç©æ˜ç™½äº†ï¼Œç›´æ¥æ¢æˆæ›´å¼ºçš„æ¨¡å‹ï¼Œä½ çš„ Agent èƒ½åŠ›ç¬é—´å°±èƒ½è¿›åŒ–ï¼Œä¸Šé™å–å†³äºä½ çš„æƒ³è±¡åŠ›ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>